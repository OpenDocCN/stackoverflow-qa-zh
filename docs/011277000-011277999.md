# StackOverflow 问答 11277000-11277999

# asp.net - Visual Web Developer Express - 加密连接字符串

> ID：11277000
> 
> 赞同：3
> 
> 时间：2012-06-30T19:24:58.733
> 
> 标签：asp.net

我用一个包含连接字符串的 web.config 文件创建了一个非常简单的 ASP.NET 应用程序。连接字符串用于连接到数据库并返回一个值（这有效）。

我现在正在尝试加密连接字符串。我使用以下命令（取自这里：http: [//msdn.microsoft.com/en-us/library/ff647398.aspx](http://msdn.microsoft.com/en-us/library/ff647398.aspx)）：

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pe "connectionStrings" -app "/Test". 
```

命令提示符返回“成功”，但是当我查看 web.config（在 Test 文件夹中）时，没有任何改变。

我的开发 PC 上安装了 Visual Web Developer Express。这是出于测试目的。一旦我对这个工具 (aspnet_regiis) 充满信心，我将使用 Visual Studio Professional 对实时 Web 应用程序进行更改。

我正在运行的命令有问题吗？您不能使用 Visual Web Developer Express 加密连接字符串吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T19:34:55.930

`-pe`我建议使用`-pef`并指定保存文件的目录的路径，而不是使用`web.config`—— 这避免了 IIS 指向的任何歧义。

```
ASPNET_REGIIS -pef "connectionStrings" "path to directory with web.config" 
```

# java - Java：如何修复 ArrayIndexOutOfBoundsException？

> ID：11277008
> 
> 赞同：-4
> 
> 时间：2012-06-30T19:26:06.033
> 
> 标签：java

```
public class TextFileExtractor{
    public static String[] fileExtractor(String[] s){

        StringBuilder sb=new StringBuilder();

            for(int i=0;i<=s.length;i++){
                if(s[i].endsWith(".txt")){
                    sb.append(s[i]);
                    sb.append(',');
                }
            }
        String str=sb.toString();
        String[] sa=str.split(",");

        return sa;
    }
}

import java.util.*;

class P8Test{

    public static void main(String[] args) 
    {   Scanner scn=new Scanner(System.in);
        System.out.print("Enter String Array:");
        String[] data=new String[(scn.nextLine()).length()];
        data=(scn.nextLine()).split(",");

            System.out.print("all Files");
                System.out.print(Arrays.toString(data));
                    System.out.print("Text Files");

        String[] res=TextFileExtractor.fileExtractor(data);
        System.out.print(Arrays.toString(res));
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-30T19:29:34.257

有了这种循环声明

```
for(int i=0;i<=s.length;i++) 
```

您将尝试访问总共的`s.length+1`数组元素，因此显然其中一个元素超出了范围。哪一个，我留给你（因为它是家庭作业）。

（或者我应该对 SO 上的其他优秀人士说？:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T19:34:26.487

最后一个元素将是`s.length`，它不存在，抛出`ArrayOutOfBoundsException`.

您可以使用以下方法：

```
 for (String i : s) {
        if (i.endsWith(".txt") {
             ...
        }
    } 
```

这更容易理解（迭代并且对于每次迭代，被`s`迭代的元素都可以通过 访问）。`s``i`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T19:38:41.150

问题出在这里：`for(int i=0;i<=s.length;i++)` 在 java 中，数组的**索引为 0** ，因此数组从 开始`0`并结束于`Length-1`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-30T19:38:45.860

你不在数组中，因为你使用`i<=s.length`但数组的最大索引是`s.length-1`

但是我对这个很感兴趣

```
String[] data = new String[(scn.nextLine()).length()];
data = (scn.nextLine()).split(","); 
```

为什么要创建空数组然后用新数组替换它？我想你想创造更像这样的东西

```
String[] data = scn.nextLine().split(","); 
```

早些时候，您基于第二行用户输入创建数组，因为您调用`scn.nextLine()`了两次。

# php - 为什么我的错误信息不起作用？

> ID：11277017
> 
> 赞同：0
> 
> 时间：2012-06-30T19:27:04.550
> 
> 标签：php

我有一个简单的表格，`$_Session`当密码错误时它不会打印我的错误消息。除了错误消息之外它工作正常，实际上错误消息在我输入之前一直有效`header("Location: /cms/");`。我做错了什么吗？

```
<?php 
session_start();
$error_msg = "";

if($_POST['username']) {

$username = $_POST['username'];
$password = $_POST['password'];

$admin = "a";
$adminpass = "s";

if(($username != $admin) || ($password != $adminpass)) {
$error_msg = 'Your login information is wrong dude!';
} 
else {
    $_SESSION['admin'] = '$username';
        header("Location: /cms/");
    exit();
}

}
if(!isset($_SESSION['admin'])) {
    header("Location: /cms/login");     
exit();
}
?>

<html>
<body>

<form action="/cms/loggedin.php" method="post" target=_self> 
<label>Username: <input type="text" name="username" id="username"></label>
<font color="#FF0000"><?php echo $error_msg; ?></font><br />

<br />
<label>Password: <input type="text" name="password" id="password"></label>
<br />
<br />
<label><input type="submit" name="Submit" value="Sign In"></label>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T19:30:28.617

`header("Location: /cms/");`- 这将在打印消息之前重定向到不同的页面，因此您将看不到该消息。

编辑 - 事实上`header("Location: /cms/login");`，如果发生错误，它将执行重定向，它不会找到会话变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T19:35:47.543

这是你应该改变的..

在您检查用户名和密码的地方：

```
if(($username != $admin) || ($password != $adminpass)) {
  $_SESSION['error'] = 'Your login information is wrong dude!';
} 
```

在 HTML 部分：

```
<?php 
    if (isset($_SESSION['error']))
    {
        echo '<p class="warning">',$_SESSION['error'],'</p>'; 
        unset( $_SESSION['error'] );
    }
?> 
```

另外，请学习如何编写正确的语义 HTML。该`<font>`标签已被弃用约 10 年，您的代码缺少`<!DOCTYPE`任何类型，并且`<br>`标签不适用于格式化布局。

哦，你可能会觉得[这篇文章](http://codeangel.org/articles/simple-php-template-engine.html)很有趣。

# jquery-ui - 带有 Web 服务的 jqGrid 不能以 jsonreader 格式工作

> ID：11277018
> 
> 赞同：0
> 
> 时间：2012-06-30T19:27:20.260
> 
> 标签：jquery-ui, jquery, jqgrid-formatter

我想要做的是，我有一个 Web 服务，它以 json 格式返回产品数量（来自示例 Northwind 数据库），我想将返回的行绑定到我的 jqGrid。我尝试[了 JQGrid - 无法调用 ASP.NET WebMethod 但可以使用 Ajax](https://stackoverflow.com/questions/5160045/jqgrid-cannot-call-asp-net-webmethod-but-can-with-ajax?lq=1) 但它不适用于我使用 Web 服务。

然后只是为了试用，我在创建 jqGrid 的同一个 aspx 页面中编写了 [Web Method]，然后它确实适用于 mtype：“POST”。下面是我的代码。

### 没有 Web 服务的工作代码

ASPX 中的代码：

```
<script language="javascript" type="text/javascript">
        $(function () {
            jQuery("#jqGridXML").jqGrid({
                url: "jqGridXML.aspx/GetProducts",
                mtype: "POST",
                ajaxGridOptions: { contentType: "application/json; charset=utf-8" },
                datatype: "json",
                serializeGridData: function (postData) {
                    return JSON.stringify(postData);
                },
                jsonReader: {
                root: function (obj) { return obj.d;},
                page:function (obj) {return 1;},
                total: function (obj) {return 1;},
                records:function (obj) { return obj.d.length;},
                id:"0",
                cell:"",
                repeatitems:false
            },
            datatype:"json",
            height:250,
            colName:['ProductId','ProductName','UnitsInStock'],
            colModel:[{name:'ProductId',index:'ProductId',width:100},
            {name:'ProductName',width:100},
            {name:'UnitsInStock',width:100}],
            caption:"Products"
        });
    });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <table id="jqGridXML"></table>
    <div id="pagerXML"></div>
    </form>
</body> 
```

**.cs 文件中的代码**

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public static List<Products> GetProducts()
{
    Products product = new Products();
    return product.GetProducts();
} 
```

这是可行的，但如果我不想在表单中编写 web 方法。我已将 Web 引用添加到我的应用程序并希望使用来自 Web 服务的数据。我在 jqGrid 中尝试过，但没有帮助我。

```
$(function () {
    jQuery("#jqGridXML").jqGrid({
        url: "http://localhost:49493/jqGrid_HttpHandlers/WebService.asmx/GetProducts",
        mtype: "POST", 
```

其余部分相同。

**Web 服务中的代码**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using System.Collections.Generic;
using System.Collections.ObjectModel;

/// <summary>
/// Summary description for WebService
/// </summary>
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class WebService : System.Web.Services.WebService
{

    public WebService()
    {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

    [WebMethod]
    [ScriptMethod(ResponseFormat=ResponseFormat.Json)]
    public static List<Products> GetProducts()
    {
        Products product =  new Products();
        return product.GetProducts();
    }

} 
```

你能帮我理解一些事情吗？我刚开始研究 jqGrid。

非常感谢您的帮助。

**编辑** 

是的，你是正确的戴夫。我只取消了以下语句的注释并删除了 static 并在没有任何修改的情况下运行了该项目，它确实运行良好。 

```
[System.Web.Script.Services.ScriptService]  
public class WebService : System.Web.Services.WebService 
```

谢谢，但我的下一个疑问是，我如何使用 jqGrids 导航器功能，例如分页，用相同的代码对这些东西进行排序。这个我用过   

```
jsonReader: { 
                root: function (obj) { return obj.d;}, 
                page:function (obj) {return 1;}, 
                total: function (obj) {return 1;}, 
                records:function (obj) { return obj.d.length;}, 
                id:"0", 
```

  但我真的不知道在我的代码中究竟需要在哪里使用它。您能否将我重定向到正确的解决方案。 

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T19:55:58.190

您需要取消注释该`[ScriptService]`属性（并且大多数其他装饰都是不必要的）。此外，该方法不能是静态的。[仅当您在 ASPX 代码后面声明方法时才需要这样做](http://encosia.com/why-do-aspnet-ajax-page-methods-have-to-be-static/)。

所以，像这样：

```
[WebService]
[ScriptService]
public class WebService : System.Web.Services.WebService
{
  [WebMethod]
  public List<Products> GetProducts()
  {
    Products product =  new Products();
    return product.GetProducts();
  }
} 
```

# c++ - 将 /EHa 添加到使用 Microsoft Visual C++ 编译器的 QtCreator

> ID：11277023
> 
> 赞同：6
> 
> 时间：2012-06-30T19:28:26.737
> 
> 标签：c++, visual-studio-2010, qt, visual-c++, qt-creator

如何`/EHa`在 QtCreator for MS Compiler 中添加（结构化异常处理）。我一直在使用 Microsoft Visual C++ 编译器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-07T10:54:22.207

这是如何做到的。适用于 Qt 4 和 Qt 5。这将设置 EHa 而不是默认的 EHsc：

```
win* {
   QMAKE_CXXFLAGS_EXCEPTIONS_ON = /EHa
   QMAKE_CXXFLAGS_STL_ON = /EHa
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:07:26.563

在您的项目文件中，添加：

```
QMAKE_CXXFLAGS += /EHa 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:50:37.230

只需转到 QtDIR 和 mkspecs 并选择编译器文件夹

然后打开 qmake.conf 并编辑

```
QMAKE_CFLAGS_RELEASE to 

QMAKE_CFLAGS_RELEASE = -EHA 
```

# python - python django API身份验证发布请求-在浏览器中显示json字符串的输出变量，但在打印时不显示

> ID：11277024
> 
> 赞同：1
> 
> 时间：2012-06-30T19:28:31.380
> 
> 标签：python, django, urllib2

```
def test(request):
    u="username"
    p= 'password'
    url='url'
    req = urllib2.Request(url)
    base64string = base64.encodestring('%s:%s' % (u , p )).replace('\n', '')
    d = {}
    req.add_data(d)  //while authentication i dont send any data, but it is treated as POST request only if data is sent, so sending empty data
    req.add_header("Authorization", "Basic %s" % base64string) 
    req.add_header('Accept', 'application/json')  
    result = urllib2.urlopen(req)

    print result
    return HttpResponse(result) 
```

在浏览器中，响应为 (bcoz of HttpResponse)

```
{"token":"abcdef"}  //means correct 
```

但是命令“打印结果”给出的是这样的：

```
<addinfourl at 140585554707088 whose fp = <socket._fileobject object at 0x7fdca009e5d0>> 
```

所以，我无法对该变量进行任何操作。我想要的只是字符串中的“令牌”值。我试过 ：

```
type(result) // error
json.dumps(result)  //error 
json.loads(result)  //error 
token = result.token     //error 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T19:31:12.870

你应该改用

```
result.read() 
```

`result`是结果对象。

# types - IDEA PHP 类型注解

> ID：11277027
> 
> 赞同：0
> 
> 时间：2012-06-30T19:29:05.340
> 
> 标签：types, annotations, intellij-idea, comments

我正在使用 IntelliJ IDEA 开发一个 PHP 项目。但是，在某些函数中，我得到了动态类型的变量，即我事先不知道它们是什么类型，例如，当我遍历一个对象数组时，IDEA 不知道其中的对象具有什么类型。

我的问题是：我怎样才能使用评论注释告诉 IDEA 哪些建议向我展示该对象？那会很方便，在此先感谢！我认为它会是这样的：

```
/* @type: $object:MyClassName */ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:08:01.143

请参阅[PHPDoc 支持](http://www.jetbrains.com/phpstorm/features/index.html#PHPDoc_support)和[phpdoc 建议 $this->someField 的类型](https://stackoverflow.com/questions/8750156/phpdoc-suggesting-type-for-this-somefield)。

# c# - 独立数字正则表达式？

> ID：11277029
> 
> 赞同：1
> 
> 时间：2012-06-30T19:29:11.963
> 
> 标签：c#, python, regex, numbers

我目前使用这个正则表达式：

```
(\d+) 
```

我可以得到2个字符串的问题：

> “2112343 和很多 4.99”

**或者**

> “4.99 和很多 2112343”

我从两者中得到这个：

```
[2112343, 4, 99] 
```

我只需要得到**2112343** ......我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-30T19:33:07.103

使用环视，您可以将捕获限制为仅不被其他数字或小数点包围的数字：

```
(?<![0-9.])(\d+)(?![0-9.]) 
```

或者，如果您只想匹配独立数字（例如，如果您不想匹配 123 in `abc123def`）：

```
(?<!\S)\d+(?!\S) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T19:33:30.260

试试这个

```
(?<!\S)\d+(?!\S) 
```

这将只匹配整数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T19:34:07.547

如果我理解正确，您也希望将这些数字与内部的一个点相匹配，但不希望将这些数字包含在结果集合中。

我会通过 2 个步骤来解决这个问题，首先选择所有数字，还有带点的数字：

```
(\d+(?:\.\d+)*) 
```

然后过滤掉不是纯数字的所有内容，并使用您的第一个正则表达式并将其应用于第一步生成的集合的每个项目：

```
(\d+) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T19:45:06.763

正如我在评论中发布的那样：

```
(?:^| )(\d+)(?:$| ) 
```

它将匹配完全由数字组成的所有“单词”（单词是由空格字符和/或字符串的开头/结尾包围的非空格字符的字符串。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-30T19:57:09.173

试试这个

```
(?<![0-9.])\d+(?![0-9.]) 
```

它使用模式

```
(?<!prefix)position(?!suffix) 
```

其中`(?<!prefix)position`表示：匹配位置不跟随前缀。

和 `position(?!suffix)` 表示：匹配位置不位于前面的后缀。

finally`[0-9.]`表示：任何数字或小数点。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-30T19:36:57.653

```
>>>r = re.match("\d+", "23423 in 3.4")
>>>r.group(0)
'23423' 
```

# events - 等到 Application.Calculate 完成

> ID：11277034
> 
> 赞同：26
> 
> 时间：2012-06-30T19:30:21.713
> 
> 标签：events, vba, excel

我可以强制我的 vba 脚本等到 Application.Calculate 完成重新计算所有公式吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-30T19:48:29.120

根据我的评论，您可以将 DoEvents 与`Application.CalculationState`. 看这个例子

```
Application.Calculate
If Not Application.CalculationState = xlDone Then
    DoEvents
End If
'~~> Rest of the code. 
```

如果你愿意，你也可以使用 a`Do While Loop`来检查`Application.CalculationState`

我也建议查看此链接

**主题**：Application.CalculationState 属性

**链接**：http: [//msdn.microsoft.com/en-us/library/bb220901%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/bb220901%28v=office.12%29.aspx)

**从上面的链接引用**

> 对于在 Microsoft Excel 中执行的任何计算，返回一个 XlCalculationState 常量，该常量指示应用程序的计算状态。只读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-28T17:59:28.010

接受的答案对我不起作用，因为“DoEvents 在计算完成之前不会阻塞，并且在您的示例代码中实际上是一个无操作”我遇到了同样的问题。最后，[这个](https://stackoverflow.com/questions/38998059/pause-vba-loop-until-sheet-is-recalculated)解决方案对我有用。

```
Do
    DoEvents
    Application.Calculate
Loop While Not Application.CalculationState = xlDone 
```

在手动计算模式下，有时 while 循环会进入长时间运行的过程。这就是为什么在下面添加的原因。

```
Application.Calculate 
```

# c# - C# 中的类型切换

> ID：11277036
> 
> 赞同：-1
> 
> 时间：2012-06-30T19:30:26.487
> 
> 标签：c#, switch-statement, system.reflection

我从[http://blogs.msdn.com/b/jaredpar/archive/2008/05/16/switching-on-types.aspx获取了以下代码](http://blogs.msdn.com/b/jaredpar/archive/2008/05/16/switching-on-types.aspx)

```
static class TypeSwitch {
    public class CaseInfo {
        public bool IsDefault { get; set; }
        public Type Target { get; set; }
        public Action<object> Action { get; set; }
    }

    public static void Do(object source, params CaseInfo[] cases) {
        var type = source.GetType();
        foreach (var entry in cases) {
            if (entry.IsDefault || type == entry.Target) {
                entry.Action(source);
                break;
            }
        }
    }

    public static CaseInfo Case<T>(Action action) {
        return new CaseInfo() {
            Action = x => action(),
            Target = typeof(T)
        };
    }

    public static CaseInfo Case<T>(Action<T> action) {
        return new CaseInfo() {
            Action = (x) => action((T)x),
            Target = typeof(T)
        };
    }

    public static CaseInfo Default(Action action) {
        return new CaseInfo() {
            Action = x => action(),
            IsDefault = true
        };
    }
} 
```

我正在做以下事情

```
TypeSwitch.Do(
                    p.PropertyType,
                    TypeSwitch.Case<Int32>(() => DoSomething),
                    TypeSwitch.Case<Double>(() => DoSomething),
                    TypeSwitch.Case<float>(() => DoSomething),
                    TypeSwitch.Case<bool>(() => DoSomething),
                    TypeSwitch.Case<String>(() => DoSomething),
                    TypeSwitch.Default(() => {                     
                        TypeSwitch.Do
                            (
                            p.PropertyType,
                            TypeSwitch.Case<Object[]>(() => Do()),
                            TypeSwitch.Case<IEnumerable<Object>>(() => Do()),
                            TypeSwitch.Case<IDictionary<Object, Object>>(() => Do()

                        )
                    ); 
```

p 是类型`PropertyInfo`。即使 p.PropertyType 是 String ，它也会进入 Default Case .. 为什么？不应该破吗？如果 TypeSwitch 中缺少某些东西，我该如何解决？

编辑

我不知道为什么每个人都认为我没有先调试它并继续进行投票。但我确实为此投入了大量时间。我检查了，我只是将 ProprtyType 作为 String 传递，它循环通过 CaseInfo 处理所有内容，然后转到 Do 并执行 Default Case .. 问题是我缺少什么？ ![在此处输入图像描述](../Images/b420e90b7d7f8a2b4103dcf5ae05f59f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T19:38:35.650

原因是您传入`p.PropertyType`并稍后获取`source.GetType()`在这种情况下评估为`typeof(Type)`.

可能，您想创建一个将 的实例`Type`作为第一个参数的重载（与 相比`object`）。

**您可以通过使用调试器单步执行代码来自己发现此类错误。将实际变量值与预期值进行比较。**

# postgresql - Postgresql 根据列值在哪里不同？

> ID：11277040
> 
> 赞同：0
> 
> 时间：2012-06-30T19:30:56.413
> 
> 标签：postgresql

是否可以根据其中一列的值在执行查询时动态更改 where 子句？也就是说，假设（这是一个完全虚构的例子）我有一张学生表，参加过的课程，以及他们是否迟到。我想为每个学生查看自上次迟到以来上过的所有课程的列表。所以查询看起来像这样：

```
SELECT student, class, classdate
FROM attendance
WHERE classdate>(<<SOME QUERY that selects the most recent tardy for each student>>)
ORDER BY student,classdate; 
```

或者，把它放到更多的编程术语中，也许更清楚：

```
for studentName in (SELECT distinct(student) FROM attendance):
    SELECT student, class, classdate
    FROM attendance
    WHERE classdate>(SELECT classdate 
                     FROM attendance 
                     WHERE tardy=true AND student=studentName
                     ORDER BY classdate DESC
                     LIMIT 1)
    ORDER BY classdate; 
```

有没有办法用一个查询来做到这一点，还是我需要为每个学生做一个单独的查询（基本上按照上面的循环）？实际用例解释起来更复杂（它与证明记录有关，以及需要查看哪些记录），但在概念上是相同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T19:48:43.403

只需为表使用多个别名（例如`a1`and `a2`）`attendance`，这样您就可以在子查询中引用“外部”表别名：

```
SELECT student, class, classdate
FROM attendance a1
WHERE classdate>(SELECT classdate 
                 FROM attendance a2
                 WHERE tardy=true AND a2.student=a1.student
                 ORDER BY classdate DESC
                 LIMIT 1)
ORDER BY classdate; 
```

# c# - WebBrowser 的新实例永远不会加载？

> ID：11277046
> 
> 赞同：2
> 
> 时间：2012-06-30T19:31:52.930
> 
> 标签：c#, internet-explorer, windows-phone-7, browser, windows-phone

目前我的 xaml 页面中有一个 WebBrowser 对象，如果我调用`browser.Navigate(uri)`，页面加载正常，但是如果我尝试通过调用 重置 WebBrowser `browser = new WebBrowser();`，然后是 Navigate ，什么也没有发生；浏览器只是保持空白。

我已经尝试了一切让浏览器在重新初始化后启动，但似乎没有任何效果。这是平台的限制还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T19:56:57.503

您创建了一个新控件，而无需将其挂在控件的可视化树中。请问您为什么首先创建一个新控件？似乎您只想用新的替换旧的。重置控件还不够吗？

# r - 在 R 2.15.0 中安装 Rcpp 包

> ID：11277047
> 
> 赞同：2
> 
> 时间：2012-06-30T19:32:20.743
> 
> 标签：r, installation, rcpp

我在 R 中安装“Rcpp”包时遇到问题。安装命令适用于所有包，但不适用于这个包。R错误是：

包“Rcpp”不可用（对于 R 版本 2.15.0）

我正在使用 Windows Vista。请帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-30T19:50:03.043

从[Rcpp 的 CRAN 状态页面可以看出](http://cran.r-project.org/web/packages/Rcpp/index.html)，它现在取决于 R (>= 2.15.1)。

因此，您可以将 R 从 2.15.0 更新到 2.15.1（这不是一个坏主意），或者您可以尝试安装旧的 Rcpp 版本，例如 0.9.10，它将与 R 2.15.0 一起使用。

# c# - 什么是 PHP 的 mysql_fetch_array 函数的 C# 等效项？

> ID：11277058
> 
> 赞同：3
> 
> 时间：2012-06-30T19:34:14.957
> 
> 标签：c#, sql, equivalent

我正在学习 C#/ASP.NET，我想知道以下 PHP 代码的 C# 等价物是什么？我知道用户 ID，我想从这个表中获取行到变量“row”的数组中，所以我可以将它用作“row['name']”和“row['email']。

```
$result = mysql_query("SELECT email, name FROM mytable WHERE id=7");

while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
    printf("Email: %s  Name: %s", $row["email"], $row["name"]);
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:00:13.697

我不确定这是否相同，`mysql_fetch_array`但我假设。您可以使用[`IDBCommmand.ExecuteReader`](http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executereader.aspx)创建一个[`IDataReader`](http://msdn.microsoft.com/en-us/library/system.data.idatareader.aspx)并使用它来填充`Object[]`行的所有字段。

例如（使用 SQL-Server）：

```
// use using statements to ensure that connections are disposed/closed (all implementing IDisposable)
using (var con = new SqlConnection(Properties.Settings.Default.ConnectionString))
using (var cmd = new SqlCommand("SELECT email, name FROM mytable WHERE id=@id", con))
{
    cmd.Parameters.AddWithValue("@id", ID);  // use parameters to avoid sql-injection
    con.Open();
    using (var reader = cmd.ExecuteReader())
    {
        while (reader.Read())
        { 
            var fields = new object[reader.FieldCount];
            // following fills an object[] with all fields of the current line, 
            // is this similar to mysql_fetch_array?
            int count  = reader.GetValues(fields);
        }
    }
} 
```

**编辑**：

> 我并不是要让它尽可能相似，但是我将如何在 C# 中获得相同的最终结果（带有结果的变量）

那是口味问题。您可以使用某种 ORM，例如 Enity-Framework、NHibernate、LINQ-To-SQL 或 Stackoverflow 的 Micro-ORM [Dapper.NET](http://www.codeproject.com/Articles/212274/A-Look-at-Dapper-NET)（我目前正在使用的）或普通的 ADO.NET（如上所示）。

您可以使用您手动填充的自定义类，`DataReader`或者使用`DataTable`自动加载的模式。

例如（这里使用 MySQL）：

```
DataTable tblEmail = new DataTable();
using (var con = new MySqlConnection(Properties.Settings.Default.MySQL))
using (var da = new MySqlDataAdapter("SELECT Email, Name FROM Email WHERE id=@id", con))
{
    da.SelectCommand.Parameters.AddWithValue("@id", ID);
    da.Fill(tblEmail);
}

if (tblEmail.Rows.Count == 1)
{
    DataRow row  = tblEmail.Rows[0];
    String email = row.Field<String>("Email");
    String name  = row.Field<String>("Name");
} 
```

如您所见，.NET 中有很多方法。我只用 ADO.NET 展示了两个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:15:56.137

没有真正的等价物。作为过去的 PHP 开发人员，我想说最接近的事情是使用数据适配器并填充数据表。这是对[DbDataAdapter.Fill](http://msdn.microsoft.com/en-us/library/905keexk.aspx)的引用。

我不确定 MySql 驱动程序，但如果您使用的是 Sql Server，这里有一些代码可以帮助您入门：

```
using (var connection = new SqlConnection(connectionString))
{
    var table = new DataTable("tbl_objects");
    var adapter = new SqlDataAdapter();
    adapter.SelectCommand = new SqlCommand("SELECT * FROM tbl_name", connection);
    adapter.Fill(table);
} 
```

然后，您可以遍历表中的行：

```
foreach(var row in table)
{
    Console.WriteLine("{0}", row["ColumnName"]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:04:50.763

您需要连接到数据库。

假设您使用的是 mysql 和 odbc 连接。

```
var connectionString = "DRIVER={MySQL ODBC 3.51 Driver};" +
                     "SERVER=localhost;" +
                     "DATABASE=test;" +
                     "UID=venu;" +
                     "PASSWORD=venu;" +
                     "OPTION=3");

using (OdbcConnection connection = new OdbcConnection(connectionString))
{
    OdbcCommand command = new OdbcCommand("SELECT email, name FROM mytable WHERE id=7", connection);

    connection.Open();

    // Execute the DataReader and access the data.
    OdbcDataReader reader = command.ExecuteReader();
    while (reader.Read())
    {
        //do stuff with the data here row by row the reader is a cursor
    }

    // Call Close when done reading.
    reader.Close(); 
```

或者，您可以使用 odbcdataadapter 和数据表，如果您希望将所有结果放在可以像数组一样使用的表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T19:38:40.960

您可以使用 foreach 循环遍历结果，如下所示：

```
 foreach(var row in result)
  { 
      console.writeline("Email:" + row.Email, "Name:", row.Name);
  } 
```

那是你要找的那种东西吗？

编辑

事实上，我刚刚看到你只有一个结果。

然后你可以完全跳过 foreach 循环

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-30T21:39:45.633

.net 中最接近的等价物是这样的......

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;

namespace ConsoleApplication5
{
    class Program
    {
        static void Main(string[] args)
        {
            var foo = MySqlHelper.ExecuteDataRow("Server=myServerAddress;Database=myDataBase;Uid=myUsername;Pwd=myPassword;", "select * from foo");
            Console.WriteLine(foo["Column"]);
        }
    }
} 
```

我假设您使用的是 MySql 数据连接器[http://dev.mysql.com/downloads/connector/net/](http://dev.mysql.com/downloads/connector/net/)

请注意.net 中有更好的方法可以连接到数据库，但我认为逐行来说，这与 PHP 一样接近。

# objective-c - 初学者在 Objective-C 中苦苦挣扎

> ID：11277060
> 
> 赞同：4
> 
> 时间：2012-06-30T19:34:27.017
> 
> 标签：objective-c

我正在关注一本 Objective-c 的书（Fairbairns、Fahrenkrug、Ruffenach 的 Objective-c 基础知识），我在他们的 CoinToss 示例中遇到了第一个障碍。

我在这一行收到“预期表达式”错误：

```
￼￼￼result.text = coinLandedOnHeads ? @"Heads" : @"Tails"; 
```

我还附上了下面整个页面的屏幕截图。究竟是什么问题？我已经检查并仔细检查了代码与书的相同，但是我错过了一些非常明显的东西吗？

谢谢！

![xcode 窗口](../Images/4f7b794890787b836502ac181431d174.png)

编辑：这是我的头文件：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController {
    UILabel *status;
    UILabel *result;
}

@property (nonatomic, retain) IBOutlet UILabel *status;
@property (nonatomic, retain) IBOutlet UILabel *result;

-(IBAction)callHeads;
-(IBAction)callTails;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T19:42:16.070

我很清楚你的问题。

书已经过时了。创建项目时，您选择了“自动引用计数”复选框。这意味着，您不必执行 dealloc。这不是你的错，Xcode 只是有一个新的自动内存管理功能，而且这本书已经足够老了，以至于它让你手动完成。

要解决这个问题：

完全删除 dealloc 方法

或者，

重新启动您的项目，不要勾选“自动引用计数”复选框。

# asp.net - 如何让服务器上的进程在插入数据库 x 秒后检查数据库中的条目

> ID：11277062
> 
> 赞同：0
> 
> 时间：2012-06-30T19:34:44.597
> 
> 标签：asp.net, sql-server

我有一个应用程序，将订单发送给服务员处理。但是，服务员有 30 秒的时间来确认他接受了订单，否则将被传递到下一个。如何在插入条目后 30 秒检查订单表中的 IsAccepted 列是否标记为 true？

我正在寻找一个尽可能简单的解决方案。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T19:39:39.123

最简单的事情是在插入后启动一个计时器以触发 30 秒。

有关不同计时器类的比较，请参阅MSDN 上[.NET Framework 类库](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)中的比较计时器类。

只需确保在滴答事件处理程序（或`Elapsed`处理程序或与您选择的计时器相对应的任何处理程序）中停止计时器。

# batch-file - 检查 UAC 状态

> ID：11277065
> 
> 赞同：5
> 
> 时间：2012-06-30T19:35:08.687
> 
> 标签：batch-file, uac

如何编写一个批处理文件来运行检查是否通过以下方式启用了 UAC：

```
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA 
```

如果结果为：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System EnableLUA    REG_DWORD    **0x1**) 
```

如果结果为：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System EnableLUA    REG_DWORD    **0x0**) 
```

然后脚本应根据结果运行不同的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:09:34.820

You could simply search for one or the other value with either `FIND` or `FINDSTR` and invoke commands depending on the result of the search. The pattern would basically be like this:

```
^(REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA) | (
  FIND "0x1" >NUL
) && (
  *command(s)_to_run_when_UAC_is_enabled*
) || (
  *command(s)_to_run_when_UAC_is_disabled*
) 
```

I.e. the `REG` produces an output which is passed, using the "pipe" (`|`) to the input of `FIND`. `FIND` looks for `0x1` in its input, and, depending on the result of the search, one of the following bracketed blocks of commands is executed.

The `command && command || command` is a standard mechanism that allows you to selectively run commands, a kind of replacement for `IF`. The first command produces a result. The command just after `&&` runs if the result is "success", and the command just after `||` runs in case of a fail.

If you need to perform actions in both cases, use both `&&` and `||` after the command generating the result, but if only one kind of result should be reacted to, you can leave out either `&&` or `||`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-22T03:21:01.977

查看有关`EnableLUA` [此处](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/958053ae-5397-4f96-977f-b7700ee461ec)的 Microsoft 文档：

```
@echo off
for /f "skip=2 tokens=3" %%a in ('reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA') do if "%%a" equ "0x0" (
rem When UAC is disabled
) ELSE (
rem When UAC is enabled
) 
```

# python - 如何使用自定义 python 类型参数发出 PySide 信号？

> ID：11277068
> 
> 赞同：4
> 
> 时间：2012-06-30T19:35:59.970
> 
> 标签：python, qt, signals-slots, pyside

我在 PySide python Qt 程序中正确使用信号时遇到问题。我想发出一个信号，该信号采用自定义 python 类型的单个参数。[文件](http://www.pyside.org/docs/pyside-git/newsigslot.html) 说_

> 可以使用 QtCore.signal() 类定义信号。Python 类型和 C 类型可以作为参数传递给它。

所以我尝试了以下方法：

```
from PySide import QtCore
from PySide.QtCore import QObject

class Foo:
    pass

class Bar(QObject):
    sig = QtCore.Signal(Foo)

    def baz(self):
        foo = Foo()
        self.sig.emit(foo)

bar = Bar()
bar.baz() 
```

但是得到以下错误：

```
Traceback (most recent call last):
  File "test.py", line 15, in <module>
    bar.baz()
  File "test.py", line 12, in baz
    self.sig.emit(foo)
TypeError: sig() only accepts 0 arguments, 1 given! 
```

相反，如果我从 QObject 派生 Foo 类，则程序运行不会出错。但是我是否应该能够将我的自定义类型作为参数传递给信号，即使该类型不是从 QObject 派生的？

这适用于 Windows 7 上的 python 2.7.2 和 PySide 1.0.4。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T00:25:27.107

您创建了一个[“旧式类”](http://docs.python.org/reference/datamodel.html#new-style-and-classic-classes)，显然不支持将其作为信号参数类型。

该类应该从另一个新样式类或基`object`类型继承：

```
class Foo(object):
    pass 
```

# c# - 在 C# 中使用 DirectX11 和 SlimDX 的 Nvidia 3d 视频

> ID：11277069
> 
> 赞同：13
> 
> 时间：2012-06-30T19:36:05.580
> 
> 标签：c#, nvidia, direct3d, directx-11, slimdx

美好的一天，我正在尝试使用 nvidia 3DVision 和两个 IP 摄像机显示实时立体视频。我对 DirectX 完全陌生，但尝试在此站点和其他站点上完成一些教程和其他问题。现在，我正在为左眼和右眼显示两个静态位图。一旦我的程序的这部分工作正常，这些将被我相机中的位图所取代。这个问题[NV_STEREO_IMAGE_SIGNATURE 和 DirectX 10/11 (nVidia 3D Vision)](https://stackoverflow.com/questions/7377861/nv-stereo-image-signature-and-directx-10-11-nvidia-3d-vision)对我有很大帮助，但我仍在努力让我的程序正常工作。我发现我的快门眼镜开始正常工作，但只显示右眼的图像，而左眼保持空白（鼠标光标除外）。

这是我生成立体图像的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;

using SlimDX;
using SlimDX.Direct3D11;
using SlimDX.Windows;
using SlimDX.DXGI;

using Device = SlimDX.Direct3D11.Device;            // Make sure we use DX11
using Resource = SlimDX.Direct3D11.Resource;

namespace SlimDxTest2
{
static class Program
{
    private static Device device;               // DirectX11 Device
    private static int Count;                   // Just to make sure things are being updated

    // The NVSTEREO header. 
    static byte[] stereo_data = new byte[] {0x4e, 0x56, 0x33, 0x44,   //NVSTEREO_IMAGE_SIGNATURE         = 0x4433564e; 
    0x00, 0x0F, 0x00, 0x00,                                           //Screen width * 2 = 1920*2 = 3840 = 0x00000F00; 
    0x38, 0x04, 0x00, 0x00,                                           //Screen height = 1080             = 0x00000438; 
    0x20, 0x00, 0x00, 0x00,                                           //dwBPP = 32                       = 0x00000020; 
    0x02, 0x00, 0x00, 0x00};                                          //dwFlags = SIH_SCALE_TO_FIT       = 0x00000002

    [STAThread]
    static void Main()
    {

        Bitmap left_im = new Bitmap("Blue.png");        // Read in Bitmaps
        Bitmap right_im = new Bitmap("Red.png");

        // Device creation 
        var form = new RenderForm("Stereo test") { ClientSize = new Size(1920, 1080) };
        var desc = new SwapChainDescription()
        {
            BufferCount = 1,
            ModeDescription = new ModeDescription(1920, 1080, new Rational(120, 1), Format.R8G8B8A8_UNorm),
            IsWindowed = false, //true,
            OutputHandle = form.Handle,
            SampleDescription = new SampleDescription(1, 0),
            SwapEffect = SwapEffect.Discard,
            Usage = Usage.RenderTargetOutput
        };

        SwapChain swapChain;
        Device.CreateWithSwapChain(DriverType.Hardware, DeviceCreationFlags.Debug, desc, out device, out swapChain);

        RenderTargetView renderTarget;          // create a view of our render target, which is the backbuffer of the swap chain we just created
        using (var resource = Resource.FromSwapChain<Texture2D>(swapChain, 0))
            renderTarget = new RenderTargetView(device, resource);

        var context = device.ImmediateContext;                  // set up a viewport
        var viewport = new Viewport(0.0f, 0.0f, form.ClientSize.Width, form.ClientSize.Height);
        context.OutputMerger.SetTargets(renderTarget);
        context.Rasterizer.SetViewports(viewport);

        // prevent DXGI handling of alt+enter, which doesn't work properly with Winforms
        using (var factory = swapChain.GetParent<Factory>())
            factory.SetWindowAssociation(form.Handle, WindowAssociationFlags.IgnoreAll);

        form.KeyDown += (o, e) =>                   // handle alt+enter ourselves
        {
            if (e.Alt && e.KeyCode == Keys.Enter)
                swapChain.IsFullScreen = !swapChain.IsFullScreen;
        };

        form.KeyDown += (o, e) =>                   // Alt + X -> Exit Program
        {
            if (e.Alt && e.KeyCode == Keys.X)
            {
                form.Close();
            }
        };

        context.ClearRenderTargetView(renderTarget, Color.Green);       // Fill Screen with specified colour

        Texture2DDescription stereoDesc = new Texture2DDescription()
        {
            ArraySize = 1,
            Width = 3840,
            Height = 1081,
            BindFlags = BindFlags.None,
            CpuAccessFlags = CpuAccessFlags.Write,
            Format = SlimDX.DXGI.Format.R8G8B8A8_UNorm,
            OptionFlags = ResourceOptionFlags.None,
            Usage = ResourceUsage.Staging,
            MipLevels = 1,
            SampleDescription = new SampleDescription(1, 0)
        };

        // Main Loop 
        MessagePump.Run(form, () =>
        {
            Texture2D texture_stereo =  Make3D(left_im, right_im);      // Create Texture from two bitmaps in memory
            ResourceRegion stereoSrcBox = new ResourceRegion { Front = 0, Back = 1, Top = 0, Bottom = 1080, Left = 0, Right = 1920 };
            context.CopySubresourceRegion(texture_stereo, 0, stereoSrcBox, renderTarget.Resource, 0, 0, 0, 0);
            texture_stereo.Dispose();

            swapChain.Present(0, PresentFlags.None);
        });

        // Dispose resources 

        swapChain.IsFullScreen = false;     // Required before swapchain dispose
        device.Dispose();
        swapChain.Dispose();
        renderTarget.Dispose();

    }

    static Texture2D Make3D(Bitmap leftBmp, Bitmap rightBmp)
    {
        var context = device.ImmediateContext;
        Bitmap left2 = leftBmp.Clone(new RectangleF(0, 0, leftBmp.Width, leftBmp.Height), PixelFormat.Format32bppArgb);     // Change bmp to 32bit ARGB
        Bitmap right2 = rightBmp.Clone(new RectangleF(0, 0, rightBmp.Width, rightBmp.Height), PixelFormat.Format32bppArgb);

        // Show FrameCount on screen: (To test)
        Graphics left_graph = Graphics.FromImage(left2);
        left_graph.DrawString("Frame: " + Count.ToString(), new System.Drawing.Font("Arial", 16), Brushes.Black, new PointF(100, 100));
        left_graph.Dispose();

        Graphics right_graph = Graphics.FromImage(right2);
        right_graph.DrawString("Frame: " + Count.ToString(), new System.Drawing.Font("Arial", 16), Brushes.Black, new PointF(200, 200));
        right_graph.Dispose();
        Count++;

        Texture2DDescription desc2d = new Texture2DDescription()
        {
            ArraySize = 1,
            Width = 1920,
            Height = 1080,
            BindFlags = BindFlags.None,
            CpuAccessFlags = CpuAccessFlags.Write,
            Format = SlimDX.DXGI.Format.R8G8B8A8_UNorm,
            OptionFlags = ResourceOptionFlags.None,
            Usage = ResourceUsage.Staging,
            MipLevels = 1,
            SampleDescription = new SampleDescription(1, 0)
        };

        Texture2D leftText2 = new Texture2D(device, desc2d);        // Texture2D for each bmp
        Texture2D rightText2 = new Texture2D(device, desc2d);

        Rectangle rect = new Rectangle(0, 0, left2.Width, left2.Height);
        BitmapData leftData = left2.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
        IntPtr left_ptr = leftData.Scan0;
        int left_num_bytes = Math.Abs(leftData.Stride) * leftData.Height;
        byte[] left_bytes = new byte[left_num_bytes];
        byte[] left_bytes2 = new byte[left_num_bytes];

        System.Runtime.InteropServices.Marshal.Copy(left_ptr, left_bytes, 0, left_num_bytes);       // Get Byte array from bitmap
        left2.UnlockBits(leftData);
        DataBox box1 = context.MapSubresource(leftText2, 0, MapMode.Write, SlimDX.Direct3D11.MapFlags.None);
        box1.Data.Write(left_bytes, 0, left_bytes.Length);
        context.UnmapSubresource(leftText2, 0);

        BitmapData rightData = right2.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
        IntPtr right_ptr = rightData.Scan0;
        int right_num_bytes = Math.Abs(rightData.Stride) * rightData.Height;
        byte[] right_bytes = new byte[right_num_bytes];

        System.Runtime.InteropServices.Marshal.Copy(right_ptr, right_bytes, 0, right_num_bytes);       // Get Byte array from bitmap
        right2.UnlockBits(rightData);
        DataBox box2 = context.MapSubresource(rightText2, 0, MapMode.Write, SlimDX.Direct3D11.MapFlags.None);
        box2.Data.Write(right_bytes, 0, right_bytes.Length);
        context.UnmapSubresource(rightText2, 0);

        Texture2DDescription stereoDesc = new Texture2DDescription()
        {
            ArraySize = 1,
            Width = 3840,
            Height = 1081,
            BindFlags = BindFlags.None,
            CpuAccessFlags = CpuAccessFlags.Write,
            Format = SlimDX.DXGI.Format.R8G8B8A8_UNorm,
            OptionFlags = ResourceOptionFlags.None,
            Usage = ResourceUsage.Staging,
            MipLevels = 1,
            SampleDescription = new SampleDescription(1, 0)
        };
        Texture2D stereoTexture = new Texture2D(device, stereoDesc);    // Texture2D to contain stereo images and Nvidia 3DVision Signature

        // Identify the source texture region to copy (all of it) 
        ResourceRegion stereoSrcBox = new ResourceRegion { Front = 0, Back = 1, Top = 0, Bottom = 1080, Left = 0, Right = 1920 };

        // Copy it to the stereo texture 
        context.CopySubresourceRegion(leftText2, 0, stereoSrcBox, stereoTexture, 0, 0, 0, 0);
        context.CopySubresourceRegion(rightText2, 0, stereoSrcBox, stereoTexture, 0, 1920, 0, 0);   // Offset by 1920 pixels

        // Open the staging texture for reading and go to last row
        DataBox box = context.MapSubresource(stereoTexture, 0, MapMode.Write, SlimDX.Direct3D11.MapFlags.None);
        box.Data.Seek(stereoTexture.Description.Width * (stereoTexture.Description.Height - 1) * 4, System.IO.SeekOrigin.Begin);
        box.Data.Write(stereo_data, 0, stereo_data.Length);            // Write the NVSTEREO header 
        context.UnmapSubresource(stereoTexture, 0);

        left2.Dispose();
        leftText2.Dispose();
        right2.Dispose();
        rightText2.Dispose();
        return stereoTexture;
    } 

} 
```

}

我尝试了各种将立体图像的 Texture2D 包括签名 (3840x1081) 复制到后台缓冲区的方法，但是我尝试过的方法都没有显示这两个图像......任何帮助或评论将不胜感激，Ryan

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T09:16:30.363

如果使用 DirectX11.1 是一个选项，则有一种更简单的方法来启用立体功能，而不必依赖 nVidia 的字节向导。基本上，您创建 a`SwapChan1`而不是常规的`SwapChain`，然后它就像设置`Stereo`为 True 一样简单。

看看我发的这篇[文章](http://www.avengersutd.com/blog/2013/07/directx11-1-stereoscopy-and-you/)，它向您展示了如何创建立体交换链。该代码是对 MS 自己的立体声示例的 C# 的移植。然后你将有两个渲染目标，它更简单。在渲染之前，您必须：

```
void RenderEye(bool rightEye, ITarget target)
{
    RenderTargetView currentTarget = rightEye ? target.RenderTargetViewRight : target.RenderTargetView;
    context.OutputMerger.SetTargets(target.DepthStencilView, currentTarget);
    [clean color/depth]
    [render scene]
    [repeat for each eye]
} 
```

其中 ITarget 是一个类的接口，提供对后台缓冲区、渲染目标等的访问。就是这样，DirectX 将处理所有事情。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T12:38:37.023

您是连续渲染图像还是至少渲染几次？我在 DX9 中做同样的事情，必须告诉 DX 在驱动程序识别为 3D 视觉之前渲染 3 帧。你的眼镜开了吗？您的后备缓冲区是否 = (width*2), (Height+1) 并且您是否像这样编写后备缓冲区：

```
_________________________
|           |            |      
|  img1     |     img2   |
|           |            |
--------------------------
|_______signature________| where this last row = 1 pix tall 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T12:29:23.787

我记得几天前在 Nvidia 开发者论坛上搜索时看到了同样的问题。不幸的是，由于最近的黑客攻击，论坛已关闭。我记得那个线程上的 OP 能够使用签名 hack 使其与 DX11 和 Slimdx 一起工作。您不使用stretchRectangle 方法，它类似于createResuroseRegion()，但不是我不记得了。可能是在堆栈溢出的类似线程中找到的这些方法 CopyResource() 或 CopySubresourceRegion()。 [将纹理复制到纹理](https://stackoverflow.com/questions/3249279/copy-texture-to-texture)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T08:03:26.410

尝试创建宽度 = 1920 而不是 3840 的后缓冲区。将每个图像拉伸到宽度的一半并将它们并排放置。

# php - 将文件内容作为 include() 函数返回

> ID：11277070
> 
> 赞同：0
> 
> 时间：2012-06-30T19:36:09.107
> 
> 标签：php, oop, class, methods, include

我有 2 种类型的页面：动态（位于 db 中）和静态（基于文件，如 page.php） 我不想将 index.php 与一堆 if 或 switch 搞乱。所以我创建了类和方法。现在，我想做的是：

```
$page->getContent($pgdata("token")); 
```

getContent 函数检查页面令牌

*   如果它是动态页面，则从数据库中获取内容并简单地回显来自 db 的数据（它是 100% 干净的）
*   如果页面是静态的...问题从这里开始我的静态页面是基于文件的。在这种情况下，我想要做的是，如果我使用`include()`而不是`$page->getContent($pgdata("token"));`on ，则使函数表现为`index.php`。我可以做什么？读取内容`$pgdata("token").php`并作为方法输出返回？注意：$pgdata("token").php 中也有 php 函数。所以我不能像字符串一样输出 $pgdata("token").php 文件的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T19:45:28.227

```
function getContent($name) {
  ...
  if($static) {
    ob_start();
    include "$name.php";
    $content = ob_get_contents();
    ob_end_clean();
    return $content;
  }
} 
```

我不确定我是否正确理解您，但我相信您正在尝试将 PHP 文件的内容加载到变量中？如上所述，您可以使用输出缓冲来做到这一点。

# ruby - 如何优化 ruby 代码在一个范围内迭代多个整数？

> ID：11277072
> 
> 赞同：1
> 
> 时间：2012-06-30T19:36:19.910
> 
> 标签：ruby

Ruby 新手，并试图找到一个 3 位数字“abc”：

```
for a in 0..9
    for b in 0..9
        for c in 0..9
            if a*a+b*b+c*c == (100*a+10*b+c)/11.0
                puts "#{a}#{b}#{c}"
            end
        end
    end
end 
```

这太冗长了，有什么方法可以优化它，或者用另一种“ruby”方式编写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:06:29.933

解决方案来自：[Wolfram Alpha](http://www.wolframalpha.com/input/?i=a+%2a+a+%2B+b+%2a+b+%2B+c+%2a+c+%3D%3D+%28100+%2a+a+%2B+10+%2a+b+%2B+c%29+%2F+11.0) :)

这是另一个有趣的解决方案。不是真的更快，只是更紧凑，如果你正在寻找的话，可能更像红宝石：

```
(0..9).to_a.repeated_permutation(3).select { |a,b,c| 
  a*a+b*b+c*c == (100*a+10*b+c)/11.0 
}
=> [[0, 0, 0], [5, 5, 0], [8, 0, 3]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T21:45:41.603

This is equivalent to finding a,b,c such that

```
100*a + 10*b + c = 11 * (a*a + b*b +c*c) 
```

i.e. `100*a + 10*b + c` must be divisible by 11\. Simple number theory tells you that when a,b,c are digits, this means that

```
`a + c - b` 
```

must be a multiple of 11 so

```
`a + c = b or a + c = 11 +b` 
```

So for a given values of a and b you only need to check two values of c : b -a and 11 +b -a rather than 10\. You can cut the search space in two again: if a > b you only need to check the latter of those two values and if a <= b you need only check the former.

Thus instead of checking 1000 triplets of numbers you should only need to check 100, which should be 10 times faster.

```
for a in 0..9
  for b in 0..9
    if a > b
      c = 11 +b -a
    else
      c = b - a
    end
    if a*a+b*b+c*c == (100*a+10*b+c)/11.0
      puts "#{a}#{b}#{c}"
    end
  end
end 
```

# node.js - 连接节点的有效版本 v0.8.1

> ID：11277074
> 
> 赞同：0
> 
> 时间：2012-06-30T19:36:48.083
> 
> 标签：node.js

我正在尝试将连接 v2.3.5 与节点 0.8.1 一起使用 - 有人知道这是否稳定（我也在 Ubuntu 11 上使用 express v2.5.11）。只要我知道截止连接版本，我就可以转移到适用于节点 0.8.1 并表达 2.5.11 的旧版本连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:30:38.657

我移至旧版本的连接 - v1.8.5 并且我没有遇到我之前遇到的路径/fs 问题。

# android - 如何将JSON经纬度放在地图上

> ID：11277078
> 
> 赞同：1
> 
> 时间：2012-06-30T19:38:08.283
> 
> 标签：android, mysql, google-maps

> **可能重复：**
> [如何将 JSON lOutput（纬度和经度）放在地图上](https://stackoverflow.com/questions/11280531/how-to-put-json-loutput-latitude-and-longitude-on-the-map)

我有一个主要活动来解析我的 mysql 中的 JSON 数据（表跟踪：纬度和经度）现在我想将此数据传递到我的 MapActivity 并显示在谷歌地图上。非常感谢任何帮助。谢谢！

这是我的 JSONactivity

```
public class JSONActivity extends Activity{
private JSONObject jObject;

private String xResult ="";
//Seusuaikan url dengan nama domain 
private String url = "http://10.0.2.2/labiltrack/daftartracking.php";

@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.daftartrack);
    TextView txtResult = (TextView)findViewById(R.id.TextViewResult);
    //url += "?lattitude=" + UserData.getEmail();
    xResult = getRequest(url);
     try {
            parse(txtResult);
        } catch (Exception e) {
            e.printStackTrace();
        }
}

private void parse(TextView txtResult) throws Exception {
    // TODO Auto-generated method stub
    jObject = new JSONObject(xResult);
    JSONArray menuitemArray = jObject.getJSONArray("joel");
    String sret="";
    //int j = 0;
    for (int i = 0; i < menuitemArray.length(); i++) {
        sret +=menuitemArray.getJSONObject(i).
                getString("lattitude").toString()+" : ";
        System.out.println(menuitemArray.getJSONObject(i)
                .getString("lattitude").toString());
        System.out.println(menuitemArray.getJSONObject(i).getString(
        "longitude").toString());
        sret +=menuitemArray.getJSONObject(i).getString(
        "lattitude").toString()+"\n";   
        //j=i;
    }txtResult.setText(sret);

}
/**
 * Method untuk Mengirimkan data keserver
 * event by button login diklik
 *
 * @param view
 */
private String getRequest(String url) {
    // TODO Auto-generated method stub
    String sret="";
    HttpClient client = new DefaultHttpClient();
    HttpGet request = new HttpGet(url);
    try{
      HttpResponse response = client.execute(request);
      sret =request(response);

    }catch(Exception ex){
        Toast.makeText(this,"jo "+sret, Toast.LENGTH_SHORT).show();
    }
    return sret;
}

/**
 * Method untuk Menenrima data dari server
 * @param response
 * @return
 */
private String request(HttpResponse response) {
    // TODO Auto-generated method stub

    String result = "";
    try{
        InputStream in = response.getEntity().getContent();
        BufferedReader reader = new BufferedReader(new InputStreamReader(in));
        StringBuilder str = new StringBuilder();
        String line = null;
        while((line = reader.readLine()) != null){
            str.append(line + "\n");
        }
        in.close();
        result = str.toString();
    }catch(Exception ex){
        result = "Error";
    }
    return result;
    }
} 
```

这是我的 mapActivity

```
public class mapactivity extends MapActivity {
private MapView mapView;
MapController mc;
GeoPoint p;
//private MyLocationOverlay me = null;

class MapOverlays extends com.google.android.maps.Overlay
{

    @Override
    public boolean draw (Canvas canvas, MapView mapView, boolean shadow, long when)
    {
        super.draw(canvas, mapView, shadow);

        //translate the geopoint to screen pixels
        Point screenPts = new Point();
        mapView.getProjection().toPixels(p, screenPts);

        //tambah marker
        Bitmap bmp = BitmapFactory.decodeResource(getResources (), R.drawable.pin_red);
        canvas.drawBitmap(bmp, screenPts.x, screenPts.y-50, null);
        //mapView.setSatellite(true);       

        return true;
    }  

     @Override
     public boolean onTouchEvent(MotionEvent event, MapView mapView) 
     {   
         //---when user lifts his finger---
         if (event.getAction() == 1) {                
             GeoPoint p = mapView.getProjection().fromPixels(
                 (int) event.getX(),
                 (int) event.getY());

             Toast.makeText(getBaseContext(), 
                     p.getLatitudeE6() / 1E6 + "," + 
                     p.getLongitudeE6() /1E6 , 
                     Toast.LENGTH_SHORT).show();
             mc.animateTo(p);

                //geocoding 
             Geocoder geoCoder = new Geocoder(
                 getBaseContext(), Locale.getDefault());
             try {
                 List<Address> addresses = geoCoder.getFromLocation(
                     p.getLatitudeE6()  / 1E6, 
                     p.getLongitudeE6() / 1E6, 1);

                 String add = "";
                 if (addresses.size() > 0) 
                 {
                     for (int i=0; i<addresses.get(0).getMaxAddressLineIndex(); 
                          i++)
                        add += addresses.get(0).getAddressLine(i) + "\n";
                 }

                 Toast.makeText(getBaseContext(), add, Toast.LENGTH_SHORT).show();
             }
             catch (IOException e) {                
                 e.printStackTrace();
             }   
             return true;
         }
         else                
             return false;
     }      }         

/** Called when the activity is first created. */
   @SuppressWarnings("deprecation")
@Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mapview1);

    //utk mnampilkan zoom
    mapView = (MapView) findViewById(R.id.mapView);
    LinearLayout zoomLayout = (LinearLayout)findViewById(R.id.zoom);  
    View zoomView = mapView.getZoomControls(); 

        zoomLayout.addView(zoomView, 
            new LinearLayout.LayoutParams(
            LayoutParams.FILL_PARENT, 
            LayoutParams.FILL_PARENT)); 
        mapView.displayZoomControls(true);       

        //menampilkan default peta banda aceh 
        mc = mapView.getController();
        String coordinates[] = {"5.550381", "95.318699"};
        double lat = Double.parseDouble(coordinates[0]);
        double lng = Double.parseDouble(coordinates[1]);

            p = new GeoPoint(
            (int) (lat * 1E6), 
            (int) (lng * 1E6));

            mc.animateTo(p);
            mc.setZoom(14); 
            mapView.invalidate();

            //tambah marker
            MapOverlays mapOverlay = new MapOverlays();
            List<Overlay> listOfOverlays = mapView.getOverlays();
            listOfOverlays.clear();
            listOfOverlays.add(mapOverlay);        

            mapView.invalidate();
            }

     public void btnSatelitClick(View v){
    mapView.setSatellite(true);
    mapView.setStreetView(false);

 }

  public void btnjalanClick (View v){
    mapView.setSatellite(false);
    mapView.setStreetView(true);
    }

            protected boolean isRouteDisplayed() 
            {
                //auto generate method
                return false;
            }

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T19:42:06.070

因为你只需要传递变量，所以使用意图并传递数据......而且我认为你已经编写了其余的代码

**放入要打开 mapActivity 的 JSONActivity ，并且您还拥有变量纬度和经度及其值**

```
Intent i= new Intent(getApplicationContext(), mapActivity.class);
i.putExtra("lattitude",lattitude);
i.putExtra("longitude",longitude);
startActivity(i); 
```

**然后在新的活动 mapActivity 中，检索这些值：**

**代替这个 put`String coordinates[] = {"5.550381", "95.318699"};`**

```
 Bundle extras = getIntent().getExtras();
  if(extras !=null) {
    String lattitude= extras.getString("lattitude");
    String longitude= extras.getString("longitude");

     double lat = Double.parseDouble(lattitude);
    double lng = Double.parseDouble(longitude);

} 
```

# entity-framework - 在 Azure AppFabric 中缓存实体框架结果

> ID：11277085
> 
> 赞同：2
> 
> 时间：2012-06-30T19:38:42.053
> 
> 标签：entity-framework, caching, azure, appfabric, entity-framework-4.3

我试图弄清楚如何在 Azure AppFabric 缓存中缓存 EF 查询结果。目前我正在使用 LoreSoft EntityFramework 扩展来处理缓存（http://bit.ly/LWSywm）。它与内存缓存完美配合，但与跨多个 VM 的 AppFabric 配合得并不好。问题是我的 EF 对象中有虚拟属性，它们被序列化为动态代理对象，当然不能在不同的 VM 上反序列化，甚至在单个 VM 重新启动应用程序之后也不能反序列化。

我只有几个需要缓存的查询，所以我不想在整个项目中手动加载每个相关的对象。有什么方法可以序列化具有虚拟属性的 EF 对象？在我反序列化它们之后，我不需要虚拟属性神奇地再次开始延迟加载。我尝试在序列化结果之前关闭延迟加载 DbContext，但这不起作用。我发现获得可序列化 EF 对象的唯一方法是删除所有虚拟属性。

顺便说一句，我在这里看过 Julie Lerman 的文章：http: [//bit.ly/LWToZT](http://bit.ly/LWToZT)

似乎是一个很酷的项目，但我不完全确定它会解决我无法序列化 EF 对象的问题。如果我只想在我开始的地方结束，就不想走那条路。

任何想法最受赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:44:07.373

您可以将 dbcontext（或对象上下文）配置为不使用代理对象。显然，这意味着没有更改跟踪和延迟加载。如果您不急于加载对象的导航属性，它们将只是 null 而不是对代理的引用。值得注意的是，您可以在上下文的整个生命周期中打开和关闭它，因此这不是一个全有或全无的决定。

如果您使用 DbContext，则语法为：

```
context.Configuration.ProxyCreationEnabled = false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:14:49.633

我们也遇到过类似的问题。我们有一个服务，它返回使用 EF 从数据库中读取的数据。这些数据需要缓存在 Appfabric 中。

在我们的例子中，服务返回 DTO 对象，所以我们将 EF 对象映射到 DTO 对象，然后将 DTO 对象存储在 Appfabric 缓存中。

# c++ - C++ if 语句没有正确测试

> ID：11277090
> 
> 赞同：-9
> 
> 时间：2012-06-30T19:39:17.007
> 
> 标签：c++, if-statement, console, tic-tac-toe

我正在尝试制作井字游戏，它可以在我可以插入 X 的范围内工作，但计算机只能插入一个 O。由于这是井字游戏，我需要计算机能够插入更多比一零。如果已经有一个值为 o 的变量，则每次运行此代码时，它都不会将另一个变量更改为值 o。我认为问题在于 if 语句。很抱歉没有明确说明我的问题。如果仍然没有意义，您可以编译我的其余代码。然后你可能会明白我的意思。

这[是剩下的](http://troop-89.org/code.html)

这就是我认为的问题所在。

```
bool j=true ;
int lo=0;
string hi [9]={a,b,c,d,e,f,g,h,i};
while(j==true)
{
  if (lo>8)
  {
    j=false;
  }
  else if(hi[lo]!="x"&&hi[lo]!="o")
  {
    hi[lo]="o";
    j=false;
  }
  else
  {
    lo=lo+1;
    j=true;
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T19:45:50.480

如果我可以重写你的代码：

```
for (lo = 0; lo < 9; lo++){
  if (hi[lo] == " "){
    hi[lo] = "o";
    break;
  }
} 
```

所以你是对的，它插入了一个“o”。

问题是什么？

编辑：由于您正在尝试编写井字游戏，所以让我建议一些整体伪代码：

```
repeat
  ask user where they want to place an "x" (i.e. get a number from 0 to 8)
  if that square is not blank, say so and ask again
  else put the "x" in the square
  If this completes a row, column, or diagonal, exit saying "You win!"
-> enter the loop here if you are making the first move
  then find out where to put an "o". You do this by looking at all unoccupied squares.
  for each unoccupied square
    look at the row, column, and diagonal it is on
    if putting an "o" there would make you the winner, give it a really high score
    if putting an "o" there would block the user from winning, give it a high score
    if putting an "o" there would mean that you could win on the following move, give it a medium score
    Otherwise give it a score that is the number of rows, columns, and diagonals it could possibly tie up
    end for each
  Then put the "o" on the highest-scored square (or one of the highest-scored squares if there are more than one)
  If you completed a row, column, or diagonal, exit saying "I win!".
  If you can't find a square to mark, exit saying "I give up".
end repeat 
```

我敢肯定有比这更短的版本。它就在我的脑海中。

# php - PhoneGap jQuery POST 不工作

> ID：11277094
> 
> 赞同：0
> 
> 时间：2012-06-30T19:39:59.447
> 
> 标签：php, jquery, ajax, post, cordova

晚上好，

我用不同的语法尝试了很长时间，但没有成功：一切都在 PhoneGap 上运行。我得到了`console_log`before `$.ajax..`，但之后没有任何错误或输出。单击“提交”后，将执行此 JS 代码：

```
 console.log(in_mail + " " + in_text);
        $.ajax({
            type: 'POST',
            data: "mail="+in_mail+'&amp;text='+in_text,
            url: 'http://example.com/comment.php',
            success: function(data){
                console.log(data);
                alert('Your comment was successfully added');
            },
            error: function(){
                console.log(data);
                alert('There was an error adding your comment');
            }
        });
 console.log("POST done"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:09:11.890

Two things:

1.  If you are executing this script via submit button you should consider returning true on success and false on error.
2.  Your "POST DONE" would execute before the success or error functions would be invoked because post is asynchronous.

I have reproduced the example with jsFiddle you can find it here [http://jsfiddle.net/jUBMN/](http://jsfiddle.net/jUBMN/)

# javascript - 如何从在 JS 中用作参数的匿名函数中分配外部范围变量？

> ID：11277097
> 
> 赞同：0
> 
> 时间：2012-06-30T19:40:42.047
> 
> 标签：javascript, scope

（想不出任何更简单的方法来写这个标题，但代码应该解释它）。

这是我的代码：

```
function logIn(email, password) {
   var response;
   Parse.User.logIn(email, password, {
     success: function(user) {
       response = [true, user];
     },
     error: function(user, error) {
       response = [false, "Error: " + error.code + " " + error.message];
     }
   });
   return response; // still undefined :(
} 
```

如何正确返回`response`此函数以便定义它？只是放入`return response`成功：和错误：回调显然不会返回外部 logIn() 函数，所以我有点难过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T19:42:21.437

```
alert(response); 
```

之前正在执行

```
response = ... 
```

因为您的`Parse.User.logIn`函数不会立即运行它的回调。如果是这样，那么您将没有问题。

```
function logIn(email, password, callback) {
   Parse.User.logIn(email, password, {
     success: function(user) {
       callback([true, user]);
     },
     error: function(user, error) {
       callback([false, "Error: " + error.code + " " + error.message]);
     }
   });
}

logIn(..., ..., function(response) {

}); 
```

但是，在这一点上，该功能是否服务于任何目的变得值得怀疑。为错误和成功设置单独的函数可能会更好。

# total-commander - 总指挥官重命名文件夹中的文件

> ID：11277103
> 
> 赞同：0
> 
> 时间：2012-06-30T19:41:43.327
> 
> 标签：total-commander

我需要重命名文件夹中的文件。

**每个 foder 包含下一个文件：**

1.png

2.png

3.png

**我需要重命名如下：**

1.png > a.png

2.png > b.png

3.png > c.png

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-21T16:18:04.873

1.  在 TotalCmd 中打开所需的文件夹并选择要重命名的文件（Ctrl-A 用于所有文件）
2.  按 Ctrl-M 打开多重重命名对话框
3.  将字符串“[Ca]”（不带引号）填充到“重命名掩码文件名”字段中，然后单击按钮“开始！”

您可以将字符串“[Ca]”中的字母“a”替换为任何字母或数字，并且重命名序列将以此字符开头（对于输出文件“aaa.png”、“aab.png”，请尝试“[Caaa]”。 png”，“aac.png”，...）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T19:49:24.387

下面是我从 shell 提示符重命名 PictsFolder 中的一堆文件的操作。

创建一个名为 rename.sh 的文件

```
#!/bin/bash
cd /Users/jscarry/Desktop/PictsFolder
mv 1.png a.png
mv 2.png b.png
exit 
```

chmod 它是可执行的，然后从命令行运行它。

```
jscarry$ /Users/jscarry/Files/renamePicts.sh 
```

请务必转义文件名中的特殊字符，例如空格。

例如 File\ Name\ With\ Spaces.png

# autocad - 在 AutoCAD 2012 中为终身添加库一次

> ID：11277106
> 
> 赞同：0
> 
> 时间：2012-06-30T19:42:20.803
> 
> 标签：autocad, cad, autodesk

我使用的是 Autocad 2012。每次打开 Autocad 时我都需要上传库。打开 Autocad 2012 时，有什么方法可以避免这种情况并默认加载 libs 文件？

请让我知道需要做什么。

注意：一些库是默认的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T05:23:08.320

见[http://www.jtbworld.com/lisp/acad_lsp.htm](http://www.jtbworld.com/lisp/acad_lsp.htm) & [http://through-the-interface.typepad.com/through_the_interface/2006/09/automatic_loadi.html](http://through-the-interface.typepad.com/through_the_interface/2006/09/automatic_loadi.html)

# java - android.view.InflateException: Binary XML file line #4: Error inflating class SwitchPreference

> ID：11277110
> 
> 赞同：4
> 
> 时间：2012-06-30T19:42:47.733
> 
> 标签：java, android

我正在尝试阅读我的应用偏好设置，但出现此错误：

设置活动：

```
public class Settings extends PreferenceActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);

        try
        {
            addPreferencesFromResource(R.xml.prefs);
        }
        catch (Exception ex)
        {
            Log.e("errorSettings", Log.getStackTraceString(ex));
        }
    }
} 
```

首选项 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <PreferenceCategory android:title="General">
    <SwitchPreference
        android:title="Downloader"
        android:defaultValue="true"
        android:key="useDownloader"
        android:summary="Enable to use" />
    </PreferenceCategory>

</PreferenceScreen> 
```

在应用程序清单上我设置了这个：

```
<uses-sdk android:minSdkVersion="9" android:targetSdkVersion="15" /> 
```

我得到的第一个错误是：

```
android.view.InflateException: Binary XML file line #4: Error inflating class SwitchPreference 
```

预先感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-30T19:48:15.200

`SwitchPreference`在 API 级别 14 中添加。您不能在早期版本的 Android 上使用它。由于您正在尝试支持回到 API 级别 9，因此您可以：

1.  对早期版本使用不同的偏好 XML，使用 a`CheckBoxPreference`而不是 a `SwitchPreference`，或

2.  现在只需使用`CheckBoxPreference`并丢弃`SwitchPreference`

# parsing - LL(1) 语法问题

> ID：11277111
> 
> 赞同：1
> 
> 时间：2012-06-30T19:42:57.233
> 
> 标签：parsing, grammar, ambiguity, ll, left-recursion

对于 Mini Java 的子语法，我有 26 条规则语法。该语法应该是非面向对象的。无论如何，我一直在尝试对它进行左分解并删除左递归。但是，我用 JFLAP 对其进行了测试，但它告诉我它不是 LL(1)。我遵循了 Aho-Sethi 书中算法的每一步。

你能给我一些建议吗？

```
Goal ::= MainClass $
MainClass ::= class <IDENTIFIER> { MethodDeclarations public static void main ( ) {
    VarDeclarations Statements } }
    VarDeclarations ::= VarDeclaration VarDeclarations | e
VarDeclaration ::= Type <IDENTIFIER> ;
MethodDeclarations ::= MethodDeclaration MethodDeclarations | e
MethodDeclaration ::= public static Type <IDENTIFIER> ( Parameters ) {
    VarDeclarations Statements return GenExpression ; }
Parameters ::= Type <IDENTIFIER> Parameter | e
Parameter ::= , Type <IDENTIFIER> Parameter | e
Type ::= boolean | int
Statements ::= Statement Statements | e
Statement ::= { Statements }
        |   if ( GenExpression ) Statement else Statement
        |   while ( GenExpression ) Statement
        |   System.out.println ( GenExpression ) ;
        |   <IDENTIFIER> = GenExpression ;
GenExpression ::= Expression | RelExpression
Expression ::= Term ExpressionRest
ExpressionRest ::= e | + Term ExpressionRest | - Term ExpressionRest
Term ::= Factor TermRest
TermRest ::= e | * Factor TermRest
Factor ::= ( Expression )
        |   true
        |   false
        |   <INTEGER-LITERAL>
        |   <IDENTIFIER> ArgumentList
ArgumentList ::= e | ( Arguments )
RelExpression ::= RelTerm RelExpressionRest
RelExpressionRest ::= e | && RelTerm RelExpressionEnd
RelExpressionEnd ::= e | RelExpressionRest
RelTerm ::= Term RelTermRest
RelTermRest ::= == Expression | < Expression | ExpressionRest RelTermEnding
RelTermEnding ::= == Expression | < Expression
Arguments ::= Expression Argument | RelExpression Argument | e
Argument ::= , GenExpression Argument | e 
```

每个`<IDENTIFIER>`都是有效的 Java 标识符，并且`<INTEGER-LITERAL>`是一个简单的整数。每个`e`产生式代表一个 epsilon 产生式，`$`第一条规则中的 是文件结束标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:04:25.090

我想我发现了两个问题（可能还有更多）：

问题 #1

在 MainClass 你有

```
MethodDeclarations public static void main 
```

MethodDeclaration 是

```
public static Type | e 
```

这不是 LL(1)，因为当解析器看到“public”时，它无法判断它是 MethodDeclaration 还是“public static void main”方法。

问题 #2

```
Arguments ::= Expression Argument | RelExpression Argument | e 
```

两种表达方式：

```
Expression ::= Term ExpressionRest 
```

...和RelExpression：

```
RelExpression ::= RelTerm RelExpressionRest
RelTerm ::= Term RelTermRest 
```

...以“Term”开头，因此也不是 LL(1)。

我会选择 LL(k) 或 LL(*)，因为它们允许您编写更易于维护的语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:19:27.943

有什么可以防止 IDENTIFIER 与您的保留字之一相同吗？如果不是，那么您的语法将是模棱两可的。我没有看到任何其他东西。

如果一切都失败了，我会删除除最后一行之外的所有语法，并对其进行测试。如果通过了，我会一次添加每一行，直到找到问题行。

# string - 优化字符串出现次数

> ID：11277113
> 
> 赞同：1
> 
> 时间：2012-06-30T19:43:08.963
> 
> 标签：string, matlab, optimization, vectorization

我必须计算某个字符串包含在单元格数组中的频率。问题是代码是减慢它需要将近 1 秒才能做到这一点的方式。

```
 uniqueWordsSize = 6; % just a sample number
    wordsCounter = zeros(uniqueWordsSize, 1);
    uniqueWords = unique(words); % words is a cell-array

    for i = 1:uniqueWordsSize
        wordsCounter(i) = sum(strcmp(uniqueWords(i), words));
    end 
```

我目前正在做的是将 uniqueWords 中的每个单词与单元格数组单词进行比较，并使用 sum 来计算 strcmp 返回的数组的总和。

我希望有人可以帮助我优化它.... 6 个单词的 1 秒实在是太多了。

编辑： ismember 甚至更慢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:13:49.710

您可以使用`unique`with的第三个输出完全删除循环`hist`：

```
words = {'a','b','c','a','a','c'}
[uniqueWords,~,wordOccurrenceIdx]=unique(words)
nUniqueWords = length(uniqueWords);
counts = hist(wordOccurrenceIdx,1:nUniqueWords)

uniqueWords = 
    'a'    'b'    'c'
wordOccurrenceIdx =
     1     2     3     1     1     3
counts =
     3     1     2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T09:12:26.677

不使用显式 fors 的棘手方法..

```
clc
close all
clear all

Paragraph=lower(fileread('Temp1.txt'));

AlphabetFlag=Paragraph>=97 & Paragraph<=122;  % finding alphabets

DelimFlag=find(AlphabetFlag==0); % considering non-alphabets delimiters
WordLength=[DelimFlag(1), diff(DelimFlag)];
Paragraph(DelimFlag)=[]; % setting delimiters to white space
Words=mat2cell(Paragraph, 1, WordLength-1); % cut the paragraph into words

[SortWords, Ia, Ic]=unique(Words);  %finding unique words and their subscript

Bincounts = histc(Ic,1:size(Ia, 1));%finding their occurence
[SortBincounts, IndBincounts]=sort(Bincounts, 'descend');% finding their frequency

FreqWords=SortWords(IndBincounts); % sorting words according to their frequency
FreqWords(1)=[];SortBincounts(1)=[]; % dealing with remaining white space

Freq=SortBincounts/sum(SortBincounts)*100; % frequency percentage

%% plot
NMostCommon=20;
disp(Freq(1:NMostCommon))
pie([Freq(1:NMostCommon); 100-sum(Freq(1:NMostCommon))], [FreqWords(1:NMostCommon), {'other words'}]); 
```

# css - 如何使 div 高度取决于里面的内容？

> ID：11277114
> 
> 赞同：9
> 
> 时间：2012-06-30T19:43:18.227
> 
> 标签：css, html

我嵌套`div`了 s，其中大多数是 s，`float:left; display:block;`就像这样做：

```
<div class="container" style="display:block;">
    <div style="float:left; display:block; height:100px;">
    <div style="float:left; display:block; height:100px;">
</div> 
```

我希望`div`容器在不设置高度的情况下变得更大。目前是一条直线。
如何设置inner `div`s，让容器有高度？

**TL;DR**：目前我可以看到 2 inside`div`很好，但容器是平的`div`（没有高度）。
我如何给它一个高度？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-30T19:48:38.467

你有两个选择：

```
<div class="container" style="overflow:hidden">
    <div style="float:left; height:100px;">
    <div style="float:left; height:100px;">
</div> 
```

或者

```
<div class="container">
    <div style="float:left; height:100px;">
    <div style="float:left; height:100px;">
    <div style="clear:left">
</div> 
```

请注意，`overflow:hidden`元素将环绕浮动的内部元素。或者，您可以使用一个元素来清除浮动，这也将使周围的元素包装它的内容。

另一个提示：您不必声明 div 是`display:block`. 在 HTML 中，基本上有 2 种类型的元素，`block`和`inline`. div 是`block`默认的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T19:44:57.053

添加`overflow:hidden`到该 DIV。

# jquery - 通过变量传递的值选择选择选项

> ID：11277117
> 
> 赞同：6
> 
> 时间：2012-06-30T19:43:45.617
> 
> 标签：jquery, select, option

我有一个包含以下代码的 html 文件：

```
<select id="gouv" name="gouv">
...some options here...
</select> 
```

和以下 jQuery 代码：

```
$('#gouv option[value="myvalue"]').attr("checked","checked"); 
```

正如您当然知道的那样，将值为“myvalue”的选项设置为检查哪个工作正常。

现在的问题是，我不知道要设置为选中的选项的值，因为该值是存储在全局变量中的某个函数的结果。为简单起见，经过长时间调试，我将问题简化为以下内容：

```
var ident="myvalue";
$('#gouv option[value=ident]').attr("checked","checked"); 
```

而且这段代码不起作用！

我想知道为什么它不起作用，我们不能将值作为变量传递吗？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-30T19:44:40.157

```
var ident="myvalue";
$('#gouv option[value="' + ident + '"]').attr("selected", "selected"); 
```

`selected`是为`<option>`，`checked`是为收音机！

`prop`如果您的 jQuery 版本 > 1.6 ，则更好地使用

```
$('#gouv option[value="' + ident +'"]').prop("selected", true); 
```

请注意，您最好使用`filter`而不是属性选择器：

```
$('#gouv option').filter(function(){
    return this.value == indent;
}).prop("selected", true); 
```

[为什么你应该`filter`使用价值](https://stackoverflow.com/a/10651376/601179)

如果您需要支持黑莓，他们有 jQuery 处理的 option.value 错误：

```
$('#gouv option').filter(function(){
    return $(this).val() == indent;
}).prop("selected", true); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-30T19:52:58.677

jQuery `.val()`（[见这里](http://api.jquery.com/val/#val2)）将按值选择一个选项：

```
var ident = "myvalue";
$('#gouv').val(ident); 
```

这相当于：

```
var ident = "myvalue";
$('#gouv option[value="' + ident + '"]').attr("selected", "selected"); 
```

`ident`除了后者如果包含任何双引号会有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-05T06:52:51.500

我尝试了以上所有答案，（毫无疑问它们是正确的）但它们对我不起作用不知道原因，不知何故我发现以下一行代码很容易工作，我的下拉值没有改变对于前视图，即使当我单击下拉选择时它会发生变化。所以对我来说，解决方案是

```
$('#nights').show().focus().click(); 
```

# database - CouchDB：良好的文档 ID 以降低存储要求

> ID：11277120
> 
> 赞同：1
> 
> 时间：2012-06-30T19:44:27.187
> 
> 标签：database, hash, nosql, couchdb, b-tree

所以我做了一些研究，显然存储需求会随着密钥大小而显着增加。

实际上，我希望能够使用“long int”作为我的密钥，但这不可能，因为 couchdb 要求密钥是正确的字符串？有什么办法可以规避这个吗？

因为我的身份证看起来像：

```
{ "_id" : "10209939", ....data here ... }
{ "_id" : "10209940", ....data here ... }
{ "_id" : "10209941", ....data here ... } 
```

我想让它们保持数字来进行范围查询。但是由于存储随着密钥长度的增加而增加，所以我的存储会爆炸。从某种意义上说，这些表示为字符串的 id 占用了更多的字节，如果它们被解释为长整数的话。

有没有人有使用“数字”整数作为 ids 存储文档的经验？鉴于 couchdb 将“_id”理解为字符串，您如何获得良好的存储效率？我们可以告诉它，不，它是“long int”而不是字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:51:48.300

id 必须是一个字符串。别无选择。

您可以进行范围查询，但只能进行词法范围 - 而不是数字范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T08:32:53.523

除非您的文档大小*非常*小，否则 id 不会很重要。我建议您进行一些测试并确认不同方法之间实际损失了多少空间。不要忘记在进行测试之前进行压缩，并记住使用 CouchDB 1.2.0 数据压缩也已启用，因此也会减少大 id 的影响。

严格的要求是 RFC [http://www.ietf.org/rfc/rfc4627.txt](http://www.ietf.org/rfc/rfc4627.txt)中的 JSON UTF-8 更多细节。您应该确保在可能的情况下插入具有顺序增加的 id 的文档，因为这减少了 b-tree 重新平衡的需要。当然，您也可以稍后通过使用压缩来解决这个问题。

在大多数情况下，对您的 id 使用最明智的方法是在您需要唯一性的情况下使用有意义的值。CouchDB 仅对 id 强制执行唯一性，因此您不妨将其计算在内！

# java - 试图让 rake sunspot:solr:run 执行

> ID：11277126
> 
> 赞同：1
> 
> 时间：2012-06-30T19:45:01.500
> 
> 标签：java, ruby-on-rails, sunspot-rails, sunspot-solr

我正在尝试让 gem sunspot_rails 和 sunspot_solr 启动并运行。[我从https://github.com/sunspot/sunspot/issues/160](https://github.com/sunspot/sunspot/issues/160)下载了所有最新的 gem 并实施了补丁建议，但我仍然收到如下所示的错误。

似乎有些文件被复制了，但它被挂在了某个地方。我在 Windows 7 系统上，64 位使用 rails 版本 3.2.6 和 gem 'sunspot_rails' 版本 1.3.3 和 gem 'sunspot_solr' 版本 1.3.3。我花了几个小时试图弄清楚这一点，任何帮助将不胜感激！

```
$ rake sunspot:solr:run

java version "1.6.0_24"
Java(TM) SE Runtime Environment (build 1.6.0_24-b07)

Java HotSpot(TM) Client VM (build 19.1-b02, mixed mode)

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/admin-extra.html => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/admin-extra.html

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/elevate.xml => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/elevate.xml

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/mapping-ISOLatin1Accent.txt => C:/Users/Molly Struve/My Documents/AptanaStudio 3 Workspace/WaterCooler/solr/conf/mapping-ISOLatin1Accent.txt

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/protwords.txt => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/protwords.txt

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/schema.xml => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/schema.xml

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/scripts.conf => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/scripts.conf

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/solrconfig.xml => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/solrconfig.xml

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/spellings.txt => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/spellings.txt

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/stopwords.txt => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/stopwords.txt

Copying c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/sunspot_solr-1.3.3/solr/solr/conf/synonyms.txt => C:/Users/Molly Struve/My Documents/Aptana Studio 3 Workspace/WaterCooler/solr/conf/synonyms.txt

Exception in thread "main" java.lang.NoClassDefFoundError: Struve/My\
Caused by: java.lang.ClassNotFoundException: Struve.My\
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
Could not find the main class: Struve/My\.  Program will exit.`java version "1.6.0_24" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T06:48:31.800

当源路径中有空间时会出现此问题。将您的代码移动到“C:/WaterCooler”之类的路径并尝试。

# asp.net - ASP.NET 将用户本地日期和时间与系统时间匹配

> ID：11277127
> 
> 赞同：1
> 
> 时间：2012-06-30T19:45:05.227
> 
> 标签：asp.net, timezone

我在理解如何将用户当前日期和时间与服务器时间相匹配时遇到了一些麻烦。

示例：假设我有一个用户可以注册自己的网站。一种配置文件选项是他们可以选择当地时区。为此，有一个下拉菜单，他们可以从中选择正确的时区。因此，来自中国的用户可能会选择 (UTC+08:00) 北京、重庆、香港、乌鲁木齐，来自洛杉矶的另一个用户将选择 (UTC-07:00) 山区时间（美国和加拿大）（我假设）和来自巴黎的人将选择 (UTC+01:00) 布鲁塞尔、哥本哈根、马德里、巴黎。

Web 应用程序在美国的服务器上运行，具有特定的时区......

现在......所有这些用户都希望在下周五的 19:00 收到**他们当地时区**的电子邮件通知！！！

在这里，我迷路了...对于所有这些用户来说，下周五 19:00 肯定不是同一时间...

如何映射他们的个人资料时区，以便我网站上运行的服务将在下周五 19:00 用户本地时区发送电子邮件通知？？？

我目前正处于这个阶段......用所有时区填充下拉菜单，以便用户可以在他们的个人资料中选择他们当前的时区。

当页面加载比下拉列表填充时区时：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        ddlUserTimeZone.DataSource = GetTimeZones();
        ddlUserTimeZone.DataTextField = "Name";
        ddlUserTimeZone.DataValueField = "ID";
        ddlUserTimeZone.DataBind(); 
    }

    public Collection<TimeZoneItem> GetTimeZones()
    {
        Collection<TimeZoneItem> timeZones = new Collection<TimeZoneItem>();
        foreach (var timeZoneInfo in TimeZoneInfo.GetSystemTimeZones())
        {
            timeZones.Add(new TimeZoneItem 
            { 
                TimeZoneName = timeZoneInfo.DisplayName, 
                TimeZoneID = timeZoneInfo.Id 
            });

        }

        return timeZones;
    }

    public struct TimeZoneItem
    {
        public string TimeZoneName { get; set; }
        public string TimeZoneID { get; set; }
    } 
```

现在，你们能帮忙将个人资料时区与当前时间匹配，以便在正确的时间发送电子邮件吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:41:42.363

Are you just setting up this service? If so, ***run your web servers and database servers on Universal Time Coordinated*** (UTC or Zulu) time, not a local time zone. Everything is far easier to manage if you do that. I learned this the hard way.

UTC used to be called Greenwich Mean Time; it is timezone +00:00\. It doesn't change for daylight savings time like US and European local time does.

This time zone thing is a pain, and worth getting right. Some countries have half-hour time zones.

At any rate, once you know each user's preferred time zone, and the time she wants her notification, you can then convert the time from local to UTC and store it.

Try something like this to get the user's hour and minute into UTC. (Time zone conversions need a date, because they depend on daylight savings time rules. There's one more complication. On the day when a time zone switches from daylight to standard, or vice versa, the UTC time for a notification will change. Most people handle this by recomputing the UTC date and time of the next notification (tomorrow's notification) as they send each notification. Consider this code.

```
TimeZoneInfo userLocal =            ;//user's time zone
int hour =                          ;//whatever the user wants
int minute =                        ;//whatever the user wants

DateTime tomorrow = DateTime.Now.AddDays(1);
int year = tomorrow.Year;
int month = tomorrow.Month;
int day = tomorrow.Day;
DateTime notificationTime = new DateTime(year,month,day,
                                         hour,minute,0, 
                                         DateTimeKind.Unspecified);
DateTime tomorrowNotificationTime = TimeZoneInfo.ConvertTimeToUtc(
                                         notificationTime,userLocal); 
```

This should get you the UTC time you need to deliver this user's notification tomorrow, in the correct time zone for tomorrow's date.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:04:35.937

理想情况下，日期时间应以 UTC 格式存储在服务器上。

您的服务器上有以下数据

*   用户的时区信息。
*   用户需要通知的时间。
*   您服务器上的当前本地时间。

    ```
    // Convert current local server time to UTC.
    var serverUtc = DateTime.UtcNow;

    // Convert UTC time to users local time. This gives you the date and time as per the user.
    var userTimeZone = TimeZoneInfo.GetSystemTimeZones()[0]; // just an example. Replace with actual value.
    var userCurrentTime = TimeZoneInfo.ConvertTime(serverUtc, userTimeZone);

    /*
    add a day to userCurrentTime till its Friday. Add/subtract minutes till its 7:00PM.
    */

    var expectedNotificationTimeUtc = TimeZoneInfo.ConvertTimeToUtc(userCurrentTime, userTimeZone);
    /*
    1\. store the expectedNotificationTimeUtc as the time you want to send the email. 
    2\. your service can check for users their expectedNotificationTimeUtc and 
         if the UtcNow is within an acceptable range of the that time, send the email.
    */ 
    ```

# iphone - 如何使用 UIWebView 加载一个又一个页面？

> ID：11277130
> 
> 赞同：0
> 
> 时间：2012-06-30T19:45:23.813
> 
> 标签：iphone, ios, xcode, ipad, uiwebview

在我的应用程序中，我有一组 URL，我希望将它们按顺序加载到单个 UIWebView 中。因此，每个人都会等待前一个人完成加载，然后再开火。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T19:49:09.343

为您`UIWebView`将其委托设置为自我，并添加以下功能

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    //Load the other request  
} 
```

# sql - ORA 00904 错误：标识符无效

> ID：11277135
> 
> 赞同：8
> 
> 时间：2012-06-30T19:46:05.510
> 
> 标签：sql, oracle, ora-00904

我已经在我的虚拟 XP 中安装了 Oracle 10g 并使用创建了一个表

```
create table reg1 (
  fname varchar2(30),
  lname varchar2(30),
  addr varchar2(30),
  mail varchar2(30),
  occu varchar2(30),
  uname varchar2(30),
  passwd varchar2(30)
); 
```

并且表创建成功。但是当我试图通过简单的查询来获取值时

```
select fname, lname 
  from reg1 
 where uname="bbb"; 
```

我收到类似的错误

> ORA-00904: "bbb": 无效标识符

我无法理解我在这里做错了什么。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-30T19:47:21.863

使用单引号。

```
select fname,lname from reg1 where uname='bbb'; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-30T19:51:09.417

Oracle 使用双引号`"`来标识大小写对象名称。例如 table`"test"`与 table 不同`test`。

字符串应该用单引号括起来，`'`.

进行查询：

```
select fname, lname from reg1 where uname = 'bbb'; 
```

您的查询中实际发生的情况是 Oracle 正在尝试`"bbb"`在表中查找该列`reg1`，因为该列不存在，您会抛出错误。

# c# - 最大线程数

> ID：11277139
> 
> 赞同：3
> 
> 时间：2012-06-30T19:47:05.203
> 
> 标签：c#, .net, multithreading, thread-safety, threadpool

我有用户控制，它有这样的方法

```
 public void DownloadFileAsync()
    {
        ThreadStart thread = DownloadFile;
        Thread downloadThread = new Thread(thread);

        downloadThread.Start();
    } 
```

在表单中，我有 4 个用户控件。但是当我为每个控件调用用户控件 DownloadFileAsync() 时，只有其中两个开始下载。完成其中一个后，下一个开始下载。

有什么问题以及如何在每次下载时同时下载？

感谢您的关注。

```
 public void DownloadFile()
    {
        int byteRecieved = 0;
        byte[] bytes = new byte[_bufferSize];

        try
        {
            _webRequestDownloadFile = (HttpWebRequest)WebRequest.Create(_file.AddressURL);
            _webRequestDownloadFile.AddRange((int)_totalRecievedBytes);
            _webResponseDownloadFile = (HttpWebResponse)_webRequestDownloadFile.GetResponse();
            _fileSize = _webResponseDownloadFile.ContentLength;
            _streamFile = _webResponseDownloadFile.GetResponseStream();

            _streamLocalFile = new FileStream(_file.LocalDirectory, _totalRecievedBytes > 0 ? FileMode.Append : FileMode.Create);

            MessageBox.Show("Salam");
            _status = DownloadStatus.Inprogress;
            while ((byteRecieved = _streamFile.Read(bytes, 0, _bufferSize)) > 0 && _status == DownloadStatus.Inprogress)
            {

                _streamLocalFile.Write(bytes, 0, byteRecieved);

                _totalRecievedBytes += byteRecieved;

                if (_totalRecievedBytes >= _fileSize)
                {
                    argsCompleted.Status = DownloadStatus.Completed;
                    if (_fileDownloadCompleted != null)
                        _fileDownloadCompleted(_file, argsCompleted);
                    break;
                }

                argsProgress.UpdateEventArgument(DownloadStatus.Inprogress, _totalRecievedBytes);

                if (_fileDownloadProgress != null)
                    _fileDownloadProgress(_file, argsProgress);

            }
        }
        catch (Exception ex)
        {
            LogOperations.Log(ex.Message);
        }
        finally
        {
            _streamFile.Close();
            _streamFile.Close();
            _streamLocalFile.Close();
            _webResponseDownloadFile.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T19:57:59.870

[HTTP](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p1-messaging-19)在很长一段时间内限制每个[Web Origin](https://www.rfc-editor.org/rfc/rfc6454) 2 个连接，因此人们不会同时启动太多下载。这个限制已经解除，但是包括 HttpWebRequest 在内的许多实现仍然实现它。

来自[draft-ietf-httpbis-p1-messaging](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p1-messaging-19)：

> 客户端（包括代理）应该限制他们维护到给定服务器（包括代理）的同时连接数。
> 
> 以前的 HTTP 版本给出了一个特定的连接数作为上限，但发现这对于许多应用程序来说是不切实际的。因此，该规范没有规定特定的最大连接数，而是鼓励客户端在打开多个连接时保持保守。

[您可以通过设置ConnectionLimit 属性](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.connectionlimit.aspx)来更改连接限制，如下所示：

```
HttpWebRequest httpWebRequest = (HttpWebRequest)webRequest;
httpWebRequest.ServicePoint.ConnectionLimit = 10; 
```

不要将限制设置得太高，以免服务器过载。

此外，您应该考虑使用[WebClient 类](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)及其提供的异步方法（例如[DownloadDataAsync 方法](http://msdn.microsoft.com/en-us/library/ms144190.aspx)），而不是使用线程。有关如何在此处更改连接限制，请参阅[如何以编程方式删除 WebClient 中的 2 个连接限制。](https://stackoverflow.com/questions/866350/how-can-i-programmatically-remove-the-2-connection-limit-in-webclient)

# .net - 使用 Math.net 进行多元正态分布

> ID：11277146
> 
> 赞同：0
> 
> 时间：2012-06-30T19:47:50.837
> 
> 标签：.net, math, math.net

我正在插入 Math.net 进行一些采样，但我只是没有得到它应该工作的方式......我在这里错过了什么？

```
let mm  =  Double.DenseMatrix.Identity(2)
let ida =  Double.DenseMatrix.Identity(2)
let idb =  Double.DenseMatrix.Identity(2)
let generator = MatrixNormal(mm, ida, idb)
generator.Density(mm) 
```

我明白了

```
System.ArgumentOutOfRangeException: Matrix dimensions must agree.
Parameter name: x
   at MathNet.Numerics.Distributions.MatrixNormal.Density(Matrix`1 x) in c:\TeamCity\buildAgent\work\392bcd0e1411b00f\src\Numerics\Distributions\Multivariate\MatrixNormal.cs:line 241
   at <StartupCode$FSI_0079>.$FSI_0079.main@()
Stopped due to error 
```

当我查看 github 源代码时，这很奇怪

```
 public double Density(Matrix<double> x)        { 
       if (x.RowCount != _m.RowCount || x.ColumnCount != _m.ColumnCount) 
       {                
           throw Matrix.DimensionsDontMatch<ArgumentOutOfRangeException>(x, _m, "x");                         
       } 
```

编辑

重新启动一切后，它适用于 2*2 矩阵均值，但不适用于 2*1（调整列方差后）。非常奇怪的是，在定义时有一些尺寸检查。但是错误消息是在调用时出现的。可能是检查错误的行方差和列方差，并在调用时使用正确的。所有这些都强调了丰富类型检查的强大优势。

对于好奇的人，这里是一个多变量实现。虽然没有检查..

```
let sampleNormal = 
   let rnd = new MersenneTwister()
   fun () ->
      let rec randomNormal () = 
          let u1, u2 = rnd.NextDouble(),rnd.NextDouble()
          let r = sqrt (-2\. * (log u1))
          let theta = 2\. * System.Math.PI * u2  
          seq { yield r * sin theta
                yield r * cos theta 
                yield! randomNormal() }
      randomNormal ()

let generate covar = 
   let chol = Double.Factorization.DenseCholesky(covar)
   let a = chol.Factor
   fun () -> let v = vector ( sampleNormal() |> Seq.take(covar.ColumnCount) |> List.ofSeq )
             a * v
//generate covar  

let generatecovar = generate covar
let generaten n covar = Seq.init n (fun _ -> generatecovar ()) 
```

**编辑**

Cholesky 对于完全相关的输入失败，这没关系

```
let mapply (m:Generic.Matrix<float>) f = m.IndexedEnumerator() |> Seq.iter(fun (i,j,v) -> m.[i,j] <- f v ); m

let generate (covar:Generic.Matrix<float>) = 
   let R = if covar.Determinant() = 0\. then   // we want covar = R.RT  // C = U D1/2.D1/2 U' = (RT.QT) Q.R = RT.RTT  
               let u, d, vt = let t = covar.Svd(true) in t.U(), t.W(), t.VT()  
               let A = (mapply d sqrt) * u.Transpose()                    
               let qr = A.QR() in qr.R.Transpose()                                 
            else
               let chol = covar.Cholesky()
               chol.Factor
   fun () -> let v = vector ( sampleNormal() |> Seq.take(covar.ColumnCount) |> List.ofSeq )
             R * v 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:55:19.460

*   身份构造函数：[DenseMatrix.cs#L321](https://github.com/mathnet/mathnet-numerics/blob/master/src/Numerics/LinearAlgebra/Double/DenseMatrix.cs#L321)
*   MatrixNormal 构造函数：[MatrixNormal.cs#L83](https://github.com/mathnet/mathnet-numerics/blob/master/src/Numerics/Distributions/Multivariate/MatrixNormal.cs#L83)
*   密度法：[MatrixNormal.cs#L237](https://github.com/mathnet/mathnet-numerics/blob/master/src/Numerics/Distributions/Multivariate/MatrixNormal.cs#L237)

我找不到你的代码有什么问题。你确定你运行的是正确的代码吗？也许是错误版本的库代码，甚至是你自己的？尝试重新启动 FSI，甚至重新编译库。

# javascript - Javascript TypeError：对象没有方法

> ID：11277156
> 
> 赞同：1
> 
> 时间：2012-06-30T19:48:56.867
> 
> 标签：javascript, oop

无论出于何种原因，我`TypeError: Object #<Num> has no method 'getNumber'`在创建`numberOne`为`Num`

```
function Num(n) {
    var number = n;
    var getNumber = function() {
        return number;
    };
}

var numberOne = new Num(5);
console.log(numberOne.getNumber()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T19:51:09.193

您在`getNumber`函数内声明为局部变量。这些不会成为构造对象的属性。

使用`this`：

```
 this.getNumber = function() { ... 
```

在构造函数中，`this`指的是要初始化的新创建的对象。

您还可以使用原型机制来提供对象属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T19:51:34.277

您正在创建一个`getNumber`未将其附加到对象的局部变量。要么把它交给对象，要么把它放在原型上：

```
this.getNumber = function() { 
```

或者

```
function Num(n) {
    this.number = n;
}

Num.prototype.getNumber = function() {
    return this.number;
} 
```

如果您正在创建大量对象，您可能想要放置`getNumber`原型，这样它就不会在每次创建时都添加到对象中。

# c - 从 C 程序调用 MATLAB 函数

> ID：11277159
> 
> 赞同：2
> 
> 时间：2012-06-30T19:49:12.947
> 
> 标签：c, matlab, matlab-deployment, matlab-engine

> **可能重复：**
> [如何从 C 调用 MATLAB 代码？](https://stackoverflow.com/questions/1513583/how-to-call-matlab-code-from-c)

有没有从 C 程序调用 MATLAB 函数的方法？
我的任务是使用 MATLAB 计算在 C 程序中生成的矩阵的伪逆。我想再次将从 MATLAB 获得的输出传递回 C 程序，在那里它会进行一些计算。

# jms - 使用 JMS 通过 SIP 拨打电话号码

> ID：11277162
> 
> 赞同：2
> 
> 时间：2012-06-30T19:49:30.707
> 
> 标签：jms, sip

有没有人尝试实现某种 Java 服务，以便客户端库可以向它发送 JMS 消息并拨打常规电话号码？我们有 Mitel 3300 Mex 硬件应该支持 SIP。理想情况下，它可以在对等方接听时播放一些预先录制的语音，或者事件更好的文本到语音？盛

# android - 屏幕关闭时检测音量按钮按下

> ID：11277164
> 
> 赞同：3
> 
> 时间：2012-06-30T19:49:41.057
> 
> 标签：android

我有一项服务可以检测我的 Android 手机的显示屏何时打开或关闭。关闭时，该服务会调用一个活动，该活动使用 dispatchKeyEvent 来检测何时按下音量增大按钮。不幸的是，当屏幕关闭时，活动显然无法执行此操作。（见[这篇文章。）](https://stackoverflow.com/questions/10262040/check-volume-button-usage-when-screen-is-off)

不过，我注意到，某种程度的东西正在检测该事件，因为当我在屏幕关闭时按下音量增大按钮时会出现以下 LogCat 消息：“CatService：返回当前 sInstance”。该消息似乎是特定于设备的，因为在不同的设备上，日志中会出现不同的内容，但我真的只关心第一个设备。

我对 CatService 进行了一些研究，但没有发现太多，也无法弄清楚如何使用它或生成日志消息的任何东西来检测音量增大按钮的按下情况。我很感激任何人都可以对此有所了解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:17:32.010

在屏幕关闭时继续检测此类事情的唯一方法是获取一个唤醒锁，它允许屏幕关闭，并且仍然让您的应用程序运行。但是，这会极大地消耗电池寿命，并且只能在绝对必要时使用。

在这种情况下，您将需要一个[PARTIAL_WAKE_LOCK](http://developer.android.com/reference/android/os/PowerManager.html#PARTIAL_WAKE_LOCK)。

# android - Android片段，删除许多之一

> ID：11277169
> 
> 赞同：1
> 
> 时间：2012-06-30T19:50:55.213
> 
> 标签：android, android-fragments

我有管理片段的问题。（使用支持包，修订版 9（2012 年 6 月））

我有一个屏幕上有 2 个片段的活动。如果我添加片段 A，然后添加片段 B，然后销毁片段 A 片段 B 也被销毁。

我以这种方式管理片段（有开始和提交行）

**添加**

```
ft.add(location, fragment, tag);
ft.addToBackStack(tag); 
```

**消除**

```
this.mFragmentManager.popBackStack(this.fragmentTopBarType.toString(),
                    FragmentManager.POP_BACK_STACK_INCLUSIVE);
ft.remove(fragment); 
```

这很好用，我的后堆被清理了，除了这个小怪癖。我不知道如何简单地从后台删除单个片段，因为弹出后台会删除该片段下方的所有内容。有什么想法还是我只是很厚？

# dart - 断点在飞镖编辑器中不起作用

> ID：11277172
> 
> 赞同：0
> 
> 时间：2012-06-30T19:51:09.730
> 
> 标签：dart, dartium

我无法在 Dart 编辑器中设置断点。我正在使用启动配置来指向本地 MVC3 站点的 URL。调试已启用。奇怪的是，dart 编辑器会中断异常并成为焦点，但完全忽略断点。我试过 32 位 32 位 dart 编辑器和 32 位 jre 和 64 位 64 位 dart 编辑器和 64 位 jre 无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T03:18:23.810

我认为您遇到了这个问题：

[http://code.google.com/p/dart/issues/detail?id=3748](http://code.google.com/p/dart/issues/detail?id=3748)

基本上，我们试图根据内部 localhost:3030 服务器的 URL 设置断点，但浏览器无法解析这些，因为内容是从不同的 url 加载的。

# iphone - 自定义 UIView 触控区域

> ID：11277173
> 
> 赞同：0
> 
> 时间：2012-06-30T19:51:13.297
> 
> 标签：iphone, ios, uiview, touchesbegan

您好，我有一些奇怪的形状需要处理该`touchesBegan`方法。问题是它`UIViews`是正方形的，我能做到的唯一方法就是声明一个网格，然后检查坐标。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:40:41.567

`hitTest:withEvent:`在你的 UIView 子类中实现。仅当 CGPoint 在形状内时才返回 YES。

查看多边形形状的这个问题： [如何确定 2D 点是否在多边形内？](https://stackoverflow.com/questions/217578/point-in-polygon-aka-hit-test)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T22:52:17.660

另外，如果你有机会在 WWDC 2012 上看到这个关于如何处理复杂触摸事件的演讲，那就太棒了：

[https://developer.apple.com/videos/wwdc/2012/?id=200](https://developer.apple.com/videos/wwdc/2012/?id=200)

# database - 如何安全地将密码存储在数据库中，同时仍可恢复

> ID：11277177
> 
> 赞同：2
> 
> 时间：2012-06-30T19:52:22.470
> 
> 标签：database, encryption, passwords

对于我正在处理的应用程序，我想存储用户输入的密码，以在我的数据库遭到破坏时提供一定的安全性，但仍允许外部守护程序访问密码的明文版本。（它将用于 IMAP 或 POP 登录）。

将密码存储在数据库中的最佳方法是什么，以便无需用户的原始密码即可恢复。（未使用用户密码加密）

我在想也许是公钥加密，前端将使用公钥加密密码以存储在数据库中，然后访问守护进程将使用私钥解密密码。

编辑：我需要明文密码，以便它们可用于登录其他可能不支持 OAuth 之类的网络服务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:58:44.407

您应该对它们进行加密，最好使用非对称加密。理想情况下，应用程序（Web 应用程序）加密它们（w 公钥），守护程序解密它们（w 私钥），应用程序、守护程序和数据库位于不同网络区域的不同机器上。

理想情况下，私钥存在于连接到守护程序服务器的硬件安全模块中。YubiHSM 约为 500 美元。

请注意，这只适用于您需要发送给另一方的密码。如果密码用于通过您的系统对用户进行身份验证，那么应该对它们进行散列（并加盐和加盐）。

# java - Spring MVC DispatcherServlet 映射

> ID：11277179
> 
> 赞同：0
> 
> 时间：2012-06-30T19:52:36.197
> 
> 标签：java, spring-mvc

我正在创建一个简单的 spring mvc 应用程序。如何配置 spring DispatcherServlet 以接受如下所示的 url 模式。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>SpringMVC</display-name>
  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>

  <servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

目前我在启动应用程序时收到低于警告。

```
WARNING: No mapping found for HTTP request with URI [/SpringMVC/] in DispatcherServlet with name 'spring' 
```

spring-servlet.xml（我也添加了默认的 servlet 处理程序）

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
    http://www.springframework.org/schema/aop 
    http://www.springframework.org/schema/aop/spring-aop.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd 
    http://www.springframework.org/schema/jee 
    http://www.springframework.org/schema/jee/spring-jee.xsd 
    http://www.springframework.org/schema/tx 
    http://www.springframework.org/schema/tx/spring-tx.xsd
    http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

    <context:annotation-config />
    <context:component-scan
        base-package="com.springapp" />

    <mvc:default-servlet-handler/>

    <bean id="messageSource"
        class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="classpath:resources/messages" />
        <property name="defaultEncoding" value="UTF-8" />
    </bean>

    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass"
            value="org.springframework.web.servlet.view.JstlView" />
        <property name="prefix" value="/WEB-INF/jsp/" />
        <property name="suffix" value=".jsp" />
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-15T21:48:46.223

首先，您的 web.xml 应该包含 DispatcherServlet 映射（您可以提供 dispatcher-servlet.xml 文件位置或使用默认值）：

```
 <servlet>
            <servlet-name>dispatcher-servlet</servlet-name>
            <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
            <init-param>
                    <param-name>contextConfigLocation</param-name>
                    <param-value>/WEB-INF/classes/spring-servlet.xml</param-value>
            </init-param>
            <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
            <servlet-name>dispatcher-servlet</servlet-name>
            <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

将此添加到您的 spring-servlet.xml 文件中：

```
<mvc:annotation-driven/> 
```

主要步骤，您应该创建将映射到您的路径 /SpringMVC 的控制器，例如

```
package com.springapp.controllers;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
@RequestMapping("/SpringMVC")
public class MyController{

     @RequestMapping(method= RequestMethod.GET)
     public ModelAndView springMvcTest(ModelMap modelMap){
         return new ModelAndView("test");
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T13:04:58.543

尝试使用以下方法之一：

```
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/SpringMVC/*</url-pattern>
</servlet-mapping> 
```

或者：

```
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>*.form</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-08T07:01:47.790

在网页 xml 中

```
 <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

在你的控制器中：

```
@Controller
@RequestMapping("SpringMVC")
public class MyController {
    Logger logger = LoggerFactory.getLogger(MyController.class);
    @Autowired
    private ContentService contentService;

    @RequestMapping(value = "/index", method = RequestMethod.GET)
    public String createForm(@RequestParam("user") String user, @RequestParam("requestId") String requestId, Model uiModel) {

 //TODO 
        return "index";
    } 
```

然后您的网址将是 ... localhost:port/SpringMVC/index

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T09:34:46.717

您必须在控制器中映射此 url，如下所示：

```
 @RequestMapping("/SpringMVC")
   public ModelAndView index(HttpServletRequest req,HttpServletResponse){

     // ur business logic

   return new ModelAndView("index");  
  } 
```

# django - “utf8”编解码器无法解码字节 0x94，

> ID：11277182
> 
> 赞同：1
> 
> 时间：2012-06-30T19:53:39.290
> 
> 标签：django

我收到以下错误，但我无法调试它，

错误

```
TemplateSyntaxError at /catalog/
Caught UnicodeDecodeError while rendering: 'utf8' codec can't decode byte 0x94 in position 787:       invalid start byte 
```

以下链接中提供了所有错误，

[http://dpaste.com/765793/](http://dpaste.com/765793/)

这是一个非常简单的代码，我只是渲染一个 html 页面。

任何帮助，将不胜感激。

索引.html

```
{% extends "catalog.html" %}
{% block content %} 
     <h2>Welcome!</h2> 
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:05:58.657

index.html 很可能采用非 UTF-8 编码，可能是 ISO-8859-1 或 Windows-1252。在这些情况下使用十六进制编辑器来检查 ö et.c. 被存储。

如果 index.html 在 UTF-8 中，则 ö 将对应于两个字节 c3 b6。如果是 ISO-8859-1，它将是一个单字节 f6。

要解决此问题，请以 UTF-8 重新编码文件或选择正确的编解码器。

# xml - 如何在 XSLT 中的两个模板之间传递变量

> ID：11277184
> 
> 赞同：5
> 
> 时间：2012-06-30T19:53:49.760
> 
> 标签：xml, xslt, xpath

如何在 XSLT 中的两个模板之间传递变量。

我不能使用全局变量，因为变量的值取决于当前正在评估的节点。

假设我有某种 XSLT：

```
<xsl:template match="product">
<xsl:variable name="pr-pos" select="count(./preceding-sibling::product)+1"/>
..
..
..
<xsl:apply-templates select="countries/country"/>
</xsl:template>

<xsl:template match="countries/country">
<tr id="country-id">
  <td><a href="#" class="action" id="{concat('a-',$pr-pos)}">+</a></td>
..
.. 
```

这会产生错误，因为在第二个模板中无法访问 $pr-pos。

如何将变量 pr-pos 的值传递给其他模板？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-30T20:14:07.923

```
<xsl:template match="product">
    <xsl:variable name="pr-pos" select="count(./preceding-sibling::product)+1"/>
    ..
    ..
    ..
    <xsl:apply-templates select="countries/country">
       <xsl:with-param name="pr-pos" select="$pr-pos" />
    </xsl:apply-templates>
</xsl:template>

<xsl:template match="countries/country">
  <xsl:param name="pr-pos" />
    <tr id="country-id">
      <td><a href="#" class="action" id="{concat('a-',$pr-pos)}">+</a></td>
      ..
      .. 
```

# mysql - 选择上一个日期，mysql

> ID：11277185
> 
> 赞同：2
> 
> 时间：2012-06-30T19:53:52.683
> 
> 标签：mysql, select, join

我有一个表，其中包含一个日期列 、`dte`一个 id 列`id`和一个值列`val`。每个 id 包含多个日期，每个日期包含多个 id：这是一个面板数据集。我想检索每个 id 的当前日期、当前值和上一个可用日期（当前日期之前）的值。在 mysql 中执行此操作的最佳方法是什么？我的表不是很大（200 万条记录），我希望它能够在合理的时间内工作。

以下是数据示例：

```
dte, id, value
2001-01-01, 1, 10
2001-01-02, 1, 20
2001-01-03, 1, 30
2001-01-04, 1, 40
2001-01-01, 2, 100
2001-01-02, 2, 200
2001-01-03, 2, 300
2001-01-05, 2, 400
2001-01-01, 3, 1000
2001-01-02, 3, 2000
2001-01-05, 3, 3000 
```

我想检索以下内容：

```
dte, id, value, previous_value
2001-01-01, 1, 10, NULL
2001-01-02, 1, 20, 10
2001-01-03, 1, 30, 20
2001-01-04, 1, 40, 30
2001-01-01, 2, 100, NULL
2001-01-02, 2, 200, 100
2001-01-03, 2, 300, 200
2001-01-05, 2, 400, 300
2001-01-01, 3, 1000, NULL
2001-01-02, 3, 2000, 1000
2001-01-05, 3, 3000, 2000 
```

这应该在纯 SQL 中完成，而不需要涉及任何脚本语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:28:20.847

由于您只需要“上一个”行中的一列，您可以尝试以下操作：

```
SELECT
  dte,
  id,
  value,
  (
    SELECT value
    FROM atable
    WHERE id = t.id
      AND dte < t.dte
    ORDER BY dte DESC
    LIMIT 1
  ) AS previous_value
FROM atable t 
```

如果您需要提取更多“以前的”属性，这里有一个更复杂的方法：

```
SELECT
  t1.dte,
  t1.id,
  t1.value,
  t2.dte,
  t2.value,
  …
FROM atable t1
  LEFT JOIN atable t2 ON t1.id = t2.id AND t1.dte > t2.dte
  LEFT JOIN atable t3 ON t1.id = t3.id AND t1.dte > t3.dte AND t3.dte > t2.dte
WHERE t3.id IS NULL 
```

第二种方法使用三角形自连接以及反连接到自身。基本上可以这样翻译：

> 将每一行与它的每个前任组合在一起`id`（第一个外连接，三角连接），然后去掉前任部分不代表最新前任的每一行（第二个外连接 + 中的条件`WHERE`，或反加入）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:18:48.793

Does this work?

```
select dte,id,value,(select value as previous_value from sample where id=1 
and dte<(select dte from sample where id=1 order by dte desc limit 1) order by
dte desc limit 1) from sample where id=1; 
```

Or maybe the solution might be something similar. This is for one id. You might have to loop the code for each such id.

# javascript - 简单的javascript路径问题

> ID：11277187
> 
> 赞同：0
> 
> 时间：2012-06-30T19:54:03.777
> 
> 标签：javascript

我试图在下拉菜单中嵌套一些缩略图，这些缩略图在激活时将出现在页面的不同区域。当我这样做时，JavaScript 无法正常运行。

```
$(document).ready(function(){

    $("h4").append('<em></em>')

    $(".thumbs a").click(function(){

        var largePath = $(this).attr("href");
        var largeAlt = $(this).attr("title");

        $("#largeImg").attr({ src: largePath, alt: largeAlt });

        $("h4 em").html(" (" + largeAlt + ")"); return false;
    });

}); 
```

工作标记：

```
<section class="group1">
             <h3>Print</h3>

                    <p class="thumbs">

                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                        <a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a>
                    </p>

           </section> 
```

不适用于嵌套`<li>`：

```
<ul id="expandmenu">

                            <li>Digital

                                <ol>
                                    <p class="thumbs">

                                    <li><a class="clip" href="img/pen.png" title="awesome"><img src="images/picture1.jpg" /></a></li>
                                    <li><a target="iframe2" href="Change font color rainbow.htm">Rainbow Fonts</a></li>
                                    <li><a target="iframe2" href="Cookies_ShowUserName.htm">ShowUserName</a></li>

                                    </p>

                                </ol>

                            </li>

                        </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:08:08.733

`p`可能是因为 HTML 标记无效 -标签内不能有`ol`标签。

# java - Java - 在 HashSet 中搜索对象字段

> ID：11277188
> 
> 赞同：2
> 
> 时间：2012-06-30T19:54:04.387
> 
> 标签：java, oop, hashset

我正在自学 Java，我有一个包含三个类的简单包——商店、产品和货架。一个商店对象包含许多货架，一个货架包含许多产品，在这种情况下，每个产品仅在一个货架上可用。

一个产品看起来像这样：

```
public class t_product {
    private t_shelf shelf;
    private String name;
} 
```

一个架子看起来像这样：

```
public class t_shelf {    
    private Set<t_product> products = new HashSet<>();
    private String name;
} 
```

商店对象如下所示：

```
public class t_shop {    
    private Set<t_shelf> shelves = new HashSet<>();
} 
```

我还有一组功能可以在货架上添加或删除产品。

```
myshelf.addProduct(myproduct); 
```

将设置 myproduct.shelf = myshelf，并将 myproduct 添加到 myshelf.products。这很好用，并且很好地处理了这种关系。类似的功能链接商店和货架。

# 继续解决问题

我有一个 .csv 存储：

```
Product   |   Shelf
----------------------
Hats      |   Headwear
Helmets   |   Headwear
Socks     |   Footwear
Apples    |   Fruit
Bananas   |   Fruit
Oranges   |   Fruit 
```

解析 .csv 时，我想按名称搜索架子以查看它是否已经创建，因此，例如，在读取“香蕉，水果”行时，它将处理：

```
if (!myshop.getShelfByName("Fruit")){
       myshop.addShelf(new t_shelf("Fruit"));
   }
myshop.getShelfByName("Fruit").addProduct("Bananas"); //Constructors accept the name as a parameter. 
```

# 我的问题是：

getShelfByName(String name) 有没有比简单地遍历 HashSet 并针对每个项目检查名称更简洁的实现？（想要避免 O(N) 算法）。

# 谢谢！

非常感谢任何解决此问题的尝试:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T19:58:17.833

如果您正在创建要保存在 HashSet 中的对象类，则*必须*为这些类提供体面的`equals()`和`hashCode()`覆盖的方法，这些方法有意义并且可以很好地协同工作（对于一个人来说，使用相同的*不变*字段来确定它们的结果）。

至于您的具体问题，请考虑将内容放在 HashMaps 而不是 HashSets 中，因为这样您就可以通过其键轻松找到对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:01:04.807

您应该将您的书架存储在 HashMap 中（键应该是书架的名称）。您将拥有一个 O(1) 算法。

```
public class t_shop {    
    private Map<String, t_shelf> shelves = new HashMap<String, t_shelf>();

    public void addShelve(t_shelf) {
        shelves.put(t_shelf.getName(), t_shelf);
    }

    public tshelf getShelfByName(String name) {
        return shelves.get(name);
    }
}

t_shelf shelf = myshop.getShelfByName("Fruit");
if (null != shelf){
    shelf = new t_shelf("Fruit");
    myshop.addShelf(shelf);
}
shelf.addProduct("Bananas"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T20:02:32.403

使用 a`HashMap`而不是 a`Set`会使查找命名架子变得微不足道：

```
private Map<String, t_shelf> shelves = new HashMap<>();

// ...
if (shelves.contains(name)) {

    t_shelf shelf = shelves.get(name);

    shelf.addProduct(product); 
```

# android - Android：自定义视图

> ID：11277193
> 
> 赞同：1
> 
> 时间：2012-06-30T19:54:56.850
> 
> 标签：android, android-layout

我正在尝试制作一个方形的自定义视图，使用宽度作为高度。我还使用了一个预定义的布局，我将它作为 UI 进行扩展。一旦我覆盖 onMeasure，自定义视图就不再出现。这是我的代码：

```
public class MyView extends RelativeLayout{

    public MyView(Context context) {
        super(context);
        addView(setupLayout(context));
    }

    public MyView(Context context, AttributeSet attrs) {
        super(context, attrs);
        addView(setupLayout(context));
    }

    public MyView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        addView(setupLayout(context));
    }

    private View setupLayout(Context context) {
        LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View myView = inflater.inflate(R.layout.view_layout, null);
        return myView;
    }

    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        setMeasuredDimension(MeasureSpec.getSize(widthMeasureSpec), MeasureSpec.getSize(widthMeasureSpec));
    }

} 
```

我有两个问题：

1.  如何覆盖 onMeasure 以便它以我期望的方式绘制我的视图？
2.  有什么方法可以让我在视图层次结构方面更有效（即不将RelativeLayout放在RelativeLayout中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:03:08.953

您可以使用[Jan Němec 对类似问题的回答中的](https://stackoverflow.com/questions/2948212/android-layout-with-sqare-buttons)代码：

```
import android.content.Context;
import android.util.AttributeSet;
import android.widget.LinearLayout;

public class SquareLayout extends LinearLayout {

public SquareLayout(Context context) {
    super(context);
}

public SquareLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
}

     @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

        int width = MeasureSpec.getSize(widthMeasureSpec);
        int height = MeasureSpec.getSize(heightMeasureSpec);

        if (width > (int)(mScale * height + 0.5)) {
            width = (int)(mScale * height + 0.5);
        } else {
            height = (int)(width / mScale + 0.5);
        }

        super.onMeasure(
                MeasureSpec.makeMeasureSpec(width, MeasureSpec.EXACTLY),
                MeasureSpec.makeMeasureSpec(height, MeasureSpec.EXACTLY)
        );
    }
    } 
```

或者尝试使用[这个](https://github.com/ronaldsteen/Android-SquareLayout-Library)库项目。

# android - KSOAP 获取 XML 响应

> ID：11277195
> 
> 赞同：0
> 
> 时间：2012-06-30T19:55:15.500
> 
> 标签：android, ksoap

我使用 KSOAP 来访问我的应用程序的 Web 服务。我使用 SoapObject 构建请求，但得到了一个奇怪的响应（在这种情况下，奇怪的意思是不是 XML）。

我是 KSOAP 的新手，我需要在基于 KSOAP 的现有项目中添加一些更改，因此避免使用它不是一种选择。代码很简单，并且有效，但我无法解析响应。

用于此的代码是：

```
SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
request.addProperty("PersonalID", "032676025");
SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
                SoapEnvelope.VER11);
        envelope.dotNet = true;
        envelope.setOutputSoapObject(request);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

try {
            androidHttpTransport.call(SOAP_ACTION, envelope);
            SoapPrimitive response = (SoapPrimitive) envelope.getResponse();
            Log.i("Webservice Output", response.toString());

            return response.toString();

        } catch (Exception e) {
            e.printStackTrace();
        } 
```

这里的问题是我找不到来自我的 web 服务的 XML 作为响应。我需要得到它并自己解析它。

问题是：**如何从上面代码中使用的对象获取 XML 响应（作为 XML）？**

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T10:52:59.377

我找到了解决方案： set **androidHttpTransport.debug = true;** 在进行 WS 调用之前。

在此之后，您可以像这样访问请求和响应：

```
String requestDump = androidHttpTransport.requestDump;
String responseDump = androidHttpTransport.responseDump;

Log.i("", "Requeste: " + requestDump);
Log.i("", "Response: " + responseDump); 
```

# linux - 在 bash 脚本中，如何将文本文件中包含的值提供给程序执行的开关？

> ID：11277199
> 
> 赞同：3
> 
> 时间：2012-06-30T19:55:37.193
> 
> 标签：linux, bash, shell, sh

我想`bash`在 Linux 中编写一个脚本，该脚本多次执行程序（例如 3 次），并根据文本文件中提供的值列表指定开关值。

例如，假设某个程序`programname`有一个`-switch`将浮点数作为输入的开关。因此，程序的一次执行可能会读取：

```
programname -switch 0.05 
```

其中 0.05 是传递给 switch 的特定值`-switch`。

现在，我想读入某种文本文件，其中包含我想`-switch`在单独调用中连续传递的值列表`programname`。我的文本文件`test.txt`可能包含这些数据：

```
0.05
3.19
100.75 
```

我想编写一个`bash`脚本，该脚本将读取文本文件并有效地连续进行这些调用：

```
programname -switch 0.05
programname -switch 3.19
programname -switch 100.75 
```

我在想这样的事情：

```
#!/bin/bash
for i in {1..3}
do
programname -switch $x
done 
```

但是，我应该输入什么来代替`$x`？换句话说，我不确定如何在循环运行`test.txt`时逐一读取并提供其内容。你有什么建议吗？谢谢！`-switch``for`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T20:27:29.930

无需使用任何外部实用程序。计数器增量和`read`可以如图所示一起完成，或者计数器增量可以在循环内的任何位置移动。

```
while ((i++)); read -r value
do
    programname -switch "$value" -other "$i"
done < test.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T19:58:45.273

值.txt：

```
0.05
3.19
100.75 
```

脚本.sh：

```
#!/bin/bash

counter=1
for value in $(cat values.txt)
do
    programname -switch $value -counter $counter
    counter=$(expr $counter + 1)
done 
```

# javascript - Jquery .load 触发两次，但被调用一次

> ID：11277200
> 
> 赞同：0
> 
> 时间：2012-06-30T19:55:51.173
> 
> 标签：javascript, jquery, html

我在这里有一个问题，我的 jquery .load 函数似乎运行了两次，即使我只调用了一次。这是我的代码：

```
function updateRowItem(idIn){
if (ready) {
    id = idIn
    $("#controlPanelResult").css("background-color", "");
    var query = {};

    var tid = id.replace("@", "\\@");
    tid = tid.replace(".", "\\.");

    var value =  $('#'+tid).text();

    //var value =  decodeURI(document.getElementById(id).innerHTML);

    //if (value == "<br>"){
    //  value = "NULL"
    //}
    //value = value.replace("&nbsp;"," ")
    //value = value.replace("&amp;","&")

    var split = id.split('@');
    var temp = split[0];
    var uuid = split[1];
    var temp2 = temp.split('.');
    var tableName = temp2[0];
    var item = temp2[1];

    query['table_name'] = tableName;
    query['uuid'] = uuid;
    query[item] = value;

    var tid = id.replace("@", "\\@");
    tid = tid.replace(".", "\\.");

    $.ajax({
    async: false,
    type: "POST",
    //url: '/admin/updateRow?table_name=' + tableName + "&uuid=" + uuid +"&" +     item + "=" + value,
    url: '/admin/updateRow',
    data: query,
    success: function(data) {
            if (data == "1"){ 

                alert ("Hellooo!")//This alert only and always pops up once

                    $('#'+tid).empty().load(showRowsUrl + " #" + tid,function (status) { 
                        alert (status) // This alert pops up first once, then twice, then four times, then eight etc....

                        $("#"+tid).animate({backgroundColor: '#70DB70'}, 'slow');
                        $('#controlPanelResult').html("Updated: " + id);
                        $("#controlPanelResult").animate({ backgroundColor: '#70DB70'}, 'slow');
                        $("#"+tid).animate({backgroundColor: 'white'}, 'slow');
                    });

            } else {
                $('#mainRows').load(showRowsUrl, function() {
                    $("#"+tid).animate({backgroundColor: 'red'}, 'fast');
                    $('#controlPanelResult').html(data);
                    $("#controlPanelResult").animate({backgroundColor: 'red'}, 'fast'); 
                });
            }               
        }
    });
}
} 
```

这会导致我的 div 内容不断重复，我将不胜感激任何帮助解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:47:34.423

用这个替换有问题的`.load()`调用：

```
$.get(showRowsUrl, function(data) {
    $('#'+tid).replaceWith($('#'+tid,'<div>'+data+'</div>'));

    $("#"+tid).animate({backgroundColor: '#70DB70'}, 'slow');
    $('#controlPanelResult').html("Updated: " + id);
    $("#controlPanelResult").animate({ backgroundColor: '#70DB70'}, 'slow');
    $("#"+tid).animate({backgroundColor: 'white'}, 'slow');
}); 
```

解释：`.load`正在将元素加载到自身中，因此之后会有两个具有相同 ID 的元素嵌套。然后当您`.load`再次运行时，它会在具有该 ID 的两个元素上运行，依此类推。

# php - 在php中使用复选框试图读取信息

> ID：11277202
> 
> 赞同：1
> 
> 时间：2012-06-30T19:55:59.730
> 
> 标签：php

我有一个 php 文件，它从 txt 文件中读取信息并将其打印在屏幕上，例如

第一行 [ x ]
第二行 [ x ] 等等等等

我正在尝试在所有信息行旁边添加复选框，我设法做了一个 for 循环，根据读取的行数创建复选框。

现在我坚持的最后一件事是我希望用户能够单击任何复选框，然后单击提交按钮，该按钮应该在新的 php 文件上打印出所选信息。

如果用户勾选第一行并提交，那么它应该在打开的 php 文件上显示文本字符串“1st line”

我做了一些研究并设法使用 isset 方法来确定它是否被检查过，但我仍然不确定如何读取检查到新 php 文件中的信息任何帮助将不胜感激谢谢

```
$filename = "file.txt";

$filepointer = fopen($filename, "r"); //open for read

$myarray = file ($filename);

// get number of elements in array with count
for ($counts = 0; $counts < count($myarray); $counts++)

{ //one line at a time
$aline = $myarray[$counts];

//$par = array();
$par = getvalue($aline);

if ($par[1] <= 200) 
{ 

print "<input type=checkbox name='test'/>"." ".$par[0]." "; 
print $par[1]." ";
print $par[2]." ";
print $par[3]." ";

}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:20:17.667

I think you are probably wanting to create an array which identifies which lines were checked? Well, you'll want to use an array to name your checkbox inputs. You can do this with a very similar syntax to PHP, by appending `[]` to the input name. For this specific case, you'll also want to explicitly index the array keys, which you can do like `[index]`. It will be easier to demonstrate this in code:

file1.php (**FIXED**):

```
<?php

$filename = "file.txt";

// file() does not need a file pointer
//$filepointer = fopen($filename, "r"); //open for read

$myarray = file($filename);

print "<form action='file2.php' method='post'>\n";

// get number of elements in array with count
$count = 0; // Foreach with counter is probably best here
foreach ($myarray as $line) {

  $count++; // increment the counter

  $par = getvalue($line);

  if ($par[1] <= 200) {
    // Note the [] after the input name
    print "<input type='checkbox' name='test[$count]' /> ";
    print $par[0]." "; 
    print $par[1]." ";
    print $par[2]." ";
    print $par[3]."<br />\n";
  }

}

print "</form>"; 
```

file2.php:

```
<?php

  foreach ($_POST['test'] as $lineno) {
    print "Line $lineno was checked<br />\n";
  } 
```

**EDIT**

Say you wanted file2.php to display the lines from the file that were checked:

```
<?php

  $filename = "file.txt";

  $myarray = file($filename);

  foreach ($_POST['test'] as $lineno) {
    // We need to subtract 1 because arrays are indexed from 0 in PHP
    print $myarray[$lineno - 1];
  } 
```

# google-apps-script - Google 应用脚本：getActiveSheet() 不起作用。

> ID：11277204
> 
> 赞同：1
> 
> 时间：2012-06-30T19:56:26.843
> 
> 标签：google-apps-script

所以，首先，这曾经完美地工作，直到大约一周前。但是，现在它已停止工作并出现以下错误。

遇到的错误：未知的工作表名称

有任何想法吗。这是被调用的代码片段。

```
var activeSheet = SpreadsheetApp.getActiveSheet(); 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:17:37.070

问题跟踪器上有[一个关于此的问题](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1476&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)，请加注星标以跟踪其演变。如果您的情况不同（与 Ui 无关），那么您可以开始一个新的。

# simperium - 由于 sp_md5StringFromData，Simperium 在 initWithViewController 上崩溃

> ID：11277205
> 
> 赞同：0
> 
> 时间：2012-06-30T19:56:29.383
> 
> 标签：simperium

在我的应用程序中使用 Simperium 时，应用程序退出并出现以下错误：

```
+[NSString sp_md5StringFromData:]: unrecognized selector sent to class 0x19fdfd8 
```

我已经调试了足够多的代码，知道它在`[[Simperium alloc] initWithViewController:controller]`方法中崩溃了，在下面的代码中：

```
UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
    UINavigationController *navController = (UINavigationController *)[tabBarController.viewControllers objectAtIndex:0];
    NotesViewController *controller = (NotesViewController *)[[navController viewControllers] objectAtIndex:0] ;    

self.simperium = [[Simperium alloc] initWithRootViewController:controller];

[self.simperium startWithAppID:@"my-app-ID-goes-here"
                            APIKey:@"the-API-key-would-go-here"
                             model:[self managedObjectModel]
                           context:[self managedObjectContext]
                       coordinator:[self persistentStoreCoordinator]]; 
```

*我已经隐藏了 AppID 和 API 密钥 --- 这不是错误！:)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:18:45.333

A required category for NSString isn't being loaded. This will happen if you forget to add `-ObjC` to "Other Linker Flags" under the build settings for your project. If you add that flag and run it again, I think you'll have better luck.

# javascript - 使用 JavaScript 隐藏特定的 HTML 表格单元格

> ID：11277212
> 
> 赞同：0
> 
> 时间：2012-06-30T19:57:47.753
> 
> 标签：javascript, jquery, html, jquery-selectors

我发现了其他问题，通过这些问题我学会了如何使用隐藏第一行和（第一行的）第一个单元格；

```
$('table#truetable tr:first').hide(); 
```

和

```
$('table#truetable td:first').hide(); 
```

但是，如果我想使用这种方法隐藏例如第二行的第一个单元格怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:02:20.093

```
$('table#truetable tr:eq(1) td:first-child').hide(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:02:27.707

```
$('#truetable tr:eq(1) td:first').hide(); 
```

[`:eq`文档](http://api.jquery.com/eq-selector/)

```
jQuery(':eq(index)') 
```

> **index**
> 要匹配的元素的从零开始的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:02:55.943

有一个 CSS 选择器：

```
:nth-child(N) 
```

N是选择中的孩子+1的索引

# python - IDLE 在我的 Mac 上崩溃

> ID：11277213
> 
> 赞同：3
> 
> 时间：2012-06-30T19:57:59.463
> 
> 标签：python, macos, python-2.7, python-idle

我以前从未使用过 Python 并想开始使用。我正在运行 Mac OSX 10.5.8，每次打开 IDLE 时都会收到以下错误消息：

```
The application IDLE quit unexpectedly 
```

我刚刚下载了 Python 2.7，因为我听说它支持最多的库，而且我对 C/C++ Python 接口功能感到非常兴奋。我确实看到这个网站上的其他用户有类似的问题，但我仍然没有弄清楚我的问题。

关于如何让 IDLE 在我的 Mac 上运行的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T21:23:53.080

python 3.x 更适合 mac。尝试[在此处](http://python.org/download/releases/3.1.5/)下载并使用 IDLE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T12:58:37.597

在 Mac 上，当您从外部导入大文件、复制粘贴内容以及单击首选项时，空闲崩溃。复制粘贴错误信息：

IDLE 意外退出

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV) 
```

所有版本的python在mac上都崩溃了。到目前为止，我没有看到任何解决此问题的方法。我强烈推荐你使用iep。它具有所有 python 版本，您无需保存文件即可运行它。

这是iep编辑器[的链接](http://code.google.com/p/iep/downloads/list)

# jquery - 快速的ajax更新

> ID：11277217
> 
> 赞同：-1
> 
> 时间：2012-06-30T19:58:25.943
> 
> 标签：jquery, post

我正在尝试复制一些看起来与在 SO 上添加评论的过程相似的功能。我正在使用 jQuery AJAX 帖子：$.post()，但在我的机器上添加评论的过程比在 SO 上花费的时间更长。

我假设 SO 使用了一种更聪明的方法。你知道评论是如何添加/编辑的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:17:50.477

您的机器几乎可以肯定*远*不如 stackoverflow 服务器！在您的 Web 开发工具中查找由 stackoverflow 发出的请求，并将其与您发出的请求进行比较。您会发现它们可能非常相似。

# iphone - 从 detailView 编辑 CoreData

> ID：11277223
> 
> 赞同：0
> 
> 时间：2012-06-30T19:58:50.497
> 
> 标签：iphone, core-data

该程序非常简单：它有一个masterView 和一个detailView。在详细视图中，我应该能够编辑相应对象的属性（基本上是在已存储的数字上添加一个数字）。问题是我不确定如何保存更改。
我在 detailViewController 的 IBAction 中有这个：

```
- (IBAction)depositFunds:(id)sender
{
     float change = [[self.detailItem valueForKey:@"balance"] floatValue] + [amountTextfield.text floatValue];
     [self.detailItem setValue:[NSNumber numberWithFloat:change] forKey:@"balance"];
} 
```

如何保存这些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:33:42.353

我刚刚尝试从 masterView 导入 managedObjectContext 并保存它。有效。
这样做，导入上下文：

```
- (void) setManagedObject:(NSManagedObjectContext *)managedObject
{
     managedObjectContext = managedObject;
} 
```

通过 segue 方法或 didSelectRowAtIndex 方法传递上下文。

```
myDetailViewController *viewC = [segue destinationViewController];
[viewC setManagedObject:self.managedObjectContext]; 
```

然后将此添加到您的保存方法中。

```
NSError *error = nil;
if (![managedObjectContext save:&error])
{
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
} 
```

干杯!

# ruby - GEM_HOME 和 GEM_PATH 有什么区别？

> ID：11277227
> 
> 赞同：84
> 
> 时间：2012-06-30T19:59:27.957
> 
> 标签：ruby, rubygems

RubyGems 是 Ruby 编程语言的包管理器，它提供了一种用于分发 Ruby 程序和库的标准格式（以一种称为“gem”的自包含格式），一种旨在轻松管理 gems 安装的工具，以及一个用于分发它们。它类似于 Python 编程语言的 EasyInstall。RubyGems 现在是 Ruby 1.9 版标准库的一部分。

也就是说，GEM_HOME 和 GEM_PATH 有什么区别？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-06-30T19:59:28.270

`GEM_PATH`提供可以找到宝石的位置（可能有多个）。

`GEM_HOME`是安装 gems 的地方（默认情况下）。

（因此`GEM_PATH`应包括`GEM_HOME`）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-19T20:54:26.310

还有有趣的通知。至少在 Wndows XP 上，不知道其他平台。

`GEM_HOME`在 Windows 中设置：

```
C:\>set GEM_HOME=C:\sbox\ruby\dump\.gems 
```

现在让我们检查一下。

1) 在 Windows ENV 中。一切正常，正如预期的那样：

```
C:\>set
...
GEM_HOME=C:\sbox\ruby\dump\.gems
... 
```

2) 与`gem env`。请注意，它与 s 放在`GEM_HOME`一起，`GEM_PATH`但首先是：

```
C:\>gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 2.0.3
  - RUBY VERSION: 2.0.0 (2013-02-24 patchlevel 0) [i386-mingw32]
  - INSTALLATION DIRECTORY: C:/sbox/ruby/dump/.gems
  - RUBY EXECUTABLE: C:/Ruby200/bin/ruby.exe
  - EXECUTABLE DIRECTORY: C:/sbox/ruby/dump/.gems/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-mingw32
  - GEM PATHS:
     - C:/sbox/ruby/dump/.gems
     - C:/Documents and Settings/User/.gem/ruby/2.0.0
     - C:/Ruby200/lib/ruby/gems/2.0.0
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - https://rubygems.org/ 
```

3）现在`bundle env`：

```
C:\>bundle env
Bundler 1.3.4
Ruby 2.0.0 (2013-02-24 patchlevel 0) [i386-mingw32]
Rubygems 2.0.3
GEM_HOME C:\sbox\ruby\dump\.gems
GEM_PATH 
```

`GEM_PATH`为空，表示默认值。但是它从哪里获取默认值？见`gem env`。

# java - 在 P8Test 类中，为什么我无法在 String[] 对象数据中存储 (scn.nextLine()).split(",")

> ID：11277230
> 
> 赞同：-1
> 
> 时间：2012-06-30T19:59:56.843
> 
> 标签：java

```
public class TextFileExtractor{
    public static String[] fileExtractor(String[] s){

        StringBuilder sb=new StringBuilder();

        for(int i=0;i<=s.length-1;i++){
            if(s[i].endsWith(".txt")){
                sb.append(s[i]);
                sb.append(',');
            }
        }
        String str=sb.toString();
        String[] sa=str.split(",");

    return sa;
}
}

//P8Test.java

import java.util.*;

class P8Test{

    public static void main(String[] args) 
    {   Scanner scn=new Scanner(System.in);
        System.out.print("Enter String Array:");
        String[] data=(scn.nextLine()).split(","); 
```

/*这里我们存储使用 .split() 方法转换 String（我们动态读取）后得到的数组*/

```
 System.out.print("all Files");
                System.out.print(Arrays.toString(data));
                    System.out.print("Text Files");

        String[] res=TextFileExtractor.fileExtractor(data);
        System.out.print(Arrays.toString(res));

    }
} 
```

//在 P8Test 类中为什么我不能存储（`scn.nextLine()).split(",")`在`String[]`对象数据`System.out.print(Arrays.toString(data));`中。当我给出动态输入时，bcoz 没有打印任何东西`abc.txt,bbc.txt,bbc.pdf.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:03:22.317

正如我在改变[之前](https://stackoverflow.com/questions/11277008/java-how-to-fix-arrayindexoutofboundsexception/11277086#11277086)告诉你的

```
String[] data = new String[(scn.nextLine()).length()];
data = (scn.nextLine()).split(","); 
```

到

```
String[] data = scn.nextLine().split(","); 
```

然后尝试您的代码。

早些时候，您基于第二行用户输入创建数组，因为您调用`scn.nextLine()`了两次。

# php - 将关联数组值传递给 $_get

> ID：11277233
> 
> 赞同：1
> 
> 时间：2012-06-30T20:00:37.427
> 
> 标签：php, arrays, associative-array

我正在尝试使用这样的关联数组构建 url 查询：

`http://website.com/go.php?status=0&day=monday`

这是我的代码，但它只返回单词数组。

```
$status = $_GET["status"];

$day= $_GET["day"] = array(
    "monday" => "one",
    "tuesday" => "two",
);

echo $status . " " . $day; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:08:52.547

用作`$_GET['day']`数组的键：

```
$days = array("monday" => "one", "tuesday" => "two");

// Test if your array $day contains a key
// equivalent to the value in $_GET
// (only if $_GET['day'] was passed in the first place)
if (isset($_GET['day'] && isset($days[$_GET['day']])) {
  echo $status . " " . $days[$_GET['day']];
}
else echo "No such day..."; 
```

# module - 一个页面中的多个模块 ZF2

> ID：11277234
> 
> 赞同：1
> 
> 时间：2012-06-30T20:00:40.687
> 
> 标签：module, frameworks, zend-framework2

我正在使用 Zend 框架 2，我想在一个 URL 中加载多个模块......但我不知道该怎么做，我尝试使用路由但没有任何效果......

所以我在这里！

感谢您的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:29:46.250

快速的回答是，您需要选择（可能创建）一个模块并在其中定义适当的 url 路由，然后使用服务管理器引用您的其他模块，并分别从控制器功能和视图中查看帮助程序。因此，这一切都围绕着调用其他模块的单个控制器功能。

如果您仍然需要这方面的帮助，请告诉我，我会在周末结束前为您找到一些代码示例。另外，请让我确切地知道您要做什么（部分原因是我可以提供帮助，部分原因是出于好奇）。

# php - PCLZip - 在提取之前重命名存档中的文件夹是否可以发布？

> ID：11277235
> 
> 赞同：0
> 
> 时间：2012-06-30T20:00:56.520
> 
> 标签：php, pclzip

我有一种情况，我正在下载一个 zip，需要在解压缩之前重命名其中一个文件夹。这可能使用 PCLZip 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T13:27:53.560

您可以使用此 PCLZIP_OPT_REMOVE_ALL_PATH 从每个文件中简单地删除所有文件夹位置

问候。

# c# - 是否可以在 WPF 中实现工具栏并绘制控件？

> ID：11277240
> 
> 赞同：2
> 
> 时间：2012-06-30T20:01:40.917
> 
> 标签：c#, wpf, silverlight, xaml, toolbar

我有一个试图模仿 VS 的想法。

在我的项目中，我创建了许多视图（用户控件）。

我想在工具栏中显示这些视图（如 VS），当我选择其中一个时，在另一个控件中绘制选定的视图（如设计器，我猜这可以是 a`grid`或`richtextbox`）。

有可能这样做吗？会有多困难？互联网上是否存在演示？

我对此提出质疑，因为我不是 WPF 图形方面的专家。

有任何问题，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T11:37:51.690

是的，这几乎是可能的并且不会太难实现，但这取决于您的控件的复杂性；看看这个具有类似实现的文章系列`Canvas`-

WPF 图表设计器 -[第 4](http://www.codeproject.com/Articles/24681/WPF-Diagram-Designer-Part-4)部分、[第 3](http://www.codeproject.com/Articles/23871/WPF-Diagram-Designer-Part-3)部分、[第 2](http://www.codeproject.com/Articles/23265/WPF-Diagram-Designer-Part-2)部分、[第 1 部分](http://www.codeproject.com/Articles/22952/WPF-Diagram-Designer-Part-1)

另一个基于本文的项目可以在 codeplex- 找到

[http://simulo.codeplex.com/](http://simulo.codeplex.com/)

还可以查看这个类似的问题以了解其他一些选项 -

[创建 UI 设计器](https://stackoverflow.com/questions/4425626/creating-a-ui-designer/4427538#4427538)

# iphone - 如何从地址簿 IOS 5 KABPersonPhoneProperty 中获取所有电话号码

> ID：11277242
> 
> 赞同：2
> 
> 时间：2012-06-30T20:02:00.000
> 
> 标签：iphone, objective-c, ios5, xcode4.3

我正在使用 kABPersonPhoneProperty 从通讯簿中获取 iPhone“电话号码”。然而，一旦我运行该程序并且只有一个电话号码出现，即使联系人有手机、家庭和 iphone 号码。请帮忙，我希望能从每个联系人那里得到所有的电话号码。谢谢。

完整的方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *simpleTableIdentifier = @"SimpleCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
    }
    // cell.textLabel.text = [people objectAtIndex:indexPath.row];

    ABRecordRef record = (__bridge   ABRecordRef) [people objectAtIndex:[indexPath row]];

    NSString *firstName = (__bridge_transfer NSString*)ABRecordCopyValue(record, kABPersonFirstNameProperty);

    NSString *lastName = (__bridge_transfer NSString*)ABRecordCopyValue(record, kABPersonLastNameProperty);

    NSLog(@"FirstName %@, LastName %@", firstName, lastName);

    cell.nameLabel.text = [NSString stringWithFormat:@"%@ %@", firstName, lastName];

    ABMultiValueRef mainPhone = ABRecordCopyValue(record, kABPersonPhoneProperty);
    for (CFIndex i = 0; i < ABMultiValueGetCount(mainPhone); i ++) {        

        NSString *phoneMobileNumber = (__bridge_transfer NSString*)ABMultiValueCopyValueAtIndex(mainPhone, i);

        cell.telNo.text = [NSString stringWithFormat:@"%@ %@" , home, phoneMobileNumber];

        NSLog(@"%@,%@", home, phoneMobileNumber);
    }

return cell;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T06:32:38.133

好的，这是**解决方案**

```
`    ABAddressBookRef addressBook=ABAddressBookCreate();
NSArray *allPeople=(NSArray *)ABAddressBookCopyArrayOfAllPeople(addressBook);

NSMutableArray *holdEachPersonMobileNumbers=[NSMutableArray new];

for (id person in allPeople) {
    ABMultiValueRef phoneNumbers = ABRecordCopyValue(( ABRecordRef)(person), kABPersonPhoneProperty);

    NSString* mobile=@"";
    for (int i=0; i < ABMultiValueGetCount(phoneNumbers); i++) {

        mobile = (NSString*)ABMultiValueCopyValueAtIndex(phoneNumbers, i);

        NSCharacterSet *trim = [NSCharacterSet characterSetWithCharactersInString:@"#();$&-+"];
        mobile = [[mobile componentsSeparatedByCharactersInSet: trim] componentsJoinedByString: @""];
        mobile= [mobile stringByReplacingOccurrencesOfString:@"\"" withString:@""];

        mobile=[mobile stringByReplacingOccurrencesOfString:@" " withString:@""];

        [holdEachPersonMobileNumbers addObject:mobile];
    }

} 
```

`

这里**holdEachPersonMobileNumbers**保存与您在地址簿中选择的特定人相关的所有号码

**把上面的代码放在这个方法中** - (BOOL)peoplePickerNavigationController: (ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person

希望你**遵守**这个协议 **ABPeoplePickerNavigationControllerDelegate** 并**导入**这个

```
 #import <AddressBook/AddressBook.h>
#import <AddressBookUI/AddressBookUI.h> 
```

# javascript - 函数循环中的函数

> ID：11277248
> 
> 赞同：1
> 
> 时间：2012-06-30T20:02:49.703
> 
> 标签：javascript, jquery

我需要`<div>`每 2 秒加载带有随机图像的 PHP 文件，并带有淡入淡出效果，所以我使用 javascript 和 jQuery。我编写函数来隐藏 div，加载文件，而不是显示它并等待 2 秒，然后它应该再次调用函数，但它只发生了一次然后它停止了。

这是功能：

```
function random(){
   $("#randomImage1").animate({opacity: '0.0'}).load("../images/randomImage.php").animate({opacity: '1.0'}).delay(2000, function(){
   random();
});
random(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T20:09:30.460

做这个：

```
(function random(){
  var timer;
  $("#randomImage1").animate({opacity: '0.0'}).load("../images/randomImage.php", function(){
     $(this).animate({opacity: '1'});
     timer = setTimeout(random, 2000);
  });
})(); 
```

在这里，我们创建自调用函数并在内部调用它，`setTimeout`以便在图像加载和动画部分完成后一次又一次地调用它。加载所有图像后，您需要调用`clearTimeout(timer)`停止运行。`setTimeout`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:12:24.003

请求完成`setTimeout(random, 2000);`后尝试添加：`load`

```
function random(){
  var rndImg = $("#randomImage1");
  rndImg.fadeOut().load("../images/randomImage.php",function(){
      rndImg.fadeIn();
      setTimeout(random, 2000);
  });
};
random() 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-06-30T20:20:13.750

The problem you have is that you're trying to use `.delay()` as a replacement for the native `setTimeout()`, which isn't what it's intended to do. The `.delay()` function is designed to add a pause between jQuery animation effects, not to delay the execution of another function, and doesn't accept a callback function. See the jQuery documentation for the [`.delay()`](http://api.jquery.com/delay/) function.

As has already been covered in previous answers, you can use the native `setInterval()` function to implement the delay you're after:

```
function random(){
    $("#randomImage1").animate({opacity: '0.0'}).load("../images/randomImage.php").animate({opacity: '1.0'});
    setInterval(random, 2000);
}
random(); 
```

Note that this will animate the `#randomImage1` element back to full opacity, and set the interval to call the function again, even if the AJAX call from `.load()` didn't return a success response. If that's not what you want, you can instead move that code into an anonymous function passed as the success callback on `.load()`, like so:

```
function random(){
    $("#randomImage1").animate({opacity: '0.0'}).load("../images/randomImage.php", 
    function() {
        $("#randomImage1").animate({opacity: '1.0'});
        setInterval(random, 2000) 
    });
}
random(); 
```

# c++ - 如何传递 std::unique_ptr ？

> ID：11277249
> 
> 赞同：92
> 
> 时间：2012-06-30T20:02:53.900
> 
> 标签：c++, c++11, unique-ptr

我第一次尝试使用 C++11 `unique_ptr`；我正在替换我的一个项目中的多态原始指针，该项目归一个类所有，但经常传递。

我曾经有这样的功能：

```
bool func(BaseClass* ptr, int other_arg) {
  bool val;
  // plain ordinary function that does something...
  return val;
} 
```

但我很快意识到我无法切换到：

```
bool func(std::unique_ptr<BaseClass> ptr, int other_arg); 
```

因为调用者必须处理指向函数的指针所有权，这是我不想要的。那么，我的问题的最佳解决方案是什么？

我虽然将指针作为参考传递，如下所示：

```
bool func(const std::unique_ptr<BaseClass>& ptr, int other_arg); 
```

但是这样做我感到非常不舒服，首先因为传递已经输入作为参考的东西似乎不是本能的`_ptr`，什么是参考的参考。其次，因为函数签名变得更大。第三，因为在生成的代码中，需要两个连续的指针间接访问我的变量。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-06-30T20:07:14.350

如果您希望函数使用指针对象，请传递对它的引用。没有理由将函数绑定为仅使用某种智能指针：

```
bool func(BaseClass& base, int other_arg); 
```

并在呼叫站点使用`operator*`：

```
func(*some_unique_ptr, 42); 
```

或者，如果`base`参数允许为空，则保持签名不变，并使用`get()`成员函数：

```
bool func(BaseClass* base, int other_arg);
func(some_unique_ptr.get(), 42); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2014-06-18T15:37:33.303

使用的优点`std::unique_ptr<T>`（除了不必记住调用`delete`或`delete[]`显式）是它保证指针要么是要么`nullptr`指向（基）对象的有效实例。回答完您的问题后，我会回到这一点，但第一条消息是请**使用**智能指针来管理动态分配对象的生命周期。

现在，您的**问题**实际上是*如何将其与旧代码一起使用*。

我的建议是，如果您不想转让或共享所有权，则应**始终**传递对该对象的引用。像这样声明你的函数（`const`根据需要有或没有限定符）：

```
bool func(BaseClass& ref, int other_arg) { ... } 
```

然后调用者，它`std::shared_ptr<BaseClass> ptr`要么处理这个`nullptr`案例，要么要求`bool func(...)`计算结果：

```
if (ptr) {
  result = func(*ptr, some_int);
} else {
  /* the object was, for some reason, either not created or destroyed */
} 
```

这意味着任何调用者都必须**保证**引用是有效的，并且在函数体的整个执行过程中它将继续有效。

* * *

这就是为什么我坚信您不应该**传递**原始指针或对智能指针的引用的原因。

原始指针只是一个内存地址。可以具有（至少）4 种含义之一：

1.  所需对象所在的内存块的地址。（**好的**）
2.  您可以确定的地址 0x0 不可取消引用，并且可能具有“无”或“无对象”的语义。（**坏的**）
3.  在进程的可寻址空间之外的内存块的地址（取消引用它可能会导致您的程序崩溃）。（**丑陋的**）
4.  可以取消引用但不包含您期望的内存块的地址。也许指针被意外修改了，现在它指向另一个可写地址（在您的进程中完全是另一个变量）。写入这个内存位置有时会在执行过程中产生很多乐趣，因为只要你被允许在那里写，操作系统就不会抱怨。（**Zoinks！**）

正确使用智能指针可以缓解相当可怕的情况 3 和 4，它们通常在编译时无法检测到，并且您通常仅在运行时程序崩溃或发生意外事情时才会遇到这种情况。

将智能指针作为参数传递有两个缺点：如果不进行复制，就无法更改*指向*`const`对象的-ness （这会增加开销并且对于 是不可能的），并且您仍然保留第二个 ( ) 含义。*`shared_ptr``unique_ptr``nullptr`*

 *从设计的角度来看，我将第二种情况标记为（**坏的）。**这是关于责任的更微妙的论点。

想象一下当函数接收 a`nullptr`作为其参数时这意味着什么。它首先必须决定如何处理它：使用“神奇”值代替丢失的对象？完全改变行为并计算其他东西（不需要对象）？恐慌并抛出异常？此外，当函数通过原始指针获取 2、3 甚至更多参数时会发生什么？它必须检查它们中的每一个并相应地调整其行为。这无缘无故地在输入验证之上增加了一个全新的级别。

调用者应该是拥有足够上下文信息来做出这些决定的人，或者换句话说，你知道的越多，*坏事*就越不可怕。另一方面，该函数应该只接受调用者的承诺，即它所指向的内存可以安全地按预期使用。（引用仍然是内存地址，但在概念上代表了有效性的承诺。）

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-07-01T00:41:58.897

我同意 Martinho，但我认为指出传递引用的所有权语义很重要。我认为正确的解决方案是在这里使用简单的传递引用：

```
bool func(BaseClass& base, int other_arg); 
```

在 C++ 中，传递引用的普遍接受的含义就像函数的调用者告诉函数“在这里，你可以借用这个对象，使用它并修改它（如果不是 const），但仅限于函数体的持续时间。” 这绝不与所有权规则相冲突，`unique_ptr`因为该对象只是在短时间内被借用，并没有发生实际的所有权转移（如果您将汽车借给某人，您是否签署了所有权交给他？）。

因此，即使将引用（甚至原始指针）从`unique_ptr`. `unique_ptr`. _ 然后，当然，还有其他不错的优点，比如干净的语法，不限制只属于 a 的对象`unique_ptr`，等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-10T22:23:55.063

就个人而言，我避免从指针/智能指针中提取引用。因为如果指针是 会发生什么`nullptr`？如果您将签名更改为：

```
bool func(BaseClass& base, int other_arg); 
```

您可能必须保护您的代码免受空指针取消引用：

```
if (the_unique_ptr)
  func(*the_unique_ptr, 10); 
```

如果类是指针的唯一所有者，那么 Martinho 的第二个替代方案似乎更合理：

```
func(the_unique_ptr.get(), 10); 
```

或者，您可以使用`std::shared_ptr`. 但是，如果只有一个实体负责`delete`，则`std::shared_ptr`开销不会得到回报。*

# mysql - 在mysql中选择不同的2列组合

> ID：11277251
> 
> 赞同：30
> 
> 时间：2012-06-30T20:03:02.277
> 
> 标签：mysql, sql, database, distinct, distinct-values

我有一个如下所示的 mysql 表：

```
1   value1    value2    3534
2   value1    value1    8456
3   value1    value2    3566
4   value1    value3    7345
5   value2    value3    6734 
```

我需要一个查询来选择所有具有不同第 2 列和第 3 列的行，例如，我想要的此示例的输出将如下所示：

```
1   value1    value2    3534
2   value1    value1    8456
4   value1    value3    7345
5   value2    value3    6734 
```

我找到了一些关于如何做到这一点的示例，但它们都在每一列上分别选择不同的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-30T20:20:46.417

## 更新 1

最好你用这个来对付上面。

```
SELECT id, col2, col3, col4
FROM yourtable
GROUP BY col2, col3; 
```

## [演示](http://sqlfiddle.com/#!2/38f1c/19)

我说的原因是因为使用 CONCAT，在***[这种情况下](http://sqlfiddle.com/#!2/a5c66/2)***我没有得到想要的结果。第一个查询返回我 5 行但是 CONCAT 返回我 4 行，这是不正确的。

希望你明白我的意思。

* * *

假设表中的列是 (id, col2, col3, col4)。

```
SELECT DISTINCT(CONCAT(col2, col3)) as "dummy column", id, col2, col3, col4
FROM yourtable
GROUP BY CONCAT(col2, col3); 
```

## 或者

```
SELECT id, col2, col3, MIN(col4)
FROM yourtable
GROUP BY col2, col3; 
```

## [现场工作示例](http://sqlfiddle.com/#!2/38f1c/14)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-06-30T20:06:05.330

假设第一列是唯一的，您可以这样做：

```
SELECT id, col2, col3, col4
FROM yourtable
WHERE id IN
(
    SELECT MIN(id)
    FROM yourtable
    GROUP BY col2, col3
) 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/38f1c/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T20:06:13.257

假设表中的列是`(id, col1, col2, col3)`，您可以：

```
SELECT  *
FROM    YourTable yt
JOIN    (
        SELECT  MIN(id) as minid
        FROM    YourTable
        GROUP BY
                col1, col2
        ) filter
ON      filter.minid = yt.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T20:07:57.953

该查询确保column1和column2的组合是唯一的，同时选择column 3的最小值

```
SELECT col1, col2, MIN(col3)
FROM yourTable
GROUP BY col1, col2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-30T20:14:40.910

最简单的查询是

```
SELECT col1, col2, MIN(col3)
FROM myTable
GROUP BY col1, col2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-27T12:16:26.167

使用 group by 方法会返回额外的行，其中显式检查每个字段虽然不再返回与 count(Distinct ..) 相同的记录数

```
SELECT id, col2, col3, col4
FROM yourtable yt
WHERE id =
(
 SELECT MIN(id)
 FROM yourtable yt1
 WHERE yt.col2 = yt1.col2
 AND yt.col3 = yt1.col3
) 
```

# perl - 带有数组引用的 Perl 斐波那契数字程序？

> ID：11277255
> 
> 赞同：1
> 
> 时间：2012-06-30T20:03:35.583
> 
> 标签：perl

编辑：已解决。请参阅下面的解决方案。

我为前 10 个数字编写了以下斐波那契数列程序；但是我无法让它工作。它一直告诉我，`Use of uninitialized value $secondLast in addition (+) at fib.plx line 22.`它永远运行。我是初学者 Perl 程序员，所以我确信错误非常简单。谢谢。

```
#!/usr/bin/perl
use warnings;
use strict;

sub fib(\@$);

my @defaultNums = (1,1);
my $max = 10;
fib(@defaultNums,10);

sub fib(\@$)
{
        my $nums_ref = $_[0];
        my $max = $_[1];
        foreach(@{$nums_ref})
        {
                print "$_, ";
        }
        print "\n";
        my $last = pop (@{$nums_ref});
        my $secondLast = pop (@{$nums_ref});
        my $sum = $last + $secondLast;
        push (@{$nums_ref}, $sum);
        if( scalar  @{$nums_ref} >= $max) { return; }
        fib (@{$nums_ref},$max);
        print "\n";
} 
```

编辑：已解决。请参阅下面的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T08:36:09.923

关于您的程序的一些注意事项：

*   除非您*完全*确定自己在做什么，否则避免使用子程序原型很重要。原型主要用于编写 Perl 内置运算符的替代品，而这是很少需要的。您应该通过将调用编写为 来明确传递对数组的引用`fib(\@defaultNums, 10)`。

*   斐波那契数列的前两个值是零和一。您已经用第二个和第三个值播种了您的序列，虽然它可以正常工作，但在数学上并不正确。

*   因为 Perl 对上下文很敏感，所以您可以删除`scalar`比较数组中元素数量的调用。您还可以使用`if`语句修饰符来避免很多噪音，因此您的`return`行变为`return if @{$nums_ref} >= $max`.

*   您选择的解决方案 - 替换从数组中弹出的项目 - 效率低下且违反直觉。使用列表赋值和 Perl 从数组末尾索引数组元素的能力，您可以编写`my ($last, $secondLast) = @{$nums_ref}[-1, -2]`不会删除元素的元素，因此不需要替换它们。

这是您的程序的快速重写，以向您展示您所缺少的内容！

```
use strict;
use warnings;

my @defaultNums = (0, 1);

fib(\@defaultNums, 10);

sub fib {

  my ($nums_ref, $max) = @_;
  print join(', ', @$nums_ref), "\n";

  my ($last, $secondLast) = @{$nums_ref}[-1, -2];
  my $sum = $last + $secondLast;
  push @$nums_ref, $sum;
  return if @{$nums_ref} >= $max;

  fib($nums_ref, $max);
} 
```

**输出**

```
0, 1
0, 1, 1
0, 1, 1, 2
0, 1, 1, 2, 3
0, 1, 1, 2, 3, 5
0, 1, 1, 2, 3, 5, 8
0, 1, 1, 2, 3, 5, 8, 13
0, 1, 1, 2, 3, 5, 8, 13, 21 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:11:38.653

我发现了我的错误。我每次都会从数组中弹出两次，所以我需要记住在推入 $sum 之前将这些数字推回。无论如何谢谢。

# ios - iOS 加载动画未正确显示

> ID：11277259
> 
> 赞同：0
> 
> 时间：2012-06-30T20:04:06.193
> 
> 标签：ios, loading, nsthread

在我目前正在开发的 iOS 应用程序中，每次页面更改时，该应用程序都会访问数据库以检索信息。在等待查询执行和查询中的信息填充页面上的字段时，应该有一个视图可以弹出、动画并说正在加载。最初有一个方法检查是否有互联网连接，如果有就会显示弹出窗口，然后另一个方法会执行查询。这些像这样穿线的地方

```
[NSThread detachNewThreadSelector:@selector(appStartedLoading) toTarget:self withObject:nil]; 
```

然而，这在大约 10% 的情况下会导致崩溃问题。我不完全理解这个问题，但我认为这是因为分离这样的新线程有时（并非总是）会导致从不是主线程的线程添加子视图。这是一个子问题，我的理论是否合乎逻辑。

无论哪种方式，我们都摆脱了那种做事的方法，只是一次调用一个方法，而不使用线程。像这样

```
[self appStartedLoading];
[self performQuery]; //fake placeholder method for examples sake. 
```

但这导致加载屏幕在下一页已经显示并且查询已经执行后出现，大概是因为应用程序太忙于查询。我尝试按照子视图过去的方式在单独的线程中运行查询，但它没有改变它。我尝试在主线程上运行 appStartedLoading 方法并告诉它阻塞，即

```
[self performSelectorOnMainThread:@selector(appStartedLoading) withObject:nil waitUntilFinished: YES]; 
```

我认为因为它被告知要阻止它直到添加子视图并制作动画之后才会执行查询，但它仍然首先更改页面然后显示加载屏幕。我还尝试在方法中放置一些小循环，以使其在添加子视图之前不会完成，但即使子视图没有显示在屏幕上，它们也会立即完成。循环是这样的。

```
while([[[self.window.subviews objectAtIndex:0] subviews] indexOfObject:loaderView] == NSNotFound)
    {
        i++;
        NSLog(@"this %d", i);
        [[self.window.subviews objectAtIndex:0] addSubview:loaderView];
    } 
```

对我来说，只执行一次是有道理的，因为我告诉它添加子视图，但是为什么添加后它没有出现呢？老实说，我还不擅长编程，并且对这里发生的事情感到非常困惑，如果有人可以帮助在这里阐明一些信息并指出幕后发生的事情的正确方向，那就太棒了。

这是崩溃的错误日志

```
 bool _WebTryThreadLock(bool), 0xc8a7fa0: Tried to obtain the web lock from a thread other than the main thread or the web thread. This may be a result of calling to UIKit from a secondary thread. Crashing now...
1   WebThreadLock
2   -[UITextView setFrame:]
3   UIViewCommonInitWithFrame
4   -[UIView initWithCoder:]
5   -[UIScrollView initWithCoder:]
6   -[UITextView initWithCoder:]
7   UINibDecoderDecodeObjectForValue
8   -[UINibDecoder decodeObjectForKey:]
9   -[UIRuntimeConnection initWithCoder:]
10  UINibDecoderDecodeObjectForValue
11  UINibDecoderDecodeObjectForValue
12  -[UINibDecoder decodeObjectForKey:]
13  -[UINib instantiateWithOwner:options:]
14  -[UIViewController _loadViewFromNibNamed:bundle:]
15  -[UIViewController loadView]
16  -[UIViewController view]
17  -[UIViewController contentScrollView]
18  -[UINavigationController _computeAndApplyScrollContentInsetDeltaForViewController:]
19  -[UINavigationController _layoutViewController:]
20  -[UINavigationController _startTransition:fromViewController:toViewController:]
21  -[UINavigationController _startDeferredTransitionIfNeeded]
22  -[UINavigationController __viewWillLayoutSubviews]
23  -[UILayoutContainerView layoutSubviews]
24  -[UIView(CALayerDelegate) layoutSublayersOfLayer:]
25  -[NSObject performSelector:withObject:]
26  -[CALayer layoutSublayers]
27  CA::Layer::layout_if_needed(CA::Transaction*)
28  CA::Context::commit_transaction(CA::Transaction*)
29  CA::Transaction::commit()
30  CA::Transaction::release_thread(void*) 
31  _pthread_tsd_cleanup 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:24:28.213

尝试使用后台线程的第一种方法，并在何时以及是否可以使其崩溃时发布日志消息。我的预感是你的 while 循环正在转为蓝色，因为你从来没有真正调用`break;`过那个东西。此外，您的子视图循环方法太复杂了。如果您需要某些东西出现在其他所有内容之上，请将其添加为视图控制器的子视图，或者更好的是，它是导航控制器的视图。

# javascript - Facebook 的 JS SDK 中的 ES5() 包装器是开源的吗？

> ID：11277260
> 
> 赞同：2
> 
> 时间：2012-06-30T20:04:25.773
> 
> 标签：javascript, facebook-javascript-sdk

Facebook 的 JS SDK 最近开始使用更新的 ES5 Javascript 方法，例如`Object.keys()`和`[].map()`. 它们仍然通过具有`ES5()`接受原始对象、所需方法的名称和任何参数的函数来支持旧浏览器。然后，如果本机方法不可用，它会运行本机方法或等效的 JS 方法。例如：

```
ES5(g.api.whitelist, 'forEach', true, function(ca) {
    s[ca] = 1;
}); 
```

或对于顶级对象，

```
ES5('JSON', 'parse', false, r.responseText); 
```

我怀疑这是预处理器的结果，而 FB 的开发人员实际上正在编写更多类似于以下内容的内容

```
g.api.whitelist.forEach(function(ca) {
    s[ca] = 1;
}); 
```

和

```
JSON.parse(r.responseText); 
```

（大概也有更长的变量名）

现在，假设我是对的，有一个预处理器，ES5() 函数和相关的预处理是一个开源项目还是内部的东西？如果它是内部的，FB 的任何人都可以评论开源它的可能性吗？这是我发现非常有用的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T00:46:49.470

我们确实使用了一个预处理器（基于[jspatch](https://github.com/facebook/jsgrep)），它可以让我们编写常规的 ES5 代码。该`ES5`函数本身基本上是[MDN](https://developer.mozilla.org/en-US/)和[JSON3](http://bestiejs.github.com/json3/)的 polyfill 的包装器。

这不仅让我们可以编写 ES5，而且避免了我们使用诸如 Function#bind 和`JSON.stringify`.

博客文章[现已发布](https://www.facebook.com/oyvind.kinsey/posts/168150159994289)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:33:57.703

搜索 Facebook 的开源 github 存储库没有显示任何 ES5 方法。我明确地检查并递归地搜索了那些提到 javascript 的内容。因此，您所看到的似乎并没有从他们那里公开获得。我也无法在其他任何地方找到它。

如果您需要 ES5 向后兼容性，请查看此[es5-shim](https://github.com/kriskowal/es5-shim)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:05:03.533

[http://connect.facebook.net/en_US/all.js](http://connect.facebook.net/en_US/all.js)

这是你想要的吗？它没有在文件中列出任何许可证，并且似乎是自动生成的？

[https://github.com/facebook/connect-js/](https://github.com/facebook/connect-js/)

?

这将指向“是”并且许可证将是 apache？

# android - Android ViewFlipper 和 ListView

> ID：11277262
> 
> 赞同：0
> 
> 时间：2012-06-30T20:04:31.710
> 
> 标签：android, listview, android-arrayadapter, viewflipper, onitemclicklistener

我有一个动态填充的 ListView，我想在单击第一个列表中的项目时使用 ViewFlipper 切换到带有按钮的新屏幕。

我已经添加了一个 OnItemClickListener，这样当我单击列表中的项目时，它会显示一条消息。

问题是当我在 onItemClick() 方法中添加 showNext() 方法时，应用程序会因 NullPointerException 而崩溃。

我只是在寻找鳍状肢，以从带有列表的屏幕转换到带有按钮的屏幕。

这是我正在使用的代码片段。

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    deviceListView = (ListView) findViewById(R.id.deviceList);
    listAdapter = new ArrayAdapter(this, android.R.layout.simple_list_item_1);
    setListAdapter(listAdapter);
    deviceListView = getListView();

    flippy = (ViewFlipper) findViewById(R.id.flipper);
    //flippy.setOnClickListener((OnClickListener) this);

    //getListView().setOnItemClickListener(new AdapterView.OnItemClickListener()

    deviceListView.setOnItemClickListener(new AdapterView.OnItemClickListener() 
    {   
        public void onItemClick(AdapterView <?> parent, View v, int position, long id)
        {
            System.out.println("Before Flipper");
            flippy.showNext();
            System.out.println("After Flipper");
        }
    });

    getApplicationContext().bindService(
            new Intent(this, BrowserUpnpService.class),
            serviceConnection,
            Context.BIND_AUTO_CREATE
    );
} 
```

这是我正在使用的 XML

```
 <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:padding="5dp" >
            <ViewFlipper
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:id="@+id/flipper"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >
                <ListView
                    xmlns:android="http://schemas.android.com/apk/res/android"
                    android:id="@+id/deviceList"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent" >
                </ListView>
                <Button
                    android:id="@+id/button1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Button" >
                </Button>
            </ViewFlipper>
        </FrameLayout> 
```

任何帮助将不胜感激。

谢谢 ：）

更新：

这是我得到的错误日志：

```
07-01 12:31:35.548: E/AndroidRuntime(482): FATAL EXCEPTION: main  
07-01 12:31:35.548: E/AndroidRuntime(482): java.lang.NullPointerException  
07-01 12:31:35.548: E/AndroidRuntime(482):  at com.app.browser.BrowseActivity$3.onItemClick(BrowseActivity.java:156)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.widget.AdapterView.performItemClick(AdapterView.java:284)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.widget.ListView.performItemClick(ListView.java:3382)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:1696)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.os.Handler.handleCallback(Handler.java:587)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.os.Handler.dispatchMessage(Handler.java:92)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.os.Looper.loop(Looper.java:123)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at android.app.ActivityThread.main(ActivityThread.java:4627)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at java.lang.reflect.Method.invokeNative(Native Method)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at java.lang.reflect.Method.invoke(Method.java:521)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)  
07-01 12:31:35.548: E/AndroidRuntime(482):  at dalvik.system.NativeStart.main(Native Method) 
```

这是我的主要活动类的代码

```
 setContentView(R.layout.main);

    TabHost tabHost = getTabHost();
    TabHost.TabSpec spec;
    Intent intent;

    intent = new Intent().setClass(this, BrowseActivity.class);
    spec = tabHost.newTabSpec("device")
            .setIndicator("Devices", getResources().getDrawable(R.drawable.ic_launcher))
            .setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, MediaPlayer.class);
    spec = tabHost.newTabSpec("media")
            .setIndicator("Media Player", getResources().getDrawable(R.drawable.ic_launcher))
            .setContent(intent);
    tabHost.addTab(spec);

    tabHost.setCurrentTab(0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:55:05.773

你没有打电话`setContentView(R.layout.yourlayoutname);`，这意味着你的布局没有被放到屏幕上。结果是它将`findViewById()`返回 null 给你。由于您正在尝试调用`null.showNext();`，因此您在该行上得到了一个 nullPointerException 。

# ruby-on-rails-3 - Rails 的默认宝石（最少需要）

> ID：11277269
> 
> 赞同：0
> 
> 时间：2012-06-30T20:05:41.090
> 
> 标签：ruby-on-rails-3, rubygems

我想清理我的开发服务器。我知道安装了大量我不需要的宝石。我似乎无法在任何地方找到 Rails 通常为其自身安装的默认或最小 gem 的列表。如果有人可以帮助我，那将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:45:24.847

没关系，我没有发疯，我安装的 gem 成为最新版本的 rails 的默认设置。毕竟我确实有一个干净的环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:15:18.493

如果您创建一个新应用程序，您可以将它默认为 Gemfile 的 gem 拉取。

# winapi - RegEnumKeyEx 不会更改文件名 Qt

> ID：11277280
> 
> 赞同：0
> 
> 时间：2012-06-30T20:06:59.913
> 
> 标签：winapi, registry

我是winapi的新手，遇到了很多麻烦

试图提取所有连接的 COM 端口并将它们写入提示行。

```
HKEY hKey;
if (RegOpenKey(HKEY_LOCAL_MACHINE,TEXT("HARDWARE\\DEVICEMAP\\SERIALCOMM"),&hKey)==ERROR_SUCCESS)
{
DWORD NumKeys;
DWORD i;
TCHAR KeyNameBuf[255];
DWORD keyNameSizBuf=255;
RegQueryInfoKey(hKey,NULL,NULL,NULL,NULL,NULL,NULL,&NumKeys,NULL,NULL,NULL,NULL);
for (i=0;i<NumKeys-1;i++)
{
    keyNameSizBuf=15;
    RegEnumKeyEx(hKey,i,KeyNameBuf,&keyNameSizBuf,NULL,NULL,NULL,NULL);
    qDebug() <<KeyNameBuf;
}
} 
```

问题：它不会更改 KeyNameBuf 并将其保持为空。

有任何想法吗？谢谢，如果这是微不足道的事情，请提前道歉......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:27:00.380

找到的解决方案：RegEnumKeyEx 检索数据指针（可选参数 7），然后将 int 从 Byte* 转换为 const char *

# java - 向 POI XSSF 工作簿中的合并区域添加边框

> ID：11277281
> 
> 赞同：11
> 
> 时间：2012-06-30T20:07:00.743
> 
> 标签：java, apache-poi, xssf, poi-hssf

我正在使用 apache poi 3.7，我需要将边框放置到一系列单元格或合并区域。

当工作表和工作簿类型为 XSSF 时，如何将边框应用于合并区域。在 HSSF 类型中，我使用 RegionUtil-/HSSFRegionutil，但如果在 XSSF 类型中使用第一个对象 (Regionutil)，则它不起作用并将黑色背景颜色放入单元格范围。

Regionutil 通常与 CellRangeAddress 一起使用，我找不到有关此问题的信息。我不知道 CellRangeAddres 是否会导致这种情况。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-03T12:10:25.300

为此，您必须为合并区域中的每个单元格添加一个空白单元格，然后为每个单元格添加适当的边框。例如，以下代码将在同一行中创建一个包含 5 个单元格的合并区域，在整个合并区域周围有一个边框，并且文本在该区域中居中。

```
XSSFWorkbook wb = new XSSFWorkbook();
CellStyle borderStyle = wb.createCellStyle();
borderStyle.setBorderBottom(CellStyle.BORDER_THIN);
borderStyle.setBorderLeft(CellStyle.BORDER_THIN);
borderStyle.setBorderRight(CellStyle.BORDER_THIN);
borderStyle.setBorderTop(CellStyle.BORDER_THIN);
borderStyle.setAlignment(CellStyle.ALIGN_CENTER);
Sheet sheet = wb.createSheet("Test Sheet");
Row row = sheet.createRow(1);
for (int i = 1; i <= 5; ++i) {
    Cell cell = row.createCell(i);
    cell.setCellStyle(borderStyle);
    if (i == 1) {
        cell.setCellValue("Centred Text");
    } 
}
sheet.addMergedRegion(new CellRangeAddress(1, 1, 1, 5)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-10-03T11:28:21.307

```
private void setBordersToMergedCells(XSSFWorkbook workBook, XSSFSheet sheet) {
        int numMerged = sheet.getNumMergedRegions();

    for(int i= 0; i<numMerged;i++){
        CellRangeAddress mergedRegions = sheet.getMergedRegion(i);
        RegionUtil.setBorderTop(CellStyle.BORDER_THIN, mergedRegions, sheet, workBook);
        RegionUtil.setBorderLeft(CellStyle.BORDER_THIN, mergedRegions, sheet, workBook);
        RegionUtil.setBorderRight(CellStyle.BORDER_THIN, mergedRegions, sheet, workBook);
        RegionUtil.setBorderBottom(CellStyle.BORDER_THIN, mergedRegions, sheet, workBook);
    }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-14T10:37:19.783

对多行执行此操作。

```
Workbook wb = new HSSFWorkbook();

// create a new sheet
Sheet sheet = wb.createSheet();

CellStyle borderStyle = wb.createCellStyle();
borderStyle.setBorderBottom(CellStyle.BORDER_THIN);
borderStyle.setBorderLeft(CellStyle.BORDER_THIN);
borderStyle.setBorderRight(CellStyle.BORDER_THIN);
borderStyle.setBorderTop(CellStyle.BORDER_THIN);
borderStyle.setAlignment(CellStyle.ALIGN_CENTER);
Sheet sheet1 = wb.createSheet("Test Sheet");
Row row = null;
Cell cell;
for (int i = 1; i <= 5; ++i) {
    row = sheet1.createRow(i);
    for(int j=1;j<=5;j++){
        cell= row.createCell(j);
        cell.setCellStyle(borderStyle);
        if (i == 1 && j==1) {
            cell.setCellValue("Centred Text");
        } 
    }
}
sheet1.addMergedRegion(new CellRangeAddress(1, 5, 1, 5)); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-10-04T22:03:26.313

@Jesanagua 刚刚救了我的命，我只需要稍作改动以匹配 3.17。

```
private void setBordersToMergedCells(HSSFSheet sheet) {
    int numMerged = sheet.getNumMergedRegions();
    for (int i = 0; i < numMerged; i++) {
        CellRangeAddress mergedRegions = sheet.getMergedRegion(i);
        RegionUtil.setBorderLeft(BorderStyle.THIN, mergedRegions, sheet);
        RegionUtil.setBorderRight(BorderStyle.THIN, mergedRegions, sheet);
        RegionUtil.setBorderTop(BorderStyle.THIN, mergedRegions, sheet);
        RegionUtil.setBorderBottom(BorderStyle.THIN, mergedRegions, sheet);

    }
} 
```

# iphone - NSTimer 和 CADisplayLink 冲突

> ID：11277286
> 
> 赞同：2
> 
> 时间：2012-06-30T20:07:26.800
> 
> 标签：iphone, timer, game-loop

我有一个 CADisplayLink 作为游戏的主要游戏循环，还有一个 NSTimer，它每十秒产生一次敌人。我用...

```
 -(void)togglePause{
displayLink.paused = !displayLink.paused;
if (displayLink.paused) {
    [self.view addSubview:pauseOverlay];
}else {
    [pauseOverlay removeFromSuperview];
} 
```

...暂停游戏循环，但是即使在游戏暂停后，产生敌人的计时器仍将继续运行，如果我破坏计时器然后再制作另一个计时器，则无法仅利用暂停按钮并在10 秒后导致敌人永远不会生成？有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:57:09.210

抛弃 NSTimer，只需使用每次 CADisplayLink 触发时递增的计数器。一旦它到达*n*产生你的敌人并将计数器归零。如果用户暂停，当他们恢复时，计数器将与原来相同。

# objective-c - 如何实现像 Number and Pages 中的拆分视图？

> ID：11277290
> 
> 赞同：0
> 
> 时间：2012-06-30T20:08:11.117
> 
> 标签：objective-c, cocoa

如何实现像 Pages 和 Number 中的拆分器？（侧面有把手的）：

![数字拆分器](../Images/9dba11171e98addfa1b7a7f04005863a.png) ![页面上的拆分器](../Images/f2aada257734ec80d30345a338325780.png)

用什么来实现它们？源列表或大纲视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T07:07:50.613

`splitView:additionalEffectiveRectOfDividerAtIndex:`您需要处理`NSSplitViewDelegate`返回一个额外的矩形，鼠标单击将在其中启动分隔线拖动。

您可以制作自定义大纲/tableView 标题来绘制句柄并在`splitView:additionalEffectiveRectOfDividerAtIndex:`.

# google-app-engine - 如何使用真实的 Google 帐户在本地测试 Google App Engine？

> ID：11277292
> 
> 赞同：4
> 
> 时间：2012-06-30T20:08:17.297
> 
> 标签：google-app-engine, testing, oauth

是否可以使用真正的 Google 登录而不是 test@example.com 在本地测试 App Engine 应用程序？

我正在尝试省去部署以测试 OAuth 身份验证的麻烦，我希望这是可能的。

非常感谢，查理

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T20:36:12.773

不，您不能使用您的真实帐户，但`test@example.com`您可以使用任何您想要的东西，用多个不同的帐户对其进行测试。当您要部署它时，唯一的区别是它会将您重定向到 Google 登录，而不是这个蓝色登录屏幕。它不要求输入密码，因为它是一个开发环境，您应该能够使用多个帐户对其进行测试，而无需实际需要一个帐户。部署一次以对其进行测试，然后假设它可以工作。

# r - 如何让 R 在包含特定字符的行停止读取文本文件中的行？

> ID：11277295
> 
> 赞同：2
> 
> 时间：2012-06-30T20:09:14.787
> 
> 标签：r, text-mining

例如，我想从文本文件的开头读取行，直到带有`";"`符号的字符串不包括该字符串。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:05:22.230

一个非常简单的方法可能是读取 using 的内容`readLines`：

```
content = readLines("data.txt") 
```

然后拆分上的字符数据`;`：

```
split_content = strsplit(content, split = ";") 
```

然后提取第一个elememt，即直到分号的文本：

```
first_element = lapply(split_content, "[[", 1] 
```

结果是数据文件行中直到分号的所有文本的列表。

Ps 我不完全确定最后一行...我无法检查它，因为我现在无法访问 R。

# java - 如何将生成的 JSON 数据读入 Java？

> ID：11277298
> 
> 赞同：0
> 
> 时间：2012-06-30T20:09:31.350
> 
> 标签：java, json

我正在尝试将 JSON 请求的结果读入 java，但我的 JSON 请求的部分输出如下所示：

```
"route_summary": {
        "total_distance": 740,
        "total_time": 86,
        "start_point": "Marienstraße",
        "end_point": "Feldbergstraße"
    } 
```

我想使用标准 json 库来提取 total_distance 中的值。但是，我似乎只能通过这样做来获得“route_summary”：

```
JSONObject json = null;
json = readJsonFromUrl(request);
json.get("route_summary"); 
```

在哪里

```
public static JSONObject readJsonFromUrl(String url) throws IOException, JSONException {
        InputStream is = new URL(url).openStream();
        try {
            BufferedReader rd = new BufferedReader(new InputStreamReader(is, Charset.forName("UTF-8")));
            String jsonText = readAll(rd);
            JSONObject json = new JSONObject(jsonText);
            return json;
        } finally {
            is.close();
        }
    } 
```

我想要的是“进入” route_summary，任何线索/提示都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:18:18.930

你需要得到`route_summary`，就像你已经做过的那样，并且从那个对象中你需要得到`total_distance`. 这将给您返回`route_summary.total_distance`.

代码示例：

```
 JSONObject object = new JSONObject(s);
    int totalDistance = object.getJSONObject("route_summary").getInt("total_distance"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:18:47.423

I would recommend you to use GSON library. You can create class which will represent the message and then automatically map JSON to object by invoking function: `gson.fromJson(message, YourMessageClass.class).getRoute_summary()`.

Here is the example of such approach: [https://sites.google.com/site/gson/gson-user-guide/#TOC-Object-Examples](https://sites.google.com/site/gson/gson-user-guide/#TOC-Object-Examples)

# ruby-on-rails - 通过 json 设计失败身份验证发回 html 而不是 json

> ID：11277300
> 
> 赞同：6
> 
> 时间：2012-06-30T20:09:32.907
> 
> 标签：ruby-on-rails, json, devise

我设法设置了 json 身份验证。我实现了以下代码：

```
class Users:: SessionsController < Devise::SessionsController
  def create
    respond_to do |format|  
      format.html { super }  
      format.json {  
        warden.authenticate!(:scope => resource_name, :recall => "#{controller_path}#failure")  
        render :json => {:success => true}  
      }
    end  
  end

  def destroy
    respond_to do |format|
      format.html {super}
      format.json {  
        Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name)
        render :json => {}
      }
    end
  end

  def failure
    render :json => {:success => false, :errors => ["Login Failed"]}
  end
end 
```

这工作正常，但是当身份验证失败时，失败不会返回 json 失败。我有一个自定义失败的设计。如果我删除了 redirect_url 或完全删除了客户失败，则身份验证将返回一个带有失败消息的 json。我的自定义失败如下：

```
class CustomFailure < Devise::FailureApp
  def redirect_url
    #return super unless [:worker, :employer, :user].include?(scope) #make it specific to a scope
     '/'
  end

  # You need to override respond to eliminate recall
  def respond
    if http_auth?
      http_auth
  else
    redirect
  end
end 
```

结尾

无论如何，如果它是一个 html 请求，则保留重定向，如果它是一个 json 请求，则返回一个带有失败消息的 json？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T16:36:18.010

您必须告诉典狱长使用该自定义故障。

```
def failure
  respond_to do |format|
    format.html {super}
    format.json do
      warden.custom_failure!
      render :json => {:success => false, :errors => ["Login Failed"]}
    end
  end
end 
```

# android - 我无法接收有关电池状态变化的广播？

> ID：11277302
> 
> 赞同：13
> 
> 时间：2012-06-30T20:09:43.410
> 
> 标签：android, broadcastreceiver, battery

我遇到了与这篇文章完全相同的问题：[Battery broadcast receiver doesn't work](https://stackoverflow.com/questions/8582539/battery-broadcast-receiver-doesnt-work)。但似乎没有人回答过这个问题。

这是我的广播接收器：

```
public class BatteryLevelReceiver extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {
    Log.v("plugg", "plug change fired");
    Toast.makeText(context, " plug change fired", Toast.LENGTH_LONG).show();
        } 
```

这是我的 AndroidManifest.xml：

```
<receiver android:name=".ReceversAndServices.BatteryLevelReceiver">
               <intent-filter android:priority="900">
               <action android:name="android.intent.action.BATTERY_LOW" />

               </intent-filter>
           </receiver>

           <receiver android:name=".ReceversAndServices.BatteryLevelReceiver">
               <intent-filter android:priority="900">
               <action android:name="android.intent.action.BATTERY_CHANGED" />
               </intent-filter>
           </receiver> 
```

我还在清单中添加了这一行：

```
<uses-permission android:name="android.permission.BATTERY_STATS"/> 
```

但是还是没有成功！

如果有人能告诉我我做错了什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-30T20:43:22.757

从[ACTION_BATTERY_CHANGED 的文档中](http://developer.android.com/reference/android/content/Intent.html#ACTION_BATTERY_CHANGED)：

> 您不能通过清单中声明的​​组件接收此信息，只能通过使用 Context.registerReceiver() 显式注册它。请参阅 ACTION_BATTERY_LOW、ACTION_BATTERY_OKAY、ACTION_POWER_CONNECTED 和 ACTION_POWER_DISCONNECTED，了解发送和可以通过清单接收器接收的不同电池相关广播。

你有它：你必须从你的 Java 代码中显式地注册它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:31:26.833

我刚刚遵循了 Android 开发人员指南关于[监控电池电量和充电状态](http://developer.android.com/training/monitoring-device-state/battery-monitoring.html)的操作，并立即取得了成功。如果 BatteryLevelReceiver 是它自己的类，那么我建议：

```
<receiver android:name=".BatteryLevelReceiver">
    <intent-filter android:priority="900">
       <action android:name="android.intent.action.BATTERY_LOW" />
       <action android:name="android.intent.action.BATTERY_CHANGED" />
    </intent-filter>
</receiver> 
```

**添加**

我愿意猜测您将 BatteryLevelReceiver 作为 ReceversAndServices 中的嵌套类编写。根据[Receiver as internal class in Android](https://stackoverflow.com/q/3608955/1267661)，你不能用非静态类做到这一点。您可以将 BatteryLevelReceiver 设为静态类并在 onResume() 中注册接收器，但随后您的应用将需要运行以捕获事件...将接收器移动到单独的类并注册这些 Intent：

```
<receiver android:name=".BatteryLevelReceiver">
    <intent-filter android:priority="900">
       <action android:name="android.intent.action.BATTERY_LOW" />
       <action android:name="android.intent.action.BATTERY_OKAY" />
       <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
       <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
    </intent-filter>
</receiver> 
```

（不是 BATTERY_CHANGED 正如 Darshan Computing 指出的那样。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:47:22.747

确保电池接收器类不是另一个类的子类，而是项目中的一个单独类。

还可以尝试在代码中明确使用 Context.registerReceiver() 方法，不要忘记取消注册：http: [//developer.android.com/reference/android/content/Context.html#registerReceiver%28android.content.BroadcastReceiver,% 20android.content.IntentFilter%29](http://developer.android.com/reference/android/content/Context.html#registerReceiver%28android.content.BroadcastReceiver,%20android.content.IntentFilter%29)

# css - horizontal accordion links scroll down page to bottom when clicked

> ID：11277306
> 
> 赞同：1
> 
> 时间：2012-06-30T20:10:41.430
> 
> 标签：css

I'm an absolute newbie so please bear with me. I've read a lot of posts here that I think may be related to my question but I'm having a hard time understanding the solutions provided.

I'm trying to create an on-click horizontal accordion with just CSS. With Firefox it works just fine. The problem occurs in Chrome and Safari.

The problem is that every time the links are clicked the page scrolls down almost to the bottom of the page that you need to scroll back up in order to see the entire content. The links look like this:

```
 <h2><a href="#accordion1">title1</a></h2> 
```

Needless to say this can be very annoying to the user. I've read somewhere that this can be avoided using JavaScript `preventDefault()`. How do I go about that? What are the other ways to prevent this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:18:52.073

**Edit - so it seems preventDefault() cancels all of the default behaviours(makes sense actually) - The first solution I presented turns out to be not a solution at all.**

So, this actually proves quite hard to do.

After some searching I've come to the conclusion that it's not possible to cancel the scroll without also canceling the links default behaviour (hence the default in `.preventDefault()`).

What you can do is scroll back to where you were after the links scrolling is done, but even if you do it as soon as you possibly can, you'll still be able to see the scrolls hapenning on the browser - so it's an ugly solution. (you can see it here anyway - [http://jsfiddle.net/joplomacedo/RpDyc/](http://jsfiddle.net/joplomacedo/RpDyc/) ).

So, alternatives? Since as your doing it (I assume here you're using the :target pseudo class) you still need javascript, then forget the :target stuff and rely on javascript alone. It's simpler, cleaner and less 'hacky'.

Here's how I'd do it (jquery) -> [http://jsfiddle.net/joplomacedo/AfzJY/](http://jsfiddle.net/joplomacedo/AfzJY/)

If you however insist on doing it with CSS then I'd recommend doing it as Chris Coyier suggests [here](http://css-tricks.com/functional-css-tabs-revisited/) by taking advantage not of :target but :checked. I won't further develop here since his article does that pretty well.

**Before Edit**

Are you using jquery? If so all you'd need is this:

```
$('a[href="#accordion1"]').on('click', function (e) {
   e.preventDefault();
}); 
```

If you're not using jquery then here's how to do it with pure javascript:

```
var cancels_links = document.getElementsByClassName('cancels-link');

var cancel = function cancel(e) {
    e.preventDefault();
};

for (var i = 0, max = cancels_links.length; i < max; i++) {
    cancels_links[i].addEventListener('click', cancel, false );
} 
```

...this one requires you to add `class="cancels-link"` to each 'a' element who's default behaviour you want to cancel.

Here's a fiddle with the two solutions -> [http://jsfiddle.net/cBQnv/3/](http://jsfiddle.net/cBQnv/3/)

# c - 在 ansi C 中为嵌入式设备编写可重用的低级图形库

> ID：11277307
> 
> 赞同：1
> 
> 时间：2012-06-30T20:11:14.037
> 
> 标签：c, oop, pic, code-reuse

我必须编写一个低级驱动程序来管理嵌入式设备的 tft 显示。器件由 PIC24、64K ram 和大约 128K 程序存储器供电。

我的意图是编写一个通用图形库，我将在其中放置所有原始图形函数和驱动程序以发送命令和数据以进行显示。

图形库使用驱动程序来访问显示，但显示技术可以改变，因此驱动程序必须易于重新实现。

在这种情况下编写可重用代码的最佳方法是什么？

```
 -----------------          ---------------       
|                 |        |               |
|                 |        |               |
|    GFX_LIB      | =====> |    DRIVER     | ====> DISPLAY
|                 |        |               |
|                 |        |               |
 -----------------          -----/----\----
                                /      \
                               /        \
                         ----------   ----------
                        |          | |          |
                        | TYPE A   | |  TYPE B  |
                        |          | |          |
                         ----------   ---------- 
```

* * *

**更多细节**

这是我的 gfx lib 的一段代码

```
#include "Graphics.h"

void gfx_Init(uint16_t width, uint16_t height, uint8_t rotation){
    gfx_displayWidth=width;
    gfx_displayHeight=height;
    gfx_rotation=rotation;  
    displayDriverInit();
}

void gfx_setPixel(uint16_t x, uint16_t y, uint32_t color){
    displayDriverSendCommand(CHANGE_COORDINATE);
    displayDriverSendData(x);
    displayDriverSendData(y);
    displayDriverSendCommand(SET_COLOR);
    displayDriverSendData(color);
} 
```

这是我的图形库的假设实现。

现在，如果我更改驱动程序，如果我可以重用我的 gfx 库，并且只重写显示驱动程序例程，我真的很高兴。实现这一目标的最佳方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:16:50.310

为什么要重新发明轮子？使用[GD 图形库](http://www.boutell.com/gd/)在显示器的图像缓冲区中创建图像。或者在显示器的图像缓冲区之外创建一个图像，然后在完成渲染后复制像素数据。

请注意，GD 通常用于创建图像文件（然后由浏览器下载），但渲染代码是独立的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:43:21.277

这在一定程度上取决于您的驱动程序将提供什么功能。

一个最小的 API 可以这样声明：

```
typedef void* gfx;
typedef struct init_options {
  int display_width, display_height;
  //..etc..
};

gfx* gfx_init( init_options* opts );
void gfx_free( gfx* gfx );

// blit something onto sceeen
void gfx_blit( gfx* gfx, void* buffer, int buf_w, int buf_h, int trg_x, int trg_y, int trg_w, int trg_h );

// if you have double buffering (probably a good idea)
void gfx_swap( gfx* gfx ); 
```

初始化、关闭、模式切换和在屏幕上显示像素可能是您所需要的。也许您还应该提供一个快速的 SetPixel() 例程。基于此，其他一切都可以在某种“GfxUtil”库中实现。

此 API 的驱动程序选择和实现可以通过链接正确的库来处理（其中每个库都包含一个实际的驱动程序，包含用于 blitting 的实际代码等）。

**编辑**

要拥有一些可动态替换的代码，您的驱​​动程序可以是一个结构，其中包含指向驱动程序特定代码的实际实现的函数指针：

```
// common driver struct, used by gfx api
typedef struct driver {
    void (*init)( driver *driver, init_options* );
    void (*setpixel)( driver *driver, int x, int y, color color );
    //...
};

// driver constructor
driver* create_foo_driver() {
    driver* d = malloc( sizeof(driver) );
    memset(d,0,sizeof(driver));
    d->init = foo_init;
    d->setpixel = foo_setpixel;
    return d;
}

// some driver-specific code ...
void foo_setpixel( driver *driver, int x, int y, color color ) {
    // actual implementation
}

// API code calling driver code
void gfx_setpixel( gfx* gfx, int x, int y, color color ) {
   driver* driver = ((gfx_impl)gfx)->driver; // .. just an example
   driver->setpixel( driver, x, y, color );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:16:37.840

根据您在平台上可以节省多少内存，您可以使用[Cairo](http://cairographics.org/)，它的结构与您在 ASCII 艺术中绘制的完全一样。它也在 C 中实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-06T08:19:49.953

任何在这里用谷歌搜索的人都应该看看[Adafruit 的 GFX 库](https://github.com/adafruit/Adafruit-GFX-Library)，然后看看他们的特定图形驱动程序库是如何实现它的。我的经验特别是他们的[ST7735 驱动程序](https://github.com/adafruit/Adafruit-ST7735-Library)（我移植到在[chipKIT 的PIC32](http://chipkit.org/forum/viewtopic.php?f=18&t=2530)上工作，现在正在从经验丰富的chipKIT 开发人员那里获得帮助）。特定硬件驱动程序可以实现的 C++/OOP 图形框架的完美示例。

我很惊讶这个问题并没有像其他“我怎么能完成这个”类型的问题一样被关闭。

# php - 在 PHP/MySQL 中手动增加计数器的最佳方法是什么？

> ID：11277311
> 
> 赞同：3
> 
> 时间：2012-06-30T20:11:31.140
> 
> 标签：php, mysql

我需要在我的一个项目中使用batchId，一行或多行可以有单个batchId。因此，当我要从单个用户插入一堆 1000 行时，我会给这 1000 行一个单独的 batchId。这个batchId 是下一个自动增量batchId。

目前我为 unique_ids 维护一个单独的数据库表，并将最后一个 batchId 存储在那里。每当我需要在表中插入一批行时，我将 unique_ids 表中的 batchId 更新 1 并将其用于批量插入。

```
update unique_ids set nextId = nextId + 1 where `key` = 'batchId';

select nextId from unique_ids where `key` = 'batchId'; 
```

我调用了一个函数，该函数触发了两个查询，并返回了批处理的 nextId (batchId)。

这是我的 PHP 类和函数调用。我正在使用 ADODB，您可以忽略与 ADODB 相关的代码。

```
 class UniqueId
        {
                static public $db;

                public function __construct()
                {

                }

                static public function getNextId()
                {
                        self::$db = getDBInstance();        
                        $updUniqueIds = "Update unique_ids set nextId = nextId + 1 where `key` = 'batchId'";
                        self::$db->EXECUTE($updUniqueIds);

                        $selUniqueId = "Select nextId from unique_ids where `key` = 'batchId'";
                        $resUniqueId = self::$db->EXECUTE($selUniqueId);

                        return $resUniqueId->fields['nextId'];
                }
        } 
```

现在，每当我需要下一个 batchId 时，我只需调用下面的代码行。

```
`$batchId = UniqueId::getNextId();` 
```

但真正的问题是，当一秒钟内有数百个同时请求时，**它会将相同的 batchId 分配给两个不同的批次。**对我来说这是一个严重的问题。我需要解决这个问题。

请建议我该怎么做？我可以只限制这个类的一个实例，所以没有同时请求可以一次调用这个函数，并且永远不会给两个不同的批次提供一个 batchId。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:21:10.577

Have a look into atomic operations or transactions. It will lock the database and only allow one write query at any given instance in time.

This might affect your performance, since now other users have to wait for a unlocked database!

I am not sure what sort of support ADODB provides for [atomicity](http://en.wikipedia.org/wiki/Atomicity_%28database_systems%29) though!

Basic concept is:

```
Acquire Lock
Read from DB
Write to DB with new ID
Release Lock 
```

If a lock is already acquired, the script will be blocked (busy waiting) until it is released again. But this way you are guaranteed no data hazards occur.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-09T02:28:46.060

开始 tran 更新 选择 提交

这样，更新锁可以防止两个并发运行提取相同的值。

如果选择第一个，共享锁不会隔离两者

# javascript - 为什么这会给出“未定义”错误？

> ID：11277313
> 
> 赞同：0
> 
> 时间：2012-06-30T20:11:44.050
> 
> 标签：javascript

我试图让用户将某些内容放入文本区域，并且输出应该是他重复 x 次所写的内容，但我收到错误“document.forme 未定义”。

你能帮我理解为什么它是未定义的吗？

我的代码：

```
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>input home work</title>
<script type="text/javascript">

 var help= document.forme.tryout.value;

 for (x=1; x<=10;x++){

 function numberCheak (){

     document.write("this is"+"  "+help++);

     }

 }
  </script>

  </head>

 <body>
<form name="forme">

<input name="tryout" type="text" />
  <input type="button" value="click me" onClick="numberCheak();"/>

</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:33:39.343

好吧，你有几个问题。第一个是您尝试访问尚不存在的表单元素：脚本位于表单元素上方，因此当您尝试获取表单时表单不存在。如果将脚本移动到页面底部，效果会更好。

其次，循环应该在函数内部，而不是包裹在函数周围。

第三，`document.write`具有奇怪的副作用并导致文档被重写，并且将阻止脚本正确继续。

这是我修改后的脚本

```
function numberCheak() {
    var help = document.forme.tryout.value;
    for (var x = 1; x <= 10; x++) {
        document.getElementById("output").innerHTML += help;
    }
} 
```

以及随之而来的 HTML 表单

```
<form name="forme" id="forme">
    <input name="tryout" type="text" /> 
    <input type="button" value="click me" onclick="numberCheak();" /> 
    <span id="output"></span>
</form> 
```

您可以[在 jsFiddle 上看到它的实际效果。](http://jsfiddle.net/zpax9/1/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-30T20:16:10.927

表单存储在集合中，可以像这样访问：

`var form = document.forms[i];` 或者 `var form = document.forms[name];`

在你的情况下，`i`是 0 并且`name`是形式。

# ruby-on-rails - 从数据库中选择记录（sqlite3）

> ID：11277318
> 
> 赞同：0
> 
> 时间：2012-06-30T20:12:25.897
> 
> 标签：ruby-on-rails

我有一个用户表，在插入值之前，我需要检查用户是否已经存在，我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:16:08.510

您可以使用[`exists?`](http://apidock.com/rails/ActiveRecord/FinderMethods/exists%3F)或者可能使用动态方法，例如`find_or_create_by_...`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:25:35.870

> *需要检查用户是否已经存在*

首先，您需要定义“用户已存在”的含义-> 电子邮件地址可能是唯一的？

见[http://guides.rubyonrails.org/active_record_validations_callbacks.html#uniqueness](http://guides.rubyonrails.org/active_record_validations_callbacks.html#uniqueness)

```
class User < ActiveRecord::Base
  validates :email, :uniqueness => true
end 
```

> 验证通过对模型的表执行 SQL 查询，在该属性中搜索具有相同值的现有记录来进行。它不会在数据库中创建唯一性约束。

与数据库中的唯一约束结合使用可能是您最好的选择；创建一个迁移

```
change_table :users do |t|
  t.index :email, :unique => true
end 
```

# eclipse - Eclipse RCP——如何使用线程使用（等待和通知）执行暂停/恢复按钮功能

> ID：11277321
> 
> 赞同：0
> 
> 时间：2012-06-30T20:13:24.097
> 
> 标签：eclipse, button, rcp, thread-synchronization

问题陈述： -

我有一个 UI 按钮“**执行**”——它将在不同的线程中依次启动一个大的后台进程。一旦进程开始，按钮文本将切换到“**暂停**”现在按下“暂停”，我需要暂停线程执行，“**恢复**”最终会通知继续。

按下按钮“**执行**”，线程开始，按钮切换到“**暂停**”，如果我按下暂停，线程被暂停。但我无法恢复正在运行的线程。如果我在恢复按钮按下事件中检查线程状态，我得到 value=0 相当于 NONe。请帮忙。以下是我的代码....

> 块引用

```
performBButton.addSelectionListener(new SelectionListener() {
        @Override
        public void widgetSelected(SelectionEvent e) {
            Button btnToggle = (Button) e.getSource();
            MyJob myJob = new MyJob();
            if (btnToggle.getText().equalsIgnoreCase("Perform")) {
                btnToggle.setText("Pause");
                myJob.schedule();

            }
            else if (btnToggle.getText().equals("Pause")) {
                buttonToggle.setText("Resume");
                isPaused=!isPaused;
            }
            else if (btnToggle.getText().equals("Resume")) {
                buttonToggle.setText("Pause");
                isPaused=!isPaused;
                synchronized (myJob) {
                    myJob.notify();
                  }
            }
        }
    });

class MYJob extends Job{
   public void run(IProgessMonito monitor) {
       @Override
       public void run() {
           for (int i=0;i<50000;i++) {
               System.out.println("Iteration "+i +isPaused);
                    synchronized (this) {
                        if (isPaused) {                               
                                wait();
                            } 
                        }
                    }
         Thread.sleep(1000);//I have removed try catch while pasting here

    }
}
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T09:54:16.823

通过全局声明 myThread ，将 wait() 更改为 myThread.wait() 实际上解决了我的问题。但它不是正确的方法，任何进一步的建议都会有所帮助......

# python - 通过 flask + redis 提供文件

> ID：11277323
> 
> 赞同：0
> 
> 时间：2012-06-30T20:13:52.207
> 
> 标签：python, ajax, redis, download, flask

这可能是一个菜鸟问题，所以我提前道歉。如何让运行 flask+redis 的 Web 服务器提供二进制文件作为对链接/查询的响应？

我希望对链接的响应是一些 AJAX 操作，例如更改 div，或者弹出“不可用”响应，或者返回一些二进制文件。我希望在客户端（jQuery / 其他 Javascript）和服务器端都得到帮助。

谢谢！

附带问题：你会为这个任务选择redis吗？或者可能是其他的东西，比如 MongoDB，或者一个常规的 RDBMS？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:15:14.533

通常你会配置你的网络服务器，以便引用静态文件的 URL 直接由服务器处理，而不是通过 Flask。

# c++ - 使用 AES / Crypto++ 解密

> ID：11277324
> 
> 赞同：4
> 
> 时间：2012-06-30T20:14:04.243
> 
> 标签：c++, aes, crypto++

我试图弄清楚如何使用 AES 解密一个密文块。我正在使用 crypto++ 库 - 或者至少尝试使用该库。但我绝对无处可去。我假设运行这个解密算法只需要几行代码，但我想不通。这就是我写的。现在开始大笑：

```
#include <stdio.h>
#include <cstdlib>
#include <rijndael.h>
#include <sha.h>

using namespace std;

int main()
{

    // Decryption
    CTR_Mode< AES >::Decryption decryptor;
    decryptor.SetKeyWithIV( cbcKey, AES::DEFAULT_KEYLENGTH, cbcCipher );
} 
```

谁能给我一个简短的教程，告诉我如何“简单地”解密一个 16 字节的密文块，给定一个使用 crypto++ 的解密密钥？他们的文档比您在上面看到的密文（至少对我而言）更神秘，而且我通过搜索几乎找不到帮助。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-04T04:49:58.250

> 谁能给我一个简短的教程，告诉我如何“简单地”解密一个 16 字节的密文块，给定一个使用 crypto++ 的解密密钥？

这来自 Crypto++ wiki。它提供了一个[CTR 模式示例](http://www.cryptopp.com/wiki/CTR_Mode)。

```
AutoSeededRandomPool prng;

SecByteBlock key(AES::DEFAULT_KEYLENGTH);
prng.GenerateBlock( key, key.size() );

byte ctr[ AES::BLOCKSIZE ];
prng.GenerateBlock( ctr, sizeof(ctr) );

string plain = "CTR Mode Test";
string cipher, encoded, recovered;

/*********************************\
\*********************************/

try
{
    cout << "plain text: " << plain << endl;

    CTR_Mode< AES >::Encryption e;
    e.SetKeyWithIV( key, key.size(), ctr );

    // The StreamTransformationFilter adds padding
    //  as required. ECB and CBC Mode must be padded
    //  to the block size of the cipher. CTR does not.
    StringSource ss1( plain, true, 
        new StreamTransformationFilter( e,
            new StringSink( cipher )
        ) // StreamTransformationFilter      
    ); // StringSource
}
catch( CryptoPP::Exception& e )
{
    cerr << e.what() << endl;
    exit(1);
}

/*********************************\
\*********************************/

// Pretty print cipher text
StringSource ss2( cipher, true,
    new HexEncoder(
        new StringSink( encoded )
    ) // HexEncoder
); // StringSource
cout << "cipher text: " << encoded << endl;

/*********************************\
\*********************************/

try
{
    CTR_Mode< AES >::Decryption d;
    d.SetKeyWithIV( key, key.size(), ctr );

    // The StreamTransformationFilter removes
    //  padding as required.
    StringSource ss3( cipher, true, 
        new StreamTransformationFilter( d,
            new StringSink( recovered )
        ) // StreamTransformationFilter
    ); // StringSource

    cout << "recovered text: " << recovered << endl;
}
catch( CryptoPP::Exception& e )
{
    cerr << e.what() << endl;
    exit(1);
} 
```

下面是运行示例程序的结果：

```
$ ./crytpopp-test.exe 
key: F534FC7F0565A8CF1629F01DB31AE3CA
counter: A4D16CBC010DACAA2E54FA676B57A345
plain text: CTR Mode Test
cipher text: 12455EDB41020E6D751F207EE6
recovered text: CTR Mode Test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T06:58:22.980

crypto++ 库网页上的常见问题解答包含指向“教程”的指针，去[那里](http://www.cryptopp.com/wiki/FAQ)阅读吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-02T14:49:15.910

事实上，Crypto++ 教程非常难学。一般来说，要使用 Crypto++ API，您至少需要具备一些密码学的基本知识，我建议您参加[Cryptography course](https://class.coursera.org/crypto-012)。

说了这么多，我来回答你的问题。由于它有点模棱两可，我假设您想使用 CTR 模式解密 AES 密码。作为输入，假设您有一个密码、IV 和密钥（均以 a 中的十六进制表示`std::string`）。

```
#include <iostream>
#include <string>

#include "crypto++/modes.h" // For CTR_Mode
#include "crypto++/filters.h" //For StringSource
#include "crypto++/aes.h" // For AES
#include "crypto++/hex.h" // For HexDecoder

int main(int argc, char* argv[]) {
    // Our input:
    // Note: the input was previously generated by the same cipher 
    std::string iv_string = "37C6D22FADE22B2D924598BEE2455EFC";
    std::string cipher_string = "221DF9130F0E05E7E87C89EE6A";
    std::string key_string = "7D9BB722DA2DC8674E08C3D44AAE976F";

    std::cout << "Cipher text: " << cipher_string << std::endl;
    std::cout << "Key: " << key_string << std::endl;
    std::cout << "IV: " << iv_string << std::endl;

    // 1\. Decode iv: 
    // At the moment our input is encoded in string format...
    // we need it in raw hex: 
    byte iv[CryptoPP::AES::BLOCKSIZE] = {};
    // this decoder would transform our std::string into raw hex:
    CryptoPP::HexDecoder decoder;
    decoder.Put((byte*)iv_string.data(), iv_string.size());
    decoder.MessageEnd();
    decoder.Get(iv, sizeof(iv));

    // 2\. Decode cipher:
    // Next, we do a similar trick for cipher, only here we would leave raw hex
    //  in a std::string.data(), since it is convenient for us to pass this
    // std::string to the decryptor mechanism:
    std::string cipher_raw;
    {
        CryptoPP::HexDecoder decoder;
        decoder.Put((byte*)cipher_string.data(), cipher_string.size());
        decoder.MessageEnd();

        long long size = decoder.MaxRetrievable();
        cipher_raw.resize(size);       
        decoder.Get((byte*)cipher_raw.data(), cipher_raw.size());
        // If we print this string it's completely rubbish: 
        // std::cout << "Raw cipher: " << cipher_raw << std::endl;
    }

    // 3\. Decode the key:
    // And finally the same for the key:
    byte key[CryptoPP::AES::DEFAULT_KEYLENGTH];
    {
        CryptoPP::HexDecoder decoder;
        decoder.Put((byte*)key_string.data(), key_string.size());
        decoder.MessageEnd();
        decoder.Get(key, sizeof(key));
    }

    // 4\. Decrypt:
    std::string decrypted_text;
    try {
            CryptoPP::CTR_Mode<CryptoPP::AES>::Decryption d;
            d.SetKeyWithIV(key, sizeof(key), iv);

            CryptoPP::StringSource ss(
                cipher_raw, 
                true, 
                new CryptoPP::StreamTransformationFilter(
                    d,
                    new CryptoPP::StringSink(decrypted_text)
                ) // StreamTransformationFilter
            ); // StringSource

            std::cout << "Decrypted text: " << decrypted_text << std::endl;
    }
    catch( CryptoPP::Exception& e ) {
            std::cerr << e.what() << std::endl;
            exit(1);
    }

    return 0;
} 
```

我使用 Crypto++562 在 Ubutunu 14.04 上编译它：

`g++ -Wall -std=c++0x -o prog practicalAES.cpp -lcryptopp`

如果我运行程序，我会得到以下输出：

`Cipher text: 221DF9130F0E05E7E87C89EE6A Key: 7D9BB722DA2DC8674E08C3D44AAE976F IV: 37C6D22FADE22B2D924598BEE2455EFC Decrypted text: CTR Mode Test`

它在这里并不真正可见，但 Key 和 IV 具有相同的长度 - 16 个字节（或 128 位）。这是块大小，所以这个密码是 AES-128。由于是CTR方式，所以不加padding，密文和明文的字节数相同。

另请注意，60% 的代码涉及将字符串解码为十六进制，而解密本身只是最后一步（因此，如果您的输入数据是原始十六进制，则不需要解码）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-29T15:15:35.857

Crypto++ 的教程侧重于过滤器以及源和接收器的使用，在我看来，它们过于复杂。在您的情况下，代码实际上非常简单：

```
CTR_Mode< AES >::Decryption decryptor;
decryptor.SetKeyWithIV( cbcKey, AES::DEFAULT_KEYLENGTH, cbcCipher );
decryptor.ProcessData(output, input, size);

// Decrypt another piece of data with the same key
decryptor.Resynchronize(new_iv, new_iv_length);
decryptor.ProcessData(new_output, new_input, size); 
```

# java - 如何在 JSP 输出前后写入内容

> ID：11277326
> 
> 赞同：0
> 
> 时间：2012-06-30T20:14:19.000
> 
> 标签：java, html, jsp, servlets

我有代表组件的 JPS。我想让这些组件 JSP 在执行 JSP 的内容之前和之后编写一些 HTML。

组件.jsp

```
<@page session="false">
<%= "hello " + "world" %> 
```

当这个 JSP/servlet 被渲染时，我希望它渲染：

```
<div class="component">
hello world
</div> 
```

我希望能够创建各种“包装器”，并且根据 JSP，包括用正确的内容包装 JSP 的内容。如果我想在路上更改/增加包装器，我只想在一个地方进行（可能是 100 个组件）。

我可以用 <@page extends="..."> 做点什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:42:10.620

你要的是什么名字：**标签文件**。在 JSP 2.0 上引入

通过这种方法，您可以使用 jsp 编写 JSP 标签，因此您需要创建一个名为 的文件夹`WEB-INF/tags`，并在此文件夹中创建一个“普通”jsp。

您要创建的标签需要具有以下启动指令： `<%@tag description="tag description" %>`以表明这是一个标签。

要使用它，您需要使用以下说明引用要使用的标签：`<%@ taglib tagdir="/WEB-INF/tags" prefix="custom"%>`

因此，您可以执行以下操作：WEB-INF/tags/myTag.tag

* * *

```
<%@tag description="hello tag" %>
<%@attribute name="name" required="false" type="java.lang.String"%>
<html><head></head><body>
<h1>Hello <%=name%></h1>
<jsp:doBody />
</body> 
```

索引.jsp

* * *

```
<%@ taglib tagdir="/WEB-INF/tags" prefix="custom"%>
<custom:myTag name="My Name">this is the content</custom:myTag> 
```

* * *

结果将是一页打印

```
<html><head></head><body>
<h1>Hello My Name</h1>
this is the content
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:29:30.983

这是一个*可怕*的想法。带有 scriptlet 的 JSP 是 1998 年的技术。 *没有人*再写这些了。

如果必须编写 JSP，最好使用 JSTL 和 SiteMesh 或 Tiles 之类的东西来合成页面。

一个更好的想法是开始朝着可以让您轻松地在 Web 应用程序旁边运行移动解决方案的方向发展。服务和模板将是我对 JSP 的偏好。

# xslt-1.0 - 通过在 xslt 中给出前缀来获取命名空间 uri

> ID：11277329
> 
> 赞同：1
> 
> 时间：2012-06-30T20:14:56.287
> 
> 标签：xslt-1.0

我正在使用 xsl 1.0。我需要从前缀中获取命名空间 uri。

```
 <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:a1="http://example.com/arthemetic/integers/a1">
<soapenv:Header>
</soapenv:Header>
<soapenv:Body>
<a1:add>
</a1:add>
</soapenv:Body>
</soapenv:Envelope> 
```

我想获取前缀 a1 的命名空间 uri 是[http://example.com/arthemetic/integers/v1](http://example.com/arthemetic/integers/v1)
这是我正在尝试的代码，

```
<xsl:template match="/">
<xsl:variable name="operationName">
<xsl:value-of
select="name(/*[local-name()='Envelope']/*[local-name()='Body']/*[1])"></xsl:value-of>
</xsl:variable>
<xsl:variable name="prefix">
<xsl:value-of select="substring-before($operationName, ':')"></xsl:value-of>
</xsl:variable>
<xsl:variable name="ns-node"
select="namespace::node()[.= $prefix]" />
dfadsfdfadsf
<xsl:value-of select="$ns-node" />
</xsl:template>
</xsl:stylesheet> 
```

但我没有收到命名空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:19:29.920

**使用**：

```
<xsl:value-of select="/*/namespace::a1"/> 
```

**这是一个完整的转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
   <xsl:value-of select="/*/namespace::a1"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:a1="http://abc.com/arthemetic/integers/a1">
    <soapenv:Header></soapenv:Header>
    <soapenv:Body>
        <a1:add></a1:add>
    </soapenv:Body>
</soapenv:Envelope> 
```

**产生了想要的正确结果**：

```
http://abc.com/arthemetic/integers/a1 
```

# plupload - 使用 Plupload 创建 AngularJS 指令

> ID：11277330
> 
> 赞同：9
> 
> 时间：2012-06-30T20:14:59.210
> 
> 标签：plupload, angularjs

我正在开发一个可以上传文件的应用程序。我想创建一个可重用的文件上传组件，它可以包含在任何需要文件上传功能的页面上。我原本以为我可以只使用 JSP 标记。然而，我们最近发现了 AngularJS，现在想在整个应用程序中使用它。所以，我想创建一个指令，允许我简单地放置一个`<myApp-upload>`标签来粘贴我的上传功能。

我首先将我的上传功能设置为自己的 HTML 页面，以确保 AngularJS 与[Plupload](http://www.plupload.com/)插件配合得很好。我把这样的东西放在一起：

```
<html ng-app="myApp">
<head>
    <script src="resources/scripts/angular-1.0.1.min.js"></script>
    <script src="resources/scripts/myApp.js"></script>
</head>
<body>
   <style type="text/css">@import url(resources/scripts/plupload/jquery.plupload.queue/css/jquery.plupload.queue.css);</style>
   <script type="text/javascript" src="resources/scripts/jquery-1.7.2.min.js"></script>

   <script type="text/javascript" src="resources/scripts/plupload/plupload.full.js"></script>
   <script type="text/javascript" src="resources/scripts/plupload/jquery.plupload.queue/jquery.plupload.queue.js"></script>

   <div id="uploadContainer" ng-controller="FileUploadCtrl">
        <div id="dropArea" style="border: 1px black dashed;">Drag files to here<br><br><br></div>
        Files to upload:<br>
        <div ng-repeat="currFile in uploader.files">{{currFile.name}} ({{currFile.size}})</div>
        <br><br>
       <!-- For debugging -->
       {{uploader.files}}
    </div>
</body>
</html> 
```

myApp.js 看起来像这样：

```
function FileUploadCtrl($scope)
{
    $scope.uploader = new plupload.Uploader({
        runtimes : 'html5,flash,html4',
        url : 'media/upload',
        max_file_size : '10mb',
        container: 'uploadContainer',
        drop_element: 'dropArea'
    });

    $scope.uploader.init();

    $scope.uploader.bind('FilesAdded', function(up, files) {
        $scope.$apply();
    }); 
} 
```

当我将文件拖入时，我看到文件名出现并且 {{uploader.files}} 的输出更改`[]`为上传器对象中的文件。所以，现在我想把它变成一个指令。我将 body 标记中的所有内容保存到一个名为 upload.html 的文件中。然后我将以下内容添加到 myApp.js：

```
angular.module('myApp', [])
.directive('myAppUpload', function () {
    return {
        restrict: 'E',
        templateUrl: 'upload.html',
    };
}); 
```

然后，我有一个这样的 HTML 文件：

```
<html ng-app="myApp">
<head>
    <script src="resources/scripts/angular-1.0.1.min.js"></script>
    <script src="resources/scripts/myApp.js"></script>
</head>
<body>
    <myApp-upload>
       This will be replaced
    </myApp-upload>
</body>
</html> 
```

当我加载这个 HTML 页面时，`<myApp-upload>`标签确实会引入 upload.html 文件。但是，它不执行任何数据绑定。在底部，我看到`{{uploader.files}}`的不是`[]`我最初看到的页面，而是它自己的页面。

我对 AngularJS 很陌生，所以我确定我只是错过了一些东西，或者做错了什么。我如何让这个指令起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T19:00:57.980

我发现了我的问题。我在我的模板 HTML 页面上包含了所有的 javascript 和 CSS。我尝试将它移动到主 HTML 文件，然后它工作了。换句话说，我搬家了

```
<style type="text/css">@import url(resources/scripts/plupload/jquery.plupload.queue/css/jquery.plupload.queue.css);</style>
<script type="text/javascript" src="resources/scripts/jquery-1.7.2.min.js"></script>

<script type="text/javascript" src="resources/scripts/plupload/plupload.full.js"></script>
<script type="text/javascript" src="resources/scripts/plupload/jquery.plupload.queue/jquery.plupload.queue.js"></script> 
```

从upload.html 文件到主要的index.html 文件。

当试图在脚本中调用一些 Plupload 东西时，javascript 正在死去，但还没有机会被包含在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-07T08:50:51.497

我们刚刚为 plUpload 创建了一个 Angular 指令。在这里检查。

[http://plupload-angular-directive.sahusoft.info/](http://plupload-angular-directive.sahusoft.info/)

# php - php应用程序类结构指南

> ID：11277339
> 
> 赞同：2
> 
> 时间：2012-06-30T20:16:01.527
> 
> 标签：php, class

我正在使用 MVC 架构开发一个 php 应用程序，我真的需要关于以下设计指南的建议：

根据php类结构最佳实践，它指出有人应该尽量减少模块依赖，我的应用程序类继承如下：

*   所有类都可以访问一些操作/方法
*   我所做的是我创建了一个 HelperClass，它将包含所有这些“全局”方法，如字符串操作、整数操作、数组操作，然后让其他想要使用这些方法的类扩展该类。

班级组织：

```
interface StringHelper{
 ...
}
interface ArrayHelper{
 ...
}

class GeneralHelper implements StringHelper, ArrayHelper{
 ......
}

class NewClass extends GeneralHelper{
 ...
}

// user factory style to create object
class NewClassFactory{
  public function create( $options ){
    return new NewClass( $options );  
  }
} 
```

该应用程序有大约 15 个类。

这种方法是否适合这种情况，或者在维护我的应用程序时我最终会遇到大问题？感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:30:17.740

在大多数情况下，帮助类应该始终是静态的，并且没有工作类应该扩展它。助手是全球性的，他们在工人阶级的主要范围内没有任何作用。将助手视为水管工、杂工等。如果你正在编写一个家庭类，它不应该扩展管道工，管道工应该在需要时进来，与家庭没有任何关系。

你需要的是这样的：

```
class NewClass {
 ...
$some_string = declaration

$some_string = StringHelper::sanitizeString($some_string);

} 
```

# c - “未定义的函数引用”错误

> ID：11277344
> 
> 赞同：9
> 
> 时间：2012-06-30T20:16:12.363
> 
> 标签：c, include, compiler-errors

我在使用标头编译一些文件时遇到了一些麻烦。这是我的代码的细分：

**文件1.c**

```
#include "header.h"
int main() {
    func1();
    return 0;
} 
```

**文件2.c**

```
#include "header.h"
void func1() {
    ... function implementation ...
} 
```

**头文件.h**

```
void func1(); 
```

我得到的错误是：

> 在函数中`'main'`：
> 未定义的引用`'func1'`

注意：我只是对我的 3 个文件的设置方式进行了简单分解。我需要让它与 3 个文件一起使用。我正在正确设置/包括所有内容？我需要使用这个设置，但我只是不确定 file.c 如何获取对`func1()`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T09:53:08.733

如果错误是对 的未定义引用`func1()`，*并且没有其他错误*，那么我认为这是因为您`header.h`在项目中调用了两个文件，并且包含另一个副本而不是声明为`func1()`.

我会检查您项目的包含路径，并确保首先包含`header.h`您的声明`func1()`。

# xcode - Xcode 4.2 上的 Clang 3.1（雪豹）

> ID：11277347
> 
> 赞同：3
> 
> 时间：2012-06-30T20:16:49.077
> 
> 标签：xcode, xcode4.2, osx-snow-leopard

是否可以在 xcode 4.2 (Snow Leopard) 上安装 clang 3.1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:21:26.557

You can also build and install it yourself.

[Instructions can be found here](http://llvm.org/svn/llvm-project/cfe/trunk/INSTALL.txt).

I'm not sure if this (or the MacPorts solution... +1 to @trojanfoe) will easily be callable from Xcode though. After moving everything from "`/Developer`" into & within the Xcode package, I'm thinking Apple is trying to keep Xcode a "walled garden" as well.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:20:13.937

Yes, try the [macports](https://trac.macports.org/browser/trunk/dports/lang/llvm-3.1/Portfile) version.

You can also [download the binaries](http://llvm.org/releases/download.html#3.1), if you can't be bothered to build it.

# javascript - Jquery：div 超链接

> ID：11277353
> 
> 赞同：1
> 
> 时间：2012-06-30T20:17:39.927
> 
> 标签：javascript, jquery, url, button, anchor

知道这里，我用 Jquery 和 CSS 制作了一个无文本的、被阻止的、可点击的 div。单击后，我想将一个新 URL 加载到浏览器中，从而将我的访问者从我的网站上转移到 stackoverflow.com。你能用 Jquery 做到这一点吗？如果有怎么办？

```
 #star{
    width:130px;
    height:40px;
    outline:1px solid orange;
    display:block;
    cursor:pointer;
    }

<div id="star">star</div>

<script>    
    $("#star").click(function(evt){
        $(this).html("http://www.stackoverflow.com");
    });
</script> 
```

第二个问题我必须让 div 透明或为空，以便显示菜单背景（没有切片。）。我可以或应该使用透明的 gif 来做到这一点吗？

顺便说一句：我如何修改本地 URL 的代码？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:19:11.630

The first part is relatively easy:

```
$("#star").click(function(evt){
    window.location = 'http://stackoverflow.com';
}); 
```

As for transparency, simply add the following to your CSS:

```
#star {
    /* other stuff */
    background-color: transparent;
} 
```

Or, if you don't necessarily need full cross-browser compatibility:

```
#star {
    /* other stuff */
    background-color: rgba(255,255,255,0.1);
} 
```

The above will make the element's `background-color` white, with an alpha transparency of `0.1` (`0` being fully transparent, `1` being fully opaque).

Note, I wasn't quite sure what you meant by 'local url,' but if you mean is it possible to use a relative path, for example to change:

```
'http://server.com/news/index.html' 
```

To:

```
'http://server.com/some/other/directory/index.html' 
```

without using an absolute path in the JavaScript, then the following should work:

```
$("#star").click(function(evt){
    window.location.pathname = '/somewhere_else/on/the/same/server';
}); 
```

# haskell - Haskell load external txt file into list

> ID：11277356
> 
> 赞同：6
> 
> 时间：2012-06-30T20:18:13.610
> 
> 标签：haskell

Hello the following code is a wordfeud program. It allows you to search through a list of words matching a prefix, suffix, and some letters. My question is, instead of using the list at the bottom, I want to use a external text file containing the words and load it into the list. How do I go about doing this?

```
count :: String -> String -> Int
count _[] = 0
count [] _ = 0
count (x:xs) square
    |x `elem` square = 1 + count xs (delete x square)
    |otherwise = count xs square

check :: String -> String -> String -> String -> Bool
check prefix suffix word square
    | (length strippedWord) == (count strippedWord square) = True
    | otherwise = False
    where
        strippedWord = drop (length prefix) (take ((length word ) - (length suffix)) word)

wordfeud :: String -> String -> String -> [String]
wordfeud a b c = test1
    where
    test =["horse","chair","chairman","bag","house","mouse","dirt","sport"]

    test1 = [x| x <- test, a `isPrefixOf` x, b `isSuffixOf` x, check a b x c] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:32:08.710

Very simple, with help of the `lines` function (or `words`, when words are seperated by some other form of whitespace than line breaks):

```
-- Loads words from a text file into a list.
getWords :: FilePath -> IO [String]
getWords path = do contents <- readFile path
                   return (lines contents) 
```

Furthermore, you'll probably have to read up on IO in Haskell (I recommend googling 'io haskell tutorial'), if you haven't done so already. You'll also need it to introduce interactivity into your program.

# ruby-on-rails - 如何显示两个模型的选择菜单？

> ID：11277357
> 
> 赞同：0
> 
> 时间：2012-06-30T20:18:18.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我使用的是[简单形式](https://github.com/plataformatec/simple_form)，但不会显示 2 个关联的值。

价格可以属于服务或产品，但不能同时属于两者。

```
Price
 # service_id, product_id
 belongs_to :services # service.name
 belongs_to :products # product.name
end 
```

相反，我的简单表格如下所示：

```
<%= f.association :product, :input_html => { :class => "span5 } %>
<%= f.association :service, :input_html => { :class => "span5 } %> 
```

我想把它变成一个领域。

有什么办法`simple_form_for`？

普通的`form_for`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T16:09:51.727

我认为更好的方法是使用多态关联。

```
class Price
    belongs_to :pricable, polymorphic: true
end

class Product
    has_one :price, as: :priceable
end

class Service
    has_one :price, as: :priceable
end 
```

然后，在您的表单中，您可以使用：

```
<%= form_for [@priceable, Price.new] 
```

其中@priceable 是产品或服务。

# simperium - SPManagedObject 创建“重复符号”错误

> ID：11277359
> 
> 赞同：1
> 
> 时间：2012-06-30T20:18:19.723
> 
> 标签：simperium

Simperium 给我以下错误：

```
ld: duplicate symbol [REDACTED]/Simperium.framework/Simperium(SPManagedObject.o) and [OTHER-REDACTED]/Build/Intermediates/MyApp.build/Debug-iphonesimulator/MyApp.build/Objects-normal/i386/SPManagedObject.o 
```

知道是什么导致了这个重复的符号错误吗？（我把 REDACTED 放在那里，所以它不是特定于我的应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:25:18.203

如果您不小心`SPManagedObject`在模型编辑器中为实体自动生成 .h 和 .m 文件，您将看到此错误。您应该只为您自己的实体自动生成文件，因为 Simperium.framework`SPManagedObject`为您提供了类。

# asp.net - 部署 ACCESS OleDb 驱动程序

> ID：11277361
> 
> 赞同：1
> 
> 时间：2012-06-30T20:18:34.293
> 
> 标签：asp.net, ms-access, database-connection

我尝试部署一个使用 MS ACCESS 2010 数据库的小型网站 (ASP.NET)。在服务器上部署网站我收到以下错误：

```
The 'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine. 
```

使用的连接字符串：`Provider=Microsoft.ACE.OLEDB.12.0; Data Source=path-to-db`

服务器上未安装 MS Office，Access 数据库引擎也未安装。该网站在共享托管环境中运行，因此我无法在该服务器上安装办公室，所以我可以通过 dll 以某种方式部署提供程序吗？

是否可以部署 ASP.Net 连接到数据库所需的驱动程序，而无需在服务器上运行安装。由于这是在共享主机环境中，我无法安装任何东西。仅通过 ftp 上传文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T06:37:29.673

打开 IIS，导航到应用程序池，找到您网站的 appPool，右键单击，高级设置，将“启用 32 位应用程序”设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:06:04.470

环顾四周，这与 Office 无关。如果只使用 Access 作为数据库，则不需要安装它。信息在这里：[http ://www.mytechsupport.ca/forums/index.php?topic=11237.0](http://www.mytechsupport.ca/forums/index.php?topic=11237.0)

我发现这个 StackOverflow 线程与您所做的错误相同，所以听起来可能是同一个问题。[Microsoft.ACE.OLEDB.12.0 提供程序未注册](https://stackoverflow.com/questions/238625/microsoft-ace-oledb-12-0-provider-is-not-registered)

如果它正在运行的窗口然后查看该线程并查看 64 位问题是否是问题所在。我以前也遇到过同样的问题，而且显然很常见。您可能需要向任何人发送电子邮件以获取服务器上的支持。

它运行Linux吗？如果它正在运行 linux，那么问题可能只是完全缺少连接到 Access 数据库的驱动程序。如果是这种情况，我会通过电子邮件向您的支持发送电子邮件，并询问他们是否可以为您安装正确的驱动程序。这里的信息：http: [//nixcraft.com/databases-servers/11878-connect-microsoft-access-database-php-linux-server.html](http://nixcraft.com/databases-servers/11878-connect-microsoft-access-database-php-linux-server.html)

# javascript - 使用 javascript 移动或存储文本

> ID：11277362
> 
> 赞同：0
> 
> 时间：2012-06-30T20:18:40.053
> 
> 标签：javascript, html

我试图在文本框之间移动文本，但失败了。这种方法有什么问题。

```
 <html>
<script>
function fill(){
document.getElementById("text2").value = document.test.text1.value 
}
</script>

<form name="test" id="test">
<input type="text" name="text1" id="text1"/>
<input type="text" name="text2" id="text2" value=""/>
<button name="b" onclick="fill()">move</button>
</form>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:27:49.567

一个原因是按钮正在提交表单。这需要被压制。此外，避免内联（又名 DOM 零）事件声明并更正式地绑定事件：

```
function fill(evt){
    document.getElementById("text2").value = document.test.text1.value;
    evt.preventDefault();
}
document.addEventListener('DOMContentLoaded', function() {
    document.querySelector('#test button').addEventListener('click', fill, false);
}, false); 
```

我在那里使用了一些现代方法，因此如果您需要支持较旧的 IE，您可能需要对其进行调整，但您明白了。

另请注意，如果填充函数仅用于此按钮而不用于其他位置，则无需像我在这里那样使用名称定义它并引用它，您可以直接在事件绑定中将其作为匿名函数引用。查找“匿名函数”以了解更多信息。

# redirect - What is the difference between redirect and navigation/forward and when to use what?

> ID：11277366
> 
> 赞同：34
> 
> 时间：2012-06-30T20:19:04.343
> 
> 标签：redirect, jsf-2, navigation, forward

What is difference between a navigation in JSF

```
FacesContext context = FacesContext.getCurrentInstance();
context.getApplication().getNavigationHandler().handleNavigation(context, null, url); 
```

and a redirect

```
HttpServletResponse response = (HttpServletResponse) FacesContext.getCurrentInstance().getExternalContext().getResponse();
response.sendRedirect(url); 
```

and how to decide when to use what?

The issue with navigation is that page URL does not change unless `faces-redirect=true` is added to the query string of the navigation URL. However, in my case appending `faces-redirect=true` throws error if I want to redirect to a non-JSF page like a plain HTML page.

And another option is as BalusC suggested at [JSF 2.0 redirect error](https://stackoverflow.com/questions/6526251/jsf-2-0-redirect-error)

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-06-30T20:36:21.183

首先，术语“重定向”在 Web 开发世界中是指向客户端发送一个空的 HTTP 响应，其中只有一个`Location`标头，其中包含客户端必须发送全新 GET 请求的新 URL。所以基本上：

*   客户端向`somepage.xhtml`.
*   服务器发回带有`Location: newpage.xhtml`标头的 HTTP 响应
*   客户端发送一个 HTTP 请求`newpage.xhtml`（这会反映在浏览器地址栏中！）
*   服务器发回 HTTP 响应，内容为`newpage.xhtml`.

您可以使用网络浏览器的内置/插件开发工具集对其进行跟踪。在 Chrome/IE9/Firebug 中按 F12 并检查“网络”部分以查看它。

JSF 导航处理程序不发送重定向。相反，它使用目标页面的内容作为 HTTP 响应。

*   客户端向`somepage.xhtml`.
*   服务器发回 HTTP 响应，内容为`newpage.xhtml`.

但是由于原始 HTTP 请求是 to `somepage.xhtml`，所以浏览器地址栏中的 URL 保持不变。如果您熟悉[基本的 Servlet API](https://stackoverflow.com/tags/servlets/info)，那么您应该明白这与[`RequestDispatcher#forward()`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29).

* * *

`HttpServletResponse`至于从 JSF 引擎盖下拉出并调用`sendRedirect()`它是否正确使用；不，这不是正确的用法。你的服务器日志会被`IllegalStateException`s 弄得乱七八糟，因为这样你就不会告诉 JSF 你已经接管了响应处理的控制权，因此 JSF 不应该做它的默认响应处理工作。您实际上应该在[`FacesContext#responseComplete()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/FacesContext.html#responseComplete%28%29)之后执行。

此外，每当您需要从`javax.servlet.*`JSF 工件（如托管 bean）中的包中导入某些内容时，您绝对应该停止编写代码并三思而后行，如果您真的以正确的方式做事，并问自己是否还没有“标准 JSF 方式”，无论您试图实现什么和/或该任务是否真的属于 JSF 托管 bean（即在某些情况下，一个简单的[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)会是一个更好的地方）。

在 JSF 中执行重定向的正确方法是`faces-redirect=true`在操作结果中使用查询字符串：

```
public String submit() {
    // ...
    return "/newpage.xhtml?faces-redirect=true";
} 
```

或者[`ExternalContext#redirect()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#redirect%28java.lang.String%29)当您不在诸如 ajax 或 prerender 侦听器方法之类的操作方法中时使用：

```
public void listener() throws IOException {
    // ...
    ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();
    ec.redirect(ec.getRequestContextPath() + "/newpage.xhtml");
} 
```

*（是的，你不需要`try-catch`在它周围加上a `IOException`，只要让异常通过`throws`，servletcontainer就会处理它）*

或者[`NavigationHandler#handleNavigation()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/NavigationHandler.html#handleNavigation%28javax.faces.context.FacesContext,%20java.lang.String,%20java.lang.String%29)，如果您使用 XML 导航案例和/或带有一些内置侦听器的自定义导航处理程序，则在特定情况下使用：

```
public void listener() {
    // ...
    FacesContext fc = FacesContext.getCurrentInstance();
    NavigationHandler nh = fc.getApplication().getNavigationHandler();
    nh.handleNavigation(fc, null, "/newpage.xhtml?faces-redirect=true");
} 
```

至于为什么导航处理程序对“纯 HTML”文件失败，这仅仅是因为导航处理程序只能处理 JSF 视图，不能处理其他文件。那时你应该使用`ExternalContext#redirect()`。

### 也可以看看：

*   [如何在 JSF 中导航？如何使 URL 反映当前页面（而不是上一个页面）](https://stackoverflow.com/questions/15521451/how-to-make-url-reflect-the-current-page-and-not-the-previous-one/15523045#15523045)
*   [什么时候应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink/4317723#4317723)

# r - Bivariate K function (splancs package) - Kenv.tor returning "Inf" in $upper

> ID：11277369
> 
> 赞同：1
> 
> 时间：2012-06-30T20:19:12.073
> 
> 标签：r

I am using splancs package to compute bivariate (cross) k function and running into problems with the simulation where the Kenv.tor$upper will contain "Inf" as values. Does anyone know if this is a true effect of the data or whether the function itself is having a problem with the data?

I have Kenv.tor structured such that

Kenv.tor(X1, X2, Polygon, 30, s)

where X1 contains 25302 points, X2 contains 432 points, and s = seq(20, 2640, 100).

Just looking for any insight as to why the upper limits would be so high and if there is anything I can do to make the function work with my data. Thank you for any help!

# c# - Popup and a mouse out fading window

> ID：11277372
> 
> 赞同：0
> 
> 时间：2012-06-30T20:19:23.737
> 
> 标签：c#, wpf, popup, fadeout

I have a window that fades out when the mouse is out of the Window. I have created a popup that shows (inside of the window boundaries) when I click a button. But - when I mouse over the popup - my window fades out? What can i do so the window won't fade out when I am on the popup?

Fade out code void gridFadeOutStoryBoard_Completed(object sender, EventArgs e) { CloseWindow(); }

```
 private void MainWindow_MouseLeave(object sender, MouseEventArgs e)
    {
        if (this.ResizeMode == System.Windows.ResizeMode.NoResize) // make sure fade out animation won't work when the window is fullscreen
        {
            if (!this.giveFirstTimeMouseLeave)
            {
                // Only start fading out if fully faded in, otherwise you get a flicker effect in the UX because the animation resets the opacity
                if (this.Opacity == 1)
                    gridFadeOutStoryBoard.Begin();
            }
        }
    } 
```

Fade out xaml code:

```
<Storyboard x:Key="gridFadeOutStoryBoard">
        <DoubleAnimation Storyboard.TargetName="MyWin" BeginTime="0:0:0.5"
            Storyboard.TargetProperty="Opacity" From="1.00" To="0.75" AutoReverse="False" Duration="0:0:0.3" />
    </Storyboard> 
```

Popup xaml code:

```
<Popup Name="FilterPopup" Width="200" Height="150" HorizontalAlignment="Left" Margin="0,36,0,0" IsEnabled="True" IsOpen="False">
            <Border BorderBrush="White" BorderThickness="3">
                <StackPanel Background="#FF333333" VerticalAlignment="Center" Height="200">
                    <StackPanel>
                        <Grid Margin="0,40,0,20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height=" 30"></RowDefinition>
                                <RowDefinition Height="30"></RowDefinition>
                                <RowDefinition Height="30"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"></ColumnDefinition>
                                <ColumnDefinition Width="100"></ColumnDefinition>
                                <ColumnDefinition Width="100"></ColumnDefinition>
                            </Grid.ColumnDefinitions>

                            <Label Name="lblPasswordReprint" Content="Password:" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBox Name="txtPasswordReprint" Width=" 90" Height="20" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" IsEnabled="True"/>

                            <Label Name="lblUserName" Content=" UserName:" HorizontalAlignment="Right" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" />
                            <TextBox Name="txtUserNameReprint" Width=" 90" Height=" 20" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Left"/>

                            <Button Content="Reset" Width="70" Height="30" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Right" />
                            <Button Content="Save" Width="70" Height="30" Grid.Row="2" Grid.Column="1" HorizontalAlignment="Left" />
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Popup> 
```

Thanks in advanced, Din..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:22:38.940

在您的内部，您`MainWindow_MouseLeave`可以添加对 FilterPopup.IsMouseOver 的额外检查 - 然后跳过动画是真的

# ruby-on-rails - Rspec：当我预计失败时，nil.should_not be_nil 通过。为什么？

> ID：11277376
> 
> 赞同：4
> 
> 时间：2012-06-30T20:19:35.507
> 
> 标签：ruby-on-rails, unit-testing, rspec

在 Rails 项目中做一些 rspec 工作。有点好奇为什么这些 should_not be_nil 期望会通过。有什么想法吗？

```
it "nils should be nil" do
  @io = nil
  @io.should_not be_nil #passes (shouldn't!!)
  nil.should_not be_nil #passes (shouldn't!!)
  @io.should == nil # passes
  @io.should be_nil # passes
  @io.nil?.should be_true # passes
  #@io.nil?.should be_false # fails as expected
end 
```

**更新：**根据这里的反馈，我已经能够隔离出这个的原因（这是来自加载的东西`spec_helper`）。我相信这是由于混搭不当造成的，`.nil?` 或者`.blank?`我将与开发人员交谈，看看这些覆盖是否真的有必要。

感谢那些帮助验证我的东西的人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:41:21.133

我无法复制你的陈述。我在这样的现有项目中以假规范编写它们。

```
require 'spec_helper'

describe "Pepper" do
  describe "simplicity" do
  before(:each) { @io = nil }
  # should fail
  it 'should be nil 1' do
    @io.should_not be_nil 
  end
  # should fail
      it 'should be nil 2' do
    nil.should_not be_nil 
  end
  # should NOT fail
  it 'should be nil 3' do
    @io.should == nil
  end
  # should NOT fail
  it 'should be nil 4' do   
    @io.should be_nil
  end
  # should NOT fail
  it 'should be nil 5' do
    @io.nil?.should be_true # passes
  end
  # should fail
  it 'should be nil 6' do
    @io.nil?.should be_false 
  end
  end
end 
```

它返回 - 正如预期的那样 - 以下输出：

```
simplicity
should be nil 1 (FAILED - 1)
should be nil 2 (FAILED - 2)
should be nil 3
should be nil 4
should be nil 5
should be nil 6 (FAILED - 3) 
```

所以也许你的 spec_helper 暗示了一些东西，那就是刺激你的规范。

# django - Error when add admin.py to the django app

> ID：11277377
> 
> 赞同：1
> 
> 时间：2012-06-30T20:19:38.010
> 
> 标签：django, django-admin

I haven't dealt with Django for some time and now when I returned to it, django 1.4 was released. I think my issue related to new release because earlier I haven't had such problem.

I have created project with myapp and also added easy-news app and everything worked fine, including admin site. But when I decided to add another app which needed admin.py. I've got an issue. When I add admin.py to my project I receive an error:

```
AttributeError at /admin/

'module' object has no attribute 'site' 
```

for this string:

```
(r'^admin/', include(admin.site.urls)), 
```

I have spent half a day trying to solve it but I don't understand where it comes from. Any suggestions? Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:36:30.767

您是否包含`admin.autodiscover()`在项目的 urlconf 中？

这个：

```
(r'^admin/', include(admin.site.urls)), 
```

也必须在项目的 urlconf 中，而不是在应用程序中。

希望这可以帮助 ：）

# python - Parsing HTML into sentences - how to handle tables/lists/headings/etc?

> ID：11277379
> 
> 赞同：7
> 
> 时间：2012-06-30T20:20:04.620
> 
> 标签：python, html, nlp, nltk, text-segmentation

How do you go about parsing an HTML page with free text, lists, tables, headings, etc., into sentences?

Take [this wikipedia page](http://en.wikipedia.org/wiki/Neurotransmitter) for example. There is/are:

*   free text: [http://en.wikipedia.org/wiki/Neurotransmitter#Discovery](http://en.wikipedia.org/wiki/Neurotransmitter#Discovery)
*   lists: [http://en.wikipedia.org/wiki/Neurotransmitter#Actions](http://en.wikipedia.org/wiki/Neurotransmitter#Actions)
*   tables: [http://en.wikipedia.org/wiki/Neurotransmitter#Common_neurotransmitters](http://en.wikipedia.org/wiki/Neurotransmitter#Common_neurotransmitters)

After messing around with the python [NLTK](http://nltk.org/), I want to test out all of these different corpus annotation methods (from [http://nltk.googlecode.com/svn/trunk/doc/book/ch11.html#deciding-which-layers-of-annotation-to-include](http://nltk.googlecode.com/svn/trunk/doc/book/ch11.html#deciding-which-layers-of-annotation-to-include)):

*   **Word Tokenization**: The orthographic form of text does not unambiguously identify its tokens. A tokenized and normalized version, in addition to the conventional orthographic version, may be a very convenient resource.
*   **Sentence Segmentation**: As we saw in Chapter 3, sentence segmentation can be more difficult than it seems. Some corpora therefore use explicit annotations to mark sentence segmentation.
*   **Paragraph Segmentation**: Paragraphs and other structural elements (headings, chapters, etc.) may be explicitly annotated.
*   **Part of Speech**: The syntactic category of each word in a document.
*   **Syntactic Structure**: A tree structure showing the constituent structure of a sentence.
*   **Shallow Semantics**: Named entity and coreference annotations, semantic role labels.
*   **Dialogue and Discourse**: dialogue act tags, rhetorical structure

Once you break a document into sentences it seems pretty straightforward. But how do you go about breaking down something like the HTML from that Wikipedia page? I am very familiar with using HTML/XML parsers and traversing the tree, and I have tried just stripping the HTML tags to get the plain text, but because punctuation is missing after HTML is removed, NLTK doesn't parse things like table cells, or even lists, correctly.

Is there some best-practice or strategy for parsing that stuff with NLP? Or do you just have to manually write a parser specific to that individual page?

Just looking for some pointers in the right direction, really want to try this NLTK out!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T16:33:01.143

听起来您正在剥离所有 HTML 并生成一个平面文档，这会使解析器感到困惑，因为松散的部分粘在一起。由于您熟悉 XML，因此我建议将您的输入映射到一个简单的 XML 结构，以使各个部分保持分离。你可以让它变得尽可能简单，但也许你会想要保留一些信息。例如，标记标题、章节标题等可能很有用。当您拥有一个可将各个块分开的可用 XML 树时，可以将`XMLCorpusReader`其导入到 NLTK 世界中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-06T23:44:28.933

我必须编写特定于我正在分析的 XML 文档的规则。

我所做的是将html标签映射到段。此映射基于研究多个文档/页面并确定 html 标记所代表的内容。前任。<h1> 是一个词组；<li> 是段落；<td> 是标记

如果要使用 XML，可以将新映射表示为标记。前任。<h1> 到 <短语>；<li> 到 <paragraph>；<td> 到 <令牌>

如果您想处理纯文本，您可以将映射表示为一组字符（例如 [PHRASESTART][PHRASEEND]），就像 POS 或 EOS 标记一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-01T17:37:05.447

正如[亚历克西斯](https://stackoverflow.com/users/699305/alexis)回答的那样，[python-goose](https://github.com/grangier/python-goose)可能是一个不错的选择。

还有[HTML Sentence Tokenizer](https://github.com/wardbradt/HTMLST)，一个（新的）库，旨在解决这个确切的问题。它的语法非常简单。在一行中`parsed_sentences = HTMLSentenceTokenizer().feed(example_html_one)`，您可以获取存储在数组中的 HTML 页面中的句子`parsed_sentences`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-10T20:38:56.107

您可以使用诸如[python-goose 之](https://github.com/grangier/python-goose)类的工具，该工具旨在从 html 页面中提取文章。

否则，我制作了以下小程序，效果很好：

```
from html5lib import parse

with open('page.html') as f:
    doc = parse(f.read(), treebuilder='lxml', namespaceHTMLElements=False)

html = doc.getroot()
body = html.xpath('//body')[0]

def sanitize(element):
    """Retrieve all the text contained in an element as a single line of
    text. This must be executed only on blocks that have only inlines
    as children
    """
    # join all the strings and remove \n
    out = ' '.join(element.itertext()).replace('\n', ' ')
    # replace multiple space with a single space
    out = ' '.join(out.split())
    return out

def parse(element):
    # those elements can contain other block inside them
    if element.tag in ['div', 'li', 'a', 'body', 'ul']:
        if element.text is None or element.text.isspace():
            for child in element.getchildren():
                yield from parse(child)
        else:
            yield sanitize(element)
    # those elements are "guaranteed" to contains only inlines
    elif element.tag in ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6']:
        yield sanitize(element)
    else:
        try:
            print('> ignored', element.tag)
        except:
            pass

for e in filter(lambda x: len(x) > 80, parse(body)):
    print(e) 
```

# c# - 从 HTML 节点读取值

> ID：11277380
> 
> 赞同：5
> 
> 时间：2012-06-30T20:20:06.053
> 
> 标签：c#, html, html-parsing

我是 XML/HTML 解析的新手。甚至不知道正确搜索重复项的正确词。

我有这个看起来像这样的 HTML 文件：

```
<body id="s1" style="s1">
    <div xml:lang="uk">
        <p begin="00:00:00" end="00:00:29">
          <span fontFamily="SchoolHouse Cursive B" fontSize="18">I'm great!</span>
        </p> 
```

现在我需要`00:00:00`，`00:00:29`并`I'm great!`从中。我可以这样读：

```
XmlTextReader reader = new XmlTextReader(file);
while (reader.Read())
{
    if (reader.NodeType != XmlNodeType.Element)
        continue;

    if (reader.LocalName != "p")
        continue;

    var a = reader.GetAttribute(0);
    var b = reader.GetAttribute(1);

    if (reader.LocalName == "span")
    {
        XmlDocument doc = new XmlDocument();
        doc.Load(reader);
        XmlNode elem = doc.DocumentElement.FirstChild;
        var c = elem.InnerText;
    }
 } 
```

我得到变量中的值`a`，`b`和`c`。但 HTML 格式略有变化。**现在 HTML 看起来像这样：**

```
<body id="s1" style="s1">
  <div xml:lang="uk">
      <p begin="00:00:00" end="00:00:29">I'm great! </p> 
```

在这种情况下，我该如何解析`00:00:00`，`00:00:29`以及`I'm great!`？我试过这个：

```
XmlTextReader reader = new XmlTextReader(file);
while (reader.Read())
{
    if (reader.NodeType != XmlNodeType.Element)
        continue;

    if (reader.LocalName != "p")
        continue;

    var a = reader.GetAttribute(0);
    var b = reader.GetAttribute(1);

    XmlDocument doc = new XmlDocument();
    doc.Load(reader);
    XmlNode elem = doc.DocumentElement.FirstChild;
    var c = elem.InnerText;
} 
```

但我得到这个错误：`This document already has a 'DocumentElement' node.`在 line `doc.Load(reader)`。如何正确阅读以及造成问题的原因是什么？我正在使用 .NET 2.0

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T20:29:23.947

看起来您有想要使用 XML 解析器解析的 HTML。这也可能是您得到`This document already has a 'DocumentElement' node.`异常的原因：因为您有多个根节点，这在 HTML 中是允许的（或者更好的是：容忍），但在 XML 中是不允许的。

请改用 HTML 解析器。不幸的是，.NET 框架中没有内置任何内容。您必须为此使用第三方库。一个很好的是[HTML 敏捷包](http://html-agility-pack.net/?z=codeplex)，oleksii 在他的评论中已经提到过。

**编辑：**

从您的评论中，我感觉到您不熟悉 HTML 和 XML 之间没有直接关系的事实。取自[这里](http://www.jbi.hio.no/bibin/dill/summer_school/2009/xml-wellformed.html)的图形很好地说明了这一点：

![SGML、HTML 和 XML 之间的关系](../Images/ccd5121f467790835a7ca5ff2ba421b6.png)

XML 也不是 HTML 的子集，反之亦然。只有当您有严格的 XHTML（很少出现这种情况）时，您才有可以用 XML 解析器解析的 HTML 文档。但请注意，如果此类 XHTML 文档的代码出现错误，解析器将失败，而普通浏览器将继续显示该页面。此外，XHTML 的未来还很不明朗，现在 HTML5 正在缓慢而稳定地出现......

*总结一下：*为了避免所有这些陷阱，走简单的路，选择 HTML 解析器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T05:26:24.383

由于您要解析 HTML，您可以使用`WebClient`(或`WebBrowser`) 加载页面，然后使用 HTML DOM 浏览它。您需要`Microsoft HTML Object Library`为以下代码示例添加对 (COM) 的引用：

```
 string html;
  WebClient webClient = new WebClient();
  using (Stream stream = webClient.OpenRead(new Uri("http://www.google.com")))
  using (StreamReader reader = new StreamReader(stream))
  {
    html = reader.ReadToEnd();
  }
  IHTMLDocument2 doc = (IHTMLDocument2)new HTMLDocument();
  doc.write(html);
  foreach (IHTMLElement el in doc.all)
    Console.WriteLine(el.tagName); 
```

我之前曾尝试将 HTML 加载到 XML 中，但它太难了——修复未封闭的标签（如 <BR>）、在属性周围加上引号、为没有值的属性赋予值等。因为我想随后使用 XSLT 来对付它，在加载到 HTML DOM 并在其中导航后，为每个 HTML 节点创建相关的 XML 节点。然后我有了 HTML 的正确 XML 表示。

# javascript - 在模块之间传递对象引用

> ID：11277383
> 
> 赞同：0
> 
> 时间：2012-06-30T20:20:14.560
> 
> 标签：javascript

我对javascript相当陌生，并试图学习一些最佳实践。我不清楚为什么我无法访问以下代码中的 ctx 引用。日志从 myApp.init() 输出 context2d 引用。我不能在 myApp 模块的 return 语句中公开私有对象变量吗？我以为我开始了解这种语言的基础知识，但对这个看似简单的概念感到沮丧。谢谢你的帮助。

```
window.onload = function () {
    myApp.init();
    console.log(myApp.ctx);        // logs undefined
};

var myApp = (function () {    

    var canvas,
        ctx,
        init = function () {
            canvas = document.getElementById("canvas");
            ctx = canvas.getContext('2d');
            console.log(ctx);        // logs valid context2d object
        };

    return {
        init : init,
        ctx  : ctx
    };

}());

myApp.board = (function () {

    var ctx = myApp.ctx;

    return {
        ctx : function () { console.log(ctx); }   // logs undefined
    };

}()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:38:49.060

你需要调用`init()`被`ctx`定义。然而，到那时，为时已晚，因为 myApp 包含 ctx 的原始值。

你有完全相同的问题`var ctx = myApp.ctx;`。在定义时获取 ctx 的值`board`。如果改变它不会改变`myApp.ctx`。

* * *

这应该有效：

```
var myApp = new function () {
    var canvas;

    this.init = function () {
        canvas = document.getElementById("canvas");
        this.ctx = canvas.getContext('2d');
        console.log(this.ctx);        // logs valid context2d object
    };
};

myApp.board = new function () {
    this.ctx = function () { console.log(myApp.ctx); }
}; 
```

By using the `new` keyword, the functions become constructors (and are invoked immediately) - `this` refers to the object being created.

# elasticsearch - 针对多个字段的文本查询

> ID：11277385
> 
> 赞同：0
> 
> 时间：2012-06-30T20:20:19.587
> 
> 标签：elasticsearch

如何`text_phrase`对多个字段使用查询？

我的案例：
用户类型`hello world`。它的标题或内容（或两者）字段包含`hello (cool) world`-> 返回此文档

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:21:07.083

您可以使用`boost`查询来执行此操作。您可能希望使用更高级的`text`查询形式来提升标题（有时，禁用标题文档的规范也是有意义的，这会使字段的长度影响评分）。这是一个完整的示例：

```
curl -XPUT localhost:9200/test -d '{
    "index.number_of_shards" : 1,
    "index.number_of_replicas" : 0
}'

curl -XPUT localhost:9200/test/type/1 -d '{
    "title" : "hello (cool) world",
    "content" : "hello (cool) world"
}'

curl -XPUT localhost:9200/test/type/2 -d '{
    "title" : "hello (cool) world",
    "content" : "xxx"
}'

curl -XPUT localhost:9200/test/type/3 -d '{
    "title" : "yyy",
    "content" : "hello (cool) world"
}'

curl -XPOST localhost:9200/test/_refresh

curl -XGET localhost:9200/test/_search?pretty -d '{
    "query" : {
        "bool" : {
            "should" : [
                {
                    "text" : {"content" : {"query" : "hello world"}}
                },
                {
                    "text" : {"title" : {"query" : "hello world", "boost" : 5}}
                }
            ]
        }
    }
}' 
```

# javascript - 播放视频时如何隐藏标题？

> ID：11277391
> 
> 赞同：0
> 
> 时间：2012-06-30T20:20:52.287
> 
> 标签：javascript, html, css, video, vimeo

我已将我自己的自定义标题绝对放置在 Vimeo 视频嵌入的顶部（您可以在此处查看开发网站[http://ourcityourstory.com/dev/](http://ourcityourstory.com/dev/)）。当我单击 Vimeo 视频时，我希望标题绝对位于其上方以隐藏。

我该如何做到这一点？我写的 JS 都没有工作。

这是我的非工作代码：

```
$(document).click({namespace: this}, function (e) {
    var t = e.data.namespace;

    if ($(e.target).parents("#video-slider-wrapper iframe").length > 0 || $(e.target).is($("#video-slider-wrapper iframe"))) {
        $("#episode h1").hide();
    }
}); 
```

**更新**：下面列出的 pimvdb 示例正是我需要我的页面执行的操作 - 但是，我在我的页面上不断收到错误“$f is not defined”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:47:41.023

您的`click`处理程序不起作用，因为 iframe 是跨域的。但是，您可以在触发事件时使用[专用的 Vimeo API](http://a.vimeocdn.com/js/froogaloop2.min.js)添加侦听器：`play`

```
var player = $f( $('#player1').get(0) );

player.addEvent('play', function() {
  $("h1").hide();
}); 
```

​</p>

# c# - c# Get Calling Method Without Stack Trace

> ID：11277392
> 
> 赞同：5
> 
> 时间：2012-06-30T20:21:00.477
> 
> 标签：c#, .net

I've noticed that .NET 4.5 has a new attribute called **[CallerMemberNameAttribute]** which, when attached to a parameter of a method, will supply the string name of the method that called *that* method (if that makes sense).

However, unfortunately (because I want to make something with XNA) I'm only targeting .NET 4.0\.

I want to be able to do something like:

```
void MethodA() {
   MethodB();
}

void MethodB() {
   string callingMethodName = (...?);
   Console.WriteLine(callingMethodName);
} 
```

Where my output would be *MethodA*.

I know I could do this via stack trace, but that's a) Unreliable and b) Sloooow... So I'm wondering if there's any other way to glean that information, however that may be...

I was hoping for any ideas or knowledge that anyone might have on the issue. Thanks in advance :)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-30T20:24:28.380

如果您使用 Visual Studio 2012 编译它，您可以编写自己的代码`CallerMemberNameAttribute`并以与 .NET 4.5 相同的方式使用它，即使您仍然以 .NET 4.0 或 3.5 为目标。编译器仍将在编译时执行替换，即使针对较旧的框架版本。

只需将以下内容添加到您的项目中即可：

```
namespace System.Runtime.CompilerServices
{
    public sealed class CallerMemberNameAttribute : Attribute { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:52:05.527

您可以提供调用方名称作为被调用方法的参数。不完全符合您的要求，但它无需访问堆栈框架即可工作：

```
[MethodImpl(MethodImplOptions.NoInlining)]
void MethodA() 
{
    string methodName = System.Reflection.MethodBase.GetCurrentMethod().Name;
    MethodB(methodName);
}

void MethodB(string callingMethodName) 
{
    Console.WriteLine(callingMethodName);
} 
```

通过使用`MethodBase.GetCurrentMethod()`，您可以确保您的实现保持重构安全——如果您的方法名称更改，结果仍然是正确的。

不要忘记标记您的调用方法，`MethodImplOptions.NoInlining`以避免方法内联。

# linux - Shell program - determine average word length in a file

> ID：11277396
> 
> 赞同：4
> 
> 时间：2012-06-30T20:21:21.370
> 
> 标签：linux, shell

I am trying to write a shell program to determine the average word length in a file. I'm assuming I need to use `wc` and `expr` somehow. Guidance in the right direction would be great!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T20:30:07.987

假设您的文件是 ASCII 并且`wc`确实可以读取它...

```
chars=$(cat inputfile | wc -c)
words=$(cat inputfile | wc -w) 
```

然后一个简单的

```
avg_word_size=$(( ${chars} / ${words} )) 
```

将计算一个（四舍五入的）整数。但这将比舍入错误“更错误”：您还将在平均字长中包含所有空白字符。我假设你想要更精确......

以下将通过从乘以 100 的数字计算舍入整数来提高精度：

```
_100x_avg_word_size=$(( $((${chars} * 100)) / ${words} )) 
```

现在我们可以用它来告诉世界：

```
 echo "Avarage word size is: ${avg_word_size}.${_100x_avg_word_size: -2:2}" 
```

为了进一步细化，我们可以假设只有 1 个空格字符分隔单词：

```
 chars=$(cat inputfile | wc -c)
 words=$(cat inputfile | wc -w)

 avg_word_size=$(( $(( ${chars} - $(( ${words} - 1 )) )) / ${words} ))
 _100x_avg_word_size=$(( $((${chars} * 100)) / ${words} ))

 echo "Avarage word size is: ${avg_word_size}.${_100x_avg_word_size: -2:2}" 
```

现在，您的工作是尝试将“线”的概念纳入您的计算中...... :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:50:53.127

`wc`更新：清楚地（希望）显示和这种方法之间的区别；并修复了“太多换行”的错误；还增加了对单词结尾撇号的更精细控制。

如果您想将 a`word`视为 a `bash word`，那么单独使用`wc`就可以了。
但是，如果您想将`word`口语/书面语言中的单词视为单词，则不能`wc`用于单词解析。

例如..`wc`认为以下内容包含**1 个**单词（平均大小 = 112.00），而下面
的脚本显示它包含**19 个**单词（大小平均 = 4.58）

```
"/home/axiom/zap_notes/apps/eng-hin-devnag-itrans/Platt's_Urdu_and_classical_Hindi_to_English_-_preface5.doc't" 
```

使用*Kurt 的*脚本，以下行显示包含**7 个**单词（大小平均 = 8.14），
而下面显示的脚本显示它包含**7 个**单词（大小平均 = 4.43）... `बे`= 2 个字符

```
"बे  = {Platts} ... —be-ḵẖẉabī, s.f. Sleeplessness:" 
```

所以，如果`wc`是你的口味，好，如果不是，这样的东西可能适合：

```
# Cater for special situation words: eg 's and 't   
# Convert each group of anything which isn't a "character" (including '_') into a newline.  
# Then, convert each CHARACTER which isn't a newline into a BYTE (not character!).  
# This leaves one 'word' per line, each 'word' being made up of the same BYTE ('x').  
# 
# Without any options, wc prints  newline, word, and byte counts (in that order),
#  so we can capture all 3 values in a bash array
#  
# Use `awk` as a floating point calculator (bash can only do integer arithmetic)

count=($(sed "s/\>'s\([[:punct:]]\|$\)/\1/g      # ignore apostrophe-s ('s) word endings 
              s/'t\>/xt/g      # consider words ending in apostrophe-t ('t) as base word + 2 characters   
              s/[_[:digit:][:blank:][:punct:][:cntrl:]]\+/\n/g 
              s/^\n*//; s/\n*$//; s/[^\n]/x/g" "$file" | wc))
echo "chars / word average:" \
      $(awk -vnl=${count[0]} -vch=${count[2]} 'BEGIN{ printf( "%.2f\n", (ch-nl)/nl ) }') 
```

# c - 二维 C 数组

> ID：11277400
> 
> 赞同：2
> 
> 时间：2012-06-30T20:21:40.753
> 
> 标签：c, arrays, multidimensional-array

我正在制作一个连续四个应用程序，或者至少是一个计算最佳动作和东西的类。游戏板的高度为 6，宽度为 7。我不确定是否应该将实例变量命名`gamePosition[6][7]`为`gamePosition[7][6]`. 我知道我会使用哪一个并不重要，但是一个比另一个更常见吗？我想立即以正确的方式做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:19:55.650

AC 二维数组只是一个数组的数组。

为了清楚起见，添加一些常量：

```
#define ROWS 6
#define COLUMNS 7 
```

如果您希望能够将一行视为单个对象，请使用：

```
someType gamePosition[ROWS][COLUMNS]; 
```

`gamePosition[0]`表示第一（第零）行的一维数组也是如此。

如果您希望能够将*列*视为单个对象，请使用：

```
someType gamePosition[COLUMNS][ROWS]; 
```

如果你只关心单个元素，你可以用任何一种方式定义它（当然你必须保持一致）。将板视为行数组而不是列数组可能更直观一些，但两者都可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:26:47.643

宽度 - 第一个方括号。高度 - 第二个方括号。

您将选择哪个选项并不重要。您的代码应该是易于理解和直观的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T21:26:27.933

这完全取决于你。这里没有“更常见”或“正确”的方式。

*   如果您更愿意将游戏板视为笛卡尔坐标平面，那么`[column][row]`格式会更好，因为已建立的数学实践是先指定横坐标，然后指定纵坐标。

*   如果您更愿意将其视为矩阵，那么它会反过来，因为在索引矩阵时已建立的数学实践是将行索引放在第一位，然后将列索引放在第二位。

PS当然，该问题的唯一真正的解决方案是编写代码，以便以后您可以通过在代码的一个位置进行一次本地修改来在这两种方法之间切换:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T21:28:22.063

语义无关紧要，但对性能有一些提示：当您要遍历板上的单元格时，首先增加第二个索引，然后再增加第一个索引。那是：

```
for (i = 0; i < FIRST_SIZE; ++i)
  for (j  = 0; j < SECOND_SIZE; ++j)
    ... process gamePosition[i][j] ... 
```

由于缓存局部性，您将在性能上获胜。

因此，也许您应该根据您的算法计划首先使用哪个索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-01T04:46:36.763

正如之前的一些帖子，这并不重要，但它真的很重要。

**首先**。从逻辑上讲，它不会影响您的代码，您可以随意选择一个。但是在正常思维中，您经常写作`gamePosition[6][7]`，因为您经常从上到下，从左到右思考；）

**其次**，我认为你需要这个。这取决于你如何使用这个数组。我会解释 ：

二维数组只是数组的数组。而且，因为性能，如果您浏览数组中的所有值，通常逐行更有效。例如：你有`a[n][m]`.

你应该：（逐行）

```
for(int i=0; i<n; i++)
    for(int j=0; j<m; j++)
        // do some stuff 
```

而不是 : （逐列），因为你会失去性能

```
for(int i=0; i<m; i++)
    for(int j=0;j<n; j++)
        // do some stuff 
```

所以。你可以在你的游戏中思考，你可以思考你如何使用你的数组：如果你更频繁地从上到下使用（俄罗斯方块游戏 - 是我算法的一个例子），你应该使用`gamePosition[7][6]`

否则，您更频繁地逐行浏览数组（在大多数情况下），应该使用`gamePosition[6][7]`

很少有人知道这一点。希望这有帮助；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-30T20:26:39.727

人们期望高 x 宽度和行 x 列，所以你应该使用：

```
gamePosition[6][7] 
```

实际上我认为这很重要。您应该使用两种可能性中最直观的一种，以免使读者感到困惑。

# javascript - 节点为数组中的空值分配多少内存

> ID：11277402
> 
> 赞同：11
> 
> 时间：2012-06-30T20:22:22.160
> 
> 标签：javascript, arrays, node.js, memory, null

跟进这个线程：

[数组中的大量空值意味着任何伤害？](https://stackoverflow.com/questions/4374627/lots-of-null-values-in-an-array-mean-any-harm)

我用 node.js 做到了这一点：

```
arr=[]
arr[1000]=1
arr[1000000000]=2
arr.sort() 
```

我得到了

```
FATAL ERROR: JS Allocation failed - process out of memory 
```

所以这给我留下了一个问题（我在 Yahoogle 上找不到）实际上为节点中的数组中的空条目分配了多少内存。我不打算使用 1000000000 个条目，甚至不接近，但也许仍然不值得分配内存......

谁知道我怎么查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T12:40:27.423

所以总而言之，**node.js 不会为数组中未定义的值分配内存。**我经历的崩溃一定是一个小故障，因为没有其他人可以重现它，安装最新的 node.js 版本也为我解决了这个问题。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-30T20:28:37.023

编辑：抱歉不准确，可能不适用于 JAVA ..
仍然可能对在其他应用程序中需要它的人有所帮助。

一个引用数组正在分配 x

因此分配 arr[100000] 将分配 100 kb x 4b ~= 0.5Mb（近似值）

是的，当然，如果你不打算使用所有的数组，
你应该考虑一个 HashMap，它是一种数据结构。HashMap
最适合具有相对少量项目的大搜索范围。

无论哪种方式，都有分配一个小数组的解决方案，并在需要时根据需要扩展它。

# iphone - 单击表格单元格时的阴影背景

> ID：11277404
> 
> 赞同：1
> 
> 时间：2012-06-30T20:22:50.227
> 
> 标签：iphone, objective-c, ios, xcode

我用自定义单元格制作了一个表格。每个单元格都是一个文本字段。我希望当我单击随机单元格时，阴影层（透明背景）出现在其他未聚焦的单元格上，如下图链接所示。

[http://i47.tinypic.com/nwd45e.png](http://i47.tinypic.com/nwd45e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:09:00.143

if you have set your tableViewCell's background in your storyboard/xib to have the default color (which is basically clear to allow the tableView color to be what you want), then you can do something like the following.

```
// assume that the background color for the tableView in the storyboard is lightOrange,
// as seen in http://i47.tinypic.com/nwd45e.png

- (UITableViewCell*)tableView:(UITableView*)tableView
        cellForRowAtIndexPath:(NSIndexPath*)indexPath
{
    ... the normal code for getting your cell, probably involving DequeueReusableCell ...

    // yes, the following gets called for every row even when selection doesn't change,
    // but it is a very small hit.  could be replaced by overriding reloadData for the
    // tableView, but that isn't always desirable.
    if (tableView.indexPathForSelectedRow)
        tableView.backgroundColor = [UIColor grayColor];
    else
        tableView.backgroundColor = [UIColor lightOrangeColor];

    return cell;
}

- (void)tableView:(UITableView*)tableView didSelectRowAtIndexPath:(NSIndexPath*)indexPath
{
    ... whatever else you would do for a selected row, perhaps a segue or something ...
    ... (and if part of this is to de-select a row that is already selected, take that ...
    ... into account as a conditional for the following line of code.

    tableView.backgroundColor = [UIColor grayColor];
} 
```

# mysql - 限制相似的 id - 结果到 sql

> ID：11277410
> 
> 赞同：0
> 
> 时间：2012-06-30T20:24:43.077
> 
> 标签：mysql, sql

2我有一个重复项目表，我从左连接完成了这个表。-可以说这个表别名是“piked”

```
ID     Product         PickedBY
1      Basket          Josh
1      Basket          Jessica
1      Basket          Josh
1      Basket          Mike
1      Basket          Mike
2      Seat            Alan
3      Computer        Jessica
4      Mouse           Josh
4      Mouse           Mike
4      Mouse           Jessica 
```

我希望将相等的 ID 限制为 2。我该怎么做？所以，如果我只列出 ids 结果将是 1、1、2、3、4、4。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:35:22.633

你的问题对我来说没有意义，这让我想知道你想用这样的查询实现什么，但你可以尝试对结果进行分组：

```
select id, count(*)
from piked
group by id 
```

这并不完全是您所要求的，但您可以通过查看结果的第二列来判断一个 id 是否有重复项。结果将是

```
1,5
2,1
3,1
4,3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:02:47.873

这应该可以解决问题：

```
SELECT ID, Product, PickedBy FROM (
SELECT
IF(@prev != q.ID, @rownum:=1, @rownum:=@rownum+1) as rownumber, @prev:=q.ID, q.*
FROM (
    SELECT
    ID, Product, PickedBy
    FROM piked
    , (SELECT @rownum:=0, @prev:=0) r
    ORDER BY ID
)q
)asdf
WHERE asdf.rownumber <= 2 
```

# iphone - 为基于智能手机应用程序的服务模拟虚拟用户

> ID：11277411
> 
> 赞同：1
> 
> 时间：2012-06-30T20:25:08.290
> 
> 标签：iphone, amazon-s3, amazon-ec2, simulation, traffic

抱歉，如果将来有人问过类似的问题，但我的搜索没有返回，我会考虑直接相关。

我正在尝试使用 AWS EC2/S3 中的后端和 iPhone 中的前端来实现一项服务，该服务或多或少类似于待办事项列表。这不是一个新颖的想法，但会在我教授的有关 IT 基础架构的课程中帮助我。

不幸的是，我只能使用我自己的 iPhone，而且我无法展示 AWS 等的可扩展性。

*有没有一种方法/软件工具/框架来模拟这个应用程序的虚拟用户，可以向假装来自不同账户/应用程序的 AWS 服务器发送请求？如果我要将项目添加到列表或删除或编辑，模拟器应该发送请求，就像我的实际 iphone 应用程序发送的一样。*

我知道压力测试是一个成熟的话题，但在这里我只想模拟多个用户并演示可伸缩性，而不是试图将 Web 服务推向极限。我也不确定这是否与交通模拟完全重叠。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:33:56.103

您也许可以使用 Apache JMeter 来完成。这取决于你在后端发生了什么。但它支持以下服务器类型：

```
Web - HTTP, HTTPS
SOAP
Database via JDBC
LDAP
JMS
Mail - SMTP(S), POP3(S) and IMAP(S)
Native commands or shell scripts 
```

您应该能够将某些东西与它连接在一起。

```
 http://jmeter.apache.org/
 http://www.opensourcetesting.org/performance.php 
```

我在不同的地方使用它来模拟我在 AWS/EC2 中运行的服务的非常重的负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T14:40:07.980

[Apache Benchmark](http://httpd.apache.org/docs/2.0/programs/ab.html)是一个非常方便的 HTTP 负载测试工具——你可以让它发出并发请求来模拟多个用户。与其他工具相比，它的主要优势在于它简单易上手。`ab`如果您的后端侦听 HTTP，那么在投入任何时间进行更复杂的事情之前可能值得一试。

# apache - apache 虚拟主机的服务器名称无法正常工作

> ID：11277413
> 
> 赞同：1
> 
> 时间：2012-06-30T20:25:21.050
> 
> 标签：apache, virtualhost, virtual-hosts, server-name

我正在尝试在 apache 中创建一个虚拟主机，以便我可以通过 localhost 访问本地站点，但使用与默认端口不同的端口：80，我想要的是`http://localhost:8080`直接在我指定的文件夹中加载我的站点，我有以下在我`httpd-vhosts.conf`的部分工作的文件中设置：

```
Listen 8080
NameVirtualHost *:8080

<VirtualHost 127.0.0.1:8080>
    DocumentRoot "c:\wamp\www\trend\public"
    ServerName local.trend
</VirtualHost> 
```

如果我去`http://localhost:8080`页面加载正常，但如果我去`http://local.trend`然后它只是显示我一样如果我去`http://localhost`有没有办法改变它，所以它也适用于服务器名称？

我应该编辑我的`hosts`文件吗？我目前有：

`127.0.0.1 localhost local.trend`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:28:28.397

您的主机文件现在是正确的。

如果您想`http://local.trend`访问相同的目标`http://local.trend:8080`（这是您在上面配置的），您需要在端口 80 上为该主机添加一个单独的 VirtualHost：

```
<VirtualHost 127.0.0.1:80>
    DocumentRoot "c:\wamp\www\trend\public"
    ServerName local.trend
</VirtualHost> 
```

# jquery - 在jquery中设置高度后的回调

> ID：11277414
> 
> 赞同：1
> 
> 时间：2012-06-30T20:25:29.070
> 
> 标签：jquery, callback

我用jquery设置了一个高度。设置此高度后，将执行另一个功能。重要的是，当设置第一个高度时，首先执行此函数。这是我的代码

```
$('.equal-height2').height(max_height2, function() {  
            alert('###');
            pc_img_height   = $('.podcasts-meta-img').height();
            $('.podcasts-meta-img').width(pc_img_height); 
        }) 
```

警报此刻被解雇了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:33:40.787

`height()`没有回调函数，试试`animate()`；

```
$('.equal-height2').animate({"height": max_height2}, function() {  
     alert('###');
     pc_img_height = $('.podcasts-meta-img').height();
     $('.podcasts-meta-img').width(pc_img_height); 
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:33:43.250

.height() 不会创建动画——你不需要在这里使用回调来做你想做的事。

# java - 编写hibernate函数的正确方法

> ID：11277415
> 
> 赞同：1
> 
> 时间：2012-06-30T20:25:30.347
> 
> 标签：java, hibernate

我在我的项目中使用休眠，它进展顺利，但我的问题是我有点困惑，我正在编写休眠函数的好方法。下面我粘贴我的代码块以了解我是如何编写休眠函数的，请检查它并告诉我它是否是正确的方法。这是我的块代码结构

```
SessionFactory sessionFactory = 
                (SessionFactory) ServletActionContext.getServletContext().getAttribute(HibernateListener.KEY_NAME);
        Session hibernatesession = sessionFactory.openSession();
        try {
            hibernatesession.beginTransaction();
            // my database access will be here
            hibernatesession.getTransaction().commit();
            hibernatesession.flush();
            }
        catch(Exception e){
          hibernatesession.getTransaction().rollback();
          e.printStackTrace();
        }finally{
          hibernatesession.close();
        } 
```

这是我为所有 dao 类函数创建的结构，但现在我的网站加载速度非常慢。所以我的问题是我使用的限制是正确的。是上面的代码导致一次打开多个会话休眠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:36:45.643

`flush()`后面的没用`commit()`。

您真的需要为每个操作打开一个新会话然后关闭它吗？

您可以使用`sessionFactory.getCurrentSession()`和`Hibernatesession.disconnect()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:48:43.293

在 DAO 类中进行事务管理并不是一个好的设计。我强烈推荐使用 Spring 及其声明式事务管理，设置起来很容易，使用起来也很容易。如果这对你来说不可用，那么你至少应该让一个穷人的选择。一个建议是让每个 DAO 成为具有执行样板部分（会话打开/关闭、事务开始/提交）的方法的类的子类，并调用可覆盖的方法来完成实际工作。这将为您的场景实现*模板*模式。这是一个大纲：

```
public abstract class DaoTemplate
{
  public void execute() {
    final Session s = ((SessionFactory) ServletActionContext.getServletContext()
        .getAttribute(HibernateListener.KEY_NAME)).openSession();
    try {
      s.beginTransaction();
      doTheRealStuff();
      s.getTransaction().commit();
    }
    catch(Exception e) {
      s.getTransaction().rollback();
      e.printStackTrace();
    } finally { s.close(); }
  }

  protected abstract void doTheRealStuff();
} 
```

另一个建议，也是我十年前在一个项目中实际使用的东西，是实现*策略*模式。在这种情况下，您会将一个对象传递给`execute`实现该方法的对象`doTheRealStuff`。此外，在这种情况下，`DaoTemplate`该类可能是一个单例（那么该类的不同名称将是合适的）。

# ruby-on-rails - Rails：在控制器和视图之间共享变量

> ID：11277420
> 
> 赞同：1
> 
> 时间：2012-06-30T20:26:33.353
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [在控制器和视图之间仅传递两个变量 - 最佳实践？](https://stackoverflow.com/questions/7051053/passing-only-two-variables-between-controller-and-view-best-practice)

有我的动作：

```
 def list
    @codes = Code.order("created_at")
    @languages = Language.order('name').collect {|l| [l.name, l.coderay]}
  end 
```

这是我的观点（我删除了一些行）：

```
<% @codes.each do |code| %>
    <div class="code">
        <%= link_to code.title, :action => 'show', :id => code.id %>
        <% if  code.author %>
            @<%= code.author %>
        <% end  %>
    </div>
<% end %>
<%= render :partial => 'shared/error_messages', :locals => {:object => @code} %>
<%= form_for :code, :url => {:action => 'create' }, :html => {:multipart => true} do |f| %>
    <%= f.text_field :title %><br />
    <%= f.text_area :content %><br>
    <%= f.select(:language, @languages, {:selected => 'text'}) %>
    <%= f.text_field :author %><br>
    <%= f.submit "Submit code" %>
<% end %> 
```

其中有 3 个变量：（`@codes`帖子列表）、`@code`（当前帖子，用于另一个操作）和 @languages。

我的 IDE 写道：

> 控制器和视图之间最多应共享两个实例变量 如果控制器和视图之间共享两个以上的实例变量，
> 此检查会发出警告。控制器应该只管理一个实例变量，再加上一个用于 current_user 变量的实例变量。

通常我在控制器和视图之间共享更多变量（在 PHP 中），有时是 10+。
它是如何在 Rails 中完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:53:06.597

它是一些开发人员有时会遵循的准则。

但我会更多地阅读 Rails Routing。了解 Rails 路由的工作原理应该可以让您更好地了解如何构建代码。

[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

我稍微修改了你的代码，没有经过测试。但希望能给你一些好主意。

控制器：

```
def new
   @code = Code.new
   @codes = Code.order("created_at") 
end

def create
   @code = Code.new(params[:code])
   if @code.save?
      # Do your thing.
   else
      # render your :new action passing your @code variable
   end
end 
```

看法：

```
 <% @codes.each do |code| %>
    <div class="code">

    # Use Rails Routing - In console, type rake routes to get list of routes.       
    <%= link_to code.title, code_path(code.id) %>  # example.

    <% if code.author %>
        <%= code.author %>
    <% end %>
   </div>
 <% end %>

  <%= render 'shared/error_messages', :object => @code %>

  <%= form_for @code, :html => {:multipart => true} do |f| %>
     <%= f.text_field :title %><br />
     <%= f.text_area :content %><br>

     # language_list = helper method.
     <%= f.select(:language, language_list, {:selected => 'text'}) %>
     <%= f.text_field :author %><br>
     <%= f.submit "Submit code" %>
  <% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T23:38:57.990

您可以通过使语言成为助手来保存实例变量：

```
def languages
  Language.order('name').collect {|l| [l.name, l.coderay]}
end 
```

# php - 使用我的 PHP 服务将 AngularJS 连接到 mysql？

> ID：11277429
> 
> 赞同：6
> 
> 时间：2012-06-30T20:27:35.823
> 
> 标签：php, mysql, angularjs

我在我的 Mac 上使用 AngularJS 1.0、PHP 和 mysql 和 localhost。

我有一个非常简单的 mysql 数据库：“猫”。它有一张叫做“小猫”的桌子。该表有两列，“id”和“name”。数据库中有三只小猫，名字分别为 Larry、Curly 和 Moe。

现在，我有一些简单的 PHP 代码可以打开 dbase，获取三个记录，并以 JSON 格式返回它们，如下所示：[{"id":"1","name":"Larry"},{"id": "2","name":"Curly"},{"id":"3","name":"萌"}]

我使用了最新的 angular-seed 并在 Eclipse 中建立了一个项目。在 app.js 我写了这个：'use strict'; angular.module('Cats', ['ngResource','Cats.filters', 'Cats.services', 'Cats.directives']) 我将我的 PHP 代码放在 services 文件夹中，并将其命名为“index.php”。如果我在 Mac 上使用 localhost 在浏览器中导航到该 services/index.php，我会返回上面的 JSON。到目前为止，一切都很酷。

现在 - 我要做的所有事情（！著名的遗言；）就是连接到我拥有的 PHP 服务，并使用我的 AngularJS 项目在我的主索引页面上显示该 Cats 表的内容。纯旧文本，没有表格，只需绑定到可用资源并显示它。

我已经尝试过各种在线演示（很多都已过时）。谁能告诉我一种简单的当前方法来做到这一点？在我的一生中，我有各种各样的 AngularJS 演示工作，但没有一个以我能理解的方式完成这个简单的任务。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T22:44:48.920

这也应该有效。它的代码行数明显减少，但请注意已删除任何错误处理：

```
function FetchCtrl($scope, $resource) {
  var services = $resource('../services/index.php');
  $scope.data = services.query();
}
FetchCtrl.$inject = ['$scope', '$resource']; 
```

通常我会使用内置`.get()`方法，`$resouce`但您的响应是数组的形式，`.query()`默认情况下支持。

您可以在[此处找到](http://docs.angularjs.org/api/ngResource.%24resource)[文档`$resource`](http://docs.angularjs.org/api/ngResource.%24resource)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T09:51:24.380

好的。解决了。首先，复制并添加了我在其中一个示例中找到的控制器：

```
 function FetchCtrl($scope, $http, $templateCache) {
        $scope.method = 'GET';
        $scope.url='../services/index.php';  
        $scope.fetch = function() {
            $scope.code = null;
            $scope.response = null;

            $http({method: $scope.method, url: $scope.url, cache: $templateCache}).
            success(function(data, status) {
                $scope.status = status;
                $scope.data = data;
            }).
            error(function(data, status) {
                $scope.data = data || "Request failed";
                $scope.status = status;
            });
        };

        $scope.updateModel = function(method, url) {
            $scope.method = method;
            $scope.url = url;
        };
    } 
```

然后，我在我的模块中添加了一个路由控制器：

```
var module = angular.module('Cats', ['ngResource','Cats.filters', 'Cats.services', 'Cats.directives'])
    .config(['$routeProvider', function($routeProvider) {
    $routeProvider.when('/main', {templateUrl: 'partials/partial1.html', controller: MyCtrl1}); 
```

最后，在那个 partial1.htm 页面上，我添加了这个：

```
<div ng-init="fetch()">
    {{data}}
</div> 
```

现在，当我在浏览器中访问该页面时，我可以看到整个数据库以 JSON 格式转储。啊。显然有很多更复杂的事情要尝试，等等，但我需要这个简单的结果，所以我可以确定我确实有一个模型在被召唤时到达。在许多情况下，Angular 会默默地死去，因此可见的结果非常有帮助。

一个问题：请注意，php 文件可以由多个用户执行，而不是您自己。我不知道 AngularJS 实现的用户的名字，但我必须`chmod 644 index.php`这样应用才能使用它。

我希望这对某人有所帮助。

# python - 如何从 Python 字典中删除键？

> ID：11277432
> 
> 赞同：2464
> 
> 时间：2012-06-30T20:27:59.470
> 
> 标签：python, dictionary, unset

从字典中删除键时，我使用：

```
if 'key' in my_dict:
    del my_dict['key'] 
```

有没有一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3942
> 
> 时间：2012-06-30T20:29:18.237

要删除一个键而不管它是否在字典中，请使用以下两种参数形式[`dict.pop()`](http://docs.python.org/library/stdtypes.html#dict.pop)：

```
my_dict.pop('key', None) 
```

`my_dict[key]`如果`key`字典中存在则返回，`None`否则返回。如果第二个参数未指定（即`my_dict.pop('key')`）`key`且不存在，`KeyError`则引发 a。

要删除保证存在的键，您还可以使用：

```
del my_dict['key'] 
```

`KeyError`如果键不在字典中，这将引发 a 。

* * *

## 回答 #2

> 赞同：414
> 
> 时间：2012-06-30T20:36:44.680

具体回答“有没有一种方法可以做到这一点？”

```
if 'key' in my_dict: del my_dict['key'] 
```

...好吧，你*问*了;-)

但是，您应该考虑到，这种从 a 中删除对象的`dict`方式[不是原子](https://stackoverflow.com/q/17326067/722332)的——它可能`'key'`在语句`my_dict`期间存在`if`，但可能在`del`执行之前被删除，在这种情况下`del`将失败并返回 a `KeyError`。鉴于此，[使用`dict.pop`](https://stackoverflow.com/a/11277439/722332)或类似的东西是最安全的

```
try:
    del my_dict['key']
except KeyError:
    pass 
```

当然，这绝对*不是*单行的。

* * *

## 回答 #3

> 赞同：181
> 
> 时间：2013-03-04T16:43:20.967

我花了一些时间才弄清楚到底`my_dict.pop("key", None)`在做什么。因此，我将添加此作为答案以节省其他人的谷歌搜索时间：

> ### `pop(key[, default])`
> 
> 如果*key*在字典中，删除它并返回它的值，否则返回*default*。如果未给出*默认值且**键*不在字典中，`KeyError`则引发 a。

[文档](https://docs.python.org/2/library/stdtypes.html#dict.pop)

* * *

## 回答 #4

> 赞同：74
> 
> 时间：2016-12-07T12:19:22.867

`del my_dict[key]``my_dict.pop(key)`当键存在时，比从字典中删除键稍快

```
>>> import timeit
>>> setup = "d = {i: i for i in range(100000)}"

>>> timeit.timeit("del d[3]", setup=setup, number=1)
1.79e-06
>>> timeit.timeit("d.pop(3)", setup=setup, number=1)
2.09e-06
>>> timeit.timeit("d2 = {key: val for key, val in d.items() if key != 3}", setup=setup, number=1)
0.00786 
```

但是当密钥不存在时`if key in my_dict: del my_dict[key]`比`my_dict.pop(key, None)`. `del`两者都至少比`try`/`except`语句快三倍：

```
>>> timeit.timeit("if 'missing key' in d: del d['missing key']", setup=setup)
0.0229
>>> timeit.timeit("d.pop('missing key', None)", setup=setup)
0.0426
>>> try_except = """
... try:
...     del d['missing key']
... except KeyError:
...     pass
... """
>>> timeit.timeit(try_except, setup=setup)
0.133 
```

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2015-09-16T19:17:36.957

如果您需要在一行代码中从字典中删除很多键，我认为使用 map() 非常简洁且 Python 可读：

```
myDict = {'a':1,'b':2,'c':3,'d':4}
map(myDict.pop, ['a','c']) # The list of keys to remove
>>> myDict
{'b': 2, 'd': 4} 
```

如果您需要捕获弹出不在字典中的值的错误，请在 map() 中使用 lambda，如下所示：

```
map(lambda x: myDict.pop(x,None), ['a', 'c', 'e'])
[1, 3, None] # pop returns
>>> myDict
{'b': 2, 'd': 4} 
```

或 in `python3`，您必须改用列表推导：

```
[myDict.pop(x, None) for x in ['a', 'c', 'e']] 
```

有用。即使 myDict 没有“e”键，“e”也不会导致错误。

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2016-12-07T05:52:11.343

您可以使用[字典推导](https://docs.python.org/tutorial/datastructures.html#dictionaries)创建一个删除该键的新字典：

```
>>> my_dict = {k: v for k, v in my_dict.items() if k != 'key'} 
```

可以按条件删除。`key`如果不存在则没有错误。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2018-05-02T10:22:55.467

使用“del”关键字：

```
del dict[key] 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2018-05-19T10:09:13.067

我们可以通过以下一些方法从 Python 字典中删除一个键。

使用`del`关键字；这与您所做的几乎相同 -

```
 myDict = {'one': 100, 'two': 200, 'three': 300 }
 print(myDict)  # {'one': 100, 'two': 200, 'three': 300}
 if myDict.get('one') : del myDict['one']
 print(myDict)  # {'two': 200, 'three': 300} 
```

**或者**

我们可以这样做：

但是应该记住，在这个过程中实际上它不会从字典中**删除**任何键，而不是使特定键从该字典中**排除**。此外，我观察到它返回的字典与`myDict`.

```
myDict = {'one': 100, 'two': 200, 'three': 300, 'four': 400, 'five': 500}
{key:value for key, value in myDict.items() if key != 'one'} 
```

如果我们在 shell 中运行它，它会执行类似`{'five': 500, 'four': 400, 'three': 300, 'two': 200}`- 注意它的顺序与`myDict`. 同样，如果我们尝试打印`myDict`，那么我们可以看到所有键，包括我们通过这种方法从字典中排除的键。但是，我们可以通过将以下语句分配给变量来创建一个新字典：

```
var = {key:value for key, value in myDict.items() if key != 'one'} 
```

现在，如果我们尝试打印它，那么它将遵循父顺序：

```
print(var) # {'two': 200, 'three': 300, 'four': 400, 'five': 500} 
```

**或者**

使用`pop()`方法。

```
myDict = {'one': 100, 'two': 200, 'three': 300}
print(myDict)

if myDict.get('one') : myDict.pop('one')
print(myDict)  # {'two': 200, 'three': 300} 
```

`del`和之间的区别在于`pop`，使用`pop()`方法，如果需要，我们实际上可以存储**键的值**，如下所示：

```
myDict = {'one': 100, 'two': 200, 'three': 300}
if myDict.get('one') : var = myDict.pop('one')
print(myDict) # {'two': 200, 'three': 300}
print(var)    # 100 
```

如果您觉得这很有用，请分叉[此要点](https://gist.github.com/innat/c8d04ef139060b9ef0b7fa8a164f87bc)以供将来参考。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2019-05-25T04:06:20.077

如果您想非常详细，可以使用异常处理：

```
try: 
    del dict[key]

except KeyError: pass 
```

`pop()`但是，如果密钥不存在，这将比该方法慢。

```
my_dict.pop('key', None) 
```

几个键无关紧要，但如果你反复这样做，那么后一种方法是更好的选择。

最快的方法是这样的：

```
if 'key' in dict: 
    del myDict['key'] 
```

但是这种方法很危险，因为如果`'key'`在两行之间删除， a`KeyError`将被提高。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-09-17T19:25:16.597

另一种方法是使用 items() + dict理解。

items() 与dict理解相结合也可以帮助我们完成键值对删除的任务，但它的缺点是不是一个到位的dict技术。实际上，如果创建了一个新的字典，除了我们不希望包含的键。

```
test_dict = {"sai" : 22, "kiran" : 21, "vinod" : 21, "sangam" : 21}

# Printing dictionary before removal
print ("dictionary before performing remove is : " + str(test_dict))

# Using items() + dict comprehension to remove a dict. pair
# removes  vinod
new_dict = {key:val for key, val in test_dict.items() if key != 'vinod'}

# Printing dictionary after removal
print ("dictionary after remove is : " + str(new_dict)) 
```

输出：

```
dictionary before performing remove is : {'sai': 22, 'kiran': 21, 'vinod': 21, 'sangam': 21}
dictionary after remove is : {'sai': 22, 'kiran': 21, 'sangam': 21} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-06-21T09:24:22.347

**字典**数据类型有一个被调用的方法`dict_name.pop(item)`，它可以用来从字典中删除一个*键：值*对。

```
a={9:4,2:3,4:2,1:3}
a.pop(9)
print(a) 
```

这将使输出为：

```
{2: 3, 4: 2, 1: 3} 
```

这样，您可以在一行中从字典中删除一个项目。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-06-14T08:44:33.517

我更喜欢不可变的版本

```
foo = {
    1:1,
    2:2,
    3:3
}
removeKeys = [1,2]
def woKeys(dct, keyIter):
    return {
        k:v
        for k,v in dct.items() if k not in keyIter
    }

>>> print(woKeys(foo, removeKeys))
{3: 3}
>>> print(foo)
{1: 1, 2: 2, 3: 3} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-04-25T16:36:47.633

### 按键上的单个过滤器

*   如果 my_dict 中存在“key”，则返回“key”并将其从 my_dict 中删除
*   如果 my_dict 中不存在“key”，则返回 None

> 这将`my_dict`就地改变（可变）

```
my_dict.pop('key', None) 
```

### 键上的多个过滤器

> 生成一个新的字典（不可变）

```
dic1 = {
    "x":1,
    "y": 2,
    "z": 3
}

def func1(item):
    return  item[0]!= "x" and item[0] != "y"

print(
    dict(
        filter(
            lambda item: item[0] != "x" and item[0] != "y", 
            dic1.items()
            )
    )
) 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2021-09-12T02:15:21.623

您还可以使用`filter`with `lambda`：

```
>>> d = {'a': 1, 'b': 2, 'c': 3}
>>> dict(filter(lambda x: x[0] != 'a', d.items()))
{'b': 2, 'c': 3}
>>> 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2022-02-21T16:24:07.683

试试这个

```
if key in data:
   del data[key] 
```

# r - 重塑、聚合/连接字符串

> ID：11277437
> 
> 赞同：0
> 
> 时间：2012-06-30T20:28:45.607
> 
> 标签：r, data-manipulation

我正在以国家/地区年份格式汇总数据集

```
melted <- melt(data, id = c("ccode.a","year"))

data.fix <- function(x) c(max = max(x), sum = sum(x), min = min(x),
                          newcol = paste(x, sep = ","))
casted <- cast(melted, ccode.a + year ~ ..., data.fix) 
```

我想进行连接`conflictID.a`，以便对于将多行聚合为单行的实例，我得到聚合的所有值`conflictID.a`。

以下是一些示例数据：

`dput(tail(subset(data, select=c(ccode.a,year,onset,conflictID.a)), 100))`

我也人为地修改了数据以重现问题。因此，在两种情况下，有 2 行或更多行具有相同的`year`和`ccode.a`值，但`conflictID.a`值不同，我想在聚合时将它们连接在一起，每个`ccode.a`, `year`.

```
structure(list(ccode.a = c(2L, 2L, 2L, 2L, 2L, 2L, 2L, 41L, 41L, 
41L, 52L, 52L, 70L, 70L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 
90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 
92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 
93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 95L, 
95L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 
100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 
100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 
100L, 100L, 101L, 101L, 115L, 130L), year = c(2001, 2001, 2001, 
2005, 2006, 2007, 2008, 1989, 1991, 2004, 1990, 1990, 1994, 1996, 
1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 
1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1979, 
1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 
1991, 1977, 1978, 1979, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 
1989, 1990, 1989, 1989, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 
1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 
1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 
2004, 2005, 2006, 2007, 2008, 1982, 1982, 1982, 1995), onset = c(1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), conflictID.a = c(224L, 
224L, 224L, 224L, 224L, 224L, 224L, 186L, 186L, 186L, 183L, 183L, 
205L, 205L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 
36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 120L, 
120L, 120L, 120L, 120L, 120L, 120L, 120L, 120L, 120L, 120L, 120L, 
120L, 140L, 140L, 140L, 140L, 140L, 140L, 140L, 140L, 140L, 140L, 
140L, 140L, 173L, 172L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 
92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 
92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 
80L, 80L, 162L, 208L)), .Names = c("ccode.a", "year", "onset", 
"conflictID.a"), row.names = c(127L, 128L, 130L, 131L, 132L, 
133L, 134L, 277L, 279L, 292L, 395L, 396L, 452L, 454L, 494L, 495L, 
496L, 497L, 498L, 499L, 500L, 501L, 502L, 503L, 504L, 505L, 506L, 
507L, 508L, 509L, 510L, 511L, 512L, 513L, 514L, 566L, 567L, 568L, 
569L, 570L, 571L, 572L, 573L, 574L, 575L, 576L, 577L, 578L, 598L, 
599L, 600L, 603L, 604L, 605L, 606L, 607L, 608L, 609L, 610L, 611L, 
678L, 679L, 699L, 700L, 701L, 702L, 703L, 704L, 705L, 706L, 707L, 
708L, 709L, 710L, 711L, 712L, 713L, 714L, 715L, 716L, 717L, 718L, 
719L, 720L, 721L, 722L, 723L, 724L, 725L, 726L, 727L, 728L, 729L, 
730L, 731L, 732L, 740L, 750L, 812L, 854L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:34:01.770

你不需要`reshape`这个，只需使用 plain `aggregate`。

```
# All aggregated values
aggregate(data$conflictID.a,by=list(data$ccode.a,data$year),c)
# Just unique values
aggregate(data$conflictID.a,by=list(data$ccode.a,data$year),unique) 
```

# android - 无法构建 Titanium Android 应用程序以在模拟器中进行测试

> ID：11277438
> 
> 赞同：1
> 
> 时间：2012-06-30T20:29:10.230
> 
> 标签：android, titanium

我正在使用带有 java 6 的 Ubuntu 12.04 (x64)（根据钛的要求），正如标题所说，我无法构建 Android 应用程序来在模拟器上对其进行测试。我不断收到此错误

```
[ERROR] Application Installer abnormal process termination. Process exit value was 1
[ERROR] Exception occured while building Android project:
[ERROR] Traceback (most recent call last):
[ERROR]   File "/home/irmantas/.titanium/mobilesdk/linux/2.1.0.GA/android/builder.py", line 2206, in <module>
[ERROR]     s.build_and_run(False, avd_id, debugger_host=debugger_host)
[ERROR]   File "/home/irmantas/.titanium/mobilesdk/linux/2.1.0.GA/android/builder.py", line 2037, in build_and_run
[ERROR]     launched, launch_failed = self.package_and_deploy()
[ERROR]   File "/home/irmantas/.titanium/mobilesdk/linux/2.1.0.GA/android/builder.py", line 1569, in package_and_deploy
[ERROR]     self.keystore_alias])
[ERROR]   File "/home/irmantas/.titanium/mobilesdk/linux/2.1.0.GA/android/run.py", line 36, in run
[ERROR]     process = subprocess.Popen(args, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
[ERROR]   File "/usr/lib/python2.7/subprocess.py", line 679, in __init__
[ERROR]     errread, errwrite)
[ERROR]   File "/usr/lib/python2.7/subprocess.py", line 1249, in _execute_child
[ERROR]     raise child_exception
[ERROR] OSError: [Errno 2] No such file or directory 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T09:47:54.703

对我来说，它原来是一个java问题。“没有这样的文件或目录”原来是 jarsigner。为了解决这个问题，借用此信息[https://askubuntu.com/questions/55848/how-do-i-install-oracle-java-jdk-7](https://askubuntu.com/questions/55848/how-do-i-install-oracle-java-jdk-7)我输入了以下内容

```
sudo update-alternatives --quiet --install /usr/bin/jarsigner jarsigner /usr/lib/jvm/jdk1.6.0_32/bin/jarsigner 100 --slave /usr/share/man/man1/jarsigner.1 jarsigner.1 /usr/lib/jvm/jdk1.6.0_32/man/man1/jarsigner.1 
```

这立即解决了问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:47:37.940

三种可能的解决方案：

[http://developer.appcelerator.com/question/86751/android-emulator-wont-launch-adbexe-doesnt-start](http://developer.appcelerator.com/question/86751/android-emulater-wont-launch-adbexe-doesnt-start) [http://developer.appcelerator.com/question/121286/error-running-projects-in-android -emulator](http://developer.appcelerator.com/question/121286/error-running-projects-in-android-emulator) ...appcelerator.com/question/120519/emulator-is-crashing-unexpectedly

1.  检查是否可以在工具和平台工具文件夹中访问 adb
2.  检查您的 app.js 中是否没有有趣的编码
3.  使用 android 工具重新保存或删除 Titanium AVD

为了

java版本

你应该得到

java 版本 "1.6.0_33" Java(TM) SE Runtime Environment (build 1.6.0_33-b03) Java HotSpot(TM) Client VM (build 20.8-b03, 混合模式, 共享)

# php - Mysql加入超过2个表

> ID：11277443
> 
> 赞同：3
> 
> 时间：2012-06-30T20:29:31.090
> 
> 标签：php, mysql

我正在尝试加入 3 个 mysql 表；朋友、用户和评论。

```
users:
id  | firstName | lastName
--------------------------
12  | edwin     | leon
9   | oscar     | smith
1   | kasandra  | rios

friends:
userId   | friendID
----------------------
   12    | 9
   9     | 12
   12    | 1
   1     | 12

comments:
commenter | comment  | commentDate
----------------------------
 12       |  hey     | Oct-2
 1        | Hmmmmmm  | Nov-1
 9        | ok       | Nov-2
 9        | testing  | Nov-2
 1        | hello    | Dec-20    
 1        | help     | Dec-20 
```

所以我想做的是选择所有用户朋友的评论。所以我想输出的是你朋友的评论：例如：

```
for edwin leon (id 12) it would output this
friendID    | comment  | commentDate | firstName | lastName
-----------------------------------------------------------
   1        | Help     |    Dec-20   | kasandra  | rios
   1        | Hello    |    Dec-20   | kasandra  | rios
   9        | testing  |    Nov-2    | oscar     | smith
   9        | ok       |    Nov-2    | oscar     | smith
   1        | Hmmmm    |    Nov-1    | kasandra  | rios 
```

它会得到所有朋友的评论，但不会得到他的评论。这是我的代码：

```
SELECT friends.friendID, users.firstName, users.lastName, comments.comment, comments.commentDate  
FROM users
  JOIN friends ON friends.userID = users.id
  JOIN comments ON comments.commenter = friends.friendID 
 WHERE users.id = '12' AND comments.commenter != '12' 
```

它确实有效，但我没有得到评论者的名字，而是得到了所有评论者的 edwin leon

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:33:45.047

您希望将用户表加入到朋友 ID 而不是用户 ID：

```
SELECT friends.friendID, users.firstName, users.lastName, comments.comment, comments.commentDate  
FROM users
  JOIN friends ON friends.friendID = users.id
  JOIN comments ON comments.commenter = friends.friendID 
 WHERE friends.userID = '12' AND comments.commenter != '12' 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!3/0803c/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:34:26.963

试试这个：：

```
Select friendId, comment, commentdate, firstname, lastname
from
friends inner join comments on (friends.friendId=comenter)
inner join users on (users.id=friends.friendId)
where friends.userid=? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T20:35:08.320

试试这个（我没有测试过）

```
SELECT friends.friendID, u2.firstName, u2.lastName, comments.comment, comments.commentDate  
FROM users AS u
  JOIN friends ON friends.userID = u.id
  JOIN comments ON comments.commenter = friends.friendID 
  JOIN users AS u2 ON u2.id = friends.friendID
 WHERE u.id = '12' AND comments.commenter != '12' 
```

# java - 如何使用 ComboBox 刷新与 SQLContainer 相关的 Vaadin 表？

> ID：11277445
> 
> 赞同：1
> 
> 时间：2012-06-30T20:29:35.010
> 
> 标签：java, sql, data-binding, vaadin

我需要一个基于 Vaadin 的简单应用程序的帮助。

我需要有一个绑定到 SQL 查询结果的表。SQL 查询有一个参数，用户从组合框中选择该参数。我需要的是在用户更改组合框值时刷新表格。

这就是我所拥有的（）：

```
 Table table;
 JDBCConnectionPool pool;
 String query = "select products.product_code, products.name as product_name, clients.client_code,  clients.name as client_name from products, clients where products.client_id = clients.id";

 FreeformQuery q = new FreeformQuery(query, pool);
 SQLContainer container = new SQLContainer(q);
 table.setContainerDataSource(container); 
```

因此，这个简单的代码从产品和客户表中选择所有数据并将其放入表中。但是，例如，如何通过从组合框中选择的 clients.client_id 添加过滤？要实现下一个查询：

```
 select products.product_code, products.name as product_name, clients.client_code,  clients.name as client_name from products, clients where products.client_id = clients.id where client_id = ?; 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:58:58.710

您可以添加一个`Property.ValueChangeListener`会更改您的查询参数的：

```
comboBox.addListener(new Property.ValueChangeListener() {
    public void valueChange(ValueChangeEvent event) {
        String customQuery = query.replace(":clientId", ((Client)(event.getProperty()).getId(), pks);
        table.setContainerDataSource(new SQLContainer(new FreeformQuery(customQuery, pool)));
    }
}); 
```

并且`query`将保持以下值：`select products.product_code, products.name as product_name, clients.client_code, clients.name as client_name from products, clients where products.client_id = clients.id where client_id = :clientId`

但是要小心`query.replace`，如果Id是`int`没什么好担心的，但如果是字符串，请`addSlashes`避免SQLInjection。

# c# - 检测图像中的文本

> ID：11277450
> 
> 赞同：3
> 
> 时间：2012-06-30T20:30:30.163
> 
> 标签：c#, aforge

我正在使用 AForge.NET 库进行图像处理。使用这个库，我可以检测图像中的基本形状。如何使用 AForge.NET 库检测图像中的文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:43:09.763

You will need to use [Optical Character Recognition](http://en.wikipedia.org/wiki/Optical_character_recognition) (OCR). One link I found on using it with AForge can be visited [here](http://www.codeproject.com/Articles/11285/Neural-Network-OCR). Some code from the link:

```
// "K" letter, but a little bit noised
float[] pattern = new float [] {
        0.5f, -0.5f, -0.5f,  0.5f,  0.5f,
        0.5f, -0.5f,  0.5f, -0.5f,  0.5f,
        0.5f,  0.5f, -0.5f, -0.5f, -0.5f,
        0.5f, -0.5f,  0.5f, -0.5f, -0.5f,
        0.5f, -0.5f, -0.5f,  0.5f, -0.5f,
        0.3f, -0.5f, -0.5f,  0.5f,  0.5f};

// get network's output
float[] output = neuralNet.Compute(pattern);

int i, n, maxIndex = 0;

// find the maximum from output
float max = output[0];
for (i = 1, n = output.Length; i < n; i++)
{
    if (output[i] > max)
    {
        max = output1[i];
        maxIndex = i;
    }
}

//
System.Diagnostics.Debug.WriteLine(
  "network thinks it is - " + (char)((int) 'A' + maxIndex)); 
```

The only other way I can think of doing it, is using [Tessaract-OCR](http://code.google.com/p/tesseract-ocr/) which can read a wide variety of image formats and convert them to text in over 40 languages. There are also many other ways of doing it out there, including [using Microsoft Office](http://www.codeproject.com/Articles/41709/How-To-Use-Office-2007-OCR-Using-C), or [Emgu cv](http://www.emgu.com/wiki/index.php/License_Plate_Recognition_in_CSharp).

There's one more link which might work. It detects playing cards in AForge, and while doing so reads the numbers or J, Q, and K in the corner. [You may have seen it already](http://www.codeproject.com/Articles/265354/Playing-Card-Recognition-Using-AForge-Net-Framewor).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-06T19:55:36.473

使用[Microsoft 认知服务 - 计算机视觉 API](https://www.microsoft.com/cognitive-services/en-us/computer-vision-api)

光学字符识别 (OCR) 检测图像中的文本并将识别的单词提取到机器可读的字符流中

# html - 调整包装器的大小

> ID：11277452
> 
> 赞同：0
> 
> 时间：2012-06-30T20:31:14.197
> 
> 标签：html, css

在调整#main_wrap 大小时遇到​​问题：

[http://www.coffeeproteindrink.com/method-athlete/](http://www.coffeeproteindrink.com/method-athlete/)

```
#main_wrap {
min-height: 100%;
background: url(images/content_back.png) repeat-y top left; 
margin: 0 0 0 240px;
opacity: .8;
}

#content
{float: left;
margin: -28px 0 30px 0;
position: relative;
z-index: 20;
top: 325px; 
height: 262px;
overflow: scroll;
} 
```

我试图让它看起来像：

[http://www.bio-genix.com/](http://www.bio-genix.com/)

我确定我只是在放屁，但我似乎无法让它发挥作用。

任何帮助深表感谢。

肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:53:00.817

要做的一件简单的事情是（如果可以访问 CSS）进入您的#Content 标签

```
#content {
float: left;
margin: -28px 0 30px 0;
position: relative;
z-index: 20;
top: 325px;
height: 262px;
overflow: scroll;
} 
```

并删除溢出：滚动，因为您的内容分隔线足够大，可以处理内容而不必溢出。所以它应该看起来像这样

```
#content {
float: left;
margin: -28px 0 30px 0;
position: relative;
z-index: 20;
top: 325px;
height: 262px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:21:46.367

您的`top: 325px`值是 on `#content`，它比您希望在元素列表中的位置更靠后。`#main_wrap`因此，您想用向下推，并从`top`中删除。`top``#content`

```
#main_wrap {
    position: absolute; 
    top: 325px;
} 
#content {
    top: 0;
} 
```

[http://jfcoder.com/test/methodsite.html](http://jfcoder.com/test/methodsite.html)

# ruby-on-rails - Weird Ruby Behavior in DateTime to Time conversion

> ID：11277454
> 
> 赞同：4
> 
> 时间：2012-06-30T20:31:32.170
> 
> 标签：ruby-on-rails, ruby, datetime, time

My goal is to get a Time instance from a DateTime instance

This has been previously discussed here and I am still confused : [Convert to/from DateTime and Time in Ruby](https://stackoverflow.com/questions/279769/convert-to-from-datetime-and-time-in-ruby)

For me in irb running ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-darwin11.2.0], things work perfectly

```
1.9.3p0 :001 > require 'Date'
 => true 
1.9.3p0 :002 > require 'Time'
 => true 
1.9.3p0 :003 > t=DateTime.now
 => #<DateTime: 2012-07-01T01:57:32+05:30 ((2456109j,73652s,621060000n),+19800s,2299161j)> 
1.9.3p0 :004 > t2=t.to_time
 => 2012-07-01 01:57:32 +0530 
1.9.3p0 :005 > t.class
 => DateTime 
1.9.3p0 :006 > t2.class
 => Time 
1.9.3p0 :007 > 
```

However when working with rails console v 3.2.3 on same ruby platform

```
1.9.3p0 :001 > t=DateTime.now
 => Sun, 01 Jul 2012 02:00:00 +0530 
1.9.3p0 :002 > t.class
 => DateTime 
1.9.3p0 :003 > t2=t.to_time
 => Sun, 01 Jul 2012 02:00:00 +0530
1.9.3p0  > t2.class
 => DateTime 
```

What to do to get a Time instance from DateTime in rails?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:59:34.403

According to the [Rails documentation for `DateTime.to_time()`](http://api.rubyonrails.org/classes/DateTime.html#method-i-to_time),

> If self has an offset other than 0, self will just be returned unaltered

To change to a 0 offset, use [`DateTime.utc()`](http://api.rubyonrails.org/classes/DateTime.html#method-i-utc).

```
1.9.3p194 :005 > t3=t2.utc
 => Sat, 30 Jun 2012 20:43:21 +0000 
1.9.3p194 :006 > t3.offset
 => (0/1) 
1.9.3p194 :007 > t4=t3.to_time
 => 2012-06-30 20:43:21 UTC 
1.9.3p194 :008 > t4.class
 => Time 
```

# asana - 如何通过 Asana API 添加标签

> ID：11277457
> 
> 赞同：0
> 
> 时间：2012-06-30T20:32:09.300
> 
> 标签：asana

我正在尝试做一个简单的 Salesforce-Asana 集成。我有许多功能在工作，但在将标签添加到工作区时遇到了麻烦。由于我找不到有关 addTag 方法的文档，所以我有点猜测需要什么。

如果我将以下 JSON 发布到[https://app.asana.com/api/1.0/workspaces/WORKSPACEID/tasks](https://app.asana.com/api/1.0/workspaces/WORKSPACEID/tasks)：

{"data":{"name":"MyTagName","notes":"Test Notes"}}

标签在 Asana 中创建，但带有空白注释和名称字段。如果我尝试变得更花哨并发布：

{"data":{"name":"MyTagName","notes":"Test Notes","followers":[{"id":"MY_USER_ID"}]}}

我收到：

{"errors":[{"message":"无效字段：{\"data\":{\"name\":\"MyTagName\",\"notes\":\"Test Notes\",\"关注者\":[{\"id\":\"MY_USER_ID\"}]}}"}]}

我认为反斜杠可能意味着我的请求正在被帖子修改，尽管调试输出在帖子之前显示了一个格式正确的 json 字符串。

示例代码：

```
JSONGenerator jsongen = JSON.createGenerator(false);

jsongen.writeStartObject();
jsongen.writeFieldName('data');
jsongen.writeStartObject();
jsongen.writeStringField('name', 'MyTagName');
jsongen.writeStringField('notes', 'Test Notes');
jsongen.writeFieldName('followers');
jsongen.writeStartArray();
jsongen.writeStartObject();
jsongen.writeStringField('id', 'MY_USER_ID');
jsongen.writeEndObject();
jsongen.writeEndArray();
jsongen.writeEndObject();
jsongen.writeEndObject();

String requestbody = jsongen.getAsString();

HttpRequest req = new HttpRequest();
req.setEndpoint('https://app.asana.com/api/1.0/workspaces/WORKSPACEID/tags');
req.setMethod('POST');

//===Auth header created here - working fine===
req.setBody(requestbody);

Http http = new Http();
HTTPResponse res = http.send(req);

return res.getBody(); 
```

任何帮助表示赞赏。我没有使用 JSON 以及 Asana API 的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T20:53:58.897

问题是我发布到了错误的端点。我应该使用 /tags 并在请求正文中包含 workspaceid 而不是工作空间/工作空间 ID/标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T20:28:41.130

自从您发布此问题以来，Asana 的 API 和开发人员已经引入了标签。您的文档非常清楚地列出了您的问题的答案：

[https://asana.com/developers/api-reference/tags](https://asana.com/developers/api-reference/tags)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T21:30:52.963

啊哈，所以你可以添加标签甚至设置关注者，尽管 API 没有提到你可以或声称关注者是只读的。

所以总结一下其他感兴趣的人：发布到端点[https://app.asana.com/api/1.0/tags](https://app.asana.com/api/1.0/tags)你可以创建一个这样的标签：

{“数据”：{“工作区”：1234567，“名称”：“新标签名称”，“关注者”：[45678, 6789] } }

其中 1234567 是您的工作区 ID，45678 和 6789 是您的新关注者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T20:36:34.623

我对你的问题有点困惑。您问“如何添加标签”，但问题的前半部分谈到了添加任务。您所描述的问题是您正在尝试设置任务的追随者，但根据 Asana 的 API 文档，追随者字段目前是只读的。这就是您收到错误的原因。您现在无法使用 API 设置关注者。

您问题的第二部分 - 带有示例代码 - 看起来您正在尝试添加标签。但是，目前 Asana API 不支持这一点（至少根据 API 文档）。您可以更新现有标签，但不能添加标签。

因此，总结一下：目前 API 不允许您将关注者添加到任务或创建新标签。

# jquery - 如何使用 ajax 循环优雅地降级

> ID：11277458
> 
> 赞同：1
> 
> 时间：2012-06-30T20:32:16.863
> 
> 标签：jquery, graceful-degradation

我有一个主循环，当单击某些图标时，我将其替换为其他循环。每个循环实际上都有自己的页面，但对于使用 javascript 的用户，我只是允许他们在主页内容区域中切换循环。我阅读了有关如何执行此操作的教程，它使用 # 作为链接的 href，这不允许我链接到实际页面，而只是让 javascript 忽略该链接并改为执行 ajax。所以我的问题是如何将这个过程设置在下面，以便它优雅地降级。

我有一个名为 mysite.com/my-favorites 的页面。

这就是我在主页上使用 ajax 调用该页面内容的方式。

```
<a id="fav" class="trigger-loop" href="#"><div id="favorite-icon"></div></a>

jQuery(document).ready(function($){
 $('#fav.trigger-loop').click(function(){
    $('.trigger').removeClass('active');
    $('.trigger-loop').removeClass('active');
    $('#fav.trigger-loop').addClass('active');
    $('#boxes').empty();
    $.post(
        WPaAjax.ajaxurl,
        {
            action : 'loop_fav',
        },
        function( response ) {
            $('#boxes').append( response ).masonry( 'reload' );
            $('.panel').hide("slow");
        }
    );
 });

});

add_action('wp_ajax_loop_fav', 'loop_fav');
function loop_fav(){
 wpfp_shortcode_func();

 exit;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:37:45.067

*如果我的问题是正确的。*

添加 url 而不是`#`,

```
<a id="fav" class="trigger-loop" href="mysite.com/my-favorites"><div id="favorite-icon"></div></a> 
```

并且在您的`click`函数中，`return false;`因此您的页面不会跳转到指定的 url 而是执行 ajax。

```
 $('#fav.trigger-loop').click(function(){
     ... your code...
     ... your code....
     return false; 

 }) 
```

# ios - quartz 2D image alpha masking

> ID：11277466
> 
> 赞同：1
> 
> 时间：2012-06-30T20:34:24.647
> 
> 标签：ios, ios5, quartz-2d

found this little code snippet that seems to do what i want, but im getting yelled at by xcode saying self.CGimage isnt a property of my view controller. (which makes sense since thats a UIimage property). What changes would i need to make to this code for it to be functional? Thanks!

```
- (UIImage*) maskImage:(UIImage *)image withMask:(UIImage *)maskImage {

    CGContextRef mainViewContentContext;
    CGColorSpaceRef colorSpace;
    UIImage* tempImage;

    colorSpace = CGColorSpaceCreateDeviceRGB();

    // create a bitmap graphics context the size of the image
    mainViewContentContext = CGBitmapContextCreate (NULL, image.size.width, image.size.height, 8, 0, colorSpace, kCGImageAlphaPremultipliedLast);

    // free the rgb colorspace
    CGColorSpaceRelease(colorSpace);

    CGImageRef maskingImage = [maskImage CGImage];
    CGContextClipToMask(mainViewContentContext, CGRectMake(0, 0, maskImage.size.width, maskImage.size.height), maskingImage);
    CGContextDrawImage(mainViewContentContext, CGRectMake(0, 0, image.size.width, image.size.height), self.CGImage);

    // Create CGImageRef of the main view bitmap content, and then
    // release that bitmap context
    CGImageRef mainViewContentBitmapContext = CGBitmapContextCreateImage(mainViewContentContext);

    // convert the finished resized image to a UIImage
    UIImage *theImage = [UIImage imageWithCGImage:mainViewContentBitmapContext];
    // image is retained by the property setting above, so we can
    // release the original

    CGContextRelease(mainViewContentContext);
    CGImageRelease(mainViewContentBitmapContext);
    maskingImage = nil;
    CGImageRelease(maskingImage);
    // return the image
    return theImage;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:39:27.160

Try replacing `self.CGImage` with `image.CGImage`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:43:56.990

Place this method in a UIImage category (or subclass).

# iphone - 从后台线程访问实例变量

> ID：11277467
> 
> 赞同：3
> 
> 时间：2012-06-30T20:34:25.287
> 
> 标签：iphone, objective-c, ios, multithreading

假设我有一个已分配和初始化的实例变量 MyObject。然后说我这样做：

```
[backgroundThread performBlock:^{
    //do something with MyObject that might take some time
}];

[self dismissModalViewController]; //this releases all instance variables, right? 
```

所以发生的事情是我有一个`NSManagedObjectContext`调用`backgroundThread`，它在后台对一个对象做一些工作。这立即返回并在后台完成工作，然后`dismissModalViewController`被调用，释放所有实例变量。那么，如果模态视图现在已被解除，但`backgroundThread`仍需要使用该对象怎么办？这是一个问题吗？解决方法是什么？

还有一件事：这个 MyObject 被插入到托管对象上下文 backgroundThread 中。这是否意味着这个 NSManagedObjectContext 将保留对象，即使在关闭视图之后也是如此？

我正在使用ARC。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:57:03.547

您需要在这里考虑几件事。首先请记住，该块将捕获它所指的任何内容。因此，您可能不需要做任何特别的事情，并且您的代码会正常工作，具体取决于您在块中所做的事情。块捕获的规则在 Apple 的[块编程主题](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxVariables.html#//apple_ref/doc/uid/TP40007502-CH6-SW2)文档中进行了描述，每个变量的处理方式取决于其类型。尤其，

> 在手动引用计数的环境中，复制块时保留块内使用的局部变量。在块中使用实例变量将导致对象本身被保留。如果您希望为特定对象变量覆盖此行为，您可以使用 __block 存储类型修饰符对其进行标记。
> 
> 如果您使用 ARC，对象变量会在复制块并稍后释放时自动保留和释放。

要考虑的另一件事是对实例变量的访问可能是线程安全的，也可能不是线程安全的。通过声明为 as 的属性访问实例变量`atomic`是朝着正确方向迈出的一步，但您可能需要使用互斥锁或其他技术来同步访问，具体取决于具体情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:39:43.863

如果要引用 ivars 或（模态）视图控制器的其他属性，则需要确保模态视图控制器仍然存在。

[这是来自Apple 文档`dismissModalViewControllerAnimated:`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/dismissModalViewControllerAnimated%3a)的一个潜在有用的提示：

> 如果要保留对接收者呈现的视图控制器的引用，请在调用此方法之前获取 modalViewController 属性中的值。

另一个可能可行的想法是创建和实例化一个单独的对象，该对象封装您要从视图控制器或任何其他线程访问的数据/对象。

# php - 如何通过 AJAX 将循环数据从 html 页面传递到 php 页面

> ID：11277471
> 
> 赞同：0
> 
> 时间：2012-06-30T20:35:06.027
> 
> 标签：php, javascript, ajax

如何使用 ajax 将循环数据从 html 页面发送到 php 页面。我很努力，但我没有办法将循环数据传递到 php 页面。

order.html 页面代码描述如下：

```
<html>
<body>

<script language="javascript" type="text/javascript">
<!-- 
//Browser Support Code
function ajaxFunction(){
    var ajaxRequest;  // The variable that makes Ajax possible!

    try{
        // Opera 8.0+, Firefox, Safari
        ajaxRequest = new XMLHttpRequest();
    } catch (e){
        // Internet Explorer Browsers
        try{
            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try{
                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e){
                // Something went wrong
                alert("Your browser broke!");
                return false;
            }
        }
    }
    // Create a function that will receive data sent from the server
    ajaxRequest.onreadystatechange = function(){
        if(ajaxRequest.readyState == 4){
            var ajaxDisplay = document.getElementById('ajaxDiv');
            ajaxDisplay.innerHTML = ajaxRequest.responseText;
        }
    }
    var age = document.getElementById('age[]').value;
    var queryString = "?age=" + age ;
    ajaxRequest.open("GET", "example.php" + queryString, true);
    ajaxRequest.send(null); 
}

//-->
</script>

<form name='myForm'>
Name: <input type='text' id='age[]' Name='age[]' /> <br />
Name: <input type='text' id='age[]' Name='age[]'/>
<br />
<input type='button' onclick='ajaxFunction()' value='Query MySQL' />
</form>
<div id='ajaxDiv'>result will display here</div>
</body>
</html> 
```

example.php 页面代码描述如下：

```
<?php

$len = count($_GET['age']);

for($x=0;$x<$len;$x++)
{

echo $service[$x]=$_GET['age'][$x];

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:42:44.610

[] 应该附加到查询字符串，而不是输入名称

```
var queryString = "?age[]=" + age1 + "&age[]=" + age2 + "&age[]=" + age3 ;
ajaxRequest.open("GET", "example.php" + queryString, true); 
```

# templates - 实现 WP 风格板的熨斗

> ID：11277477
> 
> 赞同：2
> 
> 时间：2012-06-30T20:35:37.243
> 
> 标签：templates, node.js, flatiron.js

我将如何将我的导航插入到我的 html 文件中，如下所示。（某种wordpress风格）

主页.html：

```
<html>
 <body>
   (I dont know what to put here for nav)

   <div main>
   </div>
 </body>
<html> 
```

导航.html

```
<nav>
 <img scr="logo.png">
 <ul>
  <li>home</li>
 </ul>
</nav> 
```

然后如何在带板上实现模板？

注意：我用的是熨斗、盘子、导演

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T23:03:39.263

Plates 不支持将 html 注入另一个字符串的方法。

它用于将 DATA 绑定到您的标记。

最简单的解决方案是使用可以按顺序连接的文件以形成您想要的页面。

例子：

*   header.html
*   免责声明.html
*   page1.html
*   page2.html
*   page3.html
*   页脚.html

在选择了您需要的组件（比如 header.html、page2.html 和 footer.html）之后，您可以使用板块将数据绑定到页面标记并将所有内容发送回客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T22:59:27.933

Plates 确实支持局部，请参阅[https://github.com/flatiron/plates#partials](https://github.com/flatiron/plates#partials)。

这是另一种方法（可能是在 Plates 明确支持 partials 之前）：

[https://stackoverflow.com/a/10076623/263447](https://stackoverflow.com/a/10076623/263447)

# mysql - Mysql查询返回每个不同字段的出现次数

> ID：11277478
> 
> 赞同：0
> 
> 时间：2012-06-30T20:35:45.273
> 
> 标签：mysql

我有下表，我将如何返回每个出现的`id`次数`status=pass`

```
id  status
111 pass
111 fail
333 pass
222 pass
333 pass
222 fail 
```

所以结果集看起来像这样

```
id  num_occurrences
111 1
222 1
333 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:37:02.280

试试这个：：

```
 select id, count(id) as num_occurrences from table where status="pass" group by id 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-30T20:39:54.460

查询可能看起来像这样

```
SELECT COUNT(id) AS num_occurrences FROM tableName WHERE status = 'pass'

```

但有一件事。id 通常是唯一的，你不应该称它为 columnname id

# c++ - 大目录中的快速访问

> ID：11277479
> 
> 赞同：0
> 
> 时间：2012-06-30T20:36:01.883
> 
> 标签：c++, windows-7, c++11, ntfs, b-tree

我有一百万个文本文件（内容约为 1kB），并在 Windows 7 的 C++ 程序中反复获取一个随机文件（FindFirstFile）的句柄。我相信 NTFS 的 b+ 树方法很快就能做到这一点，但是，因为我知道这些文件没有改变，我希望这个过程在 RAM 上完成得更快（即，在一些预加载后没有硬盘读取）。

我可以预加载所有一百万个文件（ReadFile，或类似地使用 CreateFileMapping），但我不知道如何将 b+ 树放入 RAM。是否有一个简单的解决方案或 API，我不需要从头开始构建新树？有没有更快的方法？

我也不想建立目录树；我只想将所有文件放在一个文件夹中，并尽可能利用 NTFS 的树方法；我正在寻找“CreateDirectoryMapping”功能。（另外，在我第一次使用 b+ 树之后，Windows 是否有可能自动将它缓存在 RAM 中？我猜不是，这就是为什么我要故意为这个问题缓存它。）

# jruby - 使用控制台 2 启动 JRubyStack

> ID：11277480
> 
> 赞同：0
> 
> 时间：2012-06-30T20:36:06.510
> 
> 标签：jruby, console2

我在 Windows 中安装了 JRuby Stack 环境，它使用默认的 windows cmd 作为控制台。我想使用 Console 2 但不幸的是我不知道如何配置它。

我尝试在控制台和 Shell 中创建一个新选项卡，我给了它路径

```
"C:\Program Files\BitNami JRubyStack\use_jruby.bat" 
```

不幸的是，这个 bat 默认打开 CMD：

@echo 关闭

```
CALL C:\PROGRA~1\BITNAM~1\scripts\setenv.bat"
cd "C:\Program Files\BitNami JRubyStack"
START "BitNami JRubyStack Environment" cmd 
```

所以..有什么想法吗？谢谢！

# ruby-on-rails - 设计 find_for_authentication 不使用多个身份验证密钥触发

> ID：11277490
> 
> 赞同：0
> 
> 时间：2012-06-30T20:37:06.737
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-3.2

我有两个设计模型：用户和成员

因此，我在模型本身而不是在 Devise 初始化程序中指定身份验证密钥。

会员.rb

```
devise :database_authenticatable, :registerable,
    :recoverable, :rememberable, :trackable, :validatable, :omniauthable, :authentication_keys => [:email, :subdomain] 
```

我也覆盖

```
 def self.find_for_authentication(conditions={})
    debugger
    conditions[:account_id] = Account.find_by_subdomain(conditions.delete(:subdomain)).id
    super(conditions)
  end 
```

不幸的是，当 authentication_keys 有多个密钥时，我的 find_for_authentication 方法似乎没有被触发。当我只指定一个键时工作正常。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T07:32:39.107

subdomain 应该是 request_key，因为它是请求的一部分。

```
request_keys => [:subdomain] 
```

# android - 当 TabHost 存在于活动中时，EditText 使用硬键盘失去焦点

> ID：11277491
> 
> 赞同：3
> 
> 时间：2012-06-30T20:37:08.173
> 
> 标签：android, actionbarsherlock

我在 tabhost 中显示一个 EditText。Tabhost 位于 SherlockFragmentActivity 中。

假设我处于触摸模式并单击 EditText 以使其获得焦点并开始在其上输入。输入 2-3 个字符后，我决定使用我的硬键盘。一旦按下第一个硬键，我就会退出触摸模式，这也会导致焦点移回当前选定的选项卡。只要我不使用硬导航键将焦点带回我的 EditText，我将无法输入 EditText。

仅当 TabHost 不在 TabActivity 内时才会出现此问题。

重现此问题的快速示例代码可能是 - ActionBarSherlock 示例代码的 FragmentTabs 活动。选择 CustomTab 并尝试使用硬键盘在操作栏中的搜索视图内键入任何文本。查看焦点只需移动到选项卡。

问题在 android 2.2、4.0 和使用 ICS 模拟器上是可重现的。

有没有人有更多信息。关于这个问题？

（这里似乎提到了一种解决方法：[https](https://stackoverflow.com/a/8684025/333137) ://stackoverflow.com/a/8684025/333137 ，但它看起来像一个黑客）

谢谢。

编辑：经过更多调查，我在 TabHost 类中发现了 setup() 函数，只有在 TabActivity 中未使用 TabHost 时才需要调用该函数。它注册一个按键监听器，仅在按下硬键时接收回调。

```
void setup(){
       // KeyListener to attach to all tabs. Detects non-navigation keys
        // and relays them to the tab content.
        mTabKeyListener = new OnKeyListener() {
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                switch (keyCode) {
                    case KeyEvent.KEYCODE_DPAD_CENTER:
                    case KeyEvent.KEYCODE_DPAD_LEFT:
                    case KeyEvent.KEYCODE_DPAD_RIGHT:
                    case KeyEvent.KEYCODE_DPAD_UP:
                    case KeyEvent.KEYCODE_DPAD_DOWN:
                    case KeyEvent.KEYCODE_ENTER:
                        return false;

                }
                **mTabContent.requestFocus(View.FOCUS_FORWARD);**
                return mTabContent.dispatchKeyEvent(event);
            } 
```

我不确定它为什么要调用 requestFocus(View.FOCUS_FORWARD) 但这并没有将焦点设置到其中的 EditText （它应该这样做？）。此外，在操作栏中的搜索视图的情况下，它完全在选项卡之外。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-20T12:42:26.160

如下覆盖 TabHost，它对我有用。

```
public class TabHostExt extends TabHost {

    public TabHostExt(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public TabHostExt(Context context) {
        super(context);
    }

    @Override
    public void onTouchModeChanged(boolean isInTouchMode) {
        // leave it empty here. It looks that when you use hard keyboard,
        // this method will be called and the focus will be token.
    }
} 
```

# visual-studio-2010 - 是否可以在 VS 2010 中以编程方式设置跟踪点？

> ID：11277492
> 
> 赞同：1
> 
> 时间：2012-06-30T20:37:30.130
> 
> 标签：visual-studio-2010

这是参考 Visual Studio 自动化界面。可以使用以下方法在程序中设置断点：

```
EnvDTE.Debugger.Breakpoints.Add(...) 
```

但是，我认为不可能以这种方式配置跟踪点。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T06:01:11.567

查看这篇[文章](https://stackoverflow.com/questions/791930/how-to-programatically-add-a-tracepoint-for-visual-studio)中的答案，尤其是[Breakpoint2](http://msdn.microsoft.com/en-us/library/envdte80.breakpoint2.aspx)接口的[BreakWhenHit](http://msdn.microsoft.com/en-us/library/envdte80.breakpoint2.breakwhenhit.aspx) = false、[Message](http://msdn.microsoft.com/en-us/library/envdte80.breakpoint2.message.aspx)和[Macro](http://msdn.microsoft.com/en-us/library/envdte80.breakpoint2.macro.aspx)属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T14:57:52.297

或者你也可以看看像 Log4Net 这样的日志框架。

# java - 为什么 java.nio.charset.Charsets 编译错误？

> ID：11277494
> 
> 赞同：0
> 
> 时间：2012-06-30T20:38:17.433
> 
> 标签：java, javac

`import java.nio.charset.Charsets`在我的类 UriCodec.java 中，但是当我使用 javac(jdk6) 编译此类错误时。例如：javac UriCodec.java

错误代码：

```
import java.nio.charset.Charsets;
                       ^
UriCodec.java:140: Can not find symbol
symbol： Variable Charsets
position： class com.android.exchange.utility.UriCodec
        appendEncoded(builder, s, Charsets.UTF_8, false);
                                  ^
UriCodec.java:144: Can not find symbol
symbol： Variable Charsets
position： class com.android.exchange.utility.UriCodec
        appendEncoded(builder, s, Charsets.UTF_8, true);
                                  ^
UriCodec.java:203: Can not find symbol
symbol： Variable Charsets
position： class com.android.exchange.utility.UriCodec
        return decode(s, false, Charsets.UTF_8);
                                ^
UriCodec.java:214: Can not find symbol
symbol： Method toHexString(byte,boolean)
position： class java.lang.Byte
        sb.append(Byte.toHexString(b, true));
                      ^
5 error 
```

我的课：

```
import java.nio.charset.Charset;
import java.nio.charset.Charsets;
public abstract class UriCodec {

    public final void appendEncoded(StringBuilder builder, String s) {
        appendEncoded(builder, s, Charsets.UTF_8, false);
    }

    public final void appendPartiallyEncoded(StringBuilder builder, String s) {
        appendEncoded(builder, s, Charsets.UTF_8, true);
    }

    public static String decode(String s) {
        return decode(s, false, Charsets.UTF_8);
    }

   public final String encode(String s, Charset charset) {
        // Guess a bit larger for encoded form
        StringBuilder builder = new StringBuilder(s.length() + 16);
        appendEncoded(builder, s, charset, false);
        return builder.toString();
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-30T20:48:39.953

没有这样的类`Charsets`。有[`Charset`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html)（单数）但那不是一回事......

我怀疑你收到了这样的消息：

```
UriCodec.java:1: error: cannot find symbol
import java.nio.charset.Charsets;
                       ^
  symbol:   class Charsets
  location: package java.nio.charset
1 error 
```

当您收到编译器错误时，**请阅读它**。如果编译器说它找不到符号，那么通常有一个很好的理由 - 所以仔细检查你是否正确拼写了所有内容，并使用了正确的大小写。

将您的导入更改为

```
import java.nio.charset.Charset; 
```

一切都应该很好。

...或者如果您的意思是不同的`Charsets`类（例如[Guava 中的类），您应该为](https://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/base/Charsets.html)*该类*添加一个导入。

# c - 调用自动工具以创建构建系统的顺序是什么？

> ID：11277495
> 
> 赞同：1
> 
> 时间：2012-06-30T20:38:35.627
> 
> 标签：c, autotools

我正在尝试使用 autotools 为 C 程序创建构建系统。但是，看完之后`info automake`，我还是很困惑开发者调用哪些工具的顺序。

让我们考虑一个非常简单的 hello world 应用程序。在应用程序的根目录中，只有简单的`src/hello.c`东西。需要按什么顺序调用什么工具来创建`configure`和一个`Makefile`？

我自己想通了（部分阅读文档，部分只是尝试），`autoscan`它首先生成并生成`configure.ac`. 然后`autoheader`貌似创建了一个头文件（为什么？）。接下来`autoconf`最终创建`configure`脚本，该脚本最终将创建一个`config.h`.

但是，我仍然缺少一个`Makefile`我认为是由 创建的`automake`，但这需要一个`Makefile.am`我不知道如何生成的。这个文件是完全生成的还是由开发人员手写的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T05:07:00.700

自动工具的功能往往在边缘模糊。有一个不错的流程图描述了[这里](http://www.developingprogrammers.com/index.php/2006/01/05/autotools-tutorial/)的排序。通常`Makefile.am`是手写的。许多项目在源代码树的顶层保留一个简单的 shell 脚本，即，`autogen.sh`或`initgen.sh`. 我`autogen.sh`使用：

```
#! /bin/sh

case `uname` in Darwin*) glibtoolize --copy ;;
    *) libtoolize --copy ;; esac

aclocal -I m4 --install
autoheader
autoconf

automake --foreign --add-missing --force-missing --copy 
```

[这](http://www.freesoftwaremagazine.com/books/autotools_a_guide_to_autoconf_automake_libtool)仍然是我见过的最好的实用指南之一。我相信它也有书本形式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T10:48:46.317

你的 Makefile.am 应该看起来像

```
bin_PROGRAMS = hello
AUTOMAKE_OPTIONS = foreign
hello_SOURCES = src/hello.c 
```

运行 automake 它将创建一个 Makefile.in

# algorithm - 使用后缀数组的最小字典旋转

> ID：11277498
> 
> 赞同：4
> 
> 时间：2012-06-30T20:38:57.783
> 
> 标签：algorithm, suffix-array

```
 Consider a string of length n (1 <= n <= 100000). 
    Determine its minimum lexicographic rotation. 
    For example, the rotations of the string “alabala” are:

    alabala

    labalaa

    abalaal

    balaala

    alaalab

    laalaba

    aalabal

    and the smallest among them is “aalabal”. 
```

这是 ACM ICPC 2003 的问题。其他用户已经在堆栈流中询问过这个问题。[但这没有用，我想通过后缀 Array 来解决。]

如何使用后缀数组来解决这个问题？

直到现在我做了什么？

(1) 假设给定的字符串是 S。

我将字符串 S 与自身连接起来得到一个字符串 S'。

IE。S'=S+S。

(2).然后我在O(nlog n )时间内找到了S'的后缀数组。

```
For example:
    S=alabala
    S'=alabalaalabala

Suffix No. Index    Suffixes

0       13      a
1       6       aalabala
2       9       abala
3       2       abalaalabala
4       11      ala
5       4       alaalabala
6       7       alabala
7       0       alabalaalabala
8       10      bala
9       3       balaalabala
10      12      la
11      5       laalabala
12      8       labala
13      1       labalaalabala 
```

所以我很好地计算了后缀数组SA，SA[]={13,6,9,2,11,4,7,0,10,3,12,5,8,1}。

我还计算了每个后缀的 LCPs b/w [虽然我不相信我会在这个问题中需要它]。

现在**如何进一步进行。如何使用 SA 来获得所需的结果？**

用一个非常*小的例子来解释会非常*有效*。

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:13:43.507

看来您应该在 SA 中取第一个后缀，该索引在 0 和 length(S) - 1 之间。

一些解释：S 的所有旋转都在 S' 后缀的开头，从 0 到 length(S) - 1 之间的位置。后缀数组按字典顺序保持后缀，所以你只需要选择从 S 的旋转开始的第一个.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T22:41:42.013

如果您使用 O(n log n) 算法（按第一个字母排序，然后按前两个字母排序，然后按前四个字母排序，...），您可以制作一些修改后的后缀数组。

不要对字符串的后缀进行排序，但它是循环旋转。它应该是算法中的非常小的修改。A 然后你会直接得到想要的结果。

如果你仍然想使用你的方法，那么只需取第一个索引，它在 0 和 N 之间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T04:18:13.040

谢谢大家。vkorchagin 和 usamec 的答案对于大多数测试用例都是正确的，但它们不适用于以下测试用例（S="baabaa"）

S=咩咩；S'=巴巴巴巴巴；

```
Suffix| Suffix  |  Suffixes
Index | Length  |

11      1       a
10      2       aa
7       5       aabaa
4       8       aabaabaa
1       11      aabaabaabaa
8       4       abaa
5       7       abaabaa
2       10      abaabaabaa
9       3       baa
6       6       baabaa
3       9       baabaabaa
0       12      baabaabaabaa 
```

*取索引在 0 到 S.length()-1 之间的第一个后缀*不适用于上述测试用例。如果我这样做，则结果为 4，但正确答案为 1。

所以我修改了答案，有点。

这就是我对上述答案所做或添加/修改的额外条件::

(1)我取了索引在 0 到 S.length()-1 之间的第一个后缀。

可以说它的索引是:=ExpectedIdx。

在上面的示例中，ExpectedIdx=4。

(2).现在 ExpectedIdx 可能是也可能不是答案。原因是后缀数组中的下一个后缀可能会产生相同的答案。

例子 ：：

取起始索引为 4 的后缀（ExpectedIdx），`aabaab`aa.，我们得到`aabaab`最小 Lexograhic 旋转字符串。

取下一个后缀`aabaab`aabaa。

我们还得到`aabaab`了最小 Lexograhic 旋转字符串。

但是前者需要 4 的移位，而后者需要 1 的移位。**所以正确答案是1，而不是4。**

所以我使用最长公共前缀（LCP）的概念来检查相似性并最终被接受。[http://livearchive.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=756](http://livearchive.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=756)

编辑:: 这是伪代码 -

```
int ExpectedIdx,ExpectedSuffixNumber,ExpectedSuffixLength;
for(int i=0;i<strlen(str);++i)//str = Length of S'
{
    suffixsize=strlen(str)-SA[i];
    if(suffixsize>(Len/2))//Len/2:=Size of S
    {
        ExpectedIdx=SA[i];
        ExpectedSuffixNumber=i;
        ExpectedSuffixLength=suffixsize;
        break;
    }
}
//Now this ExpectediDx may or may not be the correct answer.

int finalans=ExpectedIdx;//Lets assume initially that ExpectedIdx is a correct/final answer.
for(int i=(ExpectedSuffixNumber+1);i<Len;++i)//Check the Next Suffix 
{
    if(LCP[i]>Len/2)//LCP[i]=Lingest common prefix of adjacent prefixes in a suffix Array.
    {
        if(SA[i]>finalans)
        {
            finalans=SA[i];
        }
    }
    else
        break;
} 
```

# c++ - 如何在给定视图空间深度值和 ndc xy 的情况下恢复视图空间位置

> ID：11277501
> 
> 赞同：7
> 
> 时间：2012-06-30T20:39:14.333
> 
> 标签：c++, glsl, shader, coordinate-transformation, perspectivecamera

我正在编写一个延迟着色器，并试图更紧密地打包我的 gbuffer。但是，给定视图空间深度，我似乎无法正确计算视图位置

```
// depth -> (gl_ModelViewMatrix * vec4(pos.xyz, 1)).z; where pos is the model space position
// fov -> field of view in radians (0.62831855, 0.47123888)
// p -> ndc position, x, y [-1, 1]
vec3 getPosition(float depth, vec2 fov, vec2 p)
{
    vec3 pos;
    pos.x = -depth * tan( HALF_PI - fov.x/2.0 ) * (p.x);
    pos.y = -depth * tan( HALF_PI - fov.y/2.0 ) * (p.y);
    pos.z = depth;
    return pos;
} 
```

计算的位置是错误的。我知道这一点，因为我仍在 gbuffer 中存储正确的位置并使用它进行测试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-09-08T14:36:30.630

## 3 透视投影中恢复视空间位置的解决方案

投影矩阵描述了从场景的 3D 点到视口的 2D 点的映射。它从视图（眼睛）空间转换到剪辑空间，剪辑空间中的坐标通过除以剪辑坐标的*w*分量转换为归一化设备坐标（NDC）。NDC 在 (-1,-1,-1) 到 (1,1,1) 范围内。

在透视投影中，投影矩阵描述了从针孔相机看到的世界中的 3D 点到视口的 2D 点的映射。
相机平截头体（截断的金字塔）中的眼睛空间坐标映射到立方体（标准化设备坐标）。

[![](../Images/48f5de11eb24067a8d4ea0a3a3fb7dd5.png)](https://i.stack.imgur.com/9dzTm.png)

透视投影矩阵：

```
r = right, l = left, b = bottom, t = top, n = near, f = far

2*n/(r-l)      0              0               0
0              2*n/(t-b)      0               0
(r+l)/(r-l)    (t+b)/(t-b)    -(f+n)/(f-n)    -1    
0              0              -2*f*n/(f-n)    0 
```

它遵循：

```
aspect = w / h
tanFov = tan( fov_y * 0.5 );

prjMat[0][0] = 2*n/(r-l) = 1.0 / (tanFov * aspect)
prjMat[1][1] = 2*n/(t-b) = 1.0 / tanFov 
```

在透视投影中，Z 分量由**有理函数**计算：

```
z_ndc = ( -z_eye * (f+n)/(f-n) - 2*f*n/(f-n) ) / -z_eye 
```

深度 (`gl_FragCoord.z`和[`gl_FragDepth`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/gl_FragCoord.xhtml)) 计算如下：

```
z_ndc = clip_space_pos.z / clip_space_pos.w;
depth = (((farZ-nearZ) * z_ndc) + nearZ + farZ) / 2.0; 
```

### 1\. 视野和纵横比

由于投影矩阵是由视野和纵横比定义的，因此可以利用视野和纵横比来恢复视口位置。假设它是一个对称的透视投影和归一化的设备坐标，深度和近远平面是已知的。

恢复视图空间中的 Z 距离：

```
z_ndc = 2.0 * depth - 1.0;
z_eye = 2.0 * n * f / (f + n - z_ndc * (f - n)); 
```

通过 XY 归一化设备坐标恢复视图空间位置：

```
ndc_x, ndc_y = xy normalized device coordinates in range from (-1, -1) to (1, 1):

viewPos.x = z_eye * ndc_x * aspect * tanFov;
viewPos.y = z_eye * ndc_y * tanFov;
viewPos.z = -z_eye; 
```

### 2\. 投影矩阵

由视场和纵横比定义的投影参数存储在投影矩阵中。因此，视口位置可以通过投影矩阵中的值从对称透视投影中恢复。

注意投影矩阵、视野和纵横比之间的关系：

```
prjMat[0][0] = 2*n/(r-l) = 1.0 / (tanFov * aspect);
prjMat[1][1] = 2*n/(t-b) = 1.0 / tanFov;

prjMat[2][2] = -(f+n)/(f-n)
prjMat[3][2] = -2*f*n/(f-n) 
```

恢复视图空间中的 Z 距离：

```
A     = prj_mat[2][2];
B     = prj_mat[3][2];
z_ndc = 2.0 * depth - 1.0;
z_eye = B / (A + z_ndc); 
```

通过 XY 归一化设备坐标恢复视图空间位置：

```
viewPos.x = z_eye * ndc_x / prjMat[0][0];
viewPos.y = z_eye * ndc_y / prjMat[1][1];
viewPos.z = -z_eye; 
```

### 3\. 逆投影矩阵

当然可以通过逆投影矩阵恢复视口位置。

```
mat4 inversePrjMat = inverse( prjMat );
vec4 viewPosH      = inversePrjMat * vec3( ndc_x, ndc_y, 2.0 * depth - 1.0, 1.0 )
vec3 viewPos       = viewPos.xyz / viewPos.w; 
```

另请参阅以下问题的答案：

*   [如何在片段着色器中使用 gl_FragCoord.z 在现代 OpenGL 中线性渲染深度？](https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh/45710371#45710371)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T10:15:01.030

我最终设法使它工作，由于它与上面的方法不同，我将详细说明它，以便任何看到这个的人都有解决方案。

*   Pass 1：将视图空间中的深度值存储到 gbuffer
*   在第二遍中重新创建 (x, y, z) 位置：
*   将弧度的水平和垂直视野传递到着色器中。
*   将近平面距离（near）传递给着色器。（从相机位置到近平面的距离）
*   想象一下从相机到片段位置的光线。这条射线在某个位置 P 与近平面相交。我们在 ndc 空间中有这个位置，并且想要在视图空间中计算这个位置。
*   现在，我们在视图空间中拥有了我们需要的所有值。我们可以利用相似三角形定律找到实际的片段位置 P'

    ```
    P = P_ndc * near * tan(fov/2.0f) // computation is the same for x, y
    // Note that by law of similar triangles, P'.x / depth = P/near  
    P'.xy = P/near * -depth; // -depth because in opengl the camera is staring down the -z axis
    P'.z = depth; 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-30T21:31:51.660

我写了一个延迟着色器，并使用这段代码重新计算屏幕空间定位：

```
vec3 getFragmentPosition()
{
     vec4 sPos = vec4(gl_TexCoord[0].x, gl_TexCoord[0].y, texture2D(depthTex, gl_TexCoord[0].xy).x, 1.0);
     sPos.z = 2.0 * sPos.z - 1.0;
     sPos = invPersp * sPos;

     return sPos.xyz / sPos.w;
} 
```

其中`depthTex`是保存深度信息的纹理，并且`invPersp`是预先计算的逆透视矩阵。您获取屏幕的片段位置，并将其乘以逆透视矩阵以获得模型视图坐标。然后除以`w`得到齐次坐标。乘以 2 和减 1 将深度从 [0, 1]（因为它存储在纹理中）缩放到 [-1, 1]。

此外，根据您使用的 MRT 类型，重新计算的结果不会完全等于存储的信息，因为您失去了浮点精度。

# mysql - 隐藏新列（别名列）

> ID：11277502
> 
> 赞同：0
> 
> 时间：2012-06-30T20:39:21.760
> 
> 标签：mysql, hide

我有一个如下所示的 mysql 表：

```
id    col2    col3      col4
1   value1    value2    3534
2   value1    value1    8456
3   value1    value2    3566
4   value1    value3    7345
5   value2    value3    6734 
```

我想做的是，选择不同的 col2+col3 值

```
id    col2    col3      col4
1   value1    value2    3534
2   value1    value1    8456
4   value1    value3    7345
5   value2    value3    6734 
```

我使用了下面的查询，我得到了想要的结果，如下***[所示](http://sqlfiddle.com/#!2/38f1c/14)。***

```
SELECT distinct(CONCAT(col2, col3)) as "dummy column", id, col2, col3, col4
FROM yourtable
GROUP BY CONCAT(col2, col3); 
```

## 我的问题是，

由于我不想在输出表中显示列“虚拟列”，我该如何隐藏它？

这个问题与旧问题有关

***[在mysql中选择不同的2列组合](https://stackoverflow.com/questions/11277251/selecting-distinct-2-columns-combination-in-mysql/11277389#11277389)***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:44:15.567

你为什么不尝试以下？

```
SELECT id, col2, col3, col4
FROM yourtable
GROUP BY col2, col3 
```

# javascript - 如何阻止 Google 使用加载了 Javascript 的问候语作为元描述

> ID：11277503
> 
> 赞同：0
> 
> 时间：2012-06-30T20:39:29.777
> 
> 标签：javascript, search-engine

我有一个 Javascript 问候语，它用 SO 的下拉横幅迎接新用户。它仅在 3 秒后才可见，当单击 X 时它会消失。由于我没有放置元描述标签，谷歌在每个页面上都将问候语显示为元数据。我不明白为什么谷歌会使用这个，因为它没有立即加载，如果我使用元描述，这会停止发生吗？

我应该使用元描述吗？从好的方面来说，它可能有助于解决这个问题，但 Google 将无法从该站点（恰好是一个论坛）动态获取数据。碰巧它正在这样做，我不知道为什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:48:56.830

我最好的猜测是您的问候语中的文本被添加到服务器端的页面（wordpress插件？）中可见（即使禁用javascript也会显示），在页面加载时被javascript隐藏，然后在3之后显示秒（即它确实已经存在，因此是谷歌发现的第一个主要文本）。

尝试更改您的问候插件/代码以在页面加载后生成包含问候消息的 div，或者至少将其附加到文档的末尾（或应用`style="display:none;"`为内联样式，以便 Google 可以看到它）在服务器上 -然后调整 js 以显示它。它不再会在禁用 js 的情况下迎接访问者，但也会允许 google 在不遇到问候语的情况下访问您的主要内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:21:25.670

这样做是因为它是解析 DOM 时找到的第一个可读的文本位。我不确定谷歌在将页面状态保存到缓存之前是否存在延迟，但这无关紧要。我实际上使用谷歌的这个“功能”来允许我操纵网站列表在搜索列表中所说的内容。如果您不希望它出现，只需将消息的代码移动到您的`<body>s`节点列表的底部（即在您关闭之前将其放置`</body>`）。

display:none 不会做任何必须移动的事情，以便在解析 DOM 节点树时它不在前几行可读的文本中。

# spring - @Configuration 和 Bean 属性设置注解

> ID：11277505
> 
> 赞同：0
> 
> 时间：2012-06-30T20:39:51.390
> 
> 标签：spring

我正在使用 @Configuration 创建 bean 并从其他 bean 属性设置它们的属性，例如可以使用 xml 配置

```
@Configuration
public class AppConfig {

    @Bean
    public MyBean myBean(@Value("#{someObject.value}") double value) {
        MyBean myBean = new MyBean();
        myBean.setValue(value);
        return myBean;
    }

    @Bean
    public SomeObject someObject() {
        SomeObject someObject = new SomeObject();
        someObject.setValue(1.0);
        return someObject;
    }
} 
```

但是，必须使用 setter 方法很麻烦且没有必要[例如。myBean.setValue(值)]。相反，我想要这样的东西：

```
@Configuration
public class AppConfig {

    @Bean
    @MysticalPropertySetter(name="value", value="#{someObject.value}")
    public MyBean myBean() {
        return new MyBean();
    }

    @Bean
    @MysticalPropertySetter(name="value", value="1.0", type="java.lang.Double")
    public SomeObject someObject() {
        return new SomeObject();
    }
} 
```

这样的事情可能吗？非常感谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T05:56:35.520

我认为这种方法是不可能的，因为在使用 @Bean 注释的工厂方法中，您手动创建对象，但是 Spring 只能将属性注入到自身实例化的 bean 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T19:18:02.203

构造函数注入怎么样？

```
@Bean
public MyBean myBean(@Value("#{someObject.value}") double value) {
    return new MyBean(value);
} 
```

# php - 通过jQuery克隆的输入字段不会提交

> ID：11277507
> 
> 赞同：0
> 
> 时间：2012-06-30T20:40:03.760
> 
> 标签：php, jquery, submit, clone

我有一组隐藏的输入字段，它们在页面加载和/或单击按钮时被克隆。

html:

```
<div class="book_form" id="book_form_hidden">
   <input type="checkbox" name="select" class="sell_checkbox" />
   <h1>ISBN:</h1>
   <input type="text" name="isbn" class="input_large" maxlength="20" />
   <h1>Condition:</h1>
   <input type="text" name="condition" class="input_medium" maxlength="100" />
   <h1>Price:</h1>
   <input type="text" name="price" class="input_price" maxlength="3" />
   <input type="hidden" name="title" value="">
   <input type="hidden" name="author" value="">
   <input type="hidden" name="publisher" value="">
   <input type="hidden" name="thumbnail" value="">
</div> 
```

jQuery：

```
function addOne() {
    var clone = $("#book_form_hidden").clone().removeAttr("id");
    clone.find("input").each(function() {
        $(this).attr("name", $(this).attr("name") + "[" + n + "]");
    });
    n++;
    clone.appendTo($("#form_container"));
} 
```

当我使用常规提交按钮提交表单并将数据发送到 PHP 时，不会提交通过 jQuery 创建的输入，而只会提交最初隐藏的输入字段（并且具有空值）。

我是否需要使用 AJAX 提交动态创建的表单内容？我很困惑。

非常感谢你的帮助。

# c - 为什么这不适用于 c 中的 printf()

> ID：11277513
> 
> 赞同：3
> 
> 时间：2012-06-30T20:41:01.383
> 
> 标签：c, string, printf

我有以下代码：

```
 int i=1;
    printf((i==1)?" ":"   " "hello");
    printf(" " "hello"); 
```

我很惊讶地看到第一个`printf`只给出一个空格作为输出，第二个`printf`输出一个空格，后跟字符串*hello*。在第一个的情况下，我期待像第二个这样的输出。但是这里有什么我想念的吗。请在这件事上给予我帮助 ...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-30T20:44:49.993

字符串文字连接是一个词法特性，这意味着：

```
(i==1) ? " " : "   " "hello" 
```

与此相同：

```
(i==1) ? " " : "   hello" 
```

现在应该很明显为什么你会得到你得到的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:43:19.120

`i == 1`为真，因此三元运算符计算为两个选项中的第一个，`" "`. 一点也不奇怪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T20:44:52.687

C 自动将两个相邻的字符串文字组合在一起。

所以你的第二个 printf: 的参数`" " "hello"`被连接在一起成为`" hello"`，然后正常打印出来。

其他答案已经解释了为什么您的第一个 printf 以它的方式工作，这应该很明显。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T20:44:42.913

由于在三元运算符 ( `i==1`) 中测试的条件计算结果为真，因此它在 . 之后立即返回表达式`?`。

[三元运算符](http://en.wikipedia.org/wiki/Ternary_operation#C.2C_Java.2C_JavaScript)的语义是这样的：

```
test_something?if_true:not_true 
```

您的`printf`陈述应有的作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-30T20:48:52.903

您混淆的根源是对何时执行连接的误解。连接两个连续的字符串文字是由编译器在编译时完成的，而不是由您的程序在运行时完成的。因此，只有一种方法可以解析第一个 printf：两个字符串文字都属于表达式的“else”分支。您可以通过将 i 设置为零并观察输出来测试它。

# python - 如何在python中旋转乌龟形状

> ID：11277518
> 
> 赞同：5
> 
> 时间：2012-06-30T20:42:36.347
> 
> 标签：python, for-loop, python-3.x, rotation, turtle-graphics

我在轮盘赌游戏中将乌龟的形状注册到轮盘赌轮盘。我希望轮子旋转 3 次。这是我的程序：

```
register_shape("wheel.gif")
wheel = None
wheel = turtle.Turtle()
wheel.ht()
wheel.shape("wheel.gif")

wheel.shapesize(5, 5)
wheel.pu()
wheel.ht()
wheel.goto(-200,-200)
wheel.st()
r = 1
for r in range(108):
    wheel.right(10) 
```

轮子正确显示，但似乎没有旋转。我认为这应该可行。如果没有，有没有其他办法。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-02-09T16:50:59.247

我对 Python 乌龟图形也有同样的问题。我通过在不同的旋转状态下注册不同的图像来规避它。然后您可以使用条件语句在每个特定状态下显示合适的图像。希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T03:44:03.403

根据方法的文档，我发现这是不可能的`register_shape()`：

> **注意：**转动乌龟时图像形状不会旋转，因此它们不会显示乌龟的航向！

参考：[http ://docs.python.org/library/turtle.html#turtle.register_shape](http://docs.python.org/library/turtle.html#turtle.register_shape)

* * *

然而，似乎还有其他两种方式可以*提供*`register_shape()`旋转，因为上述免责声明仅涉及图像形状。

 *1.  使用坐标绘制多边形。
2.  使用复合形状对象（复合形状由多个多边形组成）。*

# jquery - 使用鼠标单击浏览 div 序列

> ID：11277521
> 
> 赞同：0
> 
> 时间：2012-06-30T20:42:57.513
> 
> 标签：jquery, html, click, cycle

好的，这就是我想要做的：我试图简单地创建 DIVS 序列，将它们全部安排在一个主 DIV 中，然后 - 将它们全部放在一个绝对位置。之后，我尝试创建一个非常简单的 Jquery 函数，该函数将允许单击 DIV 并基本上浏览所有它们，一个一个直到最后一个。

这是一个例子：

```
<div id="slideshow">
     <div> any content here.. </div>
     <div> any content here.. </div>
     <div> any content here.. </div>
     <div> any content here.. </div>
     <div> any content here.. </div>
<div> any content here.. </div>
</div> 
```

**单击第一个 div 将循环所有的潜水，直到最后一个..**

这似乎很简单，但我无法在任何地方找到答案。我不想使用 JQuery Cycle Plugin - [http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/) 因为它需要大量编码和大量文件。只是一个简单的 Jquery 函数，它将允许它。

谁能帮忙？我需要两件事：

1.  循环遍历 div 直到结束然后停止（不循环）
2.  到达最后一个 div 时循环整个序列（仍然通过单击）

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:47:43.533

尝试`each()`方法：

```
$('#slideshow').click(function() {
  $('#slideshow div').each(function() {
     // do something here
  })
}) 
```

# javascript - Javascript验证不覆盖原始css表单颜色

> ID：11277525
> 
> 赞同：1
> 
> 时间：2012-06-30T20:43:26.827
> 
> 标签：javascript, html, forms, validation

谁能看到我可能在哪里犯错？表单文本框背景颜色最初设置为灰色。如果用户犯了错误，我想用红色边框将它们变成黄色。该功能有点*工作*，因为当表格填写不正确时，表格不会发送到服务器。但是css没有改变。如果我注释掉我的 js 调用，它将发布到服务器。以下是片段：

**CSS：**

```
 .invalid{
background-color:#ff9;
border: 2px red inset;
}

   .reqd{
background-color:#222222; 
color:#555555; border-style: solid; 
border-color:#555555; 
border-width: 1px;
 } 
```

**HTML：**

```
<!DOCTYPE html>
  <?php 
  // Debug
   error_reporting(E_ALL);
  ?>

<html lang="en">
 <head>
<meta charset="utf-8">
<link rel="stylesheet" href="styles.css" type="text/css">
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/regauth.js"></script>

    <title></title>
 </head>
 <body id="registerBody">
<section id="registerBox">

    <form id="registerForm" method="post" action="regauth.php">
    <p>Welcome to the atlas registraton! Please fill out the information below.</p>
    <br>
    <p><label for="firstName">First Name:&nbsp;&nbsp;<input type="text" size="30" id="firstName" name="firstName" class="reqd"></label></p>
    <p><label for="lastName">Last Name:&nbsp;&nbsp;<input type="text" size="30" id="lastName" name="lastName" class="reqd"></label></p>
    <p><label for="email">Email:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" size="30" id="email" name="email" class="reqd"></label></p>
    <br>
    <br>
    <p><label for="reqUsername">Username:&nbsp;&nbsp;<input type="text" size="30" id="reqUsername" name="reqUsername" class="reqd"></label></p>
    <p><label for="passOne">Password:&nbsp;&nbsp;<input type="password" size="30" id="passOne" name="passOne" class="reqd"></label></p>
    <p><label for="passTwo">Confirm Password:&nbsp;&nbsp;<input type="password" size="30" id="passTwo" name="passTwo" class="reqd"></label></p>
    <br>
    <br>
    <p><input type="submit" value="Submit">&nbsp;&nbsp;<input type="reset" value="Reset Form" class="reset"></p>

    </form> 
</section>
<script type="text/javascript">
$("#registerBox").css("margin-left", ($(window).width()-425)/2);
$("#registerBox").css("margin-top", ($(document).height()-500)/2);
$('#registerBox').fadeIn(1500);
</script>

   </body>

    </html> 
```

**JS (regauth.js)：** *由 Tom Negrino 提供，视觉快速入门指南：Javascript 第八版*

```
window.onload = initForms;

//Function loops through each form. For each one it adds an event handler to that forms 'onSubmit'.
function initForms() {
for (var i = 0; i < document.forms.length; i++) {
    document.forms[i].onsubmit = validForm;
     }
   }

function validForm() {
var allGood = true;
var allTags = document.getElementsByTagName("*");

for (var i = 0; i < allTags.length; i++) {
    if (!validTag(allTags[i])) {
        allGood = false;
    }
}
return allGood;

function validTag(thisTag) {
    var outClass = "";
    var allClasses = thisTag.className.split(" ");

    for (var j = 0; j < allClasses.length; j++) {
        outClass += validBasedOnClass(allClasses[j]) + " ";
    }
    thisTag.className = outClass;

    if (outClass.indexOf("invalid") > -1) {
        thisTag.focus();
        if (thisTag.nodeName == "INPUT") {
            thisTag.select();
        }
        return false;
    }
    return true;

    function validBasedOnClass(thisClass) {
        var classBack = "";

        switch (thisClass) {
            case "":
            case "invalid":
                break;
            case "reqd":
                if (allGood && thisTag.value == "") {
                    classBack = "invalid ";
                }
                classBack += thisClass;
                break;
            default:
                classBack += thisClass;
        }
        return classBack;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:51:16.823

将“无效”CSS 块移到“reqd”块**之后。**

CSS 的规则是“最后一条规则获胜”（有点；它更复杂，但在这种情况下，这就是问题所在）。

即使“无效”规则适用于无效元素，因为“reqd”规则具有背景颜色并且因为它位于“无效”规则*之后，所以该设置也适用。*

# android - 按下后退按钮时如何重新加载片段

> ID：11277528
> 
> 赞同：0
> 
> 时间：2012-06-30T20:43:46.220
> 
> 标签：android

按下后退按钮时如何重新加载片段。我已经处理了后退按钮代码，我正在到达片段中需要重新加载的地方，但是我无法重新加载片段。

我需要我的更改在屏幕上可见，所以我应该重新加载。任何简单的步骤/？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:58:01.687

覆盖[Fragment.onResume()](http://developer.android.com/reference/android/app/Fragment.html#onResume%28%29)并根据更改在那里更新您的 Fragment。

# php - 每 2500 个字符换行一次 使用 PHP 或 javascript 进行分页

> ID：11277529
> 
> 赞同：3
> 
> 时间：2012-06-30T20:44:02.597
> 
> 标签：php, javascript, jquery, pagination, word-wrap

我有一大段文字。我想将此文本的每 2500 个字符包装成一个`<div>`我可以对其进行分页的文件。

以下不起作用：

```
//replace 2500 for 5 for purpose of this example
$text="sfdkjas;fakska;ldjk";
$text=wordwrap($text, 5, '<div class="individualPage">'); 
```

输出：

```
sfdkj<div class="individualPage">as;fa<div class="individualPage">kska;l<div
class="individualPage">djk 
```

显然我需要结束`</div>`标签来完成这项工作。

有没有人在 PHP 或 Javascript/jQuery 中有这方面的建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:50:26.923

只需添加`</div>`然后？

```
$text = '<div class="individualPage">'
      . wordwrap($text, 5, '</div><div class="individualPage">')
      . '</div>'; 
```

* * *

但是，您可以使用 javascript 做得更好：您可以[根据查看者的屏幕大小进行分页](http://jsfiddle.net/Eric/WTPzn/)。

只需将您的 HTML 设置为：

```
<div id="target">...</div> 
```

为页面添加一些 CSS：

```
#target {
    white-space: pre-wrap; /* respect line breaks */
}
.individualPage {
    border: 1px solid black;
    padding: 5px;    
} 
```

然后使用以下代码：

```
var contentBox = $('#target');
//get the text as an array of word-like things
var words = contentBox.text().split(' ');

function paginate() {
    //create a div to build the pages in
    var newPage = $('<div class="individualPage" />');
    contentBox.empty().append(newPage);

    //start off with no page text
    var pageText = null;
    for(var i = 0; i < words.length; i++) {
        //add the next word to the pageText
        var betterPageText = pageText ? pageText + ' ' + words[i]
                                      : words[i];
        newPage.text(betterPageText);

        //Check if the page is too long
        if(newPage.height() > $(window).height()) {
            //revert the text
            newPage.text(pageText);

            //and insert a copy of the page at the start of the document
            newPage.clone().insertBefore(newPage);

            //start a new page
            pageText = null;
        } else {
            //this longer text still fits
            pageText = betterPageText;             
        }
    }    
}

$(window).resize(paginate).resize(); 
```

这将与 PHP 解决方案一起使用，如果禁用 javascript，则提供向后兼容性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:50:25.513

这就是我这样做的方式：

```
$out = '';
$text = str_split($text, 2500);
foreach($text as $t){
    $out .= "<div class='individualPage'>".$t."</div>";
}
echo $out; 
```

编辑：这会将单词分开，所以坚持使用`wordwrap()`. :D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T20:51:34.080

只需在开头添加一个开始 div，在末尾添加一个关闭 div，并在每次迭代开始时添加一个关闭 div。

```
$div = '<div class="individualPage">';
$text = $div . wordwrap($text, 5, "</div>$div") . '</div>'; 
```

在 Javascript 中，没有内置的解决方案那么好。

```
var s = text, div = "<div class='individualPage'>";
while(text.length > 5) {
  s = text.slice(0, 5) + "</div>" + div;
  text = text.slice(5);
}
s = div + s + "</div>"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T21:35:49.800

只是为了好玩 - 这是一个相当丑陋的 JavaScript RegExp，它将对文本进行分页并尽量不破坏单词。我不确定它在大量文本上的表现如何。

```
var text = ....
// Grab 2500 (or slightly more if it doesn't exactly end on a word boundary)
// characters, or less than 2500 if it's at the end of the string.
text = text.replace(/(((.|\n){2500,2520}?\b)|((.|\n){1,2499}(?!.)))/mg, 
                    '<div class="individual-page">$1</div>') 
```

[jsFiddle](http://jsfiddle.net/xLGS3/)

# sql - 为大型 Web 应用程序选择什么数据库策略

> ID：11277530
> 
> 赞同：0
> 
> 时间：2012-06-30T20:44:11.370
> 
> 标签：sql, database, architecture, hadoop, redis

我必须重写一个运行在 32 台服务器上的大型数据库应用程序。硬件是最新的，每台机器都有两个四核 Xeon 和 32 GByte RAM。

该数据库是多租户的，每个客户都有自己的文件，每个文件大约 5 到 10 GByte。我在这个硬件上运行了大约 50 个数据库。该应用程序对网络开放，因此我无法控制负载。没有真正复杂的查询，因此如果有更好的解决方案，则不需要 SQL。

数据库每天午夜通过 FTP 更新。数据库是只读的。C# 是我最喜欢的语言，我想使用 ASP.NET MVC。

我考虑了以下选项：

*   使用两个运行 SQL Server 2012 的大型 SQL 服务器为 32 台服务器提供数据。在 32 台运行 IIS 托管的服务器上提供 REST 服务。

*   非规范化数据库并在每个 Web 服务器上使用 Redis。使用 bookleeve 作为 Redis 客户端。

*   结合使用 SQL Server 和 Redis

*   将 SQL Server 2012 与 Hadoop 一起使用

*   在没有 SQL Server 的情况下使用 Hadoop

对于只读数据库来说，在不失去可维护性的情况下获得最佳性能的最佳方法是什么？在这种情况下 Map-Reduce 是否有意义？

重写的原因是，用 ISAM 技术用 C++ 编写的旧应用程序太慢，界面过时，不适合从网站使用，尤其是在使用 ajax 时。

该应用程序使用具有许多表的关系数据模型，但可以编写一个可以在其中执行所有查询的加速器表，并且可以通过简单的键查找来获取来自其他表的所有其他信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:44:17.927

这个问题几乎是一篇评论文章。如果性能至关重要，并且白天的并发读取量很高，我个人更喜欢使用带有 TimesTen 的 Oracle RAC 进行缓存。

这里有一张白皮书...

[http://www.oracle.com/us/products/middleware/timesten-in-memory-db-504865.pdf](http://www.oracle.com/us/products/middleware/timesten-in-memory-db-504865.pdf)

磁盘子系统的规格以及跨物理磁盘的索引和数据文件的组织可能是最重要的因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:13:52.053

几个问题。你重写这个有什么问题？查询模式是什么样的？听起来您最喜欢使用 SQLServer + 缓存 (memcached) 来解决导致您重写它的任何问题。Redis 很好，但是您不需要 db 处理查询的数据结构功能，如果仅用作缓存，则不需要持久性。在不了解该问题的更多信息的情况下，我想我会考虑使用 MongoDB 来处理数据分片、冗余存储和缓存所有在一个解决方案中。此设置中没有特殊机器，可以配置冗余，并且负载应该很好地平衡。

# php - Apache 能够在 Web 服务器根目录之外执行文件

> ID：11277536
> 
> 赞同：0
> 
> 时间：2012-06-30T20:44:50.650
> 
> 标签：php, apache, unix

我在我的 Mac 上安装了 XAMP，我尝试运行命令 - `ps axo user,group,comm | grep httpd`以了解 apache 正在运行的用户身份。我得到了多个结果，一个是root，另一个是nobody。那么 apache 是作为什么运行的呢？一个root或nobody，为什么我得到root和nobody？是不是因为 httpd 以 root 身份开始，然后变成了没人？

`ps axo user,group,comm | grep httpd`我得到的结果是 -

```
根 20 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd
没人 -1 /Applications/XAMPP/xamppfiles/bin/httpd

```

其次，当我执行以下脚本时 - `echo shell_exec('whoami');`（来自[https://stackoverflow.com/questions/2509334/finding-out-what-user-apache-is-running-as](https://stackoverflow.com/questions/2509334/finding-out-what-user-apache-is-running-as)）我得到的结果是 -`nobody`

我想知道用户的原因是因为 php 引擎实际上能够执行 web 服务器根目录之外的 php 文件（mysql_details.php）。而这个 mysql_details.php 具有以下权限 -`rwxr--r--`即仅读取其他和组的权限。所以如果apache用户是nobody，那么它如何执行mysql_details.php。

谢谢，普拉特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:56:35.783

主 Apache 进程以 root 身份运行 - 其他进程以无人身份运行。处理请求的唯一进程是那些以无人身份运行的进程，因此如果有人试图访问无人无法访问的文件，他们将收到错误消息（而 root 将能够访问该文件）。

如果你需要执行文件，你可以做一些事情：

1.  Have nobody own the file. This will give nobody full read/write/execute access to the file, while preventing other users from writing or executing the file.
2.  Add nobody to a group, and give that group execute access on the file. Anyone who is in the group would be able to execute the file, but only the owner would be able to write to it (which would not be nobody).
3.  Allow anyone to execute the file. This is probably not a good idea, as any user would be able to execute the contents at varying permission levels. It'd probably be best to use one of the above two.

# python - 从网络摄像头抓取帧时，我得到一个 0 字节的图像

> ID：11277540
> 
> 赞同：0
> 
> 时间：2012-06-30T20:45:29.233
> 
> 标签：python, opencv, debian

我正在尝试制作一个定期拍摄图像的应用程序。

所以一开始我想我可以制作一个应用程序来获取图像并保存它。它保存它没关系，但图像是空的......这是为什么？

```
import cv

capture = cv.CaptureFromCAM(0)
img = cv.QueryFrame(capture)

foo = cv.SaveImage("foo.jpg", img) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T10:03:24.933

首先，我建议您`CaptureFromCAM()`通过检查捕获的值来测试是否成功。您也可以在窗口中显示流程。其次，您将在[文档](http://opencv.itseez.com/modules/highgui/doc/reading_and_writing_images_and_video.html?highlight=saveimage#cv.SaveImage)中阅读到使用`SaveImage()`.

# nlp - 斯坦福 NLP 安装

> ID：11277541
> 
> 赞同：0
> 
> 时间：2012-06-30T20:45:32.317
> 
> 标签：nlp, nutch, stanford-nlp

我正在使用开源 Nutch-1.4 以及 Solr 和 Hadoop 设计一个定制的网络搜索引擎。
NLP部分的设计本来应该由我朋友负责，但由于他退出了，我需要用Nutch配置NLP。
我需要的是，当任何用户触发查询时，Stanford NLP 工具应该从查询中获取重要术语，从索引中匹配这些单词，然后返回结果页面。这就是我认为 NLP 的用途。对不起，我对 NLP 的了解不足。
现在，我如何将 StanfordNLP 核心与 Nutch 集成？

也欢迎您提出让我的引擎在 NLP 情况下更高效的建议！！！

# jquery - 如何使用 jquery cookie 插件获取 cookie 子键？

> ID：11277542
> 
> 赞同：2
> 
> 时间：2012-06-30T20:45:43.313
> 
> 标签：jquery, asp.net, jquery-cookie

在我的 .aspx 页面中，当有人对投票进行投票时，我设置了一个 cookie，如下所示；

```
HttpContext.Current.Response.Cookies("poll")("poll_voted") = "yes"
HttpContext.Current.Response.Cookies("poll")("poll_id") = pID
HttpContext.Current.Response.Cookies("poll").Expires = Date.Now.AddDays(30) 
```

现在，使用[jquery cookie 插件](https://github.com/carhartl/jquery-cookie)，我需要检查 cookie 是否存在；

```
// this works quite well...
if ($.cookie('poll', { poll_voted: 'yes' })) {  
    // now here, I need to get the value of poll_id but how???
} 
```

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-11T14:51:36.110

尝试添加这个插件 - 它要求 jquery.cookies.js 已经在页面上，我确信它可以使用一些调整，但对于我正在做的事情来说已经足够了。

```
(function ($, document) { 
    if($.cookie){
        $.cookieKey = function(CookieName, KeyName, Value, Options){
            var reg = new RegExp("(?:([^=]+)=([^&]*)&?)", "ig"),
            match = null,
            matches = [];
            var cookieVal = $.cookie(CookieName);
            while(match = reg.exec(cookieVal)){ 
                if(KeyName.toLowerCase() == match[1].toLowerCase()){
                    if(Value){ //we are updating, collect all values
                         matches.push([match[1], Value]);
                    }
                    else{
                        return match[2]; //we are getting, sub key found just return it
                    }
                }
                else if(Value){ //we are updating, collect all values
                    matches.push([match[1], match[2]]);
                }
            }                 

            if(Value){ //we are updating, update values
                updatedValue = "", 
                sep = "";
                for(i=0;i<matches;i++){
                    updatedValue += sep + matches[i][0] + "=" + matches[i][1];
                    sep = "&"
                }
                $.cookie(CookieName, updatedValue, Options);
            }           
            else return null;//we are getting, value not found
        }
    }
})(jQuery, document);

$.cookieKey("mycookiename", "keyname");//get sub key value
$.cookieKey("mycookiename", "keyname", "value");//set sub key value
$.cookieKey("mycookiename", "keyname", "value", {path: "/"});//set sub key value with cookie options 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:23:11.640

如果 $.cookie("poll") 是一个数组，这将起作用：

```
var mycookie = $.cookie("poll");
if(mycookie){
   var poll_id=mycookie["poll_id"];
} 
```

您可以`mycookie`使用 firebug 或 chrome 开发人员工具检查变量的类型。

# e-commerce - 企业应用程序的果园 CMS 策略

> ID：11277543
> 
> 赞同：0
> 
> 时间：2012-06-30T20:45:48.480
> 
> 标签：e-commerce, orchardcms

这可能是一个大问题，但我正在尝试为使用 Orchard CMS 找到一些起点。我遵循了一些教程，但我还没有找到解决方案。

案子：

我的网络应用程序是关于销售东西的，所以基本上它是一个电子商务网站。我的第一个障碍是用户资料。我希望使用名字等属性扩展用户对象。但我希望将这些字段存储在我的自定义表中。而不是使用配置文件模块，其中添加的字段存储为内容项，我无法在数据库中找到它们。

第二个障碍是将用户对象与购买联系起来。我知道如何创建用于创建购买记录的 MVC 应用程序。但我希望这些购买与用户相关联。因此，当我进入仪表板并单击用户时，我应该能够看到他所有的购买。

我还有很多其他的障碍，但如果我能解决这个问题，剩下的就是小菜一碟（我希望如此）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T18:08:02.883

最好通过关注 [http://skywalkersoftwaredevelopment.net/blog/writing-an-orchard-webshop-module-from-scratch-part-1][1] 上的博客来回答这个问题

这是深入果园的最佳起点之一。

# c++ - 是否可以在 Boost 库中禁用异常和 RTTI？

> ID：11277544
> 
> 赞同：8
> 
> 时间：2012-06-30T20:45:48.840
> 
> 标签：c++, boost, android-ndk

我为 Android 开发了一些本机库并使用 Boost 库——只是基于标头的库。我面临的问题是，当我尝试将我的一些本机库链接到某个系统库时，`UnsatisfiedLinkError`会抛出异常。这是由于 NDK 文档中所述的不同 C++ 运行时：

> 您只能选择所有代码都依赖的单个 C++ 运行时。不能混合针对不同 C++ 运行时编译的共享库。

系统库不使用 RTTI 和异常，但我的库隐式使用它。我知道有宏`BOOST_EXCEPTION_DISABLE`和`BOOST_NO_RTTI`，但我无法使其工作。我尝试将它们设置为编译器标志和 config.hpp，但没有运气 - 仍然遇到很多错误，例如

```
cannot use typeid with -fno-rtti 
```

如何在 Boost 中禁用这些功能，甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T03:46:05.013

答案是“也许”。一些 boost 库将在禁用异常的情况下工作 - 有些则不会。RTTI 也一样。

我建议您查看您感兴趣的特定 boost 库的文档。

例如，Boost.Array 将在禁用异常的情况下工作，但 Boost.Format 不会。

如果您收到类似的消息`cannot use typeid with -fno-rtti`，那可能是在编译需要 RTTI 的 Boost 的某些部分时。发生错误的位置会告诉您（通常）是哪个库。

# java - org.apache.jasper.servlet.JspServlet 有什么用？

> ID：11277547
> 
> 赞同：2
> 
> 时间：2012-06-30T20:46:20.570
> 
> 标签：java, servlets, aem

我一直在使用 Adob​​e CQ5 。在 web.xml 文件中，我注意到一个名为`org.apache.jasper.servlet.JspServlet`.

我想知道它`org.apache.jasper.servlet.JspServlet`在 CQ5 和一般情况下的用途。

我看到了[http://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/jasper/servlet/JspServlet.html](http://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/jasper/servlet/JspServlet.html) 。但是，无法理解它的功能。这个类在 HttpServlet 之上提供的额外优势是什么？

在 Adob​​e CQ5 的上下文中调用这个 servlet 有什么需要？

提前致谢 。

# c++ - C++ - SDL：Blitting 性能问题

> ID：11277548
> 
> 赞同：1
> 
> 时间：2012-06-30T20:46:22.380
> 
> 标签：c++, performance, sdl, surface, frame-rate

我是 C++ 和 SDL 的初学者，但我已经开发游戏好几年了。

我选择 SDL 是因为它的简单性，因为我想要的只是 2D 游戏，但我并不满意。与表面一起工作的功能消耗了很多能量，说实话太多了。

当我第一次开始使用 SDL 时，我得到了 30 FPS。然后我发现要优化表面，帧率跃升至 60。此外，将像素格式从 24 位切换到 32 位也将其提高到 100。

在我看来，与其他用于游戏开发和编程语言的库相比，这种性能很弱。我一直认为这仍然是我的错，如果一切设置正确，我的 FPS 可能会飙升。

所以我不断测试，发现没有代码运行（不包括我的 FPS 指标）会产生 400 FPS。然而，使用 SDL_FillRect() 函数清除屏幕会将其降至 100。然后，对于每个绘制的精灵，帧速率会变得越来越低。

真的应该这么慢吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T20:53:21.723

首先，100 FPS 并不慢。在大多数情况下，任何大约 60 都是无关紧要的，因为无论如何都要监控刷新率。

其次，你在用什么类型的表面进行 blitting？我记得当我制作一个大型 SDL 游戏时，我真的很惊讶地发现我拥有的一个特定图像会永远被 blit。但是稍微调整质量以消除抖动导致它几乎立即再次开始闪烁。我认为 SDL 在内部使用运行长度编码，因此包含运行的图像会更快地传输。

# sql - 网站数据库复制

> ID：11277550
> 
> 赞同：2
> 
> 时间：2012-06-30T20:46:42.850
> 
> 标签：sql, sql-server, replication

我有一个有一个数据库的网站 我也有一个有数据库的桌面应用程序

我想将数据从桌面应用程序数据库复制到网站数据库，换句话说，桌面应用程序将充当发布者和分发者，而网站将充当订阅者。这是一个中央订阅者场景。

我的问题是我该怎么做，我的意思是它是通过代码（RMO 或其他方式）还是 Sql Server 2008（Transct-SQL）完成的

以及如何通过桌面应用程序的设置添加复制？

以及如何配置网站数据库进行复制？

请帮助我，我以前从未从事过复制工作。我只是希望有人向我解释这样做的正确方法或方式。只是要点作为指导，其余的我会自己弄清楚

![中央订户](../Images/3399c3cc15c15f92071e54985c04f64e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:50:53.580

我认为使用 SMO 或完全从头开始编写自己的解决方案会带来太多开销。

你看过了[`Web Synchronization for Merge Replication`](http://msdn.microsoft.com/en-us/library/ms151763%28v=sql.105%29.aspx)吗？它基本上是经典的 SQL Server 发布者/订阅者合并复制，但通过 IIS 在 Web 上完成。

您甚至可以在发布者处将您的一些文章设置为只读，这样您在订阅者处对它们所做的修改将不会被带回（如果您愿意，可以模拟事务复制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:37:06.140

You can definitely use SQL Server merge replication via IIS. I do this with my clients right now and it works great. I think you're mixing your terms up though, causing more confusion than is necessary. There is no reason to think of the laptops as 'publishers', at least not in SQL terms. They can still be subscribers, but if you use merge replication, then that means the laptops will send data both ways (take data from the server, and send data to the server). My situation is to have a SQL server on our IIS server (or you can separate those servers for a more secure enviro), and synchronize through RMO to the laptops to a WPF application of mine. These laptops don't need IIS or SQL server installed on them, you can replicate to a SQL Compact database easily using RMO.

Additionally you can look into using WCF, microsoft synchronization services. But that requires more work i think, and i have less experience there.

# c++ - 将传递的 ofstream 设置为类范围的变量

> ID：11277553
> 
> 赞同：0
> 
> 时间：2012-06-30T20:47:17.013
> 
> 标签：c++, file-io

我的班级有一个构造函数：`class(ofstream & o)`. 我想设置我的类变量`ofstream out`。问题是我不能`out = o`在没有错误的情况下使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T20:50:01.393

你会做的是这样的：

```
 class MyClass
   {
      ofstream& out;
      MyClass(ofstream& o) : out(o)
      {}
      ...
    }; 
```

这将起作用，并且您可以在内部`out`照常使用。

在你的问题中，你说`ofstream out`。你不能“复制”文件流，所以你不能说`out = o`除非`out`是参考。

# scala - self 类型中 `=>` 背后的原因是什么？

> ID：11277558
> 
> 赞同：14
> 
> 时间：2012-06-30T20:48:20.163
> 
> 标签：scala, self-type

self 类型类似于以下示例：

```
trait A { self: String => } 
```

这就是说，那个 trait `A`（或者它的一个子类型）必须继承 class `String`。

关键字`self`后跟`:`一个变量 in 的类比`var s: String`，类型在后面`:`。

但是`=>`自我类型中的状态是什么？这背后的原因是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T22:10:22.813

Just guess work... You need some specific delimiter of the self-type declaration. Imagine the `=>` was just omitted. `this: String` would be a syntactically valid statement (although the type checker will complain).

So which should be the delimiter? You wouldn't want nested braces like `trait A { self: String { ... }}`. So which non-paired existing delimiters exist? `=>` is the only one that I can think of.

Where is `=>` used elsewhere? As sugar for function types (`A => B`) and for function bodies (`i: Int => i + 1`). Also for call-by-name arguments, and for the cases of a pattern match. This last usage is somewhat coherent with the self-type. It's like matching `this` to be of a particular type, and then defining the body depending on this 'match'. I don't know, maybe this is a silly analogy.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-01T03:44:39.873

请注意，这`self`不是关键字，而是普通标识符。你真的可以写任何其他有效的标识符来代替`self`. `:`在表达式是*类型归属*之后，在表达式有效的任何地方都完全有效。

这`=>`就是告诉 Scala 有一个自我类型的原因。否则，`self: Type`看起来就像一个简单的语句，一个表达式。例如：

```
class A
class B extends A {
  this: A
} 
```

那是有效的 Scala 代码，它没有 self 类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T21:52:17.963

`this`是在类体内的范围内，所以从这个意义上说，它是一个参数（尽管我们从来没有这样想过）。自类型语法只是使其明确，并允许给它一个不同的名称（和类型）。所以箭头成为了一个很好的选择，作为活页夹和它的作用域之间的分隔符。

# c# - 如何防止或拦截对 Directory.Delete(path, true) 的调用

> ID：11277559
> 
> 赞同：4
> 
> 时间：2012-06-30T20:48:22.343
> 
> 标签：c#, architecture

最近我正在调试一个“poof-all-customer-data-is-gone”问题。很快就发现一个错误的分支导致了`Directory.Delete(customerRoot, true)`一行代码。灾难性的线路是由普通的 GUI 开发人员编写的。能导致这样一场灾难的台词并不多。所以我的问题是如何防止这个特殊的电话。（`DirectoryInfo.Delete()`是第二个）。

这是我可能的解决方案的优先列表

*   没有第三方更改构建过程的编译错误
*   没有第三方的运行时拦截
*   与第三方的运行时拦截（不改变构建过程）
*   与第三方的编译错误（我猜 PostSharp 会这样做）
*   面向 GUI 开发人员的关于客户如何喜爱他们的数据的教育研讨会

还有什么想法吗？

我会提到我们的系统有一个专门的文件/文件夹删除服务（验证和记录）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:32:19.393

您可以将应用程序修改为不在完全信任下运行。配置限制对物理磁盘的访问的信任级别。[看看 FileIOPermission](http://msdn.microsoft.com/en-us/library/system.security.permissions.fileiopermission.aspx)。请注意，这可以针对特定位置进行配置，从而为您提供相当多的控制权。

[需求概览](http://msdn.microsoft.com/en-us/library/3ky50t49.aspx)

**更新** 在考虑了更多之后，我还建议进行“保姆测试”。如果您正在执行任何类型的测试，您可以添加一个测试来查看程序集中的所有类型，并检查对任何 FileSystem 方法的调用。任何此类调用都需要在白名单中，否则测试将失败。我正在做的项目使用这个，它提供了*很多*价值。

**更新 2** 有一条关于如何进行此类保姆测试的评论。基本上，您需要使用反射来获取所有方法，然后在 IL 中查找禁止调用。它听起来比它更复杂。

[从程序集中提取特定 IL（.NET 中间语言）签名的机制](https://stackoverflow.com/questions/3622760/mechanism-to-extract-specific-il-net-intermediate-language-signatures-from-an)

**更新 3** 还有另一种更好的方法来进行这种类型的保姆测试，它不直接涉及弄乱 IL。我在我的博客上发表了一篇文章如何做到这一点。

[http://datatoknowledge.com/2012/09/10/nanny-tests/](http://datatoknowledge.com/2012/09/10/nanny-tests/)

埃里克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T09:37:14.350

要在运行时“拦截”调用，您可以使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类，但它实际上不会阻止删除，只是让您知道它发生了。防止实际删除要棘手得多。Windows 不提供 Linux 的 ptrace 功能，因此您无法拦截系统调用本身（这里有一篇关于[此](http://jbremer.org/intercepting-system-calls-on-x86_64-windows)的文章，但据我所知，可用性相当有限）。其他人的建议 - 设置访问权限和信任级别 - 可能会起作用，但是当您确实需要删除某些内容并且您的“删除服务”只是 .NET 方法的包装器时，您也会阻止它工作。

另一种选择是使用第三方工具并在编译时检查 -[这个问题](https://stackoverflow.com/questions/9777766/how-to-prevent-net-base-class-usage)正是你需要的，包括示例，还有更多工具可以做到这一点（我只使用 Resharper，但我想它也可以完成任务）。

但是，我认为这不是重点。您的开发人员犯了一个错误，它破坏了一些客户数据，没有人对此感到高兴。这并不意味着您需要为其制定系统范围的规则并强制执行该规则，这意味着开发人员应该更好地测试他或她的代码和/或应该使用您提到的删除服务（无论是什么）。无论你怎么努力，你都无法阻止人们做愚蠢的事情。您不想花时间和金钱围绕 Directory.Delete() 方法进行防御，只是为了发现其他人犯了一个不同的愚蠢错误，而这个特定的事情将永远不会再成为问题。除非像这样的问题（滥用 Directory.Delete() ）在您的系统中比平常更容易发生，否则放手，专注于其他事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:57:57.690

您可以在全局包含的命名空间中包含一个单独的目录类（和 DirectoryInfo） - 这不会阻止使用 System.IO.Directory.Delete 的人，但这是另一个可能有助于抓住它并推迟它们的想法，特别是如果您包含一个相同的虚拟函数，该函数会抛出带有消息的异常。

# nicedit - 需要 NicEdit 帮助

> ID：11277560
> 
> 赞同：0
> 
> 时间：2012-06-30T20:48:27.553
> 
> 标签：nicedit

两个问题：

1）你知道是否可以在 NicEdit 中创建一个新按钮，在所选单词周围添加一个 DIV 标签，而不是 SAPN 标签？

2) 我想将按钮放在 NicEdit 区域之外，它会调用 NicEdit 中的相应函数来添加 ie。

DIV CLASS="XXX" 文本选择 /END DIV

您知道是否可以简单地调用适当的函数来添加 DIV HTML 标记？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T10:22:32.973

1) 要将新按钮添加到 nicEditor 面板，您需要扩展`nicEditorAdvanceButton`，如此[处所示](http://wiki.nicedit.com/w/page/516/Creating%20a%20Plugin)。单击时您将为此扩展按钮编写的函数将使用 html`div`标记包装您选择的文本。

2）这又很简单，您只需要从放置外部按钮的位置调用面板实例所需的函数。

# html - 定位列表项

> ID：11277566
> 
> 赞同：0
> 
> 时间：2012-06-30T20:48:57.260
> 
> 标签：html, css

好的，我有这个小提琴[http://jsfiddle.net/25J3M/6/](http://jsfiddle.net/25J3M/6/)，我想像黑色和蓝色的一样定位红色和黄色的块，黑色下方的红色和蓝色下方的黄色

```
<ul class="tracks">
    <li class="bateria"></li>
    <li class="waveform-bateria"></li>
    <li class="guitarra"></li>
    <li class="waveform-guitarra"></li>
</ul>​ 
```

```
/* track */

ul .tracks {
    float:left;
    margin-top:20px;
    left:0px;
    list-style-type:none;    
}

ul.tracks li.bateria {
    width:348px;
    height:279px;
    background-color:black;
    margin-right:0;
    float:left;
}

ul.tracks .waveform-bateria {
    width:678px;
    height:278px;
    background-color:blue;
    margin-right:0;
    float:left;    
    clear:right;
}

ul.tracks li.guitarra {
    width:348px;
    height:279px;
    background-color:red;
    margin-right:0;
    float:left;
}

ul.tracks .waveform-guitarra {
    width:678px;
    height:278px;
    background-color:yellow;
    margin-right:0;
    float:left;    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:04:06.927

您应该使它们都具有相同的高度（它们的高度`.waveform-*`短一个像素）。另外，删除`margin-top`from `.guitarra`（仅在您的 jsfiddle 上，不在您发布的代码上）。

最后，请记住，只有当用户的浏览器窗口的宽度至少有 1026px 可用时，这种布局才有效，否则`.waveform-*`会中断到下一行。

[http://jsfiddle.net/25J3M/14/](http://jsfiddle.net/25J3M/14/)

# c# - C#中的设置问题？

> ID：11277569
> 
> 赞同：0
> 
> 时间：2012-06-30T20:49:49.773
> 
> 标签：c#, winforms, settings, visual-c#-express-2010

我的代码遇到了一些问题，该代码应该重做用户在设置中所做的更改。当我在关闭表单后单击“否”时，它`ribbonBar2`消失了，但是当我打开设置时，该复选框仍然被选中，尽管它不应该被选中。为什么？

```
Form1 frm1;
public Form8(Form1 frm1): this()
{
    this.frm1 = frm1;
}

private void checkBox1_CheckedChanged(object sender, EventArgs e)
{             
    frm1.ribbonBar2.Visible = checkBox1.Checked;            
}

private void form8_closing(object sender, FormClosingEventArgs e)
{
    Properties.Settings.Default.checkBox1 = checkBox1.Checked;

    DialogResult result1 = MessageBox.Show("Do you want to Save your Settings?", "Warning!", MessageBoxButtons.YesNo, MessageBoxIcon.Warning);
    if (result1 == DialogResult.Yes)
    {
        Properties.Settings.Default.Save();
    }

    if (result1 == DialogResult.No)
    {
        checkBox1.Checked = !Properties.Settings.Default.checkBox1;
    }

    e.Cancel = false;  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:41:36.660

因为看起来没有人愿意帮助你...

您不会恢复您保存的任何设置。如果我理解你的话，你想做这样的事情：

```
public Form8(Form1 frm1): this()
{
    // Restore the settings when loading the form
    checkBox1.Checked = Properties.Settings.Default.checkBox1;
}

private void form8_closing(object sender, FormClosingEventArgs e)
{
    if (DialogResult.Yes == MessageBox.Show("Do you want to Save your Settings?",
                    "Warning!", MessageBoxButtons.YesNo, MessageBoxIcon.Warning))
    {
        // Set the setting and save it
        Properties.Settings.Default.checkBox1 = checkBox1.Checked;
        Properties.Settings.Default.Save();
    }
} 
```

# android-ndk - 使用 libpng 加载图像会产生意外的像素数据

> ID：11277574
> 
> 赞同：0
> 
> 时间：2012-06-30T20:50:29.023
> 
> 标签：android-ndk, libpng

我在尝试将 png 文件加载到我的应用程序时遇到问题。似乎可以很好地加载标题，并识别出图像是 png，但由于某种原因，输出具有相同的值，尽管图像实际上不是一种颜色。让我烦恼的另一件事是 16 个字节未读。

我的代码：

```
AAsset* pngAsset_ = 0;
AAssetManager* pngAassetManager_ = 0;

void png_asset_read(png_structp png, png_bytep data, png_size_t size) {
    //AAsset_seek(pngAsset_, 0, 0);
    AAsset_read(pngAsset_, data, size);
    int numBytesRemaining = AAsset_getRemainingLength(pngAsset_);
    LOGI("Read size: %d, remaining: %d", size, numBytesRemaining);
}

Image* loadPngFile(AAssetManager* assetManager) {
    pngAassetManager_ = assetManager;

    LOGI("Trying to load image...");
    int HEADER_SIZE = 8;
    string filename = "skybox.png";
    pngAsset_ = AAssetManager_open(pngAassetManager_, filename.c_str(),
            AASSET_MODE_UNKNOWN);
    if (pngAsset_ == 0) {
        LOGW("Asset \"%s\" not found.", filename.c_str());
        return 0;
    }

    off_t bufferSize = AAsset_getLength(pngAsset_);
    png_byte* buffer = new png_byte[HEADER_SIZE];

    int numBytesRead = AAsset_read(pngAsset_, buffer, HEADER_SIZE);
    int numBytesRemaining = AAsset_getRemainingLength(pngAsset_);

    int is_png = !png_sig_cmp(buffer, 0, 8);
    if (!is_png) {
        LOGE("File %s format is not PNG.", filename.c_str());
        return 0;
    }
    LOGI("Size of the file: %d, bytes read: %d, bytes remain: %d",
            bufferSize, numBytesRead, numBytesRemaining);

    png_structp png_ptr = png_create_read_struct(PNG_LIBPNG_VER_STRING, NULL,
            NULL, NULL);
    if (!png_ptr) {
        LOGE("Unable to create PNG structure: %s", filename.c_str());
        return 0;
    }

    png_infop info_ptr = png_create_info_struct(png_ptr);
    if (!info_ptr) {
        png_destroy_read_struct(&png_ptr, (png_infopp) NULL, (png_infopp) NULL);
        LOGE("Unable to create png info : %s", filename.c_str());
        return 0;
    }

    png_infop end_info = png_create_info_struct(png_ptr);
    if (!end_info) {
        png_destroy_read_struct(&png_ptr, &info_ptr, (png_infopp) NULL);
        LOGE("Unable to create png end info : %s", filename.c_str());
        return 0;
    }

    if (setjmp(png_jmpbuf(png_ptr))) {
        LOGE("Error during setjmp : %s", filename.c_str());
        png_destroy_read_struct(&png_ptr, &info_ptr, &end_info);
        return 0;
    }
    png_set_read_fn(png_ptr, NULL, png_asset_read);
    png_set_sig_bytes(png_ptr, 8);
    png_read_info(png_ptr, info_ptr);

    int bit_depth, color_type;
    png_uint_32 twidth, theight;
    png_get_IHDR(png_ptr, info_ptr, &twidth, &theight, &bit_depth, &color_type,
            NULL, NULL, NULL);
    LOGI("Width: %d, height: %d.", twidth, theight);

    // Update the png info struct.
    png_read_update_info(png_ptr, info_ptr);

    // Row size in bytes.
    int rowbytes = png_get_rowbytes(png_ptr, info_ptr);
    LOGI("Row size: %d bytes.", rowbytes);

    // Allocate the image_data as a big block, to be given to opengl
    png_byte *image_data = new png_byte[rowbytes * theight];
    if (!image_data) {
        //clean up memory and close stuff
        png_destroy_read_struct(&png_ptr, &info_ptr, &end_info);
        LOGE(
                "Unable to allocate image_data while loading %s ", filename.c_str());
    }

    //row_pointers is for pointing to image_data for reading the png with libpng
    png_bytep *row_pointers = new png_bytep[theight];
    if (!row_pointers) {
        //clean up memory and close stuff
        png_destroy_read_struct(&png_ptr, &info_ptr, &end_info);
        delete[] image_data;
        LOGE(
                "Unable to allocate row_pointer while loading %s ", filename.c_str());
    }
    // set the individual row_pointers to point at the correct offsets of image_data
    for (int i = 0; i < theight; ++i)
        row_pointers[theight - 1 - i] = image_data + i * rowbytes;

    //read the png into image_data through row_pointers
    png_read_image(png_ptr, row_pointers);

    for (int i = 0; i < 10; i ++) {
        LOGI("Pixel %d: %f %f %f %f",i, image_data[i * 4], image_data[i * 4 + 1],
                image_data[i * 4 + 2], image_data[i * 4 + 3]);
    }

    //Now generate the OpenGL texture object
    Image* image = new Image((unsigned char*) image_data, twidth, theight,
            twidth * theight * 4, 0);

    png_destroy_read_struct(&png_ptr, &info_ptr, &end_info);
    delete[] row_pointers;

    AAsset_close(pngAsset_);

    return image;
} 
```

输出：

```
06-30 23:49:00.651: I/Ghost Engine(21279): Trying to load image...
06-30 23:49:00.651: I/Ghost Engine(21279): Size of the file: 529452, bytes read: 8, bytes remain: 529444
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 8, remaining: 529436
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 13, remaining: 529423
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 4, remaining: 529419
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 8, remaining: 529411
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 9, remaining: 529402
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 4, remaining: 529398
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 8, remaining: 529390
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 32, remaining: 529358
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 4, remaining: 529354
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 8, remaining: 529346
06-30 23:49:00.651: I/Ghost Engine(21279): Width: 1024, height: 1024.
06-30 23:49:00.651: I/Ghost Engine(21279): Row size: 4096 bytes.
06-30 23:49:00.651: I/Ghost Engine(21279): Read size: 8192, remaining: 521154
06-30 23:49:00.681: I/Ghost Engine(21279): Read size: 8192, remaining: 512962
06-30 23:49:00.681: I/Ghost Engine(21279): Read size: 8192, remaining: 504770
06-30 23:49:00.691: I/Ghost Engine(21279): Read size: 8192, remaining: 496578
06-30 23:49:00.701: I/Ghost Engine(21279): Read size: 8192, remaining: 488386
06-30 23:49:00.721: I/Ghost Engine(21279): Read size: 8192, remaining: 480194
06-30 23:49:00.721: I/Ghost Engine(21279): Read size: 8192, remaining: 472002
06-30 23:49:00.731: I/Ghost Engine(21279): Read size: 8192, remaining: 463810
06-30 23:49:00.731: I/Ghost Engine(21279): Read size: 8192, remaining: 455618
06-30 23:49:00.731: I/Ghost Engine(21279): Read size: 8192, remaining: 447426
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 439234
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 431042
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 422850
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 414658
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 406466
06-30 23:49:00.741: I/Ghost Engine(21279): Read size: 8192, remaining: 398274
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 390082
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 381890
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 373698
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 365506
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 357314
06-30 23:49:00.751: I/Ghost Engine(21279): Read size: 8192, remaining: 349122
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 340930
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 332738
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 324546
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 316354
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 308162
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 299970
06-30 23:49:00.761: I/Ghost Engine(21279): Read size: 8192, remaining: 291778
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 283586
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 275394
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 267202
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 259010
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 250818
06-30 23:49:00.771: I/Ghost Engine(21279): Read size: 8192, remaining: 242626
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 234434
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 226242
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 218050
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 209858
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 201666
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 193474
06-30 23:49:00.781: I/Ghost Engine(21279): Read size: 8192, remaining: 185282
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 177090
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 168898
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 160706
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 152514
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 144322
06-30 23:49:00.791: I/Ghost Engine(21279): Read size: 8192, remaining: 136130
06-30 23:49:00.801: I/Ghost Engine(21279): Read size: 8192, remaining: 127938
06-30 23:49:00.801: I/Ghost Engine(21279): Read size: 8192, remaining: 119746
06-30 23:49:00.801: I/Ghost Engine(21279): Read size: 8192, remaining: 111554
06-30 23:49:00.801: I/Ghost Engine(21279): Read size: 8192, remaining: 103362
06-30 23:49:00.801: I/Ghost Engine(21279): Read size: 8192, remaining: 95170
06-30 23:49:00.811: I/Ghost Engine(21279): Read size: 8192, remaining: 86978
06-30 23:49:00.811: I/Ghost Engine(21279): Read size: 8192, remaining: 78786
06-30 23:49:00.811: I/Ghost Engine(21279): Read size: 8192, remaining: 70594
06-30 23:49:00.821: I/Ghost Engine(21279): Read size: 8192, remaining: 62402
06-30 23:49:00.821: I/Ghost Engine(21279): Read size: 8192, remaining: 54210
06-30 23:49:00.831: I/Ghost Engine(21279): Read size: 8192, remaining: 46018
06-30 23:49:00.831: I/Ghost Engine(21279): Read size: 8192, remaining: 37826
06-30 23:49:00.831: I/Ghost Engine(21279): Read size: 8192, remaining: 29634
06-30 23:49:00.841: I/Ghost Engine(21279): Read size: 8192, remaining: 21442
06-30 23:49:00.841: I/Ghost Engine(21279): Read size: 8192, remaining: 13250
06-30 23:49:00.841: I/Ghost Engine(21279): Read size: 8192, remaining: 5058
06-30 23:49:00.851: I/Ghost Engine(21279): Read size: 5042, remaining: 16
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 0: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 1: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 2: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 3: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 4: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 5: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 6: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 7: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 8: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.861: I/Ghost Engine(21279): Pixel 9: 0.000000 0.000000 1197.166992 1420.242434
06-30 23:49:00.871: I/Ghost Engine(21279): Image id: 1.
06-30 23:49:00.871: I/Ghost Engine(21279): Image dimensions: 1024 x 1024
06-30 23:49:00.871: I/Ghost Engine(21279): Image size: 4194304 
```

任何事情都可能开始出错的想法？谢谢，马丁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T05:43:08.693

发现问题：

```
"Pixel %d: %f %f %f %f" 
```

本来应该：

```
"Pixel %d: %d %d %d %d" 
```

显然图像加载正常。

# objective-c - 使用 NSImageView？

> ID：11277577
> 
> 赞同：1
> 
> 时间：2012-06-30T20:50:37.573
> 
> 标签：objective-c, macos, cocoa

我创建了一个从 NSImageView 派生的类。但是，没有调用类的构造函数（init），因此我猜测 init 不是 NSImageView 的正确初始化程序。

NSImageView 的正确初始化程序是什么？我查看了[手册](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSImageView_Class/Reference/Reference.html)，但他们似乎没有提到正确的 init 函数。谷歌搜索似乎也没有提供任何具体[结果](http://www.cocoabuilder.com/archive/cocoa/115891-how-to-init-subclass-of-nsimageview.html)。

我找到了一个*可能的*构造函数：

> -(id) initWithFrame:(NSRect)frameRect

但我不确定这是否是正确的电话。我不太确定 frameRect 是什么。

**NSImageView 的默认初始化器/构造器是什么？**注意我正在开发一个桌面应用程序而不是一个 iOS 应用程序，如果这会有所不同。NSImageView 子类对象已通过 Interface Builder 放置在窗口中，而不是以编程方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T20:59:23.183

派生自的类`NSView`可以使用 以编程方式初始化，也可以`initWithFrame`在使用`awakeFromNib`. 我所做的是调用一个通用的、私有的方法来执行初始化，不管它们是如何加载的：

```
// Private methods
@interface MyViewSubclass ()

- (void)_setupView;

@end

@implementation MyViewSubclass

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self != nil)
    {
        [self _setupView];
    }
    return self;
}

- (void)awakeFromNib
{
    [self _setupView];
}

// Common initialisation (called by initWithFrame: and awakeFromNib).
- (void)_setupView
{
    // Set stuff up
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T20:56:20.067

如果它来自 nib/xib，initWithCoder：

```
-(id)initWithCoder:(NSCoder *)coder 
```

# php - mysql更新的动态数组创建 - php

> ID：11277580
> 
> 赞同：0
> 
> 时间：2012-06-30T20:51:21.943
> 
> 标签：php, mysql, arrays

如何在 insertIntoDb 中为 updateDbRecord 创建一个动态查询？鉴于我想更新一个特定的 ID，`update_id=$_GET['id'];`因为我的 ID 存储在我的 URL 中，即 somepage.php?id=12

```
function insertIntoDb($db, $table, $carry, $carryUrl) {
    mysql_select_db($db) or die("Could not select database. " . mysql_error());
    $resultInsert = mysql_query("SHOW COLUMNS FROM " . $table);
    $fieldnames=array();
      if (mysql_num_rows($resultInsert) > 0) {
        while ($row = mysql_fetch_array($resultInsert)) {
            $fieldnames[] = $row['Field'];
            $values = array_intersect_key( $_POST, array_flip($fieldnames) );
        }
      }
      $sql = sprintf('INSERT INTO %s (%s) VALUES ("%s")', $table, 
      implode(', ', array_map('mysql_escape_string', array_keys($values))), implode('", "',array_map('mysql_escape_string', $values))); 
      mysql_query($sql);
      /* if ($carry == 'yes') {
        redirect($carryUrl.'?id='.$_REQUEST['id']);
      }
      else { echo '<div class="success">Data was entered into the database successfully!<br><a href="view.php?type=recent">View listing?</a></div>'; } */
}

function updateDbRecord($db, $table) {
    mysql_select_db($db) or die("Could not select database. " . mysql_error());
    $resultInsert = mysql_query("SHOW COLUMNS FROM " . $table . " WHERE Field NOT IN ('id')");
    $fieldnames=array();
      if (mysql_num_rows($resultInsert) > 0) {
        while ($row = mysql_fetch_array($resultInsert)) {
            $fieldnames[] = $row['Field'];
            $values = array_intersect_key( $_POST, array_flip($fieldnames) );
        }
      }
      #update syntax
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:42:51.873

something along [these](http://ideone.com/oK6K5) lines to create the update statement.

```
// todo sanitise with mysql_escape_string()
foreach($arr as $key => $v) {
    $val = is_numeric($v) ? $v : "'" . $v . "'";

    $set .= sprintf("%s=%s%s", $key, $val, ($v == end($arr) ? "" : ", "));
}

$sql = sprintf("UPDATE %s SET %s", $table, $set); 
```

# css - CSS内联与数据URI编码？

> ID：11277581
> 
> 赞同：3
> 
> 时间：2012-06-30T20:51:26.090
> 
> 标签：css, data-uri

今天早上我正在查看某人网站的实现，看到他们通过 LINK 标记中的 data-uri 定义 CSS。

我理解将图像放入 data-uri 并将其*包含在 CSS 中*的合理性，但我不清楚为什么有人会选择以这种方式包含 CSS，而您可以轻松地内联。

我确实看到他们在链接中有一个 ID。难道他们是从 DOM 中动态获取这个 CSS，然后将它用于动态生成元素的“样式”的值？我不是前端专家，但我相信还有其他方法可以做到这一点。

这是HTML：

```
<link id="noteanywherecss" media="screen" type="text/css" rel="stylesheet" href="data:text/css,.note-anywhere%20.closebutton%7Bbackground-image%3A%20url%28chrome-extension%3A//bohahkiiknkelflnjjlipnaeapefmjbh/asset/deleteButton.png%29%3B%7D%0A.note-anywhere%20%7Bbackground-color%3A%20%23FFF046%3B%7D%0A.note-anywhere%20%7Bcolor%3A%20%23000066%3B%7D%0A.note-anywhere%20%20.edit%20%7Bfont-family%3A%20Arial%2C%20Helvetica%2C%20sans-serif%3B%7D%0A.note-anywhere%20%20.edit%20%7Bfont-size%3A%2014px%3B%7D%0A.note-anywhere%20.timestamp%20%7Bbackground-color%3A%20%23DDBB00%3B%7D%0A.note-anywhere%20.timestamp%20%7Bcolor%3A%20%23FFFFFF%3B%7D"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:33:42.480

它似乎来自 NoteAnywhere chrome 插件，而不是您所在的任何站点。chrome 开发人员 API 中存在一个错误，`chrome-extension://`当将`chrome.tabs.insertCSS`. 它在一年前就解决了，所以你可能不会再看到这种解决方法了。

# javascript - object in javascript reference by this but not when using event listener

> ID：11277585
> 
> 赞同：1
> 
> 时间：2012-06-30T20:52:11.477
> 
> 标签：javascript, html, oop

Why is it that the `this` is not referencing the object, `myObject`?

When I do `console.log(this)` returns `undefined`... Why?

### Javascript:

```
var myObject = {

    product: document.getElementById('product'),

    button: document.getElementById('btn'),

    productView: function(){
        if (this.product.className === 'grid') {
            this.product.className = 'list';
        } else {
            this.product.className = 'grid';
        }
    },

    clickHandler: function(e) {
        var o = this;
        console.log(this);
        o.productView();
        e.preventDefault();
    },

    init: function (){
        this.button.addEventListener('click', this.clickHandler, false);
    }
};

myObject.init();​ 
```

[demo](http://jsfiddle.net/nAppk/1/)

Many Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T20:56:03.473

The `.this` in your handler method for the event refers to the object being clicked. Use something like var `self = myObject;` and then use `self` instead of `this`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:56:10.330

You need to bind `this` to the correct context of you object. I common way to achieve this is to assign a reference of the local `this` to another variable inside your init function:

```
init: function (){
    var that = this;
    this.button.addEventListener('click', function(e) {that.clickHandler(e)}, false);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T20:56:40.860

Calling `this.clickHandler()` there would set `this` to the object. However, you're merely passing the function to `addEventListener`, and the browser will set a custom `this` value when it calls the function.

If you want to bind the current `this` value, use `this.clickHandler.bind(this)`. The function returned by `bind` will also receive the "wrong" `this` value, but it calls `clickHandler` with the bound, correct `this` value.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-19T17:09:19.603

First just use 'this' for your click handler...

```
clickHandler: function(e) {
    console.log(this);
    this.productView();
    e.preventDefault();
} 
```

Then you have a few options. Here are two...

**Option A:**

```
init: function (){
    var o = this;
    this.button.addEventListener('click', function(e){
        o.clickHandler(e);
    }, false);
} 
```

**Option B:**

```
init: function (){
    this.button.addEventListener('click', this.clickHandler.bind(this), false);
} 
```

I asked a related question about which of these options is preferrable: [When should a JavaScript reference object be used versus .bind()?](https://stackoverflow.com/q/25938496/1766230)

# iphone - 以编程方式调用 Popover 不起作用

> ID：11277594
> 
> 赞同：0
> 
> 时间：2012-06-30T20:54:53.920
> 
> 标签：iphone, ios, ipad, popover, uistoryboardsegue

我在下面的目标是通过两条路径之一出现一个弹出框。

第一个是在按下按钮时明确显示，第二个是倒计时计时器到期时。

第一个正在工作 - 我将 Storyboard Segue 配置为 Popover 并绑定到按钮。按下按钮时，会出现一个弹出框。伟大的！

第二个不是-我有一个计时器（NSTimer），它每秒调用一个方法，该方法使用倒计时中剩余的秒数更新标签。当倒计时达到零时，我想自动调用弹出框。我尝试了两种方法 - 一种是以编程方式调用按钮 ( `[self popoverButton:self]`)。另一种是使用以下代码：

```
PopViewController *myPopVC = [[PopViewController alloc] init];
UIStoryboardSegue *aSegue = [[UIStoryboardSegue alloc] initWithIdentifier:@"popoverSegue" source:self destination:myPopVC];
[self prepareForSegue:aSegue sender:self];
[aSegue perform]; 
```

这两种方法都不起作用，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:50:51.250

使用 popOverController 的方法：

```
[pop presentPopoverFromRect:rect inView:self.view permittedArrowDirections: UIPopoverArrowDirectionUp animated:YES]; 
```

您将需要创建一个 CGRect ，其中您想要 popOver 的箭头指向的位置。或者您可以分配给视图内任何 UIView 的 Frame。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:53:33.333

确保 segue 在情节提要中设置了标识符，然后调用 performSegueWithIdentifier 方法。有关如何在计时器到期时执行此操作的示例，请参阅此答案。

[当用户在 mapview 中点击 pin 时调用另一个视图](https://stackoverflow.com/questions/10834047/call-another-view-when-user-taps-on-pin-in-mapview/10834135#10834135)

# objective-c - 有没有办法获取 NSBezierPath 对象的所有点的 x,y 坐标？

> ID：11277595
> 
> 赞同：5
> 
> 时间：2012-06-30T20:55:04.683
> 
> 标签：objective-c, macos, cocoa, drawing, nsbezierpath

如果我有一个`NSBezierPath`对象，有没有办法获取所有绘制点的坐标（x，y）？我想`NSRect`沿着路径移动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:09:56.827

NSBezierPath 没有准确定义它绘制的点，但它确实包含定义其片段所需的点。您可以使用该[`elementAtIndex:associatedPoints:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBezierPath_Class/Reference/Reference.html#//apple_ref/occ/instm/NSBezierPath/elementAtIndex%3aassociatedPoints%3a)方法获取路径中每个向量元素的点。要获取路径中的每个点，您必须遍历所有元素并获取相关点。对于直线，此方法将为您提供端点，但如果您跟踪前一点，您可以在它们之间使用任意数量的点。

对于曲线，您需要实现代码来确定曲线的路径以沿曲线查找点。使用 来展平路径会简单得多，它会`bezierPathByFlatteningPath`返回一条所有曲线都转换为直线的新路径。

这是一个展平路径并打印结果中所有行的端点的示例。如果您的路径包含长直线，您将需要根据长度沿线添加点。

```
NSBezierPath *originalPath;
NSBezierPath *flatPath = [originalPath bezierPathByFlatteningPath];
NSInteger count = [flatPath elementCount];
NSPoint prev, curr;
NSInteger i;
for(i = 0; i < count; ++i) {
    // Since we are using a flattened path, no element will contain more than one point
    NSBezierPathElement type = [flatPath elementAtIndex:i associatedPoints:&curr];
    if(type == NSLineToBezierPathElement) {
        NSLog(@"Line from %@ to %@",NSStringFromPoint(prev),NSStringFromPoint(curr));
    } else if(type == NSClosePathBezierPathElement) {
        // Get the first point in the path as the line's end. The first element in a path is a move to operation
        [flatPath elementAtIndex:0 associatedPoints:&curr];
        NSLog(@"Close line from %@ to %@",NSStringFromPoint(prev),NSStringFromPoint(curr));
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-30T21:01:36.960

不，因为路径是基于矢量的，而不是基于像素的。您必须在 a 中渲染路径`CGContextRef`，然后检查从中设置了哪些像素。但是没有内置的方法。

但是，如果您需要沿路径移动一个矩形，您可以使用 a`CALayer`来执行此操作，尽管我不完全确定如何操作。

# php - 登录html页面后出错

> ID：11277600
> 
> 赞同：0
> 
> 时间：2012-06-30T20:56:00.283
> 
> 标签：php, javascript, html, extjs

所以，在尝试登录到本地主机中的 html 页面后，我在 firebug 中遇到了这个错误。我正在尝试建立一个登录页面。使用 php 和 extjs 3.2.1

这是 html 行的第一行的错误

DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"

我的 php 代码使用 php5.3.10

```
 <?php

ob_start();
$host="localhost"; // Host name 
$username=""; // Mysql username 
$password=""; // Mysql password 
$db_name="my_db"; // Database name 
$tbl_name="my_user"; // Table name 

mysql_connect("$host", "$Username", "$Password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$Username=$_POST['Username']; 
$Password=$_POST['Password']; 

$Username = stripslashes($Username);
$Password = stripslashes($Password);
$Username = mysql_real_escape_string($Username);
$Password = mysql_real_escape_string($Password);
$sql="SELECT * FROM $tbl_name WHERE Username='$Username' and Password='$Password'";
$result=mysql_query($sql);

$count=mysql_num_rows($result);

if($count==1){

session_register("Username");
session_register("Password"); 
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}
ob_end_flush();
?> 
```

我只想先测试页面 login_success.php 页面。

```
<html>
<body>
Login Successful
</body>
</html> 
```

html代码

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"      "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<!--  library-->
<title>Sign In</title>
<link rel="stylesheet" type="text/css" href="./../ext-3.2.1/resources/css/ext-all.css"/>

<!-- GC -->
<!-- LIBS -->

<script type="text/javascript" src="./../ext-3.2.1/adapter/ext/ext-base.js"></script>

<!-- ENDLIBS -->

<script type="text/javascript" src="./../ext-3.2.1/ext-all.js"></script>

<link rel="stylesheet" type="text/css" href="css/forms.css"/>

<!-- <link rel="stylesheet" type="text/css" href="./../ext-3.2.1/shared/examples.css"/>-           ->

<center><img src="image/logonew.png" width="900" height="420"></center>
<div id="Sign In" style="margin:auto;"></div>    
<style type="text/css">
div {text-align:center}

</style>

</head>

<body>

<script type="text/javascript" src="js/sign_in.js"></script>

</body>
</html> 
```

# vim - 右侧taglist窗口的vim对齐

> ID：11277601
> 
> 赞同：2
> 
> 时间：2012-06-30T20:56:01.780
> 
> 标签：vim, taglist

这是我的 .vimrc：

```
" Key mappings
:map <F12> :WMToggle<cr>

" configuring taglist
    let Tlist_Use_Right_Window = 1 
```

这些是我安装的插件：

```
-rw-r--r-- 1 john john  36129 Nov  8  2010 bufexplorer.vim
-rw-r--r-- 1 john john 147930 Set 21  2007 taglist.vim
-rw-r--r-- 1 john john   2760 Abr  2  2011 vimballPlugin.vim
-rw-r--r-- 1 john john  40661 Jun 30 12:58 winfileexplorer.vim
-rw-r--r-- 1 john john  43224 Jun 30 12:58 winmanager.vim
-rw-r--r-- 1 john john  13418 Jun 30 12:58 wintagexplorer.vim 
```

但是 taglist 窗口仍然显示在左侧。这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T17:11:26.557

我如何解决这个问题：

.vimrc：

```
" winmanager definitions
        ...
    let winManagerWindowLayout = 'FileExplorer|BufExplorer'    " just file and buf exp.

" TagList definitions
        ...
    let Tlist_Use_Right_Window = 1

" mappings
    map <silent> <F12> :TlistToggle<cr> :WMToggle<cr> 
```

描述：我从 WinManager 中提取了 TagList 并定义为在打开 WinManager 的同时打开它。这是一个技巧，但有效。=D

# c# - 公共类 - “由于其保护级别而无法访问。只能处理公共类型。”

> ID：11277605
> 
> 赞同：15
> 
> 时间：2012-06-30T20:56:22.227
> 
> 标签：c#, winforms, class-visibility

我正在做一个测试项目来了解对象的 XML 序列化，但我遇到了一个奇怪的运行时错误：

```
namespace SerializeTest
{

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void serializeConnection(Conn connection)
    {
        XmlSerializer serializer = new XmlSerializer(typeof(Conn));
        TextWriter textWriter = new StreamWriter(@"serialized.xml");
        serializer.Serialize(textWriter, connection);
        textWriter.Close();
    }

    static List<Conn> deserializeConnection()
    {
        XmlSerializer deserializer = new XmlSerializer(typeof(List<Conn>));
        TextReader textReader = new StreamReader(@"serialized.xml");
        List<Conn> connectionList;
        connectionList = (List<Conn>)deserializer.Deserialize(textReader);
        textReader.Close();

        return connectionList;
    }

    private void btnSerialize_Click(object sender, EventArgs e)
    {
        Conn conn = getConnection();
        serializeConnection(conn);

    }

    private Conn getConnection()
    {
        Conn connection = new Conn();
        connection.connectionName = txtName.Text;
        connection.address = txtAddress.Text;
        connection.height = 2542;
        connection.width = 4254;
        connection.password = txtPassword.Text;
        connection.smartSizing = false;
        connection.username = txtUsername.Text;
        connection.port = 474;
        return connection;
    }

    private void btnDeserialize_Click(object sender, EventArgs e)
    {
        int count = deserializeConnection().Count;
        lblStatus.Text = "Count: " + count;
    }
}

class Conn
{
    public Conn()
    {
    }
    public string connectionName { get; set; }
    public int height { get; set; }
    public int width { get; set; }
    public string address { get; set; }
    public string username { get; set; }
    public string password { get; set; }
    public int port { get; set; }
    public bool smartSizing { get; set; }
}

} 
```

该类是公开的 - 我不明白是什么导致了这个错误。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-30T20:59:40.663

> 班级是公开的

不，这不对。这是声明：

```
class Conn
{
    ...
} 
```

您没有指定任何访问修饰符，所以它默认为`internal`（假设它是非嵌套的）。仅仅因为它有一个公共构造函数并不能使其公开。您需要明确公开：

```
public class Conn
{
    ...
} 
```

# c# - 用于获取值为“In”的单个列的数据的 Lambda 表达式

> ID：11277606
> 
> 赞同：2
> 
> 时间：2012-06-30T20:56:26.820
> 
> 标签：c#, lambda

我有一个包含 3 列（A、B、C）的 SQL 表“tablex”。

以下 lambda 表达式返回 10 行。

```
var versions = versionRepository.GetVersions(a.id) 
```

10个结果的B列存储数据为：1,2,3,4,5,6,7,8,9,10

有人可以帮助我使用 lambda 表达式仅获得 C 列的结果，其中 b 在 (2,3,4) 中。

所以我应该只得到 3 行 C 列数据。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-30T21:02:45.350

使用`Where`扩展方法过滤数据，`Select`扩展方法只获取`C`属性：

```
var versions =
  versionRepository.GetVersions(a.id)
  .Where(v => v.B >= 2 && v.B <= 4)
  .Select(v => v.C); 
```

（该部分`v => v.C`是 lambda 表达式的示例。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T21:17:16.470

您可以使用`Contains`它来检查它是否与您要查找的数字之一匹配：

```
List<int> ids = new List<int> { 2, 3, 4, 10 };

var versions =
  versionRepository.GetVersions(a.id)
  .Where(v => ids.Contains(v.B))
  .Select(v => v.C); 
```

这里的技巧是将其反转，而不是检查 B 是否是所需的数字之一，只需检查数字列表是否包含 B。

# c# - C# Silverlight - 来自 Uri 的 XmlDictionary

> ID：11277607
> 
> 赞同：0
> 
> 时间：2012-06-30T20:56:30.490
> 
> 标签：c#, xml, silverlight, filestream, relative-path

我一直在为一家公司的网站开发 Silverlight 应用程序，但遇到了一个问题。

到目前为止我一直在本地编程，现在我需要将程序发布到网站上；问题是 FileStream 只能访问具有提升权限的本地文件。

这是一段代码：

```
using (FileStream fileStream = new FileStream(@"E:\Users\LUPUS\Documents\Visual Studio 2010\Projects\Lycaon5\Lycaon5\acids.xdb", FileMode.Open))
 {
using (XmlDictionaryReader reader = XmlDictionaryReader.CreateTextReader(fileStream, XmlDictionaryReaderQuotas.Max))
  {
    //Read the XML file out.
  }
 } 
```

在不更改与 XmlDictionaryReader 阅读器有关的任何内容的情况下 - 我如何才能从相对 Uri 中读取文件？

非常感谢，

抢。

Ps为缺乏格式道歉，我是穴居人，我不知道怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:05:54.800

编译时将文件与程序集一起嵌入。然后您可以将其作为资源流读取：http: [//msdn.microsoft.com/en-us/library/cc296240%28VS.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc296240%28VS.95%29.aspx)

（确保您将文件嵌入`Resource`为该方法的类型）

您的代码*可能*看起来像这样来获取文件流：

```
Uri uri = new Uri("/MyAssemblyName;component/acids.xdb", UriKind.Relative);
StreamResourceInfo streamInfo = Application.GetResourceStream(uri);
Stream fileStream = streamInfo.Stream;

using (XmlDictionaryReader reader = XmlDictionaryReader.CreateTextReader(fileStream, XmlDictionaryReaderQuotas.Max))
{
    //Read the XML file out.
} 
```

编辑：正如 Tim S 所指出的，这仅适用于数据文件是静态的并且在编译时固定的情况。否则，您可以使用其他方法从网站（如他链接到的）下载文件。

# ruby-on-rails - NoMethodError in SessionsController#create when call a method in user model

> ID：11277612
> 
> 赞同：1
> 
> 时间：2012-06-30T20:57:29.640
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, nomethoderror

我正在开发 Rails 3 应用程序并使用 koala gem 连接到 facebook graph api。我还使用omniauth 来验证用户。

我收到以下错误：

```
NoMethodError in SessionsController#create
undefined method `add_friends' for #<User:0x007fcfcb1a87e8>

app/models/user.rb:28:in `block in from_omniauth'
app/models/user.rb:6:in `tap'
app/models/user.rb:6:in `from_omniauth'
app/controllers/sessions_controller.rb:3:in `create' 
```

在 ruby​​ 文档中它说：“在没有定义它的接收器上调用方法并且也无法使用 method_missing 响应时引发。”

***但是我定义了一个方法，那么为什么会出现此错误？我该如何解决？***

在我的 SessionController 我做这样的事情：

```
class SessionsController < ApplicationController
  def create
    user = User.from_omniauth(env['omniauth.auth'])
    session[:user_id] = user.id
    redirect_to root_url, notice: "Signed in!"
  end
end 
```

这是我的用户模型：

```
class User < ActiveRecord::Base
  #attr_accessible :provider, :uid, :token, :email, :name, :first_name, :last_name, :image, :gender, :location, :school, :year
  has_many :friends

  def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|
      user.provider = auth["provider"]
      user.uid = auth["uid"]
      user.name = auth["info"]["name"]
      user.first_name = auth["info"]["first_name"]
      user.last_name = auth["info"]["last_name"]
      user.image = auth["info"]["image"]
      user.email = auth["info"]["email"]
      user.gender = auth["extra"]["raw_info"]["gender"]
      user.location = auth["extra"]["raw_info"]["location"]["name"]          
      user.token = auth["credentials"]["token"]

      user.add_friends
      user.save!
      user

    end

    def add_friends
      @facebook.get_connections("me", "friends").each do |hash|
        self.friends.find(:name => hash['name'], :uid => hash['id']).first_or_create
      end
    end

    private 

    def facebook
      @facebook ||= Koala::Facebook::API.new(token)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:22:45.793

在您发布的代码`def add_friends`中实际上是在您的`from_omniauth`类方法中，因此最终也是类方法，而不是实例方法。

将它（和 facebook 方法）移出那里，你应该没问题。您可能还想调用您的`facebook`方法，而不是直接访问实例变量。

# java - 在 GridView 上保持背景的纵横比

> ID：11277615
> 
> 赞同：2
> 
> 时间：2012-06-30T20:58:06.703
> 
> 标签：java, android, gridview

我在 GridView 上有一个图像作为背景，我希望它保持其纵横比。我希望它与手机的高度相匹配，并使用与纵横比相匹配的宽度。

这是当前代码：

```
<GridView xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@+id/gridview"
android:scaleType="centerInside"
android:background="@drawable/gytbg"
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
android:columnWidth="10dp"
android:numColumns="2"
android:verticalSpacing="20dp"
android:horizontalSpacing="0dp"
android:stretchMode="columnWidth"
android:gravity="center"
/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:38:14.353

```
android:scaleType="centerCrop" 
```

这应该使图像适合 GridView 的高度，保持纵横比，并裁剪剩余的宽度（除非在高度匹配时图像的宽度小于 GridView 的宽度）。

例如

如果您有一个宽度为 400dp，高度为 800dp 的 GridView

600 x 600 的图像将适合高度，然后裁剪剩余的宽度。

但是，如果 GridView 是横向的（宽度为 400dp，高度为 300dp），则 600 x 600 的图像将适合宽度，然后裁剪高度。

如果您只希望它适合高度（假设高度可能会以编程方式或由于不同设备的屏幕而发生变化），我建议使图像更宽，以便即使在使用具有非常宽的纵横比的 GridView 时，它将选择适合高度，并裁剪宽度。

# c++ - OMSETRENDERTARGETS_INVALIDVIEW 切换 RenderTargets (DirectX)

> ID：11277617
> 
> 赞同：0
> 
> 时间：2012-06-30T20:58:25.273
> 
> 标签：c++, directx, render, rendertarget

我试图渲染到纹理以将其用于后处理。我已经阅读了很多关于这些东西的教程并且现在已经为自己尝试过，但显然我做错了什么。我已经在问关于这个主题的另一个问题，但由于这个问题是一个不同的问题，我认为创建一个新问题是一个更好的主意。所以首先这些是我一遍又一遍的错误消息：

```
D3D11: ERROR: ID3D11DeviceContext::OMSetRenderTargets: The RenderTargetView at slot 0 is not compatable with the DepthStencilView. DepthStencilViews may only be used with RenderTargetViews if the effective dimensions of the Views are equal, as well as the Resource types, multisample count, and multisample quality. The RenderTargetView at slot 0 has (w:400,h:300,as:1), while the Resource is a Texture2D with (mc:1,mq:0). The DepthStencilView has (w:1280,h:720,as:1), while the Resource is a Texture2D with (mc:1,mq:0). D3D11_RESOURCE_MISC_TEXTURECUBE factors into the Resource type, unless GetFeatureLevel() returns D3D_FEATURE_LEVEL_10_1 or greater. [ STATE_SETTING ERROR #388: OMSETRENDERTARGETS_INVALIDVIEW ]
D3D11: ERROR: ID3D11DeviceContext::Draw: Rasterization Unit is enabled (PixelShader is not NULL or Depth/Stencil test is enabled and RasterizedStream is not D3D11_SO_NO_RASTERIZED_STREAM) but position is not provided by the last shader before the Rasterization Unit. [ EXECUTION ERROR #362: DEVICE_DRAW_POSITION_NOT_PRESENT ] 
```

和：

```
D3D11: ERROR: ID3D11DeviceContext::Draw: Vertex Shader - Geometry Shader linkage error: Signatures between stages are incompatible. The input stage requires Semantic/Index (RADIUS,0) as input, but it is not provided by the output stage. [ EXECUTION ERROR #342: DEVICE_SHADER_LINKAGE_SEMANTICNAME_NOT_FOUND ]
D3D11: ERROR: ID3D11DeviceContext::Draw: Vertex Shader - Geometry Shader linkage error: Signatures between stages are incompatible. The input stage requires Semantic/Index (TEXTUREINDEX,0) as input, but it is not provided by the output stage. [ EXECUTION ERROR #342: DEVICE_SHADER_LINKAGE_SEMANTICNAME_NOT_FOUND ]
D3D11: ERROR: ID3D11DeviceContext::Draw: Geometry Shader - Pixel Shader linkage error: Signatures between stages are incompatible. The input stage requires Semantic/Index (POSITION,0) as input, but it is not provided by the output stage. [ EXECUTION ERROR #342: DEVICE_SHADER_LINKAGE_SEMANTICNAME_NOT_FOUND ]
D3D11: ERROR: ID3D11DeviceContext::OMSetRenderTargets: The RenderTargetView at slot 0 is not compatable with the DepthStencilView. DepthStencilViews may only be used with RenderTargetViews if the effective dimensions of the Views are equal, as well as the Resource types, multisample count, and multisample quality. The RenderTargetView at slot 0 has (w:400,h:300,as:1), while the Resource is a Texture2D with (mc:1,mq:0). The DepthStencilView has (w:1280,h:720,as:1), while the Resource is a Texture2D with (mc:1,mq:0). D3D11_RESOURCE_MISC_TEXTURECUBE factors into the Resource type, unless GetFeatureLevel() returns D3D_FEATURE_LEVEL_10_1 or greater. [ STATE_SETTING ERROR #388: OMSETRENDERTARGETS_INVALIDVIEW ] 
```

我很确定我误解了这个渲染目标切换和东西的一个主要方面。创建我的 DirectX 设备时，我也在创建这个：

```
 D3D11_TEXTURE2D_DESC textureDesc;
    D3D11_RENDER_TARGET_VIEW_DESC renderTargetViewDesc;
    D3D11_SHADER_RESOURCE_VIEW_DESC shaderResourceViewDesc;

    ZeroMemory(&textureDesc, sizeof(textureDesc));

    textureDesc.Width = 800/2;
    textureDesc.Height = 600/2;
    textureDesc.MipLevels = 1;
    textureDesc.ArraySize = 1;
    textureDesc.Format = DXGI_FORMAT_R32G32B32A32_FLOAT;
    textureDesc.SampleDesc.Count = 1;
    textureDesc.Usage = D3D11_USAGE_DEFAULT;
    textureDesc.BindFlags = D3D11_BIND_RENDER_TARGET | D3D11_BIND_SHADER_RESOURCE;
    textureDesc.CPUAccessFlags = 0;
    textureDesc.MiscFlags = 0;

    pDevice->CreateTexture2D(&textureDesc, NULL, &renderTargetTextureMap);

    renderTargetViewDesc.Format = textureDesc.Format;
    renderTargetViewDesc.ViewDimension = D3D11_RTV_DIMENSION_TEXTURE2D;
    renderTargetViewDesc.Texture2D.MipSlice = 0;

    .
    pDevice->CreateRenderTargetView(renderTargetTextureMap, &renderTargetViewDesc, &renderTargetViewMap);

    shaderResourceViewDesc.Format = textureDesc.Format;
    shaderResourceViewDesc.ViewDimension = D3D11_SRV_DIMENSION_TEXTURE2D;
    shaderResourceViewDesc.Texture2D.MostDetailedMip = 0;
    shaderResourceViewDesc.Texture2D.MipLevels = 1;

    pDevice->CreateShaderResourceView(renderTargetTextureMap, &shaderResourceViewDesc, &shaderResourceViewMap);

    D3DVERTEX quad[4] = {
        {D3DXVECTOR3(0,0,0), D3DXVECTOR2(0,0)},
        {D3DXVECTOR3(1,1,0), D3DXVECTOR2(1,1)},
        {D3DXVECTOR3(1,0,0), D3DXVECTOR2(1,0)},
        {D3DXVECTOR3(0,1,0), D3DXVECTOR2(0,1)}};

    HRESULT hr;

    D3D11_SUBRESOURCE_DATA InitData;
    InitData.pSysMem = &quad[0];
    InitData.SysMemPitch = sizeof(D3DVERTEX);
    InitData.SysMemSlicePitch = 0;

    D3D11_BUFFER_DESC bufferDesc;
    bufferDesc.Usage            = D3D11_USAGE_DEFAULT;
    bufferDesc.ByteWidth        = 4 * InitData.SysMemPitch;
    bufferDesc.BindFlags        = D3D11_BIND_VERTEX_BUFFER;
    bufferDesc.CPUAccessFlags   = 0;
    bufferDesc.MiscFlags        = 0;

    V_RETURN(pDevice->CreateBuffer( &bufferDesc, &InitData, &m_pVertexBuffer ));

    const D3D11_INPUT_ELEMENT_DESC layout[] = // http://msdn.microsoft.com/en-us/library/bb205117%28v=vs.85%29.aspx
    {
        { "POSITION",          0, DXGI_FORMAT_R32G32B32_FLOAT, 0, D3D11_APPEND_ALIGNED_ELEMENT, D3D11_INPUT_PER_VERTEX_DATA, 0 },
        { "TEXCOORD",          0, DXGI_FORMAT_R32G32_FLOAT,    0, D3D11_APPEND_ALIGNED_ELEMENT, D3D11_INPUT_PER_VERTEX_DATA, 0 },
    };
    UINT numElements = sizeof( layout ) / sizeof( layout[0] );
    D3DX11_PASS_DESC passDesc;
    m_pEffect->GetTechniqueByName("Render")->GetPassByName("P0_PP")->GetDesc(&passDesc);

    V_RETURN( pDevice->CreateInputLayout( layout, numElements, passDesc.pIAInputSignature,
              passDesc.IAInputSignatureSize, &m_pInputLayout ) ); 
```

所以我正在创建一个 ShaderResourceView 和一个 RenderTargetView 以及一个带有顶点缓冲区的立方体来绘制这个将绘制纹理的立方体。

现在，在所有其他东西被绘制之后的每一帧更新中，我都使用这个：

```
 pDevice->GetImmediateContext(&pd3dImmediateContext);
    pd3dImmediateContext->OMSetRenderTargets( 1, &renderTargetViewMap, pDSV );

    pd3dImmediateContext->ClearRenderTargetView(renderTargetViewMap, g_ClearColor);
    ID3D11Buffer* vbs[] = { m_pVertexBuffer, };
    unsigned int strides[] = { sizeof(D3DVERTEX), }, offsets[] = { 0, };

    pd3dImmediateContext->IASetVertexBuffers(0,1, vbs, strides, offsets);
    pd3dImmediateContext->IASetInputLayout(m_pInputLayout);
    pd3dImmediateContext->IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_POINTLIST);

    //TODO: Move to header file.
    ID3DX11EffectShaderResourceVariable* g_SpriteEV;

    g_SpriteEV = m_pEffect->GetVariableByName("g_PostProcessTex")->AsShaderResource();

    g_SpriteEV->SetResource(shaderResourceViewMap);
    m_pEffect->GetTechniqueByName("Render")->GetPassByName("P0_PP")->Apply(0, pd3dImmediateContext);

    pd3dImmediateContext->Draw(4, 0); 
```

我没有明确创建 depthStencilView 我猜这是我的主要错误。但我不知道如何创造这样的权利。我对这一切在后台如何运作感到非常困惑……也许有人愿意解释一下。我在这里做任何事情还是这只是错误的？:p

感谢任何关心帮助的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:47:09.663

认为我能够在本教程的帮助下做到这一点： [http ://www.rastertek.com/dx11tut22.html](http://www.rastertek.com/dx11tut22.html)

# php - 如何在php中提取2个标签之间的文本

> ID：11277620
> 
> 赞同：1
> 
> 时间：2012-06-30T20:58:50.847
> 
> 标签：php

我需要在一块文本中找到 2 个标签并保留它们之间的任何文本。

例如，如果“开始”标签是`-----start-----`，而“结束”标签是`-----end-----`

鉴于此文本：

```
rtyfbytgyuibg-----start-----isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r
-----end-----gcgkhjkn 
```

我只需要保留两个标签之间的文本：`isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r`

有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-30T21:02:39.923

这里有几种方法：

```
$lump = 'rtyfbytgyuibg-----start-----isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r-----end-----gcgkhjkn';
$start_tag = '-----start-----';
$end_tag = '-----end-----';

// method 1
if (preg_match('/'.preg_quote($start_tag).'(.*?)'.preg_quote($end_tag).'/s', $lump, $matches)) {
    echo $matches[1];
}

// method 2 (faster)
$startpos = strpos($lump, $start_tag) + strlen($start_tag);
if ($startpos !== false) {
    $endpos = strpos($lump, $end_tag, $startpos);
    if ($endpos !== false) {
        echo substr($lump, $startpos, $endpos - $startpos);
    }
}

// method 3 (if you need to find multiple occurrences)
if (preg_match_all('/'.preg_quote($start_tag).'(.*?)'.preg_quote($end_tag).'/s', $lump, $matches)) {
    print_r($matches[1]);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-30T21:01:35.940

试试这个：

```
$start = '-----start-----';
$end   = '-----end-----';
$string = 'rtyfbytgyuibg-----start-----isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r-----end-----gcgkhjkn';
$output = strstr( substr( $string, strpos( $string, $start) + strlen( $start)), $end, true);
echo $output; 
```

这[将打印](http://viper-7.com/2a7y2L)：

```
isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-18T18:59:40.280

如果您的字符串实际上是 HTML 数据，则必须添加**htmlentities($lump)**以便它不会返回空：

```
$lump = '<html><head></head><body>rtyfbytgyuibg-----start-----<div>isnv4b987b6vdc5y6ughnjmn9b8v76ctyubinn98b76r</div>-----end-----gcgkhjkn</body></html>';
$lump = htmlentities($lump) //<-- HERE
$start_tag = '-----start-----';
$end_tag = '-----end-----';

// method 1
if (preg_match('/'.preg_quote($start_tag).'(.*?)'.preg_quote($end_tag).'/s', $lump, $matches)) {
        echo $matches[1];
}

// method 2 (faster)
$startpos = strpos($lump, $start_tag) + strlen($start_tag);
if ($startpos !== false) {
   $endpos = strpos($lump, $end_tag, $startpos);
        if ($endpos !== false) {
            echo substr($lump, $startpos, $endpos - $startpos);
        }
}

// method 3 (if you need to find multiple occurrences)
if (preg_match_all('/'.preg_quote($start_tag).'(.*?)'.preg_quote($end_tag).'/s', $lump, $matches)) {
        print_r($matches[1]);
 }

// method 4 
$output = strstr( substr( $string, strpos( $string, $start) + strlen( $start)), $end, true);

//Turn back to regular HTML
echo htmlspecialchars_decode($output); 
```

# f# - F# 中用于矩阵运算检查的复合度量单位

> ID：11277628
> 
> 赞同：2
> 
> 时间：2012-06-30T20:59:43.577
> 
> 标签：f#, units-of-measurement

度量单位的**严重**用例之一是矩阵运算：矩阵 a*b 与 c*d 的内积仅在 b = c 时有效，等等......

但是，我没有看到任何“复合单元”的构造，例如所需的构造。

我们有什么方法可以让 F# 中的类型系统检查它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T22:20:37.360

免责声明：从手机发送 => 可能包含错误

我想说这种检查可以使用 UoM 或[幻像类型](https://stackoverflow.com/questions/3583679/implementing-phantom-types-in-f)以某种方式实现：

```
[<Measure>] type s
type M<[<Measure>]'w, [<Measure>] 'h>() = 
    static member (*) (a : M<'a, 't>, b : M<'t, 'b>) : M<'a, 'b> = failwith "NYI"
let x = M<s ^ 3, s ^ 3>()
let y = M<s ^ 3, s>()
let z  = x * y // M<s ^ 3, s> 
```

然而问题是：使用起来有多方便......

# genetic-algorithm - matlab ode15s 在 GA 中调用时不起作用

> ID：11277630
> 
> 赞同：0
> 
> 时间：2012-06-30T21:00:17.710
> 
> 标签：genetic-algorithm, matlab, ode, differential-equations

我有一个套管的数学（参数）模型。模型的输入是位移（正弦波），以力为输出（在各个时间步长）。

模型的参数将使用 GA 进行识别，力方程将使用 ode15s 求解器求解。

当假设一组参数（不使用 GA）时，求解器给出输出，但是当从 GA 调用时，我得到以下错误`n`次数：

> 警告：矩阵是奇异的，接近奇异的或严重缩放的。结果可能不准确。RCOND = NaN。

最后

> 警告：在 t=1.570796e+000 时失败。如果不将步长减小到低于时间 t 允许的最小值 (3.552714e-015)，则无法满足积分容差。

我有点困惑，因为代码在不使用 GA 而不是 GA 的情况下可以正常工作。我将非常感谢您的投入。

提前非常感谢。

代码：主调用

```
ga_custom={@GA_test,measurement_data,excitation};
[x,fval,exitflag,output,population,scores]=ga(ga_custom,no_of_vars,[],[],[],[],lb,ub,[],options); 
```

GA_test 函数：

```
function error_fnc = GA_test(x,measurement_data,excitation)
error_fnc=0;   
F=my_force_Curve(excitation,x);    
for q=1:100  
    temp=(F(q)-measurement_data(q))^2;  
    error_fnc=error_fnc+temp;   
end   
end 
```

`my_force_Curve`计算单个模型的力：

```
[T,y]=ode15s(@(T,y)differential_BW(T,y,x),tspan,[0 0 0 0]); 
```

并`differential_BW`解方程：

```
function dy=differential_BW(t,y,initial_guess)   
dy=zeros(4,1);
dy(1)=..
dy(2)=.. 
dy(3)=..
dy(4)=.. 
```

抱歉，如果它太长了。

再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T08:51:00.227

好吧，在我看来，对于某些参数，ODE 求解器无法求解方程。

我可以看到两个可能的原因：

1.  您的 GA 可能会同时评估人口中的不同成员。如果您使用可能会根据参数或运行而改变的全局或持久值，则会导致不确定的行为，从而导致不收敛。您可以通过重构这些`global`/`persistent`变量并以另一种方式传递这些值来解决此问题。另一个解决方案是确保 GA 以串行方式运行所有内容。这可以通过设置`UseParallel`为`'never'`with `gaoptimset`（无论如何这是默认选项）来完成。

2.  对于某些参数值，您的 ODE 不会收敛。这与 GA 本身无关。如果您要尝试 GA 在某个时候选择的参数值并手动重复运行，您应该会遇到同样的问题。我想做的是，`try ... catch`在您的 ODE 求解器周围放置一个并检查收敛问题。如果它不收敛，你可以做几件事：

    *   只需报告参数值或将它们保存在某处。这样，您可以通过手动运行目标/ODE 来检查此时发生的情况。这应该会出现同样的问题，但您至少可以尝试调试所有内容。例如，如果您发现某些参数不兼容，您可以检查并返回对您的目标（`0`或者可能`NaN`）不利的值。
    *   直接为目标函数返回一个不利的值。这样，搜索可以继续，并且在突变期间不会选择该点。但是，如果您不知道为什么这些参数值不能正确收敛，那就有点麻烦了。

# ruby-on-rails - form_for([@post, @post.comments.build]) 在 Rails 中具有资源层次结构的助手

> ID：11277631
> 
> 赞同：1
> 
> 时间：2012-06-30T21:00:43.103
> 
> 标签：ruby-on-rails, form-for

按照[ROR 的指南入门教程](http://guides.rubyonrails.org/getting_started.html)，我正在制作一个博客，其中包含两个模型 - 发布和评论 - 在 config/routes.rb 文件中具有以下关联：

```
resources :posts do
  resources :comments
end 
```

因此，`view/posts/show.html.erb`出于显示原因，评论和评论表单会显示在博客页面上。但是，我一直在理解`@post, @post.comments.build`以下代码片段中的含义：

```
<h2>Add a comment:</h2>
<%= form_for([@post, @post.comments.build]) do |f| %>
  <div class="field">
    <%= f.label :commenter %><br />
    <%= f.text_field :commenter %>
  </div>
  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_area :body %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

此外，在重构期间，作者已将代码移动以显示对`view/comments/_comment.html.erb`部分的注释，并将其渲染为`view/posts/show.html.erb`使用

```
<%= render @post.comments %> 
```

现在，这将为集合`app/views/comments/_comment.html.erb`中的每个评论呈现部分内容。`@post.comments`当 render 方法遍历`@post.comments`集合时，它将每个注释分配给与局部变量命名相同的局部变量，在这种情况下，注释随后在局部变量中可供我们显示。

问：rails 如何从上面的代码行推断部分名称和要传递给部分以显示注释的变量？

另外，您能否根据上述博客应用程序解释以下语句的含义。参考： http: [//guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

```
The @post object is available to any partials rendered in the view because we defined it as an instance variable. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:19:44.827

**第一个问题。**

是什么`[@post, @post.comments.build]`意思？

基本上，这是在您的表单中实例化将要生成的内容。,`@post`它也将构建`@post.comments`。但这似乎没有必要，我认为您可以通过以下方式完成相同的操作：

```
<%= form_for @post do |f| %> 
```

除非它自己生成表单，否则您也有机会在同一时间写评论。

**第二个问题。**

部分工作的方式是，只要它们与对象同名。在您的情况下`_comment.html.erb`，名称与您的模型相同`Comment`。所以 Rails 会自动假设这就是你要找的东西。

如果您要将局部名称更改为其他名称，则应更具体地编写：

```
<%= render :partial => 'comments/sweet_comment_partial_name', :collection => @post.comments %> 
```

**更新**

啊，好吧，我没有意识到你指的是什么形式。这一个专门实例化这个：

```
[@post, @post.comments.build] 
```

指的是评论模型。但它说评论的父母是`@post`。因此，您具体引用的评论模型是 的子级`@post`，并且将构建在或附加到与该 关联的评论数组中`@post`。

# c# - 当 DatagridviewComboBox 选定索引更改时更改 DatagridviewTextBox 文本

> ID：11277632
> 
> 赞同：2
> 
> 时间：2012-06-30T21:00:52.140
> 
> 标签：c#, .net, winforms, datagridview, datagridcomboboxcolumn

在我的`DatagridView`，我有两列，`ComboxboxColumn`和`TextboxColumn`。我想在组合框选定索引更改时更改文本框的值（通常组合框已选择索引更改事件但`datagridviewComboBox`没有它）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:15:46.640

试试这两个简单的方法（顶部方法中的 '1' 是组合框列的索引）

您要修改的行将是 setter line `cel.Value =`，因为您可以将其更改为您喜欢的任何内容。

* * *

```
 private void dataGridView1_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
    {
        if (dataGridView1.CurrentCell.ColumnIndex == 1 && e.Control is ComboBox)
        {
            ComboBox comboBox = e.Control as ComboBox;
            comboBox.SelectedIndexChanged += LastColumnComboSelectionChanged;
        }
    }

    private void LastColumnComboSelectionChanged(object sender, EventArgs e)
    {
        var currentcell = dataGridView1.CurrentCellAddress;
        var sendingCB = sender as DataGridViewComboBoxEditingControl;
        DataGridViewTextBoxCell cel = (DataGridViewTextBoxCell)dataGridView1.Rows[currentcell.Y].Cells[0];
        cel.Value = sendingCB.EditingControlFormattedValue.ToString();
    } 
```

* * *

![在此处输入图像描述](../Images/368ebf96c95992571045cd6002b2eb41.png)

# c - C中的输入数据验证

> ID：11277641
> 
> 赞同：0
> 
> 时间：2012-06-30T21:02:28.420
> 
> 标签：c, validation

该函数用于验证输入。它会提示用户输入一个数值（大于或等于 0 ），直到满足条件。如果任何字符输入在数字之前或之后，输入将被视为无效。所需的输出是：

```
Enter a positive numeric number: -500
Error! Please enter a positive number:45abc
Error! Please enter a number:abc45
Error! Please enter a number:abc45abc
Error! Please enter a number:1800 
```

好吧，这似乎很容易：

```
#include <stdio.h>
main() {
    int ret=0;
    double num;
    printf("Enter a positive number:");
    ret = scanf("%.2lf",&num);

    while (num <0 ) {
        if (ret!=1){
            while(getchar()!= '\n');
            printf("Error!Please enter a number:");
        }
        else{
            printf("Error!Please enter a positive number:");
        }
        ret = scanf("%.2lf",&num);
    }
} 
```

但是，无论输入类型如何，我的代码都会一直`Error!Please enter a number:`输出。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:52:56.687

精度修饰符在[`scanf`](http://en.cppreference.com/w/c/io/fscanf). `-Wall`您可以通过启用所有编译器警告（在 gcc 中）轻松验证这一点。原因是实际输入实际值的方法不止一种，例如，您可以使用`0.2`或`2e-1`。

如果您只需要 2 位数字，只需在之后使用`scanf("%lf",&num)`并四舍五入该数字。请注意，精度修饰符适用于[`printf`](http://en.cppreference.com/w/c/io/fprintf)：

```
#include <stdio.h>

int main() {
    int ret = 0;
    double num = -1;
    printf("Enter a positive number:");
    ret = scanf("%lf",&num);

    while (num < 0 ) {
        if (ret != 1){
            while(getchar() != '\n');
            printf("Error! Please enter a number: ");
        }
        else{
            printf("Error! Please enter a positive number: ");
        }
        ret = scanf("%lf",&num);
    }
    printf("Your number is %.2lf",num);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:47:30.547

我认为仅使用 scanf() 进行验证时会遇到问题。您最好先扫描字符串，然后将其转换为数字。但是 scanf() 对 char 字符串进行扫描是危险的，因为它的输入长度不受限制，您必须为其提供一个指向有限长度输入缓冲区的指针。最好使用 fgets()，它允许您限制输入缓冲区的长度。

```
#include <stdio.h>
int main(int argc, char **argv)
{
    double num=-1;
    char input[80]; // arbitrary size buffer
    char* cp, badc; // badc is for detecting extraneous chars in the input
    int n;
    printf("Enter a positive number:");
    while (num < 0)
    {
        cp = fgets(input, sizeof(input), stdin);
        if (cp == input)
        {
            n = sscanf(input, "%lf %c", &num, &badc);
            if (n != 1) // if badc captured an extraneous char
            {
                printf("Error! Please enter a number:");
                num = -1;
            }
            else if (num < 0)
                printf("Error! Please enter a POSITIVE number:");
        }
    }

    printf("num = %f\n", num);

    return 0;
} 
```

# iphone - 在 UITableView 中列出文档目录内容

> ID：11277643
> 
> 赞同：1
> 
> 时间：2012-06-30T21:02:32.970
> 
> 标签：iphone, objective-c, ios, directory, tableview

因此，我对如何在表格视图中列出文档目录中的文件进行了广泛研究，经过深思熟虑，想出了这段代码。每当我运行它时，应用程序都会因 EXEC_BAD_ACCESS 而崩溃。我已经忙了好几个小时了，所以任何帮助都将不胜感激。

我所做的只是获取文档目录中的文件并尝试在表格视图中列出它们......

代码粘贴在下面的链接中。

[http://pastie.org/4178767](http://pastie.org/4178767)

编辑 - 应用程序在 numberOfRowsInSection: 方法中崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:12:26.930

这里似乎有问题：

```
cell.textLabel.text=@"File %d: %@", [directoryContent objectAtIndex:indexPath.row]; 
```

改成：

```
cell.textLabel.text=[NSString stringWithFormat:@"File %d: %@", [directoryContent objectAtIndex:indexPath.row]]; 
```

此外，您没有附加任何与 %d 格式说明符匹配的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:34:09.440

您是否使用 ARC（自动引用计数）？如果不是，您应该`retain`从`contentsOfDirectoryAtPath`.

```
directoryContent = [[[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:NULL] retain]; 
```

# iphone - 带有触摸增加速度的旋转轮

> ID：11277645
> 
> 赞同：0
> 
> 时间：2012-06-30T21:02:38.783
> 
> 标签：iphone, cocos2d-iphone, velocity, momentum

我在游戏中有一个滚轮控制，设置如下：

```
- (void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:[touch view]];
    location = [[CCDirector sharedDirector] convertToGL:location];

    if (CGRectContainsPoint(wheel.boundingBox, location))
    {
        CGPoint firstLocation = [touch previousLocationInView:[touch view]];
        CGPoint location = [touch locationInView:[touch view]];

        CGPoint touchingPoint = [[CCDirector sharedDirector] convertToGL:location];
        CGPoint firstTouchingPoint = [[CCDirector sharedDirector] convertToGL:firstLocation];

        CGPoint firstVector = ccpSub(firstTouchingPoint, wheel.position);
        CGFloat firstRotateAngle = -ccpToAngle(firstVector);
        CGFloat previousTouch = CC_RADIANS_TO_DEGREES(firstRotateAngle);

        CGPoint vector = ccpSub(touchingPoint, wheel.position);
        CGFloat rotateAngle = -ccpToAngle(vector);
        CGFloat currentTouch = CC_RADIANS_TO_DEGREES(rotateAngle);

        wheelRotation += (currentTouch - previousTouch) * 0.6; //limit speed 0.6
    }
} 
```

我通过执行以下操作在更新方法中更新轮子的旋转：

```
wheel.rotation = wheelRotation; 
```

现在，一旦用户松开滚轮，我希望它旋转回原来的位置，但不能不考虑用户所做的滑动速度。这是我真的无法理解的一点。因此，如果滑动产生很大的速度，那么车轮将继续沿该方向轻微移动，直到将车轮拉回起始位置的整体力开始起作用。

任何想法/代码片段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:32:48.570

限制轮子旋转 += currentTouch - previousTouch；
我是说

```
if (currentTouch - previousTouch > wantedLimit) {
wheelrotation += wantedLimit;
}
else {
wheelrotation += currentTouch - previousTouch;
} 
```

# objective-c - 在“强”之前需要一个属性属性

> ID：11277649
> 
> 赞同：0
> 
> 时间：2012-06-30T21:02:50.817
> 
> 标签：objective-c, ios, automatic-ref-counting, llvm, soundcloud

我正在将 SoundCloud API 添加到 iOS 项目中，但我没有使用 ARC。SoundCloud 代码使用

```
@property(nonatomic, strong, readonly) NSArray *accounts; 
```

我应该把它改成

```
@property(nonatomic, retain) NSArray *accounts; 
```

并继续使用 GCC 还是应该更改为 LLVM 编译器？

如果我选择 GCC 路线，还有什么需要改变的吗？我不是 100% 知道这两个选项对项目的影响？仅仅是像上面这样的变化吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:08:26.357

我认为正确的做法是在整个项目上启用 ARC，然后以[这种](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)方式为所有源代码禁用它。这样，您就不会弄乱任何不应该弄乱的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:06:30.233

编译器类型过去比任何东西都更受青睐，尤其是在 Xcode 3.x 中，但与 Xcode 4.x 一样，尤其是在更高版本中，LLVM 和 LLDB 是任何源代码的推荐编译器/调试器。

与过去的 GCC 相比，CLANG 曾经是一种缓慢移动的粗制滥造节。GCC 是人人都知道如何使用的编译器，它的二进制生成速度快且准确。但是 CLANG 近年来在编译时间和二进制彻底性方面肯定已经赶上了。

# android - 键盘隐藏 ListView 内容

> ID：11277651
> 
> 赞同：3
> 
> 时间：2012-06-30T21:03:42.483
> 
> 标签：android, android-layout, android-widget

当键盘可见时，我看不到 ListView 前几行的内容。

我花了一天的时间尝试各种布局代码以及我自己的来解决这个问题，我现在对这个问题有了更多的了解，以帮助别人帮助我解决它。

问题是如果我将listview（或其容器）的高度指定为fill_parent，那么这会让android认为listview的底部（屏幕底部）是显示在键盘上方的部分，即使没有实际内容尚未显示。由于某种原因，我无法将事件滑到列表内容的开头。指定仅包装内容仅显示一个按预期显示列表的小区域。

这是我最新的布局代码（所有尝试都会产生相同的问题）

```
 <RelativeLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:id="@+id/RelativeLayoutchat"
 >
<LinearLayout
android:orientation="horizontal"
android:gravity ="clip_horizontal"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_centerInParent="true">
</LinearLayout>
<LinearLayout  android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical">
<ListView
    android:id="@+id/MessagesListView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:transcriptMode="alwaysScroll"
    android:divider="#000000"
    android:clickable="false"
    android:layout_weight="9"
    android:cacheColorHint="#00000000"/>
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_weight="1"
    style="@android:style/ButtonBar"
    android:gravity="center"
    android:paddingLeft="3dip"
    android:paddingTop="3dip"
    android:paddingRight="3dip">
    <EditText
        android:id="@+id/msgBox"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:maxLines="5"
        android:enabled="true"
        android:textSize="17sp"
        android:maxLength="150"/>
    <Button
        android:id="@+id/sendbutton"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="send"
        android:layout_weight="4"/>
</LinearLayout>
</LinearLayout>
</RelativeLayout> 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-28T07:16:11.707

I had the same issue and solved this with the below code.

**in your activity:**

```
mylistview.setTranscriptMode(ListView.TRANSCRIPT_MODE_NORMAL);
mylistview.setStackFromBottom(true); 
```

**or in xml file for**

```
android:stackFromBottom="true"
    android:transcriptMode="normal" 
```

and keeping the **`adjustResize`** for activity in manifest file.

```
<activity .... android:windowSoftInputMode="stateHidden|adjustResize" ..../> 
```

Source: [Push Listview when keyboard appears without adjustPan](https://stackoverflow.com/questions/16133706/push-listview-when-keyboard-appears-without-adjustpan?answertab=oldest#tab-top)

# assembly - 对齐一个部分的开头是什么意思？

> ID：11277652
> 
> 赞同：38
> 
> 时间：2012-06-30T21:03:42.967
> 
> 标签：assembly, directive, memory-alignment

对齐部分的开头是什么意思？

例如：

```
 align 4
 a: dw 0 
```

它如何节省内存访问？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-06-30T21:27:10.717

我一直很喜欢 Samael 在以下线程中的全面解释：
[ALIGN MASM 指令的解释，编译器如何解释该指令？](http://www.winasm.net/forum/index.php?showtopic=2075)

引用：

# **1\. 使用方法**

```
ALIGN X 
```

ALIGN 指令带有一个数字 (X)。
这个数字 (X) 必须是 2 的幂。即 2、4、8、16 等等...

该指令允许您在指令之后立即在一个值 X 的倍数的内存地址上强制执行指令或数据的对齐。

前一条指令/数据和 ALIGN 指令之后的额外空间在代码段的情况下用 NULL 指令（或等效指令，如 MOV EAX、EAX）填充，在数据段的情况下用 NULL 填充。

数字 X 不能大于引用 ALIGN 指令的段的默认对齐方式。它必须小于或等于段的默认对齐方式。更多关于这方面的信息......

# **2\. 目的**

**A. 使用代码**

如果指令在代码之前，原因将是优化（参考执行速度）。如果某些指令在 4 字节（32 位）边界上对齐，则它们的执行速度会更快。这种优化通常可以在时间要求严格的函数中使用或引用，例如为不断处理大量数据而设计的循环。但是，除了提高执行速度之外，没有“必要”将指令与代码一起使用。

**B. 处理数据**

数据也是如此——我们主要使用指令来提高执行速度——作为速度优化的一种手段。在某些情况下，数据错位会对我们的应用程序产生巨大的性能影响。

但是对于数据，在某些情况下正确对齐是必要的，而不是奢侈的。这在 Itanium 平台和 SSE/SSE2 指令集上尤其如此，其中 128 位边界 (X=16) 上的未对齐可能会引发一般保护异常。

下面是一篇关于数据对齐的有趣且信息量最大的文章，虽然是针对 MS C/C++ 编译器的，但内容如下：

[IPF、x86 和 x64 上的 Windows 数据对齐，作者：Kang Su Gatlin，MSDN](http://msdn2.microsoft.com/en-us/library/Aa290049%28VS.71%29.aspx)

# **3\. 段的默认对齐方式是什么？**

**A.**如果您使用 .386 处理器指令，并且您没有显式声明段的默认对齐值，则默认段对齐是 DWORD（4 字节）大小。是的，在这种情况下，X = 4。然后您可以将以下值与 ALIGN 指令一起使用：(X=2, X= 4)。请记住，X 必须小于或等于段对齐。

**B.**如果您使用 .486 及更高版本的处理器指令，并且您没有明确声明段的默认对齐值，则默认段对齐为 PARAGRAPH（16 字节）大小。在这种情况下，X = 16。然后可以将以下值与 ALIGN 指令一起使用：(X=2, X= 4, X = 8, X = 16)。

**C.**您可以通过以下方式声明具有非默认对齐方式的段：

```
;Here, we create a code segment named "JUNK", which starts aligned on a 256 bytes boundary 
JUNK SEGMENT PAGE PUBLIC FLAT 'CODE'

;Your code starts aligned on a PAGE boundary (X=256)
; Possible values that can be used with the ALIGN directive 
; within this segment, are all the powers of 2, up to 256\. 

JUNK ENDS 
```

以下是段对齐值的别名...

```
Align Type     Starting Address 

BYTE             Next available byte address.
WORD          Next available word address (2 bytes per word).
DWORD        Next available double word address (4 bytes per double word).
PARA             Next available paragraph address (16 bytes per paragraph).
PAGE             Next available page address (256 bytes per page). 
```

# **4\. 例子**

考虑以下示例（阅读有关使用 ALIGN 指令的注释）。

```
.486 
.MODEL FLAT,STDCALL 
OPTION CASEMAP:NONE 

INCLUDE \MASM32\INCLUDE\WINDOWS.INC 

.DATA

var1 BYTE  01; This variable is of 1 byte size. 
ALIGN 4

; We enforce the next variable to be alingned in the next memory 
;address that is multiple of 4\. 
;This means that the extra space between the first  variable 
;and this one will be padded with nulls. ( 3 bytes in total)

var2 BYTE  02; This variable is of 1 byte size. 

ALIGN 2
; We enforce the next variable to be alingned in the next memory 
;address that is multiple of 2\. 
;This means that the extra space between the second variable 
;and this  one will be padded with nulls. ( 1 byte in total)

var3 BYTE  03; This variable is of 1 byte size. 

.CODE
; Enforce the first instruction to be aligned on a memory address multiple of 4
ALIGN 4

EntryPoint:
; The following 3 instructions have 7 byte - opcodes 
; of the form 0F B6 05 XX XX XX XX
; In the following block, we do not enforce opcode
; alignment in memory...

MOVZX EAX, var1 
MOVZX EAX, var2 
MOVZX EAX, var3 

; The following 3 instructions have 7 byte - opcodes 
; of the form 0F B6 05 XX XX XX XX
; In the following block, we  enforce opcode alignment 
; for the third instruction, on a memory address multiple of 4.
; Since the second instruction opcodes end on a memory address 
; that is not a multiple of 4, some nops would be injected before 
; the first opcode  of the next instruction, so that the first opcode of it
; will start on a menory address that is a multiple of 4.

MOVZX EAX, var1 
MOVZX EAX, var2 
ALIGN 4 
MOVZX EAX, var3 

; The following 3 instructions have 7 byte - opcodes 
; of the form 0F B6 05 XX XX XX XX
; In the following block, we  enforce opcode alignment 
; for all instructions, on a memory address multiple of 4.
;The extra space between each instruction will be padded with NOPs

ALIGN 4
MOVZX EAX, var1
ALIGN 4
MOVZX EAX, var2
ALIGN 4
MOVZX EAX, var3

ALIGN 2
; The following  instruction has 1 byte - opcode (CC).
; In the following block, we  enforce opcode alignment 
; for the instruction, on a memory address multiple of 2\.   
;The extra space between this instruction , 
;and the previous one,  will be padded with NOPs

INT 3
END EntryPoint 
```

如果我们编译程序，编译器生成的内容如下：

```
.DATA
;------------SNIP-SNIP------------------------------
.data:00402000 var1            db 1
.data:00402001                 db    0; This NULL was generated to enforce the alignment of the next instruction on an address that is a multiple of 4
.data:00402002                 db    0; This NULL was generated to enforce the alignment of the next instruction on an address that is a multiple of 4
.data:00402003                 db    0; This NULL was generated to enforce the alignment of the next instruction on an address that is a multiple of 4

.data:00402004 var2            db 2 
.data:00402005                 db    0; This NULL was generated to enforce the alignment of the next instruction oon an address that is a multiple of 2

.data:00402006 var3            db 3

.data:00402007                 db    0; The rest of the NULLs are to fill the memory page in which the segment will be loaded
;------------SNIP-SNIP------------------------------

.CODE
;------------SNIP-SNIP------------------------------

.text:00401000 start:
.text:00401000                 movzx   eax, var1
.text:00401007                 movzx   eax, var2
.text:0040100E                 movzx   eax, var3
.text:00401015                 movzx   eax, var1
.text:0040101C                 movzx   eax, var2
.text:00401023                 nop; This NOP was generated to enforce the alignment...
.text:00401024                 movzx   eax, var3
.text:0040102B                 nop; This NOP was generated to enforce the alignment...
.text:0040102C                 movzx   eax, var1
.text:00401033                 nop; This NOP was generated to enforce the alignment...
.text:00401034                 movzx   eax, var2
.text:0040103B                 nop; This NOP was generated to enforce the alignment...
.text:0040103C                 movzx   eax, var3
.text:00401043                 nop; This NOP was generated to enforce the alignment...
.text:00401044                 int     3              ; Trap to Debugger
.text:00401044; ---------------------------------------------------------------------------
.text:00401045                 db    0
.text:00401046                 db    0
.text:00401047                 db    0
.text:00401048                 db    0

;------------SNIP-SNIP------------------------------ 
```

如您所见，在我们应用程序的代码/数据结束后，编译器会生成更多的指令/数据。这是因为 PE 部分在加载到内存中时按 PAGE 大小（512 字节）对齐。

因此，编译器用垃圾字节（通常是 INT 3 指令，代码段的 NOP 或 NULL，以及数据段的 0FFh，NULL）填充下一个 512 字节边界的额外空间，以确保加载的内存对齐PE图像是正确的...

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-01T05:45:03.517

内存是固定宽度的，现在要么是 32 位，要么通常是 64 位宽（即使它是 32 位系统）。现在让我们假设一个 32 位数据总线。每次读取时，无论是 8 位、16 位还是 32 位，它都是 32 位总线，因此这些数据线上会有一些东西，只放置与对齐地址相关的 32 位是有意义的。

所以如果在地址 0x100 你有 32 位值 0x12345678。并且您要很好地执行 32 位读取，所有这些位都将在总线上。如果您要在地址 0x101 执行 8 位读取，内存控制器将读取地址 0x100，它将获得 0x12345678。从这 32 位中，它将隔离正确的“字节通道”，即与地址 0x101 相关的 8 位。一些处理器的内存控制器可能只看到 32 位读取，处理器将处理隔离字节通道。

像 x86 这样允许非对齐访问的处理器呢？如果地址 0x100 有 0x12345678，地址 0x104 有 0xAABBCCDD。并且要在这个基于 32 位数据总线的系统上的地址 0x102 上进行 32 位读取，则需要两个内存周期，一个在地址 0x100，其中 16 位所需值存在，另一个在 0x104，其他两个字节在成立。在这两次读取发生之后，您可以将 32 位拼凑在一起，并将其提供到请求它的处理器中。如果您想在地址 0x103 进行 16 位读取，也会发生同样的事情，这会花费您两倍的内存周期，花费两倍的时间。

该`.align`指令通常在汇编语言中所做的（当然，您必须指定确切的汇编程序和处理器，因为这是一个指令，并且每个汇编程序都可以定义它想要为指令定义的任何内容）是填充输出，以便紧跟在`.align`是，好吧，在那个边界上对齐。如果我有这个代码：

```
b: .db 0
c: .dw 0 
```

事实证明，当我组装和链接 C 的地址是 0x102 时，但我知道我会经常以 32 位值的形式访问它，然后我可以通过执行以下操作来对齐它：

```
b: .db 0
.align 4
c: .dw 0 
```

假设在此之前没有任何其他变化，那么 b 仍将位于地址 0x101，但汇编器将在 b 和 c 之间的二进制文件中再放置两个字节，以便 c 更改为地址 0x104，对齐在 4 字节边界上。

“在 4 字节边界上对齐”仅表示地址模 4 为零。基本上是 0x0、0x4、0x8、0xc、0x10、0x14、0x18、0x1C 等等。（地址的低两位为零）。对齐 8 表示地址的 0x0、0x8、0x10、0x18 或低 3 位为零。等等。

写入比读取更糟糕，因为您必须对小于总线的数据进行读取-修改-写入。如果我们想更改地址 0x101 处的字节，我们将读取地址 0x100 处的 32 位值，更改一个字节，然后将该 32 位值写回 0x100。因此，当您编写程序并认为使用较小的值可以使事情变得更快时，事实并非如此。因此，未对齐的写入和内存的宽度会花费您读取-修改-写入。未对齐的写入成本是读取成本的两倍。未对齐的写入将是两次读取-修改-写入。不过，写入确实具有优于读取的性能特征。当程序需要从内存中读取某些内容并立即使用该值时，下一条指令必须等待内存周期完成（现在可能是数百个时钟周期，DRAM 已经卡在 133MHz 大约十年了，你的 1333MHz DDR3 内存不是 1333MHz，总线是 1333MHz/2，你可以以那个速度提出请求，但很长一段时间没有回复）。基本上通过读取你有一个地址，但你必须等待数据，只要它需要。对于写入，您有两个项目，地址和数据，您可以“触发并忘记”您为内存控制器提供地址和数据，您的程序可以继续运行。如果下一条指令或一组指令需要访问内存、读取或写入，那么每个人都必须等待第一次写入完成，然后继续进行下一次访问。总线是 1333MHz/2，你可以以这个速度发出请求，但很长一段时间没有回复）。基本上通过读取你有一个地址，但你必须等待数据，只要它需要。对于写入，您有两个项目，地址和数据，您可以“触发并忘记”您为内存控制器提供地址和数据，您的程序可以继续运行。如果下一条指令或一组指令需要访问内存、读取或写入，那么每个人都必须等待第一次写入完成，然后继续进行下一次访问。总线是 1333MHz/2，你可以以这个速度发出请求，但很长一段时间没有回复）。基本上通过读取你有一个地址，但你必须等待数据，只要它需要。对于写入，您有两个项目，地址和数据，您可以“触发并忘记”您为内存控制器提供地址和数据，您的程序可以继续运行。如果下一条指令或一组指令需要访问内存、读取或写入，那么每个人都必须等待第一次写入完成，然后继续进行下一次访问。你给内存控制器地址和数据，你的程序可以继续运行。如果下一条指令或一组指令需要访问内存、读取或写入，那么每个人都必须等待第一次写入完成，然后继续进行下一次访问。你给内存控制器地址和数据，你的程序可以继续运行。如果下一条指令或一组指令需要访问内存、读取或写入，那么每个人都必须等待第一次写入完成，然后继续进行下一次访问。

以上所有内容都非常简单，但是您会在处理器和缓存之间看到，在缓存的另一侧，固定宽度的内存（缓存中 sram 的固定宽度和 dram 上的固定宽度）远侧不必匹配）缓存的另一侧在“缓存行”中访问，这些行通常是总线宽度大小的倍数。这对对齐既有帮助也有伤害。比如说 0x100 是一个高速缓存行边界。假设 0xFE 处的单词是一个缓存行的尾端，而 0x100 是下一个缓存行的开头。如果您要在地址 0xFE 执行 32 位读取，则不仅必须发生两个 32 位内存周期，而且还需要两次高速缓存行取指。最坏的情况是必须将两条缓存线移到内存中，以便为您正在获取的两条新缓存线腾出空间。

您的问题没有指定处理器，但您的问题的性质暗示了 x86，这是众所周知的这个问题。其他处理器系列不允许未对齐访问，或者您必须专门禁用异常故障。有时未对齐的访问与 x86 不同。例如，在至少一个处理器上，如果您在地址 0x100 处有 0x12345678，在地址 0x104 处有 0xAABBCCDD，并且您禁用了故障并在地址 0x102 处执行了 32 位读取，您将得到 0x56781234。单个 32 位读取，字节通道旋转以将低字节放在正确的位置。不，我说的不是 x86 系统，而是其他一些处理器。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-30T21:25:49.423

`align`用 NOPs/0x90 (NASM) 填充地址，直到它与操作数对齐（addr 模操作数为零）。

例如：

```
db 12h
align 4
db 32h 
```

组装输出时：

```
0000  12 90 90 90 
0004  32 
```

这对于内存访问来说更快，并且需要在 x86 CPU（可能还有其他架构）中加载一些表。我无法说出任何具体案例，但您可以在 SO 和搜索引擎上找到[几个](https://stackoverflow.com/a/9336896/1078067) [答案。](https://stackoverflow.com/questions/1054657/memory-alignment-on-a-32-bit-intel-processor)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-22T13:41:47.393

ALIGN 和 ALIGNB 宏提供了一种在单词、长字、段落或其他边界上对齐代码或数据的便捷方法（如 nasm 文档中所述，[https:](https://nasm.us/doc/nasmdoc5.html) //nasm.us/doc/nasmdoc5.html ）

# javascript - PhantomJS 5 分钟 Wiki phantom.exit() 怪事

> ID：11277653
> 
> 赞同：3
> 
> 时间：2012-06-30T21:03:52.617
> 
> 标签：javascript, phantomjs

因此，wiki 中的示例`phantom.exit()`在这里有两个地方。为什么我不能放在`phantom.exit()`脚本的末尾？这对我来说没有太大意义。

```
var page = require('webpage').create(),
t, address;

if (phantom.args.length === 0) {
    console.log('Usage: loadspeed.js <some URL>');
    phantom.exit(); //Why does this only work if "phantom.exit()" is here,
} else {
    t = Date.now();
    address = phantom.args[0];
    page.open(address, function (status) {
        if (status !== 'success') {
            console.log('FAIL to load the address');
        } else {
            t = Date.now() - t;
            console.log('Loading time ' + t + ' msec');
        }
        phantom.exit(); //and here.
    });
}
// but not just a single one here? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:07:54.783

该`page.open`方法是异步的，因此您传递给它的回调函数将在未来的某个时间点运行（当 引用的资源`address`完成加载时）。

如果您在该脚本的末尾调用 to `phantom.exit()`，PhantomJS 将在回调有机会执行之前退出。

# scala - Scala：通过 if 语句更正表示类型的类型推断

> ID：11277656
> 
> 赞同：2
> 
> 时间：2012-06-30T21:04:02.693
> 
> 标签：scala

[这是关于表示类型的两个](https://stackoverflow.com/questions/11274964/) [问题](https://stackoverflow.com/questions/11236122/)的后续，它们是一个 trait 的类型参数，旨在表示有界类型成员（或类似成员）的基础类型。我已经成功地创建了类的实例，例如`ConcreteGarage`，具有`cars`有界类型成员的实例`CarType`。

```
trait Garage {
  type CarType <: Car[CarType]
  def cars: Seq[CarType]

  def copy(cars: Seq[CarType]): Garage

  def refuel(car: CarType, fuel: CarType#FuelType): Garage = copy(
    cars.map {
      case `car` => car.refuel(fuel)
      case other => other
    })
}

class ConcreteGarage[C <: Car[C]](val cars: Seq[C]) extends Garage {
  type CarType = C
  def copy(cars: Seq[C]) = new ConcreteGarage(cars)
}

trait Car[C <: Car[C]] {
  type FuelType <: Fuel
  def fuel: FuelType

  def copy(fuel: C#FuelType): C

  def refuel(fuel: C#FuelType): C = copy(fuel)
}

class Ferrari(val fuel: Benzin) extends Car[Ferrari] {
  type FuelType = Benzin
  def copy(fuel: Benzin) = new Ferrari(fuel)
}

class Mustang(val fuel: Benzin) extends Car[Mustang] {
  type FuelType = Benzin
  def copy(fuel: Benzin) = new Mustang(fuel)
}

trait Fuel
case class Benzin() extends Fuel 
```

我可以轻松地创建 s 的实例，`Car`例如`Ferrari`s 和`Mustang`s 并将它们放入 a`ConcreteGarage`中，只要它很简单：

```
val newFerrari = new Ferrari(Benzin())
val newMustang = new Mustang(Benzin())

val ferrariGarage = new ConcreteGarage(Seq(newFerrari))
val mustangGarage = new ConcreteGarage(Seq(newMustang)) 
```

但是，如果我只是根据标志返回一个或另一个，并尝试将结果放入车库，它会失败：

```
val likesFord = true
val new_car = if (likesFord) newFerrari else newMustang

val switchedGarage = new ConcreteGarage(Seq(new_car)) // Fails here 
```

单独的开关工作正常，它是对`ConcreteGarage`构造函数的调用失败并出现相当神秘的错误：

```
error: inferred type arguments [this.Car[_ >: this.Ferrari with this.Mustang <: this.Car[_ >: this.Ferrari with this.Mustang <: ScalaObject]{def fuel: this.Benzin; type FuelType<: this.Benzin}]{def fuel: this.Benzin; type FuelType<: this.Benzin}] do not conform to class ConcreteGarage's type parameter bounds [C <: this.Car[C]]
val switchedGarage = new ConcreteGarage(Seq(new_car)) // Fails here
                     ^ 
```

我曾尝试将那些神奇的`[C <: Car[C]]`表示类型参数放在任何地方，但没有成功找到神奇的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:25:21.650

没有任何有用的超类型可以为其`Ferrari`加上`Mustang`别名。你需要用这种方法把世界从里到外包裹起来。

一种可能性是将`Garage`构造作为方法添加到`Car`.

另一种可能性是定义一些负责生产兼容汽车和车库的“世界”：

```
trait World {
   type CarType <: Car[CarType]
   def newCar() : CarType
   def newGarage(cars: Seq[CarType]) = new ConcreteGarage[CarType](cars)
}

class FerrariWorld extends World {
   type CarType = Ferrari
   def newCar() = new Ferrari(Benzin())
}

class FordWorld extends World {
   type CarType = Mustang
   def newCar() = new Mustang(Benzin())
}

def play(world: World) {
   val car = world.newCar()
   println(car)
   val gar = world.newGarage(Seq(car))
   println(gar)
}

def test(likesFord: Boolean) {
   val w = if(likesFord) new FordWorld else new FerrariWorld
   play(w)
}

test(true)
test(false) 
```

* * *

你可以看到这会变得非常幽闭恐惧症。所以这真的取决于你的目标场景。路径相关类型总是会导致未来的约束。考虑这个带有类型参数的相当简单的变体：

```
trait Fuel { def liters: Int }
trait Make { def color: String }

case class Benzin(liters: Int = 0) extends Fuel
case class Diesel(liters: Int = 0) extends Fuel
case class Ferrari(color: String) extends Make
case class Mustang(color: String) extends Make { def race() { println( "Rrrroar" )}}

case class Car[M <: Make, F <: Fuel](make: M, fuel: F) {
   def refuel(f: F): Car[M, F] = copy(make, f)
}

case class Garage[M <: Make](cars: Seq[Car[M,_]] = Seq.empty) {
   def add(c: Car[M,_]) = copy(cars :+ c)
   def remove(c: Car[M,_]) = copy(cars.filterNot(_ == c))
   def refuel[F <: Fuel](c: Car[M,F], f: F) = copy( cars.map {
      case `c` => c.refuel(f)
      case other => other
   })
}    

val g0 = Garage[Mustang]()
val m  = Car(Mustang("black"), Benzin())
val f  = Car(Ferrari("red"), Benzin())
val g1 = g0.add(f)                // forbidden
val g1 = g0.add(m)                // ok
val g2 = g1.refuel(f, Benzin(45)) // forbidden
val g2 = g1.refuel(m, Diesel(45)) // forbidden
val g2 = g1.refuel(m, Benzin(45)) // ok
g2.cars.foreach(_.make.race())    // ok 
```

* * *

结论：不要走弯路...

![在此处输入图像描述](../Images/a3bb535bbdc5b7625a48859c8f75c0a5.png)

# android - 在android中创建书架网格视图

> ID：11277661
> 
> 赞同：4
> 
> 时间：2012-06-30T21:04:36.260
> 
> 标签：android, view, android-canvas, android-gridview

我发现了这个有用的[演示文稿](http://www.sqisland.com/talks/fluid-android-layouts/#32) ，这段代码来自它：

```
public class BookshelfGridView extends GridView {
  // Constructors etc

  protected void dispatchDraw(Canvas canvas) {
    for (int y = top; y < height; y += mWoodPanelHeight) {
      for (int x = mLeftWidth; x < width; x += mWoodPanelWidth) {
        canvas.drawBitmap(mWoodPanelImage, x, y, null);
      }
    }

    for (int y = top; y < height; y += mShelfHeight) {
      // Draw left edge
      // Draw shelf
      // Draw right edge
    }

    super.dispatchDraw(canvas);
  }
} 
```

但是有些事情不清楚，例如：

*   如何绘制边缘。如果可能的话，我需要一些解释，如果你建议一些要研究的主题来理解它，那很好。
*   什么是变量，高度和宽度（它们用于 GridView 吗？）

并提前感谢

# javascript - 从 JS 调用 IE Js 调试器

> ID：11277670
> 
> 赞同：1
> 
> 时间：2012-06-30T21:05:56.443
> 
> 标签：javascript, debugging, dynamics-crm, dynamics-crm-2011

我正在开发这个 MSCRM2011 工具：

[https://mscrmjscodeevaluator.codeplex.com/](https://mscrmjscodeevaluator.codeplex.com/)

基本上，它在当前 CRM 窗口上运行 JS 代码。这样做的好处是您可以在当前上下文中运行代码。

现在，我认为有一种方法可以轻松调试此代码会很好，所以，我的问题是：

1.  有一种简单的方法可以从 js 中调用 IE 开发者工具（F12），然后对它说“调试这段代码”？？

2.  如果不是 1)，有没有办法（容易与否）在任何第三方“可集成”调试器中调试 javascript，或者类似的东西可以让我对调试过程进行一些控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:21:14.423

使用开发人员工具，您只需在代码前添加`frames[0].`

[http://blog.customereffective.com/blog/2012/02/xrm-2011-javascript-another-101-lesson.html](http://blog.customereffective.com/blog/2012/02/xrm-2011-javascript-another-101-lesson.html)

[http://blog.customereffective.com/blog/2011/02/internet-explorer-developer-tools.html](http://blog.customereffective.com/blog/2011/02/internet-explorer-developer-tools.html)

此外，您可以非常轻松地浏览 DOM，修改 CSS 属性等。

我喜欢你添加的工具，并认为这是一个很好的补充。语法突出显示是您拥有的一项很棒的功能，而开发人员工具中缺少它。

# php - PDO - 真实的事实和最佳实践？

> ID：11277675
> 
> 赞同：12
> 
> 时间：2012-06-30T21:06:47.207
> 
> 标签：php, mysql, database, pdo, database-connection

从现在开始，我一直在使用旧的`mysql`而不是，`PDO`并且我已经看到了许多建议为什么要切换到`PDO`，但是也有许多不同的事实（也在 SO 上），例如：

*   陈述`PDO`稍快/稍慢
*   说`PDO`有助于防止 SQL 注入，但前提是您使用准备好的查询
*   并且还说使用准备好的查询很糟糕，因为它非常慢

那么，什么是真实的呢？特别是，使用时的最佳实践是什么，`PDO`速度和安全性都很重要——如何在保持快速查询的同时最好地保护自己免受 SQL 注入？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-30T21:23:21.437

## 数据库支持

PDO 相对于 MySQL 的核心优势在于其对数据库驱动程序的支持。PDO 支持许多不同的驱动程序，如 CUBRID、MS SQL Server、Firebird/Interbase、IBM、MySQL 等。

## 安全

这两个库都提供 SQL 注入安全性，只要开发人员按照预期的方式使用它们。建议将准备好的语句与绑定查询一起使用。

```
// PDO, prepared statement
$pdo->prepare('SELECT * FROM users WHERE username = :username');
$pdo->execute(array(':username' => $_GET['username']));

// mysqli, prepared statements
$query = $mysqli->prepare('SELECT * FROM users WHERE username = ?');
$query->bind_param('s', $_GET['username']);
$query->execute(); 
```

## 速度

虽然 PDO 和 MySQL 都非常快，但 MySQL 在基准测试中的执行速度却微不足道——非准备语句约为 2.5%，准备语句约为 6.5%。

## 命名参数

就像@DaveRandom 指出的那样，这是 PDO 的另一个特性，它比可怕的数字绑定要容易得多。

```
$params = array(':username' => 'test', ':email' => $mail, ':last_login' => time() - 3600);

$pdo->prepare('
SELECT * FROM users
WHERE username = :username
AND email = :email
AND last_login > :last_login');

$pdo->execute($params); 
```

![PDO 与 MySQL](../Images/bd06a7974fbf9a74ec05d83d0506b055.png)

很少有链接可供进一步参考
[MySQL vs PDO (Stackoverflow)](https://stackoverflow.com/questions/866860/mysql-vs-pdo)
[为什么应该使用 PDO 进行数据库访问 (net.tutsplus.com)](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:19:51.990

在大多数情况下，开发速度（编写软件需要多长时间）比性能的微小改进更重要。

我建议使用 PDO，并将其与准备好的查询一起使用。除非您是 Twitter 或 Google，否则您几乎不可能意识到任何性能差异。

# android - SVG旋转的奇怪矩阵变换

> ID：11277676
> 
> 赞同：0
> 
> 时间：2012-06-30T21:06:58.223
> 
> 标签：android, svg, transform

我有一个用于 SVG 绘图的 java 代码。它处理包括 在内的转换`rotate`，并且做得很好，据我在许多测试图片中看到的，与它们在 Chrome 中的渲染相比。接下来我需要的是获取实际的对象位置，这在许多通过变换声明的图像中。所以我决定只从用于绘图的 Matrix 中读取 X 和 Y。不幸的是，我得到了不正确的`rotate`变换值，即它们与图像中的真实对象位置不对应。

精简后的代码如下所示：

```
Matrix matrix = new Matrix();
float cx = 1000;    // suppose this is an object X coordinate
float cy = 300;     // this is its Y coordinate
float angle = -90;  // rotate counterclockwise, got from "rotate(-90, 1000, 300)"

// shift to -X,-Y, so object is in the center
matrix.postTranslate(-cx, -cy);
// rotate actually
matrix.postRotate(angle);
// shift back
matrix.postTranslate(cx, cy);
// debug goes here
float[] values = new float[9];
matrix.getValues(values);
Log.v("HELLO", values[Matrix.MTRANS_X] + " " + values[Matrix.MTRANS_Y]); 
```

日志分别输出值 700 和 1300。我期望 0 和 0，因为我看到对象在我的图像中就地旋转（即没有任何移动），并且 postTranslate 调用应该相互补偿。当然，我看到这些值是如何从 1000 和 300 形成的，但不明白为什么。我再次指出，具有这些奇怪值的矩阵用于实际对象绘制，它看起来是正确的。有人可以解释这里发生了什么吗？我错过了什么吗？到目前为止，我的问题只有一个解决方案：只是不要尝试从 获取位置`rotate`，仅用于显式`matrix`和`translate`转换。但是这种方法缺乏通用性，无论如何我认为矩阵对于任何转换类型都应该具有合理的值（包括偏移量）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T12:54:26.930

答案是矩阵是空间变换的算子，不应该直接用于物体位置的提取。相反，应该获取初始对象坐标，如SVG 标记`x`和`y`属性中指定的那样，并将矩阵应用于它们：

```
float[] src = new float[2];
src[0] = cx;
src[1] = cy;
matrix.mapPoints(src); 
```

在此之后，我们在 x 和 y 变量中获得正确的位置值。

# javascript - 如何根据浏览器在 `window.URL.createObjectURL()` 和 `window.webkitURL.createObjectURL()` 之间进行选择

> ID：11277677
> 
> 赞同：15
> 
> 时间：2012-06-30T21:07:21.000
> 
> 标签：javascript, html, dom

从 Firefox 开发者网站，我知道 Firefox 使用

```
objectURL = window.URL.createObjectURL(file); 
```

获取文件类型的 url，但在 chrome 和其他 webkit 浏览器中，我们有`window.webkitURL.createObjectURL()`用于检测 url。

我不知道如何根据浏览器引擎交换此功能，我需要它在两种浏览器（Chrome 和 firefox）上都可以使用

[https://developer.mozilla.org/en/DOM/window.URL.createObjectURL](https://developer.mozilla.org/en/DOM/window.URL.createObjectURL)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-30T21:16:43.707

您可以定义一个包装函数：

```
function createObjectURL ( file ) {
    if ( window.webkitURL ) {
        return window.webkitURL.createObjectURL( file );
    } else if ( window.URL && window.URL.createObjectURL ) {
        return window.URL.createObjectURL( file );
    } else {
        return null;
    }
} 
```

接着：

```
// works cross-browser
var url = createObjectURL( file ); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-30T21:15:11.280

简单的一个班轮：

```
var createObjectURL = (window.URL || window.webkitURL || {}).createObjectURL || function(){}; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-30T21:10:54.097

```
if (window.URL !== undefined) {
    window.URL.createObjectURL();
} else if (window.webkitURL !== undefined) {
    window.webkitURL.createObjectURL();
} else {
    console.log('Method Unavailable: createObjectURL');
} 
```

是关于你正在寻找的东西。此外，[此](https://developer.mozilla.org/en/Using_files_from_web_applications#Example%3a_Using_object_URLs_to_display_images)示例使用更简单的...

```
window.URL = window.URL || window.webkitURL; 
```

# ruby - Rails 模型验证：两个用户不能相同

> ID：11277681
> 
> 赞同：1
> 
> 时间：2012-06-30T21:08:17.233
> 
> 标签：ruby, ruby-on-rails-3, activerecord

我有一个这样的模型：

```
class Rating
  # user_id, author_id
end 
```

我想要做的是验证 author_id/user_id 所以他们不能是相同的，本质上，所以用户不能评价自己。

我可以说这应该使用 Rating 类中的验证来完成吗？

```
validates :author_id, # custom validation options 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:17:20.990

您需要自定义验证：

```
class Rating
  # user_id, author_id
  validate :ensure_author_is_not_user

private

  def ensure_author_is_not_user
    errors[:author_id] << "can not be the same as user" unless user_id != author_id 
  end

end 
```

# python - FCGI 是否有用于部署 Satchmo 的 HOWTO？

> ID：11277685
> 
> 赞同：0
> 
> 时间：2012-06-30T21:08:25.333
> 
> 标签：python, django, deployment, fastcgi, satchmo

[https://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/](https://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/)详细介绍了 FCGI 的一些设置，但是虽然它有 Apache 配置文件的材料，但它省略了 FCGI。

如何为在绑定到 127.0.0.1 的同一服务器上运行并侦听端口 1234 的守护进程 fastcgi 进程创建 site.fcgi 文件？

- 编辑 -

我的 httpd.conf 中有以下内容：

```
FastCGIExternalServer /home/jonathan/store/deploy/store.fcgi -host 127.0.0.1:1234

<VirtualHost *:80>
    ServerName steampunk.stornge.com
    DocumentRoot /home/jonathan/store/
    Alias /media /home/jonathan/store/media
    RewriteEngine On
    RewriteRule ^/(media.*)$ /$1 [QSA,L,PT]
    RewriteCond %(REQUEST_FILENAME} !-f
    RewriteRule ^/(.*)$ /store.fcgi/$1 [QSA,L]
</VirtualHost> 
```

在 /home/jonathan/store/deploy/store.fcgi 我有：

```
import os
import sys

from os.path import abspath, dirname, join
from site import addsitedir

sys.path.insert(0, abspath(join(dirname(__file__), "../")))

from django.conf import settings
os.environ["DJANGO_SETTINGS_MODULE"] = "store.settings"

from django.core.servers.fastcgi import runfastcgi
runfastcgi(method="threaded", daemonize="true") 
```

我也有，跑步，

```
python manage.py runfcgi method=threaded host=127.0.0.1 port=1234 
```

当我打开 http://[hostname] 时，我得到：

```
Not Found

The requested URL / was not found on this server.

Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.

Apache/2.2.22 (Ubuntu) Server at [hostname] Port 80 
```

http://[hostname]/media 拉出一个填充的索引。

在这种 FCGI 的使用中，有什么可以改进的，或者可能会造成什么问题？store.cgi 基于几个 .fcgi 文件，我在 Django 或 FCGI 文档中找不到 Satchmo 的模型 FCGI 文件后使用了这些文件。我不相信它。我只是没有用谷歌搜索更好的东西。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T10:38:03.870

我已经成功地使用另一个选项 FCGI 部署它：

在启用站点中：

```
FastCGIExternalServer /home/jonathan/testfcgi/testfcgi.fcgi -host 127.0.0.1:3033

<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    ServerName testfcgi.jonathanscorner.com
    DocumentRoot /home/jonathan/testfcgi
    Alias /media /home/testfcgi/media
    RewriteEngine On
    RewriteRule ^/(media.*)$ /$1 [QSA,L,PT]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^/(.*)$ /testfcgi.fcgi/$1 [QSA,L]

    <Directory /home/jonathan/testfcgi/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

ErrorLog ${APACHE_LOG_DIR}/error.log
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
LogLevel warn

CustomLog ${APACHE_LOG_DIR}/access.log combined

</VirtualHost> 
```

这与 fcgi 的命令行调用相结合。

# c# - 本地化动态的、用户生成的内容。对这两种选择有何看法？

> ID：11277689
> 
> 赞同：0
> 
> 时间：2012-06-30T21:10:08.257
> 
> 标签：c#, asp.net-mvc-3, localization, user-generated-content

我正在建立一个允许人们创建内容并对内容发表评论的网站。

对于表单标签、按钮和其他静态内容，我可以使用`.resx`文件。我以前做过，而且效果很好。

现在我正处于一个十字路口，我不知道该走哪条路。两者对我来说听起来都一样好，但由于这将是我第一次涉足这一领域，我宁愿询问我可能没有考虑到的任何陷阱。

这是我想到实施的两个选项。两者都可以解决我将用户生成的内容本地化和呈现给我的用户的问题。

**选项 A：**

* * *

我会创建整个 MVC3 应用程序的多个副本，并将每个本地化放入它自己的 IIS 应用程序中。

```
foobar.com
es.foobar.com
ru.foobar.com 
```

我只需要更改一个 web.config 文件，为每个本地化使用不同的数据库。

我看到了一些问题，例如：

*   如果用户登录`foobar.com`并访问他的本地化版本的站点，他将不会登录，因为它们是两个完全独立的应用程序。

*   没有统一的审核工具。我必须进入每个应用程序，登录，访问管理面板并从那里进行审核。

*   难以将更改/更新推送到页面的所有版本。我必须手动进入每个 IIS 应用程序文件夹并复制每个本地化版本的已发布文件。

**选项 B：**

* * *

我将创建一个 MVC3 应用程序，并在后端数据库上为每个本地化创建多个字段。

例如：

```
Car
------
CarID
Name
esName
ruName
Make
esMake
ruMake
..and so on.. 
```

然后，我会根据选择的本地化以某种方式动态选择要显示的字段。虽然我什至不确定这是可能的，因为访问子域会将我带到一个完全不同的 IIS 应用程序，除非我可以绑定一个子域以指向我的 IIS 上的实际域。

```
foobar.com
es.foobar.com
ru.foobar.com 
```

我看到这种方法的问题是每个表的大小都会非常庞大​​，不仅在字段数上，而且在记录数上。我不确定这是否会成为问题。

* * *

对于如何在 MVC3 应用程序中为用户生成的内容实现本地化，我将不胜感激。

意思是，访问西班牙语版本 ( `es.foobar.com`) 的用户会看到其他西班牙语内容和用户发表的评论，而*不是*其他版本。我**并不是**指翻译他们的内容并将其呈现给最终用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:37:18.800

另一种选择是使用单个 MVC 应用程序，以正常方式本地化，并使用语言切换（您可以通过 URL 路由触发，例如 es.foobar.com 将语言设置为“es”，或通过`accept-languages`标头，或通过 UI 选择器）。

您可以将语言 ID 列添加到包含用户生成内容的表中，而不是每种语言都有一列。并对用户生成的内容实施过滤器，以便仅显示与活动语言匹配的行。

例如：

```
Car
----------
CarID
LanguageID
Name
Make 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:59:56.070

我认为你可以这样做：

*   只制作一个 MVC3 站点（一个 IIS 站点）
*   将 .rsx 用于静态内容，像往常一样更改语言
*   本地化数据库：每种语言一个。
*   如果您需要一个用于其他非本地化内容的数据库，那应该是一个单独的数据库（不是每种语言一个）
*   一旦用户进入一个本地化站点，您就可以使用相应的连接字符串

**缺点：**

*   您将需要在所有数据库中触发数据库更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:21:30.620

一种方法是在数据表中存储指向字段的指针。例如，您的 Car 表可能包含

```
CarId | Name | Make
123   | 0099 | 0100 
```

然后有一个包含本地化字符串的表。

```
TextId | Lang | String
0099   | en   | "Escape"
0099   | ru   | "Russian Name"
0100   | en   | "Ford"
0100   | ru   | "Russian Ford" 
```

在本地化字符串表上，在 TextId 和 Lang 上创建复合主键。这样您的域/数据表就保持简单，并且在选择数据时，您只需加入本地化的字符串表即可。说得通？如果你需要的话，我可以写一个快速的 SQL 查询给你这个想法。

这种方法确实需要对数据库进行额外的工作，但效果还不错。我在一个中等负载的网站上使用了这种方法。如果它确实变成了问题，您可以为不同的语言创建物化视图。我也这样做了，只要您的大多数查询都是读取的，它就非常快。

埃里克

# java - 一个单词在 TXT 文件中出现多少次

> ID：11277692
> 
> 赞同：1
> 
> 时间：2012-06-30T21:10:24.787
> 
> 标签：java, string

当我尝试计算某个单词在 TXT 文件中出现的次数时遇到问题。

1.  我创建了一个文本字段（**txta**）
2.  我创建了一个按钮来应用操作（**btn**）
3.  我创建了一个显示文件内容的textarea ( **area )**

当我选择文件时，文件的内容显示在**area**中。然后我输入**txta**中的单词进行搜索。然后我单击**btn**，但代码不起作用。

```
public int contarPalabras(String chain, String word) {
    // English translation: 
    // Receive a string and a word and return the amount of times 
    // that the word was found in the string.
    // If the letter is not found, return (-1).

    int cant = 0; 

    int intIndex = chain.indexOf(word);

    if (intIndex == -1) {
        cant = -1;
    } else {
        cant = intIndex;
    }

    return cant;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:13:30.017

commons-lang[`StringUtils.countMatches(str, sub)`](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#countMatches%28java.lang.String,%20java.lang.String%29)完全符合您的要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T21:31:44.963

阅读[`String.indexOf(string)`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#indexOf%28java.lang.String%29). 它不会做你认为它会做的事情。它只返回参数**第一次出现的索引。**

为了让它工作，你可以做这样的事情：

```
public int countWord(String chain, String word){
    if("".equal(word)){
        throw new IllegalArgumentException("word is empty string"); // error when word is empty string
    }
    index = 0;
    count = 0;
    while (index != -1){
        int found = chain.indexOf(word, index);
        if(found != -1){
            count++;
            index = found + word.length();
        }
    }
    return count;
} 
```

**编辑**

如果您真的只想计算完整的单词（即两边用空格分隔的子字符串），这个版本会更有用：

```
public int countWord(String chain, String word){
    if("".equal(word)){
        throw new IllegalArgumentException("word is empty string"); // error when word is empty string
    }
    index = 0;
    count = 0;
    word = " " + word + " ";
    while (index != -1){
        int found = chain.indexOf(word, index);
        if(found != -1){
            count++;
            index = found + word.length() - 1;
        }
    }
    return count;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:51:05.060

我认为给出的 2 个答案会有以下问题：在文本中：“Saturdays and Sundays are my favorite days”如果你搜索“days”，它将返回：3 因为它将匹配 Satur **days**、 Sun **days**和**days**。我假设您只想匹配**几天**

在这种情况下，您必须使用正则表达式，这是答案：

```
public int countWord(String chain, String word){
  Pattern p = Pattern.compile("\\b" + word + "\\b");
  Matcher m = p.matcher(chain);

  int count = 0;
  while(m.find()) {
    count++;             
  }

  return count;
} 
```

# hashtable - 填充哈希表的时间复杂度？

> ID：11277694
> 
> 赞同：2
> 
> 时间：2012-06-30T21:10:48.293
> 
> 标签：hashtable, time-complexity, quadratic-probing

这是一个家庭作业问题，但我认为它缺少一些东西。它问：

> 提供一个由*m*个键组成的序列来填充一个使用线性探测实现的哈希表，从而使填充它的时间最短。

进而

> 提供另一个*m*键序列，但要使填充它的时间最大。如果哈希表实现二次探测，重复这两个问题

我只能假设哈希表的大小为*m*，既因为它是唯一给出的数字，又因为我们在描述负载因子之前一直使用该字母来解决哈希表大小。但是如果不知道将序列散列到表中的散列函数，我想不出任何序列来做第一个。

如果它是一个糟糕的哈希函数，例如，它将每个条目哈希到同一个索引，那么填充它的最小和最大时间都将花费 O(n) 时间，而不管序列是什么样的。在平均情况下，我假设散列函数没问题，我怎么知道该散列函数填充表需要多长时间？

这些问题与散列函数的关联是否比与散列序列的关联更强？

至于第二个问题，我可以假设，不管散列函数如何，一个大小为*m*且具有相同键重复*m*次的序列将提供最大时间，因为它将导致从第二个条目开始的线性探测。我认为这需要 O(n) 时间。那是对的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T17:14:53.870

这个问题听起来并不十分关心散列函数，但如果有的话就好了。不过，你似乎几乎明白了。在我看来，这个问题更关心“你知道最坏情况下的键列表是什么吗？” 而不是“你知道如何利用糟糕的哈希函数吗？”

显然，如果你想出一个所有条目散列到不同位置的序列，那么你总共有 O(1) 次插入 O(m) 时间。

对于您所说的将所有键散列到同一位置的内容，如果这是您的建议，则每次插入都应采用 O(n)。但是，这并不是插入所有元素的总时间。此外，您可能要考虑不要从字面上一遍又一遍地使用相同的键，而是使用会在表中产生相同位置的键。我认为，按照惯例，插入相同的密钥应该会导致替换，尽管我不是 100% 确定。

如果我提供太多信息或留下任何不清楚的地方，我会提前道歉。这个问题似乎很简单，除了实际上不知道哈希函数的部分之外，如果不回答整个问题，很难说太多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T17:50:15.507

好吧，这些问题背后的想法是测试你对探测风格的理解。对于线性探测，如果发生碰撞，您只需测试下一个单元。它会一直这样下去，直到你找到一个可用的单元格来存储你的数据。您的哈希表不需要大小为 m，但它必须是`at least size m`.

第一个问题是问如果你有一个完美的散列函数，填充表的复杂性是多少。完美的散列函数可以无冲突地处理每个元素。因此，对于 m 中的每个元素，您需要 O(1) 时间。总复杂度为 O(m)。

第二个问题是询问 hash(X)=cell(0) 的情况，所有元素都将搜索到第一个空单元格（就在当前填充的表的后面）。

对于第一个元素，您探测一次 -> O(1)

对于第二个元素，您探测两次 -> O(2)

对于第 n 个元素，您探测 n 次 -> O(n)

总的来说，你有 m 个元素，所以 ->`O(n*(n+1)/2)`

对于二次探测，您有相同的策略。最小情况相同，但最大情况将有 O(nlogn)。（我没有解决它，只是我有根据的猜测。）

# c# - 如何将此 SQL 查询转换为 LINQ (OVER (PARTITION BY Date))

> ID：11277695
> 
> 赞同：9
> 
> 时间：2012-06-30T21:10:50.520
> 
> 标签：c#, sql, asp.net-mvc, linq, entity-framework

这是我试图转换为 Linq 的查询：

```
SELECT R.Code, 
       R.FlightNumber, 
       S.[Date], 
       S.Station,
       R.Liters, 
       SUM(R.Liters) OVER (PARTITION BY Year([Date]), Month([Date]), Day([Date])) AS Total_Liters
FROM S INNER JOIN
               R ON S.ID = R.SID
WHERE (R.Code = 'AC')
AND FlightNumber = '124'
GROUP BY  Station, Code, FlightNumber, [Date], Liter
ORDER BY R.FlightNumber, [Date] 
```

谢谢你的帮助。

更新：这是我正在尝试的 Linq 代码；我无法按日期进行过度分区。

```
var test = 
(from record in ent.Records join ship in ent.Ship on record.ShipID equals ship.ID                       

orderby ship.Station
where ship.Date > model.StartView && ship.Date < model.EndView && ship.Station == model.Station && record.FlightNumber == model.FlightNumber

group record by new {ship.Station, record.Code, record.FlightNumber, ship.Date, record.AmountType1} into g

select new { g.Key.Station, g.Key.Code, g.Key.FlightNumber, g.Key.Date, AmmountType1Sum = g.Sum(record => record.AmountType1) }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T23:57:05.127

先执行查询而不进行聚合：

```
var test = 
(from record in ent.Records join ship in ent.Ship on record.ShipID equals ship.ID                       

orderby ship.Station
where ship.Date > model.StartView && ship.Date < model.EndView && ship.Station == model.Station && record.FlightNumber == model.FlightNumber

select new {ship.Station, record.Code, record.FlightNumber, ship.Date, record.AmountType1}; 
```

然后计算总和

```
var result = 
    from row in test
    select new {row.Station, row.Code, row.FlightNumber, row.Date, row.AmountType1, 
    AmountType1Sum = test.Where(r => r.Date == row.Date).Sum(r => r.AmountType1) }; 
```

这应该产生与数据库查询相同的效果。上面的代码可能有错误，因为我只写在这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-01T20:51:52.793

我已经回答了一个类似的主题：[LINQ to SQL and a running total on ordered results](https://stackoverflow.com/questions/1834753/linq-to-sql-and-a-running-total-on-ordered-results)

在那个线程上是这样的：

```
var withRuningTotals = from i in itemList    
                   select i.Date, i.Amount,    
                          Runningtotal = itemList.Where( x=> x.Date == i.Date).
                                                  GroupBy(x=> x.Date).
                                                  Select(DateGroup=> DateGroup.Sum(x=> x.Amount)).Single(); 
```

在您的情况下，您可能必须在分组时首先将两个表连接在一起，然后在连接的表结果上运行上述相同的概念。

# javascript - 画布绘制调用不按顺序渲染

> ID：11277697
> 
> 赞同：1
> 
> 时间：2012-06-30T21:11:08.537
> 
> 标签：javascript, html, graphics, canvas

我有以下代码用于将绘制调用写入“后台缓冲区”画布，然后使用 drawImage 将它们放置在主画布中。这是出于优化目的并确保所有图像按顺序放置。

在将缓冲画布放在主画布上之前，我使用 fillRect 在主画布上创建深蓝色背景。

但是，蓝色背景是在精灵*之后渲染的。*这是出乎意料的，因为我*首先*调用它的 fillRect 。

这是我的代码：

```
render: function() {
  this.buffer.clearRect(0,0,this.w,this.h);
  this.context.fillStyle = "#000044";
  this.context.fillRect(0,0,this.w,this.h);

  for (var i in this.renderQueue) {
    for (var ii = 0; ii < this.renderQueue[i].length; ii++) {
      sprite = this.renderQueue[i][ii];

      // Draw it!
      this.buffer.fillStyle = "green";
      this.buffer.fillRect(sprite.x, sprite.y, sprite.w, sprite.h);
    }
  }

  this.context.drawImage(this.bufferCanvas,0,0);
} 
```

当我在缓冲区画布上使用 fillRect 而不是主要画布时，也会发生这种情况。

在 'source-over' 和 'destination-over' （对于两种上下文）之间更改 globalCompositeOperation 不会改变这一点。

矛盾的是，如果我将蓝色 fillRect与其他绘图调用一起*放在*嵌套的 for 循环中，它会按预期工作......

提前致谢！

附录：更改复合操作的行为*确实*符合预期，但不是为了解决这个特定问题。很抱歉模棱两可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:22:06.917

这里有很多可疑之处。

首先，双缓冲画布只会增加复杂性而损害性能，所有浏览器都会自动进行双缓冲，所以如果这是你的目标，你不应该绘制到缓冲区。

这是为什么不需要双缓冲的示例：http: [//jsfiddle.net/simonsarris/XzAjv/](http://jsfiddle.net/simonsarris/XzAjv/)

因此，进入问题的实质，离散函数中的 javascript 行不会简单地乱序运行。这里还有其他问题。

在 上设置断点`drawImage`可以立即解决这个问题，所以如果你不熟悉 firebug 或 chrome 开发工具，我强烈建议你看看。

我猜你看到的“蓝色”实际上是唯一被绘制到“缓冲区”画布上的东西，也许`this.buffer`实际上并不是缓冲区上下文。

另一种可能性是`this.w`and`this.h`意外地非常小，因此您的初始`clearRect`和`fillRect`方法开始时什么都不做。

在任何情况下，推测都远不及开放开发者工具并实际观察正在发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:23:49.570

一般来说，如果您需要按顺序排列，请使用数组而不是对象。不能保证以任何特定顺序迭代对象。

使用数组和 for (var i=0; i

# cocoa-touch - Cocoa 中的本地 html 或 pdf 文件

> ID：11277698
> 
> 赞同：0
> 
> 时间：2012-06-30T21:11:19.397
> 
> 标签：cocoa-touch, cocoa

我需要在 Cocoa 中打开一个本地（而不是在网络上）html 文件或 pdf 文件，而不是在 iOS 中。我可以找到很多使用 UIKit 的示例，但还没有找到完整的使用 WebKit 的代码思路。有人可以帮我指出正确的方向或提供一些关于如何做到这一点的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T02:58:24.710

我很欣赏关于这个问题的建议。以下是我使用的代码

```
- (void)windowDidLoad
{
    [super windowDidLoad];

    NSString* filePath = [[NSBundle mainBundle]
                          pathForResource:@"myDocumentText"
                          ofType:@"pdf"]; 
    NSURL* fileURL = [NSURL fileURLWithPath:filePath];
    NSURLRequest* request = [NSURLRequest requestWithURL:fileURL];
    [[myWebView mainFrame] loadRequest:request];   

} 
```

# mysql - mysql 按当月查询和排序

> ID：11277700
> 
> 赞同：2
> 
> 时间：2012-06-30T21:11:47.547
> 
> 标签：mysql

我正在尝试使用以下方法选择当前月份的记录：

```
SELECT * FROM postdata 
ORDER BY postdate DESC 
WHERE MONTH(postdate) = MONTH(CURRENT_DATE) 
```

postdate 的日期格式是`YYYY-MM-DD`（`2012-06-30`例如），但遗憾的是没有返回任何记录。这是要使用的正确 MySQL 语句吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T21:20:37.167

目前尚不完全清楚这是您的意图，但似乎很可能，因此我将作为答案做出贡献：

除了您不合适之外，您`ORDER BY`还必须比较*月份*和日期。由于该函数`MONTH()`仅返回数字 1 到 12，因此查询将返回所有年份中六月的所有记录，而不仅仅是当前年份。使用两者`MONTH(), YEAR()`来比较当年的月份。

```
SELECT * FROM postdata     
WHERE 
  MONTH(postdate) = MONTH(CURDATE())
  AND YEAR(postdate) = YEAR(CURDATE())
ORDER BY postdate DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T21:17:58.487

`ORDER BY`必须在`WHERE`子句之后：

```
SELECT * FROM postdata 
WHERE MONTH(postdate) = MONTH(CURRENT_DATE)
ORDER BY postdate DESC 
```

可以这样想：

*   “获取”表中的所有行
*   过滤那些行`WHERE`
*   *然后*对过滤后的结果集进行排序。

从[文档](http://dev.mysql.com/doc/refman/5.0/en/select.html)（精简）中，`WHERE`出现*在* `ORDER BY`;

```
SELECT
    ...
    [WHERE where_condition]
    ...
    [ORDER BY {col_name | expr | position}
      [ASC | DESC], ...]
    ... 
```

* * *

除了你的 OP 中的问题之外，你的逻辑实际上有点缺陷；您需要比较日期的月份*和*年份，否则将选择任何年份中具有相同月份的行。尝试这个：

```
SELECT * FROM postdata 
WHERE 
    MONTH(postdate) = MONTH(NOW())
    AND YEAR(postdate) = YEAR(NOW())
ORDER BY postdate DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-12T07:51:10.393

这个月

```
WHERE DATE_FORMAT(date_column ,'%Y-%m') =  DATE_FORMAT(NOW() ,'%Y-%m') 
```

* * *

您想要的月份过滤

```
WHERE DATE_FORMAT(date_column ,'%Y-%m') =  DATE_FORMAT(NOW() ,'%Y-05') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T21:13:32.257

尝试这个 ：：

```
 SELECT * FROM postdata 
      WHERE MONTH(postdate) = MONTH(CURRENT_DATE) 
    YEAR(postdate) = YEAR(CURRENT_DATE)
ORDER BY postdate DESC 
```

# java - Java迭代读取与解析

> ID：11277703
> 
> 赞同：0
> 
> 时间：2012-06-30T21:12:24.507
> 
> 标签：java, performance, parsing, iterator

我有一个正在读取字符串的日志文件

```
public static String read (String path) throws IOException {
   StringBuilder sb = new StringBuilder();
   FileInputStream fs = new FileInputStream(path);
   InputStream in = new BufferedInputStream(fs);

   int r;
   while ((r = in.read()) != -1) {
       sb.append((char)r);
   }

   fs.close();
   in.close();

   return sb.toString();
} 
```

然后我有一个解析器迭代整个字符串一次

```
void parse () {
   String con = read("log.txt");
   for (int i = 0; i < con.length; i++) {
       /* parsing action */
   }
} 
```

这极大地浪费了 CPU 周期。我循环遍历`Read`. 然后我循环遍历`Parse`. 我可以`/* parsing action */`将 while 循环放在`Read`方法中，它会被找到，但我不想到处复制相同的代码。

如何在一次迭代中解析文件的内容，并且仍然有单独的解析和读取方法？

在 C# 中，我知道有某种收益返回的东西，但我被 Java 锁定了。

我在 Java 中有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:25:56.437

> 这极大地浪费了 CPU 周期。我遍历 Read 中的所有内容。然后我遍历 Parse 中的所有内容。我可以将 /* 解析操作 */ 放在 Read 方法中的 while 循环下，这可以找到，但我不想到处复制相同的代码。

这比大量浪费 CPU 周期更糟糕。将整个文件读入一个字符串是一种巨大的内存浪费，如果您只打算使用它一次并且使用是一次查看一个字符，如您的代码所示。如果你的文件很大，你会耗尽内存。

您应该在阅读时进行解析，并且永远不要一次将整个文件加载到内存中。

如果需要从多个位置调用解析操作，请将其设为函数并调用它，而不是到处复制相同的代码。复制单行函数调用很好。

# asp.net-mvc - mvc3 ASP.Net中div的自动刷新不起作用

> ID：11277705
> 
> 赞同：1
> 
> 时间：2012-06-30T21:12:28.780
> 
> 标签：asp.net-mvc

ViewData.cshtml(Partial View) 这是部分视图

```
<table id="users" class="ui-widget ui-widget-content" width="100%" align="center">
    <thead>
        <tr class="ui-widget-header ">
            <th width="30%" align="center">Date</th>
            <th width="30%" align="center">Bill Amount</th>
            <th width="30%" align="center">PayNow</th>

        </tr>
    </thead>
    <tbody>
        @{
            for (int i = @Model.bill.Count - 1; i >= 0; i--)
            {
            <tr>
                <td width="30%" align="center">@Model.billdate[i]</td>
                <td width="30%" align="center">@Model.bill[i]</td>
                <td width="30%" align="center">                    
                    <a class="isDone" href="#" data-tododb-itemid="@Model.bill[i]">Paynow</a>
                </td>
            </tr>
            }
        }
    </tbody>
</table> 
```

Index.cshtml(View) 这是我的看法

```
<script type="text/javascript">
$(document).ready(function () {
    window.setInterval(function () {
        var url = '@Url.Action("ShowScreen", "Home")';
        $('#dynamictabs').load(url)
    }, 9000);
    $.ajaxSetup({ cache: false });
});
</script>
<div class="dynamictabs">
    @Html.Partial("ShowScreen")
</div> 
```

HomeController.cs(Controller) 这是家庭控制器

```
public ActionResult Index()
{
   fieldProcessor fp= new fieldProcessor();
   return View(fp);
}

public ActionResult ShowScreen()
    {
        return View();
    } 
```

fieldProcessor.cs 我的模型

```
public class fieldProcessor 
{
    public List<int> bill { get; set; }
    public List<string> billdate { get; set; }
} 
```

仍然 Div 没有得到刷新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:12:34.713

这一行：

`$('#dynamictabs').load(url)`

应该：

`$('.dynamictabs').load(url)`

...因为您的 div 有一**类**动态标签，而不是 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:43:57.743

它将适用于一些代码更改：

1) 就像 greg84 说的：

这一行：

```
$('#dynamictabs').load(url) 
```

应该：

```
$('.dynamictabs').load(url) 
```

2）你的控制器应该是这样的：

```
 public ActionResult ShowScreen()
    {
        fieldProcessor fp = new fieldProcessor();
        /*Load fieldProcessor object*/

        return View(fp);
    }
  public ActionResult Index()
    {
        fieldProcessor fp = new fieldProcessor();
        /*Load fieldProcessor object*/
        return View(fp);
    } 
```

3) ShowScreen 和 Index 应该是强类型视图：

```
@model YourApp.Models.fieldProcessor 
```

4）当您的代码调用局部视图时，您应该传递模型，如下所示：

```
<div class="dynamictabs">
    @Html.Partial("ShowScreen",Model)
</div> 
```

# ruby-on-rails - 使用具有共享关系的继承类的最正确方法？

> ID：11277706
> 
> 赞同：0
> 
> 时间：2012-06-30T21:12:39.293
> 
> 标签：ruby-on-rails, mongodb, nosql

我有`TestVisual`该类继承的`Game`类：

```
class TestVisual < Game
  include MongoMapper::Document  
end

class Game
  include MongoMapper::Document         

  belongs_to :maestra  

  key :incorrect,         Integer
  key :correct,           Integer
  key :time_to_complete,  Integer

  key :maestra_id, ObjectId

  timestamps!

end 
```

如您所见，它属于 Maestra。

所以我可以做`Maestra.first.games`哪个返回`[]`

但我不能`Maestra.first.test_visuals`因为它返回`undefined method test_visuals`

由于我正在专门使用`TestVisuals`，因此理想情况下，这是我想要提取的，但仍然让它共享其父 Game 类的属性。

Mongo可以做到这一点吗？如果不是或者没有必要，还有其他更好的方法可以从 Maestra 到达 TestVisual 对象并仍然让它继承 Game 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:48:54.800

MongoMapper 中的单一集合继承 (SCI) 自动生成选择，例如，以下产生相同的结果。

```
p Game.where(_type: 'TestVisual').all
p TestVisual.all 
```

另见 mongomapper/lib/mongo_mapper/plugins/sci.rb - MongoMapper::Plugins::Sci::ClassMethods#query

但是，MongoMapper 不会根据基类的关联自动生成子类的关联，我认为这不应该是预期的。

请注意，SCI 将子类和基类放在同一个 MongoDB 集合中。如果这不是您想要的，您应该考虑其他模块化机制。

您可以自己为关联访问器方法定义以下方法，也许这足以满足您的目的？对于附加或推送等其他关联方法，父方法可能是可行的。

```
class Maestra
  include MongoMapper::Document
  key :name, String
  many :games

  def test_visuals
    games.where(_type: 'TestVisual')
  end
end 
```

测试/单元/test_visual_test.rb

```
require 'test_helper'

def ppp(obj)
  puts obj.inspect.gsub(/, ([^#])/, ",\n\t\\1").gsub(/, #/, ",\n #")
end
class TestVisualTest < ActiveSupport::TestCase
  def setup
    Maestra.delete_all
    Game.delete_all
  end

  test "inheritance" do
    maestra = Maestra.create(name: 'Fiona')
    maestra.games << Game.create(incorrect: 1, correct: 9, time_to_complete: 60)
    maestra.games << TestVisual.create(incorrect: 2, correct: 8, time_to_complete: 61)
    ppp maestra.games.to_a
    ppp maestra.test_visuals.to_a
  end
end 
```

输出

```
Run options: --name=test_inheritance

# Running tests:

[#<Game _id: BSON::ObjectId('4ff7029a7f11ba6e43000002'),
    _type: "Game",
    correct: 9,
    created_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00,
    incorrect: 1,
    maestra_id: BSON::ObjectId('4ff7029a7f11ba6e43000001'),
    time_to_complete: 60,
    updated_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00>,
 #<TestVisual _id: BSON::ObjectId('4ff7029a7f11ba6e43000003'),
    _type: "TestVisual",
    correct: 8,
    created_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00,
    incorrect: 2,
    maestra_id: BSON::ObjectId('4ff7029a7f11ba6e43000001'),
    time_to_complete: 61,
    updated_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00>]
[#<TestVisual _id: BSON::ObjectId('4ff7029a7f11ba6e43000003'),
    _type: "TestVisual",
    correct: 8,
    created_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00,
    incorrect: 2,
    maestra_id: BSON::ObjectId('4ff7029a7f11ba6e43000001'),
    time_to_complete: 61,
    updated_at: Fri,
    06 Jul 2012 15:22:02 UTC +00:00>]
.

Finished tests in 0.026661s, 37.5080 tests/s, 0.0000 assertions/s.

1 tests, 0 assertions, 0 failures, 0 errors, 0 skips 
```

# jquery - 如何执行 jQuery 正则表达式以在我的网站上查找右箭头的所有 HTML 实体 → 并添加一个类？

> ID：11277707
> 
> 赞同：1
> 
> 时间：2012-06-30T21:12:40.633
> 
> 标签：jquery, regex, jquery-selectors

我想在 jQuery 中执行一个正则表达式来查找我网站上的所有 HTML 右箭头实体 → 并添加一个“箭头样式”类。我的“箭头样式”CSS 类具有与使用的其他字体不同的特定字体，因此我只想选择箭头实体以便我可以设置它的样式。

这些就是我所说的 HTML 实体的意思：http: [//www.w3schools.com/tags/ref_symbols.asp](http://www.w3schools.com/tags/ref_symbols.asp) （请搜索箭头）

例如，我希望在整个站点中查询以下内容并添加一个类。但是，我不能简单地选择所有`<a>`这些箭头实体在各种 HTML 标记中（它们不只是在`<a>`标签中）

```
<a href="#">Learn More &rarr;</a> 
```

输出应该是：

```
<a href="#">Learn More <span class="arrow-style">&rarr;</span></a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:16:54.677

以下代码应该可以工作：

```
​$("body *")​​​.html(function(i, val) {
    return val.replace(/(→)/g, "<span class='arrow-style'>$1</span>");
});​ 
```

**演示：http:** [//jsfiddle.net/yga64/](http://jsfiddle.net/yga64/)

# objective-c - iOS CoreGraphics：绘制弧线，从相交弦定理确定弧角

> ID：11277708
> 
> 赞同：6
> 
> 时间：2012-06-30T21:12:45.160
> 
> 标签：objective-c, ios, core-graphics

我试图弄清楚如何在 CoreGraphics 中绘制弧线。我了解在以下场景中调用哪种方法以及如何计算角度。

```
----------
|        |
*--------* 
```

当点都在矩形的底部时。但是，当两点在其他位置时，我不知道如何计算正确的角度。

```
---------*
|        |
*--------- 
```

请参阅我的图像的底部。

![在此处输入图像描述](../Images/c769eeca1128924e2bcefb9d662f81d4.png)

Ray Wenderlich 有一个[很棒的教程](http://www.raywenderlich.com/2106/core-graphics-101-arcs-and-paths)，关于仅在第一次提到的点位置创建弧线。

```
// sample code for creating arc for path from bottom of rect
CGMutablePathRef createArcPathFromBottomOfRect(CGRect rect, CGFloat arcHeight) {
  CGRect arcRect = CGRectMake(rect.origin.x, rect.origin.y + rect.size.height
    - arcHeight, rect.size.width, arcHeight);
  CGFloat arcRadius = (arcRect.size.height/2) + (pow(arcRect.size.width, 2) /
    (8 * arcRect.size.height));
  CGPoint arcCenter = CGPointMake(arcRect.origin.x + arc.size.width/2,
    arcRect.origin.y + arcRadius);
  CGFloat angle = acos(arcRect.size.width/ (2*arcRadius));
  CGFloat startAngle = radians(180) + angle;
  CGFloat endAngle = radians(360) - angle;
  CGMutablePathRef path = CGPathCreateMutable();
  CGPathAddArc(path, NULL, arcCenter.x, arcCenter.y, arcRadius, startAngle,
    endAngle, 0);
  return path;
} 
```

在图像底部所示的其他情况下，如何计算角度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T23:29:27.757

我发现制作弧线的更简单方法是使用：

```
void CGContextAddArcToPoint (
   CGContextRef c,
   CGFloat x1,
   CGFloat y1,
   CGFloat x2,
   CGFloat y2,
   CGFloat radius
); 
```

[如果您从 Ray Wenderlich 的网站 ( https://www.raywenderlich.com/33330/core-graphics-tutorial-glossy-buttons](https://www.raywenderlich.com/33330/core-graphics-tutorial-glossy-buttons) )查看这张图片，点 (x1,y1) 是曲线和点 ( x2,y2) 是您的终点。然后只需指定角半径，瞧！看起来这可能是一个更容易用于您想要做的事情的 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T08:47:46.027

您至少需要 3 个点来确定一个圆。

在您的第一个场景中，两个点位于矩形的底部，当 arcHeight 已知时，顶部中间点隐含地是第三个点。所以三个点决定了圆，从而决定了弧。因此可以计算所有角度等。

但是，在您的第二个场景中，没有定义第三点。因此，您可以绘制通过具有不同曲率的两个点的无限数量的弧。您将需要额外的要求来修复弧。例如半径或第三个点应该是圆弧之一。

# jquery - 错误信息如果需要输入空

> ID：11277709
> 
> 赞同：0
> 
> 时间：2012-06-30T21:13:00.907
> 
> 标签：jquery

我一直在寻找解决方案，但似乎找不到任何适合我的例子。这是我到目前为止所得到的：

```
$(document).ready(function() {
   $("form#submit").submit(function() {
      // we want to store the values from the form input box, then send via ajax below
      var user_email     = $('#user_email').attr('value');
      var mobile     = $('#mobile').attr('value');
      var id_country     = $('#id_country').attr('value');
      var id_target     = $('#id_target').attr('value');    
      var id = $('#id').attr('value'); 

      $.ajax({
        type: "POST",
        url: "ajax.php",
        data: "user_email="+ user_email + "&mobile=" + mobile + "&id_country=" +
        id_country + "&id_target=" + id_target + "&id=" + id,
        success: function(){
            $('form#submit');
            //$('form#submit :input').val("");
            $('div.success').fadeIn("slow")
            $('div.success').fadeOut("slow");
          }
       });
      return false;
   });
}); 
```

当我提交表单时，数据成功插入数据库。如果需要输入空，我需要 div.error ！！！如何编辑我的代码以使用 class="required" 填充所有必填字段？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:56:55.310

[jQuery Validation 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)是一个非常完善的用于客户端验证的 jquery 验证工具（在您的 ajax 调用之前）。

如果您要验证字段是否为空，可以查看[此处](http://jquery.bassistance.de/validate/demo/)的示例。 您可以为每个字段提供特定消息，或为所有字段提供通用消息。

这似乎也是一个非常适合你想做的介绍： http: [//elegantcode.com/2009/09/27/playing-with-jquery-validation-library/](http://elegantcode.com/2009/09/27/playing-with-jquery-validation-library/)

它还允许您确保您的 user_email 字段是正确的电子邮件地址

尝试使用这样的验证功能

```
 $("#submit").validate({
        rules : {
          user_email: {
              required: true
          }
        },
        messages: {
          user_email: {
            required: "This field is required"
            }
        },
        submitHandler: function(form)   {
           // Put your ajax call in here                
        }                
     });
}); 
```

# java - ActionBarSherlock 有很多错误

> ID：11277711
> 
> 赞同：2
> 
> 时间：2012-06-30T21:13:14.627
> 
> 标签：java, android, javac

这是我第一次使用外部库，我对删除所有错误有点紧张。添加时的库给了我一大堆错误，具有相同的修复“删除@Override注释”。

解决此问题的方法是将我的 JDK 增加到 1.6：[ActionBarSherlock 库在导入后充满错误](https://stackoverflow.com/questions/11165700/actionbarsherlock-library-is-full-of-errors-after-being-imported)

但现在我担心我的其他应用程序......我编译它们的方式错误吗？另外，我有一个可用的 1.7 JDK，我应该使用它而不是 1.6 吗？对不起，我真的不知道有什么区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:14:35.580

这个非常普遍的问题...

这很可能是因为您在 Java 1.5 和 Java 1.6 之间切换。在 1.5 中，您不能使用 @Override 标记接口实现，但在 1.6 中可以。

[@Override 注释错误（android 首选项）](https://stackoverflow.com/questions/4761888/override-annotation-error-android-prefs)

[Eclipse 中覆盖注释的错误](https://stackoverflow.com/questions/3735661/bug-with-override-annotations-in-eclipse)

[将项目导入 Eclipse 后出现“必须覆盖超类方法”错误](https://stackoverflow.com/questions/1678122/must-override-a-superclass-method-errors-after-importing-a-project-into-eclips)

[为什么我使用@Override 得到“必须覆盖超类方法”？](https://stackoverflow.com/questions/8697513/why-do-i-get-must-override-a-superclass-method-with-override)

另外，我有一个可用的 1.7 JDK，我应该使用它而不是 1.6 吗？

[Android 的 Java 7 语言功能](https://stackoverflow.com/questions/7153989/java-7-language-features-with-android)

[Android 是否计划支持 Java7？](https://stackoverflow.com/questions/8535164/does-android-plan-to-support-java7)

[Android 的 Java 版本与 Java SE 版本有何关系？](https://stackoverflow.com/questions/7535385/how-does-androids-java-version-relate-to-a-java-se-version)

# ipad - 如何添加 iPad 子视图控制器以充当标签栏

> ID：11277714
> 
> 赞同：1
> 
> 时间：2012-06-30T21:13:33.613
> 
> 标签：ipad, uitableview, uitabbarcontroller, uisplitviewcontroller

我有一个应用程序，我刚刚设置了一个拆分视图控制器，以在应用程序的 ipad 版本上显示博客。当前设置是主控制器是一个表格视图，用于显示博客中的不同文章，而详细控制器是一个视图控制器，里面有一个 webview 用于显示文章的内容。问题是我在应用程序中有一些其他功能，在 iPhone 版本上，我使用标签栏控制器进行导航。有哪些选项可以将按钮添加到细节控制器以允许我导航到应用程序的其他部分？我知道我无法在拆分视图控制器中获得选项卡栏控制器，所以我只需要一些指导。

我知道 Engadget 应用程序已设置，因此当您以纵向模式打开时，它会显示应用程序的表格视图，以及底部的控制器以访问不同的内容，例如照片，而在横向模式下，表格视图位于左侧文章的正文在右边。我只想设置它，这样如果您以纵向模式打开就没有空白页面，并且除了在导航栏上添加按钮之外，还具有查看其他页面的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:28:14.047

您可以将 tabBarController 添加到 SplitViewController 的详细视图。只需创建一个`UIViewController`响应`<UITabBarControllerDelegate>`并在该控制器的 xib 文件中添加一个`UITabBarController`对象并将其链接到您的 UIViewController。在您`viewDidLoad`将选项卡栏控制器添加到视图中：

```
-(void)viewDidLoad {

     ...

     [self addChildViewController:myTabBarController];

     //add the tabBarController view
     [self.view addSubview:myTabBarController.view];

} 
```

这`UIViewController`将分配给您的详细视图。这行得通，我以前试过。但是，苹果是否会允许呢？我不知道！

**编辑：**

首先你们不应该给`viewDidLoad`自己打电话。

另外，我认为您不需要`rootipad`，`detailipad`只要控制器链接到 xib 文件中的 SplitViewController 即可。

在您的`RootViewiPad`（主）中添加以下内容`viewDidLoad`：

```
-(void)viewDidLoad {

    ...

    if (self.interfaceOrientation == UIInterfaceOrientationPortrait || self.interfaceOrientation == UIInterfaceOrientationPortraitUpsideDown) {

        //select the first row to load 
        [self.tableView selectRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0] animated:NO scrollPosition:UITableViewScrollPositionNone];

        //NOTE, I'm assuming that selecting the cell will load the detail view.
        //if that is not the case, you need to do what ever you need to load the 
        //detail view.
    }
} 
```

如果您希望每次都发生这种行为（不仅是在第一次加载时），那么请将代码添加到`-(void)viewWillAppear`方法中。

# javascript - 如何从 javascript 调用 flash cs6

> ID：11277716
> 
> 赞同：3
> 
> 时间：2012-06-30T21:13:42.623
> 
> 标签：javascript, flash

那么 JavaScript 在新的 Flash Pro CS6 中是如何工作的呢？

要调用 JavaScript，您正在使用新[接口](http://tv.adobe.com/watch/cs6-creative-cloud-feature-tour-for-web/creating-javascript-in-flash-professional-cs6/)：

```
/* js
alert("Hello from JavaScript");

*/ 
```

但是如何从 JavaScript 调用 flash 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:03:17.517

看看这个快速教程，它对我有用：[http ://circlecube.com/2010/12/actionscript-as3-javascript-call-flash-to-and-from-javascript/](http://circlecube.com/2010/12/actionscript-as3-javascript-call-flash-to-and-from-javascript/)

该教程相当古老（在 CS6 之前），因此它解释了如何从 flash 调用 js，反之亦然。您想要的基本部分是这个 actionScript：

```
ExternalInterface.addCallback("name_of_js_function", name_of_as3_function);

function name_of_as3_function():void {
    // I was called from javascript
} 
```

# android - 缺少 android.net.sip

> ID：11277720
> 
> 赞同：1
> 
> 时间：2012-06-30T21:14:08.340
> 
> 标签：android, mono, xamarin.android, sip

我在以下环境中有以下版本的 Andorid 和 Java SDK。

我正在尝试开发一个 SIP 应用程序，但是当 Android.net.http 和 Android.net.wifi 都存在时，所需的 Android.net.sip 没有出现。

我假设这与 android SDK（版本或可能与 Java SDK 版本不匹配）有关，但我无法找到有关此类问题的任何信息，或者在 Mono 中找到有关 SIP 应用程序支持的一般信息.

如果有人能引导我找到丢失 .sip 程序集的问题，我将不胜感激。

MonoDevelop 3.0.3.2

安装UUID：6e3978d7-9762-4c5a-80ee-c19e6a271794

运行：

```
Microsoft .NET 4.0.30319.269

GTK 2.16.6

GTK# (2.12.0.0) 
```

适用于 Android 的单声道：4.2.3.68199851

Android SDK：C:\Android\android_sdk\android-sdk

支持的安卓版本：

```
Version: 1.6    ApiLevel: 4

Version: 2.1    ApiLevel: 7

Version: 2.2    ApiLevel: 8

Version: 2.3    ApiLevel: 10

Version: 3.1    ApiLevel: 12

Version: 4.0    ApiLevel: 14

Version: 4.0.3  ApiLevel: 15 
```

Java SDK：C:\Program Files (x86)\Java\jdk1.6.0_27\bin

没有构建信息

操作系统：

```
Windows 6.1.7601.65536 (64-bit) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T03:02:09.373

通过查看我的评论回答了我的问题。我将兼容性级别设置为 2.2，这显然在 API 级别 9 之前。将兼容性级别设置为 2.2.5（API 级别 9），一切都显示出来了。

# python - python 2 代码：如果 python 3 则 sys.exit()

> ID：11277721
> 
> 赞同：43
> 
> 时间：2012-06-30T21:14:17.173
> 
> 标签：python, python-3.x, python-2.x

我有一大段仅限 Python 2 的代码。它想在开始时检查 Python 3，如果使用 python3 则退出。所以我尝试了：

```
import sys

if sys.version_info >= (3,0):
    print("Sorry, requires Python 2.x, not Python 3.x")
    sys.exit(1)

print "Here comes a lot of pure Python 2.x stuff ..."
### a lot of python2 code, not just print statements follows 
```

然而，退出并没有发生。输出是：

```
$ python3 testing.py 
  File "testing.py", line 8
        print "Here comes a lot of pure Python 2.x stuff ..."
                                                        ^
SyntaxError: invalid syntax 
```

因此，看起来 python 在执行任何操作之前会检查*整个*代码，因此会出现错误。

python2代码是否有一种很好的方法来检查正在使用的python3，如果是这样，打印一些友好的东西然后退出？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-30T21:20:56.043

Python 将在开始执行之前对源文件进行字节编译。整个文件至少必须正确*解析*，否则你会得到一个`SyntaxError`.

解决您的问题的最简单方法是编写一个小型包装器，将其解析为 Python 2.x 和 3.x。例子：

```
import sys
if sys.version_info >= (3, 0):
    sys.stdout.write("Sorry, requires Python 2.x, not Python 3.x\n")
    sys.exit(1)

import the_real_thing
if __name__ == "__main__":
    the_real_thing.main() 
```

该语句`import the_real_thing`只会在语句之后执行，*因此*`if`该模块中的代码不需要解析为 Python 3.x 代码。

# android - HTTP 在 Android 模拟器中不起作用

> ID：11277734
> 
> 赞同：12
> 
> 时间：2012-06-30T21:16:13.317
> 
> 标签：android, http

我尝试了多个 HTTP 类（和其他类） `HttpURLConnection`，`HTTPClient`但它们在模拟器中不起作用。然后我决定在我的手机上测试它，它运行良好！

那么我该如何解决Android模拟器的这种奇怪行为，即HTTP类不起作用（而浏览器可以工作）？他们完全崩溃了一个应用程序。

这是我的代码：

```
public static SimpleXML getResponse(String action, Map<String, String> params) {
     // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(action);

    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(params.size());
        for(Map.Entry<String, String> heh : params.entrySet())
            nameValuePairs.add(new BasicNameValuePair(heh.getKey(), heh.getValue()));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);
        return SimpleXML.loadXml(response.getEntity().getContent());       

    } catch (ClientProtocolException e) {
        return null;
    } catch (IOException e) {
        return null;
    }   
} 
```

LogCat 日志：

```
06-30 22:07:28.972: E/AndroidRuntime(682): FATAL EXCEPTION: main
06-30 22:07:28.972: E/AndroidRuntime(682): android.os.NetworkOnMainThreadException
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
06-30 22:07:28.972: E/AndroidRuntime(682):  at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
06-30 22:07:28.972: E/AndroidRuntime(682):  at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
06-30 22:07:28.972: E/AndroidRuntime(682):  at java.net.InetAddress.getAllByName(InetAddress.java:214)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:137)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
06-30 22:07:28.972: E/AndroidRuntime(682):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
06-30 22:07:28.972: E/AndroidRuntime(682):  at net.ekvium.air.API.getResponse(API.java:98)
06-30 22:07:28.972: E/AndroidRuntime(682):  at net.ekvium.air.MainActivity$1.onClick(MainActivity.java:62)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.view.View.performClick(View.java:4084)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.view.View$PerformClick.run(View.java:16966)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.os.Handler.handleCallback(Handler.java:615)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.os.Handler.dispatchMessage(Handler.java:92)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.os.Looper.loop(Looper.java:137)
06-30 22:07:28.972: E/AndroidRuntime(682):  at android.app.ActivityThread.main(ActivityThread.java:4745)
06-30 22:07:28.972: E/AndroidRuntime(682):  at java.lang.reflect.Method.invokeNative(Native Method)
06-30 22:07:28.972: E/AndroidRuntime(682):  at java.lang.reflect.Method.invoke(Method.java:511)
06-30 22:07:28.972: E/AndroidRuntime(682):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
06-30 22:07:28.972: E/AndroidRuntime(682):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
06-30 22:07:28.972: E/AndroidRuntime(682):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-30T22:28:15.020

如果您查看[此 Android 文档](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)，它会解释

**网络主线程异常：**

> 当应用程序尝试在其主线程上执行网络操作时引发的异常。
> 
> 这仅针对面向 Honeycomb SDK 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。

因此，根据操作系统版本，可能会强制执行（抛出异常）您不在 UI 线程上发出网络请求的策略。这可以解释为什么您的代码可以在设备上运行，而不是在模拟器上运行（如果它们有不同的 Android 版本）。

你*可以*改变`ThreadPolicy`. 但作为替代方案，我建议您再次查看 Android 文档中的声明。他们**强烈**反对在主线程上执行网络操作，我当然同意他们的观点。

因此，与其更改策略以*使其合法*，不如考虑更改代码，以便`getResponse()`不会在 UI 线程上调用您的方法。

通常，您会使用[AsyncTask 在后台完成工作](http://developer.android.com/reference/android/os/AsyncTask.html)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-30T22:14:42.757

发生这种情况是因为您尝试在主线程上执行网络活动。

我有同样的问题，它工作了一段时间，然后经过几周的开发，它停止工作。

我找到的解决方案是将这些行添加到

```
onCreate() 
```

方法：

```
 StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy); 
```

希望这对你也有用

**编辑**

由于赞成票的数量越来越多，我想补充一些东西。这将删除`NetworkingOnMainThreadException`，**但是，到目前为止，这不是推荐的方式。**

这个例外是有原因的。网络活动可能需要时间，在主线程（负责更新 UI 的线程）上执行网络连接会冻结线程，直到网络连接完成（这是每个线程上发生的情况，但是当它在专用线程上执行时）线程，没关系）。在 Android 中，如果 UI 线程在 5 秒内未处于活动状态，它将显示`Application is not responsive, Do you want to close it?`对话框。

这就是异常所要防止的。像我建议的那样设置政策，虽然消除了例外，但做事的方式是错误的。任何网络操作都应在单独的线程上完成，无论是通过使用`AsyncTask`还是通过`Thread`手动创建。`AsyncTask`是一种非常简单直接的实现方式，这就是我推荐的。

使用我的答案时请考虑此编辑。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-11T05:57:07.147

您可以使用以下代码禁用严格模式：

```
if (android.os.Build.VERSION.SDK_INT > 9) {
StrictMode.ThreadPolicy policy = 
new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy);
} 
```

**不建议这样做：**使用`AsyncTask`接口。

[AsyncTask 的链接](http://www.javaexperience.com/android-create-non-blocking-user-interface/)

[另一个参考的链接](https://stackoverflow.com/questions/6343166/android-os-networkonmainthreadexception)

# android - 如何通过活动生命周期保持 Twitter OAuth 会话状态

> ID：11277736
> 
> 赞同：2
> 
> 时间：2012-06-30T21:16:37.280
> 
> 标签：android, android-activity, twitter-oauth, android-lifecycle

我正在制作一个使用 OAuth 向 Twitter 授权并发送推文的活动（编辑：我正在使用 Twitter4j）。为此，我必须首先从 Twitter 请求一个 RequestToken，然后用户到浏览器去授权应用程序，然后我被发送回 onNewIntent()，intent.getData() 中有一个授权字符串。我使用 RequestToken 和字符串来形成一个有效的 AccessToken。

据我了解，由于我的活动在用户退出浏览器时离开焦点，因此无法保证一旦我返回 onNewIntent()，我的会话状态将可用，这意味着我可能不再有 RequestToken哪个来制作 AccessToken。在理想情况下，我只需将 RequestToken 保存到 SharedPreferences 并稍后在需要时将其拉出。然而，在调查之后，这样做非常重要，因为我真的无法解构/重建 RequestToken 对象（AFAIK，如果你知道，请纠正我，因为这会更可取）。

所以我正在考虑实现 onSaveInstanceState() 和 onRestoreInstanceState() 但我只是没有掌握我读过的文档。在这种情况下，当我到达 onNewIntent() 时，我如何保证我的 RequestToken 对象（最好是我的状态的其余部分）在我身边供我使用？

谢谢，== 马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T01:13:49.907

事实证明我不需要保留 RequestToken，因为没有它我可以构建一个 AccessToken。可以使用 A) RequestToken + oauth_verifier 或 B) access_token + access_token_secret 字符串来构建 AccessToken。

所以我使用 RequestToken 来获取 oauth_verifier，并用它制作一个 AccessToken，然后我从 AccessToken 中提取 access_token 和 access_token 字符串，并存储它们。稍后我可以使用存储的 access_token 和 access_token_secret 字符串重建 AccessToken。

# javascript - 如何在 jQuery 中转义单引号？

> ID：11277739
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:16:55.610
> 
> 标签：javascript, jquery, html

我知道我可以使用\'，但这不是重点。假设我有“不能”这个词。它现在有“'”。这进入了函数中的 var ，如下所示：

```
function active(id,clas,match,hometeam,awayteam){ 
```

因此，假设 hometeam 具有“不能”的值。当我尝试使用此代码时：

```
$('#test').html(hometeam + " VS " + awayteam); 
```

它不起作用，因为本质上它具有：

```
$('#test').html(can't + " VS " + awayteam); 
```

我该如何解决这个问题？

编辑：

我认为问题不在于 jQuery。调用此函数的行是这一行：

```
<input type="button" id="btn" value="1.4" class="butta" onmousedown="active('btn','buttdowna','match1','hometeam','awayteam')" /> 
```

那么我该如何逃避呢？

编辑：我还没有找到完美的解决方案，所以我只是在我的数据库中更改了单词并添加了“\”现在......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:57:35.443

您可以像这样更改 HTML 部分，它会起作用，

```
<input type="button" id="btn" value="1.4" class="butta" onmousedown=active("btn","buttdowna","match1","can't","awayteam") /> 
```

在没有引号的 HTML 属性中也可以使用。引用用于分组。示例）title="Click Event" 将起作用，并且 title=Click Event 将仅采用第一个值（Click）。也就是说，如果一个单词不包含空格，则不需要引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:19:50.777

这应该有效。如果内容有双引号，则将字符串包裹在单引号中并在其中转义单引号。

```
var hometeam = '"can\'t"';
$('#test').html(hometeam + 'VS' + awayteam) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:19:58.823

变量返回的值不需要在 javascript 中转义。如果您遇到问题，则存在其他一些潜在问题。

编辑：根据您的问题编辑，您需要转义函数调用中的值，如果您要`can't`用作您需要的参数之一

`<input type="button" id="btn" value="1.4" class="butta" onmousedown="active('btn','buttdowna','can\'t','hometeam','awayteam')" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T21:37:17.160

问题是您正在使用字符串操作来构建 HTML。改用 jQuery/DOM 方法，你不会有这个问题。

另一种方法是转义引号，但与之前的建议相比，这真的很难看。

* * *

由于您是在 PHP 中创建 HTML，因此请执行以下操作：

```
echo '<input type="button" id="btn" value="1.4" class="butta" onmousedown=\'active("btn","buttdowna","match1",'.htmlspecialchars(json_encode($foo)).', '.htmlspecialchars(json_encode($bar)).');\' />'; 
```

# objective-c - ObjC：将逻辑放在一个变量中，然后将该变量放入一个数组中……做白日梦？

> ID：11277745
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:17:33.300
> 
> 标签：objective-c, function, queue

我正在尝试将以下 JS 代码转换为 ObjC；它基本上定义了一个函数并将其存储在一个数组中以供以后执行：

```
var logic = function() {
    me.removeNode(node);
}
this.queue.push(logic); 
```

我的 ObjC 端口包含该方法：`-(void)removeNode:(AbstractNode*)node`我被卡住了...我只想使用指定的“节点”参数对这个方法的调用进行排队...

编辑：我正在阅读有关选择器的信息。它仍然模糊，但可能会有所帮助。不知何故。或不？

甚至有可能，还是我需要找到解决方法:-)？谢谢！

感谢社区的解决方案：

```
// Queue declaration
NSMutableArray *IRQ = [[NSMutableArray array] retain];

// Add logic to the queue for delayed execution:
[IRQ addObject:^{ NSLog(@"thanks for the help!"); } ];

// Call later
for (int i = 0; i < [IRQ count]; i++){
     void (^delayedCall)(void) = [IRQ objectAtIndex:i];
     delayedCall();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:24:46.727

使用块：

```
[queue addObject:^{
    [me removeNode:node];
}]; 
```

这是[对 blocks 的简短介绍](http://developer.apple.com/library/ios/#featuredarticles/Short_Practical_Guide_Blocks/_index.html)。它们是匿名函数的 Objective-C 等价物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:22:01.640

我相信你应该能够用函数指针来做到这一点。如果您的回调都采用相同的类型和参数集，您应该能够编写通用代码来调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T21:33:02.637

您还可以使用 NSInvocation 类。

# c++ - 按值返回时复制构造函数的奇怪行为

> ID：11277747
> 
> 赞同：1
> 
> 时间：2012-06-30T21:17:52.047
> 
> 标签：c++, copy-constructor, return-by-value

我使用按值返回对象的函数测试了复制构造函数的行为，我遇到了复制构造函数确实被调用的情况和没有被调用的情况。

请考虑以下代码：

```
class A {
public:
    A() {}
    A(const A& a) {
        cout << "Copy CTOR: " << "This address is " << this 
             << " input address is "<< &a <<       "\n";
    }
};

A returnMyself(A& a) {
    cout<<"Myself address is: "<< &a << "\n";
    return a;
}

A returnLocal(A& a) {
    A local;
    cout<<"local address in returnLocal is  "<< &local << "\n";
    return local;
}

int main () {
    A a;
    cout<<"Before returnMyself\n";
    returnMyself(a);
    cout<<"After returnMyself\n\n";

    cout<<"Before returnLocal\n";
    returnLocal(a);
    cout<<"After returnLocal\n";
} 
```

的输出`main`是：

```
在返回之前自己。
我自己的地址是：0x7fff6afd88f0。
复制 CTOR 调用：此地址为 0x7fff6afd88d8。输入地址为 0x7fff6afd88f0。
回来后自己。

在返回本地之前。
returnLocal 中的本地地址是 0x7fff6afd88d0。
返回本地后。

```

如您所见，当我声明一个本地对象并返回它时，不会调用复制构造函数，而不是返回一个调用复制构造函数的给定引用对象。

有人对此有解释吗？一般来说，从按值返回的函数调用复制构造函数的情况有哪些？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:20:23.920

这是[复制省略](http://en.wikipedia.org/wiki/Copy_elision)。编译器足够聪明，可以优化该副本。

# ssl - AWS ELB IP 地址对于 ELB 是否唯一？

> ID：11277753
> 
> 赞同：3
> 
> 时间：2012-06-30T21:19:31.350
> 
> 标签：ssl, amazon-web-services, amazon-elb

有谁知道带有 SSL 的 AWS ELB 如何在幕后工作？在我的 ELB 的域名上运行 nslookup，我得到了 4 个唯一的 IP 地址。如果我的 ELB 启用了 SSL，AWS 是否可以与其他启用 SSL 的 ELB（不一定归我所有）共享这些相同的 IP？

据我了解，Web 请求中的主机名位于 https 请求的加密 Web 请求中。如果是这种情况，AWS 是否必须为每个启用了 SSL 的 ELB 提供唯一的 IP 地址，这些地址永远不会与其他任何人的 SSL ELB 实例共享？换句话说，AWS 是否为您请求的每个 SSL ELB 提供了 4 个唯一的 IP 地址？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T16:49:59.800

> 有谁知道带有 SSL 的 AWS ELB 如何在幕后工作？[...] 换句话说——AWS 是否为您请求的每个 SSL ELB 提供 4 个唯一的 IP 地址？

[Elastic Load Balancing (ELB)](http://aws.amazon.com/elasticloadbalancing/)本身采用可扩展架构，这意味着分配给 ELB 的唯一 IP 地址的数量实际上会根据 ELB 的容量需求和相应的扩展活动而有所不同，请参阅在[最佳实践中](http://aws.amazon.com/articles/1636185810492479)*扩展弹性负载均衡器部分*[在 Evaluating Elastic Load Balancing中（](http://aws.amazon.com/articles/1636185810492479)*对 Elastic Load Balancing 服务的架构及其工作*方式提供了非常详细的说明）：

> 控制器还将监控负载平衡器并管理容量 [...]。它通过利用更大的资源（具有更高性能特征的资源）**或更多的单独资源**来增加容量。Elastic Load Balancing 服务将在扩展时更新负载均衡器的域名系统 (DNS) 记录，以便**新资源在 DNS 中注册其各自的 IP 地址**。创建的 DNS 记录包括 60 秒的生存时间 (TTL) 设置，[...]。默认情况下，当客户端执行 DNS 解析时，Elastic Load Balancing 将返回多个 IP 地址，记录是随机排序的 [...]。**随着流量配置文件的变化，控制器服务将扩展负载均衡器以处理更多请求，在所有可用区中均等地扩展。** *[强调我的]*

*这在DNS 解析*部分有更详细的说明，包括负载测试 ELB 设置的重要提示：

> 当 Elastic Load Balancing 扩展时，它会使用新的 IP 地址列表更新 DNS 记录。[...]**将这种不断变化的 DNS 记录纳入测试至关重要**。如果您不确保重新解析 DNS 或使用多个测试客户端来模拟增加的负载，则当 Elastic Load Balancing 实际上分配了更多 IP 地址时，测试可能会继续命中单个 IP 地址。*[强调我的]*

[整个主题在 Shlomo Swidler 的出色分析“Elastic Load Balancing”中的“Elastic”：ELB Elasticity and How to Test it](http://shlomoswidler.com/2009/07/elastic-in-elastic-load-balancing-elb.html)中进行了更详细的探讨，同时还参考了上述AWS[评估 Elastic Load Balancing 的最佳实践](http://aws.amazon.com/articles/1636185810492479)，基本上证实了他的分析，但缺乏 Shlomo 提供的说明性逐步示例。

# c# - C# MVC 4，区域路线，使用主视图？

> ID：11277755
> 
> 赞同：0
> 
> 时间：2012-06-30T21:19:40.477
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, asp.net-mvc-4

我有一个包含区域的基本项目，我已经在该区域注册了我的路线并使用了小写 URL 扩展。这是代码：

```
using System.Web.Mvc;

using Web.Modules;

namespace Web.Areas.Services
{
    public class ServicesAreaRegistration : AreaRegistration
    {
        public override string AreaName
        {
            get
            {
                return "Services";
            }
        }

        public override void RegisterArea(AreaRegistrationContext context)
        {
            context.MapRouteLowercase(
                "Services", // Route name
                "services/{controller}/{action}/{id}", // URL with parameters
                new { controller = "Services", action = "Index", id = UrlParameter.Optional }, // Parameter defaults
                new string[] { "Web.Areas.Services" }
            );
        }
    }
} 
```

但是现在当我去`http://localhost/services/home`它显示我的 HomeController 的索引视图时，我能做些什么来解决这个问题？我已经添加了命名空间并将区域添加到路由数据。

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:49:31.117

似乎您根本没有文件夹 Areas/Services/Views/Home 或该文件夹中的索引视图。在这种情况下，ASP.NET MVC 将回退到从 Views/Home（无区域）文件夹显示您的索引视图。如果您需要为您的区域创建不同的视图，您需要在该区域的 Views/[Controller Name] 文件夹（当然也可以是 Shared 文件夹）中创建它。

# java - Java RMI 和 NoClassDefFoundError

> ID：11277760
> 
> 赞同：0
> 
> 时间：2012-06-30T21:19:58.670
> 
> 标签：java, classpath, rmi

**更新**：[这](http://www2.hawaii.edu/~bjpeter/RMI.zip "这里")是项目。

我有以下目录结构：

```
RMI
  |
  api.jar
        |--> org.examples.rmi.api.Pi
        |--> org.examples.rmi.api.Task
        |--> org.examples.rmi.api.Compute
  client.jar
        |--> org.examples.rmi.client.ComputePi
  server.jar
        |--> org.examples.rmi.server.ComputeEngine
        |--> org.examples.rmi.api.Pi
        |--> org.examples.rmi.api.Task
        |--> org.examples.rmi.api.Compute 
```

我输入了以下命令来启动我的服务器：

```
C:\Users\Public\RMI\server>set CLASSPATH=
C:\Users\Public\RMI\server>start rmiregistry
C:\Users\Public\RMI\server>java -Djava.rmi.server.codebase="file:/C:/Users/Public/RMI/compute.jar" -Djava.rmi.server.hostname=127.0.0.1 -Djava.security.policy=server.policy org.examples.rmi.engine.ComputeEngine 
```

然后我输入了这个命令来启动我的客户端：

```
C:\Users\Public\RMI>java -cp api.jar -jar -Djava.rmi.server.codebase="file:/C:/Users/Public/RMI/api.jar" -Djava.security.policy=client.policy client.jar 127.0.0.1 45 
```

但我收到以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/examples/rmi/api/Task
        at java.lang.Class.getDeclaredMethods0(Native Method)
        at java.lang.Class.privateGetDeclaredMethods(Unknown Source)
        at java.lang.Class.getMethod0(Unknown Source)
        at java.lang.Class.getMethod(Unknown Source)
        at sun.launcher.LauncherHelper.getMainMethod(Unknown Source)
        at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source)
Caused by: java.lang.ClassNotFoundException: org.examples.rmi.api.Task
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        ... 6 more 
```

但是如果我将 api 包中的三个类添加到 client.jar 文件中，客户端就可以工作了。

如果我在 server.jar 文件中删除相同的三个类，即使我将类路径设置为 api.jar，我也会得到相同的 NoClassDefFoundError。

```
C:\Users\Public\RMI>java -cp api.jar -jar -Djava.rmi.server.hostname=127.0.0.1 -Djava.rmi.server.codebase="file:/C:/Users/Public/RMI/api.jar" -Djava.security.policy=server.policy server.jar 
```

我不想将这三个类放在多个地方的 api 包中。我只想将它们保存在一个地方，在 api.jar 文件中。我没有在命令行上正确设置类路径吗？

您的建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:26:00.873

使用 -jar 选项时会忽略 -cp 参数。您应该使用 client.jar 清单中的 Class-Path 选项将 client.jar 连接到 api.jar。

# javascript - 如何为移动体验制作响应式图像

> ID：11277762
> 
> 赞同：4
> 
> 时间：2012-06-30T21:20:11.057
> 
> 标签：javascript, jquery, html, responsive-design

更新

* * *

我有全屏背景图片。这给移动浏览带来了问题，因为图像很大并且是高分辨率的。

下一个问题是视网膜显示等问题，设计/程序员如何准备处理这个问题？我看到很多关于如何在图像之间切换的文章。但是后来我对像素密度与分辨率过度混淆了。何时何地需要它，以及如何以及为什么要针对它们。

例子：

*全屏背景图像，分辨率为 1900x1080，分辨率为 72dpi。为了获得最佳优化，每个分辨率/像素密度应该有多少张图像？此外，鉴于这种情况，哪个库/插件/语义最适合解决这种情况？

最后，如果我使用媒体查询来定位和切换背景图像，它会下载所有图像吗？还是仅在满足要求时？

```
@media (min-device-width : 768px) 
and (max-device-width : 1024px) {
background-image:url('paper1024.png');
}

@media only screen 
and (min-width : 1824px) {
background-image:url('paper1900.png');
 } 
```

感谢堆栈

* * *

*//旧问题没有出于评论目的删除它//*

所以我正在制作一个全屏图像的响应式网站。我遇到的问题是原始图像对于移动设备下载来说太大了。

作为响应式设计的新手，我不知道这是一个问题，并自行发现了它。我读了几篇文章

最好的是：
[http ://www.alistapart.com/articles/responsive-images-and-web-standards-at-the-turning-point/](http://www.alistapart.com/articles/responsive-images-and-web-standards-at-the-turning-point/)

我的问题是：我不相信`<picture>`标签对公众开放？我找不到更多关于此的信息。

有谁知道这是否允许？此外，有关如何正确使用它的更多信息/文档。

如果`picture`不适用。是否有任何“*标准*”论断可以使图像响应而不会使移动带宽膨胀？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:15:37.917

这是我在上一个项目中进行视网膜化的方式：

首先使用 background-image 在普通 css 中设置桌面图像：

```
#bg {
  background: image-url('wallpaper_desktop.jpg') center top;
  background-size: 1024px 768px;
} 
```

然后，我给手机地址，例如 iphone：

```
@media only screen and (min-device-width: 320px) and (max-device-width: 480px){
  #bg {
    background: image-url('wallpaper_mobile.jpg') center top;
    background-size: 320px 480px;
  }
} 
```

然后是视网膜图像处理。使用大小翻倍的图像（请参阅文件名中的“@2x”）：

```
@media only screen and (-webkit-min-device-pixel-ratio: 2) {
  #bg {
    background: image-url('wallpaper_mobile@2x.jpg') center top;
    background-size: 320px 480px; // Original size
  }
} 
```

由于还有配备 Retina 显示屏的 iPad 和 MacBook，我们应该考虑为它们提供比高分辨率手机更大的高分辨率版本：

```
@media only screen and (max-device-width: 2048px) and (-webkit-min-device-pixel-ratio: 2) {
  background: image-url('wallpaper_desktop@2x.jpg') center top;
  background-size: 1024px 768px;
} 
```

所以，通常我每张图片使用 4 个版本。2 个桌面版本（一个用于视网膜显示器的尺寸加倍）和 2 个移动版本（还有一个用于视网膜显示器的尺寸加倍）

顺便说一句：在对附加图像使用媒体查询时，没有附加请求。

# validation - 验证错误：使用自定义转换器时值无效

> ID：11277765
> 
> 赞同：1
> 
> 时间：2012-06-30T21:20:29.600
> 
> 标签：validation, jsf-2, converter

NetBeans 7.1.1 JSF2.1

在 h:selectManyCheckBox 中使用 converter="convK" 属性时，一切正常。但我尝试使用 @FacesConverter(forClass=className.class) 表单，它不断给我“验证无效”错误。我尝试将其更改为 forClass=packageName.className.class 但没有帮助。

这是转换器：

```
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.FacesConverter;
 @FacesConverter( "convK")
  public class KorisnikConverter implements Converter{
@Override
public Object getAsObject(FacesContext context, UIComponent component, String value) {
     if (value==null) return value;
     if (value.isEmpty()) return value;
        for (int i=0; i<Arhiva.getSviKor().size(); i++) {
            if (Arhiva.getSviKor().get(i).getUsername().equals(value)) {
                return Arhiva.getSviKor().get(i);
            }
        }
     return value;
}
@Override
public String getAsString(FacesContext context, UIComponent component, Object value) {
    if (value==null) return "";
    if (value instanceof Korisnik) return ((Korisnik)value).getUsername();
    return "";
}   
} 
```

我有一个名为 Korisnik 的类，它有几个文本字段，用户名是唯一的。在我的主要管理 bean 中，我有几个这些对象的 arrayList。目标是使用 selectManyCheckBox 仅选择一些用户并将它们放在单独的数组列表中以供其他用途。我想推动整个对象（我总是可以轻松地使用字符串并在我的控制器 bean 中创建和管理对象，但想尝试自定义转换器来让 selectItems 与对象一起工作）

在我的课堂上，我已经覆盖了 equals 和 hashCode（因为有很多关于自定义转换器给出等等等等验证不是有效错误的讨论）。

```
@Override
public boolean equals (Object obj) {
    if (obj==null) return false;
    if (!(obj instanceof Korisnik)) return false;
    Korisnik k = (Korisnik)obj;
    return (this.username==k.username);
}

@Override
public int hashCode() {
    return this.username.hashCode();
} 
```

编辑。当我将它用作命名转换器并仅在具有 selectManyCheckbox 的一个实例中使用所述转换器时，即使没有覆盖 equals 和 hashCode，它也可以正常工作。

这是复选框代码

```
 <h:selectManyCheckbox value="#{kontrolg.izabrAut}" layout="pageDirection" converter="convK" >
              <f:selectItems value="#{kontrolg.moguciAut}" var="it" itemLabel="#    {it.ime}&#160;#{it.prezime}" itemValue="#{it}"/>
      </h:selectManyCheckbox> 
```

我不知道是我没有在转换器注释中正确使用 forClass="whatever" 还是我的转换器实际上可以与那个 selectManyCheckbox 一起工作，但是当我以 forClass 形式指定它时，它会被用于所有实例对象并导致在添加自定义转换器之前运行良好的其他代码现在给出“验证无效”错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:13:15.853

当所选项目上的方法**未**针对*任何*可用项目返回`value is not valid`时，将引发验证错误。`equals()`**`true`**

 ***事实上，你的`equals()`方法被打破了。以下行是错误的：

```
return (this.username==k.username); 
```

我假设那`username`是一个[`String`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)，这是一个[`Object`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html)。通过**引用**`==`比较`Object`s ，而不是按它们的**值**。换句话说，当在两个s 上执行时，您基本上是在测试它们是否指向完全相同的实例。您没有检查它们是否代表相同的值（例如，实例的内部表示）。您应该改用's方法，该方法，这是从它的 javadoc 中摘录的相关内容：****`==``Object``Object``Object``equals()`[`String#equals()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#equals%28java.lang.Object%29)****

 ****> ### 等于
> 
> `public boolean equals(Object anObject)`
> 
> 将此字符串与指定对象进行比较。结果是`true`当且仅当参数不是`null`并且是`String`表示与该对象相同的字符序列的对象。

`==`仅在比较, `boolean`,`int`等原语`long`或测试`null`.

因此，要解决您的问题，请将错误的行替换为以下行：

```
return username.equals(k.username); 
```

或者，当它们可能是`null`：

```
return (username == null) ? (k.username == null) : username.equals(k.username); 
```

### 也可以看看：

*   [执行equals contract的正确方法](https://stackoverflow.com/questions/3181339/right-way-to-implement-equals-contract)*******

# javascript - 使用 JavaScript 访问 iframe 和 body 标签内的元素

> ID：11277766
> 
> 赞同：4
> 
> 时间：2012-06-30T21:20:32.493
> 
> 标签：javascript, html, dom, iframe, cross-browser

我正在编写一个 GreaseMonkey 脚本，它修改具有特定 ID 的元素的属性，但由于非传统的 HTML 层次结构，我在访问它时遇到了一些问题。这是相关的HTML：

```
<body>
...
    <iframe id="iframeID">
        <html>
        ...
            <body id="bodyID" attribute="value">
            ...
            </body>
        ...
        </html>
    </iframe>
...
</body> 
```

`attribute`我试图修改的属性在哪里。

起初，没有意识到我正在使用一个`iframe`和一个嵌套`body`标签，我尝试了这个：

```
document.getElementById('bodyID').setAttribute("attribute","value") 
```

虽然这在 Firefox 中运行良好，但 Chrome 告诉我我无法设置 的属性`null`，这表明它找不到任何具有 id 的元素`bodyID`。如何以跨浏览器友好的方式修改此属性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-30T21:22:25.860

您首先需要拉取文件`<iframe>`：

```
document.getElementById('iframeID').contentDocument
.getElementById('bodyID').setAttribute("attribute","value"); 
```

[**现场演示**](http://jsfiddle.net/QfDyq/)

顺便说一句，如果你想获得`<body>`节点，你不需要提供 id 或类似的东西，只需：

```
document.body 
```

在您的情况下，它是以下文件`<iframe>`：

```
document.getElementById('iframeID').contentDocument.body.setAttribute("attribute","value"); 
```

简单多了……不是吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:41:12.430

IMO 最好的方法是监听`load`iFrame 触发的事件，然后根据需要查看 iFrame DOM。这可以保证您在需要时可以使用 iFrame DOM 并花点时间拍摄。

```
$('#iframeID').on('load', function ()
{
  alert('loaded'); // iFrame successfully loaded
  var iFrameDoc = $('#iframeID')[0].contentDocument; // Get the iFrame document
  $('body', iFrameDoc).attr('attribute', 'new value'); // Get the 'body' in the iFrame document and set 'attribute' to 'new value'
}); 
```

# macos - nsdocument 子类变量在正确初始化后以某种方式重置为零：为什么？

> ID：11277773
> 
> 赞同：1
> 
> 时间：2012-06-30T21:22:00.703
> 
> 标签：macos, cocoa, nsdocument, nswindowcontroller

我有一个消失的指针*db*；该值在创建期间已正确设置，`NSDocument`但在我想打开一个子窗口时，该值已更改为`nil`！我在`NSDocument`子类中有以下内容：

```
 @interface MW_Document : NSDocument
 {
     MW_WorkerWindowController *workerController;
     __strong MW_db *db;
 }

 - (IBAction)showWorkerManagementPanel:(id)sender;
 //- (IBAction)showSkillManagementPanel:(id)sender; 
```

该实现包含以下内容：

```
 - (void)windowControllerDidLoadNib:(NSWindowController *)aController
 {
     [super windowControllerDidLoadNib:aController];
     if (![self db]) {
         db = [[MW_db alloc] init];
         NSLog ( @"Debug - Init of db: [%ld]", db ); // never mind the casting problem
     }
 } 
```

*db*指向的不是 nil，而是一个真实的地址。

稍后，我想打开一个窗口并在同一`NSDocument`个子类的实现中使用它：

```
 - (IBAction)showWorkerManagementWindow:(id)sender
 {
     if ( !workerController) {
         workerController = [[MW_WorkerWindowController alloc] initWithDb:db];
     }
     [workerController showWindow:self];
 } 
```

我在第一行放了一个断点，然后查看*db*的值。它是零，但我**不**知道为什么。谁能给我解释一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:42:07.967

您可以实现一个惰性访问器：

```
- (MW_db *)db
{
    if (db == nil) {
        db = [[MW_db alloc] init];
    }
    return db;
} 
```

然后用它代替 ivar：

```
workerController = [[MW_WorkerWindowController alloc] initWithDb:[self db]]; 
```

# solr - SOLR 中的文件夹

> ID：11277776
> 
> 赞同：0
> 
> 时间：2012-06-30T21:22:02.723
> 
> 标签：solr

我有一个超过数百万个全文文档的 SOLR 索引。这很好用。到现在为止还挺好。

用户可以在文件夹或集合中组织这些文档。我希望能够将搜索限制在某个文件夹（或多个文件夹），而不必为每个文件夹创建索引。不同的用途可以将文档存储在不同的文件夹中，它更像是一个标签而不是一个位置。

我计划通过为存储文档的文件夹（或集合）ID 添加一个多值字段来做到这一点。

这是使用 SOLR 的“有效”方式还是我遗漏了什么？另外，我会遇到关于多值字段中项目数量的限制吗？任何直接支持集合的替代搜索引擎也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T14:29:03.490

目前尚不清楚该信息是否针对每个用户。如果您需要每个用户的文件夹信息（也就是说，如果用户 A 将文档 D 设置在文件夹 F 中，用户 B 在文件夹 F 中查找文档将找不到它），那么您需要存储一些与用户相关的信息也。

我建议使用一些名为 user_A、user_B 等的动态字段，然后在适当的用户字段中设置文件夹信息。

编辑：好的，那么马克的回复是好的。只要记住在 fq 中使用“集合”，它就会被缓存并在其他查询中重用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T12:13:08.693

给定文档所属目录的绝对路径有一个多值**字符串字段。**例如，一个文档可能属于`documents/reports/fin/2012`和`johns_stuff/to_read`。

一些查询：

```
documents/reports/fin/2012 <-- belongs to a specific directory
documents/reports/fin* <--any subdirectory of this directory 
```

# macos - 我需要计算我的 perl 执行时间。但是 MacOs X Terminal 不生成输出

> ID：11277777
> 
> 赞同：1
> 
> 时间：2012-06-30T21:22:16.840
> 
> 标签：macos, for-loop, terminal, echo, x11

但是，该程序不识别**for**指令并且只生成一个输出，对应于第一个程序。既不是**回声**指令。问题是什么？我正在使用**MacOS X 10.6.8**并尝试在终端和 X11 上执行，这不是 chmod 问题...

```
#The code for count perl execution time, for each archive in Prueba Folder. 

#!/bin/bash

FILES= ~/Desktop/ncRNA/Prueba/*

for f in $FILES
do
START =$(date +%s)
echo "Processing $f file..."
perl $f
END =$(date +%s)
DIFF=$(( $END - $START ))
echo "It took $DIFF seconds"
date
echo "It was completed"

done

exit 
```

# 输出：

```
¿Cual fue el tiempo de caida libre?
42
Si el tiempo de caida libre fue de : 42 segundos, entonces
La velocidad en caida libre fue de 412.02 m/s^2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T03:43:14.043

问题是等号前后都有**空格字符。****设置变量**时，省略等号前后的任何空格。

还要在可能包含空格或保留字符的变量周围加上双引号。-->`"$f"`而不是`$f`

```
#!/bin/bash
FILES=~/Desktop/dossiereee/*
for f in $FILES
do
    START=$(date +%s)
    echo "Processing $f file..."
    perl "$f"
    END=$(date +%s)
    DIFF=$(( $END - $START ))
    echo "It took $DIFF seconds"
    echo "It was completed"
done 
```

# node.js - PassportJS deserializeUser 从未调用过

> ID：11277779
> 
> 赞同：43
> 
> 时间：2012-06-30T21:22:21.333
> 
> 标签：node.js, session, passport.js

我已经设置了 Passport 来验证存储在 mongodb 中的用户。似乎工作正常：身份验证成功/失败并设置会话变量。但是，让 Passport 检查会话失败。我添加到`deserializeUser`回调中的 console.log 语句从未出现过，这似乎是非常错误的。我认为我的问题与`deserializeUser`从未被调用有关。谁能诊断出我的失误？

```
// Passport configuration
passport.serializeUser(function(user, cb){ cb(null, user.id) });
passport.deserializeUser(function(uid, cb){
  console.log("Trying to deserialize user: "+uid);
  User.findById(uid, function(err, user){
    cb(err, user);
  });
});
// auth strategy function
passport.use(new LocalStrategy({usernameField: 'email'},
  function(email, pass, done){
    User.findOne({email: email}, function (err, user) {
      if (err)
        return done(err);
      if (!user)
        return done(null, false, {message: "Couldn't find user"});
      var crypted = bcrypt.hashSync(pass, user.salt);
      if(user.hashpass != crypted)
        return done(null, false, {message: "Bad password"});
      return done(null, user);
    });
  }
));

passport.CreateSession =  function (req, res, next) {
  passport.authenticate('local', function(err, user, info){
    if(err || !user)
      return res.json({status: "Failure: "+err});
    req.logIn(user, function (err){
      if(err)
        return res.json({status: "Failure: "+err});
      return res.json({status: "Authenticated"});
    });
  })(req, res, next);
}; 
```

在 app.js 中使用以下内容：

```
app.post('/session', passport.CreateSession); // restify better
app.del('/session', passport.DestroySession);
app.get('/images', passport.CheckSession, routes.images); 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-04-16T20:20:57.687

对于遇到此问题的其他任何人，请查看以下内容：

```
app.use(session({ 
    secret: 'something', 
    cookie: { 
        secure: true
    }})); 
```

如果您已`cookie.secure`设置为 true 并且您没有使用 SSL（即 https 协议），则带有会话 ID 的 cookie 不会返回到浏览器，并且一切都会以静默方式失败。删除这个标志为我解决了这个问题——我花了几个小时才意识到这一点！

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-02-14T05:06:42.130

如果您在使用`authenticate`护照进行身份验证时使用回调，则需要手动登录用户。它不会为你调用。

```
passport.authenticate('local', function (err, user) {
    req.logIn(user, function (err) { // <-- Log user in
       return res.redirect('/'); 
    });
})(req, res); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-30T21:29:02.797

你有没有`use()`中间件`passport.session()`？就像在这个例子中一样：

[https://github.com/jaredhanson/passport-local/blob/v1.0.0/examples/login/app.js#L91](https://github.com/jaredhanson/passport-local/blob/v1.0.0/examples/login/app.js#L91)

这就是恢复会话和调用的原因`deserializeUser`，所以听起来可能会丢失。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-11-08T03:10:55.807

好的，这花了我将近 3 天的时间来解决，这似乎是一个简单的修复，至少在我的情况下。我不得不放置：

```
app.use(require('cookie-parser')); 
```

和

```
app.use(require('express-session')({
    secret: 'keyboard cat',
    resave: false,
    saveUninitialized: false
})); 
```

致电前：

```
app.use(passport.initialize());
app.use(passport.session()); 
```

**注意：**这些片段不是我的实际代码，我是从[GitHub](https://github.com/passport/express-4.x-local-example/blob/master/server.js)获取的，但这就是它的要点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-05-27T12:43:47.030

就我而言，这是因为我有以下代码：

```
app.get("/auth/google/callback", 
    passport.authenticate("google", { 
        failureRedirect: "/admin/login/?error",
    }),
    (req, res) => {
        return res.redirect("/admin/");
    },
); 
```

显然在这种情况下 req.login() 不会被调用（调用反序列化）。我把它改成了这个，它起作用了：

```
app.get("/auth/google/callback", 
    passport.authenticate("google", { 
        successRedirect: "/admin/", 
        failureRedirect: "/admin/login/?error",
    })
); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-15T08:06:06.270

我整天都在解决同样的问题。我设置了一个自定义回调来进行授权（例如在[http://passportjs.org/guide/authenticate/的底部](http://passportjs.org/guide/authenticate/)）。看起来 Passport 在所有请求对象到达其他中间件之前就对其进行了预处理（基于我编写的一些日志记录语句）。作为该预处理的一部分，它将反序列化的用户信息放入 request.user 对象中。不幸的是，passport.authenticate ('local', callback) 的默认行为似乎是忽略任何会话或 cookie 数据，而是假设用户名和密码是在请求对象中发送的。我解决这个问题的方法是首先检查 request.user 对象，如果它存在，则意味着 Passport 已经完成了它的预处理，然后我可以直接调用 login。这是我的授权函数，我用它代替了 passport.authenticate('local')：

```
function doAuth(request, response, next)
{ 

if (request.user) {
    request.logIn(request.user, function (err) {
        if (err) {
            console.log(err);
            response.status(500).json({message:
                    "Login failed. Auth worked. Nonsense"});
            return;
        }
        console.log("doAuth: Everything worked.");
        next();
    });
    return;
}

passport.authenticate('local', function(err, user, info) {
    if (err) {
        response.status(500).json({message: "Boo Passport!"});
        return; //go no further
        //until I figure out what errors can get thrown
    }
    if (user === false) {
        console.log("Authentication failed. Here is my error:");
        console.log(err);
        console.log("Here is my info:");
        console.log(info);
        response.status(500).json({message: "Authentication failed."});
        return;
    }
    request.logIn(user, function(err) {
        if (err) {
        console.log("Login failed. This is the error message:");
        console.log(err);
        response.status(500).json({message:"Login failed."});
            return;
        }
        console.log("doAuth: Everything worked. I don't believe it.");

        next();
    });
})(request, response, next);

 } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-11-27T23:00:24.677

今天我遇到了同样的问题，就我而言，原因是客户端如何进行 API 调用。以下方法帮助我克服了这个问题：

```
const doFetch(url, method = 'GET', body) {
  const headers = new Headers();
  headers.append('Content-Type', 'application/json');
  headers.append('Accept', 'application/json');
  headers.append('Cache', 'no-cache');
  const params = { 
    method, headers, 
    credentials: 'include' // The cookie must be sent!
  }
  if(body) {
    params.body = body;
  }
  return fetch(url, params);
} 
```

在此之后，`deserializeUser`开始被正确调用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-22T04:10:05.890

在**Heroku**中，所有请求都以纯 http 形式进入应用程序，但带有 X-Forwarded-Proto 标头以了解原始请求是 http 还是 https。

这会导致 express 看到非 ssl 流量，因此它在 Heroku 上运行时拒绝设置安全 cookie。您必须通过设置“信任代理”告诉 express 信任该标头中的信息。

```
app.set('trust proxy', 1); 
```

就在之前

```
app.use(session... 
```

如果您在 Heroku 上遇到此问题，可能对您有用。如果您的 cookie/会话搞砸了，那么这可能就是不调用反序列化的原因。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-28T13:27:25.730

我用网络安全打开谷歌浏览器或打开隐身模式，它对我有用

```
web-security for linux /usr/bin/google-chrome-stable
--disable-web-security --user-data-dir=/home/jossnaz/.config/google-chrome/ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-13T09:17:49.540

就我而言，我已经放置

```
app.use(cookieSession({
  maxAge : 60*60*1000,
  keys : [key.cookieSession.key1]
})); 
```

以上

```
app.use(passport.initialize());
app.use(passport.session()); 
```

它奏效了。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-06-16T13:07:46.683

确保代码行`app.use(express.static(path.join(__dirname, 'public')));`低于`app.use(require('express-session')`

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2013-12-02T10:04:25.837

```
passport.serializeUser(
    function(user, done){
        done(null, user.id);
});

passport.deserializeUser(
    function(id, done){
        User.findById(id, function(err, user){
            if(err){
                done(err);
            }
            done(null, user);
        });
});

**> try this one** 
```

# python - Python GIL 和多线程

> ID：11277784
> 
> 赞同：4
> 
> 时间：2012-06-30T21:22:53.450
> 
> 标签：python, gil

我想将我的单线程应用程序与工作线程数分开。只有 1 个问题 - 这个动作的表现如何？如果 GIL 阻止 python 同时执行超过 1 个线程，我会有任何利润吗？

另一点（从 c/c++ 的角度来看） - 据我所知，每个线程无论如何只能以独占方式执行，所以在低于 python 解释器的级别中，我有同样的限制。

摘要：python线程在部分任务切换中的效率会低于“本机”线程吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:28:50.657

不用担心 GIL。根据您的程序所做的事情的种类（计算与 I/O），您将具有不同的性能特征。如果您的程序是 I/O 绑定的，那么您可能根本不会注意到 GIL。

另一种方法是使用[多处理](http://docs.python.org/library/multiprocessing.html)模块，其中每个进程在其自己的 OS 进程中运行，并具有自己的 Python 运行时。通过这种方法，您可以充分利用多核，而且通常更安全，因为您不必担心同步访问共享内存。

# wordpress - 来自 Network.HTTP.simpleHTTP 的 ErrorClosed 异常 - 尝试使用 haxr 通过 XML-RPC 上传图像

> ID：11277788
> 
> 赞同：7
> 
> 时间：2012-06-30T21:23:45.407
> 
> 标签：wordpress, http, haskell, upload, xml-rpc

我正在尝试使用[haxr](http://hackage.haskell.org/package/haxr) 3000.8.5 使用 metaWeblog API 将图像上传到[WordPress](http://wordpress.com)博客——特别是[newMediaObject](http://codex.wordpress.org/XML-RPC_MetaWeblog_API#metaWeblog.newMediaObject)方法。

我已经让它适用于*小*图像，成功上传了 PNG 和 JPG 格式的 20x20 图标。但是，当我尝试中等大小的图像（例如，300x300）时，我得到了一个`ErrorClosed`异常，大概来自[HTTP](http://hackage.haskell.org/package/HTTP-4000.2.3)包（我做了一些源代码潜水，发现 haxr 最终调用了[`Network.HTTP.simpleHTTP`](http://hackage.haskell.org/packages/archive/HTTP/4000.2.3/doc/html/Network-HTTP.html#v%3asimpleHTTP)）。

任何人都可以阐明呼叫`simpleHTTP`可能失败的原因`ErrorClosed`吗？也欢迎提出尝试和潜在解决方法的建议。

以下是成功上传和[不成功上传](http://hpaste.org/70685)[的完整 tcpdump 输出](http://hpaste.org/70684)的链接。

（已清理的）代码也显示在下面，以防万一。

```
import           Network.XmlRpc.Client      (remote)
import           Network.XmlRpc.Internals   (Value(..), toValue)
import           Data.Char                  (toLower)
import           System.FilePath            (takeFileName, takeExtension)
import qualified Data.ByteString.Char8 as B
import           Data.Functor               ((<$>))

uploadMediaObject :: FilePath -> IO Value
uploadMediaObject file = do
  media <- mkMediaObject file
  remote "http://someblog.wordpress.com/xmlrpc.php" "metaWeblog.newMediaObject"
    "default" "username" "password" media

-- Create the required struct representing the image.
mkMediaObject :: FilePath -> IO Value
mkMediaObject filePath = do
  bits <- B.unpack <$> B.readFile filePath
  return $ ValueStruct
    [ ("name", toValue fileName)
    , ("type", toValue fileType)
    , ("bits", ValueBase64 bits)
    ]
  where
    fileName = takeFileName filePath
    fileType = case (map toLower . drop 1 . takeExtension) fileName of
                 "png"  -> "image/png"
                 "jpg"  -> "image/jpeg"
                 "jpeg" -> "image/jpeg"
                 "gif"  -> "image/gif"

main = do
  v <- uploadMediaObject "images/puppy.png"
  print v 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T21:23:24.040

```
21:59:56.813021 IP 192.168.1.148.39571 > ..http: Flags [.]
22:00:01.922598 IP ..http > 192.168.1.148.39571: Flags [F.] 
```

由于客户端没有发送任何数据，服务器在 3-4 秒超时后关闭连接，以防止慢速和类似的 ddos​​ 攻击。（F为FIN标志，关闭一个方向的双向连接）。

服务器不等待客户端关闭连接（等待 eof/0 == recv(fd)），而是使用 close() 系统调用；如果服务器上的内核接收到更多数据，它将以 [R]eset 数据包进行响应，正如您在转储末尾看到的那样。

我猜客户端首先打开http连接，然后准备需要太长时间的数据。

# ruby - 如何将 google-api-ruby-client 与 Google Calendar API 一起使用？

> ID：11277789
> 
> 赞同：2
> 
> 时间：2012-06-30T21:23:51.377
> 
> 标签：ruby, google-calendar-api

我一直在阅读 Google Calendar API 和 google-api-ruby-client 库的文档，但我在理解它们时遇到了很多麻烦。

我有一个 Rails 应用程序，它的前端允许用户创建称为事件的对象，并将它们保存在我服务器上的数据库中。我想要的是，在将这些事件保存在数据库中之后，我想调用 Google 日历 API 在 Google 日历上创建一个事件（服务器创建的，只有服务器有权修改该日历）。

我在弄清楚如何使用 ruby​​ 库对 API 进行身份验证时遇到了很多问题。使用 OAuth2 对我来说没有意义，因为我不需要向用户授权任何东西，因为我对他们的数据不感兴趣。我查看了服务帐户（http://code.google.com/p/google-api-ruby-client/wiki/ServiceAccounts），但服务帐户似乎不支持 Google 日历。

有人有想法么？这是我正在试验的代码（使用服务帐户）：

```
@client = Google::APIClient.new(:key => 'my_api_key')
path_to_key_file = '/somepath/aaaaaa-privatekey.p12'
passphrase = 'my_pass_phrase'
key = Google::APIClient::PKCS12.load_key(path_to_key_file, passphrase)
asserter = Google::APIClient::JWTAsserter.new(
        'blah_blah@developer.gserviceaccount.com',
        'https://www.googleapis.com/auth/calendar',
        key)
# To request an access token, call authorize:
@client.authorization = asserter.authorize()

calendar = @client.discovered_api('calendar', 'v3')

event = {
  'summary' => 'Appointment',
  'location' => 'Somewhere',
  'start' => {
      'dateTime' => '2012-06-03T10:00:00.000-07:00'
   },
   'end' => {
      'dateTime' => '2012-06-03T10:25:00.000-07:00'
    },
    'attendees' => [
        {
          'email' => 'attendeeEmail'
        },
        #...
      ]
   }

result = @client.execute!(:api_method => calendar.events.insert,
                            :parameters => {'calendarId' => 'primary'},
                            :body => JSON.dump(event),
                            :headers => {'Content-Type' => 'application/json'}) 
```

然后我当然会收到此错误消息：Google::APIClient::ClientError（用户必须注册 Google 日历。）因为服务帐户不支持 Google 日历。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T01:41:43.170

我认为您仍然需要一个真正的谷歌用户来托管日历实例。但是，一旦您在自己的身份下创建了日历，就可以与服务帐户共享它。在日历的共享设置中，只需使用服务帐户的电子邮件地址（我的服务帐户以@developer.gserviceaccount.com 结尾）。通过正确的共享权限，您的服务帐户可以创建/更改活动信息，而不会混淆您的特定身份。从那里，您可以与更多人（或公众）共享日历，以供他们使用镜像事件。

我遇到的另一个问题是，您似乎只能在每个到期期间授权（）服务帐户一次。您必须保存获得的令牌并在接下来的一个小时内重复使用它，然后再获取一个新令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:00:28.170

我对鲁比一无所知。但似乎理解底层 REST 查询将有助于调试您的问题。我在这里记录了它们： [http ://www.tqis.com/eloquency/googlecalendar.htm](http://www.tqis.com/eloquency/googlecalendar.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-20T13:47:38.513

我也遇到了这个问题，终于搞定了。底线是 Google Calendar API v3 需要 OAuth，您需要通过 Google Developer Console 设置应用程序/项目，然后请求目标 Google 帐户的 OAuth 权限。授予授权后，您需要保存刷新令牌并在后续调用中使用它来获取新的访问令牌（过期！）。我在这里写了一篇详细的博客文章：http: [//www.geekytidbits.com/google-calendar-api-from-ruby/](http://www.geekytidbits.com/google-calendar-api-from-ruby/)这是我的示例脚本，希望能帮助您理解流程：

```
#gem install 'google-api-client'

require 'google/api_client'

#Setup auth client
client_secrets = Google::APIClient::ClientSecrets.load #client_secrets.json must be present in current directory!
auth_client = client_secrets.to_authorization
auth_client.update!(
  :scope => 'https://www.googleapis.com/auth/calendar',
  :access_type => "offline", #will make refresh_token available
  :approval_prompt =>'force',
  :redirect_uri => 'http://www.myauthorizedredirecturl.com'
)

refresh_token_available = File.exist?('refresh_token.txt')

if !refresh_token_available
 #OAuth URL - this is the url that will prompt a Google Account owner to give access to this app.
 puts "Navigate browser to: '#{auth_client.authorization_uri.to_s}' and copy/paste auth code after redirect."

 #Once the authorization_uri (above) is followed and authorization is given, a redirect will be made 
 #to http://www.myauthorizedredirecturl.com (defined above) and include the auth code in the request url.
 print "Auth code: "
 auth_client.code = gets
else 
 #If authorization has already been given and refresh token saved previously, simply set the refresh code here.
 auth_client.refresh_token = File.read('refresh_token.txt')
end

#Now, get our access token which is what we will need to work with the API.
auth_client.fetch_access_token!

if !refresh_token_available
    #Save refresh_token for next time
    #Note: auth_client.refresh_token is only available the first time after OAuth permission is granted.  
    #If you need it again, the Google Account owner would have deauthorize your app and you would have to request access again.
    #Therefore, it is important that the refresh token is saved after authenticating the first time!
    File.open('refresh_token.txt', 'w') { |file| file.write(auth_client.refresh_token) }
    refresh_token_available = true
end

api_client = Google::APIClient.new
cal = api_client.discovered_api('calendar', 'v3')

#Get Event List
puts "Getting list of events..."
list = api_client.execute(:api_method => cal.events.list, 
    :authorization => auth_client,
    :parameters => {
        'maxResults' => 20, 
        'timeMin' => '2014-06-18T03:12:24-00:00', 
        'q' => 'Meeting', 
        'calendarId' => 'primary'})

puts "Fetched #{list.data.items.count} events..."

#Update Event
puts "Updating first event from list..."
update_event = list.data.items[0]
update_event.description = "Updated Description here"
result = api_client.execute(:api_method => cal.events.update, 
    :authorization => auth_client,
    :parameters => { 'calendarId' => 'primary', 'eventId' => update_event.id}, 
    :headers => {'Content-Type' => 'application/json'},
    :body_object => update_event)
puts "Done with update."

#Add New Event
puts "Inserting new event..."
new_event = cal.events.insert.request_schema.new
new_event.start = { 'date' => '2015-01-01' } #All day event
new_event.end = { 'date' => '2015-01-01' } 
new_event.description = "Description here"
new_event.summary = "Summary here"
result = api_client.execute(:api_method => cal.events.insert, 
    :authorization => auth_client,
    :parameters => { 'calendarId' => 'primary'}, 
    :headers => {'Content-Type' => 'application/json'},
    :body_object => new_event)
puts "Done with insert." 
```

# c - 为什么程序不执行最终的 printf 语句？

> ID：11277796
> 
> 赞同：0
> 
> 时间：2012-06-30T21:26:07.323
> 
> 标签：c, for-loop, terminal, while-loop, printf

我无法弄清楚为什么程序控制在 for 循环之后没有到达第三个 printf。

`printf`为什么不打印第三张？

如果我将 for 循环更改为 while 循环，它仍然不会打印。

这是程序和输出：

```
main()
{
    double nc;

    printf ("Why does this work, nc = %f\n", nc);
    for (nc = 0; getchar() != EOF; ++nc)
    {
        printf ("%.0f\n", nc);
    }
    printf ("Why does this work, nc = %f", nc);
} 
```

输出是：

```
Why does this work, nc = 0.000000
test
0
1
2
3
4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:29:10.570

它对我来说很好，你是如何试图终止程序的？`for`-loop 应该在被`EOF`检测为输入时结束`getchar()`。

`EOF`在 Windows 下是`Control-Z`( )，在 Linux/Unix 下是( )。一旦我输入这个，循环就会终止，我会得到最终的结果来显示它的输出。`^Z``Control-D``^D``printf()`

作为最后一点（@DanielFisher 也提到过），`'\n'`在最后一次调用的末尾添加一个，`printf()`因为您的特定实现可能需要它，否则程序的行为可能是未定义的（感谢@KeithThompson 和@AndreyT 指出这一点在评论中）：

```
 printf ("Why does this work, nc = %f\n", nc); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:59:07.230

[`printf`](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.12.html)被缓冲，这就是为什么最后一行*可能*不显示的原因。这意味着调用`printf`可能不会导致直接输出，因为函数会在将数据放入输出（您的终端）之前累积数据。

在你最后一次 printf 之后调用[`fflush`](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.12.html#fflush)将把所有剩余的东西放在终端的缓冲区中。此外，每次您要求换行时都会刷新缓冲区。

# xampp - 如何在 XAMPP for Windows 中更改 IP 地址？

> ID：11277798
> 
> 赞同：10
> 
> 时间：2012-06-30T21:26:15.023
> 
> 标签：xampp

我一直在尝试弄清楚如何更改 XAMPP 的服务器配置，以便在 Windows 和服务器同时尝试访问时不会出现内存故障`localhost`。基本上我希望 XAMPP 是 127.0.1.1 或类似的 IP，这样它就不会干扰`localhost`系统使用，所以我可以浏览我正在开发的网络和网站。发生的情况是，如果我同时运行 XAMPP 和 Eversoft 的第一页 2000 v2.0，我会在编辑我的网站时遇到 BSOD（蓝屏死机）。这是一个间歇性问题，但总是在这两个程序中发生。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-02T22:41:42.750

只需编辑`c:\xampp\apache\conf\httpd.conf`并更改`Listen 80`to`Listen 127.0.0.2:80`或您想要的任何 IP 地址。确保`:`将 IP 地址和端口号放在中间，在本例中为端口 80。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-06-11T09:48:04.110

这些是您希望将 PHP 应用程序安装在 LAN 服务器（而不是 Web）上时要遵循的步骤

1.  获取服务器的内部 IP 或静态 IP（例如：192.168.1.193）
2.  在记事本中打开 XAMPP>apache>conf>httpd.conf 文件
3.  搜索听 80
4.  上面的行看起来像-#Listen 0.0.0.0:80 / 12.34.56.78:80
5.  更改IP地址并替换为静态IP
6.  保存 httpd.conf 文件，确保服务器指向 #Listen 192.168.1.193:80
7.  在应用程序根 config.php（数据库连接）中，将 localhost 替换为服务器的 IP 地址

注意：如果安装了防火墙，请确保将 http 端口 80 和 8080 添加到例外并允许侦听。转到控制面板>Windows防火墙>允许程序通过Windows防火墙进行通信>添加另一个程序名称：http端口：80再添加一个作为http - 8080

如果 IIS（Microsoft .Net Application Internet Information Server）与任何 Microsoft .Net 应用程序一起安装在服务器上，那么它已经占用了 80 端口。在这种情况下，将 #Listen 192.168.1.193:80 更改为 #Listen 192.168.1.193:8080

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-14T12:13:54.613

提示：
第一部分=文件位置**---**第二部分=在文件中查找**---** 第三部分=替换为找到的文本

# 如何将 Xampp 中的“127.0.0.1”更改为“127.0.0.2”（或粘贴您喜欢的 ip 而不是 127.0.0.2）

(C:\xampp\apache\conf\httpd.conf) **---**听 80 **---**听 127.0.0.2:80
(C:\xampp\apache\conf\extra\httpd-ssl.conf) **---**听443 **---**听 127.0.0.2:443
(C:\xampp\php\php.ini) **---** ;xdebug.remote_host = "127.0.0.1" **---** ;xdebug.remote_host = "127.0.0.2"
(C :\xampp\phpMyAdmin\config.inc.php) **---** $cfg['Servers'][$i]['host'] = '127.0.0.1'; **---** $cfg['Servers'][$i]['host'] = '127.0.0.2';

# 如何将 Xampp 中的“Localhost”更改为“myhost”（或粘贴您喜欢的名称而不是 myhost）

*   xampp 控制面板管理按钮仍然打开 localhost

    (C:\xampp\apache\conf\httpd.conf) **---** ServerName localhost:80 **---** ServerName myhost:80
    (C:\xampp\php\php.ini) **-- -** ; SMTP = 本地主机**---** ; SMTP = myhost
    (C:\Windows\System32\drivers\etc\HOSTS) **---** 127.0.0.1 localhost **---** 127.0.0.2 localhost
    127.0.0.2 myhost **>>>** #(127.0.0.2 localhost 之后的下一行)

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2012-06-30T21:34:21.263

您可以在 Windows 主机文件 (Windows/system32/driver/etc) 中将 127.0.1.1 指向 127.0.0.1

# bash - 通过 ssh 传递变量

> ID：11277799
> 
> 赞同：6
> 
> 时间：2012-06-30T21:26:23.547
> 
> 标签：bash, ssh

我正在尝试编写一个脚本来登录多个远程服务器并在每个服务器中执行一个脚本。但是，我想通过 ssh 传递一个变量。像这样的东西：

```
var="/home/dir/"

  ssh -T $mchname <<'ENDSSH'    
    $var"run_script" < input > output &    
ENDSSH 
```

这种天真的尝试不起作用（$var 只是 null）。什么是正确的语法？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:34:08.597

删除周围的引号`ENDSSH`。它们防止[此处文档](http://tiswww.case.edu/php/chet/bash/bash.html#lbBO)中的变量扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-18T14:03:46.900

尝试这个：

```
var="/home/dir/"

  ssh -T $mchname VAR=$var 'bash -s'<<'ENDSSH'    
    $VAR"run_script" < input > output &    
ENDSSH 
```

# c# - 在离线单客户端应用程序中存储大量数据的好方法是什么？

> ID：11277803
> 
> 赞同：3
> 
> 时间：2012-06-30T21:26:52.240
> 
> 标签：c#, database

我编写的所有其他应用程序都是网络/Web 应用程序，我使用 SQL 数据库存储数据，这对我来说很有意义。

如果我正在创建一个不需要联网的应用程序，是否有一种标准方法可以永久存储这些数据？文本文件是可能的，但没有给我查询 SQL 服务器的好处，也不是很安全。是否有类似于 SQL 服务器的东西，我可以在启动程序时启动和保存？

也许有一些我从未遇到过的结构？

从我读过的内容来看，我可能能够像使用 SQLite 那样做上面提到的事情。这对大型分布式应用程序有意义吗？

提前感谢您对如何设计这些类型的程序的任何澄清。

编辑：为了澄清@TomTom 的意思，这并不是他建议的大量数据。如果它超过了几场数据，我会感到惊讶。我说大的意思是，与使用类似 SQL 的数据库相比，创建某种可以保存到文本文件中、加载/搜索以获取数据的数据结构似乎是不合理的。

通读答案显然 SQLite 或类似的东西对于桌面应用程序来说是合理的。我将继续研究它，并可能用它来跟踪我下一个项目的数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:29:43.960

您可以使用嵌入式数据库 - 这可以是 SQL 数据库，但并非必须如此。

对于 Windows，请查看[SQLite](http://www.sqlite.org/)、[SQL Server Compact](http://en.wikipedia.org/wiki/SQL_Server_Compact)和[RavenDB](http://ravendb.net/docs/server/deployment/embedded)（对于非 SQL 文档数据库）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T21:30:07.107

您仍然可以在本地使用 SQL 数据库。尝试[SQLite](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)。

[使用名称为Esent](http://managedesent.codeplex.com/)的 Windows 内置数据库引擎的其他选项。快速，但使用它的 Api 并不是很方便。

# submit - 尝试为 PlayBook 签名和部署的多个问题

> ID：11277809
> 
> 赞同：1
> 
> 时间：2012-06-30T21:28:03.123
> 
> 标签：submit, code-signing, blackberry-playbook

我花了几天时间尝试在 RIM Vendor Portal 上提交我的应用程序。

我可以建造它。我可以使用 debugtoken.bar 在我的设备上运行它。

当我尝试将其提交到供应商门户时，我收到可怕的**“某些文件缺少签名”**错误。

我构建了我的 application.bar 文件（实际上名为 QuoteUnquote.bar），然后使用以下命令对其进行了签名：

`"C:\Program Files (x86)\Research In Motion\BlackBerry WebWorks SDK for TabletOS 2.1.0.6\bbwp\blackberry-tablet-sdk\bin\blackberry-signer" -verbose -cskpass ******** -keystore sigtool.p12 -storepass ******** "C:\work\word\quotes\platform_airplay\build_smartquotes-airplay_vc10\deployments\default\playbook\release\QuoteUnquote.bar" RDK`

`"C:\Program Files (x86)\Research In Motion\BlackBerry WebWorks SDK for TabletOS 2.1.0.6\bbwp\blackberry-tablet-sdk\bin\blackberry-signer" -keystore sigtool.p12 -storepass ******** "C:\work\word\quotes\platform_airplay\build_smartquotes-airplay_vc10\deployments\default\playbook\release\QuoteUnquote.bar" author`

我确认已签名的 .bar 文件的 META-INF 文件夹中有所需的五个文件。

当我在没有 -verbose 选项的情况下验证它时，它只会显示“.bar 已验证”。当我使用 -verbose 选项验证它时，验证工具似乎崩溃了：

`C:\work\word\quotes\platform_airplay\PlayBook>"C:\Program Files (x86)\Research In Motion\BlackBerry WebWorks SDK for TabletOS 2.1.0.6\bbwp\blackberry-tablet-sdk\bin\blackberry-signer" -verify -keystore sigtool.p12 -verbose "C:\work\word\quotes\platform_airplay\build_smartquotes-airplay_vc10\deployments\default\playbook\release\QuoteUnquote.bar"`

```
 2240 Sat Jun 30 00:31:16 PDT 2012 META-INF/MANIFEST.MF
        1287 Sat Jun 30 00:31:16 PDT 2012 META-INF/AUTHOR.SF
         710 Sat Jun 30 00:31:16 PDT 2012 META-INF/AUTHOR.EC
        1287 Sat Jun 30 00:31:02 PDT 2012 META-INF/RDK.SF
         280 Sat Jun 30 00:31:02 PDT 2012 META-INF/RDK.EC
           0 Tue Jan 01 00:00:00 PST 1980 META-INF/
           0 Tue Jan 01 00:00:00 PST 1980 native/
barsigner error: java.lang.NullPointerException 
```

所以这不是很有帮助。我不知道 -verify 工具是否只是片状，或者 .bar 文件的某些问题是否导致它崩溃，或者什么。

这一切都非常令人沮丧，因为我过去曾成功签署并提交过 .bar 文件。我不知道我现在在做什么不同。

正如我所说，我已经坚持了好几天了。如果你能给我指点，那就太好了。如果我可以将我的 .bar 文件发送给您，您可以告诉我它有什么问题，那就更好了。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T05:12:26.217

我解决这个问题的小技巧是像往常一样签署 .bar（RDK 和作者），然后将 .bar 文件重命名为 .zip 并将所有文件解压缩到一个临时目录中。

使用 7Zip 然后我使用以下命令重新压缩所有文件：

```
7z a -tzip <AppName>.bar *.* -r 
```

这将重新压缩所有文件并删除目录名称的条目。

对其进行验证：

```
blackberry-signer -verbose -verify <AppName>.bar 
```

只要您正确签署了应用程序，您应该会看到可爱的消息：信息：已验证栏。

提交它，然后你就走了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T01:54:25.680

我已经弄清楚这里发生了什么。问题是世界上有两种 .zip 文件，一种是目录在 .zip 文件的目录中有自己的条目，另一种没有。这是一个棘手的问题，因为（据我了解）大多数用于查看 .zip 文件的工具都没有指示目录是否有自己的条目——它们只是使用 Windows 资源管理器中的 GUI 文件夹图标或其他方式显示目录.

此处给出了解决方案：http: [//supportforums.blackberry.com/t5/Native-Development/Error-while-uploading-Invalid-signature-file-digest-for-Manifest/td-p/1623873](http://supportforums.blackberry.com/t5/Native-Development/Error-while-uploading-Invalid-signature-file-digest-for-Manifest/td-p/1623873)

它提供了一个 java 程序来从提取的内容中重建 .zip，并且使用该特定的 java 库来重建 .zip 不包括文件夹作为它们自己的条目。

出现这个问题有两个原因：

(1) RIM Vendor Portal 提交工具检查文件中的每个项目是否已正确签名，它显然会在目录中看到这两个目录条目，并且因为它们没有签名而吓坏了，因此“一些文件（原文如此）缺少签名。” 事实上，它似乎只是注意到这些是零长度的目录条目，而且无论如何都没有什么要签名的，然后就让它过去吧。那将首先避免整个混乱。

(2) 制作 .bar 文件的 Marmalade 工具会创建一个包含这些目录条目的 zip。棘手的是，据我所知，它不会在*每个人的*系统上创建这些条目，只是在一些系统上。还有其他果酱用户显然没有遇到这个问题。我不知道它是否与 Marmalade 工具正在使用的底层 .zip 库有关，无论它是 .jdk 的一部分，还是 Marmalade 使用的 python 系统的一部分，还是什么。但它在不同的系统上的表现肯定不同。

所以，RIM 和 Marmalade 都应该包含这方面的信息。当 RIM 给出“某些项目缺少签名”的错误时，它应该指定这些零长度的目录条目缺少签名（或者它根本不能将其视为错误，如上所述）。Marmalade 应该告诉所有正在处理 PlayBook 提交的用户这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T05:25:06.777

好的，不要使用这种方法....它验证并允许您提交但在 RIM 方面他们会抱怨您在签名后修改了 .bar 文件这一事实！！

# php - 文件夹中的随机文件（不重复）

> ID：11277813
> 
> 赞同：0
> 
> 时间：2012-06-30T21:28:29.350
> 
> 标签：php, random, directory

所以我使用下面的代码从一个文件夹中提取一个随机文件，我想这样做，所以永远没有机会再次提取当前文件（即：连续两次看到相同的图像/文档） .

我该怎么办？提前致谢！

```
function random_file($dir = 'destinations')
{
    $files = glob($dir . '/*.*');
    $file = array_rand($files);
    return $files[$file];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:31:25.260

将上次查看的文件名存储在 cookie 或会话中。

以下是使用 cookie 的方法：

```
function random_file($dir = 'destinations') {
    $files = glob($dir . '/*.*');
    if (!$files) return false;
    $files = array_diff($files, array(@$_COOKIE['last_file']));
    $file = array_rand($files);
    setcookie('last_file', $files[$file]);
    return $files[$file];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:35:33.660

```
$picker = new FilePicker();
$picker->randomFile();
$picker->randomFile(); // never the same as the previous 
```

--

```
class FilePicker
{
    private $lastFile;

    public function randomFile($dir = 'destinations')
    {
        $files = glob($dir . '/*.*');

        do {
            $file = array_rand($files);
        } while ($this->lastFile == $file);

        $this->lastFile = $file;

        return $files[$file];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:30:44.683

本质上：将使用的每个文件的名称存储在一个数组中；每次拉取一个新名称时，检查它是否已经存在于数组中。

[`in_array()`](http://www.php.net/in_array)会帮助你的。[`array_push()`](http://www.php.net/array_push)将有助于填充“使用的文件”数组。

您可以使数组成为[静态](http://www.php.net/manual/en/language.variables.scope.php)数组，以便在调用函数时（而不是使用全局变量）使列表可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T21:41:14.460

如果您想以随机顺序呈现一组固定的文件，则将所有文件名读入一个数组，打乱该数组，然后从头到尾使用该数组。

# c++ - BGL 添加具有多个属性的边

> ID：11277820
> 
> 赞同：5
> 
> 时间：2012-06-30T21:29:57.393
> 
> 标签：c++, boost, boost-graph

我希望所有的边缘都具有属性、重量和容量。我发现 BGL 已经定义了这两个。所以我为 Graph 定义 Edge 和 Vertex 属性

```
 typedef property<vertex_name_t, string> VertexProperty;
 typedef property<edge_weight_t, int, property<edge_capacity_t, int> > EdgeProperty;
 typedef adjacency_list<listS,vecS, undirectedS, VertexProperty, EdgeProperty > Graph; 
```

这是我试图将边缘添加到图表的地方：

```
172: EdgeProperty prop = (weight, capacity);
173: add_edge(vertex1,vertex2, prop, g); 
```

如果我只有 1 个属性，我知道它将是 prop = 5; 但是，有两个我对格式感到困惑。

这是我收到的错误：

```
graph.cc: In function ‘void con_graph()’:
graph.cc:172: warning: left-hand operand of comma has no effect 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T00:11:50.393

如果您查看[boost::property](http://www.boost.org/doc/libs/1_49_0/boost/pending/property.hpp)的实现，您会发现无法以这种方式初始化属性值。即便如此，您所拥有的语法`(weight, capacity)`无论如何都是无效的，因此，如果可以像这样初始化属性，它将被写入`EdgeProperty prop = EdgeProperty(weight, capacity);`或只是`EdgeProperty prop(weight, capacity);`. 但是，这又是行不通的。从技术上讲，这是您需要初始化属性值的方式：

```
EdgeProperty prop = EdgeProperty(weight, property<edge_capacity_t, int>(capacity)); 
```

但随着属性数量的增加，这有点难看。因此，默认构造边缘属性然后手动设置每个单独的属性会更干净：

```
EdgeProperty prop;
get_property_value(prop, edge_weight_t) = weight;
get_property_value(prop, edge_capacity_t) = capacity; 
```

当然，更好的选择是使用捆绑属性而不是旧的 bo​​ost::property 链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-14T11:29:25.823

正确的形式是：

```
EdgeProperty prop;
get_property_value(prop, edge_weight) = weight;
get_property_value(prop, edge_capacity) = capacity; 
```

# javascript - 提取要打印的网页部分

> ID：11277825
> 
> 赞同：0
> 
> 时间：2012-06-30T21:30:09.523
> 
> 标签：javascript, jquery, asp-classic

我正在尝试将具有带有值的表单的网页部分复制或提取到变量中，以便我可以从那里打印该部分？我试过 jquery html() 但它似乎只得到了标记。而 clone() 是一个只能粘贴到 jquery DOM 对象中的对象。我试图将它放入一个隐藏变量中，该变量将被发布到服务器并发送回 ViewBag 以在第二页上打印？任何想法如何做到这一点？

# javascript - html标签的拆分值

> ID：11277828
> 
> 赞同：0
> 
> 时间：2012-06-30T21:30:46.243
> 
> 标签：javascript, jquery, html, split

我想从“a”html标签中拆分一些内容。我从 jquery 重新开始。我的代码是这样的，但它不起作用：

```
$("a.uribb").each(function() {
    var id = $(this).attr("href").replace("http://dereferer.org/?", "");
    $(this).append(+id+);
}); 
```

​ HTML标签是这样的：

```
<a href="http://dereferer.org/?http://example.com/" target="_blank" class="uribb">
    http://example.com/
</a> 
```

我想把`http://dereferer.org/?`一部分分开，把另一部分留在那里。我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:32:32.530

如果要替换内容，请尝试使用`.text()`而不是。`.append()`此外，不需要`+`id 之前和之后。

你可以试试这个：

```
var id = $(this).attr("href").replace("http://dereferer.org/?", "");
$(this).text(id); 
```

**更新**

再次阅读问题，我不确定您是要替换`a`-tag 的内容还是 href 的值。如果是后者，试试这个：

```
var id = $(this).attr("href").replace("http://dereferer.org/?", "");
$(this).attr("href", id); 
```

**注意**

从 jQuery 1.6 开始，最好使用[.prop()](http://api.jquery.com/prop/)而不是`.attr()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:42:23.073

那个怎么样？

```
$("a.uribb").attr("href", function(i, val) {
    return val.substring(val.indexOf("?") + 1);
});​ 
```

**演示：http:** [//jsfiddle.net/zQdL4/](http://jsfiddle.net/zQdL4/)

* * *

这很有趣，但是对于您的标记，以下代码也应该可以工作:)

```
$("a.uribb").attr("href", function() {
    return $.trim(this.innerHTML);
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:44:59.663

对，所以你想要的是这个。

```
<a href="http://example.com/">... 
```

试试这个。

```
$("a.uribb").each(function() {
    var indirect_url = $(this).prop("href");
    var direct_url = indirect_url.replace("http://dereferer.org/?", "")
    $(this).prop('href', direct_url);
}); 
```

你当然可以用更少的行来做这件事，但是这样就很清楚发生了什么。具体来说，*不会*`replace()`修改它所操作的字符串。

# facebook - user_status 和 read_stream FB 权限有什么区别？

> ID：11277830
> 
> 赞同：5
> 
> 时间：2012-06-30T21:31:15.530
> 
> 标签：facebook, facebook-graph-api

我对这两个权限感到困惑。从[Permissions Reference](https://developers.facebook.com/docs/authentication/permissions/#user_friends_perms)中，这两个权限都提供对用户帖子/消息的访问权限。似乎 read_stream 权限涵盖了 user_status 权限，因为它提供了对所有帖子的访问权限（意味着所有消息、签到、状态......以及用户的朋友在用户页面上发布的帖子）。

任何人都可以提供有关这些权限的更多信息吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-29T17:39:02.607

幸运的是，[文档现在回答了这个问题：](https://developers.facebook.com/docs/facebook-login/permissions/v2.0)

**用户状态**

> 提供对用户状态消息和签到的访问。请参阅 location_post 表的文档，了解此权限如何影响与帖子关联的位置信息的检索。

然而...

**读流**

> 提供对个人新闻提要中所有帖子的访问。此权限保留给在没有本机客户端的平台上复制 Facebook 客户端的应用程序。它只能用于为人们提供访问此内容的权限。审核您的应用最多可能需要 14 天。

所以换句话说，`read_stream`获取用户的新闻源（即不是他们的状态），并且获得批准非常棘手（正如您可能想象的那样）。而`user_status`获取用户自己发布的状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:18:11.883

[这篇文章](https://stackoverflow.com/questions/10814516/facebook-graph-api-whats-the-purpose-of-the-distinction-between-links-and-s)可能对你有用。它看起来`read_stream`包括标记的照片、参加活动的朋友、朋友的关系更新等，同时`friends_status`让您可以访问所有（？）朋友的状态更新，其中可能包括共享链接，但不包括照片、活动等。

# c++ - Xcode 非终端 C++ 项目

> ID：11277836
> 
> 赞同：1
> 
> 时间：2012-06-30T21:32:02.573
> 
> 标签：c++, xcode, macos, opengl

我是一个业余的 mac 用户，我正在尝试在 Xcode 中制作一个 c++ 项目。无论我走到哪里，我都被告知要在 Xcode 中创建一个命令行工具项目。

这令人沮丧，因为我打算制作一个 OpenGL 应用程序，所以我不希望它成为一个控制台应用程序。

这可能是一个非常业余的问题，但我对 Mac 并不熟悉。如何在 Xcode 中制作一个非控制台（终端）、C++ 应用程序，我可以在其中制作我的 OpenGL 应用程序？

编辑：我可以使用 SDL 进行窗口化而不是可可吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:37:49.763

在这种情况下，您可能确实需要一个命令行项目。

Xcode 模板将包含一个 Cocoa nib，如果您通过调用另一个库来执行所有 GUI，它是一个纯 C++ 项目并且不需要这些模板。

如果您要让它看起来像是一个 OSX 应用程序，它是一个可以直接从 Finder 或 Dock 运行的 .app 包，您可能需要做更多的事情。在这种情况下，选择一个 Cocoa 应用程序并删除 main.m（由 main.cc 替换）和 nib。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:40:00.520

您必须制作一个 Cocoa 应用程序，并将文件的扩展名`.m`从`.mm`. 这告诉编译器您还将使用 C++ 和 Objective-C。

Mac 处理窗口的方式几乎需要使用 Objective-C，因此您需要基础 Cocoa 来制作窗口和 GL 视图，然后您将能够像往常一样用 C++ 编写其余部分。

如果你真的想完全使用 C++，你可以使用像 GLUT 这样的框架来处理窗口本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:40:35.940

您可以创建一个 Cocoa 应用程序并使用本机 API 设置 OpenGL 上下文，然后将您的 C++ 代码集成到其中，或者您可以创建一个使用 GLUT 库来设置 OpenGL 的命令行应用程序。这是两种主要方式。

注意：OS X 上的 GLUT 还不支持 OpenGL 3+，我不认为。

# php - 使用 mod_rewrite 彻底删除 index.php

> ID：11277837
> 
> 赞同：0
> 
> 时间：2012-06-30T21:32:05.430
> 
> 标签：php, mod-rewrite

我正在寻找一种从 URL 中删除 index.php 文件名的方法。我想尝试这样做的主要原因是因为我的目录中有“index.php”。所以不是得到...
**http://localhost/members/index/**
我希望实现更像...
**http://localhost/members/**

下面的代码是我目前在我的 .htaccess 文件中的代码。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{THE_REQUEST} ^GET\ /[^?\s]+\.php
RewriteRule (.*)\.php$ /$1/ [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*)/$ $1.php [L]

RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule .*[^/]$ $0/ [L,R=301] 
```

我非常感谢您的帮助和任何建议！非常感谢你，上帝保佑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:07:43.267

如果您只想从 URL 中“删除”index.php，那么您只需要确保 Apache 知道 index.php 可以用作目录索引。

`DirectoryIndex index.php`

你可以把它放在你的 Apache 配置、VirtualHost 或 .htaccess 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:16:39.687

只需使用这个：

```
RewriteCond %{THE_REQUEST} ^.*index.php.* 
```

而已 ;）

# c# - Visual Studio 2010 IDE 构建神秘地失败，没有错误或警告

> ID：11277841
> 
> 赞同：6
> 
> 时间：2012-06-30T21:32:36.880
> 
> 标签：c#, visual-studio-2010, c#-4.0, msbuild

如果我尝试在 Visual Studio 中构建我的 .sln 文件（使用发布配置，但实际上没有构建我的配置），则构建失败，输出窗口中的错误为零，并且没有错误列表。事实上，在构建输出窗口中，我列出了 7 个项目。在正常冗长的情况下，我有 7 个“构建成功”。每个项目之后的行。然而在底部：

```
========== Build: 6 succeeded or up-to-date, 1 failed, 0 skipped ========== 
```

通过一个一个地构建项目，我找到了“失败”的项目，我试图自己构建它。它依赖于另一个项目，并且它本身就可以很好地构建。我尝试自己构建“失败”项目，但我得到零错误，没有警告，构建失败。但是，在该项目的“bin”文件夹中，（如果我删除旧的 bin 文件）我得到了一个构建的 dll。虽然对我没有多大好处，因为构建“失败”，Visual Studio 不努力在调试模式下启动我的项目。

令人费解的是：在命令行中，我导航到了包含 .sln 文件的目录，然后运行以下命令：

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe /ToolsVersion:4.0 /p:Configuration=Release 
```

然后，在 bin/Release 中，瞧，我有我的构建项目。构建通过命令行而不是 IDE。

有没有人有什么建议？这个问题在我身上发生过两次：一次是在 windows server 2008 上，一次是在 windows xp sp3 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:47:40.143

[Visual Studio 2010 说在我更改源文件后构建失败且没有错误](https://stackoverflow.com/questions/5068011/visual-studio-2010-says-build-failed-with-no-errors-after-i-change-a-source-file)

那里的一个答案建议我改变我正在建造的地方。这是调试目录的路径：

C:\Users\Isaac\Documents\Visual Studio 2010\Projects\checkout\Library Projects\BaseSystemCore\BaseSystemCore\bin\Debug

只需将结帐目录移动到 c:\ 就可以了。与构建路径太长有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T07:14:48.683

我有同样的错误，它不会构建但没有错误。重新启动视觉工作室对我有用，这是在视觉工作室 2012 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-19T06:05:00.787

如果您的解决方案包含太多项目，

单独构建项目，

检查哪个项目失败

对于该项目，检查该项目的引用，如果在任何引用上是黄色标记，则删除该引用，然后再次添加，然后构建并检查，

这会起作用

或者

检查输出窗口，每一行，在某些行中它可能显示，依赖是他们的，但文件不存在

这就是导致的问题

这可能是由于文件损坏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-05T18:00:42.423

关闭 Visual Studio。运行cmd，输入：**C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe /ToolsVersion:4.0 /p:Configuration=Release *yoursolution.sln*** 然后在VS上再次输入并运行你的项目。为我工作！

# php - onClick 事件未在使用 AJAX 的 echo 语句中触发

> ID：11277843
> 
> 赞同：0
> 
> 时间：2012-06-30T21:32:55.877
> 
> 标签：php, html, ajax

在页面头部使用这段代码：

```
<script type="text/javascript">

function vote() {

    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
    }

    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById('results').innerHTML = xmlhttp.responseText;
        }
    } 

    xmlhttp.open('GET', 'update.inc.php', true);
    xmlhttp.send();
}
</script> 
```

和这段 html 代码：

```
<a id="vote" name="vote" onClick="vote();">Link</a> 
```

单击链接时一切正常，执行 update.inc.php 并输出到屏幕。所以我知道ajax是正确的。

但是，使用这段 php 代码

```
echo "<form>
        <input type=\"radio\" name=\"vote\"> yes
        <input type=\"radio\" name=\"vote\"> no
        <input type=\"button\" value=\"$count\" onClick=\"vote();\">
    </form>"; 
```

当我单击输入按钮时，函数 vote() 不再触发。我在这个回声语句中做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T21:42:13.993

问题是您的 2 个单选按钮的名称在函数名称和收音机名称`vote`之间不明确。`vote`所以只需重命名您的函数：

```
echo "<form>
        <input type=\"radio\" name=\"vote\"> yes
        <input type=\"radio\" name=\"vote\"> no
        <input type=\"button\" value=\"$count\" onClick=\"doVote();\">
    </form>"; 
```

和：

```
function doVote() {
    ...    
} 
```

如果您愿意，也可以重命名您的单选按钮。

# objective-c - 如何使用 libstrophe 构建一个 jabber 客户端

> ID：11277844
> 
> 赞同：1
> 
> 时间：2012-06-30T21:32:58.950
> 
> 标签：objective-c, c, osx-lion, xmpp, libstrophe

我正在尝试使用[libstrophe](http://strophe.im/libstrophe/)库制作一个简单的 Jabber 客户端。

到目前为止进展顺利，除了我需要澄清的一件事。

即，我应该如何（持续地）知道联系人的状态（即在线/离线），以便我可以将其显示给我的程序的用户？同样，我应该如何请求用户名册？

我查看了`roster.c`libstrophe 提供的示例，但只打印了一次名册。在一个真实的应用程序中，我需要不断地请求/更新它，以便在应用程序中显示用户添加的任何新联系人等。

因此，基本上，我不清楚如何确保始终在用户的联系人列表中显示最新的花名册和人员的最新状态。

例如，我是否应该在某个预定义的时间间隔请求名册？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T12:20:54.470

名册和存在是 2 个不同的主题。

当您登录时，您通常会请求您已经在做的花名册。当您的联系人列表在会话期间发生更改时，您会收到包含更新联系人的**名册推送。**这是一个节。如果另一个登录的客户操纵了我们您的客户的名册，这并不重要。

称为所有订阅联系人的在线状态与节一起出现。

**您必须使用xmpp_handler_add**设置处理程序

1.  在线状态，存在节
2.  名册推送，iq 节与命名空间 jabber:iq:roster 的查询

# javascript - 为什么这个场景中的灯光不工作？

> ID：11277848
> 
> 赞同：5
> 
> 时间：2012-06-30T21:33:51.467
> 
> 标签：javascript, three.js

我用咖啡脚本编写了一个游戏类，它显示了一个普通的和一个旋转的立方体。你可以在这里看到代码：http: [//jsfiddle.net/6eRzt/6/](http://jsfiddle.net/6eRzt/6/)

一切都是花花公子，除了两件事：

1）我必须做一个丑陋的黑客才能让`requestAnimationFrame`回调工作：

```
var sh = new App();
sh.start();

function animate() {
    sh.animate();
    requestAnimationFrame(animate);
}

animate();​ 
```

2) 这是我最关心的问题：SpotLight 不起作用。我试图从另一个[JSFiddle](http://jsfiddle.net/SCXNQ/123/)复制行为（在这个[问题](https://stackoverflow.com/questions/10781879/im-doing-something-wrong-with-spotlights-and-shadows-in-three-js)中引用），但没有成功。也许这只是一个愚蠢的错字，或者我做错了。

另外：我的 App 课程是否走错了路？到目前为止，我发现的所有 three.js 示例都使用普通函数来运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:01:22.323

关于您的主要关注点，您需要使用`WebGLRenderer`而不是`CanvasRenderer`.

小提琴：http: [//jsfiddle.net/6eRzt/10/](http://jsfiddle.net/6eRzt/10/)

编辑：有很多方法可以解决您的第一个问题。每个人都会有自己的看法。

这是我将如何做到的。闭包防止变量污染全局命名空间；不需要你所有的`this`参考资料。

小提琴#2：http: [//jsfiddle.net/6eRzt/11/](http://jsfiddle.net/6eRzt/11/)

# android - 无法在模拟器中获取列表传感器列表

> ID：11277852
> 
> 赞同：0
> 
> 时间：2012-06-30T21:34:20.157
> 
> 标签：android, android-emulator

我在模拟器上获取可用传感器列表时遇到问题

我的代码：

```
mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
List<Sensor> sensList = mSensorManager.getSensorList(Sensor.TYPE_ALL);
Sensor s1 = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); 
```

我在这两个地方都得到了空列表。

我通过检查模拟器日志验证了模拟器有传感器：

还。连接到模拟器（使用 telnet）并使用传感器状态，我得到以下输出。

```
acceleration: enabled.
magnetic-field: enabled.
orientation: enabled.
temperature: enabled.
proximity: enabled. 
```

清单中的权限是：

非常感谢这里的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:40:34.320

```
public class AndroidSensorList extends ListActivity {
   /** Called when the activity is first created. */
   @Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       SensorManager sensorManager
        = (SensorManager)getSystemService(Context.SENSOR_SERVICE);
       List<Sensor> listSensor
        = sensorManager.getSensorList(Sensor.TYPE_ALL);

       List<String> listSensorType = new ArrayList<String>();
       for(int i=0; i<listSensor.size(); i++){
        listSensorType.add(listSensor.get(i).getName());
       }

       setListAdapter(new ArrayAdapter<String>(this,
               android.R.layout.simple_list_item_1,
               listSensorType));
       getListView().setTextFilterEnabled(true);
   }
} 
```

同样在您的模拟器中，您必须通过编辑您的 avd 添加硬件属性，然后单击硬件属性下的新建，您可以添加：

加速度计、磁场支持、方向支持、温度......不要忘记将值设置为 true

# delphi - 我需要 TThreads 吗？如果是这样，我可以暂停、恢复和停止它们吗？

> ID：11277860
> 
> 赞同：23
> 
> 时间：2012-06-30T21:35:41.857
> 
> 标签：delphi, delphi-xe

我一直想知道是否有更好的方法来编写我的一些程序，尤其是那些需要很长时间才能完成的程序。

我总是在主 GUI 线程上运行所有东西，我现在理解并意识到这是不好的，因为它会使应用程序无响应，`Application.ProcessMessages`在这里不会真正有帮助。

这让我觉得我需要使用 TThreads 进行冗长的操作，例如复制文件。这也让我想知道某些应用程序如何让您完全控制，例如允许您暂停、恢复和或停止操作。

在我正在处理的个人项目中，我有大约 3 个冗长的操作，我显示一个带有 TProgressBar 的对话框表单。虽然这确实有效，但我觉得它可以做得更好。这些进度对话框可能会显示很长时间，以至于您可能想要取消操作并稍后完成作业。

正如我所说，目前我正在运行 Main Gui Thread，我是否需要使用 TThreads？我不确定如何或从哪里开始实施它们，因为我以前没有与它们合作过。如果我确实需要线程，它们是否提供我需要的东西，例如暂停、恢复、停止操作等？

基本上，我正在寻找一种更好的方式来处理和管理冗长的操作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-30T22:55:53.883

是的，这绝对是您需要一个线程来完成任务的情况。

一个如何暂停/恢复线程和取消线程的小例子。

进度通过 PostMessage 调用发送到主线程。暂停/恢复和取消是通过`TSimpleEvent`信号进行的。

**编辑：**根据@mghie 的评论，这是一个更完整的示例：

**编辑 2：**展示了如何传递一个线程来调用繁重的工作的过程。

**编辑 3：**添加了更多功能和测试单元。

```
unit WorkerThread;

interface

uses Windows, Classes, SyncObjs;

type
  TWorkFunction = function: boolean of object;

  TWorkerThread = Class(TThread)
  private
    FCancelFlag: TSimpleEvent;
    FDoWorkFlag: TSimpleEvent;
    FOwnerFormHandle: HWND;
    FWorkFunc: TWorkFunction; // Function method to call
    FCallbackMsg: integer; // PostMessage id
    FProgress: integer;
    procedure SetPaused(doPause: boolean);
    function GetPaused: boolean;
    procedure Execute; override;
  public
    Constructor Create(WindowHandle: HWND; callbackMsg: integer;
      myWorkFunc: TWorkFunction);
    Destructor Destroy; override;
    function StartNewWork(newWorkFunc: TWorkFunction): boolean;
    property Paused: boolean read GetPaused write SetPaused;
  end;

implementation

constructor TWorkerThread.Create(WindowHandle: HWND; callbackMsg: integer;
  myWorkFunc: TWorkFunction);
begin
  inherited Create(false);
  FOwnerFormHandle := WindowHandle;
  FDoWorkFlag := TSimpleEvent.Create;
  FCancelFlag := TSimpleEvent.Create;
  FWorkFunc := myWorkFunc;
  FCallbackMsg := callbackMsg;
  Self.FreeOnTerminate := false; // Main thread controls for thread destruction
  if Assigned(FWorkFunc) then
    FDoWorkFlag.SetEvent; // Activate work at start
end;

destructor TWorkerThread.Destroy; // Call MyWorkerThread.Free to cancel the thread
begin
  FDoWorkFlag.ResetEvent; // Stop ongoing work
  FCancelFlag.SetEvent; // Set cancel flag
  Waitfor; // Synchronize
  FCancelFlag.Free;
  FDoWorkFlag.Free;
  inherited;
end;

procedure TWorkerThread.SetPaused(doPause: boolean);
begin
  if doPause then
    FDoWorkFlag.ResetEvent
  else
    FDoWorkFlag.SetEvent;
end;

function TWorkerThread.StartNewWork(newWorkFunc: TWorkFunction): boolean;
begin
  Result := Self.Paused; // Must be paused !
  if Result then
  begin
    FWorkFunc := newWorkFunc;
    FProgress := 0; // Reset progress counter
    if Assigned(FWorkFunc) then
      FDoWorkFlag.SetEvent; // Start work
  end;
end;

procedure TWorkerThread.Execute;
{- PostMessage LParam:
  0 : Work in progress, progress counter in WParam
  1 : Work is ready
  2 : Thread is closing
}
var
  readyFlag: boolean;
  waitList: array [0 .. 1] of THandle;
begin
  FProgress := 0;
  waitList[0] := FDoWorkFlag.Handle;
  waitList[1] := FCancelFlag.Handle;
  while not Terminated do
  begin
    if (WaitForMultipleObjects(2, @waitList[0], false, INFINITE) <>
      WAIT_OBJECT_0) then
      break; // Terminate thread when FCancelFlag is signaled
    // Do some work
    readyFlag := FWorkFunc;
    if readyFlag then // work is done, pause thread
      Self.Paused := true;
    Inc(FProgress);
    // Inform main thread about progress
    PostMessage(FOwnerFormHandle, FCallbackMsg, WPARAM(FProgress),
      LPARAM(readyFlag));
  end;
  PostMessage(FOwnerFormHandle, FCallbackMsg, 0, LPARAM(2)); // Closing thread
end;

function TWorkerThread.GetPaused: boolean;
begin
  Result := (FDoWorkFlag.Waitfor(0) <> wrSignaled);
end;

end. 
```

只需调用`MyThread.Paused := true`暂停并`MyThread.Paused := false`恢复线程操作。

要取消线程，请调用`MyThread.Free`。

要从线程接收发布的消息，请参见以下示例：

```
unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, WorkerThread;

const
  WM_MyProgress = WM_USER + 0; // The unique message id

type
  TForm1 = class(TForm)
    Label1: TLabel;
    btnStartTask: TButton;
    btnPauseResume: TButton;
    btnCancelTask: TButton;
    Label2: TLabel;
    procedure btnStartTaskClick(Sender: TObject);
    procedure btnPauseResumeClick(Sender: TObject);
    procedure btnCancelTaskClick(Sender: TObject);
  private
    { Private declarations }
    MyThread: TWorkerThread;
    workLoopIx: integer;

    function HeavyWork: boolean;
    procedure OnMyProgressMsg(var Msg: TMessage); message WM_MyProgress;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

{ TForm1 }
const
  cWorkLoopMax = 500;

function TForm1.HeavyWork: boolean; // True when ready
var
  i, j: integer;
begin
  j := 0;
  for i := 0 to 10000000 do
    Inc(j);
  Inc(workLoopIx);
  Result := (workLoopIx >= cWorkLoopMax);
end;

procedure TForm1.btnStartTaskClick(Sender: TObject);
begin
  if not Assigned(MyThread) then
  begin
    workLoopIx := 0;
    btnStartTask.Enabled := false;
    btnPauseResume.Enabled := true;
    btnCancelTask.Enabled := true;
    MyThread := TWorkerThread.Create(Self.Handle, WM_MyProgress, HeavyWork);
  end;
end;

procedure TForm1.btnPauseResumeClick(Sender: TObject);
begin
  if Assigned(MyThread) then
    MyThread.Paused := not MyThread.Paused;
end;

procedure TForm1.btnCancelTaskClick(Sender: TObject);
begin
  if Assigned(MyThread) then
  begin
    FreeAndNil(MyThread);
    btnStartTask.Enabled := true;
    btnPauseResume.Enabled := false;
    btnCancelTask.Enabled := false;
  end;
end;

procedure TForm1.OnMyProgressMsg(var Msg: TMessage);
begin
  Msg.Msg := 1;
  case Msg.LParam of
    0:
      Label1.Caption := Format('%5.1f %%', [100.0 * Msg.WParam / cWorkLoopMax]);
    1:
      begin
        Label1.Caption := 'Task done';
        btnCancelTaskClick(Self);
      end;
    2:
      Label1.Caption := 'Task terminated';
  end;
end;

end. 
```

和形式：

```
object Form1: TForm1
  Left = 0
  Top = 0
  Caption = 'Form1'
  ClientHeight = 163
  ClientWidth = 328
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -13
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  PixelsPerInch = 120
  TextHeight = 16
  object Label1: TLabel
    Left = 79
    Top = 18
    Width = 51
    Height = 16
    Caption = 'Task idle'
  end
  object Label2: TLabel
    Left = 32
    Top = 18
    Width = 41
    Height = 16
    Caption = 'Status:'
  end
  object btnStartTask: TButton
    Left = 32
    Top = 40
    Width = 137
    Height = 25
    Caption = 'Start'
    TabOrder = 0
    OnClick = btnStartTaskClick
  end
  object btnPauseResume: TButton
    Left = 32
    Top = 71
    Width = 137
    Height = 25
    Caption = 'Pause/Resume'
    Enabled = False
    TabOrder = 1
    OnClick = btnPauseResumeClick
  end
  object btnCancelTask: TButton
    Left = 32
    Top = 102
    Width = 137
    Height = 25
    Caption = 'Cancel'
    Enabled = False
    TabOrder = 2
    OnClick = btnCancelTaskClick
  end
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-01T07:17:31.197

您还可以使用更高级别的库进行线程处理，例如：

*   [http://andy.jgknet.de/blog/bugfix-units/asynccalls-29-asynchronous-function-calls/](http://andy.jgknet.de/blog/bugfix-units/asynccalls-29-asynchronous-function-calls/)
*   [http://otl.17slon.com/](http://otl.17slon.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T17:29:15.227

[如果LU RD 答案](https://stackoverflow.com/a/11278283/30568)中的示例代码对您来说太复杂了，那么您可能更喜欢[.net BackgroundWorker 类的 Delphi 实现。](http://www.delphiarea.com/products/delphi-components/backgroundworker/)

使用它，您可以将组件拖放到表单上并为其各种事件（`OnWork`、`OnWorkProgress`和）添加处理程序。该组件将在后台执行事件处理程序，同时从 GUI 线程执行其他事件处理程序（负责必要的上下文切换和同步）。但是，在事件处理程序中编写代码仍然需要彻底了解从辅助线程中可以做什么和不能做什么。`OnWorkFeedback``OnWorkComplete``OnWork``OnWork`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T10:42:48.193

许多年前，一个叫 Martin Harvey 的人写了一篇关于多线程的有用介绍。他的教程可以在[Embarcadero CC 网站](http://cc.embarcadero.com/Author/31734)上找到——看起来他已经上传了一个示例类，它可以做你正在寻找的事情，但我没有看过它，所以不能肯定地说。

# c - access() 说文件存在但 fopen() 说它不存在

> ID：11277865
> 
> 赞同：1
> 
> 时间：2012-06-30T21:36:15.617
> 
> 标签：c, git, fopen

我有一个正在尝试读取文件的 ac 程序。使用`access()`命令它说文件在那里但`fopen()`返回 NULL 并且 errno 说文件不存在。

截断的代码片段：

```
 FILE *fp;
  char *filename = strdup(git_dir);
  strcat(filename, "/HEAD");

  printf(git_dir);
  printf(":");
  printf(filename);
  printf(":");

  if (access(filename, F_OK)) {
    printf("Y U NO OPEN:");
  }

  fp = fopen(filename, "r");
  if (fp == NULL) {
    printf(strerror(errno));
    return;
  } 
```

正如您从代码中可以看出的，这是试图打开 git 存储库的 .git/HEADS 文件。失败的特定存储库被克隆到另一个存储库的子目录中，然后作为子模块添加。我没有通过运行`git submodule update`命令克隆的问题。

上面的代码不会打印“YU NO OPEN:”，但会打印出`strerror()`. 我将文件名打印到屏幕上并打开文件，`less`它打开得很好。这个程序正在生成我的 zsh 提示符，所以我想它是由我的用户运行的，并且文件的权限是

```
-rw-r--r-- 1 ben users   23 Jun 30 13:32 HEAD 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:40:34.897

你不能这样做：

```
char *filename = strdup(git_dir);
strcat(filename, "/HEAD"); 
```

您将字符串“/HEAD”附加到文件名，但文件名只有`git_dir`. 因此，您正在写入缓冲区，覆盖内存，并可能造成破坏，并且可能会发生各种不可预测的行为。

改为这样做：

```
char *filename = malloc(strlen(git_dir) + 6); //length of /HEAD + null terminator
strcpy(filename, git_dir);
strcat(filename, "/HEAD"); 
```

请记住，标准输出通常也是行缓冲的。这意味着如果您这样做`printf("Y U NO OPEN:");`，您可能不会立即看到输出。打印换行符 \n 以刷新输出。

# selenium - Webdriver 未检测到 Web 元素何时变为不可见

> ID：11277867
> 
> 赞同：2
> 
> 时间：2012-06-30T21:36:43.353
> 
> 标签：selenium, webdriver, visibility

我无法让这个“invisibilityOfElementLocated()”方法工作。这是我正在使用的代码，我亲眼目睹该元素在大约 35 秒后消失，但 Webdriver 没有检测到这一点并在此代码上崩溃并跳过测试。如果有人有更好的不同方法，我会很高兴。

```
if ( driver.findElement( By.xpath( "//div[@class='Caption']" )).isDisplayed() ) {
  System.out.println("Caption is visible.");
}
WebDriverWait wait1 = new WebDriverWait( driver , 60 ); 
wait1.until( 
  ExpectedConditions.invisibilityOfElementLocated( 
    By.xpath( "//div[@class='Caption']" ) 
  )
); 
```

这是我导致的错误：

```
org.openqa.selenium.TimeoutException: Timed out after 60 seconds waiting for
  element to no longer be visible: By.xpath: //div[@class='Caption']
Build info: version: '2.24.1', revision: '17205', time: '2012-06-19 16:53:24'
System info: os.name: 'Windows 7', os.arch: 'x86', os.version: '6.1', 
  java.version: '1.6.0_31'
Driver info: driver.version: unknown
    at org.openqa.selenium.support.ui.FluentWait.timeoutException(
          FluentWait.java:251)
    at org.openqa.selenium.support.ui.FluentWait.until(FluentWait.java:220)
    at test.TaskListPage.isLoaded(TaskListPage.java:43)
    at org.openqa.selenium.support.ui.SlowLoadableComponent.get(
         SlowLoadableComponent.java:48)
    at test.TaskListPage.<init>(TaskListPage.java:31)
    at test.Form.testLogin(Form.java:153)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(
        NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(
           DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(
          FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(
          ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(
          FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(
          InvokeMethod.java:20)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(
          BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(
           BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.junit.runners.Suite.runChild(Suite.java:128)
    at org.junit.runners.Suite.runChild(Suite.java:24)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.internal.runners.statements.RunAfters.evaluate(
       RunAfters.java:30)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300) 
```

此外，此方法给出了类似的错误：

```
ExpectedCondition<Boolean> e = new ExpectedCondition<Boolean>() {
  public Boolean apply(WebDriver d) {
    WebElement tE = driver.findElement( By.className("Caption") );
    // return the invisibility instead of the visibility
    return !tE.isDisplayed();
  }
};
WebDriverWait w = new WebDriverWait(driver, 60);
w.until(e); 
```

我在这方面取得了一些成功，但是当元素最终变得不可见然后将我从测试用例中弹出时，它仍然会引发异常：

```
while ( 
  // dialogMiddleCenterInner is a td that contains the Caption div
  driver.findElement( By.className("dialogMiddleCenterInner")
).isDisplayed() ) {
  System.out.println("Caption is visible.  Waiting for login.");
  AFormUtils.waitSeconds(2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:38:11.817

感谢 Slanec 试图帮助我。好的，这就是答案。看来，无论我是否使用 ExpectedCondition，我都只需要处理异常而不是让它抛出，但它最终起作用了：

```
try {
  while ( 
    // dialogMiddleCenterInner is a td that contains the Caption div
    driver.findElement( By.className("dialogMiddleCenterInner")
  ).isDisplayed() ) {
  System.out.println("Caption is visible.  Waiting for login.");
  MyUtils.waitSeconds(2);
} catch ( NoSuchElementException nse ) {
  nse.printStackTrace(); // print but simulate .ignoring() by catching exception
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T08:26:37.140

**invisibilityOfElementLocated**（通过定位器）检查元素是否不可见或不存在于 DOM 上的期望。

改为使用 *presenceOfElementLocated* (By locator) 检查页面 DOM 上是否存在元素的期望。

# ios - Ios 模拟器 - 键盘出现后，我如何让它消失以及所涉及的 ux 模式是什么？

> ID：11277868
> 
> 赞同：1
> 
> 时间：2012-06-30T21:37:02.217
> 
> 标签：ios, ios5

我有一个小表格，我想让人们在 iPhone 上填写。附上表格截图。

![在此处输入图像描述](../Images/f0b6877850947dfcd097af39dae6dc96.png)

在文本区域下方有一个提交按钮。如何让键盘消失以便我可以按下提交按钮？

此外，对于用户来说，这非常令人困惑，特别是如果表单下方有更多内容......他们甚至可能永远不会在那里找到这些东西。

使此类操作清晰的典型 ui/ux 模式是什么？以及如何放下键盘，以便按下键盘覆盖的提交按钮？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:00:53.487

`[textView resignFirstResponder]`当用户点击 textView 之外的父视图中的任何位置时，您可以简单地调用。你需要在`-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event`. 或者将您的视图放在 UIScrollView 中，并在用户开始输入时向上滚动（查看 Omar 的链接）。这样您就可以在 textView 下方显示信息。

# javascript - Node.js服务端的代码可以被客户端访问吗？

> ID：11277870
> 
> 赞同：0
> 
> 时间：2012-06-30T21:37:18.960
> 
> 标签：javascript, node.js

我想用 NodeJS 开发一个游戏，但我不确定它有多“容易”破解。例如，如果我用 PHP 编写我的游戏规则，修改它们将需要黑客实际访问服务器，而不是如果我的规则在 javascript 中任何人都可以轻松地根据需要重写规则。

更重要的是，如果游戏会涉及人们在玩游戏时发现规则，我怎么能通过查看代码来阻止这些规则出现在任何人身上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:50:49.727

您的 Node.js 应用程序的实际代码将保持未公开。理想情况下，您的客户端（无论您在浏览器端做什么，无论是渲染 html 元素还是使用 html5 画布）将只处理 I/O 并更新您的服务器，而您的服务器将处理所有逻辑。

您仍然可以使用 javascript 客户端，但请记住，您担心客户端 javascript 是合理的。这就是为什么将输入/输出代码（发生在客户端的 javascript 中）与发生在服务器上的游戏逻辑代码分开的常见做法。所以有人能做的最糟糕的事情就是向你的服务器发送一条消息，说他们同时按下每个键，你可以过滤这样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T21:42:07.670

在 nodejs 中开发意味着**服务器**上的 javascript 。除非您将游戏开源，否则您的玩家将无法看到服务器上的 Javascript 代码。此代码不会向您的玩家公开。

# java - Java - Slick2d：非常低的帧率

> ID：11277872
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:37:27.583
> 
> 标签：java, lwjgl, slick2d

这个问题不是我的，所以我需要一些时间来提供细节。

XY 根据教程视频系列为 Slick2d 编程设置 Java 环境。XY 使用与导师相同的代码，但导师获得 800 FPS 而 XY 获得 5。该应用程序按预期工作，但它有一个主要的 FPS 问题。XY 使用 Eclipse 进行编译。

在这种情况下有什么值得检查的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T07:57:08.417

首先想到的是 XY 使用的渲染方法。我不知道 Slick2D 渲染的复杂性，但由于它使用 OpenGL，我可以说渲染方法之间的性能差异是巨大的。如果可能，我会尝试使用显示列表或顶点缓冲区对象。我这个[论坛帖子](http://slick.javaunlimited.net/viewtopic.php?f=3&t=4672)会有所帮助。

# javascript - 从带有滚动和偏移的单独页面导航到特定的锚标记

> ID：11277874
> 
> 赞同：1
> 
> 时间：2012-06-30T21:37:50.077
> 
> 标签：javascript, jquery, css, scrollto

我正在使用 jQuery scrollTo 构建一个多部分启动页面以在部分之间导航。有一个固定的标题，scrollTo 的“偏移”设置考虑在内，但我希望用户能够从网站其他页面导航到特定部分（启动页面上的锚点）。

就目前而言，发生这种情况时没有考虑偏移量......我尝试在部分和#page和body元素上添加边距以及一些相对定位，但这些部分始终与浏览器窗口的顶部。

我想要的是让其他页面的链接考虑偏移量的方法，或者让这些链接将用户带到启动页面的顶部，然后将它们向下滚动到所需的锚点。

js：

```
 //menu scrolling

    jQuery('#menu-primary').localScroll({
        easing: 'easeInOutQuint',
        duration: 1200,
        offset: -63,
        hash: true
    }); // end scroll

    // active states for menu items
    $(function(){
        var sections = {},
            _height  = $(window).height(),
            i        = 0;

        $('.section').each(function(){
            sections[this.name] = $(this).offset().top;
        });

        $(document).scroll(function(){
            var $this = $(this),
                pos   = $this.scrollTop();

            for(i in sections){
                if(sections[i] > pos && sections[i] < pos + _height){
                    $('li').removeClass('active');
                    $('.nav-' + i).addClass('active');
                }  
            }
        });
    }); 
```

html:

```
<div class="menu-primary-container">
   <ul id="menu-primary" class="menu">
       <li id="menu-item-21" class="nav-section1 active"><a href="/#section1">Home</a></li>
       <li id="menu-item-13" class="nav-section2"><a href="/#section2">two</a></li>
       <li id="menu-item-12" class="nav-section3"><a href="/#section3">three</a></li>
       <li id="menu-item-14" class="nav-section4"><a href="/#section4">four</a></li>
       <li id="menu-item-19"><a href="http://galvanizingequity.com/?page_id=17">other page</a></li>
   </ul>
</div>

    <div id="scrollwrap">
    <div class="scrollbox one">
        <a name="section1" class="section"></a>
        <h2>Apples</h2>
    </div>
    <div class="scrollbox two">
        <a name="section2" class="section"></a>
        <h2>Bananas</h2>
    </div>
    <div class="scrollbox three">
        <a name="section3" class="section"></a>
        <h2>Toast</h2>
    </div>
    <div class="scrollbox four">
        <a name="section4" class="section"></a>
        <h2>Papaya</h2>
    </div>
    </div><!--scrollwrap--> 
```

（它是一个 wordpress 网站，就自定义编码菜单而言确实增加了额外的障碍。）

输入表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:48:07.420

您可以设置您的 jquery，以便在页面加载/准备好时放入 a `scrollTop(0)`，然后使用以下方法获取 javascript 中的哈希：`window.location.hash`然后只需`animate({scrollTop,$('a.'+hashvaluehere).offset().top},1000);`

不确定这是否是您要问的，但我想我理解了这个问题？

# google-chrome-extension - 点击事件未报告给 Gmail 页面的 Chrome 扩展程序

> ID：11277880
> 
> 赞同：1
> 
> 时间：2012-06-30T21:39:07.530
> 
> 标签：google-chrome-extension, gmail, content-script

我的扩展只是根据用户点击在页面上执行操作；它适用于除 Gmail 之外的所有网站。

这是我的清单文件：

```
{
  "name": "My Extension",
  "version": "2.0",
  "description": "description.",
  "permissions": [
    "tabs"
  ],
  "icons": {
    "16" : "images/icon-16.png",
    "48" : "images/icon-48.png",
    "128" : "images/icon-128.png"
  },
  "background_page": "background.html",
  "options_page": "Options.html",
  "content_scripts": [
    {
        "matches": ["<all_urls>"],
        "css": ["css/style.css"],
        "js": ["inject.js"]
    }
  ]
} 
```

当我点击一个网页时，我`inject.js`通常会触发一个`alert()`-- 它处理`onclick`事件。但是，在 Gmail 页面上，它不会捕获点击事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:57:21.513

Gmail 由框架组成。默认情况下，内容脚本仅在顶级框架中注入。添加`"all_frames":true`到[manifest](http://code.google.com/chrome/extensions/content_scripts.html#registration)，以便内容脚本也被注入到框架中。

```
"content_scripts": [{
    "matches": ["<all_urls>"],
    "css": ["css/style.css"],
    "js": ["inject.js"],
    "all_frames": true
}] 
```

# javascript - 如何在 Javascript 中制作一组自定义对象数组？

> ID：11277890
> 
> 赞同：1
> 
> 时间：2012-06-30T21:40:42.677
> 
> 标签：javascript

所以，我有一个友好的邻域对象构造函数，就像这样；

```
function Clip(a, b)
{
    this.track = a
    this.slot = b
    this.path = "live_set tracks " + a + " clip_slots " + b + " clip "
    clip = new LiveAPI(this.patcher, this.path)
    this.length = clip.get("length")
} 
```

我想做的是

1.  将任意数量的它们添加到数组中
2.  当数组的长度达到 8 时，将该数组添加到一个新的“超级”数组并开始一个新数组。

换句话说，超级数组应该允许我通过例如 、 等访问对象的属性和`clip[0][0].length - clip[0][7].length`方法`clip[1][0].length - clip[1][7].length`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:02:50.020

这是你要找的吗？我简化了一些代码，但总体思路似乎很合适。

[http://jsfiddle.net/bryandowning/pH6bU/](http://jsfiddle.net/bryandowning/pH6bU/)

```
var superArr = [];

function Clip(a) {
    this.length = a;
}

/*
* num: number of clip collections to add to container
* max: number of clips per collection
* container: array to add collections to
*/
function addClips( num, max, container ){

    while(num--){

        // arr: a collection of clips
        var arr = [];

        for( var i = 0; i < max; i++ ){

            arr.push(
                // just did a random number for the length
                new Clip( Math.floor( Math.random() * 10 ) )
            );

        }

        container.push( arr );

    }

}

addClips( 5, 8, superArr );

console.log( superArr );

console.log( superArr[0][0].length );

​ 
```

# sql - 使用 SYSDATE 获取日期的问题？

> ID：11277900
> 
> 赞同：0
> 
> 时间：2012-06-30T21:41:58.813
> 
> 标签：sql, oracle, sysdate

我有一个具有 EMP_DATE 列的表结构，如下所示

```
 ID       EMP_DATE
----    -----------
5400     14-FEB-2012 
```

我已将记录插入到下表中

```
INSERT INTO TEST_DATE VALUES(5400,SYSDATE); 
```

在插入记录后，我试图获取那些没有选择行`EMP_DATE` 的人的记录。`SYSDATE`暂时让`SYSDATE`'01-JUL-2012'

```
 SELECT * FROM TEST_DATE WHERE EMP_DATE = SYSDATE;
                (OR)
 SELECT * FROM TESt_DATE WHERE EMP_DATE = '01-JUL-2012'; 
```

我无法找到任何解决方案。任何的意见都将会有帮助 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T21:54:24.900

主要问题是日期包括小时、分钟和秒，这是您不允许的。如果你想要一天的所有东西，你可以使用这个[`trunc`](http://www.techonthenet.com/oracle/functions/trunc_date.php)函数来得到这个：

```
SELECT * FROM TEST_DATE WHERE trunc(EMP_DATE) = trunc(SYSDATE); 
```

默认情况下`trunc`，在对日期列进行操作时，会删除日期的时间部分。我通常会推荐一个功能索引`trunc(emp_date)`来优化这个查询。就像是：

```
create index i_test_date on test_date(trunc(emp_date)); 
```

我已经构建了一个小[SQL Fiddle](http://www.sqlfiddle.com/#!4/679ee/1)来演示这一点。

还有一个问题；尽管 Oracle 确实支持 ANSI 日期文字，但您的第二个查询是错误的。*Always*，使用该函数将字符串显式转换为日期[`to_date`](http://www.techonthenet.com/oracle/functions/to_date.php)。

```
SELECT * FROM TEST_DATE WHERE EMP_DATE = to_date('01-07-2012','dd-mm-yyyy'); 
```

我使用了`mm` [datetime 格式模型](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#SQLRF00212)，而不是`mon`因为不能保证它`JUL`总是意味着 7 月；这取决于您的 NLS 参数、您的特定数据库或会话使用的“日期语言”。日期时间格式模型是您如何告诉数据库您传递的要转换为日期的任何字符串的格式。

* * *

如果您对第二个查询的 ANSI 语法感兴趣，则为：

```
SELECT * FROM TESt_DATE WHERE trunc(EMP_DATE) = DATE '2012-07-01' 
```

它必须采用这种格式 (YYYY-MM-DD) 才能工作。

# javascript - 在 PhoneGap 中使用 jQuery Mobile 修复延迟回调导致 jQuery Validation 中出现错误错误

> ID：11277901
> 
> 赞同：1
> 
> 时间：2012-06-30T21:42:05.920
> 
> 标签：javascript, jquery-mobile, cordova, callback, jquery-validate

所以这是我的问题。

我目前正在使用 jQuery Mobile 和用于表单验证的 Validation jQuery 插件开发 PhoneGap 应用程序。

我正在尝试设置一个自定义规则，以便它检查数据库中是否已经存在一个名称，如果是，则阻止提交表单，直到用户选择一个唯一的名称。

这个问题是我以前遇到过但尚未设法正确解决的问题。当我调用执行 SQL 选择语句的方法时，直到验证器已经完成并抛出 false 之后，成功回调才会完成。这意味着如果用户输入一个唯一的名称，它将显示一个错误，但如果用户强制它重新验证字段，那么它将是有效的，因为在此期间成功回调已经完成。

以下是相关代码：

```
var nameUnique;

jQuery.validator.addMethod("nameIsUnique", function(value, element) {
        checkNameSQL();
        return this.optional(element) || nameUnique;
    }, "This name is already in use. Please choose another.");

$('#createForm').validate({
    rules: {
      createName: {
        required: true,
        nameIsUnique: true
      },
      createDescription: {
        required: true
      }
    },
    //snip//
});

function checkNameSQL()
{
var name =   document.forms['createForm'].elements['createName'].value;
if (!(name == null || name == ""))
{
    dbShell.transaction(function(tx) {
       tx.executeSql("SELECT STATEMENT",[name],function(tx,results){if(results.rows.length==0){nameUnique = true;}},errorHandler)
    },errorHandler);
}
} 
```

我在有意义的地方对其进行了简化，删除了与问题无关的代码。如您所见，我调用该方法来检查名称是否存在，但在成功回调函数触发将 nameUnique 设置为 true 之前，它正在被验证器返回，从而导致 false 错误。

我应该如何更改我的代码以防止这种情况发生？我应该遵循哪些一般的编程实践来规避未来的类似问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T16:50:51.893

您可以从true 和 false 中返回`pending`一个值，这可用于延迟验证。`addMethod()`有关更多信息，您可以查看验证库的[来源](http://jquery.bassistance.de/validate/jquery.validate.js)。

试试这个方法：

```
$.validator.addMethod("nameIsUnique", function(value, element) {
    var validator = this;
    var previous = this.previousValue(element);
    checkNameSQL(value, function(status) {
        var valid = status === true;
        if (valid) {
            var submitted = validator.formSubmitted;
            validator.prepareElement(element);
            validator.formSubmitted = submitted;
            validator.successList.push(element);
            validator.showErrors();
        } else {
            var errors = {};
            var message = status || validator.defaultMessage(element, "remote");
            errors[element.name] = previous.message = $.isFunction(message) ? message(value) : message;
            validator.showErrors(errors);
        }
        previous.valid = valid;
        validator.stopRequest(element, valid);
    });
    return "pending";
}, "This name is already in use. Please choose another.");

function checkNameSQL(name, callback) {
    if (!(name == null || name == "")) {
        dbShell.transaction(function(tx) {
            tx.executeSql("SELECT STATEMENT", [name], function(tx, results) {
                if (results.rows.length == 0) {
                    nameUnique = true;
                    callback(true);
                }else{
                    callback(false);
                }
            }, errorHandler)
        }, errorHandler);
    }
} 
```

对于演示检查这个小提琴 - [http://jsfiddle.net/dhavaln/GqsVt/](http://jsfiddle.net/dhavaln/GqsVt/)

# jquery - NOT hover JQuery

> ID：11277908
> 
> 赞同：0
> 
> 时间：2012-06-30T21:42:21.680
> 
> 标签：jquery, hover

I'm building a multilevel (fixed to 3 levels) menu using JQuery. Everything is working fine but what I'd like to do is making all the levels disappear when any of them are being hovered.

I'm looking for something like this:

```
$('#categories AND #subcategories AND #tags').live('-NOT-mouseover', function(){
    $('#categories, #subcategories, #tags').remove();
}); 
```

Also, I don't know how to get an AND operator on a JQuery selector.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T21:50:20.640

要选择它，您可以执行以下操作：

```
 $(".commonClass:not(:hover)") 
```

或（是的，它们都有效）

```
$('#categories:not(:hover), #subcategories:not(:hover), #tags:not(:hover)') 
```

虽然第二部真的很丑。。

如果这是您想要的“过度”：

```
$(yourselector).hover(handlerOut); 
```

（意思是）

```
$(yourselector).hover(function(){ console.log("i've just existed whatever you had in your selector"); }); 
```

您想要的“AND”，我认为它不受支持。你可能不得不做这样的事情

```
$("#categories, #subcategories, #tags").hover(function(){
   if($('#categories:hover, #subcategories:hover, #tags:hover').length==0){
      doStuff();
   }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T21:45:44.077

1.  Don't use `live`.
2.  Give those elements a class
3.  `remove` removes the elements from the DOM for good!, just hide them.

**Code:**

```
$('.classForThoseelements').hover(function(){
    $(this).toggle();
}); 
```

Of course you can still use the `id`s:

```
$('#categories, #subcategories, #tags')... 
```

But it's not that clean.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T23:21:47.780

既然我想我理解了这个问题，下面是答案：

```
var leaveTimer;
$('#categories, #subcategories, #tags').hover(function() {
    if (leaveTimer) clearTimeout(leaveTimer);
}, function() {
    var $this = $(this);
    leaveTimer = setTimeout(function() {
        $this.remove();
    }, 500);
}); 
```

这是我的小提琴：http: [//jsfiddle.net/LFdsV/](http://jsfiddle.net/LFdsV/)

虽然我不知道你为什么不使用`.show()`和`.hide()`添加和删除元素。

另请注意，仅当您的菜单元素嵌套时，上述内容才有效。

# wpf - How to update datagrid sort when adding items (using MVVM and no code-behind)

> ID：11277910
> 
> 赞同：1
> 
> 时间：2012-06-30T21:42:32.637
> 
> 标签：wpf, mvvm, datagrid

I have a datagrid that correctly sorts when initially loaded. But it doesn't update when I add an item. How can I have the grid update and sort when a new item is added?

```
<!-- This works for the initial sort, but when members get added to the collection
     the sort doesn't get updated. That's because CollectionViewSource doesn't 
     implement INotifyPropertyChanged. -->
<UserControl.Resources>
    <CollectionViewSource x:Key="SortedApplications" Source="{Binding Applications}">
        <CollectionViewSource.SortDescriptions>
            <scm:SortDescription PropertyName="Name" Direction="Ascending"/>
        </CollectionViewSource.SortDescriptions>
    </CollectionViewSource>
</UserControl.Resources> 
```

One option is to sort the collection within the view model. But if I'm displaying all of the Bars within a Foo, I would then have to break Bars into its own property (in the view model) just so I could sort them.

If possible, I would like to do this without using the view's code-behind because I'm trying not to put code there.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T02:29:48.423

默认情况下，DataGrid 支持排序，而无需指定 SortDescription。事实上，我认为您看到的问题是您的 SortDescription 覆盖了 DataGrid 的排序。我会推荐两件事之一：

1.  删除 SortDescription 并让 DataGrid 处理排序
2.  将 CollectionViewSource 移动到 ViewModel 并将排序处理程序添加到 DataGrid，该处理程序调用 ViewModel 并管理 SortDescriptions。

如果您计划自己管理 SortDescriptions，请记住在添加新集合之前清除 SortDescriptions 集合，以便排序顺序正确。

**更新：**

如果在将新项目添加到绑定到的集合中时 DataGrid 未更新，则您的集合不会引发 CollectionChanged 事件。确保你绑定到了实现 INofityCollectionChanged 的​​东西——比如 ObservableCollection。

**更新：** 这是一个按排序顺序插入项目的示例。您的代码有何不同？

XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase" Title="MainWindow">
<Window.Resources>
    <CollectionViewSource x:Key="SortedApplications" Source="{Binding Items}">
        <CollectionViewSource.SortDescriptions>
            <scm:SortDescription PropertyName="Age" Direction="Ascending"/>
        </CollectionViewSource.SortDescriptions>
    </CollectionViewSource>
</Window.Resources>

<StackPanel>
    <Button Content="Add Item" Click="AddItem_"/>
    <DataGrid ItemsSource="{Binding Source={StaticResource SortedApplications}}"/>
</StackPanel>       
</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    public ObservableCollection<Person> Items { get; set; }

    public MainWindow()
    {
        DataContext = this;
        Items = new ObservableCollection<Person>();
        Items.Add(new Person { Name = "Foo", Age = 1 });
        Items.Add(new Person { Name = "Bar", Age = 3 });
        Items.Add(new Person { Name = "Foo", Age = 31 });
        Items.Add(new Person { Name = "Bar", Age = 42 });
        InitializeComponent();

    }

    private void AddItem_(object sender, RoutedEventArgs e)
    {
        Items.Add(new Person { Name = "test", Age = DateTime.Now.Second});
    }
}

public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

# android - 用于网络连接的示例代码中的 android 开发人员培训错误

> ID：11277912
> 
> 赞同：1
> 
> 时间：2012-06-30T21:42:48.083
> 
> 标签：android

我正在阅读这里的 android 开发人员培训材料 - [http://developer.android.com/training/basics/network-ops/index.html](http://developer.android.com/training/basics/network-ops/index.html)。我下载了示例代码 NetworkUsage.zip 并将其导入 eclipse。当我打开代码时，SettingsActivity.java 中有错误，“SettingsActivity 类型的 onSharedPreferenceChanged(SharedPreferences, String) 方法必须覆盖超类方法”。

据我所知，它正确定义了方法并实现了接口，为什么会出现错误？从android api我可以看到这个接口仍然存在并且没有被弃用或任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:49:38.390

不确定，但可能有帮助

[将项目导入 Eclipse 后出现“必须覆盖超类方法”错误](https://stackoverflow.com/questions/1678122/must-override-a-superclass-method-errors-after-importing-a-project-into-eclips)

Eclipse 默认使用 Java 1.5，并且您有实现接口方法的类（在 Java 1.6 中可以使用 @Override 注释，但在 Java 1.5 中只能应用于覆盖超类方法的方法）。

转到您的项目/ide 首选项并将 java 编译器级别设置为 1.6，并确保您选择 JRE 1.6 以从 eclipse 执行您的程序。

[为什么我使用@Override 得到“必须覆盖超类方法”？](https://stackoverflow.com/questions/8697513/why-do-i-get-must-override-a-superclass-method-with-override)

# javascript - How to add custom field to dhtmlxScheduler?

> ID：11277914
> 
> 赞同：0
> 
> 时间：2012-06-30T21:42:54.517
> 
> 标签：javascript, scheduler, dhtmlx

I want to add multiple custom fields to the lightbox in dhtmlScheduler. I realize that this is a dup of a [prior question](https://stackoverflow.com/questions/10613960/how-can-add-new-field-to-an-event-with-dhtmlx-scheduler) but that answer is incomplete/incorrect.

My application correctly stores and recalls data from a MySQL database using [dhtmlxDataProcessor](http://docs.dhtmlx.com/doku.php?id=dhtmlxdataprocessor:toc) on the client and [dhtmlxConnector via PHP](http://docs.dhtmlx.com/doku.php?id=dhtmlxconnector:start) on the server side. I have carefully read, re-read, and parsed documentation on [Custom "details" form](http://docs.dhtmlx.com/doku.php?id=dhtmlxscheduler:custom_details_form#types_of_editors). I've worked with the code in the 05_custom_editor.html sample.

The problem is that those examples do not work - they silently fail to store the second field, "Details", in the Description section. This is not surprising since nowhere is the field mapped to a database column.

1.  What changes are needed so the "Details" field of the example form stored in the database and recalled with the event?
2.  What changes are needed to support read-only data in the Details field that is populate based on the "Text" field? What I'm thinking of is a name that has an address associated with it.
3.  How to invoke a custom windows with a form from the lightbox to populate the address?

I would prefer to be able to do this by extending the default lightbox, but that is not a requirement.

Any guidance is appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T13:47:56.330

使用 dhtmlScheduler 时有 3 个必填字段。它们是 PHP 连接器中的前 3 个：

```
$scheduler->render_table("my_table","id","start_date,end_date,name,details,.... 
```

只要保留顺序，您的连接器就可以使用任何列名。但是因为它在所有地方都是必需的和使用的，所以 dhtmlScheduler 必须引用事件的名称。它被称为“文本”。

灯箱部分将描述映射到“文本”。我认为没有

```
scheduler.locale.labels.section_description 
```

出于同样的原因。

1) 更新 PHP 连接器以拉入必填字段。2）您可以使用 sched.formSection('myfield') 从灯箱内获取组件，然后您可以添加 javascript 以模糊焦点。3）普通的javascript

您可以在显示灯箱之前使用自定义事件之一更改任何表单项。

当我的 dhtmlScheduler 失败时，它似乎非常有声！控制台说什么？你有没有通过看看它失败的地方？

# java - 在 TomEE+ 上使用 JAX-RS 时“无资源方法”

> ID：11277918
> 
> 赞同：7
> 
> 时间：2012-06-30T21:43:29.127
> 
> 标签：java, jakarta-ee, tomcat, jax-rs, apache-tomee

使用股票 TomEE+，我无法让简单的 JAX-RS 资源工作。我经常收到以下错误：

```
Jun 30, 2012 5:09:59 PM org.apache.cxf.jaxrs.utils.ResourceUtils checkMethodDispatcher
WARNING: No resource methods have been found for resource class com.tensorwrench.test.BaseResource
Jun 30, 2012 5:09:59 PM org.apache.cxf.jaxrs.utils.ResourceUtils checkMethodDispatcher
WARNING: No resource methods have been found for resource class com.tensorwrench.test.BaseResource
Jun 30, 2012 5:09:59 PM org.apache.cxf.jaxrs.utils.ResourceUtils checkMethodDispatcher
WARNING: No resource methods have been found for resource class com.tensorwrench.test.BaseResource
Jun 30, 2012 5:09:59 PM org.apache.cxf.jaxrs.AbstractJAXRSFactoryBean checkResources 
SEVERE: No resource classes found
Jun 30, 2012 5:09:59 PM org.apache.catalina.startup.HostConfig deployWAR
SEVERE: Error deploying web application archive D:\workspace\api\src\main\catalina_base\webapps\testapi-1.0.war
org.apache.cxf.service.factory.ServiceConstructionException
                at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:194)
                at org.apache.openejb.server.cxf.rs.CxfRsHttpListener.deploy(CxfRsHttpListener.java:126)
                at org.apache.openejb.server.cxf.rs.CxfRsHttpListener.deployPojo(CxfRsHttpListener.java:97)
                at org.apache.openejb.server.rest.RESTService.deployPojo(RESTService.java:270)
                at org.apache.openejb.server.rest.RESTService.afterApplicationCreated(RESTService.java:173)
                at org.apache.tomee.webservices.TomeeJaxRsService.afterApplicationCreated(TomeeJaxRsService.java:55)
                at org.apache.tomee.catalina.WebDeploymentListeners.afterApplicationCreated(WebDeploymentListeners.java:38)
                at org.apache.tomee.catalina.TomcatWebAppBuilder.afterStart(TomcatWebAppBuilder.java:818)
                at org.apache.tomee.catalina.GlobalListenerSupport.lifecycleEvent(GlobalListenerSupport.java:103)
                at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
                at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
                at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:401)
                at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:168)
                at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
                at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
                at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
                at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:962)
                at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1603)
                at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
                at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
                at java.util.concurrent.FutureTask.run(FutureTask.java:138)
                at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
                at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
                at java.lang.Thread.run(Thread.java:662)
Caused by: javax.ws.rs.WebApplicationException
                at org.apache.cxf.jaxrs.AbstractJAXRSFactoryBean.checkResources(AbstractJAXRSFactoryBean.java:312)
                at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:144)
                ... 23 more 
```

资源类：包com.tensorwrench.test；

```
import javax.ws.rs.*;
import javax.ws.rs.core.Response;
@Path("/test")
public class BaseResource {
  @GET @Produces("text/plain") @Path("test") Response helloWorld() {
    return Response.ok("Hello world","plain/text").build();
  }
  @GET @Produces("text/plain") String helloWorld2() {
    return "Hello world without path!";
  }
} 
```

网页.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="api" version="3.0" 
     xmlns="http://java.sun.com/xml/ns/j2ee" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
     xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_3_0.xsd">
<display-name>Service</display-name> 
```

构建.gradle：

```
apply plugin: 'java'
apply plugin: 'war'

repositories { mavenCentral() }

dependencies {
    providedCompile 'org.apache.openejb:javaee-api:6.0-4'
}

version = '1.0'
jar {
        manifest {
                attributes 'Title': 'Services',
                                     'Version': version
        }
}

</web-app> 
```

我已经尝试了许多排列，添加 beans.xml，删除，更改注释顺序，对 Java EE 类使用不同的编译依赖项。我一直收到这个错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T23:49:46.490

看起来您的资源方法不在`public`范围内。试试这个：

```
import javax.ws.rs.*;
import javax.ws.rs.core.Response;
@Path("/test")
public class BaseResource {
  @GET @Produces("text/plain") @Path("test") public Response helloWorld() {
    return Response.ok("Hello world","plain/text").build();
  }
  @GET @Produces("text/plain") public String helloWorld2() {
    return "Hello world without path!";
  }
} 
```

# android - Returning to tasks from Home

> ID：11277922
> 
> 赞同：0
> 
> 时间：2012-06-30T21:44:00.093
> 
> 标签：android, stack, android-activity, state

**What I have:**

I have 3 activities in my app with a basic nested structure:

*Activity 1 --> Activity 2 --> Activity 3*

Activity 2 contains data embedded in an `ArrayList<CustomClass>`. `CustomClass` extends application (as taught [here](https://stackoverflow.com/questions/708012/android-how-to-declare-global-variables)) and Activity 3 uses this to modify the `CustomClass` data for Activity 2.

**What I want:**

When the user hits the Home button and then opens my App again later, I want to return to whichever activity was on the top of my stack. (I thought this is supposed to be Android default behaviour.)

It works fine on my Eclipse emulator but on both my Google Nexus One and Huawei Honour, the task is completely restarted.

I have tried setting my activities to run in standard, singleTop and singleTask launch modes. The best result I could get on the phones was to return to Activity 1 (which is just a form) and still display what I had entered into the text fields before creating Activity 2.

I did also notice that if I hit Home then check the Running Applications under Settings, my app is not listed. Maybe Android might be destroying my task and I need to save the activity state. But this doesn't make sense if I press home and immediately re-enter the app?

Advice is appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T17:15:36.687

无法保证一旦您点击 Home 按钮并且您的 Activity 进入，`onPause()`它将保持其状态（即使它保持相同的状态，也无法保证 Activity 将保留在内存中的实际时间量）。这尤其取决于设备以及它如何处理其内部存储器。（参见[此图](http://www.anddev.org/images/android/activity_lifecycle.png)，它显示了 Android 活动生命周期）。

最佳做法是始终将您的状态保存在`onSaveInstanceState`方法中。[这篇文章](https://stackoverflow.com/a/151940/1300817)提供了一个很好且简单的例子来说明如何做到这一点。

# php - php and greek characters

> ID：11277925
> 
> 赞同：1
> 
> 时间：2012-06-30T21:45:24.727
> 
> 标签：php, utf-8

I have this script which takes the `Fname` from a HTML form. When I insert Greek characters, the name of the folder is displayed with symbols in Windows Explorer. Why is this happening and what can I do to fix this?

```
$folderStr = $_REQUEST['FName'];

//create SEO firndly directory name
$upload_folder =    preg_replace ("'\s+'", '-', $folderStr);

// The place the files will be uploaded to (currently a 'files' directory).
 $upload_path = './uploads/'.$upload_folder.'/';

//Check whether folder exists or create with the name supplied

if(is_dir($upload_path))
echo 'directory exists';
else
mkdir ('./uploads/'.$upload_folder.'/', 777); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:01:04.130

确保您提交的表单是 utf-8 编码的。

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

# node.js - 使用带有 utf-8/16（俄语、中文、日语字符）的 redis-node (nodejs)

> ID：11277931
> 
> 赞同：2
> 
> 时间：2012-06-30T21:46:11.923
> 
> 标签：node.js, utf-8, redis

有没有人成功地使用带有 redis-node 或任何其他 redis 库（使用 nodejs）的俄语/中文/日语字符来存储/接收来自 Redis（2.0 及更高版本）的消息？我相信这些消息的编码/解码取决于客户端，而不是 Redis。如果是这样，是否有任何库提供这种编码/解码，或者是否有另一个库可以用于此目的？任何工作代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T18:26:55.083

将 utf-8 与 redis 一起使用 - 如果您使用 redis-cli，请确保传入 raw 作为参数以读取俄语/中文/日语字符（否则这些字符将不会在 redis-cli 中正确显示）。您可以使用 Jedis/redis-node 等 API 正确检索它们。希望这会有所帮助！

# c++ - Unrecoverable block scoping error, array of C++ functors

> ID：11277933
> 
> 赞同：5
> 
> 时间：2012-06-30T21:46:17.417
> 
> 标签：c++, arrays, lambda, c++11, functor

I'm trying to create an array of functors at compile time, like so: (complete file):

```
#include <functional>
using namespace std;

function< float( float tElevation, float pAzimuth )> colorFunctions[] = {
  []( float tElevation, float pAzimuth ) -> float {
    return 2.0f ;
  },
} ;

int main()
{
} 
```

That works fine. But as soon as you try to create a local inside the functor block, like this:

```
function< float( float tElevation, float pAzimuth )> colorFunctions[] = {
  []( float tElevation, float pAzimuth ) -> float {
    float v = 2.0f ;
    return v ;
  },
} ; 
```

You get Error 1 error C1506: unrecoverable block scoping error

How can I declare locals inside these blocks? It doesn't seem to work.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:17:07.113

我可以在 MSVC 2010，SP1 上重现这一点。VS10 因 lambdas 和作用域的一些问题而闻名。我已经尝试了很多，但没有发现任何漂亮的东西。丑陋，丑陋的解决方法会产生一些初始化开销，但可以按预期工作：

```
#include <functional>
#include <boost/assign/list_of.hpp>
#include <vector>
using namespace std;

typedef function< float( float tElevation, float pAzimuth )> f3Func;
vector<f3Func const> const colorFunctions = boost::assign::list_of(
  f3Func([]( float /*tElevation*/, float /*pAzimuth*/ ) -> float {
    float v = 2.0f ;
    return v ;
  }))
  ([](float a, float b) -> float {
    float someFloat = 3.14f;
    return a*b*someFloat;
  })
;

#include <iostream>

int main()
{
  cout << colorFunctions[1](0.3f,0.4f) << '\n';
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-11T14:59:22.043

我在 ubuntu 12.04 上使用以下行编译了以下代码：
g++-4.7 -std=c++0x main.cpp
它工作正常。您使用的是什么平台和什么编译器？

```
#include <iostream>
#include <functional>

using namespace std;

function<float (float,float)> funcs[] = {
    [] (float a, float b) -> float {
        float c = 2.0f;
        return c;
    }
};

int main() {
    std::cout << funcs[0](1,2) << std::endl;
} 
```

# c# - 使用 Datarow 读取 LINQ 查询的结果

> ID：11277940
> 
> 赞同：2
> 
> 时间：2012-06-30T21:47:49.150
> 
> 标签：c#, linq, linq-to-sql

如何逐行读取 LINQ 查询的结果。（可能）？我想实现这个但不可能：

```
aspnetdbDataContext aspdb = new aspnetdbDataContext();
var res = from r in aspdb.RouteLinqs
          where r.UserId == userId
          select r;

foreach (DataRow row in res)
{
    // ... 
```

抛出异常：

**无法将类型“QuickRoutes.DAL.RouteLinq”转换为“System.Data.DataRow”**

## **编辑：**

在`foreach`我有的街区：

```
foreach (var row in res)
{
    var routeId = (int)row["RouteId"];
    var route = new Route(routeId)
                {
                    Name = (string)row["SourceName"],
                    Time = row["CreationTime"] is DBNull ? new DateTime() :
                                    Convert.ToDateTime(row["CreationTime"])
                };

    route.TrackPoints = GetTrackPointsForRoute(routeId);
    result.Add(route);
} 
```

如果我在某些行中使用 var 这个错误：

**无法使用 [] 将索引应用于“QuickRoutes.DAL.RouteLinq”类型的表达式**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T21:52:43.050

采用

```
foreach (RouteLinq row in res)
{
    // ... 
```

或者简单地说：

```
foreach (var row in res)
{
    // ... 
```

您的 Linq 查询不返回`DataRow`对象集合，而是返回从数据库表名自动生成的类的对象。

**编辑，以说明您问题中的编辑：**

为什么要访问对象的成员，就像它们仍然是`DataRow`对象一样？

你想像这样访问它：

```
int routeId = row.RouteId; 
```

我真的建议你看一些基本的 Linq-to-SQL（或一般的 ORM）教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:53:23.010

试试这个

```
foreach (var row in res)
{..... 
```

**更新：**我想给你更小的语法，希望你不介意

```
foreach(var routeLinq in aspdb.RouteLinqs.Where(rl => rl.UserId == userId) )
{
    int routeId = routeLinq.RouteId;
} 
```

# c# - Generating sample data from regex to verify input strings by focussing on boundary cases defined in regex

> ID：11277942
> 
> 赞同：7
> 
> 时间：2012-06-30T21:48:05.267
> 
> 标签：c#, regex, testing, code-generation

There are several tools how to generate sample data for a given regex. Some include:

*   [REX](http://research.microsoft.com/en-us/projects/rex/)
*   [Fare](https://github.com/moodmosaic/Fare)

However, while they may be sufficient to seed a dataset, it doesn't help much testing code that depends on the regex itself, such as validation.

Assume you have a code generator that generates a model with a property. The user specifies a regex to validate the property. Assume now that the code generator is attempting to generate tests to ensure that validation succeeds and fails appropriately. It seems reasonable for the tool to focus on boundary cases within the regex to avoid generating unnecessary data.

For example, consider a regex `^([a-z]{3,6})$` then the boundary cases include:

*   any string consisting only of [a-z] a length equal to 2 (failure)
*   any string consisting only of [a-z] a length equal to 3 (success)
*   any string consisting only of [a-z] a length equal to 4 (success)
*   any string consisting only of [a-z] a length equal to 5 (success)
*   any string consisting only of [a-z] a length equal to 6 (success)
*   any string consisting only of [a-z] a length equal to 7 (failure)
*   any string not consisting of [a-z] (failure)
*   any string not starting with [a-z] but ends with [a-z] (failure)
*   any string starting with [a-z] but not ending with [a-z] (failure)

The reason focussing on boundary cases is that any string consisting only of [a-z] with a length greater than 6 verifies the upper boundary of the string length defined in the regex. So testing a string of length 7, 8, 9 is really just testing the same (boundary) condition.

This was an arbitrary regex chosen for its simplicity, but any reasonable regex may act as an input.

Does a framework/tools exists that the code generator can use to generate input strings for test cases of the different layers of the systems being generated. The test cases come into their own when the system is no longer generated and modified later in the development cycle.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T15:49:18.503

如果我正确理解您的问题，您希望根据验证正则表达式为系统生成输入，以便您可以自动化单元测试。

但是，这不会违背单元测试的目的吗？如果有人更改了正则表达式，您不希望验证失败吗？

无论如何，简单的答案是从正则表达式生成字符串几乎是不可能的。如果能做到，那将是极其复杂的。例如，考虑这个正则表达式：

```
(?<=\G\d{0,3})(?>[a-z]+)(?<=(?<foo>foo)|)(?(foo)(?!)) 
```

我很容易想到一个匹配（和/或生成匹配）的字符串：

> abc123def456ghi789jkl123foo456pqr789stu123vwx456yz

比赛将是：

*   “ABC”
*   “定义”
*   “吉”
*   “jkl”

但是如何从表达式中生成字符串？没有明确的起点——需要一些极端的（对于计算机而言）智能加上一点创造力来制定解决方案。对人类来说很简单，但对计算机来说却非常非常困难。即使你能想出一个生成匹配字符串的计算机算法，它也很容易看起来像这样：

> 一个

这会产生一个匹配，但它在执行正则表达式方面做得很差。`\d{0,3}`从未真正尝试过，并且仅`\G`用于匹配输入的开头（而不是最后一次匹配的结尾）。`(?<=(?<foo>foo))`从未测试过（如果是，则会导致不匹配）。

生成不匹配的字符串也很容易：

> 1

但是，同样，这并没有真正让正则表达式完成它的步伐。

我对计算机理论的了解不足以证明这一点，但我相信这属于[P v NP 类问题](http://en.wikipedia.org/wiki/P_versus_NP_problem)。生成一个正则表达式来匹配一个复杂字符串的集合相对容易，但是生成一个复杂字符串的集合来匹配一个正则表达式是很困难的。

# iphone - 故事板：在导航控制器中嵌入其他场景后添加新场景

> ID：11277944
> 
> 赞同：1
> 
> 时间：2012-06-30T21:48:18.100
> 
> 标签：iphone, ios, uinavigationcontroller, storyboard, uistoryboard

我已经设置了一些场景并将它们嵌入到导航堆栈中（见图）。

![在此处输入图像描述](../Images/0d6172aac1e0d8ffc313b3343f6764b9.png)

如果我现在复制右下角的 segue，它就没有导航栏（见下图）。我可以将顶部栏从“推断”设置为“导航栏”，但这不会将其放在现有的导航堆栈上（例如，没有后退按钮等）。

如何将新的 ViewController 放入现有的导航堆栈？

提前非常感谢。

![在此处输入图像描述](../Images/5748c431a4c931c28c029433b8fb2806.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:15:27.117

我不知道您按什么顺序执行此操作，但我发现如果我复制视图控制器，然后将您作为登录表视图控制器的新序列添加到复制视图控制器，复制视图控制器将拿起导航栏并成为 viewControllers 集的一部分。

# entity-framework - 域事件中的新实体 ID

> ID：11277945
> 
> 赞同：12
> 
> 时间：2012-06-30T21:49:03.740
> 
> 标签：entity-framework, domain-driven-design, cqrs, domain-events

我正在使用 CQRS 和域事件概念构建具有域模型的应用程序（但没有事件源，只是普通的旧 SQL）。SomethingChanged 类型的事件没有问题。然后我陷入了实现SomethingCreated事件的困境。

当我创建一个映射到具有标识主键的表的实体时，在实体被持久化之前我不知道 Id。实体是持久性无知的，因此当从实体内部发布事件时，Id 是未知的 - 它仅在调用 context.SaveChanges() 后神奇地设置。那么如何/在哪里/何时可以将 Id 放入事件数据中？

我在想：

*   包括对事件中实体的引用。这将在域内工作，但不一定在具有多个自治系统通过事件/消息进行通信的分布式环境中工作。
*   覆盖 SaveChanges() 以某种方式更新排队等待发布的事件。但是事件是不可变的，所以这看起来很脏。
*   摆脱身份字段并使用实体构造函数中生成的 GUID。这可能是最简单的，但可能会影响性能并使其他事情变得更加困难，例如调试或查询（`where id = 'B85E62C3-DC56-40C0-852A-49F759AC68FB'`、 no`MIN`等`MAX`）。这就是我在许多示例应用程序中看到的。
*   混合方法 - 不理会身份，主要将其用于外键和更快的连接，但使用 GUID 作为唯一标识符，我通过它从应用程序的存储库中提取实体。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-02T16:34:54.687

我个人喜欢唯一标识符的 GUID，尤其是在数字 id 会导致问题的多用户分布式环境中。因此，我从不使用数据库生成的标识列/属性，这个问题就消失了。

除此之外，由于您遵循 CQRS，因此您无疑拥有一个 CreateSomethingCommand 和相应的 CreateSomethingCommandHandler，它们实际上执行了创建新实例并使用存储库（通过 context.SaveChanges）持久化新对象所需的步骤。我将在此处而不是在域对象本身中引发 SomethingCreated 事件。

一方面，这解决了您的问题，因为命令处理程序可以等待数据库操作完成，提取身份值，更新对象然后在事件中传递身份。但是，更重要的是，它还解决了对象究竟是何时“创建”的棘手问题？

在构造函数中引发域事件是不好的做法，因为构造函数应该是精简的并且只需执行初始化。另外，在您的模型中，对象只有在分配了 ID 后才会真正创建。这意味着在构造函数执行后需要额外的初始化步骤。如果您有多个步骤，您是执行执行顺序（另一种反模式）还是检查每个步骤以识别它们何时都完成（哦，臭）？希望你能看到这如何迅速失控。

因此，我的建议是从命令处理程序中引发事件。（注意：即使您切换到 GUID 标识符，我也会遵循这种方法，因为您永远不应该从构造函数中引发事件。）

# c# - yield 语法的冗长

> ID：11277952
> 
> 赞同：3
> 
> 时间：2012-06-30T21:50:03.550
> 
> 标签：c#, yield

我有一个有趣的问题。根据 MSDN yield[语法](http://msdn.microsoft.com/en-us/library/9k7k7cf0%28v=vs.80%29.aspx)：

```
yield return <expression>; // yield some value
yield break;               // exiting from iterator 
```

为什么不只是：

```
yield <expression>;        // yield some value
return;                    // exiting from iterator 
```

对我来说，第二种形式会不那么冗长，并且仍然与第一种形式具有相同的含义。所以问题是 - 为什么 .NET 设计人员选择了第一种形式？什么原因可能导致这种情况？第二种形式有哪些潜在的设计问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:02:00.253

不使用 yield 本身的主要原因是它会引入一个新的关键字，并且在处理旧代码时可能会破坏向后兼容性。

正因为如此，C# 语言团队决定让 yield 成为一个上下文关键字（它只有在`return`or之后才是一个关键字`break`）。

考虑以下代码：

```
yield variable; 
```

yield 可以是 a`class`或 a的名称，`struct`并且这个语句cold 是一个变量声明。

对于像 C# 这样易于编写和维护的复杂语言，您希望语句只有一个含义。如果`return`根据您是否在迭代器中做不同的事情，您可能会对语言有严重的限制。

[http://blogs.msdn.com/b/ericgu/archive/2006/03/08/546296.aspx](http://blogs.msdn.com/b/ericgu/archive/2006/03/08/546296.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-30T22:00:23.433

这是一种可能性：它会产生技术上的歧义（请记住，这`yield`是一个*上下文*关键字，而不是*保留*关键字）......不太可能，但是：

```
struct yield {} 
```

然后

```
yield x; 
```

实际上是一个变量声明。使用“yield return x;”，这仅是一种有效的方式。

不知道这是否属实。只是一个想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T21:56:21.777

该`return`语句的唯一含义是它必须返回方法返回类型的表达式。由于迭代器没有`void`返回类型，使用语句退出迭代器`return`并不符合这个含义，因为您没有“返回”任何东西。

`yield break`指示迭代器应该退出而不返回任何更多元素。恕我直言，这使该声明比为此目的`yield break`使用该声明更清晰。`return`

# java - 在Java中添加时间计数器？

> ID：11277954
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:50:17.837
> 
> 标签：java, timer, counter

我正在用 Java 编写一个应用程序，我想在其中添加一个用户可以启动和停止的计数器。它会以秒为单位计数，然后数分钟甚至数小时（而不是数天或数月）。我该怎么做才能做出这样的事情？

以下是它的功能：

1.  用户点击“开始”
2.  计数器开始...
3.  用户点击“暂停”
4.  计数器停止但不重置

我是 Java 新手，所以有什么我可以看的代码可以做到这一点或类似的事情吗？如果没有，有人可以给我写一些代码来让我开始吗？

谢谢， Ljbaumer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T21:52:47.153

一些建议：

*   我会在我的 GUI 库中使用 Swing
*   我会使用 Swing Timer 作为 GUI 计时器的核心。
*   JLabel 将显示来自 Swing Timer 的时间变化。
*   启动 JButton 的 ActionListener 将启动 Swing Timer（调用`start()`它）
*   暂停 JButton 的 ActionListener 将调用`stop()`.

关于：

> 我是 Java 新手，所以有什么我可以看的代码可以做到这一点或类似的事情吗？如果没有，有人可以给我写一些代码来让我开始吗？

不，这不是这里的工作方式。您负责编写自己的代码，但如果您遇到任何错误或异常，我们将很乐意为您提供帮助。通过强迫你的大脑创建代码，你会学到更多，尤其是在看起来很难做的时候。

请查看以下教程：

*   [使用 Swing 组件教程](http://docs.oracle.com/javase/tutorial/uiswing/components/index.html)
*   [摆动计时器教程](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)
*   [Swing JButton 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)
*   [如何编写 ActionListener 教程](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T03:42:40.740

有人提到了 Guava StopWatch 类。我不确定你是否可以暂停和恢复，但我知道 apache commons-lang 有一个 StopWatch 类，它允许通过 suspend() 和 resume() 方法

```
StopWatch stopWatch = new StopWatch();
stopWatch.start();
...
stopWatch.suspend();
...
stopWatch.resume();
...
stopWatch.stop():

long elapsed = stopWatch.getTime(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T21:56:41.550

我相信这就是你所追求的

[http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

您可以设置按钮来启动和暂停计时器。

此示例应该可以帮助您入门：

Swing/SwingTimeraction.htm">http://www.java2s.com/Tutorial/Java/0240_Swing/SwingTimeraction.htm

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T21:54:00.397

`System.nanoTime()`返回当前时间，以纳秒为单位。调用一次并将结果存储在一个变量中，让您的程序运行一段时间，再次调用它并计算差异。您将获得纳秒，您可以将其转换为秒、分钟或任何您想要的单位。

Guava 有一个[StopWatch](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Stopwatch.html)类，可以为你做所有事情。

# javascript - 遍历对象的属性会列出原型中的内容

> ID：11277956
> 
> 赞同：1
> 
> 时间：2012-06-30T21:50:21.877
> 
> 标签：javascript, prototype

我正在尝试制作一个“复制”功能并将其添加到对象的原型中。我计划递归地进行类型检查并将属性分配给一个新对象，然后返回该对象......但是，似乎有一个问题，请看这段代码：

```
Object.prototype.copy = function()
{
    for (prop in this)
    {
        console.log(prop); //Logs copy (the function)!!!
    }
}

x = {"a": 1};
y = x.copy(); 
```

正如我在评论中指出的那样，我发现了这种非常奇怪的行为，但是为什么会这样呢？复制功能应该在 中`Object.prototype`，而不是在实例对象本身中！我如何解决它？我可以只设置`this.copy = undefined`，并且仍然依赖`Object.prototype.copy`吗？

这是完整的代码示例，根据要求：

```
Object.prototype.copy = function()
{
    var object = this; //The object we are copying.
    var newObject = {}; //The object we will return.

    //Cycle through the properties of the object we are creating, copy them recursively.
    for (prop in object)
    {
        if (!Object.prototype.hasOwnProperty.call(this, prop) || object[prop] == null)
        {
            continue;
        }

        if (prop == "copy")
        {
            console.log("Well, blah."); //This never prints!
        }

        if (typeof(object[prop]) == "object" && !(object[prop] instanceof Array)) //If the object's property is another object...
        {
            newObject[prop] = object[prop].copy(); //Set the copy of it to the new object as well.
            console.log("1 --- " + prop); //This prints copy - two times! That defies logic!
        }
        else if (typeof(object[prop]) == "object") //If it's an array...
        {
            newObject[prop] = object[prop].slice(); //Do it in a nicer fashion.
            console.log("2 --- " + prop);
        }
        else //You're safe to copy it.
        {
            newObject[prop] = object[prop];
            console.log("3 --- " + prop + " --- " + object[prop]);
        }
    }

    return newObject;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:51:03.427

您可以使用一种名为“hasOwnProperty”的方法：

```
 if (this.hasOwnProperty(prop)) { ... } 
```

如果函数返回`true`它是对象的“直接”属性。

如果您担心“hasOwnProperty”方法可能会出错，您可以这样做：

```
if (Object.prototype.hasOwnProperty.call(this, prop)) { ... } 
```

反而。

较新版本的 JavaScript 具有更好的检查和控制对象的方法。

*编辑*——你更新的代码也涉及到一个问题，由于嵌套调用“复制”而导致问题：你没有用 声明“prop” `var`，所以在调用复制对象之后，“prop”的值将有变了！（换句话说，每个对“复制”的调用都共享相同的变量。）

# maven - 在测试范围内获取 ClassNotFoundException

> ID：11277964
> 
> 赞同：0
> 
> 时间：2012-06-30T21:51:30.680
> 
> 标签：maven, maven-2

我正在尝试为我的 webapp 运行测试。我已经使用了 Spring 和 Hibernate。但是在测试任务中运行`mvn package`会导致 ClassNotFoundException：`java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource`

我已经尝试将其添加到我的 pom.xml 中，但没有成功：

```
<dependency>
    <groupId>commons-dbcp</groupId>
    <artifactId>commons-dbcp</artifactId>
    <version>1.4</version>
    <scope>test</scope>
</dependency> 
```

在这里做什么？

**更新**

`mvn -X clean package`： http: [//paste.ubuntuusers.de/raw/409407/](http://paste.ubuntuusers.de/raw/409407/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T06:39:07.650

我在这里看不到 DBCP 有任何问题。更确切地说，日志说明了自动装配 Spring bean 的一些问题，从 missing 开始`com.example.model.ArticleService`。将这些缺少的 bean 声明为 Spring 组件，应该没问题。

# scala - 在 Scala 项目中使用 sbt vs maven 的优缺点

> ID：11277967
> 
> 赞同：146
> 
> 时间：2012-06-30T21:51:55.407
> 
> 标签：scala, maven, sbt

哪种构建工具最适合 Scala？它们各自的优缺点是什么？如何确定在项目中使用哪一个？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-07-01T03:08:42.747

我们在工作中使用 Maven 构建 Scala 项目，因为它与我们的 CI 服务器很好地集成。当然，我们可以只运行一个 shell 脚本来启动构建，但是我们有很多来自 Maven 的其他信息，我们想进入 CI。这就是我能想到的将 Maven 用于 Scala 项目的唯一原因。

否则，只需使用 SBT。您可以访问相同的依赖项（真的是关于 maven 的最好的部分，恕我直言）。您还将获得巨大的增量编译。能够在项目中启动 shell，这也很棒。

ScalaMock 仅适用于 SBT，您可能会想要使用它而不是 Java 模拟库。最重要的是，扩展 SBT 要容易*得多*，因为您可以在构建文件中编写完整的 scala 代码，因此您不必经历编写 Mojo 的所有繁琐工作。

简而言之，除非您真的需要紧密集成到 CI 服务器中，否则只需使用 SBT。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-01T12:25:06.190

这个问题有产生大量意见的危险；最好有一份清晰的需求清单或对您的环境、以前的知识等的描述。

[FWIW，这个 scala 邮件列表线程](http://www.scala-lang.org/node/11935)中有更多意见。

我的 2c 是：如果您没有特定要求，请使用 sbt

*   对于简单的项目，它完全不费吹灰之力（在你有依赖项之前你甚至不需要构建文件）
*   它通常在 Scala 开源项目中使用。您可以通过查看其他人的项目轻松了解配置。此外，许多项目假设您使用 sbt 并为您提供[现成的复制+粘贴指令](https://github.com/milessabin/shapeless#using-shapeless)，以将它们作为依赖项添加到您的项目中。
*   如果您使用 IntelliJ IDEA，它可以完全集成。你可以[让 IDEA 使用 sbt](https://github.com/orfjackal/idea-sbt-plugin/wiki)持续编译你的项目，反之亦然，你可以使用 sbt 快速[生成 IDEA 项目](https://github.com/mpeltonen/sbt-idea)。如果您处于“快照”周期中，最后一个非常有用，这取决于您自己的其他库，这些库从次要版本到次要版本 - 只需关闭项目，更新构建文件中的版本，重新运行`gen-idea`任务，然后重新打开项目：更新完成。
*   准备好您需要的大多数任务（`compile`, `test`, `run`, `doc`, `publish-local`, `console`） - 这`console`是最好的功能之一。
*   有些人强调依赖可以是直接从 GitHub 上抓取的源代码库的特性。我没用过这个所以不能在这里评论。

有些人讨厌 sbt，因为它使用 Ivy 进行依赖管理（我无法评论它的优缺点，但大多数时候它不是问题），有些人讨厌 sbt，因为您指定构建文件Scala DSL 而不是 XML。有些人对 sbt 的格式从 v0.7 更改为 v0.10 感到失望，但显然，如果您从头开始，迁移不会影响您。

# php - 在数组php的开头添加一个元素

> ID：11277968
> 
> 赞同：0
> 
> 时间：2012-06-30T21:52:27.917
> 
> 标签：php

是否有内置的 php 函数或将元素插入到数组开头的简单方法？

就像是：

```
$matches = Array("apples", "oranges");
insert_to_beginning($matches, "peach"); 
```

内容：

```
$matches[0] = peach
$matches[1] = apples
$matches[2] = oranges 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-30T21:54:14.373

[`array_unshift`](http://php.net/array_unshift)是您正在寻找的功能。

```
array_unshift($matches, "peach"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-30T21:53:53.640

```
array_unshift($matches, 'peach'); 
```

[http://nz.php.net/array_unshift](http://nz.php.net/array_unshift)

# android - Android：MyLocationOverlay.java -> 理解问题

> ID：11277970
> 
> 赞同：0
> 
> 时间：2012-06-30T21:52:35.747
> 
> 标签：android, android-mapview, mylocationoverlay

提到的类有以下方法：

```
 protected void drawCompass(Canvas canvas, float bearing) {
    int offset = Math.max(canvas.getHeight(), canvas.getWidth()) / 8;
    Rect r = new Rect(0, 0, 2*offset, 2*offset);
    canvas.drawBitmap(compassBase, null, r, paint);
    canvas.rotate(-bearing, offset, offset);
    canvas.drawBitmap(compassArrow, null, r, paint);
} 
```

链接到完整的 src：[MyLocationOverlay](http://gitorious.org/android-maps-api/android-maps-api/blobs/42614538ffda1a6985c398933a85fcd9afc752ee/src/com/google/android/maps/MyLocationOverlay.java)

他们在那里创建了一个 Rect r 女巫指定两个位图应该在画布上绘制的位置。

drawBitmap 的 java doc 说：“绘制指定的位图，自动缩放/平移以填充目标矩形。如果源矩形不为空，则指定要绘制的位图的子集。”

因为两个位图都使用相同的 Rect r 并且因为它们都自动缩放以适合 Rect，所以当我在 MapView 中激活指南针时，为什么结果是完美的指南针。

在我看来，结果应该是废话，因为指南针的箭头也被缩放以适合矩形。

那么推理的错误在哪里呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:02:43.110

它们使用相同的比例缩放，而不是绝对大小。为了回答您的问题，画布是使用位图作为参考绘制的 - 将其想象为画家和画布，使用两张照片图像作为参考，将一幅图像绘制在另一幅图像之上。

# cakephp - CakePHP 2.x 中的友谊

> ID：11277974
> 
> 赞同：0
> 
> 时间：2012-06-30T21:53:11.240
> 
> 标签：cakephp, cakephp-2.0

我在使用 CakePHP 2 建立友谊时遇到了麻烦。

我有两个数据库表：**users**和**friends**。我的用户表有以下列：

*   ID
*   电子邮件
*   密码

我的朋友表有以下列：

*   ID
*   用户身份
*   朋友ID
*   得到正式认可的

我在我的用户模型中将朋友设置为 hasAndBelongsToMany 关系：

```
<?php
class User extends AppModel {
    public $hasAndBelongsToMany = array(
        'Friends' => array(
            'className' => 'User',
            'joinTable' => 'friends',
            'foreignKey' => 'user_id',
            'associationForeignKey' => 'friend_id',
            'unique' => true
        )
    );
} 
```

现在，当我尝试为用户检索好友时，它只列出指定用户发起的好友关系，即 where`user_id`等于用户 ID；它不会向我显示其他人可能发起请求的位置（即当前用户的 ID 在`friend_id`列中的位置）。

我如何获取朋友，以便记录`user_id`或`friend_id`列等于特定 ID 的记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:25:47.853

我认为您不了解 HABTM 的工作原理。阅读[本书的这一部分](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)。除了您拥有的表之外，您还需要一个 friends_users 表才能使关系正常工作。我认为，如果您要以这种方式进行设置，则需要将友谊定义为拥有并属于许多用户。

但是，我质疑您当前的设置是否需要 HABTM 关系。好像一个用户有*很多*朋友，仅此而已。研究使用这种关系，它会按照您的预期为您提供相关的 ID。不要忘记定义 Friend *belongsTo* User。

* * *

这是我的经典 Cake 2.0 友谊教程。我下载了 cakePHP 2.1，所以我有了一个全新的开始。我首先更改了我的安全盐和密码，然后添加了我的数据库连接。然后我按如下方式构建了我的数据库：

**数据库**：

`users`桌子：

```
id         | int(11)
created    | datetime
username   | varchar(255) 
```

`friendships`桌子：

```
id         | int(11)
user_from  | varchar(255)
user_to    | varchar(255)
created    | datetime
status     | varchar(50) 
```

显然，您的用户表可以/将有更多的东西，但这是我需要的最低限度。

**型号**：

好的，这是棘手的部分。这是我在用户模型中定义的关系。

```
class User extends AppModel {
/* Other code if you have it */
        var $hasMany = array(
          'FriendFrom'=>array(
             'className'=>'Friendship',
             'foreignKey'=>'user_from'
          ),
          'FriendTo'=>array(
             'className'=>'Friendship',
             'foreignKey'=>'user_to'
          )
       );
       var $hasAndBelongsToMany = array(
          'UserFriendship' => array(
              'className' => 'User',
              'joinTable' => 'friendships',
              'foreignKey' => 'user_from',
              'associationForeignKey' => 'user_to'
            )
       );
/* Again, other code */
} 
```

这是我的友谊模型：

```
class Friendship extends AppModel {
/* Other code if you have it */
    var $belongsTo = array(
      'UserFrom'=>array(
         'className'=>'User',
         'foreignKey'=>'user_from'
      ),
      'UserTo'=>array(
         'className'=>'User',
         'foreignKey'=>'user_to'
      )
   );
/* Again, other code */
} 
```

*模型注意事项*：友谊模型属于 2 个用户。用户模型有 3 个关联。User Model 中的两个 hasMany 关系都是访问 Friendship 模型数据的别名，所以我们可以使用`$this->User->FriendTo`or `$this->User->FriendFrom`from controllers 来访问 Friendship 模型。起初我将它们命名为 UserFrom 和 UserTo，反映了 Friendship 模型的设置，但 Cake 对相似之处提出了质疑，因此我不得不让它们更加不同。

**控制器和视图**：我使用 bake 实用程序烘焙控制器和视图。然后我创建了两个用户（Daniel 和 Martin），并创建了一个从 Daniel 到 Martin 的新友谊，状态为`requested`. 然后我将友谊状态更新为`confirmed`。

我创建了以下无视图自定义用户操作来演示从 UsersController 中检索有关友谊的数据：

```
public function test() {
  $data = $this->User->FriendFrom->find('all', 
    array(
      'conditions'=>array('user_from'=>1), 
      'contain'=>array('UserTo')
    )
  );
  die(debug($data));
} 
```

此查找使用 UserModel 的 hasMany 关系来访问 Friendship 模型并获取 id 为 1 的用户发起关系的关系的相关`user_from`和`user_to`数据。

**您的具体发现**：

马丁，在这个系统下，你要寻找的东西非常简单，虽然你可以用不同的方法来做，但你总是会用类似的方法来处理，只要一段关系总是有两个方面。您所要做的就是获取您的用户 ID 为 user1 或 user2 的关系列表（在我的情况下，只是为了知道谁发起了关系，我将它们存储为 user_to 和 user_from - 我认为这是吓倒你的原因）。然后我遍历整个数组，根据我是给定数组中的 user1 还是 2 来选择相关的朋友数据。这是一个非常简单的方法，我只是把它放在我的用户模型中。改变模具（调试（））；以便`return $friendslist`能够从您的控制器调用它并取回一个数组。

```
public function getFriends($idToFind) {
  $data = $this->FriendFrom->find('all', 
    array(
      'conditions'=>array(
        'OR'=> array(
            array('user_to'=> $idToFind),
            array('user_from'=> $idToFind)
        )
        )
    )
  );
  $friendslist = array();
  foreach ($data as $i) {
    if ($i['FriendFrom']['user_from'] == $idToFind){
        $friendslist[] = $i['UserTo'];
    }
    elseif ($i['FriendFrom']['user_to'] == $idToFind){
        $friendslist[] = $i['UserFrom'];
    }
  }

  die(debug($friendslist));
} 
```

# android - 使用 Adob e Flash Builder 构建的 Android 应用程序需要 STICKY BROADCAST 权限。为什么？

> ID：11277976
> 
> 赞同：1
> 
> 时间：2012-06-30T21:53:25.380
> 
> 标签：android, permissions, flash-builder, broadcast

昨天我想在 google play store 部署/发布我的第一个 Android 应用程序，但卡在需要/添加的 STICKY_BROADCAST 权限上。

应用程序的 google play store 权限选项卡上的说明：

```
SEND STICKY BROADCAST 
Allows the app to send sticky broadcasts, which remain after the broadcast ends. Malicious apps may make the tablet slow or unstable by causing it to use too much memory. Allows the app to send sticky broadcasts, which remain after the broadcast ends. Malicious apps may make the phone slow or unstable by causing it to use too much memory. 
```

我不希望用户认为我的应用程序是邪恶或缓慢的应用程序（因为我的代码中没有使用任何 STICKY_BROADCAST 功能）。我如何才能删除此权限，或者 Adob​​e Air 是否需要此权限？在 adobe 网站上只找到一篇文章（有同样的问题），但没有答案。

在 app.xml 配置中，我只定义了两个权限：

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.VIBRATE"/> 
```

我使用互联网连接来获取应用程序的一些配置。当用户点击屏幕时，我使用 adobe 示例中的振动来振动手机。

为什么在我部署/发布应用程序时需要/添加到包中的权限 SEND STICKY BROADCAST 以及我可以做些什么来避免它。或者更好：有没有办法避免这种许可？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-22T17:06:57.520

我有同样的问题，我刚刚发现它是由我与我的 apk 文件打包在一起的 adobe air 引起的。您可以告诉用户下载 adobe air 或获取更新版本的 flex。

对不起，我迟到了，我上周才开始使用 Flash。

# css - 哪个框架最适合从响应式网页设计开始？

> ID：11277978
> 
> 赞同：8
> 
> 时间：2012-06-30T21:53:51.583
> 
> 标签：css, responsive-design

我的目标是更快地启动对移动设备友好且适用于不同屏幕分辨率的网站。有CSS 经验的人可以推荐*最适合从**哪些 CSS 框架*开始：

 **   祖布基金会
*   少框架 4
*   柱状
*   引导程序
*   无框

他们每个人的*优点和缺点*是什么？随意建议任何未列出的内容。

网站建成后，我可以轻松添加*jQuery*滑块、效果或动画吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-24T23:21:37.530

我已经阅读了提到的两本书，它们都很棒。

我真的很喜欢 Zurb 基金会。我已经用它建立了几个网站，没有任何问题。我发现它很容易扩展——很容易构建一个原型然后投入全面生产。（我一直在使用第 2 版 - 有 V3 出来了 - 但是 V3 已经放弃了对 IE7 的支持）

办公室里有人在玩的一个新工具是 jetstrap.com

让您直观地进行响应式布局 - 然后您可以检查代码并了解它是如何完成的，这可能是一个很好的入门方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-30T23:16:39.733

在我看来，有一本书可以解释你可能想知道的任何事情。如果你刚开始接触响应式网页设计，我会从这个开始：

[响应式网页设计 - Ethan Marcotte](http://www.abookapart.com/products/responsive-web-design/)

据我了解，Ethan 被称为“发起运动的人”。我个人可以证明，这本书对我帮助很大。坦率地说，我什至不确定您是否需要使用框架。如果您第一次使用最佳实践编写您的网站并尽可能流畅地构建它（即使您包裹在 960 像素宽的 div 中），那么使用 CSS 媒体查询从那里向下调整大小是一件轻而易举的事。我还想看看[Luke Wroblewski 的《Mobile First](http://www.abookapart.com/products/mobile-first) 》一书。

[您甚至可以捆绑购买这些书籍。](http://www.abookapart.com/products/mobile-first-responsive-web-design-bundle) 它们是快速阅读，您可以在一个下午阅读它们。这两本书让我进入了响应式网页设计，我不建议你去看看它们！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T23:08:03.357

还有：

*   *Andy Clarke 的320 & Up*，它基于*移动优先*设计（所以，这对它有好处）- [http://stuffandnonsense.co.uk/projects/320andup/](http://stuffandnonsense.co.uk/projects/320andup/)
*   还有*Gumby*，得到了一些非常好的评价 - [http://www.gumbyframework.com/](http://www.gumbyframework.com/)

我真的帮不上忙，因为我还没有尝试这些响应式框架之一。我也想知道每个人的优缺点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-19T19:34:11.393

+1 为 Gumby 框架。在与 Gumby 和其他人合作之前，您应该了解发生了什么……因此阅读 Ethan Marcotte 的书。*

# html - css/html 使用 hr 标签的简单进度条

> ID：11277980
> 
> 赞同：2
> 
> 时间：2012-06-30T21:53:55.717
> 
> 标签：html, css, progress-bar

我正在尝试使用代表完成百分比的 HR 的 width 属性制作一个简单的进度条。这些年前我做过，但由于某种原因，我似乎无法让这个看起来正确。该网站使用表格，所以我将栏放在表格单元格中。我愿意用纯 css 来做这件事，但我希望它像几行代码一样简单，因为这个页面上有很多其他的东西必须快速加载。

我可以得到规则来显示一个漂亮的实心条。

```
<td width=200 style="border: 2px solid silver;padding:none"><hr style="color:#c00;background-color:#c00;height:15px; border:none;" align="left" width=50% /></td> 
```

其中完成百分比是在服务器端使用 php.ini 设置的。这不是需要轮询的动态栏。只有一个代表完整配置文件的百分比。

理想情况下，我希望该条填充单元格的百分比等于已完成的百分比，以便实心条显示已完成的百分比以及右侧的空白部分剩余的部分。但是，我无法在整个单元格周围找到一个漂亮的规则来填充一部分。相反，酒吧周围有很多空间。我尝试将填充设置为无，但这似乎不起作用。

这是一个jsfiddle。

[http://jsfiddle.net/GqrnC/](http://jsfiddle.net/GqrnC/)

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:00:59.990

您必须从`<hr>`（添加`margin: 0`到其样式）中删除边距以消除额外的空间：http: [//jsfiddle.net/GqrnC/1/](http://jsfiddle.net/GqrnC/1/)

```
<table>
  <tr>
    <td width=200 style="border: 2px solid silver;padding:none">
      <hr style="color:#c00;background-color:#c00;height:15px; border:none;
                 margin:0;" align="left" width=50% />
    </td>
  </tr>
</table> 
```

但是，我同意上面的评论，我认为没有任何理由为此使用 an`<hr>`而不是 a `<div>`。具有“分隔符”的`<hr>`语义，此处并非如此。div 具有中性含义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-30T22:05:53.980

这是否更符合您的需求：http: [//jsfiddle.net/GqrnC/16/](http://jsfiddle.net/GqrnC/16/)

你真的应该使用`<div>`而不是 a`<hr>`因为 a`<div>`是一个结构元素。

HTML

```
<div class='outer'>
    <div class='inner'>

    </div>
</div> 
```

CSS

```
.outer{
    border: 2px solid silver;
    width: 200px;
}
.inner{
    background-color: #c00;
    width: 50%;
    height: 5px;
} 
```

或者，我建议查看 jQuery UI[进度条](http://jqueryui.com/demos/progressbar/)。它是专门为这种情况而构建的，看起来非常棒（如果您想稍后再更新，您可以使用 AJAX 对其进行更新）。​</p>

# c - 如何从 C 程序刷新 Linux 中的 CPU 缓存？

> ID：11277984
> 
> 赞同：12
> 
> 时间：2012-06-30T21:54:27.433
> 
> 标签：c, linux, unix, caching, flush

我正在编写一个需要刷新内存的 C 程序。我想知道是否有任何 UNIX 系统命令来刷新 CPU 缓存。

这是我的项目的要求，其中涉及计算我的逻辑所花费的时间。

我已经阅读了有关该`cacheflush(char *s, int a, int b)`功能的信息，但我不确定它是否合适以及传递什么参数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T22:03:54.433

1.  我认为你的意思是“CPU缓存”，而不是内存缓存

2.  上面的链接很好：“通过 CPU 写入大量数据”的建议*不是*Windows 特定的

3.  这是同一主题的另一个变体：

    *   [如何清除 CPU L1 和 L2 缓存](https://stackoverflow.com/questions/3446138/how-to-clear-cpu-l1-and-l2-cache)
4.  这是一篇关于 Linux 和 CPU 缓存的文章：

    *   [http://lwn.net/Articles/252125/](http://lwn.net/Articles/252125/)

笔记：

在这个（非常非常低的）级别，“Linux”！=“Unix”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-04-29T10:52:47.200

这就是英特尔建议刷新缓存的方式：

```
mem_flush(const void *p, unsigned int allocation_size){
    const size_t cache_line = 64;
    const char *cp = (const char *)p;
    size_t i = 0;

    if (p == NULL || allocation_size <= 0)
            return;

    for (i = 0; i < allocation_size; i += cache_line) {
            asm volatile("clflush (%0)\n\t"
                         : 
                         : "r"(&cp[i])
                         : "memory");
    }

    asm volatile("sfence\n\t"
                 :
                 :
                 : "memory");
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-30T22:22:59.113

如果您正在编写用户模式（不是内核模式）程序，并且它是单线程的，那么您真的没有理由一开始就费心刷新缓存。您的用户模式程序可能会忘记它甚至存在；它只是为了加快程序的执行速度，而操作系统通过处理器的 MMU 对其进行管理。

我能想到的只有几个原因，您可能实际上想要从用户模式应用程序中刷新缓存：

1.  您的应用旨在在对称多处理器系统上运行，或与外部硬件进行数据交易）
2.  您只是在测试您的缓存以进行某种性能测试（在这种情况下，您可能真的应该编写测试以在内核模式下运行，也许作为驱动程序）。

无论如何，假设您使用的是 Linux...

```
#include <asm/cachectl.h>

int cacheflush(char *addr, int nbytes, int cache); 
```

这假设您有一个刚刚写入的内存块，并且您想确保它已从缓存中刷新回主内存。该块从 addr 开始，长度为 nbytes，位于两个缓存之一（或两者）中：

```
 ICACHE Flush the instruction cache.
   DCACHE Write back to memory and invalidate the affected valid cache lines.
   BCACHE Same as (ICACHE|DCACHE). 
```

通常您只需要刷新 DCACHE，因为当您将数据写入“内存”（即缓存）时，它通常是数据，而不是指令。

如果您出于某些奇怪的测试原因想要刷新“所有缓存”，您可以 malloc() 一个您知道比 CPU 缓存大的大块（射击，使其大 8 倍！），写入任何旧垃圾进入它，然后冲洗整个块。

另请参阅： [如何在 C++ 中执行缓存操作？](https://stackoverflow.com/questions/11269890/how-to-perform-cache-operations-in-c/11270096#11270096)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-30T22:51:33.873

好的，对不起我的第一个答案。我后来在您的问题下方阅读了您的后续评论，所以我现在意识到您想要刷新指令缓存以将您的程序（或其中的一部分）从缓存中引导出来，这样当您测试它的性能时，您也可以测试它的初始加载时间从主存到指令缓存。您是否还需要将代码将使用的任何数据刷新到主内存，以便数据和代码都是新加载的？

首先，我想提一下主内存本身也是一种缓存形式，您的硬盘（磁盘上的程序或磁盘上的交换空间）是程序指令可能到达的最低、最慢的地方从。也就是说，当您第一次运行例程时，如果由于靠近已执行的其他代码而尚未将其从磁盘加载到主内存中，则必须首先加载其 CPU 指令从磁盘。这比将其从主内存加载到缓存中需要一个数量级或更长的时间。然后，一旦它被加载到主存中，从主存加载到高速缓存所需的时间比从高速缓存加载到 CPU 的指令获取器所需的时间要长一个数量级。因此，如果您想测试代码的冷启动性能，您必须确定冷启动的含义……将其从磁盘中拉出，或从主内存中拉出。我不知道有任何命令可以将指令/数据从主内存中“刷新”到交换空间，因此将其刷新到主内存几乎可以做到（据我所知），但请记住即使您确实刷新了指令缓存，您的测试结果仍可能与第一次运行（当它可能将其从磁盘中拉出）到后续运行不同。

现在，如何刷新指令缓存以确保将自己的代码刷新到主存储器？

如果我需要这样做（在我看来这是非常奇怪的事情），我可能会首先找到我的函数在内存中的长度和大致位置。由于我使用的是 Linux，我会发出命令“objdump -d {myprogram} > myprogram.dump.txt”，然后我会在编辑器中打开 myprogram.dump.txt 并搜索我想要刷新的函数出，并通过使用十六进制计算器从它们的起始地址中减去它们的结束地址来计算它们的长度。我会写下每个的大小。稍后我将在我的代码中添加 cacheflush() 调用，将我想要刷新的每个函数的地址指定为“addr”，并将找到的长度指定为“nbytes”和 ICACHE。为了安全起见，我可能会稍微捏造一点，并在尺寸上增加约 10%，以防万一我对代码进行了一些调整而忘记调整 nbytes。对于我想要清除的每个函数，我都会像这样调用 cacheflush() 。然后，如果我还需要刷新数据，如果它使用全局/静态数据，我也可以刷新这些数据（DCACHE），但如果它是堆栈或堆数据，那么我可以（或应该）做任何事情来刷新超出缓存。试图这样做将是一种愚蠢的做法，因为它会创造一种在正常执行中永远不会或很少存在的条件。假设您使用的是 Linux ... 我可以（或应该）将其从缓存中清除，这实际上并不现实。试图这样做将是一种愚蠢的做法，因为它会创造一种在正常执行中永远不会或很少存在的条件。假设您使用的是 Linux ... 我可以（或应该）将其从缓存中清除，这实际上并不现实。试图这样做将是一种愚蠢的做法，因为它会创造一种在正常执行中永远不会或很少存在的条件。假设您使用的是 Linux ...

```
#include <asm/cachectl.h>

int cacheflush(char *addr, int nbytes, int cache);

...where cache is one of:
   ICACHE Flush the instruction cache.
   DCACHE Write back to memory and invalidate the affected valid cache lines.
   BCACHE Same as (ICACHE|DCACHE). 
```

顺便说一句，这是课堂作业吗？

# r - 删除 NA 值时矩阵变为类（字符）

> ID：11277985
> 
> 赞同：0
> 
> 时间：2012-06-30T21:54:28.010
> 
> 标签：r, matrix

下面的可重现示例。我有一个模拟循环，在其中我偶尔需要从矩阵中删除行。我通过在需要在特定位置删除的行中输入“NA”值来完成此操作，然后我有一行代码来删除任何带有 NA 的行。到目前为止，这非常有效。我的问题是，我现在以某种方式运行模拟，偶尔会将我的矩阵缩减为一行。然后发生这种情况，矩阵被转换为“字符”，并使模拟崩溃。

例子：

```
mat<-matrix(1:10,5,2) #setting up a simplified example matrix
mat[3:5,1]<-NA #Giving 3 rows 'NA' values, for removal of these rows
mat<-mat[!is.na(mat[,1]),] #An example where my procedure works just fine
class(mat)    
mat[2,1]<-NA #Setting 1 of the remaining 2 rows as NA
mat<-mat[!is.na(mat[,1]),] #Removing one of final two rows
class(mat) #No longer a matrix 
```

有什么方法可以做到这一点，我不会在最后丢失我的格式作为矩阵？我假设这个问题来自我使用“is.na”命令，但我还没有找到使用它的好方法。

为了更深入地了解这个问题，如果有更好的方法来做到这一点，我太天真了，还没有找到......在我的现实生活模拟中，我在矩阵中有一个列，其中包含一个'给定行中的个人活着时为 1，死亡时为 0。当一个人（单行）死亡时（并且值从“1”变为“0”），我需要删除该行。我知道如何做到这一点的唯一方法是将“0”更改为“NA”，然后删除所有带有 NA 的行。如果有一种方法可以删除特定列中带有“0”的行来避免这个问题，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:01:08.117

默认情况下，该`[`函数将输出强制转换为可能的最低维度。在您的示例中，您有一个二维数组（矩阵）：提取单行时，它被强制转换为字符向量。

为避免这种情况，请查看`drop`该功能的选项`[`。你应该这样做：

```
mat <- mat[!is.na(mat[,1]),, drop = FALSE] 
```

# c - 整数除法与常规除法

> ID：11277986
> 
> 赞同：0
> 
> 时间：2012-06-30T21:54:29.320
> 
> 标签：c, double, long-integer, sieve

我需要将循环中的整数与 a`long`和 a的商进行比较`long`。为了不进行整数除法，如果我理解正确，是否需要将其中一个长整数转换为双精度整数？

```
long prime = primes[d];
int i = 1;

//  "inputNumber / prime" should not be integer division, while it is now.
//  How do I do this yet still compare it to an "int" afterwards? 
while (i < (inputNumber / prime))
{
    primes[i*prime] = 0;
    i++;
} 
```

那是代码片段。`primes`是一个用 s 填充的数组`long`。顺便说一句，这段代码是否正确：

```
primes[i*prime] = 0; 
```

因为我担心 a`long * int`不适用于数组索引。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T21:57:02.837

为什么不`while((i * prime) < inputNumber)`呢？一个`long`乘以一个`int`结果`long`...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T21:55:53.937

您可以将整数除法的操作数之一乘以`1.0`以避免结果的整数截断。

# javascript - 如何使用 jQuery 获取焦点元素？

> ID：11277989
> 
> 赞同：378
> 
> 时间：2012-06-30T21:55:22.003
> 
> 标签：javascript, jquery, element, caret

使用 jQuery，如何获取具有插入符号（光标）焦点的输入元素？

或者换句话说，如何确定输入是否具有插入符号的焦点？

* * *

## 回答 #1

> 赞同：797
> 
> 时间：2012-06-30T21:57:55.653

```
// Get the focused element:
var $focused = $(':focus');

// No jQuery:
var focused = document.activeElement;

// Does the element have focus:
var hasFocus = $('foo').is(':focus');

// No jQuery:
elem === elem.ownerDocument.activeElement; 
```

你应该使用哪一个？引用[jQuery 文档](http://api.jquery.com/focus-selector/)：

> 与其他伪类选择器（以“：”开头的选择器）一样，建议在 :focus 前面加上标签名称或其他选择器；否则，将隐含通用选择器 ("*")。换句话说，bare`$(':focus')`等价于`$('*:focus')`. 如果您正在寻找当前聚焦的元素，$( document.activeElement ) 将检索它而无需搜索整个 DOM 树。

答案是：

```
document.activeElement 
```

如果你想要一个包装元素的 jQuery 对象：

```
$(document.activeElement) 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-06-30T21:57:52.110

```
$( document.activeElement ) 
```

无需按照[jQuery 文档中的建议搜索整个 DOM 树即可检索它](http://api.jquery.com/focus-selector/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-20T15:24:51.950

我在 Firefox、Chrome、IE9 和 Safari 中测试了两种方法。

(1)。`$(document.activeElement)`在 Firefox、Chrome 和 Safari 中按预期工作。

(2)。`$(':focus')`在 Firefox 和 Safari 中按预期工作。

我移动到鼠标中输入“名称”并在键盘上按 Enter，然后我试图获得焦点元素。

(1)。`$(document.activeElement)`在 Firefox、Chrome 和 Safari 中按预期返回 input:text:name，但在 IE9 中返回 input:submit:addPassword

(2)。`$(':focus')`在 Firefox 和 Safari 中按预期返回 input:text:name，但在 IE 中没有

```
<form action="">
    <div id="block-1" class="border">
        <h4>block-1</h4>
        <input type="text" value="enter name here" name="name"/>            
        <input type="button" value="Add name" name="addName"/>
    </div>
    <div id="block-2" class="border">
        <h4>block-2</h4>
        <input type="text" value="enter password here" name="password"/>            
        <input type="submit" value="Add password" name="addPassword"/>
    </div>
</form> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-30T22:00:19.047

试试这个：

```
$(":focus").each(function() {
    alert("Focused Elem_id = "+ this.id );
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-08T02:45:54.413

怎么没人提。。

```
document.activeElement.id 
```

我使用的是 IE8，还没有在任何其他浏览器上测试过。在我的例子中，我使用它来确保一个字段至少有 4 个字符，并且在行动之前集中注意力。一旦你输入第四个数字，它就会触发。该字段的 id 为“年份”。我在用..

```
if( $('#year').val().length >= 4 && document.activeElement.id == "year" ) {
    // action here
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-06T14:38:09.700

`$(':focus')[0]`会给你实际的元素。

`$(':focus')`会给你一个元素数组，通常一次只关注一个元素，所以如果你以某种方式关注多个元素，这只会更好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-12-20T08:21:56.673

试试这个：：

```
$(document).on("click",function(){
    alert(event.target);
    }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-14T15:32:51.397

如果您想确认焦点是否与元素有关，那么

```
if ($('#inputId').is(':focus')) {
    //your code
} 
```

# ruby-on-rails - 动态预设开发和生产环境的url

> ID：11277992
> 
> 赞同：2
> 
> 时间：2012-06-30T21:56:10.100
> 
> 标签：ruby-on-rails, heroku

我正在为我的站点在 rails 和`password_reset.text.erb`我当前发送的邮件文件中创建密码重置功能

`http://localhost:3000/password_resets/<%=@user.password_reset_token%>/edit/`

在我的开发环境中。如果令牌与保存的模型匹配，这将点击我的控制器进行密码重置并重定向用户以编辑密码。

但是，我想动态配置它，所以当我部署到 heroku 时，它会知道将其更改为`mywebsite.com/password_resets/...`

我该怎么做？

编辑：

```
def password_reset(user)
    @user = user
    mail(to: user.email, subject: "Bitelist Password Reset")
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:11:34.447

Typically I configure the host information for the mailer in an appropriate `config/environment` file.

```
config.action_mailer.default_url_options = { :host => "example.com" } 
```

You can take a look at the "Generating URLs" section of this page: [http://rails.rubyonrails.org/classes/ActionMailer/Base.html](http://rails.rubyonrails.org/classes/ActionMailer/Base.html)

With that configuration set typical routing structures seem to work quite nicely. I am not 100% positive what routes will be available in your situation so you may still need to construct the full URL somewhat manually to include the reset token component.

To generate the actual URLs you can potentially use named routes if your routes are set up in a way that you have a named route that takes a user token. i.e.

```
<%= edit_password_resets_url(@user.password_reset_token) %> 
```

If you do not have the token integrated into an existing route you may need to manually build the URL:

```
<%= "#{url_for(:controller => 'password_resets', :action => 'whatever_action_this_is')}/#{@user.password_reset_token}/edit/" %> 
```

or even build it completely manually using `default_url_options[:host]` and then add the rest that you have above.

If need be you could also set the host at request time although that may be overkill (and will not be thread safe).

```
def set_mailer_host
  ActionMailer::Base.default_url_options[:host] = request.host_with_port
end 
```

# c++ - 用于 GPS 系统的 Dijkstra 算法的更快替代方案

> ID：11277993
> 
> 赞同：5
> 
> 时间：2012-06-30T21:56:14.280
> 
> 标签：c++, c, algorithm, gps, dijkstra

如果涉及到算法，以及我为游戏制作的插件，我是一个真正的速度狂。

速度……有点……不满意。尤其是当你开车四处行驶并且你没有按照自己的路径行驶时，必须重新计算路径..这需要一些时间，所以游戏中的 GPS 会堆积许多“错误的方式”信号（并堆积信号之后意味着更多的计算，对于每一个错误的方向移动），因为我想要一个快速、实时的 gps 系统，它会不断更新。

我将旧算法（一些简单的 dijkstra 实现）更改为 boost::dijkstra 以计算从节点 A 到节点 B 的路径

（总节点列表大约是 ~15k 节点，有 ~40k 连接，对于好奇的人，这里是地图： http: [//gz.pxf24.pl/downloads/prv2.jpg](http://gz.pxf24.pl/downloads/prv2.jpg) (12 MB)，红线中的边是节点),

但它并没有真正提高速度。（至少不明显，可能是 50 毫秒）。

存储在 Node 数组中的信息是：

```
The ID of the Node,
The position of the node,
All the connections to the node (and which way it is connected to the other nodes, TO, FROM, or BOTH)
Distance to the connected nodes. 
```

我很好奇是否有人知道 C/C++ 中的一些更快的替代方案？任何建议（+代码示例？）表示赞赏！

* * *

如果有人对该项目感兴趣，这里是（源代码+二进制文件）：

[https://gpb.googlecode.com/files/RouteConnector_177.zip](https://gpb.googlecode.com/files/RouteConnector_177.zip)

在此视频中，您可以看到 gps 系统是什么样的：

[http://www.youtu.be/xsIhArstyU8](http://www.youtu.be/xsIhArstyU8)

如您所见，红色路线更新缓慢（嗯，对于我们 - 游戏玩家 - 它很慢）。

（ByTheWay：红线之间的差距很久以前就已经修复了：p）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:37:15.023

由于这是一个 GPS，它必须有一个固定的目的地。每次更改当前节点时，无需计算从当前节点到目的地的路径，而是可以找到从目的地到所有节点的最短路径：只需从目的地开始运行一次 Dijkstra。这将花费大约与现在进行更新一样长的时间。

然后，在每个节点中，保留`prev = the node previous to this on the shortest path to this node`（从您的目的地）。在计算最短路径时更新它。或者您可以在节点之外使用`prev[]`数组 - 基本上您现在用来重建路径的任何方法都应该仍然有效。

移动汽车时，您的路径由 给出`currentNode.prev -> currentNode.prev.prev -> ...`。

这将解决更新滞后问题并保持最佳路径，但进入目的地时仍会有轻微滞后。

即使您计划使用 A* 或其他不总是给出最佳答案的启发式方法，您也应该考虑这种方法，至少如果您仍然落后于这些方法。

例如，如果您有此图表：

```
1 - 2 cost 3
1 - 3 cost 4
2 - 4 cost 1
3 - 4 cost 2
3 - 5 cost 5 
```

`prev`数组看起来像这样（在计算距离时计算）`d[]`：

```
 1 2 3 4 5
prev = 1 1 1 2 3 
```

意义：

```
shortest path FROM TO 
                 1  2 = prev[2], 2 = 1, 3
                 1  3 = prev[3], 3 = 1, 3
                 1  4 = prev[ prev[4] ], prev[4], 4 = 1, 2, 4 (fill in right to left)
                 1  5 = prev[ prev[5] ], prev[5], 5 = 1, 3, 5 
                 etc. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T04:07:08.950

要立即开始，您可以通过以下方式作弊。

拥有相当少的“主要通道节点”。为每个节点定义其“邻居”（一定距离内的所有节点）。存储从每个主要通道节点到其他每个节点的最短路线。存储往返每个节点到其主要通道的最短路线。

如果两个节点在同一个邻域中，您可以即时计算最佳答案。否则只考虑“这里到我附近的主要通道节点到它附近的主要通道”形式的路线。由于您已经预先计算了这些，并且组合数量有限，您应该能够很快地计算出飞行路线。

然后挑战变成了选择一组主要的通道节点。它应该是大多数好的路线都应该经过的一组相当小的节点——所以要经常沿着主要街道选择一个节点。几百张的清单对您的地图来说应该已经足够了。

# c# - 如何将 pictureBox1 中的当前帧/图像保存到位图文件？

> ID：11277994
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:56:16.280
> 
> 标签：c#, .net, picturebox

在 Form1 的顶部，我做了：`Bitmap bmp;`在绘制事件中，我正在绘制文件`pictureBox`和`bmp`文件：

```
private void pictureBox1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
{
    SolidBrush brush;
    Pen p = null;
    Point connectionPointStart;
    Point connectionPointEnd;
    Graphics g = e.Graphics;
    bmp = new Bitmap(pictureBox1.Width, pictureBox1.Height);
    Graphics bitmapGraphics = Graphics.FromImage(bmp);
    //g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;

    moveCounter++;
    label6.Text = moveCounter.ToString();

    brush = new SolidBrush(Color.Red);
    p = new Pen(brush);
    for (int idx = 0; idx < wireObject1._point_X.Count; ++idx)
    {
        Point dPoint = new Point((int)wireObject1._point_X[idx], (int)wireObject1._point_Y[idx]);
        dPoint.X = dPoint.X - 5; // was - 2
        dPoint.Y = dPoint.Y - 5; // was - 2
        Rectangle rect = new Rectangle(dPoint, new Size(10, 10));
        g.FillEllipse(brush, rect);
        bitmapGraphics.FillEllipse(brush, rect);

        // g.FillEllipse(brush, rect);
    }

    for (int i = 0; i < wireObject1._connectionstart.Count; i++)
    {
        int startIndex = wireObject1._connectionstart[i];
        int endIndex = wireObject1._connectionend[i];

        connectionPointStart = new Point((int)wireObject1._point_X[startIndex], (int)wireObject1._point_Y[startIndex]);
        connectionPointEnd = new Point((int)wireObject1._point_X[endIndex], (int)wireObject1._point_Y[endIndex]);
        p.Width = 2;
        g.DrawLine(p, connectionPointStart, connectionPointEnd);
        bitmapGraphics.DrawLine(p, connectionPointStart, connectionPointEnd);
    }
} 
```

我在绘制事件中为 bmp 文件做了一个新实例。我还为 bmp 文件创建了一个新的图形变量。我在pictureBox中绘制或填充椭圆的每个地方我也将它绘制到bmp文件中。

现在在我做的保存功能中：

```
private void SavePictureBoxToBitmap()
{
    //PbToBitmap++;
    //String tempFile = @"d:\PictureBoxToBitmap\" + PbToBitmap.ToString("D6") + bmp;
    bmp.Save(@"d:\PictureBoxToBitmap\bit.bmp");
} 
```

如果我在做 bmp.Save ，它会在硬盘上保存一个白色的 bmp 文件，里面只有图纸。如果我在做pictureBox1.Image.Save，它会在硬盘上保存一个文件，里面只有pictureBox中的图片，没有图纸。

我怎样才能将它结合起来，这样我就可以创建一个保存行/命令，它会在硬盘上创建一个带有pictureBox图像和图纸的bmp文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:03:11.097

当你想在 Image 上绘制一些东西时，使用静态函数 FromBitmap 创建一个 Graphics 元素：

```
Graphics gfx = Graphics.FromImage(pictureBox1.Image) 
```

然后使用 gfx 实例在图片框上绘制东西，例如 gfx.DrawLine。

然后保存它，使用 pictureBox1.Image.Save 函数。

**更新**

你的代码对我来说有点太神秘了，但我做了一个简单的例子可以回答你的问题。我创建了一个newq空窗体，添加了一个图片框，然后实现了Paint功能。

```
 private void pictureBox1_Paint(object sender, PaintEventArgs e)
    {
        Graphics gfx = Graphics.FromImage(pictureBox1.Image);
        gfx.DrawLine(new Pen(Color.Red, 5), new Point(10, 10), new Point(20, 20));
        gfx.DrawLine(new Pen(Color.Red, 5), new Point(20, 10), new Point(10, 20));
        pictureBox1.Image.Save("test.jpg", System.Drawing.Imaging.ImageFormat.Jpeg);
        pictureBox1.Refresh(); // The file will be correct without this, but the update will not be shown
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-25T19:51:28.347

```
using (var bmp = new Bitmap(panel1.Width, panel1.Height))
{
pictureBox1.DrawToBitmap(bmp, new Rectangle(0, 0, bmp.Width, bmp.Height));
bmp.Save("output.png", System.Drawing.Imaging.ImageFormat.Jpeg);
} 
```

应该管用