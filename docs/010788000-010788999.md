# StackOverflow 问答 10788000-10788999

# c# - c# windows应用程序安装后崩溃

> ID：10788007
> 
> 赞同：1
> 
> 时间：2012-05-28T16:50:42.417
> 
> 标签：c#, visual-studio-2010, visual-studio

我最近用 Visual Studio 2010 开发了 ac# windows 应用程序。我的应用程序由 2 个项目组成，主要项目和一个安装项目。

在我的 PC 和笔记本电脑中，一切正常（我都安装了 vs2010）。我安装应用程序并运行它没有问题。

问题是，在其他机器上安装后，我运行该应用程序，几秒钟后我收到以下消息：

```
Signature problem:
 Problem Event Name: CLR20r3
 Signature problem 01: "myapplication_name".exe
 Signature problem 02: 1.0.0.0
 Signature problem 03: 4fc25af5
 Signature problem 04: System.Data.SqlServerCe
 Signature problem 05: 3.5.1.0
 Signature problem 06: 4b743b2d
 Problem Signature 07: 49e
 Signature problem 08: 25
 Signature problem 09: System.AggregateException
 OS Version: 6.1.7601.2.1.0.256.1
 Locale ID: 1033
 Additional Information 1: 4be7
 Additional Information 2: 4be78fdd727e4350d8f2189583321f8d
 Additional Information 3: ee32
 Additional Information 4: ee3246da456e2a0eb853eb97402fe5f6

 Reading the statement our privacy while you're online:
 http://go.microsoft.com/fwlink/?linkid=104288&clcid=0x0408

 If online privacy statement is not available, read the privacy statement offline:
 C: \ Windows \ system32 \ el-GR \ erofflps.txt 
```

有谁知道为什么会这样？先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:54:30.363

看起来它在目标 PC 上找不到 SQL Server Compact Edition。您需要在安装程序中添加对它的引用

这有帮助吗？：

*   [MSDN：如何：使用应用程序部署 SQL Server Compact 3.5 数据库](http://msdn.microsoft.com/en-us/library/aa983326%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:58:01.497

好的，我想通了。您对 SQL CE 的看法是正确的。我在第一个项目中将其作为先决条件，但在设置项目中没有！非常感谢您的帮助

# javascript - 按钮而不是选择

> ID：10788011
> 
> 赞同：0
> 
> 时间：2012-05-28T16:50:56.990
> 
> 标签：javascript, google-maps, select, button, input

我在一个网站上工作，我想使用图标来选择旅行模式，我有一个工作功能，但它只适用于选择输入。有没有办法修改它以与按钮一起使用？

提前致谢！

功能：

```
function calcRoute() {
  var selectedMode = document.getElementById("mode").value;
  var request = {
      origin: thuis,
      destination: kabk,
      // Note that Javascript allows us to access the constant
      // using square brackets and a string value as its
      // "property."
      travelMode: google.maps.TravelMode[selectedMode]
  };
  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
    }
  }); 
```

HTML - 选择输入

```
<select id="mode" onchange="calcRoute();">
    <option value="DRIVING">Driving</option>
    <option value="WALKING">Walking</option>
</select> 
```

HTML - 按钮输入 (?)

```
<form id="mode">
    <input type="button" onchange="calcRoute();" value="DRIVING">
    <input type="button" onchange="calcRoute();" value="WALKING">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:56:26.720

按钮没有`onchange`事件。改用`onclick`事件

```
<form id="mode">
    <input type="button" onclick="calcRoute(this);" value="DRIVING" />
    <input type="button" onclick="calcRoute(this);" value="WALKING" />
</form> 
```

**编辑** 你必须调整你的`calcRoute`功能

从

```
function calcRoute() {
   var selectedMode = document.getElementById("mode").value;
   //... 
```

到

```
function calcRoute(btn) {
    var selectedMode = btn.value;
    // ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T16:59:08.450

```
function calcRoute(ev) {
    var ev = ev || window.event,
        btn = (ev.target || ev.srcElement);
    var selectedMode = btn.value;  //"this" will return the element in the demo
    var request = {
        origin: thuis,

<form id="mode">
            <!--Use onClick-->
    <input type="button" onclick="calcRoute(ev);" value="DRIVING" />
    <input type="button" onclick="calcRoute(ev);" value="WALKING" />
</form> 
```

![这应该适合你。](../Images/9f434438fbca4c64141ec64eef268238.png) `:)` **工作演示：http: ** [//jsfiddle.net/DerekL/T7NrF/](http://jsfiddle.net/DerekL/T7NrF/)

# github - IntelliJ IDEA 任务与 github 集成

> ID：10788012
> 
> 赞同：17
> 
> 时间：2012-05-28T16:50:58.067
> 
> 标签：github, intellij-idea, task, issue-tracking

有没有人成功完成这项工作？我已仔细按照说明进行操作，但无法让我的 IDEA 任务与我在 github 上的问题列表同步。在项目设置中，我启用了缓存以每五分钟同步一次问题，并且在服务器配置中，当我点击“测试”时，连接成功。这个功能真的有用吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-30T19:52:09.113

**我设法让它工作**

以下是 Intellij 中所需的步骤：

1.  设置 | 任务 | 服务器...
2.  添加具有以下详细信息的服务器

    *   用户名 = GitHub 用户名
    *   密码 = GitHub 密码
    *   存储库作者 = GitHub 用户名
    *   Repository = 项目名称（例如“MultiBitMerchant”）点击测试

如果一切顺利，您将获得成功，失败通常是 401，这意味着您在上面添加了一些奇怪的东西。

要检查您是否正在针对您的问题进行同步，请在 GitHub 上创建一个问题（如果您还没有）。

1.  在 Intellij 中，选择工具 | 任务和上下文 | 打开任务...
2.  使用 CTRL + Space（或等效项）获取任务列表
3.  选择一个然后单击确定
4.  根据任务进行更改（专注于其要求）
5.  提交（并推送）以查看您的问题参考作为提交评论放置，以便于跟踪

希望这可以帮助。

# c - 创建（分离）的线程从未执行

> ID：10788014
> 
> 赞同：0
> 
> 时间：2012-05-28T16:51:13.277
> 
> 标签：c, pthreads

我写了这段代码：

```
void* th (void* arg)
{
    sleep(1);
    for(int i=0; i<1000;i++)
    {
    fprintf(stderr,"%d\t",i);
    }
    pthread_exit(NULL);
}

int main(int argc, char** argv)
{
    pthread_t thread;
    pthread_attr_t attr;
    pthread_attr_init(&attr);
    pthread_attr_setdetachstate(&attr,PTHREAD_CREATE_DETACHED);
    pthread_create(&thread,&attr,th,NULL);
    pthread_attr_destroy(&attr);
    return 0;
} 
```

分离状态应该使线程不可加入，因此即使在主进程终止后它也应该运行。但它不打印数字，我所看到的只是线程终止而没有向stderr打印任何内容。
为什么不执行分离的线程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T16:56:10.853

`return`来自线程的A`main`相当于`exit`整个进程的 A，因此您的进程将在您的线程甚至可以打印任何内容之前退出。`pthread_exit`改为使用终止该线程。

# google-docs-api - 预排序的条目列表

> ID：10788019
> 
> 赞同：1
> 
> 时间：2012-05-28T16:51:34.213
> 
> 标签：google-docs-api

我想从服务器接收按标题排序的文档和文件夹列表。为此，我在 http 请求中指定了值为“title”的参数“orderby”。我得到以下回复：

```
<errors xmlns='http://schemas.google.com/g/2005'><error><domain>GData</domain><code>NotImplementedException</code><internalReason>The field orderby is not supported in this request version.</internalReason></error></errors> 
```

我还将协议版本指定为 v 3.0。可能有什么问题？

# eclipse - m2e 给出了难以理解的“项目读取错误”

> ID：10788023
> 
> 赞同：14
> 
> 时间：2012-05-28T16:52:00.067
> 
> 标签：eclipse, maven, m2e, amazon-elastic-beanstalk

我刚开始使用 m2e 尝试构建示例 travellog elastic beanstalk 项目。在控制台上，我收到“[ERROR] 项目读取错误”。

这在“依赖层次结构”选项卡上也显示为红色。

这是什么意思，我如何找到更多详细信息？

**编辑：添加 pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>BeanstalkTest</groupId>
  <artifactId>BeanstalkTest</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>war</packaging>

    <dependencies>
        <dependency>
            <groupId>com.amazonaws</groupId>
            <artifactId>aws-java-sdk</artifactId>
            <version>[1.0.007,)</version>
        </dependency>
    </dependencies>

</project> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-29T02:11:56.483

行。所以我想我想通了。

在 workspace\.metadata 中有日志文件，例如 .log 我的有这个条目：

```
!ENTRY org.eclipse.m2e.logback.appender 4 0 2012-05-28 18:50:44.641
!MESSAGE Project read error 
```

你可以进去看看：

工作区\.metadata\.plugins\org.eclipse.m2e.logback.configuration

查找 m2e 的日志文件，例如 0.log

这些非常详细和有用。无论如何，我的日志文件有这个条目：

```
2012-05-28 18:50:44,640 [Worker-52] ERROR o.e.m.editor.pom.DependencyTreePage - Project read error
org.eclipse.core.runtime.CoreException: Project read error
    at org.eclipse.m2e.core.embedder.MavenModelManager.readDependencyTree(MavenModelManager.java:230) ~[na:na]
    at org.eclipse.m2e.editor.pom.MavenPomEditor.readDependencyTree(MavenPomEditor.java:701) ~[na:na]
    at org.eclipse.m2e.editor.pom.DependencyTreePage$1.run(DependencyTreePage.java:215) ~[na:na]
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) [org.eclipse.core.jobs_3.5.101.v20120113-1953.jar:na]
Caused by: org.sonatype.aether.collection.DependencyCollectionException: Failed to collect dependencies for [com.amazonaws:aws-java-sdk:jar:[1.0.007,) (compile)]
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:262) ~[na:na]
    at org.sonatype.aether.impl.internal.DefaultRepositorySystem.collectDependencies(DefaultRepositorySystem.java:345) ~[na:na]
    at org.eclipse.m2e.core.embedder.MavenModelManager.readDependencyTree(MavenModelManager.java:226) ~[na:na]
    ... 3 common frames omitted
Caused by: org.sonatype.aether.resolution.VersionRangeResolutionException: Failed to resolve version range for org.codehaus.jackson:jackson-mapper-asl:jar:[1.8.): Invalid version range [1.8.), single version must be surrounded by []
    at org.apache.maven.repository.internal.DefaultVersionRangeResolver.resolveVersionRange(DefaultVersionRangeResolver.java:114) ~[na:na]
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.process(DefaultDependencyCollector.java:378) ~[na:na]
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.process(DefaultDependencyCollector.java:533) ~[na:na]
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:243) ~[na:na]
    ... 5 common frames omitted
Caused by: org.sonatype.aether.version.InvalidVersionSpecificationException: Invalid version range [1.8.), single version must be surrounded by []
    at org.sonatype.aether.util.version.GenericVersionRange.<init>(GenericVersionRange.java:84) ~[na:na]
    at org.sonatype.aether.util.version.GenericVersionScheme.parseVersionRange(GenericVersionScheme.java:40) ~[na:na]
    at org.sonatype.aether.util.version.GenericVersionScheme.parseVersionConstraint(GenericVersionScheme.java:66) ~[na:na]
    at org.apache.maven.repository.internal.DefaultVersionRangeResolver.resolveVersionRange(DefaultVersionRangeResolver.java:109) ~[na:na]
    ... 8 common frames omitted 
```

因此，aws-java-sdk 依赖项的定义似乎存在问题。它指定 jackson-mapper-asl 可以是版本 [1.8.)，这似乎是无效的语法。

如果我修改 pom.xml 以排除该依赖项，它将变为：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>BeanstalkTest</groupId>
  <artifactId>BeanstalkTest</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>war</packaging>

    <dependencies>
        <dependency>
            <groupId>com.amazonaws</groupId>
            <artifactId>aws-java-sdk</artifactId>
            <version>[1.0.007,)</version>
             <exclusions>
                <exclusion>
                    <groupId>org.codehaus.jackson</groupId>
                    <artifactId>jackson-mapper-asl</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>

</project> 
```

这不会产生“项目读取错误”。所以，基本上有两件事：

1.  日志文件如上所示，并且
2.  aws-java-sdk依赖的定义好像有问题

谢谢卢卡。

# ios5 - 我正在尝试编写一个简单的游戏，其中当球移动到某个区域时，视图会变为另一个视图（下一级）

> ID：10788024
> 
> 赞同：1
> 
> 时间：2012-05-28T16:52:01.403
> 
> 标签：ios5, xcode4, storyboard

```
 if(CGRectIntersectsRect(ball.frame, transitionArea.frame))
{
    FirstLevel2ViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"firstlevel2"];
    [self.navigationController pushViewController:controller animated:NO];

} 
```

这是我的代码，但是当球与过渡区域相交时，什么也没有发生我在 Xcode 4 上使用故事板，我对它比较陌生

我尝试了很多东西，但都没有奏效，所以任何帮助都会很棒，谢谢！

# qt - qlabel 的 mouseReleaseEvent() 不能正常工作

> ID：10788026
> 
> 赞同：0
> 
> 时间：2012-05-28T16:52:02.700
> 
> 标签：qt, qlabel

我有一个 qlabel 小部件，我正在覆盖 mouseReleaseEvent() 它工作但不正确它只接受小部件高度一半的 mouseReleaseEvent，就像在 100% 高度的比例中它只适用于 40% 我的意思是它没有't 覆盖整个 qlabels 的正方形（100x100）区域。

这是在 MAIN.CPP

```
QLabel sample(&Parent);//parent is just QWidget object
sample.resize(89,89);
sample.move( (Parent.width()/2 - sample.width()/2), (Parent.height()/2 - sample.height()/2));
sample.setStyleSheet("QLabel{background-color:red;}");

label mylabel(&Disc);
sample.setMouseTracking(TRUE); 
```

这是在 LABEL.CPP 中

```
void label::mouseReleaseEvent(QMouseEvent *event)
{
    QMessageBox msgBox;
    msgBox.setText("Clicked()");
    msgBox.exec();
} 
```

似乎没有什么太大的问题，但它不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:00:42.250

问题的一部分是您正在创建“QLabel”而不是“标签”。所以当然 QLabel 在鼠标释放时不会做任何事情。在子类中，鼠标释放对我来说非常好：

```
#include <QtGui>

class Label : public QLabel
{
protected:
    void mouseReleaseEvent(QMouseEvent *)
    {
        qDebug() << "released";
    }
};

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    Label label;
    label.setText("Hello");

    label.show();
    return app.exec();
} 
```

看起来您的标签（不是 QLabel，而是子类）可能显示在其他东西后面。如果是这种情况，您应该使用 QLayout。

# haskell - 显示在字符串而不是 id 函数上？

> ID：10788030
> 
> 赞同：4
> 
> 时间：2012-05-28T16:52:19.813
> 
> 标签：haskell

有人可以向我解释为什么 string 上的**show**函数不是**id**函数吗？例如

`show (show 42)`将返回`"\"42\""`奇怪的东西，对我来说不是直觉的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T16:59:40.567

`show``toString`如果它只是将某些内容转换为任意字符串（如在 Java 中），它就不是很有用。*如果结果既*易于阅读又易于机器阅读，它会更有用，因此常见的用途`show`是生成您正在输入的值的序列化表示`show`，以便您可以再次使用`read`, 以及，对于 , 的大多数实现`show`，这样您就可以`show`在 Haskell REPL 中键入 n的字符串，`ghci`然后取回反序列化的值。

所以，如果你有一个像`"42"`,`show`这样的字符串，你想得到字符串`"\"42\""`，因为当你输入`42`（`ghci`并且等效地使用`read`函数）时，你会得到一个数字，而当你输入`"42"`时`ghci`，你会得到你想要的字符串.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T16:55:03.760

因为`read`是 的倒数`show`。所以我应该总是能够`read`得到结果`show`，并取回一个字符串。

```
> (read "42")::String
"*** Exception: Prelude.read: no parse
> (read "\"42\"")::String
"42" 
```

# android - 在 AppWidgetProvider 中如何以及在何处存储持久对象（如 db 适配器）？

> ID：10788031
> 
> 赞同：0
> 
> 时间：2012-05-28T16:52:27.723
> 
> 标签：android, persistence, broadcastreceiver, appwidgetprovider

我正在开发主屏幕小部件，并且正在使用 android sqlite 数据库。我`DBAdapter`用简单的方法（添加、删除、获取记录...）实现了一个简单的类来处理数据库工作。它有效，但现在我正在考虑如何做到这一点的最佳方法。

对我来说最大的问题是如何（以及在​​哪里）存储我的 DBAdapter 的实例。如果我使用 Activity，那将非常简单——我将在`onCreate`方法中创建我的 DBAdapter 的实例，一切都很好。但是现在我没有这样的选择，因为我正在使用`AppWidgetProvider`并且很少`IntentServices`. `AppWidgetProvider`(BroadcastReceiver) 只存在一定的时间 - 在`onReceive`方法执行期间。`IntentService`在完成必要的工作后也“结束”。那么如何以及在哪里存储我的 DBAdapter 的实例？我不想每次都创建新的 DBAdapter 实例。

我在考虑这个选项：制作 DBAdapter 单例类或使用静态类和方法，另一个选项是使用 Gson 将 DBAdapter 存储到 sharedPreferences，或者使用序列化。但我更想问。这样做的正确方法是什么？多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T16:59:53.077

> 对我来说最大的问题是如何（以及在​​哪里）存储我的 DBAdapter 的实例。

专业提示：`Adapter`当类不继承自`android.widget.Adapter`.

> 我不想每次都创建新的 DBAdapter 实例。

欢迎您将其设为单例/静态数据成员。但是，一旦您的进程终止，它就会消失，无论如何您都需要再次创建一个新进程。因此，我建议您在`IntentService`. “`DBAdapter`使用简单的方法（添加、删除、获取记录......）”实例化应该非常便宜。

> 另一种选择是使用 Gson 将 DBAdapter 存储到 sharedPreferences，或者使用序列化

这是没有意义的。a 中唯一有价值的数据`DBAdapter`应该是`SQLiteOpenHelper`（或`SQLiteDatabase`来自其他来源），它本身不能被持久化。此外，这可能比仅仅创建一个新的`DBAdapter`.

# powershell - 我启动 powershell 控制台的方式有什么不同？

> ID：10788040
> 
> 赞同：2
> 
> 时间：2012-05-28T16:53:06.473
> 
> 标签：powershell, module, launch, launcher, snap-in

我使用 Sharepoint，我需要在我的控制台主机中存在 Sharepoint 管理单元。当我从 Windows 开始菜单运行 powershell 时，我运行命令

```
Add-PSSnapin Microsoft.Sharepoint.Powershell 
```

管理单元添加正常，一切正常。

此外，一切正常，当我运行 cmd.exe 并键入`powershell.exe`它并按 Enter 键时。所以我认为这个问题不涉及快捷参数（但我不是 100% 确定 :)）。

但是，当我通过某个启动器启动 powershell（我已经测试了[Launchy](http://www.launchy.net/)和[Enso](http://humanized.com/enso/launcher/)）并尝试添加相同的管理单元时，它会失败并显示以下错误消息：

```
Add-PSSnapin : No snap-ins have been registered for Windows PowerShell version 2.
At somefile.ps1:7 char:14
+     Add-PSSnapin <<<<  Microsoft.Sharepoint.Powershell
+ CategoryInfo          : InvalidArgument:(Microsoft.Sharepoint.Powershell:String)     
[Add-PSSnapin], PSArgumentException
+ FullyQualifiedErrorId : 
AddPSSnapInRead,Microsoft.PowerShell.Commands.AddPSSnapinCommand 
```

当我用启动器启动 powershell 时有什么区别？

我认为这不是与共享点相关的问题，而是 powershell 问题。

（注意：我知道 Sharepoint 管理外壳，问题不在于它）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T16:58:52.107

不确定 100%，但您可能会遇到 PowerShell 32 位与 PowerShell 64 位的问题。

例如，如果您的 SnapIn 是 64 位，则它只能与 PowerShell 64 位一起使用。如果*Launchy*和*Enso*是 32 位，则它们会启动 powerShell 32 位，以查找 32 位 SnapIn。另一边也是一样。

**从 64 位进程中**，您可以强制使用 PowerShell 64 位，方法是：

```
c:\windows\system32\WindowsPowerShell\v1.0\powershell.exe 
```

**从 64 位进程中**，您可以强制使用 PowerShell 32 位，方法是：

```
c:\windows\syswow64\WindowsPowerShell\v1.0\powershell.exe 
```

**从 32 位进程中**，您可以使用 PowerShell 64 位强制使用（阅读[此](http://support.microsoft.com/kb/942589/en-us)内容）：

```
c:\windows\sysnative\WindowsPowerShell\v1.0\powershell.exe 
```

# mootools - 如何在 mootools 中添加附加到 mouseleave 的变形的 onComplete 事件？

> ID：10788041
> 
> 赞同：1
> 
> 时间：2012-05-28T16:53:08.580
> 
> 标签：mootools, mouseleave

这是我的代码：

```
$('myButton').addEvents({
    mouseenter: function(){
       $('myImage').setStyle('display','block');
       $('myImage').morph({
            'duration': 500,
            'transition': Fx.Transitions.Sine.in,
            'opacity': 1,
            'top': -205
       });
    },
    mouseleave: function(){
       $('myImage').morph({
            'opacity': 0,
            'top': -175,
            'onComplete': hidemyImage
       });
    }   
});

function hidemyImage() {
    $('myImage').setStyle('display','none') 
} 
```

**mouseleave**中的**onComplete**无法按预期工作......当我离开 myButton 时它会立即隐藏图像，而不是在变形完成后隐藏它......我尝试了几种解决方案，但到目前为止都没有奏效。任何想法/帮助？提前致谢！

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:01:53.643

您需要使用实例而不是直接传递 morph 函数中的东西，这需要属性来 morph 并且它可能会立即运行您的函数，希望它会返回一个属性值。你可以`el.set('morph', {onComplete: hideImagefn})`在那之前做，它会起作用，但请继续阅读......

一种方法是设置一次变形选项/实例，然后像这样使用它：

```
(function() {
    var img = document.id('myImage').set('morph', {
        duration: 500,
        transition: Fx.Transitions.Sine.in,
        link: 'cancel',
        onStart: function() {
            this.element.setStyle('display', 'block');
        }
    }), fx = img.get('morph');

    // of you can just do var fx = new Fx.Morph(img, { options});

    document.id('myButton').addEvents({
        mouseenter: function(){
           fx.start({
                opacity: 1,
                top: -205
           });
        },
        mouseleave: function(){
            fx.addEvent('complete', function() {
                this.element.setStyle('display', 'none');
                this.removeEvents('complete');
            }).start({
                opacity: 0,
                top: -175
           });
        }   
    });

})(); 
```

start 确保它在鼠标悬停时始终可见，链接被取消，这意味着如果您过早将鼠标移出，它将停止执行，如果您执行 mouseout，它将隐藏图像并删除 onComplete 事件，以便如果您再次显示它，当它进入视野时保持可见。

如果你不打算把它带回来，你可以更好地清理，甚至使用诸如等之类的事件伪类`onComplete:once`——尽管那是来自 mootools-more 的 Event.Pseudos 的一部分。

一般来说 - `.get`/ `.set`morph 是你的设置。`el.morph()`将值传递给`morphInstance.start()`

在这里玩：http: [//jsfiddle.net/dimitar/NkNHX/](http://jsfiddle.net/dimitar/NkNHX/)**

# design-patterns - 存储库层是否需要不依赖于其余代码中的数据库 ID？

> ID：10788048
> 
> 赞同：2
> 
> 时间：2012-05-28T16:53:32.200
> 
> 标签：design-patterns, repository-pattern

因此，据我了解，存储库层的整个想法是您可以快速轻松地将一种解决方案换成另一种解决方案。说，我想从 MySQL 切换到 MongoDB。我需要担心的是编写一个新的存储库层。

到目前为止，一切都很好。

问题是，MySQL 将（实际上很可能）使用整数作为主键，而 MongoDB 将使用字符串。或者我希望我的存储库层指向一个 Web 服务，谁知道他们使用什么样的 ID...

因此，为了给我的存储库层一个面向未来的接口，我不能有如下方法：

```
EmployeeRepository.getById(int id) 
```

或者

```
EmployeeRepository.getById(string id) 
```

那么一个人要做什么呢？始终使用字符串（或对象？？），然后让存储库层转换或转换它，但是它需要吗？

或者应用程序的模型是否应该有自己的内部 ID 方案，该方案与数据库的 ID 方案完全分离，并且您总是在该 ID 上获取？就像是：

```
EmployeeRepository.getByInternalId(int id) 
```

这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T11:31:13.033

> 因此，据我了解，存储库层的整个想法是，您可以快速轻松地将一种解决方案换成另一种解决方案

不，这个想法是抽象数据层以减少复杂性和代码耦合。而不是把所有东西都放在一个班级里，你会得到两个责任更明确的班级。

即使您使用存储库，从一种类型的数据层切换到另一种类型的数据层也并非易事。

然而。您可以决定在一个存储库中使用一种数据层（例如 vanilla ADO.NET），在另一个存储库中使用另一种类型的数据层（例如实体框架）。关键是您可以在每个特定用例之后调整您的存储库。这不会影响任何其他代码。

> 问题是，MySQL 将（实际上很可能）使用整数作为主键，而 MongoDB 将使用字符串。

您正在从错误的方式解决问题。您的应用程序的用户是否使用密钥？它必须采用特定格式吗？或者数据库生成的密钥可以吗？如果是这样，请使用数据库使用的任何格式。

如果您以后必须从 MySQL 切换到 Mongo，您仍然有很多工作要做（例如从表关系转移到文档）。

# python - Python 通过单引号解析字符串

> ID：10788050
> 
> 赞同：1
> 
> 时间：2012-05-28T16:54:04.807
> 
> 标签：python, regex

我正在尝试解析以下字符串：

编辑以考虑空间...

```
['THE LOCATION', 'THE NAME', 'THE JOB', 'THE AREA')] 
```

现在我使用正则表达式并用逗号将数据拆分成一个列表

InfoL = re.split(",", 信息)

但是我的输出是

```
'THE LOCATION'
'THE NAME'
'THE JOB'
'THE AREA')] 
```

期待输出如下

```
THE LOCATION
THE NAME
THE JOB
THE AREA 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:04:07.143

试试这个代码片段：

```
import re
tmpS = "['THE LOCATION', 'THE NAME', 'THE JOB', 'THE AREA')]"
tmpS = re.sub('[^\w\s,]+', '', tmpS)
print tmpS # Result -> 'THE LOCATION, THE NAME, THE JOB, THE AREA'
for s in tmpS.split(','):
     print s.strip()

O/P:
THE LOCATION
THE NAME
THE JOB
THE AREA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T16:59:00.963

一种可能性是用于`strip()`删除不需要的字符：

```
In [18]: s="['LOCATION', 'NAME', 'JOB', 'AREA')]"

In [19]: print '\n'.join(tok.strip("[]()' ") for tok in s.split(','))
LOCATION
NAME
JOB
AREA 
```

就像您的原始解决方案一样，如果允许任何字符串包含逗号，这将中断。

PS如果您示例中的右括号是错字，您可以使用[`ast.literal_eval()`](http://docs.python.org/library/ast.html#ast.literal_eval)：

```
In [22]: print '\n'.join(ast.literal_eval(s))
LOCATION
NAME
JOB
AREA 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:00:08.593

```
InfoL = re.split("[, '()\[\]]*", Info) 
```

# c++ - 编译时的 GLM 会产生大量错误

> ID：10788052
> 
> 赞同：0
> 
> 时间：2012-05-28T16:54:10.230
> 
> 标签：c++, opengl-es, mingw, qmake

我在我的代码中包含了一些 GLM 文件，并且收到了大量错误（至少 90 个）。为什么会这样，我不知道。我正在使用最新的 GLM（撰写本文时为 0.9.3.3）。我也在 Windows 上使用 Qt Creator，你会看到一个 QMake 文件。

我还应该注意，我最终将 glm 文件夹复制到了我的 mingw 文件夹中的包含目录。

我能做些什么来解决这个问题？

**制作**

```
CONFIG += console

HEADERS += \
    util.hpp \
    ShaderComparable.hpp \
    SearchTree.hpp \
    FileUtility.hpp \
    Debug.hpp \
    ShaderHandler.hpp \
    Shader.hpp \
    Testing.hpp \
    Sphere.hpp \
    Shape.hpp \
    Circle.hpp \
    Maths.hpp

SOURCES += \
    util.cpp \
    ShaderComparable.cpp \
    SearchTree.inl \
    Main.cpp \
    FileUtility.cpp \
    Debug.cpp \
    ShaderHandler.cpp \
    Testing.cpp \
    Sphere.cpp \
    Shape.cpp \
    Circle.cpp

win32:LIBS += -llibEGL -llibGLESv2
unix: LIBS += -lEGL -lGLESv2

QMAKE_CXXFLAGS += -std=c++0x -U__STRICT_ANSI__ 
```

**错误**

```
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp: In instantiation of 'glm::detail::tvec4<glm::detail::half>::<anonymous union>':
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:82:   instantiated from 'glm::detail::tvec4<glm::detail::half>'
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./gtc/swizzle.hpp:114:   instantiated from here
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::r' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::r' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::g' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::g' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::b' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::b' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::a' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:79: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::a' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::s' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::s' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::t' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::t' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::p' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::p' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::q' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:80: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::q' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::x' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::x' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::y' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::y' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::z' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::z' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::w' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec4.hpp:81: error: member 'glm::detail::half glm::detail::tvec4<glm::detail::half>::<anonymous union>::<anonymous struct>::w' with copy assignment operator not allowed in union
mingw32-make.exe[1]: Leaving directory `C:/Programming/C++/Qt/qtesc/esc/Debug'
In file included from c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type.hpp:40,
                 from c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/glm.hpp:97,
                 from ../esc/Maths.hpp:3,
                 from ../esc/Sphere.hpp:5,
                 from ../esc/Sphere.cpp:1:
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp: In instantiation of 'glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>':
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:82:   instantiated from 'glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >'
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./virtrev/xstream.hpp:92:   instantiated from here
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::b' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::b' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::b' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::p' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::p' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::p' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::z' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::z' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec3.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec3<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::z' with copy assignment operator not allowed in union
In file included from c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type.hpp:39,
                 from c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/glm.hpp:97,
                 from ../esc/Maths.hpp:3,
                 from ../esc/Sphere.hpp:5,
                 from ../esc/Sphere.cpp:1:
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp: In instantiation of 'glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>':
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:82:   instantiated from 'glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >'
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./virtrev/xstream.hpp:92:   instantiated from here
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::r' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:79: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::g' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::s' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:80: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::t' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::x' with copy assignment operator not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with constructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with destructor not allowed in union
c:\qtsdk\mingw\bin\../lib/gcc/mingw32/4.4.0/../../../../include/glm/glm/./core/type_vec2.hpp:81: error: member 'std::basic_ostream<char, std::char_traits<char> > glm::detail::tvec2<std::basic_ostream<char, std::char_traits<char> > >::<anonymous union>::<anonymous struct>::y' with copy assignment operator not allowed in union 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T19:58:26.023

我有这个问题。这是因为 glm 不适用于 -std=c++0x。你必须使用 c++98。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:16:36.327

我通过不包括 修复了大部分错误`glm/ext.hpp`，因为这似乎是造成损害的原因。如果有人知道为什么会发生这种情况，很高兴收到您的来信。

# c++ - 卷曲很慢（我假设我没有正确设置选项）

> ID：10788060
> 
> 赞同：2
> 
> 时间：2012-05-28T16:54:49.653
> 
> 标签：c++, curl

我写了这个最小的例子来说明我的问题：

```
#include "curl/curl.h"
#include <stdexcept>
#include <string>
#include <iostream>
#include <stdlib.h>

int main(int argc,char* argv[])
{
    // All error checking removed for clarity.
    // But all calls return CURLE_OK

    curl_global_init(CURL_GLOBAL_ALL);
    CURL* curl = curl_easy_init();

    curl_easy_setopt(curl, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:14.0) Gecko/20120405 Firefox/14.0a1");
    curl_easy_setopt(curl, CURLOPT_URL, argv[1]);
    curl_easy_perform(curl);

    long    result;
    curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &result);

    std::cout << "HTTP RESPONCE: " << result << "\n";
} 
```

编译并运行：

```
> g++ test.cpp -lcurl
> ./a.out thorsanvil.com
<html><head><title>Nothing here</title></head><body><h1>Nothing Here</h1><h2>Go away</h2></body></html>
HTTP RESPONCE: 200

real    0m5.144s
user    0m0.016s
sys 0m0.000s 
```

如您所见，从服务器获得响应需要 5 秒钟。
如果我使用 wget 重复相同的命令，它只需要 0.2 -> 0.5 秒

```
> time wget thorsanvil.com
--2012-05-28 05:24:17--  http://thorsanvil.com/
Resolving thorsanvil.com (thorsanvil.com)... 67.170.22.105
Connecting to thorsanvil.com (thorsanvil.com)|67.170.22.105|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 104 [text/html]
Saving to: `index.html'

    100%[======================================================================================================================>] 104         --.-K/s   in 0s      

2012-05-28 05:24:18 (589 KB/s) - `index.html.3' saved [104/104]

real    0m0.493s
user    0m0.008s
sys 0m0.000s 
```

但是使用 curl 命令行工具也很慢

```
> time curl thorsanvil.com
<html><head><title>Nothing here</title></head><body><h1>Nothing Here</h1><h2>Go away</h2></body></html>

real    0m5.240s
user    0m0.004s
sys 0m0.012s 
```

关于为什么我的简单版本没有按预期工作的任何想法？

### 已编辑

来自评论。libcurl 的版本

```
> ls -la /usr/lib/x86_64-linux-gnu/libcurl*
-rw-r--r-- 1 root root 748262 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl.a
lrwxrwxrwx 1 root root     19 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl-gnutls.so.3 -> libcurl-gnutls.so.4
lrwxrwxrwx 1 root root     23 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl-gnutls.so.4 -> libcurl-gnutls.so.4.2.0
-rw-r--r-- 1 root root 360488 Mar 22 16:52 /usr/lib/x86_64-linux-gnu/libcurl-gnutls.so.4.2.0
-rw-r--r-- 1 root root    950 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl.la
lrwxrwxrwx 1 root root     16 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl.so -> libcurl.so.4.2.0
lrwxrwxrwx 1 root root     12 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl.so.3 -> libcurl.so.4
lrwxrwxrwx 1 root root     16 Mar 22 16:51 /usr/lib/x86_64-linux-gnu/libcurl.so.4 -> libcurl.so.4.2.0
-rw-r--r-- 1 root root 381512 Mar 22 16:52 /usr/lib/x86_64-linux-gnu/libcurl.so.4.2.0

> curl --version
curl 7.21.7 (x86_64-unknown-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3
Protocols: dict file ftp ftps gopher http https imap imaps ldap pop3 pop3s rtmp rtsp smtp smtps telnet tftp 
Features: GSS-Negotiate IDN IPv6 Largefile NTLM SSL libz TLS-SRP 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:00:03.587

好的。不知道系统发生了什么。

所以我去管理员卸载然后重新安装curl。

现在一切正常。所以看起来 curl 版本以某种方式搞砸了。

谢谢。

# android - 具有N列的小部件最小宽度？

> ID：10788068
> 
> 赞同：4
> 
> 时间：2012-05-28T16:55:48.333
> 
> 标签：android, android-widget

我应该在小部件提供程序 xml minwidth/height 中输入什么数字来实现 1、2、3 和 4 行和列？

通过查看其他应用程序，我发现人们正在使用 72、142、220 和 294 dips，但在 Google 小部件指南中找不到任何参考。

这些数字对所有设备都安全吗？它们是否基于 Google 规范？

编辑：更正为 294（原为 290）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T17:12:36.690

官方文档可以[在“确定小部件的大小”下](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html#anatomy)找到。

```
# of Cells   Available Size
1            40dp
2            110dp
3            180dp
4            250dp
…            …
n            70 × n − 30 
```

这些数字虽然是新的，但最近已更新。较旧的文档说明了一个不同的公式：

> 要找到与密度无关的像素 (dp) 的最小宽度和高度，请使用以下公式：
> 
> **（细胞数 * 74） - 2**
> 
> 按照这个公式，对于一个单元格的高度，您应该使用 72 dp，对于四个单元格的宽度，您应该使用 294 dp。

[*来源*](http://web.archive.org/web/20110428104419/http://developer.android.com/guide/topics/appwidgets/index.html)

这与 72 之类的值一致。其他值对我来说似乎有些随机。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T17:09:07.260

在这里找到权威规范

[http://android-developers.blogspot.com/2009/04/introducing-home-screen-widgets-and.html](http://android-developers.blogspot.com/2009/04/introducing-home-screen-widgets-and.html)

dip 中的最小尺寸 = (细胞数 * 74dip) - 2dip

72、146、220、294

# java - 从多行文本文件中获取整数向量

> ID：10788072
> 
> 赞同：0
> 
> 时间：2012-05-28T16:56:25.273
> 
> 标签：java, parsing, integer

我需要将一个`.txt`文件解析为三个双精度数组。这个文件有不同的行。每行有三个整数除以空格。

例子：

```
19.1    24.3    0
18.2    24.0    0
12.6    24.9    20
14.4    28.0    20 
```

我的目标是获得三个双数组（`x`,`y`和`z`），并且在每个数组中应该有一列。所以结果应该和写下面的指令是一样的：

```
double[] x = {19.1,18.2,12.6,14.4};
double[] y = {24.3,24.0,24.9,28.0};
double[] z = {0,0,20,20}; 
```

我知道如何打开和读取文件，如下所示：

```
String file = "filename.txt";
String line=null;
FileReader fr = new FileReader(file);
BufferedReader br = new BufferedReader(fr);
while(!(line=br.readLine()).contains("EOF")) {
  // read and process one line..
} 
```

我不知道该怎么做是如何解析当前行的每个数字并将其分配给三个向量之一。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:11:06.783

您可以简单地拆分和解析每一行，如下所示：

```
String[] row = line.split("\\s+");
double d1 = Double.parseDouble(row[0]);
double d2 = Double.parseDouble(row[1]);
double d3 = Double.parseDouble(row[2]); 
```

`ArrayList`此外，如果行数不固定，那么使用s 的`Double`s 而不是 s 的数组会更容易且更有意义`double`。

# python - 在每个循环中为 PyQT 窗口创建一个按钮

> ID：10788074
> 
> 赞同：0
> 
> 时间：2012-05-28T16:56:38.767
> 
> 标签：python, pyqt

```
class Test(QtGui.QMainWindow):  
    def __init__(self):
        super(Test, self).__init__()

        self.initUI()

    def initUI(self):
        YDrive = QtGui.QAction(QtGui.QIcon('y.gif'), 'Exit', self)
        SDrive = QtGui.QAction('S', self)
        GDrive = QtGui.QAction('G', self)
        AddDrive = QtGui.QAction('+', self)
        YDrive.triggered.connect(self.setYDir)

        SDrive.triggered.connect(self.setSDir)
        GDrive.triggered.connect(self.setGDir)

        self.toolbar = self.addToolBar('Exit')
        self.toolbar.addAction(YDrive)
        self.toolbar.addAction(SDrive)
        self.toolbar.addAction(GDrive)
        self.toolbar.addAction(AddDrive)

        #btn1 = QtGui.QPushButton("Button 1", self)
        #btn1.move(30, 50)

        #btn2 = QtGui.QPushButton("Button 2", self)
        #btn2.move(150, 50)

        #btn1.clicked.connect(self.buttonClicked)            
        #btn2.clicked.connect(self.buttonClicked)

        self.setGeometry(300, 300, 250, 150)
        self.center()
        self.setWindowTitle('Message box')    
        self.show()

    def setYDir(self):
        myInputs[1] = "Y"
        print "myInputs[1] CHANGED to Y"
        myWorkDrive = "Y:\\HoC_Jobs\\"
        shows = self.listDirs(myWorkDrive)

        for elements in shows:
            btn1 = QtGui.QPushButton(elements, self)
            btn1.move(30, 50)
            btn1.clicked.connect(self.buttonClicked) 
```

我在 setYDir 的最后一个循环中尝试做的是为列表显示中的每个元素创建一个按钮。但是，它似乎无法正常工作。它不会根据我在工具栏中单击的按钮更新按钮。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:28:14.487

好吧，如果您在不使用布局的情况下将组件添加到父窗口小部件，并且在调用父窗口后`show`，您必须`show`自己添加子窗口。

此外，您的所有按钮都是重叠的，因此您只会看到添加的最后一个。发布源代码时，最好将其剥离到运行它所需的最低限度。在这种情况下，它看起来像这样：

```
from PyQt4 import QtGui
import os

class Test(QtGui.QMainWindow):  
    def __init__(self):
        super(Test, self).__init__()

        self.initUI()

    def initUI(self):
        YDrive = QtGui.QAction("Y", self)
        YDrive.triggered.connect(self.setYDir)

        self.toolbar = self.addToolBar('Exit')
        self.toolbar.addAction(YDrive)

        self.setGeometry(300, 300, 250, 150)
        self.setWindowTitle('Message box')    
        self.show()

    def buttonClicked(self):
        print "clicked"

    def setYDir(self):
        myWorkDrive = "/tmp"
        shows = os.listdir(myWorkDrive)
        i = 0
        for elements in shows:
            btn1 = QtGui.QPushButton(elements, self)
            btn1.move(30, 50 + i)
            i += 30
            btn1.clicked.connect(self.buttonClicked)
            btn1.show()
        self.resize(self.width(), 50 + i)

if __name__ == '__main__':
    app = QtGui.QApplication([])
    t = Test()
    t.show()
    app.exec_() 
```

# for-loop - DOS 批处理 FOR 循环删除不包含字符串的文件

> ID：10788075
> 
> 赞同：6
> 
> 时间：2012-05-28T16:56:55.977
> 
> 标签：for-loop, batch-file

我想删除当前目录中名称中不包含字符串“sample”的所有文件。

例如，

```
test_final_1.exe
test_initial_1.exe
test_sample_1.exe
test_sample_2.exe 
```

*我想删除除名称中包含样本*的文件以外的所有文件。

```
for %i in (*.*) do if not %i == "*sample*" del /f /q %i

Is the use of wild card character in the if condition allowed?
Does, (*.*) represent the current directory? 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T17:09:29.600

最容易使用 FIND 或 FINDSTR`/V`选项来查找不包含字符串的名称，以及不`/I`区分大小写搜索的选项。切换到`FOR /F`并将结果`DIR`传递给`FIND`。

```
for /f "eol=: delims=" %F in ('dir /b /a-d * ^| find /v /i "sample"') do del "%F" 
```

如果在批处理文件中使用，请将 %F 更改为 %%F。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-30T16:15:01.693

Aacini 的回答对我有用。我需要一个 bat 文件来解析目录树，以查找所有具有 xyz 文件扩展名且不包含路径中任何位置的 badvalue 的文件。解决方案是：

```
setlocal enableDelayedExpansion

for /r %%f in (*.xyz) do (
   set "str1=%%f"
   if "!str1!" == "!str1:badvalue=!" (
        echo Found file with xyz extension and without badvalue in path
   )
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T05:08:50.217

```
setlocal EnableDelayedExpansion
for %i in (*.*) do (set "name=%i" & if "!name!" == "!name:sample=!" del /f /q %i) 
```

# sql-server - 使用 cte 索引视图的选项

> ID：10788080
> 
> 赞同：3
> 
> 时间：2012-05-28T16:57:31.080
> 
> 标签：sql-server, views, common-table-expression, materialized

我有一个要为其创建索引视图的视图。经过大量的精力，我能够为视图放置 sql 查询，它看起来像这样 -

```
ALTER VIEW [dbo].[FriendBalances] WITH SCHEMABINDING  as
WITH

trans (Amount,PaidBy,PaidFor, Id)  AS    

(SELECT Amount,userid AS PaidBy, PaidForUsers_FbUserId AS PaidFor, Id FROM dbo.Transactions
FULL JOIN dbo.TransactionUser ON dbo.Transactions.Id = dbo.TransactionUser.TransactionsPaidFor_Id),

bal (PaidBy,PaidFor,Balance) AS

(SELECT PaidBy,PaidFor, SUM( Amount/ transactionCounts.[_count]) AS Balance FROM trans 
JOIN (SELECT Id,COUNT(*)AS _count FROM trans GROUP BY Id)   AS transactionCounts ON trans.Id = transactionCounts.Id AND trans.PaidBy <> trans.PaidFor
GROUP BY trans.PaidBy,trans.PaidFor )
SELECT ISNULL(bal.PaidBy,bal2.PaidFor)AS PaidBy,ISNULL(bal.PaidFor,bal2.PaidBy)AS PaidFor,
ISNULL( bal.Balance,0)-ISNULL(bal2.Balance,0) AS Balance
FROM bal 
left JOIN bal AS bal2 ON bal.PaidBy = bal2.PaidFor AND bal.PaidFor = bal2.Paidby   
WHERE ISNULL( bal.Balance,0)>ISNULL(bal2.Balance,0) 
```

FriendBalances 视图的示例数据 -

```
PaidBy  PaidFor  Balance
------  -------  -------
9990    9991     1000
9990    9992     2000
9990    9993     1000
9991    9993     1000
9991    9994     1000 
```

它主要是2个表的连接。

`Transactions`-

```
CREATE TABLE [dbo].[Transactions](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Date] [datetime] NOT NULL,
    [Amount] [float] NOT NULL,
    [UserId] [bigint] NOT NULL,
    [Remarks] [nvarchar](255) NULL,
    [GroupFbGroupId] [bigint] NULL,
 CONSTRAINT [PK_Transactions] PRIMARY KEY CLUSTERED 
```

表中的样本数据`Transactions`-

```
Id  Date                     Amount  UserId  Remarks         GroupFbGroupId
--  -----------------------  ------  ------  --------------  --------------
1   2001-01-01 00:00:00.000  3000    9990    this is a test  NULL
2   2001-01-01 00:00:00.000  3000    9990    this is a test  NULL
3   2001-01-01 00:00:00.000  3000    9991    this is a test  NULL 
```

`TransactionUsers`-

```
CREATE TABLE [dbo].[TransactionUser](
    [TransactionsPaidFor_Id] [bigint] NOT NULL,
    [PaidForUsers_FbUserId] [bigint] NOT NULL
) ON [PRIMARY] 
```

表中的样本数据`TransactionUser`-

```
TransactionsPaidFor_Id  PaidForUsers_FbUserId
----------------------  ---------------------
1                       9991
1                       9992
1                       9993
2                       9990
2                       9991
2                       9992
3                       9990
3                       9993
3                       9994 
```

现在我无法创建视图，因为我的查询包含 cte(s)。我现在有哪些选择？

如果可以删除 cte，那么有助于创建索引视图的其他选项应该是什么。

这是错误消息 -

> `Msg 10137, Level 16, State 1, Line 1 Cannot create index on view "ShareBill.Test.Database.dbo.FriendBalances" because it references common table expression "trans". Views referencing common table expressions cannot be indexed. Consider not indexing the view, or removing the common table expression from the view definition.`

概念： 交易主要包括：

*   已支付的金额
*   `UserId`支付该金额的用户
*   还有一些现在不重要的信息。

`TransactionUser`table 是 Transaction 和 User Table 之间的映射。本质上，一笔交易可以在多人之间共享。因此，我们将其存储在此表中。

所以我们有交易，其中 1 人支付，其他人分享金额。因此，如果 A 为 B 支付 100 美元，那么 B 将欠 A 100 美元。同样，如果 B 为 A 支付 90 美元，那么 B 将只欠 A 10 美元。现在如果 A 为 A、b、c 支付 300 美元，这意味着 B 将欠 A 110 美元，C 欠 A 10 美元。

因此，在这个特定视图中，我们汇总了 2 个用户之间已支付的有效金额（如果有），从而知道一个人欠另一个人多少钱。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T17:26:48.307

好的，这为您提供了一个索引视图（需要一个额外的视图来整理谁欠谁的详细信息），但它可能仍然不能满足您的要求。

```
/* Transactions table, as before, but with handy unique constraint for FK Target */
CREATE TABLE [dbo].[Transactions](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Date] [datetime] NOT NULL,
    [Amount] [float] NOT NULL,
    [UserId] [bigint] NOT NULL,
    [Remarks] [nvarchar](255) NULL,
    [GroupFbGroupId] [bigint] NULL,
 CONSTRAINT [PK_Transactions] PRIMARY KEY CLUSTERED (Id),
 constraint UQ_Transactions_XRef UNIQUE (Id,Amount,UserId)
) 
```

到目前为止没有什么令人惊讶的，我希望

```
/* Much expanded TransactionUser table, we'll hide it away and most of the maintenance is automatic */
CREATE TABLE [dbo]._TransactionUser(
    [TransactionsPaidFor_Id] int NOT NULL,
    [PaidForUsers_FbUserId] [bigint] NOT NULL,
    Amount float not null,
    PaidByUserId bigint not null,
    UserCount int not null,
    LowUserID as CASE WHEN [PaidForUsers_FbUserId] < PaidByUserId THEN [PaidForUsers_FbUserId] ELSE PaidByUserId END,
    HighUserID as CASE WHEN [PaidForUsers_FbUserId] < PaidByUserId THEN PaidByUserId ELSE [PaidForUsers_FbUserId] END,
    PerUserDelta as (Amount/UserCount) * CASE WHEN [PaidForUsers_FbUserId] < PaidByUserId THEN -1 ELSE 1 END,
    constraint PK__TransactionUser PRIMARY KEY ([TransactionsPaidFor_Id],[PaidForUsers_FbUserId]),
    constraint FK__TransactionUser_Transactions FOREIGN KEY ([TransactionsPaidFor_Id]) references dbo.Transactions,
    constraint FK__TransactionUser_Transaction_XRef FOREIGN KEY ([TransactionsPaidFor_Id],Amount,PaidByUserID)
        references dbo.Transactions (Id,Amount,UserId) ON UPDATE CASCADE
) 
```

该表现在保留了足够的信息以允许构建视图。我们要做的其余工作是构建/维护表中的数据。请注意，通过外键约束，我们已经确保如果事务表中的金额发生更改，则所有内容都会重新计算。

```
/* View that mimics the original TransactionUser table -
in fact it has the same name so existing code doesn't need to change */
CREATE VIEW dbo.TransactionUser
with schemabinding
as
    select
        [TransactionsPaidFor_Id],
        [PaidForUsers_FbUserId]
    from
        dbo._TransactionUser
GO
/* Effectively the PK on the original table */
CREATE UNIQUE CLUSTERED INDEX PK_TransactionUser on dbo.TransactionUser ([TransactionsPaidFor_Id],[PaidForUsers_FbUserId]) 
```

任何已经写出来反对的东西`TransactionUser`现在都将反对这种观点，而且不会更明智。除了，他们不能在没有帮助的情况下插入/更新/删除行：

```
/* Now we write the trigger that maintains the underlying table */
CREATE TRIGGER dbo.T_TransactionUser_IUD
ON dbo.TransactionUser
INSTEAD OF INSERT, UPDATE, DELETE
AS
    SET NOCOUNT ON;
    /* Every delete affects *every* row for the same transaction
    We need to drop the counts on every remaining row, as well as removing the actual rows we're interested in */
    WITH DropCounts as (
        select TransactionsPaidFor_Id,COUNT(*) as Cnt from deleted group by TransactionsPaidFor_Id
    ), KeptRows as (
        select tu.TransactionsPaidFor_Id,tu.PaidForUsers_FbUserId,UserCount - dc.Cnt as NewCount
        from dbo._TransactionUser tu left join deleted d
            on tu.TransactionsPaidFor_Id = d.TransactionsPaidFor_Id and
                tu.PaidForUsers_FbUserId = d.PaidForUsers_FbUserId
            inner join DropCounts dc
                on
                    tu.TransactionsPaidFor_Id = dc.TransactionsPaidFor_Id
        where
            d.PaidForUsers_FbUserId is null
    ), ChangeSet as (
        select TransactionsPaidFor_Id,PaidForUsers_FbUserId,NewCount,1 as Keep
        from KeptRows
        union all
        select TransactionsPaidFor_Id,PaidForUsers_FbUserId,null,0
        from deleted
    )
    merge into dbo._TransactionUser tu
    using ChangeSet cs on tu.TransactionsPaidFor_Id = cs.TransactionsPaidFor_Id and tu.PaidForUsers_FbUserId = cs.PaidForUsers_FbUserId
    when matched and cs.Keep = 1 then update set UserCount = cs.NewCount
    when matched then delete;

    /* Every insert affects *every* row for the same transaction
    This is why the indexed view couldn't be generated */
    WITH TU as (
        select TransactionsPaidFor_Id,PaidForUsers_FbUserId,Amount,PaidByUserId from dbo._TransactionUser
        where TransactionsPaidFor_Id in (select TransactionsPaidFor_Id from inserted)
        union all
        select TransactionsPaidFor_Id,PaidForUsers_FbUserId,Amount,UserId
        from inserted i inner join dbo.Transactions t on i.TransactionsPaidFor_Id = t.Id
    ), CountedTU as (
        select TransactionsPaidFor_Id,PaidForUsers_FbUserId,Amount,PaidByUserId,
            COUNT(*) OVER (PARTITION BY TransactionsPaidFor_Id) as Cnt
        from TU
    )
    merge into dbo._TransactionUser tu
    using CountedTU new on tu.TransactionsPaidFor_Id = new.TransactionsPaidFor_Id and tu.PaidForUsers_FbUserId = new.PaidForUsers_FbUserId
    when matched then update set Amount = new.Amount,PaidByUserId = new.PaidByUserId,UserCount = new.Cnt
    when not matched then insert
        ([TransactionsPaidFor_Id],[PaidForUsers_FbUserId],Amount,PaidByUserId,UserCount)
    values (new.TransactionsPaidFor_Id,new.PaidForUsers_FbUserId,new.Amount,new.PaidByUserId,new.Cnt); 
```

现在正在维护基础表，我们终于可以首先编写您想要的索引视图......几乎。问题是我们创建的总数可能是正数或负数，因为我们已经对交易进行了标准化，以便我们可以轻松地将它们相加：

```
CREATE VIEW [dbo]._FriendBalances
WITH SCHEMABINDING
as
    SELECT
        LowUserID,
        HighUserID,
        SUM(PerUserDelta) as Balance,
        COUNT_BIG(*) as Cnt
    FROM dbo._TransactionUser
    WHERE LowUserID != HighUserID
    GROUP BY
        LowUserID,
        HighUserID
GO
create unique clustered index IX__FriendBalances on dbo._FriendBalances (LowUserID, HighUserID) 
```

所以我们最终创建了一个视图，建立在上面的索引视图上，如果余额是负数，我们翻转欠债的人和欠债的人。但它将使用上述视图上的索引，这是我们试图通过使用索引视图来节省的大部分工作：

```
create view dbo.FriendBalances
as
    select
        CASE WHEN Balance >= 0 THEN LowUserID ELSE HighUserID END as PaidBy,
        CASE WHEN Balance >= 0 THEN HighUserID ELSE LowUserID END as PaidFor,
        ABS(Balance) as Balance
    from
        dbo._FriendBalances WITH (NOEXPAND) 
```

现在，最后，我们插入您的示例数据：

```
set identity_insert dbo.Transactions on --Ensure we get IDs we know
GO
insert into dbo.Transactions (Id,[Date] ,   Amount , UserId , Remarks ,GroupFbGroupId)
select 1   ,'2001-01-01T00:00:00.000', 3000,    9990    ,'this is a test',  NULL union all
select 2   ,'2001-01-01T00:00:00.000', 3000,    9990    ,'this is a test',  NULL union all
select 3   ,'2001-01-01T00:00:00.000', 3000,    9991    ,'this is a test',  NULL
GO
set identity_insert dbo.Transactions off
GO
insert into dbo.TransactionUser (TransactionsPaidFor_Id,  PaidForUsers_FbUserId)
select 1,   9991 union all
select 1,   9992 union all
select 1,   9993 union all
select 2,   9990 union all
select 2,   9991 union all
select 2,   9992 union all
select 3,   9990 union all
select 3,   9993 union all
select 3,   9994 
```

并查询最终视图：

```
select * from dbo.FriendBalances

PaidBy  PaidFor Balance
9990    9991    1000
9990    9992    2000
9990    9993    1000
9991    9993    1000
9991    9994    1000 
```

* * *

现在，我们*可以*做一些额外的工作，如果我们担心有人可能会找到一种方法来躲避触发器并直接更改基表。第一个是*另一个*索引视图，它将确保同一事务的每一行都具有*相同* `UserCount`的值。最后，通过一些额外的列、检查约束、FK 约束和触发器中的更多工作，我*认为*我们可以确保它们`UserCount`是正确的——但它可能会增加比你想要的更多的开销。

如果您愿意，我可以为这些方面添加脚本 - 这取决于您希望/需要数据库的限制程度。

# javascript - 事件保持绑定到僵尸实例

> ID：10788081
> 
> 赞同：0
> 
> 时间：2012-05-28T16:57:42.063
> 
> 标签：javascript, memory-leaks, backbone.js, marionette

我面临着看起来像僵尸参考案例的情况。

首先，这是我正在使用的代码。

在这里，您将找到我的用户详细信息管理器布局[要点](https://gist.github.com/a58a22ad423cd5db9f4d)

相反，可以在[此处找到控制器](https://gist.github.com/aaf4c91a0a2ee3f563e3)

操作流程如下：

1.  管理员在点击控制器上调用“manageUsers”的路由时访问用户列表。
2.  管理员单击用户行并触发事件“users:selected”并且侦听器接收要使用的用户实例。
3.  DetailsLayout 在应用程序的主布局中被实例化和呈现。特别是在其“内容”区域。
4.  处理用户详细信息表单的视图也被实例化并呈现在 DetailsLayout 的“dettagli”区域内。
5.  此时，管理员有兴趣管理此用户的笔记。因此，他单击标记为“notes”的选项卡，便笺列表将呈现在 DetailsLayout“note”区域中。
6.  单击管理员想要使用的注释会触发事件“notes:selected”，它将注释实例传递给适当的事件处理程序 (DetailsLayout.showNote)。

此时，一旦管理员单击触发 DetailsLayout.showUsers 的链接，该链接又触发上述控制器侦听的事件“users:index”，他将返回到上面列表的第 1 点。

重复整个过程直到第 5 点按预期工作，但是，一旦管理员选择要工作的注释，调试器就会显示有关未定义 DetailsLayout 区域“注释”的错误。

逐步运行代码，我发现在第二次运行时，触发的事件正确绑定到 DetailsLayout 的正确实例，但第 6 点仍绑定到第一次传递时使用的实例。

上面的代码显示，每次显示用户的详细信息时，都会创建一个新的 DetailsLayout 实例。难道这还不足以保证没有僵尸还在附近吗？如果我从backbone.marionette 文档中没记错的话，每次layout.region.show() 被击中时，它都会关闭前一个视图（解除绑定事件和所有其他事件）并附加新的passwed 视图。

我做错了什么？

在此先感谢您的帮助。问候

附言

Backbone.marionette 版本为 0.8.4

Backbonejs 版本为 0.9.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:10:17.800

UserDetailsList 中的构造函数是问题所在：

```
 constructor: (@user) ->
                console.addHistory("DetailsLayout","INIT")
                super()
                Hub.vent.on("notes:selected",(note) => @showNote(note))
                Hub.vent.on("notes:show", => @showNotes())
                Hub.vent.on("notes:save", (note) => @saveNote(note))
                Hub.vent.on("notes:delete", (note) => @deleteNote(note))
                Hub.vent.on("notes:new", => @showNote(new Note())) 
```

您直接绑定到`Hub.vent`这些事件，但从未明确解除绑定。因此，您的 UserDetails 列表实例将永远存在于内存中。

要解决此问题，您应该使用布局的`bindTo`方法，该方法将跟踪绑定并在`close`调用布局的方法时为您解除绑定。

```
 constructor: (@user) ->
                console.addHistory("DetailsLayout","INIT")
                super()
                @bindTo(Hub.vent, "notes:selected",(note) => @showNote(note))
                @bindTo(Hub.vent, "notes:show", => @showNotes())
                @bindTo(Hub.vent, "notes:save", (note) => @saveNote(note))
                @bindTo(Hub.vent, "notes:delete", (note) => @deleteNote(note))
                @bindTo(Hub.vent, "notes:new", => @showNote(new Note())) 
```

当您不再需要它时，请务必正确关闭您的布局。`close`在布局实例上调用该方法。这将正确清除`bindTo`构造函数设置的所有事件。

仅供参考 - a`Layout`直接扩展自`ItemView`所有关于 a 的信息/文档`ItemView`也适用于 a `Layout`，包括使用`bindTo`,`close`等。

# vb.net - 将字符串拆分为 2 个变量

> ID：10788085
> 
> 赞同：2
> 
> 时间：2012-05-28T16:57:57.800
> 
> 标签：vb.net, string, textbox, split

我在这里要做的是从文本框中捕获 2 个变量

这是这里将要发生的事情的一个例子。

`User:Pass`

我想在`:`as 用户之前声明所有内容，在`:`as pass 之后声明所有内容。

我用谷歌搜索，发现了一些东西，但我似乎无法让它充分发挥作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T17:03:21.713

```
Dim words As String() = textbox1.text.Split(":")
Dim user as String =  words(0)
Dim pass as String =  words(1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T17:02:33.893

```
Dim str = "User:Pass"

Dim split = str.Split(":")

Dim user as String
Dim password as String

If (split.Count = 2) then
    user=split(0).ToString()
    password = split(1).ToString()
End If 
```

拆分**`:`**，如果结果数组中有 2 个条目，则使用第一项填充用户变量，并使用第二项填充密码变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:02:18.727

看看拆分功能。

[http://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-12T11:40:17.607

```
Dim user As String
Dim pass As String
Dim iPosEQ As Integer
iPosEQ = textbox1.text.IndexOf(":", System.StringComparison.Ordinal)
kv(0) = textbox1.text.Substring(0, iPosEQ - 1)
kv(1) = textbox1.text.Substring(iPosEQ + 1) 
```

这甚至适用于带有“：”的密码（或用户）

# javascript - KmlLayer getDefaultViewport() 未定义 - 谷歌地图

> ID：10788090
> 
> 赞同：0
> 
> 时间：2012-05-28T16:58:38.940
> 
> 标签：javascript, maps

谢谢你的时间，我希望我能清楚地谈论我的小问题。我想使用这样的变量“coor”：

```
var coor = kml.getDefaultViewport().getCenter(); 
```

并将此变量用于新的 MARKER 位置。问题是：javaScript 返回未定义。

这是我的代码：

```
 function initialisation(){
    var centreCarte = new google.maps.LatLng(liste[0][2], liste[0][3]);
    var optionsCarte = {
        zoom: 7,
        center: centreCarte,
        mapTypeId: google.maps.MapTypeId.ROADMAP}                           
    var maCarte = new google.maps.Map(document.getElementById("EmplacementDeMaCarte"), optionsCarte);

    var i=0,li=liste.length;
    while(i<li){
    var kml = new google.maps.KmlLayer('http://myestory.fr/kml/'+liste[i]                [0].toString()+'.kml',
                        {
                        'preserveViewport': true,
                        'map': maCarte
                        });

    var coor = kml.getDefaultViewport().getCenter();

    var marker = new MarkerWithLabel({
    position: new google.maps.LatLng(coor),
    map: maCarte,
    ... //other options of MarkerWithLabel
    });
    i++;}
    }

    google.maps.event.addDomListener(window, 'load', initialisation);

    </script>
</head> 
```

那么你知道为什么变量“coor”不带任何值吗？还有其他解决方案吗？

谢谢！！

锆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:13:56.000

一个人给了我一些关于我的问题的有用细节。事实上，我必须在循环中使用监听器，如下所示：

```
function initialisation(){
    //affectation du résultat de la requète SQL et création des variables
var liste = [<?php echo $liste;?>];
var centreCarte = new google.maps.LatLng(liste[0][2], liste[0][3]);
var optionsCarte = {
    zoom: 7,
    center: centreCarte,
    mapTypeId: google.maps.MapTypeId.ROADMAP}

var maCarte = new google.maps.Map(document.getElementById("EmplacementDeMaCarte"), optionsCarte);

//boucle permettant l'affichage des fichiers KML et la création des MARKER
//en fonction de la liste obtenue lors de la requète SQL
var i=0,li=liste.length;
while(i<li){
    var kml = new google.maps.KmlLayer('http://site.fr/kml/'+liste[i][0].toString()+'.kml', {
            'preserveViewport': true,
            'map': maCarte,
            'valeuri': i
    });
    google.maps.event.addListener(kml, "defaultviewport_changed", 
        function() {
            var marker = new MarkerWithLabel({
                    'position': this.getDefaultViewport().getCenter(),
                    'map': this.getMap(),
                    'draggable': true,
                    'raiseOnDrag': false,
                    'icon': 'http://site.fr/icon/noicon.png',
                    'labelContent': liste[this.valeuri][1],
                    'labelAnchor': new google.maps.Point(27, 12),
                    'labelClass': "labels",
                    'labelStyle': {opacity: 1}  
            });
        });
    i++;}
} 
```

所以现在，我可以在循环中加载的所有 KML 的中心仅显示带有标签的 MARKER（noicon.png 为 1px*1px 图像）。

++

锆

# select - 丰富：选择不显示选定的值

> ID：10788106
> 
> 赞同：1
> 
> 时间：2012-05-28T16:59:50.647
> 
> 标签：select, jsf-2, richfaces

以下是我的代码

```
<rich:select id="cycle_group" value="#{menuCycleBean.menuCycleDetailTO.menuCycleGroupId}" defaultLabel="#{msg['gobal.select.default.label']}" 
                converter="javax.faces.Integer">
                <f:selectItems value="#{menuCycleBean.cycleGroupList}" var="n" itemLabel="#{n.label}" itemValue="#{n.id}" />
                </rich:select> 
```

“menuCycleGroupId”是“Integer”值，“n.id”是“String”，使用转换器它是在提交表单时从 String 到 Int 的自动转换器值，但是如果我想将选定的选项显示为 Rich:select 那么转换器不起作用？ ?? 转换器仅在提交表单时有帮助，如果我想显示选定的记录该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:37:24.143

rich:select 也有已知的转换器问题，我使用了 h:selectOneMenu，它对我来说效果很好。

# ubuntu - Automating SSH access into ec2

> ID：10788109
> 
> 赞同：0
> 
> 时间：2012-05-28T16:59:58.767
> 
> 标签：ubuntu, ssh, amazon-ec2, ssh-keys

I need to automate passwordless access to ec2 instances in a master/slave configuration.

So for it works but I suspect I hit a snag.

The below are the steps for allowing the ec2 master to ssh into a ec2 slave.

On the master I do the following:

```
cd /home/ubuntu/.ssh
ssh-keygen -f id_rsa -t rsa -N ''
eval `ssh-agent`
ssh-add ~/.ssh/id_rsa 
```

On the slave I add the above generated id_rsa.pub file to:

```
/home/ubuntu/.ssh/authorized_keys 
```

So...issue is that that when I ssh into a machine it asks for the following:

```
RSA key fingerprint is b4:50:7e:5c:5f:41:f5:cd:95:91:78:5b:8a:1f:97:df.
Are you sure you want to continue connecting (yes/no)? 
```

The program I am trying to run;tsung, seems to not work with the prompt even though a password is now not required. So, the programn fails. If I ssh into the slave, thus adding the key, then all works now that hte yes/no is no longer asked. So..the question is, how do I automate the removing the prompt? I can write a script to automatomate e.g. pexpect but that seems long winded.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:24:17.923

You can use `ssh-keyscan` (typically part of OpenSSH distributions) to get the server's host key and store it in a `known_hosts` file. Once the key is in that file, no further prompts will show up. See the ssh-keyscan manpage for details.

There is, of course, a reason SSH asks you to verify the identity of the server, so doing this exposes you to certain security risks. Depending on how you create your instances, you may be able to fix this by (a) using the same host key on the server every time and (b) including it in your client image (or whatever you do).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:11:40.087

The yes/no question is only asked the very first time you connect so that it can save that handshake info. It will never ask it again, so do it once, connect manually, then automation should work for future visits.

This is a basic part of SSH, and not AWS in particular.

# ruby - 不同版本的 Ruby 构建 Rails 项目的方式是否不同，是否存在兼容性问题？

> ID：10788115
> 
> 赞同：0
> 
> 时间：2012-05-28T17:00:24.617
> 
> 标签：ruby, ruby-on-rails-3

如果我`rails new myapp`使用 Ruby 1.9.2 运行并将这个应用程序派生到另一台运行 Ruby 1.9.3 的机器上，我能运行这个应用程序吗？我会有兼容性问题吗？

# asp.net - 在 ASP .NET 3.5 中使用 ObjectDataSource - 寻找带有验证的完整代码示例

> ID：10788116
> 
> 赞同：0
> 
> 时间：2012-05-28T17:00:25.687
> 
> 标签：asp.net, objectdatasource

我正在寻找一本 ASP .NET 3.5 书籍，它将彻底（带有高级代码示例）如何在各种业务场景中使用 ObjectDataSource。你知道任何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:09:42.490

[MSDN](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)可能就足够了，不要认为值得为此买一本书 :)

[在这里](http://www.asp.net/web-forms/tutorials/data-access/basic-reporting/displaying-data-with-the-objectdatasource-cs)，您有一个 ASP.NET 特定的帖子。

ASP.NET 验证控件完全独立于`ObjectDataSource`. 如果您发送有关您的特定场景的更多详细信息，我们可以提供更好的帮助。

# c# - 启用/禁用 ListView 上的 Moveup/MoveDown 按钮

> ID：10788119
> 
> 赞同：0
> 
> 时间：2012-05-28T17:00:36.260
> 
> 标签：c#, winforms

用这样的形式：

我编写了这段代码来处理上移/下移按钮单击项目时的启用/禁用逻辑（我们不关心左侧的可用列表，我们只关心右侧的选定列表）

![在此处输入图像描述](../Images/2ca8f22bfe63b23639ef43e77a8d3f4f.png)

```
 private void SelectedLV_SelectedIndexChanged(object sender, EventArgs e)
    {
        // what to do wth move up button
        if (SelectedLV.SelectedIndices.Count == 1 && SelectedLV.SelectedItems[0].Index > 0)
        {
            MoveUpBtn.Enabled = true;
        }
        else
        {
            MoveUpBtn.Enabled = false;
        }

        //what to do with move down button
        if (SelectedLV.SelectedIndices.Count == 1 && SelectedLV.SelectedItems[0].Index < SelectedLV.Items.Count - 1)
        {
            MoveDownBtn.Enabled = true;
        }
        else
        {
            MoveDownBtn.Enabled = false;
        }
    } 
```

我认为它适用于那种情况，**但我的问题是，当我们单击选定的列表视图时，处理该情况并禁用两个上移/下移按钮的好逻辑是什么？** 当我们不在 SelectedListView 内时，我不希望它们被启用...另外，如果您发现我粘贴的代码有任何问题，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:14:32.943

问题是，一旦您单击“移动”按钮，您就处于 SelectedListView 控件之外，因此逻辑实际上应该基于您是否具有正确的索引值：

```
private void SelectedLV_SelectedIndexChanged(object sender, EventArgs e)
  if (SelectedLV.SelectedIndicies.Count == 0) {
    MoveUpBtn.Enabled = false;
    MoveDownBtn.Enabled = false;
  } else {
    // normal processing
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:41:51.060

你即将用焦点要求拍摄你的脚。此类 UI 更新最好使用 Application.Idle 事件完成，它仅在没有重要事件发生时运行。并且可以帮助消除很多事件处理程序。像这样：

```
public partial class Form1 : Form {
    public Form1() {
        InitializeComponent();
        Application.Idle += Application_Idle;
        this.FormClosed += delegate { Application.Idle -= Application_Idle; };
    }

    void Application_Idle(object sender, EventArgs e) {
        bool focusOk = this.ActiveControl == SelectedLV;
        bool selectOk = SelectedLV.SelectedIndices.Count == 1;
        int index = selectOk ? SelectedLV.SelectedIndices[0] : -1;
        MoveUpBtn.Enabled = focusOk && selectOk && index > 0;
        MoveDownBtn.Enabled = focusOk && selectOk && index < SelectedLV.Items.Count-1;
    }
} 
```

不要忘记在按钮的 Click 事件处理程序中重新设置焦点。不要忘记 ListView.HideSelection 属性。将其设置为 False，这样焦点就不再重要了。

# jquery - jQuery 全局变量 $.post();

> ID：10788122
> 
> 赞同：0
> 
> 时间：2012-05-28T17:00:46.607
> 
> 标签：jquery, ajax, function, post, var

```
$.post("general.php", {/* some values */}, function(data){var id = data;});
alert(id); 
```

问题是，警报是空的。有人知道为什么吗？以及如何解决？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T17:04:21.867

有2个问题：

*   一种是 ajax 是异步的，并且警报在 ajax 回调之前执行，其中`id`正在设置变量

*   第二个是变量不是全局的，它只在回调范围内可见

因此，我建议您声明变量 global（如果您需要它以供以后使用）：

```
var id;// in the global scope 
```

或者

```
window.id = ''; 
```

您可能应该执行回调中的逻辑：

```
$.post("general.php", {/* some values */}, function(data){ 
    window.id = data;
    alert(data);
}); 
```

# java - 一个带有 Java/Socket 的简单 Http 服务器？

> ID：10788125
> 
> 赞同：28
> 
> 时间：2012-05-28T17:01:09.657
> 
> 标签：java, http, sockets

我目前正在创建一个返回静态页面的小型 HTTP 服务器`<p>Hello!</p>`......我尝试使用带有 Java 的套接字：

```
 public static void main(String[] args) throws Exception {

        // création de la socket
        int port = 1989;
        ServerSocket serverSocket = new ServerSocket(port);
        System.err.println("Serveur lancé sur le port : " + port);

        // repeatedly wait for connections, and process
        while (true) {

            // on reste bloqué sur l'attente d'une demande client
            Socket clientSocket = serverSocket.accept();
            System.err.println("Nouveau client connecté");

            // on ouvre un flux de converation

           BufferedReader in = new BufferedReader(
                           new InputStreamReader(clientSocket.getInputStream())
                          ); 
            PrintWriter out = new PrintWriter(
                         new BufferedWriter(
                            new OutputStreamWriter(clientSocket.getOutputStream())), 
                         true);   

            // chaque fois qu'une donnée est lue sur le réseau on la renvoi sur le flux d'écriture.
            // la donnée lue est donc retournée exactement au même client.
            String s;
            while ((s = in.readLine()) != null) {
                System.out.println(s);

       out.write("HTTP/1.0 200 OK\r\n");
       out.write("Date: Fri, 31 Dec 1999 23:59:59 GMT\r\n");
       out.write("Server: Apache/0.8.4\r\n");
       out.write("Content-Type: text/html\r\n");
       out.write("Content-Length: 59\r\n");
       out.write("Expires: Sat, 01 Jan 2000 00:59:59 GMT\r\n");
       out.write("Last-modified: Fri, 09 Aug 1996 14:21:40 GMT\r\n");
       out.write("\r\n");
       out.write("<TITLE>Exemple</TITLE>");
       out.write("<P>Ceci est une page d'exemple.</P>");
  }

            // on ferme les flux.
            System.err.println("Connexion avec le client terminée");
            out.close();
            in.close();
            clientSocket.close();
        }
    } 
```

此代码不包含任何错误，我从浏览器收到如下响应：

```
GET / HTTP/1.1
Host: localhost:1989
Connection: keep-alive
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.46 Safari/536.5 Comodo_Dragon/19.0.3.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

但我的问题是我在浏览器上没有页面？请问有什么帮助吗？

PS：我已经读过这篇文章：[http](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol) ://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol ，（我很抱歉法语......）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-28T17:13:04.173

除了`\r\n`在每个请求标头行之后，您还必须在标头之后发送一个空行。例子：

```
out.write("HTTP/1.0 200 OK\r\n");
// Header...
out.write("Last-modified: Fri, 09 Aug 1996 14:21:40 GMT\r\n");
out.write("\r\n"); // The content starts afters this empty line
out.write("<TITLE>Hello!</TITLE>");
// Content... 
```

我更正了您的代码以使其正常工作（但它仍然不完美，您应该在单独的线程中处理每个请求，例如使用`java.util.concurrent.ThreadPoolExecutor`）：

```
public static void main(String[] args) throws Exception {
    // création de la socket
    int port = 1989;
    ServerSocket serverSocket = new ServerSocket(port);
    System.err.println("Serveur lancé sur le port : " + port);

    // repeatedly wait for connections, and process
    while (true) {
        // on reste bloqué sur l'attente d'une demande client
        Socket clientSocket = serverSocket.accept();
        System.err.println("Nouveau client connecté");

        // on ouvre un flux de converation

        BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
        BufferedWriter out = new BufferedWriter(new OutputStreamWriter(clientSocket.getOutputStream()));

        // chaque fois qu'une donnée est lue sur le réseau on la renvoi sur
        // le flux d'écriture.
        // la donnée lue est donc retournée exactement au même client.
        String s;
        while ((s = in.readLine()) != null) {
            System.out.println(s);
            if (s.isEmpty()) {
                break;
            }
        }

        out.write("HTTP/1.0 200 OK\r\n");
        out.write("Date: Fri, 31 Dec 1999 23:59:59 GMT\r\n");
        out.write("Server: Apache/0.8.4\r\n");
        out.write("Content-Type: text/html\r\n");
        out.write("Content-Length: 59\r\n");
        out.write("Expires: Sat, 01 Jan 2000 00:59:59 GMT\r\n");
        out.write("Last-modified: Fri, 09 Aug 1996 14:21:40 GMT\r\n");
        out.write("\r\n");
        out.write("<TITLE>Exemple</TITLE>");
        out.write("<P>Ceci est une page d'exemple.</P>");

        // on ferme les flux.
        System.err.println("Connexion avec le client terminée");
        out.close();
        in.close();
        clientSocket.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-03T14:16:06.377

这只是您最后一个问题的答案，浏览器中看不到任何内容的原因是您计算的字符数不正确。

它应该是 57 而不是 59。

更好的是自动计算字符数，但我相信您的样本只是一个样本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:03:13.567

你用的是什么机器？什么操作系统？如果您运行的是 UNIX 机器，那么 println 将不起作用，因为它只发送一个 LF 字符。HTTP 需要 CR 和 LF 作为其标头。尝试将 \r 添加到字符串的末尾，看看是否有效。

哦，还有，你的：

```
 out.println("HTTP/1.0 200 OK"+
"Date: Fri, 31 Dec 1999 23:59:59 GMT"+
"Server: Apache/0.8.4"+
"Content-Type: text/html"+
"Content-Length: 59"+
"Expires: Sat, 01 Jan 2000 00:59:59 GMT"+
"Last-modified: Fri, 09 Aug 1996 14:21:40 GMT"+ 
```

它正在打印一个长字符串。

将它们更改为每个字符串的 println，或将 \r\n 添加到字符串中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T17:03:57.057

`\r\n`您需要在每行输出之间使用正确的行分隔符 ( )。仅仅连接它们是不够的 - 如果您打印出响应，您可以看到它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-07T08:33:49.003

只是提醒一下：这*不是*一个 HTTP 服务器，正如标题所暗示的那样。它是一个套接字，它写出一个特定的硬编码 HTTP 响应（假设它是根据其他答案中的建议修复的）。即使您动态更改了返回的内容和内容长度标头，这仍然不足以符合 HTTP 协议。

正如我在编写[JLHTTP](http://www.freeutils.net/source/jlhttp/)时所学的那样，HTTP 远不止这些。不是很复杂，只是有很多额外的细节和要求需要妥善处理。您可以阅读 RFC（核心协议在 RFC 7230 或较旧的 RFC 2616 中定义）以了解有关这需要的更多信息。

我还可以提供 JLHTTP 源代码作为 HTTP 服务器的一个有据可查的最小兼容实现的参考 - 它是一个文件，目前约 3K 行，其中几乎一半是文档。它的目标是小而顺从。我认为查看代码对于任何想要了解 HTTP 服务器必须做什么的人都是有用的。正如我所说 - 不是很复杂，但有很多小细节。

实际上，准确地说，JLHTTP 并没有尽可能小——它确实包含一些有用的额外功能，例如处理文件上传的多部分表单数据或支持 HTTPS，这些不是 HTTP 协议本身所要求的。但是您可以轻松地将这些部分去掉（或跳过它们）并实现真正最小的 Java HTTP 服务器实现。

# javascript - 与 Javascript 中的 NaN 比较

> ID：10788128
> 
> 赞同：1
> 
> 时间：2012-05-28T17:01:38.097
> 
> 标签：javascript, parsing, floating-point

我遇到了这个奇怪的问题。

![在此处输入图像描述](../Images/4590f4d245ba84ea840d1ca950b49771.png)

为什么会这样？！应该是这样吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-28T17:05:00.330

来自[MDN 文档`isNaN`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/isNaN)：

> 与 JavaScript 中所有其他可能的值不同，不可能依赖相等运算符（== 和 ===）来确定一个值是否为 NaN，因为 NaN == NaN 和 NaN === NaN 都计算为错误的。因此，isNaN 函数的必要性。

改为使用[`isNaN`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/isNaN)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-28T17:17:49.740

这背后的原因是应该保留数学规则。否则，就会有`x == x + 1`if `x`is `NaN`，这对于 x 的任何其他值都不是真正的关系。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T17:05:22.070

这就是为什么我们使用

```
isNaN(x) 
```

似乎 x 是一个 NaN 对象，它不等于另一个

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-28T17:04:34.077

`NaN is`像一个 SQL `null`。它永远不等于任何东西，包括它自己。这就是为什么有特殊情况功能`isNaN()`可以安全地测试`NaN`' 的存在。

# primefaces - primefaces 数据表的自定义过滤器

> ID：10788130
> 
> 赞同：1
> 
> 时间：2012-05-28T17:01:49.420
> 
> 标签：primefaces

我正在使用 PF3.2、JSF 2.0 和 GF 3.1。

我有一个数据表，上面有一个自定义过滤器。在 Firefox 中一切正常，但数据表在 IE 中没有更新。当我单击页面中的任何位置时，将触发 ajax 并更新数据表。

这是代码 -

```
<p:dataTable id="std"
                                             value="#{myController.stdList}"
                                             selection="#{myController.std}"
                                             selectionMode="multiple"
                                             var="std"
                                             widgetVar="empTable"
                                             paginator="true"
                                             pageLinks="5"
                                             paginatorPosition="bottom"
                                             paginatorAlwaysVisible="true"
                                             currentPageReportTemplate="Page {currentPage} of {totalPages}"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                             rows="10"
                                             rowKey="#{std}"
                                             sortBy="#{std.lastName}"
                                             sortOrder="ascending"
                                             >
                                    <p:ajax event="rowSelect" 
                                            listener="#{myController.onRowSelectListener}" 
                                            process="@this"
                                            update="std"
                                            /> 

                                    <f:facet name="header">  
                                        <p:outputPanel>  
                                            <h:outputText value="#{bundle.GlobalFilterPrompt}" />  
                                    <p:inputText id="stdFilter" 
                                                 style="width:150px" 
                                                 valueChangeListener="#{myController.stdListener}">
                                        <p:ajax update="attendees" 
                                                process="@this" 
                                                event="change"
                                                />                     
                                    </p:inputText> 
```

stdListener 方法从输入框中读取值，获取新数据并更新数据表。

为什么它在 IE 中不起作用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-31T19:25:37.793

通过使用 PrimeFaces remoteCommand 调用 dataTable 的 AJAX/jQuery filter() 函数，我取得了成功：

```
<p:inputText id="stdFilter" value="#{myController.myFilterValue}"
         style="width:150px">

<p:ajax event="change" onsuccess="myFilterUpdateCommand();"/>

<p:remoteCommand id="myRemoteCommandId" name="myFilterUpdateCommand"
                 actionListener="#{myController.stdListener()}"
                 update="attendees"
                 oncomplete="empTable.filter();"/> 
```

我认为您需要向 inputText 组件添加一个值，以将过滤器值传递给模型/支持 bean。

# paypal - 自适应支付：如何从关闭网址关闭灯箱？

> ID：10788135
> 
> 赞同：0
> 
> 时间：2012-05-28T17:02:10.607
> 
> 标签：paypal, paypal-adaptive-payments

我有 GWT 应用程序，它与 AdaptivePayment API 上的灯箱集成。

我无法使用提供的代码关闭取消/返回页面：

```
dgFlow = top.dgFlow || top.opener.top.dgFlow; 
    dgFlow.closeFlow(); 
    top.close(); 
```

我尝试从包含取消/返回页面的 iframe 内部/外部调用上述代码，但未能解除流程。有人可以给我一个用例的例子吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:32:39.717

我在打电话：

```
 var dgFlow = new $wnd.PAYPAL.apps.DGFlow({ trigger: 'invokeOverlay' }); 
```

JSNI 方法在 IFrame 中进行了标记，因此 dgFlow 从来都不是全局变量。

```
 $wnd.dgFlow = new $wnd.PAYPAL.apps.DGFlow({ trigger: 'invokeOverlay' }); 
```

将变量添加到文档 Window 以使其显式全局化。

# symfony - Twig/Symfony 2 中的 Instanceof 运算符？

> ID：10788138
> 
> 赞同：18
> 
> 时间：2012-05-28T17:02:20.270
> 
> 标签：symfony, twig

我有一个像这样的混合数组（手机号码和实体）：

```
$targets = array();

$targets[] = '+32647651212';
$targets[] = new Customer(); 
```

在我的 Twig 模板中，我必须调用`getMobile()`if `target`is a`Customer`或仅打印数字（如果它实际上是数字（`string`））。

`instanceof`Twig 中有类似运算符的东西吗？

```
<ul>
{% for target in targets %}
   <li>{{ target instance of MyEntity ? target.getMobile : target }}</li>
   {% else %}
       <li>Nothing found.</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-11-20T11:53:10.543

在 \Twig_Extension 你可以添加测试

```
public function getTests()
{
    return [
        'instanceof' =>  new \Twig_Function_Method($this, 'isInstanceof')
    ];
}

/**
 * @param $var
 * @param $instance
 * @return bool
 */
public function isInstanceof($var, $instance) {
    return  $var instanceof $instance;
} 
```

然后像这样使用

```
{% if value is instanceof('DateTime') %} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-10-20T11:10:18.380

## 更新 10-2021

请注意，此答案是为 symfony 3 和 twig 2 编写的。 **如果您使用更新的版本，请参阅本文[中@Garri Figueroa 的答案](https://stackoverflow.com/a/58419702/4786243)**。

正如您在[twig 文档](https://twig.symfony.com/doc/2.x/deprecated.html#miscellaneous)`\Twig_Extension`中看到的那样，该类`\Twig_SimpleTest`现在已被弃用。

如果您使用更新版本的 symfony（我推荐它），请使用新的类`AbstractExtension`，`TwigFunction`等等 [https://symfony.com/doc/5.3/templating/twig_extension.html](https://symfony.com/doc/5.3/templating/twig_extension.html)

* * *

## 旧版本：symfony 3.4

这是使用 Extension 在 twig中执行**instanceof运算符的好方法：**

## 1）在你想要的地方创建你的扩展文件

（例如：src/OC/YourBundle/Twig/InstanceOfExtension.php）

使用 \Twig_Extension 你可以做很多事情，过滤器，功能，但现在我们将创建一个测试。

所以我们实现了函数 getTests()，并在其中创建了一个新的 \Twig_SimpleTest

第一个参数是您创建的测试的名称，第二个参数是可调用的。（可以是函数（）{}）。

```
<?php

namespace OC\YourBundle\Twig;

class InstanceOfExtension extends \Twig_Extension {

    public function getTests() {
        return array(
            new \Twig_SimpleTest('instanceof', array($this, 'isInstanceOf')),
         );
     }

    public function isInstanceOf($var, $instance) {
        $reflexionClass = new \ReflectionClass($instance);
        return $reflexionClass->isInstance($var);
    }
} 
```

## 2) 在 services.yml 中注册

（例如：src/OC/YourBundle/Resources/config/services.yml）

```
services:

    [...may you have other services ...]

    app.twig_extension:
        class: OC\YourBundle\Twig\InstanceOfExtension
        public: false
        tags:
          - { name: twig.extension } 
```

## 3）然后像这样在树枝中使用它

```
{{ myvar is instanceof('\\OC\\YourBundle\\Entity\\YourEntityOrWhatEver') }} 
```

来自 Adrien Brault => [https://gist.github.com/adrienbrault/7045544](https://gist.github.com/adrienbrault/7045544)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-10-16T18:35:50.410

我对 Symfony 4.3 的解决方案

1) 在 src/Twig 文件夹中创建 AppExtension 类。（自动检测类）。

2) 扩展 AbstractExtension 类：

```
namespace App\Twig;

use Twig\Extension\AbstractExtension;
use Twig\TwigTest;

class AppExtension extends AbstractExtension
{
    public function getTests()
    {
        return [
            new TwigTest('instanceof', [$this, 'isInstanceof'])
        ];
    }

    /**
     * @param $var
     * @param $instance
     * @return bool
     */
    public function isInstanceof($var, $instance) {
        return  $var instanceof $instance;
    }
} 
```

3）然后使用相同的 valdas.mistolis 代码回答：

```
{% if value is instanceof('DateTime') %} 
```

4) 感谢 valdas.mistolis 和 symfony 文档，我得到了自己的解决方案： [Twig Extension 模板](https://symfony.com/doc/current/templating/twig_extension.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-07-25T13:42:05.400

从 PHP 5.5.0 开始，您可以通过以下方式比较类名：

```
{{ constant('class', exception) is constant('\\Symfony\\Component\\HttpKernel\\Exception\\HttpException') }} 
```

当您需要严格比较类名时，此代码段可以在特定情况下提供帮助。如果您需要检查接口的实现或检查继承，最好创建上述树枝扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-16T15:25:15.933

另一个解决方案：

```
class A {
    ...
    public function isInstanceOfB() {
        return $this instanceof B;
    }
}

class B extends A {}
class C extends A {} 
```

然后在你的树枝上：

```
{{ a.isInstanceOfB ? ... something for B instance ... : ... something for C instance ... }} 
```

或者

```
{% if a.isInstanceOfB %}
    ... do something for B instance ...
{% else %}
    ... do something for C instance ...
{% endif %} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-10T12:47:45.853

其他没有 ReflectionClass 和树枝过滤器的解决方案：

首先你需要一个 TwigExtension 类。然后，添加一个函数作为树枝过滤器或树枝函数，

```
namespace App\Twig;

use Twig\Extension\AbstractExtension;
use Twig\TwigFilter;
use Twig\TwigFunction;

class TwigExtension extends AbstractExtension

    /**
     * @return array|\Twig_Filter[]
     */
    public function getFilters()
    {
        return [           
            new TwigFilter('is_instance_of', [$this, 'isInstanceOf'])
        ];
    }

    /**
     * @param $object
     * @param $class
     * @return bool
     */
    public function isInstanceOf($object, $class): bool
    {
        return is_a($object, $class, true);
    }
} 
```

在树枝模板中：

```
 {% if true is same as (object|is_instance_of('ClassName')) %}
   // do some stuff
{% endif %} 
```

检查[http://php.net/manual/fr/function.is-a.php](http://php.net/manual/fr/function.is-a.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-12T07:28:38.247

遍历 Symfony 表单时的另一个示例：

```
namespace App\Twig;

use Twig\Extension\AbstractExtension;
use Twig\TwigTest;
use App\Document\Embeded\Image;
use App\Document\Embeded\Gallery;
use App\Document\Embeded\Article;

class AppExtension extends AbstractExtension
{
    public function getTests()
    {
        return [
            new TwigTest('image', [$this, 'isImage']),
            new TwigTest('gallery', [$this, 'isGallery']),
            new TwigTest('article', [$this, 'isArticle']),
        ];
    }

    public function isImage($var) {
        return $var instanceof Image;
    }

    public function isGallery($var) {
        return $var instanceof Gallery;
    }

    public function isArticle($var) {
        return $var instanceof Article;
    }
} 
```

枝条

```
{% if form.vars.data is gallery %}
    This is a Gallery 
{% elseif  form.vars.data is article %}
    This is an Article
{% endif %} 
```

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2012-05-28T19:15:01.433

[`default`像这样在 Twig 中](http://twig.sensiolabs.org/doc/filters/default.html)使用过滤器：

```
{{ target.mobile|default(target) }} 
```

* * *

## 回答 #9

> 赞同：-10
> 
> 时间：2016-05-08T19:28:31.407

很老了，但我在这里看不到实现这一目标的另一种可能性：

实体：

```
public function __toString()
{
    return 'NameOfYourEntity';
} 
```

枝条：

```
{{ entity }} 
```

# xcode - 在自定义中从 TextField 中关闭键盘

> ID：10788142
> 
> 赞同：1
> 
> 时间：2012-05-28T17:02:35.020
> 
> 标签：xcode, uitextfield, uitableview

在 UITableViewController 中使用自定义单元格。在自定义单元格中有一个 TextField。当用户触摸键盘外部时需要关闭键盘。在自定义单元格的 .m 文件中添加了此代码；

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    [holeScoreTextField resignFirstResponder];
} 
```

当用户触摸另一个单元格或同一单元格内时，这确实有效。问题是 UITableViewController 中有一个包含一些信息的视图。上面的代码不适用于该视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T05:01:33.977

一个非常快速、肮脏和简单的解决方案是在整个屏幕上简单地创建一个全屏大小的不可见按钮。键盘将始终出现在该视图的顶部。`viewWillAppear:`在和上隐藏视图`textFieldShouldEndEditing:`，并在 上显示`textFieldShouldBeginEditing:`。

应该像魅力一样工作。

# javascript - html5中精灵图像的xy坐标和宽高

> ID：10788145
> 
> 赞同：0
> 
> 时间：2012-05-28T17:02:52.057
> 
> 标签：javascript, image, html, sprite

我有一个有很多图像的精灵。

有没有什么方法（可能是一个应用程序）可以让我从精灵中获取图像的 xy 坐标，而不是猜测这些参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T02:26:06.560

我以前做过这个，非常简单，鼠标单击并拖动

[获取SpriteXY](https://getspritexy.netlify.com/)

[![在此处输入图像描述](../Images/4e87867063efd2e88cf135016d2eea7b.png)](https://i.stack.imgur.com/Urry3.png)

使用 Chrome 或 Firefox。不适用于 IE 和 Safari

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:08:22.817

如果您在 Photoshop 或其他图像编辑软件中制作了精灵，通常可以从中获取坐标。或者，您可以使用[SpriteCow 之类的东西！](http://www.spritecow.com/)

# javascript - 为什么我的图片不会显示在我的引导轮播中？

> ID：10788147
> 
> 赞同：1
> 
> 时间：2012-05-28T17:03:00.697
> 
> 标签：javascript, ruby-on-rails, twitter-bootstrap

就从图片移动到图片而言，我似乎让 Twitter Bootstrap 轮播正常工作，但是，图片没有显示。我得到下面的小图像图标，我看到它们以适当的间隔在页面上滑动。我正在尝试在我的本地主机上的 rails 项目中使用它。我是编程新手，我为尝试找到答案而进行的所有搜索都没有成功。下面我包含了 HTML。此外，图像位于 HTML 中下面列出的源位置，它们是 jpeg。

如果这有什么不同，我正在尝试将其合并到我的主页中。我很感激帮助。

```
<div id="myCarousel" class="carousel">
<!-- Carousel items -->
<div class="carousel-inner">
<div class="active item">
<img src="assets/images/pic1.jpg" alt></div>
<div class="item">
<img src="assets/images/pic2.jpg" alt></div>
<div class="item">
<img src="assets/images/pic3.jpg" alt></div>
</div>
<!-- Carousel nav -->
<a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
<a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T00:08:25.017

I ran into the same problem of not having the images show up and I believe it has to due with the naming of each jpg file. In my HTML the image tags were pointing to pic.**jpg** but on my webhost, the files were named as pic.**JPG** and that actually makes a difference. So either rename it your html or the actual file and it should solve your problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:19:16.497

而不是`<img src="assets/images/pic1.jpg" alt>`，您应该使用图像助手：

```
<%= image_tag 'pic1.jpg' %> 
```

如果您的 pic1.jpg 在 app/assets/images 文件夹中，它将显示。

# wordpress - wordpress 自定义帖子类型无法更改显示顺序

> ID：10788148
> 
> 赞同：0
> 
> 时间：2012-05-28T17:03:04.963
> 
> 标签：wordpress, custom-post-type

我创建了一个自定义帖子类型，用于从我的投资组合网站上的博客中手工摘录。我有一个内容窗口、一个链接和一个帖子类型的特色图片，我称之为`blog`.

问题是，无论我尝试什么，帖子都会从最旧到最新显示，而我想先显示最新的。这是`query_posts()`电话：

`<?php query_posts( 'post_type=blog&order=ASC'); ?>`

但我也尝试过更复杂的查询，例如：

`<?php query_posts(array('post_type' => 'blog', 'orderby'=>'date','order'=>'ASC')); ?>`

我的完整模板文件如下所示：` ">

# 

```
 <div class="sliderContent">
        <!--first loop-->
        <?php if (have_posts()) : while (have_posts()) : the_post(); ?> 
        <?php the_content(__('Read More &raquo;', THEMENAME)); ?>
        <?php endwhile; else: ?>
        <p><?php _e('Nothing found.', THEMENAME); ?></p>
        <?php endif; ?>

        <!--second loop, displays custom post type-->
        <?php query_posts(array('post_type' => 'blog', 'orderby'=>'date','order'=>'ASC') ); ?>
        <?php if (have_posts()) : while (have_posts()) : the_post(); ?>
        <div class="contenttile">
            <p><a href="<?php echo get_post_meta($post->ID, 'Permalink', true); ?>"><?php the_post_thumbnail('medium'); ?></a></p>
            <h2><?php the_title(); ?></h2>

            <?php the_content(__('Read More &raquo;', THEMENAME)); ?>
        </div>
        <?php endwhile; else: ?>
        <p><?php _e('Nothing found.', THEMENAME); ?></p>
        <?php endif; ?>
    </div>
</div>
<!-- content end -->

<?php } ?> 
```

`

因此，我将显示应用此模板的页面中的内容，然后显示我的自定义帖子类型。

感谢您的帮助，我很难过！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:52:09.387

您的查询按升序排列。升序是从最旧到最新。如果您想要最新到最旧，则需要 DESCENDING 顺序。此外，您应该尽可能避免使用 query_posts，因为它会修改默认的 Wordpress 循环。

您的第二个查询并不比第一个更复杂。唯一的区别是您使用数组而不是字符串来定义查询参数（数组可以说是正确的方法），并且您正在设置 orderby 参数。

最后，默认顺序是按日期降序排列（从最新到最旧），因此理论上您甚至不需要定义 order 和 orderby 参数。

尝试这个：

```
 <!--second loop, displays custom post type-->
    <?php
    $args = array('post_type' => 'blog', 'orderby'=>'date','order'=>'DESC');
    /*Consider changing to: $args = array('post_type' => 'blog');*/
    $query = new WP_Query($args);
    if ($query->have_posts()) : while ($query->have_posts()) : $query->the_post();
    ?>
    <div class="contenttile">
        <p><a href="<?php echo get_post_meta($post->ID, 'Permalink', true); ?>"><?php the_post_thumbnail('medium'); ?></a></p>
        <h2><?php the_title(); ?></h2>

        <?php the_content(__('Read More &raquo;', THEMENAME)); ?>
    </div>
    <?php endwhile; else: ?>
    <p><?php _e('Nothing found.', THEMENAME); ?></p>
    <?php
    endif;
    wp_reset_postdata();
    ?>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:14:51.607

好吧，正如majorano84所暗示的那样，在进一步阅读之后`query_posts()`根本就不是正确的功能（因为我猜它为服务器带来了更多的工作？）

相反，我使用了 get_posts()，它以首选顺序显示帖子，而无需我做任何进一步的努力：

```
 <?php
            $args = array( 'post_type' => 'blog' );
            $lastposts = get_posts( $args );
            foreach($lastposts as $post) : setup_postdata($post); ?>
                <div class="contenttile">
                        <p><a href="<?php echo get_post_meta($post->ID, 'Permalink', true); ?>"><?php the_post_thumbnail('medium'); ?></a></p>
                        <h2><?php the_title(); ?></h2>
                        <?php the_content(); ?>
                </div>
        <?php endforeach; ?> 
```

`

所以我将把它称为答案，因为它解决了我遇到的问题。谢谢！

# c# - 连接状态已打开但无效？

> ID：10788159
> 
> 赞同：0
> 
> 时间：2012-05-28T17:03:46.027
> 
> 标签：c#, mysql, database, connection

我有这段代码用于将一个表复制到另一个表，但是在执行命令语句时出现错误。

错误表示连接未打开或无效。当我调试时，我可以看到它已打开。真不知道为什么无效。

```
con.ConnectionString = ConfigurationManager.ConnectionStrings["Con2"].ConnectionString;
con.Open();
cmd = new MySqlCommand("SELECT COUNT(*) FROM " + ConfigSettings.ReadSetting("main_base"), con);
int nRows = Convert.ToInt32(cmd.ExecuteScalar());
con.Close();
if (nRows > 0)
{
    con.ConnectionString = ConfigurationManager.ConnectionStrings["Con1"].ConnectionString;
    con.Open();
    cmd = new MySqlCommand("INSERT INTO temp_data SELECT * FROM data");
    cmd.ExecuteScalar();
} 
```

一切顺利，直到最后一个命令：

```
cmd = new MySqlCommand("INSERT INTO temp_data SELECT * FROM data");
cmd.ExecuteScalar(); 
```

如果这两个数据库位于不同的服务器上，这甚至可能吗？也许我需要同时打开两个连接或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:09:40.230

将连接对象传递给`MySqlCommand`构造函数：

```
cmd = new MySqlCommand("INSERT INTO temp_data SELECT * FROM data", con); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:12:17.043

```
using (var conn = new MySqlConnection(ConfigurationManager.ConnectionStrings["Con2"].ConnectionString))
{
    conn.Open();
    using (var cmd = conn.CreateCommand())
    {
        cmd.CommandText ="SELECT COUNT(*) FROM " + ConfigSettings.ReadSetting("main_base");
        int nRows = Convert.ToInt32(cmd.ExecuteScalar());
        if (nRows > 0)
        {
            using (var conn2 = new MySqlConnection(ConfigurationManager.ConnectionStrings["Con1"].ConnectionString))
            {
                conn2.Open();
                using (var cmd2 = conn2.CreateCommand())
                {
                    cmd2.CommandText ="INSERT INTO temp_data SELECT * FROM data";
                    cmd2.ExecuteScalar();
                }
            }
        }
    }
} 
```

# php - PHP SoapClient：stdClass 类的对象无法转换为字符串

> ID：10788167
> 
> 赞同：3
> 
> 时间：2012-05-28T17:05:01.790
> 
> 标签：php, soap-client

我正在犯一个可能是一个非常简单的错误，但似乎无法解决。我正在尝试使用 PHP SoapClient 库向 Web 服务发送 SOAP 请求。尝试打印时出现以下错误：

> “stdClass 类的对象无法转换为字符串”

这是代码，主要取自 PHP SoapClient 手册。

```
<?php

try { 
    $options = array( 
                     'soap_version'=>SOAP_1_2, 
                     'exceptions'=>true, 
                     'trace'=>1, 
                     'cache_wsdl'=>WSDL_CACHE_NONE 
                    ); 
    $client = new SoapClient('http://www.webservicex.net/ConvertTemperature.asmx?WSDL', $options); 

    $results = $client->ConvertTemp(array('Temperature'=>'100', 'FromUnit' => 'degreeCelsius',
                                          'ToUnit' => 'degreeFahrenheit')); 
    } 
    catch (Exception $e) 
    { 
      echo "<h2>Exception Error!</h2>"; 
      echo $e->getMessage(); 
    } 

$results = $client->ConvertTemp(array('Temperature'=>'100', 'FromUnit' => 'degreeCelsius',
                                    'ToUnit' => 'degreeFahrenheit')); 

print $results;
?> 
```

我了解该消息告诉我我正在尝试打印整个对象而不是该对象的成员。我不明白的是，我期望调用 ConvertTemp 来返回一个字符串。为什么要返回一个对象？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:13:35.937

好吧，您的期望可能是错误的。A `var_dump`or`print_r`可以阐明`$results`实际情况，重新检查 wsdl 可以告诉您原因：

提示`__getTypes()`：：

```
struct ConvertTempResponse {
 double ConvertTempResult;
} 
```

# regex - 如何使用 Notepad++ 表达式删除所有 html 图像？

> ID：10788174
> 
> 赞同：2
> 
> 时间：2012-05-28T17:05:26.133
> 
> 标签：regex, notepad++

我有大约 150 张包含在链接中的图像。我需要删除图像而不是链接。

```
<a href="#whatever" title="my title"><img src="/img/floors/kellet/3.jpg" /></a> 
```

使用记事本++的表达式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:14:33.627

使用此正则表达式来捕获所有情况：

```
<img(?=\s|>)(?:(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+)?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:07:09.413

我会尝试这个正则表达式：

```
<img .*? /> 
```

它适用于 Python：

```
>>> import re
>>> string = '''<a href="#whatever" title="my title"><img src="/img/floors/kellet/3.jpg" /></a>'''
>>> re.sub(r'<img .*? />', '', string)
'<a href="#whatever" title="my title"></a>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:17:45.243

这应该有效（仅匹配锚标签内的图像），

```
<a ?.*?><img ?.*? \/><\/a> 
```

***ps**我是正则表达式的初学者。*

# java - 读取java中的特殊字符

> ID：10788175
> 
> 赞同：1
> 
> 时间：2012-05-28T17:05:47.397
> 
> 标签：java, parsing, character-encoding, character

我有一个问题，我正在尝试从文件中读取一组键和值对（如字典）。为此，我使用以下代码：

```
 InputStream is = this.getClass().getResourceAsStream(PROPERTIES_BUNDLE);
     properties=new Hashtable();

     InputStreamReader isr=new InputStreamReader(is);
     LineReader lineReader=new LineReader(isr);
     try {
        while (lineReader.hasLine()) {
            String line=lineReader.readLine();
            if(line.length()>1 && line.substring(0,1).equals("#")) continue;
            if(line.indexOf("=")!=-1){
                String key=line.substring(0,line.indexOf("="));
                String value=line.substring(line.indexOf("=")+1,line.length());
                properties.put(key, value);
            }               
        }
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

和 readLine 函数。

```
 public String readLine() throws IOException{
    int tmp;
    StringBuffer out=new StringBuffer();
    //Read in data
    while(true){
        //Check the bucket first. If empty read from the input stream
        if(bucket!=-1){
            tmp=bucket;
            bucket=-1;
        }else{
            tmp=in.read();
            if(tmp==-1)break;
        }
        //If new line, then discard it. If we get a \r, we need to look ahead so can use bucket
        if(tmp=='\r'){
            int nextChar=in.read();
            if(tmp!='\n')bucket=nextChar;//Ignores \r\n, but not \r\r
            break;
        }else if(tmp=='\n'){
            break;
        }else{
            //Otherwise just append the character
            out.append((char) tmp);
        }
    }
    return out.toString();
} 
```

一切都很好，但是我希望它能够解析特殊字符。例如： ó 这将被编入 \u00F3，但在这种情况下，它不会用正确的字符替换它......该怎么做？

编辑：忘了说，因为我使用的是 JavaME，所以 Properties 类或任何类似的东西都不存在，这就是为什么我似乎在重新发明轮子......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:09:16.873

如果它是用 UTF-16 编码的，你能不只是 `InputStreamReader isr = new InputStreamReader(is, "UTF16")`吗？

这将从一开始就识别您的特殊字符，您无需进行任何替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:08:39.447

您需要确保在 InputStreamReader 中将字符编码设置为文件的字符编码。如果它不匹配某些字符可能是不正确的。

# ios - Phonegap/Cordova 取消文件传输下载

> ID：10788178
> 
> 赞同：2
> 
> 时间：2012-05-28T17:06:03.410
> 
> 标签：ios, cordova, download

有谁知道在 iOS Phonegap 上取消 fileTransfer.download() 的方法？文档很简单，我怀疑它还没有实现。

[http://docs.phonegap.com/en/1.7.0/cordova_file_file.md.html#FileTransfer](http://docs.phonegap.com/en/1.7.0/cordova_file_file.md.html#FileTransfer)

如果取消，我想防止回调触发。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:17:48.073

嗯...是的，这看起来像是我们在 API 中遗漏的部分。我为此在 JIRA 上提出了一个问题。

[https://issues.apache.org/jira/browse/CB-836](https://issues.apache.org/jira/browse/CB-836)

# c - 使用 MPI_Scatter 发送矩阵的列

> ID：10788180
> 
> 赞同：12
> 
> 时间：2012-05-28T17:06:23.457
> 
> 标签：c, mpi

我正在尝试使用 MPI 编写矩阵向量乘法程序。我正在尝试将矩阵的列发送到单独的进程并在本地计算结果。最后我做了一个`MPI_Reduce`使用`MPI_SUM`操作。

发送矩阵的行很容易，因为 C 以行优先顺序存储数组，但列不是（如果您不逐个发送它们）。我在这里读到了这个问题：

[MPI_Scatter - 发送二维数组的列](https://stackoverflow.com/questions/5512245/mpi-scatter-sending-columns-of-2d-array)

Jonathan Dursi 建议使用新的 MPI 数据类型，这就是我根据自己的需要调整他的代码所做的：

```
 double matrix[10][10];
  double mytype[10][10];
  int part_size; // stores how many cols a process needs to work on
  MPI_Datatype col, coltype;
  // ...
  MPI_Type_vector(N, 1, N, MPI_DOUBLE, &col);
  MPI_Type_commit(&col);
  MPI_Type_create_resized(col, 0, 1*sizeof(double), &coltype);
  MPI_Type_commit(&coltype);
  // ...
  MPI_Scatter(matrix, part_size, coltype,
              mypart, part_size, coltype,
              0, MPI_COMM_WORLD);

  // calculations...
  MPI_Reduce(local_result, global_result,
             N, MPI_DOUBLE,
             MPI_SUM,
             0, MPI_COMM_WORLD); 
```

这工作得很好，但我不能说我真的理解它是如何工作的。

1.  是如何`MPI_Type_vector`存储在内存中的？
2.  它是如何`MPI_Type_create_resized()`工作的，它到底是做什么的？

请记住，我是 MPI 的初学者。提前致谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-28T17:24:26.123

[在我对这个问题的回答](https://stackoverflow.com/a/9271753/463827)中对[这个问题](https://stackoverflow.com/questions/9269399/sending-blocks-of-2d-array-in-c-using-mpi/9271753#9271753)有很长的描述：很多人有这些问题的事实证明它并不明显，而且这些想法需要一些时间来适应。

重要的是要知道 MPI 数据类型描述的内存布局。调用顺序`MPI_Type_vector`为：

```
int MPI_Type_vector(int count,
                   int blocklength,
                   int stride, 
                   MPI_Datatype old_type,
                   MPI_Datatype *newtype_p) 
```

它创建了一个新类型，它描述了内存布局，其中每个`stride`项目，有一个项目块`blocklength`被拉出，以及`count`这些块的总和。这里的项目以任何单位为单位`old_type`。因此，例如，如果您调用（在此处命名参数，您实际上不能在 C 中这样做，但是:)

```
 MPI_Type_vector(count=3, blocklength=2, stride=5, old_type=MPI_INT, &newtype); 
```

然后`newtype`会像这样描述内存中的布局：

```
 |<----->|  block length

   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
   | X | X |   |   |   | X | X |   |   |   | X | X |   |   |   |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

   |<---- stride ----->|

   count = 3 
```

其中每个正方形是一个整数大小的内存块，大概是 4 个字节。请注意，步幅是从一个块的开始到下一个块的开始的整数距离，而不是块之间的距离。

好的，所以在你的情况下，你打电话给

```
 MPI_Type_vector(N, 1, N, MPI_DOUBLE, &col); 
```

这将采用`count = N`大小为`blocklength=1` `MPI_DOUBLE`s 的块，在每个 s 块的开头之间有一个空格`stride=N` `MPI_DOUBLE`。换句话说，它需要每 N'th double，总共 N 次；非常适合从（连续存储的）NxN 双精度数组中提取一列。一个方便的检查是查看有多少数据被跨过（`count*stride = N*N`这是矩阵的完整大小，检查）以及实际包含了多少数据（`count*blocksize = N`，这是一列的大小，检查。）

如果您所要做的只是调用 MPI_Send 和 MPI_Recv 来交换各个列，那么您就完成了；你可以使用这种类型来描述列的布局，你会没事的。但还有一件事。

您想调用`MPI_Scatter`，它将第一个 coltype（例如）发送到处理器 0，将下一个 coltype 发送到处理器 1，等等。如果您使用简单的 1d 数组执行此操作，则很容易找出“下一个”数据类型的位置是; 如果您将 1 个 int 分散到每个处理器，则“下一个”int 在第一个 int 结束后立即开始。

但是您的新 coltype 列的总[范围](http://www.mpi-forum.org/docs/mpi-20-html/node77.htm)从列的开头到`N*N` `MPI_DOUBLE`s 之后 - 如果 MPI_Scatter 遵循相同的逻辑（确实如此），它将开始完全在矩阵内存之外寻找“下一个”列，以此类推，下一个和下一个。你不仅不会得到你想要的答案，程序很可能会崩溃。

解决此问题的方法是告诉 MPI，该数据类型的“大小”用于计算“下一个”所在的位置是内存中一列开始位置和下一列开始位置之间的大小；也就是说，正好一个`MPI_DOUBLE`。这不会影响发送的数据量，仍然是 1 列数据；它只影响“下一个”计算。对于数组中的列（或行），您可以将此大小发送为内存中适当的步长，MPI 将选择正确的下一列进行发送。如果没有这个 resize 运算符，您的程序可能会崩溃。

当您有更复杂的数据布局时，例如在上面链接的二维数组示例的二维块中，“下一个”项目之间没有一个步长；您仍然需要调整大小以使大小成为一些有用的单位，但是您需要使用[MPI_Scatterv](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Scatterv.html)而不是 scatter 来明确指定要发送的位置。

# android - Android EditText Style.xml 更改 FOCUS EditText

> ID：10788183
> 
> 赞同：3
> 
> 时间：2012-05-28T17:06:30.090
> 
> 标签：android, focus, styles, android-edittext

下午好，

伙计们，我为所有字段 style.xml EditText 做了一个样式文件，现在当字段获得焦点时，我想更改样式。怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:23:15.070

您必须为编辑文本的每个状态定义可绘制对象。您在 drawables 文件夹中创建一个 xml 文件，该文件定义了编辑文本的所有状态可绘制对象。XML 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:drawable="@[package:]drawable/drawable_resource"
        android:state_pressed=["true" | "false"]
        android:state_focused=["true" | "false"]
        android:state_hovered=["true" | "false"]
        android:state_selected=["true" | "false"]
        android:state_checkable=["true" | "false"]
        android:state_checked=["true" | "false"]
        android:state_enabled=["true" | "false"]
        android:state_activated=["true" | "false"]
        android:state_window_focused=["true" | "false"] />
</selector> 
```

您为要指定的每个可绘制状态制作一个项目。因此，对于 state_focused 的可绘制对象，您只需执行以下操作：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:drawable="@drawable/myFocusedEditText"
        android:state_focused="true"/>
    <item
        android:drawable="@drawable/myEnabledEditText"
        android:state_enabled="true"/>
</selector> 
```

将此 XML 文件命名为 custom_edit_text.xml，确保它位于 drawables 文件夹中。然后你所要做的就是在你的styles.xml中定义

```
<style name="my_edit_text">
    <item name="android:drawable">@drawable/custom_edit_text</item>
</style> 
```

祝你好运！

# winforms - 使用 Nopcommerce v.1.9 的 BusinessLogic 无法创建 Windows 窗体应用程序

> ID：10788186
> 
> 赞同：1
> 
> 时间：2012-05-28T17:06:35.907
> 
> 标签：winforms, unity-container, nopcommerce

我的客户问我一些看起来我做起来很简单的事情。他有 nopcommerce 1.9 网站，他希望开发一个简单的 windows 窗体应用程序来修改客户地址。所以我尝试配置一个新闻窗口窗体项目：

```
static void Main(string[] args)
{
    // Code that runs on application startup
    NopConfig.Init();

    //initialize IoC
    IoC.InitializeWith(new DependencyResolverFactory());

    //initialize task manager
    TaskManager.Instance.Initialize(NopConfig.ScheduleTasks);
        TaskManager.Instance.Start();

        //open
        new FormClient().Show();

        TaskManager.Instance.Stop();
    } 
```

然后我创建了一个公开数据的服务管理器：

```
public class ServiceManager
{
    public ICustomerService CustomerService;

    public ServiceManager()
    {
        var dbContext = IoC.Resolve<NopObjectContext>();
        CustomerService = new CustomerService(dbContext);
    }

} 
```

并且无法访问`CustomerService` 方法，因为 resolve 方法找不到要实例化的具体类`NopObjectContext`；

（您可以在此位置找到 nop commerce 1.9：http: [//nopcommerce.codeplex.com/downloads/get/176949](http://nopcommerce.codeplex.com/downloads/get/176949)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T07:55:35.703

最后，它起作用了：

App.config 必须是：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="NopConfig" type="NopSolutions.NopCommerce.BusinessLogic.Configuration.NopConfig, Nop.BusinessLogic" requirePermission="false"/>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <section name="NopSolutions.NopCommerce.BusinessLogic.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>

  </configSections>
  <appSettings>
    <add key="dependencyResolverTypeName" value="NopSolutions.NopCommerce.BusinessLogic.Infrastructure.UnityDependencyResolver, Nop.BusinessLogic" />
  </appSettings>
  <connectionStrings>
    <add name="NopEntities" connectionString="metadata=res://*/Data.NopModel.csdl|res://*/Data.NopModel.ssdl|res://*/Data.NopModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=EGG-BANKS;Initial Catalog=nopvierge2;Persist Security Info=True;User ID=sa;Password=sqlserver;MultipleActiveResultSets=True;Application Name=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    <add name="NopSqlConnection" connectionString="Data Source=DAVID-TOSH\SQLEXPRESS;Initial Catalog=nop;Integrated Security=True;Persist Security Info=False;MultipleActiveResultSets=True;Connect Timeout=120" />

  </connectionStrings>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup>
  <applicationSettings>
    <NopSolutions.NopCommerce.BusinessLogic.Properties.Settings>
      <setting name="Nop_BusinessLogic_Clickatell_PushServerWS" serializeAs="String">
        <value>http://api.clickatell.com/soap/webservice_vs.php</value>
      </setting>
      <setting name="Nop_BusinessLogic_EuropaCheckVatService_checkVatService" serializeAs="String">
        <value>http://ec.europa.eu/taxation_customs/vies/services/checkVatService</value>
      </setting>
    </NopSolutions.NopCommerce.BusinessLogic.Properties.Settings>
  </applicationSettings>

  <NopConfig>
    <SqlServer ConnectionStringName="NopSqlConnection"/>
    <ScheduleTasks>
      <Thread seconds="60">
        <!--do NOT enable ClearCache task if you have enabled tracking online users-->
        <task name="ClearCache" type="NopSolutions.NopCommerce.BusinessLogic.Caching.ClearCacheTask, Nop.BusinessLogic" enabled="false" stopOnError="false"/>
        <task name="PurgeOnlineUsers" type="NopSolutions.NopCommerce.BusinessLogic.Audit.UsersOnline.PurgeOnlineUsersTask, Nop.BusinessLogic" enabled="true" stopOnError="false"/>
        <task name="Emails" type="NopSolutions.NopCommerce.BusinessLogic.Messages.SendQueuedMessagesTask, Nop.BusinessLogic" enabled="true" stopOnError="false" maxTries="5"/>
        <task name="KeepAlive" type="NopSolutions.NopCommerce.BusinessLogic.Utils.KeepAliveTask, Nop.BusinessLogic" enabled="true" stopOnError="false" path="keepalive/ping.ashx"/>
      </Thread>
      <Thread seconds="600">
        <task name="DeleteExpiredCustomerSessions" type="NopSolutions.NopCommerce.BusinessLogic.CustomerManagement.DeleteExpiredCustomerSessionsTask, Nop.BusinessLogic" enabled="true" stopOnError="false" deleteExpiredCustomerSessionsOlderThanMinutes="43200"/>
        <task name="DeleteExpiredShoppingCarts" type="NopSolutions.NopCommerce.BusinessLogic.Orders.DeleteExpiredShoppingCartsTask, Nop.BusinessLogic" enabled="false" stopOnError="false" deleteExpiredShoppingCartsOlderThanMinutes="259200"/>
      </Thread>
      <Thread seconds="60">
        <task name="UpdateExchangeRates" type="NopSolutions.NopCommerce.BusinessLogic.Directory.ExchangeRates.UpdateExchangeRateTask, Nop.BusinessLogic" enabled="true" stopOnError="false"/>
      </Thread>
      <Thread seconds="3600">
        <task name="DatabaseMaintance" type="NopSolutions.NopCommerce.BusinessLogic.Maintenance.DatabaseMaintanceTask, Nop.BusinessLogic" enabled="false" stopOnError="false"/>
      </Thread>
    </ScheduleTasks>
  </NopConfig>
</configuration> 
```

使用 program.cs 文件：

```
 static void Main(string[] args)
    {

        // Code that runs on application startup
        NopConfig.Init();

        //initialize IoC
        IoC.InitializeWith(new DependencyResolverFactory());

        //initialize task manager
        TaskManager.Instance.Initialize(NopConfig.ScheduleTasks);
        TaskManager.Instance.Start();

        new form1().show();

        TaskManager.Instance.Stop();
    } 
```

# javascript - AJAX 可折叠面板 HTML

> ID：10788188
> 
> 赞同：1
> 
> 时间：2012-05-28T17:06:48.037
> 
> 标签：javascript, asp.net, html, ajax

我正在尝试将 AJAX 可折叠面板添加到我的 HTML 页面。我知道你可以很容易地使用 asp.net 做一个 AJAX 可折叠面板。但是，我需要在已经存在的 HTML 页面中添加一个。任何想法如何使用 HTML、Javascript 和 AJAX 做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:26:19.330

1.  将 onchange 事件添加到第一个选择
2.  在处理程序中放置一个 Ajax 调用并使用结果填充第二个选择
3.  Ajax 调用应接受单个参数（查询字符串）并将键/值集合作为 Json 返回

您实际上可能会发现这种方式（使用 Jquery）比使用 ASP.net Ajax 的东西更容易。

# ios - 我需要优化 UITableViewCell 图像加载

> ID：10788199
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:07:47.170
> 
> 标签：ios, uitableview, image-loading

我有一个自定义 UITableViewCell。每个单元格都有一个独特的图像。

我有一个图像加载器类。我将字典传递给 ImageLoader 的方法。由图像 url 和一些其他信息组成的字典。当我们慢慢向下滚动 UITableView 时，这段代码运行良好。但是，如果我们快速向下滚动，它将有一些滞后。我需要优化我的算法。有任何想法吗。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
  [ImageLoader addImageToQueue:dictionary];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:29:28.057

我相信[本教程](http://www.fieryrobot.com/blog/2008/10/08/more-glassy-scrolling-with-uitableview/)将有助于回答您的问题。它涵盖了您无法平滑滚动的原因以及如何修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:36:03.050

*   禁用图像加载并测试表格行为 - 问题可能是单元格初始化缓慢，如果自定义单元格`drawRect`被覆盖，请特别注意此方法，因为文档说它的海军使用会显着减慢动画，找到优化的方法绘画。
*   如果表格在禁用图像加载的情况下平滑滚动，请考虑限制并发加载操作的数量（稍后加载挂起的操作）并在可用时使用缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:39:58.737

使用[UITableView dequeueReusableCellWithIdentifier：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)

这基本上意味着您不必每次都从头开始重新创建表格单元格。如果你给一个单元格一个重用标识符，它会在内存中保留那个单元格，并在你请求一个匹配那个标识符的单元格时让你出列它。

由于每个单元格都有一个唯一的图像，因此您最好将每个单元格的唯一标识符设置为图像中的某些内容 - 也许是图像的 URL 或文件名。这将比处理和重新创建单元格消耗更多的内存，但它会减少滚动延迟，如果您的图像很小，那么内存占用量就不会那么大。

你最终可能会得到类似的东西：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    NSString *imageURL = urlOfImageForThisCell;
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:imageURL];
    if(!cell)
    {
        cell = [self makeNewCell];
        //if your reuseIdentifier is unique to each image, you only ever need to set it's image here
        cell.image = imageForThisCell;

        cell.reuseIdentifier = imageURL;
    }

    //additional cell setup here

    return cell;
} 
```

您还需要查看子类化 UITableViewCell 和覆盖 prepareForReuse。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:10:38.700

[我会在这里](http://www.raywenderlich.com/4295/multithreading-and-grand-central-dispatch-on-ios-for-beginners-tutorial)查看 Ray Wenderlich 关于多线程和 GCD 的教程。

没有看到你的`cellForRowAtIndexPath:`或`ImageLoader`代码很难，但我怀疑你的 ImageLoader 正在减慢速度，以至于它必须等待它完成才能提供单元格。即使只是从磁盘读取图像，也应该在后台线程上异步完成，以便主线程可以专注于平滑滚动。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-15T18:15:56.000

我知道这是旧的，但我推荐这篇文章： [http ://www.nsprogrammer.com/2013/10/easy-uitableview-buffering.html](http://www.nsprogrammer.com/2013/10/easy-uitableview-buffering.html)

# javascript - 此代码阻止我的表单提交（仅在 chrome 中，适用于 IE 和 Firefox）

> ID：10788205
> 
> 赞同：0
> 
> 时间：2012-05-28T17:08:31.910
> 
> 标签：javascript, jquery, google-chrome, submit

我有这个代码，它只是在我点击提交后禁用我页面上的所有提交按钮和所有 AJAX 链接。我克隆了单击的事件，以便服务器端我知道按下了什么提交。这在 IE 和 Firefox 上完美运行，但在 chrome 上它拒绝提交任何东西。似乎它阻止了提交，因为我看到克隆已正确插入 DOM 并且控制台中没有记录任何错误。

```
// Block all other submit and ajax requests. The subscribe users burron is avoided because it handles this by itself
$( 'input[type=submit]' ).not( '#ai1ec_subscribe_users' ).click( function() {
    block_all_submit_and_ajax( this );
} );
// Disables all submit buttons after a submit button is pressed.
var block_all_submit_and_ajax = function( el ) {
    // Clone the clicked button, we need to know what button has been clicked so that we can react accordingly
    var $clone = $( el ).clone();
    // Change the type to hidden
    $clone.attr( 'type', 'hidden' );
    // Put the hidden button in the DOM
    $( el ).after( $clone );
    // Disable all submit button.
    $( '#facebook input[type=submit]' ).attr( 'disabled', true );
    // unbind all click handler from ajax
    $( '#facebook a.btn' ).unbind( "click" );
    // Disable all AJAX buttons.
    $( '#facebook a.btn' ).click( function( e ) {
        e.preventDefault();
        e.stopImmediatePropagation();
    } );
} 
```

编辑显然问题出在这条线上

```
$( '#facebook input[type=submit]' ).attr( 'disabled', true ); 
```

因为如果我评论说它也适用于 chrome。我正在使用 jQuery 1.6（但它是一个 wordpress 插件，因此版本可能会有所不同）

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:46:27.497

当您的按钮被禁用时，表单未提交添加一个 setTimeOut 来更改胎面，我会像这样工作

```
 setTimeout(function() {
$( '#facebook input[type=submit]' ).attr( 'disabled', true );

},0); 
```

它甚至可以使用 0 作为超时时间

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:21:44.080

没有看到 HTML 很难说。你可能想弄乱选择器。您可以尝试多种方法：

```
 $("#facebook [type=submit]").attr('disabled',true); 
```

甚至

```
 $("[type=submit]").attr('disabled',true); 
```

因为也许您将其作为 a`<button>`而不是`<input>`?

```
 $("#facebook button[type=submit]").attr('disabled',true); 
```

# php - FuelPHP - 订购多对多关系

> ID：10788210
> 
> 赞同：1
> 
> 时间：2012-05-28T17:09:12.230
> 
> 标签：php, orm, many-to-many, fuelphp

我检查了文档，但似乎找不到我要找的东西。我有两张桌子：

页面布局

在 (pages__layouts) 之间有一个表格，可以进行多对多操作。这很好用。但是，在引用关系时，我总是想要：

```
$p->layout[1] 
```

成为状态为 1 的**最新**布局。模型中是否存在条件多对多，或者当我第一次引用布局时是否在 Controller 中执行此操作？

我只是在需要时使用延迟加载来获取布局。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:02:58.177

您可以在关系定义上指定条件。目前，这些仅在您使用急切加载时才有效，延迟加载将忽略。

有一张未解决的票可以解决这个问题。

# python - 移除小部件的尺寸请求（Python、Gtk3）

> ID：10788211
> 
> 赞同：0
> 
> 时间：2012-05-28T17:09:15.467
> 
> 标签：python, gtk3

我想在标签中放置一些文本。我几乎设法做到了：当我放大窗口时，我在`<big>`标签上添加了一些标签，文本随着窗口放大。但是，如果我尝试缩小窗口，标签的尺寸请求不允许我这样做。

标签每秒更新很多次，所以如果我每次应用新标签时都尝试设置自定义尺寸请求，如果我尝试缩小窗口，窗口将会缩小和放大。

我想要做的是删除大小请求，没有自动换行和其他类似的东西：我只想让标签离开窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T05:42:29.953

将标签放在像 GtkScrolledWindow 这样的容器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-21T12:22:32.420

将 label 的“ellipsize”属性设置为 True。

# python-3.x - 断言包装函数

> ID：10788219
> 
> 赞同：1
> 
> 时间：2012-05-28T17:10:10.477
> 
> 标签：python-3.x, python-2.7, python, pep8

所以我在查看代码时遇到了这个有趣的问题：

```
class Foo:

  def __init__(self, foo_name):
    self.foo_doo = getattr(foo_name, 'foo_lists', None)

  def assert_foo(self, varname):
    assert hasattr(self, 'foo_%s' % varname)

  def foobar(self):
    assert_foo('doo') 
```

想知道将断言包装到您自己的自定义版本是否是更快/更好的解决方案，然后`assert hasattr(...)`每次需要确保属性存在而不是无时使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:50:34.223

最后一行将提高`NameError`，除非更改为

```
self.assert_foo('doo') 
```

除此之外，我认为不`assert`应该在上面的代码中使用或不使用包装器。更正后的行仅检查`self`已`.foo_doo`设置，但不检查它不是`None`。

```
if self.foo_doo is not None: 
```

两者都做。

如果想要一个简短的先行属性检查，可以写

```
def has_foo(self, name):
    return hasattr(self, 'foo_'+name)

def foobar(self):
    if has_foo('doo'): 
```

如果您还想要不`None`检查，请将`has_foo`返回更改为：

```
return getattr(self, 'foo_'+name, None) is not None 
```

除此之外，`assert`在生产代码中应该只用于检查内部逻辑，而不是受代码用户影响的运行时条件。用户可以删除或禁用断言，因此代码一旦发布就不应依赖断言来正常运行。

在上面的代码中，`__init__`设置`self.foo_doo`为*something*，但调用者随后可以删除该属性。因此，属性的存在和值都是用户确定的运行时条件，而不是断言的适当主题。

的`TestCase.assertXxx`方法`unittest`仅用于测试，当它们失败时，它们所做的不仅仅是包装一个简单的`assert`.

# wpf - 有没有办法在页面上的 WPF 中覆盖 OnNavigatedTo？

> ID：10788223
> 
> 赞同：5
> 
> 时间：2012-05-28T17:10:40.663
> 
> 标签：wpf, silverlight

我知道它存在于 Silverlight 但 WPF 怎么样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:30:32.167

阅读[这部分 MSDN](http://msdn.microsoft.com/en-us/library/ms750478.aspx#PageLifetime)

WPF 中的页面导航与 Silverlight/Phone 不同，因为您可以选择加入 KeepAlive。

简而言之：使用加载和卸载。KeepAlive 只会影响是否创建新实例。

**编辑**

另一种方法是订阅 this.NavigationService.Navigated 事件，但据我所知，这并不仅仅针对您的页面。

# maven - Maven 无法传输工件 junit:junit:jar:3.8.1

> ID：10788225
> 
> 赞同：2
> 
> 时间：2012-05-28T17:11:01.180
> 
> 标签：maven, maven-2

我的软件版本：

*   面向 Java 开发人员的 Eclipse：http: [//www.eclipse.org/downloads/packages/eclipse-ide-java-developers/indigosr2](http://www.eclipse.org/downloads/packages/eclipse-ide-java-developers/indigosr2)
*   SVN 插件：[http ://subclipse.tigris.org/update_1.8.x](http://subclipse.tigris.org/update_1.8.x)

异常消息：

> `Execution default-resources of goal org.apache.maven.plugins:maven-resources-plugin:2.4.3:resources failed: Plugin org.apache.maven.plugins:maven-resources-plugin:2.4.3 or one of its dependencies could not be resolved: Failure to transfer junit:junit:jar:3.8.1 from http://repo1.maven.org/maven2 was cached in the local repository, resolution will not be reattempted until the update interval of central has elapsed or updates are forced. Original error: **Could not transfer artifact junit:junit:jar:3.8.1 from/to central (http://repo1.maven.org/maven2)**: The operation was cancelled. (org.apache.maven.plugins:maven-resources-plugin:2.4.3:resources:default-resources:process-resources)`

但是 junit:junit:jar:3.8.1 可以通过以下链接找到： [http ://search.maven.org/#search%7Cga%7C1%7Cg%3A%22junit%22%20AND%20a%3A% 22junit%22%20AND%20v%3A%223.8.1%22](http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22junit%22%20AND%20a%3A%22junit%22%20AND%20v%3A%223.8.1%22)

没有任何 HTTP 代理。

我该如何解决这个问题？欢迎任何建议！

# linux - Tomcat在更改日期和时间系统后冻结

> ID：10788229
> 
> 赞同：1
> 
> 时间：2012-05-28T17:11:36.453
> 
> 标签：linux, shell, tomcat

我正在开发一个具有更改系统日期和时间功能的 GWT 应用程序。为了执行 linux date 命令（例如`date 052810242012`：），执行以下行，但之后 tomcat 冻结：

```
Runtime.getRuntime().exec(this.command);  // where this.command is the date command 
```

我已经意识到，即使应用程序启动并运行并且我在终端中更改系统日期和时间，它仍然会冻结应用程序。

有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:40:39.707

首先，我认为你要执行的命令是一个root权限的命令，所以你必须确保你的应用程序的所有者是sudoer，并且它有权执行该命令。

其次，`Runtime.getRuntime().exec()`提供JAVA执行系统命令的接口，但是直接在终端上执行是有区别的，因为它自己处理输入和输出，不会像终端一样打印在屏幕上，所以你必须处理结果JVM中的命令或将命令写入可执行的shell脚本，没有输出并调用 `Runtime.getRuntime().exec(sudo","./a.sh"};`

最后，您在终端中更改日期和时间时提到的问题导致冻结应用程序，我以前从未见过这种情况。你能详细解释一下吗？</p>

# python - 如何对齐两个大小不等的时间序列numpy数组？

> ID：10788233
> 
> 赞同：13
> 
> 时间：2012-05-28T17:11:59.713
> 
> 标签：python, alignment, time-series, closest-points

我有两个包含时间序列（unix 时间戳）的 numpy 数组。
我**想找到****差异**在**阈值**内的时间戳对（每个数组中的 1 个）。

为了实现这一点，我需要将两个时间序列数据对齐到两个数组中，这样每个索引都有最接近的对。（如果数组中的两个时间戳与另一个数组中的另一个时间戳同样接近，我不介意选择其中一个，因为对的数量比实际值更重要。）

所以对齐的数据集将有**两个****大小相同**的数组，加上一个较小的数组，其中填充了空数据。

我正在考虑使用`timeseries`包和`align`功能。
但我不确定**如何为我的时间序列数据使用对齐**。

示例考虑两个时间序列数组：

```
ts1=np.array([ 1311242821.0, 1311242882.0, 1311244025.0, 1311244145.0, 1311251330.0, 
               1311282555.0, 1311282614.0])
ts2=np.array([ 1311226761.0, 1311227001.0, 1311257033.0, 1311257094.0, 1311281265.0]) 
```

输出样本：

现在对于`ts2[2] (1311257033.0)`，它最接近的对应该是`ts1[4] (1311251330.0)`因为差异是`5703.0`，它在 之内`threshold`，并且它是最小的。既然**已经配对**`ts2[2]`，它们应该被排除在其他计算之外。`ts1[4]`

 ****应该找到这样**的对，因此输出数组可能比实际数组长

> abs(ts1[0]-ts2[0]) = 16060
> **abs(ts1[0]-ts2[1]) = 15820** //对
> abs(ts1[0]-ts2[2]) = 14212
> abs(ts1[0 ]-ts2[3]) = 14273
> 绝对值(ts1[0]-ts2[4]) = 38444
> 
> * * *
> 
> abs(ts1[1]-ts2[0]) = 16121
> abs(ts1[1]-ts2[1]) = 15881
> abs(ts1[1]-ts2[2]) = 14151
> abs(ts1[1]-ts2 [3]) = 14212
> 绝对值(ts1[1]-ts2[4]) = 38383
> 
> * * *
> 
> abs(ts1[2]-ts2[0]) = 17264
> abs(ts1[2]-ts2[1]) = 17024
> abs(ts1[2]-ts2[2]) = 13008
> abs(ts1[2]-ts2 [3]) = 13069
> 绝对值(ts1[2]-ts2[4]) = 37240
> 
> * * *
> 
> abs(ts1[3]-ts2[0]) = 17384
> abs(ts1[3]-ts2[1]) = 17144
> abs(ts1[3]-ts2[2]) = 12888
> abs(ts1[3]-ts2 [3]) = 17144
> 绝对值(ts1[3]-ts2[4]) = 37120
> 
> * * *
> 
> abs(ts1[4]-ts2[0]) = 24569
> abs(ts1[4]-ts2[1]) = 24329
> **abs(ts1[4]-ts2[2]) = 5703** //对
> abs(ts1[4 ]-ts2[3]) = 5764
> 绝对值(ts1[4]-ts2[4]) = 29935
> 
> * * *
> 
> abs(ts1[5]-ts2[0]) = 55794
> abs(ts1[5]-ts2[1]) = 55554
> abs(ts1[5]-ts2[2]) = 25522
> abs(ts1[5]-ts2 [3]) = 25461
> **abs(ts1[5]-ts2[4]) = 1290** //对
> 
> * * *
> 
> abs(ts1[6]-ts2[0]) = 55853
> abs(ts1[6]-ts2[1]) = 55613
> abs(ts1[6]-ts2[2]) = 25581
> abs(ts1[6]-ts2 [3]) = 25520
> 绝对值(ts1[6]-ts2[4]) = 1349
> 
> * * *

所以这些对是： ( `ts1[0],ts2[1]), (ts1[4],ts2[2]), (ts1[5],ts2[4]`)
其余元素应该`null`作为它们的对
最后两个数组的大小为 9。

请让我知道这个问题是否清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-21T18:52:33.700

使用`numpy Mask arrays`输出对齐 Timeseries( `_ts1`, `_ts2`) 的解决方案。
结果是 3 对，**只有**距离为 1 的对可用于对齐时间序列，然后阈值 = 1。

```
def compute_diffs(threshold):
    dtype = [('diff', int), ('ts1', int), ('ts2', int), ('threshold', int)]
    diffs = np.empty((ts1.shape[0], ts2.shape[0]), dtype=dtype)
    pairs = np.ma.make_mask_none(diffs.shape)

    for i1, t1 in enumerate(ts1):
        for i2, t2 in enumerate(ts2):
            diffs[i1, i2] = (abs(t1 - t2), i1, i2, abs(i1-i2))

        d1 = diffs[i1][diffs[i1]['threshold'] == threshold]
        if d1.size == 1:
            (diff, y, x, t) = d1[0]
            pairs[y, x] = True
    return diffs, pairs 
```

* * *

```
def align_timeseries(diffs):
    def _sync(ts, ts1, ts2, i1, i2, ii):
        while i1 < i2:
            ts1[ii] = ts[i1]; i1 +=1
            ts2[ii] = DTNULL
            ii += 1
        return ii, i1

    _ts1 = np.array([DTNULL]*9)
    _ts2 = np.copy(_ts1)
    ii = _i1 = _i2 = 0

    for n, (diff, i1, i2, t) in enumerate(np.sort(diffs, order='ts1')):
        ii, _i1 = _sync(ts1, _ts1, _ts2, _i1, i1, ii)
        ii, _i2 = _sync(ts2, _ts2, _ts1, _i2, i2, ii)

        if _i1 == i1:
            _ts1[ii] = ts1[i1]; _i1 += 1
            _ts2[ii] = ts2[i2]; _i2 += 1
            ii += 1

    ii, _i1 = _sync(ts1, _ts1, _ts2, _i1, ts1.size, ii)
    return _ts1, _ts2 
```

* * *

主要的：

```
diffs, pairs = compute_diffs(threshold=1)
print('diffs[pairs]:{}'.format(diffs[pairs]))
_ts1, _ts2 = align_timeseries(diffs[pairs])
pprint(ts1, ts2, _ts1, _ts2) 
```

> **输出**：
> 
> ```
> diffs[pairs]:[(15820, 0, 1) ( 5703, 4, 2) ( 1290, 5, 4)]
>            ts1                  ts2                    _ts1          diff          _ts2
> 0: 2011-07-21 12:07:01  2011-07-21 07:39:21     ---- -- -- -- -- --  ----   2011-07-21 07:39:21
> 1: 2011-07-21 12:08:02  2011-07-21 07:43:21     2011-07-21 12:07:01 15820   2011-07-21 07:43:21
> 2: 2011-07-21 12:27:05  2011-07-21 16:03:53     2011-07-21 12:08:02  ----   ---- -- -- -- -- --
> 3: 2011-07-21 12:29:05  2011-07-21 16:04:54     2011-07-21 12:27:05  ----   ---- -- -- -- -- --
> 4: 2011-07-21 14:28:50  2011-07-21 22:47:45     2011-07-21 12:29:05  ----   ---- -- -- -- -- --
> 5: 2011-07-21 23:09:15  ---- -- -- -- -- --     2011-07-21 14:28:50  5703   2011-07-21 16:03:53
> 6: 2011-07-21 23:10:14  ---- -- -- -- -- --     ---- -- -- -- -- --  ----   2011-07-21 16:04:54
> 7: ---- -- -- -- -- --  ---- -- -- -- -- --     2011-07-21 23:09:15  1290   2011-07-21 22:47:45
> 8: ---- -- -- -- -- --  ---- -- -- -- -- --     2011-07-21 23:10:14  ----   ---- -- -- -- -- -- 
> ```

***用 Python 测试：3.4.2***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:26:17.413

我不知道您所说的对齐时间戳是什么意思。但是您可以使用 time 模块将时间戳表示为浮点数或整数。在第一步中，您可以将任何用户格式转换为由定义的数组`time.struct_time`. 在第二步中，您可以将其转换为纪元开始的秒数。然后你有整数值来计算时间戳。

[文档](http://docs.python.org/library/time.html)`time.strptime()` 中很好地解释了如何使用转换用户格式：

```
 >>> import time
    >>> t = time.strptime("30 Nov 00", "%d %b %y")
    >>> t
    time.struct_time(tm_year=2000, tm_mon=11, tm_mday=30, tm_hour=0, tm_min=0,
             tm_sec=0, tm_wday=3, tm_yday=335, tm_isdst=-1)
    >>> time.mktime(t)
    975538800.0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-18T16:27:25.647

除了问题中的小错误之外，我可以猜测问题的真正含义。

您正在查看的是[分配问题](https://en.wikipedia.org/wiki/Assignment_problem)的经典示例。Scipy 为您提供了[匈牙利算法的实现，请在](https://en.wikipedia.org/wiki/Hungarian_algorithm)[此处](https://docs.scipy.org/doc/scipy-0.19.0/reference/generated/scipy.optimize.linear_sum_assignment.html)查看文档。它不必是时间戳，可以是任何数字（整数或浮点数）。

下面的代码片段将使用 2 个不同大小的 numpy 数组以及一个阈值，为您提供成本数组（按阈值过滤）或对应于 2 个 numpy 数组的索引对（同样，成本对由阈值过滤） .

注释将引导您完成，使用给定的时间戳数组作为示例。

```
import numpy as np
from scipy.optimize import linear_sum_assignment

def closest_pairs(inp1, inp2, threshold=np.inf):
    cost = np.zeros((inp1.shape[0], inp2.shape[0]), dtype=np.int64)

    for x in range(ts1.shape[0]):
        for y in range(ts2.shape[0]):
            cost[x][y] = abs(ts1[x] - ts2[y])

    print(cost)
    # cost for the above example:
    # [[16060 15820 14212 14273 38444]
    # [16121 15881 14151 14212 38383]
    # [17264 17024 13008 13069 37240]
    # [17384 17144 12888 12949 37120]
    # [24569 24329  5703  5764 29935]
    # [55794 55554 25522 25461  1290]
    # [55853 55613 25581 25520  1349]]

    # hungarian algorithm implementation provided by scipy
    row_ind, col_ind = linear_sum_assignment(cost)
    # row_ind = [0 1 3 4 5], col_ind = [1 0 3 2 4] 
    # where (ts1[5] - ts2[4]) = 1290

    # if you want the distances only
    out = [item 
           for item in cost[row_ind, col_ind] 
           if item < threshold]

    # if you want the pair of indices filtered by the threshold
    pairs = [(row, col) 
             for row, col in zip(row_ind, col_ind) 
             if cost[row, col] < threshold]

    return out, pairs

if __name__ == '__main__':
    out, pairs = closest_pairs(ts1, ts2, 6000)
    print(out, pairs)
    # out = [5703, 1290] 
    # pairs = [(4, 2), (5, 4)]

    out, pairs = closest_pairs(ts1, ts2)
    print(out, pairs)
    # out = [15820, 16121, 12949, 5703, 1290] 
    # pairs = [(0, 1), (1, 0), (3, 3), (4, 2), (5, 4)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-22T11:53:57.467

为了获得您的时间序列对，我建议您首先计算您的索引对 ( `get_pairs`)。然后计算您的时间序列对 ( `get_tspairs`)。

在`get_pairs`中，我首先计算一个矩阵，该矩阵`m`表示两个时间序列之间每个点的差异。所以形状的矩阵是`(len(ts1), len(ts2))`。然后我选择所有距离中最小的。为了不选择多次相同的索引，我设置了所选索引`np.inf`的距离。我继续这个过程，直到我们不能选择更多的索引元组。如果最小距离高于阈值，则过程中断。

一旦我得到我的索引对，我就会调用`get_tspairs`以生成时间序列对。这里的第一步是将时间序列与选定的索引元组连接起来，然后添加未选择的索引并将它们关联`None`（相当于 Python 中的 NULL）。

这使：

```
import numpy as np
import operator

ts1=np.array([ 1311242821.0, 1311242882.0, 1311244025.0, 1311244145.0, 1311251330.0, 
               1311282555.0, 1311282614.0])
ts2=np.array([ 1311226761.0, 1311227001.0, 1311257033.0, 1311257094.0, 1311281265.0])

def get_pairs(ts1, ts2, threshold=np.inf):
    m = np.abs(np.subtract.outer(ts1, ts2))
    indices = []
    while np.ma.masked_invalid(m).sum() != 'masked':
        ind = np.unravel_index(np.argmin(m), m.shape)
        if m[ind] < threshold:
            indices.append(ind)
            m[:,ind[1]] = np.inf
            m[ind[0],:] = np.inf
        else:
            m= np.inf
    return indices

def get_tspairs(pairs, ts1, ts2):
    ts_pairs = [(ts1[p[0]], ts2[p[1]]) for p in pairs]

    # We separate the selected indices from ts1 and ts2, then sort them
    ind_ts1 = sorted(map(operator.itemgetter(0), pairs))
    ind_ts2 = sorted(map(operator.itemgetter(1), pairs))

    # We only keep the non-selected indices
    l1 = np.delete(np.arange(len(ts1), dtype=np.int64), ind_ts1)
    l2 = np.delete(np.arange(len(ts2), dtype=np.int64), ind_ts1)

    ts_pairs.extend([(ts1[i], None) for i in l1])
    ts_pairs.extend([(ts2[i], None) for i in l2])

    return ts_pairs

if __name__ == '__main__':
    pairs = get_pairs(ts1, ts2)
    print(pairs)
    # [(5, 4), (4, 2), (3, 3), (0, 1), (1, 0)]

    ts_pairs = get_tspairs(pairs, ts1, ts2)
    print(ts_pairs)
    # [(1311282555.0, 1311281265.0), (1311251330.0, 1311257033.0), (1311244145.0, 1311257094.0), (1311242821.0, 1311227001.0), (1311242882.0, 1311226761.0), (1311244025.0, None), (1311282614.0, None), (1311257033.0, None)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-22T17:44:18.717

您有两个排序的时间戳列表，您需要将它们合并为一个，保持每个列表的元素彼此分离，计算列表切换或更改时的差异。

我的第一个解决方案是**不使用 numpy**，包括 1）将其所属列表的 id 添加到每个元素，2）按时间戳排序，3）按列表 id 分组，4）构造分离每个元素的新列表并计算需要时的区别：

```
import numpy as np
from itertools import groupby
from operator import itemgetter

ts1 = np.array([1311242821.0, 1311242882.0, 1311244025.0, 1311244145.0, 1311251330.0, 1311282555.0, 1311282614.0])               
ts2 = np.array([1311226761.0, 1311227001.0, 1311257033.0, 1311257094.0, 1311281265.0])

def without_numpy():
    # 1) Add the list id to each element
    all_ts = [(_, 0) for _ in ts1] + [(_, 1) for _ in ts2] 
    merged_ts = [[], [], []]
    # 2) Sort by timestamp and 3) Group by list id
    groups = groupby(sorted(all_ts), key=itemgetter(1))
    # 4) Construct the new list
    diff = False
    for key, g in groups:
        group = list(g)
        ### See Note    
        for ts, k in group:
            if diff:
                merged_ts[key] = merged_ts[key][:-1]
                merged_ts[2][-1] = abs(end - ts)
                diff = False
            else:
                merged_ts[not key].append(None)
                merged_ts[2].append(None)
            merged_ts[key].append(ts)
        end = ts
        diff = True
    return merged_ts 
```

**使用 numpy**，过程有点不同，包括 1) 将其所属列表的 id 和一些辅助索引添加到每个元素，2) 按时间戳排序，3) 标记列表的每个切换或更改，4)对先前的标志进行总和扫描，5）计算合并列表中每个元素的正确索引：

```
import numpy as np

ts1 = np.array([1311242821.0, 1311242882.0, 1311244025.0, 1311244145.0, 1311251330.0, 1311282555.0, 1311282614.0])
ts2 = np.array([1311226761.0, 1311227001.0, 1311257033.0, 1311257094.0, 1311281265.0])

    def with_numpy(): 
        dt = np.dtype([('ts', np.float), ('key', np.int), ('idx', np.int)])

        all_ts = np.sort(
                np.array(
                    [(_, 0, 1, 0) for _ in ts1] + [(_, 1, 1, 0) for _ in ts2], 
                    dtype=np.dtype([('ts', np.float), 
                                    ('key', np.int),    # list id
                                    ('index', np.int),  # index in result list
                                    ('single', np.int), # flag groups with only one element
                                   ])
                ), 
                order='ts'
            )

        #### See NOTE

        sh_dn = np.roll(all_ts, 1)

        all_ts['index'] = np.add.accumulate(all_ts['index']) - np.cumsum(
                            np.not_equal(all_ts['key'], sh_dn['key']))

        merged_ts = np.full(shape=(3, all_ts['index'][-1]+1), fill_value=np.nan)
        merged_ts[all_ts['key'], all_ts['index']] = all_ts['ts']
        merged_ts[2] = np.abs(merged_ts[0] - merged_ts[1])
        merged_ts = np.delete(merged_ts, -1, axis=1)
        merged_ts = np.transpose(merged_ts)

        return merged_ts 
```

有或没有 numpy 的两个函数都会产生相同的结果。可以根据需要进行打印和格式化。哪个功能更好取决于您手头的数据。

**注意：**如果切换到另一个列表并且只有一个值之后切换回前一个列表，则上面的函数将只保留最后一个差异，可能会丢失一个较小的差异。在这种情况下，您可以在“#### See Note”所在的位置插入以下部分：

对于`without_numpy`函数，插入：

```
if len(group) == 1:
    group.append(group[0]) 
```

对于`with_numpy`函数，插入：

```
sh_dn = np.roll(all_ts, 1)
sh_up = np.roll(all_ts, -1)
all_ts['single'] = np.logical_and( np.not_equal(all_ts['key'], sh_dn['key']), 
                                           np.equal(sh_dn['key'], sh_up['key']))
singles = np.where(all_ts['single']==1)[0]
all_ts = np.insert(all_ts, singles, all_ts[singles]) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-23T16:10:42.037

我不确定你的问题是否正确。如果是这样并假设您的数据已经排序，则可以在使用迭代器时一次性完成。只需根据您的需要调整示例即可。

```
left = iter(range(15, 60, 3))
right = iter(range(0, 50, 5))

try:
    i = next(left)
    j = next(right)
    while True:
        if abs(i-j) < 1:
            print("pair", i, j)
            i = next(left)
            j = next(right)
        elif i <= j:
            print("left", i, None)
            i = next(left)
        else:
            print("right", None, j)
            j = next(right)
except StopIteration:
    pass
# one of the iterators may have leftover elements
for i in left:
    print("left", i, None)
for j in right:
    print("right", None, j) 
```

印刷

```
('right', None, 0)                                                                                                                                                                      
('right', None, 5)                                                                                                                                                                      
('right', None, 10)                                                                                                                                                                     
('pair', 15, 15)                                                                                                                                                                        
('left', 18, None)                                                                                                                                                                      
('right', None, 20)                                                                                                                                                                     
('left', 21, None)                                                                                                                                                                      
('left', 24, None)                                                                                                                                                                      
('right', None, 25)                                                                                                                                                                     
('left', 27, None)                                                                                                                                                                      
('pair', 30, 30)                                                                                                                                                                        
('left', 33, None)                                                                                                                                                                      
('right', None, 35)                                                                                                                                                                     
('left', 36, None)                                                                                                                                                                      
('left', 39, None)                                                                                                                                                                      
('right', None, 40)                                                                                                                                                                     
('left', 42, None)                                                                                                                                                                      
('pair', 45, 45)                                                                                                                                                                        
('left', 51, None)                                                                                                                                                                      
('left', 54, None)                                                                                                                                                                      
('left', 57, None) 
```**

# c - 通过 Eclipse CDT 传递参数

> ID：10788238
> 
> 赞同：1
> 
> 时间：2012-05-28T17:12:27.590
> 
> 标签：c, eclipse, eclipse-cdt

我无法通过 Eclipse CDT 传递一个简单的字符串参数。这是我目前的代码：

```
/*
 * ProgramOne.c
 */

#include <stdio.h>

int main(void)
{
    char check = getchar();
    printf("%c\n", check);
    return (0);
} 
```

我去运行 -> 运行配置 -> 参数，然后输入“abcd”（带和不带引号）并运行它。但是，没有任何打印。有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:32:15.180

您正在设置的是命令行参数。如果您将 main 的声明替换为：

```
int main(int argc, char  **argv[]) { 
```

您将能够从 argv[1] 中取消引用字符串 abcd。这实际上使 abcd 成为 main 的参数。

在您的程序代码中，您从用户输入调用 getchar。这将是您输入字符的位置，然后按 Enter。

# winforms - 温莎城堡的运行时数据上下文

> ID：10788239
> 
> 赞同：1
> 
> 时间：2012-05-28T17:12:29.243
> 
> 标签：winforms, dependency-injection, inversion-of-control, castle-windsor, ioc-container

我正在将 Windsor IoC 容器添加到使用 MVP UI 设计模式的现有 WinForms 应用程序中。我正在尝试确定一种重新注册数据上下文的好方法，该数据上下文取决于运行时提供的连接字符串。问题是在用户选择数据库之前我无法创建数据上下文，即应用程序加载后的“连接字符串”。通常只使用一个数据上下文，但有时用户需要切换到不同的数据库，即创建不同的数据上下文。这也会导致额外的运行时依赖。

```
public interface IProductsView
{
    event EventHandler<ProductSelectedEventArgs> ProductSelectedEvent;
    event EventHandler<StringEventArgs> ProductStatusEvent;
    void ClearProductList();
    void DisplayProductList(IList<Product> products);
    Control Control { get; }
    IProductsPresenter Presenter { get; set; }
}

public class ProductsPresenter : IProductsPresenter
{
    public IProductsView View { get; set; }
    private IProductRepository Repository { get; set; }

    public ProductsPresenter(IProductsView view, IProductRepository repository)
    {
        View = view;
        View.Presenter = this;
        Repository = repository;
    }

    public void ProductSelected(IList<Product> products)
    {
        throw new NotImplementedException();
    }

    public void ShowProductList(string name)
    {
        IList<Product> productList;

        if (string.IsNullOrEmpty(name))
            productList = Repository.GetProducts();
        else
            productList = Repository.GetProductsByName(name);

        View.DisplayProductList(productList);
    }
}

public class ProductDao : IDisposable, IProductRepository
{
    private MeasurementDataContext dataContext;

    public ProductDao(MeasurementDataContext context)
    {
        dataContext = context;
    }

    public List<Product> GetProducts()
    {
        return dataContext.Products.Select(p => Mapper.Map(p)).ToList().OrderBy(x => x.Name).ToList();
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
            if (dataContext != null)
            {
                dataContext.Dispose();
                dataContext = null;
            }
    }

    ~ProductDao()
    {
        this.Dispose(false);
    }
} 
```

所以这意味着`Presenter`在 my中的 in 在创建`View`之前是 null `IProductRepository`，而这又取决于创建一个`MeasurementDataContext`. 我以这样的方式注册了这些组件`IWindsorInstaller`：

```
container.Register(Component.For<IProductsView>()
            .ImplementedBy<ViewProductsControl>());
        container.Register(Component.For<IProductsPresenter>()
            .ImplementedBy<ProductsPresenter>()); 
```

我是否需要使用哪个为每个数据上下文提供唯一的名称`Named`和`DependsOn`connectionString 参数？

用户选择数据库后，我目前在运行时注册数据上下文的操作

```
kernel.Register(Component.For<MeasurementDataContext>()
               .UsingFactoryMethod(() => new MeasurementDataContext(conn))); 
```

然后“解决”我的视图并设置他们的演示者。我知道这不是好的设计，但它是解决我的依赖的蛮力方式。

谢谢

**更新：**

我将在安装程序中注册数据上下文的方式更改为以下内容：

```
container.Register(Component.For<DataContext>().ImplementedBy<MeasurementDataContext>().Named("Localhost").DependsOn(new { connectionString = conn })); 
```

然后将我模型的构造函数修改为：

```
public ProductDao(DataContext context)
    {
        dataContext = context as MeasurementDataContext;
    } 
```

所有组件都将使用正确的键解析：

```
kernel.Resolve<DataContext>(cbo.SelectedItem.ToString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:42:27.180

注入一个包装类来保存连接字符串并让数据上下文对象使用它呢？这些方面的东西：

```
public class ConnectionStringProvider : IConnectionStringProvider
{
    private string _value;

    public event EventHandler ConnectionStringChanged;

    public string ConnectionString
    {
        get { return _value; }
        set
        {
            _value = value;

            var del = ValueChanged;
            if (del != null)
                del(this, EventArgs.Empty);
        }
    }
} 
```

将此注册为单身人士的生活方式。这样，您的应用程序可以设置或更新单个对象上的连接字符串，并且依赖它的每个人都会收到更改通知。

# facebook - 如何从群组中的状态消息中获取“消息”和“照片”

> ID：10788240
> 
> 赞同：1
> 
> 时间：2012-05-28T17:12:31.067
> 
> 标签：facebook, facebook-graph-api

在其他 API (Twitter) 中，我正在使用 Facebook Graph API 创建来自 Facebook、Twitter 和指定邮箱的照片和消息的实时“拼贴”，以便婚礼上的所有客人都可以发送照片和消息，这将在婚礼期间使用投影仪投影。

我已经成功实现了对 type="message" 和 type="photo" 消息的检索，但是在获取 type="status" 的消息时，这些消息缺少“message”属性。此外，如果状态信息与照片一起发布，我无法找到任何方法来检索附加到状态消息的照片。

有什么方法（通过 Graph 或使用 FQL）来获取“缺失”的信息？群组本身的状态消息（使用 Facebook 查看群组）包含文字和照片，因此我相信这些信息应该在某处可用。

我收到的消息的详细信息如下：（出于隐私原因，我已更改或删除了一些属性）。如您所见，没有包含状态更新文本的 [message] 属性，也没有对伴随此状态更新的照片的任何引用。

```
Array (
[id] => xxxxxxxxxxxxxxx_xxxxxxxxxxxxxxx
[from] => Array
    (
        [name] => <name>
        [id] => xxxxxxxxxxxxxxx
    )

[to] => Array
    (
        [data] => Array
            (
                [0] => Array
                    (
                        [version] => 1
                        [name] => <name>
                        [id] => xxxxxxxxxxxxxxx
                    )

            )

    )

[actions] => Array
    (
        [0] => Array
            (
                [name] => Comment
                [link] => http://www.facebook.com/xxxxxxxxxxxxxxx/posts/xxxxxxxxxxxxxxx
            )

        [1] => Array
            (
                [name] => Like
                [link] => http://www.facebook.com/xxxxxxxxxxxxxxx/posts/xxxxxxxxxxxxxxx
            )

    )

[type] => status
[application] => Array
    (
        [name] => Facebook for iPhone
        [namespace] => fbtouch
        [id] => xxxxxxxxxx
    )

[created_time] => 2012-05-26T16:00:00+0000
[updated_time] => 2012-05-26T16:00:00+0000
[likes] => Array
    (
        [data] => Array
            (
                [0] => Array
                    (
                        [name] => <name>
                        [id] => xxxxxxxxxxxxxx
                    )

            )

        [count] => 1
    )

[comments] => Array
    (
        [count] => 0
    )

) 
```

我希望有办法检索我需要的属性；如果所有发布为“状态”消息的照片都不能用于婚礼演示，那将是一种耻辱。

# android - 在指定的个人资料页面上打开 Facebook 应用程序

> ID：10788247
> 
> 赞同：20
> 
> 时间：2012-05-28T17:13:33.470
> 
> 标签：android, facebook, android-intent

我正在尝试使用 SO 中的一些代码，但它失败了：

这些是 uri 应该打开应用程序的正确部分。

```
facebook://facebook.com/info?user=544410940     (id of the user. "patrick.boos" won't work)
facebook://facebook.com/wall?user=544410940   (will only show the info if you have added it as 
```

我想要的是在我指定的个人资料上打开 facebook 应用程序。这是我正在尝试的代码。该数字是配置文件的 UID。

```
 String uri = "facebook://facebook.com/wall?user=417079614970109"; 
        intent = new Intent(Intent.ACTION_VIEW, Uri.parse(uri));
        startActivity(intent); 
```

是贬值还是什么？我现在如何完成这样的任务？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-28T17:27:41.463

实际上它看起来像这样。这些 URI 仅适用于最新版本的 facebook 应用程序。这就是我们尝试捕捉的原因。

```
public static Intent getOpenFacebookIntent(Context context) {

    try {
        context.getPackageManager()
                .getPackageInfo("com.facebook.katana", 0); //Checks if FB is even installed.
        return new Intent(Intent.ACTION_VIEW,
                Uri.parse("fb://profile/254175194653125")); //Trys to make intent with FB's URI
    } catch (Exception e) {
        return new Intent(Intent.ACTION_VIEW,
                Uri.parse("https://www.facebook.com/arkverse")); //catches and opens a url to the desired page
    }
} 
```

在您的活动中，要打开它，请像这样调用它：

```
Intent facebookIntent = getOpenFacebookIntent(this);
startActivity(facebookIntent); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-01-08T09:26:42.370

这不再有效

```
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("fb://profile/someProfile")); 
```

请改用这个

```
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("fb://facewebmodal/f?href=https://www.facebook.com/someProfile")); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-06-24T23:03:27.193

这不是更容易吗？例如在 onClickListener 中？

```
try { 
    Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("fb://profile/426253597411506"));
    startActivity(intent);
} catch(Exception e) {
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.facebook.com/appetizerandroid")));    
} 
```

PS。[从http://graph.facebook.com/[userName]](http://graph.facebook.com/%5BuserName%5D)获取您的 id（大数字）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-21T15:01:47.733

目前不可能，**Facebook**已删除此功能

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-30T10:38:12.913

关于这个有很多问题，但这段代码对我有用。Facebook 改变了那里的政策，所以更多细节请查看这个 Facebook 官方**[GRAPH API EXPLORER PAGE](https://developers.facebook.com/tools/explorer/145634995501895/?method=GET&path=me%3Ffields%3Did%2Cname%2Clink&version=v2.10)**

```
Intent intent = null;
    try {
        getPackageManager().getPackageInfo("com.facebook.katana", 0);
        String url = "https://www.facebook.com/"+idFacebook;
        intent = new Intent(Intent.ACTION_VIEW, Uri.parse("fb://facewebmodal/f?href="+url));
    } catch (Exception e) {
        // no Facebook app, revert to browser
        String url = "https://facebook.com/"+idFacebook;
        intent = new Intent(Intent.ACTION_VIEW);
        intent .setData(Uri.parse(url));
    }
    this.startActivity(intent); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-10T16:48:51.443

为此，我们需要“Facebook 页面 id”，您可以获取它：

*   从页面转到“关于”。
*   转到“更多信息”部分。

[![水图像介绍](../Images/6559162b3af056d352d20262358f9fff.png)](https://i.stack.imgur.com/l58y9.png)

### 要在指定的个人资料页面上打开 Facebook 应用程序，

你可以这样做：

```
 String facebookId = "fb://page/<Facebook Page ID>";
  startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(facebookId))); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-10-28T12:04:27.417

对于 facebook 页面使用如下：[http://fb://page/87268309621xxxx](http://fb://page/87268309621xxxx) 对于个人 ID 使用如下：[http://fb://profile/87268309621xxxx](http://fb://profile/87268309621xxxx)

# ruby-on-rails - 在 Rails 中创建我自己的动作

> ID：10788248
> 
> 赞同：0
> 
> 时间：2012-05-28T17:13:35.543
> 
> 标签：ruby-on-rails, ruby-on-rails-3

有没有办法创建我自己的动作？

例如，当我使用脚手架时，它会在控制器中创建“index”、“show”、“edit”、“new”、“create”、“update”和“destroy”动作。

我想添加另一个动作。

我已经读到我需要在路由文件上添加一些代码......

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T09:29:55.590

只需定义一个方法，您就可以在控制器中生成自己的操作：

```
def action
  # do something here
end 
```

您还需要确保在 config/routes.rb 中有一个路由设置。

有关更多信息，我建议阅读 http://guides.rubyonrails.org/getting_started.html 上的指南[，](http://guides.rubyonrails.org/getting_started.html)特别是[http://guides.rubyonrails.org/getting_started.html#generating-a-controller](http://guides.rubyonrails.org/getting_started.html#generating-a-controller)。您会发现虽然脚手架最初可能很有用，但一旦您的应用程序变得更加复杂，您就必须编写自己的控制器文件/操作方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:31:33.990

那么你可以在你的路线和你去的方式中定义动作路由

希望这有帮助

# android - 最佳实践 - 将您的应用添加到 Android 共享菜单

> ID：10788252
> 
> 赞同：26
> 
> 时间：2012-05-28T17:14:05.870
> 
> 标签：android, android-intent

我的应用程序通过 TCP 连接发送文件（所有 mime 类型），因此我希望我的应用程序出现在 Android 共享菜单中。

我在我的活动中添加了以下意图过滤器`AndroidManifest.xml`

```
<intent-filter ><!--intent filter for single file sharing-->
    <action android:name="android.intent.action.SEND" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:mimeType="*/*" />
</intent-filter>
<intent-filter ><!--intent filter for sharing multiple files-->
    <action android:name="android.intent.action.SEND_MULTIPLE" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:mimeType="*/*" />
</intent-filter> 
```

现在我将此添加到`Activity`单击共享操作时要启动的

```
Intent intent = getIntent();
if (Intent.ACTION_SEND.equals(intent.getAction())) {
    Uri uri = (Uri) intent.getParcelableExtra(Intent.EXTRA_STREAM);
    if (uri != null) {
        fileset = new HashSet();
        fileset.add(getPathfromUri(uri));
    }
} else if (Intent.ACTION_SEND_MULTIPLE.equals(intent.getAction())) {
    ArrayList<Uri> uris = intent.getParcelableArrayListExtra(Intent.EXTRA_STREAM);
    if (uris != null) {
        fileset = new HashSet();
        for(Uri uri : uris) {
            fileset.add(getPathfromUri(uri));
        }
    }
} 
```

我使用这种方法来生成要共享的文件的绝对路径。

```
public String getPathfromUri(Uri uri) {
    if(uri.toString().startsWith("file://")) {
         return uri.getPath();
    }
    String[] projection = { MediaStore.Images.Media.DATA };
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    startManagingCursor(cursor);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    String path= cursor.getString(column_index);
    //cursor.close();
    return path;
} 
```

上述方法正确检索图像/视频和其他文件的绝对路径。有什么我错过了或者有更好的方法吗？

除了`Share`菜单之外，我的手机上还有一个`Send Via`菜单。 ![截屏](../Images/c9d6798e90eefbba95c4319d848b949b.png)

有没有办法让我的应用程序进入这个列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T09:33:06.163

我在这里概述了如何进入菜单：

[http://blog.blundellapps.com/add-your-app-to-the-android-menu/](http://blog.blundellapps.com/add-your-app-to-the-android-menu/)

基本上它有你的 mimetype */*：

```
 <intent-filter>
            <action android:name="android.intent.action.GET_CONTENT" />

            <category android:name="android.intent.category.DEFAULT" />

            <data android:mimeType="*/*" />
        </intent-filter> 
```

如果你这样做并且它没有出现，这意味着他们正在使用一个意图菜单，它是一个自定义共享列表，所以你不能强行进入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-05T07:46:01.247

我认为您正在从应用程序外部共享图像。请在 intentfiler 中定义 minetype。它在我这边工作正常。

```
<activity
            android:name=".SharePhotoFromOutSide"
            android:theme="@android:style/Theme.Translucent.NoTitleBar" >
            <intent-filter>
                <action android:name="android.intent.action.SEND" />

                <category android:name="android.intent.category.DEFAULT" />

                <data android:mimeType="photo/*" />
            </intent-filter>
        </activity> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T09:05:27.857

我试图处理这个问题，我很确定三星的画廊使用了一些自定义操作来通过该菜单进行共享。考虑到所有列出的应用程序都是预装的，很明显三星同意所有列出的应用程序开发人员使用它的自定义意图操作。

我也尝试联系三星，他们还没有回复。

# c# - 重载指数 C# 和指数运算符

> ID：10788254
> 
> 赞同：0
> 
> 时间：2012-05-28T17:14:14.520
> 
> 标签：c#, operator-overloading, overloading, exponent

有没有办法在 C# 中重载指数？我知道在某些语言中（无法说出任何名字），`^`用于指数函数，但在 C++ 和 C# 中，`^`是按位 XOR 运算符，[可以重载](http://msdn.microsoft.com/en-us/library/8edha89s%28v=vs.100%29.aspx)，但这不是我想要的超载。我不想超载电源功能或其他任何东西

例如。我知道我可以`2^x`用`(1 << x)`. 所以，我的第二部分，C# 中有指数运算符还是我必须坚持使用`System.Math.Pow(base, exp);`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:35:19.513

您可以创建一个扩展方法来充当 Math.Pow() 的快捷方式，这实际上是很常见的事情。

也许：

```
public static double Pow(this double a, double b)
{
    return Math.Pow(a, b);
} 
```

那么你可以像这样使用它：

```
myDouble = myDouble.Pow(3); 
```

当涉及到扩展方法时，您可以使用多种格式。如果你的目标是简洁，我相信你可以想出一些你会满意的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:18:53.623

指数运算符的基本方言和 Matlab 使用`^`。其他语言（Fortran、Python、F#）使用`**`. 不幸的是，C# 没有指数运算符。

尽管可以`^`在 C# 中重载 XOR 运算符，但不建议这样做，因为具有不寻常且未记录的含义的运算符会令人困惑。

即便如此，只有当基数和指数操作数中的一个或两个是用户定义的类型时，重载才是可能的。你不能只定义'^'来表示取幂，比如双打。

# magento - 批量导入magento

> ID：10788258
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:14:47.930
> 
> 标签：magento, bulk-import

我需要帮助将散装产品导入我们的 magento 多商店配置中的商店。产品应具有名称、图像、类别、描述、自定义选项（按固定价格确定尺寸）。我创建了一个 csv 并能够成功上传产品，但尺寸没有与定价一起显示。图像也没有出现在前端。我上传到 media/import 并在三个 csv 列中进行了编辑。我还在字母系统下直接创建了一个，例如如果图像名称以 ab 开头，我将创建目录 a/b/image.jpg 并将它们放在 csv 的三个区域中。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:26:07.307

尝试手动添加要导入的产品之一。然后从管理面板导出它，看看应该对 csv 进行哪些更正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T00:21:23.743

请下载 Magmi 插件。[http://sourceforge.net/projects/magmi/](http://sourceforge.net/projects/magmi/) 并将 Magmi 放在您网站的根目录下并运行 www.Yourdomain.com/magmi/web/magmi.php 现在根据您的要求配置 magmi。（注意：你需要把csv文件放在var/import下）你要上传图片你还需要magmi图片插件下载链接：http: [//sourceforge.net/projects/magmi/files/magmi-0.7/plugins/包/（magmi_extra_plugins_20120328.zip](http://sourceforge.net/projects/magmi/files/magmi-0.7/plugins/packages/(magmi_extra_plugins_20120328.zip)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T21:43:39.280

尝试：[Magmi Mass Importer](http://sourceforge.net/apps/mediawiki/magmi/index.php?title=Main_Page) 如果您没有任何预算，比在 Unirgy RapidFlow 上花费 $$ 更好。

# java - 为什么 Collections.swap 将目标列表分配给原始类型的变量？

> ID：10788259
> 
> 赞同：13
> 
> 时间：2012-05-28T17:14:48.733
> 
> 标签：java

在 JDK 1.6 的源代码中，Collections 类的 swap 方法是这样写的：

```
public static void swap(List<?> list, int i, int j) {
    final List l = list;
    l.set(i, l.set(j, l.get(i)));
} 
```

创建通过列表的最终副本的原因是什么？他们为什么不直接修改传递的列表？在这种情况下，您还会收到原始类型警告。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-28T17:29:26.707

没有列表的副本，只有对列表的引用的副本。final 关键字并不重要。但是，使用原始类型很重要。如果改为使用参数，编译器将报告错误：

```
public static void swap(List<?> list, int i, int j) {
    // ERROR: The method set(int, capture#3-of ?) in the type List<capture#3-of ?>
    // is not applicable for the arguments (int, capture#4-of ?)
    list.set(i, list.set(j, list.get(i)));
} 
```

这意味着，他们正在使用中间变量来规避泛型的缺点，并摆脱错误消息。

有趣的问题是：他们为什么不使用泛型方法？以下代码有效：

```
public static <T> void swap(List<T> list, int i, int j) {
    list.set(i, list.set(j, list.get(i)));
} 
```

答案是，此方法在使用原始类型调用该方法的旧代码中会产生警告：

```
List list = ...;
// WARNING: Type safety: Unchecked invocation swap2(List, int, int)
// of the generic method swap2(List<T>, int, int) of type Swap
Collections.swap(list, 0, 1); 
```

# haskell - 镜头的用途/用途是什么？

> ID：10788261
> 
> 赞同：37
> 
> 时间：2012-05-28T17:14:57.530
> 
> 标签：haskell, data-structures, types, lenses

我似乎找不到任何关于在实际示例中使用什么镜头的解释。Hackage 页面中的这个简短段落是我找到的最接近的：

> 该模块提供了一种方便的方式来访问和更新结构的元素。它与 Data.Accessors 非常相似，但更通用且依赖项更少。我特别喜欢它在状态单子中处理嵌套结构的干净程度。

那么，它们是用来做什么的呢？与其他方法相比，它们有哪些优点和缺点？为什么需要它们？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-28T17:58:09.977

它们提供了对数据更新的清晰抽象，并且从来没有真正“需要”。他们只是让您以不同的方式推理问题。

在一些命令式/“面向对象”的编程语言（如 C）中，您有一些值集合的熟悉概念（我们称它们为“结构”）以及标记集合中每个值的方法（标签通常称为“字段” ）。这导致了这样的定义：

```
typedef struct { /* defining a new struct type */
  float x; /* field */
  float y; /* field */
} Vec2;

typedef struct {
  Vec2 col1; /* nested structs */
  Vec2 col2;
} Mat2; 
```

然后，您可以像这样创建这个新定义的类型的值：

```
Vec2 vec = { 2.0f, 3.0f };
/* Reading the components of vec */
float foo = vec.x;
/* Writing to the components of vec */
vec.y = foo;

Mat2 mat = { vec, vec };
/* Changing a nested field in the matrix */
mat.col2.x = 4.0f; 
```

同样在 Haskell 中，我们有数据类型：

```
data Vec2 =
  Vec2
  { vecX :: Float
  , vecY :: Float
  }

data Mat2 =
  Mat2
  { matCol1 :: Vec2
  , matCol2 :: Vec2
  } 
```

然后像这样使用此数据类型：

```
let vec  = Vec2 2 3
    -- Reading the components of vec
    foo  = vecX vec
    -- Creating a new vector with some component changed.
    vec2 = vec { vecY = foo }

    mat = Mat2 vec2 vec2 
```

但是，在 Haskell 中，没有简单的方法可以更改数据结构中的嵌套字段。这是因为您需要围绕正在更改的值重新创建所有包装对象，因为 Haskell 值是不可变的。如果你在 Haskell 中有一个像上面这样的矩阵，并且想要改变矩阵的右上单元格，你必须这样写：

```
 mat2 = mat { matCol2 = (matCol2 mat) { vecX = 4 } } 
```

它有效，但看起来很笨拙。所以，有人想出的，基本上是这样的：如果你把两个东西组合在一起：一个值的“getter”（像`vecX`和`matCol2`上面一样）和一个相应的函数，给定 getter 所属的数据结构，可以创建一个更改了该值的新数据结构，您可以做很多整洁的事情。例如：

```
data Data = Data { member :: Int }

-- The "getter" of the member variable
getMember :: Data -> Int
getMember d = member d

-- The "setter" or more accurately "updater" of the member variable
setMember :: Data -> Int -> Data
setMember d m = d { member = m }

memberLens :: (Data -> Int, Data -> Int -> Data)
memberLens = (getMember, setMember) 
```

镜头的实现方式有很多种；对于本文，假设一个镜头类似于上面：

```
type Lens a b = (a -> b, a -> b -> a) 
```

即它是某种类型的 getter 和 setter 的组合，`a`它具有 type 的字段`b`，所以`memberLens`上面将是 a `Lens Data Int`。这让我们做什么？

好吧，让我们首先创建两个简单的函数，从镜头中提取 getter 和 setter：

```
getL :: Lens a b -> a -> b
getL (getter, setter) = getter

setL :: Lens a b -> a -> b -> a
setL (getter, setter) = setter 
```

现在，我们可以开始抽象一些东西了。让我们再次考虑上面的情况，我们想要修改一个“两层深”的值。我们添加一个带有另一个镜头的数据结构：

```
data Foo = Foo { subData :: Data }

subDataLens :: Lens Foo Data
subDataLens = (subData, \ f s -> f { subData = s }) -- short lens definition 
```

现在，让我们添加一个组成两个镜头的函数：

```
(#) :: Lens a b -> Lens b c -> Lens a c
(#) (getter1, setter1) (getter2, setter2) =
    (getter2 . getter1, combinedSetter)
    where
      combinedSetter a x =
        let oldInner = getter1 a
            newInner = setter2 oldInner x
        in setter1 a newInner 
```

代码写得很快，但我认为它的作用很清楚：getter 是简单组合的；你得到内部数据值，然后你读取它的字段。设置器，当它应该`a`用新的内部字段值改变某个值时`x`，首先检索旧的内部数据结构，设置它的内部字段，然后用新的内部数据结构更新外部数据结构。

现在，让我们创建一个简单地增加镜头值的函数：

```
increment :: Lens a Int -> a -> a
increment l a = setL l a (getL l a + 1) 
```

如果我们有这段代码，它的作用就很清楚了：

```
d = Data 3
print $ increment memberLens d -- Prints "Data 4", the inner field is updated. 
```

现在，因为我们可以合成镜头，我们也可以这样做：

```
f = Foo (Data 5)
print $ increment (subDataLens#memberLens) f
-- Prints "Foo (Data 6)", the innermost field is updated. 
```

所有镜头包所做的本质上是将镜头的概念——“setter”和“getter”组合成一个简洁的包，使它们易于使用。在一个特定的镜头实现中，可以这样写：

```
with (Foo (Data 5)) $ do
  subDataLens . memberLens $= 7 
```

因此，您非常接近 C 版本的代码；在数据结构树中修改嵌套值变得非常容易。

镜头不过是这样：一种修改部分数据的简单方法。因为它们使推理某些概念变得非常容易，所以它们在您拥有大量数据结构且必须以各种方式相互交互的情况下得到广泛使用。

有关镜头的优缺点，请参阅[最近关于 SO 的问题](https://stackoverflow.com/questions/10774614/what-are-the-advantages-and-disadvantages-of-using-lenses)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-28T17:39:29.387

镜头以统一的组合方式提供了*编辑*数据结构的便捷方法。

许多程序都是围绕以下操作构建的：

*   查看（可能是嵌套的）数据结构的组件
*   更新（可能是嵌套的）数据结构的字段

镜头为查看和编辑结构提供语言支持，以确保您的编辑一致；编辑可以很容易地组成；并且可以使用相同的代码来查看结构的各个部分，以及更新结构的各个部分。

因此，镜头可以轻松地将程序从视图写入结构；并从结构返回到这些结构的视图（和编辑器）。他们清理了很多记录访问器和设置器的混乱。

皮尔斯等人。普及的镜头，例如在他们的[Quotient Lenses 论文](http://www.cis.upenn.edu/~bcpierce/papers/quotient-lenses.pdf)中，以及 Haskell 的实现现在被广泛使用（例如[fclabels](http://hackage.haskell.org/package/fclabels)和数据访问器）。

对于具体的用例，请考虑：

*   图形用户界面，用户以结构化的方式编辑信息
*   解析器和漂亮的打印机
*   编译器
*   同步更新数据结构
*   数据库和模式

在许多其他情况下，您拥有世界的数据结构模型，以及对该数据的可编辑视图。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-28T20:13:26.020

另外需要注意的是，镜头实现了一个非常通用的“字段访问和更新”概念，这一点经常被忽视。可以为各种事物编写镜头，包括类似函数的对象。理解这一点需要一些抽象的思维，所以让我向你展示一个镜头的力量的例子：

```
at :: (Eq a) => a -> Lens (a -> b) b 
```

使用`at`您实际上可以访问和操作具有多个参数的函数，具体取决于先前的参数。请记住，这`Lens`是一个类别。对于本地调整功能或其他事情，这是一个非常有用的习语。

您还可以通过属性或替代表示访问数据：

```
polar :: (Floating a, RealFloat a) => Lens (Complex a) (a, a)
mag   :: (RealFloat a) => Lens (Complex a) a 
```

您可以进一步编写镜头来访问傅立叶变换信号的各个波段等等。

# javascript - Magento：标签点击事件

> ID：10788263
> 
> 赞同：2
> 
> 时间：2012-05-28T17:14:59.833
> 
> 标签：javascript, magento, prototypejs

任何人都知道一种在后端使用 javascript 监听 magento 选项卡点击的方法，比如每次有人单击编辑客户页面上的选项卡时，您都想做一些事情。adminhtml/tabs.js 有这个：

```
 tabMouseClick : function(event) {
    var tab = Event.findElement(event, 'a');

    // go directly to specified url or switch tab
    if ((tab.href.indexOf('#') != tab.href.length-1)
        && !(Element.hasClassName(tab, 'ajax'))
    ) {
        location.href = tab.href;
    }
    else {
        this.showTabContent(tab);
    }
    Event.stop(event);
}, 
```

但是没有用，有人知道吗？我还尝试使用标准原型 js 观察者：

```
Event.observe("product_info_tabs", "click", function () 
{ alert(1); 
}); 
```

也没有做任何事情。该解决方案不应修改核心，因为这会增加许多升级问题，可能还会增加未来的 magento 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T12:02:07.267

要在后端监听对 Magento 选项卡 ( `varienTabs`) 的点击，您只需将自定义观察者添加到现有观察者。使用您的示例（后端中的“编辑客户页面”），这将是：

```
var myTabs = $$("#customer_info_tabs li a.tab-item-link");
for (var i = 0; i < myTabs.length; i++) {
    Event.observe(myTabs[i], "click", function (event) {
        var tab = Event.findElement(event, "a");
        // insert your custom code here
        alert(tab.id);
        Event.stop(event);
    });
} 
```

要在不更改核心文件（破坏可升级性）的情况下实现自定义观察者，您可以覆盖适当的管理控制器操作。

例如，覆盖`Mage_Adminhtml_CustomerController::editAction()`：

```
<!-- app/code/local/My/Adminhtml/etc/config.xml -->
<config>
    <modules>
        <My_Adminhtml>
            <version>0.1.0</version>
        </My_Adminhtml>
    </modules>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <My_Adminhtml before="Mage_Adminhtml">My_Adminhtml</My_Adminhtml>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
</config> 
```

接下来，定义您的自定义管理控制器：

```
// app/code/local/My/Adminhtml/controllers/CustomerController.php
require 'Mage/Adminhtml/controllers/CustomerController.php';
class My_Adminhtml_CustomerController extends Mage_Adminhtml_CustomerController
{
    public editAction()
    {
        // copy of Mage_Adminhtml_CustomerController::editAction() code here
    } 
} 
```

最后，在被覆盖的操作中，创建一个包含自定义观察者脚本的附加文本块，并将该块附加到布局中。例如在`editAction`插入的末尾是这样的：

```
 :
    $this->loadLayout();
    $oBlock = $this->getLayout()->createBlock('core/text')->setText('
         <script type="text/javascript">
            var myTabs = $$("#customer_info_tabs li a.tab-item-link");
            for (var i = 0; i < myTabs.length; i++) {
                Event.observe(myTabs[i], "click", function (event) {
                    var tab = Event.findElement(event, "a");
                    alert(tab.id);
                    Event.stop(event);
                });
            }
         </script>
    ');
    $this->getLayout()->getBlock('left')->append($oBlock);
    $this->renderLayout();
    : 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-05T09:18:56.913

旧答案，但因为我在这里：Magento internals 在显示选项卡时触发一个事件。您可以简单地挂钩该事件。

```
varienGlobalEvents.attachEventHandler('showTab', function(arg){
            console.log(arg.tab);
        }); 
```

也不需要通过覆盖控制器注入。只需添加 yoru 自己的自定义布局指令，并相应地加载 js。

# apache-flex - 避免 Flex 中的自动组件重用

> ID：10788265
> 
> 赞同：0
> 
> 时间：2012-05-28T17:15:30.493
> 
> 标签：apache-flex, radio-button, reusability

实际上，我在每行的一个单元格中有一个带有 2 个 RadioButton 控件的 Datagrid。像这样的东西：

```
======================================================
|             |             |   (o) Radiobutton #1   |
|   cell #1   |   cell #2   |   (o) Radiobutton #2   |
====================================================== 
```

如果我删除一行并在此之后添加另一行，Flex 会自动重用以前删除的 RadioButtons（我认为是为了优化资源）。

将事件处理程序关联`creationComplete`到每个 RadioButton 我确认了我的怀疑：

1.  我在特定单元格中创建了一行，其中包含 2 个 RadioButtons：两个`creationComplete`处理程序都成功执行。
2.  我删除了这一行，并添加了另一行。
3.  现在，`creationComplete`处理程序没有执行，因此 Flex 正在使用以前的 RadioButtons。

但我不希望在我的应用程序中出现这种行为。有什么方法可以强制 Flex 每次都创建组件（避免重用）？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:25:56.467

```
But I don't want this behaviour in my app. 
```

如果您关心性能和内存使用情况，那么您确实希望在您的应用程序中使用这种行为。请阅读有关[创建 Renderers](http://help.adobe.com/en_US/flex/using/WS77c1dbb1bd80d3836ecbb5ec129ec77b1e1-8000.html)的内容。请特别注意有关创建可回收渲染器的部分。

```
Is there any way to force Flex to create the components every single time (avoiding reuse)? 
```

您可以调整 DataGrid 的大小，以便 dataProvider 中的每个项目都显示在屏幕上。

如果您使用的是 Spark DataGrid，很可能您可以在布局上设置一个属性以不使用虚拟布局；但我没有深入研究 Spark DataGrid API，所以我不确定它是否存在。

我全心全意地建议您重新编写渲染器以侦听 dataChange() 事件并修改渲染器的显示元素（AKA RadioButton），而不是尝试为 dataProvider 的每个元素使用单个渲染器实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:34:49.860

在 Flex 4/spark 列表中，您可以使用 useVirtualLayout 属性 (http://help.adobe.com/en_US/flex/using/WSc2368ca491e3ff92-1483ec4a12136246e76-8000.html) 打开和关闭此功能。但是，我认为 ADG 还没有 spark 版本，所以你被一个假设你关心内存和 CPU 使用率的组件“卡住”了，否则你无法分辨。

# python - 使用 Cython 优化 numpy.dot

> ID：10788267
> 
> 赞同：9
> 
> 时间：2012-05-28T17:15:34.123
> 
> 标签：python, numpy, cython, dot-product

我想使用 Cython 优化以下代码：

```
sim = numpy.dot(v1, v2) / (sqrt(numpy.dot(v1, v1)) * sqrt(numpy.dot(v2, v2))) 
dist = 1-sim
return dist 
```

我已经编写并编译了 .pyx 文件，当我运行代码时，我没有看到任何显着的性能改进。根据 Cython 文档，我必须添加 c_types。Cython 生成的 HTML 文件表明瓶颈是点积（这当然是意料之中的）。这是否意味着我必须为点积定义一个 C 函数？如果是，我该怎么做？

编辑：

经过一番研究，我想出了以下代码。改善只是微不足道的。我不确定是否可以做些什么来改进它：

```
from __future__ import division
import numpy as np
import math as m
cimport numpy as np
cimport cython

cdef extern from "math.h":
    double c_sqrt "sqrt"(double)

ctypedef np.float reals #typedef_for easier readding

cdef inline double dot(np.ndarray[reals,ndim = 1] v1, np.ndarray[reals,ndim = 1] v2):
  cdef double result = 0
  cdef int i = 0
  cdef int length = v1.size
  cdef double el1 = 0
  cdef double el2 = 0
  for i in range(length):
    el1 = v1[i]
    el2 = v2[i]
    result += el1*el2
  return result

@cython.cdivision(True)
def distance(np.ndarray[reals,ndim = 1] ex1, np.ndarray[reals,ndim = 1] ex2):
  cdef double dot12 = dot(ex1, ex2)
  cdef double dot11 = dot(ex1, ex1)
  cdef double dot22 = dot(ex2, ex2)
  cdef double sim = dot12 / (c_sqrt(dot11 * dot22))
  cdef double dist = 1-sim    
  return dist 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-29T00:20:57.613

作为一般说明，如果您从 cython 中调用 numpy 函数并且几乎不做其他事情，那么您通常只会看到边际收益（如果有的话）。如果您静态键入在 python 级别使用显式 for 循环的代码（而不是在已经调用 Numpy C-API 的东西中），您通常只会获得巨大的加速。

您可以尝试使用计数器的所有静态类型、输入 numpy 数组等编写点积的代码，并将 wraparound 和 boundscheck 设置为 False，导入`sqrt`函数的 clib 版本，然后尝试利用并行循环 ( `prange`) 以使用 openmp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:18:24.720

你可以改变表达

```
sim = numpy.dot(v1, v2) / (sqrt(numpy.dot(v1, v1)) * sqrt(numpy.dot(v2, v2))) 
```

至

```
sim = numpy.dot(v1, v2) / sqrt(numpy.dot(v1, v1) * numpy.dot(v2, v2)) 
```

# php - 将本地目录与 Amazon S3 同步的守护程序（使用 Ubuntu Linux 和 PHP 的 AMI）

> ID：10788268
> 
> 赞同：0
> 
> 时间：2012-05-28T17:15:53.767
> 
> 标签：php, linux, amazon-s3

是否有任何解决方案可以使 AMI 的本地目录与 S3 存储桶保持同步？

这个想法是能够部署一个标准的 LAMP webapp（以及它的用户文件上传），而无需更改当前代码。

我可以想象一个守护进程更新“AMI的本地目录”<->“S3'sBucket”

我知道从长远来看，这不是一个可扩展/高效的解决方案，但它会为我当前的需求提供一个**快速**的-n-dirty 解决方案（在许多 Amazon 的 EC2 实例中部署一个带有数据库复制的 webapp）。

一个更好的（如果不是完美的）解决方案是，如果本地目录以某种方式是“符号”的（如符号/硬链接）并且实际上不消耗空间；但可以从标准 webapp 无缝访问。

有任何想法吗 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:04:57.377

Apparently this solves my question, I haven't tried it yet, but it looks like what I was looking for.

[http://ikorolchuk.blogspot.com/2012/02/mount-amazon-s3-storage-as-local.html](http://ikorolchuk.blogspot.com/2012/02/mount-amazon-s3-storage-as-local.html)

# c++ - 如何使用 OpenCV 在视频中查找对象

> ID：10788271
> 
> 赞同：9
> 
> 时间：2012-05-28T17:16:33.237
> 
> 标签：c++, image-processing, opencv, video-capture, video-processing

要跟踪视频帧上的对象，首先我从视频中提取图像帧并将这些图像保存到一个文件夹中。然后我应该处理这些图像以找到一个对象。其实我不知道这是否是一件实际的事情，因为所有的算法都是一步完成的。它是否正确？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T18:03:10.630

好吧，根据视频的大小和帧的大小，您的方法将占用磁盘上的大量空间，而且您将花费大量时间从磁盘读取帧。

您是否尝试过执行实时视频处理？如果你的算法不是太慢，有一些帖子显示了你需要做的事情：

*   [这篇文章](https://stackoverflow.com/a/3919216/176769)演示了如何使用 OpenCV 的 C 接口执行一个函数，将网络摄像头 (on-the-fly) 捕获的帧转换为灰度并显示在屏幕上；
*   [这篇文章](https://stackoverflow.com/questions/7731742/square-detection-doesnt-find-squares/7732392#7732392)展示了一种使用 C++ 接口检测图像中正方形的简单方法；
*   [这篇文章](https://stackoverflow.com/questions/8667818/opencv-c-obj-c-detecting-a-sheet-of-paper-square-detection/8863060#8863060)是上述文章的轻微变化，并展示了如何检测纸张；
*   [该线程](https://stackoverflow.com/questions/10533233/opencv-c-obj-c-advanced-square-detection)显示了执行高级正方形检测的几种不同方法。

我相信您能够将代码从 C 接口转换为 C++ 接口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T07:31:01.097

如果您使用的是 OpenCV，那么存储视频帧是没有意义的，因为它具有非常方便的方法来实时从相机/存储的视频中捕获帧。

在这篇[文章](https://stackoverflow.com/a/10697379/744859)中，您有一个用于从视频中捕获帧的示例代码。

然后，如果要检测这些帧上的对象，则需要使用检测算法处理每个帧。OpenCV 带来了一些与主题相关的示例代码。例如，您可以尝试使用 SIFT 算法来检测图片。

# php - 座位预订不起作用

> ID：10788274
> 
> 赞同：0
> 
> 时间：2012-05-28T17:16:47.903
> 
> 标签：php, mysql

我一直在做很多研究，但我想我仍然没有找到答案。这是一个座位预订，我在 php 和 mysql 方面不太好。所以这是我的代码：

预订.php 代码：

```
<?php 
mysql_connect("localhost","root","") or die (mysql_error());
mysql_select_db('seat_reservation') or die (mysql_error());

$insert = mysql_query("INSERT INTO reservation (chair_status, room_id, chair_number) VALUES (0, 400, 05)");
                                ?>
</td>
 <div id="popupContact">
  <a id="popupContactClose">x</a>
 <center><form method = "POST" action="reserve.php">
<?php
$query = mysql_query("SELECT chair_status FROM reservation WHERE room_id = '400' AND chair_number = '05'");
while($row = mysql_fetch_array($query)) {
$_SESSION['roomno'] = $row['room_id'];
$_SESSION['chairnum'] = $row['chair_number'];
}

?> 
```

Reserve.php 代码：

```
<?php
$name = $_POST['student_name'];
$stud_id = $_POST['stud_id'];
$room_id = $_SESSION['roomno'];
$chair_num = $_SESSION['chairnum'];

mysql_connect("localhost", "root", "") or die (mysql_error());
mysql_select_db('seat_reservation') or die (mysql_error());

$query = mysql_query("SELECT chair_status FROM reservation WHERE room_id = '$room_id' AND chair_number = '$chair_num'");
if($query == 0)
{
$insert = mysql_query("UPDATE reservation SET chair_status = 1, student_name = '$name', stud_id = '$stud_id' WHERE room_id = '$room_id' AND chair_number = '$chair_num'");
}
else

die ("Sorry, seat taken! <br />Redirecting...<meta http-equiv='refresh' content=2;reservation.php>");

?> 
```

我的问题是，当我预订座位时，它告诉我即使chair_status 字段为0，也有人占用了座位。当我检查数据库时，它成功插入，chair_status 为0。我不知道哪个部分错了. 我真的需要你的帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:38:37.343

1.  在`reservation.php`中，您`SELECT`只能`chair_status`尝试访问`$row['room_id']`并且`$row['chair_number']`: 都不在结果集中。然而，这两者都是已知的，因为它们在`WHERE`查询的子句中是固定的，因此可以使用这些值而无需求助于 MySQL 查询。

2.  即使您想使用这样的查询来设置`$_SESSION`变量，循环遍历结果集并用每个结果覆盖这些变量也是愚蠢的。更好地`LIMIT`查询并仅使用一条结果记录。

3.  但是，您可能想要*输出*表单元素而不是设置`$_SESSION`变量，以便用户可以选择他们希望保留的可用座位？在这种情况下，您可能打算将其包含`chair_status = 0`在您的过滤条件中。

4.  函数的返回值`mysql_query`是一个资源标识符；将此与 0 in 进行比较`reserve.php`可能不是您想要的。也许你想要[`mysql_num_rows`](http://php.net/manual/en/function.mysql-num-rows.php)呢？

5.  请停止使用古老的 MySQL 扩展编写新代码：它不再维护，社区已开始[弃用过程](http://news.php.net/php.internals/53799)。相反，您应该使用改进的[MySQLi](http://php.net/mysqli)扩展或[PDO](http://php.net/pdo)抽象层。

6.  请避免将变量（尤其是来自您的用户的变量）放入您的 SQL 中，这会使您容易受到 SQL 注入的影响。相反，您应该使用准备好的语句，通过这些语句，您的变量可以作为参数传递给 MySQL，而不会针对 SQL 进行评估。阅读[Bobby Tables](http://bobby-tables.com)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:20:36.463

你可能的意思是`if (mysql_num_rows($query) == 0) {`。您检查查询是否有错误的方式，而不是返回的行数。[查看文档](http://www.php.net/manual/en/function.mysql-num-rows.php)以获取更多信息。

此外，这可能是可选的，但使用大括号将您的`else`语句括起来。[使用mysqli](http://www.php.net/manual/en/book.mysqli.php)而不是`mysql_...`您评论中提到的函数可能会更好。或者只是在将用户输入添加到查询字符串之前对其进行转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:22:58.870

使用 mysql_num_rows 检查记录是否存在..

```
$query = mysql_query("SELECT chair_status FROM reservation WHERE room_id = '$room_id' AND chair_number = '$chair_num'");
$rows = mysql_num_rows($query);
if($rows == 0)
{
$insert = mysql_query("UPDATE reservation SET chair_status = 1, student_name = '$name', stud_id = '$stud_id' WHERE room_id = '$room_id' AND chair_number = '$chair_num'");
} 
```

# google-apps-script - .geteditors 和组

> ID：10788278
> 
> 赞同：1
> 
> 时间：2012-05-28T17:16:54.737
> 
> 标签：google-apps-script

我正在尝试针对 DocsList 运行一个脚本，该脚本将收集查看者和编辑者的列表，然后对他们执行一些“工作”。（具体来说，我试图从相关文件中剥夺权利）。它工作得很好对于用户。但是对于组，它返回组名而不是电子邮件。我找不到使用应用程序脚本从该信息中检索组电子邮件地址的任何方法。如果我运行 fileObject.removeEditor( *Group Name* ) 告诉我这是一封无效的电子邮件（完全正确）。

我愿意接受建议......我完全被困在这里。

或者，我愿意采用一种我没想过的方式来删除对 Google Docs 中一堆文件的所有共享权限。

```
function getDocs(){
  var myFolders = DocsList.getAllFolders();
  var myFiles = DocsList.getAllFiles(0,10);
  var mySharing = new Array();

  for(x in myFiles){
    mySharing[x] = [myFiles[x].getId(), myFiles[x].getEditors(), myFiles[x].getViewers()];  
     for(y in mySharing[x][1]){
       if(mySharing[x][1][y].toString() != "doc.owner@deltahotels.com"){
         myFiles[x].removeEditor(mySharing[x][1][y]);
       }
     }
     for(y in mySharing[x][2]){
       if(mySharing[x][2][y].toString() != "doc.owner@deltahotels.com"){
         myFiles[x].removeEditor(mySharing[x][1][y]);
       }
     }
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T20:46:04.857

感谢您提出这个问题。这是 getEditors/getViewers 方法处理组的方式的问题。我已经在问题跟踪器中为您提出了[这个问题。](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1366)请给它加星标以更新进度。

# php - 如何在指定日期范围内更新/插入 SQL 中的随机日期

> ID：10788285
> 
> 赞同：0
> 
> 时间：2012-05-28T17:17:25.637
> 
> 标签：php, sql, phpmyadmin

请原谅我。我是一个绝对的新手，我需要 phpmyadmin 中这张表的帮助

我的表有以下列：

```
Primary_ID, Begin_Date, End_Date, Timestamp 
```

如何在 phpmyadmin 中更新选定的行，随机生成 begin_dates 和指定日期范围内的时间戳（例如：一个月中的 30 天）。例如期望的结果

```
Primary_id--- Begin_Date -------------Timestamp

1.------------2008-09-02--------------2008-09-02 21:48:09

2.------------2008-09-03--------------2008-09-03 15:19:01

3.------------2008-09-14--------------2008-09-14 01:23:12

4.------------2008-09-27--------------2008-09-27 19:03:59 
```

日期范围在 2008-09-01 和 2008-09-31 之间。时间24小时可变

我是一个新手，所以可以在 phpmyadmin 中使用的语法会有很大帮助。

我们正在为一个有 500 名成员的健身房网站进行演示，但添加的成员值都具有相同的开始日期和时间。尝试在数据库中将它们分成不同的月度注册，例如8 月不同日期和时间注册的50 人，10 月的35 人等。希望现在更清楚。谢谢 -

当我尝试以下答案之一时，我收到此错误：#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '$randomDate = rand(1,31)' 附近使用正确的语法。因此，理想情况下，我可以通过最少的编辑复制并粘贴到 phpmyadmin 中的代码将不胜感激. 如果可能，按顺序排列。对于一个完全理解和执行的假人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:28:02.617

就像是：

`insert into myTable (begin_date) values date_add('2008-09-01', INTERVAL RAND()*30 DAY)`

这应该创建一个带有随机 begin_date 的新行

`update myTable set Timestamp = date_add(begin_date, INTERVAL RAND()*1440 MINUTE)`

那么那个人应该将时间戳设置为当天的随机分钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:07:33.397

我会从这样的事情开始。一堆这些可以组合在一起，但我把它分开了，这样你就可以看到我在做什么。

要获取随机数，可以使用 rand()。获取一个日期、小时、分钟和秒

```
$randomDate = rand(1,31);
$randomHour = rand(1,24);
$randomMinute = rand(0,59);
$randomSecond = rand(0,59); 
```

您将需要前导零（03 而不是 3），以便您可以使用 str_pad 添加它们，如果需要

```
$randomDate = str_pad($randomDate, 2, '0',STR_PAD_LEFT);
//The '2' is how many characters you want total
//The '0' is what will be added to the left if the value is short a character 
```

对所有其他随机值执行相同操作。仅仅因为我喜欢简洁的查询，接下来您应该编写最终的更新字符串。

```
$newDate = '2008-09-'.$randomDate;
$newTime = $randomHour.':'.$randomMinute.':'.$randomSecond; 
```

现在我不知道您如何确定要更新哪些行，所以我将由您决定。例如，如果您想使用 Primary_id 3 执行此操作，我将向您展示一个查询：

```
$x = mysql_query("UPDATE yourTable SET Begin_Date=\"$newDate\", Timestamp=\"$newTime\" WHERE Primary_id = 3"); 
```

# php - 错误：“无法修改标头信息 - 标头已由 .... 发送”

> ID：10788290
> 
> 赞同：0
> 
> 时间：2012-05-28T17:17:47.450
> 
> 标签：php, mamp

我正在开发一个网站，我购买了 MAMP PRO。当我尝试通过 login_user.php 登录时：

```
if (empty($_POST)===false){
$username = $_POST['username'];
$password = $_POST['password'];

if (empty($username) === true || empty ($password) === true){ 

    $errors[] = 'You need to enter a username and password';
} else if (user_exists($username) === false){
    $errors[] = 'we can\'t find that username. have you registered?';
}else if (user_active($username) === false){
    $errors[] = 'you haven\'t activated your account!';
}else {
$login = login($username, $password);
if ($login === false){
    $errors[] = 'username/password combination is incorrect!';
}else {

   //set user session 
$_SESSION['user_id'] = $login;
//redirect user to home
header('Location: home.php');
exit();
    }

    }
print_r($errors);
    }
     ?> 
```

用户应该被重定向到 home.php。

它曾经在我之前使用的服务器上完美运行，但现在当我在本地机器上测试它时，我只得到一个白页（它基本上停留在 login_user.php 上）。与数据库的连接工作正常。标头在 MAMP 上是否正常工作？我可以在 logout.php 中设置会话并将其销毁，但是在设置或销毁会话后，这两个文件都不会重定向。有什么线索吗？

更新：我收到此错误：

```
Warning: Cannot modify header information - headers already sent by (output started at   /Applications/MAMP/htdocs/mywebsite/core/database/databaseconn.php:2) in /Applications/MAMP/htdocs/mywebsite/login_user.php on line 26 
```

修复！！！问题是，在 databaseconn.php 中，`<?php`
我无法相信它的第一行。;-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:41:52.873

`<?php` 问题是在 databaseconn.php 中，在您可能想要参考此链接之前，我将第一行留空： [“php-header-redirect-not-working”](https://stackoverflow.com/questions/423860/php-header-redirect-not-working)

# prolog - 解释给定的段落并将其转换为 Prolog 代码

> ID：10788292
> 
> 赞同：0
> 
> 时间：2012-05-28T17:17:52.420
> 
> 标签：prolog

艾萨克和阿尔伯特兴奋地描述了在瑞典举行的第三届年度国际科学博览会盛会的结果。共有三名参赛者，路易斯、雷内和约翰内斯。艾萨克报告说路易斯赢得了博览会，而雷内则获得了第二名。另一方面，阿尔伯特报告说约翰内斯赢得了博览会，而路易斯则获得了第二名。

事实上，艾萨克和阿尔伯特都没有对科学博览会的结果给出正确的报告。他们每个人都给出了一个正确的陈述和一个错误的陈述。三名参赛者的实际排名是什么？请将您的解决方案基于 Prolog 程序。

好吧，我是 prolog 的初学者，我想将这些段落解释为 prolog 代码，但我不知道如何处理这个问题。你能引导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:43:10.200

我们首先记录艾萨克和阿尔伯特的陈述。1 和 2 用于标识语句（“Isaac 的第一个语句......”），每个列表代表按其顺序排列的参与者。

```
isaac(1,[louis,_,_]).
isaac(2,[_,rene,_]).
albert(1,[johannes,_,_]).
albert(2,[_,louis,_]). 
```

接下来我们说谁参加了博览会，任何答案都应该是三个名字的排列。我正在使用 SWI prolog，`permutation`内置谓词也是如此：

```
domain([louis,johannes,rene]).
valid(X):- domain(D), permutation(D,X). 
```

最后，我们将所有内容放在一起：

```
go(X) :- isaac(I,X), 
         albert(J,X), 
         valid(X), 
         \+ (isaac(K,X), dif(I,K)), 
         \+ (albert(L,X), dif(J,L)). 
```

最后两行确保*只有*Isaac (Albert) 的一项声明是正确的。

# javascript - 使用下拉列表在嵌入代码中添加变量

> ID：10788296
> 
> 赞同：0
> 
> 时间：2012-05-28T17:18:05.203
> 
> 标签：javascript, html, variables, embed

我正在尝试制作一个显示雅虎图嵌入代码的脚本

嵌入脚本是

```
<embed bgcolor="#dbdbd3" flashvars="lcId=1169793726234&amp;state=symbol%3D^nsebank;range=1d;indicator=ema(13,34,55)+macd+rsi+stochasticfast;charttype=candlestick;crosshair=on;ohlcvalues=0;logscale=on;source=undefined" loop="false" menu="false" name="BANKNIFTY" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://us.js2.yimg.com/us.yimg.com/i/us/fi/yfc/swf/flashchart_1.18.swf" style="height: 775px; width: 550px" type="application/x-shockwave-flash" wmode="opaque"></embed> 
```

在此脚本中，我希望从下拉菜单列表中获取 state=symbol=^nsebank (^nsebank) 的值，然后在单击计算按钮时显示嵌入代码

我写的代码如下 -

```
<div id="looknorth"></div>
<script type="text/javascript">
function ln(){
D11=parseFloat(D1.value);
document.getElementById('looknorth').innerHTML='<embed bgcolor="#dbdbd3" flashvars="lcId=1169793726234&amp;state=symbol%3D"+D11+";range=1d;indicator=ema(13,34,55)+macd+rsi+stochasticfast;charttype=candlestick;crosshair=on;ohlcvalues=0;logscale=on;source=undefined" loop="false" menu="false" name="BANKNIFTY" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://us.js2.yimg.com/us.yimg.com/i/us/fi/yfc/swf/flashchart_1.18.swf" style="height: 775px; width: 550px" type="application/x-shockwave-flash" wmode="opaque"></embed>';} </script>
<table border=1 cellpadding=2 cellspacing=1  width="400">
<tr>
<td style="background-color:#123742; font-size:12 ; font-weight:bold">
<font color="#FFFFFF">Compounding</font>
<td>&nbsp;<br />
<select name="D1">
<option value="^nsei">Annually</option>
<option value="^bsen">Half Yearly</option>
</select>
<tr>
<td colspan="2" ALIGN="center">
<input type=button style="background-color:#123742; color:#FFFFFF; font-weight:bold; font-size:15" name=calculate value=Calculate onClick=ln();>
</table> 
```

该脚本不起作用，请帮助我修复错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:10:23.570

```
<div id="looknorth"></div>
<script type="text/javascript">
function ln(){
    D1 = document.getElementsByName("D1")[0]
    D11=parseFloat(D1.value);
    document.getElementById('looknorth').innerHTML='<embed bgcolor="#dbdbd3" flashvars="lcId=1169793726234&amp;state=symbol%3D'+D11+';range=1d;indicator=ema(13,34,55)+macd+rsi+stochasticfast;charttype=candlestick;crosshair=on;ohlcvalues=0;logscale=on;source=undefined" loop="false" menu="false" name="BANKNIFTY" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://us.js2.yimg.com/us.yimg.com/i/us/fi/yfc/swf/flashchart_1.18.swf" style="height: 775px; width: 550px" type="application/x-shockwave-flash" wmode="opaque"></embed>';
}
</script>
<table border=1 cellpadding=2 cellspacing=1  width="400">
<tr>
<td style="background-color:#123742; font-size:12 ; font-weight:bold">
<font color="#FFFFFF">Compounding</font>
<td>&nbsp;<br />
<select name="D1">
<option value="^nsei">Annually</option>
<option value="^bsen">Half Yearly</option>
</select>
<tr>
<td colspan="2" ALIGN="center">
<input type=button style="background-color:#123742; color:#FFFFFF; font-weight:bold; font-size:15" name="calculate" value="Calculate" onClick='ln()'> 
```

​​​​​​​​​​​​​​​​​​​​​​​​</p>

您在 innerHTML 行周围有一些不匹配的引号。同样，您从未在您的 javascript 中定义 D1 是什么，因此当您询问 D1.value 时，它​​不知道您想要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:38:28.253

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:46:48.357

There are few problems in your code:

1.  JS does not know that *D1* is the name of your html select control unless you define that.
2.  Improper usage of single and double quotes while setting the inner html of *looknorth*.
3.  *parseFloat* expects a string that contains numeric values but you pass *^nsei* for instance, which is invalid.

Replace JS function with this:

```
function ln(){
    var D1 = document.getElementsByTagName("D1")[0];
    var D11 = D1.value;
    var lknorth = document.getElementById('looknorth');
    lknorth.innerHTML= '<embed bgcolor="#dbdbd3" flashvars="lcId=1169793726234&amp;state=symbol%3D' + D11 + ';range=1d;indicator=ema(13,34,55)+macd+rsi+stochasticfast;charttype=candlestick;crosshair=on;ohlcvalues=0;logscale=on;source=undefined" loop="false" menu="false" name="BANKNIFTY" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://us.js2.yimg.com/us.yimg.com/i/us/fi/yfc/swf/flashchart_1.18.swf" style="height: 775px; width: 550px" type="application/x-shockwave-flash" wmode="opaque"></embed>';
} 
```

# rest - 如何编写球衣以使用不同的方法匹配“/hello”和“/hello?name=Mike”？

> ID：10788308
> 
> 赞同：0
> 
> 时间：2012-05-28T17:19:17.497
> 
> 标签：rest, jersey

客户端可能会请求两个具有相同路径但查询字符串不同的 url：

```
1\. /hello
2\. /hello?name=Mike 
```

如何使用 jersey 为它们各自定义两种不同的方法？

这是一个例子：

```
@Path("/hello") 
public class HelloResource {

    @Produces("text/plain")
    public String justHello() {}

    // how to call this method only the query string has "name"
    @Produces("text/plain")
    public String helloWithName() {}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:24:24.200

你不能这样做，Jersey 只匹配路径。有关完整详细信息，请参阅[http://jersey.java.net/nonav/documentation/latest/jax-rs.html](http://jersey.java.net/nonav/documentation/latest/jax-rs.html)。

您可以根据存在的查询参数构建自己的交换机。一般来说， name=mike 无论如何都不是很 RESTy。泽西岛确实支持：

```
 /hello/{name} 
```

这就是它的使用方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:00:24.250

其实你可以。您只需要将一个方法映射到 /hello/ 来检查查询参数。如果存在，则委托给另一个方法作为子资源。

[http://jersey.java.net/nonav/documentation/latest/jax-rs.html#d4e374](http://jersey.java.net/nonav/documentation/latest/jax-rs.html#d4e374)

# python - 反转字符串时切片与步幅

> ID：10788311
> 
> 赞同：4
> 
> 时间：2012-05-28T17:19:33.093
> 
> 标签：python

通常要反转列表，应执行以下操作：

```
>>>>l = [1, 2, 3, 4, 5]
>>>>l[::-1]  
[5, 4, 3, 2, 1] 
```

但不是这样的确切语法：

```
list[<start>:<end>:<stop>] 
```

如果我不提供可选参数，则默认值如下（如果我错了，请纠正我：

```
<start> = 0(Beginning of list)
<end>   = 5(Length of list)
<step>  = 1 
```

因此，如果我提供可选参数，它实际上应该会产生相同的结果：

```
>>>>l[0:5:-1]
>>>>[] 
```

但是相反，我得到一个空列表（我知道为什么会发生这种情况），但是在第一种情况下，python 采用的默认值是什么？它应该采用 0 和 5 作为默认值并且什么都不产生，或者是**[::-1 ]**不同于**list[start:end:stop]**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:31:06.213

`l[::-1]`等价于`l[slice(None,None,-1)]`，其中[`slice([start], stop[, step])`](http://docs.python.org/library/functions.html#slice)返回一个[切片](http://docs.python.org/glossary.html#term-slice)对象。考虑以下：

```
>>> slice(None,None,-1).indices(5)
(4, -1, -1)
>>> slice(None,None,1).indices(5)
(0, 5, 1) 
```

这是您在使用扩展索引语法访问列表时看到的确切行为，即`l[start:stop:step]`.

```
>>> l[::-1]
[5, 4, 3, 2, 1]
>>> l[slice(None,None,-1)]
[5, 4, 3, 2, 1] 
```

* * *

> ...但是在第一种情况下，python 采用的默认值是什么？

开始/停止的值（如果未提供）基于*索引的数量*（列表的长度）以及`step`. [具体来说，请参阅切片对象](http://hg.python.org/cpython/file/7d252dbfbee3/Objects/sliceobject.c#l161)的 CPython源代码( `Objects/sliceobject.c`)

```
if (r->start == Py_None) {
    *start = *step < 0 ? length-1 : 0;
} else {
    /* .... */
}

if (r->stop == Py_None) {
    *stop = *step < 0 ? -1 : length;
} else {
    /* .... */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:27:27.610

如果您的步骤比列表末尾的开始为负..您可以使用负索引来做到这一点。

尝试：

```
l[-1:-6:-1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:24:17.147

如果您向后遍历列表，则开始和停止是相反的，试试这个：

```
l[5:0:-1] 
```

有趣的是，它只对 5 个元素中的 4 个进行切片（因为“end”应该是末尾的一个），这不起作用：

```
l[5:-1:-1] 
```

这可以满足您的要求：

```
l[5::-1] 
```

# version-control - Perforce (p4) 搁置工作流程？

> ID：10788312
> 
> 赞同：0
> 
> 时间：2012-05-28T17:20:00.930
> 
> 标签：version-control, perforce, shelve

我正在尝试设计有用的工作流程来使用 p4 shelve。我是一个 git 用户，错过了它的很多功能。

基本流程（存储未完成的变更列表，做其他事情，返回完成初始任务——相当于 git stash）是微不足道的；我正在寻找有关如何在更复杂的场景中使用此功能的教程/文章。

我应该放弃并改用 git-p4 或 p4sandbox 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T11:30:06.007

在各种工具中广泛使用一种基本实践——在人们之间分享变化。

1.  按原样共享 - 其他人可以访问您的待处理更改列表，以便他们可以重新使用您的增量

2.  分享以供审查。例如 Code Collaborator 使用 Perforce 书架作为审查对象。

3.  共享以实现进一步的自动化。例如，我的公司使用 P4 待定更改列表将更改纳入持续集成，并在通过测试时进一步提交。

所以基本上从 git 或任何其他 DVCS 用户的角度来看，架子是分支的一种奇怪的替代品，没有什么你不能用架子做的，你可以用 DVCS 中的分支做。

# jsf - 带转换器的 p:selectOneMenu 仅显示第一项作为项目值，而 h:selectOneMenu 工作正常

> ID：10788321
> 
> 赞同：0
> 
> 时间：2012-05-28T17:21:03.843
> 
> 标签：jsf, primefaces

我有这个组件：

```
<h:selectOneMenu value="#{requestController.backing.selectedRequestVO.requestSituation}" converter="Situation">
     <f:selectItems value="#{requestController.listOrderSituations()}" var="requestSituation" itemLabel="#{requestSituation.description}" itemValue="#{requestSituation}" />
</h:selectOneMenu> 
```

它返回给我一个可以的选项列表，我正确设置了值和标签。

如果我将其更改为`<p:selectOneMenu>`仅显示第一项且仅显示 ID，并且我无法选择其他选项。

其他 PrimeFaces 组件正在工作。

# actionscript-3 - 如何将初始化对象的引用从一个类传递到另一个类，以添加 (addChild) 到显示列表？

> ID：10788322
> 
> 赞同：0
> 
> 时间：2012-05-28T17:21:17.210
> 
> 标签：actionscript-3, flash, air, addchild, displaylist

我创建了这个简单的示例，因为我使用了一个更复杂的类，一个菜单项，我想初始化 Main 类中的所有设置，然后在需要时将其添加到 Game 类中（并更新它）（两个类是分开的)

类：Main（文档类，（理想情况下）是初始化/创建所有内容的地方）

```
 public class Main extends MovieClip
    {
            //testing passing on reference to Game
        private var testBitmap:Bitmap;
        private var testBitmapData:BitmapData;
        private var testArray:Array;

            public function Main():void
            {
                testBitmapData = new BitmapData(256, 256, false, 0xCCDDEE);         
                testBitmap = new Bitmap(testBitmapData);            
                testArray = [];
                testArray.push(testBitmap);    //Array for reference

                game = new Game(540, 960, testArray); 
                    //create Game class, pass reference to Object
                game.x = 0;
                game.y = 0;
            }
     } 
```

类：游戏（由文档类创建，（理想情况下）是一切运行的地方）

```
 public class Game extends MovieClip
    {

            private var testingArray:Array

            public function Game(gameWidth:int, gameHeight:int, testArray:Array):void
            {
                    this.testingArray = testArray;  //assign to local Array and access
                    addChild(testingArray[0]);  
             //addChild to Game from an item intialised in Main, doesn't work >___<
            }
    } 
```

.

.

.

问题是，在我原来的游戏课上；它接收缓存的 BitmapData 的初始包和一个列表数组，告诉它它需要在此处循环通过削减的 BitmapData（并且该引用仅用于更新作品（如果我已经在 Main 中添加了Child）：

```
 public function Game(gameWidth:int, gameHeight:int, cachedBitmapClipArray:Array)
    {

            this.cachedBitmapClipArray = cachedBitmapClipArray;

            private function update():void
            {           
                for each (tempCachedBitmapClip in cachedBitmapClipArray)  
                {
                    tempCachedBitmapClip.updateCurrentTile();   
          //but updating through the reference to an item initialised in Main works !!
                }
            }

    } 
```

.

如何使引用和传入的对象（或有权访问）的行为与原始实例一样？（能够添加孩子）

即对象可以跨越“范围”（??）还是应该只在它们已初始化的类中控制（实例化）对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:36:37.783

好吧，回答最后一个问题，是的，对象可以从一个对象传递到另一个对象。我很难理解到底是什么问题。在通用编程术语中，对象或任何其他复杂类型通过引用传递，原始类型也通过引用传递，但 AVM 的内部以将它们视为按值传递的方式处理它们。有关如何通过函数/方法调用传递参数的非常清晰的解释（至少在我看来），请阅读此处： [http ://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f56.html](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f56.html)

查看左侧树状导航中的其他区域，了解有关语言本身的更多详细信息。

需要注意的一点是，尽管我认为编译器会解决此错误，但在您发布的第一段代码中，Game 的返回值为 :void 对于构造函数不应该声明返回类型，因为它应该被隐式类型化为类是。

用我自己的话添加一些关于按引用传递或按值传递的解释。按值传递意味着对象的值，即存储在变量指向的位置的字节实际上被复制到然后使用的新内存位置。这在实践中意味着它们不是相同的内存字节，而是它们是两个独立的内存位置，每个位置都存储了相同的值，在传递后修改一个值不会影响原始值。通过引用传递是说您传递了内存位置，因此没有为该值分配新内存，这两个值实际上都指向同一个内存位置（指向它们本身的指针可能不同，但指针都指向同一个位置记忆）。在这种情况下，对象是相同的。

您正在做的事情是可取的，分工并在类中封装特定类型的功能确实使代码更易于使用。我认为唯一的问题是，如果 Game 对象本身从未作为子对象添加到显示树中的某物（附加到舞台的某物）中。看来您正在创建一个新游戏并设置它的位置，但从未将其作为子级添加到舞台上，然后将任何内容添加到游戏中永远不会成为显示树的一部分。

# css - 如何正确从绝对定位切换到固定定位

> ID：10788325
> 
> 赞同：0
> 
> 时间：2012-05-28T17:21:41.530
> 
> 标签：css, css-position

我有一个问题，我用“位置：绝对”定位一个对话框，它工作正常，把它放在屏幕的中心。但是之后我将“位置：绝对”切换为“位置：固定”，这会导致位置不在中心。（我正在使用我拥有的最新稳定的谷歌浏览器。）

有什么诀窍让我做出这个切换时，它总是在中心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:26:43.367

您需要使用这些样式使其看起来死心：

```
position:fixed;
top:50%;
left:50%;
width:400px;  /* adjust as per your needs */
height:400px;   /* adjust as per your needs */
margin-left:-200px;   /* half of width above */
margin-top:-200px;   /* half of height above */ 
```

所以`position`应该指定。和`top`应该`left`是`50%`。`margin-left`和`margin-top`应该分别是盒子宽度和高度的负值的一半。

*请注意，`position:fixed`这在 IE6 中不起作用。*

# c# - 如何与新进程共享信息（除了命令行参数）？

> ID：10788326
> 
> 赞同：0
> 
> 时间：2012-05-28T17:21:42.093
> 
> 标签：c#, .net, visual-studio-2010, process

我正在开始一个新的过程：

```
process.Start(); 
```

我知道我可以使用以下方法将字符串传递给它：

```
process.StartInfo.Arguments = ... 
```

但我想分享的不仅仅是几个简单的字符串——一个字节数组等。我该怎么做？

编辑：这将作为 ClickOnce 应用程序安装，所以我真的不知道它将安装在文件系统中的什么位置，我希望它尽可能简单，以便在卸载后不会保留任何文件。那么我把这些数据放在哪里呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:24:36.727

看看[内存映射文件](http://msdn.microsoft.com/en-us/library/dd997372.aspx)——它们允许您在进程之间共享数据。

替代方案是常规文件、注册表、通过[套接字](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx)进行通信等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:24:30.767

如果数组很小，你可以只对它进行**base64**编码。其他选项包括将数据保存到**文件**或使用**[命名管道](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365590%28v=vs.85%29.aspx)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:59:12.697

您可以创建一个临时文件，将所有必需的数据写入其中并将结果文件名作为命令行参数发送。当第二个应用程序运行时，它将读取文件的内容并将其删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T00:33:40.613

如果您可以正确编码字节数组（例如base64），您可以重定向目标进程的标准输入并通过它进行流式传输：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardinput.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardinput.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T17:25:35.240

您可能想使用[匿名管道](http://msdn.microsoft.com/en-us/library/bb546102.aspx)。

> 匿名管道提供的功能比命名管道少，但也需要较少的开销。您可以使用匿名管道使本地计算机上的进程间通信更容易。您不能使用匿名管道通过网络进行通信。

# phpmyadmin - Debian LAMP 服务器 - 如何访问 PHP MyAdmin

> ID：10788329
> 
> 赞同：0
> 
> 时间：2012-05-28T17:22:11.627
> 
> 标签：phpmyadmin, debian, lamp

一位朋友设置了一个 debain LAMP 服务器，并为我提供了登录用户名、密码、root 密码和 IP 地址，以及防火墙端口。有人可以告诉我如何通过网络浏览器访问 PHP MyAdmin 界面吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:31:12.383

IP 地址后跟 /phpmyadmin = 问题已解决。感谢你们！

# arrays - Delphi - EAcessViolation 错误

> ID：10788330
> 
> 赞同：1
> 
> 时间：2012-05-28T17:22:17.770
> 
> 标签：arrays, delphi, memory, dynamic

所以伙计们...我已经阅读了很多内容，并且尝试过使用诸如 madExcept 之类的插件（我是新手），但到目前为止我还无法确定是什么导致了我的错误。

**在看似随机的时间调用 SetLength() 时，我的代码出现 EAccessViolation 异常。我一直无法确定其背后的原因，我什至无法将其追踪到一行代码。我想请你帮我整理一下。**

这个函数应该在一个数字数组中寻找重复的模式并计算它们。目前，它的逻辑还没有 100% 准备好，但我想在继续之前纠正这些错误。

完成后如何工作的示例：

给定数组 {1, 2, 3, 4, 1, 2, 3, 5}，它将子数组 (1, 2, 3) 与所有其他可能的子数组 (4, 1, 2) 进行比较，( 1, 2, 3) 和 (2, 3, 5)，计算它们相同的情况。然后该函数将继续到下一个长度，并通过比较 (1, 2, 3, 4) 和 (1, 2, 3, 5) 再次开始...

*   最大数组长度为 45。
*   最小子数组长度为 3。
*   **EAccessViolation 错误通常发生在数组长度为 12-13 并且通常发生在第一个循环的最后一次迭代中。**

再一次，我知道算法逻辑本身存在缺陷，但我真的想先修复内存问题。

非常感谢你。

```
function TfrmMain.Ready(Numbers: Array of SmallInt): SmallInt;
var
  i: Integer;
  Length, MinLength, MaxLength: SmallInt;
  Array1, Array2: Array of SmallInt;
  Array1Pos, Array1FirstPos, Array1LastPos: Integer;
  Array2Pos, Array2FirstPos, Array2LastPos: Integer;
begin
  Result := 0;

  MinLength := 3;
  MaxLength := Trunc( (High(Numbers) + 1 ) / 2 );

  for Length := MinLength to MaxLength do
  begin
    SetLength(Array1, 0);
    SetLength(Array2, 0);

    SetLength(Array1, Length);

    Array1FirstPos := 0;
    Array1LastPos  := High(Numbers) - High(Array1);

    for Array1Pos := Array1FirstPos to Array1LastPos do
    begin
      for i := Array1Pos to Length + Array1Pos do
        Array1[i - Array1Pos] := Numbers[i];

      if ( High(Array2) + 1 <> Length ) then
        SetLength(Array2, Length);

      Array2FirstPos := Array1Pos + Length;
      Array2LastPos  := High(Numbers);

      if ( ( Array1Pos >= Array2FirstPos ) and ( Array1Pos + Length <= Array2LastPos ) ) then
        for Array2Pos := Array2FirstPos to Array2LastPos do
        begin
          for i := Array2Pos to Length + Array2Pos do
            Array2[i - Array2Pos] := Numbers[i];

          if CompareArrays(Array1, Array2) then
            Result := Result + 1;
        end;
    end;
  end;

  SetLength(Array1, 0);
  SetLength(Array2, 0);
end;

function TfrmMain.CompareArrays(Array1, Array2: Array of SmallInt): Boolean;
var
  i: Integer;
begin
    Result := false;

  if ( High(Array1) <> High(Array2) ) then
    Exit;

  for i := 0 to High(Array1) do
    if ( Array1[i] <> Array2[i] ) then
        Exit;

    Result := true;
end; 
```

**解决了！谢谢杰弗森奥利维拉！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:47:19.363

引发的错误取决于您传递的数组的内容，因此如果您可以向我们展示一个调用示例或您的备忘录的内容会更好。

无论如何，分析你的代码，我可以看到一些东西：

在下面的行中：

```
 if ( High(Array2) + 1 <> Length ) then
    SetLength(Array2, Length); 
```

如果 Length = 0 或 Length = High(Array2) + 1，则不会定义 Array2 长度。

因此，当执行下面的代码时：

```
 if ( ( Array1Pos >= Array2FirstPos ) and ( Array1Pos + Length <= Array2LastPos ) ) then
    for Array2Pos := Array2FirstPos to Array2LastPos do
    begin
      for i := Array2Pos to Length + Array2Pos do
        Array2[i - Array2Pos] := Numbers[i]; 
```

如果尚未定义 Array2 的长度，则可能有 AccessViolation。因此（仅出于修复此代码的目的），您应该在尝试访问其索引之前测试 Array2 的长度，使用：

```
for i := Array2Pos to Length + Array2Pos do
begin
    if ((i - Array2Pos) >= System.Length(Array2) - 1) then
        Array2[i - Array2Pos] := Numbers[i];
end; 
```

但我相信，专注于你的逻辑并组织一些测试值，你会发现你的代码需要做很多改进，这些代码本身就可以解决当前的 AV。

**编辑：**由于您的变量与全局函数“Length”具有相同的名称，因此我更新了示例代码以使用“命名空间”系统。

# c++ - 使用 VS-C++ 2010 Express 版本时出现链接器错误

> ID：10788331
> 
> 赞同：1
> 
> 时间：2012-05-28T17:22:19.253
> 
> 标签：c++, visual-studio-2010, linker

我是 C++ 和 VS 菜鸟。我正在尝试学习斯坦福大学的 CS 106b 课程（**链接到课程[页面](http://www.stanford.edu/class/cs106b/)**）以使用 C++ 进行编程。但是，我在尝试设置启动代码时遇到了一些问题。例如，下面的代码，

```
#include <iostream>
#include "graphics.h"
using namespace std;

int main(){
    initGraphics();
    setColor("BLUE");
    fillRect(50,50,300,150);
    setFont("Times New Roman");
    setColor("WHITE");
    drawString("Hello World Graphically!!",60,140);

    return 0;
} 
```

编译成功，但会引发以下链接器错误。

```
 1>------ Build started: Project: HellowWorld, Configuration: Release Win32 ------
    1>Hello.obj : error LNK2005: _main already defined in GraphicsHelloWorld.obj
    1>StanfordCPPLib.lib(startup.obj) : warning LNK4075: ignoring '/EDITANDCONTINUE' due to '/OPT:ICF' specification
    1>LINK : warning LNK4098: defaultlib 'MSVCRTD' conflicts with use of other libs; use /NODEFAULTLIB:library
    .......
width@ios_base@std@@QBEHXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: int __thiscall std::ios_base::width(void)const " (__imp_?width@ios_base@std@@QBEHXZ)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: int __thiscall std::ios_base::width(void)const " (__imp_?width@ios_base@std@@QBEHXZ)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: int __thiscall std::ios_base::width(void)const " (__imp_?width@ios_base@std@@QBEHXZ)
    1>StanfordCPPLib.lib(error.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Lock(void)" (__imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Lock(void)" (__imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Lock(void)" (__imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Lock(void)" (__imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(error.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Unlock(void)" (__imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Unlock(void)" (__imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Unlock(void)" (__imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_streambuf<char,struct std::char_traits<char> >::_Unlock(void)" (__imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >::`vbase destructor'(void)" (__imp_??_D?$basic_istringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >::`vbase destructor'(void)" (__imp_??_D?$basic_istringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) class std::basic_istream<char,struct std::char_traits<char> > & __cdecl std::operator>><char,struct std::char_traits<char> >(class std::basic_istream<char,struct std::char_traits<char> > &,char &)" (__imp_??$?5DU?$char_traits@D@std@@@std@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@0@AAV10@AAD@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: __thiscall std::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,int)" (__imp_??0?$basic_istringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@ABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@1@H@Z)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: __thiscall std::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >::basic_istringstream<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,int)" (__imp_??0?$basic_istringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@ABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@1@H@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl std::operator+<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,char const *)" (__imp_??$?HDU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@PBD@Z)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl std::operator+<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,char const *)" (__imp_??$?HDU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@PBD@Z)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl std::operator+<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,char const *)" (__imp_??$?HDU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@PBD@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::substr(unsigned int,unsigned int)const " (__imp_?substr@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBE?AV12@II@Z)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::substr(unsigned int,unsigned int)const " (__imp_?substr@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBE?AV12@II@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: char & __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::operator[](unsigned int)" (__imp_??A?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAADI@Z)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: char & __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::operator[](unsigned int)" (__imp_??A?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAADI@Z)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: char & __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::operator[](unsigned int)" (__imp_??A?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAADI@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) bool __cdecl std::operator==<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,char const *)" (__imp_??$?8DU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA_NABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@PBD@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::`vbase destructor'(void)" (__imp_??_D?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::`vbase destructor'(void)" (__imp_??_D?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::`vbase destructor'(void)" (__imp_??_D?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEXXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::str(void)const " (__imp_?str@?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@2@XZ)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::str(void)const " (__imp_?str@?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@2@XZ)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::str(void)const " (__imp_?str@?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@2@XZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) struct std::_Smanip<int> __cdecl std::setw(int)" (__imp_?setw@std@@YA?AU?$_Smanip@H@1@H@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >(int)" (__imp_??0?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@H@Z)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >(int)" (__imp_??0?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@H@Z)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: __thiscall std::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >::basic_ostringstream<char,struct std::char_traits<char>,class std::allocator<char> >(int)" (__imp_??0?$basic_ostringstream@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@H@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > & __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::operator+=(char)" (__imp_??Y?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV01@D@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: unsigned int __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::length(void)const " (__imp_?length@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBEIXZ)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: unsigned int __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::length(void)const " (__imp_?length@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBEIXZ)
    1>StanfordCPPLib.lib(strlib.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: unsigned int __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::length(void)const " (__imp_?length@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBEIXZ)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) bool __cdecl std::operator<<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (__imp_??$?MDU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA_NABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@0@Z)
    1>StanfordCPPLib.lib(gwindow.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) bool __cdecl std::operator==<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (__imp_??$?8DU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA_NABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@0@Z)
    1>StanfordCPPLib.lib(pcgraphics.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > & __thiscall std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::operator=(char const *)" (__imp_??4?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV01@PBD@Z)
    1>StanfordCPPLib.lib(gtypes.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl std::operator+<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (__imp_??$?HDU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@0@Z)
1>D:\C++Projects\HellowWorld\Release\HellowWorld.exe : fatal error LNK1120: 28 unresolved externals 
```

顺便说一句，我通过编辑路径存储了外部 StanfordCPPLib.lib 的路径，`Project->Properties->Linker->Additional Dependencies->D:\C++Projects\HellowWorld\HellowWorld\StanfordCPPLib.cpp`并通过添加附加头文件`Project->Properties->C/C++->Additional Include Directories->C:\Users\Vivek\Downloads\Assignment1-vs2008\StanfordCPPLib\include` 这两个文件夹都存在于它们的位置。关于我在这里做错的任何提示都会有所帮助！

# css - JQuery Mobile 中的导航栏按钮大小

> ID：10788332
> 
> 赞同：1
> 
> 时间：2012-05-28T17:22:27.787
> 
> 标签：css, jquery-mobile

我正在尝试在 JQuery Mobile 中为将在 iOS 中运行的应用程序创建一个导航栏。我的代码如下所示。当我运行应用程序时，会出现三个选项。但是，它们都被挤压到左侧。我想要三个选项来填充页脚中的可用空间。我究竟做错了什么？我只是使用在 jquery 移动页面中引用的字形图标。谢谢您的帮助！

```
<style type="text/css">
  .navbar .ui-btn .ui-btn-inner { padding-top: 40px !important; }
  .navbar .ui-btn .ui-icon { width: 30px!important; height: 30px!important; margin-left: -15px !important; box-shadow: none!important; -moz-box-shadow: none!important; -webkit-box-shadow: none!important; -webkit-border-radius: 0 !important; border-radius: 0 !important; }                

  #navButton1 .ui-icon { background: url(/navbar/option1.png) 50% 50% no-repeat; background-size: 24px 22px; }
  #navButton2 .ui-icon { background: url(/navbar/option2.png) 50% 50% no-repeat; background-size: 24px 22px; }      
  #navButton3 .ui-icon { background: url(/navbar/option3.png) 50% 50% no-repeat; background-size: 24px 22px; }          
</style>

...

<div id="myPage" data-role="page">
  <div data-role="header" data-position="fixed">
    <h1>My App</h1>
  </div>

  <div data-role="content">
    <!-- My Content -->
  </div>

  <div data-role="footer" data-position="fixed" class="navbar">
    <div id="myNavbar" data-role="navbar" class="navbar" data-grid="d">
      <ul>
        <li><a href="#" id="navButton1" data-icon="custom" class="ui-btn-active ui-state-persist">Option 1</a></li>
        <li><a href="option2.html" id="navButton2" data-icon="custom" rel="external" data-transition="none">Option 2</a></li>
        <li><a href="option3.html" id="navButton3" data-icon="custom" rel="external" data-transition="none">Option 3</a></li>
      </ul>
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:58:12.627

尝试从 div 元素中删除 data-grid="d" 。

# tridion - Tridion 2009 SP1：Broker 如何获取二进制 URL？

> ID：10788333
> 
> 赞同：1
> 
> 时间：2012-05-28T17:22:30.440
> 
> 标签：tridion, tridion2009, tridion-content-delivery

我正在尝试检索作为动态组件演示文稿发布的多媒体组件文件的二进制 URL。

我可以在 Broker 数据库的 Binaries 表中看到 Url，但我似乎无法使用以下任一代码位获取二进制 url：

使用 SQLBinaryMetaHome：

```
using (var sqlBinMetaHome = new Com.Tridion.Broker.Binaries.Meta.SQLBinaryMetaHome())
{
    int componentItemId = int.Parse(queryStringId.Split('-')[1]);
    var binaryMeta = sqlBinMetaHome.FindByPrimaryKey(new TCDURI(publicationId, 16, componentItemId));

    if (binaryMeta != null)
    {
        VideoBinaryUrl = binaryMeta.GetURLPath();
    }
    else
    {
        Logger.Log.ErrorFormat("Failed ot load via SQL Binary Meta {0}", queryStringId);
    }
} 
```

使用二进制元工厂：

```
using (var b = new BinaryMetaFactory())
{
    var binaryMeta = b.GetMeta(queryStringId);
    if (binaryMeta != null)
    {
        VideoBinaryUrl = binaryMeta.UrlPath;
    }
    else
    {
        Logger.Log.ErrorFormat("Failed to load binary meta {0}", queryStringId);
    }
} 
```

我可以使用 ComponentMetaFactory 加载组件元数据。

关于为什么我无法加载二进制元的任何想法？我在正确的轨道上吗？

抢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T18:46:24.080

It looks like your first example is importing (auto-generated) methods from an internal DLL (`Tridion.ContentDelivery.Interop.dll`). Please don't use those and stick to the ones in the Tridion.ContentDelivery namespace (`Tridion.ContentDelivery.dll`).

You can find the official [documentation for the Content Delivery .NET API](https://www.sdltridionworld.com/images/TOM.NET%20API_tcm89-20020.chm) in CHM format on SDL Tridion World (click the link, log in to the site and click the link again). From that documentation comes this example:

```
//create a new BinaryMetaFactory instance:
BinaryMetaFactory binaryMetaFactory = new BinaryMetaFactory();
//find the metadata for the specified binary
BinaryMeta binaryMeta = binaryMetaFactory.GetBinaryMeta("tcm:1-123");
//print the path to the output stream:
if(binaryMeta!=null) {
    Response.Write("Path of the binary: " + binaryMeta.UrlPath);
}
//Dispose the BinaryMetaFactory
binaryMetaFactory.Dispose(); 
```

The factory class is `Tridion.ContentDelivery.Meta.BinaryMetaFactory` from `Tridion.ContentDelivery.dll`. I indeed also can't find a `GetBinaryMeta` method in that class, so it seems there is a mistake in the code sample. The most likely method that you should use is `GetMeta`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T12:13:47.063

您是否有理由不使用二进制链接来获取链接对象到您想要的二进制文件的特定变体？请记住，任何 DCP 都可能呈现多媒体组件的多种变体。然后，您可以从 Link 对象获取二进制文件的 URL。

在文档中查找 BinaryLink 以获取更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T10:08:30.197

我对代码做了一个 SQL Profiler，发现这是因为我部署了我的测试应用程序，它没有调用代理。在实际的 Tridion Published 站点中运行代码确实命中了数据库，但它为 variantId 列传递了值“[#def#]”。

我现在可以使用以下代码：

```
IComponentMeta cm = cmf.GetMeta(queryStringId);
if (cm != null)
{
    TcmId = queryStringId;
    Title = cm.TryGetValue("title");
    Summary = cm.TryGetValue("summary");
    Product = cm.TryGetValue("product");

    if (cm.SchemaId == StreamingContentSchemaId)
    {
        VideoId = cm.TryGetValue("video_url");
        IsVimeo = true;
    }
    else if (cm.SchemaId == WebcastSchemaId)
    {
        using (var b = new BinaryMetaFactory())
        {
            var binaryMeta = b.GetMeta(queryStringId, "tcm:0-" + cm.OwningPublicationId + "-1");
            if (binaryMeta != null)
            {
                VideoBinaryUrl = binaryMeta.UrlPath;
            }
            else
            {
                Logger.Log.ErrorFormat("Failed to load binary meta {0}", queryStringId);
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T17:45:23.017

尝试这个：-

```
 BinaryMeta binaryMeta = b.GetBinaryMeta(queryStringId);
 if(binaryMeta != null) {
       VideoBinaryUrl = binaryMeta.URLPath;
 } 
```

# reporting-services - 无法在仪表板设计器中选择默认参数

> ID：10788334
> 
> 赞同：0
> 
> 时间：2012-05-28T17:22:44.310
> 
> 标签：reporting-services, performancepoint

我在 Report Builder 3.0 中创建了一个带有参数的报表，当我将它添加到仪表板设计器时，我可以看到报表中的所有参数，但我无法从`<Default Value>`. 当我从 PerformancePoint 运行报告时，我仍然可以为参数选择一个值，所以不是参数损坏。

有问题的参数是单值参数，可用值和默认值设置为“从查询中获取值”，并且由报表生成器自动生成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:50:12.517

有时自动生成的数据集错误地需要参数。查看隐藏的数据集并转到其属性。删除参数部分中的所有参数并调整查询，使其不使用该参数。一旦参数消失，仪表板设计器应该能够显示列表。

# api - 如何使用 JIRA SOAP API 获取当前用户权限？

> ID：10788335
> 
> 赞同：1
> 
> 时间：2012-05-28T17:22:55.440
> 
> 标签：api, soap, jira

我正在使用 SOAP API 开发 JIRA 客户端，我想提前检查用户将拥有哪些功能。

**例如，如果用户没有 Add Comments RemotePermission**，我不想显示一个按钮来评论问题。

我尝试使用**getAllPermissions**方法，但似乎它获得了应用程序中的所有权限，而不是用户拥有的权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:48:28.217

不容易。在 4.4 中有一种检查评论权限的方法，但不是一般情况下的所有权限，IIRC。

[http://docs.atlassian.com/rpc-jira-plugin/4.4/com/atlassian/jira/rpc/soap/JiraSoapService.html#hasPermissionToEditComment(java.lang.String](http://docs.atlassian.com/rpc-jira-plugin/4.4/com/atlassian/jira/rpc/soap/JiraSoapService.html#hasPermissionToEditComment(java.lang.String) , com.atlassian.jira.rpc.soap. beans.RemoteComment)

如果可以的话，最好使用 REST。

# c - pselect 无法识别事件

> ID：10788337
> 
> 赞同：0
> 
> 时间：2012-05-28T17:23:08.247
> 
> 标签：c, multithreading, sockets, io, network-programming

我正在开发一个客户端-服务器应用程序。每边有两个线程（我调用的主线程和控制线程）。我在两个线程中都使用 pselect() 。控制线程的工作是将控制/信号包发送到客户端的控制线程，以根据信号进行活动。主线程的工作是连续读取/写入数据，控制线程通过单独的 TCP -IPV4 连接进行通信。我在服务器端使用 sigusr 信号，它设置了一些全局标志（使用互斥体）并基于该信号服务器控制线程然后将信号包发送到客户端的控制线程。

问题：我看到服务器已经发送了数据（检查发送的返回值）但是客户端控制线程中的 pselect() 没有及时识别它。我有时看到它最后接收到数据（当数据传输时over main thread 完成）或根本没有收到它。当我在不同的 linux 服务器上运行时，相同的代码工作正常（2.6.18-274.12.1.el5 #1 SMP Tue Nov 8 21:37:35 EST 2011 x86_64 x86_64 x86_64 GNU/Linux）但不是在当前的（2.6 .32-220.4.2.el6.x86_64 #1 SMP Mon Feb 6 16:39:28 EST 2012 x86_64 x86_64 x86_64 GNU/Linux)

两个服务器上的优先级和调度方案相同（0,0）。在使用 pselect 之前，我已经阅读了使用 sigproc 来屏蔽信号的 abt，但我不确定要处理什么信号，因为我只是向服务器而不是客户端发出信号。还要添加客户端和服务器都在同一台机器上运行（我使用环回地址进行通信）。我已经尝试了阻塞（pselect 中的时间结构设置为 NULL）和非阻塞模式的 pselect。此外，我每次都在循环中的 FD_SET 中设置套接字 id。代码如下。请指教

/ ***** *******代码******* *** *** /***

 ***```
 while(vg_closeCtrlThread==0)
    {

            FD_ZERO(&vl_fdsctrl);
            FD_SET(vg_ctrlSocket.socket_id,&vl_fdsctrl);
            //fprintf(stdout,"Setting FD SET...Control thread \n");
            /* Set the select polling to few seconds */
            vl_tv.tv_sec = 0;//HS
            //vl_tv.tv_sec = 50;//HS
            vl_tv.tv_nsec = 10000;

            /* Set the select polling to few seconds */
            vl_tv2.tv_sec = 0;//HS
            vl_tv2.tv_nsec = 500;

            /* variable vg_ctrlpacket_sent and ip_proto_switch are set when sigusr is received for server process using mutexes , this if cond executes only on server side */
            if(vg_dataSocket->vst_iptype == IPV_BOTH && vg_ctrlpacket_sent && ip_proto_switch)
            {
                    fprintf(stdout,"vg_ctrlpacket_sent value:%d\n",vg_ctrlpacket_sent);
                    fprintf(stdout,"ip_proto_switch value:%d\n",ip_proto_switch);
                    if(vg_ctrlSocket.vst_isserver)
                    {
                            FD_ZERO(&vl_fds);
                            FD_SET(vg_dataSocket->sock_id[1],&vl_fds);

                            fprintf(stdout,"\t\t Switch protocol..Control Thread\n");
                            vl_ctrlInfo->vst_type = IP_SWITCH;

                            vlError = fn_send(&vg_ctrlSocket,(char *)&vl_ctrlInfo->vst_type,sizeof(vl_ctrlInfo->vst_type),NO_DATA_TX);
                            fprintf(stdout,"Ctrl packet Send error:%d\n",vlError);

                           if(vlError == -1)
                           {
                            fprintf(stderr,"Error in sending the data,Err:%s\n",fn_strerror_r(errno,err_buff),vg_ctrlSocket.vst_nm_thread);
                                    exit(EXIT_FAILURE);
                            }
                    }
                    vg_ctrlpacket_sent = 0;

                    pthread_mutex_lock(&socket_mutex_2);
                                            vg_ctrlpacket_recv = 1;
                    pthread_mutex_unlock(&socket_mutex_2);
            }
            //fprintf(stdout,"Before pselect ctrlthread..\n");

            /* check if any data is available on the socket */
            if(vg_ctrlSocket.vst_isserver)
                    vlError = pselect(vg_ctrlSocket.socket_id+1, &vl_fdsctrl,NULL, NULL, &vl_tv,NULL);
            else{
                    fprintf(stdout,"...Here is the PROBLEM*\n");
                    vlError = pselect(vg_ctrlSocket.socket_id+1, &vl_fdsctrl,NULL, NULL,NULL ,NULL);
                    //vlError = select(vg_ctrlSocket.socket_id+1, &vl_fdsctrl,NULL, NULL,NULL);

            }
            //perror("Just to check for illegal error\n");

            /* Reinitialize the polling to few seconds */
            vl_tv.tv_sec = 0;//HS

            vl_tv.tv_nsec = 10000;

            if(vlError == -1)
            {
                    perror("Error in select() function of Control thread");
                    exit(EXIT_FAILURE);//HS
            }
            else if(vlError > 0)
            {
                    memset(vlBuffer,0,56);
                    if(debug>1){
                            fprintf(stdout,"The socket id is:%d, Thread:%s\n",vg_ctrlSocket.socket_id,vg_ctrlSocket.vst_nm_thread);
                    }
                    vlError = fn_recv(&vg_ctrlSocket,(char *)&vl_ctrlInfo->vst_type,sizeof(vl_ctrlInfo->vst_type),NO_DATA_TX);
                    if(vlError < 0)
                    {
                            fprintf(stderr,"Error in receiving the data,Err:%s\n",fn_strerror_r(errno,err_buff));
                            exit(EXIT_FAILURE);
                    }
                    if(vlError > 0)
                    {
                            if(debug>1)
                                    fprintf(stdout,"Some data received: %d, Thread:%s..\n",vlError,vg_ctrlSocket.vst_nm_thread);
                            switch(vl_ctrlInfo->vst_type)
                            {
                            case BANDWIDTH_INFO:
                                    if(debug)
                                            fprintf(stdout,"Received bandwidth information..Control Thread\n");
                                    vlError = fn_recv(&vg_ctrlSocket,(char *)&vl_ctrlInfo->vst_info,sizeof(vl_ctrlInfo->vst_info),NO_DATA_TX);
                                    fprintf(stdout,"Bandwidth :%.3f\n",vl_ctrlInfo->vst_info.vst_info);
                                    if(vlError > 0)
                                            fn_setShmDownStreamInfo(vl_ctrlInfo->vst_info);
                                    break;
                            case PROTO_ACK_INFO:
                                            fprintf(stdout,"Received ack..Control Thread\n");
                                            vlError = fn_recv(&vg_ctrlSocket,(char *)vl_ctrlInfo,sizeof(st_ackPacket),NO_DATA_TX);
                                            if(vlError > 0)
                                                    fn_protoProcessAck(vlBuffer);
                                    break;
                            case IP_SWITCH:/* this is packet data for now */
                                            fprintf(stdout,"\t\t switch..Control Thread\n");
                                            pthread_mutex_lock(&socket_mutex_2);
                                                    fprintf(stdout,"Locking vg_ctrlpacket_recv..Control Thread\n");
                                                    vg_ctrlpacket_recv = 1;
                                                    pthread_mutex_unlock(&socket_mutex_2);
                         break;

                            } /* switch(vl_ctrlInfo->vst_type) */

                    } /* if(vlError > 0) */
                    else if(vlError == 0)
                    {
                            fn_cleanUpCtrlThread();
                    }/* if(vlError == 0) */
            }/* if(vlError) */
    }/* while(vg_closeCtrlThread==0) */ 
```

谢谢...***

# asp.net - 如何在 IIS 中托管 ASP.NET MVC 项目？

> ID：10788346
> 
> 赞同：0
> 
> 时间：2012-05-28T17:23:59.527
> 
> 标签：asp.net, asp.net-mvc, security, iis, dll

我有一个 ASP.NET MVC 解决方案，它下面有多个项目，在服务器上上传站点后它在本地工作正常我收到**System.Reflection.ReflectionTypeLoadException**错误

![我收到的错误的屏幕截图](../Images/ad7c6530e3071397cf700e4a3d223b4c.png)

我也在尝试在**IIS**上运行解决方案，我得到的错误是**Not Found The requested URL / was not found on this server。**

我也已将所有 DLL 复制到输出文件夹，问题可能是最有可能来自缺少 DLL 的问题，是来自远程托管安全级别还是我在项目中缺少其他内容，请告知。 ![在此处输入图像描述](../Images/10ac1b320880d188254fdb1fbd6eb2f8.png)

**在调用 hostgator（网站所在的地方）并解决问题后，我被告知在我们的托管中不允许使用自定义 DLL，**因为您可能会看到我已经截取了 DLL 的屏幕截图我想知道我的项目中的自定义 DLL 是什么hostgator 技术人员说

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:04:15.287

我假设您正在运行 ASP.NET MVC v3。在这种情况下，您是否将 IIS 中的应用程序池 .NET Framework 版本设置为 C# 4.0？确实，您的服务器上是否安装了 ASP.NET MVC 和 .NET Framework 4.0？

您的应用程序是否依赖任何未包含在已部署应用程序中的外部库？

你能调试你的应用程序吗？即Application_Start。在导致这种情况的过程中，有可能出现了问题。

基本上，更多信息会有所帮助！

# php - 快速启动相同脚本两次时从php脚本执行mysql查询的执行顺序

> ID：10788356
> 
> 赞同：0
> 
> 时间：2012-05-28T17:24:47.710
> 
> 标签：php, mysql, pdo

我有一个执行 mysql pdo 查询的 php 脚本。在此脚本中，对**同一个表**进行了几次读取和写入。

例如，假设有 4 个查询，一个读、写、另一个读、另一个写，每次读取需要 10 秒执行，每次写入需要 0.1 秒执行。

`nohup php execute_queries.php &`如果我在 1/100 秒内从 cli 执行此脚本两次，查询的执行顺序是什么？

脚本第一个实例的所有查询是否需要在第二个实例的查询开始运行之前完成，或者两个实例的第一次读取是否会在表被写入锁定之前开始和完成？

注意：假设我正在使用 myisam 并且写入是对记录的更新（IE，整个表在写入期间被锁定。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:00:26.980

由于您没有使用事务，所以不，不会等待一个脚本中的所有查询完成，因此查询可能会重叠。

有一个称为并发编程的整个研究领域可以教授这一点。

在数据库中，它与事务、隔离级别和数据锁有关。

典型（简单）竞争条件：

```
$visits = $pdo->query('SELECT visits FROM articles WHERE id = 44')->fetch()[0]['visits'];
/*
 * do some time-consuming thing here
 *
 */
$visits++;
$pdo->exec('UPDATE articles SET visits = '.$visits.' WHERE id = 44'); 
```

*如果 2 个 PHP 进程一个接一个地从数据库中读取访问*，并且假设访问的初始值为 6，则上述**竞争条件**很容易变坏，并且两者都将其增加到 7，并且都将 7 写回数据库甚至尽管期望的效果是 2 次访问将值增加 2（*访问*的最终值应该是 8）。

 **解决这个问题的方法是使用原子操作（因为操作很简单，可以简化为一个单一的原子操作）。

```
UPDATE articles SET visits = visits+1 WHERE id = 44; 
```

数据库引擎保证原子操作不会被其他进程/线程中断。通常数据库必须对传入的更新进行排队，以便它们不会相互影响。排队显然会减慢速度，因为每个进程都必须等待它之前的所有进程，直到它有机会被执行。

在一个不太简单的操作中，我们需要多个语句：

```
SELECT @visits := visits FROM articles WHERE ID = 44;
SET @visits = @visits+1;
UPDATE articles SET visits = @visits WHERE ID = 44; 
```

但同样，即使在数据库级别 3，单独的原子语句也不能保证产生原子结果。它们可以与其他操作重叠。就像 PHP 示例一样。

要解决此问题，您必须执行以下操作：

```
START TRANSACTION
    SELECT @visits := visits FROM articles WHERE ID = 44 FOR UPDATE;
    SET @visits = @visits+1;
    UPDATE articles SET visits = @visits WHERE ID = 44;
COMMIT; 
```**

# css - 是否可以在 CSS 中为 div 设置锚点？

> ID：10788357
> 
> 赞同：3
> 
> 时间：2012-05-28T17:25:00.937
> 
> 标签：css

我终于得到了这只很酷的推特小鸟，它在我的提要中显示了最新的推文。

我唯一的问题是关于实际推文的位置。由于每条推文中的字符数量不断变化，因此框会垂直扩展（高度放大），有时会使图像看起来不正常/破坏效果。

我仍然不擅长 CSS，所以我不确定我是否遗漏了一些简单的东西，但这里有两个例子来向你们说明这个概念。

**21 个字符推文测试：**

![短推文](../Images/25066a842755c6bc094205e39c2f283b.png)

**140 个字符的推文测试：**

![长推文](../Images/aaef88b7542e6ab1d9352a11e96c5eed.png)

这是我正在使用的代码（请注意，“左下” div 由外部 CSS 设置样式）：

```
<div id="lowerleft">
  <div id="twitterbutton" style="z-index:100;padding-left:50px;padding-top:75px">
    <div class="tri"style="width:160px;"id=”twitter_update_list”&gt;
      <div id="twitter_div">Latest Tweet:</div>
        <br />
        This is a test. TEST.
    </div>
  </div>
</div> 
```

**如果我没有准确地解释自己，让我最后一次尝试：**

> 无论如何要在css中设置一个锚点以确保我的div不会垂直地向y轴上的负方向增长，而是让它在y轴的正方向上垂直向上扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:42:51.327

You can absolutely position it and give it a `bottom` anchor point. This way, as you add content to it it'll expand upwards instead of downwards.

How exactly you apply absolute positioning depends on your structure, but it shouldn't be difficult.

# api - 如何在 Hotmail 中查询新邮件

> ID：10788359
> 
> 赞同：0
> 
> 时间：2012-05-28T17:25:03.977
> 
> 标签：api, email, hotmail

我正在寻找最好的方法来检查新电子邮件是否已到达 Hotmail 帐户，而无需访问 Web 界面或使用邮件客户端。

我找不到任何 Hotmail 邮件 API 并查看 Firefox 插件，似乎通过正常登录过程查询站点然后搜索 HTML 源是要走的路。

有什么建议可以考虑到安全性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:29:26.907

您在寻找 API 或插件吗？

如果 API - 看起来他们没有任何邮件 API，他们只有联系人和日历的 API。

但是您可以使用 SMTP 或 POP3 来获取它。

编辑

可以在[此处](http://msdn.microsoft.com/en-us/library/live/hh826535)找到 API 的链接。

# xcode - Xcode 发送短信

> ID：10788362
> 
> 赞同：0
> 
> 时间：2012-05-28T17:25:10.413
> 
> 标签：xcode, sms

在我的应用程序中，我希望能够发送短信。因此，当您按下一个按钮时，它会带您进入消息传递区域并自动输入一个数字和一条消息......如果是这样，您能否提供有关如何执行此操作的源代码示例？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:28:37.687

看看[MFMessageComposeViewController](http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html) - 它提供了您需要的功能，并且非常简单，只需手头的参考即可使用

# web-applications - 为最终用户对 Web 应用程序进行版本控制的一些一般策略是什么？

> ID：10788363
> 
> 赞同：4
> 
> 时间：2012-05-28T17:25:19.703
> 
> 标签：web-applications, backbone.js, versioning, backbone-routing

我正在编写一个网络应用程序，并且想知道未来的升级以及升级网络应用程序将如何影响用户体验。

特别是，我想知道像谷歌这样的公司是如何解决这个问题的。例如，我见过几个示例，其中特定的谷歌应用程序会询问用户是否要升级到“新的谷歌文档”或类似的。这是我想提供的经验，但我不知道如何去做。如果重要的话，我正在编写一个使用backbone.js 并且有一个沉重的JS 客户端组件的应用程序。我看过一些讨论版本控制 REST 组件或 WebServices 组件，但没有一个讨论实际的客户端代码或后端组件（当然，如果后端都在版本化的 Web 服务之后，它可能无关紧要）

从应用程序的角度和（可能）后端数据库的角度来看，我对他们如何实现这一点很感兴趣。

所以看起来有几个问题。

*   版本控制的应用程序位于 Web 根目录的哪个位置
*   您如何为不同的用户提供多个版本
*   您如何对后端数据存储进行版本控制
*   由于我使用的是骨干网，因此我对为此类应用程序设计路由器特别感兴趣。如果各种版本存在于子目录中，我如何创建合适的路由器？

可能还有其他一些考虑因素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T13:07:46.640

这很快就会变得复杂，尤其是在 Google Docs 中进行协作时，您希望文档的不同版本相互兼容。因此，您可以决定在每个主要版本之前不更改您的数据库，然后将每个人转移到您的应用程序的新版本，或者制作可以将您的数据从一个版本转换为另一个版本（和向后）并保持同步不同的数据库，同时接受来自不同“应用程序”版本的数据。

“最简单”的管理方法是使用事件日志，甚至进入 CQRS 之类的东西，这些模式使以这种方式思考数据更易于管理。

但在实施这样的事情之前，我会三思而后行。你真的需要它吗？（巨大的？）成本是否与（微小的？）收益相匹配？在这个阶段你需要它吗？

# c# - 如何在 C#/.net 中动态读取 XML 数据？

> ID：10788366
> 
> 赞同：0
> 
> 时间：2012-05-28T17:25:36.913
> 
> 标签：c#, .net, xml

如何动态读取 XML 数据？如何尽可能通用和动态地管理我的 C# 代码？根据要求，我需要在 Xml 中添加更多文件夹路径，这不应该以必须重写的方式影响编写的代码。

给定一段 XML 作为示例：

```
<?xml version="1.0" standalone="yes"?>
  <HOSTS>
   <Host id = '1'>
     <Extension>txt</Extension>
     <FolderPath>C:/temp</FolderPath>
   </Host>
   <Host id = '2'>
     <Extension>rar</Extension>
     <FolderPath>C:/Sample</FolderPath>
   </Host>
 </HOSTS> 
```

如何动态读取主机 ID？我有什么可能性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T17:31:00.737

是的 - 实际上这是 C# 中非常常见的任务。

有几种方法可以解决这个问题：

*   使用诸如[XPath](http://support.microsoft.com/kb/308333)之类的库来读取 XML 值
*   [将 XML 反序列](https://stackoverflow.com/questions/226599/deserializing-xml-to-objects-in-c-sharp)化为对象
*   加载到[XMLDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)对象中
*   [LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387098.aspx)（推荐）

这些链接应该为您指明正确的方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T17:35:20.870

使用 LINQ to XML。

示例：使用 (id = 1) 检索主机：

```
string id = "1"

XDocument doc = XDocument.Load("data.xml");
var accounts = from elements in doc.Elements("HOSTS").Elements("Host")
                where elements.Attribute("id").Value = id
                    select elements.FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:32:13.873

从该示例 xml 生成 xsd 方案。根据需要对其进行修改，然后使用[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.100%29.aspx)生成强类型 C# 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T17:28:00.140

您最好的选择是将[System.Xml.XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)类与[System.Xml.XmlDocument.Load(...)](http://msdn.microsoft.com/en-us/library/w009fhk7)一起用于构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T19:20:26.067

对于这种情况，最好的方法（我认为）是对强类型类使用 XML 序列化。您可以使用[Attributes](http://msdn.microsoft.com/en-us/library/2baksw0z%28v=vs.100%29)控制过程。

```
var serializer = new XmlSerializer(typeof(Hosts));
var hosts = (Hosts)serializer.Deserialize(new StringReader(str)); 
```

...

```
[XmlRoot("HOSTS")]
public class Hosts : List<Host> {}

public class Host {
    [XmlAttribute("id")]
    public int Id { get; set; }

    public string Extension { get; set; }

    public string FolderPath { get; set; }
} 
```

# c# - 当 Java 程序调用 C# 程序写入 %ProgramData% 时失去管理员权限

> ID：10788368
> 
> 赞同：1
> 
> 时间：2012-05-28T17:25:55.057
> 
> 标签：c#, java, windows-7, admin, shortcut

**场景：**

1.  我有一个基于 Java 的安装程序。
2.  基于 Java 的安装程序调用 C# 程序，其工作是创建快捷方式。
3.  快捷方式的位置取决于安装程序是以管理员身份运行还是以普通用户身份运行。以管理员身份运行时，我正在尝试创建“%ALLUSERSPROFILE%\Desktop”的快捷方式，否则我将写入“%USERPROFILE%\Desktop”。

*我的印象是，当我的 Java 程序调用我的 C# 快捷方式制作程序时，问题似乎是失去了管理权限。*

**笔记：**

1.  我以管理员身份运行基于 Java 的安装程序（右键单击，以管理员身份运行）。
2.  我能够验证安装程序是否以管理员权限运行，因为我可以读取需要管理权限的注册表项。
3.  我正在通过“Process process = Runtime.getRuntime().exec(command);”调用我的 C# 程序
4.  通过管理命令提示符手动运行命令时，该命令可以正常工作。（输出到“%ALLUSERSPROFILE%\Desktop”时）
5.  从正常的命令提示符手动运行相同的命令时，我得到 System.UnauthorizedAccessException。（这是意料之中的）。程序崩溃的方式与从安装程序运行时类似。

**例外：**

> 未处理的异常：System.UnauthorizedAccessException：访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）在 IWshRuntimeLibrary.IWshShortcut.Save()

对我所缺少的有什么想法吗？安装程序需要灵活地以普通用户和管理员身份运行。我怎样才能确保这种行为？

## 更新 1

我在运行时将调试器附加到 C# 程序。它正在抛出：

```
DirectoryNoFoundException was unhandled 
The system cannot find the path specified. (Exception from HRESULT: 0x80070003) 
```

我在快捷方式制作命令之前添加了“mkdir”命令。mkdir 命令，只是在尝试写入目录之前确保目录存在。

重建安装程序，运行它，当尝试**mkdir "%ALLUSERSPROFILE%\Desktop"**时，java 抛出异常

```
java.io.IOException: Cannot run program "mkdir": CreateProcess error=2, The system cannot find the file specified
java.io.IOException: Cannot run program "mkdir": CreateProcess error=2, The system cannot find the file specified
        at java.lang.ProcessBuilder.start(Unknown Source)
        at java.lang.Runtime.exec(Unknown Source)
        at java.lang.Runtime.exec(Unknown Source)
        at java.lang.Runtime.exec(Unknown Source) 
```

此时，我的进程似乎没有获得管理员访问权限

```
 Process process = Runtime.getRuntime().exec(command); 
```

我去看看能不能找到别的东西。

## 更新 2

以下给了我一些我尝试过的信息：[Enterprise Logging not translate environment variables in XML Trace Listener fileName specification](https://stackoverflow.com/questions/9099994/enterprise-logging-not-translating-environment-variables-in-xml-trace-listener-f)

它表明 %ALLUSERSPROFILE% 没有被翻译。

我通过以下方式获得了环境变量值，而不是 %ALLUSERSPROFILE%：

```
 String allUsersProfile = System.getenv("ALLUSERSPROFILE");
    String userProfile = System.getenv("USERPROFILE"); 
```

然后，我能够将实际值提供给 C# 程序。但我仍然有问题。

从管理控制台我可以导航到“c:\ProgramData\Start Menu”，但是如果我以管理权限运行“explorer”，我可以导航到“c:\ProgramData”但看不到任何过去的东西......通过一些看，我发现“c:\ProgramData\Start Menu”是一个受保护的操作系统文件。所以我打开设置来查看它。所以现在我可以看到它，但不能进入它。

使用系统内部，我将 explorer.exe 提升为“系统”访问权限，但仍然无法进入文件夹（系统内部提升参考：http: [//verbalprocessor.com/2007/12/05/running-a-cmd-提示为本地系统/](http://verbalprocessor.com/2007/12/05/running-a-cmd-prompt-as-local-system/)）

我右键单击该文件夹并检查了安全选项卡。看起来即使是我的“系统”用户的访问权限也是有限的。我觉得这有点莫名其妙，我可以从管理命令提示符运行该命令，该命令会将快捷方式写入桌面，但是通过这个其他过程我不能......我也发现访问有点不一致。

# rest - WSO2 ESP 代理 REST 服务，具有动态参数

> ID：10788370
> 
> 赞同：0
> 
> 时间：2012-05-28T17:25:58.397
> 
> 标签：rest, wso2, wso2esb, esb

我在 wso2 示例中使用了示例 152 来代理远程 REST 服务。我找不到有关如何将传入的肥皂请求映射到 uri 的参数的任何信息，以便我们可以使用其余服务。

即我希望传入的soap 请求能够将accessid=DEMO 的值更改为accessid=FOO。

我可以很容易地编写一个 java 客户端并将其公开为 Axis2 代理，但这并不是真正使用 wso2 esb .. 感谢任何指针。

```
<definitions xmlns="http://ws.apache.org/ns/synapse">
    <proxy name="QProxy" statistics="disable" trace="disable" transports="https">
        <target>
            <endpoint>
                <address format="pox" statistics="disable"
                    trace="disable" uri="[SERVER]qml_rest.ReceiveMessage?accessid=DEMO">
                    <timeout>
                        <duration>0</duration>
                        <action>discard</action>
                    </timeout>
                    <markForSuspension>
                        <retriesBeforeSuspension>0</retriesBeforeSuspension>
                        <retryDelay>0</retryDelay>
                    </markForSuspension>
                    <suspendOnFailure>
                        <initialDuration>0</initialDuration>
                        <maximumDuration>0</maximumDuration>
                        <progressionFactor>1.0</progressionFactor>
                    </suspendOnFailure>
                </address>
            </endpoint>
            <outSequence>
                <send/>
            </outSequence>
        </target>
    </proxy>
</definitions> 
```

# javascript - 使用 getTime() 使用 Javascript 初始化重复操作

> ID：10788371
> 
> 赞同：0
> 
> 时间：2012-05-28T17:26:00.860
> 
> 标签：javascript, date, onload-event, gettime

我是开发新手，所以这可能是一个愚蠢的问题，但我想我还是会问。毕竟，我看起来不好只会让你看起来更好。:)

我想根据时间更改元素的 css 样式。我已经尝试了几种不同的方法，并且可以获得在 html 中显示的时间，但我不能使用时间来触发其他事件。我把这个小页面放在一起，让事情对我来说更简单。

```
 <html>
 <head>
 <title>timerTest</title>
 <style type="text/css">

 #box {
    height:200px;
    width: 200px;
    background-color: red;
 }

 </style>
 </head>

 <body onload="maFucktion()">
   <div id="box">T</div>
   <script type="text/javascript">

     var box = document.getElementById('box');

     function maFucktion()
     {

       var d = new Date();

       for(i=0; i > 100; ++i)
       {
          if((d.getTime() % 1000) < 499)
        {
        box.style.backgroundColor = "blue";
        box.innerHTML = d.getTime() % 1000;
        }
      else
        {
        box.style.backgroundColor = "red";
        box.innerHTML = d.getTime() % 1000;
        }
      }
 }
 </script>
 </body>
 </html> 
```

所以，我的小脑袋告诉我这应该做的是，在页面加载时，执行 maFucktion() ，它应该启动一个 for 循环，它：

(1) 设置一个新的 Date() (2) 使用 getTime() 方法获取自 1970 年 1 月 1 日以来的时间，以毫秒为单位 (3) 使用模运算符将其分解为半秒 (4) 并提供新的背景颜色以及基于值是否在 0-499 之间或其他条件的除法余数

我希望它每半秒更改一次 box.style.backgroundColor ，这最终应该看起来像 1998 年那些愚蠢的横幅广告之一，但我无法让它自动更改。

我知道 for 循环可能不是最好的，但它至少应该为#box 显示一个新的 innerHTML 值，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:33:21.403

您需要在将来的某个时间使用`setTimeout()`或触发一个动作。`setInterval()`有关文档，请参见[此处](https://developer.mozilla.org/en/DOM/window.setTimeout)和[此处](https://developer.mozilla.org/en/DOM/window.setInterval)。

循环和检查时间在 javascript 中非常非常糟糕，因为它锁定了浏览器处理用户事件。

因此，要每半秒更改一次背景颜色，您可以这样做：

```
var isBlue = false;
var box = document.getElementById('box');
setInterval(function() {
    box.style.backgroundColor = isBlue ? "red" : "blue";
    isBlue = !isBlue;
}, 500); 
```

你可以在这里看到一个工作演示：http: [//jsfiddle.net/jfriend00/n5Mhz/](http://jsfiddle.net/jfriend00/n5Mhz/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:38:21.027

您在这里真正想做的是使用计时器。让计时器每 1/2 秒调用一次函数：

```
<script type="text/javascript">

var box = document.getElementById('box');
var clrs = "#ff0000,#0000ff".split(",")
var cPos = 0;    
function flipC() {    
   box.style.backgroundColor = clrs[cPos];
   cPos = 1-cPos;
   window.setTimeout(flipC,500)    
}
flipC()

</script> 
```

# ruby-on-rails - 如何在关联的 Rails 应用程序中组织 2 个资源

> ID：10788377
> 
> 赞同：0
> 
> 时间：2012-05-28T17:26:37.053
> 
> 标签：ruby-on-rails, information-architecture

我正在计划一个用于教学的新 Rails 应用程序。每节课都属于一个轨道（例如一级）。所以每首曲目都有很多课。

但是每节课都应该在每首曲目中有一个课号。什么是按顺序呈现课程的好方法（例如第 4 课，第 2 课）。

我不确定如何在曲目中分配课程编号并按顺序排列。如果不必将它们组织成轨道，那么我可以使用 created_at 将它们按顺序排列。

课程编号是创建课程的用户在创建或更新课程时需要手动分配的吗？

有人对这样做的好方法有意见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:59:24.123

`position`如果您希望您的用户可以控制课程/曲目编号是什么，而不是仅按创建日期按顺序排列它们，我将在课程/曲目表中添加一个额外的列，例如（或类似的）。

您可以通过为课程创建者提供一个输入课程编号的字段或某种可用于组织订单的 UI 可排序界面来做到这一点。在显示课程/曲目时，您可能希望按`position`字段排序。

# python - python defaultdict: 0 vs. int 和 [] vs list

> ID：10788378
> 
> 赞同：45
> 
> 时间：2012-05-28T17:26:39.210
> 
> 标签：python, collections, defaultdict

`int`传递和`lambda: 0`作为参数之间有什么区别吗？还是介于`list`和之间`lambda: []`？

看起来他们做同样的事情：

```
from collections import defaultdict
dint1 = defaultdict(lambda: 0)
dint2 = defaultdict(int)
dlist1 = defaultdict(lambda: [])
dlist2 = defaultdict(list)

for ch in 'abracadabra':
    dint1[ch] += 1
    dint2[ch] += 1
    dlist1[ch].append(1)
    dlist2[ch].append(1)

print dint1.items()
print dint2.items()
print dlist1.items()
print dlist2.items()
## -- Output: --
[('a', 5), ('r', 2), ('b', 2), ('c', 1), ('d', 1)]
[('a', 5), ('r', 2), ('b', 2), ('c', 1), ('d', 1)]
[('a', [1, 1, 1, 1, 1]), ('r', [1, 1]), ('b', [1, 1]), ('c', [1]), ('d', [1])]
[('a', [1, 1, 1, 1, 1]), ('r', [1, 1]), ('b', [1, 1]), ('c', [1]), ('d', [1])] 
```

但是在任何情况下它们会有不同的行为，还是仅仅是符号上的差异？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-28T17:35:04.887

所`defaultdict`需要的只是一个可调用对象，该对象将在不带参数调用时返回应用作默认值的值。

如果你要调用`int`构造函数，它会返回`0`，如果你要调用`lambda: 0`，它会返回`0`。与列表相同。这里唯一的区别是构造函数将始终使用它的逻辑来创建对象。一个 lambda，如果您选择这样做，您可以添加额外的逻辑。

例如，

```
# alternating between `0` and `[]`
from itertools import count
factory = lambda c=count(): 0 if next(c) % 2 else []
superdict = defaultdict(factory) 
```

# python - Pinax 结构

> ID：10788385
> 
> 赞同：0
> 
> 时间：2012-05-28T17:27:28.037
> 
> 标签：python, pinax

我刚刚安装了 Pinax，但我现在很困惑。

在我的结构中

我有两个目录

mysite 和 mysite-env

我不知道为什么我有两个目录。我只是按照安装说明

在我的网站上，

```
<project-root>
    apps/
        __init__.py
    deploy/
        __init__.py
        fcgi.py
        wsgi.py
    fixtures/
        initial_data.json
    locale/
        ...
    requirements/
        base.txt
        project.txt
    sitemedia/static // I move static file from mysite-env to here
        ...
    templates/
        _footer.html
        homepage.html
        site_base.html
    __init__.py
    manage.py
    settings.py
    urls.py 
```

然而，

默认索引页面在`mysite-env/lib/python2.6/site-packages/pinax_theme_bootstrap/templates/banner_base.html`

我应该从 mysite 管理我的网站吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:46:05.477

[Pinax 使用 virtualenv](http://pinax.readthedocs.org/en/latest/gettingstarted.html#installation)来防止您的项目依赖项弄乱您的本地 python 库。

所以，用`$ source mysite-env/bin/activate`它启动网站就可以了。如果你真的讨厌`mysite-env`，就[跳过](http://pinax.readthedocs.org/en/latest/gettingstarted.html#creating-a-project)virtualenv 部分。

# php - php字符串替换问题

> ID：10788386
> 
> 赞同：1
> 
> 时间：2012-05-28T17:27:35.023
> 
> 标签：php

我有一些文字：

> 回复：改变锅水它你的锅。请回复此文。如果您回复此文本，您将获得一些钱。请回复

所以我想`Reply`用`Hi`. 不是另一个`Reply`文本。

我知道我可以`str_replace()`用 php 函数来做到这一点。但它将所有`Reply`文本替换为`Hi`. 但我需要替换第一个`Reply`文本。

我如何用 php 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:34:05.313

的第 4^个参数[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)是要完成的最大替换。将其设置为 1。

```
$str = preg_replace('/reply/i', 'Hi', $str, 1); 
```

# android - Android dbAdapter 自定义查询

> ID：10788388
> 
> 赞同：0
> 
> 时间：2012-05-28T17:27:52.093
> 
> 标签：android, sqlite

我正在使用记事本示例来定义 DBAdapter 的类。

我的表结构的一个例子：

```
Vehicle -> "_id", "registration", "idmake", "model"
Make -> "_id", "name" 
```

目前我正在使用查询来获取车辆数据并填充 ListView：

```
public Cursor fetchVehicles() {

    return mDb.query("Vehicle", new String[] { "_id", "registration",
            "idmake", "model" }, null, null, null, null, null);
} 
```

我的问题是，除了返回相应的 Make 名称而不是 idmake 字段之外，我该如何进行这样的查询？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:32:31.657

你应该`JOIN`这两个表。

```
String SELECT_NAME = "SELECT M.name FROM Make M INNER JOIN Vehicle V ON M._id = V._id";
cursor.rawQuery(SELECT_NAME, null); 
```

方法中的第二个参数`rawQuery`需要`where args`这样你就可以这样做：

```
String ANOTHER_SELECT = "SELECT M.name FROM Make M INNER JOIN Vehicle V ON M._id = V._id WHERE M._id = ?";
cursor.rawQuery(ANOTHER_SELECT, new String[] {String.valueOf(<dataId>)}); 
```

[关于rawQuery 方法](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)的一点点

问候

# c++ - 如何使用 getElementByTagName 仅获取子节点列表？

> ID：10788394
> 
> 赞同：0
> 
> 时间：2012-05-28T17:28:16.470
> 
> 标签：c++, xml, dom, xml-parsing, xerces

我有这个 XML 文件，我想从中提取我的消息子字段

```
<message name="IOI" >
<field number="23" name="IOIID" type="STRING" required="Y" /> 
<field number="28" name="IOITransType" type="CHAR" required="Y" >
    <value enum="C" description="CANCEL" /> 
    <value enum="N" description="NEW" /> 
    <value enum="R" description="REPLACE" /> 
</field>
<field number="26" name="IOIRefID" type="STRING" required="N" /> 
<component name="SecAltIDGrp" required="N" > 
    <field number="454" name="NoSecurityAltID" type="NUMINGROUP" required="N" >
        <field number="455" name="SecurityAltID" type="STRING" required="N" /> 
        <field number="456" name="SecurityAltIDSource" type="STRING" required="N" /> 
        </field>    
</component> 
```

所以我使用了 getElementsByTagName() 但它给了我所有的孩子和他们的孩子，所以我怎么能只得到我的消息字段而没有我的字段字段？

```
DOMNodeList* fieldsNodeList = MessageElement->getElementsByTagName(xmlStrVar); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T02:47:39.027

Xerces C++ 提供[部分 XPath 实现](http://xerces.apache.org/xerces-c/faq-parse-3.html#faq-2)。这是一个[关于它的更多细节的问题](https://stackoverflow.com/questions/1106065/xpath-support-in-xerces-c)。话虽如此，根据您使用的 Xerces C++ 版本，您应该能够运行简单的 XPath 表达式，例如`/message/field`.

另一种选择是继续使用 DOM API，只使用`getChildNodes()`可用于[`DOMNode`](http://xerces.apache.org/xerces-c/apiDocs-2/classDOMNode.html)查找`field`元素的子节点进行迭代。

最后但并非最不重要的一点是，如果您喜欢 XPath 理念但您的 Xerces C++ 版本不符合要求，请考虑走出您的“舒适区”并查看[Xalan C++](http://xml.apache.org/xalan-c/)或[libxml2](http://xmlsoft.org/)。两者都应该有完整的[XPath 1.0](http://www.w3.org/TR/xpath/)支持。

# php - PHP中的反斜杠——它是什么意思？

> ID：10788400
> 
> 赞同：39
> 
> 时间：2012-05-28T17:28:45.677
> 
> 标签：php

我刚刚看到在对 PHP 对象的引用中使用了反斜杠，并对它感到好奇（我以前从未见过这种情况）。这是什么意思？

```
$mail = new SendGrid\Mail(); 
```

如果你好奇，这里是[SendGrid 的文档](http://docs.sendgrid.com/documentation/get-started/integrate/examples/php-email-example-using-smtp/)。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-28T17:30:20.277

这是因为他们使用的是[PHP 命名空间](http://php.net/language.namespaces)。自 PHP 5.3 起，命名空间是新的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-28T17:30:32.150

这是 PHP 的命名空间运算符：[http://php.net/manual/en/language.namespaces.php](http://php.net/manual/en/language.namespaces.php)。

不要问为什么是反斜杠。这是（恕我直言）他们可能做出的最愚蠢的选择，他们的决定基于高度倾斜/偏执的评分系统，只有开发人员才有意义。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-28T17:31:01.200

这是命名空间的语法。[您可以在PHP 文档](http://www.php.net/manual/en/language.namespaces.php)中阅读有关名称空间的更多信息。他们至少需要 PHP 5.3。

例如：

```
namespace SendGrid;
function Mail() {
    // You can access this function by using SendGrid\Mail() externally
} 
```

# android - 从原始文件夹中获取随机声音文件 - Android - MediaPlayer

> ID：10788402
> 
> 赞同：0
> 
> 时间：2012-05-28T17:29:07.550
> 
> 标签：android, audio, resources, path, media-player

我想：

1.  生成一个随机数（很简单）
2.  取那个随机数并将其添加到某种动态路径中
3.  在媒体播放器创建中使用动态路径。

例如

资源文件夹（原始）包含 1.mp3 2.mp3 3.mp3

随机数生成 0 到 4 之间的数字

例如：2

将随机数插入路径

例如字符串？

```
String PATH = "R.raw." + RANDOM-NUMBER

MediaPlayer mp = MediaPlayer.create(context, PATH); 
```

但是，当然 MediaPlayer 使用 URI 变量而不是字符串，我确实尝试过

```
myUri = Uri.parse("R.raw.2"); 
```

但得到一个 nullPointerException

我想这是非常简单/直截了当的回答，而我的知识只是逃避了我

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:35:05.517

你不能用资源做到这一点。我认为你会这样做。

```
int randomInt = generateRandomInt(), id;
switch (randomInt) {
case 1:
    id = R.raw.1;
    break;
case 2:
    id = R.raw.2;
    break;
...
}
setDataFromResource(getResources(), myMediaPlayer, id); 
```

AFAIK，您必须使用 setDataFromResource 从 R.raw 为您的媒体播放器设置数据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:25:00.113

我个人会这样做：

```
 //initializing the sounds
    final MediaPlayer sound1 = MediaPlayer.create(this, R.raw.1);
    final MediaPlayer sound2 = MediaPlayer.create(this, R.raw.2);
    final MediaPlayer sound3 = MediaPlayer.create(this, R.raw.3);

    //generate random number
    Random randomGenerator = new Random();
    int randomInt = randomGenerator.nextInt(3) + 1;

    //picking the right sound to play
    switch (randomInt){
    case 1: sound1.start();
    break;
    case 2: sound2.start();
    break;
    case 3: sound3.start();
    break;
    } 
```

# tomcat6 - Tomcat 6 通过 URL 限制对 Web 应用程序的访问

> ID：10788406
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:29:27.253
> 
> 标签：tomcat6, security

我有安装了一堆应用程序的 Apache Tomcat 6.0.35(Wndows 2008)。我已删除 webapps\ROOT*，将我的应用程序重命名为 ROOT.war，已部署，现在我将我的应用程序作为 root（应用程序中使用了以下 URL - http://exampleapp.com/、http:/exampleapp.com /SomePostUri)。端口 8080 更改为 80。

如何禁止访问（通过 HTTP）以下应用程序：

1) Tomcat 的管理器应用程序 (http:/exampleapp.com/manager/html) - 只允许从本地主机访问。

2) 所有其他人安装的 Web 应用程序（例如 http:/exampleapp.com/docs） - 只允许从 localhost 访问。

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:51:23.770

我安装了 Apache HTTP 并通过 mod_jk 将它与 Tomcat 连接起来。解决了。

# php - phpMyEdit 登录失败？

> ID：10788407
> 
> 赞同：1
> 
> 时间：2012-05-28T17:29:51.580
> 
> 标签：php, mysql

我最近下载了 phpMyEdit，它是一个用于创建/编辑 MySQL 数据库表和字段的 GUI 脚本。

我将脚本上传到我的服务器。我阅读了安装文档，它不需要向任何文件添加任何内容...只需在浏览器中打开 phpMyEditSetup.php 并添加我的数据库主机名、用户名和密码。问题是，当我输入信息并单击提交时，我收到一条错误消息，提示“登录失败 - 重试”。

我在 2 个不同的主机上尝试过，但它不起作用。我很确定我提供的数据库用户名、密码和主机名是正确的。

有没有人以前遇到过这个问题并找到了解决方案？如果是这样，你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:15:27.563

以下是一些可以尝试的事情：

1.  [phpMyEdit 安装文档](http://opensource.platon.sk/projects/doc.php/phpMyEdit/html/installation.html)-***重要提示：****在将程序文件上传到您的服务器之前，请确保您的 FTP 客户端未配置为强制文件名使用小写字母。*

2.  你在使用 phpMyAdmin 吗？如果是这样，您可以使用它来帮助确保您的连接具有正确的主机名和用户名。**例子：** ![phpMyAdmin 示例](../Images/e5ea03bed56e0c6c10c7d10e94d02cbd.png)

3.  您还可以使用 phpMyAdmin 查看您的 Web 服务器的规格，并确保它们符合[phpMyEdit 的要求](http://opensource.platon.sk/projects/doc.php/phpMyEdit/html/introduction.requirements.html)。

4.  确保您已阅读[phpMyEdit 文档](http://opensource.platon.sk/projects/doc.php/phpMyEdit/html/index.html)

5.  最后，如果一切都失败了，请联系您的托管服务提供商或 Web 服务器管理员以检索您的数据库主机名、用户名，并可能让他们重置您的数据库密码。此外，与他们讨论[phpMyEdit 的要求，](http://opensource.platon.sk/projects/doc.php/phpMyEdit/html/introduction.requirements.html)以确保您的 Web 服务器符合要求。

# javascript - 像 Python 一样的 NodeJS 字符串格式？

> ID：10788408
> 
> 赞同：12
> 
> 时间：2012-05-28T17:29:52.697
> 
> 标签：javascript, python, node.js, v8

在 python 中，我可以执行以下操作：

```
name = "bob"

print("Hey, %s!" % name) 
```

`.format()`JavaScript/NodeJS 中是否有类似的东西（或 Python 的）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-08-21T17:10:26.717

You can use [util.format](https://nodejs.org/api/util.html#util_util_format_format_args), it's `printf` like function.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-12-07T09:22:13.680

另一种选择是[模板字符串](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/template_strings)

例如：

```
const name = "bob";
console.log(`Hey, ${name}!`); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:35:47.923

[我认为sprintf](http://www.diveintojavascript.com/projects/javascript-sprintf)应该做你所要求的。

# mysql - 当值中有特殊字符时，卡在获取不同的记录

> ID：10788409
> 
> 赞同：1
> 
> 时间：2012-05-28T17:29:53.170
> 
> 标签：mysql, database

我有下表数据

```
London

Egypt

Newyork

Egypt*

India

China

London+

NewYork*+ 
```

当我使用以下查询`select distinct CityName from cityTable`时，我得到 8 条记录，但我预计只有 5 条记录，分别是伦敦、埃及、纽约、印度和中国。但是在上面的埃及*和纽约*+ 不应该添加到结果集中，但 distinct 被认为是不同的记录，任何人都可以帮助我获得所需的结果。

我正在使用 Mysql 数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:23:59.997

使用 MySQL group by 语句

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:54:46.593

您可以使用此[udf](https://launchpad.net/mysql-udf-regexp)并替换非字母数字字符。这将使您只剩下没有特殊字符的城市名称。然后您可以在上面得到不同。

# java - 通过质询/响应来保护会话的每个请求？

> ID：10788411
> 
> 赞同：5
> 
> 时间：2012-05-28T17:30:09.983
> 
> 标签：java, php, security, web-applications

我们需要设计一个安全的 Web 应用程序。我想提出一种会话处理机制，它对每个请求进行质询响应，而不仅仅是在使用[CRAM](http://en.wikipedia.org/wiki/Challenge-response_authentication)方法登录的过程中。

原因是加强 Web 应用程序以防止会话劫持（例如通过[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)）和重放或中间人攻击。

在某些地方建议使用[nonce](http://en.wikipedia.org/wiki/Cryptographic_nonce)，但在我们的 webapp 中这似乎不切实际，因为异步请求可以继续，或者用户可以打开新窗口，点击后退按钮等。

想法：客户端和服务器有一个共享的秘密（先前建立的用户密码），每个后续请求都会基于该秘密再次进行质询/响应，例如'response = hash(challenge + hashedPassword)'。仅当对质询的响应匹配时，服务器才会执行请求。就像在 CRAM 期间一样，但对每个请求都持续进行。

问题：这是一个可行的想法吗？如果是这样，它肯定已经实施，甚至是某种标准？我们将如何在基于 java 或 php 的 webapp 中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T12:45:52.330

问题实际上归结为您想要实现的目标。如果你想对抗 CSRF 攻击，除了会话密钥之外的秘密令牌是你的方法。但是，在每个请求中更改令牌会导致问题 - 不仅后退按钮会终止会话，而且由于一个网页通常包含大量异步和并行加载的数据（图像、css、javascript 等），因此您的方法之后将不会加载任何其他数据，因为每个额外的请求都会更改所需的令牌，从而终止会话。

您可以通过 BASE64 和其他技巧将所有资源嵌入到页面中来解决此问题，但这会严重阻碍您的可能性，并且可能与某些浏览器存在兼容性问题。

因此，最终，您的方法不会增加太多安全性，但很可能会给您的客户带来一整套潜在问题。我会在 URL 中的每个会话中使用一个秘密令牌来对抗 CSRF，并专注于保护其他攻击，例如 XSS 和用户友好的安全措施，例如使用智能手机或类似的东西进行双因素身份验证。毕竟，用户是当今排名第一的攻击媒介。

* * *

**更新 (2012-06-14)**

该令牌不会对抗 XSS 攻击，但它会防御基本的 CSRF 攻击（例如，通过在图像中植入虚假的 url 调用）。实际上，我今天在工作中遇到了一种情况，我需要保护一个 get-request 以防止用户修改并[编写一些代码](https://github.com/derLars/AuthenticationToken)。该代码还可用于保护静态、会话超时`form`和`link`令牌（解决您的问题）。

这个想法是有一个服务器机密，用于在数据上生成哈希/AuthToken以保护。如果流氓 javascript 尝试更改任何给定数据，则 AuthToken 将不匹配。在我的具体问题中，我有一台服务器对用户进行身份验证，并且必须将他的信息发送给第三方（用户名、邮件地址、姓名等）。此 GET-Request 可能会在身份验证后被任何用户轻松更改，因此我必须对 GET-Request-Parameters 进行身份验证。通过重新运行 AuthenticationToken-Process，第三​​方可以比较生成的 AuthToken，从而验证传入的数据。如果没有共享的秘密，就（几乎）不可能伪造数据。

关于您的问题：在 GET 和 POST 请求上使用静态令牌（或像我的项目一样的动态令牌）将保护您免受简单的 CSRF 攻击，例如通过论坛中的链接，用户必须单击才能受到攻击。由于链接永远不会包含正确的令牌，因此您的网页是安全的。但是，如果攻击者设法通过 XSS 将 javascript 加载到网页中，那么你就完蛋了，世界上没有任何技术可以帮助对付它，因为 javascript 可以扫描页面的整个 DOM 树以找到捕获任何令牌任何。

所以，归结为：

*   在 GET 和 POST 请求上使用令牌来对抗 CSRF
*   保护您的页面免受 XSS 注入

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T01:38:19.940

我发现[OWASP 备忘单](https://www.owasp.org/index.php/Cheat_Sheets)是此类设计决策的一个很好的资源：

*   [CSRF 预防备忘单](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet)
*   [XSS 预防备忘单](https://www.owasp.org/index.php/XSS_Prevention_Cheat_Sheet)

您的方案听起来类似于[HTTP 摘要身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)，但没有建立任何类型的会话后身份验证。这可能是对 HTTP Basic 的改进。这是假设两者都超过 TLS！

我不确定您的方案可能有多可行，或者它可能有多容易受到重放攻击或 MITM。

* * *

如果这是一个选项，您可以考虑使用新的`<keygen>`html5 标签，它可以帮助建立双向 TLS 会话。这将是最安全的选择..

# gwt - 从 Java 方法调用 JSNI 方法

> ID：10788413
> 
> 赞同：1
> 
> 时间：2012-05-28T17:30:19.813
> 
> 标签：gwt, jsni

我有以下代码：

```
public static void show(String value){
   Window.alert("From Java");
   invokeMethod(); //Does not get called
}  

public static native void invokeMethod() /*-{ 
    alert("From JSNI");
}-*/; 
```

我想从 Java 方法调用 JSNI 方法，但是`invokeMethod()`从来没有被调用...我找不到太多从 Java 调用 JSNI 方法的用例。

为什么上面的代码不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T09:52:21.790

首先，正如 Colin Alworth 所说，您需要将代码更改为 $wnd.alert("From JSNI"); 如果你想调用除了 alert() 之外的另一个 JS 函数，你应该在你的 html 页面中写你的函数体。您将[在此处找到所需的所有信息](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsJSNI#calling)

所以你的代码应该是这样的：

```
public static void show(String value){
   Window.alert("From Java");
   invokeMethod(); 
}  

public static native void invokeMethod() /*-{ 
    $wnd.alert("From JSNI"); //Added "$wnd."
}-*/; 
```

# facebook-graph-api - 选择 30 个随机好友并发送应用请求

> ID：10788416
> 
> 赞同：0
> 
> 时间：2012-05-28T17:30:30.090
> 
> 标签：facebook-graph-api, facebook-fql, facebook-javascript-sdk, facebook-php-sdk

**嗨，我正在尝试向用户的 30 个随机朋友发送应用请求。所以我想获取 30 个 facebook 朋友的用户 id 解析它并将 uid 输入

```
function sendRequestToRecipients() {
var user_ids = document.getElementsByName("user_ids")[0].value;
FB.ui({method: 'apprequests',
message: 'sample message',
to: 'id of friend1,id of friend2,id of friend 3,,,,,,,'
}, requestCallback);
}** 
```

以下是完整的示例代码...

```
<script>
  FB.init({
    appId  : 'appid',
    frictionlessRequests: true,
  }); 
```

我们必须把朋友的身份证放在这里.....

```
 function sendRequestToRecipients() {
    var user_ids = document.getElementsByName("user_ids")[0].value;
    FB.ui({method: 'apprequests',
      message: 'sample message',
       to: 'id of friend,id of friend'
    }, requestCallback);
  }

  function sendRequestViaMultiFriendSelector() {
    FB.ui({method: 'apprequests',
      message: 'sample message'
    }, requestCallback);
  }

  function requestCallback(response) {
    // Handle callback here
  }
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:35:24.320

```
FB.api({ method: 'friends.get' }, function(result) { 
       var user_ids="" ;
       var totalFriends = result.length;
       var randNo = Math.floor(Math.random() * totalFriends);
       var numFriends = result ? Math.min(30,totalFriends) : 0;
       if (numFriends > 0) {
          for (var i=0; i<numFriends; i++) { 
            user_ids+= (',' + result[randNo]);
            randNo ++;
            if(randNo >= totalFriends){
                randNo = 0;
            } 
          }
        }
        profilePicsDiv.innerHTML = user_ids;
    alert(user_ids);

      }); 
```

*[请参阅我在Facebook 应用邀请请求](https://stackoverflow.com/questions/10744775/facebook-app-invitation-request/10745535#10745535)*中的回答**

# c++ - 从不兼容的类型“int”分配给 [custom typdef]

> ID：10788428
> 
> 赞同：7
> 
> 时间：2012-05-28T17:31:16.847
> 
> 标签：c++, c, enums, typedef

在我的 main.c 文件的一个方法中，我声明了变量 irq_raised，它的类型为 irq_type。我在另一个文件的 typedef 中定义了 irq_type，并在 main.c 的顶部将其#import。

```
typedef enum
{
  IRQ_NONE = 0x0000,
  IRQ_VBLANK = 0x0001,
  IRQ_HBLANK = 0x0002,
  IRQ_VCOUNT = 0x0004,
  IRQ_TIMER0 = 0x0008,
  IRQ_TIMER1 = 0x0010,
  IRQ_TIMER2 = 0x0020,
  IRQ_TIMER3 = 0x0040,
  IRQ_SERIAL = 0x0080,
  IRQ_DMA0 = 0x0100,
  IRQ_DMA1 = 0x0200,
  IRQ_DMA2 = 0x0400,
  IRQ_DMA3 = 0x0800,
  IRQ_KEYPAD = 0x1000,
  IRQ_GAMEPAK = 0x2000,
} irq_type; 
```

我可以将此变量分配给其中一个，如下所示：

```
irq_raised = IRQ_NONE; 
```

但是，当我尝试执行以下操作时：

```
irq_raised |= IRQ_HBLANK; 
```

我得到错误：

```
Assigning to 'irq_type' from incompatible type 'int' 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:23:24.897

在 C++ 中，您不能在没有强制转换的情况下将 int 直接分配给枚举值。您正在执行的按位 OR 运算会生成一个 int，然后您尝试将其分配给类型为`irq_type`不进行强制转换的变量。这与您在这里遇到的问题相同：

```
irq_type irq = 0;  // error 
```

您可以改为转换结果：

```
irq_type irq = IRQ_NONE;
irq = (irq_type)(irq | IRQ_HBLANK); 
```

规范中的相关信息：

> 枚举数可以提升为整数值。但是，将整数转换为枚举数需要显式强制转换，并且未定义结果。

# python - 为什么程序不打印值？

> ID：10788430
> 
> 赞同：0
> 
> 时间：2012-05-28T17:31:29.827
> 
> 标签：python, function, if-statement

我想知道为什么下面的程序不打印'b'。这是非常简单的代码；我认为它必须有效；并且不知道为什么它没有。

```
def a():
    if b > 10:
        print 'b'
        sys.exit(1)

# main
while 1:
    a()
    b += 1 
```

b 是全局变量。实际代码更复杂，但结构和我的一样。我想当我调用 a() 函数并且如果 b 大于 10 时，它会显示“b”。但是，它不会进入 if 语句。

你能帮我看看如何解决吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:34:39.513

全局变量是可怕的，学会不使用它们，试试这样的东西

```
import sys
def a(value):
    if value > 10:
        print value
        print "Greater than 10!"
        sys.exit(0)
b = 0
while True:
    a(b)
    b += 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:43:47.270

另一个答案建议不要使用全局变量，我同意。如果您仍想使用全局变量，则应`b`首先在循环之外定义。（如果您这样做，请发布完整的代码，因为除此之外，它应该可以工作（并且确实如此））。

现在，`global b`在函数中定义是没有必要的，因为当你在分配之前尝试访问它时，python 猜测它是一个全局变量。但由于它没有被定义，它引发了一个`NameError`：

```
NameError: global name 'b' is not defined 
```

如果你没有看到，那么还有别的东西，你没有显示有问题的实际代码。

这最终给了你类似的东西：

```
import sys
def a():
    global b
    if b > 10:
        print 'b'
        sys.exit(1)

b = 0
# main
while 1:
    a()
    b += 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:34:13.057

只是我的 2 美分：忘记全局变量。

无论如何，这应该工作

```
def a():
    global b
    if b > 10:
        print 'b'
        sys.exit(1) 
```

**编辑**FUUUUUUUUUUUUUUU

尽管我完全同意 Jackob 关于如何使用函数参数和避免全局变量的观点，但为了记录，这里是全局的解决方案：

```
def a():
    global b
    if b > 10:
        print 'b'
        sys.exit(1)

# main
b = 0
while 1:
    a()
    b += 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T17:45:50.633

您需要在 "+=" 之前定义 b 。

```
def a():
    if b > 10:
        print 'b'
        sys.exit(1)

# main
b = 0 # HERE
while 1:
    a()
    b += 1 
```

顺便说一句，正如许多人告诉你的那样：避免使用全局变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T18:32:29.233

全局变量不是通常的方法。您可能更喜欢使用[嵌套函数](http://marakana.com/bookshelf/python_fundamentals_tutorial/functional_programming.html)：

```
import sys

def outer(value=0):
    count = [value]
    print "started at:", count[0]
    def inner(x=1):
        print "current val:", count[0]
        count[0] += x
        if count[0] > 10:
            print "stopped at:", count[0]
            sys.exit(0)
    return inner

f = outer(5)
while True:
    f(1) 
```

# visual-studio-2010 - 如何使用 Visual Studio 2010 Ultimate 模型项目在专用接口中定义泛型类型

> ID：10788435
> 
> 赞同：1
> 
> 时间：2012-05-28T17:31:44.160
> 
> 标签：visual-studio-2010, generics, interface, code-generation

我`IFoo<T, U>`在包中定义了一个接口。在一个单独的包中，我想将一个接口定义为 ISpecialFoo ，它将实现`IFoo<T, U> where T: string, U: int`.

但是，当我在图表上创建 ISpecialFoo 接口并将关系添加到 IFoo 时，如果不将 ISpecialFoo 定义为，我无法将 T 和 U 放在生成的代码中`ISpecialFoo<string, int>`- 这正是我不想做的。

有谁知道在 ISpecialFoo 上设置模板绑定或模板参数以便它适当地生成代码文件的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:51:22.783

听起来您真正要声明的是：

```
interface ISpecialFoo : IFoo<string, int> 
```

这种方式`ISpecialFoo`本身不再是通用的 - 它分别来自和`IFoo<T, U>`评估`T`和。`U``string``int`

至于你如何用你的建模thingamajig指定这个，我不能说。

# r - ggplot2极坐标轴标签位置

> ID：10788436
> 
> 赞同：12
> 
> 时间：2012-05-28T17:32:03.153
> 
> 标签：r, ggplot2, label, coordinate

这只是一个老问题 [ggplot2极坐标图箭头的扩展](https://stackoverflow.com/questions/10515703/ggplot2-polar-plot-arrows) ![MatLab 中的指南针图](../Images/4892bc7446d0bfa6aa0ba2d54f2e94e2.png)

您会发现 x 轴不在 most_out 圈内。在ggplot2中，我使用“panel.grid.major = theme_line(colour = "black", size = 0.2, linetype=2)" 得到虚线圆，如下所示： ![使用 GGplot2](../Images/1d30c80b267bb6d8dd5777987d003b38.png) 所以我的问题是如何制作轴标签（ 180, 135, 90, .....) 在圆外，因为文字与圆线合并。

我尝试使用“hjust”或“vjust”来调整文本和轴之间的距离。但它不起作用。那么你对这个问题有什么想法吗？先谢谢！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T03:08:52.927

您没有提供重现问题的代码，所以这只是猜测。

过去，我`\n`特别使用空格将文本“移开”。也许自定义格式化程序可能在这里工作。这是编写[自定义刻度标记标签格式化程序的](http://wiki.stdout.org/rcookbook/Graphs/Axes%20(ggplot2)/#tick-mark-label-text-formatters)方法。

如果失败，您始终可以隐藏轴标签并`geom_text`通过添加另一个图层自己使用它们来绘制它们。

希望这可以帮助。顺便说一句， @hadley[关于 ggplot2 的书](https://rads.stackoverflow.com/amzn/click/com/0387981403)非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-09T21:43:15.790

我在尝试自己解决类似问题时遇到了这个问题。这篇文章的答案几乎涵盖了一种解决方法：[在极坐标图的边缘移除额外的空间和环](https://stackoverflow.com/questions/20808009/ggplot2-remove-extra-space-at-edge-of-polar-plot/20820592#20820592)

您必须调整 x 比例的限制以匹配您的轴标签。您还必须创建一个与箭头径向长度相对应的新比例尺（绘图左侧的 0-300 比例尺），因为

```
axis.text = element_blank 
```

也拿走了比例尺。

# objective-c - 嵌套的 NSUserDefaults 数组读/写

> ID：10788439
> 
> 赞同：3
> 
> 时间：2012-05-28T17:32:17.253
> 
> 标签：objective-c, ios, arrays, nsuserdefaults

我有以下数据结构：

```
- Cards
 -- Item 0
  --- Name: Card Name
  --- Number: Card Number
  --- Type: Card Type
 -- Item 1
  --- Name: Card Name
  --- Number: Card Number
  --- Type: Card Type
... 
```

用户可以根据需要添加任意数量的卡片，因此名称、编号和类型是用户定义的。

第一个问题是，我怎样才能将这些数据写入 NSUserDefauls （像这样嵌套）

第二个问题是，如何检索这些数据并在表格视图中显示每张卡的名称。（我已经设置了 tableview 并且正在工作，所以这是从 NSUserDefaults 获取数据的问题）。

任何代码示例都非常受欢迎。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T17:47:20.367

要创建这种结构非常简单，您可以创建一个字典，其中包含键“卡片”的数组值。下面的例子..

```
NSMutableDictionary *cards = [NSMutableDictionary dictionary];
NSMutableArray *cardArray = [NSMutableArray array];

NSMutableDictionary *item = [NSMutableDictionary dictionary];
[item setValue:@"Card Name" forKey:@"Name"];
[item setValue:@"Card Number" forKey:@"Number"];
[item setValue:@"Card Type" forKey:@"Type"];

[cardArray addObject:item];
[cards setValue:cardArray forKey:@"Cards"];

[[NSUserDefaults standardUserDefaults] setValue:cards forKey:@"user_cards"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

为了检索你的卡片，你会做类似的事情。假设 self.cards 是一个 NSMutableArray ivar 。

```
NSMutableDictionary *stored = [[NSUserDefaults standardUserDefaults] valueForKey:@"user_cards"];

self.cards = [stored valueForKey:@"Cards"]; 
```

您的 tableview 应该使用`cards`ivar 来填充您的数据，如下所示。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    ...... 

    //Now we populate each row of the cell with each `card` Name.
  cell.textLabel.text = [[self.cards objectAtIndex:[indexPath row]] valueForKey:@"Name"];

   .....
} 
```

要将任何新添加的卡片重新保存到存储的字典中，您可以执行以下操作..

```
NSMutableDictionary *newCard = [NSMutableDictionary dictionary];
[newCard setValue:@"Card Name" forKey:@"Name"];
[newCard setValue:@"Card Number" forKey:@"Number"];
[newCard setValue:@"Card Type" forKey:@"Type"];

[self.cards addObject:newCard];

[[NSUserDefaults standardUserDefaults] valueForKey:@"user_cards"] setValue:self.cards forKey:@"Cards"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

如果这对您的问题有所帮助，请接受它作为答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:46:15.383

节省

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];

// saving an NSArray
[prefs setObject:myArray forKey:@"keyToLookupArray"];

[prefs synchronize]; 
```

检索

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];

// getting an NSArray
NSArray *myArray= [prefs stringForKey:@"keyToLookupArray"]; 
```

# c++ - 指向数组 c++ 的指针

> ID：10788441
> 
> 赞同：3
> 
> 时间：2012-05-28T17:32:29.233
> 
> 标签：c++

我对将数组分配给指针的理解是指针指向数组的第一个索引，所以当打印出指针时，它应该打印出数组第一个索引的地址，但是这种情况下怎么会***cout***打印出整个数组的值？即使我明确表示我想要第一个索引的地址

```
char foo[] = {'A','B','C','\0'};
char* p = foo;
char* q = &(foo[0]);
cout <<"from p:  " << p << endl;
cout << "from q: " <<  q << " " << &(foo[0]) <<  endl;

//output
from p:  ABC
from q: ABC ABC 
```

第二个问题是我看到这两行之间的区别在于，一个是指向 char 的指针数组，另一个是指向 char 数组的指针，对吗？括号是必要的吗？

```
 char* bar1[4];
 char (*bar2)[4] = &foo;
 cout << "address of foo is  " << bar2  << endl;
 //output
 address of foo is  0x7fff192f88b0 
```

***foo 数组的地址应该与A***的地址相同，对吧？如何打印出A的地址？因为我没有这样做。非常感谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T17:35:12.167

`<<`有一个专用的重载`const char *`，因为这就是 C 风格的字符串。试试这个：

```
cout << static_cast<const void *>(bar2) << endl; 
```

# parsing - 遵循模式解析文件

> ID：10788445
> 
> 赞同：1
> 
> 时间：2012-05-28T17:32:55.080
> 
> 标签：parsing, sed, awk, mediawiki

我需要使用 mediawiki 语法（表格）解析文件。

我知道 sed 或 awk 可以做到，但我不是这些专家。

我需要找到以下模式：

```
beginning_of_line| [[text]] ||  random_stuff_until_newline 
```

管道和刹车片之间可能有（或没有）空间。我需要输出文本

对我有什么解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:57:43.000

解析这样的文本就像解析 XML 或 HTML。正则表达式不太适合这种类型的文档。您应该尝试找到[适合该工作](http://www.mediawiki.org/wiki/Alternative_parsers)的 Python 或 Perl 模块。

但是，这里有一个`sed`命令可以在您作为示例提供的简单情况下工作。

```
sed 's/^[^|]*|[[:space:]]*\[\[\([^]]\+\)\]\].*/\1/' inputfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:39:53.057

我会寻找一个 Mediawiki 解析器。它必须存在于某个地方。

如果做不到这一点，如果您有 mediawiki 的语法，您可以使用 ANTLR 或类似的语法生成解析器，具体取决于它是哪种语法。

如果您没有语法或由于学习曲线而不想这样做，那么您需要一些可靠的方法来区分您所说的“文本”和您所说的随机内容。管道是否有保证在那里？如果在 Java 中是这样，您可以使用管道作为拆分参数来执行 String.split()。

你是这个意思吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:23:12.980

这可能对您有用（GNU sed）：

```
sed 's/^[^|]*|\s*\[\[\([^]]*\(][^]]*\)*\)]]\s*||.*/\1/;t;d' file 
```

# mysql - 从 MySQL 数据库创建实体关系图

> ID：10788446
> 
> 赞同：2
> 
> 时间：2012-05-28T17:33:01.447
> 
> 标签：mysql, reverse-engineering, entity-relationship, adodb, entity-relationship-model

我正在尝试通过使用 .SQL 文件对 MySQL 数据库进行逆向工程来创建实体关系图。使用 MySQL WorkBench 和 Toad Data Modeler，该过程已经成功。但是，这两种工具生成的图表都没有显示实体之间的关系。所以这个图没什么用。

询问软件技术支持团队为什么会这样，得到的答复是他们使用 ADODB 作为数据库抽象层以支持多个 DBMS，而 ADODB 并没有明确定义外键。我的问题是，是否有一种工具可以通过与列名等相关的猜测来生成这些关系？

他们还提到他们使用 XML 描述符来查看数据库结构。那么是否可以从 XML 文档生成图表？

我通常会自己创建 ERD，但是数据库包含 99 个表，并且将是一个极其繁琐的过程。

非常感谢，艾米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T05:48:31.063

另一个是 CA 的 ERWin。它是反向和正向工程数据库的神奇工具，可以从列名推断关系。虽然它非常昂贵，但我使用了试用版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:34:19.283

我找到了我的问题的答案：

在 Toad Data Modeler 中，有一个函数可以根据字段名称等推断表之间的关系。在菜单中，它位于宏 -> 全部 -> 推断关系下。

我还没有检查这些关系是否完全准确，但它似乎运作良好。

谢谢，艾米

# mysql - 使用 ORDER by 的 MySQL 性能问题

> ID：10788448
> 
> 赞同：1
> 
> 时间：2012-05-28T17:33:26.010
> 
> 标签：mysql, performance

我遇到了性能问题，以下是在大约 2.5 秒内执行，仅返回 40 行：

```
SELECT DISTINCT song.song_id, song.title, song.length, song.bpm, song.keysig 
FROM song 
INNER JOIN (
    SELECT song_id 
    FROM song_genre 
    WHERE genre_id IN ('25')
) genre1 ON genre1.song_id = song.song_id 
INNER JOIN (
    SELECT song_id 
    FROM song_production 
    WHERE production_id IN ('8')
) production1 ON production1.song_id = song.song_id 
WHERE approved='1' 
ORDER by song.priority DESC, song.song_id DESC 
LIMIT 0, 40 
```

`ORDER BY`运行查询会在 0.01 秒内放弃执行，等等。

我知道这个问题可能与计算信息的方式有关，因为我正在使用 JOINS，所以可能需要嵌套查询，但我不是 100% 我会怎么做？

```
id select_type table type possible_keys key key_len ref rows Extra
 1 PRIMARY <derived3> ALL NULL NULL NULL NULL 321 使用临时；使用文件排序
 1 PRIMARY <derived2> ALL NULL NULL NULL NULL 3424 使用连接缓冲区
 1 PRIMARY 歌曲 eq_ref PRIMARY PRIMARY 4 production1.song_id 1 使用 where
 3 DERIVED song_production ref PRIMARY PRIMARY 4 339 使用索引
 2 DERIVED song_genre index NULL PRIMARY 8 NULL 3424 使用where；使用索引

```

表`song`：

```
CREATE TABLE `song` (
`song_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`title` tinytext,
`length` varchar(5) DEFAULT NULL,
`Type` varchar(1) DEFAULT NULL,
`Vocals` varchar(10) DEFAULT NULL,
`Themes` varchar(10) DEFAULT NULL,
`Explicit` varchar(10) DEFAULT NULL,
`timesig` varchar(3) DEFAULT NULL,
`keysig` varchar(250) NOT NULL,
`bpm` int(3) DEFAULT NULL,
`speed` varchar(7) DEFAULT NULL,
`Era` varchar(10) DEFAULT NULL,
`Language` varchar(10) DEFAULT NULL,
`Keywords` varchar(10) DEFAULT NULL,
`description` mediumtext,
`search_description` longtext NOT NULL,
`key` varchar(25) NOT NULL,
`priority` int(2) NOT NULL,
`approved` int(1) NOT NULL DEFAULT '0',
PRIMARY KEY (`song_id`),
FULLTEXT KEY `description` (`description`),
FULLTEXT KEY `search_description` (`search_description`),
FULLTEXT KEY `title` (`title`),
FULLTEXT KEY `head_desc` (`title`,`search_description`)
) ENGINE=MyISAM 
  AUTO_INCREMENT=1388 
  DEFAULT CHARSET=utf8 ; 
```

表`song_genre`：

```
CREATE TABLE `song_genre` (
`genre_id` int(10) NOT NULL,
`song_id` int(10) NOT NULL, 
PRIMARY KEY (`genre_id`,`song_id`)
) ENGINE=MyISAM 
  DEFAULT CHARSET=latin1 ; 
```

表`song_production`：

```
CREATE TABLE `song_production` (
`production_id` int(10) NOT NULL,
`song_id` int(10) NOT NULL,
PRIMARY KEY (`production_id`,`song_id`)
) ENGINE=MyISAM 
  DEFAULT CHARSET=latin1 ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:22:15.140

第一步：

我猜`genre_id`,`production_id`和`approved`是`integer`列而不是`char`，所以在数字周围加上引号是没有用的`'25'`。取消引用它们：`25`

如果删除 会发生什么`DISTINCT`？（如果没有表的结构、主键、外键和唯一约束，我们就无法知道）。结果中是否有多个相同的行？如果没有，只需删除`DISTINCT`. 如果是，请将其删除并添加`GROUP BY song.song_id`：

```
SELECT song.song_id, song.title, song.length, song.bpm, song.keysig 
FROM song 
  INNER JOIN (
    SELECT song_id 
    FROM song_genre 
    WHERE genre_id IN (25)
  ) genre1 ON genre1.song_id = song.song_id 
  INNER JOIN (
    SELECT song_id 
    FROM song_production 
    WHERE production_id IN (8)
  ) production1 ON production1.song_id = song.song_id 
WHERE approved = 1 

----- GROUP BY song.song_id           --- not needed at all (with these tables)
                                                        --- (and structure)
ORDER BY song.priority DESC, song.song_id DESC 
LIMIT 0, 40 ; 
```

* * *

第二步：

添加有用的索引。上的索引`(approved, priority, song_id)`可能有助于查询。

您还将`song.song_id`列定义为`UNSIGNED INT`while`song_genre.song_id`和`song_production.song_id`定义为`SIGNED INT`。如果您也将它们转换为，那就太好了`UNSIGNED INT`。

我还会在`(song_id, genre_id)`和上添加（唯一）索引`(song_id, production_id)`。它们可能对这个查询没有用，但在其他情况下你肯定会需要这样的索引。

* * *

第三步：

尝试以其他方式重写查询。例如，没有派生表：

```
SELECT song.song_id, song.title, song.length, song.bpm, song.keysig 
FROM song 
  INNER JOIN
    song_genre AS genre1 
        ON genre1.song_id = song.song_id 
  INNER JOIN 
    song_production AS production1
        ON production1.song_id = song.song_id 
WHERE song.approved = 1
  AND genre1.genre_id IN (25)
  AND production1.production_id IN (8)
ORDER BY song.priority DESC
       , song.song_id DESC 
LIMIT 0, 40 ; 
```

或与`EXISTS`：

```
SELECT song.song_id, song.title, song.length, song.bpm, song.keysig 
FROM song 
WHERE song.approved = 1
  AND EXISTS
      ( SELECT *
        FROM song_genre AS genre1 
        WHERE genre1.song_id = song.song_id 
          AND genre1.genre_id IN (25)
      ) 
  AND EXISTS
      ( SELECT *
        FROM song_production AS production1
        WHERE production1.song_id = song.song_id
          AND production1.production_id IN (8)
      )
ORDER BY song.priority DESC
       , song.song_id DESC 
LIMIT 0, 40 ; 
```

并测试哪一个执行得更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:22:38.063

MySQL 将`ORDER BY`在应用限制之前对所有行运行，所以如果你的`song`表很大，并且没有正确索引，那么它仍然会很慢。[MySQL 性能博客上](http://www.mysqlperformanceblog.com/2006/09/01/order-by-limit-performance-optimization/)有一篇文章，介绍了一些可以用来加快`ORDER BY ... LIMIT`查询速度的方法。

我会注意到子查询有点多余，join 会解决这个问题。您可以像这样重写查询：

```
SELECT DISTINCT song.song_id, song.title, song.length, song.bpm, song.keysig 
FROM song 
JOIN song_genre g
  ON g.song_id = song.song_id 
JOIN song_production p
  ON p.song_id = song.song_id 
WHERE approved='1' 
  AND g.genre_id IN ('25')
  AND p.production_id IN ('8')
ORDER by priority DESC, song_id DESC 
LIMIT 0, 40 
```

而且我什至不确定您是否需要`DISTINCT`SELECT，除非您可以拥有多首具有完全相同 id/title/length/bpm/keysig 值的歌曲。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T17:45:26.680

好的，我只是重写查询：

```
 SELECT DISTINCT song.song_id, song.title, song.length, song.bpm, song.keysig
FROM song
    INNER JOIN (
        SELECT song_id
        FROM song_genre
        WHERE genre_id LIKE '%'
    ) genre1
        ON genre1.song_id = song.song_id
    INNER JOIN (
        SELECT song_id
        FROM song_production
        WHERE production_id IN ('5')
    ) production1
        ON production1.song_id = song.song_id
WHERE approved='1'
ORDER by song.priority DESC, song.song_id DESC
LIMIT 0, 40 
```

首先，我在表 song 上应用 order by，他们在 index 中有 song_id。我也希望优先。如果没有，请在此添加一个索引，并且 order by 将不会通过临时表和文件排序。

如果您没有为 order by 指定一个表，MySQL 可能会选择错误的表来执行 order by。

# node.js - 在 nodejs 中使用异步库

> ID：10788452
> 
> 赞同：1
> 
> 时间：2012-05-28T17:34:10.760
> 
> 标签：node.js, async.js

大家好，这是我的代码：

```
function get_group(req, res, next) {
var send_result = function(err, group_list) {
[...]
    res.send(group_list);
    return next();
};

Group.findOne({'_id': req.params._id}, send_result); 
```

}

现在我如何使用 async.series 实现异步库 (caolan) 并将 findOne() 与 send_result 结合起来，因为它的代码对我来说看起来很杂乱无章。

**编辑1**：

我使用了这个策略，但我不确定是否正确，有什么建议吗？

```
function get_group(req, res, next) {
async.waterfall([
    function(callback) {
        Group.findOne({'_id': req.params._id}, callback);
    }
],
function (err, group_list){
    res.send(group_list);
    return next();
}); 
```

}

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:01:31.817

对于他们在 Express.js 中所谓的路由，您实际上几乎不需要使用异步库。原因是路由实际上是它们自身的一种控制流。它们采用任意数量的中间件，因此您可以将路由划分为小代码块。

例如，假设您想从数据库中获取一个记录/文档对其进行处理，然后将其作为 json 发送。然后您可以执行以下操作：

```
var getOne = function(req, res, next){
    db.one( 'some id', function(err, data){
        if (err){
            return next( { type: 'database', error: err } );
        };

        res.local( 'product', data );
        next();
    });
};

var transformProduct = function(req, res, next){
    var product = res.locals().product;

    transform( product, function(data){
        res.local('product', data);
        next();
    });
};

var sendProduct = function(req, res, next){
    var product = res.locals().product;
    res.json(product);
};

app.get( '/product', getOne, transformProduct, sendProduct ); 
```

If you write middleware for your routes like this you'll end up with small building blocks you can easily reuse throughout your application.

# java - 为 DSL 编写编译器的工具

> ID：10788455
> 
> 赞同：3
> 
> 时间：2012-05-28T17:34:23.930
> 
> 标签：java, dsl

我将开始为我的文本域特定语言编写编译器。据我所知，有些人认为 ANTLR 适合编写编译器。还有其他可用的工具。但是，我不确定，哪一个对我有好处。我应该从 ANTLR 还是其他具有良好文档的新工具开始。

请在这方面给我建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:57:22.917

根据您的 DSL 计划的复杂性，您可能想看看 Groovy 语言。它是一种动态 JVM 语言，您可以自由地与 Java 混合使用。有很多文档和示例可以帮助您开始使用 Groovy 编写 DSL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:00:36.303

对于初学者，您可以看一下[ANTLR](http://www.antlr.org/)，它是 Java*的*解析器编译器，据称它“使构建自定义 DSL 变得轻而易举”。

# php - CRUD，在添加或编辑中单击保存后

> ID：10788457
> 
> 赞同：0
> 
> 时间：2012-05-28T17:34:35.333
> 
> 标签：php, mysql, postgresql, atk4

/var/www/page/page/video.php：

```
<?php
class page_video extends Page {
    function init(){`enter code here`
        parent::init();

        $form=$this->add('Form');

        $d=$this->add('Tabs');
        $d->addTab('klienci_w')->add('CRUD')->setModel('KlienciW');

        if($form->isSubmitted()){
            $form->js()->execute();
       }

    }  

    } 
```

/var/www/page/lib/Model/KlienciW.php

```
<?php
class Model_KlienciW extends Model_Table {
    public $entity_code='klienci_w';
    public $debug=true;

        function init(){
                parent::init();

    $this->addField('adresid');
    $this->addField('adresn');
    $this->addField('adresu');
    $this->addField('adresk');
    $this->addField('adresp');
    $this->addField('aosoba');
    $this->addField('aosobat');
    $this->addField('odbiorcaid');
    $this->addField('data')->type('date');
    $this->addField('datau')->type('date');

        }

    } 
```

我有一个 Chrome 的答案（在 Firefox 中是一样的）：

```
insert into `klienci_w` (`adresid`,`adresn`,`adresu`,`adresk`,`adresp`,`aosoba`,`aosobat`,`odbiorcaid`,`data`,`datau`) values ("sdfsd","fsdf","sdfsd","fsdf","sdfsd","fsdfsd","fsdf","sdf","2012-05-16","2012-05-18") [:a_10, :a_9, :a_8, :a_7, :a_6, :a_5, :a_4, :a_3, :a_2, :a]
select `id`,`adresid`,`adresn`,`adresu`,`adresk`,`adresp`,`aosoba`,`aosobat`,`odbiorcaid`,`data`,`datau` from `klienci_w` where `id` = "6" limit 0, 1 [:a]
$('#Frontend_video_tabs_view_htmlelement_crud').trigger('reload');$('#Frontend_video_tabs_view_htmlelement_crud_form').univ().closeDialog() 
```

在 MySQL 中，此数据已添加到数据库中，但表单仍在 Web 浏览器的主屏幕上，在 PostgreSQL 上没有任何反应，但表单仍在 Web 浏览器的主屏幕上。

版本 4.2 和 4.2.1 中的 ATK4。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T10:29:49.453

通过删除 debug=true 行来关闭调试。

# ruby-on-rails - webkit_server 找不到可执行文件

> ID：10788458
> 
> 赞同：4
> 
> 时间：2012-05-28T17:34:36.757
> 
> 标签：ruby-on-rails, webkit, capybara

我正在使用 Capybara 来测试我的 Rails 应用程序。

我需要测试一些 javascript，所以我设置了 webkit 来测试这些页面（不记得所有步骤，几个月前做了）。这是几个月前的一个这样的规范，效果很好：

```
describe "user fills in form", js: true, driver: :webkit do
...
end 
```

该规范执行并通过就好了。

我制定了一个新规范并拥有这个规范：

```
describe "check player", js: true, driver: :webkit do
...
end 
```

我得到这个错误：

```
2012-05-28 10:24:48.771 webkit_server[6274:207] Cannot find executable for CFBundle 0x104552dc0 </Library/Internet Plug-Ins/Unused> (not loaded)
2012-05-28 10:24:48.885 webkit_server[6274:207] Error loading /Applications/Amazon MP3 Downloader.app/Contents/Resources/AmazonMP3DownloaderPlugin.plugin/Contents/MacOS/AmazonMP3DownloaderPlugin:  dlopen(/Applications/Amazon MP3 Downloader.app/Contents/Resources/AmazonMP3DownloaderPlugin.plugin/Contents/MacOS/AmazonMP3DownloaderPlugin, 262): no suitable image found.  Did find:
    /Applications/Amazon MP3 Downloader.app/Contents/Resources/AmazonMP3DownloaderPlugin.plugin/Contents/MacOS/AmazonMP3DownloaderPlugin: no matching architecture in universal wrapper
objc[6274]: Class WebCoreMovieObserver is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore. One of the two will be used. Which one is undefined.
objc[6274]: Class WebCoreSharedBufferData is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore. One of the two will be used. Which one is undefined.
objc[6274]: Class WebVideoFullscreenWindow is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
objc[6274]: Class WebVideoFullscreenController is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
objc[6274]: Class WebVideoFullscreenHUDWindowController is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
objc[6274]: Class WebVideoFullscreenHUDWindow is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
objc[6274]: Class WebWindowFadeAnimation is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
objc[6274]: Class WebWindowScaleAnimation is implemented in both /usr/local/Cellar/qt/4.8.0/lib/QtWebKit.framework/Versions/4/QtWebKit and /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit. One of the two will be used. Which one is undefined.
2012-05-28 10:24:48.981 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/npgtpo3dautoplugin.plugin/Contents/MacOS/npgtpo3dautoplugin:  dlopen(/Library/Internet Plug-Ins/npgtpo3dautoplugin.plugin/Contents/MacOS/npgtpo3dautoplugin, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/npgtpo3dautoplugin.plugin/Contents/MacOS/npgtpo3dautoplugin: mach-o, but wrong architecture
2012-05-28 10:24:49.215 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/Silverlight.plugin/Contents/MacOS/agcore:  dlopen(/Library/Internet Plug-Ins/Silverlight.plugin/Contents/MacOS/agcore, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/Silverlight.plugin/Contents/MacOS/agcore: mach-o, but wrong architecture
2012-05-28 10:24:49.262 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/googletalkbrowserplugin.plugin/Contents/MacOS/googletalkbrowserplugin:  dlopen(/Library/Internet Plug-Ins/googletalkbrowserplugin.plugin/Contents/MacOS/googletalkbrowserplugin, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/googletalkbrowserplugin.plugin/Contents/MacOS/googletalkbrowserplugin: mach-o, but wrong architecture
2012-05-28 10:24:49.304 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/QuickTime Plugin.plugin/Contents/MacOS/QuickTime Plugin:  dlopen(/Library/Internet Plug-Ins/QuickTime Plugin.plugin/Contents/MacOS/QuickTime Plugin, 265): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/QuickTime Plugin.plugin/Contents/MacOS/QuickTime Plugin: mach-o, but wrong architecture
2012-05-28 10:24:49.356 webkit_server[6274:207] Error loading /Users/Tyler/Library/Internet Plug-Ins/Google Earth Web Plug-in.plugin/Contents/MacOS/libnpgeplugin.dylib:  dlopen(/Users/Tyler/Library/Internet Plug-Ins/Google Earth Web Plug-in.plugin/Contents/MacOS/libnpgeplugin.dylib, 265): no suitable image found.  Did find:
    /Users/Tyler/Library/Internet Plug-Ins/Google Earth Web Plug-in.plugin/Contents/MacOS/libnpgeplugin.dylib: mach-o, but wrong architecture
2012-05-28 10:24:49.454 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/net.juniper.DSSafariExtensions.plugin/Contents/MacOS/net.juniper.DSSafariExtensions:  dlopen(/Library/Internet Plug-Ins/net.juniper.DSSafariExtensions.plugin/Contents/MacOS/net.juniper.DSSafariExtensions, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/net.juniper.DSSafariExtensions.plugin/Contents/MacOS/net.juniper.DSSafariExtensions: mach-o, but wrong architecture
2012-05-28 10:24:49.823 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/SlingPlayer.plugin/Contents/MacOS/SlingPlayer:  dlopen(/Library/Internet Plug-Ins/SlingPlayer.plugin/Contents/MacOS/SlingPlayer, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/SlingPlayer.plugin/Contents/MacOS/SlingPlayer: mach-o, but wrong architecture
2012-05-28 10:24:49.887 webkit_server[6274:207] Error loading /Library/Internet Plug-Ins/Unity Web Player.plugin/Contents/MacOS/Unity Web Player:  dlopen(/Library/Internet Plug-Ins/Unity Web Player.plugin/Contents/MacOS/Unity Web Player, 262): no suitable image found.  Did find:
    /Library/Internet Plug-Ins/Unity Web Player.plugin/Contents/MacOS/Unity Web Player: no matching architecture in universal wrapper 
```

奇怪的是，如果我为我的应用程序运行所有规范，第一个（使用 webkit 驱动程序）就可以工作。只有较新的规范会引发此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:31:40.743

您可能会在加载 webkit 时遇到这个已知问题： [https ://github.com/thoughtbot/capybara-webkit/issues/157](https://github.com/thoughtbot/capybara-webkit/issues/157)

也许清理您的 Internet 插件目录会有所帮助？

# postgresql - 在 plpgsql 中使用 CTE

> ID：10788459
> 
> 赞同：1
> 
> 时间：2012-05-28T17:34:39.520
> 
> 标签：postgresql, plpgsql, common-table-expression

我正在尝试在 Postgres 8.4 中创建一个使用 CTE 内部的 plpgsql 函数，但它给了我一个语法错误。他们不允许吗？

（像这样，请记住，我是在没有代码的情况下编写的。）

```
With foo as (SELECT id,a as alias FROM foo);
UPDATE zoo SET b = alias FROM foo WHERE id = foo.id;
^Error here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:41:22.473

```
WITH foo as (
    SELECT id
       , a AS zalias
    FROM footable
    )
UPDATE zoo z
SET b = f.zalias
FROM foo f
WHERE z.id = f.id
   ; 
```

注意：“别名”是保留字。

根据 Erwin Brandstetter 的评论更新：CTE 在 8.4 的 UPDATE 语句中无效。您需要 9.1 或更高版本。由于 CTE 实际上是一种即时视图，因此您可以将 CTE 主体放在视图中，然后引用它。

```
CREATE VIEW foo as (
    SELECT id
       , a AS zalias
    FROM footable
    );
UPDATE zoo z
SET b = f.zalias
FROM foo f
WHERE z.id = f.id
   ;
DROP VIEW foo; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:16:55.023

**PostgreSQL 8.4 中不提供**[修改 CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html#QUERIES-WITH-MODIFYING)的数据（就是这样）。

 **正如@wildplasser 在 PostgreSQL **9.1**或更高版本中所展示的那样，您的声明将适用于小补丁，其中引入了数据修改 CTE。

一个非常简单的 8.4 替代品是**子查询**：

```
UPDATE zoo z
SET    b = f.alias
FROM  (SELECT id, a as alias FROM foo) f
WHERE  z.id = f.id; 
```

该示例可以进一步简化（但现实世界的情况可能更复杂）：

```
UPDATE zoo z
SET    b = f.a
FROM   foo f
WHERE  z.id = f.id; 
```

`id`请记住在`WHERE`子句中对其他不明确的列名进行表限定。**

# java - 与号 C 引用类似 java 中的运算符。意义？

> ID：10788473
> 
> 赞同：0
> 
> 时间：2012-05-28T17:35:58.830
> 
> 标签：java, syntax, ampersand

我遇到了这段代码

```
do {
    if (higherQuality &amp;&amp; w &gt; targetWidth) {
        w /= 2;
        if (w &lt; targetWidth) {
            w = targetWidth;
        }
    }

    if (higherQuality &amp;&amp; h &gt; targetHeight) {
        h /= 2;
        if (h &lt; targetHeight) {
            h = targetHeight;
        }
    } 
    BufferedImage tmp = new BufferedImage(w, h, type);
    Graphics2D g2 = tmp.createGraphics();
    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, hint);
    g2.drawImage(ret, 0, 0, w, h, null);
    g2.dispose();

    ret = tmp;
} while (w != targetWidth || h != targetHeight); 
```

我不明白这些 if 条件的含义

```
if (higherQuality &amp;&amp; w &gt; targetWidth) 
```

和

```
if (higherQuality &amp;&amp; h &gt; targetHeight) 
```

它对我来说类似于 C 的*&variable*引用运算符。我是java新手，但我知道它不支持这样的东西，除了标准的按位和逻辑AND之外，我无法在java中搜索出任何其他含义。我将不胜感激任何解释。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:37:46.283

`&amp;`并且`&gt;`是[HTML 字符引用](http://en.wikipedia.org/wiki/Html_entity#HTML_character_references)；看起来上面的代码在你找到它的任何网站上都被错误地编码了。

所以作为参考，这个：

```
if (higherQuality &amp;&amp; w &gt; targetWidth) 
```

应该显示为：

```
if (higherQuality && w > targetWidth) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:38:18.503

解码 HTLM 后，代码读取

```
if (higherQuality && h > targetHeight) 
```

然后`&&`是 Java 的[条件与](http://download.oracle.com/javase/tutorial/java/nutsandbolts/opsummary.html)运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:39:15.340

有人只是偶然对它进行了双重 HTML 编码。它们实际上只是常规运算符，代码应如下所示：

```
do {
    if (higherQuality && w > targetWidth) {
        w /= 2;
        if (w < targetWidth) {
            w = targetWidth;
        }
    }

    if (higherQuality && h > targetHeight) {
        h /= 2;
        if (h < targetHeight) {
            h = targetHeight;
        }
    }
    BufferedImage tmp = new BufferedImage(w, h, type);
    Graphics2D g2 = tmp.createGraphics();
    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, hint);
    g2.drawImage(ret, 0, 0, w, h, null);
    g2.dispose();

    ret = tmp;
} while (w != targetWidth || h != targetHeight); 
```

# javascript - 为什么这个 jQuery 不起作用？

> ID：10788474
> 
> 赞同：1
> 
> 时间：2012-05-28T17:36:00.653
> 
> 标签：javascript, jquery

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
 $(document).ready(function (){
$("#kep").click(function (){
    $("#pic").fadeOut('slow', function (){
        $("#pic").html('<img src="y.jpg">', function (){
            $("#pic").fadeIn('fast');
        });
    });
  });
});
</script>
<div id="pic">
 <center><img id="kep" src="x.jpg"></center>
</div> 
```

这很烦人，我不知道为什么我这么努力地失败了。>.<

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:38:19.170

```
$(document).ready(function() {
    $("#kep").click(function() {
        $("#pic").fadeOut('slow', function() {
            $(this) // point to #pic
                  .html('<img src="y.jpg">ddd') // append image to #pic
                  .fadeIn('fast'); // make fadeIn #pic
        });
    });
}); 
```

**您的代码中的错误：**

```
 $("#pic").html('<img src="y.jpg">', 
       function (){
         // within this callback you are trying to make fadeIn()
         // which is not possible
         // this callback is to process the innerHTML of 
         // #pic, not the #pic itself
            $("#pic").fadeIn('fast');
        }
); 
```

# ruby - 没有定义第二种方法？

> ID：10788477
> 
> 赞同：1
> 
> 时间：2012-05-28T17:36:05.407
> 
> 标签：ruby, methods, metaprogramming, null, ruby-1.9

我希望这段代码定义两个方法，`nilguard`and `falseguard`，它们可以防止 nil 和 false 值。

```
Object.class_eval do
  @list = [false, nil]
  @list.each do |i|
    define_method :"#{i}guard" do |other|
      if self == i
        return other
      else
        return self
      end
    end
  end
end 
```

出于某种原因，它只定义了`falseguard`，它工作正常。为什么会这样，为什么不定义另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:38:42.413

`nil.to_s == ''`，所以你的第二个方法将被调用`guard`。您可能想改用这样的东西：

```
@list = { false: false, nil: nil }
@list.each do |s, i|
  define_method "#{s}guard" do |other|
  # ... 
```

# xcode - 如何摆脱标签栏上的图标阴影

> ID：10788478
> 
> 赞同：1
> 
> 时间：2012-05-28T17:36:22.087
> 
> 标签：xcode, icons, uitabbar, uitabbaritem

我有一个标签栏应用程序，在标签栏上的每个图标上都有一个阴影：

![在此处输入图像描述](../Images/fc147e913fb876bc98a666896b22b18c.png)

应用图标的代码是：

![在此处输入图像描述](../Images/de56099ac527a097a40007ac99e3303e.png)

我想知道我应该怎么做。

# ms-word - WordML 模式生成

> ID：10788481
> 
> 赞同：0
> 
> 时间：2012-05-28T17:37:08.190
> 
> 标签：ms-word, wordml

我需要 Word 2007 的 xml 模板。在 Word 2003 中，它开始如下所示并继续。我需要的是 xml 格式的 Word 2007 通用模板，它可以用作 WordML 到 xml 转换的基础，反之亦然。有 WordML 经验的人肯定知道我要什么！如果您使用过 docbook 往返，我需要的是可用于“wordml.template”参数的模板文档。Word 2003 的模板已经存在。我需要 Word 2007 的模板。如果有人知道，请告诉我如何获得。谢谢！

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?mso-application progid="Word.Document"?> 
<w:wordDocument>xmlns:w="http://schemas.microsoft.com/office/word/2003/wordml"..........." 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:44:35.540

请参阅我对您之前的问题的回答（已关闭）：[Office 2007 的 XML 架构](https://stackoverflow.com/questions/10776070/xml-schema-for-offfice-2007)

验证模式的示例 XML 文件与模式本身之间存在差异。

我告诉过您如何创建一个示例 XML 文件，据我所知，这正是您在这里仍然需要的。

在 Word 中打开 Word 2003 模板，然后“另存为”XML (Word 2007 XML)。那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T19:12:42.010

有不止一种模式。你也许可以在这里得到它们：

[http://www.microsoft.com/en-us/download/details.aspx?id=4463](http://www.microsoft.com/en-us/download/details.aspx?id=4463)

# java - Eclipse“找不到源”rt.jar

> ID：10788483
> 
> 赞同：1
> 
> 时间：2012-05-28T17:37:40.557
> 
> 标签：java, eclipse, plugins, openjdk

我正在开发 Eclipse 插件，但是当我想启动调试模式时，它会停止并显示：

[http://i47.tinypic.com/oicbbp.png](http://i47.tinypic.com/oicbbp.png)

我不知道该怎么办。有什么解决办法吗？

**[编辑]**

但是如果我正常启动它（无调试模式），它会在没有任何警告或错误的情况下启动。它仅在调试模式下显示该错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:35:30.750

请注意， （标题的内容）与包含 J2SE 的核心类`tr.jar`非常不同！这基本上是说 Eclipse 找不到 J2SE 的源代码，因为它没有附加到 IDE。如果您以“无调试”模式启动 Eclipse，则源代码变得无关紧要。`rt.jar``rt.jar`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:00:22.067

当您尝试访问该类时，它找不到此“ResourceBoundle”类的源代码。您可以搜索它并添加它，然后您可以在eclipse中看到代码。

# c# - 如何在 asp.net mvc 中显示 LINQ 数据？

> ID：10788485
> 
> 赞同：0
> 
> 时间：2012-05-28T17:37:54.817
> 
> 标签：c#, asp.net, asp.net-mvc, linq, razor

我正在使用一个名为**scrap**的操作作为

```
public ActionResult Scrap()
 {
    var webGet = new HtmlWeb();
    var document = webGet.Load(Url);
    var wikians = from info in document.DocumentNode.SelectNodes("//div[@id='results']")
                  from link in info.SelectNodes("p//a").Where(x => x.Attributes.Contains("href"))
                  from content in info.SelectNodes("p").Where(y => y.HasAttributes != true)
                  select new
                    {
                      LinkURL = link.Attributes["href"].Value,
                      Text = content.InnerText                             
                    };

 return View();
} 
```

现在我想在视图中显示所有 LinkURL 和 Text。为此，我尝试使用一个名为**WikiModel**的模型作为

```
public class WikiModel
{
  public string url { get; set; }
  public string content { get; set; }
} 
```

现在我该如何走得更远，以便我可以在我的视图中显示所有信息。我们可以使用 来做到这一点，`wikimodel`但是如何在其中添加所有`scrap`操作的数据`wikimodel`？我不知道如何操纵他`select new`的`LINQ`在模型中保存数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:40:35.970

首先，您需要`WikiModel`从查询中返回对象列表：

```
 var wikians = from info in document.DocumentNode.SelectNodes("//div[@id='results']")
                  from link in info.SelectNodes("p//a").Where(x => x.Attributes.Contains("href"))
                  from content in info.SelectNodes("p").Where(y => y.HasAttributes != true)
                  select new WikiModel
                    {
                      url = link.Attributes["href"].Value,
                      content = content.InnerText                             
                    }; 
```

您可以将其传递给视图`Model`：

```
return View(wikians); 
```

在您看来，您现在可以通过`Model`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:43:24.393

```
public ActionResult Scrap()
 {
    var webGet = new HtmlWeb();
    var document = webGet.Load(Url);
    var wikians = from info in document.DocumentNode.SelectNodes("//div[@id='results']")
                  from link in info.SelectNodes("p//a").Where(x => x.Attributes.Contains("href"))
                  from content in info.SelectNodes("p").Where(y => y.HasAttributes != true)
                  select new WikiModel

                    {
                      LinkURL = link.Attributes["href"].Value,
                      Text = content.InnerText                             
                    };

 return View(wikians);
} 
```

# rounding - IEEE 754 四舍五入到正无穷大

> ID：10788486
> 
> 赞同：5
> 
> 时间：2012-05-28T17:38:02.183
> 
> 标签：rounding, ieee-754, infinity

我很难理解 IEEE 754 舍入约定：

*   四舍五入到正无穷大
*   舍入到负无穷大
*   不偏向最近的偶数

如果我有一个由二进制点右侧的 9 位组成的二进制数，并且我需要使用最右边的 3 位来确定舍入，我会怎么做？

这是家庭作业，所以这就是为什么我对这个问题含糊不清......我需要关于这个概念的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:45:05.330

向正无穷大舍入意味着舍入的结果永远不会小于参数。
向负无穷舍入意味着舍入的结果永远不会大于参数。
四舍五入到最接近，甚至意味着四舍五入的结果有时更大，有时小于（有时等于）参数。

在二进制点之后将值四舍五入`+0.100101110`到六位将导致

```
+0.100110   // for round towards positive infinity
+0.100101   // for round towards negative infinity
+0.100110   // for round to nearest, ties to even 
```

值被拆分

```
+0.100101    110 
```

分为要保留的位和确定舍入结果的位。

由于该值为正且确定位并非全为 0，因此向正无穷大舍入意味着将保留的部分增加 1 ULP。

由于该值为正数，因此向负无穷大舍入只会丢弃最后一位。

由于第一个截止位是 1 并且并非所有其他位都是 0，因此该值`+0.100110`比 更接近原始值`+0.100101`，因此结果为`+0.100110`。

对于最近/偶数情况更有指导意义的是一个或两个我们实际上有平局的例子，例如`+0.1001`在二进制点之后四舍五入到三位：

```
+0.100 1   // halfway between +0.100 and +0.101 
```

在这里，规则说在两个最接近的值中选择最后一位为 0（最后一位偶数）的那个，即`+0.100`，该值向负无穷大舍入。但是四舍五入`+0.1011`会向正无穷大四舍五入，因为这一次，两个最接近的值中较大的一个具有最后一位 0。

# java - 判断 ServletContext.getResource() 返回的 URL 是代表文件夹还是文件

> ID：10788488
> 
> 赞同：1
> 
> 时间：2012-05-28T17:38:08.670
> 
> 标签：java, jakarta-ee, servlets

我有一场战争，有一个映射到 /* 的 servlet。我想提供一些存储在 WAR 中的静态资源，所以我应该使用 [ServletContext.getResource()][1] 从 WAR 中检索资源，对吗？

我注意到使用 getResource() 的一个问题。似乎无法可靠地确定返回的 URL 是表示具有内容的资源还是只是文件夹资源（其他资源的容器），这种方式适用于所有 Java EE 容器。

举个例子，说这是WAR的内容

+ | +-hello.html +-文件夹/ | | | +-world.html | +-文件夹2/ | | | +-index.html | +-WEB-INF/

并且此 WAR 使用以下上下文路径部署：/test

我想让 hello.html 在[http://example.com/test/hello.html](http://example.com/test/hello.html)可以访问 我想让 world.html 在[http://example.com/test/folder/world.html](http://example.com/test/folder/world.html)可以访问 我不想要[http://example.com/test/folder/](http://example.com/test/folder/)可访问（我想为该 URL 生成 403 响应） 对于 URL [http://example.com/test/folder2/](http://example.com/test/folder2/)我想显示索引的内容.html 对于 URL [http://example.com/test/folder](http://example.com/test/folder)我想重定向到[http://example.com/test/folder/](http://example.com/test/folder/) 对于 URL [http://example.com/test/folder/index。 html](http://example.com/test/folder/index.html)我想重定向到[http://example.com/test/folder/](http://example.com/test/folder/)

如果我这样做，在 Tomcat 和 Glassfish 上：

ServletContext.getResource('folder/') 我将返回一个 URL，如果我尝试打开该 URL 的流，我会得到一个 FileNotFoundException，有点疯狂，但它告诉我资源是一个文件夹（存在但未找到 = = 文件夹）。

在 Weblogic（和 OC4J）上，我得到一个纯文本流，列出文件夹中的文件。如果您出于任何原因不想泄露文件夹的原始内容，这并不好。

如果我这样做，TC/GF 会变得更加混乱：

ServletContext.getResource('folder') 我得到与 ServletContext.getResource('folder/') 相同的结果。更奇怪的是，如果我执行 ServletContext.getResource('folder/hello.html') 我仍然会返回一个 URL，但在尝试打开流时会收到 FileNotFoundException。

我错过了什么？这似乎是一个基本需求（能够判断资源是代表文件夹还是文件），但我看不到可靠的跨 Java EE 容器方法可以做到这一点。我应该只使用 ClassLoader.getResource() 吗？

[1] [http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResource%28java.lang.String%29](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResource%28java.lang.String%29)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:53:02.543

这就是所谓的“未定义行为”，留给容器供应商作为练习。该资源实际上不是一个文件，它是一个 jar 资源。

因此，我建议要完成您想要的操作，您可能需要将文件层次结构存储在文件系统中，而不是存储在 war 文件中，并通过 File api 访问它们。

# firefox - firefox插件的nsIContentPolicy示例？

> ID：10788489
> 
> 赞同：3
> 
> 时间：2012-05-28T17:38:12.667
> 
> 标签：firefox, firefox-addon

我已经阅读[了 NsIContentPolicy](https://developer.mozilla.org/en/NsIContentPolicy)并在整个 Stackoverflow 中搜索了实现 NsIContentPolicy 的适当教程，但都是徒劳的。我知道 Adblock 使用 NsIContentPolicy 作为他们的主要武器。逆向工程 Adblock 并没有帮助我理解如何实现 NsIContentPolicy。有没有使用 NsIContentPolicy 进行学习的简单插件，或者关于 NsIContentPolicy 的任何好的教程？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T18:13:55.437

我不知道有什么好的教程，但我可以给你一些最小的示例代码：

```
Cu.import("resource://gre/modules/XPCOMUtils.jsm");
Cu.import("resource://gre/modules/Services.jsm");

let policy =
{
  classDescription: "Test content policy",
  classID: Components.ID("{12345678-1234-1234-1234-123456789abc}"),
  contractID: "@adblockplus.org/test-policy;1",
  xpcom_categories: ["content-policy"],

  init: function()
  {
    let registrar = Components.manager.QueryInterface(Ci.nsIComponentRegistrar);
    registrar.registerFactory(this.classID, this.classDescription, this.contractID, this);

    let catMan = Cc["@mozilla.org/categorymanager;1"].getService(Ci.nsICategoryManager);
    for each (let category in this.xpcom_categories)
      catMan.addCategoryEntry(category, this.contractID, this.contractID, false, true);

    onShutdown.add((function()
    {
      for each (let category in this.xpcom_categories)
        catMan.deleteCategoryEntry(category, this.contractID, false);

      // This needs to run asynchronously, see bug 753687
      Services.tm.currentThread.dispatch(function()
      {
        registrar.unregisterFactory(this.classID, this);
      }.bind(this), Ci.nsIEventTarget.DISPATCH_NORMAL);
    }).bind(this));
  },

  // nsIContentPolicy interface implementation
  shouldLoad: function(contentType, contentLocation, requestOrigin, node, mimeTypeGuess, extra)
  {
    dump("shouldLoad: " + contentType + " " +
                          (contentLocation ? contentLocation.spec : "null") + " " +
                          (requestOrigin ? requestOrigin.spec : "null") + " " +
                          node + " " +
                          mimeTypeGuess + "\n");
    return Ci.nsIContentPolicy.ACCEPT;
  },

  shouldProcess: function(contentType, contentLocation, requestOrigin, node, mimeTypeGuess, extra)
  {
    dump("shouldProcess: " + contentType + " " +
                            (contentLocation ? contentLocation.spec : "null") + " " +
                            (requestOrigin ? requestOrigin.spec : "null") + " " +
                            node + " " +
                            mimeTypeGuess + "\n");
    return Ci.nsIContentPolicy.ACCEPT;
  },

  // nsIFactory interface implementation
  createInstance: function(outer, iid)
  {
    if (outer)
      throw Cr.NS_ERROR_NO_AGGREGATION;
    return this.QueryInterface(iid);
  },

  // nsISupports interface implementation
  QueryInterface: XPCOMUtils.generateQI([Ci.nsIContentPolicy, Ci.nsIFactory])
};

policy.init(); 
```

这来自我用来查看内容策略实现问题的最小内容策略实现——除了将所有内容策略调用转储到控制台（[`window.dump`文档](https://developer.mozilla.org/en/DOM/window.dump)）之外，它没有做任何事情。显然，在实际实现中，字段`classDescription`,`classID`和`contractID`应该更改为适当的内容。`onShutdown`属于我正在使用的私有框架：这个扩展是无需重启的，这就是它需要“手动”注册组件的原因，并且如果它在浏览器会话期间关闭，它也会运行此代码以将其删除。

您还可以下载完整的扩展：[testpolicy.xpi](https://palant.de/trash/testpolicy.xpi)。

# javascript - Javascript中的第一个下一个/上一个子字符串位置

> ID：10788491
> 
> 赞同：1
> 
> 时间：2012-05-28T17:38:13.463
> 
> 标签：javascript

假设我有一个长字符串，例如：

```
var sentence = "Marry had a little lamb, Peter had a little wolf, the wolf ate the little lamb and the little wolf was happy."; 
```

我需要在字符串中找到子字符串“Peter”的位置。

那当然是`var pos = sentence.indexOf("Peter");`。

但是现在我有一个问题 - 我需要找到子字符串“lamb”的*最后一次**出现*和子字符串“wolf”`before` `pos`的第一次*出现*。 **`pos`**

 **我怎么做？请纯 Javascript，不要 jQuery。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:45:50.843

怎么样：

```
var pos = sentence.indexOf("Peter");
var pos2 = sentence.lastIndexOf("lamb", pos);
var pos3 = sentence.indexOf("wolf", pos); 
```

**示例：http:** [//jsfiddle.net/ZqsfZ/](http://jsfiddle.net/ZqsfZ/)

这里的关键是 的`fromIndex`参数`lastIndexOf`。它允许您从指定的索引中搜索字符串（向后）以查找第一次出现的单词。

请参阅 和 的[`lastIndexOf`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/lastIndexOf)文档[`indexOf`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/indexOf)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:44:06.983

```
var sentence = "Marry had a little lamb, Peter had a little wolf, the wolf at the little lamb and the little wolf was happy.";
var pos = sentence.indexOf("Peter");
var last_lamb = sentence.substr(0,pos).lastIndexOf("lamb");
var first_wolf = sentence.indexOf("Peter", pos); 
```**

# android - 呼叫接收器使我的应用程序“强制关闭”

> ID：10788495
> 
> 赞同：0
> 
> 时间：2012-05-28T17:38:21.543
> 
> 标签：android

一切正常，直到我接听电话，然后几秒钟后，我收到一条“强制关闭”消息……知道出了什么问题吗？

```
 public void onReceive(Context context, Intent intent) { 
    // TODO Auto-generated method stub
    TelephonyManager telephony = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
    PhoneStateListener imPhoneListener = new PhoneStateListener();
    telephony.listen(imPhoneListener, PhoneStateListener.LISTEN_CALL_STATE);
    Bundle bundle = intent.getExtras();
    String phoneNr= bundle.getString("incoming_number");
    Intent intent1=new Intent("android.intent.action.Checker");
    intent1.putExtra("phoneNr", phoneNr);
    context.startActivity(intent1);
} 
```

哦，顺便说一句，即使应用程序在后台，我怎么能保证我的呼叫接收器总是首先工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:26:00.777

```
TelephonyManager telephony = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
PhoneStateListener imPhoneListener = new PhoneStateListener();
telephony.listen(imPhoneListener, PhoneStateListener.LISTEN_CALL_STATE); 
```

如果没有看到 logcat，很难确定，但你不应该这样做。

`TelephonyManager`是一项系统服务，调用是注册对您的对象`listen(...)`的永久引用。`imPhoneListener`

A`BroadcastReceiver`仅在`onReceive()`执行代码时才存在。这意味着一旦`onReceive()`退出，您`imPhoneListener`就不再是一个有效的对象，但`TelephonyManager`仍然持有对它的引用。

当您接听电话时，您会更改电话的“状态”，并且`TelephonyManager`会尝试通知不存在的`imPhoneListener`对象。有什么东西必须在这里打破。

摆脱这三行，因为它们实际上对您没有任何作用`BroadcastReceiver`-我什至不确定您要在那里实现什么。

# openssl - 在 OpenSSL 中验证证书的域

> ID：10788496
> 
> 赞同：5
> 
> 时间：2012-05-28T17:38:27.020
> 
> 标签：openssl, ssl, x509

我需要使用 C-land OpenSSL 验证 X509 证书的域。

我的理解是该库不会为我执行此操作，并且我必须大致实现以下算法：

1.  如果 subjectAlternativeName 扩展的 dnsName 字段存在，则设置`name`为该值。
2.  否则，设置`name`为主题的 CN 字段。
3.  与请求的主机名进行比较`name`，允许每个星号匹配 [A-Za-z0-9_]+，但不匹配“点”(.)。

在我看来，应该有大量的代码来执行此操作，但我还没有找到任何代码。

任何人都可以找到这样的例子吗？或者，对我的算法进行健全性检查？

编辑：这就是我想出的：[https](https://gist.github.com/2821083) ://gist.github.com/2821083 。OpenSSL 将其留给调用代码似乎真的很奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T11:07:31.637

您非常准确 - 尽管要注意主题备用名称和原始 IP 地址和 FQDN。你可能想偷

```
BOOL SSL_X509_getIDs(apr_pool_t *p, X509 *x509, apr_array_header_t **ids) 
```

[和来自http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_util_ssl.c](http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_util_ssl.c)的相关朋友和 ssl_engine_init.c 中的被调用者（顺便说一下服务器端）的所有选项.

当您对 openssl 回调采取行动时 - 如果您尚未在 CTX 中提供，还请考虑日期和时间以及链。

德。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-02T05:01:47.443

> OpenSSL 将其留给调用代码似乎真的很奇怪。

是的，它在实践中非常有问题的遗漏，因为很多应用程序没有意识到他们必须手动执行检查。

OpenSSL 1.1.0 将包括主机名验证（`HEAD`现在（截至 2013 年 9 月））。根据更改日志，有一个`-verify_name`选项，并`apps.c`响应`-verify_hostname`开关。但`s_client`不响应任一开关，因此不清楚如何为客户端实施或调用主机名检查。

* * *

> 如果存在扩展的`dnsName`字段`subjectAlternativeName`，请将 name 设置为该值。

可能有多个主题备用名称 (SAN)，因此请准备好多个。

> 否则，将名称设置为主题的 CN 字段。

我相信您也需要检查是否匹配。

> 将名称与请求的主机名进行比较，允许每个星号匹配 [A-Za-z0-9_]+，但不匹配“点”(.)。

它更痛苦。您还必须确保您没有匹配 gTLD 或 ccTLD。例如，您不想匹配针对 gTLD 颁发的证书`*.com`。该证书可能是由坏人签发的；）

ccTLD 类似于 *.eu、*.us 或 இலங்கை (nic.lk)。其中大约有 5000 个，Mozilla 在[http://publicsuffix.org/](http://publicsuffix.org/)上提供了一个列表。原始列表位于[https://mxr.mozilla.org/mozilla-central/source/netwerk/dns/effective_tld_names.dat?raw=1](https://mxr.mozilla.org/mozilla-central/source/netwerk/dns/effective_tld_names.dat?raw=1)。

* * *

> 在我看来，应该有大量的代码来执行此操作，但我还没有找到任何代码。

除了 van Gulik 的建议，你也可以试试 Curl。我相当肯定 Curl 包含主机名匹配代码。

* * *

您甚至可以验证证书格式是否正确。在 Web 上下文中负责的组是 CA/浏览器论坛。他们对创建证书有基线和扩展要求：

*   基线证书要求，[https://www.cabforum.org/Baseline_Requirements_V1_1_6.pdf](https://www.cabforum.org/Baseline_Requirements_V1_1_6.pdf)
*   扩展验证证书要求，[https://www.cabforum.org/Guidelines_v1_4_3.pdf](https://www.cabforum.org/Guidelines_v1_4_3.pdf)

例如，在基线文档中，您会发现列为通用名称 (CN) 的 IP 也必须列在主题备用名称 (SAN) 中。

In the extended docs, you will find that reserved IPs (RFC 1918) cannot be present in a extended validation (EV) certificate; and EV certificates cannot contain wild cards.

# sharepoint - sharepoint - 从多个网站的列表中获取项目

> ID：10788500
> 
> 赞同：0
> 
> 时间：2012-05-28T17:38:43.120
> 
> 标签：sharepoint, sharepoint-2010

假设我有一个具有内容类型的站点级功能，以及一个具有包含前面提到的内容类型的项目的列表实例的 Web 级功能。如果我为 100 多个不同的 Web 启用 Web 功能，因此我从相同的列表实例定义和内容类型中获得 100 多个列表，那么从所有这些列表中获取项目的最快方法是什么？遍历网络并一一获取每个列表的列表项非常慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:20:12.540

最快的方法（也是我认为唯一的方法）是使用搜索引擎。
您可以执行“contenttype:document”之类的查询来跨列表搜索文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T19:49:34.933

使用方法如下。

1.  [SPSiteDataQuery](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitedataquery.aspx)

# tridion - 在 SDL Tridion UI 2012 上持续更新预览警报

> ID：10788508
> 
> 赞同：9
> 
> 时间：2012-05-28T17:39:20.753
> 
> 标签：tridion, tridion-2011

我正在尝试在某些测试（默认）页面上建立新的 SDL Tridion UI 2012 功能。尽管我多次单击“更新预览”，但我不断检索“此页面的预览不是最新的”警报。我使用的是虚拟图像，所以除了我自己之外，任何人都无法编辑页面。不管哪个组件发生了变化。我查看了“会话预览”Web 服务端的 cd_core.log 文件，发现这些节点很有趣：

```
INFO  WritableODataClaimProcessor - No session wrapper is installed, not allowing modification operations
DEBUG HandleSessionContentUtil - There are no session wrappers into storage config file!
DEBUG HandleSessionContentUtil - There are no session wrappers into storage config file!
DEBUG WebContext - setCurrentClaimStore: com.tridion.siteedit.preview.PreviewClaimStore@dc60af, thread: Thread-59
DEBUG WritableODataClaimProcessor - Removing sessionId claim from ClaimStore!
DEBUG ClaimStore - remove: uri=taf:claim:contentdelivery:webservice:preview:sessionid
DEBUG WebContext - setCurrentClaimStore: null, thread: Thread-59 
```

最有趣的部分是会话包装器被添加到“会话预览”Web 服务端的 cd_storage_conf.xml 中。Bellow 是“会话预览”cd_storage_conf.xml 的一部分：

```
 <Storages>       
        <Wrappers>               
            <Wrapper Name="SessionWrapper">             
                <Timeout>120000</Timeout>                  
                <Storage Type="persistence" Id="sqlServerDb" dialect="MSSQL" Class="com.tridion.storage.persistence.JPADAOFactory">
                    <Pool Type="jdbc" Size="5" MonitorInterval="60" IdleTimeout="120" CheckoutTimeout="120" />
                    <DataSource Class="com.microsoft.sqlserver.jdbc.SQLServerDataSource">
                        <Property Name="serverName" Value="T2011" />
                        <Property Name="portNumber" Value="1433" />
                        <Property Name="databaseName" Value="Tridion_Session_Preview"/>
                        <Property Name="user" Value="TridionSessionPreview"/>
                        <Property Name="password" Value="tridion"/>
                    </DataSource>
                </Storage>                   
            </Wrapper>
        </Wrappers>            
        <StorageBindings>
            <Bundle src="preview_dao_bundle.xml"/>            
        </StorageBindings>       
        <Storage Type="filesystem" Class="com.tridion.storage.filesystem.FSDAOFactory" Id="staging" defaultFilesystem="false">
            <Root Path="C:\inetpub\wwwroot\software" />
        </Storage>
       <Storage Type="persistence" Id="sqlServerDb" dialect="MSSQL" Class="com.tridion.storage.persistence.JPADAOFactory">
            <Pool Type="jdbc" Size="5" MonitorInterval="60" IdleTimeout="120" CheckoutTimeout="120" />
            <DataSource Class="com.microsoft.sqlserver.jdbc.SQLServerDataSource">
                <Property Name="serverName" Value="T2011" />
                <Property Name="portNumber" Value="1433" />
                <Property Name="databaseName" Value="Tridion_Broker_Staging"/>
                <Property Name="user" Value="TridionBrokerUser"/>
                <Property Name="password" Value="tridion"/>
            </DataSource>
        </Storage>
    </Storages>    
</Global>

<ItemTypes defaultStorageId="sqlServerDb" cached="false">
    <Item typeMapping="Page" cached="false" storageId="staging"/>
</ItemTypes> 
```

我检查了 cd_storage_conf.xml 的有效性状态，一切正常（尝试通过 IE 打开 XML 并正确显示）。

当我重新发布页面（完成编辑）时，重新加载页面后一切都是正确的状态，直到对任何组件进行第一次更改。这种意想不到的状态给了我如此强烈的痛苦和头痛，更让我感到如此紧张...... :)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-29T15:19:52.183

这是更新预览所做的，确保实际页面刷新之前的所有步骤都有效并且配置正确，您应该做好：

1.  在预览模式下渲染您的模板
2.  将结果发布到 Content Delivery Web 服务
3.  CD Web 服务写入 Session Wrapper 数据库
4.  刷新页面
5.  环境框架过滤器（或 .NET 的 HTTP 模块）检查会话令牌
6.  查询数据库以搜索具有相同会话令牌的内容
7.  如果找到内容，则将其与页面上的内容合并。

典型问题（以我目前的经验）围绕环境框架配置 - 模块未在您的应用程序上安装/配置，或者 cd_ambient_conf.xml 包含无效的配置设置。

可能值得从第 1 步开始跟踪日志以找出失败的地方——知道失败的地方通常是解决方案的 80%。

# c++ - C++ 递归指针函数调用

> ID：10788510
> 
> 赞同：0
> 
> 时间：2012-05-28T17:39:37.967
> 
> 标签：c++, pointers, pass-by-reference

我目前有一个基类`Expr`和一些派生类，例如`AddExpr`,`MultExpr`和`NumExpr`. 我正在尝试重载一个通用`print()`函数，该函数递归调用`print()`其成员的函数，这些成员是指向其他`Expr`对象的指针。

```
//Addition Expression
AddExpr::AddExpr( Expr* l, Expr* r ) {
    left = l;
    right = r;
}
string AddExpr::print() {
    string s;
    stringstream out;
    out << "(+" << left->print() << right->print() << ")";
    s = out.str();
}

NumExpr::NumExpr( string n ) {
    number = atoi( n.c_str() );
}
string NumExpr::print() {
    string s;
    stringstream out;
    out << number;
    s = out.str();
    return s;
} 
```

因此，如果左右指针是数字、（表达式+数字）、（表达式+表达式）等，最终我希望添加表达式通过递归调用`print()`函数来打印出（数字+数字）。

但是我认为我没有正确处理这个问题，因为我得到了混乱的输出:(我不太熟悉通过指针传递和通过引用传递，但是我遇到的每个类似问题的帖子都不太相关我的情况。

这是调用函数的调试示例：

```
NumExpr* left = new NumExpr("1");
cout << left->print() << endl;
NumExpr* right = new NumExpr("2");
cout << right->print() << endl;
AddExpr* temp = new AddExpr( left, right );
cout << temp->print() << endl;
Expr* temp2 = temp;
cout << temp2->print() << endl; 
```

这将打印出 1 和 2，但在 AddExpr 上有问题。

任何帮助表示赞赏！

编辑：我的表达式类的标题：

```
class Expr {
    public:
        virtual string name();
        virtual string print();
};

class AddExpr : public Expr {
    public:
        AddExpr(Expr* l, Expr* r);
        string print();
    private:
        Expr* left;
        Expr* right;
};

class NumExpr : public Expr {
    public:
        NumExpr( string v );
        string print();
    private:
        int number;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:43:47.860

AddExpr::print() 不返回任何值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:44:23.310

我发现您的 AddExpr::print() 方法存在两个问题：

1.  它实际上并没有返回任何东西。你至少应该得到一个编译器警告，如果不是错误的话。

2.  它没有在`left`and之间放置任何空格`right`。

尝试这个：

```
string AddExpr::print() {
    string s;
    stringstream out;
    out << "(+" << left->print() << " " << right->print() << ")";
    s = out.str();
    return s;
} 
```

虽然实际上，最好执行以下操作 - 无需创建显式字符串变量：

```
string AddExpr::print() {
    stringstream out;
    out << "(+" << left->print() << " " << right->print() << ")";
    return out.str();
} 
```

# php - 这个查询有问题吗？

> ID：10788512
> 
> 赞同：0
> 
> 时间：2012-05-28T17:39:46.027
> 
> 标签：php, sql

继承人的代码：

```
 <?php

$post = htmlspecialchars($_GET["story"]);
$con = mysql_connect("localhost","xxx","xxx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("xxx", $con);

$sql="
    UPDATE `tool` SET 
        `title` = '".mysql_real_escape_string($_POST['title'])."', 
        `details` = '".mysql_real_escape_string($_POST['details'])."'
    WHERE `id` = $post;";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }

echo "<a href=story.php?id=";
echo $post;
echo ">Back to the story</a>";

mysql_close($con)

?> 
```

所以首先让我描述一下这应该做什么。这应该是为我的新闻系统编辑帖子。它一直有效，直到最近。我不知道我做了什么改变使它停止工作。我已经尝试了我所知道的一切，更改了每一个小细节，并删除/添加了部分代码。

怎么了：

当我第一次编辑帖子时，标题和细节完全被抹去了。我不知道为什么。它只发生在每个单独的帖子上，1 次。如果我第二次编辑，它保持不变，完全没有问题。

也许如果您在我上面的代码中没有发现明显的缺陷，那么我所描述的情况可能会帮助您找出问题所在。

老实说，我在这方面尽了最大努力，我不确定发生了什么。任何帮助总是受到赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:44:14.740

> 当我第一次编辑帖子时，标题和细节完全被抹去了。

我想第一次你没有发布**标题**和**详细信息**（导致空白），`$_POST['title']`而`$_POST['details']`第二次你是。

当这些为空白时，您需要检查您提交的表单。[Fiddler](http://www.fiddler2.com/fiddler2/)等工具非常适合这种情况。

此外，您确实需要了解 SQL 注入和防范它的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:42:20.920

```
if (intval($post) > 0){
   $sql= "UPDATE `tool` SET 
                 `title` = '".mysql_real_escape_string($_POST['title'])."', 
                 `details` = '".mysql_real_escape_string($_POST['details'])."'
          WHERE `id` = 'intval($post)'
          LIMIT 1";
} 
```

并且为了记录，强烈建议将参数化查询用于此类操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:47:15.903

把`$post`你的查询放在引号之间：

```
WHERE `id` = '$post' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T17:47:29.363

您正在混合 $_GET 和 $_POST。

```
$post = htmlspecialchars($_GET["story"]); 
```

尝试

```
$post = htmlspecialchars($_POST["story"]); 
```

确保您的表格确实发布了所有这些

# jquery - Jquery 加载内容太多次

> ID：10788514
> 
> 赞同：1
> 
> 时间：2012-05-28T17:39:54.093
> 
> 标签：jquery

在某人的帮助下，我创建了一个在页面中加载 JSON 内容的脚本。问题是内容被加载了太多次而不是一次。这是 jquery 函数，它包含在页面头部的 main.js 文件中：

```
 function bakVorm(page,targetClass)
     {
     $.getJSON('http://shop.com/'+page+'/?format=json', function(data){
      var text = ''
      $.each(data.textpage, function(index, text){
      $(text).html('' + text + '').appendTo(targetClass);
});
}); 
```

在产品页面上，我尝试使用以下代码将内容加载到 div 中：

```
$(function(){
bakVorm('vraag','.eigenschappen');
bakVorm('test','.verzendkosten');
}); 
```

问题是内容在相应的div中加载了太多次。可能脚本没有停止或其他什么。

欢迎任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:07:29.123

在这一行

```
$(text).html('' + text + '').appendTo(targetClass); 
```

您正在将文本的内容添加到文本中的每个顶级节点，所以如果文本是

```
 <div></div><p></p> 
```

你最终会得到

```
<div><div></div><p></p></div><p><div></div><p></p></p> 
```

所以省略 html 部分，只需要

```
$(text).appendTo(targetClass); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:46:12.273

尝试清空代码中的 targetClass：

```
function bakVorm(page,targetClass)
 {
 $.getJSON('http://shop.com/'+page+'/?format=json', function(data){
  var text = ''
  $.each(data.textpage, function(index, text){
  $(targetClass).empty().append(text);
  });
}); 
```

或者尝试不使用`append`

```
function bakVorm(page,targetClass)
 {
 $.getJSON('http://shop.com/'+page+'/?format=json', function(data){
  var text = ''
  $.each(data.textpage, function(index, text){
  $(targetClass).html(text);
  });
}); 
```

# jquery - 使用 jQuery 拖动 div 会导致页面突出显示

> ID：10788517
> 
> 赞同：2
> 
> 时间：2012-05-28T17:40:09.500
> 
> 标签：jquery, html, drag-and-drop

请参阅我[之前](https://stackoverflow.com/questions/10786301/drag-and-drop-divs-across-page)关于实现拖放的问题。我让一切工作正常，但现在当我拖动其中一个列表项时，它实际上也会突出显示页面上的所有内容。有了这个先前问题的答案，我该如何制作它以便在拖动时不会突出显示任何内容？我的实际代码是 3 个不同的文件，与接受的答案中的示例大不相同（大得多），所以我只会在必要时发布它。

这是通过`draggable`和`droppable`元素使用 jQuery 的功能。这个功能是这样实现的（重命名和缩短的东西）：

```
 $(function () {
        InitMySystem();
        $("#MyList li").draggable({ revert: true });
        $("#MyDropBox").droppable({
            drop: function (event, ui) {
                HandleDrop(selIndex, 0);
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:32:36.023

你看过[CSS 用户选择](https://developer.mozilla.org/en/CSS/user-select)吗？它还不是标准的，但它可以帮助您解决大多数浏览器中的问题。

# bash - 在 bash 中，如何测试一个单词是否不在列表中？

> ID：10788520
> 
> 赞同：2
> 
> 时间：2012-05-28T17:40:41.393
> 
> 标签：bash, if-statement

大家好，

我想以以下目标为条件：

*有两个文件，脚本检查 file1 的一个单词（位于变量 $word2test 中）如果在 file2 中退出（每个单词位于变量 $wordINlist 中）什么都不做* **|** *如果该单词不在 file2 中，则将其打印到 stdout*

我的第一种方法是：

```
if ! [[ "$word2test" =~ "$wordINlist" ]] ; then
    echo $word2test
fi 
```

提前感谢您的任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:02:21.933

试试这个简单的 bash 示例脚本：

```
word=foobar
grep -q "\<$word\>" FILE || echo "$word is *not* in FILE" 
```

REGEX 的另一种方式：

```
word=foobar
grep -q "^$word *$" FILE || echo "$word is *not* in FILE" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:10:54.813

如果您的文件是每行一个单词的简单列表，请尝试以下操作：

```
grep -Fvf file2 file1 
```

或者

```
join -v 1 <(sort file1) <(sort file2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:48:56.133

假设`$wordINlist`是一个数组（你说“列表”但我假设你的意思是数组），你可以像这样遍历它：

```
for item in ${wordINlist[@]}; do
  [[ $item == $word2test ]] || echo $word2test
done 
```

如果`$wordINlist`是一个文件，那么你可以简单地通过它 grep：

```
egrep -q "\b${word2test}\b" "$wordINlist" || echo "$word2test" 
```

找到`egrep`匹配项时返回 true，否则返回 false。所以这只是说，“要么找到匹配，要么回显`$word2test`”

如果您只想查看哪些项目 in`file1`和 NOT in `file2`，请使用`comm`：

```
comm -23 <(sort -u file1) <(sort -u file2) 
```

# c# - 巨大的列表性能和内存消耗

> ID：10788523
> 
> 赞同：0
> 
> 时间：2012-05-28T17:41:31.217
> 
> 标签：c#, .net, performance, list, ado.net

我正在开始一个新的应用程序。我对数据库运行查询，然后返回海关对象列表。这是一个例子：

使用这种方法，我可以获得一个表的所有记录。示例：从 PKR_PLAYER 中选择 ID、名称、姓氏

```
public List<TEntity> GetAll()
{
    List<TEntity> all = new List<TEntity>();
    String query = String.Format("SELECT {0} FROM {1}",AllFieldsSelection,TableName);
    var data = SqlExecutionData.Create().WithConn(ConnectionString).WithQuery(query);
    foreach (IDataRecord record in SqlServerUtils.GetRecords(data))
    {
        all.Add(CreateOneFromRecord(record));
    }
    return all;
} 
```

有了这个，我创建了一个 TEntityObject ，其中的数据存储在记录中

```
private TEntity CreateOneFromRecord(IDataRecord record)
{
    var result = new TEntity();
    for (int i = 0; i < record.FieldCount; i++)
    {
        ColumnMap colMap = maps.FirstOrDefault(x => x.Column.Equals(record.GetName(i)));
        if (colMap == null || record.IsDBNull(i)) continue;
        object value = record.GetValue(i);
        colMap.PropertyInfo.SetValue(result, value, null);
    }
    return result;
} 
```

我如何执行查询

```
public static IEnumerable<IDataRecord> GetRecords(SqlExecutionData data)
{
    using (SqlConnection sqlConnection = new SqlConnection(data.ConnectionString))
    using (SqlCommand command = new SqlCommand(data.Query, sqlConnection))
    {
        if (data.Parameters!=null && data.Parameters.Count > 0)
        {
            foreach (String key in data.Parameters.Keys)
                command.Parameters.AddWithValue(key, data.Parameters[key]);
        }
        sqlConnection.Open();

        using (IDataReader rdr = command.ExecuteReader())
        {
            while (rdr.Read())
            {
                yield return (IDataRecord)rdr;
            }
        }

        sqlConnection.Close();
    }
} 
```

简而言之，这个想法是遍历 SqlDataReader（带有收益返回）并创建一个实体，最后将其存储在一个列表中。

我认为这会消耗大量资源。该查询返回大约 22k 条记录，并且 GetAll 方法将被非常频繁地调用。有时会每隔 1 或 2 分钟调用一次 GetAll 方法。

我只执行了几次（大约 10 次）GetAll 方法，Windows 任务管理器上的信息显示内存在几秒钟内从 17MB 增长到 45MB。

我相信这段代码不是性能。

问题是：我怎样才能使代码消耗更少的内存？可能我必须更改列表，但有什么替代方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:46:49.423

你可以使用`yield return`，但你需要稍微改变你的方法。
这将最大限度地减少您的内存消耗。

```
public IEnumerable<TEntity> GetAll()
{
    String query = String.Format("SELECT {0} FROM {1}",AllFieldsSelection,TableName);
    var data = SqlExecutionData.Create().WithConn(ConnectionString).WithQuery(query);
    foreach (IDataRecord record in SqlServerUtils.GetRecords(data))
    {
        yield return CreateOneFromRecord(record);
    }
} 
```

这将消耗更少的内存，但它也会使您与 SQL Server 的连接保持打开状态。请阅读有关[此 MSDN 文章](http://msdn.microsoft.com/de-de/library/9k7k7cf0.aspx)的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T08:14:56.487

另一种选择可能是委托每个项目。这更加明确，您可以更好地控制每个项目。但是你需要小心，委托调用会阻塞迭代。我更喜欢使用 IEnumerable，因为它在 .NET 中有很多特性（PLinq、foreach、Collection-ctors）。

```
public void IterateItems(Action<int, TEntity> handler)
{
    String query = String.Format("SELECT {0} FROM {1}",AllFieldsSelection,TableName);
    var data = SqlExecutionData.Create().WithConn(ConnectionString).WithQuery(query);

    var index = 0;   
    foreach (IDataRecord record in SqlServerUtils.GetRecords(data))
    {
        handler(CreateOneFromRecord(index, record));
        index++;
    }
} 
```

内存高效调用：

```
public void MemoryEfficient()
{
    ProcessItems((index, item) => Console.WriteLine("{0}: {1}", index, item));
} 
```

收集列表中的项目：

```
public void FillAList()
{
    var list = new List<TEntity>();
    ProcessItems((index, item) => list.Add(item));
} 
```

# svn - 将 svn 从 Assembla 迁移到 Atlassian

> ID：10788526
> 
> 赞同：0
> 
> 时间：2012-05-28T17:41:48.440
> 
> 标签：svn, assembla

我正在尝试将我的 subversion 存储库迁移到 Atlassian。Atlassian 要求导入的 repo 转储具有与每个项目密钥的项目同名的根目录。假设我在 Atlassian 中的项目键是 FOOBAR，那么 repo 转储应该包含所有修订版的 /FOOBAR。它还应该包含主干、分支和标签子目录。

为了重写 Assembla svn 转储，我这样做了：

```
cat foobar-assembla.dump | svn-dump-reloc "/" "FOOBAR" > foobar-atlassian.dump 
```

然后我尝试测试它：

```
svnadmin create test
cat foobar-atlassian.dump | svnadmin load test 
```

这产生了一条错误消息：

```
svnadmin: File not found: transaction '0-0', path 'FOOBAR/trunk'
 * adding path : FOOBAR/trunk ... 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:24:52.917

我认为这是因为转储文件不包含任何会创建 FOOBAR 目录本身的事务。

尝试`svn mkdir file://$PWD/test/FOOBAR`在`svnadmin load test`.

为了给予应有的荣誉，我从[http://dotslashstar.blogspot.com.au/2011/06/svn-hack-insert-missing-trunk-root.html得到了这个提示](http://dotslashstar.blogspot.com.au/2011/06/svn-hack-insert-missing-trunk-root.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T04:26:57.297

以下对我有用。

使用关闭所有转换选项的文本编辑器：

1.  `Node-path: trunk`用替换所有实例`Node-path: FOOBAR/trunk`。
2.  在`FOOBAR/trunk`创建的修订版中，手动在添加的条目之前添加一个条目，该条目`FOOBAR/trunk`创建`FOOBAR`,`FOOBAR/branches`和`FOOBAR/tags`。

我知道这在某些情况下可能不起作用，例如`Node-path: trunk`在文件本身中发生时。但它在这种情况下有效，并且应该适用于大多数其他情况。

# jquery - jQuery - 动态触发器不工作

> ID：10788529
> 
> 赞同：0
> 
> 时间：2012-05-28T17:42:16.660
> 
> 标签：jquery, codeigniter

这是那些令人沮丧的错误之一，它可以工作，然后它不起作用，并且没有通过 Firebug 提供任何调试提示。

我有一个“媒体室”页面，允许用户查看 YouTube 视频，如果是会员，还可以对视频发表评论。当我加载触发器时， .on('click'...) 触发器按预期工作。但是，如果用户选择另一个视频，我 .empty() 并替换触发器。动态添加后，不再产生警报。

该页面可以在[http://dev.edrtrust.com/play/index.php/media/media_room](http://dev.edrtrust.com/play/index.php/media/media_room)的开发服务器上看到，我正在谈论的触发器是视频正上方的“评论（0）”。

html/jQuery 代码包含：

```
<div id="content_right">
                <div id="videoInfo">
                    <?php if( $cntVids > 0){ ?>
                        <p class="vTitle"><?= $vids[0]['title']; ?></p>
                        <p class="vArtist"><?= $vids[0]['artist']; ?></p>
                        <p class="vPost">
                            <?= "Posted by " . $vids[0]['first_name'] . " " . 
                                $vids[0]['last_name'] . " on " . 
                                substr($vids[0]['postDate'],0,10); ?>
                        </p>
                        <p>Views: <?= $vids[0]['views']; ?></p>
                    <?php } else { ?>
                        <p class="vNone">There are no videos available.<br><br>Please choose another artist from the drop-down menu to the left.</p>
                    <?php } // end if ?>
                    <div id="adminPick" style="display:none;">
                        <img src="<?= base_url('assets/images/ppm_pick.png'); ?>" />
                    </div> <!-- END adminPick DIV -->
                    <br><br>
                    <div class="commentControls">
                        <?php
                            //print_r($vids[0]);
                            $cntComments = $this->content->countMediaComments( $vids[0]['media'] );
                        ?>
                        <table class="tblCommentsControl" align="center" border="0" width="800px" style="margin-left:20px;">
                            <tr>
                                <td style="width:50%;text-align:left;">
                                    <h6 class='lynx btnComments' name="<?= $vids[0]['media']; ?>">
                                        Comments (<span class='cnt'><?= $cntComments; ?></span>)
                                    </h6>
                                </td>
                                <td style="width:50%;text-align:center;">
                                    <?php if( $_SESSION['loggedIn'] && $_SESSION['loggedIn'] == 'true'){ ?>
                                    <h6 class='lynx btnAddCom' name="<?= $vids[0]['media']; ?>">
                                        Add Comment
                                    </h6>
                                    <?php } else { ?>
                                        <h6>Login or register to comment.</h6>
                                    <?php } // end if ?>
                                </td>
                            </tr>
                        </table>
                    </div> <!-- END commentControls DIV -->

                </div> <!-- END videoInfo DIV --> 
```

jQuery：

```
$('h6.btnComments').on('click', function(e){
            var media_id = $(this).attr('name');
            alert(media_id);
        }); // end comment button click 
```

最后，通过 AJAX，我在选择新视频时替换上面的内容（这是行不通的）

```
public function get_media_by_tube(){
    $id = $this->input->post( 'ytID' );
    $vids = $this->content->getMediaByYT( $id );
    $cntComments = $this->content->countMediaComments( $vids[0]['media'] );
    //echo $this->db->last_query();
    //print_r($vids);
    echo "<p class='vTitle' name='" . $vids[0]['id']. "'>" . $vids[0]['title'] . "</p>";
    echo "<p class='vArtist' name='" . $vids[0]['is_featured'] . "'>" . $vids[0]['artist'] . "</p>";
    echo "<p class='vPost'>Posted by ";
    echo $vids[0]['first_name'] . " " . $vids[0]['last_name'];
    echo " on " . substr($vids[0]['postDate'],0,10) . "</p>";
    echo "<p>Views: " . $vids[0]['views'] . "</p>";
    echo "<div id='adminPick' style='display:none;'>";
    echo "<img src='base_url('assets/images/ppm_pick.png')' />";
    echo "</div> <!-- END adminPick DIV -->";
    echo "<br><br>";
    echo "<div class='commentControls'>";
    echo "<table class='tblCommentsControl' align='center' border='0' width='800px' style='margin-left:20px;'>";
    echo "<tr>";
    echo "<td style='width:50%;text-align:left;'>";
    echo "<h6 class='lynx btnComments' name='" . $vids[0]['media'] . "'>";
    echo "Comments (<span class='cnt'>" . $cntComments . "</span>)";
    echo "</h6></td>";
    echo "<td style='width:50%;text-align:center;'>";
    if( $_SESSION['loggedIn'] && $_SESSION['loggedIn'] == 'true'){
        echo "<h6 class='lynx btnAddCom' name='" . $vids[0]['media'] . "'>";
        echo "Add Comment";
        echo "</h6>";
    } else {
        echo "<h6>Login or Register to Comment</h6>";
    } // end if
    echo "</td>";
    echo "</tr></table></div> <!-- END commentControls DIV -->";
} // end json_get_media_by_tube function 
```

任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:04:33.183

您正在使用直接事件处理程序，但需要委托一个（有关详细信息，请查看 jQuery [.on() 文档](http://api.jquery.com/on/)）该处理程序直接绑定到`$('h6.btnComments')`，但在替换此对象的内容及其所有事件被删除之后。尝试使用委托事件处理程序，例如（以前的 live() 或 delegate()）

```
$('#videoInfo').on('click', 'h6.btnComments', function(e){
... 
```

# php - 需要概念帮助：表格和显示所有行

> ID：10788535
> 
> 赞同：0
> 
> 时间：2012-05-28T17:42:42.197
> 
> 标签：php, html, tabular

我的站点中有一个上传系统，用户可以在其中上传文件并对其进行简要描述。每个上传都有一个对应的 SQL 条目。

然后，我网站上的另一个页面将显示上传的每个文件以及有关该文件的一些特征

问题是：

如何创建具有可变行集的表以及如何设置表以自动填充新行？

我能够使用 PHP，但仍然是一个新手，对 HTML 很弱（我使用所见即所得）并且完全没有使用 Javascript 的经验。

任何朝着正确方向的轻推将不胜感激......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:53:29.283

为了使用 PHP 使 HTML 表的行“动态”，您应该使用[foreach()](http://php.net/manual/en/control-structures.foreach.php)控制结构。例如，假设您有一些代码从数据库中获取数据并将其作为数组或某种实现 Iterable 接口的结果语句返回（我们称之为`$results`），那么您可以：

```
<table>

<thead>
   <tr>
      <th>File Name</th>
      <th>Description</th>
   </tr>
</thead>    

<tbody>
<?php
   foreach($results as $result)
   {
      // Start row
      echo("<tr>");

         echo("<td>" . $result->filename . "</td>");
         echo("<td>" . $result->description . "</td>");

      // End row
      echo("</tr>");
   } 
?>
</tbody>

</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:56:48.383

您可以使用循环根据数据库查询的结果填充表。这是我用于我的一个页面的代码：

```
$result = $db->query_read("SELECT dice.RollID AS `Roll`, dice.Limit AS `Limit`,
dice.Value AS `Value`, dice.Dateline AS `Dateline`, dice.Comment AS `Comment`
FROM dice
ORDER BY Dateline DESC LIMIT 25");

// ###### MAIN CODE ######
$str = '<table>
<tr><th>ID</th><th>Roll</th><th>Time</th><th>Comment</th></tr>';

while ($resultLoop = $db->fetch_array($result)) {

    $ID = $resultLoop["Roll"];
    $roll = $resultLoop["Value"] . '/' . $resultLoop["Limit"];
    $when = date('m-d-Y H:i:s', $resultLoop["Dateline"]);
    $comment = $resultLoop["Comment"];

    $str .= '<tr>
    <td>' . $ID . '</td>
    <td>' . $roll . '</td>
    <td>' . $when . '</td>
    <td>' . $comment . '</td></tr>';
}

$str .= '</table>';
echo $str; 
```

需要注意的一点是，我使用 $db->* 函数，因为它与论坛软件集成。您应该使用此处找到的 mysqli_* 函数：http: [//php.net/manual/en/book.mysqli.php](http://php.net/manual/en/book.mysqli.php)

# javascript - CSRF - 伪造的 POST 可以包含任意数据吗？

> ID：10788538
> 
> 赞同：5
> 
> 时间：2012-05-28T17:42:53.523
> 
> 标签：javascript, post, security, csrf

不受信任的网站可以通过创建表单并将其发布到目标站点来构造伪造的 POST 请求。但是，此 POST 的原始内容将由浏览器编码为以下格式：

```
param1=value1&param2=value2 
```

*不受信任的网站*是否有可能构建包含*任意*原始内容的伪造 POST——例如字符串化的 JSON？

```
{param1: value1, param2: value2} 
```

换句话说： **网站可以使浏览器向第三方域发布*任意内容吗？***

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:26:24.213

HTML 表单请求的 POST 正文始终是[*application/x-www-form-urlencoded*](http://www.w3.org/TR/html5/form-submission.html#application-x-www-form-urlencoded-encoding-algorithm)、[*multipart/form-data*](http://www.w3.org/TR/html5/form-submission.html#multipart-form-data-encoding-algorithm)或[*text/plain*](http://www.w3.org/TR/html5/form-submission.html#text-plain-encoding-algorithm)[`enctype` ，因为它们反映了属性](http://www.w3.org/TR/html5/attributes-common-to-form-controls.html#attr-fs-enctype)的有效值。尤其[`text/plain`是可以用来形成有效的 JSON 数据](http://pentestmonkey.net/blog/csrf-xml-post-request)。所以这里可以使用基于表单的 CSRF，但是，它需要服务器接受它为`text/plain`.

此外，基于 XHR 的 CSRF 可以用作[XMLHttpRequest API 允许发送任意 POST 数据](http://www.w3.org/TR/XMLHttpRequest/#the-send-method)。唯一剩下的障碍是同源策略：只有当两者具有相同的来源*或*您的服务器支持[跨域请求共享](http://www.w3.org/TR/cors/)并允许资源共享时，才能伪造此类有效的 POST 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:50:10.427

是的！POST 请求只不过是发送到 Web 服务器的特定格式的文本。您可以使用 IE 或 Chrome 开发人员工具查看每个请求的外观。

所以是的，您可以创建一个伪造的 POST 请求并更改您想要的任何内容，但是如果请求格式不正确，大多数 Web 服务器将拒绝它。

[https://www.rfc-editor.org/rfc/rfc2616](https://www.rfc-editor.org/rfc/rfc2616)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:03:03.577

网站的客户端代码很难伪造这样的请求，但服务器端代码可以很容易地做到这一点。

由于您的网站无法判断请求是来自浏览器还是行为类似于浏览器的服务器，所以浏览器的限制是没有保护的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-10T15:36:00.100

您可以通过常规表单帖子创建有效的 JSON。这只是创造性地命名表单参数的问题。特别是，参数名称可以包含引号。

[http://blog.opensecurityresearch.com/2012/02/json-csrf-with-parameter-padding.html](http://blog.opensecurityresearch.com/2012/02/json-csrf-with-parameter-padding.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T17:58:53.933

在纯 HTML 表单的情况下，是的，它将始终根据[规范](http://www.w3.org/TR/html4/interact/forms.html#h-17.13.3.3)进行编码。但还有[其他编码方案](http://www.w3.org/TR/html4/interact/forms.html#adef-enctype)，例如 MIME multipart。还有 Javascript 和[XMLHttpRequest](http://www.w3.org/TR/XMLHttpRequest/#the-send-method)的问题。仅在一种情况下特别提到了编码。这强烈暗示在其他情况下没有应用编码。

# javascript - 不使用 Wordpress 的页面上的 Wordpress 小部件

> ID：10788539
> 
> 赞同：0
> 
> 时间：2012-05-28T17:42:55.967
> 
> 标签：javascript, html, wordpress, widget

我对我网站的新闻部分使用 wordpress 博客格式，但不是主要部分，我希望从 wordpress 部分绘制“最新”小部件，但显示在不使用博客的页面上，它主要写在html 和 javascript。这是可能的吗？如果是的话，有没有人可以指出我的例子？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:53:52.660

我认为这是不可能的——Widget API 是在 WordPress 加载过程中的某个地方加载的，因此您需要一个 PHP 渲染引擎来加载整个 WP 并在最后评估小部件代码。您将需要一些 PHP 来从数据库中获取数据，或者至少需要 AJAX 代码来调用从 MySQL 数据库中提取帖子的外部脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-12T16:23:32.357

~~使用 iframe 可能是可能的，但我（和大多数开发人员一样）强烈建议不要这样做。W3C 与 iframe 的合规性可能会很棘手，但如果您不担心这一点，那就试试看。~~再想一想，iframe 甚至都不是一个可行的选择。只需使用类似这样的方法将 RSS 拉入您的 HTML 页面（[http://www.htmlgoodies.com/beyond/css/displaying-rss-feeds-with-xhtml-css-and-jquery.html](http://www.htmlgoodies.com/beyond/css/displaying-rss-feeds-with-xhtml-css-and-jquery.html)）来自 HTMLGoodies.com。

另一种选择可能是使用此处 FLD Trace 概述的方法：[http://www.fldtrace.com/wordpress/display-latest-post-outside-of-wordpress-with-json-and-jquery](http://www.fldtrace.com/wordpress/display-latest-post-outside-of-wordpress-with-json-and-jquery)，并在这里展示：[http://www.fldtrace.com/lab/jsonAPI.html](http://www.fldtrace.com/lab/jsonAPI.html)。

我之前在几个项目中使用过它并取得了轻微的成功，并相应地设置了 FLDT 小部件的样式。如果您使用它并且它符合您正在寻找的东西，请务必在信用到期时给予信用 - 尽管我没有看到 FLD Trace 方法的任何许可限制。

# android - 如何在自定义对话框上动态添加组件？

> ID：10788541
> 
> 赞同：0
> 
> 时间：2012-05-28T17:42:59.383
> 
> 标签：android

假设我有一个 listView 有一些这样的公式：

```
((A * 2 + B * 3 + PF * 5) / 10) 
```

当我单击它时，我想将字母更改为`EditTexts`，所以我将其拆分`String`，如果它是一个字母，我应该用 EditText 替换它，那么，我应该用什么来实现呢？我的意思是，我可以在“对话框样式”窗口上加载一个活动吗？或者我可以使用简单对话框来完成这项工作？

我已经尝试过了，但是添加视图时出现错误（`NullPointerException`）

```
lsView.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() {

@Override
public boolean onItemLongClick(AdapterView<?> aView, View view,
            int i, long l) {
    Dialog dialogFormula = new Dialog(NotasActivity.this); //"Parent" activity

    dialogFormula.setTitle("Title");

    LinearLayout layout = (LinearLayout)findViewById(R.id.DialogLayout);
    String[] lines = materias.get(i).getFormula().split(" ");
    for (String s : lines) {
        if (s.compareTo("PARTIC") == 0) {
            EditText edtPartic = new EditText(dialogFormula.getContext));
            layout.addView(edtPartic);
        } else if (s.contains("A") && s.compareTo("A") != 0) {
        } else if (s.compareTo("B") == 0) {
        } else if (s.compareTo("C") == 0) {
        } else if (s.compareTo("D") == 0) {
        } else if (s.compareTo("E") == 0) {
        } else if (s.compareTo("F") == 0) {
        } else if (s.compareTo("G") == 0) {
        } else if (s.compareTo("H") == 0) {
        } else if (s.compareTo("I") == 0) {
        } else if (s.compareTo("PF") == 0) {
    } 
                }
    dialogFormula.setContentView(layout);
    return false;
}
}); 
```

对话框公式.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" 
android:id="@+id/DialogLayout">

<TextView
    android:id="@+id/txtMateriaDialog"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/txtFormulaDialog"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:52:46.993

我建议你制作一个自定义对话框类。

```
public class FormulaDialog extends Dialog {

    public FormulaDialog(Context c) {
        super(c);
        setTitle("Title");
        setContentView(R.layout.dialog_formula);
    }

    public void updateLayout(String[] lines) {
        LinearLayout layout = (LinearLayout)findViewById(R.id.DialogLayout);
        for (String s : lines) {
            if (s.compareTo("PARTIC") == 0) {
                EditText edtPartic = new EditText(dialogFormula.getContext));
                layout.addView(edtPartic);
            } else if (s.contains("A") && s.compareTo("A") != 0) {
            } else if (s.compareTo("B") == 0) {
            } else if (s.compareTo("C") == 0) {
            } else if (s.compareTo("D") == 0) {
            } else if (s.compareTo("E") == 0) {
            } else if (s.compareTo("F") == 0) {
            } else if (s.compareTo("G") == 0) {
            } else if (s.compareTo("H") == 0) {
            } else if (s.compareTo("I") == 0) {
            } else if (s.compareTo("PF") == 0) {
            }
        }
    }
} 
```

然后在您的活动中，您只需运行

```
String[] lines = materias.get(i).getFormula().split(" ");
FormulaDialog mFormulaDialog = new FormulaDialog(this);
mFormulaDialog.updateLayout(lines);
mFormulaDialog.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:40:48.780

findViewById() 仅返回传递给当前 Activity 的 setContentView() 的 XML 中的视图，通常这是您的第一个 Activity 的 main.xml。由于`DialogLayout`在不同的 XML 中，因此该行返回 null：

```
LinearLayout layout = (LinearLayout)findViewById(R.id.DialogLayout); 
```

您想膨胀`dialog_formula.xml`、修改它，然后将此 XML 传递给您的 Dialog；像这样：

```
View view = getLayoutInflater().inflate(R.layout.dialog_formula, null, false);

LinearLayout layout = (LinearLayout) view.findViewById(R.id.DialogLayout);
// Add your new EditTexts here

AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Title");
builder.setView(view);
dialog = builder.create(); 
```

为了解析你的公式，我有两个不同的建议：

*   保留每个公式的用户变量计数，而不是一遍又一遍地解析相同的字符串。
*   如果您必须解析，请像这样测试您的字符串：

    ```
    if("ABCDEFGHIPF".contains(s))
        // Add EditText
    else if(s.contains("PARTIC"))
        // Do something special
    // The rest are numbers or symbols 
    ```

# c++ - 如何有效地在 C 中存储字符串的映射？

> ID：10788546
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:43:38.557
> 
> 标签：c++, c, string, hash

```
For example if i have to store many entries like in C
hash["1"]="11"
hash["2"]="12"
hash["11"]="21" 
```

条件是：你只寻找连续的相同数字，所以只保留那些在地图上。

就像这些用于解决问题的许多条目一样。我们可以使用一些技术，例如添加 ASCII 值的总和来查找索引，然后使用一些 mod 函数。

但是这种方法并不能保证不会发生碰撞，即使发生了一次碰撞，整个问题也会出错。

这可以在 C++ 中轻松完成吗？

请提供一些建议/提示。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:56:55.933

关于散列函数：没有散列函数可以保证不会发生冲突。他们只能尽量减少典型工作负载中发生冲突的机会。一种经常使用的散列函数是伯恩斯坦散列函数。[您可以在此处](http://en.literateprograms.org/Hash_function_comparison_%28C,_sh%29)找到不同字符串哈希函数（包括 bernstein）的比较

在 C++ 中，您可以简单地使用标准`map`（参见[此处](http://en.cppreference.com/w/cpp/container/map)）模板，该模板不使用哈希映射，但通常使用红黑树实现。C++11 标准有一个`unordered_map`（参见[此处](http://en.cppreference.com/w/cpp/container/unordered_map)），它是使用散列函数实现的。

# azure - Azure BLOB 的实体组事务？

> ID：10788548
> 
> 赞同：1
> 
> 时间：2012-05-28T17:43:46.693
> 
> 标签：azure, azure-storage, azure-table-storage, azure-blob-storage

假设单击按钮后我需要从 Azure BLOB 检索 20 个缩略图。我读过 blob 是这样访问的`http://<storage account>.blob.core.windows.net/<container>/<blob>`

单个 GetBlob() 请求按 1 笔交易收费。这是否是说获得 20 张图像至少需要 20 次交易？

有没有办法发送批处理请求，以便检索这些图像并按 1 笔交易计费？

我读过有关实体组事务的信息，但在我看来它们仅适用于 Azure 表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:51:59.913

没有什么类似于带有 blob 的实体组事务。每个都单独访问，至少燃烧一个事务（取决于 blob 大小）。

以每~~10,000~~ 100,000 笔交易一分钱计算，这可能不是主要的成本因素，除非您经常下载 blob。在这种情况下，可能值得考虑某种类型的缓存，以防止针对 Blob 存储的过度活动。

另一种解决方法（hack？）：如果您总是抓取一组相关的 blob，您可以将相关的集合存储在一个 zip 文件中，在一个 blob 中。并不是说我赞成这一点，但如果您需要保存事务，至少它是一个选项（除了缓存）。

看看[这篇 MSDN 文章](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/05/10/windows-azure-storage-abstractions-and-their-scalability-targets.aspx)，它描述了存储以及分区如何与 blob 和表相关（向下滚动到**分区**部分）。适合您的相关信息：每个 blob 都在其自己的分区中。使用表存储，您可以对单个分区内的实体执行原子操作（没有跨多个分区的原子操作）。这就是为什么您看不到跨多个 blob 的原子操作的原因。

# string - 获取序列的特定子字符串

> ID：10788551
> 
> 赞同：1
> 
> 时间：2012-05-28T17:43:51.913
> 
> 标签：string, r

我在 R 中创建了以下矩阵：

```
positions = cbind(seq(from = 20, to = 68, by = 4),seq(from = 22, to = 70, by = 4)) 
```

我还有以下字符串：

```
"SEQRES   1 L   36  THR PHE GLY SER GLY GLU ALA ASP CYS GLY LEU ARG PRO          " 
```

我正在尝试使用应用函数来制作一个子字符串列表（mystring，start.position，end.position），其中第一个索引来自位置 [，1]，第二个来自位置 [，2]。我可以使用 for 循环轻松完成此操作，但我认为 apply 会更快。

我可以让它按如下方式工作，但我想知道是否有更清洁的方法：

```
parse.me = cbind(seq(from = 20, to = 68, by = 4),seq(from = 22, to = 70, by = 4), input)
apply(parse.me, MARGIN = 1, get.AA.seqres)

get.AA.seqres <- function(items){
start.position = as.numeric(items[1])
end.position = as.numeric(items[2])
string = items[3]
return (substr(string, start.position, end.position)  )
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:29:49.660

尝试这个：

```
> substring(input, positions[, 1], positions[, 2])
 [1] "THR" "PHE" "GLY" "SER" "GLY" "GLU" "ALA" "ASP" "CYS" "GLY" "LEU" "ARG" "PRO" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:07:09.050

我喜欢 Andrie 的实用建议，但如果您出于其他原因需要走这条路，您的问题听起来可以通过以下方式解决`Vectorize()`：

```
#Your data
positions = cbind(seq(from = 20, to = 68, by = 4),seq(from = 22, to = 70, by = 4))
input <- "SEQRES   1 L   36  THR PHE GLY SER GLY GLU ALA ASP CYS GLY LEU ARG PRO          "

#Vectorize the function substr()
vsubstr <- Vectorize(substr, USE.NAMES = FALSE)
vsubstr(input, positions[,1], positions[,2])
#-----
[1] "THR" "PHE" "GLY" "SER" "GLY" "GLU" "ALA" "ASP" "CYS" "GLY" "LEU" "ARG" "PRO"

#Or, read the help page on ?substr about the bit for recycling in the first paragraph of details

substr(rep(input, nrow(positions)), positions[,1], positions[,2])
#-----
[1] "THR" "PHE" "GLY" "SER" "GLY" "GLU" "ALA" "ASP" "CYS" "GLY" "LEU" "ARG" "PRO" 
```

# php - YII - 在选中复选框时更改 2 个字段的值

> ID：10788554
> 
> 赞同：0
> 
> 时间：2012-05-28T17:44:11.017
> 
> 标签：php, yii

我想在选中复选框时更改其他 2 个字段的值。

我有一个名为“Cancelquery”->复选框的字段。如果它被选中，那么我想

1.  自动设置字段“状态”的值 -> 取消和
2.  自动选择“原因”字段的值为“其他”。

我正在为此字段使用模型，因此每个字段的名称和 ID 都是自动创建的。

例如。`$form->checkBox($model,'CancelQuery')`

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:38:04.513

您必须指定要呈现复选框的其他 html 选项。在您的情况下，您可以尝试以下操作：

```
echo $form->checkBox($model,'CancelQuery',array('onchange'=>'doOtherThings(this);'));
echo $form->textField($model, 'status', array('id'=>'status'));
echo $form->textField($model, 'reason', array('id'=>'reason')); 
```

在您的 js 区域中，有如下函数：

```
function doOtherThings(element){
    var checked = $(element).is(':checked');
    if (checked) {
        $('#status').val('Cancelled');
        $('#reason').val('Other');
    } else {
        // reset values
        $('#status').val('');
        $('#reason').val('');
    }
} 
```

# c++ - 两个数组下标重载读写

> ID：10788557
> 
> 赞同：1
> 
> 时间：2012-05-28T17:44:23.083
> 
> 标签：c++, arrays, class, operator-overloading, setter

我想要一个具有两个数组下标运算符重载的类：一个用于读取，另一个用于写入。

目的是保持变化。我读到（在[http://faculty.cs.niu.edu/~mcmahon/CS241/c241man/node97.html](http://faculty.cs.niu.edu/~mcmahon/CS241/c241man/node97.html)）我可以做这样的事情：

```
template<typename T>
class Array
{
public:
    Array()
    {
        data = new T[100];
    }

    T &operator[] (int index)
    {
        cout << "Is writing\n";
        changes++;
        return data[index];
    }

    T operator[] (int index) const
    {
        cout << "Is reading\n";
        return data[index];
    }

private:
    T *data;
    int changes;
}; 
```

但这在我的情况下不起作用。我正在使用带有 -std=c++11 的 g++ 4.7，实际上只有“正在写作”打印在屏幕上，即使我这样做：

```
Array<int> a;
a[0] = 3;
cout << a[0] << endl; 
```

我还注意到，后者永远不会通过使用 gcov 检查源来调用。该页面上的方法是完全错误的，还是我误解了？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:46:06.700

`const``this`仅当is时才调用重载`const`。不确定是“读”还是“写”操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:05:50.200

这只是一个粗略的想法，我还没有考虑所有的含义，但是具有重载赋值和强制转换运算符的代理类可以解决您的问题：

```
template<typename T>
class CountingProxy
{
public:
    CountingProxy(int& counter, T& ref) : counter_(counter), ref_(ref)
    {
    }

    CountingProxy<T>& operator=(const T& o)
    {
        cout << "Is writing\n";
        counter_++;
        ref_ = o;
        return *this;
    }

    operator T()
    {
        cout << "Is reading\n";
        return ref_;
    }

private:
    int& counter_;
    T& ref_;
};

template<typename T>
class Array
{
public:
    Array()
    {
        data = new T[100];
    }

    CountingProxy<T> operator[] (int index)
    {        
        return CountingProxy<T>(changes, data[index]);
    }

    T operator[] (int index) const
    {
        cout << "Is reading\n";
        return data[index];
    }

private:
    T *data;
    int changes;
}; 
```

另一方面，通过实现单独的函数来读取和写入数组元素，例如 和 ，您可能会`T& get(int index)`更好。`const T& get(int index) const``void put(int index, const T& value)`

# php - WideImage PHP插件错误调整高度

> ID：10788559
> 
> 赞同：0
> 
> 时间：2012-05-28T17:44:24.393
> 
> 标签：php, plugins

我正在使用这个 PHP 插件进行图像处理：[http ://wideimage.sourceforge.net/](http://wideimage.sourceforge.net/)

这是我的代码：

```
WideImage::load('images/image_test.jpg')

-> resize(300, 150)
-> output('jpg'); 
```

这是结果：

![在此处输入图像描述](../Images/9951bfc6e2752c99a88ebfbe3e2ae392.png)

如果您查看屏幕截图的尺寸，您会发现它们与我告诉的尺寸不一致。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:52:04.187

好吧，看起来它试图保持纵横比（高度/宽度）。您可能不想让图像变平或拉伸，但应该有一个设置。也许将`$fit`参数设置为“填充”会有所帮助：[http ://wideimage.sourceforge.net/wp-content/current/doc/WideImage/WideImage_Image.html#methodresize](http://wideimage.sourceforge.net/wp-content/current/doc/WideImage/WideImage_Image.html#methodresize)

LE：另一方面，如果你想改变图像大小而不改变其纵横比，也许你应该考虑[裁剪。](http://wideimage.sourceforge.net/wp-content/current/doc/WideImage/WideImage_Image.html#methodcrop)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:09:02.150

答案（感谢 Mihai Todor）：

```
WideImage::load('images/image_test.jpg')

-> resize(300, 150, 'fill')
-> output('jpg'); 
```

显然它需要填充语句。

# mysql - 计费触发器的数据库设计

> ID：10788563
> 
> 赞同：1
> 
> 时间：2012-05-28T17:44:58.563
> 
> 标签：mysql, sql, oracle, postgresql, triggers

我正在为一个系统设计一个数据库，在该系统中，定期、自定义的时间间隔发生计费。因为可以自定义间隔，所以我需要能够定期处理账单，甚至可能每天。我希望这是数据库本身的一个功能，这样界面就不需要管理它，这可能是有问题的。

我知道数据库触发器通常使用 DML 语句。有没有办法在 MySQL、PostgreSQL 或 Oracle 中创建触发器或自动函数，以便能够每天处理帐单，而无需使用数据库外部的任何东西来触发它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:54:50.830

使用 oracle，您将使用[dbms_scheduler 包](http://www.orafaq.com/wiki/DBMS_SCHEDULER)

对于 MySQL，[Event Scheduler](http://dev.mysql.com/doc/refman/5.1/en/events.html)似乎做了类似的事情（取自 Nicos 评论）

不会有适用于所有这些数据库的单一解决方案。如果你需要跨平台的东西，你可能会尝试一个操作系统解决方案，比如[unix 上的 cron](http://kb.iu.edu/data/afiz.html)或基于你开发的系统上存在的其他语言的东西。例如[用于 Java 的 Quartz 调度程序](http://quartz-scheduler.org/)

# apache2 - 服务于 web2py/apache2 的静态文件

> ID：10788567
> 
> 赞同：0
> 
> 时间：2012-05-28T17:45:26.423
> 
> 标签：apache2, web2py

我有一个带有 web2py (1.89) 和 Apache2 的设置，如 web2py 书中的示例。Apache 应该根据此指令提供静态文件，但它没有：

```
AliasMatch ^/([^/]+)/static/(.*)
/users/www-data/web2py/applications/$1/static/$2
<Directory /users/www-data/web2py/applications/*/static/>
Order Allow,Deny
Allow from all
</Directory> 
```

我找不到问题所在。

原来的帖子有'^'而不是'^'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:57:05.453

我认为您是从 PDF 手册中复制的。这不是一个插入符号，它是一个看起来像插入符号的 unicode 字符。

Apache 没有抱怨，但并不认为它是一种模式的开始。

# wcf - WCF 服务记录加密数据

> ID：10788570
> 
> 赞同：2
> 
> 时间：2012-05-28T17:45:37.520
> 
> 标签：wcf, web-services, wcf-security, x509certificate

我有一个由客户端 X509 保护的 WCF 服务，它们按预期工作。

我正在尝试在服务器端记录消息并查看解密的消息。但是我在日志中得到的是加密消息。

我设置了 logMessagesAtServiceLevel="true"。请帮我找出我的配置问题。

以下是配置：

```
 <system.serviceModel>

.. service definition here...

<diagnostics>
  <messageLogging
       logEntireMessage="true"
       logMalformedMessages="false"
       logMessagesAtServiceLevel="true"
       logMessagesAtTransportLevel="false"
       maxMessagesToLog="3000"
       maxSizeOfMessageToLog="2000"/>
</diagnostics>
</system.serviceModel>

<system.diagnostics>
<sources>
  <source name="System.ServiceModel"
      switchValue="Verbose, ActivityTracing"
      propagateActivity="true" >
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
  <source name="System.ServiceModel.MessageLogging"
      switchValue="Verbose">
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
  <source name="Microsoft.IdentityModel"
      switchValue="Verbose">
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
</sources>
  <sharedListeners>
  <add name="xml"
     type="System.Diagnostics.XmlWriterTraceListener"
     initializeData="c:\log\Traces.svclog" />
</sharedListeners >
<trace autoflush="true" />
</system.diagnostics>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:18:05.770

设置 logMessagesAtTransportLevel=true 查看加密消息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T05:44:23.003

只为完成，

我的问题中给出的相同配置有效。但是，我不得不像这样增加 maxsizeofmessagetolog

maxSizeOfMessageToLog="200000"

# java - 扫描非本地主机上的端口

> ID：10788576
> 
> 赞同：1
> 
> 时间：2012-05-28T17:46:13.067
> 
> 标签：java, network-programming, port-scanning

我正在用 Java 编写端口扫描器。我正在使用 for 循环来计算从 0 到 100 的端口，在每个端口上构造一个套接字并查看它是否引发异常。但是，当我尝试扫描诸如“www.google.com”之类的非本地端口时，它会扫描第一个端口然后停止（实际上程序只是等待），如果有人知道这是为什么，我想知道。这是扫描方法的代码。请注意变量 ia 是一个 InetAddress 对象

```
private void scan(int low, int high){
    for(int port =low; port<high; port++){
    try {
    connection = new Socket(ia, port);
    r.addPort(port);
    System.out.println("port "+port+" open");
    connection.close();
    } catch (IOException e) {
    System.out.println("port "+port+" not open");
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:03:23.640

尝试在套接字上设置超时。它会更快地失败。

`connection.setSoTimeout(10*1000); // milliseconds`

# python - 在python中使用ctypes时如何抑制stdout？

> ID：10788581
> 
> 赞同：2
> 
> 时间：2012-05-28T17:46:38.523
> 
> 标签：python, ctypes

我正在使用 ctypes 为 ac 库编写一些绑定：

```
from ctypes.util import find_library
from ctypes import *

lib = find_library("lvm2app")

if not lib:
    raise Exception("LVM library not found.")

lvmlib = CDLL(lib) 
```

一切都很好，除了库不时打印到标准输出，这有点烦人。有没有办法可以压制这些印刷品？谢谢。

# c# - FindAll 在 nhibernate 中的最佳实践

> ID：10788590
> 
> 赞同：1
> 
> 时间：2012-05-28T17:47:26.737
> 
> 标签：c#, linq, nhibernate

我有许多子实体的顶级实体。

现在，我想实现 FindAll() 方法，在该方法中我使用此模式将所有顶级实体查询到 List。没关系，但我随后得到了我所有的子对象，警报：在 nhib 中选择 N+1。探查器。

获得所有对象后，我将它们发送到 FromMyDomainModel 方法以将值提取到我需要的 ViewModel。

```
 using (ITransaction transaction = session.BeginTransaction())
   {
       List<Property> data =
                   session.Query<Property>()//I don't need fetch
                   .ToList();
        transaction.Commit();
        return EntityViewModel.FromDomainModel(data);
    } 
```

也许有更好的模式，所以请随时发布。

**更新：** 从映射映射代码你可以算出我的实体代码

```
 public PropertyMap()
        {
            Table("Property");
            Id(x => x.Id).GeneratedBy.Identity();
            Map(x => x.Version);
            Map(x => x.Created);
            Map(x => x.Updated);
            Map(x => x.Views);
           ....
            Map(x => x.Price);            
            HasMany(x => x.Photos).KeyColumn("PropertyId").Cascade.All();
        }

 public PhotoMap()
        {
            Table("Photo");
            Id(x => x.Id).GeneratedBy.Identity();
            Map(x => x.ImageData).CustomSqlType("VARBINARY(MAX)").Length(160000).Not.Nullable();
            Map(x => x.ImageMimeType).Not.Nullable();
            References(x => x.Property).Column("PropertyId");

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:38:12.590

为了减少`select n+1`问题，您需要设置`batch-size`

NH3.2+ 默认将**加载**批量大小设置为 20，因此如果您可以升级，那么我会推荐它。见[这里](https://github.com/nhibernate/nhibernate-core/blob/master/releasenotes.txt)[NH-2593]

如果您无法升级并且正在使用 XML 映射，则执行以下操作：-

```
<bag/set/list ... batch-size='50' ..>
...
</bag/set/list> 
```

如果您不使用 XML 映射，请发布一个映射示例。

**根据您更新的映射进行编辑**

试试这个并重新配置，你应该看到你的 n+1 减少了 50

```
HasMany(x => x.Photos).KeyColumn("PropertyId")
  .SetAttribute("batch-size", "50").Cascade.All(); 
```

您还可以在构建会话工厂之前在配置中设置此批量大小，以便它适用于所有集合获取。

# java - 访问安全域时出现 EJBAccessException

> ID：10788593
> 
> 赞同：1
> 
> 时间：2012-05-28T17:47:39.103
> 
> 标签：java, security, ejb, jboss7.x, rbac

我正在尝试使用 EJB 运行一个简单的 RBAC 示例，但是当客户端从具有 SecurityDomain 的类中调用方法时，我得到： javax.ejb.EJBAccessException: JBAS013323: Invalid User.

这是我的设置：

*   服务器项目
    *   EJB 3.1
    *   JBoss AS 7.1
    *   Picketbox（下载附带的 3 个 jar 文件）

客户端是一个简单的java项目

我以后要保护的服务器项目中的类如下所示：

```
@Stateless
public class SomeBean implements SomeRemote, SomeLocal {
  @Override 
  public void unsecuredMethod(Object obj) {     
    //do something
  }
} 
```

在 META-INF 的 jboss-ejb3.xml 中，我有：

```
<?xml version="1.0"?>  
<jboss:ejb-jar xmlns:jboss="http://www.jboss.com/xml/ns/javaee"
              xmlns="http://java.sun.com/xml/ns/javaee"
              xmlns:s="urn:security"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-ejb3-2_0.xsd
                 http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd"
              version="3.1"
              impl-version="2.0">
<assembly-descriptor>
  <s:security>
    <ejb-name>SomeBean</ejb-name>
    <s:security-domain>SomeDomain</s:security-domain>
  </s:security>
</assembly-descriptor>
</jboss:ejb-jar> 
```

我使用这个文件是因为我无法导入 org.jboss.ejb3.annotation.SecurityDomain 注释。（也许我有错误的依赖关系？）

在 jboss-as-7.1.0.Final\standalone\configuration 的standalone-full.xml 中，我有：

```
...
<subsystem xmlns="urn:jboss:domain:security:1.1">
  <security-domains>
  ...
    <security-domain name="SomeDomain" cache-type="default">
      <authentication>
        <login-module code="Database" flag="required">
          <module-option name="dsJndiName" value="java:/DefaultDS"/>
          <module-option name="principalsQuery" value="SELECT password FROM Customer WHERE username=?"/>
          <module-option name="rolesQuery" value="SELECT rolename, 'Roles' FROM Role WHERE username=?"/>
          <module-option name="unauthenticatedIdentity" value="guest"/>
        </login-module>
      </authentication>
    </security-domain>
  </security-domains>
</subsystem>
... 
```

无论我是否尝试在客户端内进行身份验证，都会发生异常

```
SecurityClient secClient =     
SecurityClientFactory.getSecurityClient();          
secClient.setSimple("username1", "password1");
secClient.login(); 
```

或者，如果我不对他进行身份验证（因为：name="unauthenticatedIdentity" value="guest"），那么就使用客户应该收到的来宾角色。另一件事是，即使我提供了错误的凭据，似乎也不会抛出来自 SecurityClient 的 LoginException。在此之后，我对 SomeBean 类进行正常查找并将其转换为 SomeRemote。调用 unsecuredMethod(..) 时会发生异常。我对两者都进行了尝试，给来宾用户一个角色表中的角色，而没有。

在客户端项目中，除了使用 SecurityClient 和查找之外，我没有做任何与 rbac 或 ejb 相关的事情，我希望这是正确的。

也许有一些很好的教程可以解释一切。我可能会遇到问题，因为我的解决方案基于 Jboss AS 6 教程。

**Edit:** After searching the internet for this exception for hours I found a hint in a book that says that if jboss cannot find the database tables used for authentication you will always get the message: "Invalid User". So probably i have a problem with my data source configuration.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T10:39:31.107

If this is an EJB being accessed remotely you will also need to update the security realm (ApplicationRealm) associated with the Remoting connector to use a jaas reference to your security domain so that the user can be authenticated on the inbound connection.

# ado.net - 使用连接池处理 SqlConnection？

> ID：10788594
> 
> 赞同：1
> 
> 时间：2012-05-28T17:47:41.630
> 
> 标签：ado.net, connection-pooling

如果连接池打开，那么连接实际上是始终打开的。连接的唯一区别是连接是返回到池中还是正在使用中。关闭它会将其返回到池中，但连接仍处于打开状态。这是正确的吗？如果这是真的，

- 那么我认为在使用连接池时调用 Connection.Dispose() 总是不好的，

由于处置就像破坏连接，实际上您只想将连接返回到池中。**下次您使用池中的连接时，它会非常快，因为该连接仍然坚持在池中保持打开连接所需的资源。**您不希望来自池的连接重新获取它需要的非托管资源，因为这会降低性能。**所以关键是，让 sqlconnection 坚持资源 - 托管或非托管，只要它在池中。**这听起来对吗？当我们处置一个对象时，这意味着我们不想重复使用它，但是这里我们打算使用池中的连接，所以为什么要处置它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T04:35:15.093

我很确定你的权利。几年前，当我研究 IDisposable 并撰写文章时，我使用反射器跳入了框架，与许多其他 IDisposable 对象不同，这些对象具有像 Close() 或 Free() 这样的替代方法，它们只调用 Dispose()，反之亦然， SqlDbConnection 对象做不同的事情，其中​​之一是集合池。

不幸的是，由于“using”结构非常易于使用，如今的许多代码示例都在“using”表达式中创建了数据库连接，通常是一组嵌套 usings 中最突出的。

您可以通过“尝试”和“最终”保护来实现相同的目的，您可以在其中检查连接是否为空并且在调用 close 之前打开。这是 VB 程序员在获得“using”关键字之前必须这样做的方式。

另一种方法，虽然我肯定会因为建议它而受到一些批评，但是将连接包装在另一个薄 IDisposable 对象中，该对象采用并公开一个 IDbConnection 对象并在包装器 Dispose() 内的连接上调用 Close()。它没有正确遵循 IDisposable 模式，但是如果您知道为什么要这样做，了解影响并且不向任何人隐藏它（不导出代码或声明行为），那么我真的看不出问题。上次我使用这个技巧时，我将它设为通用类型，这样我就可以点击具体的 DB Connection 类型，而无需为那些不接受 IDbConnection 的函数强制转换它。

# java - 发送文件或输出流更好

> ID：10788595
> 
> 赞同：1
> 
> 时间：2012-05-28T17:47:43.077
> 
> 标签：java, file, rest, hbase, fileoutputstream

在我的项目中，我们正在保存一些文件。当请求文件时，我从 HBase 表中获取文件，然后将其发送到浏览器。

数据以字节为单位保存在 HBase 中。因此，当我获取文件时，我以字节为单位。

现在我必须将这些字节转换为文件对象或输出流。

我想知道是通过 File 对象发送文件还是输出流更好？

该文件可以从 1 MB 到 10 MS 不等。

我正在使用 REST API 发送数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:52:05.703

您在做什么并不完全清楚，但事实是 a`java.io.File`只是路径上的抽象，因此它不包含任何数据。`java.io.File`因此，如果您想要发送实际文件内容，我认为发送对象不会对您有任何帮助。

`OutputStream`发送一个仅用于控制字节流到给定接收器的类也没有任何意义。`OutputStream`您发送的是字节，而不是流（即，如果您的接收器是一个套接字，那么使用与此给定接收器关联的套接字通过套接字发送文件内容的字节是有意义的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:15:25.107

发送 java.io.File 对象将无济于事，因为它将是一个非常**特定于 java 的二进制对象**，并且它将要求接收系统在 java 中。

您提到，您正在**使用 REST**。现在这需要**独立于任何技术/平台**的东西。

一种可行的方法如下。

1.  让其余 API 返回一个指向用户希望下载的文件的 URL。
2.  为此 URL[编写/配置一个 Servlet 。](http://onjava.com/onjava/excerpt/jebp_3/index3.html)
3.  当这个 servlet 接收到请求时，它会读取数据库并写入响应流（输出流）。
4.  用户将收到要求下载文件的提示。

这是使用 servlet[下载 PDF 文件的示例。](http://www.javaworld.com/javatips/jw-javatip94.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:15:42.520

我假设问题是询问是直接写入 OuputStream 还是先将 byte[] 保存到本地文件。我能想到首先保存到本地文件的唯一原因是将检索与 HBase 和用户下载分离。如果您希望从 HBase 返回 byte[] 的每个请求在响应中将整个文件返回给用户，请使用 OutputStream。

话虽如此，检索 10 MB 作为 byte[] 似乎每个请求可能会消耗大量内存。您可能想看看是否可以让 HBase 为您提供 InputStream，这样您每个请求就不需要多达 10 MB 的 RAM。

# list - Prolog，将术语转换为列表

> ID：10788597
> 
> 赞同：0
> 
> 时间：2012-05-28T17:48:08.060
> 
> 标签：list, prolog, term

你好我有一个谓词返回给定列表的示例均衡

```
equalisation([1,2,3,4,12],L).
L = (1=2-3* (4/12)) 
```

现在我想将此结果更改为如下列表：

```
L = [1,=,2,-,3,*,4,/,12] 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:08:40.690

最简单的解决方案是遍历一个术语创建一个小列表列表，然后将所有内容展平。然而，最简单的解决方案并不是最优雅的解决方案——引用[SWI Prolog flatten/2 手册](http://www.swi-prolog.org/pldoc/man?predicate=flatten/2)：

> 最终需要 flatten/3 通常表明，例如 append/3 用于附加两个列表，这是一个糟糕的设计。从生成的小列表生成列表的高效代码必须使用差异列表，这通常可以通过语法规则来获得最佳可读性。

因此，这是使用差异列表的替代解决方案：

```
t2l(Term, List) :- t2l_(Term, List-X), X = [].

t2l_(Term, [F|X]-X) :- Term =.. [F], !.
t2l_(Term, L1-L4) :- Term =.. [F, A1, A2], 
                     t2l_(A1, L1-L2), 
                     L2 = [F|L3], 
                     t2l_(A2, L3-L4). 
```

显然，当前的解决方案仅适用于二进制操作。如果允许使用任意数量的参数进行操作，则需要再次遍历参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:20:10.533

查看[`(=..)/2`](http://www.swi-prolog.org/pldoc/doc_for?object=%28=..%29/2)操作员的工作方式。

如果您想检查表达式是否相等，请`(=:=)/2`使用`(=)/2`.

# r - 用 R 计算元音频率

> ID：10788600
> 
> 赞同：4
> 
> 时间：2012-05-28T17:48:13.847
> 
> 标签：r, string, frequency

您能否给我一个提示，说明使用 R 计算字符串中元音的绝对频率和相对频率的最佳和最简单的方法是什么？

我猜源代码与我目前在论坛上找到的有关 Java 的内容有点不同。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-28T17:59:19.800

设置一些数据：

```
text <- "Can you please give me a hint on what's the best and easiest way to compute the absolute and relative frequencies of vowels in a string using R?

I guess the source code is a bit different from what I've found so far in the forum concerning Java.

Any help is appreciated." 
```

分析一下：

```
x <- tolower(strsplit(text, "")[[1]])
x <- x[x %in% letters] 
```

绝对频率：

```
table(x)
x
 a  b  c  d  e  f  g  h  i  j  l  m  n  o  p  q  r  s  t  u  v  w  y 
19  3  8  6 29  8  5  8 17  1  5  4 16 14  5  1 11 16 17  9  5  4  3 
```

相对频率：

```
table(x)/length(x)
x
          a           b           c           d           e           f           g           h           i 
0.088785047 0.014018692 0.037383178 0.028037383 0.135514019 0.037383178 0.023364486 0.037383178 0.079439252 
          j           l           m           n           o           p           q           r           s 
0.004672897 0.023364486 0.018691589 0.074766355 0.065420561 0.023364486 0.004672897 0.051401869 0.074766355 
          t           u           v           w           y 
0.079439252 0.042056075 0.023364486 0.018691589 0.014018692 
```

# ubuntu - 空的 Arduino 内存

> ID：10788601
> 
> 赞同：2
> 
> 时间：2012-05-28T17:48:14.480
> 
> 标签：ubuntu, arduino

我正在为Linux Ubuntu 10.04 LTS 上的[Arduino Uno进行开发。](http://arduino.cc/en/Main/ArduinoBoardUno)我上传了一个简单的程序（来自示例步进器），它以某种方式阻止我再次上传。

我收到以下消息。

> avrdude：stk500_recv()：程序员没有响应

有没有办法删除在 Arduino 上运行的程序？也许刷新闪存？

PS：我尝试了很多不同的硬重置/上传组合，但都没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:41:58.527

我通过使用以下组合解决了这个问题：

1.  拔下 USB 连接
2.  重置（使用硬重置按钮）
3.  插入 USB 连接
4.  上传

# java - 初学者在没有 XML 的情况下配置 Spring

> ID：10788603
> 
> 赞同：1
> 
> 时间：2012-05-28T17:49:17.877
> 
> 标签：java, spring

我对 Java 和 Eclipse 相当熟悉，我想我会学习一些关于 Spring 以及如何在没有 XML 的情况下配置 Spring 的知识。现在当我尝试跑步时，我得到了异常

```
May 28, 2012 8:08:33 AM org.springframework.context.support.AbstractApplicationContext prepareRefresh
INFO: Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@173e55db: startup date [Mon May 28 08:08:33 PDT 2012]; root of context hierarchy
Exception in thread "main" java.lang.IllegalStateException: Cannot load configuration class: MessageConfig
at org.springframework.context.annotation.ConfigurationClassPostProcessor.enhanceConfigurationClasses(ConfigurationClassPostProcessor.java:346)
at org.springframework.context.annotation.ConfigurationClassPostProcessor.postProcessBeanFactory(ConfigurationClassPostProcessor.java:222)
at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:681)
at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:620)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:446)
at org.springframework.context.annotation.AnnotationConfigApplicationContext.<init>(AnnotationConfigApplicationContext.java:73) 
```

我的课程非常简单：

```
public class SpringMain {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MessageConfig.class);
        DefaultMessage dmsg = context.getBean("defaultMessage", DefaultMessage.class);
        System.out.println(dmsg);
        }
    }

@Configuration
public class MessageConfig {
    @Bean
    public DefaultMessage defaultMessage() { return new DefaultMessage(); }
}

public class DefaultMessage {
    public DefaultMessage() {}

    private String message = "Spring is here.";

    public String getMessage() { return message; }

    public void setMessage(String message) { this.message = message; }

    @Override
    public String toString() {
        return String.format("DefaultMessage[%s]", message);
    }
} 
```

我添加了几乎所有看起来相关的 jar 文件。我的类路径：

```
org.springframework.beans-3.1.1.RELEASE.jar
org.springframework.context-3.1.1.RELEASE.jar
org.springframework.core-3.1.1.RELEASE.jar
commons-logging-1.1.1.jar
org.springframework.context.support-3.1.1.RELEASE.jar
org.springframework.asm-3.1.1.RELEASE.jar
org.springframework.aop-3.1.1.RELEASE.jar
org.springframework.aspects-3.1.1.RELEASE.jar
org.springframework.expression-3.1.1.RELEASE.jar
org.springframework.instrument.tomcat-3.1.1.RELEASE.jar
org.springframework.instrument-3.1.1.RELEASE.jar
org.springframework.jdbc-3.1.1.RELEASE.jar
org.springframework.jms-3.1.1.RELEASE.jar
org.springframework.orm-3.1.1.RELEASE.jar
org.springframework.oxm-3.1.1.RELEASE.jar
org.springframework.test-3.1.1.RELEASE.jar
org.springframework.transaction-3.1.1.RELEASE.jar
org.springframework.web.portlet-3.1.1.RELEASE.jar
org.springframework.web.servlet-3.1.1.RELEASE.jar
org.springframework.web.struts-3.1.1.RELEASE.jar
org.springframework.web-3.1.1.RELEASE.jar
cglib-2.2.2.jar
asm-4.0.jar
commons-codec.jar
ivy.jar
jets3t.jar
commons-httpclient.jar 
```

那么我错过了什么？为什么无法“加载配置类MessageConfig”？我正在使用 jre7 和 spring 3.1.1。

感谢您的任何建议！

[编辑]

JigarJoshi 建议我添加调用堆栈的其余部分。这里是：

```
Caused by: java.lang.VerifyError: class net.sf.cglib.core.DebuggingClassWriter overrides final method visit.(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)V
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClass(Unknown Source)
at java.security.SecureClassLoader.defineClass(Unknown Source)
at java.net.URLClassLoader.defineClass(Unknown Source)
at java.net.URLClassLoader.access$100(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at net.sf.cglib.core.AbstractClassGenerator.<init>(AbstractClassGenerator.java:38)
at net.sf.cglib.core.KeyFactory$Generator.<init>(KeyFactory.java:127)
at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:112)
at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:108)
at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:104)
at net.sf.cglib.proxy.Enhancer.<clinit>(Enhancer.java:69)
at org.springframework.context.annotation.ConfigurationClassEnhancer.newEnhancer(ConfigurationClassEnhancer.java:136)
at org.springframework.context.annotation.ConfigurationClassEnhancer.enhance(ConfigurationClassEnhancer.java:109)
at org.springframework.context.annotation.ConfigurationClassPostProcessor.enhanceConfigurationClasses(ConfigurationClassPostProcessor.java:336) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T05:28:42.797

我已经成功创建了一个没有任何 xml 配置的 Web 应用程序。我建议您在**MessageConfig**类中执行以下操作。

1.  Put`@EnableWebMvc`注解定义这个类包含 Spring Framework 的 MVC 配置。

2.  `extends WebMvcConfigurerAdapter`这将使您覆盖一些有用的功能，例如`addResourceHandlers(ResourceHandlerRegistry registry)`

据我说，你缺乏这些点。

希望这对您有所帮助。干杯。

# spring - 完全困惑：spring 3.0.5 自动装配的奇怪行为

> ID：10788608
> 
> 赞同：0
> 
> 时间：2012-05-28T17:49:26.497
> 
> 标签：spring, jakarta-ee, spring-mvc, sitemesh, wurfl

我整天都在用一个非常简单的自动装配问题来敲打我的头。提前抱歉发布这个非常简单的问题。我正在使用带有 MVC 的 Spring 3.0.5 运行 Web 应用程序，其中 servlet 上下文与具有所有休眠内容`my-servlet.xml`的应用程序配置分开。`webapp-config.xml`

基本上我想做的是连接`wurfl manager`到一个自定义的`sitemesh Decorator`. 这与 sitemesh 或 wurfl 无关，只是提供了尽可能多的信息。这是该部分的片段：

```
public class MDecoratorMapper extends ConfigDecoratorMapper{
private String decoratorName = null;
@Autowired
WURFLManager wurflManager; // does not work, object is null
private Properties prop;
.........
} 
```

我的应用程序配置`webapp-config.xml`是这样的：

```
 <import resource="classpath:META-INF/model-config.xml"/>
<import resource="webapp-security.xml"/>
<import resource="wurfl.xml" />
<aop:aspectj-autoproxy proxy-target-class="true"/><!-- this is needed by apache shiro in spring-->

<context:component-scan base-package="com.bla.bla.web.controller.admin"/>
<context:component-scan base-package="com.bla.bla.web.controller.exception"/>

<bean id="propertyConfigurer"
      class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
            <value>classpath:m.properties</value>
            <value>classpath:m.log4j.properties</value>
        </list>
    </property>
</bean> 
```

现在以`webapp-security.xml`这样的`hibernateRealm class`连接为例：

```
<bean id="hibernateRealm" class="com.bla.bla.web.security.HibernateRealm">
    <constructor-arg  ref="credMatcher"/>
</bean> 
```

它的代码在这里：

```
public class HibernateRealm extends AuthorizingRealm {

Logger logger = Logger.getLogger(HibernateRealm.class);

@Autowired
UserAccountService uAS; // this works no problem
@Autowired
RoleService roleService; // this also works
//.....
} 
```

在这种情况下，自动装配工作完美，从来没有任何问题。

现在让我们来看看这个上下文文件：`wurfl.xml`它有[点击这里查看](http://pastie.org/3985028)

```
 <bean id="mDecoratorMapper" class="com.bla.bla.web.decoratormapper.MDecoratorMapper">
    <!--<property name="wurflManager" ref="wurfl.manager"/>-->
</bean> 
```

它的代码在这里：

```
public class MDecoratorMapper extends ConfigDecoratorMapper{
private String decoratorName = null;
@Autowired
WURFLManager wurflManager; <!--this always return null-->
private Properties prop;

public void init(Config config, Properties properties, DecoratorMapper parent) throws InstantiationException {
    super.init(config, properties, parent);
    this.prop = properties;
//decoratorName = properties.getProperty("decorator.name", "mobile");
// ....
} 
```

这对我来说变得很奇怪。所以我决定将它自动连接到控制器中。它不是空的。我真的对此没有任何解释。我什至使用了你可以看到评论的属性，我也使用了属性接线。

我不明白，现在被锁定盯着我的时间线。如果有人伸出援手，我将不胜感激。感谢您阅读本文

**编辑 ：**

更令我惊讶的是，我已切换回默认的 ConigDecoratorMapper 以使站点正常运行并将 WURFLManager 添加到 MVC 控制器：

```
@Controller(value = "useraccesscontroller") 
```

//@RequestMapping("/site/authentication") public class UserAccessController {

```
private static Logger logger = Logger.getLogger(UserAccessController.class);

@Autowired
UserAccountService userAccountService;
@Autowired
VerificationService verificationService;
@Autowired
EmailSender emailSender;
@Autowired
EmailTemplateService emailTemplateService;

@Autowired
Map<String, String> facebookAPI;
@Resource
@Qualifier(value = "roleLandingPage")
Map<String, String> roleLandingPage;
@Resource
@Qualifier(value = "usefulUrls")
Map<String, String> usefulUrls;
@Autowired
private WURFLManager wurflManager;

public UserAccessController(){

}

@RequestMapping(value = "/site/authentication/signup/form")
public ModelAndView showAccountRequestForm(HttpServletRequest request){
    net.sourceforge.wurfl.core.Device device = wurflManager.getDeviceForRequest(request);
    SignupForm form = new SignupForm();
    ModelMap map = new ModelMap();
    map.addAttribute("signupForm",form);
    map.addAttribute("message","");

    return new ModelAndView("signup",map);

} 
```

我可以证明 UserAccessController 内部的这种自动装配是有效的，并且在调试期间我测试过`User-Agent Switcher for Chrome`它正在选择设备。所以为什么不在我的装饰器中:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:23:45.310

尝试让你`wurfl.manager`成为自动接线的候选人

```
<bean id="wurfl.manager" class="net.sourceforge.wurfl.spring.SpringWurflManager" autowire-candidate="true">
     <property name="wurflModel" ref="wurfl.model" />
</bean> 
```

另外，请注意`net.sourceforge.wurfl.spring`Spring 不会根据您的配置扫描 packake

更新：

```
<context:component-scan base-package="net.sourceforge.wurfl.*"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:12:40.763

你没有展示你的自定义`MDecoratorMapper`是如何使用的。很久没用过SiteMesh了，但是我希望a`ConfigDecoratorMapper`是一个Sitemesh类，它的生命周期是由SiteMesh控制的，而不是Spring控制的。因此，您为什么期望它获得注入的实例？你如何告诉 SiteMesh 使用`MDecoratorMapper`? 只有当它要到 Spring 来获取它时（或者如果你正在使用 AspectJ 字节码编织），它才会得到一个被注入的。

# c++ - c++中纯虚函数的主体有什么用？

> ID：10788611
> 
> 赞同：0
> 
> 时间：2012-05-28T17:49:34.917
> 
> 标签：c++

除了可以从派生类重写的方法中调用之外，纯虚函数似乎不能在任何地方调用！那么，它的身体有什么用呢？例如。

```
class base
{
    public:
    virtual void fun()=0
    {
        cout<<"I have been called from derived class"<<endl;
    }
};
class derived:public base
{
    public:
    void fun()
    {
        cout<<"I am the derived class"<<endl;
        base::fun();

    }
};
void main()
{
    derived d;
    d.fun();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:53:11.187

它的使用方式与您在问题中提到的完全相同，派生类可以重用一些通用逻辑，但同时您希望*强制*派生类为非通用部分提供实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:52:00.800

它强制派生类实现它，同时仍为派生实现提供您不希望从派生类以外的任何地方调用的常见行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:53:06.930

纯`virtual`方法旨在充当`abstract`类似于其他语言（例如 Java 和 C#）的完全方法。`class`仅填充纯方法的 C++`virtual`代表`interface`来自其他语言的 a。

给他们一个身体是对这种理想的滥用，它违背了目的。如果基础`class`想只为它的孩子提供功能，那么它应该通过一个`protected`非纯的`virtual`方法来做到这一点（`virtual`如果有意义的话仍然可以）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:03:18.253

这个问题可能是[C++ 纯虚函数](https://stackoverflow.com/questions/5481941/c-pure-virtual-function-have-body)的副本， 我已经看到这主要与纯虚析构函数（需要实现）一起使用。可以在这里找到另一个解释纯虚拟析构函数使用之外的案例的好答案：[(Im)pure Virtual Functions](http://www.gotw.ca/gotw/031.htm)

# php - 不允许其他条目

> ID：10788613
> 
> 赞同：0
> 
> 时间：2012-05-28T17:50:10.953
> 
> 标签：php, mysql

我有一个网站，人们在我的数据库中添加他们的网站，我已经这样做了，就像任何用户只能添加同一个网站的一个条目，例如如果 user1 添加：[http](http://site1.com) ://site1.com那么其他用户不能添加[http:// site1.com](http://site1.com)他们显示该站点已经在 DB 中，现在有些人做这件事，他们制作子域[http://subdomain.site1.com](http://subdomain.site1.com)，然后他们可以添加已经在的主域的 UL 子域数数据库。现在我的问题是如何防止这种情况发生？使用 PHP

我的尝试：

```
 ....
      $check = mysql_query("SELECT * FROM domain WHERE url LIKE '%$suburl%'");
  if($check=="$url"){
 echo"You cannot add a subdomain";

 }
 ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:00:14.867

鉴于新条目是`http://subdomain.site1.com`，使用下面的函数获取`site1.com`零件（我在[这里](https://stackoverflow.com/questions/1201194/php-getting-domain-name-from-subdomain)得到）并将结果放入`LIKE '%%'`

```
// Get the domain name from URL
function get_domain($url)
{
  $host = parse_url($url, PHP_URL_HOST);
  if (preg_match('/(?P<domain>[a-z0-9][a-z0-9\-]{1,63}\.[a-z\.]{2,6})$/i', $host, $regs)) {
    return $regs['domain'];
  }
  return false;
}

$host = get_domain("http://subdomain.site1.com");  // site1.com
$qry = mysql_query("SELECT * FROM domain WHERE url LIKE '%$host%' LIMIT 1");

if (mysql_num_rows($qry)) {
  // Site already exist
} 
```

# c# - 静态方法的数据访问

> ID：10788616
> 
> 赞同：1
> 
> 时间：2012-05-28T17:50:49.513
> 
> 标签：c#, java, methods, static, instance-variables

正如文本所说，静态方法不访问非静态数据，那么几乎所有编程语言中的 main() 方法（声明为静态）如何能够在实例成员上工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:52:26.493

就 Java 而言，这不是真的，您只能在 main 中创建该类的实例后访问实例变量。

当您创建一个类的实例时，它就成为本地方法而不是实例，然后您正在访问该对象的属性，但是在 main 方法中您不能直接使用实例变量。

例如

```
public class TestStatic1 {
    private int number = 0;

    private static int staticnumber = 0;

    public static void main(String[] args) {
        number = 10; // cannot compile at this line.

        staticnumber = 10;
    }
} 
```

另一个

```
public class TestStatic1 {
    private int number = 0;

    private static int staticnumber = 0;

    public static void main(String[] args) {
        TestStatic1 static1 = new TestStatic1();
        static1.number = 10; // perfectly fine, accessed via an object.

        staticnumber = 10;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T17:55:27.337

`Main`至少在 C# 中，静态方法用于创建应用程序使用的类的*实例*——这些实例用于访问它们的实例变量。

您将在大多数应用程序中看到`new`对`Main`方法的调用。这将创建一个可以访问*实例*变量的类的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T17:56:59.460

Main-Method 是一个静态入口点。在 Java 中，它大多看起来像这样：

```
public class MainClass { 
    public static void main(String[] args){ 
        MainClass m = new MainClass();
        m.DoSomething();
        m.DoSomethingPrivate();

        DoSomethingStatic
    }

    public void DoSomething() {}
    private void DoSomethingPrivate() {}

    public static void DocSomethingStatic() {} 
} 
```

它只能直接访问受保护或私有实例成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T17:56:21.157

方法`main`不能访问*包含* `main`. 如果您为它提供一个实例（或在方法中创建一个新实例），它可以访问这些实例。与此类似：

```
public static void foo(String s) {
    System.out.println(s.toUpperCase());
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T17:56:55.623

“*静态方法不访问非静态数据*”**更准确地说**：静态方法不访问非静态**成员**。

# php - mysql合并表中的重复记录

> ID：10788620
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:51:12.347
> 
> 标签：php, mysql

我怎样才能获得决赛桌？我想合并，以便如果它比较并且记录中有一个空列，它会用后一个值填充它。规则是 storetype 应该为每个用户只出现一次

![在此处输入图像描述](../Images/0198ffb95bbe8b2557990253f34f5b6a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:54:35.183

这可能是我做过的最脏的代码:)...如果您要处理的记录超过数百条，我什至不会推荐它。让我知道，因为我无法在 IDE 上检查它。

```
<?php

  $query = 'SELECT * FROM TABLE 1';
  $result = mysql_query($query);
  if ($result){
      while ($result=mysql_fetch_array($result)){
         $data[] = $row;
     }
  }

  // 

  if (isset($data)){
     $x=0;
     $y=0;
     $missingColumn = array();

     while ($x < count($data)){
        foreach ($data[$x] as $key=>$value){
            if (empty($value)){
               $missingColumn[$y][] = $key;
            } else {
               $output[$y][] = $value;
            }  
        }
        if ($missingColumn[$y]){
           $rowComplete = FALSE;
           $yetToBeCompleted = count($missingColumn[$y]);
           while (!$rowComplete && $x<count($data)){
              $x++;
              foreach ($missingColumn as $value){
                 if ($data[$x][$value] <> ''){
                    $output[$y][$value] = $data[$x][$value];
                    $yetToBeCompleted--;
                 }  
              }
              if (0 == $yetToBeCompleted){
                 $y++;
                 break;
                 //$rowComplete = TRUE;
              }
           }
           $y++;          

        } else {
          $y++;
          $x++;
        }
     }
  }

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:54:53.560

也许我在 mysql 方面不是那么多才多艺，但没有任何困难的数据更改技术，我认为这是不可能的。

*   编辑特别是因为在某些列中，您采用最常遇到的值并用该值替换“合并”单元格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:29:25.910

看起来您正在按`username`and分组`storetype`。尝试运行这个：

```
select min(id), username, min(filename), min(date), min(desc), storetype,
    min(password), min(email), min(ftp)
from table1
group by username, storetype 
```

请注意，当然，如果您确实拥有屏幕截图中显示的数据，即每列只有 1 个非空值，`username`并且除列`storetype`之外，每列中只有 1 个非空值`id`。在这种情况下，该`id`列看起来像是您选择了最小值，因此查询也会导致该值。

# facebook - 每个网站页面上的不同评论框

> ID：10788621
> 
> 赞同：0
> 
> 时间：2012-05-28T17:51:16.507
> 
> 标签：facebook, comments

我有一个网站，里面有大约 60 个不同的页面，都是用简单的 HTML 编写的。我希望人们能够分别对每一页发表评论，而不会在另一页上显示来自一个页面的评论。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T19:40:22.433

你想使用 Facebook 评论框吗？如果是，那么您只需要更改 data-href 值。

例子：-

```
<div class="fb-comments" data-href="http://mywebsite.com/page-first.html" data-num-posts="10" data-width="470"></div> 
```

这是创建 facebook 评论框的 url。 [http://developers.facebook.com/docs/reference/plugins/comments/](http://developers.facebook.com/docs/reference/plugins/comments/)

# c# - 实体框架 4.3 CF 选择多对多关系中的所有记录？

> ID：10788622
> 
> 赞同：0
> 
> 时间：2012-05-28T17:51:30.370
> 
> 标签：c#, entity-framework, select, entity-framework-4, lambda

如何使用连接表从一个表中选择与其他表具有对应键的所有记录。我有表 dbo.Patients 和 dbo.Hospitals 和 dbo.PatientHospitals ，它们都有来自两个表的主键。我需要来自 dbo.Hospitals 中的 dbo.Patients 的所有记录，即加入表 dbo.PatientHospitals 中的记录，例如：

```
var currentHospital = db.Hospitals.Single(x => x.User_Id == UserID);

var model = db.Patients.Include("Hospitals")
              .Select(x => x.Hospitals == currentHospital); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T17:55:56.420

在代码优先中，您不需要额外的表来实现简单的多对多关系。你可以像这样定义你的实体

```
public class Patient
{
    ...    
    public virtual ICollection<Hospital> Hospitals { get; set; }    
    ...
}

public class Hospital
{
    ...    
    public virtual ICollection<Patient> Patients { get; set; }    
    ...
} 
```

然后你可以写`currentHospital.Patients`

# c# - 在 Task.Factory 中传递变量

> ID：10788623
> 
> 赞同：0
> 
> 时间：2012-05-28T17:51:35.153
> 
> 标签：c#, .net, lambda, task-parallel-library

我正在尝试使用将一些变量传递给我的线程操作`Task.Factory.StartNew();`。这是示例代码：

```
Task.Factory.StartNew(() =>
    {
        WebClient webClient = new WebClient();
        string source = webClient.DownloadString("http://localhost/?search=" + search_string);
        return source;
    })
.ContinueWith(result =>
    {
        search_string = search.Text;
        search_string = HttpUtility.UrlEncode(search_string, Encoding.UTF8).Replace("+", "%20");
    }); 
```

我想要的是将一个组框和一个面板传递给 ContinueWith() 方法，这样我就可以将搜索结果添加到面板中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:41:23.417

你不需要将你的 UI 元素“传递”到你的`ContinueWith`方法中；捕获局部变量甚至直接访问实例变量都可以。

但是，您确实需要确保您的`ContinueWith`委托在 UI 线程上执行。您可以简单地通过使用[带 a 的重载来`TaskScheduler`](http://msdn.microsoft.com/en-us/library/dd321307)实现这一点，指定由返回的调度程序[`FromCurrentSynchronizationContext`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.fromcurrentsynchronizationcontext.aspx)：

```
Task.Factory.StartNew(() =>
    {
        WebClient webClient = new WebClient();
        string source = webClient.DownloadString(
            "http://localhost/?search=" + search_string);
        return source;
    })
.ContinueWith(antecedent =>
    {
        // Example use of result:
        this.resultTextBox.Result = antecedent.Result;
    },
    TaskScheduler.FromCurrentSynchronizationContext()); 
```

不要忘记传递给`ContinueWith`委托的参数是前面的*任务*，而不是它的结果。要检索结果，请使用其[`Result`](http://msdn.microsoft.com/en-us/library/dd321468)属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:41:56.117

您不需要将变量（控件）传递给延续；只需在延续代码中正常访问它们即可。

但是当线程访问控件时，你会得到跨线程异常。为防止这种情况，请在 UI 线程上运行延续：

```
.ContinueWith(result => 
    { 
        search_string = search.Text; 
        search_string = HttpUtility.UrlEncode(search_string, Encoding.UTF8).Replace("+", "%20"); 
        // update the UI here (result.Result will contain the return value from the task)        
    }, 
    TaskScheduler.FromCurrentSynchronizationContext()); 
```

传递`TaskScheduler.FromCurrentSynchronizationContext()`确保将继续分派回主线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:01:23.667

可能你不需要通过它们。您可以在 lambda 函数中简单地引用它们。请注意，您必须使用 Invoke 或 Dispatcher 从不同的线程访问 UI 元素。

每个在不同 lambda 函数之间“共享”的变量都必须在lambda 函数*之外*声明（闭包！！！！！！）。

# ruby-on-rails - 可以直接从电子邮件中进行 POST 吗？

> ID：10788624
> 
> 赞同：1
> 
> 时间：2012-05-28T17:51:41.290
> 
> 标签：ruby-on-rails

我想允许电子邮件的收件人提交一个 POST 请求，这将产生“喜欢”某些东西的效果。

很清楚您如何在电子邮件中创建 GET 请求（添加 href）。是否有可能获得（或让服务器认为它已收到）一个 POST 请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:54:21.657

您可以在电子邮件中嵌入表单并将其方法设置为“发布”，但您不应该假设电子邮件客户端会正确呈现表单，或者根本不应该。当您尝试在电子邮件中提交表单时，许多电子邮件提供商（如 Google、Yahoo 和 Hotmail）会显示关于向第三方提交数据的丑陋警告。

JavaScript 解决方案不太可能起作用，以至于它不值得讨论。

简而言之，“是”，但一点也不可靠。

# jquery - 从图像值数组中手动 调用fancybox

> ID：10788626
> 
> 赞同：0
> 
> 时间：2012-05-28T17:51:49.893
> 
> 标签：jquery, fancybox

我有一个文件夹，其中包含格式如下的图像，

> “_IMG(#).jpg”

其中 # 表示图库中给定图像的编号。

我的想法是使用 php 在页面加载时获取图库中的图像数量：

```
<?php
  $gallery_item = scandir("style/images/gallery");
  $ignore = Array(".", "..");
  foreach( $gallery_item as $img ){
    $i += in_array($img, $ignore) ? 0 : 1;
  }
?>
<script> var numImages = <?php echo $i; ?>;</script> 
```

然后，我想做的是执行一些循环，根据图库中的图像数量创建一个图像链接数组，这样我就可以调用 fancybox，

```
$.fancybox( imgArray, galleryOpts ); 
```

但我无法弄清楚如何使用 jQuery 语法来实现这一点，因为格式——据我所知——必须是这样的：

```
$.fancybox([
    {'href' : 'some/path/to/image.jpg'}, 
    ... 
```

有没有更简单的方法来做到这一点？我没有在页面上加载任何图像，因此需要以这种方式进行手动调用，并且我希望能够将更多图像添加到目录中而不必再做任何工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:37:50.963

[已解决] 这就是我解决此问题的方法，

```
 for(i = 0;i <= numImages; i++ ) {
    galleryImg[i] = '{"href" : "style/images/gallery/_img ('+(i+1)+').jpg"}';
    galleryImg[i] = jQuery.parseJSON(galleryImg[i]);
  } 
```

# jquery - 等待其他功能中的动画完成

> ID：10788627
> 
> 赞同：1
> 
> 时间：2012-05-28T17:51:51.987
> 
> 标签：jquery, function, events, animation, wait

关键词是“在其他功能中”

这就是我的意思：

```
function MyFunction()
{
     $("#bob").animate({left: 300}, 1000);
}

$('a').click(function(ev){
     ev.preventDefault();
     MyFunction();

     //How can the line below execute after the animation in MyFunction is done?
     document.location = $(this).attr('href')
} 
```

非常感谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:57:36.223

这个有两条路线。

回调路由：

```
function MyFunction(callback) {
     $("#bob").animate({left: 300}, 1000, callback);
}

$('a').click(function(ev){
     ev.preventDefault();
     MyFunction(function() { document.location = $(this).attr('href') });
} 
```

和延期路线：

```
function MyFunction() {
     var def = new $.Deferred();
     $("#bob").animate({left: 300}, 1000, function() { def.resolve() });
     return def.promise();
}

$('a').click(function(ev){
     ev.preventDefault();
     MyFunction()
     .done(function() { document.location = $(this).attr('href') });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T17:52:57.977

```
function MyFunction(url)
{
     $("#bob").animate({left: 300}, 1000, function() {
         // this callback function will execute
         // after animation complete
         // so you can do the location change here
         document.location = url;
     });
}

$('a').click(function(ev){
     ev.preventDefault();
     MyFunction($(this).attr('href')); // passing the url to MyFunction()
}); 
```

它很好用`on()`

```
$('a').on('click', function(ev){
     ev.preventDefault();
     MyFunction($(this).attr('href')); // passing the url to MyFunction()
}); 
```

# html - 如何使表格的一个 TR 中的三个 TD 之一调整自身大小以填充 HTML 中的剩余部分？

> ID：10788628
> 
> 赞同：1
> 
> 时间：2012-05-28T17:51:59.333
> 
> 标签：html

我在我的页面中创建了一个高度为 50 像素、宽度为 100% 的表格，并在该表格中插入了一行，我在其中插入了三个 TD，第一个宽度为 100 像素，第三个为 50 像素。我希望第二个（位于中间的那个）调整自身大小以填充中间的所有剩余部分，以便在调整浏览器窗口大小时，不应向下滚动条。当我直接在这个 TD 的样式标签中写它的宽度 = 100% 时，chrome 可以，但 Firefox 不行，当我写 auto 时，Firefox 可以，但 chrome 不行。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:56:24.517

好吧，我将中间 TD 保留为指定高度和宽度的空白，并且一直在工作，但这次没有工作。我在那个 TD 中输入了一个不可见的文本，现在工作完成了......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T17:59:18.333

您不必在中心列上添加任何内容。如果左/右的宽度固定，中间的会自动填充剩余的部分。

```
table {
    width: 100%;
    height: 50px;
}
td.left-col {
    width: 100px;
    background: red;
}
td.center-col {
    background: yellow;
}
td.right-col {
    width: 50px;
    background: green
}
```

```
<table>
    <tr>
        <td class="left-col">Left</td>
        <td class="center-col">Left</td>
        <td class="right-col">Left</td>
    </tr>
</table>
```

# php - 从mysql数据填充的php表单

> ID：10788637
> 
> 赞同：-2
> 
> 时间：2012-05-28T17:52:27.913
> 
> 标签：php, mysql, forms

我有一个页面显示来自我的数据库的信息。每个数组都有一个编辑链接，该链接具有一个统一的 id (.html?id=4)。

问题：我创建的基于 id 查询数据库的表单导致没有信息显示？

知道我需要做什么来完成这个吗？

```
<?php
    // Connect to the database
require 'include/episodelist.db.php';
    // Ask the database for the information from the table based on .html?id=#
$query="SELECT * FROM `season` WHERE `id` = $id";
    //The above query is the problem.
$result = mysql_query("SELECT * FROM 'season'");
mysql_close();
?>
<form action="include/epslist.edit.php" method="POST">
<table>
<tr>
<td>Season Number: </td><td><input type="text" name="season_sum" size="50" value="<?php echo "$season_num";?>"></td>
</tr>
<tr>
<td>Episode Number: </td><td><input type="text" name="eps_num" size="50" value="<?php echo "$eps_num";?>"></td>
</tr>
<tr>
<td>Temp Episode Number: </td><td><input type="text" name="temp_eps_num" size="50" value="<?php echo "$temp_eps_num";?>"></td>
</tr>
<tr>
<td>Title: </td><td><input type="text" name="title" size="50" value="<?php echo "$title";?>"></td>
</tr>
<tr>
<td>Description: </td><td><textarea type="text" name="descrip" cols="50" rows="7" value="<?php echo "$descrip";?>"></textarea></td>
</tr>
<tr>
<td colspan="2">
<input type="Submit" value="Update">
</td>
</tr>
</table></form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:02:08.390

您需要检查表单是否将 $id 作为变量传递，如果是，则获取 $id 并使用数据库中的数据填充字段。如果没有，请出示空白表格。

```
<?php

if(isset($_GET['id']))
{
   // Get ID
   $id = mysql_real_escape_string($_GET['id']);

   // Do query and save data to array
   $query="SELECT * FROM `season` WHERE `id` = $id";
   $result = mysql_query("SELECT * FROM 'season'");
   $row = mysql_fetch_assoc($result);

   $fields = array('seasonid'    => $row['seasonid'],
                   'episodenum'  => $row['episodenum']
   );

   mysql_close();

}
else
{

   // No id, use blank values
   $fields = array('seasonid'    => '',
                   'episodenum'  => ''
   );
}

?>

<!-- Populate form with fields array -->
...
<td>Season Number: </td><td><input type="text" name="season_sum" size="50" value="<?php echo($fields['seasonid']); ?>"></td>
... 
```

当然，以这种方式使用 mysql 会导致安全问题，并朝着弃用的方向发展。[PDO](http://us.php.net/manual/en/book.pdo.php)（PHP 数据对象）是处理数据库操作的方法。PDO 的使用允许准备好的语句/参数化查询，看起来像这样：

```
$dsn = 'mysql:dbname=testdb;host=127.0.0.1';
$user = 'dbuser';
$password = 'dbpass';

try {
   $dbh = new PDO($dsn, $user, $password);
} catch (PDOException $e) {
   echo 'Connection failed: ' . $e->getMessage();
} 

$id = $_GET['id'];

// Use a prepared statement to avoid SQL injection
$sth = $dbh->prepare('SELECT * FROM `season` WHERE `id` = :id');
$sth->bindValue(':id', $id, PDO::PARAM_INT);
$sth->execute(); 
```

# android - MediaPlayer在android ICS中抛出异常

> ID：10788639
> 
> 赞同：2
> 
> 时间：2012-05-28T17:52:34.250
> 
> 标签：android, streaming, media-player

我`MediaPlayer`用来流式传输 mp3 广播电台，它在所有 android 版本上都可以正常工作，除了在 Android 4.0 中它会抛出这个异常

```
05-28 19:29:57.160: E/MediaPlayer(6854): Unable to to create media player
05-28 19:29:57.164: W/System.err(6854): java.io.IOException: setDataSource failed.: status=0x80000000
05-28 19:29:57.164: W/System.err(6854):     at android.media.MediaPlayer.setDataSource(Native Method)
05-28 19:29:57.164: W/System.err(6854):     at biz.dot.hayatfm.RadioPlayerService$1.run(RadioPlayerService.java:50)
05-28 19:29:57.168: W/System.err(6854):     at java.lang.Thread.run(Thread.java:856) 
```

这是代码

```
this.mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
this.mediaPlayer.setDataSource( Uri.parse("http://vpr.streamguys.net/vpr96.mp3").toString());
                this.mediaPlayer.prepare();
                this.mediaPlayer.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:06:33.633

`IOException`您推断该类`MediaPlayer`使用`URL`流式传输并且它可以访问它，因此它将抛出一个`IOException`android 4.0 需要互联网许可才能流式传输表单 url 这不是 android 4.0 之前的情况，因此您可以根据需要流式传输音乐没有那个允许。

要解决此问题，请在清单文件中包含此权限

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# android - 查看 Horizo ntalScrollView 放入 Java Canvas

> ID：10788641
> 
> 赞同：0
> 
> 时间：2012-05-28T17:52:50.063
> 
> 标签：android, android-layout, android-canvas, horizontalscrollview

已经有两个星期了，我正在寻找解决我的问题的方法，并且在互联网上没有想到任何东西，我希望你能得到一些东西。

问题是这样的，我正在消费一个网络服务数据，这些数据需要把它们变成图像才能在另一个图像上播放，这在名片中很贵，问题是我需要一张图片旁边在使用画布时彼此不适合整个屏幕在那里工作，解决了滚动视图的问题，我认为剩下的账单要转了。

```
public class AndroidPaint extends Activity {
/** Called when the activity is first created. */
Context context;
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
// setContentView(R.layout.main);
ScrollView sv = new ScrollView(this); 
sv.addView(new myView(this));`
setContentView(sv);
}

private class myView extends View {

public myView(Context context) {
super(context);
// TODO Auto-generated constructor stub 
}

@Override
protected void onDraw(Canvas canvas) {

// TODO Auto-generated method stub
Bitmap frenteBitmap = BitmapFactory.decodeResource(getResources(),
R.drawable.frente);
Bitmap versoBitmap = BitmapFactory.decodeResource(getResources(),
R.drawable.verso);
canvas.drawBitmap(frenteBitmap, 0, 100, null);
canvas.drawBitmap(versoBitmap, 700, 100, null);
}
}
} 
```

# jquery - jQuery：将自定义 rel 属性添加到 div 框内的所有链接？

> ID：10788642
> 
> 赞同：1
> 
> 时间：2012-05-28T17:52:51.023
> 
> 标签：jquery

我有很多 div 框“.box”，每个都包含 3 个以上的链接。基本上我想添加一个这样的 rel 属性。

*   对于第一个`".box"`添加`rel="lightbox[group1]"`到其中的每个链接
*   第二次`".box"`添加`rel="lightbox[group2]"`到其中的每个链接
*   第三次`".box"`添加`rel="lightbox[group3]"`到其中的每个链接

到目前为止我的代码：

```
$('.box a').each(function() { $(this).attr('rel','lightbox[group]'); }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T17:55:12.043

你可以试试这个：

```
$(".box").each(function(i) {
    $(this).find("a").attr("rel", "lightbox[group" + (i+1) + "]");
}); 
```

# jquery - 如何在跨度内显示jquery验证错误消息

> ID：10788644
> 
> 赞同：3
> 
> 时间：2012-05-28T17:53:00.540
> 
> 标签：jquery, jquery-validate

我有以下脚本来验证我的表单。它工作正常，但我试图在内部`<span class="errormsg"></span>`以逗号分隔显示所有验证错误消息，而不是在每个输入旁边单独显示它们。

我对jquery知之甚少；我不知道如何实现这一点。你能告诉我吗？

谢谢 ：）

```
<script>
  $(document).ready(function() { 
    // validate signup form on keyup and submit 
    var validator = $("#signupform").validate({
      rules: {
  customerid: "required",
  date: "required",
  invoiceid: {
    required: true,
    minlength: 2,
    remote: "<? echo base_url();?>mycontroller/function" }
  },
      messages: {
    customerid: "Enter your customerid",
    date: "Enter your date",
    invoiceid: {
       required: "Enter a invoiceid",
       minlength: jQuery.format("Enter at least {0} characters"),
       remote: jQuery.format("{0} is already in use")
    },
      }
    });
  });
</script> 
```

**我的表格**

```
<label>Invoice #</label>
<input type="text" name="invoiceid" id="invoiceid" value="" />

<label  style="margin-left:20px;">Date</label>
<input type="text" id="datepicker1" name="date" value=""  />

<label  style="margin-left:20px;">Customer</label>
<input type="text" id="customerid" name="customerid" value=""  /> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-28T18:08:45.487

我会使用该`showErrors`选项来完成此操作：

```
showErrors: function(errorMap, errorList) {
    $(".errormsg").html($.map(errorList, function (el) {
        return el.message;
    }).join(", "));
}, 
```

**示例：http:** [//jsfiddle.net/bd3zM/](http://jsfiddle.net/bd3zM/)

**笔记：**

*   用于根据传递给函数[`$.map`](http://api.jquery.com/jquery.map)的参数构建错误消息数组。`errorList`
*   然后用于[`.join(", ")`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/join)将上述数组连接成一个字符串。
*   `errormsg`使用类将内容放置在元素内[`html`](http://api.jquery.com/html)。

# android - Android - PhoneGap 原生控件

> ID：10788648
> 
> 赞同：4
> 
> 时间：2012-05-28T17:53:13.063
> 
> 标签：android, cordova, phonegap-plugins

我是 Android 和 PhoneGap 开发的新手，我需要为 iPhone 和 Android 编写一个应用程序。

我目前坚持使用 PhoneGap 为 Android 创建本机菜单。我有使用 PhoneGap 在 iOS 上工作的本机标签栏菜单。

问题 1) 我在哪里可以找到一些使用 Android 原生标签栏菜单的示例或插件？

问题 2) 辩论使用 HTML5/CSS/jQuery 创建菜单。使用 PhoneGap 原生控件与坚持使用 HTML5 的优缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:08:56.673

您不应该在 Android 项目上使用标签栏菜单。相反，您应该使用上下文菜单。实际上，对于您所有的菜单需求，您应该尝试使用 Michael 的新插件，在该插件中使用菜单标签，它会根据您的操作系统创建正确的菜单。

[https://github.com/mwbrooks/cordova-plugin-menu](https://github.com/mwbrooks/cordova-plugin-menu)

# powershell - 有什么方法可以保护脚本代码？

> ID：10788651
> 
> 赞同：2
> 
> 时间：2012-05-28T17:53:58.270
> 
> 标签：powershell, vbscript, readonly, protection

假设所有基于脚本的语言（例如 VBscript 和 Powershell）每次都将整个代码“嵌入”在客户机器上，我是否应该假设该代码是“开放的”？我的意思是，有一些方法可以保护基于脚本的代码阅读（并因此写作）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T06:05:07.000

有一些工具可以将 VBScript 转换为可执行文件，例如[vbs2exe](http://www.vbs2exe.com/)、[vbsedit](http://www.vbsedit.com/)和[scriptcryptor](http://www.abyssmedia.com/scriptcryptor/)。通过 PowerShell 创建可执行文件也可以通过[自己在 .net](http://rkeithhill.wordpress.com/2010/09/21/make-ps1exewrapper/)中[使用 PowerGUI Pro](http://www.quest.com/powerguipro/)或[ps2exe 来完成](http://ps2exe.codeplex.com/)。

使用这些工具，您可以使您的脚本“关闭”。与（几乎）所有客户端站点代码一样，它仍然可能被黑客入侵，但这需要更多的工具和知识，而不仅仅是在记事本中打开 vbs 文件并查看脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T17:56:41.937

我不相信有任何完整的证明方法，混淆和最小化是试图保护代码的方法（并且在最小化的情况下减少存储/传输大小）但最终有足够时间的人可以进行逆向工程或观看通过调试/反汇编工具执行程序。我认为你是最安全的假设客户端机器上的任何东西都可以被玩弄，并且保护代码或信息的最佳选择是将其存储/执行在具有适当安全性的服务器上，并不断更新安全漏洞补丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-12T20:06:53.827

是的！您可以为此使用我的模板。并且不要忘记将密码从“qweasd”更改为其他密码！

```
    函数全局：解密字符串 {
        参数($Encrypted,$Passphrase,$salt,$init)

        if ($Encrypted -is [字符串]) {
            $Encrypted = [转换]::FromBase64String($Encrypted)
        }

        $r = 新对象 System.Security.Cryptography.RijndaelManaged
        $pass = [System.Text.Encoding]::UTF8.GetBytes($Passphrase)
        $salt = [System.Text.Encoding]::UTF8.GetBytes($salt)

        $r.Key = (New-Object Security.Cryptography.PasswordDeriveBytes $pass,$salt,"SHA256",5).GetBytes(256/8)
        $r.IV = (New-Object Security.Cryptography.SHA1Managed).ComputeHash([Text.Encoding]::UTF8.GetBytes($init))[0..15]

        $d = $r.CreateDecryptor()
        $ms = 新对象 IO.MemoryStream @(,$Encrypted)
        $cs = 新对象 Security.Cryptography.CryptoStream $ms,$d,"Read"
        $sr = 新对象 IO.StreamReader $cs
        写输出 $sr.ReadToEnd()
        $sr.Close()
        $cs.Close()
        $ms.Close()
        $r.清除（）
    }

    函数全局：运行解密（[字符串]$加密）{
        $private:pass = Read-Host "输入密码以解码脚本代码" -AsSecureString
        $private:BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($private:pass)
        $private:UnsecurePassword = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($private:BSTR)
        $block = (global:Decrypt-String -Encrypted $encrypted -Passphrase $private:UnsecurePassword -salt "d35104f3-dcd0-4cd7-80bb-5e66388e6ede" -init "3982c1d2-04da-4883-9a46-4b860794084e")
        返回$块
    }

    函数全局：保存解密（[字符串]$加密）{
        尝试 {
            $answer = Read-Host "保存解码后的脚本版本？(y/n)"
            开关（$答案）{
                是{}
                N {返回}
                默认 {return}
            }
            $decrypted = 运行解密 $encrypted
            $p = (Read-Host "输入新文件的路径")
            if (-Not (Is-ValidPath $p)) { return }
            if ($host.version -ne "2.0") {
                $offset = $global:secure.StartPosition.Start + 1
            } 别的 {
                $offset = $global:secure.StartPosition.Start
            }
            (Get-Content $global:secure.File | Out-String).Remove($offset,$global:secure.ToString().Length).Insert($offset, $decrypted) | 输出文件 -FilePath $p -NoClobber
            ' Write-Host '解码文件成功保存。'
        } 抓住 {
            Write-Host '保存文件时出错。'
            写主机 $error[0]  
        }
    }

    函数全局：Is-ValidPath([string]$path) {
        if ($path -eq '') {
            Write-Host '没有路径。创建文件失败。'; 返回 $false
        } elseif (-not (Test-Path (Split-Path $path -Parent))) {
            Write-Host '路径不存在。创建文件失败。'; 返回 $false
        } elseif (测试路径 $path) {
            Write-Host '文件已经存在。创建文件失败。'; 返回 $false
        }
        返回 $true;
    }

    $全球：安全= {
        函数全局：加密字符串 {
            参数($String,$Passphrase,$salt,$init,[switch]$arrayOutput)

            $r = 新对象 System.Security.Cryptography.RijndaelManaged
            $pass = [Text.Encoding]::UTF8.GetBytes($Passphrase)
            $salt = [Text.Encoding]::UTF8.GetBytes($salt)

            $r.Key = (New-Object Security.Cryptography.PasswordDeriveBytes $pass,$salt,"SHA256",5).GetBytes(256/8)
            $r.IV = (New-Object Security.Cryptography.SHA1Managed).ComputeHash([Text.Encoding]::UTF8.GetBytes($init))[0..15]

            $c = $r.CreateEncryptor()
            $ms = 新对象 IO.MemoryStream
            $cs = 新对象 Security.Cryptography.CryptoStream $ms,$c,"Write"
            $sw = 新对象 IO.StreamWriter $cs
            $sw.Write($String)
            $sw.Close()
            $cs.Close()
            $ms.Close()
            $r.清除（）
            [字节[]]$result = $ms.ToArray()
            if ($arrayOutput) {
                返回$结果
            } 别的 {
                返回 [转换]::ToBase64String($result)
            }
        }

        函数全局：保存加密（）{
            $answer = Read-Host "`n保存此脚本的编码版本？(y/n)"
            开关（$答案）{
                是{}
                N {返回}
               默认 {return}
            }
            尝试 {
                $path = (Read-Host "输入编码文件的路径").Trim("`"'")
                if (-Not (Is-ValidPath $path)) {return}
                运行加密 | 输出文件 -FilePath $path -NoClobber
                ' Write-Host '编码文件已成功保存。'
            } 抓住 {
                Write-Host '保存文件时出错。'
                写主机 $error[0]
            }
        }

        函数全局：运行加密（）{
            参数（
            $pass = "qweasd",
            $salt = "d35104f3-dcd0-4cd7-80bb-5e66388e6ede",
            $init = "3982c1d2-04da-4883-9a46-4b860794084e"
            )

            $encrypted = global:Encrypt-String -String $global:secure -Passphrase $pass -salt $salt -init $init
            if ($host.version -ne "2.0") {
                $offset = $global:secure.StartPosition.Start + 1
            } 别的 {
                $offset = $global:secure.StartPosition.Start
            }
            $block = (Get-Content $global:secure.File | Out-String).Remove($offset, $global:secure.ToString().Length).Insert($offset, "New-Object -TypeName System.String '$加密'")
            返回$块
        }

        #程序从这里开始

        写主机“Hello World！”

        #程序到此结束
    }

    尝试 {
        $null = $global:secure.GetSteppablePipeline() #dirty hack
        写警告“脚本编码！”
        尝试 {
            Invoke-Command -ScriptBlock ([Scriptblock]::Create((Run-Decrypt $global:secure.Invoke())))
        } 最后 {
            保存解密 $global:secure.Invoke()
        }
    } 抓住 {
        尝试 {
            调用命令 -ScriptBlock $global:secure
        } 最后 {
            找工作 | 移除作业强制
            保存加密
        }
    }

```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-07-07T15:31:18.777

我对可执行的方法并不满意，因为我发现复杂的脚本不容易编译（而且通常根本编译不了），而且最终很难使用。正如许多人所指出的，对于有决心的人来说，可执行文件不是障碍。我决定一个更好的方法是简单地使人类可读的脚本更难更改，然后简单地要求原始开发人员进行更改。

我编写了[obfuscate-powershell](http://desktoplibrary.livelink-experts.com/obfuscate-powershell)来更改变量和函数名称、删除注释和更改空格，只是为了降低代码的可读性和可理解性。它仍然不安全，但总比什么都不做要好。

# jpa-2.0 - JPA2.0 使用 Jboss 运行时库（休眠）失败

> ID：10788657
> 
> 赞同：2
> 
> 时间：2012-05-28T17:54:39.380
> 
> 标签：jpa-2.0, jboss7.x

我将 JSF 与 icefaces 组件一起使用，并使用 JPA2.0 调用数据库。由于我使用的是 JBOSS AS 7.1 服务器，因此我使用的是运行时库中的 hibernate.persistence。但它失败并出现以下错误。

> java.lang.IllegalStateException: JBAS011048: 构造组件实例失败

完整的堆栈跟踪：

```
13:34:08,316 SEVERE [javax.enterprise.resource.webcontainer.jsf.application] (http--127.0.0.1-8080-1) Error Rendering View[/job-applicant.xhtml]: java.lang.IllegalStateException: JBAS011048: Failed to construct component instance
    at org.jboss.as.ee.component.BasicComponent.constructComponentInstance(BasicComponent.java:163) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.ee.component.BasicComponent.createInstance(BasicComponent.java:95) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.web.deployment.component.WebComponentInstantiator$2.<init>(WebComponentInstantiator.java:96) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.web.deployment.component.WebComponentInstantiator.initializeInstance(WebComponentInstantiator.java:94) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.web.deployment.WebInjectionContainer.newInstance(WebInjectionContainer.java:86) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.web.deployment.jsf.JsfInjectionProvider.invokePostConstruct(JsfInjectionProvider.java:69) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at com.sun.faces.mgbean.BeanBuilder.invokePostConstruct(BeanBuilder.java:223) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.mgbean.BeanBuilder.build(BeanBuilder.java:105) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.mgbean.BeanManager.createAndPush(BeanManager.java:409) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at org.apache.el.parser.AstIdentifier.getValue(AstIdentifier.java:72) [jbossweb-7.0.10.Final.jar:]
    at org.apache.el.parser.AstValue.getValue(AstValue.java:147) [jbossweb-7.0.10.Final.jar:]
    at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189) [jbossweb-7.0.10.Final.jar:]
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.UIOutput.getValue(UIOutput.java:169) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at com.sun.faces.renderkit.html_basic.MenuRenderer.getCurrentSelectedValues(MenuRenderer.java:648) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.renderkit.html_basic.SelectManyCheckboxListRenderer.encodeEnd(SelectManyCheckboxListRenderer.java:122) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:312) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.renderkit.html_basic.GridRenderer.renderRow(GridRenderer.java:185) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.renderkit.html_basic.GridRenderer.encodeChildren(GridRenderer.java:129) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.render.Renderer.encodeChildren(Renderer.java:168) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at org.icefaces.impl.renderkit.RendererWrapper.encodeChildren(RendererWrapper.java:49) [icefaces.jar:]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:402) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.10.Final.jar:]
    at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:154) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.10.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.10.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.10.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.10.Final.jar:]
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.6.0_25]
Caused by: javax.persistence.PersistenceException: Hibernate cannot unwrap interface javax.persistence.EntityManagerFactory
    at org.hibernate.ejb.AbstractEntityManagerImpl.unwrap(AbstractEntityManagerImpl.java:1173) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]
    at org.jboss.as.jpa.container.AbstractEntityManager.unwrap(AbstractEntityManager.java:68) [jboss-as-jpa-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.jpa.injectors.PersistenceContextInjectionSource$PersistenceContextJndiInjectable.getReference(PersistenceContextInjectionSource.java:188) [jboss-as-jpa-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.as.ee.component.ManagedReferenceFieldInjectionInterceptorFactory$ManagedReferenceFieldInjectionInterceptor.processInvocation(ManagedReferenceFieldInjectionInterceptorFactory.java:104) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.ManagedReferenceInterceptorFactory$ManagedReferenceInterceptor.processInvocation(ManagedReferenceInterceptorFactory.java:106) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.TCCLInterceptor.processInvocation(TCCLInterceptor.java:45) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.BasicComponent.constructComponentInstance(BasicComponent.java:161) [jboss-as-ee-7.1.0.Final.jar:7.1.0.Final]
    ... 54 more 
```

持久性.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
<persistence-unit name="jobApplication">

<provider>org.hibernate.ejb.HibernatePersistence</provider> 
<jta-data-source>java:/OracleJINDI</jta-data-source>
    <class>org.icefaces.training.applicant.model.EmployeesEntity</class>
<class>org.icefaces.training.applicant.model.Employee</class>
  <properties>
     <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect" />
      <property name="use_sql_comments" value="true"/>

  </properties>

</persistence-unit>
</persistence> 
```

调用的托管 bean

```
 private String resume;
    private String valuen;
    @PersistenceContext(unitName= "jobApplication")
    EntityManagerFactory emf;

    public String getValuen() {

        //EntityManagerFactory emf = Persistence.createEntityManagerFactory("jobApplication");
            EntityManager em = emf.createEntityManager();
            EmployeeService service = new EmployeeService(em);
            Employee emp = service.findEmployee((long)207);

            return emp.getLastName();

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:29:49.983

这是有效的：我不得不替换`@PersistenceContext`为`@PersistenceUnit`

# mysql - 将 MySQL 行值存储为数组值

> ID：10788658
> 
> 赞同：0
> 
> 时间：2012-05-28T17:54:45.153
> 
> 标签：mysql, arrays

```
$result = mysql_query("SELECT token FROM active_users");

$tokens = array();
while($row = mysql_fetch_assoc($result))
{
    $tokens[] = $row;
} 
```

...有效，但是：

```
Array
(
    [0] => Array
        (
            [token] => 32166565
        )

    [1] => Array
        (
            [token] => 56566565
        )

) 
```

而我需要它是简单的：

```
Array
(
    [0] => 32166565
    [1] => 56566565
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T17:55:56.303

尝试这个

```
$token[] = $row['token']; 
```

# python - Google App Engine 与 WebFaction

> ID：10788661
> 
> 赞同：5
> 
> 时间：2012-05-28T17:54:50.860
> 
> 标签：python, google-app-engine, webfaction

可能重复： [GAE + Python vs Webfaction + Python + django - 相对较新的开发者](https://stackoverflow.com/questions/3326308/gae-python-vs-webfaction-python-django-for-a-relative-new-dev)

您好，我正在使用 django-nonrel 在谷歌应用引擎上开发我的一个爱好项目。应用程序的基本部分已完成。现在对于我需要使用的一些高级功能：

1.  Comet for Facebook 就像实时行情一样
2.  django-filetransfer 用于存储带有图像的文章并在有人阅读文章时提供相应的图像
3.  10-30分钟的视频内容一次完成以上两个（尚未决定是否对网络应用程序的视频总数有任何限制，因为考虑让用户上传成为可能）

所以我的问题是：

1.  我需要为每个使用我的应用程序的用户提供彗星，因为 GAE 对创建和频道创建的免费配额和最大速率（6 个创建/分钟）有限制。如果我在 GAE 上托管我的应用程序，我会花费更多吗？如果我们的应用程序使用反向 Ajax ，其他托管服务（如[WebFaction](http://www.webfaction.com/)和[Linode ）是否也会收费？](http://www.linode.com/)
2.  由于使用 django-filetransfers 上传带有文章的图片需要我启用计费，其他托管服务是否也是如此？
3.  GAE（与 WebFaction、linode 或任何其他托管站点相比）对于允许用户上传视频内容的应用程序是否具有成本效益？

PS由于我使用了django-nonrel，因此此时可以轻松更改我的托管站点。一旦我开始处理上述功能，我就很难从一个托管站点转移到另一个托管站点。因此，我想采取最好的步骤。另外，我来自印度，在这里支付 1 单位的美元将花费我 50 多单位的印度货币。所以喜欢这里最好的交易而不影响性能:-)

谢谢你的时间，

苏尼尔

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T18:08:26.597

Google App Engine 和 webfaction/linode 除了最终都托管您的应用程序之外，它们是无关的。

GAE 是一种用于托管应用程序的云平台即服务，它通常符合他们为您想要使用的单个服务而向您公开的 API。他们为您提供免费等级，然后通过提高等级来赚钱。

Linode 只是一个 VPS（虚拟专用服务器）。它是一个虚拟的 linux 机器，您负责设置服务。没有满足您个人 Web 服务需求的 API。它只是一个供您自由发挥的Linux平台。需要阿帕奇吗？nginx？mysql？蒙哥？您需要安装和配置这些服务。

Webfaction 位于 GAE 和 linode 之间，因为它也是一种 VPS、一种共享和一种云。您可以获得 shell 访问权限，它有助于将您的服务安装为“应用程序”，在控制面板中为您处理配置。但它和 linode 一样，也不是 GAE 那样的云平台。您无法获得与 GAE 提供的各种服务相同的 API。

App Engine 让您不必管理实际的服务器，而是专注于管理您的应用程序及其所需的资源。但他们对使用免费套餐以外的更多服务收费。

Linode/Webfaction/VPS/... 不按资源收费。您计划的一部分可能是无限带宽，或者可能是每月 10GB、20GB 等。您计划的一部分可能是 128/256/512mb 内存。你按照你需要的计划去做，有时他们会让你在事后添加更多的存储/内存。但是您无需为每次上传或每次 API 调用付费，因为它们没有 API。

GAE（以及类似的亚马逊服务）背后的理念是为您的服务提供一个可扩展的平台，让您少考虑硬件，多考虑添加更多资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:11:50.777

其他值得评估的可能的 Python PaaS 平台：

*   Heroku
*   点云
*   更多信息请访问[http://www.quora.com/What-is-the-Heroku-equivalent-for-Django-applications](http://www.quora.com/What-is-the-Heroku-equivalent-for-Django-applications)

# java - 什么填充了这个数组列表？

> ID：10788662
> 
> 赞同：2
> 
> 时间：2012-05-28T17:54:53.033
> 
> 标签：java, android, arraylist

我的数组列表以某种方式填充。

看看这段代码：

```
final ListView list = getListView();
boolean threadNeeded = true;
//settings
list.setItemsCanFocus(false);
Bundle extras = getIntent().getExtras();
allFriends = getIntent().getParcelableExtra("shibby.whisper.allFriends");
selectedFriends = getIntent().getParcelableExtra("shibby.whisper.selectedFriends");
System.out.println("JUST ENTERED ACTIVITY : "+selectedFriends.getPositions());

if(extras !=null) {
    maxPlayers = extras.getInt("max_players");
}

if(allFriends != null){
    if(!allFriends.getIds().isEmpty()){
        threadNeeded = false;
    }
}

if(selectedFriends == null){
    System.out.println("selectedFriends is null before callback from ListActivity");
    selectedFriends = new PlayerList();
}

list.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        FacebookFriendsAdapter a = (FacebookFriendsAdapter) list.getAdapter();
        //select item
        boolean isSelected = a.toggleSelected(new Integer(position));

        //if reached maximum players and have selected a new user
        if(((maxPlayers+1 == a.getMaxPlayersCounter() && maxPlayers != 0) && isSelected)
            || (maxPlayers == 0 && a.getMaxPlayersCounter() == maxAvailablePlayers+1)){
            Log.e("addfriends","Max Players Reached");
            a.toggleSelected(new Integer(position));        
            final Dialog dialog = new Dialog(FacebookFriendsListActivity.this, R.style.CustomDialogTheme );
            dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
            dialog.setContentView(R.layout.maxplayers);
            dialog.setCancelable(true);
            // set the custom dialog components - text, image and button
            Button dialogButton = (Button)       dialog.findViewById(R.id.max_players_dismiss_btn);
            // if button is clicked, close the custom dialog
            dialogButton.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    dialog.dismiss();
                }
            });
            dialog.show();
        }
    }
});

m_friends = new ArrayList<Player>();
this.m_adapter = new FacebookFriendsAdapter(this, R.layout.facebbok_friends_item, m_friends);

//set the selected friends on the adapter to remember earlier picks
if(selectedFriends != null){
    oldPositions = selectedFriends.getPositions();
    m_adapter.setSelectedIds(selectedFriends.getPositions());
    m_adapter.setMaxPlayersCounter(selectedFriends.getIds().size());
    System.out.println("Max player selected Is : "+maxPlayers+" And Selected Players Counter Is :" +m_adapter.getMaxPlayersCounter());
} 
```

当活动开始时，`selectedFriends.getPosition()`返回空。

当我单击一个按钮时，我执行此操作：

```
if(oldPositions != null){
    System.out.println("This is old positions : " + oldPositions);
} 
```

哪个被填充（由新位置），但我不明白为什么。我引用了我不应该引用的东西吗？我是否覆盖内存中的数据？

**编辑：**这发生在我从 ListView 中选择一些朋友之后。`toggleSelected()`从内部 ArrayList 添加或删除项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:57:36.170

我认为你的错误是假设这条线复制了任何`getPositions`回报：

```
oldPositions = selectedFriends.getPositions(); 
```

实际上，它只制作了引用的副本——它不会制作整个列表的浅表副本。

你可能想要这样的东西（我只是在猜测类型）：

```
oldPositions = new ArrayList<Position>(selectedFriends.getPositions()); 
```

# javascript - 如何从像 stackoverflow 这样的网站运行 javascript 示例？

> ID：10788667
> 
> 赞同：0
> 
> 时间：2012-05-28T17:55:30.397
> 
> 标签：javascript

需要添加什么才能运行类似于此处找到的示例：[将 HTML 字符串转换为 DOM 元素？](https://stackoverflow.com/questions/3103962/converting-html-string-into-dom-elements)在基本的 HTML 文档中？

具体来说，我指的是代码：

```
var xmlString = "<div id='foo'><a href='#'>Link</a><span></span></div>"
  , parser = new DOMParser()
  , doc = parser.parseFromString(xmlString, "text/xml");
doc.firstChild // => <div id="foo">...
doc.firstChild.firstChild // => <a href="#">... 
```

我努力了：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
</head>
<body>
<script type="text/javascript">
var xmlString = "<div id='foo'><a href='#'>Link</a><span></span></div>"
  , parser = new DOMParser()
  , doc = parser.parseFromString(xmlString, "text/xml");
doc.firstChild;
doc.firstChild.firstChild;
</script>
</body>
</html> 
```

作为 javascript 的初学者，一个完整的 html 复制和粘贴解决方案会很好地了解它的精确度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:06:40.557

我不确定这是否是您想要的，但是如果您想在线运行 jQuery（或 javascript），您可以使用[http://jsfiddle.net/](http://jsfiddle.net/)，但请确保在运行脚本时，您拥有所有引用的变量和元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:08:05.707

`// =>`注释只是试图描述您从属性中获得的值——在每种情况下，都是一个表示部分标记的 DOM 对象。

你想用这些值做什么取决于你。有关指导，请参阅：[https ://developer.mozilla.org/en/DOM](https://developer.mozilla.org/en/DOM)

但是，您可以简单地使用以下命令输出它们`console.log`：

```
console.log(doc.firstChild);
console.log(doc.firstChild.firstChild); 
```

或者在页面上的元素中显示他们的详细信息：

```
document.getElementById('foo').innerHTML = doc.firstChild.nodeName; 
```

或者，任何过多的其他任务。

* * *

对于上下文：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Untitled Document</title>
    </head>
    <body>
        <div id="foo"></div>

        <script>
            var xmlString = "<div id='foo'><a href='#'>Link</a><span></span></div>"
              , parser = new DOMParser()
              , doc = parser.parseFromString(xmlString, "text/xml");

            console.log(doc.firstChild);
            console.log(doc.firstChild.firstChild);

            document.getElementById('foo').innerHTML = doc.firstChild.nodeName;
        </script>
    </body>
</html> 
```

# list - Haskell：从混合类型列表中生成集合

> ID：10788668
> 
> 赞同：1
> 
> 时间：2012-05-28T17:55:32.403
> 
> 标签：list, haskell, set, generator

我正在尝试从本质上是包含混合类型的列表的类型中生成一个新列表。我不确定对此的技术描述，所以我提前道歉，但我认为我可以通过使用示例和代码来解释。

例如，我有一个类型/列表，其中定义了以下类型：

```
type Database = [(Person, [Book]) ]
type Person = String
type Book = String

testBase :: Database
testBase 
= [("Alice",["TinTin", "Wizard of Oz"]), ("Rory", ["Learn Erlang", "Learn Haskell"]) ] 
```

在上述数据库类型中，我有一个“模拟”库。第一个值 (Person) 是借阅者的姓名，第二个值是列表，包含此人已借阅的所有书籍。

基于这些信息，我希望能够有一个函数来获取这个人的名字，并返回一个他们借过的书的列表。例如，有一个“爱丽丝”的参数应该返回：

```
 ["TinTin", "Wizard of Oz"] 
```

我创建的函数看起来像这样，但返回一个空列表。我希望它返回一个包含书籍值的列表，即 [Book]。我应该怎么做才能使这段代码工作？

```
borrowedBooks       :: Database -> Person -> [Book]
borrowedBooks dBase findPerson
=   [book | (person,[book])  <- dBase, person == findPerson ] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T18:01:08.830

您的搜索功能包含以下模式匹配：

```
(person, [book]) <- dBase 
```

回想一下，列表推导生成器中的模式匹配充当*过滤器*。也就是说，失败的匹配将被丢弃。在您的情况下，您正在对仅包含一本书的书籍列表进行模式匹配。

所以只有那些拥有一本书的人会被退回，这在您的样本数据中是没有人的。

我想你的意思是：

```
[ books | (person,books) <- dBase, person == findPerson ] 
```

请注意，此处使用列表并不能保证一个人的唯一性——可能有多个人与您的数据类型匹配。列表推导的返回类型揭示了这一点 (a `[[Book]]`) 列表不会静态地强制键只出现一次。切换到 Data.Map 或其他具有键唯一性保证的关联结构将使这更简单。

# php - 从 xml 中提供一些文件的信息

> ID：10788670
> 
> 赞同：0
> 
> 时间：2012-05-28T17:55:36.947
> 
> 标签：php, xml

我是 xml 的新手，我需要一些帮助。我正在尝试在我的服务器中上传一个包含 3 张照片和一个 info.xml 的 zip 文件。此 xml 将包含有关照片的信息（每张照片的标题、每张照片的描述、每张照片的位置等）。我在这里所做的：我正在上传 zip 文件（没有 xml）并将其解压缩到一个文件中。但我不知道如何制作该 info.xml。从那里我必须读取 xml 并将每张照片的信息保存在我的数据库中（根据照片的名称）。我的问题是谁能给我一个示例代码，说明该 xml 将如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:08:17.733

我猜你会想要制作一个类似这样的文件：

```
<photos>
<photo name="photo1">
here you would write your description.
</photo>
<photo name="photo2">
here you would write your description.
</photo>
</photos> 
```

上传后，您可以使用 simpleXML 读取数据，以防您使用 php。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:12:34.493

这可能是您的 XML 文件的结构，如果您是决定它的人的话。

```
<photos>
    <photo id="1">
        <name>name for photo 1</name>
        <description>description for photo 1</description>
        <location>location for photo 1</location>
        ...
    </photo>
    <photo id="2">
        <name>name for photo 2</name>
        <description>description for photo 2</description>
        <location>location for photo 2</location>
        ...
    </photo>
    ...
</photos> 
```

但是，如果 XML 文件必须按照服务器应用程序规范遵循某种结构，您应该在问题中提及这一点。

# azure - Azure 权限管理服务托管

> ID：10788675
> 
> 赞同：0
> 
> 时间：2012-05-28T17:56:19.377
> 
> 标签：azure

我看到了 Azure 权限管理服务 API。据我所知，它是消耗 RMS。我对 Azure 不托管 RMS 服务是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T07:46:17.890

我了解明年将发布的新版 Office 365 预览版将具有权限管理服务。您可以立即注册试用 ( [http://www.microsoft.com/office/preview/en/whats-new](http://www.microsoft.com/office/preview/en/whats-new) )。我也知道这是从 Azure 运行的。

西蒙斯金纳 [MVP]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T20:12:12.573

AD RMS SDK2.1 RC 实际上让您可以构建可与 AD RMS（本地）和 Azure AD RM（作为 Office 365 的一部分）一起使用的应用程序。SDK 几天前发布，可在以下网址获得：[https](https://connect.microsoft.com/site1170/Downloads/DownloadDetails.aspx?DownloadID=48166) ://connect.microsoft.com/site1170/Downloads/DownloadDetails.aspx?DownloadID=48166 。

（如果您尚未在 Microsoft Connect 上注册，则：转到 connect.microsoft.com，使用您的 Microsoft 帐户登录 > 目录 > 搜索权限管理服务 > 加入）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:43:13.887

我很想知道您对“Azure 权限管理 API”有什么发现，因为我认为没有任何特定于 RMS 解决方案的 Azure 管理 API。

Windows Azure 不提供基于 RMS 的解决方案。RMS 解决方案还与 AD 集成，到目前为止，您无法在 Azure 上运行 AD，因此您无法在 Windows Azure 上构建此类解决方案。一些人可能会说使用 VM 角色，但这也不是一个解决方案。

# .htaccess - Modrewrite 产品页面工作，但类别页面不

> ID：10788678
> 
> 赞同：0
> 
> 时间：2012-05-28T17:56:27.370
> 
> 标签：.htaccess, mod-rewrite, seo, friendly-url

我得到了以下 modrewrite 脚本：

```
RewriteCond %{ENV:space_replacer} !^$ 
RewriteRule ^.*$ %{ENV:space_replacer} 
RewriteRule (.*)/(.*)$ product.php?categorie_url=$1&product_url=$2

THIS ONE ABOVE IS WORKING: -> domain.com/korsetten/school-girl

RewriteCond %{ENV:space_replacer} !^$ 
RewriteRule ^.*$ %{ENV:space_replacer} 
RewriteRule (.*)$ categorie.php?categorie_url=$1

THIS ONE ABOVE IS NOT WORKING: -> domain.com/korsetten 
```

整个 .htaccess 文件：

```
RewriteEngine on 

RewriteCond %{ENV:space_replacer} !^$ 
RewriteRule ^.*$ %{ENV:space_replacer} 
RewriteRule (.*)/(.*)$ product.php?categorie_url=$1&product_url=$2  

RewriteCond %{ENV:space_replacer} !^$ 
RewriteRule ^.*$ %{ENV:space_replacer} 
RewriteRule (.*)$ categorie.php?categorie_url=$1 
```

有人可以解释一下我在类别页面上做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:00:05.617

不知道为什么第二个不适合你，我在测试我的 apache 设置时遇到了问题。但以下对我有用：

```
RewriteCond %{ENV:space_replacer} !^$
RewriteRule ^.*$ %{ENV:space_replacer}
RewriteRule ^([^/]+)/([^/]+)$ product.php?categorie_url=$1&product_url=$2  [L]

RewriteCond %{ENV:space_replacer} !^$
RewriteRule ^.*$ %{ENV:space_replacer}
RewriteRule ^([^/]+)/?$ categorie.php?categorie_url=$1  [L] 
```

只需调整正则表达式并添加`[L]`标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T12:23:25.970

感谢您的回答，但它对我没有用，下面的代码对我有用：

```
RewriteCond %{REQUEST_URI} ^(.*)\ (.*)$ 
RewriteRule ^.*$ %1-%2 [E=space_replacer:%1-%2] 
RewriteCond %{ENV:space_replacer} !^$ 
RewriteCond %{ENV:space_replacer} !^.*\ .*$ 

RewriteRule ^.*$ %{ENV:space_replacer} [R=301,L] 
RewriteRule (.*)$ categorie.php?categorie_url=$1&%{QUERY_STRING}
RewriteRule (.*)/(.*)$ products.php?categorie_url=$1&product_url=$2&%{QUERY_STRING} 
```

现在 $_GET 方法也适用于 categorie.php 页面。现在我可以使用 $_GET['categorie_url'] 从数据库中检索当前类别。

# php - MongoDB & PHP - Regex find query in nested array

> ID：10788681
> 
> 赞同：-1
> 
> 时间：2012-05-28T17:56:49.380
> 
> 标签：php, mongodb, find

I have data like so:

```
{
   "_id": ObjectId("4fc3abc9751c38c811000002"),
   "timeStamp": ISODate("2012-05-28T16: 45: 58.0Z"),
   "loadTime": 2.3101460933685,
   "description": {
     "0": {
       "level": NumberInt(0),
       "description": "Some description"
    }
  }, 
```

How do I find() the "level" data using the array of 0-8 like in my query below?

My query looks like this:

```
find(Array ( [description] => Array ( [0] => Array ( [level] => Array ( [$in] => Array ( [0] => 0 [1] => 1 [2] => 2 [3] => 3 [4] => 4 [5] => 5 [6] => 6 [7] => 7 [8] => 8 ) ) ) ) ) ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:58:05.547

This should do the trick:

```
->find( array( 'description.0.level' => array( '$in' => range( 0, 8 ) ) ) ); 
```

However, I don't quite see why you have a "0" key there. The document really should look like:

```
{
  "_id": ObjectId("4fc3abc9751c38c811000002"),
  "timeStamp": ISODate("2012-05-28T16: 45: 58.0Z"),
  "loadTime": 2.3101460933685,
  "description": [
    {
      "level": 0,
      "description": "Some description"
    }
  ],
} 
```

In which case you can find the "level" like:

```
->find( array( 'description.level' => array( '$in' => range( 0, 8 ) ) ) ); 
```

# jquery - jQuery - .on() 与“点击”有关的问题

> ID：10788686
> 
> 赞同：0
> 
> 时间：2012-05-28T17:56:59.773
> 
> 标签：jquery

我正在尝试为我的 jQuery/PHP 创建一个事件，以便在向下滚动时加载更多内容。但是我的 .on() 事件遇到了一些麻烦。

我创建了一个函数（你看到的就是下面的代码，我刚刚删除了函数 functioname{}），当到达页面底部时调用它。

我的问题是，使用 .on() 你必须添加一个“点击”属性，这对我来说有点困难，因为它必须在*没有*点击的情况下加载。当我调用该函数时，是否有一个属性使它运行 .on() ？

```
$("#container").on("click", ".box", function(event){
    alert("hej");

 $.post("site/scroll.php?mabid=" + $mabid,
  function(data){
    if (data != "") {
    alert($(".box:last").attr("mabid"));
    $(".box:last").after(data); 
  }
 });
}); 
```

我使用 .on() 的原因是因为它必须向新创建的元素添加一个 jQuery 插件，即*.box*，这使得它具有正确的布局。我试图绑定到新创建的 dom 元素的插件是这样的：[http ://www.wookmark.com/jquery-plugin](http://www.wookmark.com/jquery-plugin)

**更新**

我在加载内容时没有问题。我在将 jQuery 插件 Wookmark 添加到 NEW DOM 元素时遇到了麻烦。这意味着它很乱，看起来非常非常糟糕。

请阅读他们网站上的 WookMark 插件的小描述。这是一个插件，可以让.box像在 pinterest.com 或 wookmark.com 上一样，让它们相互配合*。*

现在新的 DOM 元素只是插入并且看起来很乱，没有激活插件。

**更新2**

经过一些沟通和误解后，只需将 Wookmark 插件添加到 $.post() 中的新元素即可解决问题；像：

```
$.post("scroll.php?...", function(data){

  if(data != ""){
   //add the new dom elements, with .after(), .append() or something else.
   //add the needed effects to the new dom elements. For example with wookmark:
   $('.box').wookmark(//wanted effects); where .box is the dom elements I've created.
  }

}); 
```

感谢大家的帮助，尤其是 FelixKling 和 Oscar！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:02:52.780

我不确定我是否正确理解它但是你知道你可以调用一个元素的 .click() ，就像`$('.box).click()`你点击元素一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:03:34.117

jQuery “live”（已弃用）或“on”仅适用于 click、dblclick、keydown、keypress、keyup、mousedown、mousemove、mouseout、mouseover 和 mouseup 事件。

但是有一个解决方案，如果您只需要使用`$('selector').on()`或`$('selector').live()`

使用这个库：

**实时查询：** [https ://github.com/brandonaaron/livequery](https://github.com/brandonaaron/livequery)

```
$('selector').livequery(function(){
  // Here goes your on() logic.
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:08:59.480

您正在寻找 .scroll() 事件。试试这个：

```
$(window).scroll(function(e) {
     alert('window scroll');
     // write your fetching data part here
}); 
```

更新：尝试自定义事件方法：

```
// bind the "applyWookmark" event 
$("#container").on("applyWookmark", ".box", function(event){
    // this will reapply the plugin
    $('.box').wookmark();
}); 

// after loading the data
// fire the custom event
$.post("site/scroll.php?mabid=" + $mabid,
    function(data){
    if (data != "") {
        alert($(".box:last").attr("mabid"));
        $(".box:last").after(data);  
        // fire event
        $('.box').trigger('applyWookmark');
    }
} 
```

虽然没有测试...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:44:34.107

一旦获得新数据，您似乎所要做的就是将插件应用于新元素。

直接将其应用于他们：

```
$(data).wookmark(); 
```

或者在将新数据添加到 DOM 后选择所有这些元素：

```
$('.box').wookmark(); 
```

也就是说，我不知道当您将插件多次应用于相同的元素时会发生什么。也许最好只将它应用于新元素。

# android - 在Android中以编程方式选择项目ListView

> ID：10788688
> 
> 赞同：57
> 
> 时间：2012-05-28T17:57:21.470
> 
> 标签：android, listview, highlight

我有两个片段。第一个内部带有按钮，另一个带有`ListView`内部（ListFragment）。

我希望第一个片段（感谢它的按钮）允许用户浏览第二个片段中的 ListView。

所以我希望 ListView 由第一个带有按钮的片段控制。

我在片段之间进行通信（将订单从第一个片段发送到第二个片段）没有问题，但我不知道如何告诉我的 ListView 选择（以编程方式）特定的列表项。

我应该使用哪种 ListView 以及如何告诉 ListView 选择/突出显示/聚焦其中一项？

当用户按下第一个片段的按钮时，我处于触摸模式。

我应该使用`setFocusableInTouchMode(true)`还是`setChoiceMode(ListView.CHOICE_MODE_SINGLE)`其他？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2012-05-28T23:05:03.143

这适用于所有试图：

-**以编程方式选择 ListView 中的项目**

-**使该项目保持突出显示**

我正在研究 Android ICS，我不知道它是否适用于所有级别的 Api。

首先创建一个列表视图（如果您已经在 listActivity/listFragment 中，则获取它）

然后**将列表视图的选择模式设置为 single** with ：`Mylistview.setChoiceMode(ListView.CHOICE_MODE_SINGLE);`

然后以**编程方式选择您的项目**：（`Mylistview.setItemChecked(position, true);`位置是一个整数，表示要选择的项目的等级）

现在您的项目实际上已被选中，但您可能什么也看不到，因为选择没有视觉反馈。现在您有两个选择：**您可以使用预构建的列表视图或自定义列表视图。**

**1)**如果您想要一个预建的列表视图，请尝试`simple_list_item_activated_1`, `simple_list_item_checked`, `simple_list_item_single_choice`, 等...

您可以像这样设置您的列表视图，例如：`setListAdapter(new ArrayAdapter<String>(this, R.layout.simple_list_item_activated_1, data))`

按照您选择的预建列表视图，您现在会看到，当您选中时，您会选中一个复选框或更改背景颜色等...

**2）**如果您使用自定义列表视图，那么您将定义将在每个项目中使用的自定义布局。在此 XML 布局中，您将为行中的每个部分视图指定一个选择器，选择时需要更改该选择器。

假设当您选择您的行时，您希望更改文本颜色和背景颜色。您的 XML 布局可以这样写：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/menu_item_background_selector"
    android:orientation="horizontal" >

<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center_vertical"
    android:textColor="@drawable/menu_item_text_selector" /> 
```

现在，在可绘制文件夹中创建 menu_item_background_selector.xml 和 menu_item_text_selector.xml。

menu_item_text_selector.xml ：

```
 <?xml version="1.0" encoding="utf-8"?>
<selector
xmlns:android="http://schemas.android.com/apk/res/android">

<item android:state_activated="true"
     android:color="#FFF">
</item>

<item android:state_pressed="true"
     android:color="#FFF">
</item>

<item android:state_pressed="false"
     android:color="#000">
</item>

</selector> 
```

选择时文本将是白色的。

然后为你的背景做一些类似的事情：（记住你不是被迫使用颜色，但你也可以使用drawables）

menu_item_background_selector.xml ：

```
<?xml version="1.0" encoding="utf-8"?>
<selector
xmlns:android="http://schemas.android.com/apk/res/android">

        <item android:state_activated="true"
        android:color="#0094CE">
        </item>

        <item android:state_pressed="true"
        android:color="#0094CE">
        </item>

        <item android:state_pressed="false"
        android:color="#ACD52B">
        </item>

      </selector> 
```

此处，选中时背景为蓝色，未选中时为绿色。

我缺少的主要元素是`android:state_activated`. 确实（太多）状态：激活，按下，聚焦，检查，选择......

我不确定我给出的示例是否是最好`android:state_activated`和`android:state_pressed`最干净的示例，但它似乎对我有用。

但是我不需要创建自己的类来获得*自定义 CheckableRelativeLayout*（这很脏而且很可怕），也不需要使用 CheckableTextViews。我不知道为什么其他人使用这种方法，这可能取决于 Api 级别。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-22T11:54:18.030

尝试[AbsListView.performItemClick(...)](http://developer.android.com/reference/android/widget/AbsListView.html#performItemClick%28android.view.View,%20int,%20long%29)

请参阅[这篇文章](https://stackoverflow.com/questions/8094268/android-listview-performitemclick)了解如何使用`performItemClick`.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-10-17T05:48:58.737

这对我有用：

1) 设置列表的选择行为。

```
 mListView.setChoiceMode(ListView.CHOICE_MODE_SINGLE); 
```

2) 设置指定位置的选中状态。

```
mListView.setItemChecked(1,true); //Don't make the same mistake I did by calling this function before setting the listview adapter. 
```

3) 在样式资源 (res/values) 中添加一个新样式，如下所示：

```
<style name="activated" parent="android:Theme.Holo">
<item name="android:background">@android:color/holo_green_light</item>
</style> 
```

随意使用您喜欢的任何颜色。

4)在您的 ListView 中使用之前定义的**样式：**

```
<ListView
        android:id="@+id/listview"
        style="@style/activated"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:divider="@android:color/transparent"
        android:dividerHeight="0dp"/> 
```

或者在您用作行的布局中。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="wrap_content" 
  style="@style/activated"
>
  <!--widgets for your row here-->

</LinearLayout> 
```

希望对任何人都有帮助！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-28T18:00:41.483

尝试`mListView.setSelection(position);`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-12-24T06:20:14.163

杰西米的回答对我有用，除了一小部分。我想分享给其他人。调用`list.setItemChecked( 0, true );`FragmentActivity 的 onCreate() 不起作用。在`getView()`适配器`list.getCheckedItemPosition( )`返回 -1。

我必须从`protected void onPostCreate( Bundle savedInstanceState )`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T17:59:10.443

您可以使用`ListView#setSelection(int)`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-07T05:07:30.860

```
package com.example.samsung;

import com.example.samsung.*;
import com.example.samsung.R;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ListView;
import android.widget.Spinner;
import android.widget.Toast;

public class Firstscreen extends Activity implements OnItemSelectedListener {
    Button btn;
     Spinner sp;
     public String[] product = { "ML-1676P/XIP","SLM2021W/XIP","SL-M2826ND/XIP","SL-M2826ND/XIP","SL-M2826ND/XIP","SL-M3320ND/XIP","SL-M3820ND/XIP","SL-M4020ND/XIP"};  

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_firstscreen);
        btn = (Button) findViewById(R.id.bn);
        sp= (Spinner) findViewById(R.id.sp);
    }
        public void button (View v){
            {

        Intent i = new Intent(Firstscreen.this,ML1676P.class);
        startActivity(i);
        }

        Spinner s1 = (Spinner) findViewById(R.id.sp);
        ArrayAdapter<String> adapter 
        = new ArrayAdapter<String>(this, 
                android.R.layout.simple_spinner_item, product); // find other layout parameters
        s1.setAdapter(adapter);
        s1.setOnItemSelectedListener(new OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onNothingSelected(AdapterView<?> arg0) {
                // TODO Auto-generated method stub

            }

    });
    }

    private Object product() {
            // TODO Auto-generated method stub
            return null;
        }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.firstscreen, menu);
        return true;
    }

    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

    }

} 
```

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".Firstscreen"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/tv1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="#FF35B5E5"
        android:layout_centerInParent="true"
        android:text="CHOOSE THE PRODUCT FROM THE LIST" />

    <Spinner
        android:id="@+id/sp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:drawSelectorOnTop="true" />

    <Button
        android:id="@+id/bn"
        android:layout_width="285dp"
        android:layout_height="wrap_content"
        android:text="       GO             " 
        android:onClick="button"/>

</LinearLayout> 
```

在列表视图中选择一个项目它应该在单击按钮时转到特定的选定项目页面如何操作。代码是上面的代码片段

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-04T11:01:57.047

我喜欢这样：

```
@Override
    public void setUserVisibleHint(boolean isVisibleToUser) {
        super.setUserVisibleHint(isVisibleToUser);
        if (isVisibleToUser) {
            try {
                int pos = 0;
                listview.performItemClick(null, pos, listview.getItemIdAtPosition(pos) );
            } catch (Exception e) {
                e.printStackTrace();
            }
        } 
    } 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-07-12T02:17:23.707

只需将以下行添加到自定义列表视图的布局中：

```
android:background="?android:attr/activatedBackgroundIndicator" 
```

有关完整的工作示例，请参见：

[https://elimelec@bitbucket.org/elimelec/custombaseadapter.git](https://elimelec@bitbucket.org/elimelec/custombaseadapter.git)

# actionscript-3 - Bitamp 中的 BlendMode 数据

> ID：10788697
> 
> 赞同：0
> 
> 时间：2012-05-28T17:58:09.833
> 
> 标签：actionscript-3, flash, bitmap

我正在开发一个从 .swf 文件中提取位图的查看器。它们都被定义为类，所以我可以得到它们：

```
getBitmap = event.target.applicationDomain.getDefinition(name);
getBitmap = new getBitmap; 
```

这些都是图像的不同部分，我必须重建它。我快完成了，唯一缺少的是混合模式。现在，我不知道从哪里获得混合模式。有些部分确实只有普通的混合模式，有些部分有不同的混合模式。

首先，我不知道是否有可能在位图中定义 blendMode。有没有办法从中获取所有信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:22:27.213

不，如果它实际上只是一个位图，那是不可能的，这意味着它实际上是图像的映射，就像坐标到颜色值的笛卡尔图一样，这实际上是一个位图（关于图像位图）。其他格式的图像文件只是所述位图的简单编码版本，以在大多数情况下减少内存大小（颜色可以是 RGB 或 RGB 加 Alpha）。混合模式（在flash中）是在运行时多个对象之间的交互问题，也就是说你如何根据多个对象的混合计算显示值。如果您这样选择，您可以在某个对象上设置混合模式，将其覆盖在另一个对象上，将生成的容器绘制到位图然后提取颜色信息，但是当您存储图像时，没有与之关联的混合模式感（除非它' s 一些专有格式，如 PSD 或其他格式，但不是任何常见的图像格式）。在位图的情况下，与“混合”相关的唯一值是 alpha 值，它确定对象背后的颜色有多少会影响该像素的显示颜色，或者更确切地说，该像素会影响多少颜色它铺好了。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BlendMode.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BlendMode.html)

^注意混合模式是 DisplayObject 的一个属性，BitmapData 不从该属性扩展，因此尽管有任何其他知识，但很明显 BitmapData 本身没有 blendMode 您在 blendMode 的 BitmapData 文档中可以找到的唯一信息是关于draw 方法在这种情况下， blendMode 用于设置像素值，但随后不是 BitmapData 的可访问属性。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html)

只是想我会为超级书呆子们提供更多细节（那些无疑是因为我缺乏对 CMYK 和色彩空间的参考而感到不安）。我知道您可以使用其他颜色模型，例如 CMYK，它是减色而不是加色，是打印中使用的方法，但是对于显示器，它全部转换为某种 RGB，因为光以加色性质工作。RGB 可能是 8 位即 256 色、16 位 65,536 色、24 位 16,777,216 色或 32 位 4,294,967,296 色（如果包含 A，它是增加色彩空间的另一个位深度因子，但 A 确实唯一与“混合”有关的事情）。我几乎肯定任何高于 32 位的东西都高于我们区分的阈值，更不用说大脑通过相对变化处理视觉数据的方式，它可能不是

除了颜色模型之外，还有将值映射到实际显示颜色的颜色空间（我的朋友告诉我，这在 Android Honeycomb 的某些版本中进行了调整，以降低一些人喜欢而另一些人对此感到愤怒的饱和度）。

这最终会渗透到生物学和对视锥细胞和视杆细胞的研究，以及光子如何刺激它们以及它们如何相互作用，然后这些信息如何在眼睛的神经束中编码，如何通过视觉皮层发送，最终我们的大脑如何解释这些信号，由于所述生物学和头部发育的所有层面的差异，这在人类之间会有所不同。无论如何，这已经超出了我个人的书呆子专业领域，所以如果他们愿意的话，我会让生物学书呆子们去扩展。在这里似乎是很好的解释：[http](http://webvision.med.utah.edu/book/part-ix-psychophysics-of-vision/the-primary-visual-cortex/) ://webvision.med.utah.edu/book/part-ix-psychophysics-of-vision/the-primary-visual-cortex/虽然它需要比我更多的理解是时候深入研究了。

我感兴趣的另一部分是硬件能够准确地重新创建最终在应用色彩空间后确定的值。所有电子元件都存在一定程度的误差/可变性（很像我们的眼睛/大脑），因此毫无疑问，硬件甚至工作温度和其他环境因素都会存在差异。无论如何，我确信我现在已经陷入了太深，让我知道如果第一部分没有回答你的问题。

# validation - 如果值已更改，如何签入验证器？

> ID：10788701
> 
> 赞同：3
> 
> 时间：2012-05-28T17:58:41.420
> 
> 标签：validation, jsf, default-value

我知道我可以通过`UIInput#getValue()`.

但在许多情况下，当字段绑定到一个 bean 值时，我想获得默认值，如果输入等于默认值，我不需要验证。

如果某个字段具有唯一约束并且您有一个编辑表单，这将非常有用。
验证总是会失败，因为在检查约束方法中它总是会找到自己的值，从而验证为假。

一种方法是将默认值作为属性传递，`<f:attribute>`并在验证器内部进行检查。但是有没有更简单的内置方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:10:01.453

提交的值仅可用作实现中`value`的参数`validate()`。

```
public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException {
    Object oldValue = ((UIInput) component).getValue();

    if (value != null ? value.equals(oldValue) : oldValue == null) {
        // Value has not changed.
        return;
    }

    // Continue validation here.
} 
```

另一种方法是`Validator`将`ValueChangeListener`. 只有当值真正改变时才会调用它。它有点 hacky，但它完成了你真正需要的工作。

```
<h:inputText ... valueChangeListener="#{uniqueValueValidator}" /> 
```

或者

```
<h:inputText ...>
    <f:valueChangeListener binding="#{uniqueValueValidator}" />
</h:inputText> 
```

和

```
@ManagedBean
public class UniqueValueValidator implements ValueChangeListener {

    @Override
    public void processValueChange(ValueChangeEvent event) throws AbortProcessingException {
        FacesContext context = FacesContext.getCurrentInstance();
        UIInput input = (UIInput) event.getComponent();
        Object oldValue = event.getOldValue();
        Object newValue = event.getNewValue();

        // Validate newValue here against DB or something.
        // ...

        if (invalid) {
            input.setValid(false);
            context.validationFailed();
            context.addMessage(input.getClientId(context),
                new FacesMessage(FacesMessage.SEVERITY_ERROR, "Please enter unique value", null));
        }
    }

} 
```

请注意，您不能在`ValidatorException`那里抛出一个，这就是为什么需要手动将组件和面上下文设置为无效并手动添加组件的消息。这`context.validationFailed()`将强制 JSF 跳过更新模型值并调用操作阶段。

# c - 这个#define 是否等同于C 中的这个变量定义？

> ID：10788712
> 
> 赞同：2
> 
> 时间：2012-05-28T17:59:43.367
> 
> 标签：c, microchip, microprocessors

考虑一下`#define`：

```
#define msd_buffer              ((volatile char *) MSD_BUFFER_ADDRESS) 
```

和这个变量定义：

```
volatile char *msd_buffer = MSD_BUFFER_ADDRESS; 
```

`msd_buffer`作为变量和作为宏的两个定义是等价的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:03:11.020

A`#define`是一个宏。它充当您传递给它的内容的直接复制面。所以，`msd_buffer`不是一个变量，它是一个 volatile char 数组的强制转换。

假设示例用法如下：

```
msd_buffer[160] = 0xFF; 
```

这与将其用作变量相同。但是，它不具备变量的所有特性，例如赋值：

```
msd_buffer = NEW_BUFFER_ADDRESS; // invalid! 
```

或取地址：

```
my_func(&msd_buffer); // invalid! 
```

如果您了解这些缺点（也许还有更多），那么您就可以使用这样的宏了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:03:06.117

定义语句只是文本替换。而已。所以在你的情况下，不是真的。

# mysql - 如何创建 SQL 测试环境？

> ID：10788723
> 
> 赞同：1
> 
> 时间：2012-05-28T18:01:42.950
> 
> 标签：mysql, sql, testing, localhost, sqlfiddle

**目标：**我正在尝试确定表结构和查询的最佳方法；即，如何最好地创建复合索引键来优化每个表中大约 500k 行的四表连接。

**心理障碍：**这是表的构建并用我不理解的测试数据填充它们（SQL 菜鸟）。[这篇 SO 帖子](https://stackoverflow.com/questions/3534597/rewriting-mysql-select-to-reduce-time-and-writing-tmp-to-disk/3535735#3535735)描述了我试图解决的 75% 的问题，我想如果我可以让[答案的代码](http://pastie.org/1105206)在我的本地主机（apache2、mysql5.1、phpMyAdmin）上运行，我可以完成我的理解。

**请求帮助：** Jake Feasel 的[sqlfiddle](http://sqlfiddle.com/)站点是一个很棒的工具，但据他说，它并没有扩展到那个级别。但是，有人可以使用 sqlfiddle 向我展示如何在本地机器上构建这个环境吗？我希望推断您的 sqlfiddle 帖子以复制我上面提到的示例代码。

**一个假设：** 我的大部分 SQL 经验一直在调整[ADOdb 数据库抽象库](http://adodb.sourceforge.net/)，但我意识到 MYSQL 代码在测试环境中会略有不同。不过，我假设通过了解如何设置本地 SQL 测试环境以及随后的数据库结构和查询将获得的优化知识在 ADOdb 环境中实施时将适用且有益。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:34:59.427

你真正需要的是一个数据生成器工具，它可以帮助你用数千或数百万条记录填充数据库，在你拥有一个包含有意义数据的臃肿数据库之后，你可以开始你的性能测试，尝试最好的关系、索引和连接，这将有助于您检测到真正需要优化的内容。

我过去个人使用的一个是：[GenerateData](http://www.generatedata.com/#generator) 但还有[其他](http://www.webresourcesdepot.com/test-sample-data-generators/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:44:06.867

[http://sqlfiddle.com/#!2/b771b/2](http://sqlfiddle.com/#!2/b771b/2)

在这里，您可以看到我已复制您的表定义并将它们粘贴到架构面板中。我还在其中添加了一些虚拟数据。使用该基本结构，我也执行了您的查询；您可以看到它生成的执行计划与您的馅饼显示的执行计划相同（展开小提琴上的“+ 查看执行计划”）。

您可以看到它在 SQL Fiddle 上运行良好。这解决了您标题中的问题（“如何创建 SQL 测试环境”）。您的其他请求的哪一部分“我如何在我的本地机器上构建这个环境？” 你有麻烦吗？

# php - php, ajax, html 选择元素

> ID：10788726
> 
> 赞同：0
> 
> 时间：2012-05-28T18:02:05.773
> 
> 标签：php, javascript, ajax

我正在开发这个小应用程序，但遇到了一个小问题。

我有 3 个下拉菜单（`name`、`date`和`path`）。用户将选择一个名称，然后该用户的日期应显示在日期下拉菜单中。然后用户选择一个日期，然后路径名称将显示在相应的下拉菜单中。然后用户选择一条路径，此时发生其他无关紧要的事情。

我在服务器端使用 PHP（我对它很满意）和我基本上没有经验的 javascript/ajax。据我了解，我需要使用 AJAX 技术，这样整个页面就不必重新加载这些下拉菜单。

我生成了名称下拉菜单，但很难弄清楚如何做日期和路径。

现在我有一些简单的吸气剂（其中一个在下面），我认为它们可以帮助我完成我想要完成的事情（如果这些没有帮助，请纠正我）。我也一直在读一本关于 AJAX 的书并在互联网上进行研究，但没有弄清楚其他任何东西。任何帮助表示赞赏。

```
function getName(){<br/>
    var nameSelect = document.getElementById("names");<br/>
    var selectedName = nameSelect.options[nameSelect.selectedIndex].text;<br/>
    return selectedName;<br/>
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:35:53.590

使用 jQuery，它将帮助您忘记浏览器并专注于编码。

假设这是您的 HTML 和 Javascript

```
<html>
<head>
    <title>Dropdowns</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
        // Detect if a change to the name dropdown is made
        $("#name").change(function() {

        // Setup the AJAX call (this is a call which expects JSON as response)
        $.ajax({
            url: "http://example.com/api.php",
            type: "json",                        
            // Specify the GET parameter "name" with the value from the name dropdown
            data: {
                name: $("#name").val()
            },

            // If AJAX was successfull add the regarding values to the date dropdown
            success: function() {               
                // The response from PHP contains an array encoded in JSON.
                // This means, we have to loop trough the results
                $.each(data.directors, function() {
                    $("#date").append(
                        // This actually appends the value on the date dropdown
                       $("<option></option>").val(this.value).html(this.label)
                    )
                });
            }
       });

       // Detect if a change to the date dropdown is made
       $("#date").change(function() {

       // Setup the AJAX call (this is a call which expects JSON as response)
       $.ajax({
           url: "http://example.com/api.php",
           type: "json",
           // Specify the GET parameter "date" with the value from the date dropdown
           data: {
               date: $("#date").val()
           },

           // If AJAX was successfull add the regarding values to the path dropdown
           success: function() {

              // The response from PHP contains an array encoded in JSON. This means, we have to loop trough the results
              $.each(data.directors, function() {
                   $("#path").append(
                       // This actually appends the value on the path dropdown
                       $("<option></option>").val(this.value).html(this.label);
                   )
               });
           }
     });
    </script>
</head>

<body>
   <form name="someform">
       <select name="name" id="name">
           <option value="1">John Smith</option>
           <option value="2">Peter Johnson</option>
       </select>

       <select name="date" id="data">
           <option value=""></option>
       </select>

       <select name="path" id="data">
           <option value=""></option>
       </select>
   </form>
</body>
</html> 
```

你需要一个 PHP 文件，它输出如下数据：

```
<?php
if($_GET['name'] != "" && isset($_GET['name'])) {
    // Now you'd need some logic to generate an array, containing the information for this name
    // We'll just create one manually now

    $dates = array();

    $dates[]['value'] = "349876973";
    $dates[]['label'] = "Date description 1";
    $dates[]['value'] = "783693876";
    $dates[]['label'] = "Date description 2";

    echo json_encode($dates);
} elseif($_GET['date'] != "" && isset($_GET['date'])) {
    // Now you'd need some logic to generate an array, containing the information for this date
    // We'll just create one manually now

    $paths = array();

    $dates[]['value'] = "path value 1";
    $dates[]['label'] = "Path description 1";
    $dates[]['value'] = "path value 2";
    $dates[]['label'] = "Path description 2";

    echo json_encode($paths);
} 
```

我无法对其进行测试，但希望它能让您对 AJAX 和 jQuery 有所了解。还可以查看[jQuery 文档](http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery)和 API 参考，其中解释了可用的方法和选项。

更新：您不必使用 value 和 label 作为数组键名。但是，如果您愿意，您可以创建一个看起来像这样的查询（这是一个 PDO 示例，您可能想要进入 PDO，因为它为您节省了转义输入的麻烦，并使重复查询更容易）。这将需要 PHP 的[PDO 函数](http://ch.php.net/manual/de/book.pdo.php)，如果您在主机上，可能已经安装了这些函数。

包括/db.include.php

```
<?php
class example {
    // Create database connection
    public function __construct() {
        $this->db = new PDO("pgsql:host=localhost;dbname=exampledb;", "user", "password");
        if(!$this->db) {
            die("Connection failed!");
        }
    }

    // Get dates
    public function getDates($name) {
        $sql = "SELECT
                    date AS value, datedescription AS label
                FROM
                    some_table
                WHERE
                    name = ?";

        $stmt = $this->db->prepare($sql);

        $stmt->bindParam(1, $name);

        if(!$stmt->execute()) {
            // Only for debugging, wouldn't use this on production
            var_dump($stmt->errorInfo());
        }

        $result = $stmt->fetchAll(PDO::FETCH_ASSOC);

        return $result;
    }

    // Get paths
    public function getPaths($date) {
        $sql = "SELECT
                    path AS value, pathdescription AS label
                FROM
                    another_table
                WHERE
                    date = ?";

        $stmt = $this->db->prepare($sql);

        $stmt->bindParam(1, $date);

        if(!$stmt->execute()) {
            // Only for debugging, wouldn't use this on production
            var_dump($stmt->errorInfo());
        }

        $result = $stmt->fetchAll(PDO::FETCH_ASSOC);

        return $result;
    }

    // Close database connection
    public function __destruct() {
        @$this->db->close();
    }
}

?> 
```

在你的 api.php 中你会这样

```
<?php
include 'includes/db.include.php';

$example = new example;

if(isset($_GET['name'])) {
    echo json_encode($example->getDates($_GET['name']));
} elseif(isset($_GET['date'])) {
    echo json_encode($example->getPaths());
} 
```

但正如我所说，您也可以更改 jQuery 代码，因此您的列不必命名为 value 和 label。假设您的日期表列称为“日期”和“日期描述”，您只需使用此代码

```
$.each(data.directors, function() {
    $("#date").append(
        // This actually appends the value on the date dropdown
        $("<option></option>").val(this.date).html(this.datedescription)
    )
}) 
```

# android - 如何获取 zxing 扫描结果并使用它们？

> ID：10788728
> 
> 赞同：0
> 
> 时间：2012-05-28T18:02:17.657
> 
> 标签：android, android-intent, zxing, qr-code

我是发展中国家的新人。我正在尝试在扫描 QR 图像后处理结果。我正在使用 Zxing 库。现在只有内容字符串可以检索任何数据。但我想扫描 qr 图像以获取 URL、telno 和字符串 /text（这将是一个编号的数量）。您能否举个例子，我如何获取 telno 和 text 的数据并存储在字符串中。目前只有一个 SCAN_RESULT 存储在内容中，但是如何从一个 QR 码一次获得多个结果。

```
private void onQrActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub

    if (requestCode == 0) {
        if (resultCode == RESULT_OK) {
            Log.d(TAG, "onActivityResult " + resultCode);
            String contents = data.getStringExtra("SCAN_RESULT");
            String format = data.getStringExtra("SCAN_RESULT_FORMAT");
            paymentmsg.setText(contents);
            value_Qr = Float.parseFloat(contents);
            // Toast.makeText(this, format, Toast.LENGTH_SHORT).show();
            format = data.getStringExtra("SCAN_RESULT_FORMAT");
            // Handle successful scan
        }
        else if (resultCode == RESULT_CANCELED) {
            // Handle cancel
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T12:35:10.450

您必须解析结果。结果在内容字符串中。解析内容字符串。如果您的二维码是联系方式

```
if(contents.startsWith("BEGIN:")){

                    String[] tokens = contents.split("\n");

                    for (int i = 0; i < tokens.length; i++)
                        {
                        System.out.println(" "+tokens[i]);

                        if(tokens[i].startsWith("BEGIN:"))
                        {
                            Type= tokens[i].substring(6);
                        }
                        else if(tokens[i].startsWith("N:"))
                        {
                             Name= tokens[i].substring(2);
                        }
                        else if(tokens[i].startsWith("ORG:"))
                        {
                             Org= tokens[i].substring(4);
                        }
                        else if(tokens[i].startsWith("TEL:"))
                        {
                             Tel= tokens[i].substring(4);
                        }
                        else if(tokens[i].startsWith("URL:"))
                        {
                             Url= tokens[i].substring(4);
                        }
                        else if(tokens[i].startsWith("EMAIL:"))
                        {
                             Email= tokens[i].substring(6);
                        }
                        else if(tokens[i].startsWith("ADR:"))
                        {
                              Adr= tokens[i].substring(4);
                        }
                        else if(tokens[i].startsWith("NOTE:"))
                        {
                              Note= tokens[i].substring(5);
                        }

                        } 
```

如果您的 qr scannrd 是 url

```
else if(contents.startsWith("http://")||(contents.startsWith("www."))){

                    qr_url= contents; 
```

如果您扫描的 qr 是位置 qr

```
else if(contents.startsWith("geo:")){

                    String delims = "[ , ?q= ]+";
                    String[] tokens = contents.split(delims);

                    for (int i = 0; i < tokens.length; i++)
                    {
                        System.out.println(" "+tokens[i]);
                        if(tokens[i].startsWith(" geo:"))
                        {
                              qr_latitude= tokens[i].substring(4);

                        }
                    }
                    qr_latitude= tokens[0].substring(4);
                    qr_longitude=tokens[1];
                    geo_place=tokens[2]; 
```

依此类推，您可以解析结果。它的全部内容都是关于如何解析字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T06:48:52.517

当然，一个二维码意味着一个扫描结果。您可以取回字符串、原始字节和其他一些元数据。如果你想将字符串解析成组件，你必须自己做，但你可以在你的应用程序中重新使用这个`ResultParser`类`core/`来轻松地做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-28T08:03:03.207

我认为下面的这段代码会帮助你：

```
 ParsedResult tmpParseVcard = ResultParser.parseResult(result.getResult());
                AddressBookParsedResult vcardParsedResult = (AddressBookParsedResult) tmpParseVcard;
                Toast.makeText(MainActivity.this, "VCARD" + Arrays.toString(vcardParsedResult.getPhoneNumbers()), Toast.LENGTH_SHORT).show();
                Log.e("Phone number", Arrays.toString(vcardParsedResult.getPhoneNumbers()));
                Log.e("Phone Type", Arrays.toString(vcardParsedResult.getPhoneTypes())); 
```

//AddressBookParsedResult - vcard //SMSParsedResult - sms ...等

# scala - Java/斯卡拉 | 登录网站

> ID：10788730
> 
> 赞同：5
> 
> 时间：2012-05-28T18:02:33.370
> 
> 标签：scala

我有一个问题..我想从网站上下载一些信息到 XML（我知道怎么做），我知道如何从网站上获取信息，但问题是我什么时候需要登录。

它的部分代码：

```
 <form method="post" action="logowanie.php">
  <table class="center">
   <tr>
    <td><label for="username">Login:</label></td>
    <td><input type="text" name="username" value=""></td>
    <td rowspan="2"><div class="submit"><input type="submit" value="OK" name="submit"></div></td>
   </tr>
   <tr>
    <td><label for="password">Hasło:</label></td>
    <td><input type="password" name="password" value=""></td> 
```

我需要一些如何输入用户名密码并按下按钮提交。有什么想法，代码示例怎么做？非常感谢。

我是用 Java/Scala 做的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:52:59.057

虽然 Apache`HttpClient`可以工作，但在 Scala 中使用它是单一且冗长的，而且[Dispatch](http://dispatch.databinder.net/Dispatch.html)库提供了一个很好的 Scala 包装器，可以让您编写更简洁的代码。你可以像这样使用它：

```
import dispatch._

val u = url("https://site.com/logowanie.php")
val info = Seq("username" -> "me", "password" -> "secret")

val client = new Http
client(u << info >>> System.out) 
```

此示例将简单地打印响应，但您可以轻松地提供更复杂的方法来处理响应，并且您`client`现在拥有继续与站点交互所需的 cookie。

下面是一个更复杂的示例，我用于登录系统，该系统要求我在登录之前从表单中获取生成的标识符：

```
import dispatch._
import dispatch.jsoup.JSoupHttp._

val u = url("https://myuni.edu/something/login")
val info = Seq(
  "username"  -> "me",
  "password"  -> "secret",
  "warn"      -> "true",
  "submit"    -> "LOGIN",
  "execution" -> "e1s1",
  "_eventId"  -> "submit"
)

val client = new Http
val id = client(u </> (_.select("input[name=lt]").first.attr("value")))
client(u << info :+ ("lt" -> id) >>> System.out) 
```

这里我使用 Dispatch 的[JSoup](http://dispatch.databinder.net/JSoup.html)支持来解析表单页面并提取我需要的标识符，然后我可以在提交请求时将其添加到表单参数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:41:52.323

您可以使用[Apache Http 客户端](http://hc.apache.org/httpcomponents-client-ga/ "httpclient")。这是在 scala 中使用它的教程：

[http://metacircular.wordpress.com/2007/02/07/towards-polite-http-retrieval-in-scala/](http://metacircular.wordpress.com/2007/02/07/towards-polite-http-retrieval-in-scala/)

基本上，你：

1.  实例化一个 httpClient
2.  使用用户名和密码参数向 logowanie.php 发出 POST 请求
3.  使用相同的 httpClient 实例发出 GET 请求以获取您想要的页面

# ios - UISplitView 中 detailsView 中的 MPMoviePlayerViewController 在全屏和旋转时无法调整大小

> ID：10788731
> 
> 赞同：1
> 
> 时间：2012-05-28T18:02:34.760
> 
> 标签：ios, ipad, fullscreen, uisplitviewcontroller

我在 iPad 上发现了一个错误。让我们启动一个简单的应用程序 iPAD UISplitView，它在 detailView 中播放视频。

如果 MPMoviePlayerViewController 切换到全屏，然后旋转屏幕，然后退出全屏：视图没有很好地排列（它们应该是自动排列的！）加上状态栏没有更好地放置......

您对这种错误行为有窍门吗？

非常感谢。斯蒂芬妮

# python - 我班级中的数组给了我一个错误... AttributeError: 'set' object has no attribute 'index'

> ID：10788734
> 
> 赞同：0
> 
> 时间：2012-05-28T18:03:03.560
> 
> 标签：python, arrays, compiler-errors, set

我有这个代码：

```
level = {0, 0, 0,
         0, 1, 0,
         0, 0, 0}

class player:
    def getPlayerLoc(self, level):
        for i in level:
            if level[level.index(i)] == 1:
                print "Player location = " + str(i)

p1 = player()
p1.getPlayerLoc(level) 
```

当我运行它时，它说：

```
Traceback (most recent call last):
  File "gamy.py", line 13, in <module>
    p1.getPlayerLoc(level)
  File "gamy.py", line 8, in getPlayerLoc
    if level[level.index(i)] == 1:
AttributeError: 'set' object has no attribute 'index' 
```

看起来它正在将我的数组转换为一个集合对象。为什么会这样，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:06:47.193

```
level = {0, 0, 0,
         0, 1, 0,
         0, 0, 0} 
```

`{}`括号表示`set`，将其声明为`list`：

```
level = [0, 0, 0,
         0, 1, 0,
         0, 0, 0] 
```

例如

```
>>> level = {0, 0, 0,
         0, 1, 0,
         0, 0, 0}
>>> level
{0, 1}  # because set only contains unique elements

>>> level = [0, 0, 0,
         0, 1, 0,
         0, 0, 0]
>>> level
[0, 0, 0, 0, 1, 0, 0, 0, 0] 
```

# ruby-on-rails - 在 Rails 中更新孤立记录

> ID：10788743
> 
> 赞同：0
> 
> 时间：2012-05-28T18:03:30.170
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有一个`Type has_many Dresses`. 在`Dress`表中，我有一列名为`type_id`，它引用了`Type`模型。我想要做的是每当一个`Type`对象被删除时，所有关联的`Dress`对象都会将它们更新`type_id`为`nil`.

到目前为止，我在控制台中尝试了这个并且它有效：

```
> Dress.where(type_id: 3).update_all(type_id: nil) 
```

但是，当我这样翻译它时`TypesController`：

```
def destroy
  type_id = params[:id]
  if Type.find(type_id).destroy
    Dress.where(:type_id => type_id).update_all(:type_id => nil)
    redirect_to admins_path
  end
end 
```

...并在浏览器中尝试，该`Type`对象已删除但未`Dress` `type_id`更新。

这是日志输出：

```
DELETE FROM "types" WHERE "types"."id" = $1  [["id", 3]]
UPDATE "types" SET position = (position - 1) WHERE (1 = 1 AND position > 2)
COMMIT
UPDATE "dresses" SET "type_id" = NULL WHERE "dresses"."id"
  IN (SELECT "dresses"."id" FROM "dresses" WHERE "dresses"."type_id" = 0) 
```

我不明白为什么它`type_id = 0`在最后一个`UPDATE`命令中设置，但在此之前它在`DELETE`命令中正确设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:53:37.543

```
class Type < ActiveRecord::Base
    has_many :dresses, :dependent => :nullify
    ...
end 
```

它不起作用吗？

# c# - 将cryptoStream和泛型传递给C#中的WebMethod

> ID：10788753
> 
> 赞同：0
> 
> 时间：2012-05-28T18:04:20.983
> 
> 标签：c#, asp.net, web-services, cryptography

我有以下变量的数据。

```
CryptoStream searialNumber = encryptedSearialNumber;
Dictionary<string, object> x= userInput;
Dictionary<string, object> y= hardwareInfo; 
```

我想将这些作为参数传递给`WebMethod`ASP.NET XML (asmx) Web 服务。我知道如果不将它们更改为适当的数据类型，我就无法传递这些参数。因为它们不能被序列化。

任何人都可以建议一种将这些参数传递给网络方法的标准方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T02:28:19.550

我想知道为什么这个问题只被查看了 33 次。我确信我至少点击了 20 次来查找是否有人回答。我的问题有问题吗？我用不同的方法解决了这个问题。

`Cryptostream to bytes`将by更改为`MemoryStrem`也创建`custom serialize classes`以替换字典并将它们传递给 web 方法。

# java - Akka 转换为 dalvik 失败

> ID：10788754
> 
> 赞同：0
> 
> 时间：2012-05-28T18:04:22.393
> 
> 标签：java, android, eclipse, akka, dalvik

我想在我的 android 应用程序中使用 akka，但在转换过程中出现以下错误：

```
Dx processing akka/kernel/Main$.class...
Dx processing akka/kernel/Main$$anon$1.class...
Dx 
trouble writing output: No expanded opcode for 01ffb17a AkkaException.scala:20@000b:     invoke-direct v0:NffffLakka/AkkaException$$anonfun$stackTraceToString$1;,      scala.runtime.AbstractFunction1.<init>:()V
Conversion to Dalvik format failed with error 2 
```

我正在使用 akka 2.0.1 和 adt 18.0.0.v201203301601-306762。

有没有办法克服这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:55:08.617

您似乎达到了 dex 文件中 64k 方法引用的限制。除了减少该 dex 文件中代码的大小之外，您无能为力。通过删除代码，或者将一些类拆分到一个单独的 dex 文件中。

# php - PHP：防止记录相同的错误？

> ID：10788760
> 
> 赞同：1
> 
> 时间：2012-05-28T18:04:54.550
> 
> 标签：php

我检查了`ignore_repeated_errors`ini 指令，但它似乎只处理同一个文件上的相同错误。如果 php 文件由多个用户运行，它仍然会记录错误。

我正在寻找的是一种解决方案，如果它已经存在于日志文件中，它可以防止记录相同的错误。因此，即使错误发生在多个用户身上，它也应该只反映日志中的一个错误。

实现这一目标的最佳方法是什么？

编辑：目前看来，实现这一目标的唯一方法是使用自定义错误处理程序，然后在记录错误之前检查是否存在相同的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:07:02.643

也许这会有所帮助：

[PHP 手册：忽略重复源](http://www.php.net/manual/en/errorfunc.configuration.php#ini.ignore-repeated-source)

# javascript - jQuery：单击时，防止 mouseenter 事件

> ID：10788767
> 
> 赞同：6
> 
> 时间：2012-05-28T18:06:10.590
> 
> 标签：javascript, jquery, mouseevent

我有两个单独的动画正在发生，一个`mouseenter`在`click`. 问题是当它们都被激活时，它会创建一个跳跃的动画。

你可以在这里看到我的意思：[JSFiddle](http://jsfiddle.net/HDAYt/)

如果事件被激活，是否可以防止`mouseenter`事件发生？`click`

**Javascript**

```
$('header h1').mouseenter(function() {
  $('header:not(.open)').delay(500).animate({
    'padding-bottom': '40px'
  }, 150, function() {
    //function complete
  });
});

$('header h1').mouseleave(function() {
  $('header:not(.open)').animate({
    'padding-bottom': '20px'
  }, 150, function() {
    //function complete
  });
});

$('header h1').click(function() {

  if ($('header').hasClass('open')) {
    $('header p').fadeOut(100);
    $('header').removeClass('open').animate({
      'padding-bottom': '20px'
    }, 300, function() {
      //animation complete
    });
  }

  else {
    $('header').addClass('open').animate({
      'padding-bottom': '150px'
    }, 300, function() {
      $('header p').fadeIn();
    });
  }

});​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:47:59.730

这样做似乎更容易：

```
$('header').on({
    mouseenter: function(e) {
        if (!$(this).is('.open')) {
            $(this).stop(true, true).delay(500).animate({'padding-bottom': '40px' }, 150, function() {
                //function complete
            });
        }
    },
    mouseleave: function(e) {
        if (!$(this).is('.open')) {
            $(this).stop(true, true).animate({'padding-bottom': '20px'}, 150, function() {
            //function complete
            });
        }
    },
    click: function() {
        if ($(this).is('.open')) {
            $(this).find('p').fadeOut(100).end().removeClass('open').stop(true, true).animate({'padding-bottom': '20px'}, 300, function() {
                //animation complete
            });
        }else{
            $(this).addClass('open').stop(true, true).animate({'padding-bottom': '150px'}, 300, function() {
                $('p', this).fadeIn();
            });
        }
    }
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:21:01.277

不，你不能。特别是因为这些事件是基于彼此的：要单击一个元素，您需要用鼠标输入它：您无法取消激活`enter`单击时已经发生的事件。`click`而且您显然不应该在进入时停用未来的事件。

跳跃动画问题的解决方案应该是[`stop()`方法](http://api.jquery.com/stop/)，它结束在选定元素上运行动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:21:23.420

`open`延迟后检查课程怎么样。

从改变

```
$('header h1').mouseenter(function() {
  $('header:not(.open)').delay(500).animate({
    'padding-bottom': '40px'
  }, 150, function() {
    //function complete
  });
}); 
```

到

```
$('header h1').mouseenter(function() {
  $.delay(500);
  $('header:not(.open)').animate({
    'padding-bottom': '40px'
  }, 150, function() {
    //function complete
  });
}); 
```

显然，您可以根据自己的喜好微调延迟，但想法类似于：

`x`如果他们在毫秒前没有点击，增加填充。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:23:43.413

听起来你需要[`.stop()`](http://api.jquery.com/stop/)。

将此添加到`click`活动的开头：

```
$('header').stop(true) 
```

true 的第一个参数是`clearQueue`，它将清除您的动画队列。

看到这个[jsFiddle](http://jsfiddle.net/NznC8/)。

# mysql - 如何将没有主键的表复制到另一个表

> ID：10788768
> 
> 赞同：7
> 
> 时间：2012-05-28T18:06:12.770
> 
> 标签：mysql, sql

我想将一张表复制到另一张表。

例如我有桌子`Data(ID, time, serial_number...)`，我有`Temp_data(ID, time, serial_number...)`

如何复制没有主键 ( `ID`) 的所有项目。

我正在使用MYSQL，我已经尝试过`INSERT INTO Data SELECT * FROM Temp_data;`

问题出在主键上。这两个表都已经有了值，我需要复制除 ID 之外的所有内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T18:06:59.607

而不是`SELECT *`，拼出您想要的列：

```
INSERT INTO Data (time, serial_number...)
  SELECT (time, serial_number...) FROM Temp_data; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T18:09:21.303

您必须在查询中定义列名，否则它将插入所有列

```
INSERT INTO tbl2 (column1, column2)
    SELECT tbl1.col1, tbl1.col2 FROM tbl1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-19T07:03:19.767

这是一个非常烦人的问题，因为每次您需要更新列时，您还需要更新复制它们的代码。这是我用来解决问题并使代码面向未来的解决方案：

```
 DROP TABLE IF EXISTS TempData;
    CREATE TEMPORARY TABLE TempData (LIKE Data);

    INSERT INTO TempData SELECT * FROM Data;

    ALTER TABLE TempData CHANGE COLUMN `id` `id` INT(11) NULL, DROP PRIMARY KEY;
    UPDATE TempData SET id = 0;

    INSERT INTO Data SELECT * FROM TempData;
    DROP TABLE IF EXISTS TempData; 
```

快速、简单且一次编写，只要源表名相同，每次都有效。

# meteor - 如何使用 CouchDB 作为 MeteorJS 应用程序的后端数据库，而不是默认的 MongoDB？

> ID：10788769
> 
> 赞同：11
> 
> 时间：2012-05-28T18:06:17.617
> 
> 标签：meteor, couchdb, pouchdb

真的很想使用[CouchDB](http://en.wikipedia.org/wiki/CouchDB)，也许让[Meteor应用程序通过](http://en.wikipedia.org/wiki/Meteor_%28web_framework%29)[Meteor Publish 和 Subscribe](http://docs.meteor.com/#publishandsubscribe)获取数据更新。但似乎无法弄清楚如何将[Meteor](http://en.wikipedia.org/wiki/Meteor_%28web_framework%29)应用程序与[CouchDB](http://en.wikipedia.org/wiki/CouchDB)而不是[默认的](http://docs.meteor.com/#dataandsecurity) [MongoDB](http://en.wikipedia.org/wiki/MongoDB)连接起来。请帮忙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-11-03T03:04:55.760

现在，您可以使用 CouchDb 和 Meteor 作为 MongoDB 的替代品。Cloudant 的人已经从 Meteor 创建了 Couchdb 集成。

最好的是它的 API 类似于 Meteor 中 Mongo 的 API。这是包和详细信息：[https ://github.com/cloudant/meteor-couchdb/](https://github.com/cloudant/meteor-couchdb/)

享受 ：）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-08T08:44:20.893

尤其是[这种（Meteor+CouchDB）似乎越来越没有发生](https://stackoverflow.com/questions/10788769/how-do-i-use-couchdb-as-backend-database-to-a-meteorjs-app-instead-of-the-defau#comment-38165255)的情况下， **[PouchDB](http://google.com/search?q=pouchdb)是我发现的最接近的替代方案，**所以我打算从它开始。

我发现[PouchDB值得注意：](http://pouchdb.com/)

1.  能够与 2 个主要的 CouchDB 主机同步，有[（我最喜欢的）Cloudant](https://cloudant.com/blog/pouchdb/)的精彩介绍，以及您自己的主机[http://pouchdb.com/faq.html](http://pouchdb.com/faq.html)
2.  [非常跨平台](http://pouchdb.com/learn.html)，与[Meteor](http://docs.meteor.com/#appcache)相比，还具有[很好的兼容性故障](http://pouchdb.com/adapters.html#pouchdb_in_the_browser)，并支持 Safari Desktop 加：
3.  它对服务器数据库的客户端模拟感觉比 Meteror 更强大、更远，确实[PouchDB 可以成为它自己的服务器（在 Node 上运行）](https://github.com/pouchdb/pouchdb-server)，
4.  它有[一个令人印象深刻的强大外部项目列表，包括插件](http://pouchdb.com/external.html)- 看看，包括：
    1.  “Peer Pouch”（p2p --doubt Meteor 可以做到）
    2.  全文和空间搜索
    3.  缺少[Meteor 令人印象深刻的身份验证（包括 Meetup 帐户！）](http://docs.meteor.com/#dataandsecurity-authentication)，但 CouchDB 的基本身份验证似乎已经存在并且已经很强大（根据 [https://github.com/nolanlawson/pouchdb-authentication](https://github.com/nolanlawson/pouchdb-authentication)），并且[提到了](https://github.com/nolanlawson/pouchdb-authentication#project-status)令人印象深刻的身份验证：[http://en .wikipedia.org/wiki/Mozilla_Persona](http://en.wikipedia.org/wiki/Mozilla_Persona)支持。
    4.  Lack's [Meteor 的实时（自我更新）模板](http://docs.meteor.com/#livehtmltemplates)，但来自插件，有 3 个“MV* 适配器”，包括类似且非常流行的 AngularJS。
5.  [在性能方面，它似乎主要击败了领先的竞争对手 Couchbase Lite](http://www.mircozeiss.com/pouchdb-vs-couchbase-lite-a-performance-review/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-23T08:08:51.763

[Meteor 文档的数据部分](http://docs.meteor.com/#data)（最后一段）提到通过编写驱动程序来替代 Mongo 的其他数据库引擎。这是报价：

> 您可以通过提供服务器端数据库驱动程序和/或实现替代 API 的客户端缓存来替代 MongoDB 的另一个数据库。mongo-livedata 是这样一个项目的一个很好的起点。

# ruby-on-rails - Ruport - "":String 的未定义方法“每个”

> ID：10788770
> 
> 赞同：2
> 
> 时间：2012-05-28T18:06:19.267
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, reporting, ruport

我正在关注本教程中的第一个示例：[http](http://ruportbook.com/printable_documents.html) ://ruportbook.com/printable_documents.html ，但是我一直在为“”：String获取未定义的方法`each'，我使用以下代码创建了一个新文件：

```
class MultiTableController < Ruport::Controller    
  stage :multi_table_report    
  class PDF < Ruport::Formatter::PDF    
    renders :pdf, :for => MultiTableController    
    build :multi_table_report do
      data.each { |table| pad(10) { draw_table(table) } }
      render_pdf
    end    
  end    
end 
```

然后，在一个名为 workers_controller.rb 的现有控制器中，我有下一个操作：

```
 def index_report
    t1 = Table(%w[a b c]) << [1,2,3] << [4,5,6]
    t2 = Table(%w[a b c]) << [7,8,9] << [10,11,12]
    pdf = MultiTableController.render_pdf(:data => [t1,t2])
  end 
```

然后，我在浏览器上收到此错误：

```
undefined method `each' for "1":String 
```

我已经尝试了许多其他示例，但我得到了同样的错误。

一些帮助？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T18:10:13.557

`each`是 ruby​​ 1.8 中的一种方法，`String`并在 Ruby 1.9 中被删除。

原因是 Unicode，或者更好的 ruby​​ 1.9 的新编码可能性。

应该`String #each`怎么做？循环每个字节或每个字符？Ruby 无法为您决定，因此您必须使用`String#each_byte`or `String#each_char`。

在 Ruby 1.8 中没有区别，一个字符就是一个字节。

* * *

编辑：

给一个肮脏的黑客一个机会：

```
class String
  alias :each :each_char
end

'aaaa'.each{|x| p x } 
```

但是 ruport 似乎对 Ruby 1.9 有其他问题，并且可能会有副作用。我不会在更大的项目中推荐这种 hack，但它可能适用于小脚本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-08-28T10:52:00.083

`String.each`在 1.8.7 中适用于行，而不适用于字节或字符。在 1.9 中使用`String.split("\n").each`而不是`String.each`. 但要小心，`split`切断分隔符，所以`String.each`给字符串以“/n”结尾，`String.split("\n").each`而给字符串结尾不带“\n”。

# python - 没有副作用的嵌套字典实现

> ID：10788771
> 
> 赞同：4
> 
> 时间：2012-05-28T18:06:36.910
> 
> 标签：python, dictionary

我在 SO 上遇到过至少两种体面的嵌套字典实现，一种是[使用 defaultdict](https://stackoverflow.com/a/652226/548240)，另一种是[子类化 dict](https://stackoverflow.com/a/652284/548240)。

这两种方法都适用于大多数功能，除了它们在访问不存在的键值对时都有副作用：它为该键创建一个**空字典，存储并返回它。**

理想情况下，我想要一个`None`在尝试访问不存在的键时返回而不创建条目（例如空字典）的实现。这可行吗？

ps 我知道我们可以通过使用元组作为键来避免嵌套字典，但是这个实现对我不起作用，因为我需要访问嵌套字典每个级别的条目集合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:19:43.907

您指向的两个实现对普通s 所做的*唯一*一件事就是在访问不存在的密钥时`dict`返回 a 。`dict`您想再次恢复它，从而再次使用默认`dict`类型：

```
>>> example = {}
>>> example['foo']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'foo'
>>> example['foo'] = {}
>>> example['foo']['bar'] = 1 
```

如果您想返回 None 而不是 dict，则只需使用`defaultdict(lambda: None)`：

```
>>> from collections import defaultdict
>>> example = defaultdict(lambda: None)
>>> example['foo'] is None
True 
```

请注意，您不能同时拥有它；Python 首先必须找到第一个键并将其解析为 a`dict`才能查找第二个键：

```
>>> example['foo']['bar']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'NoneType' object is unsubscriptable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:53:10.510

`d[key][subkey] = value`如果您希望使用丢失的键，您必须放弃返回 None 的要求。如果`d[key] is None`,`d[key][subkey] = value`等价于`None[subkey] = value`, 则不能工作。

您可以对缺失值做的事情是返回一个空的类似 dict 的对象，而无需将其分配给键。如果该对象持有对父对象的引用，则可以延迟分配，直到在层次结构中有明确的分配。

一个示例实现（这是不完整的，您必须做的不仅仅是覆盖 setitem 才能拥有功能齐全的 dict 子类）：

```
class NestedDict(dict):
    def __init__(self, parent=None, parentkey=None):
        self.parent = parent
        self.parentkey = parentkey

    def __missing__(self, key):
        return NestedDict(self, key)

    def __setitem__(self, key, value):
        if self.parent is not None:
            self.parent[self.parentkey] = self
            self.parent = None
        super(NestedDict, self).__setitem__(key, value)

>>> d = NestedDict()
>>> d[1][2][3] = 4
>>> d[2]
{}
>>> d.keys()
[1]
>>> d[1][2][3] 
4 
```

* * *

另一种方法是在键是元组时覆盖`__getitem__`并进行嵌套查找。`__setitem__`此版本`__getitem__`为缺少键提供 KeyError 以与常规 dict 保持一致。如果您愿意，您可以轻松地将其更改为返回 None 。

```
class NestedDict(dict):
    def __getitem__(self, key):
        if isinstance(key, tuple):
            try:
                x = self
                for k in key:
                    x = x[k]
                return x
            except (KeyError, TypeError):
                raise KeyError(key)
        else:
            return super(NestedDict, self).__getitem__(key)

    def __setitem__(self, key, value):
        if isinstance(key, tuple):
            d = self
            for k in key[:-1]:
                d = d.setdefault(k, NestedDict())
            d[key[-1]] = value
        else:
            super(NestedDict, self).__setitem__(key, value)

>>> d = NestedDict()
>>> d[1,2,3] = 4
>>> d[1,2,3]
4
>>> d[1,2,4]
KeyError: (1, 2, 4)
>>> d
{1: {2: {3: 4}}} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T23:27:45.130

对于这种情况，Python 支持[鸭子类型：](http://en.wikipedia.org/wiki/Duck_typing)

```
>>> d={}
>>> d[1]='Some'
>>> try:
...    att=d[1]
... except KeyError:
...    att=None
... 
>>> print att
Some
>>> try:
...    att=d[1][2][3]
... except KeyError:
...    att=None
... 
>>> print att
None 
```

将它放入一个类或一个函数中，它应该很容易支持我认为你正在寻找的东西。

# c++ - 链接器可以报告未使用的成员函数吗？(C++)(gcc)

> ID：10788776
> 
> 赞同：6
> 
> 时间：2012-05-28T18:06:50.610
> 
> 标签：c++, optimization, gcc, linker, member-functions

[std::string](http://www.cplusplus.com/reference/string/string/)有超过 30 个可以在字符串对象上调用的成员函数。
如果我只使用其中的几个呢？

我假设未使用的成员函数不会占用可执行代码部分的空间。
我很想知道链接器是否有可能确定未使用的成员函数，将其从已编译二进制文件的一部分中删除，并*报告它*丢弃了哪些函数。
有没有办法做到这一点？我正在查看[gcc 的链接器标志](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)，但找不到任何相关内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:12:27.573

因为`std::string`是一个模板类（`std::string`只是一个`typedef`to `std::basic_string<char>`），所以只会实例化使用的方法，所以不会编译未使用的方法，因此它们不能从您的可执行文件中删除。

关于非模板类：`virtual`函数将始终以可执行文件结尾，无论它们是否被调用，因为 vtable 需要地址。来自可执行文件或静态链接库的源的其他方法（以及自由函数）只有在实际使用时才会链接到二进制文件中。但我知道没有链接器标志来打印尚未链接的功能。

另一方面，共享库 (.so) 必须包含所有（导出的）函数和方法，因为使用此共享库的二进制文件可以使用任何（导出的）函数。但是由于共享库可以被许多可执行文件使用，而只加载到内存中一次，这通常是值得的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:16:31.193

标准库通常是共享的，因此它不会占用可执行文件中的任何空间。

如果您静态链接，那么就链接器而言，非虚拟成员函数只是您的常规花园品种功能，名称很有趣。无论链接器对普通函数做什么，它都可以对非虚拟成员做什么。我认为 GNU LD 可能能够在某些架构上删除未使用的功能，但不能在其他架构上删除。

当然，功能模板、成员等`std::string`完全是另外一回事。对于链接器，它们根本不是来自库，而是来自您的对象（并且只有您实例化的对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:20:51.037

这个答案并不完全涵盖您的情况，但是如果您想知道您的类是否有任何未调用的函数，一些静态分析工具（如[cppcheck](http://cppcheck.sourceforge.net/)）会报告这一点。

# django - ModelChoiceField 在表单提交时给出一个无效的选择错误

> ID：10788777
> 
> 赞同：2
> 
> 时间：2012-05-28T18:06:56.813
> 
> 标签：django, django-forms

我想允许用户删除与特定模型相关的外键列表。

假设我们有这两个模型：

```
 class IceBox(models.Model):
    ...

class FoodItem(models.Model):
    name = models.CharField(...)
    icebox = models.ForeignKey(IceBox)

    def __unicode__(self):
        return self.name 
```

用于选择要删除的多个食品的表格：

```
 class IceBoxEditForm(forms.Form):
        fooditems = forms.ModelChoiceField(queryset=FoodItem.objects.none(), widget=forms.CheckboxSelectMultiple(), empty_label=None) 
```

对应视图：

```
 def icebox_edit(request, item=None):
        # Grab the particular icebox
        icebox = get_object_or_404(IceBox, pk=item)

        if request.method == "POST":
                form = IceBoxEditForm(request.POST)
                print request.POST
                if form.is_valid():
                        # Delete should happen
        else:
                form = IceBoxEditForm()
                # Only use the list of fooditems that this icebox holds
                form.fields['fooditems'].queryset = icebox.fooditem_set.all()

        return render_to_response('icebox_edit.html', {'form':form},context_instance=RequestContext(request)) 
```

该表单正确列出了与该冰箱关联的食品的复选框。但是，当我选择某些内容然后提交表单时，我会收到表单错误：

**`Select a valid choice. That choice is not one of the available choices.`**

是否还有其他一些我缺少 Django 期望的自定义​​验证？

**编辑：**我试过这个，但它给出了一个语法错误：

```
 **form:**
class IceBoxEditForm(forms.Form):
        fooditems = forms.ModelChoiceField(queryset=FoodItem.objects.none(), widget=forms.CheckboxSelectMultiple(), empty_label=None)

        def __init__(self, *args, **kwargs):
              queryset = kwargs.pop('queryset', None)
              super(IceBoxEditForm, self).__init__(*args, **kwargs)

              if queryset:
                        self.fields['fooditems'].queryset = queryset

**view:**
        form = IceBoxEditForm(queryset=icebox.fooditem_set.all(), request.POST) # Syntax error!

        ....
    else:
        form = IceBoxEditForm(queryset=icebox.fooditem_set.all())
        .... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:38:44.790

您已更改 GET 请求的字段的查询集，但没有更改 POST 的查询集。所以当你提交表单时，Django 还在使用原来的查询集，所以你的选择是无效的。

要么在视图的开头更改它，所以它发生在 POST 和 GET 中，或者更好地在表单的`__init__`方法中进行。

# asp.net-mvc-3 - 使用 Signalr 时 iPhone 浏览器持续加载

> ID：10788780
> 
> 赞同：1
> 
> 时间：2012-05-28T18:07:07.803
> 
> 标签：asp.net-mvc-3, jquery-mobile, signalr

我正在寻找开发一个移动网络应用程序，允许 2 人互相交谈。为此，我使用 MVC3、jquery mobile 和 Signalr。

我的机器上有基本功能，但是当我在 iPhone 上测试它时，页面显示为不断加载，我假设这是由于 Signalr？

有没有人遇到过这个并知道如何纠正它或知道任何其他库，如 Signalr，但适用于移动设备？

非常感谢，迈克

这是我 iphone 屏幕截图的链接：http: [//i1150.photobucket.com/albums/o618/mikeyb7fish/60c65836.jpg](http://i1150.photobucket.com/albums/o618/mikeyb7fish/60c65836.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:39:17.243

您需要像这样延迟 SignalR 启动：`setTimeout('$.connection.hub.start()', 2000);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T13:11:15.860

SignalR 可能已经退回到[永久框架（隐藏的 iframe）](http://en.wikipedia.org/wiki/Comet_%28programming%29)，这使得某些浏览器似乎永远无法完成页面加载。我正在从事的项目也有这个问题，但我还没有弄清楚如何解决它。如果它不是您可以在 SignralR 中配置的东西，您可能会查看[Modernizr](http://modernizr.com/)是否有一个可以解决问题的 polyfill。不过，让任何 polyfill 与 SignalR 的客户端库配合使用可能有点困难......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:59:31.483

```
$.connection.hub.start().done(function () { 
    $("#status").css('background-color', 'green').css('color', 'white').text('Ready'); 
}).fail(function () { 
    $("#status").css('background-color', 'red').css('color', 'white').text('Error connecting'); 
});

<div id="status" style="float: right; background-color: Yellow;">
    Connecting...
</div><i> 
```

# php - 如何在codeigniter中合并两个数组

> ID：10788785
> 
> 赞同：0
> 
> 时间：2012-05-28T18:07:39.420
> 
> 标签：php, arrays

我想合并两个数组，但是如何？

```
$array1 [ ] = Array ( [0] => Array ( [id] => 1 [name] => "Alice" ))

$array2 [] = Array ( [0] => Array ( [age] => 22 )); 
```

我想得到的结果数组：

```
$result  = Array ( [0] => Array ( [id] => 1   [name] => "Alice"     [age] => 22) ); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:19:31.600

您可以使用 PHP 的[array_merge](http://php.net/manual/en/function.array-merge.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:19:36.763

你可以这样做

```
array_merge_recursive($array1, $array2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:20:48.553

如果这只是单个数组条目，那么您可以尝试这样做，否则您必须为完整的数组集应用循环

```
$result[] = $array1[0] + $array2[0]; 
```

// print_r($result);

它会给你输出

```
Array
(
    [0] => Array
        (
            [id] => 1
            [name] => Alice
            [age] => 1
        )

) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-28T18:21:21.787

遍历array1。如果第一个 Element 始终是一个数组，只需将 array2[c] 的元素添加到数组 array1[c] 中，其中 c 是计数变量。

# php - 访问方法的不同方式

> ID：10788786
> 
> 赞同：2
> 
> 时间：2012-05-28T18:07:40.157
> 
> 标签：php, oop, scope-resolution

我已经看到有两种不同的方法可以访问类中的方法。行为是否有任何差异，或者它们是否纯粹是同一操作的替代语法？

```
$a = new A();
$a->foo();

A::foo(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T18:11:15.580

你不能只使用其中一个。`::`用于静态方法和变量，而`->`用于实例方法和变量。这是来自 C++ 语法的“启发”。

```
class A {
    public function __construct() {}
    public function foo() {}
}
$a = new A();
$a->foo();
// Or use the shorter "new A()->foo()";
//   It won't return typeof(A), it will return what foo() returns.
// The object will still be created, but the GC should delete the object 
```

或者

```
class A {
    public static function foo() {}
}
A::foo(); 
```

根据[DCoder](https://stackoverflow.com/users/1233508/dcoder)，`::`可用于调用父方法，但我不确定这一点。

```
class B {
    public function __construct() {}
    public function foo() {}
}
class A extends B {
    public function __construct() {
        // Code
        parent::__construct()
    }
    public function foo() {
        // Code
        parent::foo()
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:16:26.780

当你这样做

```
$a = new A(); 
```

您有一个名为 A 的对象类的*实例。*

这意味着您有一个特定的对象（具有自己的个性，其属性中的具体值）。

因此，您可以使用以下表达式访问此对象的属性和调用方法：

```
$a->foo(); 
```

另一方面，

```
A::foo(); 
```

是访问驻留在类本身（在类的定义中）的属性和方法的正确方法。这些被称为**static**。

主要区别在于静态方法可以在创建该类的任何对象之前访问，即无需使用`new`运算符。它们用于跨对象属性和对象范围的方法。

对象的实例（使用`new`运算符创建）是类的真实副本，它们的属性可以具有不同的值。对于相同的属性，同一类的两个对象可以在其中具有不同的值。在类的**静态**部分中，所有对象都将具有相同的值和行为。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:15:17.763

`->`将访问从类 A 实例化的特定对象的方法。

`::`是*范围解析运算符*，它引用指定类的静态成员（在您的情况下为类 A ）。

如果您没有注意到WAS**从**类 A() 创建`->`的对象的访问方法，但您访问的是静态方法（静态方法不需要访问对象）。`$a`**`$a = new A();``::`**

 *****例如。***

假设你有一个名为的类`Math`，它有一个静态方法`Add()`：

```
<?php
class Math{
// Note the 'static' keyword
public static function Add($arg1, $arg2){
return $arg1+$arg2;
}
}
?> 
```

在这种情况下，您可以`Add()`立即使用该方法，而无需`Math`像这样创建任何类对象：

```
<?php
print Math::Add(2, 3);
?> 
```

您使用`::`符号来访问`Math`类的静态方法。使用符号没有意义，`->`因为它用于访问从类创建的对象的方法。

所以：

```
 <?php
    class Math{
    // Add() NO LONGER static
    public function Add($arg1, $arg2){
    return $arg1+$arg2;
    }
    }
?> 
```

而你必须这样做：

```
<?php
$object = new Math();
$result = $object->Add(2, 3);
print $result;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:10:08.153

如果是静态方法，您将访问`foo()`方法。否则，您将使用实例方法。`class::foo()``foo()``object-­>foo()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T18:11:20.523

使用**::**运算符静态访问类。在这种情况下，没有类的实例作为对象。它用于不同的 OOP 设计模式，例如 Singleton 和 Factory 方法。访问它的范围*几乎*是全球性的，如果您不知道自己在做什么，可能会给您带来麻烦。

-> 运算符的使用意味着您正在访问实例化类的方法或变量。在这种情况下，范围在您实例化的特定对象内，并删除了该*全局*状态。**

# c# - 如果文本大于容器，如何确定将“...”放在哪里

> ID：10788790
> 
> 赞同：3
> 
> 时间：2012-05-28T18:08:14.273
> 
> 标签：c#, winforms, algorithm, text, label

假设我有一个`Label`内部 a `Panel`。文本会比`Panel`有时更大，但并非总是如此。我如何弄清楚我应该在“...”前面的文本的哪一部分，而无需硬编码它需要多少个字符，因为每个字符的大小不同。

```
if (bigLabel.Width >= this.ClientRectangle.Width - 10) {
    dotLabel.Location = new Point(this.ClientRectangle.Width - 10 - dotLabel.Width);
}
else {
    dotLabel.Location = new Point(this.Width + 10, this.Height + 10);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T18:13:20.607

让 TextRenderer.DrawText() 自行解决。指定 TextFormatFlags.EndEllipsis 选项。您将在[此答案](https://stackoverflow.com/questions/2903172/indicate-truncation-in-tooltipstatuslabel-automatically/2904279#2904279)中找到代码示例。

它已经内置到 Label 控件中。将其 AutoSize 属性设置为 False 并将 AutoEllipis 属性设置为 True 以使其全部自动完成。您还可以免费获得一个工具提示，显示缺失的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:23:48.873

使用 Graphics.DrawString 方法（TextRenderer.DrawText 是一种 GDI 方式，Graphics.DrawString - GDI+）。将 StringFormat.Trimming 属性设置为 StringTrimming.EllipsisCharacter (EllipsisWord, EllipsisPath)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-28T08:43:03.473

如果您使用 Telerik 控件 - RadLabel，则仅设置此属性：

```
this.lblReferralTracking.TextAlignment = System.Drawing.ContentAlignment.MiddleLeft;
this.lblReferralTracking.TextWrap = false;
this.lblReferralTracking.UseCompatibleTextRendering = true; 
```

# python - Pywikipedia 如何在命令行上管理颜色？

> ID：10788791
> 
> 赞同：1
> 
> 时间：2012-05-28T18:08:16.343
> 
> 标签：python, colors, cmd, pywikibot

正如我所阅读的所有内容所说，我一直认为命令行上没有可能的格式。

然而，我最近发现 pywikipedia（一个用于自动编辑维基百科风格的 wiki 的 python bot 框架）可以`cmd.exe`以不同的颜色将文本输出到命令行（普通窗口）！

这是python语法：

```
import wikipedia
wikipedia.output(u"\03{lightpurple}"+s+"\03{default}") 
```

您必须使用`wikipedia.output()`(或`pywikibot.output()`) 但不仅仅是`print`.

[在线 pywikipedia 存储库](http://svn.wikimedia.org/viewvc/pywikipedia/trunk/pywikipedia/wikipedia.py?revision=10153&view=markup)（大约 7990 行）给出了一个简短的解释：

```
text can contain special sequences to create colored output. These
consist of the escape character \03 and the color name in curly braces,
e. g. \03{lightpurple}. \03{default} resets the color. 
```

我认为这可能与这条线有关：

```
ui.output(text, toStdout = toStdout) 
```

但我找不到任何对`ui`类的引用。

那么 Pywikipedia 是如何管理它的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T05:10:02.173

我不知道你是否可以在 Windows 上使用 ANSI 代码。
但是在 Python 中你可以这样写：

```
 >>> print "\033[0;32m"+ "Green" +"\033[0m"
 Green 
```

我在[这里](http://nezzen.net/2008/06/23/colored-text-in-python-using-ansi-escape-sequences/)看到了。

# javascript - Knockoutjs - 动态模板切换之间的转换？

> ID：10788793
> 
> 赞同：5
> 
> 时间：2012-05-28T18:08:20.257
> 
> 标签：javascript, html, knockout.js

到目前为止，KnockoutJS 真的很好用，但我是这个框架的新手。我正在尝试创建一个选项卡式界面，例如 4 个链接和一个公共显示区域。单击链接可利用 Knockout 的模板系统并切换模板。这一直很好，但我想在模板切换之间添加某种动画。

我怎样才能做到这一点？我已经阅读了一些关于 beforeRemove/afterAdd 的内容，但这似乎只适用于 observableArrays。我知道 KnockoutJS 支持动画/自定义绑定（我更直接地将它们用于我页面上的其他元素）。

如果我的整个方法不正确，是否有更好的方法来制作选项卡式界面以轻松获得转换？

这是我现在的代码。

的HTML：

```
<div class="Page">
    <span data-bind="template: {name: current_page()}"></span>
</div>
<script type="text/html" id="Home">
    <!-- Home content -->
</script>
<script type="text/html" id="Tab1">
    <!-- Tab1 content -->
</script> 
```

Javascript（淘汰赛的 ViewModel）：

```
this.current_page  = ko.observable("Home")
//later on...
this.current_page("Tab1"); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T09:25:18.403

您可以使用[模板绑定](http://knockoutjs.com/documentation/template-binding.html)`afterRender`的属性：

```
<span data-bind="template: {name: current_page(), afterRender: animatePageChange }"></span> 
```

..然后在您的视图模型上，您可以添加您喜欢的任何动画：

```
animatePageChange: function() { $('#content').hide(); $('#content').fadeIn(3000); } 
```

我在[http://jsfiddle.net/unklefolk/v3JMS/1/上做了一个简单的演示](http://jsfiddle.net/unklefolk/v3JMS/1/)

# c# - 从 XML 文件中读取元素

> ID：10788801
> 
> 赞同：5
> 
> 时间：2012-05-28T18:09:14.333
> 
> 标签：c#, xml

我正在尝试从 XML 文件中读取并使用它来填充我创建的问题对象。这是 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<quiz>
  <problem>
    <question>Which of the following languages could be used in both Visual Studio and Unity?</question>
    <answerA>Cobol</answerA>
    <answerB>C#</answerB>
    <answerC>C−−</answerC>
    <answerD>French</answerD>
    <correct>B</correct>
  </problem>
  <problem>
    <question>What does XML stand for?</question>
    <answerA>eXtremely Muddy Language</answerA>
    <answerB>Xerxes, the Magnificent Chameleon</answerB>
    <answerC>eXtensible Markup Language</answerC>
    <answerD>eXecutes with Multiple Limitations</answerD>
    <correct>C</correct>
  </problem>
</quiz> 
```

这是我正在使用的课程。问题出在 loadQuestions() 方法中。

```
public partial class frmQuestions : Form
    {
        private XmlDocument doc;
        private XmlNode theQuiz;
        private List<Question> questions;
        private Random random;

        public frmQuestions(string docName)
        {
            InitializeComponent();
            doc = new XmlDocument();
            doc.Load(docName);
            questions = new List<Question>();          
            loadQuestions();
            displayQuestion();
        }

        private void frmQuestions_Load(object sender, EventArgs e)
        {

        }

        private void loadQuestions()
        {
            string question, a, b, c, d, correct;
            theQuiz = doc.FirstChild;

            for(int i = 0; i < theQuiz.ChildNodes.Count; i++)
            {
                XmlNode theQuestion = theQuiz.ChildNodes[i];
                question = theQuestion["question"].InnerText;
                a = theQuestion["answerA"].InnerText;
                b = theQuestion["answerB"].InnerText;
                c = theQuestion["answerC"].InnerText;
                d = theQuestion["answerD"].InnerText;
                correct = theQuestion["correct"].InnerText;

                questions.Add(new Question(question, a, b, c, d, correct));
            }
        }

        private void displayQuestion()
        {
            Random random = new Random();
            int randomNumber = random.Next(1, questions.Count);

            lblQuestion.Text = questions[randomNumber].getQuestion();
            lblA.Text = questions[randomNumber].getA();
            lblB.Text = questions[randomNumber].getB();
            lblC.Text = questions[randomNumber].getC();
            lblD.Text = questions[randomNumber].getD();
        }

    } 
```

我发现的问题是 theQuiz.ChildNodes.Count = 0。

有人知道我要去哪里错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:22:10.073

在您的代码中更改`theQuiz = doc.FirstChild;`为

```
theQuiz = doc.LastChild; 
```

其余的看起来不错。（我找不到您在哪里定义了测验）。我尝试了代码，它正在使用`var theQuiz = doc.LastChild;`

如果您想使用 LINQ，那么您可以尝试以下方法：

```
XDocument xDoc = XDocument.Load("XMLFile1.xml");

            var query = (from x in xDoc.Descendants("quiz").Elements("problem")
                        select new Question
                        {
                            question = x.Element("question").Value,
                            answerA = x.Element("answerA").Value,
                            answerB = x.Element("answerB").Value,
                            answerC = x.Element("answerC").Value,
                            answerD = x.Element("answerD").Value,
                            correct = x.Element("correct").Value
                        }).ToList(); 
```

这是假设您有一个类 Question 的属性公开为 question、answerA ... 等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:21:33.267

使用 LINQ to XML：

使用 LINQ to XML：

```
XDocument doc = XDocument.Load("YOURXML.xml");
var quiz = from elements in doc.Elements("quiz").Elements("problem")
           select elements;

foreach (var item in quiz)
{
question = item.Element("question").Value;
                    a = item.Element("answerA").Value; 
                    b = item.Element("answerB").Value; 
                    c = item.Element("answerC").Value; 
                    d = item.Element("answerD").Value; 
                    correct = item.Element("correct").Value; 
 questions.Add(new Question(question, a, b, c, d, correct));
} 
```

# android - 如何通过 USB 发起 Android 到 PC 的 HTTP 请求？

> ID：10788811
> 
> 赞同：10
> 
> 时间：2012-05-28T18:10:23.403
> 
> 标签：android, http, usb, adb

*以前有人[问过](https://stackoverflow.com/questions/6520989/android-httpclient-sending-request-to-host-machine-over-usb)这个问题，但没有得到满意的答复。*

从我的 Android 应用程序中，我需要向通过 USB 连接的 PC 发送 HTTP 请求。通常，使用 ADB 的通信是单向的，从 PC 到 Android。

正如上述副本的答案中提到的，这已经在之前完成了：[Android Usb Port Forwarding](http://www.codeproject.com/Articles/191930/Android-Usb-Port-Forwarding)。如果我真的需要，我可以下载这个应用程序并搞砸它，但我更愿意在我自己的应用程序中实现它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T13:01:05.350

如果 Android 手机支持 USB 网络共享：

1.  通过 USB 数据线连接手机
2.  启用 USB 网络共享
3.  将在 IP 范围 192.168.142.X 中创建局域网连接 [此 LAN 的 IP 也可以设为静态]

现在可以使用此设置向 PC 上运行的 Web 服务器发送 HTTP 请求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-06T17:55:56.867

它实际上不是一种方式的通信，而是*发起连接*的能力。

要使用标准的 android 功能做到这一点，您在概念上必须通过现有的 PC 发起的连接来隧道设备发起的连接。例如，使用现成的工具：

1.  设置从 PC 到设备的 ADB 端口转发
2.  在与您的 adb forward 对应的非特权端口号上在 android 设备上运行 SSH 服务器
3.  通过ADB转发从PC上的SSH客户端连接到手机，并将手机上的端口设置回PC上的端口的SSH转发
4.  在 PC 上运行一个服务器，监听 SSH 转发的目标端口。
5.  让您在手机上的代码通过该 SSH 端口转发与 PC 上的服务器联系

您实际上不必使用 SSH，它只是打包了可以使用的部分。

作为另一种想法，一些支持 USB 网络共享以向 PC 提供移动网络服务的 Android 设备最终会通过 USB 电缆创建一个双向 IP 网络，您可以将其用于其他目的。但是要非常小心，不要意外地通过手机路由所有 PC 的网络流量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T09:27:21.950

在 USB 中，启动通信的始终是主机（在您的情况下为 PC）。因此，您需要使用一些技巧来使 Android 设备发送请求。PC 可能会定期轮询 Android（例如，每 100 毫秒），如果它有一个未决的 HTTP 请求并相应地收集它，类似于[jackbot](https://stackoverflow.com/questions/6520989/android-httpclient-sending-request-to-host-machine-over-usb/6872297#6872297)所做的。我猜这就是 Android 到 USB 端口转发所做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T16:27:34.997

应该可以为此目的使用 USB 网络共享。当您在 Android 设备上为您的 PC 启动 USB 网络共享时，PC 和 Android 将在同一个本地网络中。它允许通过 HTTP 访问 PC（例如测试 http 服务器）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-06T17:18:27.190

不幸的是，您不能通过本地套接字发送 HTTP 请求，例如 /dev/tty... 或类似的。默认情况下，如果 android 设备获取 IP 地址，将通过 DHCP 或您设置的静态 IP 完成。您需要做的是知道台式计算机的 IP。

你实际上想要完成什么？让应用程序向 localhost 发送请求，该请求将中继到 PC？

这个答案可能有助于“[通过 USB 网络共享找到桌面的 ip](https://stackoverflow.com/questions/3612069/programmatically-find-the-ip-address-of-the-desktop-over-usb-tethering) ”

# .net - 如何同步锁定共享整数

> ID：10788814
> 
> 赞同：2
> 
> 时间：2012-05-28T18:10:36.173
> 
> 标签：.net, vb.net, multithreading, thread-safety, synclock

一般来说，我对多线程很陌生，我想知道如何锁定共享整数变量，使其在被其他线程读取/更新时不被其他线程访问。

当我尝试 do do 时`SyncLock myInteger`，我收到该错误：**错误 6 'SyncLock' 操作数不能属于 'Integer' 类型，因为 'Integer' 不是引用类型。**

这是我的意思的简化示例

```
Private Shared myInteger As Integer

Private Sub MySub()
  SyncLock myInteger ' This does not work
    ' read/write a new value to myInteger
  End SyncLock
End Sub 
```

MySub 由类的多个实例调用，并在多个线程中运行

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T18:14:20.807

我怀疑你不完全理解是什么`SyncLock`。即使您*可以*这样做（`Integer`例如，如果是引用类型），您也*不想*这样做 - 因为当您替换 的值时`myInteger`，锁将毫无用处。

您应该*锁定*其他东西（我个人通常声明一个单独的只读变量，纯粹是为了锁定，通常是 type `Object`）或者如果您*只想*随时操作`myInteger`（而不是一些需要的复合操作同时读取或更新多个变量），使用[`Interlocked`](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)该类。

# mysql - 缓慢的mysql调试和修复过程

> ID：10788816
> 
> 赞同：1
> 
> 时间：2012-05-28T18:10:40.777
> 
> 标签：mysql

mysql 在网站上运行良好，通过一些分析（通过 codeigniter），我注意到一些查询运行速度非常慢，需要超过 30 秒。95% 的时间是会话表，在某些情况下，它会慢慢地从另一个表中 SELECTS。

慢表是 innoDB 类型。

我不确定修复它的正确过程是什么。

我试过修理桌子，但这是我所能得到的。我真的不知道下一步该做什么。

有任何想法吗？

@Nico @Mark Byers

```
SELECT *
FROM `ast_sessions`
WHERE `session_id` = '636519144bc6194898fd5a1f9e5fbc1d'
AND `user_agent` = 'Mozilla/5.0 (Windows NT 6.1; WOW64)' 
```

创建表：

```
CREATE TABLE `ast_sessions` (
  `session_id` varchar(40) COLLATE utf8_bin NOT NULL DEFAULT '0',
  `ip_address` varchar(16) COLLATE utf8_bin NOT NULL DEFAULT '0',
  `user_agent` varchar(150) COLLATE utf8_bin NOT NULL,
  `last_activity` int(10) unsigned NOT NULL DEFAULT '0',
  `user_data` text COLLATE utf8_bin NOT NULL,
  PRIMARY KEY (`session_id`,`user_agent`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin 
```

解释选择：

```
+----+-------------+-------+------+---------------+------+---------+------+------+-----            ------------------------------------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows |     Extra                                               |
+----+-------------+-------+------+---------------+------+---------+------+------+-----    ------------------------------------------------+
|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL |          Impossible WHERE noticed after reading const tables |
+----+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+
1 row in set (1 min 10.41 sec) 
```

# jakarta-ee - java ee - 持久性动态查询

> ID：10788821
> 
> 赞同：1
> 
> 时间：2012-05-28T18:11:29.977
> 
> 标签：jakarta-ee, persistence

我对 java ee 和持久性技术很陌生。我正在尝试编写一个动态查询。细节：
有一个数据表（' **newsactivites** '），它看起来像这样：

```
id   type
4    UploadVideo
4    CreateBlog
1    UploadPicture
10   UploadVideo
10   CreateBlog 
```

此外还有一个枚举：

```
public enum Type {
      UploadVideo("show.uploadedVideo"),
      UploadPicture("show.uploadedPicture"),
      CreateBlog("show.createdBlog");
} 
```

所以我想写一个这样的方法：

```
private List<Type> activities=new ArrayList<Type>();

@CollectionElements()
@Column(name="type")
@Enumerated(EnumType.STRING)
@JoinTable(name = "newsactivities", joinColumns = { @JoinColumn(name = "id") })
public List<Type> getActivities() {
      return activities;
} 
```

但我想在给定时间只回馈一个 id 的活动：

```
public List<Type> getActivities(int id) { } 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:34:34.683

如果我正确阅读了您的模型（我不确定），您应该有一个带有外键的实体类`Newsactivities`（在一个类中） 。然后你需要一个（而不是一个）：`Newsactivities.class``type``List<Newsactivities>``List<Types>`

```
public List<Type> getActivities(int id) {
    TypedQuery<Newsactivities> tq = em.createQuery(
      "SELECT n FROM Newsactivities n WHERE n.type=:type, Newsactivities.class);
    tq.setParameter("type", id);
    return(tq.getResultList());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T05:19:08.063

你有一个关联到`Type`对象的，就像你写的：

```
public class A{

private List<Type> activities=new ArrayList<Type>();

@CollectionElements()
@Column(name="type")
@Enumerated(EnumType.STRING)
@JoinTable(name = "newsactivities", joinColumns = { @JoinColumn(name = "id") })
public List<Type> getActivities() {
    return activities;
}
} 
```

然后，你需要一个`Repository`，像这样：

```
public interface ARepository extends JpaRepository<A,Long>{
@Query("select a.activities from A a where a.id=?1")
List<Type> findTypeById(Long id);
} 
```

现在，您可以使用`findTypeById`，这需要您有`A`对象

# c++ - 空基类优化现在是强制优化吗（至少对于标准布局类）？

> ID：10788823
> 
> 赞同：27
> 
> 时间：2012-05-28T18:11:47.357
> 
> 标签：c++, c++11, language-lawyer

根据**C++11** *9.1/7 (draft n3376)*，*标准布局*类是这样的类：

> *   没有非标准布局类（或此类类型的数组）或引用类型的非静态数据成员，
>     
>     
> *   没有虚函数 (10.3) 和虚基类 (10.1)，
>     
>     
> *   对所有非静态数据成员具有相同的访问控制（Clause11），
>     
>     
> *   没有非标准布局的基类，
>     
>     
> *   要么在派生最多的类中没有非静态数据成员，并且最多有一个具有非静态数据成员的基类，要么没有具有非静态数据成员的基类，并且
>     
>     
> *   没有与第一个非静态数据成员相同类型的基类。

因此空类是*标准布局*类；并且另一个以空类为基类的类也是*标准布局*类，前提是此类的第一个非静态数据成员与基类的类型不同。

此外，*9.2/19*指出：

> 指向标准布局结构对象的指针，使用 a 进行适当转换`reinterpret_cast`，指向其初始成员（或者如果该成员是位字段，则指向它所在的单元），反之亦然。[注意：因此，标准布局结构对象中可能存在未命名的填充，但不是在其开头，这是实现适当对齐所必需的。——尾注]

这似乎意味着*空基类优化*现在是一种强制优化，至少对于*标准布局*类是这样。我的观点是，如果不强制要求空基优化，那么*标准布局*类的布局将不是标准的，而是取决于实现是否实现了所述优化。我的推理是正确的，还是我错过了什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-28T19:42:57.883

是的，你是对的，在“PODs revisited”提案中指出了这一点：[http ://www.open-std.org/jtc1/sc22/WG21/docs/papers/2007/n2342.htm#ABI](http://www.open-std.org/jtc1/sc22/WG21/docs/papers/2007/n2342.htm#ABI)

Embarcadero 编译器文档也说明了这一点： http: [//docwiki.embarcadero.com/RADStudio/en/Is_standard_layout](http://docwiki.embarcadero.com/RADStudio/en/Is_standard_layout)

另一个关键点是[class.mem]/16

> 如果两个标准布局结构（第 9 条）类型具有相同数量的非静态数据成员并且相应的非静态数据成员（按声明顺序）具有布局兼容类型（3.9），则它们是布局兼容的。

请注意，只有数据成员会影响布局兼容性，而不是基类，因此这两个标准布局类是布局兼容的：

```
struct empty { };
struct stdlayout1 : empty { int i; };

struct stdlayout2 { int j; }; 
```

# c++-cli - 在 C++/CLI 中更改通用列表中成员的值

> ID：10788830
> 
> 赞同：2
> 
> 时间：2012-05-28T18:12:55.487
> 
> 标签：c++-cli

下面是一个简单的 C++/CLI 示例。

```
// TestCLR.cpp : main project file.

#include "stdafx.h"

using namespace System;

int main(array<System::String ^> ^args)
{
    System::Collections::Generic::List<String^> TestList;

    for(int i = 0; i < 10 ; i++)
    {
        TestList.Add(i.ToString());
    }

    for each(String^% st in TestList)
    {
        st += "TEST";
        Console::WriteLine(st);
    }

    for each(String^ st in TestList)
    {
        Console::WriteLine(st);
    }

    return 0;
} 
```

我得到以下输出：

```
0TEST
1TEST
2TEST
3TEST
4TEST
5TEST
6TEST
7TEST
8TEST
9TEST
0
1
2
3
4
5
6
7
8
9 
```

简而言之，即使我使用跟踪指针将其值更改为“TEST” ， **TestList中的值也不会改变。**

我应该在上面的代码段中修改什么以便永久更改值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:11:04.397

你有一个`System::Collections::Generic::List`，它使用一个属性来访问项目。您不能将跟踪引用绑定到属性，最终会得到对值的临时副本的引用。

该代码适用于数组，但`foreach`不能用于在容器中就地改变元素。您将需要一个 for 循环，因为您需要索引来覆盖列表元素：

```
for(int i = 0, cnt = TestList.Count; i < cnt; ++i)
{
    TestList[i] += "TEST";
    Console::WriteLine(TestList[i]);

    // doesn't work right: String^% st = TestList[i];
    // since TestList[i] is not an lvalue, it's a function call to a getter method
} 
```

你没有得到一个编译器警告，告诉你你正在将一个非常量引用绑定到一个临时对象吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:41:20.770

您在这里没有从编译器那里获得帮助。这是 C# 中的[CS1656 错误](http://msdn.microsoft.com/en-us/library/369xac69.aspx)，但 C++/CLI 编译器忘记为您提供诊断。

foreach 迭代变量是`IEnumerable<T>::Current`属性的别名。它只有一个 getter，它没有一个 setter。所以它永远不能更新底层集合。您需要在此处使用普通的 for() 循环。

# c++ - 保持我的 char 在范围内，并处理它

> ID：10788832
> 
> 赞同：0
> 
> 时间：2012-05-28T18:13:16.740
> 
> 标签：c++, pointers, memory-management

我有一个将相对路径（例如“log\crash.txt”）转换为完整路径（例如“E:\Program\log\crash.txt”）的函数。功能是：

```
string_t GetAbsPath(string_t relPath)
{
    char abs[1024];

    //Get the working directory
    GetCurrentDirectory(1024, abs);

#pragma warning(disable:4996)
    //Add a slash and content folder
    memcpy(&abs, strcat(abs, "\\content\\"), 1024);
    //Append it to the relative path
    memcpy(&abs, strcat(abs, relPath.c_str()), 1024);
#pragma warning(default:4996)

    return abs;
} 
```

`string_t`是我写的一个类，它基本上是一个`const char*`. 我的问题是，（我有点预料到......）是当函数返回时，`abs`超出范围，并且`string_t`获得返回值的现在是空/垃圾。在这种情况下，我通常只是将`memcpy`其复制到不会超出范围的指针中。但是存在的问题是，该指针（将是`const char*`in `string_t`）需要被`delete[]`'d'。`string_t`一开始就没有析构函数。我可以`delete[]`在那里写一个，但这会带来另一个问题：

如果我创建一个`string_t`这样的：

```
string_t crash = "New[] isn't called! Ahh!"; 
```

当我`delete[]`在析构函数中访问它时，程序将崩溃，因为从未调用过 new[]。

我可以`delete[]`在`const char*`调用的函数中`GetAbsPath`，像这样：

```
void LoadModel(string_t relPath)
{
     string_t fullPath = GetAbsPath(relPath);
     . . .
     delete[] fullPath.c_str();
} 
```

但我知道，如果我稍后再看代码，我会说“为什么`delete[]`会有那个”，或者我会在不需要时添加它......而且指针是，有很多那里有错误的余地。

我能做些什么来保持这个字符在范围内（我猜这只能用指针来完成），并确保分配的内存被清理？必须有一种方法，因为 std::string 保持一切干净，并且它具有连接等功能，我`string_t`什至没有。我很感激这里的任何帮助，因为我不知所措......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:27:25.793

你有三个选择：

1）决定`string_t`它将始终拥有它指向的字符串，并将负责释放它。让构造函数分配/复制。

2）决定`string_t`永远不会拥有它指向的字符串，并且调用它的代码将始终负责在必要时释放它。

3) Decide that `string_t` will support both models and will need a flag to decide whether to call `free[]` or not in its destructor. Calling code will have to tell `string_t` whether to allocate/copy or whether to just stash the pointer.

Make sure to follow the [rule of three](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29). Or better yet, just use `std::string` which consistently takes option 1 and thus you can just use it without worrying.

# android - 为什么我的小部件没有更新？

> ID：10788834
> 
> 赞同：0
> 
> 时间：2012-05-28T18:13:21.913
> 
> 标签：android, android-widget

我正在尝试制作一个简单的小部件，该小部件在用户遇到问题的一组提示卡上缓慢旋转/迭代（类似于 windows phone live tile）。

我能够创建小部件，它显示了我设置为“未加载任何内容”之类的默认文本，并且我收到了回调，但小部件文本未更新。

我已经浏览了 android 文档以及堆栈溢出，但找不到答案。我想也许我的 ComponentName 不正确，所以我只是在我的小部件管理器中获取小部件数组并迭代它们。它*确实*获得了小部件列表，所以这似乎是正确的......

我究竟做错了什么？

非常感谢，猪

```
public class MistakeArchiveWidgetProvider extends AppWidgetProvider 
{
  @Override
  public void onUpdate(Context context, AppWidgetManager appWidgetManager,
      int[] appWidgetIds)
  {
    Timer timer = new Timer();
    timer.scheduleAtFixedRate(new MyTime(context, appWidgetManager), 1, 60000);

    // When the widget is clicked, launch the app.
    for (int i = 0; i < appWidgetIds.length; i++) 
    {
        int appWidgetId = appWidgetIds[i];

        Intent intent = new Intent(context, QuizActivity.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);

        // Get the layout for the App Widget and attach an on-click listener
        // to the button
        RemoteViews views = new RemoteViews(context.getPackageName(),
            R.layout.mistake_archive_widget);
        views.setOnClickPendingIntent(R.id.STATIC_CUE, pendingIntent);
        views.setOnClickPendingIntent(R.id.STATIC_ANSWER, pendingIntent);

        // Tell the AppWidgetManager to perform an update on the current app widget
        appWidgetManager.updateAppWidget(appWidgetId, views);
    }
  }

  private class MyTime extends TimerTask
  {
    public MyTime(Context context, AppWidgetManager appWidgetManager)
    {
      this.m_appWidgetManager = appWidgetManager;
      m_remoteViews = new RemoteViews(context.getPackageName(), 
          R.layout.mistake_archive_widget);

      m_componentName = new ComponentName(context, MistakeArchiveWidgetProvider.class);
      m_context = context;
    }

    @Override
    public void run()
    {
      MistakeArchive archive = new MistakeArchive();
      if(archive.restoreState(m_context))
      {
        SharedPreferences prefs = 
            PreferenceManager.getDefaultSharedPreferences(m_context);

        int activeIndex = prefs.getInt(
            MyPrefs.PREFKEY_ACTIVE_MISTAKE_ARCHIVE_HASH_INDEX, 0);

        activeIndex++;
        SharedPreferences.Editor editor = prefs.edit();
        editor.putInt(MyPrefs.PREFKEY_ACTIVE_MISTAKE_ARCHIVE_HASH_INDEX, 
            activeIndex);
        editor.commit();

        CueLine cueLine = archive.getMistake(activeIndex);
        if(cueLine != null)
        {
          m_remoteViews.setTextViewText(R.id.STATIC_CUE, cueLine.GetCue());
          m_remoteViews.setViewVisibility(R.id.STATIC_CUE, View.VISIBLE);
          m_remoteViews.setTextViewText(R.id.STATIC_ANSWER, cueLine.GetAnswer());

          int[] appWidgetIds = m_appWidgetManager.getAppWidgetIds(m_componentName);
          for (int i = 0; i < appWidgetIds.length; i++) 
          {
            m_appWidgetManager.updateAppWidget(i, m_remoteViews);
          }
        }
      }
    }

    RemoteViews m_remoteViews;
    AppWidgetManager m_appWidgetManager;
    ComponentName m_componentName;
    Context m_context;
  }
} 
```

在我的清单 xml 中，我有：

```
 <receiver android:name="myApp.MistakeArchiveWidgetProvider" android:label="@string/IDST_APP_NAME">
   <intent-filter>
      <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
   </intent-filter>
   <meta-data android:name="android.appwidget.provider"
            android:resource="@xml/mistake_archive_widget_provider" />
 </receiver> 
```

error_archive_widget_provider.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
   android:minWidth="50dip"
   android:minHeight="50dip"
   android:updatePeriodMillis="10000"
   android:initialLayout="@layout/mistake_archive_widget"
/> 
```

error_archive_widget.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:orientation="vertical"
    android:background="@drawable/widget_background"
    >

        <TextView
            android:id="@+id/STATIC_CUE"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center"
            android:layout_weight="1"
            android:textStyle="bold"
            android:visibility="gone" 
            android:text=""
            />

        <TextView android:id="@+id/STATIC_ANSWER"
                  android:layout_width="fill_parent"
                  android:layout_height="fill_parent"
                  android:gravity="center"
                  android:layout_weight="1"
                  android:text="@string/IDST_NO_CUES_LOADED"
                  />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:57:04.170

好的，我想通了：不要使用 TimerTask。这不能按预期工作。我很确定我在某个地方遵循了一个告诉我这样做的例子，但仔细想想，它看起来有缺陷。

我更改了所有内容，以便在 onUpdate() 中完成，并删除了所有计时器内容。Android 将以每 30 分钟的最大速率调用此函数。

现在也很简单:)

解决方案：

```
public class MistakeArchiveWidgetProvider extends AppWidgetProvider 
{
  @Override
  public void onUpdate(Context context, AppWidgetManager appWidgetManager,
      int[] appWidgetIds)
  {
    // When the widget is clicked, launch the app.
    for (int widgetIndex = 0; widgetIndex < appWidgetIds.length; widgetIndex++) 
    {
      int appWidgetId = appWidgetIds[widgetIndex];

      RemoteViews views = new RemoteViews(context.getPackageName(),
          R.layout.mistake_archive_widget);

      // Get the layout for the App Widget and attach an on-click listener.
      {
        Intent intent = new Intent(context, QuizActivity.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);

        views.setOnClickPendingIntent(R.id.STATIC_CUE, pendingIntent);
        views.setOnClickPendingIntent(R.id.STATIC_ANSWER, pendingIntent);
      }

      views.setTextViewText(R.id.STATIC_CUE, cueString);
      views.setTextViewText(R.id.STATIC_ANSWER, cueAnswer);

      // Tell the AppWidgetManager to perform an update on the current app widget
      appWidgetManager.updateAppWidget(appWidgetId, views);
    }
  }
} 
```

# ruby-on-rails - 使字段要求并在验证时以“http://”开头

> ID：10788843
> 
> 赞同：1
> 
> 时间：2012-05-28T18:14:35.733
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试为我的`store.website`. 我希望该方法检查网站字段是否以`http://`or开头`https://`。这是我尝试过的：

```
class Store < ActiveRecord::Base
  validate :website_has_correct_format

  def website_has_correct_format
    self.website = self.website.downcase.start_with?(/https?:\/\//, '')
  end
end 
```

但这不起作用。出于某种奇怪的原因，它实际上只是保存了这封信`t`。

这样做的正确方法是什么？另外，我也可以放一个`:message`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:24:38.113

1.  不要修改验证器中的值；验证器应该验证现有数据而不更改它。

2.  该[`start_with?`](http://apidock.com/ruby/String/start_with%3F)方法将 normal`String`作为参数，而不是`Regexp`.

因此，您可以像这样实现您的验证器：

```
def website_has_correct_format
  errors.add(:website, "Wrong website") unless website.downcase.start_with?('https://', 'http://')
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:24:23.180

[`start_with?`返回`true`或`false`](http://apidock.com/ruby/String/start_with?)-- 给定一个字符串参数。

您还将验证与设置值混为一谈——验证是或否；为什么要在验证方法中设置属性值？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:27:32.593

您不应该在验证中修改模型中的数据，因为您有`before_save`操作。验证器应该看起来：

```
def website_has_correct_format
  errors.add(:website, 'Wrong website') unless website =~ %r{\Ahttps?://}
end 
```

# php - comment_form() 不工作

> ID：10788844
> 
> 赞同：0
> 
> 时间：2012-05-28T18:14:44.053
> 
> 标签：php, html, forms, wordpress, comments

这是我的`single.php`：

```
<?php get_header(); ?>

<?php

if ( have_posts() ) :
    while ( have_posts() ) : the_post();
         the_content();
         comments_template();
    endwhile;
endif;
?>

<?php get_footer(); ?> 
```

这是我的`comments.php`：

```
<h2>Comments</h2>

<?php
wp_list_comments();
comment_form(array('title_reply'=>'Leave a Comment',
                   'comment_notes_before'=>'',
                   'comment_notes_after'=>''));
?> 
```

`wp_list_comments()`工作正常，但`comment_form()`什么也没返回。如何让评论表单出现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:36:59.837

事实证明，我从另一个 WordPress 实例导入的一些（但不是全部）帖子的评论被禁用了。一旦我启用评论，这些功能就可以正常工作。

# php - PHP MYSQL 结果中的三斜杠

> ID：10788847
> 
> 赞同：0
> 
> 时间：2012-05-28T18:15:11.567
> 
> 标签：php, mysql

我曾经`mysql_real_escape_string`在数据库中输入信息，但是当我在查询中返回信息时，我得到`\\\'`了文本。我已经做到了，以便插入查询在`'`像以前一样保存时不再停留在句子中。如果文章包含撇号，它会在中途停止保存文章的标题。这已得到修复，但现在我知道`\\\'`有撇号的地方。

例子：`Microsoft\\\'s $15 Windows 8 upgrade offer to run from June 2nd to January 31st, will include free workshops`

我从数据库返回列表的查询代码如下所示：（请注意，这是摘录，因此不包含此循环的结束）

```
<?php

    $q2 = "SELECT * FROM ReadLater WHERE Folder_ID = 0 AND User_ID = $loggedInUser->user_id ORDER BY dt_added DESC";
    $r2 = mysql_query($q2);

    echo "<div id='folderstitleright'>Unread</div>";

    if(mysql_num_rows($r2)>0)
        {
        echo "<ul id='foldersarticlelist'>";
        $sr2=1;
        while($row = mysql_fetch_assoc($r2))

            {

            echo "
               <li class='box'> 
```

ETC

知道如何阻止这种情况吗？我已经测试过魔术引号是否打开并且它们是打开的，但是对于网络主机我无法打开它们（我发现，很可能有一个非常复杂的方法，但我还没有找到它）的和他们还说他们忽略了 .htaccess 文件中的 php 标志。

我试图做一个 preg_replace ，`\\\' to '`但到目前为止还没有成功，从我的尝试来看，它完全破坏了查询，但我很可能执行错了，或者把它放在了上面代码中的错误位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:17:43.763

不要使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)，只需使用[str_replace](http://php.net/manual/en/function.str-replace.php)。

```
$text = str_replace("\\\\\\", "'", $text);
// Use 6 slashes as '\\' is really '\' because '\-' is an escape sequence. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:25:25.917

要使用当前数据库中的数据，请在返回的内容上使用*两次*。[`stripslashes`](http://php.net/manual/en/function.stripslashes.php)

 *但是，最好更正数据库中的内容并更改`INSERT`脚本，以便将来不再插入损坏的数据（可能涉及删除对[`addslashes`](http://php.net/manual/en/function.addslashes.php)or的调用[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:39:00.933

首先，我会要求您的网络主机禁用魔术引号，如果您结帐页面[http://www.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc](http://www.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc)您可以阅读“警告此功能自 PHP 5.3.0 起已弃用，自 PHP 5.4.0 起已移除。”。

您不能在运行时禁用它，因此您的主机必须在 php 配置中进行更改。如果您的主机拒绝禁用魔术引号，您可以创建一个 php 函数，例如“secVar()”，而不是在每个 mysql 查询中使用“mysql_real_escape_string”。

那么你的函数“secVar”将是：

如果在网络主机上激活“魔术报价”：

```
function secVar($var){
    return $var;
} 
```

如果在虚拟主机上禁用了“魔术引号”：

```
function secVar($var){
    return mysql_real_escape_string($var)
} 
```

这样做可以让您在您的虚拟主机禁用魔术引号或更改主机时快速更新您的脚本以保护您的变量。

你也可以用另一种方式来解决这个问题：在你的脚本被执行之前，魔术引号是在运行时“放置”的。凭记忆，“魔术引号”被放置在以下变量数组中：$_REQUEST、$_POST、$_GET、$_FILES 和其他变量。知道你可以 1\. 检查是否启用了魔术引号 2\. 如果启用，则从每个受魔术引号影响的数组中删除每个变量的所有斜线。

一种或另一种解决方案应该适合您。

玩得开心！*

# android - 如何转换android颜色格式？

> ID：10788858
> 
> 赞同：1
> 
> 时间：2012-05-28T18:16:58.213
> 
> 标签：android, colors, color-codes

我有一个颜色选择器对话框，您可以在其中为按钮、文本颜色等选择颜色。如果我记录选择的颜色，我会得到一个 -13459125 数字，我不知道 RGB 颜色是什么。我看到它是 24 位颜色代码，因为可以选择 256*256*256 颜色，但是如何将其转换为可以定义其 RGB 代码的格式？我也不知道为什么它是负面的......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T18:22:03.140

其压缩的 4 字节为一个整数`0xAARRGGBB`

您的值 (-13459125) 是 0xFF32A14B，或者

A=255 R=50 G=161 B=75 十进制。

如果您有颜色 c，则可以通过以下方式获取组件：

```
int red = Color.red(c)
int green = Color.green(c) 
```

ETC

# ruby-on-rails - Rails 控制台崩溃

> ID：10788860
> 
> 赞同：4
> 
> 时间：2012-05-28T18:17:05.203
> 
> 标签：ruby-on-rails, ruby-on-rails-3, console, rails-console

当我加载我的 Rails 控制台时，我收到以下错误

```
Loading development environment (Rails 3.2.3)
/Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/magic-file.rb:7:in `initialize': No such file or directory -  (Errno::ENOENT)
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/magic-file.rb:7:in `open'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/magic-file.rb:7:in `open'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/input-method.rb:77:in `initialize'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/context.rb:82:in `new'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/context.rb:82:in `initialize'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:99:in `new'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:99:in `initialize'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:56:in `new'
from /Users/nataliamurashev/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:56:in `start'
from /Users/nataliamurashev/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
from /Users/nataliamurashev/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
from /Users/nataliamurashev/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

有人对如何解决这个问题有想法吗？

这是为那些询问的人准备的 Gemfile。没有 .irbrc 文件...

```
gem 'rabl'
gem 'rails', '3.2.3'
gem 'bootstrap-sass', '2.0.0'
gem 'omniauth-twitter'
gem 'cgi-spa'

group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.10.0'
  gem 'annotate', '~> 2.4.1.beta'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :test do
  gem 'capybara', '1.1.2'
end

group :production do
 gem 'pg', '0.12.2'
end 
```

我使用的是 Mac OS.X 版本 10.7.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T17:49:20.647

我知道这很旧，但是如何将 RVM、ruby 和 rails 更新到最新版本。在撰写本文时，Ruby 的版本为 2.0.0-p195。RVM 将允许您运行多个版本的 ruby​​，因此您还可以尝试最新版本的 1.9.3，即 Ruby 1.9.3-p429

有关更新的说明，请参阅此链接。 [http://railsapps.github.io/installing-rails.html](http://railsapps.github.io/installing-rails.html)

# c - memset(&mystruct, 0, sizeof mystruct) 和 mystruct = { 0 }; 一样吗？

> ID：10788861
> 
> 赞同：21
> 
> 时间：2012-05-28T18:17:11.667
> 
> 标签：c, struct

我正在阅读默认的数组/结构的初始化值，并且有这个问题：

是`memset(&mystruct, 0, sizeof mystruct)`一样的`mystruct = { 0 };`吗？

如果不是，有什么区别？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-28T18:18:58.530

> memset(&mystruct, 0, sizeof mystruct) 是否与 mystruct = { 0 } 相同；?

不。

```
memset(&mystruct, 0, sizeof mystruct) ; 
```

... 将告诉编译器调用我们期望**在执行期间**将 mystruct 中的数据设置为零的函数。

```
mystruct = { 0 }; 
```

...将设置告诉编译器自己将数据设置为零，这意味着它将：

*   *如果可能，***在编译**时将 mystruct 中的数据设置为零（例如对于静态变量，正如[tristopia](https://stackoverflow.com/users/146377/tristopia)和[Oli Charlesworth](https://stackoverflow.com/users/129570/oli-charlesworth)在评论中所说）
*   或者*如果不是*（例如自动变量），则生成汇编代码，该代码将在变量初始化时将数据设置为零（这比调用函数执行此操作要好）。

请注意，*也许*编译器可以将 memset 优化为编译时指令（*例如用第二个版本替换第一个版本*`memset`），但我不会像运行时库中的函数那样依赖它，而不是某些语言内在（*我不过，我不是编译器作家/语言律师*）。

来自 C++，我自己的观点是，你在编译时可以做的越多，编译器在编译时知道的越多，甚至在执行开始之前就越好：它使编译器能够优化代码和/或生成警告/错误。

在当前情况下，使用`mystruct = { 0 };`符号来初始化 a`struct`总是比使用 memset 更安全，因为在 C 中用 a 编写错误的东西*非常*`memset`容易，而编译器不会抱怨。

以下示例表明，代码很容易做一些与看起来不同的事情：

```
// only the 1st byte will be set to 0
memset(&mystruct, 0, sizeof(char)) ;          

// will probably overrun the data, possibly corrupting
// the data around it, and you hope, crashing the process.
memset(&mystruct, 0, sizeof(myLARGEstruct)) ; 

// will NOT set the data to 257\. Instead it will truncate the
// integer and set each byte to 1
memset(&mystruct, 257, sizeof(mystruct)) ;    

// will set each byte to the value of sizeof(mystruct) modulo 256
memset(&mystruct, sizeof(mystruct), 0) ;      

// will work. Always.
mystruct = { 0 } ; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-28T18:42:50.400

This is a completely pedantic answer, but given that the internal representation of a null pointer is not guaranted to be `0` the behavior of `memset` versus brace-initialization would differ (`memset` would do the wrong thing). That said, I've never heard of an implementation that took on this liberty to have a non all 0 bit pattern for null.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-28T18:42:26.097

理论上是有区别的。如果有一些 in ，则初始化程序不需要初始化填充`mystruct`。例如：

```
int main(void) 
{
     struct mystruct {
          char    a;
          int     what;
     } s = {0};
} 
```

可能包含：

```
00 xx yy zz 00 00 00 00 
```

其中 xx yy 和 zz 是堆栈中的未定义字节。允许编译器这样做。这就是说，实际上，我还没有遇到过这样做的编译器。大多数理智的实现将在语义上处理这种情况，例如 `memset`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-28T21:25:02.250

```
memset(&mystruct, 0, sizeof mystruct); 
```

是一个声明。它可以在`mystruct`可见的任何时间执行，而不仅仅是在它被定义的地方。

```
mystruct = { 0 }; 
```

实际上是语法错误；`{ 0 }`不是一个有效的表达式。

（我假设这`mystruct`是一个类型的对象`struct foo`。）

你可能想到的是：

```
struct foo mystruct = { 0 }; 
```

`{ 0 }`初始化器在哪里。

如果您的编译器支持它，您还可以编写：

```
mystruct = (struct foo){ 0 }; 
```

其中`(struct foo){ 0 }`是*复合文字*。C99 中引入了复合文字；一些 C 编译器，尤其是微软的可能不支持它。（请注意，这*不是*`(struct foo)`强制转换运算符；它看起来与 one 相似，但后面没有表达式或带括号的类型名称。它是一种独特的语法结构。）

 *如果您的编译器不支持复合文字，您可以通过声明一个常量来解决它：

```
const struct foo foo_zero = { 0 };

struct foo mystruct;
/* ... */
mystruct = foo_zero; 
```

这就是它们在语法和使用位置上的不同之处。还有语义上的差异。

该`memset`调用将构成 of 表示的所有字节设置`mystruct`为全零。这是一个非常低级的操作。

另一方面，初始化器：

```
struct foo mystruct = { 0 }; 
```

将第*一个*标量子组件设置`mystruct`为 0，并将所有其他子组件设置为好像它们被初始化为静态对象 - 即，设置为 0。（如果有更简洁的`struct foo mystruct = { };`语法来做同样的事情，那就太好了，但是没有'吨。）

问题是，将某些内容设置`0`为不一定与将其表示设置为全零位相同。该值`0`被*转换*为每个标量子组件的适当类型。

对于整数，该语言保证所有位为零是 的表示`0`（但不一定是 的唯一表示`0`）。将整数设置为 很可能`0`会将其设置为所有位为零，但可以想象它可以将其设置为`0`. 在实践中，这只会发生在故意不正当的编译器上。

对于指针，*大多数*实现将空指针表示为所有位为零，但语言不保证这一点，并且存在使用其他表示的实际实现。（例如，使用像 all-bits-one 这样的东西可能会使空指针取消引用在运行时更容易检测到。）并且对于不同的指针类型，表示可能会有所不同。[请参阅comp.lang.c FAQ](http://c-faq.com/)的第 5 节。

同样，对于浮点类型，大多数实现都表示`0.0`为全零，但语言标准不保证这一点。

您可能可以编写*假设*`memset`调用会将所有子组件设置为零的代码，但这样的代码并不是严格可移植的——墨菲[定律](http://en.wikipedia.org/wiki/Murphy%27s_law)暗示该假设将在最不方便的时刻失败，也许当您移植代码时到一个重要的新系统。*

# python - 将套接字对象发送到分叉的运行进程（multiprocessing.Queue）

> ID：10788865
> 
> 赞同：6
> 
> 时间：2012-05-28T18:18:02.727
> 
> 标签：python, sockets, queue, multiprocessing

我正在学习使用 HTML5 WebSockets，作为其中的一部分，我正在用 Python 编写一个服务器，这样我就可以了解它们的工作原理。前几天我创建了一个运行良好的，但我想扩展它，以便它支持多个端点，每个端点都是可以处理 websocket 客户端的不同“服务”。

目前，我的实现适用于生成进程等（我使用多处理而不是线程，因为我读到线程在 CPython 中并不是真正的多线程，这就是我认为我正在使用的（Ubuntu 12.04 上的默认安装）），但是我无法将收到的客户端套接字发送到服务进程。

这是我发送它们的方式（循环运行）：

```
try:
    #get a new client
    conn, addr = server.accept()
    print "Client connected from", addr
    request = conn.recv(4096)
    response, close, service = self.handshake(request)
    conn.send(response)
    if close:
        print "Invalid request from", addr
        conn.close()
        continue
    client = WebSockets.WebSocketClient(conn, addr)
    service.clientConnQueue.put(client) 
```

'server' 是一个侦听传入连接的套接字。握手方法负责验证他们的请求并确定将客户端放入哪个服务进程。'response' 是发送的 http 响应，'close' 是 True 如果有错误，'service' 是继承自 multiprocessing.Queue 的类。WebSocktes.WebSocketClient 是存储我的发送和接收实现的地方，它基本上用作套接字的包装器。

'clientConnQueue' 的创建方式如下：

```
class Service(multiprocessing.Process):
    """Base class for all services."""
    def __init__(self, manager):
        multiprocessing.Process.__init__(self)
        self.manager = manager
        self.clientConnQueue = self.manager.Queue()
        self.shutdownFlag = multiprocessing.Event() 
```

manager 是一个 multiprocessing.Manager()

当我尝试将客户端放入 clientConnQueue 时出现的错误如下：

```
File "./WebSocketServer.py", line 183, in <module>
main()
File "./WebSocketServer.py", line 180, in main
server.runServer()
File "./WebSocketServer.py", line 67, in runServer
service.clientConnQueue.put(client)
File "<string>", line 2, in put
File "/usr/lib/python2.7/multiprocessing/managers.py", line 758, in _callmethod
conn.send((self._id, methodname, args, kwds))
TypeError: expected string or Unicode object, NoneType found 
```

然后我在接收端收到一个损坏的管道错误。

当我使用 multiprocessing.Queue 发送连接时遇到了同样的错误，我认为将其更改为由管理器创建的队列可以解决问题。但是，它似乎做了完全相同的实现。

显然，这不是人们应该将这样的东西发送到正在运行的进程的方式，那么将不可序列化的对象发送到进程的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:31:13.423

将套接字传递给另一个进程并不是一件小事。例如，看这个问题： [我可以打开一个套接字并将其传递给 Linux 中的另一个进程吗](https://stackoverflow.com/questions/1997622/can-i-open-a-socket-and-pass-it-to-another-process-in-linux)

无论如何，操作系统进程或线程并不是你真正想要的实现 websocket 服务器，因为内存开销很大。使用非阻塞套接字查看 smth ... 例如，Tornado [http://www.tornadoweb.org/documentation/websocket.html](http://www.tornadoweb.org/documentation/websocket.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:08:39.927

它已经存在了 4 年多，虽然需要一些工作。

胆量在 multiprocessing.reduction 中徘徊，示例的细节可以在[这个 github gist](https://gist.github.com/3723597)中看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:24:33.953

如果不使用深度 unix 魔法，就无法将套接字发送到分叉进程。如果您真的想了解它是如何在 C 中完成的，您可以阅读 Unix 环境中的高级编程一书。

对于使用线程的简单解决方案更改，您的代码可能会正常工作。虽然 Python 中的线程并不完美，但它非常适合做 IO 密集型的工作。

或者，在分叉之前创建您的侦听套接字并让所有子进程进行侦听（调用`accept`）。操作系统将确保只有其中一个获得连接。这是通常编写预分叉服务器的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-03T15:30:40.547

如果你在进程分叉之前创建套接字，那么它的文件描述符将被子进程继承。

# java - 如何从 ArrayList 中删除位图？

> ID：10788866
> 
> 赞同：0
> 
> 时间：2012-05-28T18:18:07.960
> 
> 标签：java, android, bitmap, arraylist, parcelable

我有一个名为 PlayerList 的类，在该类中我有一个这样定义的 ArrayList：

```
private ArrayList<Bitmap> images = new ArrayList<Bitmap>(); 
```

现在，一个 ArrayList 删除方法可以 exept 2 个参数，一个索引和一个对象。

我试图通过将位图发送给它来从数组中删除位图。问题是位图由相同的图像组成，但是我保存在数组中的位图的实例与我试图找到的不同，当我将 ArrayList 打印到控制台时，我总是看到新名称，东西喜欢 ：

```
[android.graphics.Bitmap@44ea2d48, android.graphics.Bitmap@44ea2e20] 
```

这可能有关系吗？当我们在做的时候，该类实现`Parcelable`了来回读取/写入的数据，这也不能太健康，对吧？

我错过了一个通用问题还是它的代码特定，我应该发布我的代码？

我的问题基本上是当我尝试删除位图时，它总是删除数组列表中的错误项目，总是在我需要的 1 之前删除

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:33:39.017

除非您有`BitMap's`哈希码的句柄或存储它的类似键，否则您无法从列表中删除所需的一个。如果只想依赖`BitMap`存储，则需要遍历列表并解析元素以找到所需的位图。同样，您需要一个 hascode 来确定`BitMap`您正在解析的内容是否是您正在寻找的内容。这意味着您需要维护`hashcode's`每个`BitMap`存储的列表。或者使用`HashMap`over `List`that 允许存储`key`一个`BitMap`被存储的对象。您可以根据需要处理您的要求，`key`并在需要时使用它`BitMap`从`HashMap`表中删除 a。

```
HashMap<String, BitMap> myBitMaps = ... // construct as you desire.
...
if ( condition satisfied on key ) {
  myBitMaps.remove( keyObject );
  // process further
} 
```

# c# - C#代码一下子让IE崩溃

> ID：10788867
> 
> 赞同：0
> 
> 时间：2012-05-28T18:18:25.550
> 
> 标签：c#, asp.net

我的 C# 代码 ASP.NET 在我的计算机上运行良好，直到我通过远程桌面控制将它移到另一台计算机上。完全相同的代码在我的计算机上运行，​​但在我运行应用程序 IE 崩溃后不久在另一台计算机上运行......Visual Studio 给出了以下错误。IE 版本在两台 PC 上是相同的，并且错误看起来与权限有关，您怎么看？

![在此处输入图像描述](../Images/b031c73e71dde9dbc1cc5a1554a476ba.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:23:47.353

您是否运行 aspnet_regiis 来授予 ASP.NET 在 IIS 中运行的权限？您可以使用以下命令执行此操作：

```
aspnet_regiis -ga myaspnetuserid 
```

将 myaspnetuserid 替换为您用于托管站点的用户的 ID。

# javascript - 使用 jQuery 动态插入图像

> ID：10788872
> 
> 赞同：3
> 
> 时间：2012-05-28T18:19:02.833
> 
> 标签：javascript, jquery, html, image

我正在使用一个程序（jAlbum）来创建一个画廊，并且在那个画廊中它有一个地方可以获取有关照片的更多信息。目前它只显示`Photo Info ^`. 我有一张图片我想插入到包含单词 Photo Info 的 span 中。我会在程序中执行此操作，但搜索后我找不到该跨度（我相信它可能是用 javascript 生成的，但我找不到生成它的行）。所以我想我可以使用 jQuery 动态插入这个图像。我不确定如何做到这一点，因为 javascript 不是我的强项。以下是 span 的 HTML 当前的外观：

```
<span id="lightwindow_info_tab_span" class="up"> Photo Info</span> 
```

以下是将图像插入代码后的外观：

```
<span id="lightwindow_info_tab_span" class="up"><img class="inline" 
  src="/Images/Icons/info.png" />Photo Info</span> 
```

做这个的最好方式是什么？请记住，我在 javascript 方面不是超级强（只是强到可以破坏东西 => ）所以请提供一个例子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T18:27:26.510

```
$('#lightwindow_info_tab_span')
              .prepend('<img class="inline" src="/Images/Icons/info.png" />'); 
```

在这里我使用[`.prepend()`](http://api.jquery.com/prepend)，因为根据 OP 的帖子，图像在文本之前。

你也可以使用[`.prependTo()`](http://api.jquery.com/prependto)

```
$('<img class="inline" src="/Images/Icons/info.png" />')
              .prependTo('#lightwindow_info_tab_span'); 
```

或者

```
var yourImg = $('<img/>', {
                           "class" :"inline", // or className: "inline"
                            src:"/Images/Icons/info.png"
                         });

$("#lightwindow_info_tab_span").prepend(yourImg); 
```

您还可以使用：

```
$('#lightwindow_info_tab_span').html(function(index, oldHTML) {
    return '<img class="inline" src="/Images/Icons/info.png" />' + oldHTML;
}); 
```

**但在此之前我会选择**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:24:45.683

```
var img = $('<img class="inline" src="/Images/Icons/info.png" />');
$("#lightwindow_info_tab_span").prepend(img); 
```

或者

```
var img = $('<img/>', {"class" :"inline", src:"/Images/Icons/info.png"});
$("#lightwindow_info_tab_span").prepend(img); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:25:52.453

```
$('<img class="inline" src="/Images/Icons/info.png" />').prependTo("#lightwindow_info_tab_span") 
```

# android - 我是否需要在 Android 许可库中编辑 ServerManagedPolicy？

> ID：10788873
> 
> 赞同：2
> 
> 时间：2012-05-28T18:19:03.523
> 
> 标签：android

我在 com.google.android.vending.licensing 库中使用 LicenseChecker 和 ServerManagedPolicy。当我查看那里的一些代码时，我很困惑。ServerManagedPolicy 中有注释说明以下内容：

“您必须手动调用 PreferenceObfuscator.commit() 将这些更改提交到磁盘。”

我应该这样做吗？我在 Google 代码中没有看到对 commit() 方法的任何调用。我认为通过使用 ServerManagedPolicy，我不需要手动编辑库中的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:20:45.327

对 commit() 方法有一个调用 - 在 processServerResponse() 方法的最后。

如果您仔细观察，您会注意到此调用是在调用 setValidityTimestamp()、setRetryUntil() 和 setMaxRetries() 之后使用从有效性服务器获取的数据进行的。

这就是为什么要提交这些价值观 :)

结论：如果 ServerManagedPolicy 的默认行为让您满意，您不必更改此文件中的任何内容。

# forms - Coldfusion - CFMail 错误 - 创建收件人：列表和密件抄送：列表

> ID：10788876
> 
> 赞同：0
> 
> 时间：2012-05-28T18:19:34.580
> 
> 标签：forms, email, coldfusion, coldfusion-8, cfmail

对于 CFMail - 我正在构建一个 To: list 和 BCC: list using cfset tolist 和 cfset bcclist

这些输出就好了。但是当我将它们添加到 cfmail 中时 - tolist 和 bcclist 错误。

我不知道为什么，因为它们只是逗号分隔的列表。

获取：当前为 emailthis@gmail.com,emailthat@gmail.com,emailagain@gmail.com 的属性值无效。

当我在上面的列表中硬编码时 - 它工作得很好。

下面的 alist 和 clists 创建得很好，对我来说看起来也很好。我似乎无法找到解决我做错了什么的方法。

```
 <cfoutput>
 <cfif isdefined("form.checkbox1")><cfset clist = "#checkbox1#"></cfif>
 <br><br>Check List #clist#
 </cfoutput>

 To:
 <cfset tolist = "#clist#,<cfif alist is not "">#alist#,</cfif><cfif len(other)>#other#</cfif>">
 <cfoutput>#tolist#</cfoutput>

 BCC List - basically the same

 <cfoutput>
 <cfmail type="html" from="bob@bob.com" to="#tolist#" bcc="#bcclist#" mimeattach="#pdfpath#file.pdf" subject="File.pdf">

 Blahhh
 </cfmail>
 </cfoutput> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:07:44.413

我建议重新编写代码以限定变量范围，并从 cfset 语句中删除 if 语句。另外，我假设这不是您的所有代码，因为 tolist 和 bcclist 从未在任何地方设置。试试下面的代码。

```
<cfset tolist = '' />
<cfset bcclist = '' />
<cfoutput>
 <cfif StructKeyExists(form,'checkbox1')>
  <cfset clist = form.checkbox1 />
 </cfif>
 <br><br>Check List #clist#
</cfoutput>

To:
<cfif Len(Trim(alist))>
 <cfset tolist = ListAppend(tolist,alist) />
</cfif>
<cfif Len(Trim(other))>
 <cfset tolist = ListAppend(tolist,other) />
</cfif>

<cfoutput>#tolist#</cfoutput>

<cfmail type="html" from="bob@bob.com" to="#tolist#" bcc="#bcclist#" mimeattach="#pdfpath#file.pdf" subject="File.pdf">
Blahhh
</cfmail> 
```

# php - 为什么 preg_match_all 强制我提供第三个可选参数？

> ID：10788881
> 
> 赞同：4
> 
> 时间：2012-05-28T18:20:15.097
> 
> 标签：php, regex, preg-match, preg-match-all

我正在使用这个正则表达式计算**一些特殊字符**（如欧元符号）的数量：`$text``preg_match_all`

```
preg_match_all('/[\[|\]|€\{|}|\\|\^|\||~]/u', $text); 
```

出于某种奇怪的原因，PHP 要求我提供**第三个参数**。[但根据 preg_match_all 的文档，](http://php.net/manual/en/function.preg-match-all.php)它应该是可选的：

> 警告：preg_match_all() 至少需要 3 个参数，给定 2 个。

如果我提供`PREG_PATTERN_ORDER`（甚至不知道我为什么要提供），我会得到：

> 不能通过引用传递参数 3。

那么，我的代码有什么问题？如果需要，这是整个功能：

```
public function getMessageCount($text)
{
    $specials   = preg_match_all('/[\[|\]|€\{|}|\\|\^|\||~]/u', $text)
    $characters = strlen($text) + $specials;

    if(in_array(strtolower($this->method), self::$classic_plans)) :

        if($characters >= 0   && $characters <= 160) return 1;
        if($characters >= 161 && $characters <= 306) return 2;
        if($characters >= 307 && $characters <= 459) return 3;
        if($characters >= 460 && $characters <= 612) return 4;

        return 5;

    endif;

    if(in_array(strtolower($this->method), self::$basic_plans)) :

        if($characters >= 0    && $characters <= 160)  return 1;
        if($characters >= 161  && $characters <= 312)  return 2;
        if($characters >= 313  && $characters <= 468)  return 3;
        if($characters >= 469  && $characters <= 624)  return 4;
        if($characters >= 625  && $characters <= 780)  return 5;
        if($characters >= 781  && $characters <= 936)  return 6;
        if($characters >= 937  && $characters <= 1092) return 7;
        if($characters >= 1093 && $characters <= 1248) return 8;

        return 9;

    endif;

    return in_array(strtolower($this->method), self::$zero_plans) ? 1 : null;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:28:48.947

虽然第三个参数在 5.4.0 中成为可选的，就像其他人已经说过的那样，但是即使你传递了第三个参数，你的代码也不会编译，因为你说你传递了 PREG_PATTERN_ORDER 标志，但是第三个参数应该是接收匹配的数组，第四个参数是旗帜。

使用类似[以下内容](http://ideone.com/fixoL)：

```
<?php
$dummy = array();
echo("Result = ".preg_match_all('/[\[|\]|x\{|}|\\|\^|\||~]/', $text, $dummy));
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:24:41.543

从 PHP 5.4.0 开始，它成为可选的。

> **变更日志**
> 
> 5.4.0 匹配参数变为可选。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:28:09.407

返回值`preg_match_all`是一个 int → 匹配数。匹配文本将填充到^(第三)个参数中。

```
// incorrect
$specials = preg_match_all('/[\[|\]|€\{|}|\\|\^|\||~]/u', $text);      

// correct
$num = preg_match_all('/[\[|\]|€\{|}|\\|\^|\||~]/u', $text, $specials); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T18:24:23.017

查看您提供的链接中的更改日志。之后，检查您的 PHP 版本；）

# html - 基于 URL 的重定向

> ID：10788891
> 
> 赞同：0
> 
> 时间：2012-05-28T18:21:38.263
> 
> 标签：html, .htaccess, redirect

我不确定基于 URL 进行重定向的最有效方法。我已经看到了接近我需要的 htaccess 示例，但我根本不了解它背后的编程。这是我需要发生的事情：

1.  检查页面是否为“watch.html”。
2.  如果 URL 显示为“watch?blahblah”而不是“watch.html?blahblah”，则重定向。
    *   基本上如果 URL 没有 .html
3.  重定向到添加了 .html 的同一页面。

感谢您对编写此代码的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:56:41.780

不，我觉得完全没问题。mod_rewrite 模块有一个相当晦涩的语法，它可能非常令人沮丧。

你想要的东西可以这样写：

```
RewriteEngine On

RewriteCond %{REQUEST_URI} !\.html$
RewriteRule (.*) $1.html 
```

首先我们打开重写引擎。然后是[RewriteCond](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)指令：如果该条件评估为真，则将应用其后的单个 RewriteRule。RewriteCond 的语法很简单`RewriteCond <subject> <regex pattern>`：如果模式与主题匹配，则条件将评估为真。在我们的例子中，模式是名为 REQUEST_URI 的服务器变量，您可能对 PHP 很熟悉，它保存用户请求的 URI。这里的模式是正则表达式`\.html$`. 这里的 \ 是一个转义字符，用于转义点，您可能知道它在正则表达式中具有特殊含义（“匹配任何字符”）；$ 符号表示行尾；这 ！否定整个表达式，因此如果它后面的模式不匹配，则条件将为真。因此，RewriteCond 行说：“如果请求的 URI 不以字符串 .html 结尾”。

然后是[RewriteRule](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)指令。它的语法是`RewriteCond <from> <to> [optional flags]`. 'from' 部分是要匹配的正则表达式模式。'to' 部分是我们将重写原始查询的字符串。在我们的具体示例中，from 是`(.*)`：. 表示“任何字符”，星表示“任何时间”，所以我们基本上是在说“任意数量的任何字符”，这意味着我们想要捕获整个路径。我们把它放在括号中，以便我们以后可以参考捕获的部分。然后我们将其重写为: `$1.html`，其中 $1 指的是我们在“from”部分捕获的第一个字符串。

就是这样：当我们在地址栏中写“example.com/something”时，将提供页面“example.com/something.html”。

当然，这是非常基本的，可以改进很多，使其更优雅，但这应该可以帮助您入门。周围有很多有用的教程，文档也很有帮助。

# windows - 获取上一个错误 127

> ID：10788904
> 
> 赞同：1
> 
> 时间：2012-05-28T18:22:29.833
> 
> 标签：windows, winapi

为什么下面的代码即使找到“firefox.exe”并成功终止，也总是打印出127（“找不到指定的程序。”）？

```
#include<Windows.h>
#include <TlHelp32.h>
#include<iostream>
using namespace std;

int main( int, char *[] )
{
    PROCESSENTRY32 entry;
    entry.dwSize = sizeof(PROCESSENTRY32);

    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);

    if (Process32First(snapshot, &entry) == TRUE)
    {
        while (Process32Next(snapshot, &entry) == TRUE)
        {
            if (_tcscmp(entry.szExeFile, TEXT("firefox.exe")) == 0)
            {  
                HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, entry.th32ProcessID);
                DWORD d = GetLastError();
                cout<<d<<'\n';
                TerminateProcess(hProcess,0);

                CloseHandle(hProcess);
            }
        }
    }

    CloseHandle(snapshot);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:37:12.917

**在检查之前**，您需要检查特定函数的返回值`GetLastError`。

`GetLastError`将始终返回由 API 函数设置的最后一个错误代码。但是，并非所有函数都会在**成功**时设置最后一个错误代码。因此，结果`GetLastError`可能是在程序的其他部分设置的错误代码。

因此，在您的情况下，根据 MSDN 文档，如果失败`OpenProcess`，该函数将返回。`NULL`因此，无需查看`GetLastError`是否`OpenProcess`返回`NULL`.

请注意，最后一个错误代码对于当前线程**是唯一的。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:51:12.027

> 如果函数失败，则返回值为 NULL。要获取扩展错误信息，请调用 GetLastError。

这是 Windows API 中的常见模式，GetLastError 通常仅在函数失败时才有效...（某些函数如[GetFileSize](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364955%28v=vs.85%29.aspx)和 GetFileType 要求您调用 GetLastError 来判断返回值是否有效）

# asp.net - ASPXAUTH Cookie 即将过期

> ID：10788910
> 
> 赞同：0
> 
> 时间：2012-05-28T18:23:16.180
> 
> 标签：asp.net, jquery, session-cookies

我有一个完全基于 jQuery AJAX 构建的应用程序页面。一切都很好，用户体验很好，但我无法解决的一个问题是会话超时。

尽管有各种尝试添加“心跳”（包括发布到更新会话变量的自定义 http 处理程序并将空白页面加载到 iframe 以确保页面生命周期完成），但我仍然虔诚地收到身份验证错误。

据我所知，ASPXAUTH cookie 没有像我希望的那样被更新，超时时间已经过去，然后我得到了我的错误。下次我的“heatbeat”触发时，服务器会给我一个新的cookie，然后我很好，直到下一次超时。

任何见解将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:34:08.683

我记得很久以前面临登录过期的一些问题（这与 ASP.Net 中的会话超时不同）问题是因为我正在创建自定义身份验证 cookie 而不是使用标准重定向方法。你在做类似的事情吗？如果是这样，您可能必须手动更新 cookie，而不是简单地依赖滑动过期魔法。

为了让社区提供帮助，我认为您应该使用以下内容更新您的帖子：

*   表单身份验证的部分配置
*   会话的部分配置
*   用于登录的代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:49:05.033

如果 ASP.NET 进程结束（我相信默认是在 10 分钟不活动后结束进程）并且您没有为站点设置显式身份验证设置，您将看到这一点。

您可以通过增加 IIS 中的空闲超时（[IIS7 / Windows 2008 的说明](http://technet.microsoft.com/en-us/library/cc771956%28v=ws.10%29.aspx)）或在 web.config 文件中设置 machineKey 来解决它。可以在[此处找到有关 machineKey 功能的非常全面的答案，并且可以在](https://stackoverflow.com/questions/3759536/asp-net-machinekey-config-section-default-location)[http://aspnetresources.com/tools/machineKey](http://aspnetresources.com/tools/machineKey)找到 machineKey 部分的生成器。

# java - 使用 MappedSuperClass 对相关表进行休眠过滤器

> ID：10788912
> 
> 赞同：2
> 
> 时间：2012-05-28T18:23:23.067
> 
> 标签：java, spring, hibernate, filter, annotations

我正在尝试过滤以在进行查询时仅显示“活动”实体，使用过滤器和基本 MappedSuperClass 并遇到相关表类不尊重相同过滤器的问题。

这是我的模型设置：

```
@FilterDef(name="baseStatus")
@Filter(name="baseStatus", condition= "Status = 'A'")
@MappedSuperclass
public abstract class BaseModel {

    @Column(name = "Status", insertable = false)
    private String status;

    // getters and setters...
} 
```

我也有具有相关收藏的模型，例如..

```
@Entity
@Table(name = "A")
public class A extends BaseModel {
    @OneToMany()
    private List<B> bs = new ArrayList<B>(0);
// other model properties
}

@Entity
@Table(name = "B")
public class B extends BaseModel {
// model properties
} 
```

在查询之前，我运行：

```
Criteria criteria = sessionFactory.getCurrentSession().createCriteria(A.class)
Filter filter = getCurrentSession().enableFilter("baseStatus");
List<A> as = criteria.list(); 
```

使用此设置，我将正确的过滤器应用于我正在查询的主类，但子集合（“bs”）没有在连接上被过滤，所以我只剩下活动的“A”和一个子集合的“B”，其中一些“B”处于非活动状态。

理想情况下，我只想在 BaseModel 上有过滤器。有什么方法可以在不对每个关联应用单独的过滤器的情况下做我正在寻找的事情？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T21:58:07.950

如果不构建一些自定义的东西，我最终找不到一个很好的解决方案，所以我最终在每个模型的每个关联表上注释 @Filter 如下

```
@FilterDef(name="baseStatus")
@Filter(name="baseStatus", condition= "Status = 'A'")
@MappedSuperclass
public abstract class BaseModel {

    @Column(name = "Status", insertable = false)
    private String status;

    // getters and setters...
}

@Entity
@Table(name = "A")
public class A extends BaseModel {
    @OneToMany()
    @Filter(name="baseStatus", condition= "Status = 'A'")
    private List<B> bs = new ArrayList<B>(0);
// other model properties
}

@Entity
@Table(name = "B")
public class B extends BaseModel {
// model properties
} 
```

虽然不理想，但它可以工作，我仍然只需要打电话

```
Filter filter = getCurrentSession().enableFilter("baseStatus"); 
```

一次在公共数据访问层。

# php - Facebook 连接情况

> ID：10788919
> 
> 赞同：5
> 
> 时间：2012-05-28T18:23:59.490
> 
> 标签：php, facebook

我的应用程序正在使用其内部注册系统供用户注册和登录...

我现在正在检查将 Facebook Connect 集成到我的应用程序中的想法，但我遇到了一种情况，我认为我需要某种帮助......

因此，我的应用程序中的**用户在****注册时**必须**选择**一个唯一**的****用户名**和**电子邮件地址**。

 **如果用户尝试通过 Facebook 连接并且该用户已经存在，会发生什么情况？例如，他们的电子邮件？或者如果该用户没有用户名会发生什么？我可以根据他们的情况向他们显示错误消息吗？

此外，如果用户在 facebook 上没有用户名，但有一个未在我的系统中注册的电子邮件地址，我是否必须向他们显示一个新的输入字段，让他们在他们可以进一步访问该网站之前输入他们的用户名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T18:27:16.307

所有这些场景都在[注册流程](http://developers.facebook.com/docs/user_registration/flows/)中进行了解释，特别是

**我的网站使用 Facebook 和我自己的注册**

![注册流程](../Images/35bb267f00ed353b063458c0e648d643.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:09:38.897

我的建议：

如果用户通过 Facebook 连接，但在您的网站上没有帐户，您应该将他重定向到他需要填写所需数据的页面（用户名和您想要的任何其他内容）。在他填写所有必需的数据之前不要让他走。

如果用户通过 Facebook 连接并且此电子邮件在您的网站上有帐户，您应该将此 Facebook ID 链接到此帐户。

因此，您应该向用户发送独特的电子邮件，他们应该使用它登录。这将是唯一标识符。**

# c++ - 图片文件颜色位逆向工程

> ID：10788921
> 
> 赞同：0
> 
> 时间：2012-05-28T18:24:02.993
> 
> 标签：c++, file, format, reverse-engineering, image

我正在尝试对包含许多 .spr sprite 文件的文件夹进行逆向工程。我正在尝试检索存储在其中的图像我尝试使用十六进制编辑器打开它，并试图找出它的图像高度和宽度，以及它与像素阵列的偏移量。

8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 8A 86 86

这是十六进制信息的一部分。

Qn1）在我看来 2 个字节由 1 个像素组成，它是哪种位类型？是 16 位、24 位等

Qn2）任何人都知道我怎么能找出哪个字节代表图像的高度和宽度？

非常感谢您的帮助。

[http://www.mediafire.com/?ccr180mpocz497z,tcia3h233hx6uhu,f4seeq7qe4jsg2p,5l8cdqeysrt5faf](http://www.mediafire.com/?ccr180mpocz497z,tcia3h233hx6uhu,f4seeq7qe4jsg2p,5l8cdqeysrt5faf)

# php - Phar 在 centos 6 上失败

> ID：10788923
> 
> 赞同：-1
> 
> 时间：2012-05-28T18:24:03.980
> 
> 标签：php, centos, pear, phar, centos6

我在 centos 6 上遇到 Phar 问题。当我运行“phar”时，我得到：

```
# phar -v
PHP Warning:  include(): Failed opening 'phar:///usr/bin/phar.phar/pharcommand.inc' for inclusion (include_path='.:') in /usr/bin/phar.phar on line 48
PHP Fatal error:  Class 'PharCommand' not found in /usr/bin/phar.phar on line 61 
```

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:26:16.883

```
PHP Fatal error:  Class 'PharCommand' not found. 
```

看起来如果您`pharcommand.inc`在`/usr/bin/phar.phar/`.

您的文件是否正确 chmod？

# php - 修改代码，它在 tex 中搜索某个单词并向其添加一个 span 类，以使用数组

> ID：10788924
> 
> 赞同：0
> 
> 时间：2012-05-28T18:24:09.547
> 
> 标签：php

请看一下这段代码（感谢用户 budwiser），它匹配文本中的某个单词并向其广告跨度类：

```
function highlightWord($word, $text){
    return str_replace($word, '<span class="highlighted">' . $word . '</span>', $text);
}

$text = highlightWord('fitness', $text); 
```

任何想法如何使此代码适用于数组？

我需要这样的东西：

```
$words = array("fitness", "aerobic", "fashion");

$text = highlightWord($words, $text); 
```

有任何想法吗？

谢谢！

**更新**

```
$profile_rule = 'profile LIKE (\'fitness\') AND profile LIKE (\'aerobic\')';
preg_match_all('/\'(.*?)\'/',$profile_rule,$match); 
```

知道为什么 $match 数组不起作用吗？我想从 $profile_rule 中提取健身和有氧这两个词，并将 $match 数组用于上述函数。

泰！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:25:49.270

这应该可以解决问题。只需遍历单词并添加突出显示代码。

```
function highlightWords(Array $words, $text)
{
   // Loop through array of words
   foreach($words as $word)
   {
      // Highlight word inside original text
      $text = str_replace($word, '<span class="highlighted">' . $word . '</span>', $text);
   }

   // Return modified text
   return $text;
} 
```

# php - 在 PHP 中使用带有 shell_exec 的 Cookie 变量

> ID：10788926
> 
> 赞同：0
> 
> 时间：2012-05-28T18:24:19.393
> 
> 标签：php, cookies, shell-exec

我试图在 shell_exec 命令中包含一个用户定义的变量（从 cookie 派生）来命名文件。不幸的是，当我运行 PHP 脚本时，文件名只是“.flv”，前面没有变量字符串。我已经测试了 cookie，它确实有效，但看起来它没有正确传递给 shall exec。任何帮助或建议将不胜感激。

```
$shellvar = $_COOKIE["VideoTitle"];
$shellvar = escapeshellarg($shellvar);
shell_exec('/usr/local/bin/ffmpeg -i audio.wav -i videofile.flv $shellvar.flv 2>&1'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:26:48.920

您在 PHP 中使用单引号，这意味着它不会将 $shellvar 解析为 PHP 变量。然后将其传递给终端，该终端尝试使用该变量（当时不存在）并返回一个空白变量。因此，请尝试在 shell_exec 命令中将单引号替换为双引号。

所以代码看起来像：

```
$shellvar = $_COOKIE["VideoTitle"];
$shellvar = escapeshellarg($shellvar);
shell_exec("/usr/local/bin/ffmpeg -i audio.wav -i videofile.flv $shellvar.flv 2>&1"); 
```

**强制性安全警告：**
另外，我恳请您小心，escapeshellarg 是一个很好的命令，但我还建议（除此之外）只允许带有 preg_match 的字母和数字（因为我很偏执）。

就像是

```
if (preg_replace('/[A-Za-z0-9]*/', '', $shellvar) != "")
    echo "DISALLOWED CHARACTERS"; 
```

这样，您至少可以确定您不允许将格式错误的名称传递给终端。我还建议以特定用户的身份运行命令（访问权限很少，不比使用 ffmpeg 多）。

# python - 加入字典列表

> ID：10788934
> 
> 赞同：0
> 
> 时间：2012-05-28T18:24:41.530
> 
> 标签：python, list, sorting, dictionary, union

我有一些这样的字典列表：

```
list1 = [
    dict(RL = 'rl1', 
        shaders = [dict(shader = "shader1", geom = ['a1','b1']),
        dict(shader = "shader2", geom = ['a2','b2'])]),
    dict(RL = 'rl3', 
        shaders = [dict(shader = "shader1", geom = ['c','d']),...])     
]
list2 = [
    dict(RL = 'rl1', 
        shaders = [dict(shader = "shader1", geom = ['p1','q1']),
        dict(shader = "shader3", geom = ['p3','q3'])]),
    dict(RL = 'rl2', 
        shaders = [dict(shader = "shader1", geom = ['c','d']),...])     
] 
```

所以它是一个字典列表，其中每个字典都有一个包含字典列表的值。我知道这不是有史以来最好的数据结构，但现在改变它会非常耗时。我想通过它们的 RL 值加入所有这些列表，然后如果着色器值相同，则将 geom 列表加入在一起。因此，例如对于上面的列表，假设唯一的条目是我写下的条目，我将获得具有相同渲染层 rl1、相同着色器 shader1 的新列表，并且 geom 将`['a','b','c','d']` 感谢您的帮助

编辑：承认我可以改变这个糟糕的数据结构，我应该使用什么样的结构来让事情变得更容易？我唯一想要的是保持层次结构：一个 RL 可以包含许多着色器，这些着色器可以包含许多几何图形，并且我可以有很多这样的条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:02:35.007

坚持你的数据结构，我得到了这个......

```
list1 = [dict(RL = 'rl1', shaders = [dict(shader = "shader1", geom = ['a','b']),
                                     dict(shader = "shader3", geom = ['q','p'])])]
list2 = [dict(RL = 'rl1', shaders = [dict(shader = "shader1", geom = ['c','d']),
                                     dict(shader = "shader3", geom = ['x','y'])])]
list3 = [dict(RL = 'rl1', shaders = [dict(shader = "shader2", geom = ['e','f'])])]
list4 = [dict(RL = 'rl2', shaders = [dict(shader = "shader2", geom = ['g','h'])])]
list5 = [dict(RL = 'rl2', shaders = [dict(shader = "shader2", geom = ['i','j'])]),
         dict(RL = 'rl3', shaders = [dict(shader = "shader4", geom = ['ab','cd'])])]

list_o_lists = [list1, list2, list3, list4, list5]

big_list_o_dicts = []
for x in list_o_lists:
    big_list_o_dicts.extend(x)

big_list_o_dicts.sort(key=lambda x: x['RL'])

new_list_o_lists = []

last_item = None
for item in big_list_o_dicts:
    if last_item and item['RL'] == last_item['RL']:
        for this_shader in item['shaders']:
            for last_shader in last_item['shaders']:
                if last_shader['shader'] == this_shader['shader']:
                    last_shader['geom'].extend(this_shader['geom'])
                    break
    else:
        last_item = item
        new_list_o_lists.append(last_item) 
```

它看起来很疯狂，肯定有更有效的方法，但也许它会帮助你。

**编辑：**作为对您的编辑的回应，除非有某些理由将所有这些列表分开，否则您最终希望将它们全部组合起来表明从一开始就更容易维护您想要的结构。

就像是...

```
rl_shader_map = {
    'rl1': {
        'shader1': ['a', 'b', 'c', 'd'],
        'shader2': ['e', 'f'],
    },
    'rl2': {
        'shader2': ['g', 'h', 'i', 'j']
    }
} 
```

使检查渲染层中的着色器变得更加容易（而不是迭代，它是哈希表查找）。

每当您要创建一个全新的列表对象时，只需在上面的地图中附加或创建适当的通道即可。

如果您需要维护的信息不仅仅是`"geom"`每个着色器，那么我会像这样继续使用另一个字典......

```
rl_shader_map = {
    'rl1': {
        'shader1': {
            'geom': ['a', 'b', 'c', 'd'],
        }
        'shader2': {
            'geom': ['e', 'f'],
        }
    },
    'rl2': {
        'shader2': {
            'geom': ['g', 'h', 'i', 'j'],
        }
    }
} 
```

此外，作为一个风格点，使用 kwarg dict 创建是非常未使用的 AFAIK，所以我会传递一个可迭代的键值元组，或者像我所做`dict([('RL', 'rl1'), ('shader', 'shader1')])`的那样使用语法。`{}`

哇......神圣的废话......对不起咆哮。

# c# - 如何创建 PSafeArray 类型的参数？

> ID：10788939
> 
> 赞同：1
> 
> 时间：2012-05-28T18:25:18.593
> 
> 标签：c#, delphi, com, delphi-xe2, typelib

如何创建 PSafeArray 类型的参数？

我从 C# COM 库中获取以下错误：

```
 SafeArray with range 65262 transfered to the method that requires array with range 1 
```

`Delphi XE2`应该使用带有 PSafeArray 类型参数的类型库调用`C# COM library`过程。`Generated RIDL`

德尔福 XE2 代码：

```
 function GetObjects: PSafeArray;
  var
    aObjects: Variant;
  begin
    aObjects := VarArrayCreate([0, 2], varVariant);
    aObjects[0] := ADOConnection.ConnectionObject;
    aObjects[1] := CashConnection;
    aObjects[2] := Self as IDispatch;
    Result := PSafeArray(TVarData(aObjects).VArray);
  end;

  ICompiler.Execute('MainNameSpace', 'MainClass', 'MainMethod', GetObjects); 
```

C# COM 库代码：

```
void Execute(string Namespace, string ClassName, string MethodName, Object[] Objects);

void ICSCompiler.Execute(string Namespace, string ClassName, string MethodName, Object[] Objects)
{
  System.Type _type = cr.CompiledAssembly.GetType(Namespace + "." + ClassName);
  System.Object obj = Activator.CreateInstance(_type);
  System.Reflection.MethodInfo mi = obj.GetType().GetMethod(MethodName);
  mi.Invoke(obj, new Object[] { Objects });
} 
```

生成的 RIDL 代码：

```
HRESULT _stdcall Execute([in] BSTR Namespace, [in] BSTR ClassName, [in] BSTR MethodName, [in] SAFEARRAY(VARIANT) Objects); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:53:55.293

此代码工作正常：

```
 function GetObjects: PSafeArray;
  var
    aBounds: array [0..0] of TSafeArrayBound;
    aObjects: PSafeArray;
    aIndex: Integer;
    aConnectionObject: OleVariant;
    aCashConnection: OleVariant;
    aScript: OleVariant;
  begin
    aBounds[0].lLbound   := 0;
    aBounds[0].cElements := 3;
    aObjects := SafeArrayCreate(varVariant, 1, @aBounds);
    aIndex := 0;
    aConnectionObject := ADOConnection.ConnectionObject;
    OleCheck(SafeArrayPutElement(aObjects, aIndex, aConnectionObject));
    aIndex := 1;
    aCashConnection := CashConnection;
    OleCheck(SafeArrayPutElement(aObjects, aIndex, aCashConnection));
    aIndex := 2;
    aScript := Self as IDispatch;
    OleCheck(SafeArrayPutElement(aObjects, aIndex, aScript));
    Result := aObjects;
  end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:31:09.337

我记得的第一件事是`SafeArrayCreate`。看看“ [PSafeArray 的奥秘](http://blog.virtec.org/2008/07/the-mysteries-of-psafearray/)”

# fullcalendar - EventClick回调中鼠标点击的X、Y

> ID：10788942
> 
> 赞同：-1
> 
> 时间：2012-05-28T18:25:33.710
> 
> 标签：fullcalendar

在 FullCalendar 中，如何在 eventClick 回调中获取鼠标单击 (x,y) 的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:06:48.020

```
eventClick: function(calEvent, jsEvent, view) {
  alert(jsEvent.pageX); //X coordinate
  alert(jsEvent.pageY); //Y coordinate
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:37:23.603

```
 public void eventClick(Event e){
        int x,y;

        x = e.getX();
        y = e.getY();
    } 
```

这是假设您使用 java.util.

# c# - wince 6.0 c#中的全屏应用程序

> ID：10788957
> 
> 赞同：8
> 
> 时间：2012-05-28T18:26:45.480
> 
> 标签：c#, visual-studio-2008, windows-mobile, windows-ce, fullscreen

我有我的应用程序，想让它在全屏模式下运行，没有任务栏。我发现了如何隐藏窗口栏，但是当我启动我的应用程序时，它并没有覆盖窗口任务栏的空间，尽管最后一个是隐藏的。

[我找到了这个](https://stackoverflow.com/questions/505167/how-do-i-make-a-winforms-app-go-full-screen)，但它没有用。我找不到关于畏缩的例子。我有*FormBorderStyle = None*，并且*WindowsState = Maximized*

**解决方案：**

我找到了一种方法。一个重要的提示是让***WindowState = Normal***（我花了一些时间才发现这个问题）。如果你有*WindowState = Maximized*，则无法将窗体的高度设置为最大显示高度。

我写了这段代码来探测它，它工作正常。是一个有两个按钮的表单：button1（全屏）和 button2（恢复默认屏幕）

```
 public partial class Form1 : Form
    {
        public Form1(){
               InitializeComponent();            
        }

    [DllImport("Coredll")]
    internal static extern IntPtr FindWindow(String lpClassName, String lpWindowName);

    [DllImport("coredll.dll")]
    internal static extern bool EnableWindow(IntPtr hwnd, Boolean bEnable);

    [DllImport("coredll.dll")]
    private static extern bool MoveWindow(IntPtr hWnd, int x, int y, int cx, int cy, bool repaint);

    public static bool EnableTaskBar(Boolean enable)
    {
        IntPtr hwnd;
        hwnd = FindWindow("HHTaskBar", "");

        if (enable) SetHHTaskBar();
        else HideHHTaskBar();

        return EnableWindow(hwnd, enable);
    }

    public static void HideHHTaskBar()
    {
        IntPtr iptrTB = FindWindow("HHTaskBar", null);
        MoveWindow(iptrTB, 0, Screen.PrimaryScreen.Bounds.Height,
        Screen.PrimaryScreen.Bounds.Width, 26, true);
    }

    public static void SetHHTaskBar()
    {
        IntPtr iptrTB = FindWindow("HHTaskBar", null);
        MoveWindow(iptrTB, 0, 294,
        Screen.PrimaryScreen.Bounds.Width, 26, true);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        EnableTaskBar(false);
        this.Width = Screen.PrimaryScreen.Bounds.Width;
        this.Height = Screen.PrimaryScreen.Bounds.Height;
        this.Left = 0;
        this.Top = 0;
    }

    private void button2_Click(object sender, EventArgs e)
    {
        EnableTaskBar(true);
    }
} 
```

希望它可以帮助其他有同样问题的人！

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:15:30.060

隐藏任务栏后，明确设置表单的大小和位置：

```
myForm.Width = Screen.PrimaryScreen.Bounds.Width;
myForm.Height = Screen.PrimaryScreen.Bounds.Height;
myForm.Left = 0;
myForm.Top = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:49:07.247

我总是在需要时使用[SHFullScreen](http://msdn.microsoft.com/en-us/library/ee499392%28v=winembedded.60%29.aspx)来实现这一点。您将需要使用[PInvoke](http://pinvoke.net/default.aspx/aygshell.SHFullScreen)来调用它。

# objective-c - runAction 没有移动我的船

> ID：10788961
> 
> 赞同：1
> 
> 时间：2012-05-28T18:27:00.467
> 
> 标签：objective-c, ios, cocos2d-iphone

我的船出现在图层上。当按下发射按钮时，船应该移动到计算好的位置。检测到触摸，坐标计算正确，但船不会移动。我已经阅读了这个论坛上关于 runAction 的 500 多个 Q 和 A，但没有任何帮助。我还重新启动了 Xcode 并清理了目标。

ShipManager 的界面如下：

```
#import <Foundation/Foundation.h>
#import "Common.h"//imports cocos2d.h

@interface ShipManager : NSObject {
    GameLayer *layer;
    CCSprite *ship;
    ...
    NSArray *shipTargetArray;
    CCArray *shipArray;
    int podValue;
    int podKey;
    int topPod;
    int botPod;
    float x;
    float y;    
}

@property (nonatomic, retain) CCSprite *ship;
@property (nonatomic, retain) CCSprite *pod;
...

-(id)initWith:(GameLayer *)gameLayer;
-(void)updateShip;
-(void)resetShip;
-(void)touchedExtinguishButton;    
@end 
```

部分实现文件：

```
#import "ShipManager.h"
#import "PodGroupManager.h"
#import "GameLayer.h"   

@implementation ShipManager

@synthesize ship;
...

int loadState;

//LAUNCH SHIP
-(void)launchShip {
    NSNumber *theTarget;
    CGPoint targetPosition;
    int shipTarget = absInt(topPod * botPod);

    theTarget = [NSNumber numberWithInt:shipTarget];
    NSInteger targetIndex = [shipTargetArray indexOfObject:theTarget];
    NSLog(@"target = %i; index = %i",shipTarget,targetIndex);//LOG:target = 20; index = 12

    self.ship = [shipArray objectAtIndex:0];//NEW CODE. 
    NSLog(@"ship tag = %i",ship.tag);//LOG:ship tag = 100
    NSLog(@"%@",shipArray);//LOG" <CCArray = 055209A0> = ( <CCSprite = 05520A40 | Rect = (2.00,2.00,148.00,200.00) | tag = 100 | atlasIndex = 10>, )

    x = ship.position.x;
    y = ship.position.y + 10 +34 * targetIndex;

    targetPosition = ccp(x,y);
    NSLog(@"target x = %f; y = %f",x, y);//LOG: target x = 384.000000; y = 754.000000

    //WHAT I WANT THE SHIP TO DO
    id action = [CCSequence actions:
              [CCMoveTo actionWithDuration:1.0f position:targetPosition],
              [CCDelayTime actionWithDuration:1.0f],
              [CCMoveTo actionWithDuration:.05f position:SHIP_START_POS],
              nil];
    [ship runAction:action];//SHIP DOES NOT MOVE*/
    //ALSO TRIED: [self.ship runAction:action]; NO MOVEMENT

    //ABOVE NOT WORKING -- TRYING SIMPLER MOVE
    //CCMoveTo* move = [CCMoveTo actionWithDuration:1.0f position:targetPosition];
    //[ship runAction:move]; //TRYING SIMPLER ACTION - STILL NO MOVEMENT

    //JUST TRYING TO GET THE SHIP THERE
    //ship.position = targetPosition; //NO MOVEMENT EITHER

    if (missionState == SHIP_EXT) {
        NSLog(@"extinguish fuse");//logs button press correctly
    }       
}
...
//RESET SHIP TO LAUNCHING PAD
-(void)resetShip {
    ship.position = SHIP_START_POS;
    [self setShipState:SHIP_EMPTY];
    [self setMissionState:SHIP_IDLE];
    ship.visible = YES;
}

//SETUP SHIP
-(void) setupShip {
    shipArray  = [[CCArray alloc]initWithCapacity:1];//just added - latest attempt
    ship = [CCSprite spriteWithSpriteFrameName:@"ship.png"];

    [layer.batchNode addChild:ship z:SHIP_Z tag:SHIP_TAG];
    [shipArray addObject:ship];//just added - latest attempt
    [self resetShip];       
}
...
//INITIALIZE SHIPMANAGER
-(id)initWith:(GameLayer *)gameLayer {
    if ((self = [super init]) ) {
        layer = gameLayer;
        [self setupShip];
        ...         
        [self setTopPod:0];
        [self setBotPod:0];

        //MAKE SHIPTARGET ARRAY
        shipTargetArray = [[NSArray alloc] initWithObjects:
                           [NSNumber numberWithInt:1],
                           ...
                           [NSNumber numberWithInt:25],
                           nil];
    }    
    return self;
}

-(void) dealloc {

    [shipTargetArray release];
    [shipArray release];
    self.ship = nil;

    [super dealloc];
}    
@end 
```

我知道 launchShip 方法正在执行，因为所有 NSLog 都按预期打印并且结果是正确的。我在 launchShip 中尝试了 3 个不同的选项，我依次评论/取消评论它们以查看是否有任何工作 - 没有。
我是 Objective-c 和 cocos2d 的新手，我怀疑问题是我试图告诉 runAction 运行操作的方式。我确信有一种方法可以正确发送消息，任何有关正确方法的帮助将不胜感激。
提前感谢您的帮助。

在下水之前，将 2 个燃料舱装载到船上。燃料舱具有数值。这些值决定了船舶的目标目的地。所有这些都在起作用。装载燃料舱并计算正确的目的地。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:54:39.800

```
ship = [shipArray objectAtIndex:0]; 
```

此分配将不保留。将其更改为

```
self.ship = [shipArray objectAtIndex:0]; 
```

稍后在 dealloc 方法中执行

```
self.ship = nil; 
```

释放它。对其他变量 ( `shipTargetArray` `shipArray`) 进行相同处理。

# http - 在 vbscript 中测试 HTTP 响应

> ID：10788963
> 
> 赞同：1
> 
> 时间：2012-05-28T18:27:19.407
> 
> 标签：http, vbscript, timeout

我需要测试来自 web url 的响应时间，看看它是否响应缓慢。我从一个教程网站上得到了这个（不记得是哪个），但它并没有完全符合我的要求：

```
On Error Resume Next 
Set XMLHttp = CreateObject("MSXML2.ServerXMLHTTP") 
xmlhttp.open "GET", "http://website.url.com" , 0 
xmlhttp.send "" 
If Err.Number < 0 OR Err.Number > 0 Then 
  Dim objShell
  Set objShell = WScript.CreateObject ("WScript.shell")
  MsgBox "TimeOut"
  Set objShell = Nothing
  WScript.Quit 
Else
  MsgBox "OK"
End If 

Set xmlhttp = Nothing 
```

此脚本仅测试站点是否超时。我需要更详细的信息，例如即使它没有超时，响应时间有多长等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T13:55:06.497

好的，我找到了解决方案：

```
Dim strHost

' Put your server here
strHost = "localhost"

if Ping(strHost) = True then
    Wscript.Echo "Host " & strHost & " contacted"
Else
    Wscript.Echo "Host " & strHost & " could not be contacted"
end if

Function Ping(strHost)

    dim objPing, objRetStatus

    set objPing = GetObject("winmgmts:{impersonationLevel=impersonate}").ExecQuery _
      ("select * from Win32_PingStatus where address = '" & strHost & "'")

    for each objRetStatus in objPing
        if IsNull(objRetStatus.StatusCode) or objRetStatus.StatusCode<>0 then
        Ping = False
            'WScript.Echo "Status code is " & objRetStatus.StatusCode
        else
            Ping = True
            'Wscript.Echo "Bytes = " & vbTab & objRetStatus.BufferSize
            Wscript.Echo "Time (ms) = " & vbTab & objRetStatus.ResponseTime
            'Wscript.Echo "TTL (s) = " & vbTab & objRetStatus.ResponseTimeToLive
        end if
    next
End Function 
```

所有学分都转到这个网站，它的作者： http: [//www.windowsitpro.com/article/vbscript/how-can-i-use-a-vbscript-script-to-ping-a-machine-](http://www.windowsitpro.com/article/vbscript/how-can-i-use-a-vbscript-script-to-ping-a-machine-)

# java - 有没有办法在 Android 中找到完整大小的 HTTP 请求和响应（用于数据使用跟踪）？

> ID：10788971
> 
> 赞同：5
> 
> 时间：2012-05-28T18:27:38.533
> 
> 标签：java, android, http, httprequest, httpresponse

我想跟踪我的应用程序的数据使用情况，但要做到这一点，我需要能够获得一个`HttpUriRequest`和的完整大小`HttpResponse`。仅仅获取大小`HttpEntity`是不够的，因为请求和响应都有更多的数据正在传输（标头、参数、正在传输的实际 URL 等）。那么，有没有办法找到双向传输的全部数据量？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T20:03:03.423

如果您只需要“之后”的指标，您可以提供您自己的合适`ClientConnectionManager`实现的子类，并`HttpConnectionMetrics`在请求返回给管理器后获取相关信息。

作为一个简单的（和轻微的 sh*tty）示例， subclass `SingleClientConnManager`，如下所示：

```
class MeasuringClientConnManager extends SingleClientConnManager {
    private long mReceivedBytes = -1;
    private long mSentBytes = -1;
    public MeasuringClientConnManager(HttpParams params, SchemeRegistry schreg) {
        super(params, schreg);
    }
    @Override
    public void releaseConnection(ManagedClientConnection conn,
            long validDuration, TimeUnit timeUnit) {
        HttpConnectionMetrics metrics = conn.getMetrics();
        mReceivedBytes = metrics.getReceivedBytesCount();
        mSentBytes = metrics.getSentBytesCount();
        metrics.reset();
        super.releaseConnection(conn, validDuration, timeUnit);
    }

    public long getReceivedBytes() {
        return mReceivedBytes;
    }
    public long getSentBytes() {
        return mSentBytes;
    }
} 
```

然后像这样把它塞进你的 HTTP 客户端：

```
BasicHttpParams params = new BasicHttpParams();
SchemeRegistry schreg = new SchemeRegistry();
schreg.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
// Add SSL here if you need it
MeasuringClientConnManager conman = new MeasuringClientConnManager(params, schreg);
DefaultHttpClient client = new DefaultHttpClient(conman, params);
client.execute(new HttpGet("http://www.google.com"));
System.out.println(conman.getSentBytes());
System.out.println(conman.getReceivedBytes()); 
```

**编辑**：使用记录会话输入和输出缓冲区以及损坏的线路日志+添加侦听器接口的替代示例。

```
class MeasuringClientConnManager extends SingleClientConnManager {

    interface WireListener {
        void onUpdate(long sent, long recv);
    }
    private WireListener mListener;
    private long mReceivedBytes = -1;
    private long mSentBytes = -1;
    private Wire mWire = new Wire(null) {
        public boolean enabled() { return true; };
        // Time to override a bunch of methods (otherwise Wire will crash)
        public void input(byte[] b) throws IOException {mReceivedBytes += b.length; rxtx();};
        public void input(byte[] b, int off, int len) throws IOException {mReceivedBytes += len; rxtx();}
        public void input(InputStream instream) throws IOException {mReceivedBytes += count(instream); rxtx();}
        public void input(String s) throws IOException {mReceivedBytes += s.length(); rxtx();};
        public void input(int b) throws IOException {mReceivedBytes++; rxtx();}
        public void output(byte[] b) throws IOException {mSentBytes += b.length; rxtx();}
        public void output(byte[] b, int off, int len) throws IOException {mSentBytes += len; rxtx();}
        public void output(int b) throws IOException {mSentBytes++; rxtx();}
        public void output(String s) throws IOException {mSentBytes += s.length(); rxtx();}
        public void output(InputStream outstream) throws IOException {mSentBytes += count(outstream); rxtx();};

        private int count(InputStream is) throws IOException {
            int result = 0;
            byte[] b = new byte[1024 * 8];
            int count;
            while ((count = is.read(b)) > -1) {
                result += count;
            }
            return result;
        }
    };

    public MeasuringClientConnManager(HttpParams params, SchemeRegistry schreg) {
        super(params, schreg);
    }

    public void setWireListener(WireListener wl) {
        mListener = wl;
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected ClientConnectionOperator createConnectionOperator(
            SchemeRegistry schreg) {
        final ClientConnectionOperator actual = super.createConnectionOperator(schreg);
        ClientConnectionOperator wired = new ClientConnectionOperator() {
            @Override
            public void updateSecureConnection(OperatedClientConnection conn,
                    HttpHost target, HttpContext context, HttpParams params)
                    throws IOException {
                actual.updateSecureConnection(conn, target, context, params);
            }
            @Override
            public void openConnection(OperatedClientConnection conn, HttpHost target,
                    InetAddress local, HttpContext context, HttpParams params)
                    throws IOException {
                actual.openConnection(conn, target, local, context, params);
            }

            @Override
            public OperatedClientConnection createConnection() {
                DefaultClientConnection conn = new DefaultClientConnection() {
                    @Override
                    protected SessionInputBuffer createSessionInputBuffer(
                            Socket socket, int buffersize, HttpParams params)
                            throws IOException {
                        return new LoggingSessionInputBuffer(super.createSessionInputBuffer(socket, buffersize, params), mWire);
                    }
                    @Override
                    protected SessionOutputBuffer createSessionOutputBuffer(
                            Socket socket, int buffersize, HttpParams params)
                            throws IOException {
                        return new LoggingSessionOutputBuffer(super.createSessionOutputBuffer(socket, buffersize, params), mWire);
                    }
                };
                return conn;
            }
        };
        return wired;
    }

    void rxtx() {
        WireListener l = mListener;
        if (l != null) {
            l.onUpdate(mSentBytes, mReceivedBytes);
        }
    }
} 
```

用法非常相似，但现在随着东西的发送而进行有线更新：

```
BasicHttpParams params = new BasicHttpParams();
SchemeRegistry schreg = new SchemeRegistry();
schreg.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
// Add SSL here if you need it
MeasuringClientConnManager conman = new MeasuringClientConnManager(params, schreg);
conman.setWireListener(new MeasuringClientConnManager.WireListener() {
    @Override
    public void onUpdate(long sent, long recv) {
        System.out.println("WIRE sent: " + sent + ", recv: " + recv);
    }
});
DefaultHttpClient client = new DefaultHttpClient(conman, params);
client.execute(new HttpGet("http://www.thirdbase.se")); 
```

# c# - Matchcollection Parallel.Foreach

> ID：10788972
> 
> 赞同：4
> 
> 时间：2012-05-28T18:27:38.683
> 
> 标签：c#, multithreading, parallel-processing

我正在尝试为 matchcollection 创建一个 Parallel.Foreach 循环。它在我建造的刮刀中。我只需要知道在 Parallel.Foreach 中放什么

```
MatchCollection m = Regex.Matches(htmlcon, matchlink, RegexOptions.Singleline);

                Parallel.ForEach(WHAT DO I PUT HERE? =>
                {

                        Get(match.Groups[1].Value, false);
                        Match fname = Regex.Match(htmlcon, @"<span class=""given-name"(.*?)</span>", RegexOptions.Singleline);
                        Match lname = Regex.Match(htmlcon, @"span class=""family-name"">(.*?)</span>", RegexOptions.Singleline);

                        firstname = fname.Groups[1].Value;
                        lastname = lname.Groups[1].Value;

                        sw.WriteLine(firstname + "," + lastname);
                        sw.Flush();

                }): 
```

我试过了：

```
Parallel.ForEach<MatchCollection>(m,match  => 
```

但没有运气！

提前致谢！:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-28T18:39:01.137

那是因为`Parallel.ForEach`期待一个通用的`IEnumerable`并且`MatchCollection`只实现非通用的。

尝试这个：

```
Parallel.ForEach(
    m.OfType<Match>(),
    (match) =>
    {
    ); 
```

# java - 如何从 python 调用运行 jar，同时要求它使用 SDK 1.7 运行？

> ID：10788974
> 
> 赞同：0
> 
> 时间：2012-05-28T18:27:40.330
> 
> 标签：java, python, sdk, jar, batch-file

我想用创建这些参数的python代码包装一个获取许多参数的jar。

说我有：

```
java -jar parameter1 ... paramterN 
```

其中 N 不是那么大，但是当可以自动分配这些参数时，用户一次又一次地填充它是一种负担。

jar 是一个黑盒子，因此我无法更改其逻辑来计算这些参数本身。

所以，相反，我想要这个：

```
python MyJarRunner.py JarPath 
```

当 MyJarRunner 将使用计算的参数调用此 Jar 时。

我的问题是这个 Jar 需要 Java SDK 1.7 才能在没有运行时错误的情况下运行。如果存在，我如何确定我将使用 SDK 1.7 运行这个 Jar？这需要在不了解 SDK 1.7 位置的不同计算机上运行。

带有批处理脚本的解决方案也可能适用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:32:43.917

而不是使用 java 命令，使用`"C:\Program Files\Java\jdk1.7.0\bin\java.exe" -jar ...`

检查文件是否确实存在...

```
from os import path, access, R_OK  # W_OK for write permission.
PATH='C:\Program Files\Java\jdk1.7.0\'
if path.exists(PATH) and path.isfile(PATH) and access(PATH, R_OK):
    //execute
else:
    //whatever you wanna do if it doesn't exist 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:17:10.117

有两种解决方案：

两者都假设您可以编写自己的主类。

1.  Jar 绝不是一个黑盒子——它基本上是一个 zip 文件，所以你可以解压缩它，添加你自己的计算参数的主类，更改 MANIFEST.MF 中的 Main-Class 属性，你就完成了。
2.  考虑其他部署替代方案，例如 java webstart，它允许您下载几个 jar（不仅是黑盒 jar，还包括您编写的其他 jar）指定 JDK 版本和其他内容。

# java - 如何输出要在 Spring-Roo MVC list.jspx 视图中呈现的 HTML？

> ID：10788975
> 
> 赞同：2
> 
> 时间：2012-05-28T18:27:41.490
> 
> 标签：java, spring, model-view-controller, spring-roo

我想使用 Spring Roo 显示链接列表。我有一个模型类及其相应的列表视图，我想用它显示与其 URL 链接的文本描述字段。

问题是 Spring Roo 转义了我的文本并打印出来

这是模型类

```
@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class RooListItem {
    private String description;
    private String uri;

    @ManyToOne
    private RooList rooList;

    public String getHtmlView() {
        return "<a href=\""+uri+"\">"+description+"</a>";
    }
} 
```

以及 list.jspx 视图中的相应片段

```
<table:table data="${roolistitems}" id="l_my_package_model_RooListItem" path="/roolistitems" z="nDXBSp5nQX1Z210Pn2j84U/3Yz0=">
    <table:column id="c_my_package_model_RooListItem_htmlView" property="htmlView" z="user-managed"/>
    <table:column id="c_my_package_model_RooListItem_rooList" property="rooList" z="KzSXHmY6K+B7FkMvafSA5JiwKW0="/>

</table:table> 
```

我正在使用带有 Jetty 的 Spring Roo 1.2.1。感谢您的任何想法！

# python - 如何正确地从具有 __new__ 方法的超类继承？

> ID：10788976
> 
> 赞同：15
> 
> 时间：2012-05-28T18:27:59.987
> 
> 标签：python, inheritance

假设我们有一个类 'Parent' ，由于某种原因已经`__new__`定义了一个类 'Child' 从它继承。（在我的情况下，我试图从我无法修改的第 3 方类继承）

```
class Parent:
    def __new__(cls, arg):
        # ... something important is done here with arg 
```

我的尝试是：

```
class Child(Parent):
    def __init__(self, myArg, argForSuperclass):
         Parent.__new__(argForSuperclass)
         self.field = myArg 
```

但是虽然

```
p = Parent("argForSuperclass") 
```

按预期工作

```
c = Child("myArg", "argForSuperclass") 
```

失败，因为 'Child' 试图调用`__new__`它从 'Parent' 继承的方法而不是它自己的`__init__`方法。

我必须在“孩子”中进行哪些更改才能获得预期的行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-28T19:03:05.697

首先，不认为最好的做法是`__new__`完全覆盖以避免这些问题......但这不是你的错，我知道。对于这种情况，覆盖的最佳实践`__new__`是让它接受可选参数......

```
class Parent(object):
    def __new__(cls, value, *args, **kwargs):
        print 'my value is', value
        return object.__new__(cls, *args, **kwargs) 
```

...所以孩子们可以收到他们自己的：

```
class Child(Parent):
    def __init__(self, for_parent, my_stuff):
        self.my_stuff = my_stuff 
```

然后，它会起作用：

```
>>> c = Child(2, "Child name is Juju")
my value is 2
>>> c.my_stuff
'Child name is Juju' 
```

但是，您的父类的作者并不那么明智，并给了您这个问题：

```
class Parent(object):
    def __new__(cls, value):
        print 'my value is', value
        return object.__new__(cls) 
```

在这种情况下，只需覆盖`__new__`孩子，使其接受可选参数，并在`__new__`那里调用父母：

```
class Child(Parent):
    def __new__(cls, value, *args, **kwargs):
        return Parent.__new__(cls, value)
    def __init__(self, for_parent, my_stuff):
        self.my_stuff = my_stuff 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T22:14:18.380

Child 不调用 Parent's`__new__`而不是自己的，而是*在 before 之前*`__init__`调用它自己的`__new__`（继承自 Parent）。 *`__init__`*

 *您需要了解这些方法的用途以及 Python 何时调用它们。`__new__`被调用来产生一个实例对象，然后`__init__`被调用来初始化那个实例的属性。Python 会将相同的参数传递给这两种方法：传递给类以开始该过程的参数。

所以当你从一个类继承时你`__new__`所做的正是你在继承任何其他方法时所做的，这些方法在父级中具有与你想要的不同的签名。您需要重写`__new__`以接收 Child 的参数并`Parent.__new__`使用它期望的参数进行调用。然后您完全单独覆盖`__init__`（尽管使用相同的参数列表，并且同样需要`__init__`使用自己的预期参数列表调用 Parent ）。

但是，有两个潜在的困难可能会妨碍您，因为`__new__`是自定义获取新实例的过程。它没有理由必须实际创建一个**新**实例（它可以找到一个已经存在的实例），实际上它甚至不必返回该类的实例。这可能导致以下问题：

1.  如果`__new__`返回一个现有对象（例如，因为 Parent 期望能够缓存它的实例），那么你可能会发现你的`__init__`在已经存在的对象上调用，如果您的对象应该具有可变状态，这可能会非常糟糕。但是，如果 Parent 期望能够做这种事情，它可能会期望对它的使用方式有一堆约束，并以任意打破这些约束的方式对其进行子类化（例如，将可变状态添加到一个类期望是不可变的，因此它可以缓存和回收其实例）几乎肯定不会工作，即使您可以正确初始化您的对象。如果这种事情正在发生，并且没有任何文档告诉您应该如何对 Parent 进行子类化，那么第三方可能并不打算让您成为 Parent 的子类，事情将会很困难为你。`__new__`而不是`__init__`，丑陋的。

2.  如果类的方法实际上返回了该类的一个实例，Python*才会*调用该方法。如果 Parent 使用它的方法作为某种“工厂函数”来返回其他类的对象，那么以简单的方式进行子类化很可能会失败，除非您需要做的就是改变“工厂”的工作方式。`__init__``__new__``__new__`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:51:53.133

据我了解，当您致电时`Child("myarg", "otherarg")`，这实际上意味着这样的事情：

```
c = Child.__new__(Child, "myarg", "otherarg")
if isinstance(c, Child):
    c.__init__("myarg", "otherarg") 
```

你可以：

1.  编写一个替代构造函数，如，它在执行任何其他需要之前进行`Child.create_with_extra_arg("myarg", "otherarg")`实例化。`Child("otherarg")`

2.  覆盖`Child.__new__`，像这样：

.

```
def __new__(cls, myarg, argforsuperclass):
    c = Parent.__new__(cls, argforsuperclass)
    c.field = myarg
    return c 
```

我没有测试过。覆盖`__new__`很快就会让人感到困惑，所以如果可能的话最好避免它。*

# ruby-on-rails - has_many through in rails - 保存和检索数据

> ID：10788979
> 
> 赞同：1
> 
> 时间：2012-05-28T18:28:10.687
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, has-many-through

我正在尝试为我的类创建一个 has_many :through 关系，但对如何实际实现相关数据的保存和检索感到困惑。

我有一个食谱类、成分类和数量类，它们是关联的 :through 。这是我现在的课程：

```
#models/recipe.rb
class Recipe < ActiveRecord::Base
  has_many :amounts
  has_many :ingredients, :through => :amounts
end

#models/ingredient.rb
class Ingredient < ActiveRecord::Base
  has_many :amounts
  has_many :recipes, :through => :amounts
end

#models/amounts.rb
class Amounts < ActiveRecord::Base
  belongs_to :recipes
  belongs_to :ingredients
end 
```

此外，这里是创建食谱的基本形式的要点的链接：[https ://gist.github.com/2820455](https://gist.github.com/2820455)

以及创建代码本身的要点： [https ://gist.github.com/2820294](https://gist.github.com/2820294)

当我提交表单时，我收到此错误：

`uninitialized constant Recipe::Amount`

这个应用程序跟踪：

`app/controllers/recipes_controller.rb:57:in 'block in create' app/controllers/recipes_controller.rb:56:in 'create'`

我对 Ruby on Rails 非常陌生，实现这种关系并将 Amounts 值插入表中让我难以置信......！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:17:46.770

belongs_to 需要是单数，在你的 amount.rb 中将其更改为如下所示：-

# 模型/数量.rb

```
class Amounts < ActiveRecord::Base
  belongs_to :recipe
  belongs_to :ingredient
end 
```

# jquery - JsTree 和 JSON - 从 url 中提取数据

> ID：10788981
> 
> 赞同：0
> 
> 时间：2012-05-28T18:28:28.193
> 
> 标签：jquery, json, jstree

我有一个带有 JStree 的网站。它从 JSON 对象中提取数据。当您单击 JsTree 节点时，它会加载相应的 DB 数据，这些数据会转换为 JSON，然后显示。

问题是，现在我们想要拥有与页面上发生的事情相对应的 URL。因为一切都发生在 AJAX 中，所以 URL 保持不变。

因此，当有人点击类别 Wordpress-> 商业 -> 财务时，如果 URL 可以更改为 www.domain.com/wordpress/business/financial 并从 URL< 中提取参数以获取基于这些参数的适当的数据库数据。

这可能吗？是否可以在不重新加载页面的情况下做到这一点？如中，只需更新地址栏，JQuery 就可以获取参数并获取相应的数据吗？

我知道这是一个广泛的问题，但我什至不确定从哪里开始

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T05:07:49.637

我认为您也想调整 url 函数以与父节点一起使用。下面的代码会给你一个想法如何解决你的问题。归功于@Christian Waidner - [https://stackoverflow.com/a/8094199/250422](https://stackoverflow.com/a/8094199/250422)

我还没有测试代码...

```
 "ajax" : {
            "type": 'GET',
            "url": function (node) {
                var nodeId = "";
                var url = "http://www.domain.com/wordpress/";
                if (node != -1){
                    nodeName = node.attr('name');

                    url = url + nodeName;
                }

                return url;
            },
            "success": function (new_data) {
                return new_data;
            } 
```

# c# - 是否有任何与 Process.Start 等效的异步？

> ID：10788982
> 
> 赞同：161
> 
> 时间：2012-05-28T18:28:41.083
> 
> 标签：c#, async-await, c#-5.0

就像标题所暗示的那样，`Process.Start`我可以等待（允许您运行另一个应用程序或批处理文件）吗？

我正在玩一个小型控制台应用程序，这似乎是使用 async 和 await 的理想场所，但我找不到这种情况的任何文档。

我在想的是这些方面的东西：

```
void async RunCommand()
{
    var result = await Process.RunAsync("command to run");
} 
```

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2012-05-28T18:50:32.017

`Process.Start()`只开始这个过程，它不会等到它完成，所以它没有多大意义`async`。如果你仍然想这样做，你可以做类似的事情`await Task.Run(() => Process.Start(fileName))`。

但是，如果您想异步等待进程完成，您可以[将`Exited`事件](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited)与[`TaskCompletionSource`](http://msdn.microsoft.com/en-us/library/dd449174.aspx)：

```
static Task<int> RunProcessAsync(string fileName)
{
    var tcs = new TaskCompletionSource<int>();

    var process = new Process
    {
        StartInfo = { FileName = fileName },
        EnableRaisingEvents = true
    };

    process.Exited += (sender, args) =>
    {
        tcs.SetResult(process.ExitCode);
        process.Dispose();
    };

    process.Start();

    return tcs.Task;
} 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2015-07-18T14:38:34.883

这是我的看法，基于[svick 的回答](https://stackoverflow.com/a/10789196/67824)。它添加了输出重定向、退出代码保留和稍微更好的错误处理（`Process`即使对象无法启动也可以处理）：

```
public static async Task<int> RunProcessAsync(string fileName, string args)
{
    using (var process = new Process
    {
        StartInfo =
        {
            FileName = fileName, Arguments = args,
            UseShellExecute = false, CreateNoWindow = true,
            RedirectStandardOutput = true, RedirectStandardError = true
        },
        EnableRaisingEvents = true
    })
    {
        return await RunProcessAsync(process).ConfigureAwait(false);
    }
}    
private static Task<int> RunProcessAsync(Process process)
{
    var tcs = new TaskCompletionSource<int>();

    process.Exited += (s, ea) => tcs.SetResult(process.ExitCode);
    process.OutputDataReceived += (s, ea) => Console.WriteLine(ea.Data);
    process.ErrorDataReceived += (s, ea) => Console.WriteLine("ERR: " + ea.Data);

    bool started = process.Start();
    if (!started)
    {
        //you may allow for the process to be re-used (started = false) 
        //but I'm not sure about the guarantees of the Exited event in such a case
        throw new InvalidOperationException("Could not start process: " + process);
    }

    process.BeginOutputReadLine();
    process.BeginErrorReadLine();

    return tcs.Task;
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2021-01-20T06:48:27.483

在.Net 5.0 中，官方内置了[WaitForExitAsync](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.waitforexitasync?view=net-5.0)方法，因此您不必自己实现。此外，[Start](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.start?view=net-5.0#System_Diagnostics_Process_Start_System_String_System_Collections_Generic_IEnumerable_System_String__)方法现在接受参数 as `IEnumerable<string>`（类似于 Python/Golang 等其他编程语言）。

这是一个例子：

```
public static async Task YourMethod() {
    var p = Process.Start("bin_name", new[]{"arg1", "arg2", "arg3"});
    await p.WaitForExitAsync().ConfigureAwait(false);
    // more code;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-11T14:18:11.053

我已经建立了一个类来启动一个流程，并且由于各种需求，它在过去几年中不断增长。在使用过程中，我发现 Process 类在处理甚至读取 ExitCode 方面存在一些问题。所以这一切都是由我的班级解决的。

该类有多种可能性，例如读取输出，以管理员或其他用户身份启动，捕获异常并启动所有这些异步，包括。消除。很好的是，在执行期间也可以读取输出。

```
public class ProcessSettings
{
    public string FileName { get; set; }
    public string Arguments { get; set; } = "";
    public string WorkingDirectory { get; set; } = "";
    public string InputText { get; set; } = null;
    public int Timeout_milliseconds { get; set; } = -1;
    public bool ReadOutput { get; set; }
    public bool ShowWindow { get; set; }
    public bool KeepWindowOpen { get; set; }
    public bool StartAsAdministrator { get; set; }
    public string StartAsUsername { get; set; }
    public string StartAsUsername_Password { get; set; }
    public string StartAsUsername_Domain { get; set; }
    public bool DontReadExitCode { get; set; }
    public bool ThrowExceptions { get; set; }
    public CancellationToken CancellationToken { get; set; }
}

public class ProcessOutputReader   // Optional, to get the output while executing instead only as result at the end
{
    public event TextEventHandler OutputChanged;
    public event TextEventHandler OutputErrorChanged;
    public void UpdateOutput(string text)
    {
        OutputChanged?.Invoke(this, new TextEventArgs(text));
    }
    public void UpdateOutputError(string text)
    {
        OutputErrorChanged?.Invoke(this, new TextEventArgs(text));
    }
    public delegate void TextEventHandler(object sender, TextEventArgs e);
    public class TextEventArgs : EventArgs
    {
        public string Text { get; }
        public TextEventArgs(string text) { Text = text; }
    }
}

public class ProcessResult
{
    public string Output { get; set; }
    public string OutputError { get; set; }
    public int ExitCode { get; set; }
    public bool WasCancelled { get; set; }
    public bool WasSuccessful { get; set; }
}

public class ProcessStarter
{
    public ProcessResult Execute(ProcessSettings settings, ProcessOutputReader outputReader = null)
    {
        return Task.Run(() => ExecuteAsync(settings, outputReader)).GetAwaiter().GetResult();
    }

    public async Task<ProcessResult> ExecuteAsync(ProcessSettings settings, ProcessOutputReader outputReader = null)
    {
        if (settings.FileName == null) throw new ArgumentNullException(nameof(ProcessSettings.FileName));
        if (settings.Arguments == null) throw new ArgumentNullException(nameof(ProcessSettings.Arguments));

        var cmdSwitches = "/Q " + (settings.KeepWindowOpen ? "/K" : "/C");

        var arguments = $"{cmdSwitches} {settings.FileName} {settings.Arguments}";
        var startInfo = new ProcessStartInfo("cmd", arguments)
        {
            UseShellExecute = false,
            RedirectStandardOutput = settings.ReadOutput,
            RedirectStandardError = settings.ReadOutput,
            RedirectStandardInput = settings.InputText != null,
            CreateNoWindow = !(settings.ShowWindow || settings.KeepWindowOpen),
        };
        if (!string.IsNullOrWhiteSpace(settings.StartAsUsername))
        {
            if (string.IsNullOrWhiteSpace(settings.StartAsUsername_Password))
                throw new ArgumentNullException(nameof(ProcessSettings.StartAsUsername_Password));
            if (string.IsNullOrWhiteSpace(settings.StartAsUsername_Domain))
                throw new ArgumentNullException(nameof(ProcessSettings.StartAsUsername_Domain));
            if (string.IsNullOrWhiteSpace(settings.WorkingDirectory))
                settings.WorkingDirectory = Path.GetPathRoot(Path.GetTempPath());

            startInfo.UserName = settings.StartAsUsername;
            startInfo.PasswordInClearText = settings.StartAsUsername_Password;
            startInfo.Domain = settings.StartAsUsername_Domain;
        }
        var output = new StringBuilder();
        var error = new StringBuilder();
        if (!settings.ReadOutput)
        {
            output.AppendLine($"Enable {nameof(ProcessSettings.ReadOutput)} to get Output");
        }
        if (settings.StartAsAdministrator)
        {
            startInfo.Verb = "runas";
            startInfo.UseShellExecute = true;  // Verb="runas" only possible with ShellExecute=true.
            startInfo.RedirectStandardOutput = startInfo.RedirectStandardError = startInfo.RedirectStandardInput = false;
            output.AppendLine("Output couldn't be read when started as Administrator");
        }
        if (!string.IsNullOrWhiteSpace(settings.WorkingDirectory))
        {
            startInfo.WorkingDirectory = settings.WorkingDirectory;
        }
        var result = new ProcessResult();
        var taskCompletionSourceProcess = new TaskCompletionSource<bool>();

        var process = new Process { StartInfo = startInfo, EnableRaisingEvents = true };
        try
        {
            process.OutputDataReceived += (sender, e) =>
            {
                if (e?.Data != null)
                {
                    output.AppendLine(e.Data);
                    outputReader?.UpdateOutput(e.Data);
                }
            };
            process.ErrorDataReceived += (sender, e) =>
            {
                if (e?.Data != null)
                {
                    error.AppendLine(e.Data);
                    outputReader?.UpdateOutputError(e.Data);
                }
            };
            process.Exited += (sender, e) =>
            {
                try { (sender as Process)?.WaitForExit(); } catch (InvalidOperationException) { }
                taskCompletionSourceProcess.TrySetResult(false);
            };

            var success = false;
            try
            {
                process.Start();
                success = true;
            }
            catch (System.ComponentModel.Win32Exception ex)
            {
                if (ex.NativeErrorCode == 1223)
                {
                    error.AppendLine("AdminRights request Cancelled by User!! " + ex);
                    if (settings.ThrowExceptions) taskCompletionSourceProcess.SetException(ex); else taskCompletionSourceProcess.TrySetResult(false);
                }
                else
                {
                    error.AppendLine("Win32Exception thrown: " + ex);
                    if (settings.ThrowExceptions) taskCompletionSourceProcess.SetException(ex); else taskCompletionSourceProcess.TrySetResult(false);
                }
            }
            catch (Exception ex)
            {
                error.AppendLine("Exception thrown: " + ex);
                if (settings.ThrowExceptions) taskCompletionSourceProcess.SetException(ex); else taskCompletionSourceProcess.TrySetResult(false);
            }
            if (success && startInfo.RedirectStandardOutput)
                process.BeginOutputReadLine();
            if (success && startInfo.RedirectStandardError)
                process.BeginErrorReadLine();
            if (success && startInfo.RedirectStandardInput)
            {
                var writeInputTask = Task.Factory.StartNew(() => WriteInputTask());
            }

            async void WriteInputTask()
            {
                var processRunning = true;
                await Task.Delay(50).ConfigureAwait(false);
                try { processRunning = !process.HasExited; } catch { }
                while (processRunning)
                {
                    if (settings.InputText != null)
                    {
                        try
                        {
                            await process.StandardInput.WriteLineAsync(settings.InputText).ConfigureAwait(false);
                            await process.StandardInput.FlushAsync().ConfigureAwait(false);
                            settings.InputText = null;
                        }
                        catch { }
                    }
                    await Task.Delay(5).ConfigureAwait(false);
                    try { processRunning = !process.HasExited; } catch { processRunning = false; }
                }
            }

            if (success && settings.CancellationToken != default(CancellationToken))
                settings.CancellationToken.Register(() => taskCompletionSourceProcess.TrySetResult(true));
            if (success && settings.Timeout_milliseconds > 0)
                new CancellationTokenSource(settings.Timeout_milliseconds).Token.Register(() => taskCompletionSourceProcess.TrySetResult(true));

            var taskProcess = taskCompletionSourceProcess.Task;
            await taskProcess.ConfigureAwait(false);
            if (taskProcess.Result == true) // process was cancelled by token or timeout
            {
                if (!process.HasExited)
                {
                    result.WasCancelled = true;
                    error.AppendLine("Process was cancelled!");
                    try
                    {
                        process.CloseMainWindow();
                        await Task.Delay(30).ConfigureAwait(false);
                        if (!process.HasExited)
                        {
                            process.Kill();
                        }
                    }
                    catch { }
                }
            }
            result.ExitCode = -1;
            if (!settings.DontReadExitCode)     // Reason: sometimes, like when timeout /t 30 is started, reading the ExitCode is only possible if the timeout expired, even if process.Kill was called before.
            {
                try { result.ExitCode = process.ExitCode; }
                catch { output.AppendLine("Reading ExitCode failed."); }
            }
            process.Close();
        }
        finally { var disposeTask = Task.Factory.StartNew(() => process.Dispose()); }    // start in new Task because disposing sometimes waits until the process is finished, for example while executing following command: ping -n 30 -w 1000 127.0.0.1 > nul
        if (result.ExitCode == -1073741510 && !result.WasCancelled)
        {
            error.AppendLine($"Process exited by user!");
        }
        result.WasSuccessful = !result.WasCancelled && result.ExitCode == 0;
        result.Output = output.ToString();
        result.OutputError = error.ToString();
        return result;
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-05-29T21:48:03.510

这是另一种方法。[与svick](https://stackoverflow.com/a/10789196/674237)和[Ohad 的](https://stackoverflow.com/a/31492250/674237)答案类似的概念，但在`Process`类型上使用了扩展方法。

扩展方法：

```
public static Task RunAsync(this Process process)
{
    var tcs = new TaskCompletionSource<object>();
    process.EnableRaisingEvents = true;
    process.Exited += (s, e) => tcs.TrySetResult(null);
    // not sure on best way to handle false being returned
    if (!process.Start()) tcs.SetException(new Exception("Failed to start process."));
    return tcs.Task;
} 
```

包含方法中的示例用例：

```
public async Task ExecuteAsync(string executablePath)
{
    using (var process = new Process())
    {
        // configure process
        process.StartInfo.FileName = executablePath;
        process.StartInfo.UseShellExecute = false;
        process.StartInfo.CreateNoWindow = true;
        // run process asynchronously
        await process.RunAsync();
        // do stuff with results
        Console.WriteLine($"Process finished running at {process.ExitTime} with exit code {process.ExitCode}");
    };// dispose process
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-18T05:50:32.893

我认为你应该使用的是：

```
using System.Diagnostics;
using System.Threading;
using System.Threading.Tasks;

namespace Extensions
{
    public static class ProcessExtensions
    {
        public static async Task<int> WaitForExitAsync(this Process process, CancellationToken cancellationToken = default)
        {
            process = process ?? throw new ArgumentNullException(nameof(process));
            process.EnableRaisingEvents = true;

            var completionSource = new TaskCompletionSource<int>();

            process.Exited += (sender, args) =>
            {
                completionSource.TrySetResult(process.ExitCode);
            };
            if (process.HasExited)
            {
                return process.ExitCode;
            }

            using var registration = cancellationToken.Register(
                () => completionSource.TrySetCanceled(cancellationToken));

            return await completionSource.Task.ConfigureAwait(false);
        }
    }
} 
```

使用示例：

```
public static async Task<int> StartProcessAsync(ProcessStartInfo info, CancellationToken cancellationToken = default)
{
    path = path ?? throw new ArgumentNullException(nameof(path));
    if (!File.Exists(path))
    {
        throw new ArgumentException(@"File is not exists", nameof(path));
    }

    using var process = Process.Start(info);
    if (process == null)
    {
        throw new InvalidOperationException("Process is null");
    }

    try
    {
        return await process.WaitForExitAsync(cancellationToken).ConfigureAwait(false);
    }
    catch (OperationCanceledException)
    {
        process.Kill();

        throw;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-01T14:47:21.427

在 .NET 5 中您可以调用`WaitForExitAsync`，但在 .NET Framework 中该方法不存在。

我建议（即使您使用的是 .NET 5+）[CliWrap](https://github.com/Tyrrrz/CliWrap)库，它提供开箱即用的异步支持（并希望能够处理所有竞争条件），并且可以轻松执行管道和路由输出等操作。

我最近才发现它，我必须说到目前为止我真的很喜欢它！

愚蠢的例子：

```
var cmd = Cli.Wrap(@"C:\test\app.exe")
    .WithArguments("-foo bar")
    .WithStandardOutputPipe(PipeTarget.ToFile(@"C:\test\stdOut.txt"))
    .WithStandardErrorPipe(PipeTarget.ToDelegate(s => Debug.WriteLine(s)));

var result = await cmd.ExecuteAsync(cancellationToken);
Debug.WriteLine(result.ExitCode); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-02-13T02:51:13.990

我真的很担心进程的处理，等待退出异步呢？这是我的建议（基于之前的）：

```
public static class ProcessExtensions
{
    public static Task WaitForExitAsync(this Process process)
    {
        var tcs = new TaskCompletionSource<object>();
        process.EnableRaisingEvents = true;
        process.Exited += (s, e) => tcs.TrySetResult(null);
        return process.HasExited ? Task.CompletedTask : tcs.Task;
    }        
} 
```

然后，像这样使用它：

```
public static async Task<int> ExecAsync(string command, string args)
{
    ProcessStartInfo psi = new ProcessStartInfo();
    psi.FileName = command;
    psi.Arguments = args;

    using (Process proc = Process.Start(psi))
    {
        await proc.WaitForExitAsync();
        return proc.ExitCode;
    }
} 
```

# c# - 如何处理 ASP.Net 和 IIS6 中的无扩展 URL

> ID：10788985
> 
> 赞同：0
> 
> 时间：2012-05-28T18:28:57.263
> 
> 标签：c#, asp.net, url-rewriting

我需要一种编写无扩展名网址的方法。我的服务器是 IIS6.0 版本 1 的共享主机。目前我正在使用 UrlRewriting.Net dll，它仅支持 IIS7。

我的原始网址是 abc.xyz.in/Index.aspx?c=comp_Name; 我的虚拟网址是 abc.xyz.in/comp_Name.aspx 但我希望它为 abc.xyz.in/comp_Name

是否可以通过任何其他模块或任何东西。请注意我的主机是共享主机。所以我既不能自己配置 IIS，也不能强迫我的管理员对其进行修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:56:52.217

IIS6（和旧版本）中自定义路由的问题在于它们默认情况下不会调用 ASP.Net 模块，除非您请求 .aspx、.ashx、.asmx 文件。有一些解决方案使用自定义错误来检查您尝试访问的内容，然后显示正确的页面，但这不是一个很好的解决方案（但如果您真的想了解更多关于它的信息，这里有一个示例在 CodeProject： http: [//www.codeproject.com/Articles/44475/IIS-vs-ASP-NET-URL-Rewriting](http://www.codeproject.com/Articles/44475/IIS-vs-ASP-NET-URL-Rewriting)）。

我的建议是要求您的网络主机为 ASP.Net 添加一个通配符映射，以便它处理所有传入您网站的请求，这样您就可以编写一个适当的路由模块，他们可能不必这样做，但询问并没有什么坏处可以很容易地基于站点进行设置。如果这是不可能的，那么您可能应该寻找一个可以满足您网站需求的新虚拟主机，而不是让您的网站适应您当前的虚拟主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:34:35.433

您好，您需要编写自己的 HttpModule。这是一个很好的例子（[来自这里](http://www.zorched.net/2006/01/20/aspnet-web-application-without-aspx-extension/)）：看看那个网站，它会描述所有需要的步骤。

```
using System;
using System.Web;

public class DavModule : IHttpModule {

    private HttpApplication context = null;

    public void Dispose() {
        context.BeginRequest -= new EventHandler(context_BeginRequest);
    }

    public void Init(HttpApplication context) {
        this.context = context;
        this.context.BeginRequest += new EventHandler(context_BeginRequest);
    }

    void context_BeginRequest(object sender, EventArgs e) {
        HttpApplication app = (HttpApplication) sender;
        app.Response.ContentType = "text/plain";

        if (app.Request.Path.EndsWith("Help"))
            app.Server.Transfer("Help.aspx");
        else {
            app.Response.Write("Path: " + app.Request.Path);
            app.Response.End();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:11:43.743

*如果*您刚开始（或者如果这样做是一种选择），那么问题就变成了您（您的主机）是否在 IIS（6 或 7）上安装了 ASP.Net 4。

无扩展名 url 是[ASP.Net 4](http://haacked.com/archive/2010/12/22/asp-net-mvc-3-extensionless-urls-on-iis-6.aspx)的一部分- 这意味着您的**ASP.Net**站点（您希望无扩展名 url 工作）必须在 ASP.net 4（不是 v2.x）上运行...

嗯...

# javascript - 尝试从 Dom 文档中删除 Dom 节点时出错

> ID：10788986
> 
> 赞同：2
> 
> 时间：2012-05-28T18:29:02.800
> 
> 标签：javascript, dom, asp-classic

我有以下 ASP（js 版本）代码：

```
var doc = Server.CreateObject("HTMLFILE");
var doc.write(content);
// the value of content has been set elsewhere and is not of concern
var elements = doc.getElementsByTagName("br"); 
```

到目前为止，一切都很好。这是我遇到麻烦的地方：

```
if ((elements) && (elements.length > 0))
doc.removeChild(elements[0]); 
```

最后一段代码导致我的网站显示“页面无法显示”消息。幕后发生了什么我不理解的事情吗？为什么我不能删除子节点？附加节点与修改现有节点的属性一样工作正常，但我无法删除节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:36:45.087

`removeChild()`应该在被删除的节点的父节点上调用，如下所示：

```
if (elements && elements.length > 0)
    elements[0].parentNode.removeChild(elements[0]); 
```

或者有时有一个辅助函数会很有帮助：

```
function removeNode(node) {
    node.parentNode.removeChild(node);
} 
```

然后你可以这样做：

```
if (elements && elements.length > 0)
    removeNode(elements[0]); 
```

# c# - 如何在按钮单击时加载和刷新用户控件

> ID：10788987
> 
> 赞同：1
> 
> 时间：2012-05-28T18:29:13.057
> 
> 标签：c#, wpf, user-controls, load, refresh

我有一个 Windows 窗体应用程序，窗体上的控件之一是 WPF 用户控件。我已将元素主机控件放在 Windows 窗体上，这是在启动时加载我的用户控件。

我想要的是在特定时间加载和刷新用户控件。因为我需要加载新数据。

我已经尝试过`elementHost1.Refresh();`了，但这并没有做任何事情。

如何加载和刷新它？

[这是我在此LINK](https://stackoverflow.com/questions/10765116/wpf-element-host-is-crashing-every-second-time)上的用户控件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T22:07:24.530

让数据提供者重新读取其来源：

```
var dataprovider = (System.Windows.Data.XmlDataProvider) (
  ((UserControl1) (elementHost1.Child)).Resources ["rssData"]
);
dataprovider.Refresh (); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:27:24.543

What about `MVVM` and `INotifyPropertyChanged`? Using `INotifyPropertyChanged` you can notify View when data has been changed and refresh it in this way. Seems like this is what you want.

* * *

Take a look into couple related links:

*   [INotifyPropertyChanged WPF](https://stackoverflow.com/questions/1039505/inotifypropertychanged-wpf)
*   [WPF/MVVM Quick Start Tutorial](http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:38:52.183

由于您的控件不会自动刷新，我假设您不使用数据绑定，这可能是最好的解决方案。

假设您有一个（自定义）类型 UserControl1 的用户控件，它承载一个名为 MyButton 的按钮。

您可以创建一个新的 WPF 控件并将其分配给子元素，例如

```
((UserControl1) (elementHost1.Child)).MyButton = new System.Windows.Button () 
```

或者您按如下方式访问 WPF 控件

```
var wpfButton = ((UserControl1) (elementHost1.Child)).MyButton; 
```

然后简单地重置 WPF 控件的必要属性：

```
wpfButton.Content = "My new text"; 
```

编辑：错误更正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T19:55:13.167

当你再次调用你的加载事件时会发生什么？

或者至少是您用来在表单中填充数据的方法>

即要么调用你的`this.Load(null,null)`（或根据需要传递一些对象或事件）

```
private void form1_load(object o, EventArgs e)
{
    BindDataToControlMethod();
} 
```

或者重构你的代码，这样你就可以调用你的`BindDataToControlMethod()`方法。

`elementHost1.Refresh()`您正在拨打的电话只是在屏幕上重新绘制表单。它本身不会重新加载。

# php - Mysql将JOIN中的空匹配返回为null

> ID：10788988
> 
> 赞同：0
> 
> 时间：2012-05-28T18:29:16.473
> 
> 标签：php, mysql, codeigniter, join

我有这些桌子

> **cat** (保存类别的主要数据) id_cat, 原始名称
> **cat_lang** (保存不同语言的猫详细信息) lang, id_cat,local_name
> **cat_media** (保存猫媒体) id_cat, id_media, usage (可能有基本或大)
> **media** (保存图像信息) id_media、名称、路径

我做了一个查询，它返回这样的选定类别的子类别。

```
$this->db->select('*')
         ->from('cat')
         ->join('cat_lang','cat.id_cat = cat_lang.id_cat','left outer')
         ->join('cat_media','cat.id_cat= cat_media.id_cat','left outer')             
         ->join('media','cat_media.id_media=media.id_media','left outer')
         ->where('cat.id_parent',$id_cat) //comes from function             
         ->where('cat_lang.lang',$lang)
$query = $this->db->get(); 
```

之后我将过滤大图像：

```
 $sub_cats = $query->result_array(); 
  $data['sub_cats']= array();
  foreach($sub_cats as $key => $value)
  {
    if($value['usage'] == 'base' OR $value['usage'] == null)
    $data['sub_cats'][] = $value;
  } 
```

`$value['usage'] == null`是麻烦开始的地方。问题是在某些类别中，没有附加基本图像，并且上面的查询不返回此类别，因为它在`cat.id_cat= cat_media.id_cat`条件上不匹配。

我想进入结果表：

```
id_cat:1 , ..., id_media = 2, usage=big
id_cat:2 , ..., id_media = null, usage=null 
```

所以我需要它们在结果表中为空。我怎样才能做到这一点？在这里堆了几个小时。谢谢你的帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:32:22.073

使用 a`left outer join`而不是简单的`join`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T13:03:28.230

我意识到我正在尝试一些不可能的事情。试图获取附加图像的类别，但也询问哪些没有附加图像。我确保在创建类别时我现在附加一个默认的非预览图像，现在查询完成了这项工作。感谢您的回答。

# php - NUM_ROWS 个问题根本不会写出任何内容

> ID：10788990
> 
> 赞同：-1
> 
> 时间：2012-05-28T18:29:29.130
> 
> 标签：php, mysqli

嘿，这就是我必须这样做的方式，如果数据库找不到与数据库匹配的任何内容或可以找到任何内容，那么它应该站出来说些什么，但我完全决定如何构建它。我会听到可以帮助我

我尝试这样做：

```
<?php
if ($stmt = $mysqli->prepare('SELECT id_forum, title, tekst, dato, id_brugere FROM `forum` ORDER BY `forum`.`id` DESC'))
{
   $stmt->execute();
   $stmt->bind_result($id, $djnavn, $profilbillede);
   $rows = $stmt->num_rows;
   echo $rows;

   while ($stmt->fetch())
   {
   ?>
      <td class="titleforum"></td>
      <td>Dato:</td>
   <?php
   }
   $stmt->close();
}
else
   $row_cnt = $result->num_rows;
   print_r($row_cnt);
?> 
```

但它似乎没有任何东西在说话或看起来像..我想要的是它说了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:07:20.807

尝试：

```
<?php
if ($stmt = $mysqli -> prepare('SELECT id_forum, title, tekst, dato, id_brugere FROM `forum` ORDER BY `forum`.`id` DESC'))
{
   $stmt -> execute();
   $stmt -> store_result();

   $rows = $stmt -> num_rows;
   echo $rows;

   while ($stmt -> fetch()) {
?>
      <td class="titleforum"></td>
      <td>Dato:</td>
   <?php
   }
   $stmt->close();
}
?> 
```

见： http: [//php.net/manual/en/mysqli-stmt.num-rows.php](http://php.net/manual/en/mysqli-stmt.num-rows.php)

# opengl - OpenGL 4.2 中的 ImageTextures 问题

> ID：10788991
> 
> 赞同：1
> 
> 时间：2012-05-28T18:29:31.747
> 
> 标签：opengl, glsl

我正在尝试编写一个简单的测试程序来演示 GLSL 4.2 的`ImageLoad`功能。到目前为止，我有：

*   一个简单的着色器，它从 an 加载左下角的纹素`image2D`并显示它。
*   一些简单的顶点代码来绘制全屏小队
*   其他用于创建上下文、编译着色器等的脚手架代码。

这是我的片段代码（顶点是一个简单的直通着色器）：

```
#version 420

#include <gtest/SmallImage.h> //NOTE: I have a preprocessor that takes care of includes

layout(binding = SMALL_IMAGE_ONE_BINDING, rgba8) uniform image2D image_one;

smooth in vec2 texture_coords;
out vec4 out_color;

void main(void)
{
  vec4 loaded = imageLoad(image_one, ivec2(0,0));
  vec4;
  out_color = vec4(loaded.r,
               loaded.g,
                   gl_FragCoord.y/1200.0,
                   1);
} 
```

很简单，没有阅读空间。与像素坐标成比例的蓝色通道让我知道即使`imageLoad`调用失败，四边形也被正确渲染。

这是我用来渲染到屏幕的 C++ 循环。它绑定一个纹理，写入一个黄色纹素，然后渲染一个全屏四边形。有两种变体：当`MAKE_ONCE`定义时，纹理在循环之前生成一次。如果未定义，则循环的每次迭代都会生成一个新纹理：

```
MyTestFun(void)
{
  glm::vec4 yellow = glm::vec4(1.0, 1.0, 0.0, 1.0); 

#ifdef MAKE_ONCE
  renderer->InitFrame();  //sets current OpenGL context 
  GLuint name = 0;
  glGenTextures(1, &name);   
  renderer->EndFrame();  
#endif

  while(1)
  {     
    renderer->InitFrame();

#ifndef MAKE_ONCE
    GLuint name =0;
    glGenTextures(1, &name);   
#endif

    glBindTexture(GL_TEXTURE_2D, name);

    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, 1, 1, 0, GL_RGBA, GL_FLOAT,
                 glm::value_ptr(yellow));

    glBindTexture(GL_TEXTURE_2D, 0);

    glBindImageTexture(SMALL_IMAGE_ONE_UNIT, name, 0, false, 0, GL_READ_ONLY,
                       GL_RGBA8);

    renderer->FullscreenQuad(); //shades using the frag shader shown above

    //bind the default texture to the image unit, hopefully freeing ours for editing
    glBindImageTexture(SMALL_IMAGE_ONE_UNIT, 0, 0, false, 0, GL_READ_WRITE,
                       GL_RGBA8);

    renderer->EndFrame();
  }
} 
```

定义时`MAKE_ONCE`，第一帧显示从白色到黄色的垂直渐变，但随后的帧显示从蓝色到黑色的垂直渐变，表示`IMAGE_LOAD`调用返回 0.0。

当`MAKE_ONCE`未定义时，例如在每一帧上重新制作纹理，程序将按预期运行，在每一帧上显示相同的白色<->黄色渐变。

什么可能导致这种行为？OpenGL 4.2 规范说，`imageLoad`如果图像处于无效状态 (p255-266)，则调用将返回黑色（全零），但此处似乎没有任何有效条件。

# ios - 非公共 NSURLConnection 泄漏

> ID：10788993
> 
> 赞同：1
> 
> 时间：2012-05-28T18:29:38.380
> 
> 标签：ios, memory-leaks, nsurlconnection

我的应用程序中出现了许多由使用 NSURLConnections 引起的泄漏。问题是所有泄漏都是系统对象，而不是我正在创建的对象。CFURLConnection、CFURLRequest、URLConnectionInstanceData 和 HTTPBodyData 之类的东西。但是实际的 NSURLConnection 没有报告为泄漏，NSMutableURLRequest 也没有。我无法发布所有代码，所以这里是重要信息：

1.  该项目是非ARC。
2.  NSURLConnections 是在主线程上创建的。
3.  这是一个异步调用。
4.  使用同一个委托创建了多个 NSURLConnections。
5.  调用是一个 HTTP 帖子
6.  在 5.0 和 5.1 设备中都看到了这个错误。

我尝试了许多不同的方法来重构代码并停止问题，但我真的不知道如何追踪错误的原因，因为一切都指向系统库。有没有人遇到过类似的问题或有任何想法如何找到问题所在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:44:57.760

此问题是由格式错误的 URL 引起的。看来，如果您提供无效的 url，它会导致 CFNetwork 泄漏。

# regex - pcre 字符类与范围内的字符不匹配

> ID：10788997
> 
> 赞同：0
> 
> 时间：2012-05-28T18:30:17.177
> 
> 标签：regex, pcre

8 启用了 pcre，我正在尝试匹配 \p{Po} 组加上一堆其他的东西。

我想排除 & 字符。如何将特定角色排除在课程之外？

```
-- lua btw    
local utf8_general_punctuation_reg = "[\\p{Po}\\p{Cc}\\p{Cs}\\p{Pc}\\p{Pe}\\p{Ps}\\p{Pf}\\p{Pi}\\p{Sm}\\x{2100}-\\x{2123}\\x{2600}-\\x{26ff}]+" 
```

提前致谢！

BTW \p{Po} 适用于 utf8 [http://www.fileformat.info/info/unicode/category/Po/list.htm](http://www.fileformat.info/info/unicode/category/Po/list.htm)

只需从以下答案中添加有效的内容：

```
local utf8_general_punctuation_reg = "[\\p{Po}\\p{Cc}\\p{Cs}\\p{Pc}\\p{Pe}\\p{Ps}\\p{Pf}\\p{Pi}\\p{Sm}\\x{2100}-\\x{2123}\\x{2600}-\\x{26ff}]+(?<!(&|\\.|:))" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:44:00.387

You can use negative lookbehind for this. I'm not familiar with pcre syntax.

```
[abc](?<!b) 
```

That regex first allows a or b or c, just look the Unicode Property allows different characters, and then disallow the b character with negative lookbehind.

The regex above will match a and c in the end but not b.