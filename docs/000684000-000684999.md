# StackOverflow 问答 000684000-000684999

# c# - 解决交互组合爆炸的最佳方法是什么？

> ID：684000
> 
> 赞同：10
> 
> 时间：2009-03-25T23:55:18.287
> 
> 标签：c#, design-patterns, software-design

我现在正在做的一件事与游戏有一些相似之处。出于说明的目的，我将使用一个虚构的假设游戏中的示例来解释我的问题。

让我们称之为*DeathBlaster 4: The Deathening 吧*。在 DB4 中，您有许多在移动时`Ship`会定期随机遇到的对象`Phenomena`。一个给定的在遇到它的时候`Phenomenon`可能有零个、一个或多个。例如，我们可能有四种和三种。`Effects``Ship``Ships``Phenomena`

```
                              现象
              ===========================================
船舶重力井黑洞星云场
------------ -------------------------------------- ----
红船 +20% 速度 -50% 力量 -50% 护盾
BlueShip 无效果 无敌死亡 各种效果
绿船 -20% 速度死亡 +50% 护盾 船上现象
YellowShip 死亡 +50% 功率无效果    

```

此外，`Effects`还可以相互交互。例如，`GreenShip`同时在 a`GravityWell`和 a中的 a 可能会在生成的和`NebulaField`之间产生某种协同作用。在这种情况下，协同效应本身就是一种——例如，这种相互作用可能会产生一种。除了作用于 a的集合之外，不需要任何信息来解决最终结果应该是什么。`SpeedEffect``ShieldEffect``Effect``PowerLevelSynergyEffect``Effects``Ship`

您可能会开始看到这里出现的问题。作为一种天真的第一方法，**要么每个`Ship`人都必须知道如何处理每个人`Phenomenon`，要么每个`Phenomenon`人都必须知道每个人`Ship`**。这显然是不可接受的，因此我们想将这些责任转移到其他地方。显然这里至少有一个外部类，可能是一个`Mediator`或`Visitor`某种。

但是最好的方法是什么？理想的解决方案可能具有以下属性：

*   `Ship`添加一个新的就像添加一个新的一样容易`Phenomenon`。
*   不产生影响的交互是默认的，不需要额外的代码来表示。约定优于配置。
*   了解`Effects`彼此之间的交互方式，并能够管理这些交互以决定最终结果。

我想我已经决定了我的方法，但我很想听听最佳设计共识是什么。你会从哪里开始？你会探索哪些途径？

* * *

* * *

**后续更新：**谢谢大家的回复。这就是我最终要做的事情。我的主要观察是，相对于可能的×交互的数量，不同的数量`Effects`似乎很小。即，虽然有许多可能的交互*组合，但这些交互**的结果种类*数量较少。`Phenomena``Ships`

 **可以看到，比如表格中虽然有12种交互组合，但效果只有五种*：*速度修改、力量修改、护盾修改、无敌、死亡。

我引入了第三个类 ,`InteractionResolver`来确定交互的结果。它包含一个映射`Ship-Phenomenon`对的字典`Effects`（基本上是一个执行效果的委托和一些元数据）。当计算交互的结果完成时，每一个都会`Ship`被传递`EffectStack`给它正在经历的对应。`Effects`

`Ships`然后使用`EffectStack`来确定它们的实际结果，方法是`Effects`向它们现有的属性和属性添加修饰符。

我喜欢这个，因为：

*   `Ship`s 永远不需要知道`Phenomena`。
*   `Ship`-关系的复杂性`Phenomena`被抽象为`InteractionResolver`.
*   如何解决多种可能复杂的效果的细节由`InteractionResolver`. 船只只需在必要时应用效果。
*   这可以进行其他有用的重构。例如，船舶处理效果的*方式*可以通过制作`EffectProcessorStrategy`. 默认可能是处理所有效果，但是，比如说，a`BossShip`可能会通过使用不同的`EffectProcessorStrategy`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:14:25.493

一个有趣的潜在选择是使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的变体。

Judith Bishop 和 R. Nigel Horspool 写了一篇关于[设计模式效率](http://webhome.cs.uvic.ca/~nigelh/Publications/Tools08.pdf)的论文，他们在其中解释了使用 C# 3 特性的经典访问者模式的各种变体。

特别是，我将看看他们如何与代表一起处理访问者模式。使用委托列表或堆栈可能会为您提供一种有趣的方式来处理来自多个对象的多个效果，并且可以更轻松地扩展类层次结构的任一侧（添加船舶或添加效果），而无需大量破坏代码更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:05:12.160

不完全是一个答案，但对我来说，这相当尖叫“属性模式”。对此有一个著名的 yegge rant，我认为它会为您提供一些不错的指导。

[http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html](http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T00:12:23.207

这看起来像是经典的 OOP 多态性/访问者困境。但是，您的要求使其变得更容易。

基本上，我会创建一个`Ship`所有具体 Ships 派生自的基类。这个类将有方法：

```
class Ship
{
  void encounterBlackHole() {}
  void encounterNebula() {}
  ... etc. ...
}; 
```

具有空的默认主体。当你添加一个新的现象时，你只需添加一个空主体的新方法。（这些方法可能有参数，比如黑洞的坐标或权重等。）

对于效果及其交互 - 我认为您应该添加更多关于您想要它的信息，例如。交互是罕见的还是常见的，它们是否以某种方式累积，它们是否仅限于他们控制的有限变量集......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T00:20:02.093

对我来说，这听起来像是一个经典的[多重调度问题](http://c2.com/cgi/wiki?DoubleDispatch)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T00:22:59.013

有趣的问题

以某种方式，一艘船必须知道哪些现象会影响它，以及它对哪艘船有影响的现象。

这可以存储在运行时解析的 xml 文件中。

也许您可以使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)来计算效果。您在运行时会产生各种现象。

假设您的船实现了一个接口 IShip，并且在您的代码中的任何地方，您都使用 IShip。

现在，假设您的所有现象也实现了接口 IShip（装饰器设计模式要求）。

```
IShip myShip = myShip.AddPhenomena(PhenomenaGeneratedByAFactoryForThisShip); 
```

在现象中，您包装了原始船舶的方法，因此您可以对属性和所有内容进行修改。

此外，如果您使用[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，您可以生成任何您想要的现象。

移除一个现象，可以通过走你拥有的那堆装饰船，然后重新包装它来使用，所以我认为那里没有问题。

至于协同作用，我想我会使用稍微修改过的现象，这只有在目标船本身拥有所有现象时才有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T00:41:55.303

> 要么每艘船都必须知道如何处理每一种现象，或者每条现象都必须了解每艘船。

我认为这是解决您问题的关键，如果每个船舶现象交互都是独一无二的，那么这是真的。在您创建的表中，情况似乎如此，因此对于 n 艘船和 m 个现象，您需要指定 n*m 交互。你闻到维护问题是对的。

唯一的出路是通过使现象的影响取决于船舶的属性，从而使船舶与现象的相互作用不再那么独特。例如，我们可以说只有用奇怪氧化铝建造的船才能在黑洞中幸存下来。

但是只有一处房产并不能给你带来任何好处，你可以很容易地确定哪些船只受到黑洞的影响。关键是多个属性表现出相同的组合爆炸。

因此，用奇怪氧化铝建造的船将在黑洞中幸存下来，而没有用奇怪氧化铝建造的船可以走得更快。1 属性允许您指定 2 件事（1 位 = 2 种可能性）。用 Corbite 发动机建造的船只在曲速区会更快。同时具有碳酸盐发动机和奇异氧化铝的船舶将在星云场等中获得 50% 的护盾。

向船添加属性可以避免指定每种现象如何与每艘船相互作用，但仍然让每种现象和每艘船都表现出适当的行为。

如果有 M 艘船，那么您只需要 log2(M) 属性即可为每艘船提供独特的行为。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T03:34:17.923

我认为问题的答案取决于问题的好坏。

我认为设计的方式取决于问题是什么（或者问题将在未来出现）

你给一个表，那么我认为解决方案是维护一个表并查询它。

此处的python代码：（未经测试，仅显示示例）

```
class Ship():
     def __init__(self,type):
         self.type=type
     def encounterPhenomena(self,type): # let Phenomena to process ship
         p = Phenomena(type)
         p.process(self)

class Phenomena():
     processTable = {}
     def __init__(self,type):
         self.type=type
     def process(self,ship):
         try:
             self.processTable[self.type](ship.type) #query the internal table to process ship
         except:
             pass #if Phenomena don't know this ship type then no process..
     def addType(type,processMethod):
         processTable[type]=processMethod #add new Phenomena, and add processMethod

def run():
    A = Ship(type = 'RedShip')
    A.encounterPhenomena(type='GravityWell'); 
```

如果处理方法发生了变化，只需修改 Phenomena 类中的处理方法即可。

如果您认为船舶需要知道如何处理 Phenomena，则将处理方法更改为船舶类。

或者您认为除了 Phenomena 需要更改船舶状态（如其他船舶、浅滩岩石）之外还有其他事情，您需要在船级中维护一个进程表并使 Phenomena 成为其中之一，

再说了，怎么设计，就看自己的问题了。

# linux - 如何从 linux 命令行获取视频文件的分辨率（宽度和高度）？

> ID：684015
> 
> 赞同：81
> 
> 时间：2009-03-25T23:59:01.600
> 
> 标签：linux, command-line, video, ffmpeg, resolution

我一直在研究 mplayer/mencoder 和 ffmpeg 文档，但似乎什么都想不**出来**。我对输出格式并不是特别挑剔，因为我可以使用正则表达式将其提取出来，我似乎一开始就无法获取数据。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-06-27T23:24:13.627

使用[ffprobe](https://ffmpeg.org/ffprobe.html)（FFmpeg 工具包的一部分）

例子：

```
ffprobe -v quiet -print_format json -show_format -show_streams ~/Movies/big_buck_bunny_720p_5mb.mp4 
```

输出：

```
{
    "streams": [
        {
            "index": 0,
            "codec_name": "h264",
            "codec_long_name": "H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10",
            "profile": "Main",
            "codec_type": "video",
            "codec_time_base": "1/50",
            "codec_tag_string": "avc1",
            "codec_tag": "0x31637661",
            "width": 1280,
            "height": 720,
            "coded_width": 1280,
            "coded_height": 720,
            "has_b_frames": 0,
            "sample_aspect_ratio": "1:1",
            "display_aspect_ratio": "16:9",
            "pix_fmt": "yuv420p",
            "level": 31,
            "chroma_location": "left",
            "refs": 1,
            "is_avc": "1",
            "nal_length_size": "4",
            "r_frame_rate": "25/1",
            "avg_frame_rate": "25/1",
            "time_base": "1/12800",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 378368,
            "duration": "29.560000",
            "bit_rate": "1032960",
            "bits_per_raw_sample": "8",
            "nb_frames": "739",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0
            },
            "tags": {
                "creation_time": "1970-01-01 00:00:00",
                "language": "und",
                "handler_name": "VideoHandler"
            }
        },
        {
            "index": 1,
            "codec_name": "aac",
            "codec_long_name": "AAC (Advanced Audio Coding)",
            "profile": "LC",
            "codec_type": "audio",
            "codec_time_base": "1/48000",
            "codec_tag_string": "mp4a",
            "codec_tag": "0x6134706d",
            "sample_fmt": "fltp",
            "sample_rate": "48000",
            "channels": 6,
            "channel_layout": "5.1",
            "bits_per_sample": 0,
            "r_frame_rate": "0/0",
            "avg_frame_rate": "0/0",
            "time_base": "1/48000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 1419264,
            "duration": "29.568000",
            "bit_rate": "383960",
            "max_bit_rate": "416704",
            "nb_frames": "1386",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0
            },
            "tags": {
                "creation_time": "1970-01-01 00:00:00",
                "language": "und",
                "handler_name": "SoundHandler"
            }
        }
    ],
    "format": {
        "filename": "/Users/farsheed/Movies/big_buck_bunny_720p_5mb.mp4",
        "nb_streams": 2,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "29.568000",
        "size": "5253880",
        "bit_rate": "1421504",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2avc1mp41",
            "creation_time": "1970-01-01 00:00:00",
            "encoder": "Lavf53.24.2"
        }
    }
} 
```

有关更多信息，请参阅文档。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2015-01-08T01:43:45.460

使用`ffprobe`：

```
ffprobe -v error -select_streams v:0 -show_entries stream=width,height -of csv=s=x:p=0 input.mp4 
```

示例输出：

```
1280x720 
```

有关更多信息，请参阅[FFprobe 文档](https://ffmpeg.org/ffprobe.html)和[FFmpeg Wiki：FFprobe 提示](https://trac.ffmpeg.org/wiki/FFprobeTips)。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2015-01-07T20:28:24.377

# 使用 exiftool

运行命令

```
exiftool VIDEOFILE 
```

您得到的输出与此类似：

```
ExifTool Version Number         : 9.76
File Name                       : gource2.mkv
Directory                       : .
File Size                       : 2010 MB
File Modification Date/Time     : 2015:01:07 14:16:22-06:00
File Access Date/Time           : 2015:01:07 14:16:22-06:00
File Inode Change Date/Time     : 2015:01:07 14:16:22-06:00
File Permissions                : rw-rw-r--
File Type                       : MKV
MIME Type                       : video/x-matroska
EBML Version                    : 1
EBML Read Version               : 1
Doc Type                        : matroska
Doc Type Version                : 4
Doc Type Read Version           : 2
Timecode Scale                  : 1 ms
Muxing App                      : libebml v1.3.0 + libmatroska v1.4.1
Writing App                     : mkvmerge v7.4.0 ('Circles') 64bit built on Dec 17 2014 11:31:10
Duration                        : 2:35:09
Date/Time Original              : 2015:01:07 20:14:22Z
Video Codec ID                  : V_MPEG4/ISO/AVC
Video Frame Rate                : 60
Track Language                  : und
Image Width                     : 1280
Image Height                    : 1024
Display Width                   : 1280
Display Height                  : 1024
Track Number                    : 2
Track Type                      : Audio
Audio Codec ID                  : A_DTS
Default Duration                : 10.666666 ms
Audio Sample Rate               : 48000
Audio Channels                  : 6
Image Size                      : 1280x1024 
```

# 使用 ffmpeg/ffprobe

运行命令

```
ffprobe VIDEOFILE 
```

或者：

```
ffmpeg -i VIDEOFILE 
```

您得到的输出与此类似：

```
ffprobe version 2.1.6 Copyright (c) 2007-2014 the FFmpeg developers
  built on Nov 29 2014 12:07:56 with gcc 4.8.3 (GCC) 20140911 (Red Hat 4.8.3-7)
  configuration: --prefix=/usr --bindir=/usr/bin --datadir=/usr/share/ffmpeg --incdir=/usr/include/ffmpeg --libdir=/usr/lib64 --mandir=/usr/share/man --arch=x86_64 --optflags='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic' --enable-bzlib --disable-crystalhd --enable-frei0r --enable-gnutls --enable-libass --enable-libcdio --enable-libcelt --enable-libdc1394 --disable-indev=jack --enable-libfreetype --enable-libgsm --enable-libmp3lame --enable-openal --enable-libopencv --enable-libopenjpeg --enable-libopus --enable-libpulse --enable-libschroedinger --enable-libsoxr --enable-libspeex --enable-libtheora --enable-libvorbis --enable-libv4l2 --enable-libvpx --enable-libx264 --enable-libxvid --enable-x11grab --enable-avfilter --enable-avresample --enable-postproc --enable-pthreads --disable-static --enable-shared --enable-gpl --disable-debug --disable-stripping --shlibdir=/usr/lib64 --enable-runtime-cpudetect
  libavutil      52\. 48.101 / 52\. 48.101
  libavcodec     55\. 39.101 / 55\. 39.101
  libavformat    55\. 19.104 / 55\. 19.104
  libavdevice    55\.  5.100 / 55\.  5.100
  libavfilter     3\. 90.100 /  3\. 90.100
  libavresample   1\.  1\.  0 /  1\.  1\.  0
  libswscale      2\.  5.101 /  2\.  5.101
  libswresample   0\. 17.104 /  0\. 17.104
  libpostproc    52\.  3.100 / 52\.  3.100
Input #0, matroska,webm, from 'gource2.mkv':
  Metadata:
    creation_time   : 2015-01-07 20:14:22
  Duration: 02:35:09.70, start: 0.000000, bitrate: 1811 kb/s
    Stream #0:0: Video: h264 (Constrained Baseline), yuv420p, 1280x1024, SAR 1:1 DAR 5:4, 60 fps, 60 tbr, 1k tbn, 120 tbc (default)
    Stream #0:1(eng): Audio: dts (DTS), 48000 Hz, 5.1(side), fltp, 1536 kb/s (default) 
```

# 使用 mplayer

运行命令

```
mplayer -really-quiet -ao null -vo null -identify -frames 0 VIDEOFILE 
```

您得到的输出与此类似：

```
ID_VIDEO_ID=0
ID_AUDIO_ID=0
ID_AID_0_LANG=eng
ID_CLIP_INFO_NAME0=creation_time
ID_CLIP_INFO_VALUE0=2015-01-07 20:14:22
ID_CLIP_INFO_N=1
ID_FILENAME=gource2.mkv
ID_DEMUXER=lavfpref
ID_VIDEO_FORMAT=H264
ID_VIDEO_BITRATE=0
ID_VIDEO_WIDTH=1280
ID_VIDEO_HEIGHT=1024
ID_VIDEO_FPS=60.000
ID_VIDEO_ASPECT=0.0000
ID_AUDIO_FORMAT=8193
ID_AUDIO_BITRATE=1536000
ID_AUDIO_RATE=48000
ID_AUDIO_NCH=6
ID_START_TIME=0.00
ID_LENGTH=9309.70
ID_SEEKABLE=1
ID_CHAPTERS=0
ID_VIDEO_CODEC=ffh264
ID_AUDIO_BITRATE=1536000
ID_AUDIO_RATE=48000
ID_AUDIO_NCH=6
ID_AUDIO_CODEC=ffdca
ID_EXIT=EOF 
```

# 使用媒体信息

运行命令

```
mediainfo VIDEOFILE 
```

您得到的输出与此类似：

```
General
Unique ID                                : 311795358270161665158539797930749663166 (0xEA919A09196F0CAEF4E1B4FEB72B17BE)
Complete name                            : gource2.mkv
Format                                   : Matroska
Format version                           : Version 4 / Version 2
File size                                : 1.96 GiB
Duration                                 : 2h 35mn
Overall bit rate                         : 1 811 Kbps
Encoded date                             : UTC 2015-01-07 20:14:22
Writing application                      : mkvmerge v7.4.0 ('Circles') 64bit built on Dec 17 2014 11:31:10
Writing library                          : libebml v1.3.0 + libmatroska v1.4.1

Video
ID                                       : 1
Format                                   : AVC
Format/Info                              : Advanced Video Codec
Format profile                           : Baseline@L4.2
Format settings, CABAC                   : No
Format settings, ReFrames                : 1 frame
Codec ID                                 : V_MPEG4/ISO/AVC
Bit rate                                 : 266 Kbps
Width                                    : 1 280 pixels
Height                                   : 1 024 pixels
Display aspect ratio                     : 5:4
Frame rate mode                          : Variable
Color space                              : YUV
Chroma subsampling                       : 4:2:0
Bit depth                                : 8 bits
Scan type                                : Progressive
Writing library                          : x264 core 138 r2363 c628e3b
Encoding settings                        : cabac=0 / ref=1 / deblock=0:1:1 / analyse=0:0 / me=dia / subme=0 / psy=1 / psy_rd=0.40:0.00 / mixed_ref=0 / me_range=16 / chroma_me=1 / trellis=0 / 8x8dct=0 / cqm=0 / deadzone=21,11 / fast_pskip=1 / chroma_qp_offset=0 / threads=12 / lookahead_threads=2 / sliced_threads=0 / nr=0 / decimate=1 / interlaced=0 / bluray_compat=0 / constrained_intra=0 / bframes=0 / weightp=0 / keyint=250 / keyint_min=25 / scenecut=0 / intra_refresh=0 / rc=crf / mbtree=0 / crf=22.0 / qcomp=0.60 / qpmin=0 / qpmax=69 / qpstep=4 / ip_ratio=1.40 / aq=0
Default                                  : Yes
Forced                                   : No

Audio
ID                                       : 2
Format                                   : DTS
Format/Info                              : Digital Theater Systems
Mode                                     : 16
Format settings, Endianness              : Big
Codec ID                                 : A_DTS
Duration                                 : 2h 35mn
Bit rate mode                            : Constant
Bit rate                                 : 1 509 Kbps
Channel(s)                               : 6 channels
Channel positions                        : Front: L C R, Side: L R, LFE
Sampling rate                            : 48.0 KHz
Bit depth                                : 24 bits
Compression mode                         : Lossy
Stream size                              : 1.64 GiB (83%)
Language                                 : English
Default                                  : Yes
Forced                                   : No 
```

# 时间总结

```
exiftool
    real    0m0.089s
    user    0m0.081s
    sys     0m0.008s
mplayer
    real    0m0.050s
    user    0m0.034s
    sys     0m0.017s
ffprobe/ffmpeg
    real    0m0.017s
    user    0m0.011s
    sys     0m0.007s
mediainfo
    real    0m0.029s
    user    0m0.025s
    sys     0m0.004s 
```

YMMV，但 ffprobe 是最快的，其次是 mediainfo，然后是 mplayer，最后是 exiftool

```
ffprobe < mediainfo < mplayer < exiftool 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-26T00:14:56.927

[MediaInfo](http://mediainfo.sourceforge.net/en)有一个命令行版本，并提供尺寸以及*大量*其他信息。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-04-16T23:05:33.590

**只**返回Width 和 Height [mediainfo](https://mediaarea.net/en/MediaInfo)是一个很好的工具。

mediainfo --Inform="Video;%Width%" Videofile && mediainfo --Inform="Video;%Height%" Videofile 将为[大量支持的视频文件做到这一点，不多也不少。](https://mediaarea.net/en/MediaInfo/Support/Formats)

`Inform=`您可以使用命令获得一长串有用的参数`mediainfo --Info-Parameters`

如果您想要标准 WidthXHeight 格式的输出，请使用`Width=$(mediainfo --Inform="Video;%Width%" Video.File)&& Height=$(mediainfo --Inform="Video;%Height%" Video.File)&&echo $Width"X"$Height`

[这里](https://stackoverflow.com/a/46565234/3816360)有一个 bash 脚本，您可以轻松修改以满足您的需求。

或者正如[最近在评论](https://stackoverflow.com/questions/684015/how-can-i-get-the-resolution-width-and-height-for-a-video-file-from-a-linux-co/43443097#comment109322164_43443097)中提到的[暗龙](https://stackoverflow.com/users/3779655/darkdragon) `mediainfo --Inform="Video;%Width%X%Height%" Videofile`

资料来源：

[使用 FFMPEG 以最少的重新编码添加覆盖](https://stackoverflow.com/questions/34180671/adding-an-overlay-using-ffmpeg-with-minimal-re-encoding/46565234#46565234)

[http://manpages.ubuntu.com/manpages/xenial/man1/mediainfo.1.html](http://manpages.ubuntu.com/manpages/xenial/man1/mediainfo.1.html)

[whiptail：如何将输出重定向到环境变量？](https://stackoverflow.com/questions/1970180/whiptail-how-to-redirect-output-to-environment-variable)

[如何在 Bash 中连接字符串变量](https://stackoverflow.com/questions/4181703/how-to-concatenate-string-variables-in-bash)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-26T00:06:37.370

试试 midentify.sh（MPlayer 源代码树中的 TOOLS/midentify.sh）。

它将以可解析的格式显示信息：

```
$  ./midentify.sh /data/myvid.flv 
ID_VIDEO_ID=0
ID_AUDIO_ID=1
ID_FILENAME=/data/myvid.flv
ID_DEMUXER=lavfpref
ID_VIDEO_FORMAT=VP6F
ID_VIDEO_BITRATE=0
ID_VIDEO_WIDTH=640
ID_VIDEO_HEIGHT=480 
```

[,,,]

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-02-22T21:24:44.733

如果您只对分辨率感兴趣：

```
ffprobe -v error -of flat=s=_ -select_streams v:0 -show_entries stream=height,width video.mkv 
```

它也适用于[Windows](http://ffmpeg.zeranoe.com/builds/)。这正在我的 PC 上运行，以构建所有文件的索引：

```
find //Q1207/Film -size +10000k -print -a -exec ./ffprobe.exe -v error -of flat=s=_ -select_streams v:0 -show_entries stream=height,width \{\} \; > //Q1207/Film/index.txt 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-04-20T14:10:25.567

这是我为了这个目的而在 ffprobe 周围炮制的“几乎一条线”。在 Linux 和 MacOS 上都非常适合我。

```
#!/bin/bash

B='[[:blank:]]'
D='[[:digit:]]'
ffprobe "$1" 2>&1 \
    | grep 'Stream.*Video.*fps' \
    | sed "s/^.*$B\($D$D$D*x$D$D$D*\).*$/\1/" 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-09-26T20:38:41.483

如果您不是终端狂，只需在 Handbrake 中打开文件。它报告图像尺寸以及文件名。适用于 mkv 文件。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-03-26T00:08:00.377

好的“文件”实用程序通常会获得视频文件的尺寸。

# c++ - 如何制作滚动但不显示滚动条的单行 systabcontrol32

> ID：684019
> 
> 赞同：0
> 
> 时间：2009-03-25T23:59:53.767
> 
> 标签：c++, winapi

嗨，当我调整窗口大小时，我正在创建一个`systabcontrol32`带有`TCS_SINGLELINE`样式的控件，因此选项卡不适合出现一个允许我滚动的上下控件，以便我可以看到所有选项卡。

问题是上下按钮似乎不起作用，除非我将`WS_HSCROLL`属性添加到选项卡控件中，否则它会变得丑陋得要命。如果 up-down 可以滚动标签而不需要添加滚动条可能会很酷（更因为滚动条似乎不起作用，它只是坐在那里而我无法单击它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:22:38.707

我在具有 TCS_SINGLELINE 的应用程序中使用了选项卡控件，它似乎工作正常：如果选项卡的数量超过空间允许的数量，则右侧会出现小的左/右按钮，从而允许选项卡滚动。它应该“正常工作”。

你可以发布一些示例代码吗？或者尝试组合一个最小的应用程序来证明它不起作用？此处的快速测试表明它似乎没问题（至少在此处的 Windows XP 上）。

# windows - Windows 服务和关闭 EC2 节点

> ID：684030
> 
> 赞同：0
> 
> 时间：2009-03-26T00:04:29.497
> 
> 标签：windows, amazon-ec2, cloud, cloud-platform

我现在在测试平台 EC2 节点上运行了一个相当简单的 Windows 服务，基本上：

*   服务启动时在我们本地数据中心的机器上调用 Web 服务（该服务设置为自动启动，因此它在实例上线时运行）。
*   每分钟调用一次另一个 Web 服务作为监控心跳。
*   服务停止时调用第三个 Web 服务。

我们在我们的 Linux EC2 实例中使用它非常好，并且 Windows 服务在启动、检测信号和手动停止时运行良好。

问题是当通过 ElasticFox、Rightscale 等终止节点时，服务似乎永远不会停止，或者至少，它永远不会调用 Web 服务。有什么想法吗？

[请注意，这是从我在 AWS 开发人员论坛上的帖子逐字复制的，但与 SO 相比，这是超低流量。道歉！]

**编辑**：关于网络故障这一点，我也不是最精通 Windows 服务的人，如果我将 Netman 设置为服务依赖项，是否可以保证服务终止的顺序尊重这一点？

关于 EBS，我们为在普通 Linux 实例上运行的类似系统采用的模型将应用服务器视为短暂的，因此 EBS 不会给我们带来太多好处。我们在 EC2 之上使用 Rightscale，这使得连接到 Linux 实例的功能关闭，因此我们只需将实例的日志发送到其他地方。

**编辑#2**：嗯，我得到 AWS 工作人员的回复比我预期的要快得多：

> 对于 Windows，由于某些技术限制，通过 API（即通过 elasticfox、rightscale 等）终止是硬关机。这意味着它就像用电源按钮关闭机器而不是关机。

*有趣的..*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:16:30.433

当 Windows 关闭时会发生很多事情，所以我的猜测是您的 Web 服务调用需要的东西已经停止，首先猜测是网络连接。

这有点棘手，因为您无法在 C 或 D 驱动器上保留本地日志文件来检查调用是否至少尝试过，因为一旦实例停止，您将永远无法再次访问它们。您是否将 EBS 卷与可以保存日志文件的实例一起使用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-19T15:26:54.453

我使用新的 Windows EBS 根卷测试了启动和关闭组策略脚本。当您停止和启动这些实例时，这两个脚本都会在适当的序列中按预期运行。因此，另一种方法可能是使用 EBS 根卷运行您的实例并发出停止命令以确保 Windows 实例执行所有关闭序列。停止实例后，您应该能够终止实例并释放与其关联的任何 EBS 卷。

# user-interface - 图形用户界面并发

> ID：684032
> 
> 赞同：1
> 
> 时间：2009-03-26T00:05:34.487
> 
> 标签：user-interface

防止用户被这种“竞争条件”弄糊涂的最好方法是什么？

这可能是一个非常愚蠢的问题。

一个 GUI，带有一个窗口，支持对该窗口中对象的鼠标操作。例如，用户可以从 A -> B 移动、推送等一个对象。（这将对几台服务器产生影响，因此这是一个非常简单的操作）如果另一个用户已经对该对象做了一些事情，服务器将处理冲突和合并等。但我们的原始用户必须得到某种反馈，因为这可能在“同时”发生。（即User在一个线程中移动对象，Application在另一个线程中recv通知）

这与代码无关，即使有人可能会争辩说 recv 线程就像一个后端存储，并且在执行鼠标推/拖动时 GUI 可能是一个“锁”。

您认为您将对象放在 B 上，但它实际上出现在 B'，B''，C，D（或已经消失）。

我根本不喜欢 MessageBoxes，甚至不可能为每一件小事都弹出一个。不，当用户开始拖动对象时，您不能将对象锁定给用户。（想想消息传递）

也许可以使用一些动画让用户看到对象降落在 B 上，然后移动、动画到 B'、B''、C 或 D（或蒸发）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:20:13.217

我同意您不想在并发发生时在 GUI 中锁定（或显示模式消息）。我认为当用户不知道为什么会发生这种情况时，他们会感到非常沮丧。

我认为保持 GUI 响应（好像没有并发），然后当检测到冲突时，当您收到来自其他线程的响应时，您会更正 UI。我喜欢动画/蒸发效果，让用户知道他们的操作已被覆盖，也许用状态栏（或类似的不显眼的通知）消息来解释恢复的 GUI。

如果您可以在操作开始时添加一些消息，您可以提供一些额外的反馈（同样以一种不显眼的方式），即可能与其他用户发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T00:20:25.353

在这种情况下，我认为一条警告消息告诉用户正在发生的事情是唯一合适的行动方案。您可以通过动画 B 移动到其他地方（或消失）来使您的 GUI 变得活泼，但您要做的就是进一步混淆用户 - *“我不想把它移到那里！”* .

***编辑：***我应该补充一点，我喜欢动画的想法，更多的是我认为它本身还不够。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-01T01:43:55.797

我认为更大的问题是，为什么允许这样的行为？如果一个以上的用户可以做一些涉及大量时间的事情（在人类感知范围内），那么实时准确地描绘多个用户之间的交互将使事情变得非常复杂。

处理这种情况的更好方法是将对象视为只读的（因此没有并发问题），直到用户声称独占使用其中的一个或多个。那时，排他性锁定要么成功（此时用户可以进行任何必要的更改）要么失败（在这种情况下，用户将在状态栏中获得反馈，例如“对象 A、B、D、G保留供其他用户独家使用。”）。

# asp.net-mvc - 如何在不访问数据库的情况下对 asp.net mvc 基本控制器进行单元测试？

> ID：684037
> 
> 赞同：0
> 
> 时间：2009-03-26T00:09:38.720
> 
> 标签：asp.net-mvc, unit-testing

我一直在使用“穷人”依赖注入技术对控制器进行单元测试。每个控制器都从基本控制器继承以查询母版页的数据。如何在不访问数据库的情况下对从基本控制器继承的控制器进行单元测试？

```
public class HomeController : BaseController
{
    IUserRepository _userRepository;

    public HomeController() : this(new UserRepository()) {

    }

    public HomeController(IUserRepository userRepository) {
        _userRepository = userRepository;
    }
}

public class BaseController : Controller
{
    protected override void Execute(System.Web.Routing.RequestContext requestContext)
    {
        MyDataContext db = new MyDataContext();

        ViewData["masterPageData"] = db.GetSomeData();

        base.Execute(requestContext);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:50:14.207

代码看起来像这样：

```
public class HomeController : BaseController
{
    IUserRepository _userRepository;
    public HomeController() : this(new UserRepository()) { }
    public HomeController(IUserRepository userRepository) : base() {
        _userRepository = userRepository;
    }
    public HomeController(IUserRepository userRepository, ISomeRepository someRepository) : base(someRepository) {
        _userRepository = userRepository;
    }
}
public class BaseController : Controller
{
    ISomeRepository _someRepository;
    public BaseController(ISomeRepository someRepository)
    {
        _someRepository = someRepository;
    }
    public BaseController()
    {
        _someRepository = new SomeRepository();
    }
    protected override void Execute(System.Web.Routing.RequestContext requestContext)
    {
        MyDataContext db = new MyDataContext();
        ViewData["masterPageData"] = _someRepository.GetSomeData();
        base.Execute(requestContext);
    }
} 
```

也就是说，如果您使用 DI 框架，则每个类中只需要 1 个构造函数。所以你可以看到它是如何开始倾向于使用一个的:)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:25:39.337

可能通过在你的数据上下文上有一个接口并注入你的数据上下文然后实现一个接口的模拟，它返回你的数据而不访问数据库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T01:00:51.140

我会说问题是您的基本控制器使用不同的数据访问方法。更重要的是，BaseController 硬连接到 DataContext，这会导致可测试性问题。

如果 BaseController 需要从数据库中获取数据，为什么不在其中也使用存储库呢？如果完整的 IoC 容器不可用，您可以在继承的控制器中注入存储库依赖项并将其传递给 BaseController。

这样很容易为母版页数据创建模拟。

# html - 排除 IE6 + 7 仅错误消息

> ID：684044
> 
> 赞同：1
> 
> 时间：2009-03-26T00:13:32.983
> 
> 标签：html, internet-explorer

我已经建立了这个网站：[www.bgarchitect.co.nz](http://www.bgarchitect.co.nz)，这是一个学习 jQuery 和 CSS/xHTML 的经验，但也是一个真正的项目，因此应该在大多数浏览器中工作（IE6 仍然是一个问题，但 IE7 应该真的这里没有问题）。

让我非常恼火的是得到这个错误： [IE6+7 Only Error PopUp http://www.9d.co.nz/screengrabs/ie_error.png](http://www.9d.co.nz/screengrabs/ie_error.png)

这只发生在 IE 6 和 7 中。IE8 工作正常，webkit 和 mozilla 也是如此。

简单地说：我不知道在哪里寻找“第 8 行；字符 9”，因为 html 的来源只有第 8 行中的元标记。

由于我使用了一些 jQuery/java 脚本，我担心它可能是其中的一些东西，但是即使我弹出这个错误，这些脚本也可以正常工作。

非常感谢任何建议、想法或解决方案。感谢您阅读并感兴趣。

詹尼斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T00:17:03.023

您的 javascript 中某处有一个额外的逗号。

**编辑**：
这是额外的逗号，里面`jsLinkNudging.js`：

```
$('.categories img').hover(function() { //mouse in  
    $(this).animate({ 
        marginTop: "5px", <- remove comma here
    }, "fast");  
}, function() { //mouse out  
    $(this).stop().animate({ 
        marginTop: "10px", <- remove comma here
    }, "fast");  
}); 
```

照顾两个 marginTop 你有一个逗号但没有更多的属性。将它们都删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T00:16:30.013

转到工具-> Internet 选项-> 高级并取消选中“禁用脚本调试...”的两个框

然后，当您收到错误时，它会询问您是否要调试，然后您说是，它会启动 Visual Studio 并突出显示出错的确切位置。

[您可以在此处](http://www.microsoft.com/Express/)获取 Visual Studio Express 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T00:20:15.057

你也可以检查这个 IE only add-on [http://www.debugbar.com/](http://www.debugbar.com/) 它的行为很像萤火虫，也有一个控制台

# php - CodeIgniter 1.7 身份验证库

> ID：684051
> 
> 赞同：3
> 
> 时间：2009-03-26T00:15:50.483
> 
> 标签：php, authentication, codeigniter

我正在尝试为 CodeIgniter 1.7.x 查找身份验证库，但运气不佳。我最初发现这个堆栈**溢出**帖子：[我应该如何为 CodeIgniter 选择身份验证库？](https://stackoverflow.com/questions/346980/what-code-igniter-authentication-library-is-best)，其中列出了几个，但大多数都过于简单和/或为 CodeIgniter 1.5.x 设计

我玩过 FreakAuth、UserAuth、Redux 和其他几个，但在让它们中的任何一个正常工作时都遇到了问题。有谁知道与 CodeIgniter 1.7.x 一起使用的好库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:16:12.963

您是否尝试过[DX 身份验证](http://codeigniter.com/forums/viewthread/98465/)？它的功能非常齐全，可与 1.7 配合使用（在帖子中这么说，我亲自使用过）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-27T18:27:08.580

几个月前，我在寻找最简单的身份验证库，结果发现了“身份验证库”。它非常易于使用，作者有一个 CI-User_guide-type 来寻求帮助，而且它没有我在其他 auth 库中发现的任何臃肿。

你可以在这里找到它：http: [//programmersvoice.com/codeigniter/the-authentication-library-1-0-6](http://programmersvoice.com/codeigniter/the-authentication-library-1-0-6)

作者在 CI 板和他的 facebook/twitter 页面上对评论和帮助非常敏感。试试看，我已经在我的 1.7 应用程序中成功了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-29T07:46:28.893

万一其他人发现这个线程是我迄今为止发现的最好、最简单的身份验证库[TankAuth](http://www.konyukhov.com/soft/tank_auth/)。超级容易安装，并附带所有基本的身份验证示例（登录、注销、记住我、忘记密码等）。

编辑 - 显然 Tank_auth 是为了响应此处关于身份验证库应该做什么的另一个讨论的要求列表而创建的，因此值得研究。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-07T12:45:53.740

[Ion Auth](http://github.com/benedmunds/CodeIgniter-Ion-Auth)是目前更具吸引力的选择之一。它精简、广泛使用、积极维护并具有良好的功能集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T13:11:27.730

Redux 2 beta 是为 1.7 构建的，但很明显，它仍处于 beta 阶段。

这里有一个关于这个话题的大讨论：

[我应该如何为 CodeIgniter 选择认证库？](https://stackoverflow.com/questions/346980/what-code-igniter-authentication-library-is-best)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T18:52:27.893

我已经在一个 CI 1.7 小型项目上成功测试了 Redux2 Beta。没有问题，代码很容易理解（不需要进一步的文档）。我很期待最终版本。

# .net - 从构建顺序中删除设置项目

> ID：684055
> 
> 赞同：2
> 
> 时间：2009-03-26T00:16:43.727
> 
> 标签：.net, visual-studio-2008, build, installation

我们的开发环境中有 15 个项目。有些是测试项目，大多数是库，有些是可以实际运行的“最终”可执行文件，有些是设置项目。

大多数时候，我只想构建那些“最终”的可执行文件及其各自的库，并让安装项目仅在我们进行构建时运行（而且，在大多数情况下，这应该只由无论如何，持续集成服务器）。不幸的是，现在单击“开始/继续”似乎也构建了设置项目，这是我不希望发生的（它非常慢，真的让我们慢下来）。

重申一下：我可以构建得很好，它只会构建到适当的点。但是，如果我选择开始/继续，即使我不在安装项目中，也会构建安装项目。

那么如何从构建树中删除我的设置项目？它们在构建顺序中，但它们不是依赖项，也不是任何包含项目的依赖项。为什么他们甚至被建造？

这是 vs2008（带有全新的 WiX 安装程序，v 3.0.5120）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:24:33.190

在构建菜单下选择“配置管理器...”。取消选中您不想构建的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:23:46.767

在解决方案属性下，您可以选择一个配置（或制作一个），然后关闭这些项目的“构建”切换。

这样，您可以有两种配置：“调试”和“使用构建项目进行调试”。

* * *

为此，请右键单击解决方案，选择属性、配置属性。如果要进行新配置，请选择“配置管理器...”并创建新配置，否则只需编辑当前配置之一（可能是调试）。

在配置属性/配置下，您可以准确选择默认构建的项目。

# php - jquery $.GET 多次调用

> ID：684058
> 
> 赞同：1
> 
> 时间：2009-03-26T00:17:17.843
> 
> 标签：php, jquery, ajax

我正在学习 jquery 并写了这个，所以我可以对一个 php 文件执行两个单独的 $.GET，检索一些信息并对其进行一些计算。我知道我可以创建一个特定的 php 文件来执行所有操作并返回我需要的值，但我认为在我需要检索信息的任何时候重用这个 php 文件会更有意义。

我在一个函数中有这个，我不确定如何执行第一个 $.GET，等待它完成，将它附加到一个变量，然后执行第二个 $.GET，将变量传递给它并进行计算。相反，我将它们嵌套在一起，我认为这是不正确的。这是代码。

```
 $.get("selectdb.php", { 'id':nsname, 'q':'basecomplexity','table':'switchers'  }, function(data)
    {

        $('#switchtotal'+lastIndex).html(data); //sets data to #switchtotal

        $.get("selectdb.php", { 'id':nsname, 'q':'sources','table':'switchers'  }, function(data)
        {
            var val1 = $('#switchtotal'+lastIndex).html();
            var answer = ((parseFloat(nszones)*parseFloat(data))+parseFloat(val1))*parseFloat(nsquant);
            $('#switchtotal'+lastIndex).html(answer.toFixed(2)); //calculates formula and displays

        });

    }); 
```

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T02:12:39.687

您必须将它们嵌套在某个级别。

由于 Ajax 的异步特性（ A = Asynchronous ），没有办法真正停止代码¹。所以你必须在回调中进行处理。

最好的方法是实现一个在回调中调用的函数，因此它们不是嵌套的，但逻辑仍然是嵌套的。

```
jQuery(function($){ 

function dbselect( opts, callback ){ 
   $.get("select.php", opts, callback ); 
}

function  handle_sources( data ){ 
   var val1 = $('#switchtotal'+lastIndex).html();
   var answer = ((parseFloat(nszones)*parseFloat(data))+parseFloat(val1))*parseFloat(nsquant);
   $('#switchtotal'+lastIndex).html(answer.toFixed(2)); //calculates formula and displays
}
function handle_basecomplex ( data ){ 
     $('#switchtotal'+lastIndex).html(data); //sets data to #switchtotal
     dbselect( { 'id':nsname, 'q':'sources','table':'switchers'  } , handle_sources ); 
}

dbselect( { 'id':nsname, 'q':'basecomplexity','table':'switchers'  }, handle_basecomplex ); 

}); 
```

[1.你可以，使用同步模式，但这很讨厌，它会停止*一切*]

# .net - 在我的 ASP.NET 应用程序中是否有一种简单的方法可以以编程方式找出 mysql db 服务器是否已关闭？

> ID：684063
> 
> 赞同：1
> 
> 时间：2009-03-26T00:20:18.210
> 
> 标签：.net, asp.net, mysql

我在我的 ASP.NET 应用程序中使用 MySQL（使用 MySQL .NET 连接器），是否可以通过编程方式检查数据库服务器是否已关闭？我遇到了 MySQLConnection.Ping() 但不幸的是，它不能正常工作（必须首先使用 Open() 打开连接，即使数据库服务器再次可用，它也会继续返回 false ）。我想出的唯一解决方案是使用 Open() 方法，如果抛出异常则数据库服务器不可用，是否有更可靠的方法来做到这一点？我在某处读到，如果使用连接池，使用 Open() 可能无法按预期工作，即使数据库服务器已启动，这也可能导致抛出异常。

如果您想了解详细信息，请继续阅读：

在我的应用程序中，我记录了所有异常（首先我尝试将它们记录到数据库服务器 - 可能是同一个已关闭但可能不是的数据库服务器，具体取决于配置 - 如果失败，异常将记录到文本文件中） . 现在我想处理如果数据库服务器关闭的情况，通常会发生的情况是几乎每个对我的应用程序的请求都会继续抛出异常，这意味着日志将充满这些异常，另一个问题是我将继续为用户提供错误页面（或者换句话说，用户将继续看到他们对应用程序发出的每个请求的错误页面），我想要做的是如果抛出 db 异常（即键入 MySQLException) 以检查 DB 服务器是否已启动，如果不是，则更改我的应用程序中的某些标志并提供包含应用程序暂时不可用之类的页面（该标志在 httpModule 中检查并重定向或传输到该页面）。我还计划让它使用 SMS 代理向我发送 SMS，以便我可以采取行动，但这是另一个故事，与这个问题无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T01:14:58.547

```
try {
    cmd.ExecuteNonQuery();
    // server is up
}
catch { 
    // server is down
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T02:03:13.610

也许您可以尝试连接原始 TcpClient，即。只需尝试连接并断开连接。尽管这并不能解决您抛出异常的问题。

```
try{
 TcpClient _socket = new TcpClient();
 _socket.Connect(host, port);
 _socket.Close();
}
catch (System.Net.Sockets.SocketException ex)
{
    if (ex.SocketErrorCode == System.Net.Sockets.SocketError.ConnectionRefused //Process down
        || ex.SocketErrorCode == System.Net.Sockets.SocketError.HostDown //Server turned off
        || ex.SocketErrorCode == System.Net.Sockets.SocketError.TimedOut //Not responding
       )
    {
      //=> offline mode
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T00:28:45.303

我喜欢这个解决方案.. [http://forums.asp.net/p/1066040/1542583.aspx](http://forums.asp.net/p/1066040/1542583.aspx)

> 我的解决方案是有两个连接。一个超时时间很短，我用于测试，另一个正常。我首先给短时间的一个虚拟呼叫。如果失败，我会显示不是来自数据库的内容，否则，我会正常进行。这样用户就不会看到错误页面。

诀窍是确保超时在“快乐”范围内。几秒钟应该在一个体面的环境中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T00:33:10.753

我见过的一个解决方案适用于这样的事情（从技术上讲，我们用 C# 连接到 SQL Server 数据库，但在短暂使用过 MySQL 连接器后，我相信它们的工作原理大致相同）我们所拥有的是一个单一的位置，其中连接已创建并打开。在这一种方法中，我们将 SQLException（为你的 MySQLException）包装在一个特殊的“嘿，数据库是 borked”异常中。然后在异常处理程序/记录器中，您可以检查您的特殊异常，并在数据库关闭时执行您需要执行的任何操作。

这里的想法是不必编写一堆额外的代码来检查以确保在每次调用之前数据库都在那里并且正常工作，而是确保当发生不好的事情时你知道数据库是罪魁祸首并且可以妥善处理。

# .net - 身份验证模式.Net

> ID：684069
> 
> 赞同：3
> 
> 时间：2009-03-26T00:23:32.057
> 
> 标签：.net, asp.net

我计划创建一个组件，该组件将能够检查用户的凭据（用户名和密码），如果它们有效，则返回关联的配置文件。我不想使用 .Net 框架中已经存在的提供程序（我正在尝试锻炼我的开发技能）。有什么我可以使用的模式吗？还是标准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T00:37:22.910

.Net 提供的提供者都派生自 System.Web.Security.MembershipProvider。

您可以遵循的最佳模式是编写您自己的派生自[Membership provider](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)的类。这样您就可以编写自己的身份验证机制，而不必担心检查每个请求的身份验证所涉及的安全管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T05:44:34.840

会员提供者非常好，即使您使用它们，您也绝对可以锻炼您的开发技能。但是您将开发除用户身份验证/配置文件服务之外的 *其他东西！。*

如果你真的想自己滚动它，你需要一个用户名和密码哈希的存储。用户注册时，让他们输入密码，然后对其进行哈希处理。将用户名和密码*哈希*存储在您选择的任何存储中。然后，当用户登录时，您对他们提供的密码进行哈希处理，并根据存储的哈希进行检查。

对于最简单的情况，您可以只使用包含元素列表的 XML 文件，每个用户一个元素，然后您可以使用 XmlSerialization 将其插入并保存。

```
<UserDB>
  <user>
    <name>Obsidian</name>
    <pwhash>8731876r4hndmhduihd</pwhash>
    <dateadded>2009-03-25-18:34:44</dateadded>
 </user>
</UserDB> 
```

但您也可以使用数据库或 AD/AM 或其他存储。

# firefox - 在没有 current() 的情况下获取当前节点和另一个节点之间的所有节点？

> ID：684078
> 
> 赞同：0
> 
> 时间：2009-03-26T00:31:01.070
> 
> 标签：firefox, xpath, greasemonkey

我正在研究一个 Greasemonkey 脚本，该脚本需要在其他两个节点之间的每个节点上运行。目前，我正在使用（越来越复杂的）XPath 表达式获得第一个节点。我有另一个表达式来获取“中间”节点，但它包含两次初始表达式并且变得相当长。这是一个仅包含两个“子句”的早期版本：

```
var xpHeader   = "//h2[a/@name='section-References' or a/@name='References']";
var xpContents = "//h2[a/@name='section-References' or a/@name='References']/following-sibling::*[following-sibling::h2[1] = //h2[a/@name='section-References' or a/@name='References']/following-sibling::h2[1]]" 
```

我正在寻找的是一种基于上下文节点选择“内容”的方法，而不是多次重新包含原始表达式——“标题”表达式将很快变得相当复杂。我知道这可以在 XSLT 中使用该`current()`函数来完成，但当然这在 vanilla XPath 中不可用：

```
<xsl:template match="//h2[a/@name='section-References' or a/@name='References']">
    <xsl:for-each select="following-sibling::*[following-sibling::h2[1] = current()/following-sibling::h2[1]]">
        <!-- do stuff -->
    </xsl:for-each>
</xsl:template> 
```

当我键入此内容时，我突然想到，此时使用 DOM 收集内容可能比 XPath 更容易，但我仍然很想知道这是否可以完成。

该脚本的原始版本[可在 UserScripts.org 上找到](http://userscripts.org/scripts/review/45205)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T02:57:24.527

Although you're writing XPath expressions, to Javascript, they're just strings. You can concatenate strings.

```
var xpContents = xpHeader + "/following-sibling::*["
  + "following-sibling::h2[1] = " + xpHeader + "/following-sibling::h2[1]"
  + "]"; 
```

Now your header expression can get as complicated as you want without affecting the complexity of the assignment of content expression. The XPath evaluator will still have to parse the whole string, and if there is no optimization of the query, then it may get evaluated multiple times, but even that might be fast enough that it doesn't matter.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T19:14:07.643

一旦您使用 XPath 在该级别收集内容，听起来使用 DOM 会更容易一些。假设您不使用任何框架，则类似于：

```
var nodes = document.evaluate("//h2[a/@name='section-References' or a/@name='References']/following-sibling::*", document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);
var contents=[];
if (nodes.snapshotLength>0) contents.push(new Array());
var currentGroup=0;
for (var i=0;i<nodes.snapshotLength;i++) {
  if (nodes.shapshotItem(i)==<your favorite way to detect the right flavor of h2 element>) {
    currentGroup++;
    contents.push(new Array());
    continue;
  }
  contents[currentGroup].push(nodes.snapshotItem(i));
} 
```

这有点冗长，但最终会在有趣的 h2 节点之间得到一组项目数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T18:20:19.393

您可以使用 jQuery 或其他 JavaScript 框架来更轻松地使用 DOM。

例子：

```
// ==UserScript==
// @name           MyScript
// @namespace      http://example.com
// @description    Example
// @include        *
//
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js
// ==/UserScript==

$('h2[some crazy attributes...]').each(function() {
  // Do something
}); 
```

有关通过 XPath 属性选择和遍历 DOM 元素的更多信息，请查看 jQuery 参考。

[jQuery 选择器](http://docs.jquery.com/Selectors)

[jQuery 遍历](http://docs.jquery.com/Traversing)

[jQuery 下一个（）](http://docs.jquery.com/Traversing/next#expr)

[jQuery nextAll()](http://docs.jquery.com/Traversing/nextAll#expr)

# java - 将 SSL 证书导入 Eclipse

> ID：684081
> 
> 赞同：40
> 
> 时间：2009-03-26T00:35:22.650
> 
> 标签：java, eclipse, ssl, ssl-certificate

如何将 java 创建的 SSL 证书导入到 Eclipse 中的项目中？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-26T09:20:57.550

可能您想在 JRE 的 trustcacerts 中导入“假” SSL 证书以避免无效证书问题。不是吗？

正如乔恩所说，您可以使用[keytool](http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html)完成这项工作：

```
keytool
    -import
    -alias <provide_an_alias>
    -file <certificate_file>
    -keystore <your_path_to_jre>/lib/security/cacerts 
```

询问时使用“changeit”作为默认密码（[感谢 Brian Clozel](https://stackoverflow.com/questions/684081/importing-ssl-certificate-into-eclipse#comment2400032_685036)）。确保在您的服务器上使用此运行时或启动配置。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2021-01-19T15:25:04.957

如果您的 Windows 证书存储中已经有证书（这在使用 MITM 证书的公司部署中很常见），您还可以使用以下步骤（在[另一个 Stackoverflow 答案的帮助下，提供更详细的解释](https://stackoverflow.com/a/49011158/12932497)）：

1.  `eclipse.ini`在 Eclipse 安装中找到该文件并打开它

2.  在该行下方`-vmargs`，添加以下行，然后保存文件：

```
-Djavax.net.ssl.trustStore=NUL
-Djavax.net.ssl.trustStoreType=Windows-ROOT 
```

3.  重启日食。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-11-28T07:17:42.577

有一个更好的工具来完成这项工作。

[密钥库资源管理器](https://keystore-explorer.org/index.html)

当您运行（在 Windows 中以管理员身份运行以保存对系统的更改，在 linux 中使用 sudo 等）应用程序（它具有 win/mac/linux 的安装程序）时，有一个内置功能可以编辑系统的 cacerts 文件：

文件 -> 特殊打开 -> 打开 CA 证书

[![开放 CA 证书](https://i.stack.imgur.com/XNScI.png)](https://i.stack.imgur.com/XNScI.png)

**您**已经拥有证书文件，您可以访问：

工具 -> 导入可信证书

**或者**您需要从服务器下载证书；去：

检查 -> 检查 SSL

[![检查菜单](https://i.stack.imgur.com/acQKj.png)](https://i.stack.imgur.com/acQKj.png)

[![检查 SSL](https://i.stack.imgur.com/Gi7mU.png)](https://i.stack.imgur.com/Gi7mU.png)

从那里输入主机名，然后单击确定。它将弹出一个显示证书详细信息的窗口。在该窗口的底部有一个“导入”按钮，可让您直接将其导入 cacerts。

[![SSL 连接的证书详细信息](https://i.stack.imgur.com/jmZNn.png)](https://i.stack.imgur.com/jmZNn.png)

确保保存并关闭 cacerts，然后重新启动 eclipse/应用程序以使设置生效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-28T13:24:58.427

我们需要导入证书意味着我们需要使用：

```
keytool 
 -importcert 
 -file <certificate_location> 
 -keystore <jre_location\lib\security\cacerts> 
 -alias "<cert_name>" 
```

它会要求输入密码。输入密码为`changeit`

```
Type Password : changeit 
```

最后它会询问需要添加 {yes/no} ：

输入是。

注意：不要在位置路径中给出空格

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-07T07:09:49.773

如果您有默认的 Java 设置并提供了 Java 类路径，那么您必须使用 Java 信任库来获取 SSL 证书。

为此，您可以按照以下步骤将证书导入信任库：

1.  导航到 Java 设置的 JRE\bin 文件夹 理想情况下，路径应该是：

> 用户\Java\jre1.8.0_221\bin

2.  您将能够在 bin 文件夹中找到 Keytool（将用于运行命令）：

[定位 Keytool 的路径](https://i.stack.imgur.com/zGams.jpg)

3.  现在，一旦您在此路径上，请在 CMD 提示符下打开该路径：

[CMD中的bin文件夹](https://i.stack.imgur.com/FtQOI.jpg)

4.  现在您将能够在以下路径中找到 Java 的默认信任库：路径-

> 用户\Java\jre1.8.0_221\bin

[Java 默认信任存储的路径](https://i.stack.imgur.com/XcMhV.jpg)

5.  现在您可以运行以下命令来查看此信任存储的内容：

    keytool -list -v -keystore "C:\Program Files\Java\jre1.8.0_221\lib\security\cacerts"

注意：如果您的信任存储路径中有空格，那么您需要在路径中使用双引号。否则，您可以提供如下路径：

```
keytool -list -v -keystore C:\Temp\Java\jre1.8.0_221\lib\security\cacerts 
```

现在只需向 Trust Store 提供密码（默认密码为：changeit）： [Accessing Trust store using Keytool](https://i.stack.imgur.com/ReNH1.jpg)

6.  您现在可以根据需要将任何证书添加到信任库：

    JRE_HOME/bin/keytool -import -trustcacerts -alias certAlias -file certFile -keystore trustStoreFile

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-13T16:45:08.163

## 苹果电脑

1.  打开**Keychain Access.app**（快捷方式：按 Command + 空格键并键入 Keychain）
2.  搜索所需的证书文件（例如`example.cer`）并右键单击 ➡️ 选择**导出...** ➡️ 将其保存到某个位置，例如`Desktop`.
3.  按照[此答案](https://stackoverflow.com/a/66889979/10819573)中的说明将其导入您的 Java 证书存储。重要的命令是：

```
cd $JAVA_HOME/lib/security
sudo cp cacerts cacerts.bak
sudo keytool -importcert -alias youralias -file ~/Desktop/example.cer -keystore cacerts 
```

密钥库的默认密码是：`changeit`.

4.  假设，`$JAVA_HOME/lib/security`指向`/Library/Java/JavaVirtualMachines/adoptopenjdk-15.jdk/Contents/Home/lib/security`您的系统，在文件中添加以下行`eclipse.ini`：

```
-Djavax.net.ssl.trustStore=/Library/Java/JavaVirtualMachines/adoptopenjdk-15.jdk/Contents/Home/lib/security/cacerts
-Djavax.net.ssl.trustStorePassword=changeit 
```

**注意：**如果您使用的是 STS，请按照[此答案](https://stackoverflow.com/a/68775329/10819573)查找`.ini`文件。

5.  重新启动 Eclipse。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T01:37:18.023

您可能应该创建证书并使用 keytool 将其导入默认密钥库。我不确定您要对您的应用程序做什么，但它应该能够使用该证书。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-29T06:16:28.517

```
sudo  keytool -import  -file /Users/balaji-pt2176/Desktop/Apple\ Worldwide\ Developer\ Relations\ Certification\ Authority.cer  -keystore /Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home/jre/lib/security/cacerts 
```

在麦克

# javascript - AOL 网站上的 dojo.charting 库在哪里？

> ID：684087
> 
> 赞同：0
> 
> 时间：2009-03-26T00:40:17.227
> 
> 标签：javascript, dojo

我正在测试道场图表库。我更喜欢使用 AOL 网页中的库，而不是将 dojo 安装到我的计算机中。我有以下代码：

```
<script
  type="text/javascript"
  src="http://o.aolcdn.com/dojo/1.2/dojo/dojo.xd.js">
</script>
<script type="text/javascript">
    dojo.require("dojox.gfx");
    dojo.require("dojox.gfx.move");
    dojo.require("dojo.charting.*");
... 
```

我收到一条错误消息，提示“未捕获的异常：无法加载跨域资源：dojo.charting。*”。我猜我的 dojo 库的 url 可能没有 dojo.charting。*. 有谁知道正确的网址是什么？有什么方法可以浏览 AOL 网站以找出可用的图书馆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:47:30.157

你试过用`dojox.charting`吗？而不是`dojo.charting`-注意'dojo'中缺少x？

编辑：美国在线关于道场的发行说明没有提到图表...我怀疑你可能在这里独自一人。此链接提到 AOL 的 1.2.x 版本与其 0.4.2 版本相同，其中列出了他们的[http://dev.aol.com/dojo](http://dev.aol.com/dojo) API 内容（不包括图表）。如果您需要，可以在其他地方托管图表，方法是添加一个后续`<script>`标签，并为您需要的图表组件使用不同的 URL。或者...也许 AOL 不是适合您的 CDN 主机：将您的云移动到其他地方 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T06:04:03.860

首先就像Jarret 说的：dojox.charting。

其次：“通配符加载”自 Dojo 0.4 以来已过时。你不能再使用 dojo.require("some.package.*") 了。你必须明确你需要什么。

你能做的最好的事情就是点击[图表文档](http://docs.dojocampus.org/dojox/charting)和[测试](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/charting/tests/)，看看如何根据你的特定需求来做这件事——你没有给出任何关于你实际尝试做什么的提示。

# php - 命名可能意味着 3 种不同事物的参数的最佳实践

> ID：684088
> 
> 赞同：1
> 
> 时间：2009-03-26T00:40:29.940
> 
> 标签：php

考虑一下...我正在编写一个名为 Cache 的类，它将接受文件/url的路径或字符串。我将使用 PHP 的函数，例如`parse_url()`和`is_file()`来确定我收到的输入。

这是我的例子，在 PHP

```
class Cache {
    public function __construct($pathUriOrString) {

    }
} 
```

命名这个论点的最佳实践是什么？这甚至是创建类的有效方法，还是应该是基类并具有扩展它的单独类？

我从[php 图像](http://code.google.com/p/php-image/)中得到了这个想法，其中构造接收一个参数（路径）或 2 个参数（宽度和高度）。

那么，我是否走在正确的轨道上，如果是这样，命名接受不同输入的参数的最佳实践是什么（并且不会混淆其他开发人员？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T01:00:46.630

您是否可以调用变量 $resourcelocation 并相应地记录它，即它应该采用文件路径、uri 路径或字符串。我认为调用变量 aOrB 不是一个好习惯，它应该是通用的。

您可以通过检查函数的输入以了解它是什么类型以及它是否有效来改进这一点。如果它不匹配任何支持的参数类型，那么您应该为非法参数抛出错误。

类声明很好（但缺少一个左括号）顺便说一句......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T01:09:07.703

最好将其子类化两次，一次用于字符串，另一次用于 url。如果用户输入其中一个，则重构以便他们必须指定。（如果不是，那么大概您的应用程序知道它正在处理的内容 - 明确传递它所知道的内容。）尝试设计出这种歧义。

我不想问，但它可能意味着的第三件事是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T01:03:56.827

嗯，您的意思是该类将缓存文件/URL 引用的资源的内容，还是字符串的值？我会担心打算缓存一个*看起来*像文件或 URL 的字符串。或打算缓存格式错误的文件/URL，并将其视为通用字符串。

我认为一般来说，让一个参数完成两项工作是一种设计实践，可能会让未来的生活变得困难。

就个人而言，我倾向于添加第二个参数来指示第一个参数是什么。或子类。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-26T00:56:47.793

在某些地方，前缀“e”用于“变量类型”。

```
# eArg can be one of 3 things:
# 1\. ...
# 2\. ...
# 3\. ...
function somethign($eArg)
{

} 
```

# c# - 创建缩略图并减小图像尺寸

> ID：684092
> 
> 赞同：8
> 
> 时间：2009-03-26T00:43:07.717
> 
> 标签：c#, file, image, size, image-scaling

我有非常大的图像（jpg），我想编写一个 csharp 程序来循环文件并将每个图像的大小减少 75%。

我试过这个：

```
Image thumbNail = image.GetThumbnailImage(800, 600, null, new IntPtr()); 
```

但文件大小仍然很大。

无论如何创建缩略图并让文件大小更小？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-26T01:13:23.107

```
private void CompressAndSaveImage(Image img, string fileName, 
        long quality) {
    EncoderParameters parameters = new EncoderParameters(1);
    parameters.Param[0] = new EncoderParameter(Encoder.Quality, quality);
    img.Save(fileName, GetCodecInfo("image/jpeg"), parameters);
}

private static ImageCodecInfo GetCodecInfo(string mimeType) {
    foreach (ImageCodecInfo encoder in ImageCodecInfo.GetImageEncoders())
        if (encoder.MimeType == mimeType)
            return encoder;
    throw new ArgumentOutOfRangeException(
        string.Format("'{0}' not supported", mimeType));
} 
```

用法：

```
Image myImg = Image.FromFile(@"C:\Test.jpg");
CompressAndSaveImage(myImg, @"C:\Test2.jpg", 10); 
```

这将以 10 的质量压缩 Test.jpg 并将其保存为 Test2.jpg。

**编辑：**作为扩展方法可能会更好：

```
private static void SaveCompressed(this Image img, string fileName, 
        long quality) {
    EncoderParameters parameters = new EncoderParameters(1);
    parameters.Param[0] = new EncoderParameter(Encoder.Quality, quality);
    img.Save(fileName, GetCodecInfo("image/jpeg"), parameters);
} 
```

用法：

```
Image myImg = Image.FromFile(@"C:\Test.jpg");
myImg.SaveCompressed(@"C:\Test2.jpg", 10); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:24:21.383

[ImageMagick](http://www.imagemagick.org/script/index.php)是一个命令行工具，对于图像处理来说非常强大。在源图像的纵横比未知或不可靠的情况下，我使用它来调整大图像的大小和创建缩略图。ImageMagick 能够将图像调整为特定的高度或宽度，同时保持图片的原始纵横比。如果需要，它还可以在图像周围添加空间。总而言之，它非常强大，是一个很好的抽象，无需处理 .net 图像 API。要在 C# 中使用 imageMagick 命令行工具，我建议使用 System.Diagnostics.ProcessStartInfo 对象，如下所示：

```
ProcessStartInfo psi = new ProcessStartInfo();
psi.FileName = @"C:\Program Files\ImageMagick-6.5.0-Q16\convert.exe";
psi.UseShellExecute = false;
psi.RedirectStandardOutput = true;
psi.RedirectStandardError = true;
psi.Arguments = string.Format("-size x{0} \"{1}\" -thumbnail 200x140 -background transparent -gravity center -extent 200x140 \"{2}\"", heightToResizeTo, originalTempFileLocation, resizedTempFileLocation);

Process p = new Process();
p.StartInfo = psi;
p.Start();
p.WaitForExit(); 
```

使用 scale% 参数，您可以轻松地将图像大小减小 75%

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T00:47:24.230

压缩你的图像。对于缩略图，JPEG 就足够了，因为您不是在寻找质量。

```
Image thumbNail = image.GetThumbnailImage(800, 600, null, new IntPtr());

thumbNail.Save(fileName, ImageFormat.Jpeg); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T01:17:45.247

来自[`GetThumbnailImage`](http://msdn.microsoft.com/en-us/library/system.drawing.image.getthumbnailimage.aspx)的文档：

> 如果 Image 包含嵌入的缩略图图像，则此方法检索嵌入的缩略图并将其缩放到请求的大小。如果 Image 不包含嵌入的缩略图图像，则此方法通过缩放主图像来创建缩略图图像。

我建议您使用较小的宽度和高度值。尝试：

```
// reduce the size of each image by 75% from original 800x600
Image thumbNail = image..GetThumbnailImage(200, 150, null, IntPtr.Zero); 
```

请参阅[示例](http://www.csharp-station.com/Articles/Thumbnails.aspx)代码。

另请阅读文档：

> 当请求的缩略图图像的大小约为 120 x 120 像素时，GetThumbnailImage 方法工作得很好。如果您从具有嵌入式缩略图的图像中请求较大的缩略图图像（例如，300 x 300），则缩略图图像的质量可能会明显下降。通过调用 DrawImage 方法来缩放主图像（而不是缩放嵌入的缩略图）可能会更好。

我想你可能想看看缩放 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-27T03:07:25.383

这种方法对我帮助很大。图像尺寸小，保持纵横比

```
 ShellFile shellFile = ShellFile.FromFilePath(ImageWithPath); //original image path
 Bitmap shellThumbSmall = shellFile.Thumbnail.ExtraLargeBitmap; //change image size
 shellThumbSmall.Save(ImageWithPathThumbnail, ImageFormat.Jpeg); // new image path and format 
```

这些是需要的

```
PM> Install-Package WindowsAPICodePack-Core
PM> Install-Package WindowsAPICodePack-Shell

using Microsoft.WindowsAPICodePack.Shell;
using Microsoft.WindowsAPICodePack; 
```

# mysql - 孪生值的 MySQL“in”

> ID：684096
> 
> 赞同：1
> 
> 时间：2009-03-26T00:45:56.760
> 
> 标签：mysql

我知道查询语法：

```
SELECT fields FROM table WHERE value in (1,2,3,4) 
```

但是我有两个值（x 和 y），我可以为它们使用“in”语法还是必须使用我以前使用的 in 并拥有大量 WHERE 条件：

```
SELECT fields FROM table WHERE (x = 1 AND y = 2) OR (x = 3 AND y = 4) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T00:54:00.327

**我相信这就是您正在寻找的...**

```
WHERE (1,2) IN ((1,2), (3,4)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T00:50:37.887

如果 y 总是小于 1000，你可以这样做：

```
SELECT fields FROM table
WHERE x*1000+y in (1002,3004) 
```

这有点hackish，但可以做你想要的吗？

# .net - .NET 的降价？SO如何即时渲染它？

> ID：684104
> 
> 赞同：10
> 
> 时间：2009-03-26T00:51:02.660
> 
> 标签：.net, asp.net, javascript, markdown

我刚刚进入 Markdown 并认为这是蜜蜂的膝盖。我在 ASP.NET (MVC) 中工作，想知道是否有任何适用于 Markdown 的好的 .NET 库，并且我也很好奇 SO 如何动态呈现它。它必须是一个 JavaScript 库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T00:54:58.360

StackOverflow 使用[**Attacklab**](http://attacklab.net/)的[**WMD**](http://wmd-editor.com/)，一个 Markdown 编辑器。它负责所有即时渲染。这是 StackOverflow 页面源代码中的相关代码片段，它具有样式魔法。

```
 var jWmd = $("#wmd-input");
    jWmd.not(".processed").TextAreaResizer();
    jWmd.typeWatch( { highlight:false, wait:5000, captureLength: 5, callback:styleCode } );
    jWmd.rules("add", { required: true, minlength: 10 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T15:01:24.183

大规模杀伤性武器似乎不再活跃。

它已被一个名为 PageDown 的项目所取代。它可以在 StackOverflow 的 GitHub 存储库中找到：[https ://github.com/balpha/pagedown](https://github.com/balpha/pagedown)

另请参阅 SO 项目的完整列表：http: [//stackexchange.github.io/](http://stackexchange.github.io/)

参考：[https ://meta.stackexchange.com/a/71825/134729](https://meta.stackexchange.com/a/71825/134729)

# sql - 在 SQL Server 中查找最小的未使用数

> ID：684106
> 
> 赞同：45
> 
> 时间：2009-03-26T00:52:10.130
> 
> 标签：sql, sql-server, gaps-and-islands

如何在 SQL Server 列中找到最小的未使用数字？

我即将从 Excel 中将大量手动记录的记录导入到 SQL Server 表中。它们都有一个数字 ID（称为文档编号），但由于不再适用的原因，它们没有按顺序分配，这意味着从现在开始，当我的网站记录新记录时，它需要为其分配尽可能小的文档编号（大于零）尚未采取。

有没有办法通过普通的 SQL 来做到这一点，或者这是 TSQL/代码的问题？

谢谢！

**编辑**

特别感谢[WW](https://stackoverflow.com/questions/684106/find-the-smallest-unused-number-in-ms-sql/684176#684176)提出并发问题。鉴于这是一个 Web 应用程序，它根据定义是多线程的，任何面临同样问题的人都应该考虑使用代码或数据库级别的锁来防止冲突。

**LINQ**

仅供参考 - 这可以通过 LINQ 使用以下代码完成：

```
var nums = new [] { 1,2,3,4,6,7,9,10};

int nextNewNum = (
    from n in nums
    where !nums.Select(nu => nu).Contains(n + 1)
    orderby n
    select n + 1
).First(); 
```

nextNewNum == 5

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-03-26T01:14:33.633

查找不存在 Id + 1 行的第一行

```
SELECT TOP 1 t1.Id+1 
FROM table t1
WHERE NOT EXISTS(SELECT * FROM table t2 WHERE t2.Id = t1.Id + 1)
ORDER BY t1.Id 
```

编辑：

为了处理现有的最低 id 不是 1 的特殊情况，这是一个丑陋的解决方案：

```
SELECT TOP 1 * FROM (
    SELECT t1.Id+1 AS Id
    FROM table t1
    WHERE NOT EXISTS(SELECT * FROM table t2 WHERE t2.Id = t1.Id + 1 )
    UNION 
    SELECT 1 AS Id
    WHERE NOT EXISTS (SELECT * FROM table t3 WHERE t3.Id = 1)) ot
ORDER BY 1 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-26T01:13:13.557

如果您按数字 ID 对它们进行排序，您要查找的数字将是第一个 ROW_NUMBER() 函数不等于 ID 的数字。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-26T01:20:52.057

到目前为止，在任何答案中都没有提到锁定或并发。

考虑这两个用户几乎同时添加一个文档：-

```
User 1                User 2
Find Id               
                      Find Id
Id = 42               
                      Id = 42
Insert (42..)  
                      Insert (42..)
                      Error! 
```

您要么需要：a) 处理该错误并再次绕过循环寻找下一个可用 ID，或者 b) 在流程开始时锁定，以便在特定时间只有 1 个用户在寻找 Id

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-26T01:15:52.303

```
SELECT TOP 1 t1.id+1
FROM mytable t1
 LEFT OUTER JOIN mytable t2 ON (t1.id + 1 = t2.id)
WHERE t2.id IS NULL
ORDER BY t1.id; 
```

这是使用@Jeffrey Hantlin 和@Darrel Miller 给出的相关子查询的答案的替代方案。

但是，您描述的策略确实不是一个好主意。ID 值应该是唯一的，但不应要求是连续的。

如果您通过电子邮件向某人发送文档 #42 的链接，然后删除该文档，会发生什么情况？稍后，您将 id #42 重新用于新文档。现在电子邮件的收件人将点击*错误文档*的链接！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-08-27T10:39:49.660

```
declare @value int

select @value = case 
                  when @value is null or @value + 1 = idcolumn 
                    then idcolumn 
                  else @value end
   from table
   order by idcolumn

select @value + 1 
```

是否进行 1 次表扫描而不是 2 次扫描哈希匹配和连接，如最佳答案

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-26T01:12:02.890

如果序列中有间隙，您可以通过以下方式找到第一个间隙：

```
select top 1 (found.id + 1) nextid from (select id from items union select 0) found
    where not exists (select * from items blocking
                          where blocking.id = found.id + 1)
    order by nextid asc 
```

换句话说，找到后继者不存在的最小ID，并返回该后继者。如果没有间隙，则返回比现存最大 ID 大 1 的值。插入占位符 ID 0 以确保考虑以 1 开头的 ID。

请注意，这至少需要 n log n 时间。

Microsoft SQL 允许在语句中使用`from`子句`insert`，因此您可能不需要求助于过程代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-26T00:56:53.160

是否有理由让它成为可能的最小数字？为什么你需要填补这些洞？

**编辑**广告答案，因为这是一个业务规则。

```
DECLARE @counter int
DECLARE @max
SET @counter = 0
SET @max = SELECT MAX(Id) FROM YourTable
WHILE @counter <= @max
BEGIN
    SET @counter = @counter + 1
    IF NOT EXISTS (SELECT Id FROM YourTable WHERE Id = @counter)
        BREAK
    END
END 
```

（我手边没有数据库，所以这可能不是 100% 准确，但你应该能够从那里得到它）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-27T13:59:13.373

```
select
    MIN(NextID) NextUsableID
from (
    select (case when c1 = c2 then 0 
            else c1 end) NextID 
    from (  select ROW_NUMBER() over (order by record_id) c1, 
                   record_id c2
            from   myTable)
)
where NextID > 0 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-10-09T18:05:54.347

这是一个简单的方法。它可能不会很快。它不会在开始时找到丢失的数字。

```
SELECT MIN(MT1.MyInt+1)
FROM MyTable MT1
LEFT OUTER JOIN MyTable MT2 ON (MT1.MyInt+1)=MT2.MyInt
WHERE MT2.MyInt Is Null 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-05-24T09:28:19.203

假设您的 ID 应始终以 1 开头：

```
SELECT MIN(a.id) + 1 AS firstfree
FROM (SELECT id FROM table UNION SELECT 0) a
LEFT JOIN table b ON b.id = a.id + 1
WHERE b.id IS NULL 
```

这处理了我能想到的所有情况——包括根本没有现有记录。

我唯一不喜欢这个解决方案的是附加条件必须包含两次，比如：

```
SELECT MIN(a.id) + 1 AS firstfree
FROM (SELECT id FROM table WHERE column = 4711 UNION SELECT 0) a
LEFT JOIN table b ON b.column = 4711 AND b.id = a.id + 1
WHERE b.id IS NULL 
```

还请注意关于锁定和并发性的评论——在大多数情况下，填补空白的要求是糟糕的设计，可能会导致问题。但是，*我*这样做是有充分理由的：ID 是由人工打印和键入的，我们不希望一段时间后有很多数字的 ID，而所有低数字的 ID 都是免费的......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-26T01:55:20.227

您真的应该尝试将该列转换为 IDENTITY。首先备份，然后使用 ROW_NUMBER 更新文档 ID，以便它们从 1 开始直到文档计数。您当时应该在 WHILE 中执行此操作，因为如果将数字列用作其他表（外键）中的引用，SQL Server 将尝试更新外键并且可能由于冲突而失败。最后，只需为列启用标识规范。

**:) 现在工作量更大，但以后会为您省去很多麻烦。**

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-29T21:34:23.580

我知道这个答案很晚，但您可以使用递归表表达式找到最小的未使用数字：

```
CREATE TABLE Test
(
    ID int NOT NULL
)

--Insert values here

;WITH CTE AS
(
    --This is called once to get the minimum and maximum values
    SELECT nMin = 1, MAX(ID) + 1 as 'nMax' 
    FROM Test
    UNION ALL
    --This is called multiple times until the condition is met
    SELECT nMin + 1, nMax 
    FROM CTE
    WHERE nMin < nMax
)

--Retrieves all the missing values in the table. Removing TOP 1 will
--list all the unused numbers up to Max + 1
SELECT TOP 1 nMin
FROM CTE
WHERE NOT EXISTS
(
    SELECT ID
    FROM Test
    WHERE nMin = ID
) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-02-27T16:51:56.450

我遇到了类似的问题并想出了这个：

```
Select Top 1 IdGapCheck
From (Select Id, ROW_NUMBER() Over (Order By Id Asc) AS IdGapCheck
    From dbo.table) F
Where Id > IdGapCheck
Order By Id Asc 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-05T17:08:52.837

对于 Oracle DB，这应该可以完成工作：

```
SELECT MIN(NI) FROM
        (SELECT ROWNUM AS NI,YOUR_ID
         FROM (SELECT YOUR_ID
               FROM YOUR_TABLE 
               ORDER BY YOUR_ID ASC))
WHERE NI<>YOUR_ID 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-12-17T21:05:41.517

ROW_NUMBER() 函数示例：

`IF NOT EXISTS (SELECT TOP 1 row_num FROM (SELECT ROW_NUMBER() OVER (ORDER BY Id) row_num, Id FROM table) t WHERE t.Id > t.row_num) SELECT MAX (Id)+1 FROM table ELSE SELECT TOP 1 row_num FROM (SELECT ROW_NUMBER() OVER (ORDER BY Id) row_num, Id FROM table) t WHERE t.Id > t.row_num;`

# python - 你能区分测试和变量设置吗？

> ID：684109
> 
> 赞同：0
> 
> 时间：2009-03-26T00:52:51.937
> 
> 标签：python, unit-testing, doctest

我喜欢 doctest，但是当您在传递给函数之前需要设置复杂的参数时，它变得非常难以阅读。因此，您开始使用多行分配然后调用您想要测试的函数。这种方法但是，将报告您有多个测试，而不是您拥有的实际测试数量.. 一个例子将说明我的意思..

```
def returnme(x):
   """
   Returns what you pass

   >>> y = (2, 3, 5, 7)
   >>> returnme(y)
   (2, 3, 5, 7)
   """
   return x 
```

在上面的代码片段中，只有一个测试，另一个只是一个变量赋值，但是，这就是报告的内容..

```
    试：
       y = (2, 3, 5, 7)
    什么都不期待
    好的
    试：
       返回我（y）
    期待：
       (2, 3, 5, 7)
    好的

    2 个项目中的 2 个测试。
    2 次通过，0 次失败。

```

我查看了记录的标志，当然我错过了一些东西..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T00:58:42.190

在前面添加三个句点以指示您要继续当前行，如下所示：

```
def returnme(x):
   """
   Returns what you pass

   >>> y = (2, 3, 5, 7)
   ... returnme(y)        # Note the difference here.
   ...                    # Another blank line ends this test.
   (2, 3, 5, 7)
   """
   return x 
```

这应该够了吧。[**您可以在此处**](http://docs.python.org/library/doctest.html#how-are-docstring-examples-recognized)阅读有关 doctest 如何解释各个测试的更多信息。

# c++ - long double 输出的精度不正确。可能有什么问题？

> ID：684112
> 
> 赞同：1
> 
> 时间：2009-03-26T00:54:11.543
> 
> 标签：c++, precision, math, long-double

我有一个`long double`常量，我将其设置为 const 或非 const。它比`long double`我的测试工作站上的精度（19 位）长（40 位）。

当我打印出来时，它不再以 19 位精度显示，而是以 16 位显示。

这是我正在测试的代码：

```
#include <iostream>
#include <iomanip>
#include <limits>
#include <cstdio>

int main ()
{
    const long double constLog2 = 0.6931471805599453094172321214581765680755;
    long double log2 = 0.6931471805599453094172321214581765680755;    

    std::cout << std::numeric_limits<long double>::digits10 + 1 << std::endl;
    std::cout << "const via cout: " << std::setprecision(19) << constLog2 << std::endl;
    std::cout << "non-const via cout: " << std::setprecision(19) << log2 << std::endl;
    std::fprintf(stdout, "const via printf: %.19Lf\n", constLog2);
    std::fprintf(stdout, "non-const via printf: %.19Lf\n", log2);

    return 0;
} 
```

编译：

```
$ g++ -Wall precisionTest.cpp 
```

输出：

```
$ ./a.out
19
const via cout: 0.6931471805599452862
non-const via cout: 0.6931471805599452862
const via printf: 0.6931471805599452862
non-const via printf: 0.6931471805599452862 
```

我会期待`0.6931471805599453094`，而是得到`0.6931471805599452862`.

19位精度被削减到16位是有原因的吗？

这是我的环境：

```
$ gcc --version
i686-apple-darwin9-g++-4.0.1 (GCC) 4.0.1 (Apple Inc. build 5490) 
```

我在其他版本的 gcc 上看到了同样的问题，例如：

```
$ gcc --version
g++ (GCC) 3.4.6 20060404 (Red Hat 3.4.6-10) 
```

我可以查看 NTL 或其他库，但我很好奇是什么原因造成的。感谢您的洞察力。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-26T01:03:49.150

我得到这个输出：

```
19
const via cout: 0.6931471805599453094
non-const via cout: 0.6931471805599453094
const via printf: 0.6931471805599453094
non-const via printf: 0.6931471805599453094 
```

但我使用的是 long double 文字而不是 double 文字：

```
const long double constLog2 = 0.6931471805599453094172321214581765680755L;
long double log2 = 0.6931471805599453094172321214581765680755L; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T01:13:06.023

有一些与硬件平台和编译选项相关的微妙问题可能会引起人们的兴趣：

*   [https://www.amazon.com/exec/obidos/ASIN/0954161793/networktheory-20](https://rads.stackoverflow.com/amzn/click/com/0954161793)
*   [3.17.3 Intel 386 和 AMD x86-64 选项 (gcc-4.0.1)](https://web.archive.org/web/20090622125054/http://developer.apple.com/documentation//DeveloperTools/gcc-4.0.1/gcc/i386-and-x86_002d64-Options.html)（存档 developer.apple.com 文档）
*   [3.17.12 Intel 386 和 AMD x86-64 选项 (gcc-4.0.1)](https://gcc.gnu.org/onlinedocs/gcc-4.0.1/gcc/i386-and-x86_002d64-Options.html)（gcc.gnu.org 文档）

这些 `-m' 选项是为 i386 和 x86-64 系列计算机定义的：

> -m96bit-long-double
> 
> -m128bit-long-double
> 
> 这些开关控制 long double 类型的大小。i386 应用程序二进制接口指定大小为 96 位，因此 -m96bit-long-double 是 32 位模式下的默认值。现代架构（奔腾和更新）更喜欢 long double 对齐到 8 或 16 字节边界。在符合 ABI 的数组或结构中，这是不可能的。因此，指定 -m128bit-long-double 会将 long double 与 16 字节边界对齐，方法是用额外的 32 位零填充 long double。
> 
> 在 x86-64 编译器中，-m128bit-long-double 是默认选择，因为它的 ABI 指定 long double 将在 16 字节边界上对齐。
> 
> 请注意，这些选项都没有为 long double 启用超过 80 位的 x87 标准的任何额外精度。
> 
> 警告：如果您覆盖目标 ABI 的默认值，则包含 long double 变量的结构和数组将改变它们的大小，并且函数采用 long double 的函数调用约定将被修改。因此，它们不会与在没有该开关的情况下编译的代码中的数组或结构二进制兼容。

# c# - XML 模式

> ID：684117
> 
> 赞同：1
> 
> 时间：2009-03-26T00:55:46.673
> 
> 标签：c#, python, ruby

我有一个架构文件 (.xsd)，我想使用这个架构生成一个 xml 文档。有没有可用的在线工具，如果不是最快的方法（比如使用 vb.net 的几行代码）。

谢谢你的帮助。

-武帕拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:58:30.350

如果我的理解是正确的，这个工具可能会有所帮助。

[XML 生成器](http://www.stylusstudio.com/xml_generator.html)

这是我在处理 XML 时通常使用的。

如果你想通过代码解决问题，你可以使用这个：

```
XmlTextWriter textWriter = new XmlTextWriter("po.xml", null);
textWriter.Formatting    = Formatting.Indented;
XmlQualifiedName qname   = new XmlQualifiedName("PurchaseOrder",       
                           "http://tempuri.org");
XmlSampleGenerator generator = new XmlSampleGenerator("po.xsd", qname);
genr.WriteXml(textWriter); 
```

取自[MSDN](http://msdn.microsoft.com/en-us/library/aa302296.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:58:44.200

下载[pyXSD](http://pyxsd.org/)。

使用它从 XSD 构建 Python 类定义。

从这些类定义构建对象。

以 XML 表示法保存 Python 对象。

另一种方法是[GenerateDS](http://www.rexx.com/~dkuhlman/generateDS.html)。

# fiddler - 如何向 Fiddler 添加额外的列

> ID：684127
> 
> 赞同：9
> 
> 时间：2009-03-26T01:00:49.953
> 
> 标签：fiddler

喜欢这个调试工具。如果我能看到每个调用作为一列需要多长时间，而不是单击每个单独的项目并查看其统计信息，那就太好了。

我没有看到任何添加此列的选项。有没有办法通过配置文件或脚本来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-17T19:25:52.527

我尝试了其他答案，但它们都没有给我实际的整体经过时间，因为 TTLB 并不总是我们想要的。提到的提琴手帮助页面@Eric Lawrence 有更好的答案。为脚本编辑器按 Ctrl+R，然后将此代码添加到 Handlers 类：

```
public static BindUIColumn("Time Taken")
       function CalcTimingCol(oS: Session){
         var sResult = String.Empty;
         if ((oS.Timers.ServerDoneResponse > oS.Timers.ClientDoneRequest))
         {
           sResult = (oS.Timers.ServerDoneResponse - oS.Timers.ClientDoneRequest).ToString();
         }
         return sResult;
       } 
```

这还具有正确排序的额外好处。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-18T05:36:20.780

2012 年 10 月更新，这似乎是现在内置的。

单击规则 -> 性能 -> 显示最后一个字节的时间

下一个请求将在自定义列中显示 ttlb。

2013 年 5 月更新 - 我升级到 Fiddler 4.4.4.4 Beta 并发现此选项不再可用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T02:57:25.867

肯定有。

在 Fiddler 中，转到规则 -> 自定义规则...

现在查找“onBeforeResponse”，并在该方法中，在底部添加以下代码行：

```
oSession["ui-customcolumn"] = oSession["X-TTLB"]; 
```

应该为您解决问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T04:06:18.090

有关其他选项，请参阅[http://www.fiddler2.com/fiddler/help/configurecolumns.asp](http://www.fiddler2.com/fiddler/help/configurecolumns.asp)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-25T05:19:48.143

TTLB 在那里，刚刚找到它。右键点击urls上面的列，点击custom columns，在collection中，选择session timers，在Timer Name中：选择TTLB。为我工作，干杯。

# java - 读取逗号分隔的配置文件的最佳方法是什么？

> ID：684131
> 
> 赞同：4
> 
> 时间：2009-03-26T01:03:52.753
> 
> 标签：java, file-io

我有一个逗号分隔的配置文件。空行被忽略，无效行需要有错误：

> 富，酒吧
> 
> foo2, 酒吧 3

我想将此文件读入`HashMap`其中键（foo）与值（bar）映射的位置。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T01:07:34.057

如果您可以使用 x = y 而不是 x, y 那么您可以使用 Properties 类。

如果您确实需要 x, y 然后查看[java.util.Scanner](http://java.sun.com/javase/6/docs/api/java/util/Scanner.html)您可以将分隔符设置为用作分隔符（javadoc 显示了这样做的示例）。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

class Main
{
    public static void main(final String[] argv)
    {
        final File file;

        file = new File(argv[0]);

        try
        {
            final Scanner scanner;

            scanner = new Scanner(file);

            while(scanner.hasNextLine())
            {
                if(scanner.hasNext(".*,"))
                {
                    String key;
                    final String value;

                    key = scanner.next(".*,").trim();

                    if(!(scanner.hasNext()))
                    {
                        // pick a better exception to throw
                        throw new Error("Missing value for key: " + key);
                    }

                    key   = key.substring(0, key.length() - 1);
                    value = scanner.next();

                    System.out.println("key = " + key + " value = " + value);
                }
            }
        }
        catch(final FileNotFoundException ex)
        {
            ex.printStackTrace();
        }
    }
} 
```

和属性版本（解析更简单，因为没有）

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.Reader;
import java.util.Properties;

class Main
{
    public static void main(final String[] argv)
    {
        Reader reader;

        reader = null;

        try
        {
            final Properties properties;

            reader = new BufferedReader(
                            new FileReader(argv[0]));
            properties = new Properties();
            properties.load(reader);
            System.out.println(properties);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(reader != null)
            {
                try
                {
                    reader.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-26T01:08:50.340

最好的办法是使用 java.util.Scanner 类读取配置文件中的值，使用逗号作为分隔符。在此处链接到 Javadoc：

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)

示例是：

```
Scanner sc = new Scanner(new File("thing.config"));
sc.useDelimiter(",");
while (sc.hasNext()) {
   String token = sc.next();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T02:02:16.420

```
try {
  BufferedReader cfgFile = new BufferedReader(new FileReader(new File("config.file")));
  String line = null;

  // Read the file line by line
  while ((line = cfgFile.readLine()) != null) {
    line.trim();
    // Ignore empty lines
    if (!rec.equals("")) {
       String [] fields = line.split(","); 
       String key = fields[0];
       String value = fields[1];  
       // TODO: Check for more than 2 fields
       // TODO: Add key, value pair to Hashmap  
    } // if
  } // while

  cfgFile.close();
} catch (IOException e) {
  System.out.println("Unexpected File IO Error");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T02:37:47.957

我个人使用了一个名叫 Stephen Ostermiller 的人的 jar，这是他的[Labeled CSV](http://ostermiller.org/utils/LabeledCSVParser.html)解析器。这是一些示例代码。

```
LabeledCSVParser lcsvp = new LabeledCSVParser(
    new CSVParser(
        new StringReader(
            "Name,Phone\n" +
            "Stewart,212-555-3233\n" +
            "Cindy,212-555-8492\n"
        )
    )
);

while(lcsvp.getLine() != null){
    System.out.println(
        "Name: " + lcsvp.getValueByLabel("Name")
    );
    System.out.println(
        "Phone: " + lcsvp.getValueByLabel("Phone")
    );
} 
```

# c# - 将 C# 数据类型参数传递给用 C++ 编写的 dll？

> ID：684133
> 
> 赞同：2
> 
> 时间：2009-03-26T01:04:08.197
> 
> 标签：c#, c++, types

仍在处理从这里开始的问题 [Calling C++ dll function from C#: Of structs, strings and wchar_t arrays。](https://stackoverflow.com/questions/680066/calling-c-dll-function-from-c-of-structs-strings-and-wchart-arrays)，但采用不同的方法。

按照[从非托管代码调用托管代码的示例，反之亦然](http://www.codeproject.com/KB/mcpp/unmanaged_to_managed.aspx)，我在 C++ 中编写了一个托管包装器来访问非托管 C++ dll 中的 unmanages 类。

它看起来像这样：

```
//in header file
public __gc class TSSLDllWrapper
{
public:
TSSLDllWrapper();
     //this is the unmanaged class
CcnOCRsdk * _sdk;

bool convertHKID_Name(char *code, RECO_DATA *o_data);
};

//in .cpp file
TSSLDllWrapper::TSSLDllWrapper(void)
{
  _sdk = new CcnOCRsdk();
}

bool TSSLDllWrapper::convertHKID_Name(char *code, RECO_DATA *o_data)
{
return _sdk->convertHKID_Name(code, o_data);
}

//C++ RECO_DATA structure definition:
struct RECO_DATA{
wchar_t FirstName[200];
wchar_t Surname[200];
}; 
```

现在我有一个可以导入到我的 C# 项目中的 dll。

然而，问题是：当我想从 dll 文件中调用该方法时，如下所示：

```
TSSLDllWrapper wrapper = new TSSLDllWrapper();
bool res = wrapper.convertHKID_NameSimple( //need to pass parameters here ); 
```

它需要 C++ 参数 - 指向 char 和 RECO_DATA 的指针。

如何解决此问题并从 C# 代码传递 C++ 类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T01:23:24.080

转换大多数 C 数据类型的一种方法是使用[PInvoke Interop Assitant](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120)。它将为大多数 C 结构创建适当的 C#/VB.Net 类型。这是 RECO_DATA 的输出

```
[System.Runtime.InteropServices.StructLayoutAttribute(System.Runtime.InteropServices.LayoutKind.Sequential, CharSet=System.Runtime.InteropServices.CharSet.Unicode)]
public struct RECO_DATA {

    /// wchar_t[200]
    [System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst=200)]
    public string FirstName;

    /// wchar_t[200]
    [System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst=200)]
    public string Surname;
} 
```

对于 char* 参数，您可以传递 IntPtr.Zero 或使用 Marshal.StringToCoTaskMemAnsi 来完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T03:44:06.207

我在创建 dll 包装器时偶然发现了几点：

*   我不得不调用非托管类的成员函数。花了一些时间才发现我不能直接使用 DllImport 来做到这一点，而必须自己编写一个“包装器”。
*   在包装器本身中，仅包装成员函数也是不够的。我必须能够创建指向 C++ 类的指针，所以我必须将指针导出到构造函数（至少，我是这么理解的，也许这并不完全正确。）。我最初尝试只导出成员函数，它编译但在运行时返回“AccessViolationException”。也卡在那里一段时间。

因此，我的包装器看起来像这样（正如[在 c# 代码中使用 c++ dll 中定义的类所](https://stackoverflow.com/questions/315051/using-a-class-defined-in-a-c-dll-in-c-code)建议的那样）：

```
 public class __declspec(dllexport) Wrapper
{
public:
    CcnOCRsdk* SDKCreate()
    {
        return new CcnOCRsdk();
    }

    bool CcnOCRsdk_HKID(CcnOCRsdk* pSDK, char *code, RECO_DATA *o_data)
    {
        return pSDK->convertHKID_Name(code, o_data);
    }

    void SDKDelete(CcnOCRsdk* pSDK)
    {
        delete pSDK;    
    }
}; 
```

类级别的 __declspec(dllexport) 导出类的所有公共成员。SDKCreate() 从我必须调用的成员函数的非托管 dll 返回指向该 CcnOCRsdk 类的指针。CcnOCRsdk_HKID 调用该成员函数。请注意，传递了指向 CcnOCRsdk 的指针。

在代码构建到 dll 中之后，我必须使用[DUMPBIN](http://support.microsoft.com/kb/177429)来找出我编写的包装 dll 的“损坏”入口点是什么。

对于我的包装器，结果如下所示

> ```
>  1    0 00001240 ??4Wrapper@TSSL@@QAEAAV01@ABV01@@Z = __t2m@??4Wrapper@TSSL@@QAEAAV01@ABV01@@Z ([T2M] public: class TSSL::Wrapper & __thiscall TSSL::Wrapper::operator=(class TSSL::Wrapper const &))
>       2    1 00001220 ?CcnOCRsdk_HKID@Wrapper@TSSL@@QAE_NPAVCcnOCRsdk@@PADPAURECO_DATA@@@Z = __t2m@?CcnOCRsdk_HKID@Wrapper@TSSL@@QAE_NPAVCcnOCRsdk@@PADPAURECO_DATA@@@Z ([T2M] public: bool __thiscall TSSL::Wrapper::CcnOCRsdk_HKID(class CcnOCRsdk *,char *,struct RECO_DATA *))
>       3    2 00001200 ?SDKCreate@Wrapper@TSSL@@QAEPAVCcnOCRsdk@@XZ = ?SDKCreate@Wrapper@TSSL@@QAEPAVCcnOCRsdk@@XZ (public: class CcnOCRsdk * __thiscall TSSL::Wrapper::SDKCreate(void))
>       4    3 00001410 ?SDKDelete@Wrapper@TSSL@@QAEXPAVCcnOCRsdk@@@Z = ?SDKDelete@Wrapper@TSSL@@QAEXPAVCcnOCRsdk@@@Z (public: void __thiscall TSSL::Wrapper::SDKDelete(class CcnOCRsdk *)) 
> ```

现在我终于准备好在 C# 中使用我的包装器了。当我在没有完全按照 dumpbin 的输出指定入口点的情况下执行此操作时，出现“无法找到入口点”错误。

```
 [DllImport(@"TSSLWrapper.dll", EntryPoint = "?SDKCreate@Wrapper@TSSL@@QAEPAVCcnOCRsdk@@XZ")]
    public static extern IntPtr SDKCreate();
    [DllImport(@"TSSLWrapper.dll", EntryPoint = "?CcnOCRsdk_HKID@Wrapper@TSSL@@QAE_NPAVCcnOCRsdk@@PADPAURECO_DATA@@@Z")]
    public static extern bool CcnOCRsdk_HKID(IntPtr ptr, string num, out RECO_DATA o_data); 
```

RECO_DATA 被定义为 JaredPar 建议的。

最后一步是享受结果。首先我必须调用类构造函数，然后将指针传递给函数的实际调用

```
 RECO_DATA recoData = new cnOCRsdk.RECO_DATA();
  string num = "262125355174";

  IntPtr ptr = cnOCRsdk.SDKCreate();
  bool res = cnOCRsdk.CcnOCRsdk_HKID(ptr, num, out recoData); 
```

我的 res 返回 true，我在 recoData 中得到了我期望的结果。

# shell - 按大小顺序列出所有 Windows 文件的程序

> ID：684139
> 
> 赞同：2
> 
> 时间：2009-03-26T01:08:47.687
> 
> 标签：shell

有谁知道按大小降序列出硬盘驱动器中所有文件的程序或脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T01:22:41.680

不是脚本，但我使用了[TreeSize Free](http://download.cnet.com/TreeSize-Free/3000-2248_4-81064.html?tag=mncol)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T01:49:08.590

WinDirStat 是我使用的，但它仅适用于 Windows：

[http://windirstat.info/images/windirstat.jpg](http://windirstat.info/images/windirstat.jpg)

[http://windirstat.info/](http://windirstat.info/)

它基于 Kdirstat，用于 X11：

[http://kdirstat.sourceforge.net/](http://kdirstat.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T01:12:35.370

您可以运行`dir /O-S`和递归。以下命令执行此操作：

```
for /R  %I in (.) DO dir /O-S 
```

这将从当前目录开始遍历树。将您选择的目录放在`/R`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T01:45:57.350

[JDiskReport](http://www.jgoodies.com/freeware/jdiskreport/)在这些方面做了一些事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-24T06:33:53.617

我的“无私”推荐：[RidNacs](http://www.splashsoft.de/Freeware/ridnacs.html)

# sql - 如何从 Northwind 数据库的 Categories 表中读取图像？

> ID：684146
> 
> 赞同：2
> 
> 时间：2009-03-26T01:11:31.503
> 
> 标签：sql, database, sql-server-2005, image

在 SQL Server 2005 中，如何从`Categories`Northwind 的表中读取图像？我可以将我的图像上传到我自己的数据库并从那里显示它，但我无法从`Categories`Northwind 的表格中显示图像。

有人可以告诉我如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T17:53:08.730

我相信[这](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/efca2899-d8c7-49f6-ae6c-4934387b6177/)就是您正在寻找的（VB.NET 代码） - 官方支持文章[在这里](http://support.microsoft.com/kb/316887/en-us)。

# sql-server - SQL Server：将所有 DB 对象（SP、表、触发器等）编写为 SQL 脚本

> ID：684153
> 
> 赞同：0
> 
> 时间：2009-03-26T01:13:04.120
> 
> 标签：sql-server

我想请教这里的专家如何在 SQL Server 2008 Express Edition 中编写数据库对象的脚本。在生成脚本的时候，我发现只有表和触发器可以作为脚本。但是如何也可以编写 SP 脚本呢？

问题是我有一个主机提供程序，并且我希望我站点中的数据库具有 ASP.NET 成员框架对象（表、SP）。这是一个很大的缺点，因为我的主机不允许远程访问他们的 SQL Server。

我希望我的站点数据库具有 ASP.NET 成员框架的对象。他们允许的是使用“我的小管理员”工具的 SQL 脚本。

任何帮助将不胜感激。如果我的问题不够清楚，请发表评论，以便我修改问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:16:16.220

请参阅此答案：[在 Management Studio 2005 中编写所有存储过程的脚本](https://stackoverflow.com/questions/175703/script-all-stored-procedures-in-management-studio-2005)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T01:36:31.100

> 我希望我的站点数据库具有 ASP.NET 成员框架的对象。

您可以查看 aspnet_regsql.exe 命令，该命令允许您在目标数据库中创建所有 ASP.NET 成员对象（表/存储过程）。

另请查看[Microsoft SQL Server 数据库发布向导](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

# cocoa - 我应该使用哪种委托方法来响应对 NSTextField 的点击？

> ID：684166
> 
> 赞同：5
> 
> 时间：2009-03-26T01:16:31.163
> 
> 标签：cocoa, macos, nstextfield

我正在尝试回应 a`click`内的`textfield`. 当点击发生时，我将打开一个`panel`. 我最初的想法是使用一种`delegate`方法来响应`click`事件 - 但我发现：

此方法不起作用：

```
(void)textDidBeginEditing:(NSNotification *)aNotification 
```

此方法*确实*有效，但仅在我实际*编辑*文本字段中的文本时才有效，而不是在我第一次单击它时。而且 - 如果我再次编辑文本，此方法将停止工作：

```
(void)controlTextDidBeginEditing:(NSNotification *)aNotification 
```

* * *

我可以使用尽可能多的细节——或者理想情况下的代码示例。我知道 an`nstextfield`继承自`NSControl`，它有一个`mouseDown`事件。是否也有类似的方法来响应事件`textfield`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T05:50:30.367

由于`NSTextField`继承自`NSControl`类，它也继承了`-(void)mouseDown:(NSEvent*) theEvent`方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-12-17T17:50:54.940

我今天点击它时需要`NSTextField`调用一个委托函数，并认为这个基本代码可能有用。请注意，`NSTextField`已经有一个委托，并且在 SDK v10.6 中，委托已经有一个与之关联的协议。请注意，如果您不关心协议、编译器警告等，则不需要协议和属性声明或 getter 和 setter。

```
MouseDownTextField.h:

#import <Appkit/Appkit.h>
@class MouseDownTextField;

@protocol MouseDownTextFieldDelegate <NSTextFieldDelegate>
-(void) mouseDownTextFieldClicked:(MouseDownTextField *)textField;
@end

@interface MouseDownTextField: NSTextField {
}
@property(assign) id<MouseDownTextFieldDelegate> delegate;
@end

MouseDownTextField.m:
#import "MouseDownTextField.h"

@implementation MouseDownTextField
-(void)mouseDown:(NSEvent *)event {
  [self.delegate mouseDownTextFieldClicked:self];
}

-(void)setDelegate:(id<MouseDownTextFieldDelegate>)delegate {
  [super setDelegate:delegate];
}

-(id)delegate {
  return [super delegate];
}

AppDelegate.h:
@interface AppDelegate <MouseDownTextFieldDelegate>
...
@property IBOutlet MouseDownTextField *textField;
...

AppDelegate.m:
...
  self.textField.delegate = self;
...
-(void)mouseDownTextFieldClicked:(MouseDownTextField *)textField {
  NSLog(@"Clicked");
  ...
}
... 
```

如果您使用 10.5 SDK 构建，请不要让协议继承自`NSTextFieldDelegate`.

# python - 如何在 Python 解释器中重新导入更新的包？

> ID：684171
> 
> 赞同：444
> 
> 时间：2009-03-26T01:19:41.687
> 
> 标签：python

我经常在 Python Interpreter 中测试我的模块，当我看到错误时，我会快速更新 .py 文件。但是我如何让它反映在解释器上？所以，到目前为止，我一直在退出并重新进入解释器，因为再次重新导入文件对我不起作用。

* * *

## 回答 #1

> 赞同：370
> 
> 时间：2009-03-26T01:25:34.293

**Python3 的更新**：（引自[已经回答的答案](https://stackoverflow.com/a/437591/3358272)，因为此处的最后编辑/评论建议了一种已弃用的方法）

> 在 Python 3 中，`reload`被移至[`imp`](https://docs.python.org/3.2/library/imp.html)模块。在 3.4 中，`imp`不赞成使用[`importlib`](https://docs.python.org/3.4/library/importlib.html)，并将[`reload`](https://docs.python.org/3.4/library/importlib.html#importlib.reload)其添加到后者。以 3 或更高版本为目标时，在调用`reload`或导入时引用适当的模块。

带走：

*   Python3 >= 3.4：`importlib.reload(packagename)`
*   Python3 < 3.4：`imp.reload(packagename)`
*   Python2：继续下面

* * *

使用`reload`内置函数：

[https://docs.python.org/2/library/functions.html#reload](https://docs.python.org/2/library/functions.html#reload)

> 何时`reload(module)`执行：
> 
> *   重新编译 Python 模块的代码并重新执行模块级代码，定义一组新的对象，这些对象绑定到模块字典中的名称。扩展模块的init函数不会被第二次调用。
> *   与 Python 中的所有其他对象一样，旧对象仅在其引用计数降至零后才会被回收。
> *   模块命名空间中的名称被更新以指向任何新的或更改的对象。
> *   对旧对象的其他引用（例如模块外部的名称）不会重新引用以引用新对象，并且如果需要，必须在它们出现的每个命名空间中进行更新。

例子：

```
# Make a simple function that prints "version 1"
shell1$ echo 'def x(): print "version 1"' > mymodule.py

# Run the module
shell2$ python
>>> import mymodule
>>> mymodule.x()
version 1

# Change mymodule to print "version 2" (without exiting the python REPL)
shell2$ echo 'def x(): print "version 2"' > mymodule.py

# Back in that same python session
>>> reload(mymodule)
<module 'mymodule' from 'mymodule.pyc'>
>>> mymodule.x()
version 2 
```

* * *

## 回答 #2

> 赞同：222
> 
> 时间：2014-04-06T12:41:19.793

以上所有关于`reload()`或的答案`imp.reload()`均已弃用。

`reload()`不再是 python 3 中的内置函数，并且`imp.reload()`被标记为已弃用（请参阅 参考资料`help(imp)`）。

最好改为使用[`importlib.reload()`](https://docs.python.org/3/library/importlib.html#importlib.reload)。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-03-26T01:46:28.143

> 所以，到目前为止，我一直在退出并重新进入解释器，因为再次重新导入文件对我不起作用。

是的，只要再说`import`一遍，您就可以从`sys.modules`.

您可以说`reload(module)`更新`sys.modules`并获取该单个模块的新副本，但如果任何其他模块引用原始模块*或原始模块中的任何对象*，它们将保留其旧引用并且会发生非常混乱的事情。

所以如果你有一个`a`依赖于模块的模块`b`，并且`b`发生变化，你必须'重新加载b'然后'重新加载a'。如果你有两个相互依赖的模块，当这些模块是同一个包的一部分时，这是非常常见的，你不能重新加载它们：如果你重新加载`p.a`它会得到一个对 old 的引用`p.b`，反之亦然反之亦然。唯一的方法是通过从 中删除它们的项目来一次卸载它们`sys.modules`，然后再次导入它们。这很棘手，并且有一些实际的陷阱与模块条目为 None 作为失败的相对导入标记有关。

如果你有一个模块将其对象的引用传递给系统模块——例如它注册了一个编解码器，或者添加了一个警告处理程序——你就被卡住了；你不能在不混淆 Python 环境的其余部分的情况下重新加载系统模块。

总而言之：除了一个独立脚本加载一个自包含模块的最简单情况外，`reload()`要正确处理是非常棘手的；如果正如您所暗示的那样，您正在使用“包”，那么继续循环解释器可能会更好。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-10-29T12:45:24.813

在 Python 3 中，行为发生了变化。

```
>>> import my_stuff 
```

...对 my_stuff 做一些事情，然后：

```
>>>> import imp
>>>> imp.reload(my_stuff) 
```

你会得到一个全新的、重新加载的 my_stuff。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2016-04-02T16:22:16.277

无论您导入一个模块多少次，您都将获得相同的模块副本`sys.modules`- 最初加载的`import mymodule`

我回答得这么晚了，因为上面/以前的每个答案都有一些答案，所以我试图将它们总结在一个答案中。

**使用内置函数**：

对于**Python 2.x** - 使用内置[`reload(mymodule)`](https://docs.python.org/2/library/functions.html#reload)函数。

对于**Python 3.x** - 使用[`imp.reload(mymodule)`](https://docs.python.org/3.0/library/imp.html#imp.reload).

对于**Python 3.4** - 在 Python 3.4`imp`中已弃用，取而代之的是`importlib`ie[`importlib.reload(mymodule)`](https://docs.python.org/3.4/library/importlib.html#importlib.reload)

**几点注意事项**：

*   重新加载内置或动态加载的模块通常不是很有用。不建议重新加载`sys`、、`__main__`等关键模块。[`builtins`](https://docs.python.org/3.4/library/builtins.html#module-builtins)
*   在许多情况下，扩展模块不会被设计为多次初始化，并且在重新加载时可能会以任意方式失败。如果一个模块使用`from`... `import`... 从另一个模块导入对象，则调用`reload()`另一个模块不会重新定义从它导入的对象 — 解决此问题的一种方法是重新执行`from`语句，另一种方法是使用`import`和限定名称 ( module.name) 代替。
*   如果一个模块实例化了一个类的实例，重新加载定义该类的模块不会影响实例的方法定义——它们会继续使用旧的类定义。派生类也是如此。

* * *

**外部包**：

[reimport](https://bitbucket.org/petershinners/reimport) - Reimport 目前支持 Python 2.4 到 2.7。

[xreload](http://svn.python.org/projects/sandbox/trunk/xreload/xreload.py) - 这通过在临时命名空间中执行模块，然后在适当的位置修补类、方法和函数来工作。这避免了修补实例的需要。新对象被复制到目标命名空间中。

[livecoding](https://code.google.com/archive/p/livecoding/) - 代码重新加载允许正在运行的应用程序更改其行为以响应其使用的 Python 脚本的更改。当库检测到 Python 脚本已被修改时，它会重新加载该脚本并用新重新加载的版本替换它之前可用的对象。作为一种工具，它允许程序员避免中断他们的工作流程和相应的失去焦点。它使他们能够保持心流状态。以前他们可能需要重新启动应用程序才能使更改的代码生效，这些更改可以立即应用。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-26T09:04:43.113

基本上像 allyourcode 的 asnwer 一样[重新加载。](http://docs.python.org/library/functions.html#reload)但它不会改变已经实例化的对象或引用函数的底层代码。从他的回答延伸：

```
#Make a simple function that prints "version 1"
shell1$ echo 'def x(): print "version 1"' > mymodule.py

# Run the module
shell2$ python
>>> import mymodule
>>> mymodule.x()
version 1
>>> x = mymodule.x
>>> x()
version 1
>>> x is mymodule.x
True

# Change mymodule to print "version 2" (without exiting the python REPL)
shell2$ echo 'def x(): print "version 2"' > mymodule.py

# Back in that same python session
>>> reload(mymodule)
<module 'mymodule' from 'mymodule.pyc'>
>>> mymodule.x()
version 2
>>> x()
version 1
>>> x is mymodule.x
False 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-12-26T15:58:19.387

简短的回答：

尝试使用[reimport: a full feature reload for Python](https://bitbucket.org/petershinners/reimport)。

更长的答案：

看起来这个问题是在发布[reimport](https://bitbucket.org/petershinners/reimport)之前提出/回答的，它自称是“Python 的全功能重载”：

> 该模块旨在成为 Python 重载功能的全功能替代品。它的目标是重新加载适用于运行时间较长的应用程序使用的 Python 插件和扩展。
> 
> Reimport 目前支持 Python 2.4 到 2.6。
> 
> 就其本质而言，这不是一个完全可以解决的问题。该模块的目标是使最常见的更新工作正常。它还允许单个模块和包来协助该过程。概述页面上对所发生的情况进行了更详细的描述。

注意：虽然`reimport`明确支持 Python 2.4 到 2.6，但我一直在 2.7 上尝试它，它似乎工作得很好。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-26T09:22:16.283

不确定这是否能完成所有预期的事情，但你可以这样做：

```
>>> del mymodule
>>> import mymodule 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-06-02T23:59:11.140

```
import sys
del sys.modules['module_name'] 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-26T02:23:07.807

有关如何不重新加载依赖模块以及可能产生的影响的详细说明，请参见此处：

[http://pyunit.sourceforge.net/notes/reloading.html](http://pyunit.sourceforge.net/notes/reloading.html)

pyunit 解决它的方法是通过覆盖 __import__ 来跟踪依赖模块，然后从 sys.modules 中删除每个模块并重新导入。不过，他们可能只是重新加载了它们。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-12-10T11:42:49.397

蜻蜓的回答对我有用（python 3.4.3）。

```
import sys
del sys.modules['module_name'] 
```

这是一个较低级别的解决方案：

```
exec(open("MyClass.py").read(), globals()) 
```

# c++ - 如何构造字符数组

> ID：684191
> 
> 赞同：1
> 
> 时间：2009-03-26T01:28:23.320
> 
> 标签：c++, arrays

我有以下代码尝试枚举字符串。

```
#include <string>
#include <iostream>

using namespace std;

string base = "000";
char values[] = {'0', '1', '2', '3' }; // Error Here

for (int i = 0; i < base.length(); ++i)
{
   for (int j = 0; j < countof(values); ++j)
   {
      if (base[i] != values[j])
      {
          string copy = base;
          copy[i] = values[j];
          cout << copy << endl;

          for (int k = i+1; k < base.length(); ++k)
          {
              for (int l = 0; l < countof(values); ++l)
              {
                   if (copy[k] != values[l])
                   {
                       string copy2 = copy;
                       copy[k] = values[l];
                       cout << copy2 << endl;
                   }
              }
          }
      }
   }
} 
```

但是如何编译它给出了错误：

```
test.cc:9: error: expected unqualified-id before 'for'
test.cc:9: error: expected constructor, destructor, or type conversion before '<' token
test.cc:9: error: expected unqualified-id before '++' token 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T01:32:05.323

错误实际上在以下行中，在`for`循环中：您的代码需要包含在某种函数中，很可能`int main(void)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T01:35:06.203

你缺少一个主要的。

尝试：

```
#include <string>
#include <iostream>

using namespace std;

string base = "000";
char values[] = {'0', '1', '2', '3' }; // Error Here

int main() // Added
{ // Added

   for (int i = 0; i < base.length(); ++i)
   {
      for (int j = 0; j < countof(values); ++j)
      {
         if (base[i] != values[j])
         {
             string copy = base;
             copy[i] = values[j];
             cout << copy << endl;

             for (int k = i+1; k < base.length(); ++k)
             {
                 for (int l = 0; l < countof(values); ++l)
                 {
                      if (copy[k] != values[l])
                      {
                          string copy2 = copy;
                          copy[k] = values[l];
                          cout << copy2 << endl;
                      }
                 }
             }
         }
      }
   }

   return 0; // Added
} // Added 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T01:50:39.973

我马上就看到了两个主要问题。

1) 你没有 main() 也没有返回码，这是理所当然的。

2) countof() 不存在，你可能正在寻找 sizeof()。

```
#include <string>
#include <iostream>
#define countof( array ) ( sizeof( array )/sizeof( array[0] ) )

using namespace std;

int main(int argc, char *argv[]) {

string base = "000";
char values[] = {'0', '1', '2', '3' }; // Error Here

    for (int i = 0; i < base.length(); ++i)
    {
       for (int j = 0; j < countof(values); ++j)
       {
          if (base[i] != values[j])
          {
              string copy = base;
              copy[i] = values[j];
              cout << copy << endl;

              for (int k = i+1; k < base.length(); ++k)
              {
                  for (int l = 0; l < countof(values); ++l)
                  {
                       if (copy[k] != values[l])
                       {
                           string copy2 = copy;
                           copy[k] = values[l];
                           cout << copy2 << endl;
                       }
                  }
              }
          }
       }
    } 
return 0;
} 
```

# iphone - 文字放大镜与 UIKeyboardTypeEmailAddress 挂起？

> ID：684194
> 
> 赞同：0
> 
> 时间：2009-03-26T01:28:42.147
> 
> 标签：iphone, cocoa-touch

我有一个`UITextField`我放入的`UITableViewCell`我放入一个分组的`UITableView`. 我今天注意到，如果我按住手指来调出 iPhone 放大镜，如果我`UITextField`的键盘类型是`UIKeyboardTypeEmailAddress`，放大镜会显示，但它只是挂起 - 我不能左右移动它，我可以' t让它消失，它只是挂起。

我心想，嗯，奇怪，也许这与`UITextFields`分组中的单元格有关`UITableView`？所以我尝试了其他一些`UITextFields`，这不会发生在那些不使用的人身上`UIKeyboardTypeEmailAddress`。

有没有人见过这样的事情？这只是 Cocoa Touch 中的一个错误吗？或者有什么我可能做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T22:58:14.840

尽管我的 UIKeyboardType 只是普通文本，但我得到了相同的行为 - 所以它不是键盘的类型。

我也有一个分组表 - 我的文本字段位于第一行（不确定这是否相关，但认为它可能有助于发现相似之处）。

**更新**- 我注意到在使用 3.0 sdk 进行测试时 - 我没有收到这个错误（所以看起来苹果已经修复了一些东西？）。我已经返回并尝试使用 2.2.1 和 2.2 进行编译，但我仍然在这两个版本上遇到错误。

我发现了这里描述的修复：[Editing a UITextField inside a UITableViewCell failed](https://stackoverflow.com/questions/376372/editing-a-uitextfield-inside-a-uitableviewcell-fails)

# silverlight - Silveright UIElementCollection 更改通知？

> ID：684197
> 
> 赞同：1
> 
> 时间：2009-03-26T01:29:38.887
> 
> 标签：silverlight, uielementcollection

我从 Silverlight Panel 类派生一个类，以便我可以对面板的子元素执行一些自定义定位。您如何找出子项的集合何时更改？Panel.Children 集合没有任何指示更改通知的事件。

每次测量发生时我是否必须扫描 Children 集合并查找已添加和消失的元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:40:15.357

试试这个帖子：[Silverlight：在面板的子项（UIElementCollection 类型）属性发生更改时收到通知。](http://skysigal.xact-solutions.com/Blog/tabid/427/EntryId/866/Silverlight-Getting-notified-upon-changes-to-a-Panel-rsquo-s-Children-of-type-UIElementCollection-property.aspx)不是一个完美的解决方案，但可能会有所帮助。

# c# - 同步计时器以防止重叠

> ID：684200
> 
> 赞同：25
> 
> 时间：2009-03-26T01:33:32.073
> 
> 标签：c#, multithreading, timer, overlap

我正在编写一个 Windows 服务，它每隔一段时间运行一个可变长度的活动（数据库扫描和更新）。我需要经常运行此任务，但要处理的代码不能安全地同时运行多次。

我怎样才能最简单地设置一个计时器以每 30 秒运行一次任务，同时又不重叠执行？（我假设`System.Threading.Timer`是这项工作的正确计时器，但可能是错误的）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-26T01:36:50.227

您可以使用计时器来执行此操作，但您需要对数据库扫描和更新进行某种形式的锁定。一个简单`lock`的同步可能足以防止发生多次运行。

话虽这么说，最好在操作完成后启动一个计时器，只使用一次，然后停止它。下次操作后重新启动它。这将使您在事件之间有 30 秒（或 N 秒），没有重叠的机会，也没有锁定。

例子 ：

```
System.Threading.Timer timer = null;

timer = new System.Threading.Timer((g) =>
  {
      Console.WriteLine(1); //do whatever

      timer.Change(5000, Timeout.Infinite);
  }, null, 0, Timeout.Infinite); 
```

*立即工作......完成......等待 5 秒......立即工作......完成......等待 5 秒......*

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-26T01:43:59.460

我会在您经过的代码中使用 Monitor.TryEnter ：

```
if (Monitor.TryEnter(lockobj))
{
  try
  {
    // we got the lock, do your work
  }
  finally
  {
     Monitor.Exit(lockobj);
  }
}
else
{
  // another elapsed has the lock
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-26T03:48:37.537

我更喜欢`System.Threading.Timer`这样的事情，因为我不必通过事件处理机制：

```
Timer UpdateTimer = new Timer(UpdateCallback, null, 30000, 30000);

object updateLock = new object();
void UpdateCallback(object state)
{
    if (Monitor.TryEnter(updateLock))
    {
        try
        {
            // do stuff here
        }
        finally
        {
            Monitor.Exit(updateLock);
        }
    }
    else
    {
        // previous timer tick took too long.
        // so do nothing this time through.
    }
} 
```

您可以通过将计时器设置为一次性并在每次更新后重新启动它来消除对锁定的需求：

```
// Initialize timer as a one-shot
Timer UpdateTimer = new Timer(UpdateCallback, null, 30000, Timeout.Infinite);

void UpdateCallback(object state)
{
    // do stuff here
    // re-enable the timer
    UpdateTimer.Change(30000, Timeout.Infinite);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T03:24:24.600

而不是锁定（这可能会导致所有定时扫描等待并最终叠加）。您可以在线程中启动扫描/更新，然后检查线程是否仍然存在。

```
Thread updateDBThread = new Thread(MyUpdateMethod); 
```

...

```
private void timer_Elapsed(object sender, ElapsedEventArgs e)
{
    if(!updateDBThread.IsAlive)
        updateDBThread.Start();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T04:23:49.137

您可以按如下方式使用 AutoResetEvent：

```
// Somewhere else in the code
using System;
using System.Threading;

// In the class or whever appropriate
static AutoResetEvent autoEvent = new AutoResetEvent(false);

void MyWorkerThread()
{
   while(1)
   {
     // Wait for work method to signal.
        if(autoEvent.WaitOne(30000, false))
        {
            // Signalled time to quit
            return;
        }
        else
        {
            // grab a lock
            // do the work
            // Whatever...
        }
   }
} 
```

一个稍微“更智能”的解决方案在伪代码中如下所示：

```
using System;
using System.Diagnostics;
using System.Threading;

// In the class or whever appropriate
static AutoResetEvent autoEvent = new AutoResetEvent(false);

void MyWorkerThread()
{
  Stopwatch stopWatch = new Stopwatch();
  TimeSpan Second30 = new TimeSpan(0,0,30);
  TimeSpan SecondsZero = new TimeSpan(0);
  TimeSpan waitTime = Second30 - SecondsZero;
  TimeSpan interval;

  while(1)
  {
    // Wait for work method to signal.
    if(autoEvent.WaitOne(waitTime, false))
    {
        // Signalled time to quit
        return;
    }
    else
    {
        stopWatch.Start();
        // grab a lock
        // do the work
        // Whatever...
        stopwatch.stop();
        interval = stopwatch.Elapsed;
        if (interval < Seconds30)
        {
           waitTime = Seconds30 - interval;
        }
        else
        {
           waitTime = SecondsZero;
        }
     }
   }
 } 
```

这些中的任何一个都有一个优点，即您可以关闭线程，只需发出事件信号即可。

* * *

**编辑**

我应该补充一点，此代码假设您只有其中一个 MyWorkerThreads() 正在运行，否则它们将同时运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-02T20:19:51.207

当我想要单次执行时，我使用了互斥锁：

```
 private void OnMsgTimer(object sender, ElapsedEventArgs args)
    {
        // mutex creates a single instance in this application
        bool wasMutexCreatedNew = false;
        using(Mutex onlyOne = new Mutex(true, GetMutexName(), out wasMutexCreatedNew))
        {
            if (wasMutexCreatedNew)
            {
                try
                {
                      //<your code here>
                }
                finally
                {
                    onlyOne.ReleaseMutex();
                }
            }
        }

    } 
```

抱歉，我来晚了...您需要在 GetMutexName() 方法调用中提供互斥锁名称。

# c# - 渲染嵌套服务器控件

> ID：684201
> 
> 赞同：0
> 
> 时间：2009-03-26T01:34:07.550
> 
> 标签：c#, .net, .net-2.0, controls

这应该相对容易。我不知道我为什么要为此苦苦挣扎，但谷歌无法帮助我找到一个我想做的例子。

我正在用 LI 构建一个简单的 UL 嵌套结构的导航/菜单。放置在页面上的父对象称为 NavController。它有一个 NavItem 集合。

所以我几乎让 NavController 处理构建基本 UI、创建 CSS 和 JavaScript。它还为最顶层的 LI 创建了基础 UL。根据我的研究和理解，UI 创建应该在 CreateChildControls 方法中完成。

这是我的代码：

```
protected override void CreateChildControls()
{
  Controls.Clear();

  this.Page.RegisterClientJavaScript("~/Resources/Script/SideNav.js");
  _ClientObject = this.GetClientJavaScriptObject("SideNav", this.ClientID);

  Controls.Add(_BaseContainer);

  HtmlGenericControl innerContents = this.BuildBaseContainer();
  this.BuildList(innerContents);

  _ClientObject.AddParameter("BaseContainerID", _BaseContainer.ClientID, true);
  _ClientObject.AddParameter("ImgId", _SideBarTabImg.ClientID, true);
  _ClientObject.AddParameter("SideBarContentsId", _SideBarContents.ClientID, true);

  base.CreateChildControls();
} 
```

BuildList 方法实际上构建了顶级 LI。我不确定如何调用此方法，但我可以看到它是。在 BuildList 函数中，我将 NavItem 对象添加到 innerContents 的 Controls 集合中。

首先，这是正确的吗？在 UL 中放置另一个自定义服务器控件（需要注意的是自定义控件基本上是呈现 LI；稍后会详细介绍）？

永远不会为 NavItem 调用 CreateChildControls。在互联网上环顾四周后，似乎是因为我从未调用 EnsureChildControls。这让我很困惑，因为它只会在 ChildControlsCreated 属性为 false 时触发。一旦它运行，这个属性就变成了真的。如果我在 NavItem 上有一个 Text 和 Href，并且在设置其中任何一个时调用 EnsureChildControls，那么如何将另一个的值放入任何子控件中？

只是为了阻塞一些屏幕空间，我到目前为止为 NavItem 编写了代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Text;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;

namespace AthletesCafe.Web.WebControls.SideNav
{
  [ToolboxData("<{0}:NavItem runat=server></{0}:NavItem>")]
  public class NavItem : ExtendedWebControl
  {
    private string _Text;
    private string _Value;
    private IList<NavItem> _ChildItems = new List<NavItem>();

private HtmlGenericControl _ListItem = new HtmlGenericControl("LI");
private HtmlAnchor _Link = new HtmlAnchor();
private HtmlGenericControl _SubList = new HtmlGenericControl("UL");

public string Text
{
  get
  {
    EnsureChildControls();
    return _Text;
  }

  set
  {
    EnsureChildControls();
    _Text = value;
    _Link.InnerText = _Text;
  }
}

public string Value
{
  get
  {
    EnsureChildControls();
    return _Value;
  }

  set
  {
    EnsureChildControls();
    _Value = value;
    _Link.HRef = _Value;
  }
}

protected override void CreateChildControls()
{
  Controls.Clear();
  Controls.Add(_ListItem);

  _ListItem.Controls.Add(_Link);

  base.CreateChildControls();
}

public NavItem AddChildItem(string text, string url)
{
  EnsureChildControls();

  NavItem newItem = new NavItem();
  newItem.Text = text;
  newItem.Value = url;

  _ChildItems.Add(newItem);
  this.BuildSubList();
  return newItem;
}

private void BuildSubList()
{
  _SubList.Controls.Clear();

  if (_ChildItems.Count > 0)
  {
    if (!_ListItem.Controls.Contains(_SubList))
      _ListItem.Controls.Add(_SubList);

    foreach (NavItem item in _ChildItems)
      _SubList.Controls.Add(item);
  }
}

protected override void Render(HtmlTextWriter writer)
{
  RenderContents(writer);
}

protected override void RenderContents(HtmlTextWriter writer)
{
  _ListItem.RenderControl(writer);
  //base.RenderContents(writer);
}

    public override string ToString()
    {
      EnsureChildControls();
      return _Text + " - " + _Value;
    }
  }
} 
```

我不明白为什么我不能只在它们的公共属性中设置值和文本，然后在渲染之前使用某种方法或方式将其放入控件中。

拜托，请给我指出正确的方法。我有一堆这些小控件，我需要让它们基本上执行相同的方法。我将很快开始一个基本的工具栏，这些信息会有所帮助！

编辑 - 放置显示列表构建的代码以进行澄清：

```
HtmlGenericControl list = new HtmlGenericControl("UL");
innerContents.Controls.Add(list);
foreach (NavItem item in _Items)
{
  list.Controls.Add(item);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T02:41:03.067

一旦你重写了 CreateChildControls()，你基本上负责确保你的嵌套控件被正确地创建。

您的方法似乎很标准，但是，对于您的简单属性，我认为您不需要调用 EnsureChildControls()。如果您从函数的 MSDN 文档中选择了这个，再看一下 - 他们给出的“文本”属性示例是从其子控件中检索文本值，这意味着属性访问器需要确保子控件存在控制。

您无法保证何时有人可以访问您的控件，这就是为什么您要在对 Controls 集合中的控件进行任何访问之前调用 EnsureChildControl() 的原因。在正常的页面生命周期中，当 ASP.net 开始向页面添加复合控件时，会调用 CreateChildControls()。如果没有人接触您的控件并且它没有数据绑定或任何东西，这可能不会发生，直到第一个页面加载上的 PreRender。

在随后的回发中，将在 ViewState 处理期间调用 CreateChildControls，或者任何代码都可能触发复合控件以开始创建它的子控件。例如，FindControl() 会自动执行 - 这可能发生在 OnInit() 中。

希望有帮助。我认为你在正确的轨道上。

# javascript - 具有固定标题和固定列的 HTML 表格？

> ID：684211
> 
> 赞同：61
> 
> 时间：2009-03-26T01:40:29.017
> 
> 标签：javascript, html, css, html-table

是否有 CSS/JavaScript 技术来显示一个长 HTML 表格，以便列标题在屏幕上保持固定，第一列保持固定并随数据滚动。

我希望能够滚动浏览表格的内容，但始终能够看到顶部的列标题和左侧的第一列。

如果有一个jQuery插件那就太好了！如果它有帮助，我唯一关心的浏览器就是 Firefox。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-08-20T15:27:37.063

[pranav 发布](http://fixed-header-using-jquery.blogspot.com/2009/05/scrollable-table-with-fixed-header-and.html)的链接的工作示例：

[http://jsbin.com/nolanole/1/edit?html,js,输出](http://jsbin.com/nolanole/1/edit?html,js,output)

仅供参考：在 IE 6、7 和 8（打开或关闭兼容模式）、FF 3 和 3.5、Chrome 2 中测试。不适合屏幕阅读器（标题不是内容表的一部分）。

编辑 5/5/14：将示例移至 jsBin。这是旧的，但令人惊讶的是，在当前的 Chrome、IE 和 Firefox 中仍然有效（尽管 IE 和 Firefox 可能需要对行高进行一些调整）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-13T18:41:24.527

**[jQuery DataTables 插件](http://datatables.net/index)**是实现类似于 excel 的固定列和标题的一种极好的方法 。

请注意站点的示例部分和“附加内容”。
[http://datatables.net/examples/](http://datatables.net/examples/)
[http://datatables.net/extras/](http://datatables.net/extras/)

“附加”部分具有用于固定列和固定标题的工具。

**固定列**
[http://datatables.net/extras/fixedcolumns/](http://datatables.net/extras/fixedcolumns/)
（我相信此页面上的示例最适合您的问题。）

**固定页眉**
[http://datatables.net/extras/fixedheader/](http://datatables.net/extras/fixedheader/)
（包括一个具有整页电子表格样式布局的示例：http: [//datatables.net/release-datatables/extras/FixedHeader/top_bottom_left_right.html](http://datatables.net/release-datatables/extras/FixedHeader/top_bottom_left_right.html)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T15:05:04.347

你可能正在寻找[**这个**](http://www.massless.org/_tests/grid1/?s=1&r=40&c=40)。

虽然它有一些已知问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-13T14:43:39.680

我看到这虽然是一个老问题，但却是插入我自己的脚本的好地方：

[http://code.google.com/p/js-scroll-table-header/](http://code.google.com/p/js-scroll-table-header/)

它无需配置即可工作，并且非常易于设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T05:40:09.673

如果您想要在表格中的数据垂直滚动时保持标题不变，您应该实现一个样式为“overflow-y：auto”的 <tbody> ，如下所示：

```
<table>
  <thead>
    <tr>
      <th>Header1</th>
       . . . 
    </tr>
   </thead>
   <tbody style="height: 300px; overflow-y: auto"> 
     <tr>
       . . .
     </tr>
     . . .
   </tbody>
 </table> 
```

如果 <tbody> 内容长于所需高度，它将开始滚动。但是，无论滚动位置如何，标题都将固定在顶部。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-24T17:21:47.307

在这个答案中，我还找到了对您的问题的最佳答案：

[带有固定标题的 HTML 表格？](https://stackoverflow.com/questions/673153/html-table-with-fixed-headers/673162#673162)

**并基于纯 CSS**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-28T18:37:55.787

```
<script>
   $(document).ready(function () {
   $("#GridHeader table").html($('#<%= GridView1.ClientID %>').html());
   $("#GridHeader table tbody .rows").remove();
   $('#<%= GridView1.ClientID %> tr:first th').hide();
});
</script>

<div id="GridHeader">
    <table></table>
</div>

<div style="overflow: auto; height:400px;">
    <asp:GridView ID="GridView1" runat="server" />
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-27T04:05:35.923

不是很完美，但它让我比这里的一些顶级答案更接近。

两个不同的表，一个带有标题，另一个用 div 包裹内容

```
<table>
  <thead>
    <tr><th>Stuff</th><th>Second Stuff</th></tr>
  </thead>
</table>
<div style="height: 600px; overflow: auto;">
  <table>
    <tbody>
      //Table
    </tbody>
  </table>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-29T20:30:24.190

我创建了具有固定页眉、固定页脚、固定左列和固定右列的东西。这只能在 IE 中正常工作。由于大多数用户仍在使用 IE，这可能会有所帮助。[请在Scrollable Table](http://s7u.blogspot.com/2008/07/dear-friends-i-want-to-discuss-about.html)中找到代码。请告诉我你的建议。

同时我正在努力修复其他浏览器中的列。我会及时向大家发布。:-)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-03-26T01:45:54.447

我知道你可以[为 MSIE 做到这一点](http://web.tampabay.rr.com/bmerkey/examples/locked-column-csv.html)，[这个有限的例子](http://www.whirlywiryweb.com/q/dhtmlgems.asp)似乎适用于 firefox（不确定该技术的可扩展性）。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-03-26T02:00:50.107

第一列在标题正下方的单元格上有一个滚动条

```
<table>
    <thead>
        <th> Header 1</th>
        <th> Header 2</th>
        <th> Header 3</th>
    </thead>
    <tbody>
        <tr>
            <td>
                <div style="width: 50; height:30; overflow-y: scroll"> 
                    Tklasdjf alksjf asjdfk jsadfl kajsdl fjasdk fljsaldk 
                    fjlksa djflkasjdflkjsadlkf jsakldjfasdjfklasjdflkjasdlkfjaslkdfjasdf
                </div>
            </td>
            <td>
                Hello world
            </td>
            <td> Hello world2
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-03-26T09:46:17.833

[YUI DataTable](http://developer.yahoo.com/yui/datatable/)

I don't know if YUI DT has this feature but I won't be surprised if it does.

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2010-08-23T07:44:17.227

这是一个很好的 jQuery 插件，适用于所有浏览器！

您有一个固定的标题表，但没有固定其宽度。

检查它：[https ://github.com/benjaminleouzon/tablefixedheader](https://github.com/benjaminleouzon/tablefixedheader)

免责声明：我是插件的作者。

# matlab - Matlab 中的 DAQ 触发器

> ID：684212
> 
> 赞同：0
> 
> 时间：2009-03-26T01:40:31.527
> 
> 标签：matlab

我正在编写一个程序，该程序通过霍尔效应传感器检测物体的速度，这些传感器通过 DAQ（MCC USB-1408FS）运行到 MATLAB

出现的问题是我正在使用不间断扫描技术来检测 3 个传感器之一的状态。不幸的是，这意味着除非物体以程序运行的准确速率旋转经过每个传感器，否则我将看到瞬时速度（通过比较两个传感器之间的时间来完成）为零。

我需要传感器在它们被击中时向程序发出计数信号，而不是不断地扫描信号。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T16:28:26.887

您是否在*连续扫描*模式下运行 1408FS，而不是*软件*调速模式（[1408FS 用户手册](http://www.microdaq.com/measurement_computing/documents/usb-1408fs_usermanual.pdf)- 第 3-1 页）？无论哪种方式，听起来您的采样率都太慢而无法捕获来自传感器的信号。您还在使用 MATLAB 的 DAQ 工具箱吗？

我想到的另一点，根据您的描述，听起来您有 MATLAB 记录来自三个传感器（位于已知位置）中的每一个的信号之间的时间差。同样，如果您的采样率太慢，它会看起来好像您的对象已经从一个传感器瞬间移动到下一个传感器。也许，您可以将 DAQ 上的外部触发器与您的一个传感器一起使用。

我在成像您从传感器接收到的信号类型时遇到了一些困难。我认为它是某种阶跃函数。也就是说，当物体经过传感器时，传感器将读数为零并且脉冲短时间。就像是

> *   数据传感器 1：... 0, .25, .5, .75, 1, 1, 1, .75, .5, .25, 0, 0, 0, 0, 0...
> *   数据传感器 2：... 0, 0, 0, .25, .5, .75, 1, 1, 1, .75, .5, .25, 0, 0, 0 ...

当物体通过传感器时，信号会增加，然后减少回零。在这种情况下，传感器可能靠得太近，无法满足物体的速度。由于来自两个传感器的信号重叠。

只是我的2c。

# wpf - 如何将样式应用于 WPF 中的窗口控件？

> ID：684213
> 
> 赞同：9
> 
> 时间：2009-03-26T01:41:35.907
> 
> 标签：wpf, xaml, styles

我正在为 Window 设置样式，`App.xaml`如下所示：

```
<Application x:Class="MusicRepo_Importer.App" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:System="clr-namespace:System;assembly=mscorlib" StartupUri="TestMaster.xaml">
    <Application.Resources>

        <Style TargetType="Window">
            <Setter Property="WindowStyle" Value="None"></Setter>
        </Style>

    </Application.Resources>
</Application> 
```

我基本上希望每个窗口都将其 WindowStyle 的属性值设置为无（以删除默认的窗口框架和边框）；但它不起作用。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-26T02:06:53.133

我相信您必须命名样式并将其应用于每个窗口，如下所示..

在 app.xaml/resources..

```
<Style x:Key="MyWindowStyle" TargetType="Window">
    <Setter Property="WindowStyle" Value="None"></Setter>
</Style> 
```

然后在window.xaml ..

```
<Window x:Class="MusicRepo_Importer.MyWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="MyStyledWindow" Style="{StaticResource MyWindowStyle}"> 
```

这应该可行，但只是在资源中应用带有 TargetType for Window 的样式不会强制 Window 使用该样式，尽管它似乎适用于其他元素。

编辑：
找到一些有关将默认样式应用于窗口元素的信息。

> 如果您提供 TargetType，则该类型的所有实例都将应用该样式。但是派生类型不会......似乎。<Style TargetType="{x:Type Window}"> 不适用于您的所有自定义派生/窗口。<Style TargetType="{x:Type local:MyWindow}"> 将仅适用于 MyWindow。所以选项是
> 
> 使用您指定为要应用该样式的每个窗口的 Style 属性的键控样式。设计器将显示样式化的窗口。

来自问题：[如何在 app.xaml 中设置默认的 WPF 窗口样式？](https://stackoverflow.com/questions/431940/how-to-set-default-wpf-window-style-in-app-xaml/460750#460750)

回答这个问题的人有一个有趣的想法，即从应用了该样式的基本窗口继承。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-02T10:15:58.353

我知道这个问题已经很老了，但无论如何我都会回答。

这是在 C# 4.0 中对我来说很好的代码。它只是复制资源字典中所有子类的样式。

```
public partial class App : Application
{
    protected override void OnStartup(StartupEventArgs e)
    {
        if (this.Resources.Contains(typeof(Window)))
        {
            var types = Assembly.GetEntryAssembly().GetTypes();
            var subTypes = types.Where(x => x.IsSubclassOf(typeof(Window)));

            Style elementStyle = (Style)this.Resources[typeof(Window)];

            foreach (Type subType in subTypes)
            {
                if (!this.Resources.Contains(subType))
                {
                    this.Resources.Add(subType, elementStyle);
                }
            }
        }

        base.OnStartup(e);
    }
} 
```

现在，您的 App.xaml 样式应该适用于所有窗口。

ps 是的，我知道这不是最干净或最快的方式，但它确实有效。:)

# powershell - 在 PowerShell 中包含相关文件

> ID：684217
> 
> 赞同：61
> 
> 时间：2009-03-26T01:42:45.173
> 
> 标签：powershell, include, relative-path

我想包含具有这种伪语法的脚本文件：

```
Include '.\scripA.ps1' 
```

但我发现的唯一东西是这样的：

```
$thisScript = Split-Path -Path $MyInvocation.MyCommand.Definition -Parent
. ($thisScript + '.\scriptA.ps1') 
```

那是丑陋的。

有没有一些*很好的*方法来包含具有相对路径的脚本？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-11-26T11:42:31.587

您可以像这样使用 $PSScriptRoot 参数：

```
. "$PSScriptRoot\script.ps1" 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-26T09:45:40.957

您可以点源（包含）该文件：

. .\scriptA.ps1

要获取脚本的完整路径：

解析路径 .\scriptA.ps1

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-06-02T17:19:45.217

如前所述，点源是最简单的选择，尽管不是特别漂亮。但是，这种格式使它更清晰一点：

```
$ScriptDirectory = Split-Path $MyInvocation.MyCommand.Path
. (Join-Path $ScriptDirectory ScriptA.ps1) 
```

另外，关于**相对路径**的注释有助于明确说明：原始帖子似乎暗示想要相对于*当前工作目录*的路径；实际上，其目的是相对于*当前脚本的源目录*（如 alex2k8 自己的代码示例所示）。因此，这允许当前脚本访问来自同一存储库的其他脚本。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-26T01:44:05.183

不幸的是，没有，没有好的方法。PowerShell 在 V1 中并没有真正很好地支持这个想法。确实，您正在采取的方法是最好的方法

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-03-22T09:05:08.947

从 V2 开始（本机从 Win7/2008R2 开始；请参阅`$psversiontable.psversion`），您可以轻松地包含如下文件：

```
. "RelativeOrAbsolutePathToFile\include.ps1"

$result = FunctionInIncludeFile() 
```

参考：
[如何在脚本中复用windows powershell函数](http://blogs.technet.com/b/heyscriptingguy/archive/2010/08/10/how-to-reuse-windows-powershell-functions-in-scripts.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-08-14T17:51:59.873

您可以使用 $PSScriptRoot 和“Split-Path”指令使其干净地用于相对路径。 `. (($PSScriptRoot | Split-Path | Split-Path)+'somedir\ps\script.ps1')`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-18T15:09:23.270

这可能适用于任何目录，但如果您的起始目录不是您尝试包含的文件的直接先前目录，它将是一个 slooooooowwwww 查找。IOW，如果您的搜索起点是 c:\ 或其他驱动器号的根目录，那么这可能会非常慢。

. $(Resolve-Path -literal $(gci -Recurse include.ps1))

如果您在 PC 上开发脚本但需要将它们部署到将脚本作为计划任务运行的服务器，这将特别有效。

# java - 如何统一 java 堆栈中的日志记录格式

> ID：684219
> 
> 赞同：6
> 
> 时间：2009-03-26T01:43:26.327
> 
> 标签：java, logging, formatting

使用从 maven 开始的 Jetty Web 服务器，其中包括 iBatis、Spring、Jersey，其中一点点和一点点，我得到了具有多种格式的日志记录输出。

有些来自maven：

```
[INFO] [war:war]
[INFO] Exploding webapp... 
```

有些来自码头：

```
2009-03-25 21:01:27.781::INFO:  jetty-6.1.15
2009-03-25 21:01:28.218:/example:INFO:  Initializing Spring root WebApplicationContext 
```

有些来自春天：

```
INFO  ContextLoader - Root WebApplicationContext: initialization started (189)
INFO  XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/applicationContext.xml] (323) 
```

有些来自泽西岛：

```
Mar 25, 2009 9:01:29 PM com.sun.jersey.spi.spring.container.SpringComponentProviderFactory register 
```

还有一些来自我的代码：

```
INFO  ExampleApp - [User@14ef239 ...stuff] (69) 
```

我希望他们都使用标准的日志记录包（log4j、commons-logging、java-logging...）

*   是否有可能，将它们全部配置为使用相同格式的最简单方法是什么？*   以不同的格式保留它们有什么好处吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T22:39:56.493

这可以使用 logback 库及其桥接器来实现。它基本上包括从类路径中删除任何 log4j commons 或类似的 jar，粘贴 logback jar 文件并为 log4j 等桥接 jar。Spring、jersey 和 maven 将使用桥接工厂来实例化记录器，而记录器又将使用 logbak 生成统一的日志记录。

检查[http://logback.qos.ch/](http://logback.qos.ch/)和[http://www.slf4j.org/legacy.html](http://www.slf4j.org/legacy.html)

关键是将其他日志实用程序与单个全局记录器链接起来的桥梁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T22:18:19.167

您遇到的问题是应用程序正在使用不同的日志记录库。Jersey 将使用 JUL，Spring 将使用 commons-logging（如果它在你的类路径中，它将依次选择 log4j），而 Jetty 使用它自己的记录器。您可以通过让所有组件通过 JUL 登录来解决此问题。

首先，您需要从类路径中删除 log4j。使用排除或其他机制来确保不包含 log4j。这将防止 commons-logging 在 JUL 上选择 log4j 并使 Spring 以与 Jersey 相同的格式登录。

接下来，您需要配置 Jetty 以使用 commons-logging。[您可以在Maven Jetty 插件文档](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin "Maven 码头插件文档")页面上找到相关信息。

如果您的应用程序代码直接使用 log4j，您需要切换到 commons-logging 或 JUL。

Maven 我不太确定，但它可能有类似的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T01:50:17.417

我不知道有什么方法可以以有用的方式管理您所描述的内容。如果你很绝望，我能做的最好的建议是写一些东西来将不同的格式统一在一个保护伞下，并使用你喜欢的日志记录格式在那里管理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T01:57:14.543

我不认为您可以轻松地统一所有这些，因为您不知道每个框架都在使用什么。

如果您确定您对哪些感兴趣，那么您可以让每个输出到中心位置 /var/log/app 中的日志文件（例如在 linux 下）。从这里您可以编写一个简单的实用程序来解析每个日志文件并将数据按摩到您想要的格式的单个日志文件中。awk 实用程序非常擅长做这种事情。

或者，您可以将它们保留原样 - 并使用 Splunk 之类的工具来索引文件以供将来搜索和分析。这实际上取决于您以后对日志文件的要求。希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T04:21:51.560

如果并且当他们使用标准日志记录包时，您当然可以统一公共部分（“INFO”前缀、时间戳、类别名称（通常是类/包））。只需根据自己的喜好配置 log4j / JUL / logback。我不知道为什么你会得到不同的格式——日志格式不是由框架配置的，而是应用程序——所以也许他们使用不同的框架。但这可能是偶然的。

至于是否重要；好吧，只有当您自动处理它（触发基于正则表达式的警报）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T17:23:42.850

SLF4J 允许您通过将日志路由到单个日志框架来整合日志。您可以将使用 commons-logging、java.util.logging 和 log4j 进行的旧式日志记录调用重定向到 SLF4J。有关详细信息，请参见 www.slf4j.org/legacy.html。

然后，所有日志记录都将委托给您选择的底层框架，例如 logback、log4j、java.util.logging 等。如果您遇到问题，请联系 slf4j-user 邮件列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T17:26:09.100

我认为我们最终将需要一个“日志记录 API”日志记录 API，它将所有统一的日志记录 API（例如 slf4j）和其他任何日志 API 联系在一起。谁知道呢，有一天你可能需要改变你的日志框架来处理所有类型的日志......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-15T09:07:45.713

只需使用[http://logback.qos.ch/translator/](http://logback.qos.ch/translator/)将 log4j.properties 转换为 xml 格式并将其粘贴到 logback.xml 中。这可以作为将您的日志引导到配置的附加程序的魅力。

# php - 在 PHP 中调试 DOMDocument 对象

> ID：684227
> 
> 赞同：21
> 
> 时间：2009-03-26T01:46:03.650
> 
> 标签：php, domdocument

我正在尝试在 php 中调试一个大而复杂的 DOMDocument 对象。理想情况下，如果我能让 DOMDocument 以类似数组的格式输出，那就太好了。

DoM文档：

```
$dom = 新的 DOMDocument();
$dom->loadHTML("<html><body><p>Hello World</p></body></html>");
var_dump($dom); //或类似的东西
```

这输出

```
DOMDocument 对象 ( )
```

而我希望它输出

```
DOM文档：
html
=>身体
==>p
===>你好世界
```

或类似的东西。为什么没有方便的调试或输出？！？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-12-25T22:50:17.870

这个答案可能有点晚了，但我喜欢你的问题！

PHP 没有任何内置功能可以直接解决您的问题，因此没有 XML 转储之类的东西。

但是，PHP 的[`RecursiveTreeIterator`^(*文档*)](http://php.net/RecursiveTreeIterator)与您的输出非常接近：

```
\-<html>
  \-<body>
    \-<p>
      \-Hello World 
```

（如果您的 X(HT)ML 结构看起来更复杂，它会更好看。）

它的使用非常简单（与大多数迭代器一样）`foreach`：

```
$tree = new RecursiveTreeIterator($iterator);
foreach($tree as $key => $value)
{
    echo $value . "\n";
} 
```

（您可以将其包装在一个函数中，因此您只需要调用该函数）

即使这看起来很简单，但有一个警告：它需要一个`RecursiveIterator`over the `DOMDocument`tree。由于 PHP 无法猜测您需要什么，因此需要将其包装到代码中。正如所写的那样，我发现这个问题很有趣（显然您没有要求 XML 输出），所以我编写了一些小代码来提供所需的递归迭代器。所以我们开始吧。

首先，您可能不熟悉 PHP 中的迭代器。这与使用我将展示的代码无关，因为我将*向后*执行，但是，每当您考虑自己运行某些代码时，请考虑是否可以利用 PHP 必须提供的迭代器功能. 我之所以这么写，是因为它有助于解决常见问题，并使彼此并不真正相关的组件能够相互协作。例如，[`RecursiveTreeIterator`^(*Docs*)](http://php.net/RecursiveTreeIterator)是内置的，它可以与您提供的任何内容一起使用（您甚至可以对其进行配置）。但是，它需要`RecursiveIterator`操作。

`RecursiveIterator`所以让我们给它一个标签（元素），`<tag>`如果它们是文本节点：`DOMNodes``text`

```
class DOMRecursiveDecoratorStringAsCurrent extends RecursiveIteratorDecoratorStub
{
    public function current()
    {
        $node = parent::current();
        $nodeType = $node->nodeType;

        switch($nodeType)
        {
            case XML_ELEMENT_NODE:
                return "<$node->tagName>";

            case XML_TEXT_NODE:
                return $node->nodeValue;

            default:
                return sprintf('(%d) %s', $nodeType, $node->nodeValue);
        }
    }
} 
```

此类`DOMRecursiveDecoratorStringAsCurrent`（名称仅为示例）使用`RecursiveIteratorDecoratorStub`. 然而，重要的部分是`::current`只返回[括号](http://en.wikipedia.org/wiki/Bracket)[^(*Wikipedia*)](http://en.wikipedia.org/wiki/Bracket) ( )中`tagName`的 a和 textnodes 的文本的函数。这就是你的输出所需要的，所以这就是编码所需的一切。`DOMNode`[](http://en.wikipedia.org/wiki/Bracket)*`<>`*

 *实际上，除非您也拥有抽象代码，否则这不起作用，但是为了可视化代码的使用方式（最有趣的部分），让我们查看它：

```
$iterator = new DOMRecursiveDecoratorStringAsCurrent($iterator);
$tree = new RecursiveTreeIterator($iterator);
foreach($tree as $key => $value)
{
    echo $value . "\n";
} 
```

由于它是向后完成的，目前我们已经指定了输出，基于哪个输出`DOMNode`将由`RecursiveTreeIterator`. 到目前为止很好，很容易得到。但是缺少的肉在抽象代码中，以及如何`RecursiveIterator`在`DOMElement`. 只需预览整个代码是如何被调用的（如前所述，您可以将其放入一个函数中，以便在您的代码中轻松访问它以进行调试。可能是一个名为 的函数`xmltree_dump`）：

```
$dom = new DOMDocument();
$dom->loadHTML("<html><body><p>Hello World</p></body></html>");
$iterator = new DOMRecursiveIterator($dom->documentElement);
$iterator = new DOMRecursiveDecoratorStringAsCurrent($iterator);
$tree = new RecursiveTreeIterator($iterator);
foreach($tree as $key => $value)
{
    echo $value . "\n";
} 
```

那么除了已经涵盖的代码之外，我们在这里得到了什么？首先有一个`DOMRecursiveIterator`- 就是这样。其余代码是标准`DOMDocument`代码。

所以让我们写一下`DOMRecursiveIterator`。它是`RecursiveIterator`最终需要在`RecursiveTreeIterator`. 它被*修饰*，以便树的转储实际上在括号中打印标记名并按原样显示文本。

现在可能值得分享它的代码：

```
class DOMRecursiveIterator extends DOMIterator implements RecursiveIterator
{
    public function hasChildren()
    {
        return $this->current()->hasChildNodes();
    }
    public function getChildren()
    {
        $children = $this->current()->childNodes;
        return new self($children);
    }
} 
```

这是一个非常短的课程，只有两个功能。我在这里作弊，因为这个类也是从另一个类扩展而来的。但正如所写，这是倒退的，所以这个类实际上负责递归：`hasChildren`和`getChildren`. 显然，即使这两个函数也没有太多代码，它们只是将“问题”（`hasChildren`？？`getChildren`）映射到标准`DOMNode`。如果一个节点有子节点，那么，说是或者只是返回它们（这是一个迭代器，以迭代器的形式返回它们，因此返回`new self()`）。

因此，由于这很短，因此在扼杀它之后，只需继续父类`DOMIterator` （[`implements RecursiveIterator`^(*文档*)](http://php.net/RecursiveIterator)只是为了使其工作）：

```
class DOMIterator extends IteratorDecoratorStub
{
    public function __construct($nodeOrNodes)
    {
        if ($nodeOrNodes instanceof DOMNode)
        {
            $nodeOrNodes = array($nodeOrNodes);
        }
        elseif ($nodeOrNodes instanceof DOMNodeList)
        {
            $nodeOrNodes = new IteratorIterator($nodeOrNodes);
        }
        if (is_array($nodeOrNodes))
        {
            $nodeOrNodes = new ArrayIterator($nodeOrNodes);
        }

        if (! $nodeOrNodes instanceof Iterator)
        {
            throw new InvalidArgumentException('Not an array, DOMNode or DOMNodeList given.');
        }

        parent::__construct($nodeOrNodes);
    }
} 
```

这是 的基本迭代器[`DOMPHP`](http://php.net/manual/en/book.dom.php)，它只需要 a[`DOMNode`](http://php.net/DOMNode)或 a[`DOMNodeList`](http://php.net/DOMNodeList)来迭代。这听起来可能有点多余，因为 DOM`DOMNodeList`已经支持这种类型的 with，但它不支持 a`RecursiveIterator`并且我们已经知道我们需要一个用于`RecursiveTreeIterator`输出。所以在它的构造*函数*`Iterator`中创建并传递给父类，这又是抽象代码。当然，我会在一分钟内揭示这段代码。由于这是倒退的，让我们回顾一下到目前为止所做的事情：

*   `RecursiveTreeIterator`用于树状输出。
*   `DOMRecursiveDecoratorStringAsCurrent``DOMNode`用于树中 a 的可视化
*   `DOMRecursiveIterator`并`DOMIterator`递归遍历 a 中的所有节点`DOMDocument`。

就定义而言，这就是所需要的，但是我称之为抽象的代码仍然缺失。它只是某种简单的代理代码，它将相同的方法委托给另一个对象。一个相关的模式称为*装饰器*。但是，这只是代码，首先是`Iterator`，然后是`RecursiveIterator`朋友：

```
abstract class IteratorDecoratorStub implements OuterIterator
{
    private $iterator;
    public function __construct(Iterator $iterator)
    {
        $this->iterator = $iterator;
    }
    public function getInnerIterator()
    {
        return $this->iterator;
    }
    public function rewind()
    {
        $this->iterator->rewind();
    }
    public function valid()
    {
        return $this->iterator->valid();
    }
    public function current()
    {
        return $this->iterator->current();
    }
    public function key()
    {
        return $this->iterator->key();
    }
    public function next()
    {
        $this->iterator->next(); 
    }
}

abstract class RecursiveIteratorDecoratorStub extends IteratorDecoratorStub implements RecursiveIterator
{
    public function __construct(RecursiveIterator $iterator)
    {
        parent::__construct($iterator);
    }
    public function hasChildren()
    {
        return $this->getInnerIterator()->hasChildren();
    }
public function getChildren()
{
    return new static($this->getInnerIterator()->getChildren());
}
} 
```

这没什么神奇的，它只是很好地将方法调用委托给它的继承对象`$iterator`。看起来重复和迭代器都是关于重复的。我把它放到抽象类中，所以我只需要编写一次这个非常简单的代码。所以至少我自己不需要重复自己。

这两个抽象类被前面已经讨论过的其他类使用。因为它们很简单，所以我把它留到了这里。

好吧，直到这里还有很多要读的东西，但好的部分是，就是这样。

简而言之：PHP 没有此构建，但您可以自己编写它，非常简单且可重用。如前所述，最好将其包装到一个名为的函数`xmltree_dump`中，以便可以轻松地调用它以进行调试：

```
function xmltree_dump(DOMNode $node)
{
    $iterator = new DOMRecursiveIterator($node);
    $decorated = new DOMRecursiveDecoratorStringAsCurrent($iterator);
    $tree = new RecursiveTreeIterator($decorated);
    foreach($tree as $key => $value)
    {
        echo $value . "\n";
    }
} 
```

用法：

```
$dom = new DOMDocument();
$dom->loadHTML("<html><body><p>Hello World</p></body></html>");
xmltree_dump($dom->documentElement); 
```

唯一需要的是包含/需要所有使用的类定义。您可以将它们放在一个文件中，然后`require_once`将它们与您可能正在使用的自动加载器一起使用或集成。[一次完整的代码](https://gist.github.com/1519893)。

如果需要编辑输出方式，可以编辑`DOMRecursiveDecoratorStringAsCurrent`或更改`RecursiveTreeIterator­`里面的配置`xmltree_dump`。希望这会有所帮助（即使很长，*倒退*也很直接）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-03-17T16:04:15.287

[http://usphp.com/manual/en/function.dom-domdocument-savexml.php](http://usphp.com/manual/en/function.dom-domdocument-savexml.php)

```
$dom->formatOutput = true;
echo $dom->saveXML(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-12-16T22:18:29.083

对于 dom 节点，只需使用以下内容：

```
print_r(simplexml_import_dom($entry)->asXML()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T05:02:08.017

虽然我自己没有尝试过，但请查看[Zend_Dom](http://framework.zend.com/manual/en/zend.dom.html)，它是[Zend Framework](http://framework.zend.com)的一部分。大多数 Zend Framework 组件的文档和示例非常全面。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-26T16:59:11.837

我刚刚使用了 DOMDocument::save。它必须写入文件很糟糕，但无论如何。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-17T19:20:57.500

您可以作弊并使用 JSON 通过将其转换为数组来检查结构。

```
print_r(json_decode(json_encode($node), true)); 
```

# reporting-services - SSRS：单击查看报告时，ASP.NET ReportViewer 参数重置为默认值

> ID：684250
> 
> 赞同：1
> 
> 时间：2009-03-26T01:53:26.910
> 
> 标签：reporting-services, parameters, ssrs-2008

我有一个 SQL Reporting Services 报告（使用 Report Builder v2.0 构建的 SQL 2008），它有一个多选整数参数（在本例中为商店列表）。

默认值为`0`（“所有商店”）。参数作为`varchar(1024)`.

这一切都可以在报表生成器或 Reporting Services 网站上正常工作。

但是，在使用该组件的 ASP.NET 网站上`ReportViewer`，每次选择“查看报告”时，参数都会重置为默认值。

我尝试将视图设置为非异步加载（更改渲染容器？）加上我能找到的任何其他设置，但没有成功。有谁知道解决这个问题的技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T21:56:11.610

我犯了一个错误。该`ReportViewer`控件位于母版页内。每次单击“查看报告”按钮时，它都会进行回发并重置会话。

我`if (!IsPostBack)`在报告设置方法之前添加了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T17:01:19.583

我发现与原始海报类似的代码错误。每次加载页面时，我都会（重新）设置报表服务器凭据，而不仅仅是在初始化时。显然，设置报告凭据会重置所有参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T18:05:36.123

For those of you who experience this error for reasons not listed by the original poster...

Here is a similar scenario.

You have a report which uses a multi-select report parameter. This parameter is populated by a datasource, which bases its values off some table query.

When you use the 'Select All' option for this report parameter and press the 'View Report' button, the parameter is reset to blank and your report is not generated.

I believe this problem occurs because something invalidates your dataset while the query is being performed, but I cannot be 100% certain.

What I do know, is that by using a table variable as the dataset's query source, you make this problem go away.

For example, your CityDataSource could be populated by the query:

```
SELECT DISTINCT city, city as SortOrder from accounts
UNION
SELECT 'All' as city, '0' as SortOrder
ORDER BY SortOrder 
```

If you've been making SQL Reporting Services reports, you may have stumbled upon this solution once or twice.

Now, we change the CityDataSource query to look like the following:

```
DECLARE @citytable TABLE (city varchar(255), sortorder varchar(255))
INSERT INTO @citytable (city, sortorder) VALUES
(
SELECT DISTINCT city, city as SortOrder from accounts
)
SELECT city, sortorder FROM @citytable ORDER BY sortorder 
```

And by doing that your report's parameters won't reset anymore.

A stored procedure would also work, I suspect.

# wine - 了解大量未记录的源代码？

> ID：684251
> 
> 赞同：17
> 
> 时间：2009-03-26T01:53:38.843
> 
> 标签：wine, codebase

我一直对[Wine](http://www.winehq.org/)感到惊讶。有时我想破解它，修复一些小问题并大致了解它是如何工作的。所以，我[下载了 Wine 源代码](http://www.winehq.org/download/)，然后我就感到不知所措。代码库非常庞大，而且 - 与 Linux 内核不同 - 几乎没有关于代码的指南。

理解如此庞大的代码库的最佳实践是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-26T02:28:34.267

对于复杂的代码库，您可能犯的最大错误就是试图成为一台计算机。让计算机运行代码，并使用调试器帮助找出发生了什么。

1.  弄清楚如何从现有的源代码编译、安装和运行您自己的 Wine 版本。

2.  了解如何在您的 Wine 版本的运行实例上进行调试（例如使用 gdb）。

3.  在调试器下运行 Wine 并使其显示不受欢迎的行为。

4.  有趣的部分：找到代码执行路径的去向，并开始学习它们是如何结合在一起的。

是的，阅读大量代码会有所帮助，但是编译器/调试器/计算机可以比您更快地运行代码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-26T05:33:43.010

一位教授曾经告诉我们，把这种情况比作爬山。您可能正在听有人这样做，并告诉您眺望这个国家是什么感觉。你会毫不犹豫地相信那是一个壮观的景象。

但是，您必须开始攀登自己才能真正了解从顶部看到的景色。

而且一路爬到顶峰也不是那么重要。仅仅达到高于地面的高度可能就足够了。

但永远不要害怕开始攀登。这种观点总是值得任何努力。

* * *

这对我来说一直是一个很好的类比。我知道这个问题更多的是关于如何在开始攀爬后有效处理代码库的具体技巧。但是，它立刻让我想起了我们当时的物理课。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-26T02:38:55.957

（这是我不久前发布的一个问题的答案。我对其进行了一些修改以适应这个问题。）

经验告诉我，在学习遗留系统时，你有 3 个主要目标：

1.  了解代码应该做什么。
2.  了解它是如何做到的。
3.  （至关重要）了解为什么它会这样做。

所有这三个部分都非常重要，并且有一些技巧可以帮助您入门。

首先，抵制只是通过 ctrl-click（或任何您的 IDE 使用的方式）围绕代码来理解所有内容的诱惑。您可能无法以这种方式将所有内容都放在脑海中，尤其是当每一行都迫使您查看多个其他类以了解它是什么时，因此您需要能够掌握多个级别的堆在你的头上。

尽可能阅读文档；它通常可以帮助您快速获得构建后续所有内容的思维框架。

尽可能运行测试用例。

不要害怕问知道你是否有问题的人。诚然，您不应该将其他人的时间浪费在无意义的查询上，但是如果您根本不理解某些内容（对于更多概念性问题尤其如此，例如“将其实现为更有意义吗？ ___”或其他东西），在你把事情搞砸并且不知道为什么之前找出答案可能是值得的。

当你最终开始阅读代码时，从一个合乎逻辑的“主要”位置开始，然后从那里开始。不要只是从上到下阅读代码，或者按字母顺序，或者任何东西（这可能很明显）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-26T02:05:05.213

熟悉大型代码库的最好方法是深入研究。许多项目都有一个需要完成的简单任务列表，它们通常是为了帮助人们轻松完成而保留的。你应该找到并处理其中的一些; 您将学到很多关于一般代码大纲和结构的知识，为项目做出贡献，并获得轻松的回报，这将有助于鼓励您承担更大的任务。

与大多数项目一样，WINE 为其开发人员提供了良好的资源。IRC、wiki、邮件列表和指南/概述。对于大多数令人生畏的代码库，在最初的几个修复之后它并不那么可怕。WINE 确实很大，而且很像内核，我怀疑在所有系统中都没有专家。也不觉得你需要。开始做一些对你很重要的事情，然后从那里开始。

我自己已经为 WINE 打了几个补丁，这是一个很好的社区和良好的结构。有很多非常有用的调试消息，这是一个非常酷的项目，可以帮助你更长时间地完成它。

我们都感谢您为 WINE 提供帮助的勇气和意愿（它需要它）。谢谢，祝你好运。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-26T01:56:40.117

深入挖掘。想一个你想回答的问题，然后试着找到答案。当您厌倦了阅读代码时，请阅读开发邮件列表、[开发人员指南](http://www.winehq.org/site/docs/winedev-guide/index)或[wiki](http://wiki.winehq.org/)。

不幸的是，理解大型代码库没有捷径可走。如果您喜欢这种事情（我喜欢），那么您会很开心。如果没有，指南书不会真正帮助你，所以你的情况并没有那么糟糕。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-26T02:03:20.020

寻找您有兴趣改进的一项特殊功能。搜索它的实现。一旦你找到它，拉上那根稻草，其余的都会随之而来。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-26T02:07:53.007

最好的方法是通过评论。我具有讽刺意味，因为您了解野兽的微小部分添加评论，以便您可以跟踪您的踪迹。如果您在代码中添加缺少的指南，其他开发人员也会喜欢它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-26T02:11:06.367

正如其他人所建议的那样，深入研究！阅读您可以吸收的所有可用文档。然后看看您是否可以找到其他感兴趣或知识渊博的人并与他们一起学习。它有助于让人们从思想中汲取灵感并提出问题。

对于 C 源代码，一旦您对想要处理的代码区域有所了解，就可以为该代码生成[ctags](http://ctags.sourceforge.net/)和[cscope](http://cscope.sourceforge.net/)数据库。这些工具使跳转和理解代码变得更加容易。许多文本编辑器（例如[gvim](http://www.vim.org/)）都支持 ctags 和 cscope，因此您可以轻松跳转。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-26T02:11:20.173

尝试在代码中实现一些微小的变化，这对你来说是可见的。这可能是找出一种可行的方式来输出调试语句（并找出输出出现的位置），它可能正在改变窗口的默认大小或桌面颜色，或其他东西。一旦你可以在代码库中**做一些事情**，你就已经触及了理解的表面，并且可以开始转向更复杂的事情。此时，选择一个您希望代码执行的稍微有用的目标，并实现它。或者查看项目的错误跟踪器并寻找一些小的开始。

随手记录，随手编写单元测试，随手重构。当您弄清楚例程的作用时，请发表评论！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-19T04:57:28.623

（警告：前面的无耻营销）

对于使用 Eclipse 的 Java 开发人员，有[nWire](http://www.nwiresoftware.com/)。它是一个用于导航和可视化大型代码库的 Eclipse 插件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-26T02:09:24.890

理解大型系统的一个好方法是将其分解为它的组成部分，并专注于通过应用程序的特定路径。

您的调试器是您的朋友，在您要调查的线程中设置一个断点，然后逐行逐行查看每个部分的功能......希望对您有所帮助......

# c# - 如何在 Castle.Windsor 中配置提供多种服务的单个组件实例？

> ID：684257
> 
> 赞同：6
> 
> 时间：2009-03-26T01:57:28.413
> 
> 标签：c#, inversion-of-control, castle-windsor

我想配置 Windsor 容器，以便单个、单例样式的实例可以通过容器提供两个或多个服务。

我发现在多个组件声明（基于 XML 的配置）中使用相同类型将导致创建该类型的实例以提供每个组件的服务接口，这不是我想要的行为。

例如：

```
interface IA { }
interface IB { }
class AB : IA, IB { ... } 
```

我希望 AB 的一个实例同时提供 IA 和 IB 服务。

我想这样做的具体原因是我的具体 DAO 实现扩展了多个接口。另一方面，我有几个工作组件，它们包含对不同接口的引用。具体的 DAO 实例尊重这一点，但这些单独的工作组件的构造函数希望实现其单独的接口，我希望 Castle.Windsor 通过各自的服务请求将相同的对象实例传递给这些工作容器。

大声笑，我认为那很清楚！:P

有谁明白我的意思，有没有人知道如何通过组件的 XML 配置来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:14:58.913

您是否检查过似乎是您正在寻找的[这个问题的答案（尤其是论坛帖子链接）。](https://stackoverflow.com/questions/483515/how-does-castle-windsor-respond-to-a-class-which-implements-multiple-interfaces)一些示例使用瞬态生命周期，但我认为它也适用于 Singleton。

[论坛帖子](http://forum.castleproject.org/viewtopic.php?p=14725&sid=f94e87a29e0f4b3c65c62ccd67a064b7)的主要收益是：

```
container.Register(Component.For<IEntityIndexController, ISnippetController>()
.ImplementedBy<SnippetController>()
.LifeStyle.Transient); 
```

解决方案是使用流利的界面（和最近的主干构建），并且我上次看到无法在 xml 中进行配置。但是，它[可能](https://stackoverflow.com/questions/274220/does-castle-windsor-support-forwardedtypes-via-xml-configuration)有一个设施。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-15T07:24:09.813

您是否尝试过使用以下`Forward`方法：

```
container.Register(Component.For<IEntityIndexController>()
.ImplementedBy<SnippetController>()
.Forward (typeof(ISnippetController))
.LifeStyle.Transient); 
```

从我的实验和文档中：

> 代表该组件注册服务类型

我认为它应该做的伎俩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T14:36:38.760

你可以注册一个对象的实例（而不是一个实现）来负责不同的实现：

```
 var ab = new AB();
  container.Register( Component.For<IA>().Instance( ab) );
  container.Register( Component.For<IB>().Instance( ab) ); 
```

我相信这应该有效。但是，出于明显的原因，这需要代码配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-05T15:38:15.973

我正在寻找相同的答案，而这篇文章是我用谷歌所能得到的最远的。我发现使用

```
Classes.FromThisAssembly().Where(t => t.FullName == "Namespace.Classname").WithServiceAllInterfaces() 
```

似乎对我有用。

# sql - 需要复杂的sql查询帮助

> ID：684259
> 
> 赞同：1
> 
> 时间：2009-03-26T01:58:00.860
> 
> 标签：sql

我不确定如何用 SQL 编写这个查询。有两张桌子

```
**GroupRecords**
Id (int, primary key)
Name (nvarchar)
SchoolYear (datetime)
RecordDate (datetime)
IsUpdate (bit)

**People**
Id (int, primary key)
GroupRecordsId (int, foreign key to GroupRecords.Id)
Name (nvarchar)
Bio (nvarchar)
Location (nvarchar) 
```

返回属于 GroupRecords 且 SchoolYear 为“2000”的人员的不同列表。在返回的列表中，people.name 应该是唯一的（没有重复的 People.Name），如果重复，则只应返回属于 GroupRecords 且 RecordDate 较晚的人。

为此编写一个存储过程可能会更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T02:07:01.900

```
Select Distinct ID 
From People 
Where GroupRecordsID In 
   (Select Id From GroupRecords
    Where SchoolYear = '2000/1/1') 
```

这将生成 2000 级中这些人的不同列表...但我不明白您对 cpmment 的重复内容有何看法...请详细说明...

读起来好像你在谈论当两个不同的人碰巧有相同的名字时，你不希望他们都被列出......这真的是你想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T02:12:19.033

MySQL特定：

```
SELECT *
FROM `People`
LEFT JOIN `GroupRecords` ON `GroupRecordsId` = `GroupRecords`.`Id`
GROUP BY `People`.`Name`
ORDER BY `GroupRecords`.`RecordDate` DESC
WHERE `GroupRecords`.`SchoolYear` = '2000/1/1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T02:37:59.750

> people.name 应该是唯一的（没有重复的 People.Name）

? 当然，您的意思是没有重复的 People.ID？

> 在重复的情况下，只应返回属于 GroupRecords 且 RecordDate 较晚的人。

有一个问题——这就是在普通 SQL 中如何做并不明显。“对于每个 X，选择具有最大/最小 Z 的行 Y”问题有多种方法；哪种工作和哪种性能更好取决于您使用的数据库软件。

[http://kristiannielsen.livejournal.com/6745.html](http://kristiannielsen.livejournal.com/6745.html)对一些常用的攻击技术进行了很好的讨论（在 MySQL 的上下文中，但广泛适用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T03:11:03.760

这是未经测试的，但它应该满足问题的要求。

它选择有关此人的所有详细信息。

子查询将使其仅匹配单个名称的最新 RecordDate。由于 id 之间的匹配，它也只会在正确的 GroupRecord 中查找。

```
SELECT
    People.Id,
    People.GroupRecordsId,
    People.Name,
    People.Group,
    People.Bio,
    People.Location

FROM
    People
    INNER JOIN GroupRecords ON GroupRecords.Id = People.GroupRecordsId

WHERE
    GroupRecords.SchoolYear = '2000/1/1' AND
    GroupRecords.RecordDate = (
        SELECT 
            MAX(GR2.RecordDate)
        FROM 
            People AS P2
            INNER JOIN GroupRecords AS GR2 ON P2.GroupRecordsId = GR2.Id
        WHERE
            P2.Name = People.Name AND
            GR2.Id = GroupRecords.Id
    ) 
```

# c# - 在 C# 中的抽象类上使用接口

> ID：684260
> 
> 赞同：20
> 
> 时间：2009-03-26T01:58:32.060
> 
> 标签：c#, inheritance, interface, abstract-class

我正在学习来自 C++ 的 C# 并且遇到了障碍。

我有一个抽象类 AbstractWidget、一个接口 IDoesCoolThings 和一个派生自 AbstractWidget 的类，称为 RealWidget：

```
public interface IDoesCoolThings
{
    void DoCool();
}

public abstract class AbstractWidget : IDoesCoolThings
{
    void IDoesCoolThings.DoCool()
    {
        Console.Write("I did something cool.");
    }
}

public class RealWidget : AbstractWidget
{

} 
```

当我实例化一个 RealWidget 对象并在其上调用 DoCool() 时，编译器给我一个错误说

> “RealWidget”不包含“DoCool”的定义

我可以将 RealWidget 对象转换为 IDoesCoolThings，然后调用将起作用，但这似乎没有必要，而且我也失去了多态性（即使我定义了 RealWidget.DoCool()，AbstractWidget.DoCool() 也将始终被调用）。

我想解决方案很简单，但是我尝试了很多方法，但我一生都无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-26T02:03:33.717

您遇到问题是因为您使用了**[*显式接口实现*](http://msdn.microsoft.com/en-us/library/aa288461(VS.71).aspx)**(EII)。当一个成员被显式实现时，它不能通过类实例访问——只能通过接口的实例。在您的示例中，这就是为什么您不能调用`DoCool()`，除非您将实例转换为`IDoesCoolThings`.

解决方案是`DoCool()`公开并删除显式接口实现：

```
public abstract class AbstractWidget : IDoesCoolThings
{
    public void DoCool()      // DoCool() is part of the abstract class implementation.
    {
        Console.Write("I did something cool.");
    }
}

// ...

var rw = new RealWidget();
rw.DoCool();                  // Works! 
```

通常，您在两种情况下使用 EII：

*   您有一个必须实现两个接口的类，每个接口都包含一个成员，该成员与另一个接口中的另一个成员具有相同的名称/签名。
*   您希望*强制*客户端不依赖于您的类的实现细节，而是依赖于您的类正在实现的接口。（有些人认为这是一种很好的做法。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-26T02:04:18.957

将您的声明更改为：

```
public abstract class AbstractWidget : IDoesCoolThings 
{
    public void DoCool()
    { 
        Console.Write("I did something cool."); 
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-26T02:04:38.833

如果选择隐式实现接口，则实现接口的方式是显式实现 void IDoesCoolThings.DoCool()。

```
public abstract class AbstractWidget : IDoesCoolThings
{
    public void DoCool()
    {
        Console.Write("I did something cool.");
    }
} 
```

然后它将起作用。

读这个 ：

[C# 接口。隐式实现与显式实现](https://stackoverflow.com/questions/143405/c-interfaces-implicit-and-explicit-implementation)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T07:38:24.580

你应该这样做：

```
public interface IDoesCoolThings 
{
   void DoCool();
}

public abstract class AbstractWidget 
{
   public void DoCool()
   {
      Console.WriteLine("I did something cool.");
   }
}

public class Widget : AbstractWidget, IDoesCoolThings 
{
} 
```

用法：

```
var widget = new Widget();
widget.DoCool(); 
```

# php - 如何将 PHP 数组编码为 JSON 数组，而不是对象？

> ID：684262
> 
> 赞同：9
> 
> 时间：2009-03-26T01:59:41.917
> 
> 标签：php, zend-framework, json

我正在尝试对从 Zend_DB 查询返回的数组进行 json_encode。

var_dump 给出：（手动添加 0 成员不会改变图片。）

```
array(3) {
  [1]=>
  array(3) {
    ["comment_id"]=>
    string(1) "1"
    ["erasable"]=>
    string(1) "1"
    ["comment"]=>
    string(6) "test 1"
  }
  [2]=>
  array(3) {
    ["comment_id"]=>
    string(1) "2"
    ["erasable"]=>
    string(1) "1"
    ["comment"]=>
    string(6) "test 1"
  }
  [3]=>
  array(3) {
    ["comment_id"]=>
    string(1) "3"
    ["erasable"]=>
    string(1) "1"
    ["comment"]=>
    string(6) "jhghjg"
  }
} 
```

编码后的字符串如下所示：

```
{"1":{"comment_id":"1","erasable":"1","comment":"test 1"},
 "2":{"comment_id":"2","erasable":"1","comment":"test 1"},
 "3":{"comment_id":"3","erasable":"1","comment":"jhghjg"}} 
```

我需要的是：

```
[{"comment_id":"1","erasable":"1","comment":"test 1"},
{"comment_id":"2","erasable":"1","comment":"test 1"},
{"comment_id":"3","erasable":"1","comment":"jhghjg"}] 
```

这就是 php.ini/json_encode 文档所说的应该是什么样子。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-26T02:13:21.730

你是如何设置你的初始数组的？

如果你像这样设置它：

```
array(
 "1" => array(...),
 "2" => array(...),
); 
```

那么你没有一个带有数字索引但字符串的数组，它被转换为 JS 世界中的一个对象。如果您没有设置严格的顺序（即从 0 而不是 1 开始），也会发生这种情况。

但是，这是在黑暗中拍摄的，因为我看不到您的原始代码：首先尝试在不使用键的情况下设置您的数组：

```
array(
 array(...),
 array(...),
); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-26T02:24:45.133

添加了扩展[Seb](https://stackoverflow.com/questions/684262/encode-array-to-json-in-php-to-get-elm1-elm2-elm3-instead-of-elm1-elm2-e/684299#684299)答案的信息。

```
php > print json_encode( array( 'a', 'b', 'c' ) ) ;
["a","b","c"]
php > print json_encode( array( 0 => 'a',  1 => 'b', 2 => 'c' ) ) ;
["a","b","c"]
php > print json_encode( array( 1 => 'a',  2 => 'b', 3 => 'c' ) ) ;
{"1":"a","2":"b","3":"c"}
php > 
```

注意：它以这种方式格式化它有充分的理由：

如果你要发送

```
{"1":"a","2":"b","3":"c"} 
```

作为

```
["a","b","c"] 
```

当你 `$data[1]` 在 Php 中这样做时，你会得到 "a"，但在 JavaScript 方面，你会得到 "b"。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T02:10:28.210

在 php 中测试传统的连续数组的一种常用方法是检查索引“0”。尝试将其添加到您的数组中，它可能会将其视为数组而不是哈希图。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-06-08T13:49:20.327

我有一个类似的问题，在 json_encode 字符串周围添加 '' （单引号）后让它工作。遵循我的 js 文件：

```
var myJsVar =  <?php echo json_encode($var); ?> ;    -------> NOT WORKING  
var myJsVar = '<?php echo json_encode($var); ?>' ;   -------> WORKING 
```

# image - Google 的图片颜色搜索是如何工作的？

> ID：684264
> 
> 赞同：19
> 
> 时间：2009-03-26T02:00:34.070
> 
> 标签：image, image-processing, colors, google-image-search

假设我查询

> [http://images.google.com.sg/images?q=sky&imgcolor=black](http://images.google.com.sg/images?q=sky&imgcolor=black)

我得到了所有的黑色天空，背后的算法实际上是如何工作的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-26T06:15:37.793

根据Google 工程师 Henry Rowley、Shumeet Baluja 和 Yushi Jing 博士发表的[这篇论文](http://www.cs.cmu.edu/~har/visapp2006.pdf "大规模基于图像的成人内容过滤")，您关于识别图像颜色的问题的最重要含义似乎与 google 的图片“saferank”算法有关，该算法可以在没有检测肤色的情况下检测肤色它周围的任何文字。

本文首先描述了“经典”方法，这些方法通常基于标准化颜色亮度，然后使用“[高斯分布](http://en.wikipedia.org/wiki/Gaussian_function)”或使用以像素为单位的 RGB 值构建的三维直方图（每种颜色都是0-255 的 8 位整数值，表示像素中包含多少 . 该颜色）。还引入了依赖于诸如“亮度”（通常被错误地称为“亮度”）等属性的方法，它是从给定图像到肉眼的发光强度密度。

谷歌论文提到他们将需要使用他们的算法处理大约 10^9 图像，因此它需要尽可能高效。为了实现这一点，他们在 ROI（感兴趣区域）上执行大部分计算，ROI（感兴趣区域）是一个以图像为中心的矩形，并且在所有侧面都插入了图像尺寸的 1/6。一旦他们确定了 ROI，他们就会有许多不同的算法应用于图像，包括人脸检测算法、颜色恒常性算法等，它们作为一个整体找到图像着色的*统计趋势*，最重要*的是找到颜色统计分布中频率最高的阴影。*

他们使用熵、边缘检测和纹理定义等其他特征来从图像中提取线条，他们使用计算的概率霍夫变换 (Kiryati et al., 1991) 的 OpenCV 实现 (Bradski, 2000)在肤色连接组件的边缘，这使*他们能够找到可能不是身体部位的直线*，另外还使他们能够更好地确定图像中哪些颜色最重要，这是他们图像颜色搜索的关键因素。

有关该主题的更多技术细节，包括数学方程式等，请阅读开头链接的谷歌论文并查看其网站的研究部分。

非常有趣的问题和主题！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-26T02:07:40.870

图像只是像素。像素只是 RGB 值。我们知道 RGB 中的黑色是什么，因此我们可以在图像中查找它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T02:06:27.783

嗯，一种方法是，用非常基本的术语来说：

给定一个图像语料库，确定给定颜色范围的高浓度（这实际上相当简单），存储此数据，相应地索引（根据上一步确定的颜色索引图像）。现在，您基本上拥有与查找包含某些单词的文档相同的功能。

这是对一种可能方法的非常非常基本的描述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:12:14.760

从图像中提取颜色的方法有很多种，我认为其他答案可以解决这些问题（K-Means、分布等）。

假设您已经提取了颜色，有几种按颜色搜索的方法。一种缓慢但明显的方法是使用某种度量（例如[Color Difference](http://en.wikipedia.org/wiki/Color_difference)）计算搜索颜色与图像的主要颜色之间的距离，然后根据“接近度”对结果进行加权。

另一种更快的方法是从本质上降低色彩空间的分辨率。与其处理所有可能的 RGB 颜色值，不如像 Google 那样将提取限制在更小的范围内（只有蓝色、绿色、黑色、黄色等）。然后，用户可以使用一组有限的色样进行搜索，计算颜色距离变得微不足道。

# c# - 禁用Windows窗体上的退出按钮？

> ID：684289
> 
> 赞同：4
> 
> 时间：2009-03-26T02:10:29.973
> 
> 标签：c#, .net, winforms

有没有办法在 Windows 窗体上禁用退出按钮而不必导入一些外部 .dll？我通过使用以下代码导入 dll 来禁用退出按钮，但我不喜欢它。有没有更简单（内置）的方法？

```
 public Form1()
    {
        InitializeComponent();
        hMenu = GetSystemMenu(this.Handle, false);
    }

    private const uint SC_CLOSE = 0xf060;
    private const uint MF_GRAYED = 0x01;
    private IntPtr hMenu;

    [DllImport("user32.dll")]
    private static extern IntPtr GetSystemMenu(IntPtr hWnd, bool bRevert);

    [DllImport("user32.dll")]
    private static extern int EnableMenuItem(IntPtr hMenu, uint wIDEnableItem, uint wEnable);

    // handle the form's Paint and Resize events 

    private void Form1_Paint(object sender, PaintEventArgs e)
    {
        EnableMenuItem(hMenu, SC_CLOSE, MF_GRAYED);
    }

    private void Form1_Resize(object sender, EventArgs e)
    {
        EnableMenuItem(hMenu, SC_CLOSE, MF_GRAYED);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T03:10:51.967

您不能轻易*禁用*退出按钮（关闭表单的右上角的那个）。

但是，您可以通过将该`ControlBox`属性设置为 false 来完全隐藏该按钮。

`ControlBox`可以随时打开和关闭，所以如果你想动态地允许在某些时候关闭，而不是在其他时候，你可以使用它。

或者，您可以选择处理 FormClosing 事件并取消关闭。

这是一个演示。

创建一个新的 Windows 窗体项目。

在窗体上放置一个 CheckBox 控件，文本为“ControlBox”。将其 Click 事件连接到此：

```
private void checkBox1_CheckedChanged(object sender, EventArgs e)
{
    ControlBox = checkBox1.Checked;
} 
```

然后，使用文本“取消关闭”将第二个 CheckBox 控件拖放到窗体上。将表单的 FormClosing 事件与此挂钩：

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = checkBox2.Checked;
} 
```

运行应用程序并开始使用复选框。你很快就会看到事情是如何运作的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-16T12:22:00.987

要禁用表单上的关闭按钮，只需在表单关闭事件中编写以下代码。

```
 private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        e.Cancel = true;
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T02:34:31.990

稍微闲逛发现了这个方便的助手类：

[禁用关闭按钮并防止表单被移动（C# 版本）](http://www.vbforums.com/showthread.php?t=544965)

它实际上比您正在寻找的更多，但本质上与您在示例代码中所做的几乎相同。助手类为您挂钩加载/调整大小事件，因此您不必记住自己做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T02:16:22.877

是的。

设置 form.ControlBox = false 将隐藏关闭按钮。虽然，它也会隐藏最小化和最大化按钮。

您还可以设置 form.FormBorderStyle = FormBorderStyle.None，这将隐藏整个标题栏。

如果您想显示 X 按钮但只是阻止窗体关闭，请覆盖 OnClosing 并将 e.Cancel 属性设置为 true。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T02:13:45.113

捕获 FormClosing 事件并在参数中取消它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T02:20:05.940

使用 Visual Studio 选择表单转到属性并将 ControlBox 属性设置为 false 或尝试`this.ControlBox = false;`或`frmMainForm.ControlBox = false;`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-08T00:59:03.407

无需导入 dll 即可禁用该按钮。`ControlBox = false`导致最小化和最大化按钮以及边框也消失，并且它不会禁用关闭“X”按钮 - 它会隐藏。此解决方案将其禁用：

```
private const int CP_NOCLOSE_BUTTON = 0x200;
protected override CreateParams CreateParams
{
    get
    {
       CreateParams myCp = base.CreateParams;
       myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON ;
       return myCp;
    }
} 
```

来源：[https ://www.codeproject.com/kb/cs/disableclose.aspx](https://www.codeproject.com/kb/cs/disableclose.aspx)

# windows - 批处理文件输入验证 - 确保用户输入一个整数

> ID：684301
> 
> 赞同：14
> 
> 时间：2009-03-26T02:15:15.483
> 
> 标签：windows, validation, batch-file, cmd, scripting

我正在尝试使用 Windows 批处理文件来执行一个简单的操作，该操作需要用户输入一个非负整数。我正在使用简单的批处理文件技术来获取用户输入：

```
@ECHO OFF
SET /P UserInput=Please Enter a Number: 
```

用户可以在此处输入他们想要的任何文本，因此我想添加一些例程以确保用户输入的是有效数字。也就是说......他们至少输入了一个字符，每个字符都是从 0 到 9 的数字。我想要一些可以将 UserInput 输入的东西。在例程结束时，就像 if/then 一样，它会根据它是否实际上是一个有效数字来运行不同的语句。

我已经尝试过循环和子字符串等，但我的知识和理解仍然很薄弱......所以任何帮助将不胜感激。

我可以构建一个可执行文件，而且我知道有比批处理文件更好的方法来做事，但至少对于这个任务，我试图通过使用批处理文件来保持简单。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-26T02:23:46.213

您可能没有在 DOS 批处理文件中执行此操作。或者至少，`set /p`在 DOS 中对我的支持是闻所未闻的 :-)

您可以使用子字符串。事实上，我曾经以这种方式为特定的常规语言编写过解析器，但它很麻烦。最简单的方法可能是将 的内容分配`%userinput%`给另一个变量，使用`set /a`. 如果结果出来，`0`你需要检查输入本身是否是`0`，否则你可以断定它是一个非数字：

```
@echo off
setlocal enableextensions enabledelayedexpansion
set /p UserInput=Enter a number: 
set /a Test=UserInput
if !Test! EQU 0 (
  if !UserInput! EQU 0 (
    echo Number
  ) else (
    echo Not a number
  )
) else (
  echo Number
) 
```

但是，这仅适用于 范围内的数字`Int32`。如果您只关心任何数字（也可能是浮点数），那么您需要采用基于循环的方法来剖析它。

**注意：**已更新以解决空间问题。但是，仍然潜伏着一个问题：输入`123/5`产生“数字”，因为`set /a`可以评估这个......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-26T10:32:46.693

谢谢大家。我试图让自己更难查看循环和字符串操作。我使用了你关于数学评估和比较的技巧。这是我最终想出的概念脚本：

```
:Top
@ECHO OFF
ECHO.
ECHO ---------------------------------------
SET /P UserInput=Please Enter a Number: 
ECHO.
ECHO UserInput = %UserInput%
ECHO.
SET /A Evaluated=UserInput
ECHO Math-Evaluated UserInput = %Evaluated%
if %Evaluated% EQU %UserInput% (
    ECHO Integer
    IF %UserInput% GTR 0 ( ECHO Positive )
    IF %UserInput% LSS 0 ( ECHO Negative )
    IF %UserInput% EQU 0 ( ECHO Zero )
    REM - Other Comparison operators for numbers
    REM - LEQ - Less Than or Equal To
    REM - GEQ - Greater Than or Equal To
    REM - NEQ - Not Equal To
) ELSE (
    REM - Non-numbers and decimal numbers get kicked out here
    ECHO Non-Integer
)

GOTO Top 
```

此方法捕获所有数字，并可以检测它是正数、负数还是零。任何小数或字符串都将被检测为非整数。我发现的唯一边缘情况是带有空格的字符串。例如，当用户输入被评估为数学时，文本“数字 1”将导致脚本崩溃/关闭。但在我的情况下，这很好。我不希望我的脚本继续输入无效的输入。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-25T13:57:04.103

您还可以使用一个非常简单的技巧：

```
echo %userinput%|findstr /r /c:"^[0-9][0-9]*$" >nul
if errorlevel 1 (echo not a number) else (echo number) 
```

这使用`findstr`的正则表达式匹配功能。它们不是很令人印象深刻，但有时很有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-26T03:11:51.790

这与 Johannes 的想法相同。 SET /A 设置一个数值。如果输入不是数字，则将其更改为 0。这就是您可以在这里利用来进行检查的内容。

```
@ECHO OFF
SET /P UserInput=Please Enter a Number:
IF %UserInput% EQU 0 GOTO E_INVALIDINPUT

SET /A UserInputVal="%UserInput%"*1
IF %UserInputVal% GTR 0 ECHO UserInput "%UserInputVal%" is a number
IF %UserInputVal% EQU 0 ECHO UserInput "%UserInputVal%" is not a number
GOTO EOF

:E_INVALIDINPUT
ECHO Invalid user input

:EOF 
```

* * *

作为替代方案，您始终可以创建一个小的 javascript 文件并从您的批处理文件中调用它。使用 parseInt() 您可以强制输入为整数，或者您可以滚动自己的函数来测试输入。

编写 javascript 与批处理文件一样快，但功能更强大。无需 IDE 或编译器；记事本就可以了。在每个 Windows 框上运行，就像您的批处理文件一样。那么为什么不利用它呢？

您甚至可以混合使用批处理文件和 javascript。例子：

sleep.js 的内容：

```
var SleepSecs=WScript.Arguments.Item(0);
WScript.Sleep(SleepSecs*1000) 
```

sleep.cmd 的内容：

```
cscript /nologo sleep.js %1 
```

您现在可以从批处理文件中调用它以使您的脚本休眠 10 秒。仅使用普通的批处理文件很难做到这样的事情。

```
sleep 10 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-06T11:53:18.413

正如 ghostdog74 所指出的，Joey 2009 年 3 月 26 日（得分 10）和 Wouter van Nifterick 2009 年 3 月 26 日（得分 5）发布的答案不起作用。

Joey 2010 年 3 月 25 日（得分 2）发布的答案确实有效，但重定向符号和“&”会导致语法错误。

我认为最好和最简单的解决方案是 Sager Oct 8 '14 发布的解决方案（得分 0）。不幸的是，它有一个错字：'"%a"' 应该是 '"%a%"'。

这是一个基于 Sager 回答的批处理文件。输入中的重定向符号和“&”不会导致问题。我能找到的唯一问题是由包含双引号的字符串引起的。

```
@echo off & setlocal enableextensions & echo.
set /p input=Enter a string:
SET "x=" & for /f "delims=0123456789" %%i in ("%input%") do set x=%%i
if defined x (echo Non-numeral: "%x:~0,1%") else (echo No non-numerals) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T14:48:50.257

您可能也喜欢这个 - 它简短易懂。这一个使用乘法技巧来设置 TestVal。将 TestVal 与 UserInput 进行比较允许所有数值通过，包括零，只有非数值会触发 else 语句。您还可以设置 ErrorLevel 或其他变量来指示失败的条目

```
@ECHO OFF
SET TestVal=0

SET /P UserInput=Please Enter a Number:
SET /A TestVal="%UserInput%"*1

If %TestVal%==%UserInput% (
   ECHO You entered the number %TestVal%
   ) else ECHO UserInput "%UserInput%" is not a number

GOTO EOF

:EOF 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T11:08:36.080

除了关于当空格是用户输入的一部分时发生的错误的评论。你可以使用errorlevel errorlevel=9165。它可用于字符串中的空格或“no”输入的错误处理。

亲切的问候，

埃格伯特

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-01T14:44:29.270

我知道这已经有好几年了，但只是为了分享我的解决方案。

```
set /p inp=Int Only : 
:: Check for multiple zeros eg : 00000 ::
set ch2=%inp%-0
if %inp% EQU 0 goto :pass
if [%inp%]==[] echo Missing value && goto :eof
if %inp:~0,1%==- echo No negative integers! && goto :eof
set /a chk=%inp%-10>nul
if %chk%==-10 echo Integers only! && goto :eof
:pass
echo You shall pass
:eof 
```

在 Windows 8 上测试并运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-31T13:38:12.363

您可以重新发明轮子并长出几根白毛，批量进行字符串验证，或者您可以使用 vbscript

```
strInput = WScript.Arguments.Item(0)
If IsNumeric(strInput) Then
    WScript.Echo "1"
Else
    WScript.Echo "0"
End If 
```

将其保存为 checkdigit.vbs 并在您的批次中

```
@echo off
for /F %%A in ('cscript //nologo checkdigit.vbs 100') do (
        echo %%A
        rem use if to check whether its 1 or 0 and carry on from here
) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-08T10:15:35.067

您可以验证任何变量，如果其编号：

```
SET "var="&for /f "delims=0123456789" %i in ("%a") do set var=%i
if defined var (echo."NIC">nul) else (echo."number") 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-28T01:01:01.030

如果您想为该特定问题设置某种循环和默认设置，那么这是我的方法。

里面的代码注释。

```
@echo off
setlocal EnableDelayedExpansion
set "ans1_Def=2"

:Q1
set /p "ans1=Opt 1 of 1 [Value 1-5 / Default !ans1_Def!]: "

:: If not defined section. This will use the default once the ENTER key has been
:: pressed and then go to :Q2.
if not defined ans1 (
  echo/ & echo ENTER hit and the default used. Default is still: !ans1_Def! & echo/
  set "ans1=!ans1_Def!" && goto :Q2 )

:: This section will check the validity of the answer. The "^[1-5]$" will work
:: for only numbers between one and five in this example but this can be changed
:: to pretty much suit the majority of cases. This section will also undefine
:: the ans1 variable again so that hitting the ENTER key at the question
:: will work.
echo %ans1%|findstr /r /c:"^[1-5]$" >nul
if errorlevel 1 (
  echo/ & echo At errorlevel 1\. Wrong format used. Default is still: !ans1_Def! & echo/
  set "ans1=" && goto Q1
  ) else ( echo Correct format has been used. %ans1% is the one. && goto :Q2 )

:Q2
echo/
echo -----------------------------
echo/
echo Now at the next question
echo !ans1!
echo/
pause
exit 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-11T13:31:37.243

试试这个：

```
set /p numeric=enter a number

( 
  (if errorlevel %numeric% break ) 2>nul
)&&(
  echo %numeric% is numeric
)||(
  echo %numeric% is NOT numeric
) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-12-31T13:06:21.257

```
:ASK
SET /P number= Choose a number [1 or 2]: 
IF %number% EQU 1 GOTO ONE
IF %number% NEQ 1 (
  IF %number% EQU 2 GOTO TWO
  IF %number% NEQ 2 (
    CLS
    ECHO You need to choose a NUMBER: 1 OR 2.
    ECHO.
    GOTO ASK
  )
) 
```

它对我来说很好。如果他选择更少或更大的数字、字符串、浮点数等，他将收到一条消息（“您需要选择一个数字：1 或 2。”）并且将再次询问 INPUT。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-03-01T09:37:52.267

@echo off setlocal enableextensions enabledelayedexpansion set /p UserInput=输入一个数字：set /a Test=UserInput if !Test! EQU 0 (if !UserInput!EQU 0 (echo Number) else (echo Not a number)) else (echo Number)

是的，一切都很好，但你忘记了一件小事，0也是一个数字；（

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2014-05-05T19:17:22.243

这更像是一种用户友好的方式。

```
if %userinput%==0 (
cls
goto (put place here)
)
if %userinput%==1 (
cls
goto (put place here)
)
if %userinput%==2 (
cls
goto (put place here)
)
if %userinput%==3 (
cls
goto (put place here)
)
if %userinput%==4 (
cls
goto (put place here)
)
if %userinput%==5 (
cls
goto (put place here)
)if %userinput%==6 (
cls
goto (put place here)
)if %userinput%==7 (
cls
goto (put place here)
)
if %userinput%==8 (
cls
goto (put place here)
)
if %userinput%==9 (
cls
goto (put place here)
) 
```

这可用于任何类型的用户输入。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2014-07-16T22:24:53.550

您可以将 ReadFormattedLine 子例程用于所有类型的格式化输入。例如，下面的命令读取最多 5 位的数字：

```
call :ReadFormattedLine UserInput="#####" /M "Please Enter a Number: " 
```

这个子程序是用纯 Batch 编写的，因此它不需要任何额外的程序，并且它允许多种格式化输入操作，例如读取密码。在前面的示例中，子例程读取最多 5 位数字。[您可以从Read a line with specific format](http://www.dostips.com/forum/viewtopic.php?f=3&t=5775)下载 ReadFormattedLine 子程序。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2021-12-31T10:28:47.517

对我来说，这适用于所有非零值..我应该小心一些罕见的情况吗？

```
set /a var = %1
if %var% neq 0 echo "it is number"
pause 
```

# java - 如何在图表中搜索路径？

> ID：684302
> 
> 赞同：2
> 
> 时间：2009-03-26T02:15:34.843
> 
> 标签：java, algorithm, data-structures

假设我有一个边列表，每个边包含两个节点（往返）。找到两个给定节点的边缘的最佳方法是什么？请注意，边缘中的节点可能会重复。

说我有这种格式的优势：

> 1 <-> 5
> 
> 3 <-> 7
> 
> 5 <-> 6
> 
> 2<-> 6

然后查询如 1 5 将返回**true**。

然后查询如 5 2 将返回**true**，因为 5 连接 6 并且 6 连接到 2。

然后查询如 1 7 将返回**false**。

然后查询如 7 4 将返回**false**，因为 4 不存在，这意味着它是无边节点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T06:08:59.540

在我看来，您只是在询问无向图中的两个顶点之间是否存在路径，但不一定是该路径可能是什么。这与询问两个顶点是否在图的同一个连通分量中相同。

如果你真的只需要知道两个顶点是否在同一个连通分量中，那么有一个使用不[相交集数据结构](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)的简单高效的算法。

```
initialize the disjoint set structure (DSS)
for each edge:
  for each vertex in edge:
    if the vertex does not exist in the DSS:
      create a new subset in the DSS containing only the vertex
  merge the subsets of the two vertices 
```

处理完所有边后判断两个顶点之间是否存在路径，只需检查两个顶点是否在同一个子集中即可。如果它们是，那么它们之间存在一些路径。

使用 DSS 的有效实现，该算法的实现仅比线性时间稍差，即使使用 DSS 的简单链表实现，它也是 O(n `*`log(n))。正如 j`_`随机`_`黑客提到的，Floyd-Warshall 是 O(n^3) 时间和 O(n^2) 存储，无论您是否仅计算传递闭包，并且使用 Dijkstra 算法需要 O(n `*`log(n) ) 计算每个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T02:59:40.823

您基本上期待测试给定的一对节点之间是否有路径。这是最短路径问题的一般情况。但是请注意，如果我们能找到所讨论的节点对之间的最短路径就足够了。使用适合您的任何表示形式（邻接矩阵、邻接列表、边集、联合查找...）并继续为所有节点对执行 BFS/Djikstra 实现。这只是一个服务查询的问题。或者，您可以在惰性基础上运行 Djikstra/BFS（并以增量方式缓存过去的计算）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:26:37.310

查看[JGraphT](http://jgrapht.sourceforge.net/)库，它专门研究图形算法并满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T06:38:27.550

您可能需要[Floyd](http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)算法的一些变体来查找所有图形顶点之间的最短路径。据我所知，您只需要无向图的[传递闭包。](http://en.wikipedia.org/wiki/Transitive_closure)这是伪代码：

```
for k = 1 to n
  for i = 1 to n
    for j = 1 to n
      W[i][j] = W[i][j] or (W[i][k] and W[k][j]) 
```

`W`在运行此代码之前，应该是一个图的二进制邻接矩阵（`W[i][j] == 1 <->`有一条从`i`to的边`j`）。之后它将是一个传递闭包。即`W[i][j]`当`1`且仅当`j`可从`i`.

# iphone - iphone 可以混合两个声音文件或构建自定义均衡器吗？

> ID：684303
> 
> 赞同：2
> 
> 时间：2009-03-26T02:16:22.347
> 
> 标签：iphone

iphone 可以混合两个声音文件或构建自定义均衡器吗？我已经研究了几个星期关于这个问题，似乎无法使用 iphone-sdk 来混合两个或多个声音文件或构建自定义均衡器。有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T02:51:24.603

Yes you can. AVAudioPlayer can play multiple sounds and you can control the volume for each. Or you can use Audio Units and have more control over the audio data.

aurioTouch is a good sample app for what you are thinking of.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T19:44:26.807

对于声音文件的简单播放，您可以使用 2.2 SDK 中引入的 AVAudioPlayer 类。它为播放任何音频文件提供播放和音量控制。据我所知，您可以在 iPhone 上播放的声音文件的数量没有限制。播放声音文件的唯一限制是一次只能播放一个 AAC 或 MP3 压缩文件，其余文件必须是未压缩文件或 IMA4 格式。

如果您的需求更底层（如果您需要做 DSP），您可能需要查看 AudioQueue Services 或 AudioUnits - iPhone 上也提供了两个 Mac OS X 音频处理 API。

# asp.net-mvc - asp.net MVC Ajax 请求未正确触发

> ID：684315
> 
> 赞同：0
> 
> 时间：2009-03-26T02:25:34.680
> 
> 标签：asp.net-mvc, ajax, model-view-controller

我无法弄清楚为什么这个 Ajax 请求没有正确触发。为简单起见，我一直在尝试使用[本教程](http://www.asp.net/learn/mvc/tutorial-32-cs.aspx)实现 Ajax 请求。但是，我无法让我的控制器将请求识别为如此。我已经尝试将 Ajax.ActionLink 放置在要更新的 div 中（在此之外）。

使用 Response.Write 放置 Datetime，Div 内的一个会更新，而目标 div 之外的一个不会（如预期的那样）。我不太熟悉 MS Ajax 库的工作原理，但从表面上看，它似乎正在更新页面的正确部分，但我的控制器无法识别请求类型，因此输出了不正确的信息。

```
...
    <script src="../../Scripts/MicrosoftAjax.js" type="text/javascript"></script>
    <script src="../../Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery-1.2.6.min.js" type="text/javascript"></script>

</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <div class="chart" id="divChart">
        <% Html.RenderPartial("GraphView", Model); %>
        <br />
        <% Response.Write(DateTime.Now); %>
        <br />
    </div>
    <%= Ajax.ActionLink("no parameters", "MyWorkouts", new AjaxOptions{ UpdateTargetId = "divChart"}) %>
    <%= Ajax.ActionLink("id parameter", "MyWorkouts", new {chtype=1},new AjaxOptions { UpdateTargetId = "divChart", OnBegin = "beginContactList", OnSuccess = "successContactList", OnFailure = "failureContactList" })%>
    <%= Ajax.ActionLink("all parameters", "MyWorkouts", new {chtype=2, range=ViewData["daterangevalue"]},new AjaxOptions { UpdateTargetId = "divChart", OnBegin = "beginContactList", OnSuccess = "successContactList", OnFailure = "failureContactList" })%>
    <br />
    <% Response.Write(DateTime.Now); %>
    <h2>
... 
```

然后我的 ActionResult 看起来像这样......

```
[AcceptVerbs(HttpVerbs.Get)]
        public ActionResult MyWorkouts(int? chtype, int? range) {
            int dateRange = 3;

             // do some stuff here - left out for readability

            if (Request.IsAjaxRequest()) {
                if (range != null) {
                    dateRange = (int)range;
                }

            }

           //do some other stuff...

            if (Request.IsAjaxRequest()) {
                return PartialView("GraphView", workouts);
            } else {
                return View(workouts);
            }
        } 
```

（一切都是默认的，因为这只是一个测试页面，一旦我弄清楚了就可以实现它）。结果，我不断获得目标 div 内部的完整视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T02:41:58.883

我不确定问题是什么，但 Fiddler 和 RouteDebugger 可能有助于调试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T05:24:04.173

看起来您可能正在使用旧版本的 MVC 框架？

如果是这样，我建议更新到发布版本并确保您使用的是最新的 jquery 和 mvc 脚本...... Request.IsAjaxRequest() 方法的工作方式有一些特别的变化，可能与您的问题有关。

此外，如果其中涉及 RedirectToAction 调用，您可能想在[此处阅读类似的问题](http://reddnet.net/code/asp-net-mvc-after-redirecttoaction-call-the-target-action-fails-to-render-a-partial-view-correctly/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-30T18:42:52.753

It doesn't show in the snippet you have posted, but you most likely have form /form tags. These are interfering with the Ajax.BeginForm which generates the form tags as well. Once you remove the outer form tags, the Request.IsAjaxRequest will return true.

# wpf - WPF中消失的图标

> ID：684324
> 
> 赞同：2
> 
> 时间：2009-03-26T02:30:06.290
> 
> 标签：wpf, resources, png

我希望在我的 WPF 应用程序中使用 VS2008ImageLibrary/Actions/pngformat 中的一些图标来获得更多的 Visual Studio 外观 - 就像 WinForms 中的“插入标准项目”命令。
我已将图像添加为资源，并在我的 xaml 文件中引用它们：

```
<DockPanel.Resources>
        <Image x:Key="NewIcon" Source="Toolbar Images/NewDocumentHS.png" Height="16" Width="16"/>
</DockPanel.Resources> 
```

然后我将图像添加到菜单和工具栏

```
<MenuItem Command="ApplicationCommands.New" Icon="{StaticResource NewIcon}"/>
<!-- ... -->
<Button Command="ApplicationCommands.Save"><StaticResourceExtension ResourceKey="SaveIcon"/></Button> 
```

但是，当我打开菜单时，图标从工具栏中消失，好像按钮从未存在过。我在其他地方读到这种事情是由于 .NET 缺乏对 Vista 图标/压缩 PNG 的支持，但我'不确定这是完全相同的问题。我试图通过改变格式来解决这个问题的尝试失败了，或者给出了次优的结果（例如失去透明度）。有谁知道更好的方法来做到这一点？

编辑：对于遇到此问题的其他人，在 < DockPanel.Resources > 标记中为每个引用使用不同键的重复条目似乎是一种功能足够的解决方法，但我担心如果需要图像可能会再次消失因任何原因被重新加载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T14:38:28.023

我认为您必须为使用 Button 定义一个单独的资源：

```
 <DockPanel.Resources>
        <Image x:Key="NewIconForMenu" Source="Toolbar Images/NewDocumentHS.png" Height="16" Width="16"/>
<Image x:Key="NewIconForButton" Source="Toolbar Images/NewDocumentHS.png" Height="16" Width="16"/>
</DockPanel.Resources> 
```

我想，当你声明一个 Image 资源时，它基本上是在创建 Image 类型的对象。之后，您通过设置 Icon 和 Content 属性使其成为 MenuItem 和 Button 的子项，因此它不再是一棵树。这是不合法的。

如果您尝试声明也使用 NewIcon 的第二个按钮，您将获得逻辑树异常。

我不知道 MenuItem 是如何逃脱该异常的，可能在将图像添加到自己的逻辑子集合之前从 Button 的子元素中删除 Image 元素（这就是它消失的方式）是否足够聪明。

好的，我刚刚找到了一个更简单的解决方案。您可以将 x:Shared="false" 添加到字典中的图像声明中。这将确保创建该图像的新实例并且不会破坏 wpf 树规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T02:36:13.437

使用失去透明度的格式并将透明度键设置为该背景颜色。

# postgresql - 使用 Postgres Plus 开发并部署 Postgresql 开源？

> ID：684328
> 
> 赞同：1
> 
> 时间：2009-03-26T02:32:51.933
> 
> 标签：postgresql, enterprisedb

根据[这个比较问题](https://stackoverflow.com/questions/344038/postgresql-vs-postgres-plus)的答案，核心 PostgreSQL 引擎和 EnterpriseDB 的 Postgres Plus 服务器之间没有技术差异。开发者许可证只需[95 美元/座](http://www.enterprisedb.com/products/purchase.do)。

他们的[开发工具](http://www.enterprisedb.com/products/postgres_plus/overview.do)看起来非常有吸引力，即使您随后部署了开源版本，为了提高生产力也可能值得付出代价。有没有人试过这个并遇到问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T02:49:33.747

我在那里看到的唯一开发工具看起来[很像](http://www.enterprisedb.com/images/common/pgadmin_III_screen_shot.PNG)pgadmin [III](http://www.pgadmin.org/screenshots/)，它是免费软件（在金钱和自由方面）。

您指的是其他开发工具吗？

# wpf - 我可以将 WPF TextBlock 高度限制为两行吗？

> ID：684333
> 
> 赞同：6
> 
> 时间：2009-03-26T02:34:49.400
> 
> 标签：wpf, textblock

我刚刚收到在控件中显示一段文本的要求。该控件具有特定的宽度，并且高度最多为 2 行。如果它呈现的长度超过两行，它只会在字符串的末尾显示“...”。

任何库存标准 WPF 控件都可以做到这一点吗？

感谢：D。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-26T02:50:22.717

Set the Height of the TextBlock to be high enough to fit two lines. Set the TextWrapping to Wrap and the TextTrimming to CharacterEllipsis or WordEllipsis.

For the default Segoe UI 12Pt font, I find this does it

```
<TextBlock TextWrapping="Wrap" Height="40" TextTrimming="CharacterEllipsis" /> 
```

You could probably do some code behind to work out the height it should be be for a particular font if you want.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T02:43:30.813

这不是我发现的标准行为，但我又没有寻找它。

一种可能性是在 TextArea 控件中使用等宽字体，然后如果字符串大于该区域中适合的字符数，则仅显示带有省略号的右侧 N 个字符

# search - Google 是否提供了在没有 -site 字符串的情况下系统地禁止某些来源的结果的功能？

> ID：684336
> 
> 赞同：4
> 
> 时间：2009-03-26T02:36:11.080
> 
> 标签：search, search-engine

我知道删除 www.experts-echange.com 的话题已被打死，但必须输入 -site:www.experts-exchange.com 很乏味。甚至自动向查询添加字符串的能力也可以解决这个问题。我可能可以将其包装成一些 wget 混乱，但这似乎是许多用户选择搜索引擎的基本功能。如果您自己发现了一些简单的方法，请告诉我。

我想有一个非常漂亮的工具栏可以向谷歌提供您的文本以及您选择的其他字符串。Google 搜索过程的单词和/或运算符的数量存在一些内部限制（我想这是有充分理由的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T02:50:20.267

[Google 自定义搜索 API](http://code.google.com/apis/customsearch/docs/start.html#sites)允许您在搜索中包含或排除**网站**。您可以将自定义搜索引擎添加到您的 iGoogle 主页。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T02:43:24.620

谷歌自定义搜索：[http ://www.google.com/coop/cse/](http://www.google.com/coop/cse/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T02:51:43.587

Firefox 中的 2 种简单方法：

1.  写一个油猴脚本。
2.  使用搜索[关键字](http://www.mozilla.org/docs/end-user/keywords.html)。您在地址栏中键入关键字和字符串以触发搜索。在这种情况下，URL 是[http://www.google.com/search?q=-site:expertsexchange.com%20%s](http://www.google.com/search?q=-site:expertsexchange.com%20%s)。要在您的标签页当前所在的网站上搜索，请使用 javascript:location=' [http://www.google.com/search?num=100&q=site](http://www.google.com/search?num=100&q=site) :'%20+%20escape(location.hostname)%20+% 20'%20%S'%20;%20void%200

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T02:58:26.660

作为排除结果的替代方法，我有一个greasemonkey 脚本，可以按域突出显示谷歌搜索结果。我为一些我感兴趣的网站配置了微妙的颜色，比如 wikipedia 和 stackoverflow。但是我将红色用于expertexchange，这样我就可以在视觉上直接跳过它。

如果有兴趣，我可以发布我的脚本...

如果要编写自己的脚本，则需要对两种元素进行操作。下面是我使用的两个 XPath 表达式：

```
//cite[contains(., '" + domain + "')]/ancestor::li[1]
//span[@class='a'][contains(., '" + domain + "')]/ancestor::div[@class='g'] 
```

然后我只是将背景颜色样式应用于匹配的元素。很直接。

# php - 如何检查表以查看字符串是否已在使用中？

> ID：684345
> 
> 赞同：1
> 
> 时间：2009-03-26T02:43:01.347
> 
> 标签：php, mysql, string, comparison

我正在使用此代码检查我的 userdb 表中的用户名列（用户名是主用户名），以查看字符串是否已经存在。如果它不存在，那么它将从以前的表单输入的字符串添加到我表中的用户名列中。但如果它在那里，那么它会说“（用户名）已经在使用中！”。

当我在用户名列中输入一个条目（例如“Sam”），然后在之前的表单中输入 Sam 时，这会起作用。但是，如果我在用户名列中有“Sam”，然后在前面的表单中输入全小写的 sam，它会显示键 1 的重复条目“sam”。

我只想说，无论我在以前的表单中输入哪种类型的套管，该字符串都已在使用中。

```
$result = mysql_query("SELECT username FROM userdb") or die(mysql_error()); 
$row = mysql_fetch_array( $result );
$checkuser = $row['username'];

if ( $checkuser == $username ) {
    echo "<font color='red'>" .$username. "<font color='black'> is already in use!";
    die(mysql_error());
} else {
    mysql_query("INSERT INTO userdb (username, password) VALUES('$username', '$password' ) ") or die(mysql_error());;
    echo "Data Inserted!";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T03:03:15.697

You shouldn't do it this way, because it can lead to race conditions. That's what happens if, between your check and your insert, somebody else inserts that username into the table.

The correct way to do it is to have a primary key on the username and insert the record, catching an exception or error code returned from the DBMS.

If the username is already in there, it won't be inserted again and you'll catch the error.

If it's not there, it will be inserted and you'll get no error.

In terms of your casing problem, I'd either convert all user names to lowercase before insertion or checking, or insert the mixed-case version and lower-case both the DB copy and local copy in all checks.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T09:41:38.437

正确执行此操作并避免竞争条件*的唯一方法是尝试插入用户的数据并检查任何错误以查看错误是否是重复键错误。如果您使用的是 PDO（您应该使用），它会抛出一个您可以捕获和检查的异常。我认为您仍然可以使用 PHP 的标准错误处理来捕获和检查错误，我只是不确定如何。

*这里的比赛条件是这样的：

1.  检查用户名是否唯一，确实如此。
2.  另一个用户使用该用户名创建一个帐户
3.  您现在尝试使用该用户名为原始用户创建一个帐户，这会导致错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T02:45:25.367

将代码更改为：

```
strtolower($checkuser) == strtolower($username) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T02:48:21.007

```
$result = mysql_query("SELECT count(*) FROM userdb where UCASE(username)=UCASE($checkuser);" 
```

检查结果中的行数。

伪代码：

```
If num_rows>0
    Username exists; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T03:04:09.937

The short answer is:

If you want the usernames to be case-insensitive, you need to store them in the database in a case-insensitive manner. Convert the given username to all lower-case (or all upper-case) first.

```
$lcusername = strtolower($username); 
```

Then use $lcusername wherever you use $username in the code you supplied.

The long answer is:

You don't need to check for the pre-existence of a key in a table. Assuming you have a PRIMARY KEY attribute on the username field, simply try to your data into the table (after converting it to lower-case). If the database returns a "duplicate key" error, you know the username already existed and you can display the error message. If the database returns that it successfully inserted the row (perhaps by using the mysql_affected_rows function). This saves you from having to do a SELECT before doing the INSERT, greatly simplifying your code.

You should also escape all the strings that you'll be inserting into the table to help avert potential security holes.

```
$lcusername = strtolower($username);

// Escape strings
$esclcusername = mysql_real_escape_string($lcusername);
$escpassword = mysql_real_escape_string($password);

mysql_query("INSERT INTO userdb (username, password) VALUES('$esclcusername', '$escpassword') ");
if (mysql_affected_rows() == -1) {
    // Display error message
} elseif (mysql_affected_rows() == 1) {
    // Yay! Insert successful
} else {
    // Affected rows is 0\. Something went wrong
} 
```

# oracle - 在 Mac OS/X 上安装 Oracle Instantclient 而不设置环境变量？

> ID：684352
> 
> 赞同：9
> 
> 时间：2009-03-26T02:47:25.190
> 
> 标签：oracle, macos, installation, instantclient

Oracle 的指令指定设置 DYLD_LIBRARY_PATH。这使得我的应用程序依赖于随机用户的配置，并且设置起来非常麻烦。

如何避免设置任何环境变量？

[http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/intel_macsoft.html](http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/intel_macsoft.html)

linux 相关说明：[在不设置环境变量的情况下在 Linux 上安装 Oracle Instantclient？](https://stackoverflow.com/questions/764871)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-26T02:49:44.573

Oracle 的 Instantclient 安装说明指定用户设置 DYLD_LIBRARY_PATH。这对于多个用户来说管理起来非常麻烦。

要在不设置任何环境变量的情况下使用 Instantclient：

从 oracle.com 下载 Instantclient 发行版。对于进行非 Java 软件开发，您将需要（假设 Oracle 10.2）：

```
instantclient-basic-macosx-10.2.0.4.0.zip
instantclient-sdk-macosx-10.2.0.4.0.zip
instantclient-sqlplus-macosx-10.2.0.4.0.zip 
```

解压这三个文件。这会给你一个目录

```
instantclient_10_2/ 
```

将文件复制到 /usr，这是动态加载程序搜索的默认位置之一。

```
sudo cp instantclient_10_2/sdk/include/*.h /usr/include
sudo cp instantclient_10_2/sqlplus         /usr/bin
sudo cp instantclient_10_2/*.dylib         /usr/lib 
```

如果您使用 tnsnames.ora，请将其复制到 /etc，这是 oracle 运行时搜索的默认全局位置。

```
sudo cp tnsnames.ora /etc 
```

测试

```
/usr/bin/sqlplus scott/tiger@myoracle 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-23T15:53:51.487

如果您的目标只是在 MacBook 上运行 sqlplus，这可能对您有用。从 ~/.bashrc 中删除 DYLD_LIBRARY_PATH 环境变量并将其替换为别名：

`alias sqlplus="DYLD_LIBRARY_PATH=/Applications/instantclient_11_2 sqlplus"`

[博客条目：Mac OS/X 上的 sqlplus 和 DYLD_LIBRARY_PATH](https://blogs.oracle.com/taylor22/entry/sqlplus_and_dyld_library_path)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T23:45:20.197

经过大量研究，我找到了解决此错误的可持续解决方案，其中涉及编辑 Apache 的`launchd`配置`.plist`文件以指定所需`DYLD_LIBRARY_PATH`的`ORACLE_HOME`、 和`LD_LIBRARY_PATH`环境变量。

您可以在此处查看完整答案：[https ://stackoverflow.com/a/20670810/1914455](https://stackoverflow.com/a/20670810/1914455)

# silverlight - 在 Silverlight 3 中修改新弹出控件 (ChildWindow) 的外观/行为

> ID：684360
> 
> 赞同：5
> 
> 时间：2009-03-26T02:50:00.410
> 
> 标签：silverlight, silverlight-3.0

我想删除 Silverlight 3 中新的 Popup 控件的灰色标题。

如果可能的话，有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T03:07:55.187

很简单，只需编辑默认的 ChildWindow 样式。

1.  在 Blend 3 中创建一个 ChildWindow 类型的新项目。（右键单击项目 --> 新建项目 --> 从列表中选择 ChildWindow）
2.  在“对象和时间线”窗格中右键单击 ChildWindow --> 编辑模板 --> 编辑副本。
3.  导航到默认模板中名为“Chrome”的元素，然后将背景更改为您想要的任何画笔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-18T20:43:24.957

样式是最好的方法，但您也可以通过在 ChildWindow 上设置 Title="" HasCloseButton="False" 来删除它。

# sql - 复杂的 sql 查询 - 合并或替换组

> ID：684361
> 
> 赞同：0
> 
> 时间：2009-03-26T02:50:10.360
> 
> 标签：sql, sql-server

我正在建立一个学校网站并被困在这个问题上。

SQL 数据库的结构如下（我无权修改他们的数据库）

```
**GroupRecords**
Id (int, primary key)
Name (nvarchar)
SchoolYear (datetime)
RecordDate (datetime)
IsUpdate (bit)

**People**
Id (int, primary key)
GroupRecordsId (int, foreign key to GroupRecords.Id)
Name (nvarchar)
Bio (nvarchar)
Location (nvarchar) 
```

实际的纸质表格如下所示，全年更新 假设同一表格 (GroupRecords) 中没有重复的参与者姓名 (People.Name)

```
-------------------------
Name: District A
SchoolYear: 2000
RecordDate: 12/30/1999
IsUpdate: no

Participants
Name Location
AA   11
BB   22
CC   33
DD   44
-------------------------
-------------------------
Name: District A
SchoolYear: 2000
RecordDate: 1/2/2000
IsUpdate: no

Participants
Name Location
QQ   33
DD   22
EE   99
FF   66
-------------------------
-------------------------
Name: District A
SchoolYear: 2000
RecordDate: 2/1/2000
IsUpdate: yes

Participants
Name Location
XX   00
-------------------------
-------------------------
Name: District A
SchoolYear: 2000
RecordDate: 2/1/2000
IsUpdate: yes

Participants
Name Location
QQ   44
------------------------- 
```

现在这是棘手的部分，如果 IsUpdate 为 yes，则返回的人员列表应与先前记录的列表合并（因此，如果 IsUpdate 为 no：替换，如果 IsUpdate 为 yes：合并）

所以如果查询是 GroupRecords.Name = 'District A' AND GroupRecords.SchoolYear = '1/1/2000'，我应该得到

```
QQ   44
DD   22
EE   99
FF   66
XX   00 
```

为此编写一个存储过程可能会更好吗？太感谢了

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GroupRecords](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](500) NOT NULL,
    [SchoolYear] [datetime] NOT NULL,
    [RecordDate] [datetime] NOT NULL,
    [IsUpdate] [bit] NOT NULL,
 CONSTRAINT [PK_GroupRecords] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[People](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [GroupRecordsId] [int] NOT NULL,
    [Name] [nvarchar](500) NOT NULL,
    [Bio] [nvarchar](4000) NOT NULL,
    [Location] [nvarchar](100) NOT NULL,
 CONSTRAINT [PK_People] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
ALTER TABLE [dbo].[People]  WITH CHECK ADD  CONSTRAINT [FK_People_GroupRecords] FOREIGN KEY([GroupRecordsId])
REFERENCES [dbo].[GroupRecords] ([Id])
GO
ALTER TABLE [dbo].[People] CHECK CONSTRAINT [FK_People_GroupRecords] 
```

**更新** 让我清楚 IsUpdate 的工作原理

示例中的表单已经按 RecordDate 降序排序 如果只存在第一个表单，则返回的列表将是

```
AA   11
BB   22
CC   33
DD   44 
```

如果只有第一个和表单，则返回的列表将是

```
QQ   33
DD   22
EE   99
FF   66 
```

由于最新形式（第二种形式）的 isUpdate 为否，因此返回的列表将只是第二种形式的内容

前 3 种形式

```
QQ   33
DD   22
EE   99
FF   66
XX   00 
```

因为最新形式（第三种形式）的 isUpdate 是肯定的，所以它的内容将添加/替换最后一个列表。

说有这样的第五种形式

```
-------------------------
Name: District A
SchoolYear: 2000
RecordDate: 2/10/2000
IsUpdate: no

Participants
Name Location
TT   99
------------------------- 
```

那么返回的数据就是

```
TT   99 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T20:10:06.043

你能用现实的数据值再谈一遍吗？XX、AA 等可能是“Smith”、“Jones”。对于 Group、Location 等的现有值，它们每个人可能有什么？

然后以一个 IsUpdate 表单示例，并显示结果将是什么。那么对于同一个表单切换到IsUpdate = false，并显示不同的结果？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T04:02:54.383

在我看来，数据库的设计似乎有问题。

如果有三张桌子，这似乎更合乎逻辑。

**一个人**
此表应具有以下字段

> Id (int, primary key)
> Name (nvarchar)
> Bio (nvarchar)
> Location (nvarchar)

 **该表应具有以下字段**的组****

 **> Id (int, primary key)
> Name (nvarchar) SchoolYear (datetime)

**一个关联人员和组**

> Id
> GroupId
> PersonId
> RecordDate

这样，如果您需要将人员添加到组中，只需将其插入到人员组表中即可。

如果您需要历史记录，您可以简单地在人员组表中添加一个字段，指示记录的状态（当前、已删除等）

当前数据库的设计方式，一个人可能不超过一组。此外，对一个人的组的任何更改都是以破坏性的方式进行的（除非你复制你的人，这是**BAD**）。

如果您需要以前人员所在组的书面记录，您可能还需要更多表来保持历史记录。

不应在数据库中使用 IsUpdate 字段，而应仅编辑数据。MS Sql 是一个数据库服务器，数据库是用来更新的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T03:00:46.093

I see a trend here ... do you want to learn how to work with databases in the context of this app you're trying to work on, or do you want to post questions and have us tell you the answers? It can be handled either way, but you should post pretty clearly what you want.

This will probably get complex, so you may want to publish a pretty complete schema.

# python - Django 模板如果标签在检查 bool True 时在 FastCGI 下不起作用

> ID：684371
> 
> 赞同：2
> 
> 时间：2009-03-26T02:57:46.053
> 
> 标签：python, django, templates, fastcgi, python-2.6

我在 Python 2.6 + Ubuntu + Apache 2.2 + FastCGI 下的 Django 部署有一个奇怪的问题。

如果我有这样的模板：

```
{% with True as something %}
   {%if something%}
      It Worked!!!
   {%endif%}
{%endwith%} 
```

它应该输出字符串“It Worked!!!”。它不在我的带有 mod_fastcgi 的生产服务器上。

当我使用 runserver 在本地运行时，这非常有效。

为了方便起见，我将代码修改为以下代码以使其工作，问题就消失了。

```
{% with "True" as something %}
   {%if something%}
      It Worked!!!
   {%endif%}
{%endwith%} 
```

似乎模板解析器在 FastCGI 下运行时，无法确定 bool 变量的真实性（或真实性）[如果您获得参考，请恭喜]。

有人见过这个吗？你有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:37:50.277

嗯...`True`不是 django 模板语言中的有效标记，是吗？我不知道它是如何在本地工作的——除非它被添加到上下文中某个地方的非零值。因此，我认为您的第二个问题可能与第一个问题无关。

# asp.net-mvc - Strongly typed urls in asp.net mvc

> ID：684381
> 
> 赞同：0
> 
> 时间：2009-03-26T03:06:04.847
> 
> 标签：asp.net-mvc

I'm trying to URLs from the LinkBuilder in Microsoft.Web.Mvc. AT the moment, I have:

LinkBuilder.BuildUrlFromExpression(???, RouteTable.Routes, x => x.Index())

But I'm not sure how to get the request context in all cases. E.g. If I'm in a IHttpModule, is it possible for me to somehow get the request context so I can create a URL like this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T03:10:05.417

If you are using [System.Web.Routing](http://msdn.microsoft.com/en-us/library/system.web.routing.aspx) for your MVC setup, you can implement an [IRouteHandler](http://msdn.microsoft.com/en-us/library/system.web.routing.iroutehandler.aspx) ([example](http://fredrik.nsquared2.com/ViewPost.aspx?PostID=466)) which will return a new instance of your custom [IHttpHandler](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx) class. Since the logic for instantiating the HttpHandler goes inside the [GetHttpHandler](http://msdn.microsoft.com/en-us/library/system.web.routing.iroutehandler.gethttphandler.aspx) method of the IRouteHandler, and the IRouteHandler has access to the [route request context data](http://msdn.microsoft.com/en-us/library/system.web.routing.requestcontext.aspx), you can pass that in to your HttpHandler's constructor and use it appropriately.

# php - 编码 Json 请求的问题

> ID：684382
> 
> 赞同：3
> 
> 时间：2009-03-26T03:07:33.987
> 
> 标签：php, json, zend-framework, http-headers, mootools

我尝试手动构建一个 Json 字符串以发送给客户端。

```
{'result':'hhh'} 
```

当我使用

```
echo json_encode(array('result'=>'hhh')); 
```

它完美地到达。但是当我这样做时

```
echo "{'result':'hhh'}"; 
```

它不是

我发现这两个请求之间的唯一区别是第一个请求具有：

```
Content-Length: 9    header 
```

第二个（不起作用）

```
Content-Length: 16   header 
```

两个字符串都应该是内容长度：16！！！我想这与 ZF 和 Mootools 的结合有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T04:06:35.403

根据规范，JSON 需要在键名和字符串值周围加上双引号。

```
echo json_encode(array('result'=>'hhh')); 
```

将输出

```
{"result":"hhh"} 
```

此输出的长度为 16 个字节，如下所示：

```
echo strlen(json_encode(array('result'=>'hhh'))); 
```

输出“16”。

任何遵循规范的 JSON 解码器都会在出现手动回显的 JSON 时失败或抛出异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:18:06.003

UTF-8没有*问题*，因为 UTF-8 是它的标准编码。听起来好像您正在以不同的编码方案回显某些内容，这会中断，而 json_encode() 正在为您转码。

# asp.net - 重定向时会话丢失

> ID：684387
> 
> 赞同：0
> 
> 时间：2009-03-26T03:11:03.137
> 
> 标签：asp.net, session, redirect

我有一个被 facebook 击中的网络应用程序。登录页面检索我需要的密钥并设置一些会话变量。当服务器随后将用户重定向到下一页时，会话信息将丢失。我目前在 vista Ultimate 上运行 IIS 引擎，应用程序池无关紧要，因为我正在使用状态服务并且我仍在丢失会话状态。我已经尝试了 response.redirect 函数的重载方法，还尝试了向页面添加标题以强制重定向，但这些似乎都不起作用。有人对我缺少什么有任何想法吗？

这两个我都试过了：

```
Response.Headers.Add("refresh", "3;url=Dashboard.aspx") 
```

和

```
Response.Redirect("Dashboard.aspx", False) 
```

[编辑]

所以我只是做了一个小实验，结果发现，当我直接从 facebook 页面点击 url 时，我遇到了问题，但是当我将 IFrame 的 url 复制到新的浏览器窗口中并尝试它时，它工作正常。

[编辑]

所以我找到了一篇关于这个的文章，在添加了标题之后问题就解决了（现在）

[http://support.microsoft.com/kb/323752](http://support.microsoft.com/kb/323752)

```
Response.AddHeader("P3P: CP", "CAO PSA OUR") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T03:33:02.723

我会尝试运行[Fiddler](http://www.fiddlertool.com/)，看看在通过 Facebook 与您的应用程序交互时，您的会话 cookie 是否与响应一起正确发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:37:32.790

> 当我直接从 facebook 页面点击 url 时，我遇到了问题，但是当我将 IFrame 的 url 复制到新的浏览器窗口中并尝试它时它工作正常。

如果您在 iframe 中，则您设置的任何 cookie 都是“第三方 cookie”。当用户直接访问您的网站时，第三方 cookie 可能比您设置的普通“第一方”cookie 受到更严格的条件限制。这可能是由于不同的浏览器默认 cookie 处理或因为用户故意这样配置它。（并且有充分的理由：许多第三方都是令人不快的侵犯隐私的广告商。）

特别是，在 IE6+ 的默认设置中，您不能设置第三方 cookie，除非您编写[P3P 策略](http://msdn.microsoft.com/en-us/library/ms537341.aspx)，承诺您将成为一个好孩子，并且不会将您的用户数据发送给最近的身份窃贼。

（在实践中当然 P3P 是一个巨大的损失，因为没有什么可以阻止网站所有者只是撒谎。另一个没有实际安全性的毫无价值的并发症。是的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:15:49.020

会话还取决于客户端的 cookie 支持。当您说该应用程序“被 facebook 击中”时，您确定他们以什么方式“击中”您，他们正在支持 cookie？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-26T03:47:25.467

Response.Redirect 和 refresh 不携带会话。Server.Transfer() 可以但失去传输到其他服务器/站点的能力。

# c++ - How can protocol-buffers support serialization/deserialization of std containers?

> ID：684390
> 
> 赞同：4
> 
> 时间：2009-03-26T03:13:24.457
> 
> 标签：c++, serialization, protocol-buffers

We plan to replace `Boost.serialization` with protocol-buffers used in distributed system design. How protocol-buffers support complicated data structures such as std containers?

For instance, such a class is required to be serialized/deserialized in our case:

```
class Foo
{
  std::vector< std::pair< unsigned int, std::vector< std::pair< int, int> > > > data;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T03:16:42.543

Protocol buffers have employ a parser which takes a .proto file and creates appropriate serialization routines. See [this](http://code.google.com/apis/protocolbuffers/docs/overview.html).

Update: You can represent a vector of strings as:

```
message MyCollection {   
   repeated string str = 1;
} 
```

in your proto file.

and use:

```
std::vector<std::string> my_strings; 
// add strings to vector MyCollection proto; 
vector<string>::iterator e = my_strings.end();
for (vector<string>::iterator i = my_strings.begin(); 
    i != e; 
    ++i) {
   *proto.add_str() = *i; 
} 
```

It should be easy to extend for another collection/collection of collections.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T19:14:19.843

The protobuf representation of your Foo would look something like this:

```
message IntPair {
    required int32 first  = 1;
    required int32 second = 2;
};

message FooElem {
    required uint32 first = 1;
    repeated IntPair second = 2;
};

message Foo {
    repeated FooElem data = 1;
}; 
```

Note that Protocol Buffers doesn't provide a "seamless" (de)serialization to/from your own structures like Boost.Serialization does. You work with generated objects that come from running the `protoc` compiler on a file like the above.

These generated classes will not contain `std::pair` and `std::vector` members however, so you'll need to copy data too/from the generated objects if you want to keep working with your legacy `Foo` structure.

# .net - 在单元测试中使用数据库

> ID：684391
> 
> 赞同：2
> 
> 时间：2009-03-26T03:14:33.393
> 
> 标签：.net, asp.net-mvc, datadirectory

我遇到了这个错误

```
An attempt to attach an auto-named database for file C:\<...>\Out\MessagesDB.mdf failed. A database with the same name exists, or specified file cannot be opened, or it is located on UNC share.. 
```

尝试编写一些单元测试来测试控制器。我相信问题在于测试试图不使用我在主项目中定义的数据库。所以我将测试中的连接字符串修改为

在我正在使用的测试项目的 App.config 中

```
<connectionStrings>
    <add name="MessagesDBConnectionString" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\MessagesDB.mdf;Integrated Security=True;User Instance=True"
      providerName="System.Data.SqlClient" />
</connectionStrings> 
```

然后通过执行覆盖 DataDirectory

AppDomain 域 = AppDomain.CurrentDomain;

```
 String currentDirectory = System.Environment.CurrentDirectory;
        String DataDirectory = currentDirectory.Substring(0, currentDirectory.IndexOf("TestResults")) + "Server\\App_Data";
        domain.SetData("DataDirectory", DataDirectory);
        db = new Server.Models.MessagesDBDataContext(); 
```

效果很好，但看起来像黑客。我应该怎么做？

**编辑：**

我今天又看了一眼这个可怕的混乱，基于 Nerd Dinner 示例，我从项目中的控制器中删除了对数据库的所有直接调用，并将它们移动到实现接口 (IRepository) 的存储库对象中。然后我创建了一个假的存储库对象，它也实现了 IRepository。我向每个控制器添加了一个构造函数，它允许传入要使用的 IRepository。然后更改默认控制器构造函数以初始化存储库。测试不再与数据库对话，因此它们更快且破坏性更小。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T03:16:33.043

标准方法是模拟数据库。这意味着您正在测试的类需要一个提供数据的参数，并且看起来像一个数据库连接。

在单元测试中，您实际上传递了一个提供硬编码数据的实现。

There are tools which can help you with this, for example by saving the results of a database query into a config file, so that you can set up the test with real data, but it will load quickly and never change because it is now saved in a file separate from the database. [SnapDAL](http://snapdal.sourceforge.net/) is one tool you can use for this.

# .net - Entity Framework 连接字符串可以重用现有的连接字符串吗？

> ID：684394
> 
> 赞同：5
> 
> 时间：2009-03-26T03:15:58.957
> 
> 标签：.net, entity-framework, ado.net

在我的配置文件中，我有一个应用程序的遗留部分（使用数据集）使用的连接字符串和实体框架的另一个字符串：

```
<connectionStrings>
    <add name="Database" connectionString="Server=..." />
    <add name="Entities" connectionString="metadata=.....connection string='Server=..." />
</connectionStrings> 
```

这意味着服务器名称、数据库名称等被指定了两次。我想告诉 EF 连接字符串重用第一个字符串 - 这可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-12-14T23:03:43.397

我知道这篇文章有点老了，但我认为这会对那里的人有所帮助：

您可以使用 EntityConnectionStringBuilder 从现有连接字符串构建 EF 连接。这是我在自己的代码中使用的示例：

```
public static string GetEntityFrameworkConnectionString(string clientConnectionString)
{
    EntityConnectionStringBuilder entityBuilder = new EntityConnectionStringBuilder();
    entityBuilder.Provider = "System.Data.SqlClient";
    entityBuilder.ProviderConnectionString = clientConnectionString;
    entityBuilder.Metadata = "res://*/Entities.UBTEntities.csdl|res://*/Entities.UBTEntities.ssdl|res://*/Entities.UBTEntities.msl";
    return entityBuilder.ToString();
} 
```

因此，当您实例化 EF 提供程序时，只需将从上述方法返回的字符串传入构造函数即可。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:18:41.963

我认为更好的方法是重构应用程序以仅使用一个连接字符串，而不是尝试在配置文件中从另一个连接字符串中引用一个。

# php - 我应该使用“id”还是“唯一用户名”？

> ID：684398
> 
> 赞同：4
> 
> 时间：2009-03-26T03:17:14.743
> 
> 标签：php, mysql, database, flash, surrogate-key

我正在使用 PHP、AS3 和 mysql。

我有一个网站。一个flash(as3) 网站。flash网站通过php将会员信息存储在mysql数据库中。在“成员”表中，我将“id”作为主键，将“用户名”作为唯一字段。

现在我的情况是：当flash想显示一个会员的资料时。我的问题：

1.  Flash 是否应该将成员“ID”或“用户名”传递给 php 来处理 mysql 查询？

2.  传递“id”或“用户名”有什么不同吗？

3.  哪个更安全？

4.  你推荐哪一个？

我想在安全性和性能方面优化我的网站。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T03:20:24.487

主键始终是识别数据库行的最安全方法。例如，您以后可能会改变主意并允许重复的用户名。

根据您的 ActionScript 与 PHP 通信的方式，如果您在请求中发送整数 ID 而不是用户名，它可能还需要发送更少的字节。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-26T03:23:32.183

1) 两者都不是它*应该*做的事。

2) ID 可能更短且查找速度更快。该 ID 提供了有关您系统的更多信息；如果您知道某个站点完全使用序列号，并且您知道其中一个是什么，那就像知道所有这些一样好，而知道一个用户名并不能告诉您任何其他用户的用户名。另一方面，用户名更能揭示用户的心理，可能构成密码提示。

3) 如第 2 项所述，两者都有极小的跌幅。

4）我会使用身份证。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T03:23:41.967

传递 id 号的参数：

*   人们永远不会改变他们的身份。人们确实会改变他们的名字。对于一个拥有一次性账户的休闲游戏网站来说，这可能不是问题，但对于长期注册用户来说却是。我不得不处理一个心烦意乱的女人要求从她的用户名中清除她前夫的姓氏的要求。必须迅速建立一个这样做的过程！

*   更短

*   更容易索引和分区。

传递用户名的参数：

*   猜测一个合法的现有帐户稍微困难（但并非不可能） - 例如，仔细阅读随机人的记录，如果那是你的事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T03:19:53.910

可能您应该非常熟悉“PHP Sessions”，也许使用已经具备此功能的框架，因为它很重要，而且您不想把它搞砸。会话管理软件将为您处理所有这些，包括登录屏幕、“我忘记了密码”等。

然后，您可以将注意力集中在您的网站的真正主要用途上。

听起来很有趣（actionscript + php + mysql）-祝你好运！

# ruby-on-rails - 此功能的最佳数据结构和设计

> ID：684404
> 
> 赞同：3
> 
> 时间：2009-03-26T03:22:28.660
> 
> 标签：ruby-on-rails

在我的 Rails 应用程序中，我有一个名为 Situations 的部分，它基本上是一种情况的文本描述。但是有几个。我希望**一次只显示一个，并且每个都在自己的页面上**（首先是最新创建的），然后在页面底部我有指向旧情况和新情况的链接。

假设`@situations`我的代码中有一个对象，其中包含我想要显示的所有情况。接下来我应该做什么（在控制器和视图中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T09:39:02.967

我会使用分页（[`will_paginate`](http://github.com/mislav/will_paginate/tree/master)）并将每页的项目数设置为 1。

然后，您可以使用`current_page`and`next_page`来建立您的链接。在此处查看[源代码](http://github.com/mislav/will_paginate/blob/8888651be8d6656bdf2378731d91a8badbaa2556/lib/will_paginate/collection.rb)。

除此之外，它只是一个标准的索引操作，需要对`will_paginate`.

这个[截屏视频](http://railscasts.com/episodes/51-will-paginate)应该可以让您很好地了解您需要什么，但请注意，自从插件制作以来，它已经发生了一些变化。详细信息在[`will_paginate`github wiki 上。](http://wiki.github.com/mislav/will_paginate/simple-search)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:47:14.593

模型/情况.rb

```
class Situation < ActiveRecord::Base
  default_scope :order => 'created_at desc'
end 
```

控制器/situations_controller.rb

```
class SituationsController < ActionController::Base
  def index
    @situations = Situation.all
  end
end 
```

意见/情况/index.html.erb

```
<h1>Situations</h1>
<%= render @situations %> 
```

意见/情况/_situation.html.erb

```
<h2><%= situation.name -%></h2>
<p><%= situation.description -%></p> 
```

# java - What data structure is most suitable for implementing a 2-D array in Java?

> ID：684405
> 
> 赞同：8
> 
> 时间：2009-03-26T03:22:47.570
> 
> 标签：java, data-structures, multidimensional-array

I want to implement a 2-D array kind of a thing.

What data structure will be most suitable for this? An array or some other data-structure will do. If there is any other data structure which will satisfy my requirement, then please tell me.

I don't want to use an array because the 2-D array needs to be declared early in the program but it is not fixed; the size will be determined at run time.

Also, the number of rows will be equal to the number of columns; this is fixed, because the same name will be given to both the rows and the columns.

I also want to traverse through this 2-D data structure as I would through a Map.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T04:37:26.377

听起来您想使用行键、列键，然后是该位置的值。没有内置的数据结构可以为您做到这一点。

最容易使用的可能是实际数据的二维数组。使用类似下面的内容从行名或列名转到数组中的实际索引。根据需要添加任意数量的名称到索引绑定。

```
Map<String, Integer> rows = new HashMap<String, Integer>();
Map<String, Integer> cols = new HashMap<String, Integer>(); 
```

然后在网格中获取该值...

```
grid[rows.get("Row name")][cols.get("Column name")]; 
```

`get(String rowName, String colName)`如果您想要更简洁的 API，请将网格和方法放在一个类中。

编辑：我看到问题已更新，看起来名称-索引对对于行和列都是相同的。所以这是一个更新的版本：

```
class SquareMap<V> {
    private V[][] grid;
    private Map<String, Integer> indexes;

    public SquareMap(int size) {
        grid = (V[][]) new Object[size][size];
        indexes = new HashMap<String, Integer>();
    }

    public void setIndex(String name, int index) {
        indexes.put(name, index);
    }

    public void set(String row, String col, V value) {
        grid[indexes.get(row)][indexes.get(col)] = value;
    }
    public V get(String row, String col) {
        return grid[indexes.get(row)][indexes.get(col)];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:55:55.850

（根据评论编辑）

如果大小是在运行时确定的，那不是问题。这可能有效：

```
final int[][]              data;
final int                  size;
final Map<String, Integer> names;

// code that sets the size variable
names = new HashMap<String, Integer>();
data  = new int[size][size];

names.put("ID-A", 0);
names.put("ID-B", 1);

data[names.get("ID-A")][names.get("ID-A")] = 39;
data[names.get("ID-A")][names.get("ID-B")] = 40;
data[names.get("ID-B")][names.get("ID-A")] = 41;
data[names.get("ID-B")][names.get("ID-B")] = 42; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:55:44.680

数组*可以*在运行时调整大小。如果您的行/列大小不会经常变化，并且数据不是太稀疏，那么数组是您最好的选择。

```
class TwoDimArray {
    public int[][] createArray(int nRows, int nCols) {
        return new int[nRows][nCols];
    }
    public int[][] resizeArray(int[][] oldArray, int nRows, int nCols) {
        int[][] newArray = new int[nRows][nCols];
        for (int i=0; i<Math.min(oldArray.length, nRows); ++i)
            for (int j=0; j<Math.min(oldArray[i].length, nCols); ++j)
                newArray[i][j] = oldArray[i][j];
        return newArray;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-28T11:33:56.787

你可以只使用像

```
class TwoDArray<V> implements Iterable<Map.Entry<Point, V>> {
    private final Map<Point, V> map = new LinkedHashMap<Point, V>();
    public V set(int x, int y, V value) {
       return map.put(new Point(x,y), value);
    }
    public V get(int x, int y) {
       return map.get(new Point(x, y));
    }
    public Iterator<Map.Entry<Point, V>> iterator() {
       return map.entrySet().iterator();
    }
}

// to iterate
TwoDArray<Double> twoDArray = new TwoDArray();
twoDArray.set(3, 5, 56.0);
twoDArray.set(-1000, 5, 123.4);
twoDArray.set(789012345, -100000000, -156.9);
for(Map.Entry<Point, Double> entry: twoDArray) {
  //
} 
```

# c# - c#可靠的延迟/计划执行最佳实践

> ID：684406
> 
> 赞同：3
> 
> 时间：2009-03-26T03:23:11.577
> 
> 标签：c#, scheduled-tasks, delayed-execution

我正在进行的项目需要在特定时间完成一些执行。我不确定处理这种情况的最佳方法是什么。该方法必须能够在服务器重新启动/维护后继续存在。并且方法调用必须以编程方式进行。

我正在考虑走这条路：

我可以在数据库（甚至是消息队列）中有一个名为 TaskTable 的表，它可以有 TaskID(PK)、TaskName(varchar)、TaskStatus(enum success、failed、scheduled) 和 TimeOfExecution。但我需要一个定期轮询数据库以查找任何未执行任务的 Windows 服务。我面临的问题是：我用什么作为 TaskName 来保存到数据库中？班级名称？类和方法名 ToString？以及如何将字符串转换回来并以编程方式调用方法调用（我不想有一个巨大的 switch 语句）？一个典型的任务如下所示。所以我需要能够获取任务“SendIncompleteNotification”的名称和类名将其保存到数据库中，并在检索时以编程方式调用

```
public static Task<string> SendIncompleteNotification
{
  get
    {
      return new Task<string>
        (
          a => Console.WriteLine("Sample Task")
          , "This is a sample task which does nothing."
        );
   }
} 
```

现在的问题是我在以编程方式保存方法/属性名称时遇到问题。

```
var type = ApplicationTask.SendIncompleteNotification.GetType();
//type.Name shows "Task`1" rather than SendIncompleteNotification 
```

有没有更好的方法来处理这种情况？谢谢！

更新：对不起，我的头在旋转。我现在意识到我做错了什么是有另一种方法/属性来返回我的任务。我应该做的是从我的任务中继承一个新的类。在那里我可以轻松地获取类名并将字符串保存到数据库中，然后再返回并调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:27:49.773

您可能想查看 Windows 工作流。据我所知，它们是为长时间运行的进程而设计的，可以持久化到数据库并在事件或计时器上唤醒。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T03:29:09.643

数据库是必需的吗？

如果不是，那么调用通用控制台应用程序的 Windows 计划任务（他们倾向于“正常工作”）呢？控制台应用程序的参数可能是：

*   包含要执行的任务的 DLL
*   实现您定义的接口的类的名称
*   其他论点

这样，您可以将所有任务放入一个程序集或多个程序集中。或者，您可以创建一个属性，将该属性应用到您的任务以给它们一个“友好的名称”，然后对程序集使用反射来查找具有匹配属性的类。

编辑：示例：

```
interface ITask
{
    void Execute(ExcecutionContext context);
}

[TaskName("Send Emails")
class SendEmailsTask : ITask
{
    public void Execute(ExcecutionContext context) 
    {
        // Send emails. ExecutionContext might contain a dictionary of 
        // key/value pairs for additional arguments needed for your task. 
    }
}

class TaskExecuter 
{
    public void ExecuteTask(string name) 
    {
        // "name" comes from the database entry
        var types = Assembly.GetExecutingAssembly().GetTypes();    
        foreach (var type in types)
        {
            // Check type.GetCustomAttributes for the TaskAttribute, then check the name
        }
    }
} 
```

编辑 2：这是对您的代码示例的回答。

```
class YourClass
{
    public static Task<string> SendIncompleteNotification
    {
        get {
            return new Task<string>(
                s => Console.WriteLine("Executing task... arguments: {0}", s),
                "My task");
        }
    }
}

interface ITask
{
    void Execute(object o);
}

class Task<T> : ITask
{        
    public Task(Action<T> action, string name)
    {
        Action = action;
    }

    public string Name { get; set; }
    public Action<T> Action { get; set; }

    void ITask.Execute(object o)
    {
        Action((T)o);
    }
}

class Program
{
    static void Main(string[] args)
    {
        // Assume that this is what is stored in the database
        var typeName = typeof (YourClass).FullName;
        var propertyName = "SendIncompleteNotification";
        var arguments = "some arguments";

        // Execute the task
        var type = Type.GetType(typeName);
        var property = type.GetProperty(propertyName);
        var task = (ITask)property.GetValue(null, null);
        task.Execute(arguments);
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T03:31:15.130

存储程序集 FullName，然后键入 FullName 和方法名称。假设方法签名是可预测的（比如没有参数并返回 void）

1) 使用 Assembly 类型的静态 LoadFrom 方法创建程序集的实例。

2) 使用 GetType 方法从程序集中获取对类类型的引用

3) 使用 GetMethod 方法从类型中获取 MethodInfo 实例

4) 使用 Activator.CreateInstance 创建类型的实例

5) 使用 MethodInfo 实例的 Invoke 执行方法，从第 4 步传入类实例。（抱歉，我在公共计算机上没有 VS 的副本来编写真正的代码，但这 5 个步骤就可以了。

此外，如果您使用的是 SQL 2005，请考虑使用 SqlDependency 对象并在您的 talbe 更改而不是轮询时获得“通知”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T03:37:12.260

你看过[Quartz](http://quartznet.sourceforge.net/)吗，它工作得很好，而且我很确定它实现了你需要的所有功能。

# javascript - 将参数值添加到所有对象

> ID：684412
> 
> 赞同：0
> 
> 时间：2009-03-26T03:25:46.890
> 
> 标签：javascript, parameters

您好，我想将参数值添加到页面中的所有对象。像

参数名称=“wmode”值=“透明”

对所有对象。我怎样才能做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T03:42:15.477

听起来您正试图操纵一些嵌入式 SWF？..也许看看[swfobject](http://code.google.com/p/swfobject/)因为它会为你处理很多事情

# graphics - 有谁知道 3d 图形编程基础的好教程（从头开始，不是 Direct3d 或 OpenGL）

> ID：684419
> 
> 赞同：2
> 
> 时间：2009-03-26T03:30:44.133
> 
> 标签：graphics, 3d

我正在寻找一些关于齐次坐标、透视和投影如何在基本级别上在 3d 图形中工作的材料。使用编程的方法将是一流的。我一直在四处寻找，我的搜索与 OpenGL、Direct3d 以及更关注数学证明而不是实际应用程序的材料有关。有谁知道我可以找到这些信息的地方（首选在线访问）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:37:44.333

您可能需要寻找 OpenGL 之前的教科书，例如 Foley 和 van Dam 的[计算机图形学：C 语言的原理和实践（第 2 版）。](https://rads.stackoverflow.com/amzn/click/com/0201848406)

特别是，第 11 章表示曲线和表面和第 15 章可见表面测定是相关的，但如果你真的从头开始做所有事情，那么早期关于如何绘制线条和形状的材料也会很有用。如果你仔细想想，像画一条线这样简单的事情并不是微不足道的。

[![替代文字](https://i.stack.imgur.com/ma68k.jpg)](https://i.stack.imgur.com/ma68k.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T03:37:39.357

我在[Charles Petzold 的书籍博客](http://charlespetzold.com/blog/toc.html)上找到了很多很棒的 3D 图形编程信息。3D 代码大部分是在 XAML 中，所以它很简单，可以理解基础知识，而不会产生太多开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:45:24.737

我现在正在一起阅读以下两本书，以同时学习 WPF 的 3D 图形模型和底层数学。在我看来，这两本书都很出色，尽管它可能不是你想要的：

[用于图形和游戏开发的 3D 数学入门](https://rads.stackoverflow.com/amzn/click/com/1556229119)

[3D Programming for Windows](https://rads.stackoverflow.com/amzn/click/com/0735623945)（这是一本 WPF 3d 书籍，虽然标题没有反映出来）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T10:53:09.073

一个好的开始将是[OpenGL 编程指南](http://www.opengl.org/documentation/red_book/)（红皮书）。您可以在线阅读它（尽管版本较旧），其中充满了示例（实际工作代码）。

# c# - WinForms C# DataGridView 强制刷新

> ID：684421
> 
> 赞同：6
> 
> 时间：2009-03-26T03:32:53.847
> 
> 标签：c#, winforms, datagridview, refresh

婴儿步滚动...我有一个表格，表格上绑定了一个数据网格。我在绑定到表格 [列] 的表单上有一些文本框，因此当我滚动网格时，文本框会显示相应的数据。

我转到文本框的“编辑模式”并更改内容并点击保存按钮。网格不会刷新更改的上下文，直到我物理单击单元格以强制调用表 OnChanging 和 OnChanged 事件...

如何在编辑结束时强制执行任何事件以“刷新”表格并在 datagridview 中刷新它。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-26T04:00:42.563

您是否尝试过调用 dataGridView 的 Invalidate 方法？

```
this.dataGridView1.Invalidate(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:52:43.377

您使用的是 BindingSource 吗？如果是这样，请在 TextBox 的 Leave 事件上调用其[EndEdit方法。](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.endedit.aspx?ppud=4)

# linux - 如何设置我的 Linux X 终端以便 Emacs 可以访问 256 色？

> ID：684424
> 
> 赞同：8
> 
> 时间：2009-03-26T03:35:53.887
> 
> 标签：linux, emacs, colors, xterm

当我`emacs -nw`在 X 终端窗口中运行并请求 时`M-x list-colors-display`，我得到了一个微不足道的调色板：

```
black                                                     
red    
green  
yellow 
blue   
magenta
cyan   
white 
```

我被告知有可能获得 265 种颜色。将`TERM`环境变量设置为`xterm-256color`不会完成这项工作。有什么作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T03:41:16.823

据此[，](http://www.enigmacurry.com/2009/01/20/256-colors-on-the-linux-terminal/)除了`ncurses-term`设置`TERM`为`xterm-256color`.

好的，[这](http://www.xvx.ca/~awg/emacs-colors-howto.txt)还有一些其他的尝试，比如：

```
The xterm in Ubuntu Edgy does not advertise 256 color support by
default.  To fix this you need to install a 256 color terminfo entry,
and tell xterm to use it:

    apt-get install ncurses-term
    echo XTerm.termName: xterm-256color \
      >>~/.Xdefaults
    xrdb -merge ~/.Xdefaults 
```

和 ：

```
So you need a file term/screen-256color.el in your load-path.  Emacs
22 expects it to contain a terminal-init-screen defun.  Emacs 21
expects it to contain a bunch of top-level forms.  Here's what I use:

    ;;; This is for GNU Emacs 22
    (defun terminal-init-screen ()
      "Terminal initialization function for screen."
      ;; Use the xterm color initialization code.
      (load "term/xterm")
      (xterm-register-default-colors)
      (tty-set-up-initial-frame-faces))

    ;;; This is for GNU Emacs 21
    (if (= 21 emacs-major-version)
        (load "term/xterm-256color"))

For Emacs 21, you also need to install the xterm-256color.el file from

    http://www.splode.com/~friedman/software/emacs-lisp/src/term/xterm-256color.el 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T05:35:07.033

设置`TERM`为`xterm-256color` *是*您想要做的。此外，Emacs 22（至少）不需要我的任何特殊配置来显示 256 色。请参阅此[相关问题](https://stackoverflow.com/questions/679579/emacs-xterm-color-annoyance-on-linux)。安装`ncurses-term`软件包后，我可以使用我的 Ubuntu 版本附带的 vanilla xterm 在 Emacs 上获得 256 种颜色（在这种情况下是 Interpid，但我猜它在早期版本上会很好）。我还使用 Gnome Terminal、Konsole 和 PuTTY 获得了 256 种颜色，物有所值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:50:44.163

当我用谷歌搜索这个时，我得到的印象是大多数发行版在打包的终端模拟器中没有启用 256 色支持。

我怀疑如果你继续看，你可能会得出和我一样的结论。最好的答案是下载[urxvt](http://software.schmorp.de/pkg/rxvt-unicode.html)并在所有花里胡哨的情况下自行编译。

我使用的是 vim，所以可能还有其他特定于 emacs 的依赖项/陷阱，但我很确定支持 256 色的终端很重要。

# c# - 列表排序 - 扩展方法未触发！

> ID：684425
> 
> 赞同：1
> 
> 时间：2009-03-26T03:36:08.800
> 
> 标签：c#, linq, extension-methods

我正在尝试对这样的列表进行排序：

```
public void Example()
{
    string target = "hello";

    List<string> myStings = new List<string>();

    myStings.Add("babab");
    myStings.Add("Helll");
    myStings.Add("atest");

    myStings.OrderBy(each => Distance(each, target));
}

public int Distance(string stringA, string stringB)
{
    // Whatever
} 
```

问题是列表没有被排序并且距离方法没有被触发（我在那里放了一个断点但没有被命中）。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:52:59.540

这是因为**[Linq 的延迟执行](http://blogs.msdn.com/charlie/archive/2007/12/09/deferred-execution.aspx)**

> 在 LINQ 中，查询的执行通常推迟到您实际请求数据的那一刻。

因此，要查看您的方法是否有效，请将该`ToList()`方法应用于您的方法，`IOrderedEnumerable`以便您**实际请求数据**，从而执行执行。

```
myStings = myStings.OrderBy(each => Distance(each, target)).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T03:42:41.657

myStings = myStings.OrderBy(each => Distance(each, target)).ToList();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T04:10:16.690

您的

```
myStrings.OrderBy(each => Distance(each, target)); 
```

不会订购您的原始列表，它会返回一个有序列表。你需要：

```
myStrings = myStrings.OrderBy(each => Distance(each, target)).ToList(); 
```

这将强制延迟执行并为您提供所需的结果。

# javascript - Auto-complete text field

> ID：684431
> 
> 赞同：4
> 
> 时间：2009-03-26T03:38:34.363
> 
> 标签：javascript, ruby-on-rails, ajax, autocomplete, textfield

How do I make an autocomplete text field like the one here at Stack Overflow for the Tags fields? I want to use it for my Rails app.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T03:47:11.677

StackOverflow 使用[jQuery Autocomplete Plugin](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)，它有多个项目支持。

检查[演示](http://jquery.bassistance.de/autocomplete/demo/)。

编辑页面的片段：

```
$("#tagnames").autocomplete("/tags/filter", {
    max: 6,
    highlightItem: true,
    multiple: true,
    multipleSeparator: " ",
    matchContains: true,
    scroll: true,
    scrollHeight: 300
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T03:46:41.270

[Rails 2 中的自动完成文本字段](http://codeintensity.blogspot.com/2008/02/auto-complete-text-fields-in-rails-2.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T03:45:35.767

基本思想是，您使用 onkeydown 或 onkeypress 事件（最好有一点延迟）触发对服务器的 AJAX 请求，使用目前输入的文本进行搜索并将可能的完成发送回客户端。客户端然后进行 DOM 操作以显示这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-30T13:19:57.763

您有 2 个选项可以使用[Autocomplete gem](https://github.com/crowdint/rails3-jquery-autocomplete)或[TokenInputs执行](http://loopj.com/jquery-tokeninput/)[Rails Jquery UJS](https://github.com/rails/jquery-ujs) ，并查看[TokenFields 上的 Railscasts，了解](http://railscasts.com/episodes/258-token-fields)如何根据您的情况进行设置。就个人而言，我喜欢后者对自己的个人主题所做的事情。

# .net - WCF 作为具有最小有效负载的 Web 服务

> ID：684432
> 
> 赞同：4
> 
> 时间：2009-03-26T03:39:56.217
> 
> 标签：.net, wcf, web-services, api, rest

这些天来，我的大部分工作都是使用 Microsoft 技术完成的，所以我很自然地会检查 WCF 提供的功能。它看起来非常灵活，是 .Net 远程处理的一个很好的下一步，但它似乎与 SOAP 消息非常相关，并且对于与平台无关的 Web 服务应用程序来说有点笨拙。我不是该技术方面的专家，但我想他们所吹捧的所有这些灵活性意味着您可以摆脱 SOAP 消息并返回您想要的任何数据结构/格式。这是对还是错？

我这么说的原因是，如果我真的想将应用程序创建为 REST 服务，那么我的目标平台之一就是移动平台。不仅如此，任何基于 Web 的服务的一个重要目标是保持较小的数据负载，无论是对于拨号速度的移动设备还是完整的桌面应用程序。

因此，如果您以 Twitter 的 api 为例，它取得了令人难以置信的成功，因为您可以请求 JSON 格式的数据，而无需花哨的 SOAP 信封对数据进行加权，并接收最少量的字节来表示您想要的数据。因此，在连接性较差的设备上运行的移动应用程序消耗 Twitter 的数据可以使用尽可能少的带宽。除此之外，Twitter、Facebook 或任何更成功的公共 api 的模式是 JSON 和/或 XML 中的自定义数据结构，而不是包装在 SOAP 信封中（尽管我可能是错的......这只是我的印象）。

您将如何在 WCF 中执行此操作？您是否必须跳过箍告诉 WCF“只返回此文本......不要担心 SOAP 信封”，或者它是一个简单的配置选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T03:44:38.063

请参阅[WCF RESTful POX、JSON 和 SOAP 共存](http://www.codemeit.com/wcf/wcf-restful-pox-json-and-soap-coexist.html)。将 WCF 配置为返回简单的 POX 和/或 JSON 实际上非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T14:07:44.990

您可以设置几个配置选项来从 WCF 中删除 SOAP。最简单的做法是使用 WebServiceHost 而不是通常的 ServiceHost 类来托管您的服务。它设置了您想要的大多数选项。Justin Smith 有一篇[很好的文章，对比了 WebServiceHost 和 ServiceHost](http://blogs.msdn.com/justinjsmith/archive/2007/07/02/webservicehost-vs-servicehost.aspx)。

尽管听起来您似乎更担心发送 POX（普通旧 XML）有效负载而不是某些 REST 原则（URL 映射和 HTTP 方法），但您可能会发现 Jon Flander 的[RESTful .NET](http://oreilly.com/catalog/9780596519209/)书很有帮助。这是[第 1 章的概述](http://fyi.oreilly.com/2009/02/wcf-restful-programming-model.html)。

还可以查看 Microsoft 的[REST Starter Kit](http://www.msdn.com/wcf/rest)，其中有很多关于如何使用 WCF 执行常见的面向 Web 任务的示例。

为了回答您问题的另一部分，我发现使用 JSON 产生的有效负载比 XML 小得多，同时在 WCF 中仍然有不错的支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T04:05:01.307

看这个

[http://channel9.msdn.com/shows/Endpoint/endpointtv-Screencast-Building-RESTful-Services-with-WCF/](http://channel9.msdn.com/shows/Endpoint/endpointtv-Screencast-Building-RESTful-Services-with-WCF/)

# c# - MS Word 插件，添加一个在右键单击选定文本时弹出的按钮

> ID：684438
> 
> 赞同：1
> 
> 时间：2009-03-26T03:43:12.310
> 
> 标签：c#, word-2007, shared-addin

我正在为 MS Word 2007 开发一个共享插件。我想添加一个在右键单击选定文本时弹出的按钮。附加的快照应该清楚地说明这一点。

目前，用户必须选择文本，然后单击自定义控件上的按钮。如果在选择文本后，她/他可以右键单击它并在弹出窗口中按下相关按钮，这将容易得多。

![替代文字](https://i.stack.imgur.com/hoKCP.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:38:28.300

您需要扩展正确的上下文菜单。以下链接用文字（无源代码）描述了如何实现这一点：

[使用 Word 共享插件](http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/c2e20f36-35cb-4c2d-b9a4-b464fc7c9989/)

也许这个[链接](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/62240ece-ab2d-4f28-b317-e6bd76f34000/)可能会对编码有所帮助。我自己没有尝试过，但它可能指向正确的方向。

祝你好运！:)

**编辑：**

它必须是功能区样式的上下文菜单还是普通上下文菜单中的按钮就足够了？如果正常菜单没问题，您可以使用这种方式（C#）：

```
 Microsoft.Office.Core.CommandBar cb = this.Application.CommandBars["Text"];

 Office.CommandBarControl newButton = cb.Controls.Add(Office.MsoControlType.msoControlButton, missing, missing, missing, missing);  
 newButton.Caption = "Test";
 newButton.Visible = true;
 newButton.Enabled = true; 
```

您可以使用 VSTO 执行此操作，我不确定它是否与共享加载项技术完全相同，但也许它确实有帮助；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:18:47.330

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa338198.aspx) -

> 您不能以编程方式修改浮动工具栏。

在文档的一半多一点。在迷你工具栏上搜索。

编辑：您在上图中圈出的弹出窗口不会出现在右键单击时，它会出现在突出显示中。上下文菜单（在所选文本下方）可以具有您的自定义功能，但不在迷你工具栏中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T21:39:37.197

这是如何做到的......

```
Microsoft.Office.Core.CommandBar cellbar = diff.CommandBars["Text"];
Microsoft.Office.Core.CommandBarButton button = (Microsoft.Office.Core.CommandBarButton)cellbar.FindControl(Microsoft.Office.Core.MsoControlType.msoControlButton, 0, "MYRIGHTCLICKMENU", Missing.Value, Missing.Value);
if (button == null)
{
   // add the button
   button = (Microsoft.Office.Core.CommandBarButton)cellbar.Controls.Add(Microsoft.Office.Core.MsoControlType.msoControlButton, Missing.Value, Missing.Value, cellbar.Controls.Count + 1, true);
   button.Caption = "My Right Click Menu Item";
   button.BeginGroup = true;
   button.Tag = "MYRIGHTCLICKMENU";
   button.Click += new Microsoft.Office.Core._CommandBarButtonEvents_ClickEventHandler(MyButton_Click);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:08:12.883

[http://groups.google.com/group/microsoft.public.word.docmanagement/browse_thread/thread/cf55d996b3f51a06/65b2bad22e2a3583?lnk=st&q=Removing+Items+from+Word+2007](http://groups.google.com/group/microsoft.public.word.docmanagement/browse_thread/thread/cf55d996b3f51a06/65b2bad22e2a3583?lnk=st&q=Removing+Items+from+Word+2007)是如何在 VBA 中完成的。使用 COM 非常相似，并且可能创建了一个 word 插件（虽然我没有尝试过）您基本上需要找到上下文菜单控件并向其添加一个项目（您的函数）。

# oracle - 在不使用 UTL_FILE 的情况下从 PL/SQL 中的文件读取/写入数据

> ID：684443
> 
> 赞同：1
> 
> 时间：2009-03-26T03:46:28.417
> 
> 标签：oracle, file-io, plsql

是否可以在不使用 Oracle 10g 中的 UTL_FILE 包的情况下从 PL/SQL 块中的文件读取/写入数据？

我目前有一个包含一组主键（大约 28000）的文件，我需要查询一个表以获取需要写入文件的其他数据。我使用的架构非常受限，没有任何创建权限。此外，没有为 UTL_FILE 中的过程正常工作设置必要的读/写权限的目录。要求 DBA 提供额外的权限将花费太多时间。

有没有办法解决这个问题？

提前致谢。

**[编辑]**我无法将数据加载到表中。没有要加载的表或创建表的权限。我认为这是问题中最困难的部分。如果查询条件不能方便地成为查询本身的一部分（即在单独的文件中），如何查询数据库？如果主键的数量很少，我可以生成一些选择语句来提取 sqlplus 中的数据（使用 spool），但是 28000 似乎太大了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T04:06:44.920

如果您无法设置目录，我会说您不走运。您要求在数据库服务器上读取和创建文件。这是您的 DBA 应该知道的。

你确定你需要服务器上的文件吗？您可以将文件从客户端加载到表中（使用通常的客户端工具），然后从那里读/写数据吗？

**更新：**

> 我无法将数据加载到表中。没有要加载的表或创建表的权限。如果主键的数量很少，我可以生成一些选择语句来提取 sqlplus 中的数据（使用 spool），但是 28000 似乎太大了。

28000也不算多。在客户端循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T04:29:22.993

1.  您可以使用 UTL_TPC 包通过 TCP 数据包写入 FTP 服务器。
2.  最好在运行包之前将主键加载到表中，以允许 pl/sql 读取/写入主键表。
3.  用 20000 个键作为插入语句编写一个巨大的 pl/sql 程序，以构建一个内存表并使用它来查询 / 等。然后使用 sqlplus 假脱机结果。或将结果通过电子邮件发送给自己的邮件包。

# asp.net-mvc - 什么会导致 ViewData.ModelState.IsValid 变为 false

> ID：684445
> 
> 赞同：21
> 
> 时间：2009-03-26T03:46:51.833
> 
> 标签：asp.net-mvc

有时我发现我的 ModelState 无效，但由于没有 ModelErrors，因此无法找到使其无效的原因。如果您自己没有添加 ModelError，那么确定什么使您的模型状态无效的最简单方法是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-15T15:02:52.727

查看[asp.net mvc 源代码](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)，ModelStateDictionary 上的 IsValid 属性只是根据 Values 属性中保存的 ModelState ICollection 中是否有任何错误返回 true 或 false。

您应该能够找到任何错误，包括这样的消息和异常：

```
foreach(var modelStateValue in ViewData.ModelState.Values)
{
    foreach(var error in modelStateValue.Errors)
    {
        // Do something useful with these properties
        var errorMessage = error.ErrorMessage;
        var exception = error.Exception;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T00:06:28.823

我遇到了一个类似的问题，并且使用史蒂夫提供的相同类型的例程，发现一个异常被抛出（不优雅）在默认模型绑定器内的某个地方，它没有进入 Html.ValidationSummary。

特别是我遇到的问题是一个带有“是”或“否”选项的保管箱，其值为“1”和“0”（而不是“真”和“假”），模型活页夹在试图将这些转换为布尔值（我的实体成员所期望的），说明 0 不是布尔值的有效值。

我本来希望会生成一条很好的消息，说明我的选择无效，但我却被视为一个空的 ValidationSummary。似乎异常被吞噬了！（现在是我将来会寻找的东西。）这也许应该作为错误提交给 MS？

# c++ - C++ 可移植开源应用程序的最佳实践

> ID：684449
> 
> 赞同：8
> 
> 时间：2009-03-26T03:47:24.000
> 
> 标签：c++, open-source, compiler-construction, makefile

我正在用 C++ 启动一个开源跨平台项目。我的开发环境是Linux。可能还有其他开发人员也从不同的平台进行开发。所以我需要一些帮助来开始配置和开发环境设置，以便来自多个平台的所有开发人员都可以轻松开发。

以下是我的问题

1.  编译器：我打算用g++，听说是跨平台的。这是一个不错的选择吗？
2.  制作文件：我见过*Code::Blocks*编辑器，它会即时生成制作文件，您不必手动编写文件。这是最佳实践还是我需要创建 make 文件？
3.  开发跨平台应用程序时还需要注意哪些其他设置？

有什么想法吗？

**编辑**

感谢您的回答。还有一个问题。

您是否手动创建 makefile？或者有什么工具可以生成吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T04:03:31.230

您的项目要赶上的最重要的事情是可移植性。它应该很容易为每个人构建和运行。

GCC (g++) 确实是首选编译器。它来自开源世界，因此被它最广泛地采用。

然而，**一个简单的 Makefile 并不会削减它**。使用 CodeBlocks 或任何其他 IDE 生成它有一个问题：由于他们的平台，其他开发人员可能必须生成自己的，但手头不一定有 CodeBlocks，或者只是不想使用它。

存在几种不同的跨平台构建系统，它们与 IDE 无关。他们中的一些人创建 Makefile，其他人不使用 make 而是自己构建。

*   最广泛采用的构建系统是[Autotools](http://en.wikipedia.org/wiki/GNU_build_system)。但是，它很难学习，杂乱无章，而且总体上很痛苦。
*   在许多其他选择中，**我推荐[Waf](http://code.google.com/p/waf/)**。几个大型开源项目已经证明了这一点，XMMS2 就是一个很好的例子（虽然不是一个非常流行的项目，但它有一个包含大量插件的大型构建，并且构建在包括 OS X 和 Windows 在内的许多平台上）。虽然 waf 没有被广泛采用，但它是随源代码一起提供的，并且易于设置。我给你的推荐。

**编辑：**要开始您的开源项目，我还推荐Karl Fogel 的[这本书](http://producingoss.com/)（可在线阅读）。玩得开心！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T06:12:29.347

GNU C++ 编译器是跨平台工作的一个相对较好的选择，除了在 Windows 上仅原生支持相对较旧的版本 (3.4)。将 4.x 系列移植到 Windows 的工作正在进行中，但到目前为止还没有准备好迎接黄金时段。

我不会专注于使用什么编译器，而是专注于使用哪种语言。编写 ANSI 标准 C++ 将大大有助于使您的代码跨平台。尽可能将特定于平台的行为隐藏在一个好的工具包后面，比如 Qt。

对于跨平台构建环境，这可能取决于您使用的工具包。Qt有QMake，比较好。CMake 是另一个引人注目的选择。我会避免使用 Autotools，因为它在 UNIX 之外的可移植性很差——在 Win32 上使用 Autotools 经常是该死的折磨。

最后，现在开始在多个平台上工作*。* 对于这样的事情，VMware 是无价的。让您的代码在 Linux、FreeBSD 和 Windows 上编译。如果你能达到这三个目标，那么将来迁移到其他平台将变得非常容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T04:02:20.517

根据特定的平台，[Qt](http://qt.nokia.com/)可能会提供答案。尤其是新许可证。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T04:02:55.630

*   现在开始在多个平台上构建：它会尽早暴露问题。
*   如果你只关心 Linux 和 Mac OS X，那么 g++ 应该没问题。有各种可用的 IDE 和构建系统。您可能需要考虑使用[自动工具](http://www.gnu.org/software/autoconf/)来帮助提供配置支持。
*   如果你想以 Windows 为目标，它会变得有点复杂。您可以使用 cygwin 和/或 mingw，但这有时会很复杂。[各种项目使用CMake](http://www.cmake.org/)等跨平台构建和配置系统来处理许多问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T03:50:34.773

> 编译器：我打算用g++，听说是跨平台的。这是一个不错的选择吗？

是的，但是哪个版本？您是否有要使用的版本的已知问题列表？

> 制作文件：我见过 Code::Blocks 编辑器，它会即时生成制作文件，您不必手动编写文件。这是最佳实践还是我需要创建 make 文件？

经典的选择。当项目增长时，您可能需要调整它们。

> 开发跨平台应用程序时还需要注意哪些其他设置？

g++/makefile 端口可用于任何主要平台。因此，一旦您确定您没有使用任何特定于平台的 API 或构造，您就可以开始使用了。

下面的呢？

*   第三方库？确保您不会爱上特定于平台的平台。
*   许可问题（您的代码和其他人）
*   单片机

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T03:52:58.637

这是一本书，可以回答你所有的问题。[C++ 中的跨平台开发：构建 Mac OS X、Linux 和 Windows 应用程序](https://rads.stackoverflow.com/amzn/click/com/032124642X)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T04:16:33.367

您可能还想看看这本书：

[http://www.amazon.ca/Write-Portable-Code-Introduction-Developing/dp/1593270569](http://www.amazon.ca/Write-Portable-Code-Introduction-Developing/dp/1593270569) [![替代文字](https://i.stack.imgur.com/rhfMo.jpg)](https://i.stack.imgur.com/rhfMo.jpg)

# c# - 如何在 VB.NET 或 C#.NET 代码中从 yahoo 邮件 ID 发送邮件

> ID：684454
> 
> 赞同：2
> 
> 时间：2009-03-26T03:49:43.697
> 
> 标签：c#, vb.net

我想从我的 yahoomail Id 发送邮件。如何在 VB.NET 或 C#.NET 代码中从 yahoo 邮件 Id 发送邮件。需要帮助..提前谢谢。

西瓦库玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T11:27:43.830

以下是一些制作基本 html 电子邮件的示例。

[http://help.yahoo.com/l/us/yahoo/mail/original/mailplus/pop/pop-14.html](http://help.yahoo.com/l/us/yahoo/mail/original/mailplus/pop/pop-14.html)

```
 ' VB

    Dim m As MailMessage = New MailMessage
    m.From = New MailAddress("you@yahoo.com", "Your Name")
    m.To.Add(New MailAddress("Recipient@somedomain.com", "Recipient Name"))
    m.Subject = "Hello"
    ' Specify an HTML message body
    m.Body = "<html><body><h1>My Message</h1><br>Put the body here.</body></html>"
    m.IsBodyHtml = True
    ' Send the message
    Dim client As SmtpClient = New SmtpClient("smtp.mail.yahoo.com")
    client.Send(m)

  // C#

    MailMessage m = new MailMessage();
    m.From = new MailAddress("you@yahoo.com", "Your Name");
    m.To.Add(new MailAddress("Recipient@somedomain.com", "Recipient Name"));
    m.Subject = "Hello";
    // Specify an HTML message body
    m.Body = "<html><body><h1>My Message</h1><br>Put the body here.</body></html>";
    m.IsBodyHtml = true;
    // Send the message
    SmtpClient client = new SmtpClient("smtp.mail.yahoo.com");
    client.Send(m); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T03:53:32.457

一般的想法可以在[这里找到](http://code.msdn.microsoft.com/sendemail)

有关 Yahoo SMTP 的详细信息，请登录您的 Yahoo 帐户并单击“帐户信息”，然后单击“POP、SMTP 和 NNTP 服务器设置”

# session - 如何从 ruby on rails 会话中清除单个条目？

> ID：684457
> 
> 赞同：30
> 
> 时间：2009-03-26T03:52:29.823
> 
> 标签：session, ruby-on-rails-2

在 ruby​​ on rails 中，这样做`session[:foo] = nil`时会留下一个`:foo`在会话对象中命名的条目。如何从会话对象中删除该单个条目？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2011-02-09T08:43:04.423

看起来**最简单的版本可以工作**。所有存储（Cookie、文件、ActiveRecord...）都`AbstractStore::SessionHash`用作包含数据的对象，不同的存储仅提供加载和保存`AbstractStore::SessionHash`实例的方法。

`AbstractStore::SessionHash`继承自`Hash`，因此这取决于`Hash#delete`方法：

```
session.delete(:key_to_delete) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-26T08:10:24.443

实际上有一种方法可以从会话中删除一个值。就像 RichH 所说的会话变量是一个 CGI::Session 实例。当输入类似的内容时，实际上是在会话对象的实例变量中`session[:foo]`查找该符号。`@data`该数据变量是一个散列。

**编辑：** CGI::Session 类中有一个数据实例变量。如果您转到[文档](http://www.ruby-doc.org/stdlib/libdoc/cgi/rdoc/classes/CGI/Session.html)并查看该`[]=`方法的源代码，您会看到有一个`@data`成员。

因此，要删除`session[:foo]`您所要做的就是`@data`从会话内部访问该变量

```
 session.data[:foo] 
```

现在删除它：

```
 session.data.delete :foo 
```

一旦你这样做了，你的会话变量中就不应该有 foo 了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T07:58:15.520

由于 Session 是 Ruby [CGI::Session](http://www.ruby-doc.org/core/classes/CGI/Session.html)而不是 Hash，调用 delete 实际上会删除 session。删除不带参数 - 这是我在尝试 hyuan 建议时收到“错误数量的参数（1 或 0）”消息。

清除会话条目的普遍接受的方法是 session[:foo] = nil 正如您所建议的那样。这远非理想，但是像 session[:foo].nil 这样的语句？将按预期运行。

我真的希望它表现得像一个普通的哈希......但事实并非如此。

# asp.net-mvc - 击中 /mysite?q=123 时是否可以在 ASP.NET-MVC 中读取查询字符串？

> ID：684459
> 
> 赞同：3
> 
> 时间：2009-03-26T03:52:43.940
> 
> 标签：asp.net-mvc, routing

我有一个外部网站使用广告系列 ID 链接到的网站

> [http://www.example.com?cid=123](http://www.example.com?cid=123)
> 
> 或（带斜线）
> 
> [http://www.example.com/?cid=123](http://www.example.com/?cid=123)

在您错过斜线的情况下，大多数浏览器都会为您添加它。因此，无论哪种情况，无论您输入哪个 URL，我的应用程序被命中都是上面的第二个 URL。QueryString 参数始终可用。

我注意到 ASP.NET MVC 路由（甚至可能没有），当我使用虚拟目录时，我没有得到同样的行为。

例如，如果我有`'http://www.example.com/virtualdirectory?cid=123'`，这将到达我的 ' `default.aspx`' 页面（因为它不匹配任何路线）。但是当我检查它的值时，`Request.QueryString`它是空白的。如果我转到`'http://www.example.com/virtualdirectory?cid=123'`，则该`QueryString`值存在于`Request`对象中。

`Default.aspx.cs`如果我在新创建的 MVC 项目（MVC 1.0 的 RTM 版本 - 2009 年 3 月）中放置断点，那么我将看不到任何查询参数。

我想知道如果用户通过 URL 访问虚拟目录，是否有任何方法可以访问 IIS6 和/或 IIS7 中的这些参数`/virtualdirectory?cid=123`。

可能没有解决方案 - 但我很高兴在将任何合作伙伴链接到虚拟目录之前发现了这一点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:08:24.400

一种可能的解决方法 --- 我不确定是否将其称为解决方案 --- 是在 IIS 7 中制定重写规则，或者使用 IIS 6 的重写器为您重新设置斜线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T05:56:13.050

[http://www.example.com?cid=123](http://www.example.com?cid=123)

这对 MVC 来说很容易。在`HomeController`为您创建的方法中，将方法属性添加到您的`Index()`方法中，称为`String cid`. 像这样：

```
 public ActionResult Index(string cid)
    { 
```

因为它是一个可以忽略的字符串，所以如果您只请求“ [http://www.example.com](http://www.example.com) ”，`cid`则将是`null`. 我刚刚在我的一个站点中对此进行了测试，并且在添加斜杠和不添加斜杠时会传入该值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T18:22:18.070

有几个答案没看懂问题。如果您将应用程序放在虚拟目录中，浏览到“ [http://www.example.com/virtualdirectory?cid=123](http://www.example.com/virtualdirectory?cid=123) ”与“ [http://www.example.com/virtualdirectory/?cid=123](http://www.example.com/virtualdirectory/?cid=123) ”有不同行为。

我刚刚使用 Visual Studio Development Server 进行了尝试，并且能够重现该问题。

这似乎与您是否对 HomeController 的 Index 方法有参数没有任何关系。

在我看来，Web 服务器正在将 /virtualdirectory?cid=123 重写为 /virtualdirectory/default.aspx？在asp.net 得到请求之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T04:13:18.930

当您尝试使用 IIS 服务器变量（特别是 HTTP_URL 变量）访问原始 URL 时，您会得到什么？

[http://msdn.microsoft.com/en-us/library/ms524602.aspx](http://msdn.microsoft.com/en-us/library/ms524602.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T06:21:58.597

您的链接应采用[http://www.example.com/123的形式](http://www.example.com/123)

并且由于您是 Action 方法“Index”在 Home 控制器中，因此默认 Index 方法将处理此问题

```
public ActionResult Index(int id){} 
```

具体来说，您可以像这样使用 AcceptVerbs 属性

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(int id){} 
```

如果您想添加更多查询字符串参数（例如[http://www.example.com/?cid=123&aid=456&bid=789](http://www.example.com/?cid=123&aid=456&bid=789) ），默认路由映射应处理您的请求，然后添加单独的路由映射来处理此 URL 并更改您的操作相应的方法

# c# - 在 SchedulerControl 的约会标签中嵌入超链接或按钮

> ID：684462
> 
> 赞同：1
> 
> 时间：2009-03-26T03:53:09.913
> 
> 标签：c#, winforms, calendar, devexpress

有关我正在使用的原理控制的快速参考：

[什么是约会](http://www.devexpress.com/Help/?document=XtraScheduler/CustomDocument1753.htm&levelup=true "什么是约会")

客户有一个非常具体的确认请求。修改 DevExpress SchedulerControl 上的约会标签，以便用户可以单击或双击一个人的姓名并转到他们的个人资料而不是约会编辑表单。主题字段文本当前设置为保存姓名和电话号码。

问题是 AppointmentLabels 没有为此配备，没有附加到约会标签的容器来插入任何类型的超链接、按钮控件或类似的东西。这样的事情在 ASP.NET 中使用项模板是没有问题的。我已经尝试协商一些我认为会在利用 SchedulerControl 支持的可扩展性时达到相同效果的事情，例如将配置文件链接放在编辑表单中（按钮点击太多！）或自定义就地编辑器或准备好的弹出窗口-向上菜单（对用户来说太混乱了！）；这是客户将接受的唯一 UI 设计。

那么甚至可以在 SchedulerControl 的约会标签中放置一个超链接控件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T20:14:07.770

根据观看次数，我会说没有人关心这个问题。我向 DevExpress 本身发送了同样的问题。这是一个链接，以防有人想知道他们的反应是什么。

[AppointmentLabel 中的超链接](http://www.devexpress.com/Support/Center/p/Q200348.aspx)

# algorithm - 通过交替元素混合两个数组（拉链样式）

> ID：684465
> 
> 赞同：5
> 
> 时间：2009-03-26T03:54:25.557
> 
> 标签：algorithm

什么是混合两个数组（可能大小可能不同）中的元素的优雅算法，以便从每个数组中以交替方式绘制项目，并将剩余部分添加到末尾？

例如

阵列 1 - A、B、C、D、E、F、G

阵列 2 - 1、2、3、4

混合数组 - A、1、B、2、C、3、D、4、E、F、G

我更喜欢 C# 中的解决方案，但我应该能够阅读和转置任何语言（甚至某种形式的伪代码）的解决方案。

不要担心空值检查或任何其他边缘情况，我会处理这些。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T04:07:08.540

你的意思是这样的吗？

```
// naive/boring approach
int i = 0;
int m = 0;
while (i < a1.size() || i < a2.size()) {
    if (i < a1.size())
        mixed[m++] = a1[i];
    if (i < a2.size())
        mixed[m++] = a2[i];
    i++;
} 
```

如果您使用它，您可能希望将数组长度存储在变量中，这样您就不必继续调用 size() 方法（或您使用的任何语言的任何方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T04:24:22.973

[在python 文档](http://docs.python.org/library/itertools.html)中有一个函数可以完全做到这一点，它适用于*n 个*数组

```
from itertools import *

def roundrobin(*iterables):
    "roundrobin('ABC', 'D', 'EF') --> A D E B F C"
    # Recipe credited to George Sakkis
    pending = len(iterables)
    nexts = cycle(iter(it).next for it in iterables)
    while pending:
        try:
            for next in nexts:
                yield next()
        except StopIteration:
            pending -= 1
            nexts = cycle(islice(nexts, pending)) 
```

我想出了另一个，如果它们更快用完，它将在较短的数组中不断重复：

```
from itertools import *    

def repeatrobin(*iterables):
    cycles = cycle(map(cycle, iterables))
    stop = iter(xrange(max(map(len, iterables)) * len(iterables) - 1))
    for c in cycles:
       yield c.next()
       stop.next()

>>> list(repeatrobin(('A', 'B', 'C', 'D', 'E', 'F', 'G'), (1, 2, 3, 4)))
['A', 1, 'B', 2, 'C', 3, 'D', 4, 'E', 1, 'F', 2, 'G', 3]
>>> list(repeatrobin(('A', 'B', 'C', 'D', 'E'), (1, 2, 3), ('*',)))
['A', 1, '*', 'B', 2, '*', 'C', 3, '*', 'D', 1, '*', 'E', 2, '*'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T09:09:06.417

我只是涉足 C#，而且我目前正在学习 IEnumerable，我想我会尝试使用迭代器来解决这个问题。

TwoListMerger 将两个列表作为参数。虽然任一列表中都有一些值要处理，但它会在每个列表之间交替产生返回值。当一个或另一个列表用尽时，迭代器不会交替，有效地完成剩余列表的值。

```
 public static IEnumerable TwoListMerger( List<object> List1, List<object> List2 )
    {
        // Intialise two indices for the two lists
        int ListIndex1 = 0;
        int ListIndex2 = 0;

        // Begin zipper - List1 will provide the first value, then List2, etc.
        bool YieldFromList1 = true;

        // While values in either list remain...
        while ( ( ListIndex1 < List1.Count ) ||
                ( ListIndex2 < List2.Count ) )      
        {
            // If next value comes from List1...
            if ( YieldFromList1 )
            {
                // Yield from List1 if List2 exhausted( otherwise from List2 )
                YieldFromList1 = ( ListIndex2 >= List2.Count );
                yield return List1[ ListIndex1++ ];
            }
            // Next value comes from List2...
            else
            {
                // Yield from List1 if List1 not exhausted (otherwise from List2)
                YieldFromList1 = ( ListIndex1 < List1.Count );
                yield return List2[ ListIndex2++ ];
            }
        }

        // End iterator
        yield break;
    }

// Example usage (List1 and List2 are lists of integers)
List<object> MergedList = new List<object>( );
foreach ( object o in TwoListMerger( List1, List2 ) )
{
    MergedList.Add( o );
}

foreach ( object o in MergedList )
{
    Console.Write( "{0} ", o.ToString() );
}
Console.WriteLine( "}" ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-16T19:11:48.757

**PHP**的函数（仅适用于索引数组）：

```
function array_merge_alternating(&$array1, &$array2)
{
    $result = array();

    $count1 = count($array1);
    $count2 = count($array2);

    $i = 0;
    while (($i < $count1) || ($i < $count2))
    {
        if($i < $count1)
            array_push($result, $array1[$i]);
        if($i < $count2)
            array_push($result, $array2[$i]);

        $i++;
    }

    return $result;
} 
```

感谢瑞恩格雷厄姆！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T04:08:49.893

我看到一个 O(N), N = size of large set, 算法，因为你必须遍历所有条目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T10:28:11.360

我现在真的很喜欢 IEnumerator！

```
 public static IEnumerable TwoListMerger( List<object> List1, List<object> List2 )
    {
        IEnumerator e1 = List1.GetEnumerator( );
        IEnumerator e2 = List2.GetEnumerator( );

        // Declare here (scope of while test)
        bool b1 = true;
        bool b2 = true;

        // While values remain in either list
        while ( b1 || b2 )
        {
            // NB assignments in "if"s return bool

            // If we have a value remaining in List1, yield return it
            if ( b1 && ( b1 = e1.MoveNext( ) ) )
                yield return e1.Current;

            // If we have a value remaining List2, yield return it
            if ( b2 && ( b2 = e2.MoveNext( ) ) )
                yield return e2.Current;            }

        // Done
        yield break;
    } 
```

# validation - 验证逻辑应该在哪里实现？

> ID：684468
> 
> 赞同：8
> 
> 时间：2009-03-26T03:55:44.743
> 
> 标签：validation, oop, standards

在开发我的接口（合同）和它们的具体实现时，包括数据模型和存储库，我发现自己质疑验证逻辑应该去哪里。我的一部分（倾向于胜出）说类本身应该负责它自己的验证（字符串最大长度，日期缓冲区等），但我的另一部分说这应该移出到存储库，因为取决于在持久存储上，这些值*可能*会根据您的存储库实现而改变。

我认为必须在类级别进行一些验证，并且认为它可能应该保持在一起并且即使存储库这样做也不会更改，这就是为什么我倾向于将其保留在类中。

我只想进行 UI 验证，但这还远远不够，因为可以绕过大部分 UI 验证。

好奇人们的想法及其背后的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T20:25:57.050

**验证逻辑应该在哪里实现？**

*到处。*

*   您应该在 UI 级别进行验证，以便用户获得即时、有用的反馈（即，填写网络表单，然后在其旁边显示 javascript，“密码太短”，这样您就不会不必要地访问服务器）
*   您应该验证从用户界面到主软件的任何输入。永远不要相信用户界面，尤其是在大型项目或网站上——它们可能被绕过，或者它们可能由不同的团队开发。
*   您应该验证函数/方法/类的输入。这些具有与项目要求无关的固有限制（除了能够管理所需输入的范围）。这里的想法是鼓励安全的代码重用。上一堂课，你知道如果你超出了它的参数，它就会失败——它会告诉你它是否这样做。
*   还有许多其他需要进行验证的领域（数据库、备份/恢复、辅助通信渠道等）

看起来工作量很大，或者额外的开销，但现实是有充分的理由重新验证链上的所有内容，其中最不重要的是在它们成为问题之前捕获错误。

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T04:00:12.033

验证规则应该在类级别以抽象方式定义，这两者都可以 1) 在类的本地环境中运行 2) 根据需要呈现为其他相关环境的规则，例如 UI 脚本或存储库过程。

这使您可以将逻辑集中在应该在的位置，在类中，并在 UI 和其他任何地方进行辅助验证 - 易于维护，因为它是从类派生的，而不是生活在断开连接的位置的分离逻辑。全能取胜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T04:03:38.000

我已经取得了很大的成功，将我的所有验证都放在了数据将保存在业务层中的位置附近。例如在属性设置器中。这保证了您只在业务层内传递有效数据，并保证 UI 将从业务层接收有效数据。

如果您的代码总是通过您的业务层，这在某种程度上也避免了在数据层中进行大量验证的需要。

我会教条主义的唯一规则是*永远不要*信任 UI 级别的验证，因为这一层是最容易被破坏的（尤其是在 Web 应用程序中）。UI 级别验证是一种甜味剂，只是为了让您的用户体验更友好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T04:18:31.287

两方之间的合同（接口）说，A 和 B 使得双方都有一定的义务。合同是怎么说的？B 应该接收经过验证的数据吗？如果是这种情况，B 不应该实施验证。但是如果 A 是 UI 呢？显然你不想把验证放在那里。通常，最好引入第三方，比如 C。A 与 C 有合同，而 C 又与 B 有合同。B 需要经过验证的数据。A 可能会发送废话。C 执行验证。

如果合同设计得很好，这几乎不会成为问题。修改合同并为每一方承担义务。如果某一方的义务过多，则引入第三方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T04:01:31.627

当然，在 Web 环境中，您放置在客户端进行验证的任何内容都可以被绕过。

通常我会在课堂上进行验证。然后让设置器引发或抛出异常，或者如果您更喜欢使用返回值。我在 .Net 世界中使用异常，因为我可以将一组自定义异常与明确的验证规则消息返回给消费者/客户端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T20:04:31.577

验证应该是对象的一部分。将环境作为对象构造函数的参数的一部分。这样，您可以自定义环境的验证逻辑，但对象不必弄清楚它在哪里运行。

我总是使用 UI 验证，即使它充其量是很弱的安全性。它节省了到服务器的往返行程（确实增加了带宽），并且它允许您对错误消息更加用户友好。但它绝不应该是唯一的验证层。

# wcf - WAS 托管队列

> ID：684471
> 
> 赞同：1
> 
> 时间：2009-03-26T03:59:58.510
> 
> 标签：wcf, was

我读到在托管队列端点时，所有这些名称都需要匹配：

*   托管在 IIS 中：**[http://localhost/MyService.svc](http://localhost/MyService.svc)**
*   服务端点地址：**[http://localhost/private/MyService.svc](http://localhost/private/MyService.svc)**
*   队列：**.\private$\MyService.svc**

所以我想知道，您如何将具有多个端点的服务托管到不同的队列？例如，正在侦听两个队列的服务……（使用两个端点）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-25T12:51:54.673

发现不可能在同一个 svc 中托管多个队列。您需要为 2 个队列提供 2 个 svc

# ubuntu - Ubuntu - SmartFoxServer - 检查程序是否正在运行

> ID：684472
> 
> 赞同：0
> 
> 时间：2009-03-26T04:00:09.897
> 
> 标签：ubuntu, ubuntu-8.10

我想在我的 Ubuntu 8.10 Intrepid 服务器上运行 SmartFox 服务器

默认端口为 9339

我不能 telnet localhost 9339，因为它说连接已重用

UFW 关闭，因为状态显示未加载

所以我想：

1.  检查 SMARTFOX 是否已加载 - 我执行 ./sfs start 并显示已加载
2.  检查为什么我不能通过 telnet 访问本地 9339 端口。

干杯

伊恩

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T04:28:53.463

检查 SmartFoxServer 是否正在运行。请注意，我从未使用过 SmartFox，因此我不知道您要查找的确切名称，但我假设它的某处会包含“smartfox”或“sfs”：

```
ps -ef | egrep -i "[s]martfox|[s]fs" 
```

如果它正在运行，该命令应该输出有关该进程的一些信息。（正则表达式中的方括号确保该命令不会在进程列表中找到它自己）。

现在，检查它是否连接到端口：

```
lsof -i :9339 
```

如果 SmartFox 正在运行，您应该得到一些以 ":9339 (LISTEN)" 结尾的输出

所以，现在我们已经检查了进程是否正在运行或正在侦听。最后要检查的是是否有防火墙阻止它被访问。检查您的防火墙是否启用，如果启用，它的设置是什么。我假设您将使用 Ubuntu 的默认防火墙[`ufw`](https://help.ubuntu.com/community/Uncomplicated_Firewall_ufw)：

```
sudo ufw status 
```

如果启用了防火墙，您应该会看到一些设置；否则，它应该告诉您防火墙未加载。

如果已启用，您可以尝试允许相关端口：

```
sudo ufw allow 9339 
```

**编辑**：哎呀，我没有注意到你说 UFW 已关闭。很抱歉假设您还没有检查过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-29T00:15:07.993

./sfs status 将指示 sfs 是否正在运行。此外，检查日志目录中的 wrapper_MMDDYY.log。

你也可以 ./sfs 控制台。

# c++ - C ++如何将地图复制到矢量

> ID：684475
> 
> 赞同：20
> 
> 时间：2009-03-26T04:00:37.523
> 
> 标签：c++, collections, vector, map

C ++中将一对从地图复制到矢量的最佳方法是什么？我这样做是为了随后对向量进行排序。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-26T04:12:19.417

```
vector<pair<K,V> > v(m.begin(), m.end()); 
```

或者

```
vector<pair<K,V> > v(m.size());
copy(m.begin(), m.end(), v.begin()); 
```

`copy()`在`<algorithm>`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-26T04:31:53.033

这应该做你想要的：

```
#include <iostream>
#include <vector>
#include <map>
#include <algorithm>
#include <iterator>

using namespace std;

bool cmp(const pair<int, int>  &p1, const pair<int, int> &p2)
{
    return p1.second < p2.second;
}

int main()
{
    map<int, int> m;
    for(int i = 0; i < 10; ++i)
        m[i] = i * -i;

    vector<pair<int, int> > v;
    copy(m.begin(), m.end(), back_inserter(v));

    sort(v.begin(), v.end(), cmp);

    for(int i = 0; i < v.size(); ++i)
        cout << v[i].first << " : " << v[i].second << endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-26T04:05:16.017

如果您使用的是 std::map，则它已经按键排序。只需创建一个迭代器并遍历从 begin() 到 end() 的地图，就完成了。

如果您想按地图键以外的其他内容进行排序，则可以使用相同的迭代器，并在迭代地图时将每个元素的副本推送到向量上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T04:02:07.943

A`map`存储一对——一个键和一个值。您要复制哪个部分？或者，您想将两者都复制到两个不同`vector`的 s 吗？

> 我想复制两个。完成后，我需要弄清楚如何按对中的*第二个*值对向量进行排序。

```
template <class V>
struct sort_by_val {
  bool operator()(V const& l, V const& r) {
        return // ...
  }
};

vector<pair<K, V> > outv(map.begin(), map.end());

sort(outv.begin(), outv.end(), sort_by_val()); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T04:12:43.847

假设您要复制键和值：

```
std::map<Foo, Bar> m;

// Map gets populated 
// (...)

// Copying it to a new vector via the constructor
std::vector<std::pair<Foo, Bar>> v(m.begin(), m.end());

// Copying it to an existing vector, erasing the contents
v.assign(m.begin(), m.end());

// Copying it to the back of an existing vector
v.insert(v.end(), m.begin(), m.end()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-26T10:48:33.363

如果您的目的只是按类型而不是键进行排序，您可能需要查看[Boost::Bimap](http://www.boost.org/doc/libs/1_38_0/libs/bimap/doc/html/index.html)。它允许您作为键访问映射对的两个部分。大概您可以像第一个键一样容易地按第二个键的顺序对其进行迭代。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T11:02:28.603

您可以使用不同的地图（或集合）并在插入时使用转换进行排序：

```
#include <map>
#include <algorithm>

typedef std::map<unsigned int, signed char> MapType1;
typedef std::map<MapType1::mapped_type, MapType1::key_type> MapType2;

struct SwapPair
{
  MapType2::value_type operator()(MapType1::value_type const & v)
  {
    return std::make_pair (v.second, v.first);
  }
};

int main ()
{
  MapType1 m1;
  for(int i = 0; i < 10; ++i)
    m1[i] = i * -i;

  MapType2 m2;
  std::transform (m1.begin ()
      , m1.end ()
      , std::inserter (m2, m2.end ())
      , SwapPair ());
} 
```

我忘了补充一点，如果您经常需要这样做，那么使用 boost[多索引](http://www.boost.org/doc/libs/1_38_0/libs/multi_index/doc/index.html)容器可能会更好。

# adam - 部署 ADAM

> ID：684478
> 
> 赞同：0
> 
> 时间：2009-03-26T04:01:51.187
> 
> 标签：adam

我需要有一种方法以几种不同的方式将 ADAM 存储部署到其他环境。

1.  完全备份和恢复：从一个环境中获取所有内容并在另一个环境中恢复所有内容
2.  部分备份和恢复：获取特定 OU（组织单位）的所有内容并在另一个环境中的相同位置恢复。为了进一步扩展，我在根目录下直接有一个名为“MyCompany”的OU，我想备份“MyCompany”中的所有内容并恢复到另一个环境中的相同位置。从服务器 1 上的 O=Root,OU=MyCompany 到服务器 2 上的 O=Root,OU=MyCompany

知道我该怎么做吗？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T10:19:32.083

您可以通过命令行 LDIF 实用程序执行此操作。只需导出然后导入。

# partcover - 让 PartCover.Browser.exe 通过命令行显示覆盖 xml

> ID：684485
> 
> 赞同：0
> 
> 时间：2009-03-26T04:04:09.263
> 
> 标签：partcover

需要帮助解决一个愚蠢的问题。如何让 PartCover.Browser.exe 加载并显示由 PartCover.exe 生成的现有覆盖 xml？

我有一个批处理文件，它运行 PartCover.exe 和我的测试并毫无问题地生成覆盖 xml。然后我尝试使用 PartCover.Browser.exe 加载 xml。

```
"C:\Program Files\PartCover .NET 2\PartCover.Browser.exe" "D:\coverage.xml" 
```

但这似乎不起作用。它甚至支持吗？似乎也找不到任何关于它的文档。我正在使用 PartCover 2.2。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T03:10:11.820

我自己进行了更多挖掘，发现它尚不受支持，但在[功能请求](http://sourceforge.net/tracker/?func=detail&aid=2445978&group_id=175733&atid=874421)列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-04T06:39:02.137

通过查看代码：
[partcover-fork](http://wiki.github.com/geofflane/partcover-fork/)可以做到这一点。

# silverlight - Prism 2 for Silverlight with Unity - 'System.Threading.SynchronizationLockException'

> ID：684487
> 
> 赞同：0
> 
> 时间：2009-03-26T04:05:03.207
> 
> 标签：silverlight, unity-container, prism

我正在将 Unity 与 Silverlight 和 Prism 2 一起使用。在我的笔记本电脑（运行 Vista 32）上，我在 VS.NET 2008 SP1 的输出窗口中看到以下错误 - 我认为这是 Unity 在内部捕获的。

Microsoft.Practices.Unity 中出现了“System.Threading.SynchronizationLockException”类型的第一次机会异常

在具有相同代码库的台式机（运行 Vista 64）上，但我没有看到相同的错误。

我首先发现笔记本电脑有问题，因为应用程序（使用 Prism 2）我发布了一些事件，但没有通知订阅者。台式机与 Prism 事件配合得很好。

知道有什么问题吗？迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T07:49:56.157

接下来是如何关闭它：

*   在 VS IDE 中转到 Debug\Exceptions 菜单（或按 Ctrl+Alt+E）
*   取消选中“公共语言运行时异常”旁边的 Thrwon 复选框

至于为什么会这样，我想你 [已经明白了](http://unity.codeplex.com/Thread/View.aspx?ThreadId=51337):)

# css - 不加载 IE6 特定 CSS 文件的条件注释

> ID：684490
> 
> 赞同：-1
> 
> 时间：2009-03-26T04:06:41.130
> 
> 标签：css, internet-explorer-6

我正在尝试通过在 HTML 文件的 head 标记内使用以下代码来覆盖一些导致 IE6 出现问题的 CSS 选择器：

```
<!--[if IE 6]
<style type="text/css">
    @import ("ie6.css");
</style>
<![endif]--> 
```

此代码在主样式表加载之后出现，并且在条件注释之后没有其他样式表被加载。出于某种原因，使用 IE6 浏览网站不会加载 IE6 CSS 文件。我尝试了多种语法变化，也尝试使用链接标签而不是样式导入，但都无济于事。

我确实有一些 JavaScript 可以动态更改选择器所针对的相同元素的一些样式属性，但我认为这不是问题，因为当我只是替换主 CSS 文件中的相同选择器时，一切都按预期工作。所以看起来 IE6 CSS 文件永远不会加载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T04:27:07.930

实际上，您只省略了开始条件注释标记的右括号 [if IE 6]> <----

```
<!--[if IE 6]>
IE6 stuff here.
<![endif]--> 
```

此外，您可能希望使用 url("ie6.css"); 执行 @import。或只是引号。

```
@import url("ie6.css");
@import "ie6.css"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T04:50:40.853

此外，如果您有多个 IE 设置错误，您需要[删除注册表中的一个键，](http://www.positioniseverything.net/articles/multiIE.html)让 IE6 认为它实际上是 IE6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-08T17:38:42.080

我遇到了同样的问题，IE6 没有在条件注释中加载样式表。我已经确认 CC 语法是正确的，并且还尝试了 Alex 关于删除注册表中的键但没有运气的建议。我还在用于测试 IE6 渲染的机器上重新安装了 Windows。有什么进一步的建议吗？这是链接，如果你有兴趣：

[http://themes.nimblehost.com/customerpreview/ddtheme](http://themes.nimblehost.com/customerpreview/ddtheme)

非常感谢！

***更新*** 我发现问题是因为 IE6 只能解析前 30 个样式表。太糟糕了，我无法将这些样式表压缩在一起......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-25T02:33:00.230

IE中的css浮动问题。

浮动显示一个低于一个的框

# c# - 如何获取复选框中的选定项目

> ID：684497
> 
> 赞同：0
> 
> 时间：2009-03-26T04:09:40.640
> 
> 标签：c#, asp.net, listbox

我在一个页面中有一个数据绑定复选框，其中填充了 OnLoad 页面事件的数据，还有一个按钮。

如果用户单击按钮，我必须重新选择在复选框中选择的复选框并进行一些处理。

但是，当我遍历复选框项目集合时，所有项目的 Selected 属性始终设置为 false。

我如何知道用户选择了哪些项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T04:15:57.300

我认为有两件事可能会出错。

*   一是您每次都在 Page_Load 中对您的复选框进行数据绑定。如果是这种情况，您需要检查 !this.IsPostBack 并且只绑定一次。
*   另一个是您的页面或控件可能具有 EnableViewState="false"，在这种情况下您需要将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T04:18:08.480

听起来你在每次回发中绑定列表，你应该只在用户进入页面时才这样做，当 Page.IsPostBack 为假时：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (IsPostBack)
    {
        // Bind the list...
    }
} 
```

# objective-c - NSView，里面有可变数量的项目

> ID：684506
> 
> 赞同：2
> 
> 时间：2009-03-26T04:16:02.153
> 
> 标签：objective-c, cocoa, nsview

我试图弄清楚如何创建一个视图，根据具体情况，其中显示的项目数量可变。类似于 Finder 或 iTunes 中的网格视图，一个带有某种标题文本的图像。我听说您可以将 NSCollectionView 用于此类事情，但我真的不知道。我有点编程n00b，所以任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:00:29.693

NSCollectionView 是一种方法，它基本上是子视图的集合。IKImageBrowserView 是另一个你应该看看的类，它是一个类似于 iPhoto 的现成图标视图。

最简单的方法是创建您自己的 NSView 子类，并在 drawRect 中：只需一个一个地绘制您的项目，直到您到达视图的边界区域。如果您需要具有选择、重新排序或其他任何功能的全功能 UI 对象，最好查看现有类之一，因为您自己完成所有这些工作需要做很多工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T07:01:25.657

是的，这正是 NSCollectionView 的用途。对于列表视图，NSTableView 或 NSOutlineView。对于列视图，NSBrowser。

有关详细信息，请参阅[应用程序工具包框架参考](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/ObjC_classic/)。

# c# - .net 中的 RSS 解析器

> ID：684507
> 
> 赞同：12
> 
> 时间：2009-03-26T04:16:22.010
> 
> 标签：c#, .net, rss

.net 最好的 RSS 阅读器是什么？最有效和最容易使用的那些我发现真的很复杂

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T04:25:06.467

[http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.aspx) [http://msdn.microsoft.com/en-us/magazine/cc135976.aspx](http://msdn.microsoft.com/en-us/magazine/cc135976.aspx)

.net 有一个类来解析 ATOM 和 RSS 提要。查看链接。你想做什么？你能提供更多信息吗？

或者，您可以从 XML 文件中删除“Feed 版本”，并使用 xmlDocument 类将其解析为普通 XML 文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T04:30:06.940

您是否查看过 .NET 3.5中的[System.ServiceModel.Syndication命名空间？](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.aspx)

Stack Overflow 上还有其他可能有帮助的答案 - 例如：[C# RSS Reader](https://stackoverflow.com/questions/576267/c-rss-reader)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T05:14:07.643

您可能也想看看 Argotic - [http://www.codeplex.com/Argotic](http://www.codeplex.com/Argotic)

当 Syndication 框架在框架中不可用时，我在 .Net 1.1 期间使用了 Argotic，它完成了这项工作。

但是，如果 System.ServiceModel.Syndication 可以满足您的所有需求，我建议您使用它。

# xml - 为什么 JSON 会取代 XML 作为数据格式？

> ID：684515
> 
> 赞同：20
> 
> 时间：2009-03-26T04:21:56.333
> 
> 标签：xml, json

当我第一次看到 XML 时，我认为它基本上是一种树的表示。然后我想：重要的不是它对树木的表现特别*好*，而是它是每个人都同意的。就像ASCII一样。而且一旦建立起来，由于网络效应，它很难被取代。新的替代品必须要好得多（也许好 10 倍）才能取代它。当然，为了国际化，ASCII 已经（大部分）被 Unicode 取代。

根据[谷歌趋势](http://www.google.com/trends?q=xml%2Cjson&ctab=0&geo=all&date=all&sort=1)，XML 领先 x43，但正在下降 - 而 JSON 增长。

[*编辑*] JSON 如何以及为什么会取代 XML 作为数据格式？

1.  哪些任务？
2.  适合哪些程序员/行业？

* * *

*注意：* S 表达式（来自 lisp）是树的另一种表示形式，但尚未获得主流采用。还有很多很多其他的提议，例如 YAML 和 Protocol Buffers（用于二进制格式）。

我可以看到 JSON 在与客户端 AJAX (AJAJ?) 通信的空间中占主导地位，这可能会反向传播到其他系统。

基于 SGML 的 XML 作为*文档格式*优于 JSON 。我对将 XML 作为一种*数据格式*感兴趣。

XML 具有 JSON 所缺乏的成熟生态系统，尤其是定义格式（XML Schema）和转换格式（XSLT）的方法。XML 也有许多其他标准，尤其是针对 Web 服务的标准——但它们的重要性和复杂性可以说是对 XML 不利，并且使人们想要一个新的开始（类似于从 CORBA 开始的“Web 服务”）。

[ 2010 年 3*月编辑*] 与 NoSQL 一样，JSON 是*无模式*的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-31T18:08:39.990

简短回答：是和否（根据下面的评论编辑）

存在根本的差异和权衡。XML 是一种**标记**语言，特别适用于文本文档（xhtml、docbook、各种办公文档）。并且足以完成许多其他任务。问题主要是因为它具有分层模型（而不是 SQL 中的关系，或者 oo 语言中的对象图）。

JSON 是一种**对象表示法**，这意味着它更适合处理面向数据的用例；xml 可以工作的情况，但是在克服对象和层次模型之间的阻抗方面有更多的成本。JSON 并不完美——它仍然是数据，而不是对象（没有身份，不能做完整的图表）——但它比 XML 更自然。因此，更容易构建工具来进行良好的体面和简单的数据绑定。

所以：两者都有足够的空间，我希望两者都能在很长一段时间内使用。并不总是以最佳方式，但两者都可以很好地完成大量用例。

对于它的价值，自从写下我的原始答案以来，我已经看到 JSON 完全消灭了我工作过的公司的面向数据/数据交换用例的 XML。SOAP（等）将开始显着缩小，“普通的旧 JSON”数据交换（尤其是与 RESTish 框架，例如 Java 的 JAX-RS）将接管。

然而，XML 对于文本标记要好得多。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-01-21T23:19:03.557

我的大胆论点是这样的替换毕竟是**不可能的，因为这些数据格式（JSON 和 XML）是****不同**的。

> 简短版本：XML 不等同于 JSON（或类似）格式，因为 XML 节点（标签）支持属性表示法和命名空间。事实证明这很关键。

所以，回答这个问题的最好方法实际上是展示这些格式的不同之处，即完成比较。请原谅我说的很明显，但我只希望这会很有趣甚至有用。如果我们首先同意简单的术语会有所帮助：

1.  *数据格式*实际上是一种形式语言，它控制如何识别数据（在其表示中，即如何根据存储方式从内存中“读取/写入”它）。
2.  *数据结构*是建模（描述）如何组织或链接这些数据的抽象方式。

*因此，实际上这两个概念都针对数据维护（例如 IO）的不同方面。例如，特定数据类型的索引数组是一个（**同质**）结构，它可以作为串行序列（**连续**格式）访问（读/写）。*

Wikipedia 有一篇关于 JSON 的精彩文章，其中包含许多替代方案，例如（已经命名为 lisp 的）S-Expressions、Python 嵌套结构、PHP 数组、YAML 等（请注意，我们不考虑像 .ini 文件这样的字典，因为它们缺少多重嵌套）。所有这些格式都可以看作是某种数据结构的表示——一棵树。我们可以说它们在这个意义上是同构的。每个表示都可以映射到树，这样就不需要进行额外的处理（例如，形式语言的语法不会改变）。还存在反向映射。

好吧，您可能会说这是“一些”理论，但它对实践意味着什么？这意味着如果我们通过以下方式比较 XML 和 JSON：

*   设计目的和动机
*   应用领域 - 使用某种格式解决的一组任务
*   句法复杂性（嗯，简单 - 扩展格式更易读/可写/人性化/等）
*   成熟度（比如格式有多少个版本）
*   等等

我们将发现更多的实际差异。其中最主要的是 XML 是一种标记*语言*（如前所述）。是的，要进行折叠，它能够混合命名空间和属性，从而产生更高阶的“并行”嵌套。

在过去的两年里，我一直忙于将 XML 表示转换为 Python 嵌套结构。我唯一痛苦的结论是，它们非常纯粹兼容。为了表示属性和命名空间，应该在树表示中转义（例如使用前缀）此信息。*所以再一次，XML 绝对不是一棵树；-) 由于“标记”功能，即类型树*，它立即（无需编码、封装或转义）允许表示比树更复杂的结构。具有特殊类型顶点的树（同样通过命名空间和属性）。

还有其他困难和危险，例如解析和映射

```
<body>The <strong>marked up</strong> text</body> 
```

没有预先确定的约定（如何打破“.. text”？）或保留 XML 中遵循的顺序的树。

显然，不等价的事物自然难以相互替代。从这个意义上说，XML 比嵌套结构更复杂。

关于行业的部分问题似乎很好地回答了 XML 将保持服务器端和面向文档的技术的预测。主要是因为其卓越的数据输入能力。此外，还进行了大量研究，仅将 XML 作为一种标记语言。

*请原谅我离话题太远了，讨论 JSON 的流行，但它似乎部分相关；）*

我想强调 JSON（作为*对象表示法*）完全无法通过设计（它是 JavaScript）掌握任何自定义类型信息（它枚举类型而不提供“运行时”引用或上下文），因此无法传递高度耦合的客观化数据。类型信息将始终抽象为 JSON 本机类型。这限制了面向类型开发的能力（类型检查、约束、强制转换、委托等）。但是恕我直言，大多数现代编程语言（我知道）与 JSON 共享这个非常关键的问题，它们缺乏像 XML 那样复杂的嵌套自定义数据类型（对象或函数不是文档）。似乎 XML 本身只是偶然而不是设计这样做的。

因此，在使用 JSON 时，人们采用了与处理流行动态语言中的“鸭子”类型数据类似的策略。所以这是 JSON 的另一个特性 - 允许快速编码，但是当它变得太大（嵌套和复杂）时可能会变得笨重。

**JSON 比 XML 更像是一把瑞士刀，因为它更简单**。

因此，JSON 无助于与 Java 等强类型语言的互操作，但另一方面，它通过鼓励抽象分解来降低耦合度。由于丢失类型信息有时可能是一件好事（减少因素），它允许更简单的架构。ActionScript 更喜欢在 JSON 中进行事实上的通信（但他们也提出了自己的 AMF）。最后，JSON 非常适用于 KISS（例如 RESTful）设计。JSON 以快速和简单的方式购买。但是人们通常倾向于忽略的是，当 KISS 是不可能的并且领域逻辑过于复杂时——设计 DTD 和 XSD、思考格式等等——是应该由某人完成的工作（通常后来当很酷的 KISS 方法失败时，因为缺乏设计能力和经验）。重点是**JSON 是一个很棒的工具，它缺乏应用程序的规模**。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-26T04:32:15.653

我认为 JSON 已经在很大程度上取代了 XML 用于与 Web 服务器进行客户端通信，但这可能就是它的主导地位。正如您所说，XML 提供了适合服务器到服务器交互的优点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T12:20:53.273

替换 XML？哪个 XML？

有**“XML - 数据结构的类型”**和 **“XML - 这种结构的文本表示”**。

因此，虽然 XML 的文本表示可以通过多种方式（JSON、YAML、...）替换，但它不会替换结构属性（有树、具有属性的元素、子元素和文本节点）。

有些格式可以存储和/或处理 XML 结构化数据，而忽略了文本形式。例子：

1.  **DOM** - 以高效转换的形式将对象树存储在内存中。
2.  **[EXI](http://www.w3.org/XML/EXI/)** - 以二进制优化形式存储/传输 XML 数据的未来格式。

因此，XML 的文本表示可以通过将标准 XML 表示法转换为其他符号并再次转换回来来“替换”。（XML 到 JSON，然后返回 XML）

但是，结构特性和基于它们的所有技术，不能被“替换”，因为这只会**打破所有标准**。所以没有人这样做。只有替代的文本表示被读取到内存中的 DOM 或其他格式，实现更高级别的抽象，从而忽略了底层的文本形式。

# java - 在java中处理KeyEvents

> ID：684526
> 
> 赞同：0
> 
> 时间：2009-03-26T04:31:44.643
> 
> 标签：java, keylistener

假设我有一个 GUI，我希望程序在按下空格键时实际运行，但如果再次按下空格键，我希望程序退出。像这样的东西会起作用吗？

```
public class MouseClicker extends JApplet implements KeyListener{
int counter = 0;
MouseClicker m1 = new MouseClicker();

//all of the other methods

public void keyPressed( KeyEvent e) {
int keyCode = e.getKeyCode();
if(keyCode==KeyEvent.VK_SPACE){
 m1.click();
 counter ++;
 if(counter%2==0)
  System.exit(0);
}
//other methods needed for KeyListener
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T04:42:49.030

试试看；-)

说真的，你是什么意思你想编程在按下空格键时运行？除非程序已经在运行，否则您将如何接收`KeyEvent`？

至于您问题的另一半，您拥有的代码通常应该在按下空格键时使 Java 退出。请注意，使用计数器没有意义，因为一旦 Java 退出，计数器的值就会丢失。另请注意，这`JApplet`是“一般”的例外......您通常不能`System.exit`从小程序调用，因为小程序在浏览器的控制下运行，Java 只应该在用户关闭浏览器时退出，而不是每当您的小程序完成时。可能有其他小程序在同一个 JVM 中运行，它们可能还没有完成它们正在做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T04:41:25.523

可能，我认为 AWT 代码是正确的，但其余部分非常神秘（不是我不理解它，但它并没有表达你实际上做得很好，不是吗？）

怎么样：

```
boolean running=false;

...
if(running)
    System.exit(0);
else
    running=true; 
```

反而？

更新：在阅读了您在另一篇文章中的讨论后，您会有一点陌生感。

AWT线程有这个概念。使用 AWT 完成的所有操作都必须在该线程上完成。因此，当按下空格键时，您将在 AWT 线程上获得该事件。您可能不想保留它，因为只要您坚持下去，它就会阻止其他图形更新。

我建议看一下 SwingTimer 设置一个摆动计时器每隔几毫秒通知您一次，该通知将进入 AWT 线程，以便您可以使用它来单击您的按钮，然后退出并等待下一个计时器事件。

当他们再次按空格键时， system.exit() 应该可以正常工作。

# excel - 在 Excel VBA 中插入 CopyOrigin

> ID：684531
> 
> 赞同：21
> 
> 时间：2009-03-26T04:34:34.167
> 
> 标签：excel, vba

谁能告诉我 Insert 的 CopyOrigin 参数是做什么用的？它会接受什么价值观？

我已经包含了 vba 帮助（实际上并没有那么有用）：

> 将一个单元格或一系列单元格插入工作表或宏表中，并将其他单元格移开以腾出空间。
> 
> expression.Insert(Shift, CopyOrigin) 表达式 必需。返回 Range 对象的表达式。
> 
> 移位可选变体。指定移动单元格的方式。可以是以下 XlInsertShiftDirection 常量之一：xlShiftToRight 或 xlShiftDown。如果省略此参数，Microsoft Excel 将根据范围的形状来决定。
> 
> CopyOrigin 可选变体。副本来源。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-26T04:43:25.800

它采用以下任一参数。

```
Const xlFormatFromLeftOrAbove = 0

Member of Excel.XlInsertFormatOrigin 
```

和...

```
Const xlFormatFromRightOrBelow = 1

Member of Excel.XlInsertFormatOrigin 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-26T06:25:33.760

添加到 Lakshmanaraj 的评论中 - 它会根据您插入单元格的位置以及您希望选择的格式来选择格式选项。

假设您有：
第一行有粗体文本，
第二行有斜体。
您选择第二行并执行以下表达式：

```
Selection.Insert CopyOrigin:=xlFormatFromLeftOrAbove 
```

新行插入在第一行和第二行之间，它从“上面的行”或“单元格左侧的单元格”中选择格式规则。

在这种情况下，新插入的单元格将具有粗体文本，而无需您明确设置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-04-18T04:49:05.533

您可以在这里参考：

```
Imports Excel = Microsoft.Office.Interop.Excel
Dim XLApp As New Excel.Application()
Dim xWkBook As Excel.Workbook = XLApp.Workbooks.Open(YourInitialPath)
Dim xSheet As Excel.Worksheet = CType(xWkBook.Sheets(1), Excel.Worksheet)

CurCell = xSheet.Range("G9:G11")
CurCell.Insert(Excel.XlInsertShiftDirection.xlShiftToRight, CurCell.Copy()) 
```

# windows - 处理文件名中的特殊字符时的批量重命名问题

> ID：684535
> 
> 赞同：2
> 
> 时间：2009-03-26T04:35:57.923
> 
> 标签：windows, batch-file, file-rename

我在 c:\files 中有数百个 *.mp3 文件。那里有所有可以想象的文件名，例如

*   milad.mp3（表现良好）
*   嘿 you.mp3（文件名中的空格）
*   systemofadown.mp3（长文件名）
*   howdy(1).mp3（文件名中的括号）

以及最后三个条件的任意组合。我想将文件重命名为 001-test.mp3, 002-mp3, ... 哪个文件取哪个名称都没有关系。已经编写了一个批处理文件来进行重命名。这是我的代码（添加了行号）：

```
01  rem @echo off
02  cls
03  set _number=%1
04  lfnfor on
05
06  :F1TO10
07  IF NOT EXIST *.mp3\. goto end
08  if %_number% gtr 9 goto F10TO100
09  for /f %%a IN ('dir /b *.mp3') do rename %%~na.mp3 00%_number%-test.mp4
10  set /a _number +=1
11  goto F1TO10
12
13  :F10TO100
14  IF NOT EXIST *.mp3\. goto end
15  if %_number% gtr 99 goto F100TO1000
16  for /f %%a IN ('dir /b *.mp3') do rename %%~na.mp3 0%_number%-test.mp4
17  set /a _number +=1
18  goto F10TO100
19
20  :F100TO1000
21  IF NOT EXIST *.mp3\. goto end
22  if %_number% gtr 999 goto end
23  for /f %%a IN ('dir /b *.mp3') do rename %%~na.mp3 %_number%-test.mp4
24  set /a _number +=1
25  goto F100TO1000
26
27  :end
28  for /f %%a IN ('dir /b *.mp4') do rename %%~na.mp4 %%~na.mp3
29  echo Done 
```

此代码适用于表现良好的文件名（即没有空格、没有括号、长度不超过 8 个字符）。但是，如果我什至有一个文件名不正确的文件，脚本就会中断（它会无限循环，直到我用 Ctrl-C 停止它）。

问题显然是文件名问题。如何解决这个问题？有任何想法吗？我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T05:38:36.197

尝试`%%~fsa.mp3`代替`%%~na.mp3`.

如最后给出的[http://www.ss64.org/viewtopic.php?id=93](http://www.ss64.org/viewtopic.php?id=93)

或在长名称中添加引号..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T05:11:31.160

用一个漂亮的简单 ruby​​ 脚本替换它怎么样？

```
Dir["*.mp3"].each_with_index{ |filename,index|
  File.rename filename, "Test-#{index}.mp3"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T05:10:14.503

我真的认为你在这条路上走得很艰难。我经常做这种操作，并使用[BRU](http://www.bulkrenameutility.co.uk/Screenshots.php)做那种事情（有无数其他替代品可用）——它体积小、便携，工作出色。

看不出浪费时间为此编写新的批处理文件的一个很好的理由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T05:19:43.607

根本问题是空格用作单词分隔符，即“foo bar.txt”被认为是两个文件。

您需要以某种方式正确地转义 cmd.exe 的参数，因此您需要检查文档......对您来说不幸的是，世界其他地方已经开始前进，并且更喜欢使用任意数量的替代 shell（见鬼，甚至 bash在 cygwin 上），或者按照 Chris 的建议，改用另一种语言。

Ruby、python 和 perl 是不错的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T05:23:12.147

如果您不介意使用 Windows 脚本文件，则可以非常轻松地执行此功能，并且很可能更易于阅读/更新。

```
var path = "c:\\files";
var io = new ActiveXObject("Scripting.FileSystemObject");

Enumerator.prototype.each = function(f, c) {
  for (var i = 0; !this.atEnd(); this.moveNext()) {
    if (f.call(c, this.item(), i++, this)===false) break;
  }
  return this;
};

function fixedLength(n) {
  return (n < 100 ? "0" : "") + (n < 10 ? "0" : "") + n;
};

var results = [];
new Enumerator(io.GetFolder(path).Files).each(function(file, index) {
  var oldName = file.Name, newName = fixedLength(index+1) + ".mp3";
  if (/\.mp3$/i.test(oldName)) {
    // mp3 extension
    file.Name = newName;
    results.push(newName + " <-- " + oldName);
  }
});

WScript.Echo(results.join("\n")); 
```

只需保存为 renameMP3s.js 或您想要的任何.js 并双击。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T07:35:32.750

Windows Vista 支持批量重命名。只需选择资源管理器窗口中的所有项目，然后按 F2。输入您想要的文件名（在本例中为“test”），然后按 Enter。Bam，每个人都重新命名。

这至少会为您标准化。然后，您可以编写一个脚本，在所有内容周围加上引号，例如“%1”、“%%~na.mp3”等，然后就完成了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T11:23:38.380

您是否尝试在找到的文件名周围加上引号`for`？

`rename "%%~na.mp3"`而不是`rename %%~na.mp3`？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T05:23:37.677

首先感谢通过解答提供帮助的朋友。但没有一个是我要找的。[实际上，我使用Spire](https://stackoverflow.com/users/79851/spire)提供的帮助找到了一个完美的工作脚本，作为对[这个问题](https://stackoverflow.com/questions/684811/how-to-get-around-a-by-design-issue-with-windows-dir)的回答。

这是最终代码：（这次不需要行号）

```
rem @echo off
cls
set _number=%1

:F1TO10
IF NOT EXIST *.mp3\. goto end
if %_number% gtr 9 goto F10TO100
for /f "usebackq delims=" %%x in (`dir /b *.mp3`) do rename %%~nsx.mp3 00%_number%-test.mp9
set /a _number +=1
goto F1TO10

:F10TO100
IF NOT EXIST *.mp3\. goto end
if %_number% gtr 99 goto F100TO1000
for /f "usebackq delims=" %%x in (`dir /b *.mp3`) do rename %%~nsx.mp3 0%_number%-test.mp9
set /a _number +=1
goto F10TO100

:F100TO1000
IF NOT EXIST *.mp3\. goto end
if %_number% gtr 999 goto end
for /f "usebackq delims=" %%x in (`dir /b *.mp3`) do rename %%~nsx.mp3 %_number%-test.mp9
set /a _number +=1
goto F100TO1000

:end
for /f %%a IN ('dir /b *.mp9') do rename %%~na.mp9 %%~na.mp3
echo Done. 
```

# installation - 使用什么来创建快速而轻便的设置文件？

> ID：684538
> 
> 赞同：3
> 
> 时间：2009-03-26T04:37:54.470
> 
> 标签：installation, uninstallation

我正在考虑帮助一个开源游戏项目创建他们的设置文件。该游戏目前的大小约为 300 MB，并打包在一个 zip 文件中，解压后即可直接玩。zip 文件包含适用于 Windows、Mac 和 Linux 的单独可执行文件以及用于所有 3 个平台的压缩数据文件。

我的目标是创建一个轻量级且可能便携的安装包，可以封装数据并为用户提供快速安装/卸载过程。此外，我将使用的工具的抢手（但不是必需的）属性包括开源许可证（最好是 GPLv2）及其自身的成熟度。

所以，问题归结为：

*   什么是好的**Windows**安装创建工具？（创建 .exe、.msi）
*   **OS X**有什么好的安装创建工具？（创建 .dmg，...）
*   什么是好的**Linux**安装创建工具？（创建 .rpm、.deb、.bin、...）

请发表您对使用哪些工具的建议，以及您完成此类任务的任何经验！提前致谢。

PS 我正在使用的游戏是[OpenArena](http://openarena.ws/)，如果有人感兴趣的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T04:48:46.503

对于 Windows，我一直使用 Nullsoft 安装程序 ( [http://nsis.sourceforge.net/Main_Page](http://nsis.sourceforge.net/Main_Page) )。我使用他们拥有的一个模板在大约 5 分钟内创建了我的第一个 setup.exe，从那里添加安装类型、额外页面（许可证等）和其他“功能”非常容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T05:03:39.463

对于 Windows，使用 InnoSetup（与 Inno Setup Form Designer 结合使用，这将使表单创建更容易）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T04:43:05.753

对于 OSX，这看起来很适合制作 DMG：

[http://www.araelium.com/dmgcanvas/](http://www.araelium.com/dmgcanvas/)

问题是它的价格是 15 美元左右。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T05:40:30.827

不在轻量级类别中......但可以帮助您在轻量级之间进行选择.. InstallShield Multiplatform（或其最近的表亲）将为您提供整个语言（Java）的好处来配置和部署您的应用程序

**好处**

*   一个安装代码库
*   功能丰富
*   良好的无头构建

**缺点**

*   成本（3年前约800美元）
*   学习曲线
*   最终包必须包括 JRE (150+ MB)

我没有尝试过上面的一些建议，但是在与神秘的安装问题苦苦挣扎多年之后，这个最终让我忘记了我有一个安装程序......这是迄今为止最重要的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T18:12:08.990

[BitRock InstallBuilder](http://installbuilder.bitrock.com)是一个多平台安装工具，可支持您的所有要求，并且已被 GarageGames、Newtek 或 DAZ3D 等多家游戏/3D 公司使用。我们不是开源的，但我们为像您这样的项目提供免费许可证，只需给我们发送电子邮件 support/at/bitrock.com

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-10T15:02:42.560

在 Linux 上，[YoFrankie](http://www.yofrankie.org/yofrankie-cse-linux-packages-for-testing/)一直在使用[Zero Install](http://0install.net)。那是 LGPL，还支持检查更新。

您可以让用户通过 Web 安装，或者运行[0export](http://0install.net/0export.html)来创建自解压存档。300 MB 相当大... 将其拆分为多个包是否有用（例如，核心引擎的更新不需要用户重新下载所有关卡数据）？零安装可以处理这样的依赖关系。

其他一些选项可以在 gnomefiles的[管理和分发部分找到。](http://www.gnomefiles.org/subcategory.php?sub_cat_id=125)

# licensing - 使 16 位代码在 WinXP 或 Vista 中工作（或者如何找到 Win98 零售许可证？）

> ID：684540
> 
> 赞同：3
> 
> 时间：2009-03-26T04:38:38.777
> 
> 标签：licensing, dos, 16-bit, windows-98

我们有数千个 DOS 程序，这些程序都是在 80 年代使用 16 位 C 编写的，包含超过 1,000,000 行代码。其中许多程序使用直接访问屏幕、驱动器等的库（我们没有这些库的源代码）。每当我们尝试在 Win2000 或更高版本中运行它们时，即使在兼容模式下，我们也会遇到访问冲突和蓝屏。

到目前为止，我们的解决方案是购买 Win98SE 零售盒并在 VMWare 会话中运行 Win98。现在的问题是我们找不到足够的非 OEM 许可证（我们上次购买是在 2006 年，需要另外 20 份左右）。我们公司对许可非常谨慎，因此他们对购买 OEM 副本没有兴趣（因为我们不是系统制造商）。

我们新的 32 位软件要 3 年才能准备好，所以除非有人知道我们在哪里可以买到很多 Win98 零售盒，否则我一直在努力弄清楚如何让 16 位软件直接进入系统运行在 2000/XP 中。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T04:40:19.083

你可以看看他们是否在 DosBox 中运行？

[http://www.dosbox.com/](http://www.dosbox.com/)

[某些版本的 DosBox 实际上支持打印](https://superuser.com/questions/96812/using-a-printer-in-dosbox)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T05:05:22.143

你也可以在 VMWare 内部运行像[freedos这样的系统呢？](http://www.freedos.org/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T05:20:00.580

许多 Microsoft 许可证（包括 OEM 和企业许可证；实际上除了完整的盒装产品 EULA 之外的几乎所有许可证）都允许您“降级”到产品的早期版本。Vista Business 和 XP 可能都降级到 Win98。

> 获得使用 Windows Vista Enterprise 许可的客户获得了 Windows Vista Business 的许可，并且可以降级到 Windows XP Professional、Windows 2000 Professional、Windows NT® 4.0、Windows NT 3.51、Windows 98 或 Windows 95 操作系统。

[一般信息](http://www.microsoft.com/downloads/details.aspx?FamilyID=4F4B3CFD-7F4E-46CB-8117-8275F7683D3F&displaylang=en&displaylang=en)。与 MS 交谈，如果您想要“很多”，我相信他们会很乐意向您出售大量可用于降级的许可证。

我也喜欢 FreeDOS 的想法，如果它有效，它可以为你节省一个数据包。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-29T09:14:50.170

我知道这已经很晚了，但也许有人会找到这个问题并使用这个答案。

OS/2 支持 16 位 Windows，并且仍然以“eComStation”的名义销售。

www.ecomstation.com

eComStation 有可能可以运行那些 16 位应用程序。

它不会在 VMware 中运行，但可以在 Virtual Box 中运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T05:14:44.040

我不知道这是否可行……我相信通过我们的 MSDN 订阅，我们可以访问各种“有趣”的东西，比如 Windows 3.11，是的，甚至是 Windows 98。至少我看到了这样的文件存在，不确定它们是否真的可以下载……也许可以检查一下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T08:24:59.060

也许您可以在 VMware 中使用 wine 让它在 linux 中运行？应该很容易尝试，无需等待采购流程和其他官僚开销。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T04:45:07.607

你试过在 Ebay 上询问 Win98 吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-26T05:27:09.937

是否可以远程运行应用程序？即有一堆在用户之间共享的Win98 电脑？

# .net - 如何在 NUnit 单元测试中记录错误和消息？

> ID：684542
> 
> 赞同：7
> 
> 时间：2009-03-26T04:38:49.697
> 
> 标签：.net, unit-testing, nunit

NUnit 的 GUI 运行器中有几个选项卡： [![替代文字](https://i.stack.imgur.com/InUvN.png)](https://i.stack.imgur.com/InUvN.png)

我了解使用 Console.WriteLine (...) 会在“Console.Out”选项卡中显示消息。我的问题是其他选项卡的用途以及如何向它们记录消息？

[编辑]

我很抱歉，因为我意识到我最初的问题不够清楚。我打算做的是在执行所有单元测试用例后创建一个广泛的结果报告。因此，我正在探索在运行测试时可以记录各种消息的方式。我期待创建一个结果报告，例如：

```
==== TEST1 开始 ====
开始时间：2009-03-26 11:15:13 AM
检查操作 1....OK
检查变量“X”的值：52.56....OK
结束时间：2009-03-26 11:15:19 AM
执行测试所用时间：0.00:00:06.000

==== TEST2 开始 ====
.
.

```

有什么建议我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T04:46:13.360

选项卡的设置位于 NUnit 选项中 - 请参阅[此处的文档](http://www.nunit.org/index.php?p=optionsDialog&r=2.4)。

例如，如果您选中显示控制台错误输出，那么该选项卡将显示您的测试写入 Console.Error 的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T06:13:34.677

样本：

```
 Assert.AreNotEqual(0, result.Count);
     [exec]
     [exec] Tests run: 11, Failures: 1, Not run: 0, Time: 50.422 seconds
     [exec]
     [exec] Failures:
     [exec] 1) Domain.UnitTest.ManagerTest.TestEmbeddedIndex
 :   Expected: not 0
     [exec]   But was:  0
     [exec] 
```

这是你想要的？
断言非常广泛。如果条件之一失败，Nunit 会抛出错误。

```
Assert.AreEqual(),Assert.AreSame(), Assert.Contains(),Assert.Fail(); 
```

此外，Nunit 还有类似的东西

```
[ExpectedException] 
```

深入了解[文档](http://www.nunit.org/index.php?p=docHome&r=2.4.7)以了解更多信息。

* * *

基于**编辑**更新：
如果我是你，我会将此作为构建机制的一部分。在南特我会做这样的事情......</p>

```
<target name="setup" description="Initializes test properties">
    <echo message="Sucessfully initialized tests" />
</target> 
```

恕我直言，每次都显示控制台消息`[Test]`是个坏主意。它会延迟运行 1000 次的测试。测试的速度非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-08T15:47:07.980

这是现有的功能。运行测试并生成 NUnit 报告。您登录测试的任何断言失败都将在报告中可见。

# protection - 防洪系统

> ID：684545
> 
> 赞同：1
> 
> 时间：2009-03-26T04:42:43.337
> 
> 标签：protection

你是否设计了一个像stackoverflow那样的评论泛滥保护系统？你应该寻找什么？并记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T05:03:52.787

这是一个PHP[示例代码](http://faq.wordpress.net/view.php?p=69)，可以在 Wordpress 中使用，用于防止评论泛滥。您没有提到哪种语言，但这会给您一些想法。

# debugging - 尝试在函数中调用 putStrLn 时出错

> ID：684552
> 
> 赞同：6
> 
> 时间：2009-03-26T04:48:12.730
> 
> 标签：debugging, haskell

我正在尝试在 Haskell 函数中调用“打印输出”函数。

（一个简单的调试消息）。

以下是来自编译器（GHC 6.10）的代码和错误消息。

我不太明白为什么它将`putStr`调用和空数组混为一谈。

空数组是该特定情况的返回值（打印出的消息实际上现在只是一个存根）。

知道为什么这不起作用吗？

我的代码：

```
isAFactor :: 整数 -> 整数 -> 布尔
isAFactor xy = x `mod` y == 0

findFactors :: 整数 -> 整数 -> [整数]
findFactors 计数器编号 =
    让商 = div num 2
    在
        如果（计数器>商）
            然后做
                putStrLn ("factorList is : " ++ show quotient) (*** Line 10***)
                []
        else if(isAFactor num 计数器)
            然后 [counter] ++ [quotient] ++ findFactors (counter + 1) num
        别的
            findFactors (counter + 1) 数量

```

来自 ghc 的错误

```
    测试.hs:10:4:
    无法匹配预期类型 `[a] -> [Integer]'
           针对推断类型‘IO()’
    在表达式中：
        putStrLn("factorList is :" ++ show quotient) []
    在表达式中：
        do putStrLn("factorList is :" ++ show quotient) []
    在表达式中：
        如果（计数器>商）那么
            do putStrLn("factorList is :" ++ show quotient) []
        别的
            if (isAFactor num counter) then
                  [counter] ++ [quotient] ++ findFactors (counter + 1) num
            别的
                findFactors (counter + 1) 数量

```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-26T06:30:12.703

重要的是要记住 Haskell 是一种[纯](http://en.wikipedia.org/wiki/Purely_functional)函数式语言。这意味着函数根本不允许有任何副作用，包括将调试消息打印到屏幕上。

然而，有可能打破这种纯度，它在调试中很有用。看看模块[Debug.Trace](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Debug-Trace.html)。在那里你会发现一个函数`trace :: String -> a -> a`。您可以像这样在代码中使用它：

```
import Debug.Trace

isAFactor :: Integer -> Integer -> Bool 
isAFactor x y = x `mod` y == 0

findFactors :: Integer -> Integer -> [Integer]
findFactors counter num = 
    let quotient = div num 2
    in
        if(counter >  quotient)
                then trace ("factorList is: " ++ show quotient) [] 
        else if(isAFactor num counter)
            then [counter] ++ [quotient] ++ findFactors (counter + 1) num
        else
            findFactors (counter + 1) num 
```

正如评论所建议的：

Haskell 也是一种[惰性](http://en.wikipedia.org/wiki/Lazy_evaluation)语言。在实际需要结果之前不会评估表达式。在惰性设置中使用跟踪功能可能会有点混乱，因为当跟踪消息打印到屏幕时（如果打印的话）并不总是很容易理解。

由于 haskell 是一种非常不同的语言，因此最好尝试以同样不同的方式开发程序。尝试推理您的功能，而不是使用`trace`类似的“不纯”结构。学习利用 haskell 强大的类型系统，并在通过类型检查器后使用（例如）[QuickCheck](http://en.wikipedia.org/wiki/QuickCheck)来测试您的函数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-27T17:43:54.543

其他人已经很好地解释了您的代码，所以让我帮助您解码错误消息。

```
Couldn't match expected type `[a] -> [Integer]'
       against inferred type `IO ()'
In the expression:
    putStrLn ("factorList is  : " ++ show quotient) [] 
```

我错过了所有其他“表达中”的部分；它们只是显示越来越多的封闭上下文。

Haskell 中的一切都是一个表达式，因此一切都有一个类型。这包括类似`putStrLn`. 如果你输入`:t putStrLn`GHCi 你会看到它回复：

```
putStrLn :: String -> IO () 
```

这意味着这`putStrLn`是一个接受字符串并返回“IO 操作”的函数，在这种情况下，它是将消息放在屏幕上的操作。在您的代码中，您提供了`putStrLn`一个字符串，因此编译器推断该表达式`putStrLn (*stuff*)`具有 type `IO ()`。那是编译器错误消息的“推断类型”部分。

同时，编译器也在另一个方向进行类型推断，从外到内。除其他外，它注意到 `putStrLn (*stuff*)`表达式似乎被应用于一个空列表，它有类型`[a]`（即某物的列表，我们不知道什么）。此外，整个表达式的结果应该是 type `[Integer]`。因此，表达式`putStrLn (*stuff*)`应该是一个转换`[]`成整数列表的函数，其类型为`[a] -> [Integer]`。那是错误消息的“预期类型”部分。

此时编译器断定无法匹配这两种类型，因此报错。

“无法将预期类型 ' *Foo* ' 与推断类型 ' *Bar* ' 匹配”可能是您在尝试编译 Haskell 时收到的最常见的错误消息，因此值得尝试阅读并理解它。查看推断的类型并尝试找出引用表达式的哪个部分具有该类型。然后尝试通过查看周围的代码来找出编译器期望其他东西的原因。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-26T11:51:04.197

Jonas 的帖子很好地涵盖了您的问题，所以我会给您一个惯用的 findFactors 函数重写。当我第一次学习时，我发现它对我很有帮助。

因此，您希望通过查看从 到 的每个数字来查找给定数字的所有因数，`n`检查它是否是 的因数并建立一个列表。`1``n/2``n`

您的版本（只需进行最少的修改即可使其正常工作）：

```
findFactors :: Integer -> Integer -> [Integer]
findFactors counter num = 
    let quotient = div num 2
    in
        if(counter >  quotient)
            then []
        else if(isAFactor num counter)
            then [counter] ++ findFactors (counter + 1) num
        else
            findFactors (counter + 1) num 
```

一些格式更改使其更具可读性：

```
findFactors :: Integer -> Integer -> [Integer]
findFactors counter num
  | counter > div num 2 = []
  | otherwise = if num `isAFactor` counter 
                then counter:findFactors (counter+1) num
                else findFactors (counter + 1) num 
```

这很好，但在某些方面并不理想。首先，每次`findFactors`调用它都会重新计算商，即`n/2`除法（尽管`ghc -O2`似乎意识到这一点并且只计算一次）。其次，在任何地方都必须处理那个计数器变量有点烦人。第三，它仍然非常必要。

另一种看待问题的方法是从`1`up 中获取整数列表，`n/2`并过滤掉那些是 的因数`n`。这可以直接转化为 Haskell：

```
findFactors :: Integer -> [Integer]
findFactors num = filter (isAFactor num) [1..(num `div` 2)] 
```

令人惊讶的是，它具有与上述版本相同的性能特征。Haskell 不需要`n/2`一次为整个列表分配内存，它可以根据需要生成每个值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T06:50:35.837

*更新说明*

问题是 Haskell 中的 IO 是一元的，以 开头的块`do`是用于将一元表达式（有时称为语句）与一元运算符组合的语法糖。在这种情况下，所讨论的 monad 是 IO monad，可以从对 putStrLn 的调用中推断出来。该块`[]`的第二行中的`do`实际**不是**整个 do 块的值，而是被解释为 putStrLn 的最后一个参数；并不是说它接受第二个参数，而是编译器甚至没有弄清楚这一点，因为它会因您引用的类型错误而提前终止。要使该行成为命令，您必须在其前面放置另一个单子函数，例如，return（即，`return []`）。不过，我并不是说这会帮助您解决问题。

类型错误源于 IO monadic 表达式始终具有 type `IO _`; 在您的情况下，该`do`块也具有这种类型，这显然与`[Integer]`您在签名中指定的类型不兼容。

一般来说，因为 Haskell 是一种带有 monadic IO 的纯函数式语言，一旦你进入 IO monad，就没有办法摆脱它，它具有传染性。即，如果一个函数有一个`do`包含 IO 操作的块，它的签名将必然包含`IO _`类型，所有其他调用该函数的函数的签名也将包含类型，等等。（其他 monad 确实提供“退出”函数，但 IO monad 没有。）

# php - 将 PHP 数组字符串转换为数组

> ID：684553
> 
> 赞同：14
> 
> 时间：2009-03-26T04:48:42.667
> 
> 标签：php, arrays, serialization

我有一个数组：

```
$myArray = array('key1'=>'value1', 'key2'=>'value2'); 
```

我将其保存为变量：

```
$fileContents = var_dump($myArray); 
```

如何将变量转换回用作常规数组？

```
echo $fileContents[0]; //output: value1
echo $fileContents[1]; //output: value2 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-26T04:58:06.653

我想你可能想研究一下[`serialize`](http://us.php.net/serialize)and [`unserialize`](http://us.php.net/manual/en/function.unserialize.php)。

```
$myArray = array('key1'=>'value1', 'key2'=>'value2');
$serialized = serialize($myArray);
$myNewArray = unserialize($serialized);
print_r($myNewArray); // Array ( [key1] => value1 [key2] => value2 ) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-26T05:46:50.843

序列化可能是正确的答案 - 但我更喜欢使用 JSON - 人工编辑数据将是可能的......

```
$myArray = array('key1'=>'value1', 'key2'=>'value2');
$serialized = json_encode($myArray);
$myNewArray = json_decode($serialized, true);
print_r($myNewArray); // Array ( [key1] => value1 [key2] => value2 ) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-26T04:55:45.130

尝试使用[var_export](http://php.net/var_export)生成有效的 PHP 语法，将其写入文件，然后“包含”该文件：

```
$myArray = array('key1'=>'value1', 'key2'=>'value2');
$fileContents = '<?php $myArray = '.var_export($myArray, true).'; ?>';

// ... after writing $fileContents to 'myFile.php'

include 'myFile.php';
echo $myArray['key1']; // Output: value1 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-01T14:42:39.543

```
$array = ['10', "[1,2,3]", "[1,['4','5','6'],3]"];

function flat($array, &$return) {
    if (is_array($array)) {
        array_walk_recursive($array, function($a) use (&$return) { flat($a, $return); });
    } else if (is_string($array) && stripos($array, '[') !== false) {
        $array = explode(',', trim($array, "[]"));
        flat($array, $return);
    } else {
        $return[] = $array;
    }
}

$return = array();

flat($array, $return);

print_r($return); 
```

**输出**

```
数组 ( [0] => 10 [1] => 1 [2] => 2 [3] => 3 [4] => 1 [5] => '4' [6] => '5' [7 ] => '6'] [8] => 3)

```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-07-14T15:56:18.847

评价如何？您还应该使用返回变量为 true 的 var_export 而不是 var_dump。

```
$myArray = array('key1'=>'value1', 'key2'=>'value2');
$fileContents = var_export($myArray, true);
eval("\$fileContentsArr = $fileContents;");
echo $fileContentsArr['key1']; //output: value1
echo $fileContentsArr['key2']; //output: value2 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-12-24T10:24:34.723

## 免责声明

我写了这个函数**（出于乐趣:)**，因为我很懒，我想要一种简单的方法来将字符串中的数组转换为有效的 PHP 数组。**我不确定这段代码**在生产中使用是否 100% 安全，因为`exec`它的姐妹们总是把我吓坏了。

```
$myArray = 'array("key1"=>"value1", "key2"=>"value2")';

function str_array_to_php(string $str_array) {
    // No new line characters and no single quotes are allowed
    $valid_str = str_replace(['\n', '\''], ['', '"'], $str_array);
    exec("php -r '
    if (is_array($valid_str)) {
        function stap(\$arr = $valid_str) {
            foreach(\$arr as \$v) {
                if(is_array(\$v)){
                    stap(\$v);
                }
                else {
                    echo \$v,PHP_EOL;
                }
            }
        }
        stap();
    }'2>&1", $out);
        return $out;
}

print_r(str_array_to_php($myArray)); 
```

**输出：**

```
Array ( [0] => value1 [1] => value2 ) 
```

如您所见，它将转换`$myArray`为有效的 PHP 数组，然后对其进行数字索引，如果它是多维的，则将其转换为单个数组。

> **当心：**
> 
> 1-**永远不要用双引号传递数组，**因为这将允许评估空字节字符 (\0)。

例如：

```
$myArray = "array(\"key1\"=>\"value\n\0 ggg\", \"key2\"=>\"value2\")"
//Output: Warning: exec(): NULL byte detected. Possible attack 
```

> 2-如果`exec`禁用此功能将不起作用（大多数情况下）
> 
> 3-如果`php`未设置命令，此功能将不起作用

*最后一件事，如果您发现任何错误或缺陷，请在评论中告诉我，以便我可以修复和学习。*

希望这可以帮助。

# asp.net - 如何在asp.net中保持获取MAC Adderss（机器ID）？

> ID：684555
> 
> 赞同：0
> 
> 时间：2009-03-26T04:49:03.570
> 
> 标签：asp.net

我想获取客户端计算机的机器 ID。客户将使用他/她的登录 ID 登录我的应用程序。

现在我想**跟踪**哪个用户 ID（登录 ID）与哪个 MAC 地址一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T05:04:54.173

棘手。如果您的客户端直接连接到该站点并且没有通过任何类型的 NAT 或代理，那么您可以对其进行查找，这[是](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/2b125a0e-f67d-476f-b8a0-a21c99279d5b/)一篇关于获取 mac 地址的非常好的文章。

您可能会考虑使用 cookie 来跟踪用户，而不是记录 mac 地址，因为在某些情况下您将无法获得准确的 mac 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T05:11:08.183

如果您只是想跟踪用户重新访问您的网站，您应该使用 cookie 而不是 MAC 地址。

除非您在客户端上安装代理（例如 ActiveX 控件或其他浏览器插件），或者您在同一物理网络上，否则无法从服务器获取 MAC 地址，在这种情况下，您可以调用以转换其 IP地址与他们的mac地址。

# c# - 解决继承问题

> ID：684556
> 
> 赞同：2
> 
> 时间：2009-03-26T04:49:06.410
> 
> 标签：c#, inheritance

我希望用一些额外的功能扩展 C# 中的基类。我有现有的代码，它返回一个基类对象（帐户）的数组，我需要将其转换为扩展版本。

所以我有扩展版本：

```
class AccountXtra : Account
{
    public int Period { get; set; }
    public int Visitors { get; set; }
    public string ContactName { get; set; }
} 
```

一切都很好。

但是当我有一个 Account 实例时，如何创建一个新的 AccountXtra 实例？

我试过了：

```
//This doesn't work
AccountXtra newInstance = (AccountXtra)accountInstance;
//This also doesn't work
AccountXtra newInstance = new AccountXtra();
newInstance = accountInstance; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T04:53:46.290

> 但是当我有一个 Account 实例时，如何创建一个新的 AccountXtra 实例？

这是错误的方式 - 您需要创建 AccountXtra 对象，然后可以在任何地方将其视为 Account 对象。

顺便说一句，如果您不确定要在列表创建代码中创建什么类型的对象，您可能需要阅读有关[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)的信息。

随时用您遇到的具体问题更新您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T05:00:08.317

您不能将基类转换为子类。换句话说，如果对象是“Account”类型，则不能将其转换为“AccountXtra”。但是，如果您有一个“AccountXtra”类，因为它继承自“Account”，您可以将其转换为 Account。

如果您有现有代码的源代码，则需要更改它调用“new Account()”构造函数的位置并将其更改为“new AccountXtra()”。您还应该将“Account”类的实例替换为“AccountXtra”

您可以尝试的另一个想法是在 AccountXtra() 中创建一个构造函数，该构造函数采用“Account”类型的参数并将所有信息复制到新实例中。效率不高，但它会达到你想要的效果。

```
public class AccountXtra : Account
{
    public AccountXtra(Account existingAccount) : base()
    {
        this.accountName = existingAccount.accountName;
        this.accountNumber = existingAccount.accountNumber;
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T05:02:56.877

您现在需要生成*派生*类的新对象，而不是基类。将您的旧电话替换`new Account`为`new AccountXtra`. 或者，您需要一个构造函数来`AccountXtra`获取一个`Account`对象并为其创建一个新的派生类版本：

```
public AccountXtra(Account baseInstance) : this()
{
    this.Field1 = baseInstance.Field1;
    this.Field2 = baseInstance.Field2;
    ...
} 
```

* * *

说明：您不能将基类强制转换为派生类，除非它属于派生类类型。这将起作用：

```
AccountXtra accountXtra = new AccountXtra();
Account xtraAsBase = (Account)accountXtra;
AccountXtra xtraCastBack = (AccountXtra)xtraCastAsBase; 
```

但这不会：

```
Account Base = new Account();
AccountXtra baseAsDerived = (AccountXtra)Base;  //Cast base to derived class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T05:04:16.343

您可能希望将其抽象为具有所有公共属性的公共抽象类：

```
public abstract class Account
{
   //all common members make them abstract
   public abstract int AccountId  { get; set; }
} 
```

然后让您的额外帐户和新的“基本”帐户派生自该通用帐户类？

```
public class AccountBasic : Account
{ 
   public override int AccountId  { get; set; }
   //implement the rest
}

public class AccountExtra : Account
{
   public override int AccountId  { get; set; }
   //your extra details
   public int Period { get; set; }
   public int Visitors { get; set; }
   public string ContactName { get; set; }
} 
```

这让你有一个集合说：列出所有帐户；您可以在其中操作公共属性。同时维护您的专业类的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T05:22:31.430

这是对先前答案的评论，但我想它太长了。

拥有一个带有构造函数的子类，该构造函数接受父类的实例并从中复制数据是一个相当普遍的标准。减少多层次继承和其他类可能导致的麻烦的一种方法是创建一个受保护的函数来完成这项工作，在这种情况下，我们将其称为分配。考虑我们有三个类，`Person`，`Employee`和`Manager`。他们每个人都按此顺序从另一个继承。

```
public class Person
{
    private string name;

    public string Name
    {
        get { return name; }
        set { name = value; }
    }

    protected void Assign(Person otherPerson)
    {
        Name = otherPerson.Name;
    }
} 
```

现在我们定义员工：

```
public class Employee : Person
{
    private int employeeID;

    public Employee() { }
    public Employee(Person newEmployee) : this()
    {
        base.Assign(newEmployee);
    }

    public int EmployeeID
    {
        get { return employeeID; }
        set { employeeID = value; }
    }

    protected new void Assign(Employee otherEmployee)
    {
        base.Assign(otherEmployee);

        EmployeeID = otherEmployee.EmployeeID;
    }
} 
```

然后我们对 Manager 进行相同的示例：

```
public class Manager : Person
{
    private string department;

    public Manager() { }
    public Manager(Employee newManager) : this()
    {
        base.Assign(newManager);
    }

    public string Department
    {
        get { return department; }
        set { department = value; }
    }

    protected new void Assign(Manager otherManager)
    {
        base.Assign(otherManager);

        Department = otherManager.Department;
    }
} 
```

因此，`Assign()`在每个类中声明的方法`new`以便我们可以更改签名，并且可以为继承的类提供浅拷贝功能。

请注意，此模式创建了一个新对象，该对象与旧对象具有相同的数据。旧对象仍然存在，现有引用不会指向您的新对象。实际上不允许更改对象的 TYPE。

# sharepoint - MOSS - 您会选择哪一个 - 120 多个附加列，还是单独的链接列表？

> ID：684557
> 
> 赞同：2
> 
> 时间：2009-03-26T04:50:07.577
> 
> 标签：sharepoint, moss, sharepoint-designer

我有一个设计难题，我可以使用一些反馈，所以我希望我的 SharePoint 专家可以帮助我解决这个问题。

我在单个 MOSS 列表（List1）中管理一组项目，其中“项目名称”列将被视为相关列表的“主键”（至少在我看来）。每个项目将与一组已定义的可交付成果相关联（在每个项目的生命周期中最多有 37 项单独的活动），并且每个可交付成果将跟踪建议在项目期间完成的一项重要活动。

我最初的想法是在一个单独的“查找列表”（List2）中定义 37 个可交付成果，这样每个可交付成果不仅有一个“可交付成果名称”，而且还有：

“URL” - 链接到单独的非 MOSS wiki，用户可以在其中找到有关如何完成可交付成果的更多信息 “描述” - 快速解释可交付成果的含义（无需将用户发送到单独的服务器以获取任何详细信息）“项目阶段” - 帮助我们按照需要完成的顺序过滤和排序可交付成果 “角色” - 确定负责完成可交付成果的主要项目角色

然后我会在另一个列表 (List3) 中创建单独的项目，每个项目都与 (1) 项目和 (2) “可交付成果查找列表”中的“模板”项目相关联，这样我们就可以跟踪额外的这些每个-项目/每个可交付的字段：

“完成日期”——可交付成果完成的日期（如果有）进行中” “注释” - 自由格式的文本，用于记录有关所做工作和原因的更多解释/理由

这种方法的一个主要问题是 Microsoft 的最佳实践指南强烈反对列表中包含 > 2000 项的 MOSS 列表。即使我们从未向每个项目添加更多可交付成果，恐怕我们会在很短的时间内扩展超过 54 个项目（我“允许”的数量 = 2000/37）。创建 List3 的多个实例在理论上是可能的，但让我觉得自动化是一场噩梦（随着我跟踪的项目集的增长）。

我能想到的第一个选择是在项目列表中预定义 37 个附加列，加上启用用户需要的“日期”、“处置”和“注释”字段所需的 (37 x 3) 列跟踪每个可交付成果。再加上必须管理每个 SPD 表单和 Web 部件页面的脆弱配置/设计，我想用这些页面来“美化”所有这些数据输入和数据管理的 UI。

有人向我建议的另一种选择是为每个项目创建子站点，并在项目子站点的单个列表中列出项目的可交付成果。对我来说似乎非常重量级，我认为这只是我最后的手段。

你们中的任何人如何在 MOSS 中实现这一点（不依赖外部数据库，或任何必须安装到服务器的代码）？是否有一些技巧可以使这项工作正常进行，这在通常的 MOSS 列表功能中并不明显？我应该使用 MOSS 的一些隐藏功能吗？我还没有发现 SharePoint Designer 的一些简洁方面？我*必须*相信许多其他人也面临着同样的限制，并且已经找到了*一些*让它发挥作用的方法。我会很感激你们提出的任何想法 - 在此先感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T13:47:13.853

**Microsoft 的最佳实践指出，出于性能原因，视图**中的项目不应超过 2000 个；您可以在一个列表中完美地拥有数百万个项目，但是您应该仔细定义您的视图和索引列的使用，以便一次只返回少于 2000 个项目。

如果您的列表数据不经常更改并且您在服务器上有大量可用内存，则值得查看 PortalSiteMapProvider 来查询列表。有关查询列表的各种方法的更多信息和完整的比较白皮书，请参见[此处](http://blogs.msdn.com/sharepoint/archive/2007/07/25/scaling-large-lists.aspx)。

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T13:26:16.230

根据我的经验，每个容器（列表、文件夹、索引项）超过 2000 个项目并不是世界末日。然而，更糟糕的是，如果您开始使用多个相互链接的列表（通常通过查找）。然后，当您想根据其父项中不属于查找一部分的值过滤子项时，这将变得非常痛苦。如果连接中涉及大量记录，则报告此数据可能会非常慢。

我过去倾向于使用第 3 范式，但这不适用于 SharePoint 列表，因此我会考虑使用相当扁平的结构。但是，如果您有一对多的关系，您将主要希望使用单独的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T20:19:09.187

我建议为每个项目使用子网站或网站集。可以定义一个元项目站点，它可以汇总项目站点的重要信息。然后，项目站点不仅可以存储可交付成果，还可以成为项目协作的焦点。

MS 的建议是，如果您使用超过 50,000 个网站集，性能就会开始受到影响，因此存在一定的灵活性。存储许多文档时，子站点可能很快变得难以管理，因为当内容数据库变得太大时，没有好的方法可以在内容数据库之间移动子站点。

我认为每个项目架构的网站集将为您提供更大的灵活性，并避免复杂查找列表的讨厌问题。然而，它将依赖于对搜索结果 webpart 的一些相当巧妙的使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T21:07:55.973

“列表中包含 > 2000 项的 MOSS 列表”

这不是问题，因为它只是您在视图中显示的内容。我认为MOSS不是一个添加更多领域的复杂项目的开发平台。我应该做一个普通的 SQLserver ASP.NET 应用程序

# ruby-on-rails - 在本地主机（OS X 10.5）上设置通配符域？

> ID：684558
> 
> 赞同：9
> 
> 时间：2009-03-26T04:50:28.357
> 
> 标签：ruby-on-rails, macos, subdomain, localhost, wildcard-subdomain

我开始开发一个基本上充当 WordPress MU 的网站，从某种意义上说，用户可以注册并拥有自己的博客。我将在 Rails 中对此进行编码，但是我希望能够利用通配符子域，因此我可以使用诸如 blog.example.com 之类的格式。我做了一些搜索，但找不到任何好的资源。

由于我使用的是 Rails，因此我不确定将其放在哪里，因为我使用的是 Mongrel，而不是 Apache。我可以通过在我的服务器上远程开发来绕过在我的本地计算机上执行此操作，但是我只想将此作为最后的手段。

如果需要，我可以提供有关我的开发环境的更多详细信息，但这里是基础知识：

*   Mac OS X 豹 10.5.6
*   红宝石 1.8.7
*   导轨 2.3.2

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-26T09:01:44.320

严格来说，在 hosts 文件中不可能做到这一点（至少在 OS X 上）。可以通过将其配置为使用代理自动配置脚本来模拟 Firefox 的行为。

使用以下 javascript 创建一个文件（我使用 ~/.proxy.pac）

```
function FindProxyForURL(url, host) {
  if (shExpMatch(host,"*.<YOUR_DOMAIN>")) {
    //alert("proxy local")
    return "PROXY localhost";
  }
//alert("proxy direct")
return "DIRECT";
} 
```

然后在 Firefox > 首选项 > 高级 > 网络 > 设置... > 自动代理配置 URL：

```
file:///Users/USERNAME/.proxy.pac 
```

从来没有在 Safari 中尝试过，但它也支持 PAC 文件，所以也许它可以工作......

我知道的唯一其他选择是在您的 PC 上设置一个完整的 DNS 服务器......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-03T06:41:18.513

我无法让 Nick 的代码与在 Max OSX 10.5.8 上运行 ruby​​ on rails 的标准 localhost:3000 设置一起使用。因此，我将功能更改为以下内容。这现在允许我去[http://localhost/](http://localhost/)和[http://foo.localhost/](http://foo.localhost/)（也忽略端口）

```
function FindProxyForURL(url, host) {
  if (shExpMatch(host, "*localhost")) {
    return "PROXY localhost:3000";
  }
  return "DIRECT";
} 
```

有趣 - www.localhost 运行得不太好 - firefox 想重定向到 www.localhost.com。需要注意的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-26T18:59:39.007

我遇到了同样的问题，结果证明在 OSX 上运行命名非常容易（它已经预装了！）查看[http://mikeferrier.ca/2011/04/04/setting-up-wildcard-dns-on -localhost-domains-on-osx/](http://mikeferrier.ca/2011/04/04/setting-up-wildcard-dns-on-localhost-domains-on-osx/)获取说明。

# asp.net - silverlight 限制在 100% 浏览器高度

> ID：684571
> 
> 赞同：3
> 
> 时间：2009-03-26T04:58:55.263
> 
> 标签：asp.net, html, css, silverlight-2.0

我在让 Silverlight 控件以与浏览器一样宽但需要的长度的方式出现在页面上时遇到问题。

我似乎无法确定启用此功能的 CSS。我得到的最接近的是使 Silverlight 控件与浏览器一样高，但不高。下面是我的aspx文件：

```
<%@ Page Language="C#" AutoEventWireup="true" %>

<%@ Register Assembly="System.Web.Silverlight" Namespace="System.Web.UI.SilverlightControls"
    TagPrefix="asp" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head runat="server">
    <style type="text/css">
        body
        {
            padding: 0px;
            text-align: center;
            background-color: #22395C;
        }
        #Content
        {
            width: 100%;
            height: 100%;
            text-align: left;
        }
        .Header
        {
            width: 100%;
            height: 25px;
            clear: both;
        }
    </style>
</head>
<body style="height: 100%;">
    <form id="form1" runat="server" style="height: 100%;">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <div class="Header"></div>
    <div id="Content">
        <asp:Silverlight ID="Xaml1" runat="server"
                         Source="~/ClientBin/....xap"
                         MinimumVersion="2.0.31005.0" 
                         InitParameters="VideoId=11"
                         Width="100%" Height="100%" 
                         BackColor="Transparent"
                         PluginBackground="Transparent"
                         Windowless="true"/>
    </div>
    <div class="Header">&nbsp;</div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T15:53:37.793

如果您的 Silverlight 应用程序的高度是动态的，并且您需要在浏览器窗口中动态调整其空间大小，那么您最好的选择可能是 HTML Interop api。您可以创建一个 JavaScript 函数，将高度作为参数并将#Content div 的高度设置为该值。然后，当页面加载时，使用 System.Windows.Browser.HtmlPage.Window.Invoke 静态方法从 Silverlight 调用此 JS 函数。

像下面这样的东西可能会起作用：

...在客户端...

```
function setContentHeight(height) {
    var content = document.getElementById("Content");
    if (content != null) {
        content.style.height = height;
    }
} 
```

...在银光下...

```
 void Page_Loaded(object sender, RoutedEventArgs e)
    {
        HtmlPage.Window.Invoke("setContentHeight", this.Height);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T14:07:18.550

试试这个（它是在测试 silverlight 应用程序时由 blend 自动生成的，并填充浏览器窗口。有一条 aspx 行可用于生成包括 silvelight 应用程序，但我不知道它是否支持填充浏览器窗户）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<!-- saved from url=(0014)about:internet -->
<head>
    <title>OOD</title>

    <style type="text/css">
    html, body {
        height: 100%;
        overflow: auto;
    }
    body {
        padding: 0;
        margin: 0;
    }
    #silverlightControlHost {
        height: 100%;
    }
    </style>

    <script type="text/javascript">
        function onSilverlightError(sender, args) {

            var appSource = "";
            if (sender != null && sender != 0) {
                appSource = sender.getHost().Source;
            } 
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            var errMsg = "Unhandled Error in Silverlight 2 Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError")
            {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError")
            {           
                if (args.lineNumber != 0)
                {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>
</head>

<body>

    <!-- Runtime errors from Silverlight will be displayed here.
    This will contain debugging information and should be removed or hidden when debugging is completed -->
    <div id='errorLocation' style="font-size: small;color: Gray;"></div>

    <div id="silverlightControlHost">
        <object data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%">
            <param name="source" value="OOD.xap"/>
            <param name="onerror" value="onSilverlightError" />
            <param name="background" value="white" />
            <param name="minRuntimeVersion" value="2.0.31005.0" />

            <param name="autoUpgrade" value="true" />
            <a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;">
                <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none"/>
            </a>
        </object>
        <iframe style='visibility:hidden;height:0;width:0;border:0px'></iframe>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:46:02.583

您是否尝试过不为 silverlight 元素指定高度，而是将其包含在具有以下 CSS 属性的 DIV 元素中：

```
#silverlight-container {

    width: 100%;
    Overflow: show;

} 
```

# c# - 你通常让你的主窗体类拥有你的其他对象/线程的实例吗？

> ID：684572
> 
> 赞同：1
> 
> 时间：2009-03-26T05:00:06.540
> 
> 标签：c#

我是 C# 开发的新手。当我创建应用程序时，我通常将它们分解为逻辑类。例如，我有一个“地图显示”程序，它将在表单屏幕上显示地图。

您是否通常拥有“自己的”主表单并实例化您为该表单创建的其他对象和线程？让您的 Forms 类拥有您的各种其他类（地图类、寻路类、其他线程等）是一种不好的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T06:10:19.773

我认为 UI 类应该只专注于 UI，并允许其他 UI“控制器”类拥有辅助项目。如果其他类只是 ui 而不是业务逻辑，那么让表单拥有它们是可以的，但它可能会限制表单的可重用性。

[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)应该是一种指导模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T15:27:26.610

在此链接中查看 MVC 设计模式。它还有一个额外的好处，您可以对表单中使用的一些代码进行单元测试。

[http://www.c-sharpcorner.com/UploadFile/napanchal/MVCDesign12052005035152AM/MVCDesign.aspx](http://www.c-sharpcorner.com/UploadFile/napanchal/MVCDesign12052005035152AM/MVCDesign.aspx)

# javascript - 如何快速清除 JavaScript 对象？

> ID：684575
> 
> 赞同：194
> 
> 时间：2009-03-26T05:01:19.937
> 
> 标签：javascript, performance

使用 JavaScript 数组，我可以通过一次赋值将其重置为空状态：

```
array.length = 0; 
```

这使得数组“出现”为空并准备重用，据我所知，这是一个单一的“操作” - 即恒定时间。

有没有类似的方法来清除 JS 对象？我知道我可以迭代它的字段来删除它们：

```
for (var prop in obj) { if (obj.hasOwnProperty(prop)) { delete obj[prop]; } } 
```

但这具有线性复杂性。

我也可以将对象扔掉并创建一个新对象：

```
obj = {}; 
```

但是新对象的“混杂”创建会导致 IE6 上的垃圾收集出现问题。（[如此处所述](http://ajaxian.com/archives/garbage-collection-in-ie6)）

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-02-26T12:53:56.353

好吧，冒着让事情变得太容易的风险......

```
for (var member in myObject) delete myObject[member]; 
```

...在一行代码中用最少的可怕括号清理对象似乎非常有效。所有成员将被真正删除，而不是作为垃圾。

显然，如果您想删除对象本身，您仍然需要为此执行单独的 delete() 。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2016-12-03T23:33:36.413

# ES5

ES5 解决方案可以是：

```
// for enumerable and non-enumerable properties
Object.getOwnPropertyNames(obj).forEach(function (prop) {
  delete obj[prop];
}); 
```

# ES6

ES6 解决方案可以是：

```
// for enumerable and non-enumerable properties
for (const prop of Object.getOwnPropertyNames(obj)) {
  delete obj[prop];
} 
```

# 表现

无论规格如何，最快的解决方案通常是：

```
// for enumerable and non-enumerable of an object with proto chain
var props = Object.getOwnPropertyNames(obj);
for (var i = 0; i < props.length; i++) {
  delete obj[props[i]];
}

// for enumerable properties of shallow/plain object
for (var key in obj) {
  // this check can be safely omitted in modern JS engines
  // if (obj.hasOwnProperty(key))
    delete obj[key];
} 
```

只对浅层或普通对象执行的原因`for..in`是它遍历原型继承的属性，而不仅仅是可以删除的自身属性。如果不确定一个对象是普通的并且属性是可枚举的，那么`for`with`Object.getOwnPropertyNames`是一个更好的选择。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-03-26T05:16:24.380

我认为，对您的问题的简短回答是否定的（您可以只创建一个新对象）。

1.  在这个例子中，我相信将长度设置为 0 仍然会将所有元素留给垃圾收集。

2.  如果你经常使用它，你可以将它添加到 Object.prototype 中。是的，它的复杂性是线性的，但是以后不进行垃圾收集的任何东西都会是。

3.  这是最好的解决方案。我知道这与您的问题无关 - 但我们需要继续支持 IE6 多久？有许多活动停止使用它。

如果上面有任何不正确的地方，请随时纠正我。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-10-19T20:25:48.947

你可以试试这个。下面的函数将对象属性的所有值设置为未定义。也适用于嵌套对象。

```
var clearObjectValues = (objToClear) => {
    Object.keys(objToClear).forEach((param) => {
        if ( (objToClear[param]).toString() === "[object Object]" ) {
            clearObjectValues(objToClear[param]);
        } else {
            objToClear[param] = undefined;
        }
    })
    return objToClear;
}; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-27T15:52:33.780

因此，回顾一下您的问题：您希望尽可能避免 IE6 GC 错误的麻烦。该错误有两个原因：

1.  垃圾收集每隔这么多*分配*发生一次；因此，您进行的分配越多，运行的 GC 就越频繁；
2.  您“在空中”获得的对象越多，每次垃圾收集运行所花费的时间就越多（因为它会爬过整个对象列表以查看哪些被标记为垃圾）。

导致 1 的解决方案似乎是：减少分配的数量；尽可能少地分配新对象和字符串。

导致 2 的解决方案似乎是：减少“活动”对象的数量；一旦您不再需要它们，请立即删除您的字符串和对象，并在必要时重新创建它们。

在某种程度上，这些解决方案是自相矛盾的：保持内存中的对象数量较少将需要更多的分配和取消分配。相反，不断重用相同的对象可能意味着在内存中保留的对象数量超过了绝对必要的数量。

* * *

现在回答你的问题。是通过创建一个新对象，还是通过删除它的所有属性来重置一个对象：这将取决于你以后想要对它做什么。

您可能希望为其分配新属性：

*   如果您立即这样做，那么我建议直接分配新属性，然后先跳过删除或清除。（不过，请确保*所有*属性都被覆盖或删除！）
*   如果该对象不会立即使用，但会在稍后阶段重新填充，那么我建议将其删除或将其分配为 null，然后再创建一个新对象。

没有一种快速、易于使用的方法可以清除 JScript 对象以供重用，就好像它是一个新对象一样 — 无需创建一个新对象。这意味着您的问题的简短回答是“不”，就像 jthompson 所说的那样。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-05-01T14:47:33.533

最简单的方法：

```
Object.keys(object).forEach(key => {
  delete object[key];
}) 
```

Object.keys 会将对象的每个键作为数组返回，例如：

```
const user = {
  name: 'John Doe',
  age: 25,
};

Object.keys(user) // ['name', 'age'] 
```

`forEach`将为每个元素运行第一个参数中的函数，并且`delete`关键字从对象中删除一个键。因此，代码会为每个键删除对象的一个​​键。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-07-09T21:34:43.857

期待 ES7 中的 Object.observe 和一般的数据绑定，有一些新的想法。考虑：

```
var foo={
   name: "hello"
};

Object.observe(foo, function(){alert('modified');}); // bind to foo

foo={}; // You are no longer bound to foo but to an orphaned version of it
foo.name="there"; // This change will be missed by Object.observe() 
```

因此，在这种情况下，#2 可能是最佳选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-04-07T23:18:49.307

这困扰了我很长时间，所以这是我的版本，因为我不想要一个空对象，我想要一个具有所有属性但重置为某个默认值的对象。有点像类的新实例化。

```
let object1 = {
  a: 'somestring',
  b: 42,
  c: true,
  d:{
    e:1,
    f:2,
    g:true,
    h:{
      i:"hello"
    }
  },
  j: [1,2,3],
  k: ["foo", "bar"],
  l:["foo",1,true],
  m:[{n:10, o:"food", p:true }, {n:11, o:"foog", p:true }],
  q:null,
  r:undefined
};

let boolDefault = false;
let stringDefault = "";
let numberDefault = 0;

console.log(object1);
//document.write("<pre>");
//document.write(JSON.stringify(object1))
//document.write("<hr />");
cleanObject(object1);
console.log(object1);
//document.write(JSON.stringify(object1));
//document.write("</pre>");

function cleanObject(o) {
  for (let [key, value] of Object.entries(o)) {
    let propType = typeof(o[key]);

    //console.log(key, value, propType);

    switch (propType) {
      case "number" :
        o[key] = numberDefault;
        break;

      case "string":
        o[key] = stringDefault;
        break;

      case "boolean":
        o[key] = boolDefault;    
        break;

      case "undefined":
        o[key] = undefined;   
        break;

      default:
        if(value === null) {
            continue;
        }

        cleanObject(o[key]);
        break;
    }
  }
}

// EXPECTED OUTPUT
// Object { a: "somestring", b: 42, c: true, d: Object { e: 1, f: 2, g: true, h: Object { i: "hello" } }, j: Array [1, 2, 3], k: Array ["foo", "bar"], l: Array ["foo", 1, true], m: Array [Object { n: 10, o: "food", p: true }, Object { n: 11, o: "foog", p: true }], q: null, r: undefined }
// Object { a: "", b: 0, c: undefined, d: Object { e: 0, f: 0, g: undefined, h: Object { i: "" } }, j: Array [0, 0, 0], k: Array ["", ""], l: Array ["", 0, undefined], m: Array [Object { n: 0, o: "", p: undefined }, Object { n: 0, o: "", p: undefined }], q: null, r: undefined }
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-03-03T20:10:48.550

您可以删除道具，但不要删除变量。`delete abc;`在 ES5 中是无效的（并使用 use strict 抛出）。

您可以将其分配给 null 以将其设置为删除到 GC（如果您有其他对属性的引用，则不会）

在对象上设置`length`属性不会改变任何东西。（它只是设置属性）

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2021-02-04T00:45:04.160

假设您的对象名称是 BASKET，只需设置 BASKET = "";

# iphone - UiTextField 和 resignFirstResponder

> ID：684579
> 
> 赞同：4
> 
> 时间：2009-03-26T05:03:35.423
> 
> 标签：iphone, uiviewcontroller, first-responder

我有一个奇怪的设置。

我有一个`View`叫**View1**和一个`ViewController`叫**viewController1**

在中`IB`，**View1**是**ViewController1**的子项。

在**View1**中，我使用代码 a 创建`UITextField`并添加为子视图。

在我的`Viewcontroller`，我有`viewController1 : UIViewController <UITextFieldDelegate>`

**现在.. 当View1**中的文本字段在键盘上获得“完成”按钮时，我想辞职键盘，所以我有

```
- (BOOL)textFieldShouldReturn:(UITextField *)TEXTFIELD {
    [TEXTFIELD resignFirstResponder];
} 
```

现在的问题是，如何在 TEXTFIELD（在我的视图控制器中定义）和在我的视图中定义的文本字段之间建立连接？

我必须在 interfaceBuilder 中做些什么吗？

也许我完全不在这儿了……

一些提示非常感谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-26T07:23:50.797

肯德尔是对的。您需要将 viewController1 设置为文本字段的代表。

在您上面的评论中，我认为您误解了 textFieldShouldReturn 方法。UITextField* 作为参数传入此方法，以便委托可以查看要返回的字段，并决定是否允许。在您的情况下，您只有一个文本字段，因此只需辞去第一响应者并返回 YES（我的代码如下）。

尝试在这个 textFieldShouldReturn 函数上放置一个断点。它被调用了吗？

```
- (BOOL)textFieldShouldReturn:(UITextField*)aTextField
{
    [aTextField resignFirstResponder];
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-26T05:11:52.237

将文本字段的委托属性连接到 IB 中的视图控制器（应该是该视图的文件所有者）。还要在视图控制器标头中注意您符合协议。

或者您可以在视图控制器的 viewDidLoad 方法中将 texfield.delegate 属性设置为 self。

# c# - 对 Windows CE / .NET CF 应用程序进行单元测试的最佳方法是什么？

> ID：684583
> 
> 赞同：3
> 
> 时间：2009-03-26T05:04:38.213
> 
> 标签：c#, unit-testing, windows-ce

我想为在 Windows CE .NET Compact Framework 3.5 上运行的应用程序编写单元测试。理想情况下，我想部署它们并在设备上运行它们，而不是模拟进行真正的测试，但如果它也可以在 Visual Studio 中本地运行以提高速度，那就太好了。我主要编写控制台应用程序，并不关心一个好的 gui，但它会很好。

我尝试了 csUnit，但它依赖于不属于 CF 的库，而且我的设备无论如何都没有空间容纳它们。

有没有人找到他们推荐的快速简单的测试框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T05:18:15.327

如果您有 Visual Studio Team System 2008 with Test Edition 或 Team Suite，则可以使用内置的设备单元测试。

[演练：创建和运行智能设备单元测试](http://msdn.microsoft.com/en-us/library/bb384146.aspx)

[使用 Visual Studio 2008 对 .Net Compact Framework 应用程序进行单元测试](http://www.geekzone.co.nz/vs2008/6222)

# asp.net - asp.net 页面中的 AJAX PageRequestManagerParserErrorException 错误

> ID：684585
> 
> 赞同：2
> 
> 时间：2009-03-26T05:05:07.277
> 
> 标签：asp.net, ajax, asp.net-ajax

我在 asp.net 页面按钮单击时不断收到此错误...我该如何解决这个问题？

Microsoft JScript 运行时错误：Sys.WebForms.PageRequestManagerParserErrorException：无法解析从服务器接收到的消息。此错误的常见原因是通过调用 Response.Write()、响应过滤器、HttpModules 或启用了服务器跟踪来修改响应。详细信息：在 ' 附近解析错误

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-18T16:06:55.943

你可能在 updatepanel 中使用 response.write、server.transfer 或类似的东西；避免这种情况。

参考[http://weblogs.asp.net/leftslipper/archive/2007/02/26/sys-webforms-pagerequestmanagerparsererrorexception-what-it-is-and-how-to-avoid-it.aspx](http://weblogs.asp.net/leftslipper/archive/2007/02/26/sys-webforms-pagerequestmanagerparsererrorexception-what-it-is-and-how-to-avoid-it.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T05:15:41.930

使用 Fiddler 等工具捕获服务器响应并进行检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-30T06:05:52.090

> Microsoft JScript 运行时错误：Sys.WebForms.PageRequestManagerParserErrorException：无法解析从服务器接收到的消息。此错误的常见原因是通过调用 Response.Write()、响应过滤器、HttpModules 或启用了服务器跟踪来修改响应。详细信息：在 ' 附近解析错误

解决方案：从更新面板中取出按钮。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-11T11:00:57.187

如果您使用 ScriptManager 运行脚本，则您的 id 脚本不是唯一的。使您的 id 脚本独一无二，这将解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-09T15:36:13.937

使用回发触发器

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-31T02:38:53.073

我正在使用 Telerik ajaxmanager，当我将 ajaxmanager 放在我正在更新的 div 之外的单独 div 中时，我收到了此错误消息。我只是将 ajaxmanager div 移动到另一个 div 中，如下所示：

```
<div id="divguts" runat="server">
   <div style="height:0px;width:0px;position:absolute;top:-100px;">
      <telerik:RadAjaxManager ID="RadAjaxManager1" runat="server">
         <AjaxSettings>
            <telerik:AjaxSetting AjaxControlID="RadAjaxManager1">
               <UpdatedControls>
                  <telerik:AjaxUpdatedControl ControlID="divguts" />
               </UpdatedControls>
            </telerik:AjaxSetting>
            <telerik:AjaxSetting AjaxControlID="divguts">
               <UpdatedControls>
                  <telerik:AjaxUpdatedControl ControlID="divguts" />
               </UpdatedControls>
            </telerik:AjaxSetting>
         </AjaxSettings>
      </telerik:RadAjaxManager>
   </div>
   ...stuff I want to ajaxify + the buttons that trigger the postback
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-03T08:52:55.630

当您给定的控件 ID 无效时，可能会发生这种情况。

请检查为任何 ajax 控件设置的 ControlID。

# php - 用批处理脚本替换 PHP 短打开标签 多年来，我收集了大量的 php 文件，我需要将所有简短的打开标签正确地替换为正确的显式打开标签。 change "<?" into "<?php" 我认为这个正则表达式会正确选择它们： <\?(\s|\n|\t|[^a-zA-Z]) 它处理像这样的情况 问问题 Polypheme 问问题 2009-03-26T05:09:05.707 19524 次 This question shows research effort; it is useful and clear 20 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 多年来，我收集了大量的 php 文件，我需要将所有简短的打开标签正确地替换为正确的显式打开标签。 change "<?" into "<?php" 我认为这个正则表达式会正确选择它们： <\?(\s|\n|\t|[^a-zA-Z]) 它处理像这样的情况 <?// <?/* 但我不确定如何处理整个文件夹树并检测 .php 文件扩展名并应用正则表达式并在文件更改后保存文件。 我觉得如果你掌握了正确的工具，这会非常简单。（在 sed 手册中有一个有趣的技巧：4.3 Example/Rename files to lower case）。 也许我错了。 或者也许这可能是一个单线器？ 将文本字段的委托属性连接到 IB 中的视图控制器（应该是该视图的文件所有者）。还要在视图控制器标头中注意您符合协议。 或者您可以在视图控制器的 viewDidLoad 方法中将 texfield.delegate 属性设置为 self。 phpsedfindawk 4 13 回答 13 This answer is useful 16 不要使用正则表达式来解析形式语言——你总是会遇到你没有预料到的草垛。喜欢： <? $bla = '?> now what? <?'; 使用了解语言结构的处理器更安全。对于 html，那将是一个 xml 处理器；对于 php，内置分词器扩展。它有T_OPEN_TAG解析器标记，它匹配<?php, <?or <%, and T_OPEN_TAG_WITH_ECHO, 匹配<?=or <%=。要替换所有简短 的开放标签，您需要找到所有这些标记并替换T_OPEN_TAG为<?php和。T_OPEN_TAG_WITH_ECHO<?php echo 该实现留给读者作为练习:) 编辑 1：ringmaster 非常好心地提供了一个。 编辑 2：在, ,short_open_tag中关闭的系统上，替换脚本无法识别。要使脚本在此类系统上运行，请通过命令行选项启用：php.ini<?<%<?=short_open_tag php -d short_open_tag=On short_open_tag_replacement_script.php ps token_get_all() 的手册页和谷歌搜索tokenizer、token_get_all和解析器令牌名称的创造性组合可能会有所帮助。 pps 另请参阅正则表达式来解析 define() 内容，可能吗？在这里 于 2009-03-26T06:51:39.767 回答 This answer is useful 14 如果您使用标记器选项，这可能会有所帮助： $content = file_get_contents($file); $tokens = token_get_all($content); $output = ''; foreach($tokens as $token) { if(is_array($token)) { list($index, $code, $line) = $token; switch($index) { case T_OPEN_TAG_WITH_ECHO: $output .= '<?php echo '; break; case T_OPEN_TAG: $output .= '<?php '; break; default: $output .= $code; break; } } else { $output .= $token; } } return $output; 请注意，如果未启用短标签，则标记器将无法正确标记短标签。也就是说，您不能在短标签不起作用的系统上运行此代码。您必须在其他地方运行它才能转换代码。 于 2009-10-30T00:44:03.870 回答 This answer is useful 9 该问题已作为工具中的修复程序得到解决，该php-cs-fixer 工具易于安装并经过测试和维护。 然后修复很容易： $ php-cs-fixer fix <path> --rules=full_opening_tag,no_short_echo_tag --diff --dry-run 只需替换<path>为您要更改的目录或文件的路径即可。给出的命令是首先查看（--dry-run 和--diff参数）。 安装php-cs-fixer就像 $ composer global require friendsofphp/php-cs-fixer 如果您在路径中安装了带有全局作曲家 bin 目录的作曲家（推荐）。 于 2016-11-06T13:36:30.410 回答 This answer is useful 4 这是我编写的一个实用程序，它可以转换包含短开放标签的 PHP 源代码并将它们替换为长标签。 https://github.com/danorton/php_replace_short_tags 即它像这样转换代码： <?= $var1 ?> <? printf("%u changes\n",$changes) ?> 对此 <?php echo $var1 ?> <?php printf("%u changes\n",$changes) ?> --skip-echo-tags选项将导致它跳过<?=标签并仅替换<? 标签。 它是作为 PHP-CLI 脚本编写的，需要将 CLI php.ini文件设置为允许短短打开标签。这是 PHP 5.3.0 及更早版本的默认设置，但可能并不总是如此。（如果未启用该设置，脚本将不会更改任何内容。） 于 2010-10-25T17:31:39.077 回答 This answer is useful 3 我之前的回答我只是用 sed 覆盖了，它不起作用，sed 对于这种事情 IMO 来说太弱了。 因此，我编写了一个 perl 脚本，它应该可以解决问题，希望它非常易于用户编辑。 #!/usr/bin/perl use strict; use warnings; use File::Find::Rule; use Carp; my @files = File::Find::Rule->file()->name('*.php')->in('/tmp/foo/bar'); for my $file (@files) { rename $file, $file . '.orig'; open my $output, '>', $file or Carp::croak("Write Error with $file $! $@ "); open my $input, '<', $file . '.orig' or Carp::croak("Read error with $file.orig $! $@"); while ( my $line = <$input> ) { # Replace <?= with <?php echo $line =~ s/<\?=/<?php echo /g; # Replace <? ashded with <?php ashed $line =~ s/<\?(?!php|xml)/<?php /g; print $output $line; } close $input or Carp::carp(" Close error with $file.orig, $! $@"); close $output or Carp::carp(" Close error with $file , $! $@"); unlink $file . '.orig'; } 但请注意，我没有在任何真实代码上对此进行测试，所以它可能会“砰”的一声。 我建议你修改你的代码（等等，它已经修改了，对吧？.. 对吗？）并在修改后的代码上运行你的测试套件（不要告诉我你没有测试！），因为你可以如果没有完全成熟的 FSM 解析器，就不能确定它会做正确的事。 于 2009-03-26T05:17:14.830 回答 This answer is useful 3 那是我的 RegExp 版本： <\?(?!(php|=|xml))(\s|\t|\n) 于 2010-01-27T03:47:36.187 回答 This answer is useful 1 为此，我将简化您的正则表达式，使其效果更好，但我可能错了，因为我没有在任何真实代码上对其进行测试。 假设您坐在代码的基本目录中，您可以从以下内容开始： find . -iname "*.php" -print0 这将为您提供所有 .php 文件，由 NULL 字符分隔，如果其中任何一个有空格，这是必要的。 find . -iname "*.php" -print0 | xargs -0 -I{} sed -n 's/\(<\?\)\([^a-zA-Z]\)/\1php\2/gp' '{}' 这应该能让你大部分时间到达那里。它将找到所有文件，然后为每个文件运行 sed 以替换代码。但是，如果没有 -i 标签（在下面使用），这实际上不会触及您的文件，它只会将您的代码发送到您的终端。-n 抑制正常输出，正则表达式部分后面的 p 告诉它只打印更改的行。 好的，如果您的结果看起来正确，那么您将迈出一大步，即就地替换文件。在尝试此操作之前，您绝对应该备份所有文件！！！ find . -iname "*.php" -print0 | xargs -0 -I{} sed -i 's/\(<\?\)\([^a-zA-Z]\)/\1php\2/g' '{}' 那应该可以完成工作。不幸的是，我周围没有使用该语法的 PHP 文件，因此您只能从这里弄清楚，但希望现在完成工作的机制更加清晰： 使用“查找”获取所有文件 将该文件列表发送到“xargs”（一次对文件执行一些命令 使用 "sed" 和语法 's/to-change/changed/' 让你的正则表达式魔法发挥作用！ 于 2009-03-26T06:54:43.970 回答 This answer is useful 1 我在将近 2000 个文件上使用了 danorton 脚本，它就像一个魅力 我将他的脚本放入一个名为“fixtags.php”的文件中，并使用以下 linux 1 liner 来解决问题： find . -iname "*.php" | xargs php fixtags.php --overwrite 我遇到的唯一问题是当它遇到一个大小为零字节的文件时。 于 2011-12-11T17:59:45.823 回答 This answer is useful 1 PHP 7.4 正式弃用了短开放标签，而 PHP 8 完全删除了它们，所以随着人们寻找转换遗留代码库的解决方案，关于 SO 的这个问题将会变得有些流行。 正如其他答案已经指出的那样， sed 并不涵盖所有用例。建议的full_opening_tagPHP-CS-Fixer 的行为与 sed 非常相似，也没有涵盖所有用例。此外，我发现的至少一个工具，例如 danorton 的一个答案，目前仅在启用短打开标签时才有效，如果您通过操作系统升级升级到 PHP 8，则无法轻松回滚到 7.x 来运行此类工具。警告 Emptor 非常适用于所有这些方法。 我写了一个工具，它不依赖于短打开标签的存在（即它适用于 PHP 8），不使用正则表达式（即它使用token_get_all()），并且还避免了非短打开标签（例如<?xml）和其他非-tag 场景（例如，包含“标签”的 PHP 字符串）。 https://github.com/cubiclesoft/php-short-open-tag-finder/ 该工具运行的默认模式只是查找引用并显示它们。没有文件被修改。 在-askmode 中，这是目前唯一修改文件的模式，该工具会询问是否可以根据每个文件替换每组引用。也就是说，如果有 500 个文件，总共有 2000 个短打开标签引用，它只会询问 500 次。 即使使用文件级分组，该工具在进行更改时也可能过于谨慎。但我们谈论的是可能在一天内修改系统上的数千个文件。我不认为完全自动化是正确的答案。我只花了几个小时就仔细考虑了我使用该工具管理的所有系统上数千个文件的每一个更改。 token_get_all()我在使用和编写令牌解析器方面有相当多的经验。 于 2019-04-26T15:21:49.727 回答 This answer is useful 0 我以前必须经历过这个，我发现最好分阶段进行。试图捕获所有内容的糟糕脚本可能会弄乱很多文件。 我使用 Coda（或任何其他 Web 编辑器）对非常特定的字符串进行简单的查找和替换。 例如以 " 开头 这可能看起来有点乏味，但我确信在我不知道的地方没有搞砸。回去真的很痛苦。 于 2009-03-26T05:36:02.913 回答 This answer is useful 0 XML/XHTML 页面通常包含以下代码： <?php echo '<?xml version="1.0" encoding="UTF-8" ?>'; ?> 当然，这也不应更改为： <?phpphp echo '<?phpxml version="1.0" encoding="UTF-8" ?>'; ?> 也不： <?php echo '<?phpxml version="1.0" encoding="UTF-8" ?>'; ?> 于 2009-03-26T08:40:57.040 回答 This answer is useful 0 不幸的是，自动化解决方案可能不起作用。我的建议： 1）使用 grep 查找所有短标签： grep -rn "<?[^p]" * 2）遍历每个文件和行并手动修复 我知道如果您有一个庞大的项目，这可能不是一个可行的解决方案，但对我来说效果很好。 于 2013-11-26T20:42:48.077 回答 This answer is useful 0 当我更新 php 版本时，我遇到了同样的问题。 用这个： find . -iname "\*.ph\*" -type f -print0 |xargs -0 sed -i -e 's/<? /<?php /g' -e 's/<?\/\//<?php \/\//g' -e 's/<?\/\*/<?php \/\*/g' -e 's/<?\=/<?php echo/g' 这将转换“<？” 到“<?php”、“<?//”到“<?php //”、“<?/ ”到“<?php / ” 对于任何类型的文件 .php 或 .phtml 学分：https ://coderwall.com/p/cnm0_w/replace-php-short-open-tags-with-full-form-in-all-php-files-using-one-command 于 2020-06-26T13:02:23.540 回答 Related 1 matlab - 更改线条的不透明度 2 javascript - 通过过滤器工具栏应用过滤器后，JQGrid 分页非常慢 0 javascript - 有没有办法在 GeoLocation 提示消息上更改域名？ 1 php - IN 查询的意外结果 2 python - Python，Tkinter，tkFont：标签调整大小 1 javascript - 如何从视频标签错误事件中获取字符串/消息或代码？ 9 eclipse - Eclipse Juno + WTP +EGit 非常慢 1 jquery - 不在视图中时的jQuery粘性页脚 4 php - 使用简单的 HTML Dom 检索关键字元标记内容？ 1 matlab - MATLAB：？？？“double”类型的输入参数的未定义函数或方法 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：684587
> 
> 赞同：20
> 
> 时间：
> 
> 标签：php, sed, find, awk

多年来，我收集了大量的 php 文件，我需要将所有简短的打开标签正确地替换为正确的显式打开标签。

```
change "<?" into "<?php" 
```

我认为这个正则表达式会正确选择它们：

```
<\?(\s|\n|\t|[^a-zA-Z]) 
```

它处理像这样的情况

```
<?//
<?/* 
```

但我不确定如何处理整个文件夹树并检测 .php 文件扩展名并应用正则表达式并在文件更改后保存文件。

我觉得如果你掌握了正确的工具，这会非常简单。（在 sed 手册中有一个有趣的技巧：[4.3 Example/Rename files to lower case](https://www.gnu.org/software/sed/manual/sed.html#Rename-files-to-lower-case)）。

也许我错了。
或者也许这可能是一个单线器？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-26T06:51:39.767

不要使用正则表达式来解析形式语言——你总是会遇到你没有预料到的草垛。喜欢：

```
<?
$bla = '?> now what? <?'; 
```

使用了解语言结构的处理器更安全。对于 html，那将是一个 xml 处理器；对于 php，内置分[词器扩展](http://php.net/tokenizer)。它有[`T_OPEN_TAG`](http://php.net/tokens)解析器标记，它匹配`<?php`, `<?`or `<%`, and [`T_OPEN_TAG_WITH_ECHO`](http://php.net/tokens), 匹配`<?=`or `<%=`。要替换所有简短​​的开放标签，您需要找到所有这些标记并替换`T_OPEN_TAG`为`<?php`和。`T_OPEN_TAG_WITH_ECHO``<?php echo`

该实现留给读者作为练习:)

**编辑 1**：ringmaster 非常好心地[提供了一个](https://stackoverflow.com/questions/684587/batch-script-to-replace-php-short-open-tags-with-php/1647429#1647429)。

**编辑 2**：在, ,[`short_open_tag`](http://php.net/ini.core#ini.short-open-tag)中关闭的系统上，替换脚本无法识别。要使脚本在此类系统上运行，请通过命令行选项启用：`php.ini``<?``<%``<?=``short_open_tag`

```
php -d short_open_tag=On short_open_tag_replacement_script.php 
```

ps [token_get_all() 的手册页和谷歌搜索](http://php.net/token-get-all)*tokenizer*、*token_get_all*和解析器令牌名称的创造性组合可能会有所帮助。

pps 另请参阅[正则表达式来解析 define() 内容，可能吗？](https://stackoverflow.com/questions/645862/regex-to-parse-define-contents-possible/645957)在这里

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-10-30T00:44:03.870

如果您使用标记器选项，这可能会有所帮助：

```
$content = file_get_contents($file);
$tokens = token_get_all($content);
$output = '';

foreach($tokens as $token) {
 if(is_array($token)) {
  list($index, $code, $line) = $token;
  switch($index) {
   case T_OPEN_TAG_WITH_ECHO:
    $output .= '<?php echo ';
    break;
   case T_OPEN_TAG:
    $output .= '<?php ';
    break;
   default:
    $output .= $code;
    break;
  }

 }
 else {
  $output .= $token;
 }
}
return $output; 
```

请注意，如果未启用短标签，则标记器将无法正确标记短标签。也就是说，您不能在短标签不起作用的系统上运行此代码。您必须在其他地方运行它才能转换代码。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-11-06T13:36:30.410

该问题已作为工具中的修复程序得到解决*，*该`php-cs-fixer` 工具易于安装并经过测试和维护。

然后修复很容易：

```
$ php-cs-fixer fix <path> --rules=full_opening_tag,no_short_echo_tag --diff --dry-run 
```

只需替换*`<path>`*为您要更改的目录或文件的路径即可。给出的命令是首先查看（`--dry-run` 和`--diff`参数）。

安装[php-cs-fixer](https://github.com/FriendsOfPHP/PHP-CS-Fixer)就像

```
$ composer global require friendsofphp/php-cs-fixer 
```

如果您在路径中安装了带有全局作曲家 bin 目录的作曲家（推荐）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-25T17:31:39.077

这是我编写的一个实用程序，它可以转换包含短开放标签的 PHP 源代码并将它们替换为长标签。

*   [https://github.com/danorton/php_replace_short_tags](https://github.com/danorton/php_replace_short_tags)

即它像这样转换代码：

```
 <?= $var1 ?>
  <? printf("%u changes\n",$changes) ?> 
```

对此

```
 <?php echo $var1 ?>
  <?php printf("%u changes\n",$changes) ?> 
```

**--skip-echo-tags**选项将导致它跳过**<?=**标签并仅替换**<?** 标签。

它是作为 PHP-CLI 脚本编写的，需要将 CLI **php.ini**文件设置为允许短短打开标签。这是 PHP 5.3.0 及更早版本的默认设置，但可能并不总是如此。（如果未启用该设置，脚本将不会更改任何内容。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-26T05:17:14.830

我之前的回答我只是用 sed 覆盖了，它不起作用，sed 对于这种事情 IMO 来说太弱了。

因此，我编写了一个 perl 脚本，它应该可以解决问题，希望它非常易于用户编辑。

```
#!/usr/bin/perl 

use strict;
use warnings;

use File::Find::Rule;
use Carp;

my @files = File::Find::Rule->file()->name('*.php')->in('/tmp/foo/bar');

for my $file (@files) {
    rename $file, $file . '.orig';
    open my $output, '>', $file or Carp::croak("Write Error with $file $! $@ ");
    open my $input, '<', $file . '.orig'
      or Carp::croak("Read error with $file.orig $! $@");

    while ( my $line = <$input> ) {
        # Replace <?= with <?php echo 
        $line =~ s/<\?=/<?php echo /g;

        # Replace <? ashded  with <?php ashed

        $line =~ s/<\?(?!php|xml)/<?php /g;
        print $output $line;
    }

    close $input  or Carp::carp(" Close error with $file.orig, $! $@");
    close $output or Carp::carp(" Close error with $file  , $! $@");

    unlink $file . '.orig';
} 
```

但请注意，我没有在任何真实代码上对此进行测试，所以它可能会“砰”的一声。

我建议你修改你的代码（等等，它已经修改了，对吧？.. 对吗？）并在修改后的代码上运行你的测试套件（不要告诉我你没有测试！），因为你可以如果没有完全成熟的 FSM 解析器，就不能*确定它会做正确的事。*

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-27T03:47:36.187

那是我的 RegExp 版本：

```
<\?(?!(php|=|xml))(\s|\t|\n) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T06:54:43.970

为此，我将简化您的正则表达式，使其效果更好，但我可能错了，因为我没有在任何真实代码上对其进行测试。

假设您坐在代码的基本目录中，您可以从以下内容开始：

```
find . -iname "*.php" -print0 
```

这将为您提供所有 .php 文件，由 NULL 字符分隔，如果其中任何一个有空格，这是必要的。

```
find . -iname "*.php" -print0 | xargs -0 -I{} sed -n 's/\(<\?\)\([^a-zA-Z]\)/\1php\2/gp' '{}' 
```

这应该能让你大部分时间到达那里。它将找到所有文件，然后为每个文件运行 sed 以替换代码。但是，如果没有 -i 标签（在下面使用），这实际上不会触及您的文件，它只会将您的代码发送到您的终端。-n 抑制正常输出，正则表达式部分后面的 p 告诉它只打印更改的行。

好的，如果您的结果看起来正确，那么您将迈出一大步，即就地替换文件。**在尝试此操作之前，您绝对应该备份所有文件！！！**

```
find . -iname "*.php" -print0 | xargs -0 -I{} sed -i 's/\(<\?\)\([^a-zA-Z]\)/\1php\2/g' '{}' 
```

那应该可以完成工作。不幸的是，我周围没有使用该语法的 PHP 文件，因此您只能从这里弄清楚，但希望现在完成工作的机制更加清晰：

1.  使用“查找”获取所有文件
2.  将该文件列表发送到“xargs”（一次对文件执行一些命令
3.  使用 "sed" 和语法 's/to-change/changed/' 让你的正则表达式魔法发挥作用！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-11T17:59:45.823

我在将近 2000 个文件上使用了 danorton 脚本，它就像一个魅力

我将他的脚本放入一个名为“fixtags.php”的文件中，并使用以下 linux 1 liner 来解决问题：

```
find . -iname "*.php" | xargs php fixtags.php --overwrite 
```

我遇到的唯一问题是当它遇到一个大小为零字节的文件时。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-04-26T15:21:49.727

PHP 7.4 正式弃用了短开放标签，而 PHP 8 完全删除了它们，所以随着人们寻找转换遗留代码库的解决方案，关于 SO 的这个问题将会变得有些流行。

正如其他答案已经指出的那样， sed 并不涵盖所有用例。建议的`full_opening_tag`PHP-CS-Fixer 的行为与 sed 非常相似，也没有涵盖所有用例。此外，我发现的至少一个工具，例如 danorton 的一个答案，目前仅在启用短打开标签时才有效，如果您通过操作系统升级升级到 PHP 8，则无法轻松回滚到 7.x 来运行此类工具。警告 Emptor 非常适用于所有这些方法。

我写了一个工具，它不依赖于短打开标签的存在（即它适用于 PHP 8），不使用正则表达式（即它使用`token_get_all()`），并且还避免了非短打开标签（例如`<?xml`）和其他非-tag 场景（例如，包含“标签”的 PHP 字符串）。

[https://github.com/cubiclesoft/php-short-open-tag-finder/](https://github.com/cubiclesoft/php-short-open-tag-finder/)

该工具运行的默认模式只是查找引用并显示它们。没有文件被修改。

在`-ask`mode 中，这是目前唯一修改文件的模式，该工具会询问是否可以根据每个文件替换每组引用。也就是说，如果有 500 个文件，总共有 2000 个短打开标签引用，它只会询问 500 次。

即使使用文件级分组，该工具在进行更改时也可能过于谨慎。但我们谈论的是可能在一天内修改系统上的数千个文件。我不认为完全自动化是正确的答案。我只花了几个小时就仔细考虑了我使用该工具管理的所有系统上数千个文件的每一个更改。

`token_get_all()`我在使用和编写令牌解析器方面有相当多的经验。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-26T05:36:02.913

我以前必须经历过这个，我发现最好分阶段进行。试图捕获所有内容的糟糕脚本可能会弄乱很多文件。

我使用 Coda（或任何其他 Web 编辑器）对非常特定的字符串进行简单的查找和替换。

例如以 " 开头

这可能看起来有点乏味，但我确信在我不知道的地方没有搞砸。回去真的很痛苦。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-26T08:40:57.040

XML/XHTML 页面通常包含以下代码：

```
<?php echo '<?xml version="1.0" encoding="UTF-8" ?>'; ?> 
```

当然，这也不应更改为：

```
<?phpphp echo '<?phpxml version="1.0" encoding="UTF-8" ?>'; ?> 
```

也不：

```
<?php echo '<?phpxml version="1.0" encoding="UTF-8" ?>'; ?> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-26T20:42:48.077

不幸的是，自动化解决方案可能不起作用。我的建议：

1）使用 grep 查找所有短标签：

```
grep -rn "<?[^p]" * 
```

2）遍历每个文件和行并手动修复

我知道如果您有一个庞大的项目，这可能不是一个可行的解决方案，但对我来说效果很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-26T13:02:23.540

当我更新 php 版本时，我遇到了同样的问题。

用这个：

```
find . -iname "\*.ph\*" -type f -print0 |xargs -0 sed -i -e 's/<? /<?php /g' -e 's/<?\/\//<?php \/\//g' -e 's/<?\/\*/<?php \/\*/g' -e 's/<?\=/<?php echo/g' 
```

这将转换“<？” 到“<?php”、“<?//”到“<?php //”、“<?/ *”到“<?php /* ”

对于任何类型的文件 .php 或 .phtml

学分：[https ://coderwall.com/p/cnm0_w/replace-php-short-open-tags-with-full-form-in-all-php-files-using-one-command](https://coderwall.com/p/cnm0_w/replace-php-short-open-tags-with-full-form-in-all-php-files-using-one-command)

# oracle - 备份和恢复场景

> ID：684590
> 
> 赞同：1
> 
> 时间：2009-03-26T05:10:43.393
> 
> 标签：oracle, backup, recovery

谁能告诉我以下场景的恢复和恢复步骤？

我每天都使用差异备份（累积）。

```
RUN {
  RECOVER COPY OF DATABASE WITH TAG "whole_database_copy";
  BACKUP INCREMENTAL LEVEL 1 CUMULATIVE FOR RECOVER OF COPY WITH TAG  "whole_database_copy" DATABASE;
} 
```

我有所有数据文件、所有备份集、所有重做日志文件的副本以及不同媒体上的所有存档日志。

我的系统崩溃了，我所有的工作数据库文件都丢失了。

如何将我的数据库恢复到另一台服务器？

问候， 萨里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T23:24:28.993

立即联系 Oracle 支持。除非您能承受丢失这些数据的损失，否则不要乱听论坛上的人怎么说，现在不是试验的时候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T23:16:43.770

你试过执行`RECOVER DATABASE`句子吗？

无论如何，关于备份的一个非常重要的句子：**在尝试恢复之前备份不会结束。**

# iphone - 获取像素信息后如何修改像素数据

> ID：684594
> 
> 赞同：0
> 
> 时间：2009-03-26T05:12:40.660
> 
> 标签：iphone

我正在使用函数 glreadpixel() 读取像素信息。任何人都可以建议我在获得它们后如何对它们进行操作。如果有人提供示例代码以供参考，我将非常感激。谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T07:13:17.390

[http://usuarios.lycos.es/hernandp/opengl.html](http://usuarios.lycos.es/hernandp/opengl.html)

这是我多年前写的一个例子。查看像素效果演示，了解如何读取像素并处理它们。它是标准的 OpenGL，不使用任何可编程着色器，所以我认为它可以完美地移植到 iPhone。

希望有帮助。告诉我你的 iPhone 端口；）

# .net - .net 的嵌入式数据库

> ID：684595
> 
> 赞同：18
> 
> 时间：2009-03-26T05:13:44.667
> 
> 标签：.net, sql, embedded-database

我需要一个用于我们的 .net 应用程序之一的嵌入式数据库。

该数据库应该支持 sql（与 Berkley 不同）。

任何人都可以提出任何选择。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-26T05:16:07.267

我能想到的主要选择是：

*   [SQLite](http://www.sqlite.org/)
*   [SQL Server Compact](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)（Linq 支持）
*   [VistaDB](http://www.vistadb.com/)（Linq 支持）
*   [夏普SQL](http://www.codeplex.com/sharphsql)
*   [嵌入式火鸟](http://www.firebirdsql.org/dotnetfirebird/embedded-firebird-documentation.html)
*   [黑鱼 SQL](http://www.codegear.com/products/blackfish)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-07T03:34:05.837

我只是想在这里晚些时候加入有关 VistaDB 的更多信息。

我们的 SQL 语法与 SQL Server 语法非常接近，我们包括 TSQL 和 CLR 存储过程。

与您的应用程序一起运行，您只需为 32 位和 64 位（100% 托管代码）部署 1 个程序集。您不能使用 SQL CE 执行此操作，因为您必须部署不同的非托管程序集。

您可以将 VistaDB 嵌入您的应用程序甚至 ILMERGE 中，更改数据库名称等以对用户完全隐藏引擎（有些人对此非常重视）。

是的，它也可以在 Mono 上运行，因为它是 100% 托管代码。仍然存在一些问题（包括非英特尔 Mono 机器）。

全面披露——我是公司的所有者

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-26T05:30:23.987

查看 SQL Server Compact 版本。它在进程内运行，它是单个二进制文件，将其数据存储在单个文件中，并且支持并发（与许多其他嵌入式 DB 不同，包括 SQLite）。另外，如果您使用的是 Visual Studio，您可能已经拥有它。最后，它可以免费使用和重新分发。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-26T05:31:34.997

SQL Server Compact Edition 是 .NET 紧凑框架的明智选择。我发现[Arcane Code](http://arcanecode.wordpress.com/arcane-lessons/)是学习 SSCE 的一个非常有用的网站。他是 SQL Server 的 MVP，专注于 CE。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T05:37:45.437

我自己真的很喜欢[FirebirdSQL](http://www.firebirdsql.org/)（CMS 也提到过）。它可以嵌入windows dll运行，iirc甚至还有一个混合二进制文件，其中包含为此内置的核心驱动程序。它也适用于 ActiveRecord 和 NHibernate。大多数 .Net 类型很容易映射。

与其他选项相比，一个优势是切换到 RDBMS 模式只需将查询字符串更改为使用服务器，而不是嵌入式版本。如果您希望将来以 Mono 为目标，您也可以在 Linux 中使用它（不幸的是不是在嵌入式模式下）。

# java - Java 语言中使用的散列函数

> ID：684605
> 
> 赞同：4
> 
> 时间：2009-03-26T05:17:45.093
> 
> 标签：java, oop, hash, function

我知道 Java 对 HashMaps 或 HashTables 有很好的内置支持。

有没有人知道 Java 语言采用了什么样的散列函数或技术？

是否可以调整这些功能以使其更适合某个应用程序，从而提高性能并减少访问时间？

非常感谢阅读！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T05:23:08.573

Java 允许您覆盖`hashCode()`类的方法，以使用不仅适合您的应用程序而且适合您的个人类型的散列算法：

```
public class Employee {

   private int id;
   // Default implementation might want to use "name" for as part of hashCode
   private String name; 

   @Override
   public int hashCode() {
     // We know that ID is always unique, so don't use name in calculating 
     // the hash code.
     return id;
   }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T05:19:49.050

发疯。

[http://www.docjar.com/html/api/java/util/HashMap.java.html](http://www.docjar.com/html/api/java/util/HashMap.java.html)

此外，您始终可以将调整大小阈值和初始内存使用量设置为您需要的大小，这将减少地图几乎已满时的放置时间。如果您的地图是线程化的，那么您还可以通过使用 ConcurrentHashmap 获得巨大的性能提升。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T15:08:15.687

请注意，如果您要覆盖 hashCode，您还应该覆盖 equals。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T05:31:56.433

哈希码是按存储在集合中的对象计算的。它是使用标准算法（根据 Effective Java）计算的。有关更多详细信息，请参阅。

您确实可以基于每个对象覆盖 hashcode 方法。实现哈希码方法的最佳方式是通过 HashcodeBuilder（它是 Commons Lang 框架的一部分，请参见此处：

[http://commons.apache.org/lang/](http://commons.apache.org/lang/)

有关哈希码的更多详细信息，请参阅本文：

[http://www.ibm.com/developerworks/java/library/j-jtp05273.html](http://www.ibm.com/developerworks/java/library/j-jtp05273.html)

希望有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T05:32:48.240

> 我知道 Java 对 HashMaps 或 HashTables 有很好的内置支持。

完全缺乏哈希映射文字的语法，我不会真的这么说......

无论如何，正如其他人指出的那样，由各个类来指定它们的 hashCode() 应该是什么（默认是内存地址的哈希）。如果您确实实现了自己的，请确保遵循 hashCode() 方法的约定（特别是它需要与 equals() 保持一致），否则该类将不适用于 HashMap 中的键。

[也可以直接看j ava.util.HashMap](http://www.docjar.com/html/api/java/util/HashMap.java.html)和朋友的源码，看看是怎么实现的。例如 HashMap 使用一个桶数组，桶可以使用链表溢出。

为了进一步阅读，您可能需要查看 ConcurrentHashMap，它可以被多个线程同时安全地访问，以及 TreeMap，它提供了一种为可以排序的键（不一定是散列）构建映射的方法.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T06:26:17.457

一般来说，不必过多担心标准 JDK 类的散列函数。即使您可以覆盖 String（您不能），实际上，它的哈希函数实际上总是“足够好”。可能有一些例外——例如，某些类（如 BigInteger 和集合）每次都通过循环遍历它们包含的每个元素来计算它们的哈希码，这在某些情况下是非常虚假的——但是你多久键入一次这些实例上课？

为了为您自己的类设计哈希码，您尝试做的事情是将哈希码“随机”分布在整数范围内。为此，您通常希望“混合”对象中连续字段的位（您可能对我网站上的一篇文章感兴趣，该文章以图形方式说明[了字符串哈希码如何混合位](http://www.javamex.com/tutorials/collections/hash_function_technical_2.shtml)）。将当前散列乘以奇数（通常是素数）然后添加下一个元素的散列通常作为第一次尝试足够好。（但是，这种方法可能会出现问题，例如，当组合的数字/哈希码的低位倾向于为零时——通常没有绝对保证在所有情况下都能正常工作的实用哈希函数。）

然后，您可以考虑测试您的哈希码。生成一系列随机对象（甚至使用一些真实对象），计算它们的哈希码，然后从底部（例如 16 位哈希码），然后看看你得到了多少冲突。检查您获得的冲突数量是否与[您希望偶然获得的哈希冲突](http://www.javamex.com/tutorials/collections/hash_codes_advanced_statistics.shtml)数量大致匹配。例如，如果您对哈希码的底部 16 位（& 0xffff）进行与运算，那么在 1000 个随机对象之后，您预计会发生大约 8 次冲突。2000 年之后，您预计会发生大约 30 次碰撞。

就性能而言，在某种程度上，我认为现在获得一个分布良好的哈希码通常比牺牲哈希质量来提高哈希计算速度更有益。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T15:24:41.360

您应该遵守一个“hashCode/equals contract”，它说根据 equals() 方法彼此相等的对象必须提供相同的 hashCode() 值。然而，并不要求具有相同 hashCode 的所有对象也相等。你应该看看[http://java.sun.com/javase/6/docs/api/java/lang/Object.html#hashCode()](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#hashCode())它告诉你细节。

一开始可能有点难以理解所涉及的对称性，但绝对值得理解它，除非您在将对象放入 HashMap 和不遵守该规则的朋友时急于在应用程序中出现奇怪的行为合同。

我还建议获取 Effective Java 的副本并阅读有关 hashCode/equals 的章节以完全理解它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-26T11:49:26.010

我的建议是，如果您知道需要快速散列，请使用另一种实现：尝试使用 fast util ( [http://fastutil.dsi.unimi.it/](http://fastutil.dsi.unimi.it/) ) 或 trove ( [http://trove4j.sourceforge.net/](http://trove4j.sourceforge.net/) )。它们显然更快，但特定于类型。

# asp-classic - 如何使用 PCI 标准在 ASP 网页中显示我的 SSN id

> ID：684610
> 
> 赞同：-3
> 
> 时间：2009-03-26T05:19:55.463
> 
> 标签：asp-classic, xss, pci-dss

在我的 ASP 网页中，我正在显示 SSN 号码

" 名称 ="txtSSNID" 大小 ="20">

Fortify Developer 工具将此检测为错误。我该如何解决这个问题。

我需要显示 SSN 编号，但问题是在 Fortify 开发人员工具中测试安全违规时不应捕获它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T05:25:01.910

我不确定你到底想要什么？但是像信用卡号码一样，你不能只显示几个“X”和最后几个字母吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-22T23:12:36.137

迈克尔，

有几种方法可以处理这个问题：

1.  与您的产品经理交谈并安排 PCI 合规性例外，或获得他的批准以将输出掩码应用于此数据。就像将 123-11-1234 替换为 12X-XX-XXXX 进行显示一样。

2.  如果您确实需要显示该值，请使用 SSL 并在显示 SSN 之前再次请求用户的登录凭据。

3.  如果您确实需要让 Fortify 停止显示错误，您可以单击 Fortify Audit Workbench 中的红色 X 来抑制发现。为此，您需要获得安全审计员的批准。

# c# - 序列化和反序列化未知的继承类型

> ID：684622
> 
> 赞同：1
> 
> 时间：2009-03-26T05:26:34.697
> 
> 标签：c#, protocol-buffers, protobuf-net

我开始考虑使用 proto-buf .Net 来满足媒体浏览器的序列化需求。

在新系统中，我们有一个可以用插件扩展的实体框架。

所以，比如我们在核心库中定义一个Media类，然后插件就可以定义Song等子类。

似乎 proto-buf .Net 需要了解我们核心定义的基类的所有子类型。

所以我应该用

```
[ProtoInclude(2, typeof(Song))] 
```

但是……那时我对尚不存在的 Song 类一无所知。

是不是又回到了绘图板上？我是否正在尝试做一些图书馆不适合做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:21:20.597

（来自作者）

在当前版本中，它被固定为父级已知的类型。然而，这是一个已知的限制，因此有一个计划来抽象元模型，以便它可以在运行时单独提供 - 与您提供此类信息的方式大致相当`XmlSerializer`（它仍然需要一种提供标签的方法（上面的“2”）每种类型）。

我已经开始了这项工作，但我预计需要几周时间才能使其完全正常工作（重构还将与其他一些更改相关联[以帮助紧凑框架](http://marcgravell.blogspot.com/2009/03/compact-framework-woes-revisted.html)）。

所以由你决定......如果你能等几个星期，我希望有一些工作。

请注意，您仍然需要某种方式为所有不同的子类型（配置等）生成（唯一的、可重复的）标签。

# c++ - 如何将文件句柄传递给函数以进行输出流式处理

> ID：684623
> 
> 赞同：0
> 
> 时间：2009-03-26T05:27:08.550
> 
> 标签：c++, templates, filehandle

我有以下打印到 cout 的模板函数：

```
 template <typename T> void  prn_vec(const std::vector < T >&arg, string sep="") 
    {
        for (unsigned n = 0; n < arg.size(); n++) { 
            cout << arg[n] << sep;    
        }
        return;
    } 

    // Usage:
    //prn_vec<int>(myVec,"\t");

    // I tried this but it fails:
    /*
      template <typename T> void  prn_vec_os(const std::vector < T >&arg, 
      string    sep="",ofstream fn)
      {
        for (unsigned n = 0; n < arg.size(); n++) { 
            fn << arg[n] << sep;      
        }
        return;
      }
   */ 
```

如何修改它，使其也将文件句柄作为输入并打印到文件句柄引用的该文件？

这样我们就可以执行以下操作：

```
#include <fstream>
#include <vector>
#include <iostream>
int main () {

  vector <int> MyVec;
  MyVec.push_back(123);
  MyVec.push_back(10);

  ofstream myfile;
  myfile.open ("example.txt");
  myfile << "Writing this to a file.\n";

  // prn_vec(MyVec,myfile,"\t");

  myfile.close();
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T05:35:31.807

```
template <typename T> 
ostream& prn_vec(ostream& o, const std::vector < T >&arg, string sep="") 
{
    for (unsigned n = 0; n < arg.size(); n++) { 
        o << arg[n] << sep;    
    }
    return o;
} 

int main () {

  vector <int> MyVec;
  // ...
  ofstream myfile;

  // ...
  prn_vec(myfile, MyVec, "\t");

  myfile.close();
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T05:38:04.000

通过引用传递 ofstream：

```
template <typename T> void  prn_vec_os(
    const std::vector < T >&arg,
    string sep,
    ofstream& fn) 
```

此外，删除 sep 的默认值，或重新排序参数，因为您不能在参数列表的中间有一个默认参数，并且后面有非默认值。

编辑：正如评论中所建议并在 dirkgently 的回答中实现的那样，您很可能希望使用 ostream 而不是 ofstream，以便更通用。

# c++ - 调用 RPC 调用时“已在监听”

> ID：684625
> 
> 赞同：1
> 
> 时间：2009-03-26T05:28:34.397
> 
> 标签：c++, visual-studio, visual-c++, interop, rpc

我使用 Microsoft RPC 进行进程间通信。我有一个接口，其中包含一组接受字节管道作为“in”参数（IDL 描述）的方法：

```
[
    uuid(ActualGuidHere), 
    version(1.0), 
    pointer_default(unique)
]

interface IMyInterface
{
    //other irrelevant methods here
    error_status_t rpcDoAction( [in] pipe byte params );
    //more irrelevant methods here
} 
```

每隔一段时间，当我通过 MIDL 生成并委托给 NdrClientCall2() 的客户端存根在客户端调用此类方法时，它不会到达服务器端，但 NdrClientCall2() 返回 RPC_S_ALREADY_LISTENING（“服务器已经在监听") 这真的很令人困惑。

我在传输过程中添加了用于推/拉操作的函数的日志记录——它们不会被任何以这种方式失败的调用调用。这意味着甚至没有开始传输。

在调用没有管道作为参数的方法时，我从未遇到过这种行为。

可能是什么原因和解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:48:45.027

文档似乎很少——我认为没有一个庞大的用户社区可以*直接*使用 RPC API——但我的猜测是，为了设置管道参数，RPC 有必要在内部调用`RpcServerListen`. 一次只能阻止对该 API 的一个调用。

您只是偶尔看到问题的事实表明它与时间有关，那么您是否有可能在不同的线程上进行两次这样的调用，有时它们会同时发生？

要么，要么在 RPC 库的实现中存在与时间相关的错误，您必须通过重试调用来解决它（在任何情况下这都可能是一种有效的解决方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T14:38:39.473

我认为这不应该被视为一个问题。请参阅[PRB：RPC 服务器中的 CoCreateInstance 失败](http://msdn.microsoft.com/en-us/library/aa373942(VS.85).aspx)

也可以查看这个：[如何注册多个 RPC 服务器接口](http://msdn.microsoft.com/en-us/library/aa373944(VS.85).aspx)

[更新] 可能内存释放有问题。[查看PIPE](http://msdn.microsoft.com/en-us/library/aa374367(VS.85).aspx)的实现示例并检查您的代码。
[在客户端实现输入管道 在客户端](http://msdn.microsoft.com/en-us/library/aa373942(VS.85).aspx)
[实现输出管道 在](http://msdn.microsoft.com/en-us/library/aa373944(VS.85).aspx)
[服务器上实现输入管道 在服务器上](http://msdn.microsoft.com/en-us/library/aa373943(VS.85).aspx)
[实现输出管道](http://msdn.microsoft.com/en-us/library/aa373945(VS.85).aspx)

祝你好运。

# python - 正在寻找关于网络抓取项目最佳实践的优秀教程的推荐？

> ID：684629
> 
> 赞同：4
> 
> 时间：2009-03-26T05:31:24.343
> 
> 标签：python, ruby, screen-scraping, beautifulsoup, hpricot

我需要做一个涉及网络抓取的相当广泛的项目，并且正在考虑使用 Hpricot 或 Beautiful Soup（即 Ruby 或 Python）。有没有人遇到过他们认为在这个主题上特别好的教程，可以帮助我正确地开始这个项目？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T05:56:10.617

我最喜欢的两个 Python 网页抓取工具是[Scrapy](http://scrapy.org/)和[Mechanize](http://wwwsearch.sourceforge.net/mechanize/)。这些项目中的每一个都有自己的教程和最佳实践。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-26T06:01:26.563

不是一个工具，真的，但很好的讨论是 Michael Shrenk 的书，[Webbots, Spiders, and Screen Scrapers](https://rads.stackoverflow.com/amzn/click/com/1593271204)。

这本书在其既定使命上取得了很大的成功：解释了如何构建简单的网络机器人并按照社区标准进行操作。这不是你需要知道的一切，但这是我见过的最好的介绍。重点是简单的单线程机器人。有一些提到使用多个机器人将数据存储在中央存储库中，但没有讨论编写每秒可以处理数百页的多线程或分布式机器人所涉及的问题。

如果您对编写 Web bot 完全感兴趣，我建议您阅读本书，即使您不熟悉或不打算使用 PHP。但请确保不要期望超出本书提供的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-03T15:38:28.467

考虑使用[lxml](http://codespeak.net/lxml/)而不是 BeautifulSoup。尽管它的名字，它也用于解析和抓取 HTML。它比 BeautifulSoup 快得多，而且它甚至比 BeautifulSoup 更好地处理“损坏”的 HTML（他们声名鹊起 - lxml 并没有那么直言不讳）。如果您不想学习 lxml API，它也有适用于 BeautifulSoup 的兼容性 API。

[Ian Blicking 同意](http://blog.ianbicking.org/2008/12/10/lxml-an-underappreciated-web-scraping-library/)。

没有理由再使用 BeautifulSoup，除非您使用的是 Google App Engine 或其他任何不纯 Python 的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-24T22:38:27.980

请看以下截屏视频：

*   [http://railscasts.com/episodes/190-screen-scraping-with-nokogiri](http://railscasts.com/episodes/190-screen-scraping-with-nokogiri)
*   [http://railscasts.com/episodes/191-mechanize](http://railscasts.com/episodes/191-mechanize)

或者，如果你喜欢它，相应的 asciicasts：

*   [http://asciicasts.com/episodes/190-screen-scraping-with-nokogiri](http://asciicasts.com/episodes/190-screen-scraping-with-nokogiri)
*   [http://asciicasts.com/episodes/191-mechanize](http://asciicasts.com/episodes/191-mechanize)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T06:20:00.293

对于 Ruby，[Scrubyt](http://scrubyt.org/)网络抓取工具包非常棒。这是对它[的广泛介绍](http://www.rubyrailways.com/data-extraction-for-web-20-screen-scraping-in-rubyrails-episode1/)，即使您将使用其他工具，也值得一读。

# html - 对齐 div 内的内容

> ID：684634
> 
> 赞同：165
> 
> 时间：2009-03-26T05:35:01.650
> 
> 标签：html, css, text-align

我使用 css 样式的 text-align 来对齐 HTML 中容器内的内容。当内容是文本或浏览器是 IE 时，这可以正常工作。但否则它不起作用。

顾名思义，它基本上用于对齐文本。align 属性早已被弃用。

有没有其他方法可以对齐 html 中的内容？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2009-03-26T05:46:21.437

text-align 对齐文本和其他内联内容。它不对齐块元素子元素。

为此，您需要为要对齐的元素指定宽度，并使用“自动”左右边距。这是兼容标准的方式，适用于除 IE5.x 之外的任何地方。

```
<div style="width: 50%; margin: 0 auto;">Hello</div> 
```

要在 IE6 中使用此功能，您需要使用合适的 DOCTYPE确保打开[标准模式。](http://en.wikipedia.org/wiki/Quirks_mode)

如果你真的需要支持 IE5/Quirks 模式，而现在你不应该这样做，可以结合两种不同的居中方法：

```
<div style="text-align: center">
    <div style="width: 50%; margin: 0 auto; text-align: left">Hello</div>
</div> 
```

（显然，样式最好放在样式表中，但内联版本是说明性的。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-10-27T15:07:56.640

```
<div class="content">Hello</div>

.content {
    margin-top:auto;
    margin-bottom:auto;
    text-align:center;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-09-04T05:53:23.197

以下是一直对我有用的方法

1.  **通过使用 flex 布局模型**：

将父 div 的显示设置为，您可以使用（对齐主轴上的项目）和（对齐交叉轴上的项目）对齐`display: flex;`div 内的子元素。`justify-content: center;``align-items: center;`

如果您有多个子元素并且想要控制它们的排列方式（列/行），那么您也可以添加`flex-direction`属性。

工作示例：

```
.parent {
  align-items: center;
  border: 1px solid black;
  display: flex;
  justify-content: center;
  height: 250px;
  width: 250px;
}

.child {
  border: 1px solid black;
  height: 50px;
  width: 50px;
}
```

```
<div class="parent">
  <div class="child"></div>
</div>
```

**2.（老方法）使用位置、边距属性和固定大小**

工作示例：

```
.parent {
  border: 1px solid black;
  height: 250px;
  position: relative;
  width: 250px;
}

.child {
  border: 1px solid black;
  margin: auto;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  height: 50px;
  position: absolute;
  width: 50px;
}
```

```
<div class="parent">
  <div class="child"></div>
</div>
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-12-22T19:46:54.690

你也可以这样做：

**HTML**

```
<body>
    <div id="wrapper_1">
        <div id="container_1"></div>
    </div>
</body> 
```

**CSS**

```
body { width: 100%; margin: 0; padding: 0; overflow: hidden; }

#wrapper_1 { clear: left; float: left; position: relative; left: 50%; }

#container_1 { display: block; float: left; position: relative; right: 50%; } 
```

正如*Artem Russakovskii也提到的，请阅读*[Mattew James Taylor](http://matthewjamestaylor.com/blog/beautiful-css-centered-menus-no-hacks-full-cross-browser-support)的原始文章以获取完整描述。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-08-04T18:21:07.087

老实说，我讨厌到目前为止我所看到的所有解决方案，我会告诉你原因：它们似乎永远不会正确对齐......所以这就是我通常做的事情：

我知道每个 div 和它们各自的边距都有哪些像素值......所以我做了以下事情。

我将创建一个具有绝对位置和 50% 左值的包装 div...所以这个 div 现在从屏幕中间开始，然后我减去 div 宽度的所有内容的一半...我得到了漂亮的缩放内容......我认为这也适用于所有浏览器。亲自尝试一下（本示例假设您网站上的所有内容都包装在使用此包装类的 div 标签中，并且其中的所有内容宽度为 200 像素）：

```
.wrapper {
    position: absolute;
    left: 50%;
    margin-left: -100px;
} 
```

编辑：我忘了添加...您可能还想设置宽度：0px; 在某些浏览器的包装 div 上不显示滚动条，然后您可以对所有内部 div 使用绝对定位。

这对于垂直对齐您的内容以及使用 top: 50% 和 margin-top 也很有效。干杯!

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-06-11T12:00:09.750

这是我使用的一种效果很好的技术：

```
<div>
    <div style="display: table-cell; width: 100%">&nbsp;</div>
    <div style="display: table-cell; white-space: nowrap;">Something Here</div>
</div>
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-10T15:14:10.797

所有答案都在谈论水平对齐。

对于垂直对齐多个内容元素，看看这种方法：

```
<div style="display: flex; align-items: center; width: 200px; height: 140px; padding: 10px 40px; border: solid 1px black;">
    <div>
        <p>Paragraph #1</p>
        <p>Paragraph #2</p>
    </div>
</div>
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-08-17T13:06:10.813

另一个使用 HTML 和 CSS 的示例：

```
<div style="width: Auto; margin: 0 auto;">Hello</div> 
```

# c# - 使用 Thread.Start 与 QueueUserWorkItem 的优势

> ID：684640
> 
> 赞同：26
> 
> 时间：2009-03-26T05:37:01.083
> 
> 标签：c#, .net, multithreading

在多线程 .NET 编程中，使用 ThreadPool.QueueUserWorkItem 与通过 new Thread() 和 Thread.Start() 启动我自己的线程的决策标准是什么？

在服务器应用程序（比方说，ASP.NET 应用程序或 WCF 服务）中，我认为 ThreadPool 始终存在且可用。在客户端应用程序（如 WinForms 或 WPF 应用程序）中呢？启动线程池是否需要成本？如果我只想让 3 或 4 个线程在某些计算上工作一段时间，那么 QUWI 还是 Thread.Start() 更好。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-26T06:23:29.803

ThreadPool 始终存在，但是，根据处理器的数量，分配给池的线程数量是有限的。对于 ASP.NET 应用程序，使用线程通常不是一个好主意，除非您真的启动异步进程并且知道不会有大量请求（请记住，线程池中有有限数量的线程您与 AppDomain 中运行的所有内容共享，并且您想要使用 new Thread() 创建的线程总数也存在实际限制）。

对于 WinForms 应用程序，请考虑使用 BackgroundWorker 而不是使用 Thread 或 ThreadPool。它使用 ThreadPool，但是，它使精通多线程的程序员更容易在线程之间进行通信。

**更新**

> 避免使用***ThreadPool.QueueUserWorkItem***，因为您的应用程序池可能随时消失。如果必须，将这项工作移到外面或使用 WebBackgrounder。

来自[Hanselman.com -“清单：在 ASP.NET 中不能做什么”](http://www.hanselman.com/blog/ChecklistWhatNOTToDoInASPNET.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-26T19:35:48.870

本来想写评论的，可惜太长了。
CodemonkeyKing 似乎触及了一个重要的点，尽管在我看来还不够强烈。

您可以使用许多标准来描述代码。它会在长时间运行的应用程序中使用吗？Winforms应用程序与否？它是服务器还是客户端应用程序？库还是独立的exe？等等等等

在我看来，如果您的代码将在独立应用程序中运行并且您可以控制所有周围的代码，那么您可以滚动自己的线程池，启动自己的线程，并测量和管理线程启动、线程延迟、和资源消耗。或者你可以使用 QUWI，但它不会杀死你的应用程序。你可以自由选择。

另一方面，如果您的代码被打包为一个库，可以在服务器中使用——在 ASP.NET 中，或者可能在 SQL CLR 应用程序或 WCF 服务中——那么创建线程是一个非常糟糕的主意。您需要使用 QUWI 或其他利用内置线程池的机制（如 BackgroundWorker）。如果要在客户端应用程序中与其他库一起使用，则再次需要 QUWI。想象一下，每个想要利用多核计算机的图书馆都推出了自己的线程。使用多个库的应用程序将完全混乱。猖獗的线程，都在争夺相同的资源。#threads 与 # 处理器之间没有中央协调。

良好的卫生*要求*库，无论是在客户端应用程序还是服务器应用程序中使用，都使用公共线程池，这意味着 QUWI。

最后要意识到的是这一点；

> 托管线程要么是后台线程，要么是前台线程。后台线程与前台线程相同，但有一个例外：后台线程不会使托管执行环境保持运行。一旦托管进程中的所有前台线程都已停止（其中 .exe 文件是托管程序集），系统将停止所有后台线程并关闭。
> 
> 属于托管线程池的线程（即 IsThreadPoolThread 属性为 true 的线程）是后台线程。从非托管代码进入托管执行环境的所有线程都被标记为后台线程。通过创建和启动一个新的 Thread 对象生成的所有线程默认都是前台线程。
> 
> 如果您使用线程来监视活动，例如套接字连接，请将其 IsBackground 属性设置为 true，以便线程不会阻止您的进程终止。

从[MSDN 网站](http://msdn.microsoft.com/en-us/library/h339syd0.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T05:48:07.313

这个讨论会让你感兴趣 什么
[时候不应该在 .Net 中使用 ThreadPool？](https://stackoverflow.com/questions/10274/when-should-i-not-use-the-threadpool-in-net)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T06:24:18.723

如果您的任务很短，您很可能会通过 QueueUserWorkItem 或 BeginInvoke 在线程池上调度任务来获得更好的性能，因为您避免了创建和销毁自己的线程的重复成本。

线程池显然也为创建线程付费，但它重用线程，因此您无需支付每个任务的成本。

您可能还想看看[C# 中的线程](http://www.albahari.com/threading/)（免费电子书）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-25T02:50:28.123

这是使用 ThreadPool.QueueUserWorkItem 的另一个优势。

我有一个带有心跳的 winforms 应用程序。我最初使用

```
 heartbeat = new Thread(HeartbeatDoWork);
        heartbeat.Start(); 
```

98％的时间都可以正常工作。但是，当应用程序关闭时，有时它不会正确“死”，即该进程在任务管理器中仍然可见。

简而言之，心跳发布了一个事件，它正在处理它“卡住”的事件（CAB pub/sub）。

修复很简单，改用这个

```
 ThreadPool.QueueUserWorkItem(HeartbeatDoWork); 
```

我确信在关闭我自己的线程时我可以做一些额外的事情，并且它会被正确清理，但这更简单，更快，更容易理解...... ThreadPool 为我完成了所有工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T05:57:04.077

线程池在 .NET 应用程序中始终可用，无论是哪种类型。

通过线程池启动线程`ThreadPool.QueueUserWorkItem`的成本不会超过启动自己线程的成本，并且可能会更低。

如果您只想在短时间内使用几个线程，请使用线程池。这就是它的用途。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T08:03:44.540

如果您正在创建自己的线程，那么在第一次使用时启动它们是有意义的，然后让它们停留一段时间以防您再次需要它们 - 您使空闲线程等待事件，以便您可以通过发出信号重新激活它事件，并且经过足够长的时间后，线程将自行唤醒并退出，回收未使用的资源。通过保留少量空闲线程以备重用，您可以减少不断创建和销毁线程的开销（这对于足够短的操作非常重要）。

但这基本上是线程队列已经为您所做的 - 所以您不妨使用它。这是一个已解决的问题。

不管你信不信，在 C++ 社区中曾经发生过关于字符串的类似辩论。我们应该各自编写自己的字符串类，还是应该使用`std::string`？答案取决于您是否想学习如何编写字符串类，或者您已经完成了这些并且想要继续发明新的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-20T11:47:25.347

使用的一个优点`Thread.Start()`是，**您可以在**以后有意中止线程。在`ThreadPool`您入队后，您无法控制线程执行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-09T22:40:50.867

我的大部分阅读内容都同意 Marcel，如果发生某些事情（中止......），控制线程的能力是应该认真考虑的事情，特别是如果您正在处理您无法控制并且可能挂起的第 3 方调用。

# c# - 一个清晰的，外行的解释之间的区别| 和 || 在 C# 中？

> ID：684648
> 
> 赞同：44
> 
> 时间：2009-03-26T05:43:56.090
> 
> 标签：c#, bitwise-operators, logical-operators

好的，所以我已经读过很多次了，但我还没有听到一种清晰、易于理解（且令人难忘）的方式来了解以下之间的区别：

```
if (x | y) 
```

和

```
if (x || y) 
```

..在 C# 的上下文中。任何人都可以帮助我了解这个基本事实，以及 C# 具体如何以不同的方式对待它们（因为它们似乎做同样的事情）。如果给定的一段代码之间的差异无关紧要，我应该默认将哪个作为最佳实践？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-26T05:50:03.003

`||`是*逻辑或*运算符。见**[这里](http://msdn.microsoft.com/en-us/library/aa691310(VS.71).aspx)**。它评估`true`是否至少有一个操作数为真。您只能将它与布尔操作数一起使用；将它与整数操作数一起使用是错误的。

```
// Example
var one = true || bar();   // result is true; bar() is never called
var two = true | bar();    // result is true; bar() is always called 
```

`|`是*or*运算符。见**[这里](http://msdn.microsoft.com/en-us/library/kxszd0kx(VS.71).aspx)**。如果应用于布尔类型，则评估`true`是否至少有一个操作数为真。如果应用于整数类型，则计算结果为另一个数字。如果至少有一个操作数设置了相应的位，则该数字的每个位都设置为 1。

```
// Example
var a = 0x10;
var b = 0x01;
var c = a | b;     // 0x11 == 17
var d = a || b;    // Compile error; can't apply || to integers
var e = 0x11 == c; // True 
```

对于布尔操作数，`a || b`与*相同*，`a | b`只有一个例外，如果为真`b`则不计算。`a`为此，`||`被称为“短路”。

> 如果给定的一段代码之间的差异无关紧要，我应该默认将哪个作为最佳实践？

如前所述，差异并非无关紧要，因此这个问题部分没有实际意义。至于“最佳实践”，没有一个：您只需使用正确的运算符即可。通常，人们更喜欢`||`布尔`|`操作数，因为您可以确定它不会产生不必要的副作用。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-26T07:13:29.387

当与布尔操作数一起使用时，运算`|`符是逻辑运算符，就像 一样`||`，但不同之处在于`||`运算符进行短路评估而`|`运算符不进行。

这意味着总是使用`|`运算符计算第二个操作数，但使用`||`运算符仅在第一个操作数的计算结果为 false 时才计算第二个操作数。

对于两个运算符，表达式的结果总是相同的，但是如果第二个操作数的求值导致其他东西发生变化，那么只有在使用`|`运算符时才能保证发生这种情况。

例子：

```
int a = 0;
int b = 0;

bool x = (a == 0 || ++b != 0);

// here b is still 0, as the "++b != 0" operand was not evaluated

bool y = (a == 0 | ++b != 0);

// here b is 1, as the "++b != 0" operand was evaluated. 
```

运算符的短路评估`||`可用于编写更短的代码，因为仅当第一个操作数为真时才评估第二个操作数。而不是这样写：

```
if (str == null) {
   Console.WriteLine("String has to be at least three characters.");
} else {
   if (str.Length < 3) {
      Console.WriteLine("String has to be at least three characters.");
   } else{
      Console.WriteLine(str);
   }
} 
```

你可以这样写：

```
if (str == null || str.Length < 3) {
   Console.WriteLine("String has to be at least three characters.");
} else{
   Console.WriteLine(str);
} 
```

仅当第一个操作数为 false 时才评估第二个操作数，因此您知道可以安全地在第二个操作数中使用字符串引用，因为如果评估第二个操作数，它不能为 null。

在大多数情况下，您希望使用`||`运算符而不是`|`运算符。如果第一个操作数为假，则无需评估第二个操作数即可获得结果。此外，很多人（显然）不知道您可以将`|`运算符与布尔操作数一起使用，因此当他们在代码中看到它以这种方式使用时会感到困惑。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-26T05:47:36.627

它们是不相同的。一种是按位或，一种是逻辑或。

X || Y ，是逻辑或，与“X 或 Y”的含义相同，适用于布尔值。它用于条件或测试。在这种情况下，X 和 Y 可以替换为任何计算结果为布尔值的表达式。例子：

```
if (File.Exists("List.txt")  ||  x > y )  { ..} 
```

如果两个条件中的任何一个为真，则该子句的计算结果为真。如果第一个条件为真（如果文件存在），则不需要也不会评估第二个条件。

单管道 ( | ) 是按位或。要知道这意味着什么，您必须了解数字是如何存储在计算机中的。假设你有一个 16 位的量 (Int16)，它的值是 15。它实际上存储为 0x000F（十六进制），与二进制的 0000 0000 0000 1111 相同。按位或取两个量并将每对对应的位进行或运算，因此如果位在任一量中为 1，则结果中为 1。因此，如果 a = 0101 0101 0101 0101（以十六进制计算为 0x5555）且 b = 1010 1010 1010 1010（即 0xAAAA），则 a | b = 1111 1111 1111 1111 = 0xFFFF。

您可以在 C# 中使用按位 OR（单管道）来测试是否打开了一组特定位中的一个或多个。如果你有 12 个布尔值或二进制值来测试，你可能会这样做，它们都是独立的。假设您有一个学生数据库。一组独立的布尔值可能是诸如男性/女性、家庭/校园内、当前/非当前、已注册/未注册等。您可以存储这些值，而不是为每个值存储一个布尔字段每个只有一点。男性/女性可能是第 1 位。注册/未注册可能是第 2 位。

然后你可以使用

```
 if ((bitfield | 0x0001) == 0x0001) { ... } 
```

作为一个测试，看看是否没有打开任何位，除了“学生是男性”位，它被忽略了。嗯？好吧，按位或为任一数字中的每个位返回一个 1。如果上述按位或的结果 = 0x0001，则表示位域中没有打开位，*可能*除了第一位 (0x0001)，但您无法确定第一位是否打开，因为它被掩盖。

有一个对应的&&和&，分别是逻辑与和位与。他们有类似的行为。

您可以使用

```
 if ((bitfield &  0x0001) == 0x0001) { ... } 
```

查看第一个位是否在位域中打开。

编辑：我不敢相信我为此被否决了！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-26T06:22:09.370

`||`很好的答案，但让我补充一点，如果左侧表达式为 ，则不计算右侧表达式 for `true`。在评估术语为 a) 性能密集型或 b) 产生副作用（罕见）的情况下，请记住这一点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-26T06:45:45.350

与迄今为止大多数答案所说的不同，其含义与 C++ 中的含义*并不*完全相同。

对于任何两个表达式 A 和 B 计算为布尔值，A || B 和 A | B 做几乎相同的事情。

一个 | B 评估A*和*B，如果其中一个评估为 true，则结果为 true。

一个 || B 做了几乎相同的事情，只是它先评估 A，然后仅在必要时评估 B。由于如果 A 或 B 为真，则整个表达式为真，因此如果 A 为真，则根本不需要测试 B。所以|| 短路，并在可能的情况下跳过评估第二个操作数，其中 | 运算符将始终评估两者。

该| 运算符不经常使用，而且通常不会有所作为。我能想到的唯一常见情况是：

```
if ( foo != null || foo.DoStuff()){ // assuming DoStuff() returns a bool

} 
```

这是有效的，因为如果左测试失败，则永远不会调用 DoStuff() 成员函数。也就是说，如果 foo 为空，我们不会在其上调用 DoStuff。（这会给我们一个 NullReferenceException）。

如果我们使用 | 运算符，无论 foo 是否为空，都会调用 DoStuff()。

在整数上，只有 | 运算符已定义，并且是按位或，如其他答案所述。|| 虽然没有为整数类型定义运算符，因此很难在 C# 中将它们混淆。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-26T05:47:56.627

| 是按位或运算符（数字、整数）。它通过将数字转换为二进制并对每个相应的数字进行 OR 来工作。再说一次，数字已经在计算机中以二进制表示，因此在运行时不会真正发生这种转换；）

|| 是逻辑 OR 运算符（布尔值）。它仅适用于真值和假值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-26T07:03:25.760

以下将在 C/C++ 中工作，因为它没有对布尔值的一流支持，它将每个带有“on”位的表达式视为 true，否则为 false。事实上，如果 x 和 y 是数字类型，则以下代码在 C# 或 Java 中不起作用。

```
if (x | y) 
```

所以上面代码的显式版本是：

```
if ( (x | y) != 0) 
```

在 C 语言中，任何带有“On”位的表达式都为真

诠释 i = 8;

if (i) // 在 C 中有效，结果为真

诠释喜悦=-10；

if (joy) // 在 C 中有效，结果为真

现在，回到 C#

如果 x 和 y 是数字类型，则您的代码：**if (x | y)**将不起作用。你试过编译它吗？不起作用

但是对于您的代码，我可以假设 x 和 y 是布尔类型，所以它会起作用，所以 | 和 || 对于布尔类型，|| 短路，| 不是。以下内容的输出：

```
 static void Main()
    {

        if (x | y)
            Console.WriteLine("Get");

        Console.WriteLine("Yes");

        if (x || y)
            Console.WriteLine("Back");

        Console.ReadLine();
    }

    static bool x
    {
        get { Console.Write("Hey");  return true; }
    }

    static bool y
    {
        get { Console.Write("Jude"); return false; }
    } 
```

是：

```
HeyJudeGet
Yes
HeyBack 
```

裘德不会被打印两次，|| 是一个布尔运算符，许多 C 派生语言的布尔运算符都是**短路的**，布尔表达式在短路时性能更高。

至于外行术语，当你说短路时，例如在 || （或运算符），如果第一个表达式已经为真，则无需计算第二个表达式。示例：if (answer == 'y' || answer == 'Y')，如果用户按下小 y，程序不需要计算第二个表达式(answer == 'Y')。那是短路。

在我上面的示例代码中，X 为真，所以 || 上的 Y 运算符不会被进一步评估，因此没有第二个“Jude”输出。

即使 X 和 Y 是布尔类型，也不要在 C# 中使用这种代码：**if (x | y)**。不高效。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-26T05:52:06.133

第一个按位运算符处理两个数值并产生第三个数值。

如果你有二进制变量

```
a = 0001001b;
b = 1000010b; 
```

然后

```
a | b == 1001011b; 
```

也就是说，如果任一操作数中的某个位也为 1，则结果中的位为 1。（为了清楚起见，我的示例使用 8 位数字）

“双管道”|| 是一个逻辑 OR 运算符，它接受两个布尔值并产生第三个值。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-26T12:10:13.603

在不以任何方式、形状或形式深入研究细节的情况下，这是一个*真正*的外行版本。

想想“|” 在英语中作为直的“或”；想想“||” 在英语中作为“或其他”。

类似地把“&”想象成英文中的“and”；把“&&”想象成英语中的“and also”。

如果您使用这些术语为自己朗读一个表达式，它们通常会更有意义。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-04-10T14:41:11.390

强烈推荐阅读Dotnet Mob的[这篇文章](http://codaffection.com/csharp-article/short-circuit-evaluation-in-c/)

> 对于 OR 逻辑运算，如果它的任何操作数被评估为 true，那么整个表达式被评估为 true

这是什么|| 操作员会 - 当它发现为真时，它会跳过剩余的评估。虽然 | 运算符评估它的完整操作数以评估整个表达式的值。

```
if(true||Condition1())//it skip Condition1()'s evaluation
{
//code inside will be executed
}
if(true|Condition1())//evaluates Condition1(), but actually no need for that
{
//code inside will be executed
} 
```

最好使用逻辑运算符的短路版本，无论是 OR(||) 还是 AND(&&) 运算符。

* * *

考虑以下代码片段

```
int i=0;
if(false||(++i<10))//Now i=1
{
//Some Operations
}
if(true||(++i<10))//i remains same, ie 1
{} 
```

这种效应称为***副作用***，实际上见于短路逻辑运算符表达式的右侧。

参考：[C# 中的短路评估](http://codaffection.com/csharp-article/short-circuit-evaluation-in-c/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-26T16:02:10.257

虽然它已经被正确地说和回答了，但我想我会添加一个真正的外行的答案，因为很多时候这就是我在这个网站上的感觉:)。另外，我将添加 & 与 && 的示例，因为它是相同的概念

**| 与 ||**

基本上你倾向于使用 || 当您只需要评估第二部分时，如果第一部分为假。所以这：

```
if (func1() || func2()) {func3();} 
```

是相同的

```
if (func1())
{
    func3();
}
else 
{
    if (func2()) {func3();}
} 
```

这可能是一种节省处理时间的方法。如果 func2() 需要很长时间来处理，如果 func1() 已经为真，你就不想这样做。

**& 与 &&**

在 & 与 && 的情况下，情况类似，如果第一部分为 TRUE，则仅评估第二部分。例如这个：

```
if (func1() && func2()) {func3();} 
```

是相同的

```
if (func1())
{
    if (func2()) {func3();}}
} 
```

这可能是必要的，因为 func2() 可能首先取决于 func1() 是否为真。如果您使用 & 并且 func1() 评估为 false，则 & 无论如何都会运行 func2()，这可能会导致运行时错误。

外行杰夫

# google-ads-api - 无法通过 API 更新 google adwords 帐户（即 UpdateAccount()）

> ID：684650
> 
> 赞同：0
> 
> 时间：2009-03-26T05:44:44.357
> 
> 标签：google-ads-api

我无法使用 AccountService 中的 UpdateAccount() 方法以编程方式更新 google 帐户。尝试更新地址字段时出现异常。有人可以告诉我。AccountInfo 类中的可更新字段是什么。如果可能的话，使用源代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-09T11:34:33.537

AccountInfo 的 primaryAddress 和 billingAddress 字段均不可更新。

如果您正在寻找一种以编程方式管理 AdWords 帐户的简单方法并且您正在使用 .NET 平台，那么您应该查看 GemBox.Ppc [AdWords API for .NET](http://www.gemboxsoftware.com/Ppc/Overview.htm)。

它极大地简化了 AdWords 帐户的管理。

# c# - C# 中的 CryptExportKey

> ID：684662
> 
> 赞同：1
> 
> 时间：2009-03-26T05:52:48.567
> 
> 标签：c#, windows, cryptography, rsa

[与此CryptExportKey](http://msdn.microsoft.com/en-us/library/aa379931(VS.85).aspx)调用等效的 C# 是什么？

```
CryptExportKey(hKey, hPublicKey, SIMPLEBLOB, 0, lpData, &nSize); 
```

如果您可以在您的 C# 代码中给出描述，那就太好了

正在使用 hKey、hPublicKey 和 SIMPLEBLOB（或它们在 C# 中的等价物）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T06:06:29.343

这是我用的吗？

```
 using System.Security.Cryptography;
    using System.Security.Cryptography.Xml;

    // retrieve from named keystore
    private void btnRetrieve_Click(object sender, RoutedEventArgs e)
    {
        string keyContainer = this.tbContainerName.Text;

        CspParameters parms = new CspParameters(1);
        parms.Flags = CspProviderFlags.UseMachineKeyStore;
        parms.KeyContainerName = keyContainer;
        parms.KeyNumber = 2;
        RSACryptoServiceProvider RsaCsp = new RSACryptoServiceProvider(parms);

        tbPubKeyBlob.Text = RsaCsp.ToXmlString(false);
    }

    // generate key pair
    private void btnCreateKeypair_Click(object sender, RoutedEventArgs e)
    {
        int keySize = 0;
        if (!System.Int32.TryParse(this.tbKeySize.Text, out keySize))
            keySize = 1024;
        byte[] key = Keys.GenerateKeyPair(keySize);

        RSACryptoServiceProvider RsaCsp = new RSACryptoServiceProvider();
        RsaCsp.ImportCspBlob(key);

        tbPubKeyBlob.Text = RsaCsp.ToXmlString(false);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T07:40:51.717

我认为你最好的选择是手动处理它。

SIMPLEBLOB 格式是

```
BLOBHEADER blobheader;
ALG_ID algid;
BYTE encryptedkey[rsapubkey.bitlen/8]; 
```

BLOBHEADER 在哪里

```
BYTE   bType;
BYTE   bVersion;
WORD   reserved;
ALG_ID aiKeyAlg; 
```

所以这样的事情应该这样做（对不起，未经测试）：

```
public byte[] CryptExportKey(SymmetricAlgorithm key, RSA publicKey){
  using(MemoryStream ms = new MemoryStream())
  using(BinaryWriter w = new BinaryWriter(w)){
    w.Write((byte) 0x01); // SIMPLEBLOB
    w.Write((byte) 0x02); // Version 2
    w.Write((byte) 0x00); // Reserved
    w.Write((byte) 0x00); // Reserved
    if(key is Rijndael){
      w.Write(0x00006611);  // ALG_ID for the encrypted key.
    }else if (key is TripleDES && key.KeySizeValue == 192){
      w.Write(0x00006603);  // ALG_ID for the encrypted key.
    }else{
      throw new NotSupportedException("Look the value up on http://msdn.microsoft.com/en-us/library/aa375549%28VS.85%29.aspx");
    }
    w.Write(0x0000a400);  // CALG_RSA_KEYX
    byte[] encryptedKey = publicKey.Encrypt(key.Key);
    byte[] reversedEncryptedKey = new byte[encryptedKey.Length];
    for(int i=0;i<encryptedKey.Length;i++){
      reversedEncryptedKey[i] = encryptedKey[encryptedKey.Length - 1 - i];
    }
    w.Write(reversedEncryptedKey); // encrypted key in LSB byte order
    w.Flush();
    return ms.ToArray();
  }
} 
```

# c++ - 为什么在c++中实现基于类的优先级队列时需要重载operator<？

> ID：684669
> 
> 赞同：3
> 
> 时间：2009-03-26T05:58:51.233
> 
> 标签：c++, operator-overloading, priority-queue

*请注意，我不是在寻求答案。我只是好奇为什么事情会奏效*

我需要为班级分配的打印机模拟器实现优先级队列。在查看互联网上的示例后，我注意到 operator< 被超载以正确安排优先级队列。

[有问题的代码：java2s 优先队列示例](http://www.java2s.com/Code/Cpp/Data-Structure/Storingclassobjectsinapriorityqueue.htm)

为什么 operator< 需要重载？'<' 甚至在哪里进行比较？实现运算符重载会改变队列 STL 的工作方式吗？

这个实现对我来说似乎并不直观：为什么 operator> 没有被重载呢？应该如何知道 operator< 需要重载才能让 priority_queue 正常工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T06:05:59.657

对于那些对内容进行排序的容器，STL 容器默认使用 operator< 来对内容进行排序。

您可以通过将比较函子传递给容器的构造函数来覆盖它，这允许您将排序/排序与容器对象分离。

可以选择 Operator>，但必须选择一个，那就是 operator<，然后在任何地方使用以保持一致性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T06:26:37.953

> 为什么 operator< 需要重载？

中的`Compare`函数对象[`priority_queue<T, Sequence, Compare>`](http://www.sgi.com/tech/stl/priority_queue.html)：

> 比较在其参数类型上引入严格的弱排序，如 LessThan Comparable 要求中所定义。

[LessThanComparable 文档](http://www.sgi.com/tech/stl/LessThanComparable.html)：

> 笔记
> 
> [1](http://www.sgi.com/tech/stl/priority_queue.html)只有 operator< 是基本的；其他不等式运算符本质上是语法糖。
> 
> [2](http://www.sgi.com/tech/stl/LessThanComparable.html)反对称是一个定理，而不是一个公理：它源于非自反性和传递性。
> 
> [3] 由于非自反性和传递性，operator< 总是满足偏序的定义。严格弱序的定义更加严格，全序的定义更加严格。
> 
> '<' 甚至在哪里进行比较？

`void push(const value_type& x)`在队列中插入一个值。

> 实现运算符重载会改变队列 STL 的工作方式吗？

是的当然。如果你在比较中交换元素的顺序，你的排序就会相反。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T10:39:20.093

`priority_queue<T>`uses `std::less<T>`，这又需要`T() < T()`是一个有效的表达式。可以是成员，也可以是非成员，但表达式必须有效。

但是，`std::less<T>`可能是专门的，因此您声明 operator< 需要重载有点误导。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T06:09:07.997

好的，基本原因是优先级队列是一种结构，其中插入的项目按照某个排序函数的顺序返回。您需要一个排序，而处理它的明显方法是重载 operator<。您可以按名称拥有一个函数，但可以说`if( a < b)`比`if(isLessThan(a,b))`或类似的东西更具可读性。

你不会`operator>`因为不需要而超载；优先级队列中唯一需要的操作是小于。这并不意味着你*不能*拥有一个，但既然你有一个`==`，你可以简单地实现它——或者只是反转操作数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T06:49:36.790

仅供参考：std::priority_queue 可以接受比较谓词。
operator< 用作默认行为。这是最低要求。

> 为什么 operator> 不被重载

我认为是历史原因。在数学中，所有示例通常都描述为 < 操作，并且一个操作符足以定义所有其他操作（>、<=、>=、==、！=）。

> 这个实现对我来说似乎并不直观

对我来说，这个界面是意料之中的。我认为这是习惯。

> 实现运算符重载会改变队列 STL 的工作方式吗？

不，不。不是 STL 队列，只有您的队列 - 对于您的类型，如果您自己的比较器未定义。

# javascript - 如何循环或枚举 JavaScript 对象？

> ID：684672
> 
> 赞同：3332
> 
> 时间：2009-03-26T06:01:47.873
> 
> 标签：javascript, loops, for-loop, each

我有一个 JavaScript 对象，如下所示：

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
}; 
```

现在我想遍历所有`p`元素（`p1`, `p2`, `p3`...）并获取它们的键和值。我怎样才能做到这一点？

如有必要，我可以修改 JavaScript 对象。我的最终目标是遍历一些键值对，如果可能的话，我想避免使用`eval`.

* * *

## 回答 #1

> 赞同：4917
> 
> 时间：2009-03-26T06:12:13.807

您可以使用[`for-in`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)其他人所示的循环。但是，您还必须确保您获得的密钥是对象的实际属性，而不是来自原型。

**这是片段：**

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};

for (var key in p) {
    if (p.hasOwnProperty(key)) {
        console.log(key + " -> " + p[key]);
    }
}
```

**使用 Object.keys() 替代方案：**

```
var p = {
    0: "value1",
    "b": "value2",
    key: "value3"
};

for (var key of Object.keys(p)) {
    console.log(key + " -> " + p[key])
}
```

注意使用[`for-of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)而不是[`for-in`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)，如果不使用，它将在命名属性上返回未定义，并[`Object.keys()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)确保仅使用对象自己的属性而不使用整个原型链属性

**使用新[`Object.entries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)方法：**

**注意：** Internet Explorer 本身不支持此方法。您可以考虑为旧版浏览器使用 Polyfill。

```
const p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};

for (let [key, value] of Object.entries(p)) {
  console.log(`${key}: ${value}`);
} 
```

* * *

## 回答 #2

> 赞同：1267
> 
> 时间：2011-04-20T21:59:19.703

在 ECMAScript 5 下，您可以组合[`Object.keys()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)和[`Array.prototype.forEach()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)：

```
var obj = { first: "John", last: "Doe" };

Object.keys(obj).forEach(function(key) {
    console.log(key, obj[key]);
}); 
```

ECMAScript 6 增加了[`for...of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)：

```
for (const key of Object.keys(obj)) {
    console.log(key, obj[key]);
} 
```

ECMAScript 8 添加了[`Object.entries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)避免在原始对象中查找每个值的功能：

```
Object.entries(obj).forEach(
    ([key, value]) => console.log(key, value)
); 
```

您可以组合`for...of`、解构和`Object.entries`：

```
for (const [key, value] of Object.entries(obj)) {
    console.log(key, value);
} 
```

两者`Object.keys()`和以与循环`Object.entries()`相同的顺序迭代属性，*但忽略原型链*。只有对象自己的可枚举属性被迭代。`for...in`

 ** * *

## 回答 #3

> 赞同：366
> 
> 时间：2009-03-26T06:12:16.960

您必须使用**for-in 循环**

但是在使用这种循环时要非常小心，因为这会**循环原型链上的所有属性**。

因此，在使用 for-in 循环时，请始终使用该`hasOwnProperty`方法来确定迭代中的当前属性是否真的是您正在检查的对象的属性：

```
for (var prop in p) {
    if (!p.hasOwnProperty(prop)) {
        //The current property is not a direct property of p
        continue;
    }
    //Do your logic with the property here
} 
```

* * *

## 回答 #4

> 赞同：262
> 
> 时间：2013-01-20T17:58:26.900

如果我们不提到循环对象的替代方法，这个问题就不会完整。

如今，许多著名的 JavaScript 库都提供了自己的方法来迭代集合，即遍历*数组*、*对象*和*类数组对象*。这些方法使用方便，完全兼容任何浏览器。

1.  如果您使用**jQuery**，您可以使用[`jQuery.each()`](http://api.jquery.com/jQuery.each/)方法。它可用于无缝迭代对象和数组：

    ```
    $.each(obj, function(key, value) {
        console.log(key, value);
    }); 
    ```

2.  在**Underscore.js**中，您可以找到 method [`_.each()`](http://underscorejs.org/#each)，它遍历元素列表，将每个元素依次生成给提供的函数（注意*iteratee*函数中参数的顺序！）：

    ```
    _.each(obj, function(value, key) {
        console.log(key, value);
    }); 
    ```

3.  **Lo-Dash**提供了几种迭代对象属性的方法。Basic [`_.forEach()`](http://lodash.com/docs#forEach)（或它的别名`_.each()`）对于循环遍历对象和数组很有用，但是（！）具有`length`属性的对象被视为数组，为了避免这种行为，建议使用[`_.forIn()`](http://lodash.com/docs#forIn)and[`_.forOwn()`](http://lodash.com/docs#forOwn)方法（这些也有`value`首先出现的参数）：

    ```
    _.forIn(obj, function(value, key) {
        console.log(key, value);
    }); 
    ```

    `_.forIn()`迭代对象*自己的和继承*的可枚举属性，而`_.forOwn()`仅迭代对象*自己的*属性（基本上检查`hasOwnProperty`函数）。对于简单的对象和对象字面量，这些方法中的任何一个都可以正常工作。

通常，所有描述的方法与任何提供的对象具有相同的行为。除了使用本机`for..in`循环通常会比任何抽象*更快*，例如`jQuery.each()`，这些方法更容易使用，需要更少的编码并提供更好的错误处理。

* * *

## 回答 #5

> 赞同：64
> 
> 时间：2018-07-10T10:39:33.197

前言：

*   对象属性可以是*自己的*（属性在对象本身上）或*继承*（不在对象本身上，在其原型之一上）。
*   对象属性可以是*enumerable*或*non-enumerable*。不可枚举的属性被排除在许多属性枚举/数组之外。
*   属性名称可以是字符串或符号。名称为符号的属性被排除在许多属性枚举/数组之外。

在 2018 年，您可以选择循环遍历对象的属性（列表后面有一些示例）：

1.  **`for-in`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/for...in) , [spec](https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements) ] — 一种循环结构，遍历对象的*可枚举*属性的名称，包括继承的属性，其名称为字符串
2.  **`Object.keys`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) , [spec](https://tc39.github.io/ecma262/#sec-object.keys) ] — 一个函数，提供一个对象*自己*的名称数组，其名称是字符串的*可枚举属性。*
3.  **`Object.values`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/values) , [spec](https://tc39.github.io/ecma262/#sec-object.values) ] — 一个函数，提供对象*自身的*可*枚举*属性的*值*数组。
***   **`Object.entries`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/entries) , [spec](https://tc39.github.io/ecma262/#sec-object.entries) ] — 一个函数，提供对象*自己的*可*枚举属性的名称**和*值的数组（数组中的每个条目都是一个数组）。**`[name, value]`*****   **`Object.getOwnPropertyNames`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames) , [spec](https://tc39.github.io/ecma262/#sec-object.getownpropertynames) ] — 一个函数，提供一个对象*自身*属性（甚至是不可枚举的属性）的名称数组，其名称是字符串。*   **`Object.getOwnPropertySymbols`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertySymbols) , [spec ] — 一个函数，提供名称为符号的对象](https://tc39.github.io/ecma262/#sec-object.getownpropertysymbols)*自身*属性（甚至是不可枚举的属性）的名称数组。*   **`Reflect.ownKeys`**[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Reflect/ownKeys) , [spec ] — 提供对象](https://tc39.github.io/ecma262/#sec-reflect.ownkeys)*自身*属性（甚至是不可枚举属性）名称数组的函数，无论这些名称是字符串还是符号。*   如果您想要一个对象的**所有**属性，包括不可枚举的继承属性，您需要在原型链中的每个对象上使用循环和`Object.getPrototypeOf`[ [MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf) , [spec](https://tc39.github.io/ecma262/#sec-object.getprototypeof) ] 和 use `Object.getOwnPropertyNames`, `Object.getOwnPropertySymbols`, or `Reflect.ownKeys`（本答案底部的示例）。****

 **对于除 之外的所有这些`for-in`，您将在数组上使用某种循环构造（`for`、`for-of`、`forEach`等）。

例子：

**`for-in`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const name in o) {
    const value = o[name];
    console.log(`${name} = ${value}`);
}
```

**`Object.keys`** *（带有`for-of`循环，但您可以使用任何循环结构）*：

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const name of Object.keys(o)) {
    const value = o[name];
    console.log(`${name} = ${value}`);
}
```

**`Object.values`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const value of Object.values(o)) {
    console.log(`${value}`);
}
```

**`Object.entries`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const [name, value] of Object.entries(o)) {
    console.log(`${name} = ${value}`);
}
```

**`Object.getOwnPropertyNames`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const name of Object.getOwnPropertyNames(o)) {
    const value = o[name];
    console.log(`${name} = ${value}`);
}
```

**`Object.getOwnPropertySymbols`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const name of Object.getOwnPropertySymbols(o)) {
    const value = o[name];
    console.log(`${String(name)} = ${value}`);
}
```

**`Reflect.ownKeys`：**

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (const name of Reflect.ownKeys(o)) {
    const value = o[name];
    console.log(`${String(name)} = ${value}`);
}
```

**所有属性**，包括继承的不可枚举的：

```
// A prototype object to inherit from, with a string-named property
const p = {answer: 42};
// The object we'll look at, which inherits from `p`
const o = Object.create(p);
// A string-named property
o.question = "Life, the Universe, and Everything";
// A symbol-named property
o[Symbol("author")] = "Douglas Adams";
for (let depth = 0, current = o; current; ++depth, current = Object.getPrototypeOf(current)) {
    for (const name of Reflect.ownKeys(current)) {
        const value = o[name];
        console.log(`[${depth}] ${String(name)} = ${String(value)}`);
    }
}
```

```
.as-console-wrapper {
  max-height: 100% !important;
}
```

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2009-03-26T06:05:01.797

你可以像这样迭代它：

```
for (var key in p) {
  alert(p[key]);
} 
```

请注意，`key`不会采用属性的值，它只是一个索引值。

* * *

## 回答 #7

> 赞同：56
> 
> 时间：2013-11-16T19:59:49.307

在 ECMAScript 5 中，您在文字的迭代字段中有新的方法 -`Object.keys`

您可以在[MDN上看到更多信息](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)

我的选择是在当前版本的浏览器（Chrome30、IE10、FF25）中作为更快的解决方案

```
var keys = Object.keys(p),
    len = keys.length,
    i = 0,
    prop,
    value;
while (i < len) {
    prop = keys[i];
    value = p[prop];
    i += 1;
} 
```

[您可以将此方法的性能与jsperf.com](http://jsperf.com/)上的不同实现进行比较：

*   [扩展实现](http://jsperf.com/extendimplementations/2)
*   [对象键迭代](http://jsperf.com/object-keys-iteration/30)
*   [对象字面量迭代](http://jsperf.com/object-literal-iteration/5)

您可以在[Kangax 的兼容表上看到浏览器支持](http://kangax.github.io/es5-compat-table/#Object.keys)

对于旧浏览器，你有[简单](http://tokenposts.blogspot.com.au/2012/04/javascript-objectkeys-browser.html)而[完整](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)的 polyfill

**升级版：**

此问题中所有最流行案例的性能比较`perfjs.info`：

[对象字面量迭代](http://perfjs.info/#!/384A61CA-DA2E-4FD2-A113-080010D4A42B)

* * *

## 回答 #8

> 赞同：41
> 
> 时间：2020-03-06T17:36:13.543

## 表现

今天 2020.03.06 我在 MacOs High Sierra v10.13.6 上的 Chrome v80.0、Safari v13.0.5 和 Firefox 73.0.1 上执行所选解决方案的测试

### 结论

*   基于`for-in`(A,B) 的解决方案对于大小对象的所有浏览器来说都是快速（或最快）的
*   令人惊讶的是`for-of`(H) 解决方案在 chrome 上对于大小物体来说速度很快
*   基于显式索引`i`(J,K) 的解决方案在所有浏览器上对小对象都非常快（对于 firefox，对于大对象也很快，但在其他浏览器上速度中等）
*   基于迭代器 (D,E) 的解决方案最慢，不推荐
*   解决方案 C 对于大物体来说是慢的，对于小物体来说是中慢的

[![在此处输入图像描述](https://i.stack.imgur.com/M6NzO.png)](https://i.stack.imgur.com/M6NzO.png)

### 细节

进行了性能测试

*   小对象 - 有 3 个字段 - 您可以在您的机器上执行测试[这里](https://jsbench.me/wok7em87k8/1)
*   '大' 对象 - 有 1000 个字段 - 你可以在你的机器上执行测试[这里](https://jsbench.me/0pk7emfoy9/1)

下面的片段介绍了使用的解决方案

```
function A(obj,s='') {
	for (let key in obj) if (obj.hasOwnProperty(key)) s+=key+'->'+obj[key] + ' ';
  return s;
}

function B(obj,s='') {
	for (let key in obj) s+=key+'->'+obj[key] + ' ';
  return s;
}

function C(obj,s='') {
  const map = new Map(Object.entries(obj));
	for (let [key,value] of map) s+=key+'->'+value + ' ';
  return s;
}

function D(obj,s='') {
  let o = { 
    ...obj,
    *[Symbol.iterator]() {
      for (const i of Object.keys(this)) yield [i, this[i]];    
    }
  }
  for (let [key,value] of o) s+=key+'->'+value + ' ';
  return s;
}

function E(obj,s='') {
  let o = { 
    ...obj,
    *[Symbol.iterator]() {yield *Object.keys(this)}
  }
  for (let key of o) s+=key+'->'+o[key] + ' ';
  return s;
}

function F(obj,s='') {
	for (let key of Object.keys(obj)) s+=key+'->'+obj[key]+' ';
  return s;
}

function G(obj,s='') {
	for (let [key, value] of Object.entries(obj)) s+=key+'->'+value+' ';
  return s;
}

function H(obj,s='') {
	for (let key of Object.getOwnPropertyNames(obj)) s+=key+'->'+obj[key]+' ';
  return s;
}

function I(obj,s='') {
	for (const key of Reflect.ownKeys(obj)) s+=key+'->'+obj[key]+' ';
  return s;
}

function J(obj,s='') {
  let keys = Object.keys(obj);
	for(let i = 0; i < keys.length; i++){
    let key = keys[i];
    s+=key+'->'+obj[key]+' ';
  }
  return s;
}

function K(obj,s='') {
  var keys = Object.keys(obj), len = keys.length, i = 0;
  while (i < len) {
    let key = keys[i];
    s+=key+'->'+obj[key]+' ';
    i += 1;
  }
  return s;
}

function L(obj,s='') {
  Object.keys(obj).forEach(key=> s+=key+'->'+obj[key]+' ' );
  return s;
}

function M(obj,s='') {
  Object.entries(obj).forEach(([key, value]) => s+=key+'->'+value+' ');
  return s;
}

function N(obj,s='') {
  Object.getOwnPropertyNames(obj).forEach(key => s+=key+'->'+obj[key]+' ');
  return s;
}

function O(obj,s='') {
  Reflect.ownKeys(obj).forEach(key=> s+=key+'->'+obj[key]+' ' );
  return s;
}

// TEST

var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};
let log = (name,f) => console.log(`${name} ${f(p)}`)

log('A',A);
log('B',B);
log('C',C);
log('D',D);
log('E',E);
log('F',F);
log('G',G);
log('H',H);
log('I',I);
log('J',J);
log('K',K);
log('L',L);
log('M',M);
log('N',N);
log('O',O);
```

```
This snippet only presents choosen solutions
```

这是 chrome 上小物体的结果

[![在此处输入图像描述](https://i.stack.imgur.com/z8KJL.png)](https://i.stack.imgur.com/z8KJL.png)

* * *

## 回答 #9

> 赞同：33
> 
> 时间：2016-08-27T09:06:28.797

由于 es2015 越来越受欢迎，我发布了这个答案，其中包括使用生成器和迭代器来平滑地迭代`[key, value]`对。就像在其他语言中一样，例如 Ruby。

好的，这是一个代码：

```
const MyObject = {
  'a': 'Hello',
  'b': 'it\'s',
  'c': 'me',
  'd': 'you',
  'e': 'looking',
  'f': 'for',
  [Symbol.iterator]: function*() {
    for (const i of Object.keys(this)) {
      yield [i, this[i]];
    }
  }
};

for (const [k, v] of MyObject) {
  console.log(`Here is key ${k} and here is value ${v}`);
}
```

有关如何创建迭代器和生成器的所有信息，您可以在开发人员 Mozilla 页面上找到。

希望它对某人有所帮助。

**编辑：**

ES2017 将包括`Object.entries`这将使迭代`[key, value]`对象中的对更加容易。现在知道，根据[ts39](https://github.com/tc39/proposal-object-values-entries)阶段信息，它将成为标准的一部分。

我认为是时候更新我的答案，让它变得比现在更新鲜。

```
const MyObject = {
  'a': 'Hello',
  'b': 'it\'s',
  'c': 'me',
  'd': 'you',
  'e': 'looking',
  'f': 'for',
};

for (const [k, v] of Object.entries(MyObject)) {
  console.log(`Here is key ${k} and here is value ${v}`);
}
```

[您可以在MDN](https://developer.mozilla.org/pl/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)页面上找到更多关于使用的信息

* * *

## 回答 #10

> 赞同：32
> 
> 时间：2009-03-26T06:04:10.053

```
for(key in p) {
  alert( p[key] );
} 
```

注意：您可以对数组执行此操作，但您也将遍历 the`length`和其他属性。

* * *

## 回答 #11

> 赞同：21
> 
> 时间：2011-08-18T20:50:22.940

在查看了这里的所有答案后，我自己的使用不需要 hasOwnProperty，因为我的 json 对象是干净的；添加任何额外的javascript处理真的没有意义。这就是我正在使用的所有内容：

```
for (var key in p) {
    console.log(key + ' => ' + p[key]);
    // key is key
    // value is p[key]
} 
```

* * *

## 回答 #12

> 赞同：20
> 
> 时间：2012-12-09T05:05:51.860

通过带有**forEach()的****原型**，它应该跳过**原型链**属性：

 ****```
Object.prototype.each = function(f) {
    var obj = this
    Object.keys(obj).forEach( function(key) { 
        f( key , obj[key] ) 
    });
}

//print all keys and values
var obj = {a:1,b:2,c:3}
obj.each(function(key,value) { console.log(key + " " + value) });
// a 1
// b 2
// c 3 
```

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2016-06-28T09:42:22.837

有趣的是，这些答案中的人都触及了两者`Object.keys()`，`for...of`但从未将它们结合起来：

```
var map = {well:'hello', there:'!'};
for (let key of Object.keys(map))
    console.log(key + ':' + map[key]); 
```

[你不能仅仅因为它`for...of`不是`Object`迭代器，并且or`for...index`是丑陋/低效的。 我很高兴大多数人都避免（有或没有检查），因为这也有点混乱，所以除了我上面的回答之外，我在这里说......`.forEach()``Object.keys()`
`for...in``.hasOwnProperty()`]

* * *

**你可以让普通的对象关联迭代！行为就像`Map`s 直接使用在 Chrome 和 FF 中工作的精美`for...of`**
[DEMO](http://codepen.io/Hashbrown/pen/mEWadp)（我假设仅 ES6）

```
var ordinaryObject = {well:'hello', there:'!'};
for (let pair of ordinaryObject)
    //key:value
    console.log(pair[0] + ':' + pair[1]);

//or
for (let [key, value] of ordinaryObject)
    console.log(key + ':' + value); 
```

只要你在下面包括我的垫片：

```
//makes all objects iterable just like Maps!!! YAY
//iterates over Object.keys() (which already ignores prototype chain for us)
Object.prototype[Symbol.iterator] = function() {
    var keys = Object.keys(this)[Symbol.iterator]();
    var obj = this;
    var output;
    return {next:function() {
        if (!(output = keys.next()).done)
            output.value = [output.value, obj[output.value]];
        return output;
    }};
}; 
```

无需创建一个没有漂亮语法糖的真实 Map 对象。

```
var trueMap = new Map([['well', 'hello'], ['there', '!']]);
for (let pair of trueMap)
    console.log(pair[0] + ':' + pair[1]); 
```

事实上，有了这个 shim，如果您仍然想利用 Map 的其他功能（而不是全部填充）但仍然想使用整洁的对象表示法，因为对象现在是可迭代的，您现在可以从中制作一个 Map！

```
//shown in demo
var realMap = new Map({well:'hello', there:'!'}); 
```

* * *

**对于那些不喜欢 shim 或`prototype`一般不喜欢弄乱的人，请随意在 window 上创建该功能，并称其为`getObjIterator()`then ；**

```
//no prototype manipulation
function getObjIterator(obj) {
    //create a dummy object instead of adding functionality to all objects
    var iterator = new Object();

    //give it what the shim does but as its own local property
    iterator[Symbol.iterator] = function() {
        var keys = Object.keys(obj)[Symbol.iterator]();
        var output;

        return {next:function() {
            if (!(output = keys.next()).done)
                output.value = [output.value, obj[output.value]];
            return output;
        }};
    };

    return iterator;
} 
```

现在您可以将其作为普通函数调用，不影响其他任何内容

```
var realMap = new Map(getObjIterator({well:'hello', there:'!'})) 
```

或者

```
for (let pair of getObjIterator(ordinaryObject)) 
```

[没有理由不这样做。](https://jsfiddle.net/4dkos9mw/16/)

欢迎来到未来。

* * *

## 回答 #14

> 赞同：17
> 
> 时间：2019-08-13T07:14:45.193

您还可以使用 Object.keys() 并遍历对象键，如下所示：

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};

Object.keys(p).forEach((key)=> {
 console.log(key +' -> '+ p[key]);
});
```

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2012-02-21T11:22:41.743

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};

for (var key in p) {
    if (p.hasOwnProperty(key)) {
        console.log(key + " = " + p[key]);
    }
}
```

```
<p>
  Output:<br>
  p1 = values1<br>
  p2 = values2<br>
  p3 = values3
</p>
```

* * *

## 回答 #16

> 赞同：16
> 
> 时间：2021-08-28T12:51:12.607

单行和更具可读性的代码可以是..

```
Object.entries(myObject).map(([key, value]) => console.log(key, value)) 
```

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2019-10-30T21:05:02.000

**使用`for-of`开`Object.keys()`**

像：

```
let object = {
  "key1": "value1",
  "key2": "value2",
  "key3": "value3"
};

for (let key of Object.keys(object)) {
  console.log(key + " : " + object[key])
}
```

* * *

## 回答 #18

> 赞同：13
> 
> 时间：2015-06-22T09:52:04.423

> Object.keys(obj) : 数组
> 
> 检索所有可枚举的自有（非继承）属性的所有字符串值键。

因此，通过使用 hasOwnProperty 测试每个对象键，它提供了与您想要的相同的键列表。您不需要额外的测试操作，并且`Object.keys( obj ).forEach(function( key ){})`应该更快。让我们证明一下：

```
var uniqid = function(){
			var text = "",
					i = 0,
					possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
			for( ; i < 32; i++ ) {
					text += possible.charAt( Math.floor( Math.random() * possible.length ) );
			}
			return text;
		}, 
		CYCLES = 100000,
		obj = {}, 
		p1,
		p2,
		p3,
		key;

// Populate object with random properties
Array.apply( null, Array( CYCLES ) ).forEach(function(){
	obj[ uniqid() ] = new Date()
});

// Approach #1
p1 = performance.now();
Object.keys( obj ).forEach(function( key ){
	var waste = obj[ key ];
});

p2 = performance.now();
console.log( "Object.keys approach took " + (p2 - p1) + " milliseconds.");

// Approach #2
for( key in obj ) {
	if ( obj.hasOwnProperty( key ) ) {
		var waste = obj[ key ];
	}
}

p3 = performance.now();
console.log( "for...in/hasOwnProperty approach took " + (p3 - p2) + " milliseconds.");
```

在我的 Firefox 中，我有以下结果

*   Object.keys 方法耗时 40.21101451665163 毫秒。
*   for...in/hasOwnProperty 方法花费了 98.26163508463651 毫秒。

PS。在 Chrome 上差异更大[http://codepen.io/dsheiko/pen/JdrqXa](http://codepen.io/dsheiko/pen/JdrqXa)

PS2：在 ES6（EcmaScript 2015）中，您可以更好地迭代可迭代对象：

```
let map = new Map().set('a', 1).set('b', 2);
for (let pair of map) {
    console.log(pair);
}

// OR 
let map = new Map([
    [false, 'no'],
    [true,  'yes'],
]);
map.forEach((value, key) => {
    console.log(key, value);
});
```

* * *

## 回答 #19

> 赞同：12
> 
> 时间：2018-09-11T05:55:01.460

在最新的 ES 脚本中，您可以执行以下操作：

```
let p = {foo: "bar"};
for (let [key, value] of Object.entries(p)) {
  console.log(key, value);
}
```

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2015-04-21T12:02:33.783

只有没有依赖关系的 JavaScript 代码：

```
var p = {"p1": "value1", "p2": "value2", "p3": "value3"};
keys = Object.keys(p);   // ["p1", "p2", "p3"]

for(i = 0; i < keys.length; i++){
  console.log(keys[i] + "=" + p[keys[i]]);   // p1=value1, p2=value2, p3=value3
} 
```

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2017-11-16T20:04:39.557

该`Object.keys()`方法返回给定对象自己的可枚举属性的数组。[在此处](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)阅读有关它的更多信息

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};

Object.keys(p).map((key)=> console.log(key + "->" + p[key]))
```

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2017-12-20T04:42:57.763

这是另一种遍历对象的方法。

```
 var p = {
"p1": "value1",
"p2": "value2",
"p3": "value3"
};

Object.keys(p).forEach(key => { console.log(key, p[key]) })
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2020-01-04T11:13:47.733

在javascript中迭代对象的多种方法

使用**for...in**循环

```
 var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};
for (let key in p){
   if(p.hasOwnProperty(key)){
     console.log(`${key} : ${p[key]}`)
   }
}
```

使用**for...of**循环

```
 var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};
for (let key of Object.keys(p)){
     console.log(`key: ${key} & value: ${p[key]}`)
}
```

将[forEach()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)与**Object.keys**、**Object.values**、**Object.entries一起使用**

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3"
};
Object.keys(p).forEach(key=>{
   console.log(`${key} : ${p[key]}`);
});
Object.values(p).forEach(value=>{
   console.log(value);
});
Object.entries(p).forEach(([key,value])=>{
    console.log(`${key}:${value}`)
})
```

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2016-06-18T02:11:52.193

使用纯 JavaScript 时，循环会非常有趣。似乎只有 ECMA6（新的 2015 JavaScript 规范）才能控制循环。不幸的是，在我写这篇文章时，浏览器和流行的集成开发环境 (IDE) 仍在努力完全支持新的花里胡哨。

下面是 ECMA6 之前的 JavaScript 对象循环的外观：

```
for (var key in object) {
  if (p.hasOwnProperty(key)) {
    var value = object[key];
    console.log(key); // This is the key;
    console.log(value); // This is the value;
  }
} 
```

另外，我知道这超出了这个问题的范围，但是在 2011 年，ECMAScript 5.1 添加了`forEach`仅用于数组的方法，它基本上创建了一种新的改进方法来循环遍历数组，同时仍然留下旧的冗长和令人困惑的`for`循环的不可迭代对象。但奇怪的是，这种新`forEach`方法不支持`break`导致各种其他问题。

基本上在 2011 年，除了许多流行的库（jQuery、Underscore 等）决定重新实现之外，没有真正可靠的循环 JavaScript 方法。

截至 2015 年，我们现在有了更好的开箱即用方式来循环（和中断）任何对象类型（包括数组和字符串）。当推荐成为主流时，JavaScript 中的循环最终会是这样的：

```
for (let [key, value] of Object.entries(object)) {
    console.log(key); // This is the key;
    console.log(value); // This is the value;
} 
```

请注意，截至 2016 年 6 月 18 日，大多数浏览器将不支持上述代码。即使在 Chrome 中，您也需要启用此特殊标志才能使其工作：`chrome://flags/#enable-javascript-harmony`

在这成为新标准之前，仍然可以使用旧方法，但在流行的库中也有替代方案，甚至对于那些不使用任何这些库的人来说，也有[轻量级的替代方案。](https://github.com/nbouvrette/forEach)

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2016-11-22T20:46:31.383

您可以为所有对象添加一个简单的*forEach*函数，这样您就可以自动循环遍历任何对象：

```
Object.defineProperty(Object.prototype, 'forEach', {
    value: function (func) {
        for (var key in this) {
            if (!this.hasOwnProperty(key)) {
                // skip loop if the property is from prototype
                continue;
            }
            var value = this[key];
            func(key, value);
        }
    },
    enumerable: false
}); 
```

对于那些不喜欢“ *for ... in* ”方法的人：

```
Object.defineProperty(Object.prototype, 'forEach', {
    value: function (func) {
        var arr = Object.keys(this);
        for (var i = 0; i < arr.length; i++) {
            var key = arr[i];
            func(key, this[key]);
        }
    },
    enumerable: false
}); 
```

现在，您可以简单地调用：

```
p.forEach (function(key, value){
    console.log ("Key: " + key);
    console.log ("Value: " + value);
}); 
```

如果您不想与其他 forEach-Methods 发生冲突，您可以使用您的唯一名称命名它。

* * *

## 回答 #26

> 赞同：6
> 
> 时间：2020-02-22T20:38:36.533

在可枚举的 JavaScript 对象上循环的一种好方法是 using`Object.keys`或`Object.entries`with using`map`函数，这对于 ReactJS 来说可能很棒而且很常见。如下所示：

```
// assume items:

const items = {
  first: { name: 'phone', price: 400 },
  second: { name: 'tv', price: 300 },
  third: { name: 'sofa', price: 250 },
}; 
```

用于循环并显示一些 UI，`ReactJS`如下所示：

```
~~~
<div>
  {Object.entries(items).map(([key, ({ name, price })]) => (
    <div key={key}>
     <span>name: {name}</span>
     <span>price: {price}</span>
    </div>
  ))}
</div> 
```

实际上，我使用了两次解构赋值，一次用于获取，`key`一次用于获取`name`和`price`。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2015-07-09T08:22:46.417

我会这样做，而不是`obj.hasOwnerProperty`在每个`for ... in`循环中检查。

```
var obj = {a : 1};
for(var key in obj){
    //obj.hasOwnProperty(key) is not needed.
    console.log(key);
}
//then check if anybody has messed the native object. Put this code at the end of the page.
for(var key in Object){
    throw new Error("Please don't extend the native object");
} 
```

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2016-09-20T09:04:34.500

在 ES6 中，我们有众所周知的符号来公开一些以前的内部方法，您可以使用它来定义迭代器如何为该对象工作：

```
var p = {
    "p1": "value1",
    "p2": "value2",
    "p3": "value3",
    *[Symbol.iterator]() {
        yield *Object.keys(this);
    }
};

[...p] //["p1", "p2", "p3"] 
```

这将给出与使用 for...in es6 循环相同的结果。

```
for(var key in p) {
    console.log(key);
} 
```

但是了解您现在使用 es6 的能力很重要！

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2018-06-26T14:34:43.323

```
 var p =[{"username":"ordermanageadmin","user_id":"2","resource_id":"Magento_Sales::actions"},
{"username":"ordermanageadmin_1","user_id":"3","resource_id":"Magento_Sales::actions"}]
for(var value in p) {
    for (var key in value) {
        if (p.hasOwnProperty(key)) {
            console.log(key + " -> " + p[key]);
        }
    }
}
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2018-07-09T16:15:57.683

从 ES06 开始，您可以将对象的值作为数组获取

```
let arrValues = Object.values( yourObject) ; 
```

它返回对象值的数组，而不是从原型中提取值！！

[MDN 文档 Object.values()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/values)

和钥匙（在这里我已经回答了）

```
let arrKeys   = Object.keys(yourObject); 
```

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2015-09-12T16:31:40.660

如果您还想迭代**[不可枚举的属性](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty#Enumerable_attribute)**，您可以使用[`Object.getOwnPropertyNames(obj)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames)返回直接在给定对象上找到的所有属性（可枚举或不可枚举）的数组。

```
var obj = Object.create({}, {
  // non-enumerable property
  getFoo: {
    value: function() { return this.foo; },
    enumerable: false
  }
});

obj.foo = 1; // enumerable property

Object.getOwnPropertyNames(obj).forEach(function (name) {
  document.write(name + ': ' + obj[name] + '<br/>');
});
```

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2016-07-22T03:48:23.303

如果有人需要**使用条件遍历arrayObjects**：

```
var arrayObjects = [{"building":"A", "status":"good"},{"building":"B","status":"horrible"}];

for (var i=0; i< arrayObjects.length; i++) {
  console.log(arrayObjects[i]);

  for(key in arrayObjects[i]) {      

      if (key == "status" && arrayObjects[i][key] == "good") {

          console.log(key + "->" + arrayObjects[i][key]);
      }else{
          console.log("nothing found");
      }
   }
}
```

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2016-09-01T20:15:42.470

考虑到 ES6，我想添加我自己的糖勺，并提供另一种方法来迭代对象的属性。

由于普通的 JS 对象不是开箱即用的[可迭代](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Iteration_protocols)对象，因此我们无法使用`for..of`循环来迭代其内容。但是没有人能阻止我们**让它成为可迭代**的。

让我们有`book`对象。

```
let book = {
  title: "Amazing book",
  author: "Me",
  pages: 3
}

book[Symbol.iterator] = function(){

  let properties = Object.keys(this); // returns an array with property names
  let counter = 0;
  let isDone = false;

  let next = () => {
    if(counter >= properties.length){
      isDone = true;
    }
    return { done: isDone, value: this[properties[counter++]] }
  }

  return { next };
} 
```

既然我们已经做到了，我们可以这样使用它：

```
for(let pValue of book){
  console.log(pValue);
}
------------------------
Amazing book
Me
3 
```

或者，如果您知道 ES6[生成器](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*)的强大功能，那么您当然可以使上面的代码更短。

```
book[Symbol.iterator] = function *(){

  let properties = Object.keys(this);
  for (let p of properties){
    yield this[p];
  }

} 
```

当然，您可以将此类行为应用于所有对象，并在级别上进行`Object`迭代。`prototype`

```
Object.prototype[Symbol.iterator] = function() {...} 
```

此外，符合可迭代协议的对象可以与新的 ES2015 特征[扩展](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Spread_operator)运算符一起使用，因此我们可以将对象属性值作为数组读取。

```
let pValues = [...book];
console.log(pValues);
-------------------------
["Amazing book", "Me", 3] 
```

或者您可以使用[解构](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)赋值：

```
let [title, , pages] = book; // notice that we can just skip unnecessary values
console.log(title);
console.log(pages);
------------------
Amazing book
3 
```

您可以使用我上面提供的所有代码查看[**JSFiddle 。**](http://www.es6fiddle.net/isksh68n/)

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2022-02-03T15:10:02.263

```
Object.entries(myObject).map(([key, value]) => console.log(key, value)) 
```

你可以这样试试。`myObject`会是`{name: "", phone: ""}`某某，这会产生key和value。所以这里的关键是`name`，`phone`价值就像`dog`，`123123`。

例子`{name: "dog"}`

这里键是`name`，值是`dog`。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2018-10-24T19:51:03.820

`Object.entries()`功能：

```
var p = {
	    "p1": "value1",
	    "p2": "value2",
	    "p3": "value3"
	};

for (var i in Object.entries(p)){
	var key = Object.entries(p)[i][0];
	var value = Object.entries(p)[i][1];
	console.log('key['+i+']='+key+' '+'value['+i+']='+value);
}
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2017-10-10T18:57:33.187

我在使用 Angular 时遇到了类似的问题，这是我找到的解决方案。

**步骤 1.**获取所有对象键。使用 Object.keys。此方法返回给定对象自己的可枚举属性的数组。

**步骤 2.**创建一个空数组。这是所有属性都将存在的地方，因为您的新 ngFor 循环将指向该数组，我们必须全部捕获它们。 **步骤 3.**迭代 throw all 键，并将每个键推入您创建的数组中。这是代码中的样子。

```
 // Evil response in a variable. Here are all my vehicles.
let evilResponse = { 
  "car" : 
    { 
       "color" : "red",
       "model" : "2013"
    },
   "motorcycle": 
    { 
       "color" : "red",
       "model" : "2016"
    },
   "bicycle": 
    { 
       "color" : "red",
       "model" : "2011"
    }
}
// Step 1\. Get all the object keys.
let evilResponseProps = Object.keys(evilResponse);
// Step 2\. Create an empty array.
let goodResponse = [];
// Step 3\. Iterate throw all keys.
for (prop of evilResponseProps) { 
    goodResponse.push(evilResponseProps[prop]);
} 
```

这是原始帖子的链接。[https://medium.com/@papaponmx/looping-over-object-properties-with-ngfor-in-angular-869cd7b2ddcc](https://medium.com/@papaponmx/looping-over-object-properties-with-ngfor-in-angular-869cd7b2ddcc)

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2019-02-07T05:28:47.820

这是如何遍历一个 javascript 对象并将数据放入一个表中。

```
<body>
<script>
function createTable(objectArray, fields, fieldTitles) {
  let body = document.getElementsByTagName('body')[0];
  let tbl = document.createElement('table');
  let thead = document.createElement('thead');
  let thr = document.createElement('tr');

  for (p in objectArray[0]){
    let th = document.createElement('th');
    th.appendChild(document.createTextNode(p));
    thr.appendChild(th);

  }

  thead.appendChild(thr);
  tbl.appendChild(thead);

  let tbdy = document.createElement('tbody');
  let tr = document.createElement('tr');
  objectArray.forEach((object) => {
    let n = 0;
    let tr = document.createElement('tr');
    for (p in objectArray[0]){
      var td = document.createElement('td');
      td.appendChild(document.createTextNode(object[p]));
      tr.appendChild(td);
      n++;
    };
    tbdy.appendChild(tr);    
  });
  tbl.appendChild(tbdy);
  body.appendChild(tbl)
  return tbl;
}

createTable([
              {name: 'Banana', price: '3.04'}, // k[0]
              {name: 'Orange', price: '2.56'},  // k[1]
              {name: 'Apple', price: '1.45'}
           ])
</script>
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2017-11-13T16:05:12.827

对象在实现 .next() 方法时成为迭代器

```
const james = {
  name: 'James',
  height: `5'10"`,
  weight: 185,

  [Symbol.iterator]() {
    let properties = []
    for (let key of Object.keys(james)) {
      properties.push(key);
    }

    index = 0;
    return {
      next: () => {
        let key = properties[index];
        let value = this[key];
        let done = index >= properties.length - 1;
        index++;
        return {
          key,
          value,
          done
        };
      }
    };
  }

};

const iterator = james[Symbol.iterator]();

console.log(iterator.next().value); // 'James'
console.log(iterator.next().value); // `5'10`
console.log(iterator.next().value); // 185
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2018-02-07T11:22:18.420

如果您只想遍历属性，请使用上述答案之一，但是如果您想遍历包括函数在内的所有内容，那么您可能需要使用[Object.getOwnPropertyNames(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames)

```
for (let o of Object.getOwnPropertyNames(Math)) {
  console.log(o);
}
```

我有时使用它来快速测试具有简单输入和输出的对象上的所有功能。

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2018-02-26T02:42:25.670

*   单级缩进
*   单组括号
*   最高的浏览器兼容性
*   拥有自己的财产安全

```
var p = {"p1": "value1", "p2": "value2", "p3": "value3"};

for (var key in p) if (p.hasOwnProperty(key)) {
  var value = p[key];
  console.log(key, value);
}
```

* * *

## 回答 #41

> 赞同：-1
> 
> 时间：2019-06-08T18:26:18.083

如果您的应用程序是在创建字符串，一个很好的组合是 Object.keys、implode 和 .map 数组方法。例如，如果我们有一个像

```
var data = {
    key1: 10,
    key2: 'someString',
    key3: 3000
} 
```

..我们想生成“值是key1 = 10，key2 = someString，key3 = 3000。”

我们可以在一行代码中完成此操作：

```
var str = `The values are ${implode(', ', Object.keys(data).map(function(key){return `${key} = ${data[key]}`}))}.`; 
```

Implode 将数组折叠为字符串，并在元素之间插入分隔符（第一个参数）；.map 遍历返回数组的数组，其他答案已经很好地阐述了 Object.keys 。

* * *

## 回答 #42

> 赞同：-3
> 
> 时间：2016-04-14T11:27:20.940

从 ES2015 开始，您可以使用 for of 循环来直接访问元素：

```
// before ES2015
for(var key of elements){
  console.log(elements[key]);
}

// ES2015
for(let element of elements){
  console.log(element);
} 
```

希望这可以帮助某人。

* * *

## 回答 #43

> 赞同：-6
> 
> 时间：2014-06-08T05:55:06.610

因为询问者的 ['*最终目标是遍历一些键值对*'] 并且最后不寻找循环。

```
var p ={"p1":"value1","p2":"value2","p3":"value3"};
if('p1' in p){
  var val=p['p1'];
  ...
} 
```

# asp.net - 视频流 asp.net

> ID：684677
> 
> 赞同：2
> 
> 时间：2009-03-26T06:04:11.707
> 
> 标签：asp.net, video, streaming, buffering

我一直在制作一个 ASP 网站，在该网站中，我为用户提供了上传视频并在上传后查看它们的设施。我已经成功地将视频上传到我的服务器，但不知道如何在客户端页面上播放它。我想缓冲视频并将其流式传输到用户的浏览器，不希望他在播放前等待并下载整个视频。我该如何接近？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T06:08:54.627

您可以使用 windows mediaplayer 组件。这是[一篇](http://www.c-sharpcorner.com/UploadFile/scottlysle/CsharpWebVideo04212007133218PM/CsharpWebVideo.aspx)关于此的文章。你有没有想过使用银光？这是使用 Silverlight的[一个。](http://www.dotnetcurry.com/ShowArticle.aspx?ID=217)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T12:55:04.870

可能想尝试在您的服务器上安装[Windows Media Services并使用它。](http://www.microsoft.com/windows/windowsmedia/forpros/serve/prodinfo2008.aspx)

如何在这里：http: [//www.microsoft.com/windows/windowsmedia/howto/articles/webserver.aspx](http://www.microsoft.com/windows/windowsmedia/howto/articles/webserver.aspx)

此处的 API：http: [//msdn.microsoft.com/en-us/library/ms738748.aspx](http://msdn.microsoft.com/en-us/library/ms738748.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T13:12:55.543

您可能想看看[Video.Show](http://www.codeplex.com/videoshow)。

# c++ - 使用 WinAPI 规范化文件路径

> ID：684684
> 
> 赞同：11
> 
> 时间：2009-03-26T06:08:24.597
> 
> 标签：c++, c, windows, winapi, path

> **可能重复：**
> [确定两个路径是否引用 C/C++ 中的同一文件的最佳方法](https://stackoverflow.com/questions/562701/best-way-to-determine-if-two-path-reference-to-same-file-in-c-c)

给定两个可能具有不同大小写和斜杠（`'\'`vs `'/'`）的文件路径字符串，是否有一种快速的方法（不涉及编写我自己的函数）将两个路径标准化为相同的形式，或者至少测试它们的等效性？

我仅限于 WinAPI 和标准 C++。所有文件都是本地的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T07:12:54.240

我可以建议[PathCanonicalize](http://msdn.microsoft.com/en-us/library/bb773569(VS.85).aspx)吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-06-29T07:25:10.853

我找到了一篇博客文章，其中包含我所见过的最彻底、甚至最详尽的功能来解决这个问题。它可以处理任何事情，甚至是可怕的极端情况，例如`V:foo.txt`您使用`subst`命令映射`V:`到`Z:`但您已经习惯`subst`映射`Z:`到其他驱动器的地方；它循环直到所有`subst`命令都解开。网址：

[http://pdh11.blogspot.com/2009/05/pathcanonicalize-versus-what-it-says-on.html](http://pdh11.blogspot.com/2009/05/pathcanonicalize-versus-what-it-says-on.html)

我的项目是纯C代码，那个函数是C++。我开始翻译它，但后来我发现我可以通过一个函数调用获得我想要的规范化路径：GetLongPathName()。这不会处理可怕的极端情况，但它处理了我的迫切需求。

我发现`GetLongPathName("foo.txt")`只是返回`foo.txt`，但只是在文件名前面`./`加上我得到了规范化形式的扩展：

`GetLongPathName("./foo.txt")`，如果在目录中执行`C:\Users\steveha`，则返回`C:\Users\steveha\foo.txt`。

所以，在伪代码中：

如果路径名的第二个字符是 ':' 或第一个字符是 '/' 或 '\'，则只需调用 GetLongPathName() 否则，将“./”复制到临时缓冲区，然后将文件名复制到临时缓冲区 + 2 , 以获取前缀为“./”的文件名的副本，然后调用 GetLongPathName()。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-26T06:26:46.847

根据路径是否是相对的、是否包含“..”、连接点或 UNC 路径，这可能比您想象的要困难。最好的方法可能是在[这个答案中使用](https://stackoverflow.com/questions/562701/best-way-to-determine-if-two-path-reference-to-same-file-in-c-c/562773#562773)*GetFileInformationByHandle()*函数。

**编辑：**我同意 RBerteig 的评论，如果路径不指向本地文件，这可能变得很难甚至不可能做到。任何关于如何安全处理此案的评论将不胜感激。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T06:20:50.557

有奇怪的情况。例如，“c:\windows..\data\myfile.txt”与“c:\data.\myfile.txt”和“c:\data\myfile.txt”相同。您可以在其中包含任意数量的“\.\”和“\..\”。您可能会查看 Windows API 函数`GetFullPathName`。它可能会为您进行规范化。

# javascript - sIFR 3：背景透明？

> ID：684685
> 
> 赞同：0
> 
> 时间：2009-03-26T06:08:41.320
> 
> 标签：javascript, css, flash, sifr

我正在第一次使用 sIRF 作为在网站上实现特定排版的一种方式。这一切都很好，但我有一个问题，我希望背景是透明的。我已经查看了 sIRF wiki，但我不确定这是否可行..

有人知道这样做的方法吗？

我在这里有一个测试页面 > [http://www.bevelite.com.au/test](http://www.bevelite.com.au/test)

此处的 sIRF 文档 > [http://wiki.novemberborn.net/sifr3/](http://wiki.novemberborn.net/sifr3/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T08:38:11.290

最近我使用 Facelift，因为我发现它比 sIFR 更容易使用......但我相信要使背景透明，你可以这样做：

```
sIFR.replace(yourtypeface, {
      selector: 'h2.cpost-title',
      wmode: 'transparent'
}); 
```

# linq - NHibernate.Linq 和 MultiCriteria

> ID：684696
> 
> 赞同：12
> 
> 时间：2009-03-26T06:12:57.393
> 
> 标签：linq, nhibernate, linq-to-nhibernate

任何人都知道使用 NHibernate.Linq 批处理 NHibernate 查询的方法，就像您可以使用 MultiCriteria 和 ICriteria 对象一样？

使用 MultiCriteria 我可以创建如下内容：

```
var crit = session.CreateMultiCriteria()
                  .Add(session.CreateCriteria(typeof(Entity1)).Add(Restrictions.Eq("Property1","Value"))
                  .Add(session.CreateCriteria(typeof(Entity2)).Add(Restrictions.Eq("Property2","Value2"));               

var result = crit.List();
var list1 = (IList)result[0];
var list2 = (IList)result[1]; 
```

如果我用 Linq 调用替换 CreateCriteria 调用并得到如下内容会很好：

```
var crit = session.CreateMultiCriteria()
                .Add(session.Linq<Entity1>().Where(x => x.Property1 == "Value1")
                .Add(session.Linq<Entity2>().Where(x => x.Property2 == "Value2");

var result = crit.List();
var list1 = (IList<Entity1>)result[0];
var list2 = (IList<Entity2>)result[1]; 
```

我们对大多数其他查询使用 Linq API，当我们还需要运行 MultiCriteria 查询时，使用相同的 Linq 语法会很好。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T14:35:20.787

```
var query = from q in session.Linq<Person>()
            where q.FirstName.StartsWith(firstName)
            && q.LastName.StartsWith(lastName)
            && q.Phones.Any(p => p.Number.Contains(phone))
            select q;

// This block of code was found in the NHibernate.Linq source
// using NHibernate.Linq.Visitors;
// using NHibernate.Engine;
System.Linq.Expressions.Expression expression = query.Expression;
expression = Evaluator.PartialEval(expression);
expression = new BinaryBooleanReducer().Visit(expression);
expression = new AssociationVisitor((ISessionFactoryImplementor)session.SessionFactory).Visit(expression);
expression = new InheritanceVisitor().Visit(expression);
expression = CollectionAliasVisitor.AssignCollectionAccessAliases(expression);
expression = new PropertyToMethodVisitor().Visit(expression);
expression = new BinaryExpressionOrderer().Visit(expression);
NHibernateQueryTranslator translator = new NHibernateQueryTranslator(session);
object results = translator.Translate(expression, ((INHibernateQueryable)query).QueryOptions);

// My LINQ query converted to ICriteria
ICriteria resultsCriteria = results as ICriteria;
// Convert to criteria that returns the row count
ICriteria rowCountCriteria = CriteriaTransformer.TransformToRowCount(resultsCriteria);

IList multiResults = session.CreateMultiCriteria()
    .Add(resultsCriteria.SetMaxResults(20))
    .Add(rowCountCriteria)
    .List();

IList people = (IList)multiResults[0];
int resultsCount = (int)((IList)multiResults[1])[0]; 
```

来自[http://rndnext.blogspot.com/2009/05/using-nhibernate-multicriteria-and-linq.html](http://rndnext.blogspot.com/2009/05/using-nhibernate-multicriteria-and-linq.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T19:27:59.863

NHibernate.Linq 本身使用 NHibernateQueryTranslator 将 LINQ 表达式转换为 ICriteria。您也可以这样做，然后将生成的 ICriteria 传递到您的 IMultiCriteria。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T03:41:31.860

我有一个解决方案，可以使用 NHibernate Linq 对获取策略进行批处理，但代码是最复杂的。太多了，这里就不一一列举了。我很快就会在我的 devlicio.us 博客上谈论它。当我写第一篇文章时，我会更新这条评论。

# xml - 将 XMLDocument 转换为数据集 ASP.Net 1.1

> ID：684703
> 
> 赞同：2
> 
> 时间：2009-03-26T06:18:36.570
> 
> 标签：xml, dataset, asp.net-1.1

我需要在 ASP.Net 中将 XMLDocument 转换为 DataSet。我不想将 XMLData 保存到任何物理位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T06:26:04.227

您可以使用 xmlDocument 类读取 xml 文件并将数据保存到数据集。[这是一个](http://www.developer.com/net/csharp/article.php/3489611)关于如何使用 xmlDocument 读取 XML 文件的示例。

这段代码很老了。没试过

XmlDocument xdoc = MethodReturnsXmlDocument();

// 转换为数据集

数据集 ds = new DataSet();

ds.ReadXml(新 XmlNodeReader(xdoc));

[这](http://www.java2s.com/Code/VB/XML/LoadxmldocumenttoDataSet.htm)是给你的另一个例子。

# asp.net - ASP.NET 地图路径

> ID：684705
> 
> 赞同：0
> 
> 时间：2009-03-26T06:19:17.613
> 
> 标签：asp.net, string

我有一部分代码是这样的：

```
Process proc = null;
try
{
    proc = new Process();
    string dir = HttpContext.Current.Server.MapPath("~/Other/");
    proc.StartInfo.WorkingDirectory = dir;
    p.StartInfo.FileName = "batch.bat";
    p.StartInfo.CreateNoWindow = true;
    p.Start();
    p.WaitForExit();
}
catch (Exception e) { } 
```

只有当我将“dir”替换为

```
string.Format(@"C:\AbsolutePathHere") 
```

为什么？

**编辑：**代码在按钮单击事件处理程序中工作。当它是预定的 Quartz.NET 作业时，它不起作用。当我有绝对路径时，它总是有效。所以我的问题可能是：如何让 Quartz.NET 和 MapPath 玩得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T06:27:20.993

调用 MapPath 后的值或“目录”是什么？抛出什么异常？工作进程可能没有执行batch.bat 文件的权限。

没有更多的细节，很难给你一个明确的答案。

**编辑**您是否考虑过 Quartz.NET 无法访问 HttpContext.Current 并因此 MapPath 无法解析的事实？

**Edit2**是否可以使用 AppDomain.CurrentDomain.BaseDirectory 来确定您想要的路径而不是 ~ (tilda) 替换？我还看到了对 System.Web.Hosting.HostingEnvironment.MapPath() 的引用，您也可以尝试。

# windows - 我可以在 Visual Studio 2008 或至少在 Microsoft Windows 中重新分配键盘键吗？

> ID：684712
> 
> 赞同：0
> 
> 时间：2009-03-26T06:24:21.830
> 
> 标签：windows, visual-studio-2008

我相信你们中的大多数人都是，我厌倦了每次用 C# 或任何语言编写函数调用时都必须按 SHIFT 键。

那么，他们有什么方法可以让我的键盘上的“[”键在屏幕上输入“（”，同时让“]”键在屏幕上输入“）”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:04:18.690

如果您安装 Windows 资源工具包，则有一个未提及但位于目录中的实用程序，称为 RemapKeys。

我用它来将 CAPS-LOCK 向下移动到右侧的 windows 键（很好而且不碍事），并使 CAPS LOCK 和 INSERT 键成为 SHIFT 键。不确定您是否可以使用它来改变班次行为。

当然，这样做还有一个问题——不要指望任何朋友/同事在他们接管你的键盘打字并且键帽对他们的行为撒谎时感谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T06:29:04.157

我使用[SharpKeys](http://www.randyrants.com/sharpkeys/) - 我的目的是关闭 CAPSLOCK。其实我只是把它映射到CTRL。但它会将任何键重新映射到任何其他键。它在所有 Windows 中重新映射 - 我认为您无法让它重新映射特定应用程序的键。

编辑：澄清 - SharpKeys 是将键盘映射数据插入 Windows 注册表的实用程序。SharpKeys 不会主动重新映射键。它是一种用于生成键映射并将该键映射放入注册表以便进行键映射的工具。

您可以使用 regedit 自己进行键映射。但是使用 SharpKeys 更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T06:45:13.323

[AutoHotKey](http://www.autohotkey.com/)是执行此操作的绝佳软件。

# java - 使用 Java 识别 2 个相同的图像

> ID：684713
> 
> 赞同：11
> 
> 时间：2009-03-26T06:24:48.457
> 
> 标签：java, image

我的网络爬虫出现问题，我试图从特定网站检索图像。问题是我经常看到完全相同但在 URL 中不同的图像，即它们的地址。

是否有任何 Java 库或实用程序可以识别 2 个图像的内容是否完全相同（即像素级）。

我的输入将是我可以下载它们的图像的 URL。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T06:44:19.283

我以前在 Java 中做过与此非常相似的事情，我发现 api 的[java.awt.image](http://java.sun.com/javase/6/docs/api/java/awt/image/package-summary.html)包中的 PixelGrabber 类非常有用（如果不是完全必要的话）。

此外，您肯定想查看[ColorConvertOp 类](http://java.sun.com/javase/6/docs/api/java/awt/image/ColorConvertOp.html)，该类可以对源图像中的数据执行逐像素颜色转换，并将生成的颜色值缩放到目标图像的精度。文档继续说，图像甚至可以是相同的图像，在这种情况下，检测它们是否相同将非常简单。

如果您正在检测相似性，则需要使用[该问题的答案中提到的某种形式的平均方法](https://stackoverflow.com/questions/684264/how-does-googles-image-color-search-work/684700#684700)

如果可以的话，还请查看 Horstman 的 Core Java（第 8 版）的第 2 卷第 7 章，因为有一大堆关于图像转换等的示例，但同样，请务必查看 java.awt.image 包，因为您应该会发现你几乎为你准备好了一切:)

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-26T06:35:21.617

取决于您想要使用它的详细程度：

*   下载图片
*   当你下载它时，会为它生成一个哈希
*   创建一个目录名称为哈希值的目录（如果该目录不存在）
*   如果目录包含 2 个或更多文件，则比较文件大小
*   如果文件大小相同，则将图像与文件中图像的字节进行逐字节比较
*   如果字节是唯一的，那么你有一个新图像

无论您是否想做所有这些，您都需要：

*   下载图片
*   对图像进行逐字节比较

无需依赖任何特殊的图像库，图像只是字节。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T06:39:25.537

查看 MessageDigest 类。本质上，您创建它的一个实例，然后将一系列字节传递给它。如果您知道两个“相同”的图像将是相同的文件/字节流，则字节可能是直接从 URL 加载的字节。或者，如果有必要，您可以从流中创建一个 BufferedImage，然后提取像素值，例如：

```
 MessageDigest md = MessageDigest.getInstance("MD5");
  ByteBuffer bb = ByteBuffer.allocate(4 * bimg.getWidth());
  for (int y = bimg.getHeight()-1; y >= 0; y--) {
    bb.clear();
    for (int x = bimg.getWidth()-1; x >= 0; x--) {
      bb.putInt(bimg.getRGB(x, y));
    }
    md.update(bb.array());
  }
  byte[] digBytes = md.digest(); 
```

无论哪种方式，MessageDigest.digest() 最终都会为您提供一个字节数组，它是图像的“签名”。如果有帮助，您可以将其转换为十六进制字符串，例如用于放入 HashMap 或数据库表，例如：

```
StringBuilder sb = new StringBuilder();
for (byte b : digBytes) {
  sb.append(String.format("%02X", b & 0xff));
}
String signature = sb.toString(); 
```

如果来自两个 URL 的内容/图像给您相同的签名，那么它们就是相同的图像。

**编辑：**我忘了提到，如果你在散列像素值，你可能也想在散列**中包含图像的尺寸**。（类似的事情——将两个整数写入一个 8 字节的 ByteBuffer，然后用相应的 8 字节数组更新 MessageDigest。）

另一件事是有人提到的是**MD5 不是*抗碰撞的***。换句话说，有一种技术可以使用相同的 MD5 哈希构造多个字节序列，而无需使用“蛮力”的反复试验方法（平均而言，您需要尝试大约 2^64 或碰撞前的 160 亿个文件）。这使得 MD5**不适*用于您试图防御这种威胁模型***的地方。如果你*不*担心有人可能*故意*尝试欺骗您的重复标识，而您只是担心“偶然”重复哈希的可能性，那么 MD5 绝对没问题。实际上，它不仅很好，而且实际上有点过分了——正如我所说，平均而言，你会期望在大约 160 亿个文件之后出现一个“错误重复”。或者换一种说法，比如说，你可能有十亿个文件，并且发生冲突的可能性非常接近于零。

如果您*担心*概述的威胁模型（即您认为有人可能故意将处理器时间用于构建文件以欺骗您的系统），那么解决方案是使用更强的哈希。Java 支持开箱即用的 SHA1（只需将“MD5”替换为“SHA1”）。现在这将为您提供更长的哈希值（160 位而不是 128 位），但根据目前的知识，发现冲突是不可行的。

就个人而言，我什至会考虑只使用一个像样的 64 位散列函数。这仍然允许将数千万张图像与几乎为零的误报机会进行比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T06:40:31.697

您还可以生成文件的 MD5 签名并忽略重复条目。但不会帮助您找到类似的图像。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T06:28:30.070

我认为您不需要图像库来执行此操作 - 只需获取 URL 内容并将两个流作为字节数组进行比较即可。

当然，除非您也有兴趣识别**相似**的图像。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T06:41:41.913

使用以下方法计算 MD5：

```
MessageDigest m=MessageDigest.getInstance("MD5");
m.update(image.getBytes(),0,image.length());
System.out.println("MD5: "+new BigInteger(1,m.digest()).toString(16)); 
```

将它们放在哈希图中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T10:24:56.410

已经建议使用散列，并且识别两个文件是否相同非常容易，但是您说的是像素级别。如果您想识别两个图像，即使它们采用不同的格式（.png/.jpg/.gif/..）并且即使它们被缩放，我建议：（使用图像库并且如果图像是中/大不16x16 图标）：

1.  将图像缩放到某个固定大小，这取决于样本
2.  例如，使用 RGB-YUV 转换将其转换为灰度，并从那里获取 Y（非常容易） 3 计算每个图像的汉明距离并设置阈值以决定它们是否相同。

您将对两个图像的所有灰色像素的差异求和，如果差异小于 T，您将获得一个数字，您认为两个图像相同

--

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-25T10:20:24.863

您可以使用以下方法比较图像：

**1）简单的逐像素比较**

当有一些移位、旋转、光照变化时，它不会给出很好的结果，......

**2）相对简单但更高级的方法**

[http://www.lac.inpe.br/JIPCookbook/6050-howto-compareimages.jsp](http://www.lac.inpe.br/JIPCookbook/6050-howto-compareimages.jsp)

**3）更高级的算法**

例如[RadpiMiner 和 IMMI 扩展](http://spl.utko.feec.vutbr.cz/en/component/content/article/46-image-processing-extension-for-rapidminer-5)包含几种图像比较算法，您可以尝试不同的方法并选择最适合您的目的...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T22:53:19.137

检查响应标头并询问**HTTP 标头 ETag 值**（如果存在）。( [RFC2616: ETag](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.19) ) 对于来自目标 Web 服务器的相同图像，它们可能相同。这是因为 ETag 值通常是像 MD5 这样的消息摘要，这将允许您利用网络服务器已经完成的计算。

这可能会让您甚至不下载图像！

```
for each imageUrl in myList
    Perform HTTP HEAD imageUrl
    Pull ETag value from request
    If ETag is in my map of known ETags
       move on to next image
    Else
       Download image
       Store ETag in map 
```

当然，ETag 必须存在，如果没有，那么这个想法就是吐司。但也许你已经与网络服务器管理员合作了？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-26T17:38:43.713

就在这几天前，我写了一个纯 Java 库。您可以使用目录路径（包括子目录）来提供它，它会列出列表中的重复图像以及您要删除的绝对路径。或者，您也可以使用它来查找目录中的所有唯一图像。

它在内部使用了 awt api，因此不能用于 Android。由于 imageIO 在读取很多新类型的图像时遇到问题，我正在使用内部使用的 12 个猴子 jar。

[https://github.com/srch07/Duplicate-Image-Finder-API](https://github.com/srch07/Duplicate-Image-Finder-API)

可以从 [https://github.com/srch07/Duplicate-Image-Finder-API/blob/master/archives/duplicate_image_finder_1.0.jar下载内部捆绑了依赖项的 Jar](https://github.com/srch07/Duplicate-Image-Finder-API/blob/master/archives/duplicate_image_finder_1.0.jar)

该 api 也可以在不同大小的图像中找到重复项。

# c++ - 当您收到类声明的编译错误“看起来像函数定义”时，这意味着什么？

> ID：684715
> 
> 赞同：15
> 
> 时间：2009-03-26T06:25:16.677
> 
> 标签：c++, visual-studio

我最近遇到了这个问题。我发现很多人问这个问题的例子——[例如这里](http://www.codeguru.com/forum/showthread.php?p=982326)——但没有具体的答案。

这是从该链接提升的示例代码：

```
class AFX_BASE_APPLICATION_APP_CLASS CFileExtension 
{
public:
   CFileExtension ();           
   virtual ~CFileExtension ();
}; 
```

这产生的错误是：

`c:\FileExtension.h(14) : error C2470: 'CFileExtension' : looks like a function definition, but there is no formal parameter list; skipping apparent body`

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-26T06:39:27.830

您几乎肯定错过了定义`AFX_BASE_APPLICATION_APP_CLASS`. 在这种情况下，它会原封不动地通过，VC++ 会假设这`CFileExtension`是一个返回的函数`class AFX_BASE_APPLICATION_APP_CLASS`。

而且，由于它认为它是一个函数，它也认为它需要括号。

您只需要找到`AFX_BASE_APPLICATION_APP_CLASS`定义的位置和`#include`该文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-05T08:48:11.190

我遇到了同样的编译器错误。问题是**缺少冒号**

我的代码是这样的：

```
int MyClass:doSomething() {

} 
```

它应该是：（注意 '::' 而不是 ':'

```
int MyClass::doSomething() {

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T06:34:40.430

...以及答案，因为我懒得登录这些论坛中的任何一个，但我已经有一个 OpenID :-)

在我的情况下（可能是我发现的所有情况），问题是我缺少一个 #include 用于包含类名之前的宏定义的头文件。该宏最有可能用作打开 __declspec(dllexport) 的构建配置切换方式。

我发现这一点的方法是进入项目属性“C/C++”| 预处理器并打开“生成预处理文件”。当我查看预处理的输出时，我发现宏被逐字包含而不是被扩展。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T06:54:02.240

只定义`AFX_BASE_APPLICATION_APP_CLASS`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-21T13:29:25.377

另一个可能的原因是使用 __declspec(dllimport) 而不是 __declspec(dllexport) 或根本没有 declspec 作为 Visual C++ 中的类/函数前缀。

如果你把它搞混了，你的班级也可能无法得到这样的认可，你会得到同样的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-06T19:30:54.637

我遇到了同样的问题，但没有一个解决方案有效。OP中发布的问题来自于包括课程：

```
class AFX_EXT_CLASS CMyClass : public CObject
{
public  :
// ....
} 
```

这是我想在控制台 exe 中使用的 dll 中的导出类。如果我在创建向导中将控制台应用程序创建为“使用 mfc”，则不会发生此错误，但该选项会导致创建应用程序的不同结构。

无论如何，我尝试包含各种标题，以便它知道`AFX_EXT_CLASS`，定义它但没有任何效果。长话短说，解决方案是我们必须为应用程序启用 MFC 才能理解从 dll 导出的 MFC 类。我们如何做到这一点是通过编辑`.vcproj`文件并插入`UseOfMFC="2"`如下所示的行：

```
<Configurations>
    <Configuration
        Name="Debug|Win32"
        OutputDirectory="$(SolutionDir)$(ConfigurationName)"
        IntermediateDirectory="$(ConfigurationName)"
        ConfigurationType="1"
        UseOfMFC="2" <-------------Insert this line here
        CharacterSet="1" 
```

还有`#include <afx.h>`stdafx.h （我在第一个包含之前将它包含在右上角）。

现在重新引导、清理和构建错误应该会消失。

没有其他方法可以从项目设置中更改此选项。此选项不同于`Project Properties >> Configuration Properties >> General >> 'Use of MFC'`.

**更新**

该`UseOfMFC="2"`技巧可能在其他地方有用，但显然如果您只是`#include <afx.h>`将设置更改为 `project properties >> General >> 'Use of MFC'`在共享 dll 中使用 MFC，那么这个错误就会消失。如果您不更改以后的设置，则会发生编译器错误

```
c:\program files (x86)\microsoft visual studio 8\vc\atlmfc\include\afx.h(24) : fatal error C1189: #error :  Building MFC application with /MD[d] (CRT dll version) requires MFC shared dll version. Please #define _AFXDLL or do not use /MD[d] 
```

更改它实际上也确实`UseOfMFC="2"`在项目文件中设置，所以这是正确的方法。

# php - TinyMCE：打包所有文件而不是动态加载它们......可能吗？

> ID：684725
> 
> 赞同：5
> 
> 时间：2009-03-26T06:29:50.473
> 
> 标签：php, javascript, tinymce

我正试图让 TinyMCE 工作。我已经尝试过使用包含 tiny_mce.js 的常规方法，然后使用 tinymce.init(...) 并且它可以工作。然后我尝试了 tiny_mce.gzip.js + php 压缩器，它可以工作，但它真的很慢。

现在我已经将我的 CSS 和 JS 文件打包成一个，并将我的所有文件连接在一起。在 Javascript 的情况下，它们也被缩小了。

在这两种情况下，它们都使用其中一个文件的时间戳进行版本控制，因此我的 URL 如下：

/script/script.1233454569.js

它重定向到一个 PHP 文件，该文件要么提供缓存版本，要么构建缓存版本（如果需要）并提供它。它添加了过期标头并进行 gzip 压缩，并且基本上运行良好。

我想将微型 mce 安装到这个机制中，但事实证明这很痛苦。顺序似乎很重要。目前我有：

*   tiny_mce.js
*   myscript.js
*   default_editor.js（来自简单主题）
*   en.js（同上）

但它提出了“你未定义”，我在谷歌上找不到合适的答案。这真的很烦人。有没有人有这方面的经验？

有没有其他编辑器更适合像我上面描述的那样打包，而不是将他们自己的计划强加给你（这让我很恼火）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T07:02:00.427

我试图做完全相同的事情，但花了太多时间尝试。最后，我决定使用 TinyMCE 提供的 GZip 压缩器，并专注于组合 CSS 文件和图像以满足我的需要。问题是 TinyMCE 非常庞大，它会动态加载所需的文件，并且不使用现有的 JavaScript 库，因此如果您已经在使用任何类型的库，它最终会复制大量相同的代码。[FCKEditor](http://www.fckeditor.net/)是我认为唯一具有相同功能和浏览器兼容性的其他编辑器，但在集成到我的缓存方案（听起来与您的相似）方面看起来并没有变得更容易，而且我认为许可使它成为我的非选择。你可以看一个[列表](http://www.geniisoft.com/showcase.nsf/WebEditors)这里有可用的编辑器，但我认为这两个是该列表中最好的。最后，我决定使用 TinyMCE，并将 MooTools 的 WYSIWYG 编辑器添加到我的待办事项列表中，因为这是我最常使用的 JavaScript 框架。

如果您要破解它，我建议您找出您的 TinyMCE 特定实现所需的每个脚本，按顺序组合它们，然后隔离并注释掉加载每个文件的代码。如果你很勇敢，你也可以尝试[打包](http://dean.edwards.name/packer/)合并的文件。如果你真的让它工作，我很想知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T11:03:47.473

我还尝试将 TinyMCE 连接到一个最小化的脚本中，这是我为使其工作所做的：

在`tiny_mce_src.js`改变这条线...

```
if (n.src && /tiny_mce(|_dev|_src|_gzip|_jquery|_prototype).js/.test(n.src)) { 
```

要么...

```
if (n.src && /YourFullScriptName.js/.test(n.src)) { 
```

甚至只是脚本名称的一部分......

```
if (n.src && /ullScriptNa/.test(n.src)) { 
```

正是这一行计算出 baseUrl，因此它可以加载 TinyMCE 需要的所有其他文件。问题是，由于许可证，我们不能这样做。通过在连接的 tiny_mce.js 文件之前添加它，我确实有一些希望......

```
var tinyMCEPreInit = {base : 'tinymce/jscripts/tiny_mce/'}; 
```

遵循[Spocke 的建议](http://tinymce.moxiecode.com/punbb/viewtopic.php?pid=29347#p29347 "斯波克的建议")，但我似乎也无法让它发挥作用。由于我们使用的是 Prototype，我唯一能想到的另一件事是动态加载 tiny `_`mce.js 或 tiny `_`mce `_`**gzip** .js 脚本，然后从那里初始化我们想要的文本区域。但我还远未完成它的工作。

希望这可以帮助，

干杯，

DJ戴夫马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-13T16:28:28.720

我启动了 Gzip 压缩器，并在渲染过程中将自己与 Fiddler 联系起来。

基本上这是我在浏览器中收到的内容并将其打包到一个自己的文件中。

肮脏但工作

# php - fms服务器的使用

> ID：684727
> 
> 赞同：0
> 
> 时间：2009-03-26T06:30:43.483
> 
> 标签：php, flash, flash-media-server

使用 Flash 媒体播放器时是否需要 fms 服务器？如何使用 Flash 播放器进行 http 流式传输？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T20:13:55.987

FMS 我猜你的意思是**RTMP 流**（反对**渐进式“流”**）？

点播 RTMP 流将准确地为您提供所请求内容的部分，而渐进式流将整个文件下载到客户端浏览器缓存中（与图像相同）。多亏了这一点，即使前面的部分尚未加载，您也可以跳转到视频中的某个位置，如果您正在处理较长的视频，这是一个很棒的功能。

渐进式视频更容易设置，因为您只需将其部署在简单的 HTTP 服务器上，这也可能是一个坏点，因为您可能会超载 HTTP 带宽，而 RTMP 流媒体服务可以托管在专门用于流媒体的专用服务器上这样您就可以实现最佳服务。FMS 3.5 提供动态流，这意味着流将根据用户带宽进行调整。

**基本上 ：**

如果视频是您网站的主要关注点，和/或您希望在质量和响应方面提供增强的用户体验，您应该选择 RTMP 流媒体（FMS、Red5 等）。否则不要使事情复杂化，只需将其上传到您的 HTTP 服务器并逐步下载即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T09:14:50.797

或者您可以使用[Mammoth](http://mammoth-project.org/)服务器（以前称为 OpenFMS）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T08:46:09.023

您可以尝试使用[Red5](http://code.google.com/p/red5/)。这里有[一些教程。](http://www.red5tutorials.net/index.php/Tutorials)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-24T19:26:36.830

你也可以使用[wowza](http://www.wowzamedia.com/)

[这里](http://askmeflash.com/article/10/comparison-wowza-vs-fms-vs-red5)是FMS、wowza和red5的对比

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-16T02:33:45.153

这是关于到 Flash 和 iOS 的 HTTP 流 (HDS)的[教程。](http://www.adobe.com/devnet/flashmediaserver/articles/stream-ondemand-flash-and-ios.html)

# c - 通过套接字传输文件，最终大小用更少的字节

> ID：684733
> 
> 赞同：6
> 
> 时间：2009-03-26T06:37:36.897
> 
> 标签：c, sockets, file-transfer

我试图通过 C 中的套接字接收一些文件。但是服务器向我发送了一个 1000000 字节文件的 64 字节数据包，我在目标文件上获得了大约 999902 字节。

```
while ((n = read(sd, buffer_in, BUFSIZE ))) //  BUFSIZE = 64 
{
    if(n<0)
    {
       printf("Fail.\n");
       fclose(archivo);
       return -1;
    }

    if(fwrite(buffer_in, n, 1, f) !=1 ) 
    { 
       printf("fwrite error.\n");
       fclose(archivo);
       return -1;
    }

    bytes+=n;
}

printf("We received %d bytes",  bytes); 
```

当通过本地 TCP/IP 套接字使用时，它可以工作，但不能用于慢速连接。我通过调试看到我得到了很多 64 字节的块，并且在 EOF 附近有一个 30 字节的块。我知道您可以在 read() 上获得更少的字节，因为当任何数据（> 1 字节）可用时调用返回。但是这个条件不应该被while抓住吗？当 n == 0 时应返回，即不再有数据 (EOF)。

谢谢你的帮助。

（编辑）

发送代码如下：

```
while (n=read(file_fd, buffer, BUFSIZE))
{
   write (sdaccept, buffer, n)
} 
```

我知道 read() 和 write() 都可能返回 N < BUFSIZE，但是这个循环不应该相应地解决吗？我将 n 相加并返回 1000000，即确切的大小。

（编辑二）

用 10673 字节的 C 源测试，接收 10575 没有损坏，除了目标文件缺少前 98 个字节！！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T06:56:35.853

提供的发送代码忽略了这样一个事实，即套接字上的 write() （或 send() ）没有义务写入整个缓冲区。

如果底层子系统拒绝接收更多数据，write()/send() 可能会决定部分写入或根本不写入（例如，网络子系统可能有一个用于发送数据的队列，而该队列已经满了）。这很可能是在连接速度较慢的情况下。

发送端应检查 write() 的返回值，以检测实际写入了多少数据并进行相应调整。

写应该以某种方式完成：

```
int readAmount;
while( readAmount = read(file_fd, buffer, BUFSIZE) > 0 )
{
    int totalWritten = 0;
    do {
       int actualWritten;
       actualWritten = write (sdaccept, buffer + totalWritten, readAmount - totalWritten);
       if( actualWritten == - 1 ) {
           //some error occured - quit;
       }
       totalWritten += actualWritten;
    } while( totalWritten < readAmount );
} 
```

# ruby - 如何将 ruby gem 放入“require”的包含路径中

> ID：684737
> 
> 赞同：12
> 
> 时间：2009-03-26T06:39:44.960
> 
> 标签：ruby, rubygems

我正在创造我期望成为红宝石的东西。任何人都有关于将简单库或插件转换为 gem 的教程的良好链接？另外，*特别*是，Ruby 使用什么过程来允许 require 查找 gem？这似乎不仅仅是将文件放在 gem 路径中（或者我的配置搞砸了？）。

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-26T13:01:15.837

手动执行此操作实际上并不难。假设您有一个`whatever.rb`想要作为 gem 分发的库。

1.  建立一个目录`lib`并复制一份`whatever.rb`in `lib/whatever.rb`。
2.  创建一个文件`whatever.gemspec`，并在其中放入以下内容，并填写适当的值：

    ```
     Gem::Specification.new do |spec|
       spec.name = 'the-name-of-your-gem'
       spec.version ='0.0.1'

       # this is important - it specifies which files to include in the gem.
       spec.files = ["lib/whatever.rb"]

       # optional, but useful to your users
       spec.summary = "A more longwinded description of your gem"
       spec.author = 'Your Name'
       spec.email = 'you@yourdomain.com'
       spec.homepage = '[http://www.yourpage.com](http://www.yourpage.com)'

       # you did document with RDoc, right?
       spec.has_rdoc = true

       # if you have a ruby forge project
       spec.rubyforge_project = 'your-project-name-on-rubyforge'

       # if you have any dependencies on other gems, list them thusly
       spec.add_dependency('hpricot')
       spec.add_dependency('log4r', '>= 1.0.5')
     end 
    ```

3.  现在，要构建 gem，请使用以下`gem build`命令：

    ```
    % gem build 不管什么.gemspec
    成功构建 RubyGem
    名称：您的宝石的名称
    版本：0.0.1
    文件：the-name-of-your-gem-0.0.1.gem
    %

    ```

4.  `gem install the-name-of-your-gem-0.0.1.gem` 您可以通过使用在脚本中使用您的库来进行本地测试，只需在顶部执行以下操作：

    ```
     require 'rubygems' # puts gem libraries in the require path
    require 'whatever' # loads your library 
    ```

有关`gemspec`文件中各种设置的更多信息，请查看[GemSpec 参考](http://rubygems.org/read/chapter/20)。

就个人而言，我也经常使用 ruby​​gems 来打包可执行脚本，并且发现它非常方便。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T11:54:03.627

这里有[一个](http://drnicwilliams.com/2006/10/11/generating-new-gems/)来自 Dr Nic 的旧的，它使用 newgem。这现在可能有点过时了。

最近，我们得到了 gemify，它似乎建立在上述之上。[这是一个关于那个的帖子](http://judofyr.net/posts/introducing-gemify.html)

就路径而言，一旦您执行`gem install <some-useful-stuff>`并且您的要求代码已经执行`require 'rubygems'`或者您设置了 RUBYOPT=-rubygems （仅适用于 Windows 吗？我不确定），那么后续的执行`require`也将在 gems 目录中搜索合适的图书馆。

还有更明确​​（但已弃用）的`require_gem`命令，现在只是 plain `gem`，它允许您指定版本号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T11:56:04.573

要制作红宝石宝石，您可能需要查看[newgem](http://github.com/drnic/newgem/tree/master)或[Jeweler](http://github.com/technicalpickles/jeweler/tree/master)。

# ruby-on-rails - 如何验证 Ruby on Rails 表单中的外部表单字段（例如验证码）？

> ID：684745
> 
> 赞同：2
> 
> 时间：2009-03-26T06:46:01.387
> 
> 标签：ruby-on-rails, ruby, validation

我有一个用户注册表单，并且想在我的注册方法中写入一个检测“验证码”的人类。我决定创建一个简单的数学问题供用户回答（这应该适合我的目的）。

如何编写检查该字段值的验证？我在我的模型文件中编写了一个验证方法，如下所示：

```
def validate
  errors.add(:humanproof, "is not the right answer") if humanproof != 4
end 
```

但是，由于 :humanproof 不是用户模型的一部分，因此“humanproof”变量在那里不可用。

访问humanproof 变量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T06:57:32.327

您可以做的是添加一个虚拟属性。查看来自 RailsCasts 的[截屏视频。](http://railscasts.com/episodes/16-virtual-attributes)

基本上你想为你的类添加一个属性。因为您不必使用它执行任何逻辑，您只需使用构建的 Ruby 方法表单实例变量即可。

```
 class Foo < ActiveRecord::Base
   attr_accessor :humanproof

   def validate
     errors.add(:humanproof, "is not the right answer") if humanproof != 4
   end 
```

这会为您的类添加一个属性，该属性未保存到数据库中，并在请求期间附加到对象。

# c# - C# 中是否有用于影响 IntelliSense 如何显示类成员的属性？

> ID：684747
> 
> 赞同：3
> 
> 时间：2009-03-26T06:48:17.217
> 
> 标签：c#, attributes, intellisense

是否有任何 C# 属性可以应用于类成员，以更改它们在 IntelliSense 列表中的显示方式？当我构建一个包含许多静态常量的类时，这突然出现在我的脑海中，我（简而言之！）希望它看起来像 IntelliSense 中的枚举。

是的，这很愚蠢。

但这让我开始思考——*有*没有什么疯狂的程序员可以让类成员在 IntelliSense 中以不同的方式出现？使字段看起来像属性等？

例如，有一个`Obsolete`属性：

```
[Obsolete("Stop using this. Really. It's old.")]
public int VariableThatIsReallyOld; 
```

哪个前缀词`[obsolete]`的描述`VariableThatIsReallyOld`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T06:56:08.290

[这里](https://stackoverflow.com/questions/471241/can-i-customize-the-intellisense-value-shown-when-hovering-while-debugging-in-vis)描述了 DebuggerDisplay 属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T07:14:34.627

[原来在自定义智能感知中](https://stackoverflow.com/questions/307514/custom-intellisense-for-server-controls)还有一些其他属性用于服务器控件？（但搜索仍在继续！）

```
[EditorBrowsable(EditorBrowsableState.Never)] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T07:10:45.867

我倾向于认为操纵评论是一个更好的提议。

```
///<summary>
/// Bomb!
///</summary>
///<example></example><value></value><![CDATA[]]><param name="ss"></param><exception   cref="ss"></exception><remarks></remarks>
///<returns></returns> 
```

如果您深入研究注释结构中可用的选项（智能感知和编译器可以理解）`<example>,<include>,<see>,<seealso>,<exception>`等，您可以很容易地获得所有功能而没有属性引入的性能下降。

# request - 每小时请求限制

> ID：684751
> 
> 赞同：4
> 
> 时间：2009-03-26T06:51:14.573
> 
> 标签：request, frequency

如何像 Twitter 一样限制来自一个 IP 的每小时请求？例如，我想每小时提供 100 个请求。有什么解决办法吗？阿帕奇模块？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T07:23:56.320

从简单开始。

*   使用 API 密钥的概念（假设它是映射到域或帐户的[guid ）。](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)
*   每次点击您的 API 时，获取该键并增加其相应的计数器。
*   根据您的计数器编写限制规则（在这种情况下为小时）
*   重启。

不建议通过 IP 阻止。[NAT](http://en.wikipedia.org/wiki/Network_address_translation)是问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T07:27:49.057

不要通过IP来做。来自整个大学、公司或网吧的人可能共享同一个 IP。最好将具有随机值的 cookie 注入到每个客户端的第一个 http 响应中，以识别唯一性。

# c# - 写入 Drawing.Bitmap 对象而不是物理文件

> ID：684753
> 
> 赞同：0
> 
> 时间：2009-03-26T06:51:41.980
> 
> 标签：c#

我有一个来自第三方的图形库，它有一个在文件夹内创建位图的方法。我希望此方法写入 Drawing.Bitmap 对象而不是物理文件。我可以在.net 中执行此操作吗

我正在使用 C# 1.1

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:02:02.207

我想这取决于第三方库允许的内容。如果您可以获取内存中的字节而不是将它们转储到文件中，那么是的，您可以这样做。

System.Drawing.Bitmap 有几个采用 Stream 的构造函数，因此您可以从 MemoryStream 创建它。像这样的东西（粗糙，未经测试:)

```
byte[] imgBytes = thirdPartyLibrary.GetImage();

System.IO.MemoryStream stream = new System.IO.MemoryStream(imgBytes);
System.Drawing.Bitmap bitmap = new System.Drawing.Bitmap(stream); 
```

# sql - 需要sqlite查询从具有最小值的表中删除一行

> ID：684754
> 
> 赞同：2
> 
> 时间：2009-03-26T06:52:55.863
> 
> 标签：sql, sqlite

如果记录数少于 5，我想从表中删除具有特定字段最小值的行；

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T07:01:39.290

`min`您可以使用聚合和`count`函数的子选择来执行此操作：

```
DELETE FROM the_table WHERE
  the_field = (SELECT min(the_field) FROM the_table)
  AND (SELECT count(*) FROM the_table) < 5; 
```

# java - Hulu.com 如何跟踪您在电视节目中的位置？

> ID：684756
> 
> 赞同：2
> 
> 时间：2009-03-26T06:54:20.790
> 
> 标签：java, jsp, web-applications, cookies, video-streaming

我正在 Hulu.com（顺便说一句，绝对最好的流媒体视频网站）上观看电视节目，以及是否关闭浏览器、断开互联网连接，甚至在观看过程中重新启动计算机节目，下次我去他们的网站时，我可以从节目中中断的时间恢复电视。

我的问题是从详细的 Web 编程角度来看，他们如何实现这一点？我认为它没有使用会话，因为如果我重新启动计算机，我认为这不会起作用。如果它使用 cookie，那么他们如何在节目中不断更新 cookie 与您的位置？

为了获得附加的赏金，请在最好的 Java/JSP（PHP 也可以）中包含代码示例，说明如何创建 cookie 和允许更新查看者位置的服务器端代码片段。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T16:14:39.657

Flash 有它自己的类似 cookie 的机制：[本地共享对象](http://en.wikipedia.org/wiki/Local_Shared_Object)。

这里有一些[代码示例](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_16194)。我想 Hulu 只是创建了一个 LSO 并定期用电影中的位置更新它。下次加载影片时，它可以获取 LSO 并恢复位置。或者，他们可以存储一个唯一的 ID 并在服务器端保存职位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T05:01:17.263

一种简单的方法是播放器可以通过 JavaScript 更新您的 cookie，并且Flash 播放器可以每*n秒调用一次 JavaScript 函数：*

```
<script type="text/javascript">
    function UpdateViewData(videoId, time)
    {
        //for a video with id 12345, sets a cookie called:
        //hulu12345 with a value of the position
        var cookieData = 'hulu' + videoId + '=' + time + '; expires=' + getDate() + ';path=/';
        document.cookie = cookieData;
    }
</script> 
```

在 Flash 播放器中，ActionScript 可以频繁调用 JavaScript 以相当准确地更新播放器上次设置 cookie 的位置。每次调用它时，它都会用更新的数据覆盖 cookie：

```
import flash.external.ExternalInterface;

//in flash video player code,
//have variables for video ID and current player position
//every 5 seconds, call:
ExternalInterface.call("UpdateViewData", videoId, currentPlayerPosition);

//this will invoke a JS function on the host page named "UpdateViewData"
//and pass in the provided arguments 
```

当您重新访问该页面时，服务器首先会检查您是否有一个名为“hulu{ID of video}”的 cookie，如果有，该 cookie 的值就是您上次查看时设置的位置。

再次（如开头所述）这是完成您所要求的非常简单的方法。我发现最好的学习方法是使用简单的实现，然后在更简单的情况被充分理解后增加复杂性。Hulu 可能会使用 AJAX 在幕后进行定期更新。（事实上​​，如果您在使用[Firebug](http://getfirebug.com/)之类的工具观看视频的同时观看网络流量，您会偶尔看到对 的调用`http://t2.hulu.com/v3/playback/position?...`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T07:09:43.250

他们可以编写一个带有一些记录 ID 的 cookie，然后在服务器上存储会话结束时您所在的位置。他们可以通过让客户每隔一段时间发回一个 ack 来知道你在哪里，上面写着“是的，我已经玩到 T 时间了”。

然后，当您回来时，他们使用 cookie 中的记录 ID 在他们的数据库中查找您所在的位置。无论您如何断开连接，他们仍然知道连接消失了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T07:09:48.320

我只是在猜测，但他们可能会将位置存储在服务器端。当您继续观看某些内容时，它会将最后记录的位置作为 resume-from 时间戳发送？

您所在的页面可能偶尔会将状态数据包发送回服务器，告诉它您当前的时间戳。当连接断开时，使用最后记录的值。

# c++ - 如何将字符串写入二进制文件

> ID：684763
> 
> 赞同：3
> 
> 时间：2009-03-26T06:58:05.103
> 
> 标签：c++, binaryfiles

使用此代码，我尝试以二进制格式打印字符串“foo”10 次。但是为什么它的功能不起作用呢？

```
#include <iostream>
#include <fstream>
using namespace std;

template <typename T> void WriteStr2BinFh (string St, ostream &fn) {
     for (unsigned i = 0; i < St.size(); i++) {
         char CStr = St[i];
         fn.write(&CStr.front(), CStr.size());
     }
     return;
}

int main() {
   string MyStr = "Foo";
   ofstream myfile;
   myfile.open("OuputFile.txt", ios::binary|ios::out);

   // We want to print it 10 times horizontally
   // separated with tab

  for (int i = 0; i < 9; i++) {
      WriteStr2BinFh(Mystr+"\t", myfile);
   }

   myfile.close();   
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T07:06:42.243

这里有很多错误，我将列出我看到的所有内容：

你的 for 循环条件应该是 i < 10。

为什么使用模板而不是模板化参数 T？

您在 CStr 上调用 front() 方法，但 CStr 是一个字符，而不是字符串，所以我什至不知道它是如何编译的。

假设 CStr 是一个字符串，您不想使用 & 获取 front() 迭代器的地址，而是您想说：

```
fn.write(St.c_str(), St.size()); 
```

而且您不想循环 St.size() 迭代。只需执行上述操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T07:18:55.193

omg，它有很多错误：

*   int main - 应该返回值；
*   您不在函数中使用 template< typename T >；
*   Mystr - 函数调用中的名称不正确，c++ 中的名称区分大小写；
*   char CStr - 前面没有方法，也没有 std::string；
*   您无法获得第一个元素的地址，例如使用向量的情况；
*   如果您接受 std::string 作为 const 引用会更好；
*   您忘记包含字符串标题；
*   ...

用您的代码组织和命名修复了您的示例：

```
#include <iostream>
#include <fstream>
#include <string>

void WriteStr2BinFh( const std::string& St, std::ostream &out ) 
{
    out.write( St.c_str(), St.size() );
}

int main() 
{
    std::string MyStr = "Foo";
    std::ofstream myfile( "OuputFile.txt", std::ios::binary | std::ios::out );

    for (size_t i = 0; i < 9; ++i) 
    {
        WriteStr2BinFh( MyStr+"\t", myfile );
    }

   myfile.close();   
   return 0;
} 
```

但我建议使用`std::fill_n`算法

```
std::fill_n( std::ostream_iterator< std::string >( myfile, "\t" ), 10, MyStr ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T07:07:51.943

首先，`char CStr`说那`CStr`是一个单一的字符。其次，`fn.write(&CStr.front(), CStr.size());`将该字符视为容器，例如`std::vector<>`，当然无法编译。

假设一切`WriteStr2BinFh`正常，我没有检查过，这`WriteStr2BinFh`应该（可能）看起来：

```
void WriteStr2BinFh(const string& St, ostream &fn)
{
    for(string::iterator it = St.begin(); it != St.end(); ++it)
    {
        fn.put(*it);
    }
} 
```

或者，最好是

```
void WriteStr2BinFh(const string& St, ostream &fn)
{
    fn.write(St.c_str(), St.length());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T07:39:23.427

在二进制模式下进行 io 操作的要点：

*   必须使用标志 ios::out（输出模式）和 ios::binary（二进制模式）以输出和二进制模式打开文件
*   函数 write 有两个参数。第一个参数是 char* 类型，表示要写入的数据，第二个参数是 int 类型，询问要写入二进制文件的数据大小。
*   最后必须关闭文件。

    ```
    void write_to_binary_file(WebSites p_Data)
    {
        fstream binary_file("c:\\test.dat",ios::out|ios::binary|ios::app);
        binary_file.write(reinterpret_cast<char *>(&p_Data),sizeof(WebSites));
        binary_file.close();
    } 
    ```

    此 I/O 二进制函数将一些数据写入该函数。

*   该文件使用 ios::out 和 ios::binary 以输出和二进制模式打开。还有一个说明符 ios::app，它告诉操作系统该文件也以附加模式打开。这意味着任何新的数据集都将附加到文件的末尾。

*   上面使用的write函数，需要参数为字符指针类型。所以我们使用类型转换器 reinterpret_cast 将结构类型转换为 char* 类型。

# .net - 如何更改表达式中参数的类型？

> ID：684767
> 
> 赞同：6
> 
> 时间：2009-03-26T07:01:35.810
> 
> 标签：.net, linq, c#-3.0, lambda, expression-trees

因为我在我的域中使用 POCOS，我希望我的存储库能够接收我的 POCOS 类型的表达式过滤器并将表达式中的参数更改为我的 LINQ 表的类型，我的字段具有相同的名称我的成员，所以我能够通过分解成员和常量来完成 1 和 2 lambda 条件，如果我添加更多条件，这将导致递归解析二进制表达式。

我就是这样结束的，有没有简单的方法来完成这个

```
var q = from p in 
        db.products.Where(ExpressionBuilder.Create<MyPocoProduct,LinqProduct>(myPocoProductExpression)) 
```

我改变它的方式

```
public class ExpressionBuilder
    {
        public static Expression<Func<TLinq, bool>> Create<TEntity, TLinq>(Expression<Func<TEntity, bool>> predicate)
        {

            try
            {
                //get the predicate body
                var binaryExpr = (BinaryExpression)predicate.Body;

                //holds the resuting Expression
                var expressionResult = default(BinaryExpression);

                // Create the parameter of the Linq table Type 
                ParameterExpression parameter = Expression.Parameter(typeof(TLinq), predicate.Parameters[0].Name);

                //if only one condition was passed
                if (binaryExpr.Left is MemberExpression)
                {
                    expressionResult = CreateExpression(binaryExpr, parameter,binaryExpr.NodeType);

                }
                else if (binaryExpr.Left is BinaryExpression)
                {
                    var predicatesList = new List<BinaryExpression>();

                    var leftExp = CreateExpression((BinaryExpression)binaryExpr.Left, parameter, binaryExpr.Left.NodeType);
                    var RightExp = CreateExpression((BinaryExpression)binaryExpr.Right, parameter, binaryExpr.Right.NodeType);

                   expressionResult = Expression.And(leftExp, RightExp);

                }

                return Expression.Lambda<Func<TLinq, bool>>(expressionResult, parameter);
            }
            catch (Exception ex)
            {
                throw new Exception("Eror While creating Filter", ex);
            }

        }

        private static BinaryExpression CreateExpression(BinaryExpression expression, ParameterExpression parameter,ExpressionType expType)
        {

            var memberExp = expression.Left as MemberExpression;

            if (memberExp == null) throw new ArgumentException("left  expression is not a member Expression");

            //create the Member expression
            MemberExpression member = LambdaExpression.PropertyOrField(parameter, memberExp.Member.Name);

            //create the constant against the value
            ConstantExpression constant = Expression.Constant(((ConstantExpression)expression.Right).Value);

            return CreateExpressionOfType(expType, member, constant);

        }

        private static BinaryExpression CreateExpressionOfType(ExpressionType expType, MemberExpression member, ConstantExpression constant)
        {

            //creates the body fo the lambda 
            var resultExpression = default(BinaryExpression);
            switch (expType)
            {

                case ExpressionType.And:
                    break;
                case ExpressionType.AndAlso:
                    break;
                case ExpressionType.ConvertChecked:
                    break;
                case ExpressionType.Equal:
                    resultExpression = Expression.Equal(member, constant);
                    break;
                case ExpressionType.ExclusiveOr:
                    break;
                case ExpressionType.GreaterThan:
                    resultExpression = Expression.GreaterThan(member, constant);
                    break;
                case ExpressionType.GreaterThanOrEqual:
                    break;
                case ExpressionType.LessThan:
                    resultExpression = Expression.LessThan(member, constant);
                    break;
                case ExpressionType.LessThanOrEqual:
                    break;
                case ExpressionType.Not:
                    break;
                case ExpressionType.NotEqual:
                    break;
                default:
                    break;
            }

            return resultExpression;

        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T04:18:27.707

不，您不能更改 a 的类型`ParameterExpression`（表达式树是不可变的）；你必须重建整个树才能做到这一点。是的，你经常不得不递归它。对不起...

# java - Eclipse 在每次保存时构建所有类

> ID：684773
> 
> 赞同：10
> 
> 时间：2009-03-26T07:04:57.237
> 
> 标签：java, eclipse, build

我的工作区中有一个大型项目。每次我保存 jsp 或任何文件（java、txt、属性等）时，构建都会运行。构建大约需要 30 到 45 秒。我恨它！我不能像这样有生产力。这种情况最近才开始发生，我一直启用自动构建，这不会导致这个问题。办公室里的其他人没有遇到这个问题。所以这一定是我的设置。

我想问题是，每次我编辑项目中的任何文件时，如何让 eclipse 只构建我修改的类文件而不是完整的构建？

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T07:16:34.370

> 我想问题是，每次我编辑项目中的任何文件时，如何让 eclipse 只构建我修改的类文件而不是完整的构建？

这就是 Eclipse 通常开箱即用的方式。你一定是弄坏了什么...

您是否使用外部构建工具（例如 Ant）？检查项目的 Builders 设置。

如果没有其他帮助，请尝试创建一个新工作区并将您的项目导入其中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T07:24:22.733

事实证明，我的类路径中没有所有的 jar。我的代码没有直接使用这些 jar，因此我的代码本身没有错误。我正在使用的其他库需要它们。

修复：确保所有依赖项都添加到类路径中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T07:46:58.557

正如[Thilo 所说](https://stackoverflow.com/questions/684773/eclipse-builds-all-classes-on-each-save/684795#684795)，检查您的构建器。

最后的手段是删除您的工作区并检查一组干净的代码。这或多或少令人讨厌，这取决于让您的代码库从“签出”到“运行”的难易程度以及您自定义 Eclipse 体验的程度（修改的快捷方式/视图/透视图、mylyn 数据等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T07:37:03.120

我不使用 Eclipse（所以认为这是一个未受过教育的猜测 :-)，但要检查的另一件事是您的时钟设置。可能是您的时间设置与文件修改时间太远，因此它一直认为源文件相对于类文件已更改。

我会说这不太可能，但是，取决于 Eclipse 的工作方式，*这可能*是可能的。

另一件事是您确定您正在更改的文件真的不需要重建其他文件吗？

# vb.net - 如何在打开 MS Access DB 时禁用宏和启动值

> ID：684774
> 
> 赞同：1
> 
> 时间：2009-03-26T07:05:14.367
> 
> 标签：vb.net, ms-access

在我之前的问题标题如下：

“**如何在打开 Access DB 时避免链接表管理器消息**。”

我问过如何在打开 MSAccess DB 时禁用**宏（以编程方式 vb.net）**，我得到了一些很好的参考和代码示例。但不幸的是，我无法达到预期的效果。我尝试过 API 在运行时启用/禁用键**(SHIFT)**，并且还以编程方式使用了一些**命令行**选项，但即使没有出现任何错误，它仍然无法正常工作。

**问题：**

1.  我的一个 AccessDB 包含宏，它在打开数据库时调用一个表单。并且表单有一些指向表的链接，它会创建中断，询问表的正确路径并暂停应用程序，直到用户干预。
2.  另一个在打开数据库时在启动时调用表格。它会导致在运行应用程序时打开所有表单。

我需要解决这两个问题并顺利运行应用程序。

请那里的任何人以某种方式帮助我....

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T04:44:14.823

请参阅通过 Shift 键代码

此代码只是让您浏览到您选择的 mdb 数据库，并在 mdb/mde 启动期间启用或禁用 shift 键。

在以下页面上的方式： [http ://www.members.shaw.ca/AlbertKallal/msaccess/msaccess.html](http://www.members.shaw.ca/AlbertKallal/msaccess/msaccess.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T12:01:42.547

在其中一个 MS 支持页面上，我找到了对 /nostartup 开关的引用。您可以尝试将其添加到您的启动命令中吗？

# iphone - 如何使用 Wi-Fi 获取距离

> ID：684781
> 
> 赞同：3
> 
> 时间：2009-03-26T07:09:36.010
> 
> 标签：iphone, objective-c, wifi

我想使用 wi-fi 查找距离并在 iPhone 的地图上绘制标记。

所以我能得到任何想法或代码吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-26T07:47:39.977

在第一次阅读您的问题时，我假设您指的是到接入点的距离。在写了一堆关于那个之后，我意识到你可能意味着别的东西。如果这就是你的意思，请继续阅读......

鉴于您的配置：

*   单个固定接收器*（您的手机不必固定，但如果您正在寻找瞬时测量，它可以有效地固定）*
*   单个固定基站（接入点）
*   接收器上的全向天线
*   802.11 b/g 协议

这是无法做到的。即使您在[PHY](http://en.wikipedia.org/wiki/OSI_model)级别工作，这也是一个不可能解决的问题。为了使其更可行，您需要对接收器相对于两个（但最好更多）基站的位置进行[三角测量。](http://en.wikipedia.org/wiki/Triangulation)即使*这样，*这仍然是一个难题。RF 波以光速传播，因此使用中继技术来测量往返信号传播延迟不会提供良好的精度（接收器必须运行得非常快，然后就会出现[多路径](http://en.wikipedia.org/wiki/Multipath_propagation)问题......）。同样，这一切都假设您基本上是在构建自己的 RF 硬件，显然您不会为 iPhone 做这件事。

追踪基站位置的最佳选择是在更改手机位置时记录 WiFi 信号强度。通过“改变位置”，您基本上必须扫过该区域。通过一些良好的启发式方法和处理与距离无关的信号衰减的鲁棒性，您可以获得不错的准确度（可能在 10 米左右）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T07:22:15.730

仅使用网卡的信号强度无法获得到接入点的准确距离（以米或英尺为单位）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T07:56:45.803

使用 Apple 的 CoreLocation 框架，它可以为您提供您所在位置的坐标。我无法链接到它，因为我无权访问 iPhone 文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T09:19:59.847

在这里[http://www.mathforum.com/library/drmath/view/51711.html](http://www.mathforum.com/library/drmath/view/51711.html)您可以找到方程式来计算 GPS 两个位置之间的距离。这是我在此基础上创建的 C# 代码（已缩放为公制）

```
 private double Distance(GpsPosition p1, GpsPosition p2)
    {
        // http://www.mathforum.com/library/drmath/view/51711.html

        double A = p1.Latitude / 57.29577951;
        double B = p1.Longitude / 57.29577951;
        double C = p2.Latitude / 57.29577951;
        double D = p2.Longitude / 57.29577951;

        if((A==C) && (B==D))
            return 0;

        if((Math.Sin(A)*Math.Sin(C)+Math.Cos(A)*Math.Cos(C)*Math.Cos(B-D)) > 1.0)
            return 6372.72 * Math.Acos(1);
        else
            return 6372.72 * Math.Acos(Math.Sin(A) * Math.Sin(C) + Math.Cos(A) * Math.Cos(C) * Math.Cos(B - D));
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T07:25:36.160

可能您将能够使用 3 个或更多接入点获得粗略的距离。现在有一种技术可以使用 3 个 GSM 移动基站来获取到移动用户的距离。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T07:46:03.333

使用接收到的功率，您可以使用射频传播模型计算从发射器到接收器的距离。但是，听起来您想要的是位置，而不仅仅是距离。

自由空间路径损失模型：

[http://en.wikipedia.org/wiki/Free-space_path_loss](http://en.wikipedia.org/wiki/Free-space_path_loss)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T08:05:53.927

你想在这里达到什么目的？

如果您尝试使用 Iphone 在地图上绘制您的位置，那么此功能已经是 Iphone 的一部分，它具有 GPS 接收器，并且可以“开箱即用”。

如果您尝试使用 wifi 查找笔记本电脑的位置并将该位置发送到 iphone，那么您将遇到一个相当困难的问题，如果没有大量工作，这可能是无法解决的。

有一些设施可以让您从 GSM 桅杆上对您的位置进行三角测量，但这些设施位于已知纬度/经度的固定位置。Wifi 接入点没有地理位置数据库，因此从这些位置进行三角测量将非常困难/不可能。

您可以使用诸如此类的 3rd 方服务[来](http://www.mxtelecom.com/uk/tech/lbs/http)使用 GSM 跟踪您的位置，但是这些非常不准确，除非您在大城市并且需要您在所跟踪的任何内容中都有 GSM 调制解调器。

# asp.net - 在 web 配置文件中需要帮助

> ID：684782
> 
> 赞同：0
> 
> 时间：2009-03-26T07:09:41.283
> 
> 标签：asp.net, configuration

我在使用 CreateUserWizard 控件创建新用户时遇到问题。我在连接字符串中添加了：

```
<connectionStrings>
    <add name="BankingTransaction"
      connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Bank.mdf;integrated security=True;User Instance=True"
      providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

在 web.config 文件中添加此连接字符串后，当我运行应用程序时，我可以创建新用户注册详细信息。但是，当我在 web.config 文件中添加以下代码时，出现错误“找不到存储过程 'dbo.aspnet_CheckSchemaVersion'。” 代码是：

```
<membership defaultProvider="DefaultMembershipProvider">
  <providers>
    <add connectionStringName="BankingTransaction" 
      enablePasswordRetrieval="true"
      enablePasswordReset="true"
      requiresQuestionAndAnswer="true"
      applicationName="/"
      requiresUniqueEmail="true"
      passwordFormat="Clear"
      minRequiredPasswordLength="3"
      minRequiredNonalphanumericCharacters="1"
      passwordStrengthRegularExpression=""
      name="DefaultMembershipProvider"
      type="System.Web.Security.SqlMembershipProvider"/>
  </providers>
</membership> 
```

请有人帮助我上面红色突出显示的代码有什么问题。

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T07:16:49.707

请检查[这个](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/ac0770af-a781-4558-9f2f-f8bea17665be/)和[这个](http://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)，看看它是否能解决你的问题。我记得昨天看到过这个问题。它是重复的吗？:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T07:20:21.320

我认为您应该使用[ASP.NET SQL Server 注册工具 (Aspnet_regsql.exe)](http://msdn.microsoft.com/en-us/library/ms229862.aspx)工具注册您的新数据库。

# ruby-on-rails - Activerecord - 保存所有关联对象后的回调

> ID：684790
> 
> 赞同：3
> 
> 时间：2009-03-26T07:14:28.760
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个模型，出于性能原因，我想存储关联对象的 ID（非规范化）。我有一个看起来像这样的方法：

```
def cache_ids
  self._tag_ids = self.tag_ids
end 
```

我以为我可以在 before_save 上运行它，但是有一个问题 - 一些关联的对象可能是新记录，因此它们不会有 id。

然后我切换到after_save，但显然这个回调也是在事务提交之前触发的，所以ids仍然没有设置。

此刻我结束了：

```
def save_with_idcache(*args)
  return false unless save_without_idcache(*args)

  cache_ids

  return save_without_idcache(false)
end

alias_method_chain :save, :idcache 
```

这似乎有效，但看起来不是很优雅。

有没有更好的办法？比如，对象和关联对象都保存后的回调？

也许我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T22:43:52.663

您可以反过来尝试 - 让关联对象更新其父项的`_tag_ids`, `after_create`（`after_save`如果它们从关联中删除和/或添加到新的关联中）和`after_destroy`.

这是否是一个更好的解决方案将取决于它们有多少，你移动它们的程度，以及你对脏属性的注意程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T18:17:52.270

你也可以使用 after_create 吗？id 会在那里。

```
after_create :idcache
before_save :idcache

protected
def idcache
  unless new_record?
    ...
  end
end 
```

# clickonce - 更改 ClickOnce 应用程序发布位置在客户端计算机上的影响

> ID：684794
> 
> 赞同：14
> 
> 时间：2009-03-26T07:15:27.370
> 
> 标签：clickonce

好的，我有一个使用[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)发布到的[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序，所以部署链接是.
`http://MyDevComputer1/DevPublishFolder/``http://MyDevComputer1/DevPublishFolder/publish.htm`

该应用程序已部署到公司内部网中的近 20 台机器上。我现在需要将发布位置更改为同一网络中的不同服务器，但我只是不确定此更改将如何影响已经在其客户端计算机上安装了应用程序的用户。

如何确保应用程序在客户端计算机上下次启动应用程序期间检测到发布位置已更改为不同的服务器？

或者我必须去卸载所有客户端机器上的应用程序，然后从新的发布位置重新安装？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-28T16:40:17.277

*   转到发布选项卡，然后单击更新按钮。
*   将新 URL 添加到更新位置下拉列表，然后单击确定
*   发布

一旦所有客户端都收到了新版本，他们将查看新 URL（和您的新服务器）以获取所有未来的更新。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-19T07:42:11.973

*[如何移动 ClickOnce 部署](http://robindotnet.wordpress.com/2010/01/17/how-to-move-a-clickonce-deployment/)*是与视频一起展示如何移动 ClickOnce 部署的文章。

# c# - 设置纸张尺寸

> ID：684801
> 
> 赞同：12
> 
> 时间：2009-03-26T07:20:34.940
> 
> 标签：c#, .net, printing

请帮助我如何在 C# 代码中设置我的纸张大小。我正在使用 API 打印文档。

下面是我的代码：

```
 ppvw = new PrintPreviewDialog();
 ppvw.Document = printDoc;
 ppvw.PrintPreviewControl.StartPage = 0;
 ppvw.PrintPreviewControl.Zoom = 1.0;
 ppvw.PrintPreviewControl.Columns = 10;

 // Showing the Print Preview Page
 printDoc.BeginPrint += new System.Drawing.Printing.PrintEventHandler(PrintDoc_BeginPrint);
 printDoc.PrintPage += new System.Drawing.Printing.PrintPageEventHandler(PrintDoc_PrintPage);

 if (ppvw.ShowDialog() != DialogResult.OK)
 {
     printDoc.BeginPrint -= new System.Drawing.Printing.PrintEventHandler(PrintDoc_BeginPrint);
     printDoc.PrintPage -= new System.Drawing.Printing.PrintPageEventHandler(PrintDoc_PrintPage);
 }

 printDoc.PrinterSettings.DefaultPageSettings.PaperSize = new System.Drawing.Printing.PaperSize("a2", 5.0,5.0);
 printDoc.Print(); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-09-22T17:54:36.090

```
PrinterSettings ps = new PrinterSettings();
PrintDocument recordDoc = new PrintDocument();
recordDoc.PrinterSettings = ps; 
```

这是一种设置纸张尺寸的方法，例如“A4”

```
IEnumerable<PaperSize> paperSizes = ps.PaperSizes.Cast<PaperSize>();
PaperSize sizeA4 = paperSizes.First<PaperSize>(size => size.Kind == PaperKind.A4); // setting paper size to A4 size
recordDoc.DefaultPageSettings.PaperSize = sizeA4; 
```

这是另一种设置自定义纸张尺寸的方法

```
recordDoc.DefaultPageSettings.PaperSize = new PaperSize("210 x 297 mm", 800, 800);
PrintPreviewDialog ppvw = new PrintPreviewDialog();
ppvw .Document = recordDoc;
ppvw.ShowDialog(); 
```

希望它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:19:14.597

纸张大小的构造函数是 PaperSize(String, Int32, Int32)

5.0 (5) X 5.0 (5) 太少了,,, 除非“自定义尺寸”是您的字符串.. 或者 A2 为 420 x 594...

并尝试在printer.PaperSizes中枚举foreach PaperSize大小并检查A2是否存在......

默认情况下，它将 Rawkind 设置为自定义，您还需要按照[http://msdn.microsoft.com/en-us/library/system.drawing.printing.papersize.rawkind.aspx中所述设置 Rawkind](http://msdn.microsoft.com/en-us/library/system.drawing.printing.papersize.rawkind.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T10:47:10.407

我正在使用 Visual Basic，使用此代码，我可以获得在 printpreview 中显示所有内容的表单，仍然在右侧打印一个剪裁好的页面。

```
PrintForm1.Form = Me
PrintForm1.PrinterSettings.DefaultPageSettings.Landscape = True
PrintForm1.PrinterSettings.DefaultPageSettings.PaperSize = New Printing.PaperSize("Custom", Me.Height, (Me.Width + 47))
PrintForm1.PrinterSettings.DefaultPageSettings.Margins = New Printing.Margins(3, 3, 3, 3)
PrintForm1.PrinterSettings.DefaultPageSettings.PaperSize.RawKind = Printing.PaperKind.A4Small
PrintForm1.PrintAction = Printing.PrintAction.PrintToPreview    'PrintForm1.PrintAction = Printing.PrintAction.PrintToPrinter
PrintForm1.Print()  'PrintForm1.Print(Me, PowerPacks.Printing.PrintForm.PrintOption.Scrollable)  ' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-23T13:07:46.783

尝试这个。我认为这段代码将帮助您解决这个问题。

```
Private Sub bt_Save_Click(sender As Object, e As EventArgs) Handles bt_Save.Click
    MsgBox("Saved", MsgBoxStyle.Information)
    If MsgBox("you want to print now?", MsgBoxStyle.Question + vbOKCancel, "Printing") = MsgBoxResult.Ok Then
        Try
            PrintPreviewDialog1.Document = ImportBillPrintDocument
            ImportBillPrintDocument.PrinterSettings.DefaultPageSettings.PaperSize = pkCustomSize1
            ImportBillPrintDocument.DefaultPageSettings.PaperSize = pkCustomSize1

            PrintPreviewDialog1.WindowState = FormWindowState.Maximized
            PrintPreviewDialog1.ShowDialog()
        Catch ex As Exception

        End Try

    End If
End Sub 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-11-12T18:14:19.003

您可以按照以下方式使用，用户可以在设置表单中设置页面大小。

```
 private void button1_Click(object sender, EventArgs e)
        {
            PrintDialog printdg = new PrintDialog();
            if (printdg.ShowDialog() == DialogResult.OK)
            {
                PrintDocument pd = new PrintDocument();
                pd.PrinterSettings = printdg.PrinterSettings;
                pd.PrintPage += PrintPage;
                pd.Print();
                pd.Dispose();
            }
        }
        private void PrintPage(object o, PrintPageEventArgs e)
        {
           // Printng logic
        } 
```

# linux - 从 Windows 向 CVS 添加 Shell 脚本

> ID：684802
> 
> 赞同：1
> 
> 时间：2009-03-26T07:20:49.040
> 
> 标签：linux, version-control, shell, cvs, tortoisecvs

我将向 CVS 添加一些 Linux shell 脚本。我可以使用 SSH 安全 shell 客户端将脚本下载到 windows，然后使用 Tortoise CVS 客户端添加到 CVS 吗？（只是为了方便...除了使用 cvs 命令之外，我们在 tortoise 中有很好的 GUI :)）它会破坏 Linux 设置的权限吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T07:38:01.510

我相信这会破坏您设置的权限。您可能可以使用 SSH 和 Cygwin 保留权限，但随后通过 Windows 和 TortoiseCVS 添加文件将再次破坏权限。

最好的办法是在服务器上使用命令行 CVS，这并不难……只要确保 CVSROOT 设置为 CVS 的路径：

导出 CVSROOT=:local:/home/username/cvs

然后将 shell 脚本文件添加到 CVS：

cvs import -m "导入的源代码" myshellscripts

有关详细信息，请参阅以下内容：

[http://www.cs.utah.edu/dept/old/texinfo/cvs/cvs_6.html](http://www.cs.utah.edu/dept/old/texinfo/cvs/cvs_6.html)

# windows - 如何解决 Windows 目录的“设计”问题？

> ID：684811
> 
> 赞同：0
> 
> 时间：2009-03-26T07:27:39.040
> 
> 标签：windows, dos, long-filenames

dir /b 生成一个不错的仅文件列表

dir /x 生成详细列表（日期、时间、大小、长名、短名）

但是，如果您将两者结合起来（即 dir /b /x），则 /x 开关将被忽略。[此](http://support.microsoft.com/kb/240666)页面的此行为是设计使然。

因此，如果您要求一个仅包含文件短名称的简单列表，Redmond (Microsoft) 表示将其提供给您是违反天规的。

怎么能绕过这个“设计”问题？

提前谢谢了

ps这是为了帮助我实现[这个](https://stackoverflow.com/questions/684535/batch-rename-issue-when-dealing-with-special-chracters-in-the-filename)问题中解释的东西。五个好心的朋友发布了我非常感谢的答案，但没有一个答案帮助我得到我想要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T07:45:11.713

试试这个：

```
for /f "usebackq delims=" %X in (`dir /b`) do @echo %~nsxX 
```

或者，如果您想要完全限定的路径名​​：

```
for /f "usebackq delims=" %X in (`dir /b`) do @echo %~fsX 
```

有关详细信息，请参阅`for`帮助：

```
for /? 
```

请注意，如果您在批处理文件中使用这些命令，则需要将`%`符号加倍。例如：

```
for /f "usebackq delims=" %%X in (`dir /b`) do @echo %%~nsxX 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T07:38:27.547

没有将 dir /x 转储到文本文件并对其进行解析，我不确定该建议什么。你有能力在代码中运行你正在做的任何事情吗？

这是一个更复杂的解决方案，但是使用 perl 或其他脚本语言编写一些东西；或者全力以赴，用 C# 编写一些代码。

我怀疑你会得到与上一个问题相同的答案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T07:36:14.167

您可以编写自己的目录列表可执行文件。在 C# 中创建一些东西并不需要太多。使用 Directory.GetFiles() 检索目录列表，并将每一个传递给“GetShortPathName()”Win32 函数。

此页面有一个不错的示例，说明如何从 C# 调用 GetShortPathName()：http: [//csharparticles.blogspot.com/2005/07/long-and-short-file-name-conversion-in.html](http://csharparticles.blogspot.com/2005/07/long-and-short-file-name-conversion-in.html)

# javascript - 我可以在 JavaScript 代码中编写 Java 逻辑吗？

> ID：684818
> 
> 赞同：2
> 
> 时间：2009-03-26T07:32:39.840
> 
> 标签：javascript, jakarta-ee

我可以在 JavaScript 中编写 Java 逻辑吗？如果是，如何？

我没有自由创建一个新课程并在单击按钮时将其重定向到那里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T07:36:04.340

如果您希望逻辑在客户端执行，那么（除了小程序等）逻辑必须用 JavaScript 编写。有诸如[GWT](http://code.google.com/webtoolkit/)之类的工具可以将 Java 转换为 JavaScript，这可能会对您有所帮助。

另一种选择是使用 AJAX - 当您想要执行逻辑时，您不会重定向整个页面，但是您的 JavaScript 会回调到服务器（在您的情况下，服务器会在 Java 中执行逻辑），然后可能会更改一个部分基于响应的 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T12:13:13.253

我找到了方法：

```
function myjavascriptfunc(){

<% // put java code %>
} 
```

# c# - 是否可以从 WebPart 获得对 silverlight 页面的引用？

> ID：684819
> 
> 赞同：0
> 
> 时间：2009-03-26T07:33:54.593
> 
> 标签：c#, silverlight, sharepoint, web-parts

我想知道如何与 Page.xaml.cs 中定义的这个 Page 类进行通信：

```
public partial class Page : UserControl
{
    public Page()
    {
        InitializeComponent();
    }

    private void TextBlock_MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
    {
        if (HelloWorldTextBlock.Text == "Hello World")
            HelloWorldTextBlock.Text = "I've been clicked";
        else
            HelloWorldTextBlock.Text = "Hello World";
    }
    public void foo() {}

} 
```

来自在此处创建 silverlight 对象的 webpart：

```
protected override void CreateChildControls()
{
     base.CreateChildControls();

     System.Web.UI.SilverlightControls.Silverlight ctrl = new System.Web.UI.SilverlightControls.Silverlight();
     ctrl.ID = "SLHelloWorld";
     ctrl.Source = SPContext.Current.Site.Url + "/XAPS/SL.XAML.HelloWorldRTM.xap";
     ctrl.Width = new Unit(400);
     ctrl.Height = new Unit(310);
     Controls.Add(ctrl);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:33:58.443

我不知道您对“与此 Page 类进行交流”的确切含义。但我认为您不能直接调用该类或它的实例。您可以做的是将参数传递给 Silverlight 控件，然后可以在控件内部使用该参数。您可以在以下博客文章表格 Jesse Liberty 中找到有关此内容的一些信息：将[参数传递到 Silverlight 应用程序](http://jesseliberty.com/2008/12/26/passing-parameters-into-silverlight-applications/)

我希望这可以帮助你。

# sql - 如何从表中删除记录？

> ID：684820
> 
> 赞同：0
> 
> 时间：2009-03-26T07:33:58.917
> 
> 标签：sql, sql-server-2005

如何从表中删除记录？

例如，该表有两列：`eno`和`ename`。我想从表中删除 ename 中的一个值：

> **伊诺伊南**   **_**
> 
>  1个阿莎
> 
>  2双马尔

我想删除值`'bimal'`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T07:37:09.547

你的问题有点模棱两可。

如果，如标题所示，您想删除包含“Bimal”的*记录*，那么您将编写如下内容：

```
DELETE FROM [table_name] WHERE Eno = 2 
```

但是，如果正如问题主体所暗示的那样，您的意思是要保留*记录*但从中删除*值*“Bimal”，那么您将编写如下内容：

```
UPDATE [table_name] SET Ename = NULL WHERE Eno = 2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T07:37:26.147

```
DELETE FROM mytable WHERE ename = 'bimal' 
```

不过，在实际代码中使用参数化语句，而不是直接在 SQL 中包含值。如何执行此操作取决于您的客户端环境，但 SQL 可能类似于：

```
DELETE FROM mytable WHERE ename = @name 
```

然后@name 是您将作为单独的数据提供其值的参数。然后，如果它包含引号等，您无需担心转义它。

请注意，到目前为止，所有答案（已删除的答案除外）都已删除整行。这是您想要的，还是您实际上只想“删除”该行的 ename 值（通过用 NULL 或空字符串覆盖它）？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T08:07:17.027

你需要学习一些基本的东西。你应该先阅读一些关于 SQL 的书，或者做一些在线教程。谷歌会帮助你。您需要知道的一件事是：有一个适用于所有数据库/DBMS 的 SQL 标准，这是您应该首先学习的内容。

在此之后，您可以查看 Microsoft SQL Server 的 SQL 方言 T-SQL。然后你必须找到它的在线帮助并学习使用它。描述了您要求的删除语句的语法[此处](http://msdn.microsoft.com/en-us/library/ms189835.aspx)描述。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T08:13:53.000

听起来您只想更新 Ename 列中的值。

做这个：

```
UPDATE <table_name> SET Ename='' WHERE Eno=2; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T07:37:16.600

从表中删除 Ename = 'bimal'; 或从表中删除 Eno = 2；

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T07:37:59.170

```
delete from tablename where eno = 2 
```

假设 tablename 是您的表的名称。

在联机丛书中查找“DELETE 语句 [SQL Server]”以获取完整的语法。

# hibernate - Hibernate注解，自增相关

> ID：684836
> 
> 赞同：2
> 
> 时间：2009-03-26T07:38:50.167
> 
> 标签：hibernate

我正在使用休眠注释，在后端我使用的是 Postgres SQL 8.3。所以，我不知道如何在我的类的注释中应用序列。

请为此提供相关帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T14:57:59.050

您可以通过像这样实现它来更好地控制生成的序列：

```
@Id
@GeneratedValue(generator="YourGeneratorName")
@GenericGenerator(
        name="YourGeneratorName", strategy="seqhilo",
        parameters={
                @Parameter(name="max_lo", value="1"),
                @Parameter(name="sequence", value="seq_name_of_the_sequence")
            }
)
private Long id; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T07:52:02.367

```
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType; 
```

然后，把它放在你的序列字段前面：

```
@GeneratedValue(strategy=GenerationType.SEQUENCE) 
```

希望对您有帮助...

# java - 正则表达式 (Java)

> ID：684841
> 
> 赞同：0
> 
> 时间：2009-03-26T07:39:54.220
> 
> 标签：java, regex, string

如何匹配以下字符串？

```
http://localhost:8080/MenuTest/index.action 
```

如果正则表达式在上述模式中包含“MenuTest”，则它应该返回 true。

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T07:48:07.307

也许您不需要正则表达式？

```
String url = "http://localhost:8080/MenuTest/index.action";    
boolean hasWhatImLookingFor = url.contains("MenuTest"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T23:12:36.233

如果您需要检查“MenuTest”是否出现*在该特定位置*（即在主机/端口之后），那么您可以使用：

```
^https?://[^/]++/MenuTest
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T07:47:20.617

这些方面的东西？（未经测试）

```
Regex r = new Regex("MenuTest");
r.search("http://localhost:8080/MenuTest/index.action");
System.out.println(""+r.didMatch()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T07:48:58.770

您寻求的正则表达式只是“MenuTest”，没有引号。除非问题比看起来更复杂？

# database - 针对 ACT 编程！数据库

> ID：684846
> 
> 赞同：1
> 
> 时间：2009-03-26T07:43:47.830
> 
> 标签：database, api, act

有谁知道 ACT 的数据库格式。我正在尝试为 ACT 编写导出器！我一直在寻找库，但找不到任何可以帮助我与 CRM 系统交互的明显库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T02:43:06.003

自 2000 年以来，我还没有使用 act 进行编程（不过，我在 2004 年进行了编程）。我使用他们的 ACTOLE.APPOBJECT com 对象从 delphi 2000 对其进行编程。我在一个指针上有一个 com 编程 pdf。也许它仍然可以从行为人那里获得。

-大学教师

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T08:52:55.583

对于遇到这种情况的任何人，要从 Sage ACT! 导出数据，您可以使用 ACT 附带的[ACTReader](http://kb.sagesoftwareonline.com/app/answers/detail/a_id/17538/~/what-is-the-act!-reader-utility)实用程序直接访问 SQL Server 数据库。此工具创建一个只读 sql 用户帐户，您可以使用该帐户在 SQL Server Management Studio 中打开数据库进行查看，或者在 db 连接中使用它来查询 ACT！像您对任何其他数据库一样的数据。

只有一次您想导入 ACT！您需要使用 .NET api（顺便说一句，您不需要从 Sage 下载“SDK”。它的文档大多稀疏且不是特别有用，您需要为 .NET api 编写代码的所有实际 .dll 文件都是与 ACT 一起安装！）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-04T10:01:18.117

刚刚发现这会寻找其他东西，并认为我会添加一些更有说服力的东西......

从法案导出！7/8 或更高版本可以通过多种方法完成：OLEDB、ODBC（或使用更高版本直接访问 SQL）、SDK、WebAPI 或一些已经将所有内容拉到 Excel 的第三方工具（或其他格式）。

前段时间我做了各种选项的介绍，发布在这里： [https ://blog.glcomputing.com.au/2009/07/connecting-to-act-by-sage-data.html](https://blog.glcomputing.com.au/2009/07/connecting-to-act-by-sage-data.html "连接到 ACT！ 通过 Sage 数据")

# svn - 当更改提交到 svn 时，ccnet 不会触发构建

> ID：684852
> 
> 赞同：1
> 
> 时间：2009-03-26T07:45:38.060
> 
> 标签：svn, build-process, cruisecontrol.net

ccnet 有问题。即使将更改提交给 SVN，服务器也无法检测到修改。有人可以帮忙吗？

* * *

**以下是 Cruise 的配置文件：**

项目 [http://cruise01/ccnet](http://cruise01/ccnet)

```
<sourcecontrol type="svn">
  <trunkUrl>http://svn01.com/abc/Project/trunk</trunkUrl>
  <workingDirectory>E:\Project\trunk</workingDirectory>
  <username>abc</username>
  <password>abcd</password>
  <timeout>36000000</timeout>
  <autoGetSource>true</autoGetSource>
  <tagOnSuccess>false</tagOnSuccess>
</sourcecontrol>

<tasks>
  <nant>
    <executable>E:\Project\trunk\tools\Nant\bin\NAnt.exe</executable>
    <buildFile>E:\Project\trunk\dev\build\Project.build</buildFile>
    <baseDirectory>E:\Project\trunk\dev\build</baseDirectory>
    <buildTimeoutSeconds>36000000</buildTimeoutSeconds>
    <logger>NAnt.Core.XmlLogger</logger>
    <targetList>
      <target>cruise</target>
    </targetList>
  </nant>
</tasks>
<publishers>
  <merge>
    <files>
      <file>E:\Project\trunk\dev\build\output\*.xml</file>
    </files>
  </merge>
  <xmllogger />
  <artifactcleanup cleanUpMethod="KeepLastXBuilds" cleanUpValue="100" />
</publishers> 
```

* * *

**ccnet 日志如下：**

2009-03-25 23:13:55,093 [CCNet Server:INFO] 注册频道：tcp 2009-03-25 23:13:55,093 [CCNet Server:INFO] CruiseManager：监听 url：tcp://10.7.5.98： 21234/CruiseManager.rem 2009-03-25 23:13:55,093 [CCNet Server:INFO] 启动 CruiseControl.NET 服务器 2009-03-25 23:13:55,109 [Project:INFO] 启动项目集成商：项目 2009-03 -25 23:14:55,046 [Project:INFO] 项目：“项目”已添加到队列：“项目”在位置 0。2009-03-25 23:14:56,093 [项目：INFO] 项目：“项目”是队列中的第一个：“项目”，应开始集成。2009-03-25 23:14:56,796 [Project:DEBUG] [http://svn01.com/abc/Project/trunk/dev](http://svn01.com/abc/Project/trunk/dev) 2009-03-25 23:14:56,812 [Project:DEBUG] 启动过程 [svn. exe] 在工作目录 [E:\Project\trunk\dev] 中，带有参数 [log[http://svn01.com/abc/Project/trunk/dev](http://svn01.com/abc/Project/trunk/dev)-r "{2009-03-25T17:27:24Z}:{2009-03-25T17:44:56Z}" --verbose --xml --username abc --password abcd --non-interactive --no- auth-cache] 2009-03-25 23:14:56,968 [468:DEBUG] [Project svn.exe] 2009-03-25 23:14:56,968 [468:DEBUG] [Project svn.exe] 2009-03- 25 23:14:56,968 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:14:56,984 [468:DEBUG] [项目 svn.exe] tm 2009-03-25 23:14:56,984 [ 468:DEBUG] [项目 svn.exe] 2009-03-25T17:16:09.658217Z 2009-03-25 23:14:56,984 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:14: 56,984 [468:DEBUG] [项目 svn.exe] /Project/trunk/dev/build/ccnet.config 2009-03-25 23:14:56,984 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:14:56,984 [468:DEBUG] [Project svn.exe] 修复构建 [jerry & tom] 2009-03-25 23:14:56,984 [468:DEBUG] [Project svn.exe] 2009-03-25 23 :14:56,984 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:14:57,078 [项目：调试][http://svn01.com/abc/Project/trunk/tools](http://svn01.com/abc/Project/trunk/tools) 2009-03-25 23:14:57,078 [Project:DEBUG] 在工作目录 [E:\Project\trunk\tools] 中启动进程 [svn.exe]带参数 [日志[http://svn01.com/abc/Project/trunk/tools](http://svn01.com/abc/Project/trunk/tools)-r "{2009-03-25T17:27:24Z}:{2009-03-25T17:44:56Z}" --verbose --xml --username abc --password abcd --non-interactive --no- auth-cache] 2009-03-25 23:14:57,250 [1560:DEBUG] [Project svn.exe] 2009-03-25 23:14:57,250 [1560:DEBUG] [Project svn.exe] 2009-03- 25 23:14:57,250 [1560:DEBUG] [Project svn.exe] 2009-03-25 23:14:57,359 [Project:DEBUG] 在 . 2009-03-25 23:14:57,359 [项目：信息] 未检测到修改。2009-03-25 23:15:57,406 [Project:INFO] 项目：“项目”已添加到队列：“项目”在位置 0。2009-03-25 23:15:57,515 [项目：INFO] 项目：“项目”在队列中排在第一位：“项目”，应开始集成。2009-03-25 23:15:57,515 [项目：调试] [http://svn01.com/abc/Project/trunk/dev](http://svn01.com/abc/Project/trunk/dev) 2009-03-25 23:15:57,515 [Project:DEBUG] 在工作目录 [E:\Project\trunk\dev] 中使用参数 [log [http://svn01.com/abc/Project ] 启动进程 [svn.exe] /主干/开发](http://svn01.com/abc/Project/trunk/dev)-r "{2009-03-25T17:27:24Z}:{2009-03-25T17:45:57Z}" --verbose --xml --username abc --password abcd --non-interactive --no- auth-cache] 2009-03-25 23:15:57,656 [1560:DEBUG] [Project svn.exe] 2009-03-25 23:15:57,656 [1560:DEBUG] [Project svn.exe] 2009-03- 25 23:15:57,656 [1560:DEBUG] [项目 svn.exe] 2009-03-25 23:15:57,656 [1560:DEBUG] [项目 svn.exe] tm 2009-03-25 23:15:57,656 [ 1560:DEBUG] [项目 svn.exe] 2009-03-25T17:17:54.682187Z 2009-03-25 23:15:57,656 [1560:DEBUG] [项目 svn.exe] 2009-03-25 23:15: 57,656 [1560:DEBUG] [项目 svn.exe] /Project/trunk/dev/build/ccnet.config 2009-03-25 23:15:57,671 [1560:DEBUG] [项目 svn.exe] 2009-03-25 23:15:57,671 [1560:DEBUG] [Project svn.exe] 修复构建 [jerry & tom] 2009-03-25 23:15:57,671 [1560:DEBUG] [Project svn.exe] 2009-03-25 23 ：15：57,671 [1560：调试] [项目svn。exe] 2009-03-25 23:15:57,765 [项目：调试][http://svn01.com/abc/Project/trunk/tools](http://svn01.com/abc/Project/trunk/tools) 2009-03-25 23:15:57,765 [Project:DEBUG] 在工作目录 [E:\Project\trunk\tools] 中启动进程 [svn.exe]带参数 [日志[http://svn01.com/abc/Project/trunk/tools](http://svn01.com/abc/Project/trunk/tools) -r "{2009-03-25T17:27:24Z}:{2009-03-25T17:45:57Z}" --verbose - -xml --username abc --password abcd --non-interactive --no-auth-cache] 2009-03-25 23:15:57,921 [468:DEBUG] [Project svn.exe] 2009-03-25 23 :15:57,921 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:15:57,921 [468:DEBUG] [项目 svn.exe] 2009-03-25 23:15:58,031 [项目：调试] 在 下找不到 s。2009-03-25 23:15:58,031 [项目：信息] 未检测到修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T12:10:28.283

当我们的颠覆和构建服务器的时钟不同步超过 10 分钟时，我们遇到了类似的问题。值得检查以消除它作为潜在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T12:07:52.970

很明显 CC.NET 不认为有任何修改，所以你可以做的一件事是从命令行发出 CC.NET 所做的 svn log 命令：

`svn log http://svn01.com/abc/Project/trunk/dev -r "{2009-03-25T17:27:24Z}:{2009-03-25T17:45:57Z}" --verbose --xml --username abc --password abcd --non-interactive --no-auth-cache]`

您会注意到的一件事是那里的时间。如果您希望看到的任何更改发生在此期间之前，它们都不会出现。看起来 CC.NET 只是回顾过去的 18 分钟。如果您在系统运行时进行签入怎么办？它还是不认识吗？

# drupal - 如何使用 Drupal trip_search 模块按类别搜索

> ID：684862
> 
> 赞同：1
> 
> 时间：2009-03-26T07:49:02.640
> 
> 标签：drupal

我正在使用 trip_search 模块，搜索时会显示所有结果。我只想要一张表的搜索结果。我能为此做些什么？而且我对trip_search模块中使用的函数module_invoke一无所知。希望得到答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T09:59:55.540

您是否检查过 trip_search（SQL 搜索）设置`index.php?q=admin/settings/trip_search`，例如

*   高级搜索页面选择标准选项：启用或禁用高级搜索页面上特定表单部分的显示：内容类型/类别/省略的词汇表/用户/省略的用户
*   结果过滤：将允许用户按类别/内容类型/用户进一步过滤搜索结果集
*   结果排名

?

对于`module_invoke`，请查看[Drupal](http://drupal.org/handbooks) [文档](http://api.drupal.org/api/function/module_invoke)和[Google](http://google.com/search?q=module_invoke)。简而言之，它在所有模块中调用指定的[*钩子*](http://google.com/search?q=Drupal+hooks)（`trip_search`, `search_item`）并收集结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T23:39:33.547

我认为第一个问题是“你为什么使用trip_search？”

它不再常用，因此您不太可能取得很大成功。

# sql - 我可以在 Win XP 上安装的 SQL 2005 版本是什么？

> ID：684863
> 
> 赞同：1
> 
> 时间：2009-03-26T07:49:11.283
> 
> 标签：sql, sql-server-2005

我可以在 Win XP 上安装的 SQL 2005 版本是什么？

我需要数据库并创建表，查询....

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T07:50:38.220

最好的选择可能是 SQL Server Express。 [http://www.microsoft.com/downloads/details.aspx?familyid=220549b5-0b07-4448-8848-dcc397514b41&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=220549b5-0b07-4448-8848-dcc397514b41&displaylang=en)

Express 版本提供了一个轻量级的 SQL Server 版本，适用于大多数独立应用程序和较小的 Web 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:06:49.680

SQL [Express](http://www.microsoft.com/sqlserver/2005/en/us/Express.aspx)或[SQL Compact 版本](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)。在大多数情况下，您将使用 SQL Express 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T17:12:44.833

如果您对 SQL Express 或 SQL Compact Edition 满意，请使用 thos。但是，如果您需要额外的功能，并且计划使用 XP 进行开发，然后使用 server 2003 或 2008 进行部署，则可以在 XP 上安装[SQL Server 开发版](http://www.microsoft.com/sqlserver/2005/en/us/developer.aspx)进行开发。这使您可以在开发过程中以低得多的价格访问所有企业功能。

# visual-studio-2008 - 在不使用 VISUAL STUDIO 2008 的情况下将现有文件添加到外部项目

> ID：684866
> 
> 赞同：1
> 
> 时间：2009-03-26T07:50:51.450
> 
> 标签：visual-studio-2008, projects-and-solutions

我的问题是使用我自己的代码生成器程序（如休眠）将 *.cs 文件复制到我的项目中，因此当我的代码生成器程序创建新的 .cs 类时，我希望将其复制到项目路径并通过 VS2008 解决方案资源管理器查看它。

（注意：通常你可以将文件复制到项目文件夹，但由于你没有使用 VS2008 界面，VS2008 看不到它）

感谢您的精彩回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T07:55:19.380

要将文件添加到项目中，您必须解析和修改 C# 项目 (.csproj) 文件。您需要为以下内容添加标签：

```
<ItemGroup>
  <Content Include="MyNewFile.cs">
    <SubType>Code</SubType>
  </Content>
</ItemGroup> 
```

有关可以添加的文件的更多示例，请参阅现有的 .csproj 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T07:55:41.593

如果您在记事本中打开 .vcproj 文件，您将看到如下内容：

```
<Files>
    <Filter
        Name="Source Files"
        Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
        UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}"
        >
        <File
            RelativePath=".\foo.cpp"
            >
        </File> 
```

您需要使用自己喜欢的 XML 解析 API 来添加更多元素。

编辑：

对于 .csproj，添加更多这样的元素：

```
<Compile Include="foo.cs" /> 
```

# php - 在 PHP 中记录线程

> ID：684869
> 
> 赞同：0
> 
> 时间：2009-03-26T07:55:14.293
> 
> 标签：php, logging

最近我遇到了这样的问题。我正在开发应用程序，其中日志记录非常重要。

通过登录该应用程序，我的意思是消息，例如

*   用户 A(id=x) 已创建发票（发票编号为 XXX）(1)
*   用户 B(id=y) 已购买图书 (2)
*   用户 A(id=x) 已批准发票 XXX (3)

(1) 和 (3) 是一个特定请求/命令的消息 - 所以当我想查看日志时，我需要获取有关此请求日志线程的所有信息。

由于应用程序负载很高并且大量使用 AJAX，不同用户/操作/请求的日志消息可能会混合在一起。

暂时，我已经解决了这个问题：

我在请求的开头创建了一些唯一的[UUID](http://en.wikipedia.org/wiki/UUID)代码，并在任何日志消息之前添加了这个唯一代码。因此，我可以通过简单的 grep UNIX 命令找到特定线程的所有消息。

这解决了问题，但我不确定它是否是该任务的最佳解决方案。看起来更像是重新发明轮子。你会为这个问题推荐什么解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:06:51.350

在我的脑海中，有几个建议（如果你还没有实现它们）

1.  将每种不同类型的事件记录到单独的日志文件中，例如 BookPurchases.log、InvoiceApprovals.log。也就是说，保留所有内容的原始输出日志，以防事件序列与分类相反。

2.  如果您还没有日志包，请使用日志包，例如[The Log Package](http://www.indelible.org/php/Log/guide.html)或[Zend_Log](http://framework.zend.com/manual/en/zend.log.html)，您可以在其中拥有不同的日志记录优先级。

我不知道这对你有没有用，因为你说的似乎很中肯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T09:37:27.560

如果您需要查看特定用户会话的所有日志，请使用

```
session_start()
```

在脚本的顶部，然后添加

```
session_id()
```

到每条日志消息的前面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T08:15:34.790

多年来，Java 世界中日志记录的事实标准一直是 log4j。这已被移植到许多其他语言 log4Net、log4Ruby 和[log4Php](http://logging.apache.org/log4php/)

我从未使用过 log4php，但如果它实现与其他框架相同的模式/算法，它肯定会完成你的工作。

我不会声称它比 karim79 推荐的任何一个选项都好，只是它遵循经过验证的设计。

# c# - 由于找到文档而迷失在带有 C# 的 .Net SDK 中

> ID：684873
> 
> 赞同：1
> 
> 时间：2009-03-26T07:56:19.627
> 
> 标签：c#, .net

有什么聪明和有用的东西可以让您搜索 Microsoft .Net 文档（在 Visual Studio 2008 中）？在你提到谷歌之前：在你可以用谷歌搜索这些东西之前，你必须知道你在搜索什么。

假设您不确切知道要查找什么，然后插入“.Net C# 字符串操作”......好吧......;)。

我正在寻找的是一些对初学者友好的小东西，只是必需品。对专业人士来说不是什么大不了的事，因为我认为 MS 的目标是这些人。只有那些。

谢谢，fnush

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:00:34.733

一旦您对要执行的操作有所了解，搜索 API 调用就会简单得多。您的查询越笼统，您得到的答案就越笼统和多样化。

在您的情况下，您正在寻找 C# 的介绍，因此请尝试在 Google 中搜索： [http ://www.google.com/search?q=Intro+to+C%23](http://www.google.com/search?q=Intro+to+C%23)

这应该会为您带来一些来自 Interwebs 的文档，这些文档将为您提供一个不错的 C# 介绍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:19:44.873

我发现单独启动离线 MSDN 库而不是让它出现在 Visual Studio 中会很有帮助。这样可以更轻松地以合适的大小进行浏览，而不会干扰您的实际编码窗口 - 而且我通常会在根本不打开 Visual Studio 的情况下查找文档。

我通常使用左侧的索引窗格——然后如果我需要了解特定命名空间或类型中的内容，我可以开始输入名称。当然，这只有在您知道要查找哪个名称空间的情况下才有效：所以我强烈建议您花半个小时浏览最重要的名称空间以了解它们。特别是，了解其中的内容：

*   系统
*   系统.IO
*   System.Collections
*   System.Collections.Generic
*   System.Linq
*   系统诊断
*   系统网
*   系统文件
*   System.ComponentModel
*   系统数据
*   对于网络用户界面：
    *   系统.Web.UI
    *   System.Web.UI.WebControls
*   对于 Windows 窗体：
    *   System.Windows.Forms
    *   系统绘图
*   对于 WPF：
    *   系统.Windows
    *   系统媒体

你不需要死记硬背地在那里学习任何东西 - 只需尝试了解在哪里的要点，这样你就知道以后要看哪里了。

我还发现，在搜索网络时，包括`site:msdn.microsoft.com`有很大帮助。当然，也有很多很棒的*非*MSDN 内容，但有时能够过滤它是件好事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T09:39:27.367

您也可以尝试[http://www.searchdotnet.com](http://www.searchdotnet.com)，这是一个自定义的 google 搜索，仅包含相关的 .NET 站点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T08:03:01.030

.NET Framework 的主要文档来源是 MSDN，它非常详尽。

[http://msdn.microsoft.com/en-us/library/default.aspx](http://msdn.microsoft.com/en-us/library/default.aspx)

您可以在这里找到标准 API 文档，还有更多：概述、原则、指南、提示等。我刚刚搜索了“C# 字符串操作”并得到以下结果：

[http://msdn.microsoft.com/en-us/library/ms228362.aspx](http://msdn.microsoft.com/en-us/library/ms228362.aspx)

这似乎是字符串工作方式的一个相当高级的指南，并且可以在框架中处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T08:03:12.840

如果您是初学者，我建议您选择一本有关 C# 的书来帮助您入门。这比使用 MSDN 文档作为基础要容易得多。

关于该读哪些书，关于 SO 有很多问题，所以应该很容易找到适合你的书。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T08:16:36.723

它必须在某个时候发生！

这个网站的设立是为了回应人们现在在网上找到所有信息，而不是阅读书籍。

现在 fnush 正在寻求一种获取信息的新方法，将其组织成一种易于消化的有序序列，这样初学者就可以从头开始并增长他们对该主题的知识，而不必知道要搜索什么接下来。

也许书籍最终会卷土重来！:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T09:17:01.367

嗯，是否有任何选项可以提取部分文档以供离线使用：

[http://msdn.microsoft.com/en-us/vcsharp/aa336803.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa336803.aspx)

似乎曾经有可能（[http://blogs.msdn.com/davbosch/archive/2007/04/28/take-parts-of-the-msdn-library-offline-with-packagethis.aspx](http://blogs.msdn.com/davbosch/archive/2007/04/28/take-parts-of-the-msdn-library-offline-with-packagethis.aspx)）但是由于更改在 MSDN 站点中不再存在。

提取它可以使搜索更有效；）

# c# - 更新 Linq 查询返回的结果集中的列值

> ID：684878
> 
> 赞同：1
> 
> 时间：2009-03-26T08:01:50.190
> 
> 标签：c#, linq

我想更新 linq 查询返回的结果集中的列的值。

我的代码是这样的

```
var result=from r in db.contents 
select new { match = r.text, id = r.id, index1 = (long)-1}

-- some calculation to find index value --

-- now update r.index=calculatedIndexValue for each record in result 
```

这种操作可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:14:55.293

LINQ 是一种查询语言，而不是一种编辑语言。对于实体操作（更改等），您需要使用数据上下文/实体管理器等的面向对象部分。所以基本上，您需要：

*   改用存储过程（或）
*   在输出中包含完整的实体 ( `r`)（单独或在匿名类型中）；更新此对象，并调用上下文“保存”方法（`SubmitChanges()`等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T08:09:38.707

不要这么想，不是不做一个新的查询（或重写原来的），以便它返回一个非匿名类型（即使用 linq 2 sql 或实体生成的类型）。

# macos - 在 Mac OS-X 上查找 GTK 小部件的窗口 ID

> ID：684889
> 
> 赞同：0
> 
> 时间：2009-03-26T08:05:56.763
> 
> 标签：macos, gtk

我正在尝试将基于 GTK 的 Linux 应用程序移植到 Mac OS-X。我的 GUI 工作正常，但现在我需要创建一个嵌入 MPlayer 的小部件。

我应该可以使用 MPlayer 的 -wid 选项将它嵌入到我的应用程序中，但我需要找到窗口 ID。有谁知道如何在 OS-X 上找到 GTK Widget 或 Container 的窗口 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T11:44:26.880

你在使用带有 X11 或 Quartz 后端的 GTK 吗？如果是 X11，我想它应该像在 Linux 上一样工作。否则我不认为你可以做你想做的事，MPlayer 想要一个 X11 窗口 ID，而你根本没有使用 X11。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-03T06:45:34.340

如果您将 Quartz 后端用于 GTK 或 MPlayer，则不能这样做。这种窗口嵌入技术仅适用于 X11。

（而且，如果您使用的是 X11，那么您几乎不会编写本机 OS X 应用程序！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-01T20:35:13.197

我认为可以通过以下方式完成：

```
(gulong)gdk_quartz_window_get_nsview(gtk_widget_get_window((GtkWidget *widget))); 
```

# xml - XSLT：获取最新日期

> ID：684894
> 
> 赞同：8
> 
> 时间：2009-03-26T08:07:33.377
> 
> 标签：xml, xslt, sorting

我有这样的结构：

```
 <Info ID="1">
    ...
    <Date>2009-04-21</Date>
  </Info>
  <Info ID="2">
    ...
    <Date>2009-04-22</Date>
  </Info>
  <Info ID="3">
    ...
    <Date>2009-04-20</Date>
  </Info> 
```

我想使用 XSLT 获取最新日期（在本例中为 2009-04-22）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-26T08:43:56.207

想通了，并没有我想象的那么难：

```
 <xsl:variable name="latest">
          <xsl:for-each select="Info">
            <xsl:sort select="Date" order="descending" />
            <xsl:if test="position() = 1">
              <xsl:value-of select="Date"/>
            </xsl:if>
          </xsl:for-each>
        </xsl:variable>
      <xsl:value-of select="$latest"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-12-07T20:07:12.850

在 XSLT 2.0 或更高版本中，您根本不需要排序；你可以用[`max()`](https://www.w3.org/TR/xpath-functions-3/#func-max)...

```
<xsl:value-of select="max(//Date/xs:date(.))"/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-06T19:33:56.657

XSLT 2.0+：`<xsl:perform-sort>`当我们想要对元素进行排序而不单独处理元素时使用。`<xsl:sort>`用于按排序顺序处理元素。由于在这种情况下您只需要最后一个日期，因此您不需要处理每个`<Info>`元素。使用`<xsl:perform-sort>`：

```
<xsl:variable name="sorted_dates">
  <xsl:perform-sort select="Info/Date">
     <xsl:sort select="."/>
  </xsl:perform-sort>
</xsl:variable>

<xsl:value-of select="$sorted_dates/Date[last()]"/> 
```

# clearcase - ClearCase : 用旧的基线活动建立新的基线

> ID：684895
> 
> 赞同：1
> 
> 时间：2009-03-26T08:08:23.513
> 
> 标签：clearcase

在集成流 Int 中，A1,A2,A3 是活动，B1 是包括 A1,A2,A3 活动的基线。

(Int Stream)-----A1------A2------A3------[B1]-- ------------>

我们要部署新版本的软件，我们的项目经理说他不想在这个版本的软件中包含 A2 活动变更集。

我们能否在 ClearCase 中创建仅包含 A1 和 A3 活动的新基线 B2？

(Int Stream)-----A1------------A3------[B2]------ ----------> ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:22:24.540

否：由于 B1 存在，所有活动都通过一个共同的“时间线”“链接”，ClearCase 会要求您也包括 A2。

一种可能的解决方案是创建一个子流，并`findmerge`仅使用 A1 和 A3制作 a
（`findmerge`a 是非 UCM 合并，仍然可以将 UCM 活动列表作为输入）

子流的基金基线应该是最后一个基线（在 IntStream 上产生） ，*不*包括 A1、A2 和 A3。

然后：

```
ct findmerge activity:A1@\pvob activity:A3@\pvob -fcsets -c "report for delivery" -merge -gmerge 
```

该子流扮演“发布流”或“整合流”的角色，这是一个包含构建最终版本所需的所有内容的流。

父流（IntStream）继续扮演整合所有开发工作（来自其他子流）的角色

* * *

笔记：

*   “pvob”是指用你的项目vob的名称替换（包含所有UCM数据的vob，如项目、流、基线、活动......）
*   “ `ct`”代表“cleartool”：它是一个`alias`（Unix）或一个`doskey`（Windows 版本的别名`doskey ct=cleartool $*`：）

* * *

**活动依赖**：在这种情况下，A3 可能有一些基于 A2 版本的版本。

`findmerge`命令仅将活动用于`changeset`要合并的（版本列表）：

> 变更集中列出的每个版本都成为合并操作中的源版本。与往常一样，to-version 是您认为的版本。

A3 包括在 A2 中所做的更改，最终结果将包括 A1、A2 和 A3 更改，除非 A1 和 A3 更改是“并发的”（类似行上的更改）：在这种情况下，需要执行非平凡的合并.

* * *

由于您不希望 A2 更改，正如您在评论中提到的那样，您需要`findmerge`使用 perl 实用程序脚本完成该操作`cset.pl`：

```
ccperl cset.pl -undo A2 
```

它将执行“负合并”（或“减法合并”），删除 A2 的任何更改。

# c# - 从 .NET 打印 API 检索设备上下文

> ID：684900
> 
> 赞同：1
> 
> 时间：2009-03-26T08:09:50.873
> 
> 标签：c#, .net, printing, pinvoke

我正在开发一个 .NET 应用程序来控制 DataCard 桌面卡打印机，但我偶然发现了一个问题。为了执行磁条和芯片编码，我必须调用本机打印机 API dll 中的函数来启用打印机交互模式。

我设法创建了 P/Invoke 代码来调用这个本机函数。但问题是该方法将打印机设备上下文句柄作为参数，并且必须在调用 Gdi32 StartDoc 函数之前调用。

在 .NET 打印 API 中，我确实可以从 Graphics 对象访问 hDC。但据我所知，Graphics 对象仅在调用 StartDoc 函数后可用。

所以我的问题是，是否有人知道在调用 StartDoc 之前检索上下文的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:18:00.603

您可以执行 a`OpenPrinter`来检索打印机句柄 ( `HANDLE`)，然后`CreateDC`通过传入此句柄进行调用以随时（之前`StartDoc`）获取打印机 DC。

# visual-studio-2008 - Visual Studio 2008 SP1 有冻结的字段

> ID：684902
> 
> 赞同：1
> 
> 时间：2009-03-26T08:10:29.763
> 
> 标签：visual-studio-2008, resharper

为 Visual Studio 2008 安装 SP1 后，各种字段被冻结，例如在“查找和替换”对话框中我无法输入任何内容，或在“工具”->“外部工具”中所有字段（文本框）都被冻结，无法输入任何内容。与 ReSharper 相同，无法在其任何对话框中输入任何内容...

你知道任何解决方法吗？如果我重新启动视觉工作室，它有时会有所帮助，有时有时不会。这是由 SP1 引起的还是可能是 ReSharper？谢谢。

好的，所以这个问题发生在我同事的电脑上，它没有安装 ReSharper。这也发生在 Vista 和 XP 上。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:39:32.517

如果您还没有，我会尝试重新安装 resharper。

如果没有更多细节就无法确定，但我已经在不同的操作系统配置上多次安装 vs sp1 没有任何问题，但是我在使用 Reshaper 时遇到了问题，所以我敢打赌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:54:02.280

*   尝试在启用日志记录的情况下运行 Visual Studio (devenv /out [日志文件名])
*   尝试使用已关闭的附加组件 (devenv /resetaddin Namespace.ClassName) 运行 Visual Studio

devenv /ResetSkipPkgs

这可以帮助您发现问题，甚至可以解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T23:23:27.353

尝试重置您的设置。工具--> 导入和导出设置... 在此对话框中，您可以重置 IDE 设置，选择将所有环境设置重置为默认设置集合之一。（C# 开发人员、Web 开发人员、项目经理……）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-15T22:24:32.177

它可能是安装了一些更新/插件的组合。上次更新后，它再次正常工作。

# php - 如何添加一个链接，让用户在我的网站上更改他们的 Gravatar？

> ID：684904
> 
> 赞同：16
> 
> 时间：2009-03-26T08:10:58.687
> 
> 标签：php, gravatar

如何添加一个链接，让用户在我的网站上更改他们的 Gravatar？（与您在 Wordpress 上更改 Gravatar 的方式相同）

谢谢，肯尼斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T08:15:50.000

如果您提供指向[http://en.gravatar.com/emails/](http://en.gravatar.com/emails/)的链接，他们会转到 Gravatar 网站，在那里他们可以登录并更改他们的帐户。我不确定是否有任何其他公共 API 允许这种更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-18T23:35:55.117

查看 wordpress.com 上的 html 源代码，看起来他们正在使用[ThickBox](http://jquery.com/demo/thickbox/)之类的东西在 iframe 中加载 Gravatar 网站：

```
<a href="https://secure.gravatar.com/accounts/force-by-email/wpcom/username/somecode?TB_iframe=true&amp;height=475&amp;width=960" id="gravatar_ui" class="thickbox" title="gravatar.com" onclick="return false;">
   <img src="https://secure.gravatar.com/avatar/gravatarid?s=128&amp;r=any&amp;time=43179786" class="no-grav">
   <p style="text-align: center;">Change your Gravatar</p>
</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T20:24:22.480

Automattic 的 Gravatar API 不提供此功能。您最好的选择是将用户链接到 Gravatar 网站。

如果你真的想要你可以用 CSRF 做一些试验，我还没有测试过 Gravatar 网站是否能防止这种利用。最好的情况是，它会参差不齐——我无法想象有人会像他们的 Twitter 账户一样始终保持登录到 Gravatar 账户。

最后，您可以在 iFrame 中加载 Gravatar 站点，这样用户就不会真正离开您的域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T20:05:35.513

Gravatar 不允许此功能。WordPress.com 能做到这一点的唯一原因是因为它们都是 Automattic 的服务，而且它们都使用 WordPress.com 帐户，所以他们得到了一些额外的字符串。您最好的选择是链接到 Gravatar 网站，或将其加载到 iframe 中。如果您在 iframe 中加载它，它会提示他们登录到他们的 WordPress.com 帐户，除非他们经常使用 WordPress.com，并且他们的浏览器保持登录到该帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-19T01:40:48.550

应该可以使用 XML-RPC 实现头像的转换。协议由 Gravatar 指定：[http ://en.gravatar.com/site/implement/xmlrpc/](http://en.gravatar.com/site/implement/xmlrpc/)

其实有电话

*   `grav.saveData`- 将二进制图像数据保存为此帐户的用户图像
*   `grav.saveUrl`- 通过其 URL 读取图像并将其另存为该帐户的用户图像

因此，您需要自己实施更改，但可以避免人们必须在 gravatar 上登录。

# macos - 如何检测 OS X 应用程序是否已经启动

> ID：684911
> 
> 赞同：22
> 
> 时间：2009-03-26T08:14:44.560
> 
> 标签：macos, boost, resources, macos-carbon, launch

通常，OS X 上的应用程序包只能启动一次，但是通过简单地复制包，相同的应用程序可以启动两次。检测和阻止这种可能性的最佳策略是什么？

在 Windows 上，这种效果可以简单地通过应用程序在启动时创建命名资源来实现，然后如果无法创建命名资源则退出，这表明另一个进程正在运行，并且已经创建了相同的资源。当应用程序退出时，这些资源会在 Windows 上以可靠的方式释放。

我在研究这个问题时看到的问题是，OS X 上的 API 在文件系统中保持状态，从而使 Windows 上使用的策略不可靠，即在不正确退出后延迟文件可能错误地表明应用程序已经在运行。

我可以用来在 OS X 上实现相同效果的 API 是：posix、carbon 和 boost。

想法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-09-22T15:14:19.000

这在雪豹中非常容易：

```
- (void)deduplicateRunningInstances {
    if ([[NSRunningApplication runningApplicationsWithBundleIdentifier:[[NSBundle mainBundle] bundleIdentifier]] count] > 1) {
        [[NSAlert alertWithMessageText:[NSString stringWithFormat:@"Another copy of %@ is already running.", [[NSBundle mainBundle] objectForInfoDictionaryKey:(NSString *)kCFBundleNameKey]] 
                         defaultButton:nil alternateButton:nil otherButton:nil informativeTextWithFormat:@"This copy will now quit."] runModal];

        [NSApp terminate:nil];
    }
} 
```

有关详细信息，请参阅[http://blog.jseibert.com/post/1167439217/deduplicating-running-instances-or-how-to-detect-if](http://blog.jseibert.com/post/1167439217/deduplicating-running-instances-or-how-to-detect-if)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-26T11:33:11.180

一个低级的解决方案是使用flock()。

每个实例都会在启动时尝试锁定文件，如果锁定失败，则另一个实例已经在运行。当你的程序退出时，Flock 会自动释放，所以不用担心过时的锁。

请注意，无论您选择哪种解决方案，您都需要有意识地决定拥有“多个实例”的含义。具体来说，如果多个用户同时运行您的应用程序，可以吗？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-03-08T01:58:00.737

有一个名为“应用程序禁止多个实例”的神秘 Info.plist 键，但它似乎对我不起作用。我正在编写一个 CLI 应用程序并从一个包中执行它。也许它可以在 GUI 应用程序中工作，但我还没有尝试过。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-04T22:11:11.057

如前所述，Cocoa 应用程序通常不允许您一次运行多个实例。

一般来说，解决这个问题的可可方法请看 NSWorkspace 中的已启动应用程序。这将返回一个 NSArray，其中包含每个启动的应用程序的字典。您可以遍历数组以查看您要查找的应用程序是否已在运行。我建议您使用带有键 NSApplicationBundleIdentifier 的值，该值将具有类似“com.mycompany.myapp”的值，而不是查找名称。如果您需要查找应用程序的捆绑标识符，您可以查看应用程序包中的 info.plist 文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-26T08:39:35.763

首先，它是“Mac OS X”或“OS X”。没有“OS/X”之类的东西。

其次，Mac OS X 没有 Boost。您需要将它与您的应用程序捆绑在一起。

第三，大多数 Carbon 在 64 位中不可用。这是一个明确的信号，即 Carbon 的这些部分有一天会消失（当 Apple 在其硬件中放弃 32 位时）。迟早，你要么用 Cocoa 重写你的应用程序，要么放弃 Mac。

> 通常，OS/X 上的应用程序包只能启动一次，但是通过简单地重命名包，相同的应用程序可以启动两次。

不，它不能。启动重命名或移动的应用程序将简单地激活（带到前面）已经运行的进程；它不会与第一个进程一起启动新的第二个进程。

* * *

有几种方法可以判断应用程序是否已经在运行。在每种情况下，您都在启动时执行此操作：

1.  使用 Cocoa 的 NSConnection 注册一个具有单个常量名称的连接。如果名称已经注册，这将失败。（您可以从 Carbon 应用程序中使用 Foundation；这是您必须小心使用的应用程序工具包。）
2.  使用进程管理器扫描进程列表以查找其包标识符与您要查找的进程匹配的进程。包标识符不是不可更改的，但它比文件名或位置更难更改。
3.  如果您想查看某人何时运行您自己的第二个副本，您可以使用 CFNotificationCenter：

    1.  将自己添加为“com.yourdomain.yourappname.LaunchResponse”的观察者。
    2.  以“com.yourdomain.yourappname.LaunchCall”的名称发布通知。
    3.  将自己添加为“com.yourdomain.yourappname.LaunchCall”的观察者。

    在呼叫通知的观察回调中，发布响应通知。
    在响应通知的观察回调中，退出。

    因此，当第一个进程启动时，它将调用并没有得到响应；当第二个进程启动时，它将调用，从第一个进程获取响应，然后退出第一个进程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-03T11:14:04.943

这是 Romans 和 Jeff 对 Swift 2.0 的回答的组合：如果具有相同捆绑 ID 的应用程序的另一个实例已经在运行，则显示警报，激活另一个实例并退出重复的实例。

```
func applicationDidFinishLaunching(aNotification: NSNotification) {
    /* Check if another instance of this app is running. */
    let bundleID = NSBundle.mainBundle().bundleIdentifier!
    if NSRunningApplication.runningApplicationsWithBundleIdentifier(bundleID).count > 1 {
        /* Show alert. */
        let alert = NSAlert()
        alert.addButtonWithTitle("OK")
        let appName = NSBundle.mainBundle().objectForInfoDictionaryKey(kCFBundleNameKey as String) as! String
        alert.messageText = "Another copy of \(appName) is already running."
        alert.informativeText = "This copy will now quit."
        alert.alertStyle = NSAlertStyle.CriticalAlertStyle
        alert.runModal()

        /* Activate the other instance and terminate this instance. */
        let apps = NSRunningApplication.runningApplicationsWithBundleIdentifier(bundleID)
        for app in apps {
            if app != NSRunningApplication.currentApplication() {
                app.activateWithOptions([.ActivateAllWindows, .ActivateIgnoringOtherApps])
                break
            }
        }
        NSApp.terminate(nil)
    }

    /* ... */
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T08:39:10.117

[工控机](http://en.wikipedia.org/wiki/Inter-process_communication)呢？您可以打开一个套接字并与另一个启动的实例进行协商。但是，您必须小心，如果两个应用程序同时启动，它就会起作用。

我无法为您提供示例代码，因为我还没有（还没有，但我很快会）使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-10T16:05:59.033

这是**Swift 3.0**的 seb 版本：如果具有相同捆绑 ID 的应用程序的另一个实例已经在运行，则显示警报，激活另一个实例并退出重复的实例。

```
func applicationDidFinishLaunching(aNotification: NSNotification) {
    /* Check if another instance of this app is running. */
    let bundleID = Bundle.main.bundleIdentifier!
    if NSRunningApplication.runningApplications(withBundleIdentifier: bundleID).count > 1 {
         /* Show alert. */
         let alert = NSAlert()
         alert.addButton(withTitle: "OK")
         let appName = Bundle.main.object(forInfoDictionaryKey: kCFBundleNameKey as String) as! String
         alert.messageText = "Another copy of \(appName) is already running."
         alert.informativeText = "This copy will now quit."
         alert.alertStyle = NSAlert.Style.critical
         alert.runModal()

         /* Activate the other instance and terminate this instance. */
         let apps = NSRunningApplication.runningApplications(withBundleIdentifier: bundleID)
             for app in apps {
                  if app != NSRunningApplication.current {
                      app.activate(options: [.activateAllWindows, .activateIgnoringOtherApps])
                      break
                  }
             }
                NSApp.terminate(nil)
         }   
       /* ... */
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-21T06:23:24.717

检测具有相同bundleID的应用程序是否正在运行，激活它并关闭启动。

```
- (id)init method of < NSApplicationDelegate >

    NSArray *apps = [NSRunningApplication runningApplicationsWithBundleIdentifier:[[NSBundle mainBundle] bundleIdentifier]];
    if ([apps count] > 1)
    {
        NSRunningApplication *curApp = [NSRunningApplication currentApplication];
        for (NSRunningApplication *app in apps)
        {
            if(app != curApp)
            {
                [app activateWithOptions:NSApplicationActivateAllWindows|NSApplicationActivateIgnoringOtherApps];
                break;
            }
        }
        [NSApp terminate:nil];
        return nil;
    } 
```

# javascript - 我可以从 javascript 中的临时 Internet 文件中删除文件吗？

> ID：684917
> 
> 赞同：2
> 
> 时间：2009-03-26T08:17:43.507
> 
> 标签：javascript, file-io

我有一个页面需要在 onload 事件上下载图像文件，但是对于所有页面调用！现在，它在第一次调用中下载图像，但在第二次调用中它是从临时获取的，这不是我想要的。我需要为每个负载做一些计算。所以我想删除我在每次加载时从临时或其他强制客户端再次从服务器下载它的文件下载的文件。

一个javascript解决方案会很棒。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T08:22:36.443

不，您根本无法使用 Javascript 对缓存执行任何操作，但您可以更改图像的 url，使其不在缓存中。

只需在图片的url中添加一个查询字符串，每次都使用当前时间使其唯一：

```
<script type="text/javascript">
document.write('<img src="images/theImage.gif?t=' + new Date().getTime() + '" alt="" />');
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T08:22:15.993

我了解您正在寻找 javascript 解决方案，但解决此问题的好方法是使用指定无缓存和到期值的 HTTP 响应标头。如果您无法使用 .htaccess 控制 Web 服务器配置，则可以创建一个简单的 PHP 脚本，在提供内容之前设置这些标头。在 PHP 中：

```
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T08:24:38.077

将 URL 字符串修改为如下所示：

```
originalUrl += "?" + new Date().getTime(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T08:21:58.833

我会为正在下载到 Cache-Control 的图像设置 HTTP 标头：no-cache，而不是想出一些 javascript “hack”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T08:24:26.517

您绝对不能使用 javascript 删除临时文件。为了避免缓存，在发送图像时使用 no-cache 标头。这样每次请求时都会下载图像。

[此处](http://en.wikipedia.org/wiki/List_of_HTTP_headers)的标头列表。

您必须使用：

缓存控制：无缓存

[这](http://support.microsoft.com/kb/234067)是微软特有的。

# delphi - 将 Windows 事件日志改造为 Delphi 5 应用程序

> ID：684919
> 
> 赞同：4
> 
> 时间：2009-03-26T08:18:54.020
> 
> 标签：delphi, delphi-5, event-log

我正在寻找一种（相当轻松）向小型旧版 Delphi 5 应用程序添加一些 Windows 应用程序事件日志支持的方法。我们只希望它在启动、关闭、无法连接到数据库等时记录下来。

我见过的几个解决方案/组件似乎表明我们需要创建一个资源 DLL，Windows 事件日志查看器在尝试读取我们的“条目”时将链接到该 DLL。虽然这看起来并不太繁琐，但我想如果/当我们将来进一步开发应用程序时，还需要记住其他一些事情——我们需要让这个 DLL 保持最新。

在未来的某个时候，我们希望将应用程序变成服务，可能是用 D2007 编写的。

那么任何人都可以推荐一条合适的路线来将事件添加到 D5 中的事件日志中吗？我正在寻找具体的“*我们使用了这个并且没问题*”的评论，而不是谷歌拖网（我可以自己做！）免费或付费，真的不介意 - 但我可以迁移到 D2007未来很重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-14T06:41:37.203

*摘要：使用 Delphi 写入 Windows 事件日志*

* * *

如果您正在编写 Windows 服务并且需要写入本地计算机的 Windows 事件日志，那么您可以调用 [TService。](http://docwiki.embarcadero.com/Libraries/XE8/en/Vcl.SvcMgr.TService.LogMessage)**[此处](https://stackoverflow.com/questions/1303253/any-light-for-teventlogger/1303290#1303290)提到的[**LogMessage**](http://docwiki.embarcadero.com/Libraries/XE8/en/Vcl.SvcMgr.TService.LogMessage)。**

 **```
//TMyTestService = class(TService)

procedure TMyTestService.ServiceStart(Sender: TService; var Started: Boolean);
begin
  LogMessage('This is an error.');
  LogMessage('This is another error.', EVENTLOG_ERROR_TYPE);
  LogMessage('This is information.', EVENTLOG_INFORMATION_TYPE);
  LogMessage('This is a warning.', EVENTLOG_WARNING_TYPE);
end; 
```

* * *

对于任何其他类型的应用程序，您可以使用 SvcMgr。**TEventLogger** [未记录](http://docwiki.embarcadero.com/Libraries/XE8/en/Vcl.SvcMgr.TEventLogger)的 TService帮助器类，用于编写本地计算机的 Windows 事件日志，如此[处](https://stackoverflow.com/questions/1303253/any-light-for-teventlogger/1303290#1303290)、[此处](https://stackoverflow.com/questions/684919/retrofitting-windows-event-log-to-a-delphi-5-app/685235#685235)和[此处](https://stackoverflow.com/a/685342/119789)所述。

```
uses
  SvcMgr;

procedure TForm1.EventLoggerExampleButtonClick(Sender: TObject);
begin
  with TEventLogger.Create('My Test App Name') do
  begin
    try
      LogMessage('This is an error.');
      LogMessage('This is another error.', EVENTLOG_ERROR_TYPE);
      LogMessage('This is information.', EVENTLOG_INFORMATION_TYPE);
      LogMessage('This is a warning.', EVENTLOG_WARNING_TYPE);
    finally
      Free;
    end;
  end;
end; 
```

* * *

您还可以使用[此处](https://stackoverflow.com/questions/397934/writing-to-the-event-log-in-delphi/400104#400104)和[此处](https://stackoverflow.com/questions/1303253/any-light-for-teventlogger/1303409#1303409)提到的 Windows API [**ReportEvent**](https://msdn.microsoft.com/en-us/library/windows/desktop/aa363679%28v=vs.85%29.aspx)函数。

我创建了一个简单的类来使它更容易，它[可以在 GitHub 上找到](https://github.com/Kobus-Smit/EventLogHelper)。

```
//----------------- EXAMPLE USAGE: ---------------------------------

uses
  EventLog;

procedure TForm1.EventLogExampleButtonClick(Sender: TObject);
begin
  TEventLog.Source := 'My Test App Name';

  TEventLog.WriteError('This is an error.');
  TEventLog.WriteInfo('This is information.');
  TEventLog.WriteWarning('This is a warning.');
end;

//------------------------------------------------------------------

unit EventLog;

interface

type
  TEventLog = class
  private
    class procedure CheckEventLogHandle;
    class procedure Write(AEntryType: Word; AEventId: Cardinal; AMessage: string); static;
  public
    class var Source: string;
    class destructor Destroy;

    class procedure WriteInfo(AMessage: string); static;
    class procedure WriteWarning(AMessage: string); static;
    class procedure WriteError(AMessage: string); static;

    class procedure AddEventSourceToRegistry; static;
  end;

threadvar EventLogHandle: THandle;

implementation

uses Windows, Registry, SysUtils;

class destructor TEventLog.Destroy;
begin
  if EventLogHandle > 0 then
  begin
    DeregisterEventSource(EventLogHandle);
  end;
end;

class procedure TEventLog.WriteInfo(AMessage: string);
begin
  Write(EVENTLOG_INFORMATION_TYPE, 2, AMessage);
end;

class procedure TEventLog.WriteWarning(AMessage: string);
begin
  Write(EVENTLOG_WARNING_TYPE, 3, AMessage);
end;

class procedure TEventLog.WriteError(AMessage: string);
begin
  Write(EVENTLOG_ERROR_TYPE, 4, AMessage);
end;

class procedure TEventLog.CheckEventLogHandle;
begin
  if EventLogHandle = 0 then
  begin
   EventLogHandle := RegisterEventSource(nil, PChar(Source));
  end;
  if EventLogHandle <= 0 then
  begin
    raise Exception.Create('Could not obtain Event Log handle.');
  end;
end;

class procedure TEventLog.Write(AEntryType: Word; AEventId: Cardinal; AMessage: string);
begin
  CheckEventLogHandle;
  ReportEvent(EventLogHandle, AEntryType, 0, AEventId, nil, 1, 0, @AMessage, nil);
end;

// This requires admin rights. Typically called once-off during the application's installation
class procedure TEventLog.AddEventSourceToRegistry;
var
  reg: TRegistry;
begin
  reg := TRegistry.Create;
  try
    reg.RootKey := HKEY_LOCAL_MACHINE;
    if reg.OpenKey('\SYSTEM\CurrentControlSet\Services\Eventlog\Application\' + Source, True) then
    begin
      reg.WriteString('EventMessageFile', ParamStr(0)); // The application exe's path
      reg.WriteInteger('TypesSupported', 7);
      reg.CloseKey;
    end
    else
    begin
      raise Exception.Create('Error updating the registry. This action requires administrative rights.');
    end;
  finally
    reg.Free;
  end;
end;

initialization

TEventLog.Source := 'My Application Name';

end. 
```

* * *

[**ReportEvent**](https://msdn.microsoft.com/en-us/library/windows/desktop/aa363679%28v=vs.85%29.aspx)支持将日志条目写入本地或远程计算机的事件日志。有关远程示例，请参阅[John Kaster 的 EDN 文章](http://edn.embarcadero.com/article/40404)。

* * *

**请注意，您还必须[创建一个消息文件](https://msdn.microsoft.com/en-us/library/aa363669(v=vs.85).aspx)并[注册您的事件源](https://msdn.microsoft.com/en-us/library/aa363634(VS.85).aspx)**，否则您的所有日志消息都将以如下内容开头：

> 找不到来自源 xxxx 的事件 ID xxx 的描述。引发此事件的组件未安装在本地计算机上，或者安装已损坏。您可以在本地计算机上安装或修复组件。
> 
> 如果事件起源于另一台计算机，则显示信息必须与事件一起保存。
> 
> 活动中包含以下信息：

1，有关如何创建消息文件的更多信息，请参阅[Finn Tolderlund 的教程](http://www.tolderlund.eu/delphi/service/service.htm#Using%20LogMessage)或[Michael Hex 的文章，或者您可以使用](http://texhex.blogspot.com.au/2004/09/creating-event-message-file-for-event.html)[GitHub 项目中包含](https://github.com/Kobus-Smit/EventLogHelper/tree/master/Test%20app/Source/MessageFile) 的现有 MC 和RES 文件。

2，通过将 MessageFile.res 包含在 DPR 文件中，将 RES 文件嵌入到您的应用程序中。或者，您可以为消息创建一个 dll。

```
program MyTestApp;

uses
  Forms,
  FormMain in 'FormMain.pas' {MainForm},
  EventLog in 'EventLog.pas';

{$R *.res}
{$R MessageFile\MessageFile.res}

begin
  Application.Initialize; 
```

3，一次性注册需要管理员权限写入注册表，所以我们通常在您的应用程序安装过程中完成。

```
//For example
AddEventSourceToRegistry('My Application Name', ParamStr(0));
//or
AddEventSourceToRegistry('My Application Name', 'C:\Program Files\MyApp\Messages.dll');

//--------------------------------------------------

procedure AddEventSourceToRegistry(ASource, AFilename: string);
var
  reg: TRegistry;
begin
  reg := TRegistry.Create;
  try
    reg.RootKey := HKEY_LOCAL_MACHINE;
    if reg.OpenKey('\SYSTEM\CurrentControlSet\Services\Eventlog\Application\' + ASource, True) then
    begin
      reg.WriteString('EventMessageFile', AFilename);
      reg.WriteInteger('TypesSupported', 7);
      reg.CloseKey;
    end
    else
    begin
      raise Exception.Create('Error updating the registry. This action requires administrative rights.');
    end;
  finally
    reg.Free;
  end;
end; 
```

* * *

如果您需要 Windows 事件日志记录和其他日志记录要求，您还可以使用[log4d](http://sourceforge.net/projects/log4d/)和[TraceTool等日志记录框架](http://tracetool.sourceforge.net/)

* * *

如果要写入 Delphi IDE 中的事件日志窗口，请参见[此处。](https://stackoverflow.com/questions/397934/writing-to-the-event-log-in-delphi)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T11:15:45.200

对于 D5 中的简单事件日志记录，我使用以下代码将消息添加到应用程序日志。

*   将“SvcMgr”添加到使用子句
*   使用此代码添加您的短信和 ID 号（LogMessage 行的最后一个参数）

    ```
    with TEventLogger.create('My Application Name') do
    begin
      try
        LogMessage('Information Message!', EVENTLOG_INFORMATION_TYPE, 0, 1);
        LogMessage('Error Message!', EVENTLOG_ERROR_TYPE, 0, 2);
        LogMessage('Warning Message!', EVENTLOG_WARNING_TYPE, 0, 3);
        LogMessage('Audit Success Message!', EVENTLOG_AUDIT_SUCCESS, 0, 4);
        LogMessage('Audit Failure Message!', EVENTLOG_AUDIT_FAILURE, 0, 5);
      finally
        free;
      end;
    end; 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T10:40:31.637

我在 Delphi 6 中为此使用标准 VCL，我无法告诉您这在 Delphi 5 中是否可用。自己尝试一下，让我们知道 D5 中是否有这些东西。

1.  声明一个 TEventLogger 类型的全局/表单变量。这是在 SvcMgr 单元中声明的，因此需要将此单元添加到您的使用列表中。如果这是一个普通的应用程序（即不是一个服务），那么请确保在表单单元之后添加了 SvcMgr。

    我的事件日志：TEventLogger；

2.  创建记录器的实例。

    MyEventLog := TEventLogger.Create('MyApplication');

3.  要写入事件日志：

    MyEventLog.LogMessage('MyApplication 已启动。'), EVENTLOG_INFORMATION_TYPE);

4.  不要忘记在最后释放它：

    MyEventLog.免费；

您还需要做其他事情来使用 Windows 事件日志注册应用程序，以便消息出现在其前面而没有此内容：

*找不到源 (Microsoft Internet Explorer) 中事件 ID (1000) 的描述。本地计算机可能没有必要的注册表信息或消息 DLL 文件来显示来自远程计算机的消息。以下信息是事件的一部分：*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T07:20:34.887

感谢*J*和 Peter 的回复，我立即将代码写入事件日志。还有一些事情要做，特别是如果您希望您的事件在事件日志中“很好地”显示，而没有关于无法找到描述的标准 Windows 消息（根据*J*的帖子的底部）。

我按照[这里](http://texhex.blogspot.com/2004/09/creating-event-message-file-for-event.html)的提示制作了一个合适的 DLL 并将其输入到注册表中，并且很快就解决了所有问题。

根据问题，这一切都在Delphi5中，但我没有看到任何让我认为它在D2007中也不起作用的东西。

# database - 从 oracle 10g 导出数据并导入到 oracle 9i

> ID：684922
> 
> 赞同：1
> 
> 时间：2009-03-26T08:20:08.570
> 
> 标签：database, import, oracle10g, export

大家好，您能告诉我如何将数据从 oracle 10g 导入到 Oracle 9i。我可以从Oracle 10g 导出数据并直接将其导入9i 是否可以，它应该可以工作？？？或者我需要遵循一些其他程序？？？

请帮助我提前谢谢约瑟夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T13:49:48.130

Exp 和 Imp 是进行单个数据移动的最佳方式。如果您需要持续访问数据，我会支持数据库链接的建议。

一个问题是 imp 和 exp 生成的文件不向后兼容。即如果你使用10g版本的exp创建转储文件，则不能使用9i版本的imp导入数据。

这种情况下需要使用9i版本的exp，连接10g的数据库，然后使用9i版本的imp导入数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:28:59.987

您应该能够使用通常的 exp / imp 命令进行导出以执行传输。

[http://wiki.oracle.com/page/Oracle+export+and+import](http://wiki.oracle.com/page/Oracle+export+and+import)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T08:35:09.987

您还可以在数据库之间创建数据库链接。exp / imp 更快，但数据库链接可以进行连续导出/导入。

# .net - 将十六进制字符串转换为字节数组（.NET）的最佳方法是什么？

> ID：684925
> 
> 赞同：2
> 
> 时间：2009-03-26T08:21:45.103
> 
> 标签：.net, hex

我有一个需要转换为字节数组的十六进制字符串。最好的方法（即高效且代码最少）是：

```
string hexstr = "683A2134";
byte[] bytes = new byte[hexstr.Length/2];
for(int x = 0; x < bytes.Length; x++)
{
    bytes[x] = Convert.ToByte(hexstr.Substring(x * 2, 2), 16);
} 
```

在我有 32 位值的情况下，我可以执行以下操作：

```
string hexstr = "683A2134";
byte[] bytes = BitConverter.GetBytes(Convert.ToInt32(hexstr, 16)); 
```

但是在一般情况下呢？是否有更好的内置功能，或更清晰（不必更快，但仍然高效）的方式来做到这一点？

我更喜欢内置功能，因为除了这个特定的转换之外，似乎所有东西（很常见的东西）都有一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T09:43:06.813

如果您从字符代码计算值而不是创建子字符串并解析它们，您将获得最佳性能。

C# 中的代码，处理大小写十六进制（但没有验证）：

```
static byte[] ParseHexString(string hex) {
    byte[] bytes = new byte[hex.Length / 2];
    int shift = 4;
    int offset = 0;
    foreach (char c in hex) {
        int b = (c - '0') % 32;
        if (b > 9) b -= 7;
        bytes[offset] |= (byte)(b << shift);
        shift ^= 4;
        if (shift != 0) offset++;
    }
    return bytes;
} 
```

用法：

```
byte[] bytes = ParseHexString("1fAB44AbcDEf00"); 
```

由于代码使用了一些技巧，这里有一个注释版本：

```
static byte[] ParseHexString(string hex) {
    // array to put the result in
    byte[] bytes = new byte[hex.Length / 2];
    // variable to determine shift of high/low nibble
    int shift = 4;
    // offset of the current byte in the array
    int offset = 0;
    // loop the characters in the string
    foreach (char c in hex) {
        // get character code in range 0-9, 17-22
        // the % 32 handles lower case characters
        int b = (c - '0') % 32;
        // correction for a-f
        if (b > 9) b -= 7;
        // store nibble (4 bits) in byte array
        bytes[offset] |= (byte)(b << shift);
        // toggle the shift variable between 0 and 4
        shift ^= 4;
        // move to next byte
        if (shift != 0) offset++;
    }
    return bytes;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T08:25:49.197

不幸的是，没有内置任何东西。（我真的应该有我在其他地方得到的代码——这至少是我第三次或第四次编写它。）

您当然可以创建一个更有效的版本，从 char 解析 nybble 而不是每次都获取子字符串，但它的代码更多。如果您经常使用它，请先对原始代码进行基准测试以查看它是否足够。

```
private static int ParseNybble(char nybble)
{
    // Alternative implementations: use a lookup array
    // after doing some bounds checking, or use 
    // if (nybble >= '0' && nybble <= '9') return nybble-'0' etc
    switch (nybble)
    {
        case '0' : return 0;
        case '1' : return 1;
        case '2' : return 2;
        case '3' : return 3;
        case '4' : return 4;
        case '5' : return 5;
        case '6' : return 6;
        case '7' : return 7;
        case '8' : return 8;
        case '9' : return 9;
        case 'a': case 'A' : return 10;
        case 'b': case 'B' : return 11;
        case 'c': case 'C' : return 12;
        case 'd': case 'D' : return 13;
        case 'e': case 'E' : return 14;
        case 'f': case 'F' : return 15;
        default: throw new ArgumentOutOfRangeException();
    }
}

public static byte[] ParseHex(string hex)
{
    // Do error checking here - hex is null or odd length
    byte[] ret = new byte[hex.Length/2];
    for (int i=0; i < ret.Length; i++)
    {
        ret[i] = (byte) ((ParseNybble(hex[i*2]) << 4) |
                         (ParseNybble(hex[i*2+1])));
    }
    return ret;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-16T09:28:41.740

看看这个 - 它很短，是 .NET 框架的一部分：

`System.Runtime.Remoting.Metadata.W3cXsd2001.SoapHexBinary.Parse("C3B01051359947").Value`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T08:26:48.197

```
public class HexCodec {
  private static final char[] kDigits =
      { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
        'a', 'b', 'c', 'd', 'e', 'f' };

  public static byte[] HexToBytes(char[] hex) {
    int length = hex.length / 2;
    byte[] raw = new byte[length];
    for (int i = 0; i < length; i++) {
      int high = Character.digit(hex[i * 2], 16);
      int low = Character.digit(hex[i * 2 + 1], 16);
      int value = (high << 4) | low;
      if (value > 127)
        value -= 256;
      raw[i] = (byte) value;
    }
    return raw;
  }

  public static byte[] HexToBytes(String hex) {
    return hexToBytes(hex.toCharArray());
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T13:20:13.310

这是使用 LINQ 的单行代码。它基本上只是您原始版本的翻译：

```
string hexstr = "683A2134";

byte[] bytes = Enumerable.Range(0, hexstr.Length / 2)
    .Select((x, i) => Convert.ToByte(hexstr.Substring(i * 2, 2), 16))
    .ToArray(); 
```

如果您可能需要转换长度不均匀的字符串（即，如果它们可能有一个隐含的前导零），那么代码会变得有点复杂：

```
string hexstr = "683A2134F";    // should be treated as "0683A2134F"

byte[] bytes = Enumerable.Range(0, (hexstr.Length / 2) + (hexstr.Length & 1))
    .Select((x, i) => Convert.ToByte(hexstr.Substring((i * 2) - (i == 0 ? 0 : hexstr.Length & 1), 2 - (i == 0 ? hexstr.Length & 1 : 0)), 16))
    .ToArray(); 
```

# c++ - 使用输出流创建的二进制输出文件的内容

> ID：684931
> 
> 赞同：0
> 
> 时间：2009-03-26T08:23:19.530
> 
> 标签：c++, string, binaryfiles

此代码编译并执行。它只是将内容打印成二进制格式。但是输出与我的预期不同，即：

1.  输出文件的大小应该比使用 std::cout 创建的要小得多。
2.  输出文件的内容应该被压缩，因此当我们在编辑器中打开它时，我们应该看不到内容。

但是为什么下面的代码没有像我希望的那样做呢？我该如何相应地修改它？

```
#include <iostream>
#include <vector>
#include <fstream>
#include <string>
#include <sstream>
using namespace std;

void WriteStr2BinFh(const string& St, ostream &fn)
{
   fn.write(St.c_str(), St.length());
}

int main  ( int arg_count, char *arg_vec[] ) {

    vector <string> Tags;
   // In principle we have millions of such tags
   // Hence we need to compress it into binary output.
    Tags.push_back("0000000000");
    Tags.push_back("0000101110");
    Tags.push_back("0133030122");
    Tags.push_back("0133132033");
    Tags.push_back("1002013320");
    Tags.push_back("1111111111");
    Tags.push_back("1301013133");
    Tags.push_back("3010112111");
    Tags.push_back("3203012113");
    Tags.push_back("3203012212");

    //prn_vec<string>(Tags, "\t");
    //cout << endl;

    ofstream outfile;
    outfile.open("MyOut.bin", ios::binary|ios::out);

    for (unsigned i=0; i <Tags.size(); i++) {
         WriteStr2BinFh(Tags[i]+"\t",outfile);
    }

    outfile.close();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T08:34:48.317

> 输出文件的大小应该比用 std::cout 创建的要小得多

你的意思是“用std :: cout创建”？
如果您要保存整数而不是字符串，它可能会小一点。

> 输出文件的内容应该被压缩，因此当我们在编辑器中打开它时，我们应该看不到内容。

不，它不应该被压缩。您可以使用 Boost.Iostreams 库 [http://www.boost.org/doc/libs/1_38_0/libs/iostreams/doc/index.html](http://www.boost.org/doc/libs/1_38_0/libs/iostreams/doc/index.html)创建压缩文件。

为了便于理解，您可以认为二进制文件包含在调试器中查看内存时可以看到的信息。

同样对于以二进制格式输出，您应该对所有矢量项使用写入流方法（以防万一`std::vector < int >`会有差异）。（对于输出 \t 您可以使用运算符 << ）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:46:59.007

您必须以二进制格式（不是文本）写入数据：

```
void WriteStr2BinFh(const string& St, ostream &fn)
{
char *p = 0;
long l = strtol(St.c_str(), &p);
fn << l;
} 
```

你必须知道像 long 这样的类型有一些最大值，所以你可能不得不将你的字符串分成 n 部分并保存为 n 个 long。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T08:47:29.630

> 输出文件的内容应该被压缩，因此当我们在编辑器中打开它时，我们应该看不到内容。

恐怕 IOStream 库不会对您的输出应用任何压缩。正如 bb 指出的那样，您应该使用另一个库来压缩流。

> 输出文件的大小应该比使用 std::cout 创建的要小得多。

由于前面的参数，输出被视为字节流（恰好是 ASCII 表示的字符）被“按原样”写入文件，因此大小不会改变。

看看一些[文档](http://www.cplusplus.com/reference/iostream/ofstream/open.html)和对二进制文件的[更好解释](http://www.cs.hmc.edu/~fleck/envision/user-manual/binary-files.html)。

# .net - 在 IE8 中嵌入 .NET 用户控件

> ID：684940
> 
> 赞同：2
> 
> 时间：2009-03-26T08:26:44.187
> 
> 标签：.net, internet-explorer-8

我有一个简单的网页，其中包含一个使用 OBJECT 标记嵌入的 .NET 用户控件。在 IE7 中，页面显示，我可以使用用户控件。

但是，在 IE8 中，用户控件甚至不加载。

有什么想法/想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T07:09:27.473

由于程序集加载中的漏洞，这是 IE8 中的更改。有关更多详细信息，请参阅[此帖子](http://blogs.msdn.com/askie/archive/2009/05/22/net-control-no-longer-loads-in-ie8-in-internet-zone.aspx)。

如果该站点被添加到受信任的站点列表中，该控件将加载。没有办法从网络上做到这一点，所以用户必须自己做，或者你可以提供某种安装程序来做。（参见 msdn.microsoft.com/en-us/library/ms537181(VS.85).aspx）

兼容模式或 X-UA-Compatible 元标记无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T13:41:03.917

如果您将该站点添加到受信任的站点列表中，则会加载用户控件。这是设计使然（已与 Microsoft 支持团队确认）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T12:30:14.850

我不知道问题的解决方案，但至少在有人可以提供更好的答案之前，您可以提出：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
```

在页面头部的标题标签正下方。这将强制页面在 IE7 中呈现，并且应该再次显示用户控件。

# sql-server - 如何在 WiX 安装程序中检测 SQL Server Express

> ID：684950
> 
> 赞同：9
> 
> 时间：2009-03-26T08:34:12.500
> 
> 标签：sql-server, installation, wix

如何检测 Sql Server Express 是否已在 WiX 安装程序中的计算机上安装和运行？

我想在安装我的应用程序之前进行检查，如果它没有安装和运行，通知用户必须先安装它，然后再安装我的应用程序。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T10:43:51.643

好的，我通过试错选项找到了有效的方法：

```
<Property Id="SQLSERVER">
  <RegistrySearch Id="SQLServer" Root="HKLM" Key="SOFTWARE\Microsoft\Microsoft Sql Server" Type="raw" Name="InstalledInstances"/>
</Property> 
```

我定义了一个注册表搜索，然后检查它的值：

```
<Condition Message="You don't have SQL Server installed.">
  <![CDATA[SQLSERVER >< SQLEXPRESS]]>
</Condition> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-12T03:13:33.683

我尝试了 Krzysztof 的解决方案（上图）——但在某些机器上使用这种方法时，它没有正确检测到它们何时没有**安装**Sql Express。

它看起来是由于 REG_MULTI_SZ InstalledInstances 注册表值处理不当引起的？

当我检查是否需要在安装程序中停止/重新启动 Sql Server Express 服务时，我决定只检查它 - 所以这是我的替代方案，我只检查服务：

```
<Property Id="SQLEXPRESSINSTALLED" >
  <RegistrySearch Id="IsSqlExpressServiceInstalled" Root="HKLM" Key="SYSTEM\CurrentControlSet\services\MSSQL$SQLEXPRESS" Name="Description" Type="raw" Win64="no"/>
</Property>      

<Condition Message="Express Not Installed">SQLEXPRESSINSTALLED</Condition>

<Condition Message="Express Installed">NOT SQLEXPRESSINSTALLED</Condition> 
```

有点 hack，但对我们的客户来说似乎工作得很好（使用组件内的条件，而不是上面显示的示例启动条件）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T13:08:03.070

上面接受的答案总是对我来说符合条件。我让它工作使用：

```
<Property Id="SQLSERVER_INSTANCE">
  <RegistrySearch Id="SQLServerRegSearch" Root="HKLM" Key="SOFTWARE\Microsoft\Microsoft Sql Server\Instance Names\SQL" Type="raw" Name="SQLEXPRESS"/>
</Property>
<Condition Message="You don't have SQL Server installed.">
  <![CDATA[SQLSERVER_INSTANCE]]>
</Condition> 
```

# c# - 如何从 SharpSVN 获取最新版本号？

> ID：684953
> 
> 赞同：31
> 
> 时间：2009-03-26T08:36:38.437
> 
> 标签：c#, svn, sharpsvn

如何使用 SharpSVN 获取最新版本号？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-26T09:08:15.523

从存储库中检索头部修订的最便宜的方法是 Info 命令。

```
using(SvnClient client = new SvnClient())
{
   SvnInfoEventArgs info;
   Uri repos = new Uri("http://my.server/svn/repos");

   client.GetInfo(repos, out info);

   Console.WriteLine(string.Format("The last revision of {0} is {1}", repos, info.Revision));
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-08-31T13:04:48.500

我正在使用 SvnWorkingCopyClient 检查最新版本的工作副本：

```
var workingCopyClient = new SvnWorkingCopyClient();

SvnWorkingCopyVersion version;

workingCopyClient.GetVersion(workingFolder, out version); 
```

然后可以通过以下方式获得最新版本的本地工作存储库

```
long localRev = version.End; 
```

对于远程存储库，使用

```
 var client = new SvnClient();

 SvnInfoEventArgs info;

 client.GetInfo(targetUri, out info);

 long remoteRev = info.Revision; 
```

反而。

这类似于从命令行使用 svnversion 工具。希望这可以帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-26T09:04:15.143

好的，我自己想出来的：

```
SvnInfoEventArgs statuses;
client.GetInfo("svn://repo.address", out statuses);
int LastRevision = statuses.LastChangeRevision; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-27T09:24:13.960

我也用谷歌搜索了很多，但唯一能让我真正获得最新版本的一件事是：

```
public static long GetRevision(String target)
    {
        SvnClient client = new SvnClient();

        //SvnInfoEventArgs info;
        //client.GetInfo(SvnTarget.FromString(target), out info); //Specify the repository root as Uri
        //return info.Revision
        //return info.LastChangeRevision

        Collection<SvnLogEventArgs> info = new Collection<SvnLogEventArgs>();
        client.GetLog(target, out info);
        return info[0].Revision;
    } 
```

其他解决方案被注释掉。自己试一试，看看有什么不同。. .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T09:00:57.630

好吧，一个快速的谷歌搜索给了我，它有效（只需指向 /trunk/ URI）：

[http://sharpsvn.open.collab.net/ds/viewMessage.do?dsForumId=728&dsMessageId=89318](http://sharpsvn.open.collab.net/ds/viewMessage.do?dsForumId=728&dsMessageId=89318)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-27T23:11:13.983

这是一个非常古老的问题，在前两个答案中已经得到了很好的回答。尽管如此，希望它可能对我发布以下 C# 方法的人有所帮助，以说明如何不仅从存储库和工作副本中获取修订号，而且如何测试可能的典型情况被视为问题，例如在自动构建过程中。

```
 /// <summary>
  /// Method to get the Subversion revision number for the top folder of the build collection, 
  /// assuming these files were checked-out from Merlinia's Subversion repository. This also 
  /// checks that the working copy is up-to-date. (This does require that a connection to the 
  /// Subversion repository is possible, and that it is running.)
  /// 
  /// One minor problem is that SharpSvn is available in 32-bit or 64-bit DLLs, so the program 
  /// needs to target one or the other platform, not "Any CPU".
  /// 
  /// On error an exception is thrown; caller must be prepared to catch it.
  /// </summary>
  /// <returns>Subversion repository revision number</returns>
  private int GetSvnRevisionNumber()
  {
     try
     {
        // Get the latest revision number from the Subversion repository
        SvnInfoEventArgs svnInfoEventArgs;
        using (SvnClient svnClient = new SvnClient())
        {
           svnClient.GetInfo(new Uri("svn://99.99.99.99/Merlinia/Trunk"), out svnInfoEventArgs);
        }

        // Get the current revision numbers from the working copy that is the "build collection"
        SvnWorkingCopyVersion svnWorkingCopyVersion;
        using (SvnWorkingCopyClient svnWorkingCopyClient = new SvnWorkingCopyClient())
        {
           svnWorkingCopyClient.GetVersion(_collectionFolder, out svnWorkingCopyVersion);
        }

        // Check the build collection has not been modified since last commit or update
        if (svnWorkingCopyVersion.Modified)
        {
           throw new MerliniaException(0x3af34e1u, 
                  "Build collection has been modified since last repository commit or update.");
        }

        // Check the build collection is up-to-date relative to the repository
        if (svnInfoEventArgs.Revision != svnWorkingCopyVersion.Start)
        {
           throw new MerliniaException(0x3af502eu, 
             "Build collection not up-to-date, its revisions = {0}-{1}, repository = {2}.",
             svnWorkingCopyVersion.Start, svnWorkingCopyVersion.End, svnInfoEventArgs.Revision);
        }

        return (int)svnInfoEventArgs.Revision;
     }
     catch (Exception e)
     {
        _fLog.Error(0x3af242au, e);
        throw;
     }
  } 
```

（这段代码确实包含了一些特定于它被复制的程序的东西，但这不应该使 SharpSvn 部分难以理解。）

# extjs - 使用 extjs Ext.MessageBox.alert 后如何聚焦文本框

> ID：684960
> 
> 赞同：4
> 
> 时间：2009-03-26T08:39:54.547
> 
> 标签：extjs

我想验证我的 extjs 表单。当文本字段为空时，应该显示一个警告框，然后我们的光标必须集中在文本框上。我尝试使用下面的编码。警报工作正常。但光标没有聚焦。你能帮我集中注意力吗？

```
if(Ext.get('first').dom.value=='')
{
    Ext.MessageBox.alert('Status', 'Enter your First Name!');
    document.getElementById("first").focus();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T08:46:19.740

该[文档](http://extjs.com/deploy/dev/docs/?class=Ext.MessageBox)指出 MessageBox 是异步的：

> 请注意，MessageBox 是异步的。与常规的 JavaScript 警报（将停止浏览器执行）不同，显示 MessageBox 不会导致代码停止。出于这个原因，如果您的代码应该只在 MessageBox 的一些用户反馈后运行，您必须使用回调函数（有关详细信息，请参阅函数参数）。

因此，您的 focus() 是在调用 Ext.MessageBox.alert 后立即执行的，而不是在用户关闭它时执行：当用户单击关闭警报时，焦点将再次改变。

您可以尝试使用常规的 javascript alert() 代替，它是同步的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-13T14:31:51.727

```
if (Ext.get("first").dom.value == "") {
    Ext.MessageBox.alert("Status", "Enter your First Name!", function() {
        Ext.get("first").focus();
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-01T22:24:14.300

尝试这个

```
 if(Ext.get('first').dom.value=='')
{
     Ext.Msg.alert('Status', 'Enter your First Name!', function(btn, text){
          if (btn == 'ok'){
               Ext.getCmp('first').focus(true,10);
          }
     });
} 
```

# linq - 将自定义成员添加到映射类型

> ID：684962
> 
> 赞同：0
> 
> 时间：2009-03-26T08:40:47.133
> 
> 标签：linq

我正在使用 Linq 2 Sql，我想在我的一种数据类型上添加一个自定义成员。例如：我有表公司、部门和员工。部门在公司中有一个 FK，而 Employess 在部门中有一个 FK。非常简单。

我的目标是在 Company 上添加一个 EmployeeCount 属性，该属性当然会返回公司中的员工人数（通过将公司部门中的员工人数相加）。

正如您可能知道的那样，这真的很简单：只需在部分类上添加一个成员并执行此操作。问题是，我现在想对这个自定义成员进行排序。

如何为 Linq 编写此自定义成员，以便能够将逻辑转换为有效的 SQL orderby？我尝试使用 SPROC 但没有成功。

任何帮助表示赞赏！费边

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T08:47:30.720

我想您可能需要将此列添加到您的架构中，以便 SQL 服务器识别它并在他的优化中考虑。

我将添加一个触发器，该触发器将在您的数据发生更改时自动更新此列。

# java - 使用 restlet 将 json 内容传递给不同的浏览器类型

> ID：684965
> 
> 赞同：0
> 
> 时间：2009-03-26T08:44:15.783
> 
> 标签：java, ajax, json, cross-browser, restlet

我们使用[restlet](http://www.restlet.org/)框架开发了一个 RESTful web 服务。该服务由使用 Prototype 和/或 Scriptaculous 的 ajax 请求调用（我不熟悉这些库，所以如果其中提到的任何一个不准确，请原谅）。

一切似乎都适用于大多数流行的浏览器，即 Opera、Firefox、Safari 都可以正常工作。只有 Internet Explorer（6 和 7）不会从呼叫中获取数据。

我们怀疑返回的内容类型“application/json”在 IE 中不起作用。我们以“UTF-8”传递 json 内容，所以这也可能是一个问题。

欢迎任何提示和建议，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:45:55.250

IE 6 8 使用“application/json”处理 JSON 响应没有任何问题。[例如，您需要使用HttpWatch Pro](http://www.httpwatch.com/)之类的工具来跟踪服务器的响应。

# css - 如何更改 IE 输入字段中文本光标的颜色？

> ID：684972
> 
> 赞同：12
> 
> 时间：2009-03-26T08:47:42.203
> 
> 标签：css, internet-explorer, input, text, text-cursor

据我所见，在 Firefox 和 Chrome 中，输入字段中文本光标的颜色会更改为`color`css 属性的值。但是在 IE 中它没有任何效果。

有没有办法在IE中实现这个效果？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-26T09:14:38.800

IE 输入中文本光标的颜色始终与背景颜色相反。所以你不能在IE上。

这也是 W3C 未指定的，所以不要指望任何地方都有支持，如果有，那么它只是一个工件:-)

**编辑：** 9 年后，我们现在有了[`caret-color`](https://developer.mozilla.org/en-US/docs/Web/CSS/caret-color)，但不适用于 IE 或 Edge。适用于其他浏览器。

# c# - 枚举上的位操作

> ID：684977
> 
> 赞同：3
> 
> 时间：2009-03-26T08:53:24.060
> 
> 标签：c#, enums, bit, bitwise-operators

我遇到以下问题：

*   我想获得列集合的第一个可见和冻结列。

我认为这会做到：

```
DataGridViewColumnCollection dgv = myDataGridView.Columns;
dgv.GetFirstColumn(
     DataGridViewElementStates.Visible | DataGridViewElementStates.Frozen); 
```

*   是否也可以制作一个位掩码来获得第一个冻结或可见的列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T09:05:48.167

AFAIK 的实现是“所有这些”——它使用：

```
((this.State & elementState) == elementState); 
```

这是“全部”。如果你想写一个“any of”，或许可以添加一个辅助方法：（在前面添加“this”`DataGridViewColumnCollection`使其成为 C# 3.0 扩展方法）

```
 public static DataGridViewColumn GetFirstColumnWithAny(
        DataGridViewColumnCollection columns, // optional "this"
        DataGridViewElementStates states)
    {
        foreach (DataGridViewColumn column in columns)
        {
            if ((column.State & states) != 0) return column;
        }
        return null;
    } 
```

或者使用 LINQ：

```
 return columns.Cast<DataGridViewColumn>()
            .FirstOrDefault(col => (col.State & states) != 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T09:05:50.973

好吧，位掩码通常是这样工作的：

`|`正在加入旗帜。`&`正在从位掩码表示的标志集中过滤标志的子集。`^`正在通过掩码翻转标志（至少在 C/C++ 中）。

To get the first frozen OR visible column `GetFirstColumn` must handle bitmasks different way (e.g. `GetFirstColumn` could get the first column that matches any of the flags set, but this is not the case).

# asp.net - ELMAH SMTP

> ID：684978
> 
> 赞同：0
> 
> 时间：2009-03-26T08:53:43.530
> 
> 标签：asp.net, error-handling, elmah

我正在使用 ELMAH 通过电子邮件发送错误消息。是否有一个优雅的解决方案来查询数据库的 SMTP 设置而不是使用 web.config？我需要在抛出每个错误之前完成它。

[这里](http://groups.google.com/group/elmah/browse_thread/thread/f87154e82c9fa6a6)建议的解决方案对我来说有点 hacky。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T20:02:16.693

Aside from your hacky method, the only other option that I can think of is to roll your own version of the binary, like SO does. You can find the source here:

[http://code.google.com/p/elmah/source/browse/trunk/src/Elmah/](http://code.google.com/p/elmah/source/browse/trunk/src/Elmah/)

# c# - 在 C# XML 文档中引用泛型类型的泛型类型？

> ID：684982
> 
> 赞同：44
> 
> 时间：2009-03-26T08:55:39.297
> 
> 标签：c#, visual-studio-2008, generics, resharper, xml-documentation

为谓词助手类编写一些 XML 文档。但我不知道我可以在`Expression<Func<T, bool>>`没有语法错误的情况下引用 an 。甚至可能吗？我试过这个：

```
<see cref="Expression{Func{T, bool}}"/> 
```

但是我得到了一条红色的波浪线`{T, bool}}`。这虽然有效：

```
<see cref="Expression{TDelegate}"/> 
```

有人有线索吗？

* * *

**更新：**

给出的答案（我接受了）似乎确实有效。但现在我开始收到很多关于无法解决问题的警告。我有一个名为的类`ExpressionBuilder<T>`，它适用于`Expression<Func<T, bool>>`很多。所以我当然想在我的 XML 注释中引用它。

我已经尝试了我知道的两个版本：

```
<see cref="Expression&lt;Func&lt;T, Boolean&gt;&gt;"/>
<see cref="Expression{Func{T, Boolean}}"/> 
```

但两者都不起作用。（在最后一个上，ReSharper 在`{T,Boolean}}`我使用过的所有地方都在编译时收到了两个警告，上面写着：

> 1.  'blah blah' 上的 XML 注释具有无法解析的 cref 属性 'Expression>'
> 2.  类型参数声明必须是标识符而不是类型。另请参阅错误 CS0081。

在我试图引用的某个地方遇到同样的问题`Range<Nullable<DateTime>>`（`Range<DateTime?>`也没有工作。使用 { } 和 with `&lt; &gt;`）

我不应该参考这些泛型吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-06-10T21:17:48.463

似乎没有办法在 XML 文档中引用泛型的泛型，因为实际上，没有办法引用任何特定类型的泛型。

Lasse V Karlsen 的[回答](https://stackoverflow.com/questions/684982/c-xml-doc-how-to-refer-to-expressionfunct-bool-correctly/797364#797364)让我点击了：

如果你写`<see cref="IEnumerable{Int32}" />`，编译器只是使用“Int32”作为类型参数名称，而不是类型参数。写作`<see cref="IEnumerable{HelloWorld}" />`也可以。这是有道理的，因为 MSDN 中没有您的文档可以链接到的“IEnumerable of int”的特定页面。

要正确记录您的课程，我认为您必须编写如下内容：

```
<summary>
Returns an <see cref="IEnumerable{T}" /> of <see cref="KeyValuePair{T,U}" /> 
of <see cref="String" />, <see cref="Int32" />.
</summary> 
```

我希望你喜欢文字。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-28T11:13:56.600

您究竟希望它链接到什么？

文档中没有 a 之类的东西`Expression<Func<T>>`，所以很明显，指向它的链接是行不通的。

您可以链接到，`Expression<TDelegate>`因为它存在。

至于什么有效或无效，以下都不适用于我的 Visual Studio 2008 / .NET 3.5：

```
/// <see cref="Expression&lt;Func&lt;T&gt;&gt;"/>.
/// <see cref="Expression{Func{T}}"/>. 
```

但这有效：

```
/// <see cref="Expression{T}"/>. 
```

所以显然泛型类型参数不必与声明中的相同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T09:00:40.893

```
// Use "&lt;" instead of "<" symbol and "&gt;" instead of ">" symbol.

// Sample:

<see cref="Expression&lt;Func&lt;T, bool&gt;&gt;"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-02T14:34:50.797

我现在遇到了这个问题，因为我有一个返回`List<List<byte>>`. 是的，它很丑，但我没有写它。标准免责声明，我知道。

无论如何，在带有 R# Ultimate 2017.1 的 VS 2017 中，这个文档评论......

```
<returns><see cref="List{List{Byte}}" /> of split frames</returns> 
```

...给我一个语法错误。然而，这...

`<returns><see><cref>List{List{byte}}</cref></see> of split frames</returns>`

...才不是。 *有趣的*。

还是丑？是的。

**一样**丑？`&lt;`我认为它没有使用和我自己那么可怕`&gt;`......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-06T23:12:51.537

不要使用空的 see 元素 ( `<see cref="..." />`)。相反，将文本放在 see 元素内

```
<see cref="IEnumerable{T}">IEnumerable</see>&lt;<see cref="..."/>$gt; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-12T21:44:05.457

我尝试了堆栈溢出的所有内容，以获得适用于多种情况的结果。这是一个适合我的解决方案。（这对其他人来说是主观的。）

1.  产生可点击的链接。
2.  将鼠标悬停在标识符上有效。
3.  正确生成 .xml 文件。
4.  在智能感知中不会产生错误。
5.  适用于可为空的泛型类型参数。
6.  在 Resharper 中工作，它是内置的 XML Doc 窗口（Resharper -> 编辑 -> 显示快速文档）
7.  适用于 Atomineer Pro Documentaion Visual Studio Extension 的 XAM Doc Preview。
8.  适用于泛型类型的泛型类型。

示例 #1

```
 /// <summary>
  ///  This instance field holds a reference to the
  ///  <see cref="ConcurrentDictionary{Decimal, Boolean}"/> as
  ///  <see cref="T:ConcurrentDictionary&lt;decimal, bool?&gt;"/> that contains
  ///  the list of all PDF's that are currently opened and being displayed.
  /// </summary>
  private ConcurrentDictionary<decimal, bool?> openedPdfs = default!;

  Note: 
    The ConcurrentDictionary{Decimal, Boolean} will correctly produce a
    clickable link of ConcurrentDictionary{TKey, TValue} on hovering while
    T:ConcurrentDictionary&lt;decimal, bool?&gt; makes sure the reader gets
    information on what type TKey and TValue are. 
```

示例#2（使用“T”）

```
 /// <summary>
  ///  This instance field holds a reference to the
  ///  <see cref="ConcurrentDictionary{TKey, TValue}"/> as
  ///  <see cref="T:ConcurrentDictionary&lt;decimal, bool?&gt;"/> that contains
  ///  the list of all PDF's that are currently opened and being displayed.
  /// </summary>
  private ConcurrentDictionary<decimal, bool?> openedPdfs = default!; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-11T20:44:34.233

我来使用这个：

```
<see cref=""EqualityComparer{T}.Default"">EqualityComparer&lt;<typeparamref name=""TSource""/>&gt;.Default</see> 
```

在此处应用于您的 OP 结果：

```
<see cref="System.Linq.Expressions.Expression{TDelegate}">Expression&lt;Func&lt;<typeparamref name="TSource"/>, Boolean&gt;&gt;.</see> 
```

这是 IntelliSense 弹出窗口的图像：

[![在 VS2019 中渲染评论](https://i.stack.imgur.com/hCOHn.png)](https://i.stack.imgur.com/hCOHn.png)

# javascript - Safari 2.0 中修改键的键盘事件

> ID：684983
> 
> 赞同：0
> 
> 时间：2009-03-26T08:56:36.253
> 
> 标签：javascript, safari, webkit, dom-events, dashboard

我正在使用键盘事件 ( `keydown`and `keyup`) 来准确检测用户何时按下或释放 shift 键。

在 Safari 3+ 中，这可以正常工作。然而，Safari 2.0 似乎没有为 shift 键触发键盘事件——事实上，它似乎没有为任何修饰键触发事件......

有谁知道我可以如何处理或解决这个问题？

（在这种特殊情况下，我只需要使用 Safari，因为我在仪表板小部件中使用此代码。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T11:22:09.210

Safari 2 不会触发任何修饰键的键事件（代码直到 S3 周期才添加）——您能做的最好的事情就是查看您正在处理的任何事件的修饰标志。

如果做不到这一点，请记住 Safari 3+ 存在于 Tiger 上，而 iirc 是 10.4.11 的一部分，因此您应该真正能够依赖 S3+ 的存在

# javascript - 如何使用 JavaScript 访问自定义 XHTML 属性？

> ID：684985
> 
> 赞同：1
> 
> 时间：2009-03-26T08:58:36.810
> 
> 标签：javascript, xhtml, attributes

我有以下 XHTML：

```
<span id="myid" cus:att="myvalue" xmlns:cus="http://mycompany.com/customnamespace">
</span> 
```

是否可以使用 javascript 访问自定义属性？我有代表跨度的元素。这样做`myElement.att`不起作用，我不知道如何指定命名空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T09:07:36.680

通常来说，您可以直接访问它，即`element.attribute`命名空间会使这稍微复杂化：

```
element.getAttribute("namespace:attribute") //the nuclear x-browser option 
```

所以要非常清楚，这将是这样的：

```
document.getElementById('myid').getAttribute('cus:att') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T11:05:16.303

该方法有一个特殊版本，`getAttribute`专门用于访问命名空间属性：`getAttributeNS`. 使用您的示例 XHTML，以下 JavaScript 代码：

```
document.getElementById("myid").getAttributeNS("http://mycompany.com/customnamespace", "att"); 
```

...将返回“ `myvalue`”。

[您可以在此处](https://developer.mozilla.org/en/DOM/element.getAttributeNS)阅读有关该`getAttributeNS`方法的更多信息。

史蒂夫

# silverlight - 是否可以在 Silverlight DataTemplate 中绑定事件？

> ID：684986
> 
> 赞同：12
> 
> 时间：2009-03-26T08:58:54.640
> 
> 标签：silverlight, events, binding, datatemplate

是否可以在 Silverlight DataTemplate 中绑定事件？如果是这样，最好的方法是什么？

例如，假设您创建了一个包含 Button 的 DataTemplate，如下所示：

```
<UserControl.Resources>
  <DataTemplate x:Key="MyDataTemplate" >
     <Grid>
        <Button Content="{Binding ButtonText}" Margin="4" />
     </Grid>
  </DataTemplate>
</UserControl.Resources> 
```

然后，将它应用到 ListBox ItemTemplate，如下所示：

```
<Grid x:Name="LayoutRoot" Background="White">
  <ListBox x:Name="lbListBox" ItemTemplate="{StaticResource MyDataTemplate}" />    
</Grid> 
```

如果将 ListBox 的 ItemSource 设置为该类的对象列表：

```
public class MyDataClass
{
  public string ButtonText{ get; set; }
} 
```

那么如何从列表中的 DataTemplate 中捕获每个按钮的按钮单击？能否使用绑定将 Click 事件绑定到“MyButtonClass”中的方法，如下所示：

```
<UserControl.Resources>
  <DataTemplate x:Key="MyDataTemplate" >
     <Grid>
        <Button Click="{Binding OnItemButtonClick}" Content="{Binding ButtonText}" Margin="4" />
     </Grid>
  </DataTemplate>
</UserControl.Resources> 
```

这行得通吗？如果是这样，我应该在“MyDataClass”中添加什么来捕捉事件？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T22:33:23.233

有几个选项。

一。制作一个绑定该行的数据对象的自定义控件。在该自定义控件上添加绑定对象的处理程序。

我不认为你对点击的绑定会起作用。没有绑定状态，只需将您的点击声明为一个字符串。

在控件所在的页面上添加处理程序。请记住，如果您以这种方式绑定，您将只能使用该项目（按钮）的发送者及其属性。如果您需要获取对象的特定属性，您最好选择第一个选项。

通过将 10 个按钮添加到具有单击事件的列表框来演示功能的小示例。高温高压

数据模板 XAML

```
<UserControl.Resources>
    <DataTemplate x:Name="MyDataTemplate">
        <Grid>
            <Button Click="Button_Click" Content="{Binding ItemText}"/>
        </Grid>
    </DataTemplate>
</UserControl.Resources> 
```

列表框 XAML

```
<ListBox x:Name="ListBoxThingee" ItemTemplate="{StaticResource MyDataTemplate}"/> 
```

后面的代码（我只是将这一切都插入到 page.xaml 文件中

```
public class MyClass
{
    public string ItemText { get; set; }
}

public partial class Page : UserControl
{
    ObservableCollection<MyClass> _Items;
    public Page()
    {
        InitializeComponent();

        _Items = new ObservableCollection<MyClass>();

        for (int i = 0; i < 10; i++)
        {
            _Items.Add(new MyClass() {ItemText= string.Format("Item - {0}", i)});
        }

        this.ListBoxThingee.ItemsSource = _Items;
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        Button _b = sender as Button;
        if (_b != null)
        {
            string _s = _b.Content as string;
            MessageBox.Show(_s);
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-21T19:27:08.830

我要做的是创建一个使用命令模式进行点击处理的按钮。在 .NET 4 框架中，您可以绑定`commands`到视图模型中存在的那些。

# asp.net - 共享相同文件的 ASP.NET 2 项目

> ID：684987
> 
> 赞同：3
> 
> 时间：2009-03-26T08:59:43.453
> 
> 标签：asp.net

正如标题所说，我有 2 个具有相同 css 文件、母版页和一些资源文件的 Web 项目，我该如何共享这些？atm 我有2份...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T09:07:24.073

**解决方案 1**：将它们绑定到单独的程序集中，以便在您的项目中共享。

**参考**：

*   [使用 Visual Studio 2005 构建可重用的 ASP.NET 用户控件和页面库](http://msdn.microsoft.com/en-us/library/aa479564.aspx)
*   [如何在 ASP.NET 2.0 程序集中嵌入资源](http://support.microsoft.com/kb/910445)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T09:13:22.547

在第二个项目中选择“添加现有文件”，选择文件，单击添加按钮上的箭头并选择“添加为链接”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T09:24:37.510

这是一篇描述如何在应用程序之间共享页面和用户控件的文章：[如何：使用 Visual Basic .NET 在应用程序之间共享 ASP.NET 页面和用户控件](http://support.microsoft.com/kb/825996)。它的解决方案取决于保存共享文件的单独虚拟目录。

在[这篇文章中](http://weblogs.asp.net/scottgu/archive/2005/08/28/423888.aspx)， Scott Guthrie 描述了如何构建可重用的 Web 程序集。它的解决方案取决于通过共享文件进行单独的组装。

# client-server - 一个复杂查询与多个简单查询

> ID：684989
> 
> 赞同：23
> 
> 时间：2009-03-26T09:00:18.413
> 
> 标签：client-server, data-access-layer

实际上更好的是什么？让具有复杂查询的类负责加载例如嵌套对象？或者具有负责加载简单对象的简单查询的类？

对于复杂的查询，您不必去数据库，但该类将承担更多责任。

或简单的查询，您需要更多地访问数据库。然而，在这种情况下，每个类都将负责加载一种类型的对象。

我所处的情况是加载的对象将被发送到 Flex 应用程序（DTO）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-26T09:21:01.967

这里的一般经验法则是服务器往返是昂贵的（相对于典型查询需要多长时间），因此指导原则是您希望将它们最小化。基本上，每个一对多连接都可能使您的结果集成倍增加，因此我的方法是继续连接，直到结果集变得太大或查询执行时间变得太长（通常大约 1-5 秒）。

根据您的平台，您可能会也可能无法并行执行查询。这是您应该做什么的关键决定因素，因为如果您一次只能执行一个查询，那么分解查询的障碍就会高得多。

有时值得在内存中保留某些相对恒定的数据（例如国家信息）或将它们作为单独的查询进行，但根据我的经验，这是相当不寻常的。

更常见的是不得不修复性能糟糕的系统，这在很大程度上是由于执行单独的查询（特别是相关查询）而不是连接。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-26T09:25:23.423

我认为没有任何选择*实际上更好*。这取决于您的应用程序特定、架构、使用的 DBMS 和其他因素。

例如，我们在独立解决方案中使用了多个简单查询。但是当我们将产品发展为轻量级的互联网可访问解决方案时，我们发现我们的框架发出了大量的请求，并且导致网络延迟的性能下降。因此，我们充分改造了我们的框架以使用聚合的复杂查询。同时，我们仍然维护我们的独立解决方案，并从 Oracle Light 迁移到 Apache Derby。我们再一次发现我们的一些新的*复杂*查询应该被简化，因为 Derby 执行它们的时间过长。

所以看看你真正的问题并适当地解决它。我认为，如果没有针对它们的强有力的目标，那么简单的查询是很好的开始。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T09:20:15.917

凭直觉我会说：

只要没有经过证实的优化性能的理由，就使用简单的方法。否则，我会将“复杂对象和查询”方法放在过早优化的篮子中。

如果您发现存在真正的性能影响，那么您应该在下一步优化 flex 和后端之间的往返。但正如我之前所说：这是一种直觉，你真的应该从“性能”的定义开始，从简单开始并衡量性能。

# java - 在 Netbeans 中从 ant 迁移到 maven

> ID：684992
> 
> 赞同：14
> 
> 时间：2009-03-26T09:01:06.647
> 
> 标签：java, maven-2, netbeans, ant

我们的软件是用 Java 编写的，包含许多 (7) 个项目。

这些项目是 Netbeans ant 项目。我正在考虑将它们转换为 maven2。

我在哪里可以找到做这种事情的一些提示？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-26T10:02:12.443

不要读那本书。它只会让你感到困惑。请阅读这本书：“Maven - 权威指南” [http://www.sonatype.com/books/maven-book/reference/](http://www.sonatype.com/books/maven-book/reference/)。

此外，maven 站点有很多信息，但结构很糟糕，所以您需要使用 google 导航。

这是我的建议：

1.  手动执行此操作，而不是使用 IDE 中的“自动”“帮助”。Maven 集成还没有那么好，在任何 IDE 中都没有。

2.  确保您的程序项目被划分为一个公共伞形模块下的模块，以便每个模块产生一个二进制工件（jar、war、...），可能伴随着该工件背后源代码的 javadoc，一个带有源代码等。基本原则是每个模块产生一个单独的工件，包含该模块下的所有非测试代码。您可以在项目仍由 ant 构建时执行此操作。

3.  每个模块都应该符合标准的 Maven 目录布局。构建目标位于 [module]/target/[output-type, eg "classes"] 下。源代码在 [module]/src/main/[src-type eg "java"] 和 [module]/test/[src-type] 下。该工件包含 src/main 下的所有代码，并且没有 src/test 下的任何代码，因为它构建到目标目录。您可以在仍然由 ant 构建时执行此操作。

4.  首先转换与项目中其他模块没有依赖关系的子模块。

5.  现在您可以使用工件类型“pom”创建父 maven 模块 pom.xml，它由以下模块之一组成。使用伞形模块作为“父”，为第一个子模块（只有外部依赖的那个）创建一个子模块。请记住，您需要为父级指定版本。记得将子模块添加为父模块中的“模块”。当您创建这样的多模块项目时，请始终使用 ${project.version} 作为子模块中的版本。父级下的所有模块必须在一次操作中同时发布，如果您使用此设置，maven 将确保版本字段在所有模块中保持相同，并在发布期间随处更新。这可能会使重新使用现有编号方案变得困难，但这并不重要。

6.  添加必要的依赖项，并确保您可以使用来自父模块的命令“mvn clean install”一起构建父模块和子模块。

7.  以同样的方式继续其他模块。对同一父项目下其他模块的依赖也应使用 ${project.version} 作为它们所依赖的“版本”，即“与此版本相同”。请注意，为了构建，您所依赖的模块必须使用“mvn install”构建，以便将其部署到您的本地（计算机）存储库。否则依赖模块将无法找到类。maven 中的模块之间没有源代码依赖关系，只有对安装在本地和远程存储库中的构建和打包版本的依赖关系。如果您来自 ant-projects，这可能会非常令人困惑。从根模块构建，直到您对此感到满意为止。需要两天时间。

8.  不要在 IDE 中使用 maven 集成。这是个坏主意。使用 "mvn idea:idea" 或 "mvn eclipse:eclipse" 将您的工作区设置为非 maven 普通 IDE 项目。maven 和 IDE 中的模块间依赖机制并不相同，也永远不会相同。此外，如果您有几个 mavenized 项目之间存在依赖关系，那么您希望在工作区中设置其中的几个，并在它们之间建立依赖关系。如果您在与父模块相同的目录中创建一个名为“workspace.xml”（或其他）的单独 maven 项目文件，则可以使用 mvn idea:idea/eclipse:eclipse 执行此操作，设置为包含模块的多模块项目“ 。” 和“../otherproject”（这里只有单向引用，没有父引用）。如果你运行“mvn idea:idea/eclipse:eclipse -f workspace.xml” 您将获得一个将所有这些模块链接在一起的工作区。没有 IDE 集成可以让您这样做。这听起来像是很多额外的工作，但workspace.xml 文件真的很小。它不必包含所有依赖项和所有这些，只包含对要在 IDE 中绑定在一起的模块的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-20T03:04:19.857

我在这里使用 Joseph Mocker 的指导成功地将 NetBeans Ant 项目迁移到 Maven 项目：[http](http://forums.netbeans.org/ptopic55953.html) ://forums.netbeans.org/ptopic55953.html 我引用了重要的部分：

1.  关闭项目
2.  将 build.xml、nbproject 文件/文件夹重命名为 NB 将无法识别它们。
3.  关闭并重新启动 NB（因此该项目的任何内存缓存知识都消失了）
4.  从其他项目中复制一个空的pom。
5.  在 NB 中打开项目备份（NB 现在应该将其识别为 maven 项目）
6.  重新排列文件以遵循 Maven 方式 (™)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T09:16:13.163

这不是一件容易的事，因为 Maven2 期望文件以特定的方式组织。不管怎样[，使用 Maven 构建更好的](http://www.exist.com/better-build-maven)是一本可以帮助您入门的免费书籍。它将帮助您了解 Maven，并且它还有一个关于迁移的章节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-27T13:06:15.800

我已经构建了一个脚本来将 Ant 构建迁移到 Maven。您可以在这里找到更多信息：

[https://github.com/ewhauser/ant2maven](https://github.com/ewhauser/ant2maven)

它不会帮助您修复目录结构和/或任何其他 Ant 任务，但它消除了许多繁琐的开始步骤。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-27T18:14:32.420

我发现迁移是没有必要的。我需要的真正要求是自动下载依赖项（库）。

这也是由[Ivy](http://ant.apache.org/ivy/)实现的，它仍然使用 maven 存储库。

[我用IvyBeans](http://code.google.com/p/ivybeans/)解决了将项目从 ant 转换为 ant+ivy 的问题。

# spam-prevention - 用于垃圾邮件过滤的贝叶斯网络

> ID：684995
> 
> 赞同：1
> 
> 时间：2009-03-26T09:01:24.073
> 
> 标签：spam-prevention, bayesian-networks

我想使用贝叶斯网络机制进行垃圾邮件过滤。您认为它应该如何成为正确的网络拓扑？那么朴素贝叶斯模型呢？（朴素贝叶斯模型有时被称为贝叶斯分类器）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T13:02:04.400

如果您不熟悉垃圾邮件过滤，最好从简单的贝叶斯分类器之类的东西开始。这样您就可以熟悉处理数据所涉及的问题（阅读电子邮件、对其进行分类、存储您的词典等），而不会陷入实际的分类代码中。一旦您的程序基本工作正常，您就可以继续使用更高级的过滤类型。

[我发现Ending Spam](https://rads.stackoverflow.com/amzn/click/com/1593270526)一书中的讨论很有帮助。

# flash - 动态地从我的 flash 库中获取一个类

> ID：684996
> 
> 赞同：3
> 
> 时间：2009-03-26T09:01:35.773
> 
> 标签：flash, actionscript-3, class, dynamic

我为 Actionscript 导出的 Flash 库中有几个位图。现在根据我收到的 Flashvars，我想加载相应的库位图。

如何动态加载位图类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T09:29:15.770

基本上，要从库中附加位图，您可以这样做：

```
import flash.display.BitmapData;
import flash.display.Bitmap;

var bmp:BitmapData = new ClassNameOfTheBitmap(0, 0);
var img = new Bitmap(bmp);

addChild(img); 
```

但是由于您不知道类名，因此您必须像这样动态地创建类：

```
import flash.display.BitmapData;
import flash.display.Bitmap;

var classNameFromFlashvars:String = "xxx";
var cls:Class = getDefinitionByName(classNameFromFlashvars) as Class;

var bmp:BitmapData = new cls(0, 0) as BitmapData;
var img = new Bitmap(bmp);

addChild(img); 
```

在这种情况下，图像的链接属性中的类名将是`xxx`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T09:39:17.850

你只需要使用[Loader](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Loader.html)和[ApplicationDomain](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/system/ApplicationDomain.html)。其他答案和文档有很好的[例子](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/system/ApplicationDomain.html#includeExamplesSummary)。加载外部 swf 后，你只需要使用类似这样的东西来获取你的位图类：

```
loader.contentLoaderInfo.applicationDomain.getDefinition(className)  as  Class; 
```

**编辑：**添加链接:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-25T22:17:02.627

这很有意义。原因是编译器在“编译时”不包含任何这些类，因为它们从未使用过，它不够聪明，无法看到类名可能在运行时动态生成。所以发布的 swf 没有任何这些类。但是，即使在代码中“提及”它们，编译器也会包含它们。

我想这不是动态类名的理想架构。也许他们应该添加某种力量来编译设置？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T09:55:24.037

我创建了一个类 ex。我的课

```
 public class MyClass extends MovieClip
    {
       private var testImg:Bitmap = new Bitmap();

       public function MyClass()
       {}

       public function set testImg(value:String):void
       {
          var cls:Class = getDefinitionByName('team_' + value) as Class;

          var bmp:BitmapData = new cls(0, 0);

          testImg = new Bitmap(bmp);

          addChild(testImg);
       }
    } 
```

例如，我图书馆中的项目名为 team_4534。

MyClass 是否真的检测到所有库资产？我不必以某种方式导入它们或说它们存在吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T12:12:01.260

好的，所以我发现了一种非常难看的方法，不会出现“错误 ReferenceError：错误 #1065：未定义变量 team_xxx”

我用 .swc 中的所有不同类在 flex 中创建了一个函数：

```
 private function logos():void
    {
        team_25502;
        team_25504;
        team_25508;
        team_25509;
        team_25511;
        team_25514;
        team_25517;
        team_25521;
        team_25530;
        team_25591;
        team_66036;
        team_66230;
        team_85230;
        team_89483;
        team_89484;
    } 
```

如果有人有更好的想法，我相信有人有，那么请发表评论。**************