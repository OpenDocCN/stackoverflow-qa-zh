# StackOverflow 问答 11939000-11939999

# c# - 如何使用基本身份验证从 URL 将图像加载到图片框？

> ID：11939001
> 
> 赞同：2
> 
> 时间：2012-08-13T17:07:54.420
> 
> 标签：c#, picturebox

当 URL 根本没有受到保护时，以下工作效果很好。

```
string imageURL = ("https://api.blah.blah/customers/" + userID.ToString() + "/photo");
pictureBox1.LoadAsync(imageURL); 
```

现在我们支持基本身份验证，我希望我可以简单地做到这一点：

```
string imageURL = ("https://username:password@api.blah.blah/customers/" + userID.ToString() + "/photo");
pictureBox1.LoadAsync(imageURL); 
```

但我没有运气。任何帮助，将不胜感激。

# vb.net - Visual Basic 如何在内存中存储字符串？

> ID：11939006
> 
> 赞同：0
> 
> 时间：2012-08-13T17:08:29.890
> 
> 标签：vb.net, string, memory-management, .net-4.0, reverse-engineering

我遇到了一种情况，我需要找到我在一段 VB 代码中使用的字符串的内存地址。我尝试使用各种调试器并使用简单的 procexplorer 来显示内存中可打印字符串的列表。但它没有显示任何让我困惑的东西。VB（.net framework 4）是否使用某种编码机制来存储字符串，使其不会以可打印格式出现？

这是我试图在内存中定位的变量：“spoilt”

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        MessageBox.Show("Button1")
        Dim spoilt As String
        spoilt = TextBox1.Text
        Label1.Text = spoilt

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:40:45.657

这些是*托管*字符串。我不确定您使用的工具是否知道如何从内存中读取托管字符串。

.NET 字符串文字存储在可移植可执行文件的元数据部分。除非该工具了解如何从 .NET 的元数据部分中读取它，否则它不会找到它。您可以使用[ildasm](http://msdn.microsoft.com/en-us/library/f7dy01k1%28v=vs.80%29.aspx)之类的工具查看字符串。在“查看”和“元信息”下，单击“显示！”。新窗口中的某处将是“用户字符串”部分。这是我的示例应用程序。

```
User Strings
-------------------------------------------------------
70000001 : (35) L"Property can only be set to Nothing"
70000049 : (28) L"WinForms_RecursiveFormCreate"
70000083 : (26) L"WinForms_SeeInnerException"
700000b9 : ( 7) L"Button1"
700000c9 : ( 6) L"Label1"
700000d7 : ( 8) L"TextBox1"
700000e9 : ( 5) L"Form1"
700000f5 : (29) L"WindowsApplication1.Resources" 
```

在这里我们可以看到字符串（在我的例子中）的 MetaData Token 是`700000b9`.

* * *

现在，如果您想在运行时查找字符串的地址...

我将用来执行此操作的首选工具是带有[SOS 扩展的](http://msdn.microsoft.com/en-us/library/bb190764.aspx)[WinDbg](http://en.wikipedia.org/wiki/WinDbg)。以下是如何在内存中找到该字符串。

这就是 x86 .NET Framework 4 的全部内容。

1.  首先打开 WinDbg 并选择打开进程并打开您的 EXE。它会立即中断，让您有机会进行设置，例如断点。
2.  加载 CLR JIT 时设置异常停止。这将是加载 SOS 调试器扩展的正确时机。

    ```
    sxe ld:clrjit 
    ```

    然后继续执行`g`.

3.  在这一点上，我们应该在 clrjit 的 modload 上打断点。

    ```
    ModLoad: 57910000 57970000   C:\Windows\Microsoft.NET\Framework\v4.0.30319\clrjit.dll 
    ```

    从那里我们可以加载 SOS 调试扩展`.loadby sos clr`。

4.  `!eeversion`我们可以通过运行获取 Execution Enging 版本来测试 SOS 是否正确加载。对我来说，这给出了“4.0.30319.269 零售”。

5.  现在找到那个字符串。`System.Windows.Forms.dll`让我们从加载模块时中断开始。

    ```
     sxe ld:System.Windows.Forms 
    ```

    并用于`g`继续执行。我们应该在模块加载时中断。继续并跨过它，以便模块实际加载`p`.

6.  现在我们可以`MessageBox.Show`像这样中断：

    ```
    !bpmd System.Windows.Forms.dll System.Windows.Forms.MessageBox.Show 
    ```

7.  现在继续前进`g`。您的应用程序现在应该正在运行。继续并单击按钮，我们的断点应该被命中。

8.  然后我们可以*进入* `Show`with `t`。

9.  从那里我们可以使用`!clrstack -p`参数显示堆栈跟踪。在堆栈的顶部将调用`MessageBox.Show`.

    ```
    004ee820 5c22839c System.Windows.Forms.MessageBox.Show(System.String)
    PARAMETERS:
    text (<CLR reg>) = 0x022a1058 
    ```

10.  所以现在我们知道字符串的地址是`0x022a1058`. 这对你来说当然会有所不同。如果我们执行 a`!do 0x022a1058`它会给我们字符串：

    ```
    Name:        System.String
    MethodTable: 638afb08
    EEClass:     635e8bb0
    Size:        28(0x1c) bytes
    File:        C:\Windows\Microsoft.Net\assembly\GAC_32\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll
    String:      Button1 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:03:50.440

回答我自己关于编码的问题：是的，Unicode 编码用于存储所有字符串。@vcsjones 的上述回答详细解释了如何找到这些字符串的内存位置。

为了寻找有关如何找到此地址的答案的人们的利益，有一种更简单的方法。**mona.py** (http://redmine.corelan.be/projects/mona) 是一个免疫调试器插件来完成这项工作。我用它来查找内存位置。我无法找到所需内容的唯一原因是 unicode 格式。但是，使用 mona.py 也可以选择搜索 unicode 字符串。

# jquery - 点击居中时淡入淡出文本

> ID：11939011
> 
> 赞同：0
> 
> 时间：2012-08-13T17:08:49.940
> 
> 标签：jquery, center, responsive-design, fade

我想做一些非常简单的事情。当我单击一个 div 时，我想显示一些以任何分辨率为中心的文本。

这是我的方法：

```
<button>Click</button>
<div id="fade"><a class="close" href="#">&#215;</a>
     <p>Lorem ipsum sit dolor amet</p>

 </div> 
```

这个CSS：

```
#fade {background:red; width:100%; height:150px;}
.close {
color:white;
font:bold 40px Arial,Sans-Serif;
text-decoration:none;    
   } 
```

这是一个[jsfiddle](http://jsfiddle.net/KaeT7/7/) ​</p>

现在我想做的是将#fade div 集中在每个屏幕分辨率上。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:10:45.013

## *`div`始终垂直和水平居中*

首先，您需要为`div`. 100%不会做。
接下来，将其设置`position`为`absolute`;

```
#fade {background:red; width:450px; height:150px; position:absolute;} 
```

然后是更新的 jQuery：

```
jQuery.fn.center = function() {
    _TOP = (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop();
    _TOP = (_TOP <= 0) ? 0 : _TOP;
    _LEFT= (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft();
    _LEFT = (_LEFT <= 0) ? 0 : _LEFT;
    this.css({
        top:_TOP + "px",
        left:_LEFT + "px"
    });
    return this;
}

$("#fade").center();
$(window).on('resize', function() {
    $("#fade").center();
});

$("#fade").hide();
$("button").click(function() {

    $("#fade").fadeToggle("slow", "linear").find(".close").on("click", function() {
        $(this).parents("#fade").fadeOut("slow");
        return false;
    });

    $("#fade").center();
});​ 
```

[**演示**](http://jsfiddle.net/nxnPk/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:13:41.700

设置包含文本的 p 标签的 text-align 属性。

```
<p style="text-align:center">Lorem ipsum sit dolor amet</p> 
```

**[现场演示](http://jsfiddle.net/rajaadil/KaeT7/8/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:26:25.330

对于垂直对齐设置：

```
#fade {
    background:red; 
    width:100%; 
    height:150px;
    position: absolute;
    top: 50%;
    margin-top: -75px;
} 
```

**[现场演示](http://jsfiddle.net/KaeT7/10/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:37:53.940

这是我的解决方案，它添加了填充以使 div 的内容居中，并`#fade`在通过 jQuery onclick 时将 div 放置在屏幕中间：

CSS：

```
#fade { background:red; width:90%; padding:50px 0; text-align:center; position:absolute; }
#fade p { display:inline-block; position:relative; top:-10px;  } 
```

Javascript：

```
$("#fade").hide();
$("button").click(function() {
    var wh = $(window).height();
    var ww = $(window).width();
    var fh = $('#fade').outerHeight();
    var fw = $('#fade').outerWidth();
    $('#fade').css('top', Math.floor((wh-fh)/2)+'px');
    $('#fade').css('left', Math.floor((ww-fw)/2)+'px');
    $("#fade").fadeToggle("slow", "linear").find(".close").on("click", function() {
        $(this).parents("#fade").fadeOut("slow");
        return false;
    });
}); 
```

如果您不想使用 jQuery，请改用 css，例如，`#fade { margin:50px auto; }`但它不会垂直居中。

[小提琴就在这里。](http://jsfiddle.net/KaeT7/17/)

# ios - 如果使用动画调用 setContentOffset，UIScrollView 会崩溃

> ID：11939016
> 
> 赞同：2
> 
> 时间：2012-08-13T17:09:19.613
> 
> 标签：ios, uiview, uiscrollview

我的应用程序创建 UIView 的自定义子类的实例，并将这些实例水平放置在彼此相邻的位置。创建 UIView 类的新实例后，我可以将其添加到 UIScrollView 并重置 contentsize。然后我打电话 `[UIScrollView setContentOffset:(some point) animated:NO]`。这工作得很好。问题是当我用动画调用上述方法时，即 `[UIScrollView setContentOffset:(some point) animated:YES]` 应用程序崩溃。调用堆栈如下所示：

```
> #0    0x3145b870 in ___forwarding___ ()
> #1    0x313b6650 in _CF_forwarding_prep_0 ()
> #2    0x317d84a2 in -[UIAnimator stopAnimation:] ()
> #3    0x317d84a2 in -[UIAnimator stopAnimation:] ()
> #4    0x317d7f0e in -[UIAnimator(Static) _advance:withTimestamp:] ()
> #5    0x317d7e00 in -[UIAnimator(Static) _LCDHeartbeatCallback:] ()
> #6    0x3531d86e in CA::Display::DisplayLink::dispatch(unsigned long long, unsigned long long) ()
> #7    0x3531d7c4 in CA::Display::IOMFBDisplayLink::callback(__IOMobileFramebuffer*,
> unsigned long long, unsigned long long, unsigned long long, void*) ()
> #8    0x33a56000 in IOMobileFramebufferVsyncNotifyFunc ()
> #9    0x36e3c60c in IODispatchCalloutFromCFMessage ()
> #10   0x31422f12 in __CFMachPortPerform ()
> #11   0x3142d522 in __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ ()
> #12   0x3142d4c4 in __CFRunLoopDoSource1 ()
> #13   0x3142c312 in __CFRunLoopRun ()
> #14   0x313af4a4 in CFRunLoopRunSpecific ()
> #15   0x313af36c in CFRunLoopRunInMode ()
> #16   0x32888438 in GSEventRunModal ()
> #17   0x316b4cd4 in UIApplicationMain () 
```

当我启用 Zombies 时，应用程序输出会产生：

```
*** -[__NSArrayM removeObject:]: message sent to deallocated instance 0x113dbb10 
```

附加信息：UIScrollView 的委托从未设置。我正在使用 ARC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T05:49:03.900

我发现了我的问题。我正在从后台线程调用调用 setContentOffset 的方法。

```
BackgroundThread --> My random processing method --> Setup new UIView and add it to UIScrollView --> Call setContentOffset with animations 
```

上述流程导致崩溃。当我从主线程调用相同的处理方法时，它工作得很好。

显然 iOS 不喜欢从后台线程调用的动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:43:47.480

scrollView 中的一个视图正在被释放。当您关闭动画时，您可能会“跳过”它 - 当它打开时，系统会尝试获取一系列更改的“快照”，并且当它尝试访问一个视图时，您就走了。因此，您可以启用 Zombies 并准确找出正在获取消息的对象类型，并且在调试器中您可能可以“po”该对象。

另一种方法是编写我们自己的测试动画，在没有动画的循环中一次移动 contentOffset 20 像素，并观察它何时崩溃（它肯定会）！

# android - 滚动通知中的文本

> ID：11939018
> 
> 赞同：2
> 
> 时间：2012-08-13T17:09:27.127
> 
> 标签：android, notifications

我有一个包含少量文本的通知，但它仍然很大，以便显示在通知栏中，因此它被缩写了。我发现它的唯一解决方案是发出自定义通知，但对于我正在尝试做的事情来说似乎有点矫枉过正。

我可以制作通知滚动文本或扩展通知文本区域，以便它显示全文而不仅仅是它的前几个单词？

我目前通过以下方式调用通知：

```
private void triggerNotification() {
        Notification notification = new Notification(R.drawable.ic_launcher,
                "Title", System.currentTimeMillis());
        notification.setLatestEventInfo(this, "First text",
                "This is the text that gets abberviated with .. when it is too long",
                PendingIntent.getActivity(this, 0, new Intent(this,MainActivity.class)
                        .setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP),
                        PendingIntent.FLAG_CANCEL_CURRENT));
        notification.flags |= Notification.FLAG_AUTO_CANCEL;
        nm.notify(0, notification);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:57:54.393

In API 16+, there is a [Notification.Builder](http://developer.android.com/reference/android/app/Notification.Builder.html) class that allows you to add a [subtext](http://developer.android.com/reference/android/app/Notification.Builder.html#setSubText%28java.lang.CharSequence%29) which can be of multiple lines (Like [Gmail notifications](http://www.unwinnable.com/wp-content/uploads/2012/07/F127268090-576x1024.png)). I don't know if `Notification.Builder` is included in [the support library](http://developer.android.com/tools/extras/support-library.html) but I guess it might be. You can check it.

However, if it is not in the support library and you have to stick to your minSdkVersion, I'm afraid that there is no way to do what you want other than implementing your own notification version.

* * *

**UPDATE:**

The last revision of the support library (revision 10 which was released on August 2012) introduces the Android 4.1 notification style: [BigTextStyle](http://developer.android.com/reference/android/support/v4/app/NotificationCompat.BigTextStyle.html). there is a good example of how you can use it. Check it [here](http://developer.android.com/reference/android/support/v4/app/NotificationCompat.BigTextStyle.html).

# graph - rrdtool y 轴值“200m”而不是“0.2”

> ID：11939020
> 
> 赞同：8
> 
> 时间：2012-08-13T17:09:27.660
> 
> 标签：graph, rrdtool, rrd

我有一个 rrd，它主要包含 0 到 1 的值（linux 负载平均值）。

有时图表显示在 y 轴 => "0.1 0.2 ... 0.9"。这就是我想要的方式。

但其他时候，我看到以下“100m 200m ...”。

有没有办法强制显示为“0.1等”？价值观？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-13T17:56:42.540

`-X 0`成功了。

[-X|--单位-指数值]

这将设置 y 轴值的 10** 指数缩放。通常，值将缩放为适当的单位（k、M 等）。但是，即使数据在 M（Mega，10e6）范围内，您也可能希望始终以 k（Kilo，10e3）显示单位。值应该是一个整数，它是 3 的倍数，介于 -18 和 18（含）之间。它是您希望使用的单位的指数。例如，使用 3 以 k（千，10e3，千）显示 y 轴值，使用 -6 以 u（微，10e-6，百万分之一）显示 y 轴值。使用值 0 可防止对 y 轴值进行任何缩放。

# xml - 搜索并插入链接

> ID：11939022
> 
> 赞同：0
> 
> 时间：2012-08-13T17:09:35.137
> 
> 标签：xml, xml-parsing, xslt-2.0

我正在尝试找到一个单词并将其替换为链接。例如：

```
<root>
<description>
Uniquely cultivate optimal supply chains before multidisciplinary infrastructures.
</description>
</root> 
```

在 xsl 中，我正在尝试搜索特定单词并用链接替换该单词。例如，我想将“培养”一词替换为[培养](http://google.com)，因此页面上的最终输出将是：

```
 Uniquely <a href="http://google.com">cultivate</a> optimal supply chains before multidisciplinary infrastructures. 
```

我正在使用替换功能来解决这个问题，例如：

```
<xsl:variable name="description" select="description" /> 
```

接着

```
 replace($description, "(.*)(cultivate.*)", "$1test$2") 
```

这只是在修炼之前添加了测试这个词。我真的很感激任何帮助。

--UPDATE-- 我能够使用这样的替换来解决这个问题

```
<xsl:variable name="description" select="description" />
Description: <xsl:value-of disable-output-escaping="yes" select="replace($description, '(.*)(cultivate)(.*)', '$1&lt;a href=http://google.com &gt;cultivate&lt;/a&gt;$3')" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:42:58.280

使用`analyze-string` [http://www.w3.org/TR/xslt20/#re](http://www.w3.org/TR/xslt20/#regex-examples) ​​gex-examples例如

```
<xsl:template match="description">
  <xsl:analyze-string select="." regex="cultivate">
    <xsl:matching-substring>
      <a href="http://example.com">
        <xsl:value-of select="."/>
      </a>
   </xsl:matching-substring>
   <xsl:non-matching-substring>
     <xsl:value-of select="."/>
   </xsl:non-matching-substring>
 </xsl:analyze-string>
</xsl:template> 
```

# asp.net-mvc-3 - 根据月份和日期对数据进行排序

> ID：11939023
> 
> 赞同：0
> 
> 时间：2012-08-13T17:09:38.317
> 
> 标签：asp.net-mvc-3, entity-framework-4.1

我的数据库结构如下：

```
long OccasionId { get; set; }
string OccasionName { get; set; }
string OccasionDesc { get; set; }
DateTime OccasionDate { get; set; } 
```

我需要以下格式的html结果

```
February
     OccasionName1
     5th February
     OccasionDesc1

     OccasionName2
     7th February
     OccasionDesc2 
```

现在数据必须按月排序和分组，然后按日期而不是年份；意味着如果有两个日期 05/02/1974 和 07/02/1970，即使第二个日期由于年份而排在第一位，我也需要将 2 月 5 日排在第一位。

我正在使用实体框架和 asp.net mvc

谢谢

阿纳布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T02:37:38.467

好吧，您没有提到您的数据库，而是在 SQL Server 上：

```
var q = from o in Context.Occasions
        orderby o.Month, o.Day
        select o; 
```

...应该管用。你试过吗？但是，根据查询的其余部分的细节，它可能有效也可能无效。

# java - 关于对抽象工厂模式的理解

> ID：11939025
> 
> 赞同：1
> 
> 时间：2012-08-13T17:09:45.757
> 
> 标签：java, design-patterns

我正在通过下面的抽象工厂设计模式是那个UML图.. ![在此处输入图像描述](../Images/72d5d8d6e61bb806d20575601808779d.png)

请向我推荐这个模式的最佳示例，因为我已经尽力了，但我正在寻找易于学习的示例，并希望让我对抽象工厂模式的理解 100% 清晰。请告知

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T17:21:05.070

您看过 JDK 中内置的 DocumentBuilderFactory 类吗？它正是这样做的，它的目标项是一个 Document 对象。

jdk 有 DocumentBuilderFactory 类，它使用服务定位器策略来查找 DocumentBuilderFactory 类的具体实现（即 xerces 或其他一些解析器）。

```
// Uses service locator approach to find an implementor like xerces
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
Document document = builder.parse(...); 
```

java.awt.Toolkit 是另一个很好的例子。这一次，它使用 JVM 实现本身来提供实例：

```
Toolkit toolkit = Toolkit.getDefaultToolkit(); 
```

实际的具体类根据您使用的操作系统以及您是否在无头模式下运行而有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:27:04.440

回想一下，工厂模式用于创建对象而不指定对象的确切类，从而减少了这两个组件之间的耦合。抽象工厂模式甚至通过定义一个所有工厂都必须实现的接口来减少解耦的数量。因此，抽象工厂的调用者对工厂的实现以及对象的创建方式一无所知。刚才的调用者，调用工厂的方法会产生接口 X 的某个对象实例。

Matt 的 XML 库示例实际上是一个很好的示例。抽象工厂是创建 XML 解析器的实体，它创建一个`Document`代表您解析的实际文档的对象。实际上，对于作为调用者的你来说，大多数时候使用哪个 Parser 完全无关紧要，只要你从中得到一个`Document`对象即可。因此，您可以简单地使用抽象工厂。这会为您创建一个有效的解析器（大多数时候；））

Toolkit 示例（也由 Matt 提到）是一个更像教科书的示例。想象一下，您只想在用户屏幕上填充一个窗口。由于您想以独立于平台的方式执行此操作，因此您定义了一个抽象类 Window ，您可以使用它来执行某些操作。然后你创建一个创建这些窗口的对象，比方说`Win32WindowsFactory`。但是，由于您的代码应该是独立于平台的，因此您定义了一个`WindowsFactory`为您提供方法的接口`createWindow()`。使用`Win32WindowsFactory`时`Win32Window`返回a `LinuxGTKWindowsFactory`，使用a时`GTKWindow`返回a。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T17:45:37.430

它最常见的用例是依赖注入。您可以在其中一些线程中找到详细信息 [什么是依赖注入？](https://stackoverflow.com/questions/130794/what-is-dependency-injection)

# c# - Google OAuth2 Service Account Access Token Request gives 'Invalid Request' Response

> ID：11939026
> 
> 赞同：12
> 
> 时间：2012-08-13T17:09:54.227
> 
> 标签：c#, oauth-2.0, sha256, google-bigquery, jwt

I'm trying to communicate with my app's enabled BigQuery API via the server to server method.

I've ticked all the boxes on this [Google guide](https://developers.google.com/accounts/docs/OAuth2ServiceAccount) for constructing my JWT as best I can in C#.

And I've Base64Url encoded everything that was necessary.

However, the only response I get from google is a 400 Bad Request

```
"error" : "invalid_request" 
```

I've made sure of all of the following from these other SO questions:

*   [The signature is properly encrypted using RSA and SHA256](https://stackoverflow.com/questions/7444586/how-can-i-sign-a-file-using-rsa-and-sha256-with-net)
*   [I am using POST and using application/x-www-form-urlencoded content type](https://stackoverflow.com/questions/10133337/oauth2-authentication-for-google-service-returns-invalid-request)
*   [Escaped all the backslashes in the claim set](https://stackoverflow.com/questions/11126439/google-oauth-2-0-jwt-token-request-for-service-application)
*   [Tried various grant_type and assertion values in the POST data](https://stackoverflow.com/questions/10133337/oauth2-authentication-for-google-service-returns-invalid-request)

I get the same result when I use Fiddler. The error message is frustratingly lacking in detail! What else can I try?! Here's my code:

```
class Program
{
    static void Main(string[] args)
    {
        // certificate
        var certificate = new X509Certificate2(@"<Path to my certificate>.p12", "notasecret");

        // header
        var header = new { typ = "JWT", alg = "RS256" };

        // claimset
        var times = GetExpiryAndIssueDate();
        var claimset = new
        {
            iss = "<email address of the client id of my app>",
            scope = "https://www.googleapis.com/auth/bigquery",
            aud = "https://accounts.google.com/o/oauth2/token",
            iat = times[0],
            exp = times[1],
        };

        // encoded header
        var headerSerialized = JsonConvert.SerializeObject(header);
        var headerBytes = Encoding.UTF8.GetBytes(headerSerialized);
        var headerEncoded = Base64UrlEncode(headerBytes);

        // encoded claimset
        var claimsetSerialized = JsonConvert.SerializeObject(claimset);
        var claimsetBytes = Encoding.UTF8.GetBytes(claimsetSerialized);
        var claimsetEncoded = Base64UrlEncode(claimsetBytes);

        // input
        var input = headerEncoded + "." + claimsetEncoded;
        var inputBytes = Encoding.UTF8.GetBytes(input);

        // signiture
        var rsa = certificate.PrivateKey as RSACryptoServiceProvider;
        var cspParam = new CspParameters
        {
            KeyContainerName = rsa.CspKeyContainerInfo.KeyContainerName,
            KeyNumber = rsa.CspKeyContainerInfo.KeyNumber == KeyNumber.Exchange ? 1 : 2
        };
        var aescsp = new RSACryptoServiceProvider(cspParam) { PersistKeyInCsp = false };
        var signatureBytes = aescsp.SignData(inputBytes, "SHA256");
        var signatureEncoded = Base64UrlEncode(signatureBytes);

        // jwt
        var jwt = headerEncoded + "." + claimsetEncoded + "." + signatureEncoded;

        Console.WriteLine(jwt);

        var client = new HttpClient();
        var uri = "https://accounts.google.com/o/oauth2/token";
        var post = new Dictionary<string, string>
        {
            {"assertion", jwt},
            {"grant_type", "urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer"}
        };
        var content = new FormUrlEncodedContent(post);
        var result = client.PostAsync(uri, content).Result;

        Console.WriteLine(result);
        Console.WriteLine(result.Content.ReadAsStringAsync().Result);
        Console.ReadLine();
    }

    private static int[] GetExpiryAndIssueDate()
    {
        var utc0 = new DateTime(1970, 1, 1, 0, 0, 0, 0, DateTimeKind.Utc);
        var issueTime = DateTime.Now;

        var iat = (int)issueTime.Subtract(utc0).TotalSeconds;
        var exp = (int)issueTime.AddMinutes(55).Subtract(utc0).TotalSeconds;

        return new[]{iat, exp};
    }

    private static string Base64UrlEncode(byte[] input)
    {
        var output = Convert.ToBase64String(input);
        output = output.Split('=')[0]; // Remove any trailing '='s
        output = output.Replace('+', '-'); // 62nd char of encoding
        output = output.Replace('/', '_'); // 63rd char of encoding
        return output;
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-13T21:03:46.693

看来我在上面评论中的猜测是正确的。我通过更改使您的代码正常工作：

`"urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer"`

至：

`"urn:ietf:params:oauth:grant-type:jwt-bearer"`

看起来你不小心对它进行了双重编码。

我现在得到一个看起来像这样的响应：

```
{
  "access_token" : "1/_5pUwJZs9a545HSeXXXXXuNGITp1XtHhZXXxxyyaacqkbc",
  "token_type" : "Bearer",
  "expires_in" : 3600
} 
```

编辑说明：请确保您的服务器上有正确的日期/时间/时区/夏令时配置。将时钟关闭几秒钟也会导致`invalid_grant`错误。 [http://www.time.gov](http://www.time.gov)将提供美国政府的官方时间，包括 UTC。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-04T14:05:44.397

请务必在 GetExpiryAndIssueDate 方法中使用 DateTime.UtcNow 而不是 DateTime.Now。

# java - setPreferredSize does not work

> ID：11939028
> 
> 赞同：6
> 
> 时间：2012-08-13T17:09:58.960
> 
> 标签：java, swing, jframe, awt, jpanel

Code:

```
import java.awt.Dimension;

import javax.swing.*;

public class Game extends JFrame {
    private static final long serialVersionUID = -7919358146481096788L;
    JPanel a = new JPanel();
    public static void main(String[] args) {
        new Game();
    }
    private Game() {
        setTitle("Insert name of game here");
        setLocationRelativeTo(null);
        setLayout(null);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        a.setPreferredSize(new Dimension(600, 600));
        add(a);
        pack();
        setVisible(true);
    }
} 
```

So I set the preferred size of the `JPanel` to 600 by 600 and pack the frame, but the frame's size is still 0 by 0\.

Why is this and how do I fix it?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T17:21:59.390

正如您所说，`pack()`将尝试安排窗口，以便将每个组件的大小调整为其首选大小。

问题在于布局管理器似乎是试图安排组件及其各自的首选大小的管理器。但是，当您将布局管理器设置为空时，没有人负责。

尝试评论该`setLayout(null)`行，你会看到结果。当然，对于一个完整的窗口，您将不得不选择并设置一个有意义的`LayoutManager`.

这对我来说很好：

```
import java.awt.Dimension;

import javax.swing.*;

public class Game extends JFrame {
    private static final long serialVersionUID = -7919358146481096788L;
    JPanel a = new JPanel();
    public static void main(String[] args) {
        new Game();
    }
    private Game() {
        setTitle("Insert name of game here");
        setLocationRelativeTo(null);
        //setLayout(null);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        a.setPreferredSize(new Dimension(600, 600));
        add(a);
        pack();
        setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:18:01.697

`pack()`查询父容器的首选大小而不是子容器的首选大小，因此您必须使用：

```
setPreferredSize(new Dimension(600, 600)); 
```

另一个注意事项是调用

```
setLocationRelativeTo(null); 
```

after`pack()`被调用来计算中心坐标:)

好的，刚刚发现那里的空布局，为什么不使用JFrame的默认BorderLayout呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T17:20:31.200

你的问题是`setLayout(null)`，因为文档说`pack()`：

> 调整此窗口的大小以适合其子组件的首选大小和布局

因此没有布局它不能正确执行。

这对我来说似乎很好用：

```
import java.awt.Dimension;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Game extends JFrame {

    JPanel panel = new JPanel();

    private void createAndShowGUI() {
        setTitle("FrameDemo");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        panel.setPreferredSize(new Dimension(600, 600));
        add(panel);

        //setLayout(null); //wont work with this call as pack() resizes according to layout manager
        pack();
        setLocationRelativeTo(null);
        setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Game().createAndShowGUI();
            }
        });
    }
} 
```

# javascript - 为什么 {} + [] 在 Javascript 中返回 0？

> ID：11939044
> 
> 赞同：42
> 
> 时间：2012-08-13T17:10:51.313
> 
> 标签：javascript

> **可能重复：**
> [CodeMash 2012 的“Wat”演讲中提到的这些奇怪的 JavaScript 行为的解释是什么？](https://stackoverflow.com/questions/9032856/what-is-the-explanation-for-these-bizarre-javascript-behaviours-mentioned-in-the)

我知道当`[]`被强制转换为字符串时，它返回空字符串 ( `""`)，而当`{}`被强制转换为字符串时，它返回`"[object Object]"`。

当我`[] + {}`在浏览器的 Javascript 控制台中运行时，它会按预期返回：

```
>> [] + {}
"[object Object]" 
```

但是当我运行时`{} + []`，它返回一个完全出乎意料的值：

```
>> {} + []
0 
```

什么可能导致它返回`0`？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-08-13T17:12:34.913

当`{`语句开头有 a 时，它将被解释为一个块，其中可能包含零个或多个语句。一个没有语句的块将有一个空的延续值。

换句话说，在这种情况下，`{}`被解释为一个空代码块。

语句在结束大括号之后结束`}`，这意味着接下来的三个字符`+[]`组成了它们自己的语句。

在表达式或语句的开头`+`是一元加号运算符，它将其操作数强制为一个数字。

So`+[]`与 相同`Number([])`，其计算结果为`0`。

简而言之，**`{} + []`是一个空代码块，后面跟着一个强制为数字的数组。**

* * *

综上所述，如果您`{} + []` *在表达式内部*进行评估，它将返回您所期望的：

```
>> ({} + []) 
"[object Object]" 
```

另一个有趣的事情是，您不能以对象字面量开始语句，因为解释器会尝试将其解析为语句。这样做

```
{ "object": "literal" }; 
```

会抛出语法错误。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-13T17:12:08.377

因为`{}`被视为一个块。因此，您的陈述实际上是：

```
{

//empty block here
}

+[] //0 same as Number([]) 
```

这就是为什么这是无效的javascript：

```
eval('{hello: "world", key: "value"}') //Syntax error 
```

您可以添加 () 使其成为表达式（块不能在表达式中使用，因此它将成为对象初始化器：

```
eval('({hello: "world", key: "value"})') //Object 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T17:14:46.460

空块被强制为零。然后`+`操作员决定将其强制`[]`为一个数字。

# c# - Inserting MathMl , Tex or LaTex equation in MS word .docs?

> ID：11939050
> 
> 赞同：6
> 
> 时间：2012-08-13T17:11:17.330
> 
> 标签：c#, asp.net, .net, ms-word, mathml

I've been looking for some dll for .Net in C# for inserting any of MathMl , Tex or LaTex equations in MS Word, I tried some like DocX but they failed, do you know any? or any hint how to it? thanks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T11:09:56.247

Word (2007+) 可以从剪贴板中接受 MathML。例如，Windows 7 数学输入面板在其“插入”按钮上简单地将生成的 MathML 放在剪贴板上，然后将模拟的 control-v 键事件发送到下一个活动应用程序，该应用程序希望在当前点插入 mathml。

在内部，Word 2007 通过运行 MathML 的 XSLT 样式表来生成 OOML 标记，然后插入该标记以在 docx 文件中创建一个数学区域。

样式表通常安装为类似

```
/Program Files/Microsoft Office/Office12/OMML2MML.XSL 
```

因此，为您提供更多控制的另一种方法是使用 .NET XSLT 处理器将 MathML 转换为 OMML，然后直接在 ooxml xml 文件中或通过 office API 将 ooMML 添加到文档的内容 xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-16T16:32:58.177

以下简单程序有效：

1.  配置 MathType 以将首选项复制/粘贴到：“Mathml”（选择合适的版本）
2.  将您的 Mathml 方程式粘贴到 Mathtype 面板中：方程式出现并且可以编辑/修改 -> 微调您的方程式。
3.  将 Mathtype 的复制/粘贴首选项重新配置为“方程式对象（Windows OLE 图形）” - 现在将方程式从 MathType 复制粘贴到 Word

# oracle10g - Oracle sessions and processes generated by a .NET web app

> ID：11939051
> 
> 赞同：0
> 
> 时间：2012-08-13T17:11:17.850
> 
> 标签：oracle10g, odp.net

Our .NET web app uses ODP.NET for connections and its Oracle User for connecting to database is "webuserOracle". That web app always close connections and dispose connections.

However, on our Oracle 10g database, we see that sessions and processes values of Oracle User "webuserOracle" is always high, as they woudn't close or die.

We have decided to set up on Oracle profile for "webuserOracle" in order to limit the connect time up to 5 minutes.

```
CREATE PROFILE profile_webuserOracle LIMIT CONNECT_TIME 5;

ALTER USER webuserOracle PROFILE profile_webuserOracle; 
```

Question:

For a web app, limiting connection to 5 minutes, means that the user could interact, say, 2 hours with the web app. The limit of 5 minutes is only for events triggered (like clicking a button) to connect to database. 5 minutes for everything that happened between Con.Open and Con.Dispose:

```
Dim con As OracleConnection = oraConexion()
con.Open()
''' There'll be a limit of 5 minutes to run the code here
con.Close()
con.Dispose() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:08:09.190

在 Web 应用程序的配置文件中设置 a`CONNECT_TIME`可能是一个非常糟糕的主意。

首先，一般来说，三层应用程序将使用中间层的连接池。这意味着中间层服务器会打开一个连接到数据库的连接池，这些连接会在很长一段时间内保持打开状态，并根据需要分发给 Web 会话。这意味着在网站上单击的单个 Web 用户可能会在每次单击时获得不同的数据库会话，并且单个数据库会话将被大量 Web 用户使用。

如果你`CONNECT_TIME`为你的连接池连接设置一个，

*   中间层可能会不断收到错误，即它从连接池中获得的特定连接已超过其允许的连接时间。您可以通过让中间层在从池中获取的每个连接上执行一个虚拟查询（即`select 1 from dual`）来缓解其中的一些问题，以验证在交互开始之前 5 分钟没有过去，但不能保证超时获胜'在页面上运行第一个查询时无法到达。
*   中间层将不断地打开到数据库的新物理连接（一个相当昂贵的过程），以替换因为打开 5 分钟而关闭的连接。这些连接风暴可能会给数据库带来巨大的负载。这也会给应用程序带来性能问题，因为用户一直在等待新的物理连接打开，而不是能够重用池中的连接。
*   如果您进行此更改，会话和进程的数量可能会更高。中间层将维护它需要为用户提供服务的许多实际物理连接，以及一些必须保留的过期连接，以便通知下一个调用者它们已过期。

您要解决的真正问题是什么？中间层将维护一个不会关闭的数据库连接池是完全正常的。这是完全正常和健康的。如果您想减少任何时候打开的连接数，您可以调整中间层服务器上的连接池设置。

# xamarin.android - Monodroid platform

> ID：11939052
> 
> 赞同：2
> 
> 时间：2012-08-13T17:11:20.330
> 
> 标签：xamarin.android

I'm new on Monodroid platform, I wonder is there good references/books/examples that integrate Monodroid with Google javascript API (Drive, Calendar, Contact, etc.). What I know is that there Client Library for .NET/C# but I fail integrate it with Monodroid (not understand to use OAuth on Monodroid too)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T21:24:52.127

以下是您可能会发现有用的链接集合：

*   Mono for Android 文档主页：[http ://docs.xamarin.com/android](http://docs.xamarin.com/android)
*   MfA 示例：[http ://samples.xamarin.com/Android](http://samples.xamarin.com/Android)
*   MfA 食谱：[http ://docs.xamarin.com/android/Recipes](http://docs.xamarin.com/android/Recipes)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:14:32.637

来自 Xamarin的[https://github.com/xamarin/monodroid-samples](https://github.com/xamarin/monodroid-samples)上的大量示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:06:46.213

我一直发现沃利的书非常适合指导。他和其他一些人撰写了由 Wrox 出版的“Android Programming with Mono for Android and .NET/C#”。搜索亚马逊，那里也有其他书籍。

Wrox 还出版了 3 本书；3 包包括一本关于使用 C# (MonoTouch) 进行 iOS 开发的书和一本确定将代码库捆绑在一起的一些跨平台技术和模式的书。

书名是：

*   专业的 C# 跨平台移动开发

*   使用 MonoTouch 和 .NET/C# 进行专业 iPhone 编程

*   使用 Mono for Android 和 .NET/C# 进行 Android 编程

# installation - WiX running batch file, before file copy

> ID：11939054
> 
> 赞同：0
> 
> 时间：2012-08-13T17:11:21.827
> 
> 标签：installation, wix

I am Using WiX 3.5 for making installer, i need to copy many files and folder. I used heat.exe to do that, and it is working fine. But i need to call bat file during installation, and the bat file is present in those folders i mentioned above. That bat file is depended on some other files. I am able to call the batch file but by that time the other files are not loaded. Below is the custom action i am using for running bat file.

```
<Custom Action="InstallFeature" After="InstallFinalize"><![CDATA[
    (&TypicalFeature=3) AND NOT(!TypicalFeature=3)
]]></Custom> 
```

Need help, may be files are loading after i call the bat file.

Thanks Ravi S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T02:18:56.957

从 MSI 调用批处理文件是一个*非常糟糕的主意*。MSI 是声明性的 - 您只需定义系统在成功安装后的外观，如果出现问题，MSI 可以回滚更改。

但是，通过使用批处理文件，Windows Installer 不知道对系统进行了哪些更改，也无法回滚任何内容。

我会查看批处理文件在做什么，并在 WiX 中或通过 C++/C# 中的自定义操作和相应的回滚操作来实现它正在做的事情。（本机代码是最好的，但很难。托管代码是次要的，VBScript 是最后的手段——但仍然比批处理文件好）

# iphone - rounded corners on UIPageViewController

> ID：11939055
> 
> 赞同：4
> 
> 时间：2012-08-13T17:11:23.280
> 
> 标签：iphone, ios, uipageviewcontroller, ibooks

I was wondering if anyone was ever successful in changing the corners of an UIPageViewController (the fancy book turning animation of iBooks) to rounded corners?

I tried this but to no avail:

```
[self.notebookPages setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:NULL];
self.notebookPages.dataSource = self.pageModelController;
self.notebookPages.doubleSided = NO;
[self addChildViewController:self.notebookPages];

    // mask

    CAShapeLayer *maskLayer = [CAShapeLayer layer];
    UIBezierPath *roundedPath = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(0, 0, 332, 480)
                                                      byRoundingCorners:UIRectCornerTopRight | UIRectCornerBottomRight
                                                            cornerRadii:CGSizeMake(15.f, 15.f)];
    maskLayer.fillColor = [[UIColor whiteColor] CGColor];
    maskLayer.backgroundColor = [[UIColor clearColor] CGColor];
    maskLayer.path = [roundedPath CGPath];

self.notebookPages.view.layer.mask = maskLayer;

[self.notebookScrollNavigationController.notebook.pages addSubview:self.notebookPages.view];

self.notebookPages.view.frame = CGRectMake(0, 0, 332, 480);
[self.notebookPages didMoveToParentViewController:self]; 
```

This is all a bit hardcoded (which is obviously bad) but I was just trying to find out if rounded corners would work. However, I only get a non-rounded transparent corner:

![enter image description here](../Images/b01db906b2a817c577e68c4adb2db44b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T13:54:19.720

添加此导入：

```
#import <QuartzCore/QuartzCore.h> 
```

现在您可以使用cornerRadius：

```
self.notebookPages.view.layer.cornerRadius = 6; 
```

# git - Specify '--remote' Heroku app based on git branch

> ID：11939056
> 
> 赞同：1
> 
> 时间：2012-08-13T17:11:24.310
> 
> 标签：git, heroku, git-branch

Is it possible to to target an app version in Heroku based on the current Git branch? In the Heroku docs, its specifies how to target a a specific version of the app.

```
# run command on 'production'    
$ heroku run rake db:migrate --remote production 
```

> To make things easier, you can use your git config to specify a default app. For example, if you wanted “staging” do be your default remote, you could set it with the following command:
> 
> `$ git config heroku.remote staging`

It would make sense to have the local development branch push to the development app and the local production branch push to the production app.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:33:07.477

我不熟悉 Heroku，但您可以轻松编写一个 shell 脚本包装器：

*   使用获取当前分支的名称`git symbolic-ref --short HEAD`
*   通过使用获取 Heroku 目标`git config heroku.<branch>.remote`
*   运行相应的命令

这假设您为 heroku 手动配置每个分支设置，例如：

```
git config heroku.master.remote production
git config heroku.develop.remote staging 
```

这本身不会做任何事情。它只是让您在脚本中使用`git config`.

# ruby-on-rails - 有什么方法可以在 Rails-API 中使用 MiniProfiler？

> ID：11939057
> 
> 赞同：2
> 
> 时间：2012-08-13T17:11:26.613
> 
> 标签：ruby-on-rails, ruby, mvc-mini-profiler, rails-api

我正在尝试找到一种在**Rails-API应用程序中使用****MiniProfiler for Ruby**的方法？

 **谢谢，

圣地亚哥

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:34:04.320

刚刚发现**首先浏览我想要配置的操作**，**然后从公共文件夹**（如 404.html）中的 HTML 页面，将向我显示自上次检查以来完成的所有配置文件的堆栈。

圣地亚哥**

# objective-c - View-based "Source List" NSOutlineView font smoothing issue

> ID：11939059
> 
> 赞同：1
> 
> 时间：2012-08-13T17:11:39.827
> 
> 标签：objective-c, macos, cocoa, nsoutlineview

I'm migrating a cell-based NSOutlineView to a view-based one, and I'm noticing that text is being rendered differently in the view-based outline view. See this image:

![http://i.stack.imgur.com/VQs3d.png](../Images/6f7ba6867f9e47f99adfb1482c41956c.png)

Why the difference? Some background information that may help?

*   This is on Mac OS X 10.7.4
*   The NSOutlineView's highlight style is Source List
*   The NSOutlineView's background color is transparent, and the background is being drawn by an underlying view
*   In the view-based outline view, the cell text is being drawn by an NSTextField in an NSTableCellView
*   Nothing in the view hierarchy is, to my knowledge, layer-backed

I think this describes a similar issue: [Weird font anti-aliasing in view-based NSOutlineView](https://stackoverflow.com/questions/6968312/weird-font-anti-aliasing-in-view-based-nsoutlineview), but the solution did not work for me, as (I don't think) any of the cell views or text fields are layer-backed.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T05:55:08.380

**更新：**我已经想通了。在 Interface Builder 中，如果我在表格单元格视图中选择文本字段，选中“绘制背景”并将背景颜色设置为清除 (RGBA 0,0,0,0)，则文本看起来像它一样平滑在基于单元格的大纲视图中。

所以我不认为这特别是一个 NSOutlineView 问题。我不知道 Cocoa 文本渲染的内部原理，但我假设这是因为字体平滑会根据绘制文本的背景类型而有所不同。

# ruby-on-rails - How do I render JS in Rails 1.2.6

> ID：11939062
> 
> 赞同：0
> 
> 时间：2012-08-13T17:11:47.270
> 
> 标签：ruby-on-rails, legacy-code

I have the following code as a controller action:

```
def create
  render :js => "alert('hello')"
end 
```

But when I go to this view, I get a missing template error – 'create.rhtml'. What is the correct way to render a javascript response in Rails 1.2.6?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:15:19.950

render :file 可能是你使用 Rails 的最佳选择。您也可以使用旧的 RJS 样式。

# python - 如何在 Django 的 UserCreationForm / User Model 中将客户的电子邮件作为用户名？

> ID：11939066
> 
> 赞同：0
> 
> 时间：2012-08-13T17:12:11.120
> 
> 标签：python, django, django-models, django-forms, django-users

我在 Django 中使用 UserModel 和 UserCreationForm。但是，我不想使用用户名，而是使用客户的电子邮件作为登录信息（即完全绕过/忽略用户名字段）。

1.  如何在用户模型中将用户名字段设为可选
2.  如何将电子邮件变成客户的“用户名”？反过来，我如何使这个电子邮件字段成为必需的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:26:05.097

1.) 只需在表单中将用户名字段设为可选，然后在从电子邮件中删除“@”后，将电子邮件作为用户名传递给模型。

2）创建自定义身份验证后端（这将接受用户名或电子邮件）：

```
from django.contrib.auth.models import User

class EmailOrUsernameModelBackend(object):
    def authenticate(self, username=None, password=None):
        if '@' in username:
            kwargs = {'email': username}
        else:
            kwargs = {'username': username}
        try:
            user = User.objects.get(**kwargs)
            if user.check_password(password):
                return user
        except User.DoesNotExist:
            return None

    def get_user(self, user_id):
        try:
            return User.objects.get(pk=user_id)
        except User.DoesNotExist:
            return None 
```

相应地更改您的设置：

```
AUTHENTICATION_BACKENDS = (
    'myoursite.backends.EmailOrUsernameBackend', # Custom Authentication to accept usernamee or email
) 
```

# css - 浮动图像和网页布局

> ID：11939067
> 
> 赞同：0
> 
> 时间：2012-08-13T17:12:14.573
> 
> 标签：css, layout, css-float

我试图通过两列之间的垂直线将我网站上的两列分开。我正在尝试使用带有 css 样式的“hr”标签使其成为一条垂直线。任何人都可以建议我应该应用的 css 来定位这三个元素吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T06:26:37.910

该`<hr>`标签用于创建水平线。没有特定的标签来创建垂直线，但是您可以通过使用 a`<div>`和 css 中的垂直线属性来创建一个。

这是html代码。您可以将其放置在您想要的任何位置，但您必须在 css 属性中指定位置。

```
<div class="vLine"></div> 
```

这里的css代码：

> .vLine{ 宽度：1px; 高度：1009px；背景颜色：#F0F0F0；颜色：#F0F0F0；位置：绝对；左：150px；}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:35:06.527

如果您确定要使用`<hr />`，请参阅[http://jsfiddle.net/sZqrD/1/](http://jsfiddle.net/sZqrD/1/)。

但我认为[http://jsfiddle.net/9V4qh/](http://jsfiddle.net/9V4qh/)更好

# javascript - 通过 javascript 从 homegrid 视图上的功能区按钮更新 CRM 2011 中的字段

> ID：11939071
> 
> 赞同：0
> 
> 时间：2012-08-13T17:12:30.657
> 
> 标签：javascript, dynamics-crm-2011

我正在尝试在潜在客户的初始列表或 homegrid 视图上创建一个按钮，该按钮将为每次选择的潜在客户设置特定字段的值为相同的值。任何人都知道我可以通过javascript做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:52:04.757

要以 James 的回答为基础，您可以使用`CrmParameter` `SelectedControlSelectedItemIds`获取主页网格中选择的所有潜在客户的列表。[MSDN 论坛上](http://social.microsoft.com/Forums/is/crmdevelopment/thread/382bde52-b7a1-488e-8145-56a38eeb442a "CRM 2011，如何从 CRM 网格中检索选定的记录")有一个解释如何执行此操作的答案，复制如下。您可以在 Xml 源代码或我知道的两个 CRM 功能区编辑器中执行此操作。

之后，您将需要使用`Update`其中一个 CRM Web 服务的方法来循环遍历`Guid`数组并相应地更新每个实体/数据库行。我之前提到过[埃维诺出色的网络资源](https://stackoverflow.com/questions/7358482/how-to-link-two-records-with-javascript-and-a-nm-relationship/7363201#7363201 "如何用 JavaScript 和一个：m 关系链接两条记录")，MSDN 也有一些关于此的附加文档。

*   [演练：通过 JScript 将 SOAP 端点用于 Web 资源](http://msdn.microsoft.com/en-us/library/gg594434.aspx "演练：通过 JScript 将 SOAP 端点用于 Web 资源")
*   [示例：使用带有 JavaScript 的 REST 端点创建、检索、更新和删除](http://msdn.microsoft.com/en-us/library/gg334427.aspx "示例：使用带有 JavaScript 的 REST 端点创建、检索、更新和删除")

```
<CommandDefinition Id="Account.Form.CustomGroup.Button.A.Command">
  <Actions>
    <JavaScriptFunction Library="$webresource:AccountFormLibrar"
                        FunctionName="CreateNewAccount">
      <CrmParameter Value="SelectedControlSelectedItemIds"/>
    </JavaScriptFunction>
  </Actions>
</CommandDefinition> 
```

```
function CreateNewAccount (prmRecordGUID) {
    //prmRecordGUID will recieve all GUIDS in comma seperated i.e. GUID1,GUID2,GUID3
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:38:22.210

是的，这应该很简单——我不认为你在评论中所说的会起作用——你试图使用的那个功能只有在记录的形式是打开的情况下才有效，例如它不会从网格视图中工作。

您必须使用此处 MSDN 中所述的 Web 服务调用：http: [//msdn.microsoft.com/en-us/library/hh771584#BKMK_DataAccessUsingJavaScript](http://msdn.microsoft.com/en-us/library/hh771584#BKMK_DataAccessUsingJavaScript)

此外，如果您正在自定义功能区（添加按钮），您会发现使用此工具更容易：http: [//www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx](http://www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx)

# c# - 如何找到嵌套太深的文件？

> ID：11939074
> 
> 赞同：0
> 
> 时间：2012-08-13T17:12:35.367
> 
> 标签：c#, winforms, linq, directory

我有一个父文件夹，其中包含多个名为 Project-* 的文件夹（文件夹编号为 Project-1、Project-15、Project-253 等）。每个文件夹中都有一个 zip 文件，其名称始终为“project.zip”。这意味着当文件夹结构正确时，它应该始终是 TopFolder\Project-*\project.zip。

我正在尝试编写一个查看每个 Project-* 文件夹的程序，以查看 project.zip 文件是否嵌套在另一个文件夹中（例如：Project-*\newfolder\project.zip）

我有一些代码可以查找名为 Project-* 的文件夹，并在它们有子目录时列出它们，但它似乎将我的 project.zip 文件视为文件夹，因此它将所有内容显示为具有子目录。

```
 DirectoryInfo directory = new DirectoryInfo(txtbxOldFolder.Text);
            DirectoryInfo[] folders = directory.GetDirectories("*Project-*", SearchOption.AllDirectories);

            //finds folders nested in the folder
            var query = from folder in folders
                        where folder.GetFileSystemInfos().Length > 0 
                        select folder.FullName.ToString();
            foreach (string str in query)
            {
                //this adds the path of any Project-* folder with subdirectories
                listNestedFolder.Add(str);
            } 
```

如前所述，上面的代码确实找到了任何带有子目录的 Project-* 文件夹，但它也找到了 Project-*\project.zip 中的任何文件夹。如何让它停止将 zip 文件识别为目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:14:33.077

`GetFileSystemInfos()`返回文件和文件夹。
你可能想打电话给`GetDirectories()`.

为了获得更好的性能，您可以编写`where folder.EnumerateDirectories().Any()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T06:15:36.750

您可以尝试此逻辑来搜索嵌套文件或子目录结构中的任何其他差异：

```
 string topfolder = @"c:\temp\utils\";
        string filename = "project.zip";

        foreach (string dir in Directory.GetDirectories(topfolder, "Project-*", SearchOption.TopDirectoryOnly))
        {
            IEnumerable<string> files = Directory.GetFiles(dir, "*.*", SearchOption.TopDirectoryOnly).Select(f => Path.GetFileName(f));
            if (files.Count() > 1)
            #region if directory contains extra (unexpected) files
            {
                Console.WriteLine(string.Format("Directory {0} contains {1} files", dir, files.Count()));
            }
            #endregion if directory contains extra (unexpected) files

            if (!files.Contains(filename))
            {
                Console.WriteLine(string.Format("File is not found in {0}", dir));

                #region Searching for the file in depth

                files = Directory.GetFiles(dir, filename, SearchOption.AllDirectories);
                if (files.Count() > 0)
                {
                    Console.WriteLine("The file has been found too deep:");
                    foreach (string s in files)
                        Console.WriteLine(s);
                }

                #endregion Searching for the file in depth
            }

            #region Searching for extra (unexpected) subdirectories

            int dircount = Directory.GetDirectories(dir, "*.*", SearchOption.TopDirectoryOnly).Length;
            if (dircount > 0)
                Console.WriteLine(string.Format("Directory {0} contains {1} subdirectories", dir, dircount));

            #endregion Searching for extra (unexpected) subdirectories
        }

        Console.ReadLine(); 
```

# java - 创建 Facebook 应用程序 [新手]

> ID：11939077
> 
> 赞同：-4
> 
> 时间：2012-08-13T17:12:39.173
> 
> 标签：java, facebook, facebook-apps, facebook-app-requests

我对这个领域有点陌生。我即将创建一个 facebook 应用程序，但我不知道该怎么做。我需要一些应用程序的 tut 和代码。如果您能帮助我，我将不胜感激。:) 这就是我想要的。

*   一个照片上传应用程序，任何人都可以通过简单地单击“上传到 Facebook”按钮来授予应用程序权限并将照片从另一个网站上传到 Facebook。

*   该应用程序必须在用户上传第一张照片时在 Facebook 上自动创建一个新相册，相册名称和描述由应用程序管理员决定。

*   每张照片标题都必须自动编辑为“原始标题+文字由应用管理员决定”

就这样。我想你明白我的意思和我要做什么。:) 有人请帮帮我.......!!!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:27:50.987

从头开始，即阅读 FB 的入门教程。

[https://developers.facebook.com/docs/](https://developers.facebook.com/docs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:08:37.480

试试 Spring Social Library。它支持 FB Twitter Linked In 等。这很容易实现。

# iphone - UIView 动画泄漏

> ID：11939078
> 
> 赞同：0
> 
> 时间：2012-08-13T17:12:43.447
> 
> 标签：iphone, ios, animation, uiview, ipa

在我的视图控制器中，我使用动画来更改 UIButton 和 UIView 的框架，从纵向到横向用户可以看到视图在增长，但问题是动画到处泄漏并显示来自不同方面的所有内容。

这是代码

```
[UIView beginAnimations:Nil context:Nil];
[UIView setanimationDuration:1];
[view1 setFrame:CGRectMake(100,100,200,300)];
[UIView commitAnimations]; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:21:28.563

请详细说明“到处泄漏”的含义，如果您使用块动画会有所不同：

```
[UIView animateWithDuration:1.0 delay:0.0 options:nil animations:^{
    [view1 setFrame:CGRectMake(100,100,200,300)];
}completion:^(BOOL done){
    if (done) {
        NSLog(@"animation complete");
    }
}]; 
```

根据苹果的文档：

> 在 iOS 4 及更高版本中，使用基于块的动画方法。（推荐的）

# excel - 将图表导出为图像 - 单击按钮

> ID：11939087
> 
> 赞同：11
> 
> 时间：2012-08-13T17:13:19.860
> 
> 标签：excel, vba

我正在尝试创建一个按钮，它将“Graphs”表中的图表导出为 jpeg 文件。这是我的代码，但是它一直显示此错误：

> 运行时错误 424：需要对象

专门为此：

```
Set myChart = Graphs.ChartObjects(3).Name = "Chart4" 
```

这是代码

```
Sub ExportChart()
    Dim myChart As Chart
    Dim myFileName As String
    Set myChart = Graphs.ChartObjects(3).Name = "Chart4"
    myFileName = "myChart.jpg"
    On Error Resume Next
    Kill ThisWorkbook.Path & "\" & myFileName
    myChart.Export Filename:=ThisWorkbook.Path & "\" & myFileName, Filtername:="PNG"
    MsgBox "OK"
    Set myChart = Nothing
End Sub 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-13T17:25:19.250

这是你正在尝试的吗？

另外，如果您尝试将其保存为 jpg，那么为什么要使用 png 过滤器？我已将“myChart.jpg”更改为“myChart.png”。根据需要进行更改。

```
Sub ExportChart()
    Dim objChrt As ChartObject
    Dim myChart As Chart

    Set objChrt = Sheets("Graphs").ChartObjects(3)
    Set myChart = objChrt.Chart

    myFileName = "myChart.png"

    On Error Resume Next
    Kill ThisWorkbook.Path & "\" & myFileName
    On Error GoTo 0

    myChart.Export Filename:=ThisWorkbook.Path & "\" & myFileName, Filtername:="PNG"

    MsgBox "OK"
End Sub 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-11-29T15:42:48.653

谢谢，我需要这个来提取图像中的所有图表，现在快午夜了。对上面的代码进行微小的更改就可以了。

```
Sub ExportChart()
    Dim WS As Excel.Worksheet
    Dim SaveToDirectory As String

    Dim objChrt As ChartObject
    Dim myChart As Chart

    SaveToDirectory = ActiveWorkbook.Path & "\"

    For Each WS In ActiveWorkbook.Worksheets
        WS.Activate 'go there
        For Each objChrt In WS.ChartObjects
            objChrt.Activate
            Set myChart = objChrt.Chart

            myFileName = SaveToDirectory & WS.Name & "_" & objChrt.Index & ".png"

            On Error Resume Next
            Kill SaveToDirectory & WS.Name & Index & ".png"
            On Error GoTo 0

            myChart.Export Filename:=myFileName, Filtername:="PNG"
        Next
    Next

    MsgBox "OK"
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-18T15:06:10.157

根据@Miles 和@Siddarth Rout 给出的示例，我刚刚创建了这个变体。需要注意的是，这是针对跟踪用户反馈的应用程序的后端，需要以不同的方式针对各种受众进行细分。当我们等待开发人员构建应用程序的报告端时，我正在以 .csv 格式从 SQL 下载数据，然后在 Excel 中处理其中的废话，然后提供***27***个单独的图表和图形（*即将成为 28如果我们能让最终的用户组上线！*）

我浏览并命名了每个图表，我需要调用结果文件，这样我就可以将图形上传到应用服务器，覆盖前一周的图表，自动（对于最终用户）更新报告。

[![在 Excel 中重命名图形对象](../Images/75722f2c4208769ab1d43f9ab2a1877e.png)](https://i.stack.imgur.com/rENsk.png)

由于文件名需要保持完全相同，命名图表最有意义，所以我再也不需要触及那部分了。（*直到今天这样做，我一直在复制每个图表，粘贴到 Paint，然后另存为 PNG，并保存前一周的文件，这样我就可以点击旧的，它会自动将该名称分配给另存为过程。找到上面的代码和一种使它更流畅的方法将每周为我节省大约 30 分钟并消除 27 个可能的手动错误......相当不错的投资！如果我能做到......一年前？*）

```
' Ctrl-Shift-A to run

Sub ExportChart()
Dim WS As Excel.Worksheet
Dim SaveToDirectory As String

Dim objChrt As ChartObject
Dim myChart As Chart

SaveToDirectory = ActiveWorkbook.Path & "\"

For Each WS In ActiveWorkbook.Worksheets
    WS.Activate 'go there
    For Each objChrt In WS.ChartObjects
        objChrt.Activate
        Set myChart = objChrt.Chart

        ' Change from above: using ChartObject.Name to individually name each exported PNG file
        myFileName = SaveToDirectory & objChrt.Name & ".png" 

        On Error Resume Next
        Kill SaveToDirectory & WS.Name & Index & ".png"
        On Error GoTo 0

        myChart.Export Filename:=myFileName, Filtername:="PNG"
    Next
Next

MsgBox "Eeeaaagle!!"
End Sub 
```

# cassandra - 二级索引列上的 CQL 和范围

> ID：11939093
> 
> 赞同：8
> 
> 时间：2012-08-13T17:13:40.857
> 
> 标签：cassandra, cql

下面的 CQL 查询导致错误提示

> 具有等于​​运算符的 by-columns 子句中不存在索引列

请注意，该列`age`已被二级索引。

```
select * from employee where age > 25 
```

但是我有另一个二级索引列`type`。所以当我用那个...

```
select * from employee where type='engineer' and age > 25 
```

我似乎得到了正确的结果。

这是怎么发生的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-13T20:56:29.887

Cassandra 的内置二级索引更像是散列式索引，而不是 B 树。

因此，**至少需要一个相等比较才能**有效地执行查找（任何附加的列谓词都会导致相等匹配的后期过滤）。

尝试以下 wiki 页面，了解有关 Cassandra 二级索引的问题的一个不错的起点：[http ://wiki.apache.org/cassandra/SecondaryIndexes](http://wiki.apache.org/cassandra/SecondaryIndexes)

# ms-access - SQL 计数非连续日期

> ID：11939095
> 
> 赞同：1
> 
> 时间：2012-08-13T17:13:44.460
> 
> 标签：ms-access, count

这是数据：

```
empID Date     Type
----- -------- ----
    1 1/1/2012  u
    1 1/2/2012  u
    1 1/3/2012  u
    1 2/2/2012  u
    4 1/1/2012  u
    4 1/3/2012  u
    4 1/4/2012  u
    4 1/6/2012  u 
```

将返回：

```
empID count
----- -----
    1     2
    4     3 
```

当两个日期“在一起”时，它们算作一次出现，如果日期分开，它们算作两次出现。这是为了跟踪员工出勤率...... SQL 语句如何按“一起”日期分组并将它们计为 1......我真的在逻辑上苦苦挣扎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:32:54.347

```
SELECT 
    empID
  , COUNT(*) AS cnt
FROM 
    tableX AS x
WHERE
    NOT EXISTS
        ( SELECT *
          FROM tableX AS y
          WHERE y.empID = x.empID
            AND DATEADD ("d", -1, x.[Date]) = y.[Date]
        )
GROUP BY
    empID ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:10:14.240

试试这个：

```
;WITH CTE as
(select *,ROW_NUMBER() over (partition by empID order by date) as rn from test2 t1)

select empID,COUNT(*) as count
from CTE c1
where isnull((DATEDIFF(day,(select date from CTE where c1.rn=rn+1 and empID=c1.empID ),c1.date)),0) <> 1
group by empID 
```

# sql - 在实体框架中的 SQL 视图上使用外键

> ID：11939100
> 
> 赞同：3
> 
> 时间：2012-08-13T17:14:05.803
> 
> 标签：sql, entity-framework, sql-view

我对实体框架比较陌生。

我创建了一个包含两个表的数据库：`Accounts`和`Assignments`.

`Accounts`有一个`AccountId`主键，用作`Properties`表中的外键。我真的很喜欢 Entity Framework 自动获取外键关系并允许我`Assignments`从`Accounts`.

我继续创建了一个新的 View 对象，该对象返回所有列`Accounts`以及其他一些信息。但是，当我使用实体框架从 SQL 视图中获取数据时，它不再自动引用`Assignments`表中的关联行。

如何使用带有实体框架的视图获得所需的行为

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:16:36.820

这可以在 EF 中工作，但是 EF 设计器无法从视图中推断出您的 FK，因为数据库不会告诉它视图列上的 FK 在哪里（因为它们自然位于基础表上，而不是视图上本身）。

您需要[通过设计器或 XML 手动编辑您的 EDMX，以获取这些属性](https://stackoverflow.com/questions/4465855/entity-framework-add-navigation-property-manually)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-25T11:59:37.410

对我有用的解决方案是在视图中包含适当的数据，这样我就不需要使用 FK。

例如，通过将适当的 SQL 添加到视图中，将分配表的 PK 包含在视图中。

这样我就可以加入 LINQ 中的视图，而无需引用 EDMX 中生成的属性。

# linux - 将 preempt_notifier 附加到 linux 中的用户进程

> ID：11939104
> 
> 赞同：1
> 
> 时间：2012-08-13T17:14:25.723
> 
> 标签：linux, linux-kernel, preemption

我需要确定用户进程是否曾经以某种方式被抢占，我知道我们在 preempt.h 和 sched.c 中有钩子，它们允许我们定义 preempt_notifiers，每当进程被重新调度或抢占时，它们又可以调用 sched_in 和 sched_out 函数。

但是我仍然不知道如何将通知程序附加到用户空间中的特定进程或 pid，然后以某种方式记录该特定进程是否曾被抢占。我假设我必须编写一个模块才能做到这一点，但是我将如何将 pid 附加到特定的通知程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T07:09:40.550

通知程序本质上是每个进程的。当您注册它时，您正在为当前进程注册它。请参阅 中的代码`preempt_notifier_register()`，它将通知程序附加到`current->preempt_notifiers`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T07:25:22.367

伪文件`/proc/<pid>/status`包含一行`nonvoluntary_ctxt_switches:`似乎是您所追求的信息。

# php - gmail 聊天如何在没有长轮询的情况下向用户发送数据？

> ID：11939112
> 
> 赞同：1
> 
> 时间：2012-08-13T17:14:58.970
> 
> 标签：php, javascript, ajax, long-polling, polling

一段时间以来，我一直在摆弄一个聊天程序。

使用 AJAX 进行轮询已经成功，但是它每秒向服务器发送一个请求，这对我来说似乎太贵了，更不用说每 1000ms 一次很慢。

长轮询不成功。我发现我可以在我的服务器 (Apache) 上执行长轮询请求，但是如果我正在运行长轮询请求，则网页的其余部分将呈现为“死”。我无法单击文本框或键入或whathaveyou。

我现在知道这是因为 Apache 对长轮询请求使用多个线程，因此与其他服务器类型不同，它会消耗大量资源。

我的问题：

1.如何在没有长轮询的情况下创建相同的“即时消息功能”（或者如何在 Apache 上成功地进行长轮询？）。我只需要

`When (someone sends a message and thus a file on server changes) {send data to all users;},`应该很容易吧？

我注意到 facebook 为客户端（在 Firebug 中）进行长轮询，但 Gmail 聊天显然没有，但具有相同的功能？！

2.gmail聊天是怎么做的？

我已经阅读了关于 Comet的[wiki和](http://en.wikipedia.org/wiki/Comet_%28programming%29)[这篇文章](http://www.ekhoury.com/blog/2007/02/07/ajax-alternatives-gmail-choice/)，并观看了一个内容丰富的[视频](http://www.infoq.com/presentations/Comet-DWR-Joe-Walker)，演讲者说这可以用 PHP/JS 完成，并且对 IDEA 有很好的理解，我只想要代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:59:37.703

我找到了一个长轮询 PHP 和 Apache 可行的解决方案。这是一种魅力。

[http://www.zeitoun.net/articles/comet_and_php/start](http://www.zeitoun.net/articles/comet_and_php/start)

我所要做的就是`set_time_limit(0);`在 backend.php 中，一切都应该是这样。

# macos - 如何使用applescript通过扩展名将文件移动到新文件夹，保留子文件夹名称

> ID：11939117
> 
> 赞同：1
> 
> 时间：2012-08-13T17:15:24.350
> 
> 标签：macos, applescript, automator

这就是我想要做的。

我有一个文件结构，其中包含 JPG 和 RAW 格式的照片。这是一个名为“照片”的文件夹，其中包含按日期划分的子文件夹。我只想将 RAW 照片复制到一个新文件夹“Photos RAW”，但按拍摄/创建日期保留结构。

我可以使用 automator 或 applescript 仅将文件复制到一个新目录，但是如何使用 applescript 遍历目录树以便覆盖所有子文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T21:40:19.170

尝试这个。您会看到我也使用“全部内容”来获取子文件夹中的文件。

```
set extensionToFind to "raw"

set topLevelFolder to (choose folder) as text
set pathCount to count of topLevelFolder

tell application "Finder"
    -- get the files
    set rawFiles to files of entire contents of folder topLevelFolder whose name extension is extensionToFind
    if rawFiles is {} then return

    -- setup the folder where the files will be moved
    set rawFolder to ((container of folder topLevelFolder) as text) & "Photos_Raw:"
    do shell script "mkdir -p " & quoted form of POSIX path of rawFolder

    repeat with aFile in rawFiles
        set aFileContainer to (container of aFile) as text
        if topLevelFolder is equal to aFileContainer then
            -- here the file is at the top level folder
            set newPath to rawFolder
        else
            -- here we calculate the new path and make sure the folder structure is in place
            set thisFile to aFile as text
            set subFolderPath to text (pathCount + 1) thru -((count of (get name of aFile)) + 1) of thisFile
            set newPath to rawFolder & subFolderPath
            do shell script "mkdir -p " & quoted form of POSIX path of newPath
        end if

        move aFile to folder newPath
    end repeat
end tell 
```

# sql - 仅从 LEFT JOIN 获得第一个结果

> ID：11939123
> 
> 赞同：1
> 
> 时间：2012-08-13T17:16:06.910
> 
> 标签：sql, sql-server, sql-server-2008, group-by, left-join

我正在尝试为语句`LEFT JOIN`的每一行获取 a 的第一个结果。`SELECT`

因为现在，如果我在连接表中有 100 行，我将从`SELECT`. 我只需要第一个加入的行，这样我就不会得到任何重复。

我不能使用`GROUP BY`，因为我必须从表中获取不止一行。

这是我的查询的基本版本：

```
SELECT bg.PatientID, DATEDIFF(hour, bg.CreateDate, GETDATE()) TimeToTarget 
FROM BloodGlucose bg
    LEFT JOIN IVProtocol i ON i.PatientID = bg.PatientID
WHERE bg.BGValue >= i.TargetLow AND bg.BGValue <= i.TargetHigh
ORDER BY bg.PatientID ASC 
```

我尝试使用`DISTINCT`，但由于来自的数据`bg.CreateDate`并不总是相同，它返回重复项。

我只需要左连接表的第一行。

有什么想法/建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:20:37.100

```
;WITH x AS 
(
  SELECT 
    bg.PatientID, 
    TimeToTarget = DATEDIFF(hour, bg.CreateDate, GETDATE()),
    rn = ROW_NUMBER() OVER (PARTITION BY bg.PatientID ORDER BY bg.CreatedDate DESC) 
  FROM dbo.BloodGlucose AS bg
  LEFT JOIN dbo.IVProtocol AS i 
  ON i.PatientID = bg.PatientID
  WHERE bg.BGValue >= i.TargetLow 
  AND bg.BGValue <= i.TargetHigh
)
SELECT PatientID, TimeToTarget
FROM x
WHERE rn = 1
ORDER BY PatientID; 
```

加入其他结果：

```
;WITH x AS 
(
  ... same as above ...
)
SELECT x.PatientID, x.TimeToTarget, y.Something
 FROM x INNER JOIN dbo.SomethingElse AS y
 ON x.PatientID = y.PatientID
 WHERE x.rn = 1
 ORDER BY x.PatientID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:18:08.857

```
SELECT bg.PatientID, DATEDIFF(hour, bg.CreateDate, GETDATE()) TimeToTarget 
FROM BloodGlucose bg
cross apply (
 select top 1 *
 from IVProtocol i
 where i.PatientID = bg.PatientID
 order by SOME_CRITERA
) i
WHERE bg.BGValue >= i.TargetLow AND bg.BGValue <= i.TargetHigh
ORDER BY bg.PatientID ASC 
```

对于这种情况，交叉应用是一个方便的工具。它的工作方式类似于连接，但您可以在子查询中使用变量。

# javascript - 从javascript调用Rails控制器/动作提交表单？

> ID：11939124
> 
> 赞同：0
> 
> 时间：2012-08-13T17:16:14.227
> 
> 标签：javascript, ruby-on-rails

在我看来，这是我的导轨形式

```
<%= form_tag :action=> "valider" do %>
....
<%= submit_tag  "Valider", {:class => 'bouton', :onclick=>"valider_form()"} %>
...<% end %> 
```

它调用 valider_form javascript 函数，然后调用控制器的验证器操作将数据存储在数据库中。

当用户以非空表单离开页面时，我们建议存储他的数据，并且我们想要调用 valider_form() javascript 函数和控制器的验证器操作。我们使用 OnUnload javascript 事件，很容易调用 valider_form() javascript 函数。但是，我们不知道如何在 javascript 中调用验证器操作，或者模拟这个 post 事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:07:08.183

在我的表单中添加一个 id ：

```
<%= form_tag  '/mon_equipe/valider', :id=>'equipe' do %> 
```

在我的 javascript OnUnload 事件中：

```
valider_form();
var form = document.getElementById("equipe");
form.submit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T20:28:56.210

试试这个：

```
<%= form_tag url_for(:controller => 'controller_name', :action => :valider),
:remote => true do %>
    ...
<% end %> 
```

该`:remote => true`选项使 Rails 使用 AJAX 动态提交请求，调用控制器`:valider`中的方法。`'controller_name'`

# licensing - 移植的 GPL 库也应该在 GPL 下？

> ID：11939125
> 
> 赞同：3
> 
> 时间：2012-08-13T17:16:35.617
> 
> 标签：licensing, gpl, porting

我对以下情况感兴趣：

1.  有用一种编程语言编写的 GPL 库。
2.  我想从头开始将库的一部分移植到另一种编程语言。

在这种情况下，我是否也应该在 GPL 下发布软件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T12:31:28.190

是的，因为在您写作时，您将（移植）（部分）作品翻译成另一种语言。

您可以自由地这样做，但必须遵守 GPL 许可的条款。

GPL 许可证是 copyleft 许可证，因此修改后的作品（翻译、移植）需要在相同的使用条件下传递，以保持软件的自由。

移植或翻译软件可以比作翻译一本书。原作者的版权仍然适用于翻译。

另请考虑，如果您只需要移植软件即可删除这些使用条款，那么您可以轻松地将软件移植到另一种语言，然后再次将其移植到另一种可能与原始语言相同的语言。

请记住，这不是法律建议，而只是我作为外行的看法。

# .net - 范围数据注释属性不验证 .99？

> ID：11939127
> 
> 赞同：3
> 
> 时间：2012-08-13T17:16:46.317
> 
> 标签：.net, asp.net-mvc-3, range, data-annotations

我已经`Range(decimal, decimal,...)`在模型中申请了我的财产。它不验证`.99`，但验证`0.99`。

如何让前导零？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T16:35:08.030

这是 ASP.NET MVC 3 默认附带的数字正则表达式`jquery.validate.js`和`jquery.validate.min.js`文件中的一个错误。

这是来自`jquery.validate.js`第 1048 行的代码：

```
// http://docs.jquery.com/Plugins/Validation/Methods/number
number: function(value, element) {
    return this.optional(element) || /^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value);
} 
```

此函数针对数字正则表达式执行字符串测试。要修复它，请将正则表达式替换为以下内容：`/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/`.

这是一个简短的版本。现在解释一下：

错误的正`^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$`则表达式读取为：

```
^-?
  Beginning of line or string
  -, zero or one repetitions
Match expression but don't capture it. [\d+|\d{1,3}(?:,\d{3})+]
  Select from 2 alternatives
      Any digit, one or more repetitions
      \d{1,3}(?:,\d{3})+
          Any digit, between 1 and 3 repetitions
          Match expression but don't capture it. [,\d{3}], one or more repetitions
              ,\d{3}
                  ,
                  Any digit, exactly 3 repetitions
Match expression but don't capture it. [\.\d+], zero or one repetitions
  \.\d+
      Literal .
      Any digit, one or more repetitions
End of line or string 
```

如您所见，第二个捕获组`(?:\.\d+)?`允许`.XX`格式中的数字，但是在匹配时，首先`(?:\d+|\d{1,3}(?:,\d{3})+)`检查第一组并且验证失败，因为*必须*匹配第一组。

如果我们将参考[http://docs.jquery.com/Plugins/Validation/Methods/number](http://docs.jquery.com/Plugins/Validation/Methods/number)演示并检查他们的正则表达式以进行数字验证，它将如下所示`^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$`：这与 buggy one 相同，但现在第一个匹配组应该是`zero or one repetitions`或*可选*的。正则表达式中的这个附加`?`修复了错误。

**编辑**：这也适用于 MVC 4 默认模板。两个模板都使用 1.9.0 版本的插件。在 1.10.0 版本中，此问题已修复。从[变更日志](http://jquery.bassistance.de/validate/changelog.txt)：

*   修复了没有前导零的小数的正则表达式问题。添加了新方法测试。修复 #41

所以有时保持更新是个好主意。

# javascript - 在 javascript 中为初学者构建类

> ID：11939129
> 
> 赞同：1
> 
> 时间：2012-08-13T17:16:55.803
> 
> 标签：javascript, jquery, json, class

我精通javascript和jQuery。我以前从未建立过课程。也许一堂课甚至不是我要找的。

我有一个调用函数来启动叠加层，它被大量使用并包含一些参数。

```
function launchOverlay(method, content, width, closeBtn) {

    $("body").append('<div id="overlay-backdrop" style="display:none"></div>');

    $("#overlay-backdrop").css({
        width: $(document).width(),
        height:$(document).height()
    }).fadeIn();

    $("#overlay-backdrop").append('<div id="overlay-canvas-area"><div class="inner-canvas-area"></div><div>');

    if(typeof closeBtn == 'undefined'){
        $("#overlay-canvas-area").append('<div class="close-btn"><a class="close" onClick="closeOverlay()">Close</a></div>');
    }

    if (method == "load"){
        $("#overlay-canvas-area .inner-canvas-area").load(content);
    }if(method == "append"){
        $("#overlay-canvas-area .inner-canvas-area").append(content);
    }

    var canvasAreaWidth = width+($("#overlay-canvas-area").width());
    var canvasAreaHeight = $("#overlay-canvas-area").height();

    $("#overlay-canvas-area").animate({
        top:((($(document).height())-(canvasAreaHeight))/2),
        left: ((($(document).width())-(canvasAreaWidth))/2) 
    },700);

} 
```

我发现自己不断地修改它以满足我的需要，然后回到旧实例并修改函数调用。我还想将 json 作为该函数的设置传递。

第一个问题是，我要找的是课程吗？如果是这样，哪里是学习的好地方？

如果没有，我应该怎么做才能改进功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:22:53.143

当有一个包含一些数据的持久对象然后您希望随着时间的推移使用多种不同的方法对该数据进行操作时，一个类（或在 javascript 中“原型”实际上是更正确的术语）是合适的。

该类允许您巧妙地指定数据的存储方式以及对数据进行操作的方法。

如果您只有一个产生输出的操作并且可以接收各种不同的输入数据，那么您将不会真正从课程中受益。您只需要一个接受各种参数并根据传递给它的内容选择其操作的函数。

在javascript中，当一个函数有很多选项并且它们可能是可变的时，有时通常会传入一个选项对象，该对象包含指导函数操作的属性。然后，该函数可以检查存在哪些属性以及它们必须选择哪些值来选择它的行为方式。任何时候您想添加或修改参数，而不是继续添加越来越多的函数参数，使用选项对象可以让维护变得更简单。像这样的选项对象也可以更容易地传递，而不是单独传递每个参数。您还可以为选项对象创建一个默认状态，其中包含参数的所有默认值（如果它们没有被传递，它们的值应该是什么）。

选项对象的使用如下所示：

```
function doWhatever(mainData, options) {
    if (options.foo) {
        // do it one way
    } else {
        // do it the other way
    }
}

doWhatever(myData, {foo: true, output: "commas", fee: "whatever"}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:45:01.487

对于像实现这样的直接类，我喜欢这样：[http ://ejohn.org/blog/simple-class-instantiation/](http://ejohn.org/blog/simple-class-instantiation/)

但听起来你想创建一些用 jQuery 术语称为“小部件”的东西，它可以免费提供很多你想要的东西，还有更多： http: [//ajpiano.com/widgetfactory/#slide1](http://ajpiano.com/widgetfactory/#slide1) [http ://wiki.jqueryui.com/w/page/12138135/Widget%20factory](http://wiki.jqueryui.com/w/page/12138135/Widget%20factory) [http://bililite.com/blog/understanding-jquery-ui-widgets-a-tutorial/](http://bililite.com/blog/understanding-jquery-ui-widgets-a-tutorial/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:59:19.183

我同意其他人的观点，因为这个功能完全是没有状态的行为。您可能会考虑将该函数连同相关的 UI 帮助函数一起放入命名空间，但这完全是为了更好地组织和在多个页面上易于使用。

此外，您可以通过存储返回的[jQuery 对象](http://api.jquery.com/Types/#jQuery)[`append`](http://api.jquery.com/append/)并将它们重用于进一步调用来提高此函数的可读性和性能。

```
function launchOverlay(method, content, width, closeBtn) {
    var $overlay = $("body").append('<div id="overlay-backdrop" style="display:none"></div>');
    $overlay.css({
        width: $(document).width(),
        height:$(document).height()
    }).fadeIn();
    var $canvas = $overlay.append('<div id="overlay-canvas-area"><div class="inner-canvas-area"></div><div>');
    if (typeof closeBtn == 'undefined') {
        $canvas.append('<div class="close-btn"><a class="close" onClick="closeOverlay()">Close</a></div>');
    }
    if (method == "load") {
        $("#overlay-canvas-area .inner-canvas-area").load(content);
    }
    else if (method == "append") {
        $("#overlay-canvas-area .inner-canvas-area").append(content);
    }
    var canvasAreaWidth = width + $canvas.width();
    var canvasAreaHeight = $canvas.height();
    $canvas.animate({
        top: (($(document).height() - canvasAreaHeight) / 2),
        left: (($(document).width() - canvasAreaWidth) / 2)
    }, 700);
} 
```

请注意，我已将`var`声明保留为内联以匹配您的样式，但您应该知道[它们的声明被提升到 function 的顶部](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)。在这里没关系，但以后可能会在更复杂的功能中咬你。

# bing-api - 通过 js 将文本添加到 Bing 地图多边形

> ID：11939130
> 
> 赞同：0
> 
> 时间：2012-08-13T17:16:55.897
> 
> 标签：bing-api, bing-maps

我正在尝试使用 Bing maps v7 JS API 解决问题。我的问题是我需要一个自定义标注或气泡，其喙指向特定位置（纬度/经度），气泡部分包含 2-4 行描述该点的短文本。气泡部分应该是可移动的（以及其中的文本）。

我们的第一次尝试是使用图钉和信息框。这如所期望的那样起作用，但在美学上并不令人愉悦。它是在可以移动图钉并跟随信息框的地方创建的。移动图钉后标记其原始位置的唯一选择是将多段线从图钉尖端延伸到原始点。在查看地图时，这确实不直观，因为实际位置不在图钉处，而是在将图钉连接到原始位置的多段线的末端。此外，每个点都使用了 3 个不同的对象，这会影响地图的显示效果。

现在，或者，我创建了一个类似于标注的多边形，其气泡部分可以移动，同时保持喙指向所需位置（这也是一个要求）。我不知道如何在多边形内放置文本。用多边形移动这个文本将是下一个障碍，但我很确定一旦我弄清楚如何放置它，我就可以处理。文本需要是白色的，具有透明背景，这样它才能显示出来，并且多边形是一个。

在此应用程序中，将有 3-8 个这样的标注。并且每个气泡都可以重新定位，以便它们都适合屏幕视图。

如何使用 v7 JS API 在多边形内放置文本？

谢谢！

有任何想法吗

# jira - 关于 Jira 的个人估计准确性报告

> ID：11939132
> 
> 赞同：4
> 
> 时间：2012-08-13T17:17:09.860
> 
> 标签：jira, estimation

我想知道我对用户故事的估计有多准确。

我在 Jira + Greenhopper 中记录了我的时间，并查看了时间[跟踪报告](https://confluence.atlassian.com/display/JIRA/Time+Tracking+Report) ，但我不确定如何按个人用户过滤故事

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:38:14.990

[我通过创建一个使用Jira REST Client](https://studio.atlassian.com/wiki/display/JRJC/Home)连接到 Jira REST API 的简单应用程序来获得所需的所有统计信息。

编写 Jira 插件也是一种解决方案，但我认为要复杂得多。

# javascript - jQuery Slider/Carousel 在 DOM 之后更新内容

> ID：11939133
> 
> 赞同：0
> 
> 时间：2012-08-13T17:17:10.510
> 
> 标签：javascript, jquery

伙计们。

我已经搜索了一个 jquery 滑块/轮播插件，我可以在 DOM 就绪后更新您的内容，使用 AJAX 调用或类似的东西。任何人都知道一个可能的插件吗？在她准备好之后添加新的 jquery 幻灯片？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:26:03.897

JCarousel 处理得很好。请参阅此处的“动态内容加载”部分：http: [//sorgalla.com/projects/jcarousel/](http://sorgalla.com/projects/jcarousel/)

# css - 表单的下拉菜单背景

> ID：11939134
> 
> 赞同：0
> 
> 时间：2012-08-13T17:17:13.603
> 
> 标签：css, drop-down-menu, background

我在这里显示了一个下拉菜单[http://jsfiddle.net/aRzUM/3/](http://jsfiddle.net/aRzUM/3/)

问题是 supp 菜单寄存器的背景是灰色的，无法正常工作。你能告诉我我在这里做错了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:21:14.367

您需要重置`li`子菜单的高度。它继承了以下一组规则。

```
#header .auth-row ul li {
    display: block;
    float: left;
    height: 39px;
    list-style: none outside none;
} 
```

添加此规则以重置高度：

```
#header .auth-row ul li li {
  height:auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:27:36.673

从 中删除背景、边框和阴影规则`ul`并将其应用于`form`自身。

```
#btn-login form {
    background: #ddd url(img/gradient.png) repeat-x 0 0;
    border: solid 1px #b4b4b4;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    border-radius: 10px;
    -webkit-box-shadow: 0 1px 3px rgba(0,0,0, .3);
    -moz-box-shadow: 0 1px 3px rgba(0,0,0, .3);
    box-shadow: 0 1px 3px rgba(0,0,0, .3);   
} 
```

[**演示**](http://jsfiddle.net/cqpCu/)

​</p>

# node.js - 找不到 socket.io.js

> ID：11939136
> 
> 赞同：1
> 
> 时间：2012-08-13T17:17:20.903
> 
> 标签：node.js, socket.io

我正在制作一个使用 nodejs、mongodb、socket.io、express 和 mongoose 的网络应用程序。
浏览到本地主机时，我可以启动服务器并在浏览器中正确获取所需的 html 文件。
我遇到的问题是让我的 socket.io 工作。在我的服务器端一切正常：我在终端中得到“info - socket.io started”。

但是当我浏览我的浏览器时，我在浏览器控制台中得到了这个

```
 Failed to load resource: the server responded with a status of 404 (Not Found) 
    Uncaught ReferenceError: io is not defined 
```

这就是我连接到 socket.io.js 的方式

```
 <script src="/socket.io/socket.io.js"></script> 
```

我的地图结构如下所示：

```
 map
  -app.js
  -public
  --index.html

  -node_modules
  --socket.io
  --mongodb
  --express
  --jade
  --mongoose 
```

有谁知道我犯了什么错误？

（实际上和这里的问题一样：[Node.js socket.io.js not found or io not defined](https://stackoverflow.com/questions/10563080/node-js-socket-io-js-not-found-or-io-not-defined)）

提前致谢！

**编辑：** 我在服务器端的代码是这样的：

```
 var app= require('express').createServer();
    var io = require('socket.io').listen(app);
    var mongoose = require('mongoose');
    var db = mongoose.connect('mongodb://localhost/db');

    app.listen(3030);
    console.log("server started");

    app.get('/',function(req,res){
res.sendfile(__dirname + '/public/index.html');
    });

    io.sockets.on('connection',function(socket){    
    console.log("connection made");
    }); 
```

第一个日志记录在终端中（“服务器已启动”），但第二个日志（“建立连接”）没有被记录。所以没有建立联系。我认为这是因为我的客户端的“设置”错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:05:30.953

查看快速迁移指南 2->3 [https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)这样的 东西应该可以

```
 var express = require('express');
 var app = express();
 var http = require('http');
 var server = http.createServer(app);
 var io = require('socket.io').listen(server);
 var mongoose = require('mongoose');
 var db = mongoose.connect('mongodb://localhost/db');

 server.listen(3030);
 console.log("server started");

 app.get('/',function(req,res){
     res.sendfile(__dirname + '/public/index.html');
 });

 io.sockets.on('connection',function(socket){    
    console.log("connection made");
 }); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-12T10:10:57.233

```
var app = express();
app.set('port', process.env.PORT || 3000);

...

var server = http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
});

var io = socket.listen(server);
io.sockets.on('connection', function () {
  console.log('hello world im a hot socket');
}); 
```

# c++ - 这个 result_of 用法有什么问题？

> ID：11939137
> 
> 赞同：4
> 
> 时间：2012-08-13T17:17:23.040
> 
> 标签：c++, c++11, typetraits

```
auto lambda = [](){ return 7; };
std::result_of<decltype(lambda)()>::type val = lambda(); //  'val' : illegal use of type 'void' 
```

我得到错误：`'val' : illegal use of type 'void'`。为什么该类型会解析为 void？

我可能弄错了什么`result_of`得到我。我只想要我可以传递的任何东西的返回值 a `std::function`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:26:39.560

如果您的编译器无法编译它，请不要使用`std::result_of`：

```
decltype(lambda()) val = lambda(); 
```

这完全一样，它应该（嗯，可以）在 VC2010 中工作。

您也可以使用`auto`，尽管我认为这不是您想要的：

```
auto val = lambda(); 
```

**编辑**：由于您在函数的返回值中使用它，因此`decltype`上面显示的解决方案可以正常工作：

```
#include <type_traits>
#include <iomanip>
#include <iostream>

template<class Functor>
auto foo(const Functor &f) -> decltype(f()) {
    return f();
}

int main() {
    auto lambda = [](){ return 7; };
    auto val = foo(lambda);
    std::cout << std::boolalpha;
    std::cout << std::is_same<decltype(val), int>::value << std::endl;
} 
```

演示[在这里](http://liveworkspace.org/code/09c6179fd73f108e8bc5334b514d0a6a)。

# magento - Magento：如何将订单/付款信息添加到 Admin-BackEnd

> ID：11939139
> 
> 赞同：0
> 
> 时间：2012-08-13T17:17:29.870
> 
> 标签：magento

我已经能够将一个名为*银行名称*的自定义字段添加到保存到数据库中的信用卡支付选项中，但是我现在正试图在客户>管理客户>（选择一个客户）下的后端显示此类信息>订单>（选择一个订单），有一个名为支付信息的字段，它显示信用卡支付信息，这是我希望*银行名称*出现的地方。

我已经尝试编辑以下文件但没有成功。

app\design\adminhtml\default\default\template\payment\form\cc.phtml 和 ccsave.phtml 通过添加以下内容。

```
<div class="input-box">
        <label for="<?php echo $_code ?>_cc_bankname><?php echo Mage::helper('payment')->__('Bank Name') ?> <span class="required">*</span></label><br/>
        <input type="text" id="<?php echo $_code ?>_cc_bankname" name="payment[cc_bankname]" title="<?php echo Mage::helper('payment')->__('Bank Name') ?>" class="input-text validate-cc-number" value="<?php echo $this->getInfoData('cc_bankname')?>"/>
    </div> 
```

但这只会在为客户手动创建新订单时启用编辑属性的选项。

有谁知道应该编辑哪个文件以及如何编辑？我尝试在 add/design/adminhtml 和 mage 下编辑 cc.phtml 和 ccsave.phtml 文件，但没有运气。

忘了提我正在使用 Magento 1.7

：：：：：：：：：：：：：：：：编辑：：：：：：：：：：：：：：：：

在通过付款文件进一步搜索后，我发现有两个文件需要编辑，但我仍然需要一些帮助。

我通过向文件添加两个函数来编辑 \app\code\local\Mage\Payment\Block\Info\cc.phtml。

首先是公共功能

```
public function getCcBankname()
{   
    return $this->getInfo()->getCcBankname();
} 
```

然后是受保护的功能

```
if ($this->getInfo()->getCcBankname()) {
        $data[Mage::helper('payment')->__('Bank Name')] = $this->getInfo()->getCcBankname();
    } 
```

然后我通过添加此文件编辑了以下文件 \app\code\local\Mage\Payment\Block\Info\ccsave.phtml。

```
$transport = new Varien_Object(array(Mage::helper('payment')->__('Bank Name') => $info->getCcBankname(),)); 
```

现在，这种修改允许*银行名称*准确地出现在后端我想要的位置，但问题是它没有填充存储在数据库中的数据。

任何人都知道为什么它不从数据库中提取数据？

:::::::::::::::: 编辑#2 :::::::::::::::::

好吧，我所做的一切似乎都奏效了，但只有一个小问题。银行名称数据应设置在两个不同的表上。sales_flat_order_payment 和 sales_flat_quote_payment 但由于某种原因，数据仅保存在 sales_flat_quote_payment 上。我在 sales_flat_order_payment 上手动输入了数据，它起作用了，我能够在后端可视化银行名称。

现在我必须弄清楚如何在处理付款时将数据保存在 sales_flat_order_payment 上，以及为什么将其保存在 sales_flat_quote_payment 上而不是另一个上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:41:52.050

对于付款方式`ccsave`，请参阅“付款信息”部分

```
Customer > Manage Customer > (Select customer) > Orders > (Select Order) 
```

通常由模板创建

```
app/design/adminhtml/default/default/template/payment/info/default.phtml 
```

# asp.net - Datalist 或 Datagrid 显示看起来像表格的数据库行？

> ID：11939141
> 
> 赞同：1
> 
> 时间：2012-08-13T17:17:37.673
> 
> 标签：asp.net, sql, datagrid, datalist

我正在使用如下所示的 sql 表：

```
 ID Region Store        Sales
    1  MEX    Supermarket  10,000
    2  USA    Supermarket   5,000
    3  MEX    Club         10,000
    4  USA    Direct        1,000
    5  MEX    Direct        4,000
    6  USA    Club              0 
```

我有 8 个不同的区域选项（这里只有 2 个以使其更短）。此外，3 个商店选项，我想显示这样的信息：

```
 Store        MEX       USA
    Supermarket  10,000    5,000
    Club         10,000        0
    Direct        4,000    1,000 
```

所以，我不知道该选择什么来像表格一样显示信息以比较每个商店段中区域之间的销售额，这将是正确的 sql 来调用它们并在列中排序以使其看起来像表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:20:05.880

PIVOT 算子的好人选。检查这个[例子](http://blogs.msdn.com/b/spike/archive/2009/03/03/pivot-tables-in-sql-server-a-simple-sample.aspx)。

根据您的情况，试试这个。您可以添加除 MEX 和 USA 之外的其他列。

```
SELECT  *
FROM    ( SELECT    [Region] ,
                    [Store] ,
                    [Sales]
          FROM      [RegionSales]
        ) rs PIVOT ( SUM(Sales) FOR Region IN ( [MEX], [USA] ) ) AS SalesPerRegion 
```

# ios - Cocoa - 如何为 tableView 创建搜索字段？

> ID：11939145
> 
> 赞同：1
> 
> 时间：2012-08-13T17:17:46.737
> 
> 标签：ios, xcode, uitableview, cocoa-touch, search

我有一个包含多个结果的表格，现在我想创建一个自定义搜索字段（只是一个带有文本标签的框）。我希望表格结果立即与用户在搜索字段中键入的内容相匹配。

示例：我点击“AN”，表格结果为“Ana Fernandes”、“Ana Alicia”、“Ananás”等。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:24:28.457

您将拥有一个带有普通视图的 UIViewController（即 self.view）。添加 UISearhBar 作为 self.view 的子视图，并将其原点设置为 0,0。添加一个 UITableView 作为第二个子视图，并将其原点设置为 (0, searchBar.frame.size.height)。现在你有你想要的两个视图。将自己作为代理添加到搜索栏，并实现代理方法，以便在用户输入文本时查看搜索字符串是什么。然后，您将对您的表格视图大惊小怪，只显示您想要的单元格。

# svn - 从 Subversion 切换到 PVCS Serena

> ID：11939153
> 
> 赞同：0
> 
> 时间：2012-08-13T17:18:16.473
> 
> 标签：svn, pvcs, serena

我的公司已经使用 Subversion 很长时间了，现在我被告知我们将切换到 PVCS 并负责迁移。我找不到太多关于人们从 Subversion 切换到 PVCS 的信息，这主要是相反的方式。有人从 Subversion 切换到 PVCS 吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-02T11:29:10.473

对于商业 VCS，如果他们希望其他人使用他们的产品，供应商有责任支持迁移。你最好的办法是[问他们](http://www.serena.com/index.php/en/products/other-products/pvcs-vm/)。（也许当你的上级看到他们的服务账单时，他们会重新考虑......）

另一方面，[他们的问题和缺陷管理解决方案有一个 SVN 连接器](http://www.serena.com/index.php/en/solutions/app-dev-delivery/issue-defect-management/scm-connectors/)。也许这可以是一个替代交易。

# c - 快速排序特例 - 似乎是 K&R 的错误算法

> ID：11939162
> 
> 赞同：3
> 
> 时间：2012-08-13T17:19:04.243
> 
> 标签：c, quicksort

我在理解 K&R 的快速排序算法（没有指针的简化版本）时遇到问题。Dave Gamble here已经提供了详尽的解释[说明](https://stackoverflow.com/questions/1231254/kr-qsort-example-with-pointers-and-arrays-confusion)。但是我注意到，通过从一个稍微改变的字符串开始，我们可以在 for 循环的许多循环中获得没有交换。首先是代码：

```
void qsort(int v[], int left, int right)
{
    int i, last;

    void swap(int v[], int i, int j);

    if (left >= right) /* do nothing if array contains */
            return;         /* fewer than two elements */
    swap(v, left, (left + right)/2); /* move partition elem */
    last = left;                    /* to v[0] */
    for (i = left + 1; i <= right; i++) /* partition */
            if (v[i] < v[left])
                    swap(v, ++last, i);
    swap(v, left, last);                  /* restore partition elem */
    qsort(v, left, last-1);
    qsort(v, last+1, right);
} 
```

在我看来演练：

我们从 CADBE 开始；左=0；对=4；D 是支点，因此根据算法，我们将 D 与 C 交换获得 DACBE

最后=左=0

i = 1 if ( v [1](https://stackoverflow.com/questions/1231254/kr-qsort-example-with-pointers-and-arrays-confusion) < v[0] ) 这是真的，所以我们将 v [1](https://stackoverflow.com/questions/1231254/kr-qsort-example-with-pointers-and-arrays-confusion)（因为 last 在操作之前递增）与 v [1](https://stackoverflow.com/questions/1231254/kr-qsort-example-with-pointers-and-arrays-confusion)交换，所以没有任何变化，last = 1，仍然有 DACBE；

现在 i = 2 if ( v[2] < v[0] ) -> true 所以我们将 v[2] 与 v[2] 交换，没有任何改变；最后 = 2

现在 i = 3 if ( v[3] < v[0] ) -> true 所以我们用 v[3] 交换 v[3] 没有任何改变 AGAIN (!), last = 3

所以显然出了点问题，算法什么也没做。非常感谢您的意见。我一定是错的，作者比我好；D提前谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:29:25.773

循环从`left + 1`到*并包括* `right`。当 时`i=4`，测试失败并且`last`不会增加。

然后递归调用`BACDE`用`left=0,right=2`and排序`left=4,right=4`。`D`（当枢轴出现时这是正确的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:29:10.733

好吧，碰巧您的输入子数组`ACBE`已经被`D`(`ACB`小于`D`和`E`大于`D`) 分区，因此分区周期没有物理交换任何值也就不足为奇了。

实际上，说它“什么都不做”是不正确的。它不会在循环中重新排序任何内容，因为您的输入数据不需要额外的重新排序。但它仍然做一件事：它找到`last`表示较小元素结束和较大元素开始的值，即它`ACBE`分成`ACB`和`E`部分。循环以 结束`last == 3`，这是进一步递归步骤​​的分区点。

# android - 更改 BroadcastReceiver 中的输出音量以通知非流媒体首选项

> ID：11939164
> 
> 赞同：0
> 
> 时间：2012-08-13T17:19:13.960
> 
> 标签：android, notifications, broadcastreceiver, audio

WhatsApp 在后台运行时似乎总是以高音量通知我，并且我的一位联系人（具有自定义通知声音）出现。

我正在尝试创建类似的效果。我想控制通知的音量。

我在 Stack Overflow 上能找到的唯一例子就是[这个。](https://stackoverflow.com/questions/7337481/how-do-you-change-the-output-volume-of-a-sound)

这里的区别在于：

1.  我的上下文是`BroadcastReceiver`
2.  我不是在播放音乐，而是使用基于手机上可用的默认铃声列表的通知声音（类似于 WhatsApp）。

通知管理器基于`getSystemService(Context.NOTIFICATION_SERVICE)`因此通常可用于流式传输的某些方法似乎不可用。

任何人都可以阐明一些观点。代码：

```
public class OnAlarmReceiver extends BroadcastReceiver {
private static final int NOTIFY_ME_ID=1337;

private static final String TAG = "OnAlarmReceiver";

@Override
public void onReceive(Context ctxt, Intent intent) {    
    Bundle bundle = intent.getExtras();
    int itemId = bundle.getInt("itemId");
    String itemTitle = bundle.getString("itemTitle");
    int priority = bundle.getInt("priority");
    long listId = bundle.getLong("listId");
    String listTitle = bundle.getString("listTitle");

    Toast.makeText(ctxt, "itemId: " + Integer.toString(itemId), Toast.LENGTH_LONG).show();

    SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(ctxt);
    boolean useNotification=prefs.getBoolean("use_notification", true);

    if (useNotification) {
        NotificationManager mgr = (NotificationManager)ctxt.getSystemService(Context.NOTIFICATION_SERVICE);                                 
        Notification notification = new Notification();         
        if (priority == 1) { // Display red icon
            notification=new Notification(R.drawable.nuvola_apps_kwrite, itemTitle, System.currentTimeMillis());    
        } else { // Display blue icon
            notification=new Notification(R.drawable.nuvola_apps_package_editors, itemTitle, System.currentTimeMillis());               
        }           
        Intent itemEditor = new Intent(ctxt, EditItem.class);
        long lAlarmId = (long) (int) itemId;
        itemEditor.putExtra(DbAdapter.KEY_ITEMS_ITEM_ID, lAlarmId);
        itemEditor.putExtra("listId", listId);
        itemEditor.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        PendingIntent i=PendingIntent.getActivity(ctxt, 0, itemEditor, PendingIntent.FLAG_UPDATE_CURRENT);          
        notification.setLatestEventInfo(ctxt, listTitle, itemTitle, i);         
        String notifyPreference = prefs.getString("notification_sound", "DEFAULT_RINGTONE_URI");                        
        notification.sound = Uri.parse(notifyPreference);

        if (priority == 1) {
            notification.defaults |= Notification.DEFAULT_VIBRATE;
        }           
        mgr.notify(itemId + NOTIFY_ME_ID, notification);
    }
    else {
        Intent i=new Intent(ctxt, AlarmActivity.class);
        i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctxt.startActivity(i);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:57:07.517

嗯，你试过这个吗？（是的，它使用音频流，但它应该可以工作）

```
private AudioManager mAudioManager;
private Context ctxt;

mAudioManager = (AudioManager)ctxt.getSystemService(Context.AUDIO_SERVICE);

int streamVolume = mAudioManager.getStreamMaxVolume(AudioManager.STREAM_NOTIFICATION);

mAudioManager.setStreamVolume(AudioManager.STREAM_NOTIFICATION, streamVolume, 0); 
```

# php - 工厂的依赖注入

> ID：11939165
> 
> 赞同：1
> 
> 时间：2012-08-13T17:19:19.330
> 
> 标签：php, dependency-injection, factory

我一直在我的 PHP 应用程序中练习构造函数依赖注入。我不想在我的代码中乱扔对象创建，所以工厂来救援，或者至少我认为。

我开始用工厂连接组件，然后一些工厂开始使用其他工厂来获取依赖关系，太好了，将所有创建代码保存在一个地方。但是，一旦工厂开始相互使用（或在下面的代码中，本身），我遇到了循环依赖问题，这根本无法解决。例如，我的 MapperFactory 使用自己将映射器与其他映射器注入（它们需要彼此来构建完整的对象图“急切加载”）：

```
class MapperFactory
{   
    public function create($type)
    {
        switch (true) {
            case 'Item':
                $mapper = new ItemMapper(
                    $this->create('Field')  
                );               
                break;
            case 'Field':
                $mapper = new ItemMapper(
                    $this->create('Item')  
                );
                break;
            default:
                throw new Exception('Unknown mapper');
        }
        return $mapper;
    }

}

$mf = new MapperFactory();
$mf->create('Item'); 
```

它是一个简化的示例，但随着应用程序的开发，这是一个越来越普遍的问题。从 PHP（安装了 xdebug）返回的错误是：

```
Fatal error: Maximum function nesting level of '100' reached, aborting! 
```

完全理解 PHP 抱怨的原因（虽然 TBH 没有看到它）。

我的问题是，我是否完全错过了工厂的意义？我是否正确使用工厂？看起来不是，但除了循环依赖（非常重要）之外，工厂是一种优雅的解决方案，可以将所有构造/接线逻辑隐藏在主应用程序之外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:57:09.807

您可以尝试使用 setter 来注入依赖项。然后你会像这样创建两个映射器：

```
$itemMapper = new Mapper();
$fieldMapper = new Mapper();
$itemMapper->setRelatedMapper($fieldMapper);
$fieldMapper->setRelatedMapper($itemMapper); 
```

然后使用开关返回映射器。这应该在创建对象时摆脱循环依赖。

话虽如此，如果您将其作为一种 OR/M 操作来连接到数据库，您可能应该研究 Doctrine2 或 Propel 之类的东西，只是为了省去在已经尝试过的情况下发明轮子的麻烦经过测试的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:57:29.167

看起来`MapperFactory`' `create`方法会导致无限循环。

```
switch(true) {
  case 'Item' : // this will always be selected http://php.net/manual/en/language.types.type-juggling.php
    $mapper = new ItemMapper(
      $this->create('Field'); // Forces loop,
    ); 
```

如果 switch 正在寻找`TRUE`匹配，那么 case 操作必须是一个布尔值

```
switch(true) {
  case $type == 'Item' :
    // ...
    break;
  case $type == 'Field' :
    // ...
 } 
```

# php - 如何覆盖特征函数并从被覆盖的函数中调用它？

> ID：11939166
> 
> 赞同：428
> 
> 时间：2012-08-13T17:19:28.170
> 
> 标签：php, traits

设想：

```
trait A {
    function calc($v) {
        return $v+1;
    }
}

class MyClass {
    use A;

    function calc($v) {
        $v++;
        return A::calc($v);
    }
}

print (new MyClass())->calc(2); // should print 4 
```

这段代码不起作用，我找不到像继承一样调用特征函数的方法。我尝试调用`self::calc($v)`, `static::calc($v)`,`parent::calc($v)`和`A::calc($v)`以下内容：

```
trait A {
    function calc($v) {
        return $v+1;
    }
}

class MyClass {
    use A {
        calc as traitcalc;
    }

    function calc($v) {
        $v++;
        return traitcalc($v);
    }
} 
```

没有任何效果。

有没有办法让它工作或者我必须完全覆盖比这更复杂的特征函数:)

* * *

## 回答 #1

> 赞同：745
> 
> 时间：2012-08-13T17:30:31.810

你的最后一个几乎就在那里：

```
trait A {
    function calc($v) {
        return $v+1;
    }
}

class MyClass {
    use A {
        calc as protected traitcalc;
    }

    function calc($v) {
        $v++;
        return $this->traitcalc($v);
    }
} 
```

该特征不是一个类。您不能直接访问其成员。它基本上只是自动复制和粘贴...

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-06-08T13:00:32.423

如果类直接实现该方法，则不会使用特征版本。也许你在想的是：

```
trait A {
    function calc($v) {
        return $v+1;
    }
}

class MyClass {
    function calc($v) {
        return $v+2;
    }
}

class MyChildClass extends MyClass{
}

class MyTraitChildClass extends MyClass{
    use A;
}

print (new MyChildClass())->calc(2); // will print 4

print (new MyTraitChildClass())->calc(2); // will print 3 
```

因为子类不直接实现该方法，所以如果有其他使用父类的方法，它们将首先使用特征的方法。

如果您愿意，该特征可以使用父类中的方法（假设您知道该方法会存在）例如

```
trait A {
    function calc($v) {
        return parent::calc($v*3);
    }
}
// .... other code from above
print (new MyTraitChildClass())->calc(2); // will print 8 (2*3 + 2) 
```

您还可以提供覆盖的方法，但仍按如下方式访问 trait 方法：

```
trait A {
    function trait_calc($v) {
        return $v*3;
    }
}

class MyClass {
    function calc($v) {
        return $v+2;
    }
}

class MyTraitChildClass extends MyClass{
    use A {
      A::trait_calc as calc;
    }
}

class MySecondTraitChildClass extends MyClass{
    use A {
      A::trait_calc as calc;
    }

    public function calc($v) {
      return $this->trait_calc($v)+.5;
    }
}

print (new MyTraitChildClass())->calc(2); // will print 6
echo "\n";
print (new MySecondTraitChildClass())->calc(2); // will print 6.5 
```

您可以在[http://sandbox.onlinephpfunctions.com/code/e53f6e8f9834aea5e038aec4766ac7e1c19cc2b5看到它的工作原理](http://sandbox.onlinephpfunctions.com/code/e53f6e8f9834aea5e038aec4766ac7e1c19cc2b5)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-06-08T05:04:18.393

如果有兴趣，另一种方法是使用额外的中间类来使用正常的 OOO 方式。这简化了与**parent::methodname的使用**

```
trait A {
    function calc($v) {
        return $v+1;
    }
}

// an intermediate class that just uses the trait
class IntClass {
    use A;
}

// an extended class from IntClass
class MyClass extends IntClass {
    function calc($v) {
        $v++;
        return parent::calc($v);
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-08-09T23:52:44.620

另一种变体：在 trait 中定义两个函数，一个执行实际任务的受保护函数，另一个调用受保护函数的公共函数。

如果他们想要覆盖函数，这只是让类不必弄乱'use'语句，因为他们仍然可以在内部调用受保护的函数。

```
trait A {
    protected function traitcalc($v) {
        return $v+1;
    }

    function calc($v) {
        return $this->traitcalc($v);
    }
}

class MyClass {
    use A;

    function calc($v) {
        $v++;
        return $this->traitcalc($v);
    }
}

class MyOtherClass {
    use A;
}

print (new MyClass())->calc(2); // will print 4

print (new MyOtherClass())->calc(2); // will print 3 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-20T22:27:04.923

使用另一个特征：

```
trait ATrait {
    function calc($v) {
        return $v+1;
    }
}

class A {
    use ATrait;
}

trait BTrait {
    function calc($v) {
        $v++;
        return parent::calc($v);
    }
}

class B extends A {
    use BTrait;
}

print (new B())->calc(2); // should print 4 
```

# javascript - 悬停外部图像时幻灯片中的图像褪色

> ID：11939168
> 
> 赞同：0
> 
> 时间：2012-08-13T17:19:41.607
> 
> 标签：javascript, jquery, jquery-animate, slideshow, fade

我已经创建了（在其他在线脚本的帮助下）一个幻灯片脚本，它可以在悬停时将其他图像变为灰度并同时暂停幻灯片。问题是，当我将鼠标悬停在其中一张不属于幻灯片的图像上时，我无法让它们褪色。我已经尝试了很多方法来解决这个问题，包括在现有图像上添加所需的灰度图像，但我无法让效果看起来相同，所以它有点毫无意义。

代码如下（如果它是一团糟，我很抱歉，我对 Javascript 还是很陌生）：

```
// Holds the alt description of an image
var desc;

// Used to try to solve problem
var bgimg;
var bgli;
var current;

$(document).ready(function () {
    //Execute the slideShow, set to 3 seconds for each images
slideShow(1000);
current = $('ul.slideshow li.show');
});

$(window).focus(function () {
    timer = setInterval('gallery()', speed);
});

$(window).blur(function () {
    clearInterval(timer);
});

function slideShow(speed) {
    //Set the opacity of all images to 0
    $('ul.slideshow li').css({opacity: 0.0});
    //Get the first image and display it (set it to full opacity)
    $('ul.slideshow li:first').css({opacity: 1.0}).addClass('show');
    //Call the gallery function to run the slideshow    
    var timer = setInterval('gallery()', speed);
    desc = $('ul.slideshow li.show').find('img').attr('alt');

    //pause the slideshow on mouse over
    $('img.color').hover(
    function () {
        clearInterval(timer);
        $('#caption').stop().animate({'height': '70px'}, 1000);
        cptxt(desc);
        if (this.id == "img6" || this.id == "img7" || this.id == "img8" || this.id == "img9" || this.id == "img10") {
            $(img1).stop().animate({"opacity": "0"}, "slow");
            $(img2).stop().animate({"opacity": "0"}, "slow");
            $(img3).stop().animate({"opacity": "0"}, "slow");
            $(img4).stop().animate({"opacity": "0"}, "slow");
            $(img5).stop().animate({"opacity": "0"}, "slow");
        }
    },
    function () {
        timer = setInterval('gallery()', speed);
        $(img1).stop().animate({"opacity": "1"}, "slow");
        $(img2).stop().animate({"opacity": "1"}, "slow");
        $(img3).stop().animate({"opacity": "1"}, "slow");
        $(img4).stop().animate({"opacity": "1"}, "slow");
        $(img5).stop().animate({"opacity": "1"}, "slow");
        $('#caption').stop().animate({'height': '0px'}, 1000);
        $('#caption').html('');
    });
}

function gallery() {
    //if no IMGs have the show class, grab the first image
    if ($('ul.slideshow li.show').length){
    // if we found an item with the show class, assign it to current
        current = $('ul.slideshow li.show');
    } else {
        // otherwise nothing is being shown, default to first element
        $('#ul.slideshow li:first');
    }

    //trying to avoid speed issue        
    if (current.queue('fx').length == 0) {
        //Get next image, if it reached the end of the slideshow, rotate it back to the first image
        var next;
        // if there are additional elements (true when .length > 0)
        if (current.next().length) { 
            next = current.next();
            if (next.attr('id') == 'dark') {
                bgli = next;
                bgimg = next.find('img'); 
                next = next.next();
            }
        } else {
            // there is no next element, go back to first.
            next = $('ul.slideshow li:first');
        }

        desc = next.find('img').attr('alt');
        //Set the fade in effect for the next image, show class has higher z-index
        next.css({opacity: 0.0}).addClass('show').animate({opacity: 1.0}, 1000);
        //Hide the current image
        current.animate({opacity: 0.0}, 1000).removeClass('show');
    }
}

function cptxt(altmsg) {
    $('#caption').html(altmsg);
}

$(document).ready(function(){
    $('img.color').hover(
    function() {
        if (this.id == "img1") {
            $(img2).stop().animate({"opacity": "0"}, "slow");
            $(img3).stop().animate({"opacity": "0"}, "slow");
            $(img4).stop().animate({"opacity": "0"}, "slow");
            $(img5).stop().animate({"opacity": "0"}, "slow");
            $(img6).stop().animate({"opacity": "0"}, "slow");       
            $(img7).stop().animate({"opacity": "0"}, "slow");
            $(img8).stop().animate({"opacity": "0"}, "slow");
            $(img9).stop().animate({"opacity": "0"}, "slow");
            $(img10).stop().animate({"opacity": "0"}, "slow");
        }
        else if (this.id == "img2") {
            $(img1).stop().animate({"opacity": "0"}, "slow");
            $(img3).stop().animate({"opacity": "0"}, "slow");
            $(img4).stop().animate({"opacity": "0"}, "slow");
            $(img5).stop().animate({"opacity": "0"}, "slow");
            $(img6).stop().animate({"opacity": "0"}, "slow");
            $(img7).stop().animate({"opacity": "0"}, "slow");
            $(img8).stop().animate({"opacity": "0"}, "slow");
            $(img9).stop().animate({"opacity": "0"}, "slow");
            $(img10).stop().animate({"opacity": "0"}, "slow");
        }
        else if (this.id == "img3") {
            $(img1).stop().animate({"opacity": "0"}, "slow");
            $(img2).stop().animate({"opacity": "0"}, "slow");
            $(img4).stop().animate({"opacity": "0"}, "slow");
            $(img5).stop().animate({"opacity": "0"}, "slow");
            $(img6).stop().animate({"opacity": "0"}, "slow");
            $(img7).stop().animate({"opacity": "0"}, "slow");
            $(img8).stop().animate({"opacity": "0"}, "slow");
            $(img9).stop().animate({"opacity": "0"}, "slow");
            $(img10).stop().animate({"opacity": "0"}, "slow");
        }
        else if (this.id == "img4") {
            $(img1).stop().animate({"opacity": "0"}, "slow");
            $(img2).stop().animate({"opacity": "0"}, "slow");
            $(img3).stop().animate({"opacity": "0"}, "slow");
            $(img5).stop().animate({"opacity": "0"}, "slow");
            $(img6).stop().animate({"opacity": "0"}, "slow");
            $(img7).stop().animate({"opacity": "0"}, "slow");
            $(img8).stop().animate({"opacity": "0"}, "slow");
            $(img9).stop().animate({"opacity": "0"}, "slow");
            $(img10).stop().animate({"opacity": "0"}, "slow");
        }
        else if (this.id == "img5") {
            $(img1).stop().animate({"opacity": "0"}, "slow");
            $(img2).stop().animate({"opacity": "0"}, "slow");
            $(img3).stop().animate({"opacity": "0"}, "slow");
            $(img4).stop().animate({"opacity": "0"}, "slow");
            $(img6).stop().animate({"opacity": "0"}, "slow");
            $(img7).stop().animate({"opacity": "0"}, "slow");
            $(img8).stop().animate({"opacity": "0"}, "slow");
            $(img9).stop().animate({"opacity": "0"}, "slow");
            $(img10).stop().animate({"opacity": "0"}, "slow");
        }
    },
    function() {
        $(img1).stop().animate({"opacity": "1"}, "slow");
        $(img2).stop().animate({"opacity": "1"}, "slow");
        $(img3).stop().animate({"opacity": "1"}, "slow");
        $(img4).stop().animate({"opacity": "1"}, "slow");
        $(img5).stop().animate({"opacity": "1"}, "slow");
        $(img6).stop().animate({"opacity": "1"}, "slow");
        $(img7).stop().animate({"opacity": "1"}, "slow");
        $(img8).stop().animate({"opacity": "1"}, "slow");
        $(img9).stop().animate({"opacity": "1"}, "slow");
        $(img10).stop().animate({"opacity": "1"}, "slow");
        }
    );
}); 
```

对不起，如果代码很糟糕：D。我花了几分钟试图正确地布置它，但很多都需要清理。

无论如何，重申一下，将鼠标悬停在幻灯片图像上可以正确地将其他图像转换为灰度。将鼠标悬停在其他图像上不会将当前幻灯片图像变为灰度。

任何帮助，将不胜感激。

根据要求，JSFiddle 链接 [http://jsfiddle.net/KXW4f/12/](http://jsfiddle.net/KXW4f/12/)

幻灯片似乎无法正常工作，但我可能在该站点上选择了一些错误的设置。无论如何，它在我的 PC 上运行时都可以工作，但我认为总体思路已显示。

目前，幻灯片图像只是淡出到白色背景（不透明度变为 0），但我想要的是灰度图像在淡出时出现。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T23:12:06.400

好的，有了这个例子，它就更容易理解了。不过，您的代码的概念有点混乱……；）

首先，更正代码的链接（现在应该可以使用）：http: [//jsfiddle.net/Aletheios/ZZHjS/2/](http://jsfiddle.net/Aletheios/ZZHjS/2/) **（新链接）**

我做了以下更改：

1.  声明了全局变量`timer`，`speed`并且`img1`-`img8`解决了几个错误。
2.  删除`slideShow()`了幻灯片开始，幻灯片开始了两次（`slideShow()`和`window.focus`）。
3.  为大灰度图像添加了显示/显示功能。该代码检测幻灯片中当前显示的图像，并在请求时显示其灰度对应图像。

这是代码（有关详细信息，请参阅 JSFiddle）：

```
$("img.color").hover(function(){
    var li;
    for (var i = 6; i <= 8; ++i) {
        li = $("#img"+i).closest("li");
        if (li.hasClass("show")) {
            li.next().css("opacity", 1);
        }
    }
    ...
}, function() {
    $(...).stop().animate({"opacity": "1"}, "slow", function(){
        $(this).closest("li").next().css("opacity", 0);
    });
}); 
```

一些注释：

1.  ID（例如在 HTML 标记中）仅在使用不超过一次时才有意义；）
2.  如果您将 jQuery 选择器组合在一起，您可以使您的代码更具可读性（并且可能更高效）。所以代替了`$(img1).animate()`又`$(img2).animate()`一个又一个更好的用途`$([img1, img2].join(",")).animate()`。

希望对您有所帮助... ;) 此外，如果您还没有使用它，我建议您使用 Firebug；它是调试 JS 代码的好工具。

# django - 使用 nginx（和 django）将接受语言标头映射到域

> ID：11939171
> 
> 赞同：1
> 
> 时间：2012-08-13T17:19:50.387
> 
> 标签：django, internationalization, nginx

我希望 nginx 根据请求的域设置适当的接受语言标头：

www.domain.ru 设置`ru-RU` www.domain.com 设置`en-US` www.domain.de 设置`de-DE`

www.domain.eu 什么都不做，让 Django 从浏览器获取标题。对于上面指定的 3 个域，即使英语用户输入 www.domain.ru（强制它使用俄语），也会强制更改接受语言标头。

这是我的 nginx 配置：

```
server {
listen 1.1.1.1;
server_name domain.eu www.domain.eu domain.de www.domain.de domain.com www.domain.com domain.ru www.domain.ru;
if($host ~* (.*)\.ru) {
set $http_accept_language 'ru-RU';
}
location / {
proxy_pass_header Server;
proxy_set_header Host $http_host;
proxy_redirect off;
proxy_set_header X-Forwarded-For  $remote_addr;
proxy_set_header X-Scheme $scheme;
proxy_connect_timeout 10;
proxy_read_timeout 10;
proxy_pass http://127.0.0.1:8888/;
}
} 
```

这是我配置的一部分（通过 gunicorn 运行 Django）。`accept-language`如果未设置会话语言，Django 会检查标头。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:18:39.160

尝试

```
if ($host ~* \.ru$) {
  set $language 'ru-RU';
}
add_header Accept-Language $language; 
```

使用 $http_.... 设置变量可能不是最好的主意，因为以 $http_ 开头的变量由 nginx 本身解释和设置（具体来说，您使用的名称将意味着“http 标头的内容”accept_language 见[http： //wiki.nginx.org/HttpCoreModule#Variables](http://wiki.nginx.org/HttpCoreModule#Variables)）。我不确定你的 set 或 nginx 是否会赢，但为什么要玩火呢？

# objective-c - 将 ATMHud 添加到 tabBarController.view 是否有意义

> ID：11939175
> 
> 赞同：0
> 
> 时间：2012-08-13T17:20:03.100
> 
> 标签：objective-c, ios, uitableview

当我尝试将 ATMHud 添加到 uitableviewcontroller 子视图时，它确实可以工作，但不会禁用滚动，如果 tableview 不在顶部，我就看不到 hud 视图。我所做的被添加到了 tabBarController.view 中，但我想知道这是否是一个好主意，或者稍后我可能会遇到问题。

另一个问题是tabBarController.view 框架是整个屏幕还是只是底部。atmhud 怎么会显示在屏幕中间？

提前致谢！

严

============ 找到一篇博文，说明如何在uitableviewcontroller中分别重置self.view和添加tableview

[UITableViewController 和固定子视图](http://herrray.com/uitableviewcontroller-and-fixed-sub-views/)

```
- (void)viewDidLoad {
    [super viewDidLoad];

    if (!tableView &&
        [self.view isKindOfClass:[UITableView class]]) {
            tableView = (UITableView *)self.view;
    }

    self.view = [[[UIView alloc] initWithFrame:
        [UIScreen mainScreen].applicationFrame] autorelease];
    self.tableView.frame = self.view.bounds;
    self.tableView.contentInset = UIEdgeInsetsMake(44.0, 0.0, 0.0, 0.0);
    [self.view addSubview:self.tableView];

    UIView *fixedBar = [[UIView alloc] initWithFrame:
        CGRectMake(0.0, 0.0, self.view.bounds.size.width, 44.0)];
    fixedBar.backgroundColor = [UIColor colorWithRed:
        0.0 green:1.0 blue:0.0 alpha:0.7];
    [self.view addSubview:fixedBar];
    [fixedBar release];                       
} 
```

在此之后，当将 hud 添加到 self.view 时，您将能够禁用底部的 tableview。让我知道这是否是设置表格视图的好方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:39:31.613

使用标签栏的问题是现在 hud 是模态的，用户无法更改标签。

听起来 tableview 不是您的主要视图，因为它可以被“掩盖”。如果它不是主视图，则将 ATMHud 添加到 self.view。如果 tableView 与 self.view 相同，则为其添加一个新的透明视图，然后将 HUD 添加到该视图。

tabBarController.view 是托管选项卡式视图的视图 - 如果您想查看其大小（或框架），请使用 NSStringFromCGRect(self.tabBarController.frame);

编辑：我刚刚做了一个测试，ATMHud 确实阻止了 UI。我能想到的只是你没有将它插入到你需要的地方（在当前视图的子视图的顶部）。我有一个演示项目，我这样做：

```
hud = [[ATMHud alloc] initWithDelegate:self];
[self.view addSubview:hud.view];
[hud setCaption:@"Howdie"];
[hud setActivity:YES];
[hud show];
[hud hideAfter:5]; 
```

hud 下方的按钮未激活 - 实际上视图中的任何内容均未激活（但导航栏可能会处于活动状态）

如果你想要一个 ARCified 和经过现场测试的版本，你可以[在这里获取](https://github.com/dhoerl/ATMHud)

EDIT2：您的问题的解决方案如下。请注意，ATMHud 会阻止点击进入表格，下面的代码会停止滚动：

```
- (void)hudWillAppear:(ATMHud *)_hud
{
    self.tableView.scrollEnabled = NO;
}
- (void)hudDidDisappear:(ATMHud *)_hud
{
    self.tableView.scrollEnabled = YES;
} 
```

转储视图：

```
#import <QuartzCore/QuartzCore.h>

#import "UIView+Utilities.h"

@interface UIView (Utilities_Private)

+ (void)appendView:(UIView *)v toStr:(NSMutableString *)str;

@end

@implementation UIView (Utilities_Private)

+ (void)appendView:(UIView *)a toStr:(NSMutableString *)str
{
    [str appendFormat:@"  %@: frame=%@ bounds=%@ layerFrame=%@ tag=%d userInteraction=%d alpha=%f hidden=%d\n", 
        NSStringFromClass([a class]),
        NSStringFromCGRect(a.frame),
        NSStringFromCGRect(a.bounds),
        NSStringFromCGRect(a.layer.frame),
        a.tag, 
        a.userInteractionEnabled,
        a.alpha,
        a.isHidden
        ];
}

@end

@implementation UIView (Utilities)

+ (void)dumpSuperviews:(UIView *)v msg:(NSString *)msg
{
    NSMutableString *str = [NSMutableString stringWithCapacity:256];

    while(v) {
        [self appendView:v toStr:str];
        v = v.superview;
    }
    [str appendString:@"\n"];

    NSLog(@"%@:\n%@", msg, str);
}

+ (void)dumpSubviews:(UIView *)v msg:(NSString *)msg
{
    NSMutableString *str = [NSMutableString stringWithCapacity:256];

    if(v) [self appendView:v toStr:str];
    for(UIView *a in v.subviews) {
        [self appendView:a toStr:str];
    }
    [str appendString:@"\n"];

    NSLog(@"%@:\n%@", msg, str);
}

@end 
```

# xcode - 使用未声明的标识符“segue”

> ID：11939177
> 
> 赞同：1
> 
> 时间：2012-08-13T17:20:10.407
> 
> 标签：xcode, segue, undeclared-identifier

我准备把头撞在桌子上。或者我只是太累了。谁能借第二双眼睛告诉我为什么下面的最后一个 if 语句会产生错误？

非常感谢

```
#import "BAWelcomeViewController.h"

@interface BAWelcomeViewController ()

@end

@implementation BAWelcomeViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)viewWillAppear:(BOOL)animated {
    if (![PFUser currentUser]) {
        [self performSegueWithIdentifier:@"Show Login View" sender:self];
        return;
    }
    [self performSegueWithIdentifier:@"Show Main View" sender:self];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

    if ([[segue identifier] isequaltostring:@"Show Login View") {
        //do something here
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:33:17.577

上下文有点稀疏，很难确定你的意思是什么，但看起来你已经从其他地方复制并粘贴了代码；

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

    if ([[segue identifier] isequaltostring:@"Show Login View") { 
```

该方法已经使用标识符调用，而不是 segue，所以你需要的可能只是；

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

    if ([identifier isequaltostring:@"Show Login View"]) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:32:49.870

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

    if ([[segue identifier] isequaltostring:@"Show Login View") {
        //do something here
    }

} 
```

是不正确的。尝试

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

    if ([identifier isEqualToString:@"Show Login View"]) {
        //do something here
    }

} 
```

你没有一个`segue`可以打电话`identifier`的。还修复了一些代码错误。

# c# - 从 .NET 将类型序列化为 XML

> ID：11939178
> 
> 赞同：4
> 
> 时间：2012-08-13T17:20:11.887
> 
> 标签：c#, .net, xmlserializer, ixmlserializable

我有这个 C# 4.0 类型

```
public class DecimalField
{
    public decimal Value { get; set; }
    public bool Estimate { get; set; }
} 
```

我想使用 XmlSerializer 将类型序列化为

```
<Val Estimate="true">123</Val> 
```

理想情况下，如果 Estimate 属性的值为 false，我想省略它。将 Estimate 更改为可为空的 bool 是可以接受的。

从这种类型到这种 XML 表示需要哪些属性/实现？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:27:53.013

不确定您是否可以仅使用属性有条件地输出 Estimate。但是您绝对可以实现 IXmlSerializable 并检查 WriteXml 方法中的 Estimate 值。

这是一个[例子](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:50:12.420

有条件地省略`Estimate`将需要大量的编码。我不会那样做的。

```
XmlWriter writer = XmlWriter.Create(stream, new XmlWriterSettings() { OmitXmlDeclaration = true });

var ns = new XmlSerializerNamespaces();
ns.Add("", "");

XmlSerializer xml = new XmlSerializer(typeof(DecimalField));

xml.Serialize(writer, obj, ns); 
```

-

```
[XmlRoot("Val")]
public class DecimalField
{
    [XmlText]
    public decimal Value { get; set; }
    [XmlAttribute]
    public bool Estimate { get; set; }
} 
```

您还可以使用 Linq2Xml 手动序列化您的类

```
List<XObject> list = new List<XObject>();
list.Add(new XText(obj.Value.ToString()));
if (obj.Estimate) list.Add(new XAttribute("Estimate", obj.Estimate));

XElement xElem = new XElement("Val", list.ToArray());

xElem.Save(stream); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T21:21:07.993

在不实现 IXmlSerializable 的情况下，这几乎是您所能得到的（始终包含 Estimate 属性）：

```
[XmlRoot("Val")]
public class DecimalField
{
    [XmlText()]
    public decimal Value { get; set; }
    [XmlAttribute("Estimate")]
    public bool Estimate { get; set; }
} 
```

使用 IXmlSerializable，您的类看起来像这样：

```
[XmlRoot("Val")]
public class DecimalField : IXmlSerializable
{
    public decimal Value { get; set; }
    public bool Estimate { get; set; }

    public void WriteXml(XmlWriter writer)
    {
        if (Estimate == true)
        {
            writer.WriteAttributeString("Estimate", Estimate.ToString());
        }

        writer.WriteString(Value.ToString());
    }

    public void ReadXml(XmlReader reader)
    {
        if (reader.MoveToAttribute("Estimate") && reader.ReadAttributeValue())
        {
            Estimate = bool.Parse(reader.Value);
        }
        else
        {
            Estimate = false;
        }

        reader.MoveToElement();
        Value = reader.ReadElementContentAsDecimal();
    }

    public XmlSchema GetSchema()
    {
        return null;
    }
} 
```

您可以像这样测试您的课程：

```
 XmlSerializer xs = new XmlSerializer(typeof(DecimalField));

    string serializedXml = null;
    using (StringWriter sw = new StringWriter())
    {
        DecimalField df = new DecimalField() { Value = 12.0M, Estimate = false };
        xs.Serialize(sw, df);
        serializedXml = sw.ToString();
    }

    Console.WriteLine(serializedXml);

    using (StringReader sr = new StringReader(serializedXml))
    {
        DecimalField df = (DecimalField)xs.Deserialize(sr);

        Console.WriteLine(df.Estimate);
        Console.WriteLine(df.Value);
    } 
```

# c# - 无法更新数据库值

> ID：11939180
> 
> 赞同：0
> 
> 时间：2012-08-13T17:20:21.637
> 
> 标签：c#, asp.net

我在第一页有两个注册页面，我插入了必填字段，然后我使用用户 ID 更新了一些其他详细信息...用户 ID 是数据库中的一个身份列，所以我的更新存储了过程

```
 ALTER procedure [dbo].[sp_update]

(@id int,@FormFiledBy varchar (50),@MaritalStatus varchar (50),@Height varchar (50),
@Religion varchar (50),@Caste varchar (100),
 @MotherTongue varchar(50),@Education varchar (100),@Occupation varchar(50),
 @CountryofResidence varchar (50),@EducationDetails varchar (100),@AnnualIncome varchar(50),
@CountryOfBirth varchar(50),@BirthPlace varchar(50),@TimeOfBirth nchar(10),@StarSign varchar (100),
@Gothram varchar (50),@Rassi varchar(50),@HavinChildren varchar(10),@PhysicalStatus varchar (100))

as
begin

update Profile_Master
 set FormFiledBy=@FormFiledBy,MaritalStatus=@MaritalStatus,Height=@Height,
Religion=@Religion,Caste=@Caste,MotherTongue=@MotherTongue,
Education=@Education,Occupation=@Occupation,CountryofResidence=@CountryofResidence,EducationDetails=@EducationDetails,
AnnualIncome=@AnnualIncome,CountryOfBirth=@CountryOfBirth,BirthPlace=@BirthPlace,TimeOfBirth=@TimeOfBirth,
StarSign=@StarSign,Gothram=@Gothram,Rassi=@Rassi,HavinChildren=@HavinChildren,PhysicalStatus=@PhysicalStatus

where UserId=@id
return
end 
```

在我的 DAL

```
 public static int update(ProfileMasterBLL profileMasterBLL)
    {
        string userid = ProfileMasterDAL.GetUserIdByEmailID(profileMasterBLL.EmailID);

        SqlConnection conn = Generic.DBConnection.OpenConnection();
        try
        {
            SqlCommand cmdd = new SqlCommand("sp_update", conn);
            cmdd.CommandType = CommandType.StoredProcedure;
            cmdd.Parameters.AddWithValue("@FormFiledBy", profileMasterBLL.FormFiledBy);
            cmdd.Parameters.AddWithValue("@MaritalStatus", profileMasterBLL.MaritalStatus);
            cmdd.Parameters.AddWithValue("@Height", profileMasterBLL.Height);
            cmdd.Parameters.AddWithValue("@Religion", profileMasterBLL.Religion);
            cmdd.Parameters.AddWithValue("@Caste", profileMasterBLL.Caste);
            cmdd.Parameters.AddWithValue("@Education", profileMasterBLL.Education);
            cmdd.Parameters.AddWithValue("@Occupation", profileMasterBLL.Occupation);
            cmdd.Parameters.AddWithValue("@CountryofResidence", profileMasterBLL.CountryofResidence);
            cmdd.Parameters.AddWithValue("@EducationDetails", profileMasterBLL.EducationDetails);
            cmdd.Parameters.AddWithValue("@CountryOfBirth", profileMasterBLL.CountryOfBirth);
            cmdd.Parameters.AddWithValue("@BirthPlace", profileMasterBLL.BirthPlace); 
```

在我的用户界面中

```
protected void Button1_Click(object sender, EventArgs e)
    {
        // Get User ID from DAL
        int chk = 0;
        if (Session["EmailID"] != null)
        {
            emailID = Session["EmailID"].ToString();
        }
        ProfileMasterBLL prfbll = new ProfileMasterBLL();
        string userid = ProfileMasterDAL.GetUserIdByEmailID(emailID); 
```

我可以在这里获取用户 ID，但在此之后

```
 chk = ProfileMasterDAL.update(prfbll); 
```

在这里断点跳转到更新方法，我将 emailid 设为 null，所以我的 userid 也为 null 对此有什么帮助吗？

在我的 BAL

```
public class ProfileMasterBLL
{
    public int UserId { get; set; }
    public string FormFiledBy { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Gender { get; set; }
    public string MaritalStatus { get; set; }
    public string HavinChildren { get; set; }
    public string EmailID { get; set; }
 } 
```

在我的第一页中，我正在捕获会话值

```
 Session["EmailID"] = TextBox8.Text; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:15:31.843

尝试声明字符串`emailID`，使其在`(Session["EmailID"] != null)`大括号之后仍然在范围内：

```
protected void Button1_Click(object sender, EventArgs e)
   {
       // Get User ID from DAL
       int chk = 0;

       string emailID = ""; 

       if (Session["EmailID"] != null)
       {
           emailID = Session["EmailID"].ToString();
       }
       ProfileMasterBLL prfbll = new ProfileMasterBLL();
       string userid = ProfileMasterDAL.GetUserIdByEmailID(emailID); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:07:46.517

尝试检查空字符串。此外，您的 UserId 在某些时候是一个字符串，而不是一个 int，您在哪里转换和处理转换错误。在进行数据库调用之前尝试 int.TryParse()。

# arrays - 从模型中获取数组，然后传递给视图

> ID：11939181
> 
> 赞同：0
> 
> 时间：2012-08-13T17:20:27.657
> 
> 标签：arrays, codeigniter

很简单，但对我这个初学者来说，是个问题。我需要将一个数组从我的模型（数组在读取文本文件时填充信息）传递给控制器​​，然后最终传递给视图。我的模型：

```
 function show_notes(){
    $file = "notes.txt";

    foreach(file($file) as $entry)
    {
            list($user, $content) = array_map('trim', explode(':', $entry));
            $notes = array (
                'user'=> '$user',
                'content'=> '$content'
            );
    }
    return $notes;
} 
```

控制器：

```
 function members_area()
{
    $this->load->model('Note_model');
    $notes[] = $this->Note_model->show_notes();

    $this->load->view('includes/header');
    $this->load->view('members_area', $notes);
    $this->load->view('includes/footer');   
} 
```

鉴于我使用这个：

```
 foreach ($notes as $item)
    {
    echo "<h1>$user</h>";
    echo "<p>$content</p>";
            } 
```

而且我收到错误提示**变量**在我看来是未定义的。

我想我只是不明白数组是如何工作的。我已经尝试阅读有关内容，我尝试了一些与此类似的示例，但仍然无法理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:22:00.350

在您的控制器中：

```
$data['notes'] = $this->Note_model->show_notes();
... 
$this->load->view('members_area', $data); 
```

编辑：

在您看来：

```
<?php foreach ($notes as $item):?>
   <h1><?php echo $item['user']; ?></h1>
   <p><?php echo $item['content'] ?></p>
<?php endforeach; ?> 
```

在您的模型中：

```
$notes = array();
foreach(file($file) as $entry)
{
        list($user, $content) = array_map('trim', explode(':', $entry));
        array_push($notes, array('user' => $user, 'content' => $content));
}
return $notes; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:23:53.400

替换这个

```
$notes[] = $this->Note_model->show_notes(); 
```

有了这个

```
$notes['notes'] = $this->Note_model->show_notes(); 
```

# iis - IIS 反向代理转发授权标头

> ID：11939183
> 
> 赞同：2
> 
> 时间：2012-08-13T17:20:35.223
> 
> 标签：iis, url-rewriting, http-headers, iis-7.5, reverse-proxy

我们正在使用 IIS 应用程序请求路由和 URL 重写规则来反向代理访问内部网络服务器。

这在 IIS 配置了匿名身份验证时有效，但添加基本身份验证会导致问题。在没有深入了解内部网络服务器的身份验证机制的情况下，我想做的*不是*将授权标头从 IIS 代理传递到目标网络服务器。

```
clientIP    proxyIP     HTTP    GET /resource HTTP/1.1
    Cache-Control: max-age=0\r\n
    ...
    Authorization: Basic Base64EncodedCredentials 
    ....
proxyIP     serverIP    HTTP        GET /resource HTTP/1.1
    Cache-Control: max-age=0\r\n
    ...
    Authorization: Basic Base64EncodedCredentials <--need to remove this
    .... 
```

任何提示将非常感谢！

# android - 不满意的链接错误 - OpenCV for Android Non-native

> ID：11939192
> 
> 赞同：17
> 
> 时间：2012-08-13T17:21:35.477
> 
> 标签：android, opencv, unsatisfiedlinkerror

几天前，我[询问](https://stackoverflow.com/questions/11852642/)了一个`UnsatisfiedLinkError`运行非本地 OpenCV 代码的问题。`onCreate()`我以为在重新安装 Eclipse 并关闭/重新打开所有包后问题就解决了，但是在我将 OpenCV 代码放入现有方法 后又回来了。

我用一个名为 Start 的活动创建了一个新的 Android 应用程序。然后我转到项目属性并将 OpenCV 添加为库。这是活动的代码（`Start.java`）：

```
package com.test;

import org.opencv.core.Mat;
import org.opencv.highgui.Highgui;

import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.view.Menu;

public class Start extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_start);

        Mat Image = Highgui.imread("/image.jpg");
        if (Image == null) {
            AlertDialog ad = new AlertDialog.Builder(this).create(); 
            ad.setMessage("Fatal error: can't open /image.jpg!");  
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_start, menu);
        return true;
    }
} 
```

这是日志：

```
08-13 12:26:14.791: E/Trace(1067): error opening trace file: No such file or directory (2)
08-13 12:26:15.191: W/dalvikvm(1067): No implementation found for native Lorg/opencv/highgui/Highgui;.imread_1:(Ljava/lang/String;)J
08-13 12:26:15.191: D/AndroidRuntime(1067): Shutting down VM
08-13 12:26:15.191: W/dalvikvm(1067): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
08-13 12:26:15.201: E/AndroidRuntime(1067): FATAL EXCEPTION: main
08-13 12:26:15.201: E/AndroidRuntime(1067): java.lang.UnsatisfiedLinkError: Native method not found: org.opencv.highgui.Highgui.imread_1:(Ljava/lang/String;)J
08-13 12:26:15.201: E/AndroidRuntime(1067):     at org.opencv.highgui.Highgui.imread_1(Native Method)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at org.opencv.highgui.Highgui.imread(Highgui.java:324)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at com.test.Start.onCreate(Start.java:18)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.Activity.performCreate(Activity.java:5008)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.os.Looper.loop(Looper.java:137)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at android.app.ActivityThread.main(ActivityThread.java:4745)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at java.lang.reflect.Method.invokeNative(Native Method)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at java.lang.reflect.Method.invoke(Method.java:511)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
08-13 12:26:15.201: E/AndroidRuntime(1067):     at dalvik.system.NativeStart.main(Native Method) 
```

同样，这是非本地代码，因此出现 Unsatisfied Link Error 没有多大意义。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-14T01:32:16.963

经过一堆搜索，我发现[了这个](http://docs.opencv.org/3.0-beta/doc/tutorials/introduction/android_binary_package/dev_with_OCV_on_Android.html)：

“3.如果你的应用项目没有JNI部分，只需将对应的OpenCV原生库从/sdk/native/libs/复制到你的项目目录到文件夹libs/中即可。”

这意味着复制 \armeabi、\armeabi-v7a 和 \x86 文件夹。

"4\. 在您​​的应用程序中启用 OpenCV 的最后一步是调用 OpenCV API 之前的 Java 初始化代码。例如，可以在 Activity 类的静态部分中完成，该部分仅在任何实例之前执行一次创建类：

```
static {
    if (!OpenCVLoader.initDebug()) {
        // Handle initialization error
    }
} 
```

或者，您可以将其放在 onCreate 方法中：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_load_image);
    if (!OpenCVLoader.initDebug()) {
        // Handle initialization error
    }
    [...]
} 
```

现在它起作用了！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-05T09:02:48.010

你应该使用

```
if (!OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_2_4_2, this, mOpenCVCallBack))
{
    Log.e("TEST", "Cannot connect to OpenCV Manager");
} 
```

在 OnCreate() 并使用

```
private BaseLoaderCallback  mOpenCVCallBack = new BaseLoaderCallback(this) {
    @Override
    public void onManagerConnected(int status) {
        switch (status) {
                case LoaderCallbackInterface.SUCCESS:
                {
                               Mat Image = Highgui.imread("/image.jpg");
                               if (Image == null) {
                                   AlertDialog ad = new AlertDialog.Builder(this).create(); 
                                   ad.setMessage("Fatal error: can't open /image.jpg!");  
                                }
                } break;
                default:
                {
                    super.onManagerConnected(status);
                } break;
            }
    }
    }; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-03T18:23:10.550

在大多数情况下，在调用 openCV 之前这样一行就足够了：“System.loadLibrary(Core.NATIVE_LIBRARY_NAME);”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-16T16:22:05.313

我在 Android Studio 的项目中添加了 opencv。当本机文件在运行时不可用时，会发生此错误。因此，您必须将本机文件复制到正确的位置。

首先`jniLibs`在此位置`/app/src/main/`位置创建并复制 OpenCV SDK 的 jniLibs 中带有 *.so 文件（armeabi、armeabi-v7a、mips、x86）的所有文件夹，并使您的 gradle 插件高于 0.7.2+

![在此处输入图像描述](../Images/f377f9dcfa4cb55b36703fe4cc10224f.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-27T17:10:53.447

问题是您在*OpenCV4Android*库完成加载之前就使用了***Highgui.imread***方法。*Android 在加载OpenCV4Android*库之前调用“onCreate”方法。因此，为您的 OpenCV 代码创建一个单独的方法，如下所示：-

 **```
public class Start extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_start);
   }

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_start, menu);
    return true;
   }

public void readImage {
    Mat Image = Highgui.imread("/image.jpg");
    if(Image=null) {
    Log.i("Start", "--------Image Cannot be Loaded--------");
    else if(!Image=null) {
    Log.i("Start", "--------Image Loaded Successfully--------");
   } 
```

}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-24T15:20:56.950

答案中的链接不起作用，我不得不四处寻找适合我的解决方案。

我首先在类中定义了一个 BaseLoaderCallback

```
private BaseLoaderCallback  mLoaderCallback = new BaseLoaderCallback(this) {
    @Override
    public void onManagerConnected(int status) {
        switch (status) {
            case LoaderCallbackInterface.SUCCESS:
            {
                Log.i(TAG, "OpenCV loaded successfully");
               // any immediate code for using OpenCV
            } break;
            default:
            {
                super.onManagerConnected(status);
            } break;
        }
    }
}; 
```

然后在 onResume 函数中我有：

```
@Override
public void onResume()
{
    super.onResume();
    if (!OpenCVLoader.initDebug()) {
        Log.d(TAG, "Internal OpenCV library not found. Using OpenCV Manager for initialization");
        OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_3_0_0, this, mLoaderCallback);
    } else {
        Log.d(TAG, "OpenCV library found inside package. Using it!");
        mLoaderCallback.onManagerConnected(LoaderCallbackInterface.SUCCESS);

    }
} 
```

确保以下内容

1.您正在根据您的版本更改 OPENCV_VERSION_3_0_0

2.  在加载之前不要运行任何 opencv 库。即使在`onCreate()`，opencv 还没有加载。最好将它放在**OpenCV 已成功加载**`onManagerConnected()`的 switch case 中的函数中。

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-31T11:57:38.073

在我的情况下，我将 opencv 类粘贴到错误的包名中

## 错了一个

我将 opencv 类粘贴到**com.opencv** -> all classes

## 正确一个

**org.opencv** -> 所有类

更改此正确的包名称后，它将起作用。

原因 - 他们可能指的是“org.opencv..”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-21T17:48:09.467

我已经为此花费了几个小时，但找不到有效的解决方案。这对我有用，请查看我对类似问题的回答。

[https://stackoverflow.com/a/65832050/6212983](https://stackoverflow.com/a/65832050/6212983)****

# java - JFrame 中的自定义绘图不显示

> ID：11939194
> 
> 赞同：0
> 
> 时间：2012-08-13T17:21:38.017
> 
> 标签：java, swing, graphics

我正在设计一个条形图，但它没有显示。它的封装 JFrame 正在显示，并且`paintComponent()`正在被调用，但没有出现灰色网格线。为什么是这样？

```
class ChartArea extends JPanel {

        private int Yscl, Xscl;
        private static final Color BACKGROUND_COLOR = Color.BLACK;
        private static final Color LINE_COLOR = Color.GREEN;
        private static final Color GRIDLINE_COLOR = Color.GRAY;

        ChartArea() {
            setBackground(BACKGROUND_COLOR);
            setForeground(LINE_COLOR);
            Yscl = 20;
            Xscl = 20;
        }

        @Override
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g;
            int height = getHeight();
            int width = getWidth();
            double max = data.getMax(); //gets the maximum value in the data set

            try {
                g2d.setStroke(new BasicStroke(1f, BasicStroke.CAP_BUTT, BasicStroke.JOIN_MITER));

                //put the origin in the bottom right. Positive is up and left
                g2d.translate(width, height);
                g2d.scale(-1d, -1d);

                //if the data set exceeds the window height, scale it down
                if (max > height) {
                    g2d.scale(1, height / max);
                }
                paintGrid(g2d);
                paintLine(g2d);
            } finally {
                g2d.dispose();
            }
        }

        private void paintGrid(Graphics2D g) {
            g.setPaint(GRIDLINE_COLOR);

            //Vertical Lines
            for (double pos = 0; pos > getWidth(); pos += Xscl) {
                Line2D line = new Line2D.Double(pos, 0d, pos, getHeight());
                g.draw(line);
            }

            //Horizontal Lines
            for (double pos = 0; pos > getHeight(); pos += Yscl) {
                Line2D line = new Line2D.Double(0d, pos, getWidth(), pos);
                g.draw(line);
            }
        }

        private void paintLine(Graphics2D g) {
            g.setPaint(LINE_COLOR);
            Path2D plot2 = new Path2D.Double();

            if (!data.isEmpty()) {
                plot2.moveTo(0.0, data.get(0));
                for (int i = 1; i < data.size(); i++) {
                    plot2.lineTo((double) i, data.get(i));
                }
                g.draw(plot2);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T00:55:52.027

看起来在`for`绘制线条的循环条件中有错字。循环永远不会在当前条件下执行。如果您将条件更改为`pos < getWidth();`，`pos < getHeight();`您应该会看到网格。这是一个完整的方法：

```
private void paintGrid(Graphics2D g) {
    g.setPaint(GRIDLINE_COLOR);

    //Vertical Lines
    //for (double pos = 0; pos > getWidth(); pos += Xscl) {
    for (double pos = 0; pos < getWidth(); pos += Xscl) {
        Line2D line = new Line2D.Double(pos, 0d, pos, getHeight());
        g.draw(line);
    }

    //Horizontal Lines
    //for (double pos = 0; pos > getHeight(); pos += Yscl) {
    for (double pos = 0; pos < getHeight(); pos += Yscl) {
        Line2D line = new Line2D.Double(0d, pos, getWidth(), pos);
        g.draw(line);
    }
} 
```

这是一个结果：

![在此处输入图像描述](../Images/d9e744d1286c0e3f75bcdff5a18abd3f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:39:42.207

您正在覆盖 paintComponent 以*仅*绘制您的自定义面板。您也只需要绘制父实例。

```
@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    // custom painting
} 
```

# mongodb - MongoDB 不同，返回所有字段

> ID：11939199
> 
> 赞同：7
> 
> 时间：2012-08-13T17:21:53.010
> 
> 标签：mongodb, node-mongodb-native, database

我正在使用 MongoDB 和 node-mongodb-native 驱动程序。

我正在尝试返回具有不同属性的所有记录。

这似乎有效，但它只返回我正在检查的不同值，而不是每个文档中的所有值。

这就是我试图只返回名称字段的内容，我也尝试过不使用它及其变体，但它总是只返回数组中的 item_id。

```
 this.collection.distinct("item_id", [{"name" : true}, {sold : {"$exists" : true}}], function(err, results) {
        if (err) {
            callback(err);
        } else {
            console.log(results);
        }
    }); 
```

有什么建议如何从每个文档中获取所有数据？

谢谢！

编辑：使用 Map Reduce

因此，我只是使用 node-mongodb-native 设置了 map reduce 的开始，这就是我目前所拥有的：

```
 var map = function() {
        emit(this._id, {"_id" : this._id, "name" : this.name});
    }

    var reduce = function(key, values) {

        var items = [];

        values.forEach(function(v) {
            items.push(v);
        }); 

        return {"items" : items};
    }

    this.collection.mapReduce(map, reduce, {out: "res"}, function(err, results) {
        if (err) {
            console.log(err);
        } else {
            console.log(results);
        }
    }); 
```

我知道逻辑不存在不同，但结果是 db 对象，我不能在其上使用“toArray”。任何想法为什么会这样？

# javascript - 将 Javascript“小部件”插入远程站点

> ID：11939206
> 
> 赞同：0
> 
> 时间：2012-08-13T17:22:20.217
> 
> 标签：javascript, xss

我想为我的网络应用程序的用户提供一种使用 Javascript 在他们自己的网站上添加各种小部件的方法。我一直在研究如何最好地实现这一点，似乎 XSS 是唯一真正可行的方法，但似乎主流浏览器实际上将其视为安全威胁。我可以使用什么替代方案？当然，用户自己安装代码片段，这都是经过许可的。

我一直在关注的教程是这样的： http: [//drnicwilliams.com/2006/11/21/diy-widgets/](http://drnicwilliams.com/2006/11/21/diy-widgets/)

但我认为这样的请求不再可能了，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:23:10.473

目前最好的解决方案是 CORS 方法。Nicholas Zakas 在他的文章中很好地解释了这一点：[http ://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)

# python - 根据条件删除字典中的条目

> ID：11939207
> 
> 赞同：29
> 
> 时间：2012-08-13T17:22:22.493
> 
> 标签：python, dictionary

我有一个字典，其中名称作为键， (age, Date of Birth) 元组作为这些键的值。例如

```
dict = {'Adam' : (10, '2002-08-13'),
        'Eve'  : (40, '1972-08-13')} 
```

我想删除值元组中年龄 > 30 的所有键，我该怎么做？我正在使用`dict[name][0]`where dict 是我的字典来访问每个键的年龄。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-13T17:24:23.757

通常的方法是创建一个仅包含您要保留的项目的新字典：

```
new_data = {k: v for k, v in data.items() if v[0] <= 30} 
```

如果您需要原地更改原始字典，可以使用`for`-loop：

```
for k, v in list(data.items()):
    if v[0] > 30:
        del data[k] 
```

请注意，这`list(data.items())`会创建字典项目的浅表副本，即包含对所有键和值的引用的新列表，因此在循环内修改原始字典是安全的。

# android - 永久从活动中的绑定服务获取变量值

> ID：11939208
> 
> 赞同：0
> 
> 时间：2012-08-13T17:22:23.663
> 
> 标签：android, variables, service, bind

我有一个已经绑定到服务的活动。当我启动活动时，它会绑定到服务并从服务内的变量中获取值。所以我可以在我的活动中显示价值。

现在我想永久读取服务中变量的值。不仅在我的活动的 onCreate 被调用时。我怎样才能做到这一点？什么是正确的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:38:01.050

有几种方法可以做到这一点。一种相对简单的方法是使用`Handler`定期触发自身的 a

```
public class MyActivity extends Activity {

    private static final int UPDATE_RATE_IN_MS = 500;
    private static final int MSG_UPDATE = 0;

    private Handler mHandler;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mHandler = new Handler() {
            @Override
            public void handleMessage(Message msg) {
                doUpdate();
                mHandler.sendEmptyMessageDelayed(MSG_UPDATE, UPDATE_RATE_IN_MS);
            }
        };
    }

    @Override
    protected void onStart() {
        super.onStart();
        mHandler.sendEmptyMessageDelayed(MSG_UPDATE, UPDATE_RATE_IN_MS);
    }

    @Override
    protected void onStop() {
        super.onStop();
        mHandler.removeMessages(MSG_UPDATE);
    }

    private void doUpdate() {
        // do whatever you need here.
    }
} 
```

您将`doUpdate()`在此示例中放入值的更新。

# javascript - 当用户单击某些东西时，onbeforeunload 不断弹出一个警告框

> ID：11939213
> 
> 赞同：0
> 
> 时间：2012-08-13T17:22:49.967
> 
> 标签：javascript, javascript-events

我创建了一个页面，当用户单击窗口上的（关闭 x）按钮时会发出警告。我做了一些阅读，发现 javascript 有一个名为 onbeforeonload 的函数，它可以完成我试图实现的工作。然而，我在实现之后发现，当用户单击窗口中的任何内容（例如，保存并输入）时，对话框会重新出现。我想知道我如何只能针对窗口中的特定 X 按钮。

```
 window.onbeforeunload = function (evt) {
  var message = 'Do you want to leave?';
  if (typeof evt == 'undefined') {
    evt = window.event;
  }
  if (evt) {
    evt.returnValue = message;
  }
  return message;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:33:23.583

现在该函数正在全局调用......这个资源可能会帮助你实现你正在寻找的东西：[http ://randomdrake.com/2009/09/23/how-to-use-onbeforeunload-with-form-submit -纽扣/](http://randomdrake.com/2009/09/23/how-to-use-onbeforeunload-with-form-submit-buttons/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:40:57.173

这是 IE 的“按预期工作”行为。锚标签点击，无论是否导航，都会触发[`onbeforeunload`事件](http://msdn.microsoft.com/en-us/library/ie/ms536907%28v=vs.85%29.aspx)。

这是我使用的解决方法 - 我不确定它是否是最好的方法：

```
document.onmouseup = function () {
    if (window.event.srcElement.tagName === 'A') {
        // turn off your onbeforeunload handler
        ...

        // some small time later, turn it back on
        setTimeout(..., 200);
    }
}; 
```

# visual-studio-2010 - VC++ EE 2010 中的 glload 和 LNK 错误

> ID：11939215
> 
> 赞同：0
> 
> 时间：2012-08-13T17:22:52.727
> 
> 标签：visual-studio-2010, opengl, linker, glload

我正在尝试使用非官方 OpenGL SDK 中的 glload，但出现 LNK 错误：

```
1>  LINK : C:\Users\T\documents\visual studio 2010\Projects\testi\Debug\testi.exe not found or not built by the last incremental link; performing full link
1>glloadD.lib(gll_gl_ext.obj) : error LNK2019: unresolved external symbol __imp__wglGetProcAddress@4 referenced in function _WinGetProcAddress
1>glloadD.lib(wgll_ext.obj) : error LNK2001: unresolved external symbol __imp__wglGetProcAddress@4 
1>C:\Users\T\documents\visual studio 2010\Projects\testi\Debug\testi.exe : fatal error LNK1120: 1 unresolved externals 
```

```
#include <glload/gl_all.h>
#include <glload/gll.hpp>

void main()
{
    glload::LoadFunctions();
} 
```

链接器/附加依赖项：glloadD.lib 问题出在哪里？

**编辑1：**

首先我使用 Premake 为 vs2010 生成构建文件。然后我建立了所有的图书馆。在我的项目中，我为这些库设置了附加包含目录、附加库目录和附加依赖项。我想从这个页面运行一个示例：[链接](http://glsdk.sourceforge.net/docs/html/group__module__glimg.html)，但我忘记在加载 opengl 函数之前创建 OpenGL 上下文。我在这个项目中不需要窗口，所以我只调用 glutInit，但在 0x5bfed398 (msvcr100d.dll) 处出现未处理的异常

```
#include <glload/gl_all.h>
#include <glload/gll.hpp>
#include <freeglut/freeglut.h>

int main(int argc, char* argv[])
{
    glutInit(&argc, argv);
    glload::LoadFunctions();
} 
```

**编辑2：**

在 glload::LoadFunctions 之前调用 glutCreateWindow 似乎是必要的。以下代码有效：

```
#include <glload/gl_all.h>
#include <glload/gll.hpp>
#include <freeglut/freeglut.h>

int main(int argc, char* argv[])
{
    glutInit(&argc, argv);
    glutCreateWindow("");
    glload::LoadFunctions();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T22:40:40.763

解决方案是在初始化 GlLoad 之前创建一个工作上下文。每次使用 GLSDK 启动 OpenGL 项目时，我都会遇到这个问题。

# php - mysql_fetch_array 返回非 Unicode 文本

> ID：11939216
> 
> 赞同：6
> 
> 时间：2012-08-13T17:22:56.143
> 
> 标签：php, mysql, unicode

我制作了一个简单的 PHP 页面来获取 POST 数据并获取 sql 查询然后打印结果。我正在使用 mysql_fetch_array 函数。

该代码运行良好，但响应是非 Unicode 文本，它返回如下内容：

```
?????ABC????? 
```

请注意，数据库排序规则是 UTF8 并且存储的数据在 phpMyAdmin 中正确显示。我什至在 php 页面中使用了这个 META 标记，但结果相同：

```
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"> 
```

任何的想法？！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-13T18:02:01.657

在第一个查询之前添加这些代码行：

```
mysql_query("SET NAMES 'utf8'");
mysql_query("SET CHARACTER SET utf8");
mysql_query("SET SESSION collation_connection = 'utf8_unicode_ci'"); 
```

或者您可以编辑您的 mysql 配置以默认使用 utf8。在这里查看您需要做什么。

[在 my.cnf 中将 MySQL 默认字符集更改为 UTF-8？](https://stackoverflow.com/questions/3513773/change-mysql-default-character-set-to-utf8-in-my-cnf)

# 更新

该函数`mysql_query`已弃用，因此`mysqli`可以像这样使用对象：

```
$mysqli = new mysqli("localhost", "MYSQL_USER", "MYSQL_PASS", "MYSQL_DB");

$mysqli->query("SET NAMES 'utf8'"); 
$mysqli->query("SET CHARACTER SET utf8");  
$mysqli->query("SET SESSION collation_connection = 'utf8_unicode_ci'"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T17:45:13.123

```
mysql_set_charset('utf8', $link); 
```

其中 $link 是使用 mysql_connect 创建的连接

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T17:27:06.003

尝试使用**mb_internal_encoding("UTF-8");** 详情[http://php.net/manual/en/function.mb-internal-encoding.php](http://php.net/manual/en/function.mb-internal-encoding.php)

# c# - 如何在 VS 上本地运行应用程序时修改 .cs 文件

> ID：11939218
> 
> 赞同：0
> 
> 时间：2012-08-13T17:22:59.970
> 
> 标签：c#, visual-studio-2010, web-applications

我最近**从网站模型更改为 Web 应用程序模型**。我注意到的一个变化是，在一个网站中，当我在本地浏览器上运行该网站时，我可以对 .cs 文件进行更改，然后刷新浏览器以使更改生效。但是，在 Web 应用程序中，.cs 文件似乎有一个锁，它不允许我在不停止调试的情况下编辑 .cs 文件。

这有点长，因为我必须停下来再次运行，而不是即时进行更改。

**是否有任何调试设置可以解决这个问题？**

提前致谢。

这是我当前设置的当前编辑并继续窗口。我需要在这里改变什么吗？：![在此处输入图像描述](../Images/38b910191f09ed10a0888abb0ae4f8fa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:56:55.393

您可以在代码暂停时修改 Web 应用程序中的代码。您需要在要更改的代码行上方设置一个断点。执行代码到达断点，然后当你停在断点处时，你可以修改代码。修改完成后，您可以恢复执行。

像这样暂停时，您无法更改某些内容，例如添加新方法。但是，如果在暂停时无法接受更改，Visual Studio 会告诉您，它不会告诉您究竟是什么不喜欢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:26:24.340

您正在寻找的功能是“编辑并继续”，应该在“调试”>“选项和设置”>“调试”>“编辑并继续”中。这并没有给你完全的灵活性来改变你想要的任何东西，但确实允许一些基本的改变。

# php - ADOdb 中的 SQL 注入和一般网站安全

> ID：11939226
> 
> 赞同：10
> 
> 时间：2012-08-13T17:23:32.370
> 
> 标签：php, mysql, security, sql-injection, adodb

我已经读了很多书，但仍然不能 100% 理解某些 SQL 注入是如何发生的！

我想从知道的人那里看到基于我的示例的 SQL 注入的具体示例，以便可以复制、测试和修复它。我曾尝试 SQL 注入我的代码但不能，所以我希望有人能证明我不是这样！

1.SQL注入只能通过POST或GET方法发生，这意味着在网站上它应该是post表单，例如“注册或搜索”或像“search.php?tags=love”这样的查询，我说得对吗？

说这可以注入以下具有POST方法的代码吗？

```
$name     = trim($_POST['username']);
$mail     = trim($_POST['email']);
$password = trim($_POST['password ']);

   if ($errors == "false") {
    $sql = 
        "INSERT INTO 
           clients 
         SET 
           name='" . mysql_real_escape_string($name) . "',
           mail='" . mysql_real_escape_string($mail) . "', 
           password='" . mysql_real_escape_string(sha1($password)) . "'";
           $connection->execute($sql);

    } 
```

2.另一个有GET方法：`rate.php?like&videoID=250&userID=30`

```
$sql = 
    "SELECT 
        videoID 
     FROM 
        likes 
     WHERE 
        videoID = '" .mysql_real_escape_string($videoID). "' AND UID = '" .mysql_real_escape_string($userID). "' LIMIT 1";
        $connection->execute($sql); 
```

请帮助那些对这个主题感到自由但使用具体例子的人。

提前致谢，
伊利亚

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T20:00:04.913

*当用户输入*编码不正确时，就会发生 SQL 注入攻击。通常，用户输入是用户通过查询发送的一些数据，即`$_GET`、`$_POST`、`$_COOKIE`、`$_REQUEST`或`$_SERVER`数组中的值。但是，用户输入也可以来自各种其他来源，例如套接字、远程网站、文件等。因此，您应该真正**将除常量**（如`'foobar'`）之外的所有内容都**视为用户输入**。

在您发布的代码中，[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)用于编码（=转义）用户输入。因此该代码是正确的，即不允许任何 SQL 注入攻击。

请注意，很容易忘记调用 to `mysql_real_escape_string`- 对于熟练的攻击者来说一次就足够了！因此，您可能希望将现代[PDO](http://php.net/pdo)与[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)一起使用，而不是 adodb。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T16:20:31.863

我最近一直在深入研究这个主题，并想与其他人分享非常有趣的材料，从而使我的问题对每个人都更加完整和有启发性。

*   [John Nebel 用 PHP 防止 SQL 注入](http://www.digifuzz.net/archives/2007/07/preventing-sql-injection-with-php/)
*   [安全角 - Chris Shiflett 的 SQL 注入](http://shiflett.org/articles/sql-injection)
*   [Alexander Andonov 的意外 SQL 注入](http://webappsec.org/projects/articles/091007.txt)
*   [Mysql_real_escape_string() 与 Ilia Alshanetsky 的 Prepared Statements](http://ilia.ws/archives/103-mysql_real_escape_string-versus-Prepared-Statements.html)
*   [Sagar Joshi 的 SQL 注入攻击和防御](http://www.packetsource.com/article/sql-injection/40060/sql-injection-attack-and-defense)
*   [Jim Whitehead 教授的 SQL 注入攻击](http://classes.soe.ucsc.edu/cmps183/Spring06/lectures/SQL%20Injection%20Attacks.pdf)
*   [克里斯·希夫莱特的addlashes() vs mysql_real_escape_string()](http://shiflett.org/blog/2006/jan/addslashes-versus-mysql-real-escape-string)
*   [Joel Spolsky 的 SQL 注入错误是什么](http://www.joelonsoftware.com/items/2006/11/01.html)

*   [MySQL - SQL 注入预防](http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php)
*   [SQL 注入演练](http://www.securiteam.com/securityreviews/5DP0N1P76E.html)
*   [SQL 注入备忘单](http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/#about)
*   [PHP 和 MySQLi 中的预处理语句](http://mattbango.com/notebook/web-development/prepared-statements-in-php-and-mysqli/)

* * *

## **来自 YouTube**

*   [SQL 注入神话和谬误：Bill Karwin 的最佳防御实践](http://www.youtube.com/watch?v=o4dJ7hdA8fs)
*   [PHP 教程：安全性 - SQL 注入](http://www.youtube.com/watch?v=bORZlmyDw0s&feature=fvst)
*   [如何在 Backtrack5 RC1 上使用 SQLMAP 进行 SQL 注入](http://www.youtube.com/watch?v=-F1nBasky6E&feature=related)

* * *

## **来自维基百科**

*   [维基百科 - SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)
*   [维基百科 - SQL](http://en.wikipedia.org/wiki/SQL)

* * *

## **来自 OWASP**

*   [SQL 注入](https://www.owasp.org/index.php/SQL_Injection)
*   [SQL 注入指南](https://www.owasp.org/index.php/Guide_to_SQL_Injection)
*   [OWASP - 避免 SQL 注入](http://www.owasp.org/index.php/Avoiding_SQL_Injection#WARNING:_Escaping_table_names)
*   [SQL 注入预防备忘单](https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet)
*   [测试 SQL 注入](https://www.owasp.org/index.php/Testing_for_SQL_Injection_%28OWASP-DV-005%29)

* * *

## **来自 PHP 手册**

*   [SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)
*   [PDO 类 - 准备好的语句和存储过程](http://php.net/pdo.prepared-statements)
*   [MySQL 改进扩展](http://www.php.net/manual/en/book.mysqli.php)
*   [mysql_real_escape_string()](http://php.net/mysql_real_escape_string)

* * *

## **来自微软和甲骨文**

*   [微软在 PHP 脚本中防止 SQL 注入的正确方法是什么](http://blogs.msdn.com/b/brian_swan/archive/2010/03/04/what_2700_s-the-right-way-to-avoid-sql-injection-in-php-scripts_3f00_.aspx)
*   [在他们阻止你之前阻止 SQL 注入攻击由 Microsoft](http://msdn.microsoft.com/en-us/magazine/cc163917.aspx)
*   [防御 Oracle 的 SQL 注入攻击](http://download.oracle.com/oll/tutorials/SQLInjection/index.htm)

* * *

## **堆栈溢出**

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php/60496#60496)
*   ["Bobby Tables" XKCD 漫画中的 SQL 注入是如何工作的？](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)
*   [https://stackoverflow.com/questions/1973/what-is-the-best-way-to-avoid-sql-injection-attacks](https://stackoverflow.com/questions/1973/what-is-the-best-way-to-avoid-sql-injection-attacks)
*   [什么是 SQL 注入？](https://stackoverflow.com/questions/601300/what-is-sql-injection/601524#601524)
*   [INSERT 上的 SQL 注入](https://stackoverflow.com/questions/681583/sql-injection-on-insert)
*   [如何保护此函数免受 SQL 注入？](https://stackoverflow.com/questions/1862036/how-do-i-protect-this-function-from-sql-injection/1862178#1862178)
*   [参数真的足以防止 Sql 注入吗？](https://stackoverflow.com/questions/306668/are-parameters-really-enough-to-prevent-sql-injections/306818#306818)
*   [SQL 注入今天有风险吗？](https://stackoverflow.com/questions/1683843/is-sql-injection-a-risk-today/1684292#1684292)
*   [https://stackoverflow.com/questions/936254/sql-injection](https://stackoverflow.com/questions/936254/sql-injection)
*   [SQL 注入道德黑客](https://stackoverflow.com/questions/11936646/sql-injection-ethical-hacking)
*   [此代码是否防止 SQL 注入？](https://stackoverflow.com/questions/1800013/does-this-code-prevent-sql-injection?lq=1)

* * *

## **SQL 注入扫描器**

*   [前 15 个 SQL 注入扫描器](http://maestro-sec.com/blogs/2008/10/top-15-sql-injection-scanner/)
*   [Netsparker 社区版，免费的 SQL 注入扫描器和 XSS 扫描器](http://www.mavitunasecurity.com/communityedition/)

# facebook - 如何将我喜欢的链接迁移到另一个链接？

> ID：11939231
> 
> 赞同：-1
> 
> 时间：2012-08-13T17:23:45.740
> 
> 标签：facebook, hyperlink, migrate

我重新制作了我的网站，但它包含与旧网站的不同链接。我怎样才能迁移喜欢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:30:44.270

可能没有简单的解决方案。根据您使用的框架（如果有），您可能必须单独更改它们。如果最终出现这种情况，您将希望从命令行使用 sed 将旧 URL 的所有实例替换为新 URL。如果您使用的是 CMS，您应该能够从管理面板更改基本 URL。如果您的 URL 存储在数据库中，您可以使用 MySQL 的替换命令将旧 URL 替换为新 URL。

# objective-c - 获取 MKMapView 的 UIImage

> ID：11939232
> 
> 赞同：3
> 
> 时间：2012-08-13T17:23:47.843
> 
> 标签：objective-c, ios, uitableview, mkmapview, mapkit

我有一大堆 MKMapView 我想获得 UIImage （每个 UItableViewCell 我有一个）。很简单，我用 ;

```
UIGraphicsBeginImageContextWithOptions(_map.bounds.size, NO, 0.0);
[_map.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *mapImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

_mapImageView.image = mapImage; 
```

在我的 UITableViewCell 子类中。

问题是：`MKMapView`如果不在屏幕上，就不会绘制它的图块`UITableViewCell`，所以当我滚动我的时`UITableView`，我有一堆`UIImageView`灰色网格。有人有解决方案吗？我将如何强制`MKMapView`在图形上下文中呈现？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T08:43:13.857

[这](https://developers.google.com/maps/documentation/staticmaps/)可能会让我摆脱麻烦（Google Static Maps API V2）

**-Edit-** 实际上实现了这一点：比我想做的要少得多，就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:30:06.207

当我需要同时渲染整个 tableview 时，我调整了 tableview 的大小，使其足够大以显示它拥有的所有单元格。

更改表格的框架，使其高度为 numberOfCells*heightOfCell，渲染并更改框架。

# visual-studio - Visual Studio 发布（部署）包包含 Mercurial (hg) 文件 (Orchard)

> ID：11939235
> 
> 赞同：4
> 
> 时间：2012-08-13T17:24:02.760
> 
> 标签：visual-studio, deployment, mercurial, publish, orchardcms

我有一个 Web 项目的 C# 解决方案（实际上它是一个 Orchard CMS 站点，但这并不重要），它在 Mercurial 下进行版本控制（使用 Tortoise HG BTW），它有一些项目位于单独的存储库中（并且是解决方案存储库）。Hg 文件永远不会包含在解决方案中的任何位置，它们不会在 Visual Studio 中显示。

当我尝试使用在 Web 项目属性下选择的“仅运行应用程序所需的文件”选项发布解决方案（或构建部署包）时，构建的包包含子存储库的 hg 文件（如整个 .hg 文件夹） .

这基本上是无害的（除了发布一堆不必要的文件），但发布也可能完全失败，并显示以下消息：

> 将文件 SubRepoFolder.hg\store\data_libraries_parallel_extensions_extras_coordination_data_structures_async_coordination_async_reader_writer.cs.i 复制到 obj\Release\Package\PackageTmp\SubRepoFolder.hg\store\data_libraries_parallel_extensions_extras_coordination_data_structures_async_coordination_async_reader.i 时出错。指定的路径、文件名或两者都太长。完全限定的文件名必须少于 260 个字符，目录名必须少于 248 个字符。

我不知道接下来要做什么，如何防止 VS 构建它应该看不到的文件。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T11:35:05.757

事实证明，这是一个 Orchard 解决方案是一个重要的事实！

Orchard.Web.csproj 中有这一行：

```
<Target Name="CustomCollectFiles">
<ItemGroup>
  ...
  <_CustomFiles Include="Media\**\*;App_Data\**\*;Modules\**\*;Themes\**\*;Core\**\*" Exclude="**\obj\**;@(Orchard-Web-Bins -> '**\%(Filename)%(Extension)');**\*.csproj.user;**\*.hg*" /> 
```

它用于将文件从 Orchard 特定文件夹复制到构建包。请注意，它应该排除 Mercurial 文件和文件夹，但事实并非如此。我将这一行改为：

```
<_CustomFiles Include="Media\**\*;App_Data\**\*;Modules\**\*;Themes\**\*;Core\**\*" Exclude="**\obj\**;@(Orchard-Web-Bins -> '**\%(Filename)%(Extension)');**\*.csproj.user;**\.hg\**" /> 
```

请注意 .hg 后的“*”。是的，这花了我大约三个小时，浏览了我能找到的每个构建配置选项。

现在这只排除 .hg 文件夹，但不包括 .hg 文件（如 .hgignore 或 .htags），但我不在乎：与包含一堆文件的 .hg 文件夹相反，这些文件是无害的。

[这篇博文](http://markkemper1.blogspot.hu/2010/10/zipping-build-outputs-using-build-file.html)帮助了我。

# html - 对齐 = 中心 - 200 像素？

> ID：11939236
> 
> 赞同：2
> 
> 时间：2012-08-13T17:24:19.887
> 
> 标签：html, css, html-table

我有一个具有这种配置的表：

```
<table width = "100%" border = "0" align = "center">
  <tr>
    <td width = "200px" align = "center"></td>
    <td align = "center"></td>
  </tr>
</table> 
```

因为第一列导致列中的数据从中心偏移 200px，是否可以使用一些计算，无论是针对 CSS 还是可能是 HTML，将第 2 列中的内容居中，然后将其移动到左边 200px 来补偿第 1 列的宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:30:28.857

尝试这个：

```
<table width = "100%" border = "0" align = "center">
  <tr>
    <td width = "200px" align = "center">test</td>
    <td align = "center"><div style="margin-left:-200px;">test</div></td>
  </tr>
</table>​​​​​​​​​​​ 
```

例如：http: [//jsfiddle.net/DrSDr/2/](http://jsfiddle.net/DrSDr/2/)

# emacs - emacs中的附加修饰键？

> ID：11939243
> 
> 赞同：4
> 
> 时间：2012-08-13T17:24:56.490
> 
> 标签：emacs, customization, key-bindings

我最近一直在修改我的 Emacs 设置，但我遇到了一个开始让我烦恼的问题。我希望能够引入额外的修饰符，如键。为了让事情更清楚，我想要做的是当我处于 dired-mode 时（它不接受文本输入，所以可以反弹普通字母）我希望这样当我按住字母`s`并按下`j`或`l`光标分别移动到下一个和上一个目录行。有效地使`s`键充当修饰符。

我已经研究过使`s`apply 成为修饰符，例如`super`or`hyper`但这些都用于全局事物。这可能吗？如果不是，那就太可惜了。

编辑：

我所追求的似乎有些混乱。如果我定义一个正常的键序列，例如

`(define-key map (kbd "s j") 'dired-next-dirline)`

然后我必须在*每次*按下移动到下一个目录行之前一直按下该`s`键。这**不是**我想要的（不要听起来很生气：P）我想像一个修饰符一样，我可以按住*键*并继续点击以向下移动。*`j`**`s``s`*`j`****

 ****我希望我已经更清楚地说明了这一点。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:32:21.807

我在代码中挖掘并想出了这个。它绑定`s j`到`my-dired-next-dirline`，但在你完成之后，`j`再做一次就足够了。任何其他键都会重置临时绑定。

请注意，该功能`set-temporary-overlay-map`是在 Emacs 24.2 中添加的，在撰写本文时尚未发布，因此您需要[从 git 构建 Emacs](http://emacswiki.org/emacs/EmacsFromGit)。

```
(defun my-dired-next-dirline ()
  (interactive)
  (dired-next-dirline 1)
  (set-temporary-overlay-map
   (let ((map (make-sparse-keymap)))
     (define-key map [?j] 'my-dired-next-dirline)
     map)
   nil))

(eval-after-load "dired"
  '(progn
     (let ((prefix-map (make-sparse-keymap)))
       (define-key prefix-map "j" 'my-dired-next-dirline)  
       (define-key dired-mode-map "s" prefix-map)))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:30:54.970

[关键和弦](http://www.emacswiki.org/KeyChord)可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-13T11:27:57.330

这个问题早于它，但 Hydra 包允许您执行此操作以及更多操作。

[https://github.com/abo-abo/hydra](https://github.com/abo-abo/hydra)

请参阅此处的示例：[https](https://github.com/abo-abo/hydra/blob/master/hydra-examples.el) ://github.com/abo-abo/hydra/blob/master/hydra-examples.el和此处[https://github.com/abo-abo/hydra/blob/master/hydra-test .el](https://github.com/abo-abo/hydra/blob/master/hydra-test.el)

Wiki 还有更多有用的示例[https://github.com/abo-abo/hydra/wiki/Hydras-by-Topic](https://github.com/abo-abo/hydra/wiki/Hydras-by-Topic)

Hydra 最初只有一种相当不透明的隐喻语法，因此很难入门。我不确定为什么要使用从颜色到神话故事和许多头被“征服”的怪物的这种奇怪的双层隐喻来描述本质上是：

*   采取行动并保持在关键模式（实际上是您所要求的。）（所谓的`blue`hydra）
*   执行操作并退出按键模式（`red`九头蛇）

等等。

值得庆幸的是，在 2015 年 2 月添加了更文字的语法，检查测试以并排查看颜色和文字语法。（也是这个提交[https://github.com/abo-abo/hydra/commit/0a3cc60f5856eb4a38204b9075d67d058ba56bef](https://github.com/abo-abo/hydra/commit/0a3cc60f5856eb4a38204b9075d67d058ba56bef)）

另见作者的这篇文章。[http://oremacs.com/2015/02/02/colorful-hydrae/](http://oremacs.com/2015/02/02/colorful-hydrae/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T18:51:05.227

如果键和弦不是您正在寻找的（正如您在对[汤姆的回答](https://stackoverflow.com/a/11939314/391315)的评论中建议的那样），那么您似乎想要一个`define-key`使用键序列的简单。IE

```
(define-key dired-mode-map (kbd "s j") 'dired-previous-line) 
```

这具有禁用`s`键的原始功能的缺点，但我想您可以将其重新绑定到序列`s`- `s`。****

# javascript - 无法在 Python 中的 AJAX 上使用 javascript

> ID：11939245
> 
> 赞同：3
> 
> 时间：2012-08-13T17:25:04.013
> 
> 标签：javascript, jquery, html, ajax

我有一个使用 AJAX 的 HTML 程序。AJAX 的 responseText 将打印在 DIV 上。在那个 DIV 里面已经存在一个`<input tpe="text value="" id="fechaD" />`. 我有一个在单击输入时调用的 JQuery 函数。很明显，那个输入会被AJAX的responseText代替，所以我在responseText上又加了一遍。问题来了，现在 JQuery 不起作用。

我不知道`<script type="text/javascript">`带有jQery函数的是否应该在DIV之外，所以它不会被AJAX的响应替换，或者应该作为responseText再次添加。我已经尝试了两者并且不会工作。

我在没有使用 jQuery 的情况下尝试过这个并且它可以工作，所以我认为这应该与我在 jQuery 中的函数有关，但我的问题是我没有编写该函数，因为我对 jQuery 一无所知。

这是在 onclicked 中输入时起作用的 jQuery 函数：

（该函数查找 ID="fechaD" 并显示一个日历。当用户选择任何日期时，该日期将显示为输入的值。使用 AJAX 后，它不会检测到新的 ID="fechaD" 输入）。

```
 <script type="text/javascript">
        jQuery(function($){
            $.datepicker.regional['es'] = {
                monthNames: ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'],
                dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','S&aacute;'],
            };
            $.datepicker.setDefaults($.datepicker.regional['es']);
        });    
        $(document).ready(function() {
                $("#fechaD").datepicker();
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:30:46.333

如果您替换`#fechaD`输入，则新输入将不再具有`datepicker`与之关联的实例。

要解决它，您可以：

1.  `$('#fechaD').datepicker();`替换后再次调用（创建一个新的 datepicker 实例）；
2.  将`#fechaD`输入移到要替换的区域之外（推荐）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:31:28.950

看起来你有两个 $(document).ready 函数。$(函数() { }); 与 $(document).ready 相同。jQuery(function($){}); 也是如此。

也许尝试将它们结合起来。

```
 <script type="text/javascript">  
            $(document).ready(function() {
                $.datepicker.regional['es'] = {
                    monthNames:   ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'],
                    dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','S&aacute;'],
                };
                $.datepicker.setDefaults($.datepicker.regional['es']);

                $("#fechaD").datepicker();
            });
        </script> 
```

# c# - C# 组合数据绑定到空 Guid 显示 00000000-0000-0000-0000-000000000000

> ID：11939248
> 
> 赞同：1
> 
> 时间：2012-08-13T17:25:18.727
> 
> 标签：c#, winforms

嗨，我有一个带有 3 个选项的 Combo 窗体，其中它们的值是 Guid，并且具有与所选对象的 DataBinding。

```
EmployerMemberDefault item = EmployerMemberDefault();
item.GroupUid = Guid.Empty;

cbGroupEmployer.DataBindings.Clear();
cbGroupEmployer.DataBindings.Add("Value", item, "GroupUid"); 
```

当我创建一个新对象时，数据绑定到组合的属性设置为 Guid.Empty。如果我编译并运行，当我创建该新对象时，我会在组合中看到“00000000-0000-0000-0000-000000000000”。有什么方法可以在组合中看到空文本而不是 Guid.Empty 值？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:29:28.567

“00000000-0000-0000-0000-000000000000”是 Guid.ToString 返回的内容。要显示不同的东西，您必须以某种方式翻译该值——即绑定到存储 guid 并翻译它的其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:39:22.800

将源属性从更改`Guid`为`Guid?`/`Nullable<Guid>` 我没有使用 Guid 完成此操作，但它适用于`int`/`DateTime`和其他不允许 null 的类型。

# ruby-on-rails - 拉布尔和看门 人

> ID：11939254
> 
> 赞同：0
> 
> 时间：2012-08-13T17:25:46.330
> 
> 标签：ruby-on-rails, api, rabl

我为我的 rails 项目开发 api，现在不知道如何解决这个问题

我使用`doorkeeper`gem 进行身份验证，使用`rabl`gem 进行 json 渲染。而且我必须为登录用户添加一些**字段**。

例如：部分`show.rabl`：

```
node :accessible, if: lambda { |m| current_user } do |model|
  model.accessible(current_user)
end 
```

并且`api/application_controller.rb`：

```
def current_user
  User.find(doorkeper_token.resource_owner_id) if doorkeper_token
end 
```

我也尝试过这种方式（`rabl`文件）：

```
if current_user
   node(:accessible) { |m| m.accessible(current_user) }
else
   {no: "no"} # this line rendered!!
end 
```

并且 rabl 对我的方法一无所知，并在`if`lambda 中返回 false。我怎么解决这个问题？我准备好接受任何建议。谢谢！

我用`rails-3.2.6 doorkeeper-0.4.2 rabl-0.6.13`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:34:44.060

你可以试试：

*   在控制器中设置实例变量而不是使用`current_user`
*   或无论用户是否登录都呈现不同的文件（并使用 rabl partial 以避免重复）

I'm also using rabl and doorkeeper so keep me up to date if you find a good solution ;) I might need to do the same soon.

# linux - 写入 /dev/uinput（在 ubuntu 12.04 上）

> ID：11939255
> 
> 赞同：4
> 
> 时间：2012-08-13T17:25:54.770
> 
> 标签：linux, input, ubuntu-12.04

我正在开发一个在 linux 上创建虚拟操纵杆的小程序，带有 python 前端。它是[Linux-Virtual-Joystick](https://github.com/ml32/Linux-Virtual-Joystick)的一个分支。

我需要写入 dev/uinput 以创建用户定义的操纵杆。该文件使用 O_RDWR 打开（我在调试时临时添加了其他文件的读/写访问权限）。当我做

```
write(uifd, &uidev, sizeof(uinput_user_dev)); 
```

它返回 -1 并将 errno 设置为 22(EINVAL)。参数正确，文件已成功打开。

有没有其他人遇到过这个问题？我将这个项目搁置了大约一个月，但我记得它在 Ubuntu 的最新版本中工作。

**更新：** uinput 适用于 ubuntu 12.10

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T18:52:17.460

我认为您遇到的问题是访问权限`uinput`。您收到的错误消息是典型的，我之前在其他设备上看到过相同的行为。

为了测试该假设，更改`/dev/uinput`权限以允许访问所有人：

```
chmod +0666 /dev/uinput 
```

然后再试一次你的代码。如果现在它工作正常，您将需要将该更改永久化，否则它将在重新启动后恢复为原始权限。

要以安全的方式执行此操作，请添加一个位于以下位置的规则文件：`/etc/dev/rules.d`

使用以下行：

```
KERNEL=="uinput", GROUP="udev_group" 
```

要查看规则文件的外观，请检查位于以下位置的 udev 规则文件：

```
/lib/udev/rules.d/50-udev-default.rules 
```

准备就绪后，添加一个名为 udev_group 的组并将您的用户名添加到其中（或任何应该具有写入权限的用户`uinput`）。

您可能需要重新启动才能使新规则生效。

结果将是该组成员的任何用户都将拥有对 的完全访问权限`uinput`，这正是您想要的。

* * *

要添加组，您可以安装“用户和组”：

```
sudo apt-get install gnome-system-tools 
```

并在以下位置启动它：

```
Application -> System Tools -> Administration -> Users and Groups** 
```

或在终端：

```
gnome-system-tools 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T23:18:50.443

我在 Ubuntu 14.04 中也遇到了这个错误，来自你的仓库（[https://github.com/ferry-/Linux-Virtual-Joystick-cpp](https://github.com/ferry-/Linux-Virtual-Joystick-cpp)）。我通过将 device.h 中设备构造函数中的 device::uidev 成员清零来修复它。

memset(&uidev, 0, sizeof(uidev));

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T23:24:19.187

由于缺少 uinput 模块，您应该考虑在继续之前构建它。

我从来没有用这种方式重建过 Linux 内核模块，所以你可以按照[这里的解释](https://stackoverflow.com/questions/11771818/how-to-make-existing-linux-kernel-module-driver-after-modifying-the-driver-sou/11804929#11804929)

首先，您需要获取相应的 Linux 源代码和头文件。同时安装*module-init-tools*
然后，将 dir 更改为 /usr/src/linux 并以 root 身份执行

```
cp /boot/config-* ./.config
make drivers/input/misc/uinput.ko 
```

构建 uinput.ko 需要几分钟

在将 uinput.ko 移动到 /lib/modules/<"yourkernelversion">/kernel/drivers/input/misc 之前检查它是否有效

```
insmod ./drivers/input/misc/uinput.ko 
```

* * *

## 编辑1：

似乎从 Linux 2.6.35-17.23 开始，[uinput 是一个内置模块](https://bugs.launchpad.net/ubuntu/+source/bluez/+bug/584812)。这就是[lsmod 不显示它](http://ubuntuforums.org/showthread.php?t=1369602)的原因。

我刚刚看了你的代码，我认为问题出在这一行

```
if (write(uifd, &uidev, sizeof(uinput_user_dev) != sizeof(uinput_user_dev))) 
```

它应该是

```
if (write(uifd, &uidev, sizeof(uinput_user_dev)) != sizeof(uinput_user_dev)) 
```

希望有帮助

# jquery - 仅隐藏父元素的子元素

> ID：11939261
> 
> 赞同：0
> 
> 时间：2012-08-13T17:26:25.980
> 
> 标签：jquery, select, parent, siblings

我的`hide_fields()`功能有问题。我试图隐藏所有“*行布局字段*” `<div>`-s，然后显示与`<select>`.

根据您从 中选择的内容`<select>`，应显示某些字段。

其中有几行，问题是，如果我有 3 行，当我从任何`<select>`-s 中选择 on 选项时，它会隐藏所有的字段。

代码粘贴在下面。

标记来自使用 ACF 的 Wordpress 管理员，所以它非常强烈，但是，如果您需要查看它，可以在这里找到：http: [//pastie.org/4467255](http://pastie.org/4467255)

```
(function($) {

    // hide_fields / a small function to hide all the conditional fields
    function hide_fields() {
        $('#acf-content_repeater table tbody tr.row td div.row-layout-field:nth-child(1n+2)').hide();
    }

    // Document Ready
    $(document).ready(function() {

        // hide all fields
        hide_fields();

        // trigger change on the select field to show selected field
        $('#acf-content_repeater table tbody tr.row td div.row-layout-field select').trigger('change');

    });

    // Hero Type change
    $('#acf-content_repeater table tbody tr.row td div.row-layout-field select').live('change', function() {

        // vars
        var value = $(this).val();

        // hide all fields
        hide_fields();

        // show the selected field
        if( value == "image" ) {
            // console.log( $(this).parent().parent().find('div.row-layout-field:nth-child(2)') );
            $(this).parent().parent().find('div.row-layout-field:nth-child(2)').show();
            $(this).parent().parent().find('div.row-layout-field:nth-child(3)').show();
            $(this).parent().parent().find('div.row-layout-field:nth-child(4)').show();
        }
        else if( value == "video" ) {
            $(this).parent().parent().find('div.row-layout-field:nth-child(4)').show();
            $(this).parent().parent().find('div.row-layout-field:nth-child(5)').show();
        }
        else if( value == "tweet" ) {
            $(this).parent().parent().find('div.row-layout-field:nth-child(5)').show();
            $(this).parent().parent().find('div.row-layout-field:nth-child(6)').show();
        }
        else if( value == "statistic" ) {
            $(this).parent().parent().find('div.row-layout-field:nth-child(6)').show();
            $(this).parent().parent().find('div.row-layout-field:nth-child(7)').show();
        }

    });

})(jQuery); 
```

感谢您的任何帮助。

编辑：

我设法实现了我所需要的： http: [//pastie.org/4467732](http://pastie.org/4467732)

也许不是最优雅的，但它确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:47:50.273

您可以使用 parent 隐藏元素父级的特定子级并找到

```
 $(this).parent().find('.row-layout-field').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:39:49.147

我有点傻，我将我的答案添加到我原来的帖子中，而不是回答我自己的问题......这是上面的内容：

我设法实现了我所需要的： http: [//pastie.org/4467732](http://pastie.org/4467732)

也许不是最优雅的，但它确实有效。

# django - django-rosetta 有组权限吗？

> ID：11939266
> 
> 赞同：1
> 
> 时间：2012-08-13T17:27:00.643
> 
> 标签：django

是否有机会为 django-rosetta 设置权限组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:48:47.250

你不能做细粒度的权限，但看起来你[可以控制谁可以使用名为 'translators' 的组来贡献翻译](https://github.com/mbi/django-rosetta#security)。

# backbone.js - 页面加载后，骨干网立即导航到基本 URL

> ID：11939270
> 
> 赞同：4
> 
> 时间：2012-08-13T17:27:15.377
> 
> 标签：backbone.js, backbone-routing

我一直面临主干路由的这个问题，并认为我已经花了足够的时间调查：

这里有两个 url：/ 和 /post/:id。/ 页面通过 /post/:id 链接到各种帖子。当我单击帖子链接时，帖子页面会加载，但骨干网会立即将 url 更改为 /。这不仅看起来很糟糕，而且还会在错误的时间触发路由处理程序。我没有做任何特别的事情......这是我的代码：

```
PostRouter = Backbone.Router.extend({
        routes : {
            "" : "doHome"
        },
        initialize : function() {

        },
        doHome : function() {
                    // do some stuff before navigating
            window.location = "/";
        }
})

...

var router = new PostRouter();
Backbone.history.start({ pushState: Modernizr.history }); 
```

同样，在帖子页面加载后立即调用 doHome 函数。显然，这会导致站点导航回主页。我显然可以删除对 window.location 的调用以防止这种情况发生，但 url 仍会更新为根 url，这是不可接受的。

提前致谢！

**更新 1：**

如果我直接转到“localhost:808/post/:id”，则 url 立即更改为“localhost:8080/”。但是，如果我在私人浏览器窗口中执行完全相同的操作，则不会观察到这种行为。

**更新 2：**

鉴于我在更新 1 中发现的情况，我发疯了，从头开始：我清除了 4 周的浏览历史记录（叹气），停止本地服务器并清理所有持久会话并重新部署我的应用程序。唉，它奏效了！也就是说，我没有将此列为解决方案，因为它无助于解释究竟发生了什么以及如何解决它。此外，这让我担心我网站的用户会发生这种情况。我无法告诉他们发生了这种情况，即使我这样做了，我也无法告诉他们如何最终修复它（清除 4 周的浏览器历史记录不是一种选择！）。任何人都可以对可能发生的事情有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T09:27:48.390

你为什么不尝试添加

```
console.log(Backbone.history.handlers); 
```

最后看看，你的溃败是如何添加到 Backbone.history 中的。这可能会有所启发。

# c# - 如何在 Windows CE 中制作自定义软输入面板 (SIP)？

> ID：11939272
> 
> 赞同：2
> 
> 时间：2012-08-13T17:27:28.067
> 
> 标签：c#, windows-ce, soft-input-panel

如何使用 C#.Net 在 Windows CE 中制作自定义软输入面板 (SIP)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:41:02.363

你不能。一个真正的 SIP 必须向操作系统注册自身并具有一些特定的本机 COM 入口点 ( [IInputMehod](http://msdn.microsoft.com/en-us/library/ms929953.aspx) )。由于 Compact Framewortk 不支持 EE Hosting，因此无法实现。

Doug Boling 在他的书（第 15 章）中有一个 SIP[示例，MSDN 上的示例章节](http://www.microsoft.com/mspress/books/sampchap/5461b.aspx)实际上展示了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:39:24.877

`IInputMethod`您可以实现一个实现(http://msdn.microsoft.com/en-us/library/ms929953.aspx) 和可选`IInputMethod2`(http://msdn.microsoft.com/en-us/library/ms929954)的 COM 对象.

# android - OnListIemClick 为每一行设置可见性

> ID：11939273
> 
> 赞同：1
> 
> 时间：2012-08-13T17:27:28.787
> 
> 标签：android, listview, row, visibility

我试图显示一个列表，当我在那个位置按下它时，我想显示一个已经消失的图像并更改该行的字体。所以首先我有一个带有简单列表的 xml 文件，然后是每一行的另一个 xml，这个：

```
<ImageView
    android:id="@+id/icono"
    android:layout_gravity="center"
    android:layout_marginRight="5dip"/>

<RelativeLayout
    android:id="@+id/RelativeLayout1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_centerVertical="true"
        android:text="TextView" />

    <ImageView
        android:id="@+id/image_tick_ingred"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="false"
        android:layout_alignParentLeft="false"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="false"
        android:layout_alignRight="@id/textView1"
        android:layout_centerVertical="true"
        android:src="@android:drawable/presence_online" />
</RelativeLayout> 
```

这就是每一行的代码，左侧包含一个图像，然后是文本，最后是行右侧的另一个图像。和java代码：

```
public class TabIngred extends ListActivity {

    ImageView img;

public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.rellenas_ingr); //the list xml layout

        Bundle extras = getIntent().getExtras(); //get data
        if (extras != null) {
            String ingredientesLista[] = extras.getStringArray("ingredientesLista");
            int[] ingredientesImagen=extras.getIntArray("ingredientesImagen");

            setListAdapter (new IngredienteAdapter(this, R.layout.rellenas_ingr_fila, ingredientesLista, ingredientesImagen));
            getListView().setChoiceMode(2);
        }

}

private class IngredienteAdapter extends ArrayAdapter<String>{

    private String listaIngred[];
    private int[] listaImagenes;

    public IngredienteAdapter(Context context, int textViewResourceId, String ingredientesLista[], int[] ingredientesImagen) {
        super(context, textViewResourceId, ingredientesLista);
        this.listaIngred = ingredientesLista;
        this.listaImagenes=ingredientesImagen;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            // XML de la vista de la fila
            v = vi.inflate(R.layout.rellenas_ingr_fila, null); //the row for the listview
        }
        String ingred = listaIngred[position];
        int imagen=listaImagenes[position];
        int tickImagen = R.drawable.tick_ingred;//set the image to a tick 

        if (ingred != null) {
            TextView ttitulo = (TextView) v.findViewById(R.id.textView1);
            if (ttitulo != null) {
                ttitulo.setText(ingred);
            }
            ImageView timagen = (ImageView) v.findViewById(R.id.icono);
            if (timagen != null) {
                timagen.setImageResource(imagen);
            }
            ImageView ttick = (ImageView) v.findViewById(R.id.image_tick_ingred);
            if (ttick != null) {
                ttick.setImageResource(tickImagen);
                ttick.setVisibility(View.GONE);
            }
        }   
        return v;
    }
}

 @Override
 public void onListItemClick(ListView l, View v, int position, long id) {

     img=(ImageView)v.findViewById(R.id.image_tick_ingred);
     TextView t= (TextView)v.findViewById(R.id.textView1);

     if(img.getVisibility()==View.GONE){

         t.setTypeface(null, Typeface.BOLD);
         img.setVisibility(View.VISIBLE);

     }else {
         t.setTypeface(null, Typeface.NORMAL);
         img.setVisibility(View.GONE);

     }
 }
} 
```

所以，我定义了 getview()，我把图像放在了消失（这有效），但是 OnlistItemClick() 不起作用。首先，当我选择一个项目时，图像不可见并且分开，因为我按下第一行的位置改变了字体，而不是我按下的项目。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T15:41:57.413

问题是我定义了 getListView().setChoiceMode(2); 那是因为它不起作用，我删除了这条线并且完美无缺！

毕竟谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:33:32.110

你`onListItemClick`需要使用`View`

例如：

```
img=(ImageView)findViewById(R.id.image_tick_ingred);
 TextView t= (TextView)findViewById(R.id.textView1); 
```

应该

```
img=(ImageView)v.findViewById(R.id.image_tick_ingred);
 TextView t= (TextView)v.findViewById(R.id.textView1); 
```

注意`v`那是点击的行的视图

# saml-2.0 - SAML 异常 预期目标端点不匹配

> ID：11939275
> 
> 赞同：2
> 
> 时间：2012-08-13T17:27:35.253
> 
> 标签：saml-2.0

客户端尝试使用 SAML 将 SSO 引入我们的应用程序，而我们的应用程序抛出 followimg 异常

org.opensaml.xml.security.SecurityException：SAML 消息预期目标端点与接收端点不匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:27:35.253

此异常的原因是断言客户端发送给我们的 Response 元素中缺少 Destination 属性。响应需要类似于：

```
<Response xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" ID="_a8590dae-831c-4142-9fc9-a15f60e972a0" Version="2.0" IssueInstant="2012-02-22T17:08:57Z" Destination="https://client.ourapp.com/product/AssertionConsumer" xmlns="urn:oasis:names:tc:SAML:2.0:protocol"> 
```

Destination 属性需要包含我们的断言消费者 url。

# php - 重置按钮边框

> ID：11939279
> 
> 赞同：1
> 
> 时间：2012-08-13T17:27:47.523
> 
> 标签：php, html, css, button

我开始觉得这是我做错了什么，因为我找不到其他人遇到这个问题，所以我请求你们开发人员的帮助！提前致谢！

重置按钮周围有一个我想删除的边框。这很奇怪，因为我的提交按钮没有：

```
<div class="contact-submit">
    <input type="image" src="images/submit-btn.png" width="93" height="33" value="Send Message">
    <button type="reset"> 
        <img src="images/reset-btn.png" width="93" height="33"/> 
    </button> 
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:04:44.060

该按钮看起来像一个按钮，因为它是一个按钮。要更改此外观，您将使用自己的 CSS 样式覆盖浏览器按钮样式：

**CSS**

```
button {
    background-color: transparent;
    border: medium none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:50:24.913

好的，我查看了您的页面源代码。在 HTML 中，您的提交按钮实际上不是一个按钮，它是一个输入图像：

```
<div class="contact-submit">
<input type="image" src="images/submit-btn.png" width="93" height="33" value="Send Message"> 
<button type="reset"> 
<img src="images/reset-btn.png" width="93" height="33"/>
</button> 
</div> 
```

另一方面，重置按钮实际上是一个按钮。如果您将其更改为输入图像，例如提交按钮，它应该看起来相同。请参阅下面的代码：

```
<div class="contact-submit">
<input type="image" src="images/submit-btn.png" width="93" height="33" value="Send Message"> 
<input type="image" src="images/reset-btn.png" width="93" height="33"/>
</div> 
```

我不确定您是如何处理点击事件的，但您似乎只需要添加`value="Reset"`或将其设置为该输入元素。

# plsql - SSIS - 将 Oracle 日期转换为 SQL 日期时间

> ID：11939285
> 
> 赞同：3
> 
> 时间：2012-08-13T17:28:05.400
> 
> 标签：plsql, ssis

Oracle 11g SQL Server 2008 R2

尝试将数据从 OLE DB 源 (Oracle DB) 移动到 OLE DB 目标 (SQL Server) 时，我收到以下错误。在出现错误之前，有 65000 条记录中的 8922 条已添加到 SQL 服务器。8922 的日期列确实在应该添加的日期。Oracle 上的列是 DATE 类型。SQL Server 2008 上的列是日期时间。

```
On the SQL Server, for record # 8922 the RSVP_END_DT = 2007-06-25 12:06:00.000
On the Oracle Server for record # 8922 the RSVP_END_DT = 25-JUN-07
On the Oracle Server, for what should be record # 8923 in the SQL DB, the RSVP_END_DT = 10-AUG-07 
```

我已经搜索了每个“DTE_E”错误，但没有发现任何帮助。我还尝试使用数据转换并编写源 SQL 将日期设置为具有正确 SQL 格式的“to_char”，但这也不起作用。有人有其他建议吗？

```
[OLE DB Destination [424]] Error: SSIS Error Code DTS_E_OLEDBERROR.  An OLE DB error has occurred. Error code: 0x80040E21.
An OLE DB record is available.  Source: "Microsoft SQL Server Native Client 10.0"  Hresult: 0x80040E21  Description: "Multiple-step OLE DB operation generated errors. Check each OLE DB status value, if available. No work was done.".

[OLE DB Destination [424]] Error: There was an error with input column "RSVP_END_DT" (487) on input "OLE DB Destination Input" (437). The column status returned was: "Conversion failed because the data value overflowed the specified type.".

[OLE DB Destination [424]] Error: SSIS Error Code DTS_E_INDUCEDTRANSFORMFAILUREONERROR.  The "input "OLE DB Destination Input" (437)" failed because error code 0xC020907A occurred, and the error row disposition on "input "OLE DB Destination Input" (437)" specifies failure on error. An error occurred on the specified object of the specified component.  There may be error messages posted before this with more information about the failure.

[SSIS.Pipeline] Error: SSIS Error Code DTS_E_PROCESSINPUTFAILED.  The ProcessInput method on component "OLE DB Destination" (424) failed with error code 0xC0209029 while processing input "OLE DB Destination Input" (437). The identified component returned an error from the ProcessInput method. The error is specific to the component, but the error is fatal and will cause the Data Flow task to stop running.  There may be error messages posted before this with more information about the failure.

[OLE_DB_SOURCE[1]] Error: The attempt to add a row to the Data Flow task buffer failed with error code 0xC0047020.

[SSIS.Pipeline] Error: SSIS Error Code DTS_E_PRIMEOUTPUTFAILED.  The PrimeOutput method on component "OLE_DB_SOURCE" (1) returned error code 0xC02020C4\.  The component returned a failure code when the pipeline engine called PrimeOutput(). The meaning of the failure code is defined by the component, but the error is fatal and the pipeline stopped executing.  There may be error messages posted before this with more information about the failure. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:45:10.903

这是我之前关于这个主题的三个答案。您很可能超出了带有该错误消息的 Sql Server 日期范围。我在最后一个答案中解释了 Datetime 和 datetime2 的不同限制。

[https://stackoverflow.com/a/11585853/236348](https://stackoverflow.com/a/11585853/236348)

[https://stackoverflow.com/a/2231164/236348](https://stackoverflow.com/a/2231164/236348)

[https://stackoverflow.com/a/11229159/236348](https://stackoverflow.com/a/11229159/236348)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:03:01.580

从 OLEDB 源获取数据时，将源日期列转换为指定格式，例如

```
YYYY MM DD
Select  TO_CHAR(DateColumn,'yyyy/mm/dd') as CustomDate from yourTable 
```

不确定本文提到的语法[而](http://infolab.stanford.edu/~ullman/fcdb/oracle/or-time.html)不是使用 To_Char 使用一些 oracle 预定义函数来获取正确格式的日期。在源数据进入 SSIS 管道以进一步丰富之前丰富或转换源数据总是更好

然后在派生列中将此字符串转换为您的 sql server 日期时间格式

```
convert(datetime, CustomDate , 111) 
```

在 SQl 服务器中，我会使用 isDate 函数检查列，或者尝试将值转换为特定格式

```
CASE WHEN isDate(DateColumn) = 1 THEN DateColumn ELSE NULL END as DateColumn
or
convert(datetime, '25-JUN-07', 106) -- dd.mm.yyyy 
```

# python - 在 Python 中解码 UTF-8 URL

> ID：11939286
> 
> 赞同：0
> 
> 时间：2012-08-13T17:28:11.493
> 
> 标签：python, utf-8, python-3.x, yaml, urldecode

我有一个像“pe%20to%C5%A3i%20mai”这样的字符串。当我对其应用 urllib.parse.unquote 时，我得到“pe to\u0163i mai”。如果我尝试将其写入文件，我会得到那些确切的符号，而不是预期的字形。

如何将字符串转换为 utf-8，以便在文件中我有正确的字形？

编辑：我正在使用 Python 3.2

Edit2：所以我发现它`urllib.parse.unquote`工作正常，而我的问题实际上是我正在序列化为 YAML，`yaml.dump`这似乎把事情搞砸了。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:51:44.970

**更新**：如果输出文件是 yaml 文档，那么您可以忽略`\u0163`它。Unicode 转义在 yaml 文档中有效。

```
#!/usr/bin/env python3
import json

# json produces a subset of yaml
print(json.dumps('pe toţi mai')) # -> "pe to\u0163i mai"
print(json.dumps('pe toţi mai', ensure_ascii=False)) # -> "pe toţi mai" 
```

注意：`\u`在最后一种情况下没有。这两行代表相同的 Python 字符串。

`yaml.dump()`有类似的选项：`allow_unicode`. 将其设置`True`为避免 Unicode 转义。

* * *

网址是正确的。你不需要对它做任何事情：

```
#!/usr/bin/env python3
from urllib.parse import unquote

url =  "pe%20to%C5%A3i%20mai"
text = unquote(url)

with open('some_file', 'w', encoding='utf-8') as file:
    def p(line):
        print(line, file=file) # write line to file

    p(text)                # -> pe toţi mai
    p(repr(text))          # -> 'pe toţi mai'
    p(ascii(text))         # -> 'pe to\u0163i mai'

    p("pe to\u0163i mai")  # -> pe toţi mai
    p(r"pe to\u0163i mai") # -> pe to\u0163i mai
    #NOTE: r'' prefix 
```

该`\u0163`序列可能由字符编码错误处理程序引入：

```
with open('some_other_file', 'wb') as file: # write bytes
    file.write(text.encode('ascii', 'backslashreplace')) # -> pe to\u0163i mai 
```

或者：

```
with open('another', 'w', encoding='ascii', errors='backslashreplace') as file:
    file.write(text) # -> pe to\u0163i mai 
```

更多示例：

```
# introduce some more \u escapes
b = r"pe to\u0163i mai ţţţ".encode('ascii', 'backslashreplace') # bytes
print(b.decode('ascii')) # -> pe to\u0163i mai \u0163\u0163\u0163
# remove unicode escapes
print(b.decode('unicode-escape')) # -> pe toţi mai ţţţ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:32:31.153

**蟒蛇 3**

调用`urllib.parse.unquote`已经返回一个 Unicode 字符串：

```
>>> urllib.parse.unquote("pe%20to%C5%A3i%20mai")
'pe toţi mai' 
```

如果你没有得到那个结果，那一定是你的代码有错误。请发布您的代码。

**蟒蛇2**

用于`decode`从字节串中获取 Unicode 字符串：

```
>>> import urllib2
>>> print urllib2.unquote("pe%20to%C5%A3i%20mai").decode('utf-8')
pe toţi mai 
```

请记住，当您将 Unicode 字符串写入文件时，您必须再次对其进行编码。您可以选择以 UTF-8 格式写入文件，但如果您愿意，也可以选择不同的编码。您还必须记住在从文件中读取时使用相同的编码。您可能会发现该`codecs`模块可用于在读取和写入文件时指定编码。

```
>>> import urllib2, codecs
>>> s = urllib2.unquote("pe%20to%C5%A3i%20mai").decode('utf-8')

>>> # Write the string to a file.
>>> with codecs.open('test.txt', 'w', 'utf-8') as f:
...     f.write(s)

>>> # Read the string back from the file.
>>> with codecs.open('test.txt', 'r', 'utf-8') as f:
...     s2 = f.read() 
```

一个可能令人困惑的问题是，在交互式解释器中，有时使用`\uxxxx`符号而不是实际字符来显示 Unicode 字符串：

```
>>> s
u'pe to\u0163i mai'
>>> print s
pe toţi mai 
```

这并不意味着该字符串是“错误的”。这只是解释器的工作方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T17:32:44.013

尝试`decode`使用`unicode_escape`.

例如：

```
>>> print "pe to\u0163i mai".decode('unicode_escape')
pe toţi mai 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T18:39:16.340

返回了一个正确的`urllib.parse.unquote`UTF-8 字符串，并将其直接写入返回的文件中得到了预期的结果。问题出在 yaml 上。默认情况下，它不使用 UTF-8 编码。

我的解决方案是：

`yaml.dump("pe%20to%C5%A3i%20mai",encoding="utf-8").decode("unicode-escape")`

感谢 JF Sebastian 和 Mark Byers 向我提出了正确的问题，帮助我解决了问题！

# haskell - Haskell，自己的数据类型，将元素添加到排序列表

> ID：11939288
> 
> 赞同：1
> 
> 时间：2012-08-13T17:28:24.287
> 
> 标签：haskell, types

具有极简变化的工作版本，感谢@Matt、Petr 和 Landei ！！！

```
insert :: (Ord el) => el -> Menge el -> Menge el
insert a (Menge (x:xs)) = ins a (Menge (x:xs)) (Menge [])

ins a (Menge []) (Menge ys) = Menge (ys ++ [a])
ins a (Menge xs@(x:xs')) (Menge ys)
       | a <  x     = Menge (ys ++ [a] ++ xs)
       | a >  x     = ins a (Menge xs') (Menge (ys ++ [x]))
       | otherwise  = Menge (ys ++ xs) 
```

* * *

有一个自己的数据类型 Menge，就像一个列表，我应该在正确的位置插入一个元素......

```
module Menge (
  Menge,
  empty,
  insert,
  ins
) where

data Menge el = Menge [el] deriving (Eq)

instance (Show el) => Show (Menge el) where
 show (Menge liste) = "{" ++ (elms liste) ++ "}"
     where
       elms :: (Show a) => [a] -> String
       elms [] = ""
       elms (x:[]) = show x
       elms (x:xs) = show x ++ ", " ++ elms xs

empty :: Menge el
empty = Menge []

insert :: (Ord el) => el -> Menge el -> Menge el
--insert a (Menge []) = (Menge [a]) 
insert a (Menge (x:xs)) = ins a (Menge (x:xs)) (Menge [])

ins a (Menge []) (Menge (y:ys)) = (Menge ((y:ys) ++ [a]))
ins a (Menge (x:xs)) (Menge (y:ys)) 
       | a <  x = (Menge ((y:ys) ++ [a] ++ (x:xs)))
       | a >  x = ins a (Menge xs) (Menge ((y:ys) ++ [x]))
       | a >  x && xs == [] = error "same function as: ins a empty (Menge (y:ys))"
       | a == x = (Menge ((y:ys) ++ (x:xs)))
       | otherwise = error "blabla" 
```

我输入：`insert 2 (Menge ([1,3]))`，在我看来，我应该像这样工作：

```
--> ins 2 (Menge (1:3)) empty --> 2 > 1 --> ins 2 (Menge [3]) (Menge [] ++ [1])
--> ins 2 (Menge [3]) (Menge [1]) --> 2 < 3 --> (Menge ([1] ++ [2] ++ [3])) --> [1,2,3] 
```

但相反，我得到：“函数 ins 中的非详尽模式”

如果我输入相同的错误：`ins 2 (Menge ([1,3])) (Menge [])`，所以第一步工作。似乎编译器不喜欢“empty”/“(Menge [])”，因为如果我输入: `ins 2 (Menge ([1,3])) (Menge [1,3])`，我会得到`{1, 3, 2}`答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:50:56.750

我看到两个主要问题`ins`：

1.  看来您正在尝试使用`empty`- 的值进行模式匹配，这是行不通的。Any `Menge`，包括具有非空列表的列表，都将匹配，因为`empty`这里用作函数的本地绑定（隐藏您的其他绑定）。所以你需要：

    ```
    ins a (Menge []) (Menge (y:ys)) = ... 
    ```

    这个问题的一个症状是我的haskell安装`pattern match(es) are overlapped`在我加载你的代码时给了我一个警告。这基本上意味着你有一些死代码。

2.  当第三个参数是时，您的模式不匹配`Menge []`- 我认为这是给出您显示的消息的错误（尽管我不确定，因为您没有给出整个错误消息）。你的两个方程只匹配非空列表。

    例如：

    ```
    ghci> ins x (Menge []) (Menge []) 
    ```

    不会匹配任何模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:06:21.717

我试图`insert`从头开始实施。首先，我添加了函数以使[解构](http://www.haskell.org/haskellwiki/Newtype)`unmenge`值更容易，并且还将您的`Menge`声明修改为新类型（只是性能优化 - 这样，它实际上不会在运行时创建新的数据构造函数）。

```
newtype Menge el = Menge { unmenge :: [el] }
  deriving (Eq) 
```

现在，`insert`函数可以写成如下：

```
insert :: (Ord el) => el -> Menge el -> Menge el
insert a (Menge []) = (Menge [a]) 
insert a (Menge xs@(x:xs'))
    | a <= x    = Menge (a : xs)
    | otherwise = Menge (x : unmenge (insert a (Menge xs'))) 
```

如果`a`小于列表中的第一项，则只是在前面添加。如果不是，则它是`x`最小的数，因此将其放在第一位，然后`a`递归地插入到其余数中。

请注意，此解决方案不是[尾递归](http://www.haskell.org/haskellwiki/Tail_recursion)的。

更简单的解决方案是使用`span`函数：

```
insert :: (Ord el) => el -> Menge el -> Menge el
insert a (Menge xs) = let (smaller, bigger) = span (<= a) xs
                        in Menge (smaller ++ [a] ++ bigger) 
```

* * *

**编辑：**您更正的代码似乎按预期工作。我把它简化了一点，但我没有改变任何实质性的东西：

```
insert :: (Ord el) => el -> Menge el -> Menge el
insert a (Menge (x:xs)) = ins a (Menge (x:xs)) (Menge [])

ins a (Menge []) (Menge ys) = Menge (ys ++ [a])
ins a (Menge xs@(x:xs')) (Menge ys)
       | a <  x     = Menge (ys ++ [a] ++ xs)
       | a >  x     = ins a (Menge xs') (Menge (ys ++ [x]))
       | otherwise  = Menge (ys ++ xs) 
```

一些改进的想法：

*   看看[as-patterns](https://en.wikibooks.org/wiki/Haskell/Pattern_matching#As-patterns)（我在这里使用过它们）。
*   在列表末尾添加一个元素具有*O(n)*复杂性 - 必须重新计算整个列表。最好以相反的顺序保持列表并仅在最后修复它：

    ```
    ins a (Menge []) (Menge ys) = Menge (reverse ys ++ [a])
    ins a (Menge xs@(x:xs')) (Menge ys)
           | a <  x     = Menge (reverse (a : ys) ++ xs)
           | a >  x     = ins a (Menge xs') (Menge (x : ys))
           | otherwise  = Menge (reverse ys ++ xs) 
    ```

*   有一个称为[Data.Set](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Set.html)的数据结构可以满足您的需要：使用二叉树保存已排序的元素集。大多数操作具有*O(1)*或*O(log n)*复杂度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T07:45:32.057

我的看法：

```
insert :: (Ord el) => el -> Menge el -> Menge el
insert a mx = merge (Menge [a]) mx 

merge :: (Ord el) => Menge el -> Menge el -> Menge el
merge mx (Menge []) = mx  
merge (Menge []) my = my
merge (Menge (x:xs)) (Menge (y:ys)) 
  | x == y = merge (Menge xs) (Menge (y:ys))   
  | x < y = merge (Menge xs) (Menge (x:y:ys))
  | x > y = let Menge zs = merge (Menge (x:xs)) (Menge ys) 
            in Menge (y:zs) 
```

# windows - 如何确定我的程序是否已经加载了某个 DLL？

> ID：11939290
> 
> 赞同：3
> 
> 时间：2012-08-13T17:28:33.380
> 
> 标签：windows, winapi

我正在开发一个基于插件架构的程序。所有插件都是 DLL，其中一些可以依赖于其他插件 DLL。我希望能够做到以下几点：

*   在程序启动时，扫描插件文件夹。
*   对于找到的每个插件，检查该插件是否已加载。（可能是，如果先前加载的插件导致它作为依赖项加载）。
*   如果没有，请加载它。

第一步和第三步是微不足道的，但我该怎么做第二步呢？是否有一个 winapi 调用，给定一个 DLL 的文件名，它会告诉我该 DLL 当前是否已加载到当前进程中？（或者也许一个需要文件名和进程句柄的？）

拜托，没有答案说“无论如何都加载它”。我知道这会奏效。我试图避免这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:33:44.033

`GetModuleHandle`API 为您`HMODULE`提供已加载的 DLL，如果未加载，则为 NULL。请注意，如果需要，您可以省略路径。您也可以获取`HMODULE`一个没有路径的名称，然后`GetModuleFileName`使用此句柄来获取完整路径以与您期望的进行比较。

> 如果 lpModuleName 不包含路径并且有多个加载的模块具有相同的基本名称和扩展名，则您无法预测将返回哪个模块句柄。要解决此问题，您可以指定路径、使用并行程序集或使用 GetModuleHandleEx 指定内存位置而不是 DLL 名称。
> 
> GetModuleHandle 函数返回映射模块的句柄，而不增加其引用计数。但是，如果将此句柄传递给 FreeLibrary 函数，则映射模块的引用计数将递减。因此，不要将 GetModuleHandle 返回的句柄传递给 FreeLibrary 函数。这样做会导致 DLL 模块过早地被取消映射。

也可以在进程中枚举加载的库`EnumProcessModules`，但对于您描述的任务来说可能有点过头了。如果没有`PSAPI`.

# opengl - 使用 IBO 制作动画 - 好还是坏？

> ID：11939295
> 
> 赞同：2
> 
> 时间：2012-08-13T17:29:05.400
> 
> 标签：opengl, opengl-es

我只是看着我的动画精灵代码，并得到一些想法。
动画是通过改变 tex 坐标制作的。它有缓冲区对象，它保存当前帧纹理坐标，当新帧请求时，新的纹理坐标由**glBufferData()**输入缓冲区。

如果我们预先计算所有动画帧的纹理坐标，将它们放在 BO 中并创建只有一些帧的索引缓冲区对象，我们需要绘制

```
 GLbyte cur_frames = 0; //1,2,3 etc 
```

现在，当我们需要更新动画时，我们只需要使用 glBufferData 更新 IBO 帧的 1 个字节（而不是 4 / *quad vertex count* / * 2 / *s, t* / * sizeof(GLfloat) bytes 用于使用 TRIANGLE_STRIP 进行四边形绘制） ，我们不需要在我们的 BO 初始化后保存任何纹理坐标。

我错过了什么？什么是反派？

**编辑：**当然，例如，您的顶点数据可能不是 gl_float 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T22:59:35.117

正如 Tim 正确指出的那样，这取决于您的应用程序，让我们谈谈一些数字，您提到了 IBO*和*将所有帧的纹理坐标插入到一个 VBO 中，所以让我们来看看每一个的影响。

假设一个典型的顶点如下所示：

```
struct vertex
{
    float x,y,z; //position
    float tx,ty; //Texture coordinates
} 
```

我添加了一个 z 组件，但如果您不使用它，或者如果您有更多属性，则计算是相似的。所以很明显这个属性需要 20 个字节。

让我们假设一个简单的精灵：一个四边形，由 2 个三角形组成。在非常幼稚的模式下，您只需发送 2x3 顶点并将`6*20=120`字节发送到 GPU。

![三角四边形](../Images/d2d78f19eb703c8327a8d80cd1be74de.png)

在索引中，你知道你实际上只有四个顶点：`1,2,3,4`和两个三角形`1,2,3`和`2,3,4`。所以我们向 GPU 发送两个缓冲区：一个包含 4 个顶点（`4*20=80`字节），一个包含三角形的索引列表（`[1,2,3,2,3,4]`），假设我们可以在 2 个字节中执行此操作（65535 个索引应该足够了），所以这就下来了`6*2=12`字节。在总`92`字节中，我们节省了`28`大约 byte `23%`。此外，当渲染 GPU 可能[只在顶点着色器中处理每个顶点一次时](http://www.opengl.org/wiki/Post_Transform_Cache)，它也为我们节省了一些处理能力。

所以，现在您想一次为所有动画添加所有纹理坐标。首先要注意的是，索引渲染中的顶点由它的所有属性定义，您不能将其拆分为位置索引和纹理坐标索引。所以如果你想添加额外的纹理坐标，你将不得不重复这些位置。因此，您添加的每个“帧”都会将`80`字节添加到 VBO 并将`12`字节添加到 IBO。假设你有 64 帧，你最终得到`64*(80+12)=5888`字节。假设你有 1000 个精灵，那么这将变成 about `6MB`。这似乎并不算太​​糟糕，但请注意它的缩放速度非常快，每一帧都会增加大小，而且还会增加每个属性（因为它们必须重复）。

那么，它能给你带来什么？

1.  您不必动态地将数据发送到 GPU。请注意，更新整个 VBO 需要发送`80`字节或`640`位。假设您需要以每秒帧数对`1000`每帧精灵执行此操作`30`，您将达到`19200000`bps 或`19.2Mbps`（不包括开销）。这是相当低的（例如 16xPCI-e 可以处理`32Gbps`），但如果您有其他带宽问题（例如由于纹理），它可能是值得的。此外，如果您仔细构建您的 VBO（例如，单独的 VBO 或非交错的），您可以将其减少为仅更新纹理部分，`16`在上面的示例中每个精灵只有一个字节，这可能会进一步减少带宽。
2.  您不必浪费时间计算下一帧位置。然而，这通常只是一些添加，很少有处理纹理边缘的方法。我怀疑你会在这里获得很多 CPU 能力。

最后，您还可以将动画图像简单地分割成许多纹理。我完全不知道它是如何缩放的，但在这种情况下，您甚至不必使用更复杂的顶点属性，您只需为每一帧动画激活另一个纹理。

编辑：另一种方法可能是在采样之前以统一的方式传递帧号并在片段着色器中进行计算。设置一个整数统一应该是一个很大的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T23:06:03.483

对于现代 GPU，访问/解包单个字节不一定比访问整数类型甚至向量（寄存器大小和加载指令等）更快。您可以只节省内存，从而节省内存带宽，但我不希望这与所有其他顶点属性数组访问有很大不同。

我认为，为动画精灵提供帧索引的最快方法是统一，或者如果必须使用一次绘制调用渲染多个精灵，则使用实例化顶点属性数组。使用后者，您可以为固定大小的顶点子序列提供单个索引。例如，在绘制“sprite-quads”时，您将每 4 个顶点获取一帧索引。当使用实例渲染时，第三种方法是缓冲区纹理。

我建议为时间/帧索引计算使用全局（共享）统一，这样您就可以在着色器中动态计算动画索引，这不需要您更新索引缓冲区（然后它只表示之间的相对动画状态精灵）

# java - 在 AsyncTask 完成后关闭对话框

> ID：11939304
> 
> 赞同：0
> 
> 时间：2012-08-13T17:30:06.947
> 
> 标签：java, android, multithreading, android-asynctask, progressdialog

我需要制作在 AsyncTask 并发活动开始时创建的消失对话框。但是我尝试在 onPostExecute() 中插入 dialog.dismiss() 但它根本不显示对话框。

我正在获取 GPS 纬度和经度，当时我想显示 ProgressDialog。它会显示，但在活动之后我不能让它消失。

这是编码。

```
public class SearchActivity extends Activity {

    private ProgressDialog dialog;

    private static String PROVIDER = LocationManager.GPS_PROVIDER;
    private LocationManager locationManager;

    double longitude = 0.0;
    double latitude = 0.0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        Bundle extras = getIntent().getExtras();

        if (extras == null) {
            Toast.makeText(this, "Something Wrong existing....",
                    Toast.LENGTH_SHORT).show();
            finish();
        }

        String utterance = extras.getString("utterance");
        String location = extras.getString("location");

        if (location == null) {
            dialog = ProgressDialog.show(this, "",
                    "Searching your location...", true);
            dialog.setCancelable(true);
            new GPSLocator().execute();

        }else{
            Toast.makeText(getApplicationContext(), "Location is from SpeechRecognizer Activity", Toast.LENGTH_LONG).show();
        }

    }

    public class GPSLocator extends AsyncTask<String, Void, String> {

        @Override
        protected String doInBackground(String... params) {
            // TODO Auto-generated method stub

            String info = getLocation();

            return info;
        }

        @Override
        protected void onPostExecute(String result) {
            // TODO Auto-generated method stub
            super.onPostExecute(result);

            Toast.makeText(getApplicationContext(), result, Toast.LENGTH_LONG).show();

                    dialog.dismiss();
        }

        @Override
        protected void onProgressUpdate(Void... values) {
            // TODO Auto-generated method stub
            super.onProgressUpdate(values);
        }

        public String getLocation() {

            locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

            Location loc = locationManager.getLastKnownLocation(PROVIDER);

            if (loc == null) {
                return "GPS is not available. Location is null";
            } else {
                latitude = loc.getLatitude();
                longitude = loc.getLongitude();

                return String.valueOf(latitude) + " - "
                        + String.valueOf(longitude);

            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:36:34.890

您应该在 AsyncTask 类中的 onPreExecute () 中初始化对话框使用：

```
if (location == null) {
            dialog = ProgressDialog.show(this, "",
                    "Searching your location...", true);
            dialog.setCancelable(true);} 
```

OnPreExecute 顾名思义在所有其他方法之前运行，所以

1）onPreExecute：对话框初始化

2）doinbackground：做你的事情和

3) onPostExecute 使用结果并关闭对话框。

参考：http://developer.android.com/reference/android/os/AsyncTask.html

# java - 当类在我的 JAR 文件中时，为什么我得到一个无法加载的类？

> ID：11939310
> 
> 赞同：0
> 
> 时间：2012-08-13T17:30:44.477
> 
> 标签：java, jboss, jar, webservice-client, webservices-client

我正在运行 JBoss 4.2.3.GA（无法更改此版本）和 Java 6。我正在尝试部署 JAR 文件。在其中，我尝试连接到 Web 服务，但收到错误消息“无法加载 java 类型：org.mainco.bsorg.BusinessServiceFaultException”，即使有问题的类在我正在部署的 JAR 文件中到服务器。我在想有某种类加载器问题，但不知道从哪里开始寻找。我用来连接的Java代码是

```
final OrganizationService service = new OrganizationService(wsdl, qname);           
service.getOrganizationServicePort() 
```

我正在使用下面的 Maven 插件生成我的 Web 服务客户端代码...

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jaxws-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>wsimport</goal>
                    </goals>
                    <configuration>
                        <wsdlUrls>
                            <wsdlUrl>${wsdl.url}</wsdlUrl>
                        </wsdlUrls>
                        <sourceDestDir>${basedir}/src/main/java</sourceDestDir>
                        <packageName>org.mainco.bsorg</packageName>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

我有这些依赖项......

```
 <dependency>
        <groupId>org.apache.axis</groupId>
        <artifactId>axis</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>javax.xml</groupId>
        <artifactId>jaxrpc-api</artifactId>
        <version>1.1</version>
    </dependency> 
```

下面是例外。我需要从哪里开始挖掘的任何想法？

```
2012-08-13 12:45:02,522 ERROR [org.quartz.core.ErrorLogger] Job (default.job.0.1344875788431 threw an exception.
org.quartz.SchedulerException: Job threw an unhandled exception. [See nested exception: javax.ejb.EJBTransactionRolledbackException: Cannot load java type: org.mainco.bsorg.BusinessServiceFaultException]
        at org.quartz.core.JobRunShell.run(JobRunShell.java:214)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)
* Nested Exception (Underlying Cause) ---------------
javax.ejb.EJBTransactionRolledbackException: Cannot load java type: org.mainco.bsorg.BusinessServiceFaultException
        at org.jboss.ejb3.tx.Ejb3TxPolicy.handleInCallerTx(Ejb3TxPolicy.java:87)
        at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:130)
        at org.jboss.aspects.tx.TxInterceptor$Required.invoke(TxInterceptor.java:195)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
        at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke(StatelessInstanceInterceptor.java:62)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
        at org.jboss.ejb3.mdb.MessagingContainer.localInvoke(MessagingContainer.java:249)
        at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.delivery(MessageInflowLocalProxy.java:268)
        at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.invoke(MessageInflowLocalProxy.java:138)
        at $Proxy80.execute(Unknown Source)
        at org.jboss.resource.adapter.quartz.inflow.QuartzJob.execute(QuartzJob.java:57)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)
Caused by: org.jboss.ws.WSException: Cannot load java type: org.mainco.bsorg.BusinessServiceFaultException
        at org.jboss.ws.metadata.umdm.FaultMetaData.getJavaType(FaultMetaData.java:151)
        at org.jboss.ws.core.jaxws.DynamicWrapperGenerator.generate(DynamicWrapperGenerator.java:139)
        at org.jboss.ws.metadata.builder.jaxws.JAXWSMetaDataBuilder.addFault(JAXWSMetaDataBuilder.java:324)
        at org.jboss.ws.metadata.builder.jaxws.JAXWSMetaDataBuilder.processWebMethod(JAXWSMetaDataBuilder.java:797)
        at org.jboss.ws.metadata.builder.jaxws.JAXWSMetaDataBuilder.processWebMethods(JAXWSMetaDataBuilder.java:891)
        at org.jboss.ws.metadata.builder.jaxws.JAXWSClientMetaDataBuilder.rebuildEndpointMetaData(JAXWSClientMetaDataBuilder.java:300)
        at org.jboss.ws.core.jaxws.spi.ServiceDelegateImpl.getPortInternal(ServiceDelegateImpl.java:271)
        at org.jboss.ws.core.jaxws.spi.ServiceDelegateImpl.getPort(ServiceDelegateImpl.java:202)
        at javax.xml.ws.Service.getPort(Service.java:143)
        at org.mainco.bsorg.OrganizationService.getOrganizationServicePort(OrganizationService.java:56)
        at org.mainco.subco.orgsclient.quartz.UpdateOrgsJob.execute(UpdateOrgsJob.java:49)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:112)
        at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed(InvocationContextImpl.java:166)
        at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke(EJB3InterceptorsInterceptor.java:63)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
        at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke(TransactionScopedEntityManagerInterceptor.java:54)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
        at org.jboss.ejb3.AllowedOperationsInterceptor.invoke(AllowedOperationsInterceptor.java:47)
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
        at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:126)
        ... 11 more
Caused by: java.lang.ClassNotFoundException: No ClassLoaders found for: org.mainco.bsorg.BusinessServiceFaultException
        at org.jboss.mx.loading.LoadMgr3.beginLoadTask(LoadMgr3.java:212)
        at org.jboss.mx.loading.RepositoryClassLoader.loadClassImpl(RepositoryClassLoader.java:521)
        at org.jboss.mx.loading.RepositoryClassLoader.loadClass(RepositoryClassLoader.java:415)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
        at org.jboss.wsf.common.JavaUtils.loadJavaType(JavaUtils.java:143)
        at org.jboss.ws.metadata.umdm.FaultMetaData.getJavaType(FaultMetaData.java:138) 
```

**编辑：**我将 JAR 文件部署到 $JBOSS_HOME/server/default/deploy 。JAR 文件包含我要运行的 Quartz 作业，这就是我将其保存到此目录的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:49:55.523

检查您拥有的 jar 是否是正确的版本，以及 jboss lib 文件夹中是否有该 jar 文件（此处为 C:\jboss-4.2.3.GA\server\seam\lib） *seam = 的名称您正在使用的个人资料

# c++ - 如何降低排序的时间复杂度？

> ID：11939315
> 
> 赞同：2
> 
> 时间：2012-08-13T17:31:10.270
> 
> 标签：c++, algorithm, sorting, time-complexity

我已经编写了这段代码进行排序，它运行得很好。我想知道如何降低它的时间复杂度。

```
#include <iostream>

using namespace std;

void sort(int a[], int n)
{
    int min, temp;
    for(int i=0;i<n-1;i++)
    {
        min=i;
        for(int j=i+1;j<n;j++)
        {
            if(a[min]>a[j])
            {
                min=j;
            }
        }
        temp=a[i];
        a[i]=a[min];
        a[min]=temp;
    }
    for(int i=0;i<n;i++)
    {
        cout<<a[i]<<endl;
    }
}
int main()
    {
    int n;
    cin>>n;
    int arr[n];
    for(int i=0;i<n;i++)
    {
        cin>>arr[i];
    }
    sort(arr,n);
    return 0;
} 
```

如果没有其他方法可以更改它，那么我是否必须更改算法？如果是这样，那么请提出一个算法？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T17:33:01.890

似乎您使用了某种已知速度很慢的*选择排序。*IRL 应用程序通常使用[*快速排序*](http://en.wikipedia.org/wiki/Quicksort)或[*合并排序*](http://en.wikipedia.org/wiki/Mergesort)（不是后者）。

我建议您也这样做（假设这是出于教育目的）。

否则，使用[`std::sort`](http://www.cplusplus.com/reference/algorithm/sort/)定义在`<algorithm>`.

另外，请注意您的代码不是标准的：

```
cin>>n;
int arr[n]; 
```

C++ 不支持 VLA。你最好使用 a`std::vector`代替。如果您使用 C++，请不要编写 C 代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T17:35:28.183

您的算法是选择排序，一种`O(n^2)`算法：如果输入大小在 中线性增长`n`，则运行时间与 的二次函数成正比`n`。基于任意输入（即没有关于输入的先验知识）的比较排序的最小时间复杂度是`O(n log n)`。STL 函数`std::sort`提供了这种保证。

```
#include <algorithm>
#include <vector>

int main()
{
    int n;
    cin>>n;
    std::vector<int> arr;
    arr.resize(n);

    for(int i=0;i<n; ++i) // ++i rather than i++ is a good habit to get into
    {
        cin>>arr[i];
    }

    // O(N log N) complexity
    std::sort(arr.begin(), arr.end());

    return 0;
} 
```

对于小的输入，选择排序（或插入排序）有时可以足够快。您还可以将其编码为 C++11 中的几行代码（它使用 lambda 表达式）

```
#include <algorithm>
#include <iterator>

template<class ForwardIterator>
void selection_sort(ForwardIterator first, ForwardIterator last)
{
        std::for_each(first, last, [](ForwardIterator it) {         // your outer loop
                auto const selection = std::min_element(it, last);  // your inner loop
                std::iter_swap(selection, it);                      // your swap code
        });
}

// call on your vector
selection_sort(arr.begin(), arr.end()); 
```

从这段代码中，选择排序的工作原理也很明显：重复地在数组的剩余部分中找到最小元素，并将其交换到位。它应该等同于你自己的代码，但我希望你同意它更容易理解（一旦你了解了 STL，就是这样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T17:35:50.410

您正在使用[**选择排序**](http://en.wikipedia.org/wiki/Selection_sort)对数组进行排序。此算法的运行时间 id `O(n^2)`。您可以使用[**合并排序**](http://en.wikipedia.org/wiki/Merge_sort)或[**堆排序**](http://en.wikipedia.org/wiki/Heapsort)来排序运行时间为`O(nlog(n))`.
您还可以使用[Intro Sort](http://en.wikipedia.org/wiki/Introsort)，它使用一个非常巧妙的技巧将[QuickSort 的](http://en.wikipedia.org/wiki/Quicksort)最坏情况降低到 O(n log n)，同时保持其他良好的性能特征

查看[有关排序算法的 wiki 页面以](http://en.wikipedia.org/wiki/Sorting_algorithm)获取更多详细信息。

# php - 具有大量列的 Yii CGridView 的奇怪行为 - Ajax URL 混乱

> ID：11939318
> 
> 赞同：0
> 
> 时间：2012-08-13T17:31:43.857
> 
> 标签：php, ajax, url, yii

我最近开始与 Yii 合作，并对此印象深刻。但是，关于如何为 CGridView 创建 Ajax URL，我遇到了一个奇怪的问题。我正在尝试第一次搜索，然后通过单击分页链接在搜索结果中前进一些页面，然后再次搜索。但是，我的网格第二次以以下格式发送请求

```
http://127.0.0.1/myapp/backend/customers/index/XDEBUG_SESSION_START/1/Accounts%5BaccountID%5D//Accounts%5Bname%5D//Accounts%5Baddress%5D/address+1/Accounts%5Bbirthday%5D//Accounts%5BclientType%5D//Accounts%5Bemail%5D//Accounts%5Bbalance%5D//Accounts%5BhasAccess%5D//Accounts_page/3/ajax/yw1?ajax=yw1&Accounts%5BaccountID%5D=&Accounts%5Bname%5D=&Accounts%5Baddress%5D=&Accounts%5Bbirthday%5D=&Accounts%5BclientType%5D=&Accounts%5Bemail%5D=&Accounts%5Bbalance%5D=&Accounts%5BhasAccess%5D=&Accounts_page=1 
```

你可以看到这个 URL 的一半是重写的（它是由 CPagination 在渲染分页链接时创建的）。然而，Yii 的 gridview js 将新查询附加到分页链接，最终导致 URL 中的变量具有先前值和新值的重复。因此，当代码执行到达 CUrlManager.php 中的第 411 行时

```
$_REQUEST[$name]=$_GET[$name]=$value; 
```

$_GET 变量中的值丢失（$value 包含 URL 的旧值，这些值包含在 URL 的重写部分（SEO 友好）中）。最后我又得到了以前的搜索结果。

我正在使用的规则

```
 'urlManager' => array(
            'urlFormat' => 'path',
            'rules' => array(
                '<module:\w+>/<controller:\w+>/<action:\w+>"=>"<module>/<controller>/<action>',
                '<controller:\w+>/<id:\d+>' => '<controller>/view',
                '<controller:\w+>/<action:\w+>/<id:\d+>' => '<controller>/<action>',
                '<controller:\w+>/<action:\w+>' => '<controller>/<action>',
            ),
            'showScriptName' => false,
            'caseSensitive' => true,
        ), 
```

模型中的搜索功能

```
 */
    public function search() {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria = new CDbCriteria;

        $criteria->compare('accountID', $this->accountID, true);
        $criteria->compare('name', $this->name, true);
        $criteria->compare('balance', $this->balance, true);
        $criteria->compare('address', $this->address, true);
        $criteria->compare('birthday', $this->birthday, true);
        $criteria->compare('clientType', $this->clientType, true);
        $criteria->compare('email', $this->email, true);
        $criteria->compare('createAt', $this->createAt, true);
        $criteria->compare('hasAccess', $this->hasAccess);

        return new CActiveDataProvider($this, array(
                    'criteria' => $criteria,
                ));
    } 
```

模型中的行为

```
 public function behaviors() {
    return array('CAdvancedArBehavior' => array(
            'class' => 'application.extensions.CAdvancedArBehavior'));
} 
```

动作索引代码

```
 public function actionIndex()
    {
        if (isset($_POST['attribute']))
        {

            $attribute =$_POST['attribute'];
            $attribute = @explode('_',$attribute);

                $row = Accounts::model()->findByPk($attribute[1]);
                if($row != null )
                {

                                $row->save();

                }

        $dataProvider= new Accounts('search');
                $dataProvider->unsetAttributes();  // clear any default values
        if(isset($_GET['Accounts']))
            $dataProvider->attributes=$_GET['Accounts'];

            $this->render('index', array('model' => $dataProvider));
    }

 } 
```

我的视图文件：

```
$this->widget('zii.widgets.grid.CGridView', array(
       'dataProvider' => $model->search(),
        'filter' => $model,
        'columns' => array(
            array (
                'name' => 'accountID',
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')
            ),
            array(
                'name' => 'name',
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')

            ),
            array(
                'name' => 'address',
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')

            ),

            array(            // display 'create_time' using an expression
            'name'=>'birthday',
            'value'=>'date("M j, Y", strtotime($data->birthday))',
            'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')
            ),

             array(
                'name' => 'clientType',
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')

            ),

            array(
                'name' => 'email',
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')

            ),
            array(
                'name' => 'balance',
                'type' => 'raw',
                'header' => 'Balance',
                'value' =>'($this->grid->owner->widget("application.extensions.jeditable.DsJEditableWidget", array(
                 "model" => $this->grid->dataProvider,
                 "name" => "balance_".$data->accountID,
                 "value" => $data->balance,
                 "jeditable_type" => "text",
                ),true))',
            ),

            array(            // 
                'class' => 'JToggleColumn',
                'name' => 'hasAccess',
                'filter' => array(1=>'Yes', 0=>'No'),
                'checkedButtonImageUrl'=> Yii::App()->baseUrl.'/images/checked.png', // checked image
                'uncheckedButtonImageUrl'=> Yii::App()->baseUrl.'/images/unchecked.png', // unchecked image
                'checkedButtonLabel'=>'Yes', // tooltip
                'uncheckedButtonLabel'=>'No', // tooltip
                'htmlOptions'=>array('style'=>'text-align:center;min-width:60px;')
            ),
        )

    ) 
```

我不想用

```
'ajaxUrl' => $this->createUrl('index') 
```

当我尝试使用 jtogglecolumn 时，由于请求 url 中没有查询数据，它会重置我的搜索和分页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T08:40:55.893

我遇到了同样的问题，在玩了很多之后发现我的 Nginx 配置是错误的。希望这可以帮助某人

**Nginx.conf**

```
location / {

        index  index.php index.html;
        try_files $uri $uri/ /index.php?$args;
        #try_files $uri $uri/ /index.php$uri;    #Use the default config as above

    } 
```

# visual-studio-2010 - 在 Visual Studio 2010 中自定义选项卡大小

> ID：11939319
> 
> 赞同：7
> 
> 时间：2012-08-13T17:31:52.603
> 
> 标签：visual-studio-2010

我希望能够将最小标签大小设置为低于默认的 20 宽度，因为我同时编辑超过 5 个文件。我也在使用*Productivity Power Tools*扩展。

您可以右键单击选项卡旁边的空间，单击`Customize...`

![在此处输入图像描述](../Images/8a27b4d1e24eeedc4611ffeb764f02ab.png)

然后`Advanced Options`从那里编辑值，但它不允许你低于 20 的初始大小。

![在此处输入图像描述](../Images/2bca4bacd36e82cb9f17f3258f17f19a.png)

是否有我可以编辑的配置文件来解决这个问题，或者是否有我缺少的明显解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:01:35.270

解决方案实际上是*最大*尺寸而不是最小尺寸。所以只是调整最大尺寸值就是我想要的。不理想，但仍然是答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T08:40:28.910

值得注意的是，您发布的屏幕截图显示了非标准 VS 设置 - 这是您安装的 Productivity Power Tools 扩展。您可能会发现他们将设置文件与标准 VS 分开隐藏。

该扩展提供了一种替代解决方案：它允许您在屏幕的一侧有一个垂直的选项卡行。这会占用更多的屏幕空间，但可以容纳更多的标签！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:27:00.143

根据 MSDN：-

> 您的活动设置由两部分组成：您第一次启动 Visual Studio 时选择的已安装 .vssettings 文件中的预定义自定义以及您所做的任何后续 IDE 自定义。活动设置默认保存在文件 currentsettings.vssettings 中。

所以它更好地编辑值
`%USERPROFILE%\Documents\Visual Studio 2010\Settings\CurrentSettings.vssettings`（这是我的，你需要根据你的选择设置它。）

但是还有一个文件，您可以编辑 ie `C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\Profiles\General.vssettings`，但请记住，编辑此文件可能具有很大的破坏性，最好将其备份。[此外，您可以在social.msdn.com](http://social.msdn.microsoft.com/Forums/en/category/visualstudio)上询问更多信息。

# javascript - Internet Explorer 中的“错误类型为 null 或不是对象”

> ID：11939321
> 
> 赞同：0
> 
> 时间：2012-08-13T17:31:59.270
> 
> 标签：javascript, internet-explorer, dom-events

我的代码在 Firefox 中运行，但在使用 Internet Explorer 时遇到问题。当它执行时，我得到一个错误并且程序没有正确执行。描述说：

> clientX 为 null 或不是对象。

```
var cursorLocation = new function(){
this.x = 0;
this.y = 0;
//This function is called onmousemove to update the stored position
this.update = function(e){
    var w = window, b = document.body;
    this.x =  e.clientX + (w.scrollX || b.scrollLeft || b.parentNode.scrollLeft || 0);
    this.y = e.clientY + (w.scrollY || b.scrollTop || b.parentNode.scrollTop || 0);
}}      document.onmousemove=function(e){ cursorLocation.update(e); }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:33:47.963

你不应该`new function(){...}`在 javascript 中做。

有你的错误。

* * *

你**应该**做这样的*事情*：

```
var someFunction = function(){....};

var someVariable = new someFunction(); 
```

# version-control - 如何从本地磁盘中删除标记为添加的文件？

> ID：11939322
> 
> 赞同：4
> 
> 时间：2012-08-13T17:32:12.880
> 
> 标签：version-control, perforce, p4v

我目前在 Unity 3.5.5 中使用 Perforce 和 P4V（Rev. Perforce Visual Client/MACOSX105X86_64/2012.1/490402），

当您还原标记为添加的文件时，它只会将其从更改列表中删除。有时文件是自动生成的，或者我创建了一些我不想再添加的文件，我想将它们从更改列表中删除并删除它的本地副本。

搁置标记为添加的文件时也会发生这种情况。我目前正在手动还原和删除每个文件。有没有办法轻松删除本地副本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-16T06:33:52.867

我们尚未在 P4V 中实现它，但如果您至少在 2013.2 服务器上，您可以使用“p4 revert -w”一步完成。如果您遵循自定义工具路线的建议，该命令非常简单，因为它是一步过程。您可以将应用程序设为 p4.exe（如果您在 Linux 或 Mac 上，则为 p4 二进制文件）并且参数是“revert -w %F”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:10:14.883

p4v 可能没有内置功能，但您可以从 p4v 调用您自己的脚本，其中该脚本调用文件的恢复和删除。

转到`Tools->Manage Custom Tools...`，然后选择`New->Tool`。

您将看到如下所示的对话框。

![在此处输入图像描述](../Images/5210d271d32b0a239b302b46e316d5f6.png) 你可以把你的用户脚本放在`Application`. 对于`Arguments`，您可以单击`Select...`按钮来选择不同的变量。这里，`%F`指的是你右键点击的文件（可以是多个）。

我实际上并没有编写完整的脚本来测试它，但我验证了您至少可以右键单击一个文件并且该脚本可用（前提是您检查`Add to applicable context menus`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-05T09:58:47.533

您可以通过“协调脱机工作”工具执行此操作。

右键单击挂起的添加，“删除本地文件”：

![p4中的截图](../Images/c0289e3406b346010623d4ce508fed23.png)

（p4v 2015 年 2 月 18 日 1007540）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-06T00:33:21.893

这有点危险，因为您需要确保您的客户端上没有任何要保留的内容，这些内容也不在 P4 存储库中。一旦您确认要删除所有非 p4 版本的文件...

1.  右键单击包含目录或软件仓库，然后选择“协调脱机工作”。
2.  这将打开一个对话框。您将看到一个名为“本地文件不在仓库中”的部分，这些文件可能是您想要删除的自动生成的文件。
3.  选择“本地文件不在仓库”中的所有文件（ctrl+A），右键单击它们，然后选择“删除本地文件”。
4.  回答是，您确定要删除文件。

这应该从您的 p4 客户端（在您选择的目录下）中删除不受 p4 版本控制的所有文件。

# c# - 如何使 ItemsSource 不使用？

> ID：11939323
> 
> 赞同：1
> 
> 时间：2012-08-13T17:32:17.690
> 
> 标签：c#, wpf, data-binding

我在 WPF 中有一个 DataGrid（一个扩展 DataGrid 的类），我想编辑其中的项目。但当然我收到以下错误：

```
Operation is not valid while ItemsSource is in use. 
Access and modify elements with ItemsControl.ItemsSource instead. 
```

我尝试更改 DataGrid 的 itemsSource，然后添加项目，但仍然出现相同的错误。就像是：

```
public class MyDG:DataGrid{

    public void add(){
        List<TimesheetRecord> records = new List<TimesheetRecord>();

        foreach(TimesheetRecord rec in this.Items){
            records.Add(rec);
        }

        //DO SOME STUFF, ADD MORE ITEMS TO records

        ItemCollection col = this.Items;
        this.ItemsSource = records;
        col.Clear();

       foreach(TimesheetRecord rec in records){
            col.add(red);//exception thrown here
        }

        this.ItemsSource = col;
    }

} 
```

当我已经将 itemsSource 更改为不同的列表时，我不明白为什么会出现该错误...？

我不能（轻松）将项目添加到最初绑定为 itemsSource 的列表中，因为该列表存在于不同的类中。我最好在 MyDG 类中有一个全局变量，`List<TimesheetRecord> myItems = new List<TimesheetRecord>();`然后在 MyDG go 的构造函数中`this.ItemsSource = myItems`

或者你有任何其他建议我应该如何去做？我对任何事情都持开放态度，因为这是我第一次使用数据绑定，所以我可能做错了什么......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:42:25.643

Decalre 记录集合为：

```
ObservableCollection<TimesheetRecord> records = new ObservableCollection<TimesheetRecord>(); 
```

并将其数据绑定到 DataGrid。根据需要操作记录集合，数据绑定将负责保持 UI 与集合同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:44:43.453

您必须选择是否使用*Items*或*ItemsSource*，您不能同时使用两者。在使用*ItemsSource*时尝试修改*Items*会假定不支持的隐式转换，因此会出现错误。

 *在这种情况下，似乎最好的方法可能是设置*Items*并直接添加到该集合中。要使用*ItemsSource*，您需要完全按照您所写的那样，将对*ItemsSource*集合 ( *List<TimesheetRecord>* ) 的引用传递给您的*DataGrid*类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:42:12.033

将“记录”分配给 ItemsSource 后，您就已经更新了您的收藏。无需手动将项目添加到 dataGrid.Items 集合。*

# apache - 使用除 robots.txt 之外的虚拟主机进行重定向

> ID：11939325
> 
> 赞同：2
> 
> 时间：2012-08-13T17:32:26.657
> 
> 标签：apache, .htaccess, redirect, virtualhost

我遇到了一个复杂的 seo 问题，谷歌已经从我的一个名称服务器中索引了数千页。我需要重定向每个请求 301 除了 robots.txt

这是我到目前为止所拥有的，但它不起作用。注释掉的部分是我最初放置的部分（有效），除了它不考虑 robots.txt。下面的两行是我的失败尝试

```
<VirtualHost xx.xx.xx.xx:80>
   ServerName ns2.example.com
   #RedirectMatch permanent /(.*) http://example.new/$1
   RewriteCond %{REQUEST_URI} !^/robots\.txt [NC] 
   RewriteRule ^(.*)$ http://example.new/$1 [R=301,L]
</VirtualHost> 
```

有人看到我的错误吗？example.new 是我要重定向到的站点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:39:54.597

> 有人看到我的错误吗？example.new 是我要重定向到的站点

对于初学者，看起来您需要打开重写引擎：

```
RewriteEngine On 
```

* * *

> 那行得通，除了现在它像`http://example.com//whatever-page`两个一样重定向所有内容`//`

这一行：

```
RewriteRule ^(.*)$ http://example.new/$1 [R=301,L] 
```

需要`/`删除：

```
RewriteRule ^(.*)$ http://example.new$1 [R=301,L] 
```

这是因为在 vhost/server 配置中匹配的 URI`RewriteRule`有一个前导斜杠，因此您不需要在目标中的主机名后面加上斜杠。

# java - URLConnection.getInputStream 返回 null

> ID：11939329
> 
> 赞同：2
> 
> 时间：2012-08-13T17:32:48.267
> 
> 标签：java, urlconnection

我使用 Java 6 将 XML 数据发送到服务器。

XMLWriter 类中的方法 writeToURL 使用 URLConnection 将 XML 数据发送到我的 Web 服务。XML 已成功传输并存储在数据库中，但没有收到下面提到的响应，我只得到 null。也没有抛出异常。

结果应该有以下 XML 或包含它的 InputStream：

```
<?xml version="1.0" encoding="UTF-8"?>
<message>
    <type>response</type>
    <messageID>k17436fxOD3y1ywhCX48</messageID>
    <status>successful</status>
</message> 
```

或者

```
<?xml version="1.0" encoding="UTF-8"?>
<message>
    <type>response</type>
    <messageID>k17436fxOD3y1ywhCX48</messageID>
    <status>alreadyExisting</status>
</message> 
```

可以在[此处](http://paste.geekosphere.org/qxwb)找到 XML 类的完整代码。
Web 服务在此 url 上运行：`http://wafriv.de/tatoo_webservice/index.php`
发送到 Web 服务的 XML 示例可以在[http://paste.geekosphere.org/p5bf上找到](http://paste.geekosphere.org/p5bf)

任何帮助，将不胜感激。

[编辑]
我遇到问题的代码是我的 XMLWriter 中的 writeToURL 方法。
这里是：

```
try
{
    URL url = new URL(urlString);
    URLConnection connection = url.openConnection();
    connection.setUseCaches(false);
    connection.setDoOutput(true);
    connection.setRequestProperty("accept-charset", charset);
    connection.setRequestProperty("content-type", "application/x-www-form-urlencoded");
    String query = "";

    if (additionalParams != null)
    {
        for (Map.Entry<String, Object> entry : additionalParams.entrySet()) {
            String key = entry.getKey();
            Object value = entry.getValue();
            query += String.format("%s=%s&", URLEncoder.encode(key, charset), URLEncoder.encode(value.toString(), charset));
        }
    }

    TransformerFactory transFactory = TransformerFactory.newInstance();
    Transformer transformer = transFactory.newTransformer();
    DOMSource source = new DOMSource(this.document);
    StringWriter sw = new StringWriter();
    StreamResult result = new StreamResult(sw);
    transformer.transform(source, result);

    query += String.format("%s=%s", URLEncoder.encode("message", charset), URLEncoder.encode(sw.toString(), charset));

    OutputStreamWriter writer = null;
    InputStream response;
    try
    {
        writer = new OutputStreamWriter(connection.getOutputStream(), charset);
        writer.write(query); // Write POST query string (if any needed).
    }
    finally
    {
        if (writer != null)
        {
            try
            {
                writer.close();
            }
            catch (IOException ex)
            {
                this.exceptionList.add(ex);
            }
        }
    }

    response = connection.getInputStream();

    return response;
}
catch (TransformerConfigurationException ex)
{
    this.exceptionList.add(ex);
}
catch (TransformerException ex)
{
    this.exceptionList.add(ex);
}
catch (MalformedURLException ex)
{
    this.exceptionList.add(ex);
}
catch (IOException ex)
{
    this.exceptionList.add(ex);
}
    catch (Exception ex)
{
    this.exceptionList.add(ex);
}
finally
{
    this.printExceptions();
    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T10:35:09.773

The problem is solved. The `finally` caused the method writeToURL to return null.

# xpages - XPages extlib oneui 布局 - 如何动态添加位置栏操作

> ID：11939335
> 
> 赞同：5
> 
> 时间：2012-08-13T17:33:15.317
> 
> 标签：xpages, xpages-extlib

我想在 PlaceBar（extlib oneui 应用程序布局）中动态添加操作。

我们在一些配置文档中存储了几个 url。基于这些 URL，我想创建其中包含基本子节点的 Container 节点。每个子节点都使用列表中的一个 URL。如何创建容器节点并向其动态添加子节点？有任何示例 SSJS/Java/CSJS 代码吗？

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:05:20.997

`xe:repeatTreeNode`查看第 245 页的 XPages 扩展库一书中描述的重复节点 ( )。

这是一个非常简单的例子（直接取自书中）：

```
<xe:repeatTreeNode var="val">
   <xe:this.value>
      <![CDATA[#{javascript:return [
        ["Home","home"],
        ["Domino","domino"],
        ["OneUI","oneui"]
      ];}]]>
   </xe:this.value>
   <xe:this.children>
      <xe:basicLeafNode>
         <xe:this.submitValue><![CDATA[#{javascript:return val[1]}]]></xe:this.submitValue>
         <xe:this.label><![CDATA[#{javascript:return val[0]}]]></xe:this.label>
      </xe:basicLeafNode>
   </xe:this.children>
</xe:repeatTreeNode> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T03:03:21.480

感谢你能这么快回复。这对我来说是非常有用的信息。

我发现的另一种方法是基于 XSnippet 代码和一些反向工程。来自xpage中的java代码如下：

```
var oneui = getComponent("applicationLayout1");
var uiConfig = oneui.getConfiguration();
var containerNode:com.ibm.xsp.extlib.tree.complex.ComplexContainerTreeNode = new com.ibm.xsp.extlib.tree.complex.ComplexContainerTreeNode();
containerNode.setLabel("Cluster Applications");

var docAppProfile = docColl.getFirstDocument();
while(docAppProfile != null)
{
    var children:com.ibm.xsp.extlib.tree.complex.ComplexLeafTreeNode = new com.ibm.xsp.extlib.tree.complex.ComplexLeafTreeNode();
    children.setComponent(oneui);
    children.setLabel(docAppProfile.getItemValueString("appTitle"));
    children.setHref(docAppProfile.getItemValueString("appURL"));
    children.setImage(docAppProfile.getItemValueString("appLogoThumb"));
    containerNode.addChild(children);

    children = null;
    var tempDoc = docColl.getNextDocument(docAppProfile);
    docAppProfile = null;
    docAppProfile = tempDoc;
}
uiConfig.addPlaceBarAction(containerNode); 
```

这只是示例代码。将其转换为 java 代码并序列化以提高性能并在应用程序中仅加载一次。

再次感谢您的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T11:51:24.203

基本上它与您上面列出的代码相同，但在 Java 中。然后是 faces-config.xml 文件中的这个小代码

```
<lifecycle>
    <phase-listener>com.company.app.phaselisteners.PlaceBarInjector</phase-listener>
</lifecycle>

package com.company.app.phaselisteners;

public class PlaceBarInjector implements PhaseListener {

      private static final long serialVersionUID = 1L;

      public PhaseId getPhaseId() {
        return PhaseId.RENDER_RESPONSE;
    }

    public void beforePhase(PhaseEvent event) {
        UIComponent oneui = JSFUtil.findComponent("applicationLayout1");
    Configruation uiconfig = oneui.getConfiguration();
    ComplexContainerTreeNode containerNode = new ComplexContainerTreeNode();
    containerNode.setLabel("Cluster Applications");

    Document docAppProfile = docColl.getFirstDocument();
    while(docAppProfile != null)
    {
            ComplexLeafTreeNode children = new ComplexLeafTreeNode();
            children.setComponent(oneui);
            children.setLabel(docAppProfile.getItemValueString("appTitle"));
        children.setHref(docAppProfile.getItemValueString("appURL"));
            children.setImage(docAppProfile.getItemValueString("appLogoThumb"));
            containerNode.addChild(children);

            Document tempDoc = docColl.getNextDocument(docAppProfile);
            docAppProfile = tempDoc;
    }
    uiConfig.addPlaceBarAction(containerNode);
    }

    public void afterPhase(PhaseEvent event) {
        System.out.println("END PHASE " + event.getPhaseId());
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T20:16:08.097

您可以做的另一件事是在呈现响应之前使用 PhaseListener 将项目注入您的容器节点。然后，您可以在一个地方为您的所有页面控制它。

# android - 取消 OSMDROID 中地图移动的惯性影响

> ID：11939351
> 
> 赞同：0
> 
> 时间：2012-08-13T17:34:16.587
> 
> 标签：android, osmdroid, openstreetmap

我需要取消惯性在地图移动中的影响`OSMDROID`。我试图修改代码，但我什么也没得到。知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T14:21:41.453

检查 MapView.MapViewGestureDetectorListener 类中的 onFling 方法并将velocityX，velocityX更改为您的实现，例如：

```
@Override
public boolean onFling(final MotionEvent e1, final MotionEvent e2,
        float velocityX,float velocityY) {
    velocityX=(float) Math.sqrt(velocityX);
    velocityY=(float) Math.sqrt(velocityY);
    if (MapView.this.getOverlayManager()
        .onFling(e1, e2, velocityX, velocityY, MapView.this)) {
            return true;
        }... 
```

# floating-point - 使用浮点转换从二进制转换为基数 10

> ID：11939356
> 
> 赞同：0
> 
> 时间：2012-08-13T17:34:56.653
> 
> 标签：floating-point, binary, computer-science, digital-logic

这是我第一次发帖。

所以这是我的问题，我不明白下面的例子。

二进制表示：01000000011000000000000000000000

`=+(1.11)base 2x 2^(128-127)`<-所有问题都参考这一行。

•`=+(1.11)base 2 x2^1`

•`=+(11.1) base 2`

•`=+(1x21+1x20+1x2-1)=(3.5) base 10`

问题：128-127 来自哪里？
为什么是1.11？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:11:32.970

在[单精度浮点格式](http://en.wikipedia.org/wiki/Single_precision)中，指数偏差为常数 127。您给出的特定位模式将浮点数编码为 128 (1000000) 作为指数：

```
0 10000000 11000000000000000000000
s exponent fraction 
```

首先看符号（s）位，它是0。所以它是一个正数。

然后从指数中减去指数偏差，这就是 128 - 127 的来源。这给了`1`.

然后我们开始将分数中的位相加（`11000000000000000000000`）：

```
1 + 0.5 + 0.25 + 0 + 0 + 0.... 
```

给 1.75

现在我们有 1(sign) * 2^1(exponent) * 1.75(fraction) = 2 * 1.75 = 3.5

另一个例子：

```
00111110101010101010101010101011 
```

分解它：

```
0 01111101 01010101010101010101011
s exponent fraction 
```

符号为 0，所以它又是正数。

125 (01111101) 指数，从中减去指数偏差：`125 - 127 = -2`

解码分数`01010101010101010101011`

```
1 + 0 + 0.25 + 0 + 0.0625 + 0 + 0.015625 + 0 + 0.00390625 + 0 + 0.0009765625 + 0 + 0.000244140625 + 0 + 0.00006103515625 + 0 + 0.0000152587890625 + 0 + 0.000003814697265625 + 0 + 9.5367431640625e-7 + 0 + 2.384185791015625e-7 + 1.1920928955078125e-7 
```

这给了`1.3333333730697632`左右。

现在把它们加在一起：

```
1(sign) * 2^-2(exponent) * 1.3333333730697632(fraction) = 0.25 * 1.3333333730697632 = 0.3333333432674408 =~ 0.3333333 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:10:07.250

首先，您要做的第一件事是分离字段（给定 IEEE 754 32 位浮点编码）：

> 符号位：0
> 
> 指数位：10000000
> 
> 尾数位：11000000000000000000000

(128 - 127) 是通过减去**指数偏差**来计算指数。

从浮点数转换为十进制数时，减去指数偏差。当以另一种方式转换时，您添加它。指数偏差计算如下：

2^(k−1) − 1 其中*k*是指数字段中的位数。

```
2^(8 - 1) - 1 = 127 
```

尾数为 1.11，以 2 为底（二进制）。尾数由一个分数组成，并有一个隐含的前导 1。因此，在尾数位中有 11000...，你有一个隐含的前导一个给你 1.11

如果尾数位为 1011，则您的分数值为 1.011

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:10:16.753

本教程应该让您更好地理解浮点数：

[http://www.tfinley.net/notes/cps104/floating.html](http://www.tfinley.net/notes/cps104/floating.html)

二进制表示分为 3 个部分：1 个符号位、8 个指数位和 23 个尾数位。

```
 0|10000000|11000000000000000000000
sign|exponent|       mantissa 
```

符号位为零，表示它是一个正数。指数 (128) 比定义的实际值大 127，解析为 1（即 128 - 127）。尾数是 1.11（前导 1 是隐含的，同样根据定义）。因此，我们有

```
 01000000011000000000000000000000
= +(1.11)base 2 x 2^(128-127)
= (2^0 + 2^-1 + 2^-2) x 2^1
= 2^1 + 2^0 + 2^-1
= 2 + 1 + 0.5
= 3.5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T07:24:42.503

我认为指数中有偏差（+127）的理由是：

如果将浮点数解释为 32 位整数，则不会更改顺序。
那是

```
float a,b;
assert((a < b) == ((int)(a) < (int)(b))); 
```

*   因此，符号位首先出现，然后是指数，然后是尾数
*   因此，最小的正浮点数的指数为零
*   因此，0.0 被编码为所有位设置为 0

因此，您必须通过减去 127 来消除指数的偏差...

编辑：不等式适用于常规浮点数，但不适用于 NaN

# php - 在 CakePHP 中仅显示登录管理员的操作按钮

> ID：11939357
> 
> 赞同：2
> 
> 时间：2012-08-13T17:34:57.900
> 
> 标签：php, cakephp, cakephp-2.0

我对 Cake 很陌生，正在使用 Cake 2.0，我已经烘焙了我的视图、控制器等......

我想要做的是进入我的视图并围绕`Edit`和`Delete`操作包装一些逻辑，并且只将它们显示给登录的管理员。

这听起来像正确的方法吗？我已经锁定了这些操作，以便只有管理员可以访问它们，但我不想向非管理员显示这些按钮。

另外，我不认为为普通用户和管理员提供单独的视图是正确的方法，但我可能是错的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T04:53:19.463

您可以尝试在 AppController 的 beforeFilter() 方法中使用以下代码片段：

```
function beforeFilter()
{
     $role = $this->Auth->user('role'); //If you are using Auth
     //$this->Session->read('User.role'); // If you are using a normal login session.
     if ($role == 'author' || $role == 'admin') { 
         $this->set('role', $role); 
     } 

     if($role == 'admin')
     {
         $this->set('is_admin', true);
     }
     else
     {
         $this->set('is_admin', false);
     }
    /***** your remaining code *******/
 } 
```

在您看来，只需使用以下内容：

```
 if($is_admin)
 {
      $this->Html->link('Admin Link', 'controllers/view');
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:08:49.633

可以将变量传递给视图并检查它以显示命令。

控制器：

```
...
$this->set('admin', true); //user is an admin and should view the links
... 
```

看法：

```
...
if ($admin){echo $this->Html->link('Edit', array('action' => 'edit'))}
... 
```

# android - 如何在android中使位图不可见？

> ID：11939358
> 
> 赞同：-5
> 
> 时间：2012-08-13T17:35:00.660
> 
> 标签：android, android-layout, android-widget

我在画布上绘制了一个位图，我想设置一个 ontouch 侦听器，这样一旦用户触摸位图，它就会变得不可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:49:56.787

做这个 ：

```
 @Override
    public boolean onTouch(final View view, MotionEvent event) {

              final int action = event.getAction();

                     int x = event.getX()  // or getRawX();
                     int y = event.getY();

                    switch(action){
                          case MotionEvent.ACTION_DOWN:

                   if (x >= xOfYourBitmap && x < (xOfYourBitmap +yourBitmap.getWidth())
                       && y >= yOfYourBitmap && y < (yOfYourBitmap + yourBitmap.getHeight())) {
        //You've pressed on your bitmap
    }
    break;
}
     } 
```

# iphone - 每年更新的应用程序提交？

> ID：11939361
> 
> 赞同：2
> 
> 时间：2012-08-13T17:35:07.773
> 
> 标签：iphone, ios, submission

我正在寻找提交一个新应用程序，但对应用程序提交有一些一般性问题。

这是一个足球应用程序。此应用程序包含年度内容，因此我想为该应用程序收取每年 0.99 美元的费用。因此，用户下载它并支付 0.99 美元，这将使他们可以访问内容 1 年，然后明年应用程序中会有新内容（json 提要等），所以他们需要再次购买？

我如何完成这种类型的应用提交？我在想我必须每年创建一个新的应用程序并让用户每年下载一个新的应用程序，这是唯一的方法吗？如果是这样，我将需要解决用户如何/何时可以通过应用程序访问信息，而不是让他们过去一年。我应该在应用设置中包含年份吗？

我想创建一个应用程序并要求每年更新，然后我和用户可以使用同一个应用程序并推送更新？我会给应用程序一个通用名称还是包括年份？

任何方向表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:38:06.140

我会尝试在应用内购买中使用订阅功能。更多信息[在这里](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/RenewableSubscriptions/RenewableSubscriptions.html#//apple_ref/doc/uid/TP40008267-CH4-SW2)。您可以以 0.99 美元的价格提供该应用程序，然后在一年后收取订阅费用，或者免费提供该应用程序并要求用户购买一年的订阅费才能使用该应用程序。

# java - Android GET 和 POST 请求

> ID：11939362
> 
> 赞同：2
> 
> 时间：2012-08-13T17:35:11.910
> 
> 标签：java, android, post, get

谁能指出我发送 GET 和 POST 请求的方法的良好实现。他们有很多方法可以做到这一点，我正在寻找最好的实施方式。其次，是否有一种通用的方式来发送这两种方法，而不是使用两种不同的方式。毕竟 GET 方法仅在查询字符串中具有参数，而 POST 方法使用参数的标头。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:58:41.223

您可以使用`HttpURLConnection`该类（在 java.net 中）发送 POST 或 GET HTTP 请求。它与可能想要发送 HTTP 请求的任何其他应用程序相同。发送 Http 请求的代码如下所示：

```
import java.net.*;
import java.io.*;
public class SendPostRequest {
  public static void main(String[] args) throws MalformedURLException, IOException {
    URL reqURL = new URL("http://www.stackoverflow.com/"); //the URL we will send the request to
    HttpURLConnection request = (HttpURLConnection) (reqUrl.openConnection());
    String post = "this will be the post data that you will send"
    request.setDoOutput(true);
    request.addRequestProperty("Content-Length", Integer.toString(post.length)); //add the content length of the post data
    request.addRequestProperty("Content-Type", "application/x-www-form-urlencoded"); //add the content type of the request, most post data is of this type
    request.setMethod("POST");
    request.connect();
    OutputStreamWriter writer = new OutputStreamWriter(request.getOutputStream()); //we will write our request data here
    writer.write(post);
    writer.flush();
  }
} 
```

GET 请求看起来会有些不同，但大部分代码是相同的。您不必担心使用流进行输出或指定内容长度或内容类型：

```
import java.net.*;
import java.io.*;

public class SendPostRequest {
  public static void main(String[] args) throws MalformedURLException, IOException {
    URL reqURL = new URL("http://www.stackoverflow.com/"); //the URL we will send the request to
    HttpURLConnection request = (HttpURLConnection) (reqUrl.openConnection());
    request.setMethod("GET");
    request.connect();

  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:53:19.793

我更喜欢使用专用类来执行 GET/POST 和任何 HTTP 连接或请求。此外，我`HttpClient`用来执行这些 GET/POST 方法。

以下是我项目的示例。我需要线程安全的执行，所以有`ThreadSafeClientConnManager`.

有一个使用 GET (fetchData) 和 POST (sendOrder) 的例子

如您所见`execute`，执行的一般方法`HttpUriRequest`是 POST 或 GET。

```
public final class ClientHttpClient {

private static DefaultHttpClient client;
private static CookieStore cookieStore;
private static HttpContext httpContext;

static {
    cookieStore = new BasicCookieStore();
    httpContext = new BasicHttpContext();
    httpContext.setAttribute(ClientContext.COOKIE_STORE, cookieStore);
    client = getThreadSafeClient();
    HttpParams params = new BasicHttpParams();
    HttpConnectionParams.setConnectionTimeout(params, AppConstants.CONNECTION_TIMEOUT);
    HttpConnectionParams.setSoTimeout(params, AppConstants.SOCKET_TIMEOUT);
    client.setParams(params);
}

private static DefaultHttpClient getThreadSafeClient() {
    DefaultHttpClient client = new DefaultHttpClient();
    ClientConnectionManager mgr = client.getConnectionManager();
    HttpParams params = client.getParams();
    client = new DefaultHttpClient(new ThreadSafeClientConnManager(params, mgr.getSchemeRegistry()),
            params);
    return client;
}

private ClientHttpClient() {
}

public static String execute(HttpUriRequest http) throws IOException {
    BufferedReader reader = null;
    try {
        StringBuilder builder = new StringBuilder();
        HttpResponse response = client.execute(http, httpContext);
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();
        HttpEntity entity = response.getEntity();
        InputStream content = entity.getContent();
        reader = new BufferedReader(new InputStreamReader(content, CHARSET));
        String line = null;
        while((line = reader.readLine()) != null) {
            builder.append(line);
        }

        if(statusCode != 200) {
            throw new IOException("statusCode=" + statusCode + ", " + http.getURI().toASCIIString()
                    + ", " + builder.toString());
        }

        return builder.toString();
    }
    finally {
        if(reader != null) {
            reader.close();
        }
    }
}

public static List<OverlayItem> fetchData(Info info) throws JSONException, IOException {
    List<OverlayItem> out = new LinkedList<OverlayItem>();
    HttpGet request = buildFetchHttp(info);
    String json = execute(request);
    if(json.trim().length() <= 2) {
        return out;
    }
    try {
        JSONObject responseJSON = new JSONObject(json);
        if(responseJSON.has("auth_error")) {
            throw new IOException("auth_error");
        }
    }
    catch(JSONException e) {
        //ok there was no error, because response is JSONArray - not JSONObject
    }

    JSONArray jsonArray = new JSONArray(json);
    for(int i = 0; i < jsonArray.length(); i++) {
        JSONObject chunk = jsonArray.getJSONObject(i);
        ChunkParser parser = new ChunkParser(chunk);
        if(!parser.hasErrors()) {
            out.add(parser.parse());
        }
    }
    return out;
}

private static HttpGet buildFetchHttp(Info info) throws UnsupportedEncodingException {
    StringBuilder builder = new StringBuilder();
    builder.append(FETCH_TAXIS_URL);
    builder.append("?minLat=" + URLEncoder.encode("" + mapBounds.getMinLatitude(), ENCODING));
    builder.append("&maxLat=" + URLEncoder.encode("" + mapBounds.getMaxLatitude(), ENCODING));
    builder.append("&minLon=" + URLEncoder.encode("" + mapBounds.getMinLongitude(), ENCODING));
    builder.append("&maxLon=" + URLEncoder.encode("" + mapBounds.getMaxLongitude(), ENCODING));
    HttpGet get = new HttpGet(builder.toString());
    return get;
}

public static int sendOrder(OrderInfo info) throws IOException {
    HttpPost post = new HttpPost(SEND_ORDER_URL);
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
    nameValuePairs.add(new BasicNameValuePair("id", "" + info.getTaxi().getId()));
    nameValuePairs.add(new BasicNameValuePair("address", info.getAddressText()));
    nameValuePairs.add(new BasicNameValuePair("name", info.getName()));
    nameValuePairs.add(new BasicNameValuePair("surname", info.getSurname()));
    nameValuePairs.add(new BasicNameValuePair("phone", info.getPhoneNumber()));
    nameValuePairs.add(new BasicNameValuePair("passengers", "" + info.getPassengers()));
    nameValuePairs.add(new BasicNameValuePair("additionalDetails", info.getAdditionalDetails()));
    nameValuePairs.add(new BasicNameValuePair("lat", "" + info.getOrderLocation().getLatitudeE6()));
    nameValuePairs.add(new BasicNameValuePair("lon", "" + info.getOrderLocation().getLongitudeE6()));
    post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    String response = execute(post);
    if(response == null || response.trim().length() == 0) {
        throw new IOException("sendOrder_response_empty");
    }

    try {
        JSONObject json = new JSONObject(response);
        int orderId = json.getInt("orderId");
        return orderId;
    }
    catch(JSONException e) {
        throw new IOException("sendOrder_parsing: " + response);
    }
} 
```

**编辑**

该`execute`方法是公开的，因为有时我使用自定义（或动态）GET/POST 请求。

如果你有`URL`对象，你可以传递给`execute`方法：

```
HttpGet request = new HttpGet(url.toString());
execute(request); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:40:31.720

正如您所说：GET-Parameters 在 URL 中 - 因此您可以在 Webview 上使用 loadUrl() 来发送它们。

```
[..].loadUrl("http://www.example.com/data.php?param1=value1&param2=value2&..."); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T17:52:30.153

开发人员培训文档有一个[关于 GET 请求的好例子](http://developer.android.com/training/basics/network-ops/connecting.html#download)。您负责将查询参数添加到 URL。

帖子是相似的，但正如你所说，完全不同。[HttpConnectionURLConnection](http://developer.android.com/reference/java/net/HttpURLConnection.html)类可以同时做这两件事，而且很容易将帖子正文设置为输出流。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-09T08:01:52.903

```
 protected String doInBackground(String... strings) {
        String response = null;
        String data = null;
        try {
            data = URLEncoder.encode("CustomerEmail", "UTF-8")
                    + "=" + URLEncoder.encode(username, "UTF-8");

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
        String url = Constant.URL_FORGOT_PASSWORD;// this is url 
        response = ServiceHandler.postData(url,data);
        if (response.equals("")){
            return response;
        }else {
            return response;
        }

    }

public static String postData(String urlpath,String data){

    String text = "";
    BufferedReader reader=null;
    try
    {
        // Defined URL  where to send data
        URL url = new URL(urlpath);

        // Send POST data request
        URLConnection conn = url.openConnection();
        conn.setDoOutput(true);
        OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        wr.write( data );
        wr.flush();

        // Get the server response
        reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        StringBuilder sb = new StringBuilder();
        String line = null;

        // Read Server Response
        while((line = reader.readLine()) != null)
        {
            sb.append(line + "\n");
        }
        text = sb.toString();
        return text;
    }
    catch(Exception ex)
    {
    }
    finally
    {
        try
        {
            reader.close();
        }
        catch(Exception ex) {}
    }
    return text;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-05T07:02:58.643

```
private RequestListener listener;
private int requestId;
private HashMap<String, String> reqParams;
private File file;
private String fileName;
private RequestMethod reqMethod;
private String url;
private Context context;
private boolean isProgressVisible = false;
private MyProgressDialog progressDialog;

public NetworkClient(Context context, int requestId, RequestListener listener,
                     String url, HashMap<String, String> reqParams, RequestMethod reqMethod,
                     boolean isProgressVisible) {

    this.listener = listener;
    this.requestId = requestId;
    this.reqParams = reqParams;
    this.reqMethod = reqMethod;
    this.url = url;
    this.context = context;
    this.isProgressVisible = isProgressVisible;
}

public NetworkClient(Context context, int requestId, RequestListener listener,
                     String url, HashMap<String, String> reqParams, File file, String fileName, RequestMethod reqMethod,
                     boolean isProgressVisible) {

    this.listener = listener;
    this.requestId = requestId;
    this.reqParams = reqParams;
    this.file = file;
    this.fileName = fileName;
    this.reqMethod = reqMethod;
    this.url = url;
    this.context = context;
    this.isProgressVisible = isProgressVisible;
}

@Override
protected void onPreExecute() {
    super.onPreExecute();
    if (isProgressVisible) {
        showProgressDialog();
    }
}

@Override
protected String doInBackground(Void... params) {

    try {

        if (Utils.isInternetAvailable(context)) {

            OkHttpClient.Builder clientBuilder = new OkHttpClient.Builder();
            clientBuilder.connectTimeout(10, TimeUnit.SECONDS);
            clientBuilder.writeTimeout(10, TimeUnit.SECONDS);
            clientBuilder.readTimeout(20, TimeUnit.SECONDS);
            OkHttpClient client = clientBuilder.build();

            if (reqMethod == RequestMethod.GET) {

                Request.Builder reqBuilder = new Request.Builder();
                reqBuilder.url(url);
                Request request = reqBuilder.build();
                Response response = client.newCall(request).execute();
                String message = response.message();
                String res = response.body().string();

                JSONObject jObj = new JSONObject();
                jObj.put("statusCode", 1);
                jObj.put("response", message);
                return jObj.toString();

            } else if (reqMethod == RequestMethod.POST) {

                FormBody.Builder formBuilder = new FormBody.Builder();

                RequestBody body = formBuilder.build();

                Request.Builder reqBuilder = new Request.Builder();
                reqBuilder.url(url);
                reqBuilder.post(body);
                Request request = reqBuilder.build();
                Response response = client.newCall(request).execute();

                String res = response.body().string();

                JSONObject jObj = new JSONObject();
                jObj.put("statusCode", 1);
                jObj.put("response", res);
                return jObj.toString();

            } else if (reqMethod == RequestMethod.MULTIPART) {

                MediaType MEDIA_TYPE = fileName.endsWith("png") ?
                        MediaType.parse("image/png") : MediaType.parse("image/jpeg");

                MultipartBody.Builder multipartBuilder = new MultipartBody.Builder();
                multipartBuilder.setType(MultipartBody.FORM);

                multipartBuilder.addFormDataPart("file", fileName, RequestBody.create(MEDIA_TYPE, file));

                RequestBody body = multipartBuilder.build();

                Request.Builder reqBuilder = new Request.Builder();
                reqBuilder.url(url);
                reqBuilder.post(body);
                Request request = reqBuilder.build();
                Response response = client.newCall(request).execute();
                String res = response.body().string();

                JSONObject jObj = new JSONObject();
                jObj.put("statusCode", 1);
                jObj.put("response", res);
                return jObj.toString();
            }

        } else {

            JSONObject jObj = new JSONObject();
            jObj.put("statusCode", 0);
            jObj.put("response", context.getString(R.string.no_internet));
            return jObj.toString();
        }
    } catch (final Exception e) {
        e.printStackTrace();
        JSONObject jObj = new JSONObject();
        try {
            jObj.put("statusCode", 0);
            jObj.put("response", e.toString());
        } catch (Exception e1) {
            e1.printStackTrace();
        }
        return jObj.toString();
    }

    return null;
}

@Override
protected void onPostExecute(String result) {
    super.onPostExecute(result);
    try {
        JSONObject jObj = new JSONObject(result);
        if (jObj.getInt("statusCode") == 1) {
            listener.onSuccess(requestId, jObj.getString("response"));
        } else {
            listener.onError(requestId, jObj.getString("response"));
        }
    } catch (Exception e) {
        listener.onError(requestId, result);
    } finally {
        dismissProgressDialog();
    }
}

private void showProgressDialog() {
    progressDialog = new MyProgressDialog(context);
}

private void dismissProgressDialog() {
    if (progressDialog != null && progressDialog.isShowing()) {
        progressDialog.dismiss();
        progressDialog = null;
    }
}

private static NetworkManager instance = null;
private Set<RequestListener> arrRequestListeners = null;
private int requestId;
public boolean isProgressVisible = false;

private NetworkManager() {
    arrRequestListeners = new HashSet<>();
    arrRequestListeners = Collections.synchronizedSet(arrRequestListeners);
}

public static NetworkManager getInstance() {
    if (instance == null)
        instance = new NetworkManager();
    return instance;
}

public synchronized int addRequest(final HashMap<String, String> params, Context context, RequestMethod reqMethod, String apiMethod) {

    try {

        String url = Constants.WEBSERVICE_URL + apiMethod;
        requestId = UniqueNumberUtils.getInstance().getUniqueId();

        NetworkClient networkClient = new NetworkClient(context, requestId, this, url, params, reqMethod, isProgressVisible);
        networkClient.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);

    } catch (Exception e) {
        onError(requestId, e.toString() + e.getMessage());
    }

    return requestId;
}

public synchronized int addMultipartRequest(final HashMap<String,String> params, File file, String fileName, Context context, RequestMethod reqMethod, String apiMethod) {

    try {

        String url = Constants.WEBSERVICE_URL + apiMethod;
        requestId = UniqueNumberUtils.getInstance().getUniqueId();

        NetworkClient networkClient = new NetworkClient(context, requestId, this, url, params, file, fileName, reqMethod, isProgressVisible);
        networkClient.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);

    } catch (Exception e) {
        onError(requestId, e.toString() + e.getMessage());
    }

    return requestId;
}

public void isProgressBarVisible(boolean isProgressVisible) {
    this.isProgressVisible = isProgressVisible;
}

public void setListener(RequestListener listener) {
    try {
        if (listener != null && !arrRequestListeners.contains(listener)) {
            arrRequestListeners.add(listener);
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
}

@Override
public void onSuccess(int id, String response) {

    if (arrRequestListeners != null && arrRequestListeners.size() > 0) {
        for (RequestListener listener : arrRequestListeners) {
            if (listener != null)
                listener.onSuccess(id, response);
        }
    }
}

@Override
public void onError(int id, String message) {
    try {
        if (Looper.myLooper() == null) {
            Looper.prepare();
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    if (arrRequestListeners != null && arrRequestListeners.size() > 0) {
        for (final RequestListener listener : arrRequestListeners) {
            if (listener != null) {
                listener.onError(id, message);
            }
        }
    }
}

public void removeListener(RequestListener listener) {
    try {
        arrRequestListeners.remove(listener);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

创建 RequestListner 接口

```
public void onSuccess(int id, String response);

public void onError(int id, String message); 
```

获取唯一编号

```
private static UniqueNumberUtils INSTANCE = new UniqueNumberUtils();

private AtomicInteger seq;

private UniqueNumberUtils() {
    seq = new AtomicInteger(0);
}

public int getUniqueId() {
    return seq.incrementAndGet();
}

public static UniqueNumberUtils getInstance() {
    return INSTANCE;
} 
```

# hibernate - em.persist(t) --- java.lang.IllegalArgumentException

> ID：11939367
> 
> 赞同：-1
> 
> 时间：2012-08-13T17:35:53.143
> 
> 标签：hibernate, entitymanager, persist

我是休眠新手，我有这个方法：private EntityManager em;

```
@Override
public void save(T t) {
    if(t != null) {
        em.persist(t);
    }
} 
```

我不明白这个表达是什么意思：

“em.persist(t)”
发生异常：java.lang.IllegalArgumentException

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:44:53.517

EntityManager 的 persist 方法使实例成为可管理和持久的。

如[API](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#persist%28java.lang.Object%29)中所述，如果参数不是实体，则`persist`方法抛出。`IllegalArgumentException`对象不是实体的典型原因是缺少[@Entity](http://docs.oracle.com/javaee/6/api/javax/persistence/Entity.html)注释和/或缺少 persistence.xml 中的实体条目。

# c++ - forloop、迭代器和向量不与我合作

> ID：11939368
> 
> 赞同：1
> 
> 时间：2012-08-13T17:35:58.873
> 
> 标签：c++, vector, iterator

为什么这对我有用：

```
 for(int i = 0; i < vec.size(); i++)
    {
        os << vec[i] << " ";
    } 
```

虽然这不是：

```
 for(vector<int>::iterator it = vec.begin(); it < vec.end(); it++)
    {
        os << vec[*it] << " ";
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T17:37:14.920

您应该打印`*it`而不是将其用作索引，并且您可能应该将条件更改为`it != vec.end()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T17:37:29.973

您使用错误的迭代器，它应该是：

```
for(vector<int>::iterator it = vec.begin(); it < vec.end(); it++)
{
    os << *it << " ";
} 
```

您的代码只是尝试打印 index 处的元素`*it`，这甚至可能无效。

# c# - ASP.Net HTML 文档查看器

> ID：11939370
> 
> 赞同：3
> 
> 时间：2012-08-13T17:36:07.260
> 
> 标签：c#, asp.net, documentviewer

在我的应用程序中，我们将文档存储在 Sharepoint 中并使用 asp.net 应用程序来显示它。哪个是最好的集成编辑器，并且可以在 IE7 之后的每个浏览器上工作？

谷歌文档是否提供 api，因为我正在为所有类型的文件寻找那种查看器。

请记住，我正在寻找 html 而不是 silverlight 或 WPF 应用程序。延迟加载将是一个加号。查看器应与所有文档类型集成

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T09:16:11.140

你可以看看这个[http://www.doconut.com/Document-Viewer/Features.aspx](http://www.doconut.com/Document-Viewer/Features.aspx)

1.  用于显示的 Asp.net 应用程序 -**是**
2.  可以在每个浏览器发布 IE7 上工作吗？-**是的**
3.  请记住，我正在寻找 html 而不是 silverlight 或 WPF 应用程序。-**是的**
4.  延迟加载将是一个加号。-**是的**
5.  查看器应与所有文档类型集成 -**是**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T22:02:37.527

也许这可以帮助您[使用 SarePoint 的 Office Web Apps](http://office.microsoft.com/en-us/web-apps-help/start-using-office-web-apps-in-sharepoint-HA010380116.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T13:27:24.293

Aspose 提供强大的文档 API [http://www.aspose.com/](http://www.aspose.com/)

您可以将文档转换从原始格式转换为 HTML 友好格式，例如 Word 到 PDF 或 Excel 到 PDF 甚至图像，如果目的仅用于查看。

[http://www.aspose.com/demos/.net-components/default.aspx](http://www.aspose.com/demos/.net-components/default.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T10:22:43.730

是的，谷歌为此目的提供 API ......检查一下......

*   [StackOverflow 上的示例](https://stackoverflow.com/questions/1566239/use-google-docs-in-asp-net-application)
*   [Google API 文档](https://developers.google.com/google-apps/documents-list/?hl=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T07:10:32.610

```
http://docs.google.com/viewer?url= <USER PATH TO THE FILE> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-22T20:40:22.490

我过去用它来做类似的事情。它易于使用且不花费任何费用。

[http://www.tinymce.com/](http://www.tinymce.com/)

我的情况与你的情况有些不同。我需要给用户一个不错的全功能编辑器。在幕后它生成了我存储到数据库字段中的 html。此解决方案使用 javascript 库和 html。

# c# - Creating Custom Base controller for capturing query string values. GOOD or BAD?

> ID：11939374
> 
> 赞同：0
> 
> 时间：2012-08-13T17:36:27.213
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

This question is basically to know and justify whether what I am doing is a good practice or if there are any other ways to achieve the solution for the problem.
Here is the problem....

* I have an MVC application with many controllers and action methods. Customers will be accessing different action methods from different sources (google, bing, third party sites) adding a query string signature at the end.

* Since I dont want to check the querystring value in every action of the controller. I created a new controller "BaseController.cs" which inherits from the MVC Controller class. And implements the following code. All the application controllers will inherit from the BaseController.

```
 public class BaseController : Controller
    {
       public BaseController():base()
       { 
            string siteReference = HttpContext.Request["ref"];
       }
    }
```

I am requesting the experts of MVC to suggest better ways. Thanks in advance.

-KK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:39:42.610

There is a less obstrussive way to do it, you can use a global action filter to do the same without having to use a base controller, and you favor composition over inheritance.

```
 public class GetQueryString: IActionFilter, IMvcFilter
    {

        public void OnActionExecuting(ActionExecutingContext filterContext)
        {
            string siteReference = filterContext.HttpContext.Request["ref"];
        }

        public void OnActionExecuted(ActionExecutedContext filterContext)
        {

        }

        public bool AllowMultiple
        {
            get { return false; }
        }

        public int Order
        {
            get { return Filter.DefaultOrder; }
        }
    } 
```

# c - gcc 可以不编译代码吗？

> ID：11939376
> 
> 赞同：0
> 
> 时间：2012-08-13T17:36:39.727
> 
> 标签：c, gcc, compilation, mingw

我正在尝试在 MinGW 下编译 SASL，并且在源文件`seterror.c`中声明了两个函数，如下所示：

```
 #include <config.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <limits.h>
#ifdef HAVE_SYSLOG
#include <syslog.h>
#endif
#include <stdarg.h>
#include <ctype.h>

#include <sasl.h>
#include <saslutil.h>
#include <saslplug.h>
#include "saslint.h"

#ifdef WIN32
/* need to handle the fact that errno has been defined as a function
   in a dll, not an extern int */
# ifdef errno
#  undef errno
# endif /* errno */
#endif /* WIN32 */
#ifdef HAVE_UNISTD_H
#include <unistd.h>
#endif

static int _sasl_seterror_usererr(int saslerr)
{
    /* Hide the difference in a username failure and a password failure */
    if (saslerr == SASL_NOUSER)
    return SASL_BADAUTH;

    /* otherwise return the error given; no transform necessary */
    return saslerr;
}

void sasl_seterror(sasl_conn_t *conn,
           unsigned flags,
           const char *fmt, ...)
{
  size_t outlen=0; /* current length of output buffer */
  size_t pos = 0; /* current position in format string */
  size_t formatlen;
  int result;
  sasl_log_t *log_cb = NULL;
  void *log_ctx;
  int ival;
  char *cval;
  va_list ap; /* varargs thing */
  char **error_buf;
  size_t *error_buf_len;

  if(!conn) {
#ifndef SASL_OSX_CFMGLUE
      if(!(flags & SASL_NOLOG)) {
      /* See if we have a logging callback... */
      result = _sasl_getcallback(NULL, SASL_CB_LOG, (sasl_callback_ft *)&log_cb, &log_ctx);
      if (result == SASL_OK && ! log_cb)
          result = SASL_FAIL;
      if (result != SASL_OK)
          return;

      log_cb(log_ctx, SASL_LOG_FAIL,
         "No sasl_conn_t passed to sasl_seterror");
      }  
#endif /* SASL_OSX_CFMGLUE */
      return;
  } else if(!fmt) return;    

/* we need to use a back end function to get the buffer because the
   cfm glue can't be rooting around in the internal structs */
  _sasl_get_errorbuf(conn, &error_buf, &error_buf_len);

  formatlen = strlen(fmt);

  va_start(ap, fmt); /* start varargs */

  while(pos<formatlen)
  {
    if (fmt[pos]!='%') /* regular character */
    {
      result = _buf_alloc(error_buf, error_buf_len, outlen+1);
      if (result != SASL_OK)
    return;
      (*error_buf)[outlen]=fmt[pos];
      outlen++;
      pos++;
    } else { /* formating thing */
      int done=0;
      char frmt[10];
      int frmtpos=1;
      char tempbuf[21];
      frmt[0]='%';
      pos++;

      while (done==0)
      {
    switch(fmt[pos])
      {
      case 's': /* need to handle this */
        cval = va_arg(ap, char *); /* get the next arg */
        result = _sasl_add_string(error_buf, error_buf_len,
                      &outlen, cval);

        if (result != SASL_OK) /* add the string */
          return;

        done=1;
        break;

      case '%': /* double % output the '%' character */
        result = _buf_alloc(error_buf, error_buf_len, outlen+1);
        if (result != SASL_OK)
          return;
        (*error_buf)[outlen]='%';
        outlen++;
        done=1;
        break;

      case 'm': /* insert the errno string */
        result = _sasl_add_string(error_buf, error_buf_len,
                      &outlen,
                      strerror(va_arg(ap, int)));
        if (result != SASL_OK)
          return;
        done=1;
        break;

      case 'z': /* insert the sasl error string */
        result = _sasl_add_string(error_buf, error_buf_len, &outlen,
             (char *)sasl_errstring(_sasl_seterror_usererr(
                            va_arg(ap, int)),NULL,NULL));
        if (result != SASL_OK)
          return;
        done=1;
        break;

      case 'c':
        frmt[frmtpos++]=fmt[pos];
        frmt[frmtpos]=0;
        tempbuf[0] = (char) va_arg(ap, int); /* get the next arg */
        tempbuf[1]='\0';

        /* now add the character */
        result = _sasl_add_string(error_buf, error_buf_len,
                      &outlen, tempbuf);
        if (result != SASL_OK)
          return;
        done=1;
        break;

      case 'd':
      case 'i':
        frmt[frmtpos++]=fmt[pos];
        frmt[frmtpos]=0;
        ival = va_arg(ap, int); /* get the next arg */

        snprintf(tempbuf,20,frmt,ival); /* have snprintf do the work */
        /* now add the string */
        result = _sasl_add_string(error_buf, error_buf_len,
                      &outlen, tempbuf);
        if (result != SASL_OK)
          return;
        done=1;

        break;
      default: 
        frmt[frmtpos++]=fmt[pos]; /* add to the formating */
        frmt[frmtpos]=0;        
        if (frmtpos>9) 
          done=1;
      }
    pos++;
    if (pos>formatlen)
      done=1;
      }

    }
  }

  (*error_buf)[outlen]='\0'; /* put 0 at end */

  va_end(ap);  

#ifndef SASL_OSX_CFMGLUE
  if(!(flags & SASL_NOLOG)) {
      /* See if we have a logging callback... */
      result = _sasl_getcallback(conn, SASL_CB_LOG, (sasl_callback_ft *)&log_cb, &log_ctx);
      if (result == SASL_OK && ! log_cb)
      result = SASL_FAIL;
      if (result != SASL_OK)
      return;

      result = log_cb(log_ctx, SASL_LOG_FAIL, conn->error_buf);
  }
#endif /* SASL_OSX_CFMGLUE */
} 
```

它们周围根本没有#defines。当我编译时：`gcc -DHAVE_CONFIG_H -I. -I.. -I../include -I../lib -I../sasldb -I../include -Wall -W -g -O2 -c seterror.c`nm 产生：

```
$ nm seterror.o
00000000 b .bss
00000000 d .data
00000000 N .debug_abbrev
00000000 N .debug_aranges
00000000 N .debug_info
00000000 N .debug_line
00000000 N .debug_loc
00000000 N .debug_ranges
00000000 N .debug_str
00000000 r .eh_frame
00000000 r .rdata
00000000 吨 .text
         U __buf_alloc
         U __imp__sasl_errstring
         U __sasl_add_string
         U __sasl_get_errorbuf
         U __sasl_getcallback
00000000 T _sasl_seterror
         U_snprintf
         U_strerror

```

为什么没有地址？如果我在库上运行 nm，我会得到：

```
$ nm .libs/libsasl2.a | grep sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
         U __imp__sasl_seterror
00000000 T _sasl_seterror

```

还是没有地址，为什么？最后，当我尝试链接库时，我收到错误消息`undefined reference to '__imp__sasl_seterror'`。

谁能帮忙解释这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:38:58.917

```
static int _sasl_seterror_usererr(int saslerr);

void sasl_seterror(sasl_conn_t *conn,
           unsigned flags,
           const char *fmt, ...); 
```

它们都没有定义一个函数，他们只声明它。他们承诺您将提供该功能，但自己不提供。结果，当您违反承诺时会出现链接错误。

您需要实际定义函数以获取地址并链接到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:42:18.447

有一个标题行链接如下：

```
LIBSASL_API void sasl_seterror(sasl_conn_t *conn, unsigned flags,
                   const char *fmt, ...); 
```

并被`LIBSASL_API`定义为：

```
 #ifdef WIN32
#  ifdef LIBSASL_EXPORTS
#   define LIBSASL_API  __declspec(dllexport)
#  else /* LIBSASL_EXPORTS */
#   define LIBSASL_API  __declspec(dllimport)
#  endif /* LIBSASL_EXPORTS */
#else /* WIN32 */
# define LIBSASL_API extern
#endif /* WIN32 */ 
```

因此，该函数正在编译，就好像它将被动态链接一样。

然而，nm 仍在为 sasl_seterror 生成 00000000 T，但链接器不再抱怨该函数。

# ruby-on-rails - 接受散列或散列数组作为 Ruby 方法的参数

> ID：11939383
> 
> 赞同：7
> 
> 时间：2012-08-13T17:37:24.577
> 
> 标签：ruby-on-rails, ruby

我有方法：

```
def self.store(params)
  params.each { }
end 
```

如果我传递一个哈希数组，它会完美运行：

```
params = [ { key: 'value' }, { key: 'value' } ] 
```

但是，我可能只想传递一个散列，而不是散列数组：

```
params = { key: 'value' } 
```

**将哈希转换为哈希数组的最干净的 Ruby 方法是什么？**

Array() 方法可以确保始终返回一个数组，但是当传递 Hash 时，它本身会转换为一个数组。

```
Array({ key: 'value' }) => [[:key, 'value']] 
```

我需要的：

```
 { key: 'value' } => [ { key: 'value' } ] 
```

有什么好的方法来实现这个，还是我必须使用 is_a 进行手动类型检查？（数组）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T19:19:33.000

对我来说，最好的解决方案是将方法更改为：

```
def self.store(*hashes)
  params = hashes.flatten
  puts params.inspect
end 
```

*   如果您传递单个哈希，它将是一个数组
*   如果你传递一个哈希数组，它保持不变
*   如果你传递 N 个哈希，它会将所有参数压缩成一个一维数组。

你可以通过任何你想要的。

```
self.store({:key => 'value'}) # => [{:key => 'value'}]
self.store({:key => 'value'}, {:foo => 'bar'}) # => [{:key => 'value'}, {:foo => 'bar'}]
self.store([{:key => 'value'}, {:foo => 'bar'}]) # => [{:key => 'value'}, {:foo => 'bar'}] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T17:48:58.293

试试这个

```
def self.store(params)
  params = [params].flatten
  ...
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-30T15:04:30.037

我会这样做：

```
def self.store(params)
  (params.is_a?(Array) ? params : [params]).each {|single_hash| }
end 
```

# c# - 如何从列表框中获取/正确设置项目值（不是文本）？

> ID：11939387
> 
> 赞同：2
> 
> 时间：2012-08-13T17:37:34.560
> 
> 标签：c#, winforms, visual-studio-2008, telerik

我有 2 个列表框作为数据传输控件一起工作。因此，我可以使用 2 个按钮从左到右移动项目，反之亦然等，然后使用第三个按钮，我需要获取其中一个列表中项目的值（而不是文本部分）。

视觉上一切看起来都很好。物品来回移动没有问题。但是到了拿东西的时候，就没有运气了。. .

对于我的点击之一：

```
Telerik.WinControls.UI.RadListDataItem item = new Telerik.WinControls.UI.RadListDataItem(lstRight.SelectedItem.Text, lstRight.SelectedItem.Value);
List<Telerik.WinControls.UI.RadListDataItem> left = new List<Telerik.WinControls.UI.RadListDataItem>();
for (int i = 0; i < lstLeft.Items.Count; i++)
{
    Telerik.WinControls.UI.RadListDataItem z = new Telerik.WinControls.UI.RadListDataItem(lstLeft.Items[i].Text, lstLeft.Items[i].Value);
    left.Add(z);
}
left.Add(item);
lstLeft.DataSource = left;
lstRight.Items.Remove(lstRight.SelectedItem); 
```

我已经尝试将它与 Telerik、requular ms 列表框等一起使用，但没有运气。之后我无法获得价值。我也不能简单地插入一个项目，“在数据绑定模式下无法插入项目”的东西......

有谁知道如何解决这个问题或告诉我哪里出错了？我在这方面被困了一段时间，只是看不出我做错了什么......

# php - 在 PHP 中处理许多不同的 SQL 查询

> ID：11939394
> 
> 赞同：0
> 
> 时间：2012-08-13T17:38:07.900
> 
> 标签：php, sql, design-patterns

我有一个 Web 应用程序，它使用几十个不同的查询来显示来自 Web 的各种不同的结果。这些查询都是相对独特的，使用不同的表，并且已经尽可能多地组合在一起。我无法更改架构，因此我的 SQL 是一成不变的。

我正在使用的当前设置或多或少是一个大型函数库，其中每个函数都与数据库建立一个公共连接，执行函数中定义的查询，然后以任何需要的方式回显数据。我正在考虑使用 OOP 来减少冗余，但我正在努力了解如何处理 SQL 查询。我有近 2000 行纯 SQL 污染了我的代码。它有效，但对我来说真的是维护的噩梦。

存储这些查询的好习惯是什么？

澄清一下，我说的是保存我的 SQL 字符串的变量。

```
$sql = "SELECT * FROM table WHERE x=x" 
```

只有太多而无法合理跟踪。

# ruby-on-rails - 获取网络更新时如何从linkedin api获取位置字段

> ID：11939395
> 
> 赞同：0
> 
> 时间：2012-08-13T17:38:20.363
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, api, linkedin

我想获取人员和连接的位置，那么我应该如何为此目的指定字段？

```
http://api.linkedin.com/v1/people/~/network/updates:(update-content:(person:(id,headline,location)))?type=CONN 
```

如果我为了获取位置而再次拨打电话，这对我来说将非常昂贵，因为它需要为每个新连接拨打额外的电话，并且会以指数方式增加通话次数。所以，我想要一些解决方案，使用它我可以在网络更新 API 调用本身中获取位置。

**编辑：**我需要的另一件事是检查连接的隐私设置。据我所知，linkedin 没有提供任何 api 来返回哪些连接允许查看更新而哪些不是。因此，当我尝试获取特定连接的网络更新时，它会返回此用户不允许公众查看更新的错误。如果我想在调用网络更新 API 之前检查这个东西，我怎么能用 Ruby 语言来做呢。

或者

让我知道一些在调用linkedin API 时传递多个动态ID 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T01:16:23.723

检索与网络更新关联的人员数据时，似乎[只有基本字段可用](https://developer.linkedin.com/comment/15809#comment-15809)。解决方案是获取此人的 id 并再次调用[Profile API](https://developer.linkedin.com/documents/profile-api)：

```
http://api.linkedin.com/v1/people/id=12345:(first-name,last-name,connections,location) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T07:38:26.477

目前，linkedin 没有为此提供任何 API。为此，您必须进行多次调用。但是您应该分块进行这些调用以避免超时问题。

[参考](https://developer.linkedin.com/documents/connections-api)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-30T13:44:49.290

试试这个 api

```
 `String url = "https://api.linkedin.com/v1/people/~/connections:(id,first-name,last-name,location,picture-url,positions:(title,company:(name)))"; ` 
```

# algorithm - 在 R 中，相当于 upper_bound()

> ID：11939402
> 
> 赞同：2
> 
> 时间：2012-08-13T17:38:53.563
> 
> 标签：algorithm, r, date

我有两个日期 A 和 B 的向量。我想对于 A 的每个日期，获得 B 中大于或优于日期本身的最接近的日期。

（原因是 B 是工作日列表，我需要我的输出是工作日）。

如何在 R 中以矢量化方式执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:48:34.707

这应该可行，尽管可能有一个矢量化的解决方案：

```
sapply(d1, function(x) min(d2[d2>x])) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:17:09.487

为应用逻辑 +1 给blindJesse，但需要注意不存在最近日期的情况以及发生的对数字的强制：

```
a <- as.Date(sample(1:20, 5, T), origin=Sys.Date())
#[1] "2012-08-26" "2012-08-31" "2012-08-25" "2012-08-18" "2012-08-20"
b <- as.Date(sample(1:20, 5, T), origin=Sys.Date())
#[1] "2012-08-27" "2012-08-27" "2012-08-25" "2012-08-22" "2012-08-17"

sapply(a, function(x) min(b[b>x]))
#[1] 15579   Inf 15579 15574 15574

# generate the min index instead, catching for no min case
min.indices <- sapply(a, function(x) {
  ifelse(length(which.min(b[b>x]))==0, NA, which.min(b[b>x]))
})

b[min.indices]
#[1] "2012-08-27" NA           "2012-08-27" "2012-08-22" "2012-08-22" 
```

# ruby - 默认情况下将选项设为 false

> ID：11939405
> 
> 赞同：5
> 
> 时间：2012-08-13T17:39:17.200
> 
> 标签：ruby, options

这是在 Ruby 中设置默认值的常用方法：

```
class QuietByDefault
  def initialize(opts = {})
    @verbose = opts[:verbose]
  end
end 
```

这是一个容易掉入的**陷阱：**

```
class VerboseNoMatterWhat
  def initialize(opts = {})
    @verbose = opts[:verbose] || true
  end
end 
```

这是一个正确的方法：

```
class VerboseByDefault
  def initialize(opts = {})
    @verbose = opts.include?(:verbose) ? opts[:verbose] : true
  end
end 
```

最好/最干净的编码方式是`VerboseByDefault`什么？（当然，我可以把它排除在外。）

一般在 Ruby 代码中广泛使用什么模式（如果有的话）？ActiveSupport 有这方面的模式吗？（最小更好——我不需要完整的命令行选项解析器。）

咆哮 PS：我不喜欢处理默认选项`true`的代码与处理默认`false`选项的代码之间的不对称。一种在两者之间进行更改而不引起错误的模式将是一件好事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T02:00:03.413

A simple way to do it is by using the second argument to Hash#fetch

```
class VerboseByDefault
  def initialize(opts = {})
    @verbose = opts.fetch(:verbose, true)
  end
end 
```

For complex defaults, fetch can also take a block, which is executed if the value isn't in the hash. See: [http://ruby-doc.org/core-1.9.3/Hash.html#method-i-fetch](http://ruby-doc.org/core-1.9.3/Hash.html#method-i-fetch)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:47:05.767

我通常将其视为设置所有默认值，然后将它们与 opts 合并。如..

```
def initialize(opts = {})
  @options = { :verbose => false, :foo => 42 } 
  @options.merge!(opts)
  # ...
end 
```

This way all of your options are set in one place and you just merge the user supplied ones.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T01:16:54.357

```
require 'active_support/core_ext/hash/reverse_merge'
class VerboseByDefault
  DEFAULTS = { verbose: true }
  def initialize(opts = {})
    opts.reverse_merge!(DEFAULTS)
    @verbose = opts[:verbose]
  end
end 
```

This isn't only a little cleaner just for one option, but it becomes way better if you have more options. Also, it uses the same pattern for `true` and `false`.

# python - 目录和子目录中的所有文件

> ID：11939408
> 
> 赞同：1
> 
> 时间：2012-08-13T17:39:25.967
> 
> 标签：python, python-2.7

我想找到一个目录和所有子目录中的所有文件。

使用的代码：

```
import os
import sys

path = "C:\\"
dirs = os.listdir(path)
filename = "C.txt"
FILE = open(filename, "w")
FILE.write(str(dirs))
FILE.close()
print dirs 
```

问题是 - 此代码仅列出目录中的文件，而不是子目录。为了也列出子目录中的文件，我需要更改什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:41:11.377

要遍历目录树，您需要为此使用[os.walk()](http://docs.python.org/library/os.html?highlight=os.walk#os.walk)。

这是一个帮助您入门的示例：

```
import os

searchdir = r'C:\root_dir' # traversal starts in this directory (the root) 

for root, dirs, files in os.walk(searchdir):
    for name in files:
        (base, ext) = os.path.splitext(name) # split base and extension
        print base, ext 
```

这将使您可以访问文件名和组件。

您会发现[os](http://docs.python.org/library/os)和[os.path](http://docs.python.org/library/os.path.html)模块中的函数对此类工作非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:42:34.187

此功能将为您提供帮助：os.path.walk() [http://docs.python.org/library/os.path.html#os.path.walk](http://docs.python.org/library/os.path.html#os.path.walk)

# java - 如何计算地图跨度/缩放以在视口中包含一组地理点？

> ID：11939409
> 
> 赞同：3
> 
> 时间：2012-08-13T17:39:26.857
> 
> 标签：java, android, algorithm, google-maps

我有一组 GeoPoints，想要找到 Lat/Lon 中心和包含所有这些 GeoPoints 的跨度（因此它们在 MapView 上都可见）。

在平面地图上，这将相当简单，找到最高和最低的 x/y 值，通过将绝对距离的一半与较低值相加来找到中心。

但是对于球形世界地图来说，这是如何做到的，其中 -180/+180 和 +90/-90 的最大值/最小值彼此相邻？

这是我正在尝试做的事情：

```
public void zoomToGeoPoints(GeoPoint... geoPoint) {

    MapController mc = getController();
    if (geoPoint == null) {
        Log.w(TAG, "No geopoints passed, doing nothing!");
        return;
    }

    // Set inverse max/min start values 
    int maxLat = (int) (-90 * 1E6);
    int maxLon = (int) (-180 * 1E6);
    int minLat = (int) (90 * 1E6);
    int minLon = (int) (180 * 1E6);

    // Find the max/min values
    for (GeoPoint gp : geoPoint) {
        maxLat = Math.max(maxLat, gp.getLatitudeE6());
        maxLon = Math.max(maxLon, gp.getLongitudeE6());
        minLat = Math.min(minLat, gp.getLatitudeE6());
        minLon = Math.min(minLon, gp.getLongitudeE6());
    }

    // Find the spans and center point
    double spanLat = Math.abs(maxLat - minLat);
    double spanLon = Math.abs(maxLon - minLon);

    int centerLat = (int) ((minLat + spanLat / 2d));
    int centerLon = (int) ((minLon + spanLon / 2d));

    GeoPoint center = new GeoPoint(centerLat, centerLon);

    // Pan to center
    mc.animateTo(center);           

    // Zoom to include all GeoPoints
    mc.zoomToSpan((int)(spanLat), (int)(spanLon)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T08:19:32.960

未经测试，使用 JavaScript 中的 Maps API 计算所需的最小边界框：

```
// points[] is your array of geo points
var boundbox = new map.LatLngBounds();
for (var i=0; i<points.length; i++){ 
  boundbox.extend(points[i]);
}
var center = boundbox.getCenter(); 
```

# icefaces-3 - icefaces ace 组件有大字体

> ID：11939414
> 
> 赞同：0
> 
> 时间：2012-08-13T17:39:45.407
> 
> 标签：icefaces-3

我正在使用icefaces 3。我的所有 ace 组件都使用 css 正确显示，但唯一的问题是我的所有 ace 组件都有大字体和大尺寸。

与 icefaces 展示中显示的组件尺寸相比，尺寸要大得多。

有人可以阐明可能导致此问题的原因。

# javascript - 选择下拉列表项时添加行

> ID：11939416
> 
> 赞同：0
> 
> 时间：2012-08-13T17:39:53.503
> 
> 标签：javascript, jquery, asp.net, drop-down-menu

![在此处输入图像描述](../Images/d94184240b2a5ca2f23b8521970732d0.png)

我有名为模块、优先级、请求日期等的数据行，这些数据行是在我的网站上动态获取的。当从我的下拉列表中选择计算机请求的值时，有没有办法可以在名为“成本中心”的模块下添加一行？这是下拉列表的代码。

```
 <span id="dg_form_ctl02_lbl_show_tag" style="display:inline-block;background-    color:Transparent;border-color:Navy;border-width:3px;border-style:Double;font-    family:Arial;font-size:12px;width:130px;">Module*</span> 
                                                </td><td>

                                                    <select name="dg_form$ctl02$DropDownList1" onchange="javascript:setTimeout('__doPostBack(\'dg_form$ctl02$DropDownList1\',\'\')', 0)" id="dg_form_ctl02_DropDownList1">
        <option value="">--select one--</option>
        <option value="Cellular Phone">Cellular Phone Request</option>
        <option selected="selected" value="Computer">Computer Request (Up to VP Approval)</option>
        <option value="Account Creation">Create Network/SAP Account</option>
        <option value="Account Delete">Delete Network/SAP Account</option>
        <option value="FIS">FIS</option>
        <option value="FP">FP</option>
        <option value="General">General Support</option>
        <option value="Report">Reports</option>
        <option value="SAP">SAP</option>
        <option value="Web Application">Web Application</option>

    </select>

                                                </td>
</tr><tr style="background-color:White;">
    <td valign="top"> 
```

这是我到目前为止的警报代码

```
function alertMe() {
var n = document.getElementById("dg_form_ctl02_DropDownList1").value;
if (n == "Computer") {
alert ('Changed'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:44:26.243

我认为这会奏效

```
selectObject.add(option,before)

function GetSelectedValue(selectItem)
{
var index = document.getElementById(selectItem).selectedIndex;

alert("value =" + document.getElementById(selectItem).value);
alert("text =" + document.getElementById(selectItem).options[index].text);
}

<select id="mySelect">
<option>Apple</option>
<option>Pear</option>
<option>Banana</option>
<option>Orange</option> 
```

# asp.net-mvc-3 - MVC 3 Html.DropDownList 错误

> ID：11939418
> 
> 赞同：0
> 
> 时间：2012-08-13T17:39:57.810
> 
> 标签：asp.net-mvc-3

我有那个错误

```
The ViewData item that has the key 'BookAttributesDDL' is of type 'System.String' but must be of type 'IEnumerable<SelectListItem>'. 
```

在该代码中：

```
@Html.DropDownList("BookAttributesDDL", Model.BookAttributes_Items) 
```

但是`Model.BookAttributes_Items`是类型的`IEnumerable<SelectListItem>`！怎么了 ？

即时窗口的`ViewData.Keys`属性：

```
ViewData.Keys
Count = 2
    [0]: "FCoookie"
    [1]: "Title" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:06:32.333

尽量避免像 ViewBag 和 ViewData 这样的动态变量。随着代码的增长，它将使您的代码在将来难以阅读并且难以维护。ViewBag 就像魔术字符串！

切换到**ViewModel**方法。

例如，如果您正在创建一个视图来创建一本书，请为这样的创建一个`Viewmodel`（*它只是一个普通的类*）

```
public class BookViewModel
{
  public int BookId { set;get;}
  public string BookName {set;get;}
  public IEnumerable<SelectListItem> Attributes{ get; set; }
  public int SelectedAttribute{ get; set; }

} 
```

现在在您的`GET`操作中，只需创建此类的一个对象，将属性设置`BookAttribbutes`为您的下拉项目并将此 ViewModel 对象传递给视图

```
public ActionResult Create()
{
  BookViewModel vm=new BookViewModel();
  //The below code is hardcoded for demo. you mat replace with DB data.
  vm.Attributes=new[]
  {
    new SelectListItem { Value = "1", Text = "F Cookie" },
    new SelectListItem { Value = "2", Text = "Title" },
  }
  return View(vm);
} 
```

现在我们将把我们的视图强类型化到这个 ViewModel 类

```
@model BookViewModel
@using(Html.BeginForm())
{
 @Html.TextBoxFor(x=>x.BookName)
 @Html.DropDownListFor(x => x.SelectedAttribute, 
      new SelectList(Model.Attributes, "Value", "Text"), "Select Attribute")

 <input type="submit" value="Save" />
} 
```

现在，您将通过访问 ViewModel 的相应属性在 HttpPost 操作中获取 Selected Dropdown 值和文本框值

```
[HttpPost]
public ActionResult Create(BookViewModel model)
{
  if(ModelState.IsValid)
  { 
    //check for model.BookName / model.SelectedAttribute
  }
  //validation failed.TO DO : reload dropdown here
  return View(model);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:35:02.000

完全同意 View Model 方法对您的回应（以及选择它有用的我）。但是，如果您不想切换，但保持原样，我敢打赌您的答案就在[这篇文章中](https://stackoverflow.com/questions/3393521/the-viewdata-item-that-has-the-key-my-key-is-of-type-system-string-but-must)。

希望这对您有所帮助。

# c - 使用 C 中的清理处理程序安全取消 pthread

> ID：11939422
> 
> 赞同：1
> 
> 时间：2012-08-13T17:40:13.920
> 
> 标签：c, linux, multithreading, concurrency, pthreads

我们已经获得了一些代码来查看以准备有关 pthread 的考试并正确取消它们。我们被要求解释什么是错误的，并修复它。

我的回答：线程处理函数进入等待状态而不释放互斥体，但我觉得我错过了一些东西。这是代码，添加了添加清理处理程序的行以修复程序。同样，我不太确定为什么会这样。（我了解清理处理程序的概念，但我不明白为什么它解决了这个特定问题 - 我不确定我的答案是否正确的另一个原因）

```
#include <stdio.h>
#include <unistd.h>
#include <pthread.h>

pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;
pthread_cond_t cv = PTHREAD_COND_INITIALIZER;
const int flag = 1;

static void * cancelme(void *bb_in)
{
  pthread_mutex_lock(&mutex);

  /* Install a cleanup handler */
  pthread_cleanup_push(pthread_mutex_unlock, &mutex);

  while (flag) {
    pthread_cond_wait(&cv, &mutex);
  }

  //before insertion of cleanup handlers: pthread_mutex_unlock(&mutex); was here

  /* Uninstall cleanup handler */
  pthread_cleanup_pop(1);

  return (NULL);
}

int main()
{
  pthread_t t;
  pthread_create(&t, NULL, cancelme, NULL);
  sleep(1);
  pthread_cancel(t);

  printf("Waiting for thread to finish...\n");
  pthread_join(t, NULL);
  printf("Thread finished...\n");

  printf("Waiting to acquire lock...\n");
  pthread_mutex_lock(&mutex);
  printf("Lock acquired\n");

  return (0);
} 
```

非常感谢任何反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:50:25.710

看起来将`pthread_mutex_unlock`函数推送到线程清理堆栈的代码通过`pthread_cleanup_push`使代码片段工作，因为否则线程将获取共享锁并被迫退出而不释放它。

通过将`pthread_mutex_unlock`函数压入清理堆栈，线程确保在线程退出时互斥锁将被解锁，即使强制退出并且`pthread_cleanup_pop`函数未命中也是如此。

本质上，清理队列使您能够确保在退出时执行代码/释放资源等。只调用清理堆栈上的`pthread_cleanup_pop function`顶部函数，而退出调用清理堆栈上的所有函数。`pthread_cleaup_push`有关更多信息，请参见该人。

# ruby - Resque 工作人员在启动时失败

> ID：11939425
> 
> 赞同：0
> 
> 时间：2012-08-13T17:40:27.023
> 
> 标签：ruby, ruby-on-rails-3, resque

Resque 工作人员不会在我的 rails 应用程序中本地启动。我输入以下命令来启动一个工人。

```
COUNT=1 QUEUE=* rake resque:work --trace 
```

我遇到了以下错误。我以前有这个工作，不知道是什么导致了现在出现的错误。

```
(in /home/omar/Github/brooklin)
** Invoke resque:work (first_time)
** Invoke resque:preload (first_time)
** Invoke resque:setup (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute resque:setup
** Execute resque:preload
rake aborted!
No such file to load -- exception
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:317:in `rescue in depend_on'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:312:in `depend_on'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:225:in `require_dependency'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/railties-3.2.6/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/railties-3.2.6/lib/rails/engine.rb:438:in `each'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/railties-3.2.6/lib/rails/engine.rb:438:in `block in eager_load!'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/railties-3.2.6/lib/rails/engine.rb:436:in `each'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/railties-3.2.6/lib/rails/engine.rb:436:in `eager_load!'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/gems/resque-1.21.0/lib/resque/tasks.rb:54:in `block (2 levels) in <top (required)>'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/home/omar/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'
/home/omar/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `load'
/home/omar/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `<main>'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/bin/ruby_noexec_wrapper:14:in `eval'
/home/omar/.rvm/gems/ruby-1.9.3-p194@Brooklin/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => resque:work => resque:preload 
```

下面是我的 lib/tasks/resque.rake 文件。

```
require 'resque/tasks'
require 'resque_scheduler/tasks'

task "resque:setup" => :environment do
    ENV['QUEUE'] = '*'
end

desc "Alias for resque:work (To run workers on Heroku)"
task "jobs:work" => "resque:work"

task "resque:scheduler_setup" => :environment 
```

通过在 config/application.rb 中添加以下内容，我已将 resque.rake 文件添加到加载路径

```
config.autoload_paths += %W(#{config.root}/lib/tasks/) 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T03:58:07.673

输出语句有点误导。

```
No such file to load -- exception 
```

原来我`require exception`在我的一个模型中，它在抱怨，因为它找不到文件异常。

# java - 使用 java 从 eclipse 运行 Mac OSX 命令

> ID：11939429
> 
> 赞同：3
> 
> 时间：2012-08-13T17:40:48.433
> 
> 标签：java, macos, command-line, execute

我正在尝试制作一个简单的 java 程序来使用终端命令取消隐藏 osx 上的 ~\Library\ 文件夹。据我研究从java运行系统命令的代码是 Runtime.getRuntime().exec(); 并且在我查找的每个地方都被列为此类。

但是，我的程序不起作用。主要方法如下。

```
public static void main(String[] args) throws IOException {

    String[] noHide = {"chflags"," " ,"nohidden"," ", "~/Library/"};
    try {
        Runtime.getRuntime().exec(noHide);
        System.out.println("library unhidden");
    } catch (Exception e ) {
        e.printStackTrace();
    }
} 
```

该程序不会抛出异常，并且编译和执行都很好，但是库文件夹根本不会取消隐藏。不管我重新格式化 cmd 字符串。以下格式均无效

```
String noHide = "chflags nohidden ~/Library";
String[] noHide = {"chflags", "nohidden","~/Library"};
String[] noHide = {"chflags"," " ,"nohidden"," ", "~/Library/"}; 
```

如果我删除它们会抛出异常的空格（好吧，不是字符串数组对象）。我可以从 osx 终端运行命令（chflags noHidden ~/Library）绝对没问题。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:48:17.690

你需要使用你拥有的`try`and `catch`。但是，你`main`应该是这样的：

```
public static void main(String[] args) {
    String[] noHide = {"chflags", "nohidden","~/Library"};
    try {
        Runtime.getRuntime().exec(noHide);
    } 
    catch (Exception e) {
        }
    } 
```

基本上，您不需要`throws IOException`. 这对我有用，所以如果它仍然不能在你的程序中工作，那么你设置某些东西的方式可能会有更大的问题。

# c# - 在 MVC 应用中添加路由规则

> ID：11939433
> 
> 赞同：1
> 
> 时间：2012-08-13T17:41:02.803
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-routing, url-routing

我正在尝试编写一个规则来映射一个 URL，但是因为我没有得到我想要的结果。到目前为止，我有这个规则：

```
routes.MapRoute(
            "Search", // Route name
            "{controller}/{action}/{product}/{page}", // URL with parameters
            new { controller = "Home", action = "Search", product = UrlParameter.Optional, page = UrlParameter.Optional } // Parameter defaults
        ); 
```

到目前为止，我可以使用它来实现这个结果：

```
 localhost:8493/home/search/myproduct
 localhost:8493/home/search/myproduct/2 
```

但我想做这样的事情：

```
 localhost:8493/myproduct 
```

所以这将路由到`home/search/myproduct`

我尝试了以下方法，但没有奏效：

```
routes.MapRoute(
            "DirectSearch", // Route name
            "{product}/{page}", // URL with parameters
            new { controller = "Home", action = "Search", } // Parameter defaults
        ); 
```

有没有办法做到这一点？

**添加：**

所以在这里我添加了映射到另一个动作的特定路线，但它不起作用：

```
routes.MapRoute(
            "Tuna",
            "{controller}/{action}/{id}",
            new { controller = "Home", action = "Tuna", id = UrlParameter.Optional }
        ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:49:20.750

我想你很接近了。这应该有效；

```
routes.MapRoute(
            "Search", // Route name
            "{product}/{page}", // URL with parameters
            new { controller = "Home", action = "Search", product = UrlParameter.Optional, page = UrlParameter.Optional } // Parameter defaults
        ); 
```

请记住，框架将从上到下读取路由数据并使用它找到的第一个匹配的数据。因此，请确保在更一般的路线之前列出更具体的路线

**编辑**

[这是关于自定义路由的讨论的链接](http://stephenwalther.com/archive/2009/02/06/chapter-2-understanding-routing.aspx)

# jquery - 将僵局添加到 .draggable 而不重新定义它

> ID：11939438
> 
> 赞同：0
> 
> 时间：2012-08-13T17:41:22.770
> 
> 标签：jquery, jquery-ui

单击按钮时，我想打开/关闭死锁。问题是我不想像现在这样每次都重新定义它。

现在我最终在 .draggable() 及其属性的设计背后做了大量的代码。

当我单击按钮打开死机时，它或多或少只是

```
 $("div.draggable").draggable({
     "option": "grid", [20,20]
 }); 
```

当它被删除时，我会说：

```
$("div.draggable").draggable({
   "option", "grid", false
}); 
```

在代码隐藏中，它覆盖了所有内容。

有没有办法说当前正在运行的可拖动并将其扩展为或多或少地覆盖死锁功能？

我可以将每个元素的内容存储在一个函数中，然后只调用所有内容，但是当您可以运行某些东西然后在没有新定义的情况下对其进行修改时，我觉得这很愚蠢。

想法？想法？

**编辑：我的目标是允许它保留所有当前的就地功能，然后只修改网格控件。**

*在我看来，我认为赋予它这种能力是一种重新定义，而不仅仅是一个过程的应用。也许它不是重新应用东西，而是修改它？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:10:41.890

我的问题还在于这些行没有被执行。当它确实击中它时，一切又开始工作了。

# php - 获取页面html标签数量的好方法

> ID：11939439
> 
> 赞同：0
> 
> 时间：2012-08-13T17:41:22.383
> 
> 标签：php, dom, curl, depth, scraper

我正在寻找一种好方法来做到这一点：我当前的方法似乎不允许超过 30-40 的搜索深度，即使在编辑`php.ini`设置以希望增加默认执行时间以及最大内存使用量之后也是如此。基本上，一旦搜索深度超过这个数量，服务器就会崩溃。

这是我的代码（`private function _ParseHtml($html, $depth = nDepth`）：

```
 if ($depth === 0)
        {
            return;
        }

        @$this->_dom->loadHTML($html);

        $this->nodes = $this->_dom->childNodes;

        $html = array();
        $iterCount = 0;

        foreach($this->nodes as $node)
        {
            if($node->hasChildNodes())
            {
                $html[$iterCount++] = $node->C14N();    
            }

            $this->_tagCount++;

            if ( $this->_config['Debug'] ) _wrapBreak("Tag Count incremented");
        }

        if( count( $html ) > 0 )
        {
            $static_depth = $depth - 1;

            foreach( $html as $parse )
            {
                $this->_ParseHtml( $parse, $static_depth );

                if ( $this->_config['Debug'] ) _wrapBreak("ParseHtml did return");
            }
        }

        _wrapBreak("<strong>Current Depth</strong> => <strong>{$depth}</strong>"); 
```

以及scrape`_Invoke()`函数的主要代码：

```
 $handle = curl_init($this->_url);

         curl_setopt($handle, CURLOPT_BUFFERSIZE, self::BUFSIZE); //BUFSIZE == 50000
         curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
         curl_setopt($handle, CURLOPT_FOLLOWLOCATION, true);

         $this->_data['html'] = curl_exec($handle);

         curl_close($handle);

     $this->_ParseHtml($this->_data['html']); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:47:50.250

HTML标签的数量应该很容易获得

```
$this->_dom->getElementsByTagName("*")->length; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:48:03.823

如此处所示：[计算页面 PHP 中的所有 HTML 标记](https://stackoverflow.com/q/3184284/1300235)

```
$dom = new DOMDocument;
$dom->loadHTML($HTML);
$allElements = $dom->getElementsByTagName('*');
echo $allElements->length; 
```

尽管链接中的示例没有使事件接近您拥有的嵌套级别数...

# javascript - 显示textarea的多行纯文本？

> ID：11939444
> 
> 赞同：3
> 
> 时间：2012-08-13T17:41:37.447
> 
> 标签：javascript, jquery, html, textarea, line-breaks

我只想显示 textarea 的多行纯文本，但我不想显示 textarea。

例子：

文本区域：

```
|===================|
| First line        |
| Second line       |
|___________________| 
```

多行纯文本：

```
First line
Second line 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:47:19.617

您可以使用[`<pre>`](http://www.w3schools.com/tags/tag_pre.asp)，它定义预格式化的文本并保留空格和换行符：

```
var txt="First line\nSecond line";
document.body.innerHTML+="<pre>"+txt+"</pre>"; 
```

或者如果你想用 CSS 来做，或者你想要更多关于空格和换行符的选项，你可以使用 CSS 属性[`white-space`](http://www.w3schools.com/cssref/pr_text_white-space.asp)：

Javascript：

```
var txt="First line\nSecond line";
document.getElementById('mydiv').innerHTML=txt; 
```

CSS：

```
#mydiv{white-space:pre;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:44:43.810

文本区域的 CSS：

```
textarea { 
    border-style: none; 
    border-color: Transparent; 
    overflow: auto;        
  } 
```

# php - Highstock - 通过使用 php 创建的 csv 创建 OHLC 图

> ID：11939449
> 
> 赞同：0
> 
> 时间：2012-08-13T17:41:55.763
> 
> 标签：php, javascript, csv, highcharts, highstock

我在导入 csv 以获得 highstock 图表时遇到了一些问题。我使用与 ohlc 示例相同的代码（在本地运行良好），但使用了另一个 CSV，它是由 php 在我的本地主机上创建的。

PHP 获取 CSV

```
<?PHP

// Declare the new variable as an array
$arrCSV = array();

// Open the CSV file
if (($handle = fopen("http://ichart.finance.yahoo.com/table.csv?s=AAPL&d=7&e=7&f=2012&g=d&a=8&b=7&c=1984&ignore=.csv", "r")) !==FALSE)
{

// Set the parent array key to 0
$key = 0;
// While there is data available loop through unlimited times (0) using separator (,)
while (($data = fgetcsv($handle, 0, ",")) !==FALSE) {

    // Count the total keys in each row
    $c = count($data);
    //print  $c . "<BR>"; // <------ 7 o numero de colunas

    //Populate the array
    If ($key != 0) {
        $arrCSV[$key-1][0] = strtotime($data[0]); //Time
        $arrCSV[$key-1][1] = $data[1];            //Open
        $arrCSV[$key-1][2] = $data[2];            //High
        $arrCSV[$key-1][3] = $data[3];            //Low
        $arrCSV[$key-1][4] = $data[6];            //Adj Close
        $arrCSV[$key-1][5] = $data[5];            //Volume
    }

    $key++;
} // end while

$keymax = $key;

// Close the CSV file
fclose($handle);
} // end if

print "?(/* AAPL historical OHLC data from the Google Finance API */<BR>";
echo json_encode($arrCSV,JSON_NUMERIC_CHECK);
print ");";

?> 
```

导入和创建图表的代码：

```
<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <title>Highstock Example</title>

          <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <script type="text/javascript">
$(function() {
   $.getJSON('http://localhost/teste03.php', function(data) {

      // create the chart
      chart = new Highcharts.StockChart({
         chart : {
            renderTo : 'container'
         },

         rangeSelector : {
            selected : 2
         },

         title : {
            text : 'AAPL Stock Price'
         },

         series : [{
            type : 'ohlc',
            name : 'AAPL Stock Price',
            data : data,
            dataGrouping : {
               units : [[
                  'week', // unit name
                  [1] // allowed multiples
               ], [
                  'month', 
                  [1, 2, 3, 4, 6]
               ]]
            }
         }]
      });
   });
});

      </script>
   </head>
   <body>
<script src="js/highstock.js"></script>
<script src="js/modules/exporting.js"></script>

<div id="container" style="height: 500px; min-width: 500px"></div>
   </body>
</html> 
```

最后它只是给我一个空白页......这是由使用本地主机引起的吗？数组的顺序（下降而不是上升）？

帮助？

更新：添加了 json_encode 但仍然不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:23:44.000

**进一步编辑** 似乎您可能有 ajax 问题，请尝试通过以下方式进行隔离测试

使用`SimpleTest.php`（请参阅**OLD**部分的代码）并将其托管在与当前相同的服务器上`teste03.php`，并从中访问图表

```
 $.getJSON('http://localhost/SimpleTest.php', function(data) {
 ...
 } 
```

或者

```
<script type="text/javascript">
$(function() {
// $.getJSON('http://localhost/teste03.php', function(data) {
   var data= [[1000000,1,2,3,4],[2000000,3,2,3,4],[1000000,1,2,3,4]];
  // create the chart
  chart = new Highcharts.StockChart({
   ... 
```

如果上述任何方法有效，则意味着您有 ajax 问题而不是 highcharts 问题。

**已编辑**（基于您对返回的 json 的评论）

数据中的时间戳值需要按升序排列。从您的以下 json

```
 [[1344290400,622.77,625,618.04,618.26,10373100],[1344204000,617.29,624.87,615.26‌​,619.89,10789400] 
```

1344290400>1344204000 因此不会工作。

**OLD**
使用[json_encode](http://in3.php.net/manual/en/function.json-encode.php)方法来形成 json。
您需要传递给它的是一个数组数组，其中外部数组的大小与 CSV 中的行数相同，并且该外部数组的每个元素都是另一个具有 5 个元素的数组，即。时间戳，开，高，低，收。

`SimpleTest.php`：

```
<?php
  // JSON header
  header('Content-type: application/json');

  // Do not cache the response
  header('Cache-Control: no-cache, must-revalidate');
  header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');  

  // Parse CSV, and populate the 5 arrays viz. $timeStamp, $open, $high, $low, $close
  $count=3;
  $timeStamp=array(1000000,2000000,3000000); // In ascending order of time
  $open=array(5,10,15);
  $high=array(10,15,20);
  $low=array(0,5,10);
  $close=array(8,12,18);

  $dataArray=array();   // Outer array of array

  for( $i=0; $i<$count; $i++ ){
     // push an array into $dataArray for each data group
     $dataArray[] = array($timeStamp[$i], $open[$i], $high[$i], $low[$i],$close[$i]);
  }

  echo json_encode($dataArray); // Encode php array of array into json and echo/print it to output
?> 
```

查看您的代码，我认为您可以调整 $arrCSV 以转换为所需的数组。

# .net - 通过远程处理将数据集从 .net 4 发送到 .net 3.5

> ID：11939451
> 
> 赞同：2
> 
> 时间：2012-08-13T17:42:10.480
> 
> 标签：.net, dataset, .net-remoting

我有一个使用 .NET 3.5 并通过 .NET 远程处理公开一些方法的服务。其中一些方法需要一个 DataSet 作为参数。当客户端也运行 .NET 3.5 时，一切都很好。但是，当客户端运行 .NET 4 时，我收到以下远程异常（在服务器上）：

> 无法加载文件或程序集 'System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' 或其依赖项之一。该系统找不到指定的文件。

所以显然有两个版本的数据集 - 版本 2 和版本 4。我尝试创建一个单独的 .NET 3.5 项目，在该项目中创建数据集并将其发送到服务器。但是当它与其他 .NET 4 程序集一起加载到 .NET 4 运行时中时，它仍然使用 DataSet 版本 4。

最奇怪的是在 .net 3.5 中运行的不同服务我可以毫无问题地发送版本 4 数据集。我一直无法弄清楚那里有什么不同。

任何见解或解决方案将不胜感激。

**更新：** 微软似乎意识到了这个问题：见[这里](http://msdn.microsoft.com/en-us/library/ff576185)。非常可悲的是，如果真的需要这样的黑客来在不同的.NET版本之间进行通信......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T13:58:27.120

下面的代码实现了一个可以在客户端上使用的自定义 BinaryFormatterSink，而不是 BinaryClientFormatterSink。它基于[MSDN上的 microsoft 示例](http://msdn.microsoft.com/en-us/library/ff576185)

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Messaging;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters;
using System.Runtime.Serialization.Formatters.Binary;
using System.Text;

namespace bla
{
    class VersionConversionClientSinkProvider : IClientChannelSinkProvider
    {
        public IClientChannelSink CreateSink(IChannelSender channel, string url, object remoteChannelData)
        {
            if (Next != null )
            {
                var nextSink = Next.CreateSink(channel, url, remoteChannelData);
                if (nextSink != null)
                {
                    return new VersionConversionClientSink(nextSink);  
                }
            }
            return null;
        }

        public IClientChannelSinkProvider Next { get; set; }
    }

    class VersionConversionClientSink : IClientChannelSink, IMessageSink
    {
        public VersionConversionClientSink(IClientChannelSink channel)
        {
            _next = channel;
        }

        readonly IClientChannelSink _next;

        public IDictionary Properties
        {
            get { return NextChannelSink.Properties; }
        }

        public void ProcessMessage(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream, out ITransportHeaders responseHeaders, out Stream responseStream)
        {
            throw new NotSupportedException();
        }

        private void SerializeMessage(IMessage msg, out ITransportHeaders headers, out Stream stream)
        {
            var binaryFormatter = new BinaryFormatter
                {
                    Binder = new VersionConversionSerializationBinder()
                };

            stream = new MemoryStream();
            binaryFormatter.Serialize(stream, msg);
            stream.Position = 0;

            headers = new TransportHeaders();
        }

        private IMessage DeserializeMessage(Stream stream)
        {
            var binaryFormatter = new BinaryFormatter
                {
                    AssemblyFormat = FormatterAssemblyStyle.Simple
                };

            var msg = (IMessage) binaryFormatter.Deserialize(stream);
            stream.Close();
            return msg;
        }

        public void AsyncProcessRequest(IClientChannelSinkStack sinkStack, IMessage msg, ITransportHeaders headers, Stream stream)
        {
            throw new NotSupportedException();
        }

        public void AsyncProcessResponse(IClientResponseChannelSinkStack sinkStack, object state, ITransportHeaders headers, Stream stream)
        {
            sinkStack.AsyncProcessResponse(headers, stream);
        }

        public Stream GetRequestStream(IMessage msg, ITransportHeaders headers)
        {
            return _next.GetRequestStream(msg, headers);
        }

        public IClientChannelSink NextChannelSink
        {
            get { return _next; }
        }

        public IMessage SyncProcessMessage(IMessage msg)
        {
            IMethodCallMessage mcm = msg as IMethodCallMessage;
            try
            {
                ITransportHeaders headers;
                Stream stream;
                SerializeMessage(msg, out headers, out stream);
                ITransportHeaders responseHeaders;
                Stream responseStream;
                NextChannelSink.ProcessMessage(msg, headers, stream, out responseHeaders, out responseStream);
                if (responseHeaders == null)
                    throw new ArgumentNullException("returnHeaders");
                else
                    return DeserializeMessage(responseStream);
            }
            catch (Exception ex)
            {
                return new ReturnMessage(ex, mcm);
            }
        }

        public IMessageCtrl AsyncProcessMessage(IMessage msg, IMessageSink replySink)
        {
            var mcm = (IMethodCallMessage)msg;
            try
            {
                ITransportHeaders headers;
                Stream stream;
                SerializeMessage(msg, out headers, out stream);
                var channelSinkStack = new ClientChannelSinkStack(replySink);
                channelSinkStack.Push(this, msg);
                NextChannelSink.AsyncProcessRequest(channelSinkStack, msg, headers, stream);
            }
            catch (Exception ex)
            {
                IMessage msg1 = new ReturnMessage(ex, mcm);
                if (replySink != null)
                    replySink.SyncProcessMessage(msg1);
            }
            return null;
        }

        public IMessageSink NextSink
        {
            get { throw new NotSupportedException(); }
        }
    }

    class VersionConversionSerializationBinder : SerializationBinder
    {
        string[] frameworkPublicKeyTokens = new string[] {
                "B7-7A-5C-56-19-34-E0-89",
                "B0-3F-5F-7F-11-D5-0A-3A",
                "31-BF-38-56-AD-36-4E-35",
                "89-84-5D-CD-80-80-CC-91"
            };

        bool IsFrameworkAssembly(Assembly assembly)
        {
            foreach (string frameworkToken in frameworkPublicKeyTokens)
            {
                if (frameworkToken == BitConverter.ToString(assembly.GetName().GetPublicKeyToken()))
                {
                    return true;
                }
            }
            return false;
        }

        public override void BindToName(Type serializedType, out string assemblyName, out string typeName)
        {
            // To handle arrays
            if (serializedType.IsArray)
            {
                string elementTypeName;
                Type elementType = serializedType.GetElementType();
                BindToName(elementType, out assemblyName, out elementTypeName);
                StringBuilder typeNameBuilder = new StringBuilder(elementTypeName);
                typeNameBuilder.Append("[");
                int arrayRank = serializedType.GetArrayRank();
                for (int i = 1; i < arrayRank; i++)
                {
                    typeNameBuilder.Append(",");
                }
                if (arrayRank == 1 && serializedType == elementType.MakeArrayType(1))
                {
                    typeNameBuilder.Append("*");
                }
                typeNameBuilder.Append("]");
                typeName = typeNameBuilder.ToString();
            }
            // To handle generic types
            else if (serializedType.IsGenericType && !serializedType.IsGenericTypeDefinition)
            {
                string definitionTypeName;
                Type[] genericParameters = serializedType.GetGenericArguments();
                BindToName(serializedType.GetGenericTypeDefinition(), out assemblyName, out definitionTypeName);
                StringBuilder typeNameBuilder = new StringBuilder(definitionTypeName);
                typeNameBuilder.Append("[");
                for (int i = 0; i < genericParameters.Length; i++)
                {
                    if (i > 0)
                    {
                        typeNameBuilder.Append(",");
                    }
                    string parameterTypeName, parameterAssemblyName;
                    BindToName(genericParameters[i], out parameterAssemblyName, out parameterTypeName);
                    typeNameBuilder.AppendFormat("[{0}, {1}]", parameterTypeName, parameterAssemblyName);
                }
                typeNameBuilder.Append("]");
                typeName = typeNameBuilder.ToString();
            }
            // To handle the rest of types
            else
            {
                assemblyName = serializedType.Assembly.FullName;
                if (IsFrameworkAssembly(serializedType.Assembly))
                {
                    assemblyName = assemblyName.Replace("Version=4.0.0.0", "Version=2.0.0.0");
                }
                typeName = serializedType.FullName;
            }
        }

        public override Type BindToType(string assemblyName, string typeName)
        {
            return null;
        }
    }
} 
```

# c# - 通过 AccountManagement 将 AD 用户添加到计算机本地组

> ID：11939453
> 
> 赞同：0
> 
> 时间：2012-08-13T17:42:18.523
> 
> 标签：c#, active-directory, account-management, userprincipal

我想通过 User 和 GroupPrincipals 实现将 AD 用户添加到本地机器组，我认为它会工作得很好而且很容易。不幸的是，我继续收到 General Access Denied 错误。可能我只是不了解发生的正确身份验证，但我认为我已经设置了正确的访问权限。这是被调用的代码片段：

```
var ctx = new PrincipalContext(ContextType.Machine,
                               Environment.MachineName,
                               ConfigurationManager.AppSettings["MyUser"],
                               ConfigurationManager.AppSettings["MyPW"]);

        var grp = GroupPrincipal.FindByIdentity(ctx, IdentityType.Name, "LocalGrp");
        var adUser = ADService.GetUserByDomainUserName(vModel.ContactId);

        var adCtx = new PrincipalContext(ContextType.Domain,
                                         "myDomain.com",
                                         ConfigurationManager.AppSettings["MyUser"],
                                         ConfigurationManager.AppSettings["MyPW"])
                                              ;
        var user = UserPrincipal.FindByIdentity(adCtx, 
                                                IdentityType.Guid,
                                                adUser.UserGuid.ToString());

        if (grp != null &&
            user != null)
        {
            if(!user.IsMemberOf(grp))
            {
                grp.Members.Add(user);
                grp.Save();
            }
        } 
```

找到了用户，找到了组，但是当我添加并到达 grp.Save() 步骤时，我遇到了 General Access Denied 异常。通过“MyUser”和“MyPW”打开 ctx，我认为这将允许在机器上进行组操作，因为该帐户是机器本地管理员组的一部分。我不能以这种方式混合机器/域上下文，还是我只是缺少身份验证问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:42:09.227

您是否在管理员模式下运行 Visual Studio。即使您的登录名具有管理员权限，如果您没有启动它，您的程序也需要提升自己以使用这些权限。

看：

*   [http://chrisforbesblogs.net/2010/02/26/run-visual-studio-2010-as-administrator-by-default/](http://chrisforbesblogs.net/2010/02/26/run-visual-studio-2010-as-administrator-by-default/)
*   [相关谷歌搜索](http://www.google.com/#hl=en&sclient=psy-ab&q=start+visual+studio+in+admin+mode&oq=start+visual+studio+in+admin+mode&gs_l=hp.3..0i30j0i22l3.3124.9030.0.9119.39.26.3.8.8.1.185.3192.2j23.25.0.les%3B..0.0...1c.0f8YjmS7yRs&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&fp=ab1a020529bad5f7&biw=1272&bih=762)

# mysql - 在 grails 中运行石英作业？

> ID：11939454
> 
> 赞同：0
> 
> 时间：2012-08-13T17:42:21.860
> 
> 标签：mysql, grails, timestamp, quartz-scheduler

我对 Grails 很陌生。我有一张这样的桌子：

```
+----+---------+----------------+----------------+-------------+--------------------+--------------+--------+---------------------+
| id | version | card_exp_month | card_exp_year  | card_number | card_security_code | name_on_card | txn_id | date_created        |
+----+---------+----------------+----------------+-------------+--------------------+--------------+--------+---------------------+
|  9 |       0 | ASdsadsd       | Asdsadsadasdas | Asdsa       |                    | batman       | asd    | 2012-08-13 19:38:22 |
+----+---------+----------------+----------------+-------------+--------------------+--------------+--------+---------------------+ 
```

在 mysql 中。我希望针对该表运行 Quartz 作业，该作业将比较`date_created`时间戳与当前时间，这样，如果有任何字段的时间戳小于 30 分钟，则应将其删除。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:28:45.813

检查此示例以获取 grails 石英：

[http://www.juancarlosfernandez.net/2012/02/como-crear-un-proceso-quartz-en-grails.html](http://www.juancarlosfernandez.net/2012/02/como-crear-un-proceso-quartz-en-grails.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T21:04:51.313

您可以定义一个实现您的逻辑的作业（在 execute() 方法中，检查 (date_created - now) < 30 分钟或删除数据库中的行），然后定期触发此作业。

您可以阅读文档[http://quartz-scheduler.org/documentation/quartz-2.1.x/cookbook](http://quartz-scheduler.org/documentation/quartz-2.1.x/cookbook)或查看示例：[http ://svn.terracotta.org/svn/quartz/branches/quartz- 2.2.x/examples/src/main/java/org/quartz/examples/example1/](http://svn.terracotta.org/svn/quartz/branches/quartz-2.2.x/examples/src/main/java/org/quartz/examples/example1/)

# ms-access - 在备注/文本字段中保存 SQL 语句

> ID：11939455
> 
> 赞同：0
> 
> 时间：2012-08-13T17:42:25.263
> 
> 标签：ms-access, vba, ms-access-2010

我正在 Access 数据库中构建一个批处理表，以保存用户单击提交按钮（在表单上）后要处理的表单中的操作。

我唯一担心的是 SQL 语句本身将包含文本限定符。当我提交要存储在数据库中的 sql 语句时，我必须将 sql 字符串包装在文本限定符中，并且我想确保在批处理表中执行插入语句时语句限定符不会被转义。

示例：SQL 语句（操作语句）

```
INSERT INTO tblGrpLoc (gid, txt) VALUES (2, 'Select * From tblInformation') 
```

SQL 语句（批量存储）

```
INSERT INTO tblBatch(act, sql) VALUES (0, 'INSERT INTO tblGrpLoc (gid, txt) VALUES (2, 'Select * From tblInformation')') 
```

最终，我将遍历 Batch 表并仅执行该字段`sql`并更新另一个字段以表示其执行，但我想确保该`sql`字段本身与要执行的 sql 语句同质，而不会丢失字符串限定符。

## **已编辑（2012-08-13 @ 13:42pm CST）**

为了让您了解如何在此处合并此嵌套，方法如下：

```
Public Sub BatchAdd(ByRef db As Database, action As BatchAction, sql As String)
    Dim bsql As String
    Dim bact As Integer: bact = CInt(action)
    bsql = SQLInsert("tblBatchTransaction", _
                    "action, txt", _
                    (CStr(bact) & ",'" & sql & "'"))
    db.Execute bsql
End Sub 
```

SLQInsert 只是构建一个 SQL 插入语句。不，您可以看到我可能会出现字符串限定符问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:26:42.043

如果我正确理解您的问题，您希望以可以按原样运行的方式存储您的 SQL 语句。但是，内部单引号正在阻碍。尝试用双引号替换外部单引号：

```
INSERT INTO tblBatch(act, sql) VALUES (0, "INSERT INTO tblGrpLoc (gid, txt) VALUES (2, 'Select * From tblInformation')") 
```

# c# - 在 DataGridView 中将静态“标签”值与数据绑定值混合是否可行？

> ID：11939460
> 
> 赞同：1
> 
> 时间：2012-08-13T17:42:34.390
> 
> 标签：c#, winforms, data-binding, datagridview

我需要显示一个由静态“标签”值及其相应的数据绑定值组成的网格。IOW，像这样：

```
Label1  <Val1>  Label13 <Val13> . . .Label85    <Val85>
Label2  <Val2>  Label14 <Val14> . . .Label86    <Val86>
. . .
Label12 <Val12> Label24 <Val24> . . .Label96    <Val96> 
```

如果可能/可行，我想使用 DataGridView，如果可以，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:10:58.093

您可以动态添加标签并在数据绑定事件中设置标签的值绑定。在数据表中设置所有有界值，它将帮助您为此事件设置正确的值。

```
 protected void gdvCustomer_DataBound(object sender, EventArgs e) 
        { 
            AddLabel(); 
        } 

        ///  
        /// Add a Label To GridView Row. 
        ///  
        private void AddLabel() 
        { 
            foreach (GridViewRow row in gdvCustomer.Rows) 
            { 
             a++;//row number
                if (row.RowType == DataControlRowType.DataRow) 
                { 
                    for (i =0;iyou can also take value from a datatable 
                    //or lb.Text = yourdatatable.Rows[a][i]; 
                    row.Cells[0].Controls.Add(lb); 
                    }
                } 
            } 
        } 
```

# python - Python：类和内存中的函数

> ID：11939462
> 
> 赞同：7
> 
> 时间：2012-08-13T17:42:41.723
> 
> 标签：python, function, memory, instances

如果我有一个具有多个功能的类：

```
class Example:

    def func1(self):
        print 'Hi1'
    def func2(self):
        print 'Hi2'
    def func3(self):
        print 'Hi3' 
```

如果我创建了多个“示例”实例，每个实例是否都在类中存储自己的函数副本？或者 Python 是否有一种聪明的方法来只存储一次定义并在每次实例使用类中的函数时查找它？

另外，静态函数呢？该类是否只保留每个静态函数的一份副本？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-13T17:46:00.657

实例化类时，不会创建新的函数对象，无论是实例方法还是静态方法。通过 访问实例方法时`obj.func1`，会创建一个称为“绑定方法”的新包装对象，该对象只会在需要时保留。包装器对象是轻量级的，基本上包含一个指向底层函数对象和实例的指针（在`self`调用函数时作为参数传递）。

请注意，`staticmethod`在 Python 中使用几乎总是一个错误。它的存在归功于一个历史错误。如果您认为需要静态方法，通常需要模块级函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:46:22.997

这些函数“存储”在类中，包括静态和非静态的。

# sql-server - 使用特定列查找程序列表

> ID：11939464
> 
> 赞同：2
> 
> 时间：2012-08-13T17:43:08.710
> 
> 标签：sql-server, sql-server-2008

如果我提供列名作为存储过程的输入，我应该从所有数据库中使用该列获取过程和表名列表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:07:31.693

对于 sql-server 2005+，您可以使用：

```
create procedure sp1
    @columnName varchar(30)
as
    select s1.name,'table' type
    from sys.objects s1 join sys.columns s2 on s1.object_id = s2.object_id
    where s2.name = @columnName  and s1.type = 'U'

    union

    select s1.name,'procedure' type
    from sys.procedures s1 join sys.sql_modules s2 on s1.object_id = s2.object_id
    and s2.definition like '%'+@columnName+'%' 
```

# ruby-on-rails - rails 使用带有序列化列的 .send() 将元素添加到散列

> ID：11939466
> 
> 赞同：1
> 
> 时间：2012-08-13T17:43:21.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, serialization, metaprogramming

我将模型 Page 上的许多属性序列化为哈希。

由于属性数量众多，我采用了元编程方法，并希望使用 .send() 来遍历属性集合（这样我就不必为每个属性输入更新操作。

我做了这样的事情：

```
insights.each do |ins|
  self.send("#{ins.name}=",  {(Time.now) => ins.values[1]['value'].to_f})
  self.save
end 
```

问题是这显然会覆盖整个序列化列，而我希望将其作为元素添加到序列化哈希中。

尝试过这样的事情：

```
insights.each do |ins|
  self.send("#{ins.name}[#{Time.now}]=", ins.values[1]['value'].to_f)
  self.save
end 
```

但是得到一个`NoMethodError: undefined method page_fan_adds_unique[Mon Aug 13 13:31:58 -0400 2012]=`

在控制台中，我可以执行 Page.find(5).page_fan_adds_unique[Time.now]= 12345 并按预期将其作为附加元素保存到哈希中。

那么如何使用 .send() 将附加元素保存到序列化哈希中？还是有其他方法？比如使用 update_attribute 还是其他方法？自己写？任何帮助表示赞赏，即使建议是我不应该为此使用序列化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:15:06.327

我会做 ：

```
self.ins.name.send(:[]=, key, value) 
```

# javascript - Wordpress 幻灯片插件错误

> ID：11939467
> 
> 赞同：0
> 
> 时间：2012-08-13T17:43:27.650
> 
> 标签：javascript, jquery, wordpress

我有一个名为 Skitter fo WP 的插件。它是一个幻灯片 jQuery 插件。

出于某种原因，我得到

> 加载图像时出错。未找到一张或多张图片。

我最近将我的网站从一台主机转移到另一台主机。复制所有文件。现在它不工作了，不用说它在传输之前工作了..没有文件以任何方式改变过什么..只有 db 的 wp-config 文件等'..

我尝试了这里提供的解决方案 -

> [https://github.com/thiagosf/SkitterSlideshow/issues/7](https://github.com/thiagosf/SkitterSlideshow/issues/7)

但它没有工作..

插件的 wp 设置与附加到插件的图像相同。

该网站是

> www.tranceil.fm

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:27:35.177

我的脑海里闪过一个快速的想法：错误只是在您转移网站时发生。让我解释。

我相信您使用 WordPress Image Uploader 上传了滑块图像。所以你的图片地址是这样的：`www.youroldsite.com/wp-content/wp-uploads/2012/08/slider1.jpg`

当您将网站转移到另一个域时，WordPress 不会更新这些位置。因此，当插件检查上述地址时，它是不可用的。

**解决方案：**

*   您需要手动更改滑块图像的 URL 或
*   删除所有幻灯片并在新主机上重新上传图像。

# java - 如何让 JNI 在调用本机函数时重新加载共享库？

> ID：11939468
> 
> 赞同：4
> 
> 时间：2012-08-13T17:43:27.343
> 
> 标签：java, c, java-native-interface

## 背景

我在 JAVA 中有一个本机函数

```
package mypackage;

public class MyWrapper {

    private native int
    wrapFilterRawRequest(String config, String rawRequest);

    public void 
    processRequest( String configPath,String rawRequest){
        int status = 0; 
        status = new MyWrapper().wrapFilterRawRequest(configPath, rawRequest);
        status2 = new MyWrapper().wrapFilterRawRequest(configPath, rawRequest);
    }

    static{
        System.loadLibrary("mylibrary");
    }

} 
```

和 C 中的 JNI Wrapper

```
int processRequest(char *conf, char *req)
{
    int status = 0;   
    // Do something here
    return status;
}

JNIEXPORT jint JNICALL Java_mypackage_MyWrapper_wrapFilterRawRequest
(JNIEnv *env, jobject obj, jstring config, jstring rawRequest)
{
    jint status = 0;

    const char *conf, *req;
    char *conf_copy, *req_copy;

    conf = (env)->GetStringUTFChars(config, NULL);
    req  = (env)->GetStringUTFChars(rawRequest, NULL);

    copy_str(&conf_copy, conf);
    copy_str(&req_copy, req);

    (env)->ReleaseStringUTFChars(config, conf);
    (env)->ReleaseStringUTFChars(rawRequest, req);

    status = processRequest(conf_copy , req_copy );   
    return status;
} 
```

## 问题

当我在 JAVA 中调用本机函数两次时，它会给我一个错误，因为它相当于连续两次调用 C 函数 processRequest(char*, char*)，我的应用程序不支持。我希望每次都能独立调用它，类似于两次运行可执行文件时的情况。（程序在被调用两次时有效，但在同一个应用程序中同一个函数被调用两次时无效）。我希望 JNI 在进行本机调用时重新初始化所有内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:24:10.920

嗯，您可以尝试从 JVM 中卸载 dll，方法是使用您自己`ClassLoader`的加载必要的类来执行您需要的操作，将值设置为`null`然后调用`System.gc()`以消除实例及其 dll 的旧痕迹，然后将 dll 重新加载到 JVM通过重新初始化实例：

```
package test;

import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

/**
 *
 * @author David
 */
public class Test {

    static {
         System.loadLibrary("mydll.dll");
    }

    @Override
    public void finalize() {
        System.out.println("A garbage collected");
    }

    public void print(String str, int value) {
        System.out.println(str);
        System.out.println(value);
    }

    public static int getNumber() {
        return 42;
    }

    public static void main(String[] args) throws Exception {
        Class<?> clazz = Test.class;//class name goes here
        // static call
        Method getNumber = clazz.getMethod("getNumber");
        int i = (Integer) getNumber.invoke(null /*
                 * static
                 */);
        // instance call
        Constructor<?> ctor = clazz.getConstructor();
        Object instance = ctor.newInstance();
        Method print = clazz.getMethod("print", String.class, Integer.TYPE);
        print.invoke(instance, "Hello, World!", i);
        print = null;
        instance = null;
        ctor = null;
        getNumber = null;
        clazz = null;
        i = 0;
        System.gc();  //reload by empting garbage   Class<?> clazz = Test.class;//class name goes here

        clazz = Test.class;//class name goes here
        // static call
        getNumber = clazz.getMethod("getNumber");
        i = (Integer) getNumber.invoke(null /*
                 * static
                 */);
        // instance call
        ctor = clazz.getConstructor();
        instance = ctor.newInstance();
        print = clazz.getMethod("print", String.class, Integer.TYPE);
        print.invoke(instance, "Hello, World!", i);
        print = null;
        instance = null;
        ctor = null;
        getNumber = null;
        clazz = null;
        i = 0;
        System.gc();  //reload by empting garbage
    }
} 
```

**参考：**

*   [Codethesis - 卸载 JNI](https://web.archive.org/web/20140704120535/http://www.codethesis.com/blog/unload-java-jni-dll)
*   [如何从 java JVM 中卸载库 (DLL)](https://stackoverflow.com/questions/453359/how-to-unload-dll-from-java-jvm)
*   [是否可以从不同的 JVM 调用 Java 应用程序中的方法？](https://stackoverflow.com/questions/11810627/is-it-possible-to-call-method-withing-a-java-application-from-a-different-jvm/11810813#11810813)

# linux - 追加在同一行 bash

> ID：11939474
> 
> 赞同：3
> 
> 时间：2012-08-13T17:44:00.847
> 
> 标签：linux, bash, append

使用 bash，我需要在文件末尾添加一个字符串，后跟日期。示例“在 2012 年 8 月 13 日星期一 10:38:56 PDT 重新启动”

```
echo -n "Reboot done on " ; date 
```

这给了我我想要的一行，但我不能附加到文本文件中。

```
echo -n "Reboot done on " ; date > test.txt 
```

这似乎对我不起作用。它只给我日期。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T17:46:52.357

这是因为您的输出**Reboot**使用 echo 完成，然后您执行`date`并将其输出放入文件中。试试这个：

```
echo "Reboot done on $(date)" > test.txt 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T17:48:58.743

**尝试这个**

```
echo -n "Reboot done on `date`" > test.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:52:11.320

这是另一种方式：

```
(echo -n "Reboot done on "; date) > test.txt 
```

# php - SQL WHERE ID 结转

> ID：11939476
> 
> 赞同：0
> 
> 时间：2012-08-13T17:44:13.467
> 
> 标签：php, sql

基本上我已经创建了两个 php 文件。一个人选择了我的整个表格，并从中只显示日期和 ID 号。每个日期都有一个指向 display.php 文件的链接。它将 ID 号连同它一起拉到下一个 display.php 页面。我想在 display.php 文件上做的是使用该 PHP 显示整行。

所以我知道这`Select * from tablename WHERE id=1`会提取这些数据，但是如何将 ID 号放入那里的`WHERE`语句中？

这是主页代码：

// SQL 查询 $strSQL = "SELECT * FROM table1";

```
// Execute the query (the recordset $rs contains the result)
$rs = mysql_query($strSQL);

// Loop the recordset $rs
            while($row = mysql_fetch_array($rs)) {

               // DATE
              $strName = $row['date'];

               // Create a link to display.php with the id-value in the URL
               $strLink = "<a href = 'display.php?ID = " . $row['ID'] . "'>" . $strName . "</a>";

                // List link
               echo "<li>" . $strLink . "</li>";

  } 
```

该代码链接有效并转到 display.php。我将如何使用 ID 号与它一起创建链接。我会使用 post 命令吗？

```
$id= Post['id'] 
then WHERE id = '$id' 
```

?

TBH 我确实尝试过，但一无所获。有什么建议么？

现在使用 GET ......仍然不走运我已经尝试了 GET 语句。在我的地址栏中，它显示了 ID 号。所以我看到身份证号码随之而来。我什至尝试只是回显 ID，看看是否只是我的代码搞砸了。

```
<?php 
    $dbhost = 'localhost';
    $dbuser = 'myusername';
    $dbpass = 'mypw';
    $dbname = 'mydbname';
    $id = $_GET['id'];
    mysql_connect($dbhost, $dbuser, $dbpass) or die('MySQL connect failed. ' . mysql_error());
    mysql_select_db($dbname) or die('Cannot select database. ' . mysql_error());
?>

<body>
ID #<?php  echo $id ?>
</body>
</html>

<body>
ID #<?php  echo $id ?>
</body>
</html> 
```

仍然没有运气

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:47:56.200

在查询字符串中传递的值使用 GET 而不是 POST。

Post 用于表单变量。

从查询字符串中获取值时，您还应该注意 SQL 注入攻击的危险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:53:24.253

所以在你的显示文件中你会做这样的事情

```
$id = $_GET['ID'];

//DO SANITIZATION ETC ON THE ID HERE TO MAKE SURE ITS SOMETHING WE EXPECTED (AN INT)

$sql = "SELECT STUFF WHERE ID = {$id}"; //FOR BREVITY SAKE DOING AWAY WITH SECURITY 
```

所以基本上你的第一个脚本正在做的是在 url 查询字符串中传递 id，这里传递的值可以在`$_GET`超级全局数组中访问。

您在此处访问的任何内容和其他超级全局变量都应该被视为对您的应用程序完全危险。您应该过滤并从中逃脱，然后在将其插入数据库之前，您必须使用正确的数据库机制对其进行转义。否则，您将面临 SQL 注入攻击。

# oracle - 将表格导出到多个 csv 文件的过程

> ID：11939477
> 
> 赞同：0
> 
> 时间：2012-08-13T17:44:18.257
> 
> 标签：oracle, oracle-sqldeveloper

我正在使用 Oracle 数据库 - 我必须访问它的唯一方法是通过 SQL Developer。我的部分工作涉及将大表导出到 csv 文件以传递给另一个组。由于这主要是维护系统，我一直在寻找一种方法来自动化导出过程。

我想要的是有这样的程序：

```
PROCEDURE_EXAMPLE(table_in in VARCHAR2, file_out in VARCHAR2) 
```

其中 table_in 是我需要导出的表，它将表导出到一系列标题为“file_out_1.csv”“file_out_2.csv”等的 csv 文件，每个文件的行数不超过 500 万行。

是否可以创建这样的程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:04:33.643

您可以使用 UTL_FILE 包。您只能读取可从运行数据库实例的服务器访问的文件。

请参阅[http://www.devshed.com/c/a/Oracle/Reading-Text-Files-using-Oracle-PLSQL-and-UTLFILE/](http://www.devshed.com/c/a/Oracle/Reading-Text-Files-using-Oracle-PLSQL-and-UTLFILE/) 和[Oracle 写入文件](https://stackoverflow.com/questions/27562/oracle-write-to-file)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T10:52:26.497

我只是在这里发布一个答案：[创建 .csv 输出的过程](https://stackoverflow.com/questions/16144380/procedure-to-create-csv-ouput/16145202#16145202)

使用 UTL_FILE 包通常不是一种选择，因为它只能在服务器上创建文件并且相当有限。

如果您只能使用 SQL Developer，您可以将窗口更改为命令窗口，然后您可以像我在另一个线程中描述的那样运行命令。

在 SQL Window 中右键单击 -> Change Window to -> Command Window

```
set term off ...
spool c:\tmp\t\txt
select ...
spool off 
```

# java - 非法密钥大小

> ID：11939478
> 
> 赞同：1
> 
> 时间：2012-08-13T17:44:21.167
> 
> 标签：java, android, ssl-certificate, bouncycastle, keystore

我已经安装了 jce 以允许更大的密钥，但是 KeytoolUIU 和 Portecle 都给出了类似**java.IO.Exception: Error initialising store of key store: java.security.InvalidKeyException: Illegal Key Size 的错误**。密钥只有 1024 所以我不知道它为什么抱怨。

这是我当前用于加载密钥文件和访问安全网站的代码。

```
package com.g4apps.secure.android.sslclient;

import java.io.InputStream;
import java.security.KeyStore;
import java.security.Security;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.conn.scheme.Scheme;
import org.apache.http.conn.ssl.AllowAllHostnameVerifier;
import org.apache.http.conn.ssl.SSLSocketFactory;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;
import org.bouncycastle.jce.provider.BouncyCastleProvider;

import android.content.Context;

/**
 * This example demonstrates how to create secure connections with a custom SSL
 * context.
 */
public class SSLclient {

    public final static String authenticate(Context context) throws Exception {
        DefaultHttpClient httpclient = new DefaultHttpClient();
        String output=null;

        Security.addProvider(new BouncyCastleProvider());
        try {
            KeyStore trustStore  = KeyStore.getInstance("BKS");
            InputStream instream = context.getResources().getAssets().open("my.truststore");
            try {
                trustStore.load(instream, "dysan100".toCharArray());
            } finally {
                try { instream.close(); } catch (Exception ignore) {}
            }
            KeyStore keystore = KeyStore.getInstance("BKS");
            InputStream keystream = context.getResources().getAssets().open("my.keystore.bks");
            try {
                keystore.load(keystream, "dysan100".toCharArray());
            } finally {
                try { keystream.close(); } catch (Exception ignore) {}
            }

            SSLSocketFactory socketFactory = new SSLSocketFactory(keystore,"dysan100",trustStore);
            socketFactory.setHostnameVerifier(new AllowAllHostnameVerifier());
            Scheme sch = new Scheme("https", socketFactory, 443);
            httpclient.getConnectionManager().getSchemeRegistry().register(sch);

            HttpGet httpget = new HttpGet("https://192.168.1.123/test.php");

            System.out.println("executing request" + httpget.getRequestLine());

            HttpResponse response = httpclient.execute(httpget);
            HttpEntity entity = response.getEntity();

            System.out.println("----------------------------------------");
            System.out.println(response.getStatusLine());
            if (entity != null) {
                System.out.println("Response content length: " + entity.getContentLength());
                output=EntityUtils.toString(entity);
                System.out.println(output);
                return output;

            }

        } finally {
            // When HttpClient instance is no longer needed,
            // shut down the connection manager to ensure
            // immediate deallocation of all system resources
            httpclient.getConnectionManager().shutdown();
        }

        return null;
    }

} 
```

目前，密钥库是这样组成的

my.truststore.bks 有我的 CA 证书
my.keystore.bks 应该有我的服务器证书、客户端证书和客户端的私钥。

这与我在我的程序的 pc 版本中设置它的方式相同（尽管使用 JKS 商店）。

由于它不允许我像这样设置我的商店，还有另一种可能对我有用的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T00:06:15.820

我不确定为什么我无法创建 bks 密钥库，但我能够让它与 PKCS12 密钥库一起工作。所以我有一个替代方案。

```
 KeyStore keystore = KeyStore.getInstance("PKCS12");
        InputStream keystream = context.getResources().getAssets().open("client.p12");
        try {
            keystore.load(keystream, "dysan100".toCharArray());
        } finally {
            try { keystream.close(); } catch (Exception ignore) {}
        } 
```

# ruby - Ruby openuri 测试 uri 是否有效

> ID：11939481
> 
> 赞同：0
> 
> 时间：2012-08-13T17:44:29.677
> 
> 标签：ruby, open-uri

我正在尝试使用 ruby​​ 代码测试 uri 是否有效（例如实际上有内容，而不是测试它是否在此处格式正确），我可以使用`open(uri)`. 但就我而言，uri 是要下载的文件的链接，我不想下载整个文件只是为了验证那里有内容。

有没有另一种解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:20:12.550

尝试这个

```
require 'net/http'
u = URI.parse('http://www.example.com/')
status = Net::HTTP.start(u.host, u.port).head(u.request_uri).code
# status is HTTP status code 
```

如果域解析失败，您需要使用救援来捕获异常。

# php - JSON 和 XML 的 YQL 解析问题

> ID：11939483
> 
> 赞同：0
> 
> 时间：2012-08-13T17:44:41.877
> 
> 标签：php, xml, json, yql

我正在尝试使用 YQL 解析页面。正在解析 HTML 表。问题是 YQL 自己添加了 HTML“p”标签，而它不包含在原始 HTML 中。应该怎么做才能使 YQL 不返回 HTML。

[YQL 查询可以在这里](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20html%20where%20url=%22http://www.gsmarena.com/nokia_808_pureview-4577.php%22%20and%20xpath=%27//div%5B@id=%22specs-list%22%5D/table%27&env=store://datatables.org/alltableswithkeys)看到。

如果在下面的 td 标签中查看，则包含 ap 标签，在原始 html 中可以看到[这里](http://www.gsmarena.com/nokia_808_pureview-4577.php)在 table html 中没有 ap 标签。

```
<tr>
    <td class="ttl">
        <a href="#" onclick="helpW('h_weight.htm');">Weight</a>
    </td>
    <td class="nfo">
        <p>169 g</p>
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:59:57.807

这样做的不是 YQL，而是 HTML5 引擎本身。HTML5 的部分理念是，如果您给它提供无效的 HTML，它会通过添加您错过的任何元素来为您修复它，并且您在查询中看到的是代表修复内容的树。（是的，这使得编写查询变得困难。但这不是一个分摊责任的地方......）

# c++ - 本地静态函数对象的初始化是线程安全的吗？

> ID：11939484
> 
> 赞同：7
> 
> 时间：2012-08-13T17:44:41.853
> 
> 标签：c++, thread-safety, lambda, static-initialization

以下两个函数产生不同的程序集，这告诉我它们是不同的。有人能告诉我他们有什么不同吗？func2中的函数局部静态变量初始化是否线程安全？如果答案取决于编译器，我想知道最常见的编译器如何处理 func2。

```
int func1(int val)
{
    const auto impl = [](int v)
    {
        return v * 10;
    };

    return impl(val);
}

int func2(int val)
{
    static const auto impl = [](int v)
    {
        return v * 10;
    };

    return impl(val);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T17:48:54.930

“最常见的编译器”可能对此有所不同，因为它们对 C++11 的支持并不完全相同。

在 C++11 中，静态变量的初始化是线程安全的。在 C++03 中它不是（因为根据标准没有任何线程）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T17:59:46.480

As Bo says, the current C++ standard demands that static variable initialization not introduce a data race. (This is of course only relevant to the dynamic initialization phase.) For example, if you look at the output of GCC when initializing a static variable, you'll indeed find calls to `__cxa_guard_acquire`, `__cxa_guard_release` and `__cxa_guard_abort` surrounding the initialization.

The [Itanium C++ ABI](http://refspecs.linuxbase.org/cxxabi-1.83.html#once-ctor) actually formalizes the mechanism.

# asp.net - 无法从服务器端代码按顺序执行关闭/打开 ASP.Net Ajax ModalPopupExtenders

> ID：11939493
> 
> 赞同：1
> 
> 时间：2012-08-13T17:45:09.087
> 
> 标签：asp.net, ajaxcontroltoolkit, modalpopupextender

我在同一服务器端调用中隐藏一个 ModalPopupExtender 并显示另一个时遇到问题。

我的应用程序需要用户输入某些验证条件。这些条件按顺序进行评估，当某些条件为真时，需要用户通过 ModalPopupExtender 窗口进行验证（单击是或否）。如果用户单击是，评估应该继续，如果另一个条件需要用户输入，它也应该打开一个模式对话框 - 直到所有条件都通过。

如果只有一个条件需要输入，我没有问题，但如果多个条件需要输入，则只显示第一个模式，我不知道为什么。跟踪代码时，很明显第一个弹出窗口上的 Hide() 被命中，第二个弹出窗口上的 Show() 被命中，但第二个弹出窗口永远不会出现。

我试图以极其简化的方式在这里提取相关的代码块。这是一个非常复杂的项目，我可能遗漏了一些东西，但我希望它足以描述我的问题。

有问题的工艺流程：

1.  用户单击“继续” -> 调用 DoContinue -> 设置条件标志 -> 显示第一个模式弹出窗口 -> 返回给用户

2.  用户单击“是”-> 调用条件 1 是单击处理程序（设置已处理标志，隐藏模式弹出窗口）-> 调用 DoContinue-> 重新评估条件标志-> 尝试显示第二个模式弹出窗口-> 返回给用户。

第一个弹出窗口消失，但第二个从未显示。

只有在第二个调用 Show() 的同一请求中的第一个模式上调用 Hide() 时才会出现问题。

MyContainerControl.ascx：

```
<%@ Control Language="C#" AutoEventWireup="true" Inherits="MyContainerControl" %>
 <input Type="Submit"
          id="btnContinue"
          Name="btnContinue"
          Value="Continue"
          OnServerClick="Continue_Click"
          runat="server"/>

<asp:UpdatePanel 
        ID="updateCondition1" 
        runat="server" 
        ChildrenAsTriggers="false" UpdateMode="Conditional">
    <ContentTemplate>
        <ajaxToolkit:ModalPopupExtender 
                    ID="modalCondition1" 
                    runat="server" 
                    BehaviorID="dlgCondition1"
                    TargetControlID="btnFakeInvokeModalCondition1" 
                    PopupControlID="divCondition1" 
                    BackgroundCssClass="modalBackground"
                    DropShadow="true" 
                    PopupDragHandleControlID="divDragCondition1"
                    RepositionMode="RepositionOnWindowResize" 
                    CancelControlID="btnCondition1No" />
        <input type="button" 
                        id="btnFakeInvokeModalCondition1" 
                        runat="server" 
                        style="display: none" />
        <div id="divCondition1" 
                runat="server" 
                class="modalPopup">
            <custom:Condition1Control id="condition1" runat="server" visible="false" />
            <div id="divDragCondition1"></div>
        </div>
    </ContentTemplate>
</asp:UpdatePanel>
<asp:UpdatePanel 
        ID="updateCondition2" 
        runat="server" 
        ChildrenAsTriggers="false" UpdateMode="Conditional">
    <ContentTemplate>
        <ajaxToolkit:ModalPopupExtender 
                    ID="modalCondition2" 
                    runat="server" 
                    BehaviorID="dlgCondition2"
                    TargetControlID="btnFakeInvokeModalCondition2" 
                    PopupControlID="divCondition2" 
                    BackgroundCssClass="modalBackground"
                    DropShadow="true" 
                    PopupDragHandleControlID="divDragCondition2"
                    RepositionMode="RepositionOnWindowResize" 
                    CancelControlID="btnCondition2No" />
        <input type="button" 
                        id="btnFakeInvokeModalCondition2" 
                        runat="server" 
                        style="display: none" />
        <div id="divCondition2" 
                runat="server" 
                class="modalPopup">
            <custom:Condition2Control id="condition2" runat="server" visible="false" />
            <div id="divDragCondition2"></div>
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

MyContainerControl.cs：

```
public class MyContainerControl : System.Web.UI.UserControl
{
    protected HtmlInputImage btnContinue;

    //Condition1
    protected AjaxControlToolkit.ModalPopupExtender modalCondition1;
    protected UpdatePanel updateCondition1;
    protected HtmlGenericControl divCondition1;
    protected Condition1Control condition1;

    //Condition2
    protected AjaxControlToolkit.ModalPopupExtender modalCondition2;
    protected UpdatePanel updateCondition2;
    protected HtmlGenericControl divCondition2;
    protected Condition2Control condition2;        

    protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);
        condition1.Condition1RaisedEvent += HandleCondition1Event;
        condition2.Condition2RaisedEvent += HandleCondition2Event;
        btnContinue.ServerClick += btnContinue_ServerClick;
    }

    protected void HandleCondition1Event(object sender, Condition1EventArgs e)
    {
        // use ship to store
        ViewState["Condition1Yes"] = true;
        ViewState["Condition1Value"] = e.Condition1Value;
        modalCondition1.Hide();
        DoContinue(sender);
    }

    protected void HandleCondition2Event(object sender, Condition2EventArgs e)
    {
        // use ship to store
        ViewState["Condition2Yes"] = true;
        ViewState["Condition2Value"] = e.Condition2Value;
        modalCondition2.Hide();
        DoContinue(sender);
    }

    protected void btnContinue_ServerClick(object sender, EventArgs e)
    {
        DoContinue(sender);
    }

    protected void DoContinue(object sender)
    {
        // test for conditions - just plug to true for demonstration

        bool throwCondition1 !(ViewState["Condition1Yes"] == null ? false : (bool)ViewState["Condition1Yes"])
        bool throwCondition2 = !(ViewState["Condition2Yes"] == null ? false : (bool)ViewState["Condition2Yes"])

        // analyze conditions

        if (throwCondition1)
        {
            var condition1Yes = ViewState["Condition1Yes"] == null ? false : (bool)ViewState["Condition1Yes"];
            if (!condition1Yes)
            {
                divCondition1.Visible = true;
                modalCondition1.Show();
                return;
            }
        }

        if (throwCondition2)
        {
            var condition2Yes = ViewState["Condition2Yes"] == null ? false : (bool)ViewState["Condition2Yes"];
            if (!condition2Yes)
            {
                divCondition2.Visible = true;
                modalCondition1.Show();
                return;
            }
        }

        // do other work
    }
} 
```

Condition1UI.ascx - Condition2UI.ascx 非常相似：

```
<%@ Control Language="C#" AutoEventWireup="true" Inherits="Condition1Control" %>
<div id="divCondition1Container" runat="server">        
    <input id="hdnCondition1Value" type="hidden" runat="server" value="<%# this.Condition1Value %>" />
    <asp:Panel ID="pnlCondition1UI" runat="server">
        <br />
        <h2>
            Warning!</h2>
        <hr />
        <br />
        <div>
            <p>Condition1 has been met.</p>
            <br />
            <br />
            <p>Would you like to continue?</p>
        </div>
        <br />
        <br />
    </asp:Panel>
    <div>
    <table>
        <tr>
            <td align="center">
                <asp:Button ID="btnCondition1Yes" runat="server" class="green" Text="Yes" style="padding: 3px 7px;" OnClick="DoCondition1YesClick" OnClientClick="$find('dlgCondition1').hide();" />
            </td>
            <td align="center">
                <button id="btnCondition1No" class="red">No</button>
            </td>
        </tr>
    </table>
      <br />
    </div>
    <br />
</div> 
```

Condition1Control.cs - Condition2Control.cs 几乎相同：

```
public class Condition1EventArgs : EventArgs
{
    public string Condition1Value { get; set; }
}

public class Condition1Control : System.Web.UI.UserControl
{
    public HtmlInputHidden Condition1Value;

    public event EventHandler<Condition1EventArgs> Condition1RaisedEvent;

    protected virtual void RaiseCondition1Event(Condition1EventArgs e)
    {
        EventHandler<Condition1EventArgs> handler = Condition1RaisedEvent;

        if (handler == null)
        {
            return;
        }

        handler(this, e);
    }

    public void DoCondition1ButtonYesClick(object sender, EventArgs e)
    {
        RaiseCondition1Event(new Condition1EventArgs{
            Condition1Value = Condition1Value.Value
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:08:51.140

将 UpdatePanel 的 UpdateMode 属性更改为“Always”，或者不要忘记调用 UpdatePanel 的“Update”方法，因为从另一个 UpdatePanel 触发回发，您要更新哪个 UI。因此，请尝试在代码中的 modalCondition2.Show 方法之后添加 updateCondition2.Update 方法调用。

# salesforce - apex:actionFunction 在非 visualforce 组件上重新渲染

> ID：11939495
> 
> 赞同：0
> 
> 时间：2012-08-13T17:45:16.213
> 
> 标签：salesforce, apex-code, visualforce

我在visualforce页面中有一个HTML表格设置，其中一些功能似乎超出了标准apex：datatable的掌握范围。当用户更新其中一行的信息时，我正在尝试重新呈现表，以便反映更新的值。如果我使用 apex:datatable 这工作正常，但是我失去了很多我必须在我的表中添加的功能。

结构相当简单，但它是这样的：

```
 <table>
        <thead>
            <tr>
                <th>Col 1</th>
            </tr>
        </thead>

        <tbody>
        <apex:outputPanel id="table-panel">

            <apex:repeat value="{!Parent}" var="row">
                <tr name="{!row.Id}">
                    <td>Cell 1</td>
                </tr>
                <apex:repeat value="Child__r" var="child">
                    <tr name="child-{!row.Id}">
                        <td>Child Cell 1</td>
                    </tr>
                </apex:repeat>      
            </apex:repeat>
        </apex:outputPanel>
        </tbody>

    </table> 
```

这本质上是我想要完成的功能，下面列出了父对象的子对象。截至目前，重新渲染将我所有的表格元素转换为跨度并完全乱码。是否可以重新渲染非视觉力组件，或者，有没有办法可以在 apex:datatable 中重现此功能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T12:02:16.587

这简单。试试这个，即使在重新渲染后对我也很好：

```
<apex:panelGrid columns="1" width="400" id="myTable">

    <apex:facet name="header">
        <apex:outputText value="My table header"/>
    </apex:facet>

    <apex:repeat value="{!Object}" var="row">

        <apex:outputText value="{!row.name}" style="display:block;font-weight:bold;"/>

        <apex:repeat value="{!row.ObjectChild__r}" var="child">

            <apex:outputText value="{!child.name}"/> <br/>

        </apex:repeat> 

    </apex:repeat>         

</apex:panelGrid> 
```

不，您可以重新渲染您的“myTable”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T18:44:11.043

实际上，我最终发现了 apex:outputPanel 元素的漂亮的小“布局”属性。将此设置为“阻止”完全解决了与此相关的所有问题。

# mysql - 社交网站的好友表

> ID：11939504
> 
> 赞同：1
> 
> 时间：2012-08-13T17:46:25.140
> 
> 标签：mysql, social-networking

我一直在一个社交网站上工作。这里一个用户请求另一个用户成为他的朋友（朋友请求）。我想到了一个看起来像的“朋友”表

```
Table Name: Friends
Coloumns :
    User1   - Int - FK
    User2   - Int - FK
    Request - Enum('0','1')
    Time    - DateTime

PK - (User1, User2) 
```

在请求字段中，当用户 1 向用户 2 提出请求时存储“0”，当用户 2 批准请求时存储“1”。

当我想检索用户的所有朋友时，就会出现问题。我每次都必须检查请求字段是“0”还是“1”。还有其他方法吗？如果我有另一个存储 Friend 请求的所有详细信息的表会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:28:02.717

在评论中，您基本上声明已建立的友谊（而不是请求）在您的设置中始终是对称的。在这种情况下，您基本上有两个选择：您可以将其存储在两行中，或者通过匹配任一列来选择它。前者将产生更简单的查询，但后者将确保对称性是数据库结构中固有的，并且还将避免存储重复数据。所以我会选择后者，即某种形式的`WHERE (User1 = XX or User2 = XX )`. *查询所花费的时间可能是仅查询一列所占用的相同行数的*两倍，但由于行数仅为其他存储方案的一半，因此在性能方面的净影响应该可以忽略不计.

您是否需要单独的请求表或已建立的友谊取决于这两者的相似程度，无论是在关联数据方面还是在应用程序中的控制流方面。因此，例如，如果您想向用户显示一个列表，该列表同时显示他已建立的友谊和他的未决请求，可能有不同的颜色或其他，但在同一个列表中，那么在数据库中拥有一个表会更多适当。另一方面，如果您主要将请求和友谊分开处理，那么拥有两张桌子会更自然。而且，如果在某个时候，您决定友谊需要类似的属性，`share_calendar`而请求需要类似`confirmation_key`或其他的属性，那么使用不同的表会更好。

如果您决定将其设为单个表，我建议为枚举提供更多描述性值，例如调用列`status`和值`requested`和`established`. 例如，我乍一看会将值解释`request = 1`为“这只是一个请求，而不是既定的友谊”，这与您所联想的含义完全相反。当不同的人需要维护代码时，这种模糊性可能会导致错误。几年后，你将成为一个与现在不同的人，甚至你自己也可能会误解你的旧代码。所以要在那里描述。

还有一点需要注意：您可能总是使用视图来调整数据库在查询中的显示方式。例如，您可以创建一个视图

```
CREATE VIEW SymmetricEstablishedFriends AS
SELECT User1 AS Me, User2 AS Friend, Time
FROM Friends
WHERE Status = 'established'
UNION
SELECT User2 AS Me, User1 AS Friend, Time
FROM Friends
WHERE Status = 'established' 
```

This will restrict the data to established friendships only, and will take care of symmetrizing things for you. Using such views in your queries, you can avoid having to deal with all the details of the table structure in every query. And if you ever change those details, there will be less places to change.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:50:04.273

我会将您的数据分解为`requests`and `friendships`。当 a`request`被批准后，将其转换为`friendship`. 它们确实是两个不同的对象，应该这样对待。

```
Requests ::
  requesting_user_id : int()
  requested_user_id  : int()
  date_requested     : datetime()
  status_id          : int()

Statuses ::
  (Active, Declined, Accepted, Ignored)

Friendships ::
  friendship_id      : int()
  user_id            : int()
  friend_id          : int() 
```

如果请求被拒绝，可能会删除该请求，或者为其设置一列（以防止人们重复请求同一用户的友谊）。您必须将请求转换为两个友谊（每个方向一个）以便于索引

```
SELECT friend_id FROM friendships WHERE user_id = ? 
```

# javascript - 停止函数时的javascript返回

> ID：11939506
> 
> 赞同：-2
> 
> 时间：2012-08-13T17:46:35.483
> 
> 标签：javascript

如果我写这个：

```
$('#SomeDiv').click(DoSomething);

function DoSomething() {

  if (SomeCondition === true) {
     return false;
  }

  // more code here
} 
```

不管我是否放`return`；或`return false;`或`return true;`代码不抛出异常并且函数执行停止。

哪个是最好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:49:10.120

如果您只是想在某些条件下停止该函数并且不在乎它返回什么，那么您选择三个中的哪一个都没有关系。如果您不使用函数的输出，我只需使用一个简单的`return;`语句来阻止它进一步执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:52:35.130

如果这些是唯一的选项，请`return;`在这种情况下使用。（参见下文）

如果函数通常返回一些东西（计算一些东西，获取一些值等），那么你肯定不想返回任何东西，因为你可能会混淆调用者。

如果您的函数通常不返回任何内容，那么返回您喜欢的任何内容可能不会有什么坏处，但它仍然可能会使调用者感到困惑。

我个人宁愿在`else`之后放一个`if`，而不是使用 return;。如果函数太大，只需将其缩回一点。

# c++ - 顺序/在线kmeans聚类，它是如何工作的？现有代码？

> ID：11939508
> 
> 赞同：0
> 
> 时间：2012-08-13T17:46:45.307
> 
> 标签：c++, matlab, full-text-search, cluster-analysis, k-means

我对在线 kmeans 聚类有点困惑。我知道它允许我一次只使用一个数据进行聚类。但是，这一切都仅限于一个会话吗？假设我有一堆通过这种方法聚类的数据，我得到了聚类的数据结果，我将来可以向集群添加更多数据吗？

我也一直在寻找此代码的实现，但无济于事。有人知道吗？

更新：澄清更多。这是我的代码现在的工作方式：

> 1.  图像取自实时视频源，一旦保存了足够多的图片，就可以获取 sift 特征的 kmeans。
> 2.  重复步骤1，新一批live feed图片，再次获取kmeans。将 kmeans 向量与之前的 kmeans 相结合，例如：[AB]

你可以看到这很糟糕，因为我很快得到了太多的簇，而且每批簇肯定会与另一批重叠。

我想要的是：

> 1.  图片取自实时视频源，保存图片后，获取 kmeans
> 2.  重复第 1 步，再次获取 kmeans，它会更新并将新集群添加到前一个集群中。

除非我没有正确理解它们，否则我所看到的任何东西都无法适应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T03:50:54.007

如果您查看原始（！）出版物，MacQueen 提出的方法（k-means 名称的由来）实际上是一种在线算法。我不确定 MacQueen 是否对数据进行了多次传递以改善结果。我相信他使用了单次传递，并且对象永远不会被重新分配到不同的集群。如果是这样，那已经是在线算法了！

平均值通常计算为`sum / count`。从数字的角度来看，这不是很明智。例如，在经典的 Knuth 书中，您可以找到一种增量更新方式的方法。维基百科也有。

一旦您真正想要重新分配较早的点，事情就会变得稍微复杂一些。但通常在流式上下文中，您不*知道*前面的要点，因此无论如何您都不能这样做。

# python - 在python中将字符串转换为具有精确间距的pdf

> ID：11939509
> 
> 赞同：4
> 
> 时间：2012-08-13T17:46:47.880
> 
> 标签：python, pdf, text

我有一个字符串，其中的文本以我希望的方式显示。这是一个ascii艺术项目。我想将此文本转换为 pdf，以便我可以在当地的印刷店打印带有文本的海报。

字体需要固定宽度，并且没有标签或类似的东西。行以 '\n' 字符结尾。有几个空格字符。

图像宽数百字，高数百字。因此，它不适合典型页面的空间。

我如何在python中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:49:30.857

尝试模块[pyPdf](http://pybrary.net/pyPdf/)，可能会为您解决问题！

或[pyfPdf](http://code.google.com/p/pyfpdf/)，允许您在创建新 PDF 文件时设置字体（[setFont 示例](http://code.google.com/p/pyfpdf/wiki/SetFont)）

从[pyfPdf 教程页面](https://code.google.com/p/pyfpdf/wiki/Tutorial)：

```
from fpdf import FPDF

pdf=FPDF()
pdf.add_page()
pdf.set_font('Courier','B',16)
pdf.cell(40,10,'Hello World!')
pdf.output('tuto1.pdf','F') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T21:15:43.863

There are several more methods which could create a printable file from your ASCII art.

## First, ImageMagick:

To demonstrate the method...

*   ...first, create a text file named `my.mvg` and put the following content in:

    ```
    text 8,8 "

        _    ____   ____ ___ ___        _         _   
       / \  / ___| / ___|_ _|_ _|      / \   _ __| |_ 
      / _ \ \___ \| |    | | | |_____ / _ \ | '__| __|
     / ___ \ ___) | |___ | | | |_____/ ___ \| |  | |_ 
    /_/   \_\____/ \____|___|___|   /_/   \_\_|   \__|

    " 
    ```

*   ...next, run one of these commands:

    ```
    convert                 \
      -font "Courier"       \
      -size 800x200 xc:none \
      -box yellow           \
      -pointsize 12         \
      -gravity center       \
      -draw @my.mvg         \
       my-ascii-art.pdf 
    ```

    to get a ***PDF*** as output file, or

    ```
    convert                           \
      -font "Liberation-Mono-Regular" \
      -size 800x200 xc:none           \
      -box orange                     \
      -pointsize 14                   \
      -gravity center                 \
      -draw @my.mvg                   \
       my-ascii-art.png 
    ```

    for ***PNG*** output. Of course for each of the two commands you can play with `-size` and `-box` and `-pointsize` to your heart's contents...

*   You may need to remove the `\n` character from your line ends, though...

*   **Note** the ImageMagick method will create raster graphics, even if the output is PDF (and probably rather large files).**

## Second, `a2ps` + Ghostscript:

To demonstrate this method...

*   ...first, create a text file named `henryb.txt` with this content:

    ```
     _   
      |_| _ ._ ._   |_)  
      | |(/_| || \/ |_)o 
                 / 
    ```

*   ...next, run this command to let `a2ps` and Ghostscript cooperate to create a PDF file:

    ```
    a2ps                      \
      --output=-              \
      --columns=1             \
      --borders=0             \
      --no-header             \
      --landscape             \
      --medium=a5             \
        henryb.txt            \
    |                         \
    gs                        \
      -o henryb.pdf           \
      -sDEVICE=pdfwrite       \
      -g1000x2500             \
      -dAutoRotatePages=/None \
      - 
    ```

    or, for PNG output:

    ```
    a2ps                      \
      --output=-              \
      --columns=1             \
      --borders=0             \
      --no-header             \
      --landscape             \
      --medium=a5             \
        henryb.txt            \
    |                         \
    gs                        \
      -o henryb.png           \
      -sDEVICE=pngalpha       \
      -g100x250               \
      - 
    ```

    (`-gNNNxMMM` gives the output dimensions in pixels. Ghostscript by default uses 720 pixels per inch for PDF distance calculations, but 72 ppi for raster image calculations, unless overridden with the `-rNNN` resolution setting...)

## Third, `enscript` + Ghostscript:

To demonstrate this method...

*   ...first, create a text file named `henryb-2.txt` with this content:

    ```
    m    m                                    mmmmm        
    #    #  mmm   m mm    m mm  m   m         #    #       
    #mmmm# #"  #  #"  #   #"  " "m m"         #mmmm"       
    #    # #""""  #   #   #      #m#          #    #       
    #    # "#mm"  #   #   #      "#           #mmmm"   #   
                                 m"                        
                                "" 
    ```

*   ...next, run this command to let `enscript` and Ghostscript cooperate to create a PDF file:

    ```
    enscript                  \
      --output=-              \
      --columns=1             \
      --no-header             \
      --landscape             \
      --media=A5              \
        henryb-2.txt          \
    |                         \
    gs                        \
      -o henryb-2.pdf         \
      -sDEVICE=pdfwrite       \
      -g1500x4000             \
      - 
    ```

    or, for PNG output:

    ```
    enscript                  \
      --output=-              \
      --columns=1             \
      --no-header             \
      --landscape             \
      --media=A5              \
        henryb-2.txt          \
    |                         \
    gs                        \
      -o henryb-2.png         \
      -sDEVICE=pngalpha       \
      -g150x400               \
      - 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:00:05.737

试试[报告实验室](http://www.reportlab.com/software/opensource/rl-toolkit/) 它有一些很酷的功能，比如

1.  支持嵌入式 Type-1 或 TTF 字体
2.  支持亚洲、希伯来和阿拉伯字符
3.  支持任何流行格式的位图图像
4.  支持矢量图形

# c++ - 如何使用 wxwidgets 在 C++ 中访问串行端口数据

> ID：11939513
> 
> 赞同：3
> 
> 时间：2012-08-13T17:47:10.267
> 
> 标签：c++, serial-port, wxwidgets

我是电子和通信工程专业的学生。我正在做一个项目，其中微控制器将数据发送到计算机的串行端口（异步）。我目前正在为我的 GUI 工作学习 wxWidgets。

我的问题-是否可以使用 wxWidgets 来获取数据和显示。是不是很难实现。我搜索它，但没有直接回答如何实现它。所以建议我为此阅读我需要阅读的内容。以及有什么替代方法可以做到这一点。我用的是 Windows 7。

我还需要将此数据上传到网络服务器（稍后需要）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T17:59:48.483

wxWidgets, to the best of my knowledge, does not implement serial I/O facilities. There are other libraries available that provide this. One of the best choices is probably boost::asio (see [http://www.boost.org/doc/libs/1_40_0/doc/html/boost_asio/overview/serial_ports.html](http://www.boost.org/doc/libs/1_40_0/doc/html/boost_asio/overview/serial_ports.html))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T22:25:10.090

wxWidgets 是一个跨平台的 GUI 框架。

读取串口与 GUI 无关，与跨平台无关。

所以wxWidgets与读取串口无关。

您可以使用 Windows API 读取/写入串行端口。

[CreateFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)打开端口

[ReadFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365467%28v=vs.85%29.aspx)从端口读取数据

难的？有点！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T20:37:19.043

我自己从未使用过它，但有[wxCTB](http://wxcode.sourceforge.net/showcomp.php?name=wxCtb)。

# javascript - 嵌套的 AJAX 调用不起作用

> ID：11939516
> 
> 赞同：0
> 
> 时间：2012-08-13T17:47:36.100
> 
> 标签：javascript, jquery, xml, ajax

我无法让嵌套的 AJAX 调用正常工作。我想要的只是在外部 AJAX 调用成功完成后执行内部 AJAX 调用。

```
var diningHours = $("#diningHours");
var facStaffDiningData = $("#facStaffDiningData");
var diningCommonsData = $("#diningCommonsData");
if($.trim(diningHours.html()).length == 0) {
    var season;
    //This call executes fine (tested it with console logging)
    $.get("data/dining-hours.php", {summer: "check"}, function(seasonData, seasonStatus) {
        if(seasonStatus == "success") {
            season = seasonData;
            //This is the call that isn't being executed
            $.get("data/dining-hours.php", function(hoursData, hoursStatus) {
                if(hoursStatus == "success") {
                    var hours = $(hoursData).find("hours dining");
                    var html = hoursFeed(hours, season);
                    diningHours.append(html).collapsibleset("refresh");
                }
            });
        }

    });
} 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:46:06.387

深入研究这个问题，我发现了问题的真正根源。XML 文档有一堆编码错误（数据中有保留符号和版权符号）。删除这些并用正确的实体替换它们可以解决问题。我认为是问题的原始代码现在可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:52:52.887

我认为 seasonStatus 是多余的，因为回调将在成功时执行。

这应该有效

```
var season;
    //This call executes fine (tested it with console logging)
    $.get("data/dining-hours.php", {summer: "check"}, function(season, seasonStatus) {
           console.log('CB1',season);
            $.get("data/dining-hours.php", function(hoursData) {
                    console.log('CB2',hoursData);
                    var hours = $(hoursData).find("hours dining");
                    var html = hoursFeed(hours, season);
                    diningHours.append(html).collapsibleset("refresh");

            });
        }

    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:01:01.930

我会尝试这样的事情：

```
var diningHours = $("#diningHours"),
    facStaffDiningData = $("#facStaffDiningData"),
    diningCommonsData = $("#diningCommonsData");

if(!$.trim(diningHours.html()).length) {
    var XHR = $.get("data/dining-hours.php", {summer: "check"});
        XHR.success(function(seasonData) {
            var season = seasonData,
                XHR2 = $.get("data/dining-hours.php");
                XHR2.success(function(hoursData) {
                    var hours = $(hoursData).find("hours dining"),
                        html = hoursFeed(hours, season);
                    diningHours.append(html).collapsibleset("refresh");
                });
        });
}​ 
```

问题是，究竟是什么`hours dining`，你希望`find()`函数如何找到它？

# sql - 在sql中解析字符串

> ID：11939518
> 
> 赞同：0
> 
> 时间：2012-08-13T17:47:40.367
> 
> 标签：sql

我需要帮助解析`string`以下模式以进行签入`date`和签`date`出`SQL`

```
'CheckIn: Thursday, April 05, 2012
CheckOut: Saturday, April 07, 2012' 
```

我试过了

```
select 
SUBSTRING([stringToParse], CHARINDEX('Checkin: ', [stringToParse])+9, charindex('<',stringToParse)) as checkin_date,
SUBSTRING([stringToParse], CHARINDEX('CheckOut: ', [stringToParse])+10, LEN([stringToParse])) as checkout_date from xyztable 
```

这适用于结帐日期，但是当我使用类似的方法`parse`签入时，它会返回

```
'Thursday, April 05, 2012
Chec' 
```

我需要解析签入`date`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:53:06.280

在 SQL Server 中，语法是

```
SUBSTRING ( expression ,start , length ) 
```

因此，您需要从长度中减去一开始要使用的 9 个字符，以获得正确的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:53:30.527

substring() 的第三个参数是长度，而不是偏移量。尝试这个：

```
select  SUBSTRING([stringToParse], CHARINDEX('Checkin: ', [stringToParse])+9, charindex('< br/>',stringToParse)-11) as checkin_date,
        SUBSTRING([stringToParse], CHARINDEX('CheckOut: ', [stringToParse])+10, LEN([stringToParse])) as checkout_date
from (select 'CheckIn: Thursday, April 05, 2012 < br/>CheckOut: Saturday, April 07, 2012' as stringtoparse
     ) t 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:01:46.423

有时它可以帮助我使用 len(string) 而不是替换长度值，并在它自己的行上分解每个参数。

```
select 
SUBSTRING
(
    stringToParse, -- string
    CharIndex('CheckIn: ', stringToParse) + LEN('CheckIn: '), -- Start
    charindex('< br/>',stringToParse) - /*You want the position of the < br/> MINUS the position of the end of the CheckIn: */(CharIndex('CheckIn: ', stringToParse) + LEN('CheckIn: ')) -- # of characters
) as checkin_date
,
SUBSTRING
(
    stringToParse, 
    CHARINDEX('CheckOut: ', stringToParse)+10, 
    LEN(stringToParse)
) as checkout_date 
```

# css - 关闭 CSS 属性

> ID：11939519
> 
> 赞同：14
> 
> 时间：2012-08-13T17:47:40.983
> 
> 标签：css, overriding

假设我有一个插件的 CSS，稍后加载为我的 style.css

```
/*style.css*/
.something {
position:absolute;
left: 0px !important;                       
}

/*plugin's CSS*/
.something {
position:absolute;
left: -50px;                       
} 
```

/*现在它有 0px 但我根本不想要左值*/

我知道我可以设置 !important 以便该属性不会被覆盖，但是当 Chrome DevTools 取消选中某个属性时，是否有任何解决方案可以关闭“左”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T17:55:36.407

据我所知（有人请随时纠正我），没有办法像在 Chrome DevTools 中那样直接“关闭”CSS 属性。

最接近您可以将属性重置为默认值的方法。在您的示例中，它将是“left:auto;”

PS您可能希望调整您的标签以获得更多视图并希望得到答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T17:54:07.983

您应该使用 left 的“auto”值：

```
.something
{
    position:absolute;
    left:auto !important;
} 
```

“auto”将重置为默认值（由浏览器为该样式设置）

更多信息在这里：[http ://www.w3schools.com/cssref/pr_pos_left.asp](http://www.w3schools.com/cssref/pr_pos_left.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:51:26.723

特异性是选择您真正想要的 CSS 属性的关键。在插件与非插件案例中利用 HTML 的特定结构，以便在应用插件规则时，特异性规则选择您想要的 CSS。

这里有一个很好的特异性概述：

![在此处输入图像描述](../Images/4bcd94cb8d556115369e648a25601588.png)

资料来源： http: [//www.stuffandnonsense.co.uk/archives/css_specificity_wars.html](http://www.stuffandnonsense.co.uk/archives/css_specificity_wars.html)

想到的一个想法是使用额外的类*plugin*以及适当的选择器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T17:51:37.107

如果您试图覆盖它，那么您可以使用[CSS 特定性规则](http://css-tricks.com/specifics-on-css-specificity/)

# apache - 带有 mod-rewrite 的非 https 特定网址

> ID：11939535
> 
> 赞同：3
> 
> 时间：2012-08-13T17:49:02.757
> 
> 标签：apache, mod-rewrite

我有一个 apache vhost 监听端口：443

我正在尝试将任何 https 请求重定向回 http，除非它们满足以下条件

1.  从域`www.site.co.uk`
2.  并包含*或* `/alpha`包含在请求的`/beta`uri 部分

我在配置中有以下语句以及注释逻辑我虽然过程如下，但`https://www.mysite.co.uk/alpha`不知`https://www.mysite.co.uk/beta`何故被 301'd

我是否误解了条件重写的逻辑流程？

```
RewriteEngine On

# if host submitted is not 'www.mysite.co.uk' un-https the url (i.e. catchall)
RewriteCond %{HTTP_HOST} !^www\.mysite\.co\.uk [NC]
RewriteRule ^(.*)$ http://%{HTTP_HOST}$1 [NC,L,R=301]

# otherwise IF THE domain is 'www.mysite.co.uk
# *and* if the uri does not contain 'alpha' *or* 'beta' un-https the url
RewriteCond %{HTTP_HOST} ^www\.mysite\.co\.uk [NC]
RewriteCond %{REQUEST_URI} !^\/alpha/? [NC,OR]
RewriteCond %{REQUEST_URI} !^\/beta/? [NC]
RewriteRule ^(.*)$ http://%{HTTP_HOST}$1 [NC,L,R=301]

# otherwise the domain must be www.mysite.co.uk
# and the uri must contain '/alpha' *or* '/beta'
# in which case do nothing 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:59:07.170

您拥有的规则是 URI 的逻辑**OR**不包含`/alpha`or `/beta`。你需要所有的条件都*和*'ed 在一起。只需删除`[OR]`标志：

```
RewriteCond %{REQUEST_URI} !^\/alpha/? [NC]
RewriteCond %{REQUEST_URI} !^\/beta/? [NC] 
```

这是一个逻辑否定扩展。说*A*是`/alpha`，*B*是`/beta`。!A 因此不是`/alpha`。所以当你说 !（A 或 B）时，如果你扩展`!`，你会得到 !A**和**!B。

# reference - DMD2 (D language) how to link with a c library (libdl.so.2)

> ID：11939539
> 
> 赞同：1
> 
> 时间：2012-08-13T17:49:09.400
> 
> 标签：reference, hyperlink, d, dmd

Im using Eclipse with the DDT plugin and DMD 2.06 as the compiler. When I try to to use functions like dlopen, dlsym usw I get "unresolved reference" errors, in C and GCC I fixed them by linking with -ldl, -lsdl usw... but the DMD2 compiler doesnt have options like that, is there another way to link with specific libraries?

btw I define the C functions the following way

```
 extern(C)
    {
        /* From <dlfcn.h>
        *  See http://www.opengroup.org/onlinepubs/007908799/xsh/dlsym.html
        */

        const int RTLD_NOW = 2;

        void *dlopen(const(char)* file, int mode);
        int dlclose(void* handle);
        void *dlsym(void* handle, const(char*) name);
        const(char)* dlerror();
    } 
```

would be happy about any help.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T21:56:20.837

D does have link pragmas:

```
pragma(lib, "dl"); 
```

which will cause DMD to emit "-L-ldl" (or the system-appropriate link flag) to the linker. If the linker is order-sensitive (as ld is), you need to specify the pragmas in the order which you manually pass them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:52:50.120

Just pass `-L-ldl`.

Also, you don't need to redefine all of these. They are available in the `core.sys.posix.dlfcn` module.

# ruby-on-rails - Rails - 使用 Capistrano 部署后需要重新启动 Nginx？

> ID：11939540
> 
> 赞同：10
> 
> 时间：2012-08-13T17:49:11.747
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nginx, capistrano, passenger

我正在使用 Capistrano 来部署我的 Rails 应用程序。每当我部署时，更改都不会反映在浏览器上，我仍然需要重新启动 nginx 来更新站点（运行 sudo /etc/init.d/nginx restart）。我不太确定为什么，但它不应该在重新启动应用程序后更新吗？（使用触摸/app/tmp/restart.txt）

这是我的 deploy.rb

```
require "rvm/capistrano"
set :rvm_ruby_string, 'ruby-1.9.3-p194@app_name'
set :rvm_type, :user

require "bundler/capistrano"

set :application, "app_name"
set :user, "me"

set :deploy_to, "/home/#{user}/#{application}"
set :deploy_via, :copy

set :use_sudo, false

set :scm, :git
set :repository,  "~/Sites/#{application}/.git"
set :branch, "master"

role :web, '1.2.3.4'
role :app, '1.2.3.4'
role :db,  '1.2.3.4', :primary => true
role :db,  '1.2.3.4'

namespace :deploy do
 task :start do ; end
 task :stop do ; end
 task :restart, :roles => :app, :except => { :no_release => true } do
   run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}"
 end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T18:15:28.087

您不必重新启动或重新加载 nginx。只需触摸 tmp/restart.txt 就足以告诉乘客重新加载应用程序。

如果您使用的是最新版本的 capistrano，您甚至可以删除整个 'namespace :deploy' 部分。Capistrano 在成功部署后已经触及 tmp/restart.txt。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:26:29.163

我意识到部署设置与 [http://coding.smashingmagazine.com/2011/06/28/setup-a-ubuntu-vps-for-hosting-ruby-on-rails-applications-2/匹配](http://coding.smashingmagazine.com/2011/06/28/setup-a-ubuntu-vps-for-hosting-ruby-on-rails-applications-2/)

当我学习本教程时（大约一年前），我安装了稍微新版本的 nginx 和乘客。据我记得，我认为当我运行任何类型的 init.d 命令时，这些较新的版本促使我将 nginx 用作服务。(Ubuntu 10.04)

无论如何，我会切换代码

```
run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}" 
```

到

```
run "#{sudo} service nginx #{command}" 
```

看看这是否有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T12:14:06.200

也许问题在于你是如何开始Passenger的。Capistrano 将符号链接“当前”指向最新版本。任务

```
run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}" 
```

正在使用该“当前”来放置restart.txt。但根据[http://code.google.com/p/phusion-passenger/issues/detail?id=547](http://code.google.com/p/phusion-passenger/issues/detail?id=547)，Passenger 被“固定”到它开始的“当前”，而任务写入“restart.txt” '到当前的'当前'，可以这么说。因此，Passenger 没有“看到”它应该重新启动。

如果您 cd'ed 到当时的“当前”并从那里启动乘客，它会被固定到“当前”符号链接指向的目录，并且不会跟随符号链接的更改。因此，您可能需要摆脱“cd ... && 乘客开始...”并直接提供到乘客的路径。我扩展了你在接收者中的 deploy:start 和 deploy:stop 任务

```
task :start, :roles => :app, :except => { :no_release => true } do
  run "passenger start #{current_path} -a 127.0.0.1 -p 3000 -e production -d"
end
task :stop, :roles => :app, :except => { :no_release => true } do
  run "passenger stop #{current_path} -p 3000"
end 
```

# rest - 您如何记录 REST API？

> ID：11939542
> 
> 赞同：10
> 
> 时间：2012-08-13T17:49:20.803
> 
> 标签：rest, enunciate

您如何记录 REST API？不仅是关于资源是什么的文档，而且实际上是在请求中发送的数据是什么，以及在响应中发回的数据是什么。知道某些东西期望发送 XML 并返回 XML 是不够用的；或 JASN；管他呢。您如何记录在请求中发送的数据以及在响应中发送回的数据？

到目前为止，我能找到的最好的是 Enunciate 工具，您可以在其中记录您的 REST API 和数据元素。Enunciate 是否适合此类型的工具，我是否错过了任何其他提供此功能的工具，我应该看看？

我的 REST API 的使用者可以使用任何语言 python、Java、.NET 等

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T18:09:31.137

我为我的项目决定的方法是 Enunciate。似乎是 REST API 文档的事实标准。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-24T17:35:21.483

我有使用 Enunciate 的经验，这很棒，但我不太喜欢你可以用它生成的客户端。另一方面，我在上一个项目中一直在使用[swagger](http://swagger.wordnik.com/)，它似乎符合我的需求，真的很酷，你应该试一试！

**2016 年3 月 8 日更新：**看起来您可以使用 Enunciate 来构建*swagger*文档。
看到[这个](https://github.com/stoicflame/enunciate/wiki/Module-Swagger)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T21:30:55.860

我可能错了，但您似乎想要类似于 WSDL 和 XML Schema 的东西来记录您的 API。我建议阅读 Joe Gregorio 关于[我们是否需要 WADL](http://bitworking.org/news/193/Do-we-need-WADL)的帖子？它很好地讨论了为什么不将这种方法用于 REST API。如果您不想阅读整篇文章，其基本思想是类似 API 的文档（即 WADL）永远不够用，并且会导致接口脆弱。另一篇好文章是[REST 需要描述语言](http://www.infoq.com/news/2007/06/rest-description-language)吗？它有很多很好的链接到这种类型的讨论。

虽然他的帖子给了你不该做什么的建议，但它并没有真正回答你应该做什么的问题。REST 的重要之处在于统一接口的想法。换句话说，GET、PUT、POST 和 DELETE 应该完全按照您的想法去做。GET 检索资源的表示、PUT 更新、POST 创建和 DELETE 删除。

那么最大的问题是关于描述您的数据及其含义。您始终可以采用定义 XML Schema 或类似方法的方法，并从该模式生成文档。就个人而言，我发现机器生成的文档并不是那么有用。

以我的拙见，最好的数据格式具有广泛的、人类可读的文档和示例。这是我知道如何正确描述语义的唯一方法。我喜欢使用[Sphinx](http://sphinx.pocoo.org/)来生成这种类型的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T18:27:15.390

我不确定您是否在寻求一种工具来帮助您，或者您是否在询问最佳实践是什么（或两者兼而有之）。

就最佳实践而言，与其他软件文档一样适用于 REST 文档 - 提供具有广度的良好登录页面（即，您的资源列表以逻辑方式组织，并带有关于它们所做的事情及其 URI 的简介）和向下钻取页面详细解释了每个页面的功能，并附有示例。Twitter 的 REST API 有很好的文档记录，应该是一个很好的模型。

[Twitter API 主页](https://dev.twitter.com/docs/api)

[一种资源的示例钻取](https://dev.twitter.com/docs/api/1/get/statuses/home_timeline)

我真的很喜欢那个向下钻取页面。它列出了您需要的所有参数，以及每个参数的说明。它有一个侧边栏，列出了支持的类型。它具有指向相关页面和具有相同标签的其他页面的链接。它有一个示例请求和响应。

# c++ - 包含中包含的范围是什么？

> ID：11939543
> 
> 赞同：0
> 
> 时间：2012-08-13T17:49:21.583
> 
> 标签：c++, include

我不确定会发生什么，但请采取以下措施：

```
class A{

} 
```

-

```
class B{
 #include "A.h"
} 
```

-

```
class C{
 #include "B.h"
} 
```

现在，如果我在 C 类中编写代码，是否意味着 A 类也自动包含在内？据我了解，#include 基本上是当场复制整个文件。

谁能详细说明这一点？

我正在尝试尽可能多地使用类转发。但有时我根本做不到。

编辑：

上面的类不在同一个文件中。想象他们分开了。

编辑二：让我把它放在更多的背景下。

假设我正在创建一个包含类 B 的新类，但随后我声明了一个类型为 A 的变量。即使我从未将 A 包含到该类中，这似乎也可以编译。这就是它在 C++ 中的表现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:52:32.397

这基本上会在 class 中声明一个名为 A的**嵌套**`B`类。

`include`指令应该位于文件顶部以外的任何其他位置的情况非常罕见，并且通常具有与您所拥有的完全不同的目的。

如果我正确理解了您的文件层次结构，则相当于：

```
//A.h
class A{

};

//B.h
class B{
  class A{

  };
};

//C.h
class C{
  class B{
    class A{

    };
  };
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:52:57.767

你是对的，预处理器只是复制标题。如果你愿意，可以把它想象成一个长宏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:57:04.210

指令只是告诉编译器`#include`假装指定文件中的文本已写入`#include`指令出现的位置。它与作用域、语法或其他任何东西无关。它只是文本。

如果没有看到 Ah 和 Bh 的内容，就不可能再说出这些`#include`指令的效果。

# asp.net-mvc-3 - 如何在同一页面（列表/创建）MVC3 中使用@model IEnumerable<> 和@model <>

> ID：11939551
> 
> 赞同：4
> 
> 时间：2012-08-13T17:49:53.743
> 
> 标签：asp.net-mvc-3

假设我有一个类“位置”，并且我正在使用 MVC3 创建一个脚手架列表（index.cshtml）。index html 页面使用@model IEnumerable。如果我想在列表中添加一个新位置，我按下创建，最后我会使用@model Project.Models.Location 得到一个新的 html 页面。

我不想进入新页面，而是希望使用 boostrap(twitter) 中的模式将创建页面作为弹出窗口。我试过使用 partialview 没有任何运气。无论我做什么，我都会收到字典错误消息。

传入字典的模型项的类型为“System.Data.Entity.Infrastructure.DbQuery`1[Project.Models.Location]”，但此字典需要“Project.Models.Location”类型的模型项。

当我不获取局部视图时，模态（引导）本身正在工作。部分视图本身与生成的 create(CRUD) 完全相同。

编辑：我重写了整件事。

**指数：**

```
@model IEnumerable<LoLStats.Models.Location>

@{
    ViewBag.Title = "Index";
}
@foreach (var item in Model) {
    <ul>
        <li>@Html.DisplayFor(modelItem => item.LocationName)</li>
    </ul>
}

<a class="btn" data-toggle="modal" href="#myModal" >Create</a>

<div class="modal hide" id="myModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <h3>Modal header</h3>
  </div>
  <div class="modal-body">
    <p>@Html.Partial("_createLocation")</p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
  </div>
</div> 
```

**_createLocation：**

> @model LoLStats.Models.Location
> 
> @{ ViewBag.Title = "创建"; }
> 
> @using (Html.BeginForm()) { @Html.ValidationSummary(true) 位置
> 
> ```
>  <div class="editor-label">
>         @Html.LabelFor(model => model.LocationName)
>     </div>
>     <div class="editor-field">
>         @Html.EditorFor(model => model.LocationName)
>         @Html.ValidationMessageFor(model => model.LocationName)
>     </div>
>     <p>
>         <input type="submit" value="Create" />
>     </p>
> </fieldset> } 
> ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:11:25.433

您可以创建一个具有两个属性的视图模型：

*   父视图的 IEnumerable
*   模态的奇异对象

然后将两个视图都强输入到视图模型中，你应该已经准备好了。

**编辑**

视图模型：

```
public class MyViewModel()
{
  public IEnumerable<LoLStats.Models.Location> Locations {get; set;}
  public LoLStats.Models.Location Location {get; set;}
} 
```

指数：

```
@model myNamespace.MyViewModel
...
@foreach (var item in Model.Locations) {
    <ul>
        <li>@Html.DisplayFor(modelItem => item.Locations.LocationName)</li>
    </ul>
... 
```

_createLocation：

```
@model myNamespace.MyViewModel
...
<div class="editor-label">
        @Html.LabelFor(model => model.Location.LocationName)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Location.LocationName)
        @Html.ValidationMessageFor(model => model.Location.LocationName)
    </div>
... 
```

希望这些细节足以让您继续前进

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T06:29:13.840

在索引视图中试试这个：

```
 ... <p>@Html.Partial("_createLocation", Model.FirstOrDefault())</p> 
```

另一方面，也许这会更有意义：

```
 ... <p>@Html.Partial("_createLocation", new LoLStats.Models.Location())</p> 
```

希望对你有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T17:56:00.057

您的弹出窗口需要将模型定义为`Project.Models.Car`（单项）。成功保存单个项目后，您需要更新原始列表视图。您可以使用 jQuery 通过将新项目插入 DOM 来执行此操作，或者只需通过导航到为您提供列表开始的操作来刷新页面。

# c++ - 如何在整数右侧用零填充整数？

> ID：11939554
> 
> 赞同：1
> 
> 时间：2012-08-13T17:49:59.590
> 
> 标签：c++, objective-c, ios, cocoa-touch

我知道用零填充整数我可以执行以下操作，

NSString *version = [NSString stringWithFormat:@"%03d", appVersion.intValue];

如果需要，这将在整数左侧添加最多 3 个零。但是我想做同样的事情，但不是向左填充，而是向右填充。

如何用零填充整数但在整数的右侧？（理想情况下与上述方法类似的简单性）

这是我需要的一个例子，

如果整数结果是 38，我需要版本字符串显示为 380（整数末尾只添加了一个零，因为我想要最多三个字符，如果整数小于三个字符，则为零将被添加以使其成为三个）。

我目前使用的方法会给我 038。我需要 380。

或者如果整数是 381，那么输出应该是 381，因为我只想要最多三个字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:52:34.910

你能把这个值乘以 1000，然后打印出来吗？如果您需要很多零，您通常可能希望将 提升`int`为 a`long`或`long long`在乘法之前，以减少溢出的可能性。

```
NSString *version = [NSString stringWithFormat:@"%ld", ((long)appVersion.intValue)*1000]; 
```

如果您需要数字的长度`int`，在决定乘以十倍之前，取值`floor`的小数`log`并加一。例如：

```
int foo = 123;
int digitsInFoo = floor(log10(foo)) + 1; /* 3 */ 
```

然后使用一些规则来决定要添加多少个零位。

```
int totalDesiredLength = 5;
int numberOfZeroesNeeded = totalDesiredLength - digitsInFoo; /* this assumes totalDesiredLength >= digitsInFoo */
int factor = (int) pow(10, numberOfZeroesNeeded); /* 100 */ 
```

那么五位数的结果将是`foo * factor`或`12300`。您可以根据需要根据自己的情况进行调整。测试界限，这样你就不会得到奇怪的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:28:03.650

```
char buf[4];
int len = sprintf(buf, "%u", 38);
while (len < 3)
    buf[len++] = '0';
buf[len] = '\0'; 
```

您可能更`sprint_s`喜欢`sprintf`. 如果你真的很偏执，请检查返回的值`sprintf`是否为负数。

# javascript - Expresso 未安装在 Windows 7 上

> ID：11939559
> 
> 赞同：4
> 
> 时间：2012-08-13T17:50:12.603
> 
> 标签：javascript, node.js, expresso

在我的机器上安装 Expresso 时遇到与此类似的[问题](https://stackoverflow.com/questions/8781135/running-expresso-tdd-in-node-js-on-windows)

windows 7 x64
node.js 版本：0.8.0
npm 版本：1.1.32

```
> npm install expresso
npm http GET https://registry.npmjs.org/expresso
npm http 304 https://registry.npmjs.org/expresso

> expresso@0.9.2 preinstall C:\node_modules\expresso
> make deps/jscoverage/node-jscoverage

make: Interrupt/Exception caught (code = 0xc0000005, addr = 0x0x770843f9)
npm ERR! expresso@0.9.2 preinstall: `make deps/jscoverage/node-jscoverage`
npm ERR! `cmd "/c" "make deps/jscoverage/node-jscoverage"` failed with 255
npm ERR!
npm ERR! Failed at the expresso@0.9.2 preinstall script.
npm ERR! This is most likely a problem with the expresso package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     make deps/jscoverage/node-jscoverage
npm ERR! You can get their info via:
npm ERR!     npm owner ls expresso
npm ERR! There is likely additional logging output above.

npm ERR! System Windows_NT 6.1.7601
npm ERR! command "C:\\Program Files\\nodejs\\\\node.exe" "C:\\Program Files\\nodejs\\n
\\npm\\bin\\npm-cli.js" "install" "expresso"
npm ERR! cwd C:\
npm ERR! node -v v0.8.0
npm ERR! npm -v 1.1.32
npm ERR! code ELIFECYCLE
npm ERR! message expresso@0.9.2 preinstall: `make deps/jscoverage/node-jscoverage`
npm ERR! message `cmd "/c" "make deps/jscoverage/node-jscoverage"` failed with 255
npm ERR!
npm ERR! Additional logging details can be found in:
npm ERR!     C:\npm-debug.log
npm ERR! not ok code 0 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T16:06:51.767

使用 git clone 命令克隆模块并在本地使用代码。

# c# - 错误：设置为数组时对象类型字段的 XML 序列化

> ID：11939568
> 
> 赞同：0
> 
> 时间：2012-08-13T17:50:43.633
> 
> 标签：c#, visual-studio

我正在尝试序列化一个包含一个字段（类型对象）的类（Config），该字段包含一个数据项类（MyDataItem）。该类`MyDataItem`包含一个字段（类型对象）来保存数据项的值（值）。该值是 object 类型的原因是 a`MyDataItem`可能保存不同类型的值。当此值设置为数组（ex int []）而不是基本类型（int、string 等）时，出现`System.Invalid operation exception`错误：

```
There was an error generating the XML document.
The type System.Int32[] may not be used in this context. 
```

有谁知道我该如何解决这个问题？

我正在使用 Windows XP、Visual Studio 2008 和 .net 3.5

显示错误的示例程序：

[http://pastebin.com/esv55AvC](http://pastebin.com/esv55AvC)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:17:50.990

不是我的建议（IMO 你应该有非常简单、明显的 POCO / DTO 模型），但这应该可行：

```
 [XmlElement("tmp", Type = typeof(MyDataItem))]
    public object tmp; 
```

和：

```
 [XmlElement("Foo", Type = typeof(int[]))]
    [XmlElement("Bar", Type = typeof(int))]
    public object Value; 
```

# c# - 使程序可以从另一个程序独占执行

> ID：11939574
> 
> 赞同：0
> 
> 时间：2012-08-13T17:51:15.347
> 
> 标签：c#

我想为单独的 exe 创建一个启动程序。我需要在启动器之外无法访问主程序（而不是启动）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T17:54:28.767

根本不可能安全地做到这一点。启动器可以做的任何事情，用户也可以做。

您可以通过使启动器将加密签名的时间戳传递给单独的程序来使用户更难。但是，用户可以从启动器中提取私钥并手动签署时间戳。

您可以让程序检查其父 PID，并确保启动器 EXE 使用您自己的私钥签名，但用户可以修改程序以删除该检查。

您还可以将 EXE 转换为 DLL，使用启动器调用的方法，但用户可以编写自己的 EXE 来调用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:54:39.043

一种选择是在运行第二个程序时需要一个参数，尽管这很容易被利用。你没有说这到底是为了什么，所以它可能已经足够好了。

根据您的启动程序的功能，您可能能够检查这些操作是否已完成，如果没有，则退出程序。

如果您需要特别安全，您可以设置一些私钥-公钥系统，并加密一条动态信息（如时间戳）。老实说，我认为这将比它的价值更多，如果任何一个程序被反汇编，它仍然是可以利用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T17:55:09.730

您可能希望将主要功能实现为单独的*DLL*文件并从启动的应用程序中调用它。这样一来，主要功能并不完全是一个单独的应用程序，因此它可能不是您想要的，但它是分开的，需要运行另一个应用程序（启动器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T17:55:16.203

适当的解决方案取决于您要防止的确切内容。

如果你的目标是“在任何情况下，一个熟练的黑客都不能通过 A.exe 启动 B.exe”，那是很难实现的。

如果您的目标是“我不希望用户意外启动 B.exe，因为 A.exe 是他们应该使用的”，那么可以选择。例如，将命令行参数从 A.exe 传递到 B.exe，普通用户不会知道要传递该参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T17:56:10.323

我有两个建议来实现你想要的。

1.  第二个exe是否需要实际上是一个exe？你能把它改成图书馆调用吗？将功能作为在您的启动器进程下运行的线程调用。

2.  使用未发布的命令行参数。如果未提供它们，则终止第二个 exe。这并不完全安全，但我相信这就是现代游戏启动器的工作方式。

最终，我认为没有“通过默默无闻的安全”来做到这一点

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T18:02:17.563

您可以在启动器中创建一个以 Guid 作为名称的互斥锁。然后检查程序中的互斥锁。正如其他人所说，这不是很安全，但会阻止大多数人直接启动该程序。

# javascript - 使用正则表达式在 JavaScript 中每一行的开头添加一个字符

> ID：11939575
> 
> 赞同：3
> 
> 时间：2012-08-13T17:51:16.420
> 
> 标签：javascript, regex, replace

如何使用该`replace`函数使用正则表达式向 JavaScript 中的每一行添加单个字符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:56:33.690

使用*行*首正则表达式：

```
// X is the single char to add:
str = str.replace(/^/gm, "X"); 
```

标志导致跨行`gm`匹配。

# jquery - : 鼠标移动到 div 内的 iframe 上时的悬停问题 | IE浏览器

> ID：11939576
> 
> 赞同：3
> 
> 时间：2012-08-13T17:51:17.003
> 
> 标签：jquery, html, css, iframe, hover

**这是我的问题：**

我在浏览器窗口的左侧制作了一个小栏`#blokje{left:-180px; position:absolute;...}`，当用户将鼠标悬停在栏上时->使用`#blokje:hover{left:0};` 所有这些都可以正常工作，但现在我在 div 中添加了一个 google adsense 框架......一切工作正常，除了在 IE 中（最常用的浏览器；广告......）

看起来 div:hover 消失在框架上，导致烦人的闪烁，用户无法点击广告！

我认为一个可能的解决方案是使用 jquery 而不是 css 来执行悬停效果。有人可以将我的 css 翻译成 jQuery 吗？

```
#blokje{width:200px; height:200px; background:#F1F1F1; position:relative; left:-180px; color:black; }
#blokje:hover{left:0;}
#blokje #tit{position:absolute; width:30px; height:200px; background:black; right:0; top:0; } 
```

**提琴手**解释了这个问题；请注意，问题仅在 IE 中

[http://jsfiddle.net/6FeH8/](http://jsfiddle.net/6FeH8/)

**未缓存的测试环境中的在线实时示例**（注意：它是关于左边的栏而不是 404 错误！）

[http://kramels.x10.mx/goedkoopste-autolening.tk/](http://kramels.x10.mx/goedkoopste-autolening.tk/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:17:35.763

下面应该可以达到你想要的效果。这是基于链接的答案。jQuery：

```
 if($.browser.msie){
        $("#blokje iframe").on("hover",function(){ 
            $(this).parents("#blokje").toggleClass("hover");
        });
    } 
```

CSS：

```
#blokje:hover,#blokje.hover{left:0;} 
```

# c++ - 在 C++ 中使用 flexlexer 重载 yylex()

> ID：11939584
> 
> 赞同：1
> 
> 时间：2012-08-13T17:51:57.673
> 
> 标签：c++, lex, flex-lexer

我正在尝试在 lex 中编写一个简单的解析器并在 c++ 中执行它。[我按照这里](http://westes.github.io/flex/manual/Cxx.html#Cxx)的指示开始

```
WIKILINK    \133{2}[^\135]+\135{2}
%option noyywrap
%option c++
%{
#include <fstream>
#include <iostream>
#include <string>
#include <vector>
#include <stdio.h>

#include <FlexLexer.h>

class xxFlexLexer : public yyFlexLexer
{
    public:
    virtual int yylex()
    {
        std::cout << "hello" << std::endl;
    }
private:
            vector<string> listOfLinks;
};

using namespace std;
%}

%%
{WIKILINK}    {
                            int size = YYLeng();
                            string link(YYText());
                            link.erase(YYLeng()-3, 2);
                            link.erase(0, 2);
                            listOfLinks.push_back(link);
                            }
%%

int main()
{
    ifstream in;
    ofstream out;

    in.open("in.txt");
    out.open("out.txt");

    yyFlexLexer lexer(&in, &out);
    lexer.yylex();
} 
```

当我尝试编译程序 lex.yy.cc 时，我收到以下错误 -

```
In file included from tmp.cpp:12:0:
/usr/include/FlexLexer.h:112:7: error: redefinition of ‘class yyFlexLexer’
/usr/include/FlexLexer.h:112:7: error: previous definition of ‘class yyFlexLexer’
tmp.cpp: In member function ‘virtual int yyFlexLexer::yylex()’:
tmp.cpp:33:29: error: ‘listOfLinks’ was not declared in this scope 
```

我不明白这个错误。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:38:32.407

在网上看，我发现这个 FlexLexer.h 包含文件[https://www.w3.org/2005/05/22-SPARQL-MySQL/sparql/FlexLexer.h](https://www.w3.org/2005/05/22-SPARQL-MySQL/sparql/FlexLexer.h)似乎签名`yylex()`有一个参数`FLEXFIX`。

```
virtual int yylex(FLEXFIX) = 0;

// Call yylex with new input/output sources.
int yylex(FLEXFIX, istream* new_in, ostream* new_out = 0 )
    {
    switch_streams( new_in, new_out );
    return yylex(FLEXFIX2);
    } 
```

但是，其他版本的文件，例如[https://www.w3.org/2008/04/SPARQLfed/win/FlexLexer.h](https://www.w3.org/2008/04/SPARQLfed/win/FlexLexer.h)没有。

```
virtual int yylex() = 0;

// Call yylex with new input/output sources.
int yylex( FLEX_STD istream* new_in, FLEX_STD ostream* new_out = 0 )
    {
    switch_streams( new_in, new_out );
    return yylex();
    } 
```

顺便说一句，您的`yylex()`函数没有返回 int 值。

另请参阅@Gir 评论，其中包含指向错误报告[Bug 67277 - 编译 libclassparser_la.all_cc.cc 时出错：“class yyFlexLexer”重新定义](https://bugs.kde.org/show_bug.cgi?id=67277)的链接。

> 问题是 FlexLexer.h 标头有一种奇怪的方式来处理自身的多个包含。tokenizer.l (tokenizer.cc) 和 ClassParser.cc 都间接包含这个头文件，并且在单独的编译中它们工作正常；但是在编译连接源时，“#define yyFlexLexer yyFlexLexer”声明（由 flex 插入）从 tokenizer.cc 传递到 ClassParser.cc，并对第二个包含造成严重破坏。（在上面引用的错误消息中，两个 FlexLexer.h 行分别是第二个和第一个包含项。）
> 
> /A 解决方案是在 tokenizer.l 末尾添加“#undef yyFlexLexer”，我将附上一个补丁来解释原因。

FlexLexer.h 中的注释包括使用错误报告中针对多个实例和包含的内容提及的文件。不知道为什么在这种简单明了的事情中需要它。

```
// This file defines FlexLexer, an abstract class which specifies the
// external interface provided to flex C++ lexer objects, and yyFlexLexer,
// which defines a particular lexer class.
//
// If you want to create multiple lexer classes, you use the -P flag
// to rename each yyFlexLexer to some other xxFlexLexer.  You then
// include <FlexLexer.h> in your other sources once per lexer class:
//
//  #undef yyFlexLexer
//  #define yyFlexLexer xxFlexLexer
//  #include <FlexLexer.h>
//
//  #undef yyFlexLexer
//  #define yyFlexLexer zzFlexLexer
//  #include <FlexLexer.h>
//  ... 
```

查看您提供的链接，我想知道您是否需要删除 FlexLexer.h 包含，因为您只有一个解析器。

# c# - RavenDB 按索引字段选择文档

> ID：11939586
> 
> 赞同：0
> 
> 时间：2012-08-13T17:52:07.763
> 
> 标签：c#, nosql, ravendb

我是 RaveDB 的新手（实际上我昨天才开始学习它）。并尝试实现一些功能。

让我们有下一个类层次结构：

```
public abstract class Transaction
{
    public string Id { get; set; }
}

public class CategoryTransaction : Transaction
{
    public string AccountId { get; set; }

    public string Name { get; set; }

    public string Category { get; set; }

    public decimal Amount { get; set; }
}

public class ExchangeTransaction : Transaction
{
    public string DebitAccountId { get; set; }

    public string CreditAccountId { get; set; }

    public decimal DebitAmount { get; set; }

    public decimal CreditAmount { get; set; }
} 
```

一切都存储优秀的 int db。我将`Conventions = FindTypeTagName ...`商店文档添加为“事务/*”文档 ID。

但我想创建索引以选择特定帐户的所有交易（按字段 AccountId）。我创建了索引：

```
public class AccountTransactionResult
{
    public string AccId { get; set; }
}

public class Account_Transactions : AbstractMultiMapIndexCreationTask<AccountTransactionResult>
{
    public Account_Transactions()
    {
        this.AddMap<CategoryTransaction>( transactions => from transaction in transactions
                                                            select new
                                                                    {
                                                                    AccId = transaction.AccountId
                                                                    } );
        this.AddMap<ExchangeTransaction>( transactions => from transaction in transactions
                                                            select new
                                                                    {
                                                                    AccId = transaction.DebitAccountId
                                                                    } );
        this.AddMap<ExchangeTransaction>( transactions => from transaction in transactions
                                                            select new
                                                                    {
                                                                    AccId = transaction.CreditAccountId
                                                                    } );
    }
} 
```

该索引运行良好，我无法从 DB（Exchange 和 Category）中获取所有类型的事务作为 single `IEnumerable<Transaction>`。这太棒了。

但我想使用索引仅返回特定帐户的交易。因为`ExchangeTransaction`可以属于两个`Accounts`。我想看看`ExchangeTransaction`两者`Accounts`。我可以通过 AccId（索引字段）在 Raven Studio 中进行查询，而且效果很好！但我无法在代码中创建相同的请求:(。

有人能帮我吗？如何在 C# LINQ 查询中使用索引字段 AccId？

这段代码

```
var query = session.Query<Transaction, Account_Transactions>() 
```

返回所有类型的事务，但我不知道如何按数据库中的索引字段过滤事务。

提前致谢。请对不起我的英语，它不是我的母语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:49:43.287

我的错，在[文档](http://ravendb.net/docs/client-api/querying/polymorphism)中一切都很清楚。我错过了一些有用的段落。

> 最简单的方法是编写一个像这样的多地图索引：
> 
> ```
> public class AnimalsIndex : AbstractMultiMapIndexCreationTask
> {
>     public AnimalsIndex()
>     {
>         AddMap<Cat>(cats => from c in cats
>                             select new { c.Name });
> 
>         AddMap<Dog>(dogs => from d in dogs
>                             select new { d.Name });
>     }
> } 
> ```
> 
> 并像这样查询它：

```
var results = session.Advanced.LuceneQuery<object>("AnimalsIndex")
    .WhereEquals("Name", "Mitzy"); 
```

>

就我而言，我应该使用下一个构造：

```
var transactions = session.Advanced.LuceneQuery<Transaction>( "Account/Transactions" )
                    .WhereEquals( "AccId", account2.Id ) 
```

现在一切正常。

# c# - MVP 执行视图中的方法

> ID：11939589
> 
> 赞同：0
> 
> 时间：2012-08-13T17:52:21.650
> 
> 标签：c#, winforms, c#-4.0, dependency-injection, mvp

您打算如何从 Presenter 中调用 View（即 MainForm 部分类）中的方法。我是否必须将其添加到 View 实现的接口以及将其添加到 Presenter 中的接口？

如果不是，首选的方法是什么？

将所有这些方法添加到接口中似乎有点奇怪，以便我可以在视图中执行 UI 方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:54:33.027

View 实现了一个接口。Presenter 将此接口作为构造函数参数。因此，只能从 Presenter 中调用属于该接口的成员。如果您在视图（表单）中定义了一些其他方法，这些成员应该是私有的，并且演示者不应该知道任何关于它们的信息。

> 将所有这些方法添加到接口中似乎有点奇怪，以便我可以在视图中执行 UI 方法。

这就是 MVP 模式的工作原理。Presenter 通过视图实现的接口间接操作视图。

# javascript - 在 Javascript 中解析 mbox - split() 行为

> ID：11939591
> 
> 赞同：0
> 
> 时间：2012-08-13T17:52:30.383
> 
> 标签：javascript, parsing, split

我有一个 mbox 文件，其中包含 7 条消息。我尝试使用字符串“From -”上的以下代码对其进行解析。结果对象的长度为*8*，即使该字符串仅出现 7 次。即使字符串的第一次出现在第一行的第一个空格处，解析似乎也包含在那*之前*的一些内容，并且第一个元素的值的打印输出是“0”（其余元素是适当的字符串） . 为什么有一个额外的元素（它是我的方法行为代码）？

```
var fs = require('fs');

// Read in the text file

fs.readFile( '../Data/Inbox 6Msg Mbox.txt', function (err, data) {
  if (err) {
    throw err; 
  }

// Convert file to a string object

  var unParsed = data.toString();

// Split the text into an array of strings where each
// element is a message

  var indivMessages = unParsed.split("From -");
  console.log(indivMessages.length);

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:00:34.083

您所犯的错误称为[栅栏错误](http://en.wikipedia.org/wiki/Off-by-one_error#Fencepost_error)。尽管字符串出现了七次，但这将导致字符串出现*之间*的不是七个而是八个部分。

例如：

```
'1|2|3'.split('|') 
```

退货

```
['1','2','3'] 
```

即使管道只出现两次

即使我将管道作为第一个字符，生成的数组也是相同的长度：

```
'||'.split('|') 
```

返回

```
 ['','',''] 
```

逻辑相同，但现在`''`已替换`'1'`, `'2'`, 和`'3'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:03:09.353

当拆分字符/字符串是字符串的第一部分时，它会在其前面添加一个空索引。

```
var str = "aXbXcXdXeXf";
console.log(str.split("X")); 
```

结果是`["a","b","c","d","e","f"];`

```
var str = "XaXbXcXdXeXf";
console.log(str.split("X")); 
```

结果是`["","a","b","c","d","e","f"];`

# jquery - 省略 CSS 块的最后一个分号

> ID：11939595
> 
> 赞同：60
> 
> 时间：2012-08-13T17:52:37.267
> 
> 标签：jquery, css, syntax

关于这个的几个问题：

*   这是好习惯吗？
*   它会在大规模上带来更好的加载时间吗？
*   它会导致浏览器“崩溃”吗？
*   JavaScript (/jQuery) 中的最后一个函数也一样吗？

我的意思是这样的东西：

```
#myElement {
  position: absolute;
  top: 0;
  left: 0
} 
```

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-08-13T18:06:43.580

> **这是好习惯吗？**

手动排除分号不是一个好习惯。这纯粹是因为添加更多样式时很容易被忽略，特别是如果您在团队中工作：

想象一下，您从以下开始：

```
.foo {
    background-color: #F00;
    color: #000             <-- missing semi-colon
} 
```

然后有人添加了一些样式：

```
.foo {
    background-color: #F00;
    color: #000             <-- missing semi-colon
    width: 30px;
    z-index: 100;
} 
```

突然间，其他开发人员正在浪费时间弄清楚为什么他们的`width`声明不起作用（或者更糟糕的是，没有注意到它不起作用）。把分号留在里面更安全。

> **它会在大规模上带来更好的加载时间吗？**

最肯定的是，对于每个块，您会节省几个字节。这些加起来，尤其是对于大型样式表。与其自己担心这些性能提升，不如使用 CSS 压缩器，例如[YUI 压缩器](http://developer.yahoo.com/yui/compressor/)来自动为您删除结尾的分号。

> **它会导致浏览器“崩溃”吗？**

不，它是安全的，因为浏览器正确地实现了规范的这一部分。[CSS2 规范](http://www.w3.org/TR/CSS2/syndata.html#declaration)因此定义了一个声明：

> *声明*要么为空，要么由属性名称、后跟冒号 (:) 和属性值组成。

更重要的是：

> ...同一选择器的多个声明可以组织成分号 (;) 分隔的组。

这意味着`;`用于分隔多个声明，但不需要终止它们。

> **JavaScript 中的最后一个函数也一样吗？**

JavaScript 是一个完全不同的野兽，具有完全不同的规范。[这个特殊问题之前在 Stack Overflow 上](https://stackoverflow.com/questions/444080/do-you-recommend-using-semicolons-after-every-statement-in-javascript)已经多次深入回答过。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-13T17:56:17.140

*   不，省略分号会在您的应用程序中引入大量风险，如果您向元素添加更多样式，很容易忽略将其添加回来。在这一点上，您依靠您的手动流程和对细节的关注来确保您不会意外地放错您的非分号行。更糟糕的是，每次您准备好投入生产时，您都必须亲自检查您的 css 文件，以确保您没有搞砸每个元素中的任何最终样式行。

*   可能，因为文件会更小，但差异应该可以忽略不计。如果您担心加载时间，在将文件放在服务器上之前对其进行[Gzip 压缩会很好地为您服务。](http://www.wangarific.com/how-to-gzip-css-files/)

*   大多数浏览器都足够聪明，可以理解您的意思，但是您仍然需要担心由于不注意最后一种样式而搞砸了 CSS 文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-13T17:56:56.767

*   这是好习惯吗？

在我看来，没有。如果在最后一条规则下方添加一条规则，很容易忘记添加分号。

*   它会在大规模上带来更好的加载时间吗？

无法想象它会对加载时间产生很大影响。

*   它会导致浏览器“崩溃”吗？

不，分号仅用于分隔 CSS 块中的规则。分号是分隔符，而不是终止符。

*   Javascript (/jQuery) 中的最后一个函数是否也是如此？

是的，不要让 JavaScript 解释器添加分号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T17:57:24.987

它将稍微改善加载时间。使用足够大的 CSS 文件，它甚至可以很明显（嗯，总体上可以缩小；我怀疑*仅*删除最后的分号就足够了）。

但是，如果您非常关心加载时间，则应该使用程序来缩小 CSS，而不是手动尝试这样做。缩小的 CSS（几乎）无法阅读。可以这么说，在“源代码”中使用它是一种不好的做法，因为它太容易忘记它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-13T17:59:36.593

这是一个重复的问题。看这里：

[CSS中的分号](https://stackoverflow.com/questions/2406717/semicolon-in-css)

关于在 JavaScript 中应用分号，函数不应以分号结尾，除非它们以声明方式分配，即。`var a = function() {};` 但是，如果您无意（或故意）将分号排除在外，浏览器会自动插入分号。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-14T08:54:34.350

删除[*声明停止*](http://google-styleguide.googlecode.com/svn/trunk/htmlcssguide.xml#Declaration_stops)不会“破坏”浏览器，但仍应留给自动缩小器（特别是如果您关心加载时间 - 单独分号不会加起来太多），但出于可维护性原因应避免在源代码中。

如果您正在寻找最佳实践， Google css 样式指南中的[CSS 格式化规则](http://google-styleguide.googlecode.com/svn/trunk/htmlcssguide.xml#CSS_Formatting_Rules)是一个很好的起点——不要盲目地应用他们的建议，而是看看他们背后的推理。

> 在每个声明后使用分号。出于一致性和可扩展性的原因，以分号结束每个声明。

```
/* Not recommended */
.test {
  display: block;
  height: 100px
}
/* Recommended */
.test {
  display: block;
  height: 100px;
} 
```

Javascript 是一个不同的故事 - 简短的答案*总是使用分号，从不依赖隐式插入*，但我从未见过比谷歌[在他们的另一个样式指南中](http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml#Semicolons)规定的更好和更彻底的答案：

> 有几个地方缺少分号特别危险：

```
// 1.
MyClass.prototype.myMethod = function() {
  return 42;
}  // No semicolon here.

(function() {
  // Some initialization code wrapped in a function to create a scope for locals.
})();

var x = {
  'i': 1,
  'j': 2
}  // No semicolon here.

// 2\.  Trying to do one thing on Internet Explorer and another on Firefox.
// I know you'd never write code like this, but throw me a bone.
[normalVersion, ffVersion][isIE]();

var THINGS_TO_EAT = [apples, oysters, sprayOnCheese]  // No semicolon here.

// 3\. conditional execution a la bash
-1 == resultOfOperation() || die(); 
```

> 那么会发生什么？
> 
> 1.  JavaScript 错误 - 首先调用返回 42 的函数，并将第二个函数作为参数，然后“调用”数字 42 导致错误。
> 2.  当它试图调用`x[ffVersion][isIE]()`.
> 3.  `die`被调用，除非`resultOfOperation()`is`NaN`并被`THINGS_TO_EAT`分配 的结果`die()`。
> 
> 为什么？
> 
> JavaScript 要求语句以分号结尾，除非它认为可以安全地推断出它们的存在。在这些示例中的每一个中，都在语句中使用了函数声明或对象或数组字面量。右括号不足以表示语句的结束。如果下一个标记是中缀或括号运算符，则 Javascript 永远不会结束语句。
> 
> 这确实让人们感到惊讶，因此请确保您的作业以分号结尾。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-13T17:56:21.027

> 这是好习惯吗？

我会回避它，因为智能缩小过程会为你处理这个问题，如果你在添加新定义时忘记放置分号，它会引入错误。

> 它会在大规模上带来更好的加载时间吗？

是的，文件更小。但是，差异可以忽略不计，并且缩小过程会自动执行此操作。

> 它会导致浏览器“崩溃”吗？

不

> Javascript (/jQuery) 中的最后一个函数是否也是如此？

不，在函数语句的末尾排除分号是“无效的”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-13T17:57:29.883

根据我的经验，1）这不是好的做法 2）即使在非常大的范围内，加载时间也是微不足道的。3) 不知道有任何浏览器会因此中断。4) jQuery 也是如此

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-13T17:57:44.690

对于 CSS，我在 IE9、FF、GC、Safari 和 Opera 上尝试过，但并没有什么不同。

至于 Javascript，我在 FF 和 GC 上遇到错误，所以我想说不要在脚本上这样做。至于加载时间，差异不会以任何方式明显。

# php - 奇怪的数据库输出问题

> ID：11939598
> 
> 赞同：1
> 
> 时间：2012-08-13T17:52:50.883
> 
> 标签：php, mysql, database, special-characters

我将程序按原样存储在我的数据库表中（我的意思是没有规范。字符编码等。只是复制并粘贴到数据库中）。就像是

```
#include <pthread.h>
#include <errno.h>
#include <vmcmt.h>
... 
```

这是PHP

```
ob_start();
...
fetching information from database and echoing    
$markup = ob_get_clean();

// Specify configuration
$config = array(
    'indent' => true,
    'output-xhtml' => true,
    'wrap' => 200);

// Tidy
$tidy = new tidy;
$tidy->parseString($markup, $config, 'utf8');
$tidy->cleanRepair();

// Output
echo $markup; 
```

问题是，我从数据库中获取了一半丢失的输出代码。我的意思是输出一定是`#include <pthread.h>`刚刚好 `#include`。

# 我做了什么

首先我想，也许它与整洁的类有关：打开调试，我看到`$markup`. 但是当我回应它时，得到了相同的结果。试图删除所有输出缓冲功能，整洁..只是回显内容。结果还是一样。我想不通，我错过了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:56:37.763

查看您的 HTML 页面源代码。`<pthread.h>`假定为 html 标记。你需要

```
// Output
echo htmlentities($markup); 
```

# backbone.js - 附加模型未定义

> ID：11939599
> 
> 赞同：0
> 
> 时间：2012-08-13T17:52:52.557
> 
> 标签：backbone.js

我在视图中包含基于集合的附加模型时遇到问题。我有一个由父视图创建的评论列表。它需要我在呈现评论以显示删除按钮并突出显示他自己的评论时具有当前用户名。现在的问题是我无法在 CommentListView 中访问模型会话，因此初始化中的 this.session 或来自 addAllCommentTo list 之类的方法的调用是未定义的。我在这里做错了什么？我认为很容易从模型中将另一个对象添加到视图设备中。

评论列表视图：

```
window.CommentListView = Backbone.View.extend({

    el: $("#comments"),

    initialize: function () {

        this.model.bind('reset', this.addAllCommentToList, this);
        this.model.bind('add', this.refresh, this);
        this.model.bind('remove', this.refresh, this);
    },

    refresh: function(){
        this.model.fetch();
    },

    addCommentToList : function(comment) {
        console.log("comment added to dom");
        //need to check why el reference is not working
        $("#comments").append(new CommentView({model:comment, sessionModel: this.session}).render().el);
    },

    addAllCommentToList: function() {
        $("#comments").empty();
        this.model.each(this.addCommentToList);
    }
}); 
```

在初始化方法中从父列表调用：

```
window.UserDetailView = Backbone.View.extend({

    events: {
        "click #newComment" : "newComment"
    },

    initialize: function () {
        this.commentText = $("#commentText", this.el);

        new CommentListView({ model: this.model.comments, session: this.model.session });

        new LikeView({ model: this.model.like });

        this.model.comments.fetch();

    },

    newComment : function() {

        console.log("new comment");
        this.model.comments.create(
            new Comment({text: this.commentText.val()}), {wait: true}
        );
        this.commentText.val('');
    }

}); 
```

模型：

```
window.UserDetail = Backbone.Model.extend({

    urlRoot:'/api/details',

    initialize:function () {
        this.comments = new Comments();
        this.comments.url = "/api/details/" + this.id + "/comments";

        this.like = new Like();
        this.like.url = "/api/details/" + this.id + "/likes";

        this.session = new Session();

    },

    ...
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:41:41.807

我看到一个问题，但还有其他问题吗？

您正在像这样初始化视图：

```
new CommentListView({ model: this.model.comments, session: this.model.session }); 
```

而且您期望在您的视图中有这样的参考`this.session`。

这不会发生。您发送到 View 构造函数的所有哈希都将存储到`this.options`Backbone [View 构造函数文档](http://backbonejs.org/#View-constructor)中：

> 创建新视图时，您传递的选项作为 this.options 附加到视图，以供将来参考。

所以你可以开始改变这一行：

```
$("#comments").append(new CommentView({model:comment, sessionModel: this.session}).render().el); 
```

通过这个：

```
$("#comments").append(new CommentView({model:comment, sessionModel: this.options.session}).render().el); 
```

试着告诉我们。

### 更新

还要更改此行：

```
this.model.each(this.addCommentToList); 
```

这样：

```
this.model.each(this.addCommentToList, this); 
```

第二个参数是*context*，换句话说：你想`this`在被调用的*handler*中成为什么。

# magento - Magento - 由于 CSV 中的空格，库存水平的大规模更新失败

> ID：11939605
> 
> 赞同：1
> 
> 时间：2012-08-13T17:53:04.570
> 
> 标签：magento, csv, whitespace, stock

我正在使用以下代码更新 Magento 1.7.0.1 中的库存经过数小时的调查，我意识到该代码运行良好，但我的 csv 是问题所在。

以下是脚本所在的位置 [http://www.sonassi.com/knowledge-base/magento-kb/mass-update-stock-levels-in-magento-fast/](http://www.sonassi.com/knowledge-base/magento-kb/mass-update-stock-levels-in-magento-fast/)

我正在使用 dos 程序创建 csv 文件，它在每行末尾创建空格，导致脚本无法正确导入。

"sku","qty","is_in_stock" "prod1"
,"11","1"

About csv 看起来是正确的，但每行有大约 25 个您看不到的空格。

如果我打开 csv 并删除所有空格，保存并使用 stock.php 导入它，一切正常。

DOS 程序无法摆脱这些空间...有没有办法从 php 脚本中删除它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:00:43.057

例如像这样：

```
$sFile = 'my.csv';
$aFile = file($sFile);
foreach ($aFile as $iLine => $sLine) {
    $aFile[$iLine] = trim($sLine);
}
file_put_contents(
    $sFile,
    implode("\n", $aFile),

); 
```

# iphone - 通过文本文档保存 iPhone 通讯录联系人

> ID：11939613
> 
> 赞同：0
> 
> 时间：2012-08-13T17:53:34.553
> 
> 标签：iphone, ios

我试图弄清楚是否有一种方法可以通过文本文档保存 iPhone 的通讯录。我一直在寻找，但没有发现任何有用的东西。

我希望能够插入我的手机，将联系人保存在文本文档中，仅此而已。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:23:04.527

这很容易。只需仔细查看[地址簿编程指南](http://developer.apple.com/library/ios/#documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Introduction.html#//apple_ref/doc/uid/TP40007744)，尤其是“直接交互：以编程方式访问数据库”部分。您会发现获取所有记录是微不足道的。

```
ABAddressBookRef addressBook = ABAddressBookCreate();
CFArrayRef people = ABAddressBookCopyArrayOfAllPeople(addressBook);
CFMutableArrayRef peopleMutable = CFArrayCreateMutableCopy(
                                          kCFAllocatorDefault,
                                          CFArrayGetCount(people),
                                          people
                                  ); 
```

现在您所要做的就是`peopleMutual`使用以下函数迭代并提取数据

```
NSString* name = (__bridge_transfer NSString*)ABRecordCopyValue(person,
                                           kABPersonFirstNameProperty); 
```

对于各种属性。

将所有这些内容写入文本文件并上传、通过电子邮件发送或显示在 Web 视图或文本视图中以进行复制粘贴。

# c# - 命令行/脚本/解释环境中的 C# 或 Java？

> ID：11939614
> 
> 赞同：1
> 
> 时间：2012-08-13T17:53:36.017
> 
> 标签：c#, .net, scripting, programming-languages

所以以unix环境下的Python为例，我们可以从终端打开python，开始编写代码并立即运行它来测试一些python库函数。C# 或 Java 是否有类似的命令行/脚本环境（可能是 IDE 的插件？）？这样的工具对于试验 System library 之类的东西似乎非常有用。

相关地，我读到某些版本的 Python 在被虚拟环境执行之前被编译成字节码，这听起来像 Java 和 C#。但是，我在终端中打开并开始输入代码的 Python 程序必须被解释，对吗？所以根据原理，似乎可以编写 C# 或 Java 解释器。所以我不确定为什么我没有看到任何人在命令行上与 C# 或 Java 交互，就像他们使用 Python 一样。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T17:56:30.353

对于 .NET，有[LINQPad](http://www.linqpad.net/)。它支持 C#、VB.NET 和 F#。

顾名思义，它仅适用于 LINQ，但您可以在其中执行任何代码。不需要数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:31:44.910

对于 .NET，如果 LINQPad 对您来说太过分了，请尝试[RunNET](http://www.mobzystems.com/tools/runnet/)命令行包。它要求您加载脚本文件而不是交互式输入，但允许您利用更多语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:28:27.540

探索 .NET 类型的能力是我最初开始学习 F# 的原因之一，因为它有一个交互式环境（在 Visual Studio 中，单击 View > Other Windows > F# Interactive。）在深入研究 F# 后，我发现它成为我最喜欢的编程语言之一。

无论如何，你可能想看看它。很快就会弄清楚基本语法，一旦掌握了它，您就可以在交互式环境中探索各种 .NET 对象，如果您不想等待 Roslyn。

有关教程，请查看此页面：[http ://www.tryfsharp.org/Tutorials.aspx](http://www.tryfsharp.org/Tutorials.aspx)

# c# - 将httpwebresponse写入文件--powershell--short and sweet (piping)

> ID：11939618
> 
> 赞同：2
> 
> 时间：2012-08-13T17:53:52.727
> 
> 标签：c#, .net, powershell, httpwebrequest

我正在尝试使用 powershell 将 httpWebResponse 写入文件。原始脚本在 cURL 中，但我正在尝试使用 .NET 类来执行此操作。我可以让请求（发布或删除）工作，但我很难获得正确写入文本文件的响应。有没有办法使用管道而不是streamReader和Writer？

因为这是一个简洁的脚本，所以如果可以的话，我想避免使用 streamreader 和 streamwriter 附带的代码行。在powershell中以最少的代码将响应流写入文本文件的最佳方法是什么？管道可以吗？我假设它看起来像

```
|add-content $filename 
```

但是左边会发生什么？

这是我的删除电话。

```
[System.Reflection.Assembly]::LoadWithPartialName("System.Net")
write-host Deleting $database
$delRequest = [Net.HttpWebRequest]::Create("$DestinationRoot$database")
$delRequest.Method = "DELETE"
$delRequest.ContentType = "application/json"
$authorization = [System.Convert]::ToBase64String([System.Text.ASCIIEncoding]::ASCII.GetBytes("username" + ":" + "password")) 
$delRequest.Headers.Add("Authorization", "Basic " + $authorization)
[Net.HttpWebResponse] $delResponse = $delRequest.GetResponse() 
$delReader = new-object System.IO.StreamReader $delResponse.GetResponseStream() 
[System.IO.FileStream] $delStream = [System.IO.File]::Open($Log,[System.IO.FileMode]::OpenOrCreate, [System.IO.FileAccess]::Write, [System.IO.FileShare]::Write)
$delWrt = new-object IO.StreamWriter $delStream
while(-not $delReader.EndOfStream)
{
 $delWrt.WriteLine($delReader.ReadLine()) 
}
$delWrt.Close() 
```

这可行，但如果它可以节省我的代码行，我宁愿使用管道。cURL 可以在大约 5 行中完成所有这些，所以我可以做得越简单越好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:43:26.500

您可以用`$delReader = ...`流上的 .ReadToEnd() 方法替换下面的所有内容，并将其通过管道传输到文件。

```
$delReader = new-object System.IO.StreamReader $delResponse.GetResponseStream() 
$delReader.ReadToEnd() | Out-File $logFile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-24T19:20:19.660

对于所有回到这个问题的人，虽然我原来的答案仍然有效，但新版本的 PowerShell 包括“Invoke-WebRequest”，这更容易。

# wpf - WPF 一个元素一个资源？

> ID：11939621
> 
> 赞同：1
> 
> 时间：2012-08-13T17:54:14.257
> 
> 标签：wpf

一个资源项是否只能同时用于一个元素？例如：

[xml]

```
<Window.Resources>
    <Image x:Key="DockImage" Source="ico/pin.gif"/>
    <Image x:Key="UndockImage" Source="ico/pinHorizontal.gif"/>
</Window.Resources> 
```

和按钮：

```
<Button Width="26" Name="solutionButton" Click="eventname">
       <DynamicResource ResourceKey="DockImage"/>
 </Button>
<Button Width="26" Name="soundButton" Click="eventname2">
       <DynamicResource ResourceKey="DockImage"/>
 </Button> 
```

它们的图像在运行时更改为 UndockImage，但图像仅显示在这些按钮之一上。我可以将 DockImage 和 UndockImage 的 Image 键相乘，但我认为这将占用 2 倍以上的内存。一个资源键是否可以（同时）用于一个对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:59:38.353

任何源自的东西`UIElement`一次只能在一个地方显示。您不应该`Image`直接定义资源，这是用于显示图像的控件。相反，使用一些`ImageSource`派生类，例如`BitmapImage`，它表示内存中的图像。

```
<Window.Resources>
  <BitmapImage x:Key="DockImage" UriSource="ico/pin.gif"/>
  <BitmapImage x:Key="UndockImage" UriSource="ico/pinHorizontal.gif"/>
</Window.Resources>

<Button Width="26" Name="solutionButton" Click="eventname">
  <Image Source="{StaticResource DockImage}"/>
</Button>
<Button Width="26" Name="soundButton" Click="eventname2">
  <Image Source="{StaticResource DockImage}"/>
</Button> 
```

# google-checkout - Google Checkout 不会收取初始订阅费用

> ID：11939623
> 
> 赞同：0
> 
> 时间：2012-08-13T17:54:19.387
> 
> 标签：google-checkout, android-pay

我已经使用 Google 订阅服务有一段时间了，无论我多么努力，我都无法收取首期付款。

有没有人有任何想法？我已将订阅设置为由 Google 管理，对我来说一切都很好：

![邮件订阅截图](../Images/10a4a6e66c8fbb0b8ba55bee55531f98.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T04:20:11.587

我建议您查看更新的 Google Wallet Subscriptions API。集成和调试更简单，用户体验更简单，可用性更广：

[https://developers.google.com/in-app-payments/docs/subscriptions](https://developers.google.com/in-app-payments/docs/subscriptions)

[https://developers.google.com/in-app-payments/docs/jsreference#sub](https://developers.google.com/in-app-payments/docs/jsreference#sub)

# javascript - 使用 jQuery + regexes 删除方括号及其内容

> ID：11939624
> 
> 赞同：1
> 
> 时间：2012-08-13T17:54:23.833
> 
> 标签：javascript, jquery, html, regex, wordpress

[使用我在这里找到](http://jsfiddle.net/Scoobler/a9cvx/4/)的示例，我试图删除这些`[` `]`方括号包围的文本。

我的 html 中有很多次出现，`[sample-text]`并且想要删除整个内容，包括括号。

我已经尝试过了，但它不起作用——没有任何东西被替换：

```
var replaced = $("body").html().replace(/^\[.*\]$/g,'');
$("body").html(replaced); 
```

我试图匹配开始使用`[`和结束`]`并删除内部内容，但我无处可去。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:04:39.573

```
var replaced = $("body").html().replace(/\[.*\]/g,'');
$("body").html(replaced); 
```

# magento - 如何使用最近添加的项目添加块？

> ID：11939628
> 
> 赞同：1
> 
> 时间：2012-08-13T17:54:32.193
> 
> 标签：magento

我知道我可以展示新产品，但它们必须手动设置为新产品……我想要一种更自动化的方法。有什么方法可以显示最近添加的项目（目录可见）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T10:17:02.770

您只需要在 cms.xml 文件中创建添加以下语句，在本节中

```
<reference name="content">

<block type="catalog/product_list" name="home.catalog.product.list" alias="products_homepage" category_id=" " template="catalog/product/new.phtml" />
</reference> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:36:50.743

您可以像`Mage_Catalog_Block_Product_New`块类型一样创建块。此块用于从您的商店中检索所有新产品，并且可以通过 XML 层包含在内。您几乎需要块的精确副本，只是加载产品集合的方式`_beforeToHtml()`不同。

您要在其中加载的集合`_beforeToHtml()`是：

```
$collection = Mage::getResourceModel('catalog/product_collection')
    ->addAttributeToSort('created_at', 'DESC') // either ASC or DESC
    ->setPageSize(4); // the amount of products you want to show 
```

# java - 有没有一种简单的方法来解析 HTML 文档并删除除特定表格之外的所有内容？

> ID：11939631
> 
> 赞同：0
> 
> 时间：2012-08-13T17:54:56.190
> 
> 标签：java, c++, python, html, parsing

我正在尝试拼凑一个快速实用程序，该实用程序将从网站表中读取记录并将它们插入数据库。有几个条件：

1.  该页面的来源是*混乱*的。大量的 CSS 和 Javascript 被抛出。（这是一个内部网站。）
2.  我知道我想要的表的 ID。
3.  获得表格后，我必须进一步解析行以获取我正在寻找的特定信息。
4.  这必须在服务器端完成。（最好是 java、python 或 C++，尽管如果有其他特别好的选择，那也很好。）

那么有没有人知道一个好的库或实用程序可以通过 ID “抓取”一个 html 元素并让我解析它？我知道这是不言而喻的，但我更喜欢尽可能快的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:58:29.137

jQuery 可以通过它的 ID 选择一个元素。

请参阅[use-jquery-to-extract-data-from-html-lists-and-tables](http://encosia.com/use-jquery-to-extract-data-from-html-lists-and-tables/)

文章的要点是：

```
var tableObject = $('#myTable tbody tr').map(function(i) {
  var row = {};

  // Find all of the table cells on this row.
  $(this).find('td').each(function(i) { //do something with each td } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:55:59.630

您可以使用正则表达式：

```
<table[^>]*id="whatever"[^>]*>(.*?)</table> 
```

然后提取第一组（括号中的匹配部分）并解析出行：

```
<tr[^>]*>(.*?)</tr> 
```

最后，对于每一行，提取单元格：

```
<td[^>]*>(.*?)</td> 
```

这适用于您提到的任何语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:42:17.233

您可以在 Python 中使用[`lxml`库：](http://lxml.de)

```
#!/usr/bin/env python
import urllib2
from lxml import html # $ apt-get install python-lxml or $ pip install lxml

page = urllib2.urlopen('http://stackoverflow.com/q/11939631')
doc = html.parse(page).getroot()

div = doc.get_element_by_id('question')
for tr in div.find('table').iterchildren('tr'):
    for td in tr.iterchildren('td'):
        print(td.text_content()) # process td 
```

如果你熟悉 jQuery；你可以使用[pyquery](http://packages.python.org/pyquery/index.html)。它在 lxml 之上添加了 jQuery 接口：

```
#!/usr/bin/env python
from pyquery import PyQuery # $ apt-get install python-pyquery or
                            # $ pip install pyquery

# d is like the $ in jquery
d = PyQuery(url='http://stackoverflow.com/q/11939631', parser='html')
for tr in d("#question table > tr"):
    for td in tr.iterchildren('td'):
        print(td.text_content()) 
```

虽然在这种情况下`pyquery`并没有添加足够的。这是相同的使用 only `lxml`：

```
#!/usr/bin/env python
import urllib2
from lxml import html

page = urllib2.urlopen('http://stackoverflow.com/q/11939631')
doc = html.parse(page).getroot()
for tr in doc.cssselect('#question table > tr'):
    for td in tr.iterchildren('td'):
        print(td.text_content()) # process td 
```

注意：最后两个示例枚举元素内*所有*表（不仅仅是第一个）中的行。`#question`

# excel - 如何删除列excel文件？

> ID：11939637
> 
> 赞同：0
> 
> 时间：2012-08-13T17:55:14.443
> 
> 标签：excel, matlab

我已经在我的电脑上安装了 Matlab r2010a

我需要从名为 XLSX 的数据中获取数据，`myExample`然后验证之前是否处理过（它必须有一定数量的列）。如果已处理，则什么也不做。但如果未处理则需要删除听者行和几列（**覆盖现有文件**）。

非常感谢。

## 示例代码

```
fname = 'myExample.xlsx'
values = {1, 2, 3, 4 ; 5, 6, 7, 8 ; 9, 10, 11, 12};
headers = {'First', 'Second', 'Third', 'Fourth'};
xlswrite(fname, [headers; values]); 
```

## myExample.xlsx 包含：

```
First    Second    Third    Fourth
   1         2        3         4
   5         6        7         8
   9        10       11        12 
```

现在我问您要更改文件的内容（删除标题和一些列）。

```
ColsDelete = {'B', 'D'}; 
```

## 结果

运行 matlab 脚本后，验证是否已处理并删除第一行和第一列 B 和 D。现在`myExample.xlsx`包含：

```
1    3
5    7
9   11 
```

这种方式很好，因为您只需放置不需要的列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:56:36.240

与其删除列，不如创建一个仅包含您需要的数据的新 xlsx 文件不是更可取的做法吗？我只建议这样做，因为我处理了太多 xls 文件，如果我在编码时出错，我可能会丢失我不想删除的数据（一个简单的错误可能会让你删除所有你想要的列保留而不是你想扔掉的那些）。

用于[`xlsread`](http://www.mathworks.com/help/techdoc/ref/xlsread.html)从您的原始文件中读取`fname.xlsx`，然后用于[`xlswrite`](http://www.mathworks.com/help/techdoc/ref/xlswrite.html)将您想要保留的数据写入另一个文件`fname_processed.xlsx`。

# redhat - 通过 yum 安装时使用选项

> ID：11939640
> 
> 赞同：1
> 
> 时间：2012-08-13T17:55:20.857
> 
> 标签：redhat, yum

我有一个错误。解决方案似乎是使用以下配置选项安装 ImageMagick：

```
./configure -–disable-openmp -–enable-shared 
```

但我正在使用 yum 安装东西（在 Red Hat 上），所以我不知道如何执行这些命令行配置选项。

有谁知道如何让 yum 安装和配置这些命令行参数？

提前致谢，--
d

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:20:52.420

当您从源代码构建时，configure 在命令行运行。如果二进制 rpm 没有按照您需要的方式构建，那么您必须下载源 tarball 并重新构建它。当您解压缩 tarball 时，执行此操作的说明将位于名为 INSTALL 的文件中。这也意味着您需要编译器和其他开发工具。

# iphone - 在 UITextView 中查找一个字符的多个数字

> ID：11939641
> 
> 赞同：0
> 
> 时间：2012-08-13T17:55:28.047
> 
> 标签：iphone, objective-c, ios, nsstring, uitextview

我是一个`UITextView`我试图找到`@`角色的地方。文本视图可能有多个`@`s，所以我想知道，我怎样才能找到第 n 个`@`字符？

目前，我有：`NSRange range = [textViewText rangeOfCharacterFromSet:[NSCharacterSet characterSetWithCharactersInString:@"@"]];`。这只找到第一个`@`实例。我怎样才能找到后续的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:00:40.963

你可以尝试做一些事情，比如根据拆分文本`@"@"`，然后你知道组件在哪里被拆分，那就是`@`应该出现的地方。这样你就可以轻松找到`nth` `@`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-13T18:21:17.803

找到第 n 个后，您想做什么`@`？

这是一些勾画解决方案的示例代码。未编译或检查错误！

```
int targetItem = 3; // we find the 3rd item 

NSString *workingStr = @"your@string@containing@stuff";

int foundAtLocation = -1;
for (int idx = 0; idx < targetItem; idx++) {
    NSRange range = [workingStr rangeOfCharacterFromSet:[NSCharacterSet characterSetWithCharactersInString:@"@"]];
    if (range.location < 0) {
        // not found, give up
        foundAtLocation = -1;
        break;
    }
    workingStr = [workingStr substringFromIndex:range.location];
    foundAtLocation += range.location;
}
if (foundAtLocation >= 0) {
    NSLog(@" I found the %d occurence of @ at character index %d", targetItem, foundAtLocation);
}
else {
    NSLog(@" Not found");
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T18:00:47.697

如果我正确理解您的问题，则正则表达式可以解决您的问题。RegEx 有一些学习曲线，但它经常派上用场。

[http://www.regular-expressions.info/](http://www.regular-expressions.info/) 通常是正则表达式的一个很好的起点

[http://remarkablepixels.com/blog/2011/1/13/regular-expressions-on-ios-nsregularexpression.html](http://remarkablepixels.com/blog/2011/1/13/regular-expressions-on-ios-nsregularexpression.html) iOS 正则表达式教程

[http://reggyapp.com/](http://reggyapp.com/) Reggy 是一个 osx 应用程序，您可以在其中测试您的 RegEx 实际文本。

# python - 如何在同一个函数调用中使用可选的命名参数和 *mulit_vars？

> ID：11939646
> 
> 赞同：1
> 
> 时间：2012-08-13T17:56:16.690
> 
> 标签：python, python-2.x

假设您有这样的功能：

```
def example(var1=None,var2=None,var3=None,*multi_values):
    print (var1,var2,var3,*multi_values) 
```

你能绕过调用所有可选参数，只在最后一个参数中添加东西吗？

例子：

```
>>> multi=range(3)
>>> example(???)
(None,"hi",None,(1,2,3)) 
```

我不想这样做：

```
>>> multi=range(3)
>>> example(None,None,None,*multi) #bad -> this doesn't use the default values 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:01:07.920

一种选择是更改原型以将可迭代作为`multi_values`参数，而不是接受任意数量的参数：

```
def example(var1=None, var2=None, var3=None, multi_values=None):
    if multi_values is None:
        multi_values = []
    # whatever 
```

然后你可以调用函数

```
example(multi_values=multi) 
```

另一种选择是仅接受作为`var1`关键字`var3`参数：

```
def example(*multi_values, **kwargs):
    var1 = kwargs.pop("var1", None)
    var2 = kwargs.pop("var2", None)
    var3 = kwargs.pop("var3", None)
    if kwargs:
        raise TypeError("Unknown keyword arguments")
    # whatever 
```

在 Python 3.x 中，通过在参数*后*`var1`添加through来支持这一点：`var3` *`*multi_values`*

 *```
def example(*multi_values, var1=None, var2=None, var3=None):
    # whatever 
```

This does basically the same as the previous example, with the additional advantage of better introspection.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:00:16.720

不可以。您必须在 *args 值之前提供所有命名值。

但是，您可以使用 **kwargs 来获取其他命名参数。

```
def example(var1=None,var2=None,var3=None,**kwargs):

example(var4="something") 
```*

# python - 在python中连接列表

> ID：11939649
> 
> 赞同：2
> 
> 时间：2012-08-13T17:56:22.333
> 
> 标签：python, list, multidimensional-array

我有一个名为 3x2 的列表`x`和一个名为 1x2 的列表`y`：

```
x=[[1,2],[3,4],[5,6]] 
```

和

```
y=[10,20] 
```

**我的问题是如何连接`y`到末尾`x`以得到一个 4x2 列表，例如：**

```
x=[[1,2],[3,4],[5,6],[10,20]] 
```

我试过这个：

```
xx=[x,y] 
```

但它给了我这个不是 4x2 列表：

```
xx=[[[1,2],[3,4],[5,6]],[10,20]] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T17:57:42.180

```
>>> x = [[1, 2], [3, 4], [5, 6]]
>>> x
[[1, 2], [3, 4], [5, 6]]
>>> x.append([10, 20])
>>> x
[[1, 2], [3, 4], [5, 6], [10, 20]] 
```

或者：

```
>>> x = [[1, 2], [3, 4], [5, 6]]
>>> x
[[1, 2], [3, 4], [5, 6]]
>>> x += [[10, 20]] # a list with a list as its only element
>>> x
[[1, 2], [3, 4], [5, 6], [10, 20]] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-13T17:58:55.940

鉴于：

```
x = [[1,2],[3,4],[5,6]]
y = [10,20] 
```

这：

```
x.append(y) 
```

会给你：

```
[[1, 2], [3, 4], [5, 6], [10, 20]] 
```

**但是请注意**，这*会修改* `x`.

如果您*不想*修改`x`，这是另一种方式：

```
 xx = x + [y[:]] 
```

设置`xx`为：

```
 [[1, 2], [3, 4], [5, 6], [10, 20]] 
```

我们在上面的赋值中使用`y[:]`而不是简单地使用`y`，因为我们想为以后创建单独的副本`y`，`xx`如果（原始）`y`被修改它不会导致`xx`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-13T18:00:06.980

```
>>> x=[[1,2],[3,4],[5,6]]
>>> y=[10,20]
>>> x.append(y)  # or x.append(list(y)) to append a shallow copy of y
>>> x
[[1, 2], [3, 4], [5, 6], [10, 20]] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-13T18:04:11.430

如果你想要一个新列表：

```
z = x + [y] 
```

请注意， using`[y]`使内容成为列表中的列表，因此可以正常工作。

如果要`x`就地修改，则：

```
x.append(y) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-13T20:34:31.320

虽然我自己并不经常使用，但我觉得还是值得一提的是列表的***扩展***成员函数：

```
>>> x=[[1,2],[3,4],[5,6]]
>>> y=[10,20]
>>> x.extend([y])
>>> x
[[1, 2], [3, 4], [5, 6], [10, 20]] 
```

[http://docs.python.org/tutorial/datastructures.html#more-on-lists](http://docs.python.org/tutorial/datastructures.html#more-on-lists)

# google-ads-api - Google AdWords：删除跟踪转换代码添加的 iframe

> ID：11939653
> 
> 赞同：54
> 
> 时间：2012-08-13T17:56:34.940
> 
> 标签：google-ads-api

我想将 Google AdWords 添加到我的网站，但我应该添加的脚本会在 dom 中创建一个 iframe。这个 iframe 是可见的，并且在我的所有页面中都向下移动了 13px（它的高度）。

有没有办法避免这种情况？如果没有，我可以在不影响 Google AdWords 功能的情况下隐藏它吗？（它是一个空的 iframe）。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-08-24T15:58:59.883

有一个简单的修复方法不会影响代码片段的功能。我已经这样做了，没有任何不良影响。只需将脚本放在下面的隐藏 div 中，它就可以解决问题：

```
<div style="display:none">
  <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
  </script>
</div> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-08-14T20:13:46.403

@Mario 是正确的，有一个设置可以让你关闭这个显示。然而，谷歌用户界面上似乎不存在再营销标签的这个设置，即使它们确实显示了这个 iframe（我认为这是谷歌端的一个错误，因为我想“google_remarketing_only = true”标志应该打开此 iframe 已关闭且无法正常工作）。

我发现您也可以通过手动添加标志“google_conversion_format = 3”在跟踪 JS 中进行设置，如下所示：

```
<script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 0123456789,
        google_conversion_label = "XXXXXXXX",
        google_custom_params = window.google_tag_params,
        google_remarketing_only = true,
        google_conversion_format = 3;
    /* ]]> */
</script>
<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script> 
```

这可能比为某些人重新生成标签更容易，并且解决了 UI 不支持在生成标签时设置此选项的情况下的问题。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-01-14T16:27:59.147

我通常将此 CSS(3) 规则添加到样式表中：

```
iframe[name=google_conversion_frame] 
{
    display: none !important;
} 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-11T11:36:51.560

您还可以设置 max-height: 0; 而不是显示：无；不确定 iframe 上显示 none 的含义。这适用于 ie6。

```
iframe[name="google_conversion_frame"] {
    display: block;
    max-height: 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-08T16:18:16.163

对于这个问题，我遇到的最好和最简单的解决方案就是通过将以下代码添加到 css 样式表中来从文档流中删除框架：

```
iframe[name="google_conversion_frame"]{
  position:fixed;
} 
```

希望这可以帮助

# c# - 跨方法边界的 LINQ to SQL 规则

> ID：11939654
> 
> 赞同：5
> 
> 时间：2012-08-13T17:56:36.203
> 
> 标签：c#, linq-to-sql

为了让我的代码更简洁，我经常尝试将 LINQ to SQL 中的部分数据访问代码分解为私有子方法，就像使用普通的旧业务逻辑代码一样。让我举一个非常简单的例子：

```
public IEnumerable<Item> GetItemsFromRepository()
{
    var setA = from a in this.dataContext.TableA
               where /* criteria */
               select a.Prop;

    return DoSubquery(setA);
}

private IEnumerable<Item> DoSubQuery(IEnumerable<DateTimeOffset> set)
{
     return from item in set
            where /* criteria */
            select item;
} 
```

我敢肯定，没有人会通过想象具有更深嵌套的更复杂示例或使用集合结果来过滤其他查询来扩展想象力。

我的基本问题是：我已经看到了一些显着的性能差异，甚至只是通过在私有方法中重新组织 LINQ to SQL 代码而引发的异常。谁能解释这些行为的规则，以便我可以就如何编写高效、干净的数据访问代码做出明智的决定？

我有一些问题：

1) System.Linq.Table instace 何时通过方法导致查询执行？

2) 何时在另一个查询中使用 System.Linq.Table 会导致执行？

3) 对 System.Linq.Table 将参数传递给方法的操作类型（Take、First、Last、order by 等）是否有限制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:04:43.700

The most important rule in terms of LINQ-to-SQL would be: don't return `IEnumerable<T>` unless you must - as the semantic is unclear. There are two schools of thought beyond that:

*   if you return `IQueryable<T>`, it is *composable*, meaning the `where` from later queries is combined to make a single TSQL, but as a down-side, it is hard to fully test
*   otherwise, return `List<T>` or similar, so it is clear that everything beyond that point is LINQ-to-Objects

Currently, you are doing something in the middle: collapsing it to LINQ-to-Objects (via `IEnumerable<T>`), but without it being obvious - and keeping the connection open in the middle (again, only a problem because it isn't obvious)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:03:26.030

删除隐式转换：

```
public IQueryable<Item> GetItemsFromRepository()
{
    var setA = from a in this.dataContext.TableA
               where /* criteria */
               select a.Prop;

    return DoSubquery(setA);
}

private IQueryable<Item> DoSubQuery(IQueryable<DateTimeOffset> set)
{
     return from item in set
            where /* criteria */
            select item;
} 
```

`IQueryable<Item>`从to的隐式转换`IEnumerable<Item>`与调用`AsEnumerable()`您的`IQueryable<Item>`. 当然，有时您需要这样做，但您应该将其保留为`IQueryable`默认值，以便可以在数据库上执行整个查询，而不仅仅是`GetItemsFromRepository()`在内存中完成其余部分。

次要问题：

> 1) System.Linq.Table instace 何时通过方法导致查询执行？

当某事需要最终结果时，例如`Max()`,`ToList()`等既不是可查询对象，也不是加载时可枚举的对象。

但是请注意，虽然`AsEnumerable()`不会导致查询执行，但这确实意味着当执行确实发生在`AsEnumerable()`对源数据源执行之前，这将产生一个按需的内存数据源，其余的将被执行.

> 2) 何时在另一个查询中使用 System.Linq.Table 会导致执行？

和上面一样。`Table<T>`实现`IQueryable<T>`。例如，如果您将其中两个连接在一起，那还不会导致执行任何操作。

> 3) 对 System.Linq.Table 将参数传递给方法的操作类型（Take、First、Last、order by 等）是否有限制？

由 定义的那些`IQueryable<T>`。

编辑：对 和 之间的异同进行一些`IEnumerable`澄清`IQueryable`。

几乎可以在 an 上执行的任何操作，`IQueryable`反之亦然`IEnumerable`，但执行方式会有所不同。

任何给定`IQueryable`的实现都可以在 linq 查询中使用，并且将具有所有 linqy 扩展方法，例如,`Take()`等。`Select()``GroupBy`

只是如何做到这一点，取决于实施。例如，`System.Linq.Data.Table`通过将查询转换为 SQL 查询来实现这些方法，其结果在加载时转换为对象。所以如果`mySource`是一张桌子，那么：

```
var filtered = from item in mySource
  where item.ID < 23
  select new{item.ID, item.Name};

foreach(var i in filtered)
  Console.WriteLine(i.Name); 
```

变成如下 SQL：

```
select id, name from mySourceTable where id < 23 
```

然后从中创建一个枚举器，以便在每次调用`MoveNext()`另一行时从结果中读取，并从中创建一个新的匿名对象。

另一方面，如果`mySource`where a`List`或 a `HashSet`，或其他任何实现`IEnumerable<T>`但没有自己的查询引擎的东西，那么 linq-to-objects 代码会将其变成如下内容：

```
foreach(var item in mySource)
  if(item.ID < 23)
    yield return new {item.ID, item.Name}; 
```

这与该代码可以在内存中完成的效率差不多。结果将是相同的，但获得它们的方式会有所不同：

现在，由于所有`IQueryable<T>`都可以转换为等价物`IEnumerable<T>`，如果我们愿意，我们可以采用第一个`mySource`（在数据库中执行的地方）并执行以下操作：

```
var filtered = from item in mySource.AsEnumerable()
  where item.ID < 23
  select new{item.ID, item.Name}; 
```

在这里，虽然在我们迭代结果或调用检查所有这些结果的东西之前，仍然没有对数据库执行任何操作，但一旦我们这样做，就好像我们将执行分为两个单独的步骤：

```
var asEnum = mySource.AsEnumerable();
var filtered = from item in asEnum
  where item.ID < 23
  select new{item.ID, item.Name}; 
```

第一行的实现是执行 SQL `SELECT * FROM mySourceTable`，其余的执行就像上面的 linq-to-objects 示例。

不难看出，如果数据库包含 10 个 id < 23 的项目，以及 50,000 个 id 更高的项目，那么现在的性能要低得多。

除了提供显式`AsEnumerable()`方法外，所有`IQueryable<T>`都可以隐式转换为`IEnumerable<T>`. 这让我们可以`foreach`对它们进行处理并将它们与任何其他处理 的现有代码一起使用`IEnumerable<T>`，但是如果我们在不适当的时间不小心这样做了，我们可以使查询变得更慢，这就是当你`DoSubQuery`被定义为获取`IEnumerable<DateTimeOffset>`和返回时发生的情况一个`IEnumerable<Item>`; 它隐式地调用`AsEnumerable()`了你`IQueryable<DateTimeOffset>`和你的`IQueryable<Item>`，并导致可能在数据库上执行的操作在内存中执行。

出于这个原因，在 99% 的情况下，我们都希望继续进行交易，`IQueryable`直到最后一刻。

作为一个相反的例子，只是为了指出这一点`AsEnumerable()`以及演员`IEnumerable<T>`们并不是出于疯狂，我们应该考虑两件事。第一个是`IEnumerable<T>`让我们做一些其他方式无法完成的事情，比如加入两个完全不同但彼此不了解的来源（例如两个不同的数据库、一个数据库和一个 XML 文件等）

另一个是有时`IEnumerable<T>`实际上也更有效。考虑：

```
IQueryable<IGrouping<string, int>> groupingQuery = from item in mySource select item.ID group by item.Name;
var list1 = groupingQuery.Select(grp => new {Name=grp.Key, Count=grp.Count()}).ToList();//fine
foreach(var grp in groupingQuery)//disaster!
  Console.WriteLine(grp.Count()); 
```

这里`groupingQuery`被设置为一个可查询的，它进行一些分组，但无论如何都没有执行。当我们创建 list1 时，首先我们`IQueryable`基于它创建一个新的，查询引擎最好找出最适合它的 SQL 是什么，并提出如下内容：

```
select name, count(id) from mySourceTable group by name 
```

这是非常有效的执行。然后将行转换为对象，然后将其放入列表中。

另一方面，对于第二个查询，对于不对`group by`所有非分组项执行聚合方法的 a 没有自然的 SQL 转换，因此查询引擎能想到的最好的方法是首先做：

```
select distinct name from mySourceTable, 
```

然后对于它收到的每个名称，执行：

```
select id from mySourceTable where name = '{name found in last query goes here}' 
```

依此类推，这是否意味着 2 个 SQL 查询，还是 200,000 个。

在这种情况下，我们的工作要好得多，`mySource.AsEnumerable()`因为在这里首先将整个表抓取到内存中效率更高**。**（更好的是继续工作，`mySource.Select(item => new {item.ID, item.Name}).AsEnumerable()`因为那时我们仍然只从数据库中检索我们关心的列，然后切换到内存中）。

The last bit is worth remembering because it breaks our rule that we should stay with `IQueryable<T>` as long as possible. It isn't something to worry about much, but it is worth keeping an eye on if you do grouping and find yourself with a very slow query.

# algorithm - 基数排序：LSD 与 MSD 版本

> ID：11939656
> 
> 赞同：24
> 
> 时间：2012-08-13T17:56:37.933
> 
> 标签：algorithm, radix-sort, sorting

[“算法简介”](http://mitpress.mit.edu/algorithms/)一书提到了基数排序的 LSD（最低有效位）版本。但是，正如其他人在 stackoverflow 中指出的那样，还存在 MSD（最高有效位）版本。所以我想知道这些的优缺点。我的猜测是 LSD 版本比 MSD 版本有一些好处，但我不确定。因此问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T00:07:34.587

取自链接，可能有用：[http](http://www.eternallyconfuzzled.com/tuts/algorithms/jsw_tut_sorting.aspx) ://www.eternallyconfuzzled.com/tuts/algorithms/jsw_tut_sorting.aspx （在最底部）

LSD 基数排序的最大问题是它从差异最小的数字开始。如果我们可以从最重要的数字开始，那么第一遍将大大有助于对整个范围进行排序，之后的每一遍都会简单地处理细节。MSD基数排序的思想是将所有具有相等值的数字划分到自己的桶中，然后对所有桶做同样的事情，直到数组被排序。自然地，这暗示了一种递归算法，但这也意味着我们现在可以对可变长度的项目进行排序，并且我们不必接触所有数字来获得排序后的数组。这使得 MSD 基数排序更快更有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-03T02:41:31.707

[正如在Algorithms](http://algs4.cs.princeton.edu/home/)一书中所读到的，LSD 和 MSD 都是字符串数组排序算法，基于所谓的键索引计数而不是比较。因此，LSD 和 MSD 的运行时间与传统的快速排序或归并排序不同。

正如 Dzhabarov 所提到的，LSD 和 MSD 之间的最大区别在于 MSD 首先考虑最高有效数字或字符，它本质上对字符串进行排序，而不遍历字符串中的所有数字。这是一个优势。但是，MSD 的递归实现比 LSD 使用更多的空间。

下表说明了快速排序、LSD 和 MSD 之间的部分区别。

```
algorithm    running time              extra space
quicksort    N(lgN)^2                  1
LSD          NW                        N
MSD          between N and NW          N + WR 
```

其中N是数组的长度，W是字符串的长度，R是基数的大小。

PS：正如书中提到的，Java系统排序使用的是通用的排序算法，字符串比较快，不是LSD或MSD。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-27T14:40:19.653

当有固定长度时，LSD 比 MSD 快。MSD 对于小文件来说太慢了，它需要对小文件进行大量的递归调用。

# windows - OpenLDAP - 命名用户连接失败

> ID：11939658
> 
> 赞同：0
> 
> 时间：2012-08-13T17:56:42.973
> 
> 标签：windows, anonymous, openldap

我正在尝试设置一个基本的 ldap 服务器/客户端方案。我下载了openldap for windows并安装了它。我正在使用命令成功启动服务器，

```
slapd -d 1 
```

我尝试使用各种客户端（命令行、LDAP 浏览器、phpLDAPadmin）进行连接并进行搜索，它适用于“匿名访问”但每次我尝试使用 root 用户/密码并显示“连接到 ldap 失败”时它都会失败：//本地主机：389'。如果我匿名连接，同样的事情。

可能是什么问题呢 ？

这是我的 slapd.conf

```
ucdata-path ./ucdata
include ./schema/core.schema
pidfile ./run/slapd.pid
argsfile ./run/slapd.args
database bdb
suffix "dc=guessant,dc=org"
rootdn "cn=Manager,dc=guessant,dc=org"
rootpw secret
directory ./data 
```

我使用登录 DN 作为“cn=Manager,dc=guessant,dc=org”，密码作为“secret”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T05:34:26.533

现在已经修复了.. 问题出在 PHP mcrypt 和 phpLdapAdmin 上。显然 PHP 5.2 存在问题。并发现升级到 5.3 + 或删除 mcrypt 使用，可以解决它。我选择了后者，至少暂时

# java - Java 泛型从泛型方法返回持有者对象

> ID：11939659
> 
> 赞同：3
> 
> 时间：2012-08-13T17:56:45.940
> 
> 标签：java, generics

在下面的：

```
public interface SomeInteface<A, B> {  
    public B doSomething(A a);  
} 
```

我想实现一个方法`doSomething`返回参数的版本`a`。
我试了一`Holder`堂课；

```
class Holder<A> {  
     public A value;  
     public(A a){this.value = a;}  
} 
```

并返回`Holder`。但是，我不确定如何定义一个实现类`SomeInterface`以便我能够做到这一点。

以下甚至不编译：

```
public class SomeImplementation<X> implements SomeInterface<T> {  

  private class Holder<A> {  
    public A value;  

    public class Holder<A>{  
      public A value;  
      public(A a){this.value = a;}  
    } 
  }   

  class Implementation<A, Holder<A>> implements SomeInterface<A, Holder<A>>{    
    public Holder<A> doSomething(A a){  
      //do stuff      
      return new Holder(a);  
    }   
  }      
} 
```

我在这里搞砸了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:05:22.490

它需要是

```
class Implementation<A> implements SomeInteface<A, Holder<A>>{    
          public Holder<A> doSomething(A a){  
              //do stuff  
              return new Holder<A>(a);  
          }     

   } 
```

在类名中定义泛型变量及其约束。您不需要 Holder 变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T00:22:08.770

我不明白你为什么这么难。你说

> 我想实现一个方法`doSomething`返回参数的版本`a`。

好吧，你可以这样做：

```
public class SomeImplementation<A> implements SomeInterface<A, A> {
    public A doSomething(A a) {
        // do stuff
        return a;
    }
} 
```

不需要 Holder 类。SomeInterface 接口对类型参数没有任何限制，所以没有理由不一样。

或者，您可以允许您的实现使用两种不同的类型 A 和 B 进行参数化，其中 A 扩展 B（在某些情况下可能很有用）：

```
public class SomeImplementation<A extends B, B> implements SomeInterface<A, B> {
    public B doSomething(A a) {
        // do stuff
        return a;
    }
} 
```

# objective-c - 如何在 ARC 中从 id __autoreleasing * 转换为 void **？

> ID：11939665
> 
> 赞同：4
> 
> 时间：2012-08-13T17:57:05.127
> 
> 标签：objective-c, automatic-ref-counting, ocmock

我正在尝试从 id __autoreleasing * 转换为 CFTypeRef * (void **)。

我试过了：

```
id __autoreleasing *arg = [OCMArg setTo:mockData];

CFTypeRef expectedResult = (__bridge CFTypeRef) *arg;

[[[self.mockSecItemService expect] andReturnValue:OCMOCK_VALUE(mockCopyStatus)] copyItemMatching:queryCheck
                                                                                          result:&expectedResult]; 
```

但是当自动释放池耗尽时，代码会崩溃。

在 ARC 环境中如何转换为 void**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T23:59:01.233

我不知道您正在使用的 API，所以我不能 100% 确定发生了什么。我用谷歌搜索，他们似乎是 OCMock 的一部分。我下载了它并且（因为我不感兴趣而没有安装它）我迅速浏览了源代码。

我在该代码中看到了一些非常可疑的东西。以下是他们如何实现您调用的第一个方法：

```
@implementation OCMArg

....

+ (id *)setTo:(id)value
{
    return (id *)[[[OCMPassByRefSetter alloc] initWithValue:value] autorelease];
} 
```

所以他们正在返回一个`id*`实际上只是一个`id`.

对我来说，这要么是胡说八道/错误，要么是试图操纵 ObjC 内部（即使没有记录，ObjC 对象存储的第一件事实际上是指向对象类的指针，因此它的类型`Class`与 兼容`id`，因此它在某种程度上是有效地将指向对象的指针或指向对象的指针转换`id`为`Class*`或`id*`)。我没有时间或兴趣去研究整个 API 来弄清楚他们为什么这样做。他们实际上可能有一个很好的理由（例如，如果您只将该结果传递给另一个知道它应该是什么的 API，但您在这里做的还不止这些）。我不会研究 OCMock，而是会尽力向您解释正在发生的事情（ObjC 和 ARC）。

```
id __autoreleasing *arg = [OCMArg setTo:mockData]; 
```

ARC 在这行代码中绝对不会做任何事情。

您可以在上面看到该方法的作用。类`OCMPassByRefSetter`是一个简单的类，它只是在保留它之后存储参数，所以`mockData`被保留。是自动释放的，并将`OCMPassByRefSetter`在下一次耗尽时消失（释放`mockData` **并**`*arg`引用已释放的内存）。

请注意，`arg`实际上指向`isa`的`OCMPassByRefSetter`（这`isa`是任何对象的“第一个”ivar，它是类型`Class`并指向对象的类。但这没有记录，并且可能随时更改）。

```
CFTypeRef expectedResult = (__bridge CFTypeRef) *arg; 
```

`*arg``id`是与兼容的类型`CFTypeRef`，因此强制转换是有效的。你使用`__bridge`所以 ARC 绝对什么都不做。

如果`arg`指向“免费桥接”CF/Cocoa 类，这将是完全有效的代码，但您必须小心，它`expectedResult`会在下一次耗尽时变为无效（它不是`retained`，但它作为自动释放实例存在）。

```
[[[self.mockSecItemService expect] andReturnValue:OCMOCK_VALUE(mockCopyStatus)] copyItemMatching:queryCheck
                                                   result:&expectedResult]; 
```

不知道这条线是做什么的。鉴于您在上面的评论中发布的原型，ARC 对此没有任何作用`result:&expectedResult`。

你说它是一个包装器`SecItemCopyMatching`，但据我所知，它不止于此。如果它只是立即调用`SecItemCopyMatching`它作为`result:`参数，你可能会把事情搞砸。但是这个名字`expectedResult`和 OCMock 的事实让我觉得这比这更复杂一些。

你必须自己调查一下。但要记住：

*   一旦当前函数退出，您传递的参数 ( `&expectedResult`) 将变得无效，因为它是一个局部变量。
*   一旦有排水管， 的值*就会*`expectedResult`变得无效，因为该地址指向将被排水管释放的内存。
*   做*任何*具有价值的事情`expectedResult`都可能会出错，因为我认为 a 不`Class`符合“免费桥接”的条件。

我怀疑，但我可能错了，您没有按照预期的方式使用 OCMock api。但在这方面我无法帮助你，也许你实际上做得对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T00:32:08.017

我没有尝试弄清楚如何将变量转换为正确的格式（OCMock 在内部做一些复杂的事情），而是添加了另一种方法来处理转换。

```
- (OSStatus)findItemMatching:(NSDictionary *)query result:(id __autoreleasing *)outResult {
    NSAssert(outResult, @"outResult is required");

    CFTypeRef result = nil;
    OSStatus status = [self copyItemMatching:query result:&result];

    if (result) {
        *outResult = CFBridgingRelease(result);
    }

    return status;
} 
```

# html - 如何使用元视口和 CSS 媒体查询让平均 960 像素的网站在 iPhone 和 iPad 上看起来不错？

> ID：11939671
> 
> 赞同：14
> 
> 时间：2012-08-13T17:57:20.073
> 
> 标签：html, css, mobile

# 问题

我知道 Stack Overflow 上有很多关于元视口标签的问题，但我找不到任何人问什么似乎是最明显和最有用的问题：

**如何使用元视口和 CSS 媒体查询使平均 960 像素的网站设计在 iPad（和桌面）上看起来不错，同时仍然为 iPhone 和其他手机保留较小的视口和网站设计（例如 320 像素）？**

对于 iPhone，我认为这是不言而喻的：一个更小的、对手机友好的网站（例如，320 像素宽）是理想的。但对于 iPad 的大屏幕来说，一个专门的移动网站并不是必需的。使用正常的 960px 网站设计似乎是合适的。一个 320px 的网站在 iPad 上看起来很滑稽，我并不总是想为 iPad 的 768px 设计第三个变体。

这就是问题所在：我不知道如何使用元视口标签和 CSS 媒体查询来实现**1) iPad 上的普通站点和 2) iPhone 上的移动站点**。我意识到 JavaScript hacks 是可能的（例如，根据设备动态更改元视口标签），但我不想使用 JavaScript；我认为不应该要求 JS 在具有静态内容的简单网站上实现基本可用性。

1）如果我完全删除元视口标签，我的正常 960px 网站在 iPad 上看起来很*完美*，但在 iPhone 上却很糟糕（右侧大空白边距）：

![没有元视口标签的网站示例](../Images/60feb608c8e58d819ac3a2fdece9b7bc.png)

2）另一方面，如果我使用`<meta name="viewport" content="width=device-width" />`，则该网站在 iPhone 上看起来很棒，但在 iPad 上却很糟糕（放大到 768 像素，网站溢出视口）：

![带有元视口标签的网站示例](../Images/ed484a2d2a23997f6b8320b62cd66cff.png)

这似乎应该是世界上最简单的事情，但我一直无法解决它。我错过了什么？

# 标记/CSS

CSS：

```
<style type="text/css">
body { margin: 0; }
.mobile { width: 320px; background: #fdd; display: none; }
.desktop { width: 960px; background: #ddf; }
</style>

<style type="text/css" media="screen and (max-device-width: 480px)">
.mobile { display: block; }
.desktop { display: none; }
</style> 
```

标记：

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width" />
</head>
<body>
<div class="mobile">Phone (320px)</div>
<div class="desktop">Desktop and tablet (960px)</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T18:12:31.800

将媒体查询与`zoom`.

```
@media only screen and (min-device-width:768px) and (max-device-width:1024px) and (orientation:portrait) {
    html {zoom:0.8;}
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-25T08:21:43.220

尝试将最大比例添加到您的元标记：

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T07:35:18.330

您可以使用 JS 撕掉像 Cole 在这里讨论的元视口标签 - [http://cole007.net/blog/136/responsiveish-viewport-hack](http://cole007.net/blog/136/responsiveish-viewport-hack)评论中还有另一个选项

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-13T11:37:11.107

我使用 Serban Ghita 的 php Mobile Detection 方法：

[https://github.com/serbanghita/Mobile-Detect](https://github.com/serbanghita/Mobile-Detect)

...然后这个 php 在 head 标签中：

```
<?php
if ($detect->isMobile() && !$detect->isTablet()) {?>
   <meta name="viewport" content="width=device-width, initial-scale=1.0, max-scale = 1.0">
<?php } ?> 
```

效果很好。

# jquery - JQuery slide image when hover

> ID：11939680
> 
> 赞同：1
> 
> 时间：2012-08-13T17:57:33.867
> 
> 标签：jquery, image, slider

I want to know how to make an 8k width image to move to left when my mouse pointer(not clicking the image, just hover) is in the left side and move to right when it is in the right side using JQUERY, I dont know what the exact name for that effect so i used slide image in the title. if anyone knows how to do this i very much appreciate it... Thanks in advance for those who want to help :D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:15:29.540

您可以使用 jQuery 的“悬停”功能：[http](http://api.jquery.com/hover/) ://api.jquery.com/hover/ ，结合 jQuery 的鼠标定位功能，您可以在此处找到：http://docs.jquery.com/Tutorials: [Mouse_Position](http://docs.jquery.com/Tutorials:Mouse_Position)

然后根据鼠标在图像上的位置设置 handlerIn 和 handlerOut 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:16:28.240

有很多方法可以做到这一点，但这是我会做的。这就是我要做的。

```
<script type='text/javascript'>
$(document).ready(function(){
    $('#cross-img').hover(function(){
        $(this).css('margin-left', '-8px');
            }, function() {
        $(this).css('margin-left', '0');
    });
});
</script> 
```

[见效](http://dl.dropbox.com/u/60673975/shared-code/image-hover-slide.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:20:25.750

你找到鼠标的位置使用

```
$('img').mousemove(function(event){
    var horizontalMousePosition = event.pageX;
}); 
```

然后将其与页面上图像的位置进行比较

```
var leftEdge = $('img').offset().left //Left edge
var rightEdge = $('img').offset().left + $('img').innerWidth(); //Right edge
var middle = rightEdge - leftEdge; 
```

然后，如果鼠标位置“小于”图像一半的位置（即在左侧），那么我们将其向左移动：

```
if(horizontalMousePosition < middle){
    $('img').css({
        position: 'relative',
        left: -=50px
    });
} 
```

您将不得不玩弄它，因为这完全不在我的脑海中。但是您需要的所有功能都应该在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:03:53.977

可能有几种方法可以做到这一点。在我的脑海中，我可能会在图像 div 中有 2 个 div（图像的每一半有 1 个），然后使用 jQuery 悬停方法。

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

# vb.net - 将设计调整为 SOLID

> ID：11939681
> 
> 赞同：0
> 
> 时间：2012-08-13T17:57:35.800
> 
> 标签：vb.net, design-patterns

我正在开发一个非常大的 ASP.NET 应用程序。问题是设计背后没有太多的逻辑。最初的开发者选择了大约十个类，仅此而已。耦合度高，内聚度低。例如，clsPerson 拥有 Person 的所有功能，并打破了 SOLID 的大部分规则。

我已经开始将设计模式整合到我的工具包中。我的问题是：将设计不佳的类合并到更好的设计中的最佳方法是什么。例如，如果您有一个类 clsStudent，它包含迄今为止的所有 Student 功能，然后创建了一个名为 clsUndergraduate 的类，那么您会简单地派生 clsStudent 吗？我意识到这在很大程度上取决于上下文，但我正在寻找一般指导方针。

网上有很多关于 SOLID 的信息，但没有很多关于如何将现有应用程序改编为 SOLID 的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:59:19.967

可以说，您应该只在需要时实施 SOLID 原则。但是，我是一名倡导者，我相信在您的设计中添加 SOLIDity 元素并不难，而且不会带来太多开销或心痛。

尝试将现有模型移动到更可靠的模型可能很困难。我建议采用小的、可管理的部分并逐步重构。如果你有自动化测试的安全网，这应该是可以自信地实现的。如果没有，请确保您完全了解所做更改的范围。很容易引入细微的错误。最终，无论如何，严重的变化可能会引入新的测试。

遵守 SRP 可能是最容易开始的地方。尝试定义每个类的主要职责。如果他们目前有多个职责，请注意他们并查看如何将这些职责移出和其他地方。例如，许多“上帝”类将与业务逻辑一起管理持久性、验证、初始化等。看看你是否可以开始取出持久性代码并将其放入映射器/存储库/等。

如果你按照逻辑和顺序执行此操作，我的经验是，当你在此过程中犯很多错误时，其他原则的相关性和重要性就会显现出来，并让自己变得显而易见。

我发现，当我尝试使用 SOLID 原则时，通过阅读和重新阅读（主要是 Bob Martin 和 ObjectMentor），当您拥有实施的实践经验时，就会更加清晰。不要忘记四人帮中定义的开放原则。“优先组合优于继承”等概念与 SOLID OO 原则密切相关。

请记住，SOLID 代码通常比非 SOLID 代码更复杂，因此，不熟悉它的人更难维护和调试。怀疑论者可能会在你家门口指责“过度工程”，这可能很难与那些没有与增强/修复紧密耦合、不连贯的代码作斗争的人反驳。

Good luck. Please feel free to ask more as I'd love to hear the input of others on this subject. It's scope is wide and varied.

# cakephp - CakePHP Client Login Issues

> ID：11939687
> 
> 赞同：1
> 
> 时间：2012-08-13T17:57:57.123
> 
> 标签：cakephp, authentication, login, cakephp-2.0

I'm stumped. We have a client who cannot log in to our system and yet we can log in fine using her credentials. She can also log in fine from her friends home.

Upon entering her credentials the screen simply refreshes and nothing happens when in fact she should be brought to a dashboard page. When I monitor the request via the Chrome web developer tools I can see that the dashboard does get requested after log in but then suddenly we're brought back to the log in page.

Now I've cleared her cache, cookies and all other temporary internet files from both IE9 (her default browser) and Chrome. Nothing happens. I've read that changing session names might help but that did nothing either.

The system is using the newest version of CakePHP (2.2.1) and absolutely any help would be appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T22:18:41.840

此问题已得到解决。事实证明，这位客户尤其在她的计算机上设置了错误的日期和时间。设置正确的日期和时间后，她就可以正常登录了。

感谢大家的帮助！

# c++ - 是一个向量 > 制作矩阵类的好方法？

> ID：11939693
> 
> 赞同：1
> 
> 时间：2012-08-13T17:58:30.137
> 
> 标签：c++, vector, matrix

我是一名数学学生，对 C++ 很陌生，为了帮助我的学习，我想创建一个矩阵类（我不想使用库类）。我正在考虑做类似的事情

```
int iRows = 5;
int iColumns = 6;
double** pMatrix = new double*[iRows];
for (int i = 0; i < iRows; ++i) {
    pMatrix[i] = new double[iColumns];
} 
```

（我不确定这是否是正确的语法 - 在尝试之前我想在这里获得建议）但我在 Stackoverflow 看到不推荐使用不像 shared_ptr 的指针。是不是更好用`vector<vector<double>>`，这样我就不用担心删除内存了？我担心向量不是一个好的选择，因为长度可以用 push_back 改变，我希望矩阵的大小是固定的。我不能使用

```
double dMatrix[iRows][iColumns]; 
```

因为尺寸不是恒定的。什么是我使用的最佳选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:00:49.323

大概

```
std::vector<double> matrix(rows * columns); // ditch the prefixes
// indexing: matrix[row * columns + column]; 
```

因为无论如何每一行都将具有相同数量的列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:21:27.443

我会先问自己：你想达到什么目标？您是想创建一些东西作为学习练习，还是想要一个体面的矩阵实现？

如果您想将此作为学习练习，那么我建议仅在内部使用带有 MxN 元素的一维双精度向量。创建一个在内部存储它但对调用者隐藏实现的类——他们不应该知道或关心它是如何存储的。作为界面的一部分，您通常希望通过运算符 (m,n) 访问它，例如

```
double& MyMatrix::operator()(int m, int n) {
  return m_Array[m*numColumns + n];
} 
```

一旦你尝试用它做更有趣的事情，比如加法和乘法，你就会意识到你必须重载算术运算符。不仅`operator+`, `operator-`，还有运算符 *、/、*=、+=、-= /=、++、--。当您实现乘法时，您可能会发现您的实现可能太慢而无法使用，因为您可能会发现您正在制作大量冗余副本。YMMV

因此，如果您想要一个快速的矩阵库，那么您将需要一个在内部使用 BLAS 的库，例如 Boost 的[基本线性代数库](http://www.boost.org/doc/libs/1_50_0/libs/numeric/ublas/doc/index.htm)。

也许然后自己先尝试一下，以了解获得良好设计的问题，然后看看 boost，因为您将通过研究它学到很多东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:18:28.950

不，绝对不是。两者都不

```
vector<vector<double>> matrix; 
```

也不

```
double** matrix; 
```

是矩阵类的好布局。尽管您的课程可能会很好地熟悉编程，但此类矩阵课程的性能会较差。问题是您丢失了数据局部性。只需考虑您的代码

```
for (int i = 0; i < iRows; ++i) {
    pMatrix[i] = new double[iColumns];
} 
```

对于有效的矩阵向量乘法，您应该在缓存中拥有尽可能多的矩阵值，否则内存传输将花费太多时间。当您每行获取一个内存块时，无法保证这些数据垃圾在内存中紧密相连。对于简单的矩阵向量乘法，这可能并不算太糟糕，因为行元素仍然是连续存储的，并且“只有”从一行到下一行的跳转会导致缓存未命中。

但是，对转置矩阵进行操作确实是一个问题，因为沿列的值可能存储在内存中的任何位置，并且没有合理的方法来确定可用于缓存预取的那些元素之间的步幅。

因此，正如其他作者所建议的那样，为您的矩阵使用一大块内存。这需要您付出更多的努力，但它会为您的矩阵类的用户带来回报。

# ios - ios TableViewCell Customization issues. Not displaying the customized text

> ID：11939699
> 
> 赞同：0
> 
> 时间：2012-08-13T17:58:46.580
> 
> 标签：ios, uitableview

Hi I have an requirement to customize UITableViewCell. Hence I have created a custom class and necessary UI (xib) to support it. For the XIB I have chosen the class as the derived class that I have created. My Problem is when after linking the display labels to the properties and me setting the values at runtime does not display the text desired. Its left as blank. Below is the code snippet.

```
@interface CustomCell : UITableViewCell
{
    IBOutlet UILabel *titleRow;
}

@property (nonatomic, strong) UILabel *titleRow;
@property (nonatomic, strong) UILabel *subTitleRow;
@property (nonatomic, strong) UILabel *otherTextRow;
@end

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"MedVaultCell";
    CustomCell *cell = nil;
    cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    if (nil == cell){

        //Load custom cell from NIB file
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CustomCellHistoryCell" owner:self options:NULL];
        cell = [nib objectAtIndex:0];

        //cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        //cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton;
    }   

    // get the object
    Weight *currentCellWeight = [_weights objectAtIndex:indexPath.row];

    // Configure the cell...
    UILabel *titleLable = [[UILabel alloc]init];
    titleLable.text = currentCellWeight.customDispText;
    [cell setTitleRow:titleLable];

    cell.titleRow.text = currentCellWeight.display;
    cell.titleRow.textColor = [UIColor redColor];
    //cell.textLabel.text = [[_weights objectAtIndex:indexPath.row] customDispText];
    //cell.textLabel.textColor = [UIColor whiteColor];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:39:56.530

首先，我希望你`cellForRowAtIndexPath`是在你的`UITableView` `delegate`，而不是在你的自定义单元格中。

其次，问题来了：

```
// Configure the cell...
UILabel *titleLable = [[UILabel alloc]init];
titleLable.text = currentCellWeight.customDispText;
[cell setTitleRow:titleLable]; 
```

在此代码中，您将创建一个新标签并用新标签覆盖您的 IBOutlet 标签。那么您不会显示新标签。相反，将代码更改为：

```
// Configure the cell...
cell.titleRow.text = currentCellWeight.customDispText; 
```

但是，您随后将其重置`titleRow.text`为`currentCellWeight.display`.

因此，您需要选择其中哪一个作为文本并将文本设置为该文本。您不需要创建新标签 ( `UILabel *titleLable = [[UILabel alloc] init];`)，因为您已经在 IB 中创建了标签。

# jquery - How to open list item by clicking on item row (instead of selecting item)?

> ID：11939701
> 
> 赞同：0
> 
> 时间：2012-08-13T17:58:55.373
> 
> 标签：jquery, sharepoint

How to open list item (or folder) when user click on item row (not on linktitlenomenu column)? By default sharepoint select this item and I need select items by clicking on checkbox only and open item otherwise. I see many different jQuery scripts, but I find only how to get link on item with jQuery:

```
$(document).ready(function () {
    $('.ms-itmhover').each(
        function () {
            var a = $(this).find("td div[Field=LinkFilename] a")
            alert(a.attr('href'));
        }
    );

}); 
```

But I dont't know how to paste this url in row onclick handler.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T13:16:59.560

请检查以下代码，它可能会对您有所帮助。

```
 $(document).ready(function () {
    $(".ms-itmhover").each(function () {
        $(this).attr("href", $(this).find('td div[field="LinkFilename"] a').attr("href"));
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T08:54:42.203

我建议不要这样做，但如果你真的想这样做，我建议使用`dblclick`而不是模糊默认的单击行为。

所以在你的`$(document).ready`或 JSLink 中放：

```
(function () {
    "use strict";
    var rows = window.document.getElementsByClassName('ms-itmhover'),
        len = rows.length,
        i, 
        setLinkOnRow = function (row) {
            var link = row.querySelector('td div[field^=Link] a'),
                href = link.getAttribute('href');
            row.ondblclick=function () {
                window.location.href = href;
            };
        };

    for(i = 0; i < len; i += 1) {
        setLinkOnRow(rows[i]);
    }    
}()); 
```

或者，如果您有 jQuery 供您使用：

```
(function ($) {
    "use strict";
    $('.ms-itmhover').each(function () {
        var $this = $(this),
            href = $this.find('td div[field^=Link] a').attr('href');
        $this.dblclick(function () { 
            window.location.href = href;
        });
    });
}(jQuery)); 
```

# maven - find out from which maven repository the jar is coming from

> ID：11939707
> 
> 赞同：5
> 
> 时间：2012-08-13T17:59:17.700
> 
> 标签：maven, dependencies, repository

There is a plugin that works properly in my co-worker's system but doesn't in mine. I suspect it because of a repository included in his settings.xml but not in mine. Is there a tool that I can use to figure out from which repo is this plugin being downloaded from?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:07:40.837

Maven 将该信息存储在每个工件`_maven.repositories`的本地 maven 存储库（通常）中调用的文件中。`~/.m2/repositories`该文件位于本地 maven 存储库中相应工件的旁边。

该文件通常会列出从中下载工件的存储库/插件存储库。这与您`settings.xml`文件中的存储库匹配。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-11T19:01:02.400

在 Maven 3 中，该文件似乎已更改为 _remote.repositories

# sql - Get the latest file in a folder from stored procedure

> ID：11939712
> 
> 赞同：0
> 
> 时间：2012-08-13T17:59:35.893
> 
> 标签：sql, sql-server-2008

I need to get the latest file in a folder. I have the following files in a folder

```
A1.txt
A2.txt
A3.txt
A4.txt
A5.txt 
```

I need to get the latest file ie `A5.txt`

i am using the following command to get the latest file.

```
SET @c = 'dir  /b /o-e ' + QUOTENAME(@Path, '"') + ' A%.txt'  
INSERT INTO #f (Filename)   EXEC master.dbo.xp_cmdshell @C 
```

This will populate all the files to a temp table. I will take the top 1.

is there any simple method to take the latest file

The folder contains doc file also,but i need to take the file startingwith A

# selenium - 如何使用 Webdriver 验证 Selenium 中的图像是否

> ID：11939714
> 
> 赞同：1
> 
> 时间：2012-08-13T17:59:39.823
> 
> 标签：selenium, webdriver, selenium-webdriver

如何使用 WebDriver 验证正在显示的图像是 Selenium 中的正确路径/名称？

我开始使用此代码但不确定：

```
string _active = "<img style="display: ;" alt="Active" src="../App_Themes/Default/images/check.png"/>";
driver.FindElement(By.XPath("//*[@id='ctl00_ContentPlaceHolder1_AddeCardControl1_gv']/tbody/tr[11]/td[7]/img")).Text.Contains(_active); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T04:02:15.157

我想向你澄清一下这段代码

`driver.FindElement(By.XPath("//*[@id='ctl00_ContentPlaceHolder1_AddeCardControl1_gv']/tbody/tr[11]/td[7]/img")).Text.Contains(_active);`

没有给你图像标签的 html 代码，而是一个`IWebElement`对象。`WebElement`您可以使用[GetAttribute](http://selenium.googlecode.com/svn/trunk/docs/api/dotnet/html/M_OpenQA_Selenium_IWebElement_GetAttribute.htm)方法读取 this 的各种属性。

您必须通过`src`xpath`img`定位图像（webelement）然后

```
IWebElement element = driver.FindElement(By.XPath("Your xpath"));
        string path = element.GetAttribute("src"); 
```

现在您可以验证图像的路径。希望这对您有所帮助。

# jquery - 单击此类时将添加类和删除类添加到两个元素

> ID：11939723
> 
> 赞同：0
> 
> 时间：2012-08-13T18:00:05.473
> 
> 标签：jquery, fancybox, addclass, removeclass, toggleclass

我将fancybox插件与'tabify'插件组合使用，这样我就可以点击一个链接并拥有一个选项卡式灯箱。那里没有问题——但是，我希望能够单击一个链接来激活特定选项卡上的活动状态并从另一个选项卡上删除活动状态。

这是jQuery：

```
$("a.timesheet-active").click(function() {
        if ($('li').hasClass('active')) {
        $('li.active').addClass('inactive').removeClass('active');
        }
        if ($('li').hasClass('inactive')) {
        $('li.inactive').removeClass('inactive').addClass('active');
    }
});

<ul id="menu">
    <li class="active"><a id="aa-pp" href="#reserve-pp"></a></li>
    <li class="inactive"><a id="aa-ts" href="#reserve-timesheets"></a></li>
</ul> 
```

这里的目标是当点击a.timesheet-active时，li.active变成li.inactive，li.inactive变成li.active

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:07:05.127

```
$("a.timesheet-active").on('click', function(e) {
    e.preventDefault();
    $('li.active, li.inactive').toggleClass('inactive active');
}); 
```

如果它是一个`<a>`元素，您通常需要阻止默认操作，然后只需切换两个元素上的两个类即可在它们之间切换。

[**小提琴**](http://jsfiddle.net/2L8v9/)

# jquery - 下拉列表的jQuery背景

> ID：11939725
> 
> 赞同：0
> 
> 时间：2012-08-13T18:00:06.157
> 
> 标签：jquery, asp.net

我有一个下拉列表，我想让列表中的特定项目的背景颜色为黄色，我不确定 jquery 代码。

这是脚本：

```
<script language="text/Javascript">
    $(function(){
        $('select[id="ddlParticipants"]'.rows[2].bgColor = "#FFFF00")
    })
</script> 
```

这是下拉列表：

```
<asp:DropDownList ID="ddlParticipants" runat="server" Width="300px"
     AutoPostBack="True" 
     onselectedindexchanged="ddlParticipants_SelectedIndexChanged" 
     meta:resourcekey="ddlParticipantsResource1">
     <asp:ListItem Text="<%$ Resources:Resources, Select %>" 
         meta:resourcekey="ListItemResource1"></asp:ListItem>
     <asp:ListItem Text="---I am a NEW participant---" Value="0" 
         meta:resourcekey="ListItemResource2"></asp:ListItem>
</asp:DropDownList> 
```

我想将“我是新参与者”的列表项设为黄色。有人有想法么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:14:50.660

使用您拥有的标记，您尝试做的事情是不可能的。`<asp:dropdownlist>`呈现为`<select ..>`HTML 中的元素，您无法设置元素`<options>`内部的样式`<select>`。您将不得不求助于其他技巧，使用`li`或类似的东西。

# git - Git 推送到带有子模块的天蓝色网站

> ID：11939728
> 
> 赞同：7
> 
> 时间：2012-08-13T18:00:22.673
> 
> 标签：git, azure, azure-web-app-service

到目前为止，我一直在通过 Git 将网站发布到 Windows Azure 网站，没有任何问题。但是今天我们在项目中添加了一个子模块，Azure 似乎不喜欢使用子模块。

构建失败，因为我的应用程序依赖于子模块，Azure 看到一个空文件夹而不是子模块代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-14T12:51:49.720

Kudu 现在启用使用 git 子模块

# google-apps-script - 显示 SplitLayoutPanel 及其子元素

> ID：11939731
> 
> 赞同：1
> 
> 时间：2012-08-13T18:00:31.300
> 
> 标签：google-apps-script

我似乎无法让 SplitLayoutPanel 显示它的子元素。如文档中所述，GAS 似乎支持此类。

[https://developers.google.com/apps-script/class_splitlayoutpanel](https://developers.google.com/apps-script/class_splitlayoutpanel)

这是我对代码的尝试。任何建议将不胜感激。我的假设是这为用户提供了一个拆分器，他们可以拖动它来调整面板的大小（这非常适合我的目标。左侧面板和右侧面板具有更多细节。

```
 function doGet(e) { 
  var app = UiApp.createApplication();
  //code goes here   

  var mainPanel = app.createSplitLayoutPanel().setId('mainPanel')
    .setVisible(true);
  app.add(mainPanel);

   var eastPanel = app.createVerticalPanel().setId('eastPanel');
  eastPanel.add(app.createLabel('eastPanel loaded'));
  mainPanel.addEast(eastPanel, 500);

  var westPanel = app.createVerticalPanel().setId('westPanel');
  westPanel.add(app.createLabel('westPanel loaded'));
  mainPanel.addWest(westPanel, 500);

  return app;
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:55:49.393

`mainPanel.setSize('100%', '100%');`遗漏了一行。以下代码有效。

```
function doGet(e) { 
  var app = UiApp.createApplication();
  //code goes here   

  var mainPanel = app.createSplitLayoutPanel().setId('mainPanel')
    .setVisible(true);
  mainPanel.setSize('100%', '100%');
  app.add(mainPanel);

   var eastPanel = app.createVerticalPanel().setId('eastPanel');
  eastPanel.add(app.createLabel('eastPanel loaded'));
  mainPanel.addEast(eastPanel, 500);

  var westPanel = app.createVerticalPanel().setId('westPanel');
  westPanel.add(app.createLabel('westPanel loaded'));
  mainPanel.addWest(westPanel, 500);

  return app;
} 
```

# javascript - 为什么未执行的 eval 会对某些浏览器的行为产生影响？

> ID：11939736
> 
> 赞同：20
> 
> 时间：2012-08-13T18:00:36.307
> 
> 标签：javascript

假设我有这两个功能：

```
function change(args) {
    args[0] = "changed";
    return " => ";
}
function f(x) {
    return [x, change(f.arguments), x];
}
console.log(f("original")); 
```

在大多数浏览器中，除了 Opera，它返回`["original", " => ", "original"]`.

但是如果我`f`像这样改变功能，

```
function f(x) {
    return [x, change(f.arguments), x];
    eval("");
} 
```

它将`["original", " => ", "changed"]`在 IE9、Safari 5 和 Firefox 16 和 17 中返回。

如果我替换`eval("")`为`arguments`，它也会在 Chrome 中更改。

您可以[在自己的浏览器上在 jsFiddle 上对其进行测试。](http://jsfiddle.net/jENnC/)

我根本不理解这种行为。如果函数在这些语句执行之前返回，这些语句如何影响返回值？即使语句被执行，为什么它们会对参数突变产生任何影响？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T16:53:04.720

> ### TL;博士
> 
> 可能的原因是非标准`function.arguments`与包含`eval`和/或的函数代码的浏览器优化的交互`arguments`。但是，只有熟悉每个浏览器的实现细节的人才能深入解释其中的*原因。*

这里的主要问题似乎是使用非标准`Function.prototype.arguments`. 当你不使用它时，奇怪的行为就会消失。

规范只提到了[`arguments`object](http://ecma-international.org/ecma-262/5.1/#sec-10.6)，并没有说它可以被视为一个属性，前缀为`[funcName].`. 我不确定它来自哪里，但它可能是 ES3 之前的东西，为了向后兼容而保留在浏览器上。正如 Cory 的回答所说，[现在不鼓励在 MDN 上](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)使用这种方法。然而，[MSDN并没有对此表示任何反对。](http://msdn.microsoft.com/en-us/library/ie/he95z461(v=vs.94).aspx)我还发现本[规范中提到了浏览器之间的兼容性](http://mathias.html5.org/specs/javascript/#function.prototype.arguments)^*，供应商似乎并没有一致地实现它（没有浏览器通过所有[测试](http://mathias.html5.org/tests/javascript/function/)）。此外，`arguments`在严格模式下不允许用作函数的属性（同样，这不在 ECMA 规范中，IE9 似乎忽略了限制）。

然后来`eval`和`arguments`。[如您所知](https://stackoverflow.com/a/12391378/825789)，ECMAScript 规范需要执行一些[额外的](http://ecma-international.org/ecma-262/5.1/#sec-10.4.2) [操作](http://ecma-international.org/ecma-262/5.1/#sec-10.6)，以便可以使用这些语言结构（在 的情况下，操作因调用是否[直接](http://ecma-international.org/ecma-262/5.1/#sec-15.1.2.1.1)`eval`而异）。由于这些操作可能会对性能产生影响，因此（有些？）JavaScript 引擎会执行优化以避免使用或不使用它们。这些优化，加上对象的非标准属性的使用，似乎是导致你得到奇怪结果的原因。不幸的是，我不知道每个浏览器的实现细节，所以我不能给你一个确切的答案*为什么*`eval``arguments``Function`*我们看到了这些附带影响。*

 *^((*)顺便说一下，由[SO 用户](https://stackoverflow.com/users/96656/mathias-bynens)编写的规范。)

### 测试

我进行了一些测试以了解`eval`（直接和间接调用）如何在 IE、Firefox`arguments`和`fn.arguments`Chrome 上进行交互。每个浏览器的结果不同并不奇怪，因为我们正在处理非标准的`fn.arguments`.

第一个测试只是检查 和 的严格相等性`fn.arguments`，`arguments`以及是否存在`eval`以任何方式影响它。正如您在问题中所说，不可避免地，我的 Chrome 测试被 的存在所污染`arguments`，这会对结果产生影响。结果如下：

```
 |  no eval  |  direct eval call  |  indirect eval call
-----------------------+-----------+--------------------+---------------------
IE 9.0.8112.16421      |  true     |  true              |  true
FF 16.0.2              |  false    |  false             |  false
Chrome 22.0.1229.94    |  true     |  false             |  true 
```

你可以看到 IE 和 Firefox 更加一致：对象在 IE 上总是相等的，而在 Firefox 上永远不相等。然而，在 Chrome 中，它们只有在函数代码不包含直接`eval`调用时才相等。

其余测试是基于如下所示函数的分配测试：

```
function fn(x) {
    // Assignment to x, arguments[0] or fn.arguments[0]
    console.log(x, arguments[0], fn.arguments[0]);
    return; // make sure eval is not actually called
    // No eval, eval(""), or (1,eval)("")
} 
```

以下是每个测试浏览器的结果。

**互联网浏览器 9.0.8112.16421**

```
 | no eval                   | direct eval call          | indirect eval call
-----------------------------+---------------------------+---------------------------+--------------------------
arguments[0] = 'changed';    | changed, changed, changed | changed, changed, changed | changed, changed, changed
x = 'changed';               | changed, changed, changed | changed, changed, changed | changed, changed, changed
fn.arguments[0] = 'changed'; | changed, changed, changed | changed, changed, changed | changed, changed, changed 
```

首先，似乎我的 IE 测试给出的结果与问题中所述的不同；我总是在 IE 上得到“改变”。也许我们使用了不同的 IE 版本？无论如何，上面的结果表明IE是最一致的浏览器。正如在 IE`arguments === fn.arguments`上始终为真，`x`或`arguments[0]`都`function.arguments[0]`指向相同的值。如果您更改其中任何一个，所有三个都将输出相同的更改值。

**火狐 16.0.2**

```
 | no eval                      | direct eval call          | indirect eval call
-----------------------------+------------------------------+---------------------------+-----------------------------
arguments[0] = 'changed';    | changed, changed, original   | changed, changed, changed | changed, changed, original
x = 'changed';               | changed, changed, original   | changed, changed, changed | changed, changed, original
fn.arguments[0] = 'changed'; | original, original, original | changed, changed, changed | original, original, original 
```

Firefox 16.0.2 不太一致：虽然`arguments`从未*在* `=== fn.arguments`Firefox 上，`eval`但对分配有影响。没有直接调用`eval`，改变`arguments[0]`也会改变`x`，但不会改变`fn.arguments[0]`。更改`fn.arguments[0]`不会更改`x`或`arguments[0]`。`fn.arguments[0]`改变不会改变自己，这完全令人惊讶！

当`eval("")`被引入时，行为是不同的：改变一个`x`，`arguments[0]`或者`function.arguments[0]`开始影响另外两个。所以就像`arguments`变成了一样`=== function.arguments`——除了它没有，Firefox 仍然说`arguments === function.arguments`是`false`. 当使用间接`eval`调用时，Firefox 的行为就像没有`eval`.

**铬 22.0.1229.94**

```
 | no eval                    | direct eval call             | indirect eval call
-----------------------------+----------------------------+------------------------------+--------------------------
arguments[0] = 'changed';    | changed, changed, changed  | changed, changed, original   | changed, changed, changed
x = 'changed';               | changed, changed, changed  | changed, changed, original   | changed, changed, changed
fn.arguments[0] = 'changed'; | changed, changed, changed  | original, original, original | changed, changed, changed 
```

Chrome 的行为类似于 Firefox：当没有调用`eval`或间接`eval`调用时，它的行为是一致的。通过直接`eval`调用，和之间的联系`arguments`似乎`fn.arguments`中断了（这是有道理的，考虑到何时`arguments === fn.arguments`存在）。Chrome 还呈现了即使在分配之后仍然存在的奇怪情况，但它会在存在时发生（而在 Firefox 上，它会在没有或间接调用时发生）。`false``eval("")``fn.arguments[0]``original``eval("")``eval`

这是测试的完整代码，如果有人想运行它们。[jsfiddle](http://jsfiddle.net/ujzKq/)上还有一个实时版本。

```
function t1(x) {
    console.log("no eval: ", arguments === t1.arguments);
}
function t2(x) {
    console.log("direct eval call: ", arguments === t2.arguments);
    return;
    eval("");
}
function t3(x) {
    console.log("indirect eval call: ", arguments === t3.arguments);
    return;
    (1, eval)("");
}

// ------------

function t4(x) {
    arguments[0] = 'changed';
    console.log(x, arguments[0], t4.arguments[0]);
}

function t5(x) {
    x = 'changed';
    console.log(x, arguments[0], t5.arguments[0]);
}

function t6(x) {
    t6.arguments[0] = 'changed';
    console.log(x, arguments[0], t6.arguments[0]);
}

// ------------

function t7(x) {
    arguments[0] = 'changed';
    console.log(x, arguments[0], t7.arguments[0]);
    return;
    eval("");
}

function t8(x) {
    x = 'changed';
    console.log(x, arguments[0], t8.arguments[0]);
    return;
    eval("");
}

function t9(x) {
    t9.arguments[0] = 'changed';
    console.log(x, arguments[0], t9.arguments[0]);
    return;
    eval("");
}

// ------------

function t10(x) {
    arguments[0] = 'changed';
    console.log(x, arguments[0], t10.arguments[0]);
    return;
    (1, eval)("");
}

function t11(x) {
    x = 'changed';
    console.log(x, arguments[0], t11.arguments[0]);
    return;
    (1, eval)("");
}

function t12(x) {
    t12.arguments[0] = 'changed';
    console.log(x, arguments[0], t12.arguments[0]);
    return;
    (1, eval)("");
}

// ------------

console.log("--------------");
console.log("Equality tests");
console.log("--------------");
t1('original');
t2('original');
t3('original');

console.log("----------------");
console.log("Assignment tests");
console.log("----------------");
console.log('no eval');
t4('original');
t5('original');
t6('original');
console.log('direct call to eval');
t7('original');
t8('original');
t9('original');
console.log('indirect call to eval');
t10('original');
t11('original');
t12('original'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:36:33.673

只是在玩，我发现你`f.`从`f.arguments`数组中的值中删除了，然后使用`arguments`，无论后面是什么，行为都是一样的`return`：

```
function f(x) {
    return [x, change(arguments), x];
}
function g(x) {
    return [x, change(arguments), x];
    eval("");
}
function h(x) {
    return [x, change(arguments), x];
    arguments;
} 
```

在使用 的所有三种情况下`x = "original"`，输出为：

```
["original", " => ", "changed"]
["original", " => ", "changed"] 
["original", " => ", "changed"] 
```

在这种情况下，值的修改`change()`就像`arguments`数组通过引用传递一样。为了保持“原始”*不变*，我可能建议`arguments`先将对象转换为实际数组（从而通过*值*`arguments`传递' 元素）：

 *```
function h(x) {
    var argsByValue = Array.prototype.slice.call(arguments, 0);
    return [x, change(argsByValue), x];
} 
```

在上面的例子中，`x`在 之前和之后都将保持“原始” `change()`，因为修改的是副本，`x`而不是原始。

我仍然不确定拥有`eval("");`或是什么影响`arguments;`，但你的问题仍然很有趣，结果也是如此。

真正奇怪的是，这甚至会影响将`change()`函数参数的副本放入自己的函数范围

```
function f(x) {
    return ((function(args) {             
        return [x, change(args), x];
    })(f.arguments));
    // the presence of the line below still alters the behavior
    arguments; 
} 
```

在这种情况下，对的**引用**似乎`f.arguments`仍然成立。奇怪的东西。

**更新**

来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)：

> 该`arguments`对象是所有函数中可用的局部变量；**`arguments`作为 的属性`Function`不能再使用。**

似乎，至少对于 Firefox，您不应该将其`arguments`用作属性（例如`function foo() { var bar = foo.arguments; }`），尽管他们没有说明原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:33:08.187

这里有一些优秀的 Javascript 细微差别开始生效：

```
change(f.arguments)
change(x) 
```

前者将参数列表*作为参考*传递给 change() 。数组往往是 Javascript 中的引用。这意味着如果您在其他地方更改数组的元素，这些更改将应用​​到您使用*相同数组*的任何地方。

后者将参数 x*作为 value*传递。这就像交出一份副本 - 更改可以改变它，它只会影响局部变量。因为 x 是一个字符串，并且字符串是不可变的，所以 change() 函数中的 args[0] = "changed" 不会做任何事情。在控制台中尝试以下操作：

```
var x = "asdf";
x[0] = "foo";
console.log(x); // should print "asdf" 
```

在 f、h、g 函数中，arguments[0] 的值在返回列表的第二个索引中发生变化。第三个索引将返回“已更改”。

理论上。但是，某些浏览器编译 Javascript，这会导致某种竞争条件，并且指令可能不会按照您键入它们的顺序执行，特别是如果它们在同一行并且您正在更改堆栈并从同一行访问它。

```
return [x, change(f.arguments), x]; 
```

...尝试同时更改 arguments 变量并访问 x （这是一个参数）。例如，在 Chrome 中，将 f.arguments 传递给 change() 会导致 ["original", " => ", "original"]，而仅传递参数会导致 ["original", " => ", "changed"] . 这也可能是一个范围问题以及 Javascript 如何处理值和引用类型，但这种行为在不同浏览器中是不同的。

鉴于我所描述的，我没有看到 eval() 有任何奇怪的行为，但似乎在返回后在 h() 函数中声明参数会产生我怀疑是由 Chrome 的 Javascript 编译引起的副作用。真正有趣的是，在内部，shell 通过返回它的值来执行一个变量，但它并没有被写入任何地方，也许是缓存。很难说 Javascript 的堆栈中发生了什么，但你所做的肯定是非常规的，它肯定会在浏览器中弄乱编译器。

编辑：

更好的是：console.log(h.arguments); 返回[x，更改（参数），x]；论据

将记录

```
["changed"]
["original", " => ", "changed"] 
```

当然看起来像一个竞争条件，或者在函数中传递对参数数组的引用的一些不稳定！**

# java - Spring MVC 资源未映射

> ID：11939739
> 
> 赞同：1
> 
> 时间：2012-08-13T18:00:44.817
> 
> 标签：java, spring, spring-mvc

以下是我的 mvc-dispatcher.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/view/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

<mvc:annotation-driven />
<mvc:resources location="/static/" mapping="/static/**" />
<context:component-scan base-package="in.codejava.personal.controllers" />
</beans> 
```

我哪里错了？所有静态/* url 都由我创建的 404 控制器而不是静态资源映射。

WEB.XML

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
version="3.0">

<display-name>Personal Web Blogs</display-name>
<servlet>
    <servlet-name>mvc-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
</servlet>
<!--    <servlet-mapping> -->
<!--        <servlet-name>default</servlet-name> -->
<!--        <url-pattern>/static/*</url-pattern> -->
<!--    </servlet-mapping> -->
<servlet-mapping>
    <servlet-name>mvc-dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
</web-app> 
```

如果我删除评论部分，它可以正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T00:48:41.043

我要打个赌，假设您正在为您的 JS、CSS、图像资源使用传统的目录结构，如下所示：

*   `src/main/webapp/[js|css|images]`

在这种情况下，您`mvc:resources`应该如下所示：

```
<mvc:resources mapping="/static/**" location="/" /> 
```

你应该在你的 JSP 中引用它们，如下所示：`"${pageContext.request.contextPath}/static/js/foo.js"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-15T18:04:23.443

我只是在我的 web.xml 中添加了一个新的 servlet 映射 `<servlet-mapping> <servlet-name>default</servlet-name> <url-pattern>/resources/*</url-pattern> </servlet-mapping>`

然后参考我的html上的资源路径：

```
<link rel="stylesheet" href="resources/css/style.css" type="text/css" media="screen"> 
```

# datatable - Visualforce - 可点击的数据表单元格 - 如何获取列和行信息

> ID：11939740
> 
> 赞同：2
> 
> 时间：2012-08-13T18:00:45.253
> 
> 标签：datatable, click, visualforce

我想创建一个数据表，其中每个单元格都是可点击的。我假设我可以用它填充每个单元格，`apex:outputlink`并且负责处理可点击部分以及为每次点击调用我的控制器。我需要回答的一个大问题是如何将有关实际单击了哪个单元格（即：哪一行和哪一列）的信息传递给我的顶点控制器。

对此的任何帮助都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T08:36:47.307

这很简单。只需定义一个动作函数来捕获数据表中的值：

1）首先定义三个我们将传递给控制器​​的变量：raw-id，cell-value，cell-type

```
public String clickedRowId { get; set; } 
public String clickedCellValue { get; set; } 
public String clickedCellType { get; set; } 

public PageReference readCellMethod(){
    System.debug('#### clickedRowId: ' + clickedRowId);
    System.debug('#### clickedCellValue: ' + clickedCellValue);
    System.debug('#### clickedCellType: ' + clickedCellType);
    return null;
} 
```

2）其次我们创建一个动作函数，调用我们的顶点方法并向它传递三个变量：

```
<apex:actionFunction name="readCell" action="{!readCellMethod}">
    <apex:param name="P1" value="" assignTo="{!clickedRowId}"/>
    <apex:param name="P2" value="" assignTo="{!clickedCellValue}"/>
    <apex:param name="P3" value="" assignTo="{!clickedCellType}"/>
</apex:actionFunction> 
```

3）第三，我们创建我们的数据表，其中每个单元格都有 onClick 监听器：

```
<apex:pageBlockTable value="{!someArray}" var="item">

    <apex:column value="{!item.name}" onclick="readCell('{!item.id}','{!item.name}','name')" />
    <apex:column value="{!item.CustomField1__c}" onclick="readCell('{!item.id}','{!item.CustomField1__c}','custom1')" />
    <apex:column value="{!item.CustomField2__c}" onclick="readCell('{!item.id}','{!item.CustomField2__c}','custom2')" />

</apex:pageBlockTable> 
```

我们可以像访问任何其他 JavaScript 函数一样访问我们的 actionFunction。如果用户单击单元格 - 三个变量将被发送到 actionFunction，然后发送到控制器。

# c# - '.' 附近的语法不正确

> ID：11939748
> 
> 赞同：-3
> 
> 时间：2012-08-13T18:01:30.613
> 
> 标签：c#, sql, ado.net

我正在尝试运行控制台应用程序（连接并读取 SQL），但在“。”附近出现错误语法错误。

```
 static void Main(string[] args)
    {
        string connstring = @"Data Source=Jama-Dharma\SQLEXPRESS;Initial Catalog=Cars;Integrated Security=True";
        SqlConnection conn = new SqlConnection(connstring);

        using (conn)
        {
            string query = "SELECT c.Name, c.Model c.Year FROM CarsCatalog c";
            SqlCommand command = new SqlCommand(query, conn);

            conn.Open();
            SqlDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                Console.WriteLine(string.Format("{0} {1} {2}", reader.GetString(0), reader.GetString(1), reader.GetInt32(2)));
            }
            conn.Close();

        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:02:22.673

更改`c.Model c.Year`为`c.Model, c.Year`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:02:35.970

您在这里缺少一个逗号：

```
string query = "SELECT c.Name, c.Model, c.Year FROM CarsCatalog c"; 
```

（在 c.Model 之后）

# mysql - 在 mySQL 中的整个表中搜索字符串

> ID：11939751
> 
> 赞同：31
> 
> 时间：2012-08-13T18:01:40.620
> 
> 标签：mysql, sql, search

我正在尝试在 mySQL 中的整个表中搜索字符串。

我想搜索表的所有字段和所有条目，返回包含指定文本的每个完整条目。

我不知道如何轻松搜索多个字段；以下是详细信息：

该表是“客户”。它有大约 30 个字段和 800 个条目，在浏览器中一次显示太多了。我想搜索一个名字（即“Mary”），但它可能在`shipping_name field`或`billing_name field`或`email`字段等中。

我想在所有字段中搜索包含字符串“Mary”的任何条目。这是我认为应该工作但没有：

```
SELECT * FROM `clients` IN 'Mary' 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-13T18:11:53.703

尝试这样的事情：

```
SELECT * FROM clients WHERE CONCAT(field1, '', field2, '', fieldn) LIKE "%Mary%" 
```

您可能希望查看 SQL 文档以获取有关字符串运算符和正则表达式的更多信息。

编辑： NULL 字段可能存在一些问题，所以以防万一您可能想要使用`IFNULL(field_i, '')`而不是仅仅`field_i`

**区分大小写**：您可以使用不区分大小写的排序规则或类似的东西：

```
... WHERE LOWER(CONCAT(...)) LIKE LOWER("%Mary%") 
```

**只需搜索所有字段**：我相信没有办法在没有明确声明要搜索的字段的情况下进行搜索所有字段的 SQL 查询。原因是有关系数据库的理论和操作关系数据的严格规则（一些像关系代数或 codd 代数；这些是 SQL 的来源），并且理论不允许诸如“仅搜索所有字段”之类的事情。当然，实际行为取决于供应商的具体实现。但一般情况下是不可能的。为确保，请检查`SELECT`运算符语法（`WHERE`准确地说是节）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-13T18:11:59.867

确定可能与您的搜索相关的所有字段，然后使用如下查询：

```
SELECT * FROM clients
WHERE field1 LIKE '%Mary%'
   OR field2 LIKE '%Mary%'
   OR field3 LIKE '%Mary%'
   OR field4 LIKE '%Mary%'
   ....
   (do that for each field you want to check) 
```

使用`LIKE '%Mary%'`而不是`= 'Mary'`将查找包含 someCaracters + 'Mary' + someCaracters 的字段。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-02T13:52:41.090

除了使用“like”关键字进行[模式匹配之外。](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)您还可以使用以下[全文](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)功能执行搜索；

```
SELECT * FROM clients WHERE MATCH (shipping_name, billing_name, email) AGAINST ('mary') 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-05-21T14:25:08.660

如果您只是在寻找一些文本并且不需要用于编程目的的结果集，您可以免费[安装 HeidiSQL](http://www.heidisql.com/)（我使用的是 v9.2.0.4947）。

右键单击任何数据库或表，然后选择“在服务器上查找文本”。

所有匹配项都显示在每个表的单独选项卡中 - 非常好。

非常有用，为我节省了几个小时。忘记搞乱冗长的查询！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-08-13T04:46:24.063

用于搜索整个表格的基于 PHP 的解决方案！搜索字符串是 $string 。这是通用的，适用于具有任意数量字段的所有表

```
$sql="SELECT * from client_wireless";
$sql_query=mysql_query($sql);
$logicStr="WHERE ";
$count=mysql_num_fields($sql_query);
for($i=0 ; $i < mysql_num_fields($sql_query) ; $i++){
 if($i == ($count-1) )
$logicStr=$logicStr."".mysql_field_name($sql_query,$i)." LIKE '%".$string."%' ";
else
$logicStr=$logicStr."".mysql_field_name($sql_query,$i)." LIKE '%".$string."%' OR ";
}
// start the search in all the fields and when a match is found, go on printing it .
$sql="SELECT * from client_wireless ".$logicStr;
//echo $sql;
$query=mysql_query($sql); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-02T12:03:31.180

如果您使用的是 Sublime，您可以使用[Text Pastry](https://github.com/duydao/Text-Pastry#number-sequence)结合多行选择和[Emmet](https://github.com/sergeche/emmet-sublime)轻松生成数百或数千行。

所以在我的例子中，我将文档类型设置为 html，然后键入`div*249`，点击 tab，Emmet 创建了 249 个空 div。然后使用多项选择，我`col_id_`在每一项中输入并触发 Text Pastry 以插入增量 ID 号。然后再次进行多项选择，您可以删除`div`标记并将其替换为 MySQL 语法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-05T10:03:32.277

对于特定要求，以下将适用于搜索：

```
select * from table_name where (column_name1='%var1%' or column_name2='var2' or column_name='%var3%') and column_name='var'; 
```

如果您想从数据库中查询搜索数据，这将非常有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-11T07:51:58.380

试试这个代码，

```
SELECT 
       * 
FROM 
       `customers` 
WHERE 
       (
          CONVERT 
               (`customer_code` USING utf8mb4) LIKE '%Mary%' 
          OR 
          CONVERT(`customer_name` USING utf8mb4) LIKE '%Mary%' 
          OR 
          CONVERT(`email_id` USING utf8mb4) LIKE '%Mary%' 
          OR 
          CONVERT(`address1` USING utf8mb4) LIKE '%Mary%' 
          OR
          CONVERT(`report_sorting` USING utf8mb4) LIKE '%Mary%'
       ) 
```

这有助于解决您的问题 mysql 版本 5.7.21

# node.js - 如何安全地从 url 段构建路径？

> ID：11939758
> 
> 赞同：0
> 
> 时间：2012-08-13T18:02:31.533
> 
> 标签：node.js, express

我有以下代码：

```
app.get('/games/:id/log', function (req, res) {
    fs.readFile('logs/' + req.params.id +'.log', 'utf8', function (err, data) {
        res.send(data.split('\n').join('\<br />'));
    });
}); 
```

这允许访问`mysite.com/games/somename/log`服务`./logs/somename.log`。但是，我担心`req.params.id`最终可能会成为邪恶的东西`../..`，例如读取我不想被看到的文件。

这可能吗？如果是这样，我该如何解决这个安全问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:09:57.627

我会创建一个您允许在您的 id 中使用的字符的白名单。我的猜测是您的 id 只能是字母字符。因此，运行测试将允许您拒绝所有其他值。

```
var id = req.params.id.match(/[A-Z]+/i
    id = id[0] || null

if (id) {
  // read file `id`
} 
```

这将清理您的输入，只允许大写和小写字母字符。您还可以测试输入是否有有效字符，而不仅仅是清理它。

```
var reg = /^[A-Z]+$/i

if (reg.test(req.params.id)) {
  // read file `req.params.id`
} 
```

另请注意：您将永远无法获得`../..`的值`id`，因为它与您的路由不匹配。

您可以通过以下方式查看有关路由的更多信息`req.route`

您的路线示例是：

```
{ path: '/games/:id/log',
  method: 'get',
  callbacks: [ [Function] ],
  keys: [ { name: 'id', optional: false } ],
  regexp: /^\/games\/(?:([^\/]+?))\/log\/?$/i,
  params: [ id: 'asd' ] } [ id: 'asd' ]
} 
```

[http://expressjs.com/api.html#req.route](http://expressjs.com/api.html#req.route)

# php - 各种公共网站之间的 SSO 架构是什么？

> ID：11939759
> 
> 赞同：3
> 
> 时间：2012-08-13T18:02:34.980
> 
> 标签：php, architecture, single-sign-on

我正在创建三个网站，理论上，每个用户都应该拥有相同的帐户。尽管具有不同的属性，但用户电子邮件、登录名、密码等由单个网站（如 user.mysso.com）存储和处理。

我是否应该使用 user.mysso.com 上的 RESTful Web 服务来提供查询/身份验证用户的界面？或者这是不安全的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:03:45.587

否。在这种情况下，使用正确的工具执行[目录服务任务。](http://en.wikipedia.org/wiki/Directory_service)

在你的鞋子里，我可能使用[OpenLDAP](http://www.openldap.org/)和[Authenticating user using LDAP from PHP](https://stackoverflow.com/questions/546438/authenticating-user-using-ldap-from-php)

# jquery - 使用 MVC 和 JQuery 动态且一致地向表中添加值

> ID：11939761
> 
> 赞同：1
> 
> 时间：2012-08-13T18:02:44.987
> 
> 标签：jquery, asp.net-mvc-3

我有一个可以有多个值的表单。

例如：

> 请列出您的家属。

我有一个包含我的三个字段的字段集

*   名，
*   姓，
*   出生日期

以及添加按钮。

我的添加按钮触发 jQuery ajax 请求，成功后将表格行添加到表格中

伪代码：

```
$.ajax({
    url: myUrl,
    data: myData,
    success: function(){
        var row = $("<tr id='...'>");
        row.append("<td>").text(txtFirstName.val());
        row.append("<td>").text(txtLastName.val());
        row.append("<td>").text(dteDateOfBirth.val());
        row.appendTo($("#myDependantsTable"));
    }
    ...
}); 
```

这很好用。但是，现在我在两个不同的地方定义了我的 HTML，我的 javascript 和我的视图

IE：

```
<tr>
    <td>@Model.FirstName</td>
    <td>@Model.LastName</td>
    <td>@Model.DateOfBirth</td>
</tr> 
```

当我开始修改这些时，就会出现一个问题，例如在日期列上添加一个类，我需要修改两次代码。

反正有这个问题吗？

我想：

*   无需回发即可添加“ajaxy”的行
*   一致的布局，我只需要在一个地方进行更改

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:05:16.063

您可以让通过 AJAX 请求调用的控制器操作返回包含行的部分视图。生成表格时使用的相同部分。因此，无需使用 javascript 操作 HTML，只需将返回的部分附加到表中：

```
$.ajax({
    url: myUrl,
    data: { 
        // That's to bind to the view model that the controller
        // action you are invoking with the AJAX request takes
        // as parameter
        firstName: txtFirstName.val(), 
        lastName: txtLastName.val(), 
        dob: dteDateOfBirth.val() 
    }
    success: function(result) {
        $("#myDependantsTable").append(result);
    }
    ...
}); 
```

并在您的标记中：

```
<table id="myDependantsTable">
    @foreach(var item in Model)
    {
        @Html.Partial("_Row", item)
    }
</table> 
```

现在您的控制器操作将返回相同的部分：

```
public ActionResult SomeActionInvokedWithAjax(MyViewModel model)
{
    return PartialView("_Row", model);
} 
```

# xslt - 在 XSL 中从 XSD 中提取数据

> ID：11939765
> 
> 赞同：4
> 
> 时间：2012-08-13T18:03:04.310
> 
> 标签：xslt, xsd

我正在转换一个 XML 文件，该文件需要根据 XSD 中定义的有效枚举选项生成一些元素。

假设我有一个 XSD，它声明了一个类型和一个元素，如下所示：

```
<xs:simpleType name="optionType" nillable="true">
    <xs:restriction base="xs:string">
        <xs:maxLength value="50"/>
        <xs:enumeration value="USERCHOICE">
        </xs:enumeration>
        <xs:enumeration value="DEFAULT">
        </xs:enumeration>
        </xs:restriction>
</xs:simpleType>
...
<xs:element name="chosenOption" type='optionType'/>
...
<xs:element name="availableOption" type='optionType'/> 
```

输入将仅包含所选选项，因此您可以想象它看起来像这样：

```
<options>
     <chosenOption>USERCHOICE</chosenOption>
</options> 
```

我需要一个如下所示的输出：

```
<options>
    <chosenOption>USERCHOICE</chosenOption> <!-- This comes from incoming XML -->

    <!-- This must be a list of ALL possible values for this element, as defined in XSD -->
    <availableOptions>
        <availableOption>USERCHOICE</availableOption>
        <availableOption>DEFAULT</availableOption>
    </availableOptions>
</options> 
```

有没有办法让 XSL从 XSD 中提取枚举值`USERCHOICE`并在输出中生成它们？`DEFAULT`

这将在 WebSphere 6 上运行，并将由 XSLT 1.0 引擎使用。:(

（模式文件不会经常更改，但它*会*不时更改，我宁愿只需要更新模式文件而不是更新模式文件和 XSLT）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:45:16.373

这是一个原型，假设您的输入 XML 和 XSD 与上面的示例一样简单。根据它们可能变化的方式进行调整。如果您需要有关调整的帮助，请告诉我。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:xs="http://www.w3.org/2001/XMLSchema"
   exclude-result-prefixes="xs"
   version="1.0">

   <xsl:variable name="xsd" select="document('mySchema.xsd')"/>

   <xsl:template match="/options">
      <xsl:copy>
         <xsl:for-each select="*">
            <xsl:variable name="eltName" select="local-name()"/>
            <xsl:copy-of select="." />
            <availableOptions>
               <xsl:variable name="optionType"
                  select="$xsd//xs:element[@name = $eltName]/@type"/>
               <xsl:apply-templates
                  select="$xsd//xs:simpleType[@name = $optionType]/
                       xs:restriction/xs:enumeration"/>
            </availableOptions>
         </xsl:for-each>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="xs:enumeration">
      <availableOption><xsl:value-of select="@value" /></availableOption>
   </xsl:template>
</xsl:stylesheet> 
```

# php - PHP preg_replace 与逻辑？

> ID：11939767
> 
> 赞同：0
> 
> 时间：2012-08-13T18:03:17.710
> 
> 标签：php, regex, string

如果我想将所有数字乘以 2 怎么办？这可以通过正则表达式替换来完成吗？请注意`$1*2`显然不起作用的部分。我该怎么做？

```
$foo = "soup 12 cake 23 pants";
$bar = preg_replace('~(\d+)~', $1*2, $foo); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:07:54.017

你可以使用[`preg_replace_callback`](http://php.net/preg_replace_callback)：

```
preg_replace_callback('~(\d%)~', function($match) { return $match[1]*2; }, $foo); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:08:13.377

尝试使用 preg_replace_callback(...) 函数

```
<?php

function mulBy2($match) {
    return $match[1] * 2;
}

$foo = "soup 12 cake 23 pants";
$bar = preg_replace_callback('~(\d+)~', "mulBy2", $foo);

echo $bar;

?> 
```

# ruby-on-rails - Ruby on Rails 虚拟主机控制面板/服务器管理

> ID：11939768
> 
> 赞同：8
> 
> 时间：2012-08-13T18:03:21.417
> 
> 标签：ruby-on-rails, controls, panel, cpanel

我们将为 Ruby on Rails 托管大约 20 个客户端站点。我们的服务器/VPS 需要最好的控制面板，您有什么建议？我进行了研究，但找不到关于这个确切主题的好的博客或帖子。

我的一些发现：

1) Cpanel 看起来不太好，因为它不支持 Rails 3.2.8

2) SSH 手动配置管理就足够了吗？有些人告诉我，这就是人们对 capistrano 所做的事情。但是您如何控制带宽、CPU 使用率等资源呢？

3) 将来我们希望提供免费试用注册，自动创建帐户并安装我们的应用程序。

理想的解决方案类似于 cpanel，但允许 Rails 3.2.8 与 Apache/Passenger 一起运行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T20:00:34.947

我认为许多 Rails 公司在 Rails 中构建了自己的控制面板。如果你在一个 VPS 上，这应该很容易。（如果您有多个 VPS，它仍然可行，但您的控制面板应用程序必须通过 SSH 完成所有操作，可能使用 Capistrano。）

在您的控制面板 Rails 应用程序中，您可以创建一些知道如何执行各种服务器管理任务的模型。例如，如果您使用 Apache，您的模型之一可能必须知道如何编辑`http.conf`才能添加新的虚拟主机。

您关于在注册时自动创建应用程序的想法也可以通过这种方式完成。编写一些模型逻辑，从源代码控制中检查应用程序，创建虚拟主机或其他任何东西，创建数据库（如果每个客户端都有自己的）等等。

还可以考虑将一些任务推送到作业队列中，而不是同步处理它们。[（我是resque](https://github.com/defunkt/resque)的忠实粉丝）。对于需要很长时间的任务，例如从源代码管理中签出，这是一个好主意。

您甚至可能希望将所有这些服务器管理功能提取到一个 gem 中供您私人使用。然后，如果需要，您可以轻松地从 Rails 应用程序外部的自定义脚本执行相同的任务。

# javascript - 在 Javascript 中使用一次（不是两次）分隔符来拆分字符串

> ID：11939770
> 
> 赞同：6
> 
> 时间：2012-08-13T18:03:26.597
> 
> 标签：javascript, regex, split

用一个例子可以更好地解释这一点。我想实现这样的拆分：

`two-separate-tokens-this--is--just--one--token-another`

->

`["two", "separate", "tokens", "this--is--just--one--token", "another"]`

我天真地尝试过`str.split(/-(?!-)/)`，它不会匹配第一次出现的双定界符，但它会匹配第二次（因为它后面没有定界符）：

`["two", "separate", "tokens", "this-", "is-", "just-", "one-", "token", "another"]`

我有比遍历字符串更好的选择吗？

顺便说一句，下一步应该将两个连续的分隔符替换为一个，所以它通过重复来逃避分隔符......所以最终结果将是这样的：

`["two", "separate", "tokens", "this-is-just-one-token", "another"]`

如果这一步可以实现，那应该是非常棒的！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T18:13:36.567

~~`str.match(/(?!-)(.*?[^\-])(?=(?:-(?!-)|$))/g);`~~

~~检查[这个](http://jsfiddle.net/yMjTF/)小提琴。~~

* * *

~~*解释：*~~

~~非贪婪模式`(?!-)(.*?[^\-])`匹配不以破折号字符开头和结尾的字符串，并且模式`(?=(?:-(?!-)|$))`要求此类匹配后跟单个破折号字符或行尾。修饰符`/g`强制函数`match`查找所有事件，而不仅仅是单个（第一个）事件。~~

* * *

***编辑*** *（基于OP的评论）：*

`str.match(/(?:[^\-]|--)+/g);`

检查[这个](http://jsfiddle.net/jxCWR/)小提琴。

*解释：*

模式`(?:[^\-]|--)`将匹配非破折号字符或双破折号字符串。Sign`+`表示，与先前模式的这种匹配应该尽可能多地相乘。修饰符`/g`强制函数`match`查找所有事件，而不仅仅是单个（第一个）事件。

*笔记：*

*Pattern* `/(?:[^-]|--)+/g` *也适用于 Javascript，但 JSLint 需要`-`在方括号内转义，否则会出现错误。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:08:14.847

你需要一个否定的lookbehind断言以及你的否定lookahead：

```
(?<!-)-(?!-) 
```

[http://regexr.com?31qrn](http://regexr.com?31qrn)

不幸的是，javascript 正则表达式解析器不支持否定的lookbehinds，我相信唯一的解决方法是事后检查您的结果并删除任何可能导致lookbehind 断言失败的匹配项（或者在这种情况下，将它们组合回一个匹配项）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T19:05:16.510

@Ωmega 在使用`match`instead of方面有正确的想法`split`，但他的正则表达式比它需要的更复杂。试试这个：

```
s.match(/[^-]+(?:--[^-]+)*/g); 
```

它的读取方式完全符合您的预期：使用一个或多个非连字符，如果遇到双连字符，请使用它并继续使用非连字符。根据需要重复。

* * *

**编辑：**显然源字符串可能包含两个*或多个*连续连字符的运行，不应将其视为分隔符。这可以通过将 a 添加`+`到第二个连字符来处理：

```
s.match(/[^-]+(?:--+[^-]+)*/g); 
```

您还可以使用`{min,max}`量词：

```
s.match(/[^-]+(?:-{2,}[^-]+)*/g); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:12:06.563

我不知道如何纯粹使用 JS 中的正则表达式引擎来做到这一点。你可以这样做，比手动解析少一点涉及：

```
var str = "two-separate-tokens-this--is--just--one--token-another";
str = str.replace(/--/g, "#!!#");
var split = str.split(/-/);
for (var i = 0; i < split.length; i++) {
    split[i] = split[i].replace(/#!!#/g, "--");
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/hAhAB/](http://jsfiddle.net/jfriend00/hAhAB/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T18:16:58.817

[您可以像这样（受本文启发）这样（受本文](http://blog.stevenlevithan.com/archives/mimic-lookbehind-javascript)启发），在没有负面后视的情况下实现这一点（正如@jbabey 提到的，这些在 JS 中不受支持）：

```
\b-\b 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T08:57:58.723

鉴于正则表达式在边缘情况下不是很好（比如 5 个连续的定界符），我不得不处理用单个定界符替换双定界符（然后它会变得很棘手，因为`'----'.replace('--', '-')`给`'---'`而不是`'--'`）我写了一个函数循环遍历字符并一次性完成所有操作（尽管我担心使用字符串累加器可能会很慢:-s）

```
f = function(id, delim) {
    var result = [];
    var acc = '';
    var i = 0;
    while(i < id.length) {
        if (id[i] == delim) {
            if (id[i+1] == delim) {
                acc += delim;
                i++;
            } else {
                result.push(acc);
                acc = '';
            }
        } else {
            acc += id[i];
        }
        i++;
    }

    if (acc != '') {
        result.push(acc);
    }

    return result;
    } 
```

和一些测试：

```
> f('a-b--', '-')
["a", "b-"]
> f('a-b---', '-')
["a", "b-"]
> f('a-b---c', '-')
["a", "b-", "c"]
> f('a-b----c', '-')
["a", "b--c"]
> f('a-b----c-', '-')
["a", "b--c"]
> f('a-b----c-d', '-')
["a", "b--c", "d"]
> f('a-b-----c-d', '-')
["a", "b--", "c", "d"] 
```

（如果最后一个标记为空，则意味着跳过）

# ios - 为 UIButton 添加目标 - iOS

> ID：11939772
> 
> 赞同：14
> 
> 时间：2012-08-13T18:03:37.877
> 
> 标签：ios, uibutton

任何人都可以帮助我如何添加操作以使用`UIButton`.

```
-(void)navigatePics:(id)sender andIndex:(NSInteger *)index{} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-13T18:07:17.130

使用 button.setTag:(NSInteger) 方法将索引作为标签添加到 UIButton。

```
UIButton *button = ...;
[button setTag:1234];
[button addTarget:self action:@selector(navigatePics:) forControlEvents:UIControlEventTouchUpInside]; 
```

然后在 navigatePics 中读取标签。

```
-(void)navigatePics:(UIButton *)sender
{
 int index = sender.tag;
 // index = 1234;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:10:18.883

```
UIButton *button = [[UIButton alloc] init];
button.tag = 4; //index
[button addTarget:self @selected(buttonDidTap:)];

...
[button release];

-(void)buttonDidTap:(UIButton *)sender{
NSInteger index = sender.tag;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:08:56.700

这应该可以解决问题。如果您想在另一个实例上调用此方法，请不要使用 self。在这种情况下，只需使用该实例代替 self。

```
[button addTarget:self action:@selector(navigatePics:andIndex:) forControlEvents:UIControlEventTouchUpInside]; 
```

# iphone - 具有 NSOperationQueueDefaultMaxConcurrentOperationCount 的线程数

> ID：11939773
> 
> 赞同：2
> 
> 时间：2012-08-13T18:03:43.840
> 
> 标签：iphone, multithreading, macos, concurrency

在给定 NSOperationQueueDefaultMaxConcurrentOperationCount 最大并发设置的情况下，我正在寻找与创建 NSOperationQueue 的后台线程数相关的任何具体信息。

我曾假设采用某种负载监控来确定最合适的线程数，此外文档中建议使用此设置。我发现队列产生了大约 100 个后台线程，并且我的应用程序（在带有 iOS 5.1.1 的 iPad 3 上运行）与 SIGABRT 一起崩溃。我已将其减少到更可接受的数字，例如 3，并且一切正常。

任何意见或见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:50:02.593

我的经验与您的相匹配（尽管不是 100 个线程；请进行一些检测以确保您确实同时运行了这么多线程。我从未见过它如此之高）。除非你手动管理并发操作的数量，`NSOperationQueue`否则往往会产生过多的并发操作。（我还没有看到有人用可测试的代码而不是文档中的推论来反驳这一点。）对于可能产生大量潜在并发操作的任何事情，我建议使用`setMaxConcurrentOperations`. 虽然不理想，但我经常使用类似这样的功能来辅助（这当然不能帮助您在队列之间取得平衡，因此非常不理想）：

```
unsigned int countOfCores() {
  unsigned int ncpu;
  size_t len = sizeof(ncpu);
  sysctlbyname("hw.ncpu", &ncpu, &len, NULL, 0);

  return ncpu;
} 
```

我热切地等待任何人发布真实代码来演示`NSOperationQueue`自动为 CPU 绑定操作执行正确的负载平衡。我发布了一个[示例要点](https://gist.github.com/3343133)，展示了我在说什么。如果不调用`setMaxConcurrentOperations:`，它将在 2 核 iPad 3 上生成大约 6 个并行进程。在这个没有争用或共享资源的非常简单的情况下，这会增加大约 10%-15% 的开销。在具有争用的更复杂的代码中（尤其是在操作可能被取消的情况下），它可以使事情变慢一个数量级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:40:42.173

假设您的线程忙于工作，那么双核 iPad 上的一个进程中有 100 个活动线程是不合理的。每个线程都会消耗大量的时间和内存。拥有这么多繁忙的线程会减慢双核的速度。

无论您是否在做一些愚蠢的事情（比如让他们全部睡觉或添加运行循环或只是让他们无事可做），这将是一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:14:23.687

从文档中：

> 默认的最大操作数由 NSOperationQueue 对象根据当前系统条件动态确定。

iPad 3 拥有强大的处理器和 1Gb 的内存。由于 NSOperationQueue 是根据系统条件来计算线程的数量，所以很有可能它根据该设备上可用的功率确定能够运行大量的 NSOperation。它崩溃的原因可能与同时运行的线程数量无关，而与在这些线程中执行的代码有关。检查回溯并查看这些踏板之间是否共享某些条件或资源。

# php - SimpleXML 检查 SimpleXML 对象是否存在

> ID：11939774
> 
> 赞同：1
> 
> 时间：2012-08-13T18:03:51.980
> 
> 标签：php, xml, simplexml

我正在使用 if 语句来检查 XML 对象是否存在，但我得到的效果并不好`trying to get property of non-object error`

下面是代码

```
foreach($resp->GetLowestOfferListingsForASINResult as $product){
   $isbn = "";
   $price = "";
   $condition = "";

   if($product->Product->Identifiers->MarketplaceASIN->ASIN){
      $isbn = (string) $product->Product->Identifiers->MarketplaceASIN->ASIN;
   }

   if($product->Product->LowestOfferListings->LowestOfferListing->Price->LandedPrice->Amount){
      $price = (float) $product->Product->LowestOfferListings->LowestOfferListing->Price->LandedPrice->Amount;
   }

   if($product->Product->LowestOfferListings->LowestOfferListing->Qualifiers->ItemSubcondition){
      $condition = (string) $product->Product->LowestOfferListings->LowestOfferListing->Qualifiers->ItemSubcondition;
   }
} 
```

我试过使用

```
if(!property_exists($product, 'Amount')){
   $price = (float) $product->Product->LowestOfferListings->LowestOfferListing->Price->LandedPrice->Amount;
} 
```

但这不起作用，我应该使用什么

**xml 返回结果（如果价格存在）**

```
<?xml version="1.0"?>
<GetLowestOfferListingsForASINResponse xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01">
<GetLowestOfferListingsForASINResult ASIN="000726965X" status="Success">
  <AllOfferListingsConsidered>true</AllOfferListingsConsidered>
  <Product xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01" xmlns:ns2="http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd">
    <Identifiers>
      <MarketplaceASIN>
        <MarketplaceId>A1F83G8C2ARO7P</MarketplaceId>
        <ASIN>000726965X</ASIN>
      </MarketplaceASIN>
    </Identifiers>
    <LowestOfferListings>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Mint</ItemSubcondition>
          <FulfillmentChannel>Amazon</FulfillmentChannel>
          <ShipsDomestically>True</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>95-97%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>500720</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>12.65</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>12.65</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>0.00</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Acceptable</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>True</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>95-97%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>73208</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>15.41</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>12.61</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Mint</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>True</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>98-100%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>2125</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>22.80</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>20.00</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Mint</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>True</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>90-94%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>68301</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>23.14</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>20.34</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Mint</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>False</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>90-94%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>2</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>4114</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>25.39</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>22.59</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>Mint</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>True</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>95-97%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>34661</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>29.20</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>26.40</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
      <LowestOfferListing>
        <Qualifiers>
          <ItemCondition>Used</ItemCondition>
          <ItemSubcondition>VeryGood</ItemSubcondition>
          <FulfillmentChannel>Merchant</FulfillmentChannel>
          <ShipsDomestically>False</ShipsDomestically>
          <ShippingTime>
            <Max>0-2 days</Max>
          </ShippingTime>
          <SellerPositiveFeedbackRating>95-97%</SellerPositiveFeedbackRating>
        </Qualifiers>
        <NumberOfOfferListingsConsidered>1</NumberOfOfferListingsConsidered>
        <SellerFeedbackCount>49504</SellerFeedbackCount>
        <Price>
          <LandedPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>33.16</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>30.36</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>GBP</CurrencyCode>
            <Amount>2.80</Amount>
          </Shipping>
        </Price>
        <MultipleOffersAtLowestPrice>False</MultipleOffersAtLowestPrice>
      </LowestOfferListing>
    </LowestOfferListings>
  </Product>
</GetLowestOfferListingsForASINResult>
<ResponseMetadata>
  <RequestId>09a1deae-94ec-4661-95ae-49567ab00eb8</RequestId>
</ResponseMetadata>
</GetLowestOfferListingsForASINResponse> 
```

**xml 返回结果（如果价格不存在）**

```
<?xml version="1.0"?>
<GetLowestOfferListingsForASINResponse xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01">
<GetLowestOfferListingsForASINResult ASIN="0957143826" status="Success">
  <AllOfferListingsConsidered>true</AllOfferListingsConsidered>
  <Product xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01" xmlns:ns2="http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd">
    <Identifiers>
      <MarketplaceASIN>
        <MarketplaceId>A1F83G8C2ARO7P</MarketplaceId>
        <ASIN>0957143826</ASIN>
      </MarketplaceASIN>
    </Identifiers>
    <LowestOfferListings/>
  </Product>
</GetLowestOfferListingsForASINResult>
<ResponseMetadata>
  <RequestId>13918cb9-69e5-4445-ad24-70f6fda06f19</RequestId>
</ResponseMetadata>
</GetLowestOfferListingsForASINResponse> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T22:24:51.957

您的问题是您对运营商链的测试太远了`->`：

```
if ( $product->Product->LowestOfferListings->LowestOfferListing->Price->LandedPrice->Amount ) 
```

为了测试这一点，PHP 必须`->`依次评估每个运算符

1.  `$product->Product`[好的]
2.  `$product->Product->LowestOfferListings`[好的]
3.  `$product->Product->LowestOfferListings->LowestOfferListing`[如果没有价格则为空集]
4.  `$product->Product->LowestOfferListings->LowestOfferListing->Price`[不明确的]
5.  在这之后，你已经太迟了。

此外，即使 SimpleXML 对象是一个空列表，它也不会评估为`false`，因此您确实需要使用`isset`. 为了发现无价情况，您因此需要：

```
if ( isset($product->Product->LowestOfferListings->LowestOfferListing) ) 
```

[注意：我还没有实际测试过上述内容，所以我可能在某些特定方面出错了，但我很确定这是你的基本问题。]

# sql - SQL 字符串解析，然后按日期块排序和排序

> ID：11939776
> 
> 赞同：0
> 
> 时间：2012-08-13T18:03:53.493
> 
> 标签：sql, tsql, sql-server-2008-r2

这听起来像是我大学时应该参加的考试的问题，但我向你保证，这是我正在努力解决的现实世界问题……而且我并不是真正的 SQL 专家。

假设我销售相机（虚构），每台相机都有自己唯一的序列号，格式为 [prefix]-[number]。当我们更改固件或放入新的计算机芯片时，我们会更改前缀。相机有 3 年的 MFG 保修期，所以我们试图给我们的经销商一个序列号，说“任何序列号低于 J05 的相机-123456 可能太旧了，发回去吧”

问题是，我们按顺序生产相机，但是我们仓库的货架上会放 50 台相机，运输人员会随机拿一个并发货，所以它们是半顺序销售的，但是可以大型异常值，其中几个单位被搁置数月然后出售。

大约有 1000 万部连续剧。有什么好方法可以做到这一点？

```
序列号 | 发售日期
J22-521253 | 2012 年 7 月 2 日
J22-521254 | 2012 年 6 月 28 日
J22-521255 | 2012 年 6 月 28 日
J22-521256 | 2012 年 7 月 1 日
J22-521257 | 2012 年 6 月 22 日
J22-521258 | 2012 年 7 月 4 日
J22-521259 | 2012 年 7 月 1 日
J22-521260 | 2012 年 6 月 27 日
J22-521261 | 2012 年 6 月 25 日
J22-521262 | 2012 年 6 月 20 日
J22-521263 | 2012 年 8 月 30 日
J22-521264 | 2012 年 6 月 30 日
J22-521265 | 2012 年 6 月 30 日
Y7-542127 | 2012 年 5 月 1 日
Y7-542128 | 2012 年 4 月 18 日
Y7-542129 | 2012 年 4 月 22 日
Y7-542130 | 2012 年 1 月 10 日

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:13:28.730

我将问题解释为您希望每个前缀的最早序列号仍在保修期内。任何旧的东西都太旧了。

如果不是这种情况，请澄清问题。

```
select prefix, salesdate, serial
from (select left(serial, 3) as prefix,
             row_number() over (partition by prefix order by salesdate) as seqnum
      from (select t.*, left(serial, 3) as prefix
            from t
            where datediff(days, salesdate, CURRENT_TIMESTAMP) < 3*365.25
           ) t
    ) t 
```

这使用 row_number() 查找仍在保修期内的最早序列号。

# sql - 关键字“rowcount”附近的语法不正确

> ID：11939779
> 
> 赞同：1
> 
> 时间：2012-08-13T18:04:14.940
> 
> 标签：sql, sql-server-2008, tsql

我有这个代码：

```
merge dbo.tblProblems as target 
using ( 
    select max(problemID), StationName, problemCode, max(ProblemCreateDate), count(*) 
    from dbo.tblProblems 
    group by StationName, problemCode 
) as source(id, StationName, problemCode, maxdate, rowcount) 
on ( 
        target.problemID = source.problemID 
    and target.StationName = target.StationName 
    and target.problemCode = target.problemCode 
) 
when matched then 
    update set ProblemCreateDate = maxdate, probCount = rowcount 
when not matched then delete ; 
```

但它会产生这个错误：

> 消息 156，级别 15，状态 1，第 6 行
> 关键字“行计数”附近的语法不正确。

而这个版本的查询：

```
;WITH n AS  
( 
  SELECT problemID, StationName, problemCode, ProblemCreateDate, probCount 
    c = COUNT(*) OVER (PARTITION BY StationName, problemCode), 
    rn = ROW_NUMBER() OVER  
    ( 
      PARTITION BY StationName, problemCode ORDER BY ProblemCreateDate DESC, problemID DESC 
    ) 
  FROM dbo.tblProblems
) 
 --SELECT problemID, StationName, problemCode, ProblemCreateDate, c 
 -- FROM n WHERE rn = 1; 
UPDATE n SET probCount = c 
  WHERE rn = 1; 
```

产生此错误：

> 消息 102，级别 15，状态 1，第 4 行
> '=' 附近的语法不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:06:28.187

对于第一个查询，`rowcount`是一个[保留关键字](http://msdn.microsoft.com/en-us/library/ms189822(v=sql.100).aspx)。使用不同的词（例如`row_count`）或将其括在方括号中：

```
[rowcount] 
```

对于第二个查询，您需要一个逗号之后`probCount`：

```
SELECT problemID, StationName, problemCode, ProblemCreateDate, probCount,
------------------------------------------------------------------------^
  c = COUNT(*) OVER (PARTITION BY StationName, problemCode), 
```

您没有完全正确地调整[我的代码示例](https://stackoverflow.com/a/11927077/61305)（尾随逗号在那里）。

# c# - 无法将 UserQuery 枚举转换为枚举

> ID：11939780
> 
> 赞同：0
> 
> 时间：2012-08-13T18:04:24.300
> 
> 标签：c#, .net, linq

我正在尝试执行下面的代码（在 LINQPad 中），但我的 LINQ 语句出现错误

> 无法将类型隐式转换`System.Collections.Generic.IEnumerable<UserQuery.ResultCode>`为`UserQuery.ResultCode`.

为什么？

这是代码：

```
public enum ResultCode {
    Big,
    Bad,
    Messy
}

public class ValidationResult {
    public bool IsValid = false;
    public ResultCode Code;

    public override string ToString(){
        return String.Format("IsValid: {0}, Code: {1}",IsValid, Code);
    }
}

public class RuleMap {
    public Func<bool> Fact;
    public ResultCode Code;
    public List<int> Actions;
}

public class RulesProcessor{

    List<RuleMap> rules;

    public RulesProcessor(){
        rules = new List<RuleMap>{
            new RuleMap {Fact = CheckLeft, Code = ResultCode.Big,
                Actions = new List<int> {2, 3}
            },
            new RuleMap {Fact = CheckRight, Code = ResultCode.Bad,
                Actions = new List<int> {1, 2}
            },
            new RuleMap {Fact = CheckDown, Code = ResultCode.Messy,
                Actions = new List<int> {1, 3}
            },
        };
    }

    public bool CheckLeft(){
        return true;
    }

    public bool CheckRight(){
        return false;
    }

    public bool CheckDown(){
        return true;
    }

    public ValidationResult EvaluateRulesOnAction(int actionType){

        ValidationResult result = new ValidationResult();

        ResultCode badRule = from foo in rules
                                where !foo.Fact() && foo.Actions.Contains(actionType)
                                select foo.Code;

        if (badRule != null){
            result.Code = badRule;
        }else{
            result.IsValid = true;
        }

        return result;
    }

}

void Main()
{
    var foo = new RulesProcessor();

    foo.EvaluateRulesOnAction(1).Dump();
    foo.EvaluateRulesOnAction(3).Dump();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:07:12.693

如何将查询更改为。

```
 IEnumerable<ResultCode> badRule = from foo in rules
                            where !foo.Fact() && foo.Actions.Contains(actionType)
                            select foo.Code; 
```

并将 ValidationResult 更改为

```
 public IEnumerable<ResultCode> Code; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:07:44.550

原因是表单的每个 LINQ 查询都`from x in y select x`返回一个`IEnumerable<TypeOfX>`.

如果您确定最多可以有一个错误规则，则可以将代码更改为：

```
ResultCode badRule = (from foo in rules 
                      where !foo.Fact() && foo.Actions.Contains(actionType) 
                      select foo.Code).SingleOrDefault(); 
```

如果可能有多个错误规则，但您只对第一个感兴趣，请使用：

```
ResultCode badRule = (from foo in rules 
                      where !foo.Fact() && foo.Actions.Contains(actionType) 
                      select foo.Code).FirstOrDefault(); 
```

两个查询中的“OrDefault”表示您希望获得返回类型的[默认值](http://msdn.microsoft.com/en-us/library/xwth0h0d.aspx)。对于引用类型，这是`null`.

但是，在您的代码中，查询返回一个 enum 类型`ResultCode`。枚举不能`null`，所以`if`查询之后的 永远不会像`badRule == null`往常一样产生预期的结果`false`。

您应该将代码更改为：

```
var badRule = (from foo in rules 
               where !foo.Fact() && foo.Actions.Contains(actionType) 
               select foo).FirstOrDefault(); 

if (badRule != null){
    result.Code = badRule.Code;
}else{
    result.IsValid = true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:08:04.157

你读过错误吗？

您的 LINQ 查询返回 ResultCodes 的集合 (IEnumerable)，而不是单个 ResultCode。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:08:06.240

因为这：

```
ResultCode badRule = from foo in rules
                     where !foo.Fact() && foo.Actions.Contains(actionType)
                     select foo.Code; 
```

返回 ResultCodes 的集合，您尝试将其分配给单个 ResultCode 变量。

如果您知道只有一个结果，那么您可以使用 First 选择它并将其分配给 badRule。如果可能有 1 或 0 个结果，则为 FirstOrDefault。

# c - Visual Studio 找不到某些 C 库，例如 stropts.h

> ID：11939783
> 
> 赞同：1
> 
> 时间：2012-08-13T18:04:35.900
> 
> 标签：c, visual-studio-2010

我正在尝试编译一个给我的示例 c 文件，但不幸的是，它缺少几个库，因为某些包含文件找不到它们。即：stropts.h、netdb.h、sys/socket.h、sys/ioctl.h、netinet/in.h、pthread.h、unistd.h。

我研究了哪里可以解决这些问题，但奇怪的是，这个问题几乎没有结果。在我找到这些库之前，Visual Studio 命令提示符无法编译它。我需要下载/链接来解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:20:16.133

这些头文件不是标准 C 或 C++ 的一部分。不要尝试从其他来源下载标头；即使您可以编译它们，它们也不会正确链接，因为您没有在静态库或 DLL 中声明的函数的实现。

简单的事实是，您尝试编译的代码是为 Unix/类 Unix 系统编写的，它不能移植到 Windows。您需要大量重写代码以使用等效的 Windows 功能或第三方平台独立库（例如用于套接字的 Winsock 或 Boost 套接字），在 Unix 系统上编译它（如果您可以使用虚拟机想要），或使用 Unix 兼容层，例如 Cygwin。

# cordova - iOS/Android 后台音频流

> ID：11939792
> 
> 赞同：0
> 
> 时间：2012-08-13T18:05:17.677
> 
> 标签：cordova, background, streaming, mp3

我正在考虑使用 phonegap 来定位 ios 和 android。但在开始之前，我需要确定是否以及如何拥有后台音频流。我会在网络上的某个地方有一个固定长度 mp3 的 url，无论应用程序是打开还是在后台，我都需要播放它，并且能够跟踪 mp3 何时结束。任何笔记，这方面的个人经验，链接等都会很棒。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:08:38.953

我不知道 Android 的答案，但对于 iOS，可以使用 phonegap 应用程序启用背景音频。但是，您需要修改 phonegap 源才能使其正常工作，并将名称/值对添加到项目的 info.plist 文件中。有关完整的详细信息，请参阅[这篇文章](http://www.joeldare.com/wiki/play_an_mp3_audio_stream_in_phonegap)。

# javascript - 无法使用 Javascript 为 div #box 设置动画

> ID：11939795
> 
> 赞同：1
> 
> 时间：2012-08-13T18:05:28.947
> 
> 标签：javascript, html, animation

帮助！我不知道这里出了什么问题，我正在关注来自 Tuts+ 的教程视频 代码是准确的，但蓝色框没有向左侧显示动画。

当我在 moveBox 函数中放置警报时，我在控制台中看到警报一遍又一遍地触发相同的消息。

**这是我的测试链接：**

[> 尝试使用 Javascript 动画左蓝色框 <](http://leongaban.com/_stack/js_animate_box/animation.html)

**这是视频的截图：**

![在此处输入图像描述](../Images/5040eaa7872072eb0e209a7d574d1289.png)

**这是我的代码：**

```
(function() {

var speed   = 10,       
    moveBox = function() {
        var el = document.getElementById("box"),
            i = 0,
            left   = el.offsetLeft,
            moveBy = 3;
            //console.log("moveBox executed " +(i+1)+ " times");

            el.style.left = left + moveBy + "px";

        if (left > 399) {
            clearTimeout(timer);
        }
    };

var timer = setInterval(moveBox, speed);

}()); 
```

HTML：

```
<!DOCTYPE html>

<head>
<meta charset="utf-8">
<title>JavaScript 101 : Window Object</title>
<style>
    #box {
        position: abosolute;
        height: 100px;
        left: 50px;
        top: 50px;
        width: 100px;
        background-color: Blue;
    }
</style>
</head>

<body>

<div id="box"></div>
<script src="js/animation.js"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:23:19.983

您在定位中拼错了“绝对”：

```
#box {
    position: absolute;   // Your mispelling here
    height: 100px;
    left: 50px;
    top: 50px;
    width: 100px;
    background-color: Blue;
} 
```

一旦我解决了这个问题，它就工作得很好。

一个忠告——在这样的循环中放置第二个条件，这样如果动画由于某种原因失败，你就不会陷入无限循环。例如，您可能已经这样做了：

```
(function() {

var maxTimes = 1000;
var loopTimes = 0;
var speed = 10,       
moveBox = function() {
    var el = document.getElementById("box"),
        i = 0,
        left   = el.offsetLeft,
        moveBy = 3;
        //console.log("moveBox executed " +(i+1)+ " times");

     el.style.left = left + moveBy + "px";

     loopTimes += 1;
     if (left > 399 || loopTimes > maxTimes) {
         clearTimeout(timer);
     }
};

var timer = setInterval(moveBox, speed);

}()); 
```

# java - 优雅地忽略按键

> ID：11939804
> 
> 赞同：1
> 
> 时间：2012-08-13T18:05:55.550
> 
> 标签：java, keylistener

我试图忽略 JavaTextField 中的某些按键。我添加了一个 KeyListener，因为每次输入字母/数字/符号时我都需要触发一个事件。

我不希望在按下任何其他按钮时触发事件。为了实现这一点，我目前正在这样做：

```
 @Override
        public void keyPressed(KeyEvent arg0) {
            // System.out.println(arg0);
            if (arg0.getKeyCode() != (KeyEvent.VK_ENTER)
                    && arg0.getKeyCode() != (KeyEvent.VK_BACK_SPACE)
                    && arg0.getKeyCode() != (KeyEvent.VK_DELETE)
                    && arg0.getKeyCode() != (KeyEvent.VK_UP)
                    && arg0.getKeyCode() != (KeyEvent.VK_DOWN)
                    && arg0.getKeyCode() != (KeyEvent.VK_LEFT)
                    && arg0.getKeyCode() != (KeyEvent.VK_RIGHT)
                    && arg0.getKeyCode() != (KeyEvent.VK_SHIFT)
                    && arg0.getKeyCode() != (KeyEvent.VK_CAPS_LOCK)
                    && arg0.getKeyCode() != (KeyEvent.VK_PAGE_DOWN)
                    && arg0.getKeyCode() != (KeyEvent.VK_PAGE_UP)
                    && arg0.getKeyCode() != (KeyEvent.VK_SCROLL_LOCK)
                    && arg0.getKeyCode() != (KeyEvent.VK_NUM_LOCK)
                    && arg0.getKeyCode() != (KeyEvent.VK_ESCAPE)) {
                // fire event here
            }

        } 
```

显然这是丑陋的。有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:10:01.903

单程

```
private static final List<Integer> ACCEPTED_KEYS = Arrays.asList(KeyEvent.VK_ENTER, ...);

public void keyPressed(KeyEvent event) {
  if (ACCEPTED_KEYS.contains(event.getKeyCode())
    // do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:11:56.787

您可以使用某种集合。某种类型的集合可能具有最快的查找速度。

```
// new class member
Set<Integer> ignoredKeyCodes = new HashSet<Integer>();

// add to class constructor
ignoredKeyCodes.add(KeyEvent.VK_ENTER);
// add other key codes

// check with
if (!ignoredKeyCodes.contains(arg0.getKeyCode())) // fire event here 
```

# c# - 使用 Socket 和 REST 将文件发布到 SkyDrive，没有任何反应

> ID：11939806
> 
> 赞同：1
> 
> 时间：2012-08-13T18:06:02.560
> 
> 标签：c#, sockets, rest, onedrive

我的类库需要一个到 SkyDrive 的接口。

（我能否快速说一下，如果完全不充分，我认为 Microsoft 以在线技术文档的方式提供的在 SkyDrive 上进行开发的方式完全不够，恕我直言。）

目前，我的库可以使用 Microsoft.Live API 和 Socket 类的组合登录、下载文件和删除文件。（我不能使用高级套接字类，例如 HttpWebRequest 和 WebClient，所以我使用的是 Socket 类。）

但我坚持上传文件。

这是一个将文件发布到 SkyDrive 帐户的简单请求：

```
private const string API_SERVICE_URI = "https://apis.live.net/v5.0/";
private const string REST_DATA_BOUNDARY = "A300x";

StringBuilder sb = new StringBuilder();
sb.AppendFormat("POST {0}me/skydrive/files?access_token={1}\r\n",
    API_SERVICE_URI,
    _liveSession.AccessToken
);
sb.Append("\r\n");
sb.AppendFormat("Content-Type: multipart/form-data; boundary={0}\r\n", 
    REST_DATA_BOUNDARY
);
sb.Append("\r\n");
sb.AppendFormat("--{0}\r\n", REST_DATA_BOUNDARY);
sb.AppendFormat("Content-Disposition: form-data; name=\"file\"; filename=\"test.txt\"\r\n");
sb.AppendFormat("Content-Type: application/octet-stream\r\n");
sb.Append("\r\n");
sb.Append("abcdefg\r\n");
sb.AppendFormat("--{0}--\r\n", REST_DATA_BOUNDARY); 
```

当我通过连接的套接字发送它时，没有任何反应。无回复。没有错误。没有什么。

我按原样将其发送到 Socket 上是否正确？我只是将整个内容序列化为 ASCII 并发送它。我是否打算包含一些身份验证或 cookie 值，因为它通过 SSL 进行？这就是为什么什么都没有回来的原因吗？

# forms - 带有 URL 操作的 JSF 表单？

> ID：11939807
> 
> 赞同：5
> 
> 时间：2012-08-13T18:06:03.870
> 
> 标签：forms, url, jsf-2, action

有没有办法在 a 中调用 URL 操作`<h:commandButton>`，或者就此而言 a `<h:form>`？我试图从我自己的网站绕过我的电子邮件登录页面，所以我使用 JSF bean 将我的登录信息保存在`<h:inputSecret>`标签中，这样我就可以简单地单击“转到电子邮件”，因为我已经登录到我自己的网站，我可以直接进入我的收件箱而无需再次登录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T22:41:27.783

只需使用纯 HTML`<form>`而不是 JSF `<h:form>`。

```
<form action="http://example.com/mail" method="post">
    <input type="text" name="username" value="#{bean.username}" />
    <input type="password" name="password" value="#{bean.password}" />
    <input type="submit" value="Go to Email" />
</form> 
```

# android - 在 Android 上播放来自 amr 的音频

> ID：11939808
> 
> 赞同：2
> 
> 时间：2012-08-13T18:06:03.970
> 
> 标签：android, audio, amr

我可以从`Socket`. 我需要播放这个字节数组中的音频——音频是用 AMR 8000Hz 编码的。

我发现我可以用`MediaPlayer`. 但是，`MediaPlayer`无法从字节数组播放音乐，我不想将它们写入文件。

有没有办法在 android 上从字节数组播放 AMR 声音？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:13:52.250

`AudioTrack`Android 框架允许您使用该类直接从内存中播放音频数据；缺点是音频必须已经解码为 PCM 数据。如果您有幸以 Android 4.1 为目标，则有新的 API 允许您单独解码数据，以便将其传递给`AudioTrack`（请参阅`MediaExtractor`和`MediaCodec`）。但是，在此之前，没有公开的用于编码/解码的 API`MediaRecorder`和`MediaPlayer`.

如果针对 4.1 之前的 Android 版本（我想您可能是），您有两种选择：

*   为 AMR 数据查找第 3 方解码器，以便将其传递给`AudioTrack`
*   将您的数据保存到文件中（即使是临时的），以便将其交给`MediaPlayer`

高温高压

# cuda - 为什么全局+共享比单独全局更快

> ID：11939813
> 
> 赞同：2
> 
> 时间：2012-08-13T18:06:29.653
> 
> 标签：cuda, shared-memory

我需要一些帮助来理解 Ron Farber 代码的行为：[http ://www.drdobbs.com/parallel/cuda-supercomputing-for-the-masses-part/208801731?pgno=2](http://www.drdobbs.com/parallel/cuda-supercomputing-for-the-masses-part/208801731?pgno=2)

我不明白共享内存的使用如何比非共享内存版本提供更快的性能。即如果我添加更多索引计算步骤并使用添加另一个 Rd/Wr 循环来访问共享内存，这怎么能比单独使用全局内存更快？在任何一种情况下，相同数量或 Rd/Wr 周期都会访问全局内存。每个内核实例仍然只能访问一次数据。数据仍然使用全局内存输入/输出。内核实例的数量是相同的。寄存器计数看起来是一样的。添加更多处理步骤如何使其更快。（我们没有减去任何流程步骤。）本质上我们正在做更多的工作，而且完成得更快。

共享内存访问比全局快得多，但它不是零（或负数）。我错过了什么？

“慢”代码：

```
__global__ void reverseArrayBlock(int *d_out, int *d_in) {
int inOffset  = blockDim.x * blockIdx.x;
int outOffset = blockDim.x * (gridDim.x - 1 - blockIdx.x);
int in  = inOffset + threadIdx.x;
int out = outOffset + (blockDim.x - 1 - threadIdx.x);
d_out[out] = d_in[in];
} 
```

“快速”代码：

```
__global__ void reverseArrayBlock(int *d_out, int *d_in) {
extern __shared__ int s_data[];

int inOffset  = blockDim.x * blockIdx.x;
int in  = inOffset + threadIdx.x;

// Load one element per thread from device memory and store it
// *in reversed order* into temporary shared memory
s_data[blockDim.x - 1 - threadIdx.x] = d_in[in];

// Block until all threads in the block have written their data to shared mem
__syncthreads();

// write the data from shared memory in forward order,
// but to the reversed block offset as before
int outOffset = blockDim.x * (gridDim.x - 1 - blockIdx.x);
int out = outOffset + threadIdx.x;
d_out[out] = s_data[threadIdx.x];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T19:37:46.910

Early CUDA-enabled devices (compute capability < 1.2) would not treat the d_out[out] write in your "slow" version as a coalesced write. Those devices would only coalesce memory accesses in the "nicest" case where i-th thread in a half warp accesses i-th word. As a result, 16 memory transactions would be issued to service the d_out[out] write for every half warp, instead of just one memory transaction.

Starting with compute capability 1.2, the rules for memory coalescing in CUDA became much more relaxed. As a result, the d_out[out] write in the "slow" version would also get coalesced, and using shared memory as a scratch pad is no longer necessary.

The source of your code sample is article "CUDA, Supercomputing for the Masses: Part 5", which was written in June 2008\. CUDA-enabled devices with compute capability 1.2 only arrived on the market 2009, so the writer of the article clearly talked about devices with compute capability < 1.2.

For more details, see section F.3.2.1 in the [NVIDIA CUDA C Programming Guide](http://developer.download.nvidia.com/compute/DevZone/docs/html/C/doc/CUDA_C_Programming_Guide.pdf).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:21:20.127

这是因为共享内存更靠近计算单元，因此延迟和峰值带宽不会成为此计算的瓶颈（至少在矩阵乘法的情况下）

但最重要的是，最重要的原因是 tile 中的许多数字被许多线程重用。因此，如果您从全局访问，您将多次检索这些数字。将它们一次写入共享内存将消除浪费的带宽使用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:23:03.793

在查看全局内存访问时，慢代码向前读取并向后写入。快速代码向前读取和写入。我认为快速代码更快，因为缓存层次结构在某种程度上进行了优化，以降序访问全局内存（朝向更高的内存地址）。

CPUs do some speculative fetching, where they will fill cache lines from higher memory addresses before the data has been touched by the program. Maybe something similar happens on the GPU.

# r - 在 data.table 中使用 := 和 j （未实现功能的解决方法）

> ID：11939821
> 
> 赞同：2
> 
> 时间：2012-08-13T18:06:46.987
> 
> 标签：r, data.table

编辑：这个问题是由于安装了过时的 data.table 版本。

我有一个如下的 data.table：

```
require(xts)
a <- data.table(colour=c("Red","Green","Blue","Blue","Black","Black"), date=c(as.Date("2011-07-04"),as.Date("2011-07-10"),as.Date("2011-07-09"),as.Date("2011-07-12"),as.Date("2011-07-04"),as.Date("2011-07-09")),daily.quantity=c(1,-1,2,-2,1,1))

     colour       date daily.quantity
[1,]    Red 2011-07-04              1
[2,]  Green 2011-07-10             -1
[3,]   Blue 2011-07-09              2
[4,]   Blue 2011-07-12             -2
[5,]  Black 2011-07-04              1
[6,]  Black 2011-07-09              1 
```

我希望每种颜色的累积总数看起来像这样：

```
 colour       date daily.quantity cumulative.quantity
[1,]  Black 2011-07-04              1                   1
[2,]  Black 2011-07-09              1                   2
[3,]   Blue 2011-07-09              2                   2
[4,]   Blue 2011-07-12             -2                   0
[5,]  Green 2011-07-10             -1                  -1
[6,]    Red 2011-07-04              1                   1 
```

但是，如果我尝试以下操作，我最终会得到不考虑颜色的累积总数：

```
setkey(a,colour,date)
a[,cumulative.quantity := cumsum(daily.quantity)]

     colour       date daily.quantity cumulative.quantity
[1,]  Black 2011-07-04              1                   1
[2,]  Black 2011-07-09              1                   2
[3,]   Blue 2011-07-09              2                   4
[4,]   Blue 2011-07-12             -2                   2
[5,]  Green 2011-07-10             -1                   1
[6,]    Red 2011-07-04              1                   2 
```

我尝试了明显的，但不幸的是未实现：

```
> a[,cumulative.quantity := cumsum(daily.quantity),keyby="colour,date"]
Error in `[.data.table`(a, , `:=`(cumulative.quantity, cumsum(daily.quantity)),  : 
  Combining := in j with by is not yet implemented. Please let maintainer('data.table') know if you are interested in this. 
```

那么，任何人都可以为此提出解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:32:28.993

您不希望按“日期”和“颜色”进行总计，只需要按“颜色”。不确定为什么需要 xts，因为 data.table 在 pkg:data.table 中。

```
> a[,cumulative.quantity := cumsum(daily.quantity), by=c("colour") ]
   colour       date daily.quantity cumulative.quantity
1:  Black 2011-07-04              1                   1
2:  Black 2011-07-09              1                   2
3:   Blue 2011-07-09              2                   2
4:   Blue 2011-07-12             -2                   0
5:  Green 2011-07-10             -1                  -1
6:    Red 2011-07-04              1                   1 
```

如果您实际上确实 wnat 了两列（这意味着您的“想要看起来像这样”的示例是错误的，您可以这样做：

```
> setkey(a,colour,date)
> a[,cumulative.quantity := cumsum(daily.quantity), by=c("colour", "date") ]
   colour       date daily.quantity cumulative.quantity
1:  Black 2011-07-04              1                   1
2:  Black 2011-07-09              1                   1
3:   Blue 2011-07-09              2                   2
4:   Blue 2011-07-12             -2                  -2
5:  Green 2011-07-10             -1                  -1
6:    Red 2011-07-04              1                   1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:32:35.653

分组`by`应该只在`colour`：

```
a[,cumulative.quantity := cumsum(daily.quantity), by=colour]
   colour       date daily.quantity cumulative.quantity
1:  Black 2011-07-04              1                   1
2:  Black 2011-07-09              1                   2
3:   Blue 2011-07-09              2                   2
4:   Blue 2011-07-12             -2                   0
5:  Green 2011-07-10             -1                  -1
6:    Red 2011-07-04              1                   1 
```

# java - Eclipse 无法运行：\.metadata\.log 错误

> ID：11939822
> 
> 赞同：7
> 
> 时间：2012-08-13T18:06:53.440
> 
> 标签：java, android, eclipse

我正在开发一个Android项目，重新启动计算机后，eclipse将无法运行。它抛出 .metadata.log 文件错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-02-25T17:21:03.673

转到`~\.metadata\.plugins\org.eclipse.core.resources` 您将找到**.snap**文件。只需删除它。重新启动 Eclipse。

它将完美地工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-13T18:10:49.043

尝试使用新的工作区。要强制工作区窗口提示，您需要更改设置`<Eclipse_root_dir>\configuration\.settings\org.eclipse.ui.ide.prefs`并设置`SHOW_WORKSPACE_SELECTION_DIALOG`为`true`.

来源：[Eclipse 社区论坛](http://www.eclipse.org/forums/index.php/t/156204/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-13T20:54:24.280

您不必删除 .metadata 文件夹，因为这样会删除您对工作区的首选项。但是，请删除 .metadata 文件夹中存在的快照文件以及 .lock 文件。

同样在你这样做之后不要忘记做一个干净的开始

```
./eclipse -clean 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-13T18:15:56.967

我在运行 Eclipse（使用 Mercurial 和 Aptana 插件）时也遇到了一些问题。

如果您想找出导致此问题的原因，请备份`.metadata`文件夹并“逐步”删除`<your_workspace_folder>/.metadata/plugins/`. 如果您删除一些文件夹并且 Eclipse 将运行，您就会知道这就是问题所在。

对于 Mercurial 我删除`workspace\.metadata\.plugins\org.eclipse.core.resources\snap` 和 Aptana`workspace\.metadata\.plugins\org.eclipse.core.resources\.safetable`

如果您不关心您的偏好是否丢失，只需删除`.metadata`文件夹并再次运行 Eclipse - 它会创建新`.metadata`文件夹。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-01T10:42:59.863

您可以在此文件夹中进行二进制搜索（每次使用不同的插件子集）以查找导致问题的文件夹。

对我来说，删除文件夹“...\workspace.metadata.plugins\org.eclipse.e4.workbench”修复了它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-10-04T15:36:54.157

我有同样的问题。我删除了 /.metadata 但我无法解决这个问题。如果您使用 Java 9 安装 Eclipse，您可能无法通过仅删除 .metadata 或 log 文件夹来解决此问题。

这就是我所做的。我在 Ubuntu 16.04 上的 /opt/eclipse 中提取并安装了 eclipse。我的 java 版本是 9，Eclipse 版本是氧气 4.7.0。

我在 eclipse.ini 文件的最后一行添加了“--add-modules=ALL-SYSTEM”。然后，我解决了这个问题。由于 Eclipse SDK 使用了不在 java.base 模式中的内容，我需要在 eclipse.ini 文件中添加这一行。请参阅此 URL：[https](https://wiki.eclipse.org/Configure_Eclipse_for_Java_9) ://wiki.eclipse.org/Configure_Eclipse_for_Java_9 。我希望这对其他人有帮助。这很容易修复，但我花了一段时间才找到这个解决方案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-04T15:36:14.100

只需删除 ~ **WorkSapce\.metadata.plugins\org.eclipse.e4.workbench** 文件夹。然后重新启动 Eclipse。这个对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-08T13:20:38.100

此链接解决了我的问题：[https ://wiki.eclipse.org/Eclipse.ini#-vm_value:_Mac_OS_X_Example](https://wiki.eclipse.org/Eclipse.ini#-vm_value:_Mac_OS_X_Example). 我遵循了 Mac 示例。我找到了文件 eclipse.ini。然后我选择“获取信息”并将“.ini”更改为“.txt”。这使我可以编辑文件中的文本。然后我去了 finder，去了 Macintosh HD -> Library -> Java -> JavaVirtualMachines -> jdk1.8.0_144.jdk -> Contents -> Home -> bin。然后我用通用文本编辑器打开了 eclipse.txt 文件。这是我随后复制到“-vm”下的文本文件 eclipse.txt 中的路径，例如“/Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/bin”。然后我点击命令保存。然后我在 eclipse.txt 文件上选择“获取信息”并将“.txt”更改为“.ini”并回答是的，当出现一个小弹出框时，我肯定会使用“.ini”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-09T22:43:18.643

对于那些有 .metadata/.log 错误的人，只需安装 java jdk-8u144 并完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-30T07:44:03.743

这些都不适合我，我使用了 java 8.221 和 Eclipse Oxygen。所以我尝试了这个。我编辑了`eclipse.ini`，然后`-vmargs`放

```
-vm
C:\Program Files\Java\jdk1.8.0_221\bin\javaw.exe 
```

它开始工作

源：[https ://www.eclipse.org/forums/index.php/t/1089060/](https://www.eclipse.org/forums/index.php/t/1089060/)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-08-13T19:15:36.200

导航到 android-sdks（我的位于 C:\Users\azeuner\android-sdks\platform-tools）然后单击平台工具，然后单击 adb.exe 这将刷新 eclipse。它对我有用！

# windows - MSI：应用程序在静默更新期间正在运行

> ID：11939828
> 
> 赞同：2
> 
> 时间：2012-08-13T18:07:22.667
> 
> 标签：windows, installation, wix, windows-installer

我有一个作为 MSI 包安装的应用程序，我有下一个版本的应用程序，我计划通过特殊程序以静默模式安装。

当应用程序运行时，我发现了一个问题：并非应用程序的所有组件都立即安装，其中一些组件只有在重新启动后才能真正准备好。我得到不稳定的应用程序。

我可以检查 - 应用程序是否正在运行并等到它关闭，但是当用户在静默安装期间单击快捷方式时，我无法检查情况。

我怎样才能避免这种情况？我可以在安装期间锁定应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T02:13:00.227

我建议实施[重启管理器](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373524%28v=vs.85%29.aspx)支持。Vista 或更高版本将尝试通过重新启动管理器关闭您的应用程序，您可以决定如何在您的应用程序中处理它（提示用户、自动保存、其他等）。

您不会捕捉到用户在更新期间启动应用程序的情况，但它会比您的自定义代码更优雅地处理多用户会话。

# sql - DBISAM - 错误 8708 - 版本 2.03

> ID：11939830
> 
> 赞同：0
> 
> 时间：2012-08-13T18:07:31.570
> 
> 标签：sql, dbisam

我正在尝试更新字段 CNAME 并将其用于 Where 子句：

```
update SGT000 set CName='STA2'where CName='STA23' 
```

DBISAM 引发异常 8708（表 'SGT000.DAT' 中的记录已被另一个用户更改或删除）我使用的是 2.03 版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:15:06.233

我找到了解决方案。这是 2.03 版本中的一个错误。

[http://www.elevatesoft.com/incident?action=viewrep&category=dbisam&release=2.03&incident=604](http://www.elevatesoft.com/incident?action=viewrep&category=dbisam&release=2.03&incident=604)

# android - asp.net Web Api 和移动应用程序

> ID：11939831
> 
> 赞同：0
> 
> 时间：2012-08-13T18:07:32.787
> 
> 标签：android, asp.net, xml, rest, asp.net-web-api

我只想为 Android 和其他一些移动平台制作电视指南。我想使用 RSS 更新来更新我的应用程序。在这个特定场景中，我想使用[http://tvprofil.net/](http://tvprofil.net/) 的 RSS 资源。我以为我可以从我的 Android 应用程序中调用站点的 RSS XML，对其进行解析、显示，这就是故事的结尾。

但是，我的表弟告诉我，最好的方法是通过 Asp.net Web Api Service。处理 REST 的东西。因此，如果我必须更改资源，喜欢某些 iptv 提供商的 RSS，我只需更改服务，而不必处理我的移动应用程序。他说，另一个优势是，如果我想构建以相同方式工作的 Windows Phone 应用程序或 iOS 应用程序，我将拥有相同的服务来为我完成工作，只需为这些应用程序创建 UI 和基本内容。

问题是我不知道如何使用 Asp.net web Api。

谁能给我一些有用的链接，或者更好的是，写一个这个例子。[我只希望来自http://tvprofil.net/](http://tvprofil.net/)的 RSS通过 Asp.Net Web Api 服务，我可以调用服务并将其作为 XML 或......甚至 Json...... 或获取任何东西我的应用程序。

整件事让我很困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:14:48.720

如果 RSS 提要有足够的数据供您的应用程序运行，那么您不需要 ASP.NET Web Api。ASP.NET Web Api 在这种情况下可以发挥的唯一作用是它是否充当中间体。例如，您的客户端应用程序与您的服务器应用程序 (ASP.NET Web Api) 联系，后者又从实际的外部数据源 (tvprofil.net RSS) 中提取数据。

为了完整起见，列出了赞成和反对的清单：

****使用中间服务器的*****优势*****

 *****   **可靠性**。即使外部数据源处于脱机状态，您也可以缓存外部数据源的数据并提供该数据。此外，通过缓存数据，您可以将外部数据源的负载减轻到最低限度。
*   **变形能力**。您的中间服务器可以将外部数据源的数据转换为更适合您的客户端应用程序的另一种格式。当您有许多外部数据源，每个数据源都以另一种格式提供数据时，这很有用。您的中间服务器充当客户端应用程序的抽象层。

****使用中间服务器的*****缺点*****

 *****   **更加努力**。开发和托管中间服务器将需要更多的努力。
*   **可靠性**。您必须确保您的中间服务器在线并连接到互联网 24/7********

# java - 阅读响应，即使它是 404

> ID：11939834
> 
> 赞同：2
> 
> 时间：2012-08-13T18:07:45.490
> 
> 标签：java, http-status-code-404

如果 getResponseCode() == 404 并因此 getInputStream() 会抛出异常，有没有办法读取如下所示的简单 http-get 的响应？如果可能的话，我更愿意继续使用 java.net。

```
HttpURLConnection c = (HttpURLConnection)new URL("http://somesite.com").openConnection;
c.openInputStream(); 
```

问题是，我（确实）有一个我想用 java 读取的站点，它以 404 响应，但显示在浏览器中，因为它显然会产生响应。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:12:59.040

如果. _ [`getErrorStream()`_](http://docs.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html#getErrorStream%28%29)`getResponseCode() == 404`

```
HttpURLConnection c = (HttpURLConnection)new URL("http://somesite.com").openConnection();
InputStream in = null;
if (c.getResponseCode() >= 400) {
   in = c.getErrorStream();
}  
else {
   in = c.getInputStream();
} 
```

# jquery - 使用 for 循环显示 div

> ID：11939846
> 
> 赞同：1
> 
> 时间：2012-08-13T18:08:21.777
> 
> 标签：jquery, for-loop

我有一个 HTML 结构：

```
<div class="ttl">
   <div class="ttlpadding">
      <div class="item"></div>
   </div>
</div> 
```

我的目标是在 .item 中显示 10 张图像，这些图像将包含在 .ttlpadding 中，而 .ttlpadding 将包含在 .ttl 中。因此，每个单独的 .item 及其对应的单独图像都会有单独的 .ttl。

我的 jQuery 代码：

```
 for (var i = 0; i < 10; i++) {
       $(".item").append("<a href='" + data.data[i].images.standard_resolution.url +"' ><img src='" + data.data[i].images.thumbnail.url +"' /></a>");
} 
```

目前，所有十张图片都包含在一个“.item”中，因此也包含在一个“.ttl”中。我尝试了很多变化，但无法找出正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:15:22.407

```
$('.ttl').first().parent().append(
"<div class="ttl">
   <div class="ttlpadding">
      <div class="item">" + 

"<a href='" + data.data[i].images.standard_resolution.url +"' ><img src='" + data.data[i].images.thumbnail.url +"' /></a>" +
"</div>
   </div>
</div>"
); 
```

这将选择 .ttl（第一个），转到它的父级，并添加必要的 div 和图像代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:17:23.073

您的十件物品在单个“ttl”内，因为这是您将它们附加到的地方 `$(".item").append........`

您需要将它们附加到层次结构中的更高元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:15:36.373

您附加到内部 div。使用 jquery`clone`函数复制外部 ttl div。克隆函数的文档有一个解释你想要什么的例子。[http://api.jquery.com/clone/](http://api.jquery.com/clone/)

基本上它看起来像这样：

```
var clone = $('.ttl').clone().filter('.item').append(your_html_from_your_example); 
```

你仍然需要把这个新的克隆对象放到你的 DOM 中。可能附加到 ttl 的父级：

```
$('.ttl').parent().append(clone); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:16:27.963

如果您在创建所需的 html 结构时遇到问题，请以旧方式进行：

```
var html='';

for (var i = 0; i < 10; i++) {
    html += '<div class="ttl">';
    html +=  '<div class="ttlpadding">';
    html +=   '<div class="item">';
    html +=    '<a href="' + data.data[i].images.standard_resolution.url +'" >';
    html +=     '<img src="' + data.data[i].images.thumbnail.url +'" />';
    html +=    '</a>';
    html +=   '</div>';
    html +=  '</div>';
    html += '</div>';
}
$("element").append(html); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T18:18:41.110

你可以使用：

```
var original=$(".ttl")[0];
for (var i = 0; i < 10; i++) {
  var el=original.cloneNode(true);
  el.firstChild.firstChild.innerHTML="<a href='" + data.data[i].images.standard_resolution.url +"' ><img src='" + data.data[i].images.thumbnail.url +"' /></a>";
  document.body.appendChild(el);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T18:21:34.290

您将图像附加到“ttl”内的“项目”类。如果你想要十个“ttl”类的项目，你需要附加到“ttl”的父类。例如：

HTML：

```
<div class="container">
</div> 
```

Javascript/JQuery

```
htmlToAppend = "
  <div class="ttl">
     <div class="ttlpadding">
         <div class="item"></div>
     </div>
  </div>
 "; //may not be valid javascript but it should give you the right idea.

for (var i = 0; i < 10; i++) {
   $(htmlToAppend).filter(".item").append("<a href='" + data.data[i].images.standard_resolution.url +"' ><img src='" + data.data[i].images.thumbnail.url +"' /></a>");
   $(".container").append(htmlToAppend);
} 
```

或者其他人说的。选择你最喜欢的那个。

# php - fopen 中的 w+ 模式？

> ID：11939847
> 
> 赞同：4
> 
> 时间：2012-08-13T18:08:25.023
> 
> 标签：php

```
fopen($handle, 'w+'); 
```

我正在寻找打开一个 .CSV 文件，读取每一行并对数据库执行某些操作，然后截断 .CSV 文件并编写类似的内容

> 该文件已被读取。

w+ 表示读/写，但文件也被截断。那么如果 fopen w+ 只会擦除其中的内容，那么读取的意义何在？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T18:13:09.620

采用`a+`

从文档中：

```
'w+'     Open for reading and writing; place the file pointer at the beginning of the file and truncate the file to zero length. If the file does not exist, attempt to create it.
'a+'     Open for reading and writing; place the file pointer at the end of the file. If the file does not exist, attempt to create it. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:15:07.403

然后在你读完之后使用 unlink($filename) 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:11:14.270

在您的情况下，您可能希望以“r”模式打开文件以读取它。然后将其关闭并以“w”模式重新打开以编写截断消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-24T20:44:46.420

使用“c+”模式。

> 打开文件进行读写。如果文件不存在，则创建它。如果它存在，它既不会被截断（与“w”相反），对该函数的调用也不会失败（就像“x”一样）。文件指针位于文件的开头。

[http://php.net/manual/en/function.fopen.php](http://php.net/manual/en/function.fopen.php)

# asynchronous - JBoss 6.1 不限制使用 @Asynchronous 启动的线程数

> ID：11939848
> 
> 赞同：2
> 
> 时间：2012-08-13T18:08:29.023
> 
> 标签：asynchronous, jboss, ejb, ejb-3.1, jboss6.x

我们的应用程序通过 EJB 上的 @Asynchronous 注解启动了一系列线程。但是，JBoss（与[此](https://issues.jboss.org/browse/JBAS-9356)相反）并不限制启动的线程数。调试表明它使用的是默认类，而不是在上述问题中链接的 XML 中配置的类。课堂上的评论说：

```
Static singleton access to a default java.util.concurrent.ExecutorService
implementation used by clients who do not supply a
org.jboss.ejb3.async.spi.AsyncInvocation to handle asynchronous
EJB 3.1 invocations. 
```

所以问题是在什么情况下 JBoss 不提供`org.jboss.ejb3.async.spi.AsyncInvocation`类，你如何确保这确实发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T18:10:00.233

默认情况下，JBoss AS 6.1 确实应该限制线程数，但由于一个错误，这根本不会发生。遗憾的是，全局设置在没有警告的情况下被忽略了。

如果它不涉及太多的bean，您可以使用`org.jboss.ejb3.annotation.Pool`注释：

```
@Pool(value = POOL_IMPLEMENTATION_STRICTMAX, maxSize = 10)
public class SomeBean {
    // ...
} 
```

不过要小心，如果我没记错的话，这将为每个 bean 创建一个池。

# android - Android-在 MapView 中从 KML 文件中绘制路径

> ID：11939849
> 
> 赞同：1
> 
> 时间：2012-08-13T18:08:35.803
> 
> 标签：android, google-maps, google-api, android-mapview, kml

我已经为此工作了一段时间，但我仍然没有得到我正在寻找的结果。我正在尝试创建一个应用程序来显示我们的山地自行车道，以便您在骑行时可以看到自己的位置。我首先从我的 kml 文件中手动复制坐标，然后使用此代码将它们粘贴为 Geopoints，该代码一直有效，直到我到达 80 点。然后 LogCat 给出了拒绝大方法的错误，我还有数百个方法要做：

```
import java.util.List;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.Projection;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.Point;
import android.os.Bundle;

public class TrailMaps extends  MapActivity  {
    private List mapOverlays;
    private Projection projection;
    private MapController mc;
    private MapView mapView;
    private GeoPoint gP;
    private MyOverlay myoverlay;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);    
    mapView = (MapView) findViewById(R.id.mapview);//Creating an instance of MapView
    mapView.setBuiltInZoomControls(true);//Enabling the built-in Zoom Controls
    gP = new GeoPoint(43311836,-91777756);//Creating a GeoPoint
    mc = mapView.getController();
    mc.setCenter(gP);
    mc.setZoom(15);//Initializing the MapController and setting the map to center at the
    mapOverlays = mapView.getOverlays();
    projection = mapView.getProjection();
    myoverlay = new MyOverlay();
    mapOverlays.add(myoverlay);
    }

    class MyOverlay extends Overlay{ 
        public MyOverlay(){      
        }                     
      public void draw(Canvas canvas, MapView mapView, boolean shadow) {
         super.draw(canvas, mapView, shadow);
         Paint paint;
         paint = new Paint();
         paint.setDither(true);
         paint.setColor(Color.RED);
         paint.setStyle(Paint.Style.FILL_AND_STROKE);
         paint.setStrokeJoin(Paint.Join.ROUND);
         paint.setStrokeWidth(2);        

         GeoPoint gp1 = new GeoPoint(43311836,-91777756);
         GeoPoint gp2 = new GeoPoint(43311718,-91777699);
         GeoPoint gp3 = new GeoPoint(43311718,-91777699);
         GeoPoint gp4 = new GeoPoint(43311666,-91777627);
         GeoPoint gp5 = new GeoPoint(43311624,-91777541);                    

         Point pt1 = new Point();
         Point pt2 = new Point();
         Point pt3 = new Point();
         Point pt4 = new Point();
         Point pt5 = new Point();

         Path path1 = new Path();
         Path path2 = new Path();
         Path path3 = new Path();

         projection.toPixels(gp1,pt1);
         projection.toPixels(gp2, pt2);
         projection.toPixels(gp3, pt3);
         projection.toPixels(gp4, pt4);
         projection.toPixels(gp5, pt5);

         path1.moveTo(pt1.x, pt1.y);
         path1.lineTo(pt2.x, pt2.y);         
         path2.moveTo(pt3.x,pt3.y);
         path2.lineTo(pt4.x, pt4.y);         
         path3.moveTo(pt4.x,pt4.y);
         path3.lineTo(pt5.x,pt5.y);                               

         canvas.drawPath(path1, paint);
         canvas.drawPath(path2, paint);  
         canvas.drawPath(path3, paint);               
      }
   }
   @Override
   protected boolean isRouteDisplayed() {          
      return false;  
    }
} 
```

然后我尝试解析 kml 文件，如下例所示：[如何使用 kml 文件在地图上绘制路径？](https://stackoverflow.com/questions/3109158/how-to-draw-a-path-on-a-map-using-kml-file)

但这是在获取我的坐标并找到最近的街道并覆盖一条路线。我的坐标不在街道上，而是在路边的公园里，那我该怎么做呢？

现在我愿意接受任何建议。有没有更好的方法来解析 kml 文件，在本地进行而不是去[http://maps.google.com/maps](http://maps.google.com/maps)？，将其作为图像覆盖，或者完全是一个全新的方向......任何建议都会很多赞赏。

谢谢

# oracle - 使用 CASE 在 Oracle 中按日期数据类型动态排序

> ID：11939852
> 
> 赞同：0
> 
> 时间：2012-08-13T18:08:45.717
> 
> 标签：oracle, sql-order-by, case-statement

我在存储过程中的代码：

```
SELECT * FROM
my_table ir
WHERE 
--where clause goes here
ORDER BY   
       CASE  WHEN p_order_by_field='Id' AND p_sort_order='ASC'  THEN IR.ID end,
       CASE  WHEN p_order_by_field='Id' AND p_sort_order='DESC'  THEN IR.ID end DESC,
       CASE  WHEN p_order_by_field='Date' AND p_sort_order='ASC'  THEN TO_CHAR(IR.IDATE, 'MM/dd/yyyy') end,
       CASE  WHEN p_order_by_field='Date' AND p_sort_order='DESC'  THEN TO_CHAR(IR.IDATE, 'MM/dd/yyyy') end DESC; 
```

问题是排序是基于字符完成的，这对于日期大小写是错误的。但是，CASE 语句不允许除 char 之外的任何其他数据类型。那么在这种情况下有什么解决方案呢？我需要能够将 p_order_by_field 传递到存储过程中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:59:30.110

应该很简单 - 只需在您的情况下使用 ISO 日期格式：

```
TO_CHAR(IR.IDATE, 'yyyy-mm-dd') 
```

你应该没事。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-08T07:32:22.847

当您想要对日期差异进行排序时（比如说两天之间的天数），可能会出现另一个问题。

例如，这样的排序将在 9（天）之前返回数字 13（天）。

解决方案是将日期差异的长度和差异本身连接起来：

```
length(trunc(date2) - trunc(date1)) || to_char(date2 - date1) 
```

# python - 如何使用 Python 在 Rhythmbox 中获取当前正在播放的歌曲

> ID：11939856
> 
> 赞同：4
> 
> 时间：2012-08-13T18:09:15.000
> 
> 标签：python, dbus, rhythmbox

我使用的是 Ubuntu 12.04。我想使用 Python 访问 Rhythymbox。

到目前为止，我是这样进行的：

我已经浏览了这个网站 [https://live.gnome.org/RhythmboxPlugins/WritingGuide](https://live.gnome.org/RhythmboxPlugins/WritingGuide)，但它提供了如何编写插件的详细信息，我现在对此不感兴趣。我已经阅读了一些教程，告诉我这样做。

```
import dbus
session_bus = dbus.SessionBus()

proxy_obj = session_bus.get_object(
'org.gnome.Rhythmbox', '/org/gnome/Rhythmbox/Player') 
```

但我收到以下错误

```
DBusException: org.freedesktop.DBus.Error.ServiceUnknown: The name org.gnome.Rhythmbox was not provided by any .service files. 
```

有人可以指出我想要实现的正确方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:42:27.280

[歌词下载器.py](http://code.google.com/p/lyricsdownloader/)使用的解决方法是：

```
import subprocess
import shlex

proc = subprocess.Popen(shlex.split('rhythmbox-client --no-start --print-playing-format %tt')))
title, err = proc.communicate() 
```

注意：这不适用于 Ubuntu 11.10，它没有带节奏盒客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T20:45:46.000

这可能很有用。[https://github.com/aliva/rhythmbox-microblogger](https://github.com/aliva/rhythmbox-microblogger)

它是 RhythmBox 的推特插件。因此，您可以直接获取当前歌曲，而不是 twitter 和 Gtk。

```
from gi.repository import RB 
```

`RB.RhythmDBPropType.TITLE`将给出可用于获取标题的枚举。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:04:18.140

我认为您在[Launchpad](https://bugs.launchpad.net/audio-recorder/+bug/968994)上描述的 Rhythmbox DBus 界面中遇到了错误。Tracker 表示已提交修复，但可能您的版本没有该修复。

# c# - 比较 byte[] 和 T

> ID：11939857
> 
> 赞同：5
> 
> 时间：2012-08-13T18:09:32.610
> 
> 标签：c#, generics

我想创建一个指向位置的指针列表，该位置包含另一个进程的进程内存中的某个值。该值可以是 short、int、long、string、bool 或其他值。

我的想法是为此使用泛型。我有一个问题，我怎么能告诉编译器他需要什么类型来转换字节数组？

这是我做的：

```
 public List<IntPtr> ScanProccessFor<T>(T ItemToScanFor)
    {
        List<IntPtr> Output = new List<IntPtr>();

        IntPtr StartOffset = SelectedProcess.MainModule.BaseAddress;
        int ScanSize = SelectedProcess.MainModule.ModuleMemorySize;

        for (int i = 0; i < ScanSize; i++)
            if (ReadMemory(SelectedProcess, StartOffset + i, (UInt16)Marshal.SizeOf(ItemToScanFor)) == ItemToScanFor)
                Output.Insert(Output.Count,StartOffset + i);

        return Output;
    } 
```

我如何告诉编译器他需要将 byte[] 转换为 T 类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:23:46.663

您的问题有点混乱，但我会尽力回答

我可能不会使用泛型类型，而是编写一个方法来获取接口之类的实例`IConvertableToByteArray`。

```
public IConvertableToByteArray
{    
    public byte[] ToByteArray();
} 
```

然后，如果您需要允许特定类型与该方法兼容，则可以创建一个封装类

```
public IntConvertableToByteArray : IConvertableToByteArray
{
    public int Value{get; set;}

    public byte[] ToByteArray()
    {
        insert logic here
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:24:45.210

您可以使用[Marshal.StructureToPtr](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.structuretoptr.aspx)来获取结构的非托管表示（必须是“简单”结构）。不过，您可能需要特殊情况的字符串。

您还应该考虑您正在搜索的内容的对齐限制——如果项目必须对齐 4 或 8 字节，一次通过内存 1 个字节将非常缓慢和浪费。

# python - Flask - 'NoneType' 对象不可调用

> ID：11939858
> 
> 赞同：13
> 
> 时间：2012-08-13T18:09:41.113
> 
> 标签：python, flask, werkzeug

我正在开发我的第一个 Flask 应用程序。直接从中取出一些代码[，](http://flask.pocoo.org/docs/patterns/deferredcallbacks/#deferred-callbacks)我试图确保用户的 cookie 中存在一个值。

```
def after_this_request(f):
    if not hasattr(g, 'after_request_callbacks'):
        g.after_request_callbacks = []
    g.after_request_callbacks.append(f)
    return f

@app.after_request
def call_after_request_callbacks(response):
    for callback in getattr(g, 'after_request_callbacks', ()):
        response = callback(response)
    return response

@app.before_request
def detect_unique_id():
    unique_id = request.cookies.get('unique_id')
    if unique_id is None:
        unique_id = generate_unique_id()
        @after_this_request
        def remember_unique_id(response):
            response.set_cookie('unique_id', unique_id)
    g.unique_id = unique_id 
```

我不断收到此错误：

```
Traceback (most recent call last):
  File "/..../env/lib/python2.7/site-packages/flask/app.py", line 1701, in __call__
    return self.wsgi_app(environ, start_response)
  File "/..../env/lib/python2.7/site-packages/flask/app.py", line 1690, in wsgi_app
    return response(environ, start_response)
TypeError: 'NoneType' object is not callable 
```

我试图了解此错误的原因。请帮忙。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-13T18:54:04.937

## 问题

`remember_unique_id`不返回响应对象，而是`call_after_request_callbacks`将调用通过`after_this_request`装饰器添加的每个回调的结果分配给`result`然后返回。也就是说：

```
# This
for callback in getattr(g, 'after_request_callbacks', ()):
    response = callback(response)

# translates to this
for callback in [remember_unique_id]:
    response = callback(response)

# which translates to this
response = remember_unique_id(response)

# which translates to this
response = None 
```

## 解决方案

任何一个：

*   更新`remember_unique_id`以返回修改后的响应对象
*   更新`call_after_request_callbacks`以检查返回的对象并确保它不是 None：

    ```
    for callback in getattr(g, 'after_request_callbacks', ()):
        result = callback(response)
        if result is not None:
            response = result 
    ```

## 为什么会这样？

Flask 是一个 WSGI 应用程序，它期望`response`成为一个 WSGI 应用程序（即，一个可调用对象）。当它处理来自视图模板的响应时，它会运行一些检查以确保它可以用作响应对象，如果返回的值不是 WSGI 应用程序，它会将其转换为一个。它不*检查*响应对象是否未被`after_request`装饰器更改，因此当它尝试调用响应对象（此时假定它是有效的 WSGI 应用程序）时，您会得到`TypeError`.

# php - GET / POST方法无法使用json从mysql数据库获取数据到html

> ID：11939861
> 
> 赞同：1
> 
> 时间：2012-08-13T18:09:47.860
> 
> 标签：php, mysql, json, html

我正在尝试在 和 的帮助下使用方法从 mysql 数据库中获取 html 页面中的`GET/POST`数据。场景是我从用户界面 ( ) 中获取两个值并将其发布到从使用中获取数据的位置。我的是`json``Jquery``searchtenant.html``newterms2.html``newterms2.html``tenantlistmob2.php``JSON``searchtenant.html`

```
<!DOCTYPE HTML>
<html>
<body>
<form action="newterms2.html" method="post">
First Name:<input type="text" id="fname" name="fname" placeholder="First Name" required="required"/><br /><br />
Last Name: <input type="text" id="lname" name="lname" placeholder="Last Name" required="required"/><br /><br />
<input type="submit" id="save" name="search" value="Search"/>
</form>
</fieldset>
</body>
</html> 
```

我`tenantlistmob2.php`的是

```
<?php 
include('connection.php');
$fname = $_POST['fname'];
$lname = $_POST['lname'];
$result = mysql_query("SELECT * FROM `tenanttemp` WHERE `TenantFirstName`='$fname' and `TenantLastName`='$lname'");
//$result = mysql_query("SELECT * FROM `tenanttemp`");
while ($row = mysql_fetch_assoc($result)) 
{
 $array[] = array($row['TenantFirstName']);
 }
echo json_encode($array);
?> 
```

我`newterms2.html`的就像

```
<!DOCTYPE HTML>
<html>
<head>
<script type="text/javascript" src="myjquery.js"></script>
<script type="text/javascript" language="javascript">
$(document).ready(function() { 
    jQuery.getJSON("tenantlistmob2.php", function (jsonData) {
            jsonData= eval(jsonData);//get json array
            for (i = 0; i < jsonData.length; i++)//iterate over all options
            {
              for ( key in jsonData[i] )//get key => value
              { 
                   var tblRow = "<tr>" + "<td>" + "<a href='#'>" + jsonData[i][key] + "</a>" + "</td>" + "</tr>"
                    $(tblRow).appendTo("#getname tbody");
              }
            }

   });

   });
  </script></head>
 <body>
 <form name="index">
 <div id="getname2"></div>
 <div>
 <table id="getname" border="1">
    <thead>
        <th>Name</th>
    </thead>
  <tbody>

   </tbody>
</table>
</div>
</form>
</body>
</html> 
```

这是总场景。如果我`tenantlistmob2.php`直接从`searchtenant.html`using`POST`方法调用它工作正常。但我需要 html 页面来显示数据，因为我将使用这个 html 页面`android`和`iPhone`. 查询（`$result = mysql_query("SELECT * FROM tenanttemp");`）工作正常并正确返回`newterms2.html`。但是当我使用`POST`ed data（`$result = mysql_query("SELECT * FROM tenanttemp WHERE TenantFirstName='$fname' and TenantLastName='$lname'");`）时，它在 php 中正常工作，但没有将数据返回到`newterms2.html`页面。

解决办法是什么？我喜欢在 html 页面中获取数据。请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T08:08:48.673

您将表单数据从 searchtenant.html 发布到 newterms2.html 而不是tenantlistmob2.php。

*   jQuery/Javascript 无法处理发送到页面的 POST 数据。
*   jQuery.getJSON 使用 GET，而不是 POST。

您需要做的是将 newterms2.html 更改为一个 PHP 页面，该页面可以使用来自 searchtenant.html 的 POST 数据并将其用于 ajaxrequest。

**newterms2.php 中的 Javascript 更改**

```
<script type="text/javascript">

    $(document).ready(function() { 
        $.ajax({
            url: 'tenantlistmob2.php',
            dataType: 'json',
            data: <?php echo 'fname='.$_POST['fname'].'&lname='.$_POST['lname']; ?>,
            type: 'POST',
            success: function(jsonData){
                jsonData = eval(jsonData); //get json array
                for (i = 0; i < jsonData.length; i++)//iterate over all options
                {
                    for ( key in jsonData[i] )//get key => value
                    { 
                        var tblRow = "<tr>" + "<td>" + "<a href='#'>" + jsonData[i][key] + "</a>" + "</td>" + "</tr>"
                        $(tblRow).appendTo("#getname tbody");
                    }
                }
            }
        });
    }
</script> 
```

这应该够了吧。

# ruby-on-rails - 命名路由 _path 与 _url

> ID：11939865
> 
> 赞同：118
> 
> 时间：2012-08-13T18:10:12.537
> 
> 标签：ruby-on-rails

Rails 提供[命名路由](http://api.rubyonrails.org/classes/ActionDispatch/Routing.html)。

可以使用路径或 url 调用路由助手

例如来自文档：

```
# and provide these named routes
root_url   # => 'http://www.example.com/'
root_path  # => '/' 
```

坦率地说，我还没有使用过`*_url`helper，我能够使用`*_path`.

我有点困惑这两个不同的助手的目的是什么？

它们彼此有何不同？

一些真实的例子，解释何时使用什么会很棒。

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-08-13T18:16:33.237

`_path`助手提供了一个站点根相对路径。您可能应该在大多数情况下使用它。

`_url`helpers 提供一个绝对路径，包括协议和服务器名称。我发现在服务器上创建指向应用程序的链接时，我主要在电子邮件中使用这些。它们应该主要在提供外部使用的链接时使用。（想想电子邮件链接、RSS 以及 YouTube 视频“分享”部分下的复制和粘贴 URL 字段等内容。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-13T18:14:11.927

当您在自己的站点中放置链接时，路由的域部分是多余的，并且会增加页面大小，因此您可以将 URL 的路径部分与`*_path`helper 一起使用。另一方面，如果要在您的站点之外使用 URL，例如电子邮件或 RSS 提要，则需要整个 URL，因此请使用`*_url`帮助程序。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-11-24T21:35:32.700

正如其他答案所解释的那样，您应该`_url`在电子邮件链接等中使用。但我想补充一点，您还应该`_url`在重定向中使用，如下所述：

[https://www.ruby-forum.com/topic/101346#221052](https://www.ruby-forum.com/topic/101346#221052)

和这里：

[http://viget.com/extend/rails-named-routes-path-vs-url](http://viget.com/extend/rails-named-routes-path-vs-url)

您还可以在此处查看 HTTP 规范的相关部分：

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-13T11:41:25.503

_path 提供相对路径。

_url 提供绝对路径。

每当您通过电子邮件等发送 URL 时，最好使用 _url 而不是 _path。

# java - 默认字段 - Java-JDBC

> ID：11939870
> 
> 赞同：1
> 
> 时间：2012-08-13T18:10:19.343
> 
> 标签：java, sql-server, jdbc

我正在从一个数据库表中读取数据并将相同的数据写入另一个数据库表。现在，如果源中的日期字段没有任何数据 ( `null`)，那么当它被写入目标表时 - 相同的字段默认为日期“1/1/1900”。我没有在我的程序的任何地方设置这个默认值。不知道为什么会这样。

知道如何防止这种情况发生，而不是检查每个字段的`null`值并将其设置为不同的值吗？

我正在使用 Eclipse 和 SQL Server 数据库。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:20:33.157

一种可能性是日期列的默认值实际上设置为“1/1/1900”。如果是这样，请使用 SQL ALTER TABLE 删除此默认值。SQL Server 的语法是：

```
ALTER TABLE Table1 ALTER COLUMN DateColumn1 DROP DEFAULT 
```

**更新：**看起来这个日期是开箱即用的默认日期，请尝试设置：

```
ALTER TABLE Table1 ALTER COLUMN DateColumn1 DATETIME NULL 
```

这里有一些重要的注意事项：

1.  在开始更改表之前备份数据库（！）
2.  在 ALTER 命令中使用相同的数据类型（例如 DATETIME）。

# php - 为什么我的 Dropbox 中的值没有插入到我的数据库中？

> ID：11939871
> 
> 赞同：0
> 
> 时间：2012-08-13T18:10:24.093
> 
> 标签：php, mysql, drop-down-menu

我有一个正在编写的脚本，但我遇到了一个问题。我无法从保管箱获取信息以提交到 MySQL 数据库。

除 Dropbox 中的项目外，所有内容都将显示在数据库中。

这是我的代码：

```
<form action="work.php" method="post">

<table>
<tr>
<td>Email:</td>
<td><input type="text" name="Email" tabindex="1" />
</td>
</tr>

<tr>
<td>Messgae:</td>
<td><textarea name="Message" 
rows = "7"
cols = "35"
tabindex = "2" /></textarea>
</td>
</tr>

<tr>
<Td>Time</td>

<td>
<select name="hour" tabindex="3">
<option value="1">1AM</option>
<option value="2">2AM</option>
<option value="3">3AM</option> 
<option value="4">4AM</option>
<option value="5">5AM</option>
<option value="6">6AM</option>
<option value="7">7AM</option>
<option value="8">8AM</option>
<option value="9">9AM</option>
<option value="10">10AM</option>
<option value="11">11AM</option>
<option value="12">12PM</option>
<option value="13">1PM</option>
<option value="14">2PM</option>
<option value="15">3PM</option>
<option value="16">4PM</option>
<option value="17">5PM</option>
<option value="18">6PM</option>
<option value="19">7PM</option>
<option value="20">8PM</option>
<option value="21">9PM</option>
<option value="22">10PM</option>
<option value="23">11PM</option>
<option value="24">12AM</option>
</select><br>
<input type="submit" name="formSubmit" value="Submit" >
</form> 
```

然后是 work.php

```
<?php
$time = $_POST['hour'];
$email1 = $_POST['Email'];
$message1 = $_POST['Message'];

mysql_connect ('localhost', 'myuser', 'mypassword') or die ('Error: ' .mysql_error());
mysql_select_db ("mydatabase");

$query="INSERT INTO Reminder (Email, Message, Time)
VALUES
('$email1','$message1','$time')";
mysql_query($query) or die ('Error submitting');

echo "You Chose: " .$time ;

?> 
```

# sql - SSIS - 在同一个包中使用错误重定向输出

> ID：11939873
> 
> 赞同：0
> 
> 时间：2012-08-13T18:10:52.057
> 
> 标签：sql, sql-server-2008, ssis

我有一个问题，我想在纠正错误后在同一个包中使用重定向的错误输出文件或表。假设我有输入文件，其中包含我在重定向错误输出文件/表中得到的错误行，然后我将手动更正所有错误记录，然后当我运行相同的包时，它将自动检测错误记录并处理所有错误其他记录正常处理。

请提出一些可以做这件事的机制。

请提出建议和指导。

问候， 史密斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:20:10.690

使用 a`Lookup`查找行是否存在于目标表中。假设有错误行，并且 50% 的数据从平面文件插入到目标表中。现在，当您再次运行包时，在平面文件中更正错误行后，查找组件将只插入数据目标表中没有任何匹配项。

将 OLEDB 目的地连接到您的`lookup matched`输出，并将 OLEDB 命令连接到您的`lookup No Matched Output`

参考这篇[文章](http://www.simple-talk.com/sql/ssis/implementing-lookup-logic-in-sql-server-integration-services/)1和[ararticle2](http://www.ssistalk.com/2009/09/04/ssis-lookup-cache-modes-full-partial-none/)

# sql - 条件列选择

> ID：11939876
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:03.983
> 
> 标签：sql, sql-server

我对编程非常陌生，可以在项目中使用手。我有一张大约有 20 列左右的表。我需要评估大约 15 个具有数字属性的列并返回值不为零的记录。前 5 列是我将一直需要的描述性文本字段。如果具有数字属性的列没有数量不为零的记录，我不想显示该列。具有非零值的所有列必须显示在相同的结果中。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T23:22:09.187

您最好的选择可能是使用 UNPIVOT 查询将这些数字字段中的每一个作为一行返回。所以你的结果集看起来像这样：

```
Desc1 Desc2 Desc3 Desc4 Desc5 NumFieldName NumFieldValue
blah1 blah1 blah1 blah1 blah1 Stat1        13
blah1 blah1 blah1 blah1 blah1 Stat2        22
blah1 blah1 blah1 blah1 blah1 Stat3        6
blah2 blah2 blah2 blah2 blah2 Stat1        3
blah2 blah2 blah2 blah2 blah2 Stat2        42
blah2 blah2 blah2 blah2 blah2 Stat3        12 
```

然后，您可以过滤该结果以排除 NumFieldValue 为 0 的行。这是运行 UNPIVOT 查询的文档：http: [//archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx? title=UNPIVOTData](http://archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=UNPIVOTData)

如果您在编写该查询时需要一些帮助，请发布有关您的表结构的一些详细信息，我会看看。

# html - 调整窗口大小时渐变用完

> ID：11939883
> 
> 赞同：2
> 
> 时间：2012-08-13T18:11:22.230
> 
> 标签：html, css

我有一个运行页面高度的 CSS 渐变：

```
html {
    font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, sans-serif;
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#e5fcc2), color-stop(47%,#ecfdd2), color-stop(100%,#fafef3));
    background-image: -moz-linear-gradient(#e5fcc2, #fafef3);
    background-repeat: no-repeat;
    height: 100%;
} 
```

然而由于某种原因，当我调整窗口大小时，特别是当我把它变小时，页面底部有一个大的白色区域，渐变用完了。当窗口很长时，我没有这个问题。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:37:26.620

想通了。

需要设置适用`min-height: 100%`于 Chrome 21、FF 12 和 Safari 6`background-repeat: no-repeat;`的。我也有`html`。

# html - 使用 :before （或类似的）在 LI 之前插入动态彩色图标

> ID：11939884
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:22.477
> 
> 标签：html, css

我有一个相当复杂的问题。我有一个 UL，里面有许多 LI。

我需要在 LI 元素之前插入各种图标。

图标需要由两部分组成，一个具有简单形式的 PNG 图像，一个具有动态背景颜色的外部形状。

具体来说，它应该是一个圆形，里面有一个简单的图标。圆圈背景需要能够随代码改变。

我现在解决它的方法是在 LI 元素中使用 SPAN 并设置：

```
height: 20px;
width: 20px;
background: url(icon.png) 2px 2px no-repeat red;
border-radius: 20px 
```

问题是我必须在每个 LI 中放置一个 SPAN，这不是一个选择。我需要以某种方式解决这个问题，所以我有一个“干净的”UL，里面只有 LI。

这就是我现在所拥有的：

```
<ul>
<li><span></span>Some text</li>
</ul> 
```

虽然里面除了 LI 和文本之外不能有任何其他元素，所以我需要它看起来像这样：

```
<ul>
<li>Some text</li>
</ul> 
```

任何帮助表示赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:52:48.130

我会使用css精灵。 [http://jsfiddle.net/mCGXv/](http://jsfiddle.net/mCGXv/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:01:07.910

使用 CSS 精灵。

当你在左边添加一个图标时`li`，一定要增加 的`padding-left`，`li`你应该没问题。我附上了一个可以帮助你的资源。

[http://www.electrictoolbox.com/add-icon-before-after-link-css/](http://www.electrictoolbox.com/add-icon-before-after-link-css/)

# sql - SAS：选择多列值的频率

> ID：11939886
> 
> 赞同：3
> 
> 时间：2012-08-13T18:11:29.980
> 
> 标签：sql, sas, proc-sql

我有[这个](https://stackoverflow.com/questions/9050481/selecting-the-frequency-of-a-result-that-could-appear-in-multiple-columns-sql)问题，但是在 SAS 中。要使用此问题中提供的示例，我有 5 列名称（name_1、name_2 等），并希望输出一个列表，其中名称按频率降序排列：

```
John     502
Robert   388
William  387
...
...       1 
```

我回答了上面提到的问题，并用“proc sql;”包围了它。和“退出；”：

```
proc sql;
create table freqs as
SELECT name, COUNT(1)
FROM (           SELECT name_1 AS name FROM mytable
     UNION ALL SELECT name_2 AS name FROM mytable
     UNION ALL SELECT name_3 AS name FROM mytable
     UNION ALL SELECT name_4 AS name FROM mytable
     UNION ALL SELECT name_5 AS name FROM mytable
   ) AS myunion
 GROUP BY name
 ORDER BY COUNT(1) DESC
;
quit; 
```

但我得到：

```
ERROR: Summary functions are restricted to the SELECT and HAVING clauses only. 
```

我正在使用 SAS 9.2。

想法？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:18:57.910

您只需要更改 ORDER BY 表达式即可引用第二列。我还建议您将 COUNT 表达式结果分配给 SAS 变量名（可能是“freq”）：

```
proc sql; 
   create table freqs as 
   SELECT name
        , COUNT(*) as freq
   FROM (
      SELECT           name_1 AS name FROM mytable
      UNION ALL SELECT name_2 AS name FROM mytable
      UNION ALL SELECT name_3 AS name FROM mytable
      UNION ALL SELECT name_4 AS name FROM mytable
      UNION ALL SELECT name_5 AS name FROM mytable
      ) AS myunion  
   GROUP BY name
   ORDER BY freq DESC;
quit; 
```

仅供参考：你也可以说`ORDER BY 2 DESC`给出一个相对的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:15:53.877

Proc SQL 不允许在 order by 中使用 count(1)。试试这个：

```
proc sql;
    create table freqs as
        SELECT name, COUNT(1) as freqs
        FROM (SELECT name_1 AS name FROM mytable UNION ALL
              SELECT name_2 AS name FROM mytable UNION ALL
              SELECT name_3 AS name FROM mytable UNION ALL
              SELECT name_4 AS name FROM mytable UNION ALL
              SELECT name_5 AS name FROM mytable
             ) AS myunion
         GROUP BY name
         ORDER BY 2 DESC ;
 quit; 
```

我认为它允许列引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:13:26.617

如果数据集不是太大，以下方法也可以工作：

```
data mytable;
 input (name1-name5) (: $17.) @@;
 cards;
 john henry bob jerry james gary bill john mark gabe
 ;
run;

proc sql;
select 'do name = '
||catq("A2SC", name1,name2,name3,name4,name5)
||'; output; end;' into : nlist separated by ' ' from mytable
 ;
quit;

data test;
&nlist
Run;

proc freq order = freq;
tables name;
run; 
```

# java - Java：抛出异常可以抛出异常吗？

> ID：11939889
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:33.390
> 
> 标签：java, exception

抛出异常的行为是否有可能改为抛出不同的异常？

为了抛出异常，必须（可选）分配新对象，并调用其构造函数（隐式调用 fillinstacktrace）。在某些情况下，听起来 addSupressed 也被调用了。那么如果内存不够怎么办？JVM 是否需要预先分配内置异常？例如，(1/0) 是否会抛出 OutOfMemoryError 而不是 ArithmeticException？

此外，构造函数是一个方法调用，因此可以自由抛出其他异常。在这种情况下会发生什么？内置异常会抛出吗？即使您没有明确抛出，似乎也有可能获得 StackOverflowError。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:14:51.830

```
public class MyStupidException extends Exception {
  public MyStupidException() {
    throw new RuntimeException("whoooo");
  }
}
public static void main(String... args) throws Exception {
  throw new MyStupidException();
} 
```

印刷：

> 线程“主”java.lang.RuntimeException 中的异常：whoooo

所以，是的:-)

在内置异常的情况下，有很多事情可能会出错。我不相信规范要求 JVM 来保证异常分配成功，所以这`OutOfMemoryError`听起来像是一种明显的可能性。还有一些更模糊的问题，例如类加载失败，可能会发生。我们还可以进入彻头彻尾的深奥，其中有人进行了修改`java.lang.Exception`以导致异常或错误抛出。

因此，我的意见是，您应该期望/计划在极少数情况下，异常处理本身可能会导致异常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T18:14:26.777

如果没有足够的空间来创建`ArthimeticException`对象，它会通过，`OutofMemoryError`因为JVM除了退出进程之外没有其他方法可以继续。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:27:24.973

你可以得到

```
Error err = null;
throw err; // triggers a NPE. 
```

或者

```
// use up almost all the memory
throw new RuntimeException(); // throws OutOfMemoryError instead. 
```

# javascript - 文本更改 javascript 在测试中有效，但在实际站点中无效

> ID：11939890
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:34.000
> 
> 标签：javascript, html

在我网站的测试页面中，这个 js 的文本更改位可以完美运行，但是当我将它带入实际站点时，底部的链接都不起作用。

完全实现的想法是在页面底部有一个导航栏，为页面内容生成 HTML 代码。实际内容本身隐藏在 javascript 字符串中，直到需要为止。然后它被放到页面上的预定位置。

```
<html>
<head>
<title>Javascript Test #9</title>
<script type="text/javascript">
    window.onload = function() {
        document.getElementById("workl").onclick=workf;
        document.getElementById("aboutl").onclick=aboutf;
        document.getElementById("contactl").onclick=contactf;
        document.getElementById("quote").onclick=quotationf;        
    }

    function workf(){
        document.getElementById("para").innerHTML="Primary Changed Paragraph Content";
        quotationf("changed quote content");
        return false;
    }
    function aboutf(){
        document.getElementById("para").innerHTML="Secondary Changed Paragraph Content<br><br><br>";
        quotationf("changed quote content");

        return false;
    }       
    function contactf(){
        document.getElementById("para").innerHTML="Tertiary Changed Paragraph Content";
        quotationf("changed quote content");

        return false;
    }
    function quotationf (input){
        document.getElementById("quote").innerHTML=input;
        return false;
    }

</script>
</head>
<body>

    <p id="quote"> quote content</p>
    <p id="para">Unchanged Paragraph Content</p>    <br>
<a id="workl" href="#"> Click here to change the paragraph content </a><br>
<a id="aboutl" href="#"> Click here to change the paragraph content </a><br>
<a id="contactl" href="#"> Click here to change the paragraph content </a>

</body>
</html> 
```

代码不起作用在这里：[http ://theblankframe.com/tempmobile/index.html](http://theblankframe.com/tempmobile/index.html)

工作测试在这里：[http ://theblankframe.com/tempmobile/test2.html](http://theblankframe.com/tempmobile/test2.html)

任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:15:26.670

在生产站点上，我看到了错误

> SCRIPT5007：无法设置属性“onclick”的值：对象为空或未定义

在代码行

```
document.getElementById("workl").onclick=workf; 
```

在测试站点上，您定义一个ID*为 workl的**A标签*

 *```
<a id="workl" href="#"> Click here to change the paragraph content </a> 
```

但是，您没有在生产站点上定义这样的标签。

您在生产中的 JavaScript 尝试通过 ID 获取不存在的 ID 的元素，然后对该元素调用无法找到的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:23:30.000

问题出在这里

```
window.onload = function() {
document.getElementById("workl").onclick=workf; // << error thrown here
document.getElementById("aboutl").onclick=aboutf; //<< aboutl doesnt exist too
document.getElementById("contactl").onclick=contactf;
document.getElementById("quotet").onclick=quotationf;
} 
```

没有具有 id 的元素，`workl`因此在对象上附加处理程序`null`会引发错误，`document.getElementById("workl").onclick=workf;`并且脚本的其余部分会失败

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:23:39.687

@在生产中没有 ID 为“workl”的元素。

一个好的做法是验证 getElementById 是否返回有效的东西。

```
if(document.getElementById("workl")){
   document.getElementById("workl").onclick=workf;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:16:45.077

`work1`您需要在您的实际站点中有一个带有 id 的元素才能正常工作。这是因为代码

```
document.getElementById("workl").onclick=workf; 
```

正在寻找它找不到的那个元素。*

# grails - 如何在控制器内定义命令对象

> ID：11939891
> 
> 赞同：1
> 
> 时间：2012-08-13T18:11:39.030
> 
> 标签：grails, groovy, grails-controller

我已经开始研究命令对象作为验证没有与之关联的域的表单的一种方法。在我的研究中，我发现命令对象既可以在与我的控制器相同的包中声明，也可以在控制器类本身中声明。

但是，到目前为止，我看到的所有示例都有一个单独的命令对象类机器人，它不在控制器内部。

谁能告诉我一个示例或代码来在我的控制器本身内定义一个命令对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:22:08.843

命令对象类没有什么特别之处。您可以将它们声明为控制器中的内部类，如下所示：

```
class MyController {

    class ActionCommand {
        String paramName
    }

    def action(ActionCommand actionCommand) {
        render actionCommand.paramName
    }
} 
```

# grails - 在 Grails 中禁用版本列会影响性能吗？

> ID：11939892
> 
> 赞同：1
> 
> 时间：2012-08-13T18:11:40.210
> 
> 标签：grails

我刚刚禁用了我的一个域对象上的**版本**列。它被许多线程访问，并导致许多过时状态错误。使用此对象最多的方法似乎突然变慢了。我没有做任何测试来验证这一点，但我只是想把它扔在那里，看看禁用版本列是否会影响性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T20:57:42.893

禁用它不太可能影响性能；如果有的话，它应该让事情变得稍微快一些（但还不足以让它成为做或不做这个改变的理由）。

但是由于过时状态错误而禁用该功能可能不是正确的方法。如果您不使用显式锁定（这可能非常不高效），并发更新将导致数据丢失，因此您只是在用一个明显的修复来换取不太明显但更严重的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T21:16:39.013

There's a very good blog [post](http://mybreadbasket.blogspot.com.br/2009/11/optimistic-concurrency-control-by.html) explaining in details how pessimistic/optimistic locking works and why removing optimistic locking doesn't affect the performance of your app. But also it doesn't make performance significantly worse or causes deadlock. It usually is the way to go.

# javascript - array[array.length] = value 在 JavaScript 中完成了什么？

> ID：11939893
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:41.863
> 
> 标签：javascript, c++, arrays

我正在尝试将以下 JavaScript 代码移植到 C++：

```
var vector = new array();     
for (var i = 0; i < points.length; i++)
        {
            var newX = points[i].X * cos - points[i].Y * sin;
            var newY = points[i].Y * cos + points[i].X * sin;
            vector[vector.length] = newX;
            vector[vector.length] = newY;
            sum += newX * newX + newY * newY;
        } 
```

我似乎无法理解这些行中发生了什么：

```
vector[vector.length] = newX;
vector[vector.length] = newY; 
```

覆盖数组中相同位置的值的目的是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T18:13:53.650

JavaScript 数组动态扩展以容纳新元素，因此要追加新项目，您只需将其分配给下一个可用索引。

数组索引是从零开始的，所以给定一个名为“vector”的数组，`vector.length`它是最后一个元素的后一个。没有任何东西被覆盖；该行`vector[vector.length] = x`附加`x`到数组的末尾。

在 JavaScript 中，以下附加元素的方法是相同的，尽管使用`push`更清楚地表明了您的意图：

```
vector = [1,2,3];
vector[vector.length] = 4; // [1,2,3,4]
vector.push(5); // [1,2,3,4,5] 
```

等效的 C++ 代码（假设您正在使用`std::vector`）将

```
my_vector.push_back(newX); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:13:05.943

> 覆盖数组中同一位置的值的目的是什么？

它没有。它在末尾添加了一个元素，因此增加了`vector`.

在 C++ 中，这将转换为`push_back`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:13:03.377

`vector.length`每次分配到 后都会增加`vector[vector.length]`。

# php - 插入额外的数据来自助手

> ID：11939894
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:44.827
> 
> 标签：php, cakephp, form-helpers

如果我有这个表格：

表格---用户名邮箱密码

而且我还需要插入一个生成的唯一 ID。

此代码将用户名、电子邮件和密码保存在数据库中。我的问题是关于codeLink。

```
$user_arr = $this->request->data;
$this->User->save($user_arr) 
```

还有另一种（简单的）方法，或者我应该做这样的事情？

```
$username = $user_arr['User']['username'];
$email = $user_arr['User']['email'];
$password = $user_arr['User']['password'];
$codeLink = uniqid();

$user_arr = array('User'=>array('username'=>$username, 'email'=>$email, 'password'=>$password, '$code'=>$codeLink)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:18:44.670

您可以在将值传递给模型之前将值注入到 post 数据中，如下所示：

```
$this->request->data['User']['codeLink'] = unqueid(); // <-- this line
$this->User->create($this->request->data);
if ($this->User->save()) {
} else {
} 
```

不过，这类事情应该转移到模型中。

```
class User extends AppModel {

    public function register($data) {
        $data[$this->alias]['codeLink'] = uniqueid();
        $this->create($data);
        return $this->save();
    }

}

// your controller

if ($this->User->register($this->request->data) {}... 
```

# android - 从 code.google.com 获取代码示例的问题

> ID：11939897
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:49.110
> 
> 标签：android

我是 android 新手，当我找到帖子并且作者喜欢我应该能够下载示例代码的地方时，我遇到了一个重复的问题。最新示例是以下 URL，其中有一篇关于如何使用 ViewPager 的帖子：

[http://geekyouup.blogspot.com/2011/07/viewpager-example-from-paug.html](http://geekyouup.blogspot.com/2011/07/viewpager-example-from-paug.html)

作者有一个指向以下页面的链接，我应该可以在其中下载示例代码：

[http://code.google.com/p/viewpagerexample/](http://code.google.com/p/viewpagerexample/)

但是这个位置没有代码。

这种情况一遍又一遍地发生。事实上，每次我找到作者指向 code.google.com 的帖子时，我都会得到一个空白页面。我究竟做错了什么？

加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:15:29.760

SDK 中包含代码示例。您可以[使用 SDK 管理器安装它们](http://developer.android.com/sdk/installing/adding-packages.html)，然后在`<<android SDK dir>>/samples/<<version>>/`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:16:27.777

该代码很容易在您链接到的站点上获得。[这](http://code.google.com/p/viewpagerexample/source/browse/#svn/trunk/AwesomePager%253Fstate%253Dclosed)是一个更准确的链接。

您还可以使用 svn 命令检查整个代码：

```
svn checkout http://viewpagerexample.googlecode.com/svn/trunk/ viewpagerexample-read-only 
```

但是，您必须安装[svn](http://subversion.tigris.org/)才能这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:17:53.590

请睁开眼睛：）

单击选项卡中的链接源，然后您可以签出代码。如果你懒得这样做，你可以点击浏览链接，然后转到主干文件夹，然后按照项目的树状结构，你可以通过简单的复制/粘贴来复制类的代码。

# php - 合并用于 XLS 导出的匹配 MySql 结果

> ID：11939902
> 
> 赞同：0
> 
> 时间：2012-08-13T18:11:59.757
> 
> 标签：php, mysql

因此，我正在为电子商务网站添加 XLS 导出以生成销售报告。

我已经从第一个表中很好地导出了它`Orders`。

我的问题是我还想添加产品详细信息 ModelNum 和 Quantity ，它们分别存储在另一个表中`OrderItemDetails`

我可以使用 INNER JOIN 检索此信息，但它会重复所有订单信息。

我想做的不是在 xls 中为每个产品 ModelNum 和 Qty 创建一个新行，而是我想将所有产品结果合并到一列中。例如 ModelNum1(3),ModelNum2(1)

我用来生成 XLS 文件的脚本需要一个 var 中的 select 语句。

例如

```
$q = "SELECT o.Date AS Date,o.AccountID AS AccountID, o.Status AS Status, d.ModelNumber AS ModelNumber, d.Quantity AS Quantity
FROM Orders AS o
INNER JOIN OrderItemDetails AS d
  ON o.ID = d.OrderID   
  WHERE o.Status = 'Paid'
  AND a.Type ='Shipping'
  ORDER BY o.Date ASC"; 
```

所以我的问题是“有没有办法将匹配结果合并到一列中？” 我应该使用除 INNER JOIN 之外的东西吗？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:35:50.890

看看 group_concat 函数。

# c++ - 使用虚拟继承链接 C++ 构造函数

> ID：11939905
> 
> 赞同：2
> 
> 时间：2012-08-13T18:12:08.587
> 
> 标签：c++, constructor

在 C# 中跨继承链接构造函数非常方便且有用。在 C++ 中实现类似功能的最佳方法是什么？这就是我想表达的：

```
struct A
{
    A(int p)
    {
        i = p;
    }

    int i;
};

struct B : virtual A
{
    B(int q) : A(q)
    {
    }
};

struct C : virtual B
{
    C(int r) : B(r) // call B::B() which in turn would call A::A()
    {
    }
}; 
```

有任何想法吗？

干杯，查理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:23:16.757

最派生类（即`C`）负责构造所有虚拟基类。因此，`C`可以同时初始化`A`和`B`：

```
C(int r) : A(r), B(r) 
```

请注意，虚拟基类在任何非虚拟基类之前初始化。没有办法`B`初始化虚拟基类`A`。

你可以一起破解一些东西，例如通过使虚拟基础`A`默认可构造然后给它一个`B`可以在其构造函数中调用的“初始化”方法，但这样做可能会被证明是危险的。当`B`为基类子对象调用构造函数时`B`，它无法知道`C`虚拟派生自的其他基类是否`A`已经初始化（并且可能已经使用过`A`），或者它是唯一将要执行的类尝试初始化`A`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:24:12.093

在 C++ 中，虚拟继承需要最派生类型的构造函数显式调用所有虚基的构造函数：

```
C( int r ) : A(r), B(r) {} 
```

虽然您已明确声明*需要*虚拟继承，但使用虚拟继承并不常见，因此您可能需要解释用例。可能存在不需要这个的替代方案，因此将允许构造函数的*链接*。

* * *

如果您想知道最派生类型需要调用构造函数，原因是`virtual`继承意味着完整对象中只有一个这样的基。现在，如果您考虑可能的关系：

```
struct base { base( int x ); /*...*/ };
struct d1 : virtual base {
   d1() : base(1) {}
// ...
};
struct d2 : virtual base {
   d2() : base(2) {}
// ...
};
struct final : d1, d2 {}; 
```

应该将什么值传递给`base`inside的单个实例的构造函数`final`？两个不同的继承路径传递了冲突的值，但只有一个对象需要初始化。即使不同的调用没有冲突，使用单独的编译模型，编译器也无法知道这一点，因此唯一的选择是完整的对象*决定*如何初始化虚拟基。

# javascript - 永远不会调用 HttpServletRequestWrapper 覆盖

> ID：11939906
> 
> 赞同：1
> 
> 时间：2012-08-13T18:12:19.553
> 
> 标签：javascript, json, servlets

我有一个简单的 JSON 清理过滤器/RequestWrapper（内容类型是`application/json`）。`getReader(), getInputStream(), getParameter*()`但是，在我的包装器中没有调用任何重要的覆盖 ( )。

这是我的过滤器：

```
public class MyFilter implements Filter 
{

    public MyFilter()
    {
        //Empty
    }

    @Override
    public void init(final FilterConfig filterConfig) throws ServletException
    {
        //Empty
    }

    @Override
    public void doFilter(final ServletRequest request, final ServletResponse response, final FilterChain chain)
            throws IOException, ServletException
    {
        HttpServletRequest httpRequest = (HttpServletRequest)request;
        HttpServletResponse httpResponse = (HttpServletResponse)response;
        MyRequestWrapper wrappedRequest = new MyRequestWrapper(httpRequest);

        chain.doFilter(wrappedRequest, httpResponse);
    }

    @Override
    public void destroy() 
    {
        // TODO Auto-generated method stub

    }
} 
```

这是我的包装：

```
public class MyRequestWrapper extends HttpServletRequestWrapper
{
    private HttpServletRequest servletRequest;

    public MyRequestWrapper(HttpServletRequest servletRequest) 
    {
        super(servletRequest);
        this.servletRequest = servletRequest;
    }

    @Override
    public String[] getParameterValues(String parameter)
    {
        String[] values = super.getParameterValues(parameter);

        if (values == null) 
        {
            return null;
        }

        int count = values.length;
        String[] sanitizedValues = new String[count];
        for (int i = 0; i < count; i++)
        {
            sanitizedValues[i] = sanitizeUserInput(values[i]);
        }

        return sanitizedValues;
    }

    @Override
    public String getParameter(String parameter)
    {
        String value = super.getParameter(parameter);
        return sanitizeUserInput(value);
    }

    @Override
    public ServletInputStream getInputStream() throws IOException 
    {
        return this.servletRequest.getInputStream();
    }

    @Override
    public BufferedReader getReader() throws IOException
    {
        return new BufferedReader(new InputStreamReader(this.getInputStream()));
    }

    private String sanitizeUserInput(String input) 
    {
        // ...
        return input;
    }
} 
```

我也尝试过覆盖 getParameterMap()、getHeaders() 等。一些覆盖被调用 - 但是当我的 json 发布到 servlet 时不会。过滤器链中的另一个过滤器是否有可能吞下柱体？有什么想法可以调试这个，或者有人知道会出什么问题吗？

谢谢

# php - 如何检查请求uri是否包含数组成员

> ID：11939909
> 
> 赞同：0
> 
> 时间：2012-08-13T18:12:40.327
> 
> 标签：php, arrays, url

我有一个基本的 url 结构，其中项目根据创建年份显示。所以 url.com/2012 或 url.com/2011

我创建了一个数组：`$year_array = range(2013, 2000);`

不，我需要根据当前的请求 uri 检查：

```
if (stripos($_SERVER['REQUEST_URI'], $year_array) !== false) 
```

这不起作用，但我不知道为什么。我不是php专家。刚学...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:16:38.557

你想用[`in_array`](http://php.net/in_array)

尝试

```
$uri_parts = explode('/', $_SERVER['REQUEST_URI']);
if (count($uri_parts) && in_array($uri_parts[0], $year_array)) {
  ..
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:17:44.823

您可以在 url 中命名参数，例如

`url.com?year=2011`

除非你当然使用`modrewrite`

然后你可以从 url 得到年份

`$year = $_GET['year']`;

然后使用 php 函数[in_array](http://uk.php.net/in_array "in_array")来查看那一年是否在你的`$year_array`

```
if (in_array($year, $year_array)) {
    //Do your thing
} 
```

# ruby-on-rails - 检查控制器的方法是从真实请求还是从控制器规范调用的？

> ID：11939911
> 
> 赞同：0
> 
> 时间：2012-08-13T18:13:01.153
> 
> 标签：ruby-on-rails, ruby, testing, rspec

我有一个`Position`带有字段`started_at`和的模型`ended_at`，这两个都是`datetime`字段。因为两者的日期部分必须相同，所以我有一个`datetime_select`表单字段 for`started_at`但只有一个`time_select ignore_date: true`for `ended_at`。在`create`我想将日期值分配给这样的方法`started_at`中`ended_at`：

```
params[:position]["ended_at(1i)"] = params[:position]["started_at(1i)"]
params[:position]["ended_at(2i)"] = params[:position]["started_at(2i)"]
params[:position]["ended_at(3i)"] = params[:position]["started_at(3i)"] 
```

但这打破了我的控制器规范，因为我在那里直接分配了值：

```
describe "POST create" do
  describe "with valid params" do
    it "creates a new Position" do
      expect {
        post :create, {:position => valid_attributes}, valid_session
      }.to change(Position, :count).by(1)
    end
  end
end 
```

所以我最终得到了这个，但我不确定这是否是一个合理的修复：

```
if params[:position]["ended_at(1i)"].nil? and not params[:position]["started_at(1i)"].nil? # We have to check this because in the controller specs we assign the params directly (not in this crazy xxx_at(yi) form for dates), so by checking this we know that the data was sent through the form
  params[:position]["ended_at(1i)"] = params[:position]["started_at(1i)"]
  params[:position]["ended_at(2i)"] = params[:position]["started_at(2i)"]
  params[:position]["ended_at(3i)"] = params[:position]["started_at(3i)"]
end 
```

也许有更好的解决方案？感谢您的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:34:33.163

如果控制器需要特定格式的属性，则规范应以该格式提供它们。调整`valid_attributes`，使其以与表单相同的方式分隔日期和时间元素，并且规范应该通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T07:23:39.443

为结束日期/时间的日期和时间设置单独的列不是更容易吗？

然后有类似的东西：

**模型/位置.rb**

```
before_create :set_end_date

def set_end_date
  self[:end_date] = self[:started_at].to_date
end 
```

**规格/控制器/position_controller_spec.rb**

```
describe "POST Create" do
  describe "with valid attr" do
     it "should create a new Position" do
       lambda do
         post :create, position: valid_attributes, valid_session
       end.should change(Position, :count).by(1)
     end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T11:01:28.567

你可以检查`Rails.env.test?`

# java - 将 MySQL 数据库加载到 Java Swing 应用程序中

> ID：11939913
> 
> 赞同：0
> 
> 时间：2012-08-13T18:13:04.770
> 
> 标签：java, mysql, swing, minecraft, bukkit

我有一个 MySQL 数据库，我正在尝试将其加载到我正在制作的 java 应用程序中。它是在我的世界服务器中显示当前在线玩家。我将它设置为当一个人离开或加入时服务器更新数据库的位置。我需要将它加载到显示在线播放器的控制面板中，并允许停止/启动/重新启动服务器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T21:46:42.667

到现在为止你做了什么，任何SSCCE？

这是显示如何从 mySQL 数据库中检索数据的代码：

```
public void selectFromSomeTable(){
    Connection conn = null;
    Statement st = null;
    ResultSet rs = null;
    String dbUrl = "jdbc:mysql://nameOfTheHost/yourDBname";
    String dbUsr = "dbUsername";
    String dbPass = "dbPassword";
    try{
        Class.forName("com.mysql.jdbc.Driver");
        conn = DriverManager.getConnection (dbUrl,dbUsr,dbPass);
        st = conn.createStatement();
        rs = st.executeQuery("SELECT * FROM someTable");
        while(rs.next()){
            //Get values
            String someValue =rs.getString("name_of_the_column");
            .
            .
            .
        }

    }catch(Exception e){
        e.printStackTrace();
    }finally{
        try {
            rs.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        try {
            st.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        try {
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
} 
```

这就是我现在能为你做的一切。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:52:39.960

如果您使用的是 Swing 框架并且只想连接到数据库，则需要驱动程序和 jdbc 来管理连接。[在这里您可以下载驱动程序](http://dev.mysql.com/downloads/connector/j/)。

[为了使用它，我会在此处](http://dev.mysql.com/doc/refman/5.1/en/connector-j.html)链接 MySQL 的手册。

另一件事：有一次，我需要制作类似 twitter 和网上冲浪的时间线。数据库，然后您可以实时更新您的数据，但由于这是一项 DBA 工作，我们没有 DBA，我不得不使用每 60000 毫秒自动更新一次的线程。

# nhibernate - 在 Criteria Restrictions.In 中使用 sproc 的结果

> ID：11939917
> 
> 赞同：1
> 
> 时间：2012-08-13T18:13:25.187
> 
> 标签：nhibernate, criteria, detachedcriteria

我有这个独立的标准：

```
DetachedCriteria students = DetachedCriteria.For(typeof(Submission)) 
.SetProjection(Projections.Property("ID"))
.Add(Restrictions.In("JicsStudent.HostID", visiblestudents)); 
```

visiblestudents 是一个`List<string>`. 在我遇到 2100 参数限制之前，它运行良好。visiblestudents 由另一个查询填充，该查询在存储过程中具有一些疯狂的业务逻辑。然后从 sproc 返回的 linq 过滤到一个`list<string>`

所以我的问题是有没有办法用 sproc 替换`list<string>`sproc 来防止 SQL 错误？到目前为止，我在 stackoverflow 上找到的所有内容都表明我应该使用列表创建一个临时表，然后使用连接，但我的领导更喜欢我不使用临时表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:39:26.443

我们找到了一个似乎可以按我们想要的方式工作的解决方案；

```
var n = new object[2];
var o = new IType[2];

DetachedCriteria students = DetachedCriteria.For(typeof (Submission))
.SetProjection(Projections.Property("ID"))
.Add(Expression.Sql("{alias}.StudentUserID in (select UserId from RMS_udfVisibleStudents(?, ?))", n, o)); 
```

# asp.net - IIS 7.5 URL 重写模块重新格式化链接？

> ID：11939918
> 
> 赞同：0
> 
> 时间：2012-08-13T18:13:27.667
> 
> 标签：asp.net, iis-7.5, blogengine.net, url-rewrite-module

我正在使用 IIS 重写模块来处理博客之间的迁移，以便在此过程中不会破坏任何链接。所以我真的只是使用了很多 301 重定向。

但是，出于性能和搜索引擎优化的原因，我想尽可能避免重定向。我可以通过在代码中复制我的规则来做到这一点。但我想我会先问。有没有办法重用重写模块的规则来预处理和重新格式化链接？

以下是博客主题的摘录...

```
<a rel="bookmark" href="<%=Post.PermaLink %>" title="<%=Server.HtmlEncode(Post.Title) %>">Permalink</a> 
```

我想将其更改为类似`href="ReformatLink(Post.PermaLink)"`，在`ReformatLink`指定 URL 上运行 url 重写规则并返回新 URL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:40:58.057

我找到了另一种方法。我可以通过修改 BlogEngine.Core 来精确创建我想要的链接格式。在 Post.cs 中，我只是更改了属性`PermaLink`并`RelativeLink`反映旧博客软件的链接结构。

我暂时保留我的重写模块规则，以防我遗漏了什么。但这似乎解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:49:33.583

我正在使用这个库[http://www.iis.net/download/urlrewrite](http://www.iis.net/download/urlrewrite)我正在做类似下面的事情。

```
 <rule name="FolderAndNoQueryString" stopProcessing="true">
      <match url="^([^/]+)/([^/]+)/?$" />
      <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
        <!--  The following condition prevents rule from rewriting requests to .axd files -->
        <add input="{URL}" negate="true" pattern="\.axd$" />
      </conditions>
      <action type="Rewrite" url="{R:1}/{R:2}.aspx" />
    </rule> 
```

在我的 HTML 代码中，我有以下内容；

```
<a href="<%=AppSettings("ApplicationPath") %>Folder/MyActualASPXPage">My Link</a> 
```

ApplicationPath 只是一个普通的 Web.Config Key 如下所示；

```
<add key="ApplicationPath" value="/MyVirtualDir/" /> 
```

# javascript - javascript+jquery 猴子补丁/替换/覆盖类方法

> ID：11939922
> 
> 赞同：1
> 
> 时间：2012-08-13T18:13:33.090
> 
> 标签：javascript, jquery, overriding, monkeypatching

```
$.fn.uWorklet = function() {
  var worklet = this;
  var plugin = {
    pushContent: function(target, data) {
    . . .
    }
  }
  return plugin;
} 
```

在上面，我想用我自己的方法替换 pushContent 方法。这可能吗，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:32:29.167

您想弄乱私有范围吗？有很多方法可以做到这一点，但不要告诉任何人你是从我这里学到的：

```
> var foo = function() { var x = 1; return x; };
undefined
> foo()
1
> foo = new Function(foo.toString().replace(/^function\s()[^{]+{|}$/gi, '') \
       .replace(/var x = 1/, 'var x = 2'))
function anonymous() {
  var x = 2; return x; 
}
> foo()
2 
```

开个玩笑，必须有一个更好的解决方案来解决您的问题：如果这是您的代码，则使其更加模块化，如果是库，则分叉代码并修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:17:29.283

你不能只替换整个`uWorklet`方法吗？如果你有代码，你可以复制它，替换`pushContent`方法并替换整个东西。

否则，我认为您不能，至少不能使用您迄今为止显示的代码。也许添加一些您如何使用该`uWorklet`方法的示例，因为它看起来像返回一个对象，也许您可​​以替换该对象中的方法......

# java - 多文件上传器 Java

> ID：11939933
> 
> 赞同：0
> 
> 时间：2012-08-13T18:14:18.720
> 
> 标签：java, file, upload, uploader

我创建了一个程序来将图像从一台设备上传到另一台设备。就目前而言，该程序只允许用户一次上传一个文件。如果我想编辑程序以允许用户一次上传多个文件，那么最好的方法是什么。

```
String source1 = source.getSelectedFile().getPath();
System.out.println("Source1: " + source1);
String nwdir1 = nwdir.getSelectedFile().getPath() + "\\" + filename;
System.out.println("nwdir1: " + nwdir1);

Path source = Paths.get(source1);
Path nwdir = Paths.get(nwdir1);

try {
    Files.copy(source, nwdir); 
```

我注意到您可以执行 .getSelectedFiles()，但由于这不允许 .getPath()，我不确定如何继续。假设你可以这样做：

```
File[] source1 = source.getSelectedFiles(); 
```

我将如何去做第二行：

```
String nwdir1 = nwdir.getSelectedFile().getPath() + "\\" + filename; 
```

当我用 File 数组（如上所示）替换该行时，我在行上得到一个错误：

```
Path source = Paths.get(source1);
Path nwdir = Paths.get(nwdir1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:29:30.320

[File.listFiles](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28%29)或[File.listFiles(FileFilter)](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28java.io.FileFilter%29)

**多文件选择**

抱歉，这就是我认为您想要的，但是您正在使用`JFileChooser`来选择目录，所以我假设您想要列出目录：P

[使用setMultiSelectionEnabeld](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFileChooser.html#setMultiSelectionEnabled%28boolean%29)设置`JFileChooser`允许多项选择。您可能希望将文件选择模式设置为，或者如果您仍然希望他们能够选择目录。`JFileChooser.FILES_ONLY``JFileChooser.FILES_AND_DIRECTORIES`

您可能还希望设置文件过滤器以允许对话框过滤目录内容，限制用户可以选择的内容，为简单起见，请查看[FileNameExtensionFilter](http://docs.oracle.com/javase/7/docs/api/javax/swing/filechooser/FileNameExtensionFilter.html)

**更新**

```
JFileChooser chooser = new JFileChooser();
chooser.setMultiSelectionEnabled(true);
chooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
FileNameExtensionFilter filter = new FileNameExtensionFilter("Images", "png", "jpg", "jpeg");
chooser.setFileFilter(filter);

switch (chooser.showOpenDialog(null)) {

    case JFileChooser.APPROVE_OPTION:

        String currentPath = chooser.getCurrentDirectory().getPath();
        File[] files = chooser.getSelectedFiles();

        if (files.length > 0) {

            System.out.println("You have choosen " + files.length + " from " + currentPath);

        } else {

            System.out.println("You didn't selected anything");

        }

        break;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:18:24.203

使用 apache 公共库中的 FileUtils。非常强大和有用。您甚至可以指定要复制的文件格式等。

# c++ - C++ Apache 模块：在 `_ZNSs4_Rep20_S_empty_rep_storageE` 上失败

> ID：11939934
> 
> 赞同：1
> 
> 时间：2012-08-13T18:14:19.687
> 
> 标签：c++, linux, apache, c++11, shared-libraries

我正在尝试用 C++ 编写一个 apache 模块。

基本模块在.so中编译和链接很好。当我将它附加到服务器时，一切正常。

直到我尝试使用 std::string。现在我收到以下错误：

```
Cannot load mod_foo.so into server:
/usr/lib/apache2/modules/mod_foo.so: undefined symbol:
    _ZNSs4_Rep20_S_empty_rep_storageE 
```

我假设这个符号是标准库中 std::string 使用的东西的错位版本。无论如何在编译或 .so 链接时添加一个选项来指示 .so 需要这个库？

我编译我的 .o 文件如下：

```
g++-4.7 -fpic -c -O3 -pthread -g -iquote .
   -I/usr/include/apache2 -I/usr/include/apr-1.0 -Wall -Wextra
   -Werror -Wno-unknown-pragmas -fnon-call-exceptions
   -std=gnu++11 -x c++ -o ___.o ___ 
```

并链接 .so 如下：

```
ld -Bshareable -o ___.so ___ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:01:16.393

您需要与`-lstdc++`

使用`g++`to link （而不是`gcc`or `ld`）自动完成。

请参阅GCC 手册中的[编译 C++ 程序：](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Invoking-G_002b_002b.html)

> 但是，使用`gcc`并没有添加 C++ 库。`g++`是一个调用 GCC [...] 并自动指定与 C++ 库的链接的程序。

注意选项`-Wall -Wextra -Werror -fnon-call-exceptions -std=gnu++11`在链接时无效，这些选项仅影响编译阶段并在链接阶段被忽略。在链接期间，GCC 只调用链接器并只传递对链接有效的选项。

# javascript - 如何提交一份表格，然后将信息提交到贝宝付款？

> ID：11939938
> 
> 赞同：2
> 
> 时间：2012-08-13T18:14:33.510
> 
> 标签：javascript, forms, paypal

这是我在这里的第一个问题....

所以我为当地的一家娱乐报纸和广告公司经营所有与 IT 相关的事情。我们通过纸质邮件和在线邮件按字词销售分类广告。在我来之前，他们会简单地让人们输入他们的广告信息，他们是否有自己的数学，然后告诉我们他们欠了多少，这是他们不应该经历的麻烦。但更糟糕的是，他们只会在几个输入字段中输入他们的信用卡信息，然后当他们将表单提交给我们的网络主机 cgi 系统时，这些信息会邮寄给我们……我知道这是一个可怕的想法。

到目前为止，我已经用 php 完全重做了网站，让我的表单看起来漂亮整洁，它为客户完成了所有的字数计数/数学运算，然后将来自只读字段的最终金额复制到我隐藏的 paypal“金额”变量中立即购买按钮（显然我们现在想使用贝宝收款..）。我的问题是该按钮向贝宝提交了一个包含所需信息的表单，这会显示带有新价格的“立即购买”屏幕，但是我的其他表单需要在他们转到贝宝的同时提交并通过电子邮件发送给我，我在我获得信息之前不需要验证付款，我可以丢弃那些不付款的。

每个表格在独立使用时都能完美运行，我怎样才能将信息通过电子邮件发送给我，然后将另一个表格提交给贝宝以便价格出现？我是新手……但我对 JS 有很好的了解，所以如果这是解决方案，那就太好了。任何帮助将不胜感激。

如果这里有帮助，请提供一个指向包含表单的 .php 文件的链接。我确实删除了电子邮件和操作信息以及我们的贝宝公司 ID，只是因为......我不希望随机表单提交到我们的电子邮件，我不希望贝宝有任何奇怪的东西哈哈。无论如何继承链接[http://www.whatzup.com/content/diningclub/classified2.php](http://www.whatzup.com/content/diningclub/classified.php)

我的代码可能杂乱无章且不专业，但我今年 17 岁，正在学习这份工作，我的老板知道这一点。考虑到这一点，任何关于任何事情的指针/提示都会很棒。顶部的所有 javascript 要么是字数统计的东西，要么是我试图让它工作的东西。我会将我的最终 JS 放入它自己的文件中，并将其包含在标题中，就像我做数学文件一样。

**编辑：** 我真的很难过，如果我们不能让它工作，我将不得不在他们提交时在新窗口中弹出一个表单，告诉他们返回另一个页面并使用 Paypal 付款。 ..这将是可悲的不专业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:29:19.503

这就是我所做的，以防其他人想知道。第一个表单提交给这个 php 脚本，其中包含一个新表单并使用旧表单中的数据来填写金额部分。然后如果表单发送成功，第二个是用 JS 提交的。

毫不拖延地，您可以发送多个这样的表单，尽管从技术上讲不是从一页开始，它会以这种方式呈现给用户。

```
 <script type="text/javascript">

function submitt()
{
setTimeout('document.paypal.submit()',1000);
}
</script>

<?php
$Amount  = $_REQUEST['amount'];
$to      = "XXXX";
$from    = $_REQUEST['email'];
$name    = $_REQUEST['Name'];
$headers = "From: $from" . PHP_EOL;
$subject = "Classified Ad submission";

$fields                         = array();
$fields["Name"]                 = "\nName";
$fields["email"]                = "\nEmail";
$fields["Phone"]                = "\nPhone";
$fields["WorkPhone"]            = "\nWork Phone";
$fields["Address"]              = "\nStreet Address";
$fields["City"]                 = "City";
$fields["State"]                = "State";
$fields["Zip"]                  = "Zip Code";
$fields["Classification"]       = "\nClassification";
$fields["Ad-Headline"]          = "\nHeadline";
$fields["Other-Classification"] = "\nAlternate Classification";
$fields["Ad-Content"]           = "\nAd Content";
$fields["Words"]                = "\nWord Count";
$fields["Weeks"]                = "\nWeeks to Run";
$fields["WordCount"]            = "\nTotal Words";
$fields["Rate"]                 = "\nWord Rate";
$fields["GrossAmountDue"]       = "\nGross Amount";
$fields["NonProfit"]            = "\nNon Profit Ad?";

$body = "This Ad has been submitted:\n\n";
foreach ($fields as $a => $b) {
    $body .= sprintf("%20s: %s\n", $b, $_REQUEST[$a]);
}

if ($from == '') {
    print "You have not entered an email, please go back and try again";
} else {
    if ($name == '') {
        print "You have not entered a name, please go back and try again";
    } else {
        $send = mail($to, $subject, $body, "From: XXXX" . PHP_EOL);
        if ($send) {
            print "Thank you $Name, your Ad has been submitted, redirecting to paypal.";
            echo "<SCRIPT LANGUAGE='javascript'>submitt();</SCRIPT>";
        } else {
            print "ERROR";
        }
    }
}

?> 

<form action="https://www.paypal.com/cgi-bin/webscr" id="paypal" onClick="sendtotal()" target="_top" name="paypal" method="post">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="XXXXXXXXXXX">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Classified Ad">
<input type="hidden" name="amount" value="<?php echo $_POST['amount'];?>" />
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="button_subtype" value="services">
<input type="hidden" name="no_note" value="0">
<input type="hidden" name="cn" value="Add special instructions to the seller:">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="shipping" value="0.00">
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:44:43.477

如果我理解正确，问题是您希望客户使用 PayPal 付款并同时邮寄给您？然后可能会在付款完成后向您发送电子邮件。

**简单的方法**是使用客户在付款完成或取消后最终进入的“成功页面”和“取消页面”。

您可以通过编辑高级功能下的按钮来添加此功能：“在客户完成结帐后将其带到此 URL”

您还可以在此处选中“添加高级变量”，以便添加客户的唯一标识符或电子邮件。

在这两个页面上，您可以轻松发送电子邮件。

**正确的方法**是使用[即时付款通知 (IPN)](https://www.paypal.com/ipn)，但我建议您先尝试简单的方法。

# android - 如何在 Android 上查找每个应用程序的数据使用情况？

> ID：11939939
> 
> 赞同：44
> 
> 时间：2012-08-13T18:14:38.247
> 
> 标签：android, usage-statistics

我试图在每个应用程序的基础上找出 Android 上的数据使用情况。Android 数据使用应用程序和配额/上限监视器小部件之类的东西*[：永远不会为数据收取额外费用或再次获得上限！](http://kschang.hubpages.com/hub/Data-Usage-Monitor-Apps-and-Widgets-for-Android-Phones-and-Devices#slide4646427)*.

我查看了 Stack Overflow 问题*[How to go about detection data usage in the Android environment](https://stackoverflow.com/questions/4812032/how-to-go-about-detecting-data-usage-in-the-android-env)*。

但这并没有太大帮助。

* * *

```
ActivityManager activityManager = (ActivityManager) this.getSystemService(ACTIVITY_SERVICE);
ActivityManager.MemoryInfo mInfo = new ActivityManager.MemoryInfo();
activityManager.getMemoryInfo( mInfo );
List<RunningAppProcessInfo> listOfRunningProcess = activityManager.getRunningAppProcesses();
Log.d(TAG, "XXSize: " + listOfRunningProcess.size());

for (RunningAppProcessInfo runningAppProcessInfo : listOfRunningProcess) {

    if (runningAppProcessInfo.uid > 1026)
    {
        Log.d(TAG, "ANS " + runningAppProcessInfo.processName +
                   " Id :" + runningAppProcessInfo.pid +
                   " UID: " + runningAppProcessInfo.uid);
    }
} 
```

[我按照Akos Cz](https://stackoverflow.com/a/11940219/520162)的建议尝试了上述代码。但是，与您上面提到的不同，所有[UID](https://en.wikipedia.org/wiki/Unique_identifier)都是数字。`app_79`这可以吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-13T18:31:27.687

以下链接应该可以帮助您了解如何以编程方式确定每个应用程序的数据使用情况。

*   *[使用 Android 的 TrafficStats 类创建网络监视器](http://www.techrepublic.com/blog/app-builder/create-a-network-monitor-using-androids-trafficstats-class/774)*

*   *[Android流量统计里面](http://agolovatyuk.blogspot.com/2012/04/android-traffic-statistics-inside.html)*

您将需要实现您的代码以使用[TraficStats](http://developer.android.com/reference/android/net/TrafficStats.html) API 并跟踪每个 UID（应用程序）发送/接收的字节数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-21T13:44:30.200

在创建新类 PackageInformationTotal 后使用此方法。

```
public void getPakagesInfoUsingHashMap() {
    final PackageManager pm = getPackageManager();
    // get a list of installed apps.
    List<ApplicationInfo> packages = pm.getInstalledApplications(0);

    // loop through the list of installed packages and see if the selected
    // app is in the list
    for (ApplicationInfo packageInfo : packages) {
        // get the UID for the selected app
        UID = packageInfo.uid;
        String package_name = packageInfo.packageName;
        ApplicationInfo app = null;
        try {
            app = pm.getApplicationInfo(package_name, 0);
        } catch (NameNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        String name = (String) pm.getApplicationLabel(app);
        Drawable icon = pm.getApplicationIcon(app);
        // internet usage for particular app(sent and received)
        double received = (double) TrafficStats.getUidRxBytes(UID)

                / (1024 * 1024);
        double send = (double) TrafficStats.getUidTxBytes(UID)
                / (1024 * 1024);
        double total = received + send;

        if(total>0)
        {
            PackageInformationTotal pi=new PackageInformationTotal();
            pi.name=name;
            pi.packageName=package_name;
            pi.icon=icon;               
            pi.totalMB=String.format( "%.2f", total )+" MB";
            pi.individual_mb=String.format( "%.2f", total );
            totalData+=Double.parseDouble(String.format( "%.2f", total ));
            dataHash.add(pi);
        Log.e(name,String.format( "%.2f", total )+" MB");
        }

    }
    Editor edit=shared.edit();
    edit.putString("Total",String.format( "%.2f", totalData));
    edit.commit();
} 
```

之后，您可以以 MB 为单位跟踪所有进程使用情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:34:09.387

**程序上：**

您可以为操作声明意图过滤器`ACTION_MANAGE_NETWORK_USAGE`（在 Android 4.0 中引入），以表明您的应用程序定义了一个提供选项来控制数据使用的活动。`ACTION_MANAGE_NETWORK_USAGE`显示用于管理特定应用程序的网络数据使用的设置。当您的应用具有允许用户控制网络使用的设置活动时，您应该为该活动声明此意图过滤器。查看此内容以获取有关管理数据使用[管理每个应用程序](http://developer.android.com/training/basics/network-ops/managing.html#manage-usage)使用的更多信息。

的正确定义`ACTION_MANAGE_NETWORK_USAGE`可以[在这里](http://developer.android.com/reference/android/content/Intent.html#ACTION_MANAGE_NETWORK_USAGE)看到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-05T12:16:40.910

此代码段也适用于您设备中实际运行的应用程序

```
final PackageManager pm = getPackageManager();

ActivityManager activityManager = (ActivityManager) this.getSystemService(Context.ACTIVITY_SERVICE);
List<ActivityManager.RunningAppProcessInfo> appProcesses = activityManager.getRunningAppProcesses();
//final List<ActivityManager.RunningTaskInfo> recentTasks = activityManager.getRunningTasks(Integer.MAX_VALUE);
for (int i = 0; i < appProcesses.size(); i++) {
    Log.d("Executed app", "Application executed : " + appProcesses.get(i).processName + "\t\t ID: " + appProcesses.get(i).pid + "");
    //  String packageName = activityManager.getRunningTasks(1).get(0).topActivity.getPackageName();
    //String packageName = appProcesses.get(i)..getPackageName();
    ApplicationInfo app = null;
    try {
        app = pm.getApplicationInfo(appProcesses.get(i).processName, 0);
        if ((app.flags & ApplicationInfo.FLAG_UPDATED_SYSTEM_APP) == 1) {
            //it's a system app, not interested
        } else if ((app.flags & ApplicationInfo.FLAG_SYSTEM) == 1) {
            //Discard this one
            //in this case, it should be a user-installed app
        } else {
            // tx = TrafficStats.getUidTxBytes(app.uid);
            //rx = TrafficStats.getUidRxBytes(app.uid);
            long delta_rx = TrafficStats.getUidRxBytes(app.uid) - rx;

            long delta_tx = TrafficStats.getUidTxBytes(app.uid) - tx;
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-04T06:21:12.530

```
 public class Main extends Activity {

    private Handler mHandler = new Handler();
    private long mStartRX = 0;
    private long mStartTX = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        mStartRX = TrafficStats.getTotalRxBytes();
        mStartTX = TrafficStats.getTotalTxBytes();
        if (mStartRX == TrafficStats.UNSUPPORTED || mStartTX == TrafficStats.UNSUPPORTED) {
            AlertDialog.Builder alert = new AlertDialog.Builder(this);
            alert.setTitle("Uh Oh!");
            alert.setMessage("Your device does not support traffic stat monitoring.");
            alert.show();
        } else {
            mHandler.postDelayed(mRunnable, 1000);
        }
    }

    private final Runnable mRunnable = new Runnable() {
        public void run() {
            TextView RX = (TextView)findViewById(R.id.RX);
            TextView TX = (TextView)findViewById(R.id.TX);
            long rxBytes = TrafficStats.getTotalRxBytes()- mStartRX;
            RX.setText(Long.toString(rxBytes));
            long txBytes = TrafficStats.getTotalTxBytes()- mStartTX;
            TX.setText(Long.toString(txBytes));
            mHandler.postDelayed(mRunnable, 1000);
        }
     };
} 
```

您还可以查看[https://github.com/commonsguy/cw-andtuning/tree/master/TrafficMonitor](https://github.com/commonsguy/cw-andtuning/tree/master/TrafficMonitor)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-26T12:25:12.087

要访问单个应用程序的统计信息，您需要该应用程序的 uid，它是系统在安装时分配给每个应用程序的 int 值。

> ```
> PackageManager packageManager = context.getPackageManager();
> 
> ApplicationInfo info = packageManager.getApplicationInfo("com.example.app", 0); 
> 
> int packageUid = info.uid; 
> ```

> 要为 package 获取 Mobile 的所有 Rx 和 Tx 字节：

```
NetworkStats.Bucket bucket = networkStatsManager.queryDetailsForUid(ConnectivityManager.TYPE_MOBILE, getSubscriberId(context, ConnectivityManager.TYPE_MOBILE), 0, System.currentTimeMillis(),packageUid);                          

long rxBytes = 0L;            
long txBytes = 0L;             
NetworkStats.Bucket bucket = new NetworkStats.Bucket();            
while (networkStats.hasNextBucket()) {             
     networkStats.getNextBucket(bucket);
     rxBytes += bucket.getRxBytes();
     txBytes += bucket.getTxBytes(); 
}
networkStats.close(); 
```

有关这方面的更多说明，请查看： [如何以编程方式显示所有应用程序的数据使用情况？](https://stackoverflow.com/questions/17674790/how-do-i-programmatically-show-data-usage-of-all-applications/29084035#29084035)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-04-20T11:56:05.237

经过长时间的努力，我能够找到通过任何接口为每个已安装应用程序在 android 设备中获取数据的解决方案。

由于 Android 提供了 TrafficStats API，但这些 API 为每个应用程序 uid 提供了完整的数据统计信息，因为设备启动并且甚至 API 不支持通过特定应用程序的任何接口获取数据。即使我们依赖 TraffiucStates APIS，我们也会为每个应用程序获得一个新的数据统计信息。

所以我想使用隐藏的 API 来使用这个..

在这里，我提到了通过 Android 中的任何接口获取每个应用程序的数据统计信息的步骤...

1.  建立“INetworkStatsSession”会话

    #import android.net.INetworkStatsSession；

INetworkStatsSession mStatsSession = mStatsService.openSession();

2.  根据您要测量的接口创建一个网络模板..

    ```
    #import static android.net.NetworkTemplate.buildTemplateEthernet;
    #import static android.net.NetworkTemplate.buildTemplateMobile3gLower;
    #import static android.net.NetworkTemplate.buildTemplateMobile4g;
    #import static android.net.NetworkTemplate.buildTemplateMobileAll;
    #import static android.net.NetworkTemplate.buildTemplateWifiWildcard;

    #import android.net.NetworkTemplate;

    private NetworkTemplate mTemplate;

    mTemplate = buildTemplateMobileAll(getActiveSubscriberId(this
                    .getApplicationContext())); 
    ```

3.  获取活动订阅者 ID：

    ```
    private static String getActiveSubscriberId(Context context) {
        final TelephonyManager tele = TelephonyManager.from(context);
        final String actualSubscriberId = tele.getSubscriberId();
        return SystemProperties.get(TEST_SUBSCRIBER_PROP, actualSubscriberId);
    } 
    ```

4.  通过传递应用程序 UID 收集各个应用程序的网络历史记录...

    ```
     private NetworkStatsHistory collectHistoryForUid(NetworkTemplate template,
            int uid, int set) throws RemoteException {
        final NetworkStatsHistory history = mStatsSession.getHistoryForUid(
                template, uid, set, TAG_NONE, FIELD_RX_BYTES | FIELD_TX_BYTES);
        return history;

    } 
    ```

5.  获取总消费数据：

    ```
    public void showConsuption(int UID){
        NetworkStatsHistory history = collectHistoryForUid(mTemplate, UID,
                SET_DEFAULT);

        Log.i(DEBUG_TAG, "load:::::SET_DEFAULT:.getTotalBytes:"+ Formatter.formatFileSize(context, history.getTotalBytes()));

        history = collectHistoryForUid(mTemplate, 10093,
                SET_FOREGROUND);
        Log.i(DEBUG_TAG, "load::::SET_FOREGROUND::.getTotalBytes:"+ Formatter.formatFileSize(context, history.getTotalBytes()));

        history = collectHistoryForUid(mTemplate, 10093,
                SET_ALL);
        Log.i(DEBUG_TAG, "load::::SET_ALL::.getTotalBytes:"+ Formatter.formatFileSize(context, history.getTotalBytes()));

    } 
    ```

# applescript - 如何使用 AppleScript 从 Evernote 导出笔记？

> ID：11939940
> 
> 赞同：7
> 
> 时间：2012-08-13T18:14:41.973
> 
> 标签：applescript, evernote

我正在尝试使用 AppleScript 将笔记从 Evernote v.3.3.0 以 HTML 格式导出到磁盘上的某个位置。手头的任务似乎并不特别复杂，但我对 Evernote 相对较新，对 AppleScript 完全陌生并没有多大帮助... ;)

这是我到目前为止的想法 - 非常感谢任何评论！

```
tell application "Evernote"
    set allmynotes to find notes
    set outputpath to "/Users/{myusername}/Desktop/Test"
    export allmynotes to outputpath format HTML
end tell 
```

据我了解，导出为 HTML 会为每个笔记创建一个文件，这就是为什么我认为我需要指定输出*文件夹*名称而不是输出*文件*名的原因。另一个假设是脚本在双击时将使用活动用户的凭据运行。在我的机器上，该用户有足够的权限写入指定的文件夹。

到目前为止的结果是`Evernote got an error: Unable to remove existing output file." number 1`和`Evernote got an error: Unable to create output directory.`。有任何想法吗？

提前谢谢了！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-07T18:10:36.090

终于胜利了！这个问题与我的脚本无关，而与我从 App Store 安装 Evernote 的事实无关。App Store 版本与可从evernote.com 下载的版本不同，受Mac OS X 中的App Sandboxing 限制。现在，安装非App Store 版本后，上述脚本可以完美运行。

再次感谢您的回答，以及那些遇到相同问题的人-我希望您的问题也可以通过上述方式解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T13:55:23.880

Think it's a bug in 3.3 -- I have written [a fair number of AppleScripts for Evernote](http://veritrope.com/code_type/evernote/) (including ones with working export functions) and have recently [encountered the same types of "permission" errors](http://veritrope.com/tech/evernote-applescript-trouble/).

When I reached out to Evernote Developer Support, they replied that their team is currently looking at the issue. I will forward this page to them for their reference and, hopefully, version 3.3.1 will bring a fix!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T22:41:05.890

你很接近：

```
set outputpath to (path to desktop as text) & "Evernote Test"
do shell script "mkdir -p " & quoted form of POSIX path of outputpath

tell application "Evernote"
    set allmynotes to find notes
    export allmynotes to outputpath format HTML
end tell 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-05T19:52:00.880

在 Evernote 5.2.1 (Mac OS X 10.8.4) 上，我可以验证[adayzdone](https://stackoverflow.com/users/1191301/adayzdone)的答案是否可靠，无论输出文件夹是否已经存在。如果给定文件夹确实存在，Evernote 会将其移至回收站并创建一个新文件夹。

从最初的问题中，我收集了关于如何处理边缘情况的不确定性（例如已经存在的早期导出文件夹）。这是使用对话框处理这种情况的代码。

```
set folderName to "Latest Evernote HTML Export"
set exportFolder to (path to documents folder as text) & folderName as text
tell application "Finder"
    if exportFolder exists then
        set answer to the button returned of (display dialog "This will overwrite the previous Evernote HTML export" buttons {"Stop", "Overwrite"} default button 1)
        if answer is equal to "Stop" then
            error number -128 -- end script with error "User Cancelled"
        end if
    end if
end tell

tell application "Evernote"
    set allNotes to find notes
    export allNotes to exportFolder format HTML
end tell 
```

测试提示：为避免导出完整的 Evernote 库（可能非常大），可以将出现的*两次 allNotes*替换为*{firstNote, secondNote}*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-15T12:52:52.487

```
set folderName to "Latest Evernote HTML Export"
set exportFolder to (path to documents folder as text) & folderName as text
tell application "Finder"
    if exportFolder exists then
        set answer to the button returned of (display dialog "This will overwrite the previous Evernote HTML export" buttons {"Stop", "Overwrite"} default button 1)
        if answer is equal to "Stop" then
            error number -128 -- end script with error "User Cancelled"
        end if
    end if
end tell

tell application "Evernote"
    set allNotes to find notes
    export allNotes to exportFolder format HTML
end tell 
```

# git - 一个真正的、健壮的、git svn externals 解决方案？

> ID：11939942
> 
> 赞同：18
> 
> 时间：2012-08-13T18:14:46.133
> 
> 标签：git, git-svn, svn-externals

当您签出包含 svn 外部的 git 存储库时，它会简单地忽略它们。人们所做的是创建了许多脚本，其中许多在这个问题中提到了[如何使用 git-svn 使 svn:external 保持最新？](https://stackoverflow.com/questions/350651/how-do-i-keep-an-svnexternal-up-to-date-using-git-svn). 问题是，虽然互联网上漂浮着许多脚本，但我还没有找到一个真正强大的脚本。我所说的健壮是指：

1.  它可以处理与特定版本挂钩的 svn 外部
2.  它可以处理指向文件而不是目录的svn外部

因为这些是我的存储库的 2 个问题，它们似乎使大多数脚本都崩溃了。我对使用 smartgit 没有兴趣。

有这样的剧本吗？有没有人有一个“几乎在那里”的脚本可以相当快地适应这两件事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T15:53:38.883

不，没有完美的解决方案可以正常工作。你可以参考：

[如何使用 git-svn 使 svn:external 保持最新？](https://stackoverflow.com/questions/350651/how-do-i-keep-an-svnexternal-up-to-date-using-git-svn)

[git & svn externals - 最终解决方案了吗？](https://stackoverflow.com/questions/4689090/git-svn-externals-a-final-solution-yet)

# in-app-purchase - 销售杂志的 iOS 报亭应用程序中的消耗品

> ID：11939949
> 
> 赞同：1
> 
> 时间：2012-08-13T18:15:03.207
> 
> 标签：in-app-purchase, appstore-approval, newsstand-kit, ios

问题库是使用“信用系统”实现的。用户可以购买积分并将其用于个别问题。收据验证和交易在我的服务器上完成。

我这样做的原因是因为我想在网站上提供相同的内容，所以 iPad/iPhone 上的用户可以购买/下载/阅读与网络上相同的内容。当他在网上购买问题时，该问题也将在 iOS 设备上可用。

该计划是拥有例如 Android 应用程序，该应用程序也将与 Web 和 iOS 设备同步。用户将拥有一个适用于所有平台的帐户。

问题是具有这种应用内购买和报亭 API 实现的应用程序将获得批准。

# asp.net-mvc - 在 VB ASP.NET MVC 3 中使用 RSS 源

> ID：11939953
> 
> 赞同：1
> 
> 时间：2012-08-13T18:15:15.403
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, rss

我能找到的唯一一篇文章是[Consuming RSS 1.0 (RDF) Feeds in ASP.NET MVC 3](https://stackoverflow.com/questions/7227031/consuming-rss-1-0-rdf-feeds-in-asp-net-mvc-3)。它使用 LINQ。反正有没有使用 lambda 表达式来做到这一点？有没有更好的方式在 MVC3 中消费和 RSS 提要？

这是我的代码：

```
Imports System
Imports System.Xml
Imports System.ServiceModel
Imports System.ServiceModel.Description
Imports System.ServiceModel.Syndication
Imports System.ServiceModel.Web
Imports System.Collections.ObjectModel
Imports System.Collections.Generic

Public Class RssController

    Function GetFeed(url As String) As SyndicationFeed

        Dim reader = XmlReader.Create(url)
        Dim feed = SyndicationFeed.Load(reader)
        Return feed

    End Function

    Function ShowFeed() As ViewResult

        Dim feedUrl = "somefeedurl"
        Dim feed = GetFeed(feedUrl)
        Return View(feed)

    End Function

End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:33:38.460

.NET 有一个用于处理 RSS 提要的内置类，称为[SyndicationFeed](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx)

您可以将此类用作编写自己的解析逻辑的替代方法。

# java - 将一个txt文件拆分成一个数组，并在数组中查找元素

> ID：11939954
> 
> 赞同：1
> 
> 时间：2012-08-13T18:15:20.493
> 
> 标签：java

您好，基本上我的目标是读取`txt`文件并将其存储在数组中并在方法参数之后打印数组元素。文本文件的格式如图所示（一行中每个字符串之间的空格）

```
alan 1000

lee 20

rodney 28 
```

例如，如果我的论点是`lee`，该方法应该打印出来`20`。如果`rodney`那时`28`

```
public class practice
{
public void dataReader(String fName, String pname)
{
    try
    {
      FileReader fr=new FileReader(fName);
      BufferedReader br=new BufferedReader(fr);

      String[] a={};
      String line= br.readLine();

      while(line !=null)
      {
           a= line.split(" "); // deliminator white space
      }

      for(int i=0; i <a.length; i++)
      {
          if(a[i].equals(pname))
          {
              System.out.println(a[i]+1);
          }
      }
    }

    catch(IOException e)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:26:41.740

您发布的代码不起作用，因为您只阅读了第一行，然后永远循环该行。

您的代码，修剪和注释：

```
String line= br.readLine(); // returns the first line of the file

while(line !=null) { // checks if the line is null - it's not at the first line
    a= line.split(" "); // deliminator white space
}
// we never get here, because nowhere in the loop do we set line to null 
```

您需要`br.readLine()`在循环中调用，直到它返回 null，如下所示：

```
BufferedReader br=new BufferedReader(new FileReader(fName));

String line= br.readLine(); // reads the first line, or nothing

while(line != null) {
    a= line.split(" "); // deliminator white space
    String[] arr = line.split("\\s+"); // splits a string by any amount of whitespace
    if(arr.length >= 2 && arr[0].equals(lookup)) {
        System.out.println(arr[1]);
    }

    line = br.readLine(); // this will eventually set line to null, terminating the loop
} 
```

原始代码中的 for 循环将不起作用，如果您点击它，您的输出将分别为`lee1`或`rodney1`。如果您将其更改为`arr[i+1]`，我假设您正在尝试这样做，如果数组中的最后一个项目匹配，它将因 IndexOutOfBoundsException 而崩溃`pname`。

* * *

**原始答案**

这是[Scanner](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)的理想用例。它“扫描”字符串或文件以查找您要查找的内容，极大地简化了许多用例的文件解析，特别是空格分隔的文件。

```
public void searchFile(String fName, String lookup){
  Scanner in = new Scanner(new File(fName));
  // Assumes the file has two "words" per line
  while(in.hasNext()){
    String name = in.next();
    String number = in.next():
    if(name.equals(lookup){
      System.out.println(number);
    }
  }
} 
```

如果您不能使用扫描仪来解析每一行，您仍然可以使用它来简化读取每一行，然后对需要完成的行进行任何更复杂的解析，如下所示：

```
public void searchFile2(String fName, String lookup){
  Scanner in = new Scanner(new File(fName));
  while(in.hasNextLine()){
    String line = in.nextLine();
    String[] arr = line.split("\\s+"); // splits a string by any amount of whitespace
    if(arr[0].equals(lookup)){
      System.out.println(arr[1]);
    }
  }
} 
```

顺便说一句，如果您知道名称将是唯一的，则可以使用[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)（特别是[HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)）来有效地存储和查找名称到数字的映射。*因此，您可以使用解析文件并返回所有*名称到数字的映射的方法，而不是使用获取文件名和名称来查找的方法，然后您可以简单地调用`map.get("name")`返回的映射来有效地获取给定人员的号码，而不必每次都重新读取文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:24:15.820

您应该使用 Dictionary 对象

```
Dictionary<String, Integer> wordPairs = new Dictionary<String, Integer>();
while(br.ReadLine())
{
    wordPairs.put(a[0], Integer.parseInt(a[1]));
} 
```

要获取数字，您只需通过键名在字典中查找。

```
public int getNumber(string name)
{
    return wordPairs.get(name);
} 
```

# assembly - 如何在 Windows 上使用 sqlite3 和 masm32

> ID：11939956
> 
> 赞同：1
> 
> 时间：2012-08-13T18:15:24.813
> 
> 标签：assembly, sqlite, masm, masm32

由于我必须在 Assembler 中编写一个访问 Sqlite3 数据库的小型库，因此我开始搜索如何使用 sqlite3.dll。我在 fasm 中找到了一种方法（我必须使用 masm32，原因有很多，但无助于解决问题，这只是必要的）通过`cinvoke`并引用看起来不可用的库。
我基本上想知道的是我是否有可能在 masm 中做类似的事情，或者我是否必须通过`GetProcAddress`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T04:38:34.137

为什么不呢？很简单，简单如下：

```
.486
.model flat, stdcall
option casemap:none

include \masm32\include\masm32.inc
include \masm32\include\kernel32.inc
include \masm32\include\user32.inc
include sqlite3.inc

.data
szSQLDB         db  "MyDB.db3", 0
szRandQuery     db  "SELECT * FROM Quit ORDER BY RANDOM() LIMIT 1;", 0

.data?
hDBase          dd  ?

.code
START:
    invoke  sqlite3_open, offset szSQLDB, offset hDBase

    call    GetQuitMsg

    invoke  sqlite3_close, hDBase

    invoke  ExitProcess, 0

GetQuitMsg proc
local   ppStmt

    invoke  sqlite3_prepare_v2, hDBase, offset szRandQuery, -1, addr ppStmt, 0
    invoke  sqlite3_step, ppStmt
    invoke  sqlite3_data_count, ppStmt
    .if eax !=0
        invoke  sqlite3_column_text, ppStmt, 0
        invoke  MessageBoxA, 0, eax, 0,0        
    .endif        
    ret
GetQuitMsg endp
end START 
```

我使用 makefile，并使用 Geany 作为我的编辑器。zip 包含测试数据库 sqlite3.inc，但不包括 sqlite3.dll，只是解压缩文件，将 sqlite3.dll 放入项目目录中，您就可以开始了。我也没有使用 MS 链接，而是使用 GoLink，因为它不需要导入库，但如果您必须使用 MS 链接，我在此处某处有一个 SQLite 导入库。

[http://www.gunnerinc.com/files/SQLiteTest.zip](http://www.gunnerinc.com/files/SQLiteTest.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T18:23:28.437

萨拉姆，

这是我的示例代码:)

```
.386
.model flat, stdcall
option casemap:none

include windows.inc
include advapi32.inc
include comctl32.inc
include kernel32.inc
include shell32.inc
include user32.inc

includelib advapi32.lib
includelib comctl32.lib
includelib kernel32.lib
includelib shell32.lib
includelib user32.lib

.const
    SQLITE_ROW equ 100
.data?
    dwResult dd ?
    hDB dd ?
    sqlite3_close dd ?
    sqlite3_column_text dd ?
    sqlite3_exec dd ?
    sqlite3_open dd ?
    sqlite3_prepare dd ?
    sqlite3_step dd ?
.data
    szSQLite3Lib db "sqlite3.dll", 0h
    szfnSQLite3_close db "sqlite3_close", 0h
    szfnSQLite3_column_text db "sqlite3_column_text", 0h
    szfnSQLite3_exec db "sqlite3_exec", 0h
    szfnSQLite3_open db "sqlite3_open", 0h
    szfnSQLite3_prepare db "sqlite3_prepare", 0h
    szfnSQLite3_step db "sqlite3_step", 0h
    szDBFile db "file.db", 0h
    szSQLStmt1 db "create table DBI (nID integer primary key, szName text)", 0h
    szSQLStmt2 db "insert into DBI (nID, szName) values (1, 'RizonBarns')", 0h
    szSQLStmt3 db "insert into DBI (szName) values ('Rizon & Barns')", 0h
    szSQLStmt4 db "insert into DBI (szName) values ('MASM32')", 0h
    szSQLStmt5 db "select * from DBI", 0h
.code
main:
    push offset szSQLite3Lib
    call LoadLibraryA
    cmp eax, 0h
    je @ERROR
    push offset szfnSQLite3_close
    push eax
    call GetProcAddress
    mov sqlite3_close, eax

    push offset szSQLite3Lib
    call LoadLibraryA
    push offset szfnSQLite3_column_text
    push eax
    call GetProcAddress
    mov sqlite3_column_text, eax

    push offset szSQLite3Lib
    call LoadLibraryA
    push offset szfnSQLite3_exec
    push eax
    call GetProcAddress
    mov sqlite3_exec, eax

    push offset szSQLite3Lib
    call LoadLibraryA
    push offset szfnSQLite3_open
    push eax
    call GetProcAddress
    mov sqlite3_open, eax

    push offset szSQLite3Lib
    call LoadLibraryA
    push offset szfnSQLite3_prepare
    push eax
    call GetProcAddress
    mov sqlite3_prepare, eax

    push offset szSQLite3Lib
    call LoadLibraryA
    push offset szfnSQLite3_step
    push eax
    call GetProcAddress
    mov sqlite3_step, eax

    push 255
    push GPTR
    call GlobalAlloc
    mov hDB, eax

    lea edx, hDB
    push edx
    push offset szDBFile
    call sqlite3_open

    push 0h
    push 0h
    push 0h
    push offset szSQLStmt1
    push hDB
    call sqlite3_exec

    push 0h
    push 0h
    push 0h
    push offset szSQLStmt2
    push hDB
    call sqlite3_exec

    push 0h
    push 0h
    push 0h
    push offset szSQLStmt3
    push hDB
    call sqlite3_exec

    push 0h
    push 0h
    push 0h
    push offset szSQLStmt4
    push hDB
    call sqlite3_exec

    push 0h
    lea eax, dwResult
    push eax
    push offset szSQLStmt5
    call lstrlenA
    push eax
    push offset szSQLStmt5
    push hDB
    call sqlite3_prepare

@@:
    push dwResult
    call sqlite3_step
    cmp eax, SQLITE_ROW
    jne @F
    push 0h
    push dwResult
    call sqlite3_column_text
    mov esi, eax
    push 1h
    push dwResult
    call sqlite3_column_text
    mov edi, eax
    push 0h
    push esi
    push edi
    push 0h
    call MessageBoxA
    jmp @B
@@:
    push hDB
    call sqlite3_close
@ERROR:
    xor eax, eax
    push eax
    call ExitProcess
end main 
```

它将创建名为“file.db”的数据库文件，创建名为“DBI”的表，并插入多达三行的数据。插入数据 3 次后，会以 MessageBoxA 显示数据。nID 作为标题，szName 作为文本。

玩得开心我的代码:),

> 请将 INCLUDE、LIB 和 BIN 环境添加到 MASM 安装路径。
> 
> 例子：
> 
> 包括 = C:\MASM32\包括
> 
> LIB = C:\MASM32\lib
> 
> BIN = C:\MASM32\bin
> 
> 并确保在命令提示符下键入**set时上面有路径。**

瓦萨拉姆。

# php - PHP 下载文件到服务器

> ID：11939958
> 
> 赞同：0
> 
> 时间：2012-08-13T18:15:26.180
> 
> 标签：php, curl, fopen, fclose

我正在尝试使用 curl 从 php 下载图像，但是不是将图像保存到服务器，它只是将随机字符输出到 Web 浏览器屏幕，这是代码

```
$final['IMAGE'] = 'http://www.google.com/images/srpr/logo3w.png';

$imagename = trim(basename($final['IMAGE']));

$url  = $final['IMAGE'];
$path = '/media/import/';
$path .= $imagename;

$fp = fopen($path, 'w');

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_FILE, $fp);

$data = curl_exec($ch);

curl_close($ch);
fclose($fp); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:19:49.847

`curl_exec($ch);`将输出直接打印到屏幕上。`CURLOPT_RETURNTRANSFER`使用-option时可以停止他的行为：

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
```

有关更多信息，请参阅 PHP 手册“ [curl_setopt](http://php.net/manual/de/function.curl-setopt.php) ”。

**编辑**

这个小脚本将文件下载到可写目录：

```
// file handler
$file = fopen(dirname(__FILE__) . '/test.png', 'w');
// cURL
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,'somethinsomething.com/something.png');
// set cURL options
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
// set file handler option
curl_setopt($ch, CURLOPT_FILE, $file);
// execute cURL
curl_exec($ch);
// close cURL
curl_close($ch);
// close file
fclose($file); 
```

这次是`CURLOPT_FILE`-option 可以解决问题。可以在与以前相同的链接上找到更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:21:22.253

如果您确定它们将是 .png，则可以使用 imagecreatefromstring() 和 imagepng()：

```
$c = curl_init( $final['IMAGE'] );
curl_setopt( $c, CURLOPT_HEADER, 0 );
curl_setopt( $c, CURLOPT_RETURNTRANSFER, 1 );
$binary = curl_exec( $c );
curl_close( $c );

$imagename = trim(basename($final['IMAGE']));
$url  = $final['IMAGE'];
$path = '/media/import/';
$path .= $imagename;

$img = imagecreatefromstring( $binary );
imagepng( $img, $path, 0 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:21:40.413

您可以只使用复制（）：

```
copy("http://www.google.com/images/srpr/logo3w.png", "/media/import/logo3w.png"); 
```

# asp.net - 在 ASP.NET 中处理文件和 URL

> ID：11939961
> 
> 赞同：0
> 
> 时间：2012-08-13T18:15:34.377
> 
> 标签：asp.net, url

我在 ASP.NET 应用程序中有以下场景： 在临时目录中创建一个文件并返回指向该文件的链接。我实现它如下：

```
// get URL to create file
var tempDataOperationsDirectory = Server.MapPath("~/temp/DataOperations/foo1.txt");
// Create file
// Create link:
 ButtonViewFile.NavigateUrl = Page.ResolveUrl("~/temp/DataOperations/foo1.txt"); 
```

以上工作。我想知道这是否是一个好方法，如果有其他选择怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:26:01.283

为什么需要创建该临时文件？如果您为单次下载而动态创建文件，您可能需要考虑实现一个`HttpHandler`类，该类可以将文件流直接写入返回给客户端浏览器的响应中。

如果您想了解有关`HttpHandler`ASP.NET 的更多信息，请查看此处[http://msdn.microsoft.com/en-us/library/ms228090.aspx](http://msdn.microsoft.com/en-us/library/ms228090.aspx)或此处[Best way to stream files in ASP.NET](https://stackoverflow.com/questions/608480/best-way-to-stream-files-in-asp-net)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:30:21.277

> 以上工作。我想知道这是否是一个好方法，如果有其他选择怎么办？

这是一种很好的方法，也是推荐的方法。它将始终生成准确的链接。我能想到的其他方法可能不如这个准确。

# c# - 已检测到关系 y 的角色 x 的冲突更改

> ID：11939964
> 
> 赞同：39
> 
> 时间：2012-08-13T18:15:37.803
> 
> 标签：c#, asp.net-mvc, entity-framework, entity-framework-4.1, ef-code-first

我有例外

> 已检测到关系 y 的角色 x 的冲突更改。

每次我将我的实体添加到我的上下文中

```
Database.MyEntitys.Add(MyEntity); 
```

MyEntity 类包含此属性：

```
public virtual ICollection<DetailInfo> Group { get; set; } 
```

DetailInfo 类非常简单：

```
public class DetailInfo:BaseEntity {
    public virtual Detail Detail { get; set; }
    public decimal Total { get; set; }
    public virtual MyEntity MyEntity { get; set; }
} 
```

DatabaseContext 也很简单：

```
public class MyEntityConfiguration : EntityTypeConfiguration<MyEntity> {
    public MyEntityConfiguration() {
        HasMany(e => e.Group).WithRequired(s => s.MyEntity).WillCascadeOnDelete(true);
    }
}

public class DetailInfoConfiguration : EntityTypeConfiguration<DetailInfo> {
    public DetailInfoConfiguration() {
        HasRequired(x => x.MyEntity).WithMany(s => s.Group);
        HasRequired(x => x.Detail);
        HasKey(s => s.ID);
        ToTable("DetailInfo");
    }
} 
```

在数据库端，表 MyEntity 具有列 ID 的主键。DetailInfo 还有一个称为 ID 的主键。DetailInfo 包含 2 个 FK，一个到 MyEntity，一个到另一个实体 Detail。

在有问题的场景中，MyEntity 是新的有一个新的细节。我期待 MyEntity 的新条目具有新的详细信息并正确设置所有 FK。

### 编辑：

这是插入：

```
public virtual int Insert(MyEntity myEntity) {

    if (myEntity.Group != null && myEntity.Group.Count() == 0) {
        myEntity.Group = null; 
    }

    if (myEntity.Group != null) {
        foreach (var g in myEntity.Group)
        {
         if (g.PropertyOneToOne != null) {
                if (g.PropertyOneToOne.ID == 0) {
                    myEntity.PropertyOneToOne = null;
                }
                else {
                    if (!Database.PropertyOneToOnes.Local.Any(e => e.ID == g.PropertyOneToOne.ID)) {
                        Database.PropertyOneToOnes.Attach(g.PropertyOneToOne);
                    }
                    myEntity.PropertyOneToOne = Database.PropertyOneToOnes.Local.Single(e => e.ID == g.PropertyOneToOne.ID);
                }
            }
            else {
                myEntity.PropertyOneToOne = null;
            }
        }
    }
    Database.MyEntitys.Add(myEntity);
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-14T13:08:30.823

问题是这个：

MyEntity 的 ID 为 0，因为它是新的 MyEntity。该组也是新的，包含对 MyEntity 的引用。

因此，`MyEntity`包含一个 Group 列表，其中包含对 的引用`MyEntity`。

问题是这`MyEntity.Group.MyEntity`似乎与`MyEntity`. 在将 MyEntity 添加到上下文时，它发现了冲突。

为了解决这个问题，我设置`Group.MyEntity`为 NULL 并将 Group 的引用保留在`MyEntity`. 保存时，将`MyEntity`参考 (ID) 设置到组表中。

我不确定这是最干净的方法，但问题终于解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-26T16:33:52.627

其他一些解决方案可能是我们需要配置 2 路绑定数据，因为 MyEntity 需要 Group 而 Group 有 MyEntity。您可以参考此链接来配置双向绑定。希望能帮助到你。[EF 5.0 Code First 双向导航，子项中没有外键 ID](https://stackoverflow.com/questions/12092061/ef-5-0-code-first-two-way-navigation-withought-foreign-key-id-in-child)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-05T07:08:08.887

问题也可能是您正在创建一个新的子列表，并且您正在将该列表分配给父列表的多个项目，解决方案是您应该为每个父项目创建一个新的子列表。

# php - 有没有办法用 Cron Job 加载页面？

> ID：11939965
> 
> 赞同：1
> 
> 时间：2012-08-13T18:15:50.243
> 
> 标签：php, database, cron, backup, cpanel

我创建了一个 php 文件；所以每次我运行它时，它都会运行将所有数据库复制到我主机内的一个文件夹中。

所以我想知道有没有办法**每天调用一个cron作业来加载那个页面？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:19:26.883

是的你可以。

执行 sudo crontab -e ，您可以添加以下行：

```
0 0 * * * /path/to/php /path/to/php/file.php 
```

基本上这意味着每天午夜，它将通过调用 php 解释器来运行命令，然后运行您的 php 文件。

确保您的 php 文件具有正确的 root 权限（或您希望在其下运行 cronjob 的任何用户）。

编辑：如果您使用的是 cPanel，请查看此文档：[http://docs.cpanel.net/twiki/bin/view/11_30/CpanelDocs/CronJobs#Adding a cron job](http://docs.cpanel.net/twiki/bin/view/11_30/CpanelDocs/CronJobs#Adding%20a%20cron%20job)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:21:40.250

是的，创建一个`myscript.sh`调用这个 php 的 shell 脚本，例如：

```
#!/bin/sh
php yourscript.php 
```

然后在 cron 中安排它每 6 小时运行一次（例如）：

```
0 */6 * * * ./myscript.sh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:18:13.487

这取决于您所说的“视图”是什么意思。您当然可以设置运行 PHP cURL 或 shell 命令（wget、curl 等）的 cron 作业，但它不会在浏览器中加载。

# android - Android剪贴板不复制文本

> ID：11939968
> 
> 赞同：3
> 
> 时间：2012-08-13T18:15:58.880
> 
> 标签：android, clipboardmanager

我想在 Android API 上测试剪贴板，所以我开始使用 Android 的 ClipboardManager 和 ClipData 类创建一个简单的应用程序。我遵循了Android 网站上的[复制和粘贴指南](http://developer.android.com/guide/topics/text/copy-paste.html)，尽管我必须填写几个地方，因为本指南没有必要的每一行代码（我最终不得不注释掉 Intent 和 URI 粘贴方法，因为它没有给出具体的例子，因为我假设数据的多样性）。我运行应用程序，但由于某种原因，我发送的文本似乎不起作用或显示。有谁知道这可能是什么原因造成的？

这是我的课：

```
public class MainActivity extends Activity
{
// Creates a URI based on a base URI and a crecord ID based on the contact's last name
// Declares the base URI string
private static final String CONTACTS = "content://com.example.contacts";
// Declares a path string for the URIs that you use to copy data
private static final String COPY_PATH = "/copy";
// Declares the URI to paste to the clipboard
Uri copyURI;

// Declares a MIME type constant to match against the MIME types offered by the provider
private static final String MIME_TYPE_CONTACT = "vnd.android.cursor.item/vnd.example.contact";

private int pasteType;
private Menu menu;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    String lastName = "Nichols";
    copyURI = Uri.parse(CONTACTS + COPY_PATH + "/" + lastName);
    setContentView(R.layout.activity_main);
    main();
}

void main()
{
    String text = "Hi, bob!";
    copyText(text);
    String data = paste();
    TextView tv = new TextView(this);
    tv.setText(data);
    setContentView(tv);
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    this.menu = menu;
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@TargetApi(11)
void copyIntent()
{
    ClipboardManager clipboard = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);
    Intent appIntent = new Intent(this, com.example.clipboard.MainActivity.class);
    ClipData clip = ClipData.newIntent("Intent", appIntent);
    clipboard.setPrimaryClip(clip);
    pasteType = 1;
}

@TargetApi(11)
void copyText(String text)
{
    ClipboardManager clipboard = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);
    ClipData clip = ClipData.newPlainText("simple", text);
    clipboard.setPrimaryClip(clip);
    pasteType = 2;
}

@TargetApi(11)
void copyURI()
{
    ClipboardManager clipboard = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);
    ClipData clip = ClipData.newUri(getContentResolver(), "URI", copyURI);
    clipboard.setPrimaryClip(clip);
    pasteType = 3;
}

@TargetApi(11)
String paste()
{
    ClipboardManager clipboard = (ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE);
    /*if (pasteType == 1)
    {
        // Checks to see if the clip item contains an Intent, by testing to see if getIntent() returns null
        Intent pasteIntent = clipboard.getPrimaryClip().getItemAt(0).getIntent();
        if (pasteIntent != null)
        {

        }
    }*/
    if (pasteType == 2)
    {
        String pasteData = "";

        // Gets the ID of the "paste" menu item
        MenuItem mPasteItem = this.menu.findItem(R.id.paste);

        // If the clipboard doesn't conatin data, disable the paste menu item
        if (!(clipboard.hasPrimaryClip()))
            mPasteItem.setEnabled(false);
        else if (!(clipboard.getPrimaryClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_PLAIN)))
        {
            // This disables the paste menu item, since the clipboard has data, but it is not plain text
            mPasteItem.setEnabled(false);
        }
        else
            mPasteItem.setEnabled(true);

        // Examines the item on the clipboard. If getText() does not return null, the clip item contains the
        // text. Assume the application can only handle one item at a time.
        ClipData.Item item = clipboard.getPrimaryClip().getItemAt(0);

        pasteData = (String) item.getText();
        return pasteData;
    }
    /*if (pasteType == 3)
    {

        ContentResolver cr = getContentResolver();
        ClipData clip = clipboard.getPrimaryClip();

        if (clip != null)
        {
            ClipData.Item item = clip.getItemAt(0);
            Uri pasteUri = item.getUri();
            // If the clipboard contains a URI reference
            if (pasteUri != null)
            {
                // Is this a content URI?
                String uriMimeType = cr.getType(pasteUri);
                // If the return value is not null, the Uri is a content URI
                if (uriMimeType != null)
                {
                    // Does the content provider offer a MIME type that the current application can use?
                    if (uriMimeType.equals(MIME_TYPE_CONTACT))
                    {
                        Cursor pasteCursor = cr.query(pasteUri, null, null, null, null);
                        if (pasteCursor != null)
                        {
                            if (pasteCursor.moveToFirst()) {

                            }
                        }
                        pasteCursor.close();
                    }
                }
            }
        }
    }*/
    return null;
}
} 
```

编辑：这是我的 menu.xml 文件，以帮助弄清楚为什么我的菜单没有显示复制/粘贴选项。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:18:00.020

我认为您所遵循的指南完全是误导！它缺乏太多的信息。但是，我建议您简化代码：

*   尝试评论一些块
*   只专注于处理文本，暂时忘记其余的。

[这是一个很好的答案](https://stackoverflow.com/q/10572389/543711)，可能会启发你。

顺便说一句，据我所知，你的方法完全没`copy()`问题。`paste()`你的问题与`ContextMenu`你如何处理它有关。

# c - printf 只给出警告

> ID：11939971
> 
> 赞同：4
> 
> 时间：2012-08-13T18:16:10.257
> 
> 标签：c, warnings, printf, stdio

谁能告诉我为什么*不*包括`stdio.h`并仍在使用该`printf`功能只会在 gcc 上发出警告？

> 警告：内置函数'printf'的隐式声明不兼容</p>

相反，这应该是一个编译错误，因为我们包含了一个未声明的函数。

这与链接过程有关吗？请详细说明。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T18:18:01.567

当您不为代码中使用的函数提供签名时，编译器将（隐式）对未知函数作为参数列表接受的内容做出一些假设，并作为结果返回。

这些假设基于您对函数的使用，因此例如给定`printf("%s", (char *) string)`，编译器将确定这`printf`是一个函数，它恰好采用 2 `char *`-**不是**变量参数列表 - 并返回一个`int`.

当这些假设与实际功能不兼容时，可能会在*链接期间出现问题。*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-13T18:46:19.570

pb2q 的回答是正确的。这个答案提供了一些关于您提出的特定警告消息的额外解释。

GCC 为`printf`. 内置函数具有正确的原型：

```
int printf(const char *, ...); 
```

但是，隐式声明假定一个固定数量的参数。因此，假设您的程序如下所示：

```
int main () {
    printf("%s\n", "Hello, World!");
    return 0; // not required in C 2011
} 
```

那么隐式声明`printf`将是：

```
int printf(char *, char *); 
```

这与内置函数的类型不匹配，因此是警告的措辞。您很可能在该消息之前收到一条警告消息，该消息抱怨一开始就缺少原型。

```
warning: implicit declaration of function 'printf' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:22:12.903

它很可能与您的编译器和默认库有关。如果您要链接到已经使用 printf 的标准库（可能是调试版本），那么 printf 将位于全局命名空间中并被链接。编译器警告你你没有明确声明 printf。您可以打开 -Werror 以使所有警告错误，然后编译器不会让它进入链接器阶段。

# c# - 如何在运行时以所有权限在 IIS 7 中运行的网站中创建文件夹？

> ID：11939972
> 
> 赞同：2
> 
> 时间：2012-08-13T18:16:14.260
> 
> 标签：c#, asp.net, iis, dotnetnuke

我的应用程序应该在执行期间创建一个文件夹结构，它将在其中创建、存储和处理运行时生成的文件。该系统已经在桌面应用程序中进行了测试，并且工作正常。现在我正在尝试在 C# asp.net webforms DNN 项目中使用它，但它并不符合预期。

当我调试项目时，目录是在以下位置创建的，我不明白的原因（但应用程序执行得很好）：

```
C:\Program Files\Common Files\microsoft shared\DevServer\10.0\ 
```

当我通过 localhost 环境（IIS 7、.NET 4.0、集成管道模式）运行相同的应用程序时，会引发以下异常：

> 发生严重错误。拒绝访问路径“c:\windows\system32\inetsrv\Processing\”。

“处理”目录也不是根据经过验证的应用程序逻辑创建的。

我希望在 IIS 中执行的应用程序的 bin 文件夹中创建此文件夹结构。我通过根据应用程序的 bin 文件夹中的要求创建虚拟目录结构，在所需位置手动创建了文件夹结构，但这也无济于事。

所以我的问题是：

*   请有人澄清在 IIS 中托管时，网站创建的目录和文件应该如何以及在何处保存。
*   我需要遵循哪些步骤来确保在具有所有权限的 IIS 7 中执行的我的应用程序的 bin 文件夹中创建文件和目录。
*   为了实现这一点，我必须进行任何代码修改吗？

非常感谢任何指向我写作方向的链接和答案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:40:59.917

默认情况下，您的 Web 服务器（IIS 或本地开发服务器）只会保存到其工作目录。如果要保存到特定路径，请使用*[MapPath](http://msdn.microsoft.com/en-us/library/system.web.ui.page.mappath.aspx)*（或*[Server.MapPath](http://msdn.microsoft.com/en-us/library/ms524632%28v=vs.90%29.aspx)*）获取与您的应用程序对应的物理路径。例如：

```
string path = MapPath("~/bin"); 
```

您还需要确保运行 IIS 的帐户对您需要写入的目录具有读/写权限。这意味着进入您的服务器并修改文件夹的权限。要查找用户帐户，您必须转到应用程序池下的*高级设置*并检查为*Identity*设置的内容。

# android - Webview SQLiteException：数据库被锁定

> ID：11939985
> 
> 赞同：3
> 
> 时间：2012-08-13T18:16:45.307
> 
> 标签：android, sqlite

我收到一个 SQLiteException 说数据库被锁定来自 web 视图。我实际上并没有在我的应用程序中使用任何 webviews，但我相信它与基于未回答的[其他堆栈溢出问题](https://stackoverflow.com/questions/9926901/android-webview-concurrency-caused-sqliteexception-database-is-locked)的 admob 有关。

我在自己的东西中使用 SQLite，但这不应该是它的原因吗？我似乎也无法复制它，所以我不确定如何修复它。有任何想法吗？

```
android.database.sqlite.SQLiteException: error code 5: database is locked
at android.database.sqlite.SQLiteStatement.native_execute(Native Method)
at android.database.sqlite.SQLiteStatement.execute(SQLiteStatement.java:61)
at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1916)
at android.webkit.WebViewDatabase.flushCacheStat(WebViewDatabase.java:874)
at android.webkit.CacheManager.trimCacheIfNeeded(CacheManager.java:566)
at android.webkit.WebViewWorker.handleMessage(WebViewWorker.java:193)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:143)
at android.os.HandlerThread.run(HandlerThread.java:60) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T12:04:08.740

你使用多个进程吗？我的意思是你的活动是在不同的过程中开始的吗？如果是，则可能会导致问题，因为 webview 使用单例进行数据库管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T08:56:19.897

**摘要：** *超过1个连接*

**说明：** 您需要将数据库连接设为单例实例（共享实例）。我能想到的是；当您打开超过 2 个数据库连接时（即使是同一个 sqlite db），通常会出现这种类型的错误。因此，请确保您只有 1 个连接处于活动状态，最简单的方法是使您的数据库实例成为单例并在整个应用程序中共享，这样（共享）您将始终只有一个连接将您链接到数据库.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T09:04:39.807

当多个线程同时更新数据库时会发生这种情况。您可以通过在代码中添加同步块来避免这种情况。

```
synchronized (this) {
        //update your database (one thread at time)
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T22:26:01.253

尝试修改 StrictMode 以查看有关错误的更多信息。它可能与主线程上的 Internet 访问、并发问题、很多问题有关，因此请尝试发布您的清单以查看和建议您，因为此 stackTrace 没有提供太多信息。并记得修改 StrictMode 并发布消息。

;)

# c# - Push Dispatcher - 我如何管理线程 c#

> ID：11939987
> 
> 赞同：1
> 
> 时间：2012-08-13T18:16:50.610
> 
> 标签：c#, multithreading

我有一个队列不断被工作项目填满，这些项目需要及时处理 - 所以我们有许多不同的处理器等待接收正在处理的项目

这些子处理器中的每一个一次只能处理一组数据，并且需要将数据推送给它，所以这就是我考虑的方式

它开始于：

1.  进程将项目插入队列
2.  队列应该是唯一的 - 这样如果一个项目已经在队列中，它不应该被重新插入（我现在不确定 - 但我可能需要提高这样一个项目的优先级，在这种情况下队列可能不会工作）

我刚在想

1.  Dispatcher 为每个可用的处理器创建一个对象
2.  开始循环：
3.  Dispatcher 检查队列中是否有要处理的项目
4.  Dispatcher 查找当前不工作的处理器
5.  Dispatcher 将工作项发送到空闲处理器
6.  转到开始循环：

我的问题是，我如何管理处理器对象上的线程我正在考虑执行以下操作之一：

1.  当处理器对象被调度程序触发时 - 创建一个线程并开始对其进行处理，当线程完成时让它死掉。- 明显的缺点：创建和杀死一堆线程（线程池会缓解这个问题吗？）
2.  为将完成其工作的每个处理器创建一个专用线程，然后检查处理器对象以查看是否还有其他工作要做 - 明显缺点：50 个处理器意味着 50 个线程，并且同步可能会变得困难
3.  可能有一种更简单的方法可以做到这一点

谢谢 **编辑**

我似乎一直不清楚 - 数据不必由所有处理器处理它可以由任何处理器处理 - 但是一旦处理器开始处理数据，我们不能向它发送任何新数据，直到它完成处理 - 同时新数据涌入队列，经理需要尽可能快地整理数据 -

所以循环又是这样

1.  Dispatcher 查看是否有可用的处理器以及队列中是否有要处理的项目
2.  Dispatcher 选择一个空闲的处理器并从队列中弹出顶部的数据并将其发送到该处理器进行处理
3.  调度员稍等片刻，再次入池

在处理器端 - 数据被发送到外部系统（一个有点长的过程），处理器等待外部系统返回并存储处理过的数据 - 只有这样处理器才能使用，除了一组新的数据关闭队列的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:37:28.513

我设法完成类似队列管理系统的最简单方法是使用 C# 中的内置队列对象。

```
public volatile Queue<MessageObject> q = new Queue<MessageObject>(); 
```

现在必须将消息发送到每个线程，如果您真的不想处理同步，请锁定并弹出顶部对象。您可以假脱机线程，或使用 EventHandler。如果使用 EventHandler，则需要在两个线程上同步，但它应该更快。

```
lock(q) { 
    this.nextcommand = q.Pop();
} 
```

# sql - 如何从 SQL 中的另一个表中获取计数？

> ID：11939989
> 
> 赞同：2
> 
> 时间：2012-08-13T18:16:59.540
> 
> 标签：sql, count, group-by, inner-join

我在 SQL 上有以下表格：

门萨耶斯

```
IdMensaje (int) PK NOT NULL
IdCliente (int)
CorreoCliente (varchar(100))
CorreosAdicionales (varchar(MAX))
Tema (varchar(100))
Mensaje (varchar(MAX))
Fecha (date)
Hora (time(5)) 
```

档案馆

```
IdArchivo (int) PK NOT NULL
IdMensaje (int)
Nombre (varchar(200)) 
```

外键 Mensajes.IdMensaje ON Archivos.IdMensaje

如果您想知道 Mensajes.IdCliente 是什么，是的，它与另一个表有一个外键，但这是另一回事

首先是介绍...我正在制作一个程序，您可以在其中发送电子邮件...当您发送电子邮件时，我将在 Mensajes 上插入所有数据，如果您在邮件上附加文件，它也会插入每个文件的存档（很明显，Archivos.IdMensaje 等于之前插入的 Mensajes.IdMensaje）

所以这是我的问题：我想在从 Mensajes 获取所有数据的地方进行查询，但还要添加另一列，其中将显示该消息附加了多少文件......我设法使用了一个查询，其中我确实得到了该数据（嗯，有点）

```
SELECT Mensajes.IdMensaje, COUNT(Archivos.IdArchivo) AS Expr1
FROM Mensajes INNER JOIN Archivos ON Mensajes.IdMensaje = Archivos.IdMensaje
GROUP BY Mensajes.IdMensaje 
```

但是它只显示附加了文件的消息，而不是结果为 0 的消息，我也想显示这些消息......我该怎么做？

希望你能帮助我谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:19:41.907

将您的更改`INNER JOIN`为`LEFT OUTER JOIN`; 这将选择所有记录，`Mensajes`即使它们在`Archivos`.

# azure - 如何使用当前 1.7 本地开发存储运行 Azure .Net SDK 1.7.1？

> ID：11939990
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:01.333
> 
> 标签：azure, azure-blob-storage

我试图将来自 Github 的 Azure .Net SDK 1.7.1 版（https://github.com/WindowsAzure/azure-sdk-for-net/tree/sdk_1.7.1）与本地开发存储一起使用。我想使用 1.7.1 SDK 中有一些很棒的功能，但是当我在项目中使用 1.7.1 DLL 时，我针对本地开发存储运行的测试开始以 400 - Bad Header 失败首次访问时出错。经过一番努力，我发现在这里将 x-ms-version 从“2012-02-12”更改为“2011-08-18”：

在常量.cs 中：

```
 internal const string TargetStorageVersion = "2011-08-18"; 
```

这解决了第一个问题，但现在 GetBlobList 与 UseFlatBlobListing = true 现在失败并出现错误。这是否不适用于 1.7 本地开发存储？或者，有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T02:55:58.017

据我所知，你不能。存储模拟器尚不支持最新版本的 REST API（版本 2012-02-12）中可用的功能，例如异步复制 blob、租约等。

# java - 如何创建 RSA 密钥对以便将其存储在数据库中？

> ID：11939992
> 
> 赞同：4
> 
> 时间：2012-08-13T18:17:13.690
> 
> 标签：java, rsa

我正在尝试实现一个变异加密算法（理论上由我开发），作为要求的一部分，我需要生成一个 RSA 密钥对并将其存储在数据库中，以便以后可以在加密过程中检索它（仅用于加密会话密钥，以便它可以与加密消息一起安全发送）。

我尝试生成 RSA 密钥对似乎可行，但是它会一遍又一遍地生成相同的值，而不是每次运行代码时都提供新的密钥对。我做错什么了？此外，如果这些值取决于机器本身（因此显示相同的值），是否有办法将密钥对生成链接到提供的电子邮件地址，以便每次输入新的电子邮件地址时都会输出不同的 RSA 密钥对?

以下代码是我尝试生成密钥对：

```
import java.security.*;
import java.security.*;
/**
 * @author Speedy gonzales
 */
public class test {

    public static void main(String[] args) throws NoSuchAlgorithmException,        NoSuchProviderException {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
        keyGen.initialize(1024);

        byte[] publicKey = keyGen.genKeyPair().getPublic().getEncoded();
        StringBuffer retString1 = new StringBuffer();
        retString1.append("[");

        for (int puk = 0; puk < publicKey.length; ++puk) {
            retString1.append(publicKey[puk]);
           // retString1.append(", ");
        }
        retString1 = retString1.delete(retString1.length()-2,retString1.length());
        retString1.append("]");
        System.out.println(retString1);

          byte[] privateKey = keyGen.genKeyPair().getPrivate().getEncoded();
        StringBuffer retString2 = new StringBuffer();
        retString2.append("[");

        for (int pri = 0; pri < privateKey.length; ++pri) {
            retString2.append(privateKey[pri]);
           // retString2.append(", ");
        }
        retString2 = retString2.delete(retString2.length()-2,retString2.length());
        retString2.append("]");
        System.out.println(retString2); 
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:35:51.630

那么，你的第一个问题是：

```
keyGen.genKeyPair().getPublic().getEncoded();
keyGen.genKeyPair().getPrivate().getEncoded(); 
```

您没有保存密钥对，因此您正在生成不匹配的公钥和私钥。从 javadocs 中，`genKeyPair()`行为如下：

> 这将在每次调用时生成一个新的密钥对。

其次， getEncoded() 只是将键作为字节数组返回。如果您的数据库可以存储二进制值，那么就以这种方式存储它。否则，您可能会有更好的运气以某种方式将其转换为字符串。例如，您可以使用这个巧妙的小技巧对它进行 base 64 编码（可能比您正在做的更可靠）：

```
String keyAsString = new BigInteger(publicKey.getEncoded()).toString(64); 
```

您随后可以通过以下方式取回原始字节：

```
byte[] bytes = new BigInteger(keyAsString, 64).toByteArray(); 
```

你说你每次运行都得到相同的值（并确保你在为此烦恼之前），我不是 100% 确定为什么。您应该能够访问算法参数（您可能必须将密钥转换为不同的类型），尝试打印它们以查看它们是否相同。有人提到检查您的随机数生成器，这也可能是个好主意。

# ruby - Ruby子哈希比较

> ID：11939994
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:20.770
> 
> 标签：ruby

所以我有一个哈希值....

```
 @win_moves = {
    :wm01 => {:a1=>"X", :a2=>" ", :a3=>" ", :b1=>" ", :b2=>"X", :b3=>" ", :c1=>" ", :c2=>" ", :c3=>"X"},
    :wm02 => {:a1=>" ", :a2=>"X", :a3=>" ", :b1=>" ", :b2=>"X", :b3=>" ", :c1=>" ", :c2=>"X", :c3=>" "},
    :wm03 => {:a1=>" ", :a2=>" ", :a3=>"X", :b1=>" ", :b2=>"X", :b3=>" ", :c1=>"X", :c2=>" ", :c3=>" "},
    :wm04 => {:a1=>" ", :a2=>" ", :a3=>" ", :b1=>"X", :b2=>"X", :b3=>"X", :c1=>" ", :c2=>" ", :c3=>" "},
    :wm05 => {:a1=>"X", :a2=>"X", :a3=>"X", :b1=>" ", :b2=>" ", :b3=>" ", :c1=>" ", :c2=>" ", :c3=>" "},
    :wm06 => {:a1=>" ", :a2=>" ", :a3=>" ", :b1=>" ", :b2=>" ", :b3=>" ", :c1=>"X", :c2=>"X", :c3=>"X"}
  } 
```

我想像这样的哈希..

```
@thegrid = {:a1=>"X", :a2=>"O", :a3=>" ", :b1=>"O", :b2=>"X", :b3=>" ", :c1=>" ", :c2=>" ", :c3=>"X"} 
```

并将其与 X 值的前一个哈希 @win_moves 进行比较，这样我就会在 @win_moves[0] 上得到一个肯定的匹配（在这种情况下是答案）......我需要检查 X 的存在。

你能为我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:43:28.277

以下将在@win_moves 中找到与@thegrid 匹配的X 的所有键：

```
keys_with_x = @thegrid.select{ |k, v| v == "X" }.keys
matching_moves = @win_moves.select{ |k, v| v.select{ |k, v| v == "X" }.keys == keys_with_x }
puts matching_moves.keys
#=> wm01 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:43:34.203

如果您不介意破坏您的 @thegrid 哈希，您可以执行以下操作：

```
@winmoves.has_value? @thegrid.each { |k, v| thegrid[k] = " " if v == "O" } 
```

如果您的 winmove 中的任何键匹配，这将返回 true。如果您需要非破坏性地执行此操作，则以下内容应该可以工作：

```
a_new_hash = @thegrid.inject({}) { |h, (k, v)| h[k] = " " if v == "O"; h }
@winmoves.has_value? a_new_hash 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:50:07.273

我认为你可以这样做：

```
@win_moves.any?{|k,v| v.reject{|a,b| b != 'X'} == @thegrid.reject{|c,d| d!= 'X'}} 
```