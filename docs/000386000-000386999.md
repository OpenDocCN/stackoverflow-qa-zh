# StackOverflow 问答 000386000-000386999

# sql - 如何使用分组行对 SQL 查询进行排序

> ID：386006
> 
> 赞同：0
> 
> 时间：2008-12-22T11:05:49.117
> 
> 标签：sql, ms-access, sql-order-by

我在 MS Access 中有表（Product_Id，类别优先级，atribute1，atribute2 ...），我正在尝试进行查询，对按类别分组的数据进行排序，并按最高优先级排序。优先级可以为 Null，所以应该放在最后。示例：表格

```
1, 100, 2, atr1, atr2
2, 300,  , atr1, atr2
3, 100, 5, atr1, atr2
4, 200, 9, atr1, atr2
5, 100,  , atr1, atr2
6, 200, 1, atr1, atr2 
```

查询中的预期结果：

```
6, 200, 1, atr1, atr2
4, 200, 9, atr1, atr2
1, 100, 2, atr1, atr2
3, 100, 5, atr1, atr2
5, 100,  , atr1, atr2
2, 300,  , atr1, atr2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T13:16:31.210

在 Jet SQL 中，这可能适合：

```
SELECT t2.MinOfPriority, tn.Field2, Nz([tn.Field3],999) AS Priority, 
       tn.Field4, tn.Field5
FROM tn 
INNER JOIN (SELECT Min(Nz(tn.Field3,999)) AS MinOfPriority, tn.Field2
            FROM  tn GROUP BY tn.Field2) AS t2 ON tn.Field2 = t2.Field2
ORDER BY t2.MinOfPriority, tn.Field2, Nz([Field3],999); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T06:43:14.183

最简单的解决方案（在某些情况下不一定是最好的）是在排序表达式中使用列号：

```
SELECT t2.MinOfPriority, 
       tn.Field2, 
       Nz([tn.Field3],999) AS Priority,        
       tn.Field4, 
       tn.Field5

ORDER BY 1,2,3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T11:17:50.733

您需要对类别进行加权（我用一些适当大的值加权 null）：

```
select  t1.* 
from    myTable t1 
join 
( 

    select  category, min(coalesce(priority, 1000)) weight
    from    myTable 
    group by category
) t2 
on t1\. category = t2\. category
order by t2.weight, coalesce(t1\. priority, 1000) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-22T12:18:23.513

据我所知，当使用显式 ORDER BY 时，Jet*总是*将 NULL 排序到结果集的末尾。

请参阅：[ADO 提供程序属性和设置](http://msdn.microsoft.com/en-us/library/aa140022.aspx)

"NULL Collat​​ion Order: 一个 Long 值（只读），指定在哪里对 Null 值进行排序（排序）。对于 Microsoft Jet 提供程序，该值始终为 4，这表明空值在列表的低端排序。”

NULL Collat​​ion Order 属性对于提供者来说是只读的这一事实强烈表明 Jet 引擎只有一个 NULL 排序规则，而且对您来说很高兴，它就是您想要的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-22T13:19:35.230

[显然](https://stackoverflow.com/questions/247858/coalesce-alternative-in-access-sql)NZ(Value, ValueToReturnIfNull) 可以在 MSAccess 上用作 ISNULL 的替代品，所以......

```
SELECT a.*
FROM this_table AS a 
    INNER JOIN 
    (
        SELECT category,min(NZ(priority,999999)) as min_priority_in_cat 
        FROM this_table group by category
    ) AS b ON a.category = b.category
ORDER BY  b.min_priority_in_cat, a.category, NZ(a.priority,999999) 
```

# .net - 我应该学习 F# 还是函数式编程语言？

> ID：386011
> 
> 赞同：19
> 
> 时间：2008-12-22T11:08:25.133
> 
> 标签：.net, f#

我应该花时间学习微软的新 F# 语言吗？我主要是一名 C# .NET 开发人员，我想知道学习 F# 是否会对开发当今的典型应用程序有所帮​​助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-22T12:27:34.477

F# 是开始学习函数式语言的绝佳场所。如果您担心 F# 知识不适用于其他函数式语言，那么您不应该这样做。F# 是 ML 语言家族的成员。Microsoft 只是对其进行了一些调整，使其与 .NET 兼容。

Luca Bolognese 在 PDC 2008 上发表了关于 F# 的[精彩演讲](http://channel9.msdn.com/pdc2008/TL11/)。我强烈建议您观看并自行决定 F# 是否值得学习。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-22T11:18:09.653

看看那些让你有不同想法的编程语言是值得的，如果你是 C# 开发人员，F# 可能是你发现最容易使用的函数式编程语言。

即使您决定不想使用 F# 开发应用程序，使用 F# 的体验也可能会改变您编写 C# 的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T11:24:30.360

你说，“我应该学习函数式编程语言吗？”

如果您想更深入地了解编程，我说您应该这样做。学习 LISP 对我来说是一次大开眼界的冒险。一开始很难。然后有一天，好像被施了魔法一样，这对我来说很自然。这只会更好地提高您以不同方式看待问题的能力。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-22T11:53:10.503

我很久以前就学过 Prolog，在很多方面它仍然是我最喜欢的语言。现在 Prolog 不仅是一种函数式语言，而且是一种 AI 语言，但是前段时间我学习了基于 Prolog 的 Erlang。我可以建议您学习这两种语言，因为您学到了很多有益于您日常开发的语言 - 例如 - C#。

如果我今天要学习一门新的函数式语言，那很可能是 F#，因为它将成为 .Net 平台的一等公民。我认为 F# 是一种功能性（以及多范式）语言，您将有最好的机会在其中发挥作用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T11:39:52.043

查看[什么是 C# 程序员学习的第二语言中的回答。](https://stackoverflow.com/questions/349418/what-would-be-a-good-second-language-to-learn-for-a-c-programmer)底线是：函数式语言提供了一种全新的范式，并且对您很有价值，因为它将提高您的编程技能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T19:18:53.070

它对开发“通用”应用程序有用吗？不是特别的，反正不比c或c#多或少。它不是 RAD，因此 F# 中没有可用的快捷方式可以让您比任何其他非 RAD 语言更快地发布“通用”应用程序。

另一方面，对于计算多于表示的程序，F# 可能比另一种语言更接近应用程序领域。函数式语言使处理某些问题域更加直观。

我个人认为它值得学习，不是因为它会解决你所有的问题，而是因为每个值得一试的程序员都应该知道至少一种函数式语言。当函数式编程概念在您的脑海中浮现时，许多看似巴洛克式的编程概念变得更加透明。

我的另一个个人喜好；我喜欢具有可靠、多样化类型系统的编程语言。我不喜欢将鞋角结构转换成与它们没有很强概念匹配的类型。在我看来，ML 类型系统允许您以比更主流的类型系统更精细的粒度构建类型。因此，我觉得我可以使用 F# 等 ML 风格的语言以更自然的方式编写与这些结构交互的代码。

虽然这对常见概念没有多大帮助，但对于更主流语言的特性集支持它们，对于任何不常见的东西，我更喜欢 F# 而不是大多数其他语言。

# unit-testing - 在没有 ExpectedException 属性的情况下预期 nUnit 中的异常

> ID：386017
> 
> 赞同：3
> 
> 时间：2008-12-22T11:11:15.877
> 
> 标签：unit-testing, exception, nunit

我有**多个参数**的方法，只要任何参数为空，就通过抛出 ArgumentNullExceptions 和 ArgumentExceptions 来防止输入错误。

所以有两种明显的方法来测试这个：

*   使用 [ExpectedException] 属性对每个参数进行一次测试
*   使用多个 try{} 捕获块对所有参数进行一项测试

try catch 看起来像这样：

```
try 
{
    controller.Foo(null, new SecondParameter());
    Assert.Fail("ArgumentNullException wasn't thrown");
} catch (ArgumentNullException)
{} 
```

有一个小问题。如果测试通过，Assert.Fail 永远不会被调用，因此将突出显示为未覆盖的测试代码（由 NCover）。

我知道这实际上不是问题，因为它是我想要 100% 覆盖的业务代码，而不是测试代码。我仍然很好奇是否有一种方法可以将多个抛出异常的调用压缩到一个测试用例中而不会有死的 LoC？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T11:30:12.923

好吧，您可以通过提取实用方法将其减少到一个死线，例如

```
public void ExpectException<T>(Action action) where T : Exception
{
    try
    {
        action();
        Assert.Fail("Expected exception");
    }
    catch (T)
    {
        // Expected
    }
} 
```

调用它：

```
ExpectException<ArgumentNullException>
    (() => controller.Foo(null, new SecondParameter()); 
```

（当然，您不需要将其包装在 IDE 中...... SO 上的行长很短。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-23T08:11:10.187

从[NUnit 2.4.7 的发行说明中，](http://nunit.org/index.php?p=releaseNotes&r=2.4.7) NUnit 现在在其扩展程序集中包含由 Andreas Schlapsi 编写的 RowTest 扩展。此扩展允许您编写接受参数的测试方法并使用 RowAttribute 提供多组参数值。要使用 RowTest，您的测试必须引用 nunit.framework.extensions 程序集。

它将 MbUnit 的 RowTest 功能添加到 NUnit。

您可以编写如下内容：

```
[RowTest]
[Row(1, 2, 3)]
[Row(3, 4, 8, TestName="Special case")]
[Row(10, 10, 0, TestName="ExceptionTest1"
    , ExpectedException=typeof(ArgumentException)
    , ExceptionMessage="x and y may not be equal.")]
[Row(1, 1, 0, TestName="ExceptionTest2"
    , ExpectedException=typeof(ArgumentException)
    , ExceptionMessage="x and y may not be equal.")]
public void AddTest(int x, int y, int expectedSum)
{
  int sum = Sum(x, y);
  Assert.AreEqual(expectedSum, sum);
} 
```

[http://www.andreas-schlapsi.com/2008/03/31/nunit-247-includes-rowtest-extension/代码来自](http://www.andreas-schlapsi.com/2008/03/31/nunit-247-includes-rowtest-extension/)[Google 代码](http://code.google.com/p/rowtest-extension/downloads/list) 中 Nunit RowTestExtension 的源代码

# web-applications - IP 电话到 Web 应用程序的集成

> ID：386034
> 
> 赞同：3
> 
> 时间：2008-12-22T11:26:27.627
> 
> 标签：web-applications, voip, sip, telephony

如果我想从我的 Web 应用程序控制 IP 电话，我应该如何开始？

假设我有一个连接到 IP 电话服务提供商的独立 IP 电话。另一方面，我有一个用于销售支持的服务器端 Web 应用程序。我想通过这个网络应用程序在我的手机上发起呼叫，另一方面，当我的客户打电话给我时，我想在网络浏览器上获得一个包含客户数据的弹出窗口。

在旧时代，我们有像 JTAPI 和 TAPI 这样的[CTI](http://en.wikipedia.org/wiki/Computer_telephony_integration)（计算机电话集成）标准，那么今天 IP 电话时代的通用标准（如果有的话）是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T11:53:29.367

1.  我找到了一个与 .NET GUI 打包在一起的 ActiveX 控件。我也将它用作网页中的嵌入式 ActiveX 控件。 [http://www.opensipstack.org/solegy/releases/ossphone/070810/OSSPhoneSetup.msi](http://www.opensipstack.org/solegy/releases/ossphone/070810/OSSPhoneSetup.msi)

2.  您可以使用 SIP 标头来传递信息，也可以使用任何人都可以使用的参数。例如，sip:alice@atlanta.com;protocol=tcp;accountnumber=1234。SIP 通信将使用 TCP 而不是 UDP，因为我们在 URL 中指定了它，您的应用程序可以在您与呼叫者通话之前查找帐户信息。现代调用语言（CCXML 和 VXML）使用 aai（应用程序到应用程序信息）标头来传递 CTI 信息。

如果您的系统中涉及许多电话方（交换机、ivr、呼叫中心、通话录音等），您可能会发现有些仍然需要使用 CTI 设备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T10:11:53.453

您可能仍需要使用某种形式的 CTI 集成来控制手机。这实际上取决于您要控制的手机类型以及如何进行此操作。

例如，可以通过将 TAPI 和 JTAPI 集成到其呼叫管理器 PBX 中来控制 Cisco IP 电话。Mitel 手机可以使用他们自己的名为 MiTAI 的 API 进行控制，该 API 与他们的 ICP 对话。

如果您的 IP 电话是 SIP，则您可以向提供商发起呼叫，就好像它来自您的电话一样，并将电话仅用于音频处理。

对于传入呼叫，您需要解码传入的 IP 信息（同样可能是 SIP），以便您可以使用它来弹出所需的网页。

我认为您需要与您的 IP 电话提供商核实，以了解他们可能已经提供了什么样的集成，或者至少为您提供有关您正在使用的 IP 电话类型的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T10:41:23.427

根据您使用的 PBX 的类型，用于通信的协议很少。我相信CSTA是现在最流行的。您可以检查您的 PBX 是否支持它，如果支持，则直接与其对话以控制您的 IP 电话。

如果您的 PBX 不支持 CSTA，您可以检查它是否提供 TAPI 驱动程序并使用此驱动程序进行通信。

这是 CSTA 标准文档：

[http://www.ecma-international.org/activities/Communications/TG11/cstaIII.htm](http://www.ecma-international.org/activities/Communications/TG11/cstaIII.htm)

# wpf - WPF 文本框和滚动行为

> ID：386039
> 
> 赞同：12
> 
> 时间：2008-12-22T11:31:16.460
> 
> 标签：wpf, controls, panels

我有个问题。我需要在 ScrollViewer 中托管带有控件的网格，以防止文本框在 UI 处被截断或折叠为零。我还希望在用户更改窗口宽度时扩展文本框的 with。我将 Window 的内容设置为以下代码

```
<DockPanel>
    <TreeView DockPanel.Dock="Left" Width="150"/>
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Text="Name" 
                       Margin="5" 
                       VerticalAlignment="Center"/>
            <TextBox Grid.Column="1"
                     Text="Some Name"
                     Margin="5"
                     VerticalAlignment="Center"
                     MinWidth="200"/>
        </Grid>
    </ScrollViewer>
</DockPanel> 
```

一切正常，但是当用户在 TextBox 中键入很长的文本时，它会被展开并出现水平滚动。是否有任何简单的方法来限制 TextBox 的最大宽度并仅在用户更改窗口大小时才允许它展开。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-22T20:55:28.210

问题在于，父元素为 TextBox 提供了它认为需要的尽可能多的空间，并且当存在更多文本时，它会扩展而不是保持初始自动大小。

这里的一个解决方案是制作另一个自动调整大小的元素并将 TextBox.Width 绑定到它：

```
<DockPanel>
    <TreeView Width="150" DockPanel.Dock="Left"/>
    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Margin="5" VerticalAlignment="Center" Text="Name"/>
            <Border x:Name="b" Grid.Column="1" Margin="5"/>
            <TextBox Width="{Binding ActualWidth, ElementName=b}"
                     MinWidth="200"
                     Grid.Column="1"
                     Margin="5"
                     VerticalAlignment="Center"
                     Text="Some Name"/>
        </Grid>
    </ScrollViewer>
</DockPanel> 
```

**请注意，我们设置了自动调整大小元素（边框）的 Margin 属性。** 这很重要，因为如果没有设置，就会出现循环：

1.  边框宽度自动调整为网格列宽
2.  文本框宽度调整为 Border.ActualWidth
3.  网格列宽调整为 TextBox 宽度 + TextBox 边距
4.  边框宽度再次自动调整为网格列宽

通过将 Margin 设置为与 TextBox 相同，TextBox 的大小调整不会影响 Grid 的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-25T22:08:20.133

`TextBox.MeasureOverride`像这样覆盖对我有用：

```
protected override Size MeasureOverride(Size constraint)
{
    Size origSize = base.MeasureOverride(constraint);
    origSize.Width = MinWidth;
    return origSize;
} 
```

# database - 复合主键中的可为空列有什么问题？

> ID：386040
> 
> 赞同：168
> 
> 时间：2008-12-22T11:33:55.363
> 
> 标签：database, database-design

ORACLE 不允许在包含主键的任何列中使用 NULL 值。大多数其他“企业级”系统似乎也是如此。

同时，大多数系统还允许可空列上*的唯一*约束。

为什么唯一约束可以有 NULL 而主键不能？这是否有一个基本的逻辑原因，或者这更多的是技术限制？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2008-12-22T11:46:27.647

主键用于唯一标识行。这是通过将键的所有部分与输入进行比较来完成的。

根据定义，NULL 不能成为成功比较的一部分。即使与自身 ( `NULL = NULL`) 进行比较也会失败。这意味着包含 NULL 的键将不起作用。

此外，外键中允许使用 NULL，以标记可选关系。^((*))允许它在 PK 中也会打破这一点。

* * *

^((*))提醒一句：具有可为空的外键不是干净的关系数据库设计。

如果有两个实体`A`并且可以选择与`B`where相关，则干净的解决方案是创建一个解析表（比如说）。该表将链接：如果存在*关系*，则它将包含一条记录，如果*没有*，则它不会。`A``B``AB``A``B`

 *** * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-12-22T11:53:50.083

**主键为表中的每一**行定义了一个唯一标识符：当表具有主键时，您有一种保证方法可以从中选择任何行。

唯一约束不一定标识每一行；它只是指定**如果**一行在其列中有值，**那么**它们必须是唯一的。这不足以唯一标识**每一**行，这是主键必须做的。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2013-04-20T19:59:06.363

从根本上说，多列主键中的 NULL 没有任何问题。但是有一个设计者可能并不打算这样做，这就是为什么许多系统在您尝试此操作时会抛出错误。

考虑将模块/包版本存储为一系列字段的情况：

```
CREATE TABLE module
  (name        varchar(20) PRIMARY KEY,
   description text DEFAULT '' NOT NULL);

CREATE TABLE version
  (module      varchar(20) REFERENCES module,
   major       integer NOT NULL,
   minor       integer DEFAULT 0 NOT NULL,
   patch       integer DEFAULT 0 NOT NULL,
   release     integer DEFAULT 1 NOT NULL,
   ext         varchar(20),
   notes       text DEFAULT '' NOT NULL,
   PRIMARY KEY (module, major, minor, patch, release, ext)); 
```

主键的前 5 个元素是发布版本的常规定义部分，但某些包具有自定义扩展名，通常不是整数（如“rc-foo”或“vanilla”或“beta”或其他任何人*四个*领域不足的人可能会梦想）。如果一个包没有扩展，那么在上面的模型中它是 NULL ，这样放东西不会造成任何伤害。

但什么*是*NULL？它应该代表*缺乏*信息，一个未知数。也就是说，也许这更有意义：

```
CREATE TABLE version
  (module      varchar(20) REFERENCES module,
   major       integer NOT NULL,
   minor       integer DEFAULT 0 NOT NULL,
   patch       integer DEFAULT 0 NOT NULL,
   release     integer DEFAULT 1 NOT NULL,
   ext         varchar(20) DEFAULT '' NOT NULL,
   notes       text DEFAULT '' NOT NULL,
   PRIMARY KEY (module, major, minor, patch, release, ext)); 
```

在这个版本中，元组的“ext”部分不是 NULL，但默认为空字符串——这在语义上（实际上）与 NULL 不同。NULL 是未知的，而空字符串是“不存在的东西”的故意记录。换句话说，“空”和“空”是不同的东西。这就是“我这里没有价值”和“我不知道这里有什么价值”的区别。

当您注册一个缺少版本扩展的包时，您*知道*它缺少扩展，因此空字符串实际上是正确的值。只有当您不知道它是否有扩展名，或者您知道它有但不知道它是什么时，NULL 才是正确的。这种情况在字符串值是标准的系统中更容易处理，因为除了插入 0 或 1 之外，没有其他方法可以表示“空整数”，这最终会在以后进行的任何比较中汇总（其中有其自身的含义）*。

顺便说一句，这两种方法在 Postgres 中都是有效的（因为我们正在讨论“企业”RDMBS），但是当您将 NULL 放入混合中时，比较结果可能会有很大差异——因为 NULL ==“不知道”所以所有涉及 NULL 的比较结果最终为 NULL，因为您无法知道未知的事物。**危险！**仔细考虑一下：这意味着 NULL 比较结果通过一系列比较*传播。*在排序、比较等时，这可能是细微错误的来源。

Postgres 假定您是成年人并且可以自己做出这个决定。Oracle 和 DB2 假设您没有意识到自己在做一些愚蠢的事情并抛出错误。这*通常*是正确的，但并非总是如此——在某些情况下，您*实际上*可能不知道并且有一个 NULL，因此留下一个带有未知元素的行，不可能进行有意义的比较是正确的行为。

在任何情况下，您都应该努力消除您在整个架构中允许的 NULL 字段的数量，并且在涉及作为主键一部分的字段时加倍消除。在绝大多数情况下，NULL 列的存在表明模式设计未规范化（与故意非规范化相反），在被接受之前应该仔细考虑。

[**注意：可以创建一个自定义类型，它是整数的联合和一个“底部”类型，语义上意味着“空”而不是“未知”。不幸的是，这在比较操作中引入了一些复杂性，并且通常真正的类型正确在实践中不值得付出努力，因为首先根本不应该允许您使用许多`NULL`值。`BOTTOM`也就是说，如果 RDBMS除了`NULL`防止随意将“无值”语义与“未知值”混为一谈的习惯外，还可以包含一个默认类型，那就太好了。*]

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-12-22T11:58:56.483

NULL == NULL -> false（至少在 DBMS 中）

因此，即使使用具有实际值的附加列，您也无法使用 NULL 值检索任何关系。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-02-25T13:51:27.250

托尼安德鲁斯的答案是一个不错的答案。但真正的答案是，这是关系数据库社区使用的约定，并不是必需的。也许这是一个很好的约定，也许不是。

将任何内容与 NULL 进行比较会导致 UNKNOWN（第三个真值）。因此，正如 nulls 所暗示的那样，所有关于平等的传统智慧都消失了。乍一看就是这样。

但我认为不一定如此，甚至 SQL 数据库也不认为 N​​ULL 会破坏所有比较的可能性。

在您的数据库中运行查询 SELECT * FROM VALUES(NULL) UNION SELECT * FROM VALUES(NULL)

您看到的只是一个元组，其中一个属性的值为 NULL。所以联合在这里承认这两个 NULL 值是相等的。

将具有 3 个组件的复合键与具有 3 个属性 (1, 3, NULL) = (1, 3, NULL) <=> 1 = 1 AND 3 = 3 AND NULL = NULL 的元组进行比较时，结果为 UNKNOWN .

但是我们可以定义一种新的比较运算符，例如。==。X == Y <=> X = Y 或（X 为空且 Y 为空）

拥有这种相等运算符将使具有空组件的复合键或具有空值的非复合键没有问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-06-14T07:20:49.740

我仍然认为这是技术性带来的基本/功能缺陷。如果您有一个可以识别客户的可选字段，那么您现在必须在其中添加一个虚拟值，因为 NULL ！= NULL，不是特别优雅，但它是一个“行业标准”

# django - 如何在表单字段的标签中添加链接

> ID：386042
> 
> 赞同：19
> 
> 时间：2008-12-22T11:34:24.317
> 
> 标签：django

我想要一个用于条款和条件的复选框，其标签应包含指向带有条款和条件的页面的链接。

以下字段将包含带有转义标签的标签。

```
BooleanField(label="I agree to <a href='terms-conditions.html'>terms&conditions</a>") 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-11-06T16:56:14.850

[如http://www.kelvinism.com/howtos/using-html-django-form-label/](http://www.kelvinism.com/howtos/using-html-django-form-label/)中所述，从 utils.safestring 导入 django 的 mark_safe

从链接：

```
from django.utils.safestring import mark_safe
from django import forms

class AccountForm(forms.Form):
    name = forms.CharField(widget=forms.TextInput(), 
                           max_length=15, 
                           label=mark_safe('Your Name (<a href="/questions/whyname/" target="_blank">why</a>?)')) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-16T12:22:13.660

[这是关于表单迭代主题的 Django 文档](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#looping-over-the-form-s-fields)的正确链接。

你想要的是：

```
<form method="post">
{% for field in form %}
    <p>
        {{ field.errors }}
        {{ field.label_tag }}: {{ field }}
        {% if field.name == "toc" %}
          <a href="{% url terms %}">Terms and Conditions</a>
        {% endif %}
    </p>
{% endfor %}
<p><input type="submit" value="Send message" /></p>
</form> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-23T08:27:24.923

如果不希望对 URL 进行硬编码，您可以从构造函数中设置字段的标签：

```
from django import forms
from django.core.urlresolvers import reverse_lazy
from django.utils.safestring import mark_safe
from django.utils.translation import ugettext as _

class ExampleForm(forms.Form):
    name = forms.CharField(max_length='255', label=_('Name'))
    forms.BooleanField(label=_("Terms and Conditions"), required=False)

    def __init__(self, **kwargs):
        super(ExampleForm, self).__init__(**kwargs)
        terms_and_conditions = reverse_lazy("terms_and_conditions")
        self.fields['read_terms'].label = mark_safe(_("I have read and agree with the "
                                                      "<a href='%s'>Terms and Conditions</a>")) % (terms_and_conditions) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-22T11:51:08.637

我不确定 django 是如何工作的，但是如果上面代码中的标签创建了：

```
<label>I agree to terms&conditions</label> 
```

元素那么这不是这样做的方法。

label 元素默认选择关联的字段，因此您将混合 2 个单击操作（一个检查，另一个打开窗口）

我只想添加您的标签，并在其旁边添加一个 a:href。

```
<label>I agree to terms&conditions</label> (<a href="terms-conditions.html">terms&conditions</a>) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T21:54:21.367

让我猜猜 - 你正在使用`django_registration`- 我知道我不是唯一遇到这个问题的人:)

正如[scunliffe](https://stackoverflow.com/users/6144/scunliffe)所说，标记最好不要放在标签标记中 - 这是一个简短的模板片段，可以做你想做的事情，而不需要用 HTML 写出整个事情：

```
{% for field in form %}
    {{ field.label_tag }}
    {% ifequal field.name 'tos' %}
        <a href="/terms/">I have read and agreed to the Terms of Service</a>
    {% endif %}
{% endif %} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-18T14:57:37.093

我也认为在标签中硬编码链接不是一个好的变体。所以最好使用`render_to_string`from `django.template.loader`。我们还需要考虑像 i18n 这样的懒惰。`keep_lazy_text`并且`lazystr`符合我们对它的要求。所以结果它：

*表格.py*

```
from django.utils.functional import keep_lazy_text, lazystr
from django.template.loader import render_to_string
from allauth.account.forms import SignupForm

lazy_render_to_string = keep_lazy_text(render_to_string)

def lazy_render(template_name):
    """
    Keep laziness for rendering to string from template
    """
    return lazy_render_to_string(lazystr(template_name))

class ExtendedSignupForm(SignupForm):

    accept_term_of_use = forms.BooleanField(
        label=lazy_render('common/accept_term_of_use_label.html'),
        required=True
    )

    field_order = [
        'email',
        'password1',
        'password2',
        'accept_term_of_use'
    ] 
```

*common/accept_term_of_use_label.html*

```
Accept <a href="{% url "term_of_use" %}" target="_blank">Term Of Use</a> and <a href="privacy_statement" target="_blank">Privacy Statement</a>. 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-04T13:44:44.337

我知道这个问题很老，但我找到了解决方案

表格.py

```
from django.urls import reverse
from django.utils.functional import lazy

privacy = forms.BooleanField(label = lazy(lambda: _("Privacy <a href='%s' a>policy</a>" % reverse('privacy')))) 
```

# iis - 从我的域发送电子邮件需要什么

> ID：386043
> 
> 赞同：2
> 
> 时间：2008-12-22T11:35:34.737
> 
> 标签：iis, smtp, email, mail-server

我希望能够通过 Windows 2003 服务器从我自己的域 (Domain.com) 发送电子邮件，我测试了我的应用程序，它在我的本地 IIS 上工作正常。

但我不知道要让它在外面工作需要什么。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T11:47:38.923

> 但我不知道要让它在外面工作需要什么。

在外面工作？您想从不运行邮件服务器的计算机向 bashar@domain.com 发送电子邮件？为此，您必须注册域。完成了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T12:42:33.073

您的编程语言的电子邮件库应该有一个工具来指定处理来自您的域的电子邮件的传出 SMTP 服务器。在早期，创建邮件并从本地 SMTP 服务器发送邮件很容易。

询问您的 ISP 是否提供对 SMTP 服务器的访问以中继电子邮件。如果这样做了，您将能够将电子邮件发送到任何目标电子邮件地址，而不必担心电子邮件会进入垃圾文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T13:36:32.310

Bashar，我认为“外部”是指“我希望它来自*domain.com* ”（您的域）。

为此，您必须将域注册中的 MX（邮件交换）记录更改为指向您的 SMTP 服务器的 IP 地址。当然，这意味着任何*现有的*电子邮件服务器将不再处理该域的电子邮件；**一切都**将被路由到 IIS 机器。如果这不合适，那么您将无法真正发送源自您的域的电子邮件。

一种解决方法是在电子邮件的“回复”和“FromAddr”中使用您的域。事实上，在回复字段中看到您的域足以让大多数人相信电子邮件确实来自那里。但是，如果 FromAddr 指向一个 IP 地址上的实际电子邮件服务器，而邮件实际上来自不同的 IP 地址（例如您的 IIS 服务器），那么许多电子邮件中继服务器会将其视为垃圾邮件而阻止。

另外，我建议您查看[AspNetEmail](http://www.aspnetemail.com)来管理电子邮件（实际上是 SMTP）编程。除了拥有高超的控制力之外，他们还有非常丰富的技术支持文章和一流的支持方案。这些人*真的很*了解 SMTP。即使不购买任何东西，您*也可以*阅读他们的内容，但很多信息都是按照他们控制的特定术语进行的。当然，我也认为支持对您有帮助的供应商是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T13:42:27.367

如果您已经注册了您的域，那么要*发送*邮件，您不需要任何东西，只需要一个 SMTP 客户端库和一个愿意接受您的邮件并将其转发到目的地的 SMTP 服务器（即在您的 ISP 处）。

*接收*邮件有些困难。为此，您需要：

*   具有已知（固定）IP 地址的 SMTP 服务器
*   DNS 中指向该服务器的 MX 记录
*   邮件客户端软件，从服务器下载邮件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T13:48:37.353

我使用 gmail 是因为我有这么多域，它在控制面板中有一个易于设置的“发送为”功能，当您在域的电子邮件中添加转发器时，一切就绪

# javascript - JavaScript 如何处理 ++ 运算符？

> ID：386044
> 
> 赞同：1
> 
> 时间：2008-12-22T11:36:02.270
> 
> 标签：javascript, operators, type-conversion, coercion

JavaScript 使用对象进行时髦的自动转换：

```
var o = {toString: function() {return "40"; }};
print(o + o);
print((o+1)+o);
print((o*2) + (+o)); 
```

将打印：

```
4040
40140
120 
```

这是因为 +，如果任何参数是对象/字符串，将尝试将所有参数转换为字符串，然后将它们连接起来。如果所有参数都是数字，则将它们加在一起。* 和 unary + 使用 toString（以及 valueOf，此处未显示）将对象转换为数字。

JavaScript 对 ++ 运算符有什么作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T17:42:59.283

来自[ECMAScript 语言规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)

> ## 11.3 后缀表达式
> 
> **句法**
> 
> 后缀表达式：
> 
> *   左手边表达式
> *   LeftHandSideExpression [此处没有 LineTerminator] ++
> *   LeftHandSideExpression [这里没有 LineTerminator] --
> 
> **11.3.1 后缀自增运算符**
> 
> 产生*式 PostfixExpression : LeftHandSideExpression [no LineTerminator here] ++*评估如下：
> 
> 1.  评估 LeftHandSideExpression。
> 2.  调用 GetValue(Result(1))。
> 3.  呼叫号码（结果（2））。
> 4.  使用与 + 运算符相同的规则（第 11.6.3 节）将值 1 添加到 Result(3)。
> 5.  调用 PutValue(Result(1), Result(4))。
> 6.  返回结果（3）。

* * *

这是 postInc 如何工作的伪 javascript 代码：

```
function postInc(a) {
  var x = +a; // Converts a to a number, Section 11.4.6 Unary + Operator
  a = x + 1;
  return x;
} 
```

编辑：正如[mikesamuel](https://stackoverflow.com/users/20394/)所说：这不是 parseInt。更新以反映这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T11:38:13.453

下面的代码很好地说明了这一点：

```
var a = {toString: function() {return "40"; }};
nl(typeof a);
nl(typeof +a);
nl(typeof a);
nl(typeof (a++));
nl(a);
nl(typeof a); 
```

输出是：

```
object
number
object
number
41
number 
```

一元加号将对象转换为数字并且不修改它。a++ 首先将对象转换为数字，**然后返回该数字**，然后递增数字，将值存储在 a 中。

这与另一种可能的解决方案相反，其中 a++ 将首先返回对象，然后转换为数字并递增。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T13:46:12.727

运算符进行“ `++`toNumber”转换（基本上是类型规则和 valueOf 函数的组合）。基本上适用于任何解决表达式

```
 resolveExpression++ 
```

JS引擎采取的步骤是

```
 <temp> = toNumber(resolveExpression);
 resolveExpression = <temp> + 1;
 <result> = <temp> 
```

对于非原子解析表达式，例如。`base.resolve++`or`base["resolve"]++`等`base`仅解决一次，然后重复使用。在任何理智的情况下，这都是无关紧要的，但是如果要增加的值是一个具有更改基础对象的 valueOf 实现的对象，这一点很重要。

例如。

```
base = {};
base.value = {valueOf:function(){base = {}; return 5;}}
base.value++; 
```

# php - 如何确定它是否是带有 PHP 的移动设备？

> ID：386046
> 
> 赞同：13
> 
> 时间：2008-12-22T11:36:35.467
> 
> 标签：php, mobile

我正在用 PHP 编写一个网站。由于网络上的任何人都需要访问它才能访问互联网，因此我必须创建一个移动版本。我如何最好地检查它是否是移动设备？我不想最后有 50 台设备的 switch 语句，因为我不仅想支持 iPhone。

有我可以使用的 PHP 类吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-22T11:42:12.633

您需要检查客户端发送的多个标头，例如 USER_AGENT 和 HTTP_ACCEPT。查看[这篇文章](http://mobiforge.com/developing/story/lightweight-device-detection-php)，了解 PHP 中移动用户代理的综合检测脚本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-02T23:16:19.093

你应该看看[Tera-WURFL](http://www.tera-wurfl.com)，它是一个基于 PHP 和 MySQL 的软件包，可以检测移动设备及其功能。以下是用于检测访问设备是否为移动设备的 Tera-WURFL 代码：

```
<?php
require_once("TeraWurfl.php");
$wurflObj = new TeraWurfl();
$wurflObj->GetDeviceCapabilitiesFromAgent();
if($wurflObj->capabilities['product_info']['is_wireless_device']){
    // this is a mobile device
}else{
    // this is a desktop device
}
?> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T12:56:07.367

另一件需要考虑的事情：许多网站实际上会为移动设备提供不同的 URL。[以 http://m.facebook.com](http://m.facebook.com)为例。如今，随着设备功能的增强，这为您的用户提供了一个选择。如果他们使用的设备实际上可以很好地处理整个网站（使用缩放等），那么他们可能会对被迫进入特定布局感到非常恼火。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-25T03:48:04.563

对于重定向部分，我使用了

```
$arr = explode('.', $_SERVER['SERVER_NAME'], 2);
$sub=$arr[0];
$need_redirect=false;
if (!isset($_SERVER['HTTP_REFERER'])){
    $need_redirect=true;
}else{
    $domain = parse_url($_SERVER['HTTP_REFERER']);   
    $host = $domain['host'];
    if (!preg_match('/romajidesu\.com/', $host)){
        $need_redirect=true;        
    }    
}
if ($need_redirect && ($sub!='m') && is_mobile() ){
    $old_url=$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; 
    $new_url='http://'.str_replace('www.', 'm.', $old_url);
    header("Location:".$new_url);die();
} 
```

有关我的实施的更多详细信息，请阅读我的博客[http://haibuihoang.blogspot.com/2012/11/how-to-redirect-mobile-users-to-your.html](http://haibuihoang.blogspot.com/2012/11/how-to-redirect-mobile-users-to-your.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T16:35:07.313

传统上，通过将 HTTP User-Agent 标头与众所周知的移动 UA 字符串列表进行比较来检测移动设备。相反，一种新颖的方法试图检测桌面操作系统的存在——任何被发现不是桌面操作系统的东西都必须是移动的。

这导致更少的误报。

我在这里用 Python 写了一篇带有示例代码的帖子：http: [//notnotmobile.appspot.com](http://notnotmobile.appspot.com)

这是一个片段：

```
import re

# Some mobile browsers which look like desktop browsers.
RE_MOBILE = {
    "iphone" : re.compile("ip(hone|od)", re.I),
    "winmo" : re.compile("windows\s+ce", re.I)}

RE_DESKTOP = {
    "linux" : re.compile(r"linux", re.I),
    "windows" : re.compile(r"windows", re.I),
    "mac" : re.compile(r"os\s+(X|9)", re.I),
    "solaris" : re.compile(r"solaris", re.I),
    "bsd" : re.compile(r"bsd", re.I)}

# Bots that don't contain desktop OSs.
RE_BOT = re.compile(r"(spider|crawl|slurp|bot)")

def is_desktop(user_agent):
  # Anything that looks like a phone isn't a desktop.
  for regex in RE_PHONE.values():
    if regex.search(user_agent) is not None:
      return False

  # Anything that looks like a desktop probably is.
  for regex in RE_DESKTOP.values():
    if regex.search(user_agent) is not None:
      return True

  # Bots get the desktop view.
  if RE_BOT.search(user_agent) is not None:
    return True

  # Anything else is probably a phone!
  return False

def get_user_agent(request):
  # Some browsers put the User-Agent in a HTTP-X header
  if 'HTTP_X_OPERAMINI_PHONE_UA' in request.headers:
    return request.headers['HTTP_X_OPERAMINI_PHONE_UA']
  elif:
    # Skyfire / Bolt / other mobile browsers
    ...
  else:
    return request.headers.get('HTTP_USER_AGENT', '')

def view(request):
  user_agent = get_user_agent(request)
  if is_desktop(user_agent):
    return desktop_response()
  else:
    return mobile_response() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-22T11:43:12.443

请求中的用户代理会为您提供足够的信息来做出决定吗？

这里有一个很好[的用户代理列表](http://www.zytrax.com/tech/web/browser_ids.htm)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T12:18:31.203

对于基于 User-Agent 的检测，使用[WURFL 数据库](http://wurfl.sourceforge.net/)。至少它是全面的并且不断更新。

如果您只针对高端（ish）手机，那么您可能根本不需要检测它们，只需[嵌入适当的移动样式表](https://stackoverflow.com/questions/352468/websites-for-the-iphone-but-what-about-other-platforms#352804)即可。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T14:51:04.407

如果您想使内容适应任何特定设备，例如将图像大小调整为设备的宽度，那么您也可以使用[DeviceAtlas](http://www.mobiforge.com/developing/story/the-deviceatlas-api-php-part-i-the-basics)。根据请求设备的用户代理，它会告诉您屏幕的大小，以及支持的图像格式、支持的标记类型、最大页面大小等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T22:49:11.180

大多数移动网站专门使用 user_agent。[在http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)维护了一个设备功能的开源数据库， 使用 wurlf，基于 user_agent，您可以识别屏幕物理和像素宽度、长度以及更多参数，并做出您的渲染决策.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T23:00:20.987

什么是移动设备？CPU较弱？低带宽？实际上，它的屏幕分辨率低于 320x240，色深低于 24。

您还必须使用 Javascript。这个链接会给你一个想法： [http ://www.w3schools.com/js/tryit.asp?filename=tryjs_browsermonitor](http://www.w3schools.com/js/tryit.asp?filename=tryjs_browsermonitor)

而且，这个链接会教你什么是什么： [http ://www.w3schools.com/htmldom/dom_obj_screen.asp](http://www.w3schools.com/htmldom/dom_obj_screen.asp)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-18T14:49:34.383

通过检查用户代理来决定移动设备并不是最好的选择。您应该使用 PHP 用户代理检查加入 javascript 设备宽度检查。但在某种程度上，用户代理检查是可以接受的。

我用这个。不如 WURFL，但很容易解决我的问题：

```
function is_mobile_device() {

    $agent=$_SERVER['HTTP_USER_AGENT'];

    if( strpos($agent,"Android") !== FALSE
        || strpos($agent,"IOS") !== FALSE
        || strpos($agent,"iPhone") !== FALSE
        || strpos($agent,"iPad") !== FALSE
        || strpos($agent,"iPod") !== FALSE
        || strpos($agent,"Symbian") !== FALSE
        || strpos($agent,"BlackBerry") !== FALSE
        || strpos($agent,"Opera Mini") !== FALSE
    ) {
        return TRUE;
    }
    return FALSE;

} 
```

# wcf - 配置 WCF 安全设置

> ID：386047
> 
> 赞同：2
> 
> 时间：2008-12-22T11:37:29.973
> 
> 标签：wcf, security, msmq

我有一个托管在 Windows 应用程序中的 WCF 服务。该服务使用 netMsmqBinding。客户端和主机位于不同的域中。我的问题是如何配置安全设置？

传输的数据很敏感，所以我想保护客户端和服务主机之间的通信。唯一的问题是我不知道该怎么做......（我不想使用证书）任何帮助将不胜感激！

* * *

**James Schek**：当我在没有安全性的情况下运行它时（无论 MSMQ 在哪里），它都能完美运行。在我的情况下，MSMQ 托管在服务器上，如果它关闭 - 那么客户端的消息将留在其传出队列中，当 MSMQ 重新启​​动并运行时，所有消息都会被发送 - 这是 MSMQ 的强大功能，也是预期的行为（这就是为什么通过 MSMQ 发送的所有消息都必须是 OneWay 的原因，因为我们不知道服务器或客户端何时在线 - 我们只希望消息传递）。

我们组织中的一位管理员问我是否有其他方式（而不是证书） - 这就是我问的原因（他想知道在这种情况下所有可能的保护方式）。

我处于工作组模式而不是域模式！所以我无法使用域...而且根本没有 AD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T11:57:41.337

MSMQ 通常不适合在 Internet 上使用（如果您打算这样做）。否则，如果您想要消息级安全性，我认为您无法避免使用证书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T17:15:27.453

您可能想查看 MSDN 中的这篇文章以了解您有哪些选择。您还可以实现自定义绑定，其中根据您的选择实现消息的传输和加密。顺便说一句[，这里](http://msdn.microsoft.com/en-us/library/ms731092.aspx)是链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T17:39:50.447

我怀疑 WCF 在这种情况下是否会像您期望的那样工作。MSMQ 托管在哪里？在“服务器”上还是在“客户端”上？还是有独立的MSMQ主机？当断开连接时，我相信唯一可以工作的系统是托管 MSMQ 的系统。其他系统将无法初始化 WCF。

如果您的系统在不同的域上，但在同一个 AD 林中，那么您可以使用域身份验证传输安全性。如果它们完全在森林中，那么您必须自己加密有效负载或依赖消息级安全性——即证书。

如果*标头*不敏感（即您正在调用的函数的名称、调用它的人等），那么您可以手动加密有效负载。即将您的数据序列化为二进制或xml，加密序列化的对象，然后使用生成的字节数组作为参数调用您的WCF 方法。

您还没有解释为什么要避免使用证书。显然，您还没有告诉我们另一个限制条件。为什么不使用证书？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T22:01:26.487

如果您需要消息级别的安全性，您可以通过在绑定上指定适当的属性来轻松使用传输安全性，证书是您的最佳选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T22:32:36.860

我建议获取 O'Reilly 的 Juval Lowy 的“Programming WCF Services”的副本。他有一整章专门介绍将 WCF 与 MSMQ 结合使用。

# .net - 经理班？

> ID：386063
> 
> 赞同：0
> 
> 时间：2008-12-22T11:50:03.240
> 
> 标签：.net, design-patterns, webforms, methodology

我正在编写一个 .net 网络表单应用程序。它有许多类，例如用户、预订等。目前我有许多管理器类，比如 bookingManager，它们管理这些类。例如，当创建一个新的预订时，您调用 bookingManager 中的 add 方法，并传递一个预订。然后检查预订是否有效，检查是否不冲突，如果不冲突，则将其添加到数据库中。对于其他类，我有类似的管理器，但是诸如用户管理器之类的管理器除了获取用户并添加到数据库之外并没有做更多的事情。所以我的问题是，这是做这类事情的最佳方式，还是有更适合这种情况的模式或方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T12:07:09.727

正如您所描述的那样，您已经在使用一种模式，即 3 层模式:)

这表明在应用程序中，您应该将代码分为 3 层（如名称所述）：

1.  展示层：您编写代码以展示数据的位置（ASPx/winforms/等）

2.  应用程序层：放置所有业务逻辑的位置（您对管理器类所做的事情）

3.  数据层：您实际访问数据库的位置。

遵循这种模式可能很有用，例如，您有一个具有多个地址的客户端，客户端存储在一个表中，而地址存储在另一个表中。在您的表示层中，您只需调用应用程序层中的方法来保存客户端。在应用层，您将检查您的数据并调用数​​据层中的两种方法，一种用于保存客户端，另一种用于保存地址。

现在，如果您有多个地址的供应商，您可以在数据层中使用相同的方法来保存它们。

如果您有复杂的对象，这将很有用。但是，如果您的大多数对象都非常简单，我建议您考虑一下这种模式是否适合您。

[http://en.wikipedia.org/wiki/Multitier_architecture](http://en.wikipedia.org/wiki/Multitier_architecture)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T12:10:25.760

如果管理器就像 UI 和域类之间的控制器/演示者，我认为它应该是薄层。它应该包含几行代码。然后域服务或服务类应该负责休息工作。例如 ：

用户界面：

```
buttonClicked(Eventargs...)
{
   presenter.Save();
} 
```

Presneter：

```
public void Save()
{
   bookingService.Save(view.Name,view.DateTime...)
} 
```

服务 ：

```
public void Save(string name,DateTime dateTime...)
{
   //do operations or call repository/Dao classes to save
} 
```

对于小型应用程序来说，它可能是矫枉过正，但对于大型应用程序，它会增加可维护性。您可以查看领域驱动设计书和领域服务类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T11:58:02.103

拥有经理课程并没有错，尤其是当他们管理系统的多个不同方面时，例如您提到的预订经理。在这种情况下，您可能不希望用户了解预订，或者预订了解用户 - 但这自然取决于您系统的具体情况。

1.  管理器的好处是它提供了一个中央和逻辑的地方来存储可能依赖于多个组件的复杂逻辑。它还允许您使用数据类并增加这些类的凝聚力。

2.  关于管理器的“不太好的”事情是您有另一个组件，它可能会合理地紧密耦合到系统中的其他组件。您需要平衡这方面的利弊，并选择对您的应用程序最有意义的架构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T11:59:55.640

我认为为此类类实现保存、删除和更新方法总是更好。用于此类事情的 Manager 类绝对是矫枉过正。例如，在您的 Booking 类中实现的那些方法可以进行相同的验证，并避免因向您的代码中添加太多类而引入的任何并发症。

# plsql - 如何在 SQL 中创建 lst 文件？

> ID：386064
> 
> 赞同：0
> 
> 时间：2008-12-22T11:50:41.243
> 
> 标签：plsql

我想从 sql 脚本创建一个 lst 文件

这是我的代码：

```
BEGIN
DECLARE
loc_bia_foracid GAM.foracid%TYPE;
loc_fba_foracid GAM.foracid%TYPE;
out_spool VARCHAR2(32000);
BEGIN
loc_bia_foracid:= '&loc_bia_foracid';
loc_fba_foracid:= '&loc_fba_foracid';

out_spool := out_spool || '|' || loc_bia_foracid;
out_spool := out_spool || '|' || loc_fba_foracid;

END; 
```

如果我不给出字符数，`out_spool`它会给我一个错误。我希望我的 lst 文件超过 32k 个字符。我还需要知道如何在存储过程中定义它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:29:08.217

我想会是这样的

```
declare
loc_bia_foracid varchar2(32767);
loc_fba_foracid varchar2(32767);
out_spool clob;
begin
   loc_bia_foracid := '&loc_bia_foracid';
   loc_fba_foracid := '&loc_fba_foracid';

   out_spool := out_spool || '|' || loc_bia_foracid;
   out_spool := out_spool || '|' || loc_fba_foracid;
end; 
```

如果你将在匿名块中使用它，你可能会因为 & 符号而得到空白的 out_spool，所以你需要在 loc_ 变量之前连接它们，比如 '&'||loc_bia...。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T17:45:02.527

以下是上面的存储过程：

```
CREATE OR REPLACE FUNCTION make_lst(
  pis_bia_foracid IN GAM.foracid%TYPE,
  pis_fba_foracid IN GAM.foracid%TYPE)
RETURN VARCHAR2 AS
BEGIN
  RETURN '|' || pis_bia_foracid || '|' || pis_fba_foracid;
END make_lst; 
```

（我还没有编译它，所以它可能不会第一次工作）

我对大于 32k 的字符串的建议是使用 CLOB（字符大对象）。一个 CLOB（取决于您的 Oracle 版本）最多可容纳 4GB 的文本。我使用 Oracle 9i，而在 9i 中，您使用 DBMS_LOB 包来初始化 CLOB，打开它进行写入，写入它，关闭它。

关于风格的一些评论：

*   请注意在 END 标记上使用方法名称。它有助于跟踪嵌套的 BEGIN-END 块。
*   注意变量的命名约定：pis=parameter, in, string 而 ls=local, string
*   我建议添加日志记录和单元测试。
*   我建议将该方法添加到一个包中，因为我怀疑您需要一些相关的方法来实现您最终想要的。

# validation - Windows DLL 是否由 Microsoft 签名？我可以检测它们是否已被第三方篡改吗？

> ID：386066
> 
> 赞同：4
> 
> 时间：2008-12-22T11:52:31.067
> 
> 标签：validation, dll, key, signature

我正在为我的软件实施锁定和复制保护系统。我已经关闭了每个允许有人打破我的锁的洞（嗯，这有点太乐观了，我知道！）但最后一件事是：

我听说破解者可以更改像 Kernel32.dll 这样的 Windows DLL，我使用的 API 返回一个由破解者指定的值。我需要防止这种情况。

起初我以为我可以为我使用的每个 DLL 创建一个哈希值，然后根据客户端 DLL 的计算哈希检查该哈希值，以查看文件是否已更改。这是行不通的，因为不同版本的 Windows 有许多不同版本的 DLL，而且 Microsoft 提供的每个修补程序和服务包都可能更改文件。

然后我意识到我可以检查文件的签名以确保它具有有效的 Microsoft 签名。现在有2个问题：

1.  Microsoft 是否签署 Windows DLL？我怎样才能找到有关此签名的一些信息？
2.  是否提供了公钥来验证签名？如何使用此密钥来验证文件？

非常感谢任何演练。我的应用程序是使用 Visual Basic.NET 编写的。

多谢你们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T16:04:25.600

MS 确实签署了一些系统二进制文件，具体取决于 Windows 和二进制文件的版本。例如，如果您在 Windows XP 上[检查](http://technet.microsoft.com/en-us/sysinternals/bb897441.aspx)kernel32.dll：

```
C:\Windows\system32>sigcheck kernel32.dll
Sigcheck v1.5
Copyright (C) 2004-2008 Mark Russinovich
Sysinternals - www.sysinternals.com

C:\Windows\system32\kernel32.dll:

Verified: Signed
Signing date: 02:07 14/04/2008
Publisher: Microsoft Corporation
Description: Windows NT BASE API Client DLL
Product: Microsoft« Windows« Operating System
Version: 5.1.2600.3119
File version: 5.1.2600.3119 (xpsp_sp2_grd.070416-1301) 
```

您还可以使用 sigcheck 来执行诸如在特定文件夹中查找所有未签名二进制文件之类的操作，例如

```
sigcheck -u -e c:\windows\system32 
```

我相信您的第二个问题的答案是“否”，尽管 MS 确实将[根证书](http://technet.microsoft.com/en-us/library/cc751157.aspx)用于某些验证目的。它不会在其 Windows 系统二进制文件中发布公钥，因为密钥对可以而且确实会改变。

但是从根本上说，如果您不信任操作系统，那么无论如何您都是fubar。

面对现实，您的应用程序**将被破解**。我的建议是只花 1% 的精力来减缓破解过程，而 99% 的精力用于创造值得破解的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-22T11:58:23.990

您是要编写自己的加密例程以便自己验证签名，还是要信任 Crypto API？您是否要在加密 dll 上使用签名来验证加密 dll？

谁在看守望者？

你会想要编写自己的操作系统，最好确保它不能在虚拟机中运行！也许您也应该制作自己的硬件硬件。

最终，你必须相信一些东西。真的。如果您不准备信任用户，请信任操作系统，因为如果您不信任它，您最终将推出自己的硬件以使其“安全”。是的，有人会破解你的软件——这几乎是不可避免的。一定要让它变得困难，但请记住回报会减少（迅速！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-15T15:36:00.857

其他答案说您可以检查磁盘上的副本是否未被修改。您是*内存*副本的 SOL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-02T09:08:52.517

不幸的是，检查微软自己的 DLL 的数字签名，无论它在理论上多么伟大，在实践中都是一个完全*没有实际意义*的问题。为什么？你会问。因为微软似乎并不关心签署大量他们自己的系统 DLL。

理论上，您可以使用[此 C 代码](https://msdn.microsoft.com/en-us/library/windows/desktop/aa382384(v=vs.85).aspx)的一个版本来检查可执行文件是否经过数字签名以及可执行文件是否完整/未更改，但如果您实现它并检查可能加载到您的进程中的所有系统 DLL，您将大失所望。

例如，从加载到我的进程中的大约 50 个系统 DLL 中，以下主要库**没有签名**！

视窗 8.1：

```
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\MSIMG32.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\COMDLG32.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\WINSPOOL.DRV"
Failed: hr=0x800B0100 "C:\WINDOWS\WinSxS\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.9600.18006_none_623f33d3ecbe86e8\COMCTL32.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\oledlg.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\WinSxS\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.9600.18592_none_933383bf47487fd6\gdiplus.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\dbghelp.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\uxtheme.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\RICHED20.DLL"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\USP10.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\msls31.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\msftedit.dll" 
```

视窗 10：

```
Failed: hr=0x800B0100 "C:\WINDOWS\system32\apphelp.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\System32\COMDLG32.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\MSIMG32.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\WINSPOOL.DRV"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\oledlg.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\WinSxS\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.14393.953_none_7300116921188239\gdiplus.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\dbghelp.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\uxtheme.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\RICHED20.DLL"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\msls31.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\SYSTEM32\USP10.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\msftedit.dll"
Failed: hr=0x800B0100 "C:\WINDOWS\system32\dataexchange.dll" 
```

如你所见，他们没有希望很快做到这一点。

所以是的....**为你感到羞耻，微软！**

PS。错误代码`0x800B0100`=`"No signature was present in the subject."`

# asp.net - 如何使用 ANSI 格式将数据写入文本文件

> ID：386067
> 
> 赞同：0
> 
> 时间：2008-12-22T11:52:40.227
> 
> 标签：asp.net, ansi

使用 ASP.net，如何将 ANSI 字符写入文本文件？

我需要将此文件的文本写入网络浏览器。他们支持ANSI吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T12:16:18.570

使用 System.IO.StreamWriter。
它有一个接受编码的构造函数：

```
FileStream fs = new FileStream(fileName,
            FileMode.CreateNew, FileAccess.Write, FileShare.None);
StreamWriter writer = 
            new StreamWriter(fs, System.Text.Encoding.ASCII); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T13:47:40.023

我不做 ASP，所以我不能告诉你具体怎么做。但我相信大多数（所有？）浏览器都支持 ANSI 纯文本。您可以将 HTTP 内容类型作为 text/plain 返回，并将文本作为 HTTP 响应的内容发送。

# c# - wse 3.0 或 wcf 以及从哪里开始

> ID：386071
> 
> 赞同：4
> 
> 时间：2008-12-22T11:53:39.943
> 
> 标签：c#, wcf, web-services

我创建了一个 Web 服务，其中包含使用 .net 3.5 开发的几种方法。将访问 Web 服务的客户端将使用 .net 3.0。我被要求让这个网络服务“安全”，并且在网上看过很多选项。

第一个是使用带有 .net 3.5 的 WCF 作为服务。如果我使用 .net 3.5 开发服务，我还需要使用 3.5 开发客户端吗？

其次，我可以考虑使用 WSE 3.0 并以这种方式实现安全性。但是，在查看 .net 后，我​​了解到将 WSE 3 与 Visual Studio 2008 一起使用时存在一些问题。

任何其他建议将不胜感激。我想保护 Web 服务，因此使用 WCF 或 WSE 3.0。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-22T12:13:12.790

WCF 框架是 .NET 3.0 而不是 .NET 3.5 的一部分，因此客户端中不需要 .NET 3.5。

您还可以使用 WCF 提供基于 Web 服务标准的服务。这些服务甚至可以与“旧”的 Web 服务客户端或其他平台（如 Java）一起使用。

基于凭证的 WCF 消息安全性符合 WS-Security 1.1 标准，该标准也可以与 WSE 客户端一起使用。

> [http://msdn.microsoft.com/en-us/library/ms735093.aspx：WCF](http://msdn.microsoft.com/en-us/library/ms735093.aspx)支持多种互操作性方案。BasicHttpBinding 类针对的是基本安全配置文件 (BSP)，而 WSHttpBinding 类针对的是最新的安全标准，例如 WS-Security 1.1 和 WS-SecureConversation。通过遵守这些标准，WCF 安全性可以与托管在 Microsoft Windows 以外的操作系统和平台上的 Web 服务进行互操作和集成。

我肯定会选择 WCF 解决方案，而不是 WSE。我认为 WCF 是 WSE 的直接继任者，微软并没有进一步改进它（甚至 WSE 主页链接也从 WSE 3.0 下载页面断开）。

正如 Alex 所提到的，尽管有标准，但连接到非 MS 平台可能具有挑战性。在这些情况下，绝对需要概念证明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T12:30:38.743

我最近在将 WCF 客户端连接到由 Apache Axis 提供的 WS-* 服务时遇到了一些问题，我必须恢复到 WSE 3.0 才能使其正常工作。我不知道这是 WCF 还是 Axis 的错误，但无论哪种方式，两个最高配置的 WS-* 堆栈都不能正常互操作，这并不太令人印象深刻。

鉴于仍然需要使用 WSE 3.0，MS 几乎弃用了 WSE 3.0 也是一种耻辱：

*   Gaspar 提到的网页内容
*   您必须摆弄命令行才能使用 VS2008 中的 WSE 3.0

# sockets - 套接字是最好的方法吗？

> ID：386075
> 
> 赞同：2
> 
> 时间：2008-12-22T11:54:20.470
> 
> 标签：sockets, communication

我正在开发一个需要通信的工具：通过互联网与该工具的其他远程实例发送和接收文件。在这种情况下最好使用哪种通信选项？插座？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T12:16:26.650

套接字绝对不是要走的路。相反，您应该使用已经存在的更高层协议，例如 FTP 甚至 HTTP。套接字仅公开裸 TCP/IP 功能。因此，要发送/接收文件，您最终将自己添加应用程序逻辑（例如，您需要处理丢失的数据包）。更高层的协议已经为您做到了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T13:52:06.363

关于 HTTP 的一点是，良好、成熟且（或多或少）经过安全审核的 HTTP 客户端和服务器库可用于几乎任何语言或平台。这将节省您构建和调试自己的工作，如果 HTTP 服务器可以暴露于公共互联网，安全性是一个重要问题。

**编辑：**对于 C#，您可以尝试[Windows Communication Foundation](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)，它也支持更高级别的协议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T12:07:04.190

这在很大程度上取决于它们所运行的环境。只要您检查读取和写入是否成功，TCP 套接字就可以直接使用。但是，您可能会遇到防火墙问题，或者您可能不想在每一端处理原始字节流，在这种情况下，HTTP 或 FTP 等更高级别的协议可能是更好的解决方案。

它还取决于您正在使用哪种语言以及对其库中的特定协议提供什么支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T12:19:06.083

您不应该期望能够通过 Internet 与任意机器建立入站连接 - 防火墙策略几乎肯定会妨碍您。

因此，您最好拥有一个中央服务器，该工具的所有实例都连接到该中央服务器，并且可以将文件上传到该中央服务器以供其他实例随后下载。

根据其他答案，我不建议使用低级套接字连接。HTTP 可能是正确的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T12:41:08.193

从您对其他答案的评论看来，您将文件传输与文件加密混淆了。正如其他人所指出的，您可以使用 HTTP 或 FTP 来传输文件。HTTP 已经在 SSL 上运行，它可以验证服务器、加密流量并（需要做更多工作）验证客户端。

如果您还希望文件本身也被加密，那么最好的选择是再次使用已经存在的东西，例如 PGP（或它的实现，例如 GPG）。您也可以查看 S/MIME，但 PGP 会更简单。如果您重新发明自己的加密，您会发现难以避免的陷阱太多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T14:02:34.377

如果您只需要在实例之间进行简单的文件传输，我建议您查看适用于您的语言的任何可用的 tftp 客户端/服务器库。

# c# - 已将函数委托作为参数合并的 C# 程序员的 F#

> ID：386076
> 
> 赞同：8
> 
> 时间：2008-12-22T11:54:42.357
> 
> 标签：c#, f#

我有一本关于 F# 的书，但目前我很不了解，所以我想我会问。从我对 F# 的了解很少，我很难看出它比 C# 为我带来了什么，而不是可能的语法简洁。似乎没有什么概念上的新东西，或者在 piian C# 中是不可行的

我早在 20 年前就做过 Forth 了，而且我已经将传递函数委托作为参数合并到方法中（似乎一直在做这种事情）。

从风格上讲，我不热衷于匿名方法——这会成为一个问题吗？

虽然我认为句法的简洁性不应该被嗤之以鼻:-)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-23T06:23:50.137

（警告：这第一点并不是你问题的真正答案。作为 F# 团队的成员，我非常有偏见。）使用 F# 近一年了，我发现每当我必须编写 C# 代码时感觉就像在泥泞中行走。有很多卷曲和分号，哦，我的天哪，别让我写所有这些该死的类型！只是感觉很*慢*。我使用大量 C# 代码，所以我仍然几乎每天都阅读和调试它，这很好（甚至比 F# 调试更好；我们仍然需要改进 F# 调试器集成），但我发现*编写*C# 代码现在感觉像是一件苦差事；F#编码更*有趣。*

至于你的问题的实际答案，很多人说'元组'，但我说'meh'。类型推断、区分联合和模式匹配、函数库、*流水线*和语法整洁（语法很重要！）对我来说是更大的赢家。（如果你今天想编写异步代码，F# 会让其他人望而却步。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-22T15:35:36.703

我喜欢 F# 和 C#，但通常我更喜欢 F#：

我会说，如果你尝试在 C# 中进行不可变编程，你很快就会遇到一个问题，即你不能从一个方法/函数中返回一个以上的东西。F# 巧妙地解决了使用元组允许您返回多个值的问题。

C# 中委托的另一个问题是它们是名义上的。您可以有两个具有完全相同签名的委托，但它们不兼容只是因为它们具有不同的名称。您可以使用 lambdas 或匿名委托来解决这个问题，但 F# 以更简洁的方式解决了问题：它只是检查签名是否匹配。

联合类型很棒，很难看到 C# 提供过这种功能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-23T05:26:34.840

除了其他答案：自动泛化。

这使 F# 比 C#、Scala 等有了很大的进步。这是一个简单的例子，“snd”函数从一对中获取第二个值。在 F# 中：

```
 let snd (a,b) = b 
```

编译器会自动计算并使其完全通用：

```
 val snd : 'a * 'b -> 'b 
```

在 C# 中：

```
static Tb snd<Ta, Tb>(Tuple<Ta, Tb> x) { return x.B; } 
```

1/3 的代码，减少 100% 的噪音。现在，将其扩展到更复杂的函数类型，例如，采用元组并将某个枚举的字典返回给函数。哎哟。

这些都是简单的场景。添加一些通用约束，类型参数之间的关系，嗯，在 C# 中变得非常困难。有几次使用 C# 时，我不得不停下来思考并计算出我需要哪些泛型参数，*即使这不是一个困难的应用程序*。在 F# 中，我可以编写出这个想法，一般来说，事情会尽可能地概括，而无需我做进一步的工作。迷人的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-22T12:27:06.410

另一个很大的优势是完整的类型推理系统。局部函数、lambdas、元组和列表大大减少了代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-22T12:24:36.900

我认为 F# 的一大优势是对元组的更好支持。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-23T22:33:45.703

是的，目前的优势是“仅”模式匹配、默认不变性、更简单（但不太熟悉）的语法以及非常好的类型推断。

对我来说，两个重要的（不包括类型推断）是*更好*的单子语法（F# 中的计算表达式与 C# 中的 LINQ 查询）和引用（与 LINQ 表达式）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-24T04:50:31.940

我必须说他们在 F# 中处理异步和并行性的方式令人印象深刻……最令人印象深刻。 [从 PDC 观看此视频](http://channel9.msdn.com/pdc2008/TL11/)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-26T03:49:51.103

我发现很难以某种简单的方式展示这些好处。我的信念是，好处不在某些语言功能中（默认情况下是不可变的，类型推断或此处提到的任何其他内容）。区别在于您在使用 F# 时可以使用的完全不同的开发风格。

您可以找到更多信息：

*   在我写的一篇文章中：http: [//tomasp.net/blog/functional-overview.aspx](http://tomasp.net/blog/functional-overview.aspx)
*   在我对 SO 的另一个回答中：[F# 真的比 C# 的数学更好吗](https://stackoverflow.com/questions/379722/is-f-really-better-than-c-for-math)
*   [...并在此处的真实世界函数式编程书籍](http://www.manning.com/petricek/)的免费章节中

希望这可以帮助！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-26T03:59:37.573

函数式编程与面向对象编程有很大不同。但是，由于 F# 是一种面向对象的函数式语言，而 C# 是一种面向对象的函数式语言，因此这两种语言看起来非常接近。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-22T12:37:21.897

有诸如受歧视的工会之类的事情，但我得出的结论与您完全相同。

而且我不是元组的忠实粉丝——我喜欢命名属性，所以我不需要按位置记住所有内容。

像 immutabily 这样的事情是错误的——因为你可以在 C# 中做到这一点，并且希望 C# 5 也能让它变得更容易。

重新语法整洁......我发现 C# 更整洁，更容易理解，这可能是熟悉的错误。

有更好的 switch 语法，但可以引入 C# - 请参见[此处](https://stackoverflow.com/questions/156467/switch-pattern-matching-idea)（包括回复）。Re anon-methods，没有人强迫你使用它们，但是在许多情况下，lambdas 是一种非常简洁的表达意图的方式。

# sql-server - 当表非空时从 SQL Server 接收自动通知

> ID：386079
> 
> 赞同：2
> 
> 时间：2008-12-22T11:56:54.647
> 
> 标签：sql-server, com, activex, dataflex

我想使用 SQL Server 表作为操作队列。[因此，每当表非空时，我都希望向我的VDF](http://www.visualdataflex.com/)应用程序发出某种通知，以避免不断地轮询数据库。VDF 依赖于使用[stdcall](http://en.wikipedia.org/wiki/X86_calling_conventions#stdcall)，Win 32 API 或 COM/ActiveX 的标准调用约定。另一个对我有用的解决方案是在表非空时简单地运行一个 exe 文件。

SQL Server 中是否有可以在此处使用的事件？您将如何引导此类事件以供 VDF 使用（如上所述）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T12:16:46.480

您可以使用 ON INSERT 触发器，可能将行发送到[MSMQ](http://www.microsoft.com/windowsserver2003/technologies/msmq/default.mspx)，您的应用程序在新消息进入时侦听事件。

这是一个[如何使用 SQL Server 为 MSMQ 提供数据的示例，](http://www.developerfusion.com/code/2151/update-msmq-from-sql/)这里[是一个关于如何侦听事件的简短](http://www.developerfusion.com/article/2131/get-the-message-msmq/7/)示例。

还有[SQL Server Event Provider](http://msdn.microsoft.com/en-us/library/ms171157(SQL.90).aspx)，它基本上只是为您进行轮询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T12:40:14.263

*您将如何引导此类事件以供 VDF 使用。*

您如何引导到 VDF 取决于您是否希望在 VDF 应用程序中发生可见的事情，或者您是否只想触发 VDF 中的过程。

如果是后者，我建议您使用 Webapp 来提供此功能。VDF（超过 10 的版本）内置了 Web 开发，并且很容易提供 SOAP 接口来做任何你想做的事情。

```
{ Published = True  }
{ Description = "Test the service is alive - returns 'Hello World'"  }
Function HelloWorld Returns String
    Function_Return "Hello World"
End_Function 
```

如果是前者，那么不必担心每隔几秒左右使用计时器对象来轮询数据库。您会发现代码更像是“dataflex”，并且性能影响可以忽略不计。

但是有一个用于 MSMQ 的开源 VDF 库，可以在..
[http://www.vdf-guidance.com/ContribPage.asp?Page=PKGGENMESSAGING&ContribRecId=106 找到](http://www.vdf-guidance.com/ContribPage.asp?Page=PKGGENMESSAGING&ContribRecId=106)

Finally - The Data Access newsgroups are the best place to go for Visual Dataflex support. Use [http://sture.dk/wasp](http://sture.dk/wasp) to search historical newgroups and go to news.dataaccess.com (using an NNTP client of your choice) to post and answer questions.

# java - 必须先发出 STARTTLS 命令。使用 Java 和 Google Apps 发送电子邮件

> ID：386083
> 
> 赞同：20
> 
> 时间：2008-12-22T11:57:57.267
> 
> 标签：java, email, google-apps

我正在尝试使用[Bill the Lizard 的代码](https://stackoverflow.com/questions/46663/how-do-you-send-email-from-a-java-app-using-gmail#47452)使用 Google Apps 发送电子邮件。我收到此错误：

```
Exception in thread "main" javax.mail.SendFailedException: Sending failed;
  nested exception is: 
    javax.mail.MessagingException: 530 5.7.0 Must issue a STARTTLS command first. f3sm9277120nfh.74

    at javax.mail.Transport.send0(Transport.java:219)
    at javax.mail.Transport.send(Transport.java:81)
    at SendMailUsingAuthentication.postMail(SendMailUsingAuthentication.java:81)
    at SendMailUsingAuthentication.main(SendMailUsingAuthentication.java:44) 
```

比尔的代码包含下一行，这似乎与错误有关：

```
 props.put("mail.smtp.starttls.enable","true"); 
```

但是，它没有帮助。

这些是我的导入语句：

```
import java.util.Properties; 
import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage; 
```

有谁知道这个错误？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-22T13:16:10.743

我发现了问题。以前我使用 j2ee.jar 导入 javax.mail。

我从类路径中删除了 j2ee.jar 并下载了[JavaMail](http://java.sun.com/products/javamail/) 1.4.1 并将两个 jars、smtp.jar 和 mailapi.jar 放入我的类路径中。我现在使用**smtps**而不是**smtp**

```
Transport transport = session.getTransport("smtps"); 
```

现在 Bill the Lizard 的代码可以工作了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-21T12:12:30.967

设置以下标签。它会起作用的。

```
props.put("mail.smtp.user","username"); 
props.put("mail.smtp.host", "smtp.gmail.com"); 
props.put("mail.smtp.port", "25"); 
props.put("mail.debug", "true"); 
props.put("mail.smtp.auth", "true"); 
props.put("mail.smtp.starttls.enable","true"); 
props.put("mail.smtp.EnableSSL.enable","true");

props.setProperty("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");   
props.setProperty("mail.smtp.socketFactory.fallback", "false");   
props.setProperty("mail.smtp.port", "465");   
props.setProperty("mail.smtp.socketFactory.port", "465"); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-02-02T13:11:52.963

它是 java 邮件 API 的版本。我遇到了这个问题，我刚刚将 java 邮件 API 更新到 1.4.3 它对我来说很好！

谢谢！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-22T12:36:51.010

我认为这与使用 SMTPS 而不是 SMTP 进行邮件传输有关。这是一个不同的版本，仿照[JavaMail FAQ on access Gmail](http://java.sun.com/products/javamail/FAQ.html#gmail)。请注意，为了清楚起见，我省略了所有更精细的异常处理。

```
private static void send(
        final String username,
        final String password,
        final String recipients,
        final String subject,
        final String body)
        throws Exception
{
    final Session session = Session.getInstance(System.getProperties(), null);
    final Message msg = new MimeMessage(session);
    final String senderEmail = username.contains("@") ? username : (username + "@gmail.com");
    msg.setFrom(new InternetAddress(senderEmail));

    final Address[] recipientAddresses = InternetAddress.parse(recipients);
    msg.setRecipients(Message.RecipientType.TO, recipientAddresses);

    msg.setSentDate(new Date());
    msg.setSubject(subject);
    msg.setText(body);

    final Transport transport = session.getTransport("smtps");
    transport.connect(GMAIL_SMTP_HOST, GMAIL_SMTP_PORT, username, password);
    transport.sendMessage(msg, recipientAddresses);
    transport.close();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-04T15:07:49.667

这让我发疯，所以只想添加对我有用的东西。我必须更新我的 JavaMail (1.4.5) 版本才能正常工作 - 不确定之前使用的是什么版本。

一旦我更新到新版本的 JavaMail，以下代码对我有用（可以取消注释调试行以获得额外的调试信息 - 端口是`587`和主机是`smtp.gmail.com`）：

```
public void sendMailWithAuth(String host, String user, String password, 
    String port, List<String> toList, String htmlBody, 
        String subject) throws Exception {

    Properties props = System.getProperties();

    props.put("mail.smtp.user",user); 
    props.put("mail.smtp.password", password);
    props.put("mail.smtp.host", host); 
    props.put("mail.smtp.port", port); 
    //props.put("mail.debug", "true"); 
    props.put("mail.smtp.auth", "true"); 
    props.put("mail.smtp.starttls.enable","true"); 
    props.put("mail.smtp.EnableSSL.enable","true");

    Session session = Session.getInstance(props, null);
    //session.setDebug(true);

    MimeMessage message = new MimeMessage(session);
    message.setFrom(new InternetAddress(user));

    // To get the array of addresses
    for (String to: toList) {
        message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
    }

    message.setSubject(subject);
    message.setContent(htmlBody, "text/html");

    Transport transport = session.getTransport("smtp");
    try {
        transport.connect(host, user, password);
        transport.sendMessage(message, message.getAllRecipients());
    } finally {
        transport.close();
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-25T11:31:28.030

尝试这个：

打开：允许您的 gmail 帐户使用安全性较低的应用

[https://myaccount.google.com/lesssecureapps](https://myaccount.google.com/lesssecureapps)

# c# - IOException 使用 .NET 将大文件从 UNC 路径读取到字节数组中

> ID：386088
> 
> 赞同：1
> 
> 时间：2008-12-22T11:58:48.467
> 
> 标签：c#, .net, bytearray, large-files, unc

我正在使用以下代码尝试从 UNC 路径将大文件 (280Mb) 读入字节数组

```
public void ReadWholeArray(string fileName, byte[] data)
{
    int offset = 0;
    int remaining = data.Length;

    log.Debug("ReadWholeArray");

    FileStream stream = new FileStream(fileName, FileMode.Open, FileAccess.Read);

    while (remaining > 0)
    {
        int read = stream.Read(data, offset, remaining);
        if (read <= 0)
            throw new EndOfStreamException
                (String.Format("End of stream reached with {0} bytes left to read", remaining));
        remaining -= read;
        offset += read;
    }
} 
```

这与以下错误有关。

```
System.IO.IOException: Insufficient system resources exist to complete the requested 
```

如果我使用本地路径运行它，它工作正常，在我的测试用例中，UNC 路径实际上指向本地框。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T12:07:05.437

我怀疑较低的东西正在尝试读取另一个缓冲区，并且一次读取所有 280MB 都失败了。在网络案例中可能需要比本地案例更多的缓冲区。

我会一次阅读大约 64K，而不是尝试一口气阅读全部内容。这足以避免分块带来的过多开销，但会避免需要大量缓冲区。

就我个人而言，我倾向于只阅读到流的末尾，而不是假设文件大小将保持不变。有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/221925/creating-a-byte-array-from-a-stream)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-19T19:18:05.620

此外，编写的代码需要将其`FileStream`放入一个`using`块中。未能处理资源是收到“系统资源不足”的一个非常可能的原因：

```
public void ReadWholeArray(string fileName, byte[] data)
{
    int offset = 0;
    int remaining = data.Length;

    log.Debug("ReadWholeArray");

    using(FileStream stream = new FileStream(fileName, FileMode.Open, FileAccess.Read))
    {
        while (remaining > 0)
        {
            int read = stream.Read(data, offset, remaining);
            if (read <= 0)
                throw new EndOfStreamException
                    (String.Format("End of stream reached with {0} bytes left to read", remaining));
            remaining -= read;
            offset += read;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T19:03:42.057

看起来该数组的创建大小不足。在传入之前分配了多大的数组？或者您是否假设 Read 函数会根据需要重新分配数据数组？它不会。编辑：呃，也许不是，我只是注意到你得到的例外。现在不确定。

# javascript - javascript 选项选择 IE6 与 FF2

> ID：386094
> 
> 赞同：2
> 
> 时间：2008-12-22T12:03:32.450
> 
> 标签：javascript, html, internet-explorer-6, html-select

以下 js 在 FF2 中可以正常工作，但在 IE6 中，下拉菜单总是选择一个选项来提早，IE -> testix2 vs. FF2 -> testix3 如果我们在脚本中的某处添加一个 alertBox，它在 IE6 中也可以正常工作。但是如何在没有 alertBox 的情况下解决这个问题？

蒂亚

```
<script language="JavaScript" type="text/javascript">
<!--
function Entry(value, name, selected) {
    this.value = value;
    this.name = name;
    this.selected = selected;
}

//-->
</script>
        <select id="selSeaShells">

        </select>
<script language="JavaScript" type="text/javascript">
<!--
var productCategoryLevel2 = new Array();

productCategoryLevel2.push(new Entry('Hallo1', 'testix1', false));
productCategoryLevel2.push(new Entry('Hallo2', 'testix2', false));
productCategoryLevel2.push(new Entry('Hallo3', 'testix3', true));

    var i = 0;
        for (i in productCategoryLevel2) {
        var optL2 = document.createElement('option');
        optL2.selected = true;

                optL2.text = productCategoryLevel2[i].name;
        optL2.value = productCategoryLevel2[i].value;
        if (productCategoryLevel2[i].selected == true) {
            productCategoryLevel2[i].selected = true;
            optL2.selected = true;
        } else {
            optL2.selected = false;     
        }
                try {
            document.getElementById("selSeaShells").add(optL2, null);
                } catch(ex3) {
            document.getElementById("selSeaShells").add(optL2);
                }
        }
//-->
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T12:18:57.817

我不完全确定为什么您的示例不起作用，但是如果您这样做（即在 <select> 上设置 selectedIndex 而不是设置 <option> 的 selected 属性），它会起作用。测试过FF3、IE6、Chrome。

```
var i = 0;
for (i in productCategoryLevel2) {
    var optL2 = document.createElement('option');

    optL2.text = productCategoryLevel2[i].name;
    optL2.value = productCategoryLevel2[i].value;
    try {
        document.getElementById("selSeaShells").add(optL2, null);
    } catch(ex3) {
            document.getElementById("selSeaShells").add(optL2);
    }

    if (productCategoryLevel2[i].selected == true) {
            document.getElementById("selSeaShells").selectedIndex = i;
    }      
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T12:31:59.943

我现在无法对此进行测试，但您可能希望使用标准 for(;;) 循环而不是 for..in 结构来迭代您的数组，该结构只能用于 javascript 中的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T12:44:30.527

这感觉就像一个 IE 错误（我想知道将 true 转换为 1 是否有问题），但是您已经通过将选择索引基于选项而不是 tomhaigh 修复的选择本身来实现它。

重要的是要意识到，如果您从零选项开始，那么您想为选择的第一个选项提供什么值并不重要 - 作为一组元素中的一个元素，它只能被选中=true。

（我也同意三联画`for`）

# database - Informix 中的数据库别名

> ID：386097
> 
> 赞同：2
> 
> 时间：2008-12-22T12:06:51.727
> 
> 标签：database, informix, alias

在 Informix 中，我可以运行使用其他数据库的 SQL 语句：

```
INSERT INTO other_db:mytable ... 
```

我想“联合”两个数据库，但我想“一步一步”做。

首先，我想将所有数据从 other_db 移动到主数据库，并为 other_db = main_database 设置别名。这样我就有时间从所有语句中删除“other_db:”。

如何设置数据库别名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T01:05:58.533

我不知道为整个数据库创建别名的任何方法。

但是，您可以跨数据库创建同义词，格式如下：

```
DATABASE old_db;
CREATE SYNONYM table_name FOR new_db:table_name; 
```

如果您在每个表移动时为其创建这样的别名，您应该能够获得相同的效果。重新定位所有表后，您可以删除对`old_db`.

您可以查询`systables`以识别 old_db 中的真实表，即：

```
DATABASE old_db;
SELECT tabname, nrows
  FROM systables
  WHERE tabtype = "T"
    AND tabid > 99 -- exclude internal tables 
```

行数当然取决于合理的 current `UPDATE STATISTICS`。

希望有帮助。

# iphone - iPhone多点触控事件是如何触发的？

> ID：386105
> 
> 赞同：1
> 
> 时间：2008-12-22T12:08:57.977
> 
> 标签：iphone, cocoa-touch, multi-touch

我阅读了SDK文档，但无法理解一些细节，需要一些帮助。

为了

```
-(void)touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event 
```

1.  `touches`和有什么区别`[event allTouches]`？
2.  如果用户松开一根手指，但屏幕上还有其他手指，那么后面的事件是否仍然包含手指`touches`？`[event allTouches]`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T13:07:42.397

Touches 集应该只代表与当前调用相关的那些触摸。对于已结束的触摸，touches 参数将包含刚刚结束的触摸，而 [UIEvent allTouches] 数组将包含当前正在进行的所有触摸，*包括*刚刚结束的触摸。

# jquery - 为我的新 JQuery 插件提供外部样式表的最佳方式？需要战略

> ID：386107
> 
> 赞同：2
> 
> 时间：2008-12-22T12:09:25.697
> 
> 标签：jquery, jquery-plugins

我编写了我的第一个 JQuery 插件，其中一个依赖项是外部 css 样式表。您认为将其包含在可分发文件中是一种可接受的策略，还是应该在插件本身中嵌入样式信息？我应该在发货时完全没有样式信息吗？如果没有样式表，插件的视觉元素就毫无意义，我希望用户也可以明显地调整外观。只是不确定最好的方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T12:57:03.980

UI 无疑是最重要的插件之一，它的发行版中确实包含 css 文件。这是分布的样子：

```
jquery.js
licence.txt
readme.txt
ui\*.js
themes\*.css
tests\
demos\ 
```

我想你可以使用类似的结构。请注意，如果没有样式表，某些小部件将无法工作。文档清楚地提到了 css 中的哪些元素是强制性的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T12:15:46.870

我会将外部 css 包含在插件分发​​中。用 js 嵌入样式使其对 imo 的吸引力大大降低。大多数好的插件都是这样做的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T12:26:24.760

理想情况下，功能元素和表示元素应该分开，换句话说，插件应该在没有应该是可选的 css 文件的情况下工作。

但是我们并不是生活在一个完美的世界中，考虑到可能大多数时候 CSS 将被定制，将 CSS 包含在插件分发​​中是完全可以接受的。

您应该将 css 保持在最低限度，并最终添加更多、更详细的 css 示例。

# iphone - 为什么 iPod 的音频在我的应用程序导致它淡出后没有淡入？

> ID：386111
> 
> 赞同：1
> 
> 时间：2008-12-22T12:11:47.270
> 
> 标签：iphone, cocoa-touch

我的应用程序需要播放一些音频文件，我想淡出 iPod 声音，播放我的文件，然后当我的音频停止播放淡入 iPod 时（就像 iPhone 在来电时处理 iPod 音乐一样)

我正在将我的应用程序的音频会话设置为 kAudioSessionCategory_MediaPlayback 然后在我播放文件之前我调用 AudioSessionSetActive (true) 然后当我的文件结束播放时我调用 AudioSessionSetActive (false)

发生的情况是 iPod 音频通过 AudioSessionSetActive (true) 调用淡出，但在我调用 AudioSessionSetActive (false) 后它再也不会淡入

我正在使用 AVFoundation 类来播放我的音频，我在我的委托方法中使用 audioPlayerDidFinishPlaying，这就是我调用 AudioSessionSetActive (false) 的地方。

我在这里想念什么？为什么当我停用音频会话时 iPod 没有淡入？我有错误的音频会话类别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T20:01:09.923

好的，这很可爱。在 iPhone OS3 中，请参阅 AddMusic 示例。

本质上，你这样做：

```
#import <MediaPlayer/MediaPlayer.h>
...
[[MPMusicPlayerController iPodMusicPlayer] pause]
...(play your audio, with AmbientSound category)
[[MPMusicPlayerController iPodMusicPlayer] play] 
```

这是基本的。您还可以通过循环音量变化等来添加淡出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T15:59:38.677

我从苹果那里得到了关于这个的答复。不幸的是，SDK 2.2 无法实现。我提交了一个功能请求，所以谁知道将来可能会添加此功能。

# ruby-on-rails - 使用自我。与否.. 在 Rails 中

> ID：386115
> 
> 赞同：78
> 
> 时间：2008-12-22T12:14:43.440
> 
> 标签：ruby-on-rails, ruby

我已经在 Ruby 中编码了一段时间，但我不明白何时使用：

```
def self.METHOD_NAME
end 
```

要不就：

```
def METHOD_NAME
end 
```

在任何 Rails 模型中。“self”是Java中的私有修饰符吗？我什么时候应该使用它，什么时候不应该使用它？万分感谢。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2008-12-22T12:20:11.557

```
def self.method_name
end 
```

定义一个类方法。

```
def method_name
end 
```

定义一个实例方法。

[这](http://www.rubyfleebie.com/understanding-class-methods-in-ruby/)是一个非常好的帖子。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-12-22T12:36:27.407

快速解释这意味着什么：

在 ruby​​ 中，您可以在特定对象上定义方法：

```
a = "hello"

def a.informal
  "hi"
end

a.informal
=> "hi" 
```

当你这样做时会发生什么，属于 class 的对象 a`String`将其类更改为“ghost”类，即元类、单例类或特征类。那个新的类超类是`String`.

此外，在类定义中，`self`设置为正在定义的类，所以

```
class Greeting
  def self.say_hello
    "Hello"
  end
  #is the same as:
  def Greeting.informal
    "hi"
  end
end 
```

发生的情况是，`Greeting`属于 class的 object`Class`使用新方法获得了一个新的元类，所以当你调用

```
Greeting.informal
=> "hi" 
```

ruby 中没有类方法之类的东西，但语义相似。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-24T18:34:37.947

关于何时使用哪一个的好指南：

*   如果该方法依赖于对象的任何内部状态，或者必须知道它正在寻址的对象的哪个实例，那么不要将其设为类（`self.`）方法。
*   如果该方法不依赖于对象的状态，或者不依赖于对象的特定实例，则可以将 in 设为类方法。

创建类方法时，请仔细考虑它属于哪个类或模块。如果您发现自己在跨类的类方法中重复代码，请将其分解为其他类可能混入的模块。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-22T14:50:16.530

在这种情况下 - def self.method_name 使它在某种程度上等同于 Java 静态方法：

红宝石：

```
class HexHelper
  def self.to_h(num)
    sprintf("%x", num)
  end
end

use: HexHelper.to_h(12345) 
```

爪哇：

```
public class HexHelper
{
  public static String toHex(int num)
  {
    return new PrintfFormat("%x").sprintf(num);
  }
}

use: HexHelper.toHex(12345) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-22T15:35:27.997

self**始终**是当前对象

当你在这里看到自己

def self.method_name 结束

您不在实例方法中，因此 self 是当前的*Class*对象。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T12:37:16.780

**self**就像 Java 中的**this**关键字。它是对当前对象实例的引用。如果您的模型代码对当前对象执行操作，那么您可能需要一个没有 self.method_name 说明符的函数。

# .net - 在 DataTable 过滤器表达式中转义字符的正确方法

> ID：386122
> 
> 赞同：25
> 
> 时间：2008-12-22T12:17:07.790
> 
> 标签：.net, ado.net

我想知道是否有一个函数可以为过滤器表达式正确转义字符串文字。例如：

```
DataTable.Select(String.Format("[name] = '{0}'", MyName)) 
```

如果 MyName 包含 ' 或许多其他关键字符，则会生成异常。[Microsoft 文档](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)表明这些字符应该被正确转义，但是如何做到这一点有些混乱。

我已尝试按照文档中的说明将 ' 替换为 ' 和 ['] ，但是查询仍然失败。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-05-28T10:30:03.337

通过将单引号 ' 加倍为 '' 来转义它。通过包裹在 [] 中转义 * % [ ] 字符。例如

```
private string EscapeLikeValue(string value)
{
    StringBuilder sb = new StringBuilder(value.Length);
    for (int i = 0; i < value.Length; i++)
    {
        char c = value[i];
        switch (c)
        {
            case ']':
            case '[':
            case '%':
            case '*':
                sb.Append("[").Append(c).Append("]");
                break;
            case '\'':
                sb.Append("''");
                break;
            default:
                sb.Append(c);
                break;
        }
    }
    return sb.ToString();
}

public DataRow[] SearchTheDataTable(string searchText)
{ 
     return myDataTable.Select("someColumn LIKE '" 
                                 + EscapeLikeValue(searchText) + "'");
} 
```

感谢[这里的例子](http://www.csharp-examples.net/dataview-rowfilter/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T12:20:16.317

如果我将 ' 替换为两个单 ' ，则查询有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-18T15:05:05.043

```
 /// <summary>
    /// <para>If a pattern in a LIKE clause contains any of these special characters * % [ ], those characters must be escaped in brackets [ ] like this [*], [%], [[] or []].</para>
    /// <para>If the pattern is not in a like clause then you can pass valueIsForLIKEcomparison = false to not escape brackets.</para>
    /// <para>Examples:</para>
    /// <para>- strFilter = "[Something] LIKE '%" + DataTableHelper.EscapeLikeValue(filterValue) + "%'";</para>
    /// <para></para>
    /// <para>http://www.csharp-examples.net/dataview-rowfilter/</para>
    /// </summary>
    /// <param name="filterValue">LIKE filterValue. This should not be the entire filter string... just the part that is being compared.</param>
    /// <param name="valueIsForLIKEcomparison">Whether or not the filterValue is being used in a LIKE comparison.</param>
    /// <returns></returns>
    public static string EscapeFilterValue(string filterValue, bool valueIsForLIKEcomparison = true)
    {
        string lb = "~~LeftBracket~~";
        string rb = "~~RightBracket~~";
        filterValue = filterValue.Replace("[", lb).Replace("]", rb).Replace("​*", "[*​]").Replace("%", "[%]").Replace("'", "''");
        if (valueIsForLIKEcomparison)
        {
            filterValue = filterValue.Replace(lb, "[[]").Replace(rb, "[]]");
        }
        else
        {
            filterValue = filterValue.Replace(lb, "[").Replace(rb, "]");
        }

        return filterValue;
    } 
```

# asp.net - 在 SessionPageStatePersister 中保持 ViewState

> ID：386131
> 
> 赞同：10
> 
> 时间：2008-12-22T12:20:04.787
> 
> 标签：asp.net, session, viewstate

我想在会话中保留特定页面的视图状态，但是下面的代码块对我没有帮助，我可能会丢失什么？

所以这是我页面的代码隐藏文件内容；

```
 public partial class ConfigurationEditorWebForm : PageBase
    {
        protected void Page_Load(object sender, EventArgs e)
        {
        }

        protected override bool VerifyAccess()
        {
            return true;
        }

        protected override PageStatePersister PageStatePersister
        {
            get
            {
                return new SessionPageStatePersister(this);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T02:34:23.507

请注意，即使将页面状态移动到视图状态后，您仍然会在页面上看到 __Viewstate 元素。

另外，我相信[这个解决方案](http://aspalliance.com/72)可能比其他提供的解决方案更正确，因为它更优雅地处理后退按钮。当您将 ViewState 存储在隐藏变量中时，它成为 HTML 的一部分，因此如果用户单击后退按钮 2 或 3 页并继续他正在做的事情，它就可用。在每个页面请求中盲目地丢弃 Viewstate 将阻止后退按钮按用户期望的方式运行。

但是，首先要注意这可能不是一个好主意。我建议*至少先做*两件事：

首先，确保您已关闭所有不需要它的控件上的 Viewstate（可能是大多数控件）。您可以通过将“IsViewstateEnabled”设置为 false 来执行此操作。

其次，在您的网络服务器上打开 http 压缩。即使您有一个合理大小的视图状态，总页面重量（压缩时 -*不是在您的浏览器中查看的*）应该相对较小。

希望有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T17:29:43.627

您可能会在 ViewState 隐藏字段中看到 ControlState，它的存储方式与“正常”ViewState 不同。

要将 ControlState 也存储在会话中，请将以下条目添加到 web.config 文件：

```
 <system.web>
    <browserCaps>
      <case>
        RequiresControlStateInSession=true
      </case>
    </browserCaps>
  </system.web> 
```

查看[此页面](http://szokelizer.blogsome.com/2006/11/09/how-to-put-controlstate-into-viewstate-and-how-to-put-viewstate-into-session/)了解更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T18:39:43.637

代码的重要部分是

```
protected override PageStatePersister PageStatePersister
{
    get
    {
        return new SessionPageStatePersister(this);
    }
} 
```

这会覆盖普通的页面状态持久化器，并提供一个将页面数据持久化到 Session 而不是 ViewState 的持久化器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T02:58:11.680

我的答案可能不是你想要的，但作为最后的手段，你可能不得不做这样的事情。

[我应用了https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=240686](https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=240686)中描述的反射锁，并构建了自己的进程内会话管理器并将所有会话数据存储在其中。

在发现 WYSIWYG 构建器生成的 HTML 不佳后，我转而使用 Response.Write 手动编写所有 HTML。

Presto 没有更多的问题。很多工作，但这是值得的。

编辑：低于 0 的投票不公平，因为您不喜欢忽略所有 Web 表单的想法。当工具对我不起作用时，我不会使用它们。如果工具不适合你并且你不能让它们工作，你也不应该使用它们。

# c++ - 获取 DLL 中导出函数的签名

> ID：386133
> 
> 赞同：21
> 
> 时间：2008-12-22T12:20:15.550
> 
> 标签：c++, c, function, dll, apimonitor

是否可以从 DLL 中获取导出的（C 风格？）函数的签名（参数计数/类型、返回类型）？[我可以使用DLL Export Viewer 查看](http://www.nirsoft.net/utils/dll_export_viewer.html)函数名称、地址、序数等列表，但无法查看签名。我只有 dll 文件，既没有 .h 也没有 .def 文件。

**更新：**使用名为[API Monitor](http://www.apimonitor.com/)的工具，我可以附加到使用上述 dll 的进程并查看对函数的调用。这让我可以看到参数的数量、返回值及其整数值（指针？），但这并没有多大帮助。我可能应该找到一种方法来确定这些指针在调用时指向的结构类型。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-22T15:18:41.823

DLL 不存储它们导出的函数的签名。其他答案提到了 C++，当 C++ 函数导出*为 C++*时，名称确实会被破坏。使用正确的编译器的修饰方案对其进行解码，您将获得签名。但大多数 DLL 不使用其 C++ 名称导出 C++ 函数。相反，DLL 选择导出的函数是使用 C 风格的名称导出的，因此即使 DLL 是用 C++ 编写的，导出的函数仍然没有任何签名信息。

你没有标题？大多数供应商都在他们的 SDK 中包含了这类东西。如果你没有得到一个，然后向供应商投诉。如果您不应该得到一个，那么也许您正在以错误的方式执行任务；你确定你应该直接使用那个DLL吗？

如果您没有头文件，那么您可能还会问自己，您是否真的被合法地允许在您的程序中使用 DLL。如果它只是您在系统上找到的任意 DLL，那么即使您可以为它编写代码，在您发布程序时也可能不允许重新分发它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T12:28:43.507

对于 C 函数，此信息根本不存储在 DLL 中。我唯一能建议的是反汇编函数并查看它如何与堆栈上的变量交互，然后尝试确定签名。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T12:24:40.550

在 C++ 中，函数签名以与编译器相关的方式“[变形](http://en.wikipedia.org/wiki/Name_mangling)”到名称中。这在 C 中不会发生。因此，如果您的 DLL 中有 C 函数，您将看到未损坏的名称。如果它是 C++ 的，你会看到损坏的。

C++ 需要修改名称以允许链接器解析具有不同签名的重载函数。

我认为您没有任何方法可以从“C”DLL 中获取函数签名。他们根本不存在。

# visual-studio - 有人为 GhostDoc 插件制作了德语配置文件吗？

> ID：386139
> 
> 赞同：1
> 
> 时间：2008-12-22T12:23:38.790
> 
> 标签：visual-studio, documentation, ghostdoc

有人制作了德语版的 GhostDoc 模板文本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T21:42:59.523

据我所知，GhostDoc 的处理基于一组基于程序员英语约定的硬编码解析规则。我编写了一个替代加载项 (AtomineerUtils)，它使用与语言无关的基于 Xml 的规则文件，因此很容易转换规则以用于不同的语言。

有关详细信息，请参阅[http://www.atomineerutils.com/](http://www.atomineerutils.com/)

# c# - 图像类型文件 C# ASP.Net 所需的 IHttpHandler 示例

> ID：386142
> 
> 赞同：1
> 
> 时间：2008-12-22T12:25:49.050
> 
> 标签：c#, asp.net, ihttphandler

谁能提供一个处理图像类型的 IHttpHnalder 的好例子。我想调整托管在我的服务器上的图像大小

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T12:39:43.220

[使用 iHttpHandler 的问题](https://stackoverflow.com/questions/385945/problem-using-ihttphandler)

和

[如何知道请求了哪个图像](https://stackoverflow.com/questions/385681/how-to-know-which-image-has-been-requested-caspnet)

两者都有用于提供图像的 HTTPHandler 示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T10:04:18.350

Zhaph 和 Ady 的答案似乎已经指向正确的方向，但如果您需要一个额外的例子......

[我在荷兰`BlobStreams`的*Microsoft.NET 杂志*](http://peshir.wordpress.com/2008/06/12/cool-my-article-got-translated-and-expanded-upon/ "BlobStream 文章，荷兰语和英语")上发表的文章包括[一个非常简单的从数据库 BLOB 提供图像的示例](http://download.microsoft.com/download/1/0/e/10e9204a-88fe-4e8b-94f6-e14497dded6b/dnm12_109_Code.zip "荷兰 BlobStream 文章的示例代码")。不记得该示例是否使用了一个`IHttpHandler`或一个简单的 ASP.NET 页面，但对于您需要的代码，它真的没那么重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T12:41:08.880

怎么样。 [http://blog.jasonnussbaum.com/?p=104](http://blog.jasonnussbaum.com/?p=104)

源码可在下载中找到。

如果您正在调整 GIF 的大小，您可能还想研究[图像量化](http://msdn.microsoft.com/en-us/library/aa479306.aspx)。

# drupal - Drupal 聚合器输入格式

> ID：386150
> 
> 赞同：1
> 
> 时间：2008-12-22T12:29:00.090
> 
> 标签：drupal, content-management-system, module, aggregators

Drupal Aggregator 核心模块是一个有用的模块，但存在许多问题。在 Drupal 7 中有很多人谈论改进它。

现在我正在使用 Drupal 6 附带的 Aggregator 模块。我正在构建一个聚合站点，但存在一个大问题。有时提要包含 HTML 标记属性（例如样式、目录、标题），但聚合器的输入格式过滤器会忽略某些属性（例如样式和目录）并允许其他属性（类和 href）。没有一些属性的提要看起来很娘娘腔。聚合器包含它自己的输入格式，它不使用其他输入格式（这使问题变得更加困难！）。

问题是如何允许某些 HTML 标签的属性出现在提要中。

PS最后要做的就是修改Aggregator的核心文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T17:25:24.517

您可能需要考虑迁移到基于 FeedAPI 构建的较新解决方案之一

[http://drupal.org/node/326601](http://drupal.org/node/326601)

正如您从那里开始看到的那样，这就是聚合方式的操作所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-02T10:46:41.630

移至 FeedAPI。唯一的缺点是没有针对不同提要的即时块。但是，可以使用 nodeblock 进行设置，并在提要项的提要节点中嵌入视图，这也允许您使用视图和 feedapi 映射器来确定在每个提要中显示哪些信息。

对于任何繁重的提要，聚合器只是一个糟糕的模块。它没有提供灵活性，并且不能很好地与 Views 配合使用。如果您认真地构建一个用于聚合的整个站点，请切换到 feedapi，然后使用视图来控制可以从提要创建的节点的显示。

这将需要一些工作，但从长远来看，您将省去试图找到可能不存在的神秘提要聚合器解决方案的麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T21:43:54.353

我早就放弃了 Aggregator，但我鼓励您深入研究源代码以查看问题所在。大多数核心模块的代码都有很好的文档记录，这是查看模块实际工作方式的最简单方法。

我的猜测是，它要么使用硬编码的标签字符串来允许，要么搭载过滤后的 HTML 输入格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-06T18:16:52.113

简短而简单。[在http://api.drupal.org/api/function/aggregator_filter_xss](http://api.drupal.org/api/function/aggregator_filter_xss)查看函数 aggregator_filter_xss() 。

```
<?php
function aggregator_filter_xss($value) {
  return filter_xss($value, preg_split('/\s+|<|>/', variable_get('aggregator_allowed_html_tags', '<a> <b> <br> <dd> <dl> <dt> <em> <i> <li> <ol> <p> <strong> <u> <ul>'), -1, PREG_SPLIT_NO_EMPTY));
}
?> 
```

如您所见，有一个名为*aggregator_allowed_html_tags*的 drupal 变量。

您只需要在您的一个模块的设置表单上使其可编辑。因为我没有找到允许编辑这个变量的drupal管理页面，所以我会说没有。

这是您的自定义模块所需的代码：

```
function your_module_settings()
{
    $form = array();

    // Params para aggregator
    $form['aggregator_allowed_html_tags'] = array(
        '#type'          => 'textarea',
        '#title'         => t('Core Module Aggregator allowed tags'),
        '#default_value' => variable_get('aggregator_allowed_html_tags', '<a> <b> <br> <dd> <dl> <dt> <em> <i> <li> <ol> <p> <strong> <u> <ul>'),
        '#required'      => TRUE,
        '#description'   => t('Core Module Aggregator allowed tags'),
    );

    return system_settings_form($form);
}

function your_module_menu()
{
    $items = array();

    $items['admin/content/your-module'] = array(
        'title'            => 'My module settings',
        'description'      => 'desc',
        'page callback'    => 'drupal_get_form',
        'page arguments'   => array('your_module_ pasos'),
        'type'             => MENU_NORMAL_ITEM,
    );

    return $items;
} 
```

我希望它会有所帮助。

# python - 需要帮助 - 位域转换

> ID：386151
> 
> 赞同：-3
> 
> 时间：2008-12-22T12:29:23.490
> 
> 标签：python, string, bits, bit-fields

我想将字符串转换为位字段。另外，将它们转换为二进制然后使用。需要这方面的帮助..帮助我..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T12:49:44.183

我认为[struct 模块](http://www.python.org/doc/2.5.2/lib/module-struct.html)是你所追求的。

使用示例：

```
>>> from struct import *
>>> pack('hhl', 1, 2, 3)
'\x00\x01\x00\x02\x00\x00\x00\x03'
>>> unpack('hhl', '\x00\x01\x00\x02\x00\x00\x00\x03')
(1, 2, 3)
>>> calcsize('hhl')
8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T12:33:30.017

它们都是二进制的......我们在谈论哪种语言？

我首先将字符串视为一个字符数组并单独处理每个字符。

# delphi - 对于 Delphi IDE，代码编辑器中的函数列表，如 Visual Studio

> ID：386154
> 
> 赞同：3
> 
> 时间：2008-12-22T12:30:46.060
> 
> 标签：delphi, ide, code-editor

对于 Delphi IDE，是否有任何工具/专家可以知道光标所在函数的名称，而无需滚动代码编辑器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T16:17:49.830

[CnPack](http://www.cnpack.org/index.php?lang=en)也免费提供 ;-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-22T13:02:23.250

Castalia 是您想要的工具，适用于所有 IDE，包括后 Delphi 7 版本。 [TwoDesk 的 Castalia](http://www.twodesk.com/castalia/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T15:36:24.830

结构窗格在代码窗口打开时提供此信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-30T20:30:16.400

有趣的是，没有人提到 GExperts - 这是 Delphi 的免费插件，可以完美地与从 Personal 到 Architect 的所有版本一起工作。并且里面有**很多**有用的东西。就我个人而言，如果没有安装 GExperts，我什至不会碰 Delphi - 但那就是我：D

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T12:52:57.047

我从未亲自使用过它，但[CodeRush for Delphi](http://www.qbssoftware.com/product_info.aspx?current=DETAILEDINFO&product=CODER#delphi)可能是您正在寻找的工具（在链接页面上搜索“breadcrumb”）。

# c# - XSD 代码生成器的比较

> ID：386155
> 
> 赞同：76
> 
> 时间：2008-12-22T12:31:36.073
> 
> 标签：c#, xsd, code-generation

我正在研究从 xsd 模式文件生成代码。我的要求：

*   必须生成 C# 2.0 代码（或更高版本），在需要时使用泛型集合。
*   必须从 xsd 评论生成评论
*   必须生成完全可序列化的代码。
*   从具有相同包含的多个 xsd 生成时，应该能够生成可重用的基本类型。

（另请参阅我的其他问题：[如何从 xsd 生成具有公共包含的多个类？](https://stackoverflow.com/questions/374600/how-can-i-generate-multiple-classes-from-xsds-with-common-includes)以及[如何从 wsdl 中的 xs:documentation 标签生成注释？](https://stackoverflow.com/questions/374086/how-can-i-generate-comments-from-xsdocumentation-tags-in-a-wsdl)

我找到了以下选项：

1.  使用 xsd.exe（随 SDK 和 Visual Studio 提供）
2.  [Daniel Cazzulino](http://www.clariusconsulting.net/blogs/kzu/archive/2004/05/14/XsdCodeGenTool.aspx)的 XSDCodeGen
3.  [Xsd2代码](http://www.codeplex.com/Xsd2Code)
4.  [代码XS](http://www.bware.biz/CodeXS/)
5.  微软的[XsdObjectGen](http://www.microsoft.com/downloads/details.aspx?familyid=89e6b1e5-f66c-4a4d-933b-46222bb01eb0&displaylang=en)
6.  [XSDClassGen](http://www.dotnetjunkies.com/WebLog/ram-marappan/default.aspx)（似乎在行动中失踪）

我错过了吗？因为 (1)、(2) 和 (5) 不生成 2.0 代码，而且我在序列化 (3) 中的代码时遇到问题。生成代码时使用什么？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-01-19T03:09:35.813

我相信[XSD2Code](http://xsd2code.codeplex.com/)是目前可用的最好的工具（2011 年）。

我最近在分析可用工具时经历了相同的过程，所以我想我会提供与**VS2010**相关的更新答案。

我们的主要驱动因素是**xsd.exe**不会从 XSD 注释生成 XML 文档，这是我们想要的，因为我们有数百个类型定义。我尝试了上面列出的所有工具以及其他工具，但大多数工具要么已弃用、未维护或无法匹配 VS2010 中可用的 xsd.exe 的当前功能。

**然而， Xsd2Code**是一个极好的工具，并且似乎得到了积极的维护。它提供了上面列出的所有功能以及更多功能 - CodePlex 页面还提供了很好的示例，说明了各种选项如何影响输出。

它还具有紧密的 VS 集成，包括上下文菜单集成和自定义构建工具（这意味着如果您在项目中引用 XSD 并指定自定义工具，它将在您更新 XSD 时自动更新代码）。总而言之，为我们节省了很多工作。

我查看的其他工具的快速摘要：

*   [Dingo](http://dingo.sourceforge.net/) - 似乎更符合 Java
*   XSDCodeGen - 更多关于如何编写自定义构建工具的演示
*   [CodeXS](http://www.bware.biz/CodeXS/) - 相当不错的工具，但集成少，功能少，不再维护
*   XSDObjectGen - 不再维护，功能比当前 xsd.exe 少
*   XSDClassGen - 找不到它
*   [OXM 库](http://oxmlibrary.codeplex.com/)-**推荐**查看这个项目，维护和强大的功能
*   [LINQ to XSD](http://linqtoxsd.codeplex.com/) - 非常**酷的**项目，但不是我想要的

**附录：** 如果您决定继续使用 XSD2Code，我发现使用命令行工具会出现许多问题。特别是，参数处理存在一些错误，要求某些参数按特定顺序排列，以及一些未记录的依赖项（例如 - 自动参数和 .NET 版本是特定于顺序和依赖的）。以下是我使用 XSD2Code 生成代码然后清理输出的步骤 - 根据需要获取适用于您的位：

运行以下批处理文件以生成初始代码，将路径更改为正确的位置：

```
@echo off

set XsdPath=C:\schemas
set OutPath=%XsdPath%\Code
set ExePath=C:\Progra~1\Xsd2Code
set Namespace=InsertNamespaceHere

echo.Starting processing XSD files ...
for /f %%a IN ('dir %XsdPath%\*.xsd /a-d /b /s') do call:ProcessXsd %%a

echo.Finished processing XSD files ...
echo.&pause&
goto:eof

:ProcessXsd
%ExePath%\Xsd2Code %~1 %Namespace% %XsdPath%\Code\%~n1%.cs /pl Net35 /if- /dc /sc /eit
echo.Processed %~n1
goto:eof 
```

根据需要执行以下步骤来整理生成的代码：

1.  正则表达式替换 - 当前项目、案例、整个单词 - **[System.Runtime.Serialization.DataContractAttribute(Name:b*=:b*:q,:b *Namespace:b* =:b*{:q})] 与 [DataContract(命名空间 = \1)]**
2.  用**[DataMember]**替换 - 当前项目、案例、整个单词 - **[System.Runtime.Serialization.DataMemberAttribute() ]**
***   正则表达式替换 - 当前项目、案例、整个单词 - **System.Nullable\<{:w}>**与**\1\?***   正则表达式替换 - 打开文档、大小写、整个单词 - **{:w}TYPE**与**\1***   替换 - 打开文档、案例、整个单词 - **System.DateTime**与**DateTime**，然后添加缺少的 using 语句*   替换 - 打开文档、案例、整个单词 - **[System.Xml.Serialization.XmlIgnoreAttribute()]**与**[XmlIgnore]***   用**XmlArray**替换 - 当前项目 - **System.Xml.Serialization.XmlArrayAttribute*****   用**XmlArrayItem**替换 - 当前项目 - **System.Xml.Serialization.XmlArrayItemAttribute*****   正则表达式替换 - 当前项目 - **,[:Wh]+/// \<remarks/\>**为**,********

 ****希望对某人有所帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-04T00:03:29.083

我还没有检查过这个，但[Linq2XSD](http://blogs.msdn.com/marcelolr/archive/2009/06/03/linq-to-xsd-on-codeplex.aspx)可能是一个有用的选择。

我要试试这个。带有 XSD 生成的 LINQ 会比您提到的任何这些工具更好 - 只要它运行良好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-04T15:46:03.300

OpenSource 项目[XSD to Classes](http://code.google.com/p/xsd-to-classes/)非常适合我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T12:50:55.257

一年多前我的一个项目我们使用了 CodeXS。通过一些小的调整（一个稍微清理了生成代码的脚本），它很有魅力。

还有[Dingo](http://dingo.sourceforge.net/)，它具有一些非常好的可扩展性功能（我们不需要）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-05T22:14:22.687

试试 OxmLibrary - [http://oxmlibrary.codeplex.com](http://oxmlibrary.codeplex.com "这个链接")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-20T00:57:43.080

我发现的最好的 XSD 类生成器是 [thinktecture WSCF.blue](http://wscfblue.codeplex.com/) 。它比大多数其他的更好，原因有两个：

1.  修复命名。这意味着类型和属性名称的大小写和复数。
2.  为每个类创建一个单独的文件。

或者，如果您正在寻找 T4 解决方案，您可以尝试 [XsdClassGen](http://nuget.org/List/Packages/XsdClassGen/0.1) 。这个不适合我。但好消息是它是 T4 文件，因此很容易修复！

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-04-26T15:20:27.610

这是使用 XSLT 将 XML 转换为 C# 代码的[基于 Web 的示例。](http://fryerblog.com/post/15728297514/generating-service-contracts-with-xslt-part-ii)该示例采用描述服务（基本上是服务名称、命名空间和操作列表）的模型 (XML)，然后在 C#.net 中生成 WCF 服务（接口、消息、故障、测试等）。

# sql-server - T-SQL 中的悲观锁

> ID：386162
> 
> 赞同：5
> 
> 时间：2008-12-22T12:34:23.090
> 
> 标签：sql-server, locking, transactions, pessimistic

如果我在 MS SQL Server 中选择一行进行更新，并希望将其锁定直到我更新或取消，哪个选项更好：-

1) 使用像 UPDLOCK 这样的查询提示 2) 对事务使用 REPEATABLE READ 隔离级别 3) 任何其他选项。

谢谢，查克。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T14:00:47.050

如果您正在等待其他资源，例如最终用户，请听从 Dave Markle 的建议，不要这样做。

否则，请尝试以下 T-SQL 代码：

```
BEGIN TRAN

SELECT *
FROM   authors AU
WITH   (HOLDLOCK, ROWLOCK)
WHERE  AU.au_id = '274-80-9391'

/* Do all your stuff here while the row is locked */

COMMIT TRAN 
```

**HOLDLOCK**提示礼貌地要求 SQL Server 保持锁定，直到您提交事务。**ROWLOCK**提示礼貌地要求 SQL Server 只锁定这一行，而不是发出页或表锁。

请注意，如果有很多行受到影响，SQL Server 将主动升级为页面锁，或者您将拥有一大堆行锁填充服务器的内存并阻碍处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T12:39:35.577

两者都不。在用户输入数据时，您几乎不想让事务处于打开状态。如果*必须*实现这样的悲观锁，人们通常通过滚动自己的功能来实现。

考虑你正在做的事情的全部后果。我曾经在一个像这样实现锁定的系统上工作过。你经常遇到大量陈旧的锁，当你把它强加给他们时，你的用户很快就会感到困惑和愤怒。在我们的案例中，我们的解决方案是完全删除此锁定功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T14:02:53.333

请注意，尽管使用 ROWLOCK SQL Server 可能会在认为需要时选择仍采用整页锁定。

# c++ - C++ Mysql++，总是连接失败！

> ID：386174
> 
> 赞同：0
> 
> 时间：2008-12-22T12:41:01.017
> 
> 标签：c++, connection, mysql++

步骤：
- 安装 Mysql Server 2005
- 下载 Mysql++，构建调试版和发布版。
- 运行 install.hta 并选择一个目录
- 在 MSVC++ 2008 中添加库/包含目录
- 在我的应用程序中包含 mysql++.h
- 将 .dll 文件（libMYSQL.dll 和 mysqlpp.dll 和 mysqlpp_d.dll）移动到 Debug 文件夹。

相关代码：

```
#include "mysql++.h"

class Database {

private:

    mysqlpp::Connection* conn;

public:

    ~Database();
    bool Connect(char* ip, char* user, char* pass, char* db);

};

bool Database::Connect(char* ip, char* user, char* pass, char* db) {
    conn = new mysqlpp::Connection(false);
    return conn->connect(db, ip, user, pass);
}

Database::~Database() {
    if(conn) {
        delete[] conn;
    }
} 
```

问题：

```
Database db;
db.Connect("127.0.0.1", "root", "mypassword", "mydb"); 
```

这将*始终*返回 false，即使我使用与 MySQL 管理员完全相同的凭据并正确登录。

帮助 ：（

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T18:45:52.803

我不会做这个指针：

```
mysqlpp::Connection* conn; 
```

只需使其成为班级的普通成员即可。

```
mysqlpp::Connection conn; 
```

这有几个优点。
但对你来说最重要的是你会避免浅拷贝问题。

### 规则 4：

如果对象是 RAW 指针的所有者，则需要定义以下 4 个成员以确保正确处理内存管理：

```
* Constructor
* Copy Constructor
* Assignment Operator
* Destructor 
```

这是因为如果您不定义它们，编译器会自动为您生成上述方法。在大多数情况下，这些方法都有效，但如果您的对象包含您拥有的 RAW 指针（即删除它），那么编译器生成的这些方法的版本将出现严重错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T18:55:33.970

我也会使用字符串而不是 char 指针：

```
bool Database::Connect(char* ip, char* user, char* pass, char* db) 
```

尝试：

```
Database::Database(std::string const& ip,
                   std::string const& user,
                   std::string const& pass,
                   std::string const& db) 
```

请注意，通过将代码从方法 Connect() 移动到 constructor()，您可以使对象始终有效。

# .net - .NET 应用程序中的“活动目录集成”是什么意思？

> ID：386178
> 
> 赞同：13
> 
> 时间：2008-12-22T12:41:37.413
> 
> 标签：.net, asp.net, winforms, active-directory

我们的营销部门将“活动目录集成”作为主要客户要求回来了，但我们公司似乎没有足够的注意力来（1）决定我们要为此做出哪些功能更改，（2）采访广泛的客户来确定最需要的功能更改，以及 (3) 这仍然是下周的“烫手山芋”问题。为了帮助我超越“活动目录集成”这个广泛的话题，它在您的 .NET 应用程序（ASP.NET 和 WinForms）中意味着什么？

以下是我必须考虑的一些示例更改：

1.  在您的应用程序中创建和管理用户时，管理员会看到所有 AD 用户的列表还是仅显示一组 AD 用户？
2.  在您的应用程序中创建新的安全组（我们称它们为部门，例如“人力资源”）时，是否应该创建新的 AD 组？
3.  管理员是否通过 AD 将用户分配到您的应用程序内部或外部的安全组？有关系吗？
4.  用户是否通过登录 Windows 来登录您的应用程序？如果没有，您是否使用自己的用户表和某种外键跟踪用户到 AD 中？您使用什么外键将应用程序用户链接到 AD 用户？您是否必须证明您的登录过程可以保护用户密码？
5.  您使用什么外键将应用安全组链接到 AD 安全组？
6.  如果您的应用程序有一个 WinForms 组件（我们有 ASP.NET 和 WinForms），您是否在您的 WinForms 应用程序中使用 Membership Provider？目前，我们的 Membership 和 Role 管理早于框架的版本，所以我们不使用 Membership Provider。

我是否遗漏了任何其他功能更改领域？

**后续问题**

支持“活动目录集成”的应用程序是否能够针对多个域对用户进行身份验证？并不是说一个用户会对多个域进行身份验证，而是同一系统的不同用户会针对不同的域进行身份验证。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-22T13:17:39.180

从管理员的角度来看，我想要一个广告集成来做以下事情

1.  永远不要回信给 AD，我只是在这一点上不信任 3rd 方软件
2.  能够从 AD 导入用户
3.  能够设置一个安全组，例如“ApplicationXYZ 用户”，用于软件分发和权限（共享文件夹，...），如果需要，但这应该服从数字 1.，所以管理员创建安全组并告诉应用服务器哪个一个是。

4.  单点登录（使用户更容易，因为他们只需要知道他们的 Windows 登录，并强制执行域范围的密码策略）

5.  已停用的 AD 用户或不再在“ApplicationXYZ 用户”中的 AD 用户应该无法登录

6.  将 AD-Group 链接到 Application Group 但这将是可选的，没有它我真的可以生活

hth

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T13:11:24.373

作为将 AD 用户/组映射到应用程序中的内容的关键，我通常使用来自 AD 用户/组的安全标识符 (SID)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T12:51:52.117

> 用户是否通过登录 Windows 来登录您的应用程序？

对我来说，这首先是 AD 集成的意义（除了 Windows 锁定 :-)。因此，例如，如果组织实施了公钥登录，您就可以在您的应用程序中免费获得它。

> 您是否必须证明您的登录过程可以保护用户密码？

如果您使用 AD，通常甚至不会看到密码，除非您有一些旧版 NT4（当然不必存储密码）。

> 管理员是否通过 AD 将用户分配到您的应用程序内部或外部的安全组？有关系吗？

通过广告。单点登录后，一个主要好处是能够使用您拥有的任何 AD 工具来安全管理应用程序、报告权限、创建 ACL 等。您不必为每个应用程序重新发明这些东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T12:53:14.830

使用 AD 的主要优点之一是它使专门的团队能够管理所有用户/授权事物。通常，当新用户到达时，他的经理会要求专门的团队授予他对应用程序 AB 和 C 的访问权限，而该团队可以直接从 AD 完成所有这些工作。事实上，他们经常复制另一个用户（通常是同事）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T17:18:07.893

作为一个既是 AD 管理员又目前正在开发需要集成 AD 的内部应用程序的人，以下是我的想法：

*   Active Directory 用户具有唯一的 GUID；如果您的应用程序需要同时支持*AD*和 AspNetSqlMembership 身份验证，您可以在 User/Person 表中有一个 GUID FK 字段和一个表示用户所属信息存储的标志（表单或 AD）
*   作为管理员，我应该能够限制给定 OU 下的用户对我的应用程序的访问——我不希望我的 SQL Server 或 BackupExec 工作人员帐户能够登录！
*   在您的文档中，使用标准“用户”OU 以外的 OU - 大多数现实世界的实现将他们的用户移出此容器，对于新手管理员来说，再保证有一个包含 OU 的 LDAP 查询示例（例如 MyCompany/用户/行政人员或类似人员）
*   如果您使用的是 AD 表单身份验证，那么您可能会使用密码进行恶意操作。这最好由您的法律部门在您的服务协议/保修中处理。

# .net - 如何动态创建泛型类的对象？

> ID：386183
> 
> 赞同：2
> 
> 时间：2008-12-22T12:44:59.043
> 
> 标签：.net, vb.net, generics

我有一个带有这个签名的子

```
Public Sub Save(ByVal obj As IPta) 
```

现在我想创建一个类型为 obj 的 Generic.PtaDao(of T) 的实例，它可以是从我的基类 Pta 继承的任何东西

我怎样才能做到这一点？我已经找到了 ac# 示例 [动态声明一个泛型类型实例](https://stackoverflow.com/questions/307984/declare-a-generic-type-instance-dynamically)

但我不明白如何在我的情况下实现这一点。

蒂亚

-编辑-

澄清

假设 obj 是 Address 类型的对象（Address 继承自 Pta，因此它实现了 IPta）

现在我想创建一个以 Address 对象为例的新 PtaDao 对象

```
Dim AddressDao as New Generic.PtaDao(of Address) 
```

但我想动态地这样做，所以如果 obj 是 UserGroup 类型，它应该创建一个 PtaDao(of UserGroup)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T13:42:48.397

使其成为泛型方法，将类型参数的实例作为参数之一，并将类型参数约束为具有公共无参数构造函数并实现 IPta：

```
Public Sub Save(Of T As { IPta, New })(ByVal obj As T)
    Dim foo As New T
    ' Do more stuff here
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T13:53:28.467

如果您有权访问 Save 方法的源代码，请将其设为通用：

```
Public Sub Save(Of TSomeIPtaType As {IPta, New})(ByVal obj As TSomeIPtaType)
    Dim dao As New Generic.PtaDAO(Of TSomeIPtaType)
End Sub

Public Sub ExampleUsage()

    Dim address As New Address

    Save(address)

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T13:58:48.490

这不是答案，只是一些建议......

仔细看看你为什么要这样做。我遇到过类似的情况，我使用大量反射来创建泛型对象并使用直到运行时才知道的类型调用泛型方法。

结果运行缓慢，而且很难看维护。我最终意识到让整个事情只传递 Object 实例并执行偶尔的类型转换会更好。

This may not be the case for you (for example, if the generic class is from an external library that you have no control over, or if this use is a one-off), but it's worth standing back and taking a look.

# c# - 从asp.net代码中获取某个网站的源码

> ID：386189
> 
> 赞同：4
> 
> 时间：2008-12-22T12:49:44.213
> 
> 标签：c#, asp.net-2.0

有什么方法可以从asp.net网站后面的代码中的一些c#代码中获取网站的来源（最好是字符串），比如说www.google.com？

编辑：当然我的意思是 html 代码 - 在每个浏览器中，您都可以使用上下文菜单中的“查看**源代码”来查看它。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T13:01:37.433

假设您要检索 html：

```
class Program
{
    static void Main(string[] args)
    {
        using (WebClient client = new WebClient())
        using (Stream stream = client.OpenRead("http://www.google.com"))
        using (StreamReader reader = new StreamReader(stream))
        {
            Console.WriteLine(reader.ReadToEnd());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T17:04:05.633

对于 C#，我更喜欢使用[HttpWebRequest](http://www.codeproject.com/KB/IP/httpwebrequest_response.aspx)而不是 WebClient，因为将来您可以有更多选择，例如使用 GET/POST 参数、使用 Cookie 等。

您可以在[MSDN](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx)获得最短的解释。

这是来自 MSDN 的示例：

```
 // Create a new HttpWebRequest object.
        HttpWebRequest request=(HttpWebRequest) WebRequest.Create("http://www.contoso.com/example.aspx");    

        // Set the ContentType property. 
        request.ContentType="application/x-www-form-urlencoded";
        // Set the Method property to 'POST' to post data to the URI.
        request.Method = "POST";
        // Start the asynchronous operation.    
        request.BeginGetRequestStream(new AsyncCallback(ReadCallback), request);    

        // Keep the main thread from continuing while the asynchronous
        // operation completes. A real world application
        // could do something useful such as updating its user interface. 
        allDone.WaitOne();

        // Get the response.
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        Stream streamResponse = response.GetResponseStream();
        StreamReader streamRead = new StreamReader(streamResponse);
        string responseString = streamRead.ReadToEnd();
        Console.WriteLine(responseString);
        // Close the stream object.
        streamResponse.Close();
        streamRead.Close();

        // Release the HttpWebResponse.
        response.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T09:11:52.140

it's not the most obvious (and the best) way but i found out that in windows forms you can use WebBrowser control (if you actually need it), fill it's Url property with the url you need and when it's loaded, read the DocumentText property - it contains the html code of the viewed site.

# java - Java中的非法日期字符串

> ID：386191
> 
> 赞同：2
> 
> 时间：2008-12-22T12:50:56.847
> 
> 标签：java, datetime

如果我尝试解析非法日期，如何获得某种 DateFormat 以引发异常？如果我使用具有模式“dd.MM.yyyy”的 SimpleDateFormat 解析像“99.99.9999”这样的日期，则不会引发异常，但这显然不是有效日期。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T12:56:10.177

[`DateFormat.setLenient(false)`](http://java.sun.com/javase/6/docs/api/java/text/DateFormat.html#setLenient(boolean))

# sql-server - 可以使用单个查询搜索多个表吗？[MSAccess/SQL 服务器]

> ID：386200
> 
> 赞同：0
> 
> 时间：2008-12-22T12:54:09.557
> 
> 标签：sql-server, ms-access

因此，我的目标是在应用程序中拥有一个能够搜索多个表并返回结果的搜索字段。

例如，其中两个表是“performers”和“venues”，并且有以下表演者：“John Andrews”、“Andrew Smith”、“John Doe”和以下场所：“St. Andrew's Church”、“City”大厅”。有没有办法以某种方式返回前两个表演者和第一个搜索“安德鲁”的场地？

我的第一个想法是以某种方式将所有表聚合成一个包含三列的表；“SearchableText”、“ResultType”、“ResultID”。第一列将包含我想要搜索的任何内容（例如表演者姓名），第二列将显示正在显示的内容（例如表演者），第三列将显示项目的 ID（注意：为方便起见，我所有的表都有自动递增的主键） . 这个想法的问题是有可能以某种方式动态地执行此操作，或者我是否必须添加代码才能有一个表，每当从表演者和场所表中更新/添加/删除新行时（可能通过触发器？），该表就会自动填充。

我的应用程序是在 SQL Server 后端之上用 MSAccess（我知道，我知道，但我别无选择）编写的。我更喜欢通过 MSAccess 发生这种情况，因此我不必在我的 SQL Server 上放置一个“searchme”表，但任何好的结果都是可以接受的 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T12:55:36.463

我认为您正在寻找“联合” sql 关键字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T12:56:34.213

我会在 SQL 服务器中使用全文索引，有一个包含可搜索文本的表，并在链接到搜索表的主表中使用外键。这样，您可以按相关性对结果进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T03:55:53.463

我认为您有架构问题。查询 UNION 几乎总是证明这一点（尽管并非在所有情况下）。

我的问题是：

你返回的结果是什么？

如果你找到一个人，你是在显示一个人的列表吗？

或者，如果您找到场地，场地列表？

还是两者兼而有之？

我会说，如果你想返回两者的列表，那么你会想要这样的东西：

```
 SELECT tblPerson.PersonID, tblPerson.LastName & ", " & tblPerson.FirstName, "Person"
  FROM tblPerson 
  WHERE tblPerson.LastName LIKE "Andrew*"
    OR tblPerson.FirstName  LIKE "Andrew*"

  UNION 

  SELECT tblVenue.Venue, tblVenue.Venue, "Venue" 
  FROM tblVenue
  WHERE tblVenue.Venue LIKE "Andrew*"
  ORDER BY Venue 
```

这将给出一个匹配列表，指示哪个是人和哪个场地，然后允许您选择其中一个并打开详细视图（通过检查第三个字段中的值）。

你绝对*不想*做的是：

```
 SELECT tblPerson.PersonID, tblPerson.LastName & ", " & tblPerson.FirstName, "Person"
  FROM tblPerson 

  UNION 

  SELECT tblVenue.Venue, tblVenue.Venue, "Venue" 
  FROM tblVenue 
```

然后保存并尝试在第二列查询它。那将是极其低效的。您希望 WHERE 子句位于可通过索引搜索的字段上，这意味着 UNION 的每个子查询都需要有适当的 WHERE 子句。

# c# - Linq-to-Sql SubmitChanges 不更新字段...为什么？

> ID：386211
> 
> 赞同：7
> 
> 时间：2008-12-22T12:57:08.440
> 
> 标签：c#, .net, linq, linq-to-sql

我昨天晚上发布了这个[问题，这让我发现了一个](https://stackoverflow.com/questions/385442/linq-submitchanges-not-updating-certain-fields)**巨大**的问题！

我的数据库中有一个名为 Units 的小数列，每当我将该列的值设置为非零时，并且 SubmitChanges 使用新值更新该列。如果我尝试将列的值设置为零，则 SubmitChanges 不会更新该列。

```
data.Units = this.ReadProperty<decimal>(UnitsProperty);
data.UnitPrice = this.ReadProperty<decimal>(UnitPriceProperty);
data.Price = this.ReadProperty<decimal>(PriceProperty); 
```

我查看了 DataContext 日志，可以看到查询中不包含具有零值的字段。即使我尝试对更改进行硬编码，Linq 也会忽略它。

```
data.Units = 0;
data.UnitPrice = 0;
data.Price = 0; 
```

不用说这是要了我的命！任何想法为什么会发生这种情况？

**解决方案**

在 SO 社区的帮助下，我发现了我的问题。我的问题是由于当我创建要附加的实体时，列的默认值设置为零，所以当它试图将值分配为零时...... LinqToSql 说嘿......没有任何改变，所以我没有更新值。

我现在在做什么......只是为了让它工作如下：

```
ctx.DataContext.InvoiceItems.Attach(data, true); 
```

这似乎迫使所有值将自己写入数据库。这暂时有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T14:27:05.500

我试图用下面的代码重现它，但对我来说它有效。

```
using (DataClasses1DataContext ctx = new DataClasses1DataContext())
{
    var obj = ctx.DecimalColumnTables.First();
    Debug.Assert(obj.B != 0);
    obj.B = 0;
    ctx.SubmitChanges();
} 
```

所以我认为您的域中一定有一些特殊的东西导致了这种情况。我建议您使用您的域模型创建一个如此简单的重现，看看会发生什么。

LINQ to SQL 忽略对当前值的更新，因此如果该字段已经为零，您可能看不到任何更新。

Off：您使用的 OR/M 是*LINQ to SQL*。LINQ 是 .NET 中查询功能的名称，但 LINQ 不定义也不实现任何更新逻辑。所以这个问题与 LINQ to SQL 有关，而不是 LINQ。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T14:51:26.870

显而易见的问题，但是您确定该列已映射到 dbml / 映射文件中吗？

另外 - 它是一个计算列吗？（即价格 => 单位 * 单价）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T19:07:43.717

在 SO 社区的帮助下，我发现了我的问题。我的问题是由于当我创建要附加的实体时，列的默认值设置为零，所以当它试图将值分配为零时...... LinqToSql 说嘿......没有任何改变，所以我没有更新值。

我现在在做什么......只是为了让它工作如下：

```
ctx.DataContext.InvoiceItems.Attach(data, true); 
```

这似乎迫使**所有**值将自己写入数据库。这暂时有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T17:25:06.653

更多信息......我发现了我的问题......更多的是对 LinqToSql 缺乏了解......我在哪里做：

```
private void Child_Update(Invoice parent)
{
      using (var ctx = Csla.Data.ContextManager
           .GetManager(Database.ApplicationConnection, false))
      {
           var data = new Gimli.Data.InvoiceItem()
           {
                InvoiceItemId = ReadProperty(InvoiceItemIdProperty)
           };

           ctx.DataContext.InvoiceItems.Attach(data);

           if (this.IsSelfDirty)
           {
                // Update properties
           }
     }
} 
```

我认为这会加载原始值...发生的情况是它创建了一个具有默认值的新对象...空值，例如小数的 0，唯一标识符的 Guid.Empty 等等。

因此，当它更新属性时，它会看到 Units 已经为 0，并将其设置为零。好吧，LinqToSql 不会将此视为更改，因此它不会更新该字段。所以我必须做的是以下几点：

```
ctx.DataContext.InvoiceItems.Attach(data, true); 
```

现在无论是否真的有变化，所有的修改都在更新语句中生成。这行得通……似乎有点骇人听闻！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-11T19:51:29.277

正确的答案是许多人指出使用 Attach 的特殊重载，它接受一个布尔参数将其视为已修改，（犯了使用另一个重载的错误，它根本不起作用）：

```
ctx.DataContext.InvoiceItems.Attach(data, true); 
```

但是请注意，您可能仍然需要在“时间戳”类型的表中具有“版本”列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T12:23:01.687

我遇到了这个问题，我看到的所有建议都不适用或不起作用。

但是我发现我犯了一个非常简单的错误！

更新属性时，我实际上是在调用自定义 Set 方法（因为还有其他需要更改以响应相关主属性的内容）。

经过数小时的挠头后，我注意到我的 Set 方法正在更新私有成员而不是公共属性，即 this._Walking = value;

我所要做的就是将其更改为 this.Walking = value; 一切都开始起作用了！

# gcc - 如何在 GCC 中隐藏“已定义但未使用”的警告？

> ID：386220
> 
> 赞同：71
> 
> 时间：2008-12-22T13:02:29.680
> 
> 标签：gcc, warnings, compiler-warnings

我有一堆编译时断言，例如：

```
CASSERT(isTrue) or CASSERT2(isTrue, prefix_) 
```

使用 GCC 编译时，我收到很多警告，例如`'prefix_LineNumber' defined but not used`. 有没有办法可以隐藏编译时断言的警告？我没有运气搜索 GCC 文档。我想我可能会在同一个宏中自动全局使用 var，但我想不出任何方法来做到这一点。

有谁知道在 GCC 中隐藏该警告的方法？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-03-04T11:17:56.037

刚刚在寻找这个问题的解决方案时看到了这个帖子。为了完整起见，我在这里发布了我找到的解决方案...

[控制未使用警告](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)的 GCC 编译器标志包括：

```
-Wunused-function
-Wunused-label
-Wunused-parameter
-Wunused-value
-Wunused-variable
-Wunused (=all of the above) 
```

其中每一个都有一个相应的否定形式，在 W 之后插入“no-”，这会关闭警告（例如，如果它是由 -Wall 打开的）。因此，在您的情况下，您应该使用

```
-Wno-unused-function 
```

当然，这适用于整个代码，而不仅仅是编译时断言。对于特定于函数的行为，请查看[Function attributes](http://gcc.gnu.org/onlinedocs/gcc-3.4.1/gcc/Function-Attributes.html#Function%20Attributes)。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-12-22T13:45:32.040

GCC不与其他编译器冲突的解决方法

```
#ifdef __GNUC__
#define VARIABLE_IS_NOT_USED __attribute__ ((unused))
#else
#define VARIABLE_IS_NOT_USED
#endif

int VARIABLE_IS_NOT_USED your_variable; 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2011-05-12T22:09:46.187

这是最烦人的警告之一，尽管我不明白检查死代码可能有用（有时）。但是我通常有用于调试的静态函数，或者将来某个时候可能有用的函数，或者只是临时使用的函数，我想将它们保留在代码中。

幸运的是，这个警告并不关心内联函数。

```
inline static foo()
{
} 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2008-12-27T02:12:44.573

您可以创建一个空语句并将结果强制转换为 void。这可以跨编译器移植，gcc 不会给你任何警告，即使启用`-Wall`和`-Wextra`启用。例如：

```
int var;    // var is not used
(void)var;  // null statement, cast to void -- suppresses warning 
```

一种常见的技术是为此创建一个宏：

```
#define UNUSED(x) ((void)(x))

int var;
UNUSED(var); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-03-05T14:37:05.637

```
#define UNUSED_VAR     __attribute__ ((unused)) 
```

对于任何变量，只需在其类型之前使用上述宏，例如：

```
UNUSED_VAR int a = 2; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-12-10T16:47:50.227

用以下指令包装这个函数所有放在 push 和 pop 之间的代码都不会警告你未使用的函数。所有其余的代码（除了 push 和 pop）都不会受到影响。

```
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wunused-function"

... your code

#pragma GCC diagnostic pop 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-27T01:33:39.970

如果不知道静态断言宏的详细信息，这很难回答。也许您可以更改为不同的宏来避免这个问题？您可以按照建议将“未使用”属性添加到宏中，也可以使用不同形式的 CASSERT()。

以下是一些替代方案的描述：

[http://www.jaggersoft.com/pubs/CVu11_3.html](http://www.jaggersoft.com/pubs/CVu11_3.html)

[http://blog.kowalczyk.info/kb/compile-time-asserts-in-c.html](http://blog.kowalczyk.info/kb/compile-time-asserts-in-c.html)

[http://www.pixelbeat.org/programming/gcc/static_assert.html](http://www.pixelbeat.org/programming/gcc/static_assert.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-22T13:15:31.353

怎么样`-Wunused-label`？

# mobile - SQLCE 连接：保持打开还是关闭？

> ID：386223
> 
> 赞同：5
> 
> 时间：2008-12-22T13:04:29.817
> 
> 标签：mobile, sql-server-ce

考虑到移动设备上的性能，您认为使用 SQLCE 连接的最佳方法是什么。在应用程序运行期间保持打开状态，或者在需要调用数据库时将其关闭。

显然，这在一定程度上取决于您的应用程序的性质，但是我很想知道该小组实施了什么以及为什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T15:46:46.010

您绝对应该观看 Steve Lasker[关于 SQL Server Compact Edition 的 PDC08 会议](http://channel9.msdn.com/pdc2008/PC40/)。有一部分是关于性能、最佳实践和他自己的基准（~37:00）。

总之，保持开放，尽量复用命令，批量操作使用SqlCeResultSet。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T13:12:41.780

对于我的设备，我在应用程序的生命周期内保持打开状态。如果应用程序的功能始终依赖于 SQLCE 连接，这是有道理的。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-22T13:12:53.637

迟到，早释放。在操作中尽可能晚地打开连接，并尽快关闭它。打开的 SQL 连接不好。

# linux - 相同的服务器，相同的程序，但使用一张网卡启动一次，然后使用另一张网卡启动

> ID：386232
> 
> 赞同：0
> 
> 时间：2008-12-22T13:11:35.650
> 
> 标签：linux, networking, command-line-interface, php

我有一个具有多个 ip 的 Linux 服务器（因此，多个 eth0、eth0:0、eth0:1 等）。我试图启动的脚本是一个 php CLI 脚本，它从另一个服务器 API 下载东西，我想根据不同的参数更改 IP。脚本启动后，我不再需要更改特定脚本的 ip，直到他结束。

如果有可能实现它，您是否有任何线索？我的另一个解决方案是安装 Xen 或 OpenVZ 并为每个 IP 创建 N 个不同的 VPS，但正如您所看到的，绝对是一个 PITA :-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T13:27:05.853

您没有指定如何连接到其他服务器，但使用套接字您可以尝试[socket_bind](http://no.php.net/manual/en/function.socket-bind.php)。

编辑：使用 curl 您可以尝试[curl_setopt](http://no2.php.net/manual/en/function.curl-setopt.php)。CURLOPT_INTERFACE 要使用的传出网络接口的名称。这可以是接口名称、IP 地址或主机名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T13:52:19.047

我知道如何在 C 中执行此操作 - 在调用 connect() 之前在套接字上使用 bind()，然后绑定到分配给所需接口的 IP 地址，将 0 传递给端口。我不知道如何在 PHP 中做到这一点。

# windows - 像 GDrive 这样的驱动器的外壳扩展？

> ID：386239
> 
> 赞同：5
> 
> 时间：2008-12-22T13:16:12.647
> 
> 标签：windows, shell-extensions

如何编写一个 shell 扩展来在虚拟驱动器中显示在线文件，就像 Gmail 驱动器一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T13:44:29.080

CodeProject 上有一篇由两部分组成的文章，其中可能包含实现对资源管理器的此类扩展的信息：[第 1](http://www.codeproject.com/KB/shell/TipsInNSE_SubFld.aspx)部分，[第 2 部分](http://www.codeproject.com/KB/shell/NSExtAddDelFld.aspx)。

# oracle - 如何部署 Oracle 数据库？

> ID：386245
> 
> 赞同：6
> 
> 时间：2008-12-22T13:23:10.887
> 
> 标签：oracle, database-installation, database-deployment

我有一个连接到 Oracle 或 SQL Server 数据库的 ASP .NET 应用程序。已经开发了一个安装程序，用于使用诸如“恢复数据库...”之类的 sql 命令将新数据库安装到现有 SQL Server，它只是恢复我们保持在源代码控制下的“.bak”文件。

我对 Oracle 很陌生，我们的应用程序最近才移植到与 10g 兼容。

我们目前正在使用“exp.exe”工具生成“.dmp”文件，然后使用“imp.exe”将其导入开发人员框。

您将如何创建“Oracle 数据库安装程序”？

您会使用脚本文件创建数据库，然后使用**所需**的默认数据填充数据库吗？

你会在幕后运行“imp.exe”工具吗？

我们是否需要为系统管理员提供一个干净的界面，以便他们可以选择目标服务器并完成，还是应该只为他们提供“.dmp”文件？最佳实践是什么？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T13:38:40.387

问题是——您的客户对 Oracle 了解多少？

*   没有？你或许应该重新考虑这个立场。Oracle 非常庞大和复杂。如果您假设您的客户一无所知，那么您将开始提供不适当的教程和帮助。

*   最低限度的能力？如果他们有能力，他们知道的足够多，可以自己运行 imp。此外，他们知道足以运行执行 SQL 的脚本。

*   实际的 DBA？大多数能够负担得起 Oracle 的组织都可以负担得起真正的 DBA。真正的 DBA 可以应付很多事情——他们不需要太多的牵手。他们中的一些人喜欢根据他们的商店标准分配存储参数。

您应该提供具有合理默认值的脚本。您应该以一种有人可以轻松找到所有存储参数并在必要时调整它们的方式定义您的脚本。

您的初始数据可以通过导出/导入或脚本。我更喜欢脚本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T22:19:09.727

作为 DBA、开发人员和架构师，我从双方（消费者和提供者）反复这样做。

作为供应商，我的一项重大成就（1996 年）是为最大的保险公司（价值数百万美元的项目）的商业保险索赔管理软件产品创建了安装 CD。该安装 CD 安装了 Oracle 7.2 RDBMS 引擎、FileNet 光学存储系统（扫描纸质文档并创建编目二进制版本）和我们的自定义索赔处理应用程序（内置于 VB 4.0），所有这些都已集成并可以运行。作为安装过程的一部分，用户可以跳过 Oracle 软件安装或对其进行自定义，并且用户可以自定义/覆盖数据库配置的所有主要细节（数据库、模式、表空间、大小、磁盘等）。

我还为该产品提供了现场服务，其中包括必要时前往客户现场。我在我可以复制的每个可以想象的场景下对安装 CD 进行了数百次测试，我们从来没有遇到过需要打电话的现场故障，更不用说旅行了（我确实旅行了四次，但是为了预售的东西反而）。

最近（2007 年），我为一家大型公司的内部系统编写了一个 Oracle 10g 数据库的创建脚本。在生产中，数据库大小为 8 TB，主要用于具有高数据量的单个事务表。在测试中，数据库的大小约为 1 TB，适用于普通服务器。在开发过程中，数据库大小约为 100 MB，可以在我的笔记本电脑上运行。完全相同的脚本创建了所有三个环境，我可以在大约五分钟内扩展它们以处理新环境/机器。该数据库涉及极端的性能调整，因此所有相关特征的定制绝对至关重要。

回到保险理赔处理产品——让我补充一下，我最初受雇负责将其从 SQL Server 数据库转换为 Oracle 数据库。这种转换被认为是一种业务需要，因为大多数潜在客户并不将基于 SQL-Server 的产品视为专业、严肃的解决方案。这在今天并不常见，但它仍然普遍适用：如果软件产品能够适应目标客户（尤其是企业级客户）偏好的多个数据库选项，那么它就有更好的市场渗透机会。

同样，安装 CD 也被视为必不可少的元素。然而，这种情况以及更多情况向我表明，大多数“真正的”DBA 不会接受基于导入的数据库安装。作为一名 DBA 和架构师，我知道我绝对不会出于同样的原因。

简而言之，基于导入的数据库安装使客户几乎无法控制生成的数据库。它对客户来说是不透明的，让他们质疑它做了什么。它迫使客户付出巨大的努力来尝试行使他们所能做的微不足道的控制。它是出了名的脆弱和容易出错（Oracle 导入以所有权和权限问题、约束问题等而闻名）。权衡所有这些影响后，基于导入的数据库安装是不专业的——它没有将客户的需求放在首位。

编写数据库安装脚本可提供专业要求的正确透明度、可配置性、选择性可重复性和整体客户控制。它还鼓励您以导入不具备的方式正确理解数据库设计决策的影响。

最良好的祝愿。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T13:52:23.917

就我个人而言，我倾向于尽可能使用 SQL 脚本来创建数据库和加载数据。我倾向于使用[PL/SQL Developer](http://www.allroundautomations.nl/plsqldev.html)。它有一些很好的选项可以从现有数据库生成脚本。一旦有了这些，您就可以使用 sqlplus 或任何可以执行任意 SQL 的应用程序代码（例如带有 Java 的 JDBC）运行脚本。 [Toad](http://www.toadsoft.com/)是用于 Oracle 开发的更常见（也更昂贵）的工具。

SQL 导出的唯一限制是它不能导出 CLOB/BLOB 字段。如果您有这些，您要么需要单独执行它们（作为 PL/SQL 导出），要么将整个事情作为 PL/SQL 导出来执行。除了文件实际上是二进制导出（扩展名 .pde）并且在如何执行它方面受到更多限制之外，没有任何戏剧性。

SQL 源文件的另一大优势是它们可以轻松进行版本控制。能够通过运行一两个脚本来创建数据库环境真的很方便。

我认为 Oracle 的导入和导出工具更适用于备份和恢复操作。

现在，至于将其交付给客户，从您的评论看来，您将把它交给 DBA。几乎任何 Oracle 安装都会涉及 DBA。他们可以使用 SQL 脚本来创建架构并进行数据加载。他们将进行大量特定于站点的配置（例如，根据预期负载调整 SGA、临时表空间、并发连接数等）。

作为供应商，您可以就任何相关配置提供指导，您可能会参与支持和可能的安装，但最终由他们来决定什么对他们有用。Oracle 在大量操作系统和硬件变体上运行，网络拓扑和防火墙配置具有无限变化。您不能将所有这些因素都考虑到安装人员甚至是一组说明（前面提到的指南除外）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T14:42:02.973

上次我参与创建（oracle）数据库（对于一家拥有内部 DBA 的相当大的公司）时，DBA 想知道以下内容：

*   我们想称之为分贝，
*   我们需要哪些表空间，以及每个表空间中的数据量估计
*   有多少用户将连接。

（从记忆中）他们设置了数据库和表空间，然后我们提供了他们可以运行的简单脚本的组合（或者如果任务不容易自动化，则提供明确的说明）
正如我所说的，这是针对内部应用程序的，所以你的里程可能会有所不同，但在我的情况下，他们希望所有说明都清楚地拼写出来，以便（a）没有可能导致错误的事情发生的误解，并且（b）如果事情没有发生，他们没有责任' t 工作（“我们只是按照说明进行操作”）

# c++ - 运算符 ThisClass() 导致堆栈溢出

> ID：386252
> 
> 赞同：1
> 
> 时间：2008-12-22T13:28:49.877
> 
> 标签：c++, stack-overflow

我想保持类简单而不是定义构造函数，所以我可以做 Pt data = {0, 5}; 所以我认为将 Pt_t 从短期转换为长期或反之亦然的最佳方法是做这样的事情。

```
template <class T>
struct Pt_t
{
    T x, y;
    template <class T2> operator Pt_t<T2>() { Pt_t pt = {x, y}; return pt; }
}; 
```

编译器不喜欢这样，并在返回 pt 时调用运算符 Pt_t；从而得到堆栈溢出。我该如何防止这种情况？我能想到的唯一解决方案是让 Pt_t 使用构造函数删除 Pt_t pt = {1, 2}; 如果可以的话，我更愿意保留它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T13:40:51.693

我很确定你的函数体中不合格的 Pt_t 是`Pt_t<T>`，但你不希望它是`Pt_t<T2>`吗？您需要明确限定它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T13:40:18.323

我对 C++ 不熟悉，但是您是否在您的方法中声明了正确的类型？

不应该是`Pt_t<T2>`而不是 just`Pt_t`吗？

# asp.net - InfoPath 是正确的选择吗？

> ID：386255
> 
> 赞同：1
> 
> 时间：2008-12-22T13:31:18.793
> 
> 标签：asp.net, sharepoint, windows-mobile, infopath

好的，所以我们有一个即将进行的开发，它将涉及动态表单的一定程度的离线处理。这是我们必须做的：

*   创建一个 asp.net Web 应用程序，用户可以在其中下载动态表单，填写它们然后上传它们以进行发布。
*   我们还有一个 Windows 移动应用程序可以做类似的事情。
*   表格将要求在发布时选择要上传的图像。
*   在发布完成的表单后，需要进行某些服务器端验证，这可能会触发需要完成的额外工作，即发送电子邮件或更新数据库等。

根据我对 InfoPoint 的了解（几乎没有），它*似乎*很合适。我知道它与 SharePoint 高度相关（我对此一无所知），但可以在没有 SharePoint 实例的情况下使用它吗？

无论哪种方式，我只是首先要验证 InfoPath 是否适合我所描述的内容。如果是我也在追求一些不错的在线资源。

在此先感谢，克里斯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T13:43:44.383

我认为没有适用于移动设备的 InfoPath 客户端。您想要做的是使用[Forms Server](http://office.microsoft.com/en-us/formsserver/FX100490391033.aspx)（SharePoint 2007 企业版附带）[将 InfoPath 表单作为 aspx 呈现给移动设备](http://blogs.technet.com/vik/archive/2008/02/25/filling-out-infopath-forms-on-windows-mobile-devices.aspx)。

您描述的所有其他内容都可以使用直接的 ASP.NET 和 InfoPath 客户端来完成。移动部分听起来需要 SharePoint（用于将 InfoPath 表单呈现为 aspx）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T06:43:54.527

请参阅有关在移动设备上使用 Infopath 表单的博客文章：http: [//blogs.technet.com/vik/archive/2008/02/25/filling-out-infopath-forms-on-windows-mobile-devices.aspx](http://blogs.technet.com/vik/archive/2008/02/25/filling-out-infopath-forms-on-windows-mobile-devices.aspx)

Formotus 解决方案也可能适合您：[http ://www.formotus.com/](http://www.formotus.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T17:15:30.323

在深入研究 InfoPath (+ SharePoint) 是否是正确的解决方案之前，不使用我假设您熟悉的 ASP.NET 的原因是什么？虽然 InfoPath + SharePoint 现在很性感，但学习曲线非常高。

回到 InfoPath，我不相信 InfoPath 支持上传文件。至少不是开箱即用。因此，如果要求您的用户上传图片，我会说 infoPath 已经过时了。除此之外，InfoPath 以及 SharePoint Forms Services 和工作流可用于完成您想要的工作。我只是想知道与直接使用 ASP.NET 相比，成本会是多少。

# dependency-injection - 您最常使用哪种松散耦合模式？

> ID：386264
> 
> 赞同：16
> 
> 时间：2008-12-22T13:40:52.177
> 
> 标签：dependency-injection, inversion-of-control, loose-coupling

最近我看到很多关于如何构建松散耦合应用程序的博客文章。在创建松散耦合的应用程序时，您最常使用哪些模式？依赖注入？控制反转？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-22T13:44:04.727

[模型-视图-控制器](http://en.wikipedia.org/wiki/Model-view-controller)。

另外：阻止我编写耦合应用程序的不仅仅是模式：

*   *命名*。如果我不能轻易地为我的班级想一个名字，它要么什么都不做，要么做的事情太多。

*   *可测试性*。如果我不能轻松地模拟出我的班级的依赖关系，那就是耦合设计。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T13:53:42.977

我发现自己经常使用[命令模式。](http://en.wikipedia.org/wiki/Command_pattern)这是一种不断提供项目的模式。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-22T13:46:08.000

spring 的依赖注入是我最喜欢的。此外，在 Maven 中，将所有实现隐藏在 API 模块后面是很常见的。所以如果你的代码有三个模块，“application-core”、“externalsystems-api”和“externalsystems”，你可以让“application-core”只依赖于externalsystems-api。实际实现及其所有依赖项对于应用程序核心模块是完全不可见的。这确实加强了关注点的分离，并使松散耦合更容易。

巧妙的是，加载这些 Maven 设置的 IDE 会强制执行这些可见性约束。因此，您将无法在应用程序核心中引用 SQL、AXIS、JAXB 或其他任何内容

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T13:56:13.783

我认为基本技术之一是“告诉不问原则，得墨忒耳法则”。也许它不像 DI、UI 或其他设计模式，但我认为遵循这一原则的对象是松散耦合的，并且可以很好地完成一件事。

“保持害羞保持干燥告诉另一个人”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T13:58:20.300

一些与 SOA 相关的模式（例如企业服务总线）提供更高级别的抽象，并支持跨业务服务和技术服务的关注点分离。然后（可以说）通过引入将解决方案中的服务解耦的代理或总线来支持服务之间的松散耦合。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T14:24:40.043

[访客模式](http://en.wikipedia.org/wiki/Visitor_pattern)效果很好

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-22T13:43:01.250

是的，重要的是依赖注入和控制反转，但不要忘记抽象工厂和注册表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-22T14:19:47.883

桥接模式（[http://en.wikipedia.org/wiki/Bridge_pattern](http://en.wikipedia.org/wiki/Bridge_pattern)）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-22T14:33:26.047

依赖注入是控制反转的一种形式。

Spring Framework 拥有大量的 Java 程序员，它也有一个 .NET 实现。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-07T19:47:56.727

[策略模式。](http://en.wikipedia.org/wiki/Strategy_pattern)

我很惊讶这还没有被提及 - 策略允许您避免创建对域模型中不同类型了解太多的类。每个策略都负责对涉及特定类型的特定交互进行编码。这避免了创建一个主类型，它知道许多其他类型以及每个类型的实现的细微差别。

来自维基百科：

> 策略模式使用组合而不是继承。在策略模式中，行为被定义为单独的接口和实现这些接口的特定类。特定的类封装了这些接口。这允许在行为和使用该行为的类之间更好地解耦。可以在不破坏使用它的类的情况下更改行为，并且类可以通过更改使用的特定实现在行为之间切换，而无需任何重大的代码更改。行为也可以在运行时和设计时更改。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-22T14:12:35.340

依赖注入和 IOC 都非常适合解耦代码。

Dotnetrocks [show 362](http://www.dotnetrocks.com/default.aspx?showNum=362)提供了非常好的定义。还可以观看相关的 DNR 电视剧集以更清楚地了解。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-22T00:30:29.970

依赖注入是我在我编写的*几乎所有类*中使用的模式——如果类有依赖，我总是注入它（使用构造函数注入）。只有没有依赖关系的类（即值对象）不使用 DI 模式。能够测试使用 DI 的类是一个主要的好处。

有关 DI 的好处的信息，这两个演示文稿非常好： http: [//googletesting.blogspot.com/2008/11/clean-code-talks-dependency-injection.html](http://googletesting.blogspot.com/2008/11/clean-code-talks-dependency-injection.html) [http://googletesting.blogspot.com/ 2008/11/clean-code-talks-global-state-and.html](http://googletesting.blogspot.com/2008/11/clean-code-talks-global-state-and.html)

使用 DI 模式不需要 DI 容器，但是当程序变大（几十个类或许多范围）时，DI 容器可以减少很多样板。在 JVM 上，我的默认选择是[Guice](http://code.google.com/p/google-guice/)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-22T00:35:03.400

控制反转作为整体代码/架构风格。

DI 作为一种配置 IoC 的机制。

本地抽象（我称之为“理想环境开发”——写得好像你有你想要的*确切环境）。*

对象通常使用 void 方法和通过传递数据进行通信，而不是使用 getter/setter。

我从不直接在核心业务类中使用依赖项——它总是被抽象为本地抽象，并且显式桥接处理依赖项。

我发现这种组合允许非常灵活的代码具有非常组合的感觉。

# svn - TortoiseSVN 显示问号装饰器

> ID：386265
> 
> 赞同：7
> 
> 时间：2008-12-22T13:42:00.097
> 
> 标签：svn, debugging, tortoisesvn

在我的 d: 驱动器的根目录下，TortoiseSVN 显示所有文件夹上的问号装饰器。d: 驱动器不是 SVN 工作副本。如何删除装饰器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-22T13:49:47.697

TSVNCache，TortoiseSVN 用来保持这些图标更新的，并不总是正确选择哪些目录需要装饰。您可以通过以下方式限制它将考虑的目录：

*   在**TortoiseSVN|设置|外观|图标叠加**
*   在**驱动器类型**部分

    *   标记您要监控的驱动器类型。
    *   对要监视的目录使用*包含路径*
    *   对要排除的目录使用*排除路径*（很奇怪）

我只检查了**固定驱动器**。

排除路径：

```
c:\* 
```

包括路径：

```
c:\cygwin\home\me\workspaces\*
c:\dev\*
d:\development\* 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-29T17:05:03.483

您应该检查两件事。

1.  从驱动器的根目录中删除所有 .svn 文件夹。

    .svn 文件夹是隐藏的，因此您必须确保 Windows 资源管理器显示隐藏的文件和文件夹。

2.  打开命令提示符并运行以下命令。

    > > tortoiseproc /command:rebuildiconcache

如果这不能删除图标覆盖，您可能还需要重新启动。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-04T11:31:04.280

问号装饰器可以被禁用，如此处所示。

转到 Tortoise SVN >> 设置 >> 图标叠加

在驱动器类型部分

取消选中

*   固定驱动程序

并检查

*   正常显示排除的根文件夹

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T13:50:41.547

如果重新启动没有解决它（即它不是 TortoiseSVN 错误），根文件夹可能是错误创建的工作副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-20T05:44:03.753

要删除 svn sync，我们必须“取消版本”文件夹/驱动器，正确的方法如下

点击文件夹/驱动器 --> 选择TortoiseSVN --> 导出 --> 选择与当前文件夹相同的位置，将文件夹导出到自己

# javascript - 如何在 HTML 中实现“全选”复选框？

> ID：386281
> 
> 赞同：253
> 
> 时间：2008-12-22T13:50:37.290
> 
> 标签：javascript, html, checkbox, selectall

我有一个带有多个复选框的 HTML 页面。

我需要一个名为“全选”的复选框。当我选中此复选框时，必须选中 HTML 页面中的所有复选框。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2008-12-22T14:01:23.100

```
<script language="JavaScript">
function toggle(source) {
  checkboxes = document.getElementsByName('foo');
  for(var checkbox in checkboxes)
    checkbox.checked = source.checked;
}
</script>

<input type="checkbox" onClick="toggle(this)" /> Toggle All<br/>

<input type="checkbox" name="foo" value="bar1"> Bar 1<br/>
<input type="checkbox" name="foo" value="bar2"> Bar 2<br/>
<input type="checkbox" name="foo" value="bar3"> Bar 3<br/>
<input type="checkbox" name="foo" value="bar4"> Bar 4<br/> 
```

**更新：**

该`for each...in`构造似乎不起作用，至少在这种情况下，在 Safari 5 或 Chrome 5 中。此代码应该在所有浏览器中都有效：

```
function toggle(source) {
  checkboxes = document.getElementsByName('foo');
  for(var i=0, n=checkboxes.length;i<n;i++) {
    checkboxes[i].checked = source.checked;
  }
} 
```

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2010-02-03T09:50:07.053

使用[jQuery](http://jquery.com)：

```
// Listen for click on toggle checkbox
$('#select-all').click(function(event) {   
    if(this.checked) {
        // Iterate each checkbox
        $(':checkbox').each(function() {
            this.checked = true;                        
        });
    } else {
        $(':checkbox').each(function() {
            this.checked = false;                       
        });
    }
}); 
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<input type="checkbox" name="checkbox-1" id="checkbox-1" />
<input type="checkbox" name="checkbox-2" id="checkbox-2" />
<input type="checkbox" name="checkbox-3" id="checkbox-3" />

<!-- select all boxes -->
<input type="checkbox" name="select-all" id="select-all" />
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2013-03-12T01:31:22.797

我不确定是否有人没有以这种方式回答（使用[jQuery](http://jquery.com/)）：

```
 $( '#container .toggle-button' ).click( function () {
    $( '#container input[type="checkbox"]' ).prop('checked', this.checked)
  }) 
```

它很干净，没有循环或 if/else 子句，并且具有魅力。

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2012-09-04T16:47:34.793

这是一种不同的方式，更少的代码

```
$(function () {
       $('#select-all').click(function (event) {

           var selected = this.checked;
           // Iterate each checkbox
           $(':checkbox').each(function () {    this.checked = selected; });

       });
    }); 
```

* * *

## 回答 #5

> 赞同：57
> 
> 时间：2016-02-05T06:58:49.050

我很惊讶没有人提到[`document.querySelectorAll()`](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)。纯 JavaScript 解决方案，适用于 IE9+。

```
function toggle(source) {
    var checkboxes = document.querySelectorAll('input[type="checkbox"]');
    for (var i = 0; i < checkboxes.length; i++) {
        if (checkboxes[i] != source)
            checkboxes[i].checked = source.checked;
    }
}
```

```
<input type="checkbox" onclick="toggle(this);" />Check all?<br />

<input type="checkbox" />Bar 1<br />
<input type="checkbox" />Bar 2<br />
<input type="checkbox" />Bar 3<br />
<input type="checkbox" />Bar 4<br />
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2012-09-18T14:48:29.820

演示[http://jsfiddle.net/H37cb/](http://jsfiddle.net/H37cb/)

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js" /></script>

<script type="text/javascript">
$(document).ready(function(){

$('input[name="all"],input[name="title"]').bind('click', function(){
var status = $(this).is(':checked');
$('input[type="checkbox"]', $(this).parent('li')).attr('checked', status);
});

});
</script>

<div id="wrapper">
 <li style="margin-top: 20px">
  <input type="checkbox" name="all" id="all" /> <label for='all'>All</label>
  <ul>
   <li><input type="checkbox" name="title" id="title_1" /> <label for="title_1"><strong>Title 01</strong></label>
    <ul>
     <li><input type="checkbox" name="selected[]" id="box_1" value="1" /> <label for="box_1">Sub Title 01</label></li>
     <li><input type="checkbox" name="selected[]" id="box_2" value="2" /> <label for="box_2">Sub Title 02</label></li>
     <li><input type="checkbox" name="selected[]" id="box_3" value="3" /> <label for="box_3">Sub Title 03</label></li>
     <li><input type="checkbox" name="selected[]" id="box_4" value="4" /> <label for="box_4">Sub Title 04</label></li>
    </ul>
   </li>
  </ul>
  <ul>
   <li><input type="checkbox" name="title" id="title_2" /> <label for="title_2"><strong>Title 02</strong></label>
    <ul>
     <li><input type="checkbox" name="selected[]" id="box_5" value="5" /> <label for="box_5">Sub Title 05</label></li>
     <li><input type="checkbox" name="selected[]" id="box_6" value="6" /> <label for="box_6">Sub Title 06</label></li>
     <li><input type="checkbox" name="selected[]" id="box_7" value="7" /> <label for="box_7">Sub Title 07</label></li>
    </ul>
   </li>
  </ul>
 </li>
</div> 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-11-15T10:15:57.093

当你打电话时`document.getElementsByName("name")`，你会得到一个`Object`。用于`.item(index)`遍历 a 的所有项`Object`

HTML：

```
<input type="checkbox" onclick="for(c in document.getElementsByName('rfile')) document.getElementsByName('rfile').item(c).checked = this.checked">

<input type=​"checkbox" name=​"rfile" value=​"/​cgi-bin/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​includes/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​misc/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​modules/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​profiles/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​scripts/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​sites/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​stats/​">​
<input type=​"checkbox" name=​"rfile" value=​"/​themes/​">​ 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-08-01T19:02:05.320

略微更改的版本，尊重地检查和取消检查

```
$('#select-all').click(function(event) {
        var $that = $(this);
        $(':checkbox').each(function() {
            this.checked = $that.is(':checked');
        });
    }); 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-12-21T10:36:36.973

```
<html>

<head>
<script type="text/javascript">

    function do_this(){

        var checkboxes = document.getElementsByName('approve[]');
        var button = document.getElementById('toggle');

        if(button.value == 'select'){
            for (var i in checkboxes){
                checkboxes[i].checked = 'FALSE';
            }
            button.value = 'deselect'
        }else{
            for (var i in checkboxes){
                checkboxes[i].checked = '';
            }
            button.value = 'select';
        }
    }
</script>
</head>

<body>
<input type="checkbox" name="approve[]" value="1" />
<input type="checkbox" name="approve[]" value="2" />
<input type="checkbox" name="approve[]" value="3" />

<input type="button" id="toggle" value="select" onClick="do_this()" />
</body>

</html> 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-03-20T07:50:28.267

Try this simple JQuery:

```
$('#select-all').click(function(event) {
  if (this.checked) {
    $(':checkbox').prop('checked', true);
  } else {
    $(':checkbox').prop('checked', false);
  }
}); 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2016-05-05T16:15:43.950

我的简单解决方案允许有选择地选择/取消选择**表单给定部分中的**所有复选框，同时为每个复选框使用**不同的名称**，以便在表单发布后可以轻松识别它们。

Javascript：

```
function setAllCheckboxes(divId, sourceCheckbox) {
    divElement = document.getElementById(divId);
    inputElements = divElement.getElementsByTagName('input');
    for (i = 0; i < inputElements.length; i++) {
        if (inputElements[i].type != 'checkbox')
            continue;
        inputElements[i].checked = sourceCheckbox.checked;
    }
} 
```

HTML 示例：

```
<p><input onClick="setAllCheckboxes('actors', this);" type="checkbox" />All of them</p>
<div id="actors">
    <p><input type="checkbox" name="kevin" />Spacey, Kevin</p>
    <p><input type="checkbox" name="colin" />Firth, Colin</p>
    <p><input type="checkbox" name="scarlett" />Johansson, Scarlett</p>
</div> 
```

我希望你喜欢它！

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2016-04-15T02:24:36.897

此示例适用于复选框变量名称不同的原生 JavaScript，即并非全是“foo”。

```
<!DOCTYPE html>
<html>
<body>

<p>Toggling checkboxes</p>
<script>
function getcheckboxes() {
    var node_list = document.getElementsByTagName('input');
    var checkboxes = [];
    for (var i = 0; i < node_list.length; i++) 
    {
        var node = node_list[i];
        if (node.getAttribute('type') == 'checkbox') 
        {
            checkboxes.push(node);
        }
    } 
    return checkboxes;
}
function toggle(source) {
    checkboxes = getcheckboxes();
    for (var i = 0 n = checkboxes.length; i < n; i++) 
    {
        checkboxes[i].checked = source.checked;
    }
}
</script>    

<input type="checkbox" name="foo1" value="bar1"> Bar 1<br/>
<input type="checkbox" name="foo2" value="bar2"> Bar 2<br/>
<input type="checkbox" name="foo3" value="bar3"> Bar 3<br/>
<input type="checkbox" name="foo4" value="bar4"> Bar 4<br/>

<input type="checkbox" onClick="toggle(this)" /> Toggle All<br/>

</body>
</html> 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2008-12-22T13:56:13.783

JavaScript 是你最好的选择。下面的链接给出了一个使用按钮取消/全选的示例。您可以尝试将其调整为使用复选框，只需使用“全选”复选框的 onClick 属性即可。

[用于检查或取消选中所有复选框的 Javascript 函数](http://www.somacon.com/p117.php)

这个页面有一个更简单的例子

[http://www.htmlcodetutorial.com/forms/_INPUT_onClick.html](http://www.htmlcodetutorial.com/forms/_INPUT_onClick.html)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2011-07-06T11:45:51.330

如果采用 jQuery 的最佳答案，请记住传递给 click 函数的对象是 EventHandler，而不是原始的复选框对象。因此代码应修改如下。

HTML

```
<input type="checkbox" name="selectThemAll"/> Toggle All<br/>

<input type="checkbox" name="foo" value="bar1"> Bar 1<br/>
<input type="checkbox" name="foo" value="bar2"> Bar 2<br/>
<input type="checkbox" name="foo" value="bar3"> Bar 3<br/>
<input type="checkbox" name="foo" value="bar4"> Bar 4<br/> 
```

Javascript

```
$(function() {
    jQuery("[name=selectThemAll]").click(function(source) { 
        checkboxes = jQuery("[name=foo]");
        for(var i in checkboxes){
            checkboxes[i].checked = source.target.checked;
        }
    });
}) 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2012-05-09T11:03:21.957

```
<asp:CheckBox ID="CheckBox1" runat="server" Text="Select All" onclick="checkAll(this);" />
<br />
<asp:CheckBoxList ID="CheckBoxList1" runat="server">
    <asp:ListItem Value="Item 1">Item 1</asp:ListItem>
    <asp:ListItem Value="Item 2">Item 2</asp:ListItem>
    <asp:ListItem Value="Item 3">Item 3</asp:ListItem>
    <asp:ListItem Value="Item 4">Item 4</asp:ListItem>
    <asp:ListItem Value="Item 5">Item 5</asp:ListItem>
    <asp:ListItem Value="Item 6">Item 6</asp:ListItem>
</asp:CheckBoxList>

<script type="text/javascript">
    function checkAll(obj1) {
        var checkboxCollection = document.getElementById('<%=CheckBoxList1.ClientID %>').getElementsByTagName('input');

        for (var i = 0; i < checkboxCollection.length; i++) {
            if (checkboxCollection[i].type.toString().toLowerCase() == "checkbox") {
                checkboxCollection[i].checked = obj1.checked;
            }
        }
    }
</script> 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-02-26T15:11:49.697

那应该完成工作：

```
 $(':checkbox').each(function() {
        this.checked = true;                        
    }); 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2017-10-12T20:21:05.567

您可能**在同一个表单上有不同的复选框集**。**这是一个使用vanilla javascript函数document.getElementsByClassName**按类名选择/取消选择复选框的解决方案

 **全选按钮

```
<input type='checkbox' id='select_all_invoices' onclick="selectAll()"> Select All 
```

一些要选择的复选框

```
<input type='checkbox' class='check_invoice' id='check_123' name='check_123' value='321' />
<input type='checkbox' class='check_invoice' id='check_456' name='check_456' value='852' /> 
```

javascript

```
 function selectAll() {
        var blnChecked = document.getElementById("select_all_invoices").checked;
        var check_invoices = document.getElementsByClassName("check_invoice");
        var intLength = check_invoices.length;
        for(var i = 0; i < intLength; i++) {
            var check_invoice = check_invoices[i];
            check_invoice.checked = blnChecked;
        }
    } 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2019-03-22T12:38:02.773

由于我无法评论，这里作为答案：我会以更通用的方式编写 Can Berk Güder 的解决方案，因此您可以将该功能重用于其他复选框

```
<script language="JavaScript">
  function toggleCheckboxes(source, cbName) {
    checkboxes = document.getElementsByName(cbName);
    for (var i = 0, n = checkboxes.length; i < n; i++) {
      checkboxes[i].checked = source.checked;
    }
  }
</script> 
```

```
<input type="checkbox" onClick="toggleCheckboxes(this,\'foo\')" /> Toggle All<br/>

<input type="checkbox" name="foo" value="bar1"> Bar 1<br/>
<input type="checkbox" name="foo" value="bar2"> Bar 2<br/>
<input type="checkbox" name="foo" value="bar3"> Bar 3<br/>
<input type="checkbox" name="foo" value="bar4"> Bar 4<br/>
<input type="checkbox" name="foo" value="bar5"> Bar 5<br/> 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-07-19T06:59:13.583

这就是这样做的，例如，如果您有 5 个复选框，然后单击全选，它全选，现在如果您取消选中所有复选框，可能通过单击每 5 个复选框，当您取消选中最后一个复选框时，选择所有复选框也未选中

```
$("#select-all").change(function(){
   $(".allcheckbox").prop("checked", $(this).prop("checked"))
  })
  $(".allcheckbox").change(function(){
      if($(this).prop("checked") == false){
          $("#select-all").prop("checked", false)
      }
      if($(".allcheckbox:checked").length == $(".allcheckbox").length){
          $("#select-all").prop("checked", true)
      }
  }) 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-11-09T10:28:25.527

```
$(document).ready(function() {
                $(document).on(' change', 'input[name="check_all"]', function() {
                    $('.cb').prop("checked", this.checked);
                });
            }); 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2015-08-31T17:45:21.853

使用 jQuery 和淘汰赛：

使用此绑定主复选框与底层复选框保持同步，除非选中所有复选框，否则它将被取消选中。

```
ko.bindingHandlers.allChecked = {
  init: function (element, valueAccessor) {
    var selector = valueAccessor();

    function getChecked () {
      element.checked = $(selector).toArray().every(function (checkbox) {
        return checkbox.checked;
      });
    }

    function setChecked (value) {
      $(selector).toArray().forEach(function (checkbox) {
        if (checkbox.checked !== value) {
          checkbox.click();
        }
      });
    }

    ko.utils.registerEventHandler(element, 'click', function (event) {
      setChecked(event.target.checked);
    });

    $(window.document).on('change', selector, getChecked);

    ko.utils.domNodeDisposal.addDisposeCallback(element, () => {
      $(window.document).off('change', selector, getChecked);
    });

    getChecked();
  }
}; 
```

在 html 中：

```
<input id="check-all-values" type="checkbox" data-bind="allChecked: '.checkValue'"/>
<input id="check-1" type="checkbox" class="checkValue"/>
<input id="check-2" type="checkbox" class="checkValue"/> 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2020-03-02T16:03:45.927

以下方法非常容易理解，您可以在几分钟内实现现有表单

> 使用 Jquery，

```
$(document).ready(function() {
  $('#check-all').click(function(){
    $("input:checkbox").attr('checked', true);
  });
  $('#uncheck-all').click(function(){
    $("input:checkbox").attr('checked', false);
  });
}); 
```

以 HTML 形式放在按钮下方

```
<a id="check-all" href="javascript:void(0);">check all</a>
<a id="uncheck-all" href="javascript:void(0);">uncheck all</a> 
```

> 只需使用javascript，

```
<script type="text/javascript">
function checkAll(formname, checktoggle)
{
  var checkboxes = new Array(); 
  checkboxes = document[formname].getElementsByTagName('input');

  for (var i=0; i<checkboxes.length; i++)  {
    if (checkboxes[i].type == 'checkbox')   {
      checkboxes[i].checked = checktoggle;
    }
  }
}
</script> 
```

以 HTML 形式放在按钮下方

```
<button onclick="javascript:checkAll('form3', true);" href="javascript:void();">check all</button>

<button onclick="javascript:checkAll('form3', false);" href="javascript:void();">uncheck all</button> 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-02-14T16:58:13.940

html

```
<input class='all' type='checkbox'> All
<input class='item' type='checkbox' value='1'> 1
<input class='item' type='checkbox' value='2'> 2
<input class='item' type='checkbox' value='3'> 3 
```

javascript

```
$(':checkbox.all').change(function(){
  $(':checkbox.item').prop('checked', this.checked);
}); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-02-14T21:04:55.893

您可以使用此代码。

```
var checkbox = document.getElementById("dlCheckAll4Delete");
checkbox.addEventListener("click", function (event) {
  let checkboxes = document.querySelectorAll(".dlMultiDelete");
  checkboxes.forEach(function (ele) {
    ele.checked = !!checkbox.checked;
  });
}); 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2022-01-21T03:10:10.490

这很简单：

```
const selectAllCheckboxes = () => {
  const checkboxes = document.querySelectorAll('input[type=checkbox]');
  checkboxes.forEach((cb) => { cb.checked = true; });
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-03-20T11:39:33.770

1：添加**onchange**事件Handler

```
<th><INPUT type="checkbox" onchange="checkAll(this)" name="chk[]" /> </th> 
```

2：修改代码以处理选中/未选中

```
 function checkAll(ele) {
     var checkboxes = document.getElementsByTagName('input');
     if (ele.checked) {
         for (var i = 0; i < checkboxes.length; i++) {
             if (checkboxes[i].type == 'checkbox') {
                 checkboxes[i].checked = true;
             }
         }
     } else {
         for (var i = 0; i < checkboxes.length; i++) {
             console.log(i)
             if (checkboxes[i].type == 'checkbox') {
                 checkboxes[i].checked = false;
             }
         }
     }
 } 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-09-12T05:52:12.697

这是一个backbone.js 实现：

```
events: {
    "click #toggleChecked" : "toggleChecked"
},
toggleChecked: function(event) {

    var checkboxes = document.getElementsByName('options');
    for(var i=0; i<checkboxes.length; i++) {
        checkboxes[i].checked = event.currentTarget.checked;
    }

}, 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-04-26T15:48:35.893

使用 jQuery 制作简写版本

全选复选框

```
<input type="checkbox" id="chkSelectAll"> 
```

子复选框

```
<input type="checkbox" class="chkDel">
<input type="checkbox" class="chkDel">
<input type="checkbox" class="chkDel"> 
```

jQuery

```
$("#chkSelectAll").on('click', function(){
     this.checked ? $(".chkDel").prop("checked",true) : $(".chkDel").prop("checked",false);  
}) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-06-14T20:42:03.043

也许有点晚了，但是在处理选中所有复选框时，我相信您还应该处理选中选中所有复选框，然后取消选中下面的复选框之一的情况。

在这种情况下，它应该自动取消选中所有复选框。

此外，当手动检查所有复选框时，您最终应该会自动选中检查所有复选框。

您需要两个事件处理程序，一个用于选中所有框，一个用于单击下面的任何单个框。

```
// HANDLES THE INDIVIDUAL CHECKBOX CLICKS
function client_onclick() {
    var selectAllChecked = $("#chk-clients-all").prop("checked");

    // IF CHECK ALL IS CHECKED, AND YOU'RE UNCHECKING AN INDIVIDUAL BOX, JUST UNCHECK THE CHECK ALL CHECKBOX.
    if (selectAllChecked && $(this).prop("checked") == false) {
        $("#chk-clients-all").prop("checked", false);
    } else { // OTHERWISE WE NEED TO LOOP THROUGH INDIVIDUAL CHECKBOXES AND SEE IF THEY ARE ALL CHECKED, THEN CHECK THE SELECT ALL CHECKBOX ACCORDINGLY.
        var allChecked = true;
        $(".client").each(function () {
            allChecked = $(this).prop("checked");
            if (!allChecked) {
                return false;
            }
        });
        $("#chk-clients-all").prop("checked", allChecked);
    }
}

// HANDLES THE TOP CHECK ALL CHECKBOX
function client_all_onclick() {
    $(".client").prop("checked", $(this).prop("checked"));
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-11-09T17:10:55.663

您可以使用这个简单的代码

```
$('.checkall').click(function(){
    var checked = $(this).prop('checked');
    $('.checkme').prop('checked', checked);
}); 
```

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2016-10-06T14:44:42.450

*简单明了：*

jQuery - 单击按钮或 div 或标签元素时。选中页面上的所有复选框。请记住，您必须调整 :checkbox 以使其更具体。

```
jQuery("#My-Button").click(function() {

  jQuery(':checkbox').each(function() {
    if(this.checked == true) {
      this.checked = false;                        
    } else {
      this.checked = true;                        
    }      
  });

}); 
```

# web-services - 网络服务属性

> ID：386286
> 
> 赞同：1
> 
> 时间：2008-12-22T13:52:31.327
> 
> 标签：web-services, wsdl

我正在创建一个在 WSDL 文件中生成以下内容的 Web 服务：

```
<wsdl:portType name="myServicePortSoap"> 
```

并希望将其重命名以生成：

```
<wsdl:portType name="myServicePort"> 
```

如何在 .asmx 文件中执行此操作？请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T14:51:30.083

显然，在 WebServiceBinding 属性中指定 Name 参数应该会影响这一点，但我看不到 WSDL 中的变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T09:44:54.147

我还没有在.NET 2.0 中找到任何方法来做到这一点。但是，这可能要归功于 WCF 扩展...查看以下链接：

[http://blogs.msdn.com/trobbins/archive/2007/02/04/wcf-and-wsdl.aspx](http://blogs.msdn.com/trobbins/archive/2007/02/04/wcf-and-wsdl.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T14:51:07.027

.asmx？我假设您正在使用 ASP.NET 来自动生成您的 WSDL？

我不确定您将如何覆盖端口标识符，或者您为什么要这样做；也许您正在寻找[别名您的 Web 方法](http://msdn.microsoft.com/en-us/library/byxd99hx(VS.71).aspx#vbtskusingwebmethodattributemessagename)？

# validation - 有效电子邮件地址的最大长度是多少？

> ID：386294
> 
> 赞同：1138
> 
> 时间：2008-12-22T13:57:54.060
> 
> 标签：validation, email, max, email-address

有效电子邮件地址的最大长度是多少？它是由任何标准定义的吗？

* * *

## 回答 #1

> 赞同：1354
> 
> 时间：2009-02-22T10:28:47.640

电子邮件地址不得超过**254 个**字符。

[这在提交](http://www.rfc-editor.org/errata_search.php?rfc=3696&eid=1690)的勘误表后被 IETF 接受。任何给定地址的完整诊断都可以[在线](http://isemail.info/)获得。RFC 3696 的原始版本将 320 描述为最大长度，但 John Klensin 随后接受了一个不正确的值，因为路径被定义为

```
Path = "<" [ A-d-l ":" ] Mailbox ">" 
```

因此邮箱元素（即电子邮件地址）周围有尖括号以形成路径，路径的最大长度为 254 个字符，以将路径长度限制为 256 个字符或更少。

[RFC 5321](https://www.rfc-editor.org/rfc/rfc5321#section-4.5.3)中规定的最大长度：

> 反向路径或正向路径的最大总长度为 256 个字符。

RFC 3696 已[在此处](http://www.rfc-editor.org/errata_search.php?rfc=3696)更正。

人们应该特别注意[针对 RFC 3696 的勘误表](http://www.rfc-editor.org/errata_search.php?rfc=3696)。其中三个规范示例实际上是无效地址。

我整理了几百个测试地址，您可以在[http://www.dominicsayers.com/isemail找到这些地址](http://www.dominicsayers.com/isemail)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-12-22T14:00:51.153

320

段看起来像这样

{64}@{255}

64 + 1 + 255 = 320

如果您正在验证电子邮件，您还应该阅读此内容：[在阅读 RFC 之前，我知道如何验证电子邮件地址](https://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx/)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-01-29T11:50:21.583

> **用户**
> 
> 用户名的最大总长度为 64 个字符。
> 
> **领域**
> 
> 域部分最多 255 个字符（“@”后面的那个）

**但是，[RFC 2821](https://www.ietf.org/rfc/rfc2821.txt)的阅读有一个限制：**

> 反向路径或正向路径的最大总长度为 256 个字符，包括标点符号和元素分隔符”。由于不适合这些字段的地址通常没有用，因此地址长度的上限通常应视为 256，但路径定义为：Path = “<” [ Adl “:” ] Mailbox “>” 除了 Mailbox 之外，转发路径将至少包含一对尖括号，这将电子邮件地址限制为 254 个字符。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2017-06-01T21:58:57.803

为了帮助像我这样困惑的新手，回答“有效电子邮件地址的最大长度是多少？” 是**254 个字符**。

如果您的应用程序使用电子邮件，只需将您的字段设置为接受 254 个字符或更少，就可以了。

您可以在电子邮件上运行一堆测试，看看它在此处是否有效。[http://isemail.info/](http://isemail.info/)

RFC 或 Request for Comments 是 Internet 工程任务组 (IETF) 的一种发布类型，将 254 个字符定义为限制。位于此处 - [https://www.rfc-editor.org/rfc/rfc5321#section-4.5.3](https://www.rfc-editor.org/rfc/rfc5321#section-4.5.3)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2018-04-04T07:27:04.583

根据下面的文章：

[https://www.rfc-editor.org/rfc/rfc3696](https://www.rfc-editor.org/rfc/rfc3696)（第 6 页，[第 3 节](https://www.rfc-editor.org/rfc/rfc3696#section-3)）

提到：

> “电子邮件地址有长度限制。该限制是“本地部分”（“@”之前）中最多 64 个字符（八位字节）和域部分（在“@”），总长度为 320 个字符。处理电子邮件的系统应该准备好处理这么长的地址，即使它们很少遇到。

因此，电子邮件地址的最大总长度为 320 个字符（“本地部分”：64 + “@”：1 + “域部分”：255，总和为 320）

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2018-04-12T20:14:22.743

另一个答案使水有点混浊。 **简单的答案：我们控制的电子邮件 256 中共有 254 个字符** 用于整个电子邮件地址，其中包括开头的隐含“<”和结尾的“>”。因此，剩下 254 个供我们使用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-02-13T17:21:44.320

### TLDR 答案

给定一个电子邮件地址，例如...

```
me@example.com 
```

长度限制如下：

*   整个电子邮件地址（又名：*“路径”*）：即*me@example.com* --`256`最多字符数。
*   Local-Part：即*我*——`64`字符最大值。
*   域：即*example.com——*`254`最多字符数。

### 来源——TLDR；

RFC 标准在不断发展，但如果您想在一行中获取 2009 IETF 源代码：

> ...地址长度的上限通常应被视为 256。（来源：*[RFC3696](https://www.rfc-editor.org/errata_search.php?rfc=3696&eid=1690)*。）

### 来源——历史

SMTP 最初在[RFC821](https://www.rfc-editor.org/rfc/rfc821)中定义了路径是什么，发布于 1982 年 8 月，这是[一个官方 Internet 标准](https://en.wikipedia.org/wiki/Internet_Standard#:%7E:text=The%20IETF%20also%20defines%20a,prior%20to%20an%20Internet%20Standard.)（大多数 RFC 只是提议）。引用它...

> ...一个反向路径，指定邮件来自谁。
> 
> ...一个转发路径，它指定邮件的收件人。

[RFC2821](https://www.rfc-editor.org/rfc/rfc2821)于 2001 年 4 月发布，是已过时的标准，它定义了我们当前的本地部分、域和路径的最大值。2008 年 10 月发布的新标准草案[RFC5321](https://www.rfc-editor.org/rfc/rfc5321)保持相同的限制。在这两个日期之间，[RFC3696](https://www.rfc-editor.org/rfc/rfc3696)于 2004 年 2 月发布。它错误地将最大电子邮件地址限制引用为`320`-characters，但此文档仅是“信息性”，并指出：“此备忘录为 Internet 社区提供信息。它确实不指定任何类型的互联网标准。” 所以，我们可以无视。

引用 RFC2821，即 RFC5321 中确认的现代、公认标准...

> **4.5.3.1.1。局部**
> 
> 用户名或其他本地部分的最大总长度为 64 个字符。
> 
> **4.5.3.1.2。领域**
> 
> 域名或号码的最大总长度为 255 个字符。
> 
> **4.5.3.1.3。小路**
> 
> 反向路径或正向路径的最大总长度为 256 个字符（包括标点符号和元素分隔符）。

您会注意到，我指出域最大值为 254，而 RFC 指出域最大值为 255。这是一个简单的算术问题。一个 255 个字符的域，加上“@”符号，就是一个 256 个字符的路径，这是最大路径长度。但是，空名称或空白名称是无效的，因此域实际上最多有 254 个。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-05-06T12:22:29.913

可悲的是，所有其他答案都是错误的。他们中的大多数都引用了 RFC 2821 或更高版本，甚至没有定义电子邮件地址。它所做的是定义*路径*。电子邮件地址由 RFC 2822（或更新版本）定义，并且可以更长。不是有效路径的有效地址示例如下：

```
(Firstname Lastname) user@domain
Firstname Lastname <user@domain> 
```

这两个都是同一个邮箱，写法不同。因此，如果您的目标是将电子邮件地址存储在数据库中，则 254、256 或 320 个八位字节的限制可能太低，尽管在实践中，这很少会成为问题。

# c++ - 如何修复内存访问错误

> ID：386304
> 
> 赞同：0
> 
> 时间：2008-12-22T14:01:47.827
> 
> 标签：c++, memory, solaris

我正在做一个迁移项目，在这里我们正在将大量 C++ 库从 Mainframe 迁移到 Solaris。我们已成功完成迁移，但在运行应用程序时，某些地方会因“信号 SEGV（故障地址无映射）”而崩溃。

由于该应用程序也支持 Windows，因此我们在 Windows 上检查了 purify。应用程序中没有内存泄漏，并且在 Windows 上运行良好。

任何人都可以建议，可能导致此类错误的其他原因是什么。有什么工具可以追踪这类错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T14:06:08.270

这不一定是内存泄漏。可能是在释放*后*引用了一块内存。

我的朋友曾经带着一段在 Windows 上运行良好但在 Linux 上提供 segv 的代码来找我。事实证明，有时内存在 Windows 上释放后仍然有效（可能在短时间内），但在 Linux 上立即触发了 segv。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T15:40:20.797

下面的行对我来说看起来不对

> ```
> m_BindMap[sLabel] = b;   // crashes at this line at when map size 
> ```

我假设您正在尝试在字符串末尾添加一个数字。试试这个

```
stringstream ss;
ss << ":BIND" << ns;
string sLabel = ss.str(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T14:03:53.503

你用的是g++吗？如果是这样，请使用“-g”标志重新编译。在 gdb 中运行程序。当它崩溃时输入“bt”（用于回溯），这应该告诉你问题出在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T14:09:17.157

我在 solaris 和 dbx 调试器上使用 CC 编译器。我知道它崩溃的调用堆栈。但这是非正常的崩溃。

```
map<string,CDBBindParam,less<string> >m_BindMap;

CNumString ns(CNumStringTraits(0,2,'0'));
ns = m_BindMap.size();
string sLabel = ":BIND"+ns;
CDBBindParam b(sLabel,val);
**m_BindMap[sLabel] = b;**   // crashes at this line at when map size is more than 2
return sLabel; 
```

# database - 访问：如何在整个数据库中查找字段？

> ID：386307
> 
> 赞同：4
> 
> 时间：2008-12-22T14:03:07.700
> 
> 标签：database, ms-access

我有一个包含许多表的访问数据库。我正在寻找一个或多个表中可能存在或不存在的字段。如何检查它是否存在？（当然不查询每个表）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T16:01:02.797

字段有一个模式：

```
Set cn = CurrentProject.Connection

SelectFieldName = "SomeFieldName" 

'Get names of all tables that have a column = SelectFieldName '
Set rs = cn.OpenSchema(adSchemaColumns, _
Array(Empty, Empty, Empty, SelectFieldName)) 
```

来自：[MS Access：如何绕过/抑制错误？](https://stackoverflow.com/questions/277340/ms-access-how-to-bypasssuppress-an-error#277612)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T07:01:23.213

如果你*真的*不想打开任何表，一个解决方案是使用`tabledefs`数据库对象的集合。每个`tabledef`项目都有自己的`fields`收藏，您可以浏览。它会给出类似的东西：

```
Public function findFieldInDatabase(p_myFieldName)
    dim db as database, _
        tb as tabledef, _
        fd as field

    set db = currentDb
    for each tb in db.tabledefs
        for each fd in tb.fields
            if fd.name = p_myFieldName then
                debug.print tb.name, fd.name
            end if
        next fd
    next tb
    set fd = nothing
    set tb = nothing
    set db = nothing
end function 
```

此代码可以很容易地适应接受一个可选`p_myTableName`参数作为参数，以将搜索限制在一个表/表范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T16:13:17.453

如果我想查看特定表中的特定列（在 strSearch 中标识）是否存在，我会执行以下操作。

```
Public Sub search()

Dim db As Database
Dim strSearch As String
Dim strSQL As String
Dim rsResults As Recordset
Dim i As Integer
Dim cols As Integer

    strSearch = "a3"

    Set db = CurrentDb
    strSQL = "select * from bar"
    Set rsResults = db.OpenRecordset(strSQL, dbOpenDynaset, dbReadOnly)
    If Not rsResults.BOF Then
        rsResults.MoveFirst
    End If

    cols = rsResults.Fields.Count - 1 ' -1 because we start counting cols at 0
    For i = 0 To cols
        If rsResults(i).Name = strSearch Then
            MsgBox "Found the seach string"
        End If
    Next
    MsgBox "end of script"

End Sub 
```

现在我知道你不想为每张桌子写一个。所以接下来要做的就是遍历所有的表。您可以使用以下 SQL 找到所有表的列表

```
SELECT 
    name
FROM 
    MSysObjects 
WHERE 
    (Left([Name],1)<>"~") 
    AND (Left([Name],4) <> "MSys") 
    AND ([Type] In (1, 4, 6)) 
```

将这两部分连接在一起，我将留给学生作为练习:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T14:26:41.833

以下是使用 VBScript 在 MS Access 中访问表架构的方法：

```
TestData = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=c:\somefolder\YOURDB.mdb"
Set Conn = Server.CreateObject("ADODB.Connection")
Conn.Open TestData

Set rs = Conn.OpenSchema(4)

do until Rs.eof
    tn = RS("TABLE_NAME")
    fn = RS("COLUMN_NAME")
    ' your script goes here
loop 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T16:31:49.723

干得好：

```
Public Function fTableExists(ByVal vstrTable As String) As Boolean
    Dim rs As ADODB.Recordset
    Set rs = CurrentProject.Connection.OpenSchema( _
           adschematables, Array(Empty, Empty, vstrTable))
    fTableExists = Not rs.EOF
    rs.Close
    Set rs = Nothing
End Function

Public Function fColumnExists(ByVal vstrTable As String, _
                              ByVal vstrColumn As String) As Boolean
    Dim rs As ADODB.Recordset
    Set rs = CurrentProject.Connection.OpenSchema(adSchemaColumns, _
      Array(Empty, Empty, vstrTable, vstrColumn))
    fColumnExists = Not rs.EOF
    rs.Close
    Set rs = Nothing
End Function 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-22T14:11:01.973

MSSQL 寻找 ADDRESS1 列：从 sysobjects 中选择 so.name so where so.id in (select sc.id from syscolumns sc where name like 'ADDRESS1')

ORACLE [http://en.wikipedia.org/wiki/Oracle_metadata](http://en.wikipedia.org/wiki/Oracle_metadata)

谷歌会找到其他数据库的语法......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-22T14:11:44.967

它是什么类型的数据库？如果是 SQL Server，你可以试试这个：

```
SELECT * FROM sysobjects WHERE xtype = 'U' AND name = 'myTable' 
```

但由于它是您要查找的列而不是表（感谢 Brian），请尝试以下操作：

```
SELECT 
    DISTINCT
    so.[name] AS 'Table',
    sc.[name] AS 'Column' 
    FROM 
        syscolumns sc
    JOIN
        sysobjects so
        ON
            so.id = sc.id
    WHERE 
        sc.[name] = 'myTable' 
```

# nhibernate - 如何为 NHibernate 创建 OR 语句？

> ID：386308
> 
> 赞同：24
> 
> 时间：2008-12-22T14:03:33.767
> 
> 标签：nhibernate

为 NHibernate 创建标准时，所有标准都添加为`AND`.

例如：

```
session.CreateCriteria(typeof(someobject))
.Add(critiera)
.Add(other_criteria) 
```

那么最终结果将是

```
SELECT ...
FROM ...
WHERE criteria **AND** other_criteria 
```

我想告诉 NHibernate 将标准添加为“或”

```
SELECT ...
FROM ...
 WHERE criteria **OR** other_criteria 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-22T14:15:47.550

您正在寻找`Conjunction`and`Disjunction`类，这些可用于组合各种语句以形成 OR 和 AND 语句。

**和**

```
.Add(
  Expression.Conjunction()
    .Add(criteria)
    .Add(other_criteria)
) 
```

**或者**

```
.Add(
  Expression.Disjunction()
    .Add(criteria)
    .Add(other_criteria)
) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-09T13:23:19.930

采用`Restrictions.Disjunction()`

```
 var re1 = Restrictions.Eq(prop1, prop_value1);
        var re2 = Restrictions.Eq(prop2, prop_value2);
        var re3 = Restrictions.Eq(prop3, prop_value3);

        var or = Restrictions.Disjunction();
        or.Add(re1).Add(re2).Add(re3);

        criteria.Add(or); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T14:13:14.700

您可以使用`Restrictions.or`，这样：

```
session.CreateCriteria(typeof(someobject))
    .Add(critiera)
    .Add(other_criteria); 
```

在哪里：

```
other_criteria = Restrictions.or("property", "value"); 
```

[您可以在 Hibernate](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Criteria.html#add(org.hibernate.criterion.Criterion))的 Criteria Interface 文档中了解更多相关信息，该文档与 NHibernate 相同。

# artificial-intelligence - 您想解决哪些优化问题？

> ID：386309
> 
> 赞同：7
> 
> 时间：2008-12-22T14:03:44.390
> 
> 标签：artificial-intelligence, mathematical-optimization

我喜欢研究 AI 优化软件（遗传算法、粒子群、蚁群等）。不幸的是，我已经用完了有趣的问题要解决。你想解决什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-22T14:13:49.567

这份[NP 完全问题列表](http://en.wikipedia.org/wiki/List_of_NP-complete_problems)应该会让你忙一阵子……

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T14:23:44.197

[哈特奖](http://prize.hutter1.net/)怎么样？

从维基百科上的[条目](http://en.wikipedia.org/wiki/Hutter_Prize)：

> Hutter 奖是由 Marcus Hutter 资助的现金奖励，用于奖励对特定 100 MB 英文文本文件的数据压缩改进。[...]
> 
> 哈特奖的目标是鼓励人工智能 (AI) 的研究。组织者认为，文本压缩和 AI 是等价的问题。

基本上，这个想法是，为了制造能够最有效地压缩数据的压缩器，用 Marcus Hutter 的话来说，压缩器必须“更智能”。有关人工智能与压缩之间关系的更多信息，请参阅 Hutter Prize 网站的[动机](http://prize.hutter1.net/#motiv)和[常见问题解答](http://prize.hutter1.net/hfaq.htm)部分。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T14:07:31.153

[Netflix 奖](http://www.netflixprize.com/)算不算？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-22T14:20:16.307

我希望我的银行余额得到优化，以便在月底有尽可能多的钱，而不是相反。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T14:11:12.100

[围棋游戏](http://en.wikipedia.org/wiki/Computer_Go)怎么样？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T14:35:29.383

这是我在修补颜色量化和图像压缩时遇到的一个有趣的实际问题。

基本想法是我想要一个程序，我给它一张图片，它会尽可能地减少颜色的数量，而我不会注意到它。由于每个人对眼睛的敏感度不同（并且眼睛对红/绿/蓝强度的敏感度不同），因此应该可以通过某种方式指定此敏感度阈值。

换句话说，在真彩色图片中，将每个像素的颜色替换为另一种颜色，这样：

*   图片中不同颜色的总数将尽可能少；和
*   每个新像素的颜色与原始颜色的距离不会超过某个用户指定的值 D。

D可以用不同的方式定义，选择你喜欢的。例如：

*   分离红色、绿色和蓝色分量，以指定每个分量的最大可能偏差（对于每个像素，您都会得到一个包含有效替换值的矩形立方体）；
*   一个实数，表示 RGB 立方体中的最大允许距离（对于每个像素，您都会获得一个有效替换值的球体）；
*   介于两者之间或完全不同的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T14:37:52.980

一组给定数独谜题的最有效解决方案。（不包括蛮力方法）

# google-maps - 计算经度/纬度

> ID：386311
> 
> 赞同：8
> 
> 时间：2008-12-22T14:03:59.867
> 
> 标签：google-maps, geolocation, maps, geocoding, yahoo-maps

给定以下输入：

*   1..n 个位置的已知经度/纬度
*   位置 1..n 和另一个位置“m”之间的已知距离

如何计算位置“m”的经度/纬度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T14:14:56.583

这听起来像是一个基本的经纬三角测量问题。Yahoo! 中概述了常用方法。答案主题[在这里](http://answers.yahoo.com/question/index?qid=20080613183749AAfjbPr)。可能有许多图书馆可以使用多种语言来执行此操作。谷歌搜索“纬度经度三角测量”加上您选择的语言可能会显示一些现有的代码来使用。“地理编码”是类似库中的另一个常见任务，因此这可能是另一个有用的关键字。

编辑：正如其他人所提到的，“三边测量”似乎是最好的术语。但是，根据您的数据和要求，有更简单的近似解决方案可以满足您的要求。

雅虎！为方便起见，下面引用了答案帖子：

> “对于较大的距离，球面几何。对于相对较小的距离，将地球视为平面，将坐标视为 xy 坐标。对于与坐标度数一起使用的距离，您必须使用余弦函数从一转换（虽然整个地球的纬度约为 69 英里，但经度从赤道的相同到两极的 0 不等。）
> 
> 你有三个圆的中心点和这些圆的半径。它们应该在一个点相交，因此您可以成对处理它们以找到每个交叉点并丢弃不匹配的点 [http://mathworld.wolfram.com/Circle-CircleIntersection.html](http://mathworld.wolfram.com/Circle-CircleIntersection.html)。” ([麦克1942f](http://answers.yahoo.com/my/profile;_ylt=AlkukbjBaS6S7pvcVoxSIFD.xQt.;_ylv=3?show=9adfd40573a5f8454356f9c074106d83aa) )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T14:14:43.700

[三边测量](http://en.wikipedia.org/wiki/Trilateration)是你想要的。这只需要您的 3 个参考点，但是如果您想变得非常聪明，其余的可以用来提高准确性。

最棘手的部分是使用长/纬度而不是笛卡尔坐标，特别是因为地球不是一个完美的球体。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T14:15:08.597

这是一个[三边测量](http://en.wikipedia.org/wiki/Trilateration)问题。在您的情况下，您有多个参考点，因此您可以最小化给定距离与对应于 m 的最佳位置的距离之间的平方误差之和。

# architecture - 改变我们的 BL 设计——哪种模式最有用？

> ID：386315
> 
> 赞同：3
> 
> 时间：2008-12-22T14:07:05.913
> 
> 标签：architecture, design-patterns

我正在重构我们的 BI 层以使我们的代码更加“松散耦合”，我很想听听你们认为可能会做出哪些有趣的改进？

目前，我们的 API 如下所示：-

```
// Fetch a collection of objects
ProductCollection prods = Product.GetProducts();

// Load an individual object, make change and save it back
Product p = new Product();
if(p.Load(productID))
{
    p.Name = "New Name";
    p.Save();
} 
```

如您所见，我们用于获取对象集合/加载单个对象和保存更改的方法都内置在“模型”类中。我们的每个模型类都继承自 ObjectBase 基类，该基类包括 DB 访问功能和更改跟踪，因此当有人通过属性更改值时，对象会自动标记为脏，并向订阅了这些事件的任何对象 (UI) 触发通知。

我想做的是使用“存储库模式”，以便我们可以将数据库实现从模型中抽象出来。但是，我一直在查看的大部分代码似乎都表明“模型”类不应该包含任何智能，而应该只是数据的容器。相反，应该通过使用服务来应用逻辑。那么这是否意味着完成上述我需要做类似的事情

```
List<Product> prods = ProductService.GetProducts();

Product p = ProductService.GetSingleProduct(productID);
p.Name = "New Name";

ProductService.SaveProduct(p); 
```

这似乎是一种更复杂的方法，并且使得在业务对象中封装功能变得更加困难。

有人可以解释为什么这是一种更好的方法，还是我误解了这些概念？

谢谢

詹姆士

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T15:01:53.073

您当前的 API 是[Active Record Pattern](http://en.wikipedia.org/wiki/Active_record_pattern)的实现。当代码中使用的对象模型与数据库模型一对一匹配时，这种模式往往可以正常工作。另一个优点是存在生成这些类的工具，包括持久性代码和数据库表。

您建议的替代方案是存储库模式。正如您已经提到的那样，实现这有点复杂，但有几个优点。由于您可以实现任何类型的 ORM 工具，因此您不仅限于一对一的映射，还可以实现更复杂的映射，其中对象模型可能与数据库模型不同。因此，您不必在数据库中强制使用对象模型或相反。然而，除了一对一之外，更复杂的映射无法生成并且需要一些

另一个优点是您可以更轻松地创建测试，因为您可以创建一个甚至不需要数据库的 Mock 存储库。

使用存储库模式，您还可以将模型与持久性逻辑分开。

在这两种情况下，都可以以通用方式编写持久性方法，以便持久性代码是通用的，不需要知道需要持久化的特定对象。这对于 Active Record 模式来说是显而易见的，因为所有这些对象都实现了保存、删除、更新等。对于存储库模式，您还可以使用适用于任何对象的 ORM 工具，这样就可以编写这样的代码：

```
Repository.Save(ObjectOfAnyType); 
```

ObjectOfAnyType 可以是任何东西，只要 ORM 工具为对象的类型定义/实现了一些映射。

因此，您选择、是否想要或需要这些优势，但会增加一点复杂性。或者活动记录模式的简单性就足够了。

我总是倾向于使用存储库模式，但有时也会使用 Active Record 模式，主要用于快速原型设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T14:46:00.373

我认为这里的主要问题是关注点分离：为什么您的业务对象应该关心它是如何持久化的？为什么你的持久层应该关心你的业务对象是如何被验证或执行业务逻辑的？通过将两者分开，您可以清楚地区分对象从业务角度的操作方式以及它们如何从数据库中保存/检索。结果，您的业务对象变得不那么复杂（这很好），并且您能够更轻松地利用持久层中的共性来减少所需的代码量。

一个真正帮助我的例子是模型对象的子类化。当我将保存逻辑构建到模型中时，我会从 BI 基类中派生出相当多的逻辑，并实现一个虚拟方法来实际保存模型类中的对象。只要我的 BI 模型层次结构是平的，这就可以正常工作。当想要子类化模型时它爆炸了。那时我不得不重新实现很多用于保存的代码，因为如果不重用直接父级的代码，我就无法使用基类代码——这是我做不到的。

从那以后，我开始使用 LINQ 作为 ORM，现在保存/检索逻辑位于 DataContext 中，并且业务逻辑在每个业务实体的部分类中实现。这些类通过众所周知的接口实现验证（和其他业务逻辑）和负载检查。DataContext 使用该接口来执行它所需的操作，以确保在持久化对象之前已满足业务规则。现在我的模型类更加单一，更易于维护。LINQ 对子类化实施了一些约束，但我可以通过构造接口来解决这个问题，或者，如果有必要，可以修改我的 DB 表以支持它们的子类约束。总而言之，我发现这是一个巨大的进步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T15:21:39.540

@tvanfosson，@Marco Tolk 感谢您的回复，非常有用。

我真的很喜欢存储库模式带来的关注点分离。它确实在对象之间添加了更多的依赖关系，但我认为使用 StructureMap 之类的东西可以有效地消除它作为障碍。

但是，我仍然不喜欢简化的“模型”概念。与对象相关的逻辑（例如上例中的“产品”）不应该包含在对象本身中吗？

For example, if I were binding my product object to an editor, I would want it to modify the properties of the object and then when the user hit save, have the product persist itself (perhaps via the repository). It doesn't make sense to me to have a service between the UI and the business object when the business object "knows" enough to persist itself without being piped though another service.

# html - CSS盒子模型将元素推到页面下方

> ID：386319
> 
> 赞同：3
> 
> 时间：2008-12-22T14:09:15.723
> 
> 标签：html, css

嗨，我正在尝试修复一些测试 html 以使用 opera/chrome。它使用了[matt levine 的 Holygrail 盒子模型](http://www.alistapart.com/articles/holygrail)。

在 IE 和 Firefox 中看起来像

[正确的布局 http://img187.imageshack.us/img187/4049/writedn1.jpg](http://img187.imageshack.us/img187/4049/writedn1.jpg)

在 chrome、opera 和 safari 中，它会将侧边栏元素向下推。我玩过边距和填充，但它仍然不起作用。我错过了什么吗？

[布局错误 http://img73.imageshack.us/img73/6279/wrongpx8.jpg](http://img73.imageshack.us/img73/6279/wrongpx8.jpg)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
    <style type="text/css">
        body {
          min-width:500px;
          padding: 0 106px;
        }
        #center, #left, #right,#sidebar,#main {
          position:relative;
          float:left;
        }
        #center {
          width:100%;
          background:#CCC;
        }
        #left {
          width:106px;
          margin-left: -100%;
          right:106px;
          background:#C0C;
        }
        #right {
          width:106px;
          margin-right: -106px;
          background:#CC0;
        }
        #header{
          width:100%;
          background:#0CC;
        }
        #footer{
          width:100%;
          background:#A0E;
          clear:both;
        }
        #content{
          padding-right:330px;
          background:#F00;
        }
        #main{
          width:100%;
          padding:5px 15px;
        }
        #sidebar{
          width:300px;
          margin-right: -300px;
          background:#33C;
        }

    </style>
</head>
<body>
<div id="center">
  <div id="header">header</div>
  <div id="content">
    <div id="main">
      copy
    </div>
    <div id="sidebar">
      side
    </div>
  </div>
  <div id="footer">footer</div>
</div>
<div id="left">
left
</div>
<div id="right">
right
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T15:22:39.740

我让它在 Safari 和 Firefox 中都可以工作（尚未测试其他浏览器）

改变这个：

```
#content{
      padding-right:300px;
      background:#F00;
}
#main{
      padding:5px 15px;
      width: 100%;
      margin-right: -30px;
} 
```

不知道为什么这比你上面的更好，但它确实:)

不过，如果您正在寻找基于网格的预制布局，我建议您使用[BlueprintCSS](http://www.blueprintcss.org/)。我已经将它用于一堆项目，它真的很容易使用。这是一个固定的布局（不像你的那样流畅），所以这可能会破坏交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T14:20:01.130

好吧，我知道 min-width 在 BODY 标记上不起作用，至少在某些版本的 IE 中（不过我认为它在 Firefox 中起作用）。您可能想尝试将整个页面放在 DIV 标记中并在其上设置 min-width。

# html - 如何一键选中 HTML 页面上的所有复选框？

> ID：386321
> 
> 赞同：0
> 
> 时间：2008-12-22T14:10:41.180
> 
> 标签：html

我是带有 5 个复选框的 html 页面

我的要求是再有一个复选框“全选”，用于选择所有 5 个复选框。

提前致谢

**关闭**为[这个问题](https://stackoverflow.com/questions/386281/how-to-implement-select-all-check-box-in-html)的完全相同的副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T14:14:30.097

如果您正在寻找在单击第 6 个复选框时会检查您的 5 个复选框的 javascript，那么这样的事情应该可以工作：

```
function CheckAll(value){
    document.getElementByID("CheckBox1").checked = value;
    document.getElementByID("CheckBox2").checked = value;
    document.getElementByID("CheckBox3").checked = value;
    document.getElementByID("CheckBox4").checked = value;
    document.getElementByID("CheckBox5").checked = value;
}

<input type="checkbox" id="CheckBox6" onclick="CheckAll(this.checked)"><label>Check All</label> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T14:14:36.833

在“纯”HTML 中，您不能，但您可以修改服务器端代码以将该复选框正确解释为“就像所有其他人都被选中一样”。

使用 Javascript 相当容易。创建一个在“全选”复选框被选中时触发的方法，然后通过 ID 找到其他复选框并将它们标记为选中。如果未选中“全选”复选框，尚不清楚您应该做什么，所以它可能只是一个链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T14:15:29.140

您不能仅在 HTML 中执行此操作，但使用 javascript 应该相当简单。

我个人会像这样使用[jQuery ：http:](http://jquery.com/) [//abeautifulsite.net/notebook/50](http://abeautifulsite.net/notebook/50)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T14:17:37.843

这是[jQuery](http://www.youtube.com/watch?v=8mwKq7_JlS8)的工作。如果可以的话，今天花点时间了解一下。对于这种任务来说真是太棒了。

# regex - 我在哪里可以找到 Perl 的正则表达式练习集？

> ID：386325
> 
> 赞同：7
> 
> 时间：2008-12-22T14:11:39.150
> 
> 标签：regex, perl

我学到了很多 Perl RegEx 语法规则，但真正能够编写它们的唯一方法可能是做一堆与“RegEx”相关的练习。

我查看了 StackOverflow 上的其他“Learn RegEx”线程，但没有发现任何类似的东西。

有没有这样的练习集？以书的形式，HTML，有/没有答案，没关系，只是让我写 RegExes 一段时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T18:21:36.820

我的书[Learning Perl](http://oreilly.com/catalog/9780596001322/)和[Learning Perl Student Workbook](https://rads.stackoverflow.com/amzn/click/com/0596009968)都有正则表达式练习和答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T04:22:43.987

通过*[掌握正则表达式](http://oreilly.com/catalog/9781565922570/)*，玩转每一个引入的新结构：它会教你所有你想知道的东西，甚至是你不知道的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T16:24:22.220

我建议浏览此站点上的正则表达式标记问题，并尝试自己的答案，而不要在当前答案上达到顶峰。你不需要发布你的答案，但我敢打赌，有时你会想出值得发表的答案。

这种方法的三个好处：

1.  您将处理现实世界的问题。
2.  您可能会在学习过程中学习有关其他编程语言的知识。（'学习新语言总是好的）。
3.  您可能会帮助世界找到真实世界正则表达式问题的好答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T14:30:42.060

尝试 HTML 页面抓取。扫描 HTML（并不总是格式正确）是磨练您的正则表达式技能的好方法。我建议查找包含多个项目的页面并编写一个脚本，将它们转换为摘要或 RSS 提要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T02:15:36.457

只需查看[Regexp::Common](https://metacpan.org/pod/Regexp::Common)的源代码。

# c# - 如何将刻度转换为分钟？

> ID：386341
> 
> 赞同：98
> 
> 时间：2008-12-22T14:17:55.033
> 
> 标签：c#, datetime, timespan

我的刻度值为 28000000000，应该是 480 分钟，但我怎么能确定呢？如何将刻度值转换为分钟？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-12-22T14:22:08.083

```
TimeSpan.FromTicks(28000000000).TotalMinutes; 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2008-12-22T14:22:14.137

> 一个滴答表示一百纳秒或百万分之一秒。来自 MSDN。

所以 28 000 000 000 * 1/10 000 000 = 2 800 秒。2 800 秒 /60 = 46.6666 分钟

或者您可以使用 TimeSpan 以编程方式执行此操作：

```
 static void Main()
    {
        TimeSpan ts = TimeSpan.FromTicks(28000000000);
        double minutesFromTs = ts.TotalMinutes;
        Console.WriteLine(minutesFromTs);
        Console.Read();
    } 
```

两者都给我 46 分钟而不是 480 分钟...

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-12-22T14:21:20.097

你可以这样做：

```
TimeSpan duration = new TimeSpan(tickCount)
double minutes = duration.TotalMinutes; 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-12-22T14:22:20.890

在我看来，最清晰的方法是使用[TimeSpan.FromTicks](http://msdn.microsoft.com/en-us/library/system.timespan.fromticks.aspx)然后将其转换为分钟：

```
TimeSpan ts = TimeSpan.FromTicks(ticks);
double minutes = ts.TotalMinutes; 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-22T14:20:20.303

每分钟有 6 亿次滴答声。 [每分钟滴答声](http://msdn.microsoft.com/en-us/library/system.timespan.ticksperminute.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-22T14:25:01.400

TimeSpan.FromTicks(28000000000).TotalMinutes;

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-02T20:56:45.820

```
DateTime mydate = new Date(2012,3,2,5,2,0);
int minute = mydate/600000000; 
```

将从给定日期（mydate）返回到当前时间的分钟。希望这个帮助.cheers

# c++ - C++ 类 - 派生类中的构造函数声明

> ID：386345
> 
> 赞同：1
> 
> 时间：2008-12-22T14:19:52.003
> 
> 标签：c++, class, constructor, derived

Socket 有一个构造函数，它接受一个 winsock SOCKET 作为参数并将其存储在一个私有变量中：

```
Socket::Socket(SOCKET s) {
    this->s = s;
} 
```

我正在尝试创建一个类“GameSocket”，它将解析来自我的 Socket 类的数据：

```
class GameSocket : public Socket {

protected:

    void ParseData(unsigned char* data, int size);

}; 
```

在这些类旁边，我有一个“服务器”类，可以在需要时创建新的套接字：

```
GameSocket* Server::Accept() {

    SOCKET a = accept(s, 0, 0);
    if(a==SOCKET_ERROR) {
        return 0;
    }
    else {
        return new GameSocket(a);
    }

} 
```

但是，这给了我最后一个“else”的错误：

```
error C2664: 'GameSocket::GameSocket' : cannot convert parameter 1 from 'SOCKET' to 'const GameSocket &' 
```

在处理派生类时，我必须在构造函数中遗漏一些东西......

不要对我太苛刻，我对 C++ 和 OOP 还比较陌生

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T14:25:01.977

为 GameSocket 添加一个构造函数

```
class GameSocket : public Socket {

public:

    // you need to add
    GameSocket(SOCKET s) : Socket(s) {}

protected:

    void ParseData(unsigned char* data, int size);

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T14:39:01.637

GameSocket 的构造函数必须接收一个 SOCKET 参数，然后将其传递给初始化列表中的 Socket 基类：

```
class GameSocket : public Socket {
public:
    GameSocket(SOCKET s) : Socket(s) {}
    ...
}; 
```

为什么 GameSocket 必须从 Socket 派生而不是持有对 Socket 的引用？GameSocket 正在（或应该）管理套接字状态和序列化，而低级套接字接口包含在 Socket 类中。您的 Server 类可以创建 Socket 类的实例，然后传递一个指向 GameSocket 类的指针来管理它们。

```
class GameSocket {
public:
    GameSocket(Socket *s) : s_(s) {}
    ~GameSocket() {
        s_->close();
        delete s_;
    }
    ...
private:
    Socket *s_;
};

GameSocket* Server::Accept() {
    // accept function added to Socket class
    Socket *newSocket = serverSocket->accept();
    // create GameSocket with newly opened Socket
    return newSocket ? new GameSocket(newSocket) : NULL;
} 
```

# development-environment - Visual Studio Team System 切换意见

> ID：386362
> 
> 赞同：1
> 
> 时间：2008-12-22T14:24:29.310
> 
> 标签：development-environment

假设您的基于 .NET 的开发团队已经在其流程中使用以下工具集：

*   Subversion / TortoiseSVN / VisualSVN（源代码控制）
*   NUnit（单元测试）
*   一个开源的维基
*   付费的专有错误跟踪系统

您对 Subversion 和 NUnit 很满意，但不喜欢 Wiki 和错误跟踪系统。您还想添加一些轻量级的项目管理软件（如 Fogbugz/Trac）——它不一定是免费的，但显然越便宜越好。

您能否为采用 VSTS 提出令人信服的论点，无论是添加缺失的功能并替换不喜欢的软件，还是处理所有事情（包括源代码控制）？所有这些功能的集成是否大于部件的总和，还是仅仅获取和更换您不喜欢或没有的部件会更好？

我记得几年前研究过 VSTS，并认为它非常昂贵，而且并不比许多免费选项更好，但我认为微软会继续努力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T14:45:31.623

VSTS 很棒，如果您在其中做所有事情。不幸的是，这些年来价格并没有变得更好。:( CAL 的价格仍然高得离谱。唯一的改进是，如果一个人**只**使用工作项系统，并且**只**使用他/她自己的工作项（不要偷看其他人的工作项！），那么就不需要CAL。这使它更容易用作外部错误报告系统。但在这方面仍有很多不足之处。

有一种方法可以降低成本 - 成为 Microsoft 认证合作伙伴。如果你是一个简单的合作伙伴，你可以免费获得 5 个 VS/TFS 许可证；如果您是金牌认证合作伙伴，您将获得 25 分（如果我没有记错的话）。对于大多数公司来说，这应该足够了。但是获得金牌身份可能会很棘手，具体取决于您的工作。

如果您只不喜欢这两个部分，那么最好只找到它们的替代品而不是所有东西？那里有许多 wiki 系统，有些应该是您喜欢的。错误跟踪也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T17:54:02.710

我们不仅对工具非常满意，而且对 Team Foundation Server 和各种 Team Edition 为我们提供的集成感到非常满意。我们之前使用 Borland 的 StarTeam 进行源代码控制和通过第 3 方 wiki 进行问题跟踪，目前我不知道它的名称。

我们是时候延长与 Borland 的许可和支持协议了，但我们却发现，将用户添加到我们的许可和升级产品的成本与硬着头皮制造转变。需要考虑的一件事是，您通常会从一开始就为开发工具付费，因此成本部分由我们的预算承担。

我们也觉得没有必要为每个人获取 Team Suite。您可能想为开发人员考虑它，但其他学科在使用大多数公司的所有工具方面并没有真正的好处。

我们能够获得适合 12 人的团队版本、足够 50 个用户的 CAL（用于 Team Explorer、Teamprise、Team Project Portals、Team Web Access）、我们拥有的五个 Mac 用户的 Teamprise，以及 Team Foundation Server 软件本身低于六位数。考虑到这包括我们通常会购买的开发人员工具，这是一笔划算的交易。

新许可的前期成本也涵盖了两年，因此我们可以在 2008 财年和 2009 财年之间分配预算。非常重要的是确保不要让许可证失效，因为许可证的续订成本只是初始成本的一小部分，而且还包括版本升级。

至于功能，我们正在推出。我们部门大约有一半人完成了培训，我已经开始迁移项目了。开发团队绝对喜欢这些功能并与他们的工作流程紧密集成。版本控制轻而易举，工作项（及其相关的报告工件）可扩展至 n 级。TFS 在很大程度上依赖于为工作流管理带来健全性，这一事实有助于将所有流程绑定到一个您无法通过多个供应商获得的水平。

不过，我最喜欢的东西是可扩展性模型。使用 Team Foundation Server API，您可以轻松编写签入策略、编写与系统交互的工具、开发插件等。通过最少的实施，我们已经看到生产力和产品质量的提高。

不过，集成 Team Build 仍遥遥无期。我还没有建立一个构建项目，但它似乎是无缝且无痛的。时间会证明... :-)

**编辑 - 我忘了提到我们向 TFS 的迁移包括测试负载代理的许可。Team Test 中的负载测试功能是我见过的最好的功能之一，如果不是的话。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T17:37:30.327

我在哪里，我们已经解决了以下问题：

*   用于源代码控制的 SVN
*   [Redmine](http://www.redmine.org)用于错误跟踪和 wiki
*   用于单元测试的 NUnit
*   CruiseControl.NET 用于我们的构建服务器

[Redmine](http://www.redmine.org)是一个开源的 Ruby on Rails 应用程序，它比 Trac 更好地支持多个项目，并且似乎更容易管理。绝对值得一试。

与其他产品相比，VSTS 似乎太贵了。作为一个额外的好处，您还可以获得开源解决方案的来源，如果该功能尚不存在，您可以修改内容以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T15:08:45.180

我会坚持使用 SVN 并使用 trac 或 bugzilla 或fogbugz。您也可以试用团队服务器。在我看来，这不值钱。MS 有机会使用版本控制，但他们很久以前就把它搞砸了。如果你问我的话就太晚了，坦率地说，我对他们如何尝试通过“集成”到源代码控制来控制你在 IDE 中的所有开发体验印象深刻。我更喜欢 perforce/SVN 和单独的缺陷跟踪解决方案。

综上所述，您可能不会在以下任何方面出错：

bugzilla 或 trac 或 fogbugz 和 SVN MS 团队 thingamabob

# encryption - 如何加密ini文件中的值

> ID：386374
> 
> 赞同：3
> 
> 时间：2008-12-22T14:33:39.900
> 
> 标签：encryption, file, ini

加密 INI 文件中的值的最佳方法是什么？

使用加密/解密密钥？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T14:43:05.450

起到什么作用？你想保护或混淆什么？

您可以使用适用于所有平台的众多双向密钥加密算法中的一种……但首先要问自己为什么要这样做。如果你试图做一些黑客攻击，加密 ini 字符串可能不会让你走那么远，因为一旦你解密 ini，字符串就在内存中。解密的密钥将在您的程序中。Childsplay 破解。

如果您只是想阻止人们轻松编辑设置，请不要将其放入 ini 中。选择用户将难以编辑的二进制格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T14:43:22.627

出于什么目的？安全？

如果您尝试（例如）加密明文密码，您可能应该使用 PKI 的一些实现。但请记住，密钥管理将成为您的问题。仅仅加密值并不是万能的，因为 ini 文件很可能在本地主机的文件系统上，大概是您必须存储密钥对的同一个地方。您只是将问题抽象到了一层。他们将无法直接读取您的加密密码，但如果他们能找到您存储密钥对的位置，他们就可以自行解密。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T16:00:17.370

对于我有电子邮件密码的个人脚本，我使用 [TinyEncryption。](http://en.wikipedia.org/wiki/Tiny_Encryption_Algorithm)

我将把密码放在代码本身中。这可以防止随便的窥​​探者仅仅浏览并获取电子邮件密码。

代码也很简单。这是在Python中。

```
import random
import base64
def tinycode(key, text, reverse=False):
    "(de)crypt stuff"
    rand = random.Random(key).randrange
    if reverse:
        text = base64.b64decode(text)
    text = ''.join([chr(ord(elem)^rand(256)) for elem in text])
    if not reverse:
        text = base64.b64encode(text)
    return text 
```

为了提高安全性，我使用 PGP，但您必须提示输入密码。没有完美的设置，这取决于您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T14:40:03.880

您可以使用任何带有密钥的标准加密算法，并可能在加密之前为该值添加一些随机填充。

但是，您打算在哪里存储该密钥？还是您要让用户输入密码并从中派生密钥？如果不是，那么加密该值将毫无意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T14:38:28.423

你也需要解密吗？如果不是，你可以只[加盐](http://en.wikipedia.org/wiki/Salt_(cryptography))和哈希。

如果您确实想解密它，那么我说您也许也应该指定语言。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T15:15:29.380

MD5 哈希

然后将 hash("password") 与 ini_file.password 哈希值进行比较

# xml - 不明确的 XML 模式

> ID：386377
> 
> 赞同：7
> 
> 时间：2008-12-22T14:36:38.320
> 
> 标签：xml, xsd, ambiguity

我正在尝试为类似于以下内容的 XML 生成一个非常简单的 XML 模式：

```
<messages>
  <item>
    <important_tag></important_tag>
  </item>
  <item>
    <important_tag></important_tag>
    <tag2></tag2>
  </item>
  <item>
    <tag2></tag2>
    <tag3></tag3>
  </item>
</messages> 
```

这个想法是`<important_tag>`会有一个特定的定义，它可能会或可能不会出现在`<item>`. 它也可能出现不止一次。此外，之前或之后可能还有其他标签`<important_tag>`，我无法提前命名。

我想给出一个具体的定义`<important_tag>`。例如，定义它必须包含的属性。我的意思是，**如果**important_tag 存在，它必须符合我的定义。任何其他标签不必符合任何定义。

我尝试使用以下方案：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="messages">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="item" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="item">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="important_tag" minOccurs="0"/>
        <xs:any minOccurs="0"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="important_tag">
    <xs:complexType>
      <xs:simpleContent>
        ... specific definitions for important_tag ...
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

这会导致错误提示架构不明确。

确切的错误信息是：

```
cos-nonambig: '<xs:element ref="important_tag">' makes the content model non-deterministic against '<xs:any>'. Possible causes: name equality, overlapping occurrence or substitution groups. 
```

我正在使用 Altova 的 XML Spy。

我该如何解决这个问题？

谢谢，达娜

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T15:45:01.130

MSDN 上有一篇很棒的文章讨论了设计可扩展模式，你可以在[这里](http://msdn.microsoft.com/en-us/library/ms950793.aspx)找到，我建议你通读一遍，但具体到你的观点，它解释了为什么你在第 2 点遇到这个错误。在“使用 XML Schema to Design a Versionable XML Format”（您可以搜索“non-deterministic”并直接到达那里。

基本上，一旦你有一个 xs:any 元素，验证器就不能假设其他兄弟元素的任何事情，所以 - 你很可能有一个重要的标签定义，它不需要那些强制属性，所以这些元素不能被验证

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-02T17:52:45.050

关于错误：该错误消息提到了您包含的 xsd 中没有的一行，但是其中的这两行是模棱两可的：

```
<xs:element ref="important_tag" minOccurs="0"/>
<xs:any minOccurs="0"/> 
```

显示歧义的最简单示例是如果只有一个`<important_tag>`：

```
 <important_tag></important_tag> 
```

问题是它可以被解释为一个“important_tag”和零个“any”标签（这是你想要的），但它也可以被解释为零个“important_tag”和一个“any”标签。这是因为“any”标签可以匹配任何标签，包括“important_tag”。

我读到下一个版本的 XML Schema 可以让您说出您的意思：*除*重要标签之外的任何标签。

以两种不同方式匹配 XML 类似于以两种不同方式匹配“a”的正则表达式“a*a*”（第一个“a”；或第二个“a”）。在 DTD 的 XML 规范中，这种歧义曾经被称为“非确定性”，但 XML Schema 规范将其称为唯一粒子属性规则 (UPA)，这意味着您应该能够分辨出架构的哪个部分获取每个部分的 XML 文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T15:48:58.017

根据您的要求（例如“任何其他标签不必符合任何定义。”），基于规则（“这必须是真的”、“那必须是假的”）的[Schematron](http://en.wikipedia.org/wiki/Schematron)可能会更好解决方案比 W3C Schema 更“一切都必须如此”。

# php - 每当使用 £ 时，MySQL 或 PHP 都会附加一个 Â

> ID：386378
> 
> 赞同：10
> 
> 时间：2008-12-22T14:36:38.897
> 
> 标签：php, mysql, character

提供的答案都很棒，我在 Alnitak 的答案的评论中提到我需要去看看我的 CSV 生成脚本，因为无论出于何种原因它都没有输出 UTF-8。

正如正确指出的那样，它正在输出 UTF-8 - Ye Olde Microsoft Excel 存在问题，它没有按照我想要的方式进行编码。

我现有的 CSV 生成看起来像：

```
// Create file and exit;
$filename = $file."_".date("Y-m-d_H-i",time());
header("Content-type: application/vnd.ms-excel");
header("Content-disposition: csv" . date("Y-m-d") . ".csv");
header( "Content-disposition: filename=".$filename.".csv");
echo $csv_output; 
```

现在看起来像：

```
// Create file and exit;
$filename = $file."_".date("Y-m-d_H-i",time());
header("Content-type: text/csv; charset=ISO-8859-1");
header("Content-disposition: csv" . date("Y-m-d") . ".csv");
header("Content-disposition: filename=".$filename.".csv");

echo iconv('UTF-8', 'ISO-8859-1', $csv_output); 
```

## -------------------------------------------------- -----

**原始问题**

你好，

我有一个收集数据的表单，表单工作正常，但我刚刚注意到，如果有人键入或使用“£”符号，MySQL DB 以“Â£”结尾。

不确定在哪里或如何阻止这种情况发生，要遵循的代码和数据库信息：

**MySQL 详细信息**

```
mysql> SHOW COLUMNS FROM fraud_report;
+--------------+--------------+------+-----+---------+----------------+
| Field        | Type         | Null | Key | Default | Extra          |
+--------------+--------------+------+-----+---------+----------------+
| id           | mediumint(9) |      | PRI | NULL    | auto_increment |
| crm_number   | varchar(32)  | YES  |     | NULL    |                |
| datacash_ref | varchar(32)  | YES  |     | NULL    |                |
| amount       | varchar(32)  | YES  |     | NULL    |                |
| sales_date   | varchar(32)  | YES  |     | NULL    |                |
| domain       | varchar(32)  | YES  |     | NULL    |                |
| date_added   | datetime     | YES  |     | NULL    |                |
| agent_added  | varchar(32)  | YES  |     | NULL    |                |
+--------------+--------------+------+-----+---------+----------------+
8 rows in set (0.03 sec) 
```

**PHP 函数**

```
function    processFraudForm($crm_number, $datacash_ref, $amount, $sales_date, $domain, $agent_added) {

    // Insert Data to DB
    $sql    = "INSERT INTO fraud_report (id, crm_number, datacash_ref, amount, sales_date, domain, date_added, agent_added) VALUES (NULL, '$crm_number', '$datacash_ref', '$amount', '$sales_date', '$domain', NOW(), '$agent_added')";
    $result = mysql_query($sql) or die (mysql_error());

    if ($result) {
        $outcome = "<div id=\"success\">Emails sent and database updated.</div>";
    } else {
        $outcome = "<div id=\"error\">Something went wrong!</div>";
    }

    return $outcome;
} 
```

**示例数据库条目**

```
+----+------------+--------------+---------+------------+--------------------+---------------------+------------------+
| id | crm_number | datacash_ref | amount  | sales_date | domain             | date_added          | agent_added      |
+----+------------+--------------+---------+------------+--------------------+---------------------+------------------+
| 13 | 100xxxxxxx | 10000000     | Â£10.93 | 18/12/08   |  blargh.com        | 2008-12-22 10:53:53 | agent.name | 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-22T14:43:19.757

您看到的是[UTF-8](http://en.wikipedia.org/wiki/UTF-8)编码 - 它是一种以相对紧凑的格式存储 Unicode 字符的方式。

磅符号`0x00a3`在 Unicode 中具有价值，但是当它以 UTF-8 编写时，它就变成`0xc2 0xa3`了，这就是存储在数据库中的内容。您的数据库表似乎已设置为使用 UTF-8 编码。这是*一件好事*！

如果您从数据库中提取值并将其显示在 UTF-8 兼容终端上（或在声明为 UTF-8 编码的网页上），它将再次看起来像一个正常的井号。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-22T14:45:10.767

Â£ 是 0xC2 0xA3 这是 £ 符号的 UTF-8 编码 - 所以您将其存储为 UTF-8，但可能将其视为 Latin-1 或 UTF-8 以外的其他东西

了解如何手动识别和解码 UTF-8 很有用 - 检查[wikipedia 页面](http://en.wikipedia.org/wiki/UTF-8)以获取有关编码如何工作的信息：

*   0xC2A3 = 110 **00010** 10 **100011**
*   粗体部分是实际的“有效负载”，它给出了 10100011，即 0xA3，即英镑符号。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-11-10T23:59:06.597

在 PHP 中，另一个小规模的解决方案是对返回的 utf8 字符串进行字符串转换：

```
print iconv('UTF-8', 'ASCII//TRANSLIT', "Mystring â"); //"Mystring " 
```

或者在其他平台上触发对 inconv 命令的系统调用（linux / osx）

[http://php.net/manual/en/function.iconv.php#83238](http://php.net/manual/en/function.iconv.php#83238)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T15:52:34.623

您需要以 utf-8 编码提供您的 HTML（我认为实际上每个人都需要这样做！）标题如下：

内容类型：文本/html；字符集=UTF-8

或等价物。仔细检查细节。应该始终将字符集声明为浏览器可以默认为它喜欢的任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-03T03:58:11.807

要删除 Â，请使用：

$column = str_replace("\xc2\xa0", '', $column);

学分等：[如何使用 PHP 删除字符串中所有出现的 c2a0？](https://stackoverflow.com/questions/7923426/how-to-remove-all-occurrences-of-c2a0-in-a-string-with-php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-02T14:40:54.257

非常感谢。我一直怀疑 mysql 破坏了英镑符号。现在我需要做的就是生成 csv 记录的任何地方，只需使用 wrap them incov 功能。虽然这是一份好工作，但我很高兴，至少有人确切地展示了该做什么。我真诚地感谢展示以前和新的“标题”值。这对我帮助很大。

-标记

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-05T16:00:05.663

如果您将“50,000 英镑的开发挑战”行保存在两个不同的数据类型列中，即“varchar”和“text”字段。

在我保存之前，我已使用以下函数将符号替换为 html equi 值。str_replace("£", "£", $title);

您会发现存储在文本字段中的值是 £，而 varchar 中的值是 "Â£"。

# c++ - DirectShow - 如何用文本覆盖视频

> ID：386379
> 
> 赞同：5
> 
> 时间：2008-12-22T14:36:49.317
> 
> 标签：c++, windows-mobile, directshow

我正在为 Windows Mobile 编写一个应用程序，我想在屏幕上的视频预览上显示一些文本。

有谁知道如何做到这一点，或者是否有任何关于它的好教程？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:13:53.833

试试这个： http: [//www.codeguru.com/cpp/gm/directx/article.php/c1229](http://www.codeguru.com/cpp/g-m/directx/article.php/c1229)

不过，不确定它是否适用于 Windows Mobile。

# sql-server - 应该在给定表上索引哪些字段？

> ID：386380
> 
> 赞同：2
> 
> 时间：2008-12-22T14:36:59.050
> 
> 标签：sql-server, indexing

我有一张有很多寄存器（超过 200 万）的表。这是一个事务表，但我需要一个包含很多连接的报告。索引该表的最佳做法是什么，因为它消耗了太多时间。

我正在使用存储过程分页方法对表进行分页，但我需要一个索引，因为当我想导出报告时，我需要在没有分页的情况下获取整个查询并获取我需要全选的总记录。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-22T14:45:37.037

SQL Server 2008 Management Studio 查询工具，如果您打开“包括实际执行计划”，将告诉您给定查询需要哪些索引才能快速运行。（假设有一个明显的缺失索引导致查询运行异常缓慢，也就是说。）

[SQL Server 2008 Management Studio 查询截图 http://img208.imageshack.us/img208/4108/image4sy8.png](http://img208.imageshack.us/img208/4108/image4sy8.png)

我们一直在 Stack Overflow 上使用它。这是 SQL 2008 的最佳功能之一。它也适用于较旧的 SQL 实例，只需安装 SQL 2008 工具并将它们指向 SQL 2005 实例。不过，不确定它是否适用于更早的任何东西。

正如其他人所指出的，您也可以手动执行此操作，但这需要一些试验和错误。您将需要 ORDER BY 和 WHERE 子句中使用的字段的索引。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T20:04:11.840

> 关键字段必须在 where 子句中是everithing ???

不，那将是矫枉过正。索引字段仅在以下情况下有效毫无意义），并且 b）您的 WHERE 子句不涉及函数调用或其他魔法。

在你的情况下， TBL.Status*可能*是一个候选 - 有多少可能的值？您选择“1”和“2”值 - 如果有数百个可能的值，那么这是一个不错的选择。

附带说明：此处的此子句： (TBL.Login IS NULL AND TBL.Login <> 'dev' ) 毫无意义 - 如果 TBL.login 的值为 NULL，那么它肯定不是 'dev' .... . 所以仅仅“IS NULL”就绰绰有余了......

您可能要考虑为其添加索引的另一个字段是 TBL.Date，因为您似乎在这里选择了一个日期范围——这可能是一个不错的选择。

此外，一般注意：尽可能不要使用 SELECT * FROM ...... 来选择您的字段。这会给 SQL Server 带来很多开销。指定你的列 - 并且只选择你真正需要的那些 - 而不仅仅是所有这些......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T14:40:06.440

检查您的查询，并找出哪些字段用于匹配它们。这些通常是最好的候选人！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T14:49:17.077

SQL Server 有一个“数据库引擎优化顾问”可以帮助您。这对于 SQL Server Express 不存在，但对于所有其他版本的 SQL Server 都存在。

*   在查询窗口中加载您的查询。
*   在菜单上，单击查询 -> 在数据库引擎优化顾问中分析查询

调优顾问将识别可以添加到表中以提高性能的索引。以我的经验，调优顾问并不总是有帮助，但大多数时候确实有帮助。这是我建议你开始的地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T16:03:06.087

好的，这是正在做的查询

```
 SELECT 
        TBL.*
    FROM
        FOREINGDATABASE..TABLENAME TBL
            LEFT JOIN Status S 
                    ON TBL.Status = S.Number
    WHERE
    (TBL.ID = CASE @Reference WHEN 0 THEN TBL.ID ELSE @Reference END) AND
    TBL.Date >= @FechaInicial AND 
    TBL.Date <= @FechaFinal AND
    (TBL.Channel = CASE @Canal WHEN '' THEN TBL.Channel ELSE @Canal END)AND
    (TBL.DocType = CASE @TipoDocumento WHEN '' THEN TBL.DocType ELSE @TipoDocumento END)AND
    (TBL.Document = CASE @NumDocumento WHEN '' THEN TBL.Document ELSE @NumDocumento END)AND
    (TBL.Login = CASE @Login WHEN '' THEN TBL.Login ELSE @Login END)AND
    (TBL.Login IS NULL AND TBL.Login <> 'dev' )  AND
    TBL.Status IN ('1','2') 
```

关键字段必须在 where 子句中是everithing ???

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T14:41:04.020

如果我没有记错，请纠正我，我认为您应该在 where 子句的条件字段上创建非聚集索引。（也许这可以作为一个起点来获得一些索引候选者）。

祝你好运

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T14:47:07.533

如果执行索引扫描而不是查找，原因可能是索引中的字段顺序不正确。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T15:26:45.130

将索引放在您要加入和过滤的所有列上。索引的使用还取决于索引列的选择性。最好的方法是向我们展示您的查询，以便我们尝试改进它。

# security - 网络服务在 Vista / IIS7 上需要什么权限？

> ID：386386
> 
> 赞同：0
> 
> 时间：2008-12-22T14:39:42.383
> 
> 标签：security, iis-7, windows-vista

在 VS2008/Vista/IIS7 上进行更多的开发修改，我想知道有关网络服务帐户的一些事情。在我尝试设置 Sql Role Membership Provider 之前，它运行我的网站没有问题，它在 App_Data 文件夹中创建了一个本地数据库。在那里的某个地方，网络服务用完了验证我的客户端所需的权限。

我通过更改应用程序池以在我的管理员帐户下运行（稍后通过暂时授予网络服务管理员权限）解决了这个问题，但我很好奇网络服务缺少哪些权限，因为我最终想保留它（和我的网站）退出管理组。有任何想法吗？

另外，哪里是调试这些东西的好地方？EventLogs 没有任何用处，所以我不确定还有什么地方可以用来找出帐户何时尝试做某事并被拒绝。也许我只是没有正确配置日志？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T19:10:17.673

奇怪的是，赋予网络服务对包含 mdb 文件的文件夹的写访问权限似乎还不够。它显然也希望读取“Documents\Visual Studio 2008 目录”下的所有内容（该站点托管在该目录中）。现在看来还可以。感谢进程监视器！

# c++ - 矩形多边形的布尔运算

> ID：386438
> 
> 赞同：6
> 
> 时间：2008-12-22T15:00:26.103
> 
> 标签：c++, algorithm, geometry, boolean

Avast 那里的程序员同胞！

我有以下问题：

我有两个重叠的矩形，如下图所示。

![替代文字](https://farm4.static.flickr.com/3249/3128407236_d0e63a1b31.jpg)

我想找出由点 ABCDEF 组成的多边形。

替代圣诞节描述：红色饼干切割器正在切掉一点黑色饼干。我想计算黑色饼干。

每个矩形是一个具有 4 个二维顶点的数据结构。

实现这一目标的最佳算法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T15:15:09.943

这是一般 2D 多边形裁剪的一个特例。Weiler-Atherton 算法是一个很好的起点。 [维基百科有一个摘要](http://en.wikipedia.org/wiki/Weiler-Atherton)和[原始论文的链接](http://www.cs.drexel.edu/~david/Classes/CS430/HWs/p214-weiler.pdf)。该算法似乎与您描述的数据结构非常匹配。

请注意，您很可能最终会得到一个带有孔的矩形（如果红色的完全在黑色的内部）或什至两个矩形（例如，如果红色比黑色更高更瘦）。如果您确定黑色矩形内只有红色矩形的一个角，那么解决方案应该简单得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T15:05:59.493

[构造立体几何](http://en.wikipedia.org/wiki/Constructive_solid_geometry)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T15:20:12.710

坐标有多精确？如果矩形相当小，最简单的方法可能是在画布上绘制它们，首先是黑色矩形，然后是红色。画布上剩余的黑色像素是剩下的多边形。

另一种方法是根据矩形的所有边将坐标网格拆分为一堆矩形（不计算无界矩形，如果您有两个原始矩形，则最多生成 9 个矩形）。然后只需测试每个矩形中的一个代表点是否属于特定多边形，以确定哪些矩形在其中，哪些在外面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T15:18:42.133

我在这里找到了一些我可能会用到的东西：

[http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/Boolean_set_operations_2/Chapter_main.html](http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/Boolean_set_operations_2/Chapter_main.html)

在发布这个问题之前，我实际上已经下载了 CGAL 源代码，但我想我会仔细研究一下。

# apache - 如何从网页启动服务器上的应用程序

> ID：386445
> 
> 赞同：1
> 
> 时间：2008-12-22T15:02:06.723
> 
> 标签：apache, debian

例子：

用户登录网页 => 单击按钮
此操作启动可执行文件“CreatePrettyPicture”
在服务器上创建文件“prettypicture.jpg”
当用户重新加载页面时，漂亮的图片“PrettyPicture.jpg”显示在页。

如果我可以使用参数启动应用程序，那就更好了。

该服务器是使用 Debian，而作为 Web 服务器，我使用的是 Apache。如果您需要有关服务器配置的更多信息，请告诉我。

多个用户同时点击按钮的可能性不是问题的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T15:06:49.427

您需要阅读[CGI Scripts](http://en.wikipedia.org/wiki/Common_Gateway_Interface)。

PHP 也有可能已经在您的服务器上可用，但我不建议您使用它，除非您已经熟悉它并且知道所有安全陷阱，从问题来看，这似乎不太可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T15:10:07.970

您最好在 apache 安装中使用服务器端脚本来启动可执行文件。使用 PHP 可能更容易（如果还没有安装应该很容易），[这里是命令](http://no2.php.net/manual/en/book.exec.php)。只要您实际上不对页面使用任何输入，它就应该足够安全。

# perl - 在 Perl 中比较字符串时如何忽略重音符号？

> ID：386459
> 
> 赞同：9
> 
> 时间：2008-12-22T15:06:04.047
> 
> 标签：perl, string, comparison, diacritics

我有这个测验应用程序，我将人们输入的内容与正确答案相匹配。现在，我所做的基本上是：

```
if ($input =~ /$answer/i) {
     print "you won";
} 
```

很好，好像答案是“鱼”，用户可以输入“一条鱼”并算作一个好的答案。

我面临的问题是，我的用户是法国人，我希望能够接受，比如说，用户输入“taton”，答案是“tâton”。

所以，我能做的是：

```
use POSIX qw(locale_h);
use locale;
setlocale(LC_TYPE, "fr_FR.ISO8859-15");
setlocale(LC_COLLATE, "fr_FR.ISO8859-15"); 
```

在我的检查程序中，执行：

```
$input = lc($input);
$input =~ tr/àáâãäåçèéêëìíîïñòóôõöùúûüýÿ/aaaaaaceeeeiiiinooooouuuuyy/; 
```

以及同样的答案。

我不喜欢它，因为我必须对事物进行硬编码，而当我决定离开 ISO-8859-15 世界转向 UTF-8 世界的那一天，我注定要失败。

所以，我正在寻找一种比较字符串的方法，这将使`"tâton" eq "taton"`，`"maçon" eq "macon"`或者`"macon" =~ /maçon/`是真的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-22T16:05:34.677

尝试 CPAN 中的[Text::Unaccent](http://search.cpan.org/dist/Text-Unaccent)模块（或[Text::Unaccent::PurePerl](http://search.cpan.org/dist/Text-Unaccent-PurePerl)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T04:24:57.200

这似乎不是调用正则表达式的合适场合——您应该简单地列出可接受的答案，加上一些过滤以删除非必要的词，如“a”、“the”及其特定语言的等价词。

无论你做什么，对我来说似乎很明显它必须是字符编码感知和语言感知的。正则表达式通常两者都不是。

# c# - 关系的数据结构

> ID：386464
> 
> 赞同：1
> 
> 时间：2008-12-22T15:08:14.963
> 
> 标签：c#, algorithm, data-structures

我正在将 VB6 转换为 C#，我想让我的数据结构更有效地保存值和关系。在 VB 中，我有一个值集合和另一个值之间的关系集合，这些关系具有这些关系的优先级。我还有一个算法，当将一组值传递给它时，将返回将这些值连接在一起所需的所有关系。例如，假设值集合包含 1-10，关系集合包含

1,2
3,2
5,2
2,8
8,10
9,10

如果输入是 1,9,10，则返回的关系将是——

1,2
2,8
8,10
9,10

由于可能有多个路径，因此将返回最少的关系，但需要注意关系优先级。如果关系具有更高的优先级，则将添加该关系，并从那里添加其余关系。我正在考虑使用不[相交集数据结构](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)，但我不确定。

有任何想法吗？

**更多信息 -**

值的数量通常小于 100，关系小于 500。集合是静态的，算法将一次又一次地用于查找路径。另外，我没有问这个，但是不[相交集数据结构](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)中的算法会是最有效的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T20:47:10.880

听起来您拥有的是[Graph](http://en.wikipedia.org/wiki/Graph_(mathematics))。这是一个有节点和边的结构。有[许多](http://www.google.com/search?rlz=1C1GGLS_enUS291US303&aq=f&sourceid=chrome&ie=UTF-8&q=graph+library)处理图形的库和工具。[微软](http://msdn.microsoft.com/en-us/library/aa289152.aspx)甚至发表了一篇关于如何处理它们的论文。我认为图表在许多情况下都很棒并且非常有用。

图的一大好处是能够为节点之间的边分配优先级。然后当你想找到两个节点之间的路径时，boom，图可以选择具有理想优先级的路径。

在你的情况下，你的价值观是节点，你的关系是边缘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T15:31:28.957

您需要问问自己（并告诉我们）您期望什么样的使用模式。这些关系是按顺序添加还是随机添加的，您的查询是按顺序添加的（如您显示的那样）还是随机添加的，这本质上是一个批处理过程——加载它们，读取查询——还是您希望这样做它“在线”是指您可以添加一些，然后查询一些，然后再添加一些并查询更多？

您是否会事先知道要存储多少，以及您希望存储多少？许多？数千？几千万？

以下是一些建议：

*   如果您事先知道要存储多少，这并不是一个很大的数字，您不希望在第一次加载后添加它们，对的左侧没有任何重复，并且它们重新合理地“密集”，因为一对左侧的数字之间没有大的差距，那么你可能想要一个数组。插入是*O(1)*，访问是*O(1)*，但是不能有重复的索引，并且在构建它之后扩展它是一种痛苦。
*   如果数字真的很大，例如 > 10 ⁸，您可能需要某种数据库。数据库相对来说非常慢——比内存数据结构大 4 到 5 个数量级——但可以处理非常大的数据。
*   如果您在第一次加载后有插入，并且您关心顺序，那么您将需要某种树，例如 2-3 树。插入和访问都是*O(lg n)*。您可能会在“有序列表”之类的名称下找到一个实现（我不是 C# 人。）
*   大多数其他情况下，您可能需要哈希。平均插入和访问都*O(1)*，就像一个数组；最坏的情况[你不会用这个数据命中]是*O(n)*

# asp.net - 使用 jQuery 进行 AJAX 调用时延长表单身份验证超时

> ID：386465
> 
> 赞同：12
> 
> 时间：2008-12-22T15:08:21.610
> 
> 标签：asp.net, jquery, ajax, asp.net-ajax, forms-authentication

我希望重写一个非常密集的 CRUD 类型的 ASP.NET 页面以利用 ajax 调用（特别是 jQuery ajax）。我这样做的担心是用户在此页面上的停留时间可能比表单身份验证超时时间长。正因为如此，我认为我应该使用每个 ajax 调用来扩展表单身份验证票证（基本上它在普通 Web 表单提交模型中的作用）。所以问题：

这甚至是一个有效的担忧吗？如果是这样，是否可以编写一个 jQuery 插件来延长表单身份验证超时？是否已经存在？使用 ASP.NET AJAX 会是更好的方法吗？

任何评论\帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-23T19:08:58.253

我可以确认，通过 jQuery 进行 Web 服务或页面方法调用**将**延长 ASP.NET 会话到期时间，其方式与常规回发相同。

我经常使用五分钟的 setInterval() 来调用“keep-alive”服务，即使他们让应用程序空闲，它也会无限期地保留用户的会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:41:46.483

您应该能够在没有脚本管理器的情况下使用 MS Ajax，并使用 jQuery 来使用 WebMethods。[更多信息在这里](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)这样做

据我所知，调用 WebMethod 会延长用户的会话超时时间。所以这种方法可能是两全其美的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-29T14:15:32.313

我将它用于我的 keepalive 网络服务。根据您的喜好修改它并让我知道它是否有效... 注意：会话（“UID”）是我在登录时设置的变量。我将我的票命名为相同

```
<WebMethod(CacheDuration:=0, EnableSession:=True)> _
Public Function keepSessionAlive() As String
    If Session("UID") Is Nothing OrElse Session("UID") = 0 Then
        Throw New ApplicationException("Login")
    End If

    Session("lastKeepSessionAlive") = DateTime.Now

    If Not (Context.Request.Cookies(System.Web.Security.FormsAuthentication.FormsCookieName) Is Nothing) Then
        Dim ticket As System.Web.Security.FormsAuthenticationTicket
        Try
            ticket = System.Web.Security.FormsAuthentication.Decrypt(Context.Request.Cookies(System.Web.Security.FormsAuthentication.FormsCookieName).Value)
            If ticket.Name = Context.Session("UID") Then
                System.Web.Security.FormsAuthentication.SetAuthCookie(Context.Session("UID"), False)
                Debug.WriteLine("keepAlive:AuthenticationReset")
            End If
        Catch ex As Exception
            Debug.WriteLine("keepAlive:AuthenticationReset FAILED!!!")
            Throw New ApplicationException("Login")
        End Try
    Else
        Debug.WriteLine("keepAlive.Load: No Authentication Cookie. Error")
        Throw New ApplicationException("Login")
    End If

    Return Session.SessionID.ToString
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T23:15:18.770

使用 Fiddler 或其他一些实用程序来查看 Microsoft 是否足够聪明，以确保 cookie 在 AJAX 调用之间得到更新。如果您使用 Microsoft 的内置 asp.net AJAX（基本相似），您可能会有更好的运气（关于自动更新表单 auth ticket）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T15:05:01.507

表单身份验证通过 cookie 工作。Cookie 是通过 XMLHttpRequest 请求发送的，所以我认为这里没有问题。

请注意，有*一个*与 FormsAuthTicket 到期相关的问题，并被强制重定向到 login.aspx 或类似的东西。但这与您所说的情况完全不同。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-22T18:51:23.920

我不认为我完全理解你在问什么，但就 jquery ajax 超时而言，你可以在 ajax 调用中设置本地超时。

例子：

```
$.ajax('ajax.php',{timeout: 60000},function (data) {
alert(data);
} 
```

# html - HTML中包含的相对路径？回归旧时光？

> ID：386472
> 
> 赞同：2
> 
> 时间：2008-12-22T15:09:43.773
> 
> 标签：html, relative-path

[[这个问题与this question](https://stackoverflow.com/questions/374305/javascript-css-image-reference-paths)有些相关，但答案不是......]

我一直在 HTML 和脚本语言 (PHP/ASP/JSP) 中使用相对路径来引用所有内容。我认为理由与“如果网站托管在某个奇怪的子目录中怎么办”有关。但是我的同事已经开始将绝对路径放入我们正在开发的 PHP 站点中。起初我很震惊，但后来我想，“为什么不呢？我们永远**不会**被托管在子目录中。” 如今，在根目录中托管已不是罕见的必需品。**是否仍然需要使用相对路径“编码”（实际上是标记）？**我认为现在这可能是一种过时的做法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T15:15:54.557

确实。你永远不知道你的代码最终会在哪里结束，或者出于什么目的。

假设您构建了一个新版本的站点，但为了帮助您的用户过渡，您将旧版本移动到“/classic”子目录。同样的情况经常发生在网站将在“/new”目录中托管新重新设计的测试版的地方。

第一次正确构建它不应该是一件麻烦事，总有一天你会感谢自己。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T15:16:04.807

好吧，这可能不是世界末日，但它正在建立一个你不需要的依赖项。

例如，如果您想在测试工具的子目录中放置多个版本，或者子目录有助于解决其他问题（例如将其与坚持位于根目录中的其他应用程序结合使用），您可能会找到它更难。

当然，您可能总是可以通过其他方式解决它 - 但问题是您现在必须这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T15:23:29.597

如果您使用动态生成的页面，请动态生成您的 URL。例如，对于 JSTL，使用 <c:url>。这不仅允许您在将来移动页面，还可以确保您的 URL 将被正确转义（说实话：您多久使用 & 构建查询字符串？如果您希望 W3C 验证器接受它们，你需要）。

对于我的个人网站，它使用 PHP 来构建页面，我创建了几个方法：insertPageRef()、insertCodeRef() 等等，它们可以创建有效的 HREF。因此，随着网站结构的发展，我会毫不犹豫地重新安排我的网站结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T19:45:54.777

我会说，被移动到子目录的情况相当不寻常。更常见的是托管在不同的服务器上：您在“dev.yourcompany.com”上创建您的测试站点，然后通过将其移动到“www.yourcompany.com”来上线。在这种情况下，出于显而易见的原因，您需要使用相对链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T22:22:12.187

编辑：删除了我的开头段落，因为它是基于对引用文章的错误解释。

我总是使用绝对路径，原因如下：

包含： 1\. 当您使用模板系统时，您永远不知道文档在调用包含时将具有的目录结构。2\. 如果要移动文档，您可以很确定它将是文档本身而不是包含。如果是包括在内，那么他们正在被我知道发生了什么的人所感动。除此之外，如果有人不熟悉绝对/相对路径，他们会比相对更了解绝对。

css：（以及上面的项目） 1\. 使用 Web Developer 编辑时，当您的样式表与 doc 不在同一目录中时，相关背景会消失。2\. 根据规范，当您将某些内容放到“网络”上时，它应该会一直存在。当我构建新的东西时，我会在一个新文件夹中构建它，或者使用一个新文件名来构建它，而不要理会所有旧文档。

# sql-server-2005 - SQL Server 2005 标量 UDF 性能

> ID：386476
> 
> 赞同：1
> 
> 时间：2008-12-22T15:12:17.297
> 
> 标签：sql-server-2005, performance, user-defined-functions

我有一个表，我在其中存储纬度/经度坐标，并且我想在其中进行查询，以获取在某个点的距离内的所有记录。

该表有大约 1000 万条记录，并且在 Lat/Long 字段上有一个索引

这不需要很精确。除其他外，我正在考虑 1 度长 == 1 度纬度，我知道这不是真的，但我得到的椭圆足以达到这个目的。

对于下面的示例，假设有问题的点是 [40, 140]，而我的半径（以度为单位）为 2 度。

我试过这两种方法：

* * *

1) 我创建了一个 UDF 来计算 2 点之间距离的平方，并且我在查询中运行该 UDF。

```
SELECT Lat, Long FROM Table   
WHERE (Lat BETWEEN 38 AND 42)   
  AND (Long BETWEEN 138 AND 142)  
  AND dbo.SquareDistance(Lat, Long, 40, 140) < 4 
```

我首先按正方形进行过滤，以加快查询速度并让 SQL 使用索引，然后对其进行细化以仅将落在圆圈内的记录与我的 UDF 匹配。

* * *

2）运行查询得到正方形（与以前相同，但没有最后一行），将所有这些记录提供给我的 ASP.Net 代码，并在 ASP.Net 端计算圆（同样的想法，计算平方保存 Sqrt 调用的距离，并与我的半径的平方进行比较）。

* * *

令我惊讶的是，在 .Net 端计算圆的速度比使用 UDF 快 10 倍左右，这让我相信我在使用该 UDF 时做错了什么......

这是我正在使用的代码：

```
CREATE FUNCTION [dbo].[SquareDistance] 
(@Lat1 float, @Long1 float, @Lat2 float, @Long2 float)
RETURNS float
AS
BEGIN
    -- Declare the return variable here
    DECLARE @Result float
    DECLARE @LatDiff float, @LongDiff float

    SELECT @LatDiff = @Lat1 - @Lat2
    SELECT @LongDiff = @Long1 - @Long2

    SELECT @Result = (@LatDiff * @LatDiff) + (@LongDiff * @LongDiff)

    -- Return the result of the function
    RETURN @Result

END 
```

我在这里错过了什么吗？
在 SQL Server 中使用 UDF 是否应该比向 .Net 提供比所需的多 25% 的记录要快得多，还有 DataReader 的开销、进程之间的通信等等？

我在那个 UDF 中做错了什么导致它运行缓慢？
有什么办法可以改善吗？

非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T15:28:59.460

您可以通过不声明变量并更加内联地进行计算来提高此 UDF 的性能。这可能会稍微提高性能（但可能不会太多）。

```
CREATE FUNCTION [dbo].[SquareDistance] 
(@Lat1 float, @Long1 float, @Lat2 float, @Long2 float)
RETURNS float
AS
BEGIN
    Return ( SELECT ((@Lat1 - @Lat2) * (@Lat1 - @Lat2)) + ((@Long1 - @Long2) * (@Long1 - @Long2)))
END 
```

更好的是删除该函数并将计算放在原始查询中。

```
SELECT Lat, Long FROM Table   
WHERE (Lat BETWEEN 38 AND 42)   
  AND (Long BETWEEN 138 AND 142)  
  AND ((Lat - 40) * (Lat - 40)) + ((Long - 140) * (Long - 140))  < 4 
```

调用用户定义的函数有一点点开销。通过删除该功能，您可能会获得一点性能。

另外，我鼓励你检查你的执行计划，以确保你得到你期望的索引搜索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T15:58:04.537

使用 UDF有[很多开销](http://sqlblogcasts.com/blogs/simons/archive/2008/11/03/TSQL-Scalar-functions-are-evil-.aspx)。

即使是内联编码也可能不好，因为不能使用索引，尽管这里的 BETWEEN 子句应该减少需要处理的数据。

为了扩展 G Mastros 的想法，将选择位与方形位分开。它可能对优化器有所帮助。

```
SELECT
    Lat, Long
FROM
    (
    SELECT
        Lat, Long
    FROM 
        Table   
    WHERE
        (Lat BETWEEN 38 AND 42)   
        AND
        (Long BETWEEN 138 AND 142)
    ) foo
WHERE
    ((Lat - 40) * (Lat - 40)) + ((Long - 140) * (Long - 140))  < 4 
```

编辑：您也许可以减少所涉及的实际计算。下一个想法可能会将计算的数量从 7 减少到 5

```
 ...
    SELECT
        Lat, Long,
        Lat - 40 AS LatDiff, Long - 140 AS LongDiff
    FROM 
    ...
    (LatDiff * LatDiff) + (LongDiff * LongDiff)  < 4
    ... 
```

基本上，尝试提供的 3 种解决方案，看看哪些有效。优化器可能会忽略派生表，它可能会使用它，或者它可能会生成更糟糕的计划。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T17:31:22.480

查看[这篇](http://dataeducation.com/scalar-functions-inlining-and-performance-an-entertaining-title-for-a-boring-post/)文章，该文章描述了为什么 SQL Server 中的 UDF 通常来说是个坏主意。除非您非常确定要调用 UDF 的表不会增长很多，否则请注意 UDF 函数总是在表中的所有行上调用，而不是（正如人们可能错误地猜测的那样）仅在结果集上调用。当数据库增长时，这会给您带来很大的性能损失。

非常好的文章链接详细说明了一些解决问题的方法，但实际情况是 SQL Server TSQL 方言错过了创建标量函数或确定性函数的方法（就像 Oracle 所做的那样）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T18:02:22.943

更新：

GMastros：你完全正确。在查询本身中进行数学运算比 UDF 快得多。我正在使用 SQUARE() 函数进行乘法运算，这使它更简洁一些，但性能是相同的。

但是，这样做**仍然**比在 .Net 中进行数学计算慢两倍。
我真的不能理解，但我已经达成了对我的特定情况有用的折衷方案（这很糟糕，因为我需要复制代码，但这是最好的方案，除非我们能找到一种方法来制作圆圈SQL中的计算更快）

谢谢！

# php - sIFR 还是 FLIR？

> ID：386483
> 
> 赞同：4
> 
> 时间：2008-12-22T15:16:14.917
> 
> 标签：php, seo, sifr, gd, flir

我最近遇到了整容，它是 sIFR 的替代品，我想知道那些同时使用 sIFR 和 FLIR 的人是否可以了解他们使用 FLIR 的经验。

对于那些尚未了解 FLIR 是如何做到这一点的人来说，FLIR 的工作原理是使用 JavaScript 从目标元素中获取文本，然后调用 PHP 应用程序，该应用程序使用 PHP 的 GD 呈现并返回透明的 PNG 图像，这些图像被放置为所述元素的背景，然后将溢出设置为隐藏，并应用与元素尺寸相等的填充以有效地将文本推出视图。

这是我到目前为止所想到的：

*   好的

    *   无闪光灯（+ 用于手机）
    *   FLIR 不会破坏布局
    *   图片范围从大约 1KB（比如一个 h3 句子）到 8KB（非常非常大的标题）
    *   良好的文档
    *   易于实施
    *   可定制的选择器
    *   支持 jQuery/prototype/scriptaculous/mooTools
    *   FLIR 已实施缓存
    *   浏览器自己缓存图像！
*   坏的

    *   无法选择文本
    *   处理来自所有来源的请求（您需要自行限制 FLIR 仅处理来自您的域的请求）

我主要关心的是它的扩展性如何，也就是说，在共享主机上使用 GD 库的成本是多少，有没有人有这方面的经验？其次，搜索引擎对 sIFR 或 FLIR 实现的喜爱是什么，因为知道 a) 文本没有显式隐藏 b) 仅在 JavaScript 引擎上呈现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-24T11:13:28.227

从长远来看，sIFR 应该更好地缓存，因为渲染是在客户端完成的，从一个 Flash 电影。Flash 文本更像是浏览器文本而不是图像，并且在 Flash 中设置文本样式很容易（不同的颜色、字体粗细、链接等）。您可能还更喜欢在 Flash 中呈现的文本质量，而不是由服务器端图像库呈现的质量。另一个优点是您不需要任何服务器端代码。

谷歌表示 sIFR 没问题，因为它用相同的文本替换 HTML 文本，但呈现方式不同。我想说FLIR也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T15:22:07.760

我知道使用 sIFR，并且我假设使用 FLIR 执行标记的方式与往常相同，但使用额外的类标记或类似标记，因此它可以找到要替换的文本。搜索引擎仍会将标记作为常规文本读取，因此这应该不是问题。

性能方面：如果您只是将其用于标题（并且它们不是会改变每个页面加载的标题），那么在浏览器中缓存图像，也可能在服务器磁盘上缓存应该消除对性能的任何担忧. 只需确保正确设置 HTTP 标头即可！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T20:24:07.947

由于 FLIR 是 IMAGES 而 sIFR 是闪存，我想使用 sIFR 会占用更多资源。我没有运行任何测试，但它似乎合乎逻辑。

搜索引擎搜索 sIFR 比 FLIR 更好，因为一些搜索引擎可以进入 Flash 文档的文本

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T21:28:58.310

我对 sIFR 了解不多，因为 FLIR 有效，而且我觉得它比 Flash 更好。只看[sIFR 3 beta 演示页面](http://dev.novemberborn.net/sifr3/beta2/demo/)，我注意到它似乎对浏览器首选项文本大小调整没有反应。也就是说，我在 Firefox (ctrl-+) 中增加了字体大小并重新加载页面，标题保持不变。

对于那些了解 sIFR 的人来说，这是脚本的实际限制还是他们只是在演示页面上做错了？

如果它实际上不能处理这个问题，我认为这是 FLIR 的主要优势，它确实以这种方式工作。不使用屏幕阅读器的视力受损的人可能不会意识到文本没有根据自己的喜好调整大小。

也就是说，快速浏览一下 sIFR 的 API，您应该能够使调整大小的文本在 sIFR 中工作。我认为这是一个需要修复的错误，而不是该方法的主要缺点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-20T14:03:24.673

Woff 文件是最好的解决方案。

[http://www.fontsquirrel.com/tools/webfont-generator](http://www.fontsquirrel.com/tools/webfont-generator)

# c# - 如何在 WPF 窗口中只允许统一调整大小？

> ID：386484
> 
> 赞同：18
> 
> 时间：2008-12-22T15:17:07.880
> 
> 标签：c#, .net, wpf, resize, aspect-ratio

我不希望我的窗口“仅水平”或“仅垂直”调整大小。我可以在我的窗口上设置一个可以强制执行此操作的属性，还是我可以使用一个漂亮的代码隐藏技巧？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-22T19:32:32.950

您可以使用 WPF 的 ViewBox 保留内容的纵横比，其中包含固定宽度和高度的控件。

让我们试一试。您可以更改 ViewBox 的“Stretch”属性来体验不同的效果。

这是我的屏幕截图：![在此处输入图像描述](https://i.stack.imgur.com/VZ9cd.jpg)

```
<Window x:Class="TestWPF.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">

    <Viewbox Stretch="Uniform">
        <StackPanel Background="Azure" Height="400" Width="300" Name="stackPanel1" VerticalAlignment="Top">
            <Button Name="testBtn" Width="200" Height="50">
                <TextBlock>Test</TextBlock>
            </Button>
        </StackPanel>
    </Viewbox>

</Window> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-30T07:11:55.647

您始终可以处理 WM_WINDOWPOSCHANGING 消息，这让您可以在调整大小的过程中控制窗口大小和位置（而不是在用户完成调整大小后进行修复）。

这是您在 WPF 中的操作方法，我结合了来自多个来源的代码，因此其中可能存在一些语法错误。

```
internal enum WM
{
   WINDOWPOSCHANGING = 0x0046,
}

[StructLayout(LayoutKind.Sequential)]
internal struct WINDOWPOS
{
   public IntPtr hwnd;
   public IntPtr hwndInsertAfter;
   public int x;
   public int y;
   public int cx;
   public int cy;
   public int flags;
}

private void Window_SourceInitialized(object sender, EventArgs ea)
{
   HwndSource hwndSource = (HwndSource)HwndSource.FromVisual((Window)sender);
   hwndSource.AddHook(DragHook);
}

private static IntPtr DragHook(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handeled)
{
   switch ((WM)msg)
   {
      case WM.WINDOWPOSCHANGING:
      {
          WINDOWPOS pos = (WINDOWPOS)Marshal.PtrToStructure(lParam, typeof(WINDOWPOS));
          if ((pos.flags & (int)SWP.NOMOVE) != 0)
          {
              return IntPtr.Zero;
          }

          Window wnd = (Window)HwndSource.FromHwnd(hwnd).RootVisual;
          if (wnd == null)
          {
             return IntPtr.Zero;
          }

          bool changedPos = false;

          // ***********************
          // Here you check the values inside the pos structure
          // if you want to override tehm just change the pos
          // structure and set changedPos to true
          // ***********************

          if (!changedPos)
          {
             return IntPtr.Zero;
          }

          Marshal.StructureToPtr(pos, lParam, true);
          handeled = true;
       }
       break;
   }

   return IntPtr.Zero;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T02:52:53.083

这就是我的解决方案。

您需要将其添加到您的控件/窗口标签：

```
Loaded="Window_Loaded" 
```

你需要把它放在你的代码后面：

```
private double aspectRatio = 0.0;

private void Window_Loaded(object sender, RoutedEventArgs e)
{
    aspectRatio = this.ActualWidth / this.ActualHeight;
}

protected override void OnRenderSizeChanged(SizeChangedInfo sizeInfo)
{
    if (sizeInfo.WidthChanged)
    {
        this.Width = sizeInfo.NewSize.Height * aspectRatio;
    }
    else
    {
        this.Height = sizeInfo.NewSize.Width * aspectRatio;
    }
} 
```

我尝试了 Viewbox 技巧，但我不喜欢它。我想将窗口边框锁定为特定大小。这是在窗口控件上测试的，但我认为它也可以在边框上工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-21T13:38:25.673

在代码示例中：

```
if (sizeInfo.WidthChanged)     
{         
    this.Width = sizeInfo.NewSize.Height * aspectRatio;    
}     
else     
{         
    this.Height = sizeInfo.NewSize.Width * aspectRatio; 
} 
```

我相信第二个计算应该是：

```
this.Height = sizeInfo.NewSize.Width * (1/aspectRatio); 
```

我在“SizeChanged”事件处理程序中对这项工作进行了修改。因为我希望宽度成为控制维度，所以我只是通过计算表单来强制高度与之匹配：

```
if (aspectRatio > 0)
// enforce aspect ratio by restricting height to stay in sync with width.  
this.Height = this.ActualWidth * (1 / aspectRatio); 
```

您可能会注意到检查 aspectRatio > 0，... 我这样做是因为我发现它倾向于在“Load”方法甚至分配 aspectRatio 之前调用我的处理程序来调整大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T18:37:20.797

您可以尝试复制我经常在 Flash Video 网站上看到的效果。它们允许您以任何您喜欢的方式扩展浏览器窗口，但仅拉伸演示区域以使其适合最小的高度或宽度。

例如，如果您垂直拉伸窗口，您的应用程序将不会调整大小。它会简单地在显示区域的顶部和底部添加黑条并保持垂直居中。

WPF 可能会也可能不会；我不知道。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-15T22:17:26.593

这可能有点晚了，但你可以简单地将它放在你的代码后面......

```
Private Sub UserControl1_SizeChanged(ByVal sender As Object, ByVal e As System.Windows.SizeChangedEventArgs) Handles Me.SizeChanged
    If e.HeightChanged Then
        Me.Width = Me.Height
    Else
        Me.Height = Me.Width
    End If
End Sub 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T01:00:54.220

我曾期望您可以使用值转换器将宽度与高度双向绑定以保持纵横比。将纵横比作为转换器参数传递将使其更通用。

所以，我尝试了这个 - 首先没有转换器的绑定：

```
<Window 
    ...
    Title="Window1" Name="Win" Height="500" 
    Width="{Binding RelativeSource={RelativeSource self}, 
                    Path=Height, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
    <StackPanel>
        <TextBlock>Width:</TextBlock>
        <TextBlock Text="{Binding ElementName=Win, Path=Width}" />
        <TextBlock>Height:</TextBlock>
        <TextBlock Text="{Binding ElementName=Win, Path=Height}" />
    </StackPanel>    
</Window> 
```

奇怪的是，绑定的行为好像是单向的，并且报告的窗口宽度（如 TextBlock 中所示）与它在屏幕上的大小不一致！

这个想法可能值得追求，但这种奇怪的行为需要首先解决。

希望有帮助！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-04T02:46:45.243

也许为时已晚，但我从 Mike O'Brien 博客中找到了解决方案，而且效果非常好。 [http://www.mikeobrien.net/blog/maintaining-aspect-ratio-when-resizing/](http://www.mikeobrien.net/blog/maintaining-aspect-ratio-when-resizing/) 以下是他博客中的代码：

```
<Window ... SourceInitialized="Window_SourceInitialized" ... >
    ...
Window>

public partial class Main : Window
{
    private void Window_SourceInitialized(object sender, EventArgs ea)
    {
        WindowAspectRatio.Register((Window)sender);
    }
    ...
}

internal class WindowAspectRatio
{
    private double _ratio;

    private WindowAspectRatio(Window window)
    {
        _ratio = window.Width / window.Height;
        ((HwndSource)HwndSource.FromVisual(window)).AddHook(DragHook);
    }

    public static void Register(Window window)
    {
        new WindowAspectRatio(window);
    }

    internal enum WM
    {
        WINDOWPOSCHANGING = 0x0046,
    }

    [Flags()]
    public enum SWP
    {
        NoMove = 0x2,
    }

    [StructLayout(LayoutKind.Sequential)]
    internal struct WINDOWPOS
    {
        public IntPtr hwnd;
        public IntPtr hwndInsertAfter;
        public int x;
        public int y;
        public int cx;
        public int cy;
        public int flags;
    }

    private IntPtr DragHook(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handeled)
    {
        if ((WM)msg == WM.WINDOWPOSCHANGING)
        {
            WINDOWPOS position = (WINDOWPOS)Marshal.PtrToStructure(lParam, typeof(WINDOWPOS));

            if ((position.flags & (int)SWP.NoMove) != 0 || 
                HwndSource.FromHwnd(hwnd).RootVisual == null) return IntPtr.Zero;

            position.cx = (int)(position.cy * _ratio);

            Marshal.StructureToPtr(position, lParam, true);
            handeled = true;
        }

        return IntPtr.Zero;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-14T13:47:17.593

我得到了一种不依赖于 Windows 平台特定 API 的方法，也具有可接受的用户体验（拖动窗口时不会晃动）。它使用计时器在 0.1 秒后调整窗口大小，因此用户不会看到它抖动。

```
public partial class MainWindow : Window
{
    private DispatcherTimer resizeTimer;
    private double _aspectRatio;
    private SizeChangedInfo? _sizeInfo;

    public MainWindow()
    {
        InitializeComponent();
        _aspectRatio = Width / Height;
        resizeTimer = new DispatcherTimer();
        resizeTimer.Interval = new TimeSpan(100*10000); // 0.1 seconds
        resizeTimer.Tick += ResizeTimer_Tick;
    }

    private void ResizeTimer_Tick(object? sender, EventArgs e)
    {
        resizeTimer.Stop();
        if (_sizeInfo == null) return;
        var percentWidthChange = Math.Abs(_sizeInfo.NewSize.Width - _sizeInfo.PreviousSize.Width) / _sizeInfo.PreviousSize.Width;
        var percentHeightChange = Math.Abs(_sizeInfo.NewSize.Height - _sizeInfo.PreviousSize.Height) / _sizeInfo.PreviousSize.Height;

        if (percentWidthChange > percentHeightChange)
            this.Height = _sizeInfo.NewSize.Width / _aspectRatio;
        else
            this.Width = _sizeInfo.NewSize.Height * _aspectRatio;
    }

    protected override void OnRenderSizeChanged(SizeChangedInfo sizeInfo)
    {
        _sizeInfo = sizeInfo;
        resizeTimer.Stop();
        resizeTimer.Start();
        base.OnRenderSizeChanged(sizeInfo);
    }
} 
```

# asp.net - 捕获从 ASP.NET 生成的 HTML

> ID：386487
> 
> 赞同：18
> 
> 时间：2008-12-22T15:18:11.090
> 
> 标签：asp.net, html, logging, asp.net-2.0, render

如何最好地捕获由 aspx 页面呈现的 HTML（在我的实例中，用于日志记录）？

我不想使用 Response.Write 写回页面，因为它会打乱我的网站布局。

使用 Response.OutputStream 或 Response.Output 的流会导致 ArgumentException（{System.ArgumentException: Stream was not readable.）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-22T16:21:59.853

好问题，我不得不尝试看看是否可以创建一个 HttpModule 来执行您所描述的操作。

我没有任何运气尝试从响应流中读取，但是使用 ResponseFilter 给了我一种捕获内容的方法。

以下代码似乎工作得很好，我想也许您可以使用该代码作为基础。但请记住，这只是我快速拼凑的东西，还没有经过任何测试。因此，如果没有适当的审查/测试等，请勿在任何生产环境中使用它。随意评论它虽然;）

```
public class ResponseLoggerModule : IHttpModule
{
    private class ResponseCaptureStream : Stream
    {
        private readonly Stream _streamToCapture;
        private readonly Encoding _responseEncoding;

        private string _streamContent;
        public string StreamContent
        {
            get { return _streamContent; }
            private set
            {
                _streamContent = value;
            }
        }

        public ResponseCaptureStream(Stream streamToCapture, Encoding responseEncoding)
        {
            _responseEncoding = responseEncoding;
            _streamToCapture = streamToCapture;

        }

        public override bool CanRead
        {
            get { return _streamToCapture.CanRead; }
        }

        public override bool CanSeek
        {
            get { return _streamToCapture.CanSeek; }
        }

        public override bool CanWrite
        {
            get { return _streamToCapture.CanWrite; }
        }

        public override void Flush()
        {
            _streamToCapture.Flush();
        }

        public override long Length
        {
            get { return _streamToCapture.Length; }
        }

        public override long Position
        {
            get
            {
                return _streamToCapture.Position;
            }
            set
            {
                _streamToCapture.Position = value;
            }
        }

        public override int Read(byte[] buffer, int offset, int count)
        {
            return _streamToCapture.Read(buffer, offset, count);
        }

        public override long Seek(long offset, SeekOrigin origin)
        {
            return _streamToCapture.Seek(offset, origin);
        }

        public override void SetLength(long value)
        {
            _streamToCapture.SetLength(value);
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            _streamContent += _responseEncoding.GetString(buffer);
            _streamToCapture.Write(buffer, offset, count);
        }

        public override void Close()
        {
            _streamToCapture.Close();
            base.Close();
        }
    }

    #region IHttpModule Members

    private HttpApplication _context;
    public void Dispose()
    {

    }

    public void Init(HttpApplication context)
    {
        _context = context;

        context.PreRequestHandlerExecute += new EventHandler(context_PreRequestHandlerExecute);
        context.PreSendRequestContent += new EventHandler(context_PreSendRequestContent);
    }

    void context_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        _context.Response.Filter = new ResponseCaptureStream(_context.Response.Filter, _context.Response.ContentEncoding);
    }

    void context_PreSendRequestContent(object sender, EventArgs e)
    {
        ResponseCaptureStream filter = _context.Response.Filter as ResponseCaptureStream;

        if (filter != null)
        {
            string responseText = filter.StreamContent;

            // Logging logic here
        }
    }

    #endregion
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T15:23:16.493

许多负载测试器允许您记录生成的 HTTP 响应，但请记住，对于 ASP.NET，这些可能是一些非常大的日志文件。

编辑：根据 Tom Jelen 的代码，Response.Filter 旨在提供这种监督，否则 Response.Outputstream 是不可读的。

编辑 2：对于页面而不是 HTTPModule

```
public class ObserverStream : Stream
{
  private byte[] buffer = null;
  private Stream observed = null;

  public ObserverStream (Stream s)
  {
    this.observed = s;
  }

  /* important method to extend #1 : capturing the data */
  public override void Write(byte[] buffer, int offset, int count)
  {
    this.observed.Write(buffer, offset, count);
    this.buffer = buffer; //captured!
  }

  /* important method to extend #2 : doing something with the data */
  public override void Close()
  {
    //this.buffer available for logging here!
    this.observed.Close();
  }

  /* override all the other Stream methods/props with this.observed.method() */

  //...

} 
```

并在您的 Page_Load 中（或在您的回复被写之前）

```
Response.Filter = new ObserverStream(Response.Filter); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T15:35:11.353

向您自己的服务器发出服务器端 XMLHTTP 请求的一种方法。获取结果并将其保存到文件或数据库中。

或者，您可以在客户端上使用 AJAX，获取结果并将其 POST 回服务器。

# css - 使用画布调整图像大小 - css 溢出问题

> ID：386490
> 
> 赞同：2
> 
> 时间：2008-12-22T15:18:58.560
> 
> 标签：css, canvas, overflow

我正在开发一个 JavaScript 图像大小调整功能，它依赖于 IE only DXImageTransform 插件。

也想解决现代浏览器问题，我试了一下画布，结果非常好。

但是，我在调整大小函数中遇到了一个问题，如下所示：

```
函数调整大小（oObj，flMultiplier）
{       
  var canvas = document.getElementById('canvas');
  var canvasContext = canvas.getContext('2d');

  oObj.style.visibility = '隐藏';

  canvasContext.clearRect(0,0,canvas.width,canvas.height); // 清除画布
  canvasContext.fillStyle = 'rgba(0,0,0,0.4)';
  canvasContext.scale(flMultiplier,flMultiplier);
  canvasContext.drawImage(oObj, 0, 0);
}

```

如果我的图像变得比画布项目大，那么人们只会看到图像的一部分，这很糟糕。

我试图在运行时调整画布大小，但如果影响调整大小图像的显示。

所以我最终声明了一个*大*的画布元素，这很好，除了我的网页的 css 溢出是在我最大的元素上调整的，而不是在我调整大小的图像上，这很痛苦。

所以我想有两种方法可以解决我的问题：

1.  尝试从溢出方案中排除大画布元素
2.  调整大小时尝试更新画布元素大小（我可能在那里遗漏了一些东西）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T23:34:59.993

我自己没有尝试过，但也许你可以从 Dom 中创建一个画布元素，使用`document.createElement`. 它可以是任意大小而不会干扰显示。

现在，我缺乏上下文（为什么要以这种方式调整图像大小而不是使用宽度和高度属性，以及其他问题）所以也许我错过了重点。

# unit-testing - TDD：您为单元测试公开了哪些方法？

> ID：386493
> 
> 赞同：17
> 
> 时间：2008-12-22T15:20:16.577
> 
> 标签：unit-testing, testing, tdd

我从未完全理解 TDD 的一个方面。

假设有人要求您实现一个简单的 Stack 对象。如果您正确地完成了设计，您将获得一个非常简单且干净的 API。假设`push()`：`pop()`和`isEmpty()`。除此之外的任何事情都会过度扼杀需求，并让用户有太多空间来弄乱您的代码。

所以现在让我们假设你想对你的代码进行单元测试。如果你所有的公共方法都只是上面显示的三个，你怎么做呢？这些方法只会让你的测试到目前为止。

所以要么你添加私有方法，这对你没有帮助，因为它们对你的单元测试用例不可见。或者，您将这些方法公开，然后您努力工作的极简 API 就出现了。现在用户会弄乱你的 Stack 并且 bug 肯定会出现。

您如何处理开放公共测试方法与干净简单的 API 的困境？

**编辑：**只是为了指出正确的方向，获得技术指针会很好（例如“使用此黑客公开私有方法”等......）但我更感兴趣的是更通用的答案这两个概念更重要，以及你如何处理这个主题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-22T15:27:15.753

1.  测试功能；这通常意味着测试公共接口 - 因为不应该通过公共接口访问所有功能吗？如果它们不是，那么它们就不是特征！这可能有例外，但我想不出任何例外。

2.  测试公共接口；任何不是从公共接口直接或间接调用的方法都是*不必要*的。它们不仅不需要测试，而且根本不需要存在。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-22T15:28:07.153

你应该看看那个问题：**[你测试私有方法吗？](https://stackoverflow.com/questions/105007/do-you-test-private-method)**.

> 为了不破坏封装，我发现私有方法非常庞大、复杂或重要到需要它自己的测试，我只是把它放在另一个类中并在那里公开（方法对象）。然后我可以轻松地测试现在存在于它自己的类上的以前私有但现在公共的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T15:57:29.967

使用您的 Stack 示例，您确实不需要公开任何内部工作来对其进行单元测试。重申其他人所说的话，您应该随意拥有尽可能多的私有方法，但只能通过您的公共 API 进行测试。

```
[Test]
public void new_instance_should_be_empty()
{
  var stack = new Stack();

  Assert.That(stack.IsEmpty(), Is.True);
}

[Test]
public void single_push_makes_IsEmpty_false()
{
  var stack = new Stack();

  stack.Push("first");

  Assert.That(stack.IsEmpty(), Is.False);
} 
```

使用推送和弹出的组合，您可以模拟 Stack 类的所有行为，因为这是用户与之交互的唯一方式。您不需要任何技巧，因为您应该只测试其他人可以使用的东西。

```
[Test]
public void three_pushes_and_three_pops_results_in_empty_stack()
{
  var stack = new Stack();

  stack.Push("one");
  stack.Push("two");
  stack.Push("three");
  stack.Pop();
  stack.Pop();
  stack.Pop();

  Assert.That(stack.IsEmpty(), Is.True);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T15:23:29.410

有时我会将原本私有的方法放入包级别 (Java) 或内部 (.NET) 方法中，通常带有注释或注释/属性来解释原因。

然而，大多数时候，我避免这样做。公共 API 不允许您在堆栈案例中进行哪些测试？如果用户可以看到错误并且他们只使用公共 API，那么是什么阻止您进行相同的调用？

我公开其他私有方法的时间是，它可以更容易地单独测试一组复杂步骤中的一部分 - 如果单个方法调用非常“笨重”，那么单独测试每个步骤可能会非常有帮助，甚至尽管这些步骤对普通用户不可见。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T15:38:58.630

正确的 TDD 完全是关于可以通过公共接口测试的测试行为......如果有任何私有方法，那么这些方法应该由任何公共接口间接测试......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T15:49:35.893

使用 TDD，您的所有代码都应该可以从您的公共接口访问：

*   首先，您为您的功能编写测试。
*   然后你编写最少数量的代码让你的测试通过。这表明您的功能已实现。

如果某些代码没有被覆盖，这意味着要么这个代码没用（删除它并再次运行你的测试），要么你的测试不完整（一些特性已经实现但没有被测试明确识别）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T15:29:22.783

您可以使用 Reflection 进行私有测试，但以后会很痛苦。我认为您需要将测试放在同一个程序集（或包）中并尝试使用 Internal。这样你就有了一些保护，你可以测试你想要测试的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T16:42:39.953

如果您的私有方法没有被公共 API 测试方法间接测试并且需要测试，那么我会将您的主类委托给另一个辅助类。

```
public Stack {
    public ... push(...) {...}
    public ... pop(...) {...}
    public ... isEmpty(...) {...}

    // secondary class
    private StackSupport stackSupport;
    public StackSupport getStackSupport() {...}
    public void setStackSupport(StackSupport stackSupport) {...}
}

public StackSupport {
    public ...yourOldPrivateMethodToTest(...) {...}
} 
```

那么您的私有方法是另一个类中的公共方法。您可以在另一个类测试中测试该公共方法。:-)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-22T16:21:09.433

使用 TDD 编码时，我为对象创建公共接口 API。这意味着在您的示例中，我的类实现的接口只有`push()`,`pop()`和`isEmpty()`.

**然而**，通过调用它们来测试这些方法本身并不是单元测试*（更多内容在本文末尾）*，因为它们很可能测试多个内部方法的合作，这些方法共同产生所需的结果，这就是你的问题是：这些方法应该是私有的吗？

我的回答是否定的，使用`protected`（或您选择的语言中的等价物）代替`private`这意味着如果您的项目和测试 POM 的结构相似，则测试套件类可以在实际类中看到，因为它们是几乎在同一个文件夹中。这些可以被认为是单元测试：您正在测试类本身的功能块，而不是它们的合作。

至于测试单独的接口/API 方法，这样做当然也很重要，我并不对此提出异议，但它们介于[单元测试](http://en.wikipedia.org/wiki/Unit_testing)和[验收测试](http://en.wikipedia.org/wiki/Acceptance_test)的模糊线之间。

在我看来，这里要记住的最重要的事情是，单元测试会告诉你一个方法是否行为不端，验收测试会告诉你多个方法/类的合作是否行为不端，集成测试会告诉你多个系统的合作是否行为不端。

# vb.net - 您如何确定 Char 是否是来自 AZ 的信函？

> ID：386495
> 
> 赞同：3
> 
> 时间：2008-12-22T15:21:25.263
> 
> 标签：vb.net

您如何确定一个字母是否在 AZ 或数字 0-9 的范围内？我们收到一些损坏的数据“I_999Š=ÄÖÆaðøñòòñ”。

我以为我可以使用 Char.IsLetterOrDigit("Š") 来识别来自“I_999Š”的损坏数据，但出乎意料的是，这将返回 true。我需要抓住这个，有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-22T19:23:14.323

我不禁注意到每个人似乎都忽略了真正的问题：您的数据“损坏”似乎是一个明显的字符编码问题。因此，无论您如何处理数据，您都将（错误）对待症状并忽略根本原因。

具体来说，您似乎试图将接收到的二进制 BYTES 解释为 ASCII 文本，而这些 BYTES 几乎可以肯定是用来表示编码为非 ASCII 的文本。

您应该找出适用于您收到的文本字符串的字符编码。然后，您应该在应用适当的字符编码转换时读取该数据。

您应该阅读 Joel Spolsky 的文章，该文章强调[“没有纯文本这样的东西”。](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T15:26:20.137

那么有两个快速的选择。第一种是使用正则表达式，第二种是使用 Asc() 函数来确定 Ascii 值是否在那些允许的字符范围内。我个人会为此使用 Asc() 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T15:32:02.967

```
For Each m As Match In Regex.Matches("I_999Š=ÄÖÆaðøñòòñ", "[^A-Z0-9]")
    '' Found a bad character
Next 
```

或者

```
For Each c As Char In "I_999Š=ÄÖÆaðøñòòñ"
    If Not (c >= "A"c AndAlso c <= "Z"c OrElse c >= "0"c AndAlso c <= "9"c) Then
        '' Found a bad character
    End If
Next 
```

* * *

**编辑：**

这个答案有什么*问题*需要两次匿名否决吗？说出来，我会解决的。我注意到我遗漏了“然后”（现在已修复），但我打算将其作为伪代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T16:23:52.907

应该只是：

```
if (Regex.IsMatch(input, "[A-Za-z0-9]"))
{
    // do you thang
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-11T18:30:08.350

确保您处理可打印的 ASCII 字符的唯一方法，无论程序中的编码如何，甚至在相关字符串中是检查每个字符的 32 到 126 之间的合法值（127 = 删除 - 实际上不是“可打印”字符）。

IE

```
Public Module StringExtensions
<Extension()>

Public Function IsASCII(inString As String, Optional bPrintableOnly As Boolean = True) ' 127 = Delete (non-printing) < 32 = control characters also, non-printing

Dim lowerLimit As Int32 = If(bPrintableOnly, 32, 0)
Dim upperLimit As Int32 = If(bPrintableOnly, 127, 128)

For Each ch In inString.ToCharArray()
  If Not Asc(ch) < upperLimit OrElse Asc(ch) < lowerLimit Then
    Return False
  End If
Next

Return True

End Function
End Module 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T15:34:37.967

您可以使用正则表达式来过滤掉坏字符...（如果您只需要检测它，请改用 Regex.IsMatch）

```
str = Regex.Replace(str, "[^A-Za-z0-9]","", RegexOptions.None); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-10T08:30:22.870

使用 Asc(char) 函数。它返回一个从 0 到 255 的 ANSI 字符代码。检查[ANSI 字符代码图表](https://msdn.microsoft.com/en-us/library/aa245259(v=vs.60).aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-10T08:42:17.163

试试下面的代码：

```
NOT isNumeric(char) 
```

# c# - 初始化具有未知类型的通用对象

> ID：386500
> 
> 赞同：3
> 
> 时间：2008-12-22T15:22:27.087
> 
> 标签：c#, generics, types

如何初始化包含类型可以不同的通用对象的列表？

例如，我有以下内容：

```
this.Wheres = new List<Where<>>(); 
```

如您所知， <> 不是有效的语法。但是，有时传递给 Where 的类型是字符串，有时是 DateTime 等。我尝试使用 object 作为初始化类型，但这也不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T15:26:48.903

好吧，您还没有真正给出足够的上下文（什么是 SqlWhere？），但通常您会使用类型参数：

```
public class Foo<T>
{
   private IList<T> wheres;

   public Foo()
   {
       wheres = new List<T>();
   }
} 
```

但是，如果您希望单个集合包含多个不相关类型的值，则必须使用`List<object>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T15:26:14.740

```
this.Wheres = new List<Object>(); 
```

# apache-flex - 如何在 ActionScript 类中实现数据绑定？

> ID：386506
> 
> 赞同：2
> 
> 时间：2008-12-22T15:24:45.290
> 
> 标签：apache-flex, data-binding, actionscript, mxml, cairngorm

我的 ActionScript 组件中的绑定值有问题。我基本上想将组件中aa变量的值设置为模型中的值，并在模型值更新时自动更新组件变量。我认为我只是不完全理解数据绑定在 Flex 中是如何工作的——在使用 MXML 组件时这不是问题，但是在使用 ActionScript 类时，绑定不起作用。

这是我正在使用的代码，其中的值没有绑定：

```
package
{
    public class Type1Lists extends TwoLists
    {
        public function Type1Lists()
        {
            super();

            super.availableEntities = super.composite.availableType1Entities;

            super.selectedEntities = super.composite.selectedType1Entities;
        }
    }
}

package
{
    public class Type2Lists extends TwoLists
    {
        public function Type2Lists()
        {
            super();

            super.availableEntities = super.composite.availableType2Entities;

            super.selectedEntities = super.composite.selectedType2Entities;
        }
    }
}

/* TwoLists.mxml */
<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
        <![CDATA[
            public var __model:ModelLocator = ModelLocator.getInstance();

            public var composite:Composite = 
                __model.selectedComposite;

            [Bindable]
            public var availableEntities:ArrayCollection;

            [Bindable]
            public var selectedEntities:ArrayCollection;
        ]]>
    </mx:Script>

    <mx:List id="availableEntitiesList" dataProvider="{availableEntities}" />

    <mx:List id="selectedEntitiesList" dataProvider="{selectedEntities}" />
</mx:HBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T16:03:21.343

要通过代码使用绑定，您应该使用 mx.binding.utils.*

看看 BindingUtils.bindProperty 和 bindSetter 方法。

此外，要小心手动数据绑定，它可能会导致内存泄漏。为了避免它们，保存由 bindProperty 和 bindSetter 返回的 ChangeWatcher，并在不再使用时调用 watcher 的 unwatch 方法（即在 dipose 或析构函数方法中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T16:18:14.277

您需要将 [Bindable] 标签添加到类本身（使所有属性可绑定）或您希望成为 [Bindable] 的属性。在 MXML 中将属性或对象标记为 [Bindable] 是不够的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T22:27:29.023

为了解决这个问题，我简单地将类转换为 MXML 组件，并为我的 ModelLocator 添加了一个私有变量。

```
/* Type1Lists.mxml */
<?xml version="1.0" encoding="utf-8"?>
<TwoLists xmlns:mx="http://www.adobe.com/2006/mxml" 
    xmlns="*" 
    availableEntities="{__model.selectedComposite.availableType1Entities}" 
    selectedEntities="{__model.selectedComposite.selectedType1Entities}">
    <mx:Script>
        <![CDATA[
            import model.ModelLocator;

            [Bindable]
            private var __model:ModelLocator = ModelLocator.getInstance();
    </mx:Script>
</TwoLists>

/* Type2Lists.mxml */
<?xml version="1.0" encoding="utf-8"?>
<TwoLists xmlns:mx="http://www.adobe.com/2006/mxml" 
    xmlns="*" 
    availableEntities="{__model.selectedComposite.availableType2Entities}" 
    selectedEntities="{__model.selectedComposite.selectedType2Entities}">
    <mx:Script>
        <![CDATA[
            import model.ModelLocator;

            [Bindable]
            private var __model:ModelLocator = ModelLocator.getInstance();
    </mx:Script>
</TwoLists> 
```

# google-maps - Google Maps API：获取海平面上的位置

> ID：386512
> 
> 赞同：2
> 
> 时间：2008-12-22T15:26:28.780
> 
> 标签：google-maps

有没有办法使用 Google Maps API 从给定位置获取海平面上的位置？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T15:49:41.527

我不确定，但我认为 Google Maps 在其 API 中没有提供这样的功能。但是还有**其他免费服务**可以很好地集成到 Google 地图中：

*   [拓扑编码](http://topocoding.com/)（[此处](http://freegeographytools.com/2007/altitudes-and-terrain-profiles-in-google-maps)为示例）
*   [GeoNames.org](http://www.geonames.org/)（[此处](http://www.daftlogic.com/sandbox-google-maps-find-altitude.htm)为示例）
*   [EarthTools.org](http://www.earthtools.org/webservices.htm)（[英国伯明翰的 XML 结果](http://www.earthtools.org/height/52.4822/-1.8946)示例）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-02T10:42:46.327

[Google 现在提供此服务，请查看参考文档](http://code.google.com/apis/maps/documentation/javascript/reference.html)中的 google.maps.ElevationResult 对象规范

# c++ - 需要一个 c++ 编译器来处理库（boost，...）

> ID：386517
> 
> 赞同：1
> 
> 时间：2008-12-22T15:27:39.900
> 
> 标签：c++, compiler-construction

目前我正在使用 Visual Studio 用 C++ 编写代码。但它似乎太重了，我决定换另一个，最好是免费的，对系统资源（当然我是指内存）没有那么严格，因为 VS 来学习库，如 Boost 和 Qt。你建议什么编译器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T15:46:04.153

我建议从命令行使用 Visual Studio 的编译器。您可以获得相同的高质量编译器，而无需占用资源的 IDE。

尽管 IDE 也相当不错，并且可能值得它使用的资源。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T16:00:50.147

Code::blocks 正是您所追求的。你可以在这里下载：http: [//www.codeblocks.org/downloads/5](http://www.codeblocks.org/downloads/5)

选择捆绑了 mingw 编译器的版本（GCC 的 Windows 端口）。您可以根据需要在它和 VC++ 编译器之间切换。

Code::Blocks 拥有你想要的所有东西，调试器集成、代码完成、类浏览器、待办事项列表等。它甚至可以导入可视化 C++ 项目。

不要使用已经推荐的 Dev C++。这是非常非常古老和过时的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T15:32:55.007

如果您想学习 unix 工具，请下载并安装[cygwin](http://www.cygwin.com)这是一套很好的工具，但完整安装需要 5 或 6 个演出，因为包含的内容太多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T16:01:39.223

总有[数字火星](http://www.digitalmars.com/download/dmcpp.html)。此外，您可以免费下载 Microsoft [WDK](http://www.microsoft.com/whdc/devtools/WDK/default.mspx) ，它附带了他们的 C/C++ 编译器和命令行构建系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T15:29:50.567

您将很难找到与 MS VS 一样强大的 IDE。它的功能非常丰富。

但是，如果您只想要命令行编译和链接，它也可以这样做。

GCC 也是一种选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-22T15:52:16.043

请注意，您不需要其他编译器或 IDE 即可使用 boost 库。我不会用任何其他 IDE/编译器替换 Visual Studio，至少在 Windows 上不会。安装 Cygwin 或 SUA（比 Cygwin 更好，更接近 Windows 内核）只会让你想要达到的目标很痛苦。

尝试通过禁用不必要的东西来最小化内存使用，保持开源文件的数量很小，使用文档资源管理器的替代品来寻找帮助（你的 msdn 上的浏览​​器会做）。除此之外，我不会将几十兆字节的内存称为高使用率。只要它不会减慢您的系统速度，就没有真正的问题。

一个更好的主意是升级你的电脑，而不是用你不知道的东西来代替强大的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T15:54:38.800

说真的，在 Windows 上除了 Ms 的编译器没有真正的替代品。如果您无法使用 Visual Studio 或者您只是在做业余爱好者的工作，那么其他所有的都可以。Cygwin 可能很难处理。

如果您不想要其他人建议的 IDE，请使用命令行编译器。

我发现 VS 非常适合做 Boost + Qt 工作。特别是如果您有 Qt + VS 集成工具。你会得到一个 GUI 设计师和受人尊敬的 Qt 项目管理工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T16:19:31.887

如果您正在寻找一个使用比 MS 更少系统资源的编译器，您可能会发现大多数能够在 Boost 中编译大部分或几乎所有内容的现代编译器都会占用大量系统资源，无论是处理器使用和内存消耗。在某种程度上，这只是 C++ 课程的标准。

也就是说，如果我正在编写可移植代码，我确实喜欢使用第二个编译器，因为当您可以确保代码在不同的环境中编译时，解决可移植性问题会容易得多。如果你想在 Windows 上做所有这些，[Cygwin](http://www.cygwin.com/)值得一看。然而，您使用 Cygwin 获得的 GCC 似乎并不完全符合您的要求。

前面提到的[Digital Mars 编译器](http://www.digitalmars.com/)非常值得一看，Walter Bright（他们背后的人）已经编写 C++ 编译器很长时间了，它们非常好。自九十年代初以来，我就断断续续地使用它们，而且我一直对它们感到满意。更不用说它们似乎总是比微软的产品快得多，但我最近没有任何测量数据来支持这一点。

归根结底，Windows 上的大多数第三方工具供应商都倾向于以 MS 环境为目标，因此，如果您正在专业地编写 C++ 代码并且需要/想要泄漏检测器等工具，那么您几乎需要能够使用MS 编译器，即使它们不是您的主要开发环境。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T17:28:45.990

我建议，Netbeans.org **NetBeans IDE ，下载 Cygwin，按照**[http://www.netbeans.org](http://www.netbeans.org)中的 一个教程在 Netbeans IDE 进行 C++ 配置，只需 2 个步骤.. 并且你可以自动完成（比 VS 更快）

课程和所有......你想要xD

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-04T17:38:23.423

需要提到 DevCpp。它是 gcc 编译器的简单 UI 包装（哦，天哪，这听起来像是重言式）。它提供了轻量级的 IDE，但不太稳定（因此，它的 IntelliSense 有点错误）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-04T17:57:17.233

如果你使用 Qt 为什么不使用他们的 IDE，QtCreator，有编译器、调试器和 GUI 设计器。所有这些都包含在一个不错的软件包中，可在 Windows、Mac 和 Linux 上运行。

在我看来，它比 Code::Blocks （也基于 MinGW/GCC）更好。

# ide - 录制宏的 IDE 优势是什么？

> ID：386520
> 
> 赞同：4
> 
> 时间：2008-12-22T15:28:08.417
> 
> 标签：ide, macros

正如标题所说，我看到很多编辑将宏录制作为一项功能吹捧，但我自己却找不到利用这些功能的方法。那么你能用它做什么呢？您可以记录鼠标移动和/或击键的类型？对外面的人真的有那么大的帮助吗？具体来说，我处理具有许多内置“填充”功能的 Eclipse，所以我真的看不出有什么优势。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T15:36:18.870

我一直在使用它们。比如说，我想在一个列表中向下，缩进 4 并添加一个“|*”。在 EMACS 中，我点击`C-x (`开始录制，执行一个示例行以查看它是我想要的，`C-n C-a`以移动到下一行结束，并以 . 结束宏`C-x )`。然后`C-x e`逐行重复，`C-u` *number* `C-x e`重复多次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T15:40:27.177

取决于你在做什么以及你使用什么语言。举个简单的例子，现在我正在使用一个包含许多查询的 Visual Basic .NET 应用程序。我通常在 Toad 中使用查询来完成所有工作，但 Visual Basic .NET 在处理长字符串时有一个烦人的语法，即：

```
Public Const SelectData As String = _
"SELECT * " & _
"FROM myTable " & _ 
"WHERE myField = :SOMETHING" 
```

由于我真的不喜欢在将查询从代码中复制出来或将它们粘贴回去时对其进行编辑，因此我有一些宏会自动格式化或从它们中删除格式。

此外，一些宏可用于自动执行您在工作时需要在 IDE 周围执行的常见任务。您看到自己经常执行的任何命令序列都可以变成宏，只需单击一下即可执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T15:31:52.967

Waaaay back 我使用宏来制作函数标题/注释。除此之外，我没有使用过它们。

基本上你可以“自动化”你经常做的乏味的事情，这些事情没有内置的方法来完成你经常做的任务。这是一种灵活的方式，可以赋予人们大量权力，使他们能够更有效地工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T15:36:41.287

我发现它在 microsoft excel 中非常有用。无需查看文档以查找我需要调用的每个对象和函数，我可以记录一个执行我想要的大部分操作的宏，获取该代码并对其进行修改以给予我更好的控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T15:38:32.267

在 Visual Studio 中，我将宏用于许多不同的目的。调试 Windows 服务时最有价值之一。我可以使用宏引擎启动然后附加到 Windows 服务，只需单击一个按钮。

此外，有时我使用需要分解为代码的自定义定义——有点像 C/C++ 宏。

科尔比非洲

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T16:38:25.623

我也不在 Eclipse 中使用它们。原因如下：

1.  Eclipse 有许多强大的内置函数和重构。因此，对于代码，它没有必要。

2.  Eclipse 宏不是那么好。您可以记录它们，但很难调整它们并完全按照您的意愿行事。

3.  宏在修改非代码文件等方面变得更加有用。为此，我倾向于使用 vim 之类的东西。此外，您必须实际练习使用宏来识别它们何时会有所帮助。

# c# - 编写自己的 IOC 容器

> ID：386535
> 
> 赞同：30
> 
> 时间：2008-12-22T15:34:56.343
> 
> 标签：c#, inversion-of-control, ioc-container

有没有人用 C# 编写过自己的 IOC 容器？还是绝大多数人都使用各种框架，例如 Spring。各自的优缺点是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-22T16:11:24.167

自己编写是一个很好的练习，但最终您可能想要使用现有的容器。您可以从15 行代码中[的这一行开始。](http://ayende.com/Blog/archive/2007/10/20/Building-an-IoC-container-in-15-lines-of-code.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-12T11:31:06.930

我喜欢[Ken Egozi 的这个 33 行容器实现，灵感来自 Ayende 的 15 班轮](http://kenegozi.com/blog/2008/01/17/its-my-turn-to-build-an-ioc-container-in-15-minutes-and-33-lines)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T15:49:21.683

有人用 C# 写过一个：http: [//ninject.org/](http://ninject.org/)。

它是开源的，因此您可以获取代码并看看这个人是如何做到的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-05T20:46:51.093

我用 C# 编写了一个 IoC / DI 容器，它实现了公共服务定位器。我写它主要是为了学习目的，但是当我完成它时，我决定让它开源。如果你们中的任何人想试用[IInject](http://iinject.codeplex.com)，可以[在这里](http://iinject.codeplex.com)下载。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T16:25:56.163

除非有很好的理由，否则我不会重新发明轮子并自己实现 IoC 容器，特别是因为有很多不错的选择，例如[Unity](http://msdn.microsoft.com/en-us/library/cc468366.aspx)、 Ninject 或[Spring.net](http://www.springframework.net)。

如果您需要/想要删除对任何这些 IoC 容器的依赖关系，您可以尝试[Common Service Locator](http://www.codeplex.com/CommonServiceLocator)接口。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-09-14T05:34:45.543

如果您正在寻找轻量级和高性能的 IoC 容器，那么您应该查看[Munq](https://www.nuget.org/packages/Munq.IocContainer)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T14:23:09.670

[James Kovacs 在这里](http://www.dnrtv.com/default.aspx?showID=126)展示了关于这个主题的 dnrTV 剧集。这里还写[了一篇文章](http://msdn.microsoft.com/en-us/magazine/cc337885.aspx)。然而，在文章中，他提到您可能想要使用其中一个预建的。因为它们有很多不同的外观。Ninject、StructureMap、Autofac 使用流畅的接口。Spring、Castle Windsor 和 Unity 更多地是 XML 配置驱动的。Castle Windsor 也可以使用 boo 作为界面。许多人都与其他框架挂钩，例如 Unity 与 EntLib 或 Castle Windsor 与 Monorail 以及 Castle Project 的其余部分。

因此，除非您真的需要或想要 IOC 框架未提供的东西，否则为什么不使用其中之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-14T05:40:18.553

Autofac非常好。

我自己用不到 15 行写了一个。字典只有两种扩展方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-15T18:14:31.473

IOC 容器并不难写，它只是一个管理良好的全局递归工厂，具有一些潜在的附加功能。使用字典、反射和委托来注册和构建一个简单的容器......

真正的问题是另一个新的 IOC 容器框架为什么以及如何带来好处？

在大多数情况下，您认为您需要更高的性能？不存在的功能？但大多数时候，现有的框架正是你所需要的，并且足够了，除非你已经意识到框架强迫你使用它的所有废话。

对 ioc 容器框架的所有实现感到失望，它具有反模式级别的功能，但也有古怪和不可靠的语法，更糟糕的是强加耦合，我决定亲自体验一下。这就是为什么我将自己的（非常轻的）IOC 容器作为开源的。

你可以在这里查看：[Puresharp API .net 4.5.2+](https://github.com/Virtuoze/Puresharp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-23T14:31:22.057

[Ayende还在他的博客文章](http://ayende.com)[《用 15 行代码构建 IoC 容器》中](http://ayende.com/Blog/archive/2007/10/20/Building-an-IoC-container-in-15-lines-of-code.aspx)写到了关于编写自己的 IoC 容器的内容，但我相信他和其他人的观点相同：如果没有必要，不要构建自己的容器。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-17T19:45:51.710

我创建了自己的 IoC 容器，它可以**更轻松地调试**对象的创建（即使您无法访问容器代码）。创建对象后，按下 Step into (F11) 时，您会看到创建对象的代码。完整的代码可以在[这里](http://www.siepman.nl/blog/post/2014/02/15/Simple-IoC-container-easy-to-debug-and-fast.aspx)看到。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-26T07:06:14.610

问题是有太多的 IoC 和 DI 库让你感到困惑。当您使用其中一个开发某些东西并且您成长时，您会将您的产品与此类工具紧密结合，您将需要这些工具的专家来继续开发。这完全取决于公司的政治和设计的复杂性。

我自己计划手动完成，因此没有太多隐藏代码。我知道有很多很棒的开源 IoC 工具，但谁真正通过代码并试图理解？

不是要重新发明轮子，但有时如果您可以自己定制更适合您的产品的轮子，那会很好。

# c# - 如何在数据访问层 (C#) 中表示空值

> ID：386544
> 
> 赞同：2
> 
> 时间：2008-12-22T15:37:32.300
> 
> 标签：c#, .net, nullable

只是想知道 DAL 是否有任何最佳实践来表示空值（来自可为空的列）。

我们目前有自己的内部 DAL，并用 int.MinValue 表示空值。但是，这种上升与开发人员有关，他们认为在比较值时，我们故意将另一个“附加”值强加到 int.MinValue 上，而 int.MinValue 用于 DAL 层中的空值这一事实令人困惑。所以其他人提出了 .net 2.0 的 NullValue，但我们发现这种方法也存在性能和语法问题：

*   [zorched.net：.NET 可空类型和 DBNull 暴露设计缺陷](http://www.zorched.net/2005/11/17/net-nullable-types-and-dbnull-expose-design-flaws/)
*   [BCL 团队博客：可空性能](http://blogs.msdn.com/bclteam/archive/2005/06/30/433852.aspx)
*   [megasolutions.net：带有可选参数的 Web 服务](http://www.megasolutions.net/cSharp/Webservice-with-optional-parameters-65795.aspx)
*   [dotnet2themax.com：C# 可为空类型的不一致行为](http://www.dotnet2themax.com/blogs/fbalena/PermaLink,guid,1638cc2f-b9a5-4654-a2ab-2e484b80d290.aspx)

那么，您对此有何看法？其他著名的 ORM 如何处理空值？是否有围绕这个问题的最佳实践？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T15:42:55.970

为了表示一个可为空的整数，我每次都使用`Nullable<int>`(aka )。`int?`这正是它的设计目的。您提供了几个链接，但您能否*准确*说明可空类型的语法问题在哪里，以及您在哪里看到*了重大*的性能问题（请记住，数据库调用可能比任何转换都贵*得多*正在进行中）。

编辑：我注意到倒数第二个链接指向一个涉及我的新闻组对话。我在这种情况下避开可空类型的原因是因为问题是围绕可能需要将空值有效地传达给没有可空值类型的平台的 Web 服务。我认为这不适用于您所描述的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T18:31:31.263

添加为答案，因为评论太长了。

如果你必须在你的代码库中乱扔`Nullable.Compare`，那你就错了。你不应该比较两个`Nullable<int>`值，除非你已经知道它们都是非空的。

唯一的例外是在完全无法避免的地方，例如在聚合或排序时。如果您使用标准方法（例如 Linq）来执行此操作，则无需实现任何特殊的方法来处理此问题，因为`Nullable<T>`implements `IComparable<T>`.

有一个原因是，在 SQL Server 中，任何包含 NULL 术语的表达式的计算结果都是 NULL。如果表达式中的一个术语为 NULL，则表达式的结果是*没有意义*的 - 除非表达式明确指出（通过 ISNULL 或 COALESCE）如果术语为 NULL 该怎么办。这是一个应该在表达式内部或周围做出的决定，而不是全局的。

例如，考虑这个看似简单的逻辑：

```
if (qtyOrdered > qtyInStock)
{
   Reorder(qtyInStock - qtyOrdered);
} 
```

`qtyInStock`如果为null，那将引发异常。如果为空，这个逻辑应*该做什么？*`qtyInStock`我们不知道：这是一个必须在业务逻辑设计中解决的问题，而且还没有解决。

但是我们几乎可以肯定知道一件事*：*如果`qtyInStock`为空，则为项目生成新订单`Int.MinValue - qtyOrdered`是错误的答案。如果您使用幻数来指示空值，这就是这样的逻辑。逻辑被打破了，它需要被修复，而不是隐藏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T15:42:43.147

我使用可空类型，如 int? 等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T16:08:58.680

感谢您的快速回复。

我们仍在决定使用哪一个，我不知道 nullable 最终会如何执行，但我同意数据库访问将成为瓶颈。

[我看到使用 nullable 的问题实际上是由于此处](http://www.dotnet2themax.com/blogs/fbalena/PermaLink,guid,1638cc2f-b9a5-4654-a2ab-2e484b80d290.aspx)概述的内置 .net 运算符下的不同行为。

如果我使用可为空的类型并且想要正确比较两个整数，我将不得不使用 Nullable.Compare 语法来乱扔我的代码库。我不确定这是否是最好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T19:10:16.737

CJ Date 认为，在 RDBMS 上下文中不应存在空值，部分原因是这些问题。你如何避免它们？通过重新设计它们：以各种方式拆分数据，以便空列变得无关紧要，并在这种情况下从逻辑设计中删除。换句话说，重新设计您的表和列，以便每一列都被限制为`NOT NULL`但也具有有意义的值（没有替换自定义哨兵，如`int.MinValue`）。

这是很多工作，人们会很高兴地争论它是否值得，但如果你那么关心你的实现的性能和纯度，那么也许这就是你想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T16:29:13.600

在我的数据访问层中，它将 null 转换为对上下文有意义的值。我的 DAL 的目的是将数据与应用程序连接起来，因此 DAL 必须知道数据代表什么，然后设计人员才能推断出一个好的新值。也许零是空整数字段的正确答案，也许错误消息可能会出现在文本字段中。

这样，当我的应用程序读取数据时，它会获取数据，当它显示给最终用户时，他们会看到某些内容为零，并且文本应该显示“没有可用的文本”之类的东西。

使用整数？只是将空问题推高了一级，这就是我现在使用 DAL 的方式。

# lua - wxLua：使用 wxFtp 上传文件

> ID：386546
> 
> 赞同：2
> 
> 时间：2008-12-22T15:38:54.263
> 
> 标签：lua, wxwidgets

我正在尝试在 wxLua 上使用 wxFTP 来上传多个文件。它适用于第一个文件，但我不明白为什么我不能发送第二个文件。这是一个失败的示例：

```
local ftp = wx.wxFTP()
local ftpAddress = wx.wxIPV4address()
ftpAddress:Service( "ftp" )
ftpAddress:Hostname( "ftp.example.com" )
ftp:Connect( ftpAddress )
local out1 = ftp:GetOutputStream( "foo" )
out1:Close()
local out2 = ftp:GetOutputStream( "bar" )
out2:Close() -- here out2 is nil 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T17:12:01.670

而不是在输出流上调用 Close 将变量设置为 nil 并让垃圾收集器处理它。wxOutputStream 实际上是一个指向从 wxSocketOutputStream 继承的 wxFTPOutputStream 的指针。Close 方法不做任何事情——它总是返回 true——并且必须销毁流（即调用的析构函数）才能关闭套接字。

尝试这个：

```
local ftp = wx.wxFTP()
local ftpAddress = wx.wxIPV4address()
ftpAddress:Service( "ftp" )
ftpAddress:Hostname( "ftp.example.com" )
ftp:Connect( ftpAddress )
local out1 = ftp:GetOutputStream( "foo" )
out1 = nil
collectgarbage("collect")  -- force full garbage collection
local out2 = ftp:GetOutputStream( "bar" )
out2 = nil
collectgarbage("collect") 
```

# asp.net-mvc - 如何为 S#arp Architecture 项目启用 ASP.Net MVC 项目模板

> ID：386548
> 
> 赞同：0
> 
> 时间：2008-12-22T15:39:16.460
> 
> 标签：asp.net-mvc, visual-studio-2008, s#arp-architecture

我一直在尝试使用[S#arp Architecture](http://code.google.com/p/sharp-architecture/)创建应用程序。

让我有点烦恼的一件事是，我无法从“添加新项目...”对话框访问任何 ASP.Net MVC 项目模板。换句话说，例如，我不能直接从“添加新项目...”对话框创建新的“MVC ViewPage”或“MVC 控制器”。

因此，我必须创建标准的 ASP.Net 项目，然后操作标记和代码隐藏以设置正确的继承结构。

**有没有办法让 ASP.Net MVC 项目模板在基于 S#arp Architecture 项目模板的项目的“添加新项目...”对话框中工作？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T16:17:56.990

感谢[Todd Smith](https://stackoverflow.com/users/31624/todd-smith)在原始问题中的评论，我找到了答案。

ASP.Net MVC 项目模板应该在“添加新项目...”对话框中可用，位于 Web -> MVC 下。

我在最初的问题中忽略了提及（因为我认为它不相关）是我已将原始的 S#arp Architecture 项目模板转换为 VB.Net（这些天在 VB.Net 中工作更舒服一些） ）。结果我在转换过程中失去了访问 ASP.Net MVC 模板的能力。

修复很简单。我的 SharpArch.Web 项目的 VB.Net 版本未被识别为 MVC 项目。我只需将适当的项目类型 GUID（即**{603c0e0b-db56-11dc-be95-000d561079b0}**）添加到 *.vbproj 文件中：

```
<ProjectTypeGuids>{603c0e0b-db56-11dc-be95-000d561079b0};{349c5851-65df-11da-9384-00065b846f21};{F184B08F-C81C-45F6-A57F-5ABD9991F28F}</ProjectTypeGuids> 
```

谢谢托德！

# c - 使用 volatile 变量的示例 C 函数

> ID：386554
> 
> 赞同：2
> 
> 时间：2008-12-22T15:41:41.010
> 
> 标签：c, volatile

对于一篇论文，我正在寻找一个使用 volatile 变量的*真实C 函数。*这本身并不难找到，但我正在寻找一个函数，其中 volatile 变量的值必须在函数执行过程中发生变化**，**以便到达函数的特定分支。像这样的东西：

```
typedef struct {
    unsigned       :6;
    unsigned FLAG1 :1;
    unsigned FLAG2 :1;
} __attribute__ ((packed)) REGISTER;

volatile REGISTER * io_ = 0x1234;

int write_to_io()
{
    while (io_->FLAG1) {};
    //io_->FLAG1 is now 0

    io_->FLAG2 = 1;

    sleep(10);

    if (io->FLAG1)  
        return 1;  //io->FLAG1 has changed from 0 to 1
    else
        return 0;  //io->FLAG1 has not changed
 } 
```

如果在函数执行期间结构的不同位发生变化就足够了，但我的主要标准是，对于要到达的某个分支，易失性变量的值在函数执行**期间发生变化。**

我会非常感谢任何现实生活中的例子。我无法在网上找到很多使用 volatile 的示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T23:37:50.973

规范（和可移植）示例是处理异步信号。（您可能可以使用 Ctrl-C 将 SIGINT 传递给您的程序）。

```
#include <signal.h>
#include <stdio.h>

volatile sig_atomic_t quit;

void signal_handler(int sig)
{
    signal(sig, signal_handler);
    quit = 1;
}

int main(void)
{
    signal(SIGINT, signal_handler);
    puts("Hit return to poll quit flag");
    while (!quit) getchar();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T15:45:01.473

选择你最喜欢的开源操作系统，并寻找旧的设备驱动程序，你会发现一些没有其他工作方式的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T18:06:24.637

我老师的一些例子，它使用一个编译器（lcc）在没有 volatile 的情况下工作，但是当我使用我的 gcc 端口为该处理器运行它时中断了。我不得不把volatile放进去。

```
static int volatile busTimeoutSeen;

int busTimeoutISR(int irq) {
  busTimeoutSeen = 1;
  return 1;  /* skip offending instruction */
}

int memsize(void) {
  unsigned char volatile *ptr;
  unsigned char b;
  ISR oldService;

  busTimeoutSeen = 0;
  oldService = getISR(16);
  setISR(16, busTimeoutISR);
  ptr = (unsigned char *) 0xC0000000;
  while (1) {
    b = *ptr;
    if (busTimeoutSeen) {
      break;
    }
    ptr += (1 << 12);
  }
  setISR(16, oldService);
  return (ptr - (unsigned char *) 0xC0000000) >> 12;
} 
```

它从所有页面连续读取，直到我们超过最后一页，这会导致一个中断，该中断将设置`busTimeoutSeen`为 1。因为这发生在幕后，我们告诉编译器总是读取和写入数据到内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T00:30:11.023

内存映射 IO 是一个示例，其中内存中的值实际上可能表示从诸如 COM 端口之类的设备读取。当我学习 C 时，这是使用 volatile 关键字给出的示例之一。

# sql - 标记用于跟踪和调试的 sql 语句

> ID：386555
> 
> 赞同：0
> 
> 时间：2008-12-22T15:42:30.543
> 
> 标签：sql, oracle, debugging, tags, trace

我们有一个大型企业，其中包含许多由 Oracle 10G 支持的新旧应用程序。当阻塞会话或死锁发生并且我们得到跟踪报告时，能够在 sql 中嵌入一些详细信息将非常方便，这样我们就可以知道是什么应用程序，特别是它是从哪里执行的。除了帮助加快解决时间之外，它还可以帮助我们找到业务流程相互踩踏的地方。我们对如何实现这一点有一些想法，但我很好奇这是否已经是一个已解决的问题。任何成功（或其他）尝试的想法或细节将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T19:03:15.473

[您可以通过 Oracle DBMS_APPLICATION_INFO](http://download.oracle.com/docs/cd/B28359_01/appdev.111/b28419/d_appinf.htm)包标记正在执行的 SQL 块。这适用于任何应用程序语言，适用于数据库引擎本身，并且不会使您的 SQL 语句与注释混淆（无论如何，智能注释都是邪恶的）。更重要的是，Oracle 的各种工具可以识别数据并帮助您在故障排除或调优时使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:26:45.443

我们动态地修改我们的 SQL 语句，以便执行它们的命令位于查询开头的注释中。这是有效的，因为我们进行自己的事务管理并拥有严格的框架。但基本代码很简单（在 Java 中......不确定其他语言将如何处理）：

```
String sql = "SELECT * FROM USERS WHERE ID = ?";
Connection con = getConnection();
PreparedStatement ps = con.prepareStatement(getComment() + sql);
// etc

String getComment() {
  return " /* " + getCommandName() + " */ ";
} 
```

JDBC 驱动程序完整地传递注释，并在 DBA 检查查询时显示在数据库中。为此，我们的命令架构维护了一个线程本地的命令名称堆栈。此外，我们的连接工厂用我们自己的连接对象包装了 JDBC 连接，这样即使人们针对裸机 Connection 实例进行编程，也可以使用此代码，而不是使用我们通常使用的友好帮助方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T21:36:53.353

```
Properties jdbcProperties = new Properties();

this.jdbcProperties.put("user", userName);
this.jdbcProperties.put("password", password);
this.jdbcProperties.put("v$session.program", "YourApplicationName");
DriverManager.getConnection(url, jdbcProperties); 
```

然后通过针对您的连接的程序列分组来检查 v$session，就这么简单..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T22:08:44.413

> “我们知道什么应用程序，特别是它是从哪里执行的”您没有提及您的应用程序是用什么编写的。当从 PLSQL 程序发出 SQL 时，11g 会获取其他信息，您可能需要记住这些信息，具体取决于根据您的环境、潜在的数据库升级时间范围以及代码更改所涉及的工作量。如果从多个应用程序发出相同的 SQL，它将（大部分）在 v$sql 中只有一个条目，因此您可能无法将其追溯到一个应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-30T17:12:32.373

我想在 sql 语句中嵌入注释，以便在 tkprof (10.2.0.4) 中一直标记它们。似乎在某些时候删除了斜线星号或双连字符注释。然后我使用了一个假 sql 提示的语法，它确实通过 tkprof 持续存在，例如

```
/*+ testrun=4A */ 
```

数据库忽略它，它满足我的需求。

# c++ - 如何从 Windows 中没有控制台窗口的 C++ 应用程序中删除文件？

> ID：386559
> 
> 赞同：4
> 
> 时间：2008-12-22T15:44:49.757
> 
> 标签：c++, windows, winapi, file-io

我需要从我的 C++ windows 应用程序（在 Borland C++ Builder 中开发）中删除一个临时文件。目前我使用一个简单的：

```
system("del tempfile.tmp"); 
```

这会导致控制台窗口在我的应用程序前面闪烁，并且看起来不太专业。在没有控制台窗口的情况下如何执行此操作？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-22T15:50:20.870

或者，甚至是标准 C 库函数`int remove( const char *path );`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-22T15:48:19.797

听起来你需要 Win32 函数[DeleteFile](http://msdn.microsoft.com/en-us/library/aa363915(VS.85).aspx) ()。您将需要`#include <windows.h>`使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T22:19:50.770

对于更便携（即在 Windows 和 UNIX 中都可以使用），我在 io.h 中使用 unlink() 或符合 ISO 标准的 _unlink()（UNIX 的 unlink() 包括 unistd.h）
Remove() 实际上调用 _unlink( ）。

# jdbc - 如何在 XA 2PC 事务中加入 ODBC 连接？

> ID：386571
> 
> 赞同：0
> 
> 时间：2008-12-22T15:50:05.253
> 
> 标签：jdbc, transactions, odbc, xa, 2phase-commit

我们的应用程序使用 ODBC 与数据库（DB2 和 Oracle，如果有区别的话）进行通信，并通过**JNI**将业务逻辑委托给 Java （因此它使用 Java*和*C）。

我想知道的是需要哪些工具/软件/库来允许业务逻辑（Java/JDBC）和应用程序框架（C/ODBC）参与两阶段提交协议。

我们在 Linux 上运行此项目，但通常也支持 Solaris 和 Windows，因此首选多平台解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-28T17:24:06.010

您的问题令人困惑-您能更好地描述您的系统吗？您说的是“使用 ODBC”，然后是“java/JDBC”……您的应用程序使用什么语言实现以及它如何与数据库交互？

如果您的代码不是 java 并且使用 ODBC，那么您在错误的论坛中提问，如果它是在 java 中，则使用 JDBC，并且由于 Oracle 和 DB2 都支持 XA，您将需要使用 XA 监视器，它应该可以工作。

# apache-flex - 多语言 Flex 应用程序

> ID：386576
> 
> 赞同：0
> 
> 时间：2008-12-22T15:53:12.347
> 
> 标签：apache-flex, fonts, runtime, multilingual

我正在开发一个多语言 flex 应用程序，该应用程序必须以 27 多种语言运行，包括亚洲、希伯来语和阿拉伯语，以及所有欧洲语言。

我们使用嵌入式字体 (Myriad Pro)，并且在 css 中有大量使用该嵌入式字体的样式。我们已经使用 Myriad 的修改版本进行了测试，包括从 Arial Unicode 获取的所有非西方 unicode 字符，它工作正常，但 swf 的重量是不可接受的。

我们的css中有这两行..

```
@font-face 
{
    src: url("MyriadPro-Semibold.otf");
    fontFamily: "Default Font";
    fontWeight: bold;
    advancedAntiAliasing: true;
}
@font-face 
{
    src: url("MyriadPro-Regular.otf");
    fontFamily: "Default Font";
    advancedAntiAliasing: true;
} 
```

其余字体在需要时使用“默认字体”。

在保持当前样式表的同时，使用运行时加载字体实现多语言应用程序的最佳解决方案是什么？

* * *

是的，当用户更改语言而不是字体时，这些语言是从服务器下载的。

我担心的是，如果我必须下载与 Myriad 不同的亚洲字体，怎么能说 Flash，嘿，我的“默认字体”现在是这种亚洲字体。如果我必须显示语言名称，如何在不更改列表样式的情况下显示亚洲名称...

这并不容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T07:04:02.440

您可以在本地化的属性文件中`fontWeight=bold`或`fontWeight=normal`在本地化属性文件中包含一个属性。然后您可以使用[setStyle()](http://livedocs.adobe.com/flex/3/html/help.html?content=styles_08.html)来更改应用程序。上一个链接的示例：

```
StyleManager.getStyleDeclaration("Button").
            setStyle("color","Blue"); 
```

这可能是：

```
 StyleManager.getStyleDeclaration("DefaultFont").
                    setStyle("fontWeight",
resourceManager.getString('locale_properties', 'fontWeight')); 
```

这不是完全正确的示例，但我希望它为您指明正确的方向。

另一种方法是动态加载新样式表： [如何将 CSS 文件动态加载到 Flex 应用程序中？](https://stackoverflow.com/questions/204924/how-do-you-dynamically-load-a-css-file-into-a-flex-application)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:19:47.033

而不是将字体和语言文件嵌入 .swf 中，您不应该从服务器下载它们吗？

在 .swf 启动时下载字体文件，并在用户选择新语言时下载语言文件。

# linux - 将共享库打包到精灵中

> ID：386579
> 
> 赞同：15
> 
> 时间：2008-12-22T15:54:05.230
> 
> 标签：linux, shared-libraries, elf

是否有一个实用程序可以将精灵需要的**所有**SO 转换为静态然后将精灵转换为免费的 SO？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T20:21:17.873

以下是一些您可能会觉得有用的项目：

*   [Statifier](http://statifier.sourceforge.net/)（基本上做你想要的）
*   [ERESI](http://www.eresi-project.org/wiki/TheELFsh)（可能做你想做的事，也允许分析 ELF 目标）

注意：我自己没有使用过任何一个应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T07:49:52.223

Statifier 是一种选择。另一种选择是[Ermine](http://magicErmine.com)。虽然 Ermine 是商业化的，但它在具有内存随机化的系统上的表现优于 statifier。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T20:50:45.100

我使用了codelogic提到的Statifier。

它适用于几个 Linux 命令，如 ethtool。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T16:25:55.010

可能不会，尽管从理论上讲，毫无疑问，这是可以做到的。

需要注意的一个方面 - 典型程序不会使用给定 SO 中的所有代码，因此盲目地在每个 SO 中包含所有材料会给你一个异常臃肿的可执行文件。经典的静态链接只包含需要的内容。

另一个需要注意的方面是 C++ 模板实例化。我假设这些将主要出现在可执行文件中（而不是作为 SO 的一部分）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T16:18:56.957

您可以在编译时与 -static 链接。您是否要进行此后编译？

# java - Java Applet 刷新问题

> ID：386583
> 
> 赞同：0
> 
> 时间：2008-12-22T15:55:53.993
> 
> 标签：java, applet, refresh

我有一个 Java 小程序 (JApplet)。此 Applet 使用 JComponent(PanelAux) 来显示定期更改的值和图像。但小程序不会自行刷新。我可以做些什么来刷新我的小程序？

```
//--------------------------------------------RUN

public void run()
    while (true) {
        try {
            myThread.sleep(1000);
        } 
        catch (InterruptedException e){
        }    
        repaint();
    }
}
//--------------------------------------------PAINT
public void paint(Graphics g)
{     

    dim  = new Dimension(image.getWidth(this)+50,image.getHeight(this)+50);
    this.resize(dim);
    this.setMaximumSize(dim);
    this.setMinimumSize(dim);

    PanelAux panel = new PanelAux(image);   //JComponent

    add(panel);

    super.paint(g);
} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T16:04:14.210

您实际上是否在启动使用它的线程的任何位置调用 run() 方法？

另外：您绝对不想在您的`paint()`方法中添加新组件！那是在为问题尖叫！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T16:27:51.463

作为一般提示，[在 AWT 和 Swing 中绘画一](http://java.sun.com/products/jfc/tsc/articles/painting/)文描述了您应该如何在 AWT 或 Swing 中处理重绘。

既然您提到您正在使用 a `JApplet`，那么“[摇摆绘画](http://java.sun.com/products/jfc/tsc/articles/painting/#swing)”部分将在这里变得相关。

具体来说，使用 Swing，而不是重载该`paint(Graphics g)`方法，而`paintComponent(Graphics g)`应该使用该方法，并调用超类的`paintComponent`方法。引用“[绘画方法](http://java.sun.com/products/jfc/tsc/articles/painting/#callbacks)”部分：

> Swing 程序应该覆盖`paintComponent()`而不是覆盖 `paint()`.

这是因为`paint`方法本身被分解为三个独立的方法，覆盖`paint`方法本身意味着它将阻止对当前类及其祖先类的`paintComponent`、`paintBorder`和的调用。`paintChildren`

此外，为了`run()`调用该方法，您`JApplet`应该实现`Runnable`并且还`Thread`从您的小程序中的某处调用一个新方法。（可能在`init`or`start`方法中。）

**编辑：**

还应该注意的`paintComponent`是，只要屏幕需要刷新，就会调用该方法。该`paintComponent`方法将被多次调用，因此正如[saua 指出的那样](https://stackoverflow.com/questions/386583/java-applet-refresh-problems#386605)`paintComponent`，在方法本身内实例化新对象并不是一个好主意。

此外，似乎设计是有一个单独的线程（因为小程序似乎正在实现`Runnable`接口，正如方法的存在所暗示的那样`run`），`JComponent`状态的更新可能发生在`run`方法本身中，与`repaint`必要时调用该方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T16:06:28.200

你不应该覆盖paint(Graphics g)。

小程序控制台中是否有任何错误异常抛出？

# c# - 如何使用我的 Visual Studio 项目中包含的文件？

> ID：386584
> 
> 赞同：2
> 
> 时间：2008-12-22T15:56:19.703
> 
> 标签：c#, visual-studio-2008

在我正在创建的 Visual Studio 应用程序中，我想包含一个在应用程序中使用的 .xsd 文件。

xsd 文件与我的其他 .cs 文件位于同一目录中，我将它作为项目中的一个项目拖放到解决方案资源管理器窗口中。

但是在我的 C# 代码中......我该如何使用它？在我的计算机上硬编码它的位置似乎不正确......但仅使用“myfile.xsd”或“.\myfile.xsd”或各种组合似乎不起作用......

提前致谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T15:58:15.707

你需要它是一个实际的文件吗？如果没有，我会将其设为嵌入式资源（在 Visual Studio 中的项目属性中选择）并使用[Assembly.GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcestream.aspx)在执行时加载它。出于部署目的，这很整洁，尽管它确实使您失去了在不重建的情况下更改它的灵活性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T15:58:47.687

有几种方法，但最简单的方法是在解决方案资源管理器中单击文件，转到属性窗口并更改构建操作属性。让它成为内容很受欢迎，但你也可以走嵌入式资源的路线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T18:37:36.383

如果您希望它是用户可配置的，您可能应该进行自定义构建步骤，将文件复制到公共位置，例如 CommonApplicationData。然后在该路径中从您的应用程序中引用它。您可以使用 Environment.GetFolderPath() 访问这些特殊文件夹。

[http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)

它采用的参数是一个枚举：

[http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

CommonApplicationData - 用作所有用户使用的特定于应用程序的数据的公共存储库的目录。

# asp.net - 使用 ManualWorkflowSchedulerService 处理 WF 中的外部事件

> ID：386585
> 
> 赞同：0
> 
> 时间：2008-12-22T15:57:21.930
> 
> 标签：asp.net, workflow-foundation

我有一个使用 HandleExternalEventAcitivity 的简单工作流程。工作流应该等待用户采取行动，这反过来会引发工作流活动处理的事件。

因为它是一个 ASP.NET 应用程序，所以我使用 ManualWorkflowSchedulerService 让我的工作流同步运行。但是，使用 ManualWorkflowSchedulerService，HandleExtenalEventActivity 永远不会触发。我确实验证了服务的接口、事件、事件参数上的所有属性。

在调查时，我在控制台应用程序中运行了工作流，只要我不使用 ManualWorkflowSchedulerService，就会正确引发和处理事件。

使用 ManualWorkflowSchedulerService 是否有任何额外的 HandleExternalEventActivity 需要？

**解答：**正如 Jeremy 所指出的，您必须在引发事件后调用*ManualWorkflowSchedulerService.RunWorkflow 。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-25T18:12:04.720

将事件引发到工作流中后，您是否再次在调度程序上调用 RunWorkflow 以进一步执行您的工作流？

# c# - 获取“无法开始调试”“在...时发生身份验证错误”

> ID：386591
> 
> 赞同：4
> 
> 时间：2008-12-22T15:59:33.783
> 
> 标签：c#, asp.net, debugging

这肯定看起来像是一个要修复的简单错误。但是，我不知何故无法弄清楚。在这里找到了一些帖子并通过它们并无法使其正常工作。当然，这似乎是一个著名的错误。

我得到的错误是：无法在 Web 服务器上开始调试。与 Web 服务器通信时发生身份验证错误。

我在 Server 2k3sp2 Web 服务器上运行 VS2k8。我已验证在 web.config 中设置了调试，并在 IIS 中设置了已验证的 http keep alives。我已将网络设置为使用集成身份验证运行。我什至试图附加到这个过程。但是，我的断点说运行代码和当前代码不匹配，即使我编译了网络并运行它..听起来我附加到了错误的进程，但那里只有 1 个 w3wp 进程可以附加到，应该是只是我的过程。

我什至做了一个 aspnet_regiis。还是不行。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T19:52:24.437

环顾四周后，我注意到每次尝试以调试模式启动时都会出现 537 - '登录期间发生错误' 安全事件。我在 M$- 上找到了这篇文章

[http://support.microsoft.com/?id=896861](http://support.microsoft.com/?id=896861)

在注册表中设置一个键以禁用根据文章的环回检查并重新启动后，问题解决了！由于它是内部的开发盒，因此不应该存在安全风险。

谢谢您的帮助！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:27:15.333

确保检查 IIS 中的身份验证模式是否设置正确。如果您在域中，请务必注意这一点，并确保选中匿名访问（如果您的应用程序需要）。

[此 MSDN 链接](http://msdn.microsoft.com/en-us/library/aa292114(VS.71).aspx)有更多详细信息。

您还可以尝试其他一些方法：

*   [IIS 7.0 调试修补程序](http://blogs.msdn.com/webdevtools/archive/2007/06/20/downloadable-hotifx-f5-debugging-using-iis-fails-on-vista-home-editions.aspx)
*   [IIS 7.0 问题](http://mvolo.com/blogs/serverside/archive/2006/12/28/Fix-problems-with-Visual-Studio-F5-debugging-of-ASP.NET-applications-on-IIS7-Vista.aspx)
*   [其他要尝试的事情](http://social.msdn.microsoft.com/forums/en-US/asmxandxml/thread/bf530e90-5d42-4909-a858-6be0ae28717d/)

让我知道这对你有什么影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T19:57:53.920

我通过更改项目属性的 web 部分中的服务器引用来解决此问题。我正在使用 127.0.0.1 - 更改为 localhost 并且它有效。

# testing - 不同操作系统上的多种语言的多个应用程序。我应该尝试统一的测试工具吗？

> ID：386593
> 
> 赞同：1
> 
> 时间：2008-12-22T15:59:57.543
> 
> 标签：testing, nightly-build, multiple-languages

我是一个项目的最新成员，该项目是在 Unix 和 Windows 操作系统上用各种编程语言编写的各种应用程序的混合物。我获得了弄清楚如何为所有这些不同的应用程序实施夜间回归构建/测试的“荣誉”。

不幸的是，这些应用程序不是按照 TDD 原则构建的，也没有任何重要的单元测试框架。我的直觉在向我尖叫，要尽量避免重新发明轮子，并“尝试”找到某种方法来为这个夜间测试架构尽可能多地重用代码。

有人会如何编写尽可能多地共享代码的测试用例……当面对跨多个操作系统的多种语言时……并且由于并非所有应用程序都是 Web 服务甚至是 Web 应用程序这一事实更加复杂？

我唯一的结论是测试驱动程序和测试用例必须特定于每个应用程序，我不能有任何重要的代码重用。

欢迎和赞赏任何建议或提议以提供快速的头脑以提出这个问题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T16:11:51.933

这是我以前见过的一个艰难的。我认为您最终将不得不在这一点上做出决定，但首先，稍微不同的方法可能会有所帮助。看起来这个应用程序已经出现了。必须有一个或多个 bug 库出现，您可以对其进行调查以找出最常见的 bug*类型*。应用程序通常有一个最容易出现缺陷的方面，这就是我将从一些测试脚本开始的地方。您实际上是在以任何旧方式回归最高效的错误报告，并以任何旧方式将这些脚本拼接在一起。

一旦你知道了这个应用程序，并且在完成上述操作后你很快就会知道它，你可以想出一个更宏大、更容易维护、利用或测试的应用程序。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T04:44:05.690

很难说它在你的情况下有多可行......但如果你能想出一个描述你的测试用例的声明性机制，可能会使用文本文件或 XML 来详细说明参数、预期输出、预期各种情况的返回码等。这样，如果这些测试用例在多个操作系统/环境中有效，您可以实现代码为每个环境执行一次测试用例，但能够重用所有测试用例。

当然，您的里程可能会有所不同，具体取决于您需要测试的接口/脚本/应用程序的复杂性，以及用数据表达测试用例的难易程度。

至于提出测试用例，我之前还负责为没有考虑“可测试性”的旧“遗留”代码编写测试。我喜欢安德鲁的建议；使用以前的错误/回归数据将有助于找出哪些测试会给您带来最大的收益。尝试在您的团队中实施新的工程流程也是一个好主意——对于从现在开始修复的每个新错误/问题/回归，尝试添加一个会发现问题的测试用例。这将帮助您建立一组可证明相关的测试用例......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T16:14:32.287

只值我的2美分...

为了相对成功地实施整体开发人员测试，据我了解，您需要整个开发人员都参与编写测试代码。

也许如果您可以促进各种应用程序和服务的通用界面，那可能会给您带来一些进展。

# wpf - WPF中的路由事件是否弱

> ID：386598
> 
> 赞同：6
> 
> 时间：2008-12-22T16:01:08.087
> 
> 标签：wpf, routedevent

WPF 中的路由事件是否存储对附加到它们的处理程序的强引用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T16:07:12.847

如果控件作者实现了 WeakEvent 模式，那么是的。我相信库存控制使用这种模式。

更新：他们实际上没有。以下是有关此问题和其他潜在性能问题的参考：

[优化 WPF 应用程序性能](https://msdn.microsoft.com/en-us/library/aa970683(v=vs.100).aspx)

以下是关于弱事件的参考：

[弱事件模式](https://msdn.microsoft.com/en-us/library/aa970850(v=vs.100).aspx)

高温高压

科尔比非洲

# compression - 压缩少量数据

> ID：386604
> 
> 赞同：4
> 
> 时间：2008-12-22T16:04:07.643
> 
> 标签：compression

我有一个程序，可以在其中生成大约 80 到 150 位左右的比特流，我想对其进行压缩，因为我要把它们变成某种 ASCII 字符串，以便人们可以传输它们。

有谁知道可以在这样的流上工作的好的、免费的位感知压缩器？我对“标准选项”的主要问题是这个流真的应该被视为位，而不是字节，否则结构会丢失，并且它们的开销会淹没任何收益。

添加：

我想压缩这些流的原因是因为用户将剪切+粘贴它们，可能使用 base64 编码之类的东西，所以保存一些数据是有帮助的。

这是一个例子，给那些想看的人。我将添加格式以使其更易于阅读：

```
110 110 - This is a 6x6 grid (the maximum is 7x7, so we only need 3 bits!)

000000
011110
010010
010010
011110
000000 - This is one layout grid

000000
000000
001000
000100
000000
000000 - This is the second layout grid 
```

现在我们列出一些片段

```
010 11111111 - A piece is a 3-bit colour code, then an 8-bit list of 'on / off' bits.
001 10101010 - Another bit!
001 10101010 - Another, identical bit! 
```

我说这应该被视为“位”的原因是，当您将其视为位流（特别是“网格中的许多 0”）时，有明显的压缩选项，当您将其视为字节流时，这些选项就会消失。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T16:21:42.647

您希望通过压缩 150 位来完成什么？除非您汇总这 19b 消息中的几个，否则我不确定您希望获得什么。这是 UI 问题吗？您希望用户在其中发送/接收“代码”吗？

[base 64编码](https://stackoverflow.com/questions/201479/what-is-the-use-of-base-64-encoding)怎么样？这将获取二进制数据并将其转换为编码字符，以便于传输或输入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T17:42:06.633

克里斯，感谢您发布这些样本。我认为游程编码是您想要的方式。这应该很容易实现。

[http://en.wikipedia.org/wiki/Run-length_encoding](http://en.wikipedia.org/wiki/Run-length_encoding)

将与所有这些连续的 0 一起工作。

那么压缩这些字符串的主要原因是为了让它们更容易剪切和粘贴？说得通; 这听起来像是一个有趣的项目。

如果您只是想让字符串更易于人工管理，那么听起来您已经准备就绪。如果您尝试压缩它们以使它们通过网络传输得更快，我认为压缩小字符串的好处可能会被其他 TCP 问题（如 MTU 大小等）所破坏。（我在那里没有经验，所以最后一点用很多盐）

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T16:06:58.887

我猜没有通用算法会给你这种数据很好的压缩。

最好的办法是分析数据的结构并尝试找到自定义压缩算法或可能自定义现有的压缩算法（可能使用预填充的字典或类似的东西）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-28T02:23:55.750

我的第一个建议是您研究[范围编码](http://en.wikipedia.org/wiki/Range_encoding "范围编码")。代替

1：从位数据压缩成二进制数据，然后

2：将二进制数据编码成base64 ASCII数据，

您可以将您的位直接打包到 0- 范围内`N`（`N`您使用的可打印字符的数量为负 1），然后进行非常简单的映射。

我的第二个建议是您研究 PNG 使用的过滤器方法，并考虑是否可以使用类似的方法来使您的数据更可压缩。仅从两个示例布局网格中很难分辨，但从您的第一个网格中似乎很可能有某种方法，例如“根据其上方和左侧的邻居预测每个像素，然后将每个像素转换为 0，如果它满足预测和 1 如果它违背了它的预测”可以给你一个更统一的数据集，从而更大的压缩。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T16:17:46.680

由于流如此之小，您可以在此处发布其中的一些吗？

您还确定这些流中有足够的冗余甚至允许压缩吗？是否有任何重复的数据块？

这是一个远景，但在没有任何具体答案的情况下，您可能想查看 ROM 场景并检查文本字符串在基于卡带的 RPG 游戏（如“Chrono Trigger”或“Final Fantasy III.”）中是如何压缩的。 " 我知道这些游戏中的文本字符串是被压缩的（当时字节非常宝贵），而破解该计划对黑客来说是一个有趣的挑战。当你提到很多短小的字符串被压缩时，这是我唯一想到的*。*

但是，您的根本问题可能仍然存在。我想这些 ROM 中的压缩方案利用了许多字符串的冗余（即，如果“Timbuktu”出现在 58 个不同的字符串中），而不是在单个流中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T16:42:52.730

我建议您考虑使用[zlib](http://www.zlib.net/)。它是可下载的，并且许可证允许您将它用于几乎任何项目。重要的一点是它被广泛使用，因此调试良好。如果您的数据很重要，您不希望将来在随机日期调试 hombrew 算法中的奇数边缘情况。

我已经搞砸了一点，它确实允许面向流的压缩。我不确定当你一次只给它少量数据时它有多好。无损压缩往往通过查找和消除模式来工作，如果您一次输入像 12 字节这样的小东西，就不会找到很多模式。

我不赞成胡安的回答，因为他还建议使用*有损*压缩的 GIF。您没有提供很多信息，但我猜您不想要任何实际丢失数据的压缩格式。大多数流行的图形、音频和视频压缩算法都是有损的；它们依赖于人类感官正确接收图像或声音的能力，其中一些原始信息被删除或稍作修改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-22T16:29:59.633

CCITT 的[第 3 组和第 4 组](http://www.fileformat.info/mirror/egff/ch09_05.htm)无损编码方案用于压缩 G3 和 G4 TIFF，在设计时考虑了二进制数据。G4 TIFF 是通常用于 OCR 和传真的黑白图像。想到的另一个简单方案是[RLE](http://en.wikipedia.org/wiki/Run-length_encoding)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-22T17:46:44.143

JBIG 可能会满足您的需求。

[http://en.wikipedia.org/wiki/JBIG](http://en.wikipedia.org/wiki/JBIG)

[http://www.jpeg.org/jbig/index.html](http://www.jpeg.org/jbig/index.html)

[http://www.cl.cam.ac.uk/~mgk25/jbigkit/](http://www.cl.cam.ac.uk/~mgk25/jbigkit/)

JBIG 用于压缩 1-bpp 传真图像。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-22T16:17:17.010

zlib 压缩（可能与 gzip 的算法相同）是免费的。它有一些设置，但我不确定你能节省多少，除非你的比特有一些周期性的模式。

由于 png 和 gif 图形文件本质上是位模式的表示，也许您可​​以找到它们使用的压缩算法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-22T16:18:14.447

你想要的是无损二进制压缩。如果没有大量其他资源，我确信有论文或网络文章。谷歌这些条款，我怀疑你会得到你需要的。

你在说多少数据？您的管道是否太小或吞吐量太高以至于您必须压缩？

回想起来，您的数据太小了，除非您分析流量并进行自己的“压缩”，这基本上只是已知位模式的映射/散列，否则您可能不会获得有价值的收益。

正如其他人所说，发布一些示例数据，之后可能会有更好的建议。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-22T16:22:02.037

我和蒂姆有同样的想法——如此少量的数据似乎几乎不值得压缩。事实上，我建议您真正想要研究的是某种 ascii 编码方法，例如 uuencode 或 mime-encode（又名“ [Base64](http://en.wikipedia.org/wiki/Base64) ”）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-22T17:53:45.533

只是为了补充已经说过的内容，“压缩少量数据”本质上是不是有点毫无意义？如果您可以详细说明可能有帮助的数据、平台或用途。

至于位与 ascii - 我不完全确定你在做什么，但正如迈克尔所提到的，Base64 提供了一种使任意二进制更友好的方法。

请注意，*任何*从二进制到 ascii 的转换都与压缩相反。

# windows - 读取空字节的文本文件

> ID：386609
> 
> 赞同：2
> 
> 时间：2008-12-22T16:06:49.743
> 
> 标签：windows, delphi, text

我有一个带有 dos 元素的文本文件 - 例如 hex(00)。我需要阅读并转换它。我曾尝试使用`utf8toansi`，但这会删除带有 hex(00) 的整行。有没有办法在整个文件中转换为文本？我正在使用`win32`, `RadStudio2007`, `Delphi`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T02:51:53.670

这应该做...

```
procedure ConvertFileToDos(const aInFile,aOutFile:String);
var
  FileIn,FileOut:TextFile;
  C:AnsiChar;
  LineBreak:String;
begin
  LineBreak := #13#10;

  AssignFile(FileIn,aInFile);
  Reset(FileIn);

  AssignFile(FileOut,aOutFile);
  ReWrite(FileOut);

  while not EOF(FileIn) do
  begin
    Read(FileIn,C);
    if C=#0 then
      Write(FileOut,LineBreak)
    else
      Write(FileOut,C)
  end;

  CloseFile(FileIn);
  CloseFile(FileOut);
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T16:23:06.403

您可以将其读入 TMemoryStream，将 PChar 分配给第一个地址，然后使用从 0 到 Size - 1 的循环进行扫描。当然，您要对嵌入的 #0 字符做什么取决于您。只需忽略 #13 并在遇到的每个 #10 上添加一个字符串。

**编辑：**

就像是：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  FileStream: TStream;
  MemStream: TMemoryStream;
  P: PChar;
  s: string;
  i: integer;
begin
  FileStream := TFileStream.Create('file.txt', fmOpenRead);
  try
    MemStream := TMemoryStream.Create;
    try
      MemStream.LoadFromStream(FileStream);
      P := PChar(MemStream.Memory);
      s := '';
      for i := 0 to MemStream.Size - 1 do begin
        case P[0] of
          #0: {};
          #10: begin
                 // do something with s
                 s := '';
               end;
          #13: {};
        else
          s := s + P[0];
        end;
        Inc(P);
      end;
    finally
      MemStream.Free;
    end;
  finally
    FileStream.Free;
  end;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T17:02:39.820

我不知道 Delphi，但我猜你可能需要将文件作为二进制文件而不是文本文件打开。然后您可以直接读取字节并将它们转换为您想要的任何内容。

# metadata - Greasemonkey 命名空间需要什么？

> ID：386612
> 
> 赞同：80
> 
> 时间：2008-12-22T16:07:38.527
> 
> 标签：metadata, namespaces, greasemonkey

我正在学习如何使用 Greasemonkey，并且想知道`@namespace`元数据 ID 的用途。

必须是网址吗？或者它可以是我计算机上的文件夹/目录吗？

它甚至需要填写吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-12-22T16:10:16.930

命名空间用于避免命名冲突。如果您调用了您的脚本`foobar`并且其他人也这样做了，那么中央存储库将很难将它们区分开来。

因此，您应该提供一些您可以控制的 URL（即您拥有它或可以管理它），这基本上意味着“带有该 URL 的所有内容都属于我”。现在那些中央存储库可以区分`foobar`from`http://somesite.com/`和`foobar`from `http://anothersite.com`。

基本操作不需要，但如果你想分享你的脚本，强烈建议。

请记住，这`mailto:someone@example.com`也是一个有效的 URL，当您不拥有或控制自己的域时，它可能是一个可能的选择。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-22T16:28:56.190

您可以看到命名空间实际效果的一个地方是存储首选项。Nampsaces 用于为任何特定于脚本的存储首选项唯一标识脚本。

例如，如果您有这样的脚本：

```
// ==UserScript==
// @name            Script Name
// @namespace       http://example.com
// @include         *
// ==/UserScript==

GM_setValue("key", "value"); 
```

这将存储在您的首选项中（可在 prefs.js 和 about:config 中访问），如下所示：

油脂猴.scriptvals。[http://example.com/](http://example.com/Script)脚本名称.key

注意格式：*greasemonkey.scriptvals*。`namespace`. `scriptname`.`key/variablename`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-22T16:10:57.893

> 一般来说，命名空间是一个抽象容器，它为它所拥有的项目（名称、技术术语或单词）提供上下文，并允许消除具有相同名称（位于不同命名空间中）的项目的歧义。
> 
> 来源：[命名空间 - 维基百科](http://en.wikipedia.org/wiki/Namespace)

更具体的：

> 这是一个 URL，Greasemonkey 使用它来区分具有相同名称但由不同作者编写的用户脚本。如果你有一个域名，你可以使用它（或一个子目录）作为你的命名空间。否则，您可以使用标签：URI。
> 
> @namespace 是可选的。如果存在，它可能只出现一次。如果不存在，则默认为用户下载用户脚本的域。
> 
> 资料来源：[潜入 Greasemonkey - 元数据](http://diveintogreasemonkey.org/helloworld/metadata.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-03T21:56:00.980

命名空间可以是 URL，但不仅仅是。您可以将某些单词用作名称空间作为您的用户名或真实姓名。

# asp.net - 在 Visual Studio 2008 的 ASP.NET Web 应用程序项目中设置本地化的最佳实践是什么

> ID：386614
> 
> 赞同：1
> 
> 时间：2008-12-22T16:08:57.103
> 
> 标签：asp.net, visual-studio-2008, localization

我觉得我完全错过了一些东西，因为我找不到任何描述我想做的例子。

我有一个相当简单的 jane ASP.NET Web 应用程序项目，我想对其进行本地化。我希望输出具有卫星 dll，以便稍后当我想添加一种语言时，我可以放入一个新的 DLL。

我在 App_GlobalResources 下为默认文化和西班牙语创建了 resx 文件。当我编译 tho 时，我没有在我的 bin 下获得 ES 的子目录。

如果我以后想在不重新编译我的网络应用程序的情况下添加德语或法语，这是如何完成的？

许多事情都指向 AL.exe，但我还没有看到任何人在 ASP.NET 应用程序中使用它的示例。我没有找到任何说明如何在 Visual Studio 中设置本地化项目/解决方案的文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T22:16:09.797

我弄清楚发生了什么。在我使用 Visual Studio 添加一个新的资源文件后，它添加了一个内容构建操作。如果更改为嵌入式资源，x.resources.dll 将构建在正确的区域性目录中。您还应该将访问修饰符设置为公共（我很确定这是必要的，否则您的主 dll 将无法连接到文化资源）。这将具有将自定义工具属性更改为 PublicResXFileCodeGenerator 的效果。

# pdf - PDF中的数字签名

> ID：386622
> 
> 赞同：5
> 
> 时间：2008-12-22T16:12:49.590
> 
> 标签：pdf, digital-signature, digital-certificate

我正在尝试以[THIS](http://www.codeproject.com/KB/aspnet/Esignature.aspx?display=Print)项目为例对 PDF 文件进行数字签名。

当它执行 st.Close(); 我得到了臭名昭著的“对象引用未设置为对象的实例”。

我不知道为什么会这样，st 是一个对象的实例，它在上面使用。此异常发生在 .Close() 内部，由于我没有源代码，我只能尝试猜测原因...

我只能说：

1.  正在成功读取原始 PDF。
2.  正在生成一个空的pdf（我猜 .Close() 将写入文件）。
3.  我的证书正在加载，但我不确定这是不是正确的方法。

这是我加载证书的方式：

```
private void processCert(X509Certificate2 card)
{
    X509CertificateParser cp = new org.bouncycastle.x509.X509CertificateParser(card.RawData);
    chain = new org.bouncycastle.x509.X509Certificate[] { cp.ReadCertificate() };
} 
```

这就是我尝试签署 PDF 的方式。

```
public string Sign(string SigReason, string SigContact, string SigLocation, bool visible)
{
    string bugLog ="";
    try
    {
        PdfReader reader = new PdfReader(this.inputPDF);

        //Activate MultiSignatures
        PdfStamper st = PdfStamper.CreateSignature(reader, new FileStream(this.outputPDF, FileMode.Create, FileAccess.Write), '\0', null, true);

        FileStream(this.outputPDF, FileMode.Create, FileAccess.Write), '\0'); 

        st.MoreInfo = this.metadata.getMetaData();

        st.XmpMetadata = this.metadata.getStreamedMetaData();

        PdfSignatureAppearance sap = st.SignatureAppearance;

        sap.SetCrypto(this.myCert.Akp, this.myCert.Chain, null, PdfSignatureAppearance.WINCER_SIGNED);

        sap.Reason = SigReason;
        sap.Contact = SigContact;
        sap.Location = SigLocation;

        if (visible)
           sap.SetVisibleSignature(new iTextSharp.text.Rectangle(100, 100, 250, 150), 1, null);

        st.Close();
    }
    catch (Exception e)
    {
        bugLog += " ERROR Sign: " + e.Message;
    }

    return buglog;
  } 
```

有没有人知道为什么我会遇到这个异常，或者我应该怎么做才能克服这个问题？

iTextSharp 文档并没有太大帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T11:49:21.540

我现在已经成功地完成了这项工作:) 对这个示例进行了一些小的更改就可以了；）

[http://itextpdf.sourceforge.net/howtosign.html#signextitextsharp2](http://itextpdf.sourceforge.net/howtosign.html#signextitextsharp2)

# c++ - 在 MFC C++ 中创建 XmlSerializer

> ID：386624
> 
> 赞同：1
> 
> 时间：2008-12-22T16:13:49.090
> 
> 标签：c++, xml, xml-serialization

我想在我的 MFC 应用程序项目中实现这个用 C# 编写的逻辑，如下所示：

```
XmlSerializer ser = new XmlSerializer(typeof(A_CLASS));
StringBuilder sb = new StringBuilder();
XmlWriterSettings sett = new XmlWriterSettings();
sett.Indent = true;
sett.IndentChars = "\t";
using (XmlWriter sw = XmlWriter.Create(sb, sett))
{
    ser.Serialize(sw, A_CLASS_Instance);
} 
```

我怎么能用 C++ 写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T16:37:52.847

MFC 在这里不会真正帮助你，但像今天的 C++ 一样，[Boost](http://www.boost.org/)是你的朋友 :)

Boost.Serialization[库](http://www.boost.org/doc/libs/release/libs/serialization/)具有`xml_oarchive`和`xml_iarchive`. 对于简单的例子，看看这里：[http ://www.fnord.ca/articles/xml.html](http://www.fnord.ca/articles/xml.html)

但是 - 也请查看[此问题](https://stackoverflow.com/questions/225283/best-xml-serialization-library-for-a-mfc-c-app)的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:30:30.023

据我所知，MFC 不提供任何用于 XML 序列化的类。但是那里可能有图书馆。

# java - Silverlight 中的 Java？

> ID：386627
> 
> 赞同：1
> 
> 时间：2008-12-22T16:16:29.083
> 
> 标签：java, silverlight

我们可以在 Silverlight 中使用 Java 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T16:21:38.577

简而言之：不。Silverlight 仅支持[.NET 语言](http://en.wikipedia.org/wiki/.NET_languages)，例如 Visual Basic、C#、托管 JavaScript、IronPython 和 IronRuby。

但是，J# 或 IKVM.NET 可能对您有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T16:39:51.783

根据[Wikipedia - Future of J#](http://en.wikipedia.org/wiki/J_Sharp#Future_of_J.23)，微软自己的主要 Java 支持即将停用。

由于 J# 将从完整的 .NET CLR 本身中删除...

我认为 Silverlight 的希望不大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T16:59:52.163

正如其他人所说，不。

如果您正在寻找与 Silverlight 等效的 Java，您可能需要查看[Java FX](http://en.wikipedia.org/wiki/JavaFX)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T22:32:10.217

我假设您可以使用 Silverlight 与 .NET / Java / PHP / Ruby / Python / 任何**后端**通过 SOAP / REST / 基于 HTTP 的纯 XML 进行通信，就像使用 Adob​​e Flex 和 JavaFX 一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T16:40:31.563

我不太明白为什么不能在 Silverlight 中使用 J#。

当然，您不会获得标准 Java 库，因为（AFAIK）它们不是 Silverlight 运行时的一部分。

**编辑：**

根据[http://msdn.microsoft.com/en-us/library/bb404700(VS.95).aspx](http://msdn.microsoft.com/en-us/library/bb404700(VS.95).aspx)：

> 您可以使用任何 .NET Framework 支持的语言创建基于 Silverlight 的应用程序

J# 是（曾经是？）绝对是 .NET Framework 支持的语言。正如我所说，您可能不会获得基本标准 Java 库的 .NET 克隆（正如您通常使用标准 .NET Framework 所获得的那样），但您可以使用该语言本身。只是你不会有 java.* 命名空间。（这几乎使它毫无用处。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T16:19:09.377

不，不是这样。微软并不真正喜欢 Java，也不会让它进入它的核心技术。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T20:21:29.900

[Ja.NET](http://www.janetdev.org/)可以将 Java 1.5 代码编译为 .NET IL 字节码。虽然，据我了解，Ja.NET 仍处于起步阶段，所以这可能是一场艰苦的战斗。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-27T13:04:34.413

你想要什么很重要，但现在可以使用 JavaFX（类似于 SL 的框架）。如果您想要的只是一个基于 java 的 RIA 平台，那么这就是您想要的。

[http://javafx.com](http://javafx.com)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-22T17:54:32.133

有趣的。Silverlight 的第一个版本*仅*支持 javascript。现在它不在名单上。

编辑：请原谅我没有说明这一点。在第一个版本中，您只能使用 javascript（非托管 Javascript）对 Silverlight 进行编程。这看起来好像微软正在发布一个与 Flash 和 Flex 的平台中立的竞争对手。尤其是直接比较，因为 Actionscript（Flex 语言）是 javascript 的正确超集，而 javascript 在 Flex 中“正常工作”。

从那时起，价值主张发生了变化。很棒的工具，但锁定（不是价值声明，而是观察。）

尽管我可能误解了，但问题背后的问题是 Silverlight 是否会继续尝试吸引平台中立的开发人员，尤其是那些使用 Flash 和相关技术的开发人员。

# database - 数据库继承技术？

> ID：386652
> 
> 赞同：32
> 
> 时间：2008-12-22T16:22:37.293
> 
> 标签：database, database-design, class-table-inheritance

当您需要将具有继承的类持久化到不支持继承的关系数据库时，有哪些技巧/技术？

假设我有这个经典的例子：

```
Person -> Employee -> Manager
                   -> Team lead
                   -> Developer
       -> Customer -> PrivilegedCustomer
                   -> EnterpriseCustomer 
```

设计数据库的可用技术有哪些？各有优劣？

ps 我已经搜索并发现了几个关于数据库继承的问题，但大多数都是关于更改为原生支持它的数据库引擎。但是假设我坚持使用 SQL Server 2005……我有什么选择？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-22T16:30:31.193

三种常用策略：

1.  为层次结构中的每个类创建一个表，其中包含为每个类定义的属性和返回顶级超类表的外键。因此，您可能有一个`vehicle`包含其他表格的表格`car`，并且`airplane`有一个`vehicle_id`列。这里的缺点是您可能需要执行大量连接才能获得一种类类型。

2.  为层次结构中的每个类创建一个包含所有属性的表。这可能会变得很棘手，因为在所有表中维护一个公共 ID 并不容易，除非您使用的是序列之类的东西。对超类类型的查询需要针对所有相关表进行联合。

3.  为整个类层次结构创建一个表。这消除了连接和联合，但要求所有类属性的所有列都在一个表中。您可能需要将大多数列保留为空，因为某些列不适用于不同类型的记录。例如，`vehicle`表可能包含与类型`wingspan`对应的名为的列`Airplane`。如果将此列设为 NOT NULL，则`Car`插入表中的任何实例都将需要一个值 for，`wingspan`即使值 of`NULL`可能更有意义。如果您将列保留为空，您可能可以使用检查约束来解决此问题，但它可能会变得丑陋。（[单表继承](https://en.wikipedia.org/wiki/Single_Table_Inheritance)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-10-18T23:30:08.680

在某些情况下要小心数据库继承——我们在应用程序中为我们的审计策略实现了它，我们最终遇到了性能瓶颈/噩梦。

问题是我们使用的基表只是插入并且快速变化，所以我们最终得到的是到处都是*死锁*。我们目前正计划将这些拆分成自己的表，因为在 15 个不同的表中拥有相同的列而不是性能噩梦，这是非常值得的。实体框架不一定有效地处理继承这一事实也加剧了这种情况（这是 Microsoft 的一个已知问题）。

无论如何，我只是想我会分享一些知识，因为我们已经在这个问题上经历了痛苦。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-22T17:26:44.527

以下链接中的第 8 章继承映射也讨论了这一点。[http://nhibernate.info/doc/nh/en/index.html#inheritance](http://nhibernate.info/doc/nh/en/index.html#inheritance)

它是 NHibernate 文档。

# python - Python 性能——你是否曾经不得不用其他东西重写？

> ID：386655
> 
> 赞同：46
> 
> 时间：2008-12-22T16:23:13.253
> 
> 标签：python, performance, optimization, rewrite

有没有人用 Python 编写过代码，结果证明它的执行速度不够快？

我的意思是，您因此而被迫*选择另一种语言*？

我们正在研究将 Python 用于几个较大的项目，我的感觉是，在大多数情况下，Python 对于大多数场景（与 Java 相比）都足够快，因为它依赖于优化的 C 例程。

我想看看人们是否有从 Python 开始的实例，**但**由于性能问题最终不得不使用其他东西。

谢谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-22T16:28:08.517

是的，我有。我曾经为二进制（长度前缀而不是分隔）bcp 输出文件编写了一个行计数程序，最后不得不在 C 中重做它，因为 python 太慢了。这个程序很小（用 C 重写只花了几天时间），所以我没有费心去尝试构建一个混合应用程序（用 C 编写的带有中央例程的 python 胶水），但这也有是一条可行的路线。

可以使用 C 和更高级别语言的组合来编写具有性能关键位的大型应用程序。您可以使用 C 语言编写性能关键部分，并为系统的其余部分提供 Python 接口。 [SWIG](http://www.swig.org/)、[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)或[Boost.Python](http://www.boost.org/doc/libs/1_37_0/libs/python/doc/index.html)（如果你使用 C++）都提供了很好的机制来为你的 Python 接口做管道。python的[C API](http://docs.python.org/c-api/)比[Tcl](http://www.tcl.tk)或[Lua](http://www.lua.org/pil/24.html)的更复杂，但手工构建并非不可行。有关手动构建的 Python/C API 的示例，请查看[cx_Oracle](http://cx-oracle.sourceforge.net/)。

早在 1970 年代（据我所知），这种方法已被用于相当多的成功应用程序中。 [Mozilla](http://en.wikipedia.org/wiki/SeaMonkey)基本上是用 Javascript 围绕一个用 C 编写的核心引擎编写的。 [几个](http://en.wikipedia.org/wiki/IntelliCAD_Technology_Consortium) [CAD 包](http://www.fourmilab.ch/autofile/www/chapter2_35.html)、[Interleaf](http://en.wikipedia.org/wiki/Interleaf)（一个技术文档发布系统），当然还有[EMACS](http://www.gnu.org/software/emacs/)基本上是用 LISP 编写的，带有一个中央 C、汇编语言或其他核心。相当多的商业和开源应用程序（例如[Chandler](http://en.wikipedia.org/wiki/Chandler_(PIM))或[Sungard Front Arena](http://www.sungard.com/FrontArena)）使用嵌入式 Python 解释器并在 Python 中实现应用程序的大部分。

**编辑：**在回应荷兰大师的评论时，让具有 C 或 C++ 编程技能的人加入 Python 项目的团队可以让您选择编写一些应用程序以提高速度。您可以期望获得显着性能提升的领域是应用程序对大型数据结构或大量数据进行高度迭代的地方。在上面的行计数器的情况下，它必须吸入一系列总计几千兆字节的文件，并经历一个读取可变长度前缀并使用它来确定数据字段长度的过程。大多数字段都很短（只有几个字节长）。这有点麻烦，非常低级和迭代，这使它自然适合 C。

许多 python 库，如[numpy](http://numpy.scipy.org/)、[cElementTree](http://effbot.org/zone/celementtree.htm)或[cStringIO](http://effbot.org/librarybook/cstringio.htm)使用优化的 C 或 FORTRAN 内核和 python API，便于处理聚合数据。例如，numpy 具有用 C 编写的矩阵数据结构和操作，可以完成所有艰苦的工作，还有一个 Python API 可以在聚合级别提供服务。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-22T16:40:55.917

这是一个比人们愿意承认的更难回答的问题。

例如，我可能能够编写一个在 Python 中比在 C 中执行得更好的程序。该陈述的错误结论是“因此 Python 比 C 更快”。实际上，这可能是因为我在 Python 及其最佳实践和标准库方面有更近期的经验。

事实上，除非他们确定可以用两种语言创建最佳解决方案，否则没有人能真正回答您的问题，这是不太可能的。换句话说，“我的 C 解决方案比我的 Python 解决方案快”与“C 比 Python 快”不同

我敢打赌，Guido Van Rossum 可能已经为亚当和达斯汀的问题编写了 Python 解决方案，并且表现相当不错。

我的经验法则是，除非您正在编写需要计算时钟周期的应用程序，否则您可能会在 Python 中获得可接受的性能。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-26T04:54:13.443

添加我的 0.02 美元作为记录。

我的工作涉及开发运行超过 100 GB 数据的数字模型。难点在于快速提出创收解决方案（即上市时间）。为了在商业上取得成功，解决方案还必须快速*执行*（在最短的时间内计算解决方案）。

对我们来说，Python 已被证明是开发解决方案的绝佳选择，原因通常是：快速的开发时间、语言表达能力、丰富的库等。但为了满足执行速度的需求，我们采用了“混合”方法，有几个响应已经提到过。

1.  将 numpy 用于计算密集的部分。我们将使用 numpy 的“本机”C++ 解决方案的速度提高了 1.1 到 2.5 倍，而且代码更少、错误更少、开发时间更短。
2.  酸洗（Python 的对象序列化）中间结果以最小化重新计算。我们系统的性质要求对相同数据执行多个步骤，因此我们“记住”结果并在可能的情况下重复使用它们。
3.  分析和选择更好的算法。在其他回复中已经说过，但我会重复一遍：我们抽出 cProfile 并尝试用更好的算法替换热点。并非在所有情况下都适用。
4.  去 C++。如果上述失败，那么我们调用 C++ 库。我们使用[PyBindGen](http://code.google.com/p/pybindgen/ "PyBindGen")来编写我们的 Python/C++ 包装器。我们发现它远远优于 SWIG、SIP 和 Boost.Python，因为它可以直接生成 Python C API 代码而无需中间层。

阅读此列表，您可能会想“有多少返工！我将在 [C/C++/Java/assembler] 中第一次完成它并完成它。”

让我把它放在眼里。使用 Python，我们能够在 5 周内生成一个可工作的创收应用程序，而在其他语言中，以前类似范围的项目需要 3 个月的时间。这包括优化我们发现很慢的 Python 部分所需的时间。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-22T18:41:19.683

不太远。我在一家拥有分子模拟引擎和一堆用 python 编写的程序来处理大型数 GB 数据集的公司工作。由于开发灵活性和时间方面的巨大优势，我们所有的分析软件现在都是用 Python 编写的。

如果某些东西不够快，我们会使用 cProfile 对其进行分析并找到瓶颈。通常有一个或两个函数会占用 80% 或 90% 的运行时间。然后我们使用这些函数并用 C 重写它们，Python 用它的 C API 使这变得非常容易。在许多情况下，这会导致一个数量级或更多的加速。问题消失了。然后，我们继续愉快地继续用 Python 编写其他所有内容。冲洗并重复...

对于我们倾向于使用 Boost.python 的整个模块或类，它可能有点麻烦，但最终效果很好。如果它只是一个或两个函数，如果项目已经在使用 scipy，我们有时会使用 scipy.weave 内联它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-22T17:12:50.267

在大学期间，我们正在编写一个计算机视觉系统，用于根据视频剪辑分析人类行为。我们使用 Python 是因为 PIL 非常出色，以加快开发速度，让我们可以轻松访问从视频中提取的图像帧，以便转换为数组等。

对于我们想要的 90% 来说，它很好，而且由于图像的分辨率相当低，所以速度还不错。然而，一些过程需要一些复杂的逐像素计算以及众所周知的缓慢的卷积。对于这些特定区域，我们用 C 语言重写了循环的最里面部分，并且只是更新了旧的 Python 函数以调用 C 函数。

这给了我们两全其美。我们拥有 python 提供的数据访问的便利性，这使得开发能够快速，然后是 C 的直线速度，用于最密集的计算。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-22T18:03:54.983

每当我发现 Python 瓶颈时，我都会将 C 中的代码重写为 Python 模块。

例如，我有一些硬件将图像像素发送为 4 字节 0RGB。在 Python 中将 8M 从 0RGB 转换为 RGB 耗时太长，因此我将其重写为 Python 模块。

编写 Python（或其他高级语言）比用 C 编写要快得多，所以我一直使用 Python，直到我不能。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-24T03:55:24.447

这种问题很可能会在语言人之间引发一场宗教战争，所以让我稍微不同地回答一下。

对于当今计算环境中的大多数情况，您对编程语言的选择应该基于您可以高效编程、编程良好以及让您满意的内容，而不是该语言的性能特征。此外，在对任何系统进行编程时，优化通常应该是最后考虑的问题。

典型的 Python 做事方式是开始用 Python 编写程序，然后如果您注意到性能问题，请分析应用程序并尝试首先优化 Python 中的热点。如果优化 python 代码仍然不够好，那么让你失望的代码区域应该被重写为 C 中的 python 模块。如果即使在所有这些之后你的程序还不够快，你也可以改变语言或查看硬件或并发性的扩展。

这是一个很长的答案，直接回答你的问题；不，python（有时带有 C 扩展）对于我需要它做的所有事情来说已经足够快了。我真正深入了解 C 的唯一一次是访问没有 python 绑定的东西。

编辑：我的背景是一个大型 .com 的 Python 程序员，我们在从我们网站的前端一直到所有后台系统的所有事情上都使用 Python。Python 在很大程度上是一种企业级语言。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-23T15:12:34.750

在为特定数据类型实现专门的内存缓存服务器时，存储后端将更有效地使用内存，并且可以通过按位查找操作（*即：O(1) 查找*）减少查找时间。

我在 2 天内用 Python 编写了所有协议实现和事件驱动的守护程序部分，让我们有足够的时间来测试功能并专注于性能，同时团队正在验证协议一致性和其他位。

鉴于[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)之类的工具，对于任何有一点 C 经验的开发人员来说，为 Python 实现 C 扩展都是微不足道的。我用 C 重写了基于[Radix Tree](http://en.wikipedia.org/wiki/Radix_tree)的存储后端，并在一天之内用 Pyrex 使其成为 Python 模块。475K 前缀的内存使用量从 90MB 下降到 8MB。我们的查询性能提高了 1200%。

今天，这个应用程序使用[pyevent](http://code.google.com/p/pyevent/) *（libevent 的 Python 接口）*运行，新的存储后端在一个普通的单核服务器上每秒处理 8000 个查询，作为一个**单进程守护进程运行** *（感谢 libevent）*，占用不到 40MB 内存*（包括Python 解释器）*同时处理 300 多个同时连接。

这是一个在不到 5 天的时间内设计并实施到生产质量的项目。如果没有 Python 和 Pyrex，则需要更长的时间。

我们可以通过使用更强大的服务器并切换到多进程/多实例模型来解决性能问题，同时使代码和管理任务复杂化，同时占用更大的内存。

我认为你在使用 Python 的正确轨道上。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-02T00:56:30.433

我在 python 中开发了几年。最近我不得不列出一个目录中的所有文件并构建一个包含文件名、大小、属性和修改日期的结构。我用`os.listdir`and做到了这一点`os.stat`。代码非常快，但是目录中的条目越多，我的代码与列出同一目录的其他文件管理器相比变得越慢，所以我使用 SWIG/C++ 重写了代码，并且真的很惊讶代码的速度有多快。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-22T16:42:26.397

您始终可以使用 Python 编写应用程序的一部分。并非每个组件都对性能同样重要。Python 很容易与 C++ 本地集成，或通过 Jython 与 Java 集成，或通过 IronPython 与 .NET 集成。

顺便说一句，在某些基准测试中，IronPython 比 Python 的 C 实现更高效。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-22T17:05:58.563

我已经工作了一段时间，开发了一个对大型结构化数据进行操作的应用程序，存储在几 GB 厚的数据库中，Python 已经足够好了。该应用程序具有带有大量控件（列表、树、笔记本、虚拟列表等）的 GUI 客户端和控制台服务器。

我们遇到了一些性能问题，但这些问题主要与糟糕的算法设计或数据库引擎限制（我们使用 Oracle、MS-SQL、MySQL 并且与用于速度优化的 BerkeleyDB 的关系很短）有关，而不是与 Python 本身有关。一旦您知道如何正确使用标准库（用 C 语言编写），您就可以让您的代码变得非常快。

正如其他人所说 - 任何计算密集型算法、依赖于位填充的代码、一些内存受限的计算 - 都可以在原始 C/C++ 中完成以节省 CPU/内存（或任何其他技巧），但整个用户交互、日志记录、数据库处理、错误处理——所有使应用程序真正运行的东西，都可以用 Python 编写，它将保持响应能力和良好的整体性能。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-22T16:34:44.023

我曾经在 python 中制作过很多东西的原型，用于做日志处理之类的事情。当它们运行得不够快时，我会用 ocaml 重写它们。

在很多情况下，python 都很好，我对此很满意。在某些情况下，当它开始接近 23 小时来完成一天的日志时，我会开始重写。:)

我想指出，即使在这些情况下，我最好还是只分析 python 代码并找到一个更快乐的 python 实现。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-06-25T23:55:49.173

是的，两次：

*   我用 C++ 完全重写了一个音频 DSP 应用程序，因为我无法在 Python 中获得适当的性能；我不认为 Python 实现是浪费的，因为它让我可以很容易地对概念进行原型设计，并且 C++ 移植进展顺利，因为我有一个工作参考实现。

*   一个程序图形渲染项目，在 Python 中生成大型 2D 纹理贴图需要很长时间；我编写了一个 C++ DLL 并使用 ctypes/windll 从 Python 中使用它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-23T02:14:06.447

不，我从来不需要重写。事实上，我从 Maya 8.5 开始使用 Python。在 Maya 8 之前，唯一可用的脚本语言是内置的 MEL（Maya 表达式语言）。Python 实际上比它包装的内置语言更快。

Python 处理复杂数据类型的能力也使其速度更快，因为 MEL 只能存储一维数组（并且没有指针）。这需要通过使用多个并行数组或使用慢速字符串连接来伪造多维数组。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-25T20:57:40.577

一个月前，我有一个用 Python（用于工作）编写的分析日志的小程序。当日志文件的数量增加时，程序开始变得非常慢，我想我可以用 Java 重写它。

我很有趣。将相同的算法从 Python 迁移到 Java 花了一整天的时间。一天结束时，一些基准测试清楚地向我表明，Java 程序比 Python 程序慢了 20% / 25%。这对我来说是一个惊喜。

第二次编写该算法也向我展示了一些优化是可能的。所以在两个小时内我用 Python 完全重写了整个东西，它比原来的 Python 实现快了大约 40%（因此比我的 Java 版本快了几个数量级）。

所以：

1.  Python 是一种慢速语言，但对于某些任务，它仍然可以比其他本应更快的语言更快

2.  如果您必须花时间用一种执行速度更快但开发时间更慢的语言（大多数语言）编写一些东西，请考虑使用同一时间来分析问题、搜索库、配置文件，然后编写更好的 Python 代码。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-25T21:29:04.570

我曾经不得不为模拟器编写一个伪随机数生成器。我先用 Python 写的，但事实证明 Python 太慢了；我最终用 C 重写了它，即使这样也很慢，但没有 Python 慢。

幸运的是，桥接 Python 和 C 相当容易，所以我能够将 PRNG 编写为 C 模块，并且仍然用 Python 编写模拟器的其余部分。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-29T07:56:05.330

以下链接提供了多种计算机语言之间的持续比较。它应该让您了解 Python 在不同问题领域中的一些优势和劣势。

[计算机语言基准游戏](http://shootout.alioth.debian.org/gp4/)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-29T08:07:11.890

我正在用Python 重写名为[Erok的 Perl 程序](http://erok.sf.net)[OpenKore](http://www.openkore.com)（与原始[Kore](http://kore.sf.net)相反）。到目前为止，Python 被证明是一种整体上更好的语言，特别是因为它强大的字符串解析功能不需要使用正则表达式，这确实加快了它的文件解析速度。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-12-14T10:09:46.097

我通常不会在我之前重写为 C：

*   轮廓
*   用更好的算法重写（通常这就足够了）
*   考虑到低级性能重写python代码（但永远不要使用非pythonic/非可读代码）
*   花一些时间重新检查一个库不能做到这一点（首先在 stdlib 或外部库中）
*   尝试了 psyco / 其他实现（在我的情况下很少实现真正的速度提升）

然后有时我创建了一个共享库来执行繁重的矩阵计算代码（不能用 numarray 完成）并用 ctypes 调用它：

*   用纯 C 编写/构建/测试 .so / dll 很简单，
*   将 C 封装为 python 函数很简单（即，如果您使用基本数据类型，则不需要，因为 ctypes 会为您完成调用正确参数的所有工作），而且速度肯定足够快。

# ruby-on-rails - 处理所有 Rails 请求共有的用户 ID 哈希的最佳方法

> ID：386656
> 
> 赞同：1
> 
> 时间：2008-12-22T16:23:15.390
> 
> 标签：ruby-on-rails, ruby, web-services, request

每个客户端都由一个哈希标识，与每个请求一起传递给服务器。在这种情况下，处理跟踪用户会话的最佳方法是什么？

我正在对用户帐户等使用restful_authentication。预计很大一部分请求将在没有用户帐户的情况下发起，而只是唯一的哈希。

我对处理会话方式的理解有限，因此请记住这一点。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T10:08:07.173

在 URL 中使用此哈希意味着您没有 Rails 内置会话。会话的重点是在请求之间提供某种状态感。你已经提供了这个状态，看到你正在传递这个哈希，所以在我看来你可以删除 restful_authentication 插件并做这样的事情：

```
class ApplicationController < ActionController::Base
  def require_login
    if params[:access_key]
      @current_user = User.find_by_access_key(params[:access_key]) || restrict_access
    else
      restrict_access
    end
  end

  def restrict_access
    flash[:error] = "You have to log in to access that."
    redirect_to root_path
  end
end 
```

然后，`before_filter :require_login`在需要登录才能访问的控制器中执行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T20:10:15.820

取决于您要做什么，但`session`哈希可能会提供您想要的。会话将自己存储在某个地方（加密的 cookie、数据库或服务器上的文件），并在 cookie 中向客户端发送唯一标识符（类似于您的“哈希”）。在后续请求中，会读取 cookie，并将相应用户的会话数据恢复为`session`哈希。

```
session[:user] = currently_logged_in_user.id
# ... next request ...
session[:user] # returns the currently logged in user's id 
```

# sql-server - 是否有任何第三方软件可以修改 SSIS 包？

> ID：386662
> 
> 赞同：0
> 
> 时间：2008-12-22T16:25:05.230
> 
> 标签：sql-server, visual-studio, ssis

我一直在 SSIS 中处理一些数据转换任务。Visual Studio 在 2008 年在可用性方面变得更好，但我发现有些事情让我烦恼（即，当我在 Package Explorer 中删除某些内容时，它会刷新整个屏幕，让我回到树的顶部。此外，缺乏一些键盘快捷键。）是否有任何其他 DTSx 包编辑器或 VS 插件，它们值得麻烦吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T16:29:42.180

对于这样的事情，不管你信不信，如果你在 Visual Studio 中以 XML 格式打开文件并执行 Ctrl+K、Ctrl+D 重新格式化 XML 文档，那么 XML 是非常可读的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T16:36:02.807

您是否尝试过查看[Rhino.ETL](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-etl/)？它是 SSIS 的代码内替代品，虽然我没有亲自使用过。

[使用 RhinoETL 的面向对象 ETL](http://www.codinginstinct.com/2008/12/object-oriented-etl-using-rhinoetl.html)

[犀牛ETL 2.0](http://ayende.com/Blog/archive/2008/01/16/Rhino-ETL-2.0.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T15:15:37.240

CodePlex 项目[BIDS Helper](http://www.codeplex.com/bidshelper)在编辑 SSIS 包时有很大帮助。它是 BIDS 的插件。我在工作中使用它，发现它非常有用。

# python - 将参数传递给 timeit.Timer() 函数的棘手 Python 字符串文字

> ID：386664
> 
> 赞同：6
> 
> 时间：2008-12-22T16:25:42.450
> 
> 标签：python, string-literals, timeit

我很难使用 Python 的 timeit.Timer(stmt, setup_stmt) 中的 setup 语句。我感谢任何帮助我摆脱这个棘手问题的帮助：

所以我的片段看起来像这样：

```
def compare(string1, string2):
    # compare 2 strings

if __name__ = '__main__':
    str1 = "This string has \n several new lines \n in the middle"
    str2 = "This string hasn't any new line, but a single quote ('), in the middle"

    t = timeit.Timer('compare(p1, p2)', "from __main__ import compare; p1=%s, p2=%s" % (str1,str2)) 
```

我不知道如何在不改变它们在 setup 语句中的含义的情况下转义变量 str1、str2 中的元字符：

```
"from __main__ import compare; p1=%s, p2=%s" % (str1,str2) 
```

我尝试了各种组合，但总是出现以下错误： SyntaxError: can't assign to literal
SyntaxError: EOL while sweeping single-quoted string
SyntaxError: invalid syntax

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T16:47:19.537

考虑将此作为替代方案。

```
t = timeit.Timer('compare(p1, p2)', "from __main__ import compare; p1=%r; p2=%r" % (str1,str2)) 
```

使用`%r`repr 作为字符串，Python 总是正确地引用和转义。

编辑：通过将逗号更改为分号来修复代码；错误现在消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T01:14:42.510

为什么要费心引用字符串呢？只需直接使用它们。IE。将最后一行更改为：

```
t = timeit.Timer('compare(str1, str2)', "from __main__ import compare, str1, str2") 
```

# jquery - 添加链接到交换的图像

> ID：386665
> 
> 赞同：2
> 
> 时间：2008-12-22T16:25:52.747
> 
> 标签：jquery

我有一个正在交换图像的图像库，我想链接交换的图像以在阴影框/灯箱中变得更大。我很接近，我正在思考如何添加链接。它会去我现在弹出警报框的地方。如果你想看的话，这里是页面：http: [//site.jpda.biz/projects/boerum-hill-house](http://site.jpda.biz/projects/boerum-hill-house)

我认为这真的很简单，但我只是碰壁了。TIA。

```
function showImage(src)
{
$("#loader img").fadeOut("slow")
            .remove();

var largeImage = new Image();

$(largeImage).attr("src", src)
         .attr("id", "main")
         .load(function()
            {
            $(largeImage).hide();
            $("#loader").removeClass("loading")
                        .append(largeImage);
            $(largeImage).fadeIn("slow");
            $("#loader img").click(function()
                    {
                    alert("Launch Shadowbox here");
                    });
            }); 
```

更新 11/23

根据 Tricks 响应，我能够找到一种解决我遇到的问题的好方法。我从他的解决方案开始（构建一个新的 DIV），这导致我使用了我现在使用的[**wrap函数。**](http://docs.jquery.com/Manipulation/wrap)我能够使用 wrap 函数而不必构建整个 DIV。这是我更新的代码（包括传递链接标题的能力）。

```
function showImage(src,tit)
{
$("#loader img").fadeOut("slow")
            .remove();
$("#loader a").remove();

var largeImage = new Image();
var largePath = "/files/imagecache/project_large/" + src;
var largeLink = "<a rel='shadowbox' title='" + tit + "' href='/files/" + src + "'></a>";

$(largeImage).attr("src", largePath)
     .attr("id", "main")
     .attr("border", "0")
         .load(function()
            {           
            $(largeImage).hide();

            $("#loader").removeClass("loading")
                    .append(largeImage);
            $("#main").wrap(largeLink);
            $(largeImage).fadeIn("slow");
            });              
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T18:48:49.603

您想要做的实际上是交换 div 而不仅仅是 img 标签，并生成带有链接的 div，并将其交换到的图像周围。

# asp.net-mvc - ASP.NET MVC - TempData - 好的或坏的做法

> ID：386681
> 
> 赞同：96
> 
> 时间：2008-12-22T16:30:13.440
> 
> 标签：asp.net-mvc, tempdata

我正在使用`AcceptVerbs`Scott Gu 的 Preview 5 博客文章中详述的方法来处理 ASP.NET MVC 中的表单条目：

*   用户通过 GET 获取一个空表单
*   用户通过 POST 将填写的表单发布到相同的 Action
*   Action 验证数据，采取适当的行动，并重定向到新视图

所以我不必使用`TempData`. 也就是说，我现在必须在此过程中添加一个“确认”步骤，并且似乎需要使用`TempData`.

出于某种原因，我讨厌使用`TempData`它——它是围绕它设计的东西。

这是一个有效的担忧，还是我在编造？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-02-19T14:52:24.677

无需厌恶 TempData... 但如果使用不当，它肯定表明设计不佳。如果您使用的是 RESTful URL，则 TempData 是将消息从 POST 操作传输到 GET 操作的最佳实践。考虑一下：

您在 URL Products/New 有一个表格。表单发布到 Products/Create，它验证表单并创建产品，成功时控制器重定向到 URL Products/1，错误时将重定向回 products/New 以显示错误消息。

Products/1 只是产品的标准 GET 操作，但我们希望显示一条消息，指示插入成功。TempData 非常适合这个。将消息添加到 Post Controller 中的 TempData 并在视图中添加一些 if 逻辑并完成。

失败时，我一直在将 formCollection 中输入的值和错误消息集合添加到 Post Action 中的 TempData，并重定向到初始 Action Prodcuts/New。我在视图中添加了逻辑，以使用先前输入的值以及任何错误消息填充表单输入。对我来说似乎又好又干净！

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-23T01:11:44.573

我认为您最好在使用 TempData 之前犹豫一下。TempData 存储在会话中，如果出现以下情况，这可能会对您产生影响：

1.  您现在没有在您的网站上使用会话
2.  您有一个需要扩展到高吞吐量的系统，即您希望完全避免会话状态
3.  您不想使用 cookie（我不知道 MVC 现在对无 cookie 会话的支持情况如何）

如果您的站点需要具有高可用性，那么围绕应用会话状态还有其他注意事项，但这些都是可以解决的问题。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-12-25T19:35:36.247

我有点认为临时数据是一种通知用户的即发即弃机制。让他们想起他们最近所做的事情真是太好了，但我也会犹豫是否将其作为某些用户流程中的必需步骤。原因是如果他们刷新页面，我相信它会消失。好吧，我想我也不愿意使用它，因为它并没有很好地定义它的可靠性。

我想知道问题是否在于您在确认步骤之前将操作重定向到另一个页面。我想知道在他们第一次提交之后，您是否可以进行足够的处理来生成确认对话框，然后返回带有确认问题的原始页面。与您进行验证的方式类似，除了验证规则检查是否执行了确认步骤（在其他验证通过之前隐藏确认 UI）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-22T17:47:36.110

我有一个 GetModel 方法，它首先检查 TempData["model"] 并返回它。否则 GetModel 从数据库加载适当的数据。

当我有一个需要返回需要相同模型数据的不同视图的操作时，它可以节省数据库的额外负载。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-13T17:52:31.780

查看MVC3 中的无[会话控制器](https://stackoverflow.com/questions/4139428/what-are-some-scenarios-of-having-a-session-less-controller-in-asp-net-mv3)。事实证明，使用 session 会阻止并行执行单个用户的请求，从而导致性能下降。

由于 tempdata 默认使用会话，因此您将无法使用此功能。您可以切换到对临时数据使用 cookie，但这有点尴尬（至少对我而言）。不过，仍然比 viewstate 更干净，所以也许它不是什么大问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T17:16:44.657

这就像使用 ViewData，这意味着它可能没有安全风险。但我宁愿使用 ViewData 而不是 TempData。在这里查看比较：[http ://www.squaredroot.com/2007/12/20/mvc-viewdata-vs-tempdata/](http://www.squaredroot.com/2007/12/20/mvc-viewdata-vs-tempdata/)

根据设计，您始终可以将用户/购物篮或您需要的任何内容存储在数据库中的临时数据中，并且只有一个“IsReady”字段来指示它是否已完成，如果您想在以后使用它可以扩展它请注意，人们可以关闭浏览器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-22T17:24:03.457

为什么会有这样的反感？这件事就是做好它的工作并让它做好:)

如果你不喜欢它，因为它是非强类型的，你总是可以制作一个包装器，为你提供强类型接口。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-12T06:41:03.657

所有好的答案，你有没有看过这个来传递消息。

TempData 和 Session 并不是 RESTful 架构的最佳选择，因为大多数会话都存储在内存中。因此，当您想使用服务器场时，用户会话将存在于一台服务器上，而他们的下一个请求可能会发送到另一台服务器。

话虽这么说，请在此处查看使用 TempData 传递消息。

[http://jameschambers.com/2014/06/day-14-bootstrap-alerts-and-mvc-framework-tempdata/](http://jameschambers.com/2014/06/day-14-bootstrap-alerts-and-mvc-framework-tempdata/)

如果仅用于重定向到另一个页面警报，则可以调整以使用查询字符串方法。

# .net - WSE 2 .Net 1.1 客户端从 LAN 内部调用以在 Internet 上提供服务。如何设置代理服务器？

> ID：386688
> 
> 赞同：1
> 
> 时间：2008-12-22T16:34:32.090
> 
> 标签：.net, proxy, wse2.0

您好我正在尝试连接到 Internet 上的 WSE2 Web 服务（.Net 1.1）客户端（也是 .Net 1.1）在我公司的 LAN 内，必须通过代理服务器连接到 Internet。

当我使用生成的代理进行 WSE2 调用时，它会因以下 Microsoft.Web.Services2.AsynchronousOperationException 而失败。

WSE101：异步操作引发异常。

当我调试它有一个内部异常 System.Net.WebException

底层连接已关闭：无法连接到远程服务器。

我的第一个想法是代理服务器没有在客户端代理中设置，这是我在使用 asmx Web 服务时遇到的问题。

但是，当我查看从 SoapClient 继承的代理代码时，没有明显的方法来设置代理。

有人有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T11:58:03.197

Client Proxy 通常继承自 HttpWebClientProtocol。自 .Net 1.0 以来，此类具有 Proxy 属性。因此，您只需构建适当的代理：

```
IWebProxy proxyObject = new WebProxy("http://proxyserver:80", true);
mySoapClientProxyObject.Proxy = proxyObject; 
```

# java - 继承选项

> ID：386695
> 
> 赞同：2
> 
> 时间：2008-12-22T16:37:46.843
> 
> 标签：java, multiple-inheritance

除了实现接口之外，我们可以用于多重继承的其他选项是什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T16:51:56.907

一个直接的答案是使用内部类。这为您提供了两个（或更多）密切相关但涵盖独立基类的对象。

一般来说，更喜欢组合而不是继承。在任何地方都使用继承是一个常见的错误。然而，这留下了难以遵循的不灵活的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T17:19:38.943

首先，最好避免多重继承，使用接口。而Java实际上并不支持多重继承。

但是您可以使用 mixins 来伪造多重继承。有一些关于此的手册：

[Java中的多重继承](http://csis.pace.edu/~bergin/patterns/multipleinheritance.html)

[Java Mixin 模式，或伪造多重继承](http://jonaquino.blogspot.com/2005/07/java-mixin-pattern-or-faking-multiple.html)

如果你想复合，我建议看看[Qi4j](http://www.qi4j.org/)框架：

[Qi4j 的面向复合编程](http://www.infoq.com/articles/Composite-Programming-Qi4j)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T16:52:48.670

Java 没有[多重继承](http://en.wikipedia.org/wiki/Multiple_inheritance)。

从[Java 教程的](http://www.j2ee.me/docs/books/tutorial/index.html)[接口](http://www.j2ee.me/docs/books/tutorial/java/IandI/createinterface.html)页面：

> Java 编程语言不允许多重继承 ... ，但接口提供了一种替代方法。

由于多个接口可以由一个类实现，因此可以用作 Java 中实际多重继承的替代或替代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T17:20:53.260

您可能必须使用组合 - 即，将“父”类的实例作为“子”类的成员。（此处的“父”和“子”表示如果您使用继承，这两个类将具有的关系。）包含（“子”）类必须包装被包含（“父”）类的接口以公开任何功能包含的类

平滑包装过程的一种方法是让包含类和包含类都实现相同的接口——包含类中此接口的方法的实现可以直接调用包含类上的相同方法。

# java - 赞成/反对持续集成系统

> ID：386697
> 
> 赞同：1
> 
> 时间：2008-12-22T16:38:12.630
> 
> 标签：java, continuous-integration

### 重复：[持续集成服务器](https://stackoverflow.com/questions/140453/continuous-integration-servers)

* * *

你好，

最近我研究了几个 CIS 并阅读了很多关于它们的文章。Hudson 给我留下了深刻的印象，因为它很容易设置。我喜欢开始讨论几个 CIS，如 CC、Bamboo、Continuum 等。如果有经验的用户能告诉我一些 CIS 的困难或积极的事情，那就太好了。例如，我在设置 Hudson 时没有问题。巡航控制似乎有点凌乱，但我仍然可以正常工作。当我尝试用竹子或连续体构建项目时，我遇到了更多问题。当然，我只是对这些系统中的每一个进行了初步了解，所以我希望我能得到一些有用的信息。

谢谢

库库达斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T16:53:04.067

在我的工作中，我们使用 Hudson，以下是我喜欢它的一些要点：

*   大量有用的插件，例如集成的 Checkstyle、FindBugs、Cobertura 等等 - 哎呀，我们甚至把[持续集成游戏](http://hudson.gotdns.com/wiki/display/HUDSON/The+Continuous+Integration+Game+plugin)放到了我们的 Hudson！
*   运行 Ant 脚本，对我们来说，这意味着我们可以使用自定义 Ant 脚本来构建整个应用程序，让 Hudson 首先检查 CVS 是否有更改，如果有，然后构建实际的应用程序，然后运行项目的单元测试，如果有的话在这些阶段失败了，Hudson 将构建标记为失败，并向每个人和他们的母亲发送了几封垃圾邮件，告诉大家这个对 CVS 进行这些特定更改的人是多么邪恶，因为他破坏了构建 :)

然后是一些我不喜欢的东西：

*   无法大规模管理构建结果​​。我们最近不得不从构建历史中手动删除大约 300 个构建，因为没有相应的工具。每次构建需要 4 次点击，所以需要一些时间。
*   由于某种原因，Web UI 变得相当缓慢，并且一些插件会占用大量内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:59:53.037

Hudson 是我的最爱，尽管我承认我只使用过它和 Cruise Control。

哈德逊优点：

*   GUI 配置非常简单，配置页面本身提供了帮助片段。
*   许多[插件](http://hudson.gotdns.com/wiki/display/HUDSON/Plugins)，其中许多适合 Java 开发。另外，您可以自己编写。
*   该项目经常发布新版本，因此[经常](https://hudson.dev.java.net/servlets/ProjectDocumentList?folderID=2761&expandFolder=2761&folderID=0)发布错误修复和改进。

哈德逊缺点：

*   当前无法处理在同一项目中按不同计划运行不同构建任务的能力。这真的是我对应用程序唯一的不满。如果能够`ant foo`在 SCM 轮询触发器上运行并且`ant bar`每晚在同一个项目中运行，那就太好了。

# apache - 你能写一个301重定向到一个锚点吗？

> ID：386709
> 
> 赞同：5
> 
> 时间：2008-12-22T16:44:13.273
> 
> 标签：apache, mod-rewrite, http-headers

这是有效和正确的吗？

```
RewriteRule ^myOldPage.html$ /index.php#info [R] 
```

我对这`#info`部分特别感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T17:10:28.650

是的。这是一个有效的 301 重定向（[HTTP 标准](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)允许提供任何有效的 URI 作为重定向）。

现在需要注意的是：并非所有搜索引擎都喜欢重定向。谷歌在处理锚标签方面做得非常出色（他们甚至[对此拥有专利](http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=/netahtml/PTO/search-adv.htm&r=1&p=1&f=G&l=50&d=PTXT&S1=7,308,643.PN.&OS=pn/7,308,643&RS=PN/7,308,643)），而其他人会完全忽略它们。只要这不是问题，重定向在技术上是有效的。

**更新：**如果您在使用 mod_rewrite 时遇到问题，请尝试使用 NE（无转义）标志来防止 # 符号被编码：

```
RewriteRule ^myOldPage.html$ /index.php#info [R,NE] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T17:02:35.717

虽然看起来正确，但我有一种奇怪的感觉，这行不通。

浏览器需要知道#anchor。服务器和 mod_rewrite 很可能会忽略它。

如果它不起作用，我想你可以做类似的事情..

```
RewriteRule ^myOldPage.html$ /index.php?info=true [R] 
```

然后在php输出一段javascript做锚点跳转。

# matlab - 有什么方法可以使 Matlab 中的“保持”功能静音

> ID：386712
> 
> 赞同：11
> 
> 时间：2008-12-22T16:44:55.940
> 
> 标签：matlab

我在 Matlab 中做一些数据分析，每当我调用保持函数以继续绘制到当前图形时，我都会得到如下输出：

```
Current plot held 
```

我想避免这种打印，因为它很丑陋并且使我的输出混乱。不幸的是，放置一个 ; 命令后不会使其静音。

有什么我可以做的（除了修改我的显示代码来完全避免“保持”命令）吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-22T17:10:42.050

如果您使用轴句柄作为唯一参数调用它，则看起来保持命令显示“当前绘图保持”，例如

```
>> hold(gca)
Current plot released
>> hold(gca)
Current plot held 
```

但是，如果你告诉它你想要的保持状态，那么输出就会被抑制，例如，

```
>> hold(gca,'on')
>> 
```

您也可以通过以下方式呼叫保持

```
>> axes(axesHandle)
>> hold on % or hold('on') if you prefer calling it as a function 
```

如果您想避免使用 hold 命令/功能，您可以将轴的*NextPlot*属性设置为*add*，例如

```
>> axesHandle=axes;
>> set(axesHandle,'NextPlot','add') 
```

# xml - 如何在 XML 模式中做互斥属性？

> ID：386713
> 
> 赞同：14
> 
> 时间：2008-12-22T16:45:07.297
> 
> 标签：xml, xsd, schema, xml-attribute

我试图使两个 XML 属性互斥。如何创建 XSD 模式来捕获这种场景？

我想要其中之一

```
<elem value="1" />
<elem ref="something else" /> 
```

但不是

```
<elem value="1" ref="something else" /> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-22T16:57:20.267

您不能使用属性，但可以使用子元素...

```
<element name="elem">
    <complexType>
        <choice>
            <element name="value"/>
            <element name="ref"/>
        </choice>
    </complexType>
</element> 
```

这样你就可以拥有...

```
<elem>
    <value>1</value>
</elem> 
```

或者...

```
<elem>
    <rel>something else</rel>
</elem> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T16:46:42.627

不幸的是，AFAIK 你不能用 XML Schema 做到这一点，我自己也遇到了同样的问题。

我已经看到它建议如果您需要两者：

```
<elem type="xxx"> 
<elem ref="yyy"> 
```

那么`<elem>`本身应该分为两种类型，因为它们显然具有不同的属性...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-23T08:48:48.520

由于在 Alnitak 的回答中提到了[RelaxNG](http://www.relaxng.org/) ，这里有一个使用 RelaxNG 的解决方案（一种在大多数情况下比 W3C Schema 更好的语言）。请注意 elem 定义中的 OR (|)：

```
start = document
document = element document {elem+}
elem = element elem {ref | value}
ref = attribute ref {text}
value = attribute value {xsd:integer} 
```

如果我有这个 XML 文件：

```
<document>
    <elem value="1" />
    <elem ref="something else" />
</document> 
```

它被[rnv](http://www.davidashen.net/rnv.html)和[xmlint](http://xmlsoft.org/)接受：

```
 % rnv attributes-exclusive.rnc attributes-exclusive.xml             
 attributes-exclusive.xml

 % xmllint --noout --relaxng attributes-exclusive.rng attributes-exclusive.xml 
 attributes-exclusive.xml validates 
```

如果我在 XML 文件中添加：

```
<elem value="1" ref="something else" /> 
```

我得到了我想要的验证错误（请注意错误消息不是最理想的）：

```
% rnv attributes-exclusive.rnc attributes-exclusive.xml    
attributes-exclusive.xml
attributes-exclusive.xml:4:0: error: attribute ^ref not allowed
required:
       after

% xmllint --noout --relaxng attributes-exclusive.rng attributes-exclusive.xml
attributes-exclusive.xml:4: element elem: Relax-NG validity error : Invalid attribute value for element elem
attributes-exclusive.xml fails to validate 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-08T13:57:37.500

实际上，*可以*通过 xs:unique 或 xs:key 使用身份约束在 XSD 1.0 中定义它。您选择哪一个取决于如何处理没有这两个属性中的任何一个的元素：它们对 xs:unique 有效，但对 xs:key 无效。下面的代码示例包含两种变体；确保删除其中一个，否则“更严格”的 xs:key 优先于 xs:unique，即需要两个属性之一。

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified" attributeFormDefault="unqualified">
  <xs:element name="container">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="elem" maxOccurs="unbounded">
          <xs:complexType>
            <xs:attribute name="value" use="optional"/>
            <xs:attribute name="ref" use="optional"/>
          </xs:complexType>
          <!-- Note: Use either xs:unique or xs:key -->
          <xs:unique name="attrsExclusiveOptional">
            <xs:annotation>
              <xs:documentation>Ensure that @value and @ref cannot occur simultaneously.
Both may be omitted.</xs:documentation>
            </xs:annotation>
            <xs:selector xpath="."/>
            <xs:field xpath="@value | @ref"/>
          </xs:unique>
          <xs:key name="attrsExclusiveRequired">
            <xs:annotation>
              <xs:documentation>Ensure that @value and @ref cannot occur simultaneously.
One of them is required.</xs:documentation>
            </xs:annotation>
            <xs:selector xpath="."/>
            <xs:field xpath="@value | @ref"/>
          </xs:key>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

这将验证以下 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<container xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:noNamespaceSchemaLocation="schema.xsd">
  <!-- Shall pass: -->
  <elem value="1" />
  <elem ref="something else" />

  <!-- Passes for xs:unique, fails for xs:key: -->
  <elem />

  <!-- Shall fail: -->
  <elem value="1" ref="something else" />
</container> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-26T16:56:46.837

XSD 对此有抽象类型：[http](http://www.tek-tips.com/viewthread.cfm?qid=1364846) ://www.tek-tips.com/viewthread.cfm?qid= 1364846（参见 tsuji 的帖子）

基本上，您为手头的元素提供一个*abstract*、复杂的类型，并在其中定义它的通用属性，对于所有不同的用例，这些属性*完全相同*（您的示例不需要）。

然后创建 2 个（或更多）额外的复杂类型来扩展我刚才提到的抽象类型。在*这些*新类型中，您可以在每个用例之间定义不同的属性集。XSD 部分就是这样。

最后，您需要将 XSI`type`属性添加到模式实例文档中的结果元素。因此，要有效，该元素现在必须具有一组属性或另一组属性。

不是直截了当，而是灵活，众所周知：越灵活，事情就越困难。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-30T00:38:22.760

对于稍后阅读此内容的读者，请注意该问题可以在 XSD 1.1 中使用“条件类型分配”或断言来解决。

# windows - 从 WOW64 启动 Shell 链接 (LNK)

> ID：386715
> 
> 赞同：3
> 
> 时间：2008-12-22T16:45:29.730
> 
> 标签：windows, shellexecute, wow64, lnk

我们的 32 位应用程序通过 ShellExecute 启动 Windows LNK 文件（Shell 链接）。当它尝试“启动”指向 64 位二进制文​​件的链接（例如“开始”菜单中的“Internet Explorer（64 位）”快捷方式）时，它总是最终启动 32 位二进制文​​件。在内部，ShellExecute 错误地解析了链接目标：LNK 内部有一个隐藏字段，其中包含 FOLDERID_ProgramFiles。64 位应用程序将此解析为 64 位程序文件目录，但 32 位应用程序不会。

Wow64DisableWow64FsRedirection 不会改变 ShellExecute 的这种行为。

除了通过 64 位“蹦床”过程（由于我们的插件架构如何工作，这不是一个选项），32 位应用程序是否有任何方法可以像 64 位应用程序一样启动 shell 链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-02T01:44:24.680

Andrew：我试了一下，sysnative 文件夹没有做任何 Wow64DisableWow64FsRedirection 还没有做的事情。问题是 ShellExecute 错误地假定链接指向 %programfiles(x86)%，而实际上它指向 %programfiles%（即使 %programfiles(x86)% 中没有这样的文件）。

打开 64 位程序已经可以正常工作了。问题是指向 %programfiles% 目录的 .lnk 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T16:18:40.030

Reading [this article from Raymond Chen](http://blogs.msdn.com/oldnewthing/archive/2008/12/22/9244582.aspx) I don't think what you're asking is possible. I would still consider making a small "trampoline" application, who's only job was to launch the given application/link, and compiling a different one for use on 32bit and 64bit systems. Either that or build two versions of your application, a 32bit and 64bit one.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T00:07:05.517

您可以生成一个调用 LNK 的 explorer.exe 进程。

您不能将程序编译为 64 位应用程序是否有特殊原因？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-22T20:56:45.487

任何时候你在这里的东西是不可能在计算机上，再想一想......关键是利用 c:\windows\sysnative\ 路径来关闭重定向。

这是非常简单的代码，可以满足您的要求：

```
#include <windows.h>
#include <ShellAPI.h>
#include <stdio.h>

int main(int iArgc, const char *pArgv[])
{
    ShellExecute(NULL, L"open", L"C:\\windows\\sysnative\\..\\..\\Program Files\\Internet Explorer\\iexplore.exe", NULL, NULL, SW_SHOWNORMAL);
    BOOL bIAmWow64 = FALSE;
    IsWow64Process(GetCurrentProcess(), &bIAmWow64);
    printf("I am a wow64 process: %hs\n", bIAmWow64 ? "Yes": "No");
    return 0;
} 
```

我希望这会有所帮助。

# svn - Subversion中基于路径的身份验证对存储库失败，但不是路径

> ID：386728
> 
> 赞同：0
> 
> 时间：2008-12-22T16:53:50.443
> 
> 标签：svn, authentication, svn-administraton

我在 svnserve 中使用基于路径的身份验证，但如果我指定存储库，它会给我权限错误。但是，如果我只指定一个路径，那么它会进行身份验证。

在我的 authz 文件中，如果我这样做，它会起作用：

```
[/my/path]
my_username = r 
```

如果我这样做，它不起作用：

```
[svn:/my/path]
my_username = r 
```

我相当确定“svn”是我的存储库的实际名称。如果有人可以让我知道如何找到存储库的名称，那可能会有所帮助。存储库位于 /usr/local/svn 下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T19:03:06.783

这可能意味着只有一个 svnserve 已知的存储库。如果您想要一个准确的答案而不是猜测，请提供有关您当前配置的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T17:20:12.887

当您执行 svnadmin create _________ 时，您在该空白处给出的内容就是您的存储库名称。对于基于路径的授权，您可以按名称定义存储库。然后，您可以指定存储库中的路径。

我主要使用 HTTP Auth，所以我不确定与 svnserv 是否有任何区别。

使用 HTTP Auth 定义 SVNParentPath 后，您可以授予对存储库区域的访问权限，例如将业务逻辑库的一个分支授予另一个开发人员，如下所示：

```
[bizlib:/branches/2.0.x]
 dev_login = r 
```

# wpf - 在wpf中获取窗口内元素的绝对位置

> ID：386731
> 
> 赞同：94
> 
> 时间：2008-12-22T16:57:10.780
> 
> 标签：wpf, wpf-positioning

我想在双击时获取元素相对于窗口/根元素的绝对位置。元素在其父元素中的相对位置似乎是我所能达到的，而我试图达到的是相对于窗口的点。我已经看到了如何在屏幕上而不是在窗口中获取元素点的解决方案。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-12-22T22:57:45.233

我认为 BrandonS 想要的不是*鼠标*相对于根元素的位置，而是某个后代元素的位置。

为此，有[TransformToAncestor](http://msdn.microsoft.com/en-us/library/system.windows.media.visual.transformtoancestor.aspx)方法：

```
Point relativePoint = myVisual.TransformToAncestor(rootVisual)
                              .Transform(new Point(0, 0)); 
```

`myVisual`刚刚双击的元素在哪里，`rootVisual`是 Application.Current.MainWindow 或您想要的相对位置。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-03-21T00:31:33.373

要获取窗口内 UI 元素的绝对位置，您可以使用：

```
Point position = desiredElement.PointToScreen(new Point(0d, 0d)); 
```

如果您在用户控件中，并且只是想要该控件中 UI 元素的相对位置，只需使用：

```
Point position = desiredElement.PointToScreen(new Point(0d, 0d)),
controlPosition = this.PointToScreen(new Point(0d, 0d));

position.X -= controlPosition.X;
position.Y -= controlPosition.Y; 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-01-28T16:59:48.197

将此方法添加到静态类：

```
 public static Rect GetAbsolutePlacement(this FrameworkElement element, bool relativeToScreen = false)
    {
        var absolutePos = element.PointToScreen(new System.Windows.Point(0, 0));
        if (relativeToScreen)
        {
            return new Rect(absolutePos.X, absolutePos.Y, element.ActualWidth, element.ActualHeight);
        }
        var posMW = Application.Current.MainWindow.PointToScreen(new System.Windows.Point(0, 0));
        absolutePos = new System.Windows.Point(absolutePos.X - posMW.X, absolutePos.Y - posMW.Y);
        return new Rect(absolutePos.X, absolutePos.Y, element.ActualWidth, element.ActualHeight);
    } 
```

将`relativeToScreen`参数设置`true`为从整个屏幕的左上角`false`放置或从应用程序窗口的左上角放置。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-07-22T11:44:18.227

从 .NET 3.0 开始，您可以简单地使用`*yourElement*.TranslatePoint(new Point(0, 0), *theContainerOfYourChoice*)`.

这将为您提供按钮的 0、0 点，但指向容器。（你也可以给另一个点 0, 0）

[在这里查看文档。](https://docs.microsoft.com/fr-fr/dotnet/api/system.windows.uielement.translatepoint)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-16T20:05:59.133

```
childObj.MouseDown += (object sender, MouseButtonEventArgs e) =>
{
    Vector parent = (Vector)e.GetPosition(parentObj);
    Vector child = (Vector)e.GetPosition(childObj); // sender
    Point childPosition = (Point)(parent - child);
}; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-22T18:59:51.797

嗯。您必须指定在`Mouse.GetPosition(IInputElement relativeTo)` 以下代码中单击的窗口对我来说效果很好

```
protected override void OnMouseDown(MouseButtonEventArgs e)
    {
        base.OnMouseDown(e);
        Point p = e.GetPosition(this);
    } 
```

我怀疑您需要不是从它自己的类而是从应用程序的其他点引用窗口。在这种情况下`Application.Current.MainWindow`会帮助你。

# html - 在不同浏览器上检查网页外观的方法

> ID：386738
> 
> 赞同：4
> 
> 时间：2008-12-22T17:02:24.937
> 
> 标签：html, css, browser, compatibility

我希望能够在发布之前查看网页在不同浏览器上的外观。我的机器上有几个，但我无法检查不同版本的 IE 和其他浏览器，也无法检查其他操作系统。我知道[http://browsershots.org/](http://browsershots.org/)但这有时需要大约 30 分钟，因此可能会出现故障排除问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-22T17:04:07.803

对于您的网络爆炸问题，[MultipleIE](http://tredosoft.com/Multiple_IE)可能有用吗？

对于操作系统问题，虚拟机是你的朋友 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T17:07:23.927

为了测试不同版本的 IE，我使用[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)。

BrowserShots 也不错，但正如你所说，它很慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T17:05:32.840

我建议使用一种或另一种虚拟机。[这里](https://stackoverflow.com/questions/227927/web-site-cross-browser-testing-in-practice)的讨论可能对你有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T07:47:34.133

[BrowserPool](http://browserpool.de/kc/wob/portal.jsp?lang=en)可以通过 VNC 客户端在不同的 Mac、Windows 和 Linux 系统上测试不同的浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T17:08:02.413

虚拟机是解决这个问题的经典解决方案。但是，如果 30 分钟来完成一整套浏览器测试对您来说太长了，我不确定是否有任何帮助！

澄清一下：Browsershots 让您可以测试许多不同的浏览器和浏览器版本。我认为在 30 分钟内对它们进行全部测试是非常合理的。但是，如果您的目标浏览器测试不佳，您显然需要一个本地安装的版本（因此虚拟机的角色）用于测试/更改/重新测试周期。这就是我在评论 30 分钟时所追求的！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T18:34:39.307

考虑 Selenium 产品，它可以通过各种浏览器运行自动化测试套件，并且全部在本地（或使用虚拟机）完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-22T21:00:13.740

@eulerfx，您没有告诉我们您使用的是哪个操作系统。像其他海报一样，我通过混合使用虚拟机 (VM) 和 IEtester 来实现您想要的。

由于我在 Mac 上开发（我在 Windows 上工作了 20 年后成为切换器，并且非常高兴这样做）我在我的 OS X 机器上测试了 Firefox 3 和 Safari 3 中的站点，在 Windows XP VM 上我测试了 Firefox 2， IE6、7 和 8 使用 IETester 以及我想要的任何其他浏览器，例如 Opera 和 Chrome。我还有第二个运行 Ubuntu 的虚拟机，因为我的网站也需要这种类型的兼容性。

我的工作流程是首先为 FF3 构建网站。一旦我对任务和外观感到满意，我就会按照上面给出的顺序检查所有浏览器。[例如，如果您在 IE6 中遇到特定问题，您可以使用条件注释](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)获得对 IE6 样式表所做更改的即时反馈。

我使用 Parallels 在 OS X 上创建 VM。有一个版本的 Parallels 在 Windows 上运行，但许多其他供应商也有类似的产品。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-12T07:48:23.593

如果速度是个问题，那么我可以推荐[Litmus](http://litmus.com/)。生成屏幕截图的速度非常快，但它非常昂贵。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-15T20:41:41.523

我会向你推荐：

离线免费方法：可下载的 IE 版本（多个 VM 版本）： [modern.ie](http://www.modern.ie/en-us/virtualization-tools#downloads)

在 Windows 8.1 Pro 中可以使用 Hyper-V（系统自带），如果搜索后看不到，可能需要在 Features 中开启

我不推荐IE测试仪，结果不好。

# c# - 为 Windows 编写的桌面应用程序可以在 Linux 上运行吗？

> ID：386741
> 
> 赞同：8
> 
> 时间：2008-12-22T17:02:56.213
> 
> 标签：c#, linux

为 Windows 平台设计的桌面应用程序（例如，使用 MS Visual Studio ）也可以在 Linux 平台上运行吗？如果是这样，请就应该做些什么来为此准备一些建议。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-22T17:05:53.963

鉴于您的标签，我假设它是一个 .NET 应用程序。有了这个假设，你应该看看[Mono 项目](http://mono-project.com/Main_Page)。您的应用程序*可能*无需更改即可运行；它*可以*在微小的变化后运行；它*可能*从根本上需要一些尚未在 Mono 中实现的 .NET。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-22T17:16:04.660

为了巩固和扩展上述一些答案......

如果您对使用过的“库”类很小心，它可能会在 Mono 下运行。

如果做不到这一点，下一个最简单的选择，WiNE 可能允许您直接在 Linux 上运行应用程序。

如果一切都失败了，总是可以创建一个虚拟机（使用 VirtualBox 或类似的东西）并在 Linux 机器上进行完整的 Windows 安装以运行您的软件。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-22T17:21:36.787

如果你打算使用 Mono，你应该检查[MoMA](http://mono-project.com/MoMA)。它是一个可以帮助您识别兼容性问题的工具。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-22T17:05:30.903

有可能，单声道，在这里查看[http://www.mono-project.com/Main_Page](http://www.mono-project.com/Main_Page)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-22T17:07:00.263

它可能适用于[wine](http://www.winehq.org/)。但并非所有应用程序都受支持。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-22T20:20:54.753

最简单的方法是专门使用[GTK#](http://en.wikipedia.org/wiki/Gtk_Sharp)控件编写应用程序。

此外，请确保您在 Windows 上使用 Mono 编译和运行代码，以确保您不使用 Mono 运行时不支持或尚未复制所有功能的任何函数或库。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-23T02:53:09.067

你也可以使用奇趣科技的 Qt。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-24T16:24:22.127

另一个添加到答案堆的跨平台工具包是[wxWidgets](http://www.wxwidgets.org/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-22T17:05:09.097

如果您使用 .net 构建它，它可以使用单声道运行。还有其他可能性，但我们需要更多细节。UI，库，线程，其他东西。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-22T17:08:18.090

您可以使用 Mono 运行，但是当您进入 Winforms 时会出现一些兼容性问题。如果您使用的是 WPF，那么我认为 Mono 还没有足够的支持来尝试这个。最好的方法，尽管对于已经编码的项目可能不是一个选项，是使用 GTK，它被 Mono 很好地支持，并且可以在 Windows 和 Linux 中运行。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-23T23:15:54.730

如果您在可以选择的平台/语言方面有足够的灵活性，那么您可能有许多不是 .Net 特定的选项。

*   Java（我会说是列表中最容易上手和最成熟的平台，因为它拥有庞大的用户群以及可用的书籍和文档的数量）
*   Python/TkInter
*   Ruby（有许多 GUI 工具包）

# python - 如何将 python 元组（字节数组）的一部分转换为整数

> ID：386753
> 
> 赞同：8
> 
> 时间：2008-12-22T17:06:00.857
> 
> 标签：python, tuples

我正在尝试使用 python 与设备交谈。我收到了一个包含存储信息的字节元组。如何将数据转换为正确的值：

响应 = (0, 0, 117, 143, 6)

前 4 个值是 32 位 int，告诉我已经使用了多少字节，最后一个值是使用的百分比。

我可以将元组作为 response[0] 访问，但看不到如何将前 4 个值放入我需要的 int 中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-22T17:36:02.887

将，

```
num = (response[0] << 24) + (response[1] << 16) + (response[2] << 8) + response[3] 
```

满足您的需求？

援助

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-22T17:10:02.877

请参阅[在 Python 中将字节转换为浮点数](https://stackoverflow.com/questions/5415/)

您可能想使用 struct 模块，例如

```
import struct

response = (0, 0, 117, 143, 6)
struct.unpack(">I", ''.join([chr(x) for x in response[:-1]])) 
```

假设一个无符号整数。可能有更好的方法来进行解包的转换，使用 join 的列表理解只是我想出的第一件事。

**编辑**：另请参阅 ΤZΩΤZΙΟΥ's comment on this answer about endianness。

**编辑#2**：如果您也不介意使用数组模块，这里是一种替代方法，可以避免列表理解的需要。感谢[@JimB](https://stackoverflow.com/questions/386753/how-do-i-convert-part-of-a-python-tuple-byte-array-into-an-integer#386998)指出 unpack 也可以对数组进行操作。

```
import struct
from array import array

response = (0, 0, 117, 143, 6)
bytes = array('B', response[:-1])
struct.unpack('>I', bytes) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T17:39:55.517

好的，您没有指定字节序或整数是否有符号，或者它（也许）使用 struct 模块更快，但是：

```
b = (8, 1, 0, 0)
sum(b[i] << (i * 8) for i in range(4)) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-22T18:41:19.400

您还可以使用数组模块

```
import struct
from array import array
response = (0, 0, 117, 143, 6)
a = array('B', response[:4])
struct.unpack('>I', a)

(30095L,) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-20T23:26:12.630

这看起来像是减少的工作！

您基本上需要的是一次移位一个字节，然后添加（添加）序列中的下一个字节。

```
a = (0, 0, 117, 143, 6)
reduce(lambda x, y: (x<<8) + y, a)
7704326 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T08:56:54.047

如何使用地图功能：

```
a = (0, 0, 117, 143, 6)
b = []
map(b.append, a) 
```

另外，我不知道这是否是您正在寻找的：

```
response = (0, 0, 117, 143, 6)
response[0:4] 
```

# javascript - Javascript 多次翻转

> ID：386759
> 
> 赞同：1
> 
> 时间：2008-12-22T17:08:42.380
> 
> 标签：javascript, rollover

我正在尝试使用 Javascript 进行多次翻转。我知道很多人说要使用 css，但这次要用 Javascript 来完成。

无论如何，我在这个翻转层次结构上遇到了很多麻烦。我有一个带有五个按钮的按钮图像导航。当您将鼠标悬停在其中一个按钮上时，该按钮会改变颜色，并且该按钮下方会出现一个标题。下一部分是用户必须将鼠标悬停在标题上，然后出现另一个图像，其中包含描述标题的文本。

因此，例如，按钮可能是一个红色的微笑，当您将其翻转时，它会变成一个蓝色的微笑，然后下方会出现一个标题，上面写着“快乐”。然后，如果您翻转快乐，您将获得描述快乐意味着什么的文字图像。这是客户想要的方式，我使用文本图像的唯一原因是因为他的文本使用了独特的字体。

所以，只是为了向您展示我一直在尝试编写代码，而不是在没有工作的情况下寻找答案，这是我到目前为止的代码。它有点工作，但它不是很好，我对javascript不太熟悉。

```
function rollover()
{
  var images = document.getElementsByTagName("img");
  var roll = new RegExp("roll");
  var header = new RegExp("_(?=roll)");
  var text = new RegExp("_(?=text)");
  var simple = new RegExp("simple");
  var currentRoll;
  var preload = [];
  var fileLoc = "images/rollovers/";

  for ( var i=0; i<images.length; i++)
  {
    if (images[i].id.match(roll))
    {
      currentRoll = images[i].id;
      preload[i] = new Image();
      preload[i].src = images[i].id + "_over.gif";
      images[i].onmouseover = function() 
      { 
        var button = this.id;
        this.src = fileLoc + this.id + "_over.gif";

        for ( var i=0; i<images.length; i++)
        {
          if (images[i].id.match(header))
          {
            var temp = images[i].id;
            if (images[i].id == "_" + this.id + "_header")
            {
              images[i].src = fileLoc + this.id + "_header.gif";
              images[i].style.visibility="visible";
              images[i].onmouseover = function() 
              {
                  for ( var i=0; i<images.length; i++)
                  {
                    if (images[i].id.match(text))
                    {
                      var temp = images[i].id;
                      images[i].src = fileLoc + this.id + "_text.gif";
                      images[i].style.visibility="visible";
                      break;

                    }
                  }  
              }
              break;
            }
            else
            {
              images[i].src = fileLoc + this.id + "_header.gif";
              images[i].setAttribute("id", 
              images[i].style.visibility="visible";
              images[i].onmouseover = function() 
              {
                for ( var i=0; i<images.length; i++)
                {
                  if (images[i].id.match(text))
                  {
                    var temp = images[i].id;
                    images[i].src = fileLoc + this.id + "_text.gif";
                    images[i].style.visibility="visible";
                    break;

                  }
                }  
              }
              break;
            }
          }
        }
        images[i].onmouseout = function() 
        { 
          this.src = fileLoc + this.id + "_org.gif"; 
          for ( var i=0; i<images.length; i++)
          {
            if (images[i].id.match(header))
            {

              images[i].style.visibility="hidden"
            }
          } 

        }
      }  
    }

    else if (images[i].id.match(simple))
    {
      preload[i] = new Image();
      preload[i].src = images[i].id + "_over.gif";
      images[i].onmouseover = function() 
      {
        this.src = fileLoc + this.id + "_over.gif";  
      }
      images[i].onmouseout = function()
      {
        this.src = fileLoc + this.id + "_org.gif";
      }
    }
  }
}

window.onload = rollover; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T17:18:14.000

煎饼..

您应该考虑使用[jQuery](http://jquery.com/)。

例如..

```
$(
    function() {
        $("img.rollover").hover(
            function() {
                this.src = this.src.replace("_org","_over");
            },
            function() {
                this.src = this.src.replace("_over","_org");
            }
        );
    }
) 
```

在功能内部，您还可以使用可见性并做任何您想做的事情。

# c# - 正确处理 DbConnection

> ID：386762
> 
> 赞同：2
> 
> 时间：2008-12-22T17:09:54.437
> 
> 标签：c#, dispose, dbconnection

我有一个名为 DatabaseHelper 的类，它包装了一个 DbConnection。为 using 语句设置此类的正确方法是什么？我已经实现了 IDisposible，但我不确定应该在何时何地调用 Connection.Close() 或 Connection.Dispose()。

当我在自己的 Dispose() 方法中简单地调用 Connection.Dispose() 时，有时我会从我的 DbConnection 对象中得到一个 SocketException。我认为这是因为旧连接处于打开状态，但没有附加到异常的详细信息，所以我不能确定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T17:13:09.393

从您的 dispose 方法中调用 connection.Dispose() 。您应该查看实现 IDisposable 的标准模式，它超越了简单地实现 IDisposable 接口并允许处置非托管对象等：

```
public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}

protected virtual void Dispose(bool disposing)
{
    if (!disposed)
    {
        if (disposing)
        {
            // Dispose managed resources.
        }

        // There are no unmanaged resources to release, but
        // if we add them, they need to be released here.
    }
    disposed = true;

    // If it is available, make the call to the
    // base class's Dispose(Boolean) method
    base.Dispose(disposing);
} 
```

（取自[http://msdn.microsoft.com/en-us/library/system.idisposable.aspx](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T17:18:33.203

根据[这个](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.adonet/topic41208.aspx)新闻组：

下面是 IDbConnection.Dispose() 的实现方式（如 Reflector 实用程序所示）：

客户端：

```
protected override void Dispose(bool disposing)
{
       if (disposing)
       {
             switch (this._objectState)
             {
                   case ConnectionState.Open:
                   {
                         this.Close();
                         break;
                   }
             }
             this._constr = null;
       }
       base.Dispose(disposing);
}

Odbc:
protected override void Dispose(bool disposing)
{
       if (disposing)
       {
             this._constr = null;
             this.Close();
             CNativeBuffer buffer1 = this._buffer;
             if (buffer1 != null)
             {
                   buffer1.Dispose();
                   this._buffer = null;
             }
       }
       base.Dispose(disposing);
}

OleDb:
protected override void Dispose(bool disposing)
{
       if (disposing)
       {
             if (this.objectState != 0)
             {
                   this.DisposeManaged();
                   if (base.DesignMode)
                   {
                         OleDbConnection.ReleaseObjectPool();
                   }
                   this.OnStateChange(ConnectionState.Open, ConnectionState.Closed);
             }
             if (this.propertyIDSet != null)
             {
                   this.propertyIDSet.Dispose();
                   this.propertyIDSet = null;
             }
             this._constr = null;
       }
       base.Dispose(disposing);
} 
```

您的 dispose 方法应仅在连接打开时尝试关闭连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-04T08:11:50.787

这个析构函数语法实际上是终结器。终结器正在调用 Dispose(false) 方法。

```
 #region IDisposable Members
    private bool _isDisposed;

    private void ThrowIfDisposed()
    {
        if (_isDisposed)
            throw new ObjectDisposedException(this.GetType().Name);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_isDisposed)
        {
            if (disposing)
            {
                //part 1 : disposing managed objects
                _command.Dispose();
                _command.Connection.Dispose();
                if (_command.Transaction != null)
                    _command.Transaction.Dispose();
            }
            //part 2: disposing unmanged objects. Here there are no unmanged objects.
            _isDisposed = true;
        }
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    //~DbCommandExecutor() //No need of finalize here. Because there is no unmanged objects in my class. ie, no code in part 2.
    //{
    //    Dispose(false);
    //}
    #endregion 
```

在**您的代码具有第 2 部分代码之前，****不需要**终结器（或析构函数）语法。否则，为了安全起见，应该实施。即，即使程序员没有正确调用 dispose 方法，finalize 也应该清理非托管资源。

 **比较示例：来自 msdn

[http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx) & [http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T20:00:11.457

只是为了完成 IDisposable 实现模式，约定为您的类包含一个终结器（析构函数），它调用 Dispose() 方法（传递 false）。这充当了一种故障安全机制，允许您在类的使用者未能调用 Dispose() 时处置非托管对象。

```
 ~MyClass() 
    {
        Dispose(false);
    } 
```

# algorithm - （内存）地址列表的良好哈希算法

> ID：386771
> 
> 赞同：6
> 
> 时间：2008-12-22T17:13:08.423
> 
> 标签：algorithm, hash

我有一个代表堆栈帧的（64 位）地址列表，我想将这些地址散列为一个 64 位数字，以帮助识别以前见过的地址。最多有 128 个地址。

我当前的算法通过遍历列表来计算散列，将每个地址异或到散列中，然后每个周期将散列旋转 11 位。

有更好的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T17:20:50.967

这里有几个不错的整数散列函数，用于 32 位和 64 位： http: [//www.concentric.net/~Ttwang/tech/intash.htm](http://www.concentric.net/~Ttwang/tech/inthash.htm)

这里也有一些写在上面：http: [//burtleburtle.net/bob/hash/evahash.html](http://burtleburtle.net/bob/hash/evahash.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T17:45:36.410

您可能会考虑某种[CRC](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)。

也许是[CRC64](http://code.activestate.com/recipes/259177/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T18:14:01.343

如果性能不是问题，您可以尝试加密哈希 - 截断到您想要的字节数。

# javascript - 简单易用、非侵入性的 JavaScript 调用堆栈可视化工具？

> ID：386778
> 
> 赞同：2
> 
> 时间：2008-12-22T17:15:41.447
> 
> 标签：javascript, graph, profile, visualize

谁能推荐一个用于 JavaScript 的图形调用堆栈可视化器，我可以安装在**Linux**机器上（或者是操作系统中立的）？最好是不需要修改被分析的 JavaScript。

我追求的东西类似于`valgrind`/生成的图表，`kcachegrind`但适用于 JavaScript。

**编辑**：有几个人建议使用 Firebug 的 Profile 工具。我已经使用了它，但不幸的是，它不能胜任我需要可视化器的工作。例如，能够看到脚本在 removeListener() 函数中花费了 20% 的时间并不能告诉我从哪里调用它并帮助追踪潜在的优化（除非我错过了 Firebug Profile 选项卡的某些方面） .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T18:30:58.703

Firebug 是一个用于 firefox 的插件，它有一个调用堆栈跟踪器，您可以在其中单击堆栈的各个元素并检查该上下文。也许不是业务中视觉上最奢华的调用堆栈检查器，但功能齐全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T18:51:33.437

绝对建议将 Firebug 作为中间解决方案，直到您找到与您想要的输出精确匹配的东西。

# objective-c - NSTask 没有从用户的环境中获取 $PATH

> ID：386783
> 
> 赞同：13
> 
> 时间：2008-12-22T17:18:24.060
> 
> 标签：objective-c, cocoa, bash, shell, nstask

我不知道为什么这个方法返回一个空白字符串：

```
- (NSString *)installedGitLocation {
    NSString *launchPath = @"/usr/bin/which";

    // Set up the task
    NSTask *task = [[NSTask alloc] init];
    [task setLaunchPath:launchPath];
    NSArray *args = [NSArray arrayWithObject:@"git"];
    [task setArguments:args];

    // Set the output pipe.
    NSPipe *outPipe = [[NSPipe alloc] init];
    [task setStandardOutput:outPipe];

    [task launch];

    NSData *data = [[outPipe fileHandleForReading] readDataToEndOfFile];
    NSString *path = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];

    return path;
} 
```

如果不是`@"git"`作为参数传递，而是通过，`@"which"`我会`/usr/bin/which`按预期返回。所以至少原理是有效的。

从终端

```
$ which which
$ /usr/bin/which
$
$ which git
$ /usr/local/git/bin/git 
```

所以它在那里工作。

我能想到的唯一一件事`which`就是不要搜索我环境中的所有路径。

这真让我抓狂！有没有人有任何想法？

**编辑：** 看起来这是关于设置 NSTask 或用户的 shell（例如，~/.bashrc），以便 NSTask 可以看到正确的环境（$PATH）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-11-30T04:39:01.753

尝试，

```
    [task setLaunchPath:@"/bin/bash"];
    NSArray *args = [NSArray arrayWithObjects:@"-l",
                     @“-C”，
                     @"哪个 git",
                     零];
    [任务集参数：参数]；

```

This worked for me on Snow Leopard; I haven't tested on any other system. The -l (lowercase L) tells bash to "act as if it had been invoked as a login shell", and in the process it picked up my normal $PATH. This did not work for me if the launch path was set to /bit/sh, even with -l.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-23T02:17:05.707

通过 NSTask 运行任务使用`fork()`并`exec()`实际运行任务。根本不涉及用户的交互式外壳。由于`$PATH`（总的来说）是一个 shell 概念，因此当您谈论以其他方式运行进程时，它并不适用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T17:29:19.827

运行程序时 /usr/local/git/bin 是否在 $PATH 中？我认为`which`只查看用户的 $PATH。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T18:48:15.860

看看问题[Find out location of an executable file in Cocoa](https://stackoverflow.com/questions/208897/find-out-location-of-an-executable-file-in-cocoa)。看起来基本问题是一样的。不幸的是，答案不是很好和整洁，但那里有一些有用的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-12T23:48:31.710

In Swift `NSTask` is replaced by `Process` but this is what it works for me:

```
let process = Process()
process.launchPath = "/bin/bash"
process.arguments = ["-l", "-c", "which git"] 
```

# java - 在 Java Swing 中，如何获得对窗口的 Win32 窗口句柄 (hwnd) 引用？

> ID：386792
> 
> 赞同：28
> 
> 时间：2008-12-22T17:20:57.910
> 
> 标签：java, winapi, swing, java-native-interface, hwnd

在 Java 1.4 中，您可以使用 ((SunToolkit) Toolkit.getDefaultToolkit()).getNativeWindowHandleFromComponent() 但这已被删除。

看起来您现在必须使用 JNI 来执行此操作。您是否有 JNI 代码和示例 Java 代码来执行此操作？

我需要它来调用 Win32 GetWindowLong 和 SetWindowLong API 调用，这可以通过 Jawin 库来完成。

我想要一些非常精确的东西，这样我就可以传递对 JDialog 或 JFrame 的引用并获取窗口句柄。

[使用 JNI 的 Swing 透明度](https://stackoverflow.com/questions/265602/swing-transparency-using-jni)可能是相关的。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-09-16T21:02:34.810

您没有编写任何 C/JNI 代码。来自Java：

```
import sun.awt.windows.WComponentPeer;

public static long getHWnd(Frame f) {
   return f.getPeer() != null ? ((WComponentPeer) f.getPeer()).getHWnd() : 0;
} 
```

注意事项：

*   这使用了一个 sun.* 包。显然这不是公共 API。但它不太可能改变（我认为比上面的解决方案更不可能打破）。
*   这将仅在 Windows 上编译和运行。您需要将其转换为反射代码才能使其具有可移植性。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-23T18:50:57.133

这个小 JNI 方法接受一个窗口标题并返回相应的窗口句柄。

```
JNIEXPORT jint JNICALL Java_JavaHowTo_getHwnd
     (JNIEnv *env, jclass obj, jstring title){
 HWND hwnd = NULL;
 const char *str = NULL;

 str = (*env)->GetStringUTFChars(env, title, 0);
 hwnd = FindWindow(NULL,str);
 (*env)->ReleaseStringUTFChars(env, title, str);
 return (jint) hwnd;
 } 
```

更新：

使用 JNA，它会更容易一些。我做了一个[小例子](http://www.rgagnon.com/javadetails/java-detect-if-a-program-is-running-using-jna.html)，它找到句柄并用它把程序带到前面。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-05T17:40:05.853

下面的代码允许您传递一个组件来获取它的窗口句柄 (HWND)。为了确保一个组件有一个对应的窗口句柄，在组件上调用 isLightWeight() 并验证它是否等于 false。如果没有，请通过调用 Component.getParent() 尝试它的父级。

Java代码：

```
package win32;
public class Win32 {
    public static native int getWindowHandle(Component c);
} 
```

头文件 main.h：

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class win32_Win32 */

#ifndef _Included_win32_Win32
#define _Included_win32_Win32
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     win32_Win32
 * Method:    getWindowHandle
 * Signature: (Ljava/awt/Component;Ljava/lang/String;)I
 */
JNIEXPORT jint JNICALL Java_win32_Win32_getWindowHandle
  (JNIEnv *, jclass, jobject);
#ifdef __cplusplus
}
#endif
#endif 
```

C 源代码 main.c：

```
#include<windows.h>
#include <jni.h>
#include <jawt.h>
#include <jawt_md.h>

HMODULE _hAWT = 0;

JNIEXPORT jint JNICALL Java_win32_Win32_getWindowHandle
  (JNIEnv * env, jclass cls, jobject comp)
{
    HWND hWnd = 0;
    typedef jboolean (JNICALL *PJAWT_GETAWT)(JNIEnv*, JAWT*);
    JAWT awt;
    JAWT_DrawingSurface* ds;
    JAWT_DrawingSurfaceInfo* dsi;
    JAWT_Win32DrawingSurfaceInfo* dsi_win;
    jboolean result;
    jint lock;

    //Load AWT Library
    if(!_hAWT)
        //for Java 1.4
        _hAWT = LoadLibrary("jawt.dll");
    if(!_hAWT)
        //for Java 1.3
        _hAWT = LoadLibrary("awt.dll");
    if(_hAWT)
    {
        PJAWT_GETAWT JAWT_GetAWT = (PJAWT_GETAWT)GetProcAddress(_hAWT, "_JAWT_GetAWT@8");
        if(JAWT_GetAWT)
        {
            awt.version = JAWT_VERSION_1_4; // Init here with JAWT_VERSION_1_3 or JAWT_VERSION_1_4
            //Get AWT API Interface
            result = JAWT_GetAWT(env, &awt);
            if(result != JNI_FALSE)
            {
                ds = awt.GetDrawingSurface(env, comp);
                if(ds != NULL)
                {
                    lock = ds->Lock(ds);
                    if((lock & JAWT_LOCK_ERROR) == 0)
                    {
                        dsi = ds->GetDrawingSurfaceInfo(ds);
                        if(dsi)
                        {
                            dsi_win = (JAWT_Win32DrawingSurfaceInfo*)dsi->platformInfo;
                            if(dsi_win)
                            {
                                hWnd = dsi_win->hwnd;
                            }
                            else {
                                hWnd = (HWND) -1;
                            }
                            ds->FreeDrawingSurfaceInfo(dsi);
                        }
                        else {
                            hWnd = (HWND) -2;
                        }
                        ds->Unlock(ds);
                    }
                    else {
                        hWnd = (HWND) -3;
                    }
                    awt.FreeDrawingSurface(ds);
                }
                else {
                    hWnd = (HWND) -4;
                }
            }
            else {
                hWnd = (HWND) -5;
            }
        }
        else {
            hWnd = (HWND) -6;
        }
    }
    else {
        hWnd = (HWND) -7;
    }
    return (jint)hWnd;

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-04-27T16:41:40.237

我发现了这个：http: [//jna.java.net/javadoc/com/sun/jna/Native.html#getWindowID](http://jna.java.net/javadoc/com/sun/jna/Native.html#getWindowID(java.awt.Window) (java.awt.Window )

JNA 让您无需编写 jni 本机代码即可调用本机库。原来库本身有一个方法，它接受一个 Window 并产生一个 int，大概是一个句柄（或指针？），希望能在所有平台上工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-01T20:46:48.930

在 JNA 库中，我们看到在 Java 5 和 6 中使用 Native AWT 在无头运行时出现 UnsatisfiedLinkError，因此使用动态链接。参见[https://github.com/twall/jna/blob/master/native/dispatch.c](https://github.com/twall/jna/blob/master/native/dispatch.c)`Java_com_sun_jna_Native_getWindowHandle0`中的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-03T18:43:30.793

这与 Jared MacD 的答案相同，但它使用反射，以便代码可以在非 Windows 计算机上编译和加载。当然，如果您尝试调用它，它将失败。

```
import java.awt.Frame;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class WindowHandleGetter {
    private static final Logger log = LoggerFactory.getLogger(WindowHandleGetter.class);
    private final Frame rootFrame;

    protected WindowHandleGetter(Frame rootFrame) {
        this.rootFrame = rootFrame;
    }

    protected long getWindowId() {

        try {
            Frame frame = rootFrame;

            // The reflection code below does the same as this
            // long handle = frame.getPeer() != null ? ((WComponentPeer) frame.getPeer()).getHWnd() : 0;

            Object wComponentPeer = invokeMethod(frame, "getPeer");

            Long hwnd = (Long) invokeMethod(wComponentPeer, "getHWnd");

            return hwnd;

        } catch (Exception ex) {
            log.error("Error getting window handle");
        }

        return 0;
    }

    protected Object invokeMethod(Object o, String methodName) throws IllegalAccessException, IllegalArgumentException, InvocationTargetException {

        Class c = o.getClass();
        for (Method m : c.getMethods()) {
            if (m.getName().equals(methodName)) {
                Object ret = m.invoke(o);
                return ret;
            }
        }
        throw new RuntimeException("Could not find method named '"+methodName+"' on class " + c);

    }

} 
```

# sql - 选择前 1000 个，但知道有多少行？

> ID：386795
> 
> 赞同：3
> 
> 时间：2008-12-22T17:22:37.173
> 
> 标签：sql, sql-server-2005, performance

SQL 服务器 2005

我在数据库中有 1000 万行，并运行一个选择（有很多“位置”和关节......非常复杂）。结果显示在网格中（想想 goolge 结果），因此，用户不可能使用超过 1000 个结果。

所以我将我的 SQL 限制为 TOP 1000。

**问题**：用户仍然想知道他的搜索有 5432 个结果。

我能否在不付出代价的情况下获得该信息（或者换句话说，仍然可以获得“前 1000 名”给我的速度优势？）

**假设** - 假设 TOP 1000 在**100K**行中带来 1000行。所以即使是移动 100K 的网络价格也可能是一个问题。

**结论** 没有免费的午餐！您可以获得优雅的方式（接受的答案），但它仍然需要与更昂贵的操作一样长的时间（即计算所有结果）。在现实生活中，我将使用 2 SQL 方法，一种返回前 1000 行进行显示，另一种是 ASYNC 并使用 count(*) 结果更新一些 AJAX 面板，这将花费更长的时间到计算机上

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T18:20:55.463

```
SELECT TOP 1000 x, y, z, COUNT(*) OVER () AS TotalCount
FROM dbo.table 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T17:26:03.033

就我个人而言，我会选择两条语句命中数据库。一个检索计数，一个检索前 1000 条记录。

您可以批量运行这两个查询，以通过节省到数据库的往返行程来获得一点额外的性能。

```
-- Get the count
select count(*) from table where [criteria]

-- Get the data
select [cols] from table where [criteria] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T17:26:49.693

您想使用“计数”和分组依据，请查看此参考：http: [//msdn.microsoft.com/en-us/library/ms175997.aspx](http://msdn.microsoft.com/en-us/library/ms175997.aspx)

您的问题似乎也在这里发布：[http ://www.eggheadcafe.com/software/aspnet/32427870/select-top-n-plus-a-count.aspx](http://www.eggheadcafe.com/software/aspnet/32427870/select-top-n-plus-a-count.aspx)

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T17:33:23.283

您可能高估了“前 1000 名”的性能优势，尤其是在总共只有约 5000 个结果的情况下。

服务器已经完成了所有的连接和工作（这通常是困难的部分），然后必须按照您指定的方式对结果集进行排序，然后最终获取 1000 个第一个结果。

这里有两个选项：

1) 使用 Count(*) 进行一次查询以获取结果计数，然后使用前 1000 名进行第二次查询，检索适当的列（如 Neil 建议的那样）。或
2）第一次检索所有行，将它们缓存在结果集中，然后只向用户显示 1000 行。

听起来第一个可能会更快，但第二个只需访问数据库一次，并且根据您的数据库和查询的具体情况，可能会更好（只要数据库不会返回 100,000 行！ )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T18:09:31.463

由于您使用的是 SQL Server 2005，因此您可以使用 CTE 进行此类查询。这是我目前正在为客户做的事情：

```
;WITH Search_Results AS
(
     SELECT TOP(@system_max_rows)
          my_column1,
          my_column2,
          ROW_NUMBER() OVER
          (
               ORDER BY
                    -- Your order criteria here
          ) AS row_num,
          COUNT(my_column1) OVER (PARTITION BY '') As total_count
     FROM
          My_Table
     -- Put any joins here
     WHERE
          -- Put WHERE criteria here
)
SELECT
     my_column1,
     my_column2,
     row_num,
     total_count
FROM
     Search_Results
WHERE
     ((row_num - 1)/@rows_per_page) + 1 = CASE
                WHEN ((total_count - 1)/@rows_per_page) + 1 < @page_number THEN ((total_count - 1)/@rows_per_page) + 1
                ELSE @page_number
           END
OPTION (RECOMPILE) 
```

重新编译在那里是因为搜索条件在对存储过程的调用之间可能会发生巨大变化，从而使缓存的查询计划变得糟糕。希望参数/变量是显而易见的。这是针对分页搜索解决方案的。系统最大行数变量是硬编码的，因此即使应用程序也无法覆盖可以返回的最大行数并导致服务器崩溃。要获得前 1000 名，您需要传入 @page_number = 1 和 @rows_per_page = 1000。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-22T18:16:54.957

这不会回答您的问题，但我认为这是我们实施的一个很好的案例：

*   硬件便宜
*   程序员不便宜

规则。

是的，做两个查询（一个计数，一个选择 *）不是最佳解决方案（您可以在一个查询中完成！）。但是你有多大**把握**这将成为一个瓶颈？

我被这些问题困住了，我必须自己记住这一点才能继续发展。

写得快，写得更好，PROFILE，然后写得最好。

或者，也许这**是**瓶颈，这就是您要问的原因。但在我看来，如果这是您的瓶颈，更好的优化将是重组数据库，以便简化您的查询本身。

# .net - 是否有 HybridDictionary 的通用版本？

> ID：386823
> 
> 赞同：10
> 
> 时间：2008-12-22T17:34:12.923
> 
> 标签：.net

System.Collection.Specialized.HybridDictionary 的描述是这样的：

> 通过在集合较小时使用 System.Collections.Specialized.ListDictionary 来实现 IDictionary，然后在集合变大时切换到 System.Collections.Hashtable。

是否有等效的通用实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T17:44:14.587

从来没听说过。但是，是否存在已证明的需求？哈希表没有很大的开销，即使对于非常小的*N*来说，使用普通的哈希表应该比线性搜索更快。

**编辑**我没有一个基准来证明它，但只是通过比较算法我得出结论，哈希表应该比线性搜索快，只要*N* > 6 平均（对于字符串键或类似的非平凡哈希），所以真的没有混合实现的原因。

论据如下。在线性搜索中，平均一半的元素必须与您的输入进行比较，即*N*  / 2。在哈希表中，已知预期的比较次数为 2，无论输入大小如何（对于非常小的哈希表负载因子小于 0.1 这实际上接近 1)。此外，必须计算哈希。这会导致对您的输入进行 3 次操作，以及可以忽略的非常小的开销。因此，我们搜索哪个*N*是真的 3 > *N*  / 2，这通常是*N*  > 6。

请注意，上面的计算实际上是错误的，因为对于这么少的元素，.NET 的负载因子`Dictionary`将远小于 0.1。因此，临界点实际上甚至更低。

# winforms - 在 .NET WInForms 中，什么可能导致 64 位 vista 上而不是 32 位上的重绘问题？

> ID：386826
> 
> 赞同：8
> 
> 时间：2008-12-22T17:35:38.880
> 
> 标签：winforms, windows-vista, 64-bit, redraw

在为 Any Cpu 编译以及编译到 x86 时会发生这种情况。除非调整大小，否则 GUI 的部分不会重绘，例如，如果主窗体最大化，则某些控件不会随之调整大小，而其他部分则不会重绘并显示以前存在的内容。

这在 32 位机器上运行良好，包括 XP 和 Vista，但在 64 位 Vista 上（没有 x64 XP 可以测试）重绘就不能正常工作。

有人对从哪里开始追踪这个有任何想法吗？

编辑：这发生在两台不同的机器上，至少我目前使用的那台机器拥有来自 NVidia 的最新驱动程序。

Edit2：在我的 64 位机器上运行 32 位 XP 虚拟机，并且应用程序在 VM 中没有出现重绘问题

Edit3：这可能是驱动程序问题，但我们不知道驱动程序是否或何时会解决该问题。一位同事说，家里的 ATI 卡问题比 NVidia 少，但在过去的几个月里，我几乎每个月都在更新我的视频驱动程序，但仍然没有解决，所以我们不能只发布我们的产品并告诉我们的客户有一天驱动程序制造商可能会解决这个问题。

有没有人对要避免的事情有任何见解？我们正在编译为 x86，我们所有的组件都是 x86。我似乎无法用测试项目中的任何组件重现此问题，而且我还没有听到其他人在大多数组件论坛上报告这些问题，因此很可能这是我们正在做的事情。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-17T00:23:22.880

这听起来很像[这个](http://blogs.msdn.com/alejacma/archive/2008/11/20/controls-won-t-get-resized-once-the-nesting-hierarchy-of-windows-exceeds-a-certain-depth-x64.aspx)问题。

在 Windows 上调整窗口大小时，您通常会得到一个链，其中每个窗口接收一条`WM_SIZE`消息，然后调用`MoveWindow()`（或类似的）其子级，这些子级依次接收 a`WM_SIZE`等等。我确信.NET 在幕后做同样的事情。

在 x64 上，Windows 限制了这种嵌套的深度，并且在某个点（12-15 个嵌套窗口）之后，它将不再发送`WM_SIZE`消息。x86 上似乎不存在此限制。此限制会影响在 x64 版本的 Windows 上运行的 x86 和 x64 代码。

这困扰了我们很长时间，因为不同的 x64 安装会显示不同的症状。上面的 MSDN 博客帖子有一些可能的解决方法 - 我们最终使用辅助线程异步处理窗口大小，这相当巧妙地解决了问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T15:39:53.283

如果您使用的是 Windows 窗体，则可能与 Windows 64 位上的嵌套限制问题有关。

详情在这里：[http ://www.feedghost.com/Blogs/BlogEntry.aspx?EntryId=17829](http://www.feedghost.com/Blogs/BlogEntry.aspx?EntryId=17829)

总之...

来自 MS 源，在 Control.SetBoundsCore 中：

```
SafeNativeMethods.SetWindowPos(new HandleRef(window, Handle), NativeMethods.NullHandleRef, x, y, width, height, flags);

// NOTE: SetWindowPos causes a WM_WINDOWPOSCHANGED which is processed
// synchonously so we effectively end up in UpdateBounds immediately following
// SetWindowPos.
//
//UpdateBounds(x, y, width, height); 
```

并来自 MSDN：

[http://social.msdn.microsoft.com/forums/en-US/windowsuidevelopment/thread/25181bd5-394d-4b94-a6ef-06e3e4287527/](http://social.msdn.microsoft.com/forums/en-US/windowsuidevelopment/thread/25181bd5-394d-4b94-a6ef-06e3e4287527/)

> “一项小调查表明，当 Windows 达到某个嵌套级别时，它会停止发送 WM_SIZE。换句话说，如果您在父窗口中处理 WM_SIZE 时尝试调整它们的大小，它不会将 WM_SIZE 发送到您的子窗口。取决于USER stuff/updates/service 打包了它停止传播 WM_SIZE 的最大嵌套级别，在最新的 XP 32bit/sp2 下可能从 15 到 31 不等，甚至更高（实际上无法访问）。
> 
> 但是在 XP x64 下它仍然太少，并且在某些 Vista 版本下，其他消息仍然会发生一些类似的丑陋事情。
> 
> 所以这肯定是一个 Windows 错误。”

您有两种选择：要么减少控件层次结构的深度（更理想的解决方案），要么从您使用的每个系统控件中派生“固定”控件，如下所示：

```
public class FixedPanel : Panel
{
  protected override void SetBoundsCore( int x, int y, int width, int height, BoundsSpecified specified )
  {
    base.SetBoundsCore( x, y, width, height, specified );

    if( specified != BoundsSpecified.None )
    {
      if( ( specified & BoundsSpecified.X ) == BoundsSpecified.None )
      {
        x = Left;
      }
      if( ( specified & BoundsSpecified.Y ) == BoundsSpecified.None )
      {
        y = Top;
      }
      if( ( specified & BoundsSpecified.Width ) == BoundsSpecified.None )
      {
        width = Width;
      }
      if( ( specified & BoundsSpecified.Height ) == BoundsSpecified.None )
      {
        height = Height;
      }
    }

    if( x != Left || y != Top || width != Width || height != Height )
    {
      UpdateBounds( x, y, width, height );
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T14:54:04.143

我认为此问题的最可能原因是您的应用程序中的重绘问题。可能在 64 位上存在细微的 Windows 消息排序差异，这会在您的代码中暴露此问题。

您可以通过执行以下操作来对此进行试验。

1.  将计时器添加到您的应用程序。
2.  在事件处理程序中调用 flakyControl.Update()

我会将计时器设置为大约 5 秒。然后在 Win64 上运行应用程序，看看是否能解决问题。如果是这样，那么最可能的原因是您的控件之一没有正确发出它已失效的信号。

我将从应用程序中的任何自定义控件开始。系统地向代码中的每个重写方法和事件处理程序添加更新调用。最终你会找到解决问题的那个，然后你就会知道错误到底在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-06T15:48:55.890

如果您使用 MSDN[博客](http://blogs.msdn.com/alejacma/archive/2008/11/20/controls-won-t-get-resized-once-the-nesting-hierarchy-of-windows-exceeds-a-certain-depth-x64.aspx)中描述的 BeginInvoke() 解决方案，请确保禁用覆盖 OnSizeChanged() 的控件的子项的停靠。我有 Dock = DockStyle.Fill 并且必须更改为 DockStyle.None 才能使修复工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T17:44:55.990

对我来说听起来像是显示驱动程序的问题...

尝试更新到最新的驱动程序，看看是否能解决问题？64/32 位差异可能是一个红鲱鱼......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T17:48:32.330

我同意戈登的观点。我见过一些问题，即全新的 64 位机器在 32 位下看起来不错的程序出现显示问题，但在 64 位机器上会出现奇怪的问题。更新到最新/推荐的驱动程序几乎总能解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-14T12:15:45.043

您可以在虚拟操作系统上毫无问题地运行程序这一事实表明这是驱动程序问题，因为（至少在 VirtualPC 中）图形卡是模拟的。这意味着显卡通常会处理的某些事情现在由 CPU 完成，因此不与显卡驱动程序交互。请注意，我不是虚拟化专家，我认为虚拟化层可能会以其他方式影响问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-15T06:00:56.450

我相信这与树中嵌套的 HWND 的数量有关。我不知道具体细节，但对 64 位的嵌套 HWND 有一些限制。我看到它发生的时候，我通过从完整的 vista 基本（或航空）主题退回到 windows 经典来解决它。在这一点上，问题消失了。

尝试切换到经典，如果可以解决问题，请查看是否可以减少嵌套 HWND 的数量。

# favicon - 为什么我的网站图标不起作用？

> ID：386828
> 
> 赞同：0
> 
> 时间：2008-12-22T17:35:51.703
> 
> 标签：favicon

现在我知道围绕 SO 有很多类似的问题，但我认为我已经涵盖了所有基础知识。这是我所知道的：

我的 favicon 可通过 /favicon.ico 访问（[完整链接](http://www.bandcmotors.co.uk/favicon.ico)）

HTML 是（[页面 URL](http://www.bandcmotors.co.uk)）：

```
<link rel="icon" href="http://www.bandcmotors.co.uk/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="http://www.bandcmotors.co.uk/favicon.ico" type="image/x-icon" /> 
```

我也尝试过相对和绝对版本。没爱。

HTTP 响应标头：

```
Date: Mon, 22 Dec 2008 15:07:34 GMT
Server: Cherokee
Etag: 494bc264=57e
Last-Modified: Fri, 19 Dec 2008 15:48:52 GMT
Content-Type: image/x-icon
Content-Length: 1406

200 OK 
```

该图标在浏览器中加载正常，并且我已清除缓存，但在地址栏或选项卡中仍然看不到该图标。在 Firefox 或 IE 上。

我到底做错了什么？

编辑 1\. 我使用[了一个验证器](http://www.html-kit.com/favicon/validator/)，它相当有帮助地告诉我它无法下载它。考虑到我可以很好地下载它，这很奇怪......如果有人能解释一下，它可能有助于解决问题。

编辑 2\. 我刚刚踢了我的电脑，重新启动，一切正常。我讨厌拒绝正确清除自己的缓存****抱怨****> =（

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T17:43:54.883

您是否尝试过使用 gif 或 png？[W3C 文档](http://www.w3.org/2005/10/howto-favicon)引用了以下内容：

> 但是，您选择的图像格式必须是 16x16 像素或 32x32 像素，使用 8 位或 24 位颜色。图像格式必须是 PNG（W3C 标准）、GIF 或 ICO 之一

你的形象符合吗？您是否尝试过使用其他网站图标？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T17:48:48.773

它工作正常，您的浏览器可能出于某种原因正在缓存它。

顺便说一句，在这种情况下不建议使用 ETag，最好只使用“Expires：”标题...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T17:42:58.723

它在我的 Safari 浏览器中运行良好，即使在 Windows 中也是如此...... ;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T17:48:00.053

您是否尝试过使用图标的相对路径，而不是完整的“http://....”地址？例如：

```
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /> 
```

另一个建议是删除 type 属性：

```
<link rel="shortcut icon" href="/favicon.ico" /> 
```

我也可以在 Firefox 和 Opera 中看到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T17:50:07.243

这可能是您的托管服务提供商（如果适用）的问题。GoDaddy 和其他流行的托管服务提供商会缓存某些详细信息并大约每小时刷新一次您的“虚拟服务器”。

# c# - 对“程序不包含静态'Main'方法”进行故障排除...？

> ID：386831
> 
> 赞同：57
> 
> 时间：2008-12-22T17:36:35.023
> 
> 标签：c#, compilation

我的 MS Visual C# 程序正在编译和运行得很好。我关闭 MS Visual C# 以开始做其他生活中的事情。

我重新打开它并（在做任何其他事情之前）转到“发布”我的程序并收到以下错误消息：

> Program C:\myprogram.exe 不包含适用于入口点的静态“Main”方法

嗯？是的，它确实......而且一切都在 15 分钟前工作。当然，我可以相信我在关闭之前不小心撞到了什么或做了什么……但是什么？我该如何解决这个问题？

我的 Program.cs 文件如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Threading;

namespace SimpleAIMLEditor
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            Application.Run(new mainSAEForm());
        }
    }
} 
```

......那里有一些评论。没有其他错误。

帮助？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-12-22T17:45:32.463

文件上的属性是否设置为编译？

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2016-08-04T12:25:25.887

我为这个错误而苦苦挣扎，只是因为**我的一个`class library`项目** `was set acceddentaly`是**控制台应用程序**

所以确保你的类库项目是输出类型的类库

[![在此处输入图像描述](https://i.stack.imgur.com/pzRCw.png)](https://i.stack.imgur.com/pzRCw.png)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-05-15T15:41:20.597

好的，我也在看这个问题。就我而言，解决方案太简单了。我在解决方案中添加了一个新的空项目。新添加的项目会自动设置为控制台应用程序。但是由于添加的项目是一个“空”项目，因此该新项目中不存在 Program.cs。（正如预期的那样）

我需要做的就是将项目属性的输出类型更改为类库

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-04-14T15:54:10.833

如果您有 WPF 或 Silverlight 应用程序，请确保 App.xaml 具有“ApplicationDefinition”作为文件属性上的 BuildAction。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-06-22T11:35:57.953

我有这个错误并通过这个解决方案解决。

```
--> Right click on the project

--> and select "Properties"

--> then set "Output Type" to "Class Library". 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-22T17:55:11.850

检查项目的属性。在“应用程序”选项卡上，选择您的`Program`类作为启动对象：

[![替代文字](https://i.stack.imgur.com/YyLDp.jpg)](https://i.stack.imgur.com/YyLDp.jpg)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-22T17:43:52.670

这很奇怪。您的程序是否成功编译并运行并且仅在“发布”时失败，还是现在每次编译都失败？

另外，您是否可能将文件的属性更改为`Build Action`其他内容`Compile`？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-07-27T13:23:34.357

我遇到了这个问题，这是因为我没有使用最新版本的 C#（撰写本文时为 C# 7.3），我不得不将下面的`internal`访问修饰符更改为`public`.

```
internal class Program
 {
    public static void Main(string[] args)
    {
        //My Code
    }
  } 
```

或修改`.csproj`以使用最新版本的 C# （这样意味着我仍然可以将上述类保留为`internal`）：

```
<PropertyGroup>
    <LangVersion>latest</LangVersion>
    <NoWin32Manifest>true</NoWin32Manifest>
</PropertyGroup> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-05-08T16:58:17.447

对我来说，发生同样的错误是因为我重**命名**了 Program 类的命名空间。 **项目“应用程序”选项卡**
中的**“启动对象”**字段仍然引用旧的命名空间。选择新的启动对象解决了问题，并从该列表中删除了过时的条目。 您可能还想更新同一“应用程序”选项卡中的**“默认命名空间”**字段。

 ***** * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-13T06:41:54.320

将该`Main`方法放在在 Visual Studio 中正确配置为启动对象的类中，这一点很重要：

*   在项目资源管理器中右键单击您的项目；选择“属性...”
*   在属性对话框中，选择“应用程序”选项卡
*   在应用程序选项卡中，`SimpleAIMLEditor.Program`从下拉列表中选择您的启动对象

现在再次运行您的应用程序。错误将消失。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-07-06T06:02:15.403

什么对我有用：关闭 MS Visual Studio，然后启动 Visual Studio 并打开解决方案。然后错误消息消失了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T19:45:05.873

我发现 Program.cs 文件不是解决方案的一部分。我做了一个添加现有项目并将文件（Program.cs）添加回解决方案。

这更正了错误：错误 1 ​​程序 '..... 不包含适合入口点的静态 'Main' 方法

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-08-29T01:35:25.090

我的问题是我不小心设置了 Main 的参数

静态无效主要（**对象值**）

感谢我的重构工具。花了几分钟才弄清楚，但应该在此过程中帮助某人。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-04-03T19:53:06.343

在我的情况下（没有一个建议的解决方案适合），问题出在我使用`async/await`的方法签名`main`看起来像这样的地方：

```
static async void Main(string[] args) 
```

我只是删除`async`了，所以该`main`方法看起来是这样的：

```
static void Main(string[] args) 
```

我还删除了所有实例`await`并用于`.Result`异步调用，因此我的控制台应用程序可以愉快地编译。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-05-20T16:38:10.687

我变了

```
public static void Main(string[] args) 
```

到

```
public async static void Main(string[] args) 
```

问题是它需要成为一项任务：

```
public async static Task Main(string[] args) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-02T10:00:28.943

就我而言，这是一个显示此错误的 XUnit 测试库。我错误地删除了`Microsoft.NET.Test.Sdk`包。

# apache - 帮助 mod_rewrite 和 Joomla

> ID：386832
> 
> 赞同：1
> 
> 时间：2008-12-22T17:36:38.877
> 
> 标签：apache, mod-rewrite, http-headers

在我的 Joomla 网站上，我已将一些相当直接的 RewriteRules 添加到我的 .htaccess 文件中。它们都是这样的一对一规则，因为我正在更改站点的文件结构并且不想破坏我的旧链接。

```
RewriteRule ^content/view/54/48/$ /courses [R] 
```

这些是 Joomla 附带的现有规则的补充：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/index.php
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$  [NC]
RewriteRule (.*) index.php
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L] 
```

如果我注释掉现有的 Joomla 规则，那么我可以看到我的规则正常工作，并且当我在`http://example.com/content/view/54/48/`浏览器地址栏中键入时更改为`http://example.com/courses`，但是如果我离开这些其他规则，那么 Joomla 不知道如何处理它（它给出“未知组件错误”）。如果我`http://example.com/courses`直接输入，那么它会按预期工作，所以我觉得这是我重写的问题，而不是 Joomla。

我认为 RewriteRules 是按顺序相互作用的。例如：

```
RewriteRule a b
RewriteRule b c   # a request for "a" will take you to "c" 
```

我在共享主机上，所以很遗憾我无法打开登录。有人对我有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T17:44:19.953

尝试将规则中的 [R] 更改为 [R,L] ...

# vb.net - 查找 Outlook.MAPIFolder 的类型

> ID：386834
> 
> 赞同：2
> 
> 时间：2008-12-22T17:36:56.113
> 
> 标签：vb.net, outlook, outlook-object-model

我正在为应用程序构建 Outlook 控件，并通过递归添加子文件夹来填充树列表。这些文件夹被声明为 Outlook.MAPIFolder。但该应用程序只允许从实际电子邮件导入，所以我想排除包含日历项目的文件夹。我可以右键单击 Outlook 中的这些文件夹，转到属性，然后将类型视为“包含日历项目的文件夹”。但我似乎无法在 VB.Net 中以编程方式解决这个问题。我错过了一些简单的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T21:43:57.490

如果您只想要邮件文件夹，只需检查文件夹的`DefaultItemType`属性是`olMailItem`还是`olPostItem`。

`DefaultItemType`：http:
[//msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.mapifolder.defaultitemtype.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.mapifolder.defaultitemtype.aspx)

`OlItemType`枚举：http:
[//msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.olitemtype.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.olitemtype.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T17:45:52.697

对象上的 MessageClass 将告诉您正在处理的对象类型。MessageClass 还确定对象将存在于哪个文件夹中以及将显示什么形式来呈现它。

这是一个参考：

[http://msdn.microsoft.com/en-us/library/aa171490(office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa171490(office.11).aspx)

高温高压

# php - PHP中简单/可重用的CRUD（没有名声或大类）

> ID：386838
> 
> 赞同：1
> 
> 时间：2008-12-22T17:38:01.790
> 
> 标签：php, crud, code-reuse

我正在开发一个类似 PHP CMS 的项目，并且试图找出在 PHP 中处理 CRUD 功能的最方便的方法。

CMS 完全使用程序 PHP 进行编程（没有 OOP - 我知道你们中的许多人不会同意这一点......），并且旨在保持一切尽可能简单和轻便，以及创建高度可重用的函数和代码片段.

CMS 允许根据需要安装/激活多个模块。这些模块描述了不同类型的内容，所以我可能最终会得到一些像页面、新闻、博客这样的东西，仅举几例。

对于这些内容类型中的每一种，我都必须创建 CRUD 操作，现在我正在尝试找到最方便的方法来实现这一点。

一个要求是这些内容类型中的每一个的表单都包含在单个外部文件中（用于插入和编辑），并且如果有某种方法可以集成服务器端输入验证，那将是一个加号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T18:19:01.943

CRUD 操作是指（繁琐的）数据库查询吗？

您可以轻松地设置数据库，以便除了内容类型中的一些常见字段外，特定内容类型的所有数据都存储为 TEXT 字段中的序列化关联数组。

这样，您只需对任何特定内容类型的 CRUD 进行一组查询，因为传递给 CRUD 函数的数据只是盲目地序列化。

例如，假设我们声明内容标题、创建/更新日期、标签和简短描述被视为通用数据。从那里我们有一个博客和一个页面内容类型。

我可能会这样创建一个数据库表：

```
CREATE TABLE `content` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR  NOT NULL,
  `short_description` TEXT  NOT NULL,
  `tags` TEXT ,
  `data` TEXT ,
  `content_type` INT  NOT NULL,
  `created_at` DATETIME  NOT NULL,
  `updated_at` DATETIME  NOT NULL,
  PRIMARY KEY (`id`)
) 
```

*（继续假设我们将为 content_type 创建参考表）*

虽然博客可能需要像“pingbacks”这样的数据，而页面可能只需要正文，但您只需存储类似于以下博客示例的输出：

```
$data = serialize(array(
    "body" => "Lorem ipsum",
    "pingbacks" => array()
)); 
```

更新很容易，只要您从数据库中获取数据，您就可以将数据反序列化以编辑为基于内容类型选择的表单。显示的工作方式相同，只需根据内容类型获取模板并将未序列化的数据数组发送给它。模板永远不需要担心数据是如何存储的，它只需要一个 $data['pingbacks']。

至于您的表单，我的建议是打破您的反 OOP 公约并找到一个表单生成库。如果您可以从框架中提取它，请使用[Zend_Form](http://framework.zend.com/manual/en/zend.form.html)与[Zend_Config](http://framework.zend.com/manual/en/zend.config.html)和[Zend_Validate](http://framework.zend.com/manual/en/zend.validate.html)来自[Zend Framework](http://framework.zend.com/)（在这种情况下，所有 Zend_Config 相当于一个方便的接口来加载和遍历 XML 和 INI 文件）让生活变得非常美好。您可以让您的 XML 文件为每种内容类型定义表单，您所要做的只是在页面上呈现表单（根据内容类型获取 XML），获取过滤后的数据，删除“通用字段”之类的名称，创建/更新日期，然后将剩余的内容序列化到数据库中。不需要了解特定内容类型的架构（除非您希望严格）。

尽管从个人角度来说，我强烈建议您考虑使用 Zend_Form（使用 Zend_Validate 和 Zend_Config）以及使用[Doctrine](http://www.doctrine-project.org/)作为 ORM/数据库抽象层。您可能会发现，在数据库上运行操作时，至少 Doctrine 会让您的生活变得更加轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T21:29:23.743

> 尽管从个人角度来说，我强烈建议您考虑使用 Zend_Form（使用 Zend_Validate 和 Zend_Config）以及使用 Doctrine 作为 ORM/数据库抽象层。您可能会发现，在数据库上运行操作时，至少 Doctrine 会让您的生活变得更加轻松。

我同意德库西诺的观点。既然已经完成了，为什么还要自己动手呢？我还想看看[Zend DB](http://framework.zend.com/manual/en/zend.db.html)，如果您需要 PHP4 和 5 解决方案[PHP ADOdb](http://adodb.sourceforge.net/)。

我最近开始了一个学术项目，和你有同样的愿望；最终我选择了 PHP ADoDB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-27T15:40:26.570

我建议 www.ajaxcrud.com - 它易于使用、轻量级，并且可以让您在几秒钟内启动并运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-16T21:17:51.180

你可以试试这个：http: [//xcrud.com](http://xcrud.com)，真的很有帮助

# php - 文件下载的 HTTP 标头

> ID：386845
> 
> 赞同：56
> 
> 时间：2008-12-22T17:40:35.950
> 
> 标签：php, http-headers, download, content-type

我编写了一个 PHP 脚本来处理文件下载，确定正在请求哪个文件并设置正确的 HTTP 标头以触发浏览器实际下载文件（而不是在浏览器中显示它）。

我现在遇到一个问题，一些用户报告某些文件被错误地识别（因此无论扩展名如何，浏览器都会认为它是 GIF 图像）。我猜这是因为我没有在响应头中设置“内容类型”。这很可能是这种情况吗？如果是这样，是否有一个相当通用的类型可以用于所有文件，而不是试图考虑所有可能的文件类型？

目前我只设置值“内容处置：附件；文件名=arandomf.ile”

**更新：**我在这里按照本指南为文件下载建立了一个更强大的过程（[http://w-shadow.com/blog/2007/08/12/how-to-force-file-download-with-php/](http://w-shadow.com/blog/2007/08/12/how-to-force-file-download-with-php/)） ，但是在执行脚本和浏览器的下载对话框出现之间存在明显的延迟。任何人都可以确定导致此问题的瓶颈吗？

这是我的实现：

```
/**
 * Outputs the specified file to the browser.
 *
 * @param string $filePath the path to the file to output
 * @param string $fileName the name of the file
 * @param string $mimeType the type of file
 */
function outputFile($filePath, $fileName, $mimeType = '') {
    // Setup
    $mimeTypes = array(
        'pdf' => 'application/pdf',
        'txt' => 'text/plain',
        'html' => 'text/html',
        'exe' => 'application/octet-stream',
        'zip' => 'application/zip',
        'doc' => 'application/msword',
        'xls' => 'application/vnd.ms-excel',
        'ppt' => 'application/vnd.ms-powerpoint',
        'gif' => 'image/gif',
        'png' => 'image/png',
        'jpeg' => 'image/jpg',
        'jpg' => 'image/jpg',
        'php' => 'text/plain'
    );

    $fileSize = filesize($filePath);
    $fileName = rawurldecode($fileName);
    $fileExt = '';

    // Determine MIME Type
    if($mimeType == '') {
        $fileExt = strtolower(substr(strrchr($filePath, '.'), 1));

        if(array_key_exists($fileExt, $mimeTypes)) {
            $mimeType = $mimeTypes[$fileExt];
        }
        else {
            $mimeType = 'application/force-download';
        }
    }

    // Disable Output Buffering
    @ob_end_clean();

    // IE Required
    if(ini_get('zlib.output_compression')) {
        ini_set('zlib.output_compression', 'Off');
    }

    // Send Headers
    header('Content-Type: ' . $mimeType);
    header('Content-Disposition: attachment; filename="' . $fileName . '"');
    header('Content-Transfer-Encoding: binary');
    header('Accept-Ranges: bytes');

    // Send Headers: Prevent Caching of File
    header('Cache-Control: private');
    header('Pragma: private');
    header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');

    // Multipart-Download and Download Resuming Support
    if(isset($_SERVER['HTTP_RANGE'])) {
        list($a, $range) = explode('=', $_SERVER['HTTP_RANGE'], 2);
        list($range) = explode(',', $range, 2);
        list($range, $rangeEnd) = explode('-', $range);

        $range = intval($range);

        if(!$rangeEnd) {
            $rangeEnd = $fileSize - 1;
        }
        else {
            $rangeEnd = intval($rangeEnd);
        }

        $newLength = $rangeEnd - $range + 1;

        // Send Headers
        header('HTTP/1.1 206 Partial Content');
        header('Content-Length: ' . $newLength);
        header('Content-Range: bytes ' . $range - $rangeEnd / $fileSize);
    }
    else {
        $newLength = $fileSize;
        header('Content-Length: ' . $fileSize);
    }

    // Output File
    $chunkSize = 1 * (1024*1024);
    $bytesSend = 0;

    if($file = fopen($filePath, 'r')) {
        if(isset($_SERVER['HTTP_RANGE'])) {
            fseek($file, $range);

            while(!feof($file) && !connection_aborted() && $bytesSend < $newLength) {
                $buffer = fread($file, $chunkSize);
                echo $buffer;
                flush();
                $bytesSend += strlen($buffer);
            }

            fclose($file);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-12-22T18:00:58.377

正如亚历克斯的链接所解释的那样，您可能`Content-Disposition`缺少`Content-Type`.

所以是这样的：

```
Content-Disposition: attachment; filename="MyFileName.ext" 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-12-22T17:45:49.327

根据[RFC 2046（多用途 Internet 邮件扩展）](http://www.rfc-editor.org/rfc/rfc2046.txt)：

> 对于接收“应用程序/八位字节流”实体的实现，推荐的操作
> 是简单地将数据放入文件中

所以我会去那个。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-22T17:47:44.703

你可以试试这个[强制下载脚本](http://elouai.com/force-download.php)。即使您不使用它，它也可能会为您指明正确的方向：

```
<?php

$filename = $_GET['file'];

// required for IE, otherwise Content-disposition is ignored
if(ini_get('zlib.output_compression'))
  ini_set('zlib.output_compression', 'Off');

// addition by Jorg Weske
$file_extension = strtolower(substr(strrchr($filename,"."),1));

if( $filename == "" ) 
{
  echo "<html><title>eLouai's Download Script</title><body>ERROR: download file NOT SPECIFIED. USE force-download.php?file=filepath</body></html>";
  exit;
} elseif ( ! file_exists( $filename ) ) 
{
  echo "<html><title>eLouai's Download Script</title><body>ERROR: File not found. USE force-download.php?file=filepath</body></html>";
  exit;
};
switch( $file_extension )
{
  case "pdf": $ctype="application/pdf"; break;
  case "exe": $ctype="application/octet-stream"; break;
  case "zip": $ctype="application/zip"; break;
  case "doc": $ctype="application/msword"; break;
  case "xls": $ctype="application/vnd.ms-excel"; break;
  case "ppt": $ctype="application/vnd.ms-powerpoint"; break;
  case "gif": $ctype="image/gif"; break;
  case "png": $ctype="image/png"; break;
  case "jpeg":
  case "jpg": $ctype="image/jpg"; break;
  default: $ctype="application/octet-stream";
}
header("Pragma: public"); // required
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false); // required for certain browsers 
header("Content-Type: $ctype");
// change, added quotes to allow spaces in filenames, by Rajkumar Singh
header("Content-Disposition: attachment; filename=\"".basename($filename)."\";" );
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($filename));
readfile("$filename");
exit(); 
```

# emacs - 有这么多括号，如何有效地键入 lisp？

> ID：386854
> 
> 赞同：20
> 
> 时间：2008-12-22T17:44:10.780
> 
> 标签：emacs, lisp, scheme, touch-typing

我尽量将手指放在本垒上。

键入所有括号让我远离那里。

我使用 Emacs；括号本身没有问题，我对它们很满意。而且我不喜欢自动为我键入它们的模式。

我考虑过将方括号重新映射到括号，反之亦然。这是一个好主意吗？其他人都做什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-21T06:02:09.730

我个人会推荐[Emacs](http://gnu.org/software/emacs/)、[SLIME](http://common-lisp.net/project/slime/)和[paredit.el](http://mumble.net/~campbell/emacs/paredit.el)的致命组合 Paredit 允许您在 sexp 级别伪语义编辑 LISP 代码，这使得括号几乎完全消失。你可以像简单的单词一样移动sexp，甚至只需敲几下键就可以改变它们。还有一种称为[Redshank](http://www.foldr.org/~michaelw/emacs/redshank/)的次要模式，它与 Paredit 结合使用并提供更多功能。

考虑这些简单的例子（| 是光标的位置）：

```
(foo bar (baz| quux) zot) + C-( => (foo (bar baz| quux) zot)
(foo (bar |baz) quux zot) + C-) => (foo (bar |baz quux) zot)

(foo (bar baz |quux) zot) + C-{ => (foo bar (baz |quux) zot)
(foo (bar |baz quux) zot) + C-} => (foo (bar |baz) quux zot) 
```

我曾经做过一些严肃的 Common Lisp 编程，paredit 对我来说是无价之宝。如果没有我的工具箱，我什至无法想到编写重要的 LISP 代码。毕竟这就是它应该的样子；你永远不必计算或匹配你的括号......一旦你掌握了 Paredit，括号就会从你的眼前消失。

将 [] 重新映射到 () 会有所帮助，但在您开始使用 Paredit 后您将不再关心。

随意使用[我的 dot-emacs 中的 LISP 特定部分](https://github.com/ghoseb/dot-emacs/blob/efeaafa7f41a8add3e78cf24aca365f516ff2664/dotemacs-cerebro)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-22T18:38:05.353

无论如何，对于许多非美国键盘布局，键入方括号或大括号甚至比键入括号更麻烦，这使得大多数语言的编程非常紧张，所以认为自己很幸运。;)

至于我，我使用程序员友好的非标准键盘布局，让我可以通过 [Super]-j 和 [Super]-k 键入括号。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-22T17:51:31.560

我的手指从home键上移开......

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-23T01:50:18.897

我有脚踏板。LeftFoot = 打开括号，RightFoot = 关闭括号。

好吧，我没有，但我不使用 Lisp。不过，这似乎不是一个坏主意。

你能想象一个使用缩进而不是括号的 Lisp 变体吗？（从 Python 规范中获取一页）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-22T18:42:10.897

我尝试在 Emacs 中重新映射，但它产生了新问题：假设您正在通过 ssh 在终端窗口中进行编辑，然后将片段粘贴到窗口中；然后在您的粘贴中交换括号和括号，而不仅仅是您的打字。如果您尝试这样做，请在系统中的较低级别重新映射，例如 xmodmap。

（当然，另一个明显的问题是在没有重新映射的情况下使用其他计算机。这也很麻烦，虽然可以忍受。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-29T18:53:33.973

“……这么多括号”

我做的第一件事是将'('键绑定到序列'('+')'+right()，所以我的括号自动平衡，在编写新代码时留下一半的剩余输入。

您还需要一种方便的方法来导航出一个括号 - 将 C-] 绑定到序列 search(')')+right()。现在创作变得更短了，因为您不需要将手从初始位置上移开——只需在每次完成 S-expr 时键入 C-]。

接下来我做的是将一个键绑定到一个将现有项目推送到当前列表的子例程......所以如果 // 是光标位置，那么这个命令将转换：

```
(if (< //) (+ x 1) 
    (x) 
  (y)) 
```

到

```
(if (< (+ x 1) //)
    (x) 
  (y)) 
```

有效地将一项从右侧推入当前列表——对于编辑现有代码非常有用。序列 '(', '<', CS-], Space, '2' 将“比较小于 2”添加到现有表达式。结合 C-]，这使您可以非常快速地从现有表达式构建新表达式。

@jamesnvc，我没有考虑将 () 绑定到 [] 键...我必须尝试一下，谢谢！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-29T07:40:57.217

我用 xmodmap 将 [] 重新映射到 () 并喜欢它。习惯用使用 [] 的语言编写代码有点奇怪，但就像任何更改一样，你会习惯它。在 Lisp 中使用未移位的括号比在其他语言中没有未移位的括号要好，所以它很有效。

无论如何，这是我的美式键盘所需的 xmodmap 咒语：

```
!! swap () and []
keycode  18 = 9 bracketleft
keycode  19 = 0 bracketright
keycode  34 = parenleft braceleft
keycode  35 = parenright braceright 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-23T17:04:37.427

我必须把手指从主排移开才能接触到所有其他班次号码操作员，所以我从来没有考虑太多。

一旦你键入左括号，电动括号就会给你正确的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-22T18:11:14.190

如果您使用括号而不是方括号，请务必重新映射。我不认为它会带来比左撇子交换鼠标按钮更多的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-22T18:51:35.620

当我编写代码时，我通常会花更多的时间思考和阅读我的代码，而不是输入代码。我过去曾尝试过几次切换到 Dvorak 键盘布局，但我缺乏明显的动力，因为我的打字速度比我想象的要快得多。编程语言语法是一个类似的问题——只要我可以在不离开键盘的情况下输入代码（即使用鼠标会很糟糕），我就很高兴。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-19T19:38:11.660

[DrScheme](http://www.drscheme.org)默认翻转括号和方括号的击键。它还有一个功能，它可以神奇地猜测您指的是两者中的哪一个，因此您很少使用 shift-9。

[Quack](http://www.neilvandyke.org/quack/)具有与 DrScheme 类似的功能。

[DivaScheme](http://www.cs.brown.edu/research/plt/software/divascheme)（我的编辑）是完全不同的东西。它在 sexp 级别进行编辑，因此括号不再妨碍。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-23T20:01:10.957

大多数情况下，我只是键入它们，但偶尔，我使用 M-( 和 M-) （尤其是当我在“阶段后期”添加 LET 绑定时）来包含相关的 nnumber 个表达式。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-28T08:00:12.560

我还更改了我的（dvorak）键盘布局（通过 xmodmap）来切换括号（“[]”）和括号，以及`paredit-mode`（这确实需要一些时间来适应）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-15T17:34:34.247

我使用 paredit 和 pair-mode 包，但是，为了快速输入括号，我使用电点和破折号在 5 毫秒延迟时替换 () 中的双句点（如果我输入缓慢，我会得到两个点）。这是一个很棒的包（我根据个人喜好做了一些修改；当我使用 Dvorak 键盘键入时，我用斜杠替换了破折号键（// 在 lisp 中并不常见））。

为了避免括号中的混乱，我在我的工具集中添加了一个名为 'highlight-parentheses 的包，并且为了在一般情况下获取性别抓取或文本导航的最大效率，我还使用 vimpulse（因为我是一个 Vim 上瘾者）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-21T05:13:49.750

将大写锁定重新绑定到“（”并让编辑器为您自动插入“）”。

（这也有助于其他有很多括号的语言，例如 HTML ......）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-11-22T15:50:21.740

我将 Vim 与[vim-sexp](https://github.com/guns/vim-sexp)和[vim-sexp-mappings-for-regular-people](https://github.com/tpope/vim-sexp-mappings-for-regular-people)一起使用，然后将我映射`<leader>u`到新的`(`.

`map <leader>u i(`

# algorithm - 查找具有特定属性的整数 - 欧拉计划问题 221

> ID：386862
> 
> 赞同：9
> 
> 时间：2008-12-22T17:45:39.810
> 
> 标签：algorithm, math, python-3.x, diophantine

我最近对 ​​Project Euler 非常上瘾，接下来我正在尝试做[这个](http://projecteuler.net/index.php?section=problems&id=221)！我已经开始对其进行一些分析，并且已经大大减少了问题。这是我的工作：

> A = pqr 和
> 
> 1/A = 1/p + 1/q + 1/r 所以 pqr/A = pq + pr + qr
> 
> 由于第一个方程：
> 
> pq+pr+qr = 1
> 
> 由于 p、q 和 r 中的两个必须是负数，我们可以将方程简化为：
> 
> abc 其中 ab = ac+bc+1
> 
> 求解 c 我们得到：
> 
> ab-1 = (a+b)c
> 
> c = (ab-1)/(a+b)
> 
> * * *
> 
> 这意味着我们需要找到 a 和 b ：
> 
> ab = 1 (mod a+b)
> 
> 然后我们的 A 值与那些 a 和 b 是：
> 
> A = abc = ab(ab-1)/(a+b)

对不起，如果这是很多数学！但现在我们要处理的只是一个条件和两个方程。现在，因为我需要找到写为 ab(ab-1)/(a+b) 且 ab = 1 (mod a+b) 的第 150,000 个最小整数，所以理想情况下我想搜索 A 的 (a, b)尽可能小。

为方便起见，我假设 a < b 并且我还注意到 gcd(a, b) = 1。

我的第一个实现是直截了当的，甚至可以足够快地找到 150,000 个解决方案。*但是，找到 150,000 个最小*的解决方案需要很长时间。无论如何，这是代码：

```
n = 150000
seen = set()

a = 3
while len(seen) < n:
    for b in range(2, a):
        if (a*b)%(a+b) != 1: continue

        seen.add(a*b*(a*b-1)//(a+b))
        print(len(seen), (a, b), a*b*(a*b-1)//(a+b))

    a += 1 
```

我的下一个想法是使用 Stern-Brocot 树，但这太慢了，无法找到解决方案。我的最终算法是使用中国剩余定理来检查 a+b 的不同值是否产生解决方案。该代码很复杂，虽然速度更快，但还不够快......

所以我完全没有想法！有人有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-22T18:24:09.967

这篇关于中文余数的文章，快速实现，可以帮到你：www.codeproject.com/KB/recipes/CRP.aspx

这是工具和库的更多链接：

工具：

Maxima [http://maxima.sourceforge.net/](http://maxima.sourceforge.net/) Maxima 是一个用于处理符号和数值表达式的系统，包括微分、积分、泰勒级数、拉普拉斯变换、常微分方程、线性方程组、多项式和集合、列表、向量、矩阵和张量。Maxima 通过使用精确分数、任意精度整数和可变精度浮点数产生高精度数值结果。Maxima 可以绘制二维和三维的函数和数据。

Mathomatic [http://mathomatic.org/math/](http://mathomatic.org/math/) Mathomatic 是一款免费、便携、通用的 CAS（计算机代数系统）和计算器软件，可以符号求解、简化、组合和比较方程，执行复数和多项式算术，等等。它做一些微积分并且非常容易使用。

Scilab www.scilab.org/download/index_download.php Scilab 是一个类似于 Matlab 或 Simulink 的数值计算系统。Scilab 包含数百个数学函数，并且可以交互添加来自各种语言（如 C 或 Fortran）的程序。

mathstudio mathstudio.sourceforge.net 交互式方程编辑器和逐步求解器。

图书馆：

Armadillo C++ 库 [http://arma.sourceforge.net/](http://arma.sourceforge.net/) Armadillo C++ 库旨在为线性代数运算（矩阵和向量数学）提供有效的基础，同时具有简单易用的界面。

Blitz++ [http://www.oonumerics.org/blitz/](http://www.oonumerics.org/blitz/) Blitz++ 是一个用于科学计算的 C++ 类库

BigInteger C# [http://msdn.microsoft.com/pt-br/magazine/cc163441.aspx](http://msdn.microsoft.com/pt-br/magazine/cc163441.aspx)

libapmath [http://freshmeat.net/projects/libapmath](http://freshmeat.net/projects/libapmath) 欢迎来到 APMath-project 的主页。这个项目的目的是实现一个任意精度的C++库，使用起来最方便，这意味着所有的操作都实现为运算符重载，命名与.

libmat [http://freshmeat.net/projects/libmat](http://freshmeat.net/projects/libmat) MAT 是一个 C++ 数学模板类库。将该库用于各种矩阵运算、求多项式的根、求解方程等。该库仅包含 C++ 头文件，因此无需编译。

animath [http://www.yonsen.bz/animath/animath.html](http://www.yonsen.bz/animath/animath.html) Animath 是一个完全用 C++ 实现的有限元方法库。它适用于流固耦合模拟，在数学上基于高阶四面体单元。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T12:46:20.967

与欧拉计划的许多问题一样，诀窍是找到一种技术，将蛮力解决方案简化为更直接的解决方案：

```
A = pqr and 
1/A = 1/p + 1/q + 1/r 
```

所以，

```
pq + qr + rp = 1  or  -r = (pq - 1)/(p + q) 
```

不失一般性，0 < p < -q < -r

存在 k , 1 <= k <= p

```
-q = p + k
-r = (-p(p + k) – 1) / (p + -p – k)  = (p^2 + 1)/k + p 
```

但是 r 是一个整数，所以 k 除以 p^2 + 1

```
pqr = p(p + q)((p^2 + 1)/k + p) 
```

因此，要计算 A，我们需要遍历 p，其中 k 只能取 p 的平方加 1 的除数。

将每个解决方案添加到一个集合中，我们可以在找到所需的第 150000 个亚历山大整数时停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:46:07.963

好的。这是我的中国剩余定理解决方案的更多内容。事实证明，a+b 不能是任何素数 p 的乘积，除非[p = 1 (mod 4)](https://stackoverflow.com/questions/383728/can-i-reduce-the-computational-complexity-of-this#383786)。这允许更快的计算，因为我们只需要检查 a+b 是素数的倍数，例如 2、5、13、17、29、37...

所以这里是一个可能的 a+b 值的样本：

```
[5, 8, 10, 13, 16, 17, 20, 25, 26, 29, 32, 34, 37, 40, 41, 50, 52, 53, 58, 61, 64, 65, 68, 73, 74, 80, 82, 85, 89, 97, 100] 
```

这是使用中国剩余定理的完整程序：

```
cachef = {}
def factors(n):
    if n in cachef: cachef[n]

    i = 2
    while i*i <= n:
        if n%i == 0:
            r = set([i])|factors(n//i)
            cachef[n] = r
            return r

        i += 1

    r = set([n])
    cachef[n] = r
    return r

cachet = {}
def table(n):
    if n == 2: return 1
    if n%4 != 1: return

    if n in cachet: return cachet[n]

    a1 = n-1
    for a in range(1, n//2+1):
        if (a*a)%n == a1:
            cachet[n] = a
            return a

cacheg = {}
def extended(a, b):
    if a%b == 0:
        return (0, 1)
    else:
        if (a, b) in cacheg: return cacheg[(a, b)]

        x, y = extended(b, a%b)
        x, y = y, x-y*(a//b)

        cacheg[(a, b)] = (x, y)
        return (x, y)

def go(n):
    f = [a for a in factors(n)]
    m = [table(a) for a in f]

    N = 1
    for a in f: N *= a

    x = 0
    for i in range(len(f)):
        if not m[i]: return 0

        s, t = extended(f[i], N//f[i])
        x += t*m[i]*N//f[i]

    x %= N
    a = x
    while a < n:
        b = n-a
        if (a*b-1)%(a+b) == 0: return a*b*(a*b-1)//(a+b)
        a += N

li = [5, 8, 10, 13, 16, 17, 20, 25, 26, 29, 32, 34, 37, 40, 41, 50, 52, 53, 58, 61, 64, 65, 68, 73, 74, 80, 82, 85, 89, 97, 100]

r = set([6])
find = 6

for a in li:
    g = go(a)
    if g:
        r.add(g)
        #print(g)
    else:
        pass#print(a)

r = list(r)
r.sort()

print(r)
print(len(r), 'with', len(li), 'iterations') 
```

这更好，但我希望进一步改进它（例如 a+b = 2^n 似乎永远不是解决方案）。

我也开始考虑基本的替代品，例如：

> a = u+1 和 b = v+1
> 
> ab = 1 (mod a+b)
> 
> uv+u+v = 0 (mod u+v+2)

但是，我看不到有太大的改善...

# c# - 正则表达式替换以协助 LINQ 中的 Orderby

> ID：386867
> 
> 赞同：3
> 
> 时间：2008-12-22T17:47:34.017
> 
> 标签：c#, regex, linq, linq-to-sql

我正在使用 LINQ to SQL 从数据库中提取记录，按字符串字段对它们进行排序，然后对它们执行一些其他工作。不幸的是，我排序的名称字段来自数据库，如下所示

```
Name
ADAPT1
ADAPT10
ADAPT11
...
ADAPT2
ADAPT3 
```

我想按数字顺序对名称字段进行排序。现在我正在使用 Regex 对象将“ADAPT1”替换为“ADAPT01”等。然后我使用另一个 LINQ 查询再次对记录进行排序。我的代码看起来像

```
 var adaptationsUnsorted = from aun in dbContext.Adaptations
                              where aun.EventID == iep.EventID
                              select new Adaptation
                              {
                                  StudentID = aun.StudentID,
                                  EventID = aun.EventID,
                                  Name = Regex.Replace(aun.Name,
                                     @"ADAPT([0-9])$", @"ADAPT0$1"),
                                  Value = aun.Value
                              };

    var adaptationsSorted = from ast in adaptationsUnsorted
                            orderby ast.Name
                            select ast;

    foreach(Adaptation adaptation in adaptationsSorted)
    {
        // do real work
    } 
```

我遇到的问题是 foreach 循环抛出异常

```
System.NotSupportedException was unhandled
  Message="Method 'System.String Replace(System.String, System.String,
    System.String)' has no supported translation to SQL."
  Source="System.Data.Linq" 
```

我还想知道是否有一种更简洁的方法可以只用一个 LINQ 查询来做到这一点。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T18:10:42.210

通过枚举查询（调用 ToList）强制元素水合。从那时起，您的操作将针对内存中的对象，并且这些操作不会被转换为 SQL。

```
List<Adaptation> result =
  dbContext.Adaptation
  .Where(aun => aun.EventID = iep.EventID)
  .ToList();

result.ForEach(aun =>
  aun.Name = Regex.Replace(aun.Name,
    @"ADAPT([0-9])$", @"ADAPT0$1")
);
result = result.OrderBy(aun => aun.Name).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T18:05:01.363

`IComparer<string>`用你的逻辑实现 a ：

```
var adaptationsUnsorted = from aun in dbContext.Adaptations
                          where aun.EventID == iep.EventID
                          select new Adaptation
                          {
                              StudentID = aun.StudentID,
                              EventID = aun.EventID,
                              Name = aun.Name,
                              Value = aun.Value
                          };

var adaptationsSorted = adaptationsUnsorted.ToList<Adaptation>().OrderBy(a => a.Name, new AdaptationComparer ());

foreach (Adaptation adaptation in adaptationsSorted)
{
    // do real work
}

public class AdaptationComparer : IComparer<string>
{
    public int Compare(string x, string y)
    {
        string x1 = Regex.Replace(x, @"ADAPT([0-9])$", @"ADAPT0$1");
        string y1 = Regex.Replace(y, @"ADAPT([0-9])$", @"ADAPT0$1");
        return Comparer<string>.Default.Compare(x1, y1);
    }
} 
```

我没有测试这段代码，但它应该可以完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T19:57:42.540

我想知道您是否可以将计算+持久+索引字段添加到数据库中，为您执行此操作。编写一个以整数形式获取值的 UDF（仅使用字符串值）将是相当简单的，但是您可以在数据库中对该列进行排序。这将允许您有效地使用`Skip`，`Take`而不是不断地将所有数据获取到 .NET 代码（根本无法扩展）。

# avatar - 以编程方式设置 Windows Live Messenger 显示图片

> ID：386872
> 
> 赞同：1
> 
> 时间：2008-12-22T17:48:48.180
> 
> 标签：avatar, windows-live-messenger

如何以编程方式设置 Windows Live Messenger（当前使用 8.5.1302.1018）显示图片。可能的解决方案可以是 C++、.NET 或 VB。即使只是一个提示也可能有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:24:11.217

您应该查看一个名为[MSNP-Sharp](http://code.google.com/p/msnp-sharp/)的开源项目。

您可以使用它连接到 MSN 并设置您的个人资料图片。这是设置图像的示例：

```
 try
        {
            Image fileImage = Image.FromFile(ConfigurationSettings.AppSettings["ImageFileName"]);
            DisplayImage displayImage = new DisplayImage();
            displayImage.Image = fileImage;
            m_Messenger.Owner.DisplayImage = displayImage;
            m_Messenger.Nameserver.StorageService.UpdateProfile(fileImage, "MyPhoto");
        }
        catch
        {
            LogError(new StackTrace(true), "Error adding avatar image.");
        } 
```

# mysql - 如何限制mysqldump使用的带宽

> ID：386874
> 
> 赞同：7
> 
> 时间：2008-12-22T17:49:34.700
> 
> 标签：mysql, linux, networking, large-data-volumes

我必须通过没有那么多带宽并且其他人需要同时使用的网络管道转储一个大型数据库。如果我尝试它，它会吸收所有的带宽，延迟会飙升，其他人都会搞砸。

我知道 mysqldump 的 --compress 标志有点帮助。

如何在不占用此连接的所有带宽的情况下做到这一点？

更新：

使用带有 -l 标志的 scp 复制转储文件的建议是一个很好的建议，但我应该注意我没有对数据库服务器的[SSH](http://en.wikipedia.org/wiki/Secure_Shell)访问权限。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T11:17:57.200

[`trickle`](http://monkey.org/~marius/pages/?page=trickle)?

> 涓流是一种便携式轻量级用户空间带宽整形器

您没有提到您实际上是如何传输数据库转储的，但是如果传输是通过 TCP/IP 进行的，那么涓流应该可以工作。例如，如果您使用`nc`（例如`nc -L 1234 > backup.sql`：）以下命令将以不超过 20KB/s 的速度传输备份：

```
mysqldump [database name] | trickle -u 20 nc backup.example.com:1234 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T11:52:24.860

您将必须有权访问 linux 机器（对不起，我是一个 linuxy 类型的人）。

入口策略可以减少传入流量，但另一端的服务器需要有一个性能良好的 TCP/IP 堆栈。

tc qdisc add dev eth0 handle ffff: ingress
tc filter add dev eth0 parent ffff: protocol ip prio 50 \
  u32 match ip src server.ip.address/32 police rate 256kbit \
  burst 10k drop flowid :1
tc qdisc add dev eth0 root tbf \
  速率 256kbit 延迟 25ms 突发 10k

您可以在高级路由指南中找到有关入口过滤器的更多信息。

[http://www.linux.org/docs/ldp/howto/Adv-Routing-HOWTO/index.html](http://www.linux.org/docs/ldp/howto/Adv-Routing-HOWTO/index.html)

* * *

如果你在 linux 中做，你可以将文件转储到本地，压缩它并使用 scp 复制文件，并使用 -l 开关来限制使用的带宽：

-l limit 限制使用的带宽，以 Kbit/s 为单位。

例如

scp -l 16 转储文件远程主机：文件路径和名称

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T17:56:06.090

我使用的一个技巧是指定 CSV 格式而不是插入。它不会改变您每单位时间使用多少带宽，但它可以减少您提取的字节总数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T17:53:03.273

如果您通过 TCP 发送，带宽将在各方之间平均共享。如果您想进一步降低速度，您需要将设备调整为只允许一定数量的数据输出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T19:27:47.903

在客户端上，您可以运行将限制下载速度的代理。您还可以控制连接数等。

如果您在 Windows 上，这应该可以很好地工作：

[http://www.youngzsoft.net/ccproxy/index.html](http://www.youngzsoft.net/ccproxy/index.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T11:59:03.437

你在使用像 InnoDB 这样的事务表引擎吗？这是您的主数据库吗？要非常小心！mysqldump 将持有表锁并中断数据库的生产使用。减慢备份速度只会导致这段中断时间变长。总是 mysqldump 到本地磁盘，然后从那里复制转储。

另一种方法可能是在您的远程站点设置一个复制从站，并从中获取备份。然后数据库更新将通过您的竞争链接涓涓细流，而不是一大块下来。

另一种选择：当没有其他人使用网络时进行备份:)

# java - Eclipse 的速度编辑器插件？

> ID：386877
> 
> 赞同：38
> 
> 时间：2008-12-22T17:50:08.960
> 
> 标签：java, eclipse, velocity

我见过[Veloedit](http://veloedit.sourceforge.net/)，它似乎有很好的语法突出显示，但不允许在正在编辑的文件中使用制表符（wtf？）并且也不了解 HTML。

通过一点谷歌搜索，我找到[了 Veloecipse](http://propsorter.sourceforge.net/)，它声称基于 Veloedit 构建并添加了 HTML 支持 -~~但似乎与 Eclipse 3.4 不兼容~~。

是否有任何其他人正在使用的 Eclipse 的 Velocity 模板编辑器插件？

理想的解决方案应具有以下特点：

*   VTL的语法高亮
*   HTML 语法高亮
*   VTL 语法的自动完成
*   允许标签！

**更新**：见下面我的回答

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-25T12:58:34.213

这是一个更新：我一直在使用 Veloeclipse，它运行良好，不确定是什么导致了我最初关于不使用 Eclipse 3.4 的评论，但我现在肯定在 3.4 中使用它。在我看来，Veloeclipse 比 Veloedit 和 Velocity Web Editor 更好用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-07-29T11:29:27.773

我已经安装了 Veloeclipse，因为 Veloedit 在打开编辑器时引发了异常，并且它在 eclipse 3.5.2 上运行良好。

为了安装它，我必须在“安装新软件...”对话框中*取消选择“按类别分组项目”。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T08:53:15.763

你试一试

速度网络编辑

[http://velocitywebedit.sourceforge.net/](http://velocitywebedit.sourceforge.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-22T09:28:40.480

您可以从以下位置下载 Velocity 模板的 Veloeclipse`http://code.google.com/p/veloeclipse/`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T10:29:42.543

~~根据 [http://sourceforge.net/project/showfiles.php?group_id=126011](http://sourceforge.net/project/showfiles.php?group_id=126011) ，最后一个版本是 2006 年，所以我认为它不再得到积极维护。~~

~~太糟糕了，veloedit 不起作用。~~

好的，我又试了一次，现在成功了。一定与我的安装有关。所以对我来说 veloedit 是要走的路:)

下一次编辑：第二天，当我开始使用 veloedit 编辑器时，我再次遇到了 Eclipse 异常。现在我只是使用常规的 html/jsp 编辑器来至少有某种哦 html 语法突出显示......

# javascript - 是否有 JavaScript MVC（微）框架？

> ID：386885
> 
> 赞同：133
> 
> 时间：2008-12-22T17:52:29.813
> 
> 标签：javascript, model-view-controller, forms

是否有任何客户端 JavaScript [MVC](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)（微）框架？

我有一个相当复杂的 HTML 表单，它将受益于 MVC 模式。

我想一个好的解决方案将提供以下内容：

*   模型和视图在值更改时更新控制器（观察者模式）
*   页面加载时从表单数据填充模型
*   模型更改时从模型中填充表单

Ajax、comet、[JSONP](http://en.wikipedia.org/wiki/JSONP)和所有爵士乐都是严重的矫枉过正。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-12-30T01:05:21.637

Backbone 是一个很棒的轻量级框架。试一试： [http ://backbonejs.org/](http://backbonejs.org/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-08-22T08:56:50.990

[JavaScriptMVC](http://www.javascriptmvc.com/)是一个很好的解决方案。It's Everything is a plugin 方法使您能够仅选择您需要的功能。从 2.0 开始，它基于 jQuery。

在逐步增强您的网站时，这取决于用户，因为 JMVC 仅提供了一个中间层进行开发 - 由您自己做出设计选择。

然而，JavaScriptMVC 是最好的通用 JavaScriptMVC 库，因为它具有强大的基于事件委托的控制器。

事件委托让您不必附加事件处理程序，而只需为您的页面创建规则。

最后，JMVC 不仅仅是一个 MVC 架构。它涵盖了开发周期的所有部分：

*   代码生成器
*   Selenium 和 Env.js 集成测试
*   文档引擎
*   自动连接+压缩
*   错误检测和报告

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-05-09T08:23:11.110

[Spine](https://github.com/spine)有一个类似于 Backbone 的 API，但它要小得多。它具有原型继承。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-08-22T06:59:25.373

AngularJS 与 jQuery 一起工作得很好，并且会在 MVC 结构和严格的关注点分离方面为您提供很多帮助。

包括完整的测试环境和依赖注入...

[在http://angularjs.org](http://angularjs.org)查看

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-12-22T17:54:26.047

确实有：[http ://www.javascriptmvc.com/](http://javascriptmvc.com/)

我想你会发现这已经足够了！

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-12-24T10:24:16.873

我认为这个看起来像你应该检查的东西：http: [//knockoutjs.com/](http://knockoutjs.com/)

（作为一个 silverlight / wpf 程序员，这是让我终于开始学习 javascript 的库。它基于 Model-View-View-Model (MVVM) 模式，对我来说现在似乎是一个不错的选择！）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-01-27T11:23:30.287

[Ember.js](http://emberjs.com/)

这些是使 Ember 易于使用的三个功能：

1.  绑定
2.  计算属性
3.  自动更新模板

### 绑定

使用绑定使两个不同对象之间的属性保持同步。您只需声明一次绑定，Ember 将确保更改在任一方向传播。

以下是在两个对象之间创建绑定的方法：

```
MyApp.president = Ember.Object.create({
  name: "Barack Obama"
});

MyApp.country = Ember.Object.create({
  // Ending a property with 'Binding' tells Ember to
  // create a binding to the presidentName property.
  presidentNameBinding: 'MyApp.president.name'
});

MyApp.country.get('presidentName');
// "Barack Obama" 
```

绑定允许您使用 MVC（模型-视图-控制器）模式来构建您的应用程序，然后放心地知道数据将始终正确地在层与层之间流动。

### 计算属性

计算属性允许您将函数视为属性。计算属性很有用，因为它们可以与绑定一起使用，就像任何其他属性一样。

### 自动更新模板

Ember 使用 Handlebars，一个语义模板库。要从您的 JavaScript 应用程序中获取数据并将其放入 DOM，请创建一个标签并将其放入您的 HTML 中，无论您希望值出现在何处：

```
<script type="text/x-handlebars">
  The President of the United States is {{MyApp.president.fullName}}.
</script> 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2010-12-09T23:29:23.290

有流行的[Backbone.js](http://documentcloud.github.com/backbone/)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-03-16T03:18:52.813

[Stapes.js](http://hay.github.com/stapes/)

完全披露：我是这个库的作者 :)

如果您正在寻找非常小的东西（1.5kb 缩小/压缩），请看一下，如果您喜欢它，请告诉我。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-02-04T01:37:05.703

如果您的要求*非常简单，您可以像*[Alex Netkachov](http://www.alexatnet.com/node/8)那样编写自己的简单 MVC 。

他的示例是基于 dojo 构建的（注意：由于缺少 dojo.js 文件，它们在他的页面上对我不起作用），但是您可以在纯 Javascript 中遵循该模式。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-04T01:02:32.917

对于您需要的东西，这可能有点过头了，但是**[SproutCore](http://www.sproutcore.com/)**是一个 MVC 框架，它看起来并不比**[JavaScriptMVC](http://www.javascriptmvc.com/)**或 TrimPath 的**[Junction](http://code.google.com/p/trimpath/wiki/TrimJunction)**更重量级。

不幸的是，这些似乎都不是建立在[渐进增强](http://developer.yahoo.com/yui/articles/gbs/#progressive-enhancement)的原则之上的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-04T01:33:27.147

流行的 ActionScript MVC 框架[PureMVC](http://trac.puremvc.org/PureMVC_JS/)最近被移植到 JavaScript。我还没有机会尝试它，但我相信它很好。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-03-17T15:04:23.960

2016 年更新：Sammy.js 似乎被放弃了。

## 看看[Sammy.js](http://sammyjs.org)

来自网站的文字：

*一个带类的小型网络框架。*

*   **SMALL** Sammy 的内核只有 16K 压缩和 5.2K 压缩和 gzip
*   **模块化**Sammy 建立在插件和适配器系统之上。仅包含您需要的代码。将您自己的代码提取到可重用的插件中也很容易。
*   **CLEAN**整个 API 的设计易于理解和阅读。Sammy 试图鼓励良好的封装和应用程序设计。
*   **有趣**如果不令人愉快，开发的真正意义是什么。Sammy 试图遵循 MATZ 的方法。它针对开发人员的幸福进行了优化。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-09-01T04:19:36.167

另请查看[jquery-claypool](https://github.com/thatcher/jquery-claypool)。

jquery-claypool 是一个基于 jquery 的小型、快速、railable mvc 框架，基于我在 django、rails、spring 等方面的经验。它的重量非常轻，可以在客户端和服务器环境中运行。

它为干净的 mvc、类别日志记录、过滤器 (aop)、控制器的延迟创建、控制反转、约定优于配置提供了一个路由框架，而设计上仅此而已。

它没有做任何 jquery 已经做的事情，感觉就像 jquery，并且像一个好的框架应该：简单。

[jquery-claypool](http://www.claypooljs.com "jquery-claypool")

希望你检查一下。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-08-17T13:28:20.870

Jamal 是我见过的最轻的。它也基于 jQuery（奖金）。没用过。

[http://jamal-mvc.com/](http://jamal-mvc.com/)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-08-26T14:15:02.533

试试[小猫](https://github.com/msn0/jsKitty-MVC)。它只有 1.4KB，它唯一的依赖是 EJS。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-09-24T13:50:04.930

如果您想控制一切并且非常简单，您可能不需要框架，只需实现自己的 mvc 模式即可。只需查看这篇文章： Alex Netkachov 于 2006 年撰写[的 Model-View-Controller (MVC) with JavaScript](http://www.alexatnet.com/content/model-view-controller-mvc-javascript)。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-12-02T19:40:59.357

这是人类已知的所有开源 JavaScript 框架的列表。

[http://getopensource.info/explore/javascript/framework/](http://getopensource.info/explore/javascript/framework/)

或者只有 MVC 框架

[http://getopensource.info/explore/javascript/mvc/](http://getopensource.info/explore/javascript/mvc/)

披露：我是这个网站的开发者。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-09-25T19:05:43.410

CorMVC，易于理解和上手，基于 jquery，不依赖于任何服务器技术

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-12-22T18:34:07.170

我不会称其为*微*框架，但它确实看起来很有趣：[Cappuccino Web Framework](http://cappuccino.org/)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-09-14T16:51:17.660

我赞成 AngularJS（完全公开，我以有限的方式参与了 Angular 开发工作）并且对此感到非常兴奋。我做了一个并排比较，将一个功能用于一个内部项目（抱歉没有签署共享它）并在 AngularJS 和 Backbone 中实现它。这是一个很棒的练习，最后，我非常倾向于 Angular。核心开发人员非常擅长回答问题，他们在内置数据绑定、单元/e2e 测试和文档方面做得非常好。它仍处于测试阶段，在不久的将来会发布 1.0。Beta非常稳定。

有一点范式转变，他们使用的方法与大多数人完全不同。集成您最喜欢的 jquery 插件需要一些努力，但可行并且已经完成（github 上的 angular-contrib）。

我会说（这对于大多数以 js 为中心的框架来说都是一个问题），确保研究如何使您的内容对 SEO 友好（如果它对您很重要）。自从 6 月份加入 Angular 社区以来，我注意到人们的兴趣在增长，许多人在发帖说他们看过 Backbone 和其他人，但真的很喜欢他们在 Angular 中看到的东西。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-11-16T10:55:51.810

我开发了一个非常简单的 Javascript MVC 框架，称为[MCV](http://projects.andreaferretti.it/mcv)。它并不能完全满足您的要求，但可以通过助手轻松扩展。无论如何，它绝对是微型的（1,9kb 压缩）。

它或多或少有点像 Jamal，但我决定推出自己的产品有两个原因：

*   删除 jQuery 依赖项（尽管我大部分时间都将它与 jQuery 一起使用）
*   使用助手使其可扩展。这些类似于 CakePHP 的行为、组件和助手。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-03-27T00:43:30.157

只是为了让列表更完整一点： [ActiveJS](http://activejs.org/)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-07-08T17:13:25.220

另一个：[MooTools-MVC](https://github.com/fate/Mootools-MVC)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-22T22:04:47.790

有一个名为“Coherent”的键值绑定 JavaScript 框架，其灵感来自 Apple 的 Cocoa Bindings。[该框架已被 Apple 购买，但在http://github.com/trek/coherentjs/tree/master](http://github.com/trek/coherentjs/tree/master)上仍有旧副本。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2011-02-11T11:50:54.470

试试这个[基于 jQuery 的 javascript MVC 框架](http://code.google.com/p/jquery-neat-mvc/jQuery-neat-mvc)。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-05-18T21:16:38.253

**[Can.js](http://canjs.us/)**拥有您所需的一切，并且大小仅为 8 KB。它从 JavaScriptMVC 中汲取了最好的部分，并将其提炼成一个带有观察器、小部件、绑定和工作的小而有趣的框架。它与主要框架（ [jQuery](http://en.wikipedia.org/wiki/JQuery)、 [Dojo Toolkit](http://en.wikipedia.org/wiki/Dojo_Toolkit)、 [MooTools](http://en.wikipedia.org/wiki/MooTools)等）兼容。文档非常好，作者反应灵敏。绝对值得一看。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-03-20T11:07:54.690

还有一个，轻巧小巧：http: [//jqnano.oleksiy.pro/](http://jqnano.oleksiy.pro/)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-01-18T15:32:39.220

Maverick 是一个小型 JavaScript MVC 框架 — [http://maverick.round.ee](http://maverick.round.ee)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-02-08T15:31:15.743

我也将在这里进行 [介绍——AFrameJS](http://www.aframejs.com)可与 jQuery、MooTools 和 Prototype 一起使用。

# java - 是否有必要从 Platform MBean Server 注销 MBean？

> ID：386892
> 
> 赞同：7
> 
> 时间：2008-12-22T17:54:40.057
> 
> 标签：java, jmx, mbeans

我已经开始使用 MBeans 来公开有关应用程序的一些信息。几乎所有的 HOWTO / 教程 / 博客文章 / 在线示例都教您如何实现 MBean 并将其注册到 MBean 服务器，但从未提及（或只是粗略地）从服务器取消注册 MBean。

我担心一个 MBean 需要引用一个相当重量级的对象才能提供有关该对象的状态信息。

平台 MBean 服务器是否维护对 MBean 的弱引用或其他类似的技巧，以确保如果您的应用程序不再持有对它的任何引用，它最终会被 GC 处理？注销通常是不必要的，从而解释了为什么没有人在 JMX 教程中谈论它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T21:36:31.527

您不能“弱”地向服务器注册 MBean（还），从而期望在没有其他对它的引用时对它进行 GC。

话虽这么说，您绝对应该阅读 Eamonn McManus 关于该主题的一些帖子。

[https://web.archive.org/web/20120207140653/http://weblogs.java.net/blog/emcmanus/archive/2005/07/cleaning_up_an_1.html](https://web.archive.org/web/20120207140653/http://weblogs.java.net/blog/emcmanus/archive/2005/07/cleaning_up_an_1.html)

> 有人建议 JMX API 可以像这样对“弱 MBean”有一些明确的支持。我不确定它们是否有足够的用途来证明将它们包含在 API 中是合理的，而且我也不确定弱 MBean 的通用 API 会是什么样子。但是上面显示了如果需要，您可以如何创建自己的弱 MBean。

[https://web.archive.org/web/20090114131740/http://weblogs.java.net/blog/emcmanus/archive/2005/07/javaone_feedbac.html](https://web.archive.org/web/20090114131740/http://weblogs.java.net/blog/emcmanus/archive/2005/07/javaone_feedbac.html)

> “弱” MBean。MBean 经常管理另一个 Java 对象，该对象是要监视或控制的“资源”。但是，如果对该资源的唯一引用来自 MBean 怎么办？如果资源不再被其他人引用，我们能否以某种方式安排 MBean 消失？
> 
> 打开和关闭昂贵的 MBean。一些 MBean 可能会导出连续采样且收集起来成本很高的信息。您不一定希望这些 MBean 一直在运行。临时解决方案很简单，例如 java.lang.management.ThreadMXBean 中的 setThreadContentionMonitoringEnabled 方法。但也许会有更通用的约定，例如 setDetailLevel(int) 方法。

# apache - 使用 mod_rewrite 进行相对路径重定向

> ID：386905
> 
> 赞同：4
> 
> 时间：2008-12-22T18:02:21.087
> 
> 标签：apache, mod-rewrite

> **可能重复：**
> [Mod_Rewrite 与相对路径重定向](https://stackoverflow.com/questions/9102358/mod-rewrite-with-relative-path-redirects)

我的网站在 .htaccess 中有一系列 RewriteRules，我正在重组。

```
# Requests for http://example.com/contents/section/4/48/
# get redirected to http://example.com/courses
RewriteRule ^content/section/4/48/$ /courses [R=301,L] 
```

这工作正常，除了现在我有一个新的和未发布的站点位于一个`/new/`子目录中，所以在测试时，我需要重定向到的规则`/new/courses`而不是`/courses`......基本上我只是希望它重定向到一个 URL相对于 .htaccess 文件的位置。

```
/home/user/www/new/.htaccess --> redirect to /new/courses
/home/user/www/.htaccess --> redirect to /courses 
```

当我将 /new/.htaccess 文件移动到根目录时，我必须更改它的每一行，这似乎是不对的。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2008-12-22T18:08:59.577

未经测试 - 但您应该能够从目标中删除“/”，即

```
RewriteRule ^content/section/4/48/$ courses [R=301,L] 
```

# php - 如何使用 php 和 mySQL 实现简单的站点搜索？

> ID：386914
> 
> 赞同：15
> 
> 时间：2008-12-22T18:05:53.280
> 
> 标签：php, sql, mysql, search

我正在创建一个允许用户提交报价的网站。我将如何创建一个（相对简单？）返回最相关引号的搜索？

例如，如果搜索词是“turkey”，那么我会返回引号，其中“turkey”一词出现两次，然后出现在引号中，而引号仅出现一次。

（我会添加一些其他规则来帮助过滤掉不相关的结果，但我主要担心的是。）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-22T18:40:50.870

每个人都建议使用 MySQL 全文搜索，但是您应该注意一个巨大的警告。全文搜索引擎仅适用于 MyISAM 引擎（不是 InnoDB，由于其引用完整性和 ACID 合规性，它是最常用的引擎）。

所以你有几个选择：

**1\.** [Particle Tree](http://particletree.com/notebook/ranked-searches-with-sql/)概述了最简单的方法。您实际上可以从纯 SQL 中获得排名搜索（没有全文，没有任何内容）。下面的 SQL 查询将搜索表并根据搜索字段中字符串的出现次数对结果进行排名：

```
SELECT
    SUM(((LENGTH(p.body) - LENGTH(REPLACE(p.body, 'term', '')))/4) +
        ((LENGTH(p.body) - LENGTH(REPLACE(p.body, 'search', '')))/6))
    AS Occurrences
FROM
    posts AS p
GROUP BY
    p.id
ORDER BY
    Occurrences DESC 
```

*编辑了他们的示例以提供更清晰的信息*

上述 SQL 查询的变体、添加 WHERE 语句（WHERE p.body LIKE '%whatever%you%want'）等可能会得到你所需要的。

**2.**您可以更改您的数据库模式以支持全文。通常，为了保持 InnoDB 引用完整性、ACID 合规性和速度，而无需安装像[Sphinx Fulltext Search Engine](http://www.sphinxsearch.com/) for MySQL 之类的插件，所做的就是将报价数据拆分到它自己的表中。基本上你会有一个表 Quotes 是一个 InnoDB 表，而不是你的 TEXT 字段“数据”你有一个引用“quote_data_id”，它指向一个 MyISAM 表的 Quote_Data 表上的 ID。您可以在 MyISAM 表上执行全文，将返回的 ID 与您的 InnoDB 表连接起来，瞧，您就有了结果。

**3.**安装[狮身人面像](http://www.sphinxsearch.com/)。祝你好运。

鉴于您所描述的，我**强烈**建议您采用我提出的第一种方法，因为您有一个简单的数据库驱动站点。第一个解决方案很简单，可以快速完成工作。Lucene 设置起来很麻烦，特别是如果您想将它与数据库集成，因为 Lucene 主要用于索引文件而不是数据库。谷歌自定义站点搜索只会让您的站点失去大量声誉（让您看起来很业余和被黑客入侵），而 MySQL 全文很可能会导致您更改数据库架构。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-22T18:09:28.623

使用[谷歌自定义站点搜索](http://www.google.com/coop/cse/)。我听说他们对搜索了解一两件事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T18:18:13.100

Stackoverflow[计划使用](https://blog.stackoverflow.com/2008/11/sql-2008-full-text-search-problems/)Lucene[搜索](http://lucene.apache.org/java/docs/)引擎。有一个为 Zend 框架编写的 PHP 端口，但可以作为单独的实体下载，而不需要所有 ZF 膨胀。这称为 Zend_Search_Lucene，[可在此处找到其文档](http://framework.zend.com/manual/en/zend.search.lucene.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T18:37:36.710

你的 sql 看起来像这样（你试图在其中找到带有 'turkey' 的引号）：

```
SELECT * FROM Quotes
WHERE the_quote LIKE "%turkeyt%"; 
```

从那里你可以弄清楚如何处理它向你吐出的任何东西。

小心处理恶意用户可能[将恶意 SQL](http://www.google.com/search?q=sql+injection&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)注入您的数据库的情况，特别是如果您打算将其放在 www. 如果您这样做是为了好玩，我想这只是您想学习的内容。

如果您不熟悉数据库和 sql，我建议您使用[sqlite](http://sqlite.org/)而不是 mysql。*更*容易设置和使用，因为没有设置。它将帮助您解决第一次必须安装和设置 mysql 的潜在麻烦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T18:08:32.150

我会选择全文搜索，在这里查看：http: [//hockinson.com/fulltext-search-of-mysql-database-table.html](http://hockinson.com/fulltext-search-of-mysql-database-table.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-22T18:19:28.807

如果您想自己编写，请查看 phpBB 的实现。他们有两个表，第一个是出现在条目中的所有单词的唯一列表，第二个是单词和条目之间的多对多引用。然后，您可以进行分组并计数，以按照您要查找的方式对条目进行排序。

这比实现第三方搜索引擎（或全文搜索）要多得多，但它可以让您更好地控制结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T20:47:24.543

作为 Sphinx 和 Lucene 的替代方案，可以使用[Xapian](http://xapian.org/)库创建一个相对简单的搜索引擎。

`+`支持许多高级搜索功能（例如相关性排名）
`+`快速

`-`您需要学习 API 来创建您的界面
`-`需要安装 php 扩展

另请注意，Xapian 将其数据存储在 mysql 的单独索引中。

您可能还对[Forage](http://code.google.com/p/forage/)感兴趣，它是 Solr、Xapian 和 Lucene 的包装器。

Xapian 人还创建了 Omega 搜索引擎，它是 Xapian 的前端，可以通过 cgi 调用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-14T22:10:58.003

这是 Solr / Lucene 的一种更简单、更易于操作的开源替代方案：

[http://github.com/typesense/typesense](http://github.com/typesense/typesense)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-22T18:20:10.100

如果您查询的次数不多（我认为您每天免费获得 1k 次查询）或者您愿意付费，Google 自定义站点搜索就很棒。

MySQL 的全文搜索也是一个很好的资源（如前所述）。

雅虎的 BOSS 是一个有趣的项目——我将在我的下一个搜索项目中试一试。

最后，如果您需要比全文更强大的功能，但又想调整自己的搜索引擎，Lucene 是一个很好的资源。 [http://lucene.apache.org](http://lucene.apache.org)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-07T15:34:28.950

几天前我遇到了[Zoom 搜索引擎，认为这可能是我用过的最简单的搜索引擎。](http://www.wrensoft.com/zoom/)

基于 Windows 的工具会创建站点数据库，然后它还会询问您要使用哪种语言（PHP、ASP.NET、JavaScript 等）。我选择了 PHP，它为我构建了 PHP 代码。我所要做的就是将文件上传到服务器并（可选）自定义模板和站点搜索工作。

这对小型站点是免费的，我能找到的唯一缺点是蜘蛛工具（数据库构建器）必须在 Windows 上运行。

# compression - 具有以下特点的最佳压缩算法

> ID：386930
> 
> 赞同：1
> 
> 时间：2008-12-22T18:14:46.553
> 
> 标签：compression

具有以下特点的最佳压缩算法是什么：

*   应该花费更少的时间来解压（可以花费更多的时间来压缩）
*   应该能够压缩排序的数据（大约 3,000,000 个字符串/整数的列表......）

请连同指标一起提出建议：压缩率、压缩和解压缩的算法复杂度（如果可能）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-22T18:22:16.240

整个网站致力于压缩基准测试[在这里](http://www.maximumcompression.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T18:20:41.173

好吧，如果您只想要速度，那么标准 ZIP 压缩就可以了，而且它很可能已经集成到您的语言/框架中（例如：.NET 有它，Java 有它）。有时最通用的解决方案是最好的，ZIP 是一种非常成熟的格式，任何 ZIP 库和应用程序都可以与任何其他格式一起使用。

但是如果你想要更好的压缩，我会推荐[7-Zip](http://www.7-zip.org/sdk.html)，因为作者很聪明，很容易掌握并鼓励人们使用这种格式。

为您提供压缩时间是不可能的，因为它与您的硬件直接相关。如果你想要一个基准，你必须自己做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T18:45:52.527

您不必担心减压时间。较高压缩级别所花费的时间主要是寻找最长的匹配模式。

解压

```
1) Writes the literal 
2) for (backward position, length)=(m,n) pair, 
   goes back, in the output buffer, m bytes, 
   reads n bytes and 
   writes n bytes at the end of the buffer. 
```

所以解压时间与压缩级别无关。而且，根据我在通用解压虚拟机 (RFC3320) 方面的经验，我想任何解压算法都是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T12:52:01.817

这是一个有趣的问题。在字符串和整数的此类排序数据上，我希望[差异编码压缩方法](http://dl.acm.org/citation.cfm?id=1247525)在压缩率方面优于任何开箱即用的文本压缩方法，如[LZ77 或 LZ78](http://en.wikipedia.org/wiki/LZ77_and_LZ78)。通用编码器不使用数据的特殊属性。

# python - 如何在 Python 中将环境变量评估为字符串？

> ID：386934
> 
> 赞同：69
> 
> 时间：2008-12-22T18:18:05.487
> 
> 标签：python, filesystems, environment-variables

我有一个代表路径的字符串。因为这个应用程序在 Windows、OSX 和 Linux 上使用，我们已经定义了环境变量来正确映射来自不同文件系统的卷。结果是：

```
"$C/test/testing" 
```

我想要做的是评估字符串中的环境变量，以便将它们替换为各自的卷名。是否有我遗漏的特定命令，或者我必须采取`os.environ.keys()`并手动替换字符串？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-12-22T18:35:16.433

使用[os.path.expandvars](http://docs.python.org/library/os.path.html#os.path.expandvars)扩展字符串中的环境变量，例如：

```
>>> os.path.expandvars('$C/test/testing')
'/stackoverflow/test/testing' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-07-06T20:30:14.927

在 Python 3 中，您可以执行以下操作：

```
'{VAR}'.format(**os.environ)) 
```

例如

```
>>> 'hello from {PWD}'.format(**os.environ))
hello from /Users/william 
```

# javascript - 点击时间延迟

> ID：386944
> 
> 赞同：7
> 
> 时间：2008-12-22T18:21:41.093
> 
> 标签：javascript, time, button, delay

任何人都可以向我发送有关如何构建从单击页面上的按钮到执行按钮单击调用的函数的时间延迟的 JavaScript 代码。我是 JavaScript 的新手，当我点击一个按钮时，我有一些代码会执行一个功能，我只想有一个时间延迟。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-22T18:25:12.507

这是Javascript：

```
 function myfunction() {
     alert( "delayed" );
 }

 var delay = 1000;

 setTimeout( myfunction, delay ) 
```

这就是本质。现在您需要将其挂接到 html 页面上的按钮中：将函数定义嵌入`< script >`...`< /script >`标签中，并将其安排在 onClick 方法中。

```
....
<button onClick="setTimeout( myfunction, delay );">Click_And_Wait</button> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T18:32:30.090

如果需要传递参数：

```
function clickHandler(id,value,delay)
{
    setTimeout( function() { actualFunction(id, value); }, delay );
}

function actualFunction(id, value)
{
    alert( 'button ' + id + ' has value = ' + value );
}

<input id='clickButton' type='button'
       onclick='clickHandler(this.id,this.value,5000);'
       value='Click Me' /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T18:25:41.727

试试 setTimeout 函数：

```
setTimeout(functionToExecute, 1000) 
```

第一个参数是要触发的函数，第二个参数是以毫秒为单位的延迟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T18:56:36.280

我建议您研究一下 Prototype.js，尤其是如果您是 JavaScript 的新开发人员。Prototype 已经弄清楚了 JavaScript 开发人员希望在他们的代码中实现的许多最常见的需求。并且 Prototype 以独立于浏览器的方式来实现。（还有其他 JavaScript 库也可以做到这一点）

您可以按照其他答案中的代码进行操作。但是我发现，在我购买了一本好书并花了 2 天时间阅读有关 Prototype（或其他一些库，如 jQuery ) 与搜索 Internet 并复制/粘贴各种解决方案相比。/耸耸肩

# linux - 将某些进程限制为 CPU % - Linux

> ID：386945
> 
> 赞同：32
> 
> 时间：2008-12-22T18:21:49.207
> 
> 标签：linux, limit, cpu

我有以下问题：一些动态生成的进程倾向于占用 100% 的 CPU。我想将所有匹配某些标准（例如进程名称）的进程限制为一定数量的 CPU 百分比。

我要解决的具体问题是利用 fold@home 工作进程。我能想到的最佳解决方案是定期执行并使用 cpulimit 实用程序来限制进程的 perl 脚本（如果您对更多详细信息感兴趣，请查看此[博客文章](http://dev.calyx.hr/blog/?p=143)）。它有效，但它是一个黑客：/

有任何想法吗？我想把进程的处理留给操作系统:)

* * *

再次感谢您的建议，但我们仍然没有抓住重点:)

“slowDown”解决方案本质上是“cpulimit”实用程序所做的。我仍然需要注意要减慢哪些进程，一旦工作进程完成就终止“slowDown”进程，并为新的工作进程启动新进程。这正是我使用 Perl 脚本和 cron 作业所做的。

主要问题是我事先不知道要限制哪些进程。它们是动态生成的。

也许有一种方法可以将一个用户的所有进程限制在一定的 CPU 百分比？我已经设置了一个用户来执行 fold@home 作业，希望我可以使用 /etc/security/limits.conf 文件来限制他。但我能得到的最接近的是每个用户的总 CPU 时间......

如果有一些东西可以让你说：“这个用户进程的所有 CPU % 使用率的总和不能超过 50%”，那就太酷了。然后让进程根据它们的优先级争夺那 50% 的 CPU...

* * *

伙计们，感谢您的建议，但这与优先级无关-即使有足够的可用 CPU 时间，我也想限制 CPU 百分比。这些进程已经是低优先级，因此它们不会导致任何性能问题。

我只是想防止 CPU 长时间以 100% 运行...

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-12-14T19:04:52.013

我有一个稍微类似的问题`gzip`。

假设我们想减少一个`gzip`进程的 CPU：

```
 gzip backup.tar & sleep 2 & cpulimit --limit 10 -e gzip -z 
```

选项：

*   我发现`sleep`很有用，因为`cpulimit`有时不会`gzip`立即采用新流程
*   `--limit 10``gzip`将CPU 使用率限制为 10%
*   `-z`进程完成`cpulimit`时自动关闭`gzip`

另一种选择是运行`cpulimit`守护程序。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-22T21:19:43.030

我不记得也不认为在 unix 调度程序中有这样的东西。您需要一个控制其他进程并执行以下操作的小程序：

```
loop
    wait for some time tR
    send SIGSTOP to the process you want to be scheduled
    wait for some time tP
    send SIGCONT to the process.
loopEnd 
```

比率 tR/tP 控制 CPU 负载。

* * *

这是一个概念的小证明。"busy" 是占用你的 cpu 时间并且你希望通过 "slowDown" 减慢的程序：

```
> cat > busy.c:
    main() { while (1) {}; }

> cc -o busy busy.c
> busy &
> top

Tasks: 192 total,   3 running, 189 sleeping,   0 stopped,   0 zombie
Cpu(s): 76.9% us,  6.6% sy,  0.0% ni, 11.9% id,  4.5% wa,  0.0% hi,  0.0% si
Mem:   6139696k total,  6114488k used,    25208k free,   115760k buffers
Swap:  9765368k total,  1606096k used,  8159272k free,  2620712k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
26539 cg        25   0  2416  292  220 R 90.0  0.0   3:25.79 busy
...

> cat > slowDown
while true; do
 kill -s SIGSTOP $1
 sleep 0.1
 kill -s SIGCONT $1
 sleep 0.1
done

> chmod +x slowDown
> slowDown 26539 &
> top
Tasks: 200 total,   4 running, 192 sleeping,   4 stopped,   0 zombie
Cpu(s): 48.5% us, 19.4% sy,  0.0% ni, 20.2% id,  9.8% wa,  0.2% hi,  2.0% si
Mem:   6139696k total,  6115376k used,    24320k free,    96676k buffers
Swap:  9765368k total,  1606096k used,  8159272k free,  2639796k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
26539 cg        16   0  2416  292  220 T 49.7  0.0   6:00.98 busy
... 
```

* * *

好的，该脚本需要更多的工作（例如，要注意被 INTR-upted 并让受控进程继续，以防它在那一刻停止），但你明白了。我还会用 C 或类似语言编写那个小脚本，并从命令行参数计算 cpu 比率....

问候

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-17T02:16:09.043

我认为在 Linux 中没有限制 cpu 使用率的解决方案，但是有一种可接受的方法可以将任何进程限制为特定的 CPU 使用率：[http ://ubuntuforums.org/showthread.php?t=992706](http://ubuntuforums.org/showthread.php?t=992706)

如果他们删除信息，这里又是

* * *

1.  安装包

2.  安装 cpulimit 包。代码：

    sudo apt-get install cpulimit

3.  安装 gawk 包。代码：

    sudo apt-get install gawk

4.  创建 CPULIMIT 守护进程文件

以 root 权限打开文本编辑器并将下面的守护程序脚本文本保存到新文件 /usr/bin/cpulimit_daemon.sh

代码：

```
#!/bin/bash
# ==============================================================
# CPU limit daemon - set PID's max. percentage CPU consumptions
# ==============================================================

# Variables
CPU_LIMIT=20        # Maximum percentage CPU consumption by each PID
DAEMON_INTERVAL=3   # Daemon check interval in seconds
BLACK_PROCESSES_LIST=   # Limit only processes defined in this variable. If variable is empty (default) all violating processes are limited.
WHITE_PROCESSES_LIST=   # Limit all processes except processes defined in this variable. If variable is empty (default) all violating processes are limited.

# Check if one of the variables BLACK_PROCESSES_LIST or WHITE_PROCESSES_LIST is defined.
if [[ -n "$BLACK_PROCESSES_LIST" &&  -n "$WHITE_PROCESSES_LIST" ]] ; then    # If both variables are defined then error is produced.
   echo "At least one or both of the variables BLACK_PROCESSES_LIST or WHITE_PROCESSES_LIST must be empty."
   exit 1
elif [[ -n "$BLACK_PROCESSES_LIST" ]] ; then                                 # If this variable is non-empty then set NEW_PIDS_COMMAND variable to bellow command
   NEW_PIDS_COMMAND="top -b -n1 -c | grep -E '$BLACK_PROCESSES_LIST' | gawk '\$9>CPU_LIMIT {print \$1}' CPU_LIMIT=$CPU_LIMIT"
elif [[ -n "$WHITE_PROCESSES_LIST" ]] ; then                                 # If this variable is non-empty then set NEW_PIDS_COMMAND variable to bellow command
   NEW_PIDS_COMMAND="top -b -n1 -c | gawk 'NR>6' | grep -E -v '$WHITE_PROCESSES_LIST' | gawk '\$9>CPU_LIMIT {print \$1}' CPU_LIMIT=$CPU_LIMIT"
else
   NEW_PIDS_COMMAND="top -b -n1 -c | gawk 'NR>6 && \$9>CPU_LIMIT {print \$1}' CPU_LIMIT=$CPU_LIMIT"
fi

# Search and limit violating PIDs
while sleep $DAEMON_INTERVAL
do
   NEW_PIDS=$(eval "$NEW_PIDS_COMMAND")                                                                    # Violating PIDs
   LIMITED_PIDS=$(ps -eo args | gawk '$1=="cpulimit" {print $3}')                                          # Already limited PIDs
   QUEUE_PIDS=$(comm -23 <(echo "$NEW_PIDS" | sort -u) <(echo "$LIMITED_PIDS" | sort -u) | grep -v '^$')   # PIDs in queue

   for i in $QUEUE_PIDS
   do
       cpulimit -p $i -l $CPU_LIMIT -z &   # Limit new violating processes
   done
done 
```

3.  根据您的环境需求更改变量

CPU_LIMIT 如果您想将每个进程的 CPU 消耗忽略为除 20% 之外的任何其他百分比，请在上述脚本中更改此变量。如果您有 SMP 计算机（多于 1 个 CPU 或多于 1 个内核的 CPU），请阅读下面的“如果使用 SMP 计算机”一章。

DAEMON_INTERVAL 如果您想要更多/更少的定期检查，请在上面的脚本中更改此变量。间隔以秒为单位，默认设置为 3 秒。

BLACK_PROCESS_LIST 和 WHITE_PROCESSES_LIST 变量 BLACK_PROCESSES_LIST 仅限制指定的进程。如果变量为空（默认），则所有违规进程都会受到限制。

变量 WHITE_PROCESSES_LIST 限制除此变量中定义的进程之外的所有进程。如果变量为空（默认），则所有违规进程都会受到限制。

变量 BLACK_PROCESSES_LIST 和 WHITE_PROCESSES_LIST 之一或两者必须为空 - 定义两个变量是不合逻辑的。

您可以使用分隔符“|”在这两个变量之一中指定多个进程 （不带双引号）。示例：如果您想对除 mysql、firefox 和 gedit 进程之外的所有进程进行 cpulimit 设置变量：WHITE_PROCESSES_LIST="mysql|firefox|gedit"

4.  在引导时自动启动守护进程的过程

5.  为root用户设置文件权限：代码：

    sudo chmod 755 /usr/bin/cpulimit_daemon.sh

6.  以 root 权限打开文本编辑器并将下面的脚本保存到新文件 /etc/init.d/cpulimit

代码：

```
#!/bin/sh
#
# Script to start CPU limit daemon
#
set -e

case "$1" in
start)
if [ $(ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print $1}' | wc -l) -eq 0 ]; then
    nohup /usr/bin/cpulimit_daemon.sh >/dev/null 2>&1 &
    ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print}' | wc -l | gawk '{ if ($1 == 1) print " * cpulimit daemon started successfully"; else print " * cpulimit daemon can not be started" }'
else
    echo " * cpulimit daemon can't be started, because it is already running"
fi
;;
stop)
CPULIMIT_DAEMON=$(ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print $1}' | wc -l)
CPULIMIT_INSTANCE=$(ps -eo pid,args | gawk '$2=="cpulimit" {print $1}' | wc -l)
CPULIMIT_ALL=$((CPULIMIT_DAEMON + CPULIMIT_INSTANCE))
if [ $CPULIMIT_ALL -gt 0 ]; then
    if [ $CPULIMIT_DAEMON -gt 0 ]; then
        ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print $1}' | xargs kill -9   # kill cpulimit daemon
    fi

    if [ $CPULIMIT_INSTANCE -gt 0 ]; then
        ps -eo pid,args | gawk '$2=="cpulimit" {print $1}' | xargs kill -9                    # release cpulimited process to normal priority
    fi
    ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print}' | wc -l | gawk '{ if ($1 == 1) print " * cpulimit daemon can not be stopped"; else print " * cpulimit daemon stopped successfully" }'
else
    echo " * cpulimit daemon can't be stopped, because it is not running"
fi
;;
restart)
$0 stop
sleep 3
$0 start
;;
status)
ps -eo pid,args | gawk '$3=="/usr/bin/cpulimit_daemon.sh"  {print}' | wc -l | gawk '{ if ($1 == 1) print " * cpulimit daemon is running"; else print " * cpulimit daemon is not running" }'
;;
esac
exit 0 
```

3.  将文件的所有者更改为 root：

代码：

```
sudo chown root:root /etc/init.d/cpulimit 
```

4.  更改权限：

代码：

```
sudo chmod 755 /etc/init.d/cpulimit 
```

5.  将脚本添加到启动程序目录： 代码：

    sudo update-rc.d cpulimit 默认值

6.  重新启动以检查脚本是否在启动时启动 cpulimit 守护进程： 代码：

    须藤重启

7.  手动检查、停止、启动和重新启动守护进程

注意：本教程中的守护进程和服务具有相同的含义。

注意：对于使用 Ubuntu 8.10 之前的用户（如 Ubuntu 8.04 LTS）而不是服务命令，请使用“sudo /etc/init.d/cpulimit status/start/stop/restart”语法或使用命令安装 sysvconfig 包：sudo apt-get安装 sysvconfig

检查 cpulimit 服务是否正在运行 检查命令返回：如果服务正在运行，则返回“cpulimit daemon is running”，如果服务未运行，则返回“cpulimit daemon is not running”。代码：

```
sudo service cpulimit status 
```

启动 cpulimit 服务 您可以手动启动 cpulimit 守护程序，它将开始忽略 CPU 消耗。代码：

```
sudo service cpulimit start 
```

停止 cpulimit 服务 Stop 命令停止 cpulimit 守护进程（因此不会限制新进程），并且还设置所有现有的受限进程以完全访问 CPU，就像在 cpulimit 未运行之前一样。代码：

```
sudo service cpulimit stop 
```

重新启动 cpulimit 服务 如果您更改 /usr/bin/cpulimit_daemon.sh 中的某些变量设置，例如 CPU_LIMIT、DAEMON_INTERVAL、BLACK_PROCESSES_LIST 或 WHITE_PROCESSES_LIST，那么在更改设置后您必须重新启动服务。代码：

```
sudo service cpulimit restart 
```

6.  使用或不使用 CPULIMIT 守护程序检查 CPU 消耗

没有守护进程 1\. 停止 cpulimit 守护进程（sudo service cpulimit stop） 2\. 在后台执行 CPU 密集型任务 3\. 执行命令：top 并检查 %CPU 列 每个进程的 %CPU 结果可能超过 20%。

打开守护进程 1\. 启动 cpulimit 守护进程（sudo service cpulimit start） 2\. 在后台执行相同的 CPU 密集型任务 3\. 执行命令：top 并检查 %CPU 列 %CPU 的结果应该是每个进程的最大 20%。注意：不要忘记一开始 %CPU 可以超过 20%，因为 daemon 必须以 3 秒的间隔捕获违规进程（默认在脚本中设置）

7.  如果使用 SMP 计算机

我已经在英特尔双核 CPU 计算机上测试了此代码 - 其行为类似于 SMP 计算机。不要忘记 top 命令和 cpulimit 默认在 Irix 模式下运行，其中 20% 表示一个 CPU 的 20%。如果有两个 CPU（或双核），则总 %CPU 可以是 200%。在 top 命令中，可以使用命令 I 关闭 Irix 模式（在运行 top 命令时按 +i）并打开 Solaris 模式，其中 CPU 总量除以 CPU 数量，因此 %CPU 不能超过 100 % 在任意数量的 CPU 计算机上。请在顶级手册页中阅读有关顶级命令的更多信息（搜索 I 命令）。另请阅读 cpulimit 官方页面中有关 cpulimit 如何在 SMP 计算机上运行的更多信息。

但是 cpulimit 守护进程是如何在 SMP 计算机上运行的呢？始终处于 Irix 模式。因此，如果您想在 2-CPU 计算机上花费 20% 的 CPU 功率，则应将 40% 用于 cpulimit 守护程序脚本中的 CPU_LIMIT 变量。

8.  卸载 CPULIMIT 守护进程和 CPULIMIT 程序

如果您想摆脱 cpulimit 守护进程，您可以通过删除 cpulimit 守护进程并卸载 cpulimit 程序来清理您的系统。

1.  停止 cpulimit 守护进程代码：

    sudo service cpulimit stop # 停止 cpulimit 守护进程和所有 cpulimited 进程

2.  从启动过程中删除守护程序代码：

    sudo update-rc.d -f cpulimit remove # 删除符号链接

3.  删除开机程序代码：

    sudo rm /etc/init.d/cpulimit #删除cpulimit启动脚本

4.  删除 cpulimit 守护进程代码：

    sudo rm /usr/bin/cpulimit_daemon.sh #删除cpulimit daemon脚本

5.  卸载cpulimit程序代码：

    sudo apt-get 删除 cpulimit

6.  卸载 gawk 程序 如果您不需要此程序用于任何其他脚本，您可以远程安装它。代码：

    sudo apt-get 删除 gawk

7.  关于作者的说明

我刚刚为 cpulimit 编写了守护进程（上面的 bash 脚本）。我不是 cpulimit 项目的作者。如果您需要更多关于 cpulimit 程序的信息，请阅读官方 cpulimit 网页：[http](http://cpulimit.sourceforge.net/) ://cpulimit.sourceforge.net/ 。

问候， 施虐者

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-10T04:37:14.427

使用 cgroups 的*cpu.shares*并没有做一个*好的*值不会做的事情。听起来您想要实际限制进程，这绝对可以完成。

您将需要使用一两个脚本，和/或编辑*/etc/cgconfig.conf*以定义所需的参数。

具体来说，您要编辑*cpu.cfs_period_us*和*cpu.cfs_quota_us*值。然后将允许该进程在每*cpu.cfs_period_us微秒内运行**cpu.cfs_quota_us*微秒。

 *例如：

如果*cpu.cfs_period_us = 50000*和*cpu.cfs_quota_us = 10000*则进程将获得最大 CPU 时间的 20%，无论发生什么其他情况。

在这个屏幕截图中，我给了进程 2% 的 CPU 时间：

![2% 的 CPU 时间](https://i.stack.imgur.com/fZ6qk.png)

就过程而言，它以 100% 的速度运行。

另一方面，设置*cpu.shares*可以并且仍然会使用 100% 的空闲 CPU 时间。

在这个类似的例子中，我给出了进程*cpu.shares = 100* (of 1024)：

![cpu.shares](https://i.stack.imgur.com/63ulK.png)

如您所见，该进程仍在消耗所有空闲的 CPU 时间。

参考：

[http://manpages.ubuntu.com/manpages/precise/man5/cgconfig.conf.5.html](http://manpages.ubuntu.com/manpages/precise/man5/cgconfig.conf.5.html) [http://kennystechtalk.blogspot.co.uk/2015/04/throttling-cpu-usage-with-linux-cgroups .html](http://kennystechtalk.blogspot.co.uk/2015/04/throttling-cpu-usage-with-linux-cgroups.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-09-19T04:33:14.877

我有一个类似的问题，线程中提出的其他解决方案根本没有解决它。我的解决方案现在适用于我，但它不是最理想的，特别是对于进程由 root 拥有的情况。
我现在的解决方法是非常努力地确保我没有任何由 root 拥有的长期运行的进程（比如只以用户身份进行备份）

我刚刚为gnome安装了硬件传感器小程序，并在CPU上设置了高低温警报，然后为每个警报设置以下命令：

低的：

```
mv /tmp/hogs.txt /tmp/hogs.txt.$$ && cat /tmp/hogs.txt.$$ | xargs -n1 kill -CONT 
```

高的：

```
touch /tmp/hogs.txt && ps -eo pcpu,pid | sort -n -r | head -1 | gawk '{ print $2 }' >> /tmp/hogs.txt && xargs -n1 kill -STOP < /tmp/hogs.txt 
```

好消息是我的电脑不再过热和崩溃。缺点是终端进程在停止时会与终端断开连接，并且在收到 CONT 信号时不会重新连接。另一件事是，如果它是一个导致过热的交互式程序（比如某个 Web 浏览器插件！），那么它会在我正在做的事情中间冻结，同时等待 CPU 冷却。让 CPU 缩放在全局级别上解决这个问题会更好，但问题是我的 CPU 上只有两个可选设置，并且慢速设置不足以防止过热。

在这里再次重申一下，这与进程优先级、重新调整完全无关，显然与停止运行很长时间的作业无关。这与防止 CPU 利用率长时间保持在 100% 有关，因为硬件在满负荷运行时无法足够快地散热（空闲 CPU 产生的热量比满载 CPU 少）。

其他一些可能有帮助的明显可能性是：

在 BIOS 中整体降低 CPU 速度

更换散热器或重新涂抹导热凝胶，看看是否有帮助

用一些压缩空气清洁散热器

更换CPU风扇

[编辑] 注意：当我在 BIOS（华硕 p5q pro turbo）中禁用可变风扇速度时，100% CPU 不会再过热。在 CPU 满载的情况下，每个内核的最高温度为 49 摄氏度。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-01-11T21:36:32.730

在使用 的系统中`systemd`，您可以使用如下命令运行具有最大 CPU 使用率的单个进程：

```
 sudo systemd-run --scope --uid=1000 -p CPUQuota=20% my_heavy_computation.sh 
```

这将使用多达 20% 的单个 CPU 内核（或 CPU 线程，如果使用超线程）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-26T08:11:15.943

您可以使用 cgroups 限制 CPU 时间。操作系统将像您在问题中要求的那样处理资源管理。

这是一个带有示例的 wiki：[https ://wiki.archlinux.org/index.php/Cgroups](https://wiki.archlinux.org/index.php/Cgroups)

由于进程已经作为单独的用户运行，因此限制该用户的所有进程应该是最简单的解决方案。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-25T15:40:43.487

我还需要限制某些进程的 CPU 时间。cpulimit 是一个很好的工具，但我总是要手动找出 PID 并手动启动 cpulimit，所以我想要更方便的东西。

我想出了这个 bash 脚本：

```
#!/bin/bash

function lp
{

ps aux | grep $1 | termsql "select COL1 from tbl" > /tmp/tmpfile

while read line
do
    TEST=`ps aux | grep "cpulimit -p $line" | wc -l`
    [[ $TEST -eq "2" ]] && continue #cpulimit is already running on this process
    cpulimit -p $line -l $2
done < /tmp/tmpfile

}

while true
do
    lp gnome-terminal 5
    lp system-journal 5
    sleep 10
done 
```

此示例将每个 gnome-terminal 实例的 cpu 时间限制为 5%，并将每个 system-journal 实例的 cpu 时间也限制为 5%。

我在此示例中使用了我创建的另一个名为 termsql 的脚本来提取 PID 。你可以在这里得到它： [https://gitorious.org/termsql/termsql/source/master](https://gitorious.org/termsql/termsql/source/master)：

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-22T18:29:45.353

我看到至少两个选项：

*   在创建进程的 shell 中使用“ulimit -t”
*   在进程创建时使用“nice”或在运行时使用“renice”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-22T20:51:57.750

PS + GREP + 不错

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-22T18:32:02.820

[nice](http://www.computerhope.com/unix/unice.htm)命令可能会有所帮助。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-12-22T20:53:22.240

这可以使用 setrlimit(2) 来完成（特别是通过设置 RLIMIT_CPU 参数）。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-12-22T21:47:08.870

在那里抛出一些睡眠调用应该会强制进程在一段时间内离开 CPU。如果您每分钟睡一次 30 秒，那么您的进程在那一分钟内的平均 CPU 使用率不应超过 50%。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-01-26T23:44:19.887

我真的不明白你为什么要限制 CPU 时间......你应该限制那台机器上的总负载，而负载主要由 IO 操作决定。例如：如果我创建了一个 while(1){} 循环，它将使总负载达到 1.0，但如果这个循环执行某些磁盘写入，负载会跳转到 2.0...4.0。这就是杀死您的机器的原因，而不是 CPU 使用率。可以通过 nice/renice 轻松处理 CPU 使用率。

无论如何，您可以创建一个脚本，在负载过高时为特定 PID 执行“kill -SIGSTOP PID”，并在一切恢复正常时杀死 -SIGCONT ... PID 可以通过使用来确定px aux' 命令，因为我看到它显示了 CPU 使用率，并且您应该能够使用该列对列表进行排序。我认为这整个事情都可以在 bash 中完成......

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-12-22T20:48:18.927

您可以按比例降低 CPU 频率。这样您就不必担心各个流程。当您需要更多 cpu 时，将频率调高。

# ruby-on-rails - IronRuby on Rails 入门

> ID：386950
> 
> 赞同：10
> 
> 时间：2008-12-22T18:24:57.797
> 
> 标签：ruby-on-rails, ironruby

有人可以向我指出一个教程和/或入门文档来让 IronRuby 运行 Rails 吗？我对详细的分步参考特别感兴趣，*而不是*一般指南。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T05:38:35.733

IronRuby 今天已经“运行”了 Rails。我们在 RailsConf 08 上演示了它运行 Rails。也就是说，我们在 IronRuby 上还有很多适合和完成的工作，以使其达到可以*很好*地运行 Rails 的状态。

我们现在缺乏的地方是：

*   启动速度——这对于使用 Rails 时获得良好体验至关重要——尤其是在运行单元测试时。现在启动 Rails 需要 26 秒。*   工作集——我们目前的“hello world”Rails 应用程序为 100MB，而 MRI 为 30MB。

    我们实际上在吞吐量方面做得很好——一旦我们编译好了，事情就会运行得相当好。

    我们正朝着自适应编译策略迈进，我们默认解释并编译我们发现的热点。这将使开发人员的体验*更好*。我们还将有一个提前编译模式（可能与 NGEN 和智能缓存一起使用），这可能比自适应编译策略更好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-06T03:13:48.613

看起来终于有一个了：

[http://www.ironruby.net/Documentation/Rails](http://www.ironruby.net/Documentation/Rails)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T09:26:16.697

很抱歉让您失望，但我认为您必须自己编写教程。除非我遗漏了什么，IronRuby 还没有运行 Rails，尽管他们已经展示了某些方面的运行。

根据[IronRuby 主页](http://www.ironruby.net/)，他们在 RubySpecs 核心包上完成了大约 71%，这可能还远远不够`rails <projectName`。`ironruby script/server`

当 IR 运行 Rails 时，我想我们可能会听说。或者更确切地说，我们可能不得不把自己关在隔离室里，以免听到这件事……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-22T18:39:58.670

这里有一些不错的“一步一步”，适合初学者：[http ://www.ironruby.net/Samples_and_tutorials](http://www.ironruby.net/Samples_and_tutorials)

# resharper - 更改 ReSharper 的配色方案

> ID：386953
> 
> 赞同：12
> 
> 时间：2008-12-22T18:26:29.400
> 
> 标签：resharper, color-scheme

有谁知道如何更改 VS2008 SP1 中的 ReSharper 配色方案？

我环顾四周，互联网上的所有帖子都指向死胡同。JetBrains 曾一度告诉用户更改 VS 中的颜色（工具 | 选项 | 字体和颜色 | 文本编辑器），但我在那里看不到任何 ReSharper 项目。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-09-30T15:31:16.740

重新安装并没有为我解决。这是来自 ReSharper 的支持。注意：以管理员身份运行记事本。

[http://resharper-support.jetbrains.com/entries/26859128-ReSharper-Fonts-Colors-settings-do-not-appear-in-Visual-Studio-after-installation](http://resharper-support.jetbrains.com/entries/26859128-ReSharper-Fonts-Colors-settings-do-not-appear-in-Visual-Studio-after-installation)

问题：

*   ReSharper 字体和颜色设置在安装后不会出现在 Visual Studio 中；
*   来自浅色主题的颜色与深色主题一起使用；

解决方案：

*   关闭所有 Visual Studio 实例；
*   打开 C:\Program Files (x86)\Microsoft Visual Studio {VS version}\Common7\IDE\Extensions\extensions.configurationchanged 文件；
*   在那里输入任何内容；
*   保存文件；
*   打开 VS 并检查工具 | 中的字体和颜色 选项 | 环境;

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-22T18:33:20.807

在 VS|Tools|Options|Environment|Fonts and Colors 中，确保“Show settings for:”列表框设置为 Text Editor，您将找到 ReSharper 项。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-07-02T15:54:45.593

要更改标识符的字体颜色，请转到：

> Resharper > 选项 > 代码检查 > 设置 > 复选框

颜色标识符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T20:06:47.967

谢谢科尔比！重新安装 ReSharper 解决了这个问题。为了将来参考，完整的场景是：

我安装了试用模式 ReSharper，试用期满后我购买了许可证，在试用期间我没有尝试更改配色方案，所以我不知道之前的选项是否在哪里。

重新安装后，我可以转到字体和颜色，所有 ReSharper 选项都在那里！

# web-services - 使用 OpenID 的 Web 服务身份验证

> ID：386973
> 
> 赞同：16
> 
> 时间：2008-12-22T18:33:14.613
> 
> 标签：web-services, openid

我将为一个新的公共网站开发一个 REST-ful Web 服务。Web 服务背后的想法是让第 3 方为业务逻辑开发功能齐全的 UI。

出于安全原因，我想避免用户将我们的服务密码提供给第三方应用程序。（也许这不应该是一个大问题？）相反，我希望在我们的网站上实现某种登录系统，为第 3 方应用程序提供身份验证令牌，但不让他们掌握实际密码。

这让我觉得 OpenID 可能是一个潜在的解决方案。在我看来，它应该可以工作：实际密码由 OpenID 提供程序处理，因此它不依赖于 3rd 方应用程序。我认为问题可能在于各种传递，但这应该是可以管理的。

然而，令人惊讶的是，谷歌缺乏这方面的信息，所以我想听听 SO 的意见。以前有人实施过类似的系统吗？甚至可能吗？值得麻烦吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-09T21:17:28.090

我完全同意您想要的是 OAuth；我说在 OAuth 和 OpenID 系统上都工作过。我也遇到过几次，不得不开发一个 REST Web 服务 API。

有关 OAuth 的真正好想法以及您想要的原因，请参阅这些附加文章：

这些是必须阅读的，有四个部分阅读它们： [http ://hueniverse.com/oauth/guide/](http://hueniverse.com/oauth/guide/)

RFC，在阅读上面之后阅读，因为它对大多数人来说可能有点令人生畏：http: [//oauth.net/core/1.0](http://oauth.net/core/1.0)

最后也许是一些代码。我托管了几个使用 Java/Groovy 进行 OAuth 的项目。一个是普通的旧 OAuth 客户端，另一个是用于与 NetFlix 进行特定交互的客户端。 [http://www.blueleftistconstructor.com/projects/](http://www.blueleftistconstructor.com/projects/)

如果您对 REST 相对缺乏经验（您还没有构建完整的 Web api），我建议您购买（或者最好让您的老板购买）Richardson & Ruby 的“RESTful Web Services”。这是一本 O'Reilly 的书。我可以说这是他们过去几年出道的最好的书之一。

查看一些基于 RESTful OAuth 的 API 也可能会有所帮助。NetFlix API 就是一个完美的例子：http: [//developer.netflix.com/docs](http://developer.netflix.com/docs)

祝你好运，编码愉快！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T18:41:35.487

到目前为止，我发现了 1 个有价值的链接：

[http://markmail.org/message/utf7js473zqv45hv](http://markmail.org/message/utf7js473zqv45hv)

这段对话提到了一个叫做“OpenID Exchange”的东西，它就在我的小巷里……但是包含的链接被破坏了，谷歌上没有太多可靠的信息。

看起来 OAuth 可能是票： http: [//oauth.net/](http://oauth.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-16T04:55:35.250

我们一直致力于为 SOAP Web 服务集成 OpenID 身份验证的项目。[您可以在http://code.google.com/p/ws-sandhana/](http://code.google.com/p/ws-sandhana/)找到我们的项目。

您可以使用 OpenID 身份验证为您的 Web 服务提供 Single Sing On，并且可以通过定义服务安全策略来强制执行受信任的 OpenID 提供程序和用户的必需属性。

这是 Apache Rampart 上的开源实现，它是 Apache Axis2 Web 服务引擎的安全模块。[您可以在http://sandhana-project.blogspot.com/](http://sandhana-project.blogspot.com/)找到我们的博客以获取更多信息。

# delphi - 在 TClientDataSet 中使用定位时是否必须使用禁用/启用控件？

> ID：386977
> 
> 赞同：2
> 
> 时间：2008-12-22T18:35:14.810
> 
> 标签：delphi

还是默认处理？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-22T19:00:08.817

默认情况下，定位不会禁用控件，不。您是否*需*要这样做取决于您是否连接了视觉控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T19:02:26.893

Locate**不会**在*TClientDataSet*上调用*DisableControls / EnableControls*，但它可能并不总是提供明显的好处。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T20:53:31.397

通常，在您触发您的定位之前，您会禁用控件，然后在结果之后立即启用控件。如上所述，它不是自动的，这样做的唯一原因是在搜索期间节省一些时间，通过禁用需要时间重新绘制和/或刷新的可视控件来查询其他数据库操作。

及时受益...取决于您的计划。除此之外，我认为没有真正的理由这样做。

约翰

# linq - 外部连接和 Linq

> ID：386981
> 
> 赞同：0
> 
> 时间：2008-12-22T18:36:06.620
> 
> 标签：linq, linq-to-sql, outer-join

所以我有以下代码：

```
 return from a in DBContext.Acts
         join artist in DBContext.Artists on a.ArtistID equals artist.ID into art
         from artist in art.DefaultIfEmpty()

         select new Shared.DO.Act
         {
             ID = a.ID,
             Name = a.Name,
             Artist = new Shared.DO.Artist
             {
                 ID = artist.ID,
                 Name = artist.Name
             },
             GigId = a.GigID
         }; 
```

这会加载一个行为对象并将其从 linq 对象调整为我的域行为对象。

正如你所看到的，我已经在艺术家上定义了一个外部连接来执行关系。

我这样做是因为我一直想要这个表演，不管它是否有艺术家。

如果该行为确实有艺术家，这将非常有效。

如果没有，那么代码就会死掉。这是罪魁祸首：

```
 Artist = new Shared.DO.Artist
          {
              ID = artist.ID,
              Name = artist.Name
          }, 
```

如果我删除它，它的罚款。有可能做我正在尝试的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T18:45:50.670

```
 Artist = new Shared.DO.Artist
           {
               ID = artist == null ? Guid.NewGuid() : artist.ID,
               Name = artist == null ? string.Empty : artist.Name
           } 
```

或者，向 Shared.DO.Artist 添加一个构造函数，该构造函数采用 Artist 的 Linq 表示。构造函数可以检查 null 并执行所有初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T18:53:12.107

其实……这对我来说似乎是最好的答案……

```
Artist = artist == null ? null : new Shared.DO.Artist
                    {
                       ID =  artist.ID,
                       Name = artist.Name
                    }, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T18:41:33.020

您想通过调用构造函数来创建一个新对象。删除 Artist =，然后将 { } 替换为 ()。

# c# - Novell LDAP C# - Novell.Directory.Ldap - 有人让它工作吗？

> ID：386982
> 
> 赞同：13
> 
> 时间：2008-12-22T18:36:10.130
> 
> 标签：c#, .net, ldap, novell

我正在尝试使用 Novell (Novell.Directory.Ldap) 发布的库。版本 2.1.10。

到目前为止我所做的：

*   我测试了与应用程序（[LdapBrowser](http://www.mcs.anl.gov/~gawor/ldap/index.html)）的连接并且它正在工作，所以它不是通信问题。

*   它是在 Mono 中编译的，但我正在使用 Visual Studio。所以用源创建了一个项目。我还引用了 Mono.Security，因为项目依赖于它。

*   我在捕获部分连接的错误中注释了一个调用 (freeWriteSemaphore(semId); )，因为它引发了更多异常。我检查了那个调用做了什么，它只是一个错误跟踪机制。

*   我遵循了 Novell ( [http://www.novell.com/coolsolutions/feature/11204.html](http://www.novell.com/coolsolutions/feature/11204.html) ) 文档中提供的基本步骤。

    // 创建一个 LdapConnection 实例

    LdapConnection ldapConn=新的 LdapConnection(); ldapConn.SecureSocketLayer = ldapPort == 636;

    //Connect函数将创建一个到服务器的套接字连接

    ldapConn.Connect(ldapHost,ldapPort);

    //Bind函数将用户对象Credentials绑定到服务器

    ldapConn.Bind(userDN,userPasswd);

*   现在它在 Bind() 函数处崩溃。我收到错误 91。

那么，有没有人使用过这个库并看到它有效？如果是这样，你做了什么让它工作，是否需要一些特殊的配置？有没有办法让它在没有 Mono 的 .NET 环境中工作（我可以引用 Mono dll，但我不希望它安装在服务器上）？

（更新）连接在端口 636 上，因此使用 SSL。我检查了 WireShark 的通信，并与我从 LDAP 浏览器获得的信息进行了比较。我已经看到传输 SSL 证书的步骤不是由 LDAP 库完成的。那么，让它做它应该做的最好的方法是什么？

（更新）我检查了文档，它表明它不支持 SSL。[http://www.novell.com/coolsolutions/feature/11204.html](http://www.novell.com/coolsolutions/feature/11204.html)

> 使用 LdapConnection.Bind() 对 LDAP 服务器进行身份验证。我们仅支持明文身份验证。SSL/TLS 支持尚未添加。

但是文档的日期是 2004 年，从那时起，已经进行了许多更新。并且库中有一个参数来定义连接是否使用 SSL。所以现在我很困惑。

（更新）找到了更新的文档： http: [//developer.novell.com/documentation//ldapcsharp/index.html](http://developer.novell.com/documentation//ldapcsharp/index.html?page=/documentation//ldapcsharp/cnet/data/bqwa5p0.html) ?page=/documentation//ldapcsharp/cnet/data/bqwa5p0.html 。建立 SSL 连接的方式是在服务器上注册证书。问题是我所做的没有绑定到特定的 Novell 服务器，因此必须动态获取证书。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T14:38:46.100

我来寻找类似问题的解决方案。使用 Novell 网站上的相同代码时，我的绑定命令也会失败。对我有用的解决方案是添加动态证书验证回调。你可以在[这里](http://msdn.microsoft.com/en-us/library/exchange/dd633677%28v=exchg.80%29.aspx)阅读。

```
 // Creating an LdapConnection instance 
        LdapConnection ldapConn = new LdapConnection();

        ldapConn.SecureSocketLayer = true;

        ldapConn.UserDefinedServerCertValidationDelegate += new
                CertificateValidationCallback(MySSLHandler);

        //Connect function will create a socket connection to the server
        ldapConn.Connect(ldapHost, ldapPort);

        //Bind function will Bind the user object Credentials to the Server
        ldapConn.Bind(userDN, userPasswd);

        // Searches in the Marketing container and return all child entries just below this
        //container i.e. Single level search
        LdapSearchResults lsc = ldapConn.Search("ou=users,o=uga",
                           LdapConnection.SCOPE_SUB,
                           "objectClass=*",
                           null,
                           false);

        while (lsc.hasMore())
        {
            LdapEntry nextEntry = null;
            try
            {
                nextEntry = lsc.next();
            }
            catch (LdapException e)
            {
                Console.WriteLine("Error: " + e.LdapErrorMessage);
                // Exception is thrown, go for next entry
                continue;
            }
            Console.WriteLine("\n" + nextEntry.DN);
            LdapAttributeSet attributeSet = nextEntry.getAttributeSet();
            System.Collections.IEnumerator ienum = attributeSet.GetEnumerator();
            while (ienum.MoveNext())
            {
                LdapAttribute attribute = (LdapAttribute)ienum.Current;
                string attributeName = attribute.Name;
                string attributeVal = attribute.StringValue;
                Console.WriteLine(attributeName + "value:" + attributeVal);
            }
        }
        ldapConn.Disconnect();
        Console.ReadKey();
    }

public static bool MySSLHandler(Syscert.X509Certificate certificate,
            int[] certificateErrors)
        {

            X509Store store = null;
            X509Stores stores = X509StoreManager.CurrentUser;
            //string input;
            store = stores.TrustedRoot;

            X509Certificate x509 = null;
            X509CertificateCollection coll = new X509CertificateCollection();
            byte[] data = certificate.GetRawCertData();
            if (data != null)
                x509 = new X509Certificate(data);

            return true;
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T21:54:48.263

我终于找到了一种方法来完成这项工作。

首先，这些帖子帮助我走上正轨：[http ://directoryprogramming.net/forums/thread/788.aspx](http://directoryprogramming.net/forums/thread/788.aspx)

其次，我得到了 Novell LDAP 库的编译 dll 并使用了 Mono.Security.Dll。

解决方案：

我将此功能添加到代码中

```
// This is the Callback handler - after "Binding" this is called
        public bool MySSLHandler(Syscert.X509Certificate certificate, int[] certificateErrors)
        {

            X509Store store = null;
            X509Stores stores = X509StoreManager.LocalMachine;
            store = stores.TrustedRoot;

            //Import the details of the certificate from the server.

            X509Certificate x509 = null;
            X509CertificateCollection coll = new X509CertificateCollection();
            byte[] data = certificate.GetRawCertData();
            if (data != null)
                x509 = new X509Certificate(data);

            //List the details of the Server

            //if (bindCount == 1)
            //{

            Response.Write("<b><u>CERTIFICATE DETAILS:</b></u> <br>");
            Response.Write("  Self Signed = " + x509.IsSelfSigned + "  X.509  version=" + x509.Version + "<br>");
            Response.Write("  Serial Number: " + CryptoConvert.ToHex(x509.SerialNumber) + "<br>");
            Response.Write("  Issuer Name:   " + x509.IssuerName.ToString() + "<br>");
            Response.Write("  Subject Name:  " + x509.SubjectName.ToString() + "<br>");
            Response.Write("  Valid From:    " + x509.ValidFrom.ToString() + "<br>");
            Response.Write("  Valid Until:   " + x509.ValidUntil.ToString() + "<br>");
            Response.Write("  Unique Hash:   " + CryptoConvert.ToHex(x509.Hash).ToString() + "<br>");
            // }

            bHowToProceed = true;
            if (bHowToProceed == true)
            {
                //Add the certificate to the store. This is \Documents and Settings\program data\.mono. . .
                if (x509 != null)
                    coll.Add(x509);
                store.Import(x509);
                if (bindCount == 1)
                    removeFlag = true;
            }

            if (bHowToProceed == false)
            {
                //Remove the certificate added from the store.

                if (removeFlag == true && bindCount > 1)
                {
                    foreach (X509Certificate xt509 in store.Certificates)
                    {
                        if (CryptoConvert.ToHex(xt509.Hash) == CryptoConvert.ToHex(x509.Hash))
                        {
                            store.Remove(x509);
                        }
                    }
                }
                Response.Write("SSL Bind Failed.");
            }
            return bHowToProceed;
        } 
```

我在绑定过程中使用它

```
// Create Connection
                LdapConnection conn = new LdapConnection();
                conn.SecureSocketLayer = true;
                Response.Write("Connecting to:" + ldapHost);

                conn.UserDefinedServerCertValidationDelegate += new
                    CertificateValidationCallback(MySSLHandler);

                if (bHowToProceed == false)
                    conn.Disconnect();
                if (bHowToProceed == true)
                {
                    conn.Connect(ldapHost, ldapPort);
                    conn.Bind(loginDN, password);
                    Response.Write(" SSL Bind Successfull ");

                    conn.Disconnect();
                }
                quit = false; 
```

关键元素是使用 SSL 处理程序动态获取证书，并使用 X509StoreManager.LocalMachine 以便在网站运行时能够保存和获取证书。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T18:59:21.003

91 是“无法连接”。尝试将服务器设置为“ldap://xxxx”格式，检查 userDN 是否设置正确（使用域等）。

我经常使用[WireShark](http://www.wireshark.org)来查看网络级别的情况（它知道 LDAP 协议）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-26T10:57:03.690

我从事 Forefront Identity Manager 集成工作。所以我写的代码总是来自几个调用客户端。如果您尝试打包应用程序以“在任何地方”使用，这可能不合适。

我只是想用一个简单的解决方案来更新这个线程，该解决方案适用于启用了默认 TLS/SSL“需要机密性”选项的 Novell 服务器。

1) 确保您从正在绑定的 Novell 服务器上获取 SSL 证书，并将这些证书注册到正在执行的客户端/服务器上的受信任存储中。通常有两个 1 用于 IP 和主机名，取决于您将调用的主机名（最好是 DNS）

2) 使用 System.DirectoryServices 导入以下/添加引用；使用 System.DirectoryServices.Protocols；

3）这是一个片段。确保选择 AuthenticationTypes.SecureSocketsLayer 是关键。

```
// serverAddress = Server IP or DNS (Match SSL certificate)
// ObjectDN = The DN of the user you are binding to
// userName = Account which will be used to make the bind
// password = password of the user which will make the bind
// value = The value you wish to add to the attribute

// Connect to the user in LDAP
DirectoryEntry entry = new DirectoryEntry("LDAP://" + serverAddress + "/" + ObjectDN + ""
                , userName
                , password
                , AuthenticationTypes.SecureSocketsLayer);
// Write the Updated attribute
entry.Properties["attribute"].Value = value;
// Read back the updated Attribute into a label
label.Text = entry.Properties["attribute"].Value.ToString(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-22T19:04:41.833

我想我可能已经在另一个问题中向其他人提供了这个答案。

[关于 LDAP 的其他问题][1]

我认为有两个问题：1）你想要做什么样的绑定？SSL？清晰的文字？匿名的？

2) 如何在 eDirectory 端配置 LDAP 绑定？

工具 LDAP Browser，你指的是这个链接上的那个吗？免费的 LDAP 浏览器

在 eDirectory 方面，它们可以要求所有 LDAP 通信都使用 TLS，并且它们可以禁止匿名绑定。

您能否要求另一端的人员启用 LDAP 跟踪（使用启用了 +LDAP 选项的 DStrace，有关如何在 Novell eDirectory 上使用 Dstrace 的一些链接查看：不同类型的 Dstrace 捕获和了解 Identity Manager 的 DS 跟踪。）

这通常会显示一条可以启发您的错误消息。

我的猜测是启用了 Require TLS，并且您可能没有进行成功的 SSL 绑定。

如果是这样，请尝试连接端口 636，启用 SSL，并为您尝试登录的用户提供完全限定的 DN。

如果您尝试启用 SSL，但没有弹出关于接受树 CA 的受信任根证书的弹出框，则可能是 eDirectory 服务器用户的 CA 或 SSL 证书已过期或损坏。（这有很多常见的原因，只需一点时间即可解决）。

通常在 Dstrace 中，如果出现问题，您会看到有关 SSL 证书的错误。本文提供了一个从 Novell Identity Manager 角度来看已过期证书的示例：证书已过期以及有关如何修复证书的一些详细信息。

下一个可能性是您指定的 DN 不完全正确。

如果您需要更多帮助，请告诉我。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-06-03T09:25:40.233

UserDefinedServerCertValidationDelegate 已过时，因此如果是无效 ssl 证书的问题，您可以通过这种方式跳过证书验证：

```
 LdapConnectionOptions options = new LdapConnectionOptions()
            .ConfigureRemoteCertificateValidationCallback(new CertCallback((a, b, c, d) => true))
            .UseSsl();

        LdapConnection connection = new LdapConnection(options);

        connection.Connect(...); 
```

但是，您应该查看忽略证书是否是您的应用程序的安全解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T16:33:08.473

按照我之前的帖子 - 如果您必须使用安全连接，请尝试使用 ldaps:// 作为服务器地址的前缀。

如果没有 SSL/TLS 支持，您可以试试[这个](http://www.codeproject.com/KB/dotnet/dotnetopenldap.aspx)——OpenLDAP 库的指南和 .NET 包装器。

重要的一点 - OpenLDAP 中有 TLS 安全级别的设置，因此如果您的 LDAP 服务器有自签名证书，您要么必须在客户端导入它，要么将 TLS 设置为不检查签名授权*当然安全性较低）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-09-04T07:55:14.510

我经历过这个场景，对我来说，在 Kubernetes 容器中运行的 Novell LDAP 服务。我尝试将 CA 证书添加到 Mono 信任库，这将在 linux 容器的“/usr/share/.mono/certs/Trust”中添加文件。但是没有任何效果，对于 LDAP 636 端口，Novell 仍然连接不成功。

最后我使它以下列方式工作：

```
LdapConnection Connection = new LdapConnection();
    Connection.SecureSocketLayer = true;
    Connection.UserDefinedServerCertValidationDelegate += new
            Novell.Directory.Ldap.RemoteCertificateValidationCallback(LdapSSLHandler);

    public bool LdapSSLHandler(object sender, System.Security.Cryptography.X509Certificates.X509Certificate certificate, System.Security.Cryptography.X509Certificates.X509Chain chain,
                  System.Net.Security.SslPolicyErrors sslPolicyErrors)
    {
        if (sslPolicyErrors == sslPolicyErrors.None)
        {
            return true;   //Is valid
        }

        if (certificate.GetCertHashString() == "YOUR CERTIFICATE HASH KEY") // Thumbprint value of the certificate
        {
            return true;
        }

        return false;
    } 
```

# c# - 过滤掉搜索查询的常用词

> ID：386995
> 
> 赞同：2
> 
> 时间：2008-12-22T18:40:13.100
> 
> 标签：c#, search, stop-words

是否有任何简单的方法可以通过提取查询中的有意义的数据来过滤用户的输入（可能是一个问题）？

我基本上想过滤掉任何干扰词，这样我就可以向谷歌的搜索 API 发送一个“干净”的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T18:49:12.537

嗯，谷歌不会为你做这件事吗？把那些脏话发给谷歌，让他们帮你清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T18:46:15.040

Jeff 在之前的一个 stackoverflow 播客中谈到了“停用词”。您可以尝试在 google 上搜索该短语。维基百科页面似乎有一些概述和选项指针。

[http://en.wikipedia.org/wiki/Stop_words](http://en.wikipedia.org/wiki/Stop_words)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T18:46:39.453

您可以尝试删除前 X 个最常用的英语单词，但像这样幼稚的方法总是会遇到麻烦。

这是因为常见的英语单词在计算机科学（或其他领域）领域可能具有特殊意义。最近的 SO 播客（[#32](https://blog.stackoverflow.com/2008/12/podcast-32/)）提到了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-22T19:13:35.263

我在实现一个基本的搜索引擎时使用了停用词方法，它工作得很好。尝试像[这里这样的示例列表](http://www.dcs.gla.ac.uk/idom/ir_resources/linguistic_utils/stop_words)

根据用户的反馈，您可以相应地修改停用词列表。

# silverlight - 动态加载用户控件和默认命名空间

> ID：386997
> 
> 赞同：1
> 
> 时间：2008-12-22T18:40:56.860
> 
> 标签：silverlight, xaml, user-controls

在 Silverlight 中，当您想要动态创建控件时，必须添加这样的命名空间（如[http://msdn.microsoft.com/en-us/library/cc189044(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc189044(VS.95).aspx)中）：

```
XNamespace xmlns = "http://schemas.microsoft.com/client/2007";
    XElement textBlock2 = new XElement(xmlns + "TextBlock",
        new XAttribute(XNamespace.Xmlns + "x", "http://schemas.microsoft.com/winfx/2006/xaml"),
        ...
        ); 
```

我的问题是我在自己的命名空间中有一个用户控件，所以我必须写类似

```
XNamespace myxmlns = "mynamespace";
XElement myelem = new XElement(myxmlns + "MyCtrl", ... 
```

然后我可以像这样添加别名命名空间

```
new XAttribute(XNamespace.Xmlns + "x", "http://schemas.microsoft.com/winfx") 
```

但我不知道如何添加默认命名空间。无论我尝试什么，我都会收到编译错误或运行时错误（“AG E PARSER MISSING DEFAULT NAMESPACE”）。

我成功地构建了一大串我需要的东西，但我想了解我缺少什么。

任何的想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T20:10:10.097

从[这里的 XNamespace 文档](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnamespace.aspx)：

```
new XAttribute("xmlns", "http://http://www.adventure-works.com") 
```

只需将其添加为 XAttribute。****************