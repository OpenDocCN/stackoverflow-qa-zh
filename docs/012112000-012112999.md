# StackOverflow 问答 12112000-12112999

# c# - 用作池的无序线程安全集合？

> ID：12112013
> 
> 赞同：3
> 
> 时间：2012-08-24T15:06:52.397
> 
> 标签：c#, collections, pool

我创建了一个池类，当被询问时，它会查找或初始化一个项目并将其返回给调用者。我使用 a`ConcurrentQueue<T>`作为基础集合，但我不确定它是否适合使用。

我不需要按任何特定顺序排列项目，我只需要一个可以推送和弹出的线程安全集合。.NET 有为此目的的快速收集类吗？

**编辑：**我`ConcurrentBag<T>`在花费者的回答后使用：

```
public sealed class Pool<T>
{
    private readonly Func<T> initializer;

    private readonly ConcurrentBag<T> bag;

    public Pool(Func<T> initializer)
    {
        if (initializer == null)
            throw new ArgumentNullException("initializer");

        this.initializer = initializer;
        this.bag = new ConcurrentBag<T>();
    }

    public Pool(Func<T> initializer, IEnumerable<T> collection)
    {
        if (initializer == null)
            throw new ArgumentNullException("initializer");

        if (collection == null)
            throw new ArgumentNullException("initializer");

        this.initializer = initializer;
        this.bag = new ConcurrentBag<T>(collection);
    }

    public Pool(Func<T> initializer, int allocationCount)
        : this(initializer)
    {
        if (allocationCount < 0)
            throw new ArgumentOutOfRangeException("allocationCount");

        for (int i = 0; i < allocationCount; i++)
            this.bag.Add(initializer.Invoke());
    }

    public void Push(T item)
    {
        this.bag.Add(item);
    }

    public T Pop()
    {
        T item;
        return this.bag.TryTake(out item)
            ? item
            : this.initializer.Invoke();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:08:10.460

[ConcurrentBag](http://msdn.microsoft.com/en-us/library/dd381779.aspx)听起来就像一张票。您需要自己处理空箱，但它似乎非常适合您的需求。特别是，[ConcurrentBag.TryTake](http://msdn.microsoft.com/en-us/library/dd381774.aspx)将从集合中获取**一个**项目，但不保证会返回任何特定的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:10:22.293

[http://msdn.microsoft.com/en-us/library/dd381779](http://msdn.microsoft.com/en-us/library/dd381779)

`ConcurrentBag<T>`是的无序等价物`ConcurrentQueue<T>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:10:22.583

`ConcurrentBag`是一个无序的集合，它是线程安全的。

# wpf - WPF DataGrid 切换选择模式和 CellTemplate 中的按钮

> ID：12112014
> 
> 赞同：1
> 
> 时间：2012-08-24T15:07:03.380
> 
> 标签：wpf, events, toggle, wpfdatagrid

我正在构建一个 POS 应用程序，我希望最终用户能够为数据网格设置切换选择模式，即他们可以单击多行，并且每个单击的项目都将累积在 SelectedItems 属性上——也可以单击一行已选择的将取消选择该行。我在另一个 stackoverflow 问题中找到了这段代码：

```
<DataGrid.Resources>
    <Style TargetType="{x:Type DataGridCell}">
        <EventSetter Event="PreviewMouseLeftButtonDown" Handler="DoCheckRow" />
    </Style>
</DataGrid.Resources>

public void DoCheckRow(object sender, MouseButtonEventArgs e)
{
    DataGridCell cell = sender as DataGridCell;
    if (cell != null && !cell.IsEditing)
    {
        DataGridRow row = VisualHelpers.TryFindParent<DataGridRow>(cell);
        if (row != null)
        {
            row.IsSelected = !row.IsSelected;
            e.Handled = true;
            Debug.WriteLine(sender);
        }
    }
} 
```

就切换选择模式而言，这有效地为我提供了我想要的东西，但是，当我将按钮添加为 CellTemplate 时，单击时不会触发按钮命令，因为我`e.Handled = true;`在上面的代码中进行了设置以停止事件气泡。有没有办法可以同时兼顾两者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:24:45.790

也许您可以尝试在按钮上放置一个 AttachedBehavior？通过这种方式，您可以从图片中获取命令并处理 AttachedBehavior 中的单击事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-26T18:22:48.100

您也可以使用一个复选框来执行此操作，该复选框将在相应行上切换选择。

```
<DataGrid.RowHeaderTemplate>
   <DataTemplate>
      <CheckBox IsChecked="{Binding Path=IsSelected, Mode=TwoWay,
                           RelativeSource={RelativeSource FindAncestor,
                           AncestorType={x:Type DataGridRow}}}"/>
   </DataTemplate>
</DataGrid.RowHeaderTemplate> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T16:55:51.393

我能够通过使用一些辅助函数来查找可视子/父和一些命中测试来解决它：

```
public void DoCheckRow(object sender, MouseButtonEventArgs e)
{
    DataGridCell cell = sender as DataGridCell;
    if (cell != null && !cell.IsEditing)
    {
        DataGridRow row = VisualHelpers.TryFindParent<DataGridRow>(cell);
        if (row != null)
        {
            Button button = VisualHelpers.FindVisualChild<Button>(cell, "ViewButton");

            if (button != null)
            {
                HitTestResult result = VisualTreeHelper.HitTest(button, e.GetPosition(cell));

                if (result != null)
                {
                    // execute button and do not select / deselect row
                    button.Command.Execute(row.DataContext);
                    e.Handled = true;
                    return;
                }
            }

            row.IsSelected = !row.IsSelected;
            e.Handled = true;
        }
    }
} 
```

虽然它不是最优雅的解决方案，但它适用于我使用的 MVVM 模式。

# jquery - 页面滚动技术/过渡 - 如何

> ID：12112019
> 
> 赞同：1
> 
> 时间：2012-08-24T15:07:23.090
> 
> 标签：jquery, css, html, scroll

我完全不确定它叫什么，但我看到这种技术被越来越多地使用。它是什么？如何做到这一点？

例如： http: [//fearthegrizzly.com/](http://fearthegrizzly.com/) - 向下滚动，图像随着“We Love Film”的出现而消失 [http://www.minervastreetwear.com/lookbook/](http://www.minervastreetwear.com/lookbook/) - 戴帽子的人与穿夹克的人的图像滚动率与文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:27:52.993

它被称为视差。也许您想阅读这篇博客文章：

[http://smashinghub.com/7-jquery-parallax-and-scrolling-effect-plugins.htm](http://smashinghub.com/7-jquery-parallax-and-scrolling-effect-plugins.htm)

# ios - 适用于 iOS 的 Evernote API：无法在书中列出笔记

> ID：12112020
> 
> 赞同：1
> 
> 时间：2012-08-24T15:07:42.320
> 
> 标签：ios, evernote

使用 Evernote API for iOS，我可以毫无问题地创建笔记本和新笔记。但是，一旦我尝试获取某个笔记本（我知道其中的 guid）中的笔记列表，我就会收到此错误：

```
2012-08-23 22:15:09.734 Meernotes[9900:c07] FN error: Error Domain=com.evernote.sdk Code=3 "The operation couldn’t be completed. (com.evernote.sdk error 3.)" UserInfo=0xa554c80 {parameter=authenticationToken} 
```

所以看起来好像我的 authenticationToken 有问题。为了创建笔记本或笔记，我也需要经过身份验证，所以我不明白为什么在笔记本中列出笔记时我没有经过身份验证。这是我正在调用的代码：

```
EDAMNoteFilter *filter = [[EDAMNoteFilter alloc] initWithOrder:1 ascending:FALSE words:nil notebookGuid:guid tagGuids:nil timeZone:nil inactive:NO];
EvernoteNoteStore *noteStore = [EvernoteNoteStore noteStore];
[noteStore findNotesWithFilter:filter offset:0 maxNotes:[EDAMLimitsConstants EDAM_USER_NOTES_MAX] success:^(EDAMNoteList *list) {
    //
    NSLog(@"all notes in notebook: %@", list.notes);
} failure:^(NSError *error) {
    //
    NSLog(@"FN error: %@", error);
}]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T15:28:06.943

好的，我刚刚找到了答案：我无法在具有 API 基本访问权限的笔记本中列出笔记。我再次注册并选择了“完全访问权限”。此外，我必须在沙盒环境中注册一个新的测试用户并在我的应用程序中注册该用户，以使我的应用程序完全访问沙盒用户的笔记。现在一切都很好！

# java - 选择语句mysql java？

> ID：12112027
> 
> 赞同：0
> 
> 时间：2012-08-24T15:08:05.837
> 
> 标签：java, mysql, database

我对下面的列表有疑问，我需要选择搜索 id 并打印对象，我知道我做错了什么，但我该如何解决？我应该离开while还是for？

```
String query = "SELECT id, fecha, folio FROM capacitacion.pedido WHERE id = ?"; 

PreparedStatement s = con.prepareStatement(query);   
s.setInt(1, obj.getId());

ResultSet resultado = s.executeQuery(); 

while(resultado.next()){
    for(PedidoDetalleDTO detalle : obj.getPedidoDetalle()) {
        dto.getId();
        dto.getFecha();
        dto.getTotal();
        dto.getFolio();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:15:03.430

我想你误解了如何使用 ResultSet。只是一个示例（不是您的真实代码）：

```
String query = "SELECT id, fecha, folio FROM capacitacion.pedido WHERE id = ?"; 

PreparedStatement s = con.prepareStatement(query);   
s.setInt(1, obj.getId());

List<Foo> fooList = new ArrayList<Foo>();

ResultSet resultado = s.executeQuery(); 

while(resultado.next()){  
    Foo f = new Foo();
    f.setId( resultado.getInt( "id" ) );
    f.setFecha( resultado.getString( "fecha" ) );
    fooList.add( f );
}

for ( Foo f : fooList ) {
    System.out.println( f.getId() + " " + f.getFecha() );
} 
```

# c# - .Net 源代码 (HttpApplication.cs) 中的奇怪变量名 (_[....])

> ID：12112031
> 
> 赞同：6
> 
> 时间：2012-08-24T15:08:17.110
> 
> 标签：c#, .net

我正在逐步浏览 .Net Framework 源代码以找到一个棘手的错误（HttpApplication.cs），并且我注意到代码中有这样的行（这些是复制/粘贴，我没有编辑任何内容）：

```
_[....] = true; 
```

和

```
_[....] = false; 
```

我想知道这是否是混淆代码，或者这是我以前从未见过的某种 c# 约定？VS 2012 似乎认为它不是真正的代码。

任何人都可以启发我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T18:20:44.420

实际 HttpApplication.cs 代码中存在的字段名称是“_sync”。有一个自动化工具，它在向公众发布之前在源代码上运行；该工具会清除开发人员姓名等内容。看起来这只是误报。我将与适当的团队一起提出它，看看是否可以纠正它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T18:14:38.757

这个特殊的标记似乎出现*在*.NET 参考源代码中。它在注释中的使用频率远高于作为变量使用，但`HttpApplication.cs`不是它显示的唯一位置（例如，`WeakKeyDictionary`将其用作`lock`目标。）

在很多情况下。它是“同步”一词的同义词，如：

```
InstancePersistenceContext.cs:1586: Fx.AssertAndThrowFatal(this.context.Active, 
    "Out-of-[....] between InstanceExecutionContext and ExecutionAsyncResult.");

EditModeSwitchButton.cs:64: // [....] to the owning PropertyContainer only if requested to do so 
```

我最喜欢的，来自一个过时的`System.Web.Mobuile`课程：

```
TemporaryBitmapFile.cs: private void [....]() 
```

关于它的来源，我*最好的猜测*是，它是在向公众发布之前在源代码上完成的预发布步骤（它出现在我找到的参考源的每个副本中，但*不是*SSCLI不久前发布。比较，例如`RemotingProxy.cs:222`：

```
SSCLI: int callType = Message.Sync;
RefSec: int callType = Message.[....]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:18:39.947

你是对的，源代码包含一个名为的布尔变量 `_[....]`。我猜在编写代码时无法确定变量的名称；后来忘记修了。 [http://reflector.webtropy.com/default.aspx/Net/Net/3@5@50727@3053/DEVDIV/depot/DevDiv/releases/whidbey/netfxsp/ndp/fx/src/xsp/System/Web/ HttpApplication@cs/10/HttpApplication@cs](http://reflector.webtropy.com/default.aspx/Net/Net/3@5@50727@3053/DEVDIV/depot/DevDiv/releases/whidbey/netfxsp/ndp/fx/src/xsp/System/Web/HttpApplication@cs/10/HttpApplication@cs)

# javascript - javascript执行时间不同

> ID：12112035
> 
> 赞同：0
> 
> 时间：2012-08-24T15:08:31.333
> 
> 标签：javascript

我试图找出捕获语句执行时间的最佳方法。比如 js stmt 比如 if(txt =='abc') 所用的时间是多少。如果我使用 console.time('test')/console.endTime('test') 对来计算或使用简单的 js 代码（如下所示）来计算每次执行代码时控制台输出都会变化的时间。

有时在控制台上看到的差异有时是 1 位、2 位到 3 位（以毫秒为单位），即有时 1 毫秒、60 毫秒和有时 800 毫秒，顺序也不一致。我什至尝试只运行一次并关闭浏览器并再次运行它，以便其他 GC 和变量不会出现妨碍时间，但结果是相同的。几毫秒是不可理解的，但如此巨大的差异需要花费很多时间。那么究竟什么是让解释器执行时间的最佳且一致的方法。我们如何找到最佳标准来证明以某种方式编写或最好使用时哪个 stmt 性能更好

```
var start = (new Date).getMilliseconds();
if(txt =='abc'){};
var diff = (new Date).getMilliseconds() - start;
console.log(diff); 
```

**所有测试均在 FF 中进行。还有不同的方法，例如 getMilliseconds、getTime 和 console.endTime 一个接一个 **

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:13:25.470

Erm .. 您正在使用两个非常不同的*函数*来检索当前时间戳。

```
Date.prototype.getMilliseconds() 
```

返回另一个（更短的）数字

```
Date.prototype.getTime() 
```

所以这通常不是一个好主意，很可能是你的问题的原因。如果你想在代码中测量，你应该总是使用`.getTime()`or，更好，`Date.now()`. 两者都返回完整的时间戳编号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:31:46.443

这里的重点是执行这条指令的时间在大多数情况下远小于 0ms，所以我不明白你为什么会有这些差异。如果我在我的机器上运行：

```
for (x = 0; x < 100; x++) {                       
    var start = (new Date).getMilliseconds();
    if(txt =='abc'){};
    var diff = (new Date).getMilliseconds() - start;
    print(diff);
} 
```

我得到：

```
0
0
0
0
... 
```

# javascript - 仅对更改的值添加远程验证

> ID：12112047
> 
> 赞同：1
> 
> 时间：2012-08-24T15:08:54.243
> 
> 标签：javascript, jquery, jquery-validate

我一直在尝试在 jquery 验证插件上完成这项工作，我尝试了几乎所有找到的答案。

但是没有一个起作用，所以我自己编写了脚本，但它仍然不起作用：/

问题： **由于用户自己的电子邮件，电子邮件重复检查卡住了**

我所做的是：

我编写了一个函数，它使用 EmailValid 类将函数绑定到每个元素。该绑定函数检查该值是否为默认值，如果是则删除远程规则，否则添加远程规则。我还在文档就绪状态下运行“默认值检查功能”。

```
<input type="hidden" id="Email_default" value="<?php echo $val; ?>" />
<input type="textbox" class="emailValid" id="Email" name="Email" value="<?php echo $val; ?>" /></td>
<script>
$(document).ready(function()
{
    $(".emailValid").each(
    function()
    {
        rules.rules[$(this).attr("id")]=
        {
            required: true,
            email: true,
            remote:"<?php echo base_url(); ?>home/checkmail"
        };
        rules.messages[$(this).attr("id")]=
        {
            required:"Please enter a valid email address",
            email:"Please enter a valid email address",
            remote:"This email address is already registered"
        };
        $("#editForm").validate(rules);
        setRemoteValidation(this);
        $(this).change(
        function()
        {
            setRemoteValidation(this);
        });
    });
});
var rules={
rules:{},
messages:{}
};
function setRemoteValidation(el)
{
    if($("#"+$(el).attr("id")+"_default").val()!=$(el).val())
    {
        $(el).rules("add", {
         rules:         {
            required: true,
            email: true,
            remote:"<?php echo base_url(); ?>home/checkmail"
        },
         messages: {
            required:"Please enter a valid email address",
            email:"Please enter a valid email address",
            remote:"This email address is already registered"
        }
        });
    }
    else
    {
        $(el).rules("remove","remote");
    }
}
</script> 
```

# cordova - Sencha Touch 2 和 Cordova/PhoneGap 2 无法正确加载

> ID：12112048
> 
> 赞同：1
> 
> 时间：2012-08-24T15:08:56.733
> 
> 标签：cordova, sencha-touch-2, cordova-2.0.0

我整个星期都在使用桌面编写一个 Sencha Touch 2 应用程序来测试它。我刚刚尝试将它与 PhoneGap 集成并在 iOS 模拟器和物理 iOS 设备上进行测试。

我可以看到 ST2 应用程序正在触发“启动”，并确认该应用程序仍然可以在桌面上运行......但 Ext.viewport.add(...) 似乎没有更新屏幕（默认蓝色/闪烁点加载器仍显示）。

我的 index.html 看起来像这样：

```
<!DOCTYPE HTML>
<html manifest="" lang="en-US">
<head>
<meta charset="UTF-8">
<title>Yoga Journal's FindYoga</title>
<link href="resources/css/app.css" type="text/css" rel="stylesheet" />
<style type="text/css">
  /* trimmed css */
</style>
<script type="text/javascript" src="cordova-2.0.0.js"></script>
<script id="microloader" type="text/javascript" src="sdk/sencha-touch.js"></script>
<script id="microloader" type="text/javascript" src="all-classes.js"></script>
<script id="microloader" type="text/javascript" src="app.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
</head>
<body>
<div id="appLoadingIndicator">
    <div></div>
    <div></div>
    <div></div>
</div>
</body>
</html> 
```

我的 app.js 看起来像这样：

```
Ext.application({
    name: 'YogaNow',

controllers: ['Main', 'C1','C2','C3'],
    views: ['Main'],
    stores: ['S1', 'S2', 'S3','S4'],
    models: ['M1', 'M2', 'M3','M4'],

    launch: function() {
        console.log('launch');
        Ext.Viewport.add({
            xtype: 'mainpanel',
        });
    },
});

if(Ext.os.deviceType == 'Desktop') {
    setTimeout(function() {
        var e = document.createEvent('Events');
            e.initEvent('deviceready');
            document.dispatchEvent(e);
    }, 250);
} 
```

如前所述，该应用程序在桌面上运行良好（没有错误）。如果我从 index.html 中删除 cordova 引用并注释掉“if(Ext.os.deviceType) {...}”，它也会在 iOS（模拟器和设备）下的 Safari 中正常运行。

当在模拟器或设备上运行时，删除对 cordova 的引用还可以使应用程序在 PhoneGap/Cordova s​​hell 中工作。

为什么包含 cordova-2.0.0.js 然后在 Xcode 中构建会导致 ST2 代码不更新视图？

# c# - 禁用输出缓存

> ID：12112050
> 
> 赞同：3
> 
> 时间：2012-08-24T15:09:02.577
> 
> 标签：c#, asp.net-mvc, caching, output-caching

我有一个添加缓存的 actionResult。

```
[OutputCache(Duration = 120)] 
```

当我更改页面上的某些元素时，即缓存，我想删除缓存的输出。这是我所做的

```
public void RemoveCachingForProfile(string guid)
{
    HttpResponse.RemoveOutputCacheItem("/Profile/" + guid);
} 
```

当我更改页面中的某些内容时，我会通过该`RemoveCachingForProfile`功能。然后，当我回到我的个人资料页面时，它仍然显示缓存中的内容，即使我禁用了它。

如果我按 f5，它会显示正确的输出。似乎是正在缓存页面的浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:12:15.953

您必须将缓存存储在服务器而不是本地计算机上：

```
[OutputCache(Location = OutputCacheLocation.Server, Duration = 120)] 
```

这是依赖关系：

```
System.Web.UI 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:11:52.760

如果没有 Location 属性，除了服务器端缓存之外，输出缓存提供程序还告诉客户端（浏览器）在属性属性上给定的持续时间内缓存响应。为了防止这种情况，您需要使用[OutputCacheAttribute的](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute%28v=vs.108%29.aspx)[Location](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.location%28v=vs.108%29.aspx)属性

将您的属性更改为此将解决您的问题：

```
[OutputCache(Duration = 120, Location=OutputCacheLocation.Server)] 
```

# json - JSON 解组

> ID：12112051
> 
> 赞同：2
> 
> 时间：2012-08-24T15:09:04.137
> 
> 标签：json, spring, spring-mvc

我是 Spring 技术的新手，我正在尝试开发一个小型 Web 应用程序 servlet。

应用程序接收 JSON 请求，对其进行处理并返回 JSON 响应。

JSON 请求如下所示：

```
{ "Objects": ["Object 1", "Object 2", ... , "Object n"] } 
```

我想将此请求解组为我编写的以下简单 POJO。

```
public class ObjectList {
   protected List<String> objects;
   ...
} 
```

我已经添加了 Jackson 库，并且我有一个用于 JSON 视图的 bean，如下所示：

```
<bean id="jsonView" class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
    <property name="modelKey" value="obj" />
</bean> 
```

鉴于我手头的**`HttpServletRequest`请求**，如何将其解组到对象中？

# javascript - 原型中的漂亮代码，如何在空结果选择器上省略“不是函数”错误

> ID：12112052
> 
> 赞同：0
> 
> 时间：2012-08-24T15:09:08.970
> 
> 标签：javascript, prototype

当我在 jQuery 中执行此操作并且`li.notsuchelem`不存在时

```
$('li.notsuchelem').closest('div') 
```

它工作正常

但是当我在原型中做同样的事情时，它给了我一个错误

```
$$('li.notsuchelem').up('div')

>TypeError: $$('li.notsuchelem').up is not a function 
```

我怎样才能制作漂亮的代码：

```
if ($$('li.notsuchelem').length) $$('li.notsuchelem').up('div');

>>>>

var tmp;
if ((tmp = $$('li.notsuchelem')).length) tmp.up('div');

>>>>

$$('li.notsuchelem').each(function(el){el.up('div')}); 
```

与 jQuery 方式相反，一切对我来说都是丑陋的。有什么我可以做的还是我必须处理它？

* * *

好吧，我想我会接受答案，但要么我编码错误，要么我只是不喜欢 Prototype

jQuery：

```
$('.ss_new:not(.force_visible)', wrapper).closest('tr').hide(); 
```

原型：

```
wrapper.select('.ss_new:not(.force_visible)').invoke('up','tr').invoke('hide'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:19:14.747

我认为它在prototypejs中是这样的。

```
$$(".test").invoke("up", "div"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:15:51.163

您可以将返回的数组强制转换为数字，而不是长度。`&&`此外，您可以使用逻辑 AND ( ) 运算符的副作用。

```
+$$('li.notsuchelem') && $$('li.notsuchelem').up('div'); 
```

# android - Sip2Peer。尝试使引导程序和 Android 示例工作 --> numPeer 始终为 0 并且列表为空

> ID：12112053
> 
> 赞同：0
> 
> 时间：2012-08-24T15:09:11.077
> 
> 标签：android, p2p, sip

我是 Sip2Peer 的新手，我试图将我的 Bootstrap Peer 和 SBC 设置为使用 Android 示例。我在我的服务器中安装了 Apache Ant 并执行了 BootstrapPeer.java 和 SessionBorderController.java。执行 SBC 时会出现以下警告：

```
WARNING: file "users.db" not found: created new empty DB 
```

我用touch users.db创建的，不知道好不好。

然后我使用适用于 Android 的 Sip2Peer 应用程序执行了 2 个模拟器，并在我的智能手机中也执行了它。我这样配置它们（两个 IP 相同，只是出于安全目的而隐藏）：

```
Bootstrap Peer: bootstrap@147.83.XXX.XXX:5080
SCB Server: 147.83.XXX.XXX:6066 
```

在我的智能手机中，我没有配置 SBC，因为我使用的是 3G 连接，它不在 NAT 后面。我的两个模拟器在 NAT 后面，所以我配置了它。然后我在两个模拟器中单击了 SBC 菜单选项，并从所有三个设备发送了加入消息。

当我在模拟器中执行此操作时，会出现带有消息“Received:peer_list”的 Toast，但它不会出现在我的智能手机中。是因为我没有使用 SBC 吗？如果我不在 NAT 后面，我认为不需要它。

问题是，如果我检查对等列表，它总是空的。我在我的引导文件和 onReceivedJSONMsg 的以下句子中设置了一些 println：

```
//check the numPeerList field
int numPeer = (Integer) peerMsg.get("numPeerList"); 
```

此 numPeer 始终为 0，因此它永远不会进入 if 子句。这是我的日志入口：

```
{"sender":"peerDroid@10.0.2.XXX:50250","timestamp":1345816615658, "byte":218, "type":"recv", "typeMessage":"peer_join"}
{"sender":"peerDroid@10.178.51.XXX:50250","timestamp":1345816615658, "byte":223, "type":"recv", "typeMessage":"peer_join"}
{"timestamp":1345816650244, "receiver":"peerDroid@10.0.2.XXX:50250", "byte":"70", "transaction":"successful", "RTT":"7", "type":"sent", "typeMessage":"peer_list"}
{"timestamp":1345816650244, "receiver":"peerDroid@10.178.51.XXX:50250", "byte":"70", "transaction":"failed", "RTT":"7", "type":"sent", "typeMessage":"peer_list"} 
```

如果我尝试在我的设备之间发送 ping，它会起作用，我会收到它们，这是不起作用的列表。

有谁知道为什么它不起作用？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T17:13:50.147

可能您应该为不同的设备使用不同的对等密钥，因此引导对等点会将您的所有设备视为不同的对等点。

您可以在方法中更改对等方的密钥`PeerActivity.init()`。

# android - 处理 DialogFragment 中的按钮点击

> ID：12112061
> 
> 赞同：11
> 
> 时间：2012-08-24T15:09:36.350
> 
> 标签：android, buttonclick, android-dialogfragment

我有扩展 DialogFragment 的片段，并且我有一个自定义布局，其中包含两个编辑文本和两个按钮 - 确定并取消。我的对话框显示得很好，使用 onCreateView 方法指定布局，但我不知道如何处理按钮点击。在 onCreateView 方法中，button.setOnClickListener 不起作用。这可能有一个简单的解决方案，但我被困了几个小时。我非常感谢您的建议或示例代码。

PS我不想使用AlertDialog，因为在这种情况下，当单击确定按钮时，对话框会自动关闭，并且我无法对edittext进行验证（例如：当用户按下确定按钮和edittext的是空的，我不希望对话框消失）。这就是我选择创建自定义对话框并轻松管理按钮行为的方式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T15:28:19.960

这是我正在使用的对话框的代码（对话框的实际 GUI 在布局资源 confirm_dialog.xml 中定义）：

```
public class ConfirmDialog extends DialogFragment {

    public static String TAG = "Confirm Dialog";

    public interface ConfirmDialogCompliant {
        public void doOkConfirmClick();
        public void doCancelConfirmClick();
    }

    private ConfirmDialogCompliant caller;
    private String message;

    public ConfirmDialog(ConfirmDialogCompliant caller, String message){
        super();
        this.caller = caller;
        this.message = message;
    }

    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        final View view = inflater.inflate(R.layout.confirm_dialog, container, false);
        getDialog().requestWindowFeature(Window.FEATURE_NO_TITLE);
        ((TextView) view.findViewById(R.id.textview_confirm)).setText(message);
        ((Button) view.findViewById(R.id.ok_confirm_button)).setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                // When button is clicked, call up to owning activity.
                caller.doOkConfirmClick();
            }
        });
        ((Button) view.findViewById(R.id.cancel_confirm_button)).setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                // When button is clicked, call up to owning activity.
                caller.doCancelConfirmClick();
            }
        });
        return view;
    }

} 
```

该对话框是使用以下几行创建的

```
confirm_dialog = new ConfirmDialog(this, message);
confirm_dialog.show(getActivity().getSupportFragmentManager(), ConfirmDialog.TAG); 
```

接口定义用于确保调用者（Fragment 或 Activity）实现处理控制器抛出的事件的方法。也就是说，调用此对话框的 Fragment 或 Activity 必须实现给定的接口。
也许有更好的解决方案，但这是我想出来的。希望能帮助到你！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-31T08:08:38.213

这是一个在 FragmentDialog 类中单击对话框的取消按钮的示例：

我使用了 android.support.v4.app.DialogFragment；

```
public class MyDialogFragment extends DialogFragment { 
    public MyDialogFragment(){}     
    public static String TAG = "info Dialog";
    Button btn;   
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        final View view = inflater.inflate(R.layout.info_layout, container);
        getDialog().requestWindowFeature(STYLE_NO_TITLE);
        btn=(Button)view.findViewById(R.id.close_dialog_btn_info_layout);
        btn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                getDialog().dismiss();
            }
        });

        return view;
    }

} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-24T15:12:39.830

沿着这些路线做

```
Dialog dl = mDialogFragment.getDialog();
Button btn = dl.findViewById(R.id.btn);
btn.setOnClickListener(this); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-11-16T05:25:19.753

另一种选择是让您的自定义`DialogFragment`类实现`OnClickListener`. 然后，您只需`setOnClickListener`针对您想要处理点击的任何视图并在`onClick`.

```
// 1\. implement OnClickListener
public class MyDialogFragment extends DialogFragment implements View.OnClickListener {

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {

        LayoutInflater inflater = getActivity().getLayoutInflater();
        View view = inflater.inflate(R.layout.my_dialog_layout, null);

        // 2\. set click listeners on desired views 
        view.findViewById(R.id.my_view_1).setOnClickListener(this);
        view.findViewById(R.id.my_view_2).setOnClickListener(this);

        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setView(view)
                // ...
        return builder.create();
    }   

    // 3\. capture the clicks and respond depending on which view
    @Override
    public void onClick(View view) {
        switch (view.getId()) {
            case R.id.my_view_1:
                // do something
                break;
            case R.id.my_view_2:
                // do something
                break;
            default:
                break;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-10T08:15:47.307

它在活动中很容易，但在 DialogFragment 中我们做了更多的代码。

在 DialogFragment 类里面做你的 rutin findView on`onActivityCreated`方法

```
btn_ocak = (Button) view.findViewById(R.id.btn_cal_ocak);
    btn_subat = (Button) view.findViewById(R.id.btn_cal_subat);
    btn_mart = (Button) view.findViewById(R.id.btn_cal_mart);
    btn_nisan = (Button) view.findViewById(R.id.btn_cal_nisan);

 btn_ocak.setOnClickListener(this);
    btn_subat.setOnClickListener(this);
    btn_mart.setOnClickListener(this);
    btn_nisan.setOnClickListener(this); 
```

将 onClick OnClickListener 实施到您的班级

```
public class CalendarPopUp extends DialogFragment implements View.OnClickListener 
```

并在 onClick 方法中执行您想要的操作，通过执行这些操作，我们激活了视图的 onClick 事件

```
 @Override
public void onClick(View view) {
    switch (view.getId()) {
        case R.id.btn_cal_ocak:
            seciliAy = "Ocak";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_subat:
            seciliAy = "Subat";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_mart:
            seciliAy = "Mart";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_nisan:
            seciliAy = "Nisan";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_mayis:
            seciliAy = "Mayıs";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_haziran:
            seciliAy = "Haziran";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_temmuz:
            seciliAy = "Temmuz";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_agustos:
            seciliAy = "Agustos";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_eylul:
            seciliAy = "Eylül";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_ekim:
            seciliAy = "Ekim";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_kasim:
            seciliAy = "Kasım";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        case R.id.btn_cal_aralik:
            seciliAy = "Aralık";
            setMonthOnShare(seciliAy);
            mCallback.onSelectedData(seciliAy);
            dismiss();
            break;
        default:
            break;
    }
} 
```

如果您想知道如何传递值，请按照这些步骤 [clike_here](https://stackoverflow.com/questions/34526866/return-values-from-dialogfragment)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-24T04:05:19.223

或者

```
class MyDialog extends DialogFragment {
   public View.OnClickListener onButtonOk;
   public EditText edit_text;

   @Override
   public Dialog onCreateDialog(Bundle savedInstanceState) {
       AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
       LayoutInflater li = LayoutInflater.from(builder.getContext());
       View view = li.inflate(R.layout.custom_dialog, null);
       Button buttonOK = view.findViewById(R.id.button_ok);
       edit_text = view.findViewById(R.id.edit_text);
       buttonOk.setOnClickListener(onButtonOk);
       builder.setView(view);

       return builder.create();
   }

}

// use
final MyDialog dialog=new MyDialog();
dialog.onButtonOk=new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Toast.makeText(v.getContext(), dialog.edit_text.getText(), Toast.LENGTH_SHORT).show();
    }
};
dialog.show(getSupportFragmentManager(),null); 
```

# php - 使用 SUM 选择语句

> ID：12112063
> 
> 赞同：-1
> 
> 时间：2012-08-24T15:09:36.870
> 
> 标签：php, sql

关于 SUM 的问题。

我有一张桌子

```
ID | JOBSITE | EMPLOYEE |  VENDOR  |  PRICE
---+---------+----------+----------+----------
1  |  Job1   |  CHris   | Vendor1  |  100.00
2  |  Job2   |  Matt    | Vendor1  |  100.00
3  |  Job3   |  Chris   | Vendor2  |  100.00 
```

仅从 Vendor1 查询所有内容效果很好。我用

```
Select * From table WHERE vendor="vendor1" 
```

它完美地显示了两行（实际上它更多，但这个示例将是两行）我想使用 SUM 语句，但似乎当我这样做时，我得到的只是显示一行，但总 SUM 效果很好. 我尝试了几种不同的方法，但我要么得到一个 SQL 错误，要么只显示一个这样的行

```
ID, JOBESITE, EMPLOYEE, VENDOR, PRICE, TOTALPRICE
1,  Job1,     Chris,    Vendor1, 100.00, 200.00 
```

总和有效，但不会显示与 Vendor1 相关的所有行。

知道如何使它工作吗？我试过

```
Select *, SUM(price) From table Where vendor="vendor1" 
```

这基本上就是我想要的。我意识到代码不起作用，当我让它起作用时，我只是得到带有正确总数的总价格列。或者我只有一个 id 行。添加了具有正确值的 Totalprice 列。但我想要的只是获取所有附加到特定供应商的行，然后基本上在第 1 行第 6 列。总价。所有的价格加起来

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T15:14:00.577

您需要使用聚合和`GROUP BY`

```
SELECT t1.id, 
   t1.jobsite, 
   t1.employee, 
   t1.vendor,
   t2.TotalPrice
FROM yourTable t1
INNER JOIN 
(
   SELECT SUM(price) TotalPrice, vendor
   FROM yourTable
   GROUP BY vendor
) t2
   ON t1.vendor = t2.vendor
WHERE t1.vendor = 'vendor 1' 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/864b8/1)

要获得结果，您需要使用 a`SUM()`和 a `GROUP BY`。既然您想要每个 的总数`vendor`，那么这就是您需要`GROUP BY`在该字段上的原因。A`GROUP BY`组合了所有彼此相等的值。

您需要使用子查询来获取，`totalprice`因为如果您将 a`SUM()`应用于所有记录，则不会得到正确的结果，因为每个记录的 id、jobsite、employee 都不同。

请参阅SQL Fiddle以及应用和不带子查询[的演示。](http://www.sqlfiddle.com/#!2/864b8/5)`SUM()``GROUP BY`

# curl - 使用 libcurl 模拟 curl

> ID：12112072
> 
> 赞同：0
> 
> 时间：2012-08-24T15:10:09.400
> 
> 标签：curl, libcurl

我正在尝试使用 libcurl 在 C 程序中模仿以下行 -

```
curl -d "HelloWorld" http://testserver/messaging/topic 
```

以上工作 - 我通过了我的信息。

基本上我想做的就是向 URL 发布一个简单的字符串。我有这个（取自一个例子）但它只是给了我 -

在

JBossWeb/2.0.1.GA - 错误报告

# HTTP 状态 405 -

**类型**状态报告

**信息**

**描述**请求的资源（）不允许指定的 HT TP 方法。

### JBossWeb/2.0.1.GA

出去

另外，我如何传递文本？- 通过将“？HelloWorld”附加到 URL？

```
#include "curl/curl.h"
void main(int argc,char **argv)
{
fprintf(stderr, "IN\n");
    CURL *curl;
    CURLcode res;

    curl = curl_easy_init();
    if (curl) {
            curl_easy_setopt(curl, CURLOPT_URL, "http://testserver/messaging/topic/");
            res = curl_easy_perform(curl);
            if (res != CURLE_OK) {
                    fprintf(stderr, "failed %s\n", curl_easy_strerror(res));
            }
            curl_easy_cleanup(curl);
    }
fprintf(stderr, "OUT\n");
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-23T10:54:55.727

-d 表示 POST 请求，因此您需要使用 curl_easy_setopt 进行设置

```
curl_easy_setopt(curl, CURLOPT_POSTFIELDS, "HelloWorld"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:01:51.443

将“--libcurl example.c”添加到命令行。然后将该代码构建到应用程序并运行它......

# javascript - 向具有唯一 ID 的表添加/删除行

> ID：12112082
> 
> 赞同：1
> 
> 时间：2012-08-24T15:10:34.370
> 
> 标签：javascript

这是我的 javascript 复制行和删除行

```
function cloneRow()
 {
         var row = document.getElementById("r1"); 
         var table = document.getElementById("t1"); 
         var clone = row.cloneNode(true); 
         clone.id = "newID";
         table.appendChild(clone); 
 }
 function removeRowFromTable()
 {
 var tbl = document.getElementById('div1');
 var lastRow = tbl.rows.length;
 if (lastRow > 1) tbl.deleteRow(lastRow - 1);
 } 
```

这是我的桌子：

```
 <table id="div1" style="display:none">
    <tbody id="t1">
    <tr id="r1"><td>
<form:input path="hostname" value="hostname" onfocus="if(this.value == 'hostname'){this.value =''}" onblur="if(this.value == ''){this.value ='hostname'}" size="30" maxlength="30"/>
<form:input path="directory" value="directory" onfocus="if(this.value == 'directory'){this.value =''}" onblur="if(this.value == ''){this.value ='directory'}" size="15" maxlength="15"/>
<form:input path="username" value="username" onfocus="if(this.value == 'username'){this.value =''}" onblur="if(this.value == ''){this.value ='username'}" size="15" maxlength="15"/>
<form:input path="password" value="password" onfocus="if(this.value == 'password'){this.value =''}" onblur="if(this.value == ''){this.value ='password'}" size="15" maxlength="15"/></td></tr>
    </tbody>
<input type="button" onclick="cloneRow()" value="+" />
<input type="button" onclick="removeRowFromTable();" value="-" />
    </table> 
```

代码正在动态添加或删除行..但是，我怎么知道它们是使用唯一 ID 创建的..我需要稍后将值保存到数据库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:15:06.233

使用带有局部变量的闭包：

```
var cloneRow = (function()
{
    var id_num = 0;

    return function ()
    {
        var row = document.getElementById("r1"); 
        var table = document.getElementById("t1"); 
        var clone = row.cloneNode(true); 

        clone.id = "newID" + id_num++;
        table.appendChild(clone); 
    };
}()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:27:33.930

您还可以使用 jquery 来获取最后一个 id（前提是您的行按升序分配了 id），然后根据该值递增

```
 var highestId = parseInt($("tr:last").attr("id"));
 clone.id = ++highestId ; 
```

# azure - 如果我对 FileStream 的理解正确，则正确

> ID：12112088
> 
> 赞同：1
> 
> 时间：2012-08-24T15:10:53.963
> 
> 标签：azure, stream, blob

当我尝试从高清读取文件时

```
FileInfo fi = new FileInfo(ofd.FileName);
if (fi.Exists)
    FileStream stream = fi.Open(FileMode.Open, FileAccess.Read); 
```

当我检查我的 stream.Position 和 stream.Length 时，它们都是相同的。一般来说，我希望 stream.Position 应该为零。由于我还没有阅读流中的内容。

但我可以看到 stream.Position 在流中有最后一个位置。由于位置和长度之间没有区别，因此当我尝试使用 UploadFromStream(stream) 将文件上传到 BLOB 时，它失败了。当然，我有另一种解决方法来使代码正常工作。但我是关于上述问题，为什么我必须重置位置才能将文件上传到 BLOB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T01:03:25.050

默认的 FileStream 行为是 stream.position 将设置为 0 除非您已阅读内容。如果您只是将代码仅用于测试，您将看到 stream.position 设置为 0，但 stream.length = 0xLENGTH。我刚刚测试了您的代码，如下所示，我可以看到完全相同的结果。

```
 string filename = @"c:\2012\Procmon.exe";
 FileInfo fi = new FileInfo(filename);
 FileStream stream = fi.Open(FileMode.Open, FileAccess.Read); 
```

当您将流作为参数传递给函数时，我遇到过类似的事件，在这种情况下，流位置一直设置为流长度，这与您的情况非常相似。这个[SO 讨论讨论](https://stackoverflow.com/questions/10891857/cloudblob-downloadtostream-returns-null/10892587#10892587)了与您类似的情况。

# java - 允许本机代码直接访问java堆中的对象？

> ID：12112090
> 
> 赞同：0
> 
> 时间：2012-08-24T15:10:58.283
> 
> 标签：java, c, java-native-interface, jna, native-code

我在 Java 中有一个对象数组，我想允许本机 C 代码直接访问该数组（没有复制或访问器函数）。这可能吗？我不介意解决方案是否特定于 JVM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:17:14.437

当然，使用 JNI 是可能的。

值得咨询此链接：http: [//journals.ecs.soton.ac.uk/java/tutorial/native1.1/implementing/array.html](http://journals.ecs.soton.ac.uk/java/tutorial/native1.1/implementing/array.html) 简而言之 -

```
#include <jni.h>
#include "IntArray.h"

JNIEXPORT jint JNICALL 
Java_IntArray_sumArray(JNIEnv *env, jobject obj, jintArray arr)
{
  jsize len = (*env)->GetArrayLength(env, arr);
  int i, sum = 0;
  jint *body = (*env)->GetIntArrayElements(env, arr, 0);
  for (i=0; i<len; i++)
    sum += body[i];
  (*env)->ReleaseIntArrayElements(env, arr, body, 0);
  return sum;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:22:11.253

如果您使用较新版本的 java，请使用[ByteBuffer](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/ByteBuffer.html)对象。

调用`ByteBuffer.allocateDirect()`分配缓冲区。直接缓冲区位于垃圾收集器的域之外。要从 JNI 访问缓冲区，请调用[`GetDirectBufferAddress()`](http://docs.oracle.com/javase/1.4.2/docs/guide/jni/jni-14.html#GetDirectBufferAddress). 它返回一个指向字节缓冲区的指针。这不会在引擎盖下进行复制。缓冲区的更改将在 Java 和 Native 端看到。

javadocs 有一些关于使用直接缓冲区的警告：

> 可以通过调用此类的 allocateDirect 工厂方法来创建直接字节缓冲区。此方法返回的缓冲区通常比非直接缓冲区具有更高的分配和释放成本。直接缓冲区的内容可能驻留在正常的垃圾收集堆之外，因此它们对应用程序内存占用的影响可能并不明显。因此，建议将直接缓冲区主要分配给受底层系统的本机 I/O 操作影响的大型、长期存在的缓冲区。通常，最好仅在直接缓冲区对程序性能产生可测量的增益时才分配它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T09:07:50.653

我终于找到了答案。通常不可能用 JNI 做我想做的事。但是，一些虚拟机提供了所需的功能，我使用了 JikesRVM：

1）本机代码需要数组的内存位置。这可以使用 JikesRVM 中的“Magic”工具来实现，它提供了一个 ObjectReference 和一个 Address 类，允许获取每个对象的内存地址。然后可以将该地址作为 long/int 参数（使用 JNI）转发到本机代码，并在那里转换为指针。

2) GC 可能不会移动对象。这有点棘手，因为它需要在 GC 中支持 pinning。在 JikesRVM 的情况下，可以使用 @NonMoving 和 @NonMovingAllocation 注释对象（也是“魔术”的一部分）。此外，大于 8KB 的对象（即数组）被放置在大对象空间中，不会移动对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-10T12:11:37.050

以上所有问题，有一个很好的解决方案（点击下面的链接）：

[获取直接缓冲区地址](https://stackoverflow.com/questions/17707653/how-do-i-call-multiple-data-types-from-getdirectbufferaddress-in-jni)

如果您有一个对象而不是原始数组，您可以找到如何提供直接访问。

# c - 如何指定在支持 2 个不同设备的驱动程序中打开哪个设备？

> ID：12112091
> 
> 赞同：0
> 
> 时间：2012-08-24T15:10:58.160
> 
> 标签：c, linux, driver

我有一个驱动程序支持多个不相同但相似的设备。我这样做是为了在为设备编写应用程序时可以使用相同的库 API。

有没有办法指定在应用程序中使用哪个特定设备？

是否可以在 open 调用之前进行 ioctl 调用，以便设置下次调用 open 时使用哪个特定设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:19:56.810

处理此问题的常用方法是`/dev/`为每个设备设置一个单独的设备节点，并让您的驱动程序提供一个`ioctl()`返回相应设备的标识信息（例如供应商、型号和序列号）的设备节点。这将允许用户空间应用程序区分不同的设备。根据您的确切需求，`sysfs`( `/sys`) 中的一些随附条目也可能有意义。

您可能想查看一些常见的现有 API 以获得想法。例如，[V4L2](http://linuxtv.org/downloads/v4l-dvb-apis/v4l2spec.html) API 包含[VIDIOC_QUERYCAP ioctl()](http://linuxtv.org/downloads/v4l-dvb-apis/vidioc-querycap.html)，它为应用程序提供了足够的信息来区分离散设备。

# c# - 使用 TcpClient 向服务器发送请求

> ID：12112095
> 
> 赞同：1
> 
> 时间：2012-08-24T15:11:36.913
> 
> 标签：c#, http, webserver, tcpclient

我问这个问题主要是因为我没有明确的想法。我相信我了解网络服务器的工作原理，但由于某种原因，我得到的结果与预期不同。

**所以基本上我想用代码复制我用真正的网络浏览器所做的事情。**

我有一个名为 Fiddler 的程序，它充当代理，以查看来自 Web 服务器的所有请求和响应。

**1.所以当我打开我的兄弟然后转到`http://10.10.10.28/tfs:8080`这就是显示的内容：**

--------![在此处输入图像描述](../Images/5acb1b6e9308706b6cf5e6a789900f47.png)

. . . . 这就是提琴手记录的内容：

![在此处输入图像描述](../Images/4ba788199ea9f1e229777d975ba40437.png)

当我单击取消或尝试登录时，将发出其他请求，提琴手将记录更多数据。我不在乎这个权利，我只对模拟第一个请求感兴趣。

无论如何，提琴手告诉我们标题是：

```
GET http://10.10.10.28/tfs:8080 HTTP/1.1
Host: 10.10.10.28
Connection: keep-alive
Cache-Control: max-age=0
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.83 Safari/537.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

回应是：

```
HTTP/1.1 401 Unauthorized
Server: Microsoft-IIS/7.5
WWW-Authenticate: Negotiate
WWW-Authenticate: NTLM
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 12.0.0.6421
Date: Fri, 24 Aug 2012 14:36:22 GMT
Content-Length: 0
Proxy-Support: Session-Based-Authentication 
```

**2\. 终于到了有趣的代码部分**现在我想发送相同的标头并期望得到相同的响应。**由于某种原因，我得到了不同的回应！**

```
public static void Main(string[] args)
{
    // I save the header bytes recorded from fiddler on a file to make sure I am sending the exact same request
    byte[] header = System.IO.File.ReadAllBytes(@"C:\Users\Antonio\Desktop\header");

    // create the client
    TcpClient client = new TcpClient("10.10.10.28", 8080);

    // get the stream so that we can read and write to it
    var stream = client.GetStream();

    // now that we have the stream wait for the server to respond
    WaitForResponse(stream); // waits on a separate thread

    // send the request to the header
    stream.Write(header, 0, header.Length);

    // wait
    Console.Read();
}

public static void WaitForResponse(NetworkStream stream)
{
    Task.Factory.StartNew(() => {
        byte[] buffer = new byte[16384];
        int responseLength = stream.Read(buffer, 0, buffer.Length);
        string resp = System.Text.UTF8Encoding.UTF8.GetString(buffer, 0, responseLength);
        resp = resp; // place breakpoint
    });
    System.Threading.Thread.Sleep(10); // make sure task starts
} 
```

这是我得到的回应： ![在此处输入图像描述](../Images/9de8a5468bbe68ce03610a20a1c8acb6.png)

**为什么我得到不同的响应？**我相信 Web 服务器使用 tcp 连接将页面发送到客户端。为什么我采用的这种方法不起作用？另外**，当我从代码向网络服务器发送请求时，为什么提琴手没有记录任何内容？**谷歌浏览器如何连接到网络服务器？我敢打赌，chrome 浏览器也正在与 Web 服务器建立 tcp 连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:21:07.250

您正在连接到不同的服务器（端口 8080 与端口 80）。

此外，来自提琴手的请求看起来不正确。GET 没有指定方法或主机名。也许这些数据已经过处理以使其看起来更友好？

我希望请求的第一行看起来更像`GET /tfs:8080 HTTP/1.1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:21:40.603

在您的示例中，您连接到端口 8080 并请求 URL `http://10.10.10.28/tfs:8080`。因此，您连接到端口 8080，然后从端口 80 请求某些内容。这会导致`Bad Request`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:21:43.070

您试图在没有先写请求的情况下读取流，这就是问题所在。

为什么不使用 HttpWebRequest 而不是 TcpClient？

# perl - DBI connect no pg_hba.conf entry for host "host_ip", user "username", database "databasename", SSL off

> ID：12112096
> 
> 赞同：1
> 
> 时间：2012-08-24T15:11:38.353
> 
> 标签：perl, database-connection, dbi

我在服务器端的 pg_hba.conf 中添加了这一行：

```
host     all         all    host_ip             md5 
```

但我仍然收到错误

> DBI connect('database=databasename;host=server_host_ip','username',...) failed: FATAL: no pg_hba.conf entry for host "host_ip", user "username", database "databasename", SSL off at / usr/local/share/perl/5.10.1/DBIx/DataStore.pm 第 1983 行。
> [2012 年 8 月 24 日星期五 11:01:03] /usr/local/share/perl/5.10.1/DBIx/DataStore.pm， 1029：验证与主数据库的连接失败！
> 死于 /usr/local/share/perl/5.10.1/DBIx/DataStore.pm 第 1029 行。`

我错过了什么？

更新
perl merge_infos.pl

```
DBI connect('database=diamas;host=67.23.10.243','dia',...) failed: FATAL:  no pg_hba.conf entry for host "38.104.59.18", user "dia", database "diamas", SSL off at /usr/local/share/perl/5.10.1/DBIx/DataStore.pm line 1983\. 
```

pg_hba.conf（远程服务器）

```
host    all         all         38.104.59.18/32       trust 
```

调用（本地机器）
（在脚本中）merge_infos.pl

```
use DBIx::DataStore ( config => 'yaml' );
my $olddb = DBIx::DataStore->new('www'); 
```

数据存储.yml

```
www:
primary:
driver: Pg
database: diamas
user: dia
password: ***
host: 67.23.10.243
schemas:
  - public 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:09:45.927

我编辑了错误的 pg_hba.conf 文件

# javascript - 检测时间 显示

> ID：12112098
> 
> 赞同：1
> 
> 时间：2012-08-24T15:11:49.503
> 
> 标签：javascript, jquery, jqtouch

我的代码中有 4`<div>`秒。我使用 JavaScript 来显示和隐藏它们。现在它变得越来越难以管理，因此我需要检测一个特定`<div>`的是否显示或隐藏。我不确定如何做到这一点，用哪种方式编码？JQuery 或 Jqtouch 都可以。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:22:42.133

如果您可以使用 jQuery 来帮助您，您可以使用：

```
$( "yourDivSelector" ).is( ":visible" ); 
```

没有 jQuery，你可以这样做：

```
alert( isVisible( "divOne" ) );
alert( isVisible( "divTwo" ) );
alert( isVisible( "divThree" ) );

function isVisible( elementId ) {
    var element = document.getElementById( elementId );
    return window.getComputedStyle( element, null ).display != "none";
} 
```

jsFiddle：http: [//jsfiddle.net/davidbuzatto/N3wf6/](http://jsfiddle.net/davidbuzatto/N3wf6/)

更多关于`window.getComputedStyle`这里：[https ://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T15:34:10.490

这个功能似乎做你想做的事。它检查不显示和隐藏可见性。

[JavaScript 函数检查 DOM 元素的可见性](http://www.dzone.com/snippets/javascript-function-checks-dom)

```
function isVisible(obj)
{
    if (obj == document) return true

    if (!obj) return false
    if (!obj.parentNode) return false
    if (obj.style) {
        if (obj.style.display == 'none') return false
        if (obj.style.visibility == 'hidden') return false
    }

    //Try the computed style in a standard way
    if (window.getComputedStyle) {
        var style = window.getComputedStyle(obj, "")
        if (style.display == 'none') return false
        if (style.visibility == 'hidden') return false
    }

    //Or get the computed style using IE's silly proprietary way
    var style = obj.currentStyle
    if (style) {
        if (style['display'] == 'none') return false
        if (style['visibility'] == 'hidden') return false
    }

    return isVisible(obj.parentNode)
} 
```

示例用法

```
if (isVisible(document.getElementById("myelement"))) {
    // Element is visible.
} 
```

[演示](http://jsbin.com/enajif/2/edit)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T15:24:52.687

因为我不确定 100% 你在做什么隐藏/显示......

但是如果您设置一个属性，例如显示

然后..

```
function elementhidden()
{
    1\. Get your element
    2\. Check the elemnet atrribute status
    3\. If its hide value then return true
    4\. If its show value then return false

} 
```

提供一个你在做什么的例子，这样我就可以编写代码了..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:26:41.123

您可以使用[document.elementFromPoint(x, y)](https://developer.mozilla.org/fr/docs/DOM/document.elementFromPoint)作为 x 和 y 传递 div 的位置并检查它是否是好对象。

这假设没有其他元素覆盖 div 的左上角。

这可能取决于您所说的“可见”：“完全可见”？“至少有点可见”？由于滚动位置而不可见的视口部分怎么办？如果浏览器窗口部分位于屏幕之外（这可能很棘手）？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-24T15:27:27.030

取决于 div 的隐藏方式，但您可以使用

```
if(document.getElementById("myDiv").style.display=="none"){
    //do something
} 
```

# android - Proguard 破坏 Android WebView，为什么？

> ID：12112102
> 
> 赞同：8
> 
> 时间：2012-08-24T15:12:06.093
> 
> 标签：android, webview, proguard

我的活动中有一个 WebView，使用 Proguard 进行混淆似乎破坏了我的 WebView，我不明白为什么。

代码很简单，我的 res/raw 目录中有 HTML 文件，这是调试时可以正常加载的代码。

```
WebView mv = (WebView)findViewById(R.id.webView1);
mv.loadUrl("file:///android_res/raw/wesite.html"); 
```

一旦我创建了要发布的apk，通过proguard运行它就不起作用了，我只是得到了无法加载的页面。

我还没有在 proguard 配置文件中添加任何内容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-24T15:31:15.330

Proguard 会混淆目录，因此如果您正在寻找 android_res/raw 它可能不再被称为！

您可以向项目中的 proguard.cfg 文件添加规则，使其跳过某些文件。但在这种情况下，将原始资源移动到 assets 文件夹就可以了。

问题是 Webkit FileLoader 将尝试使用反射加载您的 R$drawable 类。如果您不向 proguard.cfg 文件添加任何保留规则，该类将被重命名，因此 Webkit 将无法加载您的资源。（取自[Prevent Proguard 以删除特定的可绘制对象](https://stackoverflow.com/questions/6280188/prevent-proguard-to-remove-specific-drawables)）。

这就是为什么 Android 使用 R 类命名系统来命名资源 - 一个唯一的查找 id，而不是通过文件的位置来引用文件

通过将文件放入 assets 文件夹中，您将绕过 R 类引用系统，并且一切正常。

您应该将您的 website.html 文件移动到 assets 文件夹并调用：

```
mv.loadUrl("file:///android_asset/wesite.html"); 
```

正如上面链接所建议的那样，应该可以将以下规则添加到您的 Proguard.cfg 文件中，以阻止资源位置被混淆：

```
-keepclassmembers class **.R$* {
    public static <fields>;
}

-keep class **.R$* 
```

请记住，混淆的工作方式是有原因的！

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-24T09:24:37.253

只是为了澄清资产与资产的辩论。根据谷歌文档（见下文），项目目录中的文件夹应称为“assets”，而要访问它们，您必须使用“file:///android_asset/”

> 资产/这是空的。您可以使用它来存储原始资产文件。您在此处保存的文件将按原样编译为 .apk 文件，并保留原始文件名。您可以使用 URI 以与典型文件系统相同的方式导航此目录，并使用 AssetManager 将文件作为字节流读取。例如，这是放置纹理和游戏数据的好位置。

请注意，我无法添加任何评论，这就是我将其发布为答案的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-27T19:26:21.997

只是在被最近的一个问题引导到这篇文章之后更新。

在 Android Studio（至少 1.0.1）中，如果您将资产或资源用于媒体，则发布版本中提供的默认混淆级别没有区别。`android_res/raw`或`android_asset`。他们仍然被称为那个。

我在两个版本上都运行了 apktool，被最新的、使用的`android_res/raw`、更大的吓到了。大小完全是由我的媒体造成的。两者都几乎没有被混淆，与应用商店上的其他 apk 一致。资源和 xml 都没有被混淆。对这些进行逆向工程的唯一困难是将baksmali转换为Java。我见过其他的 apk 被更好地混淆了，但我的保留了我给它们的原始类名，尽管它被分成了几个部分。

我是 pro-guard 的新手，更喜欢 C++，但据我了解，它默认应用于发布版本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-24T15:20:54.933

在 webview 中加载 raw 文件夹的文件：

```
myWebView.loadUrl("file:///android_assets/myfile.html"); 
```

# c# - 在“ISession.Refresh”上，NHibernate 为会话缓存上的同一数据库记录生成两个实例。为什么以及如何解决它？

> ID：12112103
> 
> 赞同：0
> 
> 时间：2012-08-24T15:12:08.597
> 
> 标签：c#, nhibernate, orm

NHibernate在`ISession.Refresh`会话缓存上为同一数据库记录生成两个实例。

**为什么？**

该问题似乎与使用“KeyReference”（“key-many-to-one”）的“Composite Id”有关。这种情况发生在 NHibernate 的“2.1.2.4000”和“3.2.0.4000”版本中。

**如何在不放弃“复合 id”的情况下解决这个问题？**

以下测试应该通过，但它没有：

```
/// <summary>
/// Test for <see cref="ISession.Refresh(object)"/>. After a call to 
/// <c>Refresh()</c>On 'ISession.Refresh' NHibernate GENERATES two 
/// instances for the the same database record on the Session Cache. WHY?.
/// The problem seems to be related to 'Composit Id' using 'KeyReference'.
/// ('key-many-to-one'). The situation occurs in versions '2.1.2.4000' and 
/// '3.2.0.4000' of NHibernate. This test should pass, but does not pass!
/// <para>There is another test (<see cref="SofPOC.Questions.NHRefresh.NHRefreshTest"/>) 
/// that makes the 'Refresh' in several scenarios where this problem does 
/// not occur.
/// </para>
/// </summary>
/// <remarks>
/// Tables:
/// <code>
/// MasterCategory:
/// Id|Description
/// --+-----------
/// 1 |Cat_1      
/// 2 |Cat_2      
/// 
/// Master:
/// IdA|IdB|Description  |MasterCategoryId
/// ---+---+-------------+----------------
/// 1  |1  |MASTER_DESC_1|1               
/// 2  |2  |MASTER_DESC_2|2               
/// 
/// Detail:
/// MasterIdA|MasterIdB|SubId|Description    
/// ---------+---------+-----+---------------
/// 1        |1        |1    |DETAIL_DESC_1_1
/// 1        |1        |2    |DETAIL_DESC_1_2
/// 1        |1        |3    |DETAIL_DESC_1_3
/// 2        |2        |4    |DETAIL_DESC_2_1
/// 2        |2        |5    |DETAIL_DESC_2_2        
/// </code>
/// </remarks>
[TestFixture]
public class NHRefreshCpIdTest
{
    private static readonly ILog LOG = LogManager.GetLogger(typeof(NHRefreshCpIdTest));

    public ISessionFactory SessionFactory { get; set; }

    [TestFixtureSetUp]
    public void TestFixtureSetUp()
    {
        File.Copy("./Questions/NHRefreshCpId/NHRefreshCpIdTest.db", "./Questions/NHRefreshCpId/NHRefreshCpIdTestEdited.db", true);

        Configuration config = new Configuration();
        config.Properties[NHibernate.Cfg.Environment.ConnectionProvider] = "NHibernate.Connection.DriverConnectionProvider";
        config.Properties[NHibernate.Cfg.Environment.ConnectionDriver] = "NHibernate.Driver.SQLite20Driver";
        config.Properties[NHibernate.Cfg.Environment.ConnectionString] = "Data Source=|DataDirectory|./Questions/NHRefreshCpId/NHRefreshCpIdTestEdited.db;Version=3;FailIfMissing=True;";
        config.Properties[NHibernate.Cfg.Environment.Dialect] = "NHibernate.Dialect.SQLiteDialect";
        //config.Properties[NHibernate.Cfg.Environment.By]
        config.Properties[NHibernate.Cfg.Environment.ShowSql] = "true";
        config.Properties[NHibernate.Cfg.Environment.FormatSql] = "true";
        FluentConfiguration fConfigure = Fluently.Configure(config);
#if NH2
        config.Properties[NHibernate.Cfg.Environment.ProxyFactoryFactoryClass] = "NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle";
#endif
        fConfigure.Mappings(m =>
            m.FluentMappings.Add(typeof(MasterCategoryEntMap)));
        fConfigure.Mappings(m =>
            m.FluentMappings.Add(typeof(MasterEntMap)));
        fConfigure.Mappings(m =>
            m.FluentMappings.Add(typeof(DetailEntMap)));
        config = fConfigure.BuildConfiguration();

        this.SessionFactory = config.BuildSessionFactory();
    }

    [Test]
    public void Test()
    {
        ISession ss = null;

        #region teste
        ss = this.SessionFactory.OpenSession();
        try
        {
            MasterEnt master1BeforeRefresh = ss.Get<MasterEnt>(new MasterCpId(1, 1));
            MasterEnt master2BeforeRefresh = ss.Get<MasterEnt>(new MasterCpId(2, 2));
            MasterCategoryEnt masterCat1BeforeRefresh = master1BeforeRefresh.MasterCategory;
            MasterCategoryEnt masterCat2BeforeRefresh = ss.Get<MasterCategoryEnt>(2);

            #region persist data using NHibernate
            ITransaction tx = ss.BeginTransaction();
            ss.Flush();
            tx.Commit();
            #endregion

            #region change data out of NHibernate
            IDbCommand command = ss.Connection.CreateCommand();
            command.CommandText = "UPDATE Master SET MasterCategoryId = 2 WHERE IdA = 1 and IdB = 1";
            IDbTransaction dbTx = ss.Connection.BeginTransaction();
            command.ExecuteNonQuery();
            dbTx.Commit();
            #endregion

            LOG.Debug("JUST BEFORE 'Refresh'");

            ss.Refresh(master1BeforeRefresh);
            MasterEnt master1AfterRefresh = ss.Get<MasterEnt>(new MasterCpId(1, 1));
            DetailEnt detail4AfterRefresh = ss.Get<DetailEnt>(new DetailCpId(master1AfterRefresh, 4));
            MasterCategoryEnt masterCat1AfterRefresh = ss.Get<MasterCategoryEnt>(1);
            MasterCategoryEnt masterCat2AfterRefresh = master1AfterRefresh.MasterCategory;

            //Here is the test
            Assert.AreEqual(1, masterCat1BeforeRefresh.Id);
            Assert.AreEqual(1, masterCat1AfterRefresh.Id);
            Assert.AreEqual(2, masterCat2BeforeRefresh.Id);
            Assert.AreEqual(2, masterCat2AfterRefresh.Id);
            Assert.AreSame(master1BeforeRefresh, master1AfterRefresh);
            Assert.AreSame(masterCat1BeforeRefresh, masterCat1AfterRefresh);
            Assert.AreSame(masterCat2BeforeRefresh, masterCat2AfterRefresh);
        }
        finally
        {
            ss.Close();
        }
        #endregion
    }
} 
```

我正在使用：

*   NHibernate 2.1.2
*   NHibernate 3.2.0
*   System.Data.SQLite 1.0.80.0

完整的源代码在这里：[NHibernateRefresh.7z](https://dl.dropbox.com/u/49510149/stackoverflow/dotnet/NHibernateRefresh.7z)

**笔记：**

*   在打开解决方案（“.\Src\SofPOC.2010.sln”）之前，运行“.\Dependencies\setup.bat”来加载依赖项。
*   有关依赖项的说明，请参阅“.\readme.txt”和“.\dependencies\readme.txt”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T21:38:32.727

**原因：**

在为“父”调用“DefaultRefreshEventListener.OnRefresh”时，在“父”和“子”之间发生“带连接加载”，首先加载“子”，然后再加载“父”，但此时暂时从会话中删除“父级”的那一刻，“子级”通过代理引用“父级”。尽管“parent1BeforeRefresh”和“parent1AfterRefresh”是不同的实例，但“parent1AfterRefresh”是指向“parent1BeforeRefresh”的代理。'child1BeforeRefresh' 和 'child1AfterRefresh' 中的问题更为严重，因为这些实例完全不相关，并且都在会话缓存中。

**溶液** [（NH-3253）](https://nhibernate.jira.com/browse/NH-3253)**：**

如果[NH-3253](https://nhibernate.jira.com/browse/NH-3253)尚未被接受和修复，`DefaultRefreshEventListener`请自行替换：

2.1.x 版：

```
/// <summary> 
/// Defines the default refresh event listener used by hibernate for refreshing entities
/// in response to generated refresh events. 
/// </summary>
[Serializable]
public class DefaultRefreshEventListener : IRefreshEventListener
{
    private static readonly ILog log = LogManager.GetLogger(typeof(DefaultRefreshEventListener));

    public virtual void OnRefresh(RefreshEvent @event)
    {
        OnRefresh(@event, IdentityMap.Instantiate(10));
    }

    public virtual void OnRefresh(RefreshEvent @event, IDictionary refreshedAlready)
    {
        IEventSource source = @event.Session;

        if (source.PersistenceContext.ReassociateIfUninitializedProxy(@event.Entity))
            return;

        object obj = source.PersistenceContext.UnproxyAndReassociate(@event.Entity);

        if (refreshedAlready.Contains(obj))
        {
            log.Debug("already refreshed");
            return;
        }

        EntityEntry e = source.PersistenceContext.GetEntry(obj);
        IEntityPersister persister;
        object id;

        if (e == null)
        {
            persister = source.GetEntityPersister(null, obj); //refresh() does not pass an entityName
            id = persister.GetIdentifier(obj, source.EntityMode);
            if (log.IsDebugEnabled)
            {
                log.Debug("refreshing transient " + MessageHelper.InfoString(persister, id, source.Factory));
            }
            EntityKey key = new EntityKey(id, persister, source.EntityMode);
            if (source.PersistenceContext.GetEntry(key) != null)
            {
                throw new PersistentObjectException("attempted to refresh transient instance when persistent instance was already associated with the Session: " + 
                    MessageHelper.InfoString(persister, id, source.Factory));
            }
        }
        else
        {
            if (log.IsDebugEnabled)
            {
                log.Debug("refreshing " + MessageHelper.InfoString(e.Persister, e.Id, source.Factory));
            }
            if (!e.ExistsInDatabase)
            {
                throw new HibernateException("this instance does not yet exist as a row in the database");
            }

            persister = e.Persister;
            id = e.Id;
        }

        // cascade the refresh prior to refreshing this entity
        refreshedAlready[obj] = obj;
        new Cascade(CascadingAction.Refresh, CascadePoint.BeforeRefresh, source).CascadeOn(persister, obj, refreshedAlready);

        if (e != null)
        {
            EntityKey key = new EntityKey(id, persister, source.EntityMode);
            source.PersistenceContext.RemoveEntity(key);
            if (persister.HasCollections)
                new EvictVisitor(source).Process(obj, persister);
        }

        if (persister.HasCache)
        {
            CacheKey ck = new CacheKey(id, persister.IdentifierType, persister.RootEntityName, source.EntityMode, source.Factory);
            persister.Cache.Remove(ck);
        }

        EvictCachedCollections(persister, id, source.Factory);

        // NH Different behavior : NH-1601
        // At this point the entity need the real refresh, all elementes of collections are Refreshed,
        // the collection state was evicted, but the PersistentCollection (in the entity state)
        // is associated with a possible previous session.
        new WrapVisitor(source).Process(obj, persister);

        // NH-3253: Forcing simple load to prevent the redundante instance 
        //on session:
        //Ocurre when:
        // -there is a 'one-to-many' 'Parent-Child' relationship;
        // -AND the 'Parent' 'many-to-one' association is ' fetch="select" ';
        // -AND 'Child' is using a 'composite-id' and 'key-many-to-one' to the
        //'Parent'.
        object result;
        if (this.IsReferencedByCompositeId(persister))
            result = persister.Load(id, obj, @event.LockMode, source);

        string previousFetchProfile = source.FetchProfile;
        source.FetchProfile = "refresh";
        result = persister.Load(id, obj, @event.LockMode, source);
        source.FetchProfile = previousFetchProfile;

        // NH Different behavior : we are ignoring transient entities without throw any kind of exception 
        // because a transient entity is "self refreshed"
        if (!ForeignKeys.IsTransient(persister.EntityName, obj, result == null, @event.Session))
            UnresolvableObjectException.ThrowIfNull(result, id, persister.EntityName);
    }

    private Dictionary<EntityMetamodel, bool> IsReferencedByCompositeIdCache = new Dictionary<EntityMetamodel, bool>();
    /// <summary>
    /// Returns <c>true</c> if the entity in <paramref name="persister"/> 
    /// ('root') has a direct or indirect association with another 
    /// entity that is associated back to 'root' through a 'composit-id' and 
    /// 'key-many-to-one'.
    /// </summary>
    /// <param name="persister"></param>
    /// <returns></returns>
    private bool IsReferencedByCompositeId(IEntityPersister persister)
    {
        try
        {
            bool result = false;
            if (IsReferencedByCompositeIdCache.ContainsKey(persister.EntityMetamodel))
            {
                result = this.IsReferencedByCompositeIdCache[persister.EntityMetamodel];
            }
            else
            {
                EntityMetamodel em =
                    this.GetReferrerByCompositeId(
                        persister.EntityMetamodel,
                        persister.EntityMetamodel,
                        false,
                        new Iesi.Collections.Generic.HashedSet<EntityMetamodel>());
                if (em == null)
                    result = false;
                else
                    result = true;

                lock (this)
                {
                    this.IsReferencedByCompositeIdCache[persister.EntityMetamodel] = result;
                }
            }

            return result;
        }
        catch (Exception ex)
        {
            log.Error("Unespected ERROR!", ex);
            throw;
        }
    }

    /// <summary>
    /// Recursive Helper for <see cref="IsReferencedByCompositeId(IEntityPersister)"/>.
    /// </summary>
    /// <param name="rootEM"></param>
    /// <param name="nestedEM"></param>
    /// <param name="neestedIsCompositeId"></param>
    /// <param name="visitedList"></param>
    /// <returns></returns>
    private EntityMetamodel GetReferrerByCompositeId(
        EntityMetamodel rootEM,
        EntityMetamodel nestedEM,
        bool neestedIsCompositeId,
        ICollection<EntityMetamodel> visitedList)
    {
        EntityMetamodel emResult = null;

        if (visitedList.Contains(nestedEM))
        {
            return emResult;
        }
        else
        {
            visitedList.Add(nestedEM);

            ISessionFactoryImplementor sessionImplementor = rootEM.SessionFactory;

            if (nestedEM.IdentifierProperty.Type is IAbstractComponentType)
            {
                IAbstractComponentType componentType = (IAbstractComponentType)nestedEM.IdentifierProperty.Type;
                for (int i = 0; i < componentType.Subtypes.Length; i++)
                {
                    IType subType = componentType.Subtypes[i];
                    if (!subType.IsAnyType
                        && subType.IsAssociationType
                        && subType is IAssociationType)
                    {
                        IAssociationType associationType = (IAssociationType)subType;
                        string associatedEntityName = null;
                        try
                        {
                            //for 'Collection Types', sometimes 'Element Type' is not an 'Entity Type'
                            associatedEntityName = associationType.GetAssociatedEntityName(sessionImplementor);
                        }
                        catch (MappingException me)
                        {
                            //I think it will never happen because a 
                            //"Composit Id" can not have a property that 
                            //uses 'NHibernate.Type.CollectionType'. 
                            //But just in case ...
                            if (log.IsDebugEnabled)
                                log.Debug("Can not perform 'GetAssociatedEntityName'. " +
                                    "Considering it is not an entity type: '" +
                                    nestedEM.IdentifierProperty.Name + "." +
                                    componentType.PropertyNames[i] + "'"
                                    , me);
                        }
                        if (associatedEntityName != null)
                        {
                            IEntityPersister persisterNextNested = sessionImplementor.GetEntityPersister(associatedEntityName);
                            if (rootEM == persisterNextNested.EntityMetamodel)
                            {
                                emResult = nestedEM;
                                return emResult;
                            }
                            else
                            {
                                emResult = this.GetReferrerByCompositeId(
                                    rootEM,
                                    persisterNextNested.EntityMetamodel,
                                    true,
                                    visitedList);

                                if (emResult != null)
                                    return emResult;
                            }
                        }
                    }
                }
            }
            for (int i = 0; i < nestedEM.Properties.Length; i++)
            {
                StandardProperty property = nestedEM.Properties[i];

                if (!property.Type.IsAnyType
                    && property.Type.IsAssociationType
                    && property.Type is IAssociationType)
                {
                    IAssociationType associationType = (IAssociationType)property.Type;
                    string associatedEntityName = null;
                    try
                    {
                        //for 'Collection Types', sometimes 'Element Type' is not an 'Entity Type'
                        associatedEntityName = associationType.GetAssociatedEntityName(sessionImplementor);
                    }
                    catch (MappingException me)
                    {
                        if (log.IsDebugEnabled)
                            log.Debug("Can not perform 'GetAssociatedEntityName'. " +
                                    "Considering it is not an entity type: '" +
                                    nestedEM.EntityType.Name + "." +
                                    nestedEM.PropertyNames[i] + "'",
                                me);
                    }
                    if (associatedEntityName != null)
                    {
                        IEntityPersister persisterNextNested = sessionImplementor.GetEntityPersister(associatedEntityName);
                        emResult = this.GetReferrerByCompositeId(
                            rootEM,
                            persisterNextNested.EntityMetamodel,
                            false,
                            visitedList);
                        if (emResult != null)
                            return emResult;
                    }
                }
            }
        }

        return null;
    }

    // Evict collections from the factory-level cache
    private void EvictCachedCollections(IEntityPersister persister, object id, ISessionFactoryImplementor factory)
    {
        EvictCachedCollections(persister.PropertyTypes, id, factory);
    }

    private void EvictCachedCollections(IType[] types, object id, ISessionFactoryImplementor factory)
    {
        for (int i = 0; i < types.Length; i++)
        {
            if (types[i].IsCollectionType)
            {
                factory.EvictCollection(((CollectionType)types[i]).Role, id);
            }
            else if (types[i].IsComponentType)
            {
                IAbstractComponentType actype = (IAbstractComponentType)types[i];
                EvictCachedCollections(actype.Subtypes, id, factory);
            }
        }
    }
} 
```

3.3.x 版：

```
/// <summary> 
/// Defines the default refresh event listener used by hibernate for refreshing entities
/// in response to generated refresh events. 
/// </summary>
[Serializable]
public class DefaultRefreshEventListener : IRefreshEventListener
{
    private static readonly IInternalLogger log = LoggerProvider.LoggerFor(typeof(DefaultRefreshEventListener));

    public virtual void OnRefresh(RefreshEvent @event)
    {
        OnRefresh(@event, IdentityMap.Instantiate(10));
    }

    public virtual void OnRefresh(RefreshEvent @event, IDictionary refreshedAlready)
    {
        IEventSource source = @event.Session;

        bool isTransient = !source.Contains(@event.Entity);
        if (source.PersistenceContext.ReassociateIfUninitializedProxy(@event.Entity))
        {
            if (isTransient)
                source.SetReadOnly(@event.Entity, source.DefaultReadOnly);
            return;
        }

        object obj = source.PersistenceContext.UnproxyAndReassociate(@event.Entity);

        if (refreshedAlready.Contains(obj))
        {
            log.Debug("already refreshed");
            return;
        }

        EntityEntry e = source.PersistenceContext.GetEntry(obj);
        IEntityPersister persister;
        object id;

        if (e == null)
        {
            persister = source.GetEntityPersister(null, obj); //refresh() does not pass an entityName
            id = persister.GetIdentifier(obj, source.EntityMode);
            if (log.IsDebugEnabled)
            {
                log.Debug("refreshing transient " + MessageHelper.InfoString(persister, id, source.Factory));
            }
            EntityKey key = new EntityKey(id, persister, source.EntityMode);
            if (source.PersistenceContext.GetEntry(key) != null)
            {
                throw new PersistentObjectException("attempted to refresh transient instance when persistent instance was already associated with the Session: " + 
                    MessageHelper.InfoString(persister, id, source.Factory));
            }
        }
        else
        {
            if (log.IsDebugEnabled)
            {
                log.Debug("refreshing " + MessageHelper.InfoString(e.Persister, e.Id, source.Factory));
            }
            if (!e.ExistsInDatabase)
            {
                throw new HibernateException("this instance does not yet exist as a row in the database");
            }

            persister = e.Persister;
            id = e.Id;
        }

        // cascade the refresh prior to refreshing this entity
        refreshedAlready[obj] = obj;
        new Cascade(CascadingAction.Refresh, CascadePoint.BeforeRefresh, source).CascadeOn(persister, obj, refreshedAlready);

        if (e != null)
        {
            EntityKey key = new EntityKey(id, persister, source.EntityMode);
            source.PersistenceContext.RemoveEntity(key);
            if (persister.HasCollections)
                new EvictVisitor(source).Process(obj, persister);
        }

        if (persister.HasCache)
        {
            CacheKey ck = new CacheKey(id, persister.IdentifierType, persister.RootEntityName, source.EntityMode, source.Factory);
            persister.Cache.Remove(ck);
        }

        EvictCachedCollections(persister, id, source.Factory);

        // NH Different behavior : NH-1601
        // At this point the entity need the real refresh, all elementes of collections are Refreshed,
        // the collection state was evicted, but the PersistentCollection (in the entity state)
        // is associated with a possible previous session.
        new WrapVisitor(source).Process(obj, persister);

        // NH-3253: Forcing simple load to prevent the redundante instance 
        //on session:
        //Ocurre when:
        // -there is a 'one-to-many' 'Parent-Child' relationship;
        // -AND the 'Parent' 'many-to-one' association is ' fetch="select" ';
        // -AND 'Child' is using a 'composite-id' and 'key-many-to-one' to the
        //'Parent'.
        object result;
        if (this.IsReferencedByCompositeId(persister))
            result = persister.Load(id, obj, @event.LockMode, source);

        string previousFetchProfile = source.FetchProfile;
        source.FetchProfile = "refresh";
        result = persister.Load(id, obj, @event.LockMode, source);

        if (result != null)
            if (!persister.IsMutable)
                source.SetReadOnly(result, true);
            else
                source.SetReadOnly(result, (e == null ? source.DefaultReadOnly : e.IsReadOnly));

        source.FetchProfile = previousFetchProfile;

        // NH Different behavior : we are ignoring transient entities without throw any kind of exception
        // because a transient entity is "self refreshed"
        if (!ForeignKeys.IsTransient(persister.EntityName, obj, result == null, @event.Session))
            UnresolvableObjectException.ThrowIfNull(result, id, persister.EntityName);
    }

    private Dictionary<EntityMetamodel, bool> IsReferencedByCompositeIdCache = new Dictionary<EntityMetamodel, bool>();
    /// <summary>
    /// Returns <c>true</c> if the entity in <paramref name="persister"/> 
    /// ('root') has a direct or indirect association with another 
    /// entity that is associated back to 'root' through a 'composit-id' and 
    /// 'key-many-to-one'.
    /// </summary>
    /// <param name="persister"></param>
    /// <returns></returns>
    private bool IsReferencedByCompositeId(IEntityPersister persister)
    {
        try
        {
            bool result = false;
            if (IsReferencedByCompositeIdCache.ContainsKey(persister.EntityMetamodel))
            {
                result = this.IsReferencedByCompositeIdCache[persister.EntityMetamodel];
            }
            else
            {
                EntityMetamodel em =
                    this.GetReferrerByCompositeId(
                        persister.EntityMetamodel,
                        persister.EntityMetamodel,
                        false,
                        new Iesi.Collections.Generic.HashedSet<EntityMetamodel>());
                if (em == null)
                    result = false;
                else
                    result = true;

                lock (this)
                {
                    this.IsReferencedByCompositeIdCache[persister.EntityMetamodel] = result;
                }
            }

            return result;
        }
        catch (Exception ex)
        {
            log.Error("Unespected ERROR!", ex);
            throw;
        }
    }

    /// <summary>
    /// Recursive Helper for <see cref="IsReferencedByCompositeId(IEntityPersister)"/>.
    /// </summary>
    /// <param name="rootEM"></param>
    /// <param name="nestedEM"></param>
    /// <param name="neestedIsCompositeId"></param>
    /// <param name="visitedList"></param>
    /// <returns></returns>
    private EntityMetamodel GetReferrerByCompositeId(
        EntityMetamodel rootEM,
        EntityMetamodel nestedEM,
        bool neestedIsCompositeId,
        ICollection<EntityMetamodel> visitedList)
    {
        EntityMetamodel emResult = null;

        if (visitedList.Contains(nestedEM))
        {
            return emResult;
        }
        else
        {
            visitedList.Add(nestedEM);

            ISessionFactoryImplementor sessionImplementor = rootEM.SessionFactory;

            if (nestedEM.IdentifierProperty.Type is IAbstractComponentType)
            {
                IAbstractComponentType componentType = (IAbstractComponentType)nestedEM.IdentifierProperty.Type;
                for (int i = 0; i < componentType.Subtypes.Length; i++)
                {
                    IType subType = componentType.Subtypes[i];
                    if (!subType.IsAnyType
                        && subType.IsAssociationType
                        && subType is IAssociationType)
                    {
                        IAssociationType associationType = (IAssociationType)subType;
                        string associatedEntityName = null;
                        try
                        {
                            //for 'Collection Types', sometimes 'Element Type' is not an 'Entity Type'
                            associatedEntityName = associationType.GetAssociatedEntityName(sessionImplementor);
                        }
                        catch (MappingException me)
                        {
                            //I think it will never happen because a 
                            //"Composit Id" can not have a property that 
                            //uses 'NHibernate.Type.CollectionType'. 
                            //But just in case ...
                            if (log.IsDebugEnabled)
                                log.Debug("Can not perform 'GetAssociatedEntityName'. " +
                                    "Considering it is not an entity type: '" +
                                    nestedEM.IdentifierProperty.Name + "." +
                                    componentType.PropertyNames[i] + "'"
                                    , me);
                        }
                        if (associatedEntityName != null)
                        {
                            IEntityPersister persisterNextNested = sessionImplementor.GetEntityPersister(associatedEntityName);
                            if (rootEM == persisterNextNested.EntityMetamodel)
                            {
                                emResult = nestedEM;
                                return emResult;
                            }
                            else
                            {
                                emResult = this.GetReferrerByCompositeId(
                                    rootEM,
                                    persisterNextNested.EntityMetamodel,
                                    true,
                                    visitedList);

                                if (emResult != null)
                                    return emResult;
                            }
                        }
                    }
                }
            }
            for (int i = 0; i < nestedEM.Properties.Length; i++)
            {
                StandardProperty property = nestedEM.Properties[i];

                if (!property.Type.IsAnyType
                    && property.Type.IsAssociationType
                    && property.Type is IAssociationType)
                {
                    IAssociationType associationType = (IAssociationType)property.Type;
                    string associatedEntityName = null;
                    try
                    {
                        //for 'Collection Types', sometimes 'Element Type' is not an 'Entity Type'
                        associatedEntityName = associationType.GetAssociatedEntityName(sessionImplementor);
                    }
                    catch (MappingException me)
                    {
                        if (log.IsDebugEnabled)
                            log.Debug("Can not perform 'GetAssociatedEntityName'. " +
                                    "Considering it is not an entity type: '" +
                                    nestedEM.EntityType.Name + "." +
                                    nestedEM.PropertyNames[i] + "'",
                                me);
                    }
                    if (associatedEntityName != null)
                    {
                        IEntityPersister persisterNextNested = sessionImplementor.GetEntityPersister(associatedEntityName);
                        emResult = this.GetReferrerByCompositeId(
                            rootEM,
                            persisterNextNested.EntityMetamodel,
                            false,
                            visitedList);
                        if (emResult != null)
                            return emResult;
                    }
                }
            }
        }

        return null;
    }

    // Evict collections from the factory-level cache
    private void EvictCachedCollections(IEntityPersister persister, object id, ISessionFactoryImplementor factory)
    {
        EvictCachedCollections(persister.PropertyTypes, id, factory);
    }

    private void EvictCachedCollections(IType[] types, object id, ISessionFactoryImplementor factory)
    {
        for (int i = 0; i < types.Length; i++)
        {
            if (types[i].IsCollectionType)
            {
                factory.EvictCollection(((CollectionType)types[i]).Role, id);
            }
            else if (types[i].IsComponentType)
            {
                IAbstractComponentType actype = (IAbstractComponentType)types[i];
                EvictCachedCollections(actype.Subtypes, id, factory);
            }
        }
    }
} 
```

# wpf - 将扩展器操作链接到 RowDefinition 高度

> ID：12112105
> 
> 赞同：1
> 
> 时间：2012-08-24T15:12:13.567
> 
> 标签：wpf, expander, grid-layout

我有以下网格：

```
 <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
...

                <Expander Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
                    <TextBox />
                </Expander> 
```

文本框填充扩展器。我想这样设置，当底部行展开时，行高是 Auto / * / *，当底部折叠时，行高是 Auto / * / Auto。我已经尝试（但没有成功）使用样式触发器来执行此操作，并且希望尽可能在 XAML 中而不是代码中执行此操作。提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:31:50.493

我可以想到两种简单的方法来做到这一点

第一个是`RowDefinitions`根据`Expander.IsExpanded`值调整网格。我的博客上有一些[GridHelpers，](http://rachel53461.wordpress.com/2011/09/17/wpf-grids-rowcolumn-count-properties/)它们允许您绑定 Grid 的行和列定义，而不必手动定义它们，这使这变得更加容易。使用这些助手，最终结果将如下所示：

```
<Grid local:GridHelpers.RowCount="3">
    <Grid.Style>
        <Style TargetType="{x:Type Grid}">
            <Setter Property="local:GridHelpers.StarRows" Value="1" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=MyExpander, Path=IsExpanded}" Value="True">
                    <Setter Property="local:GridHelpers.StarRows" Value="1,2" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Grid.Style>

    ...

    <Expander x:Name="MyExpander" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
        <TextBox />
    </Expander>

</Grid> 
```

第二个选项是使用 a`Converter`并将`Trigger`其设置为`Expander.MinHeight`展开`(Grid.ActualHeight - Row0Content.ActualHeight) / 2`时。我的博客上还有一个[MathConverter，](http://rachel53461.wordpress.com/2011/08/20/the-math-converter/)它可能会使这更容易，或者您可以创建自己的。

```
<Grid x:Name="MyGrid">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <TextBox Height="50" Grid.Row="0" />
    <TextBox Grid.Row="1" />

    <Expander Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
        <Expander.Style>
            <Style TargetType="{x:Type Expander }">
                <Setter Property="MinHeight" Value="0" />
                <Style.Triggers>
                    <Trigger Property="IsExpanded" Value="True">
                        <Setter Property="MinHeight" Value="{Binding 
                            ElementName=MyGrid, 
                            Path=ActualHeight,
                            Converter={StaticResource MathConverter},
                            ConverterParameter=((@VALUE-50)/2)" />
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Expander.Style>

        <TextBox />
    </Expander>
</Grid> 
```

我博客上的这个转换器只有在你提前知道 Row0 的高度时才有效，因为它是常规的，但是如果你还需要传递 Row0 的高度，`IValueConverter`它很容易转换为。`IMultiValueConverter`我实际上已经有了代码，但我还没有开始更新我的博客文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:27:07.503

到目前为止，这是我丑陋的解决方法：

```
<Window.Resources>
    <Style TargetType="Expander">
        <EventSetter Event="Expanded" Handler="ExpanderGrow"/>
        <EventSetter Event="Collapsed" Handler="ExpanderGrow"/>
    </Style>
</Window.Resources> 
```

...以及所需的 CS：

```
 public void ExpanderGrow(object sender, RoutedEventArgs e)
    {
        Expander expander = (Expander)sender;
        Grid grid = (Grid)expander.Parent;
        int index = Grid.GetRow(expander);
        RowDefinition rowdef = grid.RowDefinitions[index];

        rowdef.Height = new GridLength(1,
            expander.IsExpanded ? GridUnitType.Star : GridUnitType.Auto);
    } 
```

# oracle - Oracle：不希望在存储过程中使用 Begin 语句？

> ID：12112107
> 
> 赞同：0
> 
> 时间：2012-08-24T15:12:17.677
> 
> 标签：oracle

我是 Oracle 的新手，所以请耐心等待 - 我会尽力而为。

我正在编写一个存储过程。语句完成后`AS`，我有以下代码：

```
BEGIN
IF v_Node = NULL
    BEGIN
      SET v_Node = LEFT(v_Tag, INSTR('.', v_Tag)-1)
      SET v_Node = (SELECT v_NodeId FROM DBO.nodes WHERE Node = v_Node)
    END 
```

我们编译的会吐出以下错误：

`Error(23,5): PLS-00103: Encountered the symbol "BEGIN" when expecting one of the following: * & - + / at mod remainder rem then <an exponent (**)> and or || multiset`

有人能帮忙吗？干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:22:36.390

我怀疑你想要类似的东西

```
CREATE OR REPLACE PROCEDURE <<procedure name>>( <<parameter list>> )
AS
  <<variable declarations>>
BEGIN
  IF v_Node IS NULL
  THEN
    v_Node := substr( v_tag, 1, instr( '.', v_tag ) - 1 );
    SELECT v_NodeId -- Is v_NodeID really a column in dbo.nodes?  The naming 
                    -- convention would imply that it is a local variable in 
                    -- which case the SELECT statement doesn't make a lot of 
                    -- sense.
      INTO v_node
      FROM dbo.nodes
     WHERE node = v_node;
  END IF;

  <<more code>>
END; 
```

说明

1.  没有任何价值是平等的`NULL`，甚至没有其他价值`NULL`。您需要使用`IS NULL`运算符。
2.  Oracle 没有`LEFT`函数。你可能想要`SUBSTR`.
3.  `SET`不是有效的 PL/SQL 运算符。您可以使用`:=`运算符将​​表达式的结果分配给变量。您可以使用`SELECT ... INTO`将 SQL 查询的结果分配给局部变量。

剩下的问题

1.  您似乎使用相同的局部变量`v_Node`来分配`Node`要搜索的字符串并保存`v_NodeId`您从表中选择的大概数字，这似乎很奇怪。如果这确实是您的意图，您将需要单独的变量。
2.  你写的`SELECT`声明没有意义。If是一个局部变量，正如命名约定所暗示的那样，从表`v_NodeId`中选择它是没有意义的。`dbo.nodes`您似乎更有可能选择`NodeId`（假设它是 中的一列`dbo.nodes`）。

# r - 子集函数不删除 NA

> ID：12112108
> 
> 赞同：2
> 
> 时间：2012-08-24T15:12:18.833
> 
> 标签：r, subset, na

我有一个这样的数据框：

```
df

Date     Player Injured
1/2/2012      A      No
1/3/2012      B     Yes
1/4/2012      C      No
1/5/2012      B      NA
1/5/2012      A      No
1/7/2012      B     Yes
1/8/2012      A      No
1/3/2012      B     Yes
1/2/2012      D      No
1/3/2012      F      NA 
```

我正在尝试使用子集功能来选择受伤信息为 NA 的球员：

```
x <- subset(df, injured!="NA") 
```

x 数据框未填充。这似乎很简单。有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:16:32.183

试试`x<-subset(df, is.na(Injured))`。

# c# - 从本地数据库更改为托管在服务器上的 SQL Server

> ID：12112110
> 
> 赞同：5
> 
> 时间：2012-08-24T15:12:21.553
> 
> 标签：c#, sql-server, asp.net-mvc-3, crud, visual-studio-2012

所以我对 Visual Studio 中的 MVC 和 C# 相当陌生。我最近完成了位于以下位置的教程：

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-应用](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)

这在某些方面很有趣，也很有教育意义。我有一个关于它连接到的数据库的问题，在教程中它创建了一个本地 SQL Server 数据库，然后 CRUD 可以解决这个问题。我目前在我希望能够使用的服务器上托管了一个外部 SQL Server 数据库，我已通过 Visual Studio (2012) 成功连接到它，但想知道将 CRUD 传输到它有多难。

在阅读了一点之后，我更改了连接字符串，并添加了：

```
using System.Data.SqlClient 
```

但我仍在使用：

```
using System.Data.Entity 
```

不确定我是否需要两者，并且我正在使用 EF（实体框架）。

谁能建议需要完成哪些其他步骤才能成功转移？或者我应该朝哪个方向看，因为我不是数据库或 SQL 专家（或 MVC），这有点令人困惑。

任何帮助、链接或教程位置将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:41:17.910

现在你正在寻找正确的地方。您需要将架构和数据加载到其中。模式是您设置的表和关系，数据是您已经收集和输入的所有信息。我使用 Web Deploy 来执行此操作。下面的一些链接可以帮助您解决这个问题。如果你在视觉工作室。转到项目菜单包发布设置。然后单击打包/发布 SQL。看看那里的设置，看看下面的图片和链接，你应该明白了。让我知道这是否有帮助。

![网络发布工具栏](../Images/a904f319d9c1ff4045910828e614d590.png)

[伟大的 Web 部署说明](http://learn.iis.net/page.aspx/1081/building-a-web-deploy-package-from-visual-studio-2010/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T21:28:46.527

我将从 LocadDB 版本创建一个 .sqlproj，然后将其发布到您的 SQL Server。更改 MVC 项目中的连接字符串，您应该一切顺利。请注意，您的数据不会跟随。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:22:45.330

我使用过网络表单，但我相信您需要在解决方案中编辑 web.config 文件中的连接字符串以指向托管数据库才能使用它。

SQL 服务器：

```
Data Source={SERVER NAME};Initial Catalog={DataBaseName};User Id={SQLUsername};Password={SQLPassword}; 
```

MySQL：

```
Server={SERVER NAME};Database={DataBaseName};Uid={SQLUsername};Pwd={SQLPassword}; 
```

让我知道这是否有帮助。

# c++ - 使用 devpartner 分析特定方法

> ID：12112111
> 
> 赞同：0
> 
> 时间：2012-08-24T15:12:23.440
> 
> 标签：c++, visual-c++, profiling, devpartner

我使用 devPartner 来分析一些 C++ 代码的性能。有没有办法只分析一个特定的功能，或者从分析中删除一个特定的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T17:00:11.350

您需要在 C/C++ 附加命令行选项下的项目设置中指定 /nmignore::。

函数名称可以是完整的函数名称，函数开头后跟 * 或 *some pattern * 用于包含子句。

因此 /nmignore: *:main 将排除包含在任何文件中的 main /nmignore:main.cpp:myfunc*将排除所有在 main.cpp 中以 myfunc 开头的函数 /nmignore:*: *std::*将排除所有 std::namepspace所有文件中的功能。

检测发生在编译通道 C1 和 C2 之间，因此所有函数都已从头文件内联到源文件中。请注意通配符，因为您可能会排除比您计划的更多的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T19:10:51.393

在某种程度上。DevPartner 为错误检测、覆盖或性能检测代码，并且可以从检测中排除某些命名空间、某些源文件甚至特定功能。甚至还有一种方法可以通过其命名空间“std”来排除 STL。没有仪器，您将无法进行分析。

防止检测发生所需的构建选项是“/nmignore”，它有许多可能的参数。我自己不使用它，所以我必须从负责编译时检测代码的人那里获取详细信息（我的专长是 BoundsChecker 的后端）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T17:11:43.347

我很幸运地在没有任何检测的情况下编译了完整的程序，然后打开检测并重新编译了一个文件。不过，那是用于泄漏检测，而不是分析。

# android - 在 Android API 10 中在运行时动态重新加载布局

> ID：12112112
> 
> 赞同：0
> 
> 时间：2012-08-24T15:12:31.030
> 
> 标签：android, android-layout, reload

我正在尝试编写一个 Android 应用程序，我需要在运行时更改布局的重要元素。我可以通过以编程方式`Views`在屏幕上移动来实现它，但这需要花费大量时间和大量工作。一种更简单的方法是刷新当前`layout`布局并从新布局文件重新加载屏幕布局。但是，使该方法实用的所有 API 方法似乎都来自 API 11，而我正在为 API 10（特别是 OS 2.3.4）进行开发。

更具体地说，我正在开发一个计算器。我想实现一个更改基本功能以在例如 、 和 之间`Decimal`进行`Hex`更改`Binary`。例如，由于 Binary 不需要数字 2-9，因此我想为 L&F 目的以及恢复屏幕空间来重构布局，而不是简单地将未使用的按钮变灰。

我在对类似问题的回答中找到[了本教程](http://tech.chitgoks.com/2008/03/19/android-how-to-load-layout-xml-files-dynamically-during-runtime/)，但是那里的信息似乎已经过时了，而且我可以从中收集到的信息在我的情况下似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:47:38.177

如果您希望动态更改布局，那么 LayoutInflater 应该是可行的方法，类似于您发布的教程，但如果您阅读了 Inflater 文档，您应该更好地了解如何使用它。

为什么不为每个基地创建单独的活动？（如果我理解您要正确执行的操作）

从原始问题提问者编辑（因为我似乎无法弄清楚如何在此处添加回复）：我阅读了 LayoutInflater 的文档，但我不太明白它是如何工作的。我尝试按照该教程使用它，但它似乎不起作用......你能更具体地说明需要做什么吗？

# javascript - 刷新页面时重置值

> ID：12112119
> 
> 赞同：2
> 
> 时间：2012-08-24T15:13:22.833
> 
> 标签：javascript, html, css, refresh

没有查询！我希望能够刷新页面并将下拉列表的值重置为空白（第一个选项）。但是，如果我去页面填写一些内容并刷新页面，它会保留以前在下拉列表中的选项文本。有谁知道如何实现这一目标？

这是我正在使用的下拉菜单。如果您想查看所有代码，我可以发布它。

```
<select style="float:left;" id="leave" onchange="changeMessage(this);">
      <option value="0"></option>
      <option value="5">Get Married</option>
      <option value="100">Have a Baby</option>
      <option value="90">Adopt a Child</option>
      <option value="35">Retire</option>
      <option value="15">Military Leave</option>
      <option value="25">Medical Leave</option>
</select> 
```

这是所有的代码...

```
<html>
<head>
<title>Life Event Picker Calendar</title>
<script>
function changeMessage(oElement) {
    var rd1 = document.getElementById("rd1");
    var rd1Text = rd1.parentNode.getElementsByTagName('span')[0];
    var rd2 = document.getElementById("rd2");
    var rd2Text = rd2.parentNode.getElementsByTagName('span')[0];

    document.getElementById("message1").innerHTML = "";
    document.getElementById("message2").innerHTML = "";
    document.getElementById("message3").innerHTML = "";
    document.getElementById("message4").innerHTML = "";
    document.getElementById("message5").innerHTML = "";

    rd1.checked = false;
    rd2.checked = false;
    //nothing
    if (oElement.value == "0") {
        document.getElementById("btn").style.display = "none";
        document.getElementById("radio").style.display = "none";
        document.getElementById("day").innerHTML = "Date";
    //have a baby
    } else if (oElement.value == "100") {
        document.getElementById("btn").style.display = "none";
        document.getElementById("radio").style.clear = "both";
        document.getElementById("radio").style.display = "inline-block";
        rd1Text.innerHTML = "C-Section";
        rd2Text.innerHTML = "Regular Birth";
        rd1.value = "C-Section";
        rd2.value = "Regular Birth";
        document.getElementById("day").innerHTML = "Anticipated Due Date";
    //military leave
    } else if (oElement.value == "15") {
        document.getElementById("btn").style.display = "none";
        document.getElementById("radio").style.clear = "both";
        document.getElementById("radio").style.display = "inline-block";
        rd1Text.innerHTML = "Training";
        rd2Text.innerHTML = "Active Duty";
        rd1.value = "Training";
        rd2.value = "Active Duty";
        document.getElementById("day").innerHTML = "Anticipated Leave Date";
    //get married
    } else if (oElement.value == "5") {
        document.getElementById("btn").style.display = "inline-block";
        document.getElementById("radio").style.display = "none";
        document.getElementById("day").innerHTML = "Marriage Date";
    //adopt a child
    } else if (oElement.value == "90") {
        document.getElementById("btn").style.display = "inline-block";
        document.getElementById("radio").style.display = "none";
        document.getElementById("day").innerHTML = "Anticipated Adoption Date";
    //retire
    } else if (oElement.value == "35") {
        document.getElementById("btn").style.display = "inline-block";
        document.getElementById("radio").style.display = "none";
        document.getElementById("day").innerHTML = "Anticipated Retirement Date";
    //medical leave
    } else if (oElement.value == "25") {
        document.getElementById("btn").style.display = "inline-block";
        document.getElementById("radio").style.display = "none";
        document.getElementById("day").innerHTML = "Anticipated Disability Date";       
    } else {}
    return;
}

function showChoice(input) {
    document.getElementById("btn").style.display = "inline-block";
}

//gets info picked and displays messages
function getInfo() {
    var myDate=new Date();
    var ev_num = parseInt(document.getElementById("leave").value)
    myDate.setFullYear(sel_year.value,sel_month.value,sel_day.value);
    var event_value = document.getElementById("leave").value;

    //get married
    if (event_value == 5) {
        var first_number = new Date(myDate);
        first_number.setDate(myDate.getDate() + 31);
        document.getElementById("message1").innerHTML = "From " + myDate + " through " + first_number + "<br/>" + "You are eligible to update coverage and personal information through your 'Get Married' Life Event.";
        document.getElementById("message2").innerHTML = "";
        document.getElementById("message3").innerHTML = "";
        document.getElementById("message4").innerHTML = "";
        document.getElementById("message5").innerHTML = "";

    //have a baby
    } else if (event_value == 100) {
        var first_number = new Date(myDate);
        first_number.setDate(myDate.getDate() + 31);
        var second_number = new Date(myDate);
        second_number.setDate(myDate.getDate() - 30);
        var third_number = new Date(myDate);
        third_number.setDate(myDate.getDate() + 7);

        document.getElementById("message1").innerHTML = "From " + myDate + " through " + first_number + "<br/>" + "You are eligible to update coverage and personal information through your 'Have a Baby' Life Event.";
        document.getElementById("message2").innerHTML = "From " + second_number + " through " + myDate + "<br/>" + "1) Call 1-877-968-7762 to initiate your leave. <br/>" + "2) Complete Authorization Release Form.";
        document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>Contact a Leave Specialist at the HR Service Center to request paid days if not enough Occasional Absence days.";

        var fourth_number;
        var fifth_number1;
        var fifth_number2;
        //C Section 
        if ((document.getElementById("rd1").checked) == true) {
            fourth_number = new Date(myDate);
            fourth_number.setDate(myDate.getDate() + 56);
            fifth_number1 = new Date(myDate);
            fifth_number1.setDate(myDate.getDate() + 57);
            fifth_number2 = new Date(myDate);
            fifth_number2.setDate(myDate.getDate() + 91);

            document.getElementById("message4").innerHTML = myDate + " up to " + fourth_number + "<br/>1) Benefits deducted from STD pay.<br/>2) Checkpoint to determine return to work date.";
            document.getElementById("message5").innerHTML = fifth_number1 + " up to " + fifth_number2 + "<br/>1) Paid time off is up to five paid days.<br/>2) FML job protection is up to 13 weeks.<br/>3) Benefit bill sent once STD ends.";

        //Regular Birth
        } else {
            fourth_number = new Date(myDate);
            fourth_number.setDate(myDate.getDate() + 42);
            fifth_number1 = new Date(myDate);
            fifth_number1.setDate(myDate.getDate() + 43);
            fifth_number2 = new Date(myDate);
            fifth_number2.setDate(myDate.getDate() + 91);

            document.getElementById("message4").innerHTML = "From " + myDate + " through " + fourth_number + "<br/>1) Benefits deducted from STD pay.<br/>Checkpoint to determine return to work date.";
            document.getElementById("message5").innerHTML = fifth_number1 + " up to " + fifth_number2 + "<br/>1) Paid time off is up to five paid days.<br/>2) FML job protection is up to 13 weeks.<br/>3) Benefit bill sent once STD ends.";
        }

    //adopt a child 
    } else if (event_value == 90) {
        var first_number = new Date(myDate);
        first_number.setDate(myDate.getDate() + 31);
        var second_number = new Date(myDate);
        second_number.setDate(myDate.getDate() - 30);
        var third_number = new Date(myDate);
        third_number.setDate(myDate.getDate() + 91);

        document.getElementById("message1").innerHTML = "From " + myDate + " through " + first_number + "<br/>" + "You are eligible to update coverage and personal information through your 'Have a Child' Life Event.";
        document.getElementById("message2").innerHTML = "From " + second_number + " through " + myDate + "<br/>" + "Call 1-877-968-7762 to initiate your leave.";
        document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>1) Adoption time off is up to 10 paid days.<br/>2) FML job protection up to 13 weeks.";
        document.getElementById("message4").innerHTML = "";
        document.getElementById("message5").innerHTML = "";

    //retire
    } else if (event_value == 35) {
        var second_number = new Date(myDate);
        second_number.setDate(myDate.getDate() - 90);
        var third_number = new Date(myDate);
        third_number.setDate(myDate.getDate() + 30);
        var fourth_number = new Date(myDate);
        fourth_number.setDate(myDate.getDate() + 60);

        document.getElementById("message1").innerHTML = "";
        document.getElementById("message2").innerHTML = "From " + second_number + " through " + myDate + "<br/>Call 1-877-968-7762 to initiate your retirement.<br/>2) Make Pension election/return form.<br/>3) Review Savings/401(k) Options.<br/>4) View Medical Options.<br/>5) Review/Confirm beneficiaries.";
        document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>Enroll in Medical Plan Options if applicable.";
        document.getElementById("message4").innerHTML = "From " + myDate + " through " + fourth_number + "<br/>1) Enroll in COBRA<br/>2) Payoff any 401(k) loans.";
        document.getElementById("message5").innerHTML = "";

    //military leave
    } else if (event_value == 15) {
        var second_number = new Date(myDate);
        second_number.setDate(myDate.getDate() - 30);
        var third_number
        var fourth_number;

        document.getElementById("message1").innerHTML = "";
        document.getElementById("message2").innerHTML = "From " + second_number + " through " + myDate + "<br/>Call 1-877-968-7762 to initiate your leave.";
        document.getElementById("message5").innerHTML = "";

        //Training Leave
        if ((document.getElementById("rd1").checked) == true) {
            third_number = new Date(myDate);
            third_number.setDate(myDate.getDate() + 14);
            fourth_number = new Date(myDate);
            fourth_number.setDate(myDate.getDate() + 15);

            document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>You are eligible to receive 100% pay.";
            document.getElementById("message4").innerHTML = "After " + fourth_number + "<br/>Your leave will be unpaid.";

        //Active Duty
        } else {
            third_number = new Date(myDate);
            third_number.setDate(myDate.getDate() + 365);

            document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>You are eligible to receive 50% pay.";
            document.getElementById("message4").innerHTML = "After " + third_number + "<br/>Your leave will be unpaid.";
        }

    //medical leave
    } else if (event_value == 25) {
        var first_number = new Date(myDate);
        first_number.setDate(myDate.getDate() + 31);
        var second_number = new Date(myDate);
        second_number.setDate(myDate.getDate() - 30);
        var third_number = new Date(myDate);
        third_number.setDate(myDate.getDate() + 7);
        var fourth_number = new Date(myDate);
        fourth_number.setDate(myDate.getDate() + 91);

        document.getElementById("message1").innerHTML = "From " + myDate + " through " + first_number + "<br/>You are eligible to update coverage and personal information through your 'Take Medical Leave' Life Event.";
        document.getElementById("message2").innerHTML = "From " + second_number + " through " + myDate + "<br/>1) Call 1-877-968-7762 to initiate your leave. <br/>2) Complete Authorization Release Form.";
        document.getElementById("message3").innerHTML = "From " + myDate + " through " + third_number + "<br/>Contact a Leave Specialist at the HR Service Center to request paid days if not enough Occasional Absence days.";
        document.getElementById("message4").innerHTML = "From " + myDate + " through " + fourth_number + "<br/>1) Benefits deducted from STD pay.<br/>2) Checkpoint to determine return to work date.";
        document.getElementById("message5").innerHTML = "After " + fourth_number + "<br/>Contact will be made to initiate the LTD application process prior to 92nd day.";

    } else {}
}
</script>
</head>
<body>

Life Event Picker Calendar<br>
<hr align="left" width="200px"/>
<div id="life" style="float:left;">Life Event</div><div id="day" style="display:float:left; margin-left:120px;">Date</div>

    <select style="float:left;" id="leave" onchange="changeMessage(this);">
          <option selected="selected"value="0"></option>
          <option value="5">Get Married</option>
          <option value="100">Have a Baby</option>
          <option value="90">Adopt a Child</option>
          <option value="35">Retire</option>
          <option value="15">Military Leave</option>
          <option value="25">Medical Leave</option>
    </select>    

<div id="calendar-container" style="float:left;" ></div>

    <button id="btn" style="display:none;" onclick="getInfo()"type="button">Process</button>

<br>
<div id="radio" style="display:none">
    <label><span></span><input type="radio" name="radio" id="rd1" value="" onclick="showChoice(this)"/></label>
    <label><span></span><input type="radio" name="radio" id="rd2" value="" onclick="showChoice(this)"/></label>
</div>

<br>
<div id="date"></div>
<div id="event"></div>
<div id="return"></div>
<div id="yourdate"></div>

<div id="message1"></div><br>
<div id="message2"></div><br>
<div id="message3"></div><br>
<div id="message4"></div><br>
<div id="message5"></div>

<script type="text/javascript">
//creates the element variables for the drop downs
//need to be up here for getInfo() to work
var sel_year = document.createElement('select'),
    sel_month = document.createElement('select'),
    sel_day = document.createElement('select');

//function that creates id calendar-container
(function() {
    //variables and values for years
    var yr1 = 2011,
        yr2 = 2012,
        yr3 = 2013,
        yr4 = 2014;
    var years = [yr1, yr2, yr3, yr4];
    //array with months and associated days
    var calendar = [
        ["January", 31], ["February", 28], ["March", 31], ["April", 30], ["May", 31], ["June", 30], ["July", 31], ["August", 31], ["September", 30],
        ["October", 31], ["November", 30], ["December", 31]],
        //this is the variable that accesses the content
        cont = document.getElementById('calendar-container');

    //creates year/month/day options and sets their values (month value is -1 for date calculation)
    function createOption(txt, val) {
        var option = document.createElement('option');
        option.value = val;
        option.appendChild(document.createTextNode(txt));
        return option;
    }

    //this clears any elements for days, months, years
    function clearChildren(ele) {
        while (ele.hasChildNodes()) {
            ele.removeChild(ele.lastChild);
        }
    }

    //this function is triggered when you change the year or month
    function recalculateDays() {
        var year_index = sel_year.value;
        var month_index = sel_month.value,
            df = document.createDocumentFragment();
        if ((month_index == 1) && (year_index % 4 == 0)) {
            for (var i = 0, l = calendar[month_index][1]; i < l + 1; i++) {
                //the first variable is what number will be displayed in the day drop down
                df.appendChild(createOption(i + 1, i + 1));
            }
        } else {
            //l is the variable for the number of days in the month from the array above ex:28, 30, 31
            for (var i = 0, l = calendar[month_index][1]; i < l; i++) {
                //the first variable is what number will be displayed in the day drop down
                df.appendChild(createOption(i + 1, i + 1));
            }
        }
        clearChildren(sel_day);
        sel_day.appendChild(df);
    }

    //this creates the month values
    function generateMonths() {
        var df = document.createDocumentFragment();
        for (var i = 0; i < calendar.length; i++) {
            df.appendChild(createOption(calendar[i][0], i));
        }
        //clears past months
        clearChildren(sel_month);
        //appends new months onto variable df
        sel_month.appendChild(df);
    }

    //this creates the year values
    function generateYears() {
        var df = document.createDocumentFragment();
        for (var i = 0; i < years.length; i++) {
            df.appendChild(createOption(years[i], years[i]));
        }
        //clears past months
        clearChildren(sel_year);
        //appends new months onto variable df
        sel_year.appendChild(df);
    }

    //anytime the month/year selector is changed this calls the function to change the days
    sel_month.onchange = recalculateDays;
    sel_year.onchange = recalculateDays;

    //runs the months and days functions
    generateYears();
    generateMonths();
    recalculateDays();

    //this is what displays each of the individual drop downs after everything has been done to them
    cont.appendChild(sel_year);
    cont.appendChild(sel_month);
    cont.appendChild(sel_day);

}());

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:34:26.123

试试这个：

```
<body onLoad="document.getElementById('leave').options[0].selected = 'selected';"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:20:41.493

这是不使用 javascript hacks 的解决方案：

```
 <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="utf-8">
    <title>Example</title>
    </head>
        <body>
        <select autocomplete="off">
          <option value="0" selected="selected"></option>
          <option value="5">Get Married</option>
          <option value="100">Have a Baby</option>
          <option value="90">Adopt a Child</option>
          <option value="35">Retire</option>
          <option value="15">Military Leave</option>
          <option value="25">Medical Leave</option>
        </select>

        <br /><br />

        <button id="btn" onclick="javascript:location.reload(true)" type="button">Test page reloading</button>

        </body>
        </html> 
```

**编辑**

进行了一些测试并添加了重新加载按钮来测试页面是否使用 javascript 或任何从您的代码触发的内容重新加载 - 它适用于我迄今为止测试的每个浏览器。（值设置为默认值）。使用 IE，它似乎有自己的方式来处理缓存，所以普通的 F5 不像其他浏览器那样工作（对于 IE 来说很典型） - 但是我提供的解决方案往往适用于页面由 js 刷新的常见 Web 开发，导航或表单发送等（网页上的基本用户操作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T15:17:37.267

不知道我是否理解，但尝试简单：

```
<option value="0" SELECTED></option> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:38:17.280

只需循环元素并重置它们：

```
<!DOCTYPE html>
<html>
<head>
<script type='text/javascript'>
function resetSelect(element){
    var reset = parseInt(element.dataset.reset, 10);
    element.selectedIndex = isNaN(reset) ? 0 : reset;
}
function resetSelects(){
    var els = document.getElementsByClassName('reset') || [];
    for (var i = els.length; i--;){
        if (els[i] && els[i].options)
            resetSelect(els[i]);
    }
}
window.onload = function(){
    resetSelects();
};
</script>
</head>
<body>

<select class='reset' data-reset='0' style="float:left;" id="leave" onchange="changeMessage(this);">
      <option value="0"></option>
      <option value="5">Get Married</option>
      <option value="100">Have a Baby</option>
      <option value="90">Adopt a Child</option>
      <option value="35">Retire</option>
      <option value="15">Military Leave</option>
      <option value="25">Medical Leave</option>
</select>   

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-26T17:01:57.623

将 myform 替换为她的表单名称：

```
Window.onload = function(){
    Myform.reset();
} 
```

问候

# amazon-web-services - 使用 EBS 部署的 PHP 应用程序的默认应用程序位置是什么

> ID：12112124
> 
> 赞同：0
> 
> 时间：2012-08-24T15:13:36.520
> 
> 标签：amazon-web-services, amazon-elastic-beanstalk

我有一个我正在尝试使用 Amazon Beanstalk 部署的 php(Centos) 应用程序。

我的应用程序在 /srv/sites/myapp 中。

所以我设置了我的应用程序和环境，并上传了我网站的 zip 文件（myapp.zip）。

我可以看到实例已创建，但该站点无法正常工作，因为我的应用程序未上传到 /srv/sites/myapp。

我试图找出 EBS 将我的应用程序解压缩并将文件放在我的服务器上的位置。

有人可以告诉我 EBS 是否可以放置应用程序文件的默认位置？

我检查了/var/www.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:11:57.483

默认位置是 /var/www/html，它使用 Amazon Linux（基于 RPM）

# jquery - jquery - 我的html如何调用

> ID：12112126
> 
> 赞同：-9
> 
> 时间：2012-08-24T15:13:48.440
> 
> 标签：jquery, html, css, rounded-corners

我有一个提供圆角的 jQuery 插件。我从这里得到了图书馆：（jquery.corner.js）

```
http://jquery.malsup.com/corner/ 
```

这是我的 HTML 标记：

```
<div>
    <div>
      <strong >tab 1</strong> <a href="#">tab 2</a> <a href="#">tab 3</a>
    </div>
</div> 
```

如何从 html 调用我的 jQuery？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:20:07.417

最初，您应该使用`<div>`标签上使用的 id 或类，然后在 jQuery 调用中识别它：

```
<style>
.box{
background-color: blue;
}
</style>
<script>
$(function(){
$('.box').corner();
});
</script>
<div>
<div class="box">
      <strong >tab 1</strong> <a href="#">tab 2</a> <a href="#">tab 3</a>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:29:06.863

不可能*从*HTML 调用 JQuery，因为它们是不同的语言。

JQuery 是一个 Javascript 库，尽管您可以将 javascript 直接插入到 html 文件中，但不推荐使用它，因为它已被弃用。最好包含一个外部文件并导入它，如本教程[http://www.quirksmode.org/js/placejs.html所示](http://www.quirksmode.org/js/placejs.html)

您还应该为您想要效果的 div 提供一个标识符，以便可以更轻松地从 Jquery 调用它。在 HTML 中

前任：

```
<div class="stylebox"> content here  </div> 
```

或者

```
<div id="box1style"> content here  </div> 
```

在 Javascript (.js) 文件中，您可以完美地调用 Jquery（前提是您在调用的文件之前已包含它），您还应该先前包含库 jquery.corner.js，并使用您的 css 粘贴实现像这样的选择器：

```
$(document).ready(function(){
$('.stylebox').corner();
} 
```

或者

```
$(document).ready(function(){
$('#box1style').corner();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T15:22:43.013

只需在代码中包含该 js 并在 script 中添加以下代码。

```
jQuery(document).ready(function(){
    ​jQuery(​"#id1").corner();​​​
 });
​ 
```

为您想要圆角的 div 分配一个 ID。

```
<div id = "id1">
<div>
      <strong >tab 1</strong> <a href="#">tab 2</a> <a href="#">tab 3</a>
    </div>
</div>​​​ 
```

更多示例，请参考：[https ://github.com/malsup/corner](https://github.com/malsup/corner)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T15:20:46.893

jQuery 它是一个 javascript 库，因此它在 javascript 中被调用。要在 HTML 代码中使用 javascript，您需要添加`<script>`元素标记。在你可以使用你的 jquery 插件之前，你需要加载 jquery 和 jquery 插件。

在[jquery Tutorials](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery)中有很多关于如何使用 jquery 的示例。

# javascript - html onload 没有运行 javascript

> ID：12112127
> 
> 赞同：0
> 
> 时间：2012-08-24T15:13:49.440
> 
> 标签：javascript, html, function, onload

我正在用 javascript 编写游戏，我的世界生成器运行良好，但是当我创建一个启动函数来一次运行多个东西时，我的代码根本不再运行。谁能看到我的问题？

```
<head>
<title>Project Rust</title>
<!-- <link href="/YOUR_PATH/favicon.ico" rel="icon" type="image/x-icon" /> -->
<script src="Scripts/startup.js"></script>
<script src="Scripts/drawmap.js"></script>
<script src="Scripts/maps.js"></script>
<script src="Scripts/mapread.js"></script>
<script src="Scripts/mainchar.js"></script>
</head>
<body bgcolor="#BFE3FF" onload="startup()">
</body> 
```

启动.js： `startup(){ alert("start"); drawmap(Screen[0]); mainchar(); }`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:18:04.063

试试这个：

```
function startup(){
    alert("start"); drawmap(Screen[0]); mainchar();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:18:58.983

您应该将类​​型设置为脚本标签：

```
<script type="text/javascript" src="Scripts/startup.js"></script> 
```

此外，您需要使用`function`关键字在 javascript 中定义函数：

```
function startup(){
  alert("start");
  drawmap(Screen[0]);
  mainchar();
} 
```

如果它现在仍在工作，请打开浏览器的 javascript 控制台，您应该会看到错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:21:14.160

您在 startup.js 中缺少函数声明

你需要`function startup(){ /*your code*/ }`

# r - R - 来自不同表的附加列

> ID：12112133
> 
> 赞同：0
> 
> 时间：2012-08-24T15:14:08.003
> 
> 标签：r

我有 10 个表（2 列），它们共享一个公共列（第二列），每个表的第一列包含 2000-2010 年的信息。像这样

表格1

```
Amount2000    Percentage
3             80-100
9             60-80
14            40-60
9             20-40
0             0-20 
```

表2

```
Amount2001    Percentage
3             80-100
9             60-80
14            40-60
9             20-40
0             0-20 
```

等等

我想要做的是创建一个如下表：

```
Percentage   Amount2000  Amount2001   Amount2002.......
.
.
. 
```

通过使用 cbind 也许？这样做的最佳方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:21:22.337

尝试`merge(Table1,Table2)`循环合并 Table1-10。如果每个百分比部分的长度相同且顺序相同，请尝试`cbind(Table1[,2:1],Table2[,1],Table2[,1],...)`。

# iphone - UINavigationController 将先前的 ViewController 保存在不同的选项卡中

> ID：12112142
> 
> 赞同：0
> 
> 时间：2012-08-24T15:14:40.053
> 
> 标签：iphone, cocoa-touch, ipad, uinavigationcontroller, uitabbarcontroller

我想创建一个全局导航堆栈。当用户更改选项卡或导航到同一选项卡中的新视图时，我想将新视图推送到全局导航堆栈上。我希望导航栏中的后退按钮返回到上一个视图，有时是不同的选项卡，有时是同一选项卡中的不同视图。

![](../Images/7aea93b5b6ad1a3dd838ea668e18e9c3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:38:23.903

您所指的是它只是一个选项卡更改，但它以编程方式进行，当按下背面时，它以编程方式选择前一个选项卡。

这是更改选项卡的简单代码，希望这可以帮助您构建逻辑。

设置 selectedViewController：

```
self.tabBarController.selectedViewController = viewControllerYouWant; 
```

例如，

```
self.tabBarController.selectedViewController = [self.tabBarController.viewControllers objectAtIndex:2]; 
```

更新 ：

向导航控制器添加左栏按钮，UIBarButtonItem *customItem =

```
[[UIBarButtonItem alloc] initWithImage:bttnImage style:UIBarButtonItemStylePlain target:self action:@selector(Back:)];
[self.navigationController setHidesBackButton:YES];
[self.navigationItem setLeftBarButtonItem: customItem]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-02T17:22:36.437

创建一个全局 navigationController 和一个自定义的假标签栏，用于在切换标签栏索引的同时更改全局 navigationController 内容。

# iphone - 带有动态文本和图像的 UIScrollView

> ID：12112144
> 
> 赞同：0
> 
> 时间：2012-08-24T15:14:42.520
> 
> 标签：iphone, ipad, uiscrollview

我的应用程序从 json 地址获取消息

我有图片和文字

我的宽度 textView 是动态的，可能是 100 个字符，也可能是 9000 个字符，并且我在页面的第一页有一个 imageView

**我想滚动所有页面（文本和图像）！**

我如何创建视图以正确滚动所有这些视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:20:30.700

有很多教程可以帮助您做到这一点。取决于您是否使用故事板。

[启用分页和缩放的 UIScrollView 图像/照片查看器](https://stackoverflow.com/questions/975708/uiscrollview-image-photo-viewer-with-paging-enabled-and-zooming)

基本上，一旦您将组件放在情节提要上。你写了一个类，它是一个scrollViewController。

您应该将图像加载到 UIImageView 中，您可以根据 URL 执行此操作

```
NSURL * imageURL = [NSURL URLWithString:@"http://192.168.1.2x0/pic/LC.jpg"];
NSData * imageData = [NSData dataWithContentsOfURL:imageURL];
UIImage * image = [UIImage imageWithData:imageData]; 
```

一旦你有了一个 UIImage 对象，你就可以调整它的大小等等。

您还需要一个 json 解析器。一旦你将数据解析成某种数据结构，你会很高兴:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T11:08:17.353

如果你收到的数据不可预测或非常大，我建议你使用 UITableView 而不是 UIScrollView。

在 UITableView 中，单元格被**重用**。因此，您不必担心 UIScrollView 的内存相关问题。

# nsis - nsis 作为其他安装的安装程序

> ID：12112153
> 
> 赞同：0
> 
> 时间：2012-08-24T15:15:29.593
> 
> 标签：nsis

我正在将 NSIS 用于其他安装的安装程序。复制所有需要的文件后，我运行它：

```
Section "Indusoft" SEC02
  SetOutPath $INSTDIR\DISK1
  ExecWait "$INSTDIR\DISK1\setup.exe"
SectionEnd

Section -Prerequisites
  SetOutPath $INSTDIR\Prerequisites
  MessageBox MB_YESNO "Install FTP Server?" /SD IDYES IDNO endFTPServer
    ExecWait "$INSTDIR\Prerequisites\FileZilla_Server-0_9_41"
    Goto endFTPServer
  endFTPServer:
  MessageBox MB_YESNO "Install MS SQL Server?" /SD IDYES IDNO endMSSQLServer
    ExecWait "$INSTDIR\Prerequisites\SQLEXPRWT_x86_ENU.exe"
    Goto endMSSQLServer
  endMSSQLServer:
SectionEnd 
```

现在我希望我的应用程序将运行已安装在 Indusoft 部分中的 exe。我的想法是打开一个对话框，用户在其中选择文件，然后创建用户选择的文件的快捷方式：

```
CreateShortCut "$SMPROGRAMS\My application\My application.lnk" "$INSTDIR\AppMainExe.exe" 
```

那可能吗？

谢谢

编辑：我发现选择了文件，但是这样我创建了一个在完成对话框之后出现的新页面，我怎样才能让它在完成之前出现？谢谢

```
Var Dialog
Var Text

Page custom nsDialogsPage

Function nsDialogsPage

    nsDialogs::Create 1018
    Pop $Dialog

    nsDialogs::SelectFileDialog
    Pop $Text

    ${NSD_CreateText} 0 13u 100% -13u $Text
    Pop $Text

    nsDialogs::Show

FunctionEnd 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:42:30.840

页面的显示顺序与源代码中的页面命令相同：

```
!insertmacro MUI_PAGE_INSTFILES
Page custom YourCustomPage
!insertmacro MUI_PAGE_FINISH 
```

# java - JSR 303 自定义约束消息

> ID：12112155
> 
> 赞同：2
> 
> 时间：2012-08-24T15:15:35.333
> 
> 标签：java, validation, spring-mvc

在 Spring MVC 应用程序上，我开发了一个自定义 JSR 303 约束，如下所示：

```
@Target({ElementType.FIELD, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = {})
@Pattern(regexp = EmailWithTld.PATTERN, flags = Pattern.Flag.CASE_INSENSITIVE)
public @interface EmailWithTld {

    static final String PATTERN = "(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])";

    String message() default "{springtest.constraints.EmailWithTld.message}";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

} 
```

问题是消息值被忽略，验证错误时显示的消息是来自@Pattern ("must match "(?:[a-z0-9!#$%&....." )

我期待它从消息变量返回我的消息。

我可以获得自定义消息的一种方法是将上面的@Pattern 替换为

```
@Pattern(message="{springtest.constraints.EmailWithTld.message}", regexp = EmailWithTld.PATTERN, flags = Pattern.Flag.CASE_INSENSITIVE) 
```

如果我这样做，则确实会显示正确的消息，前提是我使用资源包进行设置。如果通过注释用法设置，则不起作用。例子：

```
@Pattern(message="Testing 1 2 3}" 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:32:13.660

花了整整 3 个小时后，我通过查看 Hibernate Validator 源找到了答案，它实际上非常简单......

向该类添加 @ReportAsSingleViolation 注释。

这有效：

```
@Target({ElementType.FIELD, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = {})
@ReportAsSingleViolation
@Pattern(regexp = EmailWithTld.PATTERN, flags = Pattern.Flag.CASE_INSENSITIVE)
public @interface EmailWithTld {

    static final String PATTERN = "(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])";

    String message() default "{springtest.constraints.EmailWithTld.message}";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

} 
```

# asp.net - 在项目很少的解决方案中放置 xml 的最佳位置

> ID：12112157
> 
> 赞同：0
> 
> 时间：2012-08-24T15:15:39.843
> 
> 标签：asp.net, asp.net-mvc-3, project-management

我有以下解决方案结构：

Portal.DataAccess -> 具有针对数据库的方法的类库项目...

Portal.DomainEntities -> 类库项目（我有我的存储类）

Portal.Business -> 类库（前端和数据访问之间的代理）

Portal.Web -> 引用 Web 上下文的类库（system.web.mvc 等...）

Portal.Web.Website1 -> 我的网站 1

Portal.Web.Website2 -> 我的网站 2

……

Portal.Web.WebsiteN -> 我的网站 N

我所有的网站都使用相同的查询，我想创建一个具有以下结构的文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<Queries>
      <Query>
        <Name>DetailArticle</Name>
        <Value>
          <![CDATA[
             select * from Articles where ID={ID}
          ]]>
        </Value>
 ..... All my queries here
</Queries> 
```

您认为将这个将被反序列化以供使用的 xml 文件放在哪里最好？我认为将它作为嵌入式资源放入 Portal.DataAccess 可能会很好，但我的问题是我不想每次想要查询时都访问磁盘。此外，这个项目不包含对 WebContext 的引用（所以我不能把它放在缓存中）。出于这个原因，我想把这个文件放在 Portal.Web 上，这是一个对所有网站都有共同功能的项目。

你有什么建议？有没有其他地方（除了网络缓存）来放置 xml 的反序列化类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:36:55.163

我认为最好的地方是数据访问项目。此外，您可以不直接将此文件添加到所有其他项目，而是使用 [“添加为链接”](https://stackoverflow.com/a/9770061/1081246)选项。它只允许您在一个地方更改内容，所有更改将自动在所有“相关”文件中完成。

此外，如果您希望在应用程序工作期间将此查询保留在内存中，那么将文件放在目录的根目录并实现简单的静态类是合理的，它将在应用程序启动时读取此查询，然后使用此类读取您需要从内存中查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T06:10:50.393

首先，**使用 xml 文件存储查询有什么好处**？大多数时候，查询是静态的，并且会随着代码的变化（新功能、错误修复等）而变化。

也就是说，您为什么不简单地在代码中编写查询，直接在使用方法中或在专用的 const 类中（在 DataAccess 项目中）：

```
public sealed class Queries
{
    public const string Query1 = "SELECT ...";
    public const string Query2 = "SELECT ...";
} 
```

或者，您可以将 xml 作为资源文件附加并直接读取（而不是从磁盘读取）。

如果确实需要从文件中读取，可以执行一次反序列化操作：

```
public class Query
{
    public string Name { get; set;}
    public string Body { get; set;}
}

public static class QueryProvider
{
    private static readonly Dictionnary<string, Query> m_Queries;

    static QueryProvider()
    {
        m_Queries = ReadTheFile(); // A method that read the files and build the dictionnary
    }

    public static Dictionnary<string, Query> Queries{ get; set;}
} 
```

最后，如果将文件放入缓存以便能够定期读取它，您可以使用一些 IOC 模式为底层提供缓存提供程序。

# algorithm - 从 clrs 书中计算算法的复杂度

> ID：12112159
> 
> 赞同：1
> 
> 时间：2012-08-24T15:15:52.417
> 
> 标签：algorithm, sorting

```
 //Number of times 
for j=2 to A.length`          //n
    key = A[j]      //n-1
    i=j-1         //n-1
    while i>0 and A[i]>key    //summation of j from 2 to n of t(j) 
       A[i+1]= A[i]        //summation from j from 2 to n of t(j)-1
       i=i-1               //ditto
    A[i+1]=key   //n-1 
```

我不明白的是为什么第一个 for one 的时间数是 n 而不是 n-1？以及为什么它来自while循环中的t（j）vs t（j）-1的总和。我知道这真的没关系，因为它们是常数，但它仍然让我感到困惑。谢谢！这是来自 CLRS 算法教科书。插入排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:41:41.740

对于 for 循环，例如：

```
for(int j = 2; j < 4; j++) {} 
```

条件`j < 4`需要测试3次：当j=2、j=3、j=4时。循环体只会运行 2 次：当 j=2 和 j=3 时。最后的“假”条件算作额外测试。

# c# - 如何验证 string.Format 方法的格式

> ID：12112160
> 
> 赞同：11
> 
> 时间：2012-08-24T15:16:03.723
> 
> 标签：c#, string.format

string.Format 具有以下方法签名

```
string.Format(format, params, .., .. , ..); 
```

我想每次都传递自定义格式

```
string custFormat = "Hi {0} ... {n} ";   // I only care about numbers here, and want avoid  {abdb}
string name = "Foo";

string message = ProcessMessage(custFormat, name);

public string ProcessMessage(custFormat, name)
{
   return string.Format(custFormat, name);
} 
```

我想在传递给 ProcessMessage 之前验证 custFormat 中的值以避免异常。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-24T15:57:36.890

让我们考虑一下这个 API，如果它存在的话。目标是预先验证格式字符串，以确保`String.Format`不会抛出。

请注意，任何**不**包含有效格式槽的字符串都是有效的格式字符串 - 如果您不尝试插入任何替换。

-> 所以我们需要传入我们希望替换的数字或参数

请注意，有大量不同的专业格式模式，每种格式都有特定类型的特定含义：http: [//msdn.microsoft.com/en-us/library/system.string.format.aspx](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

尽管如果您传递与您的参数类型不匹配的格式字符串似乎`String.Format`不会抛出，但在这种情况下格式化程序变得毫无意义。例如`String.Format("{0:0000}", "foo")`

-> 因此，只有当您也传递了参数的类型时，这样的 API 才会真正有用。

如果我们已经需要传入我们的格式字符串和一个类型数组（至少），那么我们基本上处于 的签名处`String.Format`，那么为什么不直接使用它并处理异常呢？如果存在类似的东西会很好`String.TryFormat`，但据我所知，它没有。

此外，通过一些 API 进行预验证，然后重新验证`String.Format`本身并不是理想的性能。

我认为最干净的解决方案可能是定义一个包装器：

```
public static bool TryFormat(string format, out string result, params Object[] args)
{
   try
   {
      result = String.Format(format, args);
      return true;
   }
   catch(FormatException)
   {
      return false;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:23:23.247

只要您只传入 1 个参数，您就可以查找 search `custFormat`for `{0}`。如果你没有找到它，它是无效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:23:48.600

您可以使用 try catch 进行验证，如果格式抛出异常，则记录信息并停止处理。

```
try 
{ 
   string.Format(custFormat, params, .., .. , ..);
}
catch(FormatException ex)  
{ 
  throw ex;
}

string message = ProcessMessage(custFormat, name); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-24T15:23:08.403

您应该使用正则表达式进行语法检查，也可以使用一些语义检查。

正则表达式应该是：`(*{\d+}*)+`

# c++ - 多边形中的内部点

> ID：12112161
> 
> 赞同：1
> 
> 时间：2012-08-24T15:16:12.603
> 
> 标签：c++, c, computational-geometry

我必须找到多边形中的所有内部点。我使用以下函数来检查每个点 (x,y)，但对于某些点，即使该点位于外部或位于多边形的边缘，也会返回 true。

```
bool IsInside(int no_vert,float *vertx, float *verty, float testx, float testy)
{
  int i;
  int j;
  bool c=false;
  for (i = 0, j = no_vert-1; i < no_vert; j = i++) 
  {
      if ( ((verty[i]>testy) != (verty[j]>testy)) && (testx < (vertx[j]-vertx[i]) * (testy-verty[i]) / (verty[j]-verty[i]) + vertx[i]) )
      {
         c = true;
      }
  }
  return c;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:55:51.393

你想做的不是测试

```
testx < (vertx[j]-vertx[i]) * (testy-verty[i]) / (verty[j]-verty[i]) + vertx[i]) 
```

但关系保持不变（即总是`<`或总是`>`）。

做到这一点的常见方法是（未经测试，不需要特殊情况下的平等）

```
bool result = true;
bool sign = ((xt-x[n-1])*(y[0]-y[n-1]) < (yt-y[n-1])*(y[0]-y[n-1]));
for (i = 0; result && i < no_vert; i++) 
{
   if (sign != ((xt-x[i])*(y[i]-y[i-1]) < (yt-y[i-1])*(y[i]-y[i-1]))
      result = false;
}
return result; 
```

顺便说一句，这仅适用于**凸**多边形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:28:55.083

您的问题可能由于舍入错误而发生。即使一个点位于多边形的边缘（或非常靠近边缘但仍在外部），您确定它是否在内部的方法由于使用有限精度而受到数值误差的影响。换句话说，在这样的测试中得到错误答案是正常的（我建议你阅读浮点运算）。

我建议您不要严重依赖这种类型的精确验证，而是编写代码并开发可以处理这种误报/否定的算法。这种东西在计算几何中无处不在。

**编辑：**我认为另一个可能的错误是你应该有`c = !c`而不是`c = true`在`if`块内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T16:05:04.180

我看不出您的算法如何作为多边形测试中的一般点工作。

在这里查看工作算法： [如何确定 2D 点是否在多边形内？](https://stackoverflow.com/questions/217578/point-in-polygon-aka-hit-test)

# android - 平板电脑的安卓开发

> ID：12112166
> 
> 赞同：0
> 
> 时间：2012-08-24T15:16:31.900
> 
> 标签：android, tablet

我是 Android 开发的新手。您能否建议一些资源（电子书、博客、教程……）供我参考有关平板电脑的 Android 应用程序开发？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:19:45.520

现在在手机和平​​板电脑上的 android 编程几乎是一样的。网上有很多教程。我从中学习的一个是 Markana 训练营，只需在 youtube 上搜索即可。你会找到你的要求

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:21:13.100

很简单：

[安卓培训](http://developer.android.com/training/index.html)

Android 培训将带您完成一切，从设置编程环境到更复杂的事情。

手机和平板电脑的开发没有区别。

我有一个旨在同时针对两者的应用程序。代码没有变化。您可能有自定义布局，但通常没有必要。代码仍然是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:35:04.650

在我看来，最好的起点是 Google 的[API 指南](http://developer.android.com/guide/components/index.html)。手机和平板电脑的开发组件也有一些细微的差别。（我相信片段主要是为平板电脑设计的），但方法大致相同。

# cloudbees - cloudbees 蜜蜂 SDK 代理

> ID：12112171
> 
> 赞同：0
> 
> 时间：2012-08-24T15:16:54.637
> 
> 标签：cloudbees

这周我发现了 CloudBees……干得好！

我在企业防火墙后面的 Vista 工作站上使用 cloudbees SDK 1.2.1。我还在使用 cloudbees eclipse 工具包插件 1.0.5.20xxx 和所有东西。我已经在 eclipse (Indigo) 中配置了我的代理参数，还使用所有必要的键配置了我的 .bees/.bees.config 文件。

目前，我成功地从 eclipse 到 dev@cloud 从头创建了两个完整的简单 hello world 演示项目，但是我无法从 eclipse 部署到 run@cloud，因为我尝试部署时总是收到错误消息。使用 eclipse，这个错误是一个带有“发生错误”标题的弹出窗口，只有一个“api.cloudbees.com”消息，仅此而已。请注意，在我的 Eclipse 错误视图中，我每隔 2 分钟就会默默地遇到此错误消息，而且我从未成功在 Eclipse cloudBees 视图中刷新 RUN@cloud Tomcat 应用程序。eclipse 的其他一切似乎都可以（使用 cloudbees 平台中的 SVN 存储库提交，从 eclipse 访问 jenkins 构建等都可以）。

我对 CLI SDK 有另一个症状，我怀疑是同一来源，可能与企业代理有关。我无法创建任何本地应用程序，因为我总是收到错误消息：

```
C:\cloudbees-sdk-1.2.1>bees create kiki
loading remote template: basic
Downloading CloudBees SDK configuration from http://cloudbees-downloads.s3.amazo
naws.com/sdk/cloudbees-sdk-config.xml

ERROR: Unable to download required resource http://cloudbees-downloads.s3.amazon
aws.com/sdk/cloudbees-sdk-config.xml 
```

这意味着在使用 GrandCentral 创建任何新应用程序后，我无法使用 CLI SDK 在我的工作站上获取工作区来对其进行修改并将其推送到云上。而且我无法使用 Eclipse 进行部署。

尽管如此，在代理背后，我成功地使用 CLI SDK 停止/启动云上的应用程序，从应用程序获取信息等等。这意味着我的 bees 命令在我的企业代理后面工作，但不适用于某些 bees 命令。为了确定配置文件格式，我在家中使用没有代理的 SDK 生成一个包含所有密钥的新配置文件，并附加了四个特定密钥用于代理连接。我可以使用企业防火墙后面的浏览器访问 cloudbees-sdk-config.xml。最后，在家中使用相同的工作站，使用 CLI SDK 一切正常。

如果有人云帮助我，将不胜感激，非常感谢......</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-10T21:22:51.833

昨天我也遇到了同样的问题：

[从http://cloudbees-downloads.s3.amazonaws.com/sdk/cloudbees-sdk-config.xml](http://cloudbees-downloads.s3.amazonaws.com/sdk/cloudbees-sdk-config.xml)下载 CloudBees SDK 配置

我发现解决方案是（暂时）禁用我的诺顿防火墙。现在我的命令在 SDK 窗口命令上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T12:37:42.970

目前为 SDK 设置 http 代理存在问题，但是您应该能够通过为 BEES_OPTS 设置环境变量来根据 JVM 进行代理设置。

所以像：

```
BEES_OPTS="-Dhttp.proxyHost=proxyhostURL -Dhttp.proxyPort=proxyPortNumber  -Dhttp.proxyUser=someUserName -Dhttp.proxyPassword=somePassword" 
```

# python - 保存视图和表单集时遇到问题

> ID：12112172
> 
> 赞同：1
> 
> 时间：2012-08-24T15:16:55.697
> 
> 标签：python, django, django-forms, django-views

我在保存视图和表单集方面遇到了最艰难的时期。我开始意识到视图是我在 Django 中的弱点。在过去的几个月里，我一直在研究这个，并编写和重写代码。我知道这是最好的学习方式。幸运的是，我的团队给了我这个项目来学习。但我仍然不知道我哪里出错了。

如果这里有人看到我的出发点或指出我正确的方向，我将不胜感激。我正在寻找最好的资源来在这个领域变得更强大。

这是我的观点：

```
from django.conf import settings
from django.views.generic import View
from django.views.generic import TemplateView
from django.shortcuts import render
from itertools import chain

from .models import *
from .forms import *
from .emailtemplates import OrderFormNotification

class OrderFormProcessor(object):
    def __init__(self, contact=None, contact_form_class=ContactForm,
        letterhead_form_class=LetterHeadFormSet,
        windowenv_form_class=WindowEnvFormSet,
        numbertenenv_form_class=NumberTenEnvFormSet,
        ninebytwelveenv_form_class=NineByTwelveEnvFormSet,
        tenbythirteenenv_form_class=TenByThirteenEnvFormSet,
        businesscard_form_class=BusinessCardFormSet,
        send_notification=False):
    self.contact_form_class = contact_form_class
    self.letterhead_form_class = letterhead_form_class
    self.windowenv_form_class = windowenv_form_class
    self.numbertenenv_form_class = numbertenenv_form_class
    self.ninebytwelveenv_form_class = ninebytwelveenv_form_class
    self.tenbythirteenenv_form_class = tenbythirteenenv_form_class
    self.businesscard_form_class = businesscard_form_class
    self.send_notification = send_notification
    self.contact = contact

def process(self, request, context=None):
    if not context:
        context = {}

    contact = self.contact

    data = request.POST or None

    contact_form = self.contact_form_class(data,
            instance=contact)

    forms = dict(
        contact_form=contact_form,
    )

    formsets = dict(
        letterhead_formset=self.letterhead_form_class(data,                 prefix='letterhead_'),
        windowenv_formset=self.windowenv_form_class(data, prefix='windowenv_'),
        numbertenenv_formset=self.numbertenenv_form_class(data, prefix='numbertenenv_'),
        ninebytwelveenv_formset=self.ninebytwelveenv_form_class(data, prefix='ninebytwelveenv_'),
        tenbythirteenenv_formset=self.tenbythirteenenv_form_class(data, prefix='tenbythirteenenv_'),
        businesscard_formset=self.businesscard_form_class(data, prefix='businesscard_'),
    )

    if request.method == 'POST':
        form_is_valid = all([f.is_valid() for f in forms.values() + \
                formsets.values()])
        if form_is_valid:
            contact = forms['contact_form'].save(commit=False)

            contact.letterhead_form = formsets['letterhead_formset'].save()
            contact.windowenv_form = formsets['windowenv_formset'].save()
            contact.numbertenenv_form = formsets['numbertenenv_formset'].save()
            contact.ninebytwelveenv_form = formsets['ninebytwelveenv_formset'].save()
            contact.tenbythirteenenv_form = formsets['tenbythirteenenv_formset'].save()
            contact.businesscard_form = formsets['businesscard_formset'].save()

            contact.save()

            if self.send_notification:
                email = OrderFormNotification(to=[settings.NO_REPLY_EMAIL_ADDRESS],
                extra_context=data)
                email.send()
        else:
            pass

    all_forms = chain(forms.values(), chain.from_iterable(formsets.values()))
    context = context.copy()
    context.update(forms.items() + formsets.items())
    context.update(
        error_list=list(chain.from_iterable([form.errors.values() for form in all_forms])),
    )

    return (forms, formsets), context

class OrderFormView(View):
    template_name = 'orderform.html'

    def dispatch(self, request, *args, **kwargs):
        processor = OrderFormProcessor(send_notification=True)

        (forms, formsets), context = processor.process(request)
        return render(request, self.template_name, context)

class ThankYou(TemplateView):
    template_name = 'thank-you.html' 
```

这是我的表格：

```
from django import forms
from django.forms import ModelForm, extras
from django.forms.models import modelformset_factory
from django.contrib.localflavor import us

from django.forms.widgets import RadioSelect, CheckboxSelectMultiple

from .models import *

class ContactForm(forms.ModelForm):
    address = forms.ChoiceField(required = True, widget=RadioSelect(), choices=ADDRESS_CHOICES,)
    class Meta:
        model = Contact

class LetterHeadForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = LetterHead
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class WindowEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = WindowEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class NumberTenEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = NumberTenEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class NineByTwelveEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = NineByTwelveEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class TenByThirteenEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = TenByThirteenEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class BusinessCardForm(forms.ModelForm):
    print_choices = forms.ChoiceField(required = True, widget=RadioSelect(), choices=PRINT_CHOICES)
    card_styles = forms.ChoiceField(required = True, widget=RadioSelect(), choices=CARD_CHOICES)
    card_mailing_address = forms.ChoiceField(required = True, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = BusinessCard
        widgets = {
            'contact': forms.HiddenInput,
        }

class RushOrderForm(forms.ModelForm):
    class Meta:
        model = RushOrder
        widgets = {
            'contact': forms.HiddenInput,
            'rush_order': forms.CheckboxInput,
            'in_hand_date': forms.extras.SelectDateWidget
        }

class OrderNoteForm(forms.ModelForm):
    class Meta:
        model = OrderNote
        widgets = {
            'contact': forms.HiddenInput,
            'add_note': forms.CheckboxInput,
            'notes': forms.Textarea
        }

LetterHeadFormSet = modelformset_factory(LetterHead,
    form=LetterHeadForm, extra=2, max_num=2)
WindowEnvFormSet = modelformset_factory(WindowEnv,
    form=WindowEnvForm, extra=2, max_num=2)
NumberTenEnvFormSet = modelformset_factory(NumberTenEnv,
    form=NumberTenEnvForm, extra=2, max_num=2)
NineByTwelveEnvFormSet = modelformset_factory(NineByTwelveEnv,
    form=NineByTwelveEnvForm, extra=2, max_num=2)
TenByThirteenEnvFormSet = modelformset_factory(TenByThirteenEnv,
    form=TenByThirteenEnvForm, extra=2, max_num=2)
BusinessCardFormSet = modelformset_factory(BusinessCard,
    form=BusinessCardForm, extra=2, max_num=2) 
```

以下是模型：

```
from django.db import models
from django.forms import ModelForm

from django.utils.translation import ugettext_lazy as _
from django.contrib.localflavor.us.models import PhoneNumberField

PRINT_CHOICES = (
    ('exact reprint', 'Exact Reprint'),
    ('reprint with changes', 'Reprint With Changes'),
    ('new', 'New')
)

QUANTITY_CHOICES = (
    ('1000', '1000'),
    ('2500', '2500'),
    ('5000', '5000')
)

CARD_QUANTITY_CHOICES = (
    ('250', '250'),
    ('500', '500'),
    ('1000', '1000')
)

CARD_CHOICES = (
    ('chef/black', 'Chef/Black'),
    ('executive/red', 'Executive/Red')
)

ADDRESS_CHOICES = (
    ('eisenhower', 'Eisenhower'),
    ('wheeler', 'Wheeler'),
)

class Contact(models.Model):
    first_name = models.CharField(max_length=100, help_text="First Name")
    last_name = models.CharField(max_length=100, help_text="Last Name")
    email_address = models.EmailField(max_length=275)
    address = models.CharField(max_length=10, choices=ADDRESS_CHOICES)

    def __unicode__(self):
        return "%s %s" % (self.first_name, self.last_name)

class BaseStationary(models.Model):
    contact = models.ForeignKey(Contact, related_name='%(class)s_related')
    address = models.CharField(max_length=10, choices=ADDRESS_CHOICES)
    quantity = models.CharField(max_length=4, choices=QUANTITY_CHOICES)

    class Meta:
        abstract = True

class LetterHead(BaseStationary):
    pass

class WindowEnv(BaseStationary):
    pass

class NumberTenEnv(BaseStationary):
    pass

class NineByTwelveEnv(BaseStationary):
    pass

class TenByThirteenEnv(BaseStationary):
    pass

class BusinessCard(models.Model):
    contact = models.ForeignKey(Contact, related_name='businesscards')
    card_first_name = models.CharField(max_length=100)
    card_last_name = models.CharField(max_length=100)
    title = models.CharField(max_length=100)
    print_choices = models.CharField(max_length=19, choices=PRINT_CHOICES)
    card_styles = models.CharField(max_length=12, choices=CARD_CHOICES)
    card_email_address = models.EmailField(max_length=275)
    office_phone_number = PhoneNumberField(_('main office phone number'),
        blank=True, null=True)
    toll_free_number = PhoneNumberField(_('toll free number'),
        blank=True, null=True)
    mobile_number = PhoneNumberField(_('mobile phone number'),
        blank=True, null=True)
    fax_number = PhoneNumberField(_('main office fax'),
        blank=True, null=True)
    card_mailing_address = models.CharField(max_length=10,
        choices=ADDRESS_CHOICES)
    card_quantity = models.CharField(max_length=3,
        choices=CARD_QUANTITY_CHOICES)

class RushOrder(models.Model):
    contact = models.ForeignKey(Contact, related_name='rushorders')
    rush_order = models.BooleanField()
    in_hand_date = models.DateField(blank=True, null=True)

class OrderNote(models.Model):
    contact = models.ForeignKey(Contact, related_name='ordernotes')
    add_note = models.BooleanField()
    notes = models.TextField() 
```

因此，我再次尝试将这些表单集保存到数据库中，这样管理员将保存固定订单以用于打印目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:34:44.170

由于您是来这里学习的，而且您的代码非常复杂（我需要重现您的问题所需的**所有**代码，其中包括模型），所以我不会用代码修复来回答。

相反，您将学习如何使用调试器，它将修复“我仍然不知道我哪里出错了”。

1.  **安装 ipdb**，因为它比 pdb 更方便，`pip install ipdb`.

2.  **设置断点**，在你看来，添加这一行`import ipdb; ipdb.set_trace()`。

3.  **运行 devserver 中的代码**，devserve 应该在断点处暂停，并显示它暂停的代码。

4.  **了解 ipdb**，键入“h”，它会显示命令列表，请尝试阅读每个命令的文档，您也可以查看包含视频的[这篇文章。](http://www.gregaker.net/2012/apr/05/debugging-python-with-pdb-or-ipdb/)

5.  **单步执行您的代码**，通过在调试器中键入“n”，解释器应该移动到下一行代码，“d”进入，“u”退出，等等......您可以从提示符执行 Python随时。

你会知道 Python 到底在做什么，修复“我仍然不知道我哪里出错了”。还有，你会成为一个无敌的程序员（或者类似的哈哈哈）

# c# - 如何在c#中更改按钮的背景颜色

> ID：12112180
> 
> 赞同：0
> 
> 时间：2012-08-24T15:17:27.283
> 
> 标签：c#, background-color

我在 DataGrid 中有很多按钮

我想根据我的 if 条件将 Button 的颜色设置为绿色，并将 Button.Text 设置为白色（不是全部，仅适用于 1 个按钮）我已经使用 ITextSharp 来创建 PDF 生成，我评论了我得到的 iTextSharp 头文件结果，但这次发生以下错误时，我的代码中必须需要 iTextSharp。

“无法将 iTextSharp.text.Color 类型隐式转换为 System.Drawing.Color”

这是我的 iTextSharp 头文件

```
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html; 
```

这是代码

```
 if (dsRecAdj.Tables[2].Rows.Count > 0)
                {

                    Button btn = (Button)e.Row.FindControl("btnSalvage");
                    btn.ForeColor = Color.Red;

                } 
```

一些身体请帮助我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:22:24.207

您正在引用`Color`iTextSharp.text 命名空间中的类型。尝试明确指定命名空间：

```
btn.ForeColor = System.Drawing.Color.Red; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:20:36.750

您可以使用 Button.BackColor 属性

例子 ：

```
btn.BackColor = Color.Green; 
```

***更正：*** OP的问题标题具有误导性，以上内容基于此所以问题正文中解释的答案将与OP给出的相同

`btn.ForeColor = Color.Red;`//看不出这不起作用的原因

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-18T19:31:04.760

要更改背景颜色，请使用：

```
Button1.BackColor = Color.Red; 
```

要更改前景色，请使用：

```
Button1.ForeColor = Color.Red; 
```

您可以将它们都用于 MouseMove 事件。

要重置它们，请使用带有以下代码的 MouseLeave 事件：

```
Buttton1.BackColor = SystemColors.ButtonFace;
Button1.ForeColor = default(Color);
Button1.UseVisualStyleBackColor = true; 
```

# powershell - 如何从命令提示符或批处理文件将具有长名称的组添加到本地组？

> ID：12112182
> 
> 赞同：8
> 
> 时间：2012-08-24T15:17:38.030
> 
> 标签：powershell, batch-file, active-directory

尝试添加名称超过 20 个字符的全局组时，`net.exe`我收到一条错误消息，指出语法不正确，如下所示：

```
C:\>NET.EXE localgroup MyRemoteUsers "really-long-group-name-here" /ADD

The syntax of this command is:

NET LOCALGROUP [groupname [/COMMENT:"text"]] [/DOMAIN]
groupname {/ADD [/COMMENT:"text"] | /DELETE}  [/DOMAIN]
groupname name [...] {/ADD | /DELETE} [/DOMAIN] 
```

[微软在此处记录了](http://support.microsoft.com/kb/324639)此问题。我需要这个在标准的 .cmd 批处理文件中工作。有简单的解决方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T15:17:38.030

您可以在批处理文件中使用 powershell，如下所示：

```
powershell -command "& { ([adsi]'WinNT://./your-local-group,group').Add('WinNT://YOURDOMAIN/your-really-long-global-group-name,group'); }" 
```

上面的技巧之一是对整个命令使用双引号，而在命令中使用单引号。这允许您`cmd.exe`在 .bat/.cmd 文件中或在其中运行语句。

# r - 对数据框属性的逻辑测试如何导致 NA 行

> ID：12112184
> 
> 赞同：2
> 
> 时间：2012-08-24T15:17:39.397
> 
> 标签：r

我有一个形式的数据框：

```
>df
stationid    station      gear sample     lat    lon       date depth
1     25679          CORBOX150    UE4 53.9015 7.8617 15.07.1987    19
2     25681 UE9 Kern CORCRB050    UE9 54.0167 7.3982 15.07.1987    33
3        NA                           54.0167 7.3982 15.07.1987    33 
```

一个合乎逻辑的测试 `stationid`给了我，在正确的第一行旁边，一个充满 NA 的恼人的行：

```
> df[df$stationid=="25679",]
stationid station      gear sample     lat    lon       date depth
1      25679         CORBOX150    UE4 53.9015 7.8617 15.07.1987    19
NA        NA    <NA>      <NA>   <NA>      NA     NA       <NA>    NA 
```

这是为什么？

我想，在第 3 行的某个地方`df`，事情变得一团糟。

数据如下：

```
df<-structure(list(stationid = c(25679L, 25681L, NA), station = structure(c(2L, 
3L, 1L), .Label = c("", " ", "UE9 Kern"), class = "factor"), 
gear = structure(c(2L, 3L, 1L), .Label = c("", "CORBOX150", 
"CORCRB050"), class = "factor"), sample = structure(c(2L, 
3L, 1L), .Label = c("", "UE4", "UE9"), class = "factor"), 
lat = c(53.9015, 54.0167, 54.0167), lon = c(7.8617, 7.3982, 
7.3982), date = structure(c(1L, 1L, 1L), .Label = "15.07.1987", class = "factor"), 
depth = c(19L, 33L, 33L)), .Names = c("stationid", "station", 
"gear", "sample", "lat", "lon", "date", "depth"), class = "data.frame", row.names = c(NA, 
-3L)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:24:28.637

任何比较都会`NA`导致结果`NA`（参见[http://cran.r-project.org/doc/manuals/R-intro.html#Missing-values](http://cran.r-project.org/doc/manuals/R-intro.html#Missing-values)）......您可以使用

```
df[df$stationid==25679 & !is.na(df$stationid),] 
```

或（如上面评论中所建议的）

```
df[which(df$stationid==25679),] 
```

或者

```
subset(df,stationid==25679) 
```

（`subset`有时会产生不必要的副作用，即删除`NA`值，但在这种情况下，这正是您*想要*的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:24:06.967

另一种解决方案是`df[df$stationid==25679 & !is.na(df$stationid),]`. 更长但更明确。

# php - imagejpeg 两次导致脚本错误输出“垃圾”

> ID：12112185
> 
> 赞同：0
> 
> 时间：2012-08-24T15:17:43.380
> 
> 标签：php

我正在尝试学习如何拍摄上传的图像并创建两个调整大小的副本。我可以很好地创建一个调整大小的副本。

```
list($width,$height,$type) = getimagesize($file);
  if($width>90){
    $asprat = 90 / $width;
$thbwid = round($asprat * $width);
    $thbhei = round($asprat * $height);
$asprat = 800 / $width;
$optwid = round($asprat * $width);
$opthei = round($asprat * $height);
  }
  elseif($height>90){
    $asprat = 90 / $height;
$thbwid = round($asprat * $width);
$thbhei = round($asprat * $height);
$asprat = 600 / $width;
$optwid = round($asprat * $width);
$opthei = round($asprat * $height);
  }
  else{
    $thbwid = $width;
$thbhei = $height;
$optwid = $width;
$opthei = $height; 
  }
  $thbout = imagecreatetruecolor($thbwid,$thbhei);
  $optout = imagecreatetruecolor($optwid,$opthei);
  if($type==2){
    $thbsrc = imagecreatefromjpeg($TARGET_PATH);
imagecopyresampled($thbout,$thbsrc,0,0,0,0,$thbwid,$thbhei,$width,$height);
imagejpeg($thbout,$thbpath,80);
imagedestroy($thbout);
    /* IF THIS CODE IS OMITTED IT WORKS FOR CREATING A SINGLE IMAGE
$optsrc = imagecreatefromjpeg($TARGET_PATH);
    imagecopyresampled($optout,$optsrc,0,0,0,0,$optwid,$opthei,$width,$height);
imagejpeg($optout,$optpath,80);
imagedestroy($optout);
    */
  }
  else{
    $imgsrc = imagecreatefrompng($TARGET_PATH);
imagecopyresampled($thbout,$imgsrc,0,0,0,0,$thbwid,$thbhei,$width,$height);
imagepng($thbout,$thbpath,2);
imagedestroy($thbout);
    /* IF THIS CODE IS OMITTED IT WORKS FOR CREATING A SINGLE IMAGE
    imagecopyresampled($optout,$imgsrc,0,0,0,0,$optwid,$opthei,$width,$height);
imagepng($optout,$optpath,2);
imagedestroy($optout);
    */
  } 
```

运行时（没有评论）我看到了输出。谁能帮我这个？

```
����JFIF��;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 80 ��C  %# , #&')*)-0-(0%()(��C   (((((((((((((((((((((((((((((((((((((((((((((((((((��� "�� ���}!1AQa"q2���#B��R��$3br� %&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������� ���w!1AQaq"2�B���� #3R�br� $4�%�&amp;'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������?Ԉ;t9ڞpy�:� ���p ��T�Ȥ�%U�+���*��ד��? Q���A\���E$�i=�N�xG�W9�~� ��h�y��:5��.H�3�� 2�$�{�⦀<�UJw#s�ׁ@�7�)Wy88'�"�$��ҩ���hO���T�%rhp�G�J��dg��?��sS23��qN*�h ��B�8��z��w�� r.㌐Gz�dV�=x50�#�?���� ~���)[���,Ӗ_�~��Q�@ۚb#���ʬ"wbK悥��4܀Ys�E>U"p7��? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:20:35.207

运行第二个 imagejpeg 时 $optpath 的值是多少？如果它未设置/为空，则 imagejpeg() 将简单地将原始 JPEG 数据输出到浏览器，这就是您所看到的。如果您`header('Content-type: image/jpeg')`在 imagejpeg 调用之前包含了 a ，那么您实际上可能会自己看到图片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:21:23.283

在脚本顶部添加此代码：

```
header('Content-Type: image/jpeg'); 
```

文档：[标题](http://php.net/header) [imagejpeg](http://php.net/imagejpeg)

# linux - 在 Tomcat 中更改时区

> ID：12112188
> 
> 赞同：10
> 
> 时间：2012-08-24T15:17:50.697
> 
> 标签：linux, tomcat, solr, timezone, centos

如何更改 Tomcat 中的时区？其中一个 webapps (Solr) 使用的时区不正确*（与 MySQL 时间戳相比）*，我认为更改 Tomcat 的时区会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-24T15:48:22.977

除非 tomcat 有个人 TZ 环境变量，否则它`/etc/localtime`在我的系统上使用的是`/usr/share/zoneinfo/America/New_York`.

Tomcat 的个人时区将在其启动脚本中以如下形式指定：

```
-Duser.timezone=GMT 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-03-12T05:14:34.927

这是我在开始时`catalina.sh`（在shabang之后）添加的内容以更改tomcat的时区：

```
TOMCAT_TIMEZONE="-Duser.timezone=Europe/Budapest"
CATALINA_OPTS="$CATALINA_OPTS $TOMCAT_TIMEZONE" 
```

并且不要忘记重启tomcat才能生效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-11T10:05:29.003

正如埃里克王所说，你可以使用

```
TOMCAT_TIMEZONE="-Duser.timezone=Europe/Budapest"
CATALINA_OPTS="$CATALINA_OPTS $TOMCAT_TIMEZONE" 
```

但是在 CentOS 服务器上，我没有找到 catalina.sh，而是将这些变量添加到 /etc/sysconfig/tomcat6，这很有效！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:59:33.283

如果您指的是存储在 Solr 中的数据的时区... Solr 中的所有日期/时间值都通过使用 UTC的[DateField存储。](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/schema/DateField.html)

# performance - groovy 'switch' 与 'if' 性能

> ID：12112189
> 
> 赞同：8
> 
> 时间：2012-08-24T15:17:59.670
> 
> 标签：performance, groovy, switch-statement

我知道在 Java 中，当你有少数情况时不应该使用*switch*`if else if`语句，在这种情况下最好使用.

groovy 也是如此吗？

这两个代码之间哪个性能更高？

```
myBeans.each{
    switch it.name
    case 'aValue':
        //some operation
    case 'anotherValue:
        //other operations
} 
```

或者：

```
myBeans.each{
    if(it.name == 'aValue'){
        //some operation
    }
    else if (it.name =='anotherValue){
        //other operations
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-24T17:50:05.913

在 Java 中，“switch”比串行 if 块更有效，因为编译器会生成一个[tableswitch](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.tableswitch)指令，其中可以从跳转表中确定目标。

在 Groovy 中，switch 不限于整数值，并且具有许多附加语义，因此编译器无法使用该功能。编译器会生成一系列比较，就像它对串行 if 块所做的那样。

但是，`ScriptBytecodeAdapter.isCase(switchValue, caseExpression)`每次比较都会调用。这始终是`isCase`对 caseExpression 对象上的方法的动态方法调用。该调用可能比`ScriptBytecodeAdapter.compareEqual(left, right)`if 比较调用的调用更昂贵。

所以在 Groovy 中，switch 通常比串行 if 块更昂贵。

# c# - Linq 检索索引

> ID：12112191
> 
> 赞同：1
> 
> 时间：2012-08-24T15:18:02.770
> 
> 标签：c#

我需要在 Linq 中选择项目时检索项目的索引，这是最好的方法吗？我不喜欢我必须在我的 Linq 语句之外声明一个变量的事实。

```
List<int> ApplianceIds = new List<int>();
ApplianceIds.Add(6);
ApplianceIds.Add(3);
ApplianceIds.Add(4);
ApplianceIds.Add(5);
ApplianceIds.Add(6);
ApplianceIds.Add(7);
ApplianceIds.Add(2);

int ind = 0;

var y = (from a in ApplianceIds
        let index = ind++
        select new {Appliance = a, Index = index}).ToList(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T15:18:29.917

我会这样做；

```
var y = ApplianceIds.Select ((a,i) => new { Appliance = a, Index = i } ).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:23:43.373

ApplianceIds 是一个列表，您已经有了索引。您可以使用 for 循环。

```
for (int i=0; i<ApplianceIds.Count; i++)
{
    // i is your index
} 
```

# drupal - Drupal - Webforms as Block - 修改操作

> ID：12112194
> 
> 赞同：0
> 
> 时间：2012-08-24T15:18:09.903
> 
> 标签：drupal, drupal-webform

我正在使用 Drupal 7.15，并将 Webform 设置为包含在联系人页面（基本页面）中的块。基本的联系人页面具有可编辑的侧边栏内容，然后是 Webform 块作为主要内容。我遇到的问题是提交时，Webform 转到其自己的别名“general-inqueries”，而不是联系我们别名“contact-us”。我希望它返回到基本页面联系我们任何验证错误和/或确认消息。

似乎表单操作始终是 Webform 别名，但是当我尝试将别名更改为基本页面联系我们别名 (contact-us) 时，它说这个别名已经在使用中。

在不为错误或成功确认创建单独页面的情况下，如何修改操作以返回原始页面并提交任何消息？我不希望我们 JS 在事后设置表单动作。如果错误/成功消息没有传递给它，那甚至可能对我没有帮助。

如果您想看一下，这是测试服务器：

```
http://69.160.59.20/contact-us 
```

非常感谢任何和所有帮助！

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T05:14:10.860

可以使用 form_alter 挂钩设置表单操作。就像是：

```
my_module_form_alter($form, $form_state, $form_id) {
  if ($form_id == 'webform_id_form') {
    $form['#action'] = url('comment/reply/'. $edit['nid']);
  }
} 
```

如果您使用的是 Drupal 7，请跳过表单 id 检查并尝试：

```
my_module_form_form_id_alter($form, $form_state) {
} 
```

如果您不知道如何查找表单 id，只需使用上面的函数和 print 语句：

```
my_module_form_alter($form, $form_state, $form_id) {
  print($form_id);
} 
```

并且表单 id 将是其中包含单词 webform 的那个。

有关表单 api 的更多详细信息：http: [//api.drupal.org/api/drupal/developer%21topics%21forms_api_reference.html/7#action](http://api.drupal.org/api/drupal/developer%21topics%21forms_api_reference.html/7#action)

# python - 列表中的值，python

> ID：12112200
> 
> 赞同：4
> 
> 时间：2012-08-24T15:18:40.707
> 
> 标签：python, python-3.x

英语中的每个字符都有一个出现的百分比，这些是百分比：

```
A       B       C       D       E       F       G       H       I
.0817   .0149   .0278   .0425   .1270   .0223   .0202   .0609   .0697
J       K       L       M       N       O       P       Q       R
.0015   .0077   .0402   .0241   .0675   .0751   .0193   .0009   .0599
S       T       U       V       W       X       Y       Z   
.0633   .0906   .0276   .0098   .0236   .0015   .0197   .0007 
```

一个名为的列表`letterGoodness`预定义为：

```
letterGoodness = [.0817,.0149,.0278,.0425,.1270,.0223,.0202,... 
```

我需要找到一个字符串的“优点”。例如，'I EAT' 的优点是：.0697 + .1270 + .0817 + .0906 =.369。这是一个更大问题的一部分，但我需要解决这个问题才能解决这个大问题。我是这样开始的：

```
def goodness(message):
   for i in L:
     for j in i: 
```

因此，找出如何获得任何字符的出现百分比就足够了。你能帮助我吗？该字符串仅包含大写字母和空格。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T15:21:39.863

letterGoodness 作为字典更好，那么你可以这样做：

```
sum(letterGoodness.get(c,0) for c in yourstring.upper())
#                                             #^.upper for defensive programming 
```

要将`letterGoodness`您的列表转换为字典，您可以执行以下操作：

```
import string
letterGoodness = dict(zip(string.ascii_uppercase,letterGoodness)) 
```

如果你保证只有大写字母和空格，你可以这样做：

```
letterGoodness = dict(zip(string.ascii_uppercase,letterGoodness))
letterGoodness[' '] = 0
sum(letterGoodness[c] for c in yourstring) 
```

但是这里的性能提升可能非常小，所以我更喜欢上面更强大的版本。

* * *

如果您坚持保留`letterGoodness`为列表（我不建议这样做），您可以使用内置函数`ord`获取索引（cwallenpoole 指出）：

```
 ordA = ord('A')
 sum(letterGoodness[ord(c)-ordA] for c in yourstring if c in string.ascii_uppercase) 
```

我现在太懒了`timeit`，但是您可能还想定义一个临时集来保存`string.ascii_uppercase`-它可能会使您的函数运行得更快一些（取决于`str.__contains__`与相比的优化程度`set.__contains__`）：

```
 ordA = ord('A')
 big_letters = set(string.ascii_uppercase)
 sum(letterGoodness[ord(c)-ordA] for c in yourstring.upper() if c in big_letters) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:21:48.413

最好使用字典数据结构。

编辑：这不是我的原始代码，而是按照 DSM 建议的方式更新的代码。

```
import string

num_vals = [.0817, .0149, .0278, .0425, .1270, .0223, .0202, .0609, .0697 , .0015, .0077,
            .0402, .0241, .0675, .0751, .0193, .0009, .0599, .0633, .0906, .0276, .0098,
            .0236, .0015, .0197, .0007]

letterGoodness = {letter : value for letter,value in map(None, string.ascii_uppercase, num_vals)}

def goodness(message):
    string_goodness = 0
    for letter in message:
        letter = letter.upper()
        if letter in letterGoodness.keys():
            string_goodness += letterGoodness[letter]
    return string_goodness

print goodness("I eat") 
```

使用您提供的测试用例：

```
print goodness("I eat") 
```

产生输出：

```
.369 
```

需要注意的一件事 - 像这里所做的那样构建字典需要 Python 2.7+。在 Python 2.6+ 中可以使用`dict()`构造函数完成同样的事情。

# video-streaming - 检测 MPEG TS 流中的视频帧类型

> ID：12112201
> 
> 赞同：5
> 
> 时间：2012-08-24T15:18:42.017
> 
> 标签：video-streaming, frame, mpeg

我正在尝试提取有关 TS 数据包中帧类型的信息。使用 FFMEPG，我正在发送 MPEG TS 封装的视频（使用 x264 压缩），另一方面，我正在使用 Wireshark 记录接收到的数据包。我的数据包长 188 字节，对应一个 MPEG TS 数据包。现在我需要找出哪些 TS 数据包携带 I、P 或 B 帧数据。

我试图在我的数据（00 00 01 00）中检测图片标题，基于这篇文章：http: [//forum.digital-digest.com/f4/help-extract-i-frames-mpeg2-ts-89736.html](http://forum.digital-digest.com/f4/help-extract-i-frames-mpeg2-ts-89736.html) 但我找不到它。我只能注册 PES 数据包的开始（00 00 00 01 E0）。我对格式完全感到困惑。PES 的哪一部分说一个 TS 数据包传输哪种帧类型？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T16:58:31.113

只需以 ts 形式捕获所有内容并在其上运行 ffprobe。

ffprobe -show_frames 并在视频帧中查找 pict_type。编写一个小脚本来解析输出并为您提供输出。如果你懒得这样做

ffprobe -show_frames | grep pict_type | grep -n 我
应该直接给你帧号。

只要它是有效的视频文件，它将适用于任何格式。

# android - AsyncTask 的问题

> ID：12112202
> 
> 赞同：0
> 
> 时间：2012-08-24T15:18:48.897
> 
> 标签：android, android-asynctask

我尝试通过 AsyncTask 从 Web 服务获取一些数据，但它返回一个空响应并且需要很长时间才能连接。不想在这里放很多代码，但我认为这是解释我所做的更好的方式。这是我实现连接的类。

```
public class WebService extends AsyncTask<String, String, String> {
    private ArrayList<SimpleObserver> listeners;
    private int responseCode;
    private String message;
    private String response;

    public WebService() {
        listeners = new ArrayList<SimpleObserver>();
    }

    public void addListener(SimpleObserver obs) {
        listeners.add(obs);
    }

    public void removeListener(SimpleObserver obs) {
        listeners.remove(obs);
    }

    public void notifyListener(String s) {
        for (SimpleObserver listener : listeners)
            listener.onChange(s);
    }

    public String getResponse() {
        return response;
    }

    public String getErrorMessage() {
        return message;
    }

    public int getResponseCode() {
        return responseCode;
    }

    @Override
    protected void onPreExecute() {
        notifyListener("Calculating..");
    }

    @Override
    protected String doInBackground(String... urls) {
        String response = "";
        for (String url : urls) {
            DefaultHttpClient client = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(url);
            try {
                notifyListener("Execute");
                HttpResponse execute = client.execute(httpGet);
                InputStream content = execute.getEntity().getContent();
                notifyListener("Chegou aqui");

                BufferedReader buffer = new BufferedReader(
                        new InputStreamReader(content));
                String s = "";
                while ((s = buffer.readLine()) != null) {
                    response += s;
                }

            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        return response;
    }

    @Override
    protected void onPostExecute(String result) {
        notifyListener(result);
    }
} 
```

并打电话给我：

```
public class ServiceController implements SimpleObserver {
    private Activity act;
    private WebService s;
    private static final String URL = "my url with parameters";

    public ServiceController(MainActivity mainActivity) {
        act = mainActivity;
        s = new WebService();
        s.addListener(this);
    }

    public void onChange(String s) {
        ((MainActivity) act).getTextView().setText(s);
    }

    public void executeService() {
        try {
            s.execute(new String[] { URL });
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            System.out.println(e.getMessage());
        }
    }
} 
```

我正在测试我的应用程序，它给了我这个 HttpHostConnectException:Connection to 192.168.56.1:8080 denied 。Locat给我这个消息：

```
08-24 16:58:02.060: W/System.err(17595): org.apache.http.conn.HttpHostConnectException: Connection to http://192.168.56.1:8080 refused
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:183)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
08-24 16:58:02.075: W/System.err(17595):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
08-24 16:58:02.075: W/System.err(17595):    at com.example.pulldata.DS.WebService.doInBackground(WebService.java:68)
08-24 16:58:02.075: W/System.err(17595):    at com.example.pulldata.DS.WebService.doInBackground(WebService.java:1)
08-24 16:58:02.080: W/System.err(17595):    at android.os.AsyncTask$2.call(AsyncTask.java:264)
08-24 16:58:02.080: W/System.err(17595):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-24 16:58:02.080: W/System.err(17595):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-24 16:58:02.080: W/System.err(17595):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
08-24 16:58:02.080: W/System.err(17595):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-24 16:58:02.080: W/System.err(17595):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-24 16:58:02.085: W/System.err(17595):    at java.lang.Thread.run(Thread.java:856)
08-24 16:58:02.085: W/System.err(17595): Caused by: java.net.ConnectException: failed to connect to /192.168.56.1 (port 8080): connect failed: ETIMEDOUT (Connection timed out)
08-24 16:58:02.085: W/System.err(17595):    at libcore.io.IoBridge.connect(IoBridge.java:114)
08-24 16:58:02.085: W/System.err(17595):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
08-24 16:58:02.085: W/System.err(17595):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
08-24 16:58:02.085: W/System.err(17595):    at java.net.Socket.connect(Socket.java:842)
08-24 16:58:02.085: W/System.err(17595):    at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
08-24 16:58:02.085: W/System.err(17595):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
08-24 16:58:02.090: W/System.err(17595):    ... 15 more
08-24 16:58:02.090: W/System.err(17595): Caused by: libcore.io.ErrnoException: connect failed: ETIMEDOUT (Connection timed out)
08-24 16:58:02.090: W/System.err(17595):    at libcore.io.Posix.connect(Native Method)
08-24 16:58:02.090: W/System.err(17595):    at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
08-24 16:58:02.090: W/System.err(17595):    at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
08-24 16:58:02.090: W/System.err(17595):    at libcore.io.IoBridge.connect(IoBridge.java:112)
08-24 16:58:02.095: W/System.err(17595):    ... 20 more 
```

我搜索了这个问题的其他问题，他们都说这是由于缺乏互联网许可，但我的清单中有这个！我完全不明白！

我是android的新手，你能给我一些帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T06:17:00.147

我想下面的步骤会对你有所帮助。

# 1

如果清单中已授予**互联网**许可，那么问题是您可能不在主机（192.168.56.1:8080）所在的网络中......所以尝试连接到同一个网络......例如：我是假设这是一个私人 wifi，所以连接到该网络并关闭您的**数据包数据**。所以现在你可以连接到它了。

# 2

或者，如果您想通过其他网络连接到它，那么您必须访问该主机（192.168.56.1:8080）并要求您的网络管理员将其设为公共 url，以便您可以从任何地方访问它。

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:42:20.557

您确定您的应用正在发出适当的请求吗？您应该`HTTPResponse`使用方法`getStatusLine()`和`getStatusCode()`. 如果您的请求是正确的，您应该从`getStatusCode()`（即 a `HttpStatus.SC_OK`）获得 200 回。否则，请查看您的应用发出的请求是什么样的。

您可以使用诸如 netcat 之类的工具在您的 PC 上侦听端口并让应用程序连接到该端口，从而准确了解您的应用程序在其 GET 方法中发送的内容。

如果请求看起来一切正常，请尝试自己手动发送（您可以为此使用 netcat，或者有一个不错的 Firefox RESTClient 调试器插件）

如果这表明您正在取回数据，那么我怀疑您的问题在于您的缓冲阅读器。您可以使用`Log.d()`语句打印 logcat 语句，在代码中的各个点显示您的字符串值，以查看事情的进展情况

# matlab - Matlab代码片段的理解

> ID：12112206
> 
> 赞同：0
> 
> 时间：2012-08-24T15:19:04.723
> 
> 标签：matlab

[这是一个描述进化博弈中Moran过程](http://en.wikipedia.org/wiki/Moran_process)的基本程序，但是由于我对Matlab的了解有限，我很难快速理解代码的含义。有人可以帮我解释一下这是什么意思。

如果您查看代码，我会感到困惑。

1.  代码中的变量`state`是数组吗？
2.  if`state`是一个数组，这意味着什么`state(2,:), state(:,2), state(:)`
3.  在`unique`功能上，这句话是什么意思：`u(u((1:end-1)')==u((2:end)')) = [];`
4.  在`mnrnd`功能上，这句话是什么意思：`r = find(rand < cumsum(p),1);`
5.  是什么意思`frequency = histc(state(:,2), livingTypes)./length(state(:,2));`，特别是，`histc`？

这是功能：

```
function state = moranprocess(initialState, nSteps, tau)

    %# assume 1 step if not specified
    if(nargin < 2)
        nSteps = 1;
    end

    %# if it isn't specified, assume frequency indepdence.
    if(nargin < 3)
        tau = 0;
    end

    %# initialize with starting state
    state = initialState;

    %# perform the moran process
    for t = 1:nSteps
        state(selection(state, 0), :) = state(selection(state, tau), :);
    end
end

%# frequency dependent selection with parameter tau determining the 
%# strength of selection
function i = selection(state, tau)

    %# find all of the living types
    livingTypes = unique(state(:,2))';

    %# create a multinomial of living type frequencies.
    frequency = histc(state(:,2), livingTypes)./length(state(:,2));

    %#frequency = makemultinomial(state(:,2));
    fitness = (frequency.^tau)./sum(frequency.^tau);

    %# selection is proportional to fitnesss
    selected_type = livingTypes(mnrnd(1, (frequency.*fitness) ./ sum(frequency.*fitness)));

    %# choose randomly among those of the selected type
    thoseOfSelectedType = find(state(:,2) == selected_type);
    i = thoseOfSelectedType(ceil(length(thoseOfSelectedType)*rand));
end

%# fast unique 
function u = unique(x)    
 u = sort(x(:));    
 u(u((1:end-1)')==u((2:end)')) = []; 
end

%# fast mnrnd 
function r = mnrnd(n,p)
    r = find(rand < cumsum(p),1); 
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:50:33.687

1 它看起来好像`state`是一个变量和一个二维数组。如果您的桌面上有工作区窗口（即标题`Workspace`不是其他任何窗口的窗口），您应该能够双击变量名称并打开变量编辑器。

2`state(2,:)`表示二维数组的第 2 行`state`；`state(:)`使用有点令人困惑的（对初学者来说）Matlab 速记来表示*所有元素都* `state` *被视为一维向量，并且不要忘记 Matlab 以 column-major order 存储数组*。Matlab 可以将一维索引用于*大于*一维的数组。您应该能够弄清楚`state(:,2)`自己，如果没有，请玩弄；Matlab 的优势之一是它随时准备让你玩。

`u(u((1:end-1)')==u((2:end)')) = []`3只有当你试图同时接受它时，这种表达才会令人困惑。您可以稍加小心和关注来解决它。从内部开始：`(1:end-1)`表示*（在这种情况下为 vector* `u` *）的所有元素从第一个开始，一直到最后一个，但 one*。因此，如果`u`有 10 个元素，则此表达式选择 elements `1:9`。这`'`是 Matlab 的转置运算符，它将行向量转换为列向量（*反之亦然*）。由于它应用于两侧，`==`我不确定它在这里有什么用途，但可以尝试使用`(1:9)`and`(1:9)'`和类似的表达方式。

接下来，表达式`u((1:end-1)')==u((2:end)')`比较元素`u(1:end-1)`与元素的相等性，`u(2:end)`换句话说，它找到那些元素`u`与其邻居相同的情况。与 Matlab 中的其他布尔运算符一样，这​​将返回`0`for`false`和`1`for `true`—— 再次尝试诸如`1==1`and之类的操作`1==2`。这个表达式将返回 Matlab 所称的*逻辑索引*into `u`，也就是说，它将选择`u`评估为`true`(或`1`) 的那些元素。

最后，使用表达式`= []`Matlab 将空数组分配给`u`由逻辑索引选择的元素。此操作删除那些元素。

因此，如果我正确地弄清楚了这一点，则该语句将从`u`所有与前一个元素相同的元素中删除。

4 现在是时候做一些自己的工作了。`find`，`rand`并且`cumsum`都是有据可查的基本 Matlab 函数。正如我上面建议的那样，花一些时间弄清楚它们孤立地做什么，然后开始尝试它们的各种组合。与阅读更多这种胡言乱语相比，你会以这种方式更快地理解。

# javascript - 在按键功能上将文本框值传递给javascript

> ID：12112211
> 
> 赞同：1
> 
> 时间：2012-08-24T15:19:21.600
> 
> 标签：javascript, asp.net

在这里，我已将文本控件传递给 java 脚本函数，但我只想将文本框的值传递给 java 脚本函数，而不是 onkeyup。

```
function Changed(textControl) {
    var _txtEmpName = document.getElementById('<%=txtEmpName.ClientID%>');

    var _EnteredString = _txtEmpName.value;

<asp:TextBox
        ID="txtEmpName" runat="server" onkeyup="javascript: Changed( this );"></asp:TextBox> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:36:29.647

如果您想传递值，只需执行以下操作：

```
<asp:TextBox ID="txtEmpName" runat="server" 
 onkeyup="javascript: Changed( this.value );"></asp:TextBox> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:38:12.797

不知道我是否理解，但如果你想传递你应该使用的值，`this.value`而不仅仅是`this`

```
<asp:TextBox ID="txtEmpName" runat="server" onkeyup="Changed(this.value)">
</asp:TextBox> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T18:30:27.837

也许使用 onblur 而不是 onkeyup？您将在每次击键时调用该函数，这是您真正想做的事情吗？

# jquery - mvc3中的jquery自定义验证错误

> ID：12112212
> 
> 赞同：1
> 
> 时间：2012-08-24T15:19:22.493
> 
> 标签：jquery, asp.net-mvc-3

我正在使用 jQuery 验证插件。当我使用自定义验证和 ad ajax 进行某些验证时，无论我输入错误还是正确的输入，它总是返回相同的结果：

```
<script type="text/javascript">
        $(document).ready(function () {
            var response;
            var email;
            if ($("#email").val() != '')
                email = $("#email").val();
            //<!-- add vlidator -->
            $.validator.addMethod(
             "varify_user", function (value, element) {
                 $.ajax({
                     url: "welcome/verify_user",
                     type: "POST",
                     data: "{ password: '" + value + "',email: '" + email + "' }",
                     async: false,
                     contentType: 'application/json; charset=utf-8',
                     success: function (json) {
                         response = json.success;
                     },
                     dataType: 'json'
                 });
                 return response;
             },
              "email or password is incorrect"
             );
            jQuery.validator.classRuleSettings.varify_user = { varify_user: true };
 $("#signIn_form").validate({
 submitHandler: function (form) {

                    $('#register-form').submit();
                }
            });

        });   
    </script> 
```

我在剃刀视图中的代码是

```
<div data-role="fieldcontain">
          <label for="email">
           <em>* </em> Email: </label>
           <label> <input type="text" id="email" 
                 name="email" class="required email" /></label>                  

        </div>
        <div data-role="fieldcontain">
            <label for = "password">
            <em>*</em>Password:</label>
            <input type="password" id="password" 
                    name="password" class="required varify_user" />
        </div> 
```

我正在开发 jQuery Mobile 应用程序，请帮助我。

# iphone - 错误：/VERSION：phonegap2.0 xcode 4.3 中没有此类文件或目录错误

> ID：12112214
> 
> 赞同：1
> 
> 时间：2012-08-24T15:19:40.637
> 
> 标签：iphone, ios, cordova

我对 iPhone 开发非常陌生，并且我希望使用 PhoneGap 框架来创建 iPhone 应用程序。我在 PhoneGap 项目中创建了 HTML、JavaScript。我收到了这个错误：

```
 "error: /VERSION: No such file or directory" 
```

在我的 Mac 上安装 Phonegap 2.0 后在 XCode 4.3 中运行它时。

我已经搜索了谷歌来解决这个错误，但我从那里找不到任何想法。你能帮我解决这个问题吗？提前致谢。期待您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T17:25:10.550

“资源”组中缺少 VERSION 文件引用。*对我来说，这是因为我还没有安装 PhoneGap，因此缺少 CordovaLib 项目（如果从dmg*文件安装 PhoneGap 后它不起作用，请重新启动你的 Mac）。

如果您像我在之前的错误答案中所说的那样删除了 VERSION 文件，则编译可以工作，但是应用程序会抛出“错误尝试插入 nil 值（键：cordova）”（但 HTML 显示正确）。添加回引用（只是恢复 pbxproj 文件），它必须指向 CordovaLib 项目中的 VERSION 文件。

* * *

在更高版本的 PhoneGap 中，对 VERSION 文件的依赖被[删除](https://issues.apache.org/jira/browse/CB-1166)，整个 CordovaLib 依赖处理被捆绑的脚本简化了，这些脚本可以自动更新你的 Xcode 项目。

# maven - 在 Apache Maven 中，是否可以控制将文件添加到存档的顺序？

> ID：12112216
> 
> 赞同：1
> 
> 时间：2012-08-24T15:19:42.367
> 
> 标签：maven

使用 Apache Maven 和创建档案的插件（例如`maven-war-plugin`），当使用通配符包含文件时，是否可以指定包含它们的顺序？

我们观察到，不同版本的 Maven，在不同的操作系统上，有时会以不确定的顺序将档案与文件组合起来。

为了澄清所需的答案，假设我总是希望存档中的文件按字母数字顺序组装。这应该在不同的平台或 Maven 版本中始终如一地完成。

*请注意，我故意省略了问题的“为什么这很重要”，我很好奇并认为其他人也可能想知道答案*

# java - 使用 dnsjava 在绑定 dns 服务器区域中添加/删除 dns 条目

> ID：12112218
> 
> 赞同：2
> 
> 时间：2012-08-24T15:19:45.510
> 
> 标签：java, dns, bind, dnsjava

我搜索了很多，但没有找到明确的答案。我的目标是制作可以从 dns 服务器添加和删除 dns 条目的 java 方法。我在 debian VM 上安装并配置了 bind9 dns 服务器。我正在使用 dnsjava 库。我可以从 dns 服务器读取区域和记录以及所有这些，我还可以发送正在接收的更新，但响应是 SERVFAIL。因此，我无法更改 dns 服务器的区域，例如添加和删除记录，尽管我通过允许更新来配置它们。谁能帮我继续？

# asp.net - 错误“无效的对象名称 INFORMATION_SCHEMA.TABLES”

> ID：12112219
> 
> 赞同：1
> 
> 时间：2012-08-24T15:19:47.687
> 
> 标签：asp.net, sql-server, vb.net, collation, case-sensitive

通过`ASP/ C# .NET`页面运行以下代码时出现错误：

```
 SELECT 1 FROM [database].INFORMATION_SCHEMA.TABLES 
 WHERE TABLE_TYPE='BASE TABLE' AND TABLE_NAME='example_table' 
```

当我在`sql management studio query`窗口中运行代码时，它运行得很好。它也只针对 1 个特定的`server`问题 - 当我在不同`server`的情况下运行时`connection string`，它工作正常。

我已经搜索了互联网，我似乎可以找到的所有答案都是区分大小写存在问题，但我使用的都是大写字母，并且有问题的表格`SQL_Latin1_General_CP1_CI_AS collation`无论如何都在使用。

基于这一切，我很确定这是某种权限问题，但我不确定在哪里看。

我得到的错误：

> 无效的对象名称“database.INFORMATION_SCHEMA.TABLES”。

连接字符串：

```
<add name="connectionName" connectionString="Data Source=servername; Initial Catalog=master; User ID=user; Password=pw" providerName="System.Data.SqlClient"/> 
```

更新：

更多信息：我从一些基本上做同样事情的旧 VB 东西改编了这段代码。VB 代码在相同的服务器和数据库上运行相同的精确查询，但它可以工作。

VB代码：

```
Dim connStr As String = ConfigurationManager.ConnectionStrings("connectionName").ConnectionString
Dim objConnection As SqlConnection = New SqlConnection(connStr)
Dim objCommand As SqlCommand = New SqlCommand("SELECT 1 FROM [database].INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' AND TABLE_NAME='example_table'", objConnection)
objCommand.CommandType = CommandType.Text

objConnection.Open() 
```

C# 和 VB 代码都使用来自 web.config 的完全相同的连接字符串，所以我想这让我怀疑这将是一个权限问题。仍然不知道问题是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:04:03.590

我希望在你的情况下这是一个复制粘贴问题，用你的数据库名称更改[数据库]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:09:10.353

经过多次调试，我能够确定代码实际上是在错误的服务器上运行的。因此，根据我发布的内容，实际上没有任何方法可以找到错误，但我认为托尼基于来回来回走在正确的轨道上。

# linux - DNSClient 无法通过其主机名 ping DNSserver 但能够通过其 IP ping

> ID：12112223
> 
> 赞同：0
> 
> 时间：2012-08-24T15:20:24.000
> 
> 标签：linux, dns

我在 Vmware Workstation 的 Window 7（作为主机）下有两台 Linux 机器 Redhat 和 Centos。我在 Redhat(10.0.0.1) 中配置 DNS 服务器和 DHCP 服务器。

Centos 客户端能够从 DHCP 服务器获取 IP(10.0.0.30)，但它没有从 DNS 服务器获取名称。

```
Problem is At server 10.0.0.1 i am able to ping itself by hostname like 
root@server->ping server.example.com       Ping successfull

But Client is not able to ping Server by Hostname like
root@localhost->ping server.example.com   Ping Not Successfull

Client is able to ping Server by its ip like
root@localhost->ping 10.0.0.1             Ping Successfull 
```

**现在我的任务是为什么客户端无法通过其主机名 ping 服务器以及为什么客户端无法从 DNS 服务器中获取名称，**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T20:17:45.910

刚刚在 Win7 主机上运行的 Debian VM 上遇到了类似的问题。

设置 DNS 服务器不足以解析服务器名称，尤其是在您的网络环境中使用代理时。要解决它，您必须在调用其他可执行文件之前在命令行上导出 http_proxy 环境变量。例如：

```
export http_proxy="http://{your proxy ip address here}:{your proxy port here}" 
```

像往常一样，记得将它添加到您的配置文件脚本中，这样您就不会在每次启动后重做它。

# ruby-on-rails - 如何创建运行脚本/控制台然后使用该环境运行命令的 ruby 脚本？

> ID：12112224
> 
> 赞同：2
> 
> 时间：2012-08-24T15:20:23.310
> 
> 标签：ruby-on-rails, ruby, bash

我注意到我不得不这样做：

```
bundle exec script/console
<wait for console to load>
require migration
generate some data 
```

很多......我想知道是否有办法将这一切都放在 bash 脚本或其他东西中。所以我可以做 ./generatedata 并让它运行上面的命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:27:08.923

我发现自定义 rake 任务对于需要在 rails 环境中运行代码的工作来说是一个很棒的工具。看看这个 railscast [http://railscasts.com/episodes/66-custom-rake-tasks](http://railscasts.com/episodes/66-custom-rake-tasks)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T15:30:47.470

如果要在控制台中运行一次性命令，可以使用该`rails runner`命令。因此，如果您有一个 ./generatedata.rb 脚本来执行您想在控制台中执行的 ruby​​ 命令，您只需调用`rails runner ./generatedata.rb`它，它将在 rails 环境中针对数据库运行您的 ruby​​ 脚本。或者，您可以将 shebang 行添加到 ./generatedata.rb 脚本`#!/usr/bin/env rails runner`：然后你只需要执行 ./generatedata.rb 脚本，它就会`rails runner`自动使用。

# sql - 从查询创建表

> ID：12112225
> 
> 赞同：0
> 
> 时间：2012-08-24T15:20:25.487
> 
> 标签：sql, sql-server

我设法应用您建议的 PIVOT 语句将表记录的值自动转置为列：

```
DECLARE @PivotColumnas VARCHAR(MAX) 
SELECT    @PivotColumnas = COALESCE (@PivotColumnas + ',[' + IB_PDSBATCHATTRIBIDBI + ']', '[' + IB_PDSBATCHATTRIBIDBI + ']') FROM PDSBATCHATTRIB

DECLARE @PivotTablaSQL NVARCHAR(MAX)
 SET  @PivotTablaSQL = N' SELECT * 
FROM (SELECT INVENTBATCHID, ITEMID, PDSBATCHATTRIB.IB_PDSBATCHATTRIBIDBI, PDSBATCHATTRIBVALUE FROM PDSBATCHATTRIBUTES
  LEFT JOIN PDSBATCHATTRIB ON PDSBATCHATTRIBUTES.IB_PDSBATCHATTRIBIDBI = PDSBATCHATTRIB.IB_PDSBATCHATTRIBIDBI) AS TablaOrigen
 PIVOT
 (MIN(PDSBATCHATTRIBVALUE)
 FOR IB_PDSBATCHATTRIBIDBI IN ('+ @PivotColumnas + ')) AS PivotTable' 

EXECUTE (@PivotTablaSQL) 
```

我需要的是如何将结果保存为查询或从此查询创建表。如果我尝试将结果另存为查询，则会收到以下错误：

> 关键字“DECLARE”附近的语法不正确。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:10:22.983

因为它是动态 sql，并且您不知道确切的列，所以可以使用 SELECT ... INTO #TempPivot。它正在创建一个您以后可以使用的临时表，或者尝试构建一个可以选择临时表结构并创建表的动态解决方案，但这似乎有点矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:16:58.983

我找到了解决办法，其实很简单！

我只需要在数据透视表`INTO NewTable`的`SELECT`句子中添加命令，就像这样：

```
SET  @PivotTablaSQL = N' SELECT * **INTO NewTable** 
FROM (SELECT INVENTBATCHID, ITEMID, PDSBATCHATTRIB.IB_PDSBATCHATTRIBIDBI,   PDSBATCHATTRIBVALUE FROM PDSBATCHATTRIBUTES 
LEFT JOIN PDSBATCHATTRIB ON PDSBATCHATTRIBUTES.IB_PDSBATCHATTRIBIDBI =  PDSBATCHATTRIB.IB_PDSBATCHATTRIBIDBI) AS TablaOrigen 
PIVOT 
(MIN(PDSBATCHATTRIBVALUE) 
FOR IB_PDSBATCHATTRIBIDBI IN ('+ @PivotColumnas + ')) AS PivotTable' 
```

这将在 SQL 数据库中使用数据透视表结果创建一个新表。谢谢大家！

# javascript - 我是否需要 oAuth 才能使用新的 Twitter API 指南检索公共推文？（如何？）

> ID：12112226
> 
> 赞同：0
> 
> 时间：2012-08-24T15:20:28.560
> 
> 标签：javascript, api, twitter, oauth

据我了解，对 twitter API 的任何调用都将很快需要 oAuth。

我要做的就是使用 javascript 在网站上显示公共推文列表。考虑到推特关于强制身份验证的新指南，最好的方法是什么？（我之前从未使用过 twitter API）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T01:38:31.023

Twitter 确实很快就会要求对每个 API 访问进行[某种身份验证：](https://dev.twitter.com/blog/changes-coming-to-twitter-api)

> 在 1.1 版本中，**我们将要求对 API 的每个请求进行身份验证。**

对于列出公共推文，您可能只需要[验证您的应用程序](https://dev.twitter.com/discussions/10175)，因此不需要用户登录。然而，直到 Twitter 发布他们的 Twitter API 版本 1.1 文档之前，没有明确的答案。

# jquery - $(this) throwing TypeError: $ is not a function in Coffeescript, Rails 3.2

> ID：12112232
> 
> 赞同：1
> 
> 时间：2012-08-24T15:20:39.100
> 
> 标签：jquery, coffeescript, ruby-on-rails-3.2

这让我快疯了。

所以每次我在 jQuery 事件中使用 $(this) 时，我都会得到 TypeError: $ is not a function。

这是我正在使用的代码示例：

```
$ ->
 $(".some-element").click ->
  if $(this).hasClass("someClass")
   do something 
```

编译为：

```
$(function() {
 $(".some-element").click(function() {
  if ($(this).hasClass("someClass")) {
   do something
  }
 });
}); 
```

奇怪的是，如果我将 $(this) 更改为 jQuery(this)，代码可以完美运行。

任何建议将不胜感激。

***更新***

我在页面上有一个 CKeditor 元素，它是使用 ckeditor gem helper 标签创建的。我评论了这一点，所有的javascript都开始工作了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:22:53.740

有冲突，使用`.noConflict()`，你应该解决它。

```
var $j = jQuery.noConflict();
// Do something with jQuery
$j("div p").hide();

// Do something with another library's $()
$("content").style.display = 'none'; 
```

**[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)**

* * *

所以：

```
var $j = jQuery.noConflict();

$j(function() {
 $j(".some-element").click(function() {
  if ($j(this).hasClass("someClass")) {
   do something
  }
 });
}); 
```

# php - 计算从现在到某天某个时间之前的 x 天之间的倒计时

> ID：12112236
> 
> 赞同：0
> 
> 时间：2012-08-24T15:20:47.527
> 
> 标签：php, time

我完全被困在这里。我试图从当前时间到 7 天下午 6 点的计算中得到多少天的小时和分钟。我查看了我的 $difference 变量产生的秒数，当我进行数学运算以将其转换为天数小时和分钟时，它是正确的，但由于某种原因，当我在输出语句中调用特定的天数、小时和分钟时，它是不正确的。我究竟做错了什么。这是代码。

```
<?php
date_default_timezone_set('America/New_York');
$nextWeek = strtotime('+7 days');
$m = date('n', $nextWeek);
$d = date('j', $nextWeek);
$y = date('Y', $nextWeek);
$difference = mktime(18,0,0,$m,$d,$y) - time();

echo '<p>Current date and time is' .date(' l F d, Y '). 'at '.date('g:i a').' You have an appointment in a week on '.date(' n/j/Y ', $nextWeek).' at 6pm. There are ' .date(' j ', $difference).' days, ' .date(' g ', $difference).' hours, and ' .date(' i ', $difference).' minutes until your appointment.</p>';

echo mktime(18,0,0,$m,$d,$y),"\n";
echo $difference;

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:50:28.180

问题是您在`date()`不代表*date*的数字上使用 PHP 的函数。您的变量`$difference`表示两个日期之间的差异，以秒为单位。要获得正确的输出，您应该编写自己的函数将这些秒数转换为天数、小时数、分钟数等。

它可能看起来像这样：

```
function getTimeText($seconds)
{
    $return = array();

    $return["days"] = floor($seconds/86400); // 86400 seconds in a day
    $seconds -= ($return["days"]*86400);

    $return["hours"] = floor($seconds/3600); // 3600 seconds in an hour
    $seconds -= ($return["hours"]*3600);

    $return["minutes"] = floor($seconds/60); // 60 seconds in a minute

    return $return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:52:42.103

试试看[这个](http://www.php.net/manual/en/datetime.diff.php)。页面下方的示例向您展示了如何在天数中找到两个日期之间的差异。您应该可以使用它通过更改格式来返回当前时间与 7 天 18:00 时间之间的差异。

# mysql - Mysql函数不起作用

> ID：12112238
> 
> 赞同：1
> 
> 时间：2012-08-24T15:21:01.493
> 
> 标签：mysql

```
DROP FUNCTION IF EXISTS shorten;
delimiter $$
CREATE FUNCTION shorten(s VARCHAR(255), n INT)
   RETURNS VARCHAR(255)
 BEGIN
 IF ISNULL(s) THEN
   RETURN '';
 ELSE IF n<15 THEN
    RETURN LEFT(s, n);
 ELSE IF CHAR_LENGTH(s) <= n THEN
   RETURN s;
 ELSE
  RETURN CONCAT(LEFT(s, n-10), ' ... ', RIGHT(s, 5));
  END IF;
 END$$ 
```

我得到的信息是：

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 14 行的 '' 附近使用 >

错误在哪里..因为我是在 mysql 中创建函数的新手。

**更新 ：**

它指出了这些行之间带有一些圆形问号的错误：

```
ELSE IF n <15 THEN RETURN LEFT( s, n ) ;

ELSE IF CHAR_LENGTH( s ) <= n THEN RETURN s; 
```

顺便说一句，我使用 phpmyadmin

**mysql版本为：mysqlnd 5.0.10**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:25:50.190

`END IF`您需要删除一个额外的内容，并替换`ELSE IF`为`ELSEIF`：

```
DROP FUNCTION IF EXISTS shorten;
delimiter $$
CREATE FUNCTION shorten(s VARCHAR(255), n INT) RETURNS VARCHAR(255)
BEGIN
 IF ISNULL(s) THEN
  RETURN '';
 ELSEIF n<15 THEN
  RETURN LEFT(s, n);
 ELSEIF CHAR_LENGTH(s) <= n THEN
  RETURN s;
 ELSE
  RETURN CONCAT(LEFT(s, n-10), ' ... ', RIGHT(s, 5));
 END IF;
END$$ 
```

德米特里的最后一个错误是因为多了一个分号：

```
WRONG code: delimiter $$; 
GOOD code: delimiter $$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:28:25.270

IF THEN ELSE 的真正 MySQL 语法是

```
 IF THEN
   ELSEIF THEN
   ELSE
   END IF 
```

实际上，您正在使用`ELSE IF`，将其替换为`ELSEIF`，它会起作用

参考：[http ://dev.mysql.com/doc/refman/5.0/en/if.html](http://dev.mysql.com/doc/refman/5.0/en/if.html)

```
DROP FUNCTION IF EXISTS shorten;

delimiter $$
CREATE FUNCTION shorten(s VARCHAR(255), n INT)
RETURNS VARCHAR(255)
 BEGIN
 IF ISNULL(s) THEN
 RETURN '';
 ELSEIF n<15 THEN
RETURN LEFT(s, n);
 ELSEIF CHAR_LENGTH(s) <= n THEN
 RETURN s;
 ELSE
 RETURN CONCAT(LEFT(s, n-10), ' ... ', RIGHT(s, 5));
  END IF;

 END$$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T15:29:14.443

我不确定 bt 我不明白为什么你关闭 if ( `END IF;`) 两次..？这可能是您的代码中的一个问题。请检查它。`ELSE IF`并且应该没有空格，即`ELSEIF`。代码应该是：

```
DROP FUNCTION IF EXISTS shorten;
delimiter $$
CREATE FUNCTION shorten(s VARCHAR(255), n INT)
RETURNS VARCHAR(255)
 BEGIN
 IF ISNULL(s) THEN
 RETURN '';
 ELSEIF n<15 THEN
RETURN LEFT(s, n);
 ELSEIF CHAR_LENGTH(s) <= n THEN
 RETURN s;
 ELSE
 RETURN CONCAT(LEFT(s, n-10), ' ... ', RIGHT(s, 5));
  END IF;
 END;$$
 delimiter; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-03T11:04:02.163

```
CREATE  FUNCTION shorten(s VARCHAR(255), n INT)
RETURNS VARCHAR(255)
BEGIN
IF ISNULL(s) THEN 
RETURN '';
ELSEIF n<15 THEN
RETURN LEFT(s,n);
ELSE 
IF CHAR_LENGTH(s) <= n THEN
RETURN s;
ELSE
RETURN CONCAT(LEFT(s, n-10), '... ',RIGHT(s,5));
END IF;
END IF;
END$$ 
```

尝试在您的语句中再包含一个 END IF，这应该可以工作:)

# wpf - 从 db xaml 创建按钮

> ID：12112247
> 
> 赞同：0
> 
> 时间：2012-08-24T15:21:38.413
> 
> 标签：wpf, xaml, c#-4.0, button, .net-4.0

我有一个数据库，其中包含 2 张表，其中一张是信用卡，并持有他们的号码、所有者和一个 ID；另一个描述了卡的每月费用，包含它们的金额日期和卡的 ID（这是第一个表的外键）。

在我的程序中，我正在创建一个主菜单，允许用户选择卡，然后它将打开一个新窗口，显示卡的费用。在主菜单中，我想为每张信用卡创建一个按钮，并将其设计为封面流程。

我正在使用 wpf，我对此很陌生。我创建它的方式是通过后面的代码，我在数据库中查询卡的号码和 foreach 结果，我正在创建一个按钮。我想知道这是否是正确的方法，还是有其他方法可以通过 xaml 创建按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:31:35.850

您想要的称为数据模板，您创建一个表示单个项目的模板，然后将该模板应用于菜单控件并将其`ItemsSource`属性设置为数据库中的行。

这是我发现可能有帮助的快速帖子：[http ://www.vbknowledgebase.com/?Id=133&Desc=WPF-Menu-Databinding](http://www.vbknowledgebase.com/?Id=133&Desc=WPF-Menu-Databinding)

我相信您可以通过快速网络搜索找到更多信息。

# jquery - SSL 搞砸了/禁用 jquery

> ID：12112252
> 
> 赞同：1
> 
> 时间：2012-08-24T15:21:47.360
> 
> 标签：jquery, ssl

我为我的购物车、注册、登录和联系表格启用了 SSL。启用 SSL 后，jquery 将被禁用。我看到谷歌也有使用 https 导入的 jquery。

这是页面[https://americanbookcompany.com/store/account/](https://americanbookcompany.com/store/account/)当您单击顶部的 CREATE ONE NOW 时，它不会执行 JQUERY 来切换表单。无需 SSL 即可完美运行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:27:11.377

好像您有一些`.js`从非安全网址调用的文件

```
<script type="text/javascript" src="http://sdscdn.userreport.com/popup.min.js"></script>
<script src="http://tab-slide-out.googlecode.com/files/jquery.tabSlideOut.v1.3.js"></script>
<script src="http://twitter.com/statuses/user_timeline/americanbookco.json?callback=twitterCallback2&count=4" type="text/javascript"></script> 
```

我不能确定这是唯一的原因，但我`SSL`对这样的事情非常敏感。也许将这些文件存储在本地并确保所有`http`连接都是安全的可能是第一步。

# javascript - 仅在屏幕媒体上运行 javascript/jquery，而不是打印

> ID：12112255
> 
> 赞同：10
> 
> 时间：2012-08-24T15:21:49.957
> 
> 标签：javascript, jquery, printing, media-queries

如何仅在 上运行 jquery 函数`@media screen`？

背景：

我有一个`screen.css`样式表和一个`print.css`样式表。我有两个 javascript 函数，其中一个**我不想在页面的打印版本上运行**。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T17:43:59.970

任何脚本都会在页面加载时运行，因此使用是毫无意义的，因为它会在您打开*时*`if (Modernizr.mq('only screen')) {$('h1').text('media screen');}`运行您的脚本。*`@media screen`*

 *相反，您必须检测媒体查询何时更改，并相应地更改页面。你可以使用类似[enquire.js](http://wicky.nillia.ms/enquire.js/)的东西来轻松地做到这一点：

```
// This is just an example, be more creative!

enquire.register("screen", {
    match: function() { 
        $('#only-show-on-screen').show();
    },
    unmatch: function() {
        $('#only-show-on-screen').hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T15:28:38.697

在最新的浏览器中，您可以使用 matchMedia：

```
if (window.matchMedia("screen").matches) {
    ....
} 
```

如果你也想支持旧版浏览器，你可以使用像 matchMedia.js 这样的[polyfill](https://github.com/paulirish/matchMedia.js)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:32:57.830

我认为您可以使用 Modernizr。虽然，在 javascript 中必须有一种本地方式来做到这一点。

[http://modernizr.com/docs/#mq](http://modernizr.com/docs/#mq)

我从未尝试过，但它是这样的：

```
if (Modernizr.mq('only screen'))
{
..
} 
```

请注意不支持媒体查询的旧浏览器。*

# php - 尝试 preg_replace() 时出现语法错误

> ID：12112256
> 
> 赞同：-1
> 
> 时间：2012-08-24T15:21:50.487
> 
> 标签：php, escaping, preg-replace, syntax-error

我正在尝试删除重复的斜杠，并且在绑定时出现错误。似乎有些字符必须转义，但我不知道是哪一个。

```
<?php
$path = preg_replace('(\\){2,}', '$1', 'z:\\\aaa\\\\bbb\c\ddd\');
echo $path;
?> 
```

这给出了，

> 解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE

有人可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:23:42.677

这部分：

```
'z:\\\aaa\\\\bbb\c\ddd\' 
```

应该：

```
'z:\\\aaa\\\\bbb\c\ddd\\' 
```

您正在使用反斜杠转义右引号，因此字符串不会结束。

# c++ - 如何重用字符串流

> ID：12112259
> 
> 赞同：22
> 
> 时间：2012-08-24T15:21:55.573
> 
> 标签：c++, file, parsing, text, stringstream

这些线程不回答我：

[重置字符串流](https://stackoverflow.com/questions/7623650/)

[如何清除字符串流变量？](https://stackoverflow.com/questions/20731/)

```
std::ifstream file( szFIleName_p );
if( !file ) return false;

// create a string stream for parsing

std::stringstream szBuffer;

std::string szLine;     // current line
std::string szKeyWord;  // first word on the line identifying what data it contains

while( !file.eof()){

    // read line by line

    std::getline(file, szLine);

    // ignore empty lines

    if(szLine == "") continue;

    szBuffer.str("");
    szBuffer.str(szLine);
    szBuffer>>szKeyWord; 
```

`szKeyword`将始终包含第一个单词，`szBuffer`不会被重置。我在任何地方都找不到关于如何使用 stringstream 的明确示例。

回答后的新代码：

```
...
szBuffer.str(szLine);
szBuffer.clear();
szBuffer>>szKeyWord;
... 
```

好的，这就是我的最终版本：

```
std::string szLine;     // current line
std::string szKeyWord;  // first word on the line identifying what data it contains

// read line by line

while( std::getline(file, szLine) ){

    // ignore empty lines

    if(szLine == "") continue;

    // create a string stream for parsing

    std::istringstream szBuffer(szLine);
    szBuffer>>szKeyWord; 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-24T15:28:16.603

`clear()`调用后你没有流`str("")`。再看看[这个答案](https://stackoverflow.com/questions/20731/in-c-how-do-you-clear-a-stringstream-variable)，它也解释了为什么你应该使用`str(std::string())`. 在您的情况下，您还可以使用 only 重置内容`str(szLine)`。

如果您不调用`clear()`，则流的标志（如`eof`）不会被重置，从而导致令人惊讶的行为；）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-24T15:46:59.703

这取决于你用它做什么。通常只创建一个新的`istringstream`或`ostringstream`. 要“重置”流，您必须清除其缓冲区，清除所有错误标志，重置所有格式标志，加上精度和填充，`imbue`使用原始语言环境重新设置，并且不要忘记使用从返回的值生成的任何扩展格式信息`xalloc`. 总而言之，不可能得到正确的。

当我这样做时，您的循环是错误的，并且可能会导致最后一行被处理两次。 `file.eof()`只有在输入失败后才有意义（即使那样，它也不是 100% 可靠的）。你想要的是：

```
std::string line;
while ( std::getline( file, line ) ) {
    if ( !line.empty() ) {
        std::istringstream buffer( line );
        //  ...
    }
} 
```

（实际上，您可能希望在测试之前从行中修剪尾随空格以显示为空。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-30T23:09:46.340

ss 是字符串流。采用

*   第一步：ss.clear();
*   第二步：ss.str("");

重用字符串流——完全清除字符串流。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-03T19:13:15.570

`istringstream`在大多数情况下，创建新的或`ostringstream`重置相同的更容易。

但是，如果您确实想反感他们：

*   使用 . 重新发送流的标志（以避免意外行为）`clear ()`。

*   虽然您可以更正`stringstream`使用的内容`str ("")`，但出于效率目的，我们可能更喜欢`str(std::string())`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-23T16:01:40.590

如果您在类成员中有流，请使用`unique_ptr<stringstream>`, 然后只是`reset(new stringstream(...))`为了重用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-20T06:30:31.670

想象一个配置文件。

```
par1=11
par2=22 
```

代码：

```
std::string line, strpar1, strpar2;
int par1, par2;
std::ifstream configfile("config.cfg");

std::getline(configfile, line);    // first line to variable "line"
std::istringstream sline(line);
while (std::getline(sline, strpar1, '='));
par1 = std::stoi(strpar1);  // par1 get 11

bool b = sline.eof(); // true

std::getline(configfile, line);    // second line to variable "line"
sline.clear();    //
sline.str(line);    // reuse "sline"

b = sline.good();  // true  // goodbit is zero, indicating that none of the other bits is set.
b = sine.fail();  // false
b = sline.bad();  // false
b = sline.eof(); // false

while (std::getline(sline, strpar2, '='));
par2 = std::stoi(strpar2);  // par2 get 22 
```

[goodbit 为零，表示没有设置其他位](http://www.cplusplus.com/reference/ios/basic_ios/clear/)

# php - Jquery/PHP 更新后显示数据库

> ID：12112260
> 
> 赞同：0
> 
> 时间：2012-08-24T15:22:02.820
> 
> 标签：php, jquery

我有这个 jQuery 更新模糊数据库。它工作正常，除了我希望代码在更新后显示当前的 DB 值。数据库中有一个值，该字段中的金额将被添加到该值中并得到更新。现在看到这一点的唯一方法是每次更新时刷新页面。

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
    <script type="text/javascript">
    // JQUERY: Plugin "autoSumbit"
    (function($) {
        $.fn.autoSubmit = function(options) {
            return $.each(this, function() {
                // VARIABLES: Input-specific
                var input = $(this);
                var column = input.attr('name');

                // VARIABLES: Form-specific
                var form = input.parents('form');
                var method = form.attr('method');
                var action = form.attr('action');

                // VARIABLES: Where to update in database
                var where_val = form.find('#where').val();
                var where_col = form.find('#where').attr('name');

                // ONBLUR: Dynamic value send through Ajax
                input.bind('blur', function(event) {
                    // Get latest value
                    var value = input.val();
                    // AJAX: Send values
                    $.ajax({
                        url: action,
                        type: method,
                        data: {
                            val: value,
                            col: column,
                            w_col: where_col,
                            w_val: where_val
                        },
                        cache: false,
                        timeout: 10000,
                        success: function(data) {
                            // Alert if update failed
                            if (data) {
                                document.getElementById("notice").innerHTML="Error, NO UPDATE";
                            }
                            // Load output into a P
                            else {
                                $('#notice').text('Updated');
                                $('#notice').fadeOut().fadeIn();
                            }
                        }
                    });
                    // Prevent normal submission of form
                    return false;
                })
            });
        }
    })(jQuery);
    // JQUERY: Run .autoSubmit() on all INPUT fields within form
    $(function(){
        $('#ajax-form INPUT').autoSubmit();
    });
    </script> 
```

HTML 的东西

```
 <label>Total:</label>
            <input name="company" value="<?php echo $row['total'] ?>" />

        <label>Tax-in:</label>
            <input name="lastname" value="<?php echo $row['taxin'] ?>" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:25:57.203

在您的 PHP 文件将该行插入数据库后，让它从数据库中选择新值并将其回显到对 jQuery 的 AJAX 响应中。然后使用 jQuery 将新值填充到您想要的任何位置。

# java - 如何终止视图范围 bean 中的线程？

> ID：12112266
> 
> 赞同：6
> 
> 时间：2012-08-24T15:22:29.613
> 
> 标签：java, multithreading, jsf-2

在我们的应用程序中，当用户单击 commandlink 时，会生成一个弹出窗口。此单击将传递一个 id 进行处理。

我的托管 bean 是视图范围的，我正在创建一个线程来执行一些任务。

在用户单击链接的情况下，会生成一个弹出窗口并且线程已开始执行作业，假设用户关闭弹出窗口并尝试单击这次提供不同 ID 的链接。我的问题是之前启动的线程没有被破坏。我仍然可以获得最新的 id 详细信息作为响应，但前一个线程仍然执行作业。

我想知道是否有办法在新请求上终止前一个实例线程。我知道我可以使用 sessionscoped 来实现这一点，但弹出窗口是在同一个会话中打开的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T10:51:07.950

就像您的用例可能的快速解决方案一样：

*   我会使用线程池而不是为每个请求创建新线程（因为线程池的想法更有效+在标准 API 中提供）
*   那么您可以轻松地停止池中任何正在运行的线程，我在以下网址找到了解决方案：http: [//www.coderanch.com/t/234197/threads/java/stopping-runnable-ThreadPoolExecutor](http://www.coderanch.com/t/234197/threads/java/stopping-runnable-ThreadPoolExecutor) => 问题包含线程池实现的示例和第一个答案为您提供解决方案

调用：

```
boolean cancel(boolean mayInterruptIfRunning) 
```

在您的情况下，呼叫应使用：

```
mayInterruptIfRunning=true 
```

剩下的唯一问题是：在哪里保留 Future 参考？:)
如果您愿意，我们也可以讨论 :)

# .net - 使用内联 XSD 和重用类为多个 WSDL 文件生成 WCF 类

> ID：12112273
> 
> 赞同：0
> 
> 时间：2012-08-24T15:22:47.133
> 
> 标签：.net, wcf, xsd, wsdl

我的 WSDL 文件很少（将来我会不定期地获得更多），内联 XSD 和许多共享 XSD 类型（在每个 WSDL 中重复）。我需要想出一个流程，如何处理这些 WSDL 并尽可能少地重用生成的类。我正在考虑的最简单的解决方案是将每个类生成到单独的文件中，这将确保不同的类。

我已经使用重用选项尝试了 svcutil.exe，但它似乎不适用于我的情况。继承也有问题（XmlIncludeAttribute 用于序列化） - 每个 WSDL 只包含整个继承层次结构的一部分。

所以看起来我需要获取我目前拥有的所有 WSDL，从中提取 XSD，将这些 XSD 合并到一个大 XSD 中，并从这个合并的 XSD 文件生成 C# 类。

这类问题有什么行之有效的解决方案吗？我会很感激任何tips'n'tricks..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:44:26.530

我们遇到过类似的问题，svcutil 生成了一个非常大的 CS 文件，其中包含所有类。

我们使用 Resharper 将文件拆分为单独的类文件。

svcutil 重用选项仅适用于 xsd 中的类具有 dll 的情况。

你可以这样做：

*   将每个 wsdl 放在自己的目录中
*   在每个上运行 svcutil
*   使用 resharper 拆分文件
*   将所有文件复制到单个目录，并跳过具有重复名称的文件

# sql - SQL 代理作业 - “运行方式”下拉列表为空

> ID：12112276
> 
> 赞同：21
> 
> 时间：2012-08-24T15:23:01.277
> 
> 标签：sql, sql-server-2008, proxy, jobs, agent

当我尝试设置 SQL 代理作业时，为什么“运行方式”下拉列表总是空的？我正在尝试设置一些 SQL 代理作业以使用代理帐户运行。我是 SQLAgentUserRole、SQLAgentReaderRole 和 SQLAgentOperatorRole 的成员。当我尝试向作业添加步骤时，我选择了 SQL Integration Services 包，并且运行方式下拉列表为空。

任何系统管理员都可以查看代理。我不应该能够将代理用作 SQLAgentUserRole、SQLAgentReaderRole 和 SQLAgentOperatorRole 的成员吗？我在这里想念什么？

（代理帐户对子系统有效：SQL 集成服务包，这是 SQL Server 2008 R2）

编辑 -

[MSDN](http://msdn.microsoft.com/en-us/library/ms190926.aspx)：“这些数据库角色（SQLAgentUserRole、SQLAgentReaderRole 和 SQLAgentOperatorRole）的成员可以查看和执行他们拥有的作业，并创建作为现有代理帐户运行的作业步骤。” 而关于固定服务器角色的另一篇文章提到可以授予代理访问权限，但没有提到如何做到这一点：[MSDN](http://msdn.microsoft.com/en-us/library/ms188283.aspx)。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-27T13:34:31.723

我找到了答案。非系统管理员用户必须有权访问明确授予其角色或用户名的代理帐户：

授予非系统管理员对代理帐户的访问权限

1.  在对象资源管理器中，展开服务器。
2.  展开 SQL Server 代理。
3.  展开代理，展开代理的子系统节点，右键单击要修改的代理，然后单击属性。

在“常规”页面上，您可以更改代理帐户名称、凭据或它使用的子系统。在 Principals 页面上，您可以添加或删除登录名或角色以授予或删除对代理帐户的访问权限。

[http://msdn.microsoft.com/en-us/library/ms187890(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms187890(v=sql.100).aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-09-09T11:23:04.430

1.  编辑作业步骤时 -**切换到左侧的“高级”选项卡**，不要使用主页上的下拉菜单。
2.  确保用户被授予作业数据库中的角色，即使他是“系统管理员”

（屏幕截图适用于 SSMS 17）

[![在此处输入图像描述](../Images/513916efe23e9d85618e4ce6644a844c.png)](https://i.stack.imgur.com/gvgvN.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T15:37:13.880

不，你不应该。您刚才提到的角色的成员只能创建作为自己运行的作业，因为它们是非管理角色。如果您想使用另一个用户运行作业，则需要访问代理帐户。如果我没记错的话，唯一有权创建代理帐户的组是 sysadmin，因此您需要一个管理员来为您执行此操作。

> sysadmin 角色的成员有权创建不指定代理但作为 SQL Server 代理服务帐户运行的作业步骤，该帐户用于启动 SQL Server 代理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-10T10:27:19.750

首先创建凭据，然后您将能够在代理级别下添加它。完成此操作后，您可以从 sql 服务代理更改为凭据。

# ember.js - 固定装置中的嵌入对象引发“无法找到固定装置”错误

> ID：12112279
> 
> 赞同：1
> 
> 时间：2012-08-24T15:23:15.260
> 
> 标签：ember.js, ember-data

我广泛使用 ember-data 的夹具适配器在我的应用程序中提供大量设置数据。对于一个模型（“结构”），有一组嵌入的相关对象（“覆盖”）。当我从商店加载一个结构实例，然后查询它的`overlays`属性时，我得到这个错误：

```
Uncaught Error: assertion failed: Unable to find fixtures for model type App.Overlay 
```

两种模型的定义如下（为清楚起见，删除了一些其他字段/关系）：

```
App.Structure = DS.Model.extend({
  // How this appears in lists
  name: DS.attr('string'),
  // Color to show this overlay with
  color: DS.attr('string'),
  // hash of overlay paths
  overlays: DS.hasMany('App.Overlay', { embedded: true })
});

App.Overlay = DS.Model.extend({
  view: DS.attr('string'),
  path: DS.attr('string')
}); 
```

我只需要一个夹具来演示：

```
App.Structure.FIXTURES = [{
    "id": 0,
    "name": "Test Structure",
    "color": "#cc0033",
    "overlays": [{
        'view': 'Isometric',
        'path': "M17.5,19.508V8.626h-3.999v10.881c-1.404,0.727-2.375,2.178-2.375,3.869c0,2.416,1.959,4.375,4.375,4.375s4.375-1.959,4.375-4.375C19.876,21.686,18.905,20.234,17.5,19.508zM20.5,5.249c0-2.757-2.244-5-5.001-5s-4.998,2.244-4.998,5v12.726c-1.497,1.373-2.376,3.314-2.376,5.4c0,4.066,3.31,7.377,7.376,7.377s7.374-3.311,7.374-7.377c0-2.086-0.878-4.029-2.375-5.402V5.249zM20.875,23.377c0,2.963-2.41,5.373-5.375,5.373c-2.962,0-5.373-2.41-5.373-5.373c0-1.795,0.896-3.443,2.376-4.438V5.251c0-1.654,1.343-3,2.997-3s3,1.345,3,3v13.688C19.979,19.934,20.875,21.582,20.875,23.377zM22.084,8.626l4.5,2.598V6.029L22.084,8.626z"
    }]
}]; 
```

有了这些，我可以加载一个结构：

```
> var structure = App.fixtureStore.find(App.Structure, 0);
> structure.get('name');
"Test Structure" 
```

但是，如果我查询它的覆盖，事情就会变得怪异：

```
> structure.get('overlays');
Uncaught Error: assertion failed: Unable to find fixtures for model type App.Overlay 
```

这是怎么回事？我是否需要为这个模型声明固定装置，即使它们是空的？

[这是一个显示错误的jsfiddle](http://jsfiddle.net/pjmorse/hA6VH/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:33:32.417

啊，[对小提琴进行更多调整](http://jsfiddle.net/pjmorse/hA6VH/3/)表明我确实需要为模型声明空固定装置：

```
App.Overlay.FIXTURES = []; 
```

# c# - Web 应用程序模块化设计实践

> ID：12112280
> 
> 赞同：3
> 
> 时间：2012-08-24T15:23:17.577
> 
> 标签：c#, asp.net, web, telerik, controls

我有一个使用 ASP.NET 4.0 和 C# 构建的现有 Web 应用程序。该应用程序有一个管理页面，其中包含许多不同的部分，您可以在其中更改不同的设置。为了清楚起见，我附上了屏幕截图。

目前，所有内容都包含在一页中。这意味着我只有一个页面上有大量的控件。我想要一个导航面板，您可以在其中选择所需的“部分”，它会加载带有该“部分”的中央内容区域。我想知道这样做的最佳方法是什么。最好是让每个部分都成为自己的控件，还是将每个部分分成单独的页面？

我想确保以正确的方式进行操作，以便易于维护和扩展。

我很感激任何帮助。

![主屏幕](../Images/ac489c358919fb167b454cb28fb0c34b.png) ![部分展开 1](../Images/4e4afee16a54457e5f17b800705adf39.png) ![扩展部分 2](../Images/a21e75b56f913fd1fb325d85aa358719.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:53:39.117

我肯定会推荐为每件作品使用控件。控件的好处在于，如果您需要在应用程序的完全不同的部分使用它们，您就可以开始使用了！

至于在单独的控件中加载，您可以简单地使用查询字符串变量。例如，假设您有一个这样的锚标记：

```
<a href="/admin/index.aspx?admin=businessHours">Business Hours</a> 
```

现在我们可以构建一个单独的页面：/admin/index.aspx 并且在页面加载时我们可以检查查询字符串。现在根据该查询字符串，我们可以加载适当的控件。

从查询字符串中读取：http: [//triaslama.wordpress.com/2008/04/12/retrieving-query-string-values-in-aspnet-and-javascript/](http://triaslama.wordpress.com/2008/04/12/retrieving-query-string-values-in-aspnet-and-javascript/)

通过后面的代码加载用户控件：http: [//www.codeproject.com/Articles/1939/Programatically-include-an-ASP-NET-UserControl-in](http://www.codeproject.com/Articles/1939/Programatically-include-an-ASP-NET-UserControl-in)

# android - Android Checkbox setChecked() 没有效果

> ID：12112288
> 
> 赞同：0
> 
> 时间：2012-08-24T15:23:37.450
> 
> 标签：android, android-checkbox

我正在制作一个带有一堆复选框的设置页面。用户选择他想要的选项，然后点击提交按钮，将结果保存在文本文件中，如 1;0;1;1;1;0 等，其中 1 表示选中，0 表示未选中。

在下一个程序启动时，程序将查找设置文件。如果找不到它，复选框将保留在其默认的真实值（全部打开）。如果可以，它将读取文件，并相应地设置复选框。最后一步是我遇到问题的地方 - 使用 toast，我可以看到程序找到了文件，正确地拆分它，并且对于给定的复选框具有正确的值。我什至在 if() 块中触发了一个 toast，在该块中我检查值是否为 0，即使用 setChecked() 代码之后的行。该 toast 触发，因此正在读取 setChecked() 代码。但是，该复选框不会更新，并保持选中状态。我的猜测是在我更改框后视图没有被刷新。

这是我第一次制作一个不完全是服务的android选项，并且有一个GUI，所以我有点不清楚。设置框后快速刷新屏幕的最简单方法是什么，或者还有其他问题吗？

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //establish checkBoxes
    checkBatteryLevel = (CheckBox) findViewById(R.id.checkBox1);
    checkBatteryVoltage = (CheckBox) findViewById(R.id.checkBox2);
    checkBluetooth = (CheckBox) findViewById(R.id.checkBox5);
    checkCall = (CheckBox) findViewById(R.id.checkBox4);
    checkCharger = (CheckBox) findViewById(R.id.checkBox3);
    checkScreen = (CheckBox) findViewById(R.id.checkBox8);
    checkWifiPermis = (CheckBox) findViewById(R.id.checkBox6);
    checkWifiCnct = (CheckBox) findViewById(R.id.checkBox7);
    submitButton = (Button) findViewById(R.id.button1);

    Toast toast = Toast.makeText(getApplicationContext(), "Text here", Toast.LENGTH_LONG);

    //check if text settings are there
    textSettings = new File (root, "UsageMonitorSettings.txt");
    if(textSettings.exists())
    {
        toast = Toast.makeText(getApplicationContext(), "File Exists", Toast.LENGTH_LONG);
        toast.show();
        //if present, read it and set buttons accordingly
        try {
            Scanner myScanner = new Scanner(textSettings);
            while (myScanner.hasNextLine())
            {
                String line = myScanner.next();
                toast = Toast.makeText(getApplicationContext(), line, Toast.LENGTH_LONG);
                toast.show();
                String[] lineArray = line.split(";");
                toast = Toast.makeText(getApplicationContext(), lineArray[0], Toast.LENGTH_LONG);
                toast.show();
                if(lineArray[0].equals("0"))
                {
                    checkBatteryLevel.setChecked(false);
                    toast = Toast.makeText(getApplicationContext(), "batt check changed", Toast.LENGTH_LONG);
                    toast.show();
                }
                if(lineArray[1].equals("0"))
                {
                    checkBatteryVoltage.setChecked(false);
                }
                if(lineArray[2].equals("0"))
                {
                    checkCharger.setChecked(false);
                }
                if(lineArray[3].equals("0"))
                {
                    checkCall.setChecked(false);
                }
                if(lineArray[4].equals("0"))
                {
                    checkBluetooth.setChecked(false);
                }
                if(lineArray[5].equals("0"))
                {
                    checkWifiPermis.setChecked(false);
                }
                if(lineArray[6].equals("0"))
                {
                    checkWifiCnct.setChecked(false);
                }
                if(lineArray[7].equals("0"))
                {
                    checkScreen.setChecked(false);
                }
            }
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
    else
    {
        toast = Toast.makeText(getApplicationContext(), "File does not exist", Toast.LENGTH_LONG);
        toast.show();
        //if not, make one with all defaulting to on
        try {
            BufferedWriter myFileWriter = new BufferedWriter(new FileWriter(textSettings));
            myFileWriter.write("1;1;1;1;1;1;1;1");
            myFileWriter.flush();
            myFileWriter.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    submitButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            //when button hit update text settings with checked values
            try {
                BufferedWriter myFileWriter = new BufferedWriter(new FileWriter(textSettings, true));
                if(checkBatteryLevel.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkBatteryVoltage.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkCharger.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkCall.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkBluetooth.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkWifiPermis.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkWifiCnct.isChecked())
                {
                    myFileWriter.write("1"+";");
                }
                else
                {
                    myFileWriter.write("0"+";");
                }
                if(checkScreen.isChecked())
                {
                    myFileWriter.write("1");
                }
                else
                {
                    myFileWriter.write("0");
                }
                myFileWriter.flush();
                myFileWriter.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    });
} 
```

以下是 main.xml 的相关部分：

```
<CheckBox
    android:id="@+id/checkBox1"
    android:layout_width="138dp"
    android:layout_height="wrap_content"
    android:text="Battery Level" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Battery Voltage" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Bluetooth State" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Call State" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Charger State" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox8"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Screen State" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Wifi Permission" 
    android:checked="true" />

<CheckBox
    android:id="@+id/checkBox7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Wifi Connection" 
    android:checked="true" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Start Service" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:54:47.180

问题大概是，

*   使用 onCreate，您首先读取设置（如果存在），然后创建 onClickListeners。
*   你在 onResume 方法中做了什么？你在那里做什么？！

这意味着您应该更深入地了解[Android Activity Lifecycle](http://developer.android.com/training/basics/activity-lifecycle/index.html)。

此外，您的设置文件不是首选项的良好实现。除非您希望 1 个应用程序读取另一个 Android 应用程序的设置，否则您应该查看[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)以存储应用程序范围的设置 - 它非常易于使用。

如果你想要一个简单的 UI，并且想要快速完成，这里有一个专门为设置 UI 设计的特殊活动：[PreferenceActivity](http://developer.android.com/reference/android/preference/PreferenceActivity.html) - 虽然稍后你可能会发现它缺少一些功能。

# jquery - 全局 ajax 处理程序不起作用

> ID：12112293
> 
> 赞同：0
> 
> 时间：2012-08-24T15:23:48.770
> 
> 标签：jquery, css, ajax

所以这实际上是一个由两部分组成的问题：为什么它不起作用，我什至应该打扰吗？

我有一个使用大量jquery 的.load() 和.get() 的ajax 应用程序。在我的全局 js 文件中，我添加了这些行来测试 jQuery 的全局 ajaxComlete 函数：

```
$('body').ajaxComplete(function(e){
    alert();
}); 
```

当 ajax 在整个应用程序中运行时，我没有收到任何警报。有谁知道为什么？

我想要这个的原因是因为我有很多通过类名应用的样式，并且每次 ajax 加载基本上都会清除旧类并引入新类。这删除了我的样式。所以我有一个名为 styleForm() 的全局函数，它可以重新应用我的所有样式。我在每个单独的 ajax 回调中调用这个函数。IE：

```
$.get('source.cfm',funcion(){
    styleForm();
}); 
```

我知道拥有这个全局 ajax 函数会产生大多数人可能认为“更清晰”的代码。但这会对性能产生很大影响吗？如果是这样，我不想那样做。如果没有，那么我想让这个工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:30:24.407

您是否尝试将 ajaxComplete 绑定到`$(document)`？

在我们的代码中，我们使用`$.ajaxSetup({})`,`$(document).ajaxStart(function(){})`和`$(document).ajaxStop(function(){})`.

您需要使用的原因`$(document)`：

`$.get`基本上是简写`$.ajax`，它将触发文档上的 ajax 事件（`.ajaxComplete`,`.ajaxError`等）。

`$('body').ajaxComplete`仅当您将 ajax 事件绑定到它或较低的 dom 元素时才会触发。通常这意味着类似`$('<header>').load('http://www.example.com');`

# php - 如何将ajax响应附加到

> ID：12112296
> 
> 赞同：0
> 
> 时间：2012-08-24T15:24:01.040
> 
> 标签：php, ajax, html-table

我有一张表，其中的数据来自数据库，并且该表有很多`<tr>`标签。对于每个`<tr>`标签，我都在修复“+”号，并希望通过单击此“+”来从 Ajax 检索响应。您能告诉我如何使用 Ajax 实现这一目标吗？

这是我的“+”即将到来的表格代码：

```
<table id=\"table_$author_id\" width=\"100%\">
                    <TR bgColor=#F5F5F5>
                        <TD class=normaltext hight=35 align=center><div id=\"test_$author_id\" class=\"test\" style=\"display:inline\">+</div><div id=\"aid_$author_id\" class=\"aid\" style=\"display:inline\">$author_id</div></TD>
                        <TD class=normaltext align=left>$author_name</TD>
                        <TD class=normaltext align=center><a href=\"author_edit.php?aid=$author_id&mode=edit\">Edit</a></TD>
                        <TD class=normaltext align=center><a href=\"author_finance.php?aid=$author_id\">Edit</a></TD>
                        <TD class=normaltext align=center><a href=\"author_list_admin.php?aid=$author_id&mode=delete\">Delete</a></TD>
                    </TR>
                    <table> 
```

我为ajax尝试了这段代码：

```
$(document).ready(function() {

        $('.test').click(function(){

            var URL = 'bangkokbooks/php/admin/author_ajax_detail.php';
            console.log(this.id);
            var ID = this.id;
            var arr= ID.split('_');
            var author_id=arr[1];
            console.log(author_id);

            $.ajax({
                                type: "POST",
                                url: "author_ajax_detail.php",
                                data: "&author_id="+author_id,
                                success: function(html){                

                                            console.log(html);
                                            $('#table_'+author_id).append(html); 
                                      }
                                }); 

        });

    }); 
```

但是通过这种方式，我的对齐方式受到了可怕的干扰。现在请告诉我如何在每个`<tr>`标签下方添加响应，或者告诉我另一种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:26:56.530

将类或 ID 添加到您的`<tr>`-tag 并使用 jQuery 将新内容附加到您的`<tr>`. 这是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:29:36.693

您的 html 不正确：

```
<table id="table_authorId" width="100%">
                    <TR bgColor='#F5F5F5'>
                        <TD class='normaltext' height=35 align='center'><div id="test_$author_id" class="test" style="display:inline">+</div><div id="aid_$author_id" class="aid" style="display:inline">$author_id</div></TD>
                        <TD class=normaltext align=left>$author_name</TD>
                        <TD class=normaltext align=center><a href="author_edit.php?aid=$author_id&mode=edit">Edit</a></TD>
                        <TD class=normaltext align=center><a href="author_finance.php?aid=$author_id">Edit</a></TD>
                        <TD class=normaltext align=center><a href="author_list_admin.php?aid=$author_id&mode=delete">Delete</a></TD>
                    </TR>
                    <table>​ 
```

根据您的要求添加 php 引号。并添加以下 jQuery.ajax 成功回调：

```
jQuery.ajax({
   ........
     success: function(response){
          ......
          $('#table_authorId').append("<tr><td colspan =5>"+response+"</td></tr>");​
          .......................
     }
 }); 
```

这是一个带有常量数据的示例：http: [//jsfiddle.net/aDcQm/1/](http://jsfiddle.net/aDcQm/1/)

# android - 将 Android 项目的资源组织到多个包中

> ID：12112297
> 
> 赞同：4
> 
> 时间：2012-08-24T15:24:04.130
> 
> 标签：android, android-resources, eclipse-adt

我正在使用 Eclipse 开发一个 Android 项目。该项目包含连接到中央核心的多个模块，将它们组织成子包是有意义的，例如

`com.example.myapp`-- 包含核心课程和活动

`com.example.myapp.module1`-- 与模块 1 相关的课程和活动

`com.example.myapp.module2`-- 与模块 2 相关的课程和活动

等等。由于每个模块不能独立工作，因此所有内容都包含在一个 Eclipse 项目中。

现在，将资源也组织到单独的包中会很棒。目前我所有的布局和drawables都被预编译成`com.example.myapp.R`.

有没有办法组织项目，以便 Eclipse 自动将模块 1 的资源放入`com.example.myapp.module1.R`等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:42:35.913

`com.example.myapp.module2.SomeClass`是 Java 包名称，您可以为每个类自由选择它们。你甚至不需要从`com.example.myapp`.

但是`com.example.myapp.R`是从您定义的包名称生成的，`AndroidManifest.xml`并且这是固定的，因为该包名称标识您的应用程序并且资源属于该应用程序。据我所知，没有办法以某种方式将其拆分为更多的包（如果您将其保存在一个项目中）。

但是，如果您使用[库项目](http://developer.android.com/tools/projects/index.html#LibraryProjects)包含在您的应用程序中，您可能会有不同`.R`的 s.

# php - SOAP，对象中的函数

> ID：12112302
> 
> 赞同：2
> 
> 时间：2012-08-24T15:24:16.440
> 
> 标签：php, soap

我正在执行以下操作以通过肥皂公开对象的功能，但它给了我错误

**服务器**：

```
$soap_wrapper = new my_geo_soap_wrapper();
$soap_wrapper->set_geo_app($my_geo);
$server = new SoapServer(null, array('uri' => "urn://localhost/firstmobile"));
$server->setObject($soap_wrapper);
$server->handle(); 
```

**客户**：

```
$client = new SoapClient(null, array(
    'location' => "http://127.0.0.1/firstmobile/simple_server.php",
    'uri'      => "http://127.0.0.1/firstmobile/"
    ));

$result = $client->__soapCall("geolocate",array($lat,$lng));
print $result; 
```

**错误**：

> 致命错误：未捕获的 SoapFault 异常：[SOAP-ENV:Server] 在 /home/imran/projects/firstmobile/simple_client.php:15 中的非对象上调用成员函数 geolocate() 堆栈跟踪：#0 /home/ imran/projects/firstmobile/simple_client.php(15): SoapClient->__soapCall('geolocate', Array) #1 {main} 在第 15 行的 /home/imran/projects/firstmobile/simple_client.php 中抛出

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:03:12.387

我认为错误是在`my_geo_soap_wrapper`课堂上的某个地方。如果我正确阅读了您的代码并且错误，那么 SOAP 调用 ( `$client->__soapCall("geolocate",array($lat,$lng));`) 将映射到`$soap_wrapper->geolocate($lat,$lng)`SOAP 服务器端。

纯粹基于类的名称，我想知道这个“my_geo_soap_wrapper”类是否委托给其他对象，该对象也有一个名为 的方法`geolocate`，这就是错误所在？例如

```
class my_geo_soap_wrapper
{
     function geolocate($lat,$lng)
     {
         // Will blow up if $this->delegated_object hasn't been set correctly
         return $this->delegated_object->geolocate($lat,$lng);
     }
} 
```

纯属猜测，但可能会提出调查途径。

# jsf - jsf在数据表内重复

> ID：12112303
> 
> 赞同：5
> 
> 时间：2012-08-24T15:24:18.933
> 
> 标签：jsf, datatable, repeat

我正在使用数据表，并且动态获取列数。我试着像这样在里面放重复：

```
<h:dataTable  value="#{movieUserBean.sits}" var="row" 
        rowClasses="oddRows,evenRows" headerClass="header"
        styleClass="table" cellpadding="5" cellspacing="0">

      <ui:repeat  value="#{row}" var="sit">
          <h:column>
             <h:selectBooleanCheckbox   value= "#{movieUserBean.checked[sit.id]}"/>
          </h:column>
      </ui:repeat> 
```

坐是一个二维数组，我的想法是数据表应该在坐的行上循环并在每行内的每个值上重复循环（这是一个名为坐的对象，带有get方法：getId）。

问题是我得到了一张空桌子。似乎`var "sit"`没有获得价值。问题可能是数据表忽略了不在列范围内的任何元素吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-02T16:30:33.920

一个简单的解决方案是

```
<table>
    <ui:repeat  value="#{movieUserBean.sits}" var="row">
    <tr>
        <ui:repeat  value="#{row}" var="sit">
          <td><h:selectBooleanCheckbox value= "#{movieUserBean.checked[sit.id]}"/></td>
    </ui:repeat>
    </tr>
    </ui:repeat>
</table> 
```

如果每行有可变列，它可能会与 css 样式混淆。例如，第一行有 5 列，第 2 行有 3 列，您将如何设置它们的样式。我看到它的方式是你想在一个被复选框占据的剧院中显示座位。

您可以尝试将 ui:repeat 与 ul、li 或 div 一起使用，而不是与表一起使用。方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T19:47:46.570

ui:repeat 在渲染响应阶段之前被调用，我建议你使用primefaces的DynamicColumns [http://www.primefaces.org/showcase/ui/datatableDynamicColumns.jsf](http://www.primefaces.org/showcase/ui/datatableDynamicColumns.jsf)

# c# - WCF 服务 - 初始化问题

> ID：12112304
> 
> 赞同：0
> 
> 时间：2012-08-24T15:24:19.857
> 
> 标签：c#, wcf, initialization

我目前正在尝试创建 WCF 服务，然后从命令行应用程序托管它。在托管服务期间，我尝试使用名为 MyProxy 的对象实例对其进行初始化。对服务的所有调用都应委托给 MyProxy。

我创建了一项服务并拨打了电话。但我无法在服务中初始化 MyProxy 实例。它始终为空。因此，当对服务进行任何调用时，我无法将其委托给代理。

从最近两天开始，我一直在努力完成这项工作。我现在迷路了，不知道发生了什么。请帮忙。

```
public class MasOperationsService : IMasOperations
{
    //This MyProxy instance should be used to delegate all calls to service.
    public MyProxy myProxyInstance;

    public MasOperationsService()
    {
        myProxyInstance = null;
    }
    public MasOperationsService(MyProxy proxy)
    {
        myProxyInstance = proxy;
    }

    public CoAuthorSearchResult ExtractCoAuthorsFromAuthor(long authorCellId, uint levelsToExtract)
    {
        //The service will delegate the call to MyProxy.
        //myProxyInstance is always null

        return myProxyInstance.GetProxyData(...);
    }
}

public class MyInstanceProvider : IInstanceProvider
{
    public object GetInstance(InstanceContext instanceContext, Message message)
    {
        MyProxy name = message.Headers.GetHeader<MyProxy>("Name", "http://my.namespace");
        if (name != null)
        {
            return new MasOperationsService(name);
        }
        return null;
    }
    public object GetInstance(InstanceContext instanceContext)
    {
        return new MasOperationsService(null);
    }
    public void ReleaseInstance(InstanceContext instanceContext, object instance)
    {
    }
}

public class MyServiceBehavior : IServiceBehavior
{
    MyInstanceProvider myProvider = new MyInstanceProvider();
    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, Collection<ServiceEndpoint> endpoints, BindingParameterCollection bindingParameters) { }
    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        foreach (ChannelDispatcher cd in serviceHostBase.ChannelDispatchers)
        {
            foreach (EndpointDispatcher ed in cd.Endpoints)
            {
                ed.DispatchRuntime.InstanceProvider = this.myProvider;
            }
        }
    }
    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase) { }
} 
```

该服务是使用启动的，

```
class MyServiceLauncher
{
    ServiceHost host;
    IMasOperations proxy;
    ChannelFactory<IMasOperations> factory;

    public void StartService(MyProxy proxyInstance)
    {
        string baseAddress = "http://localhost:8730/Design_Time_Addresses/MASService/Service1";
        host = new ServiceHost(typeof(MasOperationsService), new Uri(baseAddress));
        host.AddServiceEndpoint(typeof(IMasOperations), GetBinding(), "");
        host.Description.Behaviors.Add(new MyServiceBehavior());
        host.Open();
        Console.WriteLine("Host opened");

        factory = new ChannelFactory<IMasOperations>(GetBinding(), new EndpointAddress(baseAddress));
        proxy = factory.CreateChannel();

        using (OperationContextScope scope = new OperationContextScope((IContextChannel)proxy))
        {
            OperationContext.Current.OutgoingMessageHeaders.Add(MessageHeader.CreateHeader("Name", "http://my.namespace", proxyInstance));
        }
    }

    public void ShutDownService()
    {
        ((IClientChannel)proxy).Close();
        factory.Close();
        host.Close();
    }

    static Binding GetBinding()
    {
        BasicHttpBinding result = new BasicHttpBinding();
        return result;
    }
} 
```

我还在几乎所有地方都放置了一个 Debugger.Launch()，只是为了看到它被初始化（Service 的构造函数和 IInstanceProvider 中的构造函数）。它不会被解雇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:27:58.660

这是缺少的类型。同样在服务中，有一个调用 return myProxyInstance.GetProxyData(...); 删除点编译应用程序。

```
[ServiceContract]
public interface IMasOperations
{
    [OperationContract]
    CoAuthorSearchResult ExtractCoAuthorsFromAuthor(long AuthorCellId, uint LevelsToExtract);
}

public class CoAuthorSearchResult
{ }

public class MyProxy
{ 
    public CoAuthorSearchResult GetProxyData()
    {
        return new CoAuthorSearchResult();
    }
} 
```

@kobac 要求提供一段代码来显示调用 GetInstance 的位置。我不确定如何以及为什么需要这样做。

目前我只是在客户端创建服务类的一个对象——MasOperationsClient 并调用方法 ExtractCoAuthorsFromAuthor()。

# javascript - AngularJS - 覆盖管理布局？

> ID：12112305
> 
> 赞同：1
> 
> 时间：2012-08-24T15:24:25.120
> 
> 标签：javascript, angularjs

我来这里是为了一个关于 angularJS 的小问题......目前我们正在开发一个需要“覆盖”管理样式面板的应用程序。

让我们举个例子：

[http://olivierbossel.com/others/angularJS-overlay.jpg](http://olivierbossel.com/others/angularJS-overlay.jpg)

在第一部分，网址是“myapp.com/#/works”。为了显示这一点，我目前已经配置了我的 $routeProvider.when('/works', { templateUrl: ... etc... 我的模板中有 ng-view 指令来处理模板的加载和显示。好的，这部分...

我的问题是：如何在页面的另一部分显示内容，例如图片的第二部分，其中 url 为“myapp.com/#/admin”？在这种情况下，管理模板必须显示在覆盖样式元素中......

希望有人给我一个答案，这将非常有帮助......

提前致谢 ！

再见 ！最好的问候奥利维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:21:47.353

看看[http://angular-ui.github.com/#directives-modal](http://angular-ui.github.com/#directives-modal)。它基本上根据 ng-model 变量显示/隐藏模态。

**编辑**：这是一个执行您想要的示例：根据 routeParams 在同一页面上打开一个模式：[http ://plnkr.co/edit/DOPmBT?p=preview](http://plnkr.co/edit/DOPmBT?p=preview)

# emacs - 如何使用 elisp 惯用地转换一些文本？

> ID：12112309
> 
> 赞同：3
> 
> 时间：2012-08-24T15:24:33.950
> 
> 标签：emacs, elisp

我有一些我想在 emacs 中处理的 json。我已经找到并使用 elisp 库从 json 中提取所需的内容，我想用我提取的 elisp 等价物替换 json。

这是我写的：

```
(defun extract-foo (start end)
  "Extract the foo field from a json object in the region"
  (interactive "r")
  (let ((my_json (cdr (assoc 'FOO  (json-read-from-string (buffer-substring-no-properties start end))))))
    (delete-region start end)
    (SOMETHING) 
)) 
```

我卡在某事上。我似乎找不到将 my_json 的内容写入标记处的缓冲区的方法。我能想到的唯一方法是将文本保存到临时缓冲区，然后保存`(insert-buffer)`。不过，这对我来说似乎太过分了。

我怎样才能在elisp中惯用地做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:28:47.923

写回 JSON 部分

```
(insert (format "%s" (json-encode my-json))) 
```

写回 elisp：

```
(insert (format "%s" my-json)) 
```

请注意，您在变量命名中使用下划线是违反约定的。

# java - 有没有办法在 Java 中访问 SOL_TCP (AKA IPPROTO_TCP) 套接字选项（例如 TCP_KEEPIDLE）？

> ID：12112310
> 
> 赞同：1
> 
> 时间：2012-08-24T15:24:37.087
> 
> 标签：java, sockets, tcp

我希望能够设置 TCP 套接字 KEEPALIVE 参数（TCP_KEEPIDLE、TCP_KEEPINTVL 和 TCP_KEEPCNT），但这些在[Socket](http://docs.oracle.com/javase/6/docs/api/java/net/Socket.html)类中似乎不可用。根据[SocketImpl](http://docs.oracle.com/javase/6/docs/api/java/net/SocketImpl.html)和[SocketOptions类的文档以及](http://docs.oracle.com/javase/6/docs/api/java/net/SocketOptions.html)[本页](http://docs.oracle.com/javase/6/docs/api/java/net/SocketOptions.html)底部有关实现细节的一些信息，我得出的结论是库实现者将[setsockopt](http://linux.die.net/man/2/setsockopt)的“级别”参数硬编码为 SOL_SOCKET，这使得它无法访问其他级别的选项，例如 SOL_TCP/ [IPPROTO_TCP](http://www.kernel.org/doc/man-pages/online/pages/man7/tcp.7.html). 我是否缺少另一个处理这些选项的 Java 类？如果没有，是否有任何方法可以获取原始文件描述符编号，以便我可以通过 JNI 将其传递给一些直接调用 setsockopt 的 C 代码，因为它似乎无法从[FileDescriptor](http://docs.oracle.com/javase/6/docs/api/java/io/FileDescriptor.html)获得？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:10:09.973

您要查找的联机帮助页是 tcp(7)。请注意，使用 IPPROTO_TCP 代替 SOL_TCP 更安全

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T17:01:18.230

这些都是不可移植的特定于 Linux 的选项，这可能是它们在跨平台语言库中不可用的原因。他们中的大多数人都有各自的条目[`proc(5)`](http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html)和[`sysctl(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/sysctl.2.html)选项。

# coded-ui-tests - 使用升级的 VS2012 解决方案进行测试，但在 VS2010 中构建

> ID：12112315
> 
> 赞同：0
> 
> 时间：2012-08-24T15:25:02.663
> 
> 标签：coded-ui-tests

所以我下载了 VS2012 RTM 并将我的 Coded UI 测试项目升级到 VS2012 版本。

我这样做的原因是由于部分支持 IE9，我遇到了 VS2010 Coded UI 工具的问题。

因此，我在本地和远程（使用新的 Visual Studio 代理工具）上从我的开发人员机器上运行了测试，并且测试成功运行。据推测，我的测试现在起作用的原因是 VS2012 升级了它们，以便它们现在可以与 IE9 一起使用，对吧？

所以 - 这是我的问题。我想通过从我们的构建机器启动它们来自动化这些测试 - 但我们的构建机器仍然在 VS2010 上运行，并且暂时这不会改变。

因此，我将新的 VS2012 Coded UI 测试解决方案签入到 TFS 中，并将新构建排入队列 - 因此构建机器构建了我的解决方案。并且构建成功。那里一切都好。

因此，接下来我在 Microsoft 测试管理器中创建了一个新的测试用例，并与我的新解决方案中的有序测试列表相关联。然后我在我的远程测试环境（具有现有的 VS2010 测试代理工具）上启动了测试（使用现有的 VS2010 测试控制器）。

但是测试失败了——同样的问题影响了我使用 VS2010 Coded UI 测试的测试（由于缺乏对 IE9 的完全支持）

他们为什么失败了？

我的测试控制器和代理是否需要新的 VS 2012 代理工具？我必须在 VS2012 中构建我的解决方案吗？

理想情况下，我不想在我的构建机器上安装 VS2012 RTM - 我想尽可能少地让我的测试工作和自动化。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T00:21:46.840

您的编码 ui 测试引用了 VS 安装或代理安装附带的程序集（这些程序集定义了 WpfControl、鼠标、键盘、播放和其他类）。

因此，如果您在具有旧版本 dll 的构建/测试机器上运行它，同样的问题将继续存在，测试将不会使用 VS2012 附带的较新的固定程序集开始。

作为一种临时解决方法，您可以检查您引用的 dll 并确保构建过程将它们与您的测试程序集放在同一目录中。这样，他们的查找将在当前目录中找到，而无需使用 /path 并在 VS 安装目录中找到它们。

# ios - 如何在免费/高级应用程序中包含限制？

> ID：12112317
> 
> 赞同：-1
> 
> 时间：2012-08-24T15:25:11.530
> 
> 标签：ios, xcode, tableview, restrictions

我想知道当用户加载应用程序的免费版本时，如何在应用程序中包含某些限制。例如：我有一个包含大约 100 个条目的 tableView。用户可以收藏其中的 10 个，但不能更多，除非用户购买了高级版！我想把“return 10”放在FavoritetableViewController 上的numberOfRowsInSection 中。还是有更好/更舒适的方法来做到这一点？

还有评论功能。因此，如果用户看到评论，他/她想要回复，他/她只需点击“回复”即可。但是对于免费用户，我想将互动限制为 5 次。所以他们每天可以写 5 条评论。我正在考虑实现某种内部时钟。每次用户点击“提交”时，计数器都会上升。当计数器达到 5 时，按钮被禁用。在时钟过去 24 小时后，此计数将被重置。但老实说，我还不知道该怎么做。因此，任何想法或输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:55:44.830

我不知道这是否是最好的解决方案，是否会对您有所帮助。对我来说，做到这一点的方法是开设一个单例课程。您应该在应用程序启动时使用 Bool var 溢价初始化他。此时，您应该使用所需的所有数据初始化该类：最喜欢的行数，最后一天的评论，...。

在每次“高级操作”之前，您应该使用以下方法：`BOOL authorized = [[AuthorizeSingleton sharedmanager] operation]`. 在这里，您将获得所有需要的测试，以了解他是否可以执行高级操作。

每次有人想要执行高级操作时，您都应该从 viewController 访问这个单例。如果返回为 NO，则弹出错误消息，在其他情况下，您执行操作。

如果用户是高级用户，总是返回是。

快速编码类似的东西

这里的.h

```
#import <Foundation/Foundation.h>

@interface AuthorizeSingleton : NSObject
@property (strong, nonatomic) NSNumber* premium;
@end 
```

这里是 .m #import AuthorizedSingleton.h

```
AuthorizeSingleton* _sharedInstance=nil;

@interface AuthorizeSingleton ()

@property (strong, nonatomic) NSDate* timestamp;
@property (strong, nonatomic) NSNumber* numberOfcomentary;
@end

@implementation AuthorizeSingleton
@synthesize timestamp=_timestamp, numberOfcomentary=_numberOfcomentary;

-(id)init{
     if (self == [super init]) {
    //Here you should take data from your persistence(NSUSerDefaults or something like that) Here I initialize at 0
         _timestamp=[[NSDate alloc] init];
         _numberOfcomentary= [NSNumber numberWithInt:0];
    }

     return self;
}

+(AuthorizeSingleton*)sharedInstance{
    if (!_sharedInstance) {
        _sharedInstance = [[AuthorizeSingleton alloc] init];
    }

    return _sharedInstance;
}

-(BOOL)shouldDoComentary{
    NSDate* today= [[NSDate alloc] init];
    NSTimeInterval interval = [_timestamp timeIntervalSinceDate: today];

    if (interval>60*60*24) {
        _timestamp=today;
        _numberOfcomentary= [NSNumber numberWithInt:0];
    }

    if (_numberOfcomentary.integerValue>5 && !_premium.boolValue) {
        return NO;
    }

    return YES;
}

@end 
```

我不测试它，但这就是想法。您从需要授权的地方调用课程，例如

```
BOOL auth = [[AuthorizedSingleton sharedInstance] shouldDoComentary]
if(!auth){
    //show error 
}
else{
     //do action
} 
```

# php - 写入会话数据失败，php和memcached

> ID：12112319
> 
> 赞同：16
> 
> 时间：2012-08-24T15:25:17.407
> 
> 标签：php, memcached

我最近尝试在 php 中实现 memcached 以保存会话。我在我的 php.ini 中修改了 session.save_handler 并且在大多数情况下它可以正常工作。会话保存在其中。但是，有时，我会在某些会话中收到这条奇怪的消息：

> PHP 警告：未知：无法写入会话数据（memcached）。请在第 0 行的 Unknown 中验证 session.save_path 的当前设置是否正确 (xxxx:11211)。

会话数据是相同的，在 memcached 的 1MB 障碍下，我还没有看到这条消息出现的模式......可能每分钟几次。该网站通常处于中等负载，同时有 150 个用户。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-08-22T04:06:05.900

如果您使用的是**memcache**，则`save_path`必须具有`tcp://`前缀。

如果您使用的是**memcached**，则不`save_path`应有`tcp://`前缀。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-10T00:48:31.580

答案是 Memcached 对象最大为 1MB（默认）

如果您的数组或对象超出此限制，则该对象将被神奇地删除:)

您会话中的所有项目都将被删除，只是这样说，因为此时此刻我已经亲身体验了

我通过像这样启动 Memcached 会话服务器来解决它

```
memcached -I 10m 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T12:08:24.190

我相信这与使用 memcached 扩展有关，它在会话之前没有初始化。我切换到使用 memcache 扩展而不是 memcached 扩展并且它可以工作。

```
session.save_handler = memcache
session.save_path="tcp://192.168.1.103:11211" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-07T11:43:53.460

我在 docker-compose 堆栈上遇到了 symfony2 和 memcached 的类似问题。

错误说明：

> 警告：无法写入会话数据（用户）。请验证 session.save_path 的当前设置是否正确

问题是我有一个过时的`./app/config/parameters.yml`

检查您的 memchached 设置以满足您的需求，例如：

```
parameters:
    session_memcached.host: '%session_memcached_host%'
    session_memcached.port: '%session_memcached_port%'
    session_memcached.prefix: '%session_memcached_prefix%'
    session_memcached.expire: '%session_memcached_expire%' 
```

# javascript - 用 jasmine 测试 javascript UI 的最佳方法

> ID：12112320
> 
> 赞同：7
> 
> 时间：2012-08-24T15:25:18.250
> 
> 标签：javascript, selenium, tdd, jasmine

我第一次看了一下 jasmine 框架，它看起来很有希望，但是我找不到使用 dom 的简单方法。

我的意思是，模拟用户交互，例如完成和输入，单击按钮，然后检查 dom 是否正确更新，例如在输入验证后显示错误，并显示修改后的数据。就是你通常用 selenium 之类的工具做的事情。

有没有一种标准的方法可以做到这一点，或者是在 jasmine 的域之外进行 ui 测试，我应该为这样的任务寻找另一个框架？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T14:43:47.537

[jasmine-jquery](https://github.com/velesin/jasmine-jquery)是大多数人使用 jasmine 测试 UI 的工具。它允许您创建沙箱装置来运行您的测试，同时定义您需要的大多数匹配器。它非常简单，即使您在应用程序中不依赖 jQuery，也可以很好地进行测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T14:13:14.457

查看街区上的新孩子 [https://github.com/tigbro/jasmine-ui](https://github.com/tigbro/jasmine-ui)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T08:53:38.387

你应该看看 DalekJS（仍处于 alpha 阶段）：

[自动跨浏览器 UI 测试](http://dalekjs.com/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-12T19:46:27.897

我仍在为我寻找一个完美的解决方案，但文章[E2E Testing With WebDriverJS and Jasmine](http://engineering.wingify.com/posts/e2e-testing-with-webdriverjs-jasmine/)看起来提供了一个非常好的方法来使用 Jasmine 和 Selenium。

# iphone - 在 cocos2d 中启动和停止粒子系统

> ID：12112321
> 
> 赞同：1
> 
> 时间：2012-08-24T15:25:27.100
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone

拜托，我想问一下如何在 iOS /cocos2d 中启动粒子系统，让它运行一定的时间，比如 10 秒，然后让它停止。

一个小的代码片段或示例将作为指南将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T16:20:31.720

假设 ps 是你的粒子系统，你可以像这样启动和停止它：

```
[ps resetSystem]; // starts, newly created effects are already running
[ps stopSystem];  // stops 
```

等待 10 秒可以通过以 10 秒间隔调度选择器来完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-15T09:05:32.567

Hope it helps :)

```
-(void)addParticles
{
  [particles resetSystem]; //restarts particles
}

-(void)playParticles //call this later somewhere in your code e.g in touches began [self playParticles];
{
  id playParticles = [CCCallFuncN actionWithTarget:self selector:@selector(addParticles)];
  id stopParticles = [CCCallFuncN actionWithTarget:self selector:@selector(stopParticles)];
  id wait = [CCActionInterval actionWithDuration:3];
  CCSequence *Particlesbegin = [CCSequence actions:wait,playParticles,wait,stopParticles, nil];
  [self runAction: Particlesbegin];
}

-(void)stopParticles
 {
  [particles stopSystem];
 }

//in touches began
if(CGRectContainsPoint(Btn.boundingBox, location))
{
    [self playParticles];
} 
```

# android - Android SearchView 组件的自定义

> ID：12112322
> 
> 赞同：0
> 
> 时间：2012-08-24T15:25:38.557
> 
> 标签：android, android-searchmanager

我需要一个组件，它允许用户输入一个值并通过连接到 Internet 上的某个站点来检查它是否存在，并在用户输入时显示建议。我想为此使用 SearchView 组件，但发现它有一些限制：

1.  开发人员必须创建一个单独的活动来处理搜索。我不想使用其他活动，我只想连接到该站点并检查用户键入的内容是否存在。

2.  为了使用建议机制，开发者必须建立一个内容提供者。同样，我不想连接到任何数据库，我只需要使用标准 HTTP 消息向站点发送搜索查询，为此我不需要内容提供程序。

所以我的问题是：有没有办法将 SearchView 组件与我需要的定制一起使用，还是我必须找到符合组件要求的丑陋变通办法，但也可以做我需要的？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:05:30.407

这很简单。您只需使用 Google 的搜索功能，当用户长按菜单按钮时，它会加载一个搜索文本框，您可以在其中输入搜索查询以在您的应用程序中进行搜索。

可搜索的应用程序文件必须包含该元素作为根节点并指定一个或多个属性。例如

`<?xml version="1.0" encoding="utf-8"?>`
`<searchable xmlns:android="http://schemas.android.com/apk/res/android"` `android:label="@string/app_label"`
`android:hint="@string/search_hint" >`
`</searchable>`

然后声明一个活动来接受 ACTION_SEARCH 即

`<application ... >`
`<activity android:name=".SearchableActivity" >`
`<intent-filter>`
`<action android:name="android.intent.action.SEARCH" />`
`</intent-filter>`
`<meta-data android:name="android.app.searchable"`
`android:resource="@xml/searchable"/>`
`</activity>`
`</application>`

现在我们需要控制查询及其执行方式。我将它用于我的应用程序。

`@Override`
`public void onCreate(Bundle savedInstanceState) {`
`super.onCreate(savedInstanceState);`
`setContentView(R.layout.search);`

`// Get the intent, verify the action and get the query`
`Intent intent = getIntent();`
`if (Intent.ACTION_SEARCH.equals(intent.getAction())) {`
`String query = intent.getStringExtra(SearchManager.QUERY);`
`doMySearch(query);`
`}`
`}`

[![](../Images/dc8cb918af09925459f09f0474c9be2c.png)安卓安卓](/questions/tagged/android "显示标记为“android”的问题") [搜索](/questions/tagged/androidsearch "显示标记为“androidsearch”的问题")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:07:32.963

你不应该在你的 UI 线程上运行 HTTP 请求，因为你不能保证它们会及时完成，所以它们可能会被锁定。您至少需要在可运行或 ASyncTask 中运行它。

如果您想要一种快速的肮脏黑客方式，您可以创建一个 ListFragment 来显示您的自定义建议。然后创建一个 OnQueryTextListener（或让您的 Activity 实现它）在 SearchView 上设置它。然后在侦听器的方法中`onQueryTextChange(String text)`生成建议（如果从 web 服务获取此方法会启动您的 ASyncTask），然后使用数据更新 ListFragment 适配器

# c# - 如何使用 DDay.iCal 创建 Outlook“约会”？

> ID：12112323
> 
> 赞同：8
> 
> 时间：2012-08-24T15:25:40.060
> 
> 标签：c#, asp.net, icalendar, dday

我正在使用 DDay 库来创建 iCal 事件，以便我网站的用户可以在他们的日历中添加一些内容。

我希望他们添加约会，而不是 Office 2010 中的会议请求（希望还有其他人）。当我使用库并将方法设置为 PUBLISH 时，它确实显示为约会，但报告在日历中找不到会议。然后，当我单击不需要响应时，该项目将被删除并且不会保留在他们的日历中。

如果我将方法更改为 REQUEST，它会显示为会议请求。这将是第二好的选择，但“to”字段为空白。如果这是我能做的最好的，我该如何设置“到”字段？我想我会让他们自己回应。

```
private static string CreateCalendarEvent(
    string title, string body, DateTime startDate, double duration, 
    string location, string organizer, string eventId, bool allDayEvent)
{
    // mandatory for outlook 2007
    if(String.IsNullOrEmpty(organizer))
        throw new Exception("Organizer provided was null");

    var iCal = new iCalendar
    {
        Method = "PUBLISH",
        Version = "2.0"
    };

    // "REQUEST" will update an existing event with the same UID (Unique ID) and a newer time stamp.
    //if (updatePreviousEvent)
    //{
    //    iCal.Method = "REQUEST";
    //}

    var evt = iCal.Create<Event>();
    evt.Summary = title;
    evt.Start = new iCalDateTime(startDate);
    evt.Duration = TimeSpan.FromHours(duration);
    evt.Description = body;
    evt.Location = location;
    evt.IsAllDay = allDayEvent;
    evt.UID = String.IsNullOrEmpty(eventId) ? new Guid().ToString() : eventId;
    evt.Organizer = new Organizer(organizer);
    evt.Alarms.Add(new Alarm
    {
        Duration = new TimeSpan(0, 15, 0),
        Trigger = new Trigger(new TimeSpan(0, 15, 0)),
        Action = AlarmAction.Display,
        Description = "Reminder"
    });

    return new iCalendarSerializer().SerializeToString(iCal);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:25:40.060

当我将组织者设置为电子邮件地址而不是测试字符串时，它工作正常。我已经写了所有这些，所以我想我会分享它以防其他人遇到同样的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T09:05:18.660

当 Exchange 服务器从 2003 年升级到 Outlook 2010 时，我的应用程序停止工作。在升级之前 PUBLISH 工作正常，但现在我不得不更改为 REQUEST

谢谢你的文章

# java - 使用简单 XML 序列化 TimeUnit

> ID：12112327
> 
> 赞同：1
> 
> 时间：2012-08-24T15:25:52.880
> 
> 标签：java, enums, simple-framework

如何使用**Simple XML** lib（版本 2.6.5 / 2.6.6）序列化**java.util.concurrent.TimeUnit ？**

 **这是我要序列化的课程：

```
@Root(name="settings")
public class Config
{
    // some more code

    @Element(name="timeunit", required=true)
    private static final TimeUnit timeunit = TimeUnit.SECONDS;

    // some more code
} 
```

使用简单：

```
File f = // ...
Config cfg = new Config();
Serializer ser = new Persister();

ser.write(cfg, f); 
```

我得到了这个例外：

```
org.simpleframework.xml.transform.TransformException: Transform of class java.util.concurrent.TimeUnit$4 not supported 
```

到目前为止，我测试了其他注释，如 @Default，但同样的问题。想知道为什么 Simple 对 TimeUnits 有问题 - 所有其他类型（类/原始类型）都可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T19:53:45.523

这是一个可能的解决方案：

**注解：**

```
@Element(name="timeunit", required=true)
@Convert(TimeUnitConverter.class)
private static final TimeUnit timeunit = TimeUnit.SECONDS; 
```

**转换器：**

```
public class TimeUnitConverter implements Converter<TimeUnit>
{
    @Override
    public TimeUnit read(InputNode node) throws Exception
    {
        return TimeUnit.valueOf(node.getValue().toUpperCase());
    }

    @Override
    public void write(OutputNode node, TimeUnit value) throws Exception
    {
        node.getAttributes().remove("class"); /* Not required */
        node.setValue(value.toString().toLowerCase());
    }

} 
```**

# ruby-on-rails - 需要为 Ruby on rails 生成的结果列表添加别名

> ID：12112329
> 
> 赞同：0
> 
> 时间：2012-08-24T15:25:57.033
> 
> 标签：ruby-on-rails, json, rails-models

原谅我模糊的话题，我目前正在开发一个具有三个模型用户、列表和项目的 Rails 应用程序。用户有很多列表，一个列表可以有很多项目。我目前正在研究一种显示用户拥有的列表数量的方法，并且我需要该列表能够为我提供其中的项目数量。我相信有一种方法可以解析这些数据，而无需在列表模型中创建列项。请原谅我，因为我是 Rails 新手，我确信有一种非常简单的方法可以做到这一点。下面是我的方法的语法以及类列表和项目。提前致谢。（我只是想在列表数据中解析出每个列表中的项目数）

```
def showLists
     pageSize = 10
     pageNum = 1
     if (params[:limit])
       pageSize = (params[:limit])
       pageSize = pageSize.to_i
     end
     pageNum= (params[:page]) 
     pageNum = pageNum.to_i   
     @key = PrivateKey.find(1)
     @key = @key.key     
     if (params[:apiKey]) == @key 
      @user = User.find_by_facebookexternalId(params[:id])
      if @user.access_key.key == (params[:accessToken])         
         y =(pageSize*pageNum)
         x =(y-pageSize) 
         @list = @user.lists 
         total= @list.count
         @list = @list.all(:select=>[:name,:id,:listtype,:description ], :include=>[:items=>@list[x].items.count])    
         @list = @list[x .. y] 
         #listResponse={:name=>@list.name}        
         response = {:total =>total,:page => pageNum, :limit=> pageSize, :userId=> @user.id, :accessToken=> @user.access_key.key , :list=>@list } 
         #response = {:lists => @list}
         respond_to do |format|
           format.json {render :json  => response}
         end
      end        
     end
   end 
```

架构信息

```
# == Schema Information
#
# Table name: lists
#
#  id          :integer          not null, primary key
#  name        :string(255)
#  active      :boolean
#  user_id     :integer
#  listtype    :string(255)
#  description :text
#  roughlist   :boolean
#  created_at  :datetime         not null
#  updated_at  :datetime         not null
#

class List < ActiveRecord::Base
  attr_accessible :name, :active , :type , :description , :roughlist,  :listtype
  belongs_to :user, :foreign_key => :user_id
  has_many :map_list_items
  has_many :items, :through => :map_list_items
  #has_and_belongs_to_many :items

end

And my item schema is here

# == Schema Information
#
# Table name: items
#
#  id          :integer          not null, primary key
#  name        :string(255)
#  description :string(255)
#  user_id     :integer
#  barcode     :string(255)
#  asin_id     :string(255)
#  isbn_id     :string(255)
#  barcode_id  :integer
#  created_at  :datetime         not null
#  updated_at  :datetime         not null
#

class Item < ActiveRecord::Base
  belongs_to :barcode , :foreign_key => :barcode_id
  has_many :map_item_tags
  has_many :map_list_items
  has_many :lists, :through => :map_list_items
  #has_and_belongs_to_many :lists

end 
```

我得到的json文件示例如下

```
{
    "total": 3,
    "page": 1,
    "limit": 10,
    "userId": 5,
    "accessToken": "BAAFdQiIeExEBAOwtEtFXgI0c2k9kka3EQbEBDca2FGJZBQyIOLGfnJQr7k1FaGFEx6dzzWxQkxZB4uFSEj3HvZARyZBKLtTzn9NhEXEBtsBxuPBf2O5PxtofkZC4GQg9OmWGahJ42kZBuEay68rlDb",
    "list": [
        {
            "description": "",
            "id": 1,
            "listtype": "christmas",
            "name": "mom"
        },
        {
            "description": "",
            "id": 2,
            "listtype": "christmas",
            "name": "mom"
        },
        {
            "description": "",
            "id": 3,
            "listtype": "christmas",
            "name": "mom"
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:40:38.130

对 json 使用acts_as_api gem。即使通过模型，它也使制作 json 变得非常容易。在那里你可以简单地添加你自己的属性。

# c - C如何检索二维数组的行地址

> ID：12112330
> 
> 赞同：2
> 
> 时间：2012-08-24T15:25:59.740
> 
> 标签：c, pointers, multidimensional-array, pointer-arithmetic

当您只使用一个下标访问二维数组时，有人可以向我解释 C 如何检索一行的正确内存地址吗？

例子 -

```
int array2D[2][2] = {1,2,3,4};
printf ( "starting address of row2 = %p" , array2D[1]); 
```

我知道在 C 中下标时实际上发生的是指针添加，因此对于一维数组，数组名称指向元素 0。在这种情况下，如果我想要元素 1，编译器将采用起始地址（比如 4000）和向它添加 4（假设为 4 位 int），以便返回的是内存地址 4004 处的项目。

我的理解是，当您填充二维数组时，如我的示例所示，它们是按顺序分配的，所以我会有

1 2
3 4
在地址

4000 4004

4008 4012

那么 C 如何计算出在这种情况下 array2D[1] 应该指向 4008 而不是 4004？它是运行 sizeof() 运算符还是我在这里误解了基本原理？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:29:52.503

C 知道每行有多长，因此它会通过乘法来找到该行。

```
int x[][3] = {{1,2,3},{4,5,6}}; 
```

然后`&x[1][0]`是`&x[0][0]`加号`3 * sizeof(int)`。

这就是为什么在多维 C 数组声明中，必须指定除第一个维度之外的所有维度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:52:11.077

指针算法取决于所指向元素的类型。给定一个指向`p`type的指针`T`，指向type`p + 1`的下一个*元素*`T`，不一定是下一个字节`p`。如果`T`是`char`，则`p + 1`指向`char`之后的下一个对象`p`，该对象从紧随其后的字节开始`p`；如果`T`是`char [10]`，则`p + 1`指向after的下一个*10 元素数组`char`*`p`，该数组从 后面的第 10 个字节开始`p`。

*中的表达式* 的类型`array2d`是“2-element array of 2-element array of `int`”，它“衰减”为类型“pointer to 2-element array of `int`”，或`int (*)[2]`¹。因此，表达式`array2d[1]`被解释为`*(array2d + 1)`。由于`array2d`指向 类型的对象`int [2]`，因此`array2d + 1`指向下一个 2 元素数组`int`following `array2d`，它`2 * sizeof int`距`array2d`.

* * *

^(1\. 除非它是`sizeof`或一元运算符的操作数`&`，或者是用于在声明中初始化另一个数组的字符串字面量，否则“N-element array of `T`”类型的表达式将转换为“pointer”类型的表达式to `T`" 并且它的值将是数组中第一个元素的地址。)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:52:23.647

这会有点啰嗦，但请耐心等待。

数组订阅只是一种简写：指针类型在所有上下文中都`(p[N])`等于`(*(p + N))`（尽管两者都是无效的表达式`void*`）。

现在，如果`p`是数组类型，它会在表达式中衰减为指针类型，例如`(*(p + N))`; an`int[2][2]`将衰减为类型的指针`(*)[2]`（即指向 an 的指针`int[2]`）。

指针算术将类型考虑在内；我们需要将事物转换`char*`为可视化编译器对我们所做的事情：

```
T *p;
p[N] equals *(p + N) equals *(T*)((unsigned char*)p + N * sizeof *p) 
```

现在，如果`T`是一个`int[2]`（等于我们上面描述的情况），那么`sizeof *p`就是`sizeof(int[2])`，即`2 * sizeof(int)`。

这就是订阅在所谓的多维数组中的工作方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T16:08:51.173

sizeof(array2D[1]) == 8;
如果array2D地址是4000；
所以 array2D[1] 地址是 4000+sizeof(array2D[1]) == 4000+8;

# javascript - Javascript MV* 的功能替代品？

> ID：12112333
> 
> 赞同：5
> 
> 时间：2012-08-24T15:26:28.183
> 
> 标签：javascript, backbone.js, functional-programming

我喜欢 Backbone.js 如何为根据 OOD 构建 javascript 前端代码提供约定。是否有类似的框架或库，类似地提供与 DOM、用户事件和 ajax 交互的约定……但以功能风格？

编辑：

例如，要更改主干“Person”模型对象的名称：

```
person.set("name", "bob"); 
```

其中有状态地修改了“人”对象并且不是功能样式。一种功能替代方案将使模型不可变并返回新副本：

```
person = person.set("name", "bob"); 
```

# jaxb - 以编程方式确定 JAXB 注释是否会导致 xsi:type 注释？

> ID：12112335
> 
> 赞同：1
> 
> 时间：2012-08-24T15:26:44.670
> 
> 标签：jaxb

回顾 JAXB 注释对象，有没有办法确定一个类/字段/方法是否会在封送处理期间导致 xsi:type 属性？

XmlElement 注释是
`annotation.type != javax.xml.bind.annotation.XmlElement.DEFAULT.class`
我唯一需要担心的情​​况吗？

我正在编写一个 Lua 解组器，我们在其中删除了许多常用的 xml 类型信息，并且我试图弄清楚如何将传入的 Lua 与 JAXB 匹配。

谢谢。

- 更新 -

这是显示问题的简单示例：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement()
@XmlSeeAlso({ Cat.class, Dog.class })
public class Animal {
  @XmlElement()
  public List<Animal> critters;
  @XmlAttribute
  public String type;
}

@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement()
public class Dog extends Animal {
  public Dog() {
    this.type = "German Shepherd";
  }
}

@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement()
public class Cat extends Animal {
  public Cat() {
    this.type = "Black";
  }
} 
```

当我收到一个 Animal 对象时，我可以查询 critter 的注释以检测它应该是 Dog 还是 Cat 而不是 Animal？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:43:39.137

在几种情况下，[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)实现会写出 xsi:type 属性。

1.  如果字段/属性是类型`Object`（或用 注释`@XmlElement(type=Object.class)`）并且未映射`@XmlAnyElement(lax=true)`并保存具有映射的 Object 的实例`JAXBContext`。
2.  表示继承的默认机制将产生一个`xsi:type`表示子类的属性（参见： [http](http://blog.bdoughan.com/2010/11/jaxb-and-inheritance-using-xsitype.html) ://blog.bdoughan.com/2010/11/jaxb-and-inheritance-using-xsitype.html ）。

# c++ - 从已编译的可执行文件中获取编译器选项？

> ID：12112338
> 
> 赞同：63
> 
> 时间：2012-08-24T15:27:05.467
> 
> 标签：c++, c, linux

有没有办法查看在 *nix 中创建可执行文件时使用了哪些编译器和标志？我编译了旧版本的代码，我想看看它是否经过优化编译。谷歌并没有太大帮助，但我不确定我使用的关键字是否正确。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-08-24T15:36:02.360

gcc 有一个`-frecord-gcc-switches`选项：

```
 -frecord-gcc-switches
       This switch causes the command line that was used to invoke the compiler to
       be recorded into the object file that is being created.  This switch is only
       implemented on some targets and the exact format of the recording is target
       and binary file format dependent, but it usually takes the form of a section
       containing ASCII text. 
```

之后，ELF 可执行文件将包含包含`.GCC.command.line`该信息的部分。

```
$ gcc -O2 -frecord-gcc-switches a.c
$ readelf -p .GCC.command.line a.out 

String dump of section '.GCC.command.line':
  [     0]  a.c
  [     4]  -mtune=generic
  [    13]  -march=x86-64
  [    21]  -O2
  [    25]  -frecord-gcc-switches 
```

当然，它不适用于没有该选项编译的可执行文件。

* * *

对于简单的优化案例，如果文件是使用调试信息编译的，您*可以尝试使用调试器。*如果您稍微浏览一下，您可能会注意到一些变量被“优化”了。这表明进行了优化。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-24T15:33:54.157

如果您使用该`-frecord-gcc-switches`标志进行编译，那么命令行编译器选项将被写入注释部分的二进制文件中。[另请参阅文档](http://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-11-20T20:15:35.800

另一个选项是 -grecord-gcc-swtiches（注意，不是 -f 而是 -g）。根据 gcc 文档，它会将标志放入 dwarf 调试信息中。并且看起来它从 gcc 4.8 开始默认启用。

我发现 dwarfdump 程序对于提取这些 cflags 很有用。注意，字符串程序看不到它们。看起来矮人信息被压缩了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-24T15:30:22.747

这是需要编译器支持的东西。您没有提及您正在使用什么编译器，但是由于您标记了您的问题`linux`，我将假设您正在使用 gcc - 这不会默认您询问的功能（但 -frecord-gcc-switches 是执行此操作的选项）。

如果您想检查您的二进制文件，该`strings`命令将向您显示文件中似乎是可读字符串的所有内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-12-30T13:37:34.127

只要可执行文件是由 gcc 使用`-g`选项编译的，以下内容就可以解决问题：

```
readelf --debug-dump=info /path/to/executable | grep "DW_AT_producer" 
```

例如：

```
% cat test.c
int main() {
    return 42;
}
% gcc -g test.c -o test
% readelf --debug-dump=info ./test | grep "DW_AT_producer"
    <c>   DW_AT_producer    : (indirect string, offset: 0x2a): GNU C17 10.2.0 -mtune=generic -march=x86-64 -g 
```

可悲的是，clang 似乎并没有以类似的方式记录选项，至少在版本 10 中是这样。

当然，`strings`也会出现这种情况，但是必须至少对要查找的内容有所了解，因为用肉眼检查现实世界二进制文件中的所有字符串通常是不切实际的。例如，上面示例中的二进制文件：

```
% strings ./test | grep march
GNU C17 10.2.0 -mtune=generic -march=x86-64 -g -O3 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-24T16:24:44.350

如果您仍然有您使用的编译器（相同版本），并且它只是您不确定的一个标志，您可以尝试再次编译您的代码，一次有和一次没有标志。然后您可以比较可执行文件。您的旧的应该与新的之一相同或非常相似。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-24T15:30:51.803

我非常怀疑这是可能的：

```
int main()
{
} 
```

编译时：

```
gcc -O3 -ffast-math -g main.c -o main 
```

在生成的对象中找不到任何参数：

```
strings main | grep -O3
(no output) 
```

# c# - 存储标签数据的好方法

> ID：12112341
> 
> 赞同：1
> 
> 时间：2012-08-24T15:27:12.177
> 
> 标签：c#, tabs, storing-data

我正在开发一个带有选项卡式界面的程序，我的问题是我需要一种方法来将数据存储在每个选项卡中，以便它与程序关闭时相同。我想使用数据库，但 Visual C# express 2010 不是最好的数据库，我正在考虑使用简单的文本文件，但我认为可能有更好的方法，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:31:44.787

如果您有强类型实体并且正在使用[Windows 窗体数据绑定](http://msdn.microsoft.com/en-us/library/ef2xyb33.aspx)，那么您可以在退出应用程序时序列化绑定的实体（例如使用 XmlSerializer），然后在应用程序重新启动时加载表单时重新序列化它们。

# c# - C# app.config 文件和 UAC

> ID：12112346
> 
> 赞同：0
> 
> 时间：2012-08-24T15:27:45.743
> 
> 标签：c#, app-config, uac

我从我的应用程序开始将配置写入注册表，就像几年前 UAC 不存在时所做的那样。

原来这不是一个好主意，所以我转到`app.config`文件，发现 UAC 也有问题。

我对应用程序的配置是特定于机器的；个人用户没有自己的配置，包括服务在内的其余应用程序都驱动了单个配置文件。

如果我尝试在程序 files\myapp 文件夹中更新此文件，它会被拒绝。

对于这种需要单个配置文件的场景，其他人都在做什么？

我还应该提到，需要从我的应用程序中更新此配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:33:50.203

我会使用 Common Application Data 文件夹，这是大多数新应用程序存储与 UAC 一起使用的数据的地方。

您可以使用以下代码获取此信息：

```
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) 
```

要查看特殊文件夹的所有选项，您可以查看此链接：

[http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

最常见的选项如下：

**应用程序数据**- 用作当前漫游用户的应用程序特定数据的公共存储库的目录。

**公共应用程序数据**- 用作所有用户使用的特定于应用程序数据的公共存储库的目录。

**本地应用程序数据**- 用作当前非漫游用户使用的特定于应用程序数据的公共存储库的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:34:19.617

您应该将用户的设置存储在`app.config`您应该使用`user.config`的 . 在[这里](http://msdn.microsoft.com/en-us/library/8eyb2ct1.aspx)查看更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:34:34.890

任何机器范围的配置文件都应该存储在：

```
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData); 
```

除非安装/更新应用程序，否则不应修改 Program Files 中的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:34:41.793

我对 WPF 应用程序有类似的需求。我要做的是：

1.  使用样板配置文件安装应用程序。
2.  当应用程序运行时，它会在用户的应用程序数据目录中检查配置文件中的配置文件，如果它们不存在，它会从安装目录复制默认的样板配置文件。
3.  然后我会做任何需要的首次运行初始化工作。

我开始使用 .NET ConfigurationManager，但我切换到一个普通的旧 XML 文件，因为它更简单而且我的要求是基本的。

# objective-c - GTM-OAuth 2.0 多个发布数据参数？

> ID：12112348
> 
> 赞同：0
> 
> 时间：2012-08-24T15:27:50.233
> 
> 标签：objective-c, xcode, oauth-2.0, google-toolbox-for-mac

简单的在这里。在 GTM-OAuth 2.0 中，我如何发送多个 post 参数？这是我现在发布数据的方式：

```
 NSString *postString = [NSString stringWithFormat:@"i=%@",articleIndex];
        [myFetcher setPostData:[postString dataUsingEncoding:NSUTF8StringEncoding]]; 
```

我的问题是如何发送多个参数，如 i=1&t=2？是这样吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:27:44.173

它只是一个不同的格式字符串，比如

```
NSString *postString = [NSString stringWithFormat:@"i=%d&t=%d", i, t]; 
```

另一种常见的技术是将参数对像字符串一样`@"i=1"`放入 NSArray 中，并使用 NSArray 的连接方法`[array componentsJoinedByString:@"&"]`, 来制作完整的字符串。

# java - 为什么即使我的字体是从文件创建的，我也必须调用 GraphicsEnvorinment.registerFont()？

> ID：12112353
> 
> 赞同：3
> 
> 时间：2012-08-24T15:28:06.263
> 
> 标签：java, fonts, awt, jfreechart

我正在开发一个使用 JFreeChart 来呈现图表的 Web 应用程序。但是，当服务器没有安装任何中文字体时，即使我设置了字体，JFreeChart 也不显示中文字符。

然后我写了一个小测试代码，发现在绘制图表之前添加这行代码可以解决问题。

```
GraphicsEnvironment.getLocalGraphicsEnvironment().registerFont(font); 
```

所以我的问题是——

1.  **为什么即使我从文件创建字体，我也必须将字体注册到 JVM 中？**这是否意味着 JFreeChart 不使用我直接设置的字体？

2.  当我将程序部署到服务器时，即使我添加了这行代码，它也不显示汉字。**如何让它始终使用我设置的字体以便在所有环境中正确显示字符？**

我知道我可以创建一个`fallback`目录`$JAVA_HOME/jre/lib`并将我的字体放入其中。但这并不能解释为什么 JFreeChart 不能用我设置的字体显示。

# 更新

我很确定字体已正确加载，`registerFont()`当我将程序部署到 Tomcat 时也返回 true。

# 更新 2

根据[JAVA 2D FAQ](http://java.sun.com/products/java-media/2D/reference/faqs/index.html#Q_How_can_I_make_my_custom_font)，现在我意识到我必须调用`registerFont()`才能将我自己的字体“安装”到 JVM 中，并且我的字体将通过`Font`构造函数可用。

> 从 Java SE 6 开始，有一个方法：GraphicsEnvironment.registerFont()，它使您能够使“创建的”字体可用于 Font 构造函数并通过 Font 枚举 API 列出。Font.createFont() 和这个方法结合起来提供了一种将字体“安装”到正在运行的 JRE 中的方法，因此它就像 O/S 安装的字体一样可用。但是，此字体不会在 JRE 调用中持续存在。

但是，既然我已经`Font`创建/派生了实例`createFont()`，为什么我的程序还不需要创建其他的`Font`？

* * *

以下是我使用的代码，它只是以 PNG 格式输出图表。如果你想运行代码，你应该改变输出位置和字体以满足你的需要，[这里是](http://sourceforge.net/projects/wqy/files/wqy-zenhei/0.9.45%20%28Fighting-state%20RC1%29/)我在代码中使用的中文字体的 SourceForge 链接。

```
import java.awt.Font;
import java.awt.GraphicsEnvironment;
import java.io.File;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartUtilities;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.StandardChartTheme;
import org.jfree.data.general.DefaultPieDataset;
import org.jfree.data.general.PieDataset;

public class Problem {

  public static void main(String[] args) throws Exception {
    setJFreeChartTheme();

    PieDataset dataset = createDataSet();
    JFreeChart chart = ChartFactory.createPieChart(
        "Chinese Testing", dataset, true, true, false);
    ChartUtilities.saveChartAsJPEG(new File("/tmp/output.png"), 
        chart, 800, 600);

    System.out.println("Done");
  }

  private static void setJFreeChartTheme() throws Exception {
    Font font = loadFont();
    //==================================================================
    GraphicsEnvironment.getLocalGraphicsEnvironment().registerFont(font);
    //==================================================================
    StandardChartTheme theme = new StandardChartTheme("Chinese font", true);
    theme.setExtraLargeFont(font.deriveFont(Font.BOLD, 20));
    theme.setLargeFont(font.deriveFont(Font.BOLD, 16));
    theme.setRegularFont(font.deriveFont(Font.PLAIN, 14));
    theme.setSmallFont(font.deriveFont(Font.PLAIN, 12));
    ChartFactory.setChartTheme(theme);
  }

  private static Font loadFont() throws Exception {
    File file = new File("/tmp/wqy-zenhei.ttc");
    return Font.createFont(Font.TRUETYPE_FONT, file);
  }

  private static PieDataset createDataSet() {
    DefaultPieDataset dataset = new DefaultPieDataset();
    dataset.setValue("種類1", Integer.valueOf(1));
    dataset.setValue("種類2", Integer.valueOf(2));
    dataset.setValue("種類3", Integer.valueOf(3));
    return dataset;
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-03T01:54:27.357

当您直接从 TTF 创建一个时`Font`，Java 显然知道从该单个 Font 对象中获取字体文件本身的副本的位置。那么为什么字体也需要注册才能使用呢？**答案是它并不总是必须被注册**，或者至少只要整个控制链`Font`直接使用原始对象就可以了。

## 当 Java 尝试渲染字体时，到底发生了什么？

细微差别在于 JFreeChart 要求呈现文本的方式。文本的渲染是在`TextUtilities#drawRotatedString`jcommon 的方法中执行的。在 JDK7 上，默认情况下，此方法将：

*   `AttributedString`根据您传入的字体的“属性”创建一个，
*   调用`Graphics2D#drawString`属性字符串，然后
*   创建一个新`TextLayout`对象。

`TextLayout`是选择要提供给的实际 Font 对象的类`Graphics2D`。`TextLayout`旨在支持使用各种字体渲染多语言文本（即使同一个源字符串需要以多种字体渲染），通过使用自动字体选择来为每段字符串找到合适的字体。

上面提到的“属性”是关于字体的简单事实（如字体系列名称、大小等），它们源自`Font`您提供的字体。如果您提供的字体无法呈现输入字符串中的所有字符，则这些属性用于选择相似的字体以用于需要使用不同字体的文本运行。

当 JFreeChart 调用 TextLayout 时，它总是这样运行：

*   `Font`从您提供的对象中提取属性，
*   调用*static* `Font#getFont`以获取与提供的属性匹配的字体（请参阅 参考资料`TextLayout#singleFont`），以及
*   使用返回的（可能不同的）Font 对象来绘制文本。

如果你没有在某处*静态*`GraphicsEnvironment#registerFont`注册你的字体（比如使用），那么*静态* `Font#getFont`方法所要做的就是包含字体系列名称的属性字符串。它不知道在哪里访问包含对 TTF 的引用的 Font 对象，更不用说实际呈现字体所需的任何数据了。

# 好的，但我以为你说我不需要注册字体？

如果您不想注册字体，那么诀窍在于确保您的文本仅使用`Font`您提供的对象呈现。碰巧有另一个构造函数直接`TextLayout`接受一个`Font`对象，而不是一组用于查找字体的属性。

有用的是，JFreeChart 甚至提供了一种强制它使用此构造函数的方法。在`TextUtilities#drawRotatedString`中，可以使用一个特殊的配置参数来强制 JFreeChart使用您提供`TextLayout`的确切对象来构造对象本身。`Font`

为此，您可以像这样设置 jcommon.properties 文件：

*   创建一个名为的资源文件`jcommon.properties`（最终应位于类路径/JAR 的根级别），并且
*   添加以下行：

`org.jfree.text.UseDrawRotatedStringWorkaround=true`

或者简单地调用静态函数：

```
TextUtilities.setUseDrawRotatedStringWorkaround(true) 
```

这将要求 JFreeChart 直接使用您的字体呈现文本，并且...**瞧！即使没有注册字体，它也可以工作**。这是在上述问题的上下文中测试的，即使用 JFreeChart 将文本直接呈现为光栅图像。如果您尝试渲染到显示设备（我没有尝试过），您的里程可能会有所不同。

# 不注册字体是否明智？

我不能肯定地说。我的一个应用程序在 OSGi 容器中运行，我担心通过静态注册永远无法取消注册的字体来创建 PermGen 类加载器泄漏。直接使用 Font 对象可以避免这个问题，这就是我想走这条路的原因。我想如果你这样做，一个特定的 Java 平台总是可能会遇到问题，但这在我的测试中运行良好，至少在 Windows、Linux 和 OS X 主机上使用 Oracle JDK 7。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T17:05:03.043

> 为什么即使我从文件创建字体，我也必须将字体注册到 JVM 中？

JVM 怎么知道你的字体存在？

您的字体必须在 JVM 中注册，以便 Java 知道如何在 JFreeChart 用于呈现图表的图形环境中绘制您的字体。

> 如何让它始终使用我设置的字体以便在所有环境中正确显示字符？

您需要检查该`registerFont()`方法是否返回 true。如果它返回 false，则您的字体不可用。

看起来您正在正确加载字体。也许您的字体的文件路径在您的服务器上不正确。你可能想试试

```
getClass().getResource(fontPath); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-29T20:12:08.183

我知道这是一个老问题，但我自己正在寻找答案并看到上面的回复，我仍然没有真正理解注册字体的目的。研究了这个问题后，我发现了这个问题：

您不必在图形环境中注册字体，但这样做的好处是能够在“new Font()”构造函数中使用注册的字体。

您可以使用以下代码获取当前可用的所有字体的列表（即已安装并准备在您的应用程序中使用）：

```
String fonts[] = GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames(); 
```

假设您在 Windows 上，并且安装的字体之一是 Arial，您可以在应用程序中使用此字体，如下所示：

```
JButton yesButton = new JButton ("Yes");
yesButton.setFont(new Font("Arial", Font.PLAIN,30)); 
```

现在假设您要从文件中加载并使用您自己的自定义字体：

```
Font robotoFont = Font.createFont(Font.TRUETYPE_FONT,getClass().getResourceAsStream("/res/fonts/Roboto/Roboto-Light.ttf")); 
```

如果您想将其设置为 JButton 的字体，您可以编写以下代码：

```
JButton yesButton = new JButton("Yes");
yesButton.setFont(robotoFont.deriveFont(Font.PLAIN, 30f)); 
```

但是，如果您尝试编写一些代码，例如：

```
JButton yesButton = new JButton("Yes");
yesButton.setFont(new Font ("Roboto Light", Font.PLAIN,30)); 
```

JButton 只会被赋予一个默认字体，因为图形环境不知道任何名为“Roboto Light”的字体。解决方案是*在图形环境中注册您的字体*：

```
 GraphicsEnvironment genv = GraphicsEnvironment.getLocalGraphicsEnvironment();
 genv.registerFont(robotoFont); 
```

然后，您将能够在“new Font()”构造函数中使用此字体，如下所示：

```
JButton yesButton = new JButton("Yes");
bestButton.setFont(new Font ("Roboto Light", Font.PLAIN,30)); 
```

# asp.net-mvc - MVC3 中的多个搜索按钮

> ID：12112356
> 
> 赞同：0
> 
> 时间：2012-08-24T15:28:18.433
> 
> 标签：asp.net-mvc, asp.net-mvc-3

SO上有几个关于多个提交按钮的问题，比如[ASP.NET MVC Framework中如何处理多个提交按钮？](https://stackoverflow.com/questions/442704/how-do-you-handle-multiple-submit-buttons-in-asp-net-mvc-framework)但我遇到的问题是有多个搜索按钮，每个按钮都有自己的关联文本框，用于搜索正在搜索的值，并且搜索它自己的数据集。例如..

```
 <div class="leftContentColumnRow">
        @Html.TextBox("SearchString", null, new { placeholder = "Search Roles..." })

        <input type="submit" value="" class="searchbtn" name="SearchRoles" />
    </div>

    <div class="rightContentColumnRow">
        @Html.TextBox("SearchString", null, new { placeholder = "Search Permissions..." })
        <input type="submit" value="" class="searchbtn" name="SearchPermissions" />
    </div> 
```

我可以确定单击了哪个按钮，但是我很难掌握两个文本框中的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:32:07.290

`input` `button`为每一对使用单独的表格，并为表格使用不同`action`的表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:38:38.920

就像 Oded 说的，2 种形式，每一种都有它自己的动作参数值。

```
@using(Html.Beginform("SearchRole","User")
{
    <div class="leftContentColumnRow">
        @Html.TextBox("SearchString", null, new { placeholder = "Search Roles..." })

        <input type="submit" value="" class="searchbtn" name="SearchRoles" />
    </div>
}
@using(Html.Beginform("SearchPermissions","User")
{
    <div class="rightContentColumnRow">
        @Html.TextBox("SearchString", null, new { placeholder = "Search Permissions..." })
        <input type="submit" value="" class="searchbtn" name="SearchPermissions" />
    </div>
} 
```

和动作方法

```
public ActionResult SearchRole(string SearchString)
{
  //get data and return something
}
public ActionResult SearchPermissions(string SearchString)
{
  //get data and return something
} 
```

# c# - C# 实体框架 - IEntityChangeTracker 问题

> ID：12112360
> 
> 赞同：0
> 
> 时间：2012-08-24T15:28:27.760
> 
> 标签：c#, entity-framework, entity-framework-4.1

我收到的异常是*IEntityChangeTracker 的多个实例无法引用实体对象*。我的代码的结构是这样的......

我的上下文类如下所示：

```
 public class MyContext : DbContext, IDataContext
    {
        public MyContext (string connectionString) :
            base(connectionString)
        { 
        }

        public DbSet<AssigneeModel> Assignees { get; set; }
        public DbSet<AssetAssignmentModel> AssetAssignments { get; set; }
 }

public class AssigneeController : Controller
    {
        protected MyContext db = new MyContext(ConnectionString);

[HttpPost]
        public ActionResult Import(SomeObjectType file)
        {
           AssigneeModel assignee = new AssigneeModel();
           assignee.FirstName = "Joe";
           assignee.LastName = "Smith";

           // Assignees have assets, and the relationship is established via an AssetAssignmentModel entity

            AssetAssignmentModel assetAssignmentModel = new AssetAssignmentModel
            {
                Asset = someExistingAsset,
                // Assignee = assignee, // Don't establish relationship here, this object will be added to the assignee collection
             }

           assignee.AssetAssignments.Add(assetAssignmentModel); // Manually add object to establish relationship
           db.Assignees.Add(assignee); // Add the assignee object 
           // Exception occurs when adding the object above
        };
} 
```

英孚版本 4.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:50:25.543

您已将其标记为 EF4.1（我期望代码优先和 dbcontext），但它看起来像是 EntityObject（edmx、objectcontext、VS2008 和 VS2010 中的默认代码生成）的副作用。

在这种情况下，如果您有一个实体（从 EntityObject 派生）并且您在没有先分离实体的情况下处置其上下文，则实体实例仍然具有该上下文的工件。因此，当您尝试将其附加到另一个上下文时，它会给出此消息。如果您不使用 POCO，那是 EF 3.5 和 EF4 的问题。我很久没和它搏斗了，但我记得那次刺痛。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:12:16.547

问题出在您的 Asset 对象上，当您从其他方法获取它时，您需要在将其添加到此新上下文之前显式地将其与该上下文分离。正如朱莉所提到的，实体实例将携带上下文，但问题不是`AssigneeModel`您创建的，而是`someExistingAsset`您检索的。

# c# - 如何从 ASP.NET MVC 3 设置 HTTP 状态代码？

> ID：12112361
> 
> 赞同：54
> 
> 时间：2012-08-24T15:28:27.863
> 
> 标签：c#, .net, asp.net-mvc-3

我们在前端使用 OpenWeb js 库，当某些类型的错误发生时，它们需要 .NET 中间层向它们发送特定的 HTTP 标头状态代码。我试图通过这样做来实现这一目标：

```
public ActionResult TestError(string id) // id = error code
{
    Request.Headers.Add("Status Code", id);
    Response.AddHeader("Status Code", id);
    var error = new Error();
    error.ErrorID = 123;
    error.Level = 2;
    error.Message = "You broke the Internet!";

    return Json(error, JsonRequestBehavior.AllowGet);
} 
```

它有点成功了。见截图： [http 状态码 http://zerogravpro.com/temp/pic.png](http://zerogravpro.com/temp/pic.png)

请注意，我在响应标头中实现了 400 的状态代码，但我确实需要请求标头中的 400。相反，我得到“200 OK”。我怎样才能做到这一点？

我进行调用的 URL 结构很简单：/Main/TestError/400

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-08-24T15:43:46.257

What is the proper [way to send an HTTP 404 response from an ASP.NET MVC action？](https://stackoverflow.com/q/499817/1210520)

您要做的是设置`Response.StatusCode`而不是添加标题。

```
public ActionResult TestError(string id) // id = error code
{
    Response.StatusCode = 400; // Replace .AddHeader
    var error = new Error();  // Create class Error() w/ prop
    error.ErrorID = 123;
    error.Level = 2;
    error.Message = "You broke the Internet!";

    return Json(error, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-08-24T15:39:48.120

如果您只想返回错误代码，则可以执行以下操作：

```
public ActionResult TestError(string id) // id = error code 
{ 
      return new HttpStatusCodeResult(id, "You broke the Internet!");
} 
```

参考：[关于 Mvc.HttpStatusCodeResult 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.web.mvc.httpstatuscoderesult%28v=vs.98%29.aspx)。

否则，如果您想返回其他信息，请使用

```
Response.StatusCode = id 
```

代替

```
Response.AddHeader("Status Code", id); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-16T08:48:14.457

如果您无法将 json 结果放入您的视图中，请尝试添加以下内容：

```
Response.TrySkipIisCustomErrors = true; 
```

在这之前 ：

```
Response.StatusCode = 400; 
```

关于这篇文章的更多细节：[https ://stackoverflow.com/a/37313866/9223103](https://stackoverflow.com/a/37313866/9223103)

# php - iCalendar 和描述格式

> ID：12112366
> 
> 赞同：6
> 
> 时间：2012-08-24T15:28:51.240
> 
> 标签：php, outlook, icalendar

是否可以向 iCalendar ICS 中的事件描述添加任何格式？

当 Outlook 导入我的 ICS 时，它使某些行 18pt 粗体，而另一些则不是，什么定义了哪些行在 OL 中被格式化？

还有一种方法可以为描述中的链接添加替代描述吗？

我也想使用 PHP 构建我的 ICS 文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-05T21:28:41.457

为什么不使用`X-ALT-DESC`？

```
X-ALT-DESC;FMTTYPE=text/html: <html><body>I am <b>bold</b></body></html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:43:32.747

Outlook 对此非常反复无常，最好不要与之抗争。

我发现 Outlook 将我的第一行格式化为粗体，如果它后跟 2 个换行符 (\n)，然后是至少 3 行文本，其中第一行必须有一个大写字母。两个极简主义的例子：这有效：

```
DESCRIPTION:I am bold\n\nThey\nthey\nthey 
```

这不

```
DESCRIPTION:I am not bold\n\nthey\nthey\nthey 
```

我承认这不是一个准确的答案。也许 Microsoft Outlook 工程师可以跳上线程并告诉我们业务逻辑是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-05T19:31:37.090

我发现的一件事：如果第一行是粗体和蓝色，那是因为 Outlook 认为它是标题并应用标题格式。在末尾添加标点符号会将其还原为纯文本。

感谢您注册\n\n

出来是粗体和蓝色。

感谢您注册！\n\n\

以纯文本形式出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-25T11:31:38.573

在用星号 * 包裹文本的描述中

```
I am *BOLD text* 
```

但更好的方法还包括 X-ALT-DESC

```
X-ALT-DESC;FMTTYPE=text/html: <html><body>I am <b>bold</b></body></html> 
```

# java - 如何在 Java 中读取序列化对象的字节大小？

> ID：12112375
> 
> 赞同：1
> 
> 时间：2012-08-24T15:29:13.227
> 
> 标签：java, object, serialization, size

有没有办法在反序列化之前或之后从流中读取序列化对象的总使用大小？

我能找到的唯一方法是将它再次序列化到一个字节缓冲区中，然后查看该缓冲区的总占用大小。这行得通，但似乎是在浪费资源。

编辑：我对 Object 实例在内存中加载时使用的空间不感兴趣。仅以字节为单位的序列化大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:01:58.270

您将无法在反序列化之前确定大小，因为序列化协议不会浪费时间预先计算输出的大小；它只是处理对象直到完成。

要在反序列化后读取大小，您可以在您的流和底层流之间插入一个[CountingInputStream 。](http://commons.apache.org/io/api-release/org/apache/commons/io/input/CountingInputStream.html)`ObjectInputStream`

编辑：如果您绝对需要确定预序列化的大小，那么我想您可以序列化为 a `ByteArrayOutputStream`，并将结果字节写入输出。但这需要发送者和接收者就如何处理字节达成一致。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-24T15:32:45.607

序列化大小是其所有字段及其本身的总和。我假设你有一个检查对象大小的好方法，所以检查对象的大小，然后添加它的所有字段。

# user-interface - 在 TCL 脚本中检测 TCL 后台进程的结束

> ID：12112376
> 
> 赞同：2
> 
> 时间：2012-08-24T15:29:15.560
> 
> 标签：user-interface, exec, tcl, background-process

我正在开发一个使用 EXEC 命令运行生成文件的程序。这可能需要很长时间，所以我想把它放在后台，这样 GUI 就不会锁定。但是，我还希望禁用 GUI，并且仅在编译 make 文件时才运行进度条。

那么如何检测 TCL 中的后台进度何时完成呢？

编辑：它变得更加复杂，因为我的老板希望命令窗口保持打开（或可见），以便用户可以看到制作进度并查看它是否出错。

PS 搞清楚线程会更容易吗？我需要一些方法来防止 GUI 锁定（防止不响应）。

编辑：GUI 是用 TK 制作的。我认为 TK 是导致问题的单线程。或者可能是它默认为单线程，我想将其设置为多线程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T20:46:15.260

正如@glenn-jackman 指出的那样，首选使用 fileevent （因为它应该在任何地方都可以使用）。

```
proc handle_bgexec {callback chan} {
    append ::bgexec_data($chan) [read $chan]
    if {[eof $chan]} {
        # end of file, call the callback
        {*}$callback $::bgexec_data($chan)
        unset ::bgexec_data($chan)
    }
}

proc bgexec {callback args} {
    set chan [open "| $args" r]
    fconfigure $chan -blocking false
    fileevent $chan readable [list handle_bgexec $callback $chan]
    return
} 
```

调用它作为`bgexec job_done cmd /c start /wait cmd /c make all-all`. `job_done`完成后使用命令的输出调用。

也可以为这些事情使用线程，但这需要一个线程化的 tcl 构建（现在这是所有平台 AFAIK 的默认设置，但旧版本的 Tcl 尤其是 unix 下默认不构建一个线程化的 Tcl。）和`Thread`包（默认包含）。将它与线程一起使用的方法是：

```
thread::create "[list exec cmd /c start /wait cmd /c make all-all];[list thread::send [thread::id] {callback code}];thread::exit" 
```

如果您需要定期调用它，可能值得只使用一个工作线程而不是为每个作业创建一个新线程。

编辑：添加`/wait`作为启动参数以保持第一个 cmd 运行。

```
cmd /c start /wait cmd /c make all-all 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:45:09.470

您想在管道中运行 make 过程并使用事件循环和 fileevent 来监视其进度（请参阅[http://wiki.tcl.tk/880](http://wiki.tcl.tk/880)）

```
proc handle_make_output {chan} {
    # The channel is readable; try to read it.
    set status [catch { gets $chan line } result]
    if { $status != 0 } {
        # Error on the channel
        puts "error reading $chan: $result"
        set ::DONE 2
    } elseif { $result >= 0 } {
        # Successfully read the channel
        puts "got: $line"
    } elseif { [chan eof $chan] } {
        # End of file on the channel
        puts "end of file"
        set ::DONE 1
    } elseif { [chan blocked $chan] } {
        # Read blocked.  Just return
    } else {
        # Something else
        puts "can't happen"
        set ::DONE 3
    }
}

set chan [open "|make" r]
chan configure $chan -blocking false
chan event $chan readable [list handle_make_output $chan]
vwait ::DONE
close $chan 
```

我不确定`vwait`在 Tk 的事件循环中的使用。也许专家会在这里帮助我。

# inheritance - 了解 F# 3.0 中受保护/基本成员使用的更改

> ID：12112377
> 
> 赞同：6
> 
> 时间：2012-08-24T15:29:29.727
> 
> 标签：inheritance, f#, compiler-errors, protected, f#-3.0

F# 3.0 增加了对调用`base`和`protected`成员的更严格检查。我在 C# 中有类似以下抽象类的东西，它具有`protected static`派生类使用的辅助方法。

```
public abstract class Processor {
    public abstract void Process();
    protected static void Helper(object arg) { }
} 
```

在 F# 中，其中一个辅助方法作为一等函数传递：

```
type DerivedProcessor() =
  inherit Processor()

  let init f =
    f ()

  override x.Process() =
    init Processor.Helper 
```

它在 2.0 中编译没有任何问题，但在 3.0 中会产生错误：

> 调用了受保护的成员或正在使用“base”。这仅在成员的直接实现中允许，因为它们可以逃脱其对象范围。

好的，很容易遵守，只需将调用包装在另一个静态成员中

```
static member private HelperWrapper(arg) = Processor.Helper(arg) 
```

并通过它。但为什么？

C# 对这种相同的模式没有问题。

```
public class HappyToCompile : Processor {
    private void Init(Action<object> f) {
        f(null);
    }

    public override void Process() {
        Init(Helper);
    }
} 
```

**问题：**

1.  为什么要增加更严格的检查？
2.  （和相关的）这样一个微不足道的解决方法解决了什么可怕的问题？
3.  这应该鼓励更好的设计吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T16:06:02.737

使用我的通灵语言设计技能，我猜 F# 2.0 正在生成无法验证的代码。请参阅Eric Lippert 博客上的[这篇](http://blogs.msdn.com/b/ericlippert/archive/2005/11/14/why-are-base-class-calls-from-anonymous-delegates-nonverifiable.aspx)文章，了解 C# 中的相关问题（自 C# 4, IIRC 以来已修复）。

简而言之，当您创建 F# 函数时，您实际上是在创建一个派生自 的新类`FSharpFunc<_,_>`，并且从该类中调用受保护的方法是无效的，因为它不在继承链中。

当然，与其禁止这些调用，编译器可以只做你正在做的事情（创建一个私有方法并使用它），但也许人们认为好处不会超过实现这种改进的成本。

# iphone - 如何在 GUI 级别管理启动问题？

> ID：12112380
> 
> 赞同：0
> 
> 时间：2012-08-24T15:29:37.853
> 
> 标签：iphone, objective-c, ios, user-interface, exit

我正在一个在启动时加载一些远程 json 的应用程序中工作。该应用程序已被编程为对传入数据进行某些测试，以防止无效状态并检测可能的人为错误。但是，我不确定我们应该如何在 GUI 级别处理这种情况——我们最初的想法是显示“糟糕，出现了意外的服务器错误。我们正在努力解决这个问题。请稍后再试。” 当用户点击“确定”或“退出”按钮时弹出退出应用程序。

Apple 显然不鼓励从您的代码中退出应用程序：[https ://developer.apple.com/library/ios/#qa/qa2008/qa1561.html](https://developer.apple.com/library/ios/#qa/qa2008/qa1561.html)

有什么好的选择来处理这种情况？

**更新：**我更新了上面的错误消息，因为它具有误导性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:35:49.287

我遇到了类似的问题。我的应用程序毫无用处，除非它可以与服务器建立连接。

有两种方法可以解决这个问题：

1.  占位符文本，这可以保持位置，直到您可以获得 json 数组，或者至少允许弹出警报的背景。

2.  加载一个禁用所有交互的视图，并带有一个小消息框，上面写着“正在连接...”

基本上，我采用了第一个响应故事板框架并禁用了用户可以触摸的所有内容。我只是允许静态交互，比如按下按钮进入关于屏幕。

不过，不要太自责。如果您根本没有任何连接，那么用户的任何应用程序都不会正常运行。我认为在这种状态下，从 GUI 的角度来看，它主要是关于损害控制和保护用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:04:34.743

在启动时很难优雅。我建议在您的应用程序准备好运行时以模态方式呈现 UI。我问并回答[了这个 SO question](https://stackoverflow.com/questions/11697747/how-to-present-a-splash-login-view-controller-using-storyboards)，它展示了一种干净的 UI 方式，包括漂亮的过渡效果。

至于退出：您的应用程序永远不应该自行终止（版权所有 Arnold Schwartzenegger 大约 2003 年）。当无法完成必须以模态方式完成的事情时，正确的应用程序行为是提醒用户并提供重试选项。如果用户不想重试，手机上有一个硬件主页按钮。

# math - 根据 FOV 计算相机图像内 2D 的 GPS 位置

> ID：12112391
> 
> 赞同：1
> 
> 时间：2012-08-24T15:30:33.083
> 
> 标签：math, gps, augmented-reality

我有一个具有已知 FOV 的相机，它位于具有已知方向的已知 GPS 坐标。

我有另一个 GPS 坐标，想在这个 GPS 坐标的相机图像（增强现实）上显示一个点。

有可能用信息做到这一点吗？

PS：2个GPS坐标之间的距离不到几公里，所以也许我们可以做一些近似

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:24:52.743

您需要跟踪相机的方向。GPS 可以跟踪接收器的位置和速度，但大多数设置无法告诉您任何有关方向的信息。因此，如果没有其他信息，答案是“否”。

如果您在相机上有 3 轴磁性和惯性传感器（加速度计和速率陀螺仪），您可能能够根据重力和地磁场计算方向 - 尽管磁性组件对局部磁畸变很敏感。

如果您要求用户挥动相机，您可以将惯性传感器与 GPS 速度读数结合起来确定您的方向——尽管我不确定数据是否足以提供稳定的方向。不过，在实时取景图像上使用计算机视觉技术可能有助于稳定这种跟踪。

在任何情况下，您都需要查找[卡尔曼滤波](http://en.wikipedia.org/wiki/Kalman_filter)，这是用于进行这种跟踪的技术。

# iphone - 在 Instruments 中分析 iPhone 应用程序时缺少符号名称

> ID：12112394
> 
> 赞同：3
> 
> 时间：2012-08-24T15:30:40.823
> 
> 标签：iphone, objective-c, xcode, profiling, instruments

当我分析我的 iPhone 应用程序时，我没有得到任何符号名称。

它在模拟器中以及在设备上使用调试模式时有效，但在使用 Release 时无效（因为您应该在分析时使用）。我知道 dsym 文件是为发布和调试生成的，所以这不是问题。

我已经尝试过这里描述的解决方案：

[使用 Instruments 分析 iPhone 应用程序时缺少符号名称](https://stackoverflow.com/questions/2776466/missing-symbol-names-when-profiling-iphone-application-with-instruments)

但是**当我选择“重新符号化文档”时，我的应用程序名称不会出现在二进制列表中**（它在使用调试时会出现），所以我无法尝试手动添加 dsym 文件。

我也试过：

*   从 Spotlight 的隐私列表中添加和删除我的派生数据文件夹
*   从 iPhone 中删除应用程序
*   在分析之前清理和构建
*   在构建和分析之前删除 Derived Data 文件夹

可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T17:14:16.817

今天我在 iPhone 上配置文件时也缺少符号。但是当我建立一个平台来分析崩溃报告时，我总是找不到 dsym 文件。我记得我通过重新索引聚光灯修复它。

所以这次我这样做了，因为我在重新符号化的文档中找到，仪器找不到特定 udid 的 dsym 文件。所以我猜这是由于系统在聚光灯的帮助下找不到它造成的（系统总是使用 mdfind 命令来查找 dsym 文件）。如果聚光灯找不到，可能仪器也找不到 dsym 文件..

所以我去搜索重新索引命令： sudo mdutil -E /Volumes/Macintosh\ HD

-E 将告诉系统重新索引此命令以重新索引根磁盘。所以可能需要一些时间。

在重新索引之后，最好为您提供重新符号化的路径。

我可以让它工作，如果你有什么不明白的，请告诉我。谢谢。

# php - Facebook 扇门无法始终如一地工作

> ID：12112395
> 
> 赞同：0
> 
> 时间：2012-08-24T15:30:45.110
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

在进入我的应用程序之前，我正在使用此代码检查用户是否“喜欢”了该页面。

```
require_once 'facebook-php-sdk/src/facebook.php';
        // Create our Application instance.
        $this->facebook = new Facebook(array(
          'appId' => 'APPID',
          'secret' => 'APPSECRET',
          'cookie' => true,
        ));
        $session = $this->facebook->getSession();
        if(!empty($session)) {
            $access_token = $this->facebook->getAccessToken();
            $fql_multiquery_url = 'https://graph.facebook.com/me/likes?access_token='.$access_token;
            $fql_multiquery_result = file_get_contents($fql_multiquery_url);
            $fql_multiquery_obj = json_decode($fql_multiquery_result, true);
            $liked = false;
            foreach($fql_multiquery_obj['data'] as $like){
                if($like['id'] == 'PageID'){
                    $liked = true;
                }
            }
            if($liked){
                $data['main_content'] = 'welcome_message';
            } else {
                $data['main_content'] = 'before_like';
            }
            $this->load->view('includes/template', $data);
        } else {
            $req_perms = "publish_stream,offline_access,user_status,email,read_stream,user_likes";
            $login_url = $this->facebook->getLoginUrl(array('canvas'=> 1,'fbconnect' => 0,'req_perms' => $req_perms, 'redirect_uri' => 'APP REDIRECT URL'));
            echo "<script type='text/javascript'>top.location.href = '$login_url';</script>";exit;
        } 
```

（我知道循环浏览你的喜欢并不是最好的解决方案，但它似乎对我来说最一致）。

它对我来说很好用（办公室里的其他几个用户也很好用），但对一些用户来说却失败了（当然他们没有给我发送错误消息）。有没有更好的方法可以检查喜欢并保持一致？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:27:30.950

您应该能够像这样访问特定页面：

```
$resp = $this->api('/me/likes/'.$page_id);
$is_fan = (count($resp['data']) !== 0); 
```

但是，如果 facebook 的内部缓存正在运行，这也无济于事，而且如果此请求在 facebook 选项卡上运行，则签名请求还应该包含 fan/no_fan 信息[`signed_request`](https://developers.facebook.com/docs/authentication/signed_request/)（请参阅有关字段和值的部分）。根据我的经验，`signed_request`似乎是最可靠的。

### PS：

您似乎使用的是相当旧版本的 php sdk，该`getSession()`方法[已被弃用](http://developers.facebook.com/blog/post/503/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T09:22:27.217

```
function parsePageSignedRequest() {
if (isset($_REQUEST['signed_request'])) {
  $encoded_sig = null;
  $payload = null;
  list($encoded_sig, $payload) = explode('.', $_REQUEST['signed_request'], 2);
  $sig = base64_decode(strtr($encoded_sig, '-_', '+/'));
  $data = json_decode(base64_decode(strtr($payload, '-_', '+/'), true));
  return $data;
}
return false; 
```

}

```
 $signed_request = $_REQUEST['signed_request'];

//check for page liked or not
if($signed_request = parsePageSignedRequest())
{
  if($signed_request->page->liked) {
      echo "<link rel='stylesheet' type='text/css' href='style.css' />";
  } else {
      echo "<link rel='stylesheet' type='text/css' href='notfanstyle.css' />";
  }
} 
```

:) 试试这个，它对我有用。

# clojure - 如何将非可选 cli 参数与可选参数混合？

> ID：12112403
> 
> 赞同：0
> 
> 时间：2012-08-24T15:31:10.797
> 
> 标签：clojure, command-line-interface

使用 tools.cli，我怎样才能创建一个带有可选参数的非可选参数？

我有一个功能

```
(defn parse-opts
  [args]
  (cli args
  ["-f" "--ifn" "input file"]
 (optional ["-o" "--outp" ".csv pipe delimited output file" 
      :default "assess_pro_out.csv"] identity)
 (optional ["-d" "--debug" "Debug flag for logging." :default 0 
      :parse-fn #(Integer. %)]))) 
```

编译但产生

```
Exception in thread "main" clojure.lang.ArityException: 
Wrong number of args (2) passed to: PersistentVector 
```

当我在没有参数的情况下运行我的主程序时。

如果这个选项和其他选项一样

```
(optional ["-f" "--ifn" "input file"] identity) 
```

一切正常。

我只希望一个参数是非可选的。我究竟做错了什么？

我确实有一个解决方法，但我仍然想知道是否可以将可选和非可选参数混合到 cli。

```
(defn -main 
[& args]
(let [opts (parse-opts args)
      start-time (str (Date.))
      parsed-csv-data (if-not (:ifn opts)
                       (do
                       (println "Usage: assess-chk [-f -ifn] input-file-name")
                       (System/exit -2))
                       (utl/fetch-csv-data (:ifn opts))) 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T20:15:24.730

您使用的是旧版本的 tools.cli（可能是 v0.1.0）。对于*该*版本，您似乎应该使用`(required ...)`所需的选项。[请参阅https://github.com/clojure/tools.cli/tree/a741b23f230123179fc518af772f1c057058f7d2](https://github.com/clojure/tools.cli/tree/a741b23f230123179fc518af772f1c057058f7d2)上的文档

在当前版本的 tools.cli 中，选项始终是可选的，并且删除了可选和必需的功能。

# javascript - 在点击或触摸时切换 div 并在点击/触摸外部时隐藏

> ID：12112404
> 
> 赞同：1
> 
> 时间：2012-08-24T15:31:12.963
> 
> 标签：javascript, jquery, iphone, ipad, touch

我正在尝试为要显示和隐藏的 div 支持鼠标和触摸事件。我的鼠标事件运行良好，但我不确定如何让它在基于触摸的设备（iPhone、iPad 或基于 Android 的手机）上运行。

交互应该是当用户单击或触摸触发器时，会显示“搜索”框，如果他们在打开的搜索框之外单击/触摸或重新单击/触摸触发器，它应该关闭（隐藏）。

这是我的 HTML：

```
<div id="search">
    <div class="search-link">
        <a href="#search" class="search-nav-button" id="search-trigger">Search</a>
    </div>
    <div class="search-box">
        <form action="/search" id="search_form">
            <input placeholder="Search" type="text" />
            <input id="search-submit" type="submit" value="Submit" />
        </form>
    </div>
</div> 
```

而且，我的 JavaScript（使用 jQuery）：

```
var $searchBox = $('#search .search-box');
var $searchTrigger = $('#search-trigger');

$searchTrigger.on("click", function(e){
    e.preventDefault();
    e.stopPropagation();
    $searchBox.toggle();
});
$(document).click(function(event){
    if (!($searchBox.is(event.target)) && ($searchBox.has(event.target).length === 0)){
        $searchBox.hide();
    };
}); 
```

工作示例：http: [//jsfiddle.net/T5HMt/](http://jsfiddle.net/T5HMt/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-10T20:40:04.430

[http://jsfiddle.net/LYVQy/2/](http://jsfiddle.net/LYVQy/2/)

我刚刚包含了 JQuery Mobile 并将您的“点击”事件更改为 .on('tap',function(e))...

Jquery Mobile 似乎将“点击”事件视为桌面浏览器上的点击，因此这似乎适合您的需求。

```
$searchTrigger.on("tap", function(e){
    e.preventDefault();
    e.stopPropagation();
    $searchBox.toggle();
});

$(document).on('tap',function(event){

if (!($searchBox.is(event.target)) && ($searchBox.has(event.target).length === 0)){
    $searchBox.hide();
};
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:35:45.523

这已经足够了：**[JsFiddle](http://jsfiddle.net/toroncino/T5HMt/1/)**

```
$searchTrigger.on('click', function(e) {
    $searchBox.toggle();
    e.preventDefault();
}); 
```

它适用于屏幕和触摸设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:41:36.017

您还可以像这样使用`setOnClickListener`事件和覆盖`onClick`功能：

```
btnclickme = (Button) findViewById(R.id.btn_clickme);
btnclickme.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                        // do your code here
            }
}); 
```

# php - phpDocumenter 和抽象方法

> ID：12112412
> 
> 赞同：0
> 
> 时间：2012-08-24T15:31:52.033
> 
> 标签：php, phpdoc

我正在使用 phpDocumentor

> phpDocumentor 版本 2.0.0a10`

并有几个`abstract`我正在记录的课程。**该文档似乎包括那些`abstract class`es 但不包括`abstract`.** 我通常会大量记录抽象方法来解释合同以及我对如何在不同用例中实现它的愿景。我在 phpdoc 中缺少的设置会强制它记录这些吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T13:47:43.010

这就是您的抽象类在适当的 docblock 下的外观。

```
/**
* login method
*
* Abstract method that must be implemented when
* sub-classing this class.
*
* @access public
* @return boolean
*/
abstract public function login($user, $password); 
```

# grails - 如何模拟控制器内部的命令对象

> ID：12112415
> 
> 赞同：2
> 
> 时间：2012-08-24T15:32:00.837
> 
> 标签：grails, groovy, junit, controller, jmock

我有一个控制器类，里面有一个命令对象。我有一个方法 find() 它使用这个命令对象如下：

```
class itemController{

    //command object
    class SearchCommand{
        String email
        static constraints={
            email blank:false,email:true
        }

def find = {SearchCommand sc ->
    if(!sc.hasErrors()){
     ----- do something---
}

} 
```

现在，我正在编写一个测试用例来测试控制器中的 find 方法。但是测试用例失败了

```
 if(!sc.hasErrors()) 
```

因为 sc 仍然是'null'。我不确定如何在测试用例中处理这个内部类命令对象。到目前为止我写的测试用例是：

```
class itemControllerTests extends ControllerUnitTestCase {

    void testFind(){
    def model = controller.find()
    assertNotNull(model)
    }
} 
```

如何处理测试用例中的内部类命令对象。我嘲笑它吗？我尝试过使用 mockCommandObject(?)，但不确定我应该如何将内部类命令对象传递给它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:40:45.503

您可以使用 mockCommandObject

## RioController 类

```
class RioController {
    class UserCommand{
        String email
        static constraints = {
            email blank: false, email: true
        }
    }

    def load={UserCommand cmd -> 
        if(cmd.validate()){
            flash.message = "Ok"
        }
        else{
            flash.message = "Where is the email?"
        }
    }
} 
```

## RioControllerTests 类

```
import grails.test.mixin.*
import org.junit.*

@TestFor(RioController)
class RioControllerTests {

    @Test
    void testLoad(){
        mockCommandObject RioController.UserCommand
        controller.load()
        assert flash.message == "Where is the email?"

        params.email = "verynew@email.com"
        controller.load()
        assert flash.message == "Ok"
    }
} 
```

# java - Toplink JPA 继承 - 摘要/细节关系

> ID：12112417
> 
> 赞同：1
> 
> 时间：2012-08-24T15:32:08.143
> 
> 标签：java, inheritance, jpa, orm, toplink

我在 web 应用程序中使用 toplink JPA，我只想将一个表映射到类层次结构。我想要一个代表大部分数据的类，以及一个继承自该类的类（因此它获取超类的所有字段，以及其他几个保存大量数据的字段）。我不希望一直有大量数据，也不希望将它们保存在请求对象中等。我只想要有人选择其中一个摘要时的大量数据。我已按如下方式设置类（简化为示例）。

```
@Entity
@Table(name = "TRANSCRIPTS")
@MappedSuperclass //also tried without this - same error
public class Summary {

    @Id
    @Column(name = "id")
    private long id;
    @Column(name = "title")
    private String title;

    //rest of class etc.
}

@Entity
@Table(name = "TRANSCRIPTS")
public class Detail extends Summary {

    @Id
    @Column(name = "fullText")
    private String fullText;

    //rest of class etc.
} 
```

当我尝试使用此层次结构获取数据时，出现如下错误

```
Unknown column 'DTYPE' 
```

所以它正在寻找一个鉴别器列。我没有设置，因为它不是那种关系。

有没有其他方法可以在 JPA 中映射此摘要/详细信息关系？或者我应该放弃类继承并拥有两个独立的不相关类，一个代表汇总数据，一个代表完整数据（并重新定义汇总字段）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:39:28.970

DTYPE 它是 Toplink 尝试访问以在您的实体之间进行选择的鉴别器列，如果您将该列添加到表模式中，它将开始工作。

DTYPE 是数据库中的 INTEGER 类型列。

您可以使用以下代码片段指定您自己的鉴别器列：

```
@Entity
@DiscriminatorColumn(name="type",discriminatorType=DiscriminatorType.INTEGER)
@DiscriminatorValue("1")
class TestClass {} 
```

这是为您提供的一些文档[http://www.oracle.com/technetwork/middleware/ias/toplink-jpa-annotations-096251.html#CHDJHIAG](http://www.oracle.com/technetwork/middleware/ias/toplink-jpa-annotations-096251.html#CHDJHIAG)

# java - 捕获 url 是否已加载

> ID：12112418
> 
> 赞同：-3
> 
> 时间：2012-08-24T15:32:17.580
> 
> 标签：java, android, url, webview

我有一个在 WebView 中显示网页的简单应用程序。因为其中一个 url 尚未在线，所以我想祝酒，说它不在线，当它在线时，它只是加载 url。

有人知道如何做到这一点吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:35:22.613

打开一个 URLConnection，首先检查连接的响应代码。如果这是 404，则表示该站点不存在。然后，您可以在那里做所有需要的站点缺失的东西。示例代码：

```
 try {
      Url url = new URL(someStringUrl);
      HttpURLConnection huc =  ( HttpURLConnection )  url.openConnection (); 
      if(huc.getResponseCode() == 404) {
           //Site doesnt exist, returned 404 error
      }
 } catch(Exception e) {
     e.printStackTrace();
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:51:55.083

好吧，看看这个...

```
try {
      // Write your code to access the website here 
```

} 捕捉（异常 e）{

```
// Your execution will reach here once the site can't be reached

 Toast.makeText(Your_Activity.this, "Site still not online",duration).show(); 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:46:32.937

您可以扩展自己的异常，让我们说

```
public class Exception404 extends Exception {
} 
```

然后捕获 2 个不同的异常：

```
HttpURLConnection huc = null;

try {
     Url url = new URL(someStringUrl);
     huc =  ( HttpURLConnection )  url.openConnection (); 
     if(huc.getResponseCode() == 404) 
        throw new Exception404();

     //...
     //...
     //...

 } catch(Exception404 e) { 
    e.printStackTrace();    
 } catch(Exception e) {
    e.printStackTrace();
 } finally {
    //close connection (saves battery life time)
    huc.disconnect();
 } 
```

或者您可以抛出相同的异常以相同的方式处理这两个故障

# c++ - 获取 Windows 时区信息 (C++/MFC)

> ID：12112419
> 
> 赞同：4
> 
> 时间：2012-08-24T15:32:22.417
> 
> 标签：c++, windows, time, zone, zones

我试着：

1.  获取当用户从 Windows 控制面板选择时区时出现的时区名称列表（例如，“(UTC-08:00) 太平洋时间（美国和加拿大）”）。

我通过阅读注册表中运行良好的“CurrentVersion\Time Zones”部分来做到这一点。

2.  以字符串形式获取当前选择的时区。

我可以使用 GetTimeZoneInformation() 获取当前时区，但名称与从注册表的“CurrentVersion\Time Zones”部分检索到的时区列表不匹配。例如，太平洋时间在时区列表中显示为“(UTC-08:00) 太平洋时间（美国和加拿大）”，但 GetTimeZoneInformation() 包含字符串“太平洋标准时间”和“太平洋夏令时间”。我需要找到一个与“CurrentVersion\Time Zones”名称对应的名称，以便从列表中选择它。

3.  根据字符串名称获取 UTC 和任何其他时区之间的当前偏移量（以分钟为单位）。

我可以在 timeZoneInformation.Bias 中检索与 UTC 的偏移量，但这仅适用于当前选择的时区。我需要知道注册表中列出的任何区域的“偏差”（例如，“（UC-07:00）山区时间（美国和加拿大）”，同时调整夏令时（如果有效）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-25T13:55:28.433

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:22:56.997

```
TimeZoneInfo.Bias 
```

TIME_ZONE_INFORMATION 结构 - [http://msdn.microsoft.com/en-us/library/windows/desktop/ms725481(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms725481(v=vs.85).aspx)

SetTimeZoneInformation 函数 - [http://msdn.microsoft.com/en-us/library/windows/desktop/ms724944(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724944(v=vs.85).aspx)

```
 // Get the local system time.
SYSTEMTIME LocalTime = { 0 };
GetSystemTime( &LocalTime );

// Get the timezone info.
TIME_ZONE_INFORMATION TimeZoneInfo;
GetTimeZoneInformation( &TimeZoneInfo );

// Convert local time to UTC.
SYSTEMTIME GmtTime = { 0 };
TzSpecificLocalTimeToSystemTime( &TimeZoneInfo,
                                 &LocalTime,
                                 &GmtTime );

// GMT = LocalTime + TimeZoneInfo.Bias
// TimeZoneInfo.Bias is the difference between local time
// and GMT in minutes.

// Local time expressed in terms of GMT bias.
float TimeZoneDifference = -( float(TimeZoneInfo.Bias) / 60 );
CString csLocalTimeInGmt;
csLocalTimeInGmt.Format( _T("%ld:%ld:%ld + %2.1f Hrs"),
                         GmtTime.wHour,
                         GmtTime.wMinute,
                         GmtTime.wSecond,
                         TimeZoneDifference ); 
```

TimeZoneInfo 类 - [http://msdn.microsoft.com/en-us/library/bb396389](http://msdn.microsoft.com/en-us/library/bb396389) 确定夏令时 - [http://www.metatrader4.com/forum/2155](http://www.metatrader4.com/forum/2155)

# sql - SQL基于两列递减一个值直到0

> ID：12112420
> 
> 赞同：1
> 
> 时间：2012-08-24T15:32:30.507
> 
> 标签：sql, oracle10g, aggregate-functions, windowing

我有以下数据集（只是一个示例）：

*表 1*：

```
ID    MAX    AMT  SORTED
1     20     0    1
1     30     0    2
1     40     0    3
1     50     0    4
2     0      0    1
2     30     0    2
2     40     0    3
2     40     0    4
... 
```

*表2*：

```
ID    AMT
1     75
2     70
... 
```

我必须`Table1.AMT`使用`Table2.AMT`此规则进行更新：

1.  `Table1`并`Table2`加入`ID`
2.  `Table1.AMT`不能持有大于`MAX`
3.  if `Table2.AMT >= Table1.MAX`then `Table1.AMT = Table1.MAX`... 然后在下一行更新`Table1.AMT`时`Table2.AMT - previous record AMT`仍然使用上述规则。

所以预期的输出将是

```
ID    MAX    AMT  SORTED
1     20     20   1
1     30     30   2
1     40     25   3
1     50     0    4
2     0      0    1
2     30     30   2
2     40     40   3
2     40     0    4
... 
```

怎么能做到这一点？

我想创建一个聚合`SUM()`的临时表`Table1.MAX`，并将其用作更新的引用`Table1.AMT`（如果则为`SUM(MAX) < Table2.AMT`其他`Table1.AMT = Table1.MAX`）`Table1.AMT = previous records SUM(MAX)`。

但它可以在没有临时表的情况下完成吗？（遗憾的是，我无法在我的工作环境中创建函数和过程。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:28:45.957

使用细节或 Oracle PL/SQL 可以制定更有效的解决方案。

这是一个通用的解决方案：

```
select t1.ID, min(t1.MAX) as MAX, least(min(t1.MAX),coalesce(min(t2.AMT),0)-coalesce(least(sum(t1p.MAX-t1p.AMT), min(t2.AMT)),0)+min(t1.AMT)) as AMT, t1.SORTED
from Table1 t1
left join Table2 t2 on t2.ID = t1.ID
left join Table1 t1p on t1p.ID = t1.ID and t1p.SORTED < t1.SORTED
group by t1.ID, t1.SORTED 
order by t1.ID, t1.SORTED 
```

**计算AMT的解释：**

AMT 是*“MAX for the row”*和*“How much is possible”中最小的*

```
least(min(t1.MAX),"How much is possible") 
```

*“有多少可能”*：最大可用 - 为前几行提供了多少 + 我们已经拥有了多少

```
coalesce(min(t2.AMT),0) - "how much was given for previous rows" + min(t1.AMT) 
```

*“前几行给出了多少”*：需要填写多少以及可能的多少

```
coalesce(least(sum(t1p.MAX-t1p.AMT), min(t2.AMT)),0) 
```

# html - 相对定位的父级和绝对定位的子级会折叠后面的元素

> ID：12112421
> 
> 赞同：2
> 
> 时间：2012-08-24T15:32:32.323
> 
> 标签：html, css

我有以下 HTML：

```
<div id="contents">
    <div id="inner">Inner Div</div>
</div> 

<div id="footer">Footer</div>​ 
```

应用以下 CSS：

```
#contents {
    position: relative;
}

#inner {
    position: absolute;
    background-color: green;
    width: 100%;
}

#footer {
    background-color: red;
}​ 
```

问题是`#footer`被折叠并在`#contents`. 您也可以在 jsfiddle 上查看[http://jsfiddle.net/MAhmadZ/YkJMH/1/](http://jsfiddle.net/MAhmadZ/YkJMH/1/)

**注意：**这只是一个较大页面的摘要。我别无选择，只能使用`position`属性。我在所有绝对位置`div`内都有多个`#contents`，一次只会显示 1 个。我不能确定身高

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:35:47.337

通过绝对定位将元素从流中取出后，您的`#contents`元素为空，因此它的高度为零，因此在其下方折叠。`#inner``#footer`

如果您提供`#contents`高度或一些垂直填充，它应该防止`#footer`在绝对定位的元素下方滑动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:49:57.823

这应该解决它：

```
#contents {
    position: relative;
}

#inner {
    position: absolute;
    background-color: green;
    width: 100%;
}

#footer {
    background-color: red;
    position: absolute;
    width: 100%;
    bottom: 0;
}​ 
```

你的问题是`#inner`绝对定位的。这使得它对 HTML 布局的**STATIC**格式不可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:37:46.277

不太确定您想要实现什么，但您可以将页脚设置为使用 position: fixed 和 bottom: 0px 以将其保持在页面底部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T16:56:51.590

我自己想出了以下解决方案：

```
#footer:before {
    content: '.';
    display: block;
    width: 100%;
} 
```

现场查看：http: [//jsfiddle.net/MAhmadZ/YkJMH/5/](http://jsfiddle.net/MAhmadZ/YkJMH/5/)

# android - 自定义视图对触摸事件的响应不是很好

> ID：12112422
> 
> 赞同：0
> 
> 时间：2012-08-24T15:32:38.400
> 
> 标签：android, view, touch-event, ondraw, viewgroup

我有一个扩展 ViewGroup 的自定义网格，并且我有下一个 onLayout 和 measureChildrenSizes 方法：

```
@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {

    // .. tileSide calcultion ..

    measureChildrenSizes(tileSide);
    for (int i = 0; i < getChildCount(); i++) {
        Square child = (Square) getChildAt(i);
        int x = child.getColumn();
        int y = child.getRow();
        child.layout(x * tileSide, y * tileSide,
                (x + 1) * tileSide, (y + 1) * tileSide);
    }   
}

private void measureChildrenSizes(int tileSide) {
    for (int i = 0; i < getChildCount(); i++) {
        View child = getChildAt(i);
        measureChild(child, tileSide, tileSide);
    }
} 
```

childs (Square) 是具有自定义 onDraw 方法和 onTouch 回调方法的自定义视图：

```
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    rect.set(0, 0, getWidth(), getHeight());

        gradient.setBounds(rect);
        gradient.draw(canvas);              

        rectangle.setStrokeWidth(0.2f);
        rectangle.setStyle(Style.STROKE);
        rectangle.setColor(getResources().getColor(
                    R.color.puzzle_foreground));
        canvas.drawRect(rect, rectangle);
        }

@Override
public boolean onTouchEvent(MotionEvent event) {
    switch (event.getAction()) {
    case MotionEvent.ACTION_DOWN:
        requestFocus();
        changeState();
        return false;
    }
    return super.onTouchEvent(event);
} 
```

这将绘制一个正方形网格，其边长为 tileSide。除最后一列外，所有正方形都可以正常工作。有时他们不回应。

也许我在寻找错误的方向。

编辑：在模拟器中工作正常。它在真实设备中失败（在索尼 xperia u、三星 Galaxy Ace、三星 Galaxy mini 上测试）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-02T20:16:43.843

有时，不好的触摸响应可能是由于 AdapterView 中的 Adapter 管理视图的循环中断而导致的。当我保存
对由 AdapterView 管理的视图的引用时，我遇到了同样的问题。它可能会导致对触摸的不良反应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T20:07:10.083

在您的中返回 false`MotionEvent.ACTION_DOWN`可能会导致某些 GestureDetector（如果这是您正在使用的）方法不被调用。尝试在那里返回 true ，看看它是否响应更好。

这个 Android 开发者页面可能会对您有所帮助： [制作交互式视图](http://developer.android.com/training/custom-views/making-interactive.html)

# jquery - 如何使导航菜单适合其容器？[横向]

> ID：12112425
> 
> 赞同：1
> 
> 时间：2012-08-24T15:32:50.327
> 
> 标签：jquery, html, css, superfish

我正在为此撕毁我的头发。基本上，我需要我的菜单根据菜单的内容水平放置一个容器。所以，我知道`table`and`table-cell`属性可以做到这一点。但是，当我将它与[Superfish Menu](http://users.tpg.com.au/j_birch/plugins/superfish/)结合使用时，我根本无法将其扩展为适合容器。

我还需要菜单之间的边距/空间，这`table-cell`似乎完全无视。

在这里查看小提琴演示，[http://jsfiddle.net/TUQpV/10/](http://jsfiddle.net/TUQpV/10/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:53:59.693

只需`float: left;`从您的`.menu li`规则中删除。原因是`li`s 向左浮动基本上会*挤压*它们一点——即使它们有空间，它们也不会向右扩展。您的演示的工作版本：[小链接](http://jsfiddle.net/TUQpV/15/)。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:59:20.680

你需要做两件事之一。使所有菜单项的大小恒定是填充容器的最简单方法，因为您已经硬编码了它的大小。

您的另一个选择是创建一些 javascript 来确定 UL 的宽度和父 div 的宽度之间的差异，然后通过增加填充在子元素之间平均分配该空间。原因是 LI 将适合其内容。您需要增加内容以拉伸整个菜单。你可以在这里看到我是如何做到的。[http://jsfiddle.net/Nilpo/GGQ4V/3/](http://jsfiddle.net/Nilpo/GGQ4V/3/)

```
$(window).load(function() {

var container = $('div.menu-main-menu-container');
var menu = $('ul.menu');

var difference = container.width() - menu.width();

if (difference > 0) {
    var count = menu.children().length;

    var pad = (difference / count) / 2;

    var total = 0;
    menu.children().each(function(){
        var el = $(this);
        var lpad = parseInt(el.css('padding-left'), 10);
        var rpad = parseInt(el.css('padding-right'), 10);

        el.css('padding-left', lpad+pad);
        total += lpad+pad;

        if ((total+rpad+pad) < difference) {
            el.css('padding-right', rpad+pad);
        } else {
            el.css('padding-right', Math.floor(rpad+pad));
        }
        total += rpad+pad;
    });
}
}); 
```

将以下内容添加到您的 CSS 中也会清除最后一个菜单项之后的空白。

```
.menu li:last-child {
    margin:0;
} 
```

编辑：您可能应该只更改右边距，这样它就不会破坏任何未来的边距更改。

```
.menu li:last-child {
    margin-right: 0;
} 
```

# python - from django.db import utils ImportError 无法导入名称 utils？

> ID：12112427
> 
> 赞同：7
> 
> 时间：2012-08-24T15:32:53.627
> 
> 标签：python, django, python-2.7, importerror

我在普通的 python shell 中，尝试导入我的项目模型时出现此错误：

```
from results.models import TestResult  

Traceback (most recent call last):  
  File "C:\Program Files (x86)\Wing IDE 3.2\src\debug\tserver\_sandbox.py", line 1, in <module>  
    # Used internally for debug sandbox under external interpreter  
  File "C:\Users\audrey_moreau\myProject\results\models.py", line 1, in <module>  
    from django.db import models  
  File "c:\Python27\Lib\site-packages\django\db\__init__.py", line 40, in <module>  
    backend = load_backend(connection.settings_dict['ENGINE'])  
  File "c:\Python27\Lib\site-packages\django\db\__init__.py", line 34, in __getattr__  
    return getattr(connections[DEFAULT_DB_ALIAS], item)  
  File "c:\Python27\Lib\site-packages\django\db\utils.py", line 92, in __getitem__  
    backend = load_backend(db['ENGINE'])  
  File "c:\Python27\Lib\site-packages\django\db\utils.py", line 54, in load_backend  
    return import_module('.base', backend_name)  
  File "c:\Python27\Lib\site-packages\django\utils\importlib.py", line 35, in import_module  
    __import__(name)  
  File "c:\Python27\Lib\site-packages\django\db\backends\sqlite3\base.py", line 14, in <module>  
    from django.db import utils  
ImportError: cannot import name utils 
```

谁能给我一个关于如何解决这个问题的指示？我正在使用 Python 2.7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T19:27:07.230

我不知道确切的原因，但是使用 Django 的 python shell 即 {$./manage.py shell} 不会抛出错误。我认为 Django 自己对 python 的包进行了少量定制/覆盖，因此在传统解释器中发生了争执。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:42:03.743

我有这个错误，它是由 django_nose 引起的。我试图从 settings.py 导入 django_nose 以确定它是否存在于系统上，如下所示：

```
try:
    import django_nose
    INSTALLED_APPS += ['django_nose']
    TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'
except ImportError:
    pass 
```

我将其修改为

```
from imp import find_module
try:
    find_module('django_nose')
    INSTALLED_APPS += ['django_nose']
    TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'
except ImportError:
    pass 
```

我的问题解决了...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-21T04:16:44.580

我有同样的错误。卸载并重新安装 django 处理了它：

```
sudo pip uninstall django
sudo pip install django 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T05:55:39.300

将 django 添加到您的系统路径。我有一个类似的问题，它对我有用。

# sql - 在 SQL AKA 中拆分和验证固定宽度或 CSV 数据行的可扩展方法如何避免 SSIS？

> ID：12112428
> 
> 赞同：0
> 
> 时间：2012-08-24T15:32:55.273
> 
> 标签：sql, sql-server, tsql

我目前正在尝试将数据输入 SQL 的不同方法，昨天使用 BCP 遇到了一个问题，尽管我解决了这个问题，但由于没有非常有用的错误信息，这让我想起了使用 SSIS 包。我觉得对于我喜欢的工作方式，我会更乐意将整个数据行加载到临时表中（无论是固定宽度还是定界）（使用 BCP 或批量插入），然后对数据行进行操作，而不是试图强制它们输入正在进入 SQL 的列。

因此，我想找到一种方法，允许我在将数据插入其目标之前拆分和验证（检查数据类型）数据，并将任何错误的数据行写入另一个表，以便我可以决定如何处理它们.

我已经拼凑了一个脚本来模拟场景，importedData 表将是我的 BCP 或 BULK INSERT 的输出。ImportedData 中的所有数据都需要在 Presenters 或 RejectedData 表中结束。

我需要一种可以合理扩展的方法，现实生活中的情况可能更像是 40 列和 2000 万行数据，所以我想我必须一次处理 10,000 行。

SQL Server 2012 具有新的 try_parse 函数，这可能会有所帮助，但我需要能够在 2005 和 2008 机器上执行此操作。

```
IF OBJECT_ID (N'ImportedData', N'U') IS NOT NULL DROP TABLE dbo.ImportedData
CREATE TABLE dbo.ImportedData (RowID INT IDENTITY(1,1), DataRow VARCHAR(MAX))

IF OBJECT_ID (N'Presenters', N'U') IS NOT NULL DROP TABLE dbo.Presenters
CREATE TABLE dbo.Presenters (PresenterID INT, FirstName VARCHAR(10), LastName VARCHAR(10))

IF OBJECT_ID (N'RejectedData', N'U') IS NOT NULL DROP TABLE dbo.RejectedData
CREATE TABLE dbo.RejectedData (DataRow VARCHAR(MAX))

-- insert as fixed-width
INSERT INTO dbo.ImportedData(DataRow)
SELECT           '1  Bruce     Forsythe  '                               
UNION ALL SELECT '2  David     Dickinson '
UNION ALL SELECT 'X  BAD       DATA'                                  
UNION ALL SELECT '3  Keith     Chegwin   '                        

-- insert as CSV
/*INSERT INTO dbo.ImportedData(DataRow)
SELECT '1,Bruce,Forsythe'                               
UNION ALL SELECT '2,David,Dickinson'                                  
UNION ALL SELECT 'X,BAD,DATA'
UNION ALL SELECT '3,Keith,Chegwin' 
*/
---------- DATA PROCESSING -------------------------------

SELECT
    SUBSTRING(DataRow,1,3) AS ID,
    SUBSTRING(DataRow,4,10) AS FirstName,
    SUBSTRING(DataRow,14,10) AS LastName
FROM
    ImportedData

---------- DATA PROCESSING -------------------------------
SELECT * FROM ImportedData
SELECT * FROM Presenters
SELECT * FROM RejectedData 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T19:17:11.460

对于您的 20M 行场景和对性能的担忧，让我们深入研究一下。

第一步，将大文件加载到数据库中。文件系统将写入磁盘并读取所有数据。也许您正坐在一堆 Fusion-io 驱动器上，而 iops 不是问题，但考虑到这种不太可能发生的情况，您将花费 X 时间通过 bcp/bulk insert/ssis/.net/etc 从磁盘读取数据。*然后*，您将花时间以表格插入的形式将所有相同的数据写回磁盘。

第 2 步，解析该数据。在我们花费任何 CPU 时间运行这些子字符串操作之前，我们需要识别数据行。如果您的机器在 RAM 上配置良好，那么 ImportedData 的数据页可能在内存中，访问它们的成本要低得多。奇怪的是，它们并不都在内存中，因此会发生逻辑和物理读取的组合来获取该数据。您现在已经有效地读取了该源文件两次，但没有任何收获。

现在是时候开始拆分数据了。开箱即用，TSQL 将为您提供 trims、left、right 和 substring 方法。使用 CLR，您可以获得一些 .NET 字符串库的包装方法，以帮助简化编码工作，但您将用实例化成本换取一些编码效率。最后我读到这个问题的答案是（tsql vs clr）是“这取决于”。如果您了解社区，这会令人震惊，但这实际上取决于您的字符串长度和许多因素。

最后，我们准备解析这些值并查看它是否是合法值。正如您所说，对于 SQL 2012，我们有[try_parse](http://msdn.microsoft.com/en-us/library/hh213126.aspx)和[try_convert](http://msdn.microsoft.com/en-us/library/hh230993)。Parse 是全新的，但如果您需要处理语言环境感知数据（01-02-05 在 GB 中，是 2005 年 2 月 1 日。在美国，是 2005 年 1 月 2 日。在 JP，是 2001 年 2 月 5 日），这是非常宝贵的。如果您不在 2012 年，则可以使用 CLR 包装器推出自己的版本。

第 3 步，错误！有人在一个糟糕的约会或其他什么事情上滑倒了，你的演员阵容失败了。发生什么了？由于查询要么成功，要么不成功，**所有**的行都会失败，并且您会收到非常有用的错误消息，例如“字符串或二进制数据将被截断”或“从字符串转换日期时间时转换失败”。您的 N 大小切片中的哪一行？直到你去寻找它，你才会知道，这就是人们通常转向进一步降低性能的 RBAR 方法的时候。或者他们尝试保持基于集合，但针对在尝试插入之前转换失败的场景对源集过滤运行重复查询。

你可以从我的标签中看出，我是一个 SSIS 类型的人，但我并不偏执地认为这是唯一可以工作的东西。如果有 ETL 的方法，我想我已经尝试过了。[在您的情况下，我认为您将通过开发自己的 ETL 代码/框架或使用现有的（犀牛](http://hibernatingrhinos.com/open-source/rhino-etl)或[反应式](http://reactiveetl.codeplex.com/)）获得更好的性能和可扩展性

最后，注意 varchar(max) 的含义。它有与之相关的性能成本。

*   [varchar(max) 无处不在？](https://stackoverflow.com/questions/2091284/varcharmax-everywhere)
*   [varchar(500) 比 varchar(8000) 有优势吗？](https://stackoverflow.com/questions/2009694/is-there-an-advantage-to-varchar500-over-varchar8000/5654947#5654947)

此外，如上所述，您的流程将只允许 ETL 的单个实例同时运行。也许这涵盖了您的用例，但是在我们进行大量 ETL 的公司中，我们不能强迫客户 B 在开始工作之前等待客户 A 的 etl 完成处理，否则我们将立即缺少客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:34:44.863

**在 T-SQL 中没有简单的方法。在这种情况下，对于您将尝试解析的所有数据类型，**您需要具有isdate() 、isnumeric() 类型的 UDF 。然后您可以将被拒绝的行移到被拒绝的表中，从importeddate中删除这些行，然后继续加载..

```
SELECT 
RecordID,
SUBSTRING(DataRow,1,3) AS ID, 
SUBSTRING(DataRow,4,10) AS FirstName, 
SUBSTRING(DataRow,14,10) AS LastName,
SUBSTRING(DataRow,24,8) AS DOB,
SUBSTRING(DataRow,32,10) AS Amount,     
INTO RejectedData 
FROM ImportedData
WHERE  ISDATE(SUBSTRING(DataRow,24,8))= 0 
OR ISNUMERIC(SUBSTRING(DataRow,32,10))=0 
```

然后从导入的数据中删除

```
DELETE FROM ImportedData WHERE RecordID IN (SELECT RecordID FROM RejectedData ) 
```

然后插入演示者

```
INSERT INTO Presenters     
SELECT 
RecordID,
SUBSTRING(DataRow,1,3) AS ID, 
SUBSTRING(DataRow,4,10) AS FirstName, 
SUBSTRING(DataRow,14,10) AS LastName,
CONVERT(Date,SUBSTRING(DataRow,24,8)) AS DOB,
CONVERT(DECIMAL(18,2),SUBSTRING(DataRow,32,10)) AS Amount,  
FROM ImportedData 
```

对于在插入中管理批次，这是一篇非常好的文章。

[http://sqlserverplanet.com/data-warehouse/transferring-large-amounts-of-data-using-batch-inserts](http://sqlserverplanet.com/data-warehouse/transferring-large-amounts-of-data-using-batch-inserts)

# sitefinity - 在 Sitefinity 动态模块中处理添加新项目事件

> ID：12112433
> 
> 赞同：1
> 
> 时间：2012-08-24T15:33:22.043
> 
> 标签：sitefinity, sitefinity-4

我正在使用 Sitefinity CMS。我已经使用 Module Builder（例如 Products）创建了新的动态模块。当我向内容产品添加新项目时，我想做一些操作。是否可以处理该事件？

我将非常感谢能提供建议的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:27:41.403

最新版本的 sitefinity 包含一些事件挂钩，您可以订阅这些挂钩来执行此操作。

我仍在探索这个主题，一些新的文档应该很快就会发布，但与此同时你想查看 Telerik.Sitefinity.Services.EventHub.Subscribe(handler) 其中 T 是你想要订阅的事件类型（从 IEvent 继承），handler 是您的事件处理程序，其中包含您希望执行的代码。

就像我说的那样，更多信息即将发布，但希望这会同时为您指明正确的方向！

希望这会有所帮助！

# perl - Perl - 返回数据集中的最大值

> ID：12112434
> 
> 赞同：1
> 
> 时间：2012-08-24T15:33:24.703
> 
> 标签：perl, pdl

我以前从未深入研究过 Perl 的世界，我觉得它很混乱，需要一些帮助。在下面的代码中， calc() 部分返回“输入”超过“计数”样本的运行平均值。我想修改它，以便 calc() 返回样本集中的最大值。在此先感谢您的帮助！

```
sub calc
{
    my ($this, $dim, $input, $count) = @_;

    if ($count < 1)
    {
        warn "count=$count is less than 1.";
        return undef;
    }

    my $inputsum_in = $this->{inputsum};
    my ($inputcumsum, $inputsum_out) = PDL::CumulativeSumOver2($input, $inputsum_in);

    my $inputdelay = $this->delay('inputhistory', $input);
    my $inputdelaysum_in = $this->{inputdelaysum};
    my ($inputdelaycumsum, $inputdelaysum_out) = PDL::CumulativeSumOver2($inputdelay, $inputdelaysum_in);

    $this->{inputsum} = $inputsum_out;
    $this->{inputdelaysum} = $inputdelaysum_out;

    my $sampleno = $this->{sampleno};
    my $divider = $count;
    if($sampleno < $count)
    {
        my $last = $dim - 1;
        $divider = sequence($dim) + ($sampleno + 1);
        my $start = $count - $sampleno;
        $divider->slice("$start:$last") .= $count if $start <= $last;
        $this->{sampleno} = $sampleno + $dim;
    }
    return ($inputcumsum - $inputdelaycumsum) / $divider;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T16:01:23.683

怎么样

```
 $max = max($input); 
```

[PDL 原语](http://llama.mshri.on.ca/~fgibbons/lib/pdl/Primitive.html#max)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:55:30.970

如果要查找某个值列表的最大值，则无需编写自己的子例程。perl v5.7.3 或更高版本已经附带了一个函数：

```
use List::Util qw(max); # core module since v5.7.3
use strict;
use warnings;

print max(1 .. 10);  # prints 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T18:44:40.753

编辑：这是我认为你需要的循环。

1.  从传感器读取输入数据
2.  将新数据附加到存储的数据
3.  丢弃多余的数据
4.  评估

这就是我的做法。

```
my $storedData = pdl;  
# $storedData is now a vector containing one element, 0
while (! stopCondition()) {
    my $input = readSensorData(); # step 1
    $storedData = $storedData->append($input); # step 2
    if ($storedData->nelem > $count) { # step 3
        $storedData = $storedData->slice("-$count:-1");
        # note that -1 points to the last element in a piddle and -X refers to 
        # the element X-1  away from the end (true for piddles and native arrays)
    }
    my ($max, $min) = evaluate($storedData); # step 4
} 
```

我不确定这是否能回答您的问题，但您下面的评论似乎与您上面的问题完全不同。考虑编辑以上内容以更好地反映您遇到的问题或提出新问题。

* * *

获得运行平均值的一种简单方法是使用有限脉冲响应滤波器，即卷积。将任何信号与（归一化的）矩形脉冲进行卷积，得到运行平均值。

```
my $filter = ones($count) / $count; 
my $runningAve = convolveND($input, $filter); 
my $max = $runningAve->max`; 
```

或者在一行

```
my $max = convolveND($input, ones($count) / $count)->max; 
```

`convolveND` [记录在这里](http://pdl.perl.org/PDLdocs/ImageND.html#convolvend)。

* * *

使用此方法需要注意一件事，即 $runningAve piddle 开头和结尾的值并不是真正的运行平均值。为了确保输出与输入的大小相同`convolveND`（默认情况下），有效地将零连接到输入的开头和结尾，结果是第一个和最后几个元素`$runningAve`低于实际运行平均值。（请注意，运行平均值`N - (window - 1)`原则上应该包含元素，N 是 的大小`$input`。）由于这些“坏”值必然低于实际运行平均值，因此它们不会干扰您想要的最大值。（关于“默认情况下”：`convolveND`有其他处理边缘的方法，正如您将在上面链接的文档中看到的那样。）

（注意：我不是 PDL 专家。可能有一种比 convolveND 更便宜的方法来获得运行平均值，例如`$ra = $input->range(...)->sumover(0) / $count`，但我不知道你在......上面放了什么. 另见[http://search.cpan.org/~jlapeyre/PDL-DSP-Iir-0.002/README.pod#moving_average](http://search.cpan.org/~jlapeyre/PDL-DSP-Iir-0.002/README.pod#moving_average) )

# java - 对话框中未显示新复合材料

> ID：12112440
> 
> 赞同：0
> 
> 时间：2012-08-24T15:33:49.827
> 
> 标签：java, swt, jface

我正在尝试将新的合成添加到我的对话框中。我正在创建一个简单的按钮，我想把它放在对话框中。我首先创建了一个方法来创建 Button 区域。此方法正在调用创建简单按钮的方法。新按钮未显示在对话框中。

这是完整的代码

```
public class AplotBaseDialog extends TitleAreaDialog {

   private TCSession session= null;
   public AplotBaseDialog(Shell parentShell, TCSession theSession) {
       super(parentShell);
       session = theSession;
   }

   @Override
   protected Control createDialogArea(Composite parent) {
   Composite composite = (Composite) super.createDialogArea(parent);
   GridLayout layout = new GridLayout();
   layout.numColumns = 1;
   composite.setLayout(layout);

   // The text fields will grow with the size of the dialog
   GridData gridData = new GridData();
   gridData.grabExcessHorizontalSpace = true;
   gridData.horizontalAlignment = GridData.BEGINNING;
   Label label1 = new Label(composite, SWT.NONE);
   label1.setText("First Name");
   label1.setLayoutData(gridData);

   gridData = new GridData();
   gridData.grabExcessHorizontalSpace = true;
   gridData.horizontalAlignment = GridData.CENTER;
   Label label2 = new Label(composite, SWT.NONE);
   label2.setText("Last Name");
   label2.setLayoutData(gridData);

   gridData = new GridData();
   gridData.grabExcessHorizontalSpace = true;
   gridData.horizontalAlignment = GridData.END;
   Button button1 = new Button(composite, SWT.PUSH);
   button1.setText("Button 5");
   button1.setLayoutData(gridData);

   return composite;
}

protected void createButtonArea(Composite parent){
  GridData gridData = new GridData();
  gridData.horizontalAlignment = SWT.CENTER;
  parent.setLayoutData(gridData);
  createOkButton(parent);

 }
 protected Button createOkButton(Composite parent) {
  // increment the number of columns in the button bar
  ((GridLayout) parent.getLayout()).numColumns++;
  Button button = new Button(parent, SWT.PUSH);
  button.setText("Test Button");
  setButtonLayoutData(button);
  return button;
 }
} 
```

为什么测试按钮没有显示在对话框中？

在 SWT/Jface 中是否有可能发生这样的事情？ ![所需的对话框布局](../Images/4228cce8568fd369c8c5c22aa48980aa.png)

有人可以向我展示执行对话框之类的方法的布局吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:59:07.763

也许它会更干净，而不是`createButtonArea()`您创建的方法来实际覆盖该`createButtonsForButtonBar`方法。它会更加 SWT 友好。

```
/**
 * Create contents of the button bar.
 * @param parent
 */
@Override
protected void createButtonsForButtonBar(Composite parent) {
    createButton(parent, IDialogConstants.OK_ID, "Test Button",
            true);
    createButton(parent, IDialogConstants.CANCEL_ID,
            IDialogConstants.CANCEL_LABEL, false);
} 
```

# ruby-on-rails - 我们如何检查网址是否正确

> ID：12112444
> 
> 赞同：-2
> 
> 时间：2012-08-24T15:34:03.110
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, url, routing

我们有一个应用程序，用户可以在其中获得自己的用户空间，无需登录即可创建条目。我们生成一个动态链接 Like

```
localhost://apps/{owncode}/userspace 
```

owncode是我们计算出来的，code会存入数据库

用户可以为他的用户空间添加条目。

```
localhost://apps/{owncode}/entries/new 
```

我如何比较（检查它是否正确）`{owncode}`来自数据库的 url。因为我们想捕捉是否有人通过尝试和错误调用 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:37:58.223

如果不强制用户登录，则无法检查。您也不应该使用 URL 中的任何内容来识别他们的“用户空间”。它应该全部隐藏在会话中，与登录用户的帐户相关联。

如果您至少想`owncode`难以猜测，则可以生成一个长得离谱的散列字符串。但不推荐这样做，它不能保证任何安全性，并且用户仍然可以尝试猜测其他“用户空间”的字符串，而您的应用程序对此无能为力。

# sql - 处理 SQL Server 表列名中的特殊字符

> ID：12112445
> 
> 赞同：0
> 
> 时间：2012-08-24T15:34:07.620
> 
> 标签：sql, sql-server

实际上，我创建了一个 SQL Server 表，其列名包含特殊字符，例如`@#$$%Id%^$#`，我创建了一个插入查询来插入值，例如：

```
Insert into MyTable ([@#$$%Id%^$#]) values (@@#$$%Id%^$#) 
```

之后将参数值传递为：

```
SqlCommand  cmd = new SqlCommand (“Insert into MyTable ([@#$$%Id%^$#]) values (@@#$$%Id%^$#) ”);
cmd.Parameters.Add(new SqlParameter (“(@@#$$%Id%^$#”, ParameterValue)) 
```

执行此代码后，我得到了

> *必须声明标量变量@*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T15:36:57.033

这永远不会奏效：

```
Insert into MyTable ([@#$$%Id%^$#]) values (@@#$$%Id%^$#) 
```

除非您以这种方式声明了变量：

```
DECLARE @@#$$%Id%^$# INT = 1; 
```

但是，这不是有效的语法。因此，也许您打算将整个值作为字符串插入：

```
Insert into MyTable ([@#$$%Id%^$#]) values ('@@#$$%Id%^$#') 
```

您在字符串中使用前导 @ 令人困惑 - 您的意思是作为参数指定吗？这对我来说很好：

```
CREATE TABLE dbo.MyTable([@#$$%Id%^$#] VARCHAR(255));

INSERT dbo.MyTable([@#$$%Id%^$#]) VALUES('@@#$$%Id%^$#');

DROP TABLE dbo.MyTable; 
```

# c# - sqlite-net 中的 SqliteDataReader 在哪里？

> ID：12112448
> 
> 赞同：7
> 
> 时间：2012-08-24T15:34:11.503
> 
> 标签：c#, .net, sqlite, sqlite-net

我正在尝试移植一个使用本机 Sqlite3 并大量使用`SqliteDataReader`. 在目标平台上，我使用 SQLIte-Net ( [https://github.com/praeclarum/sqlite-net](https://github.com/praeclarum/sqlite-net) ) 并且 SqliteDataReader 类不存在。转换它的最佳选择是什么？阅读器的用法总是这样的代码：

```
SqliteConnection oConn = AppDelegateBase.MasterDatabase.CreateDBMSConnection();
using ( SqliteCommand oCmd = new SqliteCommand ( "SELECT * FROM ATable"), oConn ) )
using ( var oReader = oCmd.ExecuteReader (  ) )
{
  while ( oReader.Read (  ) )
  {
    int val = Convert.ToInt32(oReader["someColumn"]);
  }
  oReader.Close ();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T12:46:56.730

我在几个项目中成功使用了[System.Data.SQLite ADO 适配器。](http://system.data.sqlite.org/index.html/doc/trunk/www/index.wiki)我相信它有一个 SQLDataReader 类。我不确定它是否与您所追求的相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-18T10:38:34.113

sqlite-net 中没有 IDataReader/IDataRecord 实现，因为 sqlite-net 不是 ADO 适配器 .net 实现。

您应该首先查看 GitHub 页面上的示例。您不应使用 SQL 语言，如此[处](https://components.xamarin.com/gettingstarted/sqlite-net)所述。如果您需要 ADO 实现，还有其他用于 C# 的 SQLite 库，如 System.Data.SQLite（官方）、sqlite-csharp 和 Mono.Data.Sqlite。

# java - GAE 上的 Resent-From 电子邮件标题

> ID：12112452
> 
> 赞同：0
> 
> 时间：2012-08-24T15:34:32.753
> 
> 标签：java, google-app-engine, email

我设置了外发电子邮件的“Resent-From”标头。

```
message.setHeader("Resent-From","test@test.com"); 
```

这应该在 1.7.1 中得到支持，但在收到的电子邮件中没有标头。我还尝试使用有效的管理员地址（根据“发件人”字段的要求）但没有成功。

有人在 GAE 中成功设置了“Resent-From”标头吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:26:58.207

我可以复制你的报告。但是，我也可以向您确认，如果您使用低级 API，您可以设置标头。

[我建议您在http://code.google.com/p/googleappengine/issues/list](http://code.google.com/p/googleappengine/issues/list)上提交票证。我将创建一个内部的。

# java - d 上的 UnknownHostException

> ID：12112462
> 
> 赞同：0
> 
> 时间：2012-08-24T15:34:55.090
> 
> 标签：java, rss, feed

我尝试运行以下示例：

[http://www.sonatype.com/books/mvnex-book/reference/customizing-sect-custom-exec.html](http://www.sonatype.com/books/mvnex-book/reference/customizing-sect-custom-exec.html)

失败的代码基本上是：

```
String url = "http://weather.yahooapis.com/forecastrss?p=60202";
URLConnection conn = new URL(url).openConnection();
return conn.getInputStream(); 
```

我可以完美地从浏览器/提要阅读器访问 URL。但是，在 Java 中运行代码时，我得到一个

```
Exception in thread "main" java.net.UnknownHostException: weather.yahooapis.com 
```

任何想法，可能是什么问题？可能是我们办公室的代理阻止了 URL，但是我可以从浏览器访问它吗？

最好的，威尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-02-10T03:26:13.100

自 2019 年 1 月 3 日起，该 URL 已停用。有关更多信息，请参阅此链接：

[https://developer.yahoo.com/weather/](https://developer.yahoo.com/weather/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:39:36.937

该网站对我来说很好阅读......我假设这意味着你被那个代理阻止了。尝试`System.setProperty("http.agent", "Fake Agent");`欺骗代理/站点认为您不是 Java（通常 http.agent 是 Java/版本）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T16:22:01.183

您是否已阻止 Java 虚拟机访问 Internet？您看到的异常意味着无法将主机解析为 IP。

请检查您的网络安全设置或防火墙以允许 JVM 连接到您请求的站点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-18T23:48:59.417

您是否在 Android Manifest 中授予了 Internet 权限？

# php - 教义查询生成器抛出 [语义错误]

> ID：12112464
> 
> 赞同：1
> 
> 时间：2012-08-24T15:35:03.873
> 
> 标签：php, zend-framework, doctrine-orm

我遇到了教义查询生成器的问题，向我抛出 [语义错误] 我正在尝试构建的查询是这样的：-

```
 $query = $this->_em->createQueryBuilder()
       ->select('r, m')
       ->from('Ajfit\Entity\TicketReply', 'r')
       ->join('r.mailFk', 'm')
       ->where('r.ticketFk = :ticket')
       ->orderBy('m.dt', 'desc')
       ->setParameter('ticket', $ticket)
       ->getQuery();

    $paginator =  new Paginator($query);
    return $paginator->getIterator(); //////////blows up here! 
```

抛出的错误是：-

```
 [Semantical Error] line 0, col 64 near 'm WHERE r.ticketFk': Error: Class Ajfit\Entity\TicketReply has no association named mailFk 
```

错误所指的实体是：-

命名空间 Ajfit\Entity；

```
use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Persistence\PersistentObject;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * Ajfit\Entity\TicketReply
 *
 * @ORM\Table(name="ticket_reply")
 * @ORM\Entity(repositoryClass="Ajfit\Repository\TicketReply")
 * @ORM\HasLifecycleCallbacks
 */
 class TicketReply extends \Doctrine\Common\Persistence\PersistentObject
 {
    /**
     * @ORM\Id
     * @ORM\Column(name="mail_fk", type="integer")
     * @ORM\ManyToOne(targetEntity="Ajfit\Entity\Mail", inversedBy="replies")
     * @ORM\JoinColumn(name="mail_fk", referencedColumnName="pk")
     */
    protected $mailFk;

    /**
     * @ORM\Id
     *  @ORM\Column(name="ticket_fk", type="integer")
     * @ORM\ManyToOne(targetEntity="Ajfit\Entity\Ticket", inversedBy="replies")
     * @ORM\JoinColumn(name="ticket_fk", referencedColumnName="pk")
     */
    protected $ticketFk;

   /**
    * @var integer $rating
    *
    * @ORM\Column(name="rating", type="integer")
    */
    protected $rating;

 } 
```

由于 TicketReply 实体没有 mailFk 关联的错误详细信息，但是它确实存在，我编写查询构建器的原因是否存在问题？

谢谢安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T19:49:36.270

你`$mailFk`有一个`Column`和一个`ManyToOne`注释。列注释不能用于存储关系。Doctrine 似乎选择`Column`在`ManyToOne`.

删除`@ORM\Column`注释：

```
/**
 * @ORM\Id
 * @ORM\ManyToOne(targetEntity="Ajfit\Entity\Mail", inversedBy="replies")
 * @ORM\JoinColumn(name="mail_fk", referencedColumnName="pk")
 */
protected $mailFk; 
```

做同样的事情`$ticketFk`

# asp.net - 为什么 Visual Studio 2012 会打开地址为 0.0.0.1 的浏览器窗口？

> ID：12112466
> 
> 赞同：1
> 
> 时间：2012-08-24T15:35:11.113
> 
> 标签：asp.net, visual-studio-2012

在调试 Web 应用程序时，VS2012 会打开两个浏览器窗口。一个到我的应用程序，另一个到 0.0.0.1。

关于为什么以及如何阻止它的任何线索。每次调试时都必须关闭该窗口，这很烦人。

# c# - 如果 ADO.NET 中的插入查询中没有输入值，则 SQL 标识列会引发不能为空的异常

> ID：12112467
> 
> 赞同：0
> 
> 时间：2012-08-24T15:35:20.207
> 
> 标签：c#, sql, visual-studio-2010, ado.net, identity-column

我在数据库中有一个标识列，它是主键并自行增加其值。但我在 asp.net ado.net 类中有一个插入查询，如下所示：

```
cmd = new SqlCommand("insert into Images(Name,[Image]) VALUES ('Nature',@img)", conn);
cmd.CommandType = CommandType.Text;
cmd.Parameters.Add("@Name", SqlDbType.VarChar).Value = TextBox1.Text;
cmd.Parameters.Add("@img", SqlDbType.Image).Value = img;
cmd.ExecuteNonQuery(); 
```

但是，它向我抛出了异常，它不能为空。

我的想法/目标是，我只想插入上述两个值，并且主键列应该在 DB 内部自行递增。我已经在数据库中配置了它。但是我不知道如何处理此错误或调整此代码。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T13:45:23.260

确保表上的`ID`列`Images`是标识列。

例如：

```
CREATE TABLE Images(
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Name] [varchar](100) NOT NULL,
    [Image] [image] NOT NULL) 
```

如果是，则单步执行您的代码并确保您使用的参数不为空； `TextBox1.Text`和`img`。

最后，确保表上没有其他不可为空的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T13:49:19.513

我认为您没有在查询中提供@Name 参数，但是您在参数中发送值。

**请删除“自然”值并输入@Name。**

```
cmd = new SqlCommand("insert into Images(Name,[Image]) VALUES (@Name ,@img)", conn); cmd.CommandType = CommandType.Text; 
cmd.Parameters.Add("@Name", SqlDbType.VarChar).Value = TextBox1.Text; 
cmd.Parameters.Add("@img", SqlDbType.Image).Value = img; 
cmd.ExecuteNonQuery(); 
```

# c# - 简单的函数来查看 c# 中的整数是否是素数？

> ID：12112477
> 
> 赞同：1
> 
> 时间：2012-08-24T15:35:50.977
> 
> 标签：c#

是否有一个函数或一个简单的类可以让我检查 c# 中的整数是否是素数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T15:36:32.660

不。

你需要自己写。

一个整数的基本算法是将它除以所有整数，直到它的平方根，并确保总是有余数。

要检查多个数字，可以使用优化算法，例如[埃拉托色尼筛](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T15:39:28.097

没有理由拥有标准的素数检查功能。

这是一种昂贵的计算，可以通过不同的方式进行，每种方式对内存和 cpu 都有不同的影响。

它实际上取决于数字的大小和您必须测试其素数的数字序列，因为通常需要存储中间值。

否则说：您选择的解决方案必须适应您的程序和您的确切需求。我建议您首先查看[wikipedia](http://en.wikipedia.org/wiki/Primality_test)（链接归功于 Chris Shain）和现有的库（例如[这个用于小整数](http://www.dotnetperls.com/prime)的库） （归功于 Google 的链接）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T15:42:25.347

这是我用于所有项目欧拉问题的那个。

```
private static bool IsPrime(long number) {
    if (number <= 1) return false;
    for (long i = 2; i <= Math.Sqrt(number); i++) {
        if (number % i == 0)
            return false;
    }
    return true;
} 
```

# regex - 返回文本数据库的列条目的正则表达式规则

> ID：12112480
> 
> 赞同：0
> 
> 时间：2012-08-24T15:36:04.520
> 
> 标签：regex, matlab

给定一个简单的分隔符分隔的文本数据库，我想构造一个正则表达式规则，它返回列/字段条目。

给出以下两个示例行

```
entry1 = '|123|some|string   |101112  |'
entry2 = '|123|some|  |101112  |' 
```

我想得到以下输出：

```
values1 = '123', 'some', 'string', '101112'
values2 = '123', 'some', '', '101112' 
```

到目前为止，我正在使用以下`regexp`和`regexprep`组合：

```
values = regexp(regexprep(entry '[\s]', ''), '\|', 'split') 
```

不幸的是，它返回以下内容：

```
values1 =  ''    '123'    'some'    'string'    '101112'    ''
values2 =  ''    '123'    'some'    ''    '101112'    '' 
```

但我想得到（`''`之前没有额外的，之后`123`没有额外的）：`''``'101112'`

```
values1 = '123', 'some', 'string', '101112'
values2 = '123', 'some', '', '101112' 
```

鉴于我的正则表达式规则，为什么我`''`在开头和结尾都得到了？如何更改我的正则表达式规则，只返回字段值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:51:13.360

我不确定这是否正是您所要求的，但您可以使用`strread`：

```
strread(entry1(2:end),'%d','delimiter','|')
ans =
         123
         456
         789
      101112 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:24:31.627

那里有空字符串，因为您告诉 matlab 在`|`字符处拆分。分裂意味着你在那里切割。如果之前没有任何内容`|`，您将得到空字符串。例如，拆分这个（子结果之后`regexprep`）：

```
'|123|456|789|101112|' 
```

结果（想象在 处切割字符串`|`）：

```
'', '123', '456', '789', '101112', '' 
```

因此，要么在第一个和最后一个之间拆分字符串`|`：

```
nospaces = regexprep(entry, '\s', '')
betweenpipes = nospaces(2:size(nospaces,2)-1)
values = regexp(betweenpipes, '\|', 'split') 
```

..或者根本不使用拆分，只需搜索所需的模式：

```
regexp(entry, '(?=\)(?:\s*)(\d+)(?:\s*)(?=\)', 'match') 
```

正则表达式解释：

1.  寻找`|`，但不记得了：`(?=\|)`
2.  跳过可能的空格但不记得了：`(?:\s*)`
3.  匹配一个数字：`(\d+)`
4.  跳过可能的空格但不记得了：`(?:\s*)`
5.  寻找`|`，但不记得了：`(?=\|)`

我是凭记忆写的，因为我这里没有matlab，所以可能会有一些错误..

# php - 在 PHP < 5.4 中是否有任何方法可以获取您刚刚设置的状态响应代码？

> ID：12112484
> 
> 赞同：6
> 
> 时间：2012-08-24T15:36:25.263
> 
> 标签：php, apache

我知道在 php 5.4 中有一个新功能`http_response_code()`，但在以前的版本中，您将如何获得刚刚设置的响应代码？

类似于[有没有办法从 PHP 获取当前的 HTTP 响应代码？](https://stackoverflow.com/questions/8367877/is-there-any-way-to-get-the-current-http-response-code-from-php)

我有这个需求：

```
 //sometime earlier
 header('HTTP/1.1 404 Not Found');

//sometime later, detect if error was set
$status = some_magic_way_to_find_status(); 
```

有没有人有办法在 php 5.3 或更低版本中执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T15:41:19.330

**编辑：**正如@Esailija 所写：请注意，您需要重写所有标头调用以使用此函数才能使其工作

在手册中找到此代码， [http://www.php.net/manual/en/function.http-response-code.php#107261](http://www.php.net/manual/en/function.http-response-code.php#107261)

```
<?php

    if (!function_exists('http_response_code')) {
        function http_response_code($code = NULL) {

            if ($code !== NULL) {

                switch ($code) {
                    case 100: $text = 'Continue'; break;
                    case 101: $text = 'Switching Protocols'; break;
                    case 200: $text = 'OK'; break;
                    case 201: $text = 'Created'; break;
                    case 202: $text = 'Accepted'; break;
                    case 203: $text = 'Non-Authoritative Information'; break;
                    case 204: $text = 'No Content'; break;
                    case 205: $text = 'Reset Content'; break;
                    case 206: $text = 'Partial Content'; break;
                    case 300: $text = 'Multiple Choices'; break;
                    case 301: $text = 'Moved Permanently'; break;
                    case 302: $text = 'Moved Temporarily'; break;
                    case 303: $text = 'See Other'; break;
                    case 304: $text = 'Not Modified'; break;
                    case 305: $text = 'Use Proxy'; break;
                    case 400: $text = 'Bad Request'; break;
                    case 401: $text = 'Unauthorized'; break;
                    case 402: $text = 'Payment Required'; break;
                    case 403: $text = 'Forbidden'; break;
                    case 404: $text = 'Not Found'; break;
                    case 405: $text = 'Method Not Allowed'; break;
                    case 406: $text = 'Not Acceptable'; break;
                    case 407: $text = 'Proxy Authentication Required'; break;
                    case 408: $text = 'Request Time-out'; break;
                    case 409: $text = 'Conflict'; break;
                    case 410: $text = 'Gone'; break;
                    case 411: $text = 'Length Required'; break;
                    case 412: $text = 'Precondition Failed'; break;
                    case 413: $text = 'Request Entity Too Large'; break;
                    case 414: $text = 'Request-URI Too Large'; break;
                    case 415: $text = 'Unsupported Media Type'; break;
                    case 500: $text = 'Internal Server Error'; break;
                    case 501: $text = 'Not Implemented'; break;
                    case 502: $text = 'Bad Gateway'; break;
                    case 503: $text = 'Service Unavailable'; break;
                    case 504: $text = 'Gateway Time-out'; break;
                    case 505: $text = 'HTTP Version not supported'; break;
                    default:
                        exit('Unknown http status code "' . htmlentities($code) . '"');
                    break;
                }

                $protocol = (isset($_SERVER['SERVER_PROTOCOL']) ? $_SERVER['SERVER_PROTOCOL'] : 'HTTP/1.0');

                header($protocol . ' ' . $code . ' ' . $text);

                $GLOBALS['http_response_code'] = $code;

            } else {

                $code = (isset($GLOBALS['http_response_code']) ? $GLOBALS['http_response_code'] : 200);

            }

            return $code;

        }
    }

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:43:32.780

我不认为这是可能的。

你可以包装`header()`函数：

```
function my_status_header($setHeader=null) {
    static $theHeader=null;
    //if we already set it, then return what we set before (can't set it twice anyway)
    if($theHeader) {return $theHeader;}
    $theHeader = $setHeader;
    header('HTTP/1.1 '.$setHeader);
    return $setHeader;
} 
```

或者，当然，您可以随时升级到 PHP5.4。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-30T23:47:23.087

For set http code use with PHP 5.3 or prior (you can create a file called `http_response_code.php` and put this content):

```
/*Check if function is available (php5.3<)*/
if (false === function_exists('http_response_code')) {
    /* Fallback */

    function http_response_code($code = null)
    {
        static $currentStatus;

        if ($code === null) {
            if ($currentStatus !== null) {
                return $currentStatus;
            }

            $currentStatus = 200;

            if (empty($_SERVER['PHP_SELF']) === false &&
                preg_match('#/RESERVED\.HTTP\-STATUS\-(\d{3})\.html$#', $_SERVER['PHP_SELF'], $match) > 0)
            {
                $currentStatus = (int) $match[1];
            }
        } elseif (is_int($code) && headers_sent() === false) {
            header('X-PHP-Response-Code: ' . $code, true, $code);
            $currentStatus = $code;
        }

        return $currentStatus;
    }
} 
```

For use call:

```
<?php

require 'foo/bar/http_response_code.php';

$code = http_response_code();
http_response_code(403);

echo 'Initial HTTP code: ', $code, '<br>', PHP_EOL;
echo 'Current HTTP code: ', http_response_code(), '<br>', PHP_EOL; 
```

This code returns:

> Initial HTTP code: 200
> Current HTTP code: 403

* * *

This function check server error using URL reserved, for work use this configs:

**.htacces (Apache)**

```
ErrorDocument 403 /error.php/RESERVED.HTTP-STATUS-403.html
ErrorDocument 404 /error.php/RESERVED.HTTP-STATUS-404.html 
```

**nginx**

```
error_page 404 /RESERVED.HTTP-STATUS-404.html;
error_page 403 /RESERVED.HTTP-STATUS-403.html;

location ~ ^/RESERVED\.HTTP\-STATUS\-(403|404)\.html$ {
    rewrite ^/RESERVED\.HTTP\-STATUS\-(403|404)\.html$ /error.php$0 last;
} 
```

**IIS**

```
<httpErrors errorMode="Custom">
    <remove statusCode="403" />
    <remove statusCode="404" />
    <error statusCode="403" path="/error.php/RESERVED.HTTP-STATUS-403.html" responseMode="ExecuteURL" />
    <error statusCode="404" path="/error.php/RESERVED.HTTP-STATUS-501.html" responseMode="ExecuteURL" />
</httpErrors> 
```

The `error.php` is a example, can change if needed. In your script page use (error.php):

```
<?php

require 'foo/bar/http_response_code.php';

echo 'Error page, status: ', http_response_code(); 
```

For load a "template":

```
<?php

require 'foo/bar/http_response_code.php';

include 'template/error/http_' . $code . '.php'; 
```

# file - 如何在另一个应用程序域中加载 dll 的配置文件

> ID：12112489
> 
> 赞同：4
> 
> 时间：2012-08-24T15:36:49.770
> 
> 标签：file, dll, configuration, exe, appdomain

我有一个应用程序需要以 dll 的形式加载加载项。dll 需要从配置 (app.config) 文件中获取其配置信息。我想动态找出 app.config 文件的名称，据我所知，这样做的方法是 AppDomain.CurrentDomain.SetupInformation.ConfigurationFile

但是，由于它托管在父应用程序内部，因此从上述代码中获取的配置文件是 (parentapplication).exe.config。我无法在父应用程序中加载另一个 appdomain，但我想更改 appdomain 的配置文件详细信息。我应该怎么做才能获取 dll 的配置文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T03:12:07.427

好的，最后，我设法破解了一些对我有用的东西。也许这会有所帮助；

使用 Assembly.GetExecutingAssembly，从包含我要读取的配置文件的 DLL 中，我可以使用 .CodeBase 在为它启动新的 AppDomain 之前找到 DLL 的位置。*.dll .config 位于同一个文件夹中。

然后必须转换 URI（因为 .CodeBase 看起来像“file://path/assembly.dll”）以获取 ConfigurationManager 的 LocalPath（它不喜欢 Uri 格式的字符串）。

```
try
{
    string assemblyName = Assembly.GetExecutingAssembly().GetName().Name;
    string originalAssemblyPath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().CodeBase);
    Uri uri = new Uri(String.Format("{0}\\{1}.dll", originalAssemblyPath, assemblyName));
    string dllPath = uri.LocalPath;

    configuration = ConfigurationManager.OpenExeConfiguration(dllPath);
}
catch { } 
```

# java - 正则表达式 replaceAll 的问题

> ID：12112495
> 
> 赞同：1
> 
> 时间：2012-08-24T15:37:00.830
> 
> 标签：java, regex, replaceall

我正在努力`a/b/c.x.y`变成`abc`. 但是，我的正则表达式似乎存在问题，特别是`'\\.*'`.

```
 "a/b/c.x".replaceAll( "/|\\.*", "" ); 
```

产量：

```
 "abcx" 
```

任何见解都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T15:39:45.437

您正在用空字符串替换任何斜线或“任意数量的点”。

我怀疑你的意思是任何斜线或“一个点后跟任意数量的任何字符”，这将是：

```
replaceAll("/|\\..*", ""); 
```

这对我来说当然适用于样本值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:40:35.127

您当前的正则表达式匹配正斜杠或零个或多个句点。我假设您想匹配正斜杠或句点加上它之后的任何内容。为此，你想要

```
"/|\\..*" 
```

# error-handling - Elmah 在 SQL Server 中记录错误，但未显示在 Elmah.axd 上

> ID：12112500
> 
> 赞同：13
> 
> 时间：2012-08-24T15:37:29.770
> 
> 标签：error-handling, elmah, error-logging

我在 WCF 应用程序上设置了 Elmah，它正在记录到 SQL 服务器。就将数据插入`Elmah_error`表中而言，一切似乎都在工作。但表格中有 5 个错误，而`Elmah.axd`.

如何设置 Elmah 以显示表中的所有错误？

## 额外信息

### 数据库中的错误

*   System.Web.HttpRequestValidationException
*   系统异常
*   系统异常
*   System.ArgumentException

### Elmah.axd 上显示的错误

*   System.Web.HttpRequestValidationException
*   System.Web.HttpException

### Web.config 设置

```
<httpModules>
  <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
  <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
  <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
</httpModules> 
```

```
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" preCondition="managedHandler" />
      <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" preCondition="managedHandler" />
      <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" preCondition="managedHandler" />
    </modules>
    <validation validateIntegratedModeConfiguration="false" />
  </system.webServer> 
```

```
<system.webServer>
  <handlers>
    <add name="ELMAH" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" preCondition="integratedMode" />
  </handlers>
</system.webServer> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-27T20:57:58.340

Elmah 为 Elmar_error 表中的每个日志条目记录一个应用程序名称。当您浏览 Elmah.axd 时，它使用默认应用程序名称来过滤日志条目。

You can set the applicationName attribute on the errorLog tag in the elmah Web.config section to view the entries.

```
<errorLog type="Elmah.SqlErrorLog" applicationName="AppName" /> 
```

# windows - 如何在windows xp上编写脚本登录和注销

> ID：12112506
> 
> 赞同：1
> 
> 时间：2012-08-24T15:37:57.087
> 
> 标签：windows, powershell, automation, windows-xp, cygwin

我在这个网站和互联网上找到了几篇描述如何注销当前用户的帖子，但我如何才能登录特定用户？

注销（cygwin）可以通过这种方式完成：

```
echo "\n" | powershell -ExecutionPolicy RemoteSigned "(gwmi Win32_OperatingSystem).Win32Shutdown(0)" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:41:27.637

好吧，这是您注销**特定**用户的方式：

```
function getsessionid($username, $server)
{
   query session $username "/SERVER:$server" |?{$_ -match "$userName\s+(\d+)\s"} |%{ $matches[1] }
}

$id = getsessionid john db123.contoso.net
logoff $id /SERVER:db123.contoso.net 
```

要让某人登录**，**似乎更难。看看[这里](https://stackoverflow.com/questions/1493311/windows-vista-7-programmatically-login)和[这里](https://stackoverflow.com/questions/464580/login-to-windows-xp-programatically)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:31:49.743

[您可以使用AutoAdminLogon 功能](http://support.microsoft.com/kb/324737)登录用户。

要以加密而非明文形式存储密码，[请参见此处](http://msdn.microsoft.com/en-us/library/aa378826.aspx)。

配置自动登录后，您需要重新启动计算机才能进行登录。您可以通过使用自定义 GINA 来绕过重新启动的需要，尽管这有点复杂并且不适用于 Vista 或更高版本。

# c# - .NET 4.0 - “SecurityAction.RequestMinimum 已过时”

> ID：12112512
> 
> 赞同：3
> 
> 时间：2012-08-24T15:38:23.743
> 
> 标签：c#, .net, security, .net-4.0, permissions

在我的代码中，我收到了关于这两行的警告：

```
[assembly:SecurityPermissionAttribute(SecurityAction.RequestMinimum, UnmanagedCode=true)]
[assembly:PermissionSetAttribute(SecurityAction.RequestMinimum, Name = "FullTrust")] 
```

这些是警告：

```
S:\Nimrod\src\WinUI\Components\Syncfusion.Grid\AssemblyInfo.cs(38,39): warning CS0618: 'System.Security.Permissions.SecurityAction.RequestMinimum' is obsolete: 'Assembly level declarative security is obsolete and is no longer enforced by the CLR by default. See http://go.microsoft.com/fwlink/?LinkID=155570 for more information.'
S:\Nimrod\src\WinUI\Components\Syncfusion.Grid\AssemblyInfo.cs(39,34): warning CS0618: 'System.Security.Permissions.SecurityAction.RequestMinimum' is obsolete: 'Assembly level declarative security is obsolete and is no longer enforced by the CLR by default. See http://go.microsoft.com/fwlink/?LinkID=155570 for more information.' 
```

我查看了警告消息中提到的链接，但不清楚如何处理迁移过时的方法。[这里](https://stackoverflow.com/questions/11625447/securityaction-requestminimum-is-obsolete-in-net-4-0)的另一个问题表明我应该删除它们，但我对该解决方案持怀疑态度，我相信我应该用一些东西来替换它们，而不仅仅是彻底删除它们。

我应该如何进行？

# c# - 仅从集合中选择唯一值

> ID：12112513
> 
> 赞同：1
> 
> 时间：2012-08-24T15:38:34.360
> 
> 标签：c#, linq

我有一组用户对象，但需要根据用户 ID 返回不同用户的列表。

所以我想知道是否可以根据用户对象的给定属性只选择不同的值？

```
Collection<User> users = serializer.Deserialize<Collection<User>>(userCollection); 
```

用户对象：

```
UserID
UserName 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:42:50.033

使用[morelinq的](http://code.google.com/p/morelinq/) `DistinctBy()`方法。

```
var distinctUsers = users.DistinctBy(user => user.UserID); 
```

或者通过对您想要获得区别的内容进行分组并获取组中的第一项来自行制作查询。

```
var distinctUsers = users.GroupBy(user => user.UserID)
                         .Select(g => g.First()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:39:43.787

这可以通过使用 Hashset 很容易地解决。为此，只需确保您的 User 类具有对 Equals 和 GetHashCode 的覆盖，并且您应该进行设置。

编辑：正如 DavidM 在下面提到的，仅当这是 User 对象的正常比较情况时，才值得为一个类覆盖 equals 和 gethashcode。如果没有，那么可以使用自定义比较器来实例化 Hashset，我建议采用这种方法。

# android - Android Proguard 不内联

> ID：12112514
> 
> 赞同：11
> 
> 时间：2012-08-24T15:38:35.593
> 
> 标签：android, proguard, inlining

我正在使用最新的 Android SDK (4.1)，并尝试导出启用了 Proguard 的签名 jar。但是，在反编译优化后的 APK 后，我注意到我原本期望内联的方法并没有。

我知道 Proguard 运行是因为代码被正确混淆了。所以为了确认这一点，我将此方法添加到我的活动中：

```
private void testInlining()
{
    mConfig = null;
} 
```

这个私有方法在我的活动中只被调用一次，并且因为它是私有的，所以优化器应该很明显它只被调用一次并且应该被内联。

文档说默认情况下启用所有优化，并且 Proguard “短或仅调用一次的内联方法”。

我应该给 Proguard 一个特定的标志来启用内联吗？

***编辑***

我的 proguard 配置文件包含

```
-optimizationpasses 5
-allowaccessmodification
-overloadaggressively
-repackageclasses ''
-dontskipnonpubliclibraryclasses 
```

***编辑***

使用后

```
-whyareyoukeeping class com.templatecompany.templateappname.EntryPointActivity {*;} 
```

我得到了该方法未内联的原因：

```
 [proguard] com.templatecompany.templateappname.EntryPointActivity: void testInlining() (20:21)
 [proguard]   is invoked by    com.templatecompany.templateappname.EntryPointActivity: com.td.media.ivConnection.IvConfig getIvConfig() (14:15)
 [proguard]   implements       com.td.widget.MainActivity: com.td.media.ivConnection.IvConfig getIvConfig()
 [proguard]   is invoked by    com.td.widget.MainActivity: void onCreate(android.os.Bundle) (140:175)
 [proguard]   implements       android.app.Activity: void onCreate(android.os.Bundle)
 [proguard]   is a library method. 
```

但是我不确定该方法`testInlining`在该方法中使用的事实是如何被另一个方法使用的，这一事实如何阻止in`getIvConfig`的内联。`testInlining``getIvConfig`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-25T09:58:13.107

这个最近的 Android SDK 默认禁用所有优化，参见 ${sdk.dir}/tools/proguard/proguard-android.txt：

```
-dontoptimize 
```

替代优化配置仅禁用一些优化，请参阅 ${sdk.dir}/tools/proguard/proguard-android-optimize.txt：

```
-optimizations !code/simplification/arithmetic,!code/simplification/cast,!field/*,!class/merging/* 
```

您可以在 project.properties 中指定您喜欢的配置文件。

您可以通过添加选项来验证 ProGuard 正在使用哪个完整配置`-printconfiguration`。

为了避免旧版本 Dalvik VM 中的错误（！code/simplification/arithmetic，！code/simplification/cast），一些优化已被禁用，并且一些优化可能已被禁用以避免旧版本 ProGuard（！字段/*，！类/合并/*）。

请注意，`-whyareyoukeeping`指的是缩小步骤，它将不必要的类/字段/方法作为一个整体删除。未删除的方法可以在优化步骤中内联（除非用 明确指定`-keep`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-17T20:19:15.343

在您的模块`build.gradle`文件中，您应该查看：

```
buildTypes {
    release {
        minifyEnabled true
        shrinkResources true
        proguardFiles getDefaultProguardFile('proguard-android.txt'), file('proguard-project.txt')
        signingConfig signingConfigs.release
    }
} 
```

并**替换`proguard-android.txt`为`proguard-android-optimize.txt`**，它不包括该`-dontoptimize`行，同时避免 dalvik 问题（请参阅 Eric Lafortune 的回答）。

# ruby - 如何计算变量中整数之间的 Ruby 除法？

> ID：12112531
> 
> 赞同：0
> 
> 时间：2012-08-24T15:40:00.167
> 
> 标签：ruby

我必须整数变量`a`和`b`.

我想计算`a/b`红宝石的百分比，考虑到如果两者都为零，则结果应该为零。

使用文字很容易，我只需要添加`.0`数字：`12.0/17.0`，以及来自其他计算的变量：

```
# a == 12 and b == 17    
  a/b => 0

# a == 0 and b == 0    
  a/b => Infinity 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T15:46:25.133

您可以使用`a.to_f/b`因此将整数转换为浮点数。
您可以做的另一个技巧是类似的`a*1.0/b`，但我认为第一个解决方案更好。
只需`a==0 && b==0`用`if`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:46:45.927

```
p = a.to_f / b
p = 0 if (b == 0) 
```

# wpf - 如何从代码隐藏设置 ValidatesOnDataErrors

> ID：12112533
> 
> 赞同：0
> 
> 时间：2012-08-24T15:40:03.900
> 
> 标签：wpf

在 WPF 中，如何为控件（例如 TextBox）上的绑定设置 ValidatesOnDataErrors 属性？这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:44:49.047

它只是[`Binding`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.aspx)类的属性。您可以在代码中构造绑定，设置属性并[`SetBinding`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.setbinding.aspx)在`TextBox`.

您可以使用[`GetBinding`](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingoperations.getbinding.aspx)来获取现有的绑定，但一旦它们被使用*就不能修改它们......*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:45:30.137

请记住，这`ValidatesOnDataErrors`是绑定的属性，而不是控件的属性。

所以寻找控件的正确绑定（在我的示例中，TextProperty 依赖属性）...

试试这个：

```
System.Windows.Data.BindingExpression binding = this.textBox1.GetBindingExpression(System.Windows.Controls.TextBox.TextProperty);
binding.ParentBinding.ValidatesOnDataErrors = true; 
```

# ruby-on-rails - 删除回形针的链接/按钮 - 路由错误

> ID：12112534
> 
> 赞同：0
> 
> 时间：2012-08-24T15:40:07.770
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip

我认为这个问题最终可能会成为更多的通用帮助，但我在尝试删除回形针项目时遇到了问题。

当我点击我的按钮时，我只是得到 --- No route matches [POST] "/expenses/3" -- 也许这是调用方法的错误方式？

在此先感谢，代码如下。

这是我的查看按钮，我只是复制了我的删除按钮，并将控制器方法更改为新的。

```
 <%= link_to raw('<i class="icon-trash icon-white"> </i>'), 
                          expense_item, method: :destroy_receipt, 
                          data: { confirm: 'Are you sure delete receipt?' }, 
                          class: "btn btn-mini btn-danger" %> 
```

在我的控制器中

```
def destroy_receipt
  @expense = Expense.find(params[:id])
  @expense.receipt.destroy
  redirect_to expense_path
end 
```

我的模型

```
class Expense < ActiveRecord::Base
  attr_accessible :amount, :expense_date, :description, :is_billable, :mileage, 
                                :pay_method, :project_id, :type_id, :on_site, :receipt

    belongs_to :project, foreign_key: :project_id
    belongs_to :expense_type, foreign_key: :type_id

  has_attached_file :receipt, :styles => { :medium => "300x300>", :small => "100x100>" } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:58:17.127

你是对的，这不是正确的方法。

该方法的正确参数：关键是 POST、GET、PUT、DELETE

你会想要这样的东西：

```
link_to 'hi' , '/urlforhi/:id', :method=>:post 
```

然后你必须在 routes.rb 中有一条路线：

```
post '/urlforhi/:id' => 'yourcontroller#hi' 
```

然后在控制器/yourcontroller.rb

```
def hi
  @thing = Thing.find(params[:id])
end 
```

:method 的参数指示使用哪个 HTTP VERB。

请注意，默认方法是 get，所以这也可以：

```
link_to 'hi' , '/urlforhi/:id' 
```

然后你必须在 routes.rb 中有一条路线：

```
get '/urlforhi/:id' => 'yourcontroller#hi' 
```

或更常见的

```
match '/urlforhi/:id' => 'yourcontroller#hi' 
```

# objective-c - 等到 dispatch_async 线程结束

> ID：12112535
> 
> 赞同：0
> 
> 时间：2012-08-24T15:40:21.967
> 
> 标签：objective-c, grand-central-dispatch

我是 Objective C 的新手。我有一个对象，它通过 GCD 创建新线程，并在默认队列中使用 dispatch_async。我在线程中使用带有 timeout = 1sec 的 dispatch_semaphore_wait 来检查何时需要关闭该线程。

当我调用“close”方法时，它会发送 dispatch_semaphore_signal 并关闭线程。但有时线程会在“关闭”方法结束后存活一段时间。我怎么能在我的“关闭”方法中等待线程结束？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:57:27.050

对这样一个问题的典型回答：你想做什么？

我问这个是因为，首先，您不需要知道或关心有一个线程支持 GCD 请求以及它何时退出 - 这完全取决于 GCD 来管理。

其次，您应该始终对使用显式超时的代码持怀疑态度（“永远”除外）。如果你有任何理由问自己“为什么是 1 秒？如果我等待的任何事件花费的时间比这更多或更少会发生什么？” 那么你正在从事导致轮询的那种思维，而轮询对于几乎所有东西来说都是 BAD BAD（邪恶，错误）的设计，除了编写某些类型的设备驱动程序！

一种更合理的方法是在操作结束时使用完成回调来表示它已经完成，采用完全异步的方法进行编程，并在此过程中遵循 GCD 的基本设计原则之一。

在我看来，我只是在这里猜测，您正在采用现有的编程范式或思维方式并错误地将其应用于 GCD。一个可以理解的错误，但仍然是一个错误。

# wso2 - 如何在 wso2 中设置错误消息？

> ID：12112537
> 
> 赞同：1
> 
> 时间：2012-08-24T15:40:31.163
> 
> 标签：wso2, response, wso2esb

我在 wso2 中有一项服务。例如端点是`http://localhost:9000/services/SimpleStockQuoteService`，请求消息是：

```
<m:getQuote xmlns:m="http://services.samples">
    <m:request>
      <m:symbol></m:symbol>
    </m:request>
  </m:getQuote> 
```

如果符号值为空。我不想将此请求发送到端点。我可以使用请求消息作为响应或发送错误消息。我尝试设置属性`RESPONSE=true`，但没有用。如何在 wso2 中做到这一点？有人可以帮助我吗？此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:54:28.283

您可以使用过滤器调解器过滤掉消息。检查示例here[1]如果特定字段为空，则删除消息/执行故障序列，否则允许它..

[1] [http://wso2.org/project/esb/java/4.0.3/docs/mediators/filter.html](http://wso2.org/project/esb/java/4.0.3/docs/mediators/filter.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T09:10:17.460

Use makefault mediator in your fault sequence.. Check the following post

[http://techfeast-hiranya.blogspot.com/2010/04/wso2-esb-tips-tricks-05-error-handling.html](http://techfeast-hiranya.blogspot.com/2010/04/wso2-esb-tips-tricks-05-error-handling.html)

# android - 套接字不会从android中的服务器获取任何数据

> ID：12112539
> 
> 赞同：0
> 
> 时间：2012-08-24T15:40:37.763
> 
> 标签：android, sockets

我想在 android 中实现一个客户端-服务器聊天应用程序。试过这段代码。但它只向服务器发送数据，不会获取任何数据。

应用程序必须连续传输数据。

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    try
    {
        socket = new Socket("192.168.50.11", 2001);

        out = new PrintWriter(socket.getOutputStream());
        reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));

        out.print("hello!");
        out.flush();

    this.reciveThread = new Thread(new reciveClass());
        this.reciveThread.start();
    }
    catch (Exception e)
    {
        Log.d(appTag, e.toString());
    }

}

class reciveClass implements Runnable
{
    public void run()
    {
        try
        {
            String readed;
            while (true)
            {
                try
                {
                    if ((readed = reader.readLine()) != null)
                    {
                        final String read = readed;
                        handler.post(new Runnable()
                        {
                            @Override
                            public void run()
                            {                                    
                                TextView tv = (TextView) findViewById(R.id.messageText);
                                tv.setText(tv.getText() + "\n" + read);
                            }

                        });
                    }
                }
                catch (Exception ee)
                {
                    Log.d(appTag, ee.toString());
                }
                Thread.sleep(100);
            }
        }
        catch (Exception e)
        {
        }
    }
} 
```

问题出在哪里？谢谢。

# asp.net-mvc - mvc c# html.dropdownlist 和 viewbag

> ID：12112541
> 
> 赞同：9
> 
> 时间：2012-08-24T15:40:45.547
> 
> 标签：asp.net-mvc, html.dropdownlistfor, viewbag, html-select

所以我有以下（伪代码）：

```
string selectedvalud = "C";
List<SelectListItem> list= new List<SelectListItem>();
foreach(var item in mymodelinstance.Codes){
  list.Add(new SelectListItem { Text = item.Name, Value = item.Id.Tostring(), Selected = item.Id.ToString() == selectedvalue ? true : false });
}

ViewBag.ListOfCodes = list; 
```

在我看来：

```
<%: Html.DropDownList("Codes", (List<SelectListItem>)ViewBag.ListOfCodes , new { style = "max-width: 600px;" })%> 
```

现在，在它到达视图之前，“列表”已经用项目填充它并标记了已经选择的项目。但是当它到达视图时，没有一个选项被标记为选中。

我的问题是，是否可以使用 viewbag 来传递物品或者我应该使用不同的媒介？因为如果我以这种方式使用它，它会删除选项上的选定标志。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-24T15:45:08.323

试试这样：

```
ViewBag.ListOfCodes = new SelectList(mymodelinstance.Codes, "Id", "Name");
ViewBag.Codes = "C"; 
```

在您看来：

```
<%= Html.DropDownList(
    "Codes", 
    (IEnumerable<SelectListItem>)ViewBag.ListOfCodes, 
    new { style = "max-width: 600px;" }
) %> 
```

为此，您显然必须在您的集合中拥有一个 Id = "C" 的项目，如下所示：

```
 ViewBag.ListOfCodes = new SelectList(new[]
    {
        new { Id = "A", Name = "Code A" },
        new { Id = "B", Name = "Code B" },
        new { Id = "C", Name = "Code C" },
    }, "Id", "Name"); 
```

# file-io - 将输出写入 Graphchi 中的文件

> ID：12112543
> 
> 赞同：1
> 
> 时间：2012-08-24T15:40:48.953
> 
> 标签：file-io, graph, graphchi

我在 Graphchi 中编写了一个最短路径代码，我想将它的输出打印到一个文件中。我试图使用示例中显示的模板，但如果我使用与其他示例相同的方式写入文件，则会出错。我被困在这里了。作为我只想打印的输出（顶点ID，它与源的最小距离）。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T20:54:50.253

这是如何将所有顶点的值输出到控制台的示例。修改它以将输出写入文件很容易。请注意，如果您可以处理二进制文件，则 GraphChi 已经在文件中具有顶点值：.B.vout，其中 sizeof(VertexDataType)。

1）您需要定义一个回调函数，它将顶点id和值作为参数

```
class OutputVertexCallback : public VCallback<VertexDataType> {
public:

virtual void callback(vid_t vertex_id, VertexDataType &value) {
  std::cout << vertex_id << "=" << value << std::endl;
}
 }; 
```

2）然后您需要按如下方式调用foreach_vertices（）以获取输出：

```
OutputVertexCallback callback;
foreach_vertices<VertexDataType>(filename, 0, engine.num_vertices(), callback); 
```

# php - 在 PHP 中按字母顺序对 HTML 列表进行排序

> ID：12112544
> 
> 赞同：1
> 
> 时间：2012-08-24T15:40:49.330
> 
> 标签：php, html, html-lists

我有一个网站，其中包含许多办公室先例的手册。当用户使用 HTML 上传脚本时，它将先例上传到服务器上的文件夹。我使用以下脚本列出该特定文件夹中的所有文件。

```
<?php  //define the path as relative
  $dir = "./OFFICE PRECEDENTS/Business & Corporate Law"; 
  $webpath ="";  //using the opendir function  
  echo "<ol>";    
  // Open a known directory, and proceed to read its contents   
  if ($dh = opendir($dir)) {     
  while (($file = readdir($dh)) !== false) {   
  if (is_dir($dir.'/'.$file)){}      
  else if ($file == '.'){}      
  else if ($file == '..'){} 
  else if ($file == 'index.php'){}     
  else {      
  echo "<li><a href='https://manual.malicki-law.ca/$dir/$file'>$file</a></li>\n";      
  }    
  }       
  closedir($dh);     
  } 
  echo "</ol>";     
  ?> 
```

如何实现按字母顺序对列表进行排序的系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:46:15.023

我相信这应该可以帮助您：

natcasesort：[http ://www.php.net/manual/en/function.natcasesort.php](http://www.php.net/manual/en/function.natcasesort.php)

usort：[http](http://www.php.net/manual/en/function.usort.php) ://www.php.net/manual/en/function.usort.php带有一个比较器函数，用于比较 strtolower(a) 和 strtolower(b)

您需要先创建一个数组。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:49:04.707

对于您的特定情况：如果您使用`scandir()`而不是`readdir()`，则默认顺序已经按字母顺序排列。

[http://php.net/manual/en/function.scandir.php](http://php.net/manual/en/function.scandir.php)

第二个参数是：

> **sort_order**
> 默认情况下，排序顺序是按字母升序排列的。如果可选的排序顺序设置为 SCANDIR_SORT_DESCENDING，那么排序顺序是按字母降序排列的。如果它设置为 SCANDIR_SORT_NONE 则结果未排序。

所以而不是：

```
 if ($dh = opendir($dir)) {     
   while (($file = readdir($dh)) !== false) {   
       // your code   
    }    
  }       
  closedir($dh); 
```

只需使用类似的东西：

```
if ($files = scandir($dir))
{
    foreach ($files as $file) {
       // your code
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:43:43.683

将其保存到一个数组中，然后使用字母数字键代替数字键。然后您应该能够对键使用排序功能，并且您的值会更改为正确的顺序。然后只需遍历数组并再次回显它们。

有关排序数组的更多信息：http: [//php.net/manual/en/array.sorting.php](http://php.net/manual/en/array.sorting.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:47:14.203

```
<?php
$my_array = array("a" => "Dog", "b" => "Cat", "c" => "Horse");

sort($my_array);
print_r($my_array);
?> 
```

或者您可以使用：asort、rsort、arsort

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T15:51:41.493

有很多方法可以做到这一点，[glob()](http://php.net/manual/en/function.glob.php)也很好，那么你不必担心目录。

```
<?php 

$dir = "./OFFICE PRECEDENTS/Business & Corporate Law/";

$files = glob($dir."*.*");
sort($files);//Sort the array

echo "<ol>";
foreach($files as $file){
    if($file == $dir.'index.php'){continue;}
    $file = basename($file);
    echo "\t<li><a href='https://manual.malicki-law.ca/$dir/$file'>$file</a></li>\n";
}
echo "</ol>";
?> 
```

# php - 在 Cakephp 中与 HABTM 混淆

> ID：12112549
> 
> 赞同：0
> 
> 时间：2012-08-24T15:41:08.467
> 
> 标签：php, cakephp-2.0, cakephp-model

我有3个表结构...

**歌曲**（id，状态）

**曲目列表**（id、song_id、artist_id、状态）

**艺术家**（身份，身份）

我希望有 HABTM，所以我提到了.. Song MODEL

```
var $hasAndBelongsToMany = array(
    'Artist' => array(
        'className' => 'Artist',
        'joinTable' => 'tracklists',
        'foreignKey' => 'song_id',
        'associationForeignKey' => 'artist_id',
        'conditions' => array('tracklist.status' => '1')
    'with' => 'Tracklist',
    //'unique' => true
    ),
); 
```

艺术家模特

```
 var $hasAndBelongsToMany = array(
    'Song' => array(
        'className' => 'Song',
        'joinTable' => 'tracklists',
        'foreignKey' => 'artist_id',
        'associationForeignKey' => 'song_id',
        'with' => 'Tracklist',
        //'unique' => true
    ),
); 
```

曲目列表模型 var $belongsTo = array(

```
 'Song' => array(
        'className' => 'Song',
        'foreignKey' => 'song_id',
        'dependent' => true
    ),
    'Artist' => array(
        'className' => 'Artist',
        'foreignKey' => 'artist_id',
        'dependent' => true
    )
); 
```

这种方式但问题是当我试图从 Artist 表中查找记录时，它会毫无条件地找到所有记录。

```
 $artist_conditions = array('Artist.status' => '1');
    $artist_list = $this->Song->Artist->find('list', array('conditions' => $artist_conditions )); 
```

我希望只获取与 tracklist 相关且 tracklist.status 为的艺术家`1`。关系对吗？？或者我只是将 hasMany 与（歌曲，艺术家）一起使用，将 BelongsTo 与（曲目列表）一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T20:49:58.287

你可以试试这个：

```
/* for example in songs controller */
    public $uses = array('Song','Tracklist');
    $artist_conditions = array('Artist.status' => '1');
    $this->Tracklist->recursive = 1;
    $artist_list = $this->Tracklist->find('list', array('conditions' => $artist_conditions )); 
```

# c# - Nhibernate：更新 POCO，坚持，收集孩子？

> ID：12112553
> 
> 赞同：0
> 
> 时间：2012-08-24T15:41:24.427
> 
> 标签：c#, hibernate, nhibernate

我仍然对一些 NHibernate 条款有困难，所以请多多包涵。

我正在基于网络提交构建一个 POCO 类。Web 用户将更改一些标量属性。POCO 将已保存在数据库中。我想将 POCO 的更改保存到数据库，收集子对象（应该保持不变）并返回 POCO 的图表，以便我可以将反馈发送回用户。

这样做的正确方法是什么？这是“分离”吗？连接子集合的适当方法是什么？可以在一个数据库批次中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T19:34:32.890

1.  持久化对象的更改很容易使用`Session.Update()`.
2.  检索子集合要么隐式完成（通过访问导致 nHibernate 从数据库获取它的集合属性），要么显式地使用该`Fetch()`方法。
    例如 - `var users = QueryOver<User>().Where(u => u.Age > 18).Fetch(u => u.Children).Eager`。

一般来说，对于一个网络应用程序，我建议阅读一些关于“每个请求的会话”模式的内容。（[这个例子](http://nhforge.org/blogs/nhibernate/archive/2011/03/03/effective-nhibernate-session-management-for-web-apps.aspx)对我来说有点矫枉过正，但它很好地解释了这个概念）。
也不要忘记[总是使用 transactions](http://nhprof.com/Learn/Alerts/DoNotUseImplicitTransactions)。

# c++ - 为什么我的程序不发送 ARP 请求（c++）？

> ID：12112554
> 
> 赞同：2
> 
> 时间：2012-08-24T15:41:27.513
> 
> 标签：c++, linux, arp, raw-sockets

我正在用 c++ 学习低级套接字。我做了一个简单的程序来发送一个 ARP 请求。套接字似乎发送了数据包，但我无法用 Wireshark 捕获它。我有另一个小程序，它也发送 ARP 数据包，这些数据包被 Wireshark 捕获（我下面的程序受到该程序的启发）。

我做错了什么吗？

*删除代码*

**编辑**

*删除代码*

**编辑 2**
似乎我还需要在数据包中包含以太网头数据，所以我现在制作一个包含以太网头和 ARP 头数据的数据包。现在数据包消失并被 Wireshark 捕获。但 Wireshark 说这是免费的。如您所见，发送方和接收方的 IP 或 MAC 地址似乎都没有正确设置。

```
36  13.318179   Cimsys_33:44:55 Broadcast   ARP 42  Gratuitous ARP for <No address> (Request) 
```

**编辑 3**

```
 /*Fill arp header data*/
    p.arp.ea_hdr.ar_hrd = htons(ARPHRD_ETHER); 
    p.arp.ea_hdr.ar_pro = htons(ETH_P_IP); 
    p.arp.ea_hdr.ar_hln = ETH_ALEN;            // Must be pure INTEGER, not called with htons(), as I did
    p.arp.ea_hdr.ar_pln = 4;                   // Must be pure INTEGER, not called with htons(), as I did
    p.arp.ea_hdr.ar_op = htons(ETH_P_ARP); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:07:39.137

这段代码看起来不太对：

```
struct in_addr *s_in_addr = (in_addr*)malloc(sizeof(struct in_addr));
struct in_addr *t_in_addr = (in_addr*)malloc(sizeof(struct in_addr));

s_in_addr->s_addr = inet_addr("192.168.1.5");  // source ip
t_in_addr->s_addr = inet_addr("192.168.1.6");  // target ip

memcpy(arp->arp_spa, &s_in_addr, 6);
memcpy(arp->arp_tpa, &t_in_addr, 6); 
```

在`memcpy`You care 中复制 6 个字节。但是，您正在获取指针类型的地址，这使其成为指向指针类型的指针。我认为您的意思是传入`s_in_addr`and `t_in_addr`。

**编辑：** Alan Curry 指出，您正在从只有 4 个字节长的对象之间复制 6 个字节。

但是，动态分配似乎对您的代码没有任何好处，您应该从堆栈中创建`s_in_addr`and变量。`t_in_addr`比，您不需要更改您的`memcpy`代码。

```
struct in_addr s_in_addr;
struct in_addr t_in_addr;

s_in_addr.s_addr = inet_addr("192.168.1.5");  // source ip
t_in_addr.s_addr = inet_addr("192.168.1.6");  // target ip

memcpy(arp->arp_spa, &s_in_addr, sizeof(arg->arp_spa));
memcpy(arp->arp_tpa, &t_in_addr, sizeof(arg->arg_tpa)); 
```

`arp`您的数据包本身也存在类似问题。所以你应该把它从堆栈中分配出去。为了防止自己进行大量代码更改，我将稍微不同地说明一下：

```
struct ether_arp arp_packet;
struct ether_arp *arp = &arp_packet;
//...
for(int i = 0; i < 10; i++) {
    if (sendto(sock, arp, sizeof(arp_packet), 0,
               (struct sockaddr *)&sending_socket,
               sizeof(sending_socket)) < 0) { 
        std::cout << "Could not send!" << std::endl; 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T06:02:20.457

@user315052 说你应该使用`memcpy(arp->arp_spa, &s_in_addr, sizeof(arg->arp_spa));`，但是这段代码只是将前 4 个字节复制`s_in_addr`到那`arp->arp_spa`绝对什么都不做！所以试试这个：

```
* (int32_t*) arp->arp_spa = inet_addr("192.168.1.1")
* (int32_t*) arp->arp_tpa = inet_addr("192.168.1.2") 
```

# bash - 在 bash 脚本中导出环境变量 - 它不起作用

> ID：12112556
> 
> 赞同：0
> 
> 时间：2012-08-24T15:41:30.237
> 
> 标签：bash, shell, command

我写了一个小 bash 脚本来导出环境变量：

```
#!/bin/bash

echo "Pass a path:"
read path
echo $path

defaultPath = /home/katie/Desktop

if [ -n "$path" ]; then
    echo "Path is empty! Exporting default path ..."
    export my_var=$defaultPath
else
    export my_var=$path
fi 
```

但我得到了错误：

> 默认路径：找不到命令

如何解决？

**工作版本：**

```
#!/bin/bash

echo "Pass a path:"
read path
echo $path

defaultPath=/home/user/Desktop

if [ -n "$path" ]; then
    export my_var=$path
else
    echo "Path is empty! Exporting default path ..."
    export my_var=$defaultPath
fi 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T15:43:25.580

变量赋值中的 = 周围不允许有空格：

```
defaultPath=/home/katie/Desktop 
```

使用空格，该行被解释为一个简单的命令，它尝试执行`defaultPath`带有两个参数的命令，`=`并且`/home/katie/Desktop`.

# r - 以 libsvm 格式读取/写入数据

> ID：12112558
> 
> 赞同：16
> 
> 时间：2012-08-24T15:41:32.070
> 
> 标签：r, libsvm

我如何读/写[`libsvm`](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)数据到/从`R`？

`libsvm`格式是稀疏数据，如

```
<class/target>[ <attribute number>:<attribute value>]* 
```

（参见[压缩行存储（CRS）](http://netlib.org/linalg/html_templates/node91.html)）例如，

```
1 10:3.4 123:0.5 34567:0.231
0.2 22:1 456:03 
```

我确信我可以自己鞭打一些东西，但我更愿意使用现成的东西。但是，`R`库[`foreign`](https://cran.r-project.org/web/packages/foreign/)似乎没有提供必要的功能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-24T20:36:40.477

# [`e1071`](https://cran.r-project.org/web/packages/e1071/)已下架：

```
install.packages("e1071")
library(e1071)
read.matrix.csr(...)
write.matrix.csr(...) 
```

***注意****：它是在 中实现的`R`，而不是在 中实现的`C`，所以它是**dog-slow**。*

它甚至有一个特殊的小插图[支持向量机——包 e1071 中的 libsvm 接口](https://cran.r-project.org/web/packages/e1071/vignettes/svmdoc.pdf)。

# [`r.vw`](https://github.com/JohnLangford/vowpal_wabbit/tree/master/R/r.vw)与[`vowpal_wabbit`](https://github.com/JohnLangford/vowpal_wabbit)

***注意****：它是在 中实现的`R`，而不是在 中实现的`C`，所以它是**dog-slow**。*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-25T08:09:03.313

我已经使用 zygmuntz 解决方案在具有 25k 观察（行）的数据集上运行了将近 5 个小时的工作。它已经完成了 3k 行。在此期间我花了很长时间编写了这个代码（基于 zygmuntz 的代码）：

```
require(Matrix)
read.libsvm = function( filename ) {
  content = readLines( filename )
  num_lines = length( content )
  tomakemat = cbind(1:num_lines, -1, substr(content,1,1))

  # loop over lines
  makemat = rbind(tomakemat,
  do.call(rbind, 
    lapply(1:num_lines, function(i){
       # split by spaces, remove lines
           line = as.vector( strsplit( content[i], ' ' )[[1]])
           cbind(i, t(simplify2array(strsplit(line[-1],
                          ':'))))   
})))
class(makemat) = "numeric"

#browser()
yx = sparseMatrix(i = makemat[,1], 
              j = makemat[,2]+2, 
          x = makemat[,3])
return( yx )
} 
```

这在同一台机器上运行了几分钟（zygmuntz 解决方案也可能存在内存问题，不确定）。希望这可以帮助任何有同样问题的人。

请记住，如果您需要在 R 中进行大量计算，请使用 VECTORIZE！

编辑：修复了我今天早上发现的索引错误。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-12-19T03:59:30.517

我利用一些实用程序提出了自己的*临时解决方案，*`data.table`

它几乎很快就在我找到的测试数据集（[波士顿住房数据](http://archive.ics.uci.edu/ml/datasets/Housing)）上运行。

将其转换为`data.table`（与解决方案正交，但在此处添加以便于重现）：

```
library(data.table)
x = fread("/media/data_drive/housing.data.fw",
          sep = "\n", header = FALSE)
#usually fixed-width conversion is harder, but everything here is numeric
columns =  c("CRIM", "ZN", "INDUS", "CHAS",
             "NOX", "RM", "AGE", "DIS", "RAD", 
             "TAX", "PTRATIO", "B", "LSTAT", "MEDV")
DT = with(x, fread(paste(gsub("\\s+", "\t", V1), collapse = "\n"),
                   header = FALSE, sep = "\t",
                   col.names = columns)) 
```

这里是：

```
DT[ , fwrite(as.data.table(paste0(
  MEDV, " | ", sapply(transpose(lapply(
    names(.SD), function(jj)
      paste0(jj, ":", get(jj)))),
    paste, collapse = " "))), 
  "/path/to/output", col.names = FALSE, quote = FALSE),
  .SDcols = !"MEDV"]
#what gets sent to as.data.table:
#[1] "24 | CRIM:0.00632 ZN:18 INDUS:2.31 CHAS:0 NOX:0.538 RM:6.575 
#  AGE:65.2 DIS:4.09 RAD:1 TAX:296 PTRATIO:15.3 B:396.9 LSTAT:4.98 MEDV:24"      
#[2] "21.6 | CRIM:0.02731 ZN:0 INDUS:7.07 CHAS:0 NOX:0.469 RM:6.421 
#  AGE:78.9 DIS:4.9671 RAD:2 TAX:242 PTRATIO:17.8 B:396.9 LSTAT:9.14 MEDV:21.6"
# ... 
```

*可能*有一种更好的方法可以让`fwrite`than理解这一点`as.data.table`，但我想不出一个（[直到`setDT`对向量起作用](https://github.com/Rdatatable/data.table/issues/1244)）。

我复制了这个以测试它在更大数据集上的性能（只是炸毁当前数据集）：

```
DT2 = rbindlist(replicate(1000, DT, simplify = FALSE)) 
```

与此处报告的某些时间相比，该操作非常快（我还没有直接比较）：

```
system.time(.)
#    user  system elapsed 
#   8.392   0.000   8.385 
```

我也测试了使用`writeLines`而不是`fwrite`，但后者更好。

* * *

我再看一遍，发现可能需要一段时间才能弄清楚发生了什么。也许`magrittr`-piped 版本会更容易理解：

```
DT[ , 
    #1) prepend each column's values with the column name
    lapply(names(.SD), function(jj)
      paste0(jj, ":", get(jj))) %>%
      #2) transpose this list (using data.table's fast tool)
      #   (was column-wise, now row-wise)
      #3) concatenate columns, separated by " "
      transpose %>% sapply(paste, collapse = " ") %>%
      #4) prepend each row with the target value
      #   (with Vowpal Wabbit in mind, separate with a pipe)
      paste0(MEDV, " | ", .) %>%
      #5) convert this to a data.table to use fwrite
      as.data.table %>%
      #6) fwrite it; exclude nonsense column name,
      #   and force quotes off
      fwrite("/path/to/data", 
             col.names = FALSE, quote = FALSE),
  .SDcols = !"MEDV"] 
```

* * *

读取此类文件要容易得多**

```
#quickly read data; don't split within lines
x = fread("/path/to/data", sep = "\n", header = FALSE)

#tstrsplit is transpose(strsplit(.))
dt1 = x[ , tstrsplit(V1, split = "[| :]+")]

#even columns have variable names
nms = c("target_name", 
        unlist(dt1[1L, seq(2L, ncol(dt1), by = 2L), 
                   with = FALSE]))

#odd columns have values
DT = dt1[ , seq(1L, ncol(dt1), by = 2L), with = FALSE]
#add meaningful names
setnames(DT, nms) 
```

**这*不适*用于“参差不齐”/稀疏的输入数据。我认为没有办法将其扩展到在这种情况下工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-25T01:08:19.897

基于一些评论。我将其添加为 aswer，以便其他人更容易使用。这是以l​​ibsvm格式写入数据。

将 data.frame 写入 svm light 格式的函数。我添加了一个 train={TRUE, FALSE} 参数，以防数据没有标签。在这种情况下，类索引被忽略。

```
write.libsvm = function(data, filename= "out.dat", class = 1, train=TRUE) {
  out = file(filename)
  if(train){
    writeLines(apply(data, 1, function(X) {
      paste(X[class], 
            apply(cbind(which(X!=0)[-class], 
                        X[which(X!=0)[-class]]), 
                  1, paste, collapse=":"), 
            collapse=" ") 
      }), out)
  } else {
    # leaves 1 as default for the new data without predictions. 
    writeLines(apply(data, 1, function(X) {
      paste('1',
            apply(cbind(which(X!=0), X[which(X!=0)]), 1, paste, collapse=":"), 
            collapse=" ") 
      }), out)
  }
  close(out) 
} 
```

** 编辑 **

### 另一种选择 - 如果您已经拥有 data.table 对象中的数据

### libfm 和 SVMlight 具有相同的格式，所以这个函数应该可以工作。

```
library(data.table)

data.table.fm <- function (data = X, fileName = "../out.fm", target = "y_train", 
    train = TRUE) {
    if (train) {
        if (is.logical(data[[target]]) | sum(levels(factor(data[[target]])) == 
            levels(factor(c(0, 1)))) == 2) {
            data[[target]][data[[target]] == TRUE] = 1
            data[[target]][data[[target]] == FALSE] = -1
        }
    }
    specChar = "\\(|\\)|\\||\\:"
    specCharSpace = "\\(|\\)|\\||\\:| "
    parsingNames <- function(x) {
        ret = c()
        for (el in x) ret = append(ret, gsub(specCharSpace, "_", 
            el))
        ret
    }
    parsingVar <- function(x, keepSpace, hard_parse) {
        if (!keepSpace) 
            spch = specCharSpace
        else spch = specChar
        if (hard_parse) 
            gsub("(^_( *|_*)+)|(^_$)|(( *|_*)+_$)|( +_+ +)", 
                " ", gsub(specChar, "_", gsub("(^ +)|( +$)", 
                  "", x)))
        else gsub(spch, "_", x)
    }
    setnames(data, names(data), parsingNames(names(data)))
    target = parsingNames(target)
    format_vw <- function(column, formater) {
        ifelse(as.logical(column), sprintf(formater, j, column), 
            "")
    }
    all_vars = names(data)[!names(data) %in% target]
    cat("Reordering data.table if class isn't first\n")
    target_inx = which(names(data) %in% target)
    rest_inx = which(!names(data) %in% target)
    cat("Adding Variable names to data.table\n")
    for (j in rest_inx) {
        column = data[[j]]
        formater = "%s:%f"
        set(data, i = NULL, j = j, value = format_vw(column, 
            formater))
        cat(sprintf("Fixing %s\n", j))
    }
    data = data[, c(target_inx, rest_inx), with = FALSE]
    drop_extra_space <- function(x) {
        gsub(" {1,}", " ", x)
    }
    cat("Pasting data - Removing extra spaces\n")
    data = apply(data, 1, function(x) drop_extra_space(paste(x, 
        collapse = " ")))
    cat("Writing to disk\n")
    write.table(data, file = fileName, sep = " ", row.names = FALSE, 
        col.names = FALSE, quote = FALSE)
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-22T19:14:04.543

试试这些函数和例子：

[https://github.com/zygmuntz/r-libsvm-format-read-write](https://github.com/zygmuntz/r-libsvm-format-read-write)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-11T19:58:24.673

我采用了两跳解决方案——先将 R 数据转换为另一种格式，然后再转换为 LIBSVM：

1.  使用 R 包外来将数据帧转换（并写出）为 ARFF 格式（修改 write.arff 将 write.table 更改为 na="0.0" 而不是 na="?" 否则步骤 2 失败）
2.  使用[https://github.com/dat/svm-tools/blob/master/arff2svm.py](https://github.com/dat/svm-tools/blob/master/arff2svm.py)将 ARFF 格式转换为 LIBSVM

我的数据集是 200K x 500，这只需要 3-5 分钟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-31T13:29:49.857

这个问题是很久以前提出的，有几个答案。大多数答案对我不起作用，因为我的数据格式很长，而且我不能在 R 中一次性对其进行编码。所以这是我的看法。我编写了一个函数来对数据进行一次热编码，并保存它，而无需先将矩阵转换为稀疏矩阵。

RCPP代码：

```
// [[Rcpp::depends(RcppArmadillo)]]
#include <RcppArmadillo.h>
#include <Rcpp.h>
#include <iostream>
#include <fstream>
#include <string>
using namespace Rcpp;

// Reading data frame from R and saving it as an libFM file

// [[Rcpp::export]] 
std::string createNumber(int x, double y) {
  std::string s1 = std::to_string(x); 
  std::string s2 = std::to_string(y); 
  std::string X_elem = s1 + ":" + s2; 
  return X_elem;
}

// [[Rcpp::export]]
std::string createRowLibFM(arma::rowvec row_to_fm, arma::vec factor_levels, arma::vec position) {
  int n = factor_levels.n_elem; 
  std::string total =  std::to_string(row_to_fm[0]); 
  for (int i = 1; i < n; i++) { 
    if (factor_levels[i] > 1) { 
      total = total + " " + createNumber(position[i - 1] + row_to_fm[i], 1);
    } 
    if (factor_levels[i] == 1) {
      total = total + " " + createNumber(position[i], row_to_fm[i]);
    }
  }
  return total; 
}

// [[Rcpp::export]]
void writeFile(std::string file, arma::mat all_data, arma::vec factor_levels) {
  int n = all_data.n_rows;
  arma::vec position = arma::cumsum(factor_levels);
  std::ofstream temp_file;
  temp_file.open (file.c_str());
  for (int i = 0; i < n; i++) {
    std::string temp_row = createRowLibFM(all_data.row(i), factor_levels, position);
    temp_file << temp_row + "\n";
  }
  temp_file.close();
} 
```

R函数充当它的包装器：

```
writeFileFM <- function(temp.data, path = 'test.txt') { 
  ### Dealing with y function 
  if (!(any(colnames(temp.data) %in% 'y'))) { 
    stop('No y column is given')  
  } else { 
    temp.data <- temp.data %>% select(y, everything()) ## y is required to be first column for writeFile 
  }
  ### Dealing with factors/strings 
  temp.classes <- sapply(temp.data, class) 
  class.num    <- rep(0, length(temp.classes))
  map.list     <- list()
  for (i in 2:length(temp.classes)) { ### since y is always the first column 
    if (any(temp.classes[i] %in% c('factor', 'character'))) {
      temp.col         <- as.factor(temp.data[ ,i]) ### incase it is character 
      temp.unique      <- levels(temp.col)
      factors.new      <- seq(0, length(temp.unique) - 1, 1)
      levels(temp.col) <- factors.new 
      temp.data[ ,i]   <- temp.col
      ### Saving changes 
      class.num[i]  <- length(temp.unique)
      map.list[[i - 1]] <- data.frame('original.value'  = temp.unique, 
                                      'transform.value' = factors.new)
    } else { 
      class.num[i]  <- 1  ### Numeric values require only 1 column 
    }
  }
  ### Writing file 
  print('Writing file to disc')
  writeFile(all_data = sapply(temp.data, as.numeric), file = path, factor_levels = class.num)
  return(map.list) 
} 
```

将其与虚假数据进行比较。

```
### Creating data to save 
set.seed(999)
n <- 10000 
factor.lvl1 <- 3
factor.lvl2 <- 2 
temp.data <- data.frame('x1' = sample(stri_rand_strings(factor.lvl1, 7), n, replace = TRUE),
                        'x2' = sample(stri_rand_strings(factor.lvl2, 4), n, replace = TRUE), 
                        'x3' = rnorm(n), 
                        'x4' = rnorm(n),
                        'y'  = rnorm(n))

### Comparing to other method 
library(data.table)
library(e1071)

microbenchmark::microbenchmark(
  temp.data.table <- model.matrix( ~ 0 + x1 + x2 + x3 + x4, data = temp.data,
                                   contrasts = list(x2 = contrasts(temp.data$x2, contrasts = FALSE))),
  write.matrix.csr(temp.data.table, 'out.txt'), 
  writeFileFM(temp.data)) 
```

结果。

```
 min       lq       mean    median        uq
   1.3061   1.6725   1.890942   1.92475   2.07725
 629.9863 653.4345 676.108548 672.52510 687.88330
 270.8217 275.1353 283.537898 281.42100 289.39160
      max neval cld
   3.2328   100 a  
 793.7040   100   c
 328.0863   100  b 
```

它比 e1071 选项更快，虽然该选项在增加观察次数时失败，但建议的方法仍然适用。

# java - Json 使用 Jackson 库序列化 JDK 动态代理

> ID：12112564
> 
> 赞同：6
> 
> 时间：2012-08-24T15:41:41.053
> 
> 标签：java, json, jackson, dynamic-proxy

我正在尝试使用 Jackson 库序列化 Java 动态代理，但出现此错误：

```
public interface IPlanet {
String getName();
}

Planet implements IPlanet {
    private String name;
    public String getName(){return name;}
    public String setName(String iName){name = iName;}
}

IPlanet ip = ObjectsUtil.getProxy(IPlanet.class, p);
ObjectMapper mapper = new ObjectMapper();
mapper.writeValueAsString(ip);

//The proxy generation utility is implemented in this way:
/**
 * Create new proxy object that give the access only to the method of the specified
 * interface.
 * 
 * @param type
 * @param obj
 * @return
 */
public static <T> T getProxy(Class<T> type, Object obj) {
    class ProxyUtil implements InvocationHandler {
        Object obj;
        public ProxyUtil(Object o) {
            obj = o;
        }
        @Override
        public Object invoke(Object proxy, Method m, Object[] args) throws Throwable {
            Object result = null;
            result = m.invoke(obj, args);
            return result;
        }
    }
    // TODO: The suppress warning is needed cause JDK class java.lang.reflect.Proxy
    // needs generics
    @SuppressWarnings("unchecked")
    T proxy = (T) Proxy.newProxyInstance(type.getClassLoader(), new Class[] { type },
            new ProxyUtil(obj));
    return proxy;
} 
```

我得到这个例外：

```
Exception in thread "main" com.fasterxml.jackson.databind.JsonMappingException: No serializer found for class $Proxy11 and no properties discovered to create BeanSerializer (to avoid exception, disable SerializationConfig.SerializationFeature.FAIL_ON_EMPTY_BEANS) ) 
```

序列化休眠代理对象时发生的问题似乎相同，但我不知道如何以及是否可以使用 Jackson-hibernate-module 来解决我的问题。

**更新**：从 Jackson 2.0.6 版本解决了这个错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:19:29.047

您可以尝试 Genson 库[http://code.google.com/p/genson/](http://code.google.com/p/genson/)。我刚刚用它测试了你的代码，它工作正常输出是 {"name":"foo"}

```
Planet p = new Planet();
p.setName("foo");
IPlanet ip = getProxy(IPlanet.class, p);
Genson genson = new Genson();
System.out.println(genson.serialize(ip)); 
```

它具有其他库中不存在的一些不错的功能。例如在没有任何注释的情况下使用带有参数的构造函数或在运行时在对象上应用所谓的 BeanView（充当模型的视图），可以反序列化为具体类型，等等……看看 wiki [http:/ /code.google.com/p/genson/wiki/GettingStarted](http://code.google.com/p/genson/wiki/GettingStarted)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T18:57:39.557

这可能是 Jackson 中的一个错误——代理类可能被明确禁止被视为 bean。你可以提交一个错误——如果 Genson 可以处理它，Jackson 也应该。:-)

# ruby-on-rails - 带轮胎的 ElasticSearch 与“字符串”搜索中的 nGram 不匹配，仅匹配“文本”

> ID：12112568
> 
> 赞同：1
> 
> 时间：2012-08-24T15:42:11.337
> 
> 标签：ruby-on-rails, elasticsearch, tire, n-gram

所以我一直在尝试将 nGram 匹配添加到我的 ElasticSearch 索引中，但我遇到了以下问题。

执行标准**字符串**查询仅返回完全匹配。在特定*测试*字段上运行**匹配**查询会产生预期的 nGram 匹配。

 *我根据[这些（1）](http://highgroove.com/articles/2012/06/08/getting-fancy-with-elasticsearch.html) [示例（2）](http://mnylen.tumblr.com/post/22963609412/elasticsearch-and-a-simple-contains-search)为我的字段设置了 nGram 过滤器和分析器。映射代码如下：

```
tire.settings :number_of_shards => 1,
      :number_of_replicas => 1,
      :analysis => {
        :analyzer => {
          "str_search_analyzer" => {
            "tokenizer" => "keyword",
            "filter" => "lowercase"
          },
          "str_index_analyzer" => {
            "tokenizer" => "keyword",
            "filter" => ["lowercase","substring"]
          }
        },
        :filter => {
          :substring => {
            "type" => "nGram",
            "min_gram" => 1,
            "max_gram" => 10
          }
        }
      } do
      mapping do
        indexes :test, :type=>'string',
                :search_analyzer => :str_search_analyzer,
                :index_analyzer=>:str_index_analyzer
      end
    end

  def to_indexed_json
    #adding known word plus random string for testing
    { 
      :test => "pizza" + (0...10).map{ ('a'..'z').to_a[rand(26)] }.join
    }.to_json
  end 
```

**弹性搜索查询**

产生结果的查询：

```
curl -X GET "http://localhost:9200/users/_search?pretty=true" -d '{"query":{"text":{"test":{"query":"piz"}}}}' 
```

产生 NO 结果的查询：

```
curl -X GET "http://localhost:9200/users/_search?pretty=true" -d '{"query":{"query_string":{"query":"pizz"}}}' 
```

有没有办法让一般的 query_string 搜索来查看所有索引字段并匹配 ngram，而不必对特定列进行文本/匹配搜索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T19:09:17.453

这是预期的行为。默认情况下，“query_string”查询在“_all”字段上执行。并且由于该字段是使用 StandardAnalyzer 索引的，因此它的索引标记将不同于“测试”字段（您配置为使用 nGram 分析器）的索引标记。

您可以通过多种方式更改此行为：

1.  更改索引设置中的映射并为“_all”字段配置 nGram 分析器
2.  发送和“_analyzer”字段作为文档的一部分（它将被拾取并用于所有没有为其配置显式分析器的字段）
3.  使用“fields”属性指定您希望在哪些字段上执行“query_string”

从以上所有三个选项中，最推荐#3。显式指定字段可以让您更好地控制数据（如何索引和查询数据）。*

# javascript - 我应该在优化的 javascript 构建中嵌入第三方 javascript 库吗？

> ID：12112570
> 
> 赞同：3
> 
> 时间：2012-08-24T15:42:17.450
> 
> 标签：javascript, requirejs

我正在使用出色的[requirejs](http://requirejs.org/)优化器来压缩 Web 应用程序的代码。

该应用程序使用了大量第三方库。我有几个选择：

*   让用户从我的服务器单独下载所有第三方库
*   让用户从 CDN 下载所有第三方库（如果可用）
*   用户 requirejs 在单个文件中生成所有这些库的“压缩”版本

现在，我知道缓存和/或 CDN 将有助于获取每个单独的库需要多长时间，但是如果我有 15 个库，我仍然会收到 15 个 http 请求；如果我的应用程序的实际代码最终在一个或两个相对较小的文件中提供，那就更烦人了。

那么每种方法的优缺点是什么？另外，我想如果我要将库捆绑在我的应用程序中（而不是指向 CDN？），我实际上会“重新分发”（在普通 FOOS 许可证的意义上）

欢迎任何经验/想法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:46:12.960

你可以看看[为什么我应该使用谷歌的 CDN 来处理 jQuery？](https://stackoverflow.com/questions/2180391/why-should-i-use-googles-cdn-for-jquery)问题，为什么 CDN 是更好的解决方案。

> 它增加了可用的并行度。（大多数浏览器一次只能从任何给定站点下载 3 或 4 个文件。）
> 
> 它增加了缓存命中的机会。（随着越来越多的网站遵循这种做法，越来越多的用户已经准备好文件。）
> 
> 它确保有效载荷尽可能小。（Google 可以以多种格式（如 GZIP 或 DEFLATE）预压缩文件。这使得下载时间非常短，因为它是超级压缩的，并且不是动态压缩的。）
> 
> 它减少了服务器使用的带宽量。（谷歌基本上是提供免费带宽。）
> 
> 它确保用户将获得地理上接近的响应。（谷歌在世界各地都有服务器，进一步降低了延迟。）
> 
> （可选）它们会自动使您的脚本保持最新。（如果你喜欢“坐以待毙”，你总是可以使用他们提供的任何脚本的最新版本。这些可以修复安全漏洞，但通常只会破坏你的东西。）

# c# - 将 WCF 输出写入文档

> ID：12112575
> 
> 赞同：0
> 
> 时间：2012-08-24T15:42:35.710
> 
> 标签：c#, .net, wcf, wcf-client

嗨，我有一个运行良好的 WCF 服务。出于测试目的以 QC 数据，我想对数据进行序列化并将其写入 xml 文档。如何才能做到这一点。

请在下面的代码中找到我在客户端应用程序中使用 WCF 服务的位置

```
Client.EMPServiceClient proxy = new Client.EMPServiceClient(); 

proxy.ClientCredentials.UserName.UserName = "testuser"; 
proxy.ClientCredentials.UserName.Password = "password"; 

Client.EMPSearchCriteria criteria = new Client.EMPSearchCriteria(); 
criteria.EMPNumber = "01-351"; 
proxy.GetEMPData(criteria); 

Console.Write("Finish"); 
```

我写了一个如下的类来将输出写入文档 - 但有人可以告诉我如何桥接这些

```
public static void SerializeToXML(EMPData pdata) 
{ 
    XmlSerializer serializer = new XmlSerializer(typeof(EMPData)); 
    TextWriter txtwriter = new StreamWriter(@"d:\test.xml"); 
    serializer.Serialize(txtwriter, pdata); 
    txtwriter.Close(); 
} 
```

请就如何将输出写入 xml 文档提出建议

谢谢，贾斯汀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T17:13:31.283

正确的方法是使用 WCF 的内置消息日志记录 - 根本不需要修改应用程序。这样，您一定会得到完全相同的消息 - 否则您的客户端的序列化可能会受到 WCF 配置的影响，而当您手动序列化消息时，该配置将不适用。

[http://msdn.microsoft.com/en-us/library/ms751526.aspx](http://msdn.microsoft.com/en-us/library/ms751526.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:44:26.873

不

```
proxy.GetEMPData(criteria); 
```

退货？你不应该使用那个结果吗？

尝试...

```
Client.EMPServiceClient proxy = new Client.EMPServiceClient(); 

proxy.ClientCredentials.UserName.UserName = "testuser"; 
proxy.ClientCredentials.UserName.Password = "password"; 

Client.EMPSearchCriteria criteria = new Client.EMPSearchCriteria(); 
criteria.EMPNumber = "01-351"; 
var data =    proxy.GetEMPData(criteria); // Change this line

SerializeToXML(data); // and adding this line

Console.Write("Finish"); 
```

# android - 选择 EditText 时不显示选项菜单 - Android

> ID：12112578
> 
> 赞同：0
> 
> 时间：2012-08-24T15:42:48.607
> 
> 标签：android, android-edittext, android-optionsmenu

我有一个带有列表视图和 EditText 的布局。我创建了一个带有一些选项的菜单。

问题是：当 Textview 聚焦时，本机菜单按钮不起作用（这只发生在三星智能手机上）！

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T20:09:24.837

我对 EditText 也有类似的问题。我在编辑文本上使用了 setOnKeyListener()。EditText 将在 Activity 启动后立即获得焦点，并且它正在破坏菜单键操作，因此不会调用 onCreateOptionsMenu()。

添加

```
if( keyCode == KeyEvent.KEYCODE_MENU ){
  return false;
} 
```

在 EditText OnKeyListener.onKey() 方法上解决了这个问题。

# java - Java Applet，游戏循环第一次运行良好，然后重置时以一半的速度更新

> ID：12112581
> 
> 赞同：0
> 
> 时间：2012-08-24T15:42:59.137
> 
> 标签：java, multithreading, applet

所以对于我正在创建的游戏，我意识到我的 gameLoop 做错了什么，因为我第一次玩我的游戏时它运行得很好，但是第二次或之后的任何事情，它都会减慢一半。即使我将游戏最小化（因为这会停止 gameLoop，然后再次启动它会重新启动它）这里是 gameLoop 代码：

```
public void gameLoop(){

        new Thread(){
            public void run() {
                while(gameRunning){
                    try {
                        Thread.sleep(1000/60);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    if (tutorial){
                        updateBullet();
                        updatePlayer();
                        repaint();
                    } else {
                        updateEnemies();
                        updateBullet();
                        createEnemies();
                        updateParticles();
                        updatePlayer();
                        repaint();
                    }

                }
                repaint();
            }
        }.start();
} 
```

我第一次在 init() 中启动它

```
gameLoop(); 
```

然后我也有：

```
public void stop(){
    bg.stop();
    gameRunning = false;
}
public void start(){
    bg.start();
    gameRunning = true;
    gameLoop();

} 
```

最后 playerUpdate 也停止循环（播放器内部的线程是为了让一些效果在播放器死亡后完成）：

```
 public void updatePlayer(){
    if (player.isMovingLeft){
        player.x-=3;
    }
    if (player.isMovingRight){
        player.x+=3;
    }
    for (int j=0; j < enemies.size(); j++){
        if (player.isAlive){
            if (enemies.get(j).x+19 > player.x && enemies.get(j).x < player.x+40 && enemies.get(j).y > player.y  && enemies.get(j).y < player.y+40) {
                enemies.remove(j);
                j--;
                explode.setFramePosition(0);
                explode.start();
                for (int k = 0; k <21; k++){
                    addParticle(player.x+20,player.y+20,2);
                }
                new Thread(){
                    public void run() {
                        try {
                            Thread.sleep(2000);
                            gameRunning = false;
                        } catch (InterruptedException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }.start();

                player.isAlive = false;
                break;

            }
        }
    }
} 
```

然后在 keyPressed 事件中重新启动它：

```
if (!gameRunning){
        if (arg0.getKeyCode() == KeyEvent.VK_ENTER){
            enemies.clear();
            bullets.clear();
            particles.clear();
            score = 0;
            player.x = 200;
            player.isMovingLeft = false;
            player.isMovingRight = false;
            player.isAlive = (true);

            gameRunning = true;
            gameLoop();
        }
    } 
```

那么为什么每当循环停止并再次启动时，它会以一半的速度运行呢？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:45:17.950

看起来您正在为每个游戏循环启动一个新线程；这意味着每次游戏循环运行时，您都有另一个线程供 Java VM 处理。这是非常低效的，因为最终您将运行 1000 个线程，从而导致巨大的延迟。有没有什么方法可以重写你的代码而不在那里线程？

另外，这应该做什么？

```
 try {
                    Thread.sleep(1000/60);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
```

你为什么要做1000/60？A: 为什么不直接使用 16？B: 好像你在这里有别的意思，但不知道是什么意思

另外，您在`start()`and`stop()`方法中引用的 bg 变量是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T18:48:55.403

看起来您正试图通过使用 gameRunning 布尔值来停止线程。如果这不是易失性的，那么游戏循环可能不会注意到将其设置为 false 的 GUI 线程的更改并将永远运行。即使它是不稳定的，如果在游戏线程注意到停止命令之前再次调用 start ，您就会有竞争条件。

相反，您应该存储对创建的线程的引用并在您的 stop 方法中中断它。

相对于paint方法，您的所有更新方法也是线程安全的。updatePlayer 看起来不是线程安全的，而且您不知道何时调用paint，因此它可能与您的更新方法同时发生。即使paint方法不写入共享数据，由于缺少内存屏障，它仍然可能看到不一致的数据。

我建议在 GUI 线程中进行所有更新，除非它非常慢并且您需要多线程。查看使用 Swing 中的 Timer 来启动更新逻辑。

# magento - 更改 magento 文件夹搞砸了风格

> ID：12112582
> 
> 赞同：0
> 
> 时间：2012-08-24T15:43:08.193
> 
> 标签：magento

我在我的根文件夹“/”中安装了一个 magento 网站。一切正常，直到我将 magento 的所有内容移动到域中的子文件夹中。因此，不是将 magento 放在根文件夹中，而是现在位于子文件夹下。

问题是，设计被搞砸了。它没有显示默认主题的 css 和图像。

请帮我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:34:27.357

您必须更改基本 url 设置。

您的管理面板很可能也停止工作，因此请查看 DB 表`core_config_data`。查找路径`web/unsecure/base_url`并`web/secure/base_url`更新相应的`value`字段以包含新文件夹。

**不要忘记在新网址后面加上斜杠**

# jquery - Wordpress 中的 Flexslider：多个计数器

> ID：12112585
> 
> 赞同：0
> 
> 时间：2012-08-24T15:43:17.607
> 
> 标签：jquery, wordpress, slideshow, counter, flexslider

我试图弄清楚如何让多个计数器正常工作。flexslider 的功能方式是，每个幻灯片可以有许多幻灯片和导航，但我不能让计数器只为单个幻灯片工作。

这是一个例子：http: [//jsfiddle.net/thehonestape/3Cgcs/1/](http://jsfiddle.net/thehonestape/3Cgcs/1/)

我才真正开始使用 jquery，所以我确信答案很简单，但我自己无法弄清楚。谢谢您的帮助。

安倍

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:57:41.380

您通过此代码设置值

```
$('.current-slide').text() 
```

这将使用 .current-slide 类更新所有元素的文本。您为两个计数器提供了相同的类，这就是它们显示相同值的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T04:16:16.560

你无法以你正在处理的方式解决问题。jQuery 将选择所有具有 class=".current-slide" 的元素。解决您的问题的唯一方法是重新考虑您的设计，即为什么您在同一页面上有多个滑块？也许您可以将所有图像合并到一个滑块中，或者更改您的内容，以便每页有一个滑块。例如，只需有一个链接 () 到下一个主题的下一个滑块。或者，如果滑块需要保持在同一页面上，则只需创建多个 Flexislider 调用：

```
$('.flexslider').flexslider({
//options
start: function(slider){
    $('.total-slides').text(slider.count);
    $('.current-slide').text(slider.currentSlide);
    $('.current-slide').text(function(i,txt) { return parseInt(txt, 10) + 1; });

  },
  after: function(slider) {
    $('.current-slide').text(slider.currentSlide);
    $('.current-slide').text(function(i,txt) { return parseInt(txt, 10) + 1; });

  }

 });

 $('.flexslider2').flexslider({
//options
 start: function(slider){
    $('.total-slides2').text(slider.count);
    $('.current-slide2').text(slider.currentSlide);
    $('.current-slide2').text(function(i,txt) { return parseInt(txt, 10) + 1; });

  },
  after: function(slider) {
    $('.current-slide2').text(slider.currentSlide);
    $('.current-slide2').text(function(i,txt) { return parseInt(txt, 10) + 1; });

  }

 }); 
```

# sql-server-2008-r2 - MS Access：子表单中的父关系

> ID：12112590
> 
> 赞同：0
> 
> 时间：2012-08-24T15:43:38.340
> 
> 标签：sql-server-2008-r2, ms-access-2007

我们使用 MS Access 2007 作为 SQLServer 2008-r2 的前端。在这个数据库中，几个表都有一个引用地址表的列：

```
Person
 - PersonId
 - Name
 - AddressId

Facility
 - FacilityId
 - Name
 - AddressId

Address
 - AddressId
 - Street
 - Number
 - City 
```

人和设施都有自己的表格，地址应该在表格上可见和可编辑。不幸的是，MS Access 子表单不能很好地处理这种类型的关系。它确实绑定，但它不刷新也不创建地址并更新父表单中的 AddressId。这可以在代码中有所固定，但我很难让它稳定。

我应该怎么办？我想出了：

*   将地址列推入设施和人员表中。
*   在人员和设施表单上创建控件并使用代码填写/保存它们。

# objective-c - CCPanZoomController + 可点击精灵

> ID：12112592
> 
> 赞同：1
> 
> 时间：2012-08-24T15:43:39.113
> 
> 标签：objective-c, xcode, cocos2d-iphone

我正在为我的游戏创建一个可缩放和平移的地图（使用 CCPanZoomController）。在这张地图中，我想要一个可点击的精灵，当它被点击时，“做点什么”……</p>

我可以让这两个东西在单独的项目中完美地工作，但是当我尝试将它们结合起来时，当我点击我的精灵时没有任何反应。

我已经包含了一张图片来进一步演示： ![我想要的演示](../Images/82bce691d135723dc24979ff15c02ec9.png)

```
//in my init section

        self.isTouchEnabled = YES;

            mapBase = [CCSprite spriteWithFile:@"MapBase.png"];
            mapBase.anchorPoint = ccp(0, 0);
            [self addChild:mapBase z:-10];

            gym = [CCSprite spriteWithFile:@"Gym.png"];
            gym.scale = 0.3;
            gym.position = ccp(1620, 250);
            [self addChild:gym z:1];

            CGRect boundingRect = CGRectMake(0, 0, 2499, 1753);
            _controller = [[CCPanZoomController controllerWithNode:self] retain];
            _controller.boundingRect = boundingRect;
            _controller.zoomOutLimit = _controller.optimalZoomOutLimit;
            _controller.zoomInLimit = 2.0f;
            [_controller enableWithTouchPriority:1 swallowsTouches:YES];
//end of init

    -(void) registerWithTouchDispatcher
    {
        [[[CCDirector sharedDirector] touchDispatcher] addTargetedDelegate:self
                                                                  priority:0 swallowsTouches:NO];
    }

    -(BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event{
        CGPoint touchPoint1 = [touch locationInView:[touch view]];

        if (CGRectContainsPoint(gym.boundingBox, touchPoint1)) return YES;

        return NO;

    }

    -(void) ccTouchEnded:(UITouch *)touch withEvent:(UIEvent *)event{
        CGPoint touchPoint2 = [touch locationInView:[touch view]];
        if (CGRectContainsPoint(gym.boundingBox, touchPoint2)){
            CCLOG(@"SPRITE HAS BEEN TAPPED");
        }
    } 
```

我希望能够放大/缩小并平移整个地图（包括“健身房”精灵）。如果用户点击了精灵“健身房”，那么我想“做点什么”。

如果有人能弄清楚这一点，我将非常感激！谢谢。

# javascript - 使用“yepnope”JavaScript 脚本加载器强制刷新脚本

> ID：12112596
> 
> 赞同：0
> 
> 时间：2012-08-24T15:43:46.990
> 
> 标签：javascript, yepnope, dynamic-script-loading

使用[yepnope.js](http://yepnopejs.com/)。我需要“刷新”脚本，但 yepnope 会阻止重新加载具有相同 url 的文件。

在文档中，他们建议使用插件来允许文件刷新。有没有这样的插件可用？在 Javascript 运行时刷新脚本的其他选项是什么？

我尝试将随机数作为查询参数附加到 url。这行得通，但是在调试时设置断点变得更加困难，所以我宁愿不这样做。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:41:42.200

恕我直言，使用任何 yepnope 方法**都无法做到这一点。**

我认为你只有两种可能：

*   向查询字符串添加随机参数（您当前的解决方案）
*   将 yepnope 脚本更改为：
    1.  暴露`scriptCache`yepnope var
    2.  重置`scriptCache[url]`
    3.  最后*删除*创建的**DOM img 节点**，其中您的*url 为 src*。
    4.  另外将缓存头设置为过期，以防止浏览器缓存。

祝你好运

# android - MediaPlayer setDisplay 当返回到一个不工作的活动时

> ID：12112597
> 
> 赞同：2
> 
> 时间：2012-08-24T15:43:49.060
> 
> 标签：android, service, media-player

我想在后台使用 MediaPlayer 播放视频，因此当用户离开我的应用程序时，他仍然会听到音频，而当他返回应用程序时，他会看到视频。我设法用播放 MediaPlayer 的服务完成了第一部分，但第二部分有问题。当我离开应用程序并返回时，SurfaceView 中不显示视频。

当用户返回时，我创建了新的 Surface，所以我尝试了这个：

```
public void surfaceCreated(SurfaceHolder holder) {
    if(mService!=null && mService.player.isPlaying()){          
        try {
            mService.player.setDisplay(holder);
            mService.player.prepare();
            mService.player.start();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }       
} 
```

While`mService`是我的服务，他持有 MediaPlayer `player`。

在我的研究中，我看到了这篇文章： [返回 Android 中的视频播放活动时出现黑屏](https://stackoverflow.com/questions/6347924/black-screen-when-returning-to-video-playback-activity-in-android)

但这是一年前发布的，所以也许任何人都有任何不同的新答案。

编辑：我忘了说视频正在流式传输，所以重置不是一个好的选择（我试过:)）。

是否可以将 SurfaceView 保存在服务中以及当用户返回查看视图并将其动态添加到当前布局时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-20T08:31:47.870

首次启动 Activity 时：onResume()->onSurfaceCreated()->onSurfaceChanged()。
离开 Activity 时：onPause()->onSurfaceDestroyed()

所以我离开你的应用程序，表面将被自动销毁，你也不能在服务中保存表面视图。
请记住，如果您想再次显示视频，必须再次创建表面视图和持有者回调`onStart`，以防您按下主屏幕或锁屏

```
surfaceView = (SurfaceView) findViewById(R.id.surfaceView);

holder = surfaceView.getHolder();
holder.setFixedSize(800, 480);
holder.addCallback(this);
holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); 
```

# c - 如何存储recv()的输出？

> ID：12112598
> 
> 赞同：6
> 
> 时间：2012-08-24T15:43:55.257
> 
> 标签：c, sockets, dynamic, recv

在 CI 中有工作代码，但不知道它为什么工作，所以我开始重写它，这样我才能真正理解发生了什么。

到目前为止，一切都很好！我重写了，并且 90% 确定我理解现在发生的一切；然而，问题是我不知道如何将`recv`( `databff`) 接收到的数据块存储到我预先分配的缓冲区 ( `htmlbff`) 中。

考虑下面的代码（请注意，我把它剥离了很多，所以它只包括基础知识，例如没有内存重新分配或泄漏保护等......）：

```
#define BUFFERSIZE 4096
#define MAXDATASIZE 256

char *htmlbff, databff[MAXDATASIZE];
int c, i = BUFFERSIZE, q = 0;          
if(!(htmlbff = malloc(i)))
{
    printf("\nError! Memory allocation failed!");
    return 0x00;
}
while((c = recv(sock, databff, MAXDATASIZE, 0)) > 0)
{
     /*memory checks stripped out since they are irrelevent for this post*/
     /*store data to the appropriate area in htmlbff*/
     q += c;           
} 
```

所以（如果我做得对，并且事情按照我的想法进行）`c`是当前数据块的大小，并且`q`是到目前为止接收到的数据总量（每次循环重复时`q`递增）。`c`目前我正在使用`q`内存处理（以防有人想知道），但我相信它在解决这个问题时也有目的。

无论如何，我要问的问题是关于第二条评论的。如何`htmlbff`正确存储 recv 中的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:50:44.327

用于[`memcpy()`](http://en.cppreference.com/w/c/string/byte/memcpy)将数据复制（附加）到 ，`htmlbff`但您还需要确保不超过`htmlbff`. `BUFFERSIZE`要么在接收到字节时停止接收数据，要么[`realloc()`](http://en.cppreference.com/w/c/memory/realloc)用于扩展`htmlbff`以包含更多数据。

例如：

```
char* htmlbff;
size_t htmlbff_size = BUFFERSIZE;
htmlbff = malloc(htmlbff_size);

if (htmlbff)
{
    while((c = recv(sock, databff, MAXDATASIZE, 0)) > 0)
    {
        if (c + q > htmlbff_size)
        {
            htmlbff_size *= 2; /* Arbitrary doubling of size. */
            char* tmp = realloc(htmlbff, htmlbff_size);
            if (tmp)
            {
                htmlbff = tmp;
            }
            else
            {
                /* memory allocation failure. */
                free(htmlbff);
                htmlbff = 0;
                break;
            }
        }
        memcpy(htmlbff + q, databff, c);
        q += c;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:48:10.153

使用,`memcpy`并偏移`htmlbff`:`q`

```
memcpy(htmlbff + q, databff, c); 
```

您可以类似地`recv`直接进入`htmlbff`：

```
c = recv(sock, htmlbff + q, MAXDATASIZE, 0)); 
```

但是保留一个单独的缓冲区很好，并且根据您的完整代码，它可能会使事情更清晰。

确保添加检查，`BUFFERSIZE`以免复制超出`htmlbff`. 你提到你已经剥离了`realloc`处理，所以也许你已经在处理这个了。

您的常量名称有点令人困惑，在缓冲数据时我会用它`BUFFERSIZE`来指示每个*块*的大小，即`databff`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T15:51:23.750

我要做的是将`recv()`数据直接放入`htmlbff`，除非您需要对其进行更多处理。

确保您的`realloc()` `htmlbff`时间`i - q`小于，`MAXDATASIZE`以便始终有空间容纳另一个`recv()`。

然后你会打电话`recv(sock, htmlbff + q, MAXDATASIZE, 0)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T15:51:09.513

您需要继续重新分配/扩展缓冲区以适应所有数据（如果从套接字读取的数据超过 MAXDATASIZE）= 这样当 recv 将数据读入 databff 时，您的 htmlbff 可以在内存中增长，然后可以附加新的读取到你的整体 htmlbff。

q 和 c 就像光标一样，可以跟踪您在哪里以及您必须走多远。

```
memcpy(htmlbff+q, databff, c); //Do this in your whle loop to append the data 
```

# bash - 用另一个文件的竞赛替换或附加文件中的文本块

> ID：12112602
> 
> 赞同：0
> 
> 时间：2012-08-24T15:44:15.837
> 
> 标签：bash, unix, sed, awk, grep

我有两个文件：

`super.conf`

```
someconfig=23;
second line;

#blockbegin
dynamicconfig=12
dynamicconfig2=1323
#blockend

otherconfig=12; 
```

`input.conf`

```
newdynamicconfig=12;
anothernewline=1234; 
```

我想运行一个脚本并替换和行`input.conf`之间的内容。`#blockbegin``#blockend`

我已经有了这个：

```
sed -i -ne '/^#blockbegin/ {p; r input.conf' -e ':a; n; /#blockend/ {p; b}; ba}; p' super.conf 
```

它工作得很好，但直到我更改或删除`#blockend`行`super.conf`，然后脚本替换之后的所有行`#blockbegin`。

* * *

另外，我希望脚本替换块**，或者**如果块不存在于`super.conf`追加新块中，其内容为`input.conf`to `super.conf`。可以通过remove + append来完成，但是如何使用sed或者其他unix命令来删除block呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T21:52:36.120

尽管我不得不质疑这个方案的实用性——我倾向于支持那些在没有达到预期时大声抱怨的系统，而不是像这样更加松散、笨拙的系统——我相信下面的脚本会做你想做的事。

操作理论：它预先读取所有内容，然后一举将其输出全部发出。

假设您将文件命名`injector`为`injector input.conf super.conf`.

```
#!/usr/bin/env awk -f
#
# Expects to be called with two files. First is the content to inject,
# second is the file to inject into.

FNR == 1 {
    # This switches from "read replacement content" to "read template"
    # at the boundary between reading the first and second files. This
    # will of course do something suprising if you pass more than two
    # files.
    readReplacement = !readReplacement;
}

# Read a line of replacement content.
readReplacement {
    rCount++;
    replacement[rCount] = $0;
    next;
}

# Read a line of template content.
{
    tCount++;
    template[tCount] = $0;
}

# Note the beginning of the replacement area.
/^#blockbegin$/ {
    beginAt = tCount;
}

# Note the end of the replacement area.
/^#blockend$/ {
    endAt = tCount;
}

# Finished reading everything. Process it all.
END {
    if (beginAt && endAt) {
        # Both beginning and ending markers were found; replace what's
        # in the middle of them.
        emitTemplate(1, beginAt);
        emitReplacement();
        emitTemplate(endAt, tCount);
    } else {
        # Didn't find both markers; just append.
        emitTemplate(1, tCount);
        emitReplacement();
    }
}

# Emit the indicated portion of the template to stdout.
function emitTemplate(from, to) {
    for (i = from; i <= to; i++) {
        print template[i];
    }
}

# Emit the replacement text to stdout.
function emitReplacement() {
    for (i = 1; i <= rCount; i++) {
        print replacement[i];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:49:08.677

我已经写了 perl 单行：

```
perl -0777lni -e 'BEGIN{open(F,pop(@ARGV))||die;$b="#blockbegin";$e="#blockend";local $/;$d=<F>;close(F);}s|\n$b(.*)$e\n||s;print;print "\n$b\n",$d,"\n$e\n" if eof;' edited.file input.file 
```

论据：

`edited.file`- 更新文件 `input.file`的路径 - 包含新块内容的文件的路径

脚本首先删除块（如果找到一个匹配），然后在新块中添加新内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-24T16:03:43.330

你的意思是说

```
sed '/^#blockbegin/,/#blockend/d' super.conf 
```

# c# - 正则表达式查找具有特殊href的锚链接？

> ID：12112603
> 
> 赞同：-1
> 
> 时间：2012-08-24T15:44:22.693
> 
> 标签：c#, regex

我只需要为以下内容找到一个正则表达式：

我在`div`标签中有一些内容，其中包括很多锚链接。所以我的任务是找到`href`格式为“components/showdoc.aspx?docid=”的锚链接，然后`onclick`仅为该锚链接添加事件，留下其余的锚链接。

```
<div id="content" runat="server">
    <a href="www.xxxx.com/components/showdoc.aspx?docid=100">test doc</a>
</div> 
```

该表达式给出并添加目标。

```
RegEx.Replace(inputString, "<(a)([^>]+)>", "<$1 target=""_blank""$2>") 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:25:39.793

如果您希望对 HTML 文件进行永久性更改，请首先通过将其加载到`System.Windows.Forms.WebBrowser`控件中来管理 HTML 解析。从那里，您可以对 HTML 执行类似 DOM 的修改，而不会因`Regex.Replace`对原始文件执行而导致解析损坏的危险后果。（显然 RegEx + HTML 对某些人来说是一个严重的问题）。

所以首先在你的代码中你会：

```
WebBrowser myBrowser = new WebBrowser();
myBrowser.URL = @"C:\MyPath\MyFile.HTML";
HtmlElement myDocBody = myBrowser.Document.Body; 
```

然后，您可以浏览您的文档正文，`div`使用`HtmlElement.Id`属性和`HtmlElement.GetAttribute`方法查找您的标签并查找您的锚标签。

注意：仍然可以在 URL 字符串上使用 RegEx 匹配，但只能在从`GetAttribute("href")`方法中提取它们之后。

要添加该`onClick`方法，只需调用该`HtmlElement.SetAttribute`方法。

完成所有修改后，通过写入`WebBrowser.DocumentText`文件来保存更改。

这是一个参考：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.htmlelement.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmlelement.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:57:23.503

不要使用正则表达式来解析 html，这是邪恶的。

您可以使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com)，它甚至还有一个不错的[NuGet 包](http://nuget.org/packages/HtmlAgilityPack)。

或者，您可以在客户端使用一行 jQuery 执行此操作：

```
$('a[href*="components/showdoc.aspx?docid="]').on('click', myClickFunction); 
```

这是利用[Attribute Contains Selector](http://api.jquery.com/attribute-contains-selector/)。

如果你想在你的 click 函数中找到 docid，你可以在你的 click 函数中写这样的东西：

```
function myClickFunction(e){
    var href = $(this).attr('href');
    var docId = href.split('=')[1];
    alert(docId);
} 
```

请注意，这假设只有一个查询字符串值，如果你想让它更健壮，你可以在这个答案中做类似的事情：[https ://stackoverflow.com/a/1171731/21200](https://stackoverflow.com/a/1171731/21200)

# java - Java - 在此方法上使用断点

> ID：12112605
> 
> 赞同：1
> 
> 时间：2012-08-24T15:44:28.423
> 
> 标签：java, breakpoints

这是过去试卷中的一道题。问题中给出了代码，我需要获取值以及断点的次数。我曾尝试在 Eclipse 中运行代码，但无济于事。（如果执行代码，我可以在调试模式下找到值）

问题还指出：该方法`fact`是在值为 6 的类的实例上调用的`n`。不确定我做错了什么，因为代码与问题中给出的完全相同。

```
public class FactLoop {

private int n;// assumed to be greater than or equal to 0

/**
 * Calculate factorial of n
 * 
 * @return n!
 */
public int fact() {
    int i = 0;
    int f = 1;

    /**
     * loop invariant 0<=i<=n and f=i!
     */

    while (i < n) {// loop test (breakpoint on this line)
        i = i++;
        f = f * i;
    }
    return f;
}

// this main method is not a part of the given question
public static void main(String[] args) {
    FactLoop fl = new FactLoop();
    fl.n = 6;
    System.out.println(fl.fact());
} 
```

`}`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T15:51:58.703

你的错误在`i=i++;`. `i++`增加 i，并返回 i 的旧值。通过说`i=i++`，您将其递增，然后将其设置为旧值。

只是`i++;`用来增加它。

# python - 在 Python 中读取 CSV - 列不在文件开头

> ID：12112607
> 
> 赞同：0
> 
> 时间：2012-08-24T15:44:47.280
> 
> 标签：python, csv

我正在尝试调整以前接收 CSV 文件的脚本，其中列位于文件的开头，但是现在它读取的 CSV 已更改，因此在给出列标题之前有大量的 spiel。

有没有办法使用 DictReader （甚至任何其他方法）跳到列所在的位置（第 15 行）并使用这些？目前我正在使用下面的代码，但它总是占据文件的第一行。

```
f = open(fileName)
reader = csv.DictReader(f)
lineU = 0
for underlyer in reader:
    lineU = lineU + 1
    if(lineU == 6):
       #start the code 
```

感谢提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:47:26.910

在将其传递`f`给`DictReader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:47:50.690

将`csv.reader`遍历文件，因此您基本上可以`file.readline()`在开始使用阅读器之前阅读这些行，这样它们就不会出现在阅读器中。

# javascript - Node.js 范围错误

> ID：12112610
> 
> 赞同：1
> 
> 时间：2012-08-24T15:45:03.143
> 
> 标签：javascript, node.js, coffeescript

我收到以下错误：

```
/Users/nblavoie/Desktop/HotPie/HotPie/apps/authentication/routes.coffee:6
  app.get('/login', function(req, res) {
  ^
ReferenceError: app is not defined
    at Object.<anonymous> (/Users/nblavoie/Desktop/HotPie/HotPie/apps/authentication/routes.coffee:6:3)
    at Object.<anonymous> (/Users/nblavoie/Desktop/HotPie/HotPie/apps/authentication/routes.coffee:15:4)
    at Module._compile (module.js:449:26)
    at Object.require.extensions..coffee (/Users/nblavoie/Desktop/HotPie/HotPie/node_modules/coffee-script/lib/coffee-script/coffee-script.js:22:21)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/Users/nblavoie/Desktop/HotPie/HotPie/app.js:31:1)
    at Module._compile (module.js:449:26) 
```

在尝试将 (app) 变量传递给以下要求时：

```
/**
 * Module dependencies.
 */

require('coffee-script');

var express = require('express')
  , http = require('http')
  , path = require('path');

var app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
});

app.configure('development', function(){
  app.use(express.errorHandler());
});

// Routes
**require('./apps/authentication/routes')(app);**

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

在以下文件中使用 app 变量：

```
routes = (app) -> 
app.get '/login', (req, res) ->
    res.render 'views/login',
        title: 'Login'
        stylesheet: 'login'
module.exports = routes 
```

我知道变量范围从一个 JS 文件到另一个不同。但是为什么以下行：

```
require('./apps/authentication/routes')(app); 
```

不传递 app 变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:07:21.993

就在这儿：

```
ReferenceError: app is not defined
    at Object.<anonymous> (/Users/nblavoie/Desktop/HotPie/HotPie/apps/authentication/routes.coffee:6:3) 
```

错误不在`app.js`，它在您的 CoffeeScript 文件中。查看[它正在编译的内容](http://coffeescript.org/#try%3aroutes%20=%20%28app%29%20-%3E%0Aapp.get%20%27/login%27,%20%28req,%20res%29%20-%3E%0A%20%20%20%20res.render%20%27views/login%27,%0A%20%20%20%20%20%20%20%20title%3a%20%27Login%27,%0A%20%20%20%20%20%20%20%20stylesheet%3a%20%27login%27%0A%0Amodule.exports%20=%20routes)：

```
var routes;

routes = function(app) {};

app.get('/login', function(req, res) {
  return res.render('views/login', {
    title: 'Login',
    stylesheet: 'login'
  });
});

module.exports = routes; 
```

注意这`routes`是一个空函数？是的，你错过了一个缩进。将 CoffeeScript 更改为以下内容应该可以修复它（注意缩进`app.get`和之后的所有内容）：

```
routes = (app) ->
    app.get '/login', (req, res) ->
        res.render 'views/login',
            title: 'Login',
            stylesheet: 'login'

module.exports = routes 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:04:03.417

CoffeeScript 对缩进非常敏感。此代码应该可以工作：

```
routes = (app) -> 
    app.get '/login', (req, res) ->
        res.render 'views/login',
            title: 'Login'
            stylesheet: 'login'
module.exports = routes 
```

# fpdf - FPDF/FPDI 使用模板

> ID：12112612
> 
> 赞同：1
> 
> 时间：2012-08-24T15:45:10.727
> 
> 标签：fpdf, fpdi

我正在使用 FPDI 和 FPDF 将新文本覆盖在现有 PDF 之上。它使用 useTemplate() 方法来实现这一点。

我遇到的问题 - 它仅将模板应用于第一页。如果文本很长，它将使用 SetAutoPageBreak() 方法换行到第二页。我怎样才能让它在每个页面上应用模板？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T08:48:37.593

我已经破解了。查看代码，我意识到即使是 SetAutoPageBreak() 例程也会在内部调用 AddPage()，这为我提供了在每个页面上包含模板所需的钩子。

因此，我扩展了基础 FPDI 类并覆盖了 AddPage() 方法，包括 useTemplate() 东西。

```
class BBPDF extends FPDI {
    function AddPage($orientation='', $size='') {
        parent::AddPage($orientation,$size);
        $this->setSourceFile('templates/discover-community.pdf');
        $template = $this->ImportPage(1);
        $this->useTemplate($template);
    }
} 
```

# java - 用于 windows 和 os x 的 java 应用程序的可行性

> ID：12112613
> 
> 赞同：0
> 
> 时间：2012-08-24T15:45:14.657
> 
> 标签：java, windows, macos

我正在编写这个应用程序，它需要我列出目录及其子目录中的所有文件，并用 Java 删除所有 mp3 文件。

截至目前，我正在使用`Apache Commons`库并寻找这样的 mp3 文件

```
mp3Files = (List<File>) FileUtils.listFiles(path ,new SuffixFileFilter(".mp3"), TrueFileFilter.INSTANCE); 
```

现在我从用户那里获取主目录 URL。

我的应用程序完成的其余工作。

所以我想知道的是，代码在 windows 和 os x 上的工作方式是否相同？无论操作系统如何，它都会删除所有 mp3 文件，还是不同的文件结构会导致任何问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:58:23.217

Java 与操作系统无关，所以你应该没问题。但这并不意味着您的 Java 代码也与操作系统无关。应该有一些特定于操作系统的东西需要考虑，比如分隔符。这意味着您不应该对分隔符进行硬编码，而是使用它[`File.separator`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#separator)。

此外，使用[`File`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#separator)而不是对您的环境做出任何假设也会对您有所帮助。

**编辑**：是的，您应该可以`FileUtils`以这种方式使用和搜索 MP3 文件。

# c# - 将 HTML 描述转换为要设置为元描述的字符串

> ID：12112614
> 
> 赞同：1
> 
> 时间：2012-08-24T15:45:15.583
> 
> 标签：c#, asp.net, html, string, meta-tags

我正在一个讨论网站上工作。（[http://www.wrangle.in/](http://www.wrangle.in)）。我向它添加了一个主题的 HTML 格式描述的新功能。HTML 格式的描述保存在数据库中。加载主题时，描述以 HTML 格式可见。但是即使在我使用以下类从字符串中删除 HTML 标记之后，元描述也会显示 HTML 标记。但是这个类不工作。我从网上的某个地方下载了它。它没有删除  , & 等像字符。即使它没有删除所有标签。请告诉我如何使我的 HTML 描述在 META 中作为文本描述可见？

```
/// <summary>
/// Methods to remove HTML from strings.
/// </summary>
public static class HtmlRemoval
{
    /// <summary>
    /// Remove HTML from string with Regex.
    /// </summary>
    public static string StripTagsRegex(string source)
    {
        return Regex.Replace(source, "<.*?>", string.Empty);
    }

    /// <summary>
    /// Compiled regular expression for performance.
    /// </summary>
    static Regex _htmlRegex = new Regex("<.*?>", RegexOptions.Compiled);

    /// <summary>
    /// Remove HTML from string with compiled Regex.
    /// </summary>
    public static string StripTagsRegexCompiled(string source)
    {
        return _htmlRegex.Replace(source, string.Empty);
    }

    /// <summary>
    /// Remove HTML tags from string using char array.
    /// </summary>
    public static string StripTagsCharArray(string source)
    {
        char[] array = new char[source.Length];
        int arrayIndex = 0;
        bool inside = false;

        for (int i = 0; i < source.Length; i++)
        {
            char let = source[i];
            if (let == '<')
            {
                inside = true;
                continue;
            }
            if (let == '>')
            {
                inside = false;
                continue;
            }
            if (!inside)
            {
                array[arrayIndex] = let;
                arrayIndex++;
            }
        }
        return new string(array, 0, arrayIndex);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:56:37.483

您刚刚删除 HTML 标记的代码，它不会转换`&amp;`'s 和`&nbsp;`'s。

使用[HttpUtility.HtmlDecode](http://msdn.microsoft.com/en-us/library/7c5fyk1k.aspx)会将它们转换为可读字符。

# c# - 通过 SkyDrive API 将文件上传到 skydrive

> ID：12112617
> 
> 赞同：3
> 
> 时间：2012-08-24T15:45:28.217
> 
> 标签：c#, file-upload, windows-8, microsoft-metro, onedrive

我尝试通过 Windows 8 应用程序中的 SkyDrive API 将文本文件上传到我的 skydrive 或至少在 SD 中创建新的文本文件并编辑其内容。我怎样才能做到这一点？

我试图做这样的事情：

```
 LiveConnectClient client = new LiveConnectClient(session);
        var fileData = new Dictionary<string, object>();
        fileData.Add("name", "new_file.txt");
        try
        {
            LiveOperationResult fileOperationResult = await client.PutAsync("me/skydrive", fileData);
            this.infoTextBlock.Text = fileOperationResult.ToString();
        }
        catch (LiveConnectException exception)
        {
            this.infoTextBlock.Text = exception.Message;
        } 
```

但我收到错误“提供的请求无效。无法更新根 SkyDrive 文件夹。” 如果我写类似“me/skydrive/”的内容，我会得到“提供的 URL 无效。不支持请求的路径”。方法 LiveConnectClient.PutAsync 只允许我更新现有属性（但不是它的内容）。

应该如何正确完成？

顺便说一句 - LCDC (http://msdn.microsoft.com/en-us/library/live/hh826531.aspx) 上的内容是否更新？我问是因为文档中的某些方法在 dll 中不存在（fe LiveConnectClient.Upload。只有BackgroundUploadAsync）。

提前感谢您的帮助，迈克尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T09:54:55.357

关闭，但正如我所写：我不能使用 client.upload 方法，因为 LiveConnectClient 类不包含它。这就是为什么我询问网站内容更新的原因。

无论如何 - 我有一个答案：

```
//create a StorageFile (here is one way to do that if it is stored in your ApplicationData)
StorageFile file = awaitApplicationData.Current.LocalFolder.GetFileAsync("yourfilename.txt");

try {
   client = new LiveConnectClient(session);
   LiveOperationResult operationResult = await client.BackgroundUploadAsync("me/skydrive", file.Name, file, OverwriteOption.Overwrite);
}
catch (LiveConnectException exception) {
  //handle exception                
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:42:26.270

您应该在 LiveConnectionClient 上使用 Upload 方法。例如，请参阅[Live SDK](http://msdn.microsoft.com/en-us/library/live/hh826521)中的[上传文件示例](http://msdn.microsoft.com/en-us/library/live/hh826531#uploading_files)。就像是 ...

```
LiveOperationResult fileOperationResult =
     await client.Upload("me/skydrive", /*file name here*/, /*file stream here*/); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-15T18:45:32.527

[这是使用从http://skydriveapiclient.codeplex.com/releases/view/103081](http://skydriveapiclient.codeplex.com/releases/view/103081)下载的 SkyDriveApiClient 从控制台应用程序上传文件的另一种方法

```
 static void Main(string[] args)
    {
        var client = new SkyDriveServiceClient();

        client.LogOn("YourEmail@hotmail.com", "password");
        WebFolderInfo wfInfo = new WebFolderInfo();

        WebFolderInfo[] wfInfoArray = client.ListRootWebFolders();

        wfInfo = wfInfoArray[0];
        client.Timeout = 1000000000;

        string fn = @"test.txt";
        if (File.Exists(fn))
        {
            client.UploadWebFile(fn, wfInfo);
        }

    } 
```

# asp.net-mvc - global.asax 文件中区域的路线

> ID：12112621
> 
> 赞同：0
> 
> 时间：2012-08-24T15:45:46.037
> 
> 标签：asp.net-mvc

在我的 mvc 应用程序中，我有管理区域并且在区域外有默认控制器。我想在 global.asax 文件中定义路由，以便默认和管理员。比如如果用户输入：{http://localhost/} -> 如果用户输入：{http://localhost/Admin/}，则打开默认路由 -> 打开管理员路由

如果有人有想法来处理这个问题，请提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:07:20.433

创建管理区域注册文件。如：

```
public class AdminAreaRegistration : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "Admin";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute(
            "Admin_default",
            "Admin/{controller}/{action}/{id}",
            new { controller = "Admin", action = "Index", id = UrlParameter.Optional },
            new[] { "Admin.Controllers" }
        );
    }
} 
```

然后从您的 Global.asax 调用它

```
 AreaRegistration.RegisterAllAreas(); 
```

# android - 使用 Ksoap2 库从 WebService 获取日期时间到 Android 应用程序

> ID：12112622
> 
> 赞同：0
> 
> 时间：2012-08-24T15:45:45.553
> 
> 标签：android, web-services, datetime, ksoap2

我创建了一个 Web 服务，它返回如下元素数组：

```
<Service>
    <id>string</id>
    <description>string</description>
    <last_change_date>dateTime</last_change_date>
</Service> 
```

我正在从 Android 设备使用此 Web 服务，并且正在使用 Ksoap2 包。当我使用以下方法从 Web 服务接收 SoapObject 时：

```
SoapObject response = (SoapObject)envelope.getResponse(); 
```

我通常使用以下代码获取响应内容：

```
String str = (String)response.getProperty(index).toString(); 
```

而这个，通常效果很好！
但是，为了获取 last_change_date（类型 dateTime 从 SQL Server 上的数据库中的 datetime 字段检索），我不能使用相同的方法。

因此，我正在寻找一种在 Android 中以任何日期格式（日期或日历）转换 dateTime 的机制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:50:54.427

是的，您仍然可以使用该方法获取参数的值。然后您要做的就是将字符串解析为 Date 对象。

例如定义格式：

```
private static final SimpleDateFormat httpHeaderDateFormatter =
    new SimpleDateFormat("EEE, dd MMM yyyy hh:mm:ss z", Locale.US); 
```

并实现这样的解析方法：

```
private Date parseLastModified(String lastModified) {
    Date date = null;
    if (lastModified != null && lastModified.length() > 0) {
        try {
            date = httpHeaderDateFormatter.parse(lastModified);
        } catch (ParseException e) {
            // otherwise we just leave it empty
        }
    }
    return date;
} 
```

当然，您必须使其适应从服务器获得的任何格式以及您想要拥有的任何逻辑，例如当没有价值时..

# .net - 序列化数据集 vb.net 错误

> ID：12112623
> 
> 赞同：1
> 
> 时间：2012-08-24T15:45:47.427
> 
> 标签：.net, vb.net

当我尝试序列化我的自定义数据集时出现此错误。我在做什么错，它应该很简单吗？

谢谢

错误序列化“System.Globalization.CultureInfo”类型的对象时检测到循环引用。

```
 Dim serializer As New JavaScriptSerializer()
            Dim arrayJson As String = serializer.Serialize(makeMYDataSET())

    Private Function makeMYDataSET() As DataSet

        ' Two DataTables.
        Dim table1 As DataTable = New DataTable("patients")
        table1.Columns.Add("name")
        'table1.Columns.Add("id")
        table1.Rows.Add("sam")
        table1.Rows.Add("mark")
        table1.Rows.Add("hjhkhkh")

        Dim table2 As DataTable = New DataTable("medications")
        'table2.Columns.Add("id")
        table2.Columns.Add("medication")
        table2.Rows.Add("atenolol")
        table2.Rows.Add("amoxicillin")

        ' Create a DataSet. Put both tables in it.
        Dim set1 As DataSet = New DataSet("office")
        set1.Tables.Add(table1)
        set1.Tables.Add(table2)

        Return set1

    End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T06:28:33.030

不可能`JavaScriptSerializer`在普通的`DataSet`.

* * *

一种方法是将您的转换`DataSet`为 XML，或者更好的是，将其转换为`Dictionary`第一个。

您可以使用此方法（来自[CodeProject](http://www.codeproject.com/Tips/181230/Convert-DataSet-or-XML-to-JSON-using-VB-NET)的示例）：

```
Function DataSetToJSON(ds As DataSet) As String
    Dim dict = New Dictionary(Of String, Object)

    For Each dt As DataTable In ds.Tables
        Dim arr(dt.Rows.Count) As Object

        For i = 0 To dt.Rows.Count - 1
            arr(i) = dt.Rows(i).ItemArray
        Next

        dict.Add(dt.TableName, arr)
    Next

    Dim json = New JavaScriptSerializer
    Return json.Serialize(dict)
End Function 
```

**例子**

```
 DataSetToJSON(makeMYDataSET()) 
```

**结果**

> {“患者”：[[“sam”]，[“mark”]，[“hjhkhkh”]，null]，“药物”：[[“阿替洛尔”]，[“阿莫西林”]，null]}

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-27T06:13:04.973

```
DataSet somedataset;
XmlSerializer s = new XmlSerializer(typeof(Dataset));
StringWriter sw = new StringWriter();
s.Serialize(sw, somedataset);
string serialized = sw.ToString(); 
```

我知道它的 c#，但它有效。
关于 javascriptserialzer 类，我以前没有使用过，但我认为它与 xmlserializer 有关。

# javascript - 使用箭头键移动 javascript 字符

> ID：12112624
> 
> 赞同：0
> 
> 时间：2012-08-24T15:45:47.573
> 
> 标签：javascript, move, arrow-keys

我正在用javascript编写一个RPG游戏，我希望我的主角在你按下箭头键或wasd键时移动。我有生成他的代码，但是我应该如何定义他的位置，以便在按下上述键时他移动？

```
function mainchar(){
    var mainchar = new Image();
    mainchar.src = /*I'll add this soon*/;
    mainchar.style.top = /*What should I put here?*/;
    mainchar.style.left = /*What should I put here?*/;
    mainchar.style.position = "absolute";
    document.body.appendChild( mainchar );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:58:53.330

使用：[http ://help.dottoro.com/ljaffqqe.php](http://help.dottoro.com/ljaffqqe.php)

在keyup/keydown 使用正确的键码时捕捉。

然后将 mainchar.style.top 设置为您希望将其移动到的任何位置...

例如

1.  检测键
2.  当按下正确的键时
3.  更新 mainchar.stlye.top

# jquery - 在 jquery 中将数据发送到外部 URL

> ID：12112626
> 
> 赞同：1
> 
> 时间：2012-08-24T15:45:58.480
> 
> 标签：jquery

我想将数据发送到 jQuery 中的外部 URL。我不关心响应，也不想阅读响应。有人能告诉我我该怎么做吗？我能够使用此调用成功发送数据：

```
$.get("http://sample-domain.com/testfile.php"); 
```

但是，这在 IE 中似乎不起作用。是否有人对如何发送适用于每个浏览器的数据（无响应）有建议（或更好的方法）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:49:02.040

这是因为浏览器中 ajax 请求的安全限制

您可以在 src 属性中使用该 url 创建一个 IFrame。

像这样的东西：

```
$(document).append("<iframe src='http://sample-domain.com/testfile.php'>") 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:56:17.967

对于您需要的外部网站

```
var jqxhr = $.get('http://sample-domain.com/testfile.php', function() {
    alert("success");
  })
  .success(function() { alert("second success"); })
  .error(function() { alert("error"); })
  .complete(function() { 
    alert ("complete");
  }); 
```

**这是来自 jQuery 网站的一些建议：**

*   由于浏览器安全限制，大部分“Ajax”请求都受同源策略的约束；请求无法从不同的域、子域或协议成功检索数据。
*   如果带有 jQ​​uery.get() 的请求返回错误代码，它将静默失败，除非脚本也调用了全局 .ajaxError() 方法。或者，从 jQuery 1.5 开始，jQuery.get() 返回的 jqXHR 对象的 .error() 方法也可用于错误处理。
*   脚本和 JSONP 请求不受同源策略限制。

# sql - 使用另外两列填充新的 SQL 列

> ID：12112628
> 
> 赞同：3
> 
> 时间：2012-08-24T15:46:07.030
> 
> 标签：sql, database, sql-update

我正在尝试将表中的行组合成表中的一个新行。具体来说，将 First_Name 和 Last_name 列放入 First_Last。由于我试图对表中的所有条目而不只是 1 行执行此操作，因此我无法运行查询。有什么建议么？

当前代码：

```
 update Name
set First_Last = (select First_Name + ' ' + Last_Name from Name) 
```

谢谢，贾斯汀

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T15:48:13.747

假设您打算使用每行的`First_Name`和`Last_Name`值更新同一个表上的所有行，它就像（在 Sql Server 中）一样简单：

```
update MyTable
    set First_Last = First_Name + ' ' + Last_Name; 
```

在大多数其他 RBDMS 中，您使用管道`||`运算符或`CONCAT`函数来组合文本。

请注意，大多数 RDBMS 还具有计算（有时称为生成）列的概念，它可以防止存储派生字段时出现冗余和同步问题：

```
CREATE TABLE MyTable...
(

   First_Last AS first_name + ' ' + last_name
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:58:41.850

您没有指定您的 RDBMS，但如果您使用的是 MySQL，您可以使用该[`CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)函数

```
update Name 
set First_Last = concat(First_Name, ' ', Last_Name) 
```

# jquery - 一起使用 .one() 和 .on() - 每个元素一个处理程序

> ID：12112633
> 
> 赞同：0
> 
> 时间：2012-08-24T15:46:15.767
> 
> 标签：jquery, jquery-1.7

我有以下 HTML：

```
<table>
    <tr>
        <td><button class="foo" type="button">Click Me</button></td>
    </tr>
    <tr>
        <td><button class="foo" type="button">Click Me</button></td>
    </tr>
</table> 
```

我想让 button.foo 的点击处理程序只执行一次，但我不希望 jQuery 从其他元素中删除处理程序。因此，当您单击第一个按钮时，它会删除该按钮的处理程序，但不会删除第二个按钮。当您单击第二个按钮时，它会删除第二个按钮的处理程序，但不会删除第一个按钮。

此外，当将任何具有“foo”类的按钮添加到表中时，我希望它添加一个单击处理程序，该处理程序将在第一次使用时被删除，并且再次不删除其他处理程序。

```
$("table").one("click", "button.foo", function() {
    // ...
}); 
```

上面的代码不起作用，因为它在第一次单击任何元素时删除了所有处理程序。有没有办法轻松完成我的要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:57:40.540

您可以在活动结束后删除课程`click`。

```
$("table").on("click", "button.foo", function() {
    alert("click!");
    $(this).removeClass("foo");
}); 
```

见[演示](http://jsfiddle.net/mhusaini/dGKsj/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:01:58.417

试试这个

```
$("table button.foo").one("click", function() {
    // ...
}); 
```

# php - 自动为 Mysql 表行生成页面

> ID：12112634
> 
> 赞同：0
> 
> 时间：2012-08-24T15:46:22.303
> 
> 标签：php, mysql

我正在创建一个 PHP/mysql 测验应用程序。我在这里概述了我的表结构： [MySql database design for a quiz program](https://stackoverflow.com/questions/12103321/mysql-database-design-for-a-quiz-program)

现在我正在寻找一种自动生成实际测验页面的方法。在“测验”表中输入相应数据后，我希望自动创建一个页面，其中包含具有相同测验 ID 的所有相应问题/答案。然后，该测验的链接将被添加到某处所有测验的列表中。

基本上，一旦将数据输入到 mySQL 表中，我希望一切都自动化。

我真正能想到的是，一旦为测验创建了每个页面，我就可以使用 while 或 for 循环来识别与测验具有相同 ID 的所有问题，并创建这些问题。然后是另一个嵌套的 while/for 循环，为每个问题生成匹配的答案。至于创建实际的每个测验页面，我有点迷茫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:51:25.940

您有一个页面（即`quiz.php`）并使用 GET 变量来获取您需要的数据。

不要预先生成页面，它通常过于复杂和冗余。

# jquery - 多个带有由回调创建的滚动按钮的 jCarousels。

> ID：12112641
> 
> 赞同：0
> 
> 时间：2012-08-24T15:46:52.950
> 
> 标签：jquery, jcarousel

我有一个页面，我正在尝试添加几个 jCarousel 元素。其中一个单独使用以下代码可以很好地工作：

```
function mycarousel_initCallback(carousel) {        
    jQuery('.next').bind('click', function() { carousel.next(); return false; });
    jQuery('.prev').bind('click', function() { carousel.prev(); return false; });
        };

// Load carousel...
jQuery(document).ready(function() {
jQuery(".featuredItems").jcarousel({
    scroll: 4,
    visible: 4,
    initCallback: mycarousel_initCallback,
    buttonNextHTML: null,
    buttonPrevHTML: null
  }); 
```

});

但是，如果我在一个页面上添加多个 - 前进/后退按钮控制所有轮播，而不仅仅是我想要的。我尝试过使用“this”来隔离我想要更改的轮播元素，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:44:20.503

我能够让这个工作的唯一方法是有一个单独命名的回调函数和不同命名的上一个和下一个按钮 div 类。

# wpf - Canvas ItemsControl 中的多个图像

> ID：12112647
> 
> 赞同：1
> 
> 时间：2012-08-24T15:47:22.410
> 
> 标签：wpf, xaml, itemscontrol

我想在画布上显示多个图像。我需要在画布中以不同的方式定位它们。我为我的图像做了一个类：

```
class MapItem:Image
{
  public int DistanceToTop { get; set; }
  public int DistanceToLeft { get; set; }
} 
```

我的 XAML 看起来像这样：

```
<UserControl.DataContext>
    <Map:MapViewModel/>
</UserControl.DataContext>

<ItemsControl ItemsSource="{Binding All}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Canvas />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemContainerStyle>
        <Style TargetType="Image">
            <Setter Property="Canvas.Left" Value="{Binding DistanceToLeft}" />
            <Setter Property="Canvas.Top" Value="{Binding DistanceToTop}" />
        </Style>
    </ItemsControl.ItemContainerStyle>
</ItemsControl> 
```

我的 ViewModel 用作 DataContext ：

```
class MapViewModel : ViewModelBase
{
  public ObservableCollection<MapItem> All   { get; set; }

  public MapViewModel()
  {
    All = new ObservableCollection<MapItem>();
    var wSource = new BitmapImage(new Uri(@"ImagePath"));
    var wImage = new MapItem { Source = wSource, DistanceToLeft = 20, DistanceToTop = 20 };
    test = wImage;
    All.Add(wImage);
  }
} 
```

为什么在 XAML 中我对 DistanceToLeft 和 DistanceToTop 的绑定不起作用？！？不是应该自动查看我 ObservableCollection 中使用的对象吗？

**编辑**：我仍然有我的问题。但现在我知道它与绑定有关。我正在尝试使用 GalaSoft 框架使用 MVVM 模式来实现所有这些。所以首先我将我的 DataContext 设置为我的 MapViewModel。为什么我不能从我的 ObservableCollection 访问 MapItem 的属性？

**编辑**：最后在 Clemens 和 Rachel 的帮助下，我完成了这个。

我的 MapItem 类：

```
class MapItem:Image
{
  public LatLon CoordMiddleOfImage { get; set; }
  public LatLon CoordTopLeftOfImage { get; set; }

  public int DistanceToTop
  {
    get { return (int) Canvas.GetTop(this); }
    set { Canvas.SetTop(this, value); }
  }

  public int DistanceToLeft
  {
    get { return (int)Canvas.GetLeft(this); }
    set { Canvas.SetLeft(this, value); }
  }

  public int ZOrder
  {
    get { return Panel.GetZIndex(this); }
    set { Panel.SetZIndex(this, value); }
  }
} 
```

我的 XAML 是这样的：

```
<ItemsControl ItemsSource="{Binding All}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Canvas ClipToBounds="True"  SnapsToDevicePixels="True"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

它现在就像一个魅力:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T17:16:46.663

我不太明白为什么你发明了`DistanceToLeft`and`DistanceToTop`属性，然后又在绑定中挣扎。如果您想将图像控件用作项目，为什么不直接应用附加属性`Canvas.Left`和`Canvas.Top`：

```
All = new ObservableCollection<Image>(); // no need for derived MapItem
var wSource = new BitmapImage(new Uri(@"ImagePath")); 
var wImage = new Image { Source = wSource }; 
Canvas.SetLeft(wImage, 20);
Canvas.SetTop(wImage, 20);
All.Add(wImage); 
```

因此，不需要样式：

```
<ItemsControl ItemsSource="{Binding All}">    
    <ItemsControl.ItemsPanel>    
        <ItemsPanelTemplate>    
            <Canvas />    
        </ItemsPanelTemplate>    
    </ItemsControl.ItemsPanel>    
</ItemsControl> 
```

* * *

但是，您应该考虑创建一个不是控件的真正 ViewModel 类，如下所示：

```
public class ImageItem
{
    public string Source { get; set; }
    public double Left { get; set; }
    public double Top { get; set; }
} 
```

使用它类似于您的 MapItem 类

```
All = new ObservableCollection<ImageItem>();
ImageItem image = new ImageItem { Source = @"ImagePath", Left = 20, Top = 20 };
All.Add(image); 
```

您现在可以像这样定义 ItemContainerStyle：

```
<ItemsControl.ItemContainerStyle>
    <!-- ContentPresenter is the default item container in ItemsControl -->
    <Style TargetType="ContentPresenter">
        <Setter Property="Canvas.Left" Value="{Binding Left}"/>
        <Setter Property="Canvas.Top" Value="{Binding Top}"/>
        <Setter Property="ContentTemplate">                        
            <Setter.Value>
                <DataTemplate>
                    <Image Source="{Binding Source}"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ItemsControl.ItemContainerStyle> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:06:52.673

An`ItemsControl`将每个项目包装在 a 中`ContentPresenter`，因此 in 中的样式`ItemContainerStyle`适用于`ContentPresenter`，而不是`Image`

如果你`TargetType="Image"`从你的风格中删除它应该可以正常工作

# c# - C# Excel - 不通过互操作发布 - 涉及宏和求解器

> ID：12112649
> 
> 赞同：0
> 
> 时间：2012-08-24T15:47:33.367
> 
> 标签：c#, excel, interop, excel-2010, excel-interop

啊，SO上的另一个“Excel未发布”帖子.....

我有一个 Excel 工作簿，我通过 Excel (2010) 加载，调用 Excel 应用程序的 Run 方法在工作簿中启动宏，保存更新的工作簿并退出 Excel。

即使在调用应用程序关闭后，Excel 也会保持不变。

我还没有落入“两个点”的陷阱，我关闭所有可以关闭的，退出所有可以退出的并释放对每个使用的 COM 对象的引用并给 GC 一个踢。

如果我不调用运行宏，一切都很好。所以关于这个特定宏的某些东西是有问题的，因为其他工作簿没有显示这种行为。

宏本身加载 Solver 加载项并对非 .NET win32 dll 中的 C++ 函数进行一些调用。它调用 Solver 加载项，并没有做任何不寻常的事情（数学、设置范围、设置单元格值等）。

我应该知道任何与求解器或宏相关的问题吗？我什至尝试从 C# 卸载加载项 - 不高兴。

```
 static void NAR(object o) // MSDN article suggestion.
    {
        try
        {
            while (System.Runtime.InteropServices.Marshal.ReleaseComObject(o) > 0)
            {
            }
        }
        catch
        {
            // swallow
        }
        finally
        {
            o = null;
        }
    }
    static void Excel(string FilePath, string SaveAsPath)
    {
        Application excelApplication = null;
        Workbooks workbooks = null;
        Workbook workbook = null;

        try
        {
            excelApplication = new Application { DisplayAlerts = false, Visible = false };
            workbooks = excelApplication.Workbooks;
            workbook = workbooks.Open(FilePath);

            excelApplication.Run("SolveEquationWithSolver");

            workbook.CheckCompatibility = false;
            workbook.SaveAs(SaveAsPath);
        }
        finally
        {
            if (workbook != null)
            {
                workbook.Close(Microsoft.Office.Interop.Excel.XlSaveAction.xlDoNotSaveChanges, Type.Missing, Type.Missing);
                NAR(workbook);
            }

            if (workbooks != null)
            {
                workbooks.Close();
                NAR(workbooks);
            }

            if (excelApplication != null)
            {
                excelApplication.Quit();
                NAR(excelApplication);
            }

            // Kick GC, as suggested elsewhere on SO. Not my idea.
            GC.Collect();
            GC.WaitForPendingFinalizers();

            // Double-tap GC, as suggested elsewhere on SO. Not my idea.
            GC.Collect();
            GC.WaitForPendingFinalizers();
        }
    } 
```

**更新**

另一个论坛建议使用`excelApplication.ActiveWindow.Close()`，这有效！（如果`workbook.Close()`呼叫被删除）。

然而，这打破了“两个点”的规则。那么，它在做什么意味着我们可以在这种情况下侥幸逃脱，但在一般情况下却不行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:59:18.993

我曾经遇到过与您类似的问题，最终放弃并决定杀死 Excel。如果在终止进程之前关闭所涉及的工作簿，则不应有任何烦人的副作用（例如下次打开 Excel 时“恢复”的工作簿）。

```
using System.Runtime.InteropServices;

// ...
// Inside a class:

[DllImport("user32.dll")]
private static extern uint GetWindowThreadProcessId(
    IntPtr hWnd, out uint lpdwProcessId);

// Returns "true" on success, "false" on failure.
public static bool KillExcel(Application excel) {
    uint processId;
    GetWindowThreadProcessId((IntPtr)excel.Hwnd, out processID);
    try {
        Process.GetProcessById((int)processID).Kill()

    } catch (Exception /* TODO: catch only relevant exceptions */) {
        return false;
    }

    return true;
} 
```

# mysql - bd 关系 MySQL

> ID：12112652
> 
> 赞同：0
> 
> 时间：2012-08-24T15:47:43.680
> 
> 标签：mysql, relationship

我有以下关系，

![在此处输入图像描述](../Images/dab72807912e47df3692ceedf585d0c3.png)

想知道我怎样才能让球队成为比赛的赢家？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:56:35.173

```
SELECT
  m.id_match,
  IF((id_home_team = ? AND score_home_team > score_away_team) OR
    (id_away_team = ? AND score_home_team < score_away_team), 1, 0) AS won
FROM matches m
  JOIN results r ON(r.id_match = m.id_match)
WHERE 
  id_home_team = ? OR id_away_team = ? 
```

将 替换为`?`您团队的 ID。

在[SQL 小提琴](http://sqlfiddle.com/#!2/6dc95/1)中。

# linux - 在 shell 脚本中访问两个不同的 Postgres 数据库时出现密码问题

> ID：12112654
> 
> 赞同：2
> 
> 时间：2012-08-24T15:47:50.423
> 
> 标签：linux, postgresql, shell, scripting, postgresql-9.1

我正在编写一个 shell 脚本，它将从一台服务器执行 pg_dump，然后它将转储恢复到另一台服务器上的数据库中。

要访问第一台服务器上的 Postgres 数据库，我使用 export PGPASSWORD 以避免出现密码提示。

当我在第二台服务器的 Postgres 数据库上执行还原时，系统会提示我输入用户密码。我尝试重新声明导出 PGPASSWORD（因为此数据库的密码不同），但这不起作用。我怀疑这与我必须加倍 SSH 跃点才能访问第二个数据库的事实有关：

```
export PGPASSWORD=******
perform pg_dump
...
export PGPASSWORD=********
cat out.sql | ssh -i .ssh/server1.pem root@dev.hostname.com "ssh -i .ssh/server2 \
0.0.0.0 psql -U postgres -h localhost -p 5432 DBNAME" 
```

上述结果：

```
Password for user postgres:
psql: FATAL:  password authentication failed for user "postgres" 
```

有没有人有什么建议？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T19:15:04.917

您可以在主目录中创建一个名为 .pgpass 的文件，并在此处提供密码详细信息：

像 ：

猫 .pgpass

# 主机名：端口：数据库：用户名：密码

本地主机：2323：test_db：test_user：test123**

试试这个。希望你的问题能得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:06:40.923

该`.ssh/environment`文件是您想要的。不过，我认为该文件需要在 server1 上，并且 server2 需要配置为允许用户修改他们的环境（通过`PermitUserEnvironment`选项。有关`man ssh`更多详细信息，请参见“环境”下。

# xcode - Xcode：有没有办法在界面生成器中更改行距（UI 标签）？

> ID：12112657
> 
> 赞同：11
> 
> 时间：2012-08-24T15:48:03.727
> 
> 标签：xcode, cocoa-touch, interface-builder, uilabel

我有几个带有多行文本的 UILabel，但行距比我希望的要大。有什么办法可以改变这个吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-10-23T10:30:55.660

hi this is a late reply but it may help some one line height can be change change the text from plain to attribute ![enter image description here](../Images/82a557a693d230390263cf8b6eb30ea2.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:19:12.627

从 iOS 6 开始，Apple 加入`NSAttributedString`了`UIKit`，使得可以`NSParagraphStyle`用来改变行距。

要真正从 NIB 更改它，[请参阅 souvickcse 的答案。](https://stackoverflow.com/a/19539209/456434)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-01T17:01:12.153

因为我讨厌在界面构建器中使用属性文本（我总是遇到 IB 错误），所以这里有一个扩展，允许您在界面构建器中直接将行高设置为 UILabel

```
extension UILabel {

    @IBInspectable
    var lineHeightMultiple: CGFloat {
        set{

            //get our existing style or make a new one
            let paragraphStyle: NSMutableParagraphStyle
            if let existingStyle = attributedText?.attribute(NSAttributedString.Key.paragraphStyle, at: 0, effectiveRange: .none) as? NSParagraphStyle, let mutableCopy = existingStyle.mutableCopy() as? NSMutableParagraphStyle  {
                paragraphStyle = mutableCopy
            } else {
                paragraphStyle = NSMutableParagraphStyle()
                paragraphStyle.lineSpacing = 1.0
                paragraphStyle.alignment = self.textAlignment
            }
            paragraphStyle.lineHeightMultiple = newValue

            //set our text from existing text
            let attrString = NSMutableAttributedString()
            if let text = self.text {
                attrString.append( NSMutableAttributedString(string: text))
                attrString.addAttribute(NSAttributedString.Key.font, value: self.font, range: NSMakeRange(0, attrString.length))
            }
            else if let attributedText = self.attributedText {
                attrString.append( attributedText)
            }

            //add our attributes and set the new text
            attrString.addAttribute(NSAttributedString.Key.paragraphStyle, value:paragraphStyle, range:NSMakeRange(0, attrString.length))
            self.attributedText = attrString
        }

        get {
            if let paragraphStyle = attributedText?.attribute(NSAttributedString.Key.paragraphStyle, at: 0, effectiveRange: .none) as? NSParagraphStyle {
                return paragraphStyle.lineHeightMultiple
            }
            return 0
        }
    } 
```

# javascript - 在jQuery中遍历表格元素

> ID：12112660
> 
> 赞同：3
> 
> 时间：2012-08-24T15:48:14.107
> 
> 标签：javascript, jquery, html, dom, dom-traversal

我有一个表结构：

```
<table id = "cust-id">
  <tr>
    <td> 1</td>
    <td id = "specific_id_re"><a href = "#">link tag</a></td>
  </tr>
  <tr>
    <td> 2 </td>
    <td id = "specific_id"> <a href = "#">link tag</a></td>
  </tr>
</table> 
```

我正在尝试使用 jquery 来访问具有 id 和 link 标签的每个表格行列，但我没有达到目标。我一直在做的最好的是：

```
 $('#cust-id').children().children().children() ; // to get access to the td elements ? 
```

关于我应该阅读什么或应该如何处理这个问题的任何建议？

谢谢帕里贾特·卡利亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:52:14.740

```
$('#cust-id td[id] a').each(function () {
  var td = $(this).closest('td');
  // do what you want
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:56:34.530

试试这个

```
$("#cust-id tr:has(td[id] a)"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:50:09.543

```
$('#cust-id td') 
```

将收集`td`元素下的所有元素`#cust-id`。您可以像在常规 CSS 中一样链接选择器。

如果您想要 a 的*行*父母，您可以从using`<td>`遍历回来`<td>`

```
$('#cust-id td').closest('tr') 
```

啊，你实际上只想要那些`<td>`有`<a>`和 的`id`，所以......

```
$('#cust-id td[id] a').closest('td') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:52:01.113

这将选择 2\. 列中的所有 TD 元素：

```
$( 'td:nth-child(2)', '#cust-id' ) 
```

这将选择所有具有“id”属性的 TD 元素：

```
$( 'td[id]', '#cust-id' ) 
```

这将选择包含一个元素的所有 TD 元素`<a>`：

```
$( 'td:has(a)', '#cust-id' ) 
```

因此，如果结合这些方法，您可以选择那些 (1) 具有“id”属性并且 (2) 包含元素的 TD`<a>`元素：

```
$( 'td[id]:has(a)', '#cust-id' ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T15:52:04.927

您可以使用以下选择器 $('#cust-id td[id]') 这将返回所有具有 id 属性的 td 元素。

# twitter - Twitter 按钮替换 Internet Explorer 8 中页面上的每个链接

> ID：12112669
> 
> 赞同：1
> 
> 时间：2012-08-24T15:48:33.407
> 
> 标签：twitter

Twitter 按钮正在替换 Internet Explorer 8 中页面上的每个链接

我刚刚从 Twitter 复制并粘贴了代码。

它只在 IE8 中执行，但是，在其他浏览器中，它显示按钮计数为#undefined，尽管它可以工作。

它必须与其他 javascript 文件发生冲突。我只是想看看其他人以前是否遇到过这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:08:14.277

可悲的是，这是一个 Twitter 问题，您可以在此处关注更新：[https ://dev.twitter.com/issues/486](https://dev.twitter.com/issues/486)

# jquery - jQuery glDatePicker 插件输入带有数组注释的名称

> ID：12112673
> 
> 赞同：0
> 
> 时间：2012-08-24T15:48:43.883
> 
> 标签：jquery, jquery-ui

我在数组中有一系列输入：

```
<input type="text" name="date_from[]" class="date_picker" ... /> 
```

我在表格的其余部分中引入了[gLDatepicker](http://code.gautamlad.com/glDatePicker/)，但它似乎因包含数组表示法而中断。

有什么方法可以替代这个或不同的 jQuery 日期选择器吗？

Javascript启动：

```
$(".date_picker").glDatePicker(
    {
        allowOld: true,
        onChange: function(target, newDate){
            target.val
            (
            newDate.getDate()+"-"+(newDate.getMonth() + 1)+"-"+newDate.getFullYear()

        );
        }
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T02:52:19.170

我是 glDatePicker 的作者。

我不确定您使用的版本中 glDatePicker 的问题是什么，但在最新版本（v2.0，今天发布）中，我没有看到问题。

我在这里测试过：http: [//jsfiddle.net/cfRG2/](http://jsfiddle.net/cfRG2/)

新代码如下所示：

```
$(window).ready(function()
{
    $(".date_picker").glDatePicker(
    {
        showAlways: true,
        selectableDateRange: [
            { from: new Date(2013, 0, 1),
                to: new Date(2015, 11, 31) },
        ],
        selectableYears: [2013, 2014, 2015],
        onClick: function(el, cell, date, data) {
            el.val
            (
                date.getDate()+"-"+(date.getMonth() + 1)+"-"+date.getFullYear()
            );
        }
    });
});​ 
```

另外，请注意，2.0 版中的一些（很多？）事情发生了变化。关于您使用的一些选项，allowOld 不再可用，onChange 已更改为 onClick。您可以解决这个问题，如上面的 jsfiddle 示例所示。

您可以在此处阅读有关更改的更多信息并查看完整示例：http: [//glad.github.com/glDatePicker](http://glad.github.com/glDatePicker)

祝你好运，如果您有任何其他问题，请告诉我！

# matlab - 在 MatLab 中查找 2D 矩阵的每行排序索引并填充一个新矩阵

> ID：12112677
> 
> 赞同：1
> 
> 时间：2012-08-24T15:48:56.540
> 
> 标签：matlab, sorting, matrix, indexing, populate

我有一个挑战来订购我的矩阵。提供的功能`sortrows`以相反的方式工作......

取这个二维矩阵

```
M =
     40    45    68
     50    65    58
     60    55    48
     57    67    44    
                      , 
```

目标是找到`O`指示每行排序索引（等级）的矩阵，即：

```
O =

     1     2     3
     1     3     2
     3     2     1
     2     3     1
                       . 
```

所以对于第二行`50`是最小的元素 (1)，`65`最大的 (3)，并且`58`是第二大的 (2)，因此是行向量`[1 3 2]`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:53:15.120

```
[~,sorted_inds] = sort(M,2); 
```

会做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:59:14.190

我认为您正在寻找常规`sort`函数的第二个输出：

```
[~,I] = sort(M,2) 
```

此语法抑制实际的排序矩阵`Msorted`，并返回索引`I`，使得

```
for j = 1:n, Msorted(j,:) = M(I(j,:),j); end 
```

键入`doc sort`以获取更多信息。

# symfony - symfony2 FosUserBundle 自定义移动视图

> ID：12112681
> 
> 赞同：0
> 
> 时间：2012-08-24T15:49:22.550
> 
> 标签：symfony, fosuserbundle

你好，

我有一个为浏览器和手机提供两个版本的网站。

我使用提供视图的 FOSUserBundle。我想为我的应用程序的移动版本自定义这些视图，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:04:33.770

**FOSUserBundle**与为浏览器和手机提供两个版本无关。

为此，您必须使用**CSS**。这是一个[例子](http://www.seabreezecomputers.com/tips/mobile-css.htm)，可能不是最好的，但这会给你一个关于如何做到这一点的指示。您可以使用[javascript 重定向](http://css-tricks.com/snippets/javascript/redirect-mobile-devices/)，将您的移动用户重定向到适当的模板。

# ruby-on-rails-3.1 - 为什么 ajax:success 仅适用于整个应用程序的 1 个特定页面？

> ID：12112685
> 
> 赞同：1
> 
> 时间：2012-08-24T15:49:37.960
> 
> 标签：ruby-on-rails-3.1

我有这个代码来清除一个非常简单的表格。该`ajax:success`事件的回调仅适用于 1 页。如果我在任何位置，例如`/lists/:id`代码运行良好，即使这是全球性的，它也不会在任何其他页面上运行

```
 $('#add_task_form').on "ajax:success", ->
    $('#add_task_title').focus().val ''
    $('#add_task_estimate').val '' 
```

创建的部分渲染很好，但是这个代码永远不会被触发，我想知道为什么？

# c# - 如何通过 xpath 获取内容

> ID：12112687
> 
> 赞同：0
> 
> 时间：2012-08-24T15:49:44.247
> 
> 标签：c#, xpath, html-agility-pack

在我的网页上

```
<meta name="description" content="Learn about 94.100.179.159" /> 
```

我怎样才能通过 Xpath 或 HtmlAgilityPack 获得确切的文本“了解 94.100.179.159”

我试过了

```
HtmlWeb hwObject = new HtmlWeb();
            HtmlDocument htmldocObject = hwObject.Load("http://whois.domaintools.com/94.100.179.159");
            foreach (HtmlNode link in htmldocObject.DocumentNode.SelectNodes("//meta"))
            {
                string s = link.InnerText;
                Console.WriteLine(s);

            }
            Console.ReadLine(); 
```

但这给了我不想要的，如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T15:54:14.850

```
//meta[@name = 'description']/@content 
```

是您指定的属性的 XPATH

```
string s = link.Value; 
```

应该返回属性内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T15:55:13.407

选择节点如下

```
SelectNodes("//*[local-name()='meta')]")) 
```

然后，对于每个`HtmlNode`，

```
Console.WriteLine(link.Attributes["content"].Value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T16:03:33.027

元标签没有任何内部文本，它们有属性。

试试这个：

```
HtmlWeb hwObject = new HtmlWeb();
HtmlDocument htmldocObject = hwObject.Load("http://whois.domaintools.com/94.100.179.159");
foreach (HtmlNode link in htmldocObject.DocumentNode.SelectNodes("//meta"))
{
    Console.WriteLine("-META-");
    var attribDump=link.Attributes.Select(a=>a.Name+" : "+a.Value);
    foreach (var x in attribDump)
    {
        Console.WriteLine(x);
    }
} 
```

# java - DocumentListener 在 JTextField.setText() 中出现问题

> ID：12112694
> 
> 赞同：2
> 
> 时间：2012-08-24T15:50:18.707
> 
> 标签：java, swing, user-interface, jcombobox, jtextfield

请查看以下 3 组课程。请注意，仅显示相关代码，而删除了其余大部分代码。

**CommonGUI.java**

```
package normal;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import javax.swing.*;
import javax.swing.text.AbstractDocument;

public class CommonGUI extends JPanel
{
    protected JLabel name, mobileNumber1, mobileNumber2, address, landNumber1, landNumber2,  nickName, email, category;
    protected JTextField nameTxt, mobileNumber1Txt, mobileNumber2Txt, landNumber1Txt, landNumber2Txt, nickNameTxt, emailTxt, categoryTxt;

    protected JTextArea addressTxt;
    protected JScrollPane scroll;    

    protected JComboBox categoryCombo;        

    public CommonGUI()
    {
        //Intializing the instance variables
        name = new JLabel("Name: ");
        mobileNumber1 = new JLabel("Mobile Number 1:");
        mobileNumber2 = new JLabel("Mobile Number 2: ");
        address = new JLabel("Address: ");
        landNumber1 = new JLabel("Land Number 1: ");
        landNumber2 = new JLabel("Land Number 2: ");       
        nickName = new JLabel("Nick Name: ");
        email = new JLabel("Email: ");        
        category = new JLabel("Category: ");

        nameTxt = new JTextField(10);
        mobileNumber1Txt = new JTextField(10);
        mobileNumber2Txt = new JTextField(10);
        addressTxt = new JTextArea(5,20);
        landNumber1Txt = new JTextField(10);
        landNumber2Txt = new JTextField(10);
        categoryTxt = new JTextField();
        nickNameTxt = new JTextField(10);
        emailTxt = new JTextField(10);       

        categoryCombo = new JComboBox();           

        //Adding document listeners to text fields

        AbstractDocument[]d = new AbstractDocument[8];
         d[0] = (AbstractDocument) nameTxt.getDocument();
         d[1] = (AbstractDocument) mobileNumber1Txt.getDocument();
         d[2] = (AbstractDocument) mobileNumber2Txt.getDocument();
         d[3] = (AbstractDocument) addressTxt.getDocument();
         d[4] = (AbstractDocument) landNumber1Txt.getDocument();
         d[5] = (AbstractDocument) landNumber2Txt.getDocument();
         d[6] = (AbstractDocument) categoryTxt.getDocument();
         d[7] = (AbstractDocument) nickNameTxt.getDocument();

         d[0].setDocumentFilter(new TextFieldValidator(nameTxt,20));
         d[1].setDocumentFilter(new TextFieldValidator(mobileNumber1Txt,10));
         d[2].setDocumentFilter(new TextFieldValidator(mobileNumber2Txt,10));
         d[3].setDocumentFilter(new TextFieldValidator(addressTxt,100));
         d[4].setDocumentFilter(new TextFieldValidator(landNumber1Txt,10));
         d[5].setDocumentFilter(new TextFieldValidator(landNumber2Txt,10));
         d[6].setDocumentFilter(new TextFieldValidator(categoryTxt,20));
         d[7].setDocumentFilter(new TextFieldValidator(nickNameTxt,20)); 
    }

} 
```

UpdateDeleteForm.java

```
//Following class get fired when an "category" is selected from the JComboBox. Rest of the code is ommited

    private class DetailsLoader implements ItemListener
        {
            public void itemStateChanged(ItemEvent ie)
            {
                if(ie.getStateChange()==ItemEvent.SELECTED)
                {
                    List details = new ArrayList();

                    if(nameTxtCombo.getSelectedItem().toString() != "Select a Name")
                    {
                    details = dateBaseConnector.getDetails(nameTxtCombo.getSelectedItem().toString());

                    String address = (String)details.get(6);

                    idTxt.setText(String.valueOf(details.get(0)));
                    nameTxt.setText((String)details.get(1));                    
                    mobileNumber1Txt.setText(String.valueOf(details.get(2)));
                    mobileNumber2Txt.setText(String.valueOf(details.get(3)));
                    landNumber1Txt.setText(String.valueOf(details.get(4)));
                    landNumber2Txt.setText(String.valueOf(details.get(5)));
                    addressTxt.setText(address.trim());
                    //categoryCombo.setSelectedItem((String)details.get(7));
                    nickNameTxt.setText((String)details.get(8));
                    emailTxt.setText((String)details.get(9));

                    }

                }
            }
        } 
```

**TextFieldValidator.java**

```
package normal;

import java.awt.event.*;
import java.awt.*;
import javax.swing.*;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;
import javax.swing.text.JTextComponent;

public class TextFieldValidator extends DocumentFilter
{
    private JTextComponent textField;
    private int numberOfLetters;

    public TextFieldValidator(JTextComponent text, int i)
    {
        textField = text;
        numberOfLetters = i;
    }

    @Override
    public void insertString(FilterBypass fb, int offset, String string, AttributeSet attr)  throws BadLocationException
    {
        if(fb.getDocument().getLength()+string.length()>numberOfLetters)
        {
            return;
        }

        super.insertString(fb, offset, string, attr);
    }

    @Override
    public void remove(FilterBypass fb, int offset, int length) throws BadLocationException
    {
        fb.remove(offset, length);
    }

    @Override
    public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs) throws BadLocationException
    {
        if(fb.getDocument().getLength()+text.length()>numberOfLetters)
        {
            return;
        }

        super.insertString(fb, offset, text, attrs);
    }
} 
```

现在，当我选择一个类别时，它会根据类别中选择的项目填充其他文本字段。但是，当我添加 documentListener 以添加验证时，setText() 方法的行为异常。这意味着想象一下，

1.  第一次 - 从类别中选择“大学”。它将 nameTxt 框填充为“Yohan”

2.  第二次 - 现在您需要查看另一个，从类别中选择“学院”。现在，它应该在 nameTxt 中显示“Brian”，但除此之外，它显示的是“Brian Yohan”。嗯..“Yohan”尚未从文本字段中删除！

当我从验证中删除 documentListener 时，一切正常，没有错误。所以，我相信这是我与 documentListener 相关的事情。请帮忙！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T16:25:46.467

问题是你的`replace`方法：

```
 @Override
    public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs) throws BadLocationException
    {
        if(fb.getDocument().getLength()+text.length()>numberOfLetters)
        {
            return;
        }

        super.insertString(fb, offset, text, attrs);
    } 
```

你在`super.insertString`这里打电话而不是打电话`super.replace`。您的`setText`调用将调用此`replace`方法并最终插入文本而不是替换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:28:23.630

> 当我从验证中删除 documentListener 时，一切正常，没有错误。所以，我相信这是我与 documentListener 相关的事情

1.  我看不出有什么理由一起使用`Documentistener`，`DocumentFilter`因为两者（一起）都可以触发无尽的和相同的（类似的）事件，然后其中一个调用第二个

2.  基本的东西：

    *   `Document`是`Model`为`JTextComponent`s

    *   `DocumentListener`被指定用于从`JTextComponent`外部输出

    *   `DocumentFilter`用于过滤`Char(s)`输入或插入的不需要的内容`System Clipboard`，`JTextComponents`您可以在插入或输入后创建一个简单的输出`Document`到方法或 GUI 的其余部分`Char(s`）传递

3.  为了获得更好的帮助，请尽快发布[SSCCE](http://sscce.org/)并详细描述您的预期事件，`JComboBox`以及`JTextField`/或反之亦然

# haskell - 控制重新导出函数的记录类型签名

> ID：12112698
> 
> 赞同：5
> 
> 时间：2012-08-24T15:50:28.447
> 
> 标签：haskell, module, export, ghci, haddock

假设有一个`Foo`不受我控制的库模块：

```
module Foo (Foo, thing) where
data Foo = Foo Int
thing :: Foo
thing = Foo 3 
```

`thing`现在假设我有自己的库模块，它从模块中重新导出`Foo`。

```
module Bar (Foo.thing, getBar) where
import qualified Foo
type Bar = Foo.Foo
getBar :: Bar -> Int
getBar (Foo i) = i 
```

出于兼容性原因，我*不想*导出不同的`thing`. 我想确保我 export `Foo.thing`，这样如果用户同时导入`Foo`和`Bar`模块，它们将得到相同的结果`thing`并且不会发生名称冲突。

现在假设我们有第三个模块使用`Bar`.

```
module Main where
import Bar 
```

让我们将第三个加载到 ghci 中。

```
[1 of 3] Compiling Foo              ( Foo.hs, interpreted )
[2 of 3] Compiling Bar              ( Bar.hs, interpreted )
[3 of 3] Compiling Main             ( test.hs, interpreted )
Ok, modules loaded: Main, Bar, Foo.
ghci> :t thing
thing :: Foo.Foo
ghci> :t getBar
getBar :: Bar -> Int
ghci> getBar thing
3
ghci> :info Bar
type Bar = Foo.Foo  -- Defined at Bar.hs:3:6-8 
```

而不是 ghci 和黑线鳕表明`thing`在 module`Bar`有 type `Foo.Foo`，我希望它声明`thing`有 type `Bar`。有没有办法在不导出不同的情况下实现这一点`thing`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T22:03:57.347

除非我听到相反的证据，否则答案似乎是：**你不能**。

# javascript - 制作基本日期（技术）

> ID：12112700
> 
> 赞同：1
> 
> 时间：2012-08-24T15:50:36.813
> 
> 标签：javascript, html, css, date

没有查询！我有一个下拉菜单，用户可以在其中选择日期月份和年份。我创建以下代码并使用 setFullYear 将这些值传递给变量。有时我也会在这个变量中添加天数，这是变量 ev_num 的用途。当我把它写到页面上时，它会显示很多不必要的信息......

2011 年 1 月 1 日星期六 11:44:26 GMT-0500（东部标准时间）

我希望它简单地阅读“2011 年 1 月 1 日”或类似的内容。有谁知道我将如何解决这个问题。这是整个页面的 jsfiddle... [http://jsfiddle.net/fET6v/](http://jsfiddle.net/fET6v/)

```
var myDate=new Date();
var ev_num = parseInt(document.getElementById("leave").value)
myDate.setFullYear(sel_year.value,sel_month.value,sel_day.value);
var event_value = document.getElementById("leave").value; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:55:11.690

如果您不希望出现时间和时区，请使用[`.toDateString`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toDateString)而不是简单的`toString`. 如果您想要自定义格式，则需要自己构建字符串，您可以使用[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象中的相应方法获取单个年/月/日值。有一些（可搜索的）库可以做到这一点，您的案例的单一方法是

```
function myDateString(date) {
    return ["Jan","Feb","Mar", …][date.getMonth()] +
           " "+("0"+date.getDate()).substr(-2) +
           " "+date.getFullYear();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:09:06.063

```
var d = new Date();
var day = d.getDate();
var year = d.getFullYear();
var month = d.getMonth();
var months=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct"," Nov","Dec"];
var currentMonth = months[month];
document.write(currentMonth + " " + day + " " + year); 
```

这将打印带有缩写月份的今天日期。它是完全可定制的。

[http://jsfiddle.net/iansan5653/u7hkE/](http://jsfiddle.net/iansan5653/u7hkE/)

编辑：请参阅此演示以获取日期前的前导零：http: [//jsfiddle.net/iansan5653/u7hkE/1/](http://jsfiddle.net/iansan5653/u7hkE/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T16:01:31.753

[http://blog.stevenlevithan.com/archives/date-time-format](http://blog.stevenlevithan.com/archives/date-time-format)

# php - 动态添加使用 jQuery 使用复选框来形成？

> ID：12112701
> 
> 赞同：0
> 
> 时间：2012-08-24T15:50:41.593
> 
> 标签：php, jquery, paypal

我有一个网站，人们可以在上面预订课程和研讨会。他们可以通过贝宝付款，但目前当他们去结账时，它会询问他们所有的预订，如果他们有不止一个需要支付。

这是使用一个简单的`while`循环来完成的，该循环显示指定客户 ID 的所有预订。

但是，根据课程的开始日期等，并非所有课程都必须立即付款，因此我想让客户选择他们想要支付的预订。

在这样做时，我想知道是否有一种方法可以使用页面上给出的复选框来动态地将字段添加到表单（在它转到贝宝之前），以决定客户希望支付哪些预订。

一个例子是[www.peaknature.co.uk/payment-example.php](http://www.peaknature.co.uk/payment-example.php)

任何帮助将不胜感激。

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:57:58.403

是的，您可以使用 jQuery 的 .append() 函数：http: [//api.jquery.com/append/](http://api.jquery.com/append/)

这是一个如何使用它的示例：http: [//papermashup.com/dynamically-add-form-inputs-and-submit-using-jquery/](http://papermashup.com/dynamically-add-form-inputs-and-submit-using-jquery/)

# php - 替代 in_array 或 if 语句中的多个 OR

> ID：12112703
> 
> 赞同：0
> 
> 时间：2012-08-24T15:50:48.320
> 
> 标签：php, optimization, if-statement

所以，正如标题所说......任何替代方案：

```
$valid_times = array('ever', 'today', 'week', 'month');
if (($this->_time == 'ever') OR ($this->_time == 'day')) 
```

或者

```
if (in_array($this->_time, $valid_times)) 
```

??

注意：我知道上面提到的工作，但我只是在寻找新的东西来学习和试验

## 更新

感谢您提供信息，但我没有提到`switch()`替代方案，因为我的代码并非如此。它必须是一个 if 语句，我想知道是否存在类似：

```
if($this->_time == (('ever') OR ('day') OR ('month'))) 
```

你怎么看？如果上面提到，那将是第一种方式的较短方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:05:35.223

关于什么 ？

```
$a1 = array("one","two","three");
$found = "two";
$notFound = "four";

if (count(array_diff($a1,array($found))) != count($a1))
/* Found */ 
```

要么你可以使用

```
$found = array("one","three");

if (count(array_diff($a1,$found)) != count($a1));
/* Either one OR three */ 
```

[http://codepad.org/FvXueJkE](http://codepad.org/FvXueJkE)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:56:49.240

[编辑] 删除原始答案，因为您现在已指定不想使用`switch`.

在您更新的问题中，您询问是否可以这样做：

```
if($this->_time == (('ever') OR ('day') OR ('month'))) 
```

直接的答案是“不，不在 PHP 中”。您将得到的最接近的是`in_array()`，数组值位于同一行代码中：

```
if(in_array($this->_time, array('ever','day','month')) 
```

PHP 5.4 有一个更新，允许使用更短的数组语法，这意味着您可以删除单词`array`，这使其更具可读性：

```
if(in_array($this->_time, ['ever','day','month']) 
```

但这仍然是一个`in_array()`电话。你无法解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T15:57:31.640

我能想到的唯一选择是使用正则表达式。

```
$valid_times = array('ever','day','week','hour');

if(preg_match('/' . implode('|', $valid_times) . '/i', $this->_time)){
    // match found
} else {
    // match not found
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T16:17:16.770

令人费解，但它是另一种选择

```
$input = 'day';
$validValues = array('ever','day');
$result = array_reduce($validValues,
                       function($retVal,$testValue) use($input) {
                           return $retVal || ($testValue == $input);
                       },
                       FALSE
                      );
var_dump($result); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-24T15:56:17.377

有时像 in_array 这样的？

```
$arr = array(1, 2, 'test');
$myVar = 2;

function my_in_array($val, $arr){
    foreach($arr as $arrVal){
        if($arrVal == $val){
            return true;
        }
    }
    return false;
}

if(my_in_array($myVar, $arr)){
    echo 'Found!';
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-24T15:56:24.967

您也可以使用 switch 语句。

```
switch ($this->_time) {
  case 'ever':
  case 'day':
    //code
    break;
  default:
    //something else
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-22T20:46:12.217

为了科学起见，事实证明您可以`yield`在三元运算符中使用，因此您可以将一些复杂的评估放在匿名生成器中，并让它在第一个评估为 true 的情况下产生，而无需全部评估：

```
$time = 'today';
if( (function()use($time){
    $time == 'ever' ? yield true:null;
    $time == 'today' ? yield true:null;
    $time == 't'.'o'.'d'.'a'.'y' ? yield true:null;
})()->current() ){
    echo 'valid';
} 
```

在这种情况下，它会在`'valid'`不评估连接的情况下回显。

# vlc - 如何通过live555 linux流Udp组播，然后打开VLC读取的rtsp网络流

> ID：12112705
> 
> 赞同：1
> 
> 时间：2012-08-24T15:51:01.633
> 
> 标签：vlc, live555

我正在尝试设置一个网络，我正在使用 live555 阅读广播，然后尝试发送一个 RTSP 服务器，我正在阅读网站上的教程，但找不到我做错了什么。我的过程是我通过 VLC 打开一个流网络以将 udp 流式传输到 live555 正在侦听的端口然后我为 live555 打开 testOnDemandRTSPServer 然后从另一个 VLC 打开一个网络流以侦听 rtsp 流但没有任何人得到任何输出知道我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:37:56.203

我发现问题是我使用的是虚拟机并且网络设置错误并且不得不禁用某些东西，我还将 testOnDemandRTSPServer.cpp 中的代码更改为第 340 行并将 inputStreamIsRawUDP 更改为 True

# github - GiHub 最受关注的仓库

> ID：12112710
> 
> 赞同：0
> 
> 时间：2012-08-24T15:51:13.383
> 
> 标签：github, github-api

我可以使用此 URL 获取 GitHub 上最受关注的存储库列表

[https://github.com/languages/Ruby/most_watched](https://github.com/languages/Ruby/most_watched)

但是只有 10 个页面和 500 个存储库。我可以获得更多观看的存储库吗？

我试图在 GitHub API 中找到这样做的方法，但我没有找到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T12:20:56.963

使用 GitHub API 的搜索部分 - [http://developer.github.com/v3/search/#search-repositories](http://developer.github.com/v3/search/#search-repositories)

搜索所有 Ruby 存储库（注意语言参数）并提取每个存储库的观察者数量。由于存储库不会按观察者的数量排序，因此您必须遍历所有存储库并在之后进行排序。这可能需要一些时间（取决于存储库的数量），但是因为您可能不会经常进行此搜索——我认为这是可以接受的。

# android - 如何从 BaseAdapter 类获取浮点值到调用 BaseAdapter 的活动

> ID：12112711
> 
> 赞同：0
> 
> 时间：2012-08-24T15:51:17.900
> 
> 标签：android

我正在开发一个应用程序，我将 fooditem、foodtype 和 foodcost 插入数据库。

而且我可以使用 BaseAdapter 在列表视图中显示所有这些。到目前为止，它工作正常。我想在我的 Activity 类中声明的 Textview 中设置 foodcost 的总和。但我得到的食品成本总和等于 0.0。我在 BaseAdapter 类中计算。

我的 Activity 和 BaseAdapter 代码如图所示。

```
 public class ViewList extends Activity {
        private List<DataArray> list; 
    Context mContext;
public TextView sum;
private ViewAdapter mViewAdapter;

    @Override
     protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
     mContext= this.getApplicationContext();
     Intent mIntent= getIntent();
     int DMY=(int) mIntent.getIntExtra("DMY",1111);
     String TYPE=mIntent.getStringExtra("TYPE");
     switch(DMY){
     case 000:
         list=makeQuery(null,null,null,TYPE,DMY);
         break;
     case 001:
         String YEAR=mIntent.getStringExtra("YEAR");
         list=makeQuery(null,null,YEAR,TYPE,DMY);
         break;
    case  011:
         String YEAR1=mIntent.getStringExtra("YEAR");
         String MONTH=mIntent.getStringExtra("MONTH");
         list=makeQuery(null,MONTH,YEAR1,TYPE,DMY);
        break;
    case 111:
         String YEAR2=mIntent.getStringExtra("YEAR");
         String MONTH1=mIntent.getStringExtra("MONTH");
         String DATE=mIntent.getStringExtra("DATE");
         list=makeQuery(DATE,MONTH1,YEAR2,TYPE,DMY);
        break;
        default:
    }

    if(!list.isEmpty()){
        setContentView(R.layout.view_list);
        ListView mListViw = (ListView) findViewById(R.id.listView_expenditure);
        sum= (TextView)findViewById(R.id.textView_sum);
        mViewAdapter= new ViewAdapter(ViewList.this,list);
        mListViw.setAdapter(mViewAdapter);
       // I am calling getsumTotal() method to get sum of foodcost. but its return 0.0
                    sum.setText(String.valueOf(mViewAdapter.getSunTotal()));

    }else{
        ShowDialog("No record(s) found in Database");
    }

} 
```

BaseAdapter 类。

```
public class ViewAdapter extends BaseAdapter {
    public  float sunTotal=0;
    private static LayoutInflater mInflater;

    private List<DataArray> list;
    private DataArray myDataArray;
     private Activity mActivity;
    public ViewAdapter(Activity mActivity, List<DataArray> list) {
    // TODO Auto-generated constructor stub
    this.list=list;
    mInflater=(LayoutInflater)mActivity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}

    @Override
    public int getCount() {
    // TODO Auto-generated method stub
    return list.size();
    }

    @Override
    public Object getItem(int position) {
    // TODO Auto-generated method stub
    return position;
    }

    @Override
     public long getItemId(int position) {
    // TODO Auto-generated method stub
    return position;
     }

     @Override
     public View getView(int position, View convertView, ViewGroup parent) {
     // TODO Auto-generated method stub
     View mView=convertView;
     if(convertView==null)
     mView=mInflater.inflate(R.layout.view_helper,parent,false);
     myDataArray=list.get(position);    
     TextView itemName = (TextView) mView.findViewById(R.id.textView_item_name);
     itemName.setText(myDataArray.getItem());
     TextView itemprice = (TextView) mView.findViewById(R.id.textView_price);
     String price=myDataArray.getCost();
      itemprice.setText(price);
      float mFloat = Float.parseFloat(price);
      sunTotal=sunTotal+mFloat;// calculating sum  of foodcost.
       Log.d("Sum",""+sunTotal);
      TextView itemDate = (TextView) mView.findViewById(R.id.textView_date);
       String date=myDataArray.getDate()+" "+myDataArray.getMonth();
      itemDate.setText(date);
       return mView ;
   }
      // get method to get the total of foodcost.which i have used in activity class to get the total foodcost
    public float getSunTotal() {
    return sunTotal;
   } 
```

}

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T17:00:08.557

或许你会在Adapter Class中添加一个getArray()方法从Adapter中获取Data，并在Activity中计算数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:04:15.200

您可以使用 将`LocalBroadcastManager`事件从您的适配器广播到您的活动：

[http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)

# php - 页面上有多个自定义帖子循环

> ID：12112718
> 
> 赞同：0
> 
> 时间：2012-08-24T15:51:48.643
> 
> 标签：php, wordpress

在显示第一个循环后，我无法显示第二个或第三个循环。在过去的两个小时里，我一直在尝试不同的事情，但我的想法已经不多了。

这就是我现在所拥有的——

```
<?php
$type = 'new_trucks';
$args=array(
 'orderby' => 'rand',
 'post_type' => $type,
 'paged' => $paged,
 'posts_per_page' => 3,
);

$wp_query = null;
$wp_query = new WP_Query();
$wp_query->query($args);
?>

<?php while (have_posts()) : the_post(); ?>
...
<?php endwhile; /* End loop */ ?>
<?php wp_reset_query(); ?> 
```

第二个循环就像这样，就在上面显示的第一个循环的正下方......

```
<?php
$type = 'used_trucks';
$args=array(
 'orderby' => 'rand',
 'post_type' => $type,
 'paged' => $paged,
 'posts_per_page' => 3,
);

$wp_query = null;
$wp_query = new WP_Query();
$wp_query->query($args);
?>

<?php while (have_posts()) : the_post(); ?>
...
<?php endwhile; /* End loop */ ?>
<?php wp_reset_query(); ?> 
```

在我尝试用不同的类型集在同一页面中复制它时，第二个循环根本没有显示。如果我删除第一个循环，它会起作用。我希望有人可以提供一些指导。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:08:24.470

```
<?php
$type = 'new_trucks';
$args=array(
 'orderby' => 'rand',
 'post_type' => $type,
 'paged' => $paged,
 'posts_per_page' => 3,
);

$wp_query = null;
$wp_query = new WP_Query($args);

?>

<?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
...
<?php endwhile; /* End loop */ ?>
<?php wp_reset_query(); ?> 
```

这就是我过去的做法

# zend-framework - 未找到 Zend_Db_Table 关系文件或类

> ID：12112725
> 
> 赞同：2
> 
> 时间：2012-08-24T15:52:15.170
> 
> 标签：zend-framework

我有两个表，每个表都有 Class Albums 和 Category 如下：

```
class Application_Model_DbTable_Albums extends Zend_Db_Table_Abstract
{

    protected $_name = 'albums';
    private $_custom_message = '';

    protected $_referenceMap = array(
        'CategoryTypes' => array(
            'columns' => array('category_id'),
            'refTableClass' => 'Category',
            'refColumns' => array('id')
        )
    );
}

class Application_Model_DbTable_Category extends Zend_Db_Table_Abstract {

protected $_name = 'category';

protected $_dependentTables = array('Albums');
} 
```

在我的 IndexController 编辑操作中，我有以下代码：

```
$category = new Application_Model_DbTable_Category();

$cat_id = $category->find(1);
$cat_3 = $cat_id->current();

$user_cat = $cat_3->findDependentRowset('Albums'); 
```

我得到这个异常消息。注释掉 $user_cat 不会得到异常消息

```
Exception information:

Message: File "Albums.php" does not exist or class "Albums" was not found in the file
Stack trace:

#0 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Db\Table\Row\Abstract.php(872): Zend_Db_Table_Row_Abstract->_getTableFromString('Albums')
#1 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\application\controllers\IndexController.php(187): Zend_Db_Table_Row_Abstract->findDependentRowset('Albums')
#2 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Controller\Action.php(516): IndexController->editAction()
#3 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Controller\Dispatcher\Standard.php(295): Zend_Controller_Action->dispatch('editAction')
#4 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Controller\Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#5 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Application\Bootstrap\Bootstrap.php(97): Zend_Controller_Front->dispatch()
#6 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\library\Zend\Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#7 C:\Program Files\Zend\Apache2\htdocs\zf-tutorial\public\index.php(49): Zend_Application->run()
#8 {main} 
```

我的相册课程在那里，但不知道为什么它说找不到课程或文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T07:13:02.190

first this is incorrect:

```
protected $_referenceMap = array(
        'CategoryTypes' => array(
            'columns' => array('category_id'),
            'refTableClass' => 'Category',
            'refColumns' => array('id')
        )
    ); 
```

refTableClass needs the whole classname, not the file name:

```
protected $_referenceMap = array(
        'CategoryTypes' => array(
            'columns' => array('category_id'),
            'refTableClass' => 'Application_Model_DbTable_Category',
            'refColumns' => array('id')
        )
    ); 
```

The same holds true for dependentTables:

```
protected $_dependentTables = array('Application_Model_DbTable_Albums');
} 
```

and make doubly sure that the value of the `$_name` property always is exactly the same as the name of the table the class represents.

**[EDIT]**

```
$category = new Application_Model_DbTable_Category();

$cat_id = $category->find(1);
$cat_3 = $cat_id->current();
//try
$user_cat = $cat_3->findDependentRowset();
//or
$user_cat = $cat_3->findDependentRowset('Application_Model_DbTable_Albums');
//or
$user_cat = $cat_3->findDependentRowset(new Application_Model_DbTable_Albums()); 
```

# mysql - 非 Wordpress 目录不起作用

> ID：12112727
> 
> 赞同：0
> 
> 时间：2012-08-24T15:52:22.790
> 
> 标签：mysql, wordpress, .htaccess

所以，我在我的服务器上安装了 Wordpress，带有 WP 默认的 .htaccess 重写规则，但是，我有一个目录，上面有一个完整的应用程序，运行一个我需要用户能够访问的数据库。我的问题是，每当我进入该目录时，Wordpress 都会将其读取为在 Wordpress 数据库中。我该如何纠正？

谢谢！

杰西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:28:48.133

您可能会发现这很有用... [.htaccess 和 Wordpress：从 RewriteRule 中排除文件夹](https://stackoverflow.com/questions/2322559/htaccess-wordpress-exclude-folder-from-rewriterule)

您需要从 WordPress 的重写规则中排除该文件夹，以便 WordPress 不会拦截该文件夹。该链接的答案应该会有所帮助。

# java - 基于 SWT 的 GUI 在从最小化全尺寸状态中最大化时变黑

> ID：12112736
> 
> 赞同：5
> 
> 时间：2012-08-24T15:52:42.250
> 
> 标签：java, eclipse-plugin, swt, eclipse-rcp, fullscreen

我有一个基于 Eclipse SWT/RCP 的 GUI。当该 GUI 处于全尺寸并且我将其最小化然后最大化它时，我看到 Ui 上的黑色/黑色持续一秒钟或更长时间，然后它变得正常。我想知道，可能是什么原因

以下是截图—— ![在此处输入图像描述](../Images/78c30e7102b57df11845423de96fb45f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T11:46:03.817

这通常表明您的代码在事件侦听器上运行的时间比它应该运行的时间长，并且在该代码完成之前不会调度绘制事件。因此，您会看到黑色区域，直到它们被发送和绘制。我建议检查侦听器的逻辑，尤其是调整大小和焦点事件（如果有的话）。

# tomcat - 无法在 IDEA 中运行 Maven grails 应用程序：ClassNotFoundException: org.apache.catalina.startup.Tomcat

> ID：12112737
> 
> 赞同：1
> 
> 时间：2012-08-24T15:52:45.270
> 
> 标签：tomcat, grails, maven

我有由 Maven 管理和编译的 Grails 项目。我正在尝试使用 IntelliJ IDEA 10.5.4 运行应用程序。该项目作为 Maven 项目导入 IDEA。

当我尝试 ro 运行或调试应用程序时，出现错误：

```
Fatal error forking Grails JVM: java.lang.reflect.InvocationTargetException
java.lang.RuntimeException: java.lang.reflect.InvocationTargetException
    <...>
Caused by: java.lang.reflect.InvocationTargetException
    <...>
Caused by: java.lang.NoClassDefFoundError: org/apache/catalina/startup/Tomcat
    <...>
Caused by: java.lang.ClassNotFoundException: org.apache.catalina.startup.Tomcat
    <...> 
```

我已经将 Tomcat 6 服务器安装到 IDEA 的设置中，但我认为这不是 IDEA 的问题，而是 Maven 的问题，因为`mvn grails:run-app`在控制台中运行会产生相同的结果。`build ":tomcat:$grailsVersion"`如果文件`BuildConfig.groovy`很重要，文件中也存在依赖关系。

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T17:11:01.930

有关更多信息，请参阅[此博客文章](http://groovyc.net/?p=29)。简短的版本是将tomcat插件移出`BuildConfig`和移入您的`pom.xml`

另外，请确保您`use pom`的`grails.project.dependency.resolution`闭包内有线`BuildConfig`。

# sql - XML SQL 查找和替换

> ID：12112738
> 
> 赞同：0
> 
> 时间：2012-08-24T15:52:47.157
> 
> 标签：sql, xml, sql-server-2008

我有一个 SQL Server 2008 db 列，我们将调用 XMLDoc，它包含以下格式的 XML：

```
<XMLDoc xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.xxx.xxx.xxx">
  <Node>
    <SubNode>
      <SubSubNode>Value, Value, Value</SubSubNode>
      <IrrelevantNode></IrrelevantNode>
    </SubNode>
    ... 
```

`SubSubNode`从 0 到 20+ 值的任何地方，以逗号分隔。单个值不应包含逗号，但与它们一起输入错误。例如，以下`SubSubNode`是正确的：

`<SubSubNode>Value, Value, Value</SubSubNode>`

以下`SubSubNode`是不正确的：

`<SubSubNode>Value, </SubSubNode>`

我需要用逗号查找并替换所有单个值的实例，以显示为：

`<SubSubNode>Value</SubSubNode>`

由于 SQL 不允许`ends-with`, `starts-with`, or `matches`，我只能想出以下内容（这只是搜索值，我还没有进行替换）：

```
with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
select [XMLDoc].value('(/XMLDoc/Node/SubNode/SubSubNode)[1]','varchar(2000)')
from XMLDoc 
where [XMLDoc].exist('/XMLDoc/Node/SubNode[1] [contains(SubSubNode[1],", ")]')=1 
```

显然，这会选择所有带逗号的值，而不仅仅是带逗号的单个值。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:15:52.060

您是否考虑过使用上面的解析来构建某种派生列，其中包含来自您的子节点元素的数据，然后使用基于 sql 的解析函数来查找尾随值是逗号的位置？

我只是使用了几个不同的 xml 文档来说明我的意思...您可以构建一个变体来查找与此模式匹配的行...。不是用于查找模式的 xquery 技术，但应该可以工作。

```
DECLARE @XML XML = '<XMLDoc xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.xxx.xxx.xxx">
     <Node>
    <SubNode>
      <SubSubNode>Value, Value,</SubSubNode>
      <IrrelevantNode></IrrelevantNode>
    </SubNode>
   </Node>
  </XMLDoc>'

 DECLARE @XML2 XML = '<XMLDoc xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.xxx.xxx.xxx">
     <Node>
    <SubNode>
      <SubSubNode>Value</SubSubNode>
      <IrrelevantNode></IrrelevantNode>
    </SubNode>
   </Node>
  </XMLDoc>'

DECLARE @xmlTbl TABLE(XmlDoc VARCHAR(MAX))

;with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
 Insert Into @xmlTbl
select @XML.value('(/XMLDoc/Node/SubNode/SubSubNode)[1]','varchar(2000)');

;with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
 Insert Into @xmlTbl
select @XML2.value('(/XMLDoc/Node/SubNode/SubSubNode)[1]','varchar(2000)')

Select *
From @xmlTbl
Where RIGHT(XmlDoc,1) = ',' 
```

# ios - IBOutletCollection 没有排序，当它位于 UIViewController 中时，它是从 Storyboard 实例化的

> ID：12112739
> 
> 赞同：3
> 
> 时间：2012-08-24T15:52:53.443
> 
> 标签：ios, interface-builder, uistoryboard, iboutletcollection

我经常使用 IBOutletCollection 来顺序引用 UIView 对象。

例如，我可以枚举 UIButtons 的有序列表，获取它们的数字索引，而无需为每个按钮创建相同数量的 IBOutlet。它非常有用，尤其是当您的视图包含诸如数字键按钮之类的东西时。

但是，要使此方法正常工作，必须对 IBOutletCollection 进行排序，并且必须为对象返回相同的索引号。当我一直在使用 .xib 时，IBOutletCollection 数组中对象的顺序与 Interface Builder 中将对象连接到此 IBOutletCollection 的顺序相同。

当我尝试在情节提要的场景中做同样的事情时，就会出现问题。我不确定它是否与 UIViewController 或 Storyboard 有关，但是当我使用单独的 .xib 时对我有用的相同解决方案无法正常工作。

再次实例化对象时，索引号不会排序和更改。

有没有人遇到同样的问题？还是我忽略了什么？

# actionscript-3 - 如何在 mx 按钮中设置文本字段的绝对位置？

> ID：12112740
> 
> 赞同：0
> 
> 时间：2012-08-24T15:53:01.633
> 
> 标签：actionscript-3, apache-flex, mxml

我有一个大的 mx 按钮，我正在使用它，我希望它从大约 x=1 y=1 开始在整个按钮上显示我的标签。如何完成这种绝对定位？

这是它目前的样子：

![在此处输入图像描述](../Images/790ec60f7911797cc5d3c12ab9b2b2bc.png)

```
<mx:Button id="testButton" width="54" height="54" blendMode="layer" styleName="testStyle" label="D"/>

.testStyle
{
    color: #FFFFFF;
    fontFamily: 'latha';
    fontWeight: bold;
    fontSharpness: 400;
    up-skin:        Embed("redSquare.png");
    over-skin:      Embed("redSquare.png");
    down-skin:      Embed("redSquare.png");
    disabled-skin:  Embed("redSquare.png");
    selected-over-skin:     Embed("redSquare.png");
    selected-up-skin:       Embed("redSquare.png");
    selected-down-skin:     Embed("redSquare.png");
    selected-disabled-skin: Embed("redSquare.png"); 
} 
```

我正在动态设置我的字体大小：

```
testButton.setStyle("fontSize", 80*scale); 
```

我知道使用图像和缩放可能会更容易，但这个标签需要经常更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:08:25.277

一种方法是更改​​顶部/左侧填充样式：

```
testButton.setStyle("paddingTop", "-20");
testButton.setStyle("paddingLeft","-20"); 
```

# ruby-on-rails-3 - ActionMailer 发送带有空正文的电子邮件

> ID：12112741
> 
> 赞同：5
> 
> 时间：2012-08-24T15:53:08.750
> 
> 标签：ruby-on-rails-3, email, actionmailer

似乎在我将 rails 升级到 3.2.8 的时候，在我创建和发送电子邮件时没有设置正文。这次邮件程序周围的代码没有更改，除了 ActionMailer 也升级到 3.2.8。

我有`beta_request_mailer.rb`以下`app/mailers`方法：

```
def beta_request(request)
  mail(
    :to => "#{request[:name]} <#{request[:email]}>",
    :subject => 'Thanks for requesting an invite to xxxxx!'
  )
end 
```

我还有一个运行良好的正文文件：`app/views/beta_request_mailer/beta_request_email.html.erb`

电子邮件发送良好，只是没有任何正文。在控制台中运行，在 beta_request 中创建的邮件对象在运行时没有正文`mail.body`。如果我手动设置正文，则会发送出去。

发生了哪些我不知道的变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T17:25:29.607

我也收到了邮件，邮件内容正确，主题正确，但邮件中没有内容，发现使用 .deliver！而不仅仅是 .deliver 方法解决了问题（虽然不知道为什么）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T22:13:52.080

通过从文件名中删除 _email 修复

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-21T19:53:45.020

我的解决方案非常有趣。

1.  首先，我的 Rails 4 应用程序在没有邮件程序布局文件的情况下抛出错误。

2.  我创建了空白布局文件`mailer.html.slim`。这导致邮件已送达但没有内容。

3.  解决方案是在`==yield`里面添加`mailer.html.slim`

像魅力一样工作。希望这是您的问题，这对您有所帮助。

# c# - 指数超出范围。必须是非负 DataKeys (Asp.Net)

> ID：12112742
> 
> 赞同：0
> 
> 时间：2012-08-24T15:53:12.580
> 
> 标签：c#, asp.net

我的代码是（Asp.Net，C#）

```
 int index = Convert.ToInt16(e.CommandArgument);
    string str = GridView2.DataKeys[index].Value.ToString();
    Session["studyuid2"] = str; 
```

第二行向我抛出错误**索引超出范围。必须是非负数且小于集合的大小。参数名称：索引**

我的gridview是

```
<asp:GridView ID="GridView2" runat="server" AllowPaging="True" Height="100px" 
                    RowStyle-Height="25px" HeaderStyle-Height="30px" FooterStyle-Height="30px" 
                    CellPadding=5 CellSpacing=5  
                    AutoGenerateColumns="False" 
                    DataSourceID="SqlDataSource1" EnableModelValidation="True" 
                    Width="100%" 
                    DataKeyNames="StudyUID" 
                    onrowcommand="GridView2_RowCommand" 
                    AllowSorting="True">
<RowStyle Height="25px"></RowStyle>
                    <Columns> 
```

## -------------------------------------------

```
 </Columns>

<FooterStyle Height="30px"></FooterStyle>

<HeaderStyle Height="30px"></HeaderStyle>
                </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:02:13.657

在这种情况下，添加更多错误处理很有帮助。不幸的是，`ArgumentOutOfRangeException`没有告诉你参数的值和有效范围。你可以这样做，然后它会帮助你调试。

```
int index = Convert.ToInt16(e.CommandArgument);

try
{
    string str = GridView2.DataKeys[index].Value.ToString();
    Session["studyuid2"] = str;
}
catch (ArgumentOutOfRangeException ex) 
{
    throw new ArgumentOutOfRangeException(
        String.Format(
            "The index passed is not valid for the collection.  The index is '{0}' and must be between 0 and '{1}'.",
            index,
            GridView2.DataKeys.Count));
} 
```

您也可以通过在调用之前验证索引来做到这一点`DataKeys[index]`，而不是依靠异常处理来捕获和重新抛出。

# java - JSONArray 为空

> ID：12112744
> 
> 赞同：3
> 
> 时间：2012-08-24T15:53:18.123
> 
> 标签：java, mysql, json, arrays

我从数据库中读取数据（只有最后一行，我在我的 php 文件中执行）我想要做的是分别使用每个字段的数据但问题是 JSONArray 是空的我尝试了很多方法做它在不同的帖子中寻找它，但它总是空的。

这是我的代码

```
public class MainActivity extends Activity {
    /** Called when the activity is first created. */

    JSONArray jArray = null;
    String result = null;
    InputStream is = null;
    StringBuilder sb=null;

    String ct_id;
    String ct_name;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
      //http post
        try{
            HttpClient httpclient = new DefaultHttpClient();

            HttpPost httppost= new HttpPost("http://xxx.php");

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();

         }catch(Exception e){
            Log.e("log_tag", "Error in http connection"+e.toString());
         }
      //convert response to string
        try{
              BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
               sb = new StringBuilder();

               String line=null;
               while ((line = reader.readLine()) != null) {
                              sb.append(line + "\n");
                }
                is.close();
                result=sb.toString();
                }catch(Exception e){
                      Log.e("log_tag", "Error converting result "+e.toString());
                }
        //paring data

        try{
              jArray = new JSONArray(result);
              JSONObject json_data=null;
              for(int i=0;i<jArray.length();i++){
                     json_data = jArray.getJSONObject(i);
                     ct_id=json_data.getString("fecha");
                     ct_name=json_data.getString("dia");
                 }
              }
              catch(JSONException e1){
                  Toast.makeText(getBaseContext(), "JSON is empty" ,Toast.LENGTH_LONG).show();
              } catch (ParseException e1) {
                    e1.printStackTrace();
            }

    }
} 
```

它总是捕获 JSONException e1。

提前谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:56:11.417

检查返回的字符串`result`。可能不仅有 json 结构（错误、警告等）。JSON 拼写检查器：http: [//jsonlint.com/](http://jsonlint.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:00:45.880

检查json响应后；最好用GSON试试，方便多了；

```
 JsonParser jsonParser = new JsonParser();
        JsonArray jArray;
if ( jsonParser.parse(result).isJsonArray() ) {
    jArray = jsonParser.parse(result).getAsJsonArray();
} 
else { jArray = new JsonArray(); } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T11:01:50.110

问题出在 PHP 文件中，JSON 无法理解数据，这就是它为空的原因，我对其进行了更改，现在可以正常工作。

# c# - 如何检查 XAML 元素是否支持 AutomationId 属性

> ID：12112745
> 
> 赞同：4
> 
> 时间：2012-08-24T15:53:25.667
> 
> 标签：c#, wpf, xaml

我需要一种方法来检查我的代码库中的每个 WPF 控件是否具有 AutomationProperties.AutomationId 属性。（这是自动化 UI 测试所必需的。）我还需要确保将来在所有可能添加到代码库中的表单上强制执行此要求。我已经考虑了几种不同的方法，到目前为止，它们似乎都不是正确的方法。

选项 1：为应用程序中的每个 WPF 表单编写单元测试。

这是一个相当简单的方法。我已经编写了一个方法来检查 DependencyControl 的所有逻辑后代，并确保每个后代都有一个 AutomationId。这是一些C#：

```
 private bool AllControlsHaveAutomationId(DependencyObject control)
    {
        bool result = true;

        if (this.ControlHasAutomationId(control))
        {
            foreach (object o in LogicalTreeHelper.GetChildren(control))
            {
                FrameworkElement frameworkElement = o as FrameworkElement;
                if (frameworkElement != null)
                {
                    result = this.AllControlsHaveAutomationId(frameworkElement);
                }
            }
        }
        else
        {
            result = false;
        }

        return result;
    }

    private bool ControlHasAutomationId(DependencyObject control)
    {
        return !string.IsNullOrEmpty(AutomationProperties.GetAutomationId(control));
    } 
```

这种方法的问题是我会假设其他开发人员会为他们的表单编写单元测试，这不是一个好的假设。如果我不能假设 AutomationIds 将添加到所有 WPF 控件，那么我也不能假设将编写单元测试。

选项 2：使用 System.Xml.XmlDocument 读取每个 XAML 文件。检查文档中的元素是否有 AutomationProperties.AutomationId。

这种方法似乎很有希望。我最初的计划是将每个 XAML 文件加载到 XmlDocument 中，并检查文档中每个元素的 AutomationProperties.AutomationId 属性。但是，我意识到并非 XAML 中的每个元素类型都支持 AutomationProperties.AutomationId 属性。我需要的是一种读取 XAML 文件中的元素并确定该元素是否支持 AutomationProperties.AutomationId 属性的方法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:55:29.533

您可以在代码库的所有程序集中查看 BAML（已编译的 XAML）......有多种方法可以做到这一点。

## 通过 .NET Reflector 和插件查看 BAML

一种方法是编写一个反射器插件。

您也许可以将它基于已经可用的 BAML 查看器。

*   [http://reflectoraddins.codeplex.com/wikipage?title=BamlViewer&referringTitle=Home](http://reflectoraddins.codeplex.com/wikipage?title=BamlViewer&referringTitle=Home)

*   [http://wpf.2000things.com/tag/baml/](http://wpf.2000things.com/tag/baml/)

然后希望这只是将您的程序集提供给反射器并说在没有自动化 ID 的情况下给我找东西的情况。

## 通过 StylesExplorer 查看 BAML

*   [http://stylesexplorer.codeplex.com/](http://stylesexplorer.codeplex.com/)

允许您使用类访问程序集中的 BAML `BamlAssembly`。

## 通过 LocBAML 查看 BAML

*   [http://msdn.microsoft.com/en-us/library/ms746621.aspx](http://msdn.microsoft.com/en-us/library/ms746621.aspx)

*   [http://bloc.codeplex.com/releases/view/44124](http://bloc.codeplex.com/releases/view/44124)（相关链接）

Windows SDK 中提供了该工具的源代码。您可以修改以查找自动化属性而不是可本地化的属性。

## 使用 XamlReader.Load()

您甚至可能仅`XamlReader.Load()`使用未编译的 .xaml 文件就可以到达某个地方。

*   [http://go4answers.webhost4life.com/Example/xamlreaderloadbaml-removed-125290.aspx](http://go4answers.webhost4life.com/Example/xamlreaderloadbaml-removed-125290.aspx)

## 使用 XamlReader.LoadBaml()

*   [http://wpftutorial.net/baml.html](http://wpftutorial.net/baml.html)

## 其他选项

各种自动化的运行时验证器

*   [http://acccheck.codeplex.com/releases/view/46527](http://acccheck.codeplex.com/releases/view/46527)

# css - 如何使用 CSS 为背景图像着色？

> ID：12112746
> 
> 赞同：53
> 
> 时间：2012-08-24T15:53:28.490
> 
> 标签：css, background, tint

我有一个通过 CSS 设置的背景图像。

```
html {
background-image: url('../img/cello.jpg');
background-attachment: fixed;
background-size: 100%;
} 
```

我计划为网站的不同页面设置不同的背景图像：因此文本清晰易读很重要。现在，为了确保易读性，我在中间的#main 内容框有一个半透明的黑色背景：

```
#main {
background: rgba(0, 0, 0, 0.5);
} 
```

不过，我真正想做的是在整个背景图像上使用那种半透明的背景，因为黑盒子看起来有点笨重。我尝试制作一个`<div id=#tint>`包含整个 HTML 文档并将 rgba(0, 0, 0, 0.5) 给#tint，但这根本不起作用——我要么什么都没有改变，要么我可以得到整个背景变成一个简单的灰色，根本看不到背景图像。这根本不可能吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2016-02-03T12:40:55.107

# 用于`background-blend-mode`简单的色调

您可以使用[`background-blend-mode`](https://caniuse.com/css-backgroundblendmode)css 属性：

```
.background-tint {
  background-color: rgba(200,100,0,.5); /* Tint color */
  background-blend-mode: multiply;
} 
```

将它放在任何带有背景图像的元素上，你就可以开始了。

该属性在**不**包括 IE 11 的现代浏览器中得到很好的支持。对于不支持的浏览器，您可以使用[polyfill](https://github.com/idevsoftware/js-background-blend-mode)。

**[工作演示](https://jsbin.com/cesekucumu/edit?css,output)**

* * *

# 其他选项

# 用于`filter`复杂的色调

您可以使用[`filter`](https://caniuse.com/css-backgroundblendmode)css 属性：

```
.background-tint {
  filter: sepia(100%) saturate(200%) brightness(70%) hue-rotate(330deg);
} 
```

将它放在任何带有背景图像的元素上，你就可以开始了。为了改变颜色改变`hue-rotate`值。

该属性在**不**包括 IE 11 的现代浏览器中得到很好的支持。

**[工作演示](https://jsbin.com/bageqiriko/edit?css,output)**

## 使用平面线性渐变和多背景叠加

```
.background-tint {
  background-image: 
    linear-gradient( rgba(0,0,0,.5), rgba(0,0,0,.5) ),
    url('http://placehold.it/420')
} 
```

我认为这是最广泛使用的技术，但它具有硬编码的缺点，即您不能只上课，将其粘贴在元素上并进行着色。

你可以把它变成一个 less 或 sass mixin，比如：

**`less`**

```
.background-tint(@tint-color, @image-url) {
  background-image: 
    linear-gradient( @tint-color, @tint-color ),
    url( @image-url )
} 
```

**`sass`**

```
@mixin background-tint($tint_color, $image_url) {
  background-image: 
    linear-gradient( $tint_color, $tint_color ),
    url( $image_url )
} 
```

**[工作演示](https://jsbin.com/zibiqaneme/edit?css,output)**

## 使用透明背景

```
.background-tint { position: relative; }

.background-tint::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,.5);
} 
```

此方法具有适用于大多数浏览器的优点，并且只是您添加到任何元素的一个不错的类。不利的一面是，如果您在该元素中还有其他任何内容，则必须将其包装在具有某种定位的 div 中`position: relative`效果最好。

例子：

```
<div class="background-tint">
  <div class="u-relative">Some text here</div>
</div> 
```

```
.u-relative { position: relative; } 
```

**[工作演示](https://jsbin.com/mitocewuse/1/edit?css,output)**

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-24T16:32:01.693

我认为您需要创建一个`div`具有所需半透明背景的叠加元素（可能）。就像是：

```
.overlay {
    z-index: 1;
    height: 100%;
    width: 100%;
    position: fixed;
    overflow: auto;
    top: 0px;
    left: 0px;
    background: rgba(0, 0, 0, 0.7); /*can be anything, of course*/
} 
```

当然，还有一个小演示：[little link](http://jsfiddle.net/TqNqT/14/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-09-21T19:33:26.930

这对我很有用：

[https://css-tricks.com/tinted-images-multiple-backgrounds/](https://css-tricks.com/tinted-images-multiple-backgrounds/)

```
.tinted-image {
  background: 
    /* top, transparent red, faked with gradient */ 
    linear-gradient(
      rgba(255, 0, 0, 0.45), 
      rgba(255, 0, 0, 0.45)
    ),
    /* bottom, image */
    url(image.jpg);
} 
```

在另一个答案的基础上，你可以用现有的颜色来做到这一点，而不是像：

```
linear-gradient(
  fade(@brand-primary, 50%),
  fade(@brand-primary, 50%)
), 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T16:19:18.360

这将是`overlay`属性 [https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.html#blendingoverlay](https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.html#blendingoverlay) 但这是一个草稿。不要依赖它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T16:00:02.190

试试不透明度：

```
opacity:0.4;
filter:alpha(opacity=40); /* For IE8 and earlier */ 
```

# gwt - 小部件宽度：50% + 50% > 100%？

> ID：12112752
> 
> 赞同：0
> 
> 时间：2012-08-24T15:54:00.847
> 
> 标签：gwt, google-apps-script

我正在使用基于*GWT小部件的**Google Apps Script*和*Apps Script UI Builder*。

 *如果我创建一个*Flow Panel*并添加两个50% 宽度的标签，那么这些标签会出现在不同的行上*。*但不是 50% + 50% = 100%。

> 如何让它们出现在同一行？

自己尝试一下：

1.  打开 Google 电子表格。

2.  在电子表格菜单中，单击：*工具/脚本编辑器...*

3.  在脚本编辑器菜单中，单击：*文件/构建用户界面...*

4.  将小部件添加到画布。

当然，这个问题不仅仅适用于标签问题。一般来说，我对如何使用*UI Builder*构建流畅的布局感到非常困惑。似乎有（隐藏的？）填充和边距使事情变得非常困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:58:14.237

这一切都基于 CSS 及其盒子模型，并且在过去 15 年左右的时间里，这个问题已经积累了很多。本质上，您指定的宽度不考虑边距（和/或可能的填充，已经有一段时间了），因此您需要添加一个样式表来最小化它们。看到类似这样的[CSS 重置](http://meyerweb.com/eric/tools/css/reset/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:51:46.240

`Label`s 转换为`<div>`s，默认情况下出现在不同的行上。您可以尝试添加`float: left`标签，或更改显示模式等。

您也可以尝试`InlineLabel`s，我认为它可以编译为`<span>`s。

如果您已经尝试过所有这些，那么您`Label`的 s 显然太宽了。两个 50% 的对象不能放在同一行上很烦人，但是使用 HTML 和 CSS 有什么不烦人的呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T19:43:33.020

解决方案很简单。对于两个标签，设置*为零*：

*边框和边距 / 边距*

不知道为什么我昨天没看到 - 我正在值夜班...... ;-)*

# sap-ase - Sybase ASE 15.5 标识列

> ID：12112757
> 
> 赞同：0
> 
> 时间：2012-08-24T15:54:15.083
> 
> 标签：sap-ase

我使用 Sybase ASE 15.5 (Sybase AnyWhere) 中的 Sybase Central 工具创建了几个表。我已将一列定义为主键（int 数据类型），并且不知何故该列也变成了 Identity。

现在从 Sybase Central 中，我无法从该列中删除 Identity，即使此表或任何引用的表中都没有数据。

有人可以帮忙吗？我不想使用 Set IDENTITY_INSERT，我想从该列中完全删除身份行为。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:00:23.087

您的问题有点令人困惑，因为我不确定您使用的是什么 Sybase 软件或软件版本。Sybase ASE 15.5 与 Sybase SQL Anywhere 不同，但希望这些步骤无论如何都能奏效。

您不能从列中删除标识行为，但可以更改表以完成相同的操作。以下是您应该采取的保存数据的步骤。确保表上没有索引。

*   更改表以添加与当前标识列具有相同数据类型的新列。
*   将标识列中的数据复制到新列。
*   删除身份列
*   （可选）如果您针对该表编写了任何代码，您可能希望将新列重命名为与刚刚删除的列相同的名称。

    ```
    alter table TABLE_NAME add NEW_COL int NULL
    go
    update TABLE_NAME set NEW_COL = ID_COL_NAME
    go
    alter table TABLE_NAME drop ID_COL_NAME
    go
    alter table TABLE_NAME rename NEW_COL to ID_COL_NAME
    go 
    ```

# android - android相机jpeg文件大小比iphone大得多？

> ID：12112758
> 
> 赞同：0
> 
> 时间：2012-08-24T15:54:48.103
> 
> 标签：android, iphone, image, jpeg, android-camera

我的应用程序为文件拍照。我在相机上指定了 1600x1200 的图片尺寸，请求 JPEG 图像，并将质量设置为 30。

开发 iPhone 版本应用程序的 iPhone 开发人员做同样的事情（1600 x 1200，质量 = 30）。

图像尺寸：

在 iPhone 4S 上：~100k 三星 Galaxy Nexus：~240k 三星 Galaxy S3：~600k

我验证了所有图像都是 JPEG 格式，并且都是 1600 x 1200。当我目视检查图像质量时，它们看起来大致相同。

为什么文件大小不同？最让我惊讶的是 Nexus 和 S3 之间的区别，因为它们运行的​​是*完全相同的*Android 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:53:57.773

如果 jpeg 编码器使用不同的默认量化表，则两部手机上的相同图像可能具有不同的大小。量化是 jpeg 编码中唯一的有损步骤，它将对最终图像文件的大小产生最大的影响 - [http://en.wikipedia.org/wiki/JPEG#Quantization](http://en.wikipedia.org/wiki/JPEG#Quantization)

顺便说一句，您是否尝试过以原始分辨率目视检查图像？更大的屏幕可能有助于识别图像质量的细微差异（如果存在）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:18:13.077

这完全取决于手机本身如何构建以处理从相机拍摄的原始图像。它必须尽可能地将图像从它实际看到的内容转换为 JPG。当我以 RAW 格式处理我的 DSLR 拍摄的照片时，我可以输出不同文件大小（相同图片大小）的 JPG，只需处理曝光、颜色曲线等。我是手动完成的，但手机有内置的逻辑试图制作出大多数人都喜欢的图片。傻瓜相机做同样的事情。

根据这个[网站](http://www.gsmarena.com/piccmp.php3?idType=1&idPhone1=4212&idPhone2=4219&idPhone3=4238)，看起来 iPhone 比 S3 做了更多的压缩和颜色猜测。仔细看会发现，S3拍出来的照片颜色比较平滑，需要更多的内存来存储。我感觉 Nexus 使用了与 S3 类似的算法，只是没有相机那么好。

# twitter-bootstrap - 引导 css 中的某些内容阻止了 bing map 6.3 显示

> ID：12112760
> 
> 赞同：3
> 
> 时间：2012-08-24T15:54:55.073
> 
> 标签：twitter-bootstrap, bing-maps

我正在尝试将 Bing maps v.6.3 Ajax 控件与使用 bootstrap 的页面（最新版本 2.1.0）一起使用，由于某种原因，当我包含 bootstrap min css 时，如果我删除了对它呈现良好的引导 css

jsfiddle 在这里

[http://jsfiddle.net/WnPHb/](http://jsfiddle.net/WnPHb/)

使用引导 css ![使用引导 css](../Images/585bc5b137cda8cc64ee73157ba827a6.png)

没有引导 css ![没有引导 css](../Images/12c5eec8678d4ffb57ca9184ca0cef6f.png)

有没有人遇到过这个？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:29:01.020

物有所值

这是我必须在

```
img{max-width:100%;vertical-align:middle;border:0;-ms-interpolation-mode:bicubic;} 
```

我希望有一天这对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T06:15:35.543

问题似乎来自**bootstrap.css**中元素的`max-width: 100%`样式设置。我建议将地图容器中的所有图像恢复为默认值 ( )：`img`**`none`**

 **```
.MSVE_MapContainer img {
  max-width: none;
} 
```

## [JSFiddle](http://jsfiddle.net/mmfansler/8BPHc/)**

# php - 处理.htm 扩展文件上的PHP 代码？

> ID：12112762
> 
> 赞同：0
> 
> 时间：2012-08-24T15:54:56.270
> 
> 标签：php

> **可能重复：**
> [如何将 PHP 代码添加到 .html 文件？](https://stackoverflow.com/questions/11312316/how-do-i-add-php-code-to-html-files)

有没有办法处理 .html/.htm 文件上的 php 代码？服务器支持php我只需要文件保留.htm扩展名

注意：我真的不明白为什么有些用户觉得有必要对一个有效的问题投反对票。并非所有问题都出现在搜索中，除非它的措辞接近前一个问题。

感谢以下所有答案。`AddType`在 htaccess 中解决了我的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:56:21.727

您可以使用.htaccess 文件，也可以在**.htaccess**`mod_rewrite`文件中添加一个指令来告诉 Apache（如果您正在使用的话）将 .htm 添加为 PHP 文件类型。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T15:56:39.967

将以下内容添加到您的 .htaccess 中：

```
AddHandler application/x-httpd-php5 .htm 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T15:56:33.130

您可以更改 Web 服务器的文件配置（例如，在 apache 中的**httpd.conf**文件）以将 .htm 解释为 php 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:57:19.527

如果您使用 Apache，请在文件中查找 php addHandler 指令`apache2.conf`并将您的扩展名添加到列表中。之后不要忘记重新启动apache。**

# jquery - 如何在 MVC 4 中更改 jQuery DatePicker 中的验证文本？

> ID：12112763
> 
> 赞同：0
> 
> 时间：2012-08-24T15:54:55.870
> 
> 标签：jquery, validation, datepicker, overriding, asp.net-mvc-4

我有一个 MVC 4 项目，对在日期选择器中验证日期后显示的默认错误文本不满意。有没有办法覆盖这个？我的剃刀代码如下所示：`@Html.EditorFor(model => model.EstimatedDeliveryDate)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:07:39.447

您可以通过模型中的 DataAnnotation 设置它。

如果您使用的是必需属性：

```
[Required(ErrorMessage = "You must give an estimated delivery date")]
public string EstimatedDeliveryDate { get; set; } 
```

# html - Facebook 缩略图

> ID：12112764
> 
> 赞同：2
> 
> 时间：2012-08-24T15:54:59.007
> 
> 标签：html, facebook, facebook-like, client, thumbnails

当有人喜欢网站上的某些内容时，如何选择要显示为缩略图的图像。现在我有这个

```
<fb:like layout="button_count" colorscheme="light" href="myurl" ref="something" show_faces="false" width="150"></fb:like> 
```

当某些东西被喜欢时，似乎随机图像被发送到 facebook 墙上，我想发送一个特定的图像。根据喜欢我的内容的页面到 facebook

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:03:39.057

我认为这是您正在寻找的 Facebook Open Graph 标签，特别是`og:image`标签。

尝试查看这些链接：

[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)特别是“开放图形标签”部分。

[http://developers.facebook.com/docs/opengraphprotocol/](http://developers.facebook.com/docs/opengraphprotocol/)

# ruby - 如何引用全局变量和类变量？

> ID：12112765
> 
> 赞同：49
> 
> 时间：2012-08-24T15:54:59.747
> 
> 标签：ruby

我是编程新手。现在我正在学习Ruby。据我了解，全局变量是在全局命名空间中定义的（因此在任何类或函数之外）。我正在读一些东西，它说全局变量`$`在它们之前有一个符号。这意味着什么？这是否意味着当我定义一个函数或类并想要引用我的全局变量（假设它是`edmund = 123`）时，我必须像这样引用它：`$edmund`？

所以：

```
edmund = 123
def my_function()
  456 + $edmund
end 
```

类变量（以 开头的`@@`）也像实例变量 ( `@`)，您可以通过调用它们来访问它们`Class.classvariable`吗？他们的目的是什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-08-24T16:56:52.793

全局范围是覆盖整个程序的范围。全局范围由全局变量享有，它们可以通过它们的初始美元符号 ($) 字符来识别。它们随处可见，创建自己的全局变量可能很诱人，尤其是对于初学者来说。但它们并不总是一个好主意。

```
$gvar = "I'm a global!"
class C
    def examine_global
        puts $gvar
    end
end

c = C.new
c.examine_global # I'm a global! 
```

* * *

类变量以两个 at 符号开头：例如，@@var。尽管它们的名字，类变量不是类范围的。相反，它们是类层次结构范围的。最简单的，类变量背后的想法是它提供了一种在类和该类的实例之间共享的存储机制，并且对任何其他对象都不可见。

```
class Parent
    @@value = 100
end

class Child < Parent
    @@value = 200
end

class Parent
    puts @@value
end 
```

打印出来的是 200。 Child 类是 Parent 的子类，这意味着 Parent 和 Child 共享相同的类变量——不是同名的不同类变量，而是相同的实际变量。当您在 Child 中分配 @@value 时，您正在设置在整个层次结构中共享的唯一一个 @@value 变量，即由 Parent 和 Child 以及它们中的任何一个的任何其他后代类共享。

* * *

并在应得的地方给予赞扬 - 这个解释来自 David A Black 的“The Well Grounded Rubyist”，这是了解 Ruby 的最佳资源之一。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-24T18:51:18.643

很好的问题。不幸的是，您刚刚跳入了一个兔子洞，但您最终必须在 ruby​​ 中跌入这个洞，才能开始了解真正的复杂性。

对于您的第一个问题，关于`$`-prefixed 全局变量。它们是真正全球化的：

```
def mk_foo() $foo ||= "foo"; end

$foo                # => nil
mk_foo              # => "foo"
$foo                # => "foo"
mk_foo.object_id    # => 70299647799620
$foo.object_id      # => 70299647799620 
```

可以看到，when`$foo`是在`mk_foo`方法中定义的，是在全局空间中定义的，可以在任何地方访问：

```
class CanSeeFoo
  def see_foo() $foo; end
end
CanSeeFoo.new.can_see_foo
# => "foo"
CanSeeFoo.new.can_see_foo.object_id
# => 70299647799620 
```

至于类变量问题，这就是兔子洞的开始。首先，您是正确的，`@@`带前缀的变量称为“类变量”，`@`带前缀的变量称为“实例变量”。

类变量在定义类的所有子类（在继承树的所有子级别）都是静态的。这里的含义是，如果任何子类更改类变量，它将在所有相关子类中更改，直到定义类。

```
class A; end
class B < A; @@foo = "foo";  end
B.class_variable_get(:@@foo)    # => "foo"
A.class_variable_get(:@@foo)
  # => raises NameError "uninitialized class variable @@foo in A"

class C < B; end
C.class_variable_get(:@@foo)    # => "foo"

class D < C
  def self.change_foo(); @@foo = "bar"; end
  def change_foo(); @@foo = "baz"; end
end
D.class_variable_get(:@@foo)    # => "foo"

class E < D; end
E.class_variable_get(:@@foo)    # => "foo"

D.change_foo                    # => "bar"
D.class_variable_get(:@@foo)    # => "bar"
E.class_variable_get(:@@foo)    # => "bar"
C.class_variable_get(:@@foo)    # => "bar"
B.class_variable_get(:@@foo)    # => "bar"

D.new.change_foo                # => "baz"
D.class_variable_get(:@@foo)    # => "baz"
E.class_variable_get(:@@foo)    # => "baz"
C.class_variable_get(:@@foo)    # => "baz"
B.class_variable_get(:@@foo)    # => "baz"
A.class_variable_get(:@@foo)
  # => raises NameError "uninitialized class variable @@foo in A" 
```

至于访问类和实例变量，不使用访问器`#instance_variable_get`或`::class_variable_get`在定义访问器之前都无法访问。目前，ruby 只有在实例变量上定义访问器的方法，但是为类变量定义适当的方法很简单：

```
class A
  @@foo = "foo"

  # the second argument `true` adds the writer method `#bar=`
  attr :bar, true

  def self.foo(); @@foo; end
  def self.foo=(v); @@foo = v; end

  def initialize()
    @bar = "bar"
  end
end
class B < A; end

A.foo             # => "foo"
B.foo = "foobar"
A.foo             # => "foobar"
B.foo             # => "foobar"

a = A.new
a.bar             # => "bar"
a.bar = "baz"
a.bar             # => "baz"

a.foo
  # => raises NoMethodError: undefined method `foo' for #<A:0x ... 
```

您可以在 ruby​​ 核心文档中查看属性访问器方法：[http](http://www.ruby-doc.org/core-1.9.3/Module.html#method-i-attr) ://www.ruby-doc.org/core-1.9.3/Module.html#method-i-attr 。此外，ActiveSupport ( [http://rubygems.org/gems/activesupport](http://rubygems.org/gems/activesupport) ) 有 " `cattr`" 定义类变量访问器的方法[http://api.rubyonrails.org/v3.2.5/classes/Class.html#method-i-cattr_accessor](http://api.rubyonrails.org/v3.2.5/classes/Class.html#method-i-cattr_accessor) .

这就是简单的东西。下一步是了解“单例类”，也称为“特征类”或“元类”（[维基百科：元类](http://en.wikipedia.org/wiki/Metaclass)）（请记住，ruby 中的一切都是对象，包括类和模块构造）。在这里，我将向您指出 Yehuda Katz 的一篇出色的文章：[Ruby 中的元编程：一切都是关于自我的](http://yehudakatz.com/2009/11/15/metaprogramming-in-ruby-its-all-about-the-self/)，以及另一个 Stack Overflow 问题：[Ruby 中的 class << self idiom](https://stackoverflow.com/questions/2505067/class-self-idiom-in-ruby)。

作为预览：单例类（不要与单例设计模式混淆）允许您访问特定类或模块的方法和*实例数据。*有关一些相关文档，请参阅核心文档：[http ://www.ruby-doc.org/core-1.9.3/Object.html#method-i-singleton_class](http://www.ruby-doc.org/core-1.9.3/Object.html#method-i-singleton_class)

```
class A; end
class B < A;
  class << self
    def foo() @foo end
    def foo=(v) @foo = v; end
  end
end
B.foo = "foo"

class C < B; end

A.foo
  # => raises NoMethodError: undefined method `foo' for A:Class

B.foo         # => "foo"
C.foo         # => nil
B.foo = "baz"
B.foo         # => "baz"
C.foo         # => nil
C.foo = "foo"
C.foo         # => "foo"
B.foo         # => "baz" 
```

最后，记得使用[Ruby-Core 文档](http://www.ruby-doc.org/core-1.9.3)。对理解上述内容最有用的是：

*   [http://www.ruby-doc.org/core-1.9.3/Object.html](http://www.ruby-doc.org/core-1.9.3/Object.html)
*   [http://www.ruby-doc.org/core-1.9.3/Module.html](http://www.ruby-doc.org/core-1.9.3/Module.html)
*   [http://www.ruby-doc.org/core-1.9.3/Class.html](http://www.ruby-doc.org/core-1.9.3/Class.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-24T16:17:52.330

美元符号是变量名的一部分，因此必须像这样声明：

```
$edmund = 123 
```

`@`实例变量和类变量的情况相同：它们的名称以or开头`@@`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T16:18:54.630

查看这些文章：

[http://www.rubyist.net/~slagell/ruby/globalvars.html](http://www.rubyist.net/~slagell/ruby/globalvars.html)

和

[如何在 Ruby 中使用全局变量或常量值？](https://stackoverflow.com/questions/1042384/in-ruby-how-to-use-global-variables-or-constant-values)

# azure - 如何在本地 Azure 模拟器上重新启动实例？

> ID：12112767
> 
> 赞同：8
> 
> 时间：2012-08-24T15:55:04.770
> 
> 标签：azure, azure-worker-roles

我正在研究工作者角色故障转移解决方案，我需要能够通过关闭或重新启动实例以及创建新实例来测试和调试故障转移机制。

如何在本地 Azure 模拟器上重新启动或关闭特定实例？我正在使用 1.7 SDK

谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T20:26:05.317

我不得不在这里不同意大卫的回答。您可以执行一些操作来关闭实例或创建新实例。

## 关闭/杀死实例

当您在模拟器中运行应用程序时，它会为每个实例启动 1 个 Web 角色 (WaIISHost.exe) / Worker Role (WaWorkerHost.exe) 进程：

![在此处输入图像描述](../Images/bcb590a566cdc6e6881be9c920bf9c30.png)

当您杀死其中一个进程时，就好像您杀死了一个实例。切换回模拟器后，您会看到您杀死的特定实例的图标颜色发生了变化，并且日志将显示该实例的状态为未知/已销毁：

![在此处输入图像描述](../Images/c1247c184803ba6df495440c118e4584.png)

附加调试器后，您会看到这种情况发生并且实例永远不会重新启动，从而允许您测试突然丢失一个或多个实例的场景。如果未附加调试器，这一切都会发生得非常快，并且实例将立即重新启动（在 Visual Studio 中，您可以选择不调试就启动）。

## 增加或减少实例数

使用**csrun.exe**（通常位于*C:\Program Files\Microsoft SDKs\Windows Azure\Emulator*中），您可以更新模拟器中服务的配置，包括实例数。假设我想在我目前拥有的 4 个实例中添加 6 个实例。

我打开位于 Azure 项目的 Debug 文件夹中的**ServiceConfiguration.cscfg文件 (..\Some\Path\MultipleInstancesDemo\MultipleInstancesDemo\bin\Debug)，并将实例数更改为 10：**

```
<ServiceConfiguration serviceName="MultipleInstancesDemo" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceConfiguration" osFamily="1" osVersion="*" schemaVersion="2012-05.1.7">
  <Role name="MyWebRole">
    <Instances count="10" />
    <ConfigurationSettings>
      <Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" value="UseDevelopmentStorage=true" />
    </ConfigurationSettings>
  </Role>
</ServiceConfiguration> 
```

然后可以通过向 csrun.exe 提供部署 ID 和配置文件的路径来将其推送到模拟器。您将在模拟器中找到部署 ID。在上一个屏幕截图中，您将看到**deployment17(20)**，这意味着部署 ID 是**20**。这就是调用 csrun.exe 的方式： csrun /update:20;"..\Some\Path\MultipleInstancesDemo\MultipleInstancesDemo\bin\Debug\ServiceConfiguration.cscfg"

几秒钟后，您将在模拟器中看到新实例：

![在此处输入图像描述](../Images/84fcd5b04f9704c9d7a72d0b8dc1b959.png)

**注意！：**这里似乎仅在您启动项目而不进行调试时才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:06:08.923

您无法关闭特定实例；您只能缩减正在运行的实例的总数。

如果要重启正在运行的实例，可以调用：

```
RoleEnvironment.RequestRecycle(); 
```

# php - 如何使正则表达式不匹配文本、点、文本的序列，而只匹配文本

> ID：12112775
> 
> 赞同：2
> 
> 时间：2012-08-24T15:55:30.323
> 
> 标签：php, regex

我有以下正则表达式：

```
[^/]+\/?\.\.\/ 
```

它应该通过将上述匹配替换为空白来将相对 url 转换为绝对 url。

例子：

```
http://abv.bg/path/../test 
```

应该转换为

```
http://abv.bg/test 
```

帮我修改一下，如果我通过了

```
http://abv.bg/../test 
```

它不会删除域。

我需要使“[^/]+”不匹配中间某处带有点的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:07:24.217

这应该有效：

```
((^(?:http://)*[\w.]+)(/.*)(/[\w]+)) 
```

用。。。来代替：

```
$2$4 
```

### [演示](http://regexr.com?31ugn)

更新了正则表达式并使该`http://`部分成为可选的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T09:40:42.127

删除`(\/[^\/.]+)?\/\.\.`满足您的要求，但请注意我的评论。

# scala - 在通用 Scala 类中重载构造函数

> ID：12112776
> 
> 赞同：2
> 
> 时间：2012-08-24T15:55:33.990
> 
> 标签：scala, generics

我正在尝试在通用 scala 类中重载构造函数，但它没有编译。

这是我的代码：

```
class V[T](m: Map[T,Double]) {
    def this(dt: Seq[Double]) = this(dt.zipWithIndex.map(_.swap).toMap)
} 
```

我得到的错误信息：

```
ERROR: called constructor's definition must precede calling constructor's definition : line 6

ERROR: overloaded method constructor V with alternatives:   
(dt: Seq[Double])V[T] <and>   (m: Map[T,Double])V[T]  cannot be applied to 
(scala.collection.immutable.Map[Int,Double]) : line 6 
```

据我了解scala中的构造函数重载，我认为我遵循正确的语法和调用`this`应该先于其他所有内容的限制。

那么我做错了什么，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:29:34.150

和

```
def this(dt: Seq[Double]) = this(dt.zipWithIndex.map(_.swap).toMap) 
```

*   您正在创建一张新地图`Map[Int,Double]`；`Int`是由 . 创建的索引的类型`zipWithIndex`。

*   如果`T`是`Int`，那么您可以使用构造函数`(m:Map[T,Double]`。

*   但是： T 尚未绑定到类型，因为您正在定义类。此时匹配的类型也不会`T`绑定`Int`。

*   因此类型匹配失败。

### 解决方案：

如何修复它取决于您要执行的操作。

*   如果是这种情况`T <: Int`，那么将 type-param 与 绑定`<: Int`可以解决您的问题；但是，这似乎不太可能`T`是`Int`...的子类

*   如果它总是如此`T : Int`，那么放弃泛型`T`。

*   如果`T`要保持通用性和无界性，那么您就可以为 when 做一个特殊情况`T : Int`；senia 的解决方案看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:22:43.640

您可以使用伴随对象修复它：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

class V[T](m: Map[T,Double])

object V{
  def apply(dt: Seq[Double]) = new V[Int](dt.zipWithIndex.map(_.swap)(collection.breakOut))
}

// Exiting paste mode, now interpreting.

defined class V
defined module V

scala> V(Seq(1.,2.,3.))
res0: V[Int] = V@1130e2ea 
```

# header - 怎么读没有。每分辨率像素。TIFF 标头中的单位

> ID：12112781
> 
> 赞同：2
> 
> 时间：2012-08-24T15:55:46.563
> 
> 标签：header, io, tiff

我正在尝试读取从 Leica (SP5) 程序导出的 TIFF 图像。我可以按照 TIFF 文档中定义的标签读取其他详细信息（例如每个样本的位数、图像大小 x、图像大小 y）。我有点粗略地将标头读取为无符号整数，直到我到达某个标签号。

我知道在 296，我的“分辨率单位”是厘米。在 282 和 283 处，它应该给我每个分辨率单位的像素数（以 x 和 y 为单位）。我不知道该怎么做。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:02:05.460

好吧，如果在 296 处您发现单位类型是什么（1 - 无绝对单位、2 - 英寸或 3 - 厘米），并且在 282 和 283 处分别获得 XResolution 和 YResolution，那么您拥有解决问题所需的一切.

要获得单位类型度量，只需将 XResolution 和 YResolution 相乘：

```
XResolution * YResolution = PixelsPerUnit 
```

由于您试图找到由分辨率创建的矩形区域。

# java - 在 NullPointerException 中获取 getParcelableArrayListExtra 返回？

> ID：12112789
> 
> 赞同：0
> 
> 时间：2012-08-24T15:56:18.623
> 
> 标签：java, android, android-intent, nullpointerexception, parcel

Parcelable 类是：

```
 package mobile.bh.classes;

import java.util.List;

import mobile.bh.activities.MethodStep;
import android.content.Context;
import android.graphics.Bitmap;
import android.os.Parcel;
import android.os.Parcelable;

//simple class that just has one member property as an example
public class Recipe implements Parcelable {
    public int id;
    public String name;
    public List<Ingredient> ingredients;
    public List<MethodStep> method;
    public String comment;
    public String image;
    public Bitmap image2;
    Context mContext;

    public Recipe(Context c){
        mContext = c;
    }
    /* everything below here is for implementing Parcelable */

    // 99.9% of the time you can just ignore this
    public int describeContents() {
        return 0;
    }

    // write your object's data to the passed-in Parcel
    public void writeToParcel(Parcel out, int flags) {
        out.writeInt(id);
        out.writeString(name);
        out.writeTypedList(ingredients);
        out.writeTypedList(method);
        out.writeString(comment);
        out.writeString(image);
    }

    // this is used to regenerate your object. All Parcelables must have a CREATOR that implements these two methods
    public static final Parcelable.Creator<Recipe> CREATOR = new Parcelable.Creator<Recipe>() {
        public Recipe createFromParcel(Parcel in) {
            return new Recipe(in);
        }

        public Recipe[] newArray(int size) {
            return new Recipe[size];
        }
    };

    // example constructor that takes a Parcel and gives you an object populated with it's values
    private Recipe(Parcel in) {
        id = in.readInt();
        name =in.readString();
        in.readTypedList(ingredients, Ingredient.CREATOR);
        in.readTypedList(method, MethodStep.CREATOR);
        comment = in.readString();
        image = in.readString();
    }

} 
```

数据是通过这样的意图发送的：

```
 Intent i = new Intent(context,RecipeInfoActivity.class);
        ArrayList<Recipe> dataList = new ArrayList<Recipe>();
        dataList.add(recipe);
        i.putParcelableArrayListExtra("recipeObj", dataList);
        i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(i); 
```

并在另一端接收数据，这使得 NullPointerExceotion

```
 ArrayList<Recipe> p =  getIntent().getParcelableArrayListExtra("recipeObj"); 
```

LogCat 输出：

```
08-24 16:37:51.172: E/AndroidRuntime(976): FATAL EXCEPTION: main
08-24 16:37:51.172: E/AndroidRuntime(976): java.lang.RuntimeException: Unable to start activity ComponentInfo{mobile.bh/mobile.bh.activities.RecipeInfoActivity}: java.lang.NullPointerException
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Looper.loop(Looper.java:123)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-24 16:37:51.172: E/AndroidRuntime(976):  at java.lang.reflect.Method.invokeNative(Native Method)
08-24 16:37:51.172: E/AndroidRuntime(976):  at java.lang.reflect.Method.invoke(Method.java:521)
08-24 16:37:51.172: E/AndroidRuntime(976):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-24 16:37:51.172: E/AndroidRuntime(976):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-24 16:37:51.172: E/AndroidRuntime(976):  at dalvik.system.NativeStart.main(Native Method)
08-24 16:37:51.172: E/AndroidRuntime(976): Caused by: java.lang.NullPointerException
08-24 16:37:51.172: E/AndroidRuntime(976):  at mobile.bh.classes.Recipe.<init>(Recipe.java:59)
08-24 16:37:51.172: E/AndroidRuntime(976):  at mobile.bh.classes.Recipe.<init>(Recipe.java:56)
08-24 16:37:51.172: E/AndroidRuntime(976):  at mobile.bh.classes.Recipe$1.createFromParcel(Recipe.java:47)
08-24 16:37:51.172: E/AndroidRuntime(976):  at mobile.bh.classes.Recipe$1.createFromParcel(Recipe.java:1)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readParcelable(Parcel.java:1906)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readValue(Parcel.java:1771)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readListInternal(Parcel.java:2017)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readArrayList(Parcel.java:1461)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readValue(Parcel.java:1792)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Parcel.readMapInternal(Parcel.java:2008)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Bundle.unparcel(Bundle.java:208)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.os.Bundle.getParcelableArrayList(Bundle.java:1144)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.content.Intent.getParcelableArrayListExtra(Intent.java:3424)
08-24 16:37:51.172: E/AndroidRuntime(976):  at mobile.bh.activities.RecipeInfoActivity.onCreate(RecipeInfoActivity.java:56)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-24 16:37:51.172: E/AndroidRuntime(976):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
08-24 16:37:51.172: E/AndroidRuntime(976):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T17:43:50.670

这就是我`Parcelable`用我的实现的方式`Lists`：

```
public String tag;
public int success;
public int error;
public User user;
public Event event;
public String error_message;    
public List<Event> finishedevents;
public List<Leadevent> leaderboard; 
public List<User> user_search;

public void readFromParcel(Parcel in) {
    tag = in.readString();
    success = in.readInt();
    error = in.readInt();
    user = (User) in.readValue(User.class.getClassLoader());
    event = (Event) in.readValue(Event.class.getClassLoader());
    finishedevents = (ArrayList<Event>) in.readSerializable();
    leaderboard = (ArrayList<Leadevent>) in.readSerializable();
    user_search = (ArrayList<User>) in.readSerializable();
    error_message = in.readString();
}

public void writeToParcel(Parcel out, int content) {
    // TODO Auto-generated method stub
    out.writeString(tag);
    out.writeInt(success);
    out.writeInt(error);
    out.writeValue(user);
    out.writeValue(event);
    out.writeList(finishedevents);
    out.writeList(leaderboard);
    out.writeList(user_search);
    out.writeString(error_message);
} 
```

所以你应该尝试`readSerializable()`.`Lists`

# ember.js - 是否有关于如何使用 SortableMixin 的信息性文章？

> ID：12112797
> 
> 赞同：2
> 
> 时间：2012-08-24T15:56:37.407
> 
> 标签：ember.js

目前我正在使用 JavaScript 的本机`sort()`方法在 Ember 中进行排序，但实际上我知道我应该使用 Ember 自己的排序，但不幸的是我完全不知道如何使用它。

我不想浪费人们的时间为我解释它（除非你是一个受虐狂），但如果有人知道一篇关于如何在 EmberJS 中对模型集合进行排序的精彩文章，那将不胜感激！

目前我有类似以下的内容，我只是再次使用本机排序实现排序，但我停在那里，因为我想学习正确的方法。

```
SortOption: Ember.View.extend(
{
    template:   Ember.Handlebars.compile('<li><a href="javascript:void(0);">{{ option }}</a></li>'),
    option:     null,

    click: function()
    {
        var rootView    = this.nearestWithProperty('people');
        var sortBy      = this.get('option');

        var sorted = rootView.get('people').orderBy('formalName');
        rootView.set('people', sorted)
    }
}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T18:25:11.827

[此拉取请求](https://github.com/emberjs/ember.js/pull/1255/files)用于更新有关 SortableMixin 的文档。

```
Ember.SortableMixin provides a standard interface for array proxies
to specify a sort order and maintain this sorting when objects are added,
removed, or updated without changing the implicit order of their underlying
content array:
  songs = [ 
   {trackNumber: 4, title: 'Ob-La-Di, Ob-La-Da'},
   {trackNumber: 2, title: 'Back in the U.S.S.R.'},
   {trackNumber: 3, title: 'Glass Onion'},
  ];  

  songsController = Ember.ArrayController.create({
  content: songs,
  sortProperties: ['trackNumber']

 });

 songsController.get('firstObject'); // {trackNumber: 2, title: 'Back in the U.S.S.R.'}
 songsController.addObject({trackNumber: 1, title: 'Dear Prudence'});
 songsController.get('firstObject'); // {trackNumber: 1, title: 'Dear Prudence'} 
```

从 0.9.8 版本开始，Sortable Mixin 现在包含在 ArrayController 中（我相信）。您需要做的就是在控制器上定义一个 sortProperties 数组并`arrangedContent`在视图中使用该属性。[这是伊万的解释。](https://stackoverflow.com/a/11405883/1406961)

# android - 验证是否有新版本的 Android 应用程序可用

> ID：12112799
> 
> 赞同：1
> 
> 时间：2012-08-24T15:56:44.117
> 
> 标签：android, version, google-play, alert, updates

这是我的问题：

我需要我的应用程序来验证市场上是否有新版本。它可能会显示一个警告对话框，通知有可用更新，然后将用户带到市场。

我知道如果用户选中该选项，市场就会这样做，但是很多人不会费心查看更新，我真的需要轻推他们以获取更新。

我没有找到任何合适的解决方案，正如我之前读到的那样，应用程序无法从市场上检索此信息。是否可以在我的服务器上的 html 文件中搜索值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:18:02.823

你想要的是一个非常棒的库，你可以使用一个叫做 aQuery 的库：这是检查升级功能的页面[http://code.google.com/p/android-query/wiki/Service](http://code.google.com/p/android-query/wiki/Service)

它也做得更多。

# python - Python 中的尾随 9

> ID：12112801
> 
> 赞同：0
> 
> 时间：2012-08-24T15:56:48.870
> 
> 标签：python, numpy

> **可能重复：**
> [带有浮点数的 Python 舍入错误](https://stackoverflow.com/questions/5997027/python-rounding-error-with-float-numbers)

我用 numpy as 创建了一个数组`a = numpy.arange(0,1e5,1,dtype=int)`。`a[18645]`正如预期的那样是18645。当我创建另一个数组`b=a*10e-15`时，`b[18645]`是 186.4999999999e-12。`b[18644]`是 186.44e-12。为什么 Python 会创建这些尾随 9？

当我尝试使用`numpy.where`. 使用尾随的 9，该`numpy.where`函数未能在`b`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T15:59:34.080

那是因为它正在转换为不精确的浮点数。由于舍入错误，您得到的结果不是 186.44 - 它显然是一个略小于 186.5 的数字，因此所有 9 都被打印出来。

这里实际上有几个错误来源。首先 1e-15 不能精确地表示为浮点数。其次，乘法可能会引入更多错误。最后，必须将结果转换回十进制，但它有助于在打印时截断结果。

一些琐事 - 1e-15 转换为双精度恰好是 0.00000000000000100000000000000007770539987666107923830718560119501514549256171449087560176849365234375

将此数字乘以 18644 得到 0.0000000000186440000000000017406180102322435293213387375033107673516497015953063 96484375

如您所见，这仍然相当准确。似乎 Numpy 正在使用单个浮点数，这会以指数方式放大错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:06:39.277

这种表示是由浮点表示引起的。

> 当我尝试使用 numpy.where 在数组中搜索元素时出现此问题

您不会在浮点上测试相等性。您测试差异是否低于给定的精度。而你这样做正是因为浮点运算可能会产生意想不到的结果。

事实上，numpy 基于称为[ATLAS的](http://math-atlas.sourceforge.net/)[BLAS](http://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms)，它能够从一系列实现中进行选择以执行特定类型的操作（基于机器的状态）。因此，如果您运行两次相同的程序，您可能会获得不同的结果（如果您打印浮点数的完整表示并查看最后一个数字）。

这只是一个示例，表明相等性测试几乎永远不会在浮点数上以预期的方式工作。

# python - 如何释放 SWIG 返回的 malloc'ed char*

> ID：12112803
> 
> 赞同：4
> 
> 时间：2012-08-24T15:56:56.543
> 
> 标签：python, c, swig

我正在使用 SWIG，我的函数返回一个`char *`被 malloc 的 。SWIG 回归`PyString_FromStringAndSize(my-char-str, len)`。

有没有办法在`my-char-str`不编辑 C 包装器代码的情况下释放它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T22:21:02.650

使用文件`%newobject`中的指令`.i`。来自 SWIG 2.0[文档](http://www.swig.org/Doc2.0/SWIGDocumentation.html#Library_nn11)：

> 如果你有一个像这样分配内存的函数，

```
char *foo() {
   char *result = (char *) malloc(...);
   ...
   return result;
} 
```

> 那么 SWIG 生成的包装器将发生内存泄漏——返回的数据将被复制到一个字符串对象中，而旧的内容将被忽略。
> 
> 要修复内存泄漏，请使用 %newobject 指令。

```
%newobject foo;
...
char *foo(); 
```

# java - 在java中用gson解析json

> ID：12112804
> 
> 赞同：1
> 
> 时间：2012-08-24T15:57:19.043
> 
> 标签：java, json, gson, reddit

我正在尝试解析[这个 json](http://www.reddit.com/r/programming/new.json)并从中创建一个 POJO。在线文档让我感到困惑。我怀疑我错误地处理了同一类型的对象有许多不同出现的事实。我需要一个数组吗？那会是什么样子？到目前为止，这是我的课程：

```
public class StoryGSONClass {
private Response kind;

public static class Response {
    private String Listing;
    private Data data;
}

public static class Data {
    private String modhash;
    private Children children;
    private String after;
    private String before;
}

public static class Children {
    private String childKind;
    private ChildData childData;
}

public static class ChildData {
    private String domain;
    private String banned_by;
    private String media_embed;
    private String subreddit;
    private String selftext_html;
    private String selftext;
    private String likes;
    private String link_flair_text;
    private String id;
    private String clicked;
    private String title;
    private String num_comments;
    private String score;
    private String approved_by;
    private String over_18;
    private String hidden;
    private String thumbnail;
    private String subreddit_id;
    private String edited;
    private String link_flair_css_class;
    private String author_flair_css_class;
    private String downs;
    private String saved;
    private String is_self;
    private String permalink;
    private String name;
    private String created;
    private String url;
    private String author_flair_text;
    private String author;
    private String created_utc;
    private String media;
    private String num_reports;
    private String ups;
} 
```

}

其次是

```
Gson gson = new Gson();    
StoryGSONClass target2 = gson.fromJson(objectName, StoryGSONClass.class); 
```

编辑：这是该课程的最新版本：

```
public class Response {
    private String kind;
    private ResponseData data;

public static class ResponseData {
    private String modhash;
    private List<ResponseChildData> children;
    private String after;
    private String before;
}

public static class ResponseChildData {
    private String kind;
    private ChildData data;
}

public static class ChildData {
    private String domain;
    private String banned_by;
    private Object media_embed;
    private String subreddit;
    private String selftext_html;
    private String selftext;
    private String likes;
    private String link_flair_text;
    private String id;
    private boolean clicked;
    private String title;
    private int num_comments;
    private int score;
    private String approved_by;
    private boolean over_18;
    private boolean hidden;
    private String thumbnail;
    private String subreddit_id;
    private boolean edited;
    private boolean link_flair_css_class;
    private boolean author_flair_css_class;
    private int downs;
    private boolean saved;
    private boolean is_self;
    private String permalink;
    private String name;
    private String created;
    private String url;
    private String author_flair_text;
    private String author;
    private String created_utc;
    private String media;
    private String num_reports;
    private int ups;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:11:05.067

主父对象应如下所示：

```
public class Response {
    private String kind;
    private ResponseData data;

    ...
} 
```

然后`ResponseData`是：

```
public class ResponseData {
    private String modhash;
    private List<ResponseChildData> children; // I imagine this is where you're having
                                              // some confusion. You can use a list here
                                              // and you should be fine.

    ...
} 
```

并且`ResponseChildData`是：

```
public class ResponseChildData {
    private String kind;
    private ChildData data; // This could be a Map<String, String>, but then you'd
                            // possibly lose type information. I haven't used GSON 
                            // enough to know if it would balk when it sees that some
                            // values are int and boolean and refuse to deserialize.
                            // Using a specific type here is probably better anyway

    ...
} 
```

最后`ChildData`是：

```
public class ChildData {
    private String domain;
    private String banned_by;
    ...
    ...
    private int ups;

    ...
} 
```

然后你可以这样做：

```
Gson gson = new Gson();    
Response target2 = gson.fromJson(objectName, Response.class); 
```

# java - 使用 selenium 访问 html5 本地数据库

> ID：12112806
> 
> 赞同：-1
> 
> 时间：2012-08-24T15:57:21.180
> 
> 标签：java, html, selenium

我被要求进行 selenium 测试，检查 html5 的本地数据库并验证那里的信息是否与屏幕上显示的信息相匹配。这是一个可以在 chrome 上使用的移动应用程序，只要 selenium 与 chrome 一起工作，我就可以正常工作。现在我只是试图找到一种可用于 selenium 的方法，该方法将访问本地数据库存储。在数据库存储的 selenium html5 包中有一个接口，但是我不知道它是如何工作的或如何使用它。测试用例是用 Java 编写的。感谢大家对此提供的任何帮助。

我试图创建一个新的数据库存储对象。我尝试创建一个新的结果集对象也尝试实现数据库存储。在用于数据库存储的 API 中，它说它是一个接口，但它没有列出构造函数。当接口没有构造函数时，我不确定如何访问方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T00:34:08.420

```
 // Database Storage
    private ResultSet executeQuery(String statement, String... param) {

      String databaseName = "'HTML5', '1.0'," 
         +" 'Offline document storage', 100*1024";

      return ((DatabaseStorage) driver).executeSQL(databaseName, statement, (Object[]) param);
    } 
```

有关更多详细信息，请参阅 Selenium 的[HTML5 测试](http://code.google.com/p/selenium/source/browse/trunk/common/test/java/org/openqa/selenium/html5/HTML5Test.java?r=10409)。

# python - 在 python VTE 终端小部件上监控命令输入

> ID：12112808
> 
> 赞同：2
> 
> 时间：2012-08-24T15:57:25.267
> 
> 标签：python, terminal, gtk, vte

我希望监视 python VTE 小部件上的每个命令输入，以便我可以将其传递给我的程序以处理与某个正则表达式匹配的命令。有可能吗，我正在连接信号和所有这些东西，但我只是不知道比这更远的东西。请问有什么帮助吗？

谢谢，

# ruby-on-rails - Ruby on Rails 中的关系

> ID：12112811
> 
> 赞同：0
> 
> 时间：2012-08-24T15:57:36.547
> 
> 标签：ruby-on-rails

我有一个存储产品的应用程序（从文件中读取它们，没有给出来自 html 的用户输入）。问题是该产品将有一个发件人。发件人可以是一个或多个对该产品感兴趣的人。现在在我的产品的索引页面上，我有 2 个基本操作，“显示/编辑/销毁”。我想再添加一个操作“添加发件人”，将发件人添加到特定产品。我理解它背后的逻辑，我遇到的问题是语法，因为我是 Rails 新手。

我的产品型号：

```
class Product < ActiveRecord::Base
  attr_accessible :name, :price

   #relationships !
   has_many :senders,  dependent: :destroy #also destroys the senders when product deleted!
end 
```

我的发件人模型

```
class Sender < ActiveRecord::Base
  attr_accessible :application_id, :email, :name

  belongs_to :product
end 
```

我也有这个迁移来表明关系

```
class CreateSenders < ActiveRecord::Migration 
  def change
    create_table :senders do |t|
      t.integer :product_id
      t.string :name
      t.text :email 

      t.timestamps
    end
    add_index :senders, [:product_id, :created_at]
  end 
end 
```

现在我正在考虑创建一个自定义路由，它“位于”“添加发件人”链接后面，并采用“当前”产品的 id。然后我以某种方式创建一个发件人

> product.sender.create/add(user_id??)

请问有什么帮助/指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:47:25.610

您是否使用[宁静路由](http://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default)，如果是，您是否考虑过使用[嵌套资源](http://guides.rubyonrails.org/routing.html#nested-resources)？如果您不使用 RESTful 路由，我肯定会看看它，因为这与您在这里寻找的完全一样。下面的所有内容都假设您使用的是 restful 路由方法，因为它是 Rails 的默认设置，并且非常适合您的用例。

rails 路由的嵌套资源选项允许您在现有路由集下添加一组静态路由，其中​​新的路由集与属于父资源的资源有关。

在这种情况下，发件人将是您的嵌套资源，通过在您的路由中进行设置，您可以创建一个单独的发件人控制器（就像您创建产品控制器一样）来管理它们的创建/删除/等。与简单 CRUD 控制器的唯一区别在于，在您的 senders 控制器中，您可能必须加载产品和发送者（如果您需要访问产品，例如，如果您正在对其进行验证）。可以从路线中的 ID 加载产品（上面的链接都涵盖了这一点）。

如果您只需要几个安静的路线（创建/删除但不是索引/显示），您也可以控制它（更多信息[在这里](http://guides.rubyonrails.org/routing.html#restricting-the-routes-created)）：

```
resources :senders, :only => [:new, :create, :destroy] 
```

# asp.net-web-api - MVC WebAPI 返回 500 错误，没有任何信息

> ID：12112824
> 
> 赞同：6
> 
> 时间：2012-08-24T15:58:28.223
> 
> 标签：asp.net-web-api

我已经有这个问题好几天了（现在已经解决了，任何遇到这个问题并且正在拔头发的人都注意到了解决方案）。

在我对使用 MVC4 WebAPI 获取数据的 Silverlight 应用程序进行最新一轮代码更改后，我的一个 HttpGet Actions 出现问题，它正在返回`IQueryable<oneofmyclasses>`. 使用 Fiddler2 观察请求，我可以看到我收到了内部服务器错误 (500)，没有正文来解释原因。我的操作中没有收到任何错误。

**检查 1：**我确认我的 Action 确实`return collection.AsQueryable();`没有错误。它是

**检查 2：**我使用此代码验证了我的数据正在序列化为 JSON 且没有错误（g 是我的集合）：

```
var json = new JsonMediaTypeFormatter();
            json.SerializerSettings.PreserveReferencesHandling = PreserveReferencesHandling.Objects;
            ObjectContent<IEnumerable<Model.MenuGroup>> responseContent = new ObjectContent<IEnumerable<Model.MenuGroup>>(g, json); 
            MemoryStream ms = new MemoryStream();

            responseContent.CopyToAsync(ms).Wait();
            ms.Position = 0;
            var sr = new StreamReader(ms);
            var str = sr.ReadToEnd(); 
```

这也奏效了。我还使用 XML 格式化程序对其进行了测试，尽管我很确定它只使用过 JSON（不能太小心）。

**检查 3：**启用 .Net Framework 调试。这次发生错误时（在 HttpApplication.cs 中）VS 2012 捕获了它。

我的错误：

尽管用这些属性标记了属性，

```
[XmlIgnore]
[IgnoreDataMember]
[JsonIgnore] 
```

.Net Source 正在调用我的一个属性。问题是，它是一个只写属性。我只是添加了

```
get { return null; } 
```

问题就解决了。

我可能应该先完成检查 3，但我之前对这个错误的经验表明，它通常是尝试序列化我的对象的错误，这就是为什么当它们正确序列化时我有点头疼并且错误坚持。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T16:03:21.170

我是如何解决的：

启用 .Net Framework 调试。工具 -> 选项 -> 调试 -> 选中“启用 .NET Framework 源单步执行”

这次发生错误时（在 HttpApplication.cs 中）VS 2012 捕获了它。

# php - URL 编码：在 php 中将 ® 转换为 %AE？

> ID：12112828
> 
> 赞同：0
> 
> 时间：2012-08-24T15:58:42.787
> 
> 标签：php

我正在抓取一个站点并提取一些具有特殊字符的产品内容，例如`&reg;` 特殊字符在浏览器中显示得很好，但它们弄乱了我的 Omniture 标签，特别是 s.products 标签。s.products 变量用分号划分其部分，每个产品共有 6 个部分（s.products="Category";"Product name";"Quantity";"Total Price";"Incrementor";" Merchandising”）。如果产品`&reg;`的名称中有，则在 s.products 变量字符串中添加一个额外的分号。这会将字符串中的所有内容都弄乱，并将字符串中的所有内容都向右移动，从而影响数量和价格。

有没有办法对产品名称使用 URL 编码，以便将其`&reg;`转换为`%AE`? 我尝试了 rawurlencode 和 htmlspecialchars 函数，但它们不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:20:09.903

同时使用`html_entity_decode`和`urlencode`：

```
php > echo urlencode(html_entity_decode("&reg;"));
%AE 
```

或者，您可以正则表达式替换所有 htmlentities：

```
$pattern = "/&\w+;/";
$callback = function($matches) {
    return urlencode(html_entity_decode($matches[0]));
};
$subject = "&reg; &copy;";
echo preg_replace_callback($pattern, $callback, $subject); // %AE %A9 
```

# c# - DirectShowLib - 使用网络摄像头只能拍摄一张照片。出现“系统资源不足，无法完成请求的服务”错误

> ID：12112830
> 
> 赞同：3
> 
> 时间：2012-08-24T15:58:47.390
> 
> 标签：c#, visual-studio, webcam, directshow

我正在使用 Visual Studio 2012 并使用 C#，我正在使用库 DirectShowLib 从我的网络摄像头拍照，但我只能拍一张照片，如果我尝试拍摄另一张照片，则会出现异常：

```
 DirectShowLib.DsError.ThrowExceptionForHR(Int32 hr)
   at SnapShot.Capture.SetupGraph(DsDevice dev, Int32 iWidth, Int32 iHeight, Int16 iBPP, Control hControl) in c:\Users\devel_000\Documents\Visual Studio 2012\Projects\ControlAcceso\ControlAcceso\Capture.cs:line 323
   at SnapShot.Capture..ctor(Int32 iDeviceNum, Int32 iWidth, Int32 iHeight, Int16 iBPP, Control hControl) in c:\Users\devel_000\Documents\Visual Studio 2012\Projects\ControlAcceso\ControlAcceso\Capture.cs:line 86
   at ControlAcceso.PhotoWindow..ctor() in c:\Users\devel_000\Documents\Visual Studio 2012\Projects\ControlAcceso\ControlAcceso\PhotoWindow.cs:line 32
   at ControlAcceso.CheckWindow.pbPhoto_Click(Object sender, EventArgs e) in c:\Users\devel_000\Documents\Visual Studio 2012\Projects\ControlAcceso\ControlAcceso\CheckWindow.cs:line 108
   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
   at ControlAcceso.Program.Main() in c:\Users\devel_000\Documents\Visual Studio 2012\Projects\ControlAcceso\ControlAcceso\Program.cs:line 18
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

我正在使用 DxSnap 示例[[链接]](http://sourceforge.net/projects/directshownet/files/DirectShowSamples/2010-February/)来拍照。在方法 SetupGraph [[link]中抛出异常](http://pastebin.com/mszs73UP)

这条线`DirectShowLib.DsError.ThrowExceptionForHR(Int32 hr)`引起了我的注意，这是什么意思？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T20:23:05.257

错误`-2147023446`是“系统资源不足，无法完成请求的服务” `0x800705AA`。`ERROR_NO_SYSTEM_RESOURCES`（请参阅[这篇文章和工具](http://alax.info/blog/1383)`HRESULT`，了解如何轻松方便地读取值）。

我会说您很可能正在尝试打开第二个管道而不先关闭。并且视频捕获设备是专门打开的，因此如果有另一个仍然处于活动状态，您将无法启动管道。错误代码正是暗示了这一点。

为了解决这个问题，您需要确保调用`IMediaControl.Stop`以前的过滤器图，并使用`Marshal.ReleaseComObject`.

# android - 进行选择查询时调用javaToSqlArg？

> ID：12112833
> 
> 赞同：1
> 
> 时间：2012-08-24T15:59:00.017
> 
> 标签：android, enums, ormlite

所以我发布了这个问题，[使用枚举属性作为 ormlite 列值而不是序数。是否可以？](https://stackoverflow.com/q/12042098/382115)，关于如何使用 anum 属性值作为传递给数据库的值而不是名称，并且它起作用了。我使用 javaToSqlArg（用于插入数据库）和 sqlArgoToJava 方法创建了持久类，用于从数据库中检索数据到对象。

问题似乎是在做后者时。该`javaToSqlArg`方法在我希望在查询`sqlArgToJava`时直接调用的方法之前调用。`select`这里再次是持久类：

```
public class MyEnumPersister extends EnumStringType{

    private static final MyEnumPersister singleTon = new MyEnumPersister();

    protected MyEnumPersister() {
        super(SqlType.STRING, new Class<?>[] { Enum.class });
    }

    public static MyEnumPersister getSingleton() {
        return singleTon;
    }

    @Override
    public Object javaToSqlArg(FieldType fieldType, Object obj) {
        if(obj instanceof EstadoPedido){
            return ((EstadoPedido)obj).getEstadoValue();
        }else if(obj instanceof TipoPedido){
            return ((TipoPedido)obj).getTipoValue();
        }
        return obj;
    }               

    @Override
    public Object sqlArgToJava(FieldType fieldType, Object sqlArg, int columnPos) throws SQLException {
        if(fieldType.getColumnName().equals(PedidoDTO.ESTADO_FIELD_NAME)){  
            return PedidoDTO.siglaEstadoPedidoComparator((String)sqlArg);
        }else{
            return PedidoDTO.siglaTipoPedidoComparator((String)sqlArg);
        }
    }
} 
```

和 dto 类：

```
public class PedidoDTO extends IpdmsMobileDTO {

    private static final long serialVersionUID = 268620648774735484L;

    public final static String SIGLA_ESTADO_ENVIADO="E";
    public final static String SIGLA_ESTADO_PENDENTE="P";
    public final static String SIGLA_ESTADO_CANCELADO="C";
    public final static String SIGLA_ESTADO_CANCELADOALTERADO="CAP";

    public final static String SIGLA_TIPO_REGISTARNOTIFICATIORESPOSTA="RNR";

    //ormlime column names
    public final static String ESTADO_FIELD_NAME = "estado";
    public final static String TIPO_FIELD_NAME = "tipo";
    public final static String DATAENVIO_FIELD_NAME = "data_envio";
    public final static String ENTIDADE_ID_FIELD_NAME = "entidade_id";

    @DatabaseField(columnName=ESTADO_FIELD_NAME, persisterClass=MyEnumPersister.class)
    private EstadoPedido estado;
    @DatabaseField(columnName=TIPO_FIELD_NAME,  persisterClass=MyEnumPersister.class)
    private TipoPedido tipo;
    @DatabaseField(columnName=DATAENVIO_FIELD_NAME)
    private Date dataEnvio;
    @DatabaseField(columnName=ENTIDADE_ID_FIELD_NAME)
    private int idEntidade;

    public PedidoDTO() {
        //for ormlite
    }   

    public EstadoPedido getEstado() {
        return estado;
    }

    public void setEstado(String estado) {
        this.estado=siglaEstadoPedidoComparator(estado);
    }

    public static EstadoPedido siglaEstadoPedidoComparator(String estado){
        if (estado.equals(SIGLA_ESTADO_PENDENTE))
            return EstadoPedido.PENDENTE;
        else if (estado.equals(SIGLA_ESTADO_ENVIADO))
            return EstadoPedido.ENVIADO;
        else if(estado.equals(SIGLA_ESTADO_CANCELADO))
            return EstadoPedido.CANCELADO;
        else
            return EstadoPedido.CANCELADOALTERADOPREV;
    }

    public TipoPedido getTipo() {
        return tipo;
    }

    public void setTipo(String tipo) {
        //set tipo do pedido
        this.tipo =siglaTipoPedidoComparator(tipo);
    }

    public static TipoPedido siglaTipoPedidoComparator(String tipo){
        return TipoPedido.REGISTARNOTIFICACAORESPOSTA;
    }

    public enum EstadoPedido{
        ENVIADO  ("Enviado"  ,SIGLA_ESTADO_ENVIADO), 
        PENDENTE ("Pendente" ,SIGLA_ESTADO_PENDENTE),
        CANCELADO("Cancelado",SIGLA_ESTADO_CANCELADO),
        CANCELADOALTERADOPREV("Cancelado/Alterado Previamente",SIGLA_ESTADO_CANCELADO);

        private String estadoName;  
        private String estadoValue;

        EstadoPedido(String estadoName,String estadoValue){
            this.estadoName=estadoName;
            this.estadoValue=estadoValue;
        }

        public String getEstadoName(){
            return estadoName;
        }

        public String getEstadoValue(){
            return estadoValue;
        }
    }

    public enum TipoPedido {
        REGISTARNOTIFICACAORESPOSTA("Registar Notificação Resposta",SIGLA_TIPO_REGISTARNOTIFICATIORESPOSTA);

        private String tipoName;    
        private String tipoValue;

        TipoPedido(String tipoName,String tipoValue){
            this.tipoName=tipoName;
            this.tipoValue=tipoValue;
        }

        public String getTipoName(){
            return tipoName;
        }

        public String getTipoValue(){
            return tipoValue;
        }
    }
} 
```

和查询：

```
public List<PedidoDTO> getPendingRequests(){

    List<PedidoDTO> pendingReq=null;
    QueryBuilder<PedidoDTO, Integer> queryBuild=null;

    try {
        queryBuild=getHelper().getPedidosDao().queryBuilder();
        pendingReq=queryBuild.where().eq(PedidoDTO.ESTADO_FIELD_NAME, PedidoDTO.SIGLA_ESTADO_PENDENTE).query();
    } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return pendingReq;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T14:24:23.367

> 该`javaToSqlArg`方法在`sqlArgToJava`我希望在进行选择查询时直接调用的方法之前调用。这里再次是持久类：

[ORMLite](http://ormlite.com/)试图与这个@Max 保持一致。您将 Java 值传递给`eq`比较方法，它会尝试对其执行与将其存储到数据库时相同的转换。在这种情况下，由于 Java 字段是`EstadoPedido`or `TipoPedido`，因此您传递给`eq`方法的值也应该是那个。

因此，您的`QueryBuilder` `eq`调用应该使用枚举值*而不是*a`String`并且应该更改为：

```
where().eq(PedidoDTO.ESTADO_FIELD_NAME, EstadoPedido.PENDENTE) 
```

我想我是对的。

# tsql - 从 syscomments 中分离出 JOIN 谓词

> ID：12112834
> 
> 赞同：0
> 
> 时间：2012-08-24T15:59:03.620
> 
> 标签：tsql, analysis

为了更好地理解数据库中的所有关系（物理和逻辑），我正在寻找存储过程以提取连接谓词。我有一些我可以使用的东西，但它并不完整。

目标是在结果中有 3 列：

1.  对象名称
2.  第一个连接谓词
3.  第二个连接谓词
4.  连接类型（内、右、左）

    ```
    declare @Schema varchar(50),@SearchString   VARCHAR (10)

    set @SearchString = 'join';

    set  @Schema = 'dbo'

    declare @TextBuffer table 
    (
    SchemaName varchar(50) NOT NULL,
    ObjectName varchar(100) NOT NULL,
    Occurance int NOT NULL, 
    Txt varchar(4000) NOT NULL,
    Colid int
    )

    declare @Occurance table
    (
    SchemaName varchar(50)   NULL,
    ObjectName varchar(100)   NULL,
    Occurance  varchar(500) 
    )

    INSERT INTO @TextBuffer

    SELECT   DISTINCT SCHEMA_NAME(o.schema_id),
                      o.name,
                      (LEN(text) - LEN(REPLACE(text, @SearchString, ''))) / LEN(@SearchString),
                      [text],
                      colid
    FROM     syscomments AS c
             INNER JOIN
             sys.objects AS o
             ON c.id = o.[object_id]
             INNER JOIN
             sys.schemas AS s
             ON o.schema_id = s.schema_id
    WHERE    text LIKE '%' + @SearchString + '%'
             AND SCHEMA_NAME(o.schema_id) = @Schema
    ORDER BY colid, 3 DESC;

    DECLARE @Txt varchar(4000), @ObjectName varchar(100), @Occ int, @SchemaName varchar(100)

    declare @count int, @position int
    set @count = 0
    set @position = 0

    DECLARE my_cursor CURSOR FAST_FORWARD FOR 

    SELECT Txt,ObjectName, Occurance, SchemaName from @TextBuffer
    OPEN my_cursor

    FETCH NEXT FROM my_cursor INTO @Txt,@ObjectName,@Occ,@SchemaName

    WHILE @@FETCH_STATUS = 0
    BEGIN

        set @count =  @Occ

        while(@count > 0)
            begin 

            set @position =  charindex(@SearchString,@Txt) 

            insert into @Occurance select @SchemaName, @ObjectName, cast(substring(@Txt, @position, len(@Txt)) as varchar(500))

            set @Txt =  substring(substring(@Txt,len(@SearchString),len(@Txt)), @position, len(@Txt))

            set @count = @count -1

            end

    FETCH NEXT FROM my_cursor INTO @Txt,@ObjectName,@Occ,@SchemaName
    END

    CLOSE my_cursor 
    DEALLOCATE my_cursor 

    select * from @Occurance 
    ```

# macos - 将 iCal 结束日期中的所有事件更改为一个特定日期的 Apple 脚本

> ID：12112838
> 
> 赞同：2
> 
> 时间：2012-08-24T15:59:23.353
> 
> 标签：macos, applescript

我是 Mac 新手。我有大约 50 个未指定结束日期的重复事件。我计划将所有重复事件更改为特定的结束日期。我正在寻找一个苹果脚本来一次更改它。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:25:35.783

以下脚本应该可以满足您的需要。您需要从“主页”将标题更改为您感兴趣的日历名称。您需要将结束日期从“20130902”更改为您需要的任何日期（格式为 YYYYMMDD）。

无论出于何种原因，iCal 似乎从该结束日期减去 1 天，因此在此示例中，结束日期将全部设置为 2013 年 9 月 1 日。

```
tell application "Calendar"
  repeat with thisCal in (calendars whose title is "Home")
    setEndDate of me to "20130902" for thisCal
  end repeat
end tell

on setEndDate to endDate for thisCalendar
  tell application "Calendar"
    repeat with thisEvent in (events of thisCalendar)
      if recurrence of thisEvent is not missing value and recurrence of thisEvent does not contain "UNTIL" then
        set recurrence of thisEvent to recurrence of thisEvent & ";UNTIL=" & endDate
      end if
    end repeat
  end tell
end setEndDate 
```

# javascript - 如何检测对 HTML5“下载”属性的支持？

> ID：12112844
> 
> 赞同：45
> 
> 时间：2012-08-24T16:00:00.997
> 
> 标签：javascript, html

HTML5 中实现的新功能之一是`download`锚标记的属性。此属性的好处是它为用户提供了下载在客户端应用程序中创建的内容的方法，例如图像（例如，从画布转换而来）。

目前，对这个功能的支持很差，所以我想知道如何在浏览器中检测到对这个功能的支持。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-08-24T16:04:53.003

使用[Modernizr](https://github.com/Modernizr/Modernizr/blob/master/feature-detects/a/download.js)方法：创建元素，并检查属性是否已定义：

```
var a = document.createElement('a');
if (typeof a.download != "undefined") {
    alert('has support');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-07T00:05:19.850

`if`使事情简化的单行条件：

```
if (document.createElement('a').download==undefined && e.target.hasAttribute('download'))
{
 e.preventDefault();
 console.log('Error: this is a download link, please right-click to save the file.');
} 
```

对该`download`属性的支持参差不齐（Chrome 14+、Firefox 20+、IE13+、Safari 10+，并且在（真正的）Opera 中不支持。上面的脚本不会干扰支持的浏览器。

# iphone - Facebook iOS SDK 3.0，在 url 上实现类似的操作？

> ID：12112847
> 
> 赞同：7
> 
> 时间：2012-08-24T16:00:23.807
> 
> 标签：iphone, objective-c, facebook, facebook-graph-api, facebook-ios-sdk

我正在尝试使用 Facebook iOS SDK 3.0 通过 facebook open-graph-api 实现 Like。除了 FbGraphObject 之外，一切似乎都正常工作，那是因为我不知道它应该是什么样子，因为这显然不起作用。

我想要做的是喜欢一个作为对象发布的 url。一个简单的 Like with 通过开放图。

我得到以下代码的错误消息是：

```
The action you're trying to publish is invalid because it does not specify any 
reference objects. At least one of the following properties must be specified: object. 
```

我使用的代码是这样的：

```
 FBGraphObject *objectToLike = [[FBGraphObject alloc]initWithContentsOfURL:[NSURL URLWithString:facebookLike.titleLabel.text]];

    FBRequest *requestLike = [[FBRequest alloc]initForPostWithSession:[FBSession activeSession] graphPath:@"me/og.likes" graphObject:objectToLike];

    FBRequestConnection *connection = [[FBRequestConnection alloc] init];
    [connection addRequest:requestLike
         completionHandler:
     ^(FBRequestConnection *connection, id result, NSError *error) {
         if (!error &&
             result) {

             DLog(@"NothingWentWrong");
         }

         DLog(@"MajorError: %@", error);

     }
     ];

    [connection start]; 
```

* * *

更新：

检查了更多信息，我猜它使用此方法： [https ://developers.facebook.com/docs/sdk-reference/iossdk/3.0/class/FBGraphObject/#//api/name/graphObject](https://developers.facebook.com/docs/sdk-reference/iossdk/3.0/class/FBGraphObject/#//api/name/graphObject)

以某种方式创建一个对象。这是我可能需要使用的 graphObject 方法。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T09:18:19.367

我实际上已经设法为此创建了一个简单且非常肮脏的解决方案。该解决方案似乎不是最佳解决方案，但它目前是一个可行的解决方案。

如果有人在这个网址上使用过 Facebook 上的资源管理器工具： [https ://developers.facebook.com/tools/explorer/](https://developers.facebook.com/tools/explorer/)

你知道当 facebook 分享一个赞时 URL 的样子。它必须具有 URL 和访问令牌。因此，我的解决方案变成了忽略从 Facebook SDK 发送任何内容，而只是将发布请求发送到我在资源管理器工具中使用的相同 URL。

如果您仔细观察，在 facebooks 文档中似乎有一些引用它，但没有人准确解释如何实际建立连接，所以这是我的解决方案：

```
NSString *urlToLikeFor = facebookLike.titleLabel.text;

NSString *theWholeUrl = [NSString stringWithFormat:@"https://graph.facebook.com/me/og.likes?object=%@&access_token=%@", urlToLikeFor, FBSession.activeSession.accessToken];
NSLog(@"TheWholeUrl: %@", theWholeUrl);

NSURL *facebookUrl = [NSURL URLWithString:theWholeUrl];

NSMutableURLRequest *req = [NSMutableURLRequest requestWithURL:facebookUrl];
[req setHTTPMethod:@"POST"];

NSURLResponse *response;
NSError *err;
NSData *responseData = [NSURLConnection sendSynchronousRequest:req returningResponse:&response error:&err];
NSString *content = [NSString stringWithUTF8String:[responseData bytes]];

NSLog(@"responseData: %@", content); 
```

如果您查看代码，我只需获取 url 并将两个动态字符串放入 url，一个带有 object-url，一个带有访问令牌。我创建了一个 URLRequest 并使其成为一个 POST 请求，并且来自 facebook 的响应被记录下来，因此人们实际上可以看到类似的事情是否通过。

实际请求可能会进行一些性能改进，但如果您发现任何减速，我将由您决定。

我仍然对其他解决方案感兴趣，但这是我现在将使用的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T22:51:29.783

我们目前不通过我们的 Graph API 支持 Like。你可以看到的是这样的： [https ://developers.facebook.com/docs/opengraph/actions/builtin/likes/](https://developers.facebook.com/docs/opengraph/actions/builtin/likes/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T08:31:37.757

我不确定是什么`initWithContentsOfURL`，但从名称我猜它会尝试从给定的 URL（？）实际加载内容。

您只需将 URL 作为文本参数提供 - URL代表 Open Graph 对象*。*Facebook 将完成剩下的工作，抓取该 URL 后面的页面并读取它的 OG 元标记等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:07:44.983

也许只是这个？

```
 FBRequest *requestLike = [[FBRequest alloc]initForPostWithSession:[FBSession activeSession]
    graphPath:@"me/og.likes"
    graphObject:[NSURL URLWithString:facebookLike.titleLabel.text]]; 
```

# php - 给定一个日期，找到下一个日期，它是一周中的特定日期

> ID：12112851
> 
> 赞同：0
> 
> 时间：2012-08-24T16:00:44.547
> 
> 标签：php

给定一个日期，我想找到下一个日期，即一周中的特定日期。例如。

```
Today (8/24/2012)

Find next Sunday(0) returns 8/26/2012
Find next Friday(5) returns 8/24/2012 (Today's a Friday) 
```

我可以使用以下方法找到特定日期的星期几：

```
date("w", timeStamp) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:05:27.503

您可以使用[`strtotime()`](http://php.net/manual/en/function.strtotime.php)：

打电话`strtotime("next Sunday");`会给你下周日的 Unix 时间戳。

您可以为其提供第二个参数，即 Unix 时间戳，“下周日”将与该日期相关。

# jquery - 我是如何打破 slides.js 的“幻灯片”的？

> ID：12112854
> 
> 赞同：0
> 
> 时间：2012-08-24T16:00:56.320
> 
> 标签：jquery

在我们的网站上实现[slides.js](http://slidesjs.com/)，我似乎以某种方式导致实际的滑动动画停止工作。幻灯片/图像会改变，但没有伴随的动画。如果我指定“淡入淡出”动画，那么它会起作用，但不幸的是，指定“幻灯片”并没有相同的效果。我正在使用 jquery 1.8.0，不知道这是否与它有关，但我似乎对旧版本的 jquery 有同样的问题。

这是我的意思的一个例子：http: [//jsfiddle.net/x45fE/1/](http://jsfiddle.net/x45fE/1/)

从小提琴，HTML：

```
<script type="text/javascript" src="http://slidesjs.com/examples/images-with-captions/js/slides.min.jquery.js"></script>

<div id="bannerSlider">
    <div class="slides_container">
            <div class="slide">
                    <a href="#">
                        <img src="//placehold.it/200/ffffff/">
                    </a>
            </div>
                    <div class="slide">
                    <a href="#">
                        <img src="//placehold.it/200x200">
                    </a>
            </div>

                    <div class="slide">
                    <a href="#">
                        <img src="//placehold.it/200/ffffff/">
                    </a>
            </div>

                    <div class="slide">
                    <a href="#">
                        <img src="//placehold.it/200x200">
                    </a>
            </div>

    </div>                    
</div>test 
```

CSS：

```
#ribbon {
    position:absolute;
    top:-3px;
    left:-15px;
    z-index:500;
}

#frame {
    position:absolute;
    z-index:0;
    width:739px;
    height:341px;
    top:-3px;
    left:-80px;
}

/*
    Slideshow
*/

#slides {
    position:absolute;
    top:15px;
    left:4px;
    z-index:100;
}

/*
    Slides container
    Important:
    Set the width of your slides container
    Set to display none, prevents content flash
*/

.slides_container {
    width:570px;
    overflow:hidden;
    position:relative;
    display:none;
}

/*
    Each slide
    Important:
    Set the width of your slides
    If height not specified height will be set by the slide content
    Set to display block
*/

.slides_container div.slide {
    /*width:570px;*/
    /*height:270px;*/
    display:block;
}

/*
    Next/prev buttons
*/

#slides .next,#slides .prev {
    position:absolute;
    top:107px;
    left:-39px;
    width:24px;
    height:43px;
    display:block;
    z-index:101;
}

#slides .next {
    left:585px;
}

/*
    Pagination
*/

.pagination {
    margin:5px auto 0;
    width:100px;
}

.pagination li {
    float:left;
    margin:0 1px;
    list-style:none;
}

.pagination li a {
    display:block;
    width:12px;
    height:0;
    padding-top:12px;
    background-image:url(http://slidesjs.com/examples/images-with-captions/img/pagination.png);
    background-position:0 0;
    float:left;
    overflow:hidden;
}

.pagination li.current a {
    background-position:0 -12px;
}

/*
    Caption
*/

.caption {
    z-index:500;
    position:absolute;
    bottom:-35px;
    left:0;
    height:30px;
    padding:5px 20px 0 20px;
    background:#000;
    background:rgba(0,0,0,.5);
    width:540px;
    font-size:1.3em;
    line-height:1.33;
    color:#fff;
    border-top:1px solid #000;
    text-shadow:none;
}
#bannerSlider {
    float:left;
    width:200px;
    padding:5px;
    background:#fff;
    border:1px solid #ccc;
}

#bannerSlider div.slide {
    height: 200px;
} 
```

javascript:

```
jQuery(function() {
    jQuery('#bannerSlider').slides({
        play: 2000

    });
}); 
```

我很感激对此的任何反馈，过去一个小时我一直在扯头发。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:05:04.670

您需要注释掉 CSS 的以下部分

```
.slides_container {
    width:570px;
    overflow:hidden;
    position:relative;
    display:none;
} 
```

# sql - with(nolock) 或 (nolock) - 有区别吗？

> ID：12112855
> 
> 赞同：49
> 
> 时间：2012-08-24T16:01:08.090
> 
> 标签：sql, sql-server, select, sql-server-2008-r2, nolock

*一切都基于 with(nolock) 完全适合这种情况的假设。已经有很多问题在争论是否使用 with(nolock)。*

我环顾四周，无法找到 using 之间是否存在实际区别`with(nolock)`：

```
select customer, zipcode from customers c with(nolock) 
```

或者只是`(nolock)`：

```
select customer, zipcode from customers c (nolock) 
```

两者在功能上有区别吗？风格？
一个比另一个旧并且有可能被弃用？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-08-24T16:07:34.240

没有功能上的区别，但最终没有的语法`WITH`将不起作用。这已被弃用：

```
select customer, zipcode from customers c (nolock) 
```

所以你应该使用这种格式：

```
select customer, zipcode from customers c with (nolock) 
```

`WITH`至少从 SQL Server 2008 开始，不推荐使用表提示的关键字。在以下主题中搜索短语`Specifying table hints without using the WITH keyword.`：

[http://msdn.microsoft.com/en-us/library/ms143729%28SQL.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms143729%28SQL.100%29.aspx)

（当然，关于你是否应该使用`nolock`的讨论是分开的。[我在这里写过关于它们的博客](http://blogs.sqlsentry.com/aaronbertrand/bad-habits-nolock-everywhere/)。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-18T19:32:16.903

虽然我们没有发现 (nolock) 和 with(nolock) ... with (nolock) 之间的区别在 SQL Server 2000 版本中不起作用。

而且我还注意到，当您尝试从链接的服务器中提取数据时，仅 ' (nolock) ' 将不起作用，而您应该使用 ' with (nolock) '。

```
-- this will not work 
select * from server1.DB1.dbo.table1 (nolock)

-- this will  work 
select * from server1.DB1.dbo.table1 with (nolock) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-24T16:06:57.067

这实际上取决于您使用的 SQL Server 版本。

查看 SQL Server 2012[表提示](http://msdn.microsoft.com/en-us/library/ms187373.aspx)省略的最新文档`WITH`是一项已弃用的功能。所以 while`from customers c (nolock)`可能会起作用；你真的应该使用`from customers c WITH (nolock)`

请注意，这不同于`from customers nolock`; 其中 nolock 将用作表别名。

功能上；他们似乎是一样的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-18T13:35:40.527

我对 170000+ 数据行的结果进行了尝试，但是通过查询执行计划我没有看到任何差异。两者的工作方式相同。

# r - 带有“地图”包的布局

> ID：12112867
> 
> 赞同：0
> 
> 时间：2012-08-24T16:02:08.690
> 
> 标签：r

使用 maps 包时，我在获取某个绘图布局时遇到了一些麻烦。这是我正在尝试的：

```
library(maps)
library(mapdata)
aa <- rep(1,5); ab <- c(2,3,1,1,1)
mat <- rbind(aa,aa,aa,ab)
layout(mat)
map('state', mar=c(0,0,0,0))
map('worldHires', region='USA:Alaska', xlim=c(-175,-120))
map('worldHires', region='Hawaii', xlim=c(-161,-154.5)) 
```

这是我收到的错误：

```
Error in plot.new() : plot region too large 
```

通常我会弄乱边距来解决这个错误，但这似乎不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T16:23:06.620

您可以通过在绘制每个新地图之前设置边距来解决此问题：

```
layout(mat)
map('state')
par(mar=c(0,0,0,0))
map('worldHires', region='USA:Alaska', xlim=c(-175,-120), col="blue")
par(mar=c(0,0,0,0))
map('worldHires', region='Hawaii', xlim=c(-161,-154.5), col="blue") 
```

![在此处输入图像描述](../Images/0d595dbc3eca42fbcfe6bf36657fbc47.png)

* * *

通过[https://stat.ethz.ch/pipermail/r-help/2006-September/113030.html](https://stat.ethz.ch/pipermail/r-help/2006-September/113030.html)

# django - django 评分以及一对一字段

> ID：12112869
> 
> 赞同：0
> 
> 时间：2012-08-24T16:02:14.827
> 
> 标签：django, django-models, django-apps

# 模型.py

```
class Restaurant(models.Model):
    #fields here

class Food(models.Model):
    rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True)
    restaurant = models.OneToOneField(Restaurant)

class Service(models.Model):
    rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True)
    restaurant = models.OneToOneField(Restaurant) 
```

# 怀疑

我想如何将食物和服务与餐厅模式结合起来，并且也能够对它们进行评分，请帮助，在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:09:18.350

代替：

```
class Restaurant(models.Model):
    #fields here

class Food(models.Model):
    rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True)
    restaurant = models.OneToOneField(Restaurant)

class Service(models.Model):
    rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True)
    restaurant = models.OneToOneField(Restaurant) 
```

尝试：

```
class Restaurant(models.Model):
    #fields here
    food_rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True)
    service_rating = RatingField(range=5, weight=5,can_change_vote = True,allow_delete = True,allow_anonymous = True) 
```

[吻](http://en.wikipedia.org/wiki/KISS_principle)

# jsf - JSF + Trinindad 使用 使用必需属性的组件

> ID：12112872
> 
> 赞同：0
> 
> 时间：2012-08-24T16:02:27.960
> 
> 标签：jsf, trinidad

我正在使用 trinidad 库，当从后备 bean 在 tr:inputText 组件上设置所需的属性时，组件会向右移动。这会导致组件与面板框容器中包含的其他组件不对齐。

有谁知道如何解决这个问题？

谢谢，约翰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T09:24:02.153

我会使用 CSS 解决它。如果我是正确的，则将`<tr:inputText/>`其呈现为您`styleClass`设置为的表格`inputStyle`。然后所需的指标将出现在第一行的第一个单元格中（甚至不需要输入）。因此，您可以尝试以下操作：

```
.inputStyle tr:first-child td:first-child {
  width: 20px;
} 
```

# c# - 在 C# 5 中是否更改了 foreach 对变量的使用？

> ID：12112881
> 
> 赞同：39
> 
> 时间：2012-08-24T16:03:27.620
> 
> 标签：c#, foreach, .net-4.5, c#-5.0

在这个答案中[https://stackoverflow.com/a/8649429/1497](https://stackoverflow.com/a/8649429/1497) Eric Lippert 说“仅供参考，我们很可能在下一版本的 C# 中解决这个问题；这是开发人员的主要痛点”关于如何foreach 循环使用该变量。

> 在下一个版本中，每次运行“foreach”循环时，我们都会生成一个新的循环变量，而不是每次都关闭同一个变量。这是一个“破坏性”更改，但在绝大多数情况下，“破坏”将是修复而不是导致错误。

我还没有找到任何表明已经进行此更改的信息。是否有任何迹象表明这就是 foreach 循环在 C# 5 中的工作方式？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-08-24T16:07:51.347

这是对 C# 语言的更改，而不是对 .NET 框架的更改。因此，它只影响在 C# 5.0 下编译的代码，而不管该代码将在哪个 .NET 框架版本上执行。

## C# 5.0

规范的第 8.8.4 节明确表示已经进行了此更改。具体来说，C# 5.0 规范的第 249 页指出：

```
foreach (V v in x) embedded-statement 
```

> 然后扩展为：

```
{
    E e = ((C)(x)).GetEnumerator();
    try {
        while (e.MoveNext()) {
            V v = (V)(T)e.Current;
            embedded-statement
        }
    }
    finally {
        … // Dispose e
    }
} 
```

然后：

> v 在 while 循环中的位置对于嵌入语句中出现的任何匿名函数如何捕获它很重要。

## C# 4.0

与 C# 4.0 规范相比，规范的这种更改很明显（再次在第 8.8.4 节中，但这次是第 247 页）：

```
foreach (V v in x) embedded-statement 
```

> 然后扩展为：

```
{
    E e = ((C)(x)).GetEnumerator();
    try {
        V v;
        while (e.MoveNext()) {
            v = (V)(T)e.Current;
            embedded-statement
        }
    }
    finally {
        … // Dispose e
    }
} 
```

请注意，变量`v`是在循环外部而不是内部声明的，就像在 C# 5.0 中一样。

## 笔记

您可以在 Visual Studio 的安装文件夹下找到 C# 规范`VC#\Specifications\1033`。VS2005、VS2008、VS2010 和 VS2012 就是这种情况，让您可以访问 C# 1.2、2.0、3.0、4.0 和 5.0 的规范。您还可以通过搜索在 MSDN 上找到规范`C# Specification`。

# php - 在不同的页面，特定的 div 中回显登录错误

> ID：12112882
> 
> 赞同：0
> 
> 时间：2012-08-24T16:03:28.040
> 
> 标签：php, html, css

这个问题耽误了太久。我有一个 index.php 包括表单和 login.php 处理它。

如何在 index.php 的特定 div 中发布错误？这是 Index.php 容器，idnex.php 中还没有 php 代码。

```
 <div id="container">
    <section>
        <h1>ברוכים הבאים לאתר קופונים</h1>
        <h2>המקום בו תוכלו למצוא קופונים בסביבתכם</h2>
        <hr>
    </section>

    <section id="mainpage">
            <p class="welcome">
                אנא התחבר בכדי ליצור ולראות קופונים בקרבתך</br>
                <a href="php/register.php">הירשם לאתר</a> 
            </p>

            <form action="php/login.php" method="post" class="form">
                <p class="email">
                    <input type="text" name="email" /> :דואר אלקטרוני</br>
                </p>
                <p class="password">
                    <input type="password" name="password" /> :סיסמא</br>
                </p>
                <p class="submit">  
                    <input type="submit" value="היכנס" />  
                </p>  
            </form>
    </section>
</div> 
```

这是 login.php 错误报告部分

```
 //check matching input
        if($email == $dbemail && $password = $dbpassword){
            $_SESSION['email'] = $dbemail;
            include('../index.php');
            header('members.php');

        }
        else{
            include('../index.php');
            echo "Incorrect Password<style text-align:center;/>";
        }
    }

} else
    include('../index.php');
    die('<p class="error">User does not exist</p>');
} else
    include('../index.php');
    die('Please enter a Email and password'); 
```

试过这个

```
include('../index.php');
    die('<p class="error">User does not exist</p>'); 
```

无法将其具体定位在“提交”按钮下（使用边距：0 auto 所以左右变化）

感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:08:29.693

更改您的`login.php`文件：

```
} else {
   // error happened
   $error = '<p class="error">User does not exist</p>'
   include('../index.php');
   exit;
... 
```

和你的 index.php 文件：

```
<form action="php/login.php" method="post" class="form">
<?php
if(isset($error)) echo $error;
?>
<p class="email">
   <input type="text" name="email" /> :דואר אלקטרוני</br>
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:10:55.587

问题是，是你的`login.php`文件直接`echo`把错误信息出来了。更好的方法是将消息保存到一个变量中——即使是一个会话变量也足够了（因为看起来你没有使用 OOP，通过示例代码）。

尝试将错误消息更新为不使用`echo`，但可能是：

```
$_SESSION['error_message'] = "Incorrect Password<style text-align:center;/>"; 
```

然后，在`index.php`您希望它显示的确切位置添加：

```
 <p class="submit">  
          <input type="submit" value="היכנס" />  
     </p>  
</form>
<?php
if (isset($_SESSION['error_message'])) {
    echo $_SESSION['error_message'];
    unset($_SESSION['error_message']); // clear the message to prevent duplicate displays
}
?> 
```

由于看起来您希望在发生实际错误时包含该文件，因此您可以在调用inside`index.php`之前设置一个局部变量，如下所示：`include('../index.php');``login.php`

```
} else {
    $errMsg = "Incorrect Password<style text-align:center;/>";
    include('../index.php');
} 
```

和上面修改的例子一样`index.php`，你可以在这里做同样的事情：

```
 </p>
</form>
<?php if ($errMsg) { echo $errMsg; } ?> 
```

# android - 将 ViewPager 与 FragmentActivities 一起使用时出现 ClassCastException

> ID：12112883
> 
> 赞同：0
> 
> 时间：2012-08-24T16:03:28.130
> 
> 标签：android, android-fragments, android-viewpager

我一直试图让 2 个片段与 ViewPager 一起工作，但没有成功。这是包含 ViewPager 的主要 FragmentActivity：

```
public class DownloadCenter extends android.support.v4.app.FragmentActivity {
    @Override
    protected void onCreate(Bundle arg0) {
        super.onCreate(arg0);
        setContentView(R.layout.download_center);
        ViewPager vp = (ViewPager) findViewById(R.id.DownloadCenter_viewPager);
        vp.setAdapter(new myAdapter(getSupportFragmentManager()));

    }

    public class myAdapter extends FragmentPagerAdapter {
        public myAdapter(FragmentManager fm) {
            super(fm);
        }

        Fragment[] fragmentArray = { Fragment.instantiate(DownloadCenter.this, Download_ImageQuality.class.getName()),
                Fragment.instantiate(DownloadCenter.this, Download_Tilawat.class.getName()) };

        @Override
        public Fragment getItem(int arg0) {
            return fragmentArray[arg0];
        }

        @Override
        public int getCount() {
            return fragmentArray.length;
        }

    }
} 
```

这是日志猫：

```
08-24 18:42:34.238: E/AndroidRuntime(4205): FATAL EXCEPTION: main
08-24 18:42:34.238: E/AndroidRuntime(4205): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.test.test/test.test.DownloadCenter}: java.lang.ClassCastException: test.test.Download_ImageQuality cannot be cast to android.support.v4.app.Fragment
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2079)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2104)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread.access$600(ActivityThread.java:132)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1157)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.os.Looper.loop(Looper.java:137)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread.main(ActivityThread.java:4575)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at java.lang.reflect.Method.invokeNative(Native Method)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at java.lang.reflect.Method.invoke(Method.java:511)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at dalvik.system.NativeStart.main(Native Method)
08-24 18:42:34.238: E/AndroidRuntime(4205): Caused by: java.lang.ClassCastException: test.test.Download_ImageQuality cannot be cast to android.support.v4.app.Fragment
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.support.v4.app.Fragment.instantiate(Fragment.java:388)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.support.v4.app.Fragment.instantiate(Fragment.java:363)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at test.test.DownloadCenter$myAdapter.<init>(DownloadCenter.java:29)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at test.test.DownloadCenter.onCreate(DownloadCenter.java:18)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.Activity.performCreate(Activity.java:4465)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
08-24 18:42:34.238: E/AndroidRuntime(4205):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2033)
08-24 18:42:34.238: E/AndroidRuntime(4205):     ... 11 more 
```

下载_ImageQuality 标头：

```
public class Download_ImageQuality extends android.support.v4.app.FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.download_imagequality);
                 .... //REST OF CLASS
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:05:11.253

`Download_ImageQuality`必须是一个`Fragment`，而不是一个`FragmentActivity`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T17:12:40.503

我们可以从[文档](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)中读取以下内容：

> ViewPager 最常与 Fragment 结合使用，这是一种提供和管理每个页面生命周期的便捷方式。有标准的适配器实现了使用 ViewPager 的片段，它涵盖了最常见的用例。这些是 FragmentPagerAdapter、FragmentStatePagerAdapter、FragmentPagerAdapter 和 FragmentStatePagerAdapter；这些类中的每一个都有简单的代码，显示如何使用它们构建完整的用户界面。

正如你所看到的，它谈论的是 Fragment 而不是 FragmentActivity，它们之间的主要区别在于 Fragment 是在 FragmentActivity 内部的。你可以把它们想象成：

> 片段活动 = 活动
> 
> 片段=视图

**注意：**并非完全如此，这只是一个近似值，以使其更清晰。

因此，在这种情况下，最适合您的是使用 FragmentPagerAdapter 并使 ViewPager 的所有内容成为 Fragment，并且您可以处理每个页面内的完整生命周期。

# javascript - 如何在 Windows Phone 中重定向页面

> ID：12112889
> 
> 赞同：0
> 
> 时间：2012-08-24T16:03:47.747
> 
> 标签：javascript, jquery, windows-phone-7, redirect, jquery-mobile

我正在 jQuery Mobile 中开发一个网页，并将用户重定向到另一个页面，该页面`window.location.replace('#page1')`在 Android 和 iOS 上运行良好，但在 Windows Phone 7 上运行良好 - URL 已更新但不会更改页面。

我使用`window.location.replace`而不是`window.location.assign`或`location.hash`因为我有兴趣阻止用户使用后退按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T09:57:51.417

我有完全相同的问题，但通过将脚本更改为

```
$.mobile.changePage(#pageID) 
```

对我来说很好，祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T20:37:24.570

刚刚在 lumia900 上进行了测试，window.location.replace('#page1') 应该可以正常工作，并且它还会触发我假设驱动屏幕更改等的 onhashchange 事件...

所以我的猜测是，如果没有深入研究 jquery mobile 或建立一个模拟网站，要么你的 URL 哈希不正确，而且有时它只是靠一些愚蠢的运气来工作

或者

jquery mobile 中有一个错误，它会在您的设置中造成严重破坏

这是我使用的测试页面：http: [//jsbin.com/eqelit/1/edit](http://jsbin.com/eqelit/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:01:09.493

尝试使用`window.location.href="www.google.com"`

# ruby-on-rails - 如何实现多个角色的关联？

> ID：12112890
> 
> 赞同：1
> 
> 时间：2012-08-24T16:03:50.210
> 
> 标签：ruby-on-rails, ruby, associations, single-table-inheritance

我正在 Rails 中实现一个求职应用程序，用户可以在其中注册三个不同的配置文件/角色。

1.  雇主
2.  工人
3.  企业家（有自己的公司）

用户可以选择多个配置文件/角色。

（我正在使用设计）

我的疑问是在上述情况下是否可以实现单表继承。？喜欢

```
 CLass Employer < user
  CLass worker < user 
```

或者实现上述功能的数据库结构的最佳解决方案应该是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:18:26.100

是的，这当然是可能的，当模型共享相同的属性并且您希望能够一起查询它们时，STI 被广泛使用（由于您正在加载一个数据库表，这将有助于提高速度和简单性）。您也可以在类之间共享代码，您只需在父类中放置一次方法并让所有子类继承。

旁注，确保您遵循 ruby​​ 命名惯例，将类大写

```
 Class Worker < User 
```

编辑（建议的方法）

我不会让这些角色从用户继承，您仍然可以使用 STI 但创建另一个模型

```
 Class User < ActiveRecord::Base
      has_many :profiles
   Class Profile < ActiveRecord::Base
      belongs_to :user
   Class Employer < Profile
   Class Worker < Profile
   Class Entrepreneur < Profile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T20:57:42.113

您可能想观看此[railscast](http://railscasts.com/episodes/189-embedded-association) —— 这是我最近实施的。它使用数据库中的位掩码列。我还将它与[cancan](https://github.com/ryanb/cancan)配对以处理我的权限。

# networking - 为什么 rabbitmq 监听 43411 端口？

> ID：12112895
> 
> 赞同：1
> 
> 时间：2012-08-24T16:04:22.433
> 
> 标签：networking, ubuntu, erlang, rabbitmq

我一辈子都无法将其绑定到 127.0.0.1:43411 而不是 0.0.0.0:43411。有任何想法吗？

```
beam.smp  18538   rabbitmq   10u     IPv4    5797637      0t0        TCP *:43411 (LISTEN) 
```

Rabbitmq 有几个端口开放，[让 RabbitMQ 只听环回接口？](https://stackoverflow.com/questions/6145137/making-rabbitmq-listen-only-to-the-loopback-interface)帮助我将其中一些绑定到环回，但最后一个是持久的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:13:01.423

我认为这个端口配置有：

> [{内核，[{inet_dist_use_interface，{127,0,0,1}}]}]。

在配置文件中

# c# - C# LINQ 如何将父列表和两个嵌套的子列表展平为一个新列表

> ID：12112898
> 
> 赞同：1
> 
> 时间：2012-08-24T16:04:33.267
> 
> 标签：c#, linq, list

我需要将一个父列表和两个子列表扁平化为一个列表。如何使用 c# 和 linq 做到这一点？

这是我的代码...

```
public class Customer
{
    public string FirstName { get; set;}
    public string LastName { get; set;}
    // need to flatten these lists
    public List<CreditCard> CreditCards { get; set;}
    public List<Address> Addresses{ get; set;}
}

//  Customer has CreditCards list and Addresses list
List<Customer> allCustomers = _db.GetAllCustomers();

// how to flatten Customer, CreditCards list, and Addresses list into one flattened record/list?

var result = allCustomers.GroupBy().SelectMany(); // how to flatten nested lists? 
```

所以结果列表将包含看起来像这样扁平化的项目：

Joe, Blow, Visa, Master Card, 38 Oak Street, 432 Main Avenue

萨莉，纸杯蛋糕，发现，万事达卡，29 Maple Grove，887 Nut Street

它将展平客户的 FirstName、LastName、CreditCards 列表和 Addresses 列表。

感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T16:11:42.093

实施`IEnumerable`：

```
public class Customer : IEnumerable<string>
{
    public string FirstName {get; set;}
    public string LastName {get; set;}
    public List<CreditCard> CreditCards {get; set;}
    public List<Address> Addresses{get; set;}

    public IEnumerator<string> GetEnumerator()
    {
        yield return FirstName;
        yield return LastName;
        foreach (CreditCard c in CreditCards)
        {
            yield return c.ToString();
        }
        foreach (Address a in Addresses)
        {
            yield return a.ToString();
        }
    }
}

...

var result = allCustomers.SelectMany(c => c); 
```

注意：这只是一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:12:53.753

如果您想将所有内容拼合到一个列表中，请使用 SelectMany。在这种情况下，您仍然希望每个客户都有一个记录，因此您不需要展平。

对于像你的例子这样的数组，这样的东西应该可以工作：

```
var result = customers
   .Select(customer => new[]
   {
      customer.FirstName,
      customer.LastName
   }
   .Concat(customer.CreditCards.Select(cc => cc.ToString()))
   .Concat(customer.Addresses.Select(address => address.ToString()))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T16:13:45.417

这将 linq 用于对象，因为它依赖于 string.Join：

```
allCustomers.Select(c=>
  new { FirstName = c.FirstName, LastName= c.LastName,
     CardsList = string.Join(",", c.CreditsCards.Select(c=> c.CardName))
     AddressesList = string.Join(",", c.Addresses.Select(c=> c.Street)
  }
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T16:09:59.760

将每种类型投射到`object`然后使用`Union`来压平它们。

```
 var allCreditCards = from customer in allCustomers
                             from creditCard in customer.CreditCards
                             select (object)creditCard;

        var allAddresses = from customer in allCustomers
                           from address in customer.Addresses
                           select (object)address;

        var flat = allCustomers.Concat(allCreditCards).Concat(allAddresses); 
```

我不确定`IEnumerable<object>`当项目都是不同类型时扁平化的价值，但这就是你要做的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T16:30:37.287

根据你的编辑，这会给你一个`IEnumerable<string>`你想要的：

```
var flatenned = from c in allCustomers
                select
                    c.FirstName + ", " +
                    c.LastName + ", " +
                    String.Join(", ", c.CreditCards.Select(c2 => c2.Name).ToArray()) + ", " +
                    String.Join(", ", c.Addresses.Select(a => a.Street).ToArray()); 
```

输出：

> Joe, Blow, Visa, Master Card, 38 Oak Street, 432 Main Avenue
> 
> 萨莉，纸杯蛋糕，发现，万事达卡，29 Maple Grove，887 Nut Street

完整的测试代码：

使用系统；使用 System.Collections.Generic；使用 System.Linq；使用 System.Text；

命名空间 Console40 { 类 LinqFlatten {

```
 public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        // need to flatten these lists
        public List<CreditCard> CreditCards { get; set; }
        public List<Address> Addresses { get; set; }
    }

    public class CreditCard
    {
        public string Name { get; set; }
    }

    public class Address
    {
        public string Street { get; set; }
    }

    public static void Test()
    {
        //  Customer has CreditCards list and Addresses list
        List<Customer> allCustomers = GetAllCustomers();

        // how to flatten Customer, CreditCards list, and Addresses list into one flattened record/list?

        var flatenned = from c in allCustomers
                        select
                            c.FirstName + ", " +
                            c.LastName + ", " +
                            String.Join(", ", c.CreditCards.Select(c2 => c2.Name).ToArray()) + ", " +
                            String.Join(", ", c.Addresses.Select(a => a.Street).ToArray());

        flatenned.ToList().ForEach(Console.WriteLine);
    }

    private static List<Customer> GetAllCustomers()
    {
        return new List<Customer>
                   {
                       new Customer
                           {
                               FirstName = "Joe",
                               LastName = "Blow",
                               CreditCards = new List<CreditCard>
                                                 {
                                                     new CreditCard
                                                         {
                                                             Name = "Visa"
                                                         },
                                                     new CreditCard
                                                         {
                                                             Name = "Master Card"
                                                         }
                                                 },
                               Addresses = new List<Address>
                                               {
                                                   new Address
                                                       {
                                                           Street = "38 Oak Street"
                                                       },
                                                   new Address
                                                       {
                                                           Street = "432 Main Avenue"
                                                       }
                                               }
                           },
                       new Customer
                           {
                               FirstName = "Sally",
                               LastName = "Cupcake",
                               CreditCards = new List<CreditCard>
                                                 {
                                                     new CreditCard
                                                         {
                                                             Name = "Discover"
                                                         },
                                                     new CreditCard
                                                         {
                                                             Name = "Master Card"
                                                         }
                                                 },
                               Addresses = new List<Address>
                                               {
                                                   new Address
                                                       {
                                                           Street = "29 Maple Grove"
                                                       },
                                                   new Address
                                                       {
                                                           Street = "887 Nut Street"
                                                       }
                                               }
                           }
                   };
    }
} 
```

}

# java - 为什么我得到这个线性布局的空值

> ID：12112900
> 
> 赞同：0
> 
> 时间：2012-08-24T16:04:35.397
> 
> 标签：java, android

我正在尝试更新它`LinearLayout`，但我得到了一个`null`价值。有人能告诉我为什么吗？

爪哇：

```
public class MenuTabFragment extends Fragment {

    private final static String TAG = MenuTabFragment.class.getSimpleName();

    private int[] menuButtons = { R.drawable.breakfast_btn,
            R.drawable.lunch_btn, R.drawable.dinner_btn, R.drawable.drinks_btn,
            R.drawable.appetizers_btn, R.drawable.dessert_btn,
            R.drawable.sides_btn };

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        View view = inflater.inflate(R.layout.menutabslayout, container, false);
            //this is a null value
        LinearLayout linLayout = (LinearLayout) getActivity().findViewById(R.id.menuTabs);
        Log.i(TAG, linLayout + ": linLayout" ); 
```

XML:

```
<LinearLayout
    android:id="@+id/menuTabs"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T16:06:35.667

尝试`LinearLayout linLayout = (LinearLayout) view.findViewById(R.id.menuTabs);`

# reporting-services - SSRS 选择性分组

> ID：12112901
> 
> 赞同：-1
> 
> 时间：2012-08-24T16:04:36.983
> 
> 标签：reporting-services, filtering, grouping

我有一些数据可以在其中设置字段分组。该组的值之一是 NULL。我想从分组字段具有 NULL 值的分组数据中排除 Null。但是，我仍然需要显示该数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T12:53:06.893

我不知道我是否得到了您要查找的内容，但是您似乎不希望`NULL`显示该值，仍然希望该`NULL`组显示的数据。- 第一种解决方案：您可以`isNULL()`在 SQL 查询中使用函数，以便它显示您想要`NULL`在报告中替换的任何其他值。- 第二种解决方案：类似于`isNULL()`SQL Server 中的函数，但在 SSRS 中[检查表达式中的空列值。](http://www.mredkj.com/vbnet/RSNullCheck.html)

# java - 带有泛型的 Java 枚举值

> ID：12112906
> 
> 赞同：6
> 
> 时间：2012-08-24T16:05:00.700
> 
> 标签：java, generics, enums

我需要这样的东西：

```
public enum Enum {
    ENUM1<Class1>(Class1.class, "A DESCRIPTION", new Class1()),
    ENUM2<Class2>(Class2.class, "A DESCRIPTION", new Class2()),
    ENUM3<Class3>(Class3.class, "A DESCRIPTION", new Class3());

    private Enum(Class<? extends Object> clazz, String description, Object instance) {}
} 
```

我需要的是：在一个地方定义所有 ClassX 的不同实例（它们扩展同一个 ClassSuper）。当然，我可以为每个 ClassX 定义不同的枚举，但这并不是我真正想要的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T16:17:02.060

JLS 不允许枚举的类型参数：

```
EnumDeclaration:
    ClassModifiers(opt) enum Identifier Interfaces(opt) EnumBody

EnumBody:
    { EnumConstants(opt) ,(opt) EnumBodyDeclarations(opt) } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:08:35.523

枚举实际上可以有字段，看起来这就是你想要的：

```
private Object instance;
private Enum(Class<? extends Object> clazz, String description, Object instance) {
    this.instance=instance;
}
public Object getInstance() {
    return instance;
} 
```

据我所知，枚举不能被参数化，所以你不能在你的代码中使用它。但是，您到底想对这些课程做什么？我可能误解了你的问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T16:23:29.327

您可以编写以下内容来保存所有相同的信息（因为可以从类中获取类）

```
public enum Enum {
    ENUM1("A DESCRIPTION", new Class1()),
    ENUM2("A DESCRIPTION", new Class2()),
    ENUM3("A DESCRIPTION", new Class3());

    private Enum(String description, Object instance) {}
} 
```

您会发现的问题是，使用枚举，泛型就没有那么有用了，您可以在没有泛型的情况下编写几乎相同的行为。

# .htaccess - .htaccess 保护没有用户名的文件夹

> ID：12112917
> 
> 赞同：15
> 
> 时间：2012-08-24T16:05:40.787
> 
> 标签：.htaccess

是否可以通过仅询问密码来使用 .htaccess 保护文件夹？

我不想要用户名。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-24T19:30:05.717

HTTP auth 将始终要求提供用户名和密码，而不仅仅是密码。服务器不会生成弹出的表单，您的浏览器会。该表格将始终具有用户名和密码。你不能告诉它只要求输入密码。

但是您可以做的是生成一个带有空白用户名的 htpasswd 文件，因此当登录窗口打开时，人们只需要输入密码并且可以将用户名字段留空。

# ant - Ant - 打印集合 - 地图

> ID：12112925
> 
> 赞同：0
> 
> 时间：2012-08-24T16:06:09.843
> 
> 标签：ant, map, jmx

我有一个执行 jmx get 任务的 ant 脚本：

```
<jmx:get
                name="java.lang:type=GarbageCollector,name=Copy" 
                attribute="LastGcInfo"
                resultproperty="CopyLastGcInfo"
                /> 
```

现在，LastGcInfo 属性有一个名为 memoryUsageBeforeGC 的映射 Map。在这张地图中，有一对带有名为“值”的键。尽管我无法引出并打印出来。我试图这样完成它：

```
 <echo>${CopyLastGcInfo.memoryUsageBeforeGc.value.used}</echo>
    <echo>${CopyLastGcInfo.memoryUsageBeforeGc.0.used}</echo>
    <echo>${CopyLastGcInfo.memoryUsageBeforeGc.used}</echo> 
```

那没有用。你对如何解决这个问题有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:30:37.890

以下示例对我有用：

```
<project name="Catalina Ant JMX" xmlns:jmx="antlib:org.apache.catalina.ant.jmx" default="jmx">

    <target name="jmx" description="Show JMX stats">
        <jmx:open host="localhost" port="9012" username="controlRole" password="tomcat"/>

        <jmx:get name="java.lang:type=GarbageCollector,name=Copy" 
                 attribute="LastGcInfo"
                 resultproperty="CopyLastGcInfo"
                 echo="false"
                 />

        <echo>
        memoryUsageBeforeGc
        ===================
        Perm Gen.used=${CopyLastGcInfo.memoryUsageBeforeGc.Perm Gen.used}
        Tenured Gen.used=${CopyLastGcInfo.memoryUsageBeforeGc.Tenured Gen.used}
        Eden Space.used=${CopyLastGcInfo.memoryUsageBeforeGc.Eden Space.used}
        Code Cache.used=${CopyLastGcInfo.memoryUsageBeforeGc.Code Cache.used}
        Survivor Space.used=${CopyLastGcInfo.memoryUsageBeforeGc.Survivor Space.used}
        </echo>
    </target>

</project> 
```

示例输出

```
jmx:
     [echo] 
     [echo]         memoryUsageBeforeGc
     [echo]         ===================
     [echo]         Perm Gen.used=9660888
     [echo]         Tenured Gen.used=8393792
     [echo]         Eden Space.used=4456448
     [echo]         Code Cache.used=2038016
     [echo]         Survivor Space.used=172784
     [echo] 
```

**笔记**

*   “jmx:query”任务的“echo”属性可用于查看任务创建的 ANT 属性和值。对故障排除很有用。

# c# - 单向操作与异步调用

> ID：12112926
> 
> 赞同：1
> 
> 时间：2012-08-24T16:06:21.900
> 
> 标签：c#, .net, wcf

如[本文第一部分所述](http://download.microsoft.com/download/3/a/7/3a7fa450-1f33-41f7-9e6d-3aa95b5a6aea/MSDNMagazineOctober2006en-us.chm)（.chm 文件 - 请参阅下面的注释）

> 单向调用不等同于异步调用。当单向调用到达服务时，它们可能不会一次全部调度，并且可能会在服务端排队等待一次调度......如果排队的消息数量超过了队列的容量，那么即使发出单向呼叫，客户端也会阻塞。

如果调用单向调用，它何时将控制权返回给调用者？同一篇文章的介绍指出，*单向调用*用于*即发即弃操作*，从而模拟一种异步调用。如果会话 WCF 服务具有启动会话的 Login() 单向方法，那么此方法何时将控制权返回给调用者？它是否在该方法在服务上实际执行之前返回？如果是这样，我如何确定该方法是在服务上执行的？

如果我希望服务将登录过程中可能发生的错误返回给客户端，异步调用是否是实现即发即弃行为的唯一方法？

* * *

注意：以上引用摘自 Juval Lowy 的一篇名为*WCF Essentials - What You Need To Know About One-Way Calls, Callbacks, and Events*的文章，可以在 2006 年 10 月号的 MSDN 杂志中找到。上面的链接指向 MSDN 上的帮助文件 (.chm) 格式。如果你不能让链接的 CHM 文件工作（我不能）你可以用 7zip 打开它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T17:15:16.183

> 如果会话 WCF 服务具有启动会话的 Login 单向方法，该方法何时将控制权返回给调用者？

对于 OneWay 调用：一旦服务调用被分派或排队，调用者将继续执行。基本上只要服务成功接到电话。

> 我如何确定该方法是在服务上执行的？

如果客户端没有收到异常，则服务调用已经（或将要）执行。当服务调用实际运行或者它是否成功或抛出异常对于客户端来说是未知的。

> 如果我希望服务将登录过程中可能发生的错误返回给客户端，异步调用是否是实现即发即弃行为的唯一方法？

这根本不符合逻辑。Fire-and-forget 的定义是忘记结果。它不会*向*客户端返回任何值或错误。然而，异步调用不是一劳永逸的，并且会返回错误。

# c# - FolderBrowserDialog 无法识别

> ID：12112928
> 
> 赞同：0
> 
> 时间：2012-08-24T16:06:27.230
> 
> 标签：c#, wpf, folderbrowserdialog

无法让 wpf 项目协调 FolderBrowserDialog

```
using System.Windows.Forms.Integration;
using System.Windows.Forms; 

 private void Button_Click_1(object sender, RoutedEventArgs e)
    {

        FolderBrowserDialog browse = new FolderBrowserDialog();
    } 
```

找不到类型或名称空间 FolderBrowserDialog ？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-03-29T19:13:23.387

如果您的项目是 WPF .Net Core 3.1，那么您必须将以下标签添加到项目文件中：-

```
<UseWindowsForms>true</UseWindowsForms> 
```

我的项目文件如下所示：

```
<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>netcoreapp3.1</TargetFramework>
    <UseWPF>true</UseWPF>
    <UseWindowsForms>true</UseWindowsForms>   <<<<-----
  </PropertyGroup>
</Project> 
```

添加此行后，保存并清理现有解决方案构建，然后重新构建它。这为我解决了问题......哦，别忘了在您使用文件夹选择方法的代码文件中添加“使用”：

```
using System.Windows.Forms; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T16:09:23.403

在 wpf 中使用对话框之前，您需要添加对程序集 System.Windows.Forms 的引用。（右键单击项目并选择添加引用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-20T17:40:54.470

控制台应用程序不会自动添加对 System.Windows.Forms.dll 的引用。

在解决方案资源管理器中右键单击您的项目并选择添加引用...，然后找到 System.Windows.Forms 并添加它。

# c# - MVVM - 通过双击选择列表框中的项目并加粗

> ID：12112940
> 
> 赞同：1
> 
> 时间：2012-08-24T16:07:03.910
> 
> 标签：c#, wpf, mvvm

我想这样做，所以需要双击才能选择 ListBox 中的项目。此选定项目应始终为粗体。我知道**SelectedItem**属性将不再反映我将其视为所选项目的项目，因此我之前用来使所选项目加粗的 XAML 将不再起作用。

```
<ListBox.ItemContainerStyle>
    <Style TargetType="ListBoxItem">
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="FontWeight" Value="Bold"/>
            </Trigger>
        </Style.Triggers>
    </Style>
</ListBox.ItemContainerStyle> 
```

我研究了如何使用 MVVM 处理双击并得出结论，可以使用后面的代码和 MouseDoubleClick 事件。

```
private void lbProfiles_MouseDoubleClick(object sender, MouseButtonEventArgs e)
{
    _viewModel.SelectedProfile = ((ListBox)sender.)SelectedItem as MyProfile;
    //What should go here?
} 
```

我的视图模型将有一个**SelectedProfile**属性，我认为该属性将在上述方法中设置。无论如何在 XAML 中绑定**SelectedProfile**还是必须在后面的代码中进行管理？另外，让这个项目加粗的最好方法是什么？

* * *

**编辑1：**

我最终稍微调整了 Rachel 的答案，以便单击该项目突出显示但未选中。这样视图模型可以有一个 SelectedItem 属性和一个 HighlightedItem 属性。

```
private void ListBoxItem_PreviewMouseDown(object sender, MouseButtonEventArgs e)
{
    if (e.ClickCount < 2)
        e.Handled = true;

    var clickedItem = ((ContentPresenter)e.Source).Content as MyProfile;

    if (clickedItem != null)
    {
        //Let view model know a new item was clicked but not selected.
        _modelView.HighlightedProfile = clickedItem;

        foreach (var item in lbProfiles.Items)
        {
            ListBoxItem lbi = 
                lbProfiles.ItemContainerGenerator.ContainerFromItem(item) as ListBoxItem;

            //If item is not displayed on screen it may not have been created yet.
            if (lbi != null)
            {
                if (item == clickedItem)
                {
                    lbi.Background = SystemColors.ControlLightBrush;
                }
                else
                {

                    lbi.Background = lbProfiles.Background;
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:56:04.443

仅选择项目的最简单方法`DoubleClick`是将点击事件标记为`Handled`ClickCount[小于](http://msdn.microsoft.com/en-us/library/system.windows.input.mousebuttoneventargs.clickcount.aspx)2

这也将允许您将`Trigger`文本设置为`Bold`选中时的文本

```
<ListBox.ItemContainerStyle>
    <Style TargetType="{x:Type ListBoxItem}">
        <EventSetter Event="PreviewMouseDown" Handler="ListBoxItem_PreviewMouseDown" />
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="FontWeight" Value="Bold" />
            </Trigger>
        </Style.Triggers>
    </Style>
</ListBox.ItemContainerStyle>

private void ListBoxItem_PreviewMouseDown(object sender, MouseButtonEventArgs e)
{
    if (e.ClickCount < 2)
        e.Handled = true;
} 
```

请记住，这会禁用`ListBoxItem`. 如果您想允许某些单击事件，则必须调整`PreviewMouseDown`事件以不将特定点击标记为`Handled`。

# c++ - 音频单元样本值范围

> ID：12112945
> 
> 赞同：2
> 
> 时间：2012-08-24T16:07:22.927
> 
> 标签：c++, math, audiounit, trigonometry

我想知道音频单元在缓冲区中期望什么样的值。现在，当我计算振幅为 0.5 的单个频率上的正弦波样本时，一切正常。

但是，当我想同时播放多个频率时，例如一次播放 5 个频率，我通过将样本相加来将样本混合在一起，样本值会变得更高，并且声音不再干净。

所以我想知道我的最大采样值是多少，然后才开始听到脏音。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T16:29:46.343

**在 OS X 上**

样本值通常在 范围内`[-1.0...1.0)`，其中最大值和最小值对应于 0 dBFS。但是，您应该准备好处理更大的样本值。

许多使用浮点渲染/混合图的人习惯于在不考虑超过 0 dBFS 的情况下工作。他们可能仅在输出到硬件或音频文件时验证信号不超过 0 dBFS。

如果您只有一个将 5 个正弦相加的合成器，每个正弦为 -6 dBFS，那么在正常情况下应该没有信号削波，即使您超过 [-1...1)，因为您使用浮点数来表示你的信号。

有几个例外：

*   您正在使用不使用浮点混合器的不寻常的 AU 主机（我想不出一个正在积极开发的主机）
*   或在输出到达 DAC 之前不降低输出
*   或在将输出保存到文件之前不降低输出（尽管音频文件也可以保存为浮点数）
*   信号路径中某处的组件不以浮点方式处理或不支持浮点输入。这对于专用硬件处理器很常见，但如今许多第 3 方插件都以浮点方式处理。

我通常会通过向它发送一个明显会削波的信号来证明/反驳这一点。当然，选择使用整数处理的信号处理器/生成器可以（并且应该）留下大量的动态余量以避免削波（因为处理器不太可能使用小于 32 位的任何东西处理音频）。

**在 iOS 上**

因为 iOS 设备上的浮点处理速度要慢得多，所以规范`AudioUnitSampleType`被指定为 Q7.24 定点。

[可以在此处找到](http://lists.apple.com/archives/coreaudio-api/2011/Feb/msg00078.html)此格式的说明。另请参阅围绕此主题的帖子。

因为这不是浮点数，所以您必须更加小心增益级以避免内部削波。

另请注意，可以`float`在 iOS 上配置 32 位图形。在这种情况下，您应该避免超出`[-1.0...1.0)`处理器的输出，因为您的输出很可能迟早会转换为非浮点表示（与 OS X 相比），除非您当然可以直接控制在处理链下游的合适点处进行增益分级，然后适当地调整这些点的幅度。

# objective-c - iOS 在视图之间传递 NSMutableArray 并在表视图中加载

> ID：12112957
> 
> 赞同：0
> 
> 时间：2012-08-24T16:07:47.033
> 
> 标签：objective-c, ios, xcode

好吧，我有`NSMutableArray`一个视图，我想将此数组的值传递给另一个视图。但我不想使用该方法`[self presentModel view controller ...]`，因为我只想在按下我创建的另一个按钮时显示另一个视图。问题是，当我按下按钮显示数组的值时，数组会丢失它的值，返回空，但如果我使用该方法`[self presentModel view controller ...]`，它会正确返回值。

目前看来：

```
@property and @synthesise AnotherViewController *superAnother

AnotherViewController *anView = [[AnotherViewController alloc]initWithNibName:nil bundle:nil];
superAnother.arrayOfTheAnotherView = [[NSMutableArray alloc]initWithArray:arrayOfTheCurrentView]; 
```

另一种观点：

```
@property and @synthesise NMutableArray *arrayOfTheAnotherView;

NSMultableArray array = [[NSMultableArray alloc]initWithArray:arrayOfTheAnotherView]; 
```

使用数组加载表视图：

```
cell.textLabel.text = [array objectAtIndex:indexPath.row]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:17:30.453

`arrayWithArray`不会创建所收集对象的其他实例，而是使用相同的引用创建另一个数组实例。如果您想更改弹出框或其他任何时候的数据源对象，您需要使用[arrayWithArray:copyItems:](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/initWithArray%3acopyItems%3a)复制项目，当然所有包含的对象都必须符合`NSCopying`协议才能复制它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T17:19:24.453

这段代码有一些问题：

你定义了你的`superAnother`财产，但你没有为它分配任何东西。你的代码应该是这样的：

```
self.superAnother = [[AnotherViewController alloc] initWithNibName:nil bundle:nil];
self.superAnother.arrayOfTheAnotherView = [[NSMutableArray alloc] initWithArray:arrayOfTheCurrentView]; 
```

然后在你的`AnotherViewController.m`：

```
cell.textLabel.text = [self.arrayOfTheAnotherView objectAtIndex:indexPath.row]; 
```

PS。当然，如果您不使用 ARC，请不要忘记释放它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T17:08:59.543

在视图控制器之间传递 NSMutableArray 的另一种方式是这样的：

*   在界面生成器中，将 IBAction 添加到第一个视图控制器中的按钮
*   在两个视图控制器之间添加故事板转场（不是从一个按钮到下一个视图控制器，而是直接在视图控制器之间
*   给这个 segue 一个唯一的标识符
*   在第一个视图控制器中按钮的 IBAction 中添加该行

    [self performSegueWithIdentifier:@"myIdentifier"];

*   然后在第一个视图控制器中，您可以实现委托方法：

    ```
    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

        if ([[segue identifier] isEqualToString:@"myIdentifier"]) {

            SecondViewController *con = [segue destinationViewController];
            con.array = self.array;
        }
    } 
    ```

# java - 使用 Apache POI Excel 写入特定单元格位置

> ID：12112958
> 
> 赞同：4
> 
> 时间：2012-08-24T16:07:47.597
> 
> 标签：java, excel, formatting, apache-poi

如果我有一个未排序的参数“x，y，z”列表，是否有一种直接的方法可以将它们写入使用 POI 创建的 excel 文档中的特定单元格，就好像前两个参数是 X 和Y坐标？

例如，我有如下行：

```
10,4,100 
```

是否可以在第 10 行第 4 列的单元格中写入值“100”？

查看文档，将值迭代到下一行看起来很简单，但我看不到任何方法可以创建固定数量的行和列并将特定值仅写入某些单元格。

任何意见或建议将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T18:03:15.327

当然，这很容易，只要记住 POI 是基于 0 而不是基于 1 的寻址。假设你想写到第 10 行第 4 列，你会做类似的事情

```
Row r = sheet.getRow(9); // 10-1
if (r == null) {
   // First cell in the row, create
   r = sheet.createRow(9);
}

Cell c = r.getCell(3); // 4-1
if (c == null) {
    // New cell
    c = r.createCell(3, Cell.CELL_TYPE_NUMERIC);
}
c.setCellValue(100); 
```

# xml - Scala XML解析不起作用

> ID：12112961
> 
> 赞同：0
> 
> 时间：2012-08-24T16:07:58.980
> 
> 标签：xml, scala

我有这个 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<XML xmlns:r="#SchemaA2A">
  <Schema xmlns="urn:schemas-microsoft-com:xml-data" xmlns:dt="urn:schemas-microsoft-com:datatypes" name="SchemaA2A">
    <ElementType name="ROOT" content="eltOnly" model="closed" order="many">
      <AttributeType name="Response" dt:type="i4"/>
      <AttributeType name="ErrorNumber" dt:type="i4"/>
      <AttributeType name="ErrorDescription" dt:type="string"/>
      <AttributeType name="ErrorDisplay" dt:type="boolean"/>
      <attribute type="Response"/>
      <attribute type="ErrorNumber"/>
      <attribute type="ErrorDescription"/>
      <attribute type="ErrorDisplay"/>
    </ElementType>
    <ElementType name="ROW" content="empty" model="closed">
      <AttributeType name="Personid" dt:type="string"/>
      <attribute type="Personid"/>
    </ElementType>
  </Schema>
  <r:ROOT Response="1" ErrorNumber="0" ErrorDescription="" ErrorDisplay="1">
    <r:ROW Personid="1077231296"/>
  </r:ROOT>
</XML> 
```

并且这两个都返回空值：

```
var person_id = (xmlObject \ "XML" \ "ROOT" \ "ROW" \ "@Personid").text 
```

和

```
var person_id = (xmlObject \ "ROOT" \ "ROW" \ "@Personid").text 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:32:50.383

尝试：

```
var person_id = (xmlObject \\ "XML" \ "ROOT" \ "ROW" \ "@Personid").text 
```

或者

```
var person_id = (xmlObject \\ "ROOT" \ "ROW" \ "@Personid").text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T18:59:08.393

没有直接回答这个问题，但这里有很多令人担忧的事情，我希望这有助于突出它们......

“xml 已保留”警告/错误是正确的 - [xml 规范](http://www.w3.org/TR/2008/REC-xml-20081126 "可扩展标记语言（XML）1.0（第五版）")解释说：

> 以字符串“xml”开头的名称，或任何与 (('X'|'x') ('M'|'m') ('L'|'l')) 匹配的字符串，都保留用于标准化在本规范的这个或未来版本中

但是，如果您还在这里测试它[w3c 验证器](http://validator.w3.org/)，您将完全看不到该错误。其他解析器将正确遵循规范。发送该文档的 Web 服务应该发送有效的 xml，但我们不能总是选择这个。

但是，您确实需要 XMLDecl 标头（？xml 位）。特别是编码，让您的解析器知道如何解析流和处理其他字符集。拥有它是一件非常好的事情。

同样对于使用的“XPath”，它*不正确*，ROOT 和 ROW 元素位于 #SchemaA2A 命名空间中，尽管它们的属性不是。搜索 \*ROW 应该只匹配空命名空间“”。 [Scales Xml](https://github.com/chris-twiner/scalesXml) XPath（基于[DSL](http://scala-scales.googlecode.com/svn/sites/scales/scales-xml_2.9.2/0.3/XPaths.html)和[字符串](http://scala-scales.googlecode.com/svn/sites/scales/scales-xml_2.9.2/0.3/StringXPaths.html)）与许多其他 XPath 库一样强制这种区别。Scala Xmls 方法有效，但只有在有人向您发送打破您假设的文档之前。

# entity-framework-4.1 - 无法检索模型的元数据。在模型生成期间检测到一个或多个验证错误：表没有定义键

> ID：12112964
> 
> 赞同：1
> 
> 时间：2012-08-24T16:08:05.723
> 
> 标签：entity-framework-4.1

从这里的问题开始：[Entity Framework Reverse Engineer using Power Tools - No Primary Keys](https://stackoverflow.com/questions/12110569/entity-framework-reverse-engineer-using-power-tools-no-primary-keys/12110996#comment16192765_12110996)

我使用 Entity Framework Power Tools Beta 2 对数据库进行了逆向工程。这创建了大量 POCO 和一个包含实体映射的映射文件夹。

当我尝试使用“添加控制器”对话框创建控制器时，出现以下消息框：

无法检索*巡航模型*的元数据。在模型生成期间检测到一个或多个验证错误：\tSystem.Data.Entity.EmdEntityTypes:: Cruise *table* has no key defined。定义此 EntityType 的键。

对于我试图为其创建控制器的原始表的所有相关表，这重复了很多次。

控制器本身永远不会被创建，按 OK 我会返回到添加控制器对话框。

有问题的模型 definitley 在其映射文件中定义了一个主键：

// 主键 this.HasKey(t => t.cruise_ID);

我究竟做错了什么？

控制器如何找到映射类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T18:18:15.567

我已经能够复制您收到的错误，它与尝试为模型本身而不是实体类型创建控制器有关。

MVC 脚手架旨在针对实体，然后是相关上下文 - 您确定在下拉列表中选择了正确的项目吗？

![在此处输入图像描述](../Images/cc11b18ac6d4b3d83e935a1554499aa0.png)

在这张图片中：

*   您的模型下拉列表（我的显示 A (MVCExamples.Models)）应该指的是我假设是您的巡航实体。
*   您的数据上下文应该是创建的 DbContext（我的显示实体（MVCExamples.Models））

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-03T21:01:15.440

添加 ：

```
using System.ComponentModel.DataAnnotations; 
```

并且 db 类的主键正在调用'

# android - 未被调用：onPostExecute

> ID：12112965
> 
> 赞同：0
> 
> 时间：2012-08-24T16:08:10.580
> 
> 标签：android, android-asynctask

当我的用户单击登录按钮时，我想点击我的网络服务。我有以下代码可以做到这一点。

```
public void onClick(final View view) {
  String orgKey = inputCompany.getText().toString();
  new getAppInfo().execute("http://example.webservice.com"); 
```

这是我的`getAppInfo`

```
 private class getAppInfo extends AsyncTask<String, Void, String> {
    /** The system calls this to perform work in a worker thread and
      * delivers it the parameters given to AsyncTask.execute() */
    @Override
    protected String doInBackground(String... urls) {
        String xml = null;
        try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(urls[0]);

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            xml = EntityUtils.toString(httpEntity);

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        // return XML
        return xml;
    }

    /** The system calls this to perform work in the UI thread and delivers
      * the result from doInBackground() */
    @Override
    protected void onPostExecute(String result) {
        Document doc = GetDomElement(result); // getting DOM element

        NodeList nl = doc.getElementsByTagName("details");
        getChildElements(nl); 
    } 
```

正在运行，`doBackground`但`onPostExecute`没有。我已将它移出 on click 并且它已经工作但我需要它在 onClick 中。

我怎样才能让它`onPostExecute`在我的 onClick 内部运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:12:32.647

`onPostExecute`将**始终**在完成后调用`doInBackground`。尝试在*onPostExecute中**登录*以确认此行为。

 ** * *

**在您的doInBackground**方法中添加一般`catch`语句。

 **```
catch(Exception e){
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:28:47.363

首先，一个通用的指针——Java 中的类名通常是大写的 CamelCase，方法名是小写的 camelCase。

关于您的问题-您是否有机会退出活动或关闭产生任务的对话框？如果它在该 onclick 处理程序之外工作，我的猜测是某些东西正在破坏 AsyncTask 试图在其上执行该方法的 Handler 对象。

尝试在当前 Activity 的 Handler 上发布一个 Runnable（它执行 AsyncTask）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T16:32:29.300

语法是正确的，您可能在后台进程中遇到异常，停止后台线程。在您的 doInBackground 末尾放置一条日志语句或在您的尝试中添加一个 catch (Throwable t)。

有信心 - 只要 doInBackground 成功完成，它就会被调用。

顺便说一句，您也应该在后台进行 DOM 解析 - 目前您正在 UI 线程中执行此操作，这可能会导致 ANR 弹出窗口。***

# sql - 脚本备份网站及其数据库

> ID：12112971
> 
> 赞同：0
> 
> 时间：2012-08-24T16:08:41.877
> 
> 标签：sql, linux, bash, web

这是代码，想法是在阵列中建立的天数内备份一个站点（在这个测试中，我已经放置了所有 7 天）：

```
#!/bin/bash

### Setup Environment ###
DIRS="INFO"
BACKUP=/tmp/backup.$$
NOW=$(date +"%d-%m-%Y")
INCFILE="/root/tar-inc-backup.dat"
DAY=$(date +"%a")
FULLBACKUP="Sun"
DAYSOFBACKUP=( Mon Tue Wed Thu Fri Sat Sun)

### MySQL Config ###
MUSER="INFO"
MPASS="INFO"
MHOST="INFO"
MYSQL="$(which mysql)"
MYSQLDUMP="$(which mysqldump)"
GZIP="$(which gzip)"

### FTP Config ###
FTPD="/"
FTPU="INFO"
FTPP="INFO"
FTPS="INFO"

### Email Config ###
EMAILID="INFO"

### FS Backup ###
[ ! -d $BACKUP ] && mkdir -p $BACKUP || :

### Determine which backup to run ###
for day in ${DAYSOFBACKUP[@]}
do
  if [ $day == "$FULLBACKUP" ]; then
    i=$(date +"%Hh%Mm%Ss")
    FTPD="/full"
    FILE="fs-full-$NOW.tar.gz"
    tar -zcvf $BACKUP/$FILE $DIRS
  else
    i=$(date +"%Hh%Mm%Ss")
    FILE="fs-i-$NOW-$i.tar.gz"
    sudo tar -g $INCFILE -zcvf $BACKUP/$FILE $DIRS
  fi
done

### Start MySQL Backup ###
# Get all databases name
DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
for db in $DBS
do
if [ db == "bricalia_tienda" ]; then
 FILE=$BACKUP/mysql-$db.$NOW-$i.gz
 $MYSQLDUMP -u $MUSER -h $MHOST -p$MPASS $db | $GZIP -9 > $FILE
fi
done

### FTP Backup to Remote Server ###
#Start FTP backup using ncftp
ftp $FTPS $MUSER $MPASS
bin
sudo mkdir $FTPD
sudo mkdir $FTPD/$NOW
cd $FTPD/$NOW
lcd $BACKUP
mput *
quit

### Backup Fail Check ###
if [ "$?" == "0" ]; then
 rm -f $BACKUP/*
else
 T=/tmp/backup.fail
 echo "Date: $(date)">$T
 echo "Hostname: $(hostname)" >>$T
 echo "Backup failed" >>$T
 mail  -s "BACKUP FAILED" "$EMAILID" <$T
 rm -f $T
fi 
```

我在“确定在 if 子句中运行哪个备份”中有错误。最后一行还有一个问题：意外结束。

该脚本在这里解释：http: [//piratecove.org/website-backup-script/](http://piratecove.org/website-backup-script/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:12:59.227

看起来，在您引用的评论的正下方，是一条重复的行。如果检查：

```
### Determine which backup to run ###
if [ "$DAY" == "$FULLBACKUP" ]; then
if [ $day == "$FULLBACKUP" ]; then 
```

如果检查有帮助，我猜想删除第二个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:21:15.393

在“修复”之后，还有另一个问题：

```
### Determine which backup to run ###
for day in ${DAYSOFBACKUP[@]} do
if [ $day == "$FULLBACKUP" ]; then
  i=$(date +"%Hh%Mm%Ss")
  FTPD="/full"
  FILE="fs-full-$NOW.tar.gz"
  tar -zcvf $BACKUP/$FILE $DIRS
else
  i=$(date +"%Hh%Mm%Ss")
  FILE="fs-i-$NOW-$i.tar.gz"
  tar -g $INCFILE -zcvf $BACKUP/$FILE $DIRS
fi 
```

这个 for 循环不对，试试这个：

```
### Determine which backup to run ###
for day in ${DAYSOFBACKUP[@]}
do
  if [ $day == "$FULLBACKUP" ]; then
    i=$(date +"%Hh%Mm%Ss")
    FTPD="/full"
    FILE="fs-full-$NOW.tar.gz"
    tar -zcvf $BACKUP/$FILE $DIRS
  else
    i=$(date +"%Hh%Mm%Ss")
    FILE="fs-i-$NOW-$i.tar.gz"
    tar -g $INCFILE -zcvf $BACKUP/$FILE $DIRS
  fi
done 
```

# firefox - 如何从 nsIContentPolicy shouldLoad 加载资源中获取选项卡

> ID：12112974
> 
> 赞同：1
> 
> 时间：2012-08-24T16:08:55.127
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在开发 Firefox 的 Addon SDK (v1.9) 的扩展。我的扩展通过实现 nsIContentPolicy 并针对要阻止的 URI 数据库测试其 URI 来阻止或允许资源。

**问题**

我需要从 nsIContentPolicy 的 shouldLoad 函数访问选项卡对象（如果可用）。

我假设用于此的部分是 nsISupports 的 shouldLoad 函数上的“context”参数。我尝试使用 getTabForWindow(win) 没有运气，因为上下文不是 nsIDOMWindow （[识别在 Firefox Addon SDK 中发出请求的选项卡](https://stackoverflow.com/questions/8098580/identify-tab-that-made-request-in-firefox-addon-sdk)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:50:10.753

参数是`context`文档或元素。从那里到窗户并不难：

```
var {Ci} = require("chrome");
if (!(context instanceof Ci.nsIDOMWindow))
{
  // If this is an element, get the corresponding document
  if (context instanceof Ci.nsIDOMNode && context.ownerDocument)
    context = context.ownerDocument;

  // Now we should have a document, get its window
  if (context instanceof Ci.nsIDOMDocument)
    context = context.defaultView;
  else
    context = null;
}

// If we have a window now - get the tab
if (context)
{
  var tabsLib = require("tabs/tab.js");
  return tabsLib.getTabForWindow(context.top);
}
else
  return null; 
```

供参考：[Node](https://developer.mozilla.org/en-US/docs/DOM/Node)，[Document](https://developer.mozilla.org/en-US/docs/DOM/Document)，[window](https://developer.mozilla.org/en-US/docs/DOM/window)。

# ruby-on-rails-3 - 在来自多级 JSON 数据的 rails 数组中使用 has_key

> ID：12112989
> 
> 赞同：2
> 
> 时间：2012-08-24T16:10:35.737
> 
> 标签：ruby-on-rails-3, json, multidimensional-array

我有一组具有多级数据的 JSON 数据。JSON 的片段（请忽略缺少的格式）：

```
DATA SET A:
"interaction": {
   "author": {
      "username": "johndoe",
      "name": "John Doe"
   }
},
"gender": "male"

DATA SET B:
"interaction": {
   "author": {
      "name": "Jane Doe"
   }
},
"gender": "male" 
```

在单级中，我可以使用：

```
if record.has_key?('gender') 
```

如果密钥存在，它将返回一个真/假值。

如果我尝试播种数据并且密钥不存在，它将引发错误并停止播种。

我的问题：我将如何检查“用户名”键是否存在。例如，数据集 B 没有用户名键并且会引发错误，但我不知道如何修改 has_key() 命令以检查向下的几个级别。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T15:10:56.350

我决定解决该`has_key`方法并使用开始/救援/结束。

```
begin
  @data.username = record['interaction']['author']['username']
rescue
  @data.username = nil
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:21:10.383

这是一种可能性：

```
# where a and b are loaded from JSON
a = {
  'interaction' => {
    'author' => {
      'username' => 'johndoe',
      'name' => 'jd'
    }
  }
}
b = {
  'interaction' => {
    'author' => {
      'oijoijoij' => 'johndoe',
      'name' => 'jd'
    }
  }
}
class Hash
  def recursive_has_key?(key)
    has_key?(key) or values.any? { |v| v.is_a?(Hash) and v.recursive_has_key?(key) }
  end
end
puts a.recursive_has_key?('username')
puts b.recursive_has_key?('username') 
```

哪个输出

```
$ ruby foo.rb 
true
false 
```

# mysql - SQL在日期范围内选择平均分数

> ID：12112990
> 
> 赞同：1
> 
> 时间：2012-08-24T16:10:49.690
> 
> 标签：mysql, sql, postgresql

我有 3 张桌子：

```
doctors (id, name) -> has_many:
    patients (id, doctor_id, name) -> has_many:
        health_conditions (id, patient_id, note, created_at) 
```

每天每位患者都会添加一个健康状况，并附有从 1 到 10 的注释，其中 10 表示身体健康（如果可以的话，可以完全康复）。

我要提取的是过去 30 天（月）的以下 3 个统计数据： - 有多少患者好转 - 有多少患者病情恶化 - 有多少患者保持不变

这些统计数据是全球性的，所以我现在不关心每个医生的统计数据，我可以根据正确的查询提取这些数据。

诀窍是查询需要提取当前的 health_condition 注释并与过去几天的平均值（本月没有今天）进行比较，因此需要提取今天的注释和除此之外的其他日期的平均值。

我认为查询不需要定义谁上/下/相同，因为我可以循环并决定。我想，就在今天和本月的其余时间就足够了。

这是我到目前为止所拥有的 obv。不起作用，因为由于应用了限制，它只返回一个结果：

```
SELECT
    p.id,
    p.name,
    hc.latest,
    hcc.average
FROM
    pacients p
INNER JOIN (
        SELECT
            id,
            pacient_id,
            note as LATEST
        FROM
            health_conditions
        GROUP BY pacient_id, id
        ORDER BY created_at DESC
        LIMIT 1
    ) hc ON(hc.pacient_id=p.id)
INNER JOIN (
        SELECT
            id,
            pacient_id,
            avg(note) AS average
        FROM
            health_conditions
        GROUP BY pacient_id, id
    ) hcc ON(hcc.pacient_id=p.id AND hcc.id!=hc.id)
WHERE
    date_part('epoch',date_trunc('day', hcc.created_at))
    BETWEEN
        (date_part('epoch',date_trunc('day', hc.created_at)) - (30 * 86400))
    AND
        date_part('epoch',date_trunc('day', hc.created_at)) 
```

该查询具有区分最新和平均所需的所有逻辑，但该限制会扼杀一切。我需要该限制来提取用于与过去结果进行比较的最新结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:23:52.307

```
SELECT SUM(delta < 0) AS worsened,
       SUM(delta = 0) AS no_change,
       SUM(delta > 0) AS improved
FROM  (
  SELECT   patient_id,
           SUM(IF(DATE(created_at) = CURDATE(),note,NULL))
         - AVG(IF(DATE(created_at) < CURDATE(),note,NULL)) AS delta
  FROM     health_conditions
  WHERE    DATE(created_at) BETWEEN CURDATE() - INTERVAL 1 MONTH AND CURDATE()
  GROUP BY patient_id
) t 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:22:15.200

像这样的假设`created_at`是类型`date`

```
select p.name,
       hc.note as current_note,
       av.avg_note
from patients p
   join health_conditions hc on hc.patient_id = p.id
   join (
      select patient_id, 
             avg(note) as avg_note
      from health_conditions hc2
      where created_at between current_date - 30 and current_date - 1
      group by patient_id
    ) avg on t.patient_id = hc.patient_id
where hc.created_at = current_date; 
```

这是 PostgreSQL 语法。我不确定 MySQL 是否以同样的方式支持日期算术。

编辑：

这应该为您提供每位患者的最新记录，以及过去 30 天的平均值：

```
select p.name,
       hc.created_at as last_note_date
       hc.note as current_note,
       t.avg_note
from patients p
   join health_conditions hc 
     on hc.patient_id = p.id
    and hc.created_at = (select max(created_at) 
                         from health_conditions hc2 
                         where hc2.patient_id = hc.patient_id)
   join (
      select patient_id, 
             avg(note) as avg_note
      from health_conditions hc3
      where created_at between current_date - 30 and current_date - 1
      group by patient_id
    ) t on t.patient_id = hc.patient_id 
```

# qr-code - 使用 GP 2010 和 QR 条码进行库存管理

> ID：12112992
> 
> 赞同：1
> 
> 时间：2012-08-24T16:10:59.950
> 
> 标签：qr-code

我公司目前使用 GP 2010 进行库存。我正在尝试找出一种方法来使用移动设备扫描库存物品中的二维码，并让它在 GP 2010 中删除或添加该物品。我在大学课程中对 .NET 有一点经验，我我不熟悉 GP 2010。我不知道从哪里开始。我希望我已经提供了所有必要的信息。非常感谢您在正确方向上的任何帮助。谢谢你。

# c++ - DoubleLinkedList 方法调用错误

> ID：12112993
> 
> 赞同：0
> 
> 时间：2012-08-24T16:11:00.510
> 
> 标签：c++, doubly-linked-list

嘿，我有一个 DoublyLinkedList 并且任何时候我尝试从头文件中调用方法。我调用statsList。因为我已经声明了 DoublyLinkedList，正如您在我的代码中看到的那样：

```
DoublyLinkedList<int>* statsList = new DoublyLinkedList<int>;

int main()
{
    DoublyLinkedList<Stats> list;
    Stats stats;
    bool exit = false;
    int menuChoice;
    while (!exit)
    {

        switch (menuChoice)
        {
        case 1:
        cout << "Insert";
        {

        stats.Details();

        }
            break;
        case 2:
        cout << "Delete";
        {
        statsList.Remove();
        } 
```

但问题是我得到一个错误：错误：表达式必须有一个类类型。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:16:08.700

这：

```
statsList.Remove(); 
```

应该：

```
statsList->Remove(); 
```

和`statsList`指针 ( `DoublyLinkedList<int>*`) 一样。

# servlets - request.getAttribute() 不提供 HTTP 请求参数

> ID：12112995
> 
> 赞同：2
> 
> 时间：2012-08-24T16:11:12.703
> 
> 标签：servlets, parameters, attributes, http-request-parameters

我正在`url`使用以下 jQuery 片段向 servlet 发送参数：

```
$.getJSON("http://localhost:8080/JsoupPrj/JasonGen?url=" + url, function(data) {
    $("#content").html(data);
}); 
```

在服务器端，servlet 获取参数，为此我编码如下：

```
String url = (String) request.getAttribute("url"); 
```

但它不起作用，你能告诉我我做错了什么吗？我相信我没有将参数正确地传递给 servlet。servlet 每次通过 JavaScript 触发，但它看不到从浏览器传递的参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T16:13:28.607

这里，

```
String url = (String) request.getAttribute("url"); 
```

您正在尝试将请求**参数**作为请求**属性**而不是作为请求**参数**。这显然不会做你想要的。

您需要获取请求参数作为请求参数，而不是作为请求属性。

```
String url = request.getParameter("url"); 
```

* * *

**与具体问题无关**：在发送之前，您似乎根本没有对参数进行 URL 编码。`url`当包含特殊字符时，这可能会导致与此无关的其他问题。看JS`encodeURIComponent()`函数，或者函数的`data`参数`$.getJSON()`。另请参阅[如何使用 Servlet 和 Ajax？](https://stackoverflow.com/questions/4112686/how-to-use-servlets-and-ajax)

# c# - 序列化 DbConnectionStringBuilder

> ID：12112997
> 
> 赞同：0
> 
> 时间：2012-08-24T16:11:19.903
> 
> 标签：c#, odbc, oledb

如何序列化[DbConnectionStringBuilder](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnectionstringbuilder.aspx)对象。我需要将对象从服务器发送到客户端。

[尝试使用这种](http://blogs.msdn.com/b/adam/archive/2010/09/10/how-to-serialize-a-dictionary-or-hashtable-in-c.aspx)方法序列化 IDcitionary 。但是在客户端，当我将这些键添加到对象时，它会为其分配一个时髦的连接字符串。如果你这样做

```
_connectionStringBuilder.ConnectionString = string.Empty; 
```

这将删除所有密钥。

**是否可以将 DbProviderFactory 对象从服务器返回到客户端？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:17:22.090

“ [StringDictionary not save as user setting](https://stackoverflow.com/questions/424010/stringdictionary-not-saving-as-user-setting) ”显示了一种序列化方式`DbConnectionString`：

```
public static string Serialize(StringDictionary data)
{
    if(data == null) return null; // GIGO
    DbConnectionStringBuilder db = new DbConnectionStringBuilder();
    foreach (string key in data.Keys)
    {
        db[key] = data[key];
    }
    return db.ConnectionString;
}
public static StringDictionary Deserialize(string data)
{
    if (data == null) return null; // GIGO
    DbConnectionStringBuilder db = new DbConnectionStringBuilder();
    StringDictionary lookup = new StringDictionary();
    db.ConnectionString = data;
    foreach (string key in db.Keys)
    {
        lookup[key] = Convert.ToString(db[key]);
    }
    return lookup;
} 
```

将`StringDictionary`用于序列化。

# android - 从活动中停止 IntentService

> ID：12112998
> 
> 赞同：7
> 
> 时间：2012-08-24T16:11:19.963
> 
> 标签：android, intentservice

我`IntentSerivce`有时会在后台运行一个，在某些情况下它可能是一个相当长的运行过程。我为用户提供了退出应用程序的选项，该应用程序基本上只是停止并轮询并忽略任何`GCM`推送通知。但是，如果收到推送通知并且`IntentService`需要一段时间才能完成它必须做的事情（从服务器获取信息并在需要时向用户发送通知，例如收到新消息或其他东西）。

这是问题所在，如果用户在应用程序`intentservice`仍在运行时选择“退出”应用程序，他们仍然会收到我不想要的通知。我知道有`stopSelf()`该服务的方法，但是当我知道用户通过菜单按钮“退出”应用程序时，我需要在活动中停止它。向服务发送另一个`intent`不起作用，因为意图排队并且调用`context.stopService(intent);`我的活动也不起作用，所以我还能如何停止它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T16:21:47.400

您是在传递新的`Intent`into`stopService(Intent)`还是在`startService(Intent)`. 传递原始意图应该停止服务。

如果您无法使用 a`Handler`来传递服务 a `Message`。`IntentService`实现接口并在你的 中`Handler.Callback`创建一个新`Handler(Handler.Callback)`的`Activity`，传递你的`IntentService`as 回调。然后`onHandleMessage()`在您的 IntentService 中实现调用`stopSelf()`并`Activity`在您希望它停止时将消息传递给它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-21T08:08:17.397

下面的代码完全可以让我从 Activity 中停止 IntentService：

```
stopService(new Intent(getApplicationContext(), MyIntentService.class)); 
```

# wpf - ListBox 绑定的行为与 TextBlock 绑定不同

> ID：12112999
> 
> 赞同：1
> 
> 时间：2012-08-24T16:11:29.107
> 
> 标签：wpf

这是触发 PropertyChanged 的​​属性：

```
public override List<Tag> Tags
{
    get
    {
        return base.Tags;
    }
    set
    {
        if (base.Tags != value) {
            base.Tags = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, 
                         new PropertyChangedEventArgs("Tags"));
                PropertyChanged(this, 
                         new PropertyChangedEventArgs("TotalTagPages"));
                PropertyChanged(this, 
                         new PropertyChangedEventArgs("PageHasTags"));
             }
        }

    }
} 
```

修改 CurrentPage.Tags 时，此控件会正确刷新：

```
<TextBlock DockPanel.Dock="Bottom" Name="TagHeader" 
    Text="{Binding CurrentPage.Tags,
         Converter={converter:EnumerableToSpacedString}}"    
    Foreground="White" /> 
```

**当 CurrentPage.Tags 更改时，此选项不会刷新，但在 CurrentPage 本身更改时会这样做：**

```
<ListBox VerticalAlignment="Top"
   Style="{StaticResource DarkListBox}"  
   ItemTemplate="{StaticResource TagTemplateNoCounts}" 
   ItemsSource="{Binding CurrentPage.Tags}" >
        <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
        <StackPanel Orientation="Horizontal"></StackPanel>  
        </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
</ListBox> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:38:01.753

看不出有任何不可行的原因（与修改列表相反，这需要[`INotifyCollectionChanged`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx)）...