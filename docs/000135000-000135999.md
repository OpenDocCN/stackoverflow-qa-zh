# StackOverflow 问答 000135000-000135999

# c# - 如何防止 .NET 的 XmlDocument 输出中出现空白 xmlns 属性？

> ID：135000
> 
> 赞同：125
> 
> 时间：2008-09-25T18:16:38.380
> 
> 标签：c#, .net, xml, xml-namespaces, xmldocument

在 .NET 中从 XmlDocument 生成 XML 时，`xmlns`第一次插入*没有*关联命名空间的元素时会出现空白属性；如何防止这种情况？

例子：

```
XmlDocument xml = new XmlDocument();
xml.AppendChild(xml.CreateElement("root",
    "whatever:name-space-1.0"));
xml.DocumentElement.AppendChild(xml.CreateElement("loner"));
Console.WriteLine(xml.OuterXml); 
```

输出：

```
<root xmlns="whatever:name-space-1.0"><loner xmlns="" /></root> 
```

*期望的*输出：

```
<root xmlns="whatever:name-space-1.0"><loner /></root> 
```

是否有适用于代码的解决方案，而不是在将文档转换为字符串*后*`XmlDocument`发生的事情？*`OuterXml`*

 *我这样做的原因是看我是否可以使用 XmlDocument 生成的 XML 匹配特定协议的标准 XML。空白`xmlns`属性*可能*不会破坏或混淆解析器，但它也不存在于我所见过的该协议的任何用法中。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-09-25T20:49:13.163

感谢 Jeremy Lew 的回答和更多的尝试，我想出了如何删除空白属性：在创建任何*不*希望有前缀的`xmlns`子节点时传入根节点的命名空间。在根处使用没有前缀的命名空间意味着您需要在子元素上使用相同的命名空间，以便它们*也*没有前缀。

 **固定代码：

```
XmlDocument xml = new XmlDocument();
xml.AppendChild(xml.CreateElement("root", "whatever:name-space-1.0"));
xml.DocumentElement.AppendChild(xml.CreateElement("loner", "whatever:name-space-1.0")); 
Console.WriteLine(xml.OuterXml); 
```

感谢大家的所有回答，这使我朝着正确的方向前进！

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2011-12-30T04:02:18.487

这是 JeniT 答案的变体（非常感谢您！）

```
XmlElement new_element = doc.CreateElement("Foo", doc.DocumentElement.NamespaceURI); 
```

这消除了在任何地方复制或重复命名空间的麻烦。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-25T18:23:02.640

如果`<loner>`示例 XML 中的元素没有`xmlns`默认命名空间声明，那么它将位于`whatever:name-space-1.0`命名空间中，而不是没有命名空间。如果这是您想要的，您需要在该命名空间中创建元素：

```
xml.CreateElement("loner", "whatever:name-space-1.0") 
```

如果您希望`<loner>`元素不在命名空间中，那么生成的 XML 正是您需要的，您不必担心`xmlns`自动为您添加的属性。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T18:27:59.023

由于 root 位于无前缀命名空间中，因此任何想要取消命名空间的 root 子项都必须像您的示例一样输出。解决方案是像这样为根元素添加前缀：

```
<w:root xmlns:w="whatever:name-space-1.0">
   <loner/>
</w:root> 
```

代码：

```
XmlDocument doc = new XmlDocument();
XmlElement root = doc.CreateElement( "w", "root", "whatever:name-space-1.0" );
doc.AppendChild( root );
root.AppendChild( doc.CreateElement( "loner" ) );
Console.WriteLine(doc.OuterXml); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T19:40:30.503

如果可能，创建一个序列化类，然后执行：

```
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
ns.Add("", "");
XmlSerializer serializer = new XmlSerializer(yourType);
serializer.Serialize(xmlTextWriter, someObject, ns); 
```

它更安全，如果您确实需要更多控制，您可以使用属性控制命名空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-23T16:30:21.053

我已经通过使用工厂模式解决了这个问题。我为 XElement 对象创建了一个工厂。作为工厂实例化的参数，我指定了一个 XNamespace 对象。因此，每次工厂创建 XElement 时，都会自动添加命名空间。这是工厂的代码：

```
internal class XElementFactory
{
    private readonly XNamespace currentNs;

    public XElementFactory(XNamespace ns)
    {
        this.currentNs = ns;
    }

    internal XElement CreateXElement(String name, params object[] content)
    {
        return new XElement(currentNs + name, content);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-06T17:56:24.100

是的，您可以阻止 XMLNS 来自 XmlElement 。首先创造时间即将到来：就像那样

```
<trkpt lat="30.53597" lon="-97.753324" xmlns="">
    <ele>249.118774</ele>
    <time>2006-05-05T14:34:44Z</time>
</trkpt> 
```

更改代码：并像这样传递 xml 命名空间

C#代码：

```
XmlElement bookElement = xdoc.CreateElement("trkpt", "http://www.topografix.com/GPX/1/1");
bookElement.SetAttribute("lat", "30.53597");
bookElement.SetAttribute("lon", "97.753324"); 
```

# windows - 如何编写批处理文件错误/返回的免费通知脚本？

> ID：135010
> 
> 赞同：0
> 
> 时间：2008-09-25T18:18:19.250
> 
> 标签：windows, command-line, batch-file, blat

我在停止服务并重新启动它时遇到问题，希望在进程运行时收到通知并让我知道结果是什么。

这是场景，我有一个“sc”命令的文本文件输出。我想发送该文件，但不作为附件发送。另外，我想在邮件主题中快速查看初始状态。

这是“servstop.txt”文件内容：

> [SC] 启动服务失败 1058：
> 
> 该服务无法启动，因为它被禁用或者因为它没有与之关联的启用设备。

我希望电子邮件的主题是“警报服务启动：[SC] StartService FAILED 1058”，并且正文包含上面的整个错误消息。

我将使用名为 blat 的程序将我当前的方法放在下面的答案中，以向我发送结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T18:49:20.657

这就是我的做法。首先，我收到了[blat 邮件](http://blat.net)（公共域 smtp 邮件程序）并将其放入 d:\blat 目录。我的 Exchange 服务器允许我在没有 id/密码的情况下发送电子邮件，并假设我是 blat 命令的“发件人”字段中的人。

```
@echo off
sc start Alerter >servstop.txt
SetLocal EnableDelayedExpansion
set content=
set subj=
for /F "delims=" %%i in (servstop.txt) do set content=!content! %%i  
for /f "tokens=1 delims=:" %%s in ("%content%") do set subj=%%s 

d:\blat\blat.exe -body "%content%" -to my-email@foo.bar -f my-email@foo.bar -server smtp.foo.bar -s "Alert Service Start:%subj% " -log d:\blat\blat.log
EndLocal 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T19:03:36.390

[Splunk](http://www.splunk.com/)看起来很有希望。虽然没试过。来自该站点的关于索引和警报的两个块引用如下。

> 索引：通过各种灵活的输入方法，您可以索引来自所有应用程序、服务器和网络设备的日志、配置、陷阱和警报、消息、脚本以及代码和性能数据。监控文件系统的脚本和配置更改、捕获归档文件、查找和跟踪实时应用程序日志、连接到网络端口以接收系统日志、SNMP 和其他基于网络的工具。而这正是它开始的地方。
> 
> 警报：任何搜索都可以按计划运行，并根据搜索结果触发通知或操作。并且因为它适用于不同的组件和技术，Splunk 是您的武器库中最灵活的监控工具。通知可以通过电子邮件、RSS 或 SNMP 发送到其他管理控制台。动作触发脚本执行用户描述的活动，例如重新启动应用程序、服务器或网络设备。

# c# - 使用私有静态方法的优势

> ID：135020
> 
> 赞同：228
> 
> 时间：2008-09-25T18:20:54.267
> 
> 标签：c#, performance

当创建一个具有内部私有方法的类时，通常是为了减少代码重复，不需要使用任何实例字段，将方法声明为静态是否有性能或内存优势？

例子：

```
foreach (XmlElement element in xmlDoc.DocumentElement.SelectNodes("sample"))
{
    string first = GetInnerXml(element, ".//first");
    string second = GetInnerXml(element, ".//second");
    string third = GetInnerXml(element, ".//third");
} 
```

...

```
private static string GetInnerXml(XmlElement element, string nodeName)
{
    return GetInnerXml(element, nodeName, null);
}

private static string GetInnerXml(XmlElement element, string nodeName, string defaultValue)
{
    XmlNode node = element.SelectSingleNode(nodeName);
    return node == null ? defaultValue : node.InnerXml;
} 
```

将 GetInnerXml() 方法声明为静态方法有什么好处吗？请不要发表意见，我有意见。

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2008-09-25T18:24:24.523

来自[FxCop 规则页面](http://msdn.microsoft.com/en-us/library/ms245046.aspx)：

> 将方法标记为静态后，编译器将向这些成员发出非虚拟调用站点。发出非虚拟调用站点将阻止在运行时对每个调用进行检查，以确保当前对象指针不为空。这可以为性能敏感的代码带来可衡量的性能增益。在某些情况下，无法访问当前对象实例代表了正确性问题。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-11-07T17:26:05.837

当我写一个类时，大多数方法分为两类：

*   使用/更改当前实例状态的方法。
*   不使用/更改当前对象状态但帮助我计算我在其他地方需要的值的辅助方法。

静态方法很有用，因为仅通过查看它的签名，您就知道调用它并没有使用或修改当前实例的状态。

举个例子：

```
公共类图书馆
{
    private static Book findBook(List<Book> books, string title)
    {
        // 代码在这里
    }
}
```

如果图书馆状态的一个实例被搞砸了，我试图找出原因，我可以从它的签名中排除 findBook 是罪魁祸首。

我尝试尽可能多地与方法或函数的签名进行交流，这是一种很好的方式。

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2012-09-04T10:29:46.587

> 对静态方法的调用会生成 Microsoft 中间语言 (MSIL) 的调用指令，而对实例方法的调用会生成 callvirt 指令，该指令还会检查空对象引用。**但是，大多数时候两者之间的性能差异并不显着。**

资料来源：MSDN - [https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2012/79b3xss3(v=vs.110)](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2012/79b3xss3(v=vs.110))

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-25T18:22:21.567

是的，编译器不需要将隐式`this`指针传递给`static`方法。即使您不在实例方法中使用它，它仍然会被传递。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-25T18:23:32.513

它会稍微快一些，因为没有传递这个参数（尽管调用该方法的性能成本可能比这个节省要多得多）。

我想说我能想到的私有静态方法的最佳原因是它意味着您不能意外更改对象（因为没有 this 指针）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T18:23:03.700

这迫使您记住还要将函数使用的任何类范围成员声明为静态成员，这样可以节省为每个实例创建这些项目的内存。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-04-27T11:22:18.487

我非常喜欢所有私有方法都是静态的，除非它们真的不能。我更喜欢以下内容：

```
public class MyClass
{
    private readonly MyDependency _dependency;

    public MyClass(MyDependency dependency)
    {
        _dependency = dependency;
    }

    public int CalculateHardStuff()
    {
        var intermediate = StepOne(_dependency);
        return StepTwo(intermediate);
    }

    private static int StepOne(MyDependency dependency)
    {
        return dependency.GetFirst3Primes().Sum();
    }

    private static int StepTwo(int intermediate)
    {
        return (intermediate + 5)/4;
    }
}

public class MyDependency
{
    public IEnumerable<int> GetFirst3Primes()
    {
        yield return 2;
        yield return 3;
        yield return 5;
    }
} 
```

在每个访问实例字段的方法上。为什么是这样？因为随着这个计算过程变得更加复杂，并且该类最终具有 15 个私有帮助方法，所以我真的希望能够将它们拉出到一个新类中，该类以语义上有意义的方式封装了步骤的子集。

当`MyClass`因为我们需要日志记录并且还需要通知 Web 服务而获得更多依赖项时（请原谅陈词滥调的示例），那么轻松查看哪些方法具有哪些依赖项真的很有帮助。

R# 之类的工具可以让您通过几次击键从一组私有静态方法中提取一个类。当所有私有辅助方法都与实例字段紧密耦合时尝试这样做，您会发现它可能会非常令人头疼。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2016-10-12T15:09:29.387

如前所述，静态方法有很多优点。然而; 请记住，它们将在应用程序的整个生命周期中一直存在于堆中。我最近花了一天时间跟踪 Windows 服务中的内存泄漏......泄漏是由实现 IDisposable 的类中的私有静态方法引起的，并且始终从 using 语句中调用。每次创建这个类时，都会在堆上为类中的静态方法保留内存，不幸的是，当类被释放时，静态方法的内存并没有释放。这导致该服务的内存占用在几天内消耗了服务器的可用内存，结果可预测。

# python - Python 库路径

> ID：135035
> 
> 赞同：80
> 
> 时间：2008-09-25T18:23:50.733
> 
> 标签：python

在 ruby​​ 中提供了库路径`$:`，在 perl中提供了库路径`@INC`- 如何在导入时获取 Python 搜索模块的路径列表？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-09-25T19:02:46.867

除了：

```
import sys
sys.path.append('/home/user/python-libs') 
```

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2008-09-25T18:25:18.390

我认为您正在寻找[sys.path](https://docs.python.org/3/library/sys.html#sys.path)

```
import sys
print (sys.path) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-25T18:25:07.457

```
import sys
sys.path 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-25T03:47:50.107

```
python -c "import sys; print('\n'.join(sys.path))"

/usr/local/Cellar/python@3.9/3.9.10/Frameworks/Python.framework/Versions/3.9/lib/python39.zip
/usr/local/Cellar/python@3.9/3.9.10/Frameworks/Python.framework/Versions/3.9/lib/python3.9
/usr/local/Cellar/python@3.9/3.9.10/Frameworks/Python.framework/Versions/3.9/lib/python3.9/lib-dynload
/usr/local/lib/python3.9/site-packages 
```

# python - 你应该总是喜欢 xrange() 而不是 range() 吗？

> ID：135041
> 
> 赞同：461
> 
> 时间：2008-09-25T18:24:37.893
> 
> 标签：python, range, xrange

为什么或者为什么不？

* * *

## 回答 #1

> 赞同：446
> 
> 时间：2008-09-25T18:34:38.977

对于性能，尤其是在大范围迭代时，`xrange()`通常会更好。但是，在某些情况下您可能更喜欢`range()`：

*   在 python 3 中，`range()`做了`xrange()`以前做的事情，现在`xrange()`不存在了。如果您想编写可在 Python 2 和 Python 3 上运行的代码，则不能使用`xrange()`.

*   `range()`在某些情况下实际上可以更快 - 例如。如果多次迭代相同的序列。 `xrange()`每次都必须重建整数对象，但`range()`会有真正的整数对象。（然而，它在内存方面的表现总是更差）

*   `xrange()`并非在需要真实列表的所有情况下都可用。例如，它不支持切片或任何列表方法。

[编辑] 有几篇文章提到`range()`了 2to3 工具将如何升级。作为记录，这是在一些示例用法上运行该工具的输出`range()`和`xrange()`

```
RefactoringTool: Skipping implicit fixer: buffer
RefactoringTool: Skipping implicit fixer: idioms
RefactoringTool: Skipping implicit fixer: ws_comma
--- range_test.py (original)
+++ range_test.py (refactored)
@@ -1,7 +1,7 @@

 for x in range(20):
-    a=range(20)
+    a=list(range(20))
     b=list(range(20))
     c=[x for x in range(20)]
     d=(x for x in range(20))
-    e=xrange(20)
+    e=range(20) 
```

如您所见，当在 for 循环或理解中使用时，或者已经用 list() 包装时，范围保持不变。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2008-09-25T20:04:30.133

不，它们都有各自的用途：

迭代时使用`xrange()`，因为它可以节省内存。说：

```
for x in xrange(1, one_zillion): 
```

而不是：

```
for x in range(1, one_zillion): 
```

另一方面，`range()`如果您确实想要一个数字列表，请使用。

```
multiples_of_seven = range(7,100,7)
print "Multiples of seven < 100: ", multiples_of_seven 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2008-09-25T18:28:49.117

仅当您需要实际列表时才应优先`range()`考虑。`xrange()`例如，当您想要修改由 返回的列表`range()`时，或者当您想要对其进行切片时。对于迭代甚至只是普通的索引，都可以正常`xrange()`工作（通常效率更高）。有一点`range()`比`xrange()`非常小的列表要快一点，但是根据您的硬件和各种其他细节，收支平衡可能是长度为 1 或 2 的结果；没什么好担心的。更喜欢`xrange()`.

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2012-08-03T12:38:58.210

另一个区别是 Python 2 的实现`xrange()`不支持大于 C 整数的数字，所以如果你想使用 Python 内置的大数支持来获得一个范围，你必须使用`range()`.

```
Python 2.7.3 (default, Jul 13 2012, 22:29:01) 
[GCC 4.7.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> range(123456787676676767676676,123456787676676767676679)
[123456787676676767676676L, 123456787676676767676677L, 123456787676676767676678L]
>>> xrange(123456787676676767676676,123456787676676767676679)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
OverflowError: Python int too large to convert to C long 
```

Python 3 没有这个问题：

```
Python 3.2.3 (default, Jul 14 2012, 01:01:48) 
[GCC 4.7.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> range(123456787676676767676676,123456787676676767676679)
range(123456787676676767676676, 123456787676676767676679) 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-25T18:28:16.870

`xrange()`效率更高，因为它不是生成对象列表，而是一次只生成一个对象。而不是 100 个整数，以及它们的所有开销，以及将它们放入的列表，您一次只有一个整数。更快的生成，更好的内存使用，更高效的代码。

除非我特别需要某事的清单，否则我总是赞成`xrange()`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-25T18:55:58.270

range() 返回一个列表，xrange() 返回一个 xrange 对象。

xrange() 速度更快，内存效率更高。但收益并不是很大。

列表使用的额外内存当然不仅仅是浪费，列表具有更多功能（切片、重复、插入……）。可以在[文档](http://docs.python.org/typesseq.html)中找到确切的差异。没有严格的规则，使用需要的东西。

Python 3.0 仍在开发中，但 IIRC range() 将与 2.X 的 xrange() 非常相似，并且 list(range()) 可用于生成列表。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-03-09T21:23:18.190

我只想说，获得具有切片和索引功能的 xrange 对象并不难。我已经编写了一些运行良好的代码，并且在计算（迭代）时与 xrange 一样快。

```
from __future__ import division

def read_xrange(xrange_object):
    # returns the xrange object's start, stop, and step
    start = xrange_object[0]
    if len(xrange_object) > 1:
       step = xrange_object[1] - xrange_object[0]
    else:
        step = 1
    stop = xrange_object[-1] + step
    return start, stop, step

class Xrange(object):
    ''' creates an xrange-like object that supports slicing and indexing.
    ex: a = Xrange(20)
    a.index(10)
    will work

    Also a[:5]
    will return another Xrange object with the specified attributes

    Also allows for the conversion from an existing xrange object
    '''
    def __init__(self, *inputs):
        # allow inputs of xrange objects
        if len(inputs) == 1:
            test, = inputs
            if type(test) == xrange:
                self.xrange = test
                self.start, self.stop, self.step = read_xrange(test)
                return

        # or create one from start, stop, step
        self.start, self.step = 0, None
        if len(inputs) == 1:
            self.stop, = inputs
        elif len(inputs) == 2:
            self.start, self.stop = inputs
        elif len(inputs) == 3:
            self.start, self.stop, self.step = inputs
        else:
            raise ValueError(inputs)

        self.xrange = xrange(self.start, self.stop, self.step)

    def __iter__(self):
        return iter(self.xrange)

    def __getitem__(self, item):
        if type(item) is int:
            if item < 0:
                item += len(self)

            return self.xrange[item]

        if type(item) is slice:
            # get the indexes, and then convert to the number
            start, stop, step = item.start, item.stop, item.step
            start = start if start != None else 0 # convert start = None to start = 0
            if start < 0:
                start += start
            start = self[start]
            if start < 0: raise IndexError(item)
            step = (self.step if self.step != None else 1) * (step if step != None else 1)
            stop = stop if stop is not None else self.xrange[-1]
            if stop < 0:
                stop += stop

            stop = self[stop]
            stop = stop

            if stop > self.stop:
                raise IndexError
            if start < self.start:
                raise IndexError
            return Xrange(start, stop, step)

    def index(self, value):
        error = ValueError('object.index({0}): {0} not in object'.format(value))
        index = (value - self.start)/self.step
        if index % 1 != 0:
            raise error
        index = int(index)

        try:
            self.xrange[index]
        except (IndexError, TypeError):
            raise error
        return index

    def __len__(self):
        return len(self.xrange) 
```

老实说，我认为整个问题有点愚蠢，无论如何 xrange 都应该做这一切......

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-25T18:29:50.907

出于以下原因选择范围：

1) xrange 将在较新的 Python 版本中消失。这为您提供了轻松的未来兼容性。

2) range 将具有与 xrange 相关的效率。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-17T11:57:52.020

书中给出的一个很好的例子：Magnus Lie Hetland的[Practical Python](http://books.google.co.in/books?id=KmKoNJ2OoOYC&pg=PA114&lpg=PA114&dq=zip%28range%285%29,%20xrange%28100000000%29%29&source=bl&ots=-BxWZinKHq&sig=O9G4mskHmYDljCCQv8v7alVUy_M&hl=en&sa=X&ei=0mMPUoa9LsXJrAe7p4DABA&ved=0CD0Q6AEwAw#v=onepage&q=zip%28range%285%29,%20xrange%28100000000%29%29&f=false)

```
>>> zip(range(5), xrange(100000000))
[(0, 0), (1, 1), (2, 2), (3, 3), (4, 4)] 
```

我不建议在前面的示例中使用 range 而不是 xrange ——尽管只需要前五个数字，但 range 会计算所有数字，这可能需要很长时间。使用 xrange，这不是问题，因为它只计算所需的数字。

是的，我阅读了@Brian 的回答：在 python 3 中，range() 无论如何都是一个生成器，并且 xrange() 不存在。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-25T19:42:30.297

好的，对于 xrange 与 range 的权衡和优势，这里的每个人都有不同的看法。它们大多是正确的， xrange 是一个迭代器，并且 range 充实并创建了一个实际列表。在大多数情况下，您不会真正注意到两者之间的区别。（您可以将 map 与 range 一起使用，但不能与 xrange 一起使用，但它会占用更多内存。）

但是，我认为您希望听到的是首选选择是 xrange。由于 Python 3 中的 range 是一个迭代器，因此代码转换工具 2to3 将正确地将所有 xrange 的使用转换为 range，并且会针对 range 的使用抛出错误或警告。如果您想确保将来轻松转换代码，您将仅使用 xrange，当您确定需要列表时使用 list(xrange)。我在今年（2008 年）在芝加哥的 PyCon 的 CPython 冲刺中了解到这一点。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-09-10T16:57:49.683

*   `range()`：`range(1, 10)`返回一个 1 到 10 个数字的列表并将整个列表保存在内存中。
*   `xrange()`: 与 类似`range()`，但不是返回列表，而是返回一个对象，该对象根据需要生成范围内的数字。对于循环，这比`range()`内存效率要快一些。`xrange()`像迭代器一样的对象并按需生成数字（惰性评估）。

```
In [1]: range(1,10)
Out[1]: [1, 2, 3, 4, 5, 6, 7, 8, 9]

In [2]: xrange(10)
Out[2]: xrange(10)

In [3]: print xrange.__doc__
Out[3]: xrange([start,] stop[, step]) -> xrange object 
```

`range()`执行与 Python 3中相同的`xrange()`操作，并且 Python 3 中不`xrange()`存在 术语。`range()`如果您多次迭代相同的序列，在某些情况下实际上可以更快。`xrange()`每次都必须重建整数对象，但`range()`会有真正的整数对象。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-01-18T18:11:19.020

虽然`xrange`比`range`大多数情况下要快，但性能差异非常小。`range`下面的小程序比较了对 a和 an 的迭代`xrange`：

```
import timeit
# Try various list sizes.
for list_len in [1, 10, 100, 1000, 10000, 100000, 1000000]:
  # Time doing a range and an xrange.
  rtime = timeit.timeit('a=0;\nfor n in range(%d): a += n'%list_len, number=1000)
  xrtime = timeit.timeit('a=0;\nfor n in xrange(%d): a += n'%list_len, number=1000)
  # Print the result
  print "Loop list of len %d: range=%.4f, xrange=%.4f"%(list_len, rtime, xrtime) 
```

下面的结果表明`xrange`确实更快，但还不足以让人流汗。

```
Loop list of len 1: range=0.0003, xrange=0.0003
Loop list of len 10: range=0.0013, xrange=0.0011
Loop list of len 100: range=0.0068, xrange=0.0034
Loop list of len 1000: range=0.0609, xrange=0.0438
Loop list of len 10000: range=0.5527, xrange=0.5266
Loop list of len 100000: range=10.1666, xrange=7.8481
Loop list of len 1000000: range=168.3425, xrange=155.8719 
```

所以一定要使用`xrange`，但除非你在受限的硬件上，否则不要太担心。

# flash - 面向 Flash 开发人员的面试问题

> ID：135047
> 
> 赞同：6
> 
> 时间：2008-09-25T18:24:56.177
> 
> 标签：flash

对于几位面试，我对Flash开发一点也不熟悉。

你会问什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T22:20:01.337

老实说，如果您自己不是 Flash 开发人员，我会告诫不要采访潜在的 Flash 开发人员，除非您这样做只是为了了解他们的性格（而不是他们的技能水平）。使用这项技术的经验会给你一个更现实的观点——盲目地问别人告诉你的问题是很好的问题会让你陷入困境。

也就是说，如果你能找到一个你认识的人参加你的面试并从技术角度提供评估，这里有一些事情我会提醒他们问：

*   面向对象编程
*   加载外部媒体
*   音频和视频播放（也可能是音量控制/混合）
*   事件监听器
*   过渡/动画
*   过滤/排序算法
*   常用 UI 元素：滚动条、表单元素、下拉菜单、翻转状态、拖放等。

这些是一般有用的知识领域，但真正的熟练程度测试是实际测试 - “编写满足这些要求的类”，或“这段代码不起作用，找出原因并修复它”是好方法立即深入了解候选人的工作（和思想）过程。

**最重要**的是：即使面试者对你所选择的主题缺乏特定的知识或经验，最好找一个学得很快并且很容易理解新概念的人，而不是找一个现在可能知道很多，但会抵制学习新事物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T18:31:58.280

Flash 可用于许多不同的目的。如果我对 2D 动画感兴趣，我可以使用 Flash 来绘制角色、动画场景、添加音频等，并且不会编程。

另一方面，我可能需要使用 Flash 为我的网站制作音频播放器小部件。我需要知道如何进行大量编程（Flash 的编程语言的名称是 ActionScript），但我可能对矢量绘图、设计或动画一无所知。

我的意思是，仅仅因为有人在他们的简历中列出了“Flash 体验”并不意味着他们已经使用 Flash 做任何接近你希望他们做的事情。如果你想要一个平面设计师、动画师、艺术家等，面试与你想要一个会编程的人会有很大的不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-28T20:57:35.713

*   解释什么是 AS2/F8 中的 MovieClip。然后去AS3解释一下Sprite和Movieclip的区别。
*   如何处理 AS2 中的键盘事件？AS3？
*   将 Flash 嵌入 html 的最佳方式。静态和动态发布。
*   如何制作预加载器？第一帧和单独的
*   在 AS2 和 AS3 中编写一个简单的可点击按钮。

这个列表当然可以继续，只是一些初学者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T18:31:03.587

你知道面向对象吗？

您喜欢 ActionScript3 中哪些 ActionScript 2 没有的东西？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T18:58:38.997

根据您对它们的需要，我会询问他们与 Flash 一起还知道什么。如果它适用于网络上的任何东西，100% Flash 应该很少是答案，因此在工具带中拥有其他技能很重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T19:01:32.813

请给我一个例子，说明您使用 Flash 实现的时候，后来决定您应该使用其他东西。你应该使用什么，为什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T19:04:01.060

请给我一个例子，说明你在 [选择一种技术] 中实现了一个接口，后来决定你应该使用 Flash。解释为什么 Flash 会是更好的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T19:11:56.283

Flash 与其他 Web 界面技术相比有哪些优点和缺点？请举例说明您何时使用过不同的技术以及原因。

# internet-explorer - Internet Explorer 8 和 Internet Explorer 6 并排

> ID：135057
> 
> 赞同：28
> 
> 时间：2008-09-25T18:26:54.457
> 
> 标签：internet-explorer, internet-explorer-8, internet-explorer-7, internet-explorer-6, superpreview

> **可能重复：**
> [在同一台计算机上运行 Internet Explorer 6、Internet Explorer 7 和 Internet Explorer 8](https://stackoverflow.com/questions/574463)

有没有办法让 Internet Explorer 8 和 Internet Explorer 6 并排而不进行虚拟化？

我使用了[多个 IE](http://tredosoft.com/Multiple_IE "多个 IE")，它在 Internet Explorer 7 上运行良好，但由于我安装了 Internet Explorer 8 beta 2，Internet Explorer 6 开始表现得很奇怪（也就是说，比平时更多）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T18:49:21.673

我也使用虚拟化。我的机器上有[Virtual PC](http://en.wikipedia.org/wiki/Windows_Virtual_PC) 2007，可以从[这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=04D26402-3199-48A3-AFA2-2DC0B40A73B6&displaylang=en)免费下载，并从Microsoft 下载了Internet Explorer Virual PC 映像。你可以在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)得到图像。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-07T15:45:23.957

Microsoft 不支持在一个操作系统上使用多个版本的 Internet Explorer。原因是操作系统和 Internet Explorer 共享某些 DLL。当您从 Internet Explorer 6 升级到 Internet Explorer 7（或 Internet Explorer 8）时，您实际上是在替换一些系统 DLL。这就是卸载 Internet Explorer 7 时“获得”Internet Explorer 6 的原因。

Internet Explorer 架构师 Chris Wilson 在博客文章[Multiple IEs on one machine](http://blogs.msdn.com/cwilso/archive/2006/02/01/522281.aspx)中解决了这个问题。Chris 表示动态替换`mshtml.dll`可能适用于 CSS 渲染“......但它与安装一整套新的 Internet Explorer 系统 DLL 不同”，当然不会被视为最终解决方案。

~~只有虚拟化才能为最终测试提供完整的 DLL 堆栈。~~

**编辑：**

2009 年 3 月 18 日，Microsoft Expression Web 团队发布了[SuperPreview](http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx)，这是一个免费的独立应用程序，允许在 Internet Explorer 8、Internet Explorer 8 - Internet Explorer7 兼容模式和 Internet Explorer 之间进行跨浏览器并排和洋葱皮比较6\. 计划增加浏览器和按需服务以在其他操作系统上实时呈现页面。

**编辑以回应 Zac 评论**

感谢您的评论。[Expression Web](http://en.wikipedia.org/wiki/Microsoft_Expression_Web) 3（将包括 SuperPreview）将允许在 Internet Explorer 6、Internet Explorer 7、Internet Explorer 8 和 Firefox 3 的任意组合之间进行比较。这是根据 Somasgear于 2009 年 6 月 5 日发布的博客条目 Expresion [Web 3](http://blogs.msdn.com/somasegar/archive/2009/06/05/expression-web-3.aspx)所述。在他的博客上的屏幕截图中，您将看到 Firefox 3 作为基本浏览器（左侧）和 Internet Explorer 6 作为比较浏览器。任何浏览器都可以放在比较窗口的任一侧。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-25T18:36:26.727

试试这个：[http](http://www.my-debugbar.com/wiki/IETester/HomePage)
: //www.my-debugbar.com/wiki/IETester/HomePage LE：这还不是完全兼容，有一些小问题，比如它在 JavaScript 弹出窗口上崩溃，但我在开发过程中发现它非常可靠。最后，我只是针对真正的 IE6 测试了 Web 应用程序，以确保一切正常。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-25T18:28:18.167

虚拟化是实现这一目标的最简单方法。它有更高的开销，但由于 IE 有很多挂钩到操作系统中，试图安装它的多个版本注定会造成混乱和失败。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-21T21:09:32.163

一种非常轻量级（并且刚刚发布）的方法是使用[Expression Web SuperPreview](http://www.microsoft.com/downloads/details.aspx?FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en)。它允许您并排比较 IE6 和 IE7（或 IE6 和 IE8+IE7 兼容模式）。它目前只是一个预览，但我已经使用它并取得了很好的效果。他们将发布一个商业版本，可以对更多浏览器进行并排比较，但他们说特定于 IE 的版本将永远免费。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-14T19:27:08.157

另一个多重、独立的 IE 选项：[IE Collection](http://finalbuilds.edskes.net/iecollection.htm)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T18:59:45.187

要么在 VM 中运行它，等到多个添加 IE8，要么使用[http://browsershots.org/](http://browsershots.org/)，它将从几个不同的操作系统和浏览器截取您的网站的屏幕截图。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-14T19:13:15.970

我已经[写了一篇循序渐进的博客文章](http://blog.donavon.com/2009/08/run-ie6-ie7-and-ie8-side-by-side-on.html)，展示了如何在 Windows 7 Ultimate 上将 IE6、IE7 和 IE8 作为“虚拟应用程序”运行。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-26T11:38:05.237

还有[独立的IE7](http://tredosoft.com/IE7_standalone)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T18:28:49.490

我所做的是将 VMware 与其他带有 IE6 的操作系统一起使用。

不完美，但它有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T18:05:38.330

我使用一个名为“Sandboxie”的实用程序（个人免费，商业 29 美元）来提供应用程序沙盒。这样做的一个有用的副作用是您可以将应用程序（甚至是修改操作系统的应用程序，例如 IE）安装到沙盒中，而父操作系统完全不知道（允许您拥有父操作系统的 IE 和沙盒 IE 的不同版本- 两者同时运行）。到目前为止我使用的两个场景：

*   父操作系统中的 Internet Explorer 7，并在沙盒中卸载 IE7 以使 IE6 可用
*   父操作系统IE 6，沙盒升级到IE8

注意事项：

*   *如果您需要同时*使用多个额外版本的 IE ，则需要购买完整版，因为沙盒中只能有一个版本的 IE，而免费版一次只支持一个*活动*沙盒
*   将一个版本的 IE 安装到沙箱中可能需要一些试验和错误 - IE8 特别棘手。不过，在安装（或卸载）期间出现的一些警告是微不足道的。

# c++ - #ifdef 与 #if - 作为启用/禁用特定代码部分编译的方法，哪个更好/更安全？

> ID：135069
> 
> 赞同：124
> 
> 时间：2008-09-25T18:28:04.717
> 
> 标签：c++, c, if-statement, coding-style, c-preprocessor

这可能是风格问题，但我们的开发团队中存在一些分歧，我想知道是否其他人对此事有任何想法......

基本上，我们有一些在正常开发过程中关闭的调试打印语句。就个人而言，我更喜欢执行以下操作：

```
//---- SomeSourceFile.cpp ----

#define DEBUG_ENABLED (0)

...

SomeFunction()
{
    int someVariable = 5;

#if(DEBUG_ENABLED)
    printf("Debugging: someVariable == %d", someVariable);
#endif
} 
```

不过，一些团队更喜欢以下内容：

```
// #define DEBUG_ENABLED

...

SomeFunction()
{
    int someVariable = 5;

#ifdef DEBUG_ENABLED
    printf("Debugging: someVariable == %d", someVariable);
#endif
} 
```

...哪种方法听起来更好，为什么？我的感觉是第一个更安全，因为总是有一些定义，并且没有危险它可以破坏其他地方的其他定义。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-25T19:28:50.547

*`#ifdef`当然*，我最初的反应是，但我认为这`#if`实际上有一些显着的优势——原因如下：

首先，您可以`DEBUG_ENABLED`在预处理器*和*编译测试中使用。示例 - 通常，我希望在启用调试时有更长的超时时间，所以使用`#if`，我可以写这个

```
 DoSomethingSlowWithTimeout(DEBUG_ENABLED? 5000 : 1000); 
```

... 代替 ...

```
#ifdef DEBUG_MODE
  DoSomethingSlowWithTimeout(5000);
#else
  DoSomethingSlowWithTimeout(1000);
#endif 
```

其次，如果您想从 a 迁移`#define`到全局常量，您将处于更好的位置。`#define`大多数 C++ 程序员通常不赞成 s。

第三，你说你的团队中存在分歧。我的猜测是这意味着不同的成员已经采用了不同的方法，你需要标准化。`#if`作为首选的规则意味着即使是错误的，使用的代码也`#ifdef`将编译并运行`DEBUG_ENABLED`。跟踪和删除不应该产生的调试输出比反之亦然容易得多*。*

哦，还有一点可读性。您应该能够在您的 中使用 true/false 而不是 0/1 `#define`，并且由于该值是单个词法标记，因此您不需要在其周围加上括号。

```
#define DEBUG_ENABLED true 
```

代替

```
#define DEBUG_ENABLED (1) 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2010-07-03T17:57:55.480

他们俩都很可怕。相反，请执行以下操作：

```
#ifdef DEBUG
#define D(x) do { x } while(0)
#else
#define D(x) do { } while(0)
#endif 
```

然后，每当您需要调试代码时，将其放入`D();`. 而且你的程序没有被可怕的`#ifdef`.

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-09-25T21:00:29.250

`#ifdef`只检查是否定义了一个令牌，给定

```
#define FOO 0 
```

然后

```
#ifdef FOO // is true
#if FOO // is false, because it evaluates to "#if 0" 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-07-01T18:32:52.913

我们在多个文件中遇到了同样的问题，并且总是存在人们忘记包含“功能标志”文件的问题（使用 > 41,000 个文件的代码库很容易做到）。

如果你有 feature.h：

```
#ifndef FEATURE_H
#define FEATURE_H

// turn on cool new feature
#define COOL_FEATURE 1

#endif // FEATURE_H 
```

但是后来你忘了在 file.cpp 中包含头文件：

```
#if COOL_FEATURE
    // definitely awesome stuff here...
#endif 
```

那么你有一个问题，在这种情况下，编译器将未定义的 COOL_FEATURE 解释为“假”并且无法包含代码。是的 gcc 确实支持导致未定义宏错误的标志......但大多数第 3 方代码要么定义要么不定义特性，因此这不会是可移植的。

我们采用了一种可移植的方式来纠正这种情况以及测试功能的状态：函数宏。

如果您将上述 feature.h 更改为：

```
#ifndef FEATURE_H
#define FEATURE_H

// turn on cool new feature
#define COOL_FEATURE() 1

#endif // FEATURE_H 
```

但是你又忘记在 file.cpp 中包含头文件：

```
#if COOL_FEATURE()
    // definitely awseome stuff here...
#endif 
```

由于使用了未定义的函数宏，预处理器会出错。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-09-25T20:48:58.717

出于执行条件编译的目的，#if 和 #ifdef*几乎*相同，但并不完全相同。如果您的条件编译依赖于两个符号，那么 #ifdef 将无法正常工作。例如，假设你有两个条件编译符号，PRO_VERSION 和 TRIAL_VERSION，你可能有这样的东西：

```
#if defined(PRO_VERSION) && !defined(TRIAL_VERSION)
...
#else
...
#endif 
```

使用上面的#ifdef 变得更加复杂，尤其是让#else 部分工作。

我处理广泛使用条件编译的代码，我们混合了#if 和#ifdef。我们倾向于将#ifdef/#ifndef 用于简单的情况，并在评估两个或多个符号时使用#if。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-09-25T18:34:23.690

我认为这完全是风格问题。两者都没有明显的优势。

一致性比任何一个特定的选择都更重要，所以我建议你和你的团队一起选择一种风格，并坚持下去。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-25T18:30:47.193

我自己更喜欢：

```
#if defined(DEBUG_ENABLED) 
```

因为它使创建查找相反条件的代码更容易发现：

```
#if !defined(DEBUG_ENABLED) 
```

对比

```
#ifndef(DEBUG_ENABLED) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-25T19:55:51.480

这是风格问题。但我推荐一种更简洁的方法：

```
#ifdef USE_DEBUG
#define debug_print printf
#else
#define debug_print
#endif

debug_print("i=%d\n", i); 
```

你这样做一次，然后总是使用 debug_print() 来打印或什么都不做。（是的，这两种情况都可以编译。）这样，您的代码就不会被预处理器指令弄乱。

如果您收到警告“表达式无效”并想摆脱它，这里有一个替代方案：

```
void dummy(const char*, ...)
{}

#ifdef USE_DEBUG
#define debug_print printf
#else
#define debug_print dummy
#endif

debug_print("i=%d\n", i); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-25T18:29:25.590

`#if`为您提供将其设置为 0 以关闭功能的选项，同时仍检测到开关在那里。
就我个人而言，我总是`#define DEBUG 1`这样我就可以用 #if 或 #ifdef 来捕捉它

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-25T19:00:45.467

## #if 和 #define MY_MACRO (0)

使用#if 意味着您创建了一个“define”宏，即，将在代码中搜索以替换为“(0)”的内容。这是我讨厌在 C++ 中看到的“宏观地狱”，因为它会通过潜在的代码修改污染代码。

例如：

```
#define MY_MACRO (0)

int doSomething(int p_iValue)
{
   return p_iValue + 1 ;
}

int main(int argc, char **argv)
{
   int MY_MACRO = 25 ;
   doSomething(MY_MACRO) ;

   return 0;
} 
```

在 g++ 上给出以下错误：

```
main.cpp|408|error: lvalue required as left operand of assignment|
||=== Build finished: 1 errors, 0 warnings ===| 
```

只有**一个**错误。

这意味着您的宏已成功与您的 C++ 代码交互：对函数的调用成功。在这个简单的例子中，它很有趣。但是我自己的宏在我的代码中默默播放的经验并不充满乐趣和满足感，所以......

## #ifdef 和 #define MY_MACRO

使用#ifdef 意味着你“定义”了一些东西。并不是说你给它一个价值。它仍然是污染，但至少，它会“被无所取代”，并且不会被 C++ 代码视为 lagitimate 代码语句。上面相同的代码，通过简单的定义，它：

```
#define MY_MACRO

int doSomething(int p_iValue)
{
   return p_iValue + 1 ;
}

int main(int argc, char **argv)
{
   int MY_MACRO = 25 ;
   doSomething(MY_MACRO) ;

   return 0;
} 
```

给出以下警告：

```
main.cpp||In function ‘int main(int, char**)’:|
main.cpp|406|error: expected unqualified-id before ‘=’ token|
main.cpp|399|error: too few arguments to function ‘int doSomething(int)’|
main.cpp|407|error: at this point in file|
||=== Build finished: 3 errors, 0 warnings ===| 
```

所以...

## 结论

我宁愿在我的代码中没有宏，但由于多种原因（定义标题保护或调试宏），我不能。

但至少，我喜欢让它们与我的合法 C++ 代码交互最少。这意味着使用没有价值的#define，使用#ifdef 和#ifndef（甚至是Jim Buck 建议的#if 定义），最重要的是，给它们起这么长的名字，那么陌生，没有人在他/她的头脑中会使用它是“偶然”的，并且绝不会影响合法的 C++ 代码。

## 后经

现在，当我重新阅读我的帖子时，我想知道我是否应该尝试找到一些永远不会是正确的 C++ 的值来添加到我的定义中。就像是

```
#define MY_MACRO @@@@@@@@@@@@@@@@@@ 
```

可以与#ifdef和#ifndef一起使用，但如果在函数内部使用，则不允许代码编译...我在g ++上成功尝试过，它给出了错误：

```
main.cpp|410|error: stray ‘@’ in program| 
```

有趣的。:-)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-06-10T21:04:36.043

这根本不是风格问题。不幸的是，这个问题也是错误的。您无法在更好或更安全的意义上比较这些预处理器指令。

```
#ifdef macro 
```

表示“如果定义了宏”或“如果存在宏”。宏的值在这里无关紧要。它可以是任何东西。

```
#if macro 
```

如果总是比较一个值。在上面的例子中，它是标准的隐式比较：

```
#if macro !=0 
```

#if 的用法示例

```
#if CFLAG_EDITION == 0
    return EDITION_FREE;
#elif CFLAG_EDITION == 1
    return EDITION_BASIC;
#else
    return EDITION_PRO;
#endif 
```

您现在可以将 CFLAG_EDITION 的定义放入您的代码中

```
#define CFLAG_EDITION 1 
```

或者您可以将宏设置为编译器标志。也[见这里](http://gcc.gnu.org/onlinedocs/gcc-3.0.1/cpp_4.html)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T18:31:30.233

第一个对我来说似乎更清楚。与已定义/未定义相比，使其成为标志似乎更自然。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-25T18:38:30.543

两者完全等价。在惯用用法中，#ifdef 仅用于检查定义性（以及我在您的示例中使用的内容），而 #if 用于更复杂的表达式，例如 #if defined(A) && !defined(B)。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-01-17T09:55:22.917

在不同的情况下为驱动程序指定条件定义的方式有所不同：

```
diff <( echo | g++ -DA= -dM -E - ) <( echo | g++ -DA -dM -E - ) 
```

输出：

```
344c344
< #define A 
---
> #define A 1 
```

这意味着，that`-DA`是同义词`-DA=1`，如果省略 value，则在`#if A`使用时可能会导致问题。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T19:04:15.973

有点 OT，但使用预处理器打开/关闭日志记录在 C++ 中绝对是次优的。有一些不错的日志工具，例如 Apache 的[log4cxx](http://logging.apache.org/log4cxx/index.html)，它们是开源的，不会限制您分发应用程序的方式。它们还允许您在不重新编译的情况下更改日志记录级别，如果您关闭日志记录，开销非常低，并且让您有机会在生产中完全关闭日志记录。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-08-04T16:14:42.977

我曾经使用`#ifdef`，但是当我切换到 Doxygen 进行文档时，我发现注释掉的宏无法记录（或者，至少 Doxygen 会产生警告）。这意味着我无法记录当前未启用的功能切换宏。

虽然可以只为 Doxygen 定义宏，但这意味着代码的非活动部分中的宏也将被记录下来。我个人想展示功能开关，否则只记录当前选择的内容。此外，如果只有在 Doxygen 处理文件时必须定义许多宏，这会使代码变得非常混乱。

因此，在这种情况下，最好始终定义宏并使用`#if`.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-25T18:32:53.270

或者，您可以声明一个全局常量，并使用 C++ if，而不是预处理器 #if。编译器应该为你优化未使用的分支，你的代码会更干净。

以下是Stephen C. Dewhurst 的[C++ Gotchas](http://books.google.com/books?id=L5ZbzVnpkXAC&pg=PA69&lpg=PA69&dq=C%2B%2B+gotchas+%23ifdef&source=web&ots=Rl36PkXigd&sig=bFPFNrvlXU-g0I9HQ0OpvcBEC0M&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA69,M1)关于使用#if 的说法。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T18:34:18.557

我一直使用#ifdef 和编译器标志来定义它......

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-16T05:40:56.603

我喜欢`#define DEBUG_ENABLED (0)`你可能需要多级调试。例如：

```
#define DEBUG_RELEASE (0)
#define DEBUG_ERROR (1)
#define DEBUG_WARN (2)
#define DEBUG_MEM (3)
#ifndef DEBUG_LEVEL
#define DEBUG_LEVEL (DEBUG_RELEASE)
#endif
//...

//now not only
#if (DEBUG_LEVEL)
//...
#endif

//but also
#if (DEBUG_LEVEL >= DEBUG_MEM)
LOG("malloc'd %d bytes at %s:%d\n", size, __FILE__, __LINE__);
#endif 
```

使调试内存泄漏变得更容易，而无需在调试其他事物时使用所有这些日志行。

此外，`#ifndef`围绕定义可以更轻松地在命令行中选择特定的调试级别：

```
make -DDEBUG_LEVEL=2
cmake -DDEBUG_LEVEL=2
etc 
```

如果不是因为这个，我会利用它，`#ifdef`因为编译器/make 标志将被文件中的标志覆盖。因此，您不必担心在提交之前更改标头。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-07-20T06:58:06.127

与许多事情一样，答案取决于。`#ifdef`对于保证在特定单元中定义或未定义的事物非常有用。例如，包括警卫。如果包含文件至少存在一次，则保证定义符号，否则不定义。

但是，有些东西没有这种保证。想想这个符号`HAS_FEATURE_X`。有多少个州？

1.  不明确的
2.  定义
3.  用一个值定义（比如 0 或 1）。

因此，如果您正在编写代码，尤其是共享代码，其中一些可能`#define HAS_FEATURE_X 0`意味着功能 X 不存在而另一些可能只是没有定义它，您需要处理所有这些情况。

`#if !defined(HAS_FEATURE_X) || HAS_FEATURE_X == 1`

仅使用 an`#ifdef`可能会导致一些细微的错误，因为某人或某个团队有将未使用的事物定义为 0 的约定，因此意外地打开（或关闭）某些东西。在某些方面，我喜欢这种`#if`方法，因为这意味着程序员**积极地**做了一个决定。留下未定义的东西是被动的，从外部的角度来看，有时可能不清楚这是故意还是疏忽。

# html - 为什么 Chrome、Firefox 和 IE 都以不同的方式呈现固定宽度的 SELECT 控件？

> ID：135076
> 
> 赞同：10
> 
> 时间：2008-09-25T18:29:01.410
> 
> 标签：html, cross-browser

我在这个上**掉头发**了……似乎当我修复 HTML SELECT 控件的宽度时，它会根据浏览器呈现不同的宽度。

知道如何在不必求助于多个样式表的情况下对其进行标准化吗？

这是我正在使用的内容：

```
.combo
{
    padding: 2px;
    width: 200px;
}

.text
{
    padding: 2px;
    width: 200px;
} 
```

这是我的页面文档类型：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T18:30:17.443

尝试设置`font-size`选择，这可能会影响它们的呈现方式。还要考虑`min-width`和`max-width`属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T19:56:58.277

表单控件总是不太服从样式设置尝试，特别是选择和文件输入，因此可靠地跨浏览器设置样式并考虑到未来的唯一方法是用 JavaScript 或 Flash 替换它们并模仿它们的功能

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-21T18:36:51.937

输入[类型=文本]，选择 { 边框：实心 1px #c2c1c1; 宽度：150px；填充：2px；}

// 然后

选择{宽度：156px；//需要输入[type=text] width + (border and padding) }

/* 输入[type=text] 宽度 = 宽度 + 填充 + 边框

选择宽度正好等于宽度。填充和边框在该宽度约束内呈现。这就是 SELECT 滚动的方式......

*/

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T18:30:07.367

确保删除所有默认边距和填充，并明确定义它们。确保您使用正确的 DOCTYPE 并因此在标准模式下呈现 IE。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T18:32:04.193

您可以使用伪造的下拉小部件并替换 SELECT。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T17:56:22.533

浏览器往往会限制您可以使用 CSS 设置表单控件样式的数量，因为表单控件有很多复杂的样式，这些样式因操作系统而异。CSS 无法完全描述这一点，因此浏览器将其中的一些内容排除在外。

Eric Meyer 写了一篇关于这个主题的好文章：

[http://meyerweb.com/eric/thoughts/2007/05/15/formal-weirdness/](http://meyerweb.com/eric/thoughts/2007/05/15/formal-weirdness/)

您能做的最好的事情就是接受您无法完全控制表单字段的外观，并尝试任何真正重要的样式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:35:35.167

尝试使用[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)或 Chrome 的“检查元素”功能（右键单击选择控件，单击“检查元素”）以查看该特定对象正在继承/呈现哪些样式属性。这应该会引导你朝着正确的方向前进。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T20:17:47.810

我已经尝试了所有这些建议......我终于有了它，所以它在 IE 和 Firefox 中看起来不错。看起来 SELECT 控件上的填充有问题。如果我将 SELECT 的宽度增加 2 个像素，则现在的大小正确。

```
 .combo
 {
     padding: 2px;
     width: 206px;
 }

.text
{
    padding: 2px;
    width: 200px;
} 
```

但是，Chrome 仍然没有显示相同的大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-25T23:07:56.293

马丁纳是正确的。

听起来您正在尝试控制各种类型的输入或菜单的宽度。您可以直接选择对象并指定宽度。例如：

```
select {
  width:350px;
} 
```

或者您可以使用文本区域执行此操作：

```
select {
      width:350px;
} 
```

其他类型的输入需要 Martinator 提到的语法。因此，对于文本、输入，甚至是文件类型输入，您需要为每个输入执行此操作：

```
input[type=text] {
      width:350px;
}

input[type=input] {
      width:350px;
}

input[type=file] {
      width:350px;
} 
```

# c# - 如何使 DataGridView 使用鼠标滚轮一次滚动一项？

> ID：135105
> 
> 赞同：8
> 
> 时间：2008-09-25T18:33:07.483
> 
> 标签：c#, .net, datagridview

当使用鼠标滚轮和这个控件时，我们想覆盖 DataGridView 的默认行为。默认情况下，DataGridView 滚动的行数等于 SystemInformation.MouseWheelScrollLines 设置。我们想做的是一次只滚动一个项目。

（我们在 DataGridView 中显示图像，图像有点大。由于这种滚动三行（典型的系统设置）太多，经常导致用户滚动到他们甚至看不到的项目。）

我已经尝试了几件事，到目前为止还没有取得太大的成功。以下是我遇到的一些问题：

1.  您可以订阅 MouseWheel 事件，但无法将事件标记为已处理并做我自己的事情。

2.  您可以覆盖 OnMouseWheel 但这似乎永远不会被调用。

3.  您可能可以在基本滚动代码中更正此问题，但这听起来很麻烦，因为其他类型的滚动（例如使用键盘）通过相同的管道进行。

有人有好的建议吗？

这是最终代码，使用给出的精彩答案：

```
 /// <summary>
    /// Handle the mouse wheel manually due to the fact that we display
    /// images, which don't work well when you scroll by more than one
    /// item at a time.
    /// </summary>
    /// 
    /// <param name="sender">
    /// sender
    /// </param>
    /// <param name="e">
    /// the mouse event
    /// </param>
    private void mImageDataGrid_MouseWheel(object sender, MouseEventArgs e)
    {
        // Hack alert!  Through reflection, we know that the passed
        // in event argument is actually a handled mouse event argument,
        // allowing us to handle this event ourselves.
        // See http://tinyurl.com/54o7lc for more info.
        HandledMouseEventArgs handledE = (HandledMouseEventArgs) e;
        handledE.Handled = true;

        // Do the scrolling manually.  Move just one row at a time.
        int rowIndex = mImageDataGrid.FirstDisplayedScrollingRowIndex;
        mImageDataGrid.FirstDisplayedScrollingRowIndex =
            e.Delta < 0 ?
                Math.Min(rowIndex + 1, mImageDataGrid.RowCount - 1):
                Math.Max(rowIndex - 1, 0);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:48:21.187

我只是做了一些自己的搜索和测试。我使用[Reflector](http://www.red-gate.com/products/reflector/)进行调查并发现了一些事情。该`MouseWheel`事件提供了一个`MouseEventArgs`参数，但`OnMouseWheel()`覆盖`DataGridView`将其强制转换为. 这在处理事件时也有效。确实被调用了，它在它使用的覆盖中。**`Handled`**`MouseEventArgs``MouseWheel``OnMouseWheel()``DataGridView``SystemInformation.MouseWheelScrollLines`

所以：

1.  您确实可以处理`MouseWheel`事件，转换`MouseEventArgs`为`HandledMouseEventArgs`和 set `Handled = true`，然后做您想做的事。

2.  子类化`DataGridView`，覆盖`OnMouseWheel()`自己，并尝试重新创建我在[Reflector](http://www.red-gate.com/products/reflector/)中阅读的所有代码，除了替换`SystemInformation.MouseWheelScrollLines`为`1`.

后者将是一个巨大的痛苦，因为它使用了许多私有变量（包括对`ScrollBar`s 的引用），并且您必须用自己的变量替换一些变量并使用反射获取/设置其他变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:39:24.530

我会将 DataGridView 子类化为我自己的自定义控件（您知道，添加一个新的 Windows 窗体 --> 自定义控件文件并将基类从 Control 更改为 DataGridView）。

```
public partial class MyDataGridView : DataGridView 
```

然后重写 WndProc 方法并替换如下：

```
protected override void WndProc(ref Message m)
{
    if (m.Msg == 0x20a)
    {
        int wheelDelta = ((int)m.WParam) >> 16;

        // 120 = UP 1 tick
        // -120 = DOWN 1 tick

        this.FirstDisplayedScrollingRowIndex -= (wheelDelta / 120);
    }
    else
    {
        base.WndProc(ref m);
    }
} 
```

当然，您将检查您没有将 FirstDisplayedScrollingRowIndex 设置为网格范围之外的数字等。但这很好用！

理查德

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T19:42:21.390

覆盖 OnMouseWheel 而不是调用 base.OnMouseWheel 应该可以工作。某些滚轮鼠标具有特殊设置，您可能需要自行设置才能使其正常工作。看到这篇文章[http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=126295&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=126295&SiteID=1)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T20:51:05.373

**更新：**由于我现在了解到`DataGridView`有一个`MouseWheel`事件，所以我添加了第二个更简单的覆盖。

实现此目的的一种方法是子类化`DataGridView`并覆盖以添加对消息`WndProc`的特殊处理。`WM_MOUSEWHEEL`

此示例捕获鼠标滚轮移动并将其替换为对`SendKeys.Send`.

*（这与仅滚动有点不同，因为它还选择了 . 的下一行/上一行`DataGridView`。但它有效。）*

```
public class MyDataGridView : DataGridView
{
    private const uint WM_MOUSEWHEEL = 0x20a;

    protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_MOUSEWHEEL)
        {
            var wheelDelta = ((int)m.WParam) >> 16;

            if (wheelDelta < 0)
            {
                SendKeys.Send("{DOWN}");
            }

            if (wheelDelta > 0)
            {
                SendKeys.Send("{UP}");
            }

            return;
        }

        base.WndProc(ref m);
    }
} 
```

第二次采取（与上述相同的警告）：

```
public class MyDataGridView : DataGridView
{
    protected override void OnMouseWheel(MouseEventArgs e)
    {
        if (e.Delta < 0)
            SendKeys.Send("{DOWN}");
        else
            SendKeys.Send("{UP}");
    }
} 
```

# java - Java 开发人员在 Mac OS 上遇到 Objective-C

> ID：135112
> 
> 赞同：12
> 
> 时间：2008-09-25T18:34:23.470
> 
> 标签：java, c++, objective-c, cocoa, macos

多年前我使用 C++ 进行开发，但现在我主要是一名 Java 软件工程师。鉴于我拥有一部 iPhone，准备下个月购买 MacBook，并且通常对开始使用 Mac OS 开发（使用 Objective C）感兴趣，我想我会提出这个问题：下一步是什么？

更具体地说，我应该拿起什么书，有没有一些人可以指点我的网络资源？我打算购买的一些书：

*   [Objective-C 2.0 中的编程](https://rads.stackoverflow.com/amzn/click/com/0321566157)
*   [Mac OS X 的 Cocoa(R) 编程（第 3 版）](https://rads.stackoverflow.com/amzn/click/com/0321503619)

有人熟悉这些标题吗？最后，一旦我踏上这段旅程，我会对我应该准备好期待什么的总结非常感兴趣。作为使用 IntelliJ IDEA 进行 Java 开发的人，当我转向在 Xcode 中编写 ObjectiveC 代码时，我会注意到哪些关键差异？Mac OS 桌面开发和 iPhone 开发有什么区别？习惯了Java垃圾收集，关于ObjectiveC垃圾收集/内存管理我应该知道些什么。还有其他任何人想指出的语言特定问题吗？如何构建 UI？它更接近于 Swing，构建代码与之交互的 Visual C++ 资源文件，还是更像一些将为 guis 生成代码的 borland IDE？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-26T04:52:40.083

购买了您问题中的两本书后，我推荐 Cocoa Programming for Mac OS X 作为学习语言和 Cocoa 框架的快速方法，并且可能是开始在 Cocoa 中生成实际应用程序的最快方法。我强烈推荐它。《Objective-C 2.0 编程》是一本很棒的参考书，但是如果您已经了解 C，那么它不会教您从另一本书中学不到的东西。但是，如果您需要列出 Objective-C 中所有保留关键字的列表，那么您可以阅读这本书。

所有的用户界面都可以通过程序生成，但是您会发现使用 XCode 附带的 Interface Builder 来布置用户界面要容易得多。你最终会得到更少的代码。使用绑定，您甚至可以消除与布局界面没有直接关系的代码。详细信息在 Cocoa Programming for Mac OS X 一书中。

我从 Java 中错过的一件大事是集合 API。在 Cocoa 中，你只得到 NSSet、NSArray 和 NSDictionary，并且没有类似 Comparable 接口的东西。这些类也是不可变的，但具有可变版本，例如 NSMutableArray。

实际上，我还没有玩过 Objective-C 2.0 中的垃圾收集。在 Objective-C 的早期版本中，内存管理由保留、释放和自动释放方法处理。创建对象时保留计数为 1。保留会增加该计数，释放会减少该计数，而自动释放对象则稍微复杂一些。再一次，Cocoa Programming 一书很好地解释了它。垃圾收集是一个选项，如果打开它，retain、release 和 autorelease 方法什么都不做。但是，如果您正在编写供他人使用的库或框架，则应该像关闭垃圾收集一样对其进行编程。这样，无论是否打开垃圾收集，应用程序都可以使用它。

至于 Web 资源，[http://cocoadevcentral.com/](http://cocoadevcentral.com/)是一个很棒的网站，提供初学者教程。[http://www.cocoadev.com/](http://www.cocoadev.com/)上的 CocoaDev Wiki包含许多主题的详细信息，您通常可以在 cocoa-dev 邮件列表[http://lists.apple.com/上找到一些有用的信息和人员邮递员/listinfo/cocoa-dev](http://lists.apple.com/mailman/listinfo/cocoa-dev)

iPhone 的开发略有不同，细节受到 NDA 的限制。但是，如果您获得 Apple 的批准以访问 iPhone 开发人员中心，Apple 提供了一些很棒的视频概述了这些差异，这些视频为您提供了从 Mac OS X 跳转到 iPhone OS X 编程所需的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:42:03.437

获取适用于 Mac OS X 的 Cocoa Programming。这本书将回答您的大部分问题。您也可以开始阅读[成为 XCoder](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.cocoalab.com%2FBecomeAnXcoder.pdf&ei=2trbSJmKHoes6wOlm-WLBA&usg=AFQjCNG9qsDE2hk4GwdKRORm-NX6cJJA4Q&sig2=fLFx1KXvDNhGa9SIOafshw)和[Cocoa Dev Central](http://cocoadevcentral.com/)。

iPhone SDK 仍处于保密协议下，因此除了 Apple 提供的资源外，您将无法找到任何有关它的在线资源。

Cocoa UI 基于 MVC。您使用 Interface Builder 来设计您的视图，然后将其绑定到您的模型和控制器。Objective C 是 C 和 Smalltalk 的混合体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:46:15.470

您的另一个选择是 jaiPhon，它允许您编写在构建时翻译成 iPhone 语言的 Java 应用程序。

我不知道它是否可用，或者它是否是商业软件或其他什么，但它仍然很有趣。

[http://www.jaiphon.com/](http://www.jaiphon.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-03T05:13:30.527

另请查看：

[http://www.xmlvm.org/overview/](http://www.xmlvm.org/overview/)

它是一个试图将用多种源语言编写的程序交叉编译为多种目标语言的项目。最初的测试用例之一是用 Java 编写程序并在 iPhone 上运行它们。在网站上观看视频是值得的。

话虽如此，我还没有尝试过。该项目似乎是测试版，在他们的 SourceForge 网站上没有很多活动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T05:37:32.493

你已经熟悉方括号了吗？

从我的角度来看，这[是其基本原理](https://stackoverflow.com/questions/142476/do-i-have-a-shot-at-learning-objective-c#142636)的简要说明。我希望这也可能有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T09:13:56.547

我想当你从 IntelliJ 跳到 Xcode 时，你会感到相当赤裸。但这只是从工具的角度来看。带上额外的衣服（TextMate+FScript）！

# c# - 如何使用事件使方法运行？

> ID：135121
> 
> 赞同：0
> 
> 时间：2008-09-25T18:35:50.427
> 
> 标签：c#, .net, events, methods

所以在我的文档中它说：

> 公共事件 TreeViewPlusNodeCheckedEventHandler NodeChecked()
> 
> 只要在树上选中节点的复选框，您就可以使用此事件运行导致方法运行。

那么如何在我的代码隐藏文件中添加一个在检查节点时将运行的方法？我要运行的方法是：

```
protected void TOCNodeCheckedServer(object sender, TreeViewPlusNodeEventArgs args)
{

    TreeViewPlusNode aNode = args.Node;
    if (!aNode.Checked)
        return;
    List<string> BaseLayers = new List<string>();
    _arcTOCConfig.BaseDataLayers.CopyTo(BaseLayers);

    List<MapResourceItem> mapResources = new List<MapResourceItem>();

    if (BaseLayers.Contains(aNode.Text))
    {
        foreach (BaseDataLayerElement anEl in _arcTOCConfig.BaseDataLayers)
        {
            if (!aNode.Text.Equals(anEl.Name))
            {
                if (aNode.TreeViewPlus.Nodes.FindByValue(anEl.Name).Checked)
                {
                    aNode.TreeViewPlus.Nodes.FindByValue(anEl.Name).Checked = false;
                    aNode.TreeViewPlus.Nodes.FindByValue(anEl.Name).Refresh();
                    MapResourceItem aMapResource = this.Map1.MapResourceManagerInstance.ResourceItems.Find(anEl.Name);
                    aMapResource.DisplaySettings.Visible = false;
                    this.Map1.RefreshResource(anEl.Name);
                    mapResources.Add(aMapResource);
                    this.Map1.MapResourceManagerInstance.ResourceItems.Remove(aMapResource);
                }
                else
                {
                    MapResourceItem aMapResource = this.Map1.MapResourceManagerInstance.ResourceItems.Find(anEl.Name);
                    mapResources.Add(aMapResource);
                    this.Map1.MapResourceManagerInstance.ResourceItems.Remove(aMapResource);
                }

            }
        }

        foreach (MapResourceItem aMapResource in mapResources)
        {
            int count = this.Map1.MapResourceManagerInstance.ResourceItems.Count - 1;
            this.Map1.MapResourceManagerInstance.ResourceItems.Insert(count, aMapResource);
            this.Map1.MapResourceManagerInstance.CreateResource(aMapResource);
        }
        this.Map1.InitializeFunctionalities();
        this.Map1.Refresh();
    }
} 
```

与 2008 年 c# .net 3.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T18:39:03.570

您需要为事件分配一个委托并让它运行您想要的方法。就像是 ：

TreeViewControl.NodeChecked += 新 TreeViewPlusNodeCheckedEventHandler(TOCNodeCheckedServer)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T18:39:09.667

只需向事件添加一个处理程序。

```
myTreeView.NodeChecked += new TreeViewPlusNodeCheckedEventHandler(TOCNodeCheckedServer); 
```

或（因为实际上不需要实例化 TreeViewPlusNodeCheckedEventHandler）

```
myTreeView.NodeChecked += TOCNodeCheckedServer; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T18:40:31.740

这是为事件注册处理程序的标准案例

```
treeView.NodeChecked += TOCNodeCheckedServer; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T18:45:50.260

在表单的初始化方法上添加

```
TOCTree.NodeChecked += new TreeViewPlusNodeCheckedEventHandler (TOCNodeCheckedServer); 
```

这将告诉您的应用在 TOCNode 触发 NodeChecked 事件时运行 TOCNodeCheckedServer。

网络上有大量资源解释了它是如何工作的。以[http://www.csharphelp.com/archives/archive253.html](http://www.csharphelp.com/archives/archive253.html) 为例。

# web-services - 带有 API 的托管 CRM 系统？

> ID：135122
> 
> 赞同：0
> 
> 时间：2008-09-25T18:35:57.290
> 
> 标签：web-services, email, crm

如果这有点偏离主题，我深表歉意。

我希望找到一个软件即服务的 CRM 系统，可以轻松地与我们的自定义用户管理应用程序集成。从根本上说，我们拥有自己的账户并为这些注册用户提供服务；我们经常与拥有这些帐户的人进行电子邮件对话——如果我们的 CRM 界面突然亮起这些对话的记录，那就太好了。

这是我梦寐以求的解决方案，如果可能，请告诉我： - 我们有一个“服务”电子邮件别名；我想将“track@GreatCrmVendor.com”添加到该别名，以便所有电子邮件都抄送给我们的 CRM 供应商。- 在我们应用程序的管理 UI 中，我希望能够访问 CRM 供应商为我们捕获的电子邮件 - 类似于基于 REST 的 Web 服务调用，它要求“给我电子邮件 X 的客户的所有电子邮件标题”。

你知道这样的CRM供应商吗？

**澄清**：我知道如何建立这样一个包罗万象的电子邮件帐户，解析电子邮件，将它们记录在数据库中等等......我只是不想在其中投入开发时间，我希望我们可以与一个好的现成解决方案集成。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:48:44.370

据我所知，Salesforce.com 有一个广泛的 SOAP API。

[http://www.salesforce.com/developer/](http://www.salesforce.com/developer/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:40:31.100

[http://www.advancedsps.com/?gclid=CPnlpuXL95UCFQRfagodDR554w](http://www.advancedsps.com/?gclid=CPnlpuXL95UCFQRfagodDR554w)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:48:51.923

试试这个：[链接文本](http://www.highrisehq.com "高层客户关系管理")

它与电子邮件配合得很好——如果你想进行集成，它还有一个 API……

电子邮件集成信息的链接在上面的页面上，以及开发人员 API

<< 免责声明：不被他们雇用，只是一个快乐的客户>>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T15:47:23.750

Salesforce AppExchange 中有几个声称可以处理此问题的应用程序：

*   [http://sites.force.com/appexchange/apex/listingDetail?listingId=a0N300000016YR4EAM](http://sites.force.com/appexchange/apex/listingDetail?listingId=a0N300000016YR4EAM)
*   [http://sites.force.com/appexchange/apex/listingDetail?listingId=a0N300000016Y7nEAE](http://sites.force.com/appexchange/apex/listingDetail?listingId=a0N300000016Y7nEAE)

salesforce.com API 的使用也非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T16:02:33.447

Sugar CRM 有一个 API，他们提供托管服务。

见：[http ://www.sugarcrm.com/wiki/index.php?title=SOAP_Documentation](http://www.sugarcrm.com/wiki/index.php?title=SOAP_Documentation)

# asp.net - 如何为我的网络应用获取类似 Gmail 的文件上传？

> ID：135123
> 
> 赞同：18
> 
> 时间：2008-09-25T18:36:09.783
> 
> 标签：asp.net, javascript, upload, file-upload, gmail

我想为我的一个项目添加类似 gmail 的文件上传功能。有人可以帮我吗？

我的应用程序是在 vb.net 中构建的。

我将不胜感激任何帮助或指导。

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-25T18:37:09.143

查看[SWFUpload](http://swfupload.org/)，它本质上是一个 javascript api，用于 flash 绝对优越的文件上传处理能力。在浏览器最终赶上之前最好的事情。

从链接：

> *   在对话框中通过 ctrl/shift-selecting 一次上传多个文件
> *   所有事件的 Javascript 回调
> *   在上传开始前获取文件信息
> *   使用 XHTML 和 css 样式上传元素
> *   使用 HTML 上传文件时显示信息
> *   无需重新加载页面
> *   适用于所有支持 Flash 的平台/浏览器。
> *   如果 Flash 或 javascript 不可用，则优雅地降级为正常的 HTML 上传表单
> *   在上传开始之前控制文件大小
> *   仅在对话框中显示选择的文件类型
> *   排队上传，在开始上传之前删除/添加文件

[演示](http://demo.swfupload.org/)

----- iframe 上传 -----

首先，您希望在您的页面上有一个 iframe。这用于服务器通信。您稍后会隐藏它，但现在，让它保持可见。给那个 iframe 一个 name 属性，比如“uploader”之类的。

现在，在您的表单中，将目标设置为 iframe 的名称，并将操作设置为您在服务器上将接受文件上传的脚本（如带有文件上传的普通表单）。在该表单内添加一个带有文本“添加文件”的链接。设置该链接以运行 javascript 函数，该函数将向表单添加新输入。这可以通过 DOM 完成，但我会推荐一个像[jquery](http://jquery.com/)这样的 javascript 库。

将新文件输入添加到表单后，将该输入的模糊事件设置为将提交表单的 javascript 函数，然后定期检查它的输出。读取 iframe 可能会很棘手，但这是可能的。

让您的文件上传脚本输出“完成”。或上传完成时的文件名或其他内容。

每隔一秒左右检查一次，直到有内容为止。获得内容后，终止计时器并将文件输入替换为文件名（或“文件上传”）或其他名称。

用 css 隐藏你的 iframe。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-25T18:39:02.273

来自小唯！（雅虎用户界面），[https://yuilibrary.com/yui/docs/uploader/](https://yuilibrary.com/yui/docs/uploader/)

> 1.  在单个“打开文件”对话框中选择多个文件。
> 2.  文件扩展名过滤器，方便用户选择。
> 3.  文件上传的进度跟踪。
> 4.  一系列文件元数据：文件名、大小、创建日期、修改日期和作者。
> 5.  在文件上传过程的各个方面调度的一组事件：文件选择、上传进度、上传完成等。
> 6.  在文件上传 POST 请求中包含附加数据。
> 7.  由于修改了 SEND 缓冲区大小，宽带连接上的文件上传速度更快。
> 8.  文件上传完成后的同页服务器响应。

**完全免费**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T05:04:23.113

这是**[gmail 上传器克隆](http://abcoder.com/javascript/gmail-uploader-clone-with-drag-drop-feature-free-download-with-source-code/)**。这是带有一些额外功能**的 gmail 上传器的精确克隆。**上传后可以看到图片的缩略图，**拖动**缩略图可以改变顺序并替换任何缩略图。它是使用**jQuery**完成的。[**你可以在这里**](http://abcoder.com/Gmail-Uploader/)看到演示。源代码可[在单个 zip 文件中免费下载](http://www.abcoder.com/Gmail-Uploader/Gmail-Uploader.zip)。

我希望您可以轻松删除一些代码并获得所需的东西。如果您需要进一步的帮助，可以在 ABCoder 博客上发表评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-16T01:30:15.983

Now it has been 2 years, I used the uploadify in my legacy system and it works good. but you need to write some hack code (such like hold the session).

I recommend you use [jquery upload](https://blueimp.github.io/jQuery-File-Upload/), which is pure HTML, no swf, no session problems and really great!

== on 2013, what I wrote:

I am considering which to choose, SWFupload or [uploadify](http://www.uploadify.com/) .

but on SWFupload's official website , it says that it has not been under active development and the author is hoping someday the SWFupload could revive...

so ... I decided to try "uploadify", which seems supports many options, callbacks with lots of demos. (after checking its source code, I guess the author wraps the "SWFupload v1" and "SWFupload v2" in his "uploadify v3"...)

and there's a full list of [this kind of uploaders](http://www.enfew.com/jquery-file-upload-plugins/).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T18:12:47.000

对于非闪存解决方案，您可以使用[NeatUpload](http://www.brettle.com/Default.aspx?pageid=32)。去年我在一个没有闪存要求的大型项目中使用了它。很容易集成到现有的解决方案中。我认为这是一件轻而易举的事。以我有限的经验，比在 ASP.NET 中使用 SWFUpload 更容易。可能是因为 NeatUpload 是专为 ASP.NET 构建的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T20:02:36.600

您是在谈论没有整页回发的上传吗？看一下[http://www.phpletter.com/Demo/AjaxFileUpload-Demo/](http://www.phpletter.com/Demo/AjaxFileUpload-Demo/)，它创建了一个隐藏的 iframe，复制输入控件，并使用 iframe 执行 post 以获取服务器上的文件。

如果您正在寻找当用户单击“附加文件”并自动弹出文件浏览对话框时的行为，可以通过 Javascript 完成，但在 FireFox 中不起作用，它具有要求用户的安全预防措施直接调用“浏览”按钮（而不是通过脚本以编程方式）。

对于“自动”上传，使用 Javascript 附加到“输入”控件的“值”属性的“更改”事件，以便在选择文件时执行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T06:03:24.283

您可以改用[**Flickr Uploader**](http://abcoder.com/javascript/flickr-uploader-clone-free-download-with-source-code/)克隆。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T23:25:59.837

您可以为此使用 iFrame

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T18:47:04.470

我想对“类似 Gmail 的”文件上传做更多的说明。

你的意思是如果它坐了一点，它会自动将它附加到草稿上吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T19:31:55.843

Gmail 的代码很难找到，但如果我不得不猜测的话，它是这样工作的：

*   当您单击“附加另一个文件”时，它会插入一个常规输入类型的文件控件。在 IE 上，它也可能以编程方式触发“浏览”按钮上的单击事件，因此文件对话框立即打开（它在 Firefox 上不这样做，而且我没有方便的 IE，但我相信 IE 允许这样做）
*   选择文件后，它会检测输入控件的更改事件，并启动计时器。
*   当计时器触发时，它会从表单中分离输入元素，并将其添加到隐藏 iframe 中的不同表单中，在主（可见）表单中放置一个简单的链接。然后提交隐藏的 iframe 以上传文件。（它也可能克隆输入元素，但我还没有尝试过这是否有效。）

# c++ - 是否应该更喜欢 STL 算法而不是手动循环？

> ID：135129
> 
> 赞同：27
> 
> 时间：2008-09-25T18:37:13.353
> 
> 标签：c++, algorithm, stl

我似乎在这里的问题和答案中看到了比 for_each()、transform() 等更多的迭代器的“for”循环。Scott Meyers 建议[首选 stl 算法](http://www.ddj.com/cpp/184401446)，或者至少他在 2001 年就这样做了。当然，使用它们通常意味着将循环体移动到函数或函数对象中。有些人可能觉得这是一个不可接受的并发症，而另一些人可能觉得它更好地解决了问题。

那么...... STL 算法是否应该优于手动循环？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-25T18:42:23.077

这取决于：

*   是否需要高性能
*   循环的可读性
*   算法是否复杂

如果循环不是瓶颈，并且算法很简单（如 for_each），那么对于当前的 C++ 标准，我更喜欢手动循环以提高可读性。（逻辑的局部性是关键。）

然而，现在一些主要编译器支持 C++0x/C++11，我会说使用 STL 算法，因为它们现在允许 lambda 表达式——因此逻辑的局部性。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-01-29T23:46:55.160

我将在此反对这种做法，主张将 STL 算法与仿函数一起使用会使代码更易于理解和维护，但您必须正确执行。您必须更加注意可读性和清晰性。特别是，您必须正确命名。但是当你这样做时，你可以得到更干净、更清晰的代码，并将范式转变为更强大的编码技术。

让我们举个例子。这里我们有一组孩子，我们想将他们的“Foo Count”设置为某个值。标准的 for 循环迭代器方法是：

```
for (vector<Child>::iterator iter = children.begin();
    iter != children.end();
    ++iter)
{
    iter->setFooCount(n);
} 
```

哪个，是的，它很清楚，而且绝对*不错的*代码。您只需稍微看一下就可以弄清楚。但是看看我们可以用适当的函子做什么：

```
for_each(children.begin(), children.end(), SetFooCount(n)); 
```

哇，这正是我们需要的。您不必弄清楚；您立即知道它正在设置每个孩子的“Foo Count”。（如果我们不需要 .begin() / .end() 废话会更清楚，但你不能拥有一切，而且他们在制作 STL 时没有咨询我。）

诚然，您确实需要定义这个神奇的函子`SetFooCount`，但它的定义是非常样板：

```
class SetFooCount
{
public:
    SetFooCount(int n) : fooCount(n) {}

    void operator () (Child& child)
    {
        child.setFooCount(fooCount);
    }

private:
    int fooCount;
}; 
```

总的来说，它的代码更多，您必须查看另一个地方才能确切了解`SetFooCount`正在做什么。但是因为我们命名得很好，99% 的时间我们都不需要查看`SetFooCount`. 我们假设它按照它所说的做，我们只需要看看这`for_each`条线。

我真正喜欢的是，使用算法会导致范式转变。与其将列表视为对象的集合，并对列表的每个元素执行操作，不如将列表视为第一类实体，并直接对列表本身进行操作。for 循环遍历列表，在每个元素上调用一个成员函数来设置 Foo Count。相反，我正在执行一个命令，该命令设置列表中每个元素的 Foo Count。这很微妙，但是当你看森林而不是树木时，你会获得更多的力量。

因此，只要稍加思考和仔细命名，我们就可以使用 STL 算法来制作更清晰、更清晰的代码，并开始在更细粒度的层面上进行思考。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-25T20:14:34.527

这`std::foreach`是几年前让我诅咒 STL 的那种代码。

我不能说它是否更好，但我更喜欢将循环代码**放在**循环序言下。对我来说，这是一个**强烈的要求**。并且`std::foreach`构造不允许我这样做（奇怪的是，就我而言，Java 或 C# 的 foreach 版本很酷......所以我想它证实了循环体的位置对我来说非常非常重要）。

因此，只有当只有一个可读/可理解的算法可用时，我才会使用 foreach。如果不是，不，我不会。但我想这是一个品味问题，因为我也许应该更加努力地理解并学习解析这一切......

请注意，boost 的人显然也有同样的感觉，因为他们写了 BOOST_FOREACH：

```
#include <string>
#include <iostream>
#include <boost/foreach.hpp>

int main()
{
    std::string hello( "Hello, world!" );

    BOOST_FOREACH( char ch, hello )
    {
        std::cout << ch;
    }

    return 0;
} 
```

请参阅： http: [//www.boost.org/doc/libs/1_35_0/doc/html/foreach.html](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach.html)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-25T19:06:21.523

这确实是斯科特迈耶斯弄错的一件事。

如果有一个实际的算法与您需要做的事情相匹配，那么当然可以使用该算法。

但是，如果您需要做的只是循环遍历一个集合并对每个项目执行某些操作，那么只需执行正常循环，而不是尝试将代码分离到不同的仿函数中，那最终只会将代码切成小块而没有任何实际收益。

还有一些其他选项，例如 boost::bind 或 boost::lambda，但这些都是非常复杂的模板元编程事物，它们在调试和单步执行代码时效果不佳，因此通常应避免使用它们。

正如其他人所提到的，当 lambda 表达式成为一等公民时，这一切都会改变。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T20:13:29.380

循环是命令式的`for`，算法是声明式的。当您编写`std::max_element`时，很明显您需要什么，当您使用循环来实现相同时，不一定如此。

算法也可以有轻微的性能优势。例如，在遍历 时`std::deque`，专门的算法可以避免冗余检查给定增量是否将指针移动到块边界上。

然而，复杂的函子表达式很快就会使算法调用变得不可读。如果显式循环更具可读性，请使用它。如果一个算法调用可以不用十层绑定表达式来表达，那么无论如何更喜欢它。*在这里*，可读性比性能更重要，因为这种优化是 Knuth 著名地归功于 Hoare 的原因。一旦你意识到它是一个瓶颈，你就可以毫无困难地使用另一个构造。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-25T18:50:20.077

这取决于，如果算法不采用函子，那么总是使用 std 算法版本。你写起来更简单，更清晰。

对于采用函子的算法，通常不会，直到可以使用 C++0x lambda。如果函子很小并且算法很复杂（大多数不是），那么仍然使用 std 算法可能会更好。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-26T01:01:01.887

我*原则上是 STL 算法的*忠实拥护者，但实际上它太麻烦了。当你定义你的仿函数/谓词类时，两行 for 循环可以变成 40 多行代码，这突然变得难以弄清楚 10 倍。

值得庆幸的是，在 C++0x 中，有了 lambda 函数和新语法，事情会**变得容易得多。**在 Wikipedia 上查看此[C++0x 概述。](http://en.wikipedia.org/wiki/C%2B%2B0x)`auto``for`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T18:50:01.623

我不会为此使用硬性规定。有许多因素需要考虑，例如您经常在代码中执行某些操作，只是一个循环或“实际”算法，该算法是否取决于您必须传输到您的函数的大量上下文？

例如，我不会放类似的东西

```
for (int i = 0; i < some_vector.size(); i++)
    if (some_vector[i] == NULL) some_other_vector[i]++; 
```

进入算法，因为它会导致更多的代码百分比明智，我将不得不以某种方式处理让算法知道 some_other_vector 的问题。

还有很多其他示例表明使用 STL 算法很有意义，但您需要根据具体情况做出决定。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-25T19:44:25.737

我认为 STL 算法接口是次优的，应该避免使用，因为直接使用 STL 工具包（用于算法）*可能会*在性能上获得非常小的收益，但肯定会降低**可读性、可维护性，甚至是一点可写性**。重新学习如何使用这些工具。

一个标准的 for 循环在向量上的效率要高多少：

```
int weighted_sum = 0;
for (int i = 0; i < a_vector.size(); ++i) {
  weighted_sum += (i + 1) * a_vector[i];  // Just writing something a little nontrivial.
} 
```

比使用 for_each 构造，还是尝试将其放入累积调用中？

您可能会争辩说迭代过程效率较低，但是 for _ each 还在每个步骤中引入了一个函数调用（这*可能*会通过尝试内联函数来缓解，但请记住“内联”只是对编译器的建议 -它可能会忽略它）。

无论如何，差异很小。根据我的经验，您编写的 90% 以上的代码***不是*性能关键，而是*coder* -time 关键**。通过保持你的 STL 循环完全内联，它是非常可读的。对于您自己或未来的维护者来说，绊倒的间接性更少。如果它在您的风格指南中，那么您正在为编码人员节省一些学习时间（承认这一点，第一次学习正确使用 STL 涉及一些问题）。最后一点就是我所说的可写性成本。

当然，也有一些特殊情况——例如，您实际上可能*希望*将 for_each 函数分开，以便在其他几个地方重复使用。或者，它可能是为数不多的对性能至关重要的部分之一。但这些都是特殊情况——例外而不是规则。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-10-02T03:27:34.387

IMO，应该避免使用许多标准库算法，例如 std::for_each - 主要是因为其他人提到的缺少 lambda 问题，但也因为存在不适当隐藏细节这样的事情。

当然，在函数和类中隐藏细节都是抽象的一部分，一般来说，库抽象比重新发明轮子要好。但是抽象的一个关键技能是知道什么时候做——什么时候*不做*。过度抽象会损害可读性、可维护性等。良好的判断来自经验，而不是来自僵化的规则——当然，在学习打破规则之前，你必须先学习规则。

OTOH，值得考虑的事实是，很多程序员已经使用 C++（以及在此之前，C、Pascal 等）很长时间了。旧习惯很难改掉，有一种叫做[认知失调](http://en.wikipedia.org/wiki/Cognitive_dissonance)的东西，它经常导致借口和合理化。不过，不要草率下结论——标准的人至少有可能犯下决策后的不和谐。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T19:17:16.597

我认为一个重要因素是开发人员的舒适度。

使用 transform 或 for_each 可能是正确的做法，但它的效率并不高，而且手写循环本身并不危险。如果开发人员需要半小时来编写一个简单的循环，而不是半天来获得 transform 或 for_each 的语法，并将提供的代码移动到函数或函数对象中。然后其他开发人员需要知道发生了什么。

学习使用 transform 和 for_each 而不是手工循环可能会为新开发人员提供最好的服务，因为他将能够始终如一地使用它们而不会出错。对于我们其他人来说，编写循环是第二天性的，最好坚持我们所知道的，并在业余时间更熟悉算法。

这么说吧——如果我告诉我的老板我花了一天时间将手工循环转换为 for_each 并转换调用，我怀疑他会非常高兴。

# c# - 语义合并工具

> ID：135130
> 
> 赞同：7
> 
> 时间：2008-09-25T18:37:26.660
> 
> 标签：c#, refactoring, merge, devtools

背景：在我的工作中，我们使用 SVN、C# 和 VisualStudio。我的部分任务经常涉及全局重命名。在重命名某些内容然后合并更改后，我经常会得到一个损坏的构建。

问题：是否有解决方案可以查看我的更改，注意全局重命名，然后将其应用于其他人在合并时所做的编辑？

获得相同效果的另一种方法是某种重构日志，然后将其应用于传入的编辑。

该工具不一定是完美的，即使它只是在他们的编辑中注意到任何引用我编辑过的东西的引用都是有价值的。

**编辑**我知道 VS 的重构工具。我正在寻找的是允许我在重构我的工作副本之后，将相同的重构应用于我现在需要合并的其他人的编辑的东西。

理想的解决方案是确保在我进行重构时没有未完成的编辑，但这会阻止其他人在下一周或更长时间内完成任何工作。（因为他们必须在下周每隔半小时左右同步一次）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T15:04:11.650

有一个用于该用例的商业工具，称为[Semantic Merge](https://www.semanticmerge.com/)。他们提供 15 天免费试用，开源项目可以免费使用（[联系支持](https://users.semanticmerge.com/Checkout)）。

语义合并背后的公司还有[一个集成了 Sematic Merge 的 git 客户端，](https://gmaster.io/)目前是 beta 版（这里有一些[简短的介绍视频](https://gmaster.io/installer/pc75e0090f5c14ddf8b448d0c1ea4a0b6)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T22:00:51.877

将重命名与其他重构分开。它们通常可以自动化，因此很容易进行更改。您甚至可以分发脚本以允许其他具有合并地狱的工程师对那里的文件执行转换。

自动化重构没有简单的方法，所以保持简单。重命名应该只需要几分钟，您应该能够以最少的测试签出和提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:44:02.730

假设至少 VS 2005 并且全局重命名是变量/属性/函数，则可以使用 Refactor - Rename 右键单击​​菜单选项。按照设计，它会在您的整个解决方案中传播名称更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T16:57:35.990

我理解你的问题。不幸的是，我认为没有足够聪明的 SVN 脚本在同步时完成这项工作。

也许您的团队更恰当地使用 SVN 可能会使这种情况变得不痛苦。当您在工作副本中执行 svn:update 并实现合并操作时，最好在提交更改之前重建更新的解决方案。

确实，拥有一个能够在合并时自动执行此操作的 svn 脚本会很棒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T14:51:56.200

难道不能减少提交更改所需的时间吗？提交之间的一个或多个星期似乎很长......

# .net - 在 C++.net 中将 ref 或指针作为参数传递给托管类型

> ID：135132
> 
> 赞同：0
> 
> 时间：2008-09-25T18:37:54.727
> 
> 标签：.net, c++-cli

我对此感到非常困惑 - 我知道如何在 VB、非托管 C++ 和 C# 中执行此操作，但由于某种原因，我不能接受 C++ 中托管类型的 ref 变量。我敢肯定有一个简单的答案，真的 - 但这是 C# 等价物：

```
myClass.myFunction(ref variableChangedByfunction); 
```

我试过 C++ 指针 - 没有骰子。我试过 ref 关键字。没有骰子。我尝试了`[out]`关键字。没用。

我也找不到任何可以清楚地解释我的问题的文档。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T19:22:38.037

在函数声明中，您需要在参数名称后使用 % ：

bool Importer::GetBodyChunk(String^% BodyText, String^% ChunkText)

然后你照常传入变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T18:38:36.970

使用 ^ 而不是 *

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-17T12:22:53.477

只是为了让它更清楚一点：

引用类型的参数（例如 System::String）必须用`^`较新的 C++/CLI 语法表示。这告诉编译器该参数是一个 GC 对象的句柄。

如果您需要跟踪参考（如使用C#`ref`或`out`在 C# 中），您也需要添加`%`。

这里有一个提示：我经常发现使用[.NET Reflector](http://www.red-gate.com/products/reflector/)查看现有程序集并切换到 C++ 代码样式很有帮助。这可以很好地了解不同 .net 语言之间的互操作性属性的使用。

# networking - 如何发现我的本地子网上是否有其他设备？

> ID：135149
> 
> 赞同：1
> 
> 时间：2008-09-25T18:41:37.573
> 
> 标签：networking

我正在尝试确认用户在执行某些维护之前已将我的嵌入式设备从网络中拔出。我正在考虑“ping”我子网上的所有 IP 地址，但这听起来很粗糙。是否有可能更好的广播/ARP 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:46:36.763

您可以尝试广播 ping（来自 linux）：

```
ping -b 255.255.255.255 
```

另一种选择是下载[Nmap](http://nmap.org/)并进行 ping 扫描。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:47:09.617

你可以使用nmap。它仍然很粗糙，但至少它使用了专门设计的工具，因此您不必花时间在上面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:47:30.427

如果您无法从以太网设备（大多数芯片组现在应该支持，顺便说一句......）获得可靠的链路状态信息，则为本地子网上的每个 IP 发送 ARP 请求是一个不错的替代品。开销是最小的，只要你得到一个响应，你就可以确定你仍然连接到网络。

我在这里看到的唯一可能的问题是，如果您的设备位于 /8 子网上，则可能需要很长时间才能遍历所有 4294967296 个可能的 IP。因此，您可能需要考虑一些优化，例如只为您的默认网关发送 ARP 请求，以及当前在您的 ARP 表中的所有 IP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T18:52:56.517

如果有一个你知道你最近连接的对等体，你可以先尝试 ping 或 arping。这可能会减少您产生的流量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T18:58:10.467

您也可以运行**tcpdump -n**来查看网络上的活动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T22:03:15.730

没有收到任何对 ICMP ping 或 ARP 请求的响应并不能 100% 保证没有网络连接。例如，网络上可能有被防​​火墙关闭的设备。

编辑：也许您可以访问嵌入式设备上的一些较低级别的信息，以检查网络接口是否已链接，而无需实际发送任何数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T22:08:51.333

您的设备是否有可能支持 UPnP 或 Bonjour？除了低级协议之外，您还应该看看这些支持某种即插即用功能的协议。例如，一个 UPnP 设备在关闭之前在 LAN 上发送一条消息（但是，如果它只是通过拔掉它来移除，这将无济于事......）。

# .net - 从字符串末尾删除标签的最佳方法是什么？

> ID：135151
> 
> 赞同：6
> 
> 时间：2008-09-25T18:42:22.733
> 
> 标签：.net, asp.net, xhtml, string

我正在开发的 .NET Web 系统允许最终用户在某些情况下输入 HTML 格式的文本。在其中一些地方，我们希望保留所有标签，但去掉任何尾随的中断标签（但在文本正文中留下任何中断。）

最好的方法是什么？（我可以想办法做到这一点，但我敢肯定它们不是最好的。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T18:53:39.227

正如[@Mitch](https://stackoverflow.com/questions/135151#135161)所说，

```
//  using System.Text.RegularExpressions;

/// <summary>
///  Regular expression built for C# on: Thu, Sep 25, 2008, 02:01:36 PM
///  Using Expresso Version: 2.1.2150, http://www.ultrapico.com
///  
///  A description of the regular expression:
///  
///  Match expression but don't capture it. [\<br\s*/?\>], any number of repetitions
///      \<br\s*/?\>
///          <
///          br
///          Whitespace, any number of repetitions
///          /, zero or one repetitions
///          >
///  End of line or string
///  
///  
/// </summary>
public static Regex regex = new Regex(
    @"(?:\<br\s*/?\>)*$",
    RegexOptions.IgnoreCase
    | RegexOptions.CultureInvariant
    | RegexOptions.IgnorePatternWhitespace
    | RegexOptions.Compiled
    );
regex.Replace(text, string.Empty); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T19:10:57.173

[对bdukes](https://stackoverflow.com/questions/135151/whats-the-best-way-to-remove-br-tags-from-the-end-of-a-string#135216)代码的小改动，应该更快，因为它不会回溯。

```
public static Regex regex = new Regex(
    @"(?:\<br[^>]*\>)*$",
    RegexOptions.IgnoreCase
    | RegexOptions.CultureInvariant
    | RegexOptions.IgnorePatternWhitespace
    | RegexOptions.Compiled
);
regex.Replace(text, string.Empty); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T18:45:43.850

我敢肯定这也不是最好的方法，但除非你有尾随空格或其他东西，否则它应该可以工作。

```
while (myHtmlString.EndsWith("<br>"))
{
    myHtmlString = myHtmlString.SubString(0, myHtmlString.Length - 4);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T19:01:27.947

我试图忽略您原始问题中的歧义，并逐字阅读。这是一个重载 TrimEnd 以获取字符串的扩展方法。

```
static class StringExtensions
{
    public static string TrimEnd(this string s, string remove)
    {
        if (s.EndsWith(remove))
        {
            return s.Substring(0, s.Length - remove.Length);
        }
        return s;
    }
} 
```

这里有一些测试表明它有效：

```
 Debug.Assert("abc".TrimEnd("<br>") == "abc");
        Debug.Assert("abc<br>".TrimEnd("<br>") == "abc");
        Debug.Assert("<br>abc".TrimEnd("<br>") == "<br>abc"); 
```

我想指出，这个解决方案比正则表达式更容易阅读，可能比正则表达式更快（如果你关心性能，你应该使用分析器，而不是推测），并且对于从字符串末尾删除其他内容很有用。

如果您的问题比您说的更普遍（例如，如果您想删除并处理尾随空格或其他什么），则正则表达式变得更`<BR>`合适`</BR>`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T18:44:10.827

您可以使用正则表达式来查找和删除将正则表达式匹配设置为锚点在字符串末尾的文本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T18:58:13.880

您也可以尝试（如果标记可能是有效的树）类似于：

```
string s = "<markup><div>Text</div><br /><br /></markup>";

XmlDocument doc = new XmlDocument();
doc.LoadXml(s);

Console.WriteLine(doc.InnerXml);

XmlElement markup = doc["markup"];
int childCount = markup.ChildNodes.Count;
for (int i = childCount -1; i >= 0; i--)
{
    if (markup.ChildNodes[i].Name.ToLower() == "br")
    {
        markup.RemoveChild(markup.ChildNodes[i]);
    }
    else
    {
        break;
    }
}
Console.WriteLine("---");
Console.WriteLine(markup.InnerXml); 
Console.ReadKey(); 
```

上面的代码有点“便签本”，但是如果您将其剪切并粘贴到控制台应用程序中并运行它，它确实可以工作:=)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:46:50.413

您可以使用 RegEx 或检查尾随字符串是否为中断并将其删除

# windows - 如何从 Excel / VBA 调用长时间运行的外部程序？

> ID：135158
> 
> 赞同：2
> 
> 时间：2008-09-25T18:43:09.783
> 
> 标签：windows, excel, spreadsheet, vba

从excel运行外部程序的最佳方法是什么。它可能会运行几分钟。关于如何做到这一点的最佳实践是什么。理想情况下，

1.  让用户知道进程正在执行的模型对话框。
2.  如果可执行文件失败，用户应该会收到通知。
3.  应该强制执行超时。
4.  对话框上应该有一个取消按钮。

但欢迎任何最佳实践。我对调用 .dll 或 .exe 的解决方案感兴趣。最好是适用于 Excel '03 或更早版本的东西，但我也很想听听迁移到更高版本的理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T01:32:03.950

您应该查看这两篇 Microsoft 知识库文章

[如何从 Visual Basic 启动 Win32 应用程序](http://support.microsoft.com/kb/129797) 和

[如何使用 32 位应用程序来确定外壳进程何时结束](http://support.microsoft.com/kb/129796)

它们都可以快速为您提供启动流程并检查其完成情况的框架。每篇知识库文章都有一些可能相关的附加参考资料。

后一篇知识库文章假定您希望等待无限长的时间让您的 shell 进程结束。

您可以修改 ret& = WaitForSingleObject(proc.hProcess, INFINITE) 函数调用以在有限的时间（以毫秒为单位）后返回 - 将 INFINITE 替换为表示毫秒的正值并将整个事物包装在 Do While 循环中。返回值告诉您进程是否已完成或计时器是否已用完。如果进程结束，返回值将为零。

如果返回值非零，则进程仍在运行，但控制权交还给您的应用程序。在这段时间内，您可以积极控制您的应用程序，您可以确定是否更新某种 UI 状态、检查取消等。或者您可以再次循环并等待更多时间。

如果您要炮轰的程序是您编写的，甚至还有其他选项。您可以连接到其中一个窗口，并让程序发布您可以附加并用作状态反馈的消息。如果您需要考虑，这可能最好留作单独的项目。

您可以使用流程结构从被调用的流程中获取返回值。您的流程确实需要返回一个值才能使用。

我对这种需求的一般方法是：

1.  在流程开始时为用户提供一个非模态状态对话框，并带有一个取消按钮，单击该按钮时将设置一个稍后检查的标志。为用户提供任何状态很可能是不可能的，因此给他们一个经过的时间或其中一个动画 GIF 可能有助于管理期望。
2.  启动流程
3.  等待进程完成，允许每 500ms 进行一次取消检查
4.  如果该过程完成，请关闭对话框并继续。
5.  如果该过程未完成，请查看用户是否点击了取消，如果是，则向该过程的窗口发送关闭消息。这可能不起作用，并且可能需要终止该过程 - 如果您这样做，请小心。如果它不能正确关闭，你最好的选择可能是放弃该过程。您还可以此时检查超时，并尝试采用与用户点击取消相同的路径。

希望这会有所帮助，比尔。

# python - Google App Engine 是 Lifestreaming 应用程序的一个有价值的平台吗？

> ID：135169
> 
> 赞同：7
> 
> 时间：2008-09-25T18:46:15.360
> 
> 标签：python, django, google-app-engine, web-applications

我正在构建一个 Lifestreaming 应用程序，该应用程序将涉及为大量用户提取大量提要，并对结果执行数据挖掘和机器学习算法。GAE 的负载平衡和可扩展托管听起来很适合最终可能会围绕大量数据移动的系统，但它缺少 cron 作业是一件麻烦事。在 co-loc 上使用 Django 并处理我自己的数据库扩展会更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:50:35.367

当他们提供付费计划时它可能会改变，但就目前而言，App Engine 不适合 CPU 密集型应用程序。它旨在扩展以处理大量请求，而不一定是每个请求的大量计算。我用相当小的计算遇到了这个问题，我担心随着数据集的增长，我可能不得不开始寻找其他地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-08T16:03:31.760

虽然我无法直接回答您的问题，但我构建[Microupdater](https://github.com/juvenn/microupdater)（一个在 AppEngine 上收集数百个订阅源的新闻聚合器）的经验可能会给您一些见解。

*   获取提要。通过 cron 作业获取大量提要（这是 SDK 1.2.5 之前的唯一解决方案）效率不高且可扩展，作业频率的限制较低（例如 1 分钟，因此您每小时最多只能获取 60 个提要）。使用最新的 SDK 1.2.5，还有[XMPP API](http://drupal.org/project/xmpp)，我还没有实现。最有前途的方法是[PubSubHubbub](http://code.google.com/p/pubsubhubbub/)，您提供一个回调 url，HubBub 会**实时**通知您新条目。AppEngine 上有一个[演示实现](http://pubsubhubbub.appspot.com/)，您可以尝试一下。

*   解析提要。您可能已经知道解析提要是 CPU 密集型的。我使用Mark Pilgrim 的[Universal Feed Parser](http://www.feedparser.org/)，在解析大型提要（例如公共 google 阅读器主题）时，AppEngine 可能无法处理所有条目。我的仪表板有很多这些 CPU 限制警告。但这可能会导致我无法优化代码。

总而言之，AppEngine 还不是生活流应用程序的理想平台，但未来可能会改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-04T23:45:20.223

（这显然已经很老了，只是因为它在相关的谷歌查询中仍然很高......）

我刚开始使用 AppEngine 并没有将它用于大量的外部请求。但我确实知道上面的信息现在可能不那么有效了，甚至可能不再有效。自 9 月 8 日以来，他们大大放宽了限制 -[查看 Aral Balkan 的博客](http://aralbalkan.com/1975)，了解他对上述情况的最初抱怨以及后来的发展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T13:53:47.807

如果您的应用完全依赖于 Django，那么 App Engine 是一个不错的选择。但是，如果您需要添加 C 增强型库，那您就麻烦了。App Engine 不支持 PIL 或 ReportLab 之类的东西，它们使用 C 来加快处理时间。我之所以提到这一点，是因为从长远来看，您可能希望使用 C 来加速您的一些例程。

如果您决定使用 co-loc，请查看 WebFaction.com。他们有很好的 Django/Python 支持，并且他们对您使用上述库没有任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T05:11:05.580

**看看[Slice Host](http://www.slicehost.com)**：他们以每月 20.00 美元的价格出售基于 xen 的虚拟化服务器实例......

> 我们和你一样。厌倦了超卖、表现不佳、古老的托管公司。我们把事情掌握在自己手中。我们为了解自己的东西的人建立了一家托管公司。给我们一个盒子，给我们带宽，给我们性能，我们开始工作。快速机器、RAID-10 驱动器、Tier-1 带宽和 root 访问。使用定制的 Xen VPS 后端进行管理，以确保您的资源得到保护和保障。

它非常适合在不产生托管提供商或托管成本的情况下启动和扩展项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T18:50:50.187

不。如果你需要做很多事情，App Engine 就不能很好地工作。您可以通过在进行离线预处理后将数据放入他们的存储中来将其用作前端，但是如果不做一些*非常*疯狂的事情，您将无法在每个请求的约 1 秒时间内做太多事情。

您的应用在您自己的主机上可能会更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:54:46.137

提取提要或进行计算不会有问题。但是您很快就必须为您的帐户付款。应用引擎包括 Django，但您需要为模型部分使用一些适配器。它肯定会让您免于维护难题。

# sql - 合并 SQL 表中的联系人而不创建重复条目

> ID：135173
> 
> 赞同：1
> 
> 时间：2008-09-25T18:46:49.743
> 
> 标签：sql, tsql, duplicate-data

我有一个只包含两列的表 - ListID 和 PersonID。当一个人在系统中与另一个人合并时，我要将“源”人的所有引用更新为对“目标”人的引用。

理想情况下，我想调用一些简单的东西

```
UPDATE MailingListSubscription
SET PersonID = @DestPerson
WHERE PersonID = @SourcePerson 
```

但是，如果目标人员已经存在于此表中，并且与源人员具有相同的 ListID，则会创建重复条目。如何在不创建重复条目的情况下执行此操作？（ListID，PersonID为主键）

编辑：使用多个 ListID。如果 SourcePerson 分配给 ListID 1、2 和 3，而 DestinationPerson 分配给 ListID 3 和 4，则最终结果需要有四行 - DestinationPerson 分配给 ListID 1、2、3 和 4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:00:42.003

```
--out with the bad
DELETE
FROM MailingListSubscription
WHERE PersonId = @SourcePerson
  and ListID in (SELECT ListID FROM MailingListSubscription WHERE PersonID = @DestPerson)

--update the rest (good)
UPDATE MailingListSubscription
SET PersonId = @DestPerson
WHERE PersonId = @SourcePerson 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T19:08:39.503

我必须同意大卫 B 的观点。删除所有不应该存在的旧东西，然后进行更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:12:59.260

实际上，我认为你应该回去重新考虑你的数据库设计，因为你真的不应该像你提议的那样更改记录的主键 - 这意味着 PersonID 列实际上不是首先是一个合适的主键。

我的猜测是您的 PersonID 向您的用户公开，他们出于某种原因重新编号了他们的数据库，而您正在同步更改。这通常是一个糟糕的主意，因为它破坏了审计跟踪和时间一致性。在这些情况下，通常最好使用您自己的不变主键 - 通常是一个身份 - 并设置用户看到的 PersonID 作为其属性。这是额外的工作，但从长远来看会给你额外的一致性和稳健性。

一个好的经验法则是尽可能不向用户公开记录的主键，并且您应该在仔细考虑后才这样做。好吧，我承认我自己在很多场合都打破了这一点，但值得在你能做到的地方努力:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T19:52:13.113

首先，您应该将 destperson 订阅到 SourcePerson 订阅的 Destperson 尚未订阅的所有列表。然后删除所有 SourcePersons 订阅。这将适用于多个 ListID。

```
Insert into MailingListSubscription
(
   ListID,
   PersonID
)
Select
   ListID,
   @DestPerson
From
   MailingListSubscription as t1
Where
   PersonID = @SourcePerson and
   Not Exists
   (
      Select *
      From MailingListSubscription as t2
      Where
         PersonID = @DestPerson and
         t1.ListID = t2.ListID
   )

Delete From MailingListSubscription
Where
   PersonID = @SourcePerson 
```

# database - MS Access 数据访问限制

> ID：135183
> 
> 赞同：1
> 
> 时间：2008-09-25T18:48:06.713
> 
> 标签：database, ms-access, ado.net, concurrency, data-access

我现在有一个项目，我希望能够从第 3 方产品用于存储其信息的 Access 数据库中提取行。可能会有少量用户在我的“导出”过程中同时访问这个数据库，所以我有点担心数据完整性和并发访问。

当我的 .NET 导入过程（使用 LINQ/ADO.NET/？）尝试在其他人保存行的同时尝试从 MDB 中提取数据时，我可能会遇到问题吗？Access 的锁定如何工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:55:51.360

应该没有问题。问题只能发生在并发写入操作上。MS Access 的锁定基于 ldb 文件中的文件锁定。锁定仅发生在页面上，而不发生在完整的文件上。因为锁在 ldb 文件而不是 mdb 文件中，所以并行读取没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T19:10:51.167

在之前使用 Access 的工作中（当我使用 2003 时），我遇到的唯一问题是偶尔读取会锁定当前读取上方和下方的行。但是，我相信这可能是我们应用程序的一个孤立问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T18:57:43.570

当您打开数据库时，不要尝试以只读模式打开（尽管您可能认为这是有道理的）。当您是第一个用户时，Access 以只读模式打开 mdb 文件并且不创建 ldb，从而强制所有后续用户也处于只读模式。

# c# - 使用 C# 阅读和发布到网页

> ID：135186
> 
> 赞同：2
> 
> 时间：2008-09-25T18:48:49.613
> 
> 标签：c#, screen-scraping

我有一个工作项目，要求我能够在网页中输入信息，阅读我被重定向到的下一页，然后采取进一步的行动。一个简化的现实世界示例类似于访问 google.com，输入“编码技巧”作为搜索条件，然后阅读结果页面。

[像http://www.csharp-station.com/HowTo/HttpWebFetch.aspx](http://www.csharp-station.com/HowTo/HttpWebFetch.aspx)链接的小编码示例告诉如何阅读网页，但不告诉如何通过将信息提交到表单并继续与它进行交互到下一页。

郑重声明，我不是在构建恶意和/或垃圾邮件相关产品。

那么，我该如何阅读需要先正常浏览几个步骤才能到达的网页呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T19:29:25.523

您可以以编程方式创建 Http 请求并检索响应：

```
 string uri = "http://www.google.com/search";
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";

        // encode the data to POST:
        string postData = "q=searchterm&hl=en";
        byte[] encodedData = new ASCIIEncoding().GetBytes(postData);
        request.ContentLength = encodedData.Length;

        Stream requestStream = request.GetRequestStream();
        requestStream.Write(encodedData, 0, encodedData.Length);

        // send the request and get the response
        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {

            // Do something with the response stream. As an example, we'll
            // stream the response to the console via a 256 character buffer
            using (StreamReader reader = new StreamReader(response.GetResponseStream()))
            {
                Char[] buffer = new Char[256];
                int count = reader.Read(buffer, 0, 256);
                while (count > 0)
                {
                    Console.WriteLine(new String(buffer, 0, count));
                    count = reader.Read(buffer, 0, 256);
                }
            } // reader is disposed here
        } // response is disposed here 
```

当然，此代码将返回错误，因为 Google 使用 GET 而不是 POST 进行搜索查询。

如果您正在处理特定的网页，则此方法将起作用，因为 URL 和 POST 数据基本上都是硬编码的。如果你需要一些更有活力的东西，你必须：

1.  捕获页面
2.  去掉表格
3.  根据表单字段创建 POST 字符串

FWIW，我认为 Perl 或 Python 之类的东西可能更适合这类任务。

编辑：x-www-form-urlencoded

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T21:29:38.650

你可以试试[Selenium](http://selenium.openqa.org/)。使用 Selenium IDE 记录 Firefox 中的操作，以 C# 格式保存脚本，然后使用 Selenium RC C# 包装器播放它们。正如其他人所提到的，您也可以使用[System.Net.HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)或[System.Net.WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)。如果这是一个桌面应用程序，另请参见[System.Windows.Forms.WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)。

附录：类似于基于 Java 的 Selenium IDE 和 Selenium RC，[WatiN 测试记录器](http://watintestrecord.sourceforge.net/)和[WatiN](http://watin.sourceforge.net/)是基于 .NET 的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T18:56:45.367

您需要做的是不断检索和分析链中每个页面的 html 源代码。对于每个页面，您需要弄清楚表单提交的样子，并发送一个与之匹配的请求以获取链中的下一页。

我所做的是构建一个包含 System.Net.HttpWebRequest/HttpWebResponse 的自定义类，因此检索页面就像使用 System.Net.WebClient 一样简单。但是，我的自定义类还在请求中保留了相同的 cookie 容器，这使得发送发布数据、自定义用户代理等变得更容易一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T18:57:34.977

根据网站的工作方式，您可以操纵 url 来执行您想要的操作。例如，要搜索“beatles”这个词，您可以向 google.com?q=beetles 打开一个请求，然后阅读结果。

或者，如果网站不使用查询字符串值 (url) 来处理页面操作，那么您将需要处理一个 webrequest，它将所需的值发布到网站。在 Google 中搜索使用 WebRequest 和 webresponse。

# version-control - IBM i (iSeries) 上的源代码管理

> ID：135188
> 
> 赞同：7
> 
> 时间：2008-09-25T18:49:16.663
> 
> 标签：version-control, ibm-midrange, rpgle

在 Web 端，我们正在努力获得源代码控制。现在，我想看看 iSeries 方面可以做些什么。您最喜欢的 iSeries 源代码控制应用程序是什么？为什么？如果可能的话，我正在寻找低成本的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T21:01:51.617

iSeries 最常见的两个源代码控制包是[Turnover](http://www.softlanding.com/turnover/index.htm)和[Aldon](http://www.aldon.com/products/lmi/)。两者的成本都不低，但与 iSeries 集成得很好。

我更喜欢**营业额**。它完美地处理本地和远程 iSeries 的生产安装。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T20:15:00.953

不要忘记**MKS 实施者**;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T19:26:10.337

如果您在 PC 上使用**WebSphere Development Studio**或**Rational**，那么如果您不想购买原生 iSeries 系统，那么任何可以很好地配合它的源代码控制系统都是一种选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T21:48:15.507

我们将**Aldon**用于我们的 COBOL、CL、DDS 代码，它做得非常好。我不知道它的成本。WebSphere Development Studio 有一个插件。几乎任何源代码控制选项都可以处理源代码的归档/版本控制，但 Aldon 擅长处理从开发到 QA 再到生产环境的编译和部署。例如，它可以为每个库保留不同的库列表，并动态更改它们以在不同环境中编译。如果您的开发和生产环境不在同一个 LPAR 上，它甚至会将代码推送到其他 LPAR。

# javascript - JavaScript 和 JScript 有什么区别？

> ID：135203
> 
> 赞同：123
> 
> 时间：2008-09-25T18:52:02.430
> 
> 标签：javascript, jscript

我一直想知道*到底是什么？！？*是 JScript 和 JavaScript 的区别。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-25T18:55:38.287

真正的 ECMAScript 只是不同的名称。John Resig 有一个[很好的解释](http://ejohn.org/blog/versions-of-javascript/)。

以下是完整版细分：

*   IE 6-7 支持 JScript 5（相当于 ECMAScript 3、JavaScript 1.5）
*   IE 8 支持 JScript 6（相当于 ECMAScript 3、JavaScript 1.5 - 更多错误修复超过 JScript 5）
*   Firefox 1.0 支持 JavaScript 1.5（ECMAScript 3 等效）
*   Firefox 1.5 支持 JavaScript 1.6（1.5 + Array Extras + E4X + misc.）
*   Firefox 2.0 支持 JavaScript 1.7 (1.6 + Generator + Iterators + let + misc.)
*   Firefox 3.0 支持 JavaScript 1.8（1.7 + Generator Expressions + Expression Closures + misc.）
*   Firefox 的下一个版本将支持 JavaScript 1.9（1.8 + 待定）
*   Opera 支持相当于 ECMAScript 3 + Getters and Setters + misc 的语言。
*   Safari 支持相当于 ECMAScript 3 + Getters and Setters + misc 的语言。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-09-25T19:01:04.000

据我所知，有两点：

1.  ActiveXObject 构造函数
2.  成语 f(x) = y，大致等价于 f[x] = y。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-25T18:53:16.203

来自维基百科：[http ://en.wikipedia.org/wiki/Jscript](http://en.wikipedia.org/wiki/Jscript)

> JScript 是 ECMAScript 脚本语言规范的 Microsoft 方言。
> 
> JavaScript（ECMA 规范的 Netscape/Mozilla 实现）、JScript 和 ECMAScript 是非常相似的语言。事实上，“JavaScript”这个名称经常被用来指代 ECMAScript 或 JScript。

Microsoft 使用名称 JScript 来实现它以避免商标问题（[JavaScript](http://en.wikipedia.org/wiki/JavaScript)是[Oracle Corporation](http://tsdr.uspto.gov/#caseNumber=75026640&caseType=SERIAL_NO&searchType=statusSearch)的商标）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T18:53:39.900

JScript 是 Microsoft 对 ECMAScript 规范的实现。JavaScript 是该规范的 Mozilla 实现。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-25T20:18:53.017

Javascript 语言首先来自 Netscape。

微软对 Javascript 进行了逆向工程并将其称为 JScript 以避免与 Sun 的商标问题。（Netscape 和 Sun 当时是合作伙伴，所以这不是问题）

语言是相同的，都是 ECMA 脚本的方言，即事后标准。

尽管语言相同，但由于 JScript 在 Internet Explorer 中运行，它**可以访问**浏览器公开的不同对象（例如 ActiveXObject）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T18:52:54.503

JScript 是 Javascript 的 Microsoft 实现

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-25T18:54:40.613

根据[这篇](http://support.microsoft.com/kb/154585)文章：

*   **JavaScript**是由 Netscape Communications 开发的一种脚本语言，用于开发客户端和服务器 Internet 应用程序。Netscape Navigator 旨在解释嵌入到网页中的 JavaScript。JavaScript 独立于 Sun Microsystem 的 Java 语言。

*   Microsoft **JScript**是 Netscape 的 JavaScript 的开放式实现。JScript 是一种高性能脚本语言，旨在为万维网创建活跃的在线内容。JScript 允许开发人员链接和自动化网页中的各种对象，包括 ActiveX 控件和 Java 程序。Microsoft Internet Explorer 旨在解释嵌入到网页中的 JScript。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-07T21:41:51.133

很久以前，所有浏览器提供商都在为他们的浏览器制作 JavaScript 引擎，只有他们和上帝知道其中发生了什么。美好的一天，ECMA 国际来了，说：让我们根据共同的标准来做引擎，让我们做一些通用的东西，让生活更轻松有趣，他们制定了这个标准。由于所有浏览器提供商都基于 ECMAScript 核心（标准）制作他们的 JavaScript 引擎。

例如，谷歌浏览器使用 V8 引擎，这是开源的。您可以下载它并查看 C++ 程序如何将 JavaScript 的“打印”命令转换为机器代码。

Internet Explorer 在他们的浏览器中使用 JScript (Chakra) 引擎，而其他浏览器也这样做，并且它们都使用通用内核。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-03-04T11:44:38.097

有一些代码差异需要注意。

不支持 subtr 的第一个负参数，例如在 Javascript 中：`"string".substr(-1)`返回“g”，而在 JScript 中：`"string".substr(-1)`返回“string”

可以`"string"[0]`在 Javascript 中获取“s”，但 JScript 不支持这样的构造。（实际上，只有现代浏览器似乎支持该`"string"[0]`构造。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-25T18:55:22.750

维基百科对这些差异有[这样](http://en.wikipedia.org/wiki/JScript#Differences_from_JavaScript)的说法。

一般来说，JScript 是一种 ActiveX 脚本语言，可能会被非 IE 浏览器解释为 JavaScript。

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2016-02-02T12:17:14.323

Jscript 是一种类似于 C# 的 .NET 语言，具有相同的功能并可以访问所有 .NET 功能。

JavaScript 在 ASP Classic 服务器上运行。使用经典 ASP 运行与客户端相同的 JavaScript（不包括 HTML5 功能）。对于我的大部分代码，我只有一组这样的代码。

当我需要经典 ASP 中没有的图像和二进制文件函数（以及许多其他函数）时，我会运行 .ASPX JScript。此代码对于服务器来说是唯一的，但非常强大。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2012-12-28T14:33:49.227

**JScript**是**Microsoft**的**JavaScript**等价物。
Java 是**Oracle**产品，曾经是**Sun**产品。

**甲骨文**收购了**Sun。**

**JavaScript + 微软 = JScript**

# c# - .NET 中 ref 和 out 参数的区别

> ID：135234
> 
> 赞同：410
> 
> 时间：2008-09-25T18:57:27.393
> 
> 标签：c#, .net

.NET中的参数`ref`和参数有什么区别？`out`在哪些情况下一个比另一个更有用？一个可以使用而另一个不能使用的代码片段是什么？

* * *

## 回答 #1

> 赞同：507
> 
> 时间：2008-09-25T19:01:08.757

它们几乎相同 - 唯一的区别是您作为`out`参数传递的变量不需要初始化，而是作为`ref`参数传递它必须设置为某个值。

```
int x;
Foo(out x); // OK

int y;
Foo(ref y); // Error: y should be initialized before calling the method 
```

`Ref`参数用于可能被修改`out`的数据，参数用于作为函数（例如）的附加输出的数据，这些数据`int.TryParse`已经在使用返回值。

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2008-09-25T19:01:32.437

[为什么 C# 既有 'ref' 又有 'out'？](http://evacion.wordpress.com/2009/08/12/why-does-c-have-both-ref-and-out/)

带有 out 参数的方法的调用者不需要在调用之前分配作为 out 参数传递的变量；但是，被调用者需要在返回之前分配给 out 参数。

相比之下，ref 参数被认为是由调用者最初分配的。因此，被调用者不需要在使用前分配给 ref 参数。Ref 参数传入和传出方法。

所以，`out`意味着out，while`ref`是in和out。

`[out]`这些与 COM 接口的和参数密切对应，`[in,out]`参数的优点`out`是调用者不需要传递预先分配的对象，在被调用的方法不需要的情况下 - 这既避免了分配成本，又避免了任何成本这可能与封送处理相关联（更可能与 COM 相关，但在 .NET 中并不少见）。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2008-09-25T19:22:27.410

`ref`并且`out`都允许被调用的方法修改参数。它们之间的区别在于您拨打电话*之前会发生什么。*

*   `ref`表示参数在进入函数**之前有一个值。**被调用的函数可以随时读取和/或更改值。*参数进去，然后出来*

*   `out`表示参数在进入函数之前没有正式的值。被调用的函数必须对其进行初始化。*参数只出去*

这是我最喜欢的看待它的方式：`ref`通过引用传递变量。`out`是为函数声明一个辅助**返回值**。就像你可以这样写：

```
// This is not C#
public (bool, string) GetWebThing(string name, ref Buffer paramBuffer);

// This is C#
public bool GetWebThing(string name, ref Buffer paramBuffer, out string actualUrl); 
```

以下是每种替代方案效果的更详细列表：

### 在调用方法之前：

`ref`：调用者必须在将参数传递给被调用方法之前设置参数的值。

`out`：调用者方法不需要在调用方法之前设置参数的值。很可能，你不应该。事实上，任何当前值都会被丢弃。

### 通话期间：

`ref`：被调用的方法可以随时读取参数。

`out`：被调用的方法必须在读取参数之前对其进行初始化。

### 远程通话：

`ref`：当前值被编组到远程调用。额外的性能成本。

`out`: 没有任何东西传递给远程调用。快点。

从技术上讲，您可以使用 always`ref`代替`out`，但`out`可以让您更准确地了解参数的含义，有时它可以更有效。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-11-13T03:22:25.367

OUT 示例：变量在进入方法后获取值初始化。稍后将相同的值返回给 main 方法。

```
namespace outreftry
{
    class outref
    {
        static void Main(string[] args)
        {
            yyy a = new yyy(); ;

            // u can try giving int i=100 but is useless as that value is not passed into
            // the method. Only variable goes into the method and gets changed its
            // value and comes out. 
            int i; 

            a.abc(out i);

            System.Console.WriteLine(i);
        }
    }
    class yyy
    {

        public void abc(out int i)
        {

            i = 10;

        }

    }
} 
```

> 输出：
> 
> 10

================================================

Ref 的示例：变量应该在进入方法之前被初始化。稍后相同的值或修改后的值将返回给 main 方法。

```
namespace outreftry
{
    class outref
    {
        static void Main(string[] args)
        {
            yyy a = new yyy(); ;

            int i = 0;

            a.abc(ref i);

            System.Console.WriteLine(i);
        }
    }
    class yyy
    {

        public void abc(ref int i)
        {
            System.Console.WriteLine(i);
            i = 10;

        }

    }
} 
```

> 输出：
> 
> ```
>  0
>     10 
> ```

==================================

希望现在清楚。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-06-08T20:00:51.737

*   变量需要`ref`在传入之前进行初始化。
*   `out`需要在函数实现中设置一个变量
*   `out`参数可以被认为是附加的返回变量（不是输入）
*   `ref`参数可以被认为是输入和输出变量。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-10-16T12:23:17.007

## 参考和输出参数：

和参数用于返回作为方法参数传递的同一变量中的值`out`。`ref`当您的方法需要返回多个值时，这两个参数都非常有用。

您必须为 calee 方法体中的 out 参数赋值，否则该方法将无法编译。

* * *

> **参考参数：**它必须在传递给方法之前进行初始化。方法参数上的`ref`关键字导致方法引用作为同一方法的输入参数传递的同一变量。如果您对变量进行任何更改，它们将反映在变量中。
> 
> ```
> int sampleData = 0; 
> sampleMethod(ref sampleData); 
> ```

***Ex of Ref 参数***

```
public static void Main() 
{ 
 int i = 3; // Variable need to be initialized 
 sampleMethod(ref i );  
}

public static void sampleMethod(ref int sampleData) 
{ 
 sampleData++; 
} 
```

* * *

> **Out Parameter :**在传递给 Method 之前不需要初始化。该`out`参数可用于返回作为方法参数传递的同一变量中的值。对参数所做的任何更改都将反映在变量中。
> 
> ```
>  int sampleData; 
>  sampleMethod(out sampleData); 
> ```

***Ex of Out 参数***

```
public static void Main() 
{ 
 int i, j; // Variable need not be initialized 
 sampleMethod(out i, out j); 
} 
public static int sampleMethod(out int sampleData1, out int sampleData2) 
{ 
 sampleData1 = 10; 
 sampleData2 = 20; 
 return 0; 
} 
```

* * *

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-04-01T18:37:45.783

## 出去：

在 C# 中，一个方法只能返回一个值。如果要返回多个值，可以使用 out 关键字。out 修饰符作为返回引用返回。最简单的答案是关键字“out”用于从方法中获取值。

*   您不需要在调用函数中初始化值。
*   必须在被调用函数中赋值，否则编译器会报错。

## 参考：

在 C# 中，当您将 int、float、double 等值类型作为参数传递给方法参数时，它是按值传递的。因此，如果修改参数值，不会影响方法调用中的参数。但是如果你用“ref”关键字标记参数，它会反映在实际变量中。

*   您需要在调用函数之前初始化变量。
*   不必为方法中的 ref 参数分配任何值。如果不改变值，有什么必要将其标记为“ref”？

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-25T18:59:18.137

ref 参数不需要在函数中设置，而 out 参数必须在退出函数之前绑定到一个值。作为 out 传递的变量也可以在没有初始化的情况下传递给函数。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-06-08T20:01:45.907

`out`指定参数是一个输出参数，即在方法明确设置之前它没有值。

`ref`指定该值是具有值的引用，并且您可以在方法内更改其值。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T19:00:59.367

`out`参数由被`ref`调用的方法初始化，参数在调用方法之前被初始化。因此，`out`当您只需要获取次要返回值时使用参数，`ref`参数用于获取值*并*可能返回对该值的更改（次要到主返回值）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-25T19:02:16.290

ref 关键字用于通过引用传递值。（这并不排除传递的值是值类型或引用类型）。用 out 关键字指定的输出参数用于从方法返回值。

代码中的一个关键区别是您必须在方法中设置输出参数的值。这不是 ref 参数的情况。

有关更多详细信息，请查看[http://www.blackwasp.co.uk/CSharpMethodParameters.aspx](http://www.blackwasp.co.uk/CSharpMethodParameters.aspx)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-01T23:41:14.373

`out`参数是添加`ref`了特殊`Out()`属性的参数。如果 C# 方法的参数声明为`out`，编译器将要求在读取参数之前和方法返回之前写入参数。如果 C# 调用其参数包含`Out()`属性的方法，编译器将出于决定是否报告“未定义变量”错误的目的，假装该变量是在调用该方法之前立即写入的。请注意，由于其他 .net 语言没有为`Out()`属性附加相同的含义，因此调用带有`out`参数的例程可能会使相关变量不受影响。如果一个变量被用作`out`在明确分配参数之前，C# 编译器会生成代码以确保在使用之前的某个时间点将其清除，但如果这样的变量离开并重新进入作用域，则无法保证它会再次被清除。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T18:58:51.213

ref 可能会因 null 而窒息，因为它可能希望修改现有对象。out 期望 null，因为它返回一个新对象。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T19:02:59.503

这个*[C# 中的 out 和 ref 参数](http://www.c-sharpcorner.com/UploadFile/mahesh/out_and_ref11112005002102AM/out_and_ref.aspx)*有一些很好的例子。

概述的基本区别是`out`参数在传入时不需要初始化，而 ref 参数则需要。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-25T19:05:18.873

out 和 ref 完全相同，只是 out 变量在发送到深渊之前不必初始化。我没那么聪明，我是从 MSDN 库中抄来的 :)。

然而，为了更明确地说明它们的使用，修饰符的含义是，如果您在代码中更改该变量的引用，out 和 ref 将导致您的调用变量也更改引用。在下面的代码中，一旦从对 doStuff 的调用返回，ceo 变量将成为对 newGuy 的引用。如果不是用于 ref （或 out），则不会更改参考。

```
private void newEmployee()
{
    Person ceo = Person.FindCEO();
    doStuff(ref ceo);
}

private void doStuff(ref Person employee)
{
    Person newGuy = new Person();
    employee = newGuy;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-01T15:45:25.940

它们有细微的不同。

参数在`out`传递给方法之前不需要由被调用者初始化。因此，任何带`out`参数的方法

*   在为其赋值之前无法读取参数
*   在返回之前必须为其赋值

这用于需要覆盖其参数而不考虑其先前值的方法。

* * *

在将`ref`参数传递给方法之前，必须由被调用者初始化参数。因此，任何带`ref`参数的方法

*   可以在分配之前检查值
*   可以返回原值，原封不动

这用于必须（例如）检查其值并对其进行验证或规范化的方法。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-17T16:11:50.587

out 在 C#7 中获得了更简洁的新语法 [https://docs.microsoft.com/en-us/dotnet/articles/csharp/whats-new/csharp-7#more-expression-bodied-members](https://docs.microsoft.com/en-us/dotnet/articles/csharp/whats-new/csharp-7#more-expression-bodied-members) 甚至更多令人兴奋的是 C#7 元组增强，这是一个比使用 ref 和 out 恕我直言更优雅的选择。

# c# - （非 SOAP、非 WSDL）Web 服务项目的最佳 ASP.NET 文件类型是什么？

> ID：135243
> 
> 赞同：0
> 
> 时间：2008-09-25T18:59:08.340
> 
> 标签：c#, asp.net, web-services

自 VS 2003 以来没有做过 ASP.NET 开发，所以我想节省一些时间并从其他人的错误中吸取教训。

编写 Web 服务应用程序，但不是 WSDL/SOAP/等。-- 更像是 REST + XML。

如果我想通过相同的 URI 分别处理不同的 HTTP 动词，那么许多“新项目”选项（Web 窗体、通用处理程序、ASP.NET 处理程序等）中的哪一个最有意义。在一个完美的世界中，我希望在代码中以声明方式而不是通过 web.config 进行调度——但如果我这样让生活变得太艰难，我愿意改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:00:29.150

如果您不使用内置 Web 服务 ( *.asmx)，那么您可能应该使用通用处理程序 (* .ashx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:30:24.537

这是我一直在玩的一个想法......使用风险自负，代码在我的“沙盒”文件夹中；）

我想我想摆脱使用反射来确定运行哪个方法，使用 HttpVerb 作为键在字典中注册委托可能会更快。无论如何，此代码不提供任何保证，等等，等等，等等……

用于 REST 服务的动词

```
public enum HttpVerb
{
    GET, POST, PUT, DELETE
} 
```

用于标记服务方法的属性

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple=false, Inherited=false)]
public class RestMethodAttribute: Attribute
{
    private HttpVerb _verb;

    public RestMethodAttribute(HttpVerb verb)
    {
        _verb = verb;
    }

    public HttpVerb Verb
    {
        get { return _verb; }
    }
} 
```

休息服务的基类

```
public class RestService: IHttpHandler
{
    private readonly bool _isReusable = true;
    protected HttpContext _context;
    private IDictionary<HttpVerb, MethodInfo> _methods;

    public void ProcessRequest(HttpContext context)
    {
        _context = context;

        HttpVerb verb = (HttpVerb)Enum.Parse(typeof (HttpVerb), context.Request.HttpMethod);

        MethodInfo method = Methods[verb];

        method.Invoke(this, null);
    }

    private IDictionary<HttpVerb, MethodInfo> Methods
    {
        get
        {
            if(_methods == null)
            {
                 _methods = new Dictionary<HttpVerb, MethodInfo>();
                BuildMethodsMap();
            }
            return _methods;
        }
    }

    private void BuildMethodsMap()
    {
        Type serviceType = this.GetType();
        MethodInfo[] methods = serviceType.GetMethods(BindingFlags.Instance | BindingFlags.DeclaredOnly | BindingFlags.Public);

        foreach (MethodInfo info in methods)
        {
            RestMethodAttribute[] attribs =
                info.GetCustomAttributes(typeof(RestMethodAttribute), false) as RestMethodAttribute[];
            if(attribs == null || attribs.Length == 0)
                continue;

            HttpVerb verb = attribs[0].Verb;

            Methods.Add(verb, info);
        }

    }

    public bool IsReusable
    {
        get { return _isReusable; }
    }
} 
```

示例 REST 服务

```
public class MyRestService: RestService
{
    [RestMethod(HttpVerb.GET)]
    public void HelloWorld()
    {
        _context.Current.Response.Write("Hello World");
        _context.Current.Response.End();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:01:45.450

如果您需要休息，可能是 MVC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T19:18:18.437

我同意 ashx，给你最大的控制权。您还可以更复杂并创建自定义 Http 处理程序。这样你就可以拦截你决定的任何扩展。当然，您可以添加一个 Http 模块并将任何请求重写为通用 ashx 处理程序。

# python - 在 64 位系统上读取 32 位打包二进制数据

> ID：135246
> 
> 赞同：2
> 
> 时间：2008-09-25T18:59:41.990
> 
> 标签：python, c, 64-bit

我正在尝试编写一个 Python C 扩展来读取打包的二进制数据（它存储为结构的结构），然后将其解析为 Python 对象。在 32 位机器上一切正常（二进制文件总是写在 32 位架构上），但不是在 64 位机器上。有这样做的“首选”方式吗？

* * *

要发布很多代码，但作为示例：

```
struct
{
    WORD    version;
    BOOL    upgrade;
    time_t  time1;
            time_t  time2;
} apparms;

File *fp;
fp = fopen(filePath, "r+b");
fread(&apparms, sizeof(apparms), 1, fp);
return Py_BuildValue("{s:i,s:l,s:l}",
  "sysVersion",apparms.version,
  "powerFailTime", apparms.time1,
  "normKitExpDate", apparms.time2
 ); 
```

现在在 32 位系统上这很好用，但在 64 位上，我的 time_t 大小不同（32 位与 64 位长）。

* * *

该死的，你们这些人速度很快。

帕特里克，我最初开始使用 struct 包，但发现它只是为了满足我的需要而减慢速度。另外，我正在寻找编写 Python 扩展的借口。

我知道这是一个愚蠢的问题，但我需要注意哪些类型？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:07:22.487

明确指定您的数据类型（例如整数）是 32 位的。否则，如果您在读取它们时有两个相邻的整数，它们将被读取为一个 64 位整数。

当您处理跨平台问题时，需要注意的两个主要事项是：

1.  位。如果您的打包数据是用 32 位整数写入的，那么您的所有代码在读写时都必须明确指定 32 位*整数*。
2.  字节顺序。如果您将代码从 Intel 芯片移动到 PPC 或 SPARC，您的字节顺序将是错误的。您必须导入数据，然后对其进行字节翻转，以使其与当前架构相匹配。否则 12 ( `0x0000000C`) 将被读取为 201326592 ( `0x0C000000`)。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T19:03:02.777

'struct' 模块应该能够做到这一点，尽管数据中间的结构对齐总是一个问题。但是，要做到这一点并不难：找出（一次）structs-in-structs 对齐的边界，然后填充（手动，使用“x”说明符）到该边界。您可以通过将 struct.calcsize() 与您的实际数据进行比较来仔细检查您的填充。这肯定比为其编写 C 扩展更容易。

为了像这样继续使用 Py_BuildValue()，您有两个选择。您可以在编译时确定 time_t 的大小（就基本类型而言，即“an int”或“a long”或“an ssize_t”），然后对 Py_BuildValue 使用正确的格式字符——“i”表示 int， 'l' 表示长，'n' 表示 ssize_t。或者您可以手动使用 PyInt_FromSsize_t()，在这种情况下，编译器会为您进行向上转换，然后使用“O”格式字符将结果传递给 Py_BuildValue。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T19:15:52.700

您需要确保为您的结构使用与体系结构无关的成员。例如，一个 int 在一种架构上可能是 32 位，而在另一种架构上可能是 64 位。正如其他人所建议的那样，请改用`int32_t`样式类型。如果您的结构包含未对齐的成员，您可能还需要处理编译器添加的填充。

跨架构数据的另一个常见问题是字节序。Intel i386 架构是little-endian，但如果您在完全不同的机器（例如Alpha 或Sparc）上阅读，您也必须担心这一点。

Python struct 模块使用作为格式字符串的一部分传递的前缀来处理这两种情况。

*   @ - 使用原生大小、字节序和对齐方式。i= sizeof(int), l= sizeof(long)
*   = - 使用原生字节序，但标准大小和对齐方式（i=32 位，l=64 位）
*   < - Little-endian 标准尺寸/对齐方式
*   > *   Big-endian 标准尺寸/对齐方式

一般来说，如果数据从你的机器上传递过来，你应该将字节顺序和大小/填充格式确定为特定的东西——即。使用“<”或“>”作为您的格式。如果你想在你的 C 扩展中处理这个，你可能需要添加一些代码来处理它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T19:02:00.940

你读取二进制数据的代码是什么？确保将数据复制到适当大小的类型中，例如`int32_t`而不是`int`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T19:02:20.550

你为什么不使用[struct](http://docs.python.org/lib/module-struct.html)包？

# c# - 如何操作滚动条上的 LargeChange 和 SmallChange 工作

> ID：135254
> 
> 赞同：0
> 
> 时间：2008-09-25T19:00:47.010
> 
> 标签：c#, scrollbar

我在 C# 应用程序的一个窗口中有多个面板，我创建了 2 个滚动条，一个用于水平滚动条，一个用于垂直滚动条。这是我目前拥有的：

[带有 2 个滚动条的图片 http://www.simnet.is/elinnils52/scrollbar.jpg](http://www.simnet.is/elinnils52/scrollbar.jpg)

我有 1 个变量，这是所有物品需要和需要的总高度。这是我关于滚动更改的代码：

```
for (int i = 0; i < this._splitMainView.Panel2.Controls.Count; i++)
{
    this._splitMainView.Panel2.Controls[i].Location = new Point(
        3 - _scrollBarX.Value, 
        3 + (132 + 6) * (i - 2) - _scrollBarY.Value);
    this._splitMainView.Panel2.Controls[i].Refresh();
} 
```

滚动条最大值是所有容器高度的总和，中间的空间和额外的几个像素。

从图片中可以看出，它看起来并不好。即使在这种情况下最大值是 50 - 100 像素左右，它看起来仍然像一千页长。当我更改 SmallChange 和 LargeChange 时，滚动条本身会变长，但不会达到最大像素。它将能够几乎在最后（取决于 SmallChange 和 LargeChange 值）并留下大约 5 - 29 px。而且众所周知，见一半不好。

有谁知道如何克服这个障碍或更好的方法来实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T23:35:47.627

为什么不让滚动条的最大值溢出（可见区域高度 - 面板高度）？然后只需将面板顶部设置为滚动条的值 * -1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:13:53.643

有理由不使用 AutoScroll 属性吗？

# c - 如何通过良好的设计保留堆栈空间？

> ID：135262
> 
> 赞同：12
> 
> 时间：2008-09-25T19:01:32.173
> 
> 标签：c, memory, embedded, stack, rtos

我正在用 C 语言为带有 RTOS 的 RAM 受限嵌入式微控制器编程。

我经常将我的代码分解为短函数，但每个函数调用都需要更多的堆栈内存。每个任务都需要他的堆栈，这是项目中重要的内存消耗者之一。

是否有替代方法可以使代码保持良好的组织性和可读性，同时保留内存？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T19:05:28.920

尝试使调用堆栈更平坦，而不是`a()`调用`b()`which calls `c()`which calls `d()`， have `a()`call `b()`,`c()`和`d()`它本身。

如果一个函数只被引用一次，标记它`inline`（假设你的编译器支持这个）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-27T14:14:04.787

您的堆栈使用有 3 个组件：

*   函数调用返回地址
*   函数调用参数
*   自动（局部）变量

最小化堆栈使用的关键是最小化参数传递和自动变量。实际函数调用本身的空间消耗相当小。

**参数**

解决参数问题的一种方法是传递结构（通过指针）而不是大量参数。

```
 foo(int a, int b, int c, int d)
{
...
   bar(int a, int b);
} 
```

改为这样做：

```
 struct my_params {
   int a;
   int b;
   int c;
   int d;
};
foo(struct my_params* p)
{
   ...
   bar(p);
}; 
```

如果您传递大量参数，则此策略很好。如果参数都不同，那么它可能不适合您。您最终会得到一个包含许多不同参数的大型结构。

**自动变量（局部变量）**

这往往是堆栈空间的最大消耗者。

*   数组是杀手。不要在本地函数中定义数组！
*   尽量减少局部变量的数量。
*   使用必要的最小类型。
*   如果重入不是问题，您可以使用模块静态变量。

请记住，如果您只是将所有局部变量从局部范围移动到模块范围，您并没有节省任何空间。您用堆栈空间换取了数据段空间。

一些 RTOS 支持线程本地存储，它在每个线程的基础上分配“全局”存储。这可能允许您在每个任务的基础上拥有多个独立的全局变量，但这会使您的代码不那么简单。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T19:10:30.780

如果您可以节省大量主内存但只有一小部分堆栈，我建议评估静态分配。

在 C 中，函数内声明的所有变量都是“自动管理的”，这意味着它们是在堆栈上分配的。

将声明限定为“静态”将它们存储在主内存中而不是堆栈中。它们基本上表现得像全局变量，但仍然允许您避免过度使用全局变量带来的坏习惯。您可以为将大的、长期存在的缓冲区/变量声明为静态的，以减少堆栈压力。

请注意，如果您的应用程序是多线程的或使用递归，这将无法正常工作/根本无法正常工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-25T19:04:08.533

打开优化，特别是激进的内联。编译器应该能够内联方法以最小化调用。根据您使用的编译器和优化开关，将某些方法标记为`inline`可能有帮助（或者可能会被忽略）。

使用 GCC，尝试添加“-finline-functions”（或 -O3）标志和可能的“-finline-limit=n”标志。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T11:59:07.173

为了评估嵌入式设置中代码的堆栈要求，我在某处读到的一个技巧是在开始时用已知模式填充堆栈空间（十六进制的 DEAD 是我最喜欢的）并让系统运行一段时间。

正常运行后，读取堆栈空间，看看在运行过程中有多少堆栈空间没有被替换。设计为至少保留 150% 的空间，以解决所有可能未执行的模糊代码路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T20:05:57.337

你可以用全局变量替换一些局部变量吗？特别是数组可以吃掉堆栈。

如果情况允许您在函数之间的某些全局变量之间共享一些全局变量，那么您就有可能减少内存占用。

权衡成本是增加了复杂性，以及功能之间不必要的副作用的更大风险与可能更小的内存占用空间。

您的函数中有哪些类型的变量？我们在谈论什么尺寸和限制？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T07:50:45.223

根据您的编译器以及您的优化选项的积极程度，您将在每次调用函数时使用堆栈。因此，首先您可能需要限制函数调用的深度。一些编译器确实对简单的函数使用跳转而不是分支，这将减少堆栈的使用。显然，您可以通过使用汇编程序宏来跳转到您的函数而不是直接函数调用来做同样的事情。

正如其他答案中提到的，内联是一种可用的选项，尽管这确实是以更大的代码大小为代价的。

吃堆栈的另一个区域是本地参数。您确实可以控制这个区域。使用（文件级）静态将避免以静态内存分配为代价的堆栈分配。全球人也一样。

在（真正的）极端情况下，您可以为使用固定数量的全局变量作为临时存储来代替堆栈上的局部变量的函数提出约定。棘手的一点是确保不会同时调用任何使用相同全局变量的函数。（因此公约）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T19:54:04.923

如果您需要开始保留堆栈空间，您应该获得更好的编译器或更多内存。

您的软件通常会增长（新功能，...），因此如果您必须通过考虑如何保留堆栈空间来启动项目，那么它从一开始就注定要失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-14T01:01:47.157

是的，RTOS 确实会占用 RAM 以供任务堆栈使用。我的经验是，作为 RTOS 的新用户，往往会使用不必要的任务。

对于使用 RTOS 的嵌入式系统，RAM 可能是一种珍贵的商品。为了保留 RAM，对于简单的功能，在一个任务中实现多个功能仍然是有效的，以循环方式运行，并采用协作多任务设计。从而减少任务总数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-14T01:55:58.813

我想你可能在想象一个这里不存在的问题。大多数编译器在堆栈上“分配”自动变量时实际上并没有做任何事情。

在执行“main()”之前分配堆栈。当您从函数 a() 调用函数 b() 时，紧接 a 使用的最后一个变量之后的存储区地址将传递给 b()。如果 b() 然后调用函数 c() 然后 c 的堆栈在 b() 定义的最后一个自动变量之后开始，这将成为 b() 的堆栈的开始。

请注意，堆栈内存已经存在并已分配，没有进行初始化，唯一涉及的处理是传递堆栈指针。

这成为问题的唯一一次是所有三个函数都使用大量存储空间，然后堆栈必须容纳所有三个函数的内存。尝试将分配大量存储的函数保留在调用堆栈的底部，即不要从它们调用另一个函数。

内存约束系统的另一个技巧是将函数的内存占用部分拆分为单独的自包含函数。

# asp.net - 我可以在同一个网站上运行 ASP.NET 2.0 和 3.5 代码吗？

> ID：135269
> 
> 赞同：9
> 
> 时间：2008-09-25T19:02:10.457
> 
> 标签：asp.net

我可以在同一个网站上运行 ASP.NET 2.0 和 3.5 代码吗？...或者，我是否需要按应用程序和/或服务器将它们分开？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-25T19:05:36.237

.NET 3.5 是带有一些额外库的 2.0。所以答案是肯定的，你可以在同一个网站上运行它们。事实上，您甚至无法将 Web 应用程序设置为在 3.5 下运行。它仅在 2.0 下运行。您可以检查 IIS 站点属性中的 ASP.NET 选项卡，看看甚至没有选项可以在 3.5 下运行您的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T19:04:15.020

只要您的服务器运行的是 3.5，您就可以同时运行这两个版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T19:51:54.033

就 IIS 而言，3.5 和 2.0 是一样的。您需要注意的是不要在同一个应用程序池中混合 1.1 和 2.0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T19:04:11.417

是的，你可以毫无问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T19:05:22.977

.Net 3.5 是 .Net 2.0 框架的扩展。升级到 .Net 3.5 框架后，您可以运行使用所有 .Net 2.0/3.0 和 3.5 框架的应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T19:08:26.197

您可以在同一台服务器上运行 .NET 2.0 和 .NET 3.5 中的代码，但每个框架版本必须至少有一个应用程序池。您唯一需要注意的是不要在同一个池中混合使用 2.0 应用程序和 3.5 应用程序。

基本原理：每个进程只能加载一个框架，每个应用程序都会产生自己的进程

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T19:31:04.847

ASP.NET 3.5 仍在 .NET 2.0 CLR 上运行，如果您进入 IIS，您会发现只能选择 2.0 或 1.1

所以答案是，是的……ASP.NET 3.5 基本上只是 GAC 中的额外程序集。

.NET 3.5 只是对编译器本身和库的修改，而不是 CLR。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T19:11:24.787

只要安装了 .NET 3.5，您就可以同时运行它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T19:56:48.857

我只需将所有代码转换为 3.5，如果您在盒子上安装了 3.5，它应该可以完美运行。

另外请注意，VS 2008 实现了多目标，并且 3.5 中的许多新功能实际上是编译器的功能，而不是框架本身。因此，您可以针对 2.0 框架并仍然获得 3.5 的许多新功能。

# javascript - 任何应用程序（chrome、flash 等）如何获得比系统时间分辨率更好的时间分辨率？

> ID：135274
> 
> 赞同：1
> 
> 时间：2008-09-25T19:02:50.877
> 
> 标签：javascript, flash, google-chrome, timer

Microsoft 技术网站上的这篇文章提供了一个`exe`计算 Windows 机器的最小时间分辨率的文章——这应该是该机器上任何应用程序可用的最小“滴答”：

[http://technet.microsoft.com/en-us/sysinternals/bb897568.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897568.aspx)

在我当前的机器上运行这个应用程序的结果是 15.625 毫秒。我还对 Internet Explorer 进行了测试，并从 Date() javascript 函数中获得了完全相同的分辨率。

令人困惑的是，我针对 IE 运行的 SAME 测试为 Google 的 Chrome 浏览器（分辨率为 1 毫秒）和在 IE 中运行的 Flash 电影（1 毫秒）提供了更精细的分辨率。谁能解释任何应用程序如何获得比机器时钟更好的时钟分辨率？如果是这样，有什么方法可以在 Chrome 以外的浏览器中获得始终如一的更好分辨率（不使用闪存）？

下面的第一个答案引出了另外两个问题：

1.  多媒体计时器如何获得系统时钟滴答之间的时间。我把系统时钟想象成一个指针滴答作响的模拟手表，每个滴答声为 15 毫秒。如何测量刻度之间的时间？
2.  浏览器是否可以使用多媒体计时器，尤其是 Internet Explorer？我可以使用 C# 或 Javascript 访问一个，而无需将软件推送到用户的浏览器/机器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:05:30.947

您可以使用[多媒体计时器](http://msdn.microsoft.com/en-us/library/ms712704(VS.85).aspx)将时间缩短到 1 毫秒，使用 QueryPerformanceCounter 甚至可以进一步缩短。

另请参见[GetLocalTime() API 时间分辨率](https://stackoverflow.com/questions/49668/getlocaltime-api-time-resolution#49720)。

编辑：对新子问题的部分回答......

在 Windows 3 和 95 架构上，系统时间分辨率约为 15 毫秒。在 NT（和后续产品）上，您可以从硬件抽象层 (HAL) 获得更好的分辨率。Raymond Chen 撰写的[QueryPerformanceCounter 计算的是经过的时间，而不是 CPU 周期](http://blogs.msdn.com/oldnewthing/archive/2008/09/08/8931563.aspx)文章，可能会给您一些额外的见解。

至于浏览器 - 我不知道它们用于计时器以及它们如何与操作系统交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:37:06.207

查看 timeBeginPeriod API。来自 MSDN：“此功能会影响全局 Windows 设置。Windows 使用任何进程请求的最低值（即最高分辨率）。”

[http://msdn.microsoft.com/en-us/library/ms713413(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms713413(VS.85).aspx)

（Markdown 不喜欢 URL 中的括号）

请参阅您发布的链接中引用的“Windows NT 高分辨率计时器内部”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:22:50.297

处理器上的[APIC](http://en.wikipedia.org/wiki/Intel_APIC_Architecture)以总线速度运行并有一个定时器。他们可能正在使用它而不是系统时间。（或者他们可能只是给出了一堆不存在的精确度。）

[本地 APIC 的](http://osdev.berlios.de/pic.html)此描述提到将其用作计时器。

（也可能是他们正在使用一些性能计数器。这实际上似乎更有可能，因为需要设备驱动程序来对 APIC 进行编程。）

# windows - 如何以编程方式将 COM51 等名称关联到 Microsoft Windows 中的物理串行端口？

> ID：135287
> 
> 赞同：2
> 
> 时间：2008-09-25T19:04:23.383
> 
> 标签：windows, serial-port

如何以编程方式将 COM51 等名称关联到 Microsoft Windows 中的物理串行端口？

要手动执行操作，我可以按照
[链接文本中描述的步骤进行操作](http://technet.microsoft.com/en-us/library/cc754755.aspx "http://technet.microsoft.com/en-us/library/cc754755.aspx")

使用 devmgmt.msc 打开设备管理器

双击端口（COM 和 LPT）。

右键单击我想要的端口，然后单击“属性”。

在端口设置选项卡上，如果我想更改 COM 端口号（例如，从 COM1 到 COM51），我单击高级按钮，然后从列表中选择我需要的 COM 端口号。

但是，我怎样才能用程序来完成这项工作呢？是否有 API 来完成这项工作？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:09:50.843

我不知道任何 API 来实现这一点，但您可以在 HKLM\Hardware\DEVICEMAP\SERIALCOMM 下编辑注册表值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T06:40:39.600

ComDBClaimPort [http://msdn.microsoft.com/en-us/library/ms800845.aspx](http://msdn.microsoft.com/en-us/library/ms800845.aspx)

但这只是工作的一部分。

# msvcrt - Windows 下的 MSVCRT 是否像 *nix 下的 glibc (libc)？

> ID：135296
> 
> 赞同：28
> 
> 时间：2008-09-25T19:05:32.927
> 
> 标签：msvcrt, libc

我经常遇到与程序可执行文件捆绑在 MSVCRT（或它们更当前的等价物）中的 Windows 程序。在典型的 PC 上，我会找到许多相同 .DLL 的副本。我的理解是 MSVCRT 是 C 运行时库，有点类似于 *nix 下的 glibc/libc.so。

为什么 Windows 程序必须随身携带他们的 C 库，而不仅仅是共享系统范围的 libc？

* * *

更新：感谢 Shog9，我开始阅读有关 SxS 的文章，这进一步让我看到了 DLL 链接问题（DLL Hell） - [http://blogs.msdn.com/b/martynl/archive/2005/10/ 13/480880.aspx](http://blogs.msdn.com/b/martynl/archive/2005/10/13/480880.aspx)是该问题的一个有用介绍...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T07:17:51.337

[我是微软 Native SxS 技术的当前维护者]

新版本的 MSVCRT 与新版本的 Visual Studio 一起发布，并反映了对 C++ 工具集的更改。因此，使用特定版本的 Windows 继续发布后发布的 VS 版本编译的程序可以在下层工作（例如 Windows XP 上的 VS 2008 项目），MSVCRT 是可再分发的，因此可以安装在那里。

CRT 安装将库放入 %windir%\winsxs\，这是一个全局系统位置，需要管理员权限才能执行此操作。

由于某些程序不希望附带安装程序，或者不希望用户需要机器上的管理员权限才能运行其安装程序，因此他们将 CRT 直接捆绑在与应用程序相同的目录中，以供私人使用。所以在一台典型的机器上，你会发现很多程序都选择了这个解决方案。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-06-22T15:08:46.353

Windows 中并没有真正的“系统范围的 libc”。

在 *nix 中，通常有一个编译器、一个链接器，以及定义良好的目标文件格式、调用约定和名称修饰规范。这些东西通常随操作系统一起提供。编译器的半特殊状态（加上强调跨不同 *nixes 的可移植性）意味着可以*预期*某些东西在那里，并且以程序可以轻松找到和使用它的方式命名和/或版本化。

In Windows, things are more fragmented. A compiler doesn't come with the OS, so people need to get their own. Each compiler provides its own CRT, which may or may not have the same functions in it as MSVCRT. There's also no One True Spec on calling conventions or how names should appear in the libraries, so different compilers (with different ways of doing stuff) might have trouble finding functions in the library.

BTW, the name should be a clue here; MSVCRT is short for "MicroSoft Visual C++ RunTime". It's not really a "system-wide" library in the same way that, say, `kernel32` is -- it's just the runtime library used by MS's compilers, which they presumably used when building Windows. Other compilers could conceivably link against it, but (1) there might be licensing issues; and (2) the compilers would be tying their code to MS's -- meaning (2a) they'd no longer have any way to add to the runtime or fix bugs, short of hoping MS will fix them; and (2b) if MS decides to change what's in the RTL (which they can do at will, and probably have in each new version of VC++), or how the names appear, those other programs might break.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-25T19:09:13.997

简短的回答？因为，在 SxS 之前，MSVCRT*没有可靠的版本控制*！你能想象如果针对 libc 5 编译和测试的程序会默默地开始使用 libc 6 会导致多么疯狂吗？这就是我们多年来在 Windows 上的情况。我们中的大多数人很快就会再也不相信 MS 会在版本中保留重大更改

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T19:07:43.093

程序与特定版本的运行时链接，并且*不*保证目标机器上存在所需的版本。此外，匹配版本曾经是有问题的。

在 Windows 世界中，期望您的用户出去寻找并安装一个单独的库来使用您的应用程序是非常不礼貌的。您确保任何不属于主机系统的依赖项都包含在您的应用程序中。

在 linux 世界中，这并不总是那么简单，因为主机系统的外观可能会有更大的变化。

# silverlight - Silverlight (v2) 中的精灵/角色动画

> ID：135299
> 
> 赞同：4
> 
> 时间：2008-09-25T19:05:43.770
> 
> 标签：silverlight, animation, silverlight-2.0

我们有一个 Silverlight 2 项目（游戏），需要大量的角色动画。任何人都可以提出一个好的方法来做到这一点。目前我们计划在 Illustrator 中构建艺术，通过 Mike Snow 的插件导入 Silverlight，因为这符合我们艺术家的技能。

关键帧动画是我们唯一的选择吗？如果是，最好的方法是什么？数百个单独的 png 或 Silverlight 中是否有某种方法可以仅绘制较大图像的一部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:29:12.480

您可以使用图像本身或图像容器上的 Clip 属性来显示较大图像的特定部分，例如精灵表。这可能会或可能不会比交换 png 更高效。您也可以在 Rectangle 上使用 ImageBrush 来显示您想要的内容，这可能比 Clip 属性更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T15:43:52.397

我刚刚使用比尔关于 Rectange 和 ImageBrush 的建议发布[了一些代码。](http://devlicio.us/blogs/christopher_bennage/archive/2008/10/17/frame-based-bitmap-animations-in-silverlight.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:14:52.703

Silverlight 目前不支持位图效果，也没有任何库来处理图像。您现在的选择是使用从一个 png 到另一个 png 的关键帧动画。

现在您可以获取图像的原始字节。如果您有自己的图像处理库，您可以使用 Silverlight dll 编译它们，然后在您的 Silverlight 应用程序中使用该库。

# google-calendar-api - 有没有办法以编程方式将 ICS 导入 Google 日历？

> ID：135302
> 
> 赞同：32
> 
> 时间：2008-09-25T19:05:55.673
> 
> 标签：google-calendar-api, icalendar, gcal

我没有看到任何明显的方法可以从这里的 API 文档将 ICS 文件导入 Google 日历：

[http://code.google.com/apis/calendar/developers_guide_protocol.html](http://code.google.com/apis/calendar/developers_guide_protocol.html)

而且我非常希望不必自己解析它们只是将约会发送到GCal。我正在寻找一种程序化的解决方案，而不是像 Thunderbird、Outlook 等的导入插件。任何语言都可以接受第三方 API 来进行 ICS 解析。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-21T10:22:26.673

为此，我创建了一个简单的开源 .net 实用程序，可在[http://gcalicsimporter.codeplex.com/](http://gcalicsimporter.codeplex.com/)获得。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T19:22:53.493

您不必解析 ICS 只是为了将其导入 Google 日历，它能够直接导入它们……从最终用户的 Web 视图中，只需单击“导入日历”即可。从 API 中，我会查看[添加新订阅](http://code.google.com/apis/calendar/developers_guide_protocol.html#AddingSubscriptions)部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-30T17:08:39.103

对于我的 iCal2GCal 应用程序，我使用[Googlecalendar Ruby Gem](http://googlecalendar.rubyforge.org/)来解析 .ics 文件，然后将其中的事件添加到 Googlecalendar。它可能会给你一些关于如何去做的想法。您可以查看完整的[源代码](http://github.com/relix/iCal2GCal/blob/0a233ad506ecb55ed924bd86fca1621c2cdbd616/ical2gcal.rb)。

# python - 我怎样才能接近实现？：来自 Python 中的 C++/C#？

> ID：135303
> 
> 赞同：11
> 
> 时间：2008-09-25T19:06:03.630
> 
> 标签：python, syntax, ternary-operator, syntax-rules

在 C# 中，我可以轻松编写以下内容：

```
string stringValue = string.IsNullOrEmpty( otherString ) ? defaultString : otherString; 
```

有没有一种在 Python 中做同样事情的快速方法，或者我是否坚持使用“if”语句？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-25T19:08:31.470

在 Python 2.5 中，有

```
A if C else B 
```

它的行为很像？例如，在您的情况下：

```
stringValue = otherString or defaultString 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T19:27:21.020

@担

> ```
> if otherString:
>    stringValue = otherString
> else:
>    stringValue = defaultString 
> ```
> 
> 这种类型的代码更长，更具表现力，但也更具可读性

嗯，是的，它更长。不太确定“更具表现力”和“更具可读性”。至少，你的主张是有争议的。我什至会说这是完全错误的，原因有两个。

首先，您的代码强调决策（相当极端）。另一方面，条件运算符强调其他东西，即值（分别是所述值的分配）。这*正是*这段代码的作者想要的。决策实际上是代码的副产品。这里重要的部分是赋值操作。您的代码在很多语法噪音中隐藏了这个分配：分支。

您的代码表现力较差，因为它转移了重点部分。

即使这样，您的代码也可能会胜过一些晦涩的 ASCII 艺术，例如`?:`. 内联-`if`会更好。就个人而言，我不喜欢 Python 2.5 引入的变体，因为它是倒退的。我更喜欢在与 C 三元运算符相同的流（方向）中读取但使用单词而不是 ASCII 字符的东西：

```
C = if cond then A else B 
```

这赢得了双手。

不幸的是，C 和 C# 没有这样的表达性声明。但是（这是第二个论点），C 语言的三元条件运算符由来已久，以至于它本身已成为一个习语。三元运算符与“常规”`if`语句一样是语言的一部分。因为它是一个成语，任何了解该语言的人都会立即正确地阅读此代码。此外，它是表达这些语义的一种极短、简洁的方式。事实上，这是可以想象到的最短路径。它极具表现力，因为它不会用不必要的噪音掩盖本质。

最后，Jeff Atwood 写了一个完美的结论：[**最好的代码就是没有代码**](http://www.codinghorror.com/blog/archives/000878.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T19:11:18.733

编写可读的、富有表现力的代码从来都不是一件坏事。

```
if otherString:
   stringValue = otherString
else:
   stringValue = defaultString 
```

这种类型的代码更长，更具表现力，但也更易读，并且不太可能在路上被绊倒或错误编辑。不要害怕写得富有表现力——可读的代码应该是一个目标，而不是副产品。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-21T15:37:05.487

这个问题有几个重复，例如

*   [Python有三元条件运算符吗？](https://stackoverflow.com/questions/394809/python-ternary-operator)
*   [在 Python 中替换三元运算符的最佳方法是什么？](https://stackoverflow.com/questions/643983/whats-the-best-way-to-replace-the-ternary-operator-in-python)

本质上，在一般设置中，2.5 之前的代码应该使用这个：

```
 (condExp and [thenExp] or [elseExp])[0] 
```

（给定 condExp、thenExp 和 elseExp 是任意表达式），因为如果 thenExp 计算结果为布尔值 False，它会避免错误结果，同时保持短路计算。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T19:32:01.787

顺便说一句，j0rd4n，你不要（*请*不要！）用 C# 编写这样的代码。除了`IsDefaultOrNull`实际调用的事实之外`IsNullOrEmpty`，这纯粹是代码膨胀。C# 为以下情况提供了合并运算符：

```
string stringValue = otherString ?? defaultString; 
```

确实，这仅在`otherString`is `null`（而不是空）时才有效，但如果可以事先确保（并且通常可以），它会使代码更具可读性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T20:40:32.357

我还发现仅使用“或”运算符效果很好。例如：

```
finalString = get_override() or defaultString 
```

如果*get_override()*返回 "" 或 None，它将始终使用*defaultString*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:44:59.163

[diveintopython.net 的第 4 章给出](http://www.diveintopython.net/power_of_introspection/and_or.html#d0e9975)了答案。这在 Python 中被称为与或技巧。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-25T19:14:05.543

您可以利用逻辑表达式返回其值的事实，而不仅仅是真或假状态。例如，您始终可以使用：

```
result = question and firstanswer or secondanswer 
```

需要注意的是，如果 firstanswer 为假，它就不会像三元运算符那样工作。这是因为问题首先被评估，假设它是真的 firstanswer 被返回，除非 firstanswer 为假，所以这种用法不能像三元运算符一样。但是，如果您知道这些值，则通常没有问题。一个例子是：

```
result = choice == 7 and "Seven" or "Another Choice" 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-25T20:37:53.003

如果你使用 ruby​​，你可以写

```
stringValue = otherString.blank? ? defaultString : otherString; 
```

内置`blank?`方法表示 null 或空。
来到黑暗的一面...

# java - 哪个清单 implementation will be the fastest for one pass write, read, then destroy? What is the fastest list implementation (in java) in a scenario where the list will be created one element at a time then at a later point be read on 问问题 WolfmanDragon 问问题 2008-09-25T19:07:53.047 37658 次 This question shows research effort; it is useful and clear 27 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. What is the fastest list implementation (in java) in a scenario where the list will be created one element at a time then at a later point be read one element at a time? The reads will be done with an iterator and then the list will then be destroyed. I know that the Big O notation for get is O(1) and add is O(1) for an ArrayList, while LinkedList is O(n) for get and O(1) for add. Does the iterator behave with the same Big O notation? Iterating through a linked list is O(1) per element. The Big O runtime for each option is the same. Probably the ArrayList will be faster because of better memory locality, but you'd have to measure it to know for sure. Pick whatever makes the code clearest. javalistcollectionsbig-o 4 8 回答 8 This answer is useful 29 It depends largely on whether you know the maximum size of each list up front. If you do, use ArrayList; it will certainly be faster. Otherwise, you'll probably have to profile. While access to the ArrayList is O(1), creating it is not as simple, because of dynamic resizing. Another point to consider is that the space-time trade-off is not clear cut. Each Java object has quite a bit of overhead. While an ArrayList may waste some space on surplus slots, each slot is only 4 bytes (or 8 on a 64-bit JVM). Each element of a LinkedList is probably about 50 bytes (perhaps 100 in a 64-bit JVM). So you have to have quite a few wasted slots in an ArrayList before a LinkedList actually wins its presumed space advantage. Locality of reference is also a factor, and ArrayList is preferable there too. In practice, I almost always use ArrayList. 于 2008-09-25T19:19:27.870 回答 This answer is useful 10 First Thoughts: Refactor your code to not need the list. Simplify the data down to a scalar data type, then use: int[] Or even just use an array of whatever object you have: Object[] - John Gardner Initialize the list to the full size: new ArrayList(123); Of course, as everyone else is mentioning, do performance testing, prove your new solution is an improvement. 于 2008-09-25T19:11:07.297 回答 This answer is useful 7 Note that iterating through an instance of LinkedList can be O(n^2) if done naively. Specifically: List<Object> list = new LinkedList<Object>(); for (int i = 0; i < list.size(); i++) { list.get(i); } This is absolutely horrible in terms of efficiency due to the fact that the list must be traversed up to i twice for each iteration. If you do use LinkedList, be sure to use either an Iterator or Java 5's enhanced for-loop: for (Object o : list) { // ... } The above code is O(n), since the list is traversed statefully in-place. To avoid all of the above hassle, just use ArrayList. It's not always the best choice (particularly for space efficiency), but it's usually a safe bet. 于 2008-09-25T19:15:39.207 回答 This answer is useful 7 遍历链表是每个元素 O(1)。 每个选项的 Big O 运行时都是相同的。由于更好的内存局部性，ArrayList 可能会更快，但您必须测量它才能确定。选择使代码最清晰的任何内容。 于 2008-09-25T19:10:29.907 回答 This answer is useful 4 There is a new List implementation called GlueList which is faster than all classic List implementations. Disclaimer: I am the author of this library 于 2015-11-06T15:44:59.530 回答 This answer is useful 3 You almost certainly want an ArrayList. Both adding and reading are "amortized constant time" (i.e. O(1)) as specified in the documentation (note that this is true even if the list has to increase it's size - it's designed like that see http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html ). If you know roughly the number of objects you will be storing then even the ArrayList size increase is eliminated. Adding to the end of a linked list is O(1), but the constant multiplier is larger than ArrayList (since you are usually creating a node object every time). Reading is virtually identical to the ArrayList if you are using an iterator. It's a good rule to always use the simplest structure you can, unless there is a good reason not to. Here there is no such reason. The exact quote from the documentation for ArrayList is: "The add operation runs in amortized constant time, that is, adding n elements requires O(n) time. All of the other operations run in linear time (roughly speaking). The constant factor is low compared to that for the LinkedList implementation." 于 2008-09-25T19:50:25.380 回答 This answer is useful 2 I suggest benchmarking it. It's one thing reading the API, but until you try it for yourself, it'd academic. Should be fair easy to test, just make sure you do meaningful operations, or hotspot will out-smart you and optimise it all to a NO-OP :) 于 2008-09-25T19:12:25.797 回答 This answer is useful -1 I have actually begun to think that any use of data structures with non-deterministic behavior, such as ArrayList or HashMap, should be avoided, so I would say only use ArrayList if you can bound its size; any unbounded list use LinkedList. That is because I mainly code systems with near real time requirements though. The main problem is that any memory allocation (which could happen randomly with any add operation) could also cause a garbage collection, and any garbage collection can cause you to miss a target. The larger the allocation, the more likely this is to occur, and this is also compounded if you are using CMS collector. CMS is non-compacting, so finding space for a new linked list node is generally going to be easier than finding space for a new 10,000 element array. The more rigorous your approach to coding, the closer you can come to real time with a stock JVM. But choosing only data structures with deterministic behavior is one of the first steps you would have to take. 于 2012-03-14T21:18:16.133 回答 Related 3 javascript - 浮点数问题。JavaScript 1 asp.net - aspx 页面布局在 IE9 中失败 1 visual-studio-2012 - 将 NUnitTesting GUI 集成到 Visual Studio 2012 并调试测试用例 0 windows-phone-7.1 - 从主页设置嵌套控件按钮的背景在 windows phone 中不起作用 1 .net - 无法配置应用程序以从另一个文件夹加载外部 dll 1 ios - 如何在 Gamesalad for iOS 中制作通用应用程序？ 1 ios - 将 object_setInstanceVariable() 转换为 ARC？ 2 batch-file - 使用 taskkill 只杀死一个进程 2 linux - linux scp/sftp 命令 2 java - 输入流，标记（），重置（） Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：135314
> 
> 赞同：27
> 
> 时间：
> 
> 标签：java, list, collections, big-o

What is the fastest list implementation (in java) in a scenario where the list will be created one element at a time then at a later point be read one element at a time? The reads will be done with an iterator and then the list will then be destroyed.
I know that the Big O notation for get is O(1) and add is O(1) for an ArrayList, while LinkedList is O(n) for get and O(1) for add. Does the iterator behave with the same Big O notation?

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-25T19:19:27.870

It depends largely on whether you know the maximum size of each list up front.

If you do, use `ArrayList`; it will certainly be faster.

Otherwise, you'll probably have to profile. While access to the `ArrayList` is O(1), creating it is not as simple, because of dynamic resizing.

Another point to consider is that the space-time trade-off is not clear cut. Each Java object has quite a bit of overhead. While an `ArrayList` may waste some space on surplus slots, each slot is only 4 bytes (or 8 on a 64-bit JVM). Each element of a `LinkedList` is probably about 50 bytes (perhaps 100 in a 64-bit JVM). So you have to have quite a few wasted slots in an `ArrayList` before a `LinkedList` actually wins its presumed space advantage. Locality of reference is also a factor, and `ArrayList` is preferable there too.

In practice, I almost always use `ArrayList`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-25T19:11:07.297

**First Thoughts:**

*   Refactor your code to not need the list.
*   Simplify the data down to a scalar data type, then use: **int[]**
*   Or even just use an array of whatever object you have: **Object[]** - John Gardner
*   Initialize the list to the full size: **new ArrayList(123);**

Of course, as everyone else is mentioning, do performance testing, prove your new solution is an improvement.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T19:15:39.207

Note that iterating through an instance of `LinkedList` can be O(n^2) if done naively. Specifically:

```
List<Object> list = new LinkedList<Object>();
for (int i = 0; i < list.size(); i++) {
    list.get(i);
} 
```

This is absolutely horrible in terms of efficiency due to the fact that the list must be traversed up to `i` *twice* for each iteration. If you do use `LinkedList`, be sure to use either an `Iterator` or Java 5's enhanced `for`-loop:

```
for (Object o : list) {
    // ...
} 
```

The above code is O(n), since the list is traversed statefully in-place.

To avoid all of the above hassle, just use `ArrayList`. It's not always the best choice (particularly for space efficiency), but it's usually a safe bet.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T19:10:29.907

遍历链表是每个元素 O(1)。

每个选项的 Big O 运行时都是相同的。由于更好的内存局部性，ArrayList 可能会更快，但您必须测量它才能确定。选择使代码最清晰的任何内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-11-06T15:44:59.530

There is a new List implementation called [GlueList](https://github.com/ertugrulcetin/GlueList) which is faster than all classic List implementations.

Disclaimer: I am the author of this library

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-25T19:50:25.380

You almost certainly want an **ArrayList**. Both adding and reading are "amortized constant time" (i.e. O(1)) as specified in the documentation (note that this is true even if the list has to increase it's size - it's designed like that see [http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html) ). If you know roughly the number of objects you will be storing then even the ArrayList size increase is eliminated.

Adding to the end of a linked list is O(1), but the constant multiplier is larger than ArrayList (since you are usually creating a node object every time). Reading is virtually identical to the ArrayList if you are using an iterator.

It's a good rule to always use the simplest structure you can, unless there is a good reason not to. Here there is no such reason.

The exact quote from the documentation for ArrayList is: "The add operation runs in amortized constant time, that is, adding n elements requires O(n) time. All of the other operations run in linear time (roughly speaking). The constant factor is low compared to that for the LinkedList implementation."

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T19:12:25.797

I suggest benchmarking it. It's one thing reading the API, but until you try it for yourself, it'd academic.

Should be fair easy to test, just make sure you do meaningful operations, or hotspot will out-smart you and optimise it all to a NO-OP :)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-03-14T21:18:16.133

I have actually begun to think that any use of data structures with non-deterministic behavior, such as ArrayList or HashMap, should be avoided, so I would say only use ArrayList if you can bound its size; any unbounded list use LinkedList. That is because I mainly code systems with near real time requirements though.

The main problem is that any memory allocation (which could happen randomly with any add operation) could also cause a garbage collection, and any garbage collection can cause you to miss a target. The larger the allocation, the more likely this is to occur, and this is also compounded if you are using CMS collector. CMS is non-compacting, so finding space for a new linked list node is generally going to be easier than finding space for a new 10,000 element array.

The more rigorous your approach to coding, the closer you can come to real time with a stock JVM. But choosing only data structures with deterministic behavior is one of the first steps you would have to take.

# cherrypy - CherryPy 服务器名称标签

> ID：135317
> 
> 赞同：7
> 
> 时间：2008-09-25T19:08:27.837
> 
> 标签：cherrypy

当运行 CherryPy 应用程序时，它会发送类似于 CherryPy/version 的服务器名称标签。是否可以在不修改 CherryPy 的情况下从应用程序重命名/覆盖它，以便显示其他内容？

也许像 MyAppName/version (CherryPy/version)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-23T00:29:50.590

现在可以在配置文件/dict 中针对每个应用程序进行设置

```
[/]  
response.headers.server = "CherryPy Dev01" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T14:31:55.973

实际上在他们的官方频道 fumanchu 上询问 IRC 给了我一个更干净的方法来做到这一点（使用最新的 svn）：

```
import cherrypy
from cherrypy import _cpwsgi_server 
class HelloWorld(object):
    def index(self):
        return "Hello World!"
    index.exposed = True

serverTag = "MyApp/%s (CherryPy/%s)" % ("1.2.3", cherrypy.__version__)
_cpwsgi_server.CPWSGIServer.environ['SERVER_SOFTWARE'] = serverTag
cherrypy.config.update({'tools.response_headers.on': True,
                        'tools.response_headers.headers': [('Server', serverTag)]})
cherrypy.quickstart(HelloWorld()) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T20:00:15.887

这个字符串似乎是在 CherrPy [Response](http://www.cherrypy.org/browser/trunk/cherrypy/_cprequest.py)类中设置的：

```
def __init__(self):
  self.status = None
  self.header_list = None
  self._body = []
  self.time = time.time()

  self.headers = http.HeaderMap()
  # Since we know all our keys are titled strings, we can
  # bypass HeaderMap.update and get a big speed boost.
  dict.update(self.headers, {
    "Content-Type": 'text/html',
    "Server": "CherryPy/" + cherrypy.__version__,
    "Date": http.HTTPDate(self.time),
  }) 
```

因此，当您创建 Response 对象时，您可以更新“Server”标头以显示所需的字符串。来自 CherrPy[响应对象文档](http://www.cherrypy.org/wiki/ResponseObject)：

> ### 标题
> 
> *包含响应标头的字典。您可以在 finalize 阶段之前随时在此 dict 中设置值，之后 CherryPy 切换到使用 header_list ...*

**编辑**：为避免需要对您创建的每个响应对象进行此更改，解决此问题的一种简单方法是包装 Response 对象。例如，您可以创建自己的 Response 对象，该对象继承自 CherryPy 的 Response 并在初始化后更新 headers 键：

```
class MyResponse(Response):

    def __init__(self):
        Response.__init__(self)
        dict.update(self.headers, {
            "Server": "MyServer/1.0",
        })

RespObject = MyResponse()
print RespObject.headers["Server"] 
```

然后，您可以在需要创建响应对象的地方调用您的对象，并且它将始终将 Server 标头设置为您想要的字符串。

# wolfram-mathematica - Mathematica 减值 Lhs

> ID：135330
> 
> 赞同：10
> 
> 时间：2008-09-25T19:10:20.157
> 
> 标签：wolfram-mathematica

有谁知道 Mathematica 中是否有一个内置函数来获取降值规则的 lhs（没有任何持有）？我知道如何编写代码来做到这一点，但对于内置

例如：

```
a[1]=2;
a[2]=3; 
```

`BuiltInIDoNotKnowOf[a]`返回`{1,2}`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-30T19:58:11.690

这就像`keys()`在 Perl 和 Python 以及其他内置支持哈希（又名字典）的语言中一样。正如您的示例所示，Mathematica 支持散列，无需任何特殊语法。只是说`a[1] = 2`，你有一个哈希。[1] 要获取哈希的密钥，我建议将其添加到您的 init.m 或您的个人实用程序库中：

```
keys[f_] := DownValues[f][[All,1,1,1]]  (* Keys of a hash/dictionary. *) 
```

（或者下面的纯函数版本应该稍微快一点：

```
keys = DownValues[#][[All,1,1,1]]&;     (* Keys of a hash/dictionary. *) 
```

)

不管怎样，`keys[a]`现在返回你想要的。（您可以使用 获取散列值`a /@ keys[a]`。）如果您想允许更高的散列值，`a[1,2]=5; a[3,4]=6`那么您可以使用以下方法：

```
SetAttributes[removeHead, {HoldAll}];
removeHead[h_[args___]] := {args}
keys[f_] := removeHead @@@ DownValues[f][[All,1]] 
```

哪个返回`{{1,2}, {3,4}}`。（在这种情况下，您可以使用 . 获取哈希值`a @@@ keys[a]`。）

请注意，`DownValues`默认情况下对键进行排序，这可能不是一个好主意，因为充其量需要额外的时间。如果你想对键进行排序，你可以这样做`Sort@keys[f]`。所以我实际上会推荐这个版本：

```
keys = DownValues[#,Sort->False][[All,1,1,1]]&; 
```

有趣的是，文档中没有提到该`Sort`选项`DownValues`。我是从 Wolfram Research 的 Daniel Lichtblau 的一篇旧帖子中了解到的。（我确认它在 Mathematica 的当前版本（7.0）中仍然有效。）

* * *

脚注：

[1] 真正方便的是您可以将其与函数定义混合搭配。像：

```
fib[0] = 1;
fib[1] = 1;
fib[n_] := fib[n-1] + fib[n-2] 
```

然后，您可以通过将最后一行更改为

```
fib[n_] := fib[n] = fib[n-1] + fib[n-2] 
```

它说要缓存所有后续调用的答案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-26T06:28:02.943

这似乎有效；不过，不确定它有多大用处：

```
a[1] = 2
a[2] = 3
a[3] = 5
a[6] = 8
Part[DownValues[a], All, 1, 1, 1] 
```

# wcf - LinqToSql 和 WCF

> ID：135339
> 
> 赞同：2
> 
> 时间：2008-09-25T19:10:53.820
> 
> 标签：wcf, linq-to-sql

在使用 WCF 服务与数据库交互的 n 层应用程序中，在整个应用程序中使用 LinqToSql 类的最佳实践方式是什么？

我已经看到它以几种不同的方式完成，但他们似乎花费了很多时间来创建额外的接口、消息类等，这减少了您不必编写数据访问代码所获得的好处。

目前有什么好的方法吗？我们是否一直在等待实体框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:37:10.543

LINQ to SQL 并不真正适合与分布式应用程序一起使用。更改跟踪和延迟加载是与数据库绑定的 DataContext 的一部分，因此无法通过网络传输。您可以通过网络移动 L2S 实体，修改它们，将它们移回并通过将它们重新附加到 DataContext 来更新数据库，但这非常有限，并且您会丢失所有并发检查，因为旧值永远不会保留。

顺便说一句，我相信 L2E 也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T19:38:16.340

将 linq-to-sql 对象传递给分布式系统的其他部分当然不是一个好主意。如果你这样做，你会将你的客户耦合到数据库的结构上，这绝不是一个好主意。顺便说一下，这是/是数据集的主要问题之一。

最好创建自己的类来传输数据对象。当然，这些类将作为 DataContracts 实现。在您的服务层中，您将在 linq-to-sql 对象和数据载体对象的实例之间进行转换。这很乏味，但它将服务的客户端与数据库模式分离。它还具有让您更好地控制系统中传递的数据的优势。

# language-agnostic - 滥用单例类的最常见示例

> ID：135347
> 
> 赞同：12
> 
> 时间：2008-09-25T19:12:16.140
> 
> 标签：language-agnostic, design-patterns, singleton

什么时候不应该使用单例类，尽管这样做可能很诱人？如果我们有一份我们应该注意避免的最常见的“单项炎”实例列表，那就太好了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T19:18:42.007

不要将单例用于可能演变成可乘资源的东西。

这可能听起来很傻，但是如果您声明某个东西是单例的，那么您就是在做出一个非常强烈的声明，即它绝对是独一无二的。你正在围绕它构建代码，越来越多。当你在数千行代码之后发现它根本不是单例时，你面前有大量工作要做，因为所有其他对象都希望 WizBang 类的“神圣”对象是单例.

典型例子：“这个应用程序只有一个数据库连接，因此它是一个单例。” - 馊主意。您可能希望将来有多个连接。最好创建一个数据库连接池并仅使用一个实例填充它。像 Singleton 一样，但所有其他代码都将具有用于访问池的可增长代码。

**编辑：**我知道理论上你可以将一个单例扩展到几个对象。然而，没有真正的生命周期（如池化/取消池化），这意味着已经分发的对象没有真正的所有权，即现在的多单例必须是无状态的，才能被不同的方法和线程同时使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T19:19:09.823

大多数情况下，单身人士只是让事情变得静态。因此，您要么实际上使数据全局化，而我们都知道全局变量不好，要么您正在编写静态方法，现在这不是很OO，是吗？

[这](http://steve.yegge.googlepages.com/singleton-considered-stupid)是 Steve Yegge 对单身人士为何不好的更详细的咆哮。基本上你不应该在几乎所有情况下都使用单例，你不能真正知道它永远不会在多个地方被需要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T19:16:07.193

我知道很多人的回答是“当你有多个时”等等。

由于原始海报想要一份您不应该使用单例的案例列表（而不是首要原因），我会附和：

**每当您使用它时，因为您不允许使用全局！**

我有多少次让初级工程师使用单例，因为他们知道我在代码审查中不接受全局变量。当我指出他们所做的只是用单例模式替换全局变量时，他们常常看起来很震惊，而他们仍然只有一个全局变量！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T19:19:37.637

几年前我犯了一个大罪（谢天谢地，从那时起我已经吸取了教训）。

发生的事情是，我加入了一个桌面应用程序项目，该项目已从 VB6 转换为 .Net，并且真的一团糟。诸如 40 页（印刷）的函数和没有真正的类结构之类的东西。我构建了一个类来封装对数据库的访问。不是一个真正的数据层（还），只是一个真正的数据层可以使用的基类。在某个地方，我想到了让这个类成为单身人士的好主意。它运行了一年左右还不错，然后我们还需要为该应用程序构建一个 Web 界面。单例最终成为数据库的一个巨大瓶颈，因为所有 Web 用户都必须共享相同的连接。再次……吸取教训。

回想起来，它在短时间内可能实际上是正确的选择，因为它迫使其他开发人员在使用它时更加自律，并让他们意识到范围界定问题以前在 VB6 世界中不是问题。但我应该在几周后在我们围绕它建立太多东西之前把它改回来。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T19:39:01.507

[这是我的朋友亚历克斯·米勒 (Alex Miller) 的咆哮](http://tech.puredanger.com/2007/07/03/pattern-hate-singleton/)……它并没有完全列举“什么时候不应该使用单例”，但它是一篇全面、出色的帖子，并认为应该只在极少数情况下使用单例，如果有的话.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T19:25:47.233

单例实际上总是一个坏主意，并且通常无用/多余，因为它们只是对体面模式的非常有限的简化。

查看依赖注入是如何工作的。它解决了同样的问题，但以一种更有用的方式——事实上，您会发现它适用于您设计的更多部分。

虽然你可以在那里找到 DI 库，但你也可以自己创建一个基本的库，这很容易。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T19:30:02.930

我尝试只有一个单例 - 控制/服务定位器对象的反转。

```
IService service = IoC.GetImplementationOf<IService>(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T19:20:15.187

使其成为噩梦的一件事是它是否包含**可修改**的全局状态。我在一个项目中工作，在整个地方都使用单例来解决应该以完全不同的方式解决的事情（传递策略等）。“去单例化”在某些情况下是对部分内容的重大重写系统。我会争辩说，在大多数情况下，当人们使用单例时，这只是错误的 b/c，它一开始看起来不错，但在测试中尤其是变成了一个问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T19:20:57.227

有时，你认为只有一件事，然后你就错了。

例如，一个数据库类。您假设您只会连接到应用程序的数据库。

```
// Its our database! We'll never need another
class Database
{
}; 
```

可是等等！你的老板说，连接到其他一些人的数据库。假设您想将 phpbb 添加到网站，并想戳它的数据库以集成它的一些功能。我们应该创建一个新的单例还是另一个数据库实例？大多数人都同意优先使用同一类的新实例，没有代码重复。

你宁愿有

```
Database ourDb;
Database otherDb; 
```

比复制过去的数据库并制作：

```
// Copy-pasted from our home-grown database.
class OtherGuysDatabase
{
}; 
```

这里的滑坡是你可能会停止考虑创建新的类实例，而是开始认为每个实例都有一个类型是可以的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T19:21:40.860

当您有多个应用程序在同一个 JVM 中运行时。

单例是跨整个 JVM 的单例，而不仅仅是单个应用程序。即使多个线程或应用程序似乎正在创建一个新的单例对象，但如果它们在同一个 JVM 中运行，它们都使用同一个对象。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T21:28:59.400

在连接的情况下（例如），您不希望将连接本身设为单例，您可能需要四个连接，或者您可能需要多次销毁并重新创建连接。

但是您为什么不通过单个接口（即连接管理器）*访问所有连接呢？*

# svn - 跨存储库/项目的颠覆和共享文件？

> ID：135361
> 
> 赞同：26
> 
> 时间：2008-09-25T19:15:59.347
> 
> 标签：svn, shared

我正在将客户的 SourceSafe 存储库（3 个项目）迁移到 SVN，其中两个项目共享源文件。（这些项目是独立的产品 - 具有不同的名称和发布版本等）

SVN 解决了​​这个缺点吗？人们通常如何处理这种情况？

我知道/能想到的选项

*   对 SVN 使用 external 或 extern 或其他任何东西。我听说由于各种原因这不是一个好选择

*   创建一个包含源的新项目（可能称为共享）。这样做的问题是我们仍然必须获取该代码（它不是库）并以某种方式将其导入项目中。可以证明它与上述问题相同，并且引入了额外产品/项目的开销。

*   只需签入两个存储库中的文件并交叉更新它们。这要求开发人员了解共享并记住签入。我想我可以编写一个脚本来检查所有已知的共享文件并在需要时更新它们。

*   为共享的两个项目提供一个存储库。这让我不得不创建一个包含两者的顶级项目/存储库，这是一个标签问题。我真的不想给顶级伪项目贴上标签。（标签、主干和分支的东西并不是我想要的。）

我可能会选择最后一个选项。

还有其他意见吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T19:32:33.363

我不知道你到底听说了什么关于 svn:externals，但我认为这就是你应该在这里使用的。您甚至可以指定外部指向共享源的稳定分支或发布标签，甚至指向使用它的其他两个项目的两个不同标签（如果您尽快修复共享代码中的一些错误，您可能需要这个对于项目 A，但您没有足够的时间使用项目 B 对其进行全面测试）。

您可以做的最糟糕的事情是您的选项 3（交叉更新相同文件的两个版本）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T19:28:57.600

安全的方法是拥有第三个项目，将共享源构建到其他两个使用的库中。该库项目有它自己的 SVN 存储库。

您甚至可以对只是标题的共享文件执行此操作，只需将它们留在 lib 项目目录中并将其添加到包含列表中即可。

在两个项目中拥有相同的文件，即使使用 soruce 控制也迟早会自找麻烦！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-17T09:43:36.613

以防万一有人用谷歌搜索这个问题并想知道如何使用 TortoiseSVN 引入外部资源，那么文档就在这里：

[包括一个共同的子项目](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-howto-common-projects.html)

[外部项目](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-externals.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T19:44:57.840

当然，使用一个存储库。稍后可能会有更多共享代码。

标签到底有什么问题？因此，您在标签中有一个额外的文件夹，但它不会占用您的空间。如果你真的不想要那个额外的文件夹，这里有一个组织树的想法：

*   /
    *   树干
        *   prj1
        *   prj2
        *   共享
    *   标签
        *   标签1
            *   prj1
            *   共享

也就是说，当你要标记 prj1 时，你创建 tag1，然后将 prj1 复制并共享到其中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T19:26:02.660

根据我的经验，让两个独立的项目引用相同的源文件是有问题的，因为我可能会在共享文件中添加或更改代码以满足一个项目的需求，而只是破坏另一个构建。

似乎这里的技巧是允许每个项目独立推进，因此无论您如何设置存储库，您都希望稳定共享代码，使其仅在您需要时更改。

例如，如果共享代码位于同一存储库的两个分支/文件夹中，或者如果它被单独检查到两个不同的存储库中，或者如果它单独位于第三个存储库中，则您需要升级那段代码的步骤成为没有副作用的手动工具，您可以对其进行隔离、调试和错误修复。

我已将此代码分解到第三个存储库中，然后我定期将该代码迁移到我的依赖项目存储库中，作为内部发布和升级步骤；然后我的个人项目有一个看起来像“升级到 Shared.App.dll 的 v4.3.345”的修订版，其中包括针对该版本工作所需的所有更改。

如果共享代码与两个依赖项目属于同一个存储库，则在每个项目中都有一个单独的副本，并使用存储库合并来传播您的更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T20:57:07.027

您没有提及您正在使用什么语言或构建工具，但对于 Java 项目，Maven 可能值得研究。特性之一是本质上扩展了 ant 以允许您引入外部依赖项。这消除了您对必须创建、维护和标记元项目的担忧之一。它还允许您从外部项目的 HEAD 中提取，或者从给定的标签中提取，这减轻了之前发布者关于在项目之间共享公共文件并无意中导致损坏的担忧之一，因为您可以控制每个项目何时使用独立的共享文件的较新版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T19:25:29.493

使用触发器更新文件听起来是个坏主意。不知何故，他们会失去同步。真正使用共享代码的解决方案是将其提取到一个库中并在多个解决方案中使用该库。不过，这听起来超出了您的项目范围，因此最后一个解决方案是您最好的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T19:31:18.857

> 为共享的两个项目提供一个存储库。这让我不得不创建一个包含两者的顶级项目/存储库，这是一个标签问题。我真的不想给顶级伪项目贴上标签。（标签、主干和分支的东西并不是我想要的。）

像其他人一样，我肯定会用最后一种方式。您觉得“只有”一个存储库有什么问题？存储库是关于管理员权限的。除此之外，我会看到一个仓库中有任意 N 个项目。

# asp-classic - 经典 asp - 何时使用 Response.flush？

> ID：135365
> 
> 赞同：9
> 
> 时间：2008-09-25T19:16:55.177
> 
> 标签：asp-classic

我们有一个令人痛苦的缓慢报告。我添加了一个 Response.flush ，它似乎好多了。使用这种方法有哪些注意事项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T19:19:08.747

如果 Response.Buffer 未设置为 true，那么您将收到运行时错误。此外，如果在 ASP 页上调用 Flush 方法，则服务器不支持该页的 Keep-Alive 请求。

您还需要查看您是否使用基于表格的设计，因为在发送整个表格之前它不会在某些浏览器中呈现。这意味着如果您有 10,000 行，用户仍然需要等待在他们真正看到它们之前，所有 10,000 行都要转移。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T19:34:59.893

扩展[韦恩的回答](https://stackoverflow.com/questions/135365/classic-asp-when-to-use-response-flush/135376#135376)：如果你做的任何事情都需要设置 Response.Headers，在 Response 的任何部分被刷新后你就不能这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T18:37:11.820

像这样刷新响应没有问题。通常建议更好的性能来缓冲整个页面并将其刷新到客户端，但对于长时间运行的脚本，通常最好向客户端显示一些数据，以便用户看到正在发生的事情。

请记住，手动刷新仅在从一开始就缓冲页面时才有适当的效果，否则 IIS 将自动刷新（将页面流式传输到客户端）。

您应该避免经常刷新，因为 IIS 将不得不经常使用资源刷新页面而不是处理脚本。即：每 50 行刷新一次，而不是每行刷新一次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T18:33:06.363

Response.flush 可用于将报告的标题发送到浏览器。然后显示“加载消息”，然后显示报告进程并刷新报告，然后执行一小段 javascript 以隐藏“加载”消息。

这样，您将让您的用户知道正在发生某些事情，因此他们不会按 STOP BACK 或只是关闭窗口，否则他们可能会受到诱惑。

此外，我已经玩了很多浏览器渲染什么表格，而 IE 似乎是唯一一个不渲染表格的浏览器，除非收到标签。这意味着所有行都可以逐渐出现在其他浏览器中，但不会出现在 IE 中。

# windows-mobile - 如何确定文件是否在 Windows Mobile 的 ROM 中？

> ID：135368
> 
> 赞同：2
> 
> 时间：2008-09-25T19:17:26.223
> 
> 标签：windows-mobile

有没有办法以编程方式确定给定的文件路径和名称是否存储在 ROM（即安装在设备上）或 RAM（即在硬重置后创建）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:39:05.280

获取文件属性并检查是否设置了[FILE_ATTRIBUTE_ROMMODULE](http://msdn.microsoft.com/en-us/library/ms899899.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T20:38:48.107

没有 100% 的判断文件是否在 rom 中...

对于大多数文件，尽管您检查“FILE_ATTRIBUTE_INROM”或“FILE_ATTRIBUTE_ROMMODULE”的文件属性。

“FILE_ATTRIBUTE_INROM” - 普通数据文件。“FILE_ATTRIBUTE_ROMMODULE” - 可执行代码文件（dll、exe 等）（这些文件不像普通的可执行文件，因为它们“就地运行”，所以它们就像内存中的代码/数据运行）。

还有其他文件“在 ROM 中”，但没有这样标记！！在您尝试删除它们之前，没有真正的方法可以告诉您，您不能这样做。

# php - 在 php 中使用自动加载和搜索类文件会影响性能吗？

> ID：135373
> 
> 赞同：9
> 
> 时间：2008-09-25T19:18:34.923
> 
> 标签：php, performance

我一直在为如何最好地将类包含到我的 php 代码中而苦苦挣扎。路径通常是一个问题，但几分钟前我发现[了这个问题](https://stackoverflow.com/questions/4369/how-to-include-php-files-that-require-an-absolute-path)，这极大地帮助了这一点。现在我正在阅读 __autoload 并认为它可以使开发我的应用程序的过程变得更加容易。问题是我喜欢维护文件夹结构以分隔功能区域，而不是将所有内容都放入通用 /lib 文件夹中。因此，如果我覆盖自动加载以对包括所有子文件夹的类文件夹进行深度搜索，我可以期待什么性能影响？

显然，这将取决于规模、文件夹结构的深度和类的数量，但通常我问的是中等规模的项目是否会导致问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T19:21:36.260

__autoload 很棒，但是在递归搜索函数中声明所有文件的成本很高。您可能想查看构建用于自动加载的文件树。在我的框架中，我始终为它们的类命名文件并使用为数据缓存的映射。

查看从第 68 行开始的~~[http://trac.framewerk.org/cgi-bin/trac.fcgi/browser/trunk/index.php](http://trac.framewerk.org/cgi-bin/trac.fcgi/browser/trunk/index.php)~~ [**死链接**]，了解如何做到这一点。

编辑：为了更直接地回答您的问题，在没有缓存的情况下，您可以期望在中到大流量的网站上性能受到影响。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T19:22:51.343

一个常见的模式（例如 Pear、Zend 框架......）是让类名反映路径，因此 Db_Adapter_Mysql 将位于 /Db/Adapter/Mysql.php 中，来自添加到包含路径的某个位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:34:22.403

有两种方法可以轻松做到这一点，首先，命名你的类，以便它们定义在哪里找到它们的结构

```
function __autoload($classname)
{
    try
    {
        if (class_exists($classname, false) OR interface_exists($classname, false))
        {
            return;
        }

        $class = split('_', strtolower(strval($classname)));

        if (array_shift($class) != 'majyk')
        {
            throw new Exception('Autoloader tried to load a class that does not belong to us ( ' . $classname . ' )');
        }

        switch (count($class))
        {
            case 1: // Core Class - matches Majyk_Foo - include /core/class_foo.php
                $file = MAJYK_DIR . 'core/class_' . $class[0] . '.php';
            break;

            case 2: // Subclass - matches Majyk_Foo_Bar - includes /foo/class_bar.php
                $file = MAJYK_DIR . $class[0] . '/class_' . $class[1] . '.php';
            break;

            default:
                throw new Exception('Unknown Class Name ( ' . $classname .' )');
                return false;
        }

        if (file_exists($file))
        {
            require_once($file);

            if (!class_exists($classname, false) AND !interface_exists($classname, false))
            {
                throw new Exception('Class cannot be found ( ' . $classname . ' )');
            }
        }
        else
        {
            throw new Exception('Class File Cannot be found ( ' . str_replace(MAJYK_DIR, '', $file) . ' )');
        }

    }
    catch (Exception $e)
    {
        // spl_autoload($classname);
        echo $e->getMessage();
    }

} 
```

或者，2，使用多个自动装载机。PHP >=5.1.2 有 SPL 库，允许您添加多个自动加载器。您为每条路径添加一个，它会在路径中找到它。或者只是将它们添加到包含路径并使用默认的 spl_autoload()

一个例子

```
function autoload_foo($classname)
{
    require_once('foo/' . $classname . '.php');
}

function autoload_bar($classname)
{
    require_once('bar/' . $classname . '.php');
}

spl_autoload_register('autoload_foo');
spl_autoload_register('autoload_bar');
spl_autoload_register('spl_autoload'); // Default SPL Autoloader 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T21:41:50.727

自动加载是非常棒的 PHP 功能，对您有很大帮助......如果使用智能分类法，性能不会受到影响： 1\. 每个库都保留在“包”文件夹中 2\. 每个类都通过替换“_”来定位在类名中使用“/”并在末尾添加“.php” class = My_App_Smart_Object file = packages/My/App/Smart/Object.php

这种方法的好处（几乎所有框架都使用）也是代码的更智能组织:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T19:25:11.850

到处寻找文件会使事情变慢（更多的磁盘命中）。加载所有类以防万一您可能需要它们会使事情占用更多内存。在每个文件中指定您需要的类很难维护（即，如果不再使用它们就不会被删除）。

真正的问题是这些对你来说哪个更重要？最后，它们都是权衡取舍，所以你必须选择一个。不过，有争议的是，第二个和第三个选项中的大部分开销都与实际编译代码有关。[使用APC](http://ca3.php.net/apc)之类的东西可以显着减少每次页面加载时加载和编译每个类的开销。

考虑到 APC 的使用，我可能会采用将我的代码划分为模块（例如 Web 界面模块、数据库交互模块等）的方法，并让每个模块导入其模块的所有类，以及类他们可能需要的其他模块。这是最后两者之间的权衡，我发现它可以很好地满足我的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T22:00:00.403

我倾向于使用一种简单的方法，其中 __autoload() 查询一个哈希映射类名到相对路径，该路径包含在一个文件中，该文件使用一个简单的脚本重新生成，该脚本本身执行递归搜索。

这要求在添加新的类文件或重构代码库时运行脚本，但它也避免了 __autoload() 中可能导致不必要的 stat() 调用的“聪明”，并且它的优点是我可以轻松移动我的代码库中的文件，知道我需要做的就是运行一个脚本来更新自动加载器。

脚本本身递归地检查我的 include/ 目录，并假定任何没有在简短的排除列表中命名的 PHP 文件（自动加载器本身，加上我倾向于拥有的一些其他标准文件）都包含一个同名的类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T23:49:01.000

Zend Framework 的方法是基于 PEAR 文件夹标准进行自动加载（Class_Foo 映射到 /Class/Foo.php），但是它使用 include_path 而不是使用设置的基本路径。

他们的方法的问题是无法事先检查文件是否存在，因此自动加载将尝试包含任何 include_path 中不存在的文件，错误输出，并且永远不会给任何其他使用 spl_autoload_register 注册的自动加载函数机会包括文件。

所以一个轻微的偏差是手动提供一个基本路径数组，自动加载可以期望找到以 PEAR 方式设置的类，并在基本路径上循环：

```
<?php
//...
foreach( $paths as $path )
{
    if( file_exists($path . $classNameToFilePath) )
        include $path . $classNameToFilePath;
}
//...
?> 
```

当然，您会有点搜索，但是对于每个自动加载，您只会在最坏的情况下进行 n 次搜索，其中 n 是您正在检查的基本路径的数量。

但是，如果您发现自己仍然必须递归扫描目录，那么问题不是“自动加载会损害我的性能”，而应该是“为什么我要以随机结构将类文件扔掉？” 坚持 PEAR 结构将为您省去很多麻烦，即使您决定手动执行包含而不是自动加载，当您执行包含语句时，也不会猜测类文件的位置。

# wpf - 如何使 WPF 数据模板填充列表框的整个宽度？

> ID：135375
> 
> 赞同：64
> 
> 时间：2008-09-25T19:18:44.520
> 
> 标签：wpf, layout, listbox, datatemplate

我`ListBox` `DataTemplate`在 WPF 中有一个。我希望一件物品紧贴左侧`ListBox`，另一件紧贴右侧，但我不知道如何做到这一点。

到目前为止，我有一个`Grid`三列，左侧和右侧有内容，中心是一个占位符，其宽度设置为“*”。我哪里错了？

这是代码：

```
<DataTemplate x:Key="SmallCustomerListItem">
    <Grid HorizontalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <WrapPanel HorizontalAlignment="Stretch" Margin="0">
            <!--Some content here-->
            <TextBlock Text="{Binding Path=LastName}" TextWrapping="Wrap" FontSize="24"/>
            <TextBlock Text=", " TextWrapping="Wrap" FontSize="24"/>
            <TextBlock Text="{Binding Path=FirstName}" TextWrapping="Wrap" FontSize="24"/>

        </WrapPanel>
        <ListBox ItemsSource="{Binding Path=PhoneNumbers}" Grid.Column="2" d:DesignWidth="100" d:DesignHeight="50"
     Margin="8,0" Background="Transparent" BorderBrush="Transparent" IsHitTestVisible="False" HorizontalAlignment="Stretch"/>
    </Grid>
</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2008-09-25T20:45:33.467

我还必须设置：

```
HorizontalContentAlignment="Stretch" 
```

在包含`ListBox`.

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-01-15T10:40:34.147

```
<Grid.Width>
    <Binding Path="ActualWidth" 
             RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType={x:Type ScrollContentPresenter}}" />
</Grid.Width> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T20:15:52.323

好的，这就是你所拥有的：

第 0 列：`WrapPanel`
第 1 列：无
第 2 列：`ListBox`

听起来你想要`WrapPanel`在左边缘，`ListBox`在右边缘，以及空间来占据中间剩下的东西。

最简单的方法实际上是使用 a `DockPanel`，而不是 a `Grid`。

```
<DockPanel>
    <WrapPanel DockPanel.Dock="Left"></WrapPanel>
    <ListBox DockPanel.Dock="Right"></ListBox>
</DockPanel> 
```

`WrapPanel`这应该在和之间留下空白空间`ListBox`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-10T13:47:55.197

扩展 Taeke 的答案，设置`ScrollViewer.HorizontalScrollBarVisibility="Hidden"`a`ListBox`允许子控件采用父控件的宽度而不显示滚动条。

```
<ListBox Width="100" ScrollViewer.HorizontalScrollBarVisibility="Hidden">                
    <Label Content="{Binding Path=., Mode=OneWay}" HorizontalContentAlignment="Stretch" Height="30" Margin="-4,0,0,0" BorderThickness="0.5" BorderBrush="Black" FontFamily="Calibri" >
        <Label.Width>
            <Binding Path="Width" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBox}}" />
        </Label.Width>
    </Label>
</ListBox > 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T20:13:45.870

默认情况下`Grid`应该占据整个宽度，`ListBox`因为它的默认值`ItemsPanel`是 a `VirtualizingStackPanel`。我假设你**没有**改变`ListBox.ItemsPanel`。

也许如果你摆脱了中间`ColumnDefinition`（其他都是默认的`"*"`），并把`HorizontalAlignment="Left"`你的`WrapPanel`和电话号码`HorizontalAlignment="Right"`放在`ListBox`。您可能需要稍作修改`ListBox`才能使电话号码更加右对齐，例如为`DataTemplate`它们创建一个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T20:31:53.720

如果要使用 a `Grid`，则需要将`ColumnDefinition`s 更改为：

```
 <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions> 
```

如果您不需要使用 a `Grid`，那么您可以使用 a `DockPanel`：

```
 <DockPanel>
        <WrapPanel DockPanel.Dock="Left">
            <!--Some content here-->
            <TextBlock Text="{Binding Path=LastName}" TextWrapping="Wrap" FontSize="24"/>
            <TextBlock Text=", " TextWrapping="Wrap" FontSize="24"/>
            <TextBlock Text="{Binding Path=FirstName}" TextWrapping="Wrap" FontSize="24"/>
        </WrapPanel>
        <ListBox DockPanel.Dock="Right" ItemsSource="{Binding Path=PhoneNumbers}" 
 Margin="8,0" Background="Transparent" BorderBrush="Transparent" IsHitTestVisible="False"/>
        <TextBlock />
    </DockPanel> 
```

注意`TextBlock`最后的。任何`"DockPanel.Dock"`未定义的控件都将填充剩余空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-19T20:28:20.467

Taeke 的回答效果很好，根据 vancutterromney 的回答，您可以禁用水平滚动条以摆脱烦人的尺寸不匹配。但是，如果您确实想要两全其美 - 在不需要时删除滚动条，但在 ListBox 变得太小时自动启用它，您可以使用以下转换器：

```
/// <summary>
/// Value converter that adjusts the value of a double according to min and max limiting values, as well as an offset. These values are set by object configuration, handled in XAML resource definition.
/// </summary>
[ValueConversion(typeof(double), typeof(double))]
public sealed class DoubleLimiterConverter : IValueConverter
{
    /// <summary>
    /// Minimum value, if set. If not set, there is no minimum limit.
    /// </summary>
    public double? Min { get; set; }

    /// <summary>
    /// Maximum value, if set. If not set, there is no minimum limit.
    /// </summary>
    public double? Max { get; set; }

    /// <summary>
    /// Offset value to be applied after the limiting is done.
    /// </summary>
    public double Offset { get; set; }

    public static double _defaultFailureValue = 0;

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null || !(value is double))
            return _defaultFailureValue;

        double dValue = (double)value;
        double minimum = Min.HasValue ? Min.Value : double.NegativeInfinity;
        double maximum = Max.HasValue ? Max.Value : double.PositiveInfinity;
        double retVal = dValue.LimitToRange(minimum, maximum) + Offset;
        return retVal;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

然后根据所需的最大/最小值在 XAML 中定义它，以及处理其他答案中提到的烦人的 2 像素大小不匹配的偏移量：

```
<ListBox.Resources>
    <con:DoubleLimiterConverter x:Key="conDoubleLimiter" Min="450" Offset="-2"/>
</ListBox.Resources> 
```

然后在 Width 绑定中使用转换器：

```
<Grid.Width>
    <Binding Path="ActualWidth" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType={x:Type ScrollContentPresenter}}" Converter="{StaticResource conDoubleLimiter}"  />
</Grid.Width> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-22T22:03:28.387

Taeke 答案中的方法强制使用水平滚动条。这可以通过添加一个转换器来修复，以将网格的宽度减小垂直滚动条控件的宽度。

```
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;
using System.Windows.Markup;

namespace Converters
{
    public class ListBoxItemWidthConverter : MarkupExtension, IValueConverter
    {
        private static ListBoxItemWidthConverter _instance;

        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return System.Convert.ToInt32(value) - SystemParameters.VerticalScrollBarWidth;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion

        public override object ProvideValue(IServiceProvider serviceProvider)
        {
            return _instance ?? (_instance = new ListBoxItemWidthConverter());
        }
    }
} 
```

将命名空间添加到 XAML 的根节点。

```
xmlns:converters="clr-namespace:Converters" 
```

并更新网格宽度以使用转换器。

```
<Grid.Width>
    <Binding Path="ActualWidth" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType={x:Type ScrollContentPresenter}}" Converter="{converters:ListBoxItemWidthConverter}"/>
</Grid.Width> 
```

# tags - 如何在命令行上构建 Slickedit 标签？

> ID：135384
> 
> 赞同：1
> 
> 时间：2008-09-25T19:20:25.980
> 
> 标签：tags, slickedit

我希望能够在命令行上生成 slickedit 标签，只要我从修订控制同步项目 - 所以通过脚本。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T13:09:51.003

请参阅此主题[http://community.slickedit.com/index.php?topic=253.0](http://community.slickedit.com/index.php?topic=253.0)

# asp.net - 如何设计延迟样式/主题的 ASP.NET 网站？

> ID：135412
> 
> 赞同：3
> 
> 时间：2008-09-25T19:22:55.490
> 
> 标签：asp.net, prototype, themes, frontend

我需要为一个内网网站构建一个原型，我想专注于可用性（布局、导航等）并将主题留到以后（我的品味很差，所以这可能会由其他人完成）

我知道 ASP.NET 即时切换主题的能力，但我必须如何设计 WebForms 以便以后轻松使用？

*   我应该创建一个类属性指向未来css中存在的东西的控件吗？
*   还是我只是简单地创建控件而不用担心这个，当我们创建主题时它会很容易处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:52:01.023

如果您计划使用[ASP.NET 主题](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)，那么您可以通用地设计所有控件并在以后添加皮肤。根据设计的复杂性（意味着文本框或网格视图等有多少不同的样式），这可能不会为您节省大量工作，但这是使用内置 .Net 支持主题的一种方式。

确保您使用 MasterPage，以便您的所有子页面都有一个共同的基础，并为您的所有元素提供良好的 ID，因为您仍然需要使用 CSS 来将它们放在一起。

这是一个不错的[主题和皮肤教程](http://www.beansoftware.com/ASP.NET-Tutorials/Themes-Skins.aspx)的链接。知道将来您必须做什么才能将其添加进去，这将使现在为它进行设计变得更加容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T21:23:18.837

我想提出完全忽略主题并且只使用 CSS 的论点。我从来不清楚主题增加了什么价值。这是一种非常特定于 Microsoft 的方法，其输出并不总是符合标准。通过使用 CSS，您将扩大能够为您的项目工作的潜在设计师的范围，并且您将有更好的机会拥有一个跨浏览器和符合标准的网站。

如果其他人稍后要设计这个，我会确保你提供足够的“钩子”让他们能够设计这个。这意味着将 CSS 类添加到您所做的几乎所有将具有相似样式的操作中，并在适当的情况下使用 CSS 类将内容包装在 div 或 span 中，例如

```
 <div class="ButtonContainer">
       <asp:linkbutton runat="Server" cssclass="Button Cancel" command="Save" text="Save" />
       <asp:linkbutton runat="Server" cssclass="Button Save" command="Cancel" text="Cancel" />
     </div> 
```

但是，如果您对 CSS 没有扎实的了解，并且没有内部命名约定或标准样式表，那么您将不会真正知道如何构建您的 div 和类。在我们的商店中，我们处理这种情况的方式是程序员只编写标准的 ASP.NET 标记，而设计人员会检查并添加与他们将开发的样式表一起使用的 div、span 和类名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:04:19.870

皮肤可能是答案，但这让我感到厌烦（可能是因为我不喜欢成为特定于供应商的人，我希望我的技能适用于 .NET 以外的其他 Web 语言和平台）。我更喜欢在我的所有 ASP.Net 控件上使用 CssClass 属性，并对其他所有内容进行仔细分类，并尽可能多地使用语义标记。然后，当我设置好控件并开始工作时，我使用 CSS 来设置所有内容的样式（尽管此时我通常需要调整 HTML 和 JavaScript 的东西）。

与我一起工作的另一位开发人员更喜欢使用皮肤和页面指令等以 Microsoft 的方式完成所有工作。这可能是最好的方法，但在我看来，它将过多的演示文稿混合到应用程序的中间和后端。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-25T19:44:22.023

只需将控件包装在 div 中。最终将使布局/样式更容易

# certificate - XPI 签名 linux 无 gui

> ID：135416
> 
> 赞同：0
> 
> 时间：2008-09-25T19:23:29.687
> 
> 标签：certificate, signing, nss, xpi

我正在尝试使用从我的另一台服务器复制的 NSS cert db（cert8.db 和 key3.db）在 linux（无 gui）上签署 XPI，我可以在其上签署 XPI 就好了。

在新盒子上我可以用全新的测试证书签名，但是当我尝试使用旧的证书数据库时，它会抱怨：

signtool：问题签名数据（未知发行者）

Certutil 列出了我试图与 * 一起使用的证书，并且 CA 也存在于其中。

这个证书数据库可以在这样的计算机之间传输吗？还是我必须设置其他文件？

TIA 迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-28T21:26:25.877

我不确定这是否是您需要的，但这里是：[http ://www.mercille.org/snippets/xpiSigning.php](http://www.mercille.org/snippets/xpiSigning.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T11:45:39.437

如果证书链具有也需要存在的中间 CA。

NSS 在涉及到链时相当挑剔，并且还需要将证书标记为受信任。

# ruby-on-rails - Rails 和 Flex

> ID：135427
> 
> 赞同：3
> 
> 时间：2008-09-25T19:24:46.907
> 
> 标签：ruby-on-rails, ruby, apache-flex

关于使用 Flex 构建 RIA 以管理复杂的 Rails 应用程序的任何想法。

我们开始发现很难使用 ajax 来保持我们的管理部分直观且易于用户使用。

欢迎大家提出任何意见或建议

谢谢

多姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:35:27.163

你已经让 RoR 人员在这个程序上工作，并且你已经成功地开发了一个复杂的 rails 应用程序，它有足够的细微之处，以至于管理部分很难使用。

这个问题的答案是不要使用不同的编程语言来创建一个完全不同的应用程序来做管理员。

在简化和组织管理部分方面获得帮助将更有帮助。通过一些纸上的草图来更好地了解如何呈现这种复杂性，并可能在你进行过程中揭示复杂性。

复杂性通常通过使用向导或在您进行时显示子选项来处理。花一些时间和你的用户在一起，看着他们完成他们的任务。

有了更多细节，我可以用更多细节来编辑这个答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T22:01:47.373

尝试研究这本书：

[![灵活的导轨](https://manning.com/armstrong/armstrong_cover150.jpg)](http://www.flexiblerails.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T19:34:42.280

Flex 在您的场景中当然值得考虑。一般来说，Flex 是比 AJAX 更成熟的开发平台，因此如果您的服务器端数据通过一些合理的接口（Web 服务、REST-full 服务等）公开，那么构建 Flex 前端将是有意义的。

这真的取决于您的需求——Flex 与 AJAX 本身就是一个有趣的话题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T20:25:20.720

如果您想使用 XML 进行通信，那么在 rails 方面您不需要做太多事情。但是，如果您想使用 AMF 网关，您将需要检查 RubyAMF。

但是我同意 MattK，如果你只是想重新设计你的管理部分，那么在 Flex 中添加是不值得的。我认为你只需要做一些可用性测试，接受反馈并重构你的界面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T15:52:59.367

如果您已经有 Flex 开发人员，或者如果您可以将项目的这一部分外包出去，我只会考虑在您的情况下使用 Flex。Flex 模块只是调用 Web 服务（用 Ruby 或其他语言编写），因此项目的两个部分之间有很好的分离。由于这两个部分之间的接口是一个易于模拟的 Web 服务，因此外包效果很好。您应该有很多本地的网上商店可以处理这项工作。如果开发人员知识渊博，管理站点应该只需要两到三周就可以在 Flex 中开发。

# c# - 如何使用反射来调用私有方法？

> ID：135443
> 
> 赞同：358
> 
> 时间：2008-09-25T19:26:14.377
> 
> 标签：c#, .net, reflection, private-methods

我的类中有一组私有方法，我需要根据输入值动态调用一个。调用代码和目标方法都在同一个实例中。代码如下所示：

```
MethodInfo dynMethod = this.GetType().GetMethod("Draw_" + itemType);
dynMethod.Invoke(this, new object[] { methodParams }); 
```

在这种情况下，`GetMethod()`不会返回私有方法。`BindingFlags`我需要提供什么`GetMethod()`才能找到私有方法？

* * *

## 回答 #1

> 赞同：558
> 
> 时间：2008-09-25T19:33:11.583

只需更改您的代码以使用接受 BindingFlags 的重载[版本`GetMethod`](http://msdn.microsoft.com/en-us/library/system.type.getmethod.aspx)：

```
MethodInfo dynMethod = this.GetType().GetMethod("Draw_" + itemType, 
    BindingFlags.NonPublic | BindingFlags.Instance);
dynMethod.Invoke(this, new object[] { methodParams }); 
```

这是[BindingFlags 枚举文档](http://msdn.microsoft.com/en-us/library/system.reflection.bindingflags.aspx)。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2008-09-25T19:46:00.647

`BindingFlags.NonPublic`不会自行返回任何结果。事实证明，将它与它结合起来就可以`BindingFlags.Instance`了。

```
MethodInfo dynMethod = this.GetType().GetMethod("Draw_" + itemType, 
    BindingFlags.NonPublic | BindingFlags.Instance); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2014-08-20T22:27:50.603

如果你*真的*想让自己陷入困境，可以通过编写一个扩展方法让它更容易执行：

```
static class AccessExtensions
{
    public static object call(this object o, string methodName, params object[] args)
    {
        var mi = o.GetType ().GetMethod (methodName, System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance );
        if (mi != null) {
            return mi.Invoke (o, args);
        }
        return null;
    }
} 
```

和用法：

```
 class Counter
    {
        public int count { get; private set; }
        void incr(int value) { count += value; }
    }

    [Test]
    public void making_questionable_life_choices()
    {
        Counter c = new Counter ();
        c.call ("incr", 2);             // "incr" is private !
        c.call ("incr", 3);
        Assert.AreEqual (5, c.count);
    } 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2017-01-08T04:35:50.123

微软最近[修改了反射 API](https://blogs.msdn.microsoft.com/dotnet/2012/08/28/evolving-the-reflection-api/)，使这些答案中的大部分都过时了。以下内容应适用于现代平台（包括 Xamarin.Forms 和 UWP）：

```
obj.GetType().GetTypeInfo().GetDeclaredMethod("MethodName").Invoke(obj, yourArgsHere); 
```

或作为扩展方法：

```
public static object InvokeMethod<T>(this T obj, string methodName, params object[] args)
{
    var type = typeof(T);
    var method = type.GetTypeInfo().GetDeclaredMethod(methodName);
    return method.Invoke(obj, args);
} 
```

笔记：

*   如果所需的方法在泛型的超类中，`obj`则`T`必须将其显式设置为超类的类型。

*   如果该方法是异步的，您可以使用`await (Task) obj.InvokeMethod(…)`.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-25T19:29:42.963

您绝对确定这不能通过继承来完成吗？反射是解决问题时最不应该考虑的事情，它使重构、理解代码和任何自动化分析变得更加困难。

看起来你应该只有一个 DrawItem1、DrawItem2 等覆盖你的 dynMethod 的类。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-04-20T03:48:55.997

### 尤其是对私人成员的反思是错误的

*   **反射破坏了类型安全。**您可以尝试调用一个不存在的方法（不再存在），或者使用错误的参数，或者使用太多参数，或者不够......甚至是错误的顺序（这是我最喜欢的:)）。顺便说一句，返回类型也可以改变。
*   **反射很慢。**

**私有成员反射破坏了[封装](https://en.wikipedia.org/wiki/Encapsulation_(computer_programming))原则**，从而将您的代码暴露给以下内容：

*   **增加代码的复杂性**，因为它必须处理类的内部行为。隐藏的东西应该保持隐藏。
*   **使您的代码易于破解**，因为它可以编译，但如果方法更改其名称则不会运行。
*   **使私有代码易于破解**，因为如果它是私有的，则不打算以这种方式调用它。也许私有方法在被调用之前需要一些内部状态。

### 如果我必须这样做怎么办？

有这样的情况，当你依赖第三方或者你需要一些不暴露的api时，你必须做一些反思。有些人还使用它来测试他们拥有的一些类，但他们不想更改接口以访问内部成员只是为了进行测试。

### 如果你这样做，就做对

*   减轻易断：

为了缓解容易中断的问题，最好的办法是通过在将在持续集成构建等中运行的单元测试中进行测试来检测任何潜在的中断。当然，这意味着您始终使用相同的程序集（其中包含私有成员）。如果你使用动态加载和反射，你喜欢玩火，但你总是可以捕捉到调用可能产生的异常。

*   减轻反射的缓慢：

在最新版本的 .Net Framework 中，CreateDelegate 比 MethodInfo 调用高出 50 倍：

```
// The following should be done once since this does some reflection
var method = this.GetType().GetMethod("Draw_" + itemType, 
  BindingFlags.NonPublic | BindingFlags.Instance);

// Here we create a Func that targets the instance of type which has the 
// Draw_ItemType method
var draw = (Func<TInput, Output[]>)_method.CreateDelegate(
                 typeof(Func<TInput, TOutput[]>), this); 
```

`draw`调用将比`MethodInfo.Invoke` 使用`draw`这样的标准快约 50 倍`Func`：

```
var res = draw(methodParams); 
```

检查[我的这篇文章](https://stackoverflow.com/questions/31859016/is-the-use-of-dynamic-considered-a-bad-practice/32817143#32817143)以查看不同方法调用的基准

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-27T11:12:33.553

你能不能对你想要绘制的每种类型都有不同的 Draw 方法？然后调用重载的 Draw 方法传入要绘制的 itemType 类型的对象。

您的问题并不清楚 itemType 是否真正指代不同类型的对象。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-08T08:09:51.560

调用任何方法，尽管其对对象实例的保护级别。享受！

```
public static object InvokeMethod(object obj, string methodName, params object[] methodParams)
{
    var methodParamTypes = methodParams?.Select(p => p.GetType()).ToArray() ?? new Type[] { };
    var bindingFlags = BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance | BindingFlags.Static;
    MethodInfo method = null;
    var type = obj.GetType();
    while (method == null && type != null)
    {
        method = type.GetMethod(methodName, bindingFlags, Type.DefaultBinder, methodParamTypes, null);
        type = type.BaseType;
    }

    return method?.Invoke(obj, methodParams);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T19:28:52.997

我认为您可以将它传递*到*方法`BindingFlags.NonPublic`所在的位置。*`GetMethod`*

 ** * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-23T05:06:57.757

阅读此（补充）答案（有时是答案）以了解这是怎么回事以及**为什么**此线程中的某些人抱怨*“它仍然无法正常工作”*

[我写的代码与这里的答案之一完全相同](https://stackoverflow.com/a/25415496/1704458)。但我仍然有一个问题。我把断点放在

```
var mi = o.GetType().GetMethod(methodName, BindingFlags.NonPublic | BindingFlags.Instance ); 
```

它执行但`mi == null`

它继续这样的行为，直到我对所有涉及的项目进行了“重新构建”。当反射方法位于第三个程序集中时，我正在对一个程序集进行单元测试。这完全令人困惑，但我使用即时窗口来发现方法，我发现我尝试进行单元测试的私有方法有旧名称（我重命名了它）。这告诉我，即使单元测试项目构建，旧的程序集或 PDB 仍然存在 - 由于某种原因，它测试的项目没有构建。“重建”工作

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-27T11:43:53.890

应该注意的是，从派生类调用可能会出现问题。

容易出错：

```
this.GetType().GetMethod("PrivateTestMethod", BindingFlags.Instance | BindingFlags.NonPublic) 
```

正确的：

```
typeof(CurrentClass).GetMethod("PrivateTestMethod", BindingFlags.Instance | BindingFlags.NonPublic) 
```

# .net - 如何检测驱动器中是否有软盘？

> ID：135445
> 
> 赞同：5
> 
> 时间：2008-09-25T19:26:28.790
> 
> 标签：.net

我尝试使用 DriveInfo.IsReady，但如果驱动器中有未格式化的软盘，它会返回 false。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T20:17:37.030

您总是可以尝试从软盘中读取一个扇区，看看它是否成功。

我不知道如何在 .NET 中做到这一点，但这里是 C/C++ 等价物。

```
SetLastError(0);
HANDLE h = CreateFile("\\\\.\\A:", ...);
if (!ReadFile(h, buf, 512, &bytes_read, 0))
{
  DWORD err = GetLastError();
} 
```

[创建文件](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx),[读取文件](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:32:44.640

简单地说：你不能。软盘驱动器不支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:53:04.843

[DriveNotFoundException](http://msdn.microsoft.com/en-us/library/system.io.drivenotfoundexception.aspx)呢？

我目前使用的计算机中没有软盘驱动器，因此无法对其进行测试。当驱动器不可用时会引发此异常，我相信当软盘驱动器为空时会满足此条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:10:13.287

或许你可以看一下磁盘管理API……那应该可以告诉你磁盘的容量（无论是否格式化）……

如果没有容量，就没有插入软盘......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:16:49.870

捕获 DiscNotReady（对于驱动器中没有磁盘）和写入异常（对于无效文件系统/未格式化）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T21:18:26.807

乔纳斯的东西有效：

```
bool MyDll::Class1::HasFloppy( wchar_t driveLetter ) {
wchar_t path[] = L"\\\\.\\A:";
path[ 4 ] = driveLetter;

SetLastError( 0 );
HANDLE drive = CreateFile( path, //__in      LPCTSTR lpFileName,
           GENERIC_READ,     //__in      DWORD dwDesiredAccess,
           0,                //__in      DWORD dwShareMode,
           0,                //__in_opt  LPSECURITY_ATTRIBUTES lpSecurityAttributes,
           OPEN_EXISTING,    //__in      DWORD dwCreationDisposition,
           0,                //__in      DWORD dwFlagsAndAttributes,
           0                 //__in_opt  HANDLE hTemplateFile
);

DWORD bytes_read;
char buf[ 512 ];
DWORD err( 0 );
if( !ReadFile( drive, buf, 512, &bytes_read, 0 ) )
    err = GetLastError();

CloseHandle( drive );
return err != ERROR_NOT_READY; 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-04T06:12:54.013

如果您在软盘驱动器中插入一张未格式化的软盘，其目的通常是将该软盘驱动器与该软盘一起使用。第一步是在逻辑上格式化该软盘。

因此，如果您检测到一个未就绪的软盘驱动器，您可以尝试格式化该磁盘，如果成功，您的软盘驱动器应该准备就绪，其中包含一个新格式化的软盘。如果未就绪的软驱格式化失败，则说明里面没有软盘，或者里面的软盘有问题。然后您可以显示在驱动器中插入软盘的消息。

# javascript - 如何检查对象是否在 JavaScript 中具有特定属性？

> ID：135448
> 
> 赞同：1664
> 
> 时间：2008-09-25T19:27:06.980
> 
> 标签：javascript

如何检查对象是否在 JavaScript 中具有特定属性？

考虑：

```
x = {'key': 1};
if ( x.hasOwnProperty('key') ) {
    //Do this
} 
```

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：1525
> 
> 时间：2008-09-25T21:52:02.747

我真的对给出的答案感到困惑——其中大多数都是完全不正确的。当然，您可以拥有具有 undefined、null 或 false 值的对象属性。因此，简单地将属性检查减少到`typeof this[property]`甚至更糟，`x.key`会给您带来完全误导的结果。

这取决于你在寻找什么。如果您想知道一个对象是否在物理上包含一个属性（并且它不是来自原型链上的某个地方），那么`object.hasOwnProperty`就是要走的路。所有现代浏览器都支持它。（旧版本的 Safari - 2.0.1 和更早版本 - 但这些版本的浏览器已很少使用了。）

如果您要查找的是对象是否具有可迭代的属性（当您迭代对象的属性时，它会出现），那么执行：`prop in object`将为您提供所需的效果。

由于 using`hasOwnProperty`可能是您想要的，并且考虑到您可能需要一种备用方法，因此我向您提供以下解决方案：

```
var obj = {
    a: undefined,
    b: null,
    c: false
};

// a, b, c all found
for ( var prop in obj ) {
    document.writeln( "Object1: " + prop );
}

function Class(){
    this.a = undefined;
    this.b = null;
    this.c = false;
}

Class.prototype = {
    a: undefined,
    b: true,
    c: true,
    d: true,
    e: true
};

var obj2 = new Class();

// a, b, c, d, e found
for ( var prop in obj2 ) {
    document.writeln( "Object2: " + prop );
}

function hasOwnProperty(obj, prop) {
    var proto = obj.__proto__ || obj.constructor.prototype;
    return (prop in obj) &&
        (!(prop in proto) || proto[prop] !== obj[prop]);
}

if ( Object.prototype.hasOwnProperty ) {
    var hasOwnProperty = function(obj, prop) {
        return obj.hasOwnProperty(prop);
    }
}

// a, b, c found in modern browsers
// b, c found in Safari 2.0.1 and older
for ( var prop in obj2 ) {
    if ( hasOwnProperty(obj2, prop) ) {
        document.writeln( "Object2 w/ hasOwn: " + prop );
    }
} 
```

以上是一个有效的跨浏览器解决方案`hasOwnProperty`，但有一个警告：它无法区分原型和实例上的相同属性的情况 - 它只是假设它来自原型。您可以根据您的情况将其更改为更宽松或更严格，但至少这应该更有帮助。

* * *

## 回答 #2

> 赞同：318
> 
> 时间：2012-07-03T17:01:28.033

使用[Underscore.js](http://underscorejs.org/)或（[甚至更好](https://stackoverflow.com/questions/13789618/differences-between-lodash-and-underscore-js)）[Lodash](http://lodash.com/)：

```
_.has(x, 'key'); 
```

哪个调用`Object.prototype.hasOwnProperty`，但是 (a) 类型更短，并且 (b) 使用“安全引用`hasOwnProperty`”（即，即使`hasOwnProperty`被覆盖，它也可以工作）。

特别是，Lodash 定义`_.has`为：

```
function has(object, key) {
  return object ? hasOwnProperty.call(object, key) : false;
}
// hasOwnProperty = Object.prototype.hasOwnProperty 
```

* * *

## 回答 #3

> 赞同：188
> 
> 时间：2013-02-02T17:56:43.080

采用：

```
var x = {
  'key': 1
};

if ('key' in x) {
  console.log('has');
}
```

* * *

## 回答 #4

> 赞同：142
> 
> 时间：2008-09-25T19:48:46.163

**注意**：由于严格模式和`hasOwnProperty`. 正确的解决方案是使用严格模式并使用`obj.hasOwnProperty`. 这个答案*早于*这两件事，至少被广泛实施（是的，它已经那么老了）。将以下内容作为历史记录。

* * *

请记住，如果您不使用严格模式，那`undefined`（不幸的是）*不是JavaScript 中的保留字。*因此，某人（显然是其他人）可能有重新定义它的宏伟想法，从而破坏您的代码。

因此，更稳健的方法如下：

```
if (typeof(x.attribute) !== 'undefined') 
```

另一方面，这种方法更冗长，也更慢。：-/

一个常见的替代方法是确保它`undefined`实际上*是*未定义的，例如，将代码放入一个接受附加参数的函数中，称为`undefined`，它没有传递值。为确保它没有传递值，您可以立即自己调用它，例如：

```
(function (undefined) {
    … your code …
    if (x.attribute !== undefined)
        … mode code …
})(); 
```

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2008-09-25T19:32:29.960

```
if (x.key !== undefined) 
```

[Armin Ronacher](https://stackoverflow.com/users/19990/armin-ronacher)似乎已经[打败了我](https://stackoverflow.com/questions/135448/how-do-i-check-to-see-if-an-object-has-an-attribute-in-javascript#135466)，但是：

```
Object.prototype.hasOwnProperty = function(property) {
    return this[property] !== undefined;
};

x = {'key': 1};

if (x.hasOwnProperty('key')) {
    alert('have key!');
}

if (!x.hasOwnProperty('bar')) {
    alert('no bar!');
} 
```

[正如Konrad Rudolph](https://stackoverflow.com/users/1968/konrad-rudolph)和[Armin Ronacher](https://stackoverflow.com/users/19990/armin-ronacher)[所指出](https://stackoverflow.com/questions/135448/how-do-i-check-to-see-if-an-object-has-an-attribute-in-javascript#135568)的，一个更安全但更慢的解决方案是：

```
Object.prototype.hasOwnProperty = function(property) {
    return typeof this[property] !== 'undefined';
}; 
```

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2014-03-30T06:18:29.423

考虑 Javascript 中的以下对象

```
const x = {key: 1}; 
```

您可以使用`in`运算符来检查属性是否存在于对象上：

```
console.log("key" in x); 
```

您还可以使用循环遍历对象的所有属性`for - in`，然后检查特定属性：

```
for (const prop in x) {
    if (prop === "key") {
        //Do something
    }
} 
```

您必须考虑此对象属性是否可枚举，因为不可枚举的属性不会出现在`for-in`循环中。此外，如果可枚举属性遮蔽了原型的不可枚举属性，则它不会出现在[Internet Explorer 8](http://en.wikipedia.org/wiki/Internet_Explorer_8)和更早版本中。

如果您想要所有实例属性的列表，无论是否可枚举，您都可以使用

```
Object.getOwnPropertyNames(x); 
```

这将返回对象上存在的所有属性的名称数组。

[反射](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect)提供了可用于与 Javascript 对象交互的方法。静态`Reflect.has()`方法就像 in 运算符一样作为函数工作。

```
console.log(Reflect.has(x, 'key'));
// expected output: true

console.log(Reflect.has(x, 'key2'));
// expected output: false

console.log(Reflect.has(object1, 'toString'));
// expected output: true 
```

最后，您可以使用 typeof 运算符直接检查对象属性的数据类型：

```
if (typeof x.key === "undefined") {
    console.log("undefined");
} 
```

如果对象上不存在该属性，它将返回未定义的字符串。否则它将返回适当的属性类型。但是，请注意，这并不总是检查对象是否具有属性的有效方法，因为您可以将属性设置为未定义，在这种情况下， using`typeof x.key`仍然会返回 true（即使键仍然是在对象中）。

`undefined`同样，您可以通过直接与Javascript 属性进行比较来检查属性是否存在

```
if (x.key === undefined) {
    console.log("undefined");
} 
```

`undefined`除非在 x 对象上专门设置了键，否则这应该可以工作

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2008-09-26T09:16:31.790

让我们在这里消除一些混乱。首先，让我们通过假设`hasOwnProperty`已经存在来简化；当前使用的绝大多数浏览器都是如此。

`hasOwnProperty`如果传递给它的属性名称已添加到对象，则返回 true。它完全独立于分配给它的实际值，可能恰好是 `undefined`.

**因此：**

```
var o = {}
o.x = undefined

var a = o.hasOwnProperty('x')  // a is true
var b = o.x === undefined // b is also true 
```

**然而：**

```
var o = {}

var a = o.hasOwnProperty('x')  // a is now false
var b = o.x === undefined // b is still true 
```

问题是当原型链中的对象具有值为 undefined 的属性时会发生什么？`hasOwnProperty`将是错误的，`!== undefined`. 然而，`for..in`仍然会在枚举中列出它。

底线是没有跨浏览器的方式（因为 Internet Explorer 不公开`__prototype__`）来确定特定标识符尚未附加到对象或其原​​型链中的任何内容。

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2013-05-21T15:57:54.680

如果您正在搜索属性，那么*"no"*。你要：

```
if ('prop' in obj) { } 
```

通常，您不应该关心属性是来自原型还是来自对象。

但是，因为您在示例代码中使用了 'key'，所以看起来您将对象视为哈希，在这种情况下，您的答案是有意义的。所有哈希键都是对象中的属性，您可以避免原型贡献的额外属性。

[John Resig 的回答](https://stackoverflow.com/questions/135448/how-do-i-check-if-an-object-has-a-specific-property-in-javascript/136411#136411)非常全面，但我认为并不清楚。尤其是何时在 obj 中使用“'prop'”。

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2016-12-16T12:42:19.847

要测试简单对象，请使用：

```
if (obj[x] !== undefined) 
```

如果您不知道它是什么对象类型，请使用：

```
if (obj.hasOwnProperty(x)) 
```

所有其他选项都较慢...

### 细节

对 Node.js 下 100,000,000 次循环的性能评估，这里有其他人建议的五个选项：

```
function hasKey1(k,o) { return (x in obj); }
function hasKey2(k,o) { return (obj[x]); }
function hasKey3(k,o) { return (obj[x] !== undefined); }
function hasKey4(k,o) { return (typeof(obj[x]) !== 'undefined'); }
function hasKey5(k,o) { return (obj.hasOwnProperty(x)); } 
```

评估告诉我们，除非我们特别想检查对象的原型链以及对象本身，**否则我们不应该使用通用形式**：

```
if (X in Obj)... 
```

**根据用例，速度会慢 2 到 6 倍**

```
hasKey1 execution time: 4.51 s
hasKey2 execution time: 0.90 s
hasKey3 execution time: 0.76 s
hasKey4 execution time: 0.93 s
hasKey5 execution time: 2.15 s 
```

底线，如果您的 Obj 不一定是一个简单的对象，并且您希望避免检查对象的原型链并确保 x 直接归 Obj 所有，请使用`if (obj.hasOwnProperty(x))...`.

否则，当使用一个简单的对象而不担心对象的原型链时，使用`if (typeof(obj[x]) !== 'undefined')...`是最安全、最快的方法。

如果您使用一个简单的对象作为哈希表并且从不做任何古怪的事情，我会使用`if (obj[x])...`它，因为我发现它更具可读性。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-09-25T19:30:13.383

是的，它是:)我认为你也可以这样做`Object.prototype.hasOwnProperty.call(x, 'key')`，如果`x`有一个名为的属性也应该工作`hasOwnProperty`:)

但这会测试自己的属性。如果您想检查它是否具有也可能被继承的属性，您可以使用`typeof x.foo != 'undefined'`.

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2016-10-26T15:19:35.717

你也可以使用[ES6`Reflect`对象](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect)：

```
x = {'key': 1};
Reflect.has( x, 'key'); // returns true 
```

`Reflect.has`可以在[**此处**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect/has)找到有关 MDN 的文档。

> 静态`Reflect.has()`方法就像[in 运算符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in)一样作为函数工作。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2018-04-18T12:09:25.397

不要这样做`object.hasOwnProperty(key))`。这真的很糟糕，因为这些方法可能会被相关对象的属性所掩盖——考虑一下`{ hasOwnProperty: false }`——或者，该对象可能是一个空对象`(Object.create(null))`。

最好的方法是做`Object.prototype.hasOwnProperty.call(object, key)`或：

```
const has = Object.prototype.hasOwnProperty; // Cache the lookup once, in module scope.
console.log(has.call(object, key));
/* Or */
import has from 'has'; // https://www.npmjs.com/package/has
console.log(has(object, key)); 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2008-09-25T19:39:42.957

```
if(x.hasOwnProperty("key")){
  // …
} 
```

因为

```
if(x.key){
  // …
} 
```

如果`x.key`是 falsy 则失败（例如，`x.key === ""`）。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2008-09-25T19:39:07.107

好的，除非您不想要继承的属性，否则我似乎有正确的答案：

```
if (x.hasOwnProperty('key')) 
```

以下是包含继承属性的其他一些选项：

```
if (x.key) // Quick and dirty, but it does the same thing as below.

if (x.key !== undefined) 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2015-05-29T15:42:01.177

另一种相对简单的方法是使用[`Object.keys`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys). 这将返回一个`array`，这意味着您可以获得数组的所有功能。

```
var noInfo = {};
var info = {something: 'data'};

Object.keys(noInfo).length //returns 0 or false
Object.keys(info).length //returns 1 or true 
```

尽管我们所处的世界拥有强大的浏览器支持。因为这个问题太老了，我想我会添加这个：从[JavaScript v1.8.5 开始](http://kangax.github.io/compat-table/es5/#Object.keys)，这是安全的。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2015-09-24T17:32:29.693

hasOwnProperty *“可用于确定对象是否具有指定属性作为该对象的直接属性；**与 in 运算符不同**，此方法不会向下检查对象的原型链。”*

因此，最有可能的是，对于您的问题，您不想使用 hasOwnProperty，它确定属性是否**直接附加到对象本身**。

如果您想确定该属性是否存在于原型链中，您可能希望像这样使用它：

```
if (prop in object) { // Do something } 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2020-07-07T11:26:37.633

JavaScript 现在正在发展和成长，因为它现在有很好的甚至有效的方法来检查它。

**以下是检查对象是否具有特定属性**的一些简单方法：

1.  **使用`hasOwnProperty()`**

```
const hero = {
  name: 'Batman'
};

hero.hasOwnProperty('name');     // => true
hero.hasOwnProperty('realName'); // => false 
```

2.  **使用关键字/运算符`in`**

```
const hero = {
  name: 'Batman'
};

'name' in hero;     // => true
'realName' in hero; // => false 
```

3.  **与`undefined`关键字比较**

```
const hero = {
  name: 'Batman'
};

hero.name;     // => 'Batman'
hero.realName; // => undefined

// So consider this
hero.realName == undefined // => true (which means property does not exists in object)
hero.name == undefined // => false (which means that property exists in object) 
```

如需更多信息，请查看[此处](https://dmitripavlutin.com/check-if-object-has-property-javascript/#:%7E:text=The%20first%20way%20is%20to,own%20properties%20of%20the%20object.)。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2019-01-15T10:04:31.453

您可以使用以下方法 -

```
var obj = {a:1}
console.log('a' in obj)               // 1
console.log(obj.hasOwnProperty('a'))  // 2
console.log(Boolean(obj.a))         // 3 
```

以下方法之间的区别如下 -

1.  在第一种和第三种方法中，我们不仅在对象中搜索，而且也在其原型链中进行搜索。如果对象没有该属性，但该属性存在于它的原型链中，它将给出 true。

```
var obj = {
    a: 2,
    __proto__ : {b: 2}
}

console.log('b' in obj)
console.log(Boolean(obj.b))
```

2.  第二种方法将仅检查其自身的属性。例子 -

```
var obj = {
    a: 2,
    __proto__ : {b: 2}
}

console.log(obj.hasOwnProperty('b'))
```

3.  第一种和第三种方法的区别在于，如果有一个属性值未定义，则第三种方法将给出假，而第一种方法将给出真。

```
var obj = {
    b : undefined
}

console.log(Boolean(obj.b))
console.log('b' in obj);
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2021-06-02T18:24:02.827

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-07-12T14:47:46.590

这是针对特定情况的另一种选择。:)

如果您想测试对象上的成员并想知道它是否已设置为以下内容：

*   ''
*   错误的
*   空值
*   不明确的
*   0 ...

那么你可以使用：

```
var foo = {};
foo.bar = "Yes, this is a proper value!";
if (!!foo.bar) {
    // member is set, do something
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-12-17T15:36:14.263

# 表现

今天 2020.12.17，我在 Chrome v87、Safari v13.1.2 和 Firefox v83 上对 MacOs HighSierra 10.13.6 进行测试，以选择解决方案。

## 结果

我只比较解决方案 AF，因为它们为详细信息部分的片段中使用的所有大小写提供了有效结果。适用于所有浏览器

*   基于`in`(A) 的解决方案是快速或最快的
*   解决方案（E）对于大对象的 chrome 是最快的，如果 key 不存在，对于小数组的 firefox 是最快的
*   对于小型阵列，解决方案 (F) 最快（~ > 10 倍于其他解决方案）
*   解决方案（D，E）非常快
*   基于 losash `has`(B) 的解决方案是最慢的

[![在此处输入图像描述](https://i.stack.imgur.com/dmfF0.png)](https://i.stack.imgur.com/dmfF0.png)

## 细节

我执行 4 个测试用例：

*   当对象有 10 个字段并且搜索到的键存在时 - 你可以在[这里运行它](https://jsbench.me/0skirxvkqa/1)
*   当对象有 10 个字段并且搜索到的键不存在时 - 您可以在[此处运行它](https://jsbench.me/1akis0ltq7/1)
*   当对象有 10000 个字段并且存在搜索到的键时 - 您可以在[此处运行它](https://jsbench.me/69kirynokp/1)
*   当对象有 10000 个字段并且存在搜索到的键时 - 您可以在[此处运行它](https://jsbench.me/nakis0mx5m/1)

下面的片段显示了解决方案 [A](https://stackoverflow.com/a/14664748/860099) [B](https://stackoverflow.com/a/11315692/860099) [C](https://stackoverflow.com/a/40266120/860099) [D](https://stackoverflow.com/q/135448/860099) [E](https://stackoverflow.com/a/11315692/860099) [F](https://stackoverflow.com/a/136411/860099) [G](https://stackoverflow.com/a/135568/860099) [H](https://stackoverflow.com/a/22740939/860099) [I](https://stackoverflow.com/a/38332171/860099) [J](https://stackoverflow.com/a/41184688/860099) [K之间的差异](https://stackoverflow.com/a/54196605/860099)

```
// SO https://stackoverflow.com/q/135448/860099

// src: https://stackoverflow.com/a/14664748/860099
function A(x) {
  return 'key' in x
}

// src: https://stackoverflow.com/a/11315692/860099
function B(x) {
  return _.has(x, 'key')
}

// src: https://stackoverflow.com/a/40266120/860099
function C(x) {
  return Reflect.has( x, 'key')
}

// src: https://stackoverflow.com/q/135448/860099
function D(x) {
  return x.hasOwnProperty('key')
}

// src: https://stackoverflow.com/a/11315692/860099
function E(x) {
  return Object.prototype.hasOwnProperty.call(x, 'key')
}

// src: https://stackoverflow.com/a/136411/860099
function F(x) {
  function hasOwnProperty(obj, prop) {
      var proto = obj.__proto__ || obj.constructor.prototype;
      return (prop in obj) &&
          (!(prop in proto) || proto[prop] !== obj[prop]);
  }
  return hasOwnProperty(x,'key')
}

// src: https://stackoverflow.com/a/135568/860099
function G(x) {
  return typeof(x.key) !== 'undefined'
}

// src: https://stackoverflow.com/a/22740939/860099
function H(x) {
  return x.key !== undefined
}

// src: https://stackoverflow.com/a/38332171/860099
function I(x) {
  return !!x.key
}

// src: https://stackoverflow.com/a/41184688/860099
function J(x) {
  return !!x['key']
}

// src: https://stackoverflow.com/a/54196605/860099
function K(x) {
  return Boolean(x.key)
}

// --------------------
// TEST
// --------------------

let x1 = {'key': 1};
let x2 = {'key': "1"};
let x3 = {'key': true};
let x4 = {'key': []};
let x5 = {'key': {}};
let x6 = {'key': ()=>{}};
let x7 = {'key': ''};
let x8 = {'key': 0};
let x9 = {'key': false};
let x10= {'key': undefined};
let x11= {'nokey': 1};

let b= x=> x ? 1:0;

console.log('  1 2 3 4 5 6 7 8 9 10 11');

[A,B,C,D,E,F,G,H,I,J,K ].map(f=> {  
  console.log(
    `${f.name} ${b(f(x1))} ${b(f(x2))} ${b(f(x3))} ${b(f(x4))} ${b(f(x5))} ${b(f(x6))} ${b(f(x7))} ${b(f(x8))} ${b(f(x9))} ${b(f(x10))}  ${b(f(x11))} `
  )})

console.log('\nLegend: Columns (cases)');
console.log('1\.  key = 1 ');
console.log('2\.  key = "1" ');
console.log('3\.  key = true ');
console.log('4\.  key = [] ');
console.log('5\.  key = {} ');
console.log('6\.  key = ()=>{} ');
console.log('7\.  key = "" ');
console.log('8\.  key = 0 ');
console.log('9\.  key = false ');
console.log('10\. key = undefined ');
console.log('11\. no-key ');
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js" integrity="sha512-90vH1Z83AJY9DmlWa8WkjkV79yfS2n2Oxhsi2dZbIv0nC4E6m5AbH8Nh156kkM7JePmqD6tcZsfad1ueoaovww==" crossorigin="anonymous"> </script>

This shippet only presents functions used in performance tests - it not perform tests itself!
```

这是 chrome 的示例结果

[![在此处输入图像描述](https://i.stack.imgur.com/w18ak.png)](https://i.stack.imgur.com/w18ak.png)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-12-19T10:51:26.230

带有反射的 ECMAScript 6 解决方案。创建一个包装器，如：

```
/**
Gets an argument from array or object.
The possible outcome:
- If the key exists the value is returned.
- If no key exists the default value is returned.
- If no default value is specified an empty string is returned.
@param obj    The object or array to be searched.
@param key    The name of the property or key.
@param defVal Optional default version of the command-line parameter [default ""]
@return The default value in case of an error else the found parameter.
*/
function getSafeReflectArg( obj, key, defVal) {
   "use strict";
   var retVal = (typeof defVal === 'undefined' ? "" : defVal);
   if ( Reflect.has( obj, key) ) {
       return Reflect.get( obj, key);
   }
   return retVal;
}  // getSafeReflectArg 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-11-08T08:59:46.180

对象上存在一个方法“hasOwnProperty”，但不建议直接调用此方法，因为有时对象可能为空或对象上存在某些属性，例如：`{ hasOwnProperty: false }`

所以更好的方法是：

```
// Good
var obj = {"bar": "here bar desc"}
console.log(Object.prototype.hasOwnProperty.call(obj, "bar"));

// Best
const has = Object.prototype.hasOwnProperty; // Cache the lookup once, in module scope.
console.log(has.call(obj, "bar"));
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2021-07-01T00:48:27.807

**根据特定用例的一些更简单和简短的选项：**

1.  要检查属性是否存在，无论值如何，请使用[in 运算符（b 中的“a”）](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in)
2.  要检查变量的属性值，请使用[括号表示法 (obj[v])](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Property_Accessors#bracket_notation)
3.  要检查属性值是否真实，请使用[可选链接 (?.)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining)
4.  要检查属性值布尔值，请使用[double-not / bang-bang / (!!)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_NOT#double_not_!!)
5.  要为 null / undefined 检查设置默认值，请使用[nullish 合并运算符 (??)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)
6.  要为错误值检查设置默认值，请使用短路[逻辑 OR 运算符 (||)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)

运行代码片段以查看结果：

```
let obj1 = {prop:undefined};
console.log(1,"prop" in obj1);
console.log(1,obj1?.prop);

let obj2 = undefined;
//console.log(2,"prop" in obj2); would throw because obj2 undefined
console.log(2,"prop" in (obj2 ?? {}))
console.log(2,obj2?.prop);

let obj3 = {prop:false};
console.log(3,"prop" in obj3);
console.log(3,!!obj3?.prop);

let obj4 = {prop:null};
let look = "prop"
console.log(4,"prop" in obj4);
console.log(4,obj4?.[look]);

let obj5 = {prop:true};
console.log(5,"prop" in obj5);
console.log(5,obj5?.prop === true);

let obj6 = {otherProp:true};
look = "otherProp"
console.log(6,"prop" in obj6);
console.log(6,obj6.look); //should have used bracket notation

let obj7 = {prop:""};
console.log(7,"prop" in obj7);
console.log(7,obj7?.prop || "empty"); 
```

我看到很少有`hasOwn`正确使用的实例，特别是考虑到它的[继承问题](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty#direct_vs._inherited_properties)

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-09-14T13:59:18.620

你需要使用方法`object.hasOwnProperty(property)`。如果对象具有该属性，则返回 true；如果对象没有，则返回 false。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-02-23T11:49:06.083

展示如何使用[这个答案](https://stackoverflow.com/a/30533729/7765316)

```
const object= {key1: 'data', key2: 'data2'};

Object.keys(object).includes('key1') //returns true 
```

我们也可以使用`indexOf`，我更喜欢[包括](https://stackoverflow.com/a/45264728/7765316)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-04-16T06:31:55.190

**hasOwnProperty()**方法返回一个布尔值，指示对象是否具有指定的属性作为它自己的属性（而不是继承它）。

```
const object1 = {};
object1.property1 = 42;

console.log(object1.hasOwnProperty('property1'));
// expected output: true

console.log(object1.hasOwnProperty('toString'));
// expected output: false

console.log(object1.hasOwnProperty('hasOwnProperty'));
// expected output: false 
```

[了解更多](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-09-04T15:52:21.810

当你可以做的时候，不要把事情过度复杂化：

```
var isProperty =  (objectname.keyname || "") ? true : false; 
```

对于大多数情况来说，这很简单明了......

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-02-04T05:26:06.400

## 迭代对象自身属性的更好方法：

如果您想在不使用`hasOwnProperty()`检查的情况下迭代对象的属性，请使用`for(let key of Object.keys(stud)){}`方法：

```
for(let key of Object.keys(stud)){
  console.log(key); // will only log object's Own properties
} 
```

完整的示例和比较`for-in with hasOwnProperty()`

```
function Student() {
  this.name = "nitin";
}

Student.prototype = {
  grade: 'A'
}

let stud = new Student();

// for-in approach
for(let key in stud){
  if(stud.hasOwnProperty(key)){
    console.log(key); // only outputs "name"
  }
} 

//Object.keys() approach
for(let key of Object.keys(stud)){
  console.log(key);
} 
```

# c# - 我可以使用列表吗 作为方法指针的集合？（C＃）

> ID：135451
> 
> 赞同：6
> 
> 时间：2008-09-25T19:27:25.870
> 
> 标签：c#, generics, delegates

我想创建一个要执行的方法列表。每个方法都有相同的签名。我曾考虑将代表放在通用集合中，但我不断收到此错误：

> “方法”是一个“变量”，但用作“方法”

理论上，这是我想做的：

```
List<object> methodsToExecute;

int Add(int x, int y)
{ return x+y; }

int Subtract(int x, int y)
{ return x-y; }

delegate int BinaryOp(int x, int y);

methodsToExecute.add(new BinaryOp(add));
methodsToExecute.add(new BinaryOp(subtract));

foreach(object method in methodsToExecute)
{
    method(1,2);
} 
```

关于如何做到这一点的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T19:29:48.953

您需要将`object`列表中的 转换为 a `BinaryOp`，或者更好地为列表使用更具体的类型参数：

```
delegate int BinaryOp(int x, int y);

List<BinaryOp> methodsToExecute = new List<BinaryOp>();

methodsToExecute.add(Add);
methodsToExecute.add(Subtract);

foreach(BinaryOp method in methodsToExecute)
{
    method(1,2);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T19:32:31.897

使用 .NET 3.0（或 3.5？）您有通用委托。

试试这个：

```
List<Func<int, int, int>> methodsToExecute = new List<Func<int, int, int>>();

methodsToExecute.Add(Subtract);

methodsToExecute.Add[0](1,2); // equivalent to Subtract(1,2) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T19:34:26.027

```
List<Func<int, int, int>> n = new List<Func<int, int, int>>();
            n.Add((x, y) => x + y);
            n.Add((x, y) => x - y);
            n.ForEach(f => f.Invoke(1, 2)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T19:36:51.200

我更喜欢 Khoth 的实现，但我认为导致编译器错误的原因是在尝试调用它之前没有将方法转换为 BinaryOp。在您的 foreach 循环中，它只是一个“对象”。将您的 foreach 更改为看起来像 Khoth 的，我认为它会起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T20:44:07.777

每当我想做这样的事情时，我发现通常最好重构您的设计以使用命令模式，特别是因为您的所有方法都具有相同的参数。这种方式允许更大的灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T19:28:45.947

让它们都实现通用接口，比如 IExecuteable，然后有一个 List<IExecutable>

此外，使用代表：

```
class Example
{
    public delegate int AddDelegate(int x, int y);

    public List<AddDelegate> methods = new List<AddDelegate>();

    int Execute()
    {
        int sum = 0;
        foreach(AddDelegate method in methods)
        {
            sum+=method.Invoke(1, 2);
        }
        return sum;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T19:29:45.477

没有尝试过，但是使用 List< Action< t>> 类型应该可以做到。

# c - pthread_detach 会为我管理我的内存吗？

> ID：135458
> 
> 赞同：3
> 
> 时间：2008-09-25T19:29:13.400
> 
> 标签：c, multithreading, memory-management, malloc, pthreads

假设我有以下代码：

```
while(TRUE) {
  pthread_t *thread = (pthread_t *) malloc(sizeof(pthread_t));
  pthread_create(thread, NULL, someFunction, someArgument);
  pthread_detach(*thread);
  sleep(10);
} 
```

分离的线程会释放 malloc 分配的内存，还是我现在必须做的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T20:43:08.870

不， **pthread_create()**无法知道传递给它的**线程指针是动态分配的。**pthreads 在内部不使用这个值；它只是将新的线程 ID 返回给调用者。您不需要动态分配该值；您可以改为传递局部变量的地址：

```
pthread_t thread;
pthread_create(&thread, NULL, someFunction, someArgument); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T21:00:14.213

您需要自己释放内存。最好在堆栈上简单地分配 pthread_t 变量，而不是在堆上。

# c - 当您尝试在 c 中释放（）已经释放的内存时会发生什么？

> ID：135474
> 
> 赞同：35
> 
> 时间：2008-09-25T19:32:21.070
> 
> 标签：c, memory, memory-management

例如：

```
char * myString = malloc(sizeof(char)*STRING_BUFFER_SIZE);
free(myString);
free(myString); 
```

这样做有什么副作用吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-26T04:59:28.553

这是章节和经文。

> 如果 [函数] 的参数与、或 函数`free`先前返回的指针不匹配，或者如果空间已通过调用or被释放，则行为未定义。（[ISO 9899:1999 -](http://www.open-std.org/jtc1/sc22/wg14/www/standards)[*编程语言 - C*](http://www.open-std.org/jtc1/sc22/wg14/www/standards)，第 7.20.3.2 节）`calloc``malloc``realloc``free``realloc`[](http://www.open-std.org/jtc1/sc22/wg14/www/standards)

 ** * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-25T19:33:58.053

一无所有，无声内存损坏或分段错误。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-25T19:33:17.947

是的，您可能会收到导致程序崩溃的双重免费错误。它与 malloc 的内部数据结构有关，以跟踪分配的内存。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-25T19:44:49.107

答案总结：

是的，坏事可能而且很可能会发生。

为了防止这种情况发生：

```
free(myString);
myString = NULL; 
```

请注意，如果创建了其他内存，则必须将所有对内存的引用设置为`NULL`。

`free()`此外，使用 a调用`NULL`不会导致任何操作。欲了解更多信息，请参阅：[男人免费](http://linux.die.net/man/3/free)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-25T19:34:29.253

没那么聪明。谷歌双重免费漏洞。释放后将指针设置`NULL`为避免此类错误。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-25T19:33:45.793

根据你在哪个系统上运行它，什么都不会发生，程序会崩溃，内存会损坏，或者任何其他有趣的效果。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-08-28T19:35:22.960

它（可能）使[恶魔飞出你的鼻子](http://www.urbandictionary.com/define.php?term=nasal%20demons)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T19:36:20.983

释放后始终将指针设置为 NULL。尝试释放空指针是安全的。

值得编写自己的免费包装器来自动执行此操作。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T19:38:56.873

*坏事*（TM）

真的，我认为它是未定义的，所以任何事情都包括与 NORAD 的大型机玩“全球热核战争”

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-25T19:33:57.273

不要那样做。如果在对 的调用之间将释放的内存重新分配给其他东西`free`，那么事情就会变得一团糟。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-25T19:42:39.627

它可能会使您的程序崩溃、损坏内存或产生其他更微妙的负面影响。删除内存后，最好将其设置为 NULL (0)。试图释放一个空指针什么都不做，并且保证是安全的。这同样适用于 C++ 中的删除。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-26T04:43:55.207

简而言之：“未定义的行为”。

（现在，这可以包括什么以及为什么其他人已经说过了。我只是在这里值得一提这个词，因为它很常见）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-28T03:35:52.237

下面公认的奇怪宏是一个有用的替代品，可以消除几类安全漏洞并帮助调试，因为访问 free() 的区域更有可能发生段错误，而不是默默地破坏内存。

```
#define my_free(x) do { free(x); x = NULL; } while (0) 
```

do-while 循环是为了帮助周围的代码更容易地消化多语句。例如，如果（完成）my_free(x)；

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-08-26T13:07:46.097

**另一个有趣的情况：**

```
char * myString = malloc(sizeof(char)*STRING_BUFFER_SIZE);
char * yourString = myString;

if (myString)
{
    free(myString);
    myString = NULL;
}
// Now this one is safe, because we keep to the rule for 
// setting pointers to NULL after deletion ...
if (myString)
{
    free(myString);
    myString = NULL;
}

// But what about this one:
if (yourString)
{
    free(yourString);
    yourString = NULL;
}

//?!? :) 
```

# ajax - 您如何衡量 Web 服务调用的进度？

> ID：135478
> 
> 赞同：6
> 
> 时间：2008-09-25T19:32:37.730
> 
> 标签：ajax, web-services, asp.net-ajax, asynchronous

我有一个 ASP.NET Web 服务，它可以完成一些繁重的工作，比如一些文件操作，或者从一堆水晶报表生成 Excel 表格。我不想被调用这个 web 服务阻塞，所以我想让 web 服务调用异步。另外，我想从网页调用此 Web 服务，并希望有一些机制可以让我继续轮询服务器，以便我可以在屏幕上显示一些进度指示器，例如，已处理。请注意，我不想要 Web 方法调用完成时的通知，而是想要实时进度状态。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:36:14.960

在服务器上编写一个单独的方法，您可以通过传递已安排的作业的 ID 来查询该方法，该方法返回 0-100（或 0.0 和 1.0，或其他）之间的近似值，表示它的距离。

例如，在 REST 样式中，您可以发出一个 GET 请求，`http://yourserver.com/app/jobstatus/4133/`该请求将返回一个简单的 '52' 作为`text/plain`. 然后你只需要每隔（秒？两秒？十秒？）查询一次，看看它有多远。

您如何在后端实际完成监控很大程度上取决于您的流程是什么以及它是如何工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T19:47:23.467

我认为 XML Web 服务很慢，因此创建多个方法和**轮询**进度会**非常缓慢**，并且会在服务器上产生巨大的负载。我不会在生产环境中这样做。我发现数据库轮询存在相同（但更小）的问题。

请改用**SOAP 扩展**。它实现了一个事件驱动的模型。请参阅[MSDN 上的向 Web 服务客户端应用程序添加进度条](http://msdn.microsoft.com/en-us/library/aa480520.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T19:52:28.557

您还可以[使用 SoapExtensions](http://www.codeproject.com/KB/webservices/Soap_Extension_Progress.aspx)通知您的客户端下载/处理进度。然后服务器可以向客户端发送事件。如果您不使用客户端，则无需更改任何内容。

允许在您的客户端中执行以下操作：

```
//...
private localhost.MyWebServiceService _myWebService = new localhost.MyWebServiceService ();
_myWebService.processDelegate += ProgressUpdate;
_myWebService.CallHeavyMethod();
//...

private void ProgressUpdate(object sender, ProgressEventArgs e)
{
  double progress = ((double)e.ProcessedSize / (double)e.TotalSize) * 100.00;
  //Show Progress...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T19:34:00.207

让最初的“开始报告生成”Web 服务调用在某个任务池中创建一个任务，并向调用者返回该任务的 ID。

然后，提供另一种返回给定 taskId 的“完成百分比”的方法。

提供第三种方法，返回已完成任务的实际结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T19:35:01.407

最简单的方法是让 Web 服务根据调用的进度更新数据库中的字段，然后创建一个查询该字段并返回值的 Web 服务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T19:43:24.867

使 Web 服务返回某种任务 ID 或会话 ID。使用该 ID 创建另一个 Web 方法来查询，它返回所需的信息（完成百分比、文件列表等）。每隔一段时间从客户端轮询此方法。

使用数据库存储进程信息，如果您在 Web 服务的内存中执行此操作，这将无法在 Web 场环境中很好地扩展，因为该任务可能会在另一台服务器上运行，而不是您正在轮询的服务器。

编辑：我刚刚看到另一个类似的答案，并对其发表评论。评论者是对的 - 您可以使用内存表来避免磁盘操作，但仍然使用单独的数据库服务器。

# sharepoint - Sharepoint：在列表中部署自定义列表和新列

> ID：135496
> 
> 赞同：2
> 
> 时间：2008-09-25T19:35:06.290
> 
> 标签：sharepoint, deployment, list

我创建了一个自定义列表并在公告列表中添加了一个列。问题是，当我创建一个新的 Web 应用程序（如脚本、功能或其他东西）时，如何包含这些新创建的项目？

*附加信息*：就像您要从开发机器部署到登台或生产服务器时一样。我想要一个脚本或其他东西来更新我的生产服务器以将我添加到公告列表中的新列。就像 SQL Server 的 ALTER TABLE 命令更新 SQL Server 表一样。

Sharepoint 列表中是否有等价物？

蒂亚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T12:54:35.537

关于新的自定义列表，这可以使用功能来完成。有关更多信息，请参见[如何：创建自定义列表定义](http://msdn.microsoft.com/en-us/library/ms466023.aspx)。如果您是通过 SharePoint UI 创建的，则 Visual Studio Extensions for SharePoint ( [VS2005](http://www.microsoft.com/downloads/details.aspx?FamilyID=3E1DCCCD-1CCA-433A-BB4D-97B96BF7AB63) / [VS2008 ) 将帮助您提取列表定义。](http://www.microsoft.com/downloads/details.aspx?FamilyID=7bf65b28-06e2-4e87-9bad-086e32185e68)如果您有幸使用自定义站点定义并且尚未创建任何网站，则可以将站点定义设置为使用[功能装订](http://msdn.microsoft.com/en-us/library/bb861862.aspx)创建自定义列表。

如果您尝试将这些更改应用到已经存在的网站，您仍然可以使用一项功能来定义您的自定义列表。它只会显示为一种可以创建的列表。然后，要为现有网站自动创建自定义列表或修改现有列表（例如公告列表），您可以使用功能接收器。这允许您在激活该功能时运行任何自定义代码。有关详细信息，请参阅 MSDN 文章[功能事件](http://msdn.microsoft.com/en-us/library/ms469501.aspx)。

或者，您根本无法使用功能，因为它们可能很困难、耗时且痛苦。事实上，[这篇博](http://www.sharepointnutsandbolts.com/2008/09/sharepoint-dev-strategies-it-not-all.html)文有一个很好的反对这个想法的论据。您可以尝试该页面上提到的工具或其他应用程序，例如[DocAve Content Manager](http://www.avepoint.com/products/sharepoint-content-management)和[SharePoint Site Migration Manager](http://www.metalogix.net/products/migrationmanagersp/index.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T21:47:54.660

Your question is not very clear but I think you may want to look at Application Templates.

Microsoft provide 40 pre-built templates in the link below and the same technology is available to you. Links from this page should lead you to information showing you how you can crate your own.

Application Templates for Windows SharePoint Services 3.0 [http://technet.microsoft.com/en-us/windowsserver/sharepoint/bb407286.aspx](http://technet.microsoft.com/en-us/windowsserver/sharepoint/bb407286.aspx)

# wpf - 使用 WPF，更新自定义按钮控件背景的最佳方法是什么？

> ID：135518
> 
> 赞同：1
> 
> 时间：2008-09-25T19:39:51.893
> 
> 标签：wpf, button, triggers, mouseover

在 WPF 中，我们正在创建自定义控件，这些控件继承自具有完全从头开始绘制的 xaml 图形的按钮。我们在整个按钮 xaml 周围有一个边框，我们希望将其用作在触发器中 MouseOver=True 时更新背景的位置。我们需要知道的是，当鼠标悬停在这个按钮上时，我们如何用渐变来更新这个按钮的边框背景？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:59:26.557

在您的`ControlTemplate`中，给出`Border`a`Name`然后您可以在触发器中引用其可视化树的那一部分。这是重新设置 normal 样式的非常简短的示例`Button`：

```
<Style
    TargetType="{x:Type Button}">
    <Setter
        Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Border Name="customBorder"
                    CornerRadius="5"
                    BorderThickness="1"
                    BorderBrush="Black"
                    Background="{StaticResource normalButtonBG}">
                    <ContentPresenter
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center" />
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger
                        Property="IsMouseOver"
                        Value="True">
                        <Setter
                            TargetName="customBorder"
                            Property="Background"
                            Value="{StaticResource hoverButtonBG}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

如果这没有帮助，我们需要了解更多信息，可能会查看您自己的 XAML。您的描述并没有让我很清楚您的实际视觉树是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T20:24:35.017

你会想添加一个这样的触发器......

制作这样的样式：

```
<Style x:Key="ButtonTemplate"
             TargetType="{x:Type Button}">
    <Setter Property="Foreground"
                    Value="{StaticResource ButtonForeground}" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate
                TargetType="{x:Type Button}">
                <Grid
                    SnapsToDevicePixels="True"
                    Margin="0,0,0,0">
                    <Border Height="20"
                                    x:Name="ButtonBorder"
                                    BorderBrush="{DynamicResource BlackBorderBrush}">
                        <TextBlock x:Name="button"
                                             TextWrapping="Wrap"
                                             Text="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"
                                             SnapsToDevicePixels="True"
                                             Foreground="#FFFFFFFF"
                                             Margin="6,0,0,0"
                                             VerticalAlignment="Center"/>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <!-- Disabled -->
                    <Trigger Property="IsMouseOver"
                                     Value="True">
                        <Setter TargetName="ButtonBorder"
                                        Property="Background"
                                        Value="{DynamicResource ButtonBackgroundMouseOver}" />
                        <Setter TargetName="ButtonBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource ButtonBorderMouseOver}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后为渐变添加一些资源，如下所示：

```
<LinearGradientBrush x:Key="ButtonBackgroundMouseOver"
                                         EndPoint="0.5,1"
                                         StartPoint="0.5,0">
    <GradientStop Color="#FF000000"
                                Offset="0.432"/>
    <GradientStop Color="#FF808080"
                                Offset="0.9"/>
    <GradientStop Color="#FF848484"
                                Offset="0.044"/>
    <GradientStop Color="#FF787878"
                                Offset="0.308"/>
    <GradientStop Color="#FF212121"
                                Offset="0.676"/>
</LinearGradientBrush> 
```

如果您需要更多帮助，请告诉我。

# sql - 在 Access 2003 中，当且仅当 PK 上有过滤器并且连接了子查询时，备注字段才会出现问题

> ID：135526
> 
> 赞同：0
> 
> 时间：2008-09-25T19:40:36.290
> 
> 标签：sql, ms-access

我在 Acess 2003 (SP3) 的查询中遇到问题。

我有一个查询，其中包括一些表和一个子查询。子查询和表都连接到主表。该查询使用一些聚合函数，并且有一个 HAVING 子句过滤主键 (PK) 上的结果。

在这些情况下，主表的备注字段无法正确显示。显示两个垃圾字符，永远不会相同，而不是字段的内容。

现在奇怪的是，如果我删除 HAVING 子句，或者如果我使用它来过滤除 PK 之外的其他内容，该字段将正确显示。如果我从查询中删除子查询，即使 PK 上仍有过滤器（HAVING 子句），该字段也会正确显示。

这是 Access 中的错误吗（我认为是）？如果是这样，有人知道这个错误的解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T20:45:06.307

MSAccess 备注字段在 GROUP BY 查询中被截断为 255 个字符（在 Access 2000 之前，根本不起作用）。但是，要解决明显的错误，请尝试以下操作：

**代替*MemoField*  使用  *Left([MemoField,255)***

# sql - 如果不使用所有列，是否会使用我的索引？

> ID：135530
> 
> 赞同：20
> 
> 时间：2008-09-25T19:42:28.220
> 
> 标签：sql, sql-server, sql-execution-plan

我在表 T 的 A、B、C、D 列上有一个索引

我有一个查询，它从 WHERE 子句中的 A、B、C 中提取。

将使用该索引还是需要一个仅包含 A、B、C 的单独索引？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T20:11:25.327

David B 是正确的，您应该检查执行计划以验证正在使用的索引。

> 将使用该索引还是需要一个仅包含 A、B、C 的单独索引？

要回答问题的最后一部分，我认为这是核心的基础主题（与直接解决方案相反），*几乎*没有理由对索引列的子集进行索引。如果您的索引是 (A, B, C, D)，则针对 (A, B, C) 的 WHERE 很可能会导致索引**搜索**，这是理想的情况 - 索引包含引擎需要的所有信息直接进入结果集。我相信这适用于数字类型和字符串类型中的相等性测试，尽管它可以用 LIKE '%'s 分解）。另一方面，如果您的 WHERE 仅引用了 D，那么您很可能会以索引**扫描结束**，这意味着 SQL 引擎必须扫描 A、B 和 C 的所有组合，然后检查 D 是否满足您的条件，然后再决定是否将该行添加到结果集中。在一个特别大的表上，当我发现自己必须对“D”列进行大量查询时，我只为 D 添加了一个额外的索引，并且看到了大约 90% 的性能提升。

编辑：我还应该推荐在 SQL Management Studio 中使用数据库引擎优化顾问。它会告诉您您的表是否没有理想地为您要运行的查询建立索引。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T19:49:20.920

这取决于！

```
WHERE A like '%x%'
  and B = 1
  and C = 1
//
WHERE A = 1
  OR B = 1
  OR C = 1
//
WHERE DateAdd(dd, 1, A) = '2008-01-01'
  AND B = 1
  AND C = 1 
```

这些都不会依赖索引，因为索引没有用。

单击“显示估计的执行计划”以确认潜在的索引使用情况。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T19:45:54.127

在 Oracle 数据库中，这称为[复合索引](https://docs.oracle.com/database/121/CNCPT/indexiot.htm#CNCPT88833)（12g 文档但对早期版本有效）

> 复合索引可以加快 SELECT 语句的数据检索，其中 WHERE 子句引用复合索引中列的所有前导部分。因此，定义中使用的列的顺序很重要。通常，最常访问的列排在最前面。

所以在你的情况下，是的。该索引将/可以使用。这可以通过使用解释计划来验证。

如果 MS SQLSERVER 不同（我怀疑它可能），您将需要一个新的答案。

**编辑：** 还应该提到它只会**考虑**使用索引..这并不一定意味着它会使用它。

**Edit2：** Oracle 11g 及更高版本现在有一个选项，允许它跳过索引中的列。因此对 A、B 和 D 的查询可能仍会使用索引

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T19:49:24.727

将使用索引，是的。哪些索引会产生更优化的查询计划是相当聪明的，它应该没有问题。

与这类事情一样，不要相信我的话 - 对其进行基准测试。创建一个表，用代表性数据填充它，查询它，索引它，然后再次查询它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T19:56:31.200

索引包含查询中未使用的列这一事实不会阻止它被使用。

这并不是说它肯定**会**被使用，它可能由于不同的原因而被忽略（可能是因为一个或多个其他索引更有用）。

与往常一样，对估计的执行计划进行调查，看看可能会发生什么。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T19:57:16.237

从简单的等号查找开始（WHERE A=1 and B='Red' and C=287）是的，索引将（最有可能）被使用。索引将首先用于帮助优化器“猜测”与选择匹配的行数，然后再实际访问这些行。

作为对 David B 关于“like”谓词的评论的回应，SQLServer 可能仍会使用索引，这取决于您选择的内容。例如，如果您选择 count(*)，那么 SQLServer 可能会扫描索引并计算与 where 子句匹配的命中，因为索引较小并且需要扫描的 IO 较少。即使您从基表中选择一些列，它也可能决定这样做，这取决于 SQLServer 对索引的选择性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T20:06:22.750

一般来说，是的，所有现代数据库都足够聪明地做到这一点。也有例外，例如，如果表上的统计数据显示其中的数据量足够小，以致全表读取效率更高，那么索引将被打折，但作为一项规则，您可以依赖它在适当情况下。

因此，您可以在设计索引时利用这一点。举例来说，我有一个表，其中包含 A、B、C 作为键值，列 Y 和 Z 包含我知道将经常被语句检索的数据

```
SELECT Y FROM table WHERE A = alpha and B = beta and C = gamma 

SELECT Z FROM table WHERE A = alpha and B = beta and C = gamma 
```

我通常会在 A、B、C、X、Z 上创建一个索引——假设 X 和 Z 是一些相当小的字段。这样做的原因是我知道上面语句中的访问路径将使用索引，并且*由于我要检索的数据已经在读取的索引中，*因此不需要单独读取检索表数据本身所需的数据块将需要。在某些情况下，此策略可以显着加快数据检索速度。当然，您需要为更新成本和磁盘空间付费，因此您需要在应用它之前了解您的数据库在做什么，但由于在大多数数据库中读取次数大大超过写入次数，因此通常值得考虑。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T21:15:43.020

这是另一个“取决于”答案……它还取决于您的桌子有多大……

我同意其他所有提到检查执行计划以验证您的索引是否正在使用的人的观点。

这里有几篇关于阅读执行计划的文章，你会觉得它们很有用：

[http://www.sqlservercentral.com/articles/Administering/executionplans/1345/](http://www.sqlservercentral.com/articles/Administering/executionplans/1345/) [http://www.codeproject.com/KB/database/sql-tuning-tutorial-1.aspx](http://www.codeproject.com/KB/database/sql-tuning-tutorial-1.aspx)

还有一篇关于搜索与扫描的好文章，我推荐：http: [//blogs.msdn.com/craigfr/archive/2006/06/26/647852.aspx](http://blogs.msdn.com/craigfr/archive/2006/06/26/647852.aspx)

Craig Freedman 的博客上有一篇好文章，这里还有一篇你应该会觉得有用的文章。本文是关于 SQL Server 用于确定要使用哪个索引的一些因素...

[http://blogs.msdn.com/craigfr/archive/2006/07/13/664902.aspx](http://blogs.msdn.com/craigfr/archive/2006/07/13/664902.aspx)

小心！杰夫

# integration - MS CRM 开发项目

> ID：135533
> 
> 赞同：0
> 
> 时间：2008-09-25T19:42:42.947
> 
> 标签：integration, dynamics-crm

我兼职工作的商店是 Microsoft CRM 的新手。我只是想调查一下开发人员对系统做了哪些项目来扩展其功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T19:45:59.960

我用 CRM 3.0 做了一些工作。我的工作增强了程序并将其变成了一个文档管理应用程序，您可以在其中根据案例、联系人、客户、供应商等扫描和上传文档。当时的 .NET SDK 可能需要更多的工作，但我听说使用更新版本的 CRM，它变得更好了。CRM 允许附件，但不是在所有级别，更多的是在案例级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:37:48.613

[我（和其他人）已经为 Web 服务层http://www.codeplex.com/LinqtoCRM](http://www.codeplex.com/LinqtoCRM)实现了一个 LINQ 查询提供程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T07:28:39.690

我可以将我所做的工作分为四个部分：

*   Tailoring - 简单的字段级别更改。其中很多只是确保领域和语言适合我正在开发的业务。

*   自定义 - 更复杂的更改，通常需要 JavaScript 和 ASP.NET。一些示例是使用 IFrame 并将值从 CRM 表单传递给它。然后，IFrame 会做一些有趣的事情，比如映射、制图或给你做其他事情的按钮。对于按钮，我经常会使用 JavaScript 替换 IFRAME 的 HTML dom 中的 outerHTML 来显示按钮。

*   集成 - 使用 .NET 将 MSCRM 连接到其他系统。将它连接到 Great Plains、Speech Server、SCOM（当时称为 MOM）、自定义 LOB 系统等...我所做的一个有趣的事情是开发一个 SSIS 组件，该组件通过 Web 服务写入 MSCRM。

*   报告 - 构建报告。在报告服务和 Excel 中。Excel 因其动态更新特性而适用于出色的仪表板。如果您有兴趣，我在[http://www.sadev.co.za/taxonomy/term/7](http://www.sadev.co.za/taxonomy/term/7)
    上有一些（战争）故事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T09:07:16.677

我们扩展了 3.0 以发送短信而不是电子邮件。不过，现在有可用的工具（至少 4.0 版）可以做到这一点。

我们还将它扩展到将服务预约推送到 Exchange，因为由于员工大多是移动的，他们没有 Outlook 的 CRM 客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-29T00:38:50.847

尚未提及的另外两个主要开发领域是插件和自定义工作流程序集。

插件允许您拦截 CRM 处理的许多消息以插入自定义逻辑。这给您带来无穷无尽的可能性，因为您可以拦截各种消息，包括创建、更新、删除，甚至阅读！

自定义工作流程序集是您向 CRM 注册并与 CRM 的工作流 UI 集成的程序集。通常，他们执行在修改表单数据时很有用的简单任务。其他时候，它们更复杂，例如发送状态报告。

[![在环境中注册的自定义工作流程序集的屏幕截图](https://i.stack.imgur.com/7IOM7.jpg)](https://i.stack.imgur.com/7IOM7.jpg)

自定义工作流程序集始终列在本机选项下方。在屏幕截图中，“停止工作流”下方的所有内容都是通过自定义工作流程序集添加的。

# java - 您将如何轻松验证 JSP 选项选择列表？

> ID：135534
> 
> 赞同：1
> 
> 时间：2008-09-25T19:42:50.343
> 
> 标签：java, validation, jsp, xhtml, forms

我需要验证这个简单的选择列表：

```
<select name="<%= key %>">
    <option value="ETC" SELECTED>Select an option...</option>
    <option value="ONE">Lorem ipsum</option>
    <option value="TWO">dolor sit amet</option>
</select> 
```

因此，用户永远不会在提交表单时选择“选择一个选项...”选项，请原谅重复。原则上我可以使用 JavaScript，但学习如何在 JSP 中解决它也会很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T20:24:26.373

您永远无法真正满足“从不提交给定值”的条件，因为您无法控制客户端。用户总是可以操纵 HTML 来提交他们想要的任何东西。

一个很好的方法是使用 JavaScript 进行客户端验证并给用户快速反馈并捕获 99%+ 的案例，然后对提交的参数进行服务器端验证以捕获少数没有启用 JS 或操纵 HTML 以提交非预期值。

请记住，客户端验证是可选的，并且对于那些“常见错误”输入验证很有用，但是服务器端验证对于所有输入都是强制性的，无论是否对给定的输入进行了任何客户端检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T20:48:08.143

现在，您通常不在 JSP 中进行验证，因为它们只可视化之前处理的任何内容。因此，您“在 jsps 中”进行的唯一验证通常是 Javascript。对于其余的（真正的验证），我支持 Pete 的回答：你必须在服务器端使用你在那里使用的任何技术。当它再次显示在 JSP 中时，验证已有望完成。

正如我所说的“现在”：当 JSP 是一个闪亮的新概念时，在 JSP 的边界内完成了更多工作，有时甚至将表单发布到 JSP。*在那个时候，如何*验证更加不标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T10:59:51.793

JSP 是 MVC 模式中的“视图”，因此只能用于向用户呈现数据。任何应用程序逻辑，包括验证逻辑，都应该在服务器端完成。如果这个 JSP 打算成为大型应用程序的一部分，我建议使用 Spring MVC 来设置您的应用程序，并编写一个验证器来验证输入。但即使我们在这里不讨论一些大型应用程序，验证仍应在服务器端完成，正如我之前的其他人已经指出的那样。

# php - OO编程有什么好处？它会帮助我编写更好的代码吗？

> ID：135535
> 
> 赞同：28
> 
> 时间：2008-09-25T19:42:52.340
> 
> 标签：php, oop

我是一名 PHPer，并且不编写面向对象的代码。

OO 与过程代码相比有哪些优势，我在哪里可以学习如何将这些想法应用于 PHP？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-25T19:59:02.253

**它不会自动为您提供帮助。**您可以编写比结构化程序更糟糕的“OO”程序，反之亦然。OOP 是一种工具，可让您创建更强大的抽象。

*   与每个强大的工具一样，您必须正确使用它。
*   与每个强大的工具一样，学习如何正确使用它需要时间。
*   与每个强大的工具一样，您会犯错误。
*   与每一个强大的工具一样，您必须进行大量练习。
*   与每个强大的工具一样，您应该阅读很多关于它的内容，并阅读其他人的想法。向他人学习。
*   但是，就像每一个强大的工具一样，也有人滥用它。学会不向他们学习不良做法。这很难。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-25T19:45:26.327

对象有助于使您的代码在不同部分之间保持隔离，因此如果您需要对一个部分进行更改，您可以确信它不会影响其他部分：松散耦合。

然后，当您这样做一段时间后，您会开始发现为一个应用程序创建的对象在其他应用程序中也很有用，并且您也开始获得更好的代码重用。因此，新应用程序已经完成了部分工作，并且正在使用经过时间考验的代码：软件构建速度更快，错误更少。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-25T19:47:20.050

人们会从不同的角度告诉你关于 OOP 的各种事情。但是如果你想形成自己的观点，而不是接受别人的观点，那么我建议阅读 Bertrand Meyer 的“面向对象的软件构建”。

从本质上讲，他采用了非 OOP 编程技术，并分析了它们的基本缺陷。然后，他推导出了一种替代技术来解决这些缺陷。换句话说，他从第一原则推导出 OOP。这是一部了不起的作品，非常令人信服。

阅读它，你会以一种你可以推理支持的方式了解原因、时间和内容。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-25T20:03:16.330

对象有助于封装复杂性。对于大多数 PHP 编程，不可能为任何相当复杂的应用程序编写好的、干净的代码。编写 OO PHP 可帮助您将代码放入自己的盒子中，将其与其他所有内容隔离开来。这有几个好处。

1.  只要您的对象具有明确定义的输入和输出，对象执行其操作的方式就完全无关紧要 - 存储/检索数据可以从平面文件到 XML 到内存缓存到 MySQL 到 Oracle，而且您只有必须关注一个单一的对象。
2.  只要您的对象具有明确定义的输入和输出，您就可以将其完全替换为具有相同输入/输出的另一个对象。在运行时决定是否需要 MySQL、Postgres、memcached 或 HTTP POST/GET 请求到印度尼西亚的粗略服务器。
3.  OO 使单元测试更容易。如果您可以定义特定对象应该做什么（即对于给定的输入它应该给您什么结果），那么您可以轻松编写代码来针对该代码测试数千个值并检查结果，您将立即知道是否有什么休息。
4.  您在对象中“隐藏”的代码越多，您在使用该功能时必须看到的代码就越少。`Poll::Display()`我曾经用 PHP 编写过一个投票应用程序，它处理投票的所有方面——数据库交互、投票生成、投票、排名、排序和显示——我只需要在我的网站上写一行代码（应用程序可以做到——这使得维护我的主页变得更加容易。

请记住一件事——与 Python 或 Ruby 等语言相比，PHP（甚至 PHP5）中的 OO 并不是很好的 OO。Python 中的一切皆为对象的模型让我真正喜欢 OO 编程 - 作为一名前 PHP 程序员（和双重认证的 Zend 工程师），如果你想了解什么是 OO，我强烈建议探索 Python 的 OO是所有关于。至少它将帮助您编写更好的 PHP 代码。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-25T19:51:19.743

是的，如果你真的明白了。

它可以帮助您可视化更大系统的各个部分如何相互交互。它在设计层面非常有用。

如果您只是编写几行代码，您将获得的唯一好处是使用分解为精心设计的对象的库通常比仅使用函数更容易一些。

要充分利用它，您还需要遵循健全的 OO 设计实践。始终封装所有数据，使用许多小类，而不是大的“包罗万象”类。让班级为你做你的工作，而不是要求它提供数据并在课堂外做工作等。

它可能暂时不会对您有太大帮助，如果您总是在做小型网站，可能永远不会（我不能肯定地说，我不真正做 php），但随着时间的推移和大型项目它可以是无价的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-25T20:25:17.777

没有人提到的一件事是 OO 代码有助于编写可读的代码：

```
sherry.changePhoneNumber();
phoneCompany.assignNewPhoneNumberTo(sherry);
sherry.receive(new PhoneNumber().withAreaCode("555").withNumber("194-2677")); 
```

我从这种美学中得到一种[奇怪的满足。](http://moffdub.wordpress.com/2008/09/23/i-feel-like-i-need-to-scrub-myself/)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-09T02:58:15.563

对我来说最大的胜利是继承，或者使一个对象的行为几乎与另一个对象完全一样，但有一些不同。这是我办公室的一个真实示例：

我们需要代码来处理客户发送给我们的 TIFF 文件，将它们转换为标准格式，将有关文件的一些信息插入数据库，然后发送结果电子邮件。我在一组类中编写了这个（在 Python 中，但想法是一样的）。“fetcher”类从 POP3 邮箱中获取电子邮件并将它们交给一个“container”类，该类知道如何从电子邮件中读取附件。该类将每个图像传递给执行必要处理的“文件对象”类。

好吧，有一天我们有一位客户想要发送 PDF 文件。我对“TIFF 文件对象”类进行了子类化，并重写了“规范化”函数以将 PDF 作为输入，但其他所有代码都保持不变。它第一次奏效，我很高兴。

更改我们的邮件服务器意味着我需要通过 IMAP 获取电子邮件。再次，我将“POP3 fetcher”子类化，以便它可以使用 IMAP。问题解决了。

另一个客户想给我们邮寄 CD，所以我将“电子邮件容器”类与“文件系统目录”类子类化。瞧——完成了。

在每种情况下，新代码都与旧代码有 95% 的相似性。例如，“TIFF 文件对象”类有大约 15 个方法。“PDF 文件对象”类恰好定义了一个：将特定格式的文件转换为我们的标准的方法。它从其父类获得的所有其他内容。

现在，你绝对可以在程序上做同样的事情，比如写：

```
if fileobjecttype == 'TIFF':
    data = <snip 30 lines of code to read and convert a TIFF file>
elif fileobjecttype == 'PDF':
    data = <another 45 lines to read a PDF>
elif fileobjecttype == 'PNG':
    data = <yep, another one> 
```

最大的不同是我相信你可以让 OOP 看起来更干净、更有条理。我的 PDF 类看起来像：

```
class PDFReader(GenericImageReader):
    def normalize(self):
        data = <45 lines to read a PDF> 
```

就是这样。你一眼就能看出它只做一件不同于它所继承的类的事情。它还迫使你——或者至少强烈鼓励你——在应用程序的各层之间建立干净的接口。在我的示例中，PDFReader 不知道也不关心它的图像是来自 POP3 邮箱还是来自 CD-ROM。POP3 fetcher 对附件一无所知，因为它的工作只是获取电子邮件并传递它们。在实践中，这使我们能够以绝对最少的编码或重新设计量做一些非常了不起的事情。

OOP 并不神奇，但它是保持代码井井有条的一种非常棒的方式。即使你不到处使用它，它仍然是你真正应该发展的技能。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-25T19:51:44.923

有一段时间，当我第一次开始编程时，我编写了面向用户的代码。它工作得很好，但很难维护。

然后，我学会了面向对象，我写的代码变得更容易维护，更容易在项目之间共享，生活也很美好……除了我的用户之外的每个人。

现在，我知道了计算机编程的真正灵丹妙药。我编写 OO 代码，但首先我将*我的用户对象化*。将人视为对象一开始可能看起来很粗鲁，但它让一切变得更加优雅——你可以编写*所有*软件来使用明确定义的界面，当用户发送意外消息时，你可以忽略它，或者，如果标有表示足够重要性的标志，则向它们抛出异常。

有OO的生活是美好的……

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-21T05:34:02.117

我认为 OOP 适合那些在“对象”中思考的人，其中对象由数据以及对这些数据进行操作的函数组成。

*   如果您倾向于将函数和它们操作的数据视为独立的事物，那么您就是过程程序员。
*   如果你倾向于认为函数和它们操作的数据是相互连接的，那么你就是一个面向对象的程序员。

我会告诫不要出去学习*模式*。为了做好面向对象的编程，你需要教自己像面向对象的程序员一样*思考。*您需要达到您理解并能说出以下好处的程度：

*   封装
*   类与实例/对象
*   继承和多态

它只会帮助你成为一个更好的程序员，因为程序员知道的编程风格越多，他解决问题和编写优雅代码的技能范围就越广。你不可能把所有的代码都写成面向对象并自动拥有好的代码，但是如果你真的了解 OOP 是如何工作的，而且你不只是复制粘贴当时流行的一些设计模式，那么你可以写一些漂亮的好的代码，尤其是在编写大型应用程序时。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-21T06:12:08.843

似乎每个人都在从字面上回答您的问题，即 OO 的具体好处/缺点。

您应该学习 OO，但不是因为 OO 具有您需要的任何特定魔法。

更一般的形式是：

*   问：“我应该学习（OO、FP、并发、基于逻辑、事件驱动……）编程吗？”
*   A：“是的，学习一个新的范式总是有用的，即使你不是每天都直接使用它。”

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-25T20:02:06.067

我会这样说：如果你写任何复杂的东西，你应该对你思考的概念进行编码，而不是试图用你所使用的语言所固有的概念来思考。这样可以减少错误。这些概念的形式化称为设计。

函数式编程允许您定义与动词相关的概念，因为每个函数本质上都是一个动词（例如 print()）。另一方面，OO 编程还允许您定义与名词相关的概念。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T20:56:48.993

我是一名长期从事程序化 PHP 程序员，偶尔会涉足面向对象的 PHP。上面乔尔的回答是对好处的一个很好的总结。在我看来，一个微妙的次要好处是它迫使你从一开始就更好地定义你的需求。您必须了解对象之间的关系以及将对它们起作用的方法。

一本有助于过渡的好书是 Peter Lavin 的“面向对象的 PHP”。
![替代文字](https://i.stack.imgur.com/E6hfy.jpg)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-04T06:43:07.783

稍微详细说明乔里的回答：

国际标准化组织将封装定义为“对象中包含的信息只能通过对象支持的接口上的交互来访问的特性”。

因此，由于某些信息可通过这些接口访问，因此某些信息必须在对象内隐藏且不可访问。此类信息表现出的属性称为信息隐藏，Parnas 通过认为模块应该被设计为隐藏困难的决策和可能改变的决策来定义。

注意那个词：改变。信息隐藏涉及潜在事件，例如未来困难设计决策的变化。

考虑一个具有两种方法的类：方法 a() 是隐藏在类中的信息，方法 b() 是公共的，因此其他类可以直接访问。

将来对方法 a() 的更改很有可能需要更改其他类中的方法。未来对方法 b() 的更改也有一定的可能性需要更改其他类中的方法。然而，方法 a() 发生这种波纹变化的概率通常低于方法 b()，这仅仅是因为方法 b() 可能会被更多类所依赖。

这种减少涟漪影响的可能性是封装的一个关键好处。

考虑任何程序中源代码依赖项（MPE - 首字母缩写词来自图论）的最大潜在数量。从上面的定义推断，我们可以说，给定两个向用户提供相同功能的程序，MPE 最低的程序封装得更好，并且从统计上来说，封装得更好的程序维护和开发成本更低，因为成本它的最大电势变化将低于封装较差系统的最大电势变化。

此外，考虑一种只有方法而没有类的语言，因此没有相互隐藏信息的方法。假设我们的程序有 1000 个方法。这个程序的 MPE 是多少？

封装理论告诉我们，给定一个有 n 个公共节点的系统，这个系统的 MPE 为 n(n-1)。因此，我们的 1000 个公共方法的 MPE 为 999,000。

现在让我们将该系统分成两个类，每个类有 500 个方法。由于我们现在有类，我们可以选择将一些方法设为公共的，而将一些方法设为私有的。除非每种方法实际上都依赖于其他所有方法（这不太可能），否则情况就是如此。假设每个类中有 50 个方法是公共的。系统的 MPE 是多少？

封装理论告诉我们它是：n((n/r) -1 + (r-1)p) 其中 r 是类的数量，p 是每个类的公共方法的数量。这将使我们的二级系统的 MPE 为 499,000。因此，在这种二类系统中进行更改的最大潜在成本已经大大低于未封装系统的最大潜在成本。

假设您将系统分成 3 个类，每个类有 333 个类（好吧，一个将有 334 个），并且每个类都有 50 个公共方法。什么是 MPE？再次使用上述等式，MPE 约为 482,000。

如果将系统分成 4 类，每类 250 个方法，则 MPE 将为 449,000。

如果看起来增加我们系统中的类数量总是会降低它的 MPE，但事实并非如此。封装理论表明，为了使 MPE 最小化，系统应该分解成的类数是：r = sqrt(n/p)，对于我们的系统来说实际上是 4。例如，一个有 6 个类的系统会有一个 MPE 465,666。

负担原则有两种形式。

强形式表明，转换实体集合的负担是转换实体数量的函数。弱形式表明转换实体集合的最大潜在负担是转换实体的最大潜在数量的函数。

更详细地说，创建或修改任何软件系统的负担是创建或修改的程序单元数量的函数。

与不依赖于修改后的程序单元的程序单元相比，依赖于特定修改程序单元的程序单元受到影响的概率更高。

修改后的程序单元可能施加的最大潜在负担是对依赖它的所有程序单元的影响。

因此，减少对修改后的程序单元的依赖性降低了其更新将影响其他程序单元的可能性，从而减少了该程序单元可以施加的最大潜在负担。

减少系统中所有程序单元之间的最大潜在依赖关系因此减少了对特定程序单元的影响将导致对其他程序单元进行更新的可能性，从而减少了所有更新的最大潜在负担。

因此，封装是面向对象的基石，封装有助于我们减少所有程序单元之间的最大潜在依赖数量，并减轻负担原则的弱形式。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-25T19:55:52.200

大型系统（例如 Wordpress、Drupal 或 XOOPS）使用 OOP 概念。您可以在那里看到使用它们的好处。代码重用、模块化、可维护性和可扩展性。

您有能力修改部分对象，它会影响整个应用程序；无需搜索来替换您执行某些操作的每个位置（并且可能会丢失它）。

你可以重用对象，节省大量的复制和粘贴。修补错误需要修补一个对象，而不是 16 页的代码都做同样的事情。

当您封装逻辑并“隐藏”实现时，使用对象会更容易，无论是从现在起 6 个月后，当您忘记自己为什么做某事时，还是对于使用您的代码的巢穴家伙或女孩。例如，您在 Wordpress 中循环浏览帖子所要做的就是调用一个函数。我不需要知道它是如何工作的，我只需要知道如何调用它。

OOP 实际上是包装在对象方法/函数中的过程代码。您仍然需要知道如何编写体面的线性代码才能实现对象的方法和功能。它只是让重用、扩展、修复、调试和维护你的东西变得更加容易。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T19:56:23.307

[http://www.onlamp.com/pub/a/php/2005/07/28/oo_php.html](http://www.onlamp.com/pub/a/php/2005/07/28/oo_php.html)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-26T09:15:09.110

我想说有两个主要好处：

*   封装：可以隐藏库中不应从库外部调用的代码，防止误用，并在保留外部接口的同时轻松更改库的内部结构。在良好的 OO 设计中，一旦代码完成，更改就更容易引入。
*   抽象：不是处理数组数组，而是处理员工、部门等。这意味着您可以专注于业务逻辑，并编写更少的代码行。更少的行意味着更少的错误。

重用我不会严格限定为 OO 好处，因为在纯过程模型中，智能库组织也允许您重用代码。

另一方面，与过程模型相比，在 PHP 中使用大量对象往往会降低性能，因为每个请求都有太多的对象构造开销。在过程式代码和 oo 式代码之间找到良好的平衡势在必行。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-26T08:42:31.607

要学习 PHP 中的 OO，我建议尝试使用一些编写好的 OO PHP 框架。

您可能想查看[Zend 框架](http://framework.zend.com/)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-09T02:36:12.067

我也是一个 PHP 人，虽然我确实有很强的 OOP 背景，但我想说关于在 PHP 中使用 OOP 的最好的书必须是 [PHP 5 Objects Patterns and Practice](https://rads.stackoverflow.com/amzn/click/com/1590593804)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-25T04:40:10.870

我在 PHP 中使用 OOP 做的最好的事情之一就是类生成器。在任何给定的表中，都会涉及几乎相同的 SQL 操作：

*   插入
*   更新
*   选择
*   删除
*   存在（检查一行是否存在）
*   搜索
*   列表

现在我不必再编写所有这些 SQL 语句了，除非有特殊情况。不仅我在上面的工作中将编码时间缩短到了 1 分钟，而且还节省了调试代码的时间。

因此，每当表结构发生变化时，我只需重新生成类。

可能您应该尝试相同的方法，因为它对我和我的客户都喜欢！

# oop - 对任务列表进行排序的最佳位置

> ID：135539
> 
> 赞同：0
> 
> 时间：2008-09-25T19:43:40.370
> 
> 标签：oop, data-structures, sorting, collections

我正在构建一个 Web 应用程序，它是一个流程管理应用程序。将向几种不同的员工类型显示要执行的任务列表，当每个人完成一项任务时，它就会转移到下一位要处理的员工。

任务层次结构是批处理 > 加载 > 装配 > 零件 > 任务。目前有 8 条规则可用于确定每种员工类型应首先处理的任务。这些规则适用于零件的大小，以及零件完成将如何影响层次结构，例如，如果 A 部分完成，那么它会完成整个批次，而 B 部分不会，因为在其批次中还有其他部分要完成。

无论如何，这就是系统如何工作的电梯间距。我想弄清楚的是一种有效、快速和可维护的方法，考虑到规则可能会改变并且可能会添加更多规则。

最初我打算让数据库（sql 2005）完成所有繁重的工作，但我担心更复杂的规则很难用数据库实现。因此，另一种方法是将任务列表提取到中间层并创建对象集合并将每个规则应用于集合。我毫不怀疑每个规则都可以单独转换为 T-SQL，但根据任务类型按多达 8 个标准排序感觉很麻烦。

我可以看到中间层方法的一个好处是我可以创建一个限制更松散的系统，其中可以更改任务流，我认为这在数据库中会更加困难。

那么大家会推荐什么呢？有没有我没有想到的第三种选择？

编辑[1] 只是为了进一步说明这一点，预计数据库不会改变我最初开发它的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T19:49:30.390

从问题的细节很难确定。但是，将您的逻辑放在业务逻辑（中间）层将意味着您的业务规则可以继续使用相同的代码，无论后端数据库是什么。目前您指定了 T-SQL，但将来您是否有可能迁移到非 SQL Server 环境？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T19:52:36.527

什么平台？.NET 3.5 引入了 LinqToSQL，这可能会引起争议。您可以使用策略模式根据任务类型选择/构建适当的查询，然后让 LINQ 为您完成 SQL 的转换。这样，您可以在代码中构建查询，但仍然可以在数据库上实际执行它。

# svn - 如何修复“升级的”颠覆工作目录？

> ID：135543
> 
> 赞同：1
> 
> 时间：2008-09-25T19:44:20.557
> 
> 标签：svn, version, conflict

这听起来可能很愚蠢，但有时我会遇到两个颠覆版本之间的版本冲突。我使用 sshfs 在开发服务器上挂载一个目录，然后使用本地 Vim 编辑代码。对于像更新、提交等颠覆性的东西。我在服务器上 ssh 并在那里做。但是，有时我会混淆我的 shell 并且不小心在挂载目录中的本地 shell 中进行更新或提交。Subversion 退出并出现错误，这很好。但是，当我尝试在我的 ssh 会话中的开发服务器上做同样的事情时，subversion 说工作目录/subversion 有一个错误的版本。服务器上的颠覆版本比我笔记本上的版本旧，所以我猜我的（较新）版本以某种方式升级了工作目录，因此它们与开发服务器上的旧版本不兼容。有时删除 .svn/lock 文件会有所帮助，但前提是我在笔记本上执行 subversion 命令后立即执行此操作。当我之后在开发服务器上执行命令时，锁定文件消失了，我看不到拯救结帐的方法。如果存储库不是那么大，这不会那么糟糕。特别是当我做了很多更改并且无法提交时。

我目前看到的唯一解决方案是将我更改的文件复制到某处，删除结帐，进行全新的结帐并将文件复制回来。

是否有更好的解决方案来挽救损坏的结帐和/或我的更改？

**更新** Mikael Sundberg 链接的常见问题解答包含答案。我把它写在这里，因为他没有明确提到它。有一个脚本可以在安全的情况下降级升级的存储库：

[http://svn.apache.org/repos/asf/subversion/trunk/tools/client-side/change-svn-wc-format.py](http://svn.apache.org/repos/asf/subversion/trunk/tools/client-side/change-svn-wc-format.py)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T19:58:33.347

也许这个常见问题条目可能会有所帮助： [http ://subversion.tigris.org/faq.html#working-copy-format-change](http://subversion.tigris.org/faq.html#working-copy-format-change)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T20:02:36.113

我不确定我是否正确理解了您的问题，但这里有一些提示：

第一个提示——你尝试过 SVN *Clean*命令吗？

下一个可能对你没用:)，但是很多用过CVS的人没有意识到SVN有这样的功能，所以我把它写下来。

如果您使用 Windows 和[Tortoise SVN 客户端](http://tortoisesvn.tigris.org/)，您可以从上下文菜单（鼠标右键）中选择*Show Log命令。*当签入列表出现时，选择最后一个正确的，然后从上下文菜单命令中选择*恢复到此版本*。

在其他情况下（不是 Windows 或 Tortoise SVN），请查看上述命令的命令行版本的[文档。](http://svnbook.red-bean.com/en/1.1/index.html)

下一个技巧可以帮助你避免混合你的贝壳。

你已经写过你使用 SSH shell——为了避免混合 shell 会话的问题，我总是为我登录的每个服务器（和帐户）使用不同的背景颜色（即，白色在黑色上用于开发，黄色在海军上用于测试服务器和生产服务器上的绿色黄色）。

这节省了我很多次:)。

# asp.net - 如何解释 FrontPage Extensions 中的错误代码？

> ID：135556
> 
> 赞同：5
> 
> 时间：2008-09-25T19:46:07.713
> 
> 标签：asp.net, sharepoint, error-handling, frontpage

**愚蠢的赏金系统自动选择了错误的答案。**

我正在使用首页扩展与 SharePoint Services 3.0 进行交互，如此处[所述](http://msdn.microsoft.com/en-us/library/ms443099.aspx)。

在我见过的大多数示例中，客户端只是在结果中查找特定的英文字符串，并使用它来确定是否发生了错误。但是，我正在编写一个可以广泛部署并放在非英语 SharePoint 服务器上的应用程序，因此我想改用返回的错误代码。

不幸的是，错误代码的文档[定义很差](http://msdn.microsoft.com/en-us/library/ms433540.aspx)。它包含以下宝石：

> 尽管许多 RPC 协议方法具有独特的错误消息，但如果方法未能正确完成，大多数都依赖标准错误消息格式来传递信息。

Hrm，这个“标准错误消息格式”是什么......和

> 状态是 FrontPage 服务器扩展中遇到的条件的错误代码。osstatus 是来自操作系统的错误代码。

也很可悲地娱乐：

> 通常，代码是整数值，消息是总结错误的文本字符串。

但是没有一个表格可以描述这些错误的可能内容。

在我看来，操作系统错误代码可能是 HRESULT，但我不知道在 SharePoint 错误代码的潜在来源方面要寻找什么。我唯一的线索是 status=589826 似乎表明文件已经存在。

**愚蠢的赏金系统自动选择了错误的答案。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-26T09:35:21.417

我猜它指的是这个“标准”系统错误代码列表：

[http://msdn.microsoft.com/en-us/library/ms681381(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681381(VS.85).aspx)

# deployment - 如何更改 Visual Studio 2005 部署项目的设置

> ID：135573
> 
> 赞同：4
> 
> 时间：2008-09-25T19:49:44.710
> 
> 标签：deployment, visual-studio-2005

我有一个包含至少一个 DLL 以及可执行输出的项目。我在这个解决方案中添加了一个部署项目，它要求我在创建时像所有项目一样提供一个名称和工作目录。

我将此命名为“MyProduc_Installer”，并且能够修改安装过程的所有方面，除了更改安装程序本身的名称。在整个安装过程中，用户会看到诸如“欢迎使用 MyProduct_Installer 安装程序”之类的消息。即使在“添加/删除程序”列表中，这也是应用程序的错误标题。

如何更改此设置？我试过右键单击/属性，以及所有的视图选项。我在可执行项目或解决方案属性的程序集信息中找不到任何内容。

我尝试在资源管理器中右键单击项目以更改属性，但这是我看到的：

![替代文字](https://sites.google.com/site/sizerfx/Home/properties.png?attredirects=0)

这里没有设置更改项目标题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T03:58:05.030

如果你还没有找到这个问题的答案，这里就是答案。

Visual Studio 有 2 组项目属性 - 您可以通过在解决方案资源管理器中选择项目，然后右键单击并选择“属性”来访问这些属性。

第二组属性位于解决方案资源管理器下方的“属性”窗口中。这是为任何表单属性设置或任何其他控件设置显示的相同属性窗口。

可以在第二个属性窗口中找到“安装”项目的“产品名称”和其他项目属性。

希望这可以帮助。

交流电

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T08:25:38.757

访问您感兴趣的属性的简单方法是在项目突出显示时使用 F4 快捷键。如前一篇文章所述，这是一个与您通过右键单击并选择属性获得的列表非常不同的列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T20:16:12.867

如果您的意思是 Winforms 之类的安装项目，它是**ProductName**属性。在 Studio 中，我只需在资源管理器中单击项目名称，我就会得到其他项目典型的属性窗口，它就在那里。其他属性包括 AddRemoveProgramsIcon、InstallAllUsers 和 RemovePreviousVersions。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-29T05:41:00.437

我偶然发现了这篇文章，我在重命名产品时也遇到了麻烦。关于使用 Click Once Publishing。

由于更新了所有旧名称，我无法让出版机构自行更正。在我的情况下，发现记事本项目文件**xyz.vbproj**并更新`<ProductName>xyz wrong name</ProductName>`仍然错误的元素。

这是我唯一能找到更新它的地方，因为发布或任何属性窗口都没有公开它。

# testing - 您如何确定 QA 问题是否属于缺陷？

> ID：135579
> 
> 赞同：4
> 
> 时间：2008-09-25T19:50:51.120
> 
> 标签：testing, qa

我曾在多家公司担任开发人员，最近在一家新公司进入了 QA 自动化领域。每家公司都是不同的，我还没有看到我真正喜欢的处理方式。QA 经常会说某事是个问题，而回答要么是“好吧，但它太难并且需要太长时间才能修复”或“这不是错误，而是一个功能！”。
有没有人找到一种合理的方法来确定 QA 所说的错误是否需要修复？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T20:07:37.957

作为开发人员，我知道您总是会遇到让您在 QA 处发誓（低声下气）的错误 - 但我认为不应该将修复/不修复决定交给开发人员 - 正如借口所证明的那样你说！！最谦虚的程序员讨厌出现在他/她的代码中的错误，因此很想给你带来困难。我认为测试人员和开发人员之间的一点摩擦是必要的（前提是你在一天结束时给他们买啤酒！）。“这不是一个错误，它是一个特性”是一个常见的反驳，但有时是有效的，这可能就是为什么一个重要的人可能是来自业务方面的人（如果这对你的工作有意义的话）。

以我的经验，即使现在无法修复，也值得记录它们 - 您始终可以分配一个滑动优先级，然后将其修复到某个级别。与测试人员/开发人员一起定期审查错误也会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T19:56:52.947

我过去的做法是由一个人（产品经理）负责确定错误和新功能的优先级。PM 根据以下标准决定每个项目是错误还是新功能：

*   如果软件做了一些明显错误的事情（即不是任何人想要或想要的），那么它就是一个错误。
*   如果软件做了一些与软件的设计文档相反的事情，并且没有任何明显的优势，那就是一个错误。
*   如果软件做的事情不是客户（或其他人）想要的，但行为符合设计文档，那么它就是一个功能请求。

PM 将与工程和客户代表讨论每个错误或功能请求，并在此基础上（以及常识和经验）为每个项目分配优先级。此外，工程将被要求指出每个项目的大致时间尺度，PM 将使用它来计划下一次迭代。

简而言之，错误是软件没有按照设计它的人计划的那样做，而功能请求是当有人希望软件做一些没有计划的事情时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:29:25.083

SCRUM 方法提供了这个问题的答案。产品负责人决定某事是否是在产品积压列表中创建项目的错误。然后根据项目的优先级将项目安排到迭代中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:35:58.747

功能性错误和 UI 错误很容易找到，而且争议较少。设计错误是需要通过 BA 和开发团队才能获得意见的错误。与环境相关的问题也应该单独跟踪，并且可能不属于错误类别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T05:54:45.927

有很多方法。他们中有一些：

1.  应完整描述软件需求。如果您发现某些要求未得到满足，则显然是错误。

2.  您会看到满足要求，但以某种不明显的形式。也是bug。但这是开发人员可能会说“一切都很好”并尝试关闭错误的情况。您可以通过以下方式找到您的意见（存在缺陷）：

    *   示例如何在同一产品中实现类似的事物。
    *   类似的东西如何在类似的产品中工作的例子（例如 gmail 可以用作邮件托管的例子等等）。
    *   询问您的销售和客户关系经理人们对该功能的期望是什么，从最终用户的角度来看它应该如何工作。
    *   使用行业最佳实践。
3.  您会看到某些东西有效，但可以改进。这也是缺陷:)。它与第 2 点类似，所有推荐都适用于这种情况。

PS并与其他部门的人讨论，讨论，讨论。

# qa - 预算 QA 时间的提示

> ID：135580
> 
> 赞同：-2
> 
> 时间：2008-09-25T19:50:51.820
> 
> 标签：qa

有时对于 QA 来说，很难预算和跟踪 QA 时间，因为一个人可能会花费大量时间重新测试缺陷并执行回归（如果有）。我们可以举一个例子，一个有 50 个用例的 Web 应用程序。

预算 QA 时间有哪些技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T19:55:10.470

过去的历史很好地预示了未来的表现。最后一次回归用了多长时间？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:59:27.167

查看[基于证据的调度](http://www.joelonsoftware.com/items/2007/10/26.html)。诚然，它首先是为了开发该功能而设计的，但是知道您还需要做多少工作以及开始编写代码的可靠性是有道理的。计划中的一些任务可能是执行最后一次回归测试需要多长时间或开发单元测试需要多长时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T19:57:43.037

理想情况下，会有一些经验数据用于估计

*   QA 如何记录用例的执行？
*   如果他们没有记录测试执行时间，那么他们可能应该记录。
*   我总是建议记录设置时间/实际测试执行时间，因为这将考虑到 QA 在测试执行期间的任何中断，并提供更现实的测量。（即它可能需要 5 分钟的用例来执行，但如果您的 QA 每隔 5 分钟就会被打断，那么使用估计的执行时间作为指导是无用的）

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-16T02:13:36.093

质量保证需要仔细预算。人们通常会忽略 QA，因此您需要 QA 专家。在任何情况下，您需要适当的 QA 预算的原因是好的和坏的测试用例可能需要的执行时间。

预算 QA 时间的提示包括：

1.  过去的经历
2.  QA的分析和范围
3.  对 QA 流程的了解和理解

这是根据我的个人经验。

# web-services - 如何以编程方式跟踪商品在亚马逊上的销售排名？

> ID：135591
> 
> 赞同：3
> 
> 时间：2008-09-25T19:52:25.623
> 
> 标签：web-services, amazon

我见过几种可以跟踪亚马逊上某件商品的销售排名的产品。亚马逊是否发布了任何网络服务，可用于获取特定商品的销售排名？

我浏览了 AWS 并没有看到任何这种性质的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T19:57:47.280

在使用 Amazon Associates Web 服务进行 ItemLookup 时，您应该能够通过查询 SalesRank 响应组来确定销售排名。

示例查询：

```
http://ecs.amazonaws.com/onca/xml?
Service=AWSECommerceService&
AWSAccessKeyId=[AWS Access Key ID]&
Operation=ItemLookup&
ItemId=0976925524&
ResponseGroup=SalesRank&
Version=2008-08-19 
```

回复：

```
<Item>
  <ASIN>0976925524</ASIN> 
  <SalesRank>68</SalesRank> 
</Item> 
```

请参阅此处的文档：http: //docs.amazonwebservices.com/AWSECommerceService/2008-08-19/DG/index.html? [RG_SalesRank.html](http://docs.amazonwebservices.com/AWSECommerceService/2008-08-19/DG/index.html?RG_SalesRank.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-04T10:46:43.243

亚马逊已经改变了他们的 API，所以它现在需要一个签名： http: [//developer.amazonwebservices.com/connect/ann.jspa](http://developer.amazonwebservices.com/connect/ann.jspa?annID=483) ?annID=483所以上面的例子从 2009 年 8 月起不再有效。

# security - 在 Windows 2003 的文件属性中重现被阻止的 exe“解除阻止”选项

> ID：135600
> 
> 赞同：10
> 
> 时间：2008-09-25T19:53:28.087
> 
> 标签：security, windows-server-2003, nsis

当我从我的网站下载我的程序到我的 windows 2003 机器时，它上面有一个块，你必须右键单击 exe，然后属性，然后选择按钮“取消阻止”。

我想在我的安装程序中添加检测文件何时被阻止，因此没有足够的权限。

但是我不能轻易地重现让我的 exe 处于需要解除阻塞的状态。

我怎样才能让解除阻止出现在我的 exe 上，以便我可以测试这个功能？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T20:43:09.357

这是使用 NTFS 文件流完成的。下载的文件中添加了一个名为“Zone.Identifier”的流。当 IE7 下载某些类型的文件时，该流包含：

```
[ZoneTransfer]
ZoneId=3 
```

设置它的最简单方法是创建一个包含这些内容的文本文件，并使用更多将其添加到备用流中。

Zone.Identifier.txt：

```
[ZoneTransfer]
ZoneId=3 
```

命令：

```
more Zone.Identifier.txt > file.exe:Zone.Identifier 
```

然后，您检查它的方法是尝试打开 Zone.Identifier 流并查找 ZoneId=3，或者简单地假设如果流存在，您的用户将收到该警告。

同样重要的是要注意，这与权限无关。管理员看到同样的警告；这完全与文件的来源和类型有关。当用户取消选中“打开此文件前始终询问”框，然后单击运行时，整个流就会消失。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-06T02:38:44.490

有一个受支持的 API，记录在 MSDN 上。在 MSDN 上搜索“Persistent Zone Identifier Object”。基本上你`CoCreateInstance`有`CLSID_PersistentZoneIdentifier`并请求一个`IPersistFile`接口。然后，您使用相关文件的名称进行调用`IPersistFile::Load`。接下来，QI为一个`IZoneIdentifier`接口和用于`IZoneIdentifier::GetId`获取文件的区域。如果没有“网络标记”，您应该得到`URLZONE_LOCAL_MACHINE`. 另一个回复中提到的 3 的 ZoneId 是`URLZONE_INTERNET`. （枚举被调用`URLZONE`，也记录在 MSDN 上，或参见。）您可以通过调用或然后调用`sdk\inc\urlmon.h`来删除或更改“网络标记” 。MSDN 上有关于所有这些的更多详细信息。祝你好运！`IZoneIdentifier::Remove``IZoneIdentifier::SetId``IPersistFile::Save`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T15:38:43.390

感谢这对我帮助很大。

如果您创建包含内容的批处理文件，则可以使该过程更加容易。

```
echo [ZoneTransfer] > Zone.Identifier
echo ZoneId=3 >> Zone.Identifier
more Zone.Identifier > %1:Zone.Identifier 
```

这将为您生成 Zone.Identifier 并相应地标记文件。

要运行它，只需提供文件名，例如，如果文件名为 mark.bat

```
mark.bat myfile.txt 
```

# sproutcore - 除了官方文档还有其他文档吗？

> ID：135607
> 
> 赞同：3
> 
> 时间：2008-09-25T19:54:58.940
> 
> 标签：sproutcore

官方文档似乎对“如何理解 SproutCore 方式”的解释很简单，例如，为什么事情会按照它们的方式完成，如何直觉地从你所在的地方做什么等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T20:02:32.747

[Update] Latest resource is [new wiki](http://wiki.sproutcore.com/) .

Which have information on how to start with Version 1.0 Alpha

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T20:06:04.827

sproutcore 上有一个 GitHub Wiki。他们提供了一个很好的指南和教程列表。
[http://github.com/sproutit/sproutcore/wikis](http://github.com/sproutit/sproutcore/wikis)

它应该是一个相当容易学习的 JavaScript 框架，但它也有它的用武之地。

# php - 如何建立托管风格系统

> ID：135621
> 
> 赞同：3
> 
> 时间：2008-09-25T19:57:05.207
> 
> 标签：php, escrow

我有一个网站，客户为服务付费，但必须通过托管预先支付资金，我非常精通 PHP（这是网站的编码内容）我将如何实施一个可以自动运行的托管系统?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T20:03:38.670

您需要将设计分解为组件并考虑流程。

托管工作如下：

*   实体 A 将资金存入实体 B 的托管账户。
*   实体 A 和实体 B 达成协议
*   托管账户存入实体 B。

实施方面，我会像任何交易一样跟踪托管存款，我也会以同样的方式跟踪托管付款。

您需要想出一种将“工单”存储在数据库中的方法。这些将有两列“AcceptedByA”和“AcceptedByB”，以及金额。

该过程将是：

*   实体 A 开立工作订单并向托管账户支付 $X
*   实体 B 执行工作订单所需的任何操作（将 AcceptedByB 设置为 true）
*   实体 A 将“AcceptedByA”设置为 true。
*   从托管账户向实体 B 支付一笔交易。

这是非常高的水平，但它是一个相当简单的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T22:26:02.633

恕我直言，这个问题太笼统了。您是否正在寻找 PHP-MySQL 级别的设计？比如什么表之类的？或者您正在寻找可以使用的服务？

为简单起见，假设您使用 Paypal 收款和付款。

买方 A 需要为卖方 B 设置和托管。

1.  您收取 A $x 并将该金额保存在您的 Paypal 帐户中。
2.  您创建了一条逻辑记录，告诉您 $x 已收到并用于 B。

您必须实现事务（MySQL 或 PHP 中的分层）以确保上述两个步骤都发生。如果由于某种原因创建逻辑记录失败 - 重试第二步 n 次，如果仍然失败，则失败（退款）第一步。

当用户释放托管时，您必须采用类似的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-27T23:53:14.467

有很多方法可以解决这样的问题。您可以为自己的平台创建一次性解决方案，或使用 Paypal 的[Braintree等市场支付解决方案，或](https://www.braintreepayments.com/)[Stripe](https://stripe.com/)等其他平台。看看这些，它们使您能够营销分期付款并进行托管。

# java - midlet 和 corelet 有什么区别？

> ID：135628
> 
> 赞同：0
> 
> 时间：2008-09-25T19:57:51.273
> 
> 标签：java, java-me, midlet

我的理解是corelet是摩托罗拉主义，但有人知道有什么区别吗？corelet 是否具有 midlet 所没有的某些功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T21:22:35.453

我相信 corelet 是一个对手机内部文件系统具有完全读取权限的 midlet...

可能还有别的东西，但我不记得了……我看看能不能找到更多信息

在四处搜索之后，似乎他们基本上是在手机上添加了功能，而不是在手机上作为单独的应用程序运行

# c++ - 类设计与 IDE：非成员非友元函数真的值得吗？

> ID：135634
> 
> 赞同：5
> 
> 时间：2008-09-25T19:59:16.433
> 
> 标签：c++, ide, function, class-design, friend

在（否则）优秀的书[C++ 编码标准](http://www.gotw.ca/publications/c++cs.htm)第 44 条，标题为**“Prefer writing nonmember nonfriend functions”**中，Sutter 和 Alexandrescu 建议只有真正需要访问类成员的函数本身就是该类的成员。仅使用成员函数可以编写的所有其他操作不应该是类的一部分。他们应该是非会员和非朋友。论据是：

*   它促进了封装，因为需要访问类内部的代码更少。
*   它使编写函数模板更容易，因为您不必每次都猜测某个函数是否是成员。
*   它使类保持较小，从而使其更易于测试和维护。

虽然我看到了这些参数的价值，但我看到了一个巨大的缺点：**我的 IDE 无法帮助我找到这些函数！**每当我有某种对象时，我想看看它上面有哪些可用的操作，我不能再只输入“ `pMysteriousObject->`”来获取成员函数的列表。

保持简洁的设计最终是为了让您的编程生活更轻松。但这实际上会使我的工作更加困难。

所以我想知道这是否真的值得麻烦。**你怎么处理？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T04:37:20.137

Scott Meyers 的观​​点与 Sutter 相似，请参见[此处](http://www.ddj.com/cpp/184401197)。

他还明确指出：

*“根据他对各种类似字符串的类的工作，Jack Reeves 观察到某些函数在成为非成员时不会“感觉”正确，即使它们可能是非朋友非成员。“最佳”界面因为只有通过平衡许多相互竞争的关注点才能找到一个类，封装程度只是其中之一。”*

如果一个函数成为一个成员函数“才有意义”，那就让它成为一个。同样，如果它不是真正的主界面的一部分，并且成为非成员“才有意义”，那么就这样做。

需要注意的是，对于重载版本，例如 operator==()，语法保持不变。所以在这种情况下，你没有理由**不**让它成为与类在同一位置声明的非成员非朋友浮动函数，除非它真的需要访问私有成员（根据我的经验，它很少会这样做）。即使这样，您也可以将 operator!=() 定义为非成员，并根据 operator==()。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-26T10:17:33.907

我不认为说他们之间，Sutter、Alexandrescu 和 Meyers 在 C++ 质量方面所做的比其他任何人都多。

他们提出的一个简单问题是：

> 如果一个实用函数有两个独立的类作为参数，那么哪个类应该“拥有”成员函数？

另一个问题是，您只能在相关类受您控制的情况下添加成员函数。您为 std::string 编写的任何辅助函数都必须是非成员，因为您无法重新打开类定义。

对于这两个示例，您的 IDE 将提供不完整的信息，您将不得不使用“老式方式”。

鉴于世界上最有影响力的 C++ 专家认为具有类参数的非成员函数是类接口的一部分，这更多是您的 IDE 的问题，而不是编码风格的问题。

您的 IDE 可能会在一两个版本中发生变化，您甚至可以让他们添加此功能。如果你改变你的编码风格以适应今天的 IDE，你很可能会发现你将来会遇到更大的问题，即不可扩展/不可维护的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T20:06:27.680

我将不得不在这一点上不同意 Sutter 和 Alexandrescu 的观点。我认为如果 function 的行为`foo()`属于 class`Bar`的职责范围，那么`foo()`应该是`bar()`.

`foo()`不需要直接访问的成员数据这一事实`Bar`并不意味着它在概念上不是`Bar`. 这也可能意味着代码被很好地分解。拥有通过其他成员函数执行所有行为的成员函数并不少见，我不明白为什么会这样。

我完全同意与外围相关的功能*不*应该是类的一部分，但是如果某些东西是类职责的核心，那么它没有理由不应该是成员，无论它是否直接与成员数据混在一起。

至于这些具体点：

> *它促进了封装，因为需要访问类内部的代码更少。*

事实上，直接访问内部的函数越少越好。这意味着让成员函数尽可能多地*通过*其他成员函数来做是一件好事。将分解良好的函数从类中分离出来只会给你留下一个半类，这需要一堆有用的外部函数。从它们的类中拉出分解良好的函数似乎也阻碍了编写分解良好的函数。

> *它使编写函数模板更容易，因为您不必每次都猜测某个函数是否是成员。*

我完全不明白这一点。如果你从类中拉出一堆函数，你就将更多的责任推给了函数模板。他们被迫假设他们的类模板参数提供的功能*更少*，除非我们假设从他们的类中提取的大多数函数都将被转换为模板（呃）。

> *它使类保持较小，从而使其更易于测试和维护。*

嗯，当然。它还创建了许多额外的外部功能来测试和维护。我看不到这其中的价值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T20:17:14.690

确实，外部函数不应该是接口的一部分。从理论上讲，您的类应该只包含数据并公开其预期的接口，而不是实用功能。向接口添加实用程序函数只会增加类代码库并使其难以维护。我目前维护一个包含大约 50 个公共方法的类，这太疯狂了。

现在，实际上，我同意这并不容易执行。向您的类添加另一个方法通常更容易，如果您使用的 IDE 可以真正简单地向现有类添加新方法，则更容易。

为了使我的类保持简单并且仍然能够集中外部功能，我经常使用与我的类甚至命名空间一起使用的实用程序类。我首先创建将包装我的数据并公开最简单的接口的类。然后，我为与班级相关的每项任务创建一个新班级。

示例：创建一个类 Point，然后添加一个类 PointDrawer 将其绘制到位图，PointSerializer 将其保存等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:10:06.300

如果你给他们一个共同的前缀，那么你的 IDE 可能会在你输入时提供帮助

```
::prefix 
```

或者

```
namespace::prefix 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T21:23:47.417

在许多 OOP 语言中，non-friend non-class 方法是三等公民，它们驻留在孤儿院中，与任何事物都没有联系。当我写一个方法时，我喜欢选择好的父母——一个合适的班级——在那里他们最有机会感到受欢迎和帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-26T04:09:00.547

我会认为 IDE 实际上是在帮助你。

**IDE**正在从列表中隐藏受保护的**函数**，因为它们不像类的设计者所期望的那样对**公众可用。**

如果您在该类的范围内并键入了***this->***，那么受保护的函数将显示在列表中。

# gtk2 - 如何向 php-gtk 状态栏添加简单消息？

> ID：135642
> 
> 赞同：0
> 
> 时间：2008-09-25T20:00:07.023
> 
> 标签：gtk2, php-gtk

我有一个用 glade 创建的简单 GtkStatusBar，并想添加一条简单的消息，其中包含数据库的最后更新日期（只是一个简单明了的日期）。

我不想使用 gtk 开发人员放在状态栏代码上的整个堆栈、上下文和所有其他内容。

（我可以简单地使用标签，但我想保留拖动条）。

我正在使用带有 php 5.2.6 的 Gtk 2.0.1；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-25T20:06:03.360

尝试

[http://www.kksou.com/php-gtk2/articles/have-a-status-area-using-GtkStatusbar.php](http://www.kksou.com/php-gtk2/articles/have-a-status-area-using-GtkStatusbar.php)

要显示一条消息，我们首先需要使用 GtkStatusbar::get_context_id() 获取消息 id，然后使用 GtkStatusbar::push() 显示消息。

# sql - 删除表和截断表之间的区别？

> ID：135653
> 
> 赞同：81
> 
> 时间：2008-09-25T20:02:31.760
> 
> 标签：sql, sql-server, sybase

我有一些表是我构建的报告汇总的一部分。之后我根本不需要它们。有人提到要截断它们，因为它会更快。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-09-25T20:07:38.177

从表中删除记录会记录每次删除并为删除的记录执行删除触发器。截断是一个更强大的命令，它可以清空表而不记录每一行。SQL Server 会阻止您截断带有引用它的外键的表，因为需要检查每一行的外键。

截断通常是超快的，非常适合从临时表中清除数据。它确实保留了表的结构以供将来使用。

如果您确实要删除表*定义*以及数据，只需删除表即可。

有关详细信息，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa260621(SQL.80).aspx)

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2008-09-25T20:03:51.523

DROP TABLE 删除表。

TRUNCATE TABLE 清空它，但将其结构留给未来的数据。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-09-25T20:10:27.483

DROP 和 TRUNC 做不同的事情：

**截断表**

> 从表中删除所有行而不记录单个行删除。TRUNCATE TABLE 类似于没有 WHERE 子句的 DELETE 语句；但是，TRUNCATE TABLE 速度更快，使用的系统和事务日志资源更少。

**删除表**

> 删除一个或多个表定义以及这些表的所有数据、索引、触发器、约束和权限规范。

就速度而言，差异应该很小。无论如何，如果您根本不需要表结构，当然可以使用 DROP。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-25T20:06:42.237

我认为您的意思是 DELETE TABLE 和 TRUNCATE TABLE 之间的区别。

**删除表**

> 从数据库中删除表。

**删除表**

> 没有条件删除所有行。如果有触发器和引用，那么这将对每一行进行处理。如果有索引，也会修改索引。

**截断表**

> 将行数设置为零并且不记录每一行。它比其他两者都快得多。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-25T20:16:14.240

这些答案都没有指出这两个操作的重要区别。删除表是可以回滚的操作。 ~~但是，truncate 不能回滚~~['TRUNCATE TABLE' 也可以回滚]。如果有很多行，以这种方式删除一个非常大的表可能会非常昂贵，因为它们都必须记录在临时空间中，以防您决定回滚它。

通常，如果我想删除一个大表，我会截断它，然后删除它。这样，数据将在没有记录的情况下被删除，并且可以删除表，并且该删除将非常便宜，因为不需要记录数据。

需要指出的是，truncate 只是删除数据，离开表，而 drop 实际上会删除数据和表本身。（假设外键不排除这样的动作）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-12-06T05:37:33.383

## 删除表

```
DROP TABLE [table_name]; 
```

> DROP 命令用于从数据库中删除表。这是一个 DDL 命令。表的所​​有行、索引和权限也将被删除。DROP 操作无法回滚。

## 删除表

```
DELETE FROM [table_name]
WHERE [condition];

DELETE FROM [table_name]; 
```

> DELETE 命令是一个 DML 命令。它可用于根据 WHERE 子句中指定的条件从表中删除所有行或部分行。它使用行锁执行，表中的每一行都被锁定以供删除。它维护事务日志，因此它比 TRUNCATE 慢。DELETE 操作可以回滚。

## 截断表

```
TRUNCATE TABLE [table_name]; 
```

> TRUNCATE 命令从表中删除所有行。它不会记录每一行的删除，而是记录表的数据页的释放，这使得它比 DELETE 更快。它使用表锁执行，整个表被锁定以删除所有记录。这是一个 DDL 命令。TRUNCATE 操作无法回滚。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-25T20:04:45.157

TRUNCATE TABLE 保留所有旧索引和诸如此类的东西。显然，DROP TABLE 会删除该表并要求您稍后重新创建它。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T20:04:19.353

Drop 完全摆脱了表格，同时也删除了定义。Truncate 清空表但不删除定义。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T20:04:27.530

截断表格会清空表格。删除表会完全删除它。任何一个都会很快，但删除它可能会更快（取决于您的数据库引擎）。

如果您不再需要它，请将其删除，以免弄乱您的架构。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-10-05T19:58:39.623

删除表 A 而不是截断表 A？一个常见的误解是他们做同样的事情。不是这样。事实上，两者之间有很多不同之处。

DELETE 是基于每行的记录操作。这意味着每行的删除都会被记录并物理删除。

您可以删除任何不会违反约束的行，同时保留外键或任何其他约束。

TRUNCATE 也是一个记录操作，但方式不同。TRUNCATE 记录数据所在的数据页的释放。数据页的解除分配意味着您的数据行仍然实际存在于数据页中，但范围已被标记为空以供重用。这就是使 TRUNCATE 比 DELETE 执行更快的操作的原因。

您不能截断具有任何外键约束的表。您必须删除约束、截断表并重新应用约束。

TRUNCATE 会将任何标识列重置为默认种子值。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-25T20:04:07.390

truncate 删除所有行，但不删除表本身，它本质上等同于不带 where 子句的删除，但通常更快。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T20:04:44.847

在 SQL 标准中，DROP table 删除表和表模式 - TRUNCATE 删除所有行。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-25T20:59:57.957

我对上述陈述之一进行了更正……“截断不能回滚”

截断可以回滚。在某些情况下，您无法执行截断或删除表，例如当您有外键引用时。对于诸如月度报告之类的任务，我可能会在不再需要表格时将其删除。如果我更频繁地执行此汇总报告，那么我可能会保留表格并使用截断。

希望这会有所帮助，这里有一些您应该会发现有用的信息...

更多详情请参阅以下文章：http: [//sqlblog.com/blogs/denis_gobo/archive/2007/06/13/1458.aspx](http://sqlblog.com/blogs/denis_gobo/archive/2007/06/13/1458.aspx)

此外，有关删除与截断的更多详细信息，请参阅本文： [http ://www.sql-server-performance.com/faq/delete_truncate_difference_p1.aspx](http://www.sql-server-performance.com/faq/delete_truncate_difference_p1.aspx)

谢谢！杰夫

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-26T01:12:41.237

> TRUNCATE TABLE 在功能上与没有 WHERE 子句的 DELETE 语句相同：两者都删除表中的所有行。但是 TRUNCATE TABLE 比 DELETE 更快，并且使用更少的系统和事务日志资源。
> 
> DELETE 语句一次删除一个行，并在事务日志中为每个删除的行记录一个条目。TRUNCATE TABLE 通过解除分配用于存储表数据的数据页来移除数据，并且只有页解除分配记录在事务日志中。
> 
> TRUNCATE TABLE 从表中删除所有行，但表结构及其列、约束、索引等保留。新行标识使用的计数器被重置为列的种子。如果要保留标识计数器，请改用 DELETE。如果要删除表定义及其数据，请使用 DROP TABLE 语句。
> 
> 您不能在由 FOREIGN KEY 约束引用的表上使用 TRUNCATE TABLE；相反，使用没有 WHERE 子句的 DELETE 语句。因为没有记录 TRUNCATE TABLE，所以它不能激活触发器。
> 
> TRUNCATE TABLE 不能用于参与索引视图的表。

来自[http://msdn.microsoft.com/en-us/library/aa260621(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa260621(SQL.80).aspx)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T20:12:04.780

这里的答案与问题相匹配，但我将回答你没有问的问题。“我应该使用截断还是删除？” 如果要从表中删除所有行，通常需要截断，因为它要快得多。为什么要快很多？至少在 Oracle 的情况下，它重置了[high water mark](http://www.adp-gmbh.ch/ora/concepts/space_management/high_water_mark.html)。这基本上是对数据的取消引用，并允许数据库将其重用于其他用途。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-04-07T09:06:12.420

# 删除与截断

1.  该`DELETE`语句一次删除一行，并在事务日志中为每个删除的行记录一个条目。`TRUNCATE TABLE`通过释放用于存储表数据的数据页来删除数据，并仅在事务日志中记录页面释放
2.  我们可以使用`WHERE`从句 in`DELETE`但`TRUNCATE`你不能使用它
3.  当`DELETE`使用行锁执行语句时，表中的每一行都被锁定以供删除。`TRUNCATE TABLE`总是锁定表和页，但不是每一行
4.  语句执行后`DELETE`，表中仍然可以包含空页。如果删除操作不使用表锁，则表（堆）会包含很多空页。对于索引，删除操作可能会留下空页面，尽管这些
    页面会被后台清理进程快速释放
5.  `TRUNCATE TABLE`从表中删除所有行，但表结构及其列、约束、索引等保留
6.  `DELETE`声明不`RESEED`标识列，但`TRUNCATE`声明`RESEEDS`列 `IDENTITY`
7.  您不能`TRUNCATE TABLE`在以下表格上使用：
    1.  被`FOREIGN KEY`约束引用。（您可以截断具有引用自身的外键的表。）
    2.  参与索引视图。
    3.  使用事务复制或合并复制发布
8.  `TRUNCATE TABLE`无法激活触发器，因为该操作不记录单个行删除

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-24T17:39:10.280

**删除语句**

Delete 语句删除表中的行并返回表中删除的行数。在这个语句中，我们使用 where 子句从表中删除数据

*   Delete Statement 比 Truncate statement 慢，因为它会一一删除记录

**截断语句**

截断语句 从表中删除或移除所有行。

*   它比删除语句快，因为它从表中删除了所有记录
*   截断语句不返回从表中删除的行数

**删除声明**

drop语句删除了所有记录以及表的结构

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-03-29T08:36:18.663

**删除** 整个表及其所有结构

**truncate** delete all rows from table 它与 delete 不同的是它还删除行的索引

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-03T06:03:25.013

> ### 删除
> 
> DELETE 命令用于从表中删除行。WHERE 子句可用于仅删除某些行。如果未指定 WHERE 条件，则将删除所有行。执行 DELETE 操作后，您需要 COMMIT 或 ROLLBACK 事务以使更改永久化或撤消它。
> 
> ### 截短
> 
> TRUNCATE 从表中删除所有行。该操作无法回滚......因此，TRUCATE 更快，并且不像 DELETE 那样使​​用尽可能多的撤消空间。

来自：[http ://www.orafaq.com/faq/difference_between_truncate_delete_and_drop_commands](http://www.orafaq.com/faq/difference_between_truncate_delete_and_drop_commands)

# css - 如何从项目中的多个 CSS 文件中识别未使用的 CSS 定义

> ID：135657
> 
> 赞同：423
> 
> 时间：2008-09-25T20:03:21.667
> 
> 标签：css, performance, optimization, code-cleanup

一堆 CSS 文件被拉进来，现在我正在尝试清理一下。

如何有效地识别整个项目中未使用的 CSS 定义？

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2010-06-24T19:08:36.790

[Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/)有一个**审核**选项卡，可以显示未使用的 CSS 选择器。

运行审核，然后在**网页性能**下查看**删除未使用的 CSS 规则**

![在此处输入图像描述](https://i.stack.imgur.com/QCEnw.png)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2011-06-08T17:18:34.573

我刚刚找到了这个网站——http: [//unused-css.com/](http://unused-css.com/)

看起来不错，但在将其上传到我的任何网站之前，我需要彻底检查其输出的“干净”css。

此外，与所有这些工具一样，**我需要检查它没有去除没有样式的 id 和类，而是用作 JavaScript 选择器。**

以下内容取自[http://unused-css.com/](http://unused-css.com/)因此感谢他们推荐其他解决方案：

> [Latish Sehgal](http://dotnetsurfers.com/blog/2008/10/02/removing-unused-css-classes-from-your-web-application/)编写了一个 Windows 应用程序来查找和删除未使用的 CSS 类。我还没有测试过，但是从描述中，你必须提供你的 html 文件的路径和一个 CSS 文件。然后程序将列出未使用的 CSS 选择器。从屏幕截图来看，似乎无法导出此列表或下载新的干净 CSS 文件。看起来该服务仅限于一个 CSS 文件。如果您有多个要清理的文件，则必须逐个清理它们。
> 
> [Dust-Me Selectors](http://www.sitepoint.com/dustmeselectors/)是一个 Firefox 扩展（适用于 v1.5 或更高版本），用于查找未使用的 CSS 选择器。它从您正在查看的页面上的所有样式表中提取所有选择器，然后分析该页面以查看哪些选择器未使用。然后存储数据，以便在测试后续页面时，可以在遇到选择器时将其从列表中划掉。这个工具应该能够爬取整个网站，但不幸的是我可以让它工作。另外，我不相信您可以配置和下载删除样式的 CSS 文件。
> 
> [Topstyle](http://www.topstyle4.com/)是一个 Windows 应用程序，包括一堆编辑 CSS 的工具。我没有对它进行太多测试，但它看起来能够删除未使用的 CSS 选择器。该软件售价 80 美元。
> 
> [Liquidcity CSS 清理器](http://www.gosquared.com/liquidicity/archives/164)是一个 php 脚本，它使用正则表达式来检查一个页面的样式。它将告诉您 HTML 代码中不可用的类。我没有测试过这个解决方案。
> 
> [Deadweight](https://github.com/aanand/deadweight)是一个 CSS 覆盖工具。给定一组样式表和一组 URL，它会确定实际使用哪些选择器以及可以“安全”删除的列表。该工具是一个 ruby​​ 模块，仅适用于 rails 网站。必须从 CSS 文件中手动删除未使用的选择器。
> 
> [Helium](https://github.com/geuis/helium-css) CSS 是一个 javascript 工具，用于发现网站上许多页面中未使用的 CSS。您首先必须将 javascript 文件安装到要测试的页面。然后，您必须调用氦功能来开始清洁。
> 
> UnusedCSS.com 是具有易于使用的界面的 Web 应用程序。键入站点的 url，您将获得 CSS 选择器列表。对于每个选择器，一个数字表示一个选择器被使用了多少次。此服务有一些限制。不支持 @import 语句。您无法配置和下载新的干净 CSS 文件。
> 
> [CSSESS](http://razorfast.com/2010/11/21/announcing-cssess-the-bookmarklet-that-finds-unused-css-selectors/)是一个小书签，可帮助您在任何站点上找到未使用的 CSS 选择器。这个工具很容易使用，但它不会让你配置和下载干净的 CSS 文件。它只会列出未使用的 CSS 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-04T17:58:28.183

Google Chrome 开发者工具有一个（目前是实验性的）功能，叫做[CSS 概览](https://css-tricks.com/new-in-chrome-css-overview/)，它可以让你找到未使用的 CSS 规则。

要启用它，请执行以下步骤：

1.  打开 DevTools（Mac 上的 Command+Option+I；Windows 上的 Control+Shift+I）
2.  前往 DevTool 设置（Mac 上的功能+F1；Windows 上的 F1）
3.  点击打开实验部分
4.  启用 CSS 概览选项

[![在此处输入图像描述](https://i.stack.imgur.com/xt2gt.png)](https://i.stack.imgur.com/xt2gt.png)

# asp.net - 使用 Global.asax 的优点和缺点是什么？

> ID：135661
> 
> 赞同：7
> 
> 时间：2008-09-25T20:03:51.680
> 
> 标签：asp.net

让我们收集一些技巧来评估 global.asax 的适当使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T20:05:11.507

我以前用它来捕获应用程序级别的错误，并在用户会话到期时执行某些操作。

我也经常使用它来提供从 web.config 读取值的静态属性。

我认为这样的东西还可以，尽管我不会放更多的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T20:24:55.280

如果您的会话和应用程序初始化代码非常小并且特定于应用程序，那么它使用起来很简单。如果您想重用代码，例如设置 URL 重写、重定向或身份验证规则，使用 HttpModule 会更有用。HttpModule 可以涵盖 Global.asax 文件可以涵盖的所有内容。它们也可以使用您的 .config 轻松删除和添加。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T20:19:51.627

*   初始化 ASP.NET MVC。:)
*   自定义用户身份验证。
*   依赖注入，比如扩展[Ninject](http://www.ninject.org/) HttpApplication。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T20:52:24.887

它是一种烈性饮料，注意不要喝太多，你会没事的。

我用它来处理全局错误，并在 mvc 中设置路由。不过，您不想在其中编写全局 page_init 代码。

如果您坚持应用程序级别的事件，并使大部分逻辑实际上存在于这些事件期间刚刚被调用的类中，那么使用全局构造将毫无问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T20:11:29.477

这是获取会话启动，甚至请求启动的好地方。其他人已经提到了错误处理方面，尽管要小心从非 asp.net 线程（例如线程池或自定义线程）抛出的异常，因为它们会绕过 global.asax 处理程序。就我个人而言，我总是有一个，我认为它只是管道的一部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T20:45:19.850

我曾经使用 Global.asax 来处理错误处理等问题，但是，后来我开始使用 HttpModules 来替换它，因为我可以将它从一个项目复制到另一个项目，而无需编辑 global.asax。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T21:51:23.467

与 HttpModule 相比，使用 Global.asax 的缺点：您会很想编写难以重用的代码，因为它太依赖于特定的应用程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T20:08:32.527

Global.asax 可以从你自己的继承 httpapplication 的类继承。为您提供更多选择，并将您可能在全局中拥有的大部分代码放入类库中。

编辑：将您的 HttpApplication 类（global.asax 父级）放在单独的类库中也可以提高可重用性。虽然我同意使用 HttpModules 更适合许多任务，但这仍然有很多用途，其中之一是更简洁的代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T20:08:46.910

我还没有真正使用过 Global.asax。我一直在经典 ASP 中使用它，但这主要与某些配置有关，如数据库连接字符串等。.net 中的配置使很多这些事情变得容易得多。

但是如果你想实现应用程序和会话级别的事件，这就是你需要去的地方。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-11T21:25:58.910

`Session_Start`Global.asax 中的事件是初始化会话变量的好地方。

# python - Python 列表（元组）中每个元素有多少字节？

> ID：135664
> 
> 赞同：17
> 
> 时间：2008-09-25T20:04:09.230
> 
> 标签：python, memory-management

例如，存储一百万（32 位）整数的列表需要多少内存？

```
alist = range(1000000) # or list(range(1000000)) in Python 3.0 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-25T20:10:53.893

“这取决于。” Python 以这样一种方式为列表分配空间，以实现将元素附加到列表的[摊销常数时间](http://effbot.org/zone/python-list.htm)。

在实践中，这对当前实现意味着......列表总是为元素的二次幂分配空间。所以 range(1000000) 实际上会分配一个足够大的列表来容纳 2^20 个元素（~ 104.5 万）。

这只是存储列表结构本身所需的空间（它是指向每个元素的 Python 对象的指针数组）。32 位系统每个元素需要 4 个字节，64 位系统每个元素需要 8 个字节。

此外，您需要空间来存储实际元素。这变化很大。对于小整数（目前是 -5 到 256），不需要额外的空间，但对于较大的数字，Python 会为每个整数分配一个新对象，这需要 10-100 个字节并且往往会导致内存碎片化。

底线：**它很复杂**，Python 列表**不是**存储大型同构数据结构的好方法。为此，请使用该`array`模块，或者，如果您需要进行矢量化数学，请使用 NumPy。

PS-元组与列表不同，它的*设计目的不是*让元素逐渐附加到它们上面。我不知道分配器是如何工作的，但甚至不考虑将它用于大型数据结构:-)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-25T21:00:40.327

有用的链接：

[如何获取python对象的内存大小/使用情况](http://bytes.com/forum/thread757255.html)

[python对象的内存大小？](http://mail.python.org/pipermail/python-list/2002-March/135223.html)

[如果将数据放入字典中，我们如何计算数据大小？](http://groups.google.com/group/comp.lang.python/msg/b9afcfc2e1de5b05)

然而，他们并没有给出明确的答案。要走的路：

1.  使用/不使用列表测量 Python 解释器消耗的内存（使用 OS 工具）。

2.  使用定义某种 sizeof(PyObject) 的第三方扩展模块。

**更新**：

[配方 546530：Python 对象的大小（修订）](http://code.activestate.com/recipes/546530/)

```
import asizeof

N = 1000000
print asizeof.asizeof(range(N)) / N
# -> 20 (python 2.5, WinXP, 32-bit Linux)
# -> 33 (64-bit Linux) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-26T13:08:27.510

**解决问题的“元组”部分**

在典型的构建配置中声明 CPython 的 PyTuple 可以归结为：

```
struct PyTuple {
  size_t refcount; // tuple's reference count
  typeobject *type; // tuple type object
  size_t n_items; // number of items in tuple
  PyObject *items[1]; // contains space for n_items elements
}; 
```

PyTuple 实例的大小在构建过程中是固定的，之后无法更改。PyTuple 占用的字节数可以计算为

> `sizeof(size_t) x 2 + sizeof(void*) x (n_items + 1)`.

这给出了元组的*浅*大小。要获得*完整*大小，您还需要添加以`PyTuple::items[]`数组为根的对象图消耗的总字节数。

值得注意的是，元组构造例程确保只创建空元组的单个实例（单例）。

参考： [Python.h](http://svn.python.org/view/python/tags/r252/Include/Python.h?rev=60915&view=markup)， [object.h](http://svn.python.org/view/python/tags/r252/Include/object.h?rev=60915&view=markup)， [tupleobject.h](http://svn.python.org/view/python/tags/r252/Include/tupleobject.h?rev=60915&view=markup)， [tupleobject.c](http://svn.python.org/view/python/tags/r252/Objects/tupleobject.c?rev=60915&view=markup)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-01T21:28:21.933

> 一个新函数`getsizeof()`接受一个 Python 对象并返回该对象使用的内存量，以字节为单位。内置对象返回正确的结果；第三方扩展可能没有，但可以定义一个 `__sizeof__()`方法来返回对象的大小。

```
kveretennicov@nosignal:~/py/r26rc2$ ./python
Python 2.6rc2 (r26rc2:66712, Sep  2 2008, 13:11:55) 
[GCC 4.2.3 (Ubuntu 4.2.3-2ubuntu7)] on linux2
>>> import sys
>>> sys.getsizeof(range(1000000))
4000032
>>> sys.getsizeof(tuple(range(1000000)))
4000024 
```

显然返回的数字不包括包含的对象消耗的内存（sys.getsizeof(1) == 12）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T20:15:48.220

这是特定于实现的，我很确定。当然，这取决于整数的内部表示——你不能假设它们会被存储为 32 位，因为 Python 为你提供了任意大的整数，所以小整数可能存储得更紧凑。

在我的 Python（核心 2 duo 上的 Fedora 9 上的 2.5.1）上，分配前的 VmSize 为 6896kB，之后为 22684kB。再分配一百万个元素后，VmSize 变为 38340kB。对于 1000000 个整数，这非常粗略地表明大约 16000kB，即每个整数大约 16 个字节。这表明列表的开销*很大*。我会用一大撮盐来接受这些数字。

# .net - 版本控制中的项目结构 - 特定于 .NET

> ID：135670
> 
> 赞同：7
> 
> 时间：2008-09-25T20:04:30.993
> 
> 标签：.net, asp.net, visual-studio, svn

这篇文章与[之前提出的问题类似。](https://stackoverflow.com/questions/16829/structure-of-projects-in-version-control) 我真的想以 TTB 格式设置我的 SVN 存储库，但是在 Visual Studio 2008 (ASP.NET/VB.NET) 中创建项目时，在考虑解决方案文件、项目文件、文件夹时，创建的结构往往不兼容项目、解决方案中的多个项目等。是否有人有脚本或程序来获取新创建的 ASP.NET 项目并尽可能轻松地将其移动到 TTB 格式？

* * *

让我更具体一点。假设我正在创建一个名为 StackOverflowIsAwesome 的项目。我可以将它放入我的本地文件夹结构中（假设它是 c:\working）。当我创建它时，VS 会创建 c:\working\StackOverflowIsAwesome 和一大堆子文件夹（bin、app_data 等）。但我希望我的存储库结构看起来像......

```
StackOverflow 真棒
    /树干
        /垃圾桶
        /应用程序数据
    /标签
    /分支机构

```

那么，有没有一种干净的方法可以始终如一地做到这一点，还是我需要不断地移动/修改文件和文件夹来完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T22:34:37.560

另一种方式：

```
StackOverflowIsAwesome
  /trunk
    /database
    /datafiles
    /documents
    /build
    /installer
    /lib 
        /External_DAL (external that points to shared library)
    /utilities
    /vendor
    /src
      /StackOverFlowIsAwesome
        /StackOverFlowIsAwesome.csprj
        /bin
        /...
      /StackOverFlowIsAwesomeTests
        /StackOverFlowIsAwesomeTests.csprj
        /bin
        /...
  /branches
  /tags 
```

这将适用于每个项目。由于我们使用的是构建脚本，我们不需要将解决方案文件存储在 SVN 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T20:13:01.707

我们采用了一种非常简单的方法：

**文件结构：**

*   解决方案文件夹（包含解决方案文件，构建脚本，也许更多？）
    *   项目文件夹
    *   项目文件夹 2
    *   参考（包含解决方案的共享程序集）。

然后我们只需将整个解决方案文件夹的内容检查到我们的存储库中。我们为每个解决方案使用一个存储库。我不确定这是否是组织解决方案的最佳方式，但它对我们有用。

此外，我们在最高级别进行分支，而不是每个项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T11:31:15.290

对于更大的项目，我们通常在这里使用这种格式：

```
/Project
    /trunk
       /lib/              # Binary imports here (not in svn)

       /src               # Solution file here
          /Libraries      # Library assemblies here
             /StackOverflowIsAwesome.Common

          /Products       # Delivered products here
             /StackOverflowIsAwesome.Site

          /Projects       # internal assemblies here
             /StackOverflowIsAwesome.Tests
    /branches
        /1.x
    /tags
        /StackOverflowIsAwesome-1.0 
```

根据实际项目，非源文件（文档等）在主干根目录下有一个目录，额外的开发资源在 src 下。

下的独立项目在他们自己的 /Project 根目录下，但在同一个存储库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:10:54.613

如果您的 TTB 是常见的而不是每个项目，那么它没有问题。还是我错过了什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:19:46.900

你可以看看这个[以前的帖子](https://stackoverflow.com/questions/71608/how-do-you-set-up-your-net-development-tree)或者这个[项目](http://code.google.com/p/treefrog/)。该项目创建一个 .NET 开发树结构（需要 .NET 3.5）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T20:25:18.727

在处理组成 Visual Studio 解决方案的多个项目时，很难决定如何正确地构建事物。

您需要对结构进行的一个关键方面是使检索特定版本的所有文件变得容易。重要的是要尽可能简单。在颠覆中，将根文件夹复制到标签分支比记住对 X 项目重复相同的操作更容易。

能够在主干线之外长时间工作也很重要。你也必须考虑到这一点。

您可能会发现您的软件有许多自然组合在一起的组件。你可以做这样的事情

```
/tag

/core_library
   /branch
   /main

/business_logic
  /branch
  /main

/report_library
  /branch
  /main

/my_ui
  /branch
  /main 
```

没有简单的答案。你做什么真的取决于你的具体项目。如果一切仍然一团糟，那么也许你需要看看你的项目是如何设计的，看看是否可以改变它以提高理解。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-25T20:46:33.607

我这样做：

1.  在VS中创建项目
2.  将项目文件夹中的所有内容导入 repos/projectname/trunk
3.  添加 repos/branches 和 repos/tags 文件夹

这给了我一个存储库结构，如：

```
projectname
    / trunk
        /bin
        /obj
        /Properties
        projectname.sln
    /tags
    /branches 
```

我可以将所有文件保留在文件系统中的默认位置。

# java - 在 Java 中对 Map 执行最佳 levenshtein 匹配的最佳方法

> ID：135679
> 
> 赞同：1
> 
> 时间：2008-09-25T20:05:59.710
> 
> 标签：java, algorithm

我有一张 Java 地图。我想将源字符串与地图中的所有项目进行比较，并根据 levenshtein 比率算法返回最佳匹配。我想知道对列表中的每个元素执行此检查的最佳方法是什么。

谢谢，马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T22:03:18.507

You won't be able to get better than O(n) performance with a standard Map - just use the naive approach of testing them sequentially.

There are far more efficient ways to do this, though. One of them is called a [bk-tree](http://en.wikipedia.org/wiki/Bk-tree). Basically, you construct an n-way tree, with edges determined by the levenshtein distance between the nodes. Then, you can make use of the [triangle inequality](http://en.wikipedia.org/wiki/Triangle_inequality) to massively cut down the nodes you have to search. For short distances, it's very efficient. Here's a [blog article](http://blog.notdot.net/2007/4/Damn-Cool-Algorithms-Part-1-BK-Trees) I wrote some time ago, describing it in detail. With a little extra work, you can query it for nearest-neighbour, rather than repeatedly querying with distance 1, 2, etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T21:30:47.400

如果遍历所有地图元素的成本太高，您可以考虑使用[k-gram 索引](http://nlp.stanford.edu/IR-book/html/htmledition/k-gram-indexes-for-spelling-correction-1.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T20:13:19.503

由于 levenshtein 比率取决于源和目标，因此每个源字符串的值都会改变。除非源字符串很可能在后续搜索中重复，否则只需遍历地图元素。如果速度确实是个问题，请确保您使用的是最新的 Java 编译器并使用优化选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:22:44.803

当然，如果您还没有这样做，那么请使用现成的优化 Levenshtein 实现，例如 commons-lang StringUtils 中的实现。

# macos - 在 OS X 上设置环境变量

> ID：135688
> 
> 赞同：890
> 
> 时间：2008-09-25T20:06:48.053
> 
> 标签：macos, bash, path, environment-variables

在 OS X 中修改 PATH 等环境变量的正确方法是什么？

我在谷歌上看了一点，发现三个不同的文件要编辑：

*   /etc/路径
*   ~/.profile
*   ~/.tcshrc

我什至没有这些文件，而且我很确定*.tcshrc*是错误的，因为 OS X 现在使用 bash。这些变量，尤其是 PATH，在哪里定义？

我正在运行[OS X v10.5](http://en.wikipedia.org/wiki/Mac_OS_X_Leopard) (Leopard)。

* * *

## 回答 #1

> 赞同：670
> 
> 时间：2009-02-25T23:42:27.430

布鲁诺是正确的。我已经进行了广泛的研究，如果您想设置所有 GUI 应用程序中都可用的变量，您唯一的选择是`/etc/launchd.conf`.

请注意[environment.plist 不适用于通过 Spotlight 启动的应用程序。这由 Steve Sexton 记录在这里](https://web.archive.org/web/20100212232552/https://www.digitaledgesw.com/node/31)。

1.  打开终端提示符

2.  类型`sudo vi /etc/launchd.conf`（注意：此文件可能尚不存在）

3.  将如下内容放入文件中

    ```
    # Set environment variables here so they are available globally to all apps
    # (and Terminal), including those launched via Spotlight.
    #
    # After editing this file run the following command from the terminal to update
    # environment variables globally without needing to reboot.
    # NOTE: You will still need to restart the relevant application (including
    # Terminal) to pick up the changes!
    # grep -E "^setenv" /etc/launchd.conf | xargs -t -L 1 launchctl
    #
    # See http://www.digitaledgesw.com/node/31
    # and http://stackoverflow.com/questions/135688/setting-environment-variables-in-os-x/
    #
    # Note that you must hardcode the paths below, don't use environment variables.
    # You also need to surround multiple values in quotes, see MAVEN_OPTS example below.
    #
    setenv JAVA_VERSION 1.6
    setenv JAVA_HOME /System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home
    setenv GROOVY_HOME /Applications/Dev/groovy
    setenv GRAILS_HOME /Applications/Dev/grails
    setenv NEXUS_HOME /Applications/Dev/nexus/nexus-webapp
    setenv JRUBY_HOME /Applications/Dev/jruby

    setenv ANT_HOME /Applications/Dev/apache-ant
    setenv ANT_OPTS -Xmx512M

    setenv MAVEN_OPTS "-Xmx1024M -XX:MaxPermSize=512m"
    setenv M2_HOME /Applications/Dev/apache-maven

    setenv JMETER_HOME /Applications/Dev/jakarta-jmeter 
    ```

4.  在 vi 中保存您的更改并重新启动您的 Mac。或者使用上面代码注释中显示的[`grep`](http://linux.die.net/man/1/grep)/命令。[`xargs`](https://linux.die.net/man/1/xargs)

5.  通过打开终端窗口并键入来证明您的变量正在工作，`export`您应该会看到新变量。这些也将在 IntelliJ IDEA 和您通过 Spotlight 启动的其他 GUI 应用程序中可用。

* * *

## 回答 #2

> 赞同：286
> 
> 时间：2010-09-21T01:23:56.340

# 不要指望 ~/.launchd.conf 工作

launchctl 的手册页说它从来没有工作过：

> 已弃用和删除的功能
> 
> launchctl 不再具有交互模式，也不接受来自标准输入的命令。/etc/launchd.conf 文件不再用于在早期引导期间运行子命令；出于安全考虑，此功能已被删除。虽然记录在设置用户会话之前会咨询 $HOME/.launchd.conf，但从未实现此功能。

# 如何为 Spotlight 启动的新进程设置环境（无需重启）

您可以使用`launchctl setenv`. 例如设置路径：

```
launchctl setenv PATH /opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin 
```

或者，如果您想设置路径`.bashrc`或类似路径，则将其镜像到 launchd：

```
PATH=/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin
launchctl setenv PATH $PATH 
```

**无需重新启动**，但如果您希望应用程序恢复更改的环境，则需要重新启动应用程序。

这包括已经在 Terminal.app 下运行的任何 shell，尽管如果您在那里，您可以更直接地设置环境，例如使用`export PATH=/opt/local/bin:/opt/local/sbin:$PATH`bash 或 zsh。

# 重启后如何保留更改

## 新方法（自 10.10 Yosemite 起）

使用`launchctl config user path /bin:/usr/bin:/mystuff`. 有关`man launchctl`更多信息，请参阅。

## 以前的方法

该答案顶部的 launchctl 手册页引用说，`/etc/launchd.conf`出于安全原因，此处描述的功能（在启动时读取）已被删除，因此 ymmv.

要**在重新启动后保留更改，**您可以从 设置环境变量`/etc/launchd.conf`，如下所示：

```
setenv PATH /opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin 
```

`launchd.conf`重启时会自动执行。

如果您希望这些更改现在生效，您应该使用此命令重新处理`launchd.conf`（感谢@mklement 的提示！）

```
egrep -v '^\s*#' /etc/launchd.conf | launchctl 
```

您可以通过命令了解更多信息`launchctl`以及它如何加载。`launchd.conf``man launchctl`

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2008-09-25T20:08:30.547

***直到并包括[OS X v10.7](http://en.wikipedia.org/wiki/Mac_OS_X_Lion) (Lion)***，您可以将它们设置为：

```
~/.MacOSX/environment.plist 
```

看：

*   [https://developer.apple.com/legacy/library/qa/qa1067/_index.html](https://developer.apple.com/legacy/library/qa/qa1067/_index.html)
*   [https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html)

对于终端中的 PATH，您应该能够设置`.bash_profile`或`.profile`（尽管您可能必须创建它）

***对于[OS X v10.8](http://en.wikipedia.org/wiki/OS_X_Mountain_Lion) (Mountain Lion) 及更高*** [版本，您需要使用`launchd`和`launchctl`](http://www.dowdandassociates.com/blog/content/howto-set-an-environment-variable-in-mac-os-x-slash-etc-slash-launchd-dot-conf/).

* * *

## 回答 #4

> 赞同：76
> 
> 时间：2015-09-04T20:06:51.913

# 来自单一来源的命令行和 GUI 应用程序的解决方案（适用于[Mac OS X v10.10](https://en.wikipedia.org/wiki/OS_X_Yosemite) (Yosemite) 和[Mac OS X v10.11](https://en.wikipedia.org/wiki/OS_X_El_Capitan) (El Capitan)）

假设您`~/.bash_profile`在以下代码段中具有环境变量定义：

```
export JAVA_HOME="$(/usr/libexec/java_home -v 1.8)"
export GOPATH="$HOME/go"
export PATH="$PATH:/usr/local/opt/go/libexec/bin:$GOPATH/bin"
export PATH="/usr/local/opt/coreutils/libexec/gnubin:$PATH"
export MANPATH="/usr/local/opt/coreutils/libexec/gnuman:$MANPATH" 
```

我们需要一个*启动代理*，它将在每次登录时运行，并且随时按需运行，它将这些变量加载到用户会话中。我们还需要一个 shell 脚本来解析这些定义并构建必要的命令以由代理执行。

在目录中创建一个`plist`后缀（例如命名`osx-env-sync.plist`）的`~/Library/LaunchAgents/`文件，其内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>Label</key>
  <string>osx-env-sync</string>
  <key>ProgramArguments</key>
  <array>
    <string>bash</string>
    <string>-l</string>
    <string>-c</string>
    <string>
      $HOME/.osx-env-sync.sh
    </string>
  </array>
  <key>RunAtLoad</key>
  <true/>
</dict>
</plist> 
```

`-l`参数在这里很关键；必须使用**登录 shell**执行 shell 脚本，以便`~/.bash_profile`在执行此脚本之前首先获取源代码。

现在，shell 脚本。`~/.osx-env-sync.sh`使用以下内容创建它：

```
grep export $HOME/.bash_profile | while IFS=' =' read ignoreexport envvar ignorevalue; do
  launchctl setenv "${envvar}" "${!envvar}"
done 
```

确保 shell 脚本是可执行的：

```
chmod +x ~/.osx-env-sync.sh 
```

现在，为当前会话加载启动代理：

```
launchctl load ~/Library/LaunchAgents/osx-env-sync.plist 
```

（重新）启动一个 GUI 应用程序并验证它是否可以读取环境变量。

*设置是持久的。它将在重新启动和重新登录后继续存在。*

在初始设置（您刚刚完成）之后，如果您想再次将您的任何更改反映`~/.bash_profile`到您的整个环境中，重新运行该`launchctl load ...`命令将不会执行您想要的操作；相反，您会收到如下警告：

`<$HOME>/Library/LaunchAgents/osx-env-sync.plist: Operation already in progress`

为了在不经过注销/登录过程的情况下重新加载您的环境变量，请执行以下操作：

```
launchctl unload ~/Library/LaunchAgents/osx-env-sync.plist
launchctl load ~/Library/LaunchAgents/osx-env-sync.plist 
```

最后确保您重新启动已经运行的应用程序（包括 Terminal.app），以使它们知道这些更改。

我还将此处的代码和解释推送到 GitHub 项目：[osx-env-sync](https://github.com/ersiner/osx-env-sync)。

我希望这将是最终的解决方案，至少对于最新版本的 OS X（Yosemite 和 El Capitan）而言。

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2011-11-25T04:29:38.377

1.  做：

    ```
    vim ~/.bash_profile 
    ```

    该文件可能不存在（如果不存在，您可以创建它）。

2.  输入这个并保存文件：

    ```
    export PATH=$PATH:YOUR_PATH_HERE 
    ```

3.  跑

    ```
    source ~/.bash_profile 
    ```

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2011-03-26T20:03:52.543

在 OS X 中处理环境变量时基本上有两个问题需要解决。第一个是从 Spotlight（Mac 菜单/状态栏右侧的放大镜图标）调用程序时，第二个是从 Dock 调用程序时. 从终端应用程序/实用程序调用程序很简单，因为它从标准 shell 位置（`~/.profile`、、、`~/.bash_profile`等`~/.bashrc`）读取环境。

从 Dock 调用程序时，使用`~/.MacOSX/environment.plist` where`<dict>`元素包含一系列 `<key>KEY</key><string>theValue</string>`元素。

从 Spotlight 调用程序时，请确保已使用您需要的所有键/值设置设置了 launchd。

为了同时解决这两个问题，我在我的用户帐户上使用了登录项（通过系统偏好设置工具设置）。登录项是一个调用 Emacs lisp 函数的 bash 脚本，当然可以使用他们最喜欢的脚本工具来完成同样的事情。这种方法还有一个额外的好处，它可以在任何时候工作并且不需要重新启动，即可以编辑`~/.profile`，在某些 shell 中运行登录项，并且可以从 Dock 或 Spotlight 对新调用的程序进行可见的更改。

细节：

登录项：`~/bin/macosx-startup`

```
#!/bin/bash
bash -l -c "/Applications/Emacs.app/Contents/MacOS/Emacs --batch -l ~/lib/emacs/elisp/macosx/environment-support.el -f generate-environment" 
```

Emacs lisp 函数：`~/lib/emacs/elisp/macosx/envionment-support.el`

```
;;; Provide support for the environment on Mac OS X

(defun generate-environment ()
  "Dump the current environment into the ~/.MacOSX/environment.plist file."
  ;; The system environment is found in the global variable:
  ;; 'initial-environment' as a list of "KEY=VALUE" pairs.
  (let ((list initial-environment)
        pair start command key value)
    ;; clear out the current environment settings
    (find-file "~/.MacOSX/environment.plist")
    (goto-char (point-min))
    (setq start (search-forward "<dict>\n"))
    (search-forward "</dict>")
    (beginning-of-line)
    (delete-region start (point))
    (while list
      (setq pair (split-string (car list) "=")
            list (cdr list))
      (setq key (nth 0 pair)
            value (nth 1 pair))
      (insert "  <key>" key "</key>\n")
      (insert "  <string>" value "</string>\n")

      ;; Enable this variable in launchd
      (setq command (format "launchctl setenv %s \"%s\"" key value))
      (shell-command command))
    ;; Save the buffer.
    (save-buffer))) 
```

注意：这个解决方案是我添加之前的解决方案，特别是由 Matt Curtis 提供的解决方案，但我故意尝试保持我的`~/.bash_profile`内容平台独立并将`launchd`环境设置（仅限 Mac 设备）放入单独的脚本中.

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2013-01-15T14:04:25.993

另一个免费的开源 Mac OS X v10.8 (Mountain Lion) Preference pane/environment.plist 解决方案是[EnvPane](http://diaryproducts.net/EnvPane)。

EnvPane 的[源代码](https://github.com/hschmidt/EnvPane)可在[GitHub](https://github.com/hschmidt/EnvPane)上找到。EnvPane 看起来具有与[RCEnvironment](http://www.rubicode.com/Software/RCEnvironment)类似的功能，但是，它似乎可以立即更新其存储的变量，即*无需*重新启动或登录，这是受欢迎的。

正如开发商所说：

> EnvPane 是 Mac OS X 10.8 (Mountain Lion) 的首选项窗格，可让您在图形和终端会话中为所有程序设置环境变量。它不仅恢复了对 Mountain Lion 中 ~/.MacOSX/environment.plist 的支持，它还立即发布您对环境的更改，而无需注销并重新登录。 <SNIP> EnvPane 包括（并自动安装）一个启动代理，它在 1) 登录后及早 2) 每当 ~/.MacOSX/environment.plist 更改时运行。代理读取 ~/.MacOSX/environment.plist 并通过 launchctl setenv 和 launchctl unsetenv 使用的相同 API 将该文件中的环境变量导出到当前用户的 launchd 实例。

免责声明：我与开发人员或他/她的项目没有任何关系。

PS我喜欢这个名字（听起来像'Ends Pain'）。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2013-01-24T12:30:07.560

在 Mountain Lion 上，所有的`/etc/paths`编辑`/etc/launchd.conf`都没有任何效果！

苹果的开发者论坛说：

> “将 .app 本身的 Info.plist 更改为包含带有所需环境变量的“LSEnvironment”字典。
> 
> ~/.MacOSX/environment.plist 不再受支持。”

所以我直接编辑了应用程序`Info.plist`（右键单击“AppName.app”（在本例中为 SourceTree），然后单击“ `Show package contents`”）。

![显示包装内容](https://i.stack.imgur.com/Z6ZHP.png)

我添加了一个新的密钥/字典对，称为：

```
<key>LSEnvironment</key>
<dict>
     <key>PATH</key>
     <string>/Users/flori/.rvm/gems/ruby-1.9.3-p362/bin:/Users/flori/.rvm/gems/ruby-1.9.3-p362@global/bin:/Users/flori/.rvm/rubies/ruby-1.9.3-p326/bin:/Users/flori/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:</string>
</dict> 
```

（请参阅：[Apple 的 LaunchServicesKeys 文档](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html)）

![在此处输入图像描述](https://i.stack.imgur.com/oiwcE.png)

现在应用程序（在我的例子中是 Sourcetree）使用给定的路径并使用 Git 1.9.3 :-)

PS：当然，您必须根据您的特定路径需求调整路径条目。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2015-10-02T07:31:35.620

### 更新 (2017-08-04)

从（至少）macOS 10.12.6 (Sierra) 开始，此方法似乎已停止对 Apache httpd 工作（对于`system`和 的`user`选项`launchctl config`）。其他程序似乎没有受到影响。可以想象这是httpd的一个bug。

## 原始答案

这涉及 OS X 10.10+（10.11+ 特别是由于无根模式`/usr/bin`不再可写）。

我在多个地方读到，由于 OS X 中的错误（从个人经验来看，这似乎是正确的），因此`launchctl setenv PATH <new path>`用于设置`PATH`变量不起作用。我发现可以为*未从 shell 启动的应用程序*`PATH`设置另一种方法：

 *```
sudo launchctl config user path <new path> 
```

该选项记录在 launchctl 手册页中：

> 配置系统 | 用户参数值
> 
> > 为 launchd(8) 域设置持久配置信息。只能配置系统域和用户域。持久存储的位置是一个实现细节，只能通过此子命令对该存储进行更改。通过此子命令所做的更改需要重新启动才能生效。
> > 
> > [...]
> > 
> > 小路
> > 
> > > 将目标域内所有服务的 PATH 环境变量设置为字符串值。字符串值应符合 environ(7) 中为 PATH 环境变量概述的格式。请注意，如果服务指定了自己的 PATH，则特定于服务的环境变量将优先。
> > > 
> > > 注意：此工具不能用于为域内的所有服务设置通用环境变量。出于安全原因，特意将其限定为 PATH 环境变量，仅此而已。

我已经确认这适用于从 Finder 启动的 GUI 应用程序（用于`getenv`获取 PATH）。请注意，您只需执行一次，更改将在重新启动后保持不变。

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2012-07-17T01:46:15.560

虽然这里的答案不是“错误的”，但我会添加另一个：永远不要在 OS X 中对影响“所有进程”的环境变量进行更改，甚至在 shell 之外，对于给定用户以交互方式运行的所有进程。

以我的经验，对所有进程的 PATH 等环境变量进行全局更改，在 OS X 上比在 Windows 上更容易破坏。原因是，许多 OS X 应用程序和其他软件（可能尤其包括 OS 本身的组件）在底层依赖 UNIX 命令行工具，并假设系统提供的这些工具版本的行为，并且这样做时不一定使用绝对路径（类似的注释适用于动态加载的库和 DYLD_* 环境变量）。例如，考虑到有关替换 OS X 提供的解释器版本（如 Python 和 Ruby）的各种 Stack Overflow 问题的评分最高的答案通常是“不要这样做”。

在这方面，OS X 与其他类 UNIX 操作系统（例如，Linux、FreeBSD 和 Solaris）实际上并没有什么不同。Apple 没有提供简单的方法来做到这一点的最可能原因是因为它*破坏了一些东西*。就 Windows 不太容易出现这些问题而言，这是由于两件事：(1) Windows 软件不像 UNIX 软件那样倾向于依赖命令行工具，以及 (2) 微软有由影响所有进程的更改引起的“DLL 地狱”和安全问题的历史如此广泛，以至于它们已经更改了较新 Windows 版本中动态加载的行为，以限制“全局”配置选项（如 PATH）的影响。

“蹩脚”与否，如果您将此类更改限制在较小的范围内，您将拥有一个更加稳定的系统。

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2009-01-16T12:12:17.137

有时，所有先前的答案都根本不起作用。如果您想`M2_HOME`在 Eclipse 或 IntelliJ IDEA 中访问系统变量（如 ），那么在这种情况下唯一对我有用的是：

首先（第 1 步）编辑`/etc/launchd.conf`以包含这样的一行：“setenv VAR value”，然后（第 2 步）重新启动。

简单地修改 .bash_profile 是行不通的，因为在 OS X 中，应用程序不像在其他 Unix 中那样启动；它们不继承父级的 shell 变量。由于我不知道的原因，所有其他修改都不起作用。也许其他人可以澄清这一点。

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2011-07-06T23:59:07.153

在追逐[环境变量首选项窗格](http://www.apple.com/downloads/macosx/system_disk_utilities/environmentvariablepreferencepane.html)并发现链接已损坏并且在 Apple 网站上的搜索似乎表明他们已经忘记了它之后......我开始回到难以捉摸的启动过程的踪迹。

在我的系统（Mac OS X 10.6.8）上，似乎 environment.plist*中*定义的变量被可靠地导出到从 Spotlight 启动的应用程序（通过 launchd）。我的麻烦是这些变量没有被导出到终端中的新 bash 会话中。即我有这里描述的相反问题。

注意： environment.plist 看起来像 JSON，而不是 XML，如前所述

我能够通过[编辑 ~/MacOSX/environment.plist让 Spotlight 应用程序查看变量，](http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html%23//apple_ref/doc/uid/20002093-BCIJIJBH) **并且** 通过将以下内容添加到我的 .profile 文件中，我能够强制相同的变量进入新的终端会话：

```
eval $(launchctl export) 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2008-09-25T20:08:50.857

任何 Bash 启动文件 -- `~/.bashrc`, `~/.bash_profile`, `~/.profile`. 在 GUI 应用程序中还有一些以`~/.MacOSX/environment.plist`环境变量命名的奇怪文件。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2014-02-27T16:53:44.623

就像马特柯蒂斯给出的答案一样，我通过launchctl设置环境变量，但我将它包装在一个名为export的函数中，这样每当我在我的.bash_profile中导出一个正常的变量时，它也是由launchctl设置的。这是我所做的：

1.  我的 .bash_profile 仅包含一行，（这只是个人喜好。）

    ```
    source .bashrc 
    ```

2.  我的 .bashrc 有这个：

    ```
    function export()
    {
        builtin export "$@"
        if [[ ${#@} -eq 1 && "${@//[^=]/}" ]]
        then
            launchctl setenv "${@%%=*}" "${@#*=}"
        elif [[ ! "${@//[^ ]/}" ]]
        then
            launchctl setenv "${@}" "${!@}"
        fi
    }

    export -f export 
    ```

3.  以上将重载 Bash 内置“export”并正常导出所有内容（您会注意到我用它导出“export”！），然后通过 launchctl 为 OS X 应用程序环境正确设置它们，无论您使用以下任何一种：

    ```
    export LC_CTYPE=en_US.UTF-8
    # ~$ launchctl getenv LC_CTYPE
    # en_US.UTF-8
    PATH="/usr/local/bin:${PATH}"
    PATH="/usr/local/opt/coreutils/libexec/gnubin:${PATH}"
    export PATH
    # ~$ launchctl getenv PATH
    # /usr/local/opt/coreutils/libexec/gnubin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin
    export CXX_FLAGS="-mmacosx-version-min=10.9"
    # ~$ launchctl getenv CXX_FLAGS
    # -mmacosx-version-min=10.9 
    ```

4.  这样我就不必每次都将每个变量都发送到 launchctl，我可以让我的 .bash_profile / .bashrc 以我想要的方式设置。打开终端窗口，检查您感兴趣的环境变量`launchctl getenv myVar`，更改 .bash_profile/.bashrc 中的某些内容，关闭终端窗口并重新打开它，使用 launchctl 再次检查变量，瞧，它已更改。

5.  同样，与后 Mountain Lion 世界的其他解决方案一样，对于任何可用于应用程序的新环境变量，您需要在更改后启动或重新启动它们。

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2013-09-24T03:24:00.180

这是一种非常简单的方法来做你想做的事。就我而言，它让 Gradle 工作（对于 Android Studio）。

*   打开终端。
*   运行以下命令：

    `sudo nano /etc/paths`或者`sudo vim /etc/paths`

*   出现提示时输入您的密码。

*   转到文件底部，然后输入要添加的路径。
*   点击`Control`+`X`退出。
*   输入“Y”以保存修改后的缓冲区。
*   打开一个新的终端窗口，然后输入：

    `echo $PATH`

您应该会看到附加到 PATH 末尾的新路径。

我从这篇文章中得到了这些细节：

*[在 Mac OS X 10.8 Mountain Lion 及更高版本上添加到 PATH](http://architectryan.com/2012/10/02/add-to-the-path-on-mac-os-x-mountain-lion/#.UkED3rxPp3Q)*

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2010-12-02T14:37:51.463

我认为 OP 正在寻找一个简单的、类似 Windows 的解决方案。

干得好：

[http://www.apple.com/downloads/macosx/system_disk_utilities/environmentvariablepreferencepane.html](http://www.apple.com/downloads/macosx/system_disk_utilities/environmentvariablepreferencepane.html)

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2014-11-09T15:36:21.910

简洁明了每个文件的用途

*   `~/.profile`每次启动 Terminal.app 时都会获取
*   `~/.bashrc`是“传统上”设置 Bash 环境的所有导出语句的位置
*   `/etc/paths`是 Mac OS 中的主文件，其中包含为所有用户构建 PATH 环境变量的默认路径列表
*   `/etc/paths.d/`包含包含其他搜索路径的文件

非终端程序不会像您的终端那样继承系统范围的 PATH 和 MANPATH 变量！要为特定用户启动的所有进程设置环境，从而使环境变量可用于 Mac OS X GUI 应用程序，必须在您的`~/.MacOSX/environment.plist`(Apple Technical Q&A QA1067)中定义这些变量

使用以下命令行与您`environment.plist`同步`/etc/paths`：

```
defaults write $HOME/.MacOSX/environment PATH "$(tr '\n' ':' </etc/paths)" 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2018-01-07T17:32:55.300

/etc/launchd.conf 不用于 OS X v10.10 (Yosemite)、OS X v10.11 (El Capitan)、macOS v10.12 (Sierra) 或 macOS v10.13 (High Sierra)。

* * *

从`launchctl`手册页：

```
/etc/launchd.conf file is no longer consulted for subcommands to run during early boot time;
this functionality was removed for security considerations. 
```

这个[*Ask Different*答案](https://apple.stackexchange.com/questions/106355/setting-the-system-wide-path-environment-variable-in-mavericks)中描述的方法对我有用（重启后）：从 Dock 或 Spotlight 启动的应用程序继承了我在`~/Library/LaunchAgents/my.startup.plist`. （就我而言，我需要为 Sublime Text 插件设置`LANG`, to `en_US.UTF-8`。）

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2012-03-22T11:16:28.733

该变量`$PATH`也`path_helper`受.`/etc/paths``/etc/paths.d`

更详尽的描述可以*[在 Leopard](http://hea-www.harvard.edu/~fine/OSX/path_helper.html)* (2008-11)中的 PATH 和其他环境问题中找到

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2014-10-08T18:56:38.637

只是这样做非常简单快捷。首先从终端创建一个**~/.bash_profile ：**

```
touch .bash_profile 
```

然后

```
open -a TextEdit.app .bash_profile 
```

添加

```
export TOMCAT_HOME=/Library/Tomcat/Home 
```

保存文件，你就完成了。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-09-25T21:12:55.023

好吧，我不确定`/etc/paths`and`~/.MacOSX/environment.plist`文件。那些是新的。

但是对于 Bash，您应该知道它`.bashrc`在每次新的 shell 调用时都会执行，并且`.bash_profile`只在启动时执行一次。

我不知道 Mac OS X 出现这种情况的频率有多高。我认为随着窗口系统启动所有内容，这种区别已经消失。

就个人而言，我通过创建一个`.bashrc`包含我需要的所有内容的文件来消除混淆，然后执行以下操作：

```
ln -s .bashrc .bash_profile 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-09-25T20:09:14.553

对于单个用户修改，请使用`~/.profile`您列出的修改。以下链接解释了 Bash 何时读取不同的文件。

[http://telin.ugent.be/~slippens/drupal/bashrc_and_others](http://telin.ugent.be/~slippens/drupal/bashrc_and_others)

如果要为 gui 应用程序设置环境变量，则需要 ~/.MacOSX/environment.plist 文件

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2011-02-07T00:12:17.977

除了建议的方法之外，需要注意的一件事是，至少在[OS X 10.5](http://en.wikipedia.org/wiki/Mac_OS_X_Leopard)`launchd.conf` (Leopard) 中，设置的变量将与`.profile`. 我想这也可能对设置有效`~/.MacOSX/environment.plist`，但我还没有验证。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2014-01-25T01:55:30.190

这很简单：

编辑 ~/.profile 并把你的变量如下

> $ vim ~/.profile

在文件中：

> MY_ENV_VAR=值

1.  保存 ( :wq )

2.  重新启动终端（退出并再次打开）

3.  确保一切正常：

> $ 回声 $MY_ENV_VAR
> 
> 美元价值

* * *

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2014-02-17T16:25:58.707

这很简单。编辑文件`.profile`（vi、[nano](https://en.wikipedia.org/wiki/GNU_nano)、[Sublime Text](http://en.wikipedia.org/wiki/Sublime_Text)或其他文本编辑器）文件。您可以在`~/`目录（用户目录）中找到它并设置如下：

```
export MY_VAR=[your value here] 
```

Java 主页示例：

```
export JAVA_HOME=/Library/Java/JavaVirtualMachines/current 
```

保存并返回终端。

您可以使用以下方法重新加载它：

```
source .profile 
```

或者关闭并打开您的终端窗口。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2013-12-19T11:54:49.450

## 在 Mac OS 上设置 PATH 环境变量

打开终端程序（默认情况下，它位于您的 Applications/Utilities 文件夹中）。运行以下命令

```
touch ~/.bash_profile; open ~/.bash_profile 
```

这将在您的默认文本编辑器中打开该文件。

**以 Android SDK 为例：**

您需要将路径添加到您的 Android SDK 平台工具和工具目录。在我的示例中，我将使用“/Development/android-sdk-macosx”作为安装 SDK 的目录。添加以下行：

```
export PATH=${PATH}:/Development/android-sdk-macosx/platform-tools:/Development/android-sdk-macosx/tools 
```

保存文件并退出文本编辑器。执行您的 .bash_profile 以更新您的 PATH：

```
source ~/.bash_profile 
```

现在，每次打开终端程序时，您的 PATH 都将包含 Android SDK。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2018-10-15T20:00:28.977

iOS 上的所有魔法都只与文件一起使用`source`，您可以在其中导出环境变量。

**例如：**

您可以像这样创建一个文件：

```
export bim=fooo
export bom=bar 
```

将此文件另存为`bimbom.env`，然后执行`source ./bimbom.ev`. 瞧，你得到了你的环境变量。

检查它们：

```
echo $bim 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2015-04-27T20:53:05.427

**登录外壳**

```
/etc/profile 
```

shell 首先执行 file 中的命令`/etc/profile`。使用 root 权限的用户可以设置这个文件来为运行 Bash 的用户建立系统范围的默认特性。

```
.bash_profile
.bash_login
.profile 
```

接下来，shell 会按顺序查找`~/.bash_profile`、、`~/.bash_login`和`~/.profile`（~/ 是主目录的简写），执行它找到的第一个文件中的命令。您可以将命令放在这些文件之一中以覆盖`/etc/profile`. 在虚拟终端上运行的 shell 不会执行这些文件中的命令。

```
.bash_logout 
```

当您注销时，bash 会执行`~/.bash_logout`文件中的命令。该文件通常包含在会话后清理的命令，例如删除临时文件的命令。

**交互式非登录外壳**

```
/etc/bashrc 
```

虽然不直接被 bash 调用，但是很多`~/.bashrc`文件调用`/etc/bashrc`. 此设置允许使用 root 权限的用户为非登录 bash shell 建立系统范围的默认特征。

```
.bashrc 
```

交互式非登录 shell 执行`~/.bashrc`文件中的命令。通常，登录 shell 的启动文件（例如`.bash_profile`）运行此文件，因此登录和非登录 shell 都运行`.bashrc`.

**因为 in 中的命令`.bashrc`可能会执行多次，并且因为子 shell 继承了导出的变量，所以最好将添加到现有变量的命令放在`.bash_profile`文件中。**

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2015-01-21T22:49:32.247

这里有两种类型的炮弹。

*   非登录：每次启动新的 Bash 副本时都会重新加载 .bashrc
*   登录：仅当您登录或明确告诉 Bash 加载它并将其用作登录 shell 时才会加载 .profile。

这里重要的是要理解，使用 Bash，文件`.bashrc`只能由交互式和非登录的 shell 读取，您会发现人们经常加载`.bashrc`以`.bash_profile`克服这个限制。

现在您已经有了基本的了解，让我们继续讨论我将如何建议您进行设置。

*   .profile：创建它不存在。把你的 PATH 设置放在那里。
*   .bashrc：如果不存在则创建。把你所有的别名和自定义方法放在那里。
*   .bash_profile：如果不存在则创建。将以下内容放入其中。

.bash_file:

```
#!/bin/bash
source ~/.profile # Get the PATH settings
source ~/.bashrc  # Get Aliases and Functions
# 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2022-02-02T16:24:43.013

# 2022 年 2 月（MacOs 12+）

此处的解决方案应该在重新启动或应用程序重新启动后工作。

## 命令行界面

打开您选择的 CLI 配置文件。

*   对于 bash 打开`~/.bash_profile`
*   对于 zsh 打开`~/.zshrc`

添加（或替换）

```
export varName=varValue 
```

（如果`varValue`里面有空格 - 把它包起来`"`）

确保重新启动命令行应用程序。

## 图形用户界面

完成 CLI 步骤。确保 GUI 应用程序已关闭。从命令行打开 GUI 应用程序。例如：

```
open /Applications/Sourcetree.app 
```

（您也可以在 中为该命令起别名`.zshrc`）

### 原则

*   Mac 没有为所有上下文设置环境变量的配置选项。
*   避免更改用户配置文件之外的任何内容。

### 不再工作了

*   `launchctl config user varName varVal`(MacOS 12.1+)
*   编辑`/etc/launchd.conf`
*   `plist`带后缀的xml文件

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-07-10T11:31:00.727

对于 Bash，请尝试将您的环境变量添加到文件`/etc/profile`中，以使它们可供所有用户使用。无需重新启动，只需启动一个新的终端会话。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-10-23T07:40:08.630

我个人的做法是`.bash_profile`。我在那里添加路径并附加到路径变量，

```
GOPATH=/usr/local/go/bin/
MYSQLPATH=/usr/local/opt/mysql@5.6/bin

PATH=$PATH:$GOPATH:$MYSQLPATH 
```

之后，我可以拥有单独的 Path by`echo $GOPATH`或`echo$MYSQLPATH`all by `echo $PATH`。

# sql - 你能有太多的存储过程吗？

> ID：135701
> 
> 赞同：14
> 
> 时间：2008-09-25T20:08:48.580
> 
> 标签：sql, database-design

是否存在存储过程过多之类的东西？

我知道你可以拥有的数量是没有限制的，但这是否有任何性能或架构原因不创建数百、数千？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T20:12:22.627

对我来说，成百上千个存储过程的最大限制是可维护性。即使这不是直接的性能影响，它也应该是一个考虑因素。这是一个架构的观点，你不仅要为应用程序的初始开发做计划，还要为未来的更改和维护做计划。

话虽如此，您应该设计/创建应用程序所需的数量。尽管使用 Hibernate、NHibernate、.NET LINQ，但我会尝试在代码中保留尽可能多的存储过程逻辑，并且仅在速度是一个因素时才将其放入数据库中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T20:45:53.437

是的你可以。

[如果你有超过零，你有太多](https://stackoverflow.com/questions/15142/what-are-the-pros-and-cons-to-keeping-sql-in-stored-procs-versus-code#15153)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T20:43:31.570

我的商业 SQL Server 2005 产品中只有不到 200 个，在接下来的几天中，对于一些新报告，它可能会再增加大约 10-20 个。

在可能的情况下，我会编写“子例程”存储过程，因此每当我发现自己将 3 或 4 个相同的语句放在多个存储过程中时，如果您明白我的意思，是时候将这几个语句变成子例程了。

我不倾向于使用 sprocs 来执行所有业务逻辑，我只是​​更喜欢让 sprocs 做任何可以被视为“事务性”的事情 - 所以我的客户端代码（在 Delphi 中，但无论如何）可能会做奇怪的插入或更新本身，一旦某些东西需要“一次”更新或插入一些东西，就该使用sproc了。

我有一个简单粗暴的命名约定来帮助提高可读性（和维护！）

该产品的代号是“Rachel”，所以我们有

```
RP_whatever - 这些是更新/插入数据的通用存储过程，
              - 或返回小结果集

RXP_whatever - 这些是作为“函数”服务的子程序存储过程
              - 或 RP_ 类型 procs 的工人

REP_whatever - 这些是几乎充当美化视图的存储过程
              - 他们不改变数据，他们返回潜在的复杂结果集
              - 用于报告等

XX_whatever - 这些是内部测试/开发/维护存储过程
              - 客户端应用程序（或本地 dba）通常不会使用

```

命名是任意的，只是为了帮助区分 SQL Server 使用的 sp_ 前缀。

我想如果我发现数据库中有 400-500 个 sproc，我可能会担心，但只要您有一个系统来识别每个 sproc 负责的活动类型，几百个就不是问题。我宁愿在几百个存储过程中追踪架构更改（SQL Server 工具可以帮助您找到依赖项等），而不是尝试在我的高级编程语言中追踪架构更改。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-27T02:31:43.617

我想这里更深层次的问题是——所有这些代码还应该去哪里？视图可用于通过标准 SQL 方便地访问数据。更强大的应用程序语言和库可用于生成 SQL。存储过程往往会掩盖数据的性质，并为系统引入不必要的抽象层、复杂性和维护层。

鉴于对象关系映射工具生成基本 SQL 的能力，任何过度依赖存储过程的系统的开发效率都会降低。使用 ORM，只需编写更少的代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T20:11:27.293

您的意思是除了在对数据库进行更改时必须维护所有这些之外吗？这就是我的重要原因。最好有更少的可以处理多种场景的场景，而不是数百个只能处理一种场景的场景。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-25T20:12:40.707

我只想提一下，在所有这些事情中，维护成为一个问题。谁知道它们都是什么以及它们的用途是什么？如果它们只是遗留系统的产物，没有人能回忆起它们的用途，但又害怕惹麻烦，那么几年后会发生什么？

我认为主要的问题是不可能，但应该这样做。无论如何，这只是一个想法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-25T20:37:00.400

地狱是的，你可以有太多。几年前我在一个系统上工作过，它有大约 10,000 个 procs。这太疯狂了。编写系统的人并不真正知道如何编程，但他们确实知道如何纠正结构不良的 procs，因此他们将几乎所有应用程序逻辑都放在了 procs 中。一些 procs 运行了数千行。管理混乱是一场噩梦。

太多（我无法在沙子中为您画出一条特定的线）可能表明设计不佳。此外，正如其他人所指出的，有更好的方法来实现粒度数据库接口，而无需求助于大量的 proc。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T20:13:31.783

我的问题是，如果您谈论成百上千的存储过程，为什么不使用某种中间件平台？

称我为老式的，但我认为数据库应该只保存数据，而程序应该是制定业务逻辑决策的程序。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-25T20:35:20.717

在 Oracle 数据库中，您可以使用 Packages 将相关过程组合在一起。

其中一些和您的命名空间将被释放。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-25T21:41:43.270

任何特定的事情太多可能意味着你做错了。配置文件太多，屏幕上的按钮太多...

不能代表其他 RDBMS，但使用 PL/SQL 的 Oracle 应用程序应该在逻辑上将过程和函数捆绑到包中，以防止级联失效并更好地管理代码。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-27T18:40:37.313

对我来说，使用大量存储过程似乎会引导您走向与 PHP API 等效的东西。数以千计的可能彼此无关的全局函数全部组合在一起。将它们联系起来的唯一方法是有一些命名约定，在每个函数前面加上一个模块名称，类似于 PHP 中的 mysql_ 函数。我认为这很难维护，也很难保持一切一致。我认为存储过程适用于真正需要在服务器上发生的事情。一个简单的选择查询的存储过程，甚至是一个带有连接的选择查询可能会走得很远。仅在实际需要在数据库服务器上处理高级逻辑的情况下使用存储过程。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-25T20:12:49.427

正如其他人所说，这实际上归结为管理方面。过了一会儿，它变成了大海捞针。当命名标准不佳时，情况更是如此......

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-25T20:15:18.080

不，不是我知道的。但是，您应该为它们制定一个良好的命名约定。例如，以 usp_ 开头是很多人喜欢做的事情（比以 sp_ 开头要快）。

也许你的报告存储过程应该是usp_reporting_，你的业务对象应该是usp_bussiness_等等。只要你可以管理它们，拥有很多它们应该没有问题。

如果它们变得太大，您可能希望将数据库拆分为多个数据库。这可能更具逻辑意义，并且可以帮助解决数据库大小等问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-25T20:21:59.953

如果你有很多存储过程，你会发现你把自己绑在一个数据库上——其中一些可能不容易转移。

将自己绑定到一个数据库并不是好的设计。

此外，如果您在数据库和业务层中有业务逻辑，那么维护就会成为问题。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T21:57:32.967

是的，你可以有太多的存储过程。

命名约定可以真正帮助解决这个问题。例如，如果您有一个命名约定，其中始终有表名和 InsUpd 或 Get，那么在需要时很容易找到*正确*的存储过程。如果您没有某种标准的命名约定，那么很容易想出两个（或更多）几乎完全相同的过程。

如果没有标准化的命名约定，很容易找到以下几个... usp_GetCustomersOrder、CustomerOrderGet_sp、GetOrdersByCustomer_sp、spOrderDetailFetch、GetCustOrderInfo 等。

当您拥有大量存储过程时，另一件开始发生的事情是您将拥有一些从未使用过的存储过程和一些很少使用的存储过程......如果您没有某种方法来跟踪存储过程的使用情况，那么您要么会导致很多未使用的程序......或者更糟糕的是，摆脱一个你认为从未使用过的程序，然后发现它每年或每季度只使用一次。:(

杰夫

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-26T21:36:38.663

当你有健全的命名约定、最新的文档和足够的单元测试来保持它们的组织时，就不会了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-27T02:46:29.823

我的第一个大项目是使用抽象数据库的对象关系映射器开发的，所以我们做了所有面向对象的事情，更容易维护和修复错误，而且由于所有数据访问和业务逻辑都是 C# 代码，因此进行更改特别容易，然而，当涉及到做复杂的事情时，系统感觉很慢，所以我们不得不解决这些事情或重新设计项目，尤其是当 ORM 必须在数据库中进行复杂的连接时。

我现在在一家不同的公司工作，该公司的座右铭是“我们的应用程序只是数据库的前端”，它有其优点和缺点。我们有非常快的应用程序，因为所有的数据操作都是在存储过程上完成的，这主要使用 SQL Server 2005，但是，当涉及到对软件进行更改或修复时，它就更难了，因为你必须同时更改两者， C# 代码和 SQL 存储过程，所以它就像工作两次，与我使用 ORM 时相反，你在 sql、Management Studio 和其他工具中没有重构或强类型对象有很大帮助，但通常你会花更多时间这样做.

所以我想说，根据项目的需要，如果您不打算保留真正复杂的业务数据，那么您甚至可以完全避免使用存储过程并使用使开发人员生活更轻松的 ORM。如果您关心性能并且需要节省所有资源而不是使用存储过程，当然，数量取决于您设计的体系结构，因此例如，如果您总是有用于 CRUD 操作的存储过程，您将需要一个对于插入，一个用于更新，一个用于删除，一个用于选择，一个用于列出，因为这些是最常见的操作，如果您有 100 个业务对象，将这 4 个乘以，您将得到 400 个存储过程，仅用于管理最基本的操作对您的对象进行的操作，是的，它们可能太多了。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T20:11:16.357

我认为只要您将它们命名为 uspXXX 而不是 spXXX，则按名称查找将是直接的，因此没有缺点-尽管您可能想知道如果您有数千个 proc 来概括这些 proc...

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-09-26T11:17:13.637

你必须把所有的代码放在某个地方。
如果您将拥有存储过程（我个人很喜欢它们，但很多人不喜欢），那么您不妨尽可能多地使用它们。至少所有的数据库逻辑都在一个地方。缺点是一个充满存储过程的存储桶通常没有太多结构。

你的来电！:)

# sql - 有哪些不同类型的索引，每种索引的好处是什么？

> ID：135730
> 
> 赞同：32
> 
> 时间：2008-09-25T20:12:25.530
> 
> 标签：sql, database, database-design, indexing

有哪些不同类型的索引，每种索引的好处是什么？

我听说过覆盖索引和聚集索引，还有更多吗？你会在哪里使用它们？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-25T20:23:52.957

*   唯一 - 保证索引中包含的列（或列集）的唯一值
*   覆盖 - 包括在特定查询（或一组查询）中使用的所有列，允许数据库仅使用索引而实际上不必查看表数据来检索结果
*   聚集 - 这是实际数据在磁盘上排序的方式，这意味着如果查询使用聚集索引来查找值，则不必采取额外步骤来查找任何数据的实际表行不包括在索引中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T20:13:50.830

[OdeToCode 有一篇很好的文章，涵盖了基本的区别](http://www.odetocode.com/Articles/70.aspx)

正如文章中所说：

> 正确的索引对于大型数据库的良好性能至关重要。有时你可以用一个好的索引来弥补一个写得不好的查询，但即使是最好的查询也很难弥补糟糕的索引。

也确实如此……如果您刚开始使用它，我将专注于聚集索引和复合索引，因为它们可能是您最常使用的索引。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T20:16:14.943

我将添加几个索引类型

BITMAP - 当您的不同可能值数量非常少时，速度非常快且不占用太多空间

PARTITIONED - 允许基于某些属性对索引进行分区，这些属性通常对非常大的数据库对象有利，因为存储或性能原因。

FUNCTION/EXPRESSION 索引 - 用于根据表预先计算一些值并将其存储在索引中，一个非常简单的示例可能是基于 lower() 或子字符串函数的索引。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-25T21:29:18.667

PostgreSQL 允许部分索引，其中只有匹配谓词的行才被索引。例如，您可能希望仅为那些活动的记录索引客户表。这可能看起来像：

```
create index i on customers (id, name, whatever) where is_active is true; 
```

如果您的索引很多列，并且您有很多不活跃的客户，那么这在空间（索引将存储在更少的磁盘页面中）和性能方面可能是一个巨大的胜利。要达到索引，您至少需要指定谓词：

```
select name from customers where is_active is true; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-26T23:14:26.617

传统观点认为索引选择应该基于基数。他们会说，

> 对于像 GENDER 这样的*低基数列，使用位图。*对于像 LAST_NAME 这样的*高基数*，使用 b-tree。

**这不是 Oracle 的情况**，索引选择应该基于应用程序的类型（OLTP 与 OLAP）。具有位图索引的表上的 DML 可能会导致严重的锁争用。另一方面，Oracle CBO 可以轻松地将多个位图索引组合在一起，并且可以使用位图索引来搜索空值。作为基本规则：

> 对于具有频繁 DML 和例行查询的*OLTP*系统，请使用 btree。对于具有不频繁 DML 和即席查询的*OLAP*系统，请使用位图。

我不确定这是否适用于其他数据库，欢迎评论。以下文章进一步讨论了该主题：

*   [位图索引与 B 树索引：哪个和何时？](http://www.oracle.com/technology/pub/articles/sharma_indexes.html "由维韦克夏尔马")
*   [了解位图索引](http://www.dbazine.com/oracle/or-articles/jlewis3 "乔纳森·刘易斯")

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T20:26:18.723

不同的数据库系统对同一类型的索引有不同的名称，所以要小心。例如，SQL Server 和 Sybase 所称的“聚集索引”在 Oracle 中称为“索引组织表”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T20:27:21.967

我建议您搜索 Jason Massie ( [http://statisticsio.com/](http://statisticsio.com/) ) 和 Brent Ozar ( [http://www.brentozar.com/](http://www.brentozar.com/) ) 的博客以获取相关信息。他们有一些关于处理索引的现实场景的帖子。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T21:36:32.457

Oracle 具有 b 树、位图、分区和非分区、反向字节、位图连接和域索引的各种组合。

这是关于该主题的 11gR1 文档的链接：http: [//download.oracle.com/docs/cd/B28359_01/server.111/b28274/data_acc.htm#PFGRF004](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/data_acc.htm#PFGRF004)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-22T17:54:45.803

1.  独特
2.  簇
3.  非集群
4.  列存储
5.  包含列的索引
6.  计算列上的索引
7.  过滤
8.  空间的
9.  xml
10.  全文

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-26T22:19:53.440

SQL Server 2008 有[过滤索引](http://www.google.md/search?q=microsoft+sql+server+2008+filtered+indexes)，类似于 PostgreSQL 的[部分索引](http://www.postgresql.org/docs/8.0/static/indexes-partial.html)。两者都允许在索引中仅包含与指定条件匹配的行。

语法与 PostgreSQL 相同：

```
create index i on Customers(name) where is_alive = cast(1 as bit); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-09-14T11:57:07.143

要查看索引的类型及其含义，请访问： [https ://msdn.microsoft.com/en-us/library/ms175049.aspx](https://msdn.microsoft.com/en-us/library/ms175049.aspx)

# windows - 使用 Windows 键在 Windows 上的 Emacs 中向下翻页和向上翻页

> ID：135734
> 
> 赞同：2
> 
> 时间：2008-09-25T20:12:59.317
> 
> 标签：windows, emacs, editor

我正在尝试学习 Emacs 并尝试为我找到最佳的键盘布局。有一件事真的让我很烦。我在 .emacs 中添加了以下几行

```
(global-set-key "\C-y" 'scroll-up)
(global-set-key "\M-y" 'scroll-down) 
```

当我按住`Control`并按`y`几次时，它会在每次按下时向下翻页`y`。

**但是**，当我按住`Windows`键（映射为`Meta`）并按`y`几次时，它只会在第**一次**按下`y`和所有后续按下时向上翻页，`y`我会在缓冲区中插入“y”字符。

向上翻页的行为可以像向下翻页一样吗？我想按住`Meta`并按住`y`以向上滚动多个页面。

我在 LENNART-69DE564（已修补）上使用 2008-05-12 的 GNU Emacs 23.0.60.1 (i386-mingw-nt5.1.2600)。它是带有 EmacsW32 补丁的 Emacs。这个 Emacs 有这个问题吗？元键有问题？

我尝试了原始的 GNU Emacs（未打补丁），它适用于`Alt`. 但我的问题不是我想在不释放任何键的情况下滚动。我释放键`y`并多次按下它，但不想释放`Meta`键。此处描述了相同的问题：

[http://groups.google.com/group/gnu.emacs.help/browse_thread/thread/f30f4b75a8b75b10](http://groups.google.com/group/gnu.emacs.help/browse_thread/thread/f30f4b75a8b75b10)

问题不在于我更改了键映射。看起来这是 EmacsW32 版本中的一个错误。这是问题的另一种描述： 未发布的[Meta/Win 修饰符](http://www.nabble.com/23.0.60--Unreleased-Meta-Win-modifier-td19213327.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T12:38:43.393

1.  使用`C-v`和`M-v`。
2.  不要更改`C-y`，`M-y`默认绑定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T21:55:23.533

这可能是使用 Windows 键作为 Meta 的副作用吗？我在想这是因为在非 Emacs 情况下，如果您按住 Windows 键和另一个快捷键（Win+E 用于资源管理器，Win+R 用于运行对话框等），所需的操作只会触发一次，如果您一直按住它，则不会多次。

我会尝试将 Meta 重新分配给 Alt，看看问题是否仍然存在。如果没有，那么我不确定您还有什么其他选项，因为很可能是操作系统仅将 Windows 按键一次发送到焦点应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T13:30:00.483

如果您希望 Windows 键作为 Meta，您应该使用修补过的 EmacsW32 版本。

从关于补丁的网站：

“使得可以在 Emacs 中将窗口键盘键用作 META 的更改。没有此修补程序键序列，如 E 将始终执行它们在 Windows 中默认执行的操作，即在这种情况下打开 Windows 资源管理器。（未使用此修补程序默认情况下，您必须将其打开。）”

# wcf - WCF - 如何接受长字符串作为参数

> ID：135745
> 
> 赞同：3
> 
> 时间：2008-09-25T20:14:38.143
> 
> 标签：wcf, web-services

我有一个简单的 Web 服务，它需要 2 个参数，一个是简单的 xml 安全令牌，另一个通常是一个长 xml 字符串。它适用于短字符串，但较长的字符串会给出 400 错误消息。maxMessageLength 没有做任何事情来允许更长的字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-26T12:05:02.187

在配额回答之后，我只是在 web.config 中完成了所有这些

```
<bindings>
  <wsHttpBinding>
    <binding name="WSHttpBinding_IPayroll" maxReceivedMessageSize="6553600">
      <security mode="None"/>
      <readerQuotas maxDepth="32" 
                    maxStringContentLength="6553600" 
                    maxArrayLength="16384"
                    maxBytesPerRead="4096" 
                    maxNameTableCharCount="16384" />
    </binding>
  </wsHttpBinding>
</bindings> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T20:25:36.153

您还应该删除配额限制。以下是在代码中使用 Tcp 绑定的方法。我添加了一些代码来显示超时问题的消除，因为通常发送非常大的参数会导致超时问题。所以明智地使用代码......当然，您也可以在配置文件中设置这些参数。

```
 NetTcpBinding binding = new NetTcpBinding(SecurityMode.None, true);

        // Allow big arguments on messages. Allow ~500 MB message.
        binding.MaxReceivedMessageSize = 500 * 1024 * 1024;

        // Allow unlimited time to send/receive a message. 
        // It also prevents closing idle sessions. 
        // From MSDN: To prevent the service from aborting idle sessions prematurely increase the Receive timeout on the service endpoint's binding.’
        binding.ReceiveTimeout = TimeSpan.MaxValue;
        binding.SendTimeout = TimeSpan.MaxValue;

        XmlDictionaryReaderQuotas quotas = new XmlDictionaryReaderQuotas();

        // Remove quotas limitations
        quotas.MaxArrayLength = int.MaxValue;
        quotas.MaxBytesPerRead = int.MaxValue;
        quotas.MaxDepth = int.MaxValue;
        quotas.MaxNameTableCharCount = int.MaxValue;
        quotas.MaxStringContentLength = int.MaxValue;
        binding.ReaderQuotas = quotas; 
```

# path - 如何避免在 csh 中重复路径变量

> ID：135754
> 
> 赞同：9
> 
> 时间：2008-09-25T20:16:18.063
> 
> 标签：path, environment-variables, csh, path-variables

通常在您的 cshrc 文件中包含这样的内容来设置路径：

```
set path = ( . $otherpath $path ) 
```

但是，当您多次获取 cshrc 文件时，路径会重复，您如何防止重复？

编辑：这是一种不干净的做法：

```
set localpaths = ( . $otherpaths )
echo ${path} | egrep -i "$localpaths" >& /dev/null
if ($status != 0) then
    set path = ( . $otherpaths $path )
endif 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-02-19T05:02:00.190

我很惊讶没有人使用该`tr ":" "\n" | grep -x`技术来搜索 $PATH 中是否已存在给定文件夹。有什么理由不这样做？

在 1 行中：

```
if ! $(echo "$PATH" | tr ":" "\n" | grep -qx "$dir") ; then PATH=$PATH:$dir ; fi 
```

这是我让自己一次将多个文件夹添加到 $PATH 的函数（使用“aaa:bbb:ccc”表示法作为参数），在添加之前检查每个文件夹是否重复：

```
append_path()
{
    local SAVED_IFS="$IFS"
    local dir
    IFS=:
    for dir in $1 ; do
        if ! $( echo "$PATH" | tr ":" "\n" | grep -qx "$dir" ) ; then
            PATH=$PATH:$dir
        fi
    done
    IFS="$SAVED_IFS"
} 
```

可以在这样的脚本中调用它：

```
append_path "/test:$HOME/bin:/example/my dir/space is not an issue" 
```

它具有以下优点：

*   没有 bashisms 或任何特定于 shell 的语法。它完美运行`!#/bin/sh`（我用破折号测试过）
*   可以一次添加多个文件夹
*   不排序，保留文件夹顺序
*   完美处理文件夹名称中的空格
*   无论 $folder 是在开始、结束、中间还是 $PATH 中的唯一文件夹，单个测试都有效（因此避免测试 x:*、*:x、*:x:*、x，因为这里的许多解决方案都隐含做）
*   如果 $PATH 以“:”开头或结尾，或者其中包含“::”（表示当前文件夹），则有效（并保留）
*   没有`awk`或`sed`需要。
*   EPA 友好 ;) 原始 IFS 值被保留，所有其他变量都是函数范围的本地变量。

希望有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T21:07:57.783

好的，**不在**csh 中，但这是我在 bash 中将 $HOME/bin 附加到我的路径的方式......

```
case $PATH in
    *:$HOME/bin | *:$HOME/bin:* ) ;;
    *) export PATH=$PATH:$HOME/bin
esac 
```

调味...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T20:28:48.687

您可以使用以下 Perl 脚本来修剪重复的路径。

* * *

```
#!/usr/bin/perl
#
# ^^ ensure this is pointing to the correct location.
#
# Title:    SLimPath
# Author:   David "Shoe Lace" Pyke <eselle@users.sourceforge.net >
#   :   Tim Nelson 
# Purpose: To create a slim version of my envirnoment path so as to eliminate
#       duplicate entries and ensure that the "." path was last.
# Date Created: April 1st 1999
# Revision History:
#   01/04/99: initial tests.. didn't wok verywell at all
#       : retreived path throught '$ENV' call
#   07/04/99: After an email from Tim Nelson <wayland@ne.com.au> got it to
#         work.
#       : used 'push' to add to array
#       : used 'join' to create a delimited string from a list/array.
#   16/02/00: fixed cmd-line options to look/work better
#   25/02/00: made verbosity level-oriented
#
#

use Getopt::Std;

sub printlevel;

$initial_str = "";
$debug_mode = "";
$delim_chr = ":";
$opt_v = 1;

getopts("v:hd:l:e:s:");

OPTS: {
    $opt_h && do {
print "\n$0 [-v level] [-d level] [-l delim] ( -e varname | -s strname | -h )";
print "\nWhere:";
print "\n   -h  This help";
print "\n   -d  Debug level";
print "\n   -l  Delimiter (between path vars)";
print "\n   -e  Specify environment variable (NB: don't include \$ sign)";
print "\n   -s  String (ie. $0 -s \$PATH:/looser/bin/)";
print "\n   -v  Verbosity (0 = quiet, 1 = normal, 2 = verbose)";
print "\n";
        exit;
    };
    $opt_d && do {
        printlevel 1, "You selected debug level $opt_d\n";
        $debug_mode = $opt_d;
    };
    $opt_l && do {
        printlevel 1, "You are going to delimit the string with \"$opt_l\"\n";
        $delim_chr = $opt_l;
    };
    $opt_e && do {
        if($opt_s) { die "Cannot specify BOTH env var and string\n"; }
        printlevel 1, "Using Environment variable \"$opt_e\"\n";
        $initial_str = $ENV{$opt_e};
    };
    $opt_s && do {
        printlevel 1, "Using String \"$opt_s\"\n";
        $initial_str = $opt_s;
    };
}

if( ($#ARGV != 1) and !$opt_e and !$opt_s){
    die "Nothing to work with -- try $0 -h\n";
}

$what = shift @ARGV;
# Split path using the delimiter
@dirs = split(/$delim_chr/, $initial_str);

$dest;
@newpath = ();
LOOP: foreach (@dirs){
    # Ensure the directory exists and is a directory
    if(! -e ) { printlevel 1, "$_ does not exist\n"; next; }
    # If the directory is ., set $dot and go around again
    if($_ eq '.') { $dot = 1; next; }

#   if ($_ ne `realpath $_`){
#           printlevel 2, "$_ becomes ".`realpath $_`."\n";
#   }
    undef $dest;
    #$_=Stdlib::realpath($_,$dest);
    # Check for duplicates and dot path
    foreach $adir (@newpath) { if($_ eq $adir) { 
        printlevel 2, "Duplicate: $_\n";
        next LOOP; 
    }}

    push @newpath, $_;
}

# Join creates a string from a list/array delimited by the first expression
print join($delim_chr, @newpath) . ($dot ? $delim_chr.".\n" : "\n");

printlevel 1, "Thank you for using $0\n";
exit;

sub printlevel {
    my($level, $string) = @_;

    if($opt_v >= $level) {
        print STDERR $string;
    }
} 
```

* * *

我希望那是有用的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T06:03:54.607

十年来的大部分时间里，我一直在使用以下 (Bourne/Korn/POSIX/Bash) 脚本：

```
:   "@(#)$Id: clnpath.sh,v 1.6 1999/06/08 23:34:07 jleffler Exp $"
#
#   Print minimal version of $PATH, possibly removing some items

case $# in
0)  chop=""; path=${PATH:?};;
1)  chop=""; path=$1;;
2)  chop=$2; path=$1;;
*)  echo "Usage: `basename $0 .sh` [$PATH [remove:list]]" >&2
    exit 1;;
esac

# Beware of the quotes in the assignment to chop!
echo "$path" |
${AWK:-awk} -F: '#
BEGIN   {   # Sort out which path components to omit
            chop="'"$chop"'";
            if (chop != "") nr = split(chop, remove); else nr = 0;
            for (i = 1; i <= nr; i++)
                omit[remove[i]] = 1;
        }
{
    for (i = 1; i <= NF; i++)
    {
        x=$i;
        if (x == "") x = ".";
        if (omit[x] == 0 && path[x]++ == 0)
        {
            output = output pad x;
            pad = ":";
        }
    }
    print output;
}' 
```

在 Korn shell 中，我使用：

```
export PATH=$(clnpath /new/bin:/other/bin:$PATH /old/bin:/extra/bin) 
```

这让我在前面留下了 PATH 包含新的和其他 bin 目录，加上主路径值中每个目录名称的一份副本，除了旧的和额外的 bin 目录已删除 bin。

您必须将其改编为 C shell（抱歉 - 但我非常相信[C Shell Programming Considered Harmful](http://www.faqs.org/faqs/unix-faq/shell/csh-whynot/)中阐明的真理）。首先，您不必摆弄冒号分隔符，因此生活实际上更轻松。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T13:46:03.590

好吧，如果您不在乎路径的顺序，您可以执行以下操作：

```
set path=(`echo $path | tr ' ' '\n' | sort | uniq | tr '\n' ' '`) 
```

这将对您的路径进行排序并删除任何相同的额外路径。如果你有 。在您的路径中，您可能希望使用 grep -v 将其删除并在最后重新添加。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-30T20:38:55.787

这是一个没有排序的长单行：
set path = ( `echo $path | tr ' ' '\n' | perl -e 'while (<>) { print $_ unless $s{$_}++; }' | tr '\n' ' '`)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-19T05:26:37.410

胡椒博士，

我通常更喜欢坚持我所居住的 shell 的脚本功能。使其更便携。所以，我喜欢您使用 csh 脚本编写的解决方案。我只是将它扩展为在 localdirs 中的每个目录上工作，以使其适合我自己。

```
foreach 目录 ( $localdirs )
    回声 ${路径} | egrep -i "$dir" >& /dev/null
    如果 ($status != 0) 那么
        设置路径 = ( $dir $path )
    万一
结尾

```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-01-28T09:36:53.537

使用 sed(1) 删除重复项。

```
$ PATH=$(echo $PATH | sed -e 's/$/:/;s/^/:/;s/:/::/g;:a;s#\(:[^:]\{1,\}:\)\(.*\)\1#\1\2#g;ta;s/::*/:/g;s/^://;s/:$//;') 
```

这将在第一个实例之后删除重复项，这可能是也可能不是您想要的，例如：

```
$ NEWPATH=/bin:/usr/bin:/bin:/usr/local/bin:/usr/local/bin:/bin
$ echo $NEWPATH | sed -e 's/$/:/; s/^/:/; s/:/::/g; :a; s#\(:[^:]\{1,\}:\)\(.*\)\1#\1\2#g; t a; s/::*/:/g; s/^://; s/:$//;'
/bin:/usr/bin:/usr/local/bin
$ 
```

享受！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-04T22:02:17.490

这是我使用的 - 也许其他人会发现它有用：

```
#!/bin/csh
#  ABSTRACT
#    /bin/csh function-like aliases for manipulating environment
#    variables containing paths.
#
#  BUGS
#    - These *MUST* be single line aliases to avoid parsing problems apparently related
#      to if-then-else
#    - Aliases currently perform tests in inefficient in order to avoid parsing problems
#    - Extremely fragile - use bash instead!!
#
#  AUTHOR
#    J. P. Abelanet - 11/11/10

#  Function-like alias to add a path to the front of an environment variable
#    containing colon (':') delimited paths, without path duplication
#
#  Usage: prepend_path ENVVARIABLE /path/to/prepend
alias prepend_path \
  'set arg2="\!:2";  if ($?\!:1 == 0) setenv \!:1 "$arg2";  if ($?\!:1 && $\!:1 !~ {,*:}"$arg2"{:*,}) setenv \!:1 "$arg2":"$\!:1";'

#  Function-like alias to add a path to the back of any environment variable 
#    containing colon (':') delimited paths, without path duplication
#
#  Usage: append_path ENVVARIABLE /path/to/append
alias append_path \
  'set arg2="\!:2";  if ($?\!:1 == 0) setenv \!:1 "$arg2";  if ($?\!:1 && $\!:1 !~ {,*:}"$arg2"{:*,}) setenv \!:1 "$\!:1":"$arg2";' 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-31T10:53:01.567

在 csh 中设置 path（小写，csh 变量）而不是 PATH（环境变量）时，可以使用 set -f 和 set -l，这将只保留每个列表元素的一次出现（更喜欢保留第一个或最后，分别）。

[https://nature.berkeley.edu/~casterln/tcsh/Builtin_commands.html#set](https://nature.berkeley.edu/~casterln/tcsh/Builtin_commands.html#set)

所以像这样

`cat foo.csh # or .tcshrc or whatever: set -f path = (/bin /usr/bin . ) # initial value set -f path = ($path /mycode /hercode /usr/bin ) # add things, both new and duplicates`

每次你都不会继续扩展 PATH 重复项`source`：

`% source foo.csh % echo $PATH % /bin:/usr/bin:.:/mycode:/hercode % source foo.csh % echo $PATH % /bin:/usr/bin:.:/mycode:/hercode`

set -f there 确保只保留每个 PATH 元素的第一次出现。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T20:20:54.790

我总是在 .cshrc 中从头开始设置我的路径。那就是我从一条基本路径开始，例如：

```
set path = (. ~/bin /bin /usr/bin /usr/ucb /usr/bin/X11) 
```

（取决于系统）。

然后做：

```
set path = ($otherPath $path) 
```

添加更多内容

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-18T13:04:23.553

我有与原始问题相同的需求。基于您之前的答案，我在 Korn/POSIX/Bash 中使用过：

```
export PATH=$(perl -e 'print join ":", grep {!$h{$_}++} split ":", "'$otherpath:$PATH\") 
```

我很难直接在 csh 中翻译它（csh 转义规则太疯狂了）。我使用过（如 dr_pepper 所建议的）：

```
set path = ( `echo $otherpath $path | tr ' ' '\n' | perl -ne 'print $_ unless $h{$_}++' | tr '\n' ' '`) 
```

您是否有更多简化它的想法（减少管道数量）？

# perl - 如何找到已安装的 Perl 模块的版本？

> ID：135755
> 
> 赞同：62
> 
> 时间：2008-09-25T20:16:24.507
> 
> 标签：perl, module, version, cpan

如何找到已安装的 Perl 模块的版本？

这是在底部的答案，但我认为住在这里足够重要。有了这些建议，我在我的`.bashrc`

```
function perlmodver {
    perl -M$1 -e 'print "Version " . $ARGV[0]->VERSION . " of " . $ARGV[0] . \
    " is installed.\n"' $1
} 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-09-25T20:17:23.910

大多数模块（尤其是来自 The CPAN 的模块）都有一个 $VERSION 变量：

```
perl -MSome::Module -le 'print $Some::Module::VERSION' 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-09-25T21:19:10.283

你为什么要获取模块的版本？您是否需要在程序中使用它，您是否只需要将数字传递给另一个操作，或者您只是想找出您拥有的东西？

我将它内置在`cpan`（perl 附带的）`-D`开关中，因此您可以在 CPAN 上查看已安装的版本和当前版本：

```
$ cpan -D 文本::CSV_XS

文本::CSV_XS
-------------------------------------------------- ----------------------
        Text::CSV 的快速 8 位干净版本
        H/HM/HMBRAND/文本-CSV_XS-0.54.tgz
        /usr/local/lib/perl5/site_perl/5.8.8/darwin-2level/Text/CSV_XS.pm
        安装：0.32
        CPAN：0.54 不是最新的
        H.Merijn 品牌 (HMBRAND)
        hmbrand@xs4all.nl

```

如果您想查看所有过时的模块，请使用`-O`（大写 O）开关：

```
$ cpan -O
模块名称 本地 CPAN
-------------------------------------------------- ----------------------
阿帕奇::数据库 0.1300 0.1400
阿帕奇::SOAP 0.0000 0.7100
阿帕奇::会话 1.8300 1.8700
Apache::SizeLimit 0.0300 0.9100
Apache::XMLRPC::Lite 0.0000 0.7100
... 等等

```

如果您想查看已安装的所有模块的信息，请尝试使用`-a`开关创建自动捆绑。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-09-25T21:21:17.860

VERSION 是所有 Perl 类的[通用](http://perldoc.perl.org/UNIVERSAL.html)方法。您可以使用它来获取模块版本（如果已设置它通常具有的）。

这是一个单行，您只需添加一次模块名称：

```
perl -le 'eval "require $ARGV[0]" and print $ARGV[0]->VERSION' Some::Module 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-09-25T20:48:39.577

有一个少打字的技巧，只要你的模块没有像 Unix 时间戳这样的疯狂的东西作为版本号，它就可以工作。

```
perl -MFoo::Bar\ 9999 
```

这是有效的，因为它转化为

```
use Foo::Bar 9999; 
```

即至少版本 9999 或更新的 Foo::Bar 版本。你得到的是

```
Foo::Bar version 9999 required--this is only version 1.1.
BEGIN failed--compilation aborted. 
```

（我从马特·特劳特那里学到的绝招。）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-25T20:19:31.410

如果幸运的话，该模块将有一个名为**$VERSION**的包变量：

```
$ perl -MCPAN -e 'print "$CPAN::VERSION\n"'
1.9205 
```

这是在 CPAN 上分发模块所必需的，但内部开发的模块可能遵循不同的约定或根本不遵循。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-25T21:41:25.847

感谢您的回答！我在我的 .bashrc 中创建了一个函数来轻松找到 Perl 模块的版本：

```
function perlmodver {
    perl -M$1 -e 'print $ARGV[0]->VERSION . "\n"' $1
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-11-20T16:52:49.163

对我来说最容易记住和最强大的版本：

```
perl -e 'use Search::Elasticsearch; print $Search::Elasticsearch::VERSION;' 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T21:33:33.057

查看 CPAN 上的[pmtools](http://search.cpan.org/dist/pmtools/)脚本。如果您使用的是 Debian(-based) 发行版，还有一个方便的[*pmtools*包](https://packages.debian.org/unstable/pmtools)。这包括一个脚本“pmvers”，它告诉您模块的版本。这很方便。

它所做的事情类似于人们发布的各种单行代码，但它在错误处理方面更聪明一些，并且可以一次为您提供多个模块的版本。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-25T20:33:27.617

我写了一个小脚本来报告：[perlver](http://www.cjmweb.net/utilities/#perlver)。

> 这是一个简单的小工具，可以告诉您已安装的模块版本以及 .pm 文件的位置。它还确保模块可以成功加载。它会自动将“-”、“/”或“\”转换为“::”，因此您可以使用路径名或分发名称来代替规范的模块名称。

它假定模块定义了一个 $VERSION。如果模块没有定义 $VERSION，它仍然会告诉你`.pm`文件在哪里，所以你可以手动检查它。您还可以一次检查多个模块：

```
$ perlver CPAN DBD-Pg Getopt::Long
CPAN 1.7602 is
 /usr/lib/perl5/5.8.8/CPAN.pm
DBD::Pg 1.49 is
 /usr/lib/perl5/vendor_perl/5.8.8/i686-linux/DBD/Pg.pm
Getopt::Long 2.36 is
 /usr/lib/perl5/vendor_perl/5.8.8/Getopt/Long.pm 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T20:43:51.350

此外，对于使用 Exporter.pm 的模块，您可以通过以下技巧获取此信息：

```
perl -MSome::Module=99999 -ex
Some::Module version 99999 required--this is only version 1.9205 at ... 
```

对于不使用 Exporter.pm 的模块，稍长的技巧会报告相同的信息：

```
perl -e'use Some::Module 99999'
Some::Module version 99999 required--this is only version 1.9205 at ... 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-02-24T02:37:45.913

我们在 Solaris 10 中有系统 perl (/usr/bin/perl)，上面的解决方案是没用的。其中一些报告“未安装module.pm”，其中一些没有输出。

这是有用的代码，它可以列出所有模块及其版本。

```
#!/usr/bin/perl

use strict;
use ExtUtils::Installed;

my @modules;
my $installed = ExtUtils::Installed->new();

if (scalar(@ARGV) > 0) {

    @modules = @ARGV;

} else {

    @modules = $installed->modules();

}

print "Module\tVersion\n";

foreach (@modules) {

    print $_ . "\t" . $installed->version($_) . "\n";

} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-07T13:40:47.370

你也可以看看[App::module::version](https://metacpan.org/pod/module-version)

```
$ module-version

The version of App::module::version in /home/yourself/perl5/lib/perl5 is 1.004 
```

# vb.net - 为什么我不能继承 IO.Directory？

> ID：135759
> 
> 赞同：2
> 
> 时间：2008-09-25T20:17:21.883
> 
> 标签：vb.net, inheritance, system.io.directory

为什么我不能`class`在`VB.NET`其中创建一个`inherits` `System.IO.Directory`？根据 Lutz Roeder 的说法，它*没有*被声明为`NotInheritable`!

我想创建一个`utility class`为`Directory class`. 例如，我想添加一个`Directory.Move`函数。

请告知，我会寄给你一个六包。好吧，没关系，我不会给你发任何东西，但如果你今晚来酒吧，我会勾搭你，然后在台球中击败你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T20:19:20.100

来自 .NET 的元数据

```
namespace System.IO
{
    // Summary:
    //     Exposes static methods for creating, moving, and enumerating through directories
    //     and subdirectories. This class cannot be inherited.
    [ComVisible(true)]
    public static class Directory 
```

您不能从静态类继承。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T20:18:02.253

您使用的是~~C# 3.0~~ VB.NET 2008 - 那么您可以添加[扩展方法](http://msdn.microsoft.com/en-us/library/bb384936.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:19:08.837

如果您使用 DirectoryInfo 类，您将有权访问 MoveTo 函数。

编辑：我会更正自己...静态 Directory 类已经有一个 Move 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T22:29:48.287

我猜想 Reflector 没有为 VB 正确获取密封属性（或者可能只是没有正确显示它）。如果你看一下 IL，它是密封的：

class public abstract auto ansi**密封**beforefieldinit 目录

# silverlight - Silverlight 2 和 MVP 模式

> ID：135775
> 
> 赞同：0
> 
> 时间：2008-09-25T20:19:36.527
> 
> 标签：silverlight, mvp

关于如何让 MVP 与 Silverlight 一起工作的任何想法？我如何解决没有引发加载事件的事实？

这是我的观点：

```
 public partial class Person: IPersonView
    {
        public event RoutedEventHandler Loaded;

        public Person()
        {
            new PersonPresenter(this);

            InitializeComponent();
        }

        public Person Person
        {
            set { Person.ItemsSource = value; }
        }
    } 
```

还有我的主持人：

```
 public class PersonPresenter
    {
        private readonly IPersonView _view;
        private readonly ServiceContractClient _client;

        public PersonPresenter(IPersonView view)
        {
            _client = new ServiceContractClient();

            _view = view;
            WireUpEvents();
        }

        private void WireUpEvents()
        {
            _view.Loaded += Load;
        }

        private void Load(object sender, EventArgs e)
        {
            _client.GetPersonCompleted += Client_GetPerson;
            _client.GetPersonAsync();
        }

        private void Client_GetPerson(object sender, GetPersonCompletedEventArgs e)
        {
            _view.Person= e.Result;
        }
    } 
```

什么都没发生，因为 Loaded 事件似乎没有被调用，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T13:27:42.347

[Tim Ross](http://timross.wordpress.com/2008/03/16/implementing-the-mvp-pattern-in-silverlight/)很好地介绍了 Silverlight MVP 实现，并附有源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T20:46:55.913

我相信当控件被初始化、加载、渲染并准备好使用时，加载的事件会被调用。这意味着只要您不将它放在可见容器中（以便渲染），就不会引发加载的事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T00:01:23.777

## 您可以考虑使用[MVC#](http://www.mvcsharp.org) - 一个支持 Silverlight 2.0 的 Model View Presenter 框架。

奥列格·茹科夫

# language-agnostic - 一个 StringToken 解析器，它提供谷歌搜索风格“你的意思是：”

> ID：135777
> 
> 赞同：5
> 
> 时间：2008-09-25T20:19:43.437
> 
> 标签：language-agnostic, parsing, nlp

## 寻求一种方法：

## 在字符串中使用空格分隔的标记；返回一个建议的词

**即：**
谷歌搜索可以采用*“fonetic wrd nterpreterr”*，
并在结果页面顶部显示*“您的意思是：语音单词解释器”*

*任何 C* 语言或 Java 的解决方案都是首选。*

**是否有任何执行此类功能的现有开放库？**

**或者有没有办法利用 Google API 来请求建议的单词？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T21:57:12.977

在他的文章[How to Write a Spelling Corrector](http://norvig.com/spell-correct.html)中，Peter Norvig 讨论了如何实现类似 Google 的拼写检查器。这篇文章包含一个 20 行的 Python 实现，以及指向 C、C++、C# 和 Java 的几个重新实现的链接。这是一段摘录：

> 像谷歌这样的工业级拼写校正器的全部细节比启发性更令人困惑，但我认为在回家的飞机上，用不到一页代码，我可以编写一个达到 80% 或 90% 的玩具拼写校正器处理速度至少为每秒 10 个字的准确度。

使用 Norvig 的代码和[此文本](http://www.phon.ucl.ac.uk/home/johnm/ptlc2005/pdf/ptlcp56.pdf)作为训练集，我得到以下结果：

```
>>> import spellch
>>> [spellch.correct(w) for w in 'fonetic wrd nterpreterr'.split()]
['phonetic', 'word', 'interpreters'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T20:23:47.547

您可以在此处使用 yahoo 网络服务：http: [//developer.yahoo.com/search/web/V1/spellingSuggestion.html](http://developer.yahoo.com/search/web/V1/spellingSuggestion.html)

然而它只是一个网络服务......（即没有其他语言的 API 等......）但它输出 JSON 或 XML，所以......很容易适应任何语言......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T12:12:26.390

您还可以使用 Google API 进行拼写检查。[这里](http://www.asp101.com/articles/jeremy/googlespell/default.asp)有一个 ASP 实现（不过，我不相信这一点）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T21:01:44.653

首先：

*   [爪哇](http://jazzy.sourceforge.net/ "Java 库")
*   [C++](http://www.codeproject.com/KB/recipes/spellchecker_mg.aspx "C++ 库")
*   [C＃](http://www.loresoft.com/projects/netspell/default.aspx ".Net 库")

使用您选择的一种。我怀疑它针对一个字数限制正好为一个的拼写检查引擎运行查询，如果整个查询有效，它就什么也不做，否则它会用该词的最佳匹配替换每个词。换句话说，下面的算法（一个空的返回字符串意味着查询没有问题）：

```
startup()
{
   set the spelling engines word suggestion limit to 1
}

option 1()
{
   int currentPosition = engine.NextWord(start the search at word 0, querystring);

   if(currentPosition == -1)
      return empty string; // Query is a-ok.

   while(currentPosition != -1)
   {
       queryString = engine.ReplaceWord(engine.CurrentWord, queryString, the suggestion with index 0);
       currentPosition = engine.NextWord(currentPosition, querystring);
   }

   return queryString;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T18:17:08.653

由于还没有人提到它，我将再提供一个短语来搜索：“编辑距离”（例如，[链接文本](http://en.wikipedia.org/wiki/Levenshtein_distance)）。这可用于查找最接近的匹配项，假设是字母被转置、丢失或添加的拼写错误。

但通常这也伴随着某种相关性信息；或者通过简单的流行度（假设最常用的足够接近的匹配最有可能是正确的单词），或者通过上下文的可能性（在正确单词之后的单词，或者在一个之前的单词）。这进入了信息检索；一种开始的方法是查看二元组和三元组（一起看到的单词序列）。谷歌为这些提供了非常广泛的免费数据集。

对于简单的初始解决方案，尽管字典与基于 Levenshtein 的匹配器的效果非常好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-05T09:01:56.310

您可以插入 Lucene，它具有实现 Levenshtein 距离方法的字典工具。

这是来自 Wiki 的示例，其中 2 是距离。

```
String[] l=spellChecker.suggestSimilar("sevanty", 2);
//l[0] = "seventy" 
```

*   [http://wiki.apache.org/lucene-java/SpellChecker](http://wiki.apache.org/lucene-java/SpellChecker)
*   较旧的链接[http://today.java.net/pub/a/today/2005/08/09/didyoumean.html](http://today.java.net/pub/a/today/2005/08/09/didyoumean.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T21:17:51.243

如果您将字典存储为 trie，则有一种相当简单的方法可以找到最佳匹配条目，其中可以插入、删除或替换字符。

```
void match(trie t, char* w, string s, int budget){
  if (budget < 0) return;
  if (*w=='\0') print s;
  foreach (char c, subtrie t1 in t){
    /* try matching or replacing c */
    match(t1, w+1, s+c, (*w==c ? budget : budget-1));
    /* try deleting c */
    match(t1, w, s, budget-1);
  }
  /* try inserting *w */
  match(t, w+1, s + *w, budget-1);
} 
```

这个想法是，首先你用零预算调用它，看看它是否打印出任何东西。然后尝试预算 1，依此类推，直到打印出一些匹配项。预算越大，花费的时间就越长。您可能只想达到 2 的预算。

补充：扩展它来处理常见的前缀和后缀并不难。例如，像“un”、“anti”和“dis”这样的英文前缀可以在字典中，然后可以链接回字典的顶部。对于像 "ism"、"'s" 和 "ed" 这样的后缀，可以有一个单独的 trie，只包含后缀，并且大多数单词都可以链接到该后缀 trie。然后它可以处理诸如“反国有化”之类的奇怪词。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T11:36:57.647

[Google SOAP 搜索 API](http://code.google.com/intl/it/apis/soapsearch/reference.html#1_3)就是这样做的。

# c# - 异常处理中函数参数的通用日志记录

> ID：135782
> 
> 赞同：31
> 
> 时间：2008-09-25T20:20:45.540
> 
> 标签：c#, .net

我的很多 C# 代码都遵循这种模式：

```
void foo(string param1, string param2, string param3)
{
    try
    {
         // do something...
    }
    catch(Exception ex)
    {
        LogError(String.Format("Error in foo(param1={0}, param2={1}, param3={2}), exception={3}", param1, param2, param3, ex.Message));
    }
} 
```

.NET 中有没有办法获取函数参数的键/值列表，以便我可以调用另一个函数来构造我的错误日志记录字符串？或者您有更通用/更好的方法吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-25T20:56:47.187

您可以使用反射和必须以正确顺序将参数传递给 LogError 的约定：

```
private static void MyMethod(string s, int x, int y)
{
    try
    {
        throw new NotImplementedException();
    }
    catch (Exception ex)
    {
        LogError(MethodBase.GetCurrentMethod(), ex, s, x, y);
    }
}

private static void LogError(MethodBase method, Exception ex, params object[] values)
{
    ParameterInfo[] parms = method.GetParameters();
    object[] namevalues = new object[2 * parms.Length];

    string msg = "Error in " + method.Name + "(";
    for (int i = 0, j = 0; i < parms.Length; i++, j += 2)
    {
        msg += "{" + j + "}={" + (j + 1) + "}, ";
        namevalues[j] = parms[i].Name;
        if (i < values.Length) namevalues[j + 1] = values[i];
    }
    msg += "exception=" + ex.Message + ")";
    Console.WriteLine(string.Format(msg, namevalues));
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T21:11:08.663

您可以在 PostSharp 中使用面向方面的编程（查看[http://www.postsharp.org 和 http://www.codeproject.com/KB/cs/ps-custom-attributes-1.aspx](http://www.postsharp.org)[上](http://www.codeproject.com/KB/cs/ps-custom-attributes-1.aspx)的教程）。基本上你可以做这样的事情：

```
public class LogExceptionAttribute : OnExceptionAspect
{
 public override void OnException(MethodExecutionEventArgs eventArgs)
 {
  log.error("Exception occurred in method {0}", eventArgs); 
 }
}

[LoggingOnExceptionAspect]
public foo(int number, string word, Person customer)
{
   // ... something here throws an exception
} 
```

也许不是你想要的，但我相信它可以适应你的需要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T20:28:10.827

不，没有办法做到这一点。

通常的做法是不捕获异常，除非您可以处理它们。

即，您通常只会捕获异常并将它们记录在顶级异常处理程序中。然后，您将获得堆栈跟踪，但当然不会获得堆栈中所有方法调用的所有参数的详细信息。

显然，在调试时，您需要尽可能多的细节。实现这一目标的其他方法是：

*   自由地使用 Debug.Assert 语句来测试您所做的假设。

*   使用可以选择性激活的日志记录来检测您的应用程序。我使用 Log4Net，但也有其他选择，包括使用 System.Diagnostics.Trace 类。

在任何情况下，如果您确实捕获异常只是为了记录它们（我会在 n 层应用程序的层边界执行此操作，以便将异常记录在服务器上），那么您应该始终重新抛出它们：

```
try
{
    ...
}
catch(Exception ex)
{
    log(ex);
    throw;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T20:26:07.057

完成此操作后，我刚刚为日志记录创建了一个通用字典。

我有这个 LogArgs 类。并登录我在遇到异常时调用的基类。

```
public class LogArgs
{

    public string MethodName { get; set; }
    public string ClassName { get; set; }
    public Dictionary<string, object> Paramters { get; set; }

    public LogArgs()
    {
        this.Paramters = new Dictionary<string, object>();
    }

} 
```

然后在我做的每一个方法的开始

```
LogArgs args = new LogArgs { ClassName = "ClassName", MethodName = "MethodName" };
args.Paramters.Add("Param1", param1);
args.Paramters.Add("Param2", param2);
args.Paramters.Add("Param3", param3);

base.Logger.MethodStartLog(args); 
```

当我遇到错误时，我会以这种方式记录它。

```
base.Logger.LogError(args, ex); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T20:29:35.113

您可以使用类似的方式构造消息，但在 LogError 方法中添加 params 关键字来处理参数。例如：

```
 public void LogError(string message, params object[] parameters)
    {
        if (parameters.Length > 0)
            LogError(string.Format(message, parameters));
        else
            LogError(message);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-17T16:09:57.743

这是一篇过时的帖子，但以防万一有人像我一样遇到这个问题 - 我使用[PostSharp](https://www.postsharp.net/)解决了这个问题。

但它实际上并不是免费的。Express 许可证（可通过 VS 中的 NuGet 下载）允许您使用`[Log]`属性装饰您的方法，然后选择您已经配置的日志记录机制，例如[log4net](https://logging.apache.org/log4net/) [nLog](http://nlog-project.org/)等。现在您将开始在日志中看到调试级别条目，提供参数详细信息。

使用 express 许可证，我最多只能在我的项目中装饰 50 种方法。如果它符合您的需求，您就可以开始了！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-09T11:41:59.450

聚会迟到了，但我在一年前做了一些类似的事情： [Github Repo](https://github.com/Alchemy86/ModernLogging/tree/master/ModernLogging)

这种设置的想法很像你的追求，但由于能够在全球范围内连接它，那里的代码比我想要的要多，但它可以工作，一旦插入，就可以满足你的需要。

如果您快速浏览一下 ProxyLogger.cs，将其视为一个包装器，它将封装给定的任何方法并在处理此处设置的错误日志记录时执行它。然后可以使用依赖注入来设置您希望记录的任何内容，例如：

```
public void ConfigureServices(HostBuilderContext hostBuilder, IServiceCollection services)
    {
        services.AddOptions();
        services.AddSingleton<IHostedService, HostedService>();

        services.AddSingleton<IMyClass, MyClass>();

        // Logging added for both the hosted service and the example class
        services.Decorate<IMyClass, ProxyLogger<IMyClass>>();
        services.Decorate<IHostedService, ProxyLogger<IHostedService>>();
    } 
```

您可以正常注册服务，但最重要的是，您可以使用代理记录器来装饰它们以处理执行并使用完整参数记录之前、之后、失败等的详细信息。我痴迷于这个有一段时间，这是我能得到的最好的，但它真的很好用。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-03-20T12:00:15.777

有少量参数或大量参数的场景...

1.  很少有参数，事不宜迟，最好将它们写为日志记录/异常消息的一部分。

2.  在大参数中，多层应用程序将使用实体（如客户、客户订单...）在层之间传输数据。这些实体应该实现 Object 类的重写 ToString() 方法，因此，

Logmessage(" method started " + paramObj.ToString()) 会给出对象中的数据列表。有什么意见吗？:)

谢谢

# tdd - TDD。什么时候可以继续？

> ID：135789
> 
> 赞同：13
> 
> 时间：2008-09-25T20:23:12.913
> 
> 标签：tdd

在进行[TDD](http://en.wikipedia.org/wiki/Test_driven_development)时，如何判断“对于此类/功能的测试已经足够了”？

即你什么时候可以告诉你完成了所有边缘情况的测试？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-25T20:28:24.007

使用测试驱动开发，您将在编写测试代码之前编写测试。编写完代码并且测试通过后，就该编写另一个测试了。如果你正确地遵循了 TDD，那么一旦你的代码完成了所有需要的测试，你就已经编写了足够多的测试。

至于边缘情况，我们举一个例子，比如验证方法中的参数。在将参数添加到代码之前，您需要创建测试来验证代码将正确处理每种情况。然后您可以添加参数和关联的逻辑，并确保测试通过。如果您想出更多边缘情况，则可以添加更多测试。

通过一步一步来，您在编写完代码后就不必担心边缘情况，因为您已经为所有情况编写了测试。当然，人为错误总是存在的，你可能会遗漏一些东西……当这种情况发生时，是时候添加另一个测试然后修复代码了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-16T23:18:55.817

Kent Beck 的建议是编写测试，直到恐惧变成无聊。也就是说，直到你不再害怕任何东西会破裂，假设你从适当程度的恐惧开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T20:45:30.910

在某种程度上，这是一种直觉

> *“我有信心测试能解决我现在能想到的所有问题吗？”*

在另一个层面上，您已经有一组必须满足的用户或系统要求，因此您可以停在那里。

虽然我确实使用代码覆盖率来告诉我是否没有遵循我的 TDD 流程并找到可以删除的代码，但我不会将代码覆盖率视为知道何时停止的有用方法。您的代码覆盖率可能是 100%，但如果您忘记包含需求，那么您并没有真正完成，是吗。

也许对 TDD 的误解是您必须预先了解**所有内容**才能进行测试。这是错误的，因为 TDD 过程产生的测试就像一个面包屑轨迹。你知道过去测试了什么，并且可以在一定程度上指导你，但它不会告诉你下一步该做什么。

我认为 TDD 可以被认为是一个进化过程。也就是说，你从你的初始设计开始，它是一组测试。随着您的代码在生产中受到重创，您会添加更多测试以及使这些测试通过的代码。每次你在这里添加一个测试，在那里添加一个测试，你也是在做 TDD，而且成本并不高。当您编写第一组测试时，您不知道存在这些案例，但是您现在获得了知识，并且可以通过按一下按钮来检查这些问题。这就是 TDD 的巨大力量，也是我如此提倡它的原因之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T20:25:55.497

好吧，当您想不出更多无法按预期工作的失败案例时。

TDD 的一部分是保留您想要实现的事物的列表，以及当前实现的问题......所以当这个列表用完时，你基本上完成了......

请记住，当您发现实施的错误或新问题时，您可以随时返回并添加测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T20:27:13.653

那个常识，没有完美的答案。TDD 的目标是消除恐惧，如果您有信心对它进行了足够好的测试，请继续...

只是不要忘记，如果您以后发现错误，请先编写测试以重现错误，然后更正它，这样您就可以防止将来的更改再次破坏它！

有些人在没有 X% 的覆盖率时会抱怨……有些测试是无用的，100% 的覆盖率并不意味着你测试了所有可能使你的代码崩溃的东西，只是它不会因为你使用的方式而崩溃它！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-05T04:00:07.000

测试是一种精确描述你想要的东西的方式。添加测试可扩展您想要的*范围*，或添加您想要的*详细信息*。

如果你想不出更多你想要的东西，或者对你想要的东西进行任何改进，那就继续做其他事情。您可以稍后再回来。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-05T04:01:16.280

TDD 中的测试是关于覆盖**规范**的，实际上它们可以**替代**规范。在 TDD 中，测试并不是要覆盖代码。他们确保代码涵盖规范，因为如果代码不涵盖规范，则测试将失败。您拥有的任何额外代码都无关紧要。

因此，当测试看起来描述了您或利益相关者的所有期望时，您就有了足够的测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T21:04:08.900

也许我错过了 Agile/XP 世界的某个地方，但我对这个过程的理解是开发人员和客户*将测试指定为 Feature 的一部分*。这允许测试用例替代更正式的需求文档，帮助识别功能的用例等。因此，当所有这些测试通过时，您就完成了测试和编码......加上您认为的任何边缘案例一路上的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T21:25:37.037

Alberto Savoia[说](http://tinyurl.com/4fnqar)“*如果你所有的测试都通过了，那么你的测试很可能不够好*”。我认为这是思考测试的好方法：询问你是否在做边缘情况，传递一些意想不到的参数等等。提高测试质量的一个好方法是与一对 - 特别是测试人员一起工作 - 并获得有关更多测试用例的帮助。与测试人员结对很好，因为他们有不同的观点。

当然，您可以使用一些工具进行[突变测试](http://en.wikipedia.org/wiki/Mutation_testing)并从测试中获得更多信心。我使用过[Jester](http://jester.sourceforge.net/)，它改进了我的测试和我编写它们的方式。考虑使用类似的东西。

亲切的问候

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T21:44:10.940

从理论上讲，您应该涵盖所有可能的输入组合并测试输出是否正确，但有时它只是不值得。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-05T03:50:59.483

许多其他评论都一针见血。鉴于您的测试覆盖率，您对您编写的代码有信心吗？随着代码的发展，您的测试是否仍能充分覆盖它？您的测试是否捕获了被测组件的预期行为和功能？

必须有一个快乐的媒介。随着您添加越来越多的测试用例，您的测试可能会变得脆弱，因为边缘用例会不断变化。遵循许多早期的建议，提前获得您能想到的所有内容，然后随着软件的发展添加新的测试，这会非常有帮助。这种有机增长可以帮助您的测试增长，而无需预先付出所有努力。

我不会撒谎，但是当我回去编写额外的测试时，我经常会变得懒惰。我可能会错过包含 0 代码的属性或我不关心的默认构造函数。有时，不完全了解流程可以为您节省时间 n 次重要的领域（100% 代码覆盖率神话）。

您必须记住，最终目标是推出一流的产品，而不是在测试中杀死自己。如果你有那种感觉就像你错过了一些东西，那么你很有可能有，你需要添加更多的测试。

祝你好运，编码愉快。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T20:26:08.367

您总是可以使用像 EMMA ( [http://emma.sourceforge.net/](http://emma.sourceforge.net/) ) 或其 Eclipse 插件 EclEmma ( [http://www.eclemma.org/](http://www.eclemma.org/) ) 之类的测试覆盖工具。一些开发人员认为 100% 的测试覆盖率是一个有价值的目标；其他人不同意。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T20:40:26.943

试着在合理的范围内想出所有可能导致失败的方法。Null 值、超出范围的值等。一旦你不能轻易提出任何事情，就继续做其他事情。

如果你在路上发现了一个新的错误或想出了一个方法，添加测试。

这与代码覆盖率无关。这是一个危险的指标，因为代码在“测试良好”之前就已经“覆盖”了很久。

# asp.net - 确定运行 Visual Studio Web 应用程序的端口

> ID：135799
> 
> 赞同：2
> 
> 时间：2008-09-25T20:24:48.103
> 
> 标签：asp.net, visual-studio

我一直在使用[此博客条目](http://weblogs.asp.net/koenv/archive/2008/02/14/quick-attach-and-detach-debugger.aspx)中的宏将 Visual Studio 调试器附加到我当前正在处理的 Web 应用程序的已运行实例。但是，如果我有多个运行 Visual Studio Web 服务器的实例，那么它会附加到哪个实例就很幸运了。

有没有办法确定在 Web 项目中配置了哪个端口，以便我可以修改宏以将其选择的进程过滤到那个端口？

* * *

更多信息

我知道您可以将端口号设置为静态端口号-我从一开始就这样做了，我要确定的是如何以*编程*方式确定定义的端口号，以便我可以修改宏（在链接的博客条目中）并确保它连接到 Visual Studio Web 服务器的正确实例。

我运行的方式是我有两个（或多个）Visual Studio 实例正在运行，每个实例都包含一个解决方案，其中包含一个 Web 项目和一个或多个其他项目 - 通常是一个安装程序项目），所以当我触发来自给定 Visual Studio 实例的宏，我想在该实例加载的解决方案中找到 Web 项目并确定它运行的端口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T16:05:51.070

此代码将为您提供当前解决方案中项目的所有端口的列表：

```
Sub GetWebProjectPorts()
    Dim ports As String

    For Each prj As Project In DTE.Solution.Projects
        For Each p As EnvDTE.Property In prj.Properties
            If p.Name.Contains("DevelopmentServerPort") Then
                If Not String.IsNullOrEmpty(ports) Then
                    ports += ","
                End If
                ports += p.Value.ToString()
            End If
        Next
    Next

    MsgBox(ports)
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T16:41:48.550

如果这可以帮助你，我已经找到了一个链接，它可能实际上是诀窍。

但是，它需要 DllImport 调用和很多乐趣。

你可以看看那篇文章：[http ://bytes.com/forum/thread574901.html](http://bytes.com/forum/thread574901.html)

来自实际网站的报价：

> 通过使用 PInvoke 互操作调用 iphlpapi.dll。谷歌搜索GetExtendedTcpTable 和iphlpapi.dll，我相信你会找到一些现有的东西。
> 
> 威利。

最后一个：

> 以下是一些用于我的目的的 API 方法：
> 
> GetTcpTable()
> AllocateAndGetTcpExTableFromStack()
> GetExtendedTcpTable()
> 
> 我编写了一个小程序，它能够向我展示在 Windows XP 下运行的所有具有所属 TCP 端口（使用 AllocateAndGetTcpExTableFromStack()）的进程。
> 
> 现在我的问题是，在 Windows 2000 下我不能使用 AllocateAndGetTcpExTableFromStack() 或 GetExtendedTcpTable() 所以我只能使用 GetTcpTable() 列出所有 TCP 端口但没有所属进程。
> 
> 有人有同样的问题还是有其他方法（.Net 或 WMI 等）来解决我的问题？
> 
> 提前致谢，
> 
> 维尔纳

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-25T20:27:14.090

如果您转到 Web 项目的属性并查看“Web”选项卡下，您可以指定项目将始终在哪个端口上启动。然后您可以单击“启用编辑并继续”，这样您就不必停止调试并不断重新启动。

# javascript - 在 JavaScript 中按名称获取 cookie 的最佳方法是什么？

> ID：135801
> 
> 赞同：6
> 
> 时间：2008-09-25T20:24:55.670
> 
> 标签：javascript, cookies

我正在使用原型，但找不到任何内置扩展来设置或检索 cookie。在谷歌搜索了一下之后，我看到了几种不同的方法。我想知道您认为在 JavaScript 中获取 cookie 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T20:30:02.897

我使用这个程序：

```
function ReadCookie(name)
{
  name += '=';
  var parts = document.cookie.split(/;\s*/);
  for (var i = 0; i < parts.length; i++)
  {
    var part = parts[i];
    if (part.indexOf(name) == 0)
      return part.substring(name.length)
  }
  return null;
} 
```

效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T20:32:56.073

每当我需要访问它时，我都会使用[document.cookie](http://www.quirksmode.org/js/cookies.html)，基本上就是那篇文章中概述的方式。警告，我从来没有使用过原型，所以可能有更简单的方法，你只是没有遇到过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T21:24:44.587

如果其他人需要它，我已经修复了[Diodeus 的代码](https://stackoverflow.com/a/135855/1217408)，以解决PhiLho在尝试获取 cookie 值时对部分匹配[的担忧。](https://stackoverflow.com/questions/135801/what-is-the-best-way-to-get-a-cookie-by-name-in-javascript/11109684#comment62923_135855)

```
function getCookie(c_name) {
    var nameEQ = c_name + '=';
    var c_start = 0;
    var c_end = 0;
    if (document.cookie.substr(0, nameEQ.length) === nameEQ) {
        return document.cookie.substring(nameEQ.length, document.cookie.indexOf(';', nameEQ.length));
    } else {
        c_start = document.cookie.indexOf('; ' + nameEQ);
        if(c_start !== -1){
            c_start += nameEQ.length + 2;
            c_end = document.cookie.indexOf(';', c_start);
            if (c_end === -1) {c_end = document.cookie.length;}
            return document.cookie.substring(c_start, c_end);
        }
    }
    return null;
} 
```

我最近还构建了一个更紧凑的 RegExp，它也应该可以工作：

```
function getCookie(c_name){
    var ret = window.testCookie.match(new RegExp("(?:^|;)\\s*"+c_name+"=([^;]*)"));
    return (ret !== null ? ret[1] : null);
} 
```

我做了一些速度测试，似乎表明在 PhiLo、QuirksMode 和这两个实现中，上面的非 RegExp 版本（使用 indexOf 非常快，并不意外）是最快的。[http://jsperf.com/cookie-fetcher](http://jsperf.com/cookie-fetcher)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-25T20:32:44.293

我用这个。它是可靠的：

```
function getCookie(c_name) {
if (document.cookie.length>0)
  {
  c_start=document.cookie.indexOf(c_name + "=")
  if (c_start!=-1)
    { 
    c_start=c_start + c_name.length+1 
    c_end=document.cookie.indexOf(";",c_start)
    if (c_end==-1) c_end=document.cookie.length
    return unescape(document.cookie.substring(c_start,c_end))
    } 
  }
return "" 
```

}

# windows - 将进程放入沙箱中，使其危害最小

> ID：135802
> 
> 赞同：24
> 
> 时间：2008-09-25T20:24:56.717
> 
> 标签：windows, linux, security, language-agnostic, macos

我正在寻找**产生这样一个过程**的概念：

*   它只能访问某些库/API
*   它无法访问文件系统或仅访问特定部分
*   如果**恶意代码在其中运行，它的危害最小**

这个概念被称为沙盒或监狱。

**每个主要操作系统（Windows、MacOSX 和 Linux）**都需要执行此操作，并且问题是概念性的（例如要做什么、**要使用哪些 API 以及要观察什么**），而不是特定于语言的问题。

## 回答要求

我**真的**很想接受一个答案，并为此给你20分。我不能接受我自己的答案，而且我还没有。因此，如果您**真的**希望您的答案被接受，请注意：

*   答案必须具体而完整
*   具体而言，我的意思是它不仅仅是指向互联网上某些资源的指针。它必须至少总结资源对主题的看法。
*   它可能包含也可能不包含示例代码，但如果包含，请用 C 编写
*   即使那里的 2/3 是完美的，我也不能接受 2/3 完整的答案。

## 这个问题

*   这是作业吗？不。
*   你为什么像家庭作业一样问这个问题？如果你问了一个特定的问题并且你想得到一个特定的答案，并且你知道这个答案应该是什么样子，即使你不知道答案，这就是你得到的问题的风格*。*
*   如果你知道它应该是什么样子，你为什么要问？1）因为我不知道所有的答案 2）因为在互联网上没有一个地方可以在一个地方包含这个问题的所有细节。另请阅读 stackoverflow 常见问题解答
*   为什么您问题的主要部分是如何回答这个问题？因为没有人阅读常见问题解答。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-30T13:52:34.517

Mac OS X 有一个代号为安全带的沙盒设施。它的公共 API 记录在 sandbox(7)、sandbox_init(3) 和相关手册页中。公共 API 有一些限制，但该工具本身非常强大。虽然公共 API 只允许您从一些预定义的沙箱中进行选择（例如“禁止所有基于套接字的网络”），但您还可以使用更强大的底层实现，它允许您通过类似方案的语言。例如，这里是用于端口映射的沙箱的摘录：

```
(allow process-exec (regex #"^/usr/sbin/portmap$"))
(allow file-read-data file-read-metadata (regex
    #"^/etc"
    #"^/usr/lib/.*\.dylib$"
    #"^/var"
    #"^/private/var/db/dyld/"
    #"^/dev/urandom$"))
(allow file-write-data (regex
    #"^/dev/dtracehelper$")) 
```

您可以在 /usr/share/sandbox 中看到系统使用的许多沙箱。使用 sandbox-exec(1) 命令很容易试验沙箱。

对于 Windows，您可能想看看[David LeBlanc 在 Black Hat USA 2007 上发表的“实用沙盒”演讲](http://media.blackhat.com/bh-usa-07/video/2007_BlackHat_Vegas-V11-LeBlanc-Practical_Sandboxing.mp4)。Windows 本身没有内置的沙盒技术，因此所描述的技术利用了 Windows 2000 引入的称为 SAFER 的不完整机制。通过使用受限令牌，可以创建一个对操作系统资源具有有限访问权限的进程。

对于 Linux，您可能会研究复杂的 SELinux 机制： [SELinux home](http://www.nsa.gov/selinux/) , [a HOWTO](http://www.lurking-grue.org/gettingstarted_newselinuxHOWTO.html)。例如，Red Hat 使用它来强化其某些产品中的某些系统服务。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-26T08:43:38.280

对于 Windows，Google Chrome 中有一个沙盒。你可能想调查一下。它使用自由的类似 BSD 的许可证。

对于 Linux，会有很好的旧 chroot 或更复杂的[http://plash.beasts.org/wiki/](http://plash.beasts.org/wiki/)。

OS X 因为 Leopard 提供了一些类似 SELinux 的保护。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-27T03:18:23.160

站点[codepad.prg](http://codepad.org)有一个很好的[“关于”](http://codepad.org/about)页面，说明它们如何安全地允许执行任何代码片段。

> 代码执行由基于[geordi](http://www.xs4all.nl/~weegen/eelis/geordi/)的主管处理。策略是在 ptrace 下运行所有​​内容，不允许或忽略许多系统调用。编译器和最终可执行文件都在 chroot 监狱中执行，具有严格的资源限制。主管是用 Haskell 编写的。
> 
> 当您的应用程序是远程代码执行时，您必须预料到安全问题。我不仅依赖 chroot 和 ptrace 主管，还采取了一些额外的预防措施：
> 
> *   主管进程在虚拟机上运行，​​这些虚拟机有防火墙，因此它们无法进行传出连接。
>     
>     
> *   运行虚拟机的机器也有严格的防火墙，并定期从它们的源映像中恢复。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T20:29:32.990

FreeBSD 有特定的[监狱](http://en.wikipedia.org/wiki/FreeBSD_jail)概念，而 Solaris 有[容器](http://en.wikipedia.org/wiki/Solaris_Containers)。根据您要查找的内容，这些可能会有所帮助。

chroot jails 可以帮助限制应用程序可以做什么（尽管任何具有 root 权限的应用程序都可以逃脱监狱），并且它们在大多数 UNIXen 上都可用，包括 OS X。

至于Windows，我不确定。如果有一种简单的方法可以对 Windows 应用程序进行沙箱化，那么现在它们中的大多数会更加安全，我敢肯定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T02:07:57.667

在 Windows（2000 和更高版本）上，您可以使用 Job 对象来限制进程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-27T07:22:33.650

如果您真的想要一种适用于所有这些平台的技术，而不是为每个平台提供单独的解决方案，那么我认为您唯一的答案是为每个测试环境设置一个虚拟机。您可以随时恢复到快照。

使用虚拟化的另一大优势是您可以将所有测试环境及其客户操作系统都放在同一个机器上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T08:50:34.270

对于 Linux，有[AppArmor](http://developer.novell.com/wiki/index.php/Apparmor_FAQ)。不幸的是，该项目在某种程度上处于中断状态。
另一个沙盒替代方案是[VServer](http://linux-vserver.org/Welcome_to_Linux-VServer.org)，它使用虚拟化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-11T23:55:51.923

通常，任何虚拟专用服务器都会这样做：

Linux 虚拟服务器 [http://linux-vserver.org/Welcome_to_Linux-VServer.org](http://linux-vserver.org/Welcome_to_Linux-VServer.org)

Parallels Virtuozzo 容器 [http://www.parallels.com/products/pvc/](http://www.parallels.com/products/pvc/)

如前所述，FreeBSD 和 Solaris 有自己的实现。

哦。实际上我注意到你要求它在任何操作系统上工作。好吧，这可能有点复杂，因为我认为更少的努力只是重用一些可以支持某种级别的沙盒的 VM，例如：

*   爪哇
*   。网

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-27T03:27:32.470

我不是该主题的专家，但我认为 linux 的标准答案是定义具有适合该过程的功能的 SeLinux 策略。

# c# - DragDrop 注册没有成功

> ID：135803
> 
> 赞同：16
> 
> 时间：2008-09-25T20:25:05.983
> 
> 标签：c#, visual-studio-2008

> System.InvalidOperationException：DragDrop 注册未成功。---> System.Threading.ThreadStateException：

这个例外是什么意思？我在这一行尝试在运行时将面板添加到面板中得到它......

```
splitReport.Panel1.Controls.Add(ChartPanel); 
```

使用 VS2008 C#

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-02T04:18:15.970

此异常意味着拥有 Panel（正在添加的 Panel）的线程已使用 MTA 线程模型初始化。拖放系统要求调用线程使用 STA 线程模型（特别是它需要通过 OleInitialize 初始化 COM）。线程模型是 .NET 平台的前身 COM 的不幸遗迹。

如果您`[STAThread]`的 Main 函数具有该属性，则主程序线程应该已经是 STA。那么，最可能的解释是这个异常发生在不同的线程上。发生异常时查看 Visual Studio 中的“线程”窗口（调试 | Windows | 线程），看看您是否在主线程以外的线程上。如果是，解决方案可能就像为该新线程设置线程模型一样简单，您可以执行以下操作（将此代码添加到正在创建控件的线程中）：

`Thread.CurrentThread.SetApartmentState( ApartmentState.STA )`

（`Thread`并且`ApartmentState`是 的成员`System.Threading`）

该代码需要在您实际启动新线程之前发生。正如@Tomer 所指出的，您还可以使用该`[STAThread]`属性以声明方式指定它。

如果您发现异常发生在主线程上，请回复并让我们知道，也许我们可以提供更多帮助。异常发生时的堆栈跟踪可能有助于追踪问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-29T07:33:36.690

```
function abc
{
            Thread t = new Thread(new ThreadStart(xyz));
            t.SetApartmentState(ApartmentState.STA);
            t.Start( );    
}
function xyz
{
 the code of Windows form..or whatever which is causing the error
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-20T11:44:43.700

在 Main 方法上添加 STAThreadAttribute 属性。如果您的程序访问 OLE 相关功能，如剪贴板类，则需要此属性。

**[STA线程]**

静态无效主要（字符串 [] 参数）

{

}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-05T12:42:06.587

Yes, I realize this question was asked 2 and a half years ago. I hit this exception and did some reading on it. I corrected it, but didn't see my solution anywhere, so I thought I'd post it somewhere someone else could read.

One possibility for this happening with `[STAThread]` marked on the `Main()` is if you're running this on a thread other than the one you started on.

I just ran into this exception when trying to create and show a new form in a `BackgroundWorker.DoWork` method. To fix it, I wrapped the creation and showing of my new form into a method, and then called `Invoke` on that method so that it fired on the UI thread. This worked because the UI thread started from the `Main()` method with `[STAThread]` marked, as other answers here explained.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-05T06:26:05.730

我不确定你是否解决了这个问题。我刚遇到这个问题，我通过[删除我的`bin`目录](http://www.chapleau.info/cs/blogs/fchapleau/archive/2006/12/01/233.aspx)来修复它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-17T01:56:59.020

我发现了这个错误，导致显示错误的原因是我们有另一个线程调用`MessageBox.Show(this, ...)`. 但是，`this`未完成初始化。

我们需要删除消息框的所有者才能消除错误。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-10T11:28:37.617

到目前为止，最简单的方法是：

```
private void DoSomethingOnGui()
{
    if (this.InvokeRequired)
    {
        this.Invoke((MethodInvoker)delegate
        {
            Safe_DoSomethingOnGui();
        });
    }
    else
    {
        Safe_DoSomethingOnGui();
    }
}
private void Safe_DoSomethingOnGui()
{
    // Do whatever you want with the GUI
} 
```

你甚至可以毫无问题地传递东西：

```
private void DoSomethingOnGui(object o)
{
    if (this.InvokeRequired)
    {
        this.Invoke((MethodInvoker)delegate
        {
            Safe_DoSomethingOnGui(o);
        });
    }
    else
    {
        Safe_DoSomethingOnGui(o);
    }
}
private void Safe_DoSomethingOnGui(object o)
{
    // Do whatever you want with the GUI and o
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-19T07:38:39.603

我通过使用下面的代码解决了这个错误......我正在使用后台工作人员并尝试在后台工作人员访问 UI ......这就是为什么出现错误 - DragDrop 注册没有成功。我们无法从后台工作程序或线程中运行的代码访问 UI。

```
BeginInvoke((MethodInvoker)delegate
{
//write your code here...

}); 
```

谢谢快乐编码...：

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-08T08:05:38.247

`async Task`如果您有签名，也可能发生此错误`Main()`

```
 [STAThread]
    static async Task Main()
    {
    } 
```

如果可行，将其改回`void`

```
 [STAThread]
    static void Main()
    {
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-27T10:13:39.950

我最近遇到这种情况，`[STAThreadAttribute]`在我的情况下，我通过使用**Invoke**方法解决了这个问题，它可能对你们有帮助，所以我分享一个小代码片段：

```
this.Invoke(new InvokeHandler(delegate() 
{
//Your method here!
})); 
```

InvokeHandler 是这样的委托：

```
private delegate void InvokeHandler(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-04T04:04:41.850

“Crypto Obfuscator For .NET”也可以触发此异常，在我的情况下，DragDrop 事件已订阅（来自设计器），但没有包含任何代码，因为我之前已将其注释掉。花了一段时间才弄清楚是什么，这是在更改每个混淆器配置选项 1 之后的下一个.. 归根结底就是这样。如果您使用流行的混淆工具遇到此问题，请记住这一点。

# html - 对于表格数据，什么渲染速度更快，CSS 还是？ 我正在寻找当前浏览器上的一些统计数据，了解使用纯 HTML 渲染表格与避免使用实际 , 等标签的黑客 CSS 清教徒方法相比需要TABLE多TR长时间TD。 我不是在寻找什么是正确的，只是为了什么是更快的，特别是在 Firefox 3 上，尽管我也对其他浏览器的统计数据感兴趣。当然TABLE 问问题 Kev 问问题 2008-09-25T20:27:51.827 6611 次 This question shows research effort; it is useful and clear 7 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在寻找当前浏览器上的一些统计数据，了解使用纯 HTML 渲染表格与避免使用实际 , 等标签的黑客 CSS 清教徒方法相比需要TABLE多TR长时间TD。 我不是在寻找什么是正确的，只是为了什么是更快的，特别是在 Firefox 3 上，尽管我也对其他浏览器的统计数据感兴趣。当然TABLE标签是为表格设计的。那不是问题。 不同的浏览器有非常不同的 javascript/css 性能，所以在这里很难一概而论。例如，IE7 的引擎速度非常慢，而 Chrome 的引擎速度快得令人难以置信。Firefox 介于两者之间，具体取决于您使用的是 2 还是 3。 htmlcsshtml-tablebenchmarking 4 10 回答 10 This answer is useful 18 如果您确实有表格数据，请使用表格。您永远不应该将表格用于任何事情的想法是对正确概念的错误扩展，您应该仅将 html 标签用于其预期的语义目的。这意味着使用 CSS 进行布局，但使用表格作为表格数据。这并不意味着永远不要使用表格。 于 2008-09-25T20:31:00.023 回答 This answer is useful 8 一般来说，我会说将 <table> 用于表格数据。但是，如果表很长（例如，超过 100 行）并且列数很少（~3），则使用 div 模拟行将导致标记占用空间小得多。如果您使用的是 DOM 搜索 javascript（由许多 JS 库提供），这一点尤其重要，因为它有助于减少 DOM 树的大小。 这是根据经验，我有这样一个表格并且正在寻找优化 - 移动到基于 div 的显示将生成的 HTML 减少到三分之一，并且在 DOM 遍历性能方面有了很大的改进。 于 2008-09-25T20:40:13.683 回答 This answer is useful 5 由于某些浏览器会等到整个表格被传输后才显示它，以确保它们已根据内容大小调整列宽，如果您正在寻找每个浏览器的平均值，使用 div 可能会更快地呈现。 话虽如此，如果您需要一张桌子，请使用一张桌子。 于 2008-09-25T20:41:00.577 回答 This answer is useful 2 这个问题看起来和这个问题类似： Why not use tables for layout in HTML? 所以你可能还想检查那里的一些回复。 通常，浏览器在计算整个表格之前不会呈现表格，这意味着从用户的角度来看，大表格比使用 CSS 样式代替表格的相同内容要慢。我曾经使用过一个 Web 应用程序，它使用表格来显示状态信息网格，而且显示起来非常密集而且速度非常慢。使用 CSS 显示的相同信息更快，更重要的是，在加载时开始逐行显示，而不是等待整个表格，因此作为最终用户感觉更快。我建议调查使用 CSS 来显示数据，使用示例数据集进行测试。这就是我所做的，以确认对于我们拥有的特定用例，这些表实际上要慢得多。 于 2008-09-25T20:53:43.933 回答 This answer is useful 2 如果您使用 CSS 进行布局并且遵循最佳实践并将 CSS 保存在单独的文件中，那么您的 CSS 通常只需要在缓存之前下载一次，从而为您提供缓存的好处。 如果您使用表格进行布局，那么您的布局表格将与每个页面的 HTML 一起发送，从而增加您的带宽和下载时间。 为了提高表格的渲染速度，您可以尝试设置 table-layout:fixed; 看看是否有帮助.. 于 2008-09-26T09:51:04.063 回答 This answer is useful 1 我不会把渲染速度作为这里最重要的方面。HTML 表格是为表格数据制作的。在我的理解中，将它放入很多 DIV 左右是完全错误的。 于 2008-09-25T20:31:13.080 回答 This answer is useful 1 与上述大多数答案一样，如果您要显示表格数据，我也会说使用表格，如果您想控制布局（使用 CSS3），则使用 DIV。与想象相反，如果您设置一些属性（如 colgroup）并保持布局固定，表格的渲染速度并不比 DIV 慢。查看以下链接中的详细信息： sites.google.com/site/spyderhoodcommunity/xhtml/makingtablesrenderfasterwhenlistingtabulardata 于 2009-05-19T10:12:17.423 回答 This answer is useful 1 不同的浏览器有非常不同的 javascript/css 性能，所以在这里很难一概而论。例如，IE7 的引擎速度非常慢，而 Chrome 的引擎速度快得令人难以置信。Firefox 介于两者之间，具体取决于您使用的是 2 还是 3。 于 2008-09-25T20:30:05.503 回答 This answer is useful 0 对于表格数据，请使用表格。表格具有各种不错的功能，例如<thead>标签<tfoot>、图例、标题、说明等。将表格变成表格所需的一切。 此外，如果 CSS 不起作用/未加载/无关紧要，表格仍将按应有的方式显示和工作。 于 2008-09-25T20:33:19.800 回答 This answer is useful -1 就我个人而言，如果您实际上是在呈现表格数据，那么表格更适合该任务，我个人认为这是非常正确的。 至于“更快”的原始数量，正如@skaffman 所提到的，它取决于浏览器......但要“正确”，使用表格数据的表格是有意义的。 于 2008-09-25T20:32:18.430 回答 Related 3 html - 首先尝试 Firebug 和 CSS 2 c# - IEnumerable 和 Take(x) 问题？ 1 vb.net - 从 MEF 中的容器获取导出（Lambda 表达式） 3 c++ - 在嵌入式系统上从 DOS 切换到 Linux 1 java - 每当请求是映射的 servlet 时，如何知道过滤器内部？ 2 c# - 禁止访问 C# WinForms 游戏中的图像 1 java - Java 实体类：如何在具有连接列的实体中添加/编辑项目？ 2 static-analysis - 静态代码分析——Cobol.Net程序的依赖图 0 java - mule 是先获取它的依赖项还是项目的依赖项？ 1 trello - 如何使用 Trello API 将列表添加到看板 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：135826
> 
> 赞同：7
> 
> 时间：
> 
> 标签：html, css, html-table, benchmarking

我正在寻找当前浏览器上的一些统计数据，了解使用纯 HTML 渲染表格与避免使用实际 , 等标签的黑客 CSS 清教徒方法相比需要`TABLE`多`TR`长时间`TD`。

**我不是在寻找什么是正确的，只是为了什么是更快的**，特别是在 Firefox 3 上，尽管我也对其他浏览器的统计数据感兴趣。当然*TABLE*标签是为表格设计的。那不是问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T20:31:00.023

如果您确实有表格数据，请使用表格。您永远不应该将表格用于任何事情的想法是对正确概念的错误扩展，您应该仅将 html 标签用于其预期的语义目的。这意味着使用 CSS 进行布局，但使用表格作为表格数据。这并不意味着永远不要使用表格。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T20:40:13.683

一般来说，我会说将 <table> 用于表格数据。但是，如果表很长（例如，超过 100 行）并且列数很少（~3），则使用 div 模拟行将导致标记占用空间小得多。如果您使用的是 DOM 搜索 javascript（由许多 JS 库提供），这一点尤其重要，因为它有助于减少 DOM 树的大小。

这是根据经验，我有这样一个表格并且正在寻找优化 - 移动到基于 div 的显示将生成的 HTML 减少到三分之一，并且在 DOM 遍历性能方面有了很大的改进。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T20:41:00.577

由于某些浏览器会等到整个表格被传输后才显示它，以确保它们已根据内容大小调整列宽，如果您正在寻找每个浏览器的平均值，使用 div 可能会更快**地呈现。**

话虽如此，如果您需要一张桌子，请使用一张桌子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T20:53:43.933

这个问题看起来和这个问题类似： [Why not use tables for layout in HTML?](https://stackoverflow.com/questions/83073/div-vs-table) 所以你可能还想检查那里的一些回复。

通常，浏览器在计算整个表格之前不会呈现表格，这意味着从用户的角度来看，大表格比使用 CSS 样式代替表格的相同内容要慢。我曾经使用过一个 Web 应用程序，它使用表格来显示状态信息网格，而且显示起来非常密集而且速度非常慢。使用 CSS 显示的相同信息更快，更重要的是，在加载时开始逐行显示，而不是等待整个表格，因此作为最终用户*感觉更快。*我建议调查使用 CSS 来显示数据，使用示例数据集进行测试。这就是我所做的，以确认对于我们拥有的特定用例，这些表实际上要慢得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-26T09:51:04.063

如果您使用 CSS 进行布局并且遵循最佳实践并将 CSS 保存在单独的文件中，那么您的 CSS 通常只需要在缓存之前下载一次，从而为您提供缓存的好处。

如果您使用表格进行布局，那么您的布局表格将与每个页面的 HTML 一起发送，从而增加您的带宽和下载时间。

为了提高表格的渲染速度，您可以尝试[设置 table-layout:fixed;](http://www.sitepoint.com/blogs/2008/08/05/mining-the-sitepoint-css-reference/#adz) 看看是否有帮助..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T20:31:13.080

我不会把渲染速度作为这里最重要的方面。HTML 表格是为表格数据制作的。在我的理解中，将它放入很多 DIV 左右是完全错误的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T10:12:17.423

与上述大多数答案一样，如果您要显示表格数据，我也会说使用表格，如果您想控制布局（使用 CSS3），则使用 DIV。**与想象相反，**如果您设置一些属性（如 colgroup）并保持布局固定，表格的渲染速度并不比 DIV 慢。查看以下链接中的详细信息：

sites.google.com/site/spyderhoodcommunity/xhtml/makingtablesrenderfasterwhenlistingtabulardata

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T20:30:05.503

不同的浏览器有非常不同的 javascript/css 性能，所以在这里很难一概而论。例如，IE7 的引擎速度非常慢，而 Chrome 的引擎速度快得令人难以置信。Firefox 介于两者之间，具体取决于您使用的是 2 还是 3。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T20:33:19.800

对于表格数据，请使用表格。表格具有各种不错的功能，例如`<thead>`标签`<tfoot>`、图例、标题、说明等。将表格变成表格所需的一切。

此外，如果 CSS 不起作用/未加载/无关紧要，表格仍将按应有的方式显示和工作。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-25T20:32:18.430

就我个人而言，如果您实际上是在呈现表格数据，那么表格更适合该任务，我个人认为这是非常正确的。

至于“更快”的原始数量，正如@skaffman 所提到的，它取决于浏览器......但要“正确”，使用表格数据的表格是有意义的。

# web-services - SOAP 标头中的应用程序特定元数据

> ID：135832
> 
> 赞同：2
> 
> 时间：2008-09-25T20:29:23.850
> 
> 标签：web-services, soa

您认为将我们的应用程序特定元数据放在 SOAP 标头中是个好主意吗？

例如，在我们的组织中，我们希望跟踪通过各种服务的每条消息，我想跟踪服务路径（就像 TCP 一样）以了解哪些所有服务处理了消息等。为此，目前我们正在定义自己的消息SOAP 消息上的格式（具有标题和正文）。

我想就这是否是一个好主意或者我应该将我的应用程序元数据放在 SOAP 标头本身中获得您的意见。

谢谢曼珠

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T22:27:39.290

将您的应用程序元数据放在 SOAP 标头中 - 否则您将同时支持您自己的私有信封格式和 SOAP 格式，没有特别的优势。

您的元数据很大吗？这可能是把它排除在肥皂标题之外的原因之一。

# python - Python：SWIG 与 ctypes

> ID：135834
> 
> 赞同：61
> 
> 时间：2008-09-25T20:29:27.767
> 
> 标签：python, c++, swig, ctypes, ffi

在 python 中，在什么情况下 SWIG 比 ctypes 更适合调用共享库中的入口点？假设您还没有 SWIG 接口文件。

两者的性能指标是什么？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2011-02-03T22:47:25.317

我有丰富的swig使用经验。SWIG 声称它是包装物品的快速解决方案。但在现实生活中...

* * *

# 缺点：

SWIG 被开发为通用的，适用于所有人和 20 多种语言。通常，它会导致缺点：
- 需要配置（SWIG .i 模板），有时很棘手，
- 缺乏对某些特殊情况的处理（进一步参见 python 属性），
- 某些语言缺乏性能。

*Python 缺点：*

1）**代码风格不一致**。C++ 和 python 有非常不同的代码风格（这是显而易见的，当然），让目标代码更 Pythonish 的可能性非常有限。例如，从 getter 和 setter 创建属性是很重要的。看到[这个问答](https://stackoverflow.com/questions/1183716/python-properties-swig)

2）**缺乏广泛的社区**。SWIG 有一些很好的文档。但是，如果有人发现文档中没有的内容，则根本没有任何信息。没有博客和谷歌搜索有帮助。所以在这种情况下必须大量挖掘 SWIG 生成的代码......这太可怕了，我可以说......

# 优点：

*   在简单的情况下，它确实快速、简单、直接

*   如果您曾经生成过 swig 接口文件，则可以将此 C++ 代码包装到其他 20 多种语言中的任何一种（！！！）。

*   SWIG 的一大担忧是性能。由于 2.04 版 SWIG 包含“-builtin”标志，这使得 SWIG 比其他自动包装方式更快。至少[一些基准测试](https://stackoverflow.com/questions/456884/extending-python-to-swig-not-to-swig-or-cython)表明了这一点。

* * *

# 何时使用 SWIG？

因此，我为自己总结了两种适合使用 swig 的情况：

2) 如果需要**为多种语言**包装 C++ 代码。或者，如果可能有一段时间需要为多种语言分发代码。在这种情况下，使用 SWIG 是可靠的。

1）如果需要**快速**包装一些 C++ 库中的**几个**函数以供最终使用。

* * *

# 现场体验

**更新**：
一年半过去了，因为我们使用 SWIG 对我们的库进行了转换。

首先，我们制作了一个python版本。有好几次我们在使用 SWIG 时遇到了麻烦——这是真的。但现在我们将库扩展到 Java 和 .NET。所以我们有 3 种语言和 1 个 SWIG。我可以说**SWIG**在节省大量时间方面非常出色。

**更新 2**：
我们在这个库中使用 SWIG 已经是两年了。SWIG 已集成到我们的构建系统中。最近我们对 C++ 库的 API 进行了重大更改。SWIG 工作得很好。我们唯一需要做的就是将几个 %rename 添加到 .i 文件中，以便我们`CppCamelStyleFunctions()`现在`looks_more_pythonish`在 python 中。首先，我担心可能出现的一些问题，但没有出现任何问题。这是惊人的。只需进行几次编辑，所有内容均以 3 种语言分发。现在我相信在我们的案例中使用 SWIG 是一个很好的解决方案。

**更新 3**：
我们为我们的图书馆使用 SWIG 已经 3 年多了。**主要变化**：python 部分完全用纯 python 重写。原因是 Python 现在用于我们库的大多数应用程序。即使纯 python 版本的工作速度比 C++ 包装慢，但用户使用纯 python 更方便，而不是与原生库苦苦挣扎。

SWIG 仍用于 .NET 和 Java 版本。

这里的主要问题“如果我们从头开始项目，我们会为 python 使用 SWIG 吗？”。我们会！SWIG 使我们能够将我们的产品快速分发为多种语言。它工作了一段时间，让我们有机会更好地了解我们的用户需求。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-09-25T20:47:28.410

SWIG 生成（相当难看的）C 或 C++ 代码。它可以直接用于简单的函数（可以直接翻译的东西），并且相当容易用于更复杂的函数（例如具有输出参数的函数，需要额外的翻译步骤才能在 Python 中表示。）对于更强大的接口，您经常需要将 C 的位写入接口文件的一部分。除了简单的使用之外，您还需要了解 CPython 以及它如何表示对象——并不难，但需要牢记。

ctypes 允许您直接访问 C 函数、结构和其他数据，并加载任意共享库。您不需要为此编写任何 C，但您确实需要了解 C 的工作原理。您可能会说，它是 SWIG 的另一面：它不生成代码，并且在运行时不需要编译器，但除了简单的使用之外，它确实需要您了解诸如 C 数据类型、强制转换、内存管理和对齐工作。您还需要手动或自动将 C 结构、联合和数组转换为等效的 ctypes 数据结构，包括正确的内存布局。

在纯执行中，SWIG 可能比 ctypes 更快——因为围绕实际工作的管理是在编译时在 C 中完成的，而不是在运行时在 Python 中完成的。但是，除非您连接许多不同的 C 函数，但每个函数只连接几次，否则开销不太可能真的很明显。

在开发时，ctypes 的启动成本要低得多：您不必了解接口文件，不必生成 .c 文件并编译它们，您不必检查并消除警告。您可以轻松地开始使用单个 C 函数，然后将其扩展为更多。您可以直接在 Python 解释器中进行测试和尝试。包装大量代码有点乏味，尽管有一些尝试让它变得更简单（比如 ctypes-configure。）

另一方面，SWIG 可用于为多种语言生成包装器（除非需要填写特定于语言的细节，例如我上面提到的自定义 C 代码。）当包装大量 SWIG 可以处理的代码时帮助，代码生成也可以比 ctypes 等效设置简单得多。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-25T20:35:17.580

CTypes 非常酷并且比 SWIG 容易得多，但它的缺点是编写不佳或恶意编写的 python 代码实际上可能会使 python 进程崩溃。您还应该考虑[boost](http://www.boost.org/doc/libs/release/libs/python/doc/) python。恕我直言，它实际上比 swig 更容易，同时让您可以更好地控制最终的 python 界面。如果您无论如何都在使用 C++，那么您也不会在您的组合中添加任何其他语言。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-21T01:36:28.550

根据我的经验，ctypes 确实有一个很大的缺点：当出现问题时（对于任何复杂的接口都会出现问题），调试起来简直就是地狱。

问题是你的堆栈的很大一部分被 ctypes/ffi 魔法遮住了，没有简单的方法来确定你是如何到达特定点的，以及为什么参数值是它们的值。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-25T20:54:22.447

您还可以使用[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)，它可以充当高级 Python 代码和低级 C 代码之间的粘合剂。[例如， lxml](http://codespeak.net/lxml/)是用 Pyrex 编写的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-25T21:22:15.533

ctypes 很棒，但不处理 C++ 类。我还发现 ctypes 比直接 C 绑定慢约 10%，但这在很大程度上取决于您所调用的内容。

如果您打算使用 ctypes，请务必查看 Pyglet 和 Pyopengl 项目，它们有大量 ctype 绑定示例。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-26T04:49:05.350

我将逆向建议，如果可以的话，你应该使用[标准的 Python API](http://docs.python.org/api/)来编写你的扩展库。从 C 和 Python 的角度来看，它确实很好地集成了……如果您对 Perl API 有任何经验，您会发现它*非常*令人惊喜。

Ctypes 也很好，但正如其他人所说，它不支持 C++。

您要包装的图书馆有多大？代码库的变化有多快？还有其他维护问题吗？这些都可能会影响编写 Python 绑定的最佳方式的选择。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-08-04T06:13:02.127

只是想添加一些我还没有看到的注意事项。[编辑：糟糕，没有看到 Mike Steder 的回答]

如果您想尝试使用非 Cpython 实现（如 PyPy、IronPython 或 Jython），那么 ctypes 是唯一的方法。PyPy 不允许编写 C 扩展，因此排除了 pyrex/cython 和 Boost.python。出于同样的原因，ctypes 是唯一适用于 IronPython 和（最终，一旦它们全部工作）jython 的机制。

正如其他人提到的，不需要编译。这意味着如果 .dll 或 .so 的新版本出现，您只需将其放入并加载该新版本。只要没有任何接口发生变化，它就是替代品。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-02-25T05:35:20.143

需要记住的是，SWIG 仅针对 CPython 实现。由于 PyPy 和 IronPython 实现也支持 ctypes，因此可能值得使用 ctypes 编写模块以与更广泛的 Python 生态系统兼容。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-28T15:17:46.637

我发现 SWIG 的方法有点臃肿（一般来说，不仅仅是 Python），并且很难实现，而不必跨越以明确的心态编写 Python 代码以对 SWIG 友好，而不是写得干净的痛点- 编写的 Python 代码。恕我直言，将 C 绑定编写到 C++（如果使用 C++）然后使用 ctypes 连接到任何 C 层，这是一个更直接的过程。

如果您要连接的库具有作为库一部分的 C 接口，则 ctypes 的另一个优点是您不必编译单独的 python 绑定库来访问第三方库。这在制定避免跨平台编译问题的纯 python 解决方案时特别好（对于那些在不同平台上提供的第三方库）。必须以跨平台友好的方式将编译后的代码嵌入到您希望部署在 PyPi 之类的东西上的包中，这很痛苦。关于使用 SWIG 或底层显式 C 代码的 Python 包，我最恼火的一点是它们通常无法跨平台使用。因此，如果您正在使用跨平台可用的第三方库并围绕它们开发 python 解决方案，请考虑这一点。

作为一个真实的例子，考虑 PyGTK。这（我相信）使用 SWIG 生成 C 代码以连接 GTK C 调用。我在最短的时间内使用它只是发现设置和使用它真的很痛苦，如果你在设置时没有按照正确的顺序做事情，就会出现奇怪的奇怪错误，而且只是一般情况下。这是一次令人沮丧的经历，当我在网上查看 GTK 提供的接口定义时，我意识到将这些接口编写为 python ctypes 接口的翻译器是多么简单的练习。一个名为 PyGGI 的项目诞生了，有一天我能够将 PyGTK 重写为一个功能更强大、更有用的产品，它与 GTK C 面向对象的接口完全匹配。而且它不需要编译 C 代码，使其跨平台友好。（我实际上是在连接到 webkitgtk 之后，这不是 t如此跨平台）。我还可以轻松地将 PyGGI 部署到任何支持 GTK 的平台。

# mysqldump - 限制来自 mysqldump 的记录数？

> ID：135835
> 
> 赞同：152
> 
> 时间：2008-09-25T20:29:30.463
> 
> 标签：mysqldump

我正在尝试将大型数据库中的一小部分记录加载到测试数据库中。

你如何告诉 mysqldump 只给你 800 万条记录中的 n 条记录？

谢谢

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2008-09-25T20:39:45.620

正如 skaffman 所说，使用 --where**选项**：

```
mysqldump --opt --where="1 limit 1000000" database 
```

当然，这将为您提供每个表中的前一百万行。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2013-11-07T08:23:20.933

如果`n`要从特定表中获取记录，可以执行以下操作：

```
mysqldump --opt --where="1 limit 1000000" database table > dump.sql 
```

这会将命名表中的第一`1000000`行转储`table`到文件`dump.sql`中。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-09-08T09:42:54.147

由于默认顺序是 ASC，这在这种情况下很少需要，因此您需要有适当的数据库设计才能使 DESC 开箱即用。如果您的所有表都有一个具有相同名称（自然或代理）的主键列，您可以使用以下方法轻松转储 n 个最新记录：

```
mysqldump --opt --where="1 ORDER BY id DESC limit 1000000" --all-databases > dump.sql 
```

这是为什么您应该始终命名您的 PK 的*id*并避免使用复合 PK 的一个完美理由，即使在关联表中也是如此（使用代理键代替）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T20:31:06.687

可以给 mysqldump 一个 SQL 查询来执行，它将从中获取转储的数据。然后，您可以在查询中使用“limit X”子句来限制行数。

# c# - 在 VB.NET 中将类标记为静态

> ID：135841
> 
> 赞同：90
> 
> 时间：2008-09-25T20:30:32.007
> 
> 标签：c#, vb.net

正如在最近的[问答](https://stackoverflow.com/questions/135759/why-cant-i-inherit-iodirectory)中[所述](https://stackoverflow.com/questions/135759/why-cant-i-inherit-iodirectory#135772)，您不能从静态类继承。如何执行与 VB.NET 中的静态类相关的规则？由于该框架在 C# 和 VB 之间兼容，因此有办法将类标记为静态是有道理的，但似乎没有办法。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2008-09-25T20:32:22.313

模块 == 静态类

如果只想要一个不能继承的类，就用一个`NotInheritable`类；但它不会是静态/共享的。您可以将所有方法、属性和成员标记为`Shared`，但这与 C# 中的静态类并不完全相同，因为它不是由编译器强制执行的。

如果您真的希望 VB.Net 等效于 C# 静态类，请使用`Module`. 它不能被继承，所有成员、属性和方法都是静态/共享的。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-09-20T17:27:16.707

差不多好了。你也必须防止实例化。

```
NotInheritable Class MyStaticClass

    ''' <summary>
    ''' Prevent instantiation.
    ''' </summary>
    Private Sub New()

    End Sub

    Public Shared Function MyMethod() As String

    End Function

End Class 
```

*   Shared 就像静态类的方法。
*   NotInheritable 就像密封的一样。
*   Private New 就像静态类一样无法实例化。

请参阅：
[MSDN - 静态类和静态类成员](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.90%29.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T20:32:46.620

如果你只想创建一个不能继承的类，在 C# 中可以使用 Sealed，在 VB.Net 中使用 NotInheritable。

VB.Net 等价于 static 是共享的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-11T12:45:15.623

您可以在 vb.net 中创建静态类。解决方案是

```
Friend NotInheritable Class DB
    Public Shared AGE As Integer = 20
End Class 
```

AGE 变量是 public static，你可以像这样在其他代码中使用它

```
 Dim myage As Integer = DB.AGE 
```

朋友 = 公共，NotInheritable = 静态

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T20:40:05.773

从 CLR 的角度来看，C# 静态类只是“密封”和“抽象”类。你不能创建一个实例，因为它是抽象的，你不能从它继承，因为它是密封的。其余的只是一些编译器魔法。

# coding-style - 布尔值作为方法参数是不可接受的吗？

> ID：135845
> 
> 赞同：123
> 
> 时间：2008-09-25T20:31:26.810
> 
> 标签：coding-style, boolean, enumeration

我的一位同事表示，**布尔值作为方法参数是不可接受的**。它们应由枚举代替。起初我没有看到任何好处，但他给了我一个例子。

什么更容易理解？

```
file.writeData( data, true ); 
```

或者

```
enum WriteMode {
  Append,
  Overwrite
};

file.writeData( data, Append ); 
```

现在我明白了！;-)
这绝对是一个示例，其中枚举作为第二个参数使代码更具可读性。

那么，您对这个话题有何看法？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2008-09-25T20:35:02.977

布尔值代表“是/否”的选择。如果要表示“是/否”，则使用布尔值，它应该是不言自明的。

但是，如果它是在两个选项之间进行选择，而这两个选项都不是明确的是或否，那么枚举有时会更具可读性。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-09-25T20:34:06.227

枚举还允许将来进行修改，您现在需要第三个选择（或更多）。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-25T20:42:55.800

使用最适合您的问题的模型。在您给出的示例中，枚举是一个更好的选择。但是，在其他时候布尔值会更好。这对你来说更有意义：

```
lock.setIsLocked(True); 
```

或者

```
enum LockState { Locked, Unlocked };
lock.setLockState(Locked); 
```

在这种情况下，我可能会选择布尔选项，因为我认为它非常清晰明确，而且我很确定我的锁不会有两个以上的状态。尽管如此，第二个选择是有效的，但不必要的复杂，恕我直言。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-11-03T23:59:31.787

对我来说，使用布尔值和枚举都不是一个好方法。Robert C. Martin 在他的[Clean Code Tip #12: Eliminate Boolean Arguments](http://www.informit.com/articles/article.aspx?p=1392524)中非常清楚地捕捉到了这一点：

> 布尔参数大声声明该函数不止一件事。它们令人困惑，应该被消除。

如果一个方法做不止一件事，您应该编写两种不同的方法，例如在您的情况下：`file.append(data)`和`file.overwrite(data)`.

使用枚举并不能使事情更清楚。它没有改变任何东西，它仍然是一个标志参数。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-25T20:35:37.657

我认为您几乎自己回答了这个问题，我认为最终目标是使代码更具可读性，在这种情况下，枚举做到了，IMO 始终最好查看最终目标而不是一揽子规则，也许多想一下作为准则，即枚举在代码中通常比通用布尔值、整数等更具可读性，但规则总会有例外。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-09-25T20:46:04.450

[还记得古巴导弹危机](http://answers.google.com/answers/threadview/id/765433.html)期间阿德莱史蒂文森向联合国驻联合国大使佐林提出的问题吗？

> “你现在在世界舆论的法庭上，你可以回答 **是或否**。你否认[导弹]存在，我想知道我是否正确理解你......我准备等待直到地狱结冰为止，如果这是你的决定的话。”

如果您在方法中使用的标志具有这样一种性质，您可以将其固定为**二元决策**，并且该决策**永远不会**变成三向或多向决策，请选择布尔值。适应症：你的旗帜叫做**isXXX**。

如果是**模式开关**，请不要将其设为布尔值。在编写方法时，总**有一种模式**比你想象的要多。

一种模式的困境例如困扰着 Unix，其中文件或目录今天可能具有的可能的权限模式会导致模式的奇怪双重含义，具体取决于文件类型、所有权等。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-25T21:03:10.477

我遇到这件事的原因有两个：

1.  因为有些人会写这样的方法：

    ```
    ProcessBatch(true, false, false, true, false, false, true); 
    ```

    这显然很糟糕，因为混淆参数太容易了，而且你不知道你在指定什么。不过，只有一个布尔值并不算太糟糕。

2.  因为通过简单的是/否分支控制程序流可能意味着您有两个完全不同的功能，它们以一种尴尬的方式包装成一个。例如：

    ```
    public void Write(bool toOptical); 
    ```

    真的，这应该是两种方法

    ```
    public void WriteOptical();
    public void WriteMagnetic(); 
    ```

    因为这些代码可能完全不同；他们可能必须进行各种不同的错误处理和验证，甚至可能必须以不同的方式格式化输出数据。您不能仅通过使用`Write()`或什至来判断这一点`Write(Enum.Optical)`（当然，如果您愿意，您可以让这些方法中的任何一个只调用内部方法 WriteOptical/Mag）。

我想这取决于。除了#1，我不会对此大惊小怪。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-25T20:35:39.297

枚举更好，但我不会将布尔参数称为“不可接受的”。有时输入一个小布尔值并继续前进会更容易（想想私有方法等）

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-25T20:50:02.833

在具有命名参数的语言（如 Python 和 Objective-C）中，布尔值可能没问题，因为名称可以解释参数的作用：

```
file.writeData(data, overwrite=true) 
```

或者：

```
[file writeData:data overwrite:YES] 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-25T20:41:10.357

我不同意这是一个好**规则**。显然，Enum 在某些情况下提供了更好的显式或详细代码，但通常它似乎超出了范围。

首先让我举个例子：程序员编写好的代码的责任（和能力）并没有真正受到布尔参数的危害。在您的示例中，程序员可以通过编写以下代码来编写冗长的代码：

```
dim append as boolean = true
file.writeData( data, append ); 
```

或者我更喜欢更一般的

```
dim shouldAppend as boolean = true
file.writeData( data, shouldAppend ); 
```

第二：您提供的 Enum 示例只是“更好”，因为您正在传递一个 CONST。在大多数应用程序中，传递给函数的参数很可能至少有一些（如果不是大部分）是变量。在这种情况下，我的第二个示例（给出具有好名称的变量）要好得多，而 Enum 不会给您带来什么好处。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-25T21:03:44.750

枚举有一个明确的好处，但你不应该只是用枚举替换所有的布尔值。在很多地方，真/假实际上是表示正在发生的事情的最佳方式。

但是，将它们用作方法参数有点可疑，仅仅是因为如果不深入研究它们应该做什么，你就看不到它们，因为它们让你看到真/假的*实际含义*

属性（尤其是使用 C#3 对象初始化程序）或关键字参数（la ruby​​ 或 python）是一种更好的方法，可以在其他情况下使用布尔参数。

C# 示例：

```
var worker = new BackgroundWorker { WorkerReportsProgress = true }; 
```

红宝石示例

```
validates_presence_of :name, :allow_nil => true 
```

Python 示例

```
connect_to_database( persistent=true ) 
```

我唯一能想到的布尔方法参数是正确的做法是在 java 中，你没有属性或关键字参数。这是我讨厌 java 的原因之一 :-(

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-25T22:37:46.723

虽然在许多情况下枚举确实比布尔值更具可读性和可扩展性，但“布尔值不可接受”的绝对规则是愚蠢的。它不灵活且适得其反——它不会为人类判断留下空间。它们是大多数语言中的基本内置类型，因为它们很有用 - 考虑将其应用到其他内置类型：例如说“永远不要使用 int 作为参数”会很疯狂。

这条规则只是风格问题，而不是潜在的错误或运行时性能问题。更好的规则是“出于可读性的原因，更喜欢枚举而不是布尔值”。

看看 .Net 框架。布尔值用作很多方法的参数。.Net API 并不完美，但我不认为使用布尔值作为参数是一个大问题。工具提示总是给你参数的名称，你也可以建立这种指导——在方法参数上填写你的 XML 注释，它们会出现在工具提示中。

我还应该补充一点，在某些情况下，您应该清楚地将布尔值重构为枚举 - 当您的类或方法参数中有两个或多个布尔值时，并非所有状态都是有效的（例如，拥有它们是无效的两者都设置为真）。

例如，如果您的课程具有以下属性

```
public bool IsFoo
public bool IsBar 
```

同时让它们都为真是错误的，你实际上得到的是三个有效状态，更好地表达为：

```
enum FooBarType { IsFoo, IsBar, IsNeither }; 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2010-03-26T18:22:46.233

您的同事可能会更好地遵守的一些规则是：

*   不要对你的设计教条主义。
*   选择最适合您的代码用户的内容。
*   不要仅仅因为你喜欢这个月的形状，就试图将星形钉子砸进每个洞！

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-25T20:34:17.160

仅当您不打算扩展框架的功能时，才可以接受布尔值。Enum 是首选，因为您可以扩展 enum 而不会破坏函数调用的先前实现。

Enum 的另一个优点是更易于阅读。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-25T20:36:49.837

如果该方法提出以下问题：

```
KeepWritingData (DataAvailable()); 
```

在哪里

```
bool DataAvailable()
{
    return true; //data is ALWAYS available!
}

void KeepWritingData (bool keepGoing)
{
   if (keepGoing)
   {
       ...
   }
} 
```

布尔方法参数似乎具有绝对完美的意义。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-25T20:37:54.377

这取决于方法。如果该方法所做的某些事情很明显是真/假，那很好，例如下面[虽然我不是说这是该方法的最佳设计，它只是一个使用明显的示例]。

```
CommentService.SetApprovalStatus(commentId, false); 
```

但是在大多数情况下，例如您提到的示例，最好使用枚举。在 .NET Framework 本身中有许多不遵循此约定的示例，但那是因为他们在周期的后期引入了此设计指南。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-25T20:39:53.513

它确实使事情变得更加明确，但确实开始大量扩展接口的复杂性 - 在纯粹的布尔选择中，例如附加/覆盖它似乎有点过头了。如果您需要添加更多选项（在这种情况下我无法想到），您始终可以执行重构（取决于语言）

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-25T21:27:44.567

枚举当然可以使代码更具可读性。还有一些事情需要注意（至少在 .net 中）

因为枚举的底层存储是 int，所以默认值将为零，因此您应该确保 0 是合理的默认值。（例如，结构在创建时将所有字段设置为零，因此无法指定除 0 以外的默认值。如果您没有 0 值，您甚至无法在不强制转换为 int 的情况下测试枚举，这将是风格不好。）

如果您的枚举对您的代码是私有的（从不公开），那么您可以在此处停止阅读。

如果您的枚举以任何方式*发布*到外部代码和/或保存在程序之外，请考虑明确编号。编译器会自动从 0 开始对它们进行编号，但是如果您重新排列枚举而不给它们值，则最终可能会出现缺陷。

我可以合法地写

```
WriteMode illegalButWorks = (WriteMode)1000000;
file.Write( data, illegalButWorks ); 
```

为了解决这个问题，任何使用您无法确定的枚举的代码（例如公共 API）都需要检查该枚举是否有效。您通过以下方式执行此操作

```
if (!Enum.IsDefined(typeof(WriteMode), userValue))
    throw new ArgumentException("userValue"); 
```

唯一需要注意的`Enum.IsDefined`是它使用反射并且速度较慢。它还存在版本控制问题。如果您需要经常检查枚举值，您最好采用以下方法：

```
public static bool CheckWriteModeEnumValue(WriteMode writeMode)
{
  switch( writeMode )
  {
    case WriteMode.Append:
    case WriteMode.OverWrite:
      break;
    default:
      Debug.Assert(false, "The WriteMode '" + writeMode + "' is not valid.");
      return false;
  }
  return true;
} 
```

版本控制问题是旧代码可能只知道如何处理您拥有的 2 个枚举。如果添加第三个值，Enum.IsDefined 将为 true，但旧代码不一定能处理它。哎呀。

使用枚举可以做更多有趣的事情`[Flags]`，并且验证代码略有不同。

我还要注意，为了可移植性，您应该`ToString()`在枚举上使用 call，并`Enum.Parse()`在读回它们时使用。两者`ToString()`和`Enum.Parse()`也可以处理`[Flags]`枚举，所以没有理由不使用它们。请注意，这是另一个陷阱，因为现在您甚至无法在不破坏代码的情况下更改枚举的名称。

*所以，有时当你问自己我能不能只用一个布尔值*时，你需要权衡上述所有因素？

 ** * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-25T20:38:03.610

恕我直言，对于任何可能有两个以上选项的情况，枚举似乎都是显而易见的选择。但是在某些情况下，您只需要一个布尔值。在那种情况下，我会说使用一个 bool 可以工作的枚举将是一个使用 7 个单词的例子，而 4 个单词可以。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-25T20:38:40.410

当您有一个明显的切换只能是两件事之一（即灯泡的状态，开或关）时，布尔值是有意义的。除此之外，最好以这样一种方式编写它，以便您传递的内容很明显 - 例如磁盘写入 - 无缓冲、行缓冲或同步 - 应该这样传递。即使您现在不想允许同步写入（因此您仅限于两个选项），也值得考虑让它们更详细，以便乍一看知道它们在做什么。

也就是说，您也可以使用 False 和 True（布尔值 0 和 1），然后如果您以后需要更多值，请将函数扩展为支持用户定义的值（例如，2 和 3）以及旧的 0/1 值将很好地移植，因此您的代码不应该中断。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-11T09:11:44.657

有时，使用重载对不同的行为进行建模会更简单。继续您的示例将是：

```
file.appendData( data );  
file.overwriteData( data ); 
```

如果您有多个参数，则此方法会降级，每个参数都允许一组固定的选项。例如，打开文件的方法可能有文件模式（打开/创建）、文件访问（读/写）、共享模式（无/读/写）的几种排列。配置的总数等于各个选项的笛卡尔积。当然，在这种情况下，多重重载是不合适的。

在某些情况下，枚举可以使代码更具可读性，尽管在某些语言（例如 C#）中验证确切的枚举值可能很困难。

通常，布尔参数作为新的重载附加到参数列表中。.NET 中的一个示例是：

```
Enum.Parse(str);  
Enum.Parse(str, true); // ignore case 
```

后一个重载在比第一个更高版本的 .NET 框架中可用。

如果您知道只有两种选择，那么布尔值可能就可以了。枚举可以以不会破坏旧代码的方式进行扩展，尽管旧库可能不支持新的枚举值，因此不能完全忽略版本控制。

* * *

**编辑**

在较新版本的 C# 中，可以使用命名参数，IMO 可以像枚举一样使调用代码更清晰。使用与上面相同的示例：

```
Enum.Parse(str, ignoreCase: true); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-05-18T13:23:49.533

我确实同意枚举是一个很好的方法，在你有 2 个选项的方法中（只有两个选项你可以在没有枚举的情况下获得可读性。）

例如

```
public void writeData(Stream data, boolean is_overwrite) 
```

喜欢枚举，但布尔值也很有用。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-06-02T12:46:30.673

这是一篇旧帖子的后期条目，它位于页面下方以至于没有人会阅读它，但是因为没有人已经说过......

内联注释对解决意外`bool`问题大有帮助。最初的例子特别令人发指：想象一下试图在函数 declearation 中命名变量！会是这样的

```
void writeData( DataObject data, bool use_append_mode ); 
```

但是，为了举例，假设那是声明。然后，对于一个无法解释的布尔参数，我将变量名放在一个内联注释中。比较

```
file.writeData( data, true ); 
```

和

```
file.writeData( data, true /* use_append_mode */); 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2008-09-25T22:24:48.470

这实际上取决于论点的确切性质。如果它不是是/否或真/假，则枚举使其更具可读性。但是对于枚举，您需要检查参数或具有可接受的默认行为，因为可以传递基础类型的未定义值。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2008-09-26T01:39:35.960

在您的示例中使用枚举而不是布尔值确实有助于使方法调用更具可读性。但是，这可以替代我最喜欢的 C# 中的愿望项，即方法调用中的命名参数。这个语法：

```
var v = CallMethod(pData = data, pFileMode = WriteMode, pIsDirty = true); 
```

将是完全可读的，然后您可以做程序员应该做的事情，即为方法中的每个参数选择最合适的类型，而不考虑它在 IDE 中的外观。

C# 3.0 允许在构造函数中使用命名参数。我不知道为什么他们也不能用方法来做到这一点。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2010-03-26T18:39:19.370

布尔值`true`/`false`仅。所以不清楚它代表什么。`Enum`可以有有意义的名称，例如`OVERWRITE`,`APPEND`等。所以枚举更好。

# apache - 如何使用 apache 提供脚本而不是运行它？

> ID：135849
> 
> 赞同：1
> 
> 时间：2008-09-25T20:32:04.780
> 
> 标签：apache, server-configuration

我正在尝试使用 apache Web 服务器托管 python 脚本，但服务器尝试运行该脚本，而不是仅仅提供它以供下载。

我没有直接访问服务器的权限，并添加了该行

```
AddType text/plain .py 
```

到根文件夹中的 .htaccess 似乎不起作用，尽管我可能做错了什么。

如何让服务器仅将文件作为文本发送而不是尝试运行它？

-编辑

更改名称不起作用。Script.py.safe 在单击时仍然会给出 500 Server 错误。

我还应该提到 .htaccess 文件确实有效，但由于某种原因，一个 addType 行不起作用。要么是因为它没有覆盖某些东西，要么是这条线是错误的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T20:34:39.827

如果您不能更改 Apache 配置并且不能用 htaccess 文件覆盖它，那么在我看来，最简单的解决方案是更改文件扩展名，或者编写一个打印内容的脚本目标脚本。

两者在某种程度上都是 hack，但正确的解决方案是更改 Apache 配置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T20:38:23.173

在您的 .htaccess 中：

> 删除处理程序.py

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T20:35:04.460

一种选择是更改扩展名并明确应将其重命名。即 python.py.safe 或 python.py.dl。然后用户需要移除额外的位。

你也可以把它拉起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:37:33.690

我会写一些东西来加载 python 脚本。这样你甚至可以变得精力充沛，并包括代码的格式和样式。您甚至可以用 python 编写它，因为您不会通过文件扩展名排除它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:37:53.003

```
<IfModule mime_module>
    <Files *.py>
        ForceType text/plain
    </Files>
</IfModule> 
```

在文件夹的 .htaccess 中应该可以工作；）

# javascript - 缩放元素及其内容——CSS3 的缩放属性的替代方法？

> ID：135894
> 
> 赞同：2
> 
> 时间：2008-09-25T20:38:18.447
> 
> 标签：javascript, html, css, zooming

是否有跨浏览器方法来模拟[CSS3 的缩放属性](http://www.css3.com/css-zoom/)？我知道如何分别缩放图像和文本，但似乎无法保持所有内容对齐。

一种解决方案可能是读取元素及其子元素的计算样式，将所有度量转换为 px，将它们乘以某个因子，然后使用这些新样式生成 HTML/CSS。另一个解决方案实际上可能是有意义的。:)

重要提示：正确的解决方案不假设它所作用的页面。我们不知道每个元素的大小都以 px 为单位，由外部样式表设置样式或其他任何内容。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T21:00:29.063

您可以尝试使用提供[Effect.Scale](http://github.com/madrobby/scriptaculous/wikis/effect-scale)功能的[Scriptaculous库。](http://script.aculo.us/)

# assembly - 我在哪里可以找到 *all* MIPS 指令的描述

> ID：135896
> 
> 赞同：14
> 
> 时间：2008-09-25T20:38:31.753
> 
> 标签：assembly, mips, instruction-set, mips32

有谁知道一个网站，我可以在其中找到 32 位 MIPS 指令/操作码列表，具有以下功能：

*   清楚地区分真正的操作码和汇编语言宏（伪指令）
*   描述指令行为，包括取决于特权级别的差异。
*   指示在哪个指令集修订版中引入/修订了指令（例如 MIPS I、MIPS II、MIPS32 等）
*   包括特权指令，例如系统调用。

我知道有许多网站记录了指令集的“一部分”，主要用于教学目的。他们倾向于省略或仅部分描述浮点和特权指令。

如果您想知道，我正在查看 MIPS 处理器子集的 Verilog 代码，并试图弄清楚它在多大程度上符合任何真正的 MIPS 处理器的指令集！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T21:34:31.430

好的，我发现了一些东西！

MIPS 提供了一套“MIPS 32 参考手册”，参考了最新的标准化指令集 (MIPS32v2)：[这里](http://www.mips.com/products/product-materials/processor/mips-architecture/)

这些包括几乎所有内容，除了关于指令起源于哪个版本的信息:-(

等一下...

[康奈尔的这个课程网站](http://www.cs.cornell.edu/courses/cs3410/2008fa/)包含**看似**相同的手册的链接，但实际上是*它的旧版本*，并且该旧版本的[第 2 卷](http://www.cs.cornell.edu/courses/cs3410/2008fa/MIPS_Vol2.pdf)实际上包含有关何时首次引入说明的信息。呜呼！

为什么 MIPS 会从修订后的文档中删除这些信息？修订历史中似乎没有任何解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T21:04:52.440

我只能部分回答这个问题：如果您还没有提到它，我推荐[See MIPS Run by Dominic Sweetman。](https://rads.stackoverflow.com/amzn/click/com/0120884216)我有这本书的第一版，现在是第二版。

*   表 8.2 列出了每个操作码和预期行为，区分了汇编器宏并列出了它们分解成的指令。不幸的是，它没有区分用户模式和内核模式。
*   表 8.6 列出了引入每条指令的 ISA 级别，包括 LSI MiniRISC 等晦涩的变体
*   系统调用存在于表中，但缺乏太多描述

第一版提到了内核。主管和用户权限级别，但没有讨论每个权限级别允许哪些操作。我不知道第二版做了什么改动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T21:15:21.510

不包括指令描述，但 GNU 汇编器的源代码可能与您可以获得的关于在哪些特定 CPU 上可用的指令一样详细。

获取[binutils](http://ftp.gnu.org/gnu/binutils)并查看 opcodes/mips-*.c

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-22T10:43:26.237

当前的指令集参考手册可在线免费获取：[MIPS® Architecture for Programmers Volume II-A: The MIPS32® Instruction Set Manual](https://s3-eu-west-1.amazonaws.com/downloads-mips/documents/MD00086-2B-MIPS32BIS-AFP-6.06.pdf)。该链接是 2016 年 12 月 15 日修订版 6.06。（即它记录了[MIPS32 Release 6](https://en.wikipedia.org/wiki/MIPS_architecture#MIPS32.2FMIPS64_Release_6)）。

它记录了所有用户和主管/内核模式指令，以及所有浮点，包括它们的机器代码编码在内的全部细节，并带有一个显示它们做什么的操作部分。它仍然记录了在 MIPS32 第 6 版中删除的所有指令。（MIPS32 第 6 版也移动了很多操作码，这有据可查）。

* * *

有关最新版本，请参阅[https://www.mips.com/products/architectures/mips32/](https://www.mips.com/products/architectures/mips32/)。mips.com 有一个“经典内核”部分，但这似乎仍然只能追溯到 MIPS32，而不是历史的东西。

* * *

`balc`（Branch and Link Compact：无分支延迟槽，GRP31 是隐式目的地，为 an 释放 26 位）的“可用性和兼容性”部分的示例`offset<<2`：

> 此指令由第 6 版引入并要求。第 6 版指令`BALC`占用与第 6 版之前的指令相同的编码`SWC2`。该`SWC2`指令已移至`COP2` MIPS 版本 6 中的主要操作码

或 for `LDXC1 fd, index(base)` （加载索引为浮点的双字）

> 此指令已在版本 6 中删除。自 MIPS64 版本 1 以来的所有 MIPS64 版本都需要此指令。在 MIPS32 版本 1 中不可用。在 MIPS32 版本 2 和所有后续版本的 MIPS32 中都需要。需要时，只要存在 FPU，无论是 32 位还是 64 位 FPU，无论是处于 32 位还是 64 位 FP 寄存器模式（FIRF64=0 或 1，StatusFR=0 或 1），都需要。

* * *

**对于历史资料，我**在 cmu.edu 网页上找到了**[1995 年 9 月的 MIPS IV 指令集修订版 3.2 。](http://www.cs.cmu.edu/afs/cs/academic/class/15740-f97/public/doc/mips-isa.pdf)**它列出了何时引入指令，例如 MIPS I 用于`div`， MIPS III 用于`dmult`和其他 64 位指令， MIPS II 用于`ll`/ `sc`。

* * *

**每个指令效果的**伪代码快速参考是**[https://inst.eecs.berkeley.edu/~cs61c/resources/MIPS_help.html](https://inst.eecs.berkeley.edu/%7Ecs61c/resources/MIPS_help.html)。它不包括编码细节，但确实准确地描述了分支和跳转指令对程序计数器的影响。（这有点棘手：它们与分支延迟槽相对或绝对绝对。）**

 **但是，即使对于 MIPS I 整数指令，它也不完整：它缺少 MIPS I 中存在的未对齐加载辅助指令 LWL 和 LWR 以及相应的 SWL/R 存储。它也不包括任何 FP 内容或更高版本的 MIPS 指令喜欢`mul`（仅`mult`）。我不知道还有什么可能会丢失；我没有对照完整列表交叉引用它。

上面链接的 MIPS-IV 手册确认`lwl`/`lwr`在 MIPS I 中可用（并记录了加载延迟槽限制适用于它们）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T21:23:20.337

该[网站 (archive.org)](https://web.archive.org/web/20201111203150/http://www.mrc.uidaho.edu/mrc/people/jff/digital/MIPSir.html)描述了大多数 MIPS 指令集及其编码。但是，它并不完整：至少`nor`还缺少其他东西。

每个指令效果的伪代码快速参考是[https://inst.eecs.berkeley.edu/~cs61c/resources/MIPS_help.html](https://inst.eecs.berkeley.edu/%7Ecs61c/resources/MIPS_help.html)。它不包括编码细节。

[MIPS](http://www.mips.com/products/processors/32-64-bit-cores/mips32-4ke/index.cfm#resources)网站也有关于各种内核的技术文档。
例如，我下载了 MIPS 4KE 内核的手册（文档 #MD00103）“MIPS32® 4KE™ 处理器内核系列软件用户手册”，第 10 章包含指令集的详细说明。请注意，您必须注册才能访问这些文件。

# algorithm - 将弧度转换为度数的方法是什么？

> ID：135909
> 
> 赞同：165
> 
> 时间：2008-09-25T20:40:52.637
> 
> 标签：algorithm, math, trigonometry

我偶尔会遇到这种情况，总是忘记如何去做。

经常出现的那些事情之一。

另外，将以弧度表示的角度转换为度数并再次转换回来的公式是什么？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2008-09-25T20:43:58.683

```
radians = degrees * (pi/180)

degrees = radians * (180/pi) 
```

至于实现，主要问题是您希望 pi 的值有多精确。[这里](https://stackoverflow.com/questions/19/fastest-way-to-get-value-of-pi)有一些相关的讨论

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-25T20:44:06.530

一个完整的弧度圆是 2*pi。一个完整的圆度数是 360。从度数到弧度，它是 (d/360) * 2*pi 或 d*pi/180。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-25T20:43:39.137

x 弧度以度为单位 - > x*180/pi
x 度以弧度 -> x*pi/180

我想如果你想为此 [in PHP] 创建一个函数：

```
function convert($type, $num) {
    if ($type == "rads") {
          $result = $num*180/pi();
        }

    if ($type == "degs") {
          $result = $num*pi()/180;
        }

    return $result;
  } 
```

是的，这可能会写得更好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-06-15T07:40:00.320

在javascript中你可以这样做

```
radians = degrees * (Math.PI/180);

degrees = radians * (180/Math.PI); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-01T04:35:38.223

这对我来说足够好:)

```
// deg2rad * degrees = radians
#define deg2rad (3.14159265/180.0)
// rad2deg * radians = degrees
#define rad2deg (180/3.14159265) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T20:43:14.940

180 度 = PI * 弧度

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T20:43:59.820

360 度是 2*PI 弧度

您可以在以下位置找到转换公式：[http](http://en.wikipedia.org/wiki/Radian#Conversion_between_radians_and_degrees) ://en.wikipedia.org/wiki/Radian#Conversion_between_radians_and_degrees 。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T20:44:01.770

360 度 = 2*pi 弧度

这意味着 deg2rad(x) = x*pi/180 和 rad2deg(x) = 180x/pi；

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T20:44:18.230

pi 弧度 = 180 度

所以 1 度 = pi/180 弧度

或 1 弧度 = 180/pi 度

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-14T15:09:23.197

对于 c# 中的 double，这可能会有所帮助：

```
 public static double Conv_DegreesToRadians(this double degrees)
        {
            //return degrees * (Math.PI / 180d);
            return degrees * 0.017453292519943295d;
        }
        public static double Conv_RadiansToDegrees(this double radians)
        {
            //return radians * (180d / Math.PI);
            return radians * 57.295779513082323d;
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-07T07:33:29.467

下面是一些用 扩展 Object 的代码`rad(deg)`，`deg(rad)`还有两个更有用的函数：一个点需要有一个and`getAngle(point1,point2)`属性。`getDistance(point1,point2)``x``y`

```
Object.prototype.rad = (deg) => Math.PI/180 * deg;
Object.prototype.deg = (rad) => 180/Math.PI * rad;
Object.prototype.getAngle = (point1, point2) => Math.atan2(point1.y - point2.y, point1.x - point2.x);
Object.prototype.getDistance = (point1, point2) => Math.sqrt(Math.pow(point1.x-point2.x, 2) + Math.pow(point1.y-point2.y, 2)); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-25T20:44:24.140

```
radians = (degrees/360) * 2 * pi 
```

# java - java.net.SocketException：软件导致连接中止：recv 失败

> ID：135919
> 
> 赞同：88
> 
> 时间：2008-09-25T20:43:00.277
> 
> 标签：java, sockets

对于以下错误的确切含义，我无法找到适当的答案：

`java.net.SocketException: Software caused connection abort: recv failed`

笔记：

*   此错误不常见且不可预测；虽然得到这个错误意味着所有未来的 URI 请求也将失败。
*   唯一可行的解​​决方案（也只是偶尔）是重新启动 Tomcat 和/或实际机器（在本例中为 Windows）。
*   URI 绝对可用（通过要求浏览器进行获取来确认）。

相关代码：

```
BufferedReader reader;
try { 
 URL url = new URL(URI);
 reader = new BufferedReader(new InputStreamReader(url.openStream())));
} catch( MalformedURLException e ) { 
 throw new IOException("Expecting a well-formed URL: " + e); 
}//end try: Have a stream

String buffer;
StringBuilder result = new StringBuilder();
while( null != (buffer = reader.readLine()) ) { 
 result.append(buffer); 
}//end while: Got the contents.
reader.close(); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-25T20:50:21.617

这通常意味着存在网络错误，例如 TCP 超时。我会首先在连接上放置一个嗅探器（wireshark），看看你是否能看到任何问题。如果有 TCP 错误，您应该能够看到它。此外，如果适用，您可以检查您的路由器日志。如果在任何地方都涉及无线，那是此类错误的另一个来源。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-04-22T12:53:03.160

如果您的 TLS 客户端无法通过配置为需要客户端身份验证的服务器进行身份验证，也会发生这种情况。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-03-28T21:30:25.160

当连接突然关闭时会发生此错误（当 TCP 连接重置而发送缓冲区中仍有数据时）。这种情况与更常见的“对等连接重置”非常相似。当通过 Internet 连接时，它可能会偶尔发生，但如果时机合适，也会系统地发生（例如，在 localhost 上使用保持活动连接）。

HTTP 客户端应该重新打开连接并重试请求。重要的是要了解，当连接处于这种状态时，除了关闭它之外别无他法。任何发送或接收的尝试都会产生相同的错误。

不要使用，使用具有重试机制、连接池、保持活动和许多其他功能的`URL.open()`Apache-Commons [HttpClient 。](https://hc.apache.org/httpcomponents-client-ga/)

示例用法：

```
HttpClient httpClient = HttpClients.custom()
            .setConnectionTimeToLive(20, TimeUnit.SECONDS)
            .setMaxConnTotal(400).setMaxConnPerRoute(400)
            .setDefaultRequestConfig(RequestConfig.custom()
                    .setSocketTimeout(30000).setConnectTimeout(5000).build())
            .setRetryHandler(new DefaultHttpRequestRetryHandler(5, true))
            .build();
// the httpClient should be re-used because it is pooled and thread-safe.

HttpGet request = new HttpGet(uri);
HttpResponse response = httpClient.execute(request);
reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
// handle response ... 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T20:49:26.360

你在访问http数据吗？您可以使用 HttpClient 库而不是标准库吗？该库有更多选项，并将提供更好的错误消息。

[http://hc.apache.org/httpclient-3.x/](http://hc.apache.org/httpclient-3.x/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T20:49:56.063

我唯一一次看到这样的事情发生是当我有一个坏的连接，或者当有人从不同的线程上下文中关闭我正在使用的套接字时。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-28T06:54:00.053

尝试将 'autoReconnect=true' 添加到 jdbc 连接字符串

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-20T12:32:40.320

当连接超时或远程主机终止其连接（关闭的应用程序、计算机关闭等）时，会不时发生这种情况。您可以通过自己管理套接字并通过其通信协议处理应用程序中的断开连接，然后调用`shutdownInput`并`shutdownOutput`清除会话来避免这种情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-24T14:59:30.713

查看是否有其他服务或程序在 http 端口上运行。当我尝试使用该端口并被另一个程序占用时，它发生在我身上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-11T11:15:18.150

如果您使用 Netbeans 管理 Tomcat，请尝试在 Tools - Servers 中禁用 HTTP 监视器

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-25T05:55:06.210

我也有这个问题。我的解决方案是：

```
sc.setSoLinger(true, 10); 
```

从网站复制 --> 通过使用该`setSoLinger()`方法，您可以在发送复位之前显式设置延迟，从而为读取或发送数据提供更多时间。

也许这不是每个人的答案，而是某些人的答案。

# sql-server - 你能在你的 SQL if 语句块中只做一个评论吗？

> ID：135929
> 
> 赞同：3
> 
> 时间：2008-09-25T20:43:55.360
> 
> 标签：sql-server, tsql

我想在我的 if 语句块中添加评论，但是当我尝试时出现错误。我想更像史蒂夫麦康奈尔。

```
declare @ConstraintName varchar(255)
set @ConstraintName = 'PK_Whatever'

IF LEFT(@ConstraintName, 2) = 'PK'
BEGIN
    --can't drop primary keys
END 
```

我得到的错误是：

```
Incorrect syntax near 'END'. 
```

如果我在评论之后添加一些东西，即`PRINT @ConstraintName`，它工作正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T20:52:23.437

不，你不能有一个空的 if 块（或一个只包含评论的块）。

你没有说你为什么想要这个。如果你只是想注释掉 if 的内容进行调试，你应该注释整个 if。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-26T17:59:52.957

`SELECT NULL`将生成结果集并可能影响客户端应用程序。做一些没有效果的事情似乎更好，比如：

```
IF LEFT(@ConstraintName, 2) = 'PK'
BEGIN
  DECLARE @Dummy bit -- Do nothing here, but this is required to compile
END 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T20:46:45.540

在 SQL Server 中我不能肯定地说，但在 Oracle PL/SQL 中，您可以将 NULL 语句放在您不想执行任何操作的块中：

```
BEGIN
  -- This is a comment
  NULL;
END 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-05T15:14:30.157

这里的好提示：[如何在 SQL Server 中什么都不做](https://stackoverflow.com/questions/6954336/how-to-do-nothing-in-sql-server)

```
BEGIN
  DONOTHING:
END 
```

所以你只是在定义一个标签。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T20:54:25.210

不，我不认为你可以。如果您想暂时将其注释掉，您可能只需要在整个语句周围放一个 /* ... */ 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T21:25:35.227

这不是评论。那是你有一个空的 if 块。你必须在那里至少有一个声明。放入打印声明可能是您最好的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T12:33:03.367

因为你不能有一个“空”块（感谢查尔斯格雷厄姆），我将在 if 语句上方放置一个评论以说明条件的意图（感谢 BlackWasp），然后在 begin..end 中发表评论描述虚拟声明的块（感谢 GiLM）。

你认为这是我应该如何评论代码吗？

```
declare @ConstraintName varchar(255)
set @ConstraintName = 'PK_Whatever'

--can't drop primary keys
IF LEFT(@ConstraintName, 2) = 'PK'
BEGIN
    --do nothing here
    DECLARE @Dummy bit --required to compile
END 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T16:15:39.527

围绕您希望放弃约束的项目设计 SQL 语句不是更好吗？因此，如果您想删除此功能，那么

```
If left(@constraintname,2 <> 'PK'
BEGIN
     -- Drop your constraint here
     ALTER TABLE dbo.mytable DROP constraint ... -- etc
END 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-31T00:37:01.723

我知道它不能回答你最初的问题，即你是否可以在一个块内只放置一个评论，但为什么不反转你的条件，所以该块只在 <> 'PK' 时执行？

```
-- drop only if not primary
IF LEFT (@ConstraintName, 2) <> 'PK'
BEGIN
    --do something here
END 
```

# sql-server - 在Sql Server中存储未指定长度的字符串的策略？

> ID：135933
> 
> 赞同：1
> 
> 时间：2008-09-25T20:44:03.847
> 
> 标签：sql-server

因此，一列将包含一些文本，事先我不知道该字符串的长度可以有多长。实际上 95% 的时间，它可能在 100-500 个字符之间，但也有可能是 10000 个字符长。我无法控制此字符串的大小，用户也无法控制。除了 varchar(max)，你们还发现了哪些其他有用的策略？还有什么是 varchar(max) 的缺点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T20:45:14.280

我使用的是 sqlserver 2005 中的 Varchar(max)。

SqlServer 奇怪地处理大型字符串字段，因为如果您指定“文本”或大型 varchar，但不是最大值，它会将部分位存储在记录中，其余位存储在外部。

据我所知，使用 varchar(max) 它会继续并将整个内容存储在记录之外，这使得它的效率低于小文本输入。但它比“文本”字段更有效，因为它不必通过内联部分和指针的其余部分来查找该信息 2 次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T20:53:57.050

一种不优雅但有效的方法是在表中设置两列，一列是足够大的 varchar 以涵盖大多数情况，另一列是 CLOB/TEXT 类型来存储异常大的列。插入/更新时，您可以获得字符串的大小，并将其存储在适当的列中。

就像我说的那样，不漂亮，但它会给你 varchar 在大多数情况下的性能，而当你有更大的值时不会中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:48:10.810

您是否考虑过使用 BLOB 类型？

另外，出于好奇，您是否不控制字符串的大小，用户也不控制，谁来控制？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T20:50:02.303

nvarchar(max) 绝对是您最好的选择 - 因为我相信您知道它只会分配您实际每行存储的数据所需的空间，而不是每行数据类型的实际最大值。

我会看到的唯一问题是，如果您不断更新一行并且它经常从小于 8000 字节切换到大于 8000 字节，在这种情况下，SQL 会将存储更改为 LOB，并在您离开时存储指向数据的指针超过 8000 字节。在这种情况下，来回更改会很昂贵，但是在这种情况下，我真的没有任何其他选择 - 所以这是一个有争议的问题。

# windows-mobile - 如何从 WinMO6 的 Aygshell.dll 调用函数 SHCameraCapture（相机对话框）

> ID：135934
> 
> 赞同：1
> 
> 时间：2008-09-25T20:44:05.763
> 
> 标签：windows-mobile, pinvoke, camera

我需要通过从 dll Aygshell.dll 中调用 SHCameraCapture 来在紧凑的框架 3.7 应用程序中显示相机捕捉对话框。由于我正在使用的技术的限制，我无法使用托管对象 CameraCaptureDialog。相反，我需要通过 Pinvoking 来访问它。

有关该功能的文档，请参阅[http://msdn.microsoft.com/en-us/library/aa454995.aspx](http://msdn.microsoft.com/en-us/library/aa454995.aspx)。该函数接受一个定义对话框参数的结构。例如在哪里保存文件，使用什么分辨率。

我会想象我必须在 C# 中定义结构的副本并使用属性 StructLayout 装饰结构。我还想象代码将涉及 [DllImport("aygshell.dll")]。任何有关如何调用它的示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T17:48:01.793

此代码有效....

```
#region Enumerations

public enum CAMERACAPTURE_STILLQUALITY
{
    CAMERACAPTURE_STILLQUALITY_DEFAULT = 0,
    CAMERACAPTURE_STILLQUALITY_LOW = 1,
    CAMERACAPTURE_STILLQUALITY_NORMAL = 2,
    CAMERACAPTURE_STILLQUALITY_HIGH = 3
}
public enum CAMERACAPTURE_VIDEOTYPES
{
    CAMERACAPTURE_VIDEOTYPE_ALL = 0xFFFF,
    CAMERACAPTURE_VIDEOTYPE_STANDARD = 1,
    CAMERACAPTURE_VIDEOTYPE_MESSAGING = 2
}

public enum CAMERACAPTURE_MODE
{
    CAMERACAPTURE_MODE_STILL = 0,
    CAMERACAPTURE_MODE_VIDEOONLY = 1,
    CAMERACAPTURE_MODE_VIDEOWITHAUDIO = 2
}

#endregion //Enumerations

#region Structures

[StructLayout(LayoutKind.Sequential,CharSet=CharSet.Unicode)]
public struct struSHCAMERACAPTURE
{
    public uint cbSize;
    public IntPtr hwndOwner;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
    public String szFile;
    [MarshalAs(UnmanagedType.LPTStr)]
    public String pszInitialDir; //LPCTSTR
    [MarshalAs(UnmanagedType.LPTStr)]
    public String pszDefaultFileName; //LPCTSTR
    [MarshalAs(UnmanagedType.LPTStr)]
    public String pszTitle;  //LPCTSTR
    public CAMERACAPTURE_STILLQUALITY StillQuality;
    public CAMERACAPTURE_VIDEOTYPES VideoTypes;
    public uint nResolutionWidth;
    public uint nResolutionHeight;
    public uint nVideoTimeLimit;
    public CAMERACAPTURE_MODE Mode;
}
#endregion //Structures

#region API
[DllImport("Aygshell.dll", SetLastError = true,CharSet=CharSet.Unicode)]
public static extern int SHCameraCapture
(
    ref struSHCAMERACAPTURE pshCamCapture
);

private string StartImager(String strImgDir, String strImgFile, uint uintImgHeight,
                            uint uintImgWidth)

try
{
  struSHCAMERACAPTURE shCamCapture = new struSHCAMERACAPTURE();

  shCamCapture.cbSize = (uint)Marshal.SizeOf(shCamCapture);
  shCamCapture.hwndOwner = IntPtr.Zero;
  shCamCapture.szFile = "\\" + strImgFile;  //strImgDir + "\\" + strImgFile;
  shCamCapture.pszInitialDir = "\\"; // strImgDir;
  shCamCapture.pszDefaultFileName = strImgFile;
  shCamCapture.pszTitle = "PTT Image Capture";
  shCamCapture.StillQuality = 0; // CAMERACAPTURE_STILLQUALITY.CAMERACAPTURE_STILLQUALITY_NORMAL;
  shCamCapture.VideoTypes = CAMERACAPTURE_VIDEOTYPES.CAMERACAPTURE_VIDEOTYPE_STANDARD;
  shCamCapture.nResolutionHeight = 0; // uintImgHeight;
  shCamCapture.nResolutionWidth = 0; // uintImgWidth;
  shCamCapture.nVideoTimeLimit = 10;
  shCamCapture.Mode = 0; // CAMERACAPTURE_MODE.CAMERACAPTURE_MODE_STILL;

  //IntPtr intptrCamCaptr = IntPtr.Zero;

  //Marshal.StructureToPtr(shCamCapture, intptrCamCaptr, true);

  int intResult = SHCameraCapture(ref shCamCapture);
  if (intResult != 0)
  {
      Win32Exception Win32 = new Win32Exception(intResult);
      MessageBox.Show("Error: " + Win32.Message);
  }             

  return strCaptrErr;
}

catch (Exception ex)
{
    MessageBox.Show("Error StartImager : " + ex.ToString() + " - " + strCaptrErr
                    , "Nomad Imager Test");
    return "";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T15:35:52.493

Groky，这是一个好的开始...感谢您开始。我尝试将其连接起来，但得到了 NotSupportedException。

我已经粘贴了下面我的测试应用程序中的文本。请注意，我尝试使用 [StructLayout(LayoutKind.Sequential)] 装饰结构。我还公开了所有成员，以消除对象可访问性的任何问题。

```
public partial class Form1 : Form
{
    [DllImport("aygshell.dll")]
    static extern int SHCameraCapture(ref SHCAMERACAPTURE pshcc);

    [StructLayout(LayoutKind.Sequential)]
    struct SHCAMERACAPTURE
    {
        public Int32 cbSize;
        public IntPtr hwndOwner;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
        public string szFile;
        [MarshalAs(UnmanagedType.LPStr)]
        public string pszInitialDir;
        [MarshalAs(UnmanagedType.LPStr)]
        public string pszDefaultFileName;
        [MarshalAs(UnmanagedType.LPStr)]
        public string pszTitle;
        public Int32 StillQuality;
        public Int32 VideoTypes;
        public Int32 nResolutionWidth;
        public Int32 nResolutionHeight;
        public Int32 nVideoTimeLimit;
        public Int32 Mode;
    }
    private void ShowCamera()
    {
        SHCAMERACAPTURE captureData = new SHCAMERACAPTURE
                                           {
                                               cbSize = sizeof (Int64),
                                               hwndOwner = (IntPtr)0,
                                               szFile = "\\My Documents",
                                               pszDefaultFileName = "picture.jpg",
                                               pszTitle = "Camera Demo",
                                               StillQuality = 0,
                                               VideoTypes = 1,
                                               nResolutionWidth = 480,
                                               nResolutionHeight = 640,
                                               nVideoTimeLimit = 0,
                                               Mode = 0
                                           };
        SHCameraCapture(ref captureData);
    }
    private void button1_Click(object sender, EventArgs e)
    {
        ShowCamera();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T09:08:11.263

我无法对此进行测试，但您的结构/函数应该如下所示：

```
struct SHCAMERACAPTURE {
  public Int32 cbSize;
  public IntPtr hwndOwner;

  [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]  
  public string szFile;

  [MarshalAs(UnmanagedType.LPStr)] 
  string pszInitialDir;

  [MarshalAs(UnmanagedType.LPStr)] 
  string pszDefaultFileName;

  [MarshalAs(UnmanagedType.LPStr)] 
  string pszTitle;

  Int32 StillQuality;
  Int32 VideoTypes;
  Int32 nResolutionWidth;
  Int32 nResolutionHeight;
  Int32 nVideoTimeLimit;
  Int32 Mode;
}

[DllImport("aygshell.dll")]
static extern int SHCameraCapture(ref SHCAMERACAPTURE pshcc); 
```

AFAIK，您不需要在 SHCAMERCAPTURE 上显式设置 StructLayout，因为它的布局没有什么不寻常的。

一旦你得到这个工作，你可能想将你的发现发布到 pinvoke.net 以供其他人使用！

# actionscript-3 - Flash：使用一个事件监听器监听一个类型的所有事件

> ID：135938
> 
> 赞同：3
> 
> 时间：2008-09-25T20:44:18.993
> 
> 标签：actionscript-3, events

这不是生死攸关的问题，但我想知道这是否可能：

我从一种类型的自定义事件 (FormEvent) 中得到了几个事件，现在我得到了一个 FormListener，它监听所有这些事件并根据事件类型处理它们。我希望一次添加所有事件，而不是一次添加一个 eventListener。

所以现在看起来像这样：

```
 private function addListeners():void {

        addEventListener(FormEvent.SHOW_FORM, formListener);
        addEventListener(FormEvent.SEND_FORM, formListener);
        addEventListener(FormEvent.CANCEL_FORM, formListener);
    }

        private function formListener(event:formEvent):void {

        switch(event.type){
            case "show.form": 
                // handle show form stuff
            break;
            case "send.form":
                // handle send form stuff
            break;
            case "cancel.form":
                // handle cancel form stuff
            break;
        }
    } 
```

但不是每次都添加一个事件，我宁愿做类似的事情

```
 private function addListeners():void {

        addEventListener(FormEvent.*, formListener);
    } 
```

我想知道这样的事情是否可能，我会喜欢的。我处理大量事件:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-26T02:32:35.630

无论如何，在这种情况下，您实际上只需要一个事件侦听器。该侦听器将侦听表单的任何更改，并且与更改内容相等的参数可用于事件侦听器函数。我将向您展示，但请记住，这是一种伪情况，通常我不会从方法调用这样简单的事情中分派事件，因为分派是隐含的，因此没有真正需要监听它。

首先是自定义事件

```
 package com.yourDomain.events
{
    import flash.events.Event;
    public class FormEvent extends Event
    {
        //Public Properties
        public static const CANCEL_FORM:int = "0";
        public static const SHOW_FORM:int = "1";
        public static const SEND_FORM:int = "2";

        public static const STATE_CHANGED:String = "stateChanged";

        //Private Properties
        private var formState:int;

        public function FormEvent(formState:int):void
        {
            super(STATE_CHANGED);
            formState = formState;
        }
    }
} 

```

因此，我们刚刚创建了自定义事件类，并且我们已经对其进行了设置，以便我们可以通过侦听器函数捕获状态，正如我将演示一旦完成将调度所述自定义事件的伪表单类。

请记住，这都是假设的，因为我不知道您的代码是什么样子或您如何实现的。重要的是要注意，当我调度事件时，我需要发送一个反映新状态的参数。

```
 package com.yourDomain.ui
{
   import flash.events.Event;
   import flash.events.EventDispatcher;
   import com.yourDomain.events.FormEvent;
   public class Form extends EventDispatcher
   {
     public function Form():void
     {
        //Anything you want form to do upon instantiation goes here.
     }
     public function cancelForm():void
     {
        dispatchEvent(new Event(FormEvent.CANCEL_FORM);
     }
     public function showForm():void
     {
        dispatchEvent(new Event(FormEvent.SHOW_FORM);
     }
     public function sendForm():void
     {
        dispatchEvent(new Event(FormEvent.SEND_FORM);
     }
   }
} 

```

最后，我们创建将监听它的文档类。请知道，我意识到创建一个在调用类的方法时触发的侦听器是不合逻辑的，因为您显然知道您调用了该方法，但对于这个示例，它会到期。

```
 package com.yourDomain.ui
{
   import com.yourDomain.ui.Form;
   import com.yourDomain.events.FormEvent;
   //Form is in the same package so we need not import it.
   public class MainDocumentClass
   {
      private var _theForm:Form;

      public function MainDocumentClass():void
      {
         _theForm  = new Form();
         _theForm.addEventListener(FormEvent.STATE_CHANGED, onFormStateChange, false, 0, true);
         /*
         The following three method calls each cause the
         FormEvent.STATE_CHANGE event to be dispatched.  
         onFormStateChange is notified and checks what 
         the last change actually was.
         */
         _theForm.cancelForm();
         _theForm.showForm();
         _theForm.sendForm();
      }
      private function onFormStateChange(e:FormEvent):void
      {
         switch(e.formState)
         {
            case CANCEL_FORM:
              trace('The form was canceled');
              break;
            case SHOW_FORM:
              trace('The form was revealed');
              break;
            case SEND_FORM:
              trace('The form was sent');
              break;
         }
      }
   }      
} 

```

我希望这是有帮助的，它已经晚了，我可能需要稍后修改一些东西，但这应该有助于了解如何制作自己的事件并自定义事情的工作方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T21:27:39.577

我不知道有任何例程可以让您直接执行此操作，但您可以编写自己的例程。这里的语法并不完美，但这是第一遍：

```
private function addMultipleEventListeners( evts:Array, callback:function ):void
{
    for each( var evt:Event in evts )
    {
        addEventListener( evt, callback );
    }
} 
```

然后，您可以像这样调用该例程：

```
var evts:Array = [ FormEvent.SHOW_FORM, FormEvent.SEND_FORM, FormEvent.CANCEL_FORM ];
addMultipleEventListeners( evts, formListener ); 
```

# obfuscation - 加密源代码

> ID：135943
> 
> 赞同：5
> 
> 时间：2008-09-25T20:44:33.063
> 
> 标签：obfuscation, encrypting-file-system

我处理相对敏感的代码，我们不希望落入坏人之手。到目前为止，所有代码都保存在内部，所以这不是问题。我每周有一两天要在家工作，我们想保护我笔记本电脑上的代码。

我们已经查看了一些替代方案，但 Windows EFS 和 Bitlocker 似乎是最明显的。笔记本电脑没有 TPM 硬件，而且我无法从家里访问 Active Directory，因此 EFS 看起来是一种选择。

基本上，有没有其他人有任何替代方案，或者使用 EFS 加密源代码的问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-25T20:47:07.723

[真加密](http://www.truecrypt.org/downloads.php)：

> **警告：使用 TrueCrypt 并不安全，因为它可能包含未修复的安全问题**
> 
> 此页面仅用于帮助迁移由 TrueCrypt 加密的现有数据。
> 
> 在 Microsoft 终止对 Windows XP 的支持后，TrueCrypt 的开发于 5/2014 结束。Windows 8/7/Vista 及更高版本提供对加密磁盘和虚拟磁盘映像的集成支持。这种集成支持也可在其他平台上使用（单击[此处](http://truecrypt.sourceforge.net/OtherPlatforms.html)了解更多信息）。您应该将任何由 TrueCrypt 加密的数据迁移到您的平台支持的加密磁盘或虚拟磁盘映像...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T20:47:47.207

您应该查看[TrueCrypt](http://www.truecrypt.org/)。它是免费的、开源的，并且在许多平台上都受支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T20:54:11.527

我也会推荐[Truecrypt](http://www.truecrypt.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:46:10.300

上次我这样做是几年前，但我们使用了 PGPdisk。它做得很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:47:51.747

您应该考虑使用[truecrypt](http://www.truecrypt.org/)。它会完成同样的事情，并且对您的系统的侵入性要小一些。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T20:56:41.117

TrueCrypt，没有理由使用任何不同的东西。它既安全又免费……您还想要什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T21:01:33.850

+1 为 TrueCrypt。我们在工作中使用它，它很棒。

提示：如果你有一个大的代码库并且你同时检查多个工作副本，如果每个工作副本都在自己的加密分区上，你会获得更好的性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-04T16:35:59.443

为了速度和简化问题，您可能希望加密部分数据而不是全部数据，但是，使用 Windows 加密卷也相当容易。不要忘记，如果您必须加密整个源，请记住您最好加密整个开发机器，而不仅仅是单个卷，因为临时文件或交换文件可能包含解密信息。

# php - PHP的SQL Server驱动可以返回SQL返回码吗？

> ID：135944
> 
> 赞同：1
> 
> 时间：2008-09-25T20:44:53.907
> 
> 标签：php, sql-server

SQL Server 中的存储过程有时以返回码结束，而不是数据记录集。我见过能够获取此返回代码的 ASP 代码，但我不知道如何使用 PHP 的 mssql 驱动程序获取此代码。

mssql_get_last_message() 总是什么都不返回，我想这是因为它只返回来自服务器的最后一行。当我们在另一个应用程序（PHP 之外）中运行 proc 时，返回码后面有一个空行。

有没有人想出如何使用 PHP 的 mssql 驱动程序从 SQL 存储过程中获取返回码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T20:46:51.607

您是在谈论 SQL Server 错误代码，例如 RAISERRROR 或其他故障吗？如果是这样，上次我签入 PHP 时，您需要询问 @@ERROR（例如选择 @@error）。

如果它是返回码，则必须显式捕获它，例如

```
DECLARE @return_code INT
EXEC @return_code = your_stored_procedure 1123
SELECT @return_code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T20:48:03.913

要从 mssql 获取数字错误代码，您可以执行一个类似于

```
SELECT @@ERROR AS ErrorCode 
```

哪个应该返回正确的错误代码。

# c++ - 如何将基数转换为序数

> ID：135946
> 
> 赞同：9
> 
> 时间：2008-09-25T20:45:09.320
> 
> 标签：c++, mfc, ordinals

有没有一种简单的方法可以将数字 1、2、3……转换为“1st”、“2nd”、“3rd”……，并且我可以给函数一种语言并拥有它返回我所针对的语言的正确形式？标准 C++（stl 或 boost OK）、MFC 或 ATL、win32 api 或小型、单一用途且免费的库，我可以从某个地方下载。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T07:12:30.187

我怀疑这是否可能，因为在许多语言中，这种形式将取决于上下文，例如它所描述的名词的性别或大小写，并且不同的语言将需要不同类型的上下文信息来确定正确的形式。

编辑：例如在波兰语中，它是“5-ta klasa”（第 5 级）与“5-ty miesiąc”（第 5 个月）与“w 5-tym miesiącu”（第 5 个月）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T07:37:07.630

I've spend quite some time researching this, because it's too large a project to get right myself. It looks like the ICU library is the only one that provides this functionality in a somewhat comprehensive way ([http://www.icu-project.org/apiref/icu4c/classRuleBasedNumberFormat.html](http://www.icu-project.org/apiref/icu4c/classRuleBasedNumberFormat.html)). I'm not too keen on incorporating a huge library like that, though. I'll keep on looking and I'm still open to suggestions.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T06:58:20.453

您是否在 Unicode 站点上查找过 CLDR 存储库？我不知道他们是否有这种东西，但由于它可能是最全面的语言环境数据存储库，它可能值得一看。 [http://www.unicode.org/cldr/](http://www.unicode.org/cldr/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T19:19:10.233

由于您使用 C++，我假设您可以使用 GNU gettext（还有一个 Windows 端口）进行所有翻译，或者至少了解他们是如何解决它的。这是复数形式的相关手册页，解释了问题（您已经找到，但更详细）及其解决方案：

[http://www.gnu.org/software/automake/manual/gettext/Plural-forms.html](http://www.gnu.org/software/automake/manual/gettext/Plural-forms.html)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-26T04:41:39.470

[这](http://www.codeproject.com/KB/cpp/number_to_text_converter.aspx)是 CodeProject 上完成这项工作的一段代码。我自己没试过。

# java - 是否有工具可以发现类路径中的多个 jar 中是否存在同一个类？

> ID：135971
> 
> 赞同：22
> 
> 时间：2008-09-25T20:47:56.643
> 
> 标签：java, jar, classpath

如果您的类路径中有两个包含同一类的不同版本的 jar，则类路径顺序变得至关重要。

我正在寻找一种工具，可以检测和标记给定类路径或一组文件夹中的此类潜在冲突。

当然是一个启动的脚本：

```
classes=`mktemp`
for i in `find . -name "*.jar"`
do
    echo "File: $i" > $classes
    jar tf $i > $classes
    ...
done 
```

稍后使用一些聪明的 sort/uniq/diff/grep/awk 有潜力，但我想知道是否有人知道任何现有的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-12-23T07:57:03.680

看起来[jarfish](http://code.google.com/p/jarfish/wiki/Intro)会用它的“dupes”命令做你想做的事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-12-24T00:48:01.513

JBoss的[Tattletale](http://www.jboss.org/tattletale)工具是另一个候选者：“发现一个类/包是否位于多个 JAR 文件中”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T21:32:11.890

我认为为自己编写一个工具不会太难。

您可以使用 System.getProperty("java.class.path"); 获取类路径条目

然后遍历那里列出的 jars、zip 或目录，收集有关这些类的所有信息，并找出可能导致麻烦的那些。

这项任务最多需要 1 或 2 天。然后你可以直接在你的应用程序中加载这个类并生成一个报告。

如果您在某些具有复杂自定义类加载的基础架构中运行（例如，我曾经看到一个从 LDAP 加载类的应用程序），那么 java.class.path 属性可能不会显示所有类，但它肯定适用于大多数情况。

这是一个您可能会觉得有用的工具，我自己从未使用过，但试一试，让我们知道结果。

[http://www.jgoodies.com/freeware/jpathreport/features.html](http://www.jgoodies.com/freeware/jpathreport/features.html)

如果您要创建自己的工具，这里是我用于之前发布的相同 shell 脚本的代码，但我在我的 Windows 机器上使用。当有大量 jar 文件时，它运行得更快。

您可以使用它并对其进行修改，而不是递归地遍历目录，而是读取类路径并比较 .class 时间属性。

如果需要，您可以子类化一个命令类，我在想“查找”的 -execute 选项

这是我自己的代码，所以它不是为了“准备好生产”，只是为了完成工作。

```
import java.io.*;
import java.util.zip.*;

public class ListZipContent{
    public static void main( String [] args ) throws IOException {
        System.out.println( "start " + new java.util.Date() );
        String pattern = args.length == 1 ? args[0] : "OracleDriver.class";// Guess which class I was looking for :) 
        File file = new File(".");
        FileFilter fileFilter = new FileFilter(){
            public boolean accept( File file ){
                return file.isDirectory() || file.getName().endsWith( "jar" );
            }
        };
        Command command = new Command( pattern );
        executeRecursively( command, file, fileFilter );
        System.out.println( "finish  " + new java.util.Date() );
    }
    private static void executeRecursively( Command command, File dir , FileFilter filter ) throws IOException {
        if( !dir.isDirectory() ){
            System.out.println( "not a directory " + dir );
            return;
        }
        for( File file : dir.listFiles( filter ) ){
            if( file.isDirectory()){
                executeRecursively( command,file , filter );
            }else{
                command.executeOn( file );
            }
        }
    }
}
class Command {

    private String pattern;
    public Command( String pattern ){
        this.pattern = pattern;
    }

    public void executeOn( File file ) throws IOException {
        if( pattern == null ) { 
            System.out.println( "Pattern is null ");
            return;
        }

        String fileName = file.getName();
        boolean jarNameAlreadyPrinted = false;

        ZipInputStream zis = null;
        try{
            zis = new ZipInputStream( new FileInputStream( file ) );

            ZipEntry ze;
            while(( ze = zis.getNextEntry() ) != null ) {
                if( ze.getName().endsWith( pattern )){
                    if( !jarNameAlreadyPrinted ){
                        System.out.println("Contents of: " + file.getCanonicalPath()  );
                        jarNameAlreadyPrinted = true;
                    }
                    System.out.println( "    " + ze.getName() );
                }
                zis.closeEntry();
            }
        }finally{
            if( zis != null ) try {
                zis.close();
            }catch( Throwable t ){}
        }
    }
} 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T21:25:37.740

[Classpath Helper](http://classpathhelper.sourceforge.net/)是一个 Eclipse 插件，它提供了一点帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-05-06T17:15:34.927

如果你不喜欢下载和安装东西，你可以使用这一行命令来查找与标准 gnu 工具的 jar 冲突。它是初级的，但您可以随意扩展它。

```
ls *.jar | xargs -n1 -iFILE unzip -l FILE | grep class | sed "s,.* ,," | tr "/" "." | sort | uniq -d | xargs -n1 -iCLASS grep -l CLASS *.jar | sort -u 
```

（如果你有很多罐子，运行会有点慢）

说明：它列出了所有 jars 中的所有文件，对类文件进行 greps，找到重复项，然后对原始 jars 进行 greps 以查看它们出现的位置。使用更复杂的脚本可以提高效率。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T01:03:45.207

[jarclassfinder](http://www.alphaworks.ibm.com/tech/jarclassfinder)是另一个 Eclipse 插件选项

# ruby - 是否可以使用块定义 Ruby 单例方法？

> ID：135995
> 
> 赞同：12
> 
> 时间：2008-09-25T20:51:01.113
> 
> 标签：ruby, closures, singleton-methods

所以，我想为一个对象定义一个单例方法，但我想用一个闭包来做。

例如，

```
def define_say(obj, msg)
  def obj.say
    puts msg
  end
end

o = Object.new
define_say o, "hello world!"
o.say 
```

这不起作用，因为通过“def”定义单例方法不是闭包，所以我得到一个异常，“msg”是一个未定义的变量或方法。

我想做的是在 Module 类中使用“define_method”方法，但据我所知，这只能用于在类上定义方法......但我想要一个单例方法。 ..

所以，我很想把它写成这样：

```
def define_say(obj, msg)
  obj.define_singleton_method(:say) {
    puts msg
  }
end 
```

有谁知道我如何实现这一点而不必创建存储 Proc 的方法，然后在单例方法中使用 Proc？（基本上，我想要一种干净、简洁的方法）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-06-22T22:18:07.570

[`Object#define_singleton_method`](http://ruby-doc.org/core-1.9.2/Object.html#method-i-define_singleton_method)顺便添加到 ruby​​-1.9.2 中：

```
def define_say(obj, msg)
  obj.define_singleton_method(:say) do
    puts msg
  end
end 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T21:15:43.160

这是一个答案，它可以满足您的需求

```
def define_say(obj, msg)
  # Get a handle to the singleton class of obj
  metaclass = class << obj; self; end 

  # add the method using define_method instead of def x.say so we can use a closure
  metaclass.send :define_method, :say do
    puts msg
  end
end 
```

用法（来自 IRB 的粘贴）

```
>> s = "my string"
=> "my string"
>> define_say(s, "I am S")
=> #<Proc:0xb6ed55b0@(irb):11>
>> s.say
I am S
=> nil 
```

有关更多信息（以及一个使其不那么混乱的小库），请阅读以下内容：

[http://viewsourcecode.org/why/hacking/seeingMetaclassesClearly.html](http://viewsourcecode.org/why/hacking/seeingMetaclassesClearly.html)

顺便说一句，如果你是一个 ruby​​ 程序员，但你还没有读过，现在就去做吧~！*********