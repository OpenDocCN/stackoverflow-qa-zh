# StackOverflow 问答 000206000-000206999

# sql - SQL 子查询

> ID：206009
> 
> 赞同：3
> 
> 时间：2008-10-15T19:08:36.510
> 
> 标签：sql, database, count, subquery

我有看起来像这样的 SQL 数据

```
events
id name         capacity
1  Cooking        10
2  Swimming       20
3  Archery        15

registrants
id  name
1   Jimmy
2   Billy
3   Sally

registrant_event
registrant_id  event_id
     1             3
     2             3
     3             2 
```

我想选择“事件”中的所有字段以及一个附加字段，即当前注册该事件的人数。在这种情况下，Archery 将有 2 个注册者，Swimming 将有 1 个，Cooking 将有 0 个。

我想这可以在单个查询中完成，但我不确定正确的语法。**如何编写查询来获取该数据？**

更新：感谢您的精彩回答，你们都摇滚！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T19:11:31.403

```
SELECT e.*, ISNULL(ec.TotalRegistrants, 0) FROM events e LEFT OUTER JOIN
(
   SELECT event_id, Count(registrant_id) AS TotalRegistrants
   FROM registrant_event
   GROUP BY event_id
) ec ON e.id  = ec.event_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T19:14:48.430

```
SELECT Events.ID, Events.Name, Events.Capacity, 
       ISNULL(COUNT(Registrant_Event.Registrant_ID), 0)
FROM Events
LEFT OUTER JOIN Registrant_Event ON Events.ID = Registrant_Event.Event_ID
GROUP BY Events.ID, Events.Name, Events.Capacity 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-22T06:42:51.127

```
select d.id1, d.name, d.cappacity, count(d.b_id) as number_of_people
from (select eve.id1,eve.name,eve.cappacity,re_eve.b_id
     from eve left join re_eve on eve.id1 = re_eve.b_id) d
group by d.id1, d.name, d.cappacity 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T19:15:10.880

```
select e.id, e.name, e.capacity, IsNull(re.eventCount,0) from events e
left join (
 select count(event_id) as eventCount, event_id  from registrant_event group by event_id
 ) re 
on e.id = re.event_id
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T19:32:16.180

我在 Oracle 11g 中对此进行了测试，它似乎可以工作

```
SELECT e.id, e.name, e.capacity, COUNT(re.event_id)
FROM events e
LEFT JOIN registrant_event re
  ON e.id = re.event_id
GROUP BY e.id, e.name, e.capacity 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-15T19:15:49.660

```
SELECT
  events.*
, COUNT(registrant_event.registrant_id) AS registrantsCount
FROM events
LEFT JOIN registrant_event ON events.id = registrant_event.event_id
GROUP BY events.id 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-15T19:15:57.133

```
SELECT e.id, count(*) AS NumRegistrants
FROM events e
LEFT JOIN registrant_event re ON re.event_id=e.id
GROUP BY e.id 
```

请注意，对于没有注册人的事件，这将返回 1 而不是 0。为了让它显示 0，你必须变得更复杂一点：

```
SELECT *,
    (SELECT COUNT(*) FROM registrant_event WHERE event_id=id) AS NumRegistrants
FROM events 
```

# image - 通过在图像内容上运行 MD5 为随机图像生成唯一文件名的任何警告？

> ID：206012
> 
> 赞同：6
> 
> 时间：2008-10-15T19:09:21.390
> 
> 标签：image, hash, md5, filenames, random

我想为每个图像生成唯一的文件名，所以我使用 MD5 来制作文件名。由于两个相同的图像可能来自不同的位置，我想实际上基于图像内容的哈希。这有什么注意事项？

（用 PHP5 这样做是值得的）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T19:11:47.393

这是一个很好的方法。两个不同的图像哈希到相同值的可能性极小，但实际上您的数据中心遭受小行星直接撞击的可能性更大。

一个警告是删除图像时应该小心。如果您删除了指向某个文件的图像记录并且您也删除了该文件，那么您可能正在删除具有指向同一图像的不同记录的文件（例如，属于不同的用户）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T19:54:30.083

给定完全随机的文件内容和良好的加密散列，当文件数量大约为 2 到（散列函数中的位数 / 2）时，会有两个具有相同散列值的文件的概率达到 50%。也就是说，对于 128 位哈希，当文件数达到 2^64 时，至少有 50% 的机会发生冲突。

您的文件内容绝对不是随机的，但我不知道这对碰撞概率的影响有多大。这被称为生日攻击，如果你想用谷歌搜索更多信息。

这是一个概率游戏。如果图像的数量将大大少于 2^64，那么您可能没问题。如果您仍然担心，使用 SHA-1 和 MD5 的组合（正如另一个答案所建议的那样）可以获得总共 288 个高质量哈希位，这意味着您将有 50% 的机会在那里发生冲突是 2^144 个文件。2^144 是一个非常大的数字。厉害大。甚至可以说是巨大的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T20:23:00.760

您应该使用 SHA-1 而不是 MD5，因为 MD5 已损坏。有成对的不同文件具有相同的 MD5 哈希（不是理论上的；这些实际上是已知的，并且有生成更多对的算法）。对于您的应用程序，这意味着有人可以上传两个具有相同 MD5 哈希的不同图像（或者有人可以生成这样一对图像并将它们发布到 Internet 的某个位置，以便您的两个用户稍后会尝试上传它们，使用结果令人困惑）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T19:11:27.597

如果您对 32 个字符的文件名没问题，对我来说似乎很好。

**编辑：**我不会将其用作（例如）FBI 的恐怖分子照片中央数据库的基础，因为有足够动机的攻击者可能会想出与现有图像具有相同 MD5 的图像。如果*是*这种情况，那么您可以改用 SHA1，这会更安全一些。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T19:13:50.803

您可以改用 UUID 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T19:11:51.837

如果您从不同的地方加载了两张相同的图像，比如一张库存照片，那么您最终可能会覆盖“原始”。但是，这意味着您只存储一个副本，而不是两个。

话虽如此，我认为按照您描述的方式进行操作没有任何大问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T19:11:52.633

这将是耗时的。为什么不给它们分配顺序 ID？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T19:33:08.067

您可能想研究 P2P 网络用于识别重复文件的技术。涉及 MD5、SHA-1 和文件长度的解决方案将非常可靠（并且可能是矫枉过正）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-03T16:56:45.693

ImageMagick 和 PHP 类 imagick，访问它能够比散列函数更主观地解释图像，而不是像颜色这样的因素。有无数的方法和用户偏好需要考虑，所以这里有一些资源，涵盖了一些方法，看看哪些方法可能适合您的预期应用程序：

*   [http://www.imagemagick.org/Usage/compare/](http://www.imagemagick.org/Usage/compare/)
*   [http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=8968&start=0](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=8968&start=0)
*   [http://galleryproject.org/node/11198#comment-39927](http://galleryproject.org/node/11198#comment-39927)

任何像 MD5 这样的散列函数只会尝试确定文件是否相同 -*按位*，而不是检查视觉相似性（有损压缩或轻微裁剪的误差范围）。

# asp.net - 当 asp:TreeView 在 UpdatePanel 中时，如何清除先前的选择？

> ID：206024
> 
> 赞同：3
> 
> 时间：2008-10-15T19:12:40.433
> 
> 标签：asp.net, ajax, treeview, updatepanel

我有一个包含两个 UpdatePanel 的 ASP.Net 2.0 页面。第一个面板包含一个 TreeView。第二个面板包含一个标签，由树中的选择触发。当我选择一个节点时，标签会按预期更新，并且`TreeNode`我单击的节点会突出显示，并且之前选择的节点不再突出显示。但是，如果一个节点在代码隐藏中原始突出显示（选择），则在选择另一个节点时不会删除突出显示。

标记

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" ChildrenAsTriggers="false" UpdateMode="Conditional">
   <ContentTemplate>
      <asp:TreeView ID="TreeView1" runat="server" OnSelectedNodeChanged="TreeView1_SelectedNodeChanged">
         <SelectedNodeStyle BackColor="Pink" />
      </asp:TreeView>
   </ContentTemplate>
</asp:UpdatePanel>
<asp:UpdatePanel ID="UpdatePanel2" runat="server" ChildrenAsTriggers="True">
   <ContentTemplate>
      <asp:Label ID="Label1" runat="server" Text=" - "></asp:Label>
   </ContentTemplate>
   <Triggers>
      <asp:AsyncPostBackTrigger ControlID="TreeView1" EventName="SelectedNodeChanged" />
   </Triggers>
</asp:UpdatePanel> 
```

背后的代码

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!IsPostBack)
   {
      TreeView1.Nodes.Add(new TreeNode("Test 1", "Test One"));
      TreeView1.Nodes.Add(new TreeNode("Test 2", "Test Two"));
      TreeView1.Nodes.Add(new TreeNode("Test 3", "Test Three"));
      TreeView1.Nodes.Add(new TreeNode("Test 4", "Test Four"));
      TreeView1.Nodes[0].Selected = true;
   }
}

protected void TreeView1_SelectedNodeChanged(object sender, EventArgs e)
{
   Label1.Text = TreeView1.SelectedValue;
} 
```

在开始时第一个节点被选中。为什么选择另一个节点时它的突出显示没有被删除？

另外，我问了一个关于我没有得到答案[的相同设置的不同问题。](https://stackoverflow.com/questions/205114/why-is-my-asptreeview-selected-node-reset-when-in-an-updatepanel)任何帮助将不胜感激。

**编辑**我知道设置`ChildrenAsTriggers="false"`会起作用，但我想避免再次渲染树，因为它可能非常大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-28T06:32:15.363

```
 /// <summary>
    /// Remove selection from TreeView
    /// </summary>
    /// <param name="tree"></param>
    public static void ClearTreeView(TreeView tree)
    {

        if (tree.SelectedNode != null)
        {
            tree.SelectedNode.Selected = false;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T03:55:19.333

您需要将所有节点的选择设置为 false。

我在我的一个应用程序中使用了这样的东西（使用我的 treeview tvCategories）：

```
public void RefreshSelection(string guid)
{
    if (guid == string.Empty)
        ClearNodes(tvCategories.Nodes);
    else
        SelectNode(guid, tvCategories.Nodes);

}

private void ClearNodes(TreeNodeCollection tnc)
{
    foreach (TreeNode n in tnc)
    {
        n.Selected = false;
        ClearNodes(n.ChildNodes);
    }
}
private bool SelectNode(string guid, TreeNodeCollection tnc)
{
    foreach (TreeNode n in tnc)
    {
        if (n.Value == guid)
        {
            n.Selected = true;
            return true;
        }
        else
        {
            SelectNode(guid, n.ChildNodes);
        }
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T10:07:45.603

这可能有点小技巧，但这将清除客户端上的选择并避免更新面板。

```
Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function BeginRequestHandler(sender, args)
   {
      var elem = args.get_postBackElement();
      var selectedClassName = elem.id + '_1';

      var arrAllElements = GetElementsByClassName(selectedClassName, elem);
      var selectedNode = $get(elem.id + '_SelectedNode').value;

      for(var i = 0; i < arrAllElements.length; i++)
      {
         if(arrAllElements[i].childNodes[0].id != selectedNode)
            RemoveClassName(arrAllElements[i], selectedClassName );
      }
   }
); 
```

它从所有树节点中删除选定的样式/类，除非它的值包含在“_SelectedNode”隐藏字段中。 `GetElementsByClassName`并且`RemoveClassName`在我自己的 js 库中，但足够明显。

# python - 有什么好的团队聊天网站吗？

> ID：206040
> 
> 赞同：3
> 
> 时间：2008-10-15T19:17:49.643
> 
> 标签：python, collaboration, instant-messaging

有没有好的团队聊天网站，最好是 Python，最好是 CherryPy 或 Trac？

这类似于[https://stackoverflow.com/questions/46612/whats-a-good-freeware-collaborative-ie-multiuser-instant-messenger#46660](https://stackoverflow.com/questions/46612/whats-a-good-freeware-collaborative-ie-multiuser-instant-messenger#46660)，但有一些主要区别：

1）我非常想托管服务器。

2）我不在乎表情是否包含在客户端中。

3) 我希望用户有两个选项：
a) 能够在我的 Trac 页面（或链接到此类页面）上托管私人 IRC，例如聊天，
b) 允许远程客户端也进行交互。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T19:28:32.663

[来自 37 个信号的营火](http://www.campfirenow.com/)- 铁路家伙。

**编辑：**它不符合您的要求，但它有一些很棒的功能......

# c++ - 你如何将结构模板标记为朋友？

> ID：206045
> 
> 赞同：11
> 
> 时间：2008-10-15T19:19:33.820
> 
> 标签：c++, class, templates, syntax, friend

我有这样的代码：

```
template <typename T, typename U> struct MyStruct {
    T aType;
    U anotherType;
};

class IWantToBeFriendsWithMyStruct
{
    friend struct MyStruct; //what is the correct syntax here ?
}; 
```

赋予模板友谊的正确语法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-15T19:23:12.940

```
class IWantToBeFriendsWithMyStruct
{
    template <typename T, typename U>
    friend struct MyStruct;
}; 
```

在 VS2008 中工作，并允许 MyStruct 访问该类。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T19:28:24.347

根据[这个站点](http://www.devx.com/cplus/10MinuteSolution/30302/0/page/2)，正确的语法是

```
class IWantToBeFriendsWithMyStruct
{
    template <typename T, typename U> friend struct MyStruct; 
} 
```

# oracle - Oracle ORA-12154：TNS：无法解析服务名称错误？

> ID：206055
> 
> 赞同：14
> 
> 时间：2008-10-15T19:23:14.140
> 
> 标签：oracle, odbc, tns

我是 SQL Server 用户。

我在一个使用 oracle 的项目中（我很少使用它）我需要创建一个 ODBC 连接，以便我可以通过 MS Access 访问一些数据我的机器上有一个名为 oraHome90 的应用程序。它似乎允许在“网络配置实用程序”中配置称为侦听器的东西，我认为还需要完成“本地网络服务名称配置”。IT 支持人员为我提供了这些信息来设置 ODBC 连接。我已经尝试了所有我能想到的组合。我可以通过一个成功通过“登录”到 oracle 服务器数据库的测试的测试。当我尝试创建 ODBC 连接时，我收到以下错误：ORA-12154：TNS：无法解析服务名称。

假设我想从头开始，并且以下信息应该允许我连接到数据库......有什么建议或评论吗？注意：最终项目会有一个网站 .ASP 页面查询数据，但我必须首先证明我可以通过 MS Access 使用 ODBC 连接看到数据

```
Service name: SERVICENAME
HOST = HOST.XYZi.com
User Id: MYUSERID
Password: MYPASSWORD
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

'Oracle Connection
Dim ocst
Dim oconn

ocst = "Provider=OraOLEDB.Oracle;" & _ 
        "Data Source=DATASOURCE;" & _ 
        "User ID=CHIJXL;" & _ 
        "Password=password;" 

set oconn = CreateObject("ADODB.Connection") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T19:26:59.717

来自[http://ora-12154.ora-code.com](http://ora-12154.ora-code.com)

**ORA-12154**：TNS：无法解析指定的连接标识符
*原因*：使用连接标识符请求了与数据库或其他服务的连接，并且指定的连接标识符无法使用配置的命名方法之一解析为连接描述符. 例如，如果使用的连接标识符类型是网络服务名称，则在命名方法存储库中找不到网络服务名称，或者无法定位或访问存储库。
*行动*：

*   如果您使用本地命名（TNSNAMES.ORA 文件）：

*   确保“TNSNAMES”列为 Oracle Net 配置文件 (SQLNET.ORA) 中 NAMES.DIRECTORY_PATH 参数的值之一

*   验证 TNSNAMES.ORA 文件是否存在并且位于正确的目录中并且可以访问。

*   检查用作连接标识符的网络服务名称是否存在于 TNSNAMES.ORA 文件中。

*   确保 TNSNAMES.ORA 文件中的任何位置都没有语法错误。查找不匹配的括号或杂散字符。TNSNAMES.ORA 文件中的错误可能使其无法使用。

*   如果您使用目录命名：

*   验证“LDAP”是否列为 Oracle Net 配置文件 (SQLNET.ORA) 中 NAMES.DIRETORY_PATH 参数的值之一。

*   验证 LDAP 目录服务器是否已启动并且可以访问。

*   验证目录中是否配置了用作连接标识符的网络服务名称或数据库名称。

*   通过将完全限定的网络服务名称或完整的 LDAP DN 指定为连接标识符来验证正在使用的默认上下文是否正确

*   如果您使用的是简单连接命名：

*   验证“EZCONNECT”是否列为 Oracle Net 配置文件 (SQLNET.ORA) 中 NAMES.DIRETORY_PATH 参数的值之一。

*   确保指定的主机、端口和服务名称正确。

*   尝试将连接标识符括在引号中。有关命名的更多信息，请参阅 Oracle 网络服务管理员指南或 Oracle 操作系统特定指南。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T23:23:54.433

假设您使用的是 TNSNAMES 命名，这里有几件事要做：

*   在与 OraHome90 关联的 network/admin 子目录中创建/修改 tnsnames.ora 文件，以包含您的 oracle 数据库的条目：

> ```
> > SERVICENAME_alias =
> >    (DESCRIPTION =
> >     (ADDRESS = (PROTOCOL = TCP)(HOST = HOST.XYZi.com)(PORT = 1521))
> >     (CONNECT_DATA = (SERVICE_NAME = SERVICENAME)) 
> ```

这是假设您使用的是标准 Oracle 端口 1521。请注意，servicename_alias 可以是您想在本地系统上使用的任何名称。您可能还会发现需要指定 (SID = SERVICENAME) 而不是 (SERVICENAME=SERVICENAME)。

*   执行 tnsping servicename_alias 来验证连通性。在继续之前先完成这项工作。这将告诉您是否超过了 12154 错误。
*   假设连接良好，请使用控制面板创建一个 ODBC DSN，指定您选择的 Oracle ODBC 驱动程序（通常至少有一个 Microsoft ODBC 驱动程序，它应该可以作为概念证明充分工作）。我将假设您给 DATASOURCE 的名称。使用 servicename_alias 作为 ODBC 配置中的服务器名称。
*   此时您应该能够通过 Access 连接到您的数据库。我不是 VB 程序员，但我知道您应该能够转到 File->Get External Data->Link Tables 并连接到您的 ODBC 源。我会假设您的代码也可以正常工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-29T15:45:59.330

参考此[MSDN POST](http://blogs.msdn.com/b/dataaccesstechnologies/archive/2010/06/30/ora-12154-tns-could-not-resolve-the-connect-identifier-specified-error-while-creating-a-linked-server-to-oracle.aspx)中的 #7 ，添加一个注册表项对我有用。我安装了 Vs2010 等 oracle 11.0。

> 检查 HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE 中的注册表项“TNS_ADMIN”。如果存在，请确保它具有正确的值为“Dir:\app\product\11.1.0\client_1\network\admin”。如果您没有看到密钥，请创建密钥并设置适当的值，如下所示。Regedit->HKEY_LOCAL_MACHINE->Software->Oracle->右键单击 NEW->StringValue 并将其命名为 TNS_ADMIN 并给出值“X:\app\product\11.1.0\client_1\network\admin”</p>

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-21T09:53:42.773

我努力解决这个问题几个小时，直到我在我的电脑中找到一个名为 TNS_ADMIN 的环境变量 => 属性 => 高级 => 环境变量 => 在系统变量中查找一个名为 TNS_ADMIN 的条目。添加 TNS_ADMIN 以更改 Tnsnames.ora 条目的默认路径。当它用于可以为所有网络计算机设置通用 tnsnames.ora 条目的网络环境中时，这很有用。要查看 tnsnames.ora 的默认路径，请在 TNS_ADMIN 中添加默认路径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T23:46:52.873

@Warren 和 @DCookie 已经介绍了解决方案，需要强调的一件事是使用`tnsping`. 在尝试连接之前，您可以使用它来证明您的 TNSNames 是正确的。

正确设置 tnsnames 后，您可以使用 ODBC 或尝试使用本地 oracle 连接的[TOra 。](http://tora.sourceforge.net/)TOra 或类似的东西（TOAD、SQL*Plus 等）在调试和改进 SQL 方面将证明是无价的。

最后但同样重要的是，当您最终连接到 ASP.net 时，请记住您可以使用 Oracle 数据连接库。有关大量资源，请访问[Oracle.com 。](http://www.oracle.com/technology/tech/dotnet/index.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-01-11T11:51:53.760

如果文件中定义的 tns 名称开头有空格`tnsnames.ora`，则某些连接器（如 odbc）可能会出现此错误。删除开头的空格字符。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-04-02T21:18:13.150

它与文件夹结构中嵌入的空间无关。

我有同样的问题。但是，当我创建了一个名为 TNS_HOME 的环境变量（在系统级和用户级都定义）并使其指向存在 TNSNAMES.ORA 的文件夹时，问题就解决了。瞧！

文基

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-08T06:10:01.373

啊啊啊！！我又遇到了这个！！！

只需将 ToadForOracle 安装在 C:\ 或路径中不带括号的任何目录中。

* * *

就我而言，这是因为我使用的是 x64 PC，并且仍在使用带有 32 位驱动程序的旧 Oracle 9i！

我将 SQL Reporting Services 与 Oracle 数据库一起使用。问题是 Visual Studio (BIDS) 路径中的括号。Oracle 不喜欢以带括号的路径开头的应用程序：

[路径中带有括号的 RDBMS 10g XE 问题](https://community.oracle.com/thread/2377520?tstart=0)

因此，我制作了一个 BAT 文件以使用 Progra~2 作为“Program Files (x86)”的短路径名打开 Visual Studio。

这是BAT文件的内容：

```
rem Progra~2 is short path name for "Program Files (x86)" and works around an Oracle client bug that doesn't like the ()'s in the path
start /B "C:\Progra~2\Microsoft Visual Studio 9.0\Common7\IDE" "C:\Progra~2\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe" 
```

我将此 BAT 文件命名为 StartBIDS.BAT 并将其放在目录中：

> "C:\Program Files\Microsoft SQL Server\Start BIDS.bat"

然后我在我的桌面和开始菜单上对 BAT 文件进行快捷方式，并更改快捷方式图标。这使我可以打开用于与 Oracle 一起工作的 TOAD、Visual Studio、BIDS 等应用程序。

**更新：**

或者做一个连接：

```
mklink /J "C:\Program Files (x86)\" "C:\Program Files x86\" 
```

然后删除快捷方式中的括号：

[![在此处输入图像描述](https://i.stack.imgur.com/9q5Rb.png)](https://i.stack.imgur.com/9q5Rb.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-12T10:43:44.517

我遇到了同样的问题，并且出现了同样的错误。我的 TNSNAMES:ORA 文件也很好，但显然由于防火墙阻止了访问而出现了问题。所以一个好的提示是确保防火墙没有阻止对数据源的访问。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-15T08:00:52.820

我也遇到过这个问题。我发现问题是因为 Oracle DB 不喜欢 C:program files (x86)\Toad...... 中的空间所以我创建了一个名为 C:App\Toad 的新目录，然后在其中重新安装以将 Toad 连接到 Oracle . 有效。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-04-10T13:03:41.517

我使用这个步骤解决了这个问题。

首先，如果您没有安装相同的目录或驱动器，则会发生此错误。

但答案就在这里。

1.  以管理员身份登录窗口。
2.  转到控制面板。
3.  系统属性，然后单击环境
4.  找到操作系统变量并将名称更改为“TNS_ADMIN”

    [![在此处输入图像描述](https://i.stack.imgur.com/SazDD.png)](https://i.stack.imgur.com/SazDD.png)

5.  并将值更改为“tnsnames 的目录地址” [![在此处输入图像描述](https://i.stack.imgur.com/myxxy.png)](https://i.stack.imgur.com/myxxy.png)

6.  重新启动系统。

7.  恭喜。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-06-25T11:55:00.777

我已经通过从 C:\oracle\ora92\network\ADMIN 路径中删除 sqlnet.ora 解决了这个问题

*   确保 TNSNAMES.ORA 文件存在于正确的目录中
*   确保 PATH 环境变量具有 oracle 的条目
*   确保 TNSNAMES.ORA 中没有语法问题
*   尝试删除 sqlnet.ora 文件

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-08-20T16:00:21.800

[在对另一个答案的评论](https://stackoverflow.com/questions/206055/oracle-ora-12154-tns-could-not-resolve-service-name-error#comment49703662_206066)中提到了这一点，但我想将其移至实际答案，因为这也是我的问题，如果它是一个答案，我会投票赞成。

我在 Linux 上，并且 tnsnames.ora 文件未设置为所有人可读。在通过本地工作的 tns 使其可读连接之后。

```
$ chmod +r tnsnames.ora 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-06-09T17:31:12.883

解决了数小时的问题。我已经安装了适用于 Oracle 的 Beta Entity Framework，并且在 Visual Studio 2010 MVC 3 项目中，我在 .NET 选项卡下引用了 Oracle.DataAccess ...这一直给我“Oracle ORA-12154：TNS：无法.. 。“ 错误。我终于浏览到以前的 Oracle 安装在 c:\Oracle\product.... 下使用旧的 10.2.0.100 版本的 dll。最后它现在可以工作了。希望它可以帮助别人。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-30T14:57:37.900

我们通过重新安装 Oracle 数据库客户端解决了我们的问题。不知何故，在其中一台工作站上安装不成功（即使没有日志记录），但是在将 Oracle 目录的大小/文件/文件夹与工作的客户端工作站进行比较时，丢失了大量文件。一旦我们执行了全新安装，一切都运行良好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-02-06T11:59:52.483

仅重新启动 SID 服务。例如你的 SID name = orcl 那么所有与 orcl 相关的服务都应该重启然后你的问题就解决了

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-10-02T13:13:45.443

就我而言，错误是因为我有 2 个 Oracle 客户端，这是解决方案：

[本地 IIS 上的 Oracle ORA-12154 错误，但 Visual Studio 开发服务器上没有](https://stackoverflow.com/questions/7176252/oracle-ora-12154-error-on-local-iis-but-not-with-visual-studio-development-serv/26161650#26161650)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-01-10T01:39:29.113

我只花了一个小时，我是甲骨文的新手，所以我完全糊涂了..

情况：

刚刚安装了 Visual Studio 2012 Oracle 开发者工具。当我这样做时，我丢失了下拉列表中的项目，其中包含我在 TOAD 中的 TNS 条目。我从 Visual Studio 和 TOAD 收到了这个错误！！哇！所以我在“所有用户”下添加了环境变量 TNS_ADMIN 以及我的 .ora 文件的路径（我现在工作得很好，因为它一直工作到我把它弄坏了）。蟾蜍接受了这种变化。仍然 Visual Studio 不会给我任何爱......仍然得到同样的错误。然后，我将环境变量添加到我的用户变量中.. 中提琴！

**确保为系统和用户设置环境变量**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-11-12T09:40:37.080

如果您有同名的 32 位 DSN 和 64 位 DSN，Windows 将自动选择 64 位，如果您的应用程序是 32 位，则会显示此错误。请注意这一点。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-12-15T11:54:55.110

此错误消息可能非常令人困惑，并且解决方案可能非常原始。

就我而言：Oracle 存储过程通过 "Provider=OraOLEDB.Oracle;Data Source= ...etc" 将记录集发送到 MS Excel。

问题是发送到 Excel 2010 的 Oracle 数据列中的一些十进制数字。当我使用 Oracle SQL 查询 ROUND(grosssales_eur,2) AS Grosssales_eur 时，它运行良好。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-12-15T15:05:19.513

由于文件名 tsnames.ora 而不是 tnsnames.ora 中的拼写错误，我遇到了这个问题

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-08-27T18:31:39.407

我们也有类似的问题。我们发现我们在 tnsnames.ora 中为连接字符串提供了多个别名，例如：

svc01，svc02=（描述=（地址=（协议=TCP）（主机=xxxx）（端口=50））（连接数据=（服务器=专用）（服务名称=yyyysvc.world）））

因此，当使用 ODBC 创建连接时，当我们选择 TNS 服务名称的值时，自动填充显示“svc01”（请注意那里的额外逗号）。一旦我们删除逗号，它就开始为我们工作。

# php - URL 的 PHP 验证/正则表达式

> ID：206059
> 
> 赞同：132
> 
> 时间：2008-10-15T19:24:51.280
> 
> 标签：php, regex, url, validation

我一直在为 URL 寻找一个简单的正则表达式，有人有一个很好用的吗？我没有找到一个带有 zend 框架验证类的类，并且已经看到了几个实现。

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2008-10-16T06:55:36.003

使用该`filter_var()`函数来验证字符串是否为 URL：

```
var_dump(filter_var('example.com', FILTER_VALIDATE_URL)); 
```

不必要时使用正则表达式是不好的做法。

**编辑**：小心，这个解决方案不是 unicode 安全的，也不是 XSS 安全的。如果您需要复杂的验证，也许最好去别处看看。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2008-10-15T19:30:51.910

我在几个项目中使用了它，我不相信我遇到了问题，但我确信它并不详尽：

```
$text = preg_replace(
  '#((https?|ftp)://(\S*?\.\S*?))([\s)\[\]{},;"\':<]|\.\s|$)#i',
  "'<a href=\"$1\" target=\"_blank\">$3</a>$4'",
  $text
); 
```

结尾的大部分随机垃圾都是为了处理`http://domain.com.`句子中的情况（避免匹配尾随句点）。我确信它可以被清理，但因为它有效。我或多或少只是将它从一个项目复制到另一个项目。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-12-27T14:12:29.690

根据 PHP 手册 - 不应使用 parse_url**来**验证 URL。

不幸的是，它似乎`filter_var('example.com', FILTER_VALIDATE_URL)`并没有表现得更好。

两者都`parse_url()`将`filter_var()`传递格式错误的 URL，例如`http://...`

因此在这种情况下 - 正则表达式**是**更好的方法。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-03-13T11:46:46.457

根据**约翰格鲁伯**（大胆的火球）：

正则表达式：

```
(?i)\b((?:https?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'\".,<>?«»“”‘’])) 
```

在 preg_match() 中使用：

```
preg_match("/(?i)\b((?:https?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'\".,<>?«»“”‘’]))/", $url) 
```

这是扩展的正则表达式模式（带注释）：

```
(?xi)
\b
(                       # Capture 1: entire matched URL
  (?:
    https?://               # http or https protocol
    |                       #   or
    www\d{0,3}[.]           # "www.", "www1.", "www2." … "www999."
    |                           #   or
    [a-z0-9.\-]+[.][a-z]{2,4}/  # looks like domain name followed by a slash
  )
  (?:                       # One or more:
    [^\s()<>]+                  # Run of non-space, non-()<>
    |                           #   or
    \(([^\s()<>]+|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
  )+
  (?:                       # End with:
    \(([^\s()<>]+|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
    |                               #   or
    [^\s`!()\[\]{};:'".,<>?«»“”‘’]        # not a space or one of these punct chars
  )
) 
```

有关更多详细信息，请查看： [http ://daringfireball.net/2010/07/improved_regex_for_matching_urls](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-02-11T13:04:14.160

以防万一您想知道该 url 是否真的存在：

```
function url_exist($url){//se passar a URL existe
    $c=curl_init();
    curl_setopt($c,CURLOPT_URL,$url);
    curl_setopt($c,CURLOPT_HEADER,1);//get the header
    curl_setopt($c,CURLOPT_NOBODY,1);//and *only* get the header
    curl_setopt($c,CURLOPT_RETURNTRANSFER,1);//get the response as a string from curl_exec(), rather than echoing it
    curl_setopt($c,CURLOPT_FRESH_CONNECT,1);//don't use a cached version of the url
    if(!curl_exec($c)){
        //echo $url.' inexists';
        return false;
    }else{
        //echo $url.' exists';
        return true;
    }
    //$httpcode=curl_getinfo($c,CURLINFO_HTTP_CODE);
    //return ($httpcode<400);
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-05-11T18:29:05.877

我不认为在这种情况下使用正则表达式是一件明智的事情。不可能匹配所有的可能性，即使你做到了，仍然有可能 url 根本不存在。

这是一个非常简单的方法来测试 url 是否确实存在并且是否可读：

```
if (preg_match("#^https?://.+#", $link) and @fopen($link,"r")) echo "OK"; 
```

（如果没有，`preg_match`那么这也将验证您服务器上的所有文件名）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-10-15T19:36:07.110

我用这个很成功——我不记得我从哪里得到的

```
$pattern = "/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&@#\/%?=~_|!:,.;]*[-a-z0-9+&@#\/%=~_|]/i"; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-10-16T08:57:46.907

```
 function validateURL($URL) {
      $pattern_1 = "/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\d+))?\/?/i";
      $pattern_2 = "/^(www)((\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\d+))?\/?/i";       
      if(preg_match($pattern_1, $URL) || preg_match($pattern_2, $URL)){
        return true;
      } else{
        return false;
      }
    } 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-06-27T12:55:07.390

最适合我的 URL 正则表达式：

```
function valid_URL($url){
    return preg_match('%^(?:(?:https?|ftp)://)(?:\S+(?::\S*)?@|\d{1,3}(?:\.\d{1,3}){3}|(?:(?:[a-z\d\x{00a1}-\x{ffff}]+-?)*[a-z\d\x{00a1}-\x{ffff}]+)(?:\.(?:[a-z\d\x{00a1}-\x{ffff}]+-?)*[a-z\d\x{00a1}-\x{ffff}]+)*(?:\.[a-z\x{00a1}-\x{ffff}]{2,6}))(?::\d+)?(?:[^\s]*)?$%iu', $url);
} 
```

例子：

```
valid_URL('https://twitter.com'); // true
valid_URL('http://twitter.com');  // true
valid_URL('http://twitter.co');   // true
valid_URL('http://t.co');         // true
valid_URL('http://twitter.c');    // false
valid_URL('htt://twitter.com');   // false

valid_URL('http://example.com/?a=1&b=2&c=3'); // true
valid_URL('http://127.0.0.1');    // true
valid_URL('');                    // false
valid_URL(1);                     // false 
```

来源：[http ://urlregex.com/](http://urlregex.com/)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-12T17:17:07.187

**编辑：**
正如[事件](https://stackoverflow.com/users/138016/incidence)指出的那样，随着 PHP 5.3.0 (2009-06-30) 的发布，此代码已被弃用，应相应地使用。

* * *

只是我的两分钱，但我已经开发了这个功能并且已经成功使用了一段时间。它有很好的文档记录和分离，因此您可以轻松更改它。

```
// Checks if string is a URL
// @param string $url
// @return bool
function isURL($url = NULL) {
    if($url==NULL) return false;

    $protocol = '(http://|https://)';
    $allowed = '([a-z0-9]([-a-z0-9]*[a-z0-9]+)?)';

    $regex = "^". $protocol . // must include the protocol
             '(' . $allowed . '{1,63}\.)+'. // 1 or several sub domains with a max of 63 chars
             '[a-z]' . '{2,6}'; // followed by a TLD
    if(eregi($regex, $url)==true) return true;
    else return false;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-12-07T03:15:06.390

这就是你的答案 =) 试着打破它，你不能！！！

```
function link_validate_url($text) {
$LINK_DOMAINS = 'aero|arpa|asia|biz|com|cat|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel|mobi|local';
  $LINK_ICHARS_DOMAIN = (string) html_entity_decode(implode("", array( // @TODO completing letters ...
    "&#x00E6;", // æ
    "&#x00C6;", // Æ
    "&#x00C0;", // À
    "&#x00E0;", // à
    "&#x00C1;", // Á
    "&#x00E1;", // á
    "&#x00C2;", // Â
    "&#x00E2;", // â
    "&#x00E5;", // å
    "&#x00C5;", // Å
    "&#x00E4;", // ä
    "&#x00C4;", // Ä
    "&#x00C7;", // Ç
    "&#x00E7;", // ç
    "&#x00D0;", // Ð
    "&#x00F0;", // ð
    "&#x00C8;", // È
    "&#x00E8;", // è
    "&#x00C9;", // É
    "&#x00E9;", // é
    "&#x00CA;", // Ê
    "&#x00EA;", // ê
    "&#x00CB;", // Ë
    "&#x00EB;", // ë
    "&#x00CE;", // Î
    "&#x00EE;", // î
    "&#x00CF;", // Ï
    "&#x00EF;", // ï
    "&#x00F8;", // ø
    "&#x00D8;", // Ø
    "&#x00F6;", // ö
    "&#x00D6;", // Ö
    "&#x00D4;", // Ô
    "&#x00F4;", // ô
    "&#x00D5;", // Õ
    "&#x00F5;", // õ
    "&#x0152;", // Œ
    "&#x0153;", // œ
    "&#x00FC;", // ü
    "&#x00DC;", // Ü
    "&#x00D9;", // Ù
    "&#x00F9;", // ù
    "&#x00DB;", // Û
    "&#x00FB;", // û
    "&#x0178;", // Ÿ
    "&#x00FF;", // ÿ 
    "&#x00D1;", // Ñ
    "&#x00F1;", // ñ
    "&#x00FE;", // þ
    "&#x00DE;", // Þ
    "&#x00FD;", // ý
    "&#x00DD;", // Ý
    "&#x00BF;", // ¿
  )), ENT_QUOTES, 'UTF-8');

  $LINK_ICHARS = $LINK_ICHARS_DOMAIN . (string) html_entity_decode(implode("", array(
    "&#x00DF;", // ß
  )), ENT_QUOTES, 'UTF-8');
  $allowed_protocols = array('http', 'https', 'ftp', 'news', 'nntp', 'telnet', 'mailto', 'irc', 'ssh', 'sftp', 'webcal');

  // Starting a parenthesis group with (?: means that it is grouped, but is not captured
  $protocol = '((?:'. implode("|", $allowed_protocols) .'):\/\/)';
  $authentication = "(?:(?:(?:[\w\.\-\+!$&'\(\)*\+,;=" . $LINK_ICHARS . "]|%[0-9a-f]{2})+(?::(?:[\w". $LINK_ICHARS ."\.\-\+%!$&'\(\)*\+,;=]|%[0-9a-f]{2})*)?)?@)";
  $domain = '(?:(?:[a-z0-9' . $LINK_ICHARS_DOMAIN . ']([a-z0-9'. $LINK_ICHARS_DOMAIN . '\-_\[\]])*)(\.(([a-z0-9' . $LINK_ICHARS_DOMAIN . '\-_\[\]])+\.)*('. $LINK_DOMAINS .'|[a-z]{2}))?)';
  $ipv4 = '(?:[0-9]{1,3}(\.[0-9]{1,3}){3})';
  $ipv6 = '(?:[0-9a-fA-F]{1,4}(\:[0-9a-fA-F]{1,4}){7})';
  $port = '(?::([0-9]{1,5}))';

  // Pattern specific to external links.
  $external_pattern = '/^'. $protocol .'?'. $authentication .'?('. $domain .'|'. $ipv4 .'|'. $ipv6 .' |localhost)'. $port .'?';

  // Pattern specific to internal links.
  $internal_pattern = "/^(?:[a-z0-9". $LINK_ICHARS ."_\-+\[\]]+)";
  $internal_pattern_file = "/^(?:[a-z0-9". $LINK_ICHARS ."_\-+\[\]\.]+)$/i";

  $directories = "(?:\/[a-z0-9". $LINK_ICHARS ."_\-\.~+%=&,$'#!():;*@\[\]]*)*";
  // Yes, four backslashes == a single backslash.
  $query = "(?:\/?\?([?a-z0-9". $LINK_ICHARS ."+_|\-\.~\/\\\\%=&,$'():;*@\[\]{} ]*))";
  $anchor = "(?:#[a-z0-9". $LINK_ICHARS ."_\-\.~+%=&,$'():;*@\[\]\/\?]*)";

  // The rest of the path for a standard URL.
  $end = $directories .'?'. $query .'?'. $anchor .'?'.'$/i';

  $message_id = '[^@].*@'. $domain;
  $newsgroup_name = '(?:[0-9a-z+-]*\.)*[0-9a-z+-]*';
  $news_pattern = '/^news:('. $newsgroup_name .'|'. $message_id .')$/i';

  $user = '[a-zA-Z0-9'. $LINK_ICHARS .'_\-\.\+\^!#\$%&*+\/\=\?\`\|\{\}~\'\[\]]+';
  $email_pattern = '/^mailto:'. $user .'@'.'(?:'. $domain .'|'. $ipv4 .'|'. $ipv6 .'|localhost)'. $query .'?$/';

  if (strpos($text, '<front>') === 0) {
    return false;
  }
  if (in_array('mailto', $allowed_protocols) && preg_match($email_pattern, $text)) {
    return false;
  }
  if (in_array('news', $allowed_protocols) && preg_match($news_pattern, $text)) {
    return false;
  }
  if (preg_match($internal_pattern . $end, $text)) {
    return false;
  }
  if (preg_match($external_pattern . $end, $text)) {
    return false;
  }
  if (preg_match($internal_pattern_file, $text)) {
    return false;
  }

  return true;
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-03-30T20:45:07.020

```
function is_valid_url ($url="") {

        if ($url=="") {
            $url=$this->url;
        }

        $url = @parse_url($url);

        if ( ! $url) {

            return false;
        }

        $url = array_map('trim', $url);
        $url['port'] = (!isset($url['port'])) ? 80 : (int)$url['port'];
        $path = (isset($url['path'])) ? $url['path'] : '';

        if ($path == '') {
            $path = '/';
        }

        $path .= ( isset ( $url['query'] ) ) ? "?$url[query]" : '';

        if ( isset ( $url['host'] ) AND $url['host'] != gethostbyname ( $url['host'] ) ) {
            if ( PHP_VERSION >= 5 ) {
                $headers = get_headers("$url[scheme]://$url[host]:$url[port]$path");
            }
            else {
                $fp = fsockopen($url['host'], $url['port'], $errno, $errstr, 30);

                if ( ! $fp ) {
                    return false;
                }
                fputs($fp, "HEAD $path HTTP/1.1\r\nHost: $url[host]\r\n\r\n");
                $headers = fread ( $fp, 128 );
                fclose ( $fp );
            }
            $headers = ( is_array ( $headers ) ) ? implode ( "\n", $headers ) : $headers;
            return ( bool ) preg_match ( '#^HTTP/.*\s+[(200|301|302)]+\s#i', $headers );
        }

        return false;
    } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-12-13T23:35:25.020

受此[.NET StackOverflow 问题](https://stackoverflow.com/questions/30847/regex-to-validate-uris)和[该问题的引用文章的](http://snipplr.com/view/6889/regular-expressions-for-uri-validationparsing/)启发，有此 URI 验证器（URI 表示它同时验证 URL 和 URN）。

```
if( ! preg_match( "/^([a-z][a-z0-9+.-]*):(?:\\/\\/((?:(?=((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*))(\\3)@)?(?=(\\[[0-9A-F:.]{2,}\\]|(?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*))\\5(?::(?=(\\d*))\\6)?)(\\/(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\8)?|(\\/?(?!\\/)(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\10)?)(?:\\?(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\11)?(?:#(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\12)?$/i", $uri ) )
{
    throw new \RuntimeException( "URI has not a valid format." );
} 
```

我已经成功地在我命名`Uri`并测试的 ValueObject 中对这个函数进行了单元测试`UriTest`。

# UriTest.php（包含 URL 和 URN 的有效和无效案例）

```
<?php

declare( strict_types = 1 );

namespace XaviMontero\ThrasherPortage\Tests\Tour;

use XaviMontero\ThrasherPortage\Tour\Uri;

class UriTest extends \PHPUnit_Framework_TestCase
{
    private $sut;

    public function testCreationIsOfProperClassWhenUriIsValid()
    {
        $sut = new Uri( 'http://example.com' );
        $this->assertInstanceOf( 'XaviMontero\\ThrasherPortage\\Tour\\Uri', $sut );
    }

    /**
     * @dataProvider urlIsValidProvider
     * @dataProvider urnIsValidProvider
     */
    public function testGetUriAsStringWhenUriIsValid( string $uri )
    {
        $sut = new Uri( $uri );
        $actual = $sut->getUriAsString();

        $this->assertInternalType( 'string', $actual );
        $this->assertEquals( $uri, $actual );
    }

    public function urlIsValidProvider()
    {
        return
            [
                [ 'http://example-server' ],
                [ 'http://example.com' ],
                [ 'http://example.com/' ],
                [ 'http://subdomain.example.com/path/?parameter1=value1&parameter2=value2' ],
                [ 'random-protocol://example.com' ],
                [ 'http://example.com:80' ],
                [ 'http://example.com?no-path-separator' ],
                [ 'http://example.com/pa%20th/' ],
                [ 'ftp://example.org/resource.txt' ],
                [ 'file://../../../relative/path/needs/protocol/resource.txt' ],
                [ 'http://example.com/#one-fragment' ],
                [ 'http://example.edu:8080#one-fragment' ],
            ];
    }

    public function urnIsValidProvider()
    {
        return
            [
                [ 'urn:isbn:0-486-27557-4' ],
                [ 'urn:example:mammal:monotreme:echidna' ],
                [ 'urn:mpeg:mpeg7:schema:2001' ],
                [ 'urn:uuid:6e8bc430-9c3a-11d9-9669-0800200c9a66' ],
                [ 'rare-urn:uuid:6e8bc430-9c3a-11d9-9669-0800200c9a66' ],
                [ 'urn:FOO:a123,456' ]
            ];
    }

    /**
     * @dataProvider urlIsNotValidProvider
     * @dataProvider urnIsNotValidProvider
     */
    public function testCreationThrowsExceptionWhenUriIsNotValid( string $uri )
    {
        $this->expectException( 'RuntimeException' );
        $this->sut = new Uri( $uri );
    }

    public function urlIsNotValidProvider()
    {
        return
            [
                [ 'only-text' ],
                [ 'http//missing.colon.example.com/path/?parameter1=value1&parameter2=value2' ],
                [ 'missing.protocol.example.com/path/' ],
                [ 'http://example.com\\bad-separator' ],
                [ 'http://example.com|bad-separator' ],
                [ 'ht tp://example.com' ],
                [ 'http://exampl e.com' ],
                [ 'http://example.com/pa th/' ],
                [ '../../../relative/path/needs/protocol/resource.txt' ],
                [ 'http://example.com/#two-fragments#not-allowed' ],
                [ 'http://example.edu:portMustBeANumber#one-fragment' ],
            ];
    }

    public function urnIsNotValidProvider()
    {
        return
            [
                [ 'urn:mpeg:mpeg7:sch ema:2001' ],
                [ 'urn|mpeg:mpeg7:schema:2001' ],
                [ 'urn?mpeg:mpeg7:schema:2001' ],
                [ 'urn%mpeg:mpeg7:schema:2001' ],
                [ 'urn#mpeg:mpeg7:schema:2001' ],
            ];
    }
} 
```

# Uri.php（值对象）

```
<?php

declare( strict_types = 1 );

namespace XaviMontero\ThrasherPortage\Tour;

class Uri
{
    /** @var string */
    private $uri;

    public function __construct( string $uri )
    {
        $this->assertUriIsCorrect( $uri );
        $this->uri = $uri;
    }

    public function getUriAsString()
    {
        return $this->uri;
    }

    private function assertUriIsCorrect( string $uri )
    {
        // https://stackoverflow.com/questions/30847/regex-to-validate-uris
        // http://snipplr.com/view/6889/regular-expressions-for-uri-validationparsing/

        if( ! preg_match( "/^([a-z][a-z0-9+.-]*):(?:\\/\\/((?:(?=((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*))(\\3)@)?(?=(\\[[0-9A-F:.]{2,}\\]|(?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*))\\5(?::(?=(\\d*))\\6)?)(\\/(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\8)?|(\\/?(?!\\/)(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\10)?)(?:\\?(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\11)?(?:#(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\12)?$/i", $uri ) )
        {
            throw new \RuntimeException( "URI has not a valid format." );
        }
    }
} 
```

# 运行单元测试

46 个测试中有 65 个断言。**注意：**有效表达式有 2 个数据提供者，无效表达式有 2 个。一个用于 URL，另一个用于 URN。如果您使用的是 v5.6* 或更早版本的 PhpUnit，则需要将两个数据提供者合并为一个。

```
xavi@bromo:~/custom_www/hello-trip/mutant-migrant$ vendor/bin/phpunit
PHPUnit 5.7.3 by Sebastian Bergmann and contributors.

..............................................                    46 / 46 (100%)

Time: 82 ms, Memory: 4.00MB

OK (46 tests, 65 assertions) 
```

# 代码覆盖率

此示例 URI 检查器中有 100% 的代码覆盖率。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-07-20T11:14:54.107

```
"/(http(s?):\/\/)([a-z0-9\-]+\.)+[a-z]{2,4}(\.[a-z]{2,4})*(\/[^ ]+)*/i" 
```

1.  (http(s?)://) 表示 http:// 或 https://

2.  ([a-z0-9-]+.)+ => 2.0[a-z0-9-] 表示任何 az 字符或任何 0-9 或 (-) 符号)

    ```
     2.1 (+) means the character can be one or more ex: a1w, 
                     a9-,c559s, f)

                 2.2 \. is (.)sign

                 2.3\. the (+) sign after ([a-z0-9\-]+\.) mean do 2.1,2.2,2.3 
                    at least 1 time 
                  ex: abc.defgh0.ig, aa.b.ced.f.gh. also in case www.yyy.com

                 3.[a-z]{2,4} mean a-z at least 2 character but not more than 
                              4 characters for check that there will not be 
                              the case 
                              ex: https://www.google.co.kr.asdsdagfsdfsf

                 4.(\.[a-z]{2,4})*(\/[^ ]+)* mean 

                   4.1 \.[a-z]{2,4} means like number 3 but start with 
                       (.)sign 

                   4.2 * means (\.[a-z]{2,4})can be use or not use never mind

                   4.3 \/ means \
                   4.4 [^ ] means any character except blank
                   4.5 (+) means do 4.3,4.4,4.5 at least 1 times
                   4.6 (*) after (\/[^ ]+) mean use 4.3 - 4.5 or not use 
                       no problem

                   use for case https://stackoverflow.com/posts/51441301/edit

                   5\. when you use regex write in "/ /" so it come 
    ```

    "/(http(s?)://)([a-z0-9-]+.)+[az]{2,4}(.[az]{2,4}) *(/[^ ]+ )* /我"

    ```
     6\. almost forgot: letter i on the back mean ignore case of 
                      Big letter or small letter ex: A same as a, SoRRy same 
                      as sorry. 
    ```

注意：抱歉英语不好。我的国家没有很好地使用它。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-02-19T05:47:47.347

好的，所以这比简单的正则表达式要复杂一些，但它允许不同类型的 url。

例子：

*   google.com
*   www.microsoft.com/
*   [http://www.yahoo.com/](http://www.yahoo.com/)
*   [https://www.bandcamp.com/artist/#!someone-special](https://www.bandcamp.com/artist/#!someone-special)！

所有这些都应标记为有效。

```
function is_valid_url($url) {
    // First check: is the url just a domain name? (allow a slash at the end)
    $_domain_regex = "|^[A-Za-z0-9-]+(\.[A-Za-z0-9-]+)*(\.[A-Za-z]{2,})/?$|";
    if (preg_match($_domain_regex, $url)) {
        return true;
    }

    // Second: Check if it's a url with a scheme and all
    $_regex = '#^([a-z][\w-]+:(?:/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))$#';
    if (preg_match($_regex, $url, $matches)) {
        // pull out the domain name, and make sure that the domain is valid.
        $_parts = parse_url($url);
        if (!in_array($_parts['scheme'], array( 'http', 'https' )))
            return false;

        // Check the domain using the regex, stops domains like "-example.com" passing through
        if (!preg_match($_domain_regex, $_parts['host']))
            return false;

        // This domain looks pretty valid. Only way to check it now is to download it!
        return true;
    }

    return false;
} 
```

请注意，您要允许的协议有一个 in_array 检查（当前只有 http 和 https 在该列表中）。

```
var_dump(is_valid_url('google.com'));         // true
var_dump(is_valid_url('google.com/'));        // true
var_dump(is_valid_url('http://google.com'));  // true
var_dump(is_valid_url('http://google.com/')); // true
var_dump(is_valid_url('https://google.com')); // true 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-08-31T18:01:42.333

对于使用 WordPress 开发的任何人，只需使用

```
esc_url_raw($url) === $url 
```

验证 URL（[这里是 WordPress 的文档`esc_url_raw`](https://developer.wordpress.org/reference/functions/esc_url_raw/)）。它处理 URL 比`filter_var($url, FILTER_VALIDATE_URL)`因为它*是*unicode 和 XSS 安全的要好得多。（[这是一篇很好的文章，提到了所有问题`filter_var`](https://d-mueller.de/blog/why-url-validation-with-filter_var-might-not-be-a-good-idea/)）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-30T05:11:48.077

由于许多原因，彼得的正则表达式对我来说看起来不正确。它允许在域名中使用各种特殊字符，并且不需要太多测试。

Frankie 的函数对我来说看起来不错，如果你不想要一个函数，你可以从组件中构建一个好的正则表达式，如下所示：

```
^(http://|https://)(([a-z0-9]([-a-z0-9]*[a-z0-9]+)?){1,63}\.)+[a-z]{2,6} 
```

未经测试，但我认为这应该有效。

此外，欧文的答案看起来也不是 100%。我采用了正则表达式的域部分并在正则表达式测试工具[http://erik.eae.net/playground/regexp/regexp.html上对其进行了测试](http://erik.eae.net/playground/regexp/regexp.html)

我放了以下行：

```
(\S*?\.\S*?) 
```

在“正则表达式”部分和以下行中：

> -hello.com

在“示例文本”部分下。

结果允许减号通过。因为 \S 表示任何非空格字符。

请注意 Frankie 的正则表达式处理减号，因为它的第一个字符有这个部分：

```
[a-z0-9] 
```

这不允许减号或任何其他特殊字符。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-08-21T09:17:01.300

这是我的做法。但我想提醒一下，我对正则表达式并不那么拘谨。但它应该对你有用:)

```
$pattern = "#((http|https)://(\S*?\.\S*?))(\s|\;|\)|\]|\[|\{|\}|,|”|\"|'|:|\<|$|\.\s)#i";
        $text = preg_replace_callback($pattern,function($m){
                return "<a href=\"$m[1]\" target=\"_blank\">$m[1]</a>$m[4]";
            },
            $text); 
```

这样你就不需要你的模式上的 eval 标记了。

希望能帮助到你 ：）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-02-08T16:01:28.443

[这是一个使用 RegEx 进行URL 验证](https://github.com/K1tson/URLValidation)的简单类，然后将域与流行的 RBL（实时黑洞列表）服务器交叉引用：

**安装：**

```
require 'URLValidation.php'; 
```

**用法：**

```
require 'URLValidation.php';
$urlVal = new UrlValidation(); //Create Object Instance 
```

添加一个 URL 作为`domain()`方法的参数并检查返回。

```
$urlArray = ['http://www.bokranzr.com/test.php?test=foo&test=dfdf', 'https://en-gb.facebook.com', 'https://www.google.com'];
foreach ($urlArray as $k=>$v) {

    echo var_dump($urlVal->domain($v)) . ' URL: ' . $v . '<br>';

} 
```

**输出：**

```
bool(false) URL: http://www.bokranzr.com/test.php?test=foo&test=dfdf
bool(true) URL: https://en-gb.facebook.com
bool(true) URL: https://www.google.com 
```

正如您在上面看到的，www.bokranzr.com 通过 RBL 被列为恶意网站，因此该域被返回为 false。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-08-05T23:17:48.967

我发现这对于匹配 URL 最有用。

```
^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$ 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2015-05-14T13:13:23.853

有一个 PHP 本机函数：

```
$url = 'http://www.yoururl.co.uk/sub1/sub2/?param=1&param2/';

if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {
    // Wrong
}
else {
    // Valid
} 
```

返回过滤后的数据，如果过滤器失败，则返回 FALSE。

[在这里检查](http://php.net/manual/en/function.filter-var.php)

# mysql - MySQL：在 FROM 子句限制中使用子查询查看

> ID：206062
> 
> 赞同：60
> 
> 时间：2008-10-15T19:25:51.107
> 
> 标签：mysql, sql, view, mysql-error-1349

在 MySQL 5.0 中，为什么在 FROM 子句中尝试使用子查询创建视图时会出现以下错误？

> ERROR 1349 (HY000): View 的 SELECT 在 FROM 子句中包含子查询

如果这是 MySQL 引擎的限制，那他们为什么还没有实现这个功能呢？

另外，对于这个限制有什么好的解决方法？

是否有任何变通办法适用于 FROM 子句中的任何子查询，或者是否有一些查询如果不使用 FROM 子句中的子查询就无法表达？

* * *

一个示例查询（埋在评论中）：

```
SELECT temp.UserName 
FROM (SELECT u1.name as UserName, COUNT(m1.UserFromId) as SentCount 
      FROM Message m1, User u1 
      WHERE u1.uid = m1.UserFromId 
      Group BY u1.name HAVING SentCount > 3 ) as temp 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2010-08-19T09:48:50.257

我有同样的问题。我想创建一个视图来显示最近一年的信息，从一个包含 2009 年到 2011 年记录的表中。这是原始查询：

```
SELECT a.* 
FROM a 
JOIN ( 
  SELECT a.alias, MAX(a.year) as max_year 
  FROM a 
  GROUP BY a.alias
) b 
ON a.alias=b.alias and a.year=b.max_year 
```

解决方案概要：

1.  为每个子查询创建一个视图
2.  用这些视图替换子查询

这是解决方案查询：

```
CREATE VIEW v_max_year AS 
  SELECT alias, MAX(year) as max_year 
  FROM a 
  GROUP BY a.alias;

CREATE VIEW v_latest_info AS 
  SELECT a.* 
  FROM a 
  JOIN v_max_year b 
  ON a.alias=b.alias and a.year=b.max_year; 
```

它在 mysql 5.0.45 上运行良好，没有太大的速度损失（与执行没有任何视图的原始子查询选择相比）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-15T19:54:19.647

你的查询不能写成：

```
SELECT u1.name as UserName from Message m1, User u1 
  WHERE u1.uid = m1.UserFromID GROUP BY u1.name HAVING count(m1.UserFromId)>3 
```

这也应该有助于解决 MySQL 中子查询的已知速度问题

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T19:38:01.940

这似乎是一个已知问题。

[http://dev.mysql.com/doc/refman/5.1/en/unnamed-views.html](http://dev.mysql.com/doc/refman/5.1/en/unnamed-views.html)

[http://bugs.mysql.com/bug.php?id=16757](http://bugs.mysql.com/bug.php?id=16757)

许多 IN 查询可以重写为（左外）连接和某种 IS (NOT) NULL。例如

```
SELECT * FROM FOO WHERE ID IN (SELECT ID FROM FOO2) 
```

可以重写为

```
SELECT FOO.* FROM FOO JOIN FOO2 ON FOO.ID=FOO2.ID 
```

或者

```
SELECT * FROM FOO WHERE ID NOT IN (SELECT ID FROM FOO2) 
```

可

```
SELECT FOO.* FROM FOO 
LEFT OUTER JOIN FOO2 
ON FOO.ID=FOO2.ID WHERE FOO.ID IS NULL 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-27T09:45:27.977

您可以通过为要使用的任何子查询创建单独的 VIEW 来解决此问题，然后在您正在创建的 VIEW 中加入该视图。这是一个例子：http: [//blog.gruffdavies.com/2015/01/25/a-neat-mysql-hack-to-create-a-view-with-subquery-in-the-from-clause/](http://blog.gruffdavies.com/2015/01/25/a-neat-mysql-hack-to-create-a-view-with-subquery-in-the-from-clause/)

这非常方便，因为您很可能希望重用它并帮助您保持 SQL DRY。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-11T22:17:09.517

为每个子查询创建一个视图是要走的路。让它像魅力一样工作。

# database - Visio 数据库图表，关联列

> ID：206070
> 
> 赞同：10
> 
> 时间：2008-10-15T19:27:44.287
> 
> 标签：database, diagram, visio

在开始编写下一个项目之前，我正在努力成为一名优秀的开发人员并创建一些文档。

我在 Visio 中创建了一个数据库架构图并创建了列之间的关系。

但是，我正在寻找一种方法来使列之间的关系更加清晰。我希望箭头将列连接到列。

有没有办法在 Visio 中做到这一点？

![http://i.stack.imgur.com/sj0Bo.jpg](https://i.stack.imgur.com/sj0Bo.jpg)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T06:41:05.770

您可以使用 Visio 绘图工具强制关系连接器粘合到表格形状上的特定连接点：

1.  在视图菜单中打开连接点。
2.  在标准工具栏上找到指针工具右侧的连接器工具。单击小箭头并更改为连接点工具。
3.  按住 Ctrl 并在要加入关系连接器的位置单击其中一个表格形状。
4.  在另一个表格形状上做同样的事情。
5.  将关系连接器的末端粘贴到您刚刚添加的连接点上。
6.  你会破坏关系。要修复它，请选择关系连接器并在数据库属性窗口中查看关系的定义。
7.  再次关联字段。

（这是使用 Visio Enterprise 2003 测试的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T20:33:31.033

如果单击关系箭头，将出现绿色中点。您可以使用它们上下拖动关系箭头。但请注意不要移动端点，因为 Visio 会取消该连接器与表对象的关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T19:36:55.937

据我所知，这就是 visio 绘制它的方式，并且不可能让它指向一个确切的列。有点烦人，但我想你学会了忍受 FK 标记

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T22:59:12.923

答案是不会，但是您可以单击并拖动线条。我用来解决这个问题的方法是命名 FK 关系并显示名称（在 Database->Options 中有一个选项可以执行此操作）或用列标记关系。

# user-interface - 描述时间范围的最佳 GUI 控件

> ID：206092
> 
> 赞同：18
> 
> 时间：2008-10-15T19:33:02.467
> 
> 标签：user-interface

我需要让最终用户指定一个时间范围，作为开始日期/时间和结束日期/时间在内部存储和使用。范围可以是几分钟，也可以是几天。

**有没有人发现可以优雅地处理这个的交互式控件？**

大多数 GUI 工具包都有一个日历控件，所以我可以用日历指定“开始”，用文本字段指定时间……“结束”也一样。

我还可以用单个文本字段或滑块替换“结束”控件，该文本字段或滑块仅描述开始“结束”后的秒数/分钟/小时数。

我不喜欢这些想法的是需要多少点击、打字和更​​多点击才能描述这样一个简单的概念。此外，如果输入的时间无法识别为时间，我也必须拍打用户的手。

有没有我忽略的更清洁的实现？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T22:11:53.440

当我思考诸如此类的问题时，我倾向于从常见的设计模式中寻找灵感。

[Yahoo Pattern Library](http://developer.yahoo.com/ypatterns/)提供[了一些潜在](http://developer.yahoo.com/ypatterns/pattern.php?pattern=calendar)的解决方案。

[UI Patterns 站点](http://ui-patterns.com)也[给出了一些建议](http://ui-patterns.com/pattern/StructuredFormat)，值得一读。

为了更好地衡量，这[是 Welie 模式库中的另一个解决方案](http://www.welie.com/patterns/showPattern.php?patternID=date-selector)。

另一个灵感来源可能是其他网站和应用程序。例如，考虑需要记录短时间和长时间持续时间的所有用例。例如，公司 TimeSheet 记录、公司汽车里程记录软件、任务记录软件、秒表应用程序、日历应用程序等。然后看看他们如何处理用于捕获时间范围的 GUI 控件。

我个人还没有找到最喜欢的选择日期*和*时间的解决方案。但是，我想我想要这样的东西。

*   用户单击以显示日历弹出窗口
*   弹出窗口显示**2**个并排日历（开始日期/时间和结束日期/时间）
*   日历 1 显示今天的日期，另一个也显示今天的日期。
*   日历控件允许通常导航和选择日月年。
*   每个日历下方是一个 hh:mm 框，默认为当前时间。
*   用户可以使用向上/向下箭头或键入来编辑此时间框中的值。
*   或者，在每个日历下方显示一个模拟时钟。设置时间需要点击 2 次鼠标（点击 1 小时，点击 2 分钟）。

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T22:20:49.923

我是 90 年代在 SGI 机器（然后是 PC 等）上使用 Inventor（以及后来的 Open Inventor）的旧控件的粉丝：无限拨号。

一些截图，有点偏小，在[这里](http://www.wheatchex.com/projects/graphics/07_inventor/man.jpg)。当然，从那以后，它已经在各种平台上完成，包括[iphone](http://ipod.about.com/od/iphoneinterfacegallery/ig/iPhone-Gallery--Widgets/iPhone-Widgets--Timer.htm)上的类似事情。

我认为日期/时间选择器可以很好地与两个表盘配合使用，每个表盘代表一个日期/时间数量级。在 ASCII 艺术中，在 [方括号] 之间的每个刻度盘可能看起来像：

```
[20 Oct | 21 OCT | 22 Oct ] [11:15 .. 11:30 .. 11:45..] 
```

或 3：

```
[20 Oct | 21 OCT | 22 Oct ] [11 .. 12 .. 1pm] [12:31 .. 12:32 .. 12:33] 
```

您可以尝试多种变化（垂直/水平、日期/时间、日期/小时/分钟等）。

表盘虽然很少使用，但它是人类与之交互的自然设备，并且它们的无限旋转选项（与必须始终停止的幻灯片不同）非常适合日期/时间。

FWIW

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T22:13:00.600

用户界面设计严重依赖于应用程序。“最佳”意味着某种可以衡量解决方案的指标。在 UI 设计中，这样的指标可以是“完成任务需要多次点击/按键吗？” 数字越小越好。因此，一旦您定义了指标，您就可以开始将解决方案分类为好、更好和最好的。

您还希望减轻用户的认知负担。如果用户必须根据 90 天退货政策输入可以更换产品的最后一天，那么询问开始和结束日期将迫使他们进行日期计算，这并不好玩。在此示例中，“增量”为 x 天的开始日期将减轻用户的负担。

根据您的应用程序，您可以考虑并使用其图表上的 Google Finance 时间范围选择器：http: [//finance.google.com/finance?q =.dji](http://finance.google.com/finance?q=.dji)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:05:26.147

没有单一的答案，这取决于上下文。对于很多地方来说，好的文本控件就足够了。当然，这些事情仍然可以通过支持粘贴和一些增加/减少操作来提供帮助。也许它甚至可以对价值做一些验证。

然后有些地方需要更多的东西。日历对于输入日期非常有帮助，并且可以使用某种滑块来显示时间。（Lotus Notes 日历有一个滑块。）

我的建议是：

想想你需要什么。不要将复杂的小部件放在使用较少的对话框中。

如果您需要这些有用的小部件，请检查您正在使用的库中是否有现成的小部件，并花一些时间看看其他人是如何完成这些的。

始终拥有支持粘贴的文本控件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T22:22:22.717

查看[VisualHint](http://www.visualhint.com/index.php/fieldpackeditor/) 日期控件。它可以配置多种方式，包括时间跨度。这将允许您使用一个控件实例来显示开始时间，并使用另一个控件实例来设置时间跨度，直到该时间段完成。该控件还支持可扩展的基本框架，因此您可以将 start/end 或 start/span 组合到一个控件中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-20T17:58:09.193

这里还有一些解决方案：http: [//quince.infragistics.com/html/PatternView.aspx ?name=Date+Time+Range+Input](http://quince.infragistics.com/html/PatternView.aspx?name=Date+Time+Range+Input)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T20:08:11.023

除非您选择的 GUI 工具包中有更高级的时间控件，否则表示开始和结束的两个日历控件是最直接的。此外，您需要决定如何使用这些信息。例如，如果您使用开始日期和间隔来增加该日期，则更改开始日期不会改变间隔的含义。这真的取决于你想要做什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T20:16:17.027

我看到工作得很好的一种方法是使用甘特图：
[http](http://en.wikipedia.org/wiki/Gantt_chart)

://en.wikipedia.org/wiki/Gantt_chart 您可以创建一个单一的折线图，然后您可以根据月、日、小时和分钟对其进行缩放关于控制的宽度或放大程度。问题是我现在不知道有任何控制只做一行，所以你可能需要创建一个自定义的。您可能会寻找甘特图控件并只执行一项任务/项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T20:52:23.320

通过您的时间范围控制观察人们在做什么。然后编写它，使其最适合做人们想要用它实现的目标。例如，如果只输入未来日期才有意义，请忽略过去的日期。

Jonathan Leighton 在 jquery 中制作了一个不错的[日期输入器元素](http://jonathanleighton.com/projects/date-input)，我发现它非常适合输入日期。这是有益的，用户可以通过单击或直接输入日期来输入日期。用户还可以直接得到关于将其输入框中的提示。如果你把它与某种时间线对象结合起来，你实际上可能会走得很远。只是避免制作令人困惑或愤怒的 UI 元素！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-06T03:17:15.720

这来晚了，它本身不是一个控制。我在一个我再也找不到的博客上读到了这个想法（事实上，我在试图找到它时发现了这篇文章）。这个想法是使用挂钟的比喻。这是我为了好玩而实现的。它不是功能控件。您可以使用这样的东西作为自然捕捉时间的起点。最多点击三下，大多数时候点击两次。只有刻度盘靠近。

[http://www.viridium.ro/clock-sample/](http://www.viridium.ro/clock-sample/)

使用支持 HTML5 的浏览器；也就是铬。

# recursion - 递归和大 O

> ID：206094
> 
> 赞同：12
> 
> 时间：2008-10-15T19:33:08.533
> 
> 标签：recursion, computer-science, complexity-theory, big-o

我一直在完成最近的计算机科学作业，涉及递归和大 O 表示法。我相信我非常了解这一点（当然，当然不完美！）但是有一个问题特别给我带来了最多的问题。奇怪的是，看着它，它看起来是作业中最简单的一个。

使用 big-Oh 表示法提供最佳增长率来解决以下递归？

T(1) = 2

T(n) = 2T(n - 1) + 1 对于 n>1

选择是：

*   O(n log n)
*   O(n^2)
*   O(2^n)
*   O(n^n)

我知道大 O 用作上限，用于描述该程序或进程将花费的最多计算量或最长运行时间。我觉得这个特定的递归应该是 O(n)，因为对于每个 n 值，递归最多只发生一次。由于 n 不可用，它要么比这更好，O(nlogn)，要么更糟，成为其他三个选项。

所以，我的问题是：为什么不是 O(n)？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-15T20:05:39.140

有几种不同的方法可以解决递归：替换、递归树和主定理。主定理在这种情况下不起作用，因为它不符合主定理形式。

您可以使用其他两种方法，但解决此问题的最简单方法是迭代解决。

T(n) = 2T(n-1) + 1
T(n) = 4T(n-2) + 2 + 1
T(n) = 8T(n-3) + 4 + 2 + 1
T(n) = ...

看到图案了吗？

T(n) = 2 ^(n-1) ⋅T(1) + 2 ^(n-2) + 2 ^(n-3) + ... + 1
T(n) = 2 ^(n-1) ⋅2 + 2 ^(n-2) + 2 ^(n- 3) + ... + 1
T(n) = 2 ^n + 2 ^(n-2) + 2 ^(n-3) + ... + 1

因此，最严格的界限是 Θ(2 ^n )。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-15T19:37:53.563

我想你有点误解了这个问题。它不会问您解决复发需要多长时间。它询问解决方案本身的大 O（渐近界）是什么。

你要做的是想出一个封闭形式的解决方案，即T(n)的非递归公式，然后确定那个表达式的大O是什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T19:36:39.353

我认为这将是指数级的。每次增加 n 都会使值增加一倍。

```
T(2) = 2 * T(1) = 4
T(3) = 2 * T(2) = 2 * 4
... 
```

T(x) 将是以下程序的运行时间（例如）：

```
def fn(x):
 if (x == 1):
  return    # a constant time
 # do the calculation for n - 1 twice
 fn(x - 1)
 fn(x - 1) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T19:41:00.687

问题是要求求解递归的大哦符号，而不是计算递归的成本。

换句话说：重复产生：

```
 1 -> 2
  2 -> 5
  3 -> 11
  4 -> 23
  5 -> 47 
```

什么大哦符号最能描述序列 2, 5, 11, 23, 47, ...

解决这个问题的正确方法是求解递推方程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T19:38:37.183

> 我认为这将是指数级的。n 的每一个增量都会带来两倍的计算量。

不，它没有。恰恰相反：

考虑对于*n*次迭代，我们得到运行时间*R。*然后对于*n* + 1 次迭代，我们将准确地得到*R* + 1。

因此，增长率是恒定的，整体运行时间确实是*O* ( *n* )。

但是，我认为 Dima 对这个问题的假设是正确的，尽管他的解决方案过于复杂：

> 你要做的是想出一个封闭形式的解决方案，即T(n)的非递归公式，然后确定那个表达式的大O是什么。

*检查T* ( *n* ) 和*T* ( *n* + 1) 迭代的相对大小并确定相对增长率就足够了。数量明显翻倍，直接给出了渐近增长。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T22:01:08.080

首先，所有四个答案都比 O(n) 差... O(n*log n) 比普通的旧 O(n) 更复杂。更大的：8 或 8 * 3、16 或 16 * 4 等...

关于实际问题。如果您不进行递归，则通用解决方案显然可以在恒定时间内解决

（ T(n) = 2^(n - 1) + 2^(n) - 1 ），所以这不是他们要的。

如您所见，如果我们编写递归代码：

```
int T( int N )
{
    if (N == 1) return 2;
    return( 2*T(N-1) + 1);
} 
```

这显然是 O(n)。

所以，这似乎是一个措辞不好的问题，他们可能问的是函数本身的增长，而不是代码的复杂性。那是 2^n。现在去做剩下的作业......然后学习 O(n * log n)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-15T22:29:17.617

计算递归的封闭形式解决方案很容易。通过检查，您猜测解决方案是

```
T(n) = 3*2^(n-1) - 1
```

然后你通过归纳证明这确实是一个解决方案。基本情况：

```
T(1) = 3*2^0 - 1 = 3 - 1 = 2。好的。
```

就职：

```
假设 T(n) = 3*2^(n-1) - 1。那么
T(n+1) = 2*T(n) + 1 = 3*2^n - 2 + 1 = 3*2^((n+1)-1) - 1。好的。

```

其中第一个等式源于递归定义，第二个源于归纳假设。QED。

3*2^(n-1) - 1 显然是 Theta(2^n)，因此正确答案是第三个。

对于回答 O(n) 的人：我完全同意 Dima。该问题不**要求**计算 T(n) 的算法的计算复杂度的最严格上限（现在为 O(1)，因为已经提供了它的封闭形式）。*该问题要求T(n) 本身*的最严格上限，即指数上限。

# c# - 允许在 .NET TreeView 中进行多选

> ID：206096
> 
> 赞同：25
> 
> 时间：2008-10-15T19:33:24.370
> 
> 标签：c#, .net, winforms, .net-2.0, treeview

我被困在 .NET 2.0 Windows 窗体中。

`TreeView`标准控件中似乎不存在选择多个节点的功能。

我正在尝试为上下文菜单选择执行此操作。因此，复选框在这里不是可接受的 UI 范例。

提供非常必要的功能的最佳方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T19:52:37.810

我们曾经在一个 WTL 项目中这样做过，但所需的基本工作与 .NET 相同。要实现多选树控件，您需要自己绘制树项目并覆盖键盘和鼠标处理。您还需要维护自己的选定项目列表。

不要忘记考虑选择规则（例如是否允许父母和孩子），不要忘记实现键盘快捷键，包括使用 Ctrl、Shift 和 Ctrl+Shift 进行选择，以及用于选择/取消选择的空格键.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T19:35:48.373

[TreeView.CheckBoxes](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.checkboxes.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T19:36:26.670

复选框是一个选项吗？还是您希望像在列表框中一样进行选择？

*   复选框是内置的
*   像在列表框中一样选择需要自定义树控件

CodeProject 上有一个多选树控件：[Multi-Select Tree View](http://www.codeproject.com/KB/tree/MWTreeViewv2010.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-03T11:49:47.717

最简单的解决方案是扩展框架附带的现有 TreeView 控件，并使用逻辑覆盖 OnBeforeSelect 和 OnAfterSelect 方法以捕获多个选择。

一个例子可以在这里找到：[http ://www.arstdesign.com/articles/treeviewms.html](http://www.arstdesign.com/articles/treeviewms.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-03-25T23:07:38.827

下面的代码将允许您调整使用的背景颜色，以确保突出显示所有选定的节点。

```
protected override void WndProc(ref Message m)
{
    switch (m.Msg) {
        // WM_REFLECT is added because WM_NOTIFY is normally sent just
        // to the parent window, but Windows.Form will reflect it back
        // to us, MFC-style.
        case Win32.WM_REFLECT + Win32.WM_NOTIFY: {
            Win32.NMHDR nmhdr = (Win32.NMHDR)m.GetLParam(typeof(Win32.NMHDR));
            switch((int)nmhdr.code) {
                case Win32.NM_CUSTOMDRAW:
                    base.WndProc(ref m);
                    Win32.NMTVCUSTOMDRAW nmTvDraw = (Win32.NMTVCUSTOMDRAW)m.GetLParam(typeof(Win32.NMTVCUSTOMDRAW));
                    switch (nmTvDraw.nmcd.dwDrawStage) {
                        case Win32.CDDS_ITEMPREPAINT:
                            // Find the node being painted.
                            TreeNode n = TreeNode.FromHandle(this, nmTvDraw.nmcd.lItemlParam);
                            if (allSelected.Contains(n))
                                // Override its background colour.
                                nmTvDraw.clrTextBk = ColorTranslator.ToWin32(SystemColors.Highlight);
                            m.Result = (IntPtr)Win32.CDRF_DODEFAULT;  // Continue rest of painting as normal
                            break;
                    }
                    Marshal.StructureToPtr(nmTvDraw, m.LParam, false);  // copy changes back
                    return;
            }
            break;
        }
    }
    base.WndProc(ref m);
}

// WM_NOTIFY notification message header.
[System.Runtime.InteropServices.StructLayout(LayoutKind.Sequential)]
public class NMHDR
{
    private IntPtr hwndFrom;
    public IntPtr idFrom;
    public uint code;
}

[StructLayout(LayoutKind.Sequential)]
public struct NMCUSTOMDRAW
{
    public NMHDR hdr;
    public int dwDrawStage;
    public IntPtr hdc;
    public RECT rc;
    public IntPtr dwItemSpec;
    public int uItemState;
    public IntPtr lItemlParam;
}

[StructLayout(LayoutKind.Sequential)]
public struct NMTVCUSTOMDRAW
{
    public NMCUSTOMDRAW nmcd;
    public int clrText;
    public int clrTextBk;
    public int iLevel;
}

public const int CDIS_SELECTED = 0x0001;
public const int CDIS_FOCUS = 0x0010;
public const int CDDS_PREPAINT = 0x00000001;
public const int CDDS_POSTPAINT = 0x00000002;
public const int CDDS_PREERASE = 0x00000003;
public const int CDDS_POSTERASE = 0x00000004;
public const int CDDS_ITEM = 0x00010000;  // item specific 
public const int CDDS_ITEMPREPAINT = (CDDS_ITEM | CDDS_PREPAINT);
public const int CDDS_ITEMPOSTPAINT = (CDDS_ITEM | CDDS_POSTPAINT);
public const int CDDS_ITEMPREERASE = (CDDS_ITEM | CDDS_PREERASE);
public const int CDDS_ITEMPOSTERASE = (CDDS_ITEM | CDDS_POSTERASE);
public const int CDDS_SUBITEM = 0x00020000;
public const int CDRF_DODEFAULT = 0x00000000;
public const int CDRF_NOTIFYITEMDRAW = 0x00000020;
public const int CDRF_NOTIFYSUBITEMDRAW = 0x00000020;  // flags are the same, we can distinguish by context

public const int WM_USER = 0x0400;
public const int WM_NOTIFY = 0x4E;
public const int WM_REFLECT = WM_USER + 0x1C00; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-15T20:24:28.960

您可能会查看第 3 方解决方案。[Infragistics](http://www.infragistics.com)树就是这样做的。不是免费的，但花在寻找解决方案上的时间也不是真正免费的。

# c++ - 是 ！！在 C++ 中转换为 bool 的安全方法？

> ID：206106
> 
> 赞同：52
> 
> 时间：2008-10-15T19:35:53.693
> 
> 标签：c++, visual-c++, boolean

*[[此问题与此](https://stackoverflow.com/questions/206564/what-is-the-performance-implication-of-converting-to-bool-in-c)问题相关但不同。]*

如果我尝试使用某些类型的值作为布尔表达式，我会收到警告。`?:`我有时会使用三元运算符 ( ) 来转换为布尔值，而不是抑制警告。使用两个非运算符 ( `!!`) 似乎做同样的事情。

这就是我的意思：

```
typedef long T;       // similar warning with void * or double
T t = 0;
bool b = t;           // performance warning: forcing 'long' value to 'bool'
b = t ? true : false; // ok
b = !!t;              // any different? 
```

那么，双重不技术真的做同样的事情吗？它比三元技术更安全还是更安全？这种技术对于非整数类型（例如 with`void *`或`double`for `T`）是否同样安全？

我不是在问是否`!!t`是好风格。我在问它是否在语义上不同于`t ? true : false`.

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-15T20:07:30.010

的论点！运算符和三元运算符的第一个参数都隐式转换为布尔值，所以 !! 和？：是 IMO 愚蠢的演员阵容多余的装饰。我投票给

```
b = (t != 0); 
```

没有隐式转换。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-15T19:39:43.933

或者，您可以这样做：`bool b = (t != 0)`

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-10-15T20:35:59.780

小心！

*   布尔值是关于真假。
*   整数大约是整数。

这些是非常不同的概念：

*   真与假是关于决定事物的。
*   数字是关于计数的东西。

在桥接这些概念时，应该明确地完成。我最喜欢 Dima 的版本：

`b = (t != 0);`

该代码清楚地表明：比较两个数字并将真值存储在布尔值中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-15T19:38:41.520

所有有效的技术，都将生成相同的代码。

就个人而言，我只是禁用了警告，这样我就可以使用最简洁的语法。转换为 bool 并不是我担心会意外做的事情。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-15T19:41:20.437

是的，它是安全的。

0 被解释为假，其他一切都为真，
因此 !5 为假
！0 为真
，所以 !!5 为真

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-15T20:10:42.623

我不会使用：

```
bool b = !!t; 
```

这是最不可读的方式（因此最难维护）

其他的视情况而定。
如果您要转换为仅在布尔表达式中使用。

```
bool b = t ? true : false;
if (b)
{
    doSomething();
} 
```

然后我会让语言为你做这件事：

```
if (t)
{
    doSomething();
} 
```

如果您实际上存储的是布尔值。那么首先我想知道为什么你首先需要演员阵容。假设您需要 long 和 bool 值，我会根据情况考虑以下所有内容。

```
bool  b = t ? true : false;      // Short and too the point.
                                 // But not everybody groks this especially beginners.
bool  b = (t != 0);              // Gives the exact meaning of what you want to do.
bool  b = static_cast<bool>(t);  // Implies that t has no semantic meaning
                                 // except as a bool in this context. 
```

总结：使用对你所处的环境最有意义的东西。
试着让你所做的事情变得显而易见

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-15T19:45:54.843

我建议永远不要抑制该警告，也不要使用 ac cast (bool) 来抑制它。转换可能并不总是像您假设的那样被调用。

计算结果为 true 的表达式和该值的布尔值之间存在差异。

两个都 ！！并且 ternary 习惯了，但是如果你不想用重载类型转换为 bool 来定义内部类型，它们会以类似的方式完成工作。

Dima 的方法也很好，因为它将表达式的值分配给布尔值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-15T19:40:36.833

如果您担心警告，也可以强制转换：`bool b = (bool)t;`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-15T21:08:59.370

我真的很讨厌!!t!!!!!!。它带有关于 C 和 C++ 最糟糕的东西的味道，即对你的语法过于聪明的诱惑。

布尔 b(t != 0); // 恕我直言，这是最好的方法，它明确显示正在发生的事情。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-05-25T06:39:53.023

与 0 的比较效果不太好。这又回来了-为什么！与三元？

```
class foo { public: explicit operator bool () ; };

foo f;

auto a = f != 0; // invalid operands to binary expression ('foo' and 'int')
auto b = f ? true : false; // ok
auto c = !!f; // ok 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-15T19:44:34.657

！！可能很紧凑，但我认为它不必要地复杂。在我看来，最好禁用警告或使用三元运算符。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-15T19:50:22.947

我会使用 b = (0 != t) - 至少任何理智的人都可以轻松阅读它。如果我在代码中看到双重问题，我会非常惊讶。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-15T22:20:15.263

禁用警告。

先写清楚；然后简介；然后在需要时优化速度。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-15T23:58:14.240

！！仅当您以算术方式使用布尔表达式时才有用，例如：

```
c = 3 + !!extra; //3 or 4 
```

（谁的风格是不同的讨论。）当你只需要一个布尔表达式时，!! 是多余的。写作

```
bool b = !!extra; 
```

与以下内容一样有意义：

```
if (!!extra) { ... } 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-15T20:31:00.837

我建议使用

如果 (x != 0)

或者

如果 (x != NULL)

而不是 if(x)；它更易于理解和阅读。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2008-10-15T19:45:53.407

双重对我来说并不好笑，并且在调试代码中将与优化代码中的非常不同。

如果你爱上了！！你总是可以宏它。

```
#define LONGTOBOOL(x) (!!(x)) 
```

（顺便说一句，在这些情况下，我更喜欢三元运算符）

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2008-10-15T20:25:00.943

我会使用 bool b = t 并留下编译警告，评论这一特定行的安全性。禁用警告可能会在代码的另一部分中咬你。

# database - 您登录到您的数据库，当您的数据库关闭时您在哪里登录？

> ID：206112
> 
> 赞同：2
> 
> 时间：2008-10-15T19:37:10.210
> 
> 标签：database, logging

我正在[使用 Pear 登录 PHP](http://pear.php.net/package/Log)，我遇到了一个标准问题：当数据库不可用时，我可以使用基于文件的日志记录吗？我不介意它是否由于并发问题而变慢，但它不会由于多个同时命中而无法工作。

我在一般情况下问这个问题（对于其他网络技术），特别是对于 PHP 的 Pear。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T19:07:36.040

通常，如果您无法连接到数据库，则记录到文件系统是一个很好的选择。同时命中应该不是问题（锁定......）。如果您已经为数据库调整了日志，那么最简单的方法可能是使用 sqlite 作为后备。

在这种情况下，另一种方法是通过电子邮件发送日志事件，除了不丢失它们之外，这种方法应该让您更快地意识到您的数据库问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T20:11:32.060

您可以将现有的数据库对象传递给[Log 的单例方法](http://www.csh.rit.edu/~jon/projects/pear/Log/guide.html#the-sql-db-handler)- 如果您没有数据库，则可以恢复为替代的日志记录方法（或旧的 user_error()）

```
require_once 'DB.php';
$db = &DB::connect('pgsql://jon@localhost+unix/logs');

$conf['db'] = $db;
$logger = &Log::singleton('sql', 'log_table', 'ident', $conf); 
```

# user-interface - 模态对话框是网络的好习惯吗？

> ID：206113
> 
> 赞同：18
> 
> 时间：2008-10-15T19:37:10.540
> 
> 标签：user-interface, modal-dialog

[模态窗口/对话框](http://jquery.com/demo/thickbox/)是否被认为是网站的好习惯？使用模式窗口让我担心的一件事是它非常像一个弹出窗口，它可能会导致用户沮丧或导致用户简单地关闭它，因为它是侵入性的。你知道任何关于用户偏好和使用率的研究吗？

关闭 JavaScript 后，除了让模态窗口链接在新页面中加载内容之外，是否还有任何可访问性问题？您*喜欢*使用模态窗口的网站或 Web 应用程序吗？为什么或者为什么不？实现模态窗口的好的和坏的做法是什么？我知道在显示图片或画廊时最常使用模态框，但还有哪些其他实际用例？您是否在您的网站上使用它们？是什么导致您做出决定？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T19:43:32.587

从实践的角度来看 - 不包括可访问性 - 模态窗口提供了一种替代方案，它不像对话框那样令人吃惊，并且感觉不像弹出窗口那样具有侵入性。与上述两种方法中的任何一种相比，它们通常对网站具有更强的凝聚力。除了图片或媒体之外，我还使用模式对话框来实现与对话框相同的目的——让用户提供某种形式的所需输入，或者在让他们再次与站点交互之前确认某些内容。

从纯粹可访问的角度来看，它们并不是那么好。它们通常需要 JavaScript，并且由于模态控件相对于 DOM 的管理方式，屏幕阅读器无法很好地解释它们。为了解决这个问题，优雅地降级总是一个好主意 - 一个建议是获取模式对话框的内容并将其放置在页面上。每当模态对话框出现*时*，将当前页面重定向到“模态页面”，获取用户的输入，然后返回到它所在的页面。

最后，就我个人的看法而言，我不介意模态窗口。我认为，如果使用得当，它们会提供不错的体验——如果**有**什么事情需要引起我的注意，那么我宁愿这样做，而不是从页面重定向我，显示丑陋的操作系统主题对话框或弹出窗口（无论如何，我的浏览器可能会阻止）。我想，总而言之，如果我必须选择*我*想被打断的方式，那么我会选择一个模态对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-23T19:03:51.067

似乎许多人将模态窗口与分层面板混淆了。对话框可以是模态窗口，弹出窗口是模态窗口。分层面板不是窗口，而是具有弹出窗口或对话框的外观。在底层不可用的意义上，它是模态的。模态窗口在网站上很受欢迎，因为它们不受弹出窗口阻止程序的影响。

模态窗口旨在获取底层应用程序继续运行所需的信息或用户操作。非模态窗口允许用户在窗口和底层应用程序之间来回切换。非模态窗口的一个很好的用途可能是屏幕帮助或教程，用户需要一个参考工具并访问底层应用程序。

恕我直言，模态窗口是为狭窄的特定目的而设计的，现在很多时候使用不当。仅仅因为你可以做某事并不意味着你应该做！:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T19:48:51.687

我只在网络应用程序上使用模态窗口来解决需要用户全神贯注的简单问题或操作，这就是模态的作用，“忘记背景”并专注于应用程序的要求......

例子：

“允许的最大贷款已达到上限，您确定要将这笔新贷款发送给客户吗？”

例如，选择用于发送电子邮件的前置文本（一个模式窗口，可用于正确的主题和正文文本或选择预定义的主题/正文以发送给客户......

类似的东西 ：）

我做了很多财务网络应用程序，这些应用程序从用户输入所有财务数据的网站到通过 PDF 发送合同，只需点击几下即可完成，这些都是我使用模式窗口的操作。

希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T19:58:56.267

37Signals 在[这里](http://www.37signals.com/svn/posts/1149-modal-overlays-beyond-the-dialog-box)有一篇关于模态的有趣帖子。他们谈论使用模态来通过屏幕大小来指示重要性，其中模态覆盖不够重要以至于需要导航到新页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T20:07:50.947

我经常在 Web 应用程序中使用模式窗口作为数据输入屏幕。例如，用户将有一个列表或搜索结果屏幕，并且可以单击记录以在模式窗口中将其打开以进行编辑。我不喜欢在网站中使用模态窗口，因为我更喜欢稍微少一点的“应用程序”，比如网站的感觉。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T21:41:17.527

网络上对话的大部分问题都集中在执行不力上。一些考虑因素包括：

*   屏幕尺寸
*   浏览器窗口大小调整
*   在哪里打开对话框
*   提交表单元素
*   苛刻的叠加频闪灯效果
*   优雅降级（如前所述）

所有这些都可以通过一些深思熟虑和编程技术轻松克服，如果实施得当，网络上的对话框非常有用。

# file - 批处理文件：如何读取文件？

> ID：206114
> 
> 赞同：109
> 
> 时间：2008-10-15T19:37:39.430
> 
> 标签：file, batch-file

如何从批处理文件中读取文件（文本或二进制文件）？有没有办法以二进制模式或文本模式读取它？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-15T19:45:02.597

在 NT 风格的 cmd.exe 下，您可以使用

```
FOR /F %%i IN (file.txt) DO @echo %%i 
```

在命令提示符下键入“帮助”以获取更多信息。（不知道这是否适用于您使用的任何“DOS”）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2010-12-25T17:54:47.933

FOR-LOOP 通常可以工作，但也有一些问题。FOR 不接受空行和超过 ~8190 的行是有问题的。如果延迟扩展被禁用，扩展只能可靠地工作。

CR/LF 与单个 LF 的检测似乎也有点复杂。
NUL 字符也是有问题的，因为 FOR 循环会立即取消读取。

*因此，直接*二进制读取似乎几乎是不可能的。

空行的问题可以通过一个技巧来解决。使用 findstr 命令为每行添加一个行号前缀，并在阅读后删除前缀。

```
@echo off
SETLOCAL DisableDelayedExpansion
FOR /F "usebackq delims=" %%a in (`"findstr /n ^^ t.txt"`) do (
    set "var=%%a"
    SETLOCAL EnableDelayedExpansion
    set "var=!var:*:=!"
    echo(!var!
    ENDLOCAL
) 
```

**在启用和禁用延迟扩展之间切换**对于安全使用字符串（如`!`or ）是必要的`^^^xy!z`。
这是因为该行`set "var=%%a"`仅在*DisabledDelayedExpansion*时是安全的，否则会删除感叹号，并且插入符号用作（辅助）转义字符并且它们也被删除。
但是只有*EnabledDelayedExpansion*`var`才能安全地使用该变量，因为即使是 a也会因.*`call %%var%%``"&"&`*

 ***编辑：添加了 set/p 变体**
还有第二种读取文件的方法`set /p`，唯一的缺点是它被限制为每行约 1024 个字符，并且它删除了行尾的控制字符。
但优点是，您不需要延迟切换，并且更容易将值存储在变量中

```
@echo off
setlocal EnableDelayedExpansion
set "file=%~1"

for /f "delims=" %%n in ('find /c /v "" %file%') do set "len=%%n"
set "len=!len:*: =!"

<%file% (
  for /l %%l in (1 1 !len!) do (
    set "line="
    set /p "line="
    echo(!line!
  )
) 
```

**将其“二进制”读入十六进制表示**
您可以查看[SO：使用批处理文件将二进制文件转换为十六进制表示](https://stackoverflow.com/a/4648636/463115)

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-15T19:47:00.003

您可以使用 for 命令：

```
FOR /F "eol=; tokens=2,3* delims=, " %i in (myfile.txt) do @echo %i %j %k 
```

类型

```
for /? 
```

在命令提示符下。此外，您可以[解析 ini 文件](http://www.ericphelps.com/batch/samples/getini.txt)！

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2017-08-10T23:28:37.983

一种非常简单的方法是使用以下命令：

```
set /p mytextfile=< %pathtotextfile%\textfile.txt
echo %mytextfile% 
```

这只会显示文本文件中的第一行文本。另一种方法是使用以下命令：

```
type %pathtotextfile%\textfile.txt 
```

这会将所有数据放在屏幕上的文本文件中。希望这可以帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-13T21:32:02.830

好吧，有很多不同的方法，但是如果您只想显示文本而不想在任何地方存储它，那么您只需使用：`findstr /v "randomtextthatnoonewilluse" filename.txt`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-14T14:29:18.527

更正的代码：

```
setlocal enabledelayedexpansion
for /f "usebackq eol= tokens=* delims= " %%a in (`findstr /n ^^^^ "name with spaces.txt"`) do (
    set line=%%a
    set "line=!line:*:=!"
    echo(!line!
)
endlocal
pause 
```

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2018-10-18T15:29:02.733

**在屏幕上显示 myfile.txt 文件内容的代码**

设置 %filecontent%=0
类型 %filename% >> %filecontent%
echo %filecontent%

# asp.net - 如何配置 IIS 以处理非常大的文件上传？

> ID：206132
> 
> 赞同：9
> 
> 时间：2008-10-15T19:42:16.533
> 
> 标签：asp.net, iis-6, file-upload

平台：IIS 6、ASP.Net 2.0 (.Net 3.5)、Server 2003。

我正在构建一个应用程序，它接受来自用户的文件、处理它们并返回结果。该文件使用 HTTP POST 上传到 ASP.Net Web 表单。该应用程序需要一些大文件（数百 MB）。

我正在使用 SWFUpload 通过一个不错的进度条完成上传，但这并没有导致问题，因为当我使用指向我的上传接受页面的标准 HTML 表单绕过它时，我得到了完全相同的错误。使用进度条时，上传继续到 100%，然后失败。使用标准形式，行为似乎是相同的。

我现在上传一个大约 150MB 的文件时遇到问题。我已经更改了我能找到的所有设置，但仍然没有运气。

以下是我到目前为止所做更改的摘要：

在 Web.config 中：在 system.web 中添加了这个：

```
<httpRuntime executionTimeout="3600" maxRequestLength="1536000"/> 
```

在 machine.config 中：在 system.web 中，更改：

```
<processModel autoConfig="true" /> 
```

到：

```
<processModel autoConfig="true" responseDeadlockInterval="00:30:00" responseRestartDeadlockInterval="00:30:00" /> 
```

并在 MetaBase.xml 中：更改：

```
AspMaxRequestEntityAllowed="204800" 
```

到：

```
AspMaxRequestEntityAllowed="200000000" 
```

上传失败时，我从 IIS 收到 404 错误。我的 Web 表单没有开始处理，或者至少没有进入 Page_Load 事件。我在该处理程序的开头抛出了一个异常，它根本不会在大文件上执行。

一切都适用于较小的文件（我已经测试了大约 5.5MB）。我不确定文件大小的限制是多少，但我知道我的限制需要高于 150MB，因为这不是客户端需要上传的最大文件。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T22:39:30.360

Urlscan 在所有网站上都处于活动状态，并且有自己的请求实体长度限制。我不知道 Urlscan 正在我们的服务器上运行，因为它是一个全局 ISAPI 过滤器，而不是在我的个人网站上运行。

注意：要找到全局 ISAPI 过滤器，请右键单击 IIS Admin 中的网站文件夹并单击属性，然后单击 ISAPI 过滤器选项卡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-12-19T21:48:37.813

（谷歌人的注意事项）：

对于 IIS7，将以下内容添加到 web.config（我在上面添加`<system.serviceModel>`）：

```
<system.webServer>
        <security>
            <requestFiltering><requestLimits maxAllowedContentLength="262144000" /></requestFiltering> <!-- maxAllowedContentLength is in bytes. Defaults to 30,000,000 -->
        </security>
</system.webServer> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T19:46:27.197

当我们遇到这个问题时，我们不得不根据这篇知识库文章增加缓冲区大小限制：http: [//support.microsoft.com/kb/944886/en-us](http://support.microsoft.com/kb/944886/en-us)

我知道这提到了 ASP，但我相信它也适用于 ASP.NET。

编辑：这是一个可能与您的问题更相关并提供其他选项的链接：
[http ://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net .aspx](http://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:00:57.450

404 和缺少 Page_Load：IIS 只能在服务器上完成完整的 POST 后处理请求。因此，如果 POST 失败（由于它的大小），它不能触发页面的事件。

你可以试试 NeatUpload [http://www.brettle.com/neatupload](http://www.brettle.com/neatupload)。来自手册：“默认情况下，NeatUpload 不直接限制上传的大小。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T13:47:43.877

你也可以试试[Velodoc XP 版本](http://www.codeplex.com/velodocxp)，它比 NeatUpload 有几个优点，包括它使用 ASP.NET Ajax 扩展。另请参阅[Velodoc 网站](http://www.velodoc.com)了解更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T04:32:00.317

你说：

但是1536000只有1.5MB？

# sql-server-2005 - 如何跨多个表使用全文搜索，SQL Server 2005

> ID：206142
> 
> 赞同：5
> 
> 时间：2008-10-15T19:46:29.757
> 
> 标签：sql-server-2005, full-text-search, multiple-tables

我有一个包含两个表格的全文目录。

tableA 有 4 列（a1、a2、a3、a4），其中 3 列在目录 a2、a3、a4 中建立索引。a1 是主键。

tableB 有 3 列（b1、b2、b3、b4），其中两列在目录中被索引，b3 和 b4。b1 是这个表的 PK，b2 是表 A 的 FK。

我想做类似的事情

```
SELECT *, (ftTableA.[RANK] + ftTableB.[RANK]) AS total_rank 
FROM tableA
INNER JOIN tableB ON tableA.a1=tableB.b2
INNER JOIN FREETEXTTABLE(tableA, (a2,a3,a4), 'search term') as ftTableA ON tableA.a1=ftTableA.[KEY]
INNER JOIN FREETEXTTABLE(tableB, (b3,b4), 'search term') as ftTableB ON tableB.11=ftTableB.[KEY] 
```

但这不起作用......我可以让一张桌子工作，例如。

```
SELECT *, (ftTableA.[RANK] + ftTableB.[RANK]) AS total_rank 
FROM tableA
INNER JOIN FREETEXTTABLE(tableA, (a2,a3,a4), 'search term') as ftTableA ON tableA.a1=ftTableA.[KEY] 
```

但从不超过一张桌子。

有人可以给出对多个表进行全文搜索所需的步骤的解释和/或示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T18:57:15.300

如果 A 和相关 B 都包含搜索文本，则您的查询仅返回记录。

但是，您没有说明什么不起作用。

为什么不 LEFT OUTER JOIN 全文搜索，并替换：

```
SELECT *, (ISNULL(ftTableA.[RANK], 0) + ISNULL(ftTableB.[RANK], 0)) AS total_rank 
```

和

```
WHERE ftTableA.Key IS NOT NULL OR ftTableB.Key IS NOT NULL 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T18:44:19.070

我不确定我理解你想要做什么。我将您的问题解释为您想要返回表 A 中与搜索词匹配的所有项目。此外，您想将 TableA 中的项目加上 TableB 中的匹配项目的排名相加。

我能想到的最好方法是使用带有 3 个查询的表变量。

```
DECLARE @Results 表（a1 Int UNIQUE，Rank Int）

--将TableA中的所有匹配项插入@Results
插入@Results
（a1，等级）
（选择表A.a1，FT.Rank
FROM TableA INNER JOIN FreeTextTable(TableA, *, 'search term') FT
ON TableA.A1 = FT.[键]
)

--用当前值的总和加上以下的总和更新@Results中的所有排名
--所有子项（在表B中）
更新@Results
SET Rank = RS.Rank + FT.Rank
FROM @Results RS INNER JOIN 表B
在 RS.A1 = 表 B.b2
INNER JOIN FreeTextTable(TableB, *, 'search term') FT
ON TableB.b1 = FT.[键]

--现在将任何在 TableB 中匹配但在 TableA 中不匹配的项目插入到 @Results
--根据您的业务规则，可能需要/可能不需要此查询。
插入@Results
(SkillKeyId, 等级)
( SELECT TableB.b2, Sum(FT.Rank)
FROM TableB INNER JOIN FreeTextTable(TableB, *, 'search term') FT
ON TableB.b1 = FT.[键]
左连接 @Result RS
开 RS.a1 = 表 B.b2
RS.a1 为空
按表分组B.b2
)

--剩下的就是返回结果
SELECT TableA.*, RS.Rank AS Total_Rank
从表 A 内连接 @Results RS
在表 A.a1 = RS.a1
ORDER BY RS.Rank DESC

```

这不像使用一个查询那样优雅，但它应该很容易理解，并允许您决定是否在第三个查询中包含记录。

# python - Python 存在哪些 SOAP 客户端库，它们的文档在哪里？

> ID：206154
> 
> 赞同：343
> 
> 时间：2008-10-15T19:50:07.550
> 
> 标签：python, soap, soap-client

我以前从未使用过[SOAP](http://en.wikipedia.org/wiki/SOAP)，而且我对 Python 有点陌生。我这样做是为了让自己熟悉这两种技术。我已经安装了[SOAPlib](http://trac.optio.webfactional.com/wiki/soaplib)，并尝试阅读他们的[Client](http://trac.optio.webfactional.com/wiki/Client)文档，但我不太了解它。还有什么我可以研究的更适合作为 Python 的 SOAP 客户端库的吗？

编辑：以防万一，我使用的是 Python 2.6。

* * *

## 回答 #1

> 赞同：404
> 
> 时间：2008-10-16T00:05:22.557

***更新（2016 年）：***

如果您只需要 SOAP 客户端，可以使用维护良好的库[zeep](https://pypi.org/project/zeep/)。它同时支持 Python 2 和 3 :)

* * *

***更新：***

除了上面提到的内容之外，我将参考[Python WebServices](https://wiki.python.org/moin/WebServices#SOAP)页面，该页面始终是最新的，其中包含所有积极维护和推荐的**SOAP**模块和所有其他 Web 服务类型。

* * *

不幸的是，目前，我认为没有“最好的”Python SOAP 库。每个可用的主流都有自己的优点和缺点。

旧图书馆：

*   [SOAPy](http://soapy.sourceforge.net)：是“最好的”，但不再维护。不适用于 Python 2.5+

*   [ZSI](http://pywebsvcs.sourceforge.net)：用起来很痛苦，开发也很慢。有一个名为“SOAPpy”的模块，它不同于 SOAPy（上图）。

“较新”的库：

*   [SUDS](https://fedorahosted.org/suds)：非常 Pythonic，易于创建消耗 WSDL 的 SOAP 客户端。创建 SOAP 服务器有点困难。（此包不适用于 Python3。对于 Python3，请参阅 SUDS-py3）

*   [SUDS-py3](https://pypi.org/project/suds-py3/)：SUDS 的 Python3 版本

*   [spyne](https://github.com/arskom/spyne)：创建服务器很容易，创建客户端更具挑战性。文档有些缺乏。

*   [ladon](http://pypi.python.org/pypi/ladon)：创建服务器很像在soaplib 中（使用装饰器）。Ladon 同时公开了比 SOAP 更多的接口，而无需额外的用户代码。

*   [pysimplesoap](http://code.google.com/p/pysimplesoap/)：非常轻量级，但对客户端和服务器都很有用 - 包括 web2py 附带的 web2py 服务器集成。

*   [SOAPpy](https://github.com/kiorky/SOAPpy)：与上面 ZSI 链接中托管的废弃 SOAPpy 不同，这个版本实际上一直维护到 2011 年，现在它似乎也被废弃了。
*   [soaplib](http://www.python.org/pypi/soaplib)：易于使用的python 库，用于编写和调用soap Web 服务。用soaplib 编写的Web 服务简单、轻量，可以与其他SOAP 实现很好地协同工作，并且可以部署为WSGI 应用程序。
*   [osa](https://bitbucket.org/sboz/osa)：一个快速/苗条的易于使用的 SOAP python 客户端库。

以上，我个人只用过SUDS，非常喜欢。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-08-06T08:33:31.950

我听从了这个问题的其他答案的建议，并尝试了[SUDS 。](https://fedorahosted.org/suds "泡沫")在“愤怒”地使用它之后，我必须同意：SUDS 非常好！强烈推荐！

我确实遇到了从代理后面调用基于 HTTPS 的 Web 服务的问题。在撰写本文时，这会影响**所有**使用 的 Python Web 服务客户端`urllib2`，因此我将在此处记录解决方案。

python 2.6.2 及以下版本的`urllib2`模块不会`CONNECT`向代理发出 HTTPS-over-HTTP-proxy 会话。这会导致长时间超时，或者如果幸运的话，会出现如下错误：

```
abort: error: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol 
```

这是Python 错误跟踪器上的[issue1424152 。](http://bugs.python.org/issue1424152)错误报告中附带了一些补丁，这些补丁将在 Python 2.x 和 Python 3.x 中修复此问题。**这个问题已经解决了**。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-15T20:04:59.687

我对 SUDS 有很好的体验 [https://fedorahosted.org/suds](https://fedorahosted.org/suds)

使用他们的 TestSuite 作为文档。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-07-25T00:59:26.620

SUDS 是要走的路，毫无疑问。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-06-01T03:35:13.593

对查看 SUDS 的人来说只是一个仅供参考的警告，在解决此问题之前，SUDS 不支持 WSDL 中的“选择”标签：

[https://fedorahosted.org/suds/ticket/342](https://fedorahosted.org/suds/ticket/342)

请参阅： [泡沫和选择标签](https://stackoverflow.com/questions/5963404/suds-and-choice-tag)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-02-25T17:04:12.943

SUDS 易于使用，但不保证可重入。如果您将 WSDL Client() 对象保留在线程应用程序中以获得更好的性能，则存在一些风险。该风险的解决方案是 clone() 方法，它会引发不可恢复的 Python 5508 错误，该错误似乎可以打印但实际上并没有引发异常。可能会令人困惑，但它确实有效。它仍然是迄今为止最好的 Python SOAP 客户端。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-08-07T01:00:14.933

我们发布了一个新库：[PySimpleSOAP](http://code.google.com/p/pysimplesoap/)，它提供对简单和功能性客户端/服务器的支持。它的目标是：易用性和灵活性（不需要类、自动生成的代码或 xml）、WSDL 内省和生成、WS-I 标准合规性、兼容性（包括 Java AXIS、.NET 和 Jboss WS）。它包含在 Web2Py 中以启用全栈解决方案（补充其他支持的协议，如 XML_RPC、JSON、AMF-RPC 等）。

如果有人正在学习 SOAP 或者想研究它，我认为这是一个不错的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-08-31T16:18:43.657

我相信soaplib 已经弃用了它的SOAP 客户端（'sender'），转而支持suds。在这一点上，soaplib 专注于成为一个与 Web 框架无关的 SOAP 服务器（“接收器”）。目前，soaplib 正在积极开发中，通常在 Python SOAP 邮件列表中进行讨论：

[http://mail.python.org/mailman/listinfo/soap](http://mail.python.org/mailman/listinfo/soap)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-31T20:32:20.750

在*我的*结论中，我们有这个：

肥皂客户端：

~~**仅** 使用[Suds-jurko](https://bitbucket.org/jurko/suds) **（2016 年更新）** suds 得到了很好的维护和更新。~~

**更新 06/2017：suds** -jurko 库未更新且[显然已废弃](https://bitbucket.org/jurko/suds/issues/117/please-release-new-version#comment-38058760)，

我测试了[zeep](https://github.com/mvantellingen/python-zeep)库，但对令牌有限制，现在只支持 UsernameToken，我报告了一个[错误](https://github.com/mvantellingen/python-zeep/issues/27)来创建时间戳令牌并作者更新代码来修复它。

Zeep 开始很好并且有很好的[文档](http://docs.python-zeep.org/en/master/index.html)，所以我最近将我的代码从 suds 迁移到 zeep 并且工作正常。

~~肥皂服务器端：~~

~~我们有 TGWS、soaplib（pysimplesoap 未测试）恕我直言使用和帮助soaplib 必须是选择。~~

最好的祝福，

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-16T01:00:24.800

正如我[在这里](https://stackoverflow.com/questions/115316/how-can-i-consume-a-wsdl-soap-web-service-in-python#115702)建议的那样，我建议你自己动手。这实际上并不难，我怀疑这就是没有更好的 Python SOAP 库的原因。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-24T02:31:46.603

肥皂水很不错。我尝试了 SOAPpy，但没有让它以我需要的方式工作，而 suds 几乎可以立即工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-15T19:56:53.010

这可以帮助：[http ://users.skynet.be/pascalbotte/rcx-ws-doc/python.htm#SOAPPY](http://users.skynet.be/pascalbotte/rcx-ws-doc/python.htm#SOAPPY)

我通过搜索`wsdl`and找到了它`python`，并且理性地认为，您需要一个 SOAP 服务器的 wsdl 描述来执行任何有用的客户端包装器......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-15T19:59:16.797

我们使用了[Python Web Services](http://pywebsvcs.sourceforge.net/)中的 SOAPpy ，但似乎 ZSI（相同来源）正在取代它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-18T03:29:07.597

我在生产环境中使用 SOAPpy 和 Python 2.5.3。

我不得不在 SOAPpy 中手动编辑几个文件（关于标头代码位于错误位置的问题），但除此之外它可以正常工作并且继续非常可靠地这样做。

# eclipse - 有没有办法在 Eclipse 中手动折叠代码？

> ID：206158
> 
> 赞同：27
> 
> 时间：2008-10-15T19:52:04.673
> 
> 标签：eclipse, formatting, folding

有没有办法在 Eclipse 的代码中手动创建折叠点？我知道如何启用折叠以及如何设置自动首选项，但我喜欢能够设置自己的折叠点，这样我就可以忽略代码的某些部分。考虑 VS 中的区域。
我知道 VS 和 NetBeans 中有，但我找不到在 Eclipse 中设置手动折叠点的方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-15T20:06:37.047

我认为 Eclipse 没有内置手动折叠功能，但我确实使用了以下插件的早期版本。

根据评论：该插件已针对 Eclipse 3.5 重新编译，可在[Apache Isis 站点](http://incubator.apache.org/isis/ide-support.html)获得。也可以直接[下载链接。](http://incubator.apache.org/isis/com.cb.eclipse.folding.KAM-3.5.zip)它似乎也适用于 Eclipse 3.6。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-05T08:47:03.577

eclipse的coffee bytes折叠插件还活着。但是页面已经移动。

可以在[此处](http://archive.realjenius.com/platform_support)找到概述和获取方法。

我已经使用更新页面在 Eclipse 中安装了它。

在 Eclipse 中，转到 Help -> Install new Software
输入：eclipse.realjenius.com/update-site
选择插件并按照屏幕上的说明进行操作。

我对 eclipse 开发还是很陌生，在安装代码折叠插件之前必须安装 mylyn。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T22:42:13.727

我是 Eclipse 新手，但由于 IDE 允许您折叠预处理器指令，您只需执行“#if 1 .... #endif”即可有效地设置手动折叠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T04:00:37.513

不，eclipse 没有任何选项来提供手动折叠插件。

# java - 在 JSF 表达式语言中如何获取列表的长度？

> ID：206161
> 
> 赞同：120
> 
> 时间：2008-10-15T19:52:50.413
> 
> 标签：java, jsp, jsf, jstl, el

我如何获得`ArrayList`使用 JSF EL 表达式的长度？

```
#{MyBean.somelist.length} 
```

不起作用。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-10-15T20:18:19.317

是的，因为 Java API 创建委员会中的一些天才决定，即使某些类具有`size()`成员或`length`属性，它们也不会实现`getSize()`或者`getLength()`JSF 和大多数其他标准要求的，你不能做你想做的事。

有几种方法可以做到这一点。

一：向您的 Bean 添加一个返回长度的函数：

```
在 MyBean 类中：
public int getSomelistLength() { return this.somelist.length; }

在您的 JSF 页面中：
#{MyBean.somelistLength}

```

二：如果你在使用 Facelets（哦，天哪，你为什么不使用 Facelets！），你可以添加 fn 命名空间并使用长度函数

```
在 JSF 页面中：
#{ fn:length(MyBean.somelist) }

```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-10-16T10:53:46.117

你的意思是 size() 不是吗？

```
#{MyBean.somelist.size()} 
```

为我工作（使用具有 Jboss EL 扩展的 JBoss Seam）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-09-01T11:28:25.067

**注意：**此解决方案更适合旧版本的 JSTL。对于大于 1.1 的版本，我建议`fn:length(MyBean.somelist)`按照[Bill James](https://stackoverflow.com/questions/206161/how-do-you-get-the-length-of-a-list-in-the-jsf-expression-language/206252#206252)的建议使用。

* * *

[本文](http://www.informit.com/articles/article.aspx?p=30946&seqNum=8)有一些更详细的信息，包括另一种可能的解决方案；

> 问题是我们试图调用列表的 size 方法（这是一个有效的 LinkedList 方法），但它不是 JavaBeans 兼容的 getter 方法，因此无法评估表达式 list.size-1。
> 
> 有两种方法可以解决这个困境。首先，您可以使用 RT Core 库，如下所示：

```
<c_rt:out value='<%= list[list.size()-1] %>'/> 
```

> 其次，如果您想在您的 JSP 页面中避免使用 Java 代码，您可以实现一个简单的包装类，该类包含一个列表并使用符合 JavaBeans 的 getter 方法提供对列表大小属性的访问。清单 2.25 中列出了该 bean。

c_rt 方法的问题是您需要手动从请求中获取变量，因为否则它无法识别它。在这一点上，您正在为应该内置的功能输入大量代码。这是 EL 中的一个**巨大**缺陷。

我最终使用了“包装器”方法，这是它的类；

```
public class CollectionWrapper {

    Collection collection;

    public CollectionWrapper(Collection collection) {
        this.collection = collection;
    }

    public Collection getCollection() {
        return collection;
    }

    public int getSize() {
        return collection.size();
    }
} 
```

还没有人提到的第三个选项是将列表大小作为单独的属性放入模型中（假设您使用 MVC）。因此，在您的模型中，您将有“someList”，然后是“someListSize”。这可能是解决此问题的最简单方法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-02-28T08:58:49.013

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>

<h:outputText value="Table Size = #{fn:length(SystemBean.list)}"/> 
```

在屏幕上显示表格大小

例子：`Table Size = 5`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-29T02:05:04.487

7 年后……作为 jsf 用户，facelets 解决方案仍然适用于我

将命名空间包括为 `xmlns:fn="http://java.sun.com/jsp/jstl/functions"`

并使用 EL `#{fn:length(myBean.someList)}`，例如，如果在 jsf ui:fragment 中使用下面的示例工作正常

```
<ui:fragment rendered="#{fn:length(myBean.someList) gt 0}">
    <!-- Do something here-->
</ui:fragment> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T13:06:32.993

您最终可以通过使用[EL Functor](http://el-functors.sourceforge.net)来扩展 EL 语言，这将允许您调用任何 Java bean 方法，即使使用参数...

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2014-07-29T19:39:32.937

您可以使用以下 EL 获取长度：

**#{Bean.list.size()}**

# .net - 微软自己的开源同行的实现是否更好，为什么？

> ID：206169
> 
> 赞同：4
> 
> 时间：2008-10-15T19:57:07.083
> 
> 标签：.net, visual-studio, open-source

微软喜欢实现他们自己版本的流行开源框架和程序集，例如：

*   微软的 MVC 框架与 MonoRail
*   微软的 Unity IoC 容器 vs Castle Windsor / Spring.net / Ninject 等
*   Microsoft 的 VS 单元测试框架与 nUnit（以及其他各种）

问题：

微软还“借用”了什么？

在每种情况下哪个更好，为什么？

人们对 Microsoft 官方产品与 ALT.NET 版本的态度如何？

你认为雷德蒙德翼下会采取什么行动？

**编辑** 好吧，而不是“更好”，你更喜欢作为开发人员使用哪个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T20:05:01.043

为什么不把一根棍子放在马蜂窝上呢？

这些伟大工具的 MS 版本肯定有一个更好的地方——如果它是官方的 MS 产品，那么让你的 MS 商店使用产品会更容易。

如果您是为 Windows 系统开发的商店，则在将非 MS 产品整合到您的产品中时，您必须采取额外的步骤。至少，您必须满足许可和文档方面的问题。另外，总有必须克服的内部政治。而且，在某些情况下，如果您的产品使用 MS 未正式支持的“开源”组件，您的客户可能不愿意使用您的产品。

这不公平，但生活也不公平。

就个人而言，我喜欢 MS 与这样的产品竞争，因为它有助于为框架注入新的活力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T20:20:29.220

这完全是主观的，因为对一个人“更好”的东西不一定对另一个人更好。Microsoft 实施的想法/技术/产品与开源实施之间的一个区别是，Microsoft 有能力将**全部时间**资源投入到项目中，而开源通常不能。

还有支持的问题。大多数开源项目除了来自开发社区之外没有任何类型的支持。这并不总是一件坏事，因为有时您可以获得比官方（专用）支持小组更好的支持。

微软这样做的原因有很多，其中之一是在该特定领域拥有一块市场，并推动更多客户使用他们的解决方案，而不是第三方解决方案。另一个原因是实际的客户需求。

微软从开源项目中“借来”的其他一些产品：

*   沙堡（来自 NDoc）
*   TFS 团队构建（来自 CruiseControl.NET）
*   MSBuild（来自 NAnt）
*   ?? （不确定它是否有单独的代号，但它应该是 MVC 框架的一部分）（来自 SubSonic）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T20:03:17.583

在单元测试的情况下，我从微软官员那里听到了答案。事实上，如果我没记错的话，微软的功能甚至是基于 NUnit 代码库的。

复制这个特定的开源产品（以及我被告知的其他产品）的原因是客户想要这个。起初，这似乎是一个廉价的借口，但我实际上可以想象一些喜欢这种方式的企业客户。此外，微软员工声称，如果他们自己实施该程序，微软更容易提供客户支持，因为他们可以对来源承担更多责任。如果这是真的，那么开源采用还有很长的路要走。:-(

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:38:04.677

What defines better? In most cases management will want to have a product that is "standard practice", so that when they throw a rock into a crowd it will likely hit somebody who can spell the name of product they pretend to support. Sad, but true.

On the other hand, with the muscle MS has, once something is adopted and they are serious, man are they every serious, and that can't be a bad thing either. In some respects MS can be relatively agile for a behemoth. Yet they are still a large corp., and large corp don't move too quick.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T20:29:36.347

It is completely subjective but in my mind the answer is a definite 'sometimes'. Some of their implementations are better because they make getting started much easier. For example using MS MVC framework is much easier than getting started with Monorail IMO. Monorail and the related Castle projects always seem a bit disjointed which will put off the less than expert developer just looking to get started. On the other hand, some of MS other projects such as Enterprise Library and Entity Framework are so huge and over architected it makes it very hard to get started for anyone. They are bloatware. Just evaluate each product yourself and choose whatever feels most comfortable.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-15T20:03:43.277

只是有点相关，但我记得当他们第一次发布 windows xp 时，我有一台可以在 windows 98 和 linux 之间双启动的计算机。它有一个非品牌声卡，其中 linux 驱动程序有问题；它会工作一段时间，然后以一种非常独特的方式开始口吃。当我得到机器的 xp 时（通过我所在的学校免费），它的卡的音频驱动程序有*完全相同的错误*！

顺便说一句：有人赌多久，直到关闭？

# api - 如何使用 Twitter 搜索 API 返回与我的搜索查询匹配的所有推文，仅在最后五秒内发布？

> ID：206170
> 
> 赞同：6
> 
> 时间：2008-10-15T19:57:24.383
> 
> 标签：api, search, twitter, search-engine

我想使用 API 返回与我的搜索查询匹配的所有推文，但只返回最后五秒内发布的推文。

使用 Twitter 的搜索 API，我可以使用 since_id 从特定 ID 获取所有推文。但是，我真的看不出找到从推文 ID 开始的好方法。

我也知道您可以在实际查询中使用“since:”来使用日期，但您不能输入时间。

有 Twitter API 经验的人可以给我任何建议吗？感谢您的阅读和您的时间！

[http://apiwiki.twitter.com/Search-API-Documentation](http://apiwiki.twitter.com/Search-API-Documentation)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T03:31:46.657

这听起来像是您最终可以做的事情，因为 created_at 是结果集中返回的字段之一。只需进行查询，并仅使用最后 5 秒内的查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-12T01:02:38.583

```
 <script type="text/javascript" charset="utf-8">
    // JavaScript Document
    $(document).ready(function(){

    // start twitter API    
    $.getJSON('http://twitter.com/status/user_timeline/YOUR_NAME.json?count=10&callback=?', function(data){
        $.each(data, function(index, item){
            $('#twitter').append('<div class="tweet"><p>' + item.text.linkify() + '</p><p><strong>' + relative_time(item.created_at) + '</strong></p></div>');
        });

    });

    function relative_time(time_value) {
      var values = time_value.split(" ");
      time_value = values[1] + " " + values[2] + ", " + values[5] + " " + values[3];
      var parsed_date = Date.parse(time_value);
      var relative_to = (arguments.length > 1) ? arguments[1] : new Date();
      var delta = parseInt((relative_to.getTime() - parsed_date) / 1000);
      delta = delta + (relative_to.getTimezoneOffset() * 60);

      var r = '';
      if (delta < 60) {
        r = 'a minute ago';
      } else if(delta < 120) {
        r = 'couple of minutes ago';
      } else if(delta < (45*60)) {
        r = (parseInt(delta / 60)).toString() + ' minutes ago';
      } else if(delta < (90*60)) {
        r = 'an hour ago';
      } else if(delta < (24*60*60)) {
        r = '' + (parseInt(delta / 3600)).toString() + ' hours ago';
      } else if(delta < (48*60*60)) {
        r = '1 day ago';
      } else {
        r = (parseInt(delta / 86400)).toString() + ' days ago';
      }

      return r;
    }

    String.prototype.linkify = function() {
        return this.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/, function(m) {
            return m.link(m);
        });
    };// end twitter API

}); // ***** end functions *****
    </script>

           <div id="twitter">
    Target Div                      

    </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T20:05:27.753

您是否正在尝试实时投票推文？twitter 对 API req/hour 没有限制。我想你会打得那么快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T20:16:24.813

您为什么不每 5 秒调用一次 API 并获取前 1 条推文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-05T04:26:58.430

Twitter API 结果默认按最近排序。请参阅以下来自 twitter wiki 的引用：

Twitter 搜索 API 的参数：

# 结果类型：可选。指定您希望接收的搜索结果类型。

```
* Valid values include:

      o mixed: In a future release this will become the default value. Include both popular and real time results in the response.
      o recent: The current default value. Return only the most recent results in the response.
      o popular: Return only the most popular results in the response.
* Example: http://search.twitter.com/search.atom?q=Twitter&result_type=mixed
* Example: http://search.twitter.com/search.json?q=twitterapi&result_type=popular
* Example: http://search.twitter.com/search.atom?q=justin+bieber&result_type=recent 
```

如果我在任何地方错了，请纠正我。

谢谢和问候，
Abhay Dandekar

# c++ - 您如何以编程方式确定 Windows 计算机是否是域的成员？

> ID：206172
> 
> 赞同：12
> 
> 时间：2008-10-15T19:57:48.593
> 
> 标签：c++, windows, winapi, dns

我需要一种方法来确定运行我的程序的计算机是否加入了任何域。它属于哪个特定域并不重要，只要它是否连接到任何东西。我在 vc++ 中针对 Win32 API 进行编码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-15T20:28:21.170

直接来自微软：

[如何确定 Windows NT/Windows 2000 计算机是否是域成员](http://support.microsoft.com/kb/179891)

此方法使用 Windows API。从文章摘要：

> 本文介绍如何确定运行 Windows NT 4.0 或 Windows 2000 的计算机是域成员、工作组成员还是使用本地安全机构 API 的独立计算机。

本文还提供了一个小程序的示例代码，该程序输出运行该程序的计算机是域的一部分、工作组的一部分还是独立计算机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T20:13:38.577

我认为[NetServerEnum](http://msdn.microsoft.com/en-us/library/aa370623%28VS.85%29.aspx)功能将帮助您实现您想要的；我会要求具有*servertype*参数`SV_TYPE_DOMAIN_CTRL`常量的主域控制器。如果您没有得到任何信息，那么您不在域中。

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T20:59:36.240

MSDN 示例中的代码有点过时。这是我想出的有效功能。

```
bool ComputerBelongsToDomain()
{
    bool ret = false;

    LSA_OBJECT_ATTRIBUTES objectAttributes;
    LSA_HANDLE policyHandle;
    NTSTATUS status;
    PPOLICY_PRIMARY_DOMAIN_INFO info;

    // Object attributes are reserved, so initialize to zeros.
    ZeroMemory(&objectAttributes, sizeof(objectAttributes));

    status = LsaOpenPolicy(NULL, &objectAttributes, GENERIC_READ | POLICY_VIEW_LOCAL_INFORMATION, &policyHandle);
    if (!status)
    {
        status = LsaQueryInformationPolicy(policyHandle, PolicyPrimaryDomainInformation, (LPVOID*)&info);
        if (!status)
        {
            if (info->Sid)
                ret = true;

            LsaFreeMemory(info);
        }

        LsaClose(policyHandle);
    }

    return ret;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-19T00:35:56.377

这是我没有提到的一种非常简单的方法。

```
TCHAR UserDnsDomain[128] = { 0 }; 
DWORD Result = 0;

Result = GetEnvironmentVariable("USERDNSDOMAIN", UserDnsDomain, sizeof(UserDnsDomain));

if (Result == 0 || Result >= sizeof(UserDnsDomain) || GetLastError() == ERROR_ENVVAR_NOT_FOUND)
{
    return(FALSE); // Not logged in to a domain
} 
```

这是基于这样的想法，即如果运行此代码的用户当前未登录到域，则 USERDNSDOMAIN 环境变量将为空或不可用。但是您应该考虑一些注意事项。

优点：

*   很容易实现。
*   99% 可靠。

缺点：

*   如果计算机已加入域，但执行此代码的用户使用本地帐户登录到该计算机，则可能会失败或返回错误结果。
*   如果计算机已加入域，但在登录/用户使用缓存凭据登录时与域控制器的网络连接不可用，则可能会失败或返回错误结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T20:12:28.907

您可以检查注册表项 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon 以获取“CachePrimaryDomain”的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T20:08:07.933

从计算机的名称来看呢？

**编辑：**这是一个糟糕的“答案”。我的意思是检查`domain\name`计算机名称中的表格。这当然意味着您确实知道域的名称，它并不能解决仅知道计算机是否在任何域中的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T15:36:11.850

避免 LSA，这是一种错误的方法。您必须使用 DS api（2 行代码）

# svn - 如何强制颠覆提交未更改的文件？

> ID：206183
> 
> 赞同：60
> 
> 时间：2008-10-15T20:04:20.390
> 
> 标签：svn, version-control, commit

我希望 subversion 提交一个文件，即使它没有改变。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-10-15T23:04:17.890

如果您希望文件内容保持不变（这意味着您不能像 johnstok 建议的那样仅更改空格），您始终可以更改文件的属性之一。

例如。

```
svn propset dummyproperty 1 yourfile
svn 提交你的文件

```

这将执行提交而无需更改文件。

只要确保您不使用其中一种特殊`svn:`属性即可。其他的应该没问题。

* * *

编辑：其他一些发帖人问为什么有人要这样做——大概标记这个答案的人也有同样的担忧。

我不能代表原始海报，但我看到这种使用的一种情况是尝试自动同步 Visual Sourcesafe 存储库上的活动与颠覆存储库。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-18T13:36:14.070

至于回答为什么要强制提交。我见过有人使用错误或不清楚的提交消息的情况。如果您可以执行强制提交，那就太好了，您可以在其中纠正这个错误。这样更新的提交消息就会进入存储库，所以它不会丢失。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-21T13:02:14.220

我通过删除然后重新添加有问题的文件来解决这个问题。这不是最好的方法，它可能打破了修订历史，但它适合我的目的。

想要这样做的原因：文件是从相同源构建的两个可执行文件之一（具有不同的#defines 集）。对来源的微小更改意味着一个已经改变，一个没有。我想在修订历史中记录我实际上已将其更新到最新版本（即使没有更改）。

也许 Morten Holdflod Møller 的观点“该文件仍将是新修订的一部分”将涵盖这一指示，但我认为未更改文件的日志没有显示对该修订的评论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T20:10:35.400

如果它是一个文本文件，只需添加一些空格，例如换行符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-04T13:27:20.320

回答一些人的疑问应该是可能的：由于某种原因，svn 无法识别 doc 文件之间的差异，所以我也想强制提交！

我现在正在将文档从静态目录移动到 svn。文件就像 UG_v1.2、UG_v1.3 等。所以为了保留历史记录，我采用 1.2，从文件名中删除版本并将其添加并提交到 svn。然后我从第二个版本中取出版本，将它复制到第一个版本上，并希望提交它和更新的版本。文件大小和创建日期更改（没有提及文档中的内容），但 svn 声称它是完全相同的文件并且不允许我提交。当我手动更改文档时，svn 会看到不同。见鬼？:>

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T20:06:39.420

我不认为这是可能的，但首先你为什么需要这样做？如果文件未更改，则不应提交。

如果您真的希望该文件与提交中的其他文件分组，您可以更改内部的一些小内容（例如添加一个空格）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-02T12:03:31.963

有人想要提交未更改的文件的原因是对如何恢复到文件的先前版本的误解。

例如，可以通过仅将其更新为过去的修订版来还原`index.html`修订版**680中的文件，例如****650**：

`svn update index.html -r 650`

但这并不能解决问题，因为：

```
svn状态-u index.html
        * 650 索引.html
反对修订状态：680

```

svn 明确表示 index.html 是*远程修改*的，你不能提交它，即它“认为” index.html 是旧的，应该更新到更新的版本。所以接下来`svn update`会将 index.html 带回修订版**680**。

要真正还原文件，您应该以相反的顺序合并它：

`svn merge -r 680:650 index.html`

然后提交`svn ci -m "Reverted to r650" index.html`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-12T09:26:44.750

古老的问题，但这是有人想要这样做的原因之一：

我们使用 svn "commit" 来记录代码审查的成功结果。在代码审查期间，会检查（并可能修改）文件的某个子集。但被发现通过审查的文件将保持不变。

这个想法是使用提交来记录审查了哪些文件。这应该包括那些被发现通过审查而没有任何修改的人。因此，需要“重新提交”（“force-commit”）它们而不加修改。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-01T22:33:43.900

实际上，我遇到了强制提交的理由。这可能不是最佳实践，但我们将 Truecrypt ( [http://www.truecrypt.org/](http://www.truecrypt.org/) ) 卷放在 SVN 中，因为我们需要对某些 ​​shell 脚本保持严格的安全性，因为它包含敏感信息。创建 Truecrypt 卷后，无论您如何处理，它的二进制数据都保持不变。所以实际上，我可以更改卷的内容，但卷似乎永远不会改变。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-01T22:38:47.117

更改属性不会强制提交。

TortoiseSVN 1.4.5，内部版本 10425 - 32 位，2007/08/26 11:14:13

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-06-25T16:07:44.927

我对 trueCrypt 卷也有同样的问题。

我添加了一个新属性（如上所述）“forceCommit1”，我能够提交卷文件。但只有属性被提交，而不是文件的内容。

我删除了文件并再次将其添加到 svn

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2008-10-31T10:31:18.660

我以为你可以从命令行做到这一点？

```
svn ci -force <filename> 
```

我这里没有存储库来检查它，所以我可能错了。

# sql - 移动/复制 SQL Server 2005 全文索引

> ID：206184
> 
> 赞同：1
> 
> 时间：2008-10-15T20:04:28.753
> 
> 标签：sql, sql-server, sql-server-2005

我们正在将我们的数据库服务器移动到一个更大的盒子中。我有几个带有全文索引的数据库。移动全文索引的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T20:22:26.890

我发现备份和恢复是移动数据库的唯一可靠方法。当您这样做时，FTS 应该随之移动。分离和重新附加数据库对我来说从来都不是很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T20:13:56.720

如果您要移动数据库，请移动包含 FTS 信息的文件夹，这样就可以了。

如果您要进行还原，则应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T21:08:35.377

我的第一次尝试是复制数据库文件并重新附加它们。尝试访问目录时遇到以下错误：

**全文目录“*数据库名称*”处于不稳定状态。删除并重新创建此全文目录。（Microsoft SQL Server，错误：7624**

我的第二次也是**成功**的尝试是按照 Craig 的建议从备份中恢复数据库。我的目录确实过来了，但我收到以下错误：

**属性 IsAccentSensitive 不适用于 FullTextCatalog '[CatalogName]'” 此对象可能不存在此属性，或者由于访问权限不足而无法检索。(Microsoft.SqlServer.Smo)**

快速谷歌搜索后，我找到了答案 [MS KB 910067](http://support.microsoft.com/kb/910067)

只需分离并重新附加数据库，我就很好。

# .net - 将双精度数组转换为 IComparable 数组

> ID：206191
> 
> 赞同：1
> 
> 时间：2008-10-15T20:05:34.257
> 
> 标签：.net, vb.net, icomparable

我正在尝试使用 VB.NET 创建一个 Quicksort 基类，并将其作为一组 IComparable 元素。签名如下所示：

```
public shared sub Sort(ByVal values() as IComparable) 
```

但是，当我传入一个双精度数组时，编译器会给我错误。

```
Dim numbers(100) as double
Dim random as new Random(0)
for i as integer = 0 to numbers.length - 1
  numbers(i) = random.NextDouble()
Next

QuickSort.Sort(numbers) ' gives compiler error. 
```

错误是：

```
Error   88  Value of type '1-dimensional array of Double' cannot be converted to '1-dimensional array of System.IComparable' because 'Double' is not derived from 'System.IComparable'. C:\Proving Grounds\Module1.vb 
```

.NET 文档说明 double 的实现 IComparable。为什么 .NET 编译器不让我这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T20:42:11.437

虽然`double`可以转换为`IComparable`，但不代表`double[]`可以转换为`IComparable[]`。一个简单的选择是创建一个新`IComparable[]`数组并复制数据 - 或者在您的情况下，只需将原始数组作为`IComparable[]`.

实际上，我很想使用泛型`IComparable<T>`或`IComparer<T>`接口，或者`Comparison<T>`委托 - 都使用泛型 - 这也允许使用`Comparer<T>.Default`和非默认比较器。

# .net - 与 .NET 2.0/3.5 一起使用的最佳免费 ORM 工具

> ID：206197
> 
> 赞同：11
> 
> 时间：2008-10-15T20:07:13.677
> 
> 标签：.net, orm

我有兴趣在即将到来的项目中使用对象关系映射包。该项目将作为一个 ASP.NET 应用程序开始，但将具有最终将与 WinForms 应用程序共享的许多功能。任何人都可以推荐一些在 ASP.NET 和 WinForms 情况下都运行良好的免费 ORM 包吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T20:24:26.030

SubSonic 没有 nHibernate 广泛；相反，它是每个表数据访问层的直接 Active Record 1 类。

其中一些功能是查询工具、执行存储过程的能力和 ASP.net 中的脚手架应用程序。您可以在 30 分钟或更短的时间内启动并运行，只需极短的学习曲线和 Config.app 文件中的最少配置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T20:18:01.987

我总是推荐[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)。[它是NHibernate](http://www.hibernate.org/343.html)之上的一层。它在您提到的两种环境中都非常有效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T20:18:42.827

nHibernate 对我有用，但这一切都取决于你所追求的。很多人不想走完整的 DDD 和单元测试路线。他们只是想要一些简单的东西来将他们的数据库映射到对象以使代码更好一点。如果是这样的话，那么看看 Subsonic，它可能更容易上手。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-11-05T14:12:58.470

我喜欢[Fluent NHibernate](http://fluentnhibernate.org)，它允许您在强类型 C# 中创建映射，而不是使用普通的 NHibernate XML 文件。它也允许您混合和匹配（您可以在代码和 XML 中进行映射）。

[这里](http://wiki.fluentnhibernate.org/Getting_started)有一篇不错的入门文章。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-15T20:11:16.883

试试，亚音速

你也可以使用 Linq2Sql ORM。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-15T20:08:39.523

休眠

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-05T14:01:52.360

我没有简单地调查 ActiveRecord，因为根据独立的serveys，它的执行速度不如许多其他 ORM，并且它没有完整的 Linq 实现。

DataObjects.NET 要求您的所有实体都派生自特殊类，但作为交换，您可以获得可观的性能和好东西，例如内存存储提供程序和最完整的 Linq 实现。

我花了一个下午筛选 DBLinq 的源代码。我的*观点*是它不成熟（Linq-To-SQL 的许多功能根本没有实现），我不建议将它用于生产系统。

那么……如果您正在寻找免费、快速、开源、符合 LINQ 的 ORM，那么 DataObjects.NET 是一个非常安全的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-02-06T12:40:04.483

签[出 XmlDataMapper](http://xmldatamapper.codeplex.com//)一个简单的免费 ORM（LGPL 许可证），与其他巨头相比，它的内存占用较低。提供的示例项目应该足以开始使用。

要集成 XmlDataMapper，您只需 4 个小步骤

1.  为表创建业务实体/DTO
2.  使用表和 DTO 之间的映射信息创建一个 XML 文件。
3.  在配置中指定 DTO 和 xml 文件。
4.  只需调用 DTOConverter.Convert(dataReader) 和其他此类方法即可将您的数据库记录转换为 DTO / 业务实体

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-10-11T23:50:57.340

[尝试从http://www.dbframeit.com](http://www.dbframeit.com)获得的 dbFrameIT 。它非常易于使用，并提供免费的个人使用许可证。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T02:16:52.510

我已经为少数 ASP.NET 应用程序以及 WinForms 应用程序使用 SubSonic 大约一年了。它非常容易上手，而且我还没有因为选择它而“陷入困境”——几乎总有一些方法可以做你需要的事情，通常很容易。我估计它已经将我们的开发时间缩短了 30%。不是真正的 ORM 工具，但可以极大地提高生产力。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-10T10:35:13.273

**请参阅此[ORM 工具列表“.Net”](http://amrelgarhy.com/index.php/orm-tools-net/)**

它包含所有著名的 .Net ORM 工具

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-27T12:24:08.687

我使用 NHibernate 和 NHibernate 注释。它运行良好 - 没有映射文件（entity.xml）。不幸的是，您必须在需要一个很小的 ​​xml 文件的 Log4net 上。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-25T15:57:55.953

[Habanero](http://www.habanerolabs.com/Overview/tabid/37/Default.aspx)，伟大而强大的 ORM。它是免费的（LGPL 许可），可与 .net 2.0 一起使用（这对我来说非常重要），并且具有从数据库生成模型的强大工具（具有自定义类和属性名称、自定义验证等）

# c# - PropertyInfo.GetValue(null, null) 返回 null

> ID：206198
> 
> 赞同：2
> 
> 时间：2008-10-15T20:07:25.610
> 
> 标签：c#

我有一个名为“Info”的静态公共属性类。通过反射我想得到这个属性值，所以我打电话：

```
PropertyInfo pi myType.GetProperty("Info");
string info = (string) pi.GetValue(null, null); 
```

只要属性是字符串类型，它就可以正常工作。但实际上我的属性是 IPluginInfo 类型，并且 PluginInfo 类型（实现 IPluginInfo）被 instatiated 并在 Info 属性获取访问器中返回，如下所示：

```
public static IPluginInfo PluginInfo
{
    get 
    {
        IPluginInfo Info = new PluginInfo();
        Info.Name = "PluginName";
        Info.Version = "PluginVersion";
        return Info;
    }
} 
```

当我打电话时是这样的：

```
IPluginInfo info = pi.GetValue(null, null) as IPluginInfo; 
```

info 始终为空，而 PropertyInfo pi 仍然有效。我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T20:13:16.677

你能创建一个简短但完整的程序来演示这个问题吗？

鉴于您正在谈论插件，我的*猜测*是您遇到了在两个不同的程序集中定义 IPluginInfo 的问题。看看[这篇文章](http://pobox.com/~skeet/csharp/plugin.html)是否有帮助。

验证它的最简单方法是首先调用`pi.GetValue`并将结果存储在一个`object`变量中，然后在另一行中执行强制转换或“as”。这样您就可以中断调试器并在返回值丢失之前查看它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T20:15:15.360

我的第一个猜测是您重新声明了 IPluginInfo 接口。所有 .NET 类型都由它们的程序集限定；如果您在 2 个程序集中具有相同的类文件，则您有 2 个碰巧具有相同名称的不同接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T21:41:07.497

好的，谢谢所有的答案。

我确实已经在单独的 .dll 中拥有插件接口，但已将此 .dll 放在 pluginhosts 目录以及包含所有插件的目录中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T20:18:36.133

嗯，首先我会以不同的方式实现该属性：

```
private static PluginInfo _PluginInfo = null;
public static IPluginInfo PluginInfo
{
    get
    {
        if (_PluginInfo == null)
        {
           _PluginInfo = new PluginInfo();
           _PluginInfo.Name = "PluginName";
           _PluginInfo.Version = "PluginVersion";
        }
        return _PluginInfo;
    }
} 
```

请注意，这需要更多的工作，因为它不是线程安全的，但希望您明白：构建一次而不是重复构建它。

我现在就停在这里，因为看起来其他两个人在整理第一部分时已经完成了我的其余答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T20:18:39.097

在 C# 中，如果值与类型不匹配，则 AS 返回 null。如果你写：

```
object info = pi.GetValue(null, null);
Console.WriteLine(info.GetType().ToString()); 
```

你收到什么类型的？

# linq-to-sql - LINQ to SQL: Setting ObjectTrackingEnabled to false breaks lazy loading of child entities?

> ID：206203
> 
> 赞同：21
> 
> 时间：2008-10-15T20:07:42.647
> 
> 标签：linq-to-sql

Is there a way to disable LINQ's object tracking features, without also disabling lazy-loaded child associations?

I'm using LINQ2SQL in a set of integration tests. I'm only using LINQ to verify changes in the database, so I want it to act like a simple data access layer rather than a full ORM. To do this,I set set the data context's ObjectTrackingEnabled property to false to prevent LINQ from caching data. This works fine, except that it breaks associations between entities.

For instance, assume two tables WIDGET and CATEGORY, with a FK relationship between them. With object tracking enabled, *widgetInstance.CATEGORY* is correctly lazy-loaded. With object tracking disabled, nothing is lazy loaded and the CATEGORY property is always null.

How do I prevent LINQ from caching data, without also preventing lazy-loading?

**UPDATE:** Here's [a link to the MSDN page](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.deferredloadingenabled.aspx) referenced by the answer. Further research also turned up that I can use [LoadWith](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.aspx) to do eager loading of child data. In my case I just want the data, so eager loading is fine.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T20:20:09.720

According to MSDN:

> Deferred loading requires object tracking. Only the following three modes are valid:
> 
> ObjectTrackingEnabled = false. DeferredLoadingEnabled is ignored and inferred to be false. This behavior corresponds to a read-only DataContext.
> 
> ObjectTrackingEnabled = true. DeferredLoadingEnabled = false. This situation corresponds to a DataContext that allows users to load an object graph by using LoadWith directives, but it does not enable deferred loading.
> 
> Both are set to true. This is the default.

You either have to enable object tracking and detach entities (which is doable since you're running tests, I guess, otherwise it pretty much troublesome to detach every single entity of another entity of...), or use DataLoadOptions.LoadWith() or AssociateWith() to eager-load the relationships.

# c# - SendMessage 消息编号的解释？

> ID：206221
> 
> 赞同：14
> 
> 时间：2008-10-15T20:11:20.813
> 
> 标签：c#, winforms, interop

我已经成功使用 Windows SendMessage 方法帮助我在我的文本编辑器中做各种事情，但每次我只是复制和粘贴别人建议的代码，我真的不知道它是什么意思。总是有一个神秘的消息编号是一个参数。我怎么知道这些代码数字的含义，以便我能够真正理解正在发生的事情并（希望）在未来更加自给自足？谢谢。

最近的例子：

```
using System.Runtime.InteropServices;

[DllImport("user32.dll")]
static extern int SendMessage(IntPtr hWnd, uint wMsg,UIntPtr wParam, IntPtr lParam);

SendMessage(myRichTextBox.Handle, (uint)0x00B6, (UIntPtr)0, (IntPtr)(-1)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T20:19:46.210

这是 Windows 消息代码。
它们在头文件中定义，并且通常可以翻译为某种不同语言的包含。

例如：
WM_MOUSEMOVE = &H200
MK_CONTROL = &H8
MK_LBUTTON = &H1
MK_MBUTTON = &H10
MK_RBUTTON = &H2
MK_SHIFT = &H4
MK_XBUTTON1 = &H20
MK_XBUTTON2 = &H40

请参阅 [http://msdn.microsoft.com/en-us/library/ms644927(VS.85).aspx#windows_messages](http://msdn.microsoft.com/en-us/library/ms644927(VS.85).aspx#windows_messages)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T20:19:48.783

Windows 中的每条消息都由一个数字表示。在本机代码中使用 Windows SDK 进行编码时，这些定义由 WM_CHAR、WM_PAINT 或 LVM_GETCOUNT 等定义提供，但这些定义不会传递到 .NET 框架，因为在大多数情况下，消息由 .NET 事件包装像 OnKeyPressed 和 OnPaint，或者像 ListView.Items.Count 这样的方法和属性。

在没有包装的事件、属性或方法的情况下，或者您需要执行更高级别不支持的操作时，您需要 Windows 在 .NET 框架下使用的消息编号。

找出特定数字实际含义的最佳方法是查看 Windows SDK 标头并找到该数字的定义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-22T03:56:48.283

也许您会发现[http://www.codeproject.com/KB/cs/cswindowsmessages.aspx](http://www.codeproject.com/KB/cs/cswindowsmessages.aspx)上的代码很有用。它提供了许多常见 Windows 消息的 C# 枚举。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-22T18:06:49.207

在我在互联网上找到的所有示例中，这个是最好的，因为它是唯一一个负责显示`using System.Runtime.InteropServices`. 如果没有这个指令，我无法让 SendMessage 在 c# 中工作。此页面提供的 Windows 消息列表也非常有用。这里我重复这个例子：

```
using System.Runtime.InteropServices; 

[DllImport("user32.dll")] 
static extern int SendMessage(IntPtr hWnd, uint wMsg,UIntPtr wParam, IntPtr lParam); 

SendMessage(myRichTextBox.Handle, (uint)0x00B6, (UIntPtr)0, (IntPtr)(-1)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T17:29:19.470

试用[PInvoke 互操作助手](http://codeplex.com/clrinterop)。此工具具有搜索功能，可让您浏览所有已定义的 Windows 消息。然后它将为这些值生成正确的 C#/VB.Net 代码。

它也不仅限于常量值。它还可以生成结构、函数、函数指针和枚举。

# sql - Oracle - 获取两个 DateTime 列之间的分钟差的最佳 SELECT 语句？

> ID：206222
> 
> 赞同：22
> 
> 时间：2008-10-15T20:11:21.763
> 
> 标签：sql, oracle, datediff

我正在尝试满足来自客户的一个相当困难的报告请求，我需要在几分钟内找到两个 DateTime 列之间的差异。我尝试使用各种[格式](http://www.ss64.com/orasyntax/fmt.html)的 trunc 和 round ，但似乎无法想出一个有意义的组合。有没有一种优雅的方式来做到这一点？如果没有，有**没有**办法做到这一点？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-15T20:14:30.307

```
SELECT date1 - date2
  FROM some_table 
```

返回天数的差异。乘以 24 得到小时的差异，乘以 24*60 得到分钟。所以

```
SELECT (date1 - date2) * 24 * 60 difference_in_minutes
  FROM some_table 
```

应该是你要找的

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-15T20:16:24.750

默认情况下，oracle 日期减法以 # 天为单位返回结果。

所以只需乘以 24 得到 # 小时，再乘以 60 得到 # 分钟。

例子：

```
select
  round((second_date - first_date) * (60 * 24),2) as time_in_minutes
from
  (
  select
    to_date('01/01/2008 01:30:00 PM','mm/dd/yyyy hh:mi:ss am') as first_date
   ,to_date('01/06/2008 01:35:00 PM','mm/dd/yyyy HH:MI:SS AM') as second_date
  from
    dual
  ) test_data 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T20:13:46.567

[http://asktom.oracle.com/tkyte/Misc/DateDiff.html](http://asktom.oracle.com/tkyte/Misc/DateDiff.html) - 截至 2012-01-30 链接失效

看起来这是资源：

[http://asktom.oracle.com/pls/asktom/ASKTOM.download_file?p_file=6551242712657900129](http://asktom.oracle.com/pls/asktom/ASKTOM.download_file?p_file=6551242712657900129)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-12T12:32:57.347

使用`timestampdiff`at`where`子句。

例子：

```
Select * from tavle1,table2 where timestampdiff(mi,col1,col2). 
```

# spring - Grails 文件上传问题

> ID：206224
> 
> 赞同：8
> 
> 时间：2008-10-15T20:12:10.763
> 
> 标签：spring, grails, file-upload

我正在尝试从 grails 网站模拟文件上传代码，但遇到了一些问题。我使用的代码与[此处](http://grails.org/Controllers+-+File+Uploads)的代码相同。这是我的代码：

```
 <g:form action="upload" method="post" enctype="multipart/form-data">
        <input type="file" name="myFile" />
        <input type="submit" value="Upload" />
    </g:form> 
```

和

```
def upload = {
    def f = request.getFile('myFile')
    if(!f.empty) {
      flash.message = 'success'
    }    
    else {
       flash.message = 'file cannot be empty'
    }
} 
```

我在运行时收到以下错误：

```
Message: No signature of method: org.mortbay.jetty.Request.getFile() is applicable for argument types: (java.lang.String) values: {"myFile"}
Caused by: groovy.lang.MissingMethodException: No signature of method: org.mortbay.jetty.Request.getFile() is applicable for argument types: (java.lang.String) values: {"myFile"} 
```

它似乎与一些 Spring 配置有关。Spring 似乎没有注入`MultipartHttpServletRequest`，所以我的请求没有合适的方法。我刚刚使用`grails create-app`. 我没有修改 resources.groovy 文件。我正在使用 grails 1.0.3。

任何帮助深表感谢。grails 网站使这看起来如此简单。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-15T21:11:42.720

问题解决了！

我使用示例代码将文件上传到 Grails 与原始作者可能的意图不同。问题是当调用控制器的*上传*方法时，有时是为了上传页面的原始渲染。该方法中的请求不是 MultipartHttpServletRequest 类型。当我对要上传的文件进行 POST 后，Spring 做了正确的事情并将我的请求更改为 MultipartHttpServletRequest。因此，在使用 MultipartHttpServletRequest 之类的请求之前，我需要对*更新*控制器方法进行简单检查。

```
if(request instanceof MultipartHttpServletRequest)
{
  MultipartHttpServletRequest mpr = (MultipartHttpServletRequest)request;  
  CommonsMultipartFile f = (CommonsMultipartFile) mpr.getFile("myFile");
  if(!f.empty)
    flash.message = 'success'
  else
   flash.message = 'file cannot be empty'
}   
else
  flash.message = 'request is not of type MultipartHttpServletRequest' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-14T13:15:20.280

现在使用 Grails 2.x 使用：

```
<g:uploadForm name="upload" action="upload" method="POST">
     <input type="file" name="file" />
</g:uploadForm>

def upload = {
    def file = request.getFile('file')
    assert file instanceof CommonsMultipartFile

    if(!file.empty){ //do something }
    else { //do something }
} 
```

更干净，更简单。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T20:19:31.483

确保您更新 html（您的 gsp 以及要从中上传的表单）以具有它们显示的**enctype ：**

```
<g:form action="upload" method="post" enctype="multipart/form-data"> 
```

希望这很有帮助，似乎太明显了，但这是我看到您的错误消息后的第一个想法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T20:38:05.940

[这里](http://docs.codehaus.org/display/GRAILS/File+Upload)有人似乎遇到了和你一样的麻烦。他说他“修复”了它：

> 解决了。这是我的错误，我在提交表单之前进行了保存，所以我想没有文件。

不知道如何接受他所说的，但也许它会对你有所帮助。

# c# - 通过webservice c#返回数据

> ID：206239
> 
> 赞同：0
> 
> 时间：2008-10-15T20:15:34.173
> 
> 标签：c#, web-services

我知道这是一个古老的问题，但这是我的场景

这是在 C# 2.0 中

有一个具有 datagridview 控件的 Windows 应用程序。这需要通过进行 Web 服务调用来填充。

如果我要使用直接连接并且使用数据集，例如分页和对返回的数据应用过滤器，我想在数据上实现相同的功能。我知道返回数据集是一个坏主意，我正在寻找一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T20:20:54.210

我可能会在 VS2008 SP1 中查看[ADO.NET Data Services](http://msdn.microsoft.com/en-gb/magazine/cc748663.aspx)，又名 Astoria。

这允许您通过 Web 服务公开数据（WCF 公开 ATOM、IIRC） - 但您不需要知道所有这些细节：工具会为您担心：您只需获得常规的 IQueryable<T> 源数据上下文（与 LINQ-to-SQL 数据上下文不完全相同，但概念相同）。

这里的好处是 LINQ 查询（例如过滤（Where）、分页（Skip/Take）等）可以从客户端、*通过Web 服务**一直*到支持 LINQ 的数据存储进行组合（LINQ-to-SQL 或实体框架等）。因此，只有正确的数据通过网络传输：如果您要求按名称排序的前 10 行（20000 行），那么您将得到：数据库中的 10 行；10 排在电线上，没有弄乱。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T20:21:37.860

编写一个自定义类 (MyDataItem) 来保存您的数据。然后，您可以传递一个`List<MyDataItem>`或一些 MyDataItem 集合并绑定到您的网格。

分页、过滤等需要您自己实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T20:22:06.937

如果您正在通过 Web 服务数据层，则无法获得使用 DataSet 自动获得的绑定行为。您必须创建自己的代理类来支持所有数据绑定功能并通过您的 Web 服务调用将它们持久化。根据您的应用程序环境，您可能希望批量修改以避免过多地往返于 Web 服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T20:28:27.767

fall888 说得对——你需要创建一个 List 或 DataTable 的集合类，用 web 服务数据流的输出填充它，并自己处理分页和过滤。

# python - 变量作为字段选项中的参数

> ID：206245
> 
> 赞同：2
> 
> 时间：2008-10-15T20:16:33.160
> 
> 标签：python, django

我想创建一个模型，它将在创建时设置 editable=False，在编辑项目时设置 editable=True。我认为它应该是这样的：

```
 home = models.ForeignKey(Team, editable=lambda self: True if self.id else False) 
```

但它不起作用。也许覆盖**init**的东西可以帮助我，但我不知道有什么办法。我知道我可以在 save() 方法中检查 self.id，但是为时已晚，我希望在填写字段时在管理应用程序中使用这种逻辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T10:33:21.870

将以下内容（[此代码](http://www.djangosnippets.org/snippets/937/)的一个小扩展）添加到您的 admin.py：

```
from django import forms

class ReadOnlyWidget(forms.Widget):
    def __init__(self, original_value, display_value):
        self.original_value = original_value
        self.display_value = display_value

        super(ReadOnlyWidget, self).__init__()

    def render(self, name, value, attrs=None):
        if self.display_value is not None:
            return unicode(self.display_value)
        return unicode(self.original_value)

    def value_from_datadict(self, data, files, name):
        return self.original_value

class ReadOnlyAdminFields(object):
    def get_form(self, request, obj=None):
        form = super(ReadOnlyAdminFields, self).get_form(request, obj)
        fields = getattr(self, 'readonly', [])
        if obj is not None:
            fields += getattr(self, 'readonly_on_edit', [])

        for field_name in fields:
            if field_name in form.base_fields:
                if hasattr(obj, 'get_%s_display' % field_name):
                    display_value = getattr(obj, 'get_%s_display' % field_name)()
                else:
                    display_value = None

                form.base_fields[field_name].widget = ReadOnlyWidget(getattr(obj, field_name, ''), display_value)
                form.base_fields[field_name].required = False

        return form 
```

然后，您可以在编辑对象时指定某些字段应为只读：

```
class PersonAdmin(ReadOnlyAdminFields, admin.ModelAdmin):
    readonly_on_edit = ('home',)

admin.site.register(Person, PersonAdmin) 
```

# winapi - 如何以编程方式弹出 USB 大容量存储设备？

> ID：206248
> 
> 赞同：4
> 
> 时间：2008-10-15T20:17:42.393
> 
> 标签：winapi

如何在 Windows (XP) 中以编程方式弹出（安全删除）USB 大容量存储设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T20:31:16.670

在[![](https://i.stack.imgur.com/wOUx6.jpg)autoit](http://www.autoitscript.com/autoit3/)中，您有一个[脚本](http://www.autoitscript.com/forum/index.php?showtopic=48585)可以做到这一点。

它基本上来自这篇[微软文章](http://support.microsoft.com/?scid=kb%3Ben-us%3B165721&x=18&y=13)并使用 kernel32.dll DeviceIoControl 函数

当然，这个问题似乎与[Safe remove USB-Drive using Win32 API?](https://stackoverflow.com/questions/85649/safe-remove-usb-drive-using-win32-api) ，这给出了其他解决方案

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T22:43:02.793

首先从[http://www.codeproject.com/Articles/13530/Eject-USB-disks-using-C下载解码代码](http://www.codeproject.com/Articles/13530/Eject-USB-disks-using-C)

然后将文件夹“库”的类导入您的项目

并将此代码放入您的点击按钮。

```
private void btnExpulsar_Click(object sender, RoutedEventArgs e)
        {
            //Expulsa todas las unidades
            VolumeDeviceClass volumeDeviceClass = new VolumeDeviceClass();  //Enlista las unidades
            foreach (var item in volumeDeviceClass.Devices.ToList())
            {
                if (item.IsUsb)//Verifica que sean unidades USB
                {
                    item.Eject(true); //Expulsa las unidades
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T20:21:15.457

您可以生成一个进程并使用[命令行工具](http://quick.mixnmojo.com/readmes/USBDiskEjector.html)。这也适用于调用 Win32 api 更难的其他语言，例如 java。

# sql - 为什么我通过 ODBC 调用的存储过程在同一位置失败？

> ID：206255
> 
> 赞同：0
> 
> 时间：2008-10-15T20:18:42.797
> 
> 标签：sql, sql-server, sql-server-2000, odbc

我正在使用[freeodbc++](http://libodbcxx.sourceforge.net/)库来访问 MS SQL Server 2000 数据库（SP3？SP4？）上的数据。特别是，我正在运行一个特别长且令人讨厌的存储过程。我可以在 SQL Profiler 中观看该过程的执行，但是，它往往会在某个点停止处理。没有错误代码或异常抛出。如果我注释掉始终是最后一个语句的嵌套语句，它只会在注释之前稍微结束。我没有尝试从根本上评论整个该死的事情......我将查询超时设置为 300 秒。可调用语句通常会在 1 秒内返回，而不会真正完成 SP。

有任何想法吗？

**UPDATE0：**如果我通过查询分析器或其他工具运行 SP……它可以工作。只是通过我的 ODBC 连接失败了。

**UPDATE1：**当我注释掉代码时，执行会进一步进入 SP。让我觉得我遇到了超时或缓冲区限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-15T20:21:04.227

从查询分析器运行该过程，看看会发生什么。您可以在过程中使用 RAISERROR() 函数将跟踪信息提供回消息窗口以帮助您进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T20:43:06.833

您是否尝试过使用 TRY 和 CATCH？它可能会在您的存储过程中的函数调用上引发您看不到的错误。

```
BEGIN TRY
 <Your code>
END TRY
BEGIN CATCH
        DECLARE @ErrMsg nvarchar(max),
            @ErrSeverity int,
            @ErrState int
    SELECT  @ErrMsg = ERROR_MESSAGE(),
            @ErrSeverity = ERROR_SEVERITY(),
            @ErrState = ERROR_STATE()

    RAISERROR (@ErrMsg,@ErrSeverity,@ErrState);
END CATCH 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T22:21:10.770

您是否尝试过在 SQL Server 端进行分析，以查看您的 SPID 发生了什么？

另外，我没有使用过freeodbc++，但也许里面有一个它不喜欢的PRINT 语句。您还可以 SET NOCOUNT ON 来抑制行计数消息。同样，这取决于 freeodbc++ 如何对这些“信息”消息作出反应。

根据您描述的这种“冻结”行为方式，这听起来像是 freeodbc++ 中的一个错误。首先检查 SQL 端的进程，看看它是否真的挂起，或者你的库是否只是“死”在你身上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T12:55:54.763

添加“::睡眠（30000）；” 在我对 ODBC 语句对象调用执行之后（以及在语句关闭命令之前）立即阻止服务器进程过早退出。一定是 freeodbc++ 的错误或我的配置错误。

感谢您提供故障排除/调试提示。

# c++ - 释放分配给 void 指针数组的内存

> ID：206257
> 
> 赞同：3
> 
> 时间：2008-10-15T20:19:18.927
> 
> 标签：c++, c, memory-management

我正在声明一个 void 指针数组。每个都指向一个任意类型的值。
`void **values; // Array of void pointers to each value of arbitary type`

初始化值如下：

```
 values = (void**)calloc(3,sizeof(void*));
    //can initialize values as: values = new void* [3];
    int ival = 1;
    float fval = 2.0;
    char* str = "word";
    values[0] = (void*)new int(ival);
    values[1] = (void*)new float(fval);
    values[2] = (void*)str;

    //Trying to Clear the memory allocated
    free(*values); 
    //Error: *** glibc detected *** simpleSQL: free(): invalid pointer: 0x080611b4
    //Core dumped
    delete[] values*;
    //warning: deleting 'void*' is undefined
    //Similar Error. 
```

现在如何释放/删除为值分配的内存（空指针数组）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T20:28:19.780

我怀疑问题出在您分配的方式上`values`：。那应该不仅仅是.`values = (void*)calloc(3,sizeof(`**`void`**`))``sizeof(void *)``sizeof(void)`

sizeof(void) 可能为零或其他没有意义的东西，所以你并没有真正分配任何内存开始......分配工作只是运气不好，然后当你尝试解除分配时弹出错误记忆。

编辑：您还通过在 C++ 风格`new`/`delete`与 C 风格`malloc`/之间交替来寻找麻烦`free`。可以同时使用它们，只要你不使用`delete`你编辑的东西`malloc`或`free`你编辑的东西`new`，但如果你这样做，你会在脑海中混淆它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T20:29:35.503

您有 3 个动态分配的东西需要以 2 种不同的方式释放：

```
delete reinterpret_cast<int*>( values[0]);    
delete reinterpret_cast<float*>( values[1]);

free( values); // I'm not sure why this would have failed in your example, 
               //    but it would have leaked the 2 items that you allocated 
               //    with new 
```

请注意，由于`str`不是动态分配的，它不应该（实际上**不能**）被释放。

几点注意事项：

*   我假设这`sizeof(void)` 是`sizeof(void*)` 因为你不会编译
*   我不会说任何关于你看似随机的铸造的事情，只是它看起来像是准备好迎接灾难的代码

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T21:09:18.700

这是 boost::any 类的完美情况
此外，您可能需要考虑使用向量而不是分配自己的内存。

```
std::vector<boost::any>   data;
boost::any i1 = 1; // add integer
data.push_back(i1);

boost::any f1 = 1.0; // add double
data.push_back(f1);

data.push_back("PLOP"); // add a char *

std:: cout << boost::any_cast<int>(data[0]) + boost::any_cast<double>(data[1])
           << std::endl; 
```

回到您的原始代码，主要问题是：

```
values = (void*)calloc(3,sizeof(void));

// This should  have been
void** values = (void**)calloc(3,sizeof(void*));

// Freeing the members needs care as you need to cast them
// back to the correct type before you release the memory.

// now you can free the array with
free(values); 
```

另请注意：尽管在同一段代码中同时使用 new/delete 和 calloc/free 并不违法，但这是不受欢迎的。主要是因为很容易把事情搞混，这可能是致命的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:45:14.957

您正在混合 new 和 *alloc()。这是一个禁忌，并可能导致不确定的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T20:25:29.083

您必须跟踪最初 calloc'd 的 void* 数量，并遍历它们，释放每个，然后释放原始值变量。

该死的格式...（预览工作正常）。

```
int ct = 3;
values = (void*)calloc(ct,sizeof(void));
//can initialize values as: values = new void* [3];
int ival = 1;
float fval = 2.0;
char* str = "word";
values[0] = (void*)new int(ival);
values[1] = (void*)new float(fval);
values[2] = (void*)str;

for ( int i = 0; i < ct; i++ ) [
    delete( values[i] );
}
free( values ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T20:28:00.513

如果您在 C 中做事（在此处引用标签），我不确定您为什么要使用 new。

我会 malloc 我需要的数组的各个部分，然后我想在完成后释放它们。你不能释放你没有首先 malloc 的东西。您也不能删除 void 指针。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T20:49:18.710

请注意，您也没有删除 values[0] 和 values[1] 这是内存泄漏，但是根据您的设计，您不能释放 values[2]，因为它是指向您的 .data 部分的指针。

# database - 用于在度量空间中进行索引和搜索的很好解释的算法

> ID：206270
> 
> 赞同：3
> 
> 时间：2008-10-15T20:21:42.197
> 
> 标签：database, algorithm, postgresql, data-mining

我需要在 Postgres(*)（PL 或 PL/Python）中实现某种度量空间搜索。所以，我正在寻找好的资源（或论文），对这些想法背后的机制有一个非常清晰和清晰的解释，这样我就可以自己实现它。

我更喜欢清晰而不是效率。

[(*)此处](https://stackoverflow.com/questions/122990/how-to-determine-if-a-record-in-every-source-represents-the-same-person)更好地描述了对此的需求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T20:31:16.670

尤其是地理数据，先看看[PostGIS](http://postgis.refractions.net/)，看看是否需要实现什么。[如果您这样做，请从GiST 上](http://en.wikipedia.org/wiki/GiST)的 Wikipedia 条目中列出的论文开始。

查看您的链接，您的度量空间似乎是具有某种编辑距离作为度量的字符串。[Navarro、Baeza-Yates、Sutinen 和 Tarhio，IEEE Data Engineering Bulletin，2001](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.11.5629)给出了一些解决方案的不错但过时的概述；Citeseer 上的相关论文也可能有用。[Locality Sensitive Hashing](http://www.mit.edu/~andoni/LSH/)是一种可能有用的新技术，但很多论文都侧重于数学。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T07:59:06.907

[BK-Trees](http://en.wikipedia.org/wiki/BK-tree)可用于索引和搜索任何遵守三角不等式的事物，包括度量空间。典型示例是在目标的给定编辑距离内搜索字符串。[我在这里](http://blog.notdot.net/archives/30-Damn-Cool-Algorithms,-Part-1-BK-Trees.html)写了一篇关于这个的文章。

不幸的是，在 Postgres 中没有内置的支持。您可以使用[GIST](http://www.postgresql.org/docs/8.3/interactive/gist-intro.html)自己实现它，但显然这将是很多工作。如果不编写自己的索引而不是将树存储在表中，我想不出任何方法来实现它，这显然不会非常有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T10:10:04.467

您可以尝试[http://sisap.org](http://sisap.org)，其中列出了许多现代指标索引，包括 BK-trees。您可以在 C 中找到代码来尝试不同的替代方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-15T20:35:24.323

一些可能对您有所帮助的涉及空间搜索的技术是爬山、神经网络训练、遗传算法和粒子群。

您还需要在度量空间上定义距离度量。你这样做了吗？（出于好奇，如果你这样做了，那是什么）

# c++ - 隐藏私有数据成员？(C++)

> ID：206272
> 
> 赞同：44
> 
> 时间：2008-10-15T20:22:04.520
> 
> 标签：c++, class, private

有没有办法在 cpp 文件中向用户隐藏 C++ 类的私有数据成员？我认为私有成员是实现的一部分，在头文件中声明它们似乎有点倒退。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-10-15T20:23:48.247

“pimpl”成语是通常如何处理的。

看

*   [http://www.gotw.ca/gotw/024.htm](http://www.gotw.ca/gotw/024.htm)
*   [http://www.gotw.ca/gotw/028.htm](http://www.gotw.ca/gotw/028.htm)
*   [http://herbsutter.com/gotw/_100/](http://herbsutter.com/gotw/_100/)（针对 C++11 更新）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-15T20:28:06.847

你想使用像 PIMPL 成语这样的东西

[http://en.wikipedia.org/wiki/Opaque_pointer](http://en.wikipedia.org/wiki/Opaque_pointer)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T20:24:10.850

见[Pimpl 成语](http://en.wikipedia.org/wiki/Opaque_pointer)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-15T20:23:57.463

执行此操作的经典方法是使用指向实现该功能的内部类的代理指针。据我所知，没有办法在 C++ 中进行部分类定义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-25T17:57:34.090

去商业化？;)

您可以创建头文件，在其中您只声明公共和受保护的 API。

用户只看到这些，他们可以包括在内。他们将代码与您使用完整 API 和定义构建的库链接。

对于内联函数：确保它们在非内联代码中使用，然后库中会有一个可用的定义（但是我不确定它是否会在用户实现中内联）。

对于模板化代码，没有真正的解决方法。一种半心半意的解决方案是编写代码，它使用具有不同对象类型的模板化代码。用户将仅限于这些，因为它们是您的库中唯一可用的定义。

# asp.net - 确保页面级安全性的最佳方法

> ID：206276
> 
> 赞同：2
> 
> 时间：2008-10-15T20:23:07.187
> 
> 标签：asp.net, security

我希望确保用户可以通过“区域”访问 aspx 页面。例如，“财务”是一些用户不应访问的安全区域。

结果不应该涉及诸如 MVP、MVC、MVVM 等模式。我正在寻找轻巧快速的东西。

为了使事情更容易，我有一个基类，每个 aspx 页面都派生自该基类。与给定用户ID的安全区域相比，检查每个页面的最简单/最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T20:32:09.803

我已经使用了这个，它是否是最好的方法是非常值得怀疑的。我有一个从 Page 派生的类，称为 SecurePage。我通常在数据库中有一个交叉表，其中列出了对象（例如页面）以及有权访问该页面的组/用户。使用用户 ID 和对象名称（在本例中为页面名称，但可以是字段或其他）运行存储过程，它会返回该用户或用户所属的组是否具有访问权限。您可以在页面初始化期间检查这一点，如果不匹配，则 response.redirect 它们或您想做的任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T20:44:41.090

您基本上需要创建一个小 ACL 实现。（访问控制列表）。

创建一个 acl_roles 表，其中包含您的所有角色（管理员、会计、其他、访客）和其他内容。然后将它的 id 与您的用户表链接起来，这样每个用户都有一个 role_id。

然后定义一个 acl_resources 表，您可以在其中添加应用程序中的“区域”以及访问它所需的最低角色。

然后在每个脚本开始时简单地检查当前用户是否有足够的权限进入该区域。

有更多的细节，但这是基本的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T20:38:41.647

是的，使用表单或 Windows 身份验证。您可以根据经过身份验证的用户角色轻松锁定站点的不同部分。查看使用[位置](http://support.microsoft.com/kb/316871)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-15T20:30:57.467

为什么不直接使用 .NET 中内置的表单身份验证等安全功能？这很容易。

# java - Object(Output|Input)Stream二进制协议

> ID：206278
> 
> 赞同：0
> 
> 时间：2008-10-15T20:23:44.877
> 
> 标签：java, serialization, binary, protocols, objectoutputstream

我想知道是否有人有一些资源来描述`ObjectOutputStream`. 我当然意识到对象本身可以通过实现`Externalizable`接口来指定它们的数据，所以我想我更多地关注对象图的结构——如果你愿意的话，元数据。

我正在编写一个必须与遗留 Java 程序对话的 C 程序。我无法更改这些要求中的任何一个，因此我发现自己对`ObjectOutputStream`协议进行了逆向工程。（有一个服务器使用 HTTP 进行传输并返回 Object*Stream 作为 HTTP 响应。）

但是，我觉得那里的其他人必须以前做过这项工作。你能指出任何资源来加快我的工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T20:28:44.773

[http://java.sun.com/javase/6/docs/technotes/guides/serialization/index.html](http://java.sun.com/javase/6/docs/technotes/guides/serialization/index.html)

从那里

[http://java.sun.com/javase/6/docs/platform/serialization/spec/protocol.html](http://java.sun.com/javase/6/docs/platform/serialization/spec/protocol.html)

# coding-style - 你如何告诉别人他们正在编写糟糕的代码？

> ID：206286
> 
> 赞同：217
> 
> 时间：2008-10-15T20:24:42.270
> 
> 标签：coding-style

我一直在和一小群人一起做一个有趣的编码项目。这是一个有组织且相当有凝聚力的团体。与我一起工作的人都有各种与编程相关的技能，但其中一些人使用了旧的或完全错误的方法，例如过多的全局变量、糟糕的命名约定和其他东西。虽然一切正常，但实施很差。有什么好的方法可以礼貌地询问或介绍他们使用更好的方法，而不是质疑（或侮辱）他们的经验和/或教育？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2008-10-15T20:38:13.053

提出问题，让他们意识到他们所做的事情是错误的。例如，问这些问题：

> 您为什么决定将其设为全局变量？
> 
> 你为什么给它起这个名字？
> 
> 那很有意思。我通常这样做是因为[插入你更好的原因]
> 
> 这种方式行得通吗？我通常[插入你如何让他们看起来很傻]

我认为解决这个问题的理想方法是巧妙地询问他们为什么要以某种方式编码。您可能会发现他们认为其他方法也有好处。除非我知道他们的编码风格的原因是由于错误信息，否则我永远不会在没有充分理由的情况下判断我的方式更好。解决这个问题的最好方法就是问他们为什么选择这种方式；一定要听起来对他们的推理感兴趣，因为那是你需要攻击的，而不是他们的能力。

编码标准肯定会有所帮助，但如果它是每个软件项目的答案，那么我们都会在天堂里的私人岛屿上啜饮鸡尾酒。实际上，我们都容易出现问题，软件项目的成功率仍然很低。我认为问题主要源于个人能力，而不是惯例问题，这就是为什么我建议当问题出现时作为一个团队解决问题。

最重要的是，**不要立即假设您的方式更好**。实际上，它可能是，但我们正在处理另一个人的意见，对他们来说只有一个解决方案。永远不要说你的方式是更好的方式，除非你想让他们认为你是一个自鸣得意的失败者。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-10-15T21:14:18.970

开始进行代码审查或结对编程。

如果团队不接受这些，请尝试每周进行设计审查。每周，开一个小时，讨论一段代码。如果人们看起来很防御，那就选择没有人再依恋的旧代码，至少在开始时是这样。

**正如@JesperE：所说，专注于代码，而不是编码器。**

当你看到一些你认为应该不同的东西，但其他人不这么看时，那就从提出导致缺陷的问题开始，而不是指出它们。例如：

**Globals**：你认为我们会想要不止一个吗？你认为我们会想要控制对此的访问吗？

**可变状态**：你认为我们会想从另一个线程操作它吗？

我还发现专注于*自己的*局限性很有帮助，这可以帮助人们放松。例如：

**长功能**：我的大脑不够大，无法同时容纳所有这些。我们怎样才能制作出我可以处理的更小的碎片？

**坏名字**：阅读清晰的代码时，我很容易感到困惑；当名称具有误导性时，我就没有希望了。

归根结底，你的目标不是教你的团队如何更好地编码。这是在你的团队中建立一种学习文化。每个人都向其他人寻求帮助以成为更好的程序员。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2008-10-15T20:28:10.700

介绍代码标准的概念。代码标准最重要的一点是它提出了代码库中的一致性概念（**理想情况下**，所有代码都应该看起来像是一个人一次性编写的），这将导致代码更易于理解和维护。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-10-15T20:32:09.727

你必须解释**为什么你的方式更好**。

解释为什么一个函数比剪切和粘贴更好。

解释为什么数组比 $foo1、$foo2、$foo3 更好。

解释为什么全局变量是危险的，而局部变量会让生活更轻松。

简单地制定一个编码标准并说“这样做”是没有价值的，因为它没有向程序员解释为什么这是一件好事。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-15T20:31:07.433

首先，我会小心不要太快做出判断。很容易将某些代码视为糟糕的代码，因为它可能有充分的理由（例如：使用具有奇怪约定的遗留代码）。但是让我们暂时假设它们真的很糟糕。

您可以建议根据团队的意见建立一个编码标准。但是你真的需要考虑他们的意见，而不仅仅是强加你对好的代码应该是什么的看法。

另一种选择是将技术书籍带入办公室（Code Complete、Effective C++、Pragmatic Programmer...）并提供借给其他人（“嘿，我读完了，有人想借吗？” )

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-15T20:32:30.833

如果可能，请确保他们明白您是在批评他们的**代码**，而不是他们个人。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-15T20:26:22.810

以非对抗的方式提出更好的替代方案。

“嘿嘿，我觉得这样也行，你们觉得呢？” [在屏幕上显示更好的代码的手势]

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-16T11:34:10.187

进行代码审查，并从审查**您**的代码开始。

它将使人们对整个代码审查过程感到轻松，因为您是通过审查自己的代码而不是他们的代码来开始这个过程的。从你的代码开始也会给他们很好的例子来说明如何做事。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-10-15T20:29:51.510

他们可能认为你的风格也很臭。召集团队讨论一套一致的编码风格指南。同意某事。这是否适合你的风格不是问题，只要它是一致的，就可以选择任何风格才是最重要的。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-10-15T20:28:47.410

举个例子。向他们展示正确的方式。

慢慢来。不要一开始就因为每一个小错误而抨击他们，从真正重要的事情开始。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-10-15T20:29:50.697

代码标准的想法是一个很好的想法。

但是考虑什么*都不*说，特别是因为它是为了好玩，大概是你的朋友。这只是代码...

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-10-16T15:40:03.480

Gerry Weinberg 的《计算机编程心理学》一书中有一些非常好的建议——他关于“无我编程”的整个概念都是关于如何帮助人们接受对其代码的批评，而不是对自己的批评。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-10-15T20:58:44.960

使用一些 wiki 软件在您的网络上创建一个 wiki。

在您的网站上创建一个名为“最佳实践”或“编码标准”之类的类别。

给大家指点。允许反馈。

当您发布软件时，让负责将代码放入构建中的人回推开发人员，将他们指向其中的 Wiki 页面。

我已经在我的组织中完成了这项工作，人们花了几个月的时间才真正掌握了使用 Wiki 的窍门，但现在它已成为不可或缺的资源。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-10-16T22:44:15.467

不好的命名习惯：总是不可原谅的。

是的，不要总是假设你的方式更好......这可能很困难，但必须保持客观性。

我有过一个编码器的经验，它对函数的命名如此糟糕，代码比不可读还要糟糕。这些函数对他们做了什么撒了谎，代码是荒谬的。他们保护/抵制让其他人更改他们的代码。当非常礼貌地面对时，他们承认它的名字很糟糕，但希望保留他们对代码的所有权，并会在“以后”返回并修复它。现在这是过去了，但是您如何处理错误被确认但随后受到保护的情况？这种情况持续了很长时间，我不知道如何突破这个障碍。

全局变量：我自己并不喜欢全局变量，但我认识一些非常喜欢它们的优秀程序员。以至于我开始相信它们在许多情况下实际上并没有那么糟糕，因为它们允许清晰，易于调试。（请不要抨击/否决我:)）归根结底，我已经看到了很多非常好的、有效的、无错误的代码，它们使用了全局变量（不是我输入的！）和大量的错误，不可能阅读/维护/修复精心使用正确模式的代码。也许全局变量有*一个*位置（尽管可能会缩小）？我正在考虑根据证据重新考虑我的立场。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-15T20:28:58.577

如果你甚至有一个宽松的编码标准，能够指出这一点，或者指出你不能遵循代码，因为它不是正确的格式可能是值得的。

如果您没有编码格式，那么现在是制定编码格式的好时机。类似这个问题的答案可能会有所帮助：[https ://stackoverflow.com/questions/4121/team-coding-styles](https://stackoverflow.com/questions/4121/team-coding-styles)

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-10-15T20:33:13.373

我总是坚持'这就是我会做的'。我不会试图教训他们并告诉他们他们的代码是垃圾，而只是给出一个替代观点，希望可以向他们展示一些明显更整洁的东西。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-15T20:44:56.550

让相关人员为他们编写的代表性模块的代码准备一份演示文稿给小组的其他成员，并让 Q&A 处理它（相信我，它会的，如果它是一个好的小组，它甚至不应该变得丑陋）。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-10-15T21:30:09.547

我确实喜欢代码，并且在我的生活中从未上过任何与信息学相关[的](http://en.wikipedia.org/wiki/Design_Patterns)课程：

*“每个人都能写出机器能理解的代码，但不是所有人都能写出人类能理解的代码”*

考虑到这一点，代码中有很多工作要做；）

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-10-16T13:29:37.380

我穿上一件长袍，打开一罐苏格拉底式的方法。

以古希腊哲学家苏格拉底命名的[苏格拉底方法是一种哲学探究形式，提问者在其中探索他人立场的含义，以激发理性思考并阐明思想。](http://en.wikipedia.org/wiki/Socratic_method)这种辩证的方法通常涉及一种对立的讨论，其中一种观点的辩护与另一种观点的辩护是相互对立的。一个参与者可能会导致另一个参与者以某种方式自相矛盾，从而加强询问者自己的观点。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-10-18T14:56:57.873

我不能足够强调耐心。我已经看到这种确切的事情完全适得其反，主要是因为有人希望现在发生变化。**相当多的环境需要进化的好处，而不是革命。**而通过今天的强制改变，它会给所有人带来一个非常不愉快的环境。

买入是关键。你的方法需要考虑到你所处的环境。

听起来你处于一个有很多“个性”的环境中。所以......我不会建议一套编码标准。你会发现你想把这个“有趣”的项目变成一个高度结构化的工作项目（哦，太好了，接下来是什么......功能文档？）。相反，正如其他人所说，您必须在一定程度上处理它。

保持耐心，努力按照你的方向教育他人。从边缘（您的代码与他人交互的点）开始，当与他们的代码交互时，尝试以此为契机讨论他们创建的界面，并询问他们是否可以接受更改（通过你或他们）。并充分解释为什么要进行更改（“它将有助于更好地处理更改子系统属性”或其他任何内容）。不要挑剔并尝试改变你认为错误的一切。一旦您与边缘的其他人进行交互，他们应该开始了解这将如何在他们的代码核心中使他们受益（如果您获得足够的动力，请更深入并真正开始讨论现代技术和编码标准的好处）。如果他们仍然没有看到它......也许你'

耐心。进化，而不是革命。

祝你好运。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-10-15T21:00:04.710

这里的很多答案都与代码格式有关，如今这些都不是特别相关，因为大多数 IDE 会以您选择的样式重新格式化您的代码。真正重要的是代码是如何工作的，发帖者正确地查看了全局变量、复制和粘贴代码，以及我最讨厌的命名约定。有坏代码之类的东西，它与格式无关。

好的部分是，其中大部分都是有很好的理由的，而这些原因通常是可以量化和解释的。所以，以非对抗的方式，解释原因。在许多情况下，您甚至可以为编写者提供问题变得明显的场景。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-10-16T11:21:00.900

我不是我项目的主要开发人员，因此不能强加编码标准，但我发现糟糕的代码通常迟早会导致问题，而且当它出现时，我会有一个更清晰的想法或解决方案。

通过当时不插话并采取更自然的方法，我获得了领导的更多信任，他经常向我寻求想法，并让我参与项目使用的架构设计和部署策略。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-10-17T13:19:39.350

人们编写糟糕的代码只是无知的表现（这与愚蠢不同）。这里有一些与这些人打交道的技巧。

*   人们自己的经历给人留下的印象比你会说的话更强烈。
*   有些人对他们生成的代码没有热情，不会听你说什么
*   结对编程可以帮助分享想法，但可以切换谁在开车，否则他们只会在手机上查看电子邮件
*   不要过多地淹没他们，我发现即使是持续集成也需要向一些年长的开发人员解释几次
*   让他们再次兴奋起来，他们就会想要学习。这可能就像为机器人编程一天一样简单
*   相信你的团队，在构建时检查它们的编码标准和工具通常永远不会被阅读或烦人。
*   删除代码所有权，在某些项目中，您会看到代码孤岛或蚁丘，人们说那是我的代码并且您无法更改它，这非常糟糕，您可以使用配对编程来删除它。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-10-17T18:55:47.190

与其让他们编写代码，不如让他们维护自己的代码。

除非他们不得不维持他们那一堆热气腾腾的意大利面，否则他们永远不会明白自己在编码方面有多糟糕。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-10-19T08:48:25.837

没有人喜欢听别人说他们的工作很糟糕，但任何理智的人都会欢迎指导和避免不必要工作的方法。

一所教学学校甚至说你不应该指出错误，而应该专注于做对的事情。例如，与其指出难以理解的代码不好，不如指出他们的代码在哪里特别容易阅读。在第一种情况下，您正在引导其他人像蹩脚的程序员一样思考和行动。在后一种情况下，您正在准备像熟练的专业人士一样思考。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-10-18T05:21:04.370

我和我一起工作的人也有类似的情况。他们不像我那样接触编码，但他们在编码方面仍然很有用。

而不是我让他们做他们想做的事，然后回去编辑整个事情。我通常只是让他们坐下来，向他们展示两种做事方式。Thier way 和 My way，从这里我们讨论了每种方法的优缺点，因此对我们应该如何进行编程有更好的理解和更好的结论。

这是真正令人惊讶的部分。有时他们会提出连我都没有答案的问题，经过研究，我们都对方法和结构有了更好的概念。

1.  讨论。
2.  告诉他们为什么
3.  甚至不要认为你总是对的。有时甚至他们会教你一些新东西。

如果我是你，我会这样做：D

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-15T20:29:42.430

效果可能有点晚了，但这是一个公认的编码标准是一件好事。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-10-15T20:51:56.690

私下询问一些“糟糕”的代码段，着眼于它实际上是*合理*的代码的可能性，（不管你有多容易），或者可能有情有可原的情况。如果你仍然确信代码很糟糕——而且源代码实际上就是这个人——那就走开。可能会发生以下几种情况之一：1）此人注意到并采取了一些纠正措施，2）此人什么都不做（没有注意到，或者不像您那样关心）。

如果 #2 发生了，或者从您的角度来看，#1 没有带来足够的改进，并且它正在损害项目，和/或对您的影响足够大，那么可能是时候开始一项活动以在内部建立/执行标准了团队。这需要管理层的支持，但在基层发起时最有效。

祝你好运。我感觉到你的痛苦兄弟。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-10-15T21:11:17.197

我坦率地相信，当某人的代码更容易更改、调试、导航、理解、配置、测试和发布时，它会更好（哇）。

也就是说，我认为如果不先让他/她解释它的作用或以后应该如何增强它（例如，创建新的功能或调试它），就不可能告诉某人他/她的代码不好。

只有这样他们的头脑才会清醒，任何人都可以看到：

*   全局变量值的变化几乎总是无法追踪
*   庞大的函数难以阅读和理解
*   模式使您的代码更容易增强（只要您遵守它们的规则）
*   （ ETC...）

也许结对编程的会话应该可以解决问题。至于执行编码标准 - 它有帮助，但它们离真正定义什么是好的代码太远了。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-15T21:45:17.020

您可能希望关注不良代码的*影响*，而不是仅仅因为您对代码是好还是坏的风格的主观看法而被忽视。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-10-16T02:21:24.420

并不是说我真的要添加这么多，但我必须同意，在你的方法中要考虑的两个最重要的事情是解释你的推理，并允许有问题的编码人员解释他们的推理。糟糕的代码不是凭空而来的（是的，“糟糕的代码”肯定是一个值得讨论的术语——我有点假设在这种情况下你可以定义什么是好代码和坏代码）。

我发现提问式教育方法对我的团队很有效。我尽量不要在没有任何讨论或解释的情况下说“这样做”。

虽然你应该对此有点敏感，但你不能粉饰这个问题。理想的情况是，您的团队正在考虑他们正在编写的代码，而不仅仅是代码在做什么，而是代码是如何编写的。

最后，我要补充一点，关于这个主题有许多值得探索的书籍——我最喜欢的是 Microsoft .NET BCL 团队的 Brad Abrams 和 Krystof Kwalina（等人）的《框架设计指南》。它在讨论和解释所做的决定方面做得非常出色，并展示了内部未遵循指导方针的地方以及由此产生的后果。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2008-10-16T05:26:25.000

在他面前只是重构他的代码并显示两个版本之间的差异。他肯定会喜欢的。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-10-16T05:30:54.273

我建议对这个问题采取积极的态度。与其指责你的同事使用糟糕的风格，不如提出一些关于风格和评论指南的建议，让你的整个团队都可以遵循。

例如，如果你们主要是 .NET 商店，建议遵循 Microsoft 的 C# 风格和评论指南，因为这将使您更符合该社区的标准实践。

您还可以指出一些遵循统一代码样式的示例——例如，如果不熟悉代码库的人浏览它，他们不必破译多种样式。可以这样想：如果你在看一本书，很容易看出每一章都是由不同的人写的，看了几章你会不会糊涂？

我认为重要的是不要以负面的方式批评你的同事。最好向某人推销变革的好处，这比说服他们写蹩脚的代码要容易得多。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2008-10-16T05:42:24.763

我真的很喜欢[EnderMB 的回答](https://stackoverflow.com/questions/206286/how-do-you-tell-someone-theyre-writing-bad-code#206358)，但我想补充一点：

营造一个鼓励讨论代码质量而不是被视为敏感或禁忌的环境。例如，我参与了一个开源项目（一个 Python 库），其中经常与小组讨论新代码和错误修复。说“嘿，我认为这样做更好”不仅可以，而且实际上是*鼓励*的，也是我们用于维护高质量代码的过程的一部分。

我意识到并不是每个环境都有利于这种过程，但它确实对我们很有效。每次代码提交都不必是委员会会议，但希望您可以完全接受讨论有问题或非最佳代码并寻求改进。毕竟，更好的代码对团队中的每个人都更好，团队合作的一个主要概念是一起工作，而不是作为一个松散的个人群体。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2008-11-27T02:29:53.103

即使有人明显犯了错误，激励和指导人们并表现出尊重也很重要。但是应该有方法不仅可以指导，而且可以说明错误就是错误。糟糕的代码应该做得更好。这不是可选的。从他的主管的角度来看，员工应该知道哪些代码可以，哪些代码不行。仍然应该尊重并激励那些负责改进的人。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-01-21T02:06:49.097

取决于程序员。有些人实际上喜欢听到“这很糟糕”，因为他们知道代码有异味，但不知道为什么。

其他程序员需要多一点。我发现告诉他们不好的事情是好的；“这不是编写代码的好方法”，然后是一些指导“在这里，看看我们是否这样做，它的可读性更高/警告更少/无论如何”。建设性的批评有帮助；如果你不能把钱放在嘴边，并且实际上做得更好，你最好不要发表评论，即使你知道这很糟糕。

这两种方法都失败的唯一一个人是一个顽固的管理员助理，他正在用 VBscript 编写大量的宏，然后一切都倒退。她居然有胆子告诉我，我对计算机编程一无所知，我可以向她的 1337 sk1l50rz 学习。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2009-08-05T18:32:11.270

这完全取决于您编写的文化。在一个自由软件项目中，您告诉他们他们正在编写糟糕的代码，并提供积极的建议、改进方法和反馈。您还可以向他们发送代码补丁。

一封友好的电子邮件也永远不会受到伤害。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2012-01-06T09:34:23.200

根据我的经验，曾经有一段时间我们想将 Windows 应用程序更改为 Web 应用程序并对其进行优化，因为它更易于更新和维护。但由于我的朋友是 Windows 应用程序的主要贡献者，他不允许更改，剩下的就是历史了。

***道德：为了代码优化和更好的维护而更重视组织的目标，这将在任何编程环境中发挥重要作用。***

# security - Are there any HTTP/HTTPS interception tools other than Fiddler, Charles, Poster, and Achilles?

> ID：206318
> 
> 赞同：30
> 
> 时间：2008-10-15T20:31:05.687
> 
> 标签：security, http, testing, https

I'm in the process of testing my application with respect to security.

Aside from [Fiddler](http://www.fiddler2.com/fiddler2/), [Charles](http://www.charlesproxy.com/) and [Poster](https://addons.mozilla.org/en-us/firefox/addon/poster/) (Firefox plug in). Are there any other free to use https interception (and editing) applications out there? Especially ones which can be installed w/o admin privileges.

Achilles comes to mind, but I don't think it can handle https traffic.

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-24T17:28:57.083

Achilles does work on HTTPS traffic, but they note on their site that it is not the best tool any more.

Their suggestions are [Burp Suite](http://portswigger.net/burp/) and [WebScarab](http://www.owasp.org/index.php/Category:OWASP_WebScarab_Project) both of which I highly recommend.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-01T11:54:53.143

[OWASP ZAP](https://www.owasp.org/index.php/ZAP) - its free, open source and cross platform.

Its also the most active open source web security tool and came first and second in the last 2 'Top Security Tools' surveys run by Toolswatch.org ([2013](https://www.toolswatch.org/2015/01/2014-top-security-tools-as-voted-by-toolswatch-org-readers/), [2014](http://www.toolswatch.org/2013/12/2013-top-security-tools-as-voted-by-toolswatch-org-readers/))

It was originally forked from Paros, which is no longer maintained, but it now has loads more functionality.

Its an OWASP Flagship project having replaced WebScarab, which is also essentially no longer maintained.

Simon (ZAP Project Lead)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T21:00:41.430

[Wireshark](http://www.wireshark.org/) is amazing. It captures everything on the network so you'll need to filter down to http/https: [http://wiki.wireshark.org/CaptureFilters](http://wiki.wireshark.org/CaptureFilters).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T17:23:32.897

There are a few programs that I would suggest.

Paros Proxy and Ratproxy have already been noted.

[scapy](http://www.secdev.org/projects/scapy/) is a powerful packet manipulation tool, and has all of the sniffing and monitoring capabilities as well. [dsniff](http://www.monkey.org/~dugsong/dsniff/) is a suite of tools that allows manipulation, injection, and all sorts of interception and modification options.

There is also a plugin for IE called [Tamper IE](http://www.bayden.com/TamperIE/) that has a simple GUI based packet editor.

All of these are free.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T21:10:29.680

Doing more research I came across [Paros Proxy](http://www.parosproxy.org/). Seems to be a good alternative to the others.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T21:32:46.687

I'd strongly recommend [HttpWatch](http://www.httpwatch.com/). I believe the basic version is free and captures your HTTPS traffic to some extent. The Professional version is worth the money.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T21:35:24.933

Have a look at [ratproxy](http://code.google.com/p/ratproxy/). It may not be exactly what you're asking for, but is very useful in testing the security of your web app.

Rather than intercepting HTTP and allowing you to edit or replay requests, it installs as a proxy and monitors the normal use of your web app, and then provides a report on possible security issues, along with their severity. It can also be configured to attempt active XSS or XSRF attacks where it thinks there is a vulnerability.

The site says "Ratproxy is currently believed to support Linux, FreeBSD, MacOS X, and Windows (Cygwin) environments" but I've only used it on Linux.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-21T10:23:36.200

Check [HTTP Debugger Pro](http://www.httpdebugger.com)

It is proxy-less solution and have zero impact to the transferring data.

Also it has modern user interface :)

# perl - Perl 如何区分文件和目录？

> ID：206320
> 
> 赞同：20
> 
> 时间：2008-10-15T20:31:15.640
> 
> 标签：perl, file, directory

我试图遍历 Perl 中当前目录的所有子目录，并从这些文件中获取数据。我正在使用 grep 获取给定目录中所有文件和文件夹的列表，但我不知道返回的值中哪个是文件夹名称，哪个是没有文件扩展名的文件。

我怎么能分辨出区别？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-15T20:47:09.883

您可以使用**-d**文件测试运算符来检查某物是否是目录。以下是一些常用的文件测试运算符

```
    -e 文件存在。
    -z 文件大小为零（为空）。
    -s 文件具有非零大小（以字节为单位返回大小）。
    -f 文件是一个普通文件。
    -d 文件是一个目录。
    -l 文件是符号链接。

```

有关更多信息，请参见[perlfunc 手册页](http://perldoc.perl.org/perlfunc.html#-X-FILEHANDLE)

另外，尝试使用[File::Find](http://search.cpan.org/~rgarcia/perl-5.10.0/lib/File/Find.pm)可以为您递归目录。这是一个查找目录的示例....

```
sub wanted {
     if (-d) { 
         print $File::Find::name." is a directory\n";
     }
}

find(\&wanted, $mydir); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-15T20:35:07.740

```
print "$file is a directory\n" if ( -d $file ); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-15T20:39:09.960

查看 -X 运算符：

```
perldoc -f -X 
```

对于目录遍历，请使用 File::Find，或者，如果您不是受虐狂，请使用我的 File::Next 模块，它为您创建了一个迭代器，并且不需要疯狂的回调。事实上，你可以让 File::Next 只返回文件，而忽略目录。

```
use File::Next;

my $iterator = File::Next::files( '/tmp' );

while ( defined ( my $file = $iterator->() ) ) {
    print $file, "\n";
}

# Prints...
/tmp/foo.txt
/tmp/bar.pl
/tmp/baz/1
/tmp/baz/2.txt
/tmp/baz/wango/tango/purple.txt 
```

它位于[http://metacpan.org/pod/File::Next](http://metacpan.org/pod/File::Next)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-15T20:37:21.650

```
我的 $dh = opendir(".");
我的@entries = grep !/^\.\.?$/, readdir($dh);
关闭$dh；

foreach 我的 $entry (@entries) {
    如果（-f $entry）{
        # $entry 是一个文件
    } elsif (-d $entry) {
        # $entry 是一个目录
    }
}

```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-21T19:51:52.143

```
my @files = grep { -f } @all;
my @dirs = grep { -d } @all; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T20:37:35.363

它会更容易使用`File::Find`。

# c# - 如何：在 C# 中执行命令行，获取 STD OUT 结果

> ID：206323
> 
> 赞同：500
> 
> 时间：2008-10-15T20:31:19.353
> 
> 标签：c#, command-line

如何从 C# 执行命令行程序并取回 STD OUT 结果？具体来说，我想对以编程方式选择的两个文件执行 DIFF 并将结果写入文本框。

* * *

## 回答 #1

> 赞同：561
> 
> 时间：2008-10-15T20:36:05.147

```
// Start the child process.
 Process p = new Process();
 // Redirect the output stream of the child process.
 p.StartInfo.UseShellExecute = false;
 p.StartInfo.RedirectStandardOutput = true;
 p.StartInfo.FileName = "YOURBATCHFILE.bat";
 p.Start();
 // Do not wait for the child process to exit before
 // reading to the end of its redirected stream.
 // p.WaitForExit();
 // Read the output stream first and then wait.
 string output = p.StandardOutput.ReadToEnd();
 p.WaitForExit(); 
```

代码来自[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)。

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2008-10-15T20:39:22.847

这是一个快速示例：

```
//Create process
System.Diagnostics.Process pProcess = new System.Diagnostics.Process();

//strCommand is path and file name of command to run
pProcess.StartInfo.FileName = strCommand;

//strCommandParameters are parameters to pass to program
pProcess.StartInfo.Arguments = strCommandParameters;

pProcess.StartInfo.UseShellExecute = false;

//Set output of program to be written to process output stream
pProcess.StartInfo.RedirectStandardOutput = true;   

//Optional
pProcess.StartInfo.WorkingDirectory = strWorkingDirectory;

//Start the process
pProcess.Start();

//Get program output
string strOutput = pProcess.StandardOutput.ReadToEnd();

//Wait for process to finish
pProcess.WaitForExit(); 
```

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2009-09-28T18:36:49.353

还有一个我发现有用的参数，我用它来消除进程窗口

```
pProcess.StartInfo.CreateNoWindow = true; 
```

如果这是您想要的，这有助于完全隐藏用户的黑色控制台窗口。

* * *

## 回答 #4

> 赞同：104
> 
> 时间：2012-04-09T10:45:04.187

```
// usage
const string ToolFileName = "example.exe";
string output = RunExternalExe(ToolFileName);

public string RunExternalExe(string filename, string arguments = null)
{
    var process = new Process();

    process.StartInfo.FileName = filename;
    if (!string.IsNullOrEmpty(arguments))
    {
        process.StartInfo.Arguments = arguments;
    }

    process.StartInfo.CreateNoWindow = true;
    process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
    process.StartInfo.UseShellExecute = false;

    process.StartInfo.RedirectStandardError = true;
    process.StartInfo.RedirectStandardOutput = true;
    var stdOutput = new StringBuilder();
    process.OutputDataReceived += (sender, args) => stdOutput.AppendLine(args.Data); // Use AppendLine rather than Append since args.Data is one line of output, not including the newline character.

    string stdError = null;
    try
    {
        process.Start();
        process.BeginOutputReadLine();
        stdError = process.StandardError.ReadToEnd();
        process.WaitForExit();
    }
    catch (Exception e)
    {
        throw new Exception("OS error while executing " + Format(filename, arguments)+ ": " + e.Message, e);
    }

    if (process.ExitCode == 0)
    {
        return stdOutput.ToString();
    }
    else
    {
        var message = new StringBuilder();

        if (!string.IsNullOrEmpty(stdError))
        {
            message.AppendLine(stdError);
        }

        if (stdOutput.Length != 0)
        {
            message.AppendLine("Std output:");
            message.AppendLine(stdOutput.ToString());
        }

        throw new Exception(Format(filename, arguments) + " finished with exit code = " + process.ExitCode + ": " + message);
    }
}

private string Format(string filename, string arguments)
{
    return "'" + filename + 
        ((string.IsNullOrEmpty(arguments)) ? string.Empty : " " + arguments) +
        "'";
} 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2017-11-19T22:10:42.537

此页面上接受的答案有一个弱点，在极少数情况下会很麻烦。按照惯例，程序写入的文件句柄有两个，stdout 和 stderr。如果您只读取单个文件句柄，例如来自 Ray 的答案，并且您正在启动的程序将足够的输出写入 stderr，它将填满输出 stderr 缓冲区并阻塞。然后你的两个进程就死锁了。缓冲区大小可以是 4K。这在短期程序中极为罕见，但如果您有一个长期运行的程序反复输出到 stderr，它最终会发生。这很难调试和跟踪。

有几个很好的方法来处理这个问题。

1.  一种方法是执行 cmd.exe 而不是您的程序，并使用 cmd.exe 的 /c 参数来调用您的程序以及 cmd.exe 的“2>&1”参数来告诉它合并 stdout 和 stderr。

    ```
     var p = new Process();
            p.StartInfo.FileName = "cmd.exe";
            p.StartInfo.Arguments = "/c mycmd.exe 2>&1"; 
    ```

2.  另一种方法是使用同时读取两个句柄的编程模型。

    ```
     var p = new Process();
            p.StartInfo.FileName = "cmd.exe";
            p.StartInfo.Arguments = @"/c dir \windows";
            p.StartInfo.CreateNoWindow = true;
            p.StartInfo.RedirectStandardError = true;
            p.StartInfo.RedirectStandardOutput = true;
            p.StartInfo.RedirectStandardInput = false;
            p.OutputDataReceived += (a, b) => Console.WriteLine(b.Data);
            p.ErrorDataReceived += (a, b) => Console.WriteLine(b.Data);
            p.Start();
            p.BeginErrorReadLine();
            p.BeginOutputReadLine();
            p.WaitForExit(); 
    ```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-15T20:38:50.260

```
 System.Diagnostics.ProcessStartInfo psi =
   new System.Diagnostics.ProcessStartInfo(@"program_to_call.exe");
 psi.RedirectStandardOutput = true;
 psi.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
 psi.UseShellExecute = false;
 System.Diagnostics.Process proc = System.Diagnostics.Process.Start(psi); ////
 System.IO.StreamReader myOutput = proc.StandardOutput;
 proc.WaitForExit(2000);
 if (proc.HasExited)
  {
      string output = myOutput.ReadToEnd();
 } 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-10-29T17:27:03.180

如果您不介意引入依赖项，[CliWrap](https://github.com/Tyrrrz/CliWrap)可以为您简化：

```
using CliWrap;
using CliWrap.Buffered;

var result = await Cli.Wrap("target.exe")
   .WithArguments("arguments")
   .ExecuteBufferedAsync();

var stdout = result.StandardOutput; 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-15T20:36:14.600

您将需要使用`ProcessStartInfo`with `RedirectStandardOutput`enabled - 然后您可以读取输出流。您可能会发现使用“>”将输出重定向到文件（通过操作系统）更容易，然后只需读取文件。

[编辑：就像雷所做的那样：+1]

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-10-08T12:44:44.100

单行运行命令：

```
new Process() { StartInfo = new ProcessStartInfo("echo", "Hello, World") }.Start(); 
```

以最少的可重复代码读取命令的输出：

```
 var cliProcess = new Process() {
        StartInfo = new ProcessStartInfo("echo", "Hello, World") {
            UseShellExecute = false,
            RedirectStandardOutput = true
        }
    };
    cliProcess.Start();
    string cliOut = cliProcess.StandardOutput.ReadToEnd();
    cliProcess.WaitForExit();
    cliProcess.Close(); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-15T20:37:31.213

您可以使用 Process 类启动任何命令行程序，并使用您创建的流读取器（基于字符串或内存位置）设置 Process 实例的 StandardOutput 属性。该过程完成后，您可以在该流上执行您需要的任何差异。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-08-22T12:14:22.470

如果您尝试查询 PC/服务器上的本地 ARP 缓存，这可能对某人有用。

```
List<string[]> results = new List<string[]>();

        using (Process p = new Process())
        {
            p.StartInfo.CreateNoWindow = true;
            p.StartInfo.RedirectStandardOutput = true;
            p.StartInfo.UseShellExecute = false;
            p.StartInfo.Arguments = "/c arp -a";
            p.StartInfo.FileName = @"C:\Windows\System32\cmd.exe";
            p.Start();

            string line;

            while ((line = p.StandardOutput.ReadLine()) != null)
            {
                if (line != "" && !line.Contains("Interface") && !line.Contains("Physical Address"))
                {
                    var lineArr = line.Trim().Split(' ').Select(n => n).Where(n => !string.IsNullOrEmpty(n)).ToArray();
                    var arrResult = new string[]
                {
                   lineArr[0],
                   lineArr[1],
                   lineArr[2]
                };
                    results.Add(arrResult);
                }
            }

            p.WaitForExit();
        } 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-01-30T13:48:25.370

如果您还需要在 cmd.exe 中执行某些命令，您可以执行以下操作：

```
// Start the child process.
Process p = new Process();
// Redirect the output stream of the child process.
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "cmd.exe";
p.StartInfo.Arguments = "/C vol";
p.Start();
// Read the output stream first and then wait.
string output = p.StandardOutput.ReadToEnd();
p.WaitForExit();
Console.WriteLine(output); 
```

这仅返回命令本身的输出：

[![在此处输入图像描述](https://i.stack.imgur.com/O545N.png)](https://i.stack.imgur.com/O545N.png)

您也可以使用`StandardInput`代替`StartInfo.Arguments`：

```
// Start the child process.
Process p = new Process();
// Redirect the output stream of the child process.
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardInput = true;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "cmd.exe";
p.Start();
// Read the output stream first and then wait.
p.StandardInput.WriteLine("vol");
p.StandardInput.WriteLine("exit");
string output = p.StandardOutput.ReadToEnd();
p.WaitForExit();
Console.WriteLine(output); 
```

结果如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/d6uj8.png)](https://i.stack.imgur.com/d6uj8.png)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-05-18T10:07:14.933

由于这里的大多数答案都没有实现`using`声明`IDisposable`和其他一些我认为可能是必要的东西，所以我会添加这个答案。

对于 C# 8.0

```
// Start a process with the filename or path with filename e.g. "cmd". Please note the 
//using statemant
using myProcess.StartInfo.FileName = "cmd";
// add the arguments - Note add "/c" if you want to carry out tge  argument in cmd and  
// terminate
myProcess.StartInfo.Arguments = "/c dir";
// Allows to raise events
myProcess.EnableRaisingEvents = true;
//hosted by the application itself to not open a black cmd window
myProcess.StartInfo.UseShellExecute = false;
myProcess.StartInfo.CreateNoWindow = true;
// Eventhander for data
myProcess.Exited += OnOutputDataRecived;
// Eventhandler for error
myProcess.ErrorDataReceived += OnErrorDataReceived;
// Eventhandler wich fires when exited
myProcess.Exited += OnExited;
// Starts the process
myProcess.Start();
//read the output before you wait for exit
myProcess.BeginOutputReadLine();
// wait for the finish - this will block (leave this out if you dont want to wait for 
// it, so it runs without blocking)
process.WaitForExit();

// Handle the dataevent
private void OnOutputDataRecived(object sender, DataReceivedEventArgs e)
{
    //do something with your data
    Trace.WriteLine(e.Data);
}

//Handle the error
private void OnErrorDataReceived(object sender, DataReceivedEventArgs e)
{        
    Trace.WriteLine(e.Data);
    //do something with your exception
    throw new Exception();
}    

// Handle Exited event and display process information.
private void OnExited(object sender, System.EventArgs e)
{
     Trace.WriteLine("Process exited");
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-15T20:35:07.927

这可能不是最好/最简单的方法，但可能是一种选择：

从代码执行时，添加“ > output.txt”，然后读入 output.txt 文件。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-08-12T13:17:53.230

[PublicDomain](http://www.codeplex.com/publicdomain)开源代码中有一个 ProcessHelper 类，您可能会感兴趣。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-07-09T20:20:02.370

Julian 的解决方案经过了一些小的修正测试。以下是同样使用[https://sourceforge.net/projects/bat-to-exe/GenericConsole.cs](https://sourceforge.net/projects/bat-to-exe/)和[https://www.codeproject.com/Articles/19225/Bat-file-compiler](https://www.codeproject.com/Articles/19225/Bat-file-compiler) program.txt的示例对于 args 部分：

```
using System;
using System.Text;  //StringBuilder
using System.Diagnostics;
using System.IO;

class Program
{
    private static bool redirectStandardOutput = true;

    private static string buildargument(string[] args)
    {
        StringBuilder arg = new StringBuilder();
        for (int i = 0; i < args.Length; i++)
        {
            arg.Append("\"" + args[i] + "\" ");
        }

        return arg.ToString();
    }

    static void Main(string[] args)
    {
        Process prc = new Process();
        prc.StartInfo = //new ProcessStartInfo("cmd.exe", String.Format("/c \"\"{0}\" {1}", Path.Combine(Environment.CurrentDirectory, "mapTargetIDToTargetNameA3.bat"), buildargument(args)));
        //new ProcessStartInfo(Path.Combine(Environment.CurrentDirectory, "mapTargetIDToTargetNameA3.bat"), buildargument(args));
        new ProcessStartInfo("mapTargetIDToTargetNameA3.bat");
        prc.StartInfo.Arguments = buildargument(args);

        prc.EnableRaisingEvents = true;

        if (redirectStandardOutput == true)
        {
            prc.StartInfo.UseShellExecute = false;
        }
        else
        {
            prc.StartInfo.UseShellExecute = true;
        }

        prc.StartInfo.CreateNoWindow = true;

        prc.OutputDataReceived += OnOutputDataRecived;
        prc.ErrorDataReceived += OnErrorDataReceived;
        //prc.Exited += OnExited;

        prc.StartInfo.RedirectStandardOutput = redirectStandardOutput;
        prc.StartInfo.RedirectStandardError = redirectStandardOutput;

        try
        {
            prc.Start();
            prc.BeginOutputReadLine();
            prc.BeginErrorReadLine();
            prc.WaitForExit();
        }
        catch (Exception e)
        {
            Console.WriteLine("OS error: " + e.Message);
        }

        prc.Close();
    }

    // Handle the dataevent
    private static void OnOutputDataRecived(object sender, DataReceivedEventArgs e)
    {
        //do something with your data
        Console.WriteLine(e.Data);
    }

    //Handle the error
    private static void OnErrorDataReceived(object sender, DataReceivedEventArgs e)
    {
        Console.WriteLine(e.Data);
    }

    // Handle Exited event and display process information.
    //private static void OnExited(object sender, System.EventArgs e)
    //{
    //    var process = sender as Process;
    //    if (process != null)
    //    {
    //        Console.WriteLine("ExitCode: " + process.ExitCode);
    //    }
    //    else
    //    {
    //        Console.WriteLine("Process exited");
    //    }
    //}
} 
```

代码需要在 VS2007 中编译，使用命令行 csc.exe 生成的可执行文件将无法正确显示控制台输出，甚至会因 CLR20r3 错误而崩溃。把OnExited事件进程注释掉，bat到exe的控制台输出会更像原来的bat控制台输出。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-03-25T11:13:35.083

这是一个小例子：

```
using System;
using System.Diagnostics;

class Program
{
    static void Main(string[] args)
    {
        var p = Process.Start(
            new ProcessStartInfo("git", "branch --show-current")
            {
                CreateNoWindow = true,
                UseShellExecute = false,
                RedirectStandardError = true,
                RedirectStandardOutput = true,
                WorkingDirectory = Environment.CurrentDirectory
            }
        );

        p.WaitForExit();
        string branchName =p.StandardOutput.ReadToEnd().TrimEnd();
        string errorInfoIfAny =p.StandardError.ReadToEnd().TrimEnd();

        if (errorInfoIfAny.Length != 0)
        {
            Console.WriteLine($"error: {errorInfoIfAny}");
        }
        else { 
            Console.WriteLine($"branch: {branchName}");
        }

    }
} 
```

我相信这是最短的形式。

请注意，大多数命令行工具很容易混淆标准输出和标准错误，有时只需将它们组合成一个字符串就很有意义。

有时也`p.ExitCode`可能有用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-03-01T11:37:57.110

只是为了好玩，这是我获得 PYTHON 输出的完整解决方案 - 通过单击按钮 - 并报告错误。只需添加一个名为“butPython”的按钮和一个名为“llHello”的标签......

```
 private void butPython(object sender, EventArgs e)
    {
        llHello.Text = "Calling Python...";
        this.Refresh();
        Tuple<String,String> python = GoPython(@"C:\Users\BLAH\Desktop\Code\Python\BLAH.py");
        llHello.Text = python.Item1; // Show result.
        if (python.Item2.Length > 0) MessageBox.Show("Sorry, there was an error:" + Environment.NewLine + python.Item2);
    }

    public Tuple<String,String> GoPython(string pythonFile, string moreArgs = "")
    {
        ProcessStartInfo PSI = new ProcessStartInfo();
        PSI.FileName = "py.exe";
        PSI.Arguments = string.Format("\"{0}\" {1}", pythonFile, moreArgs);
        PSI.CreateNoWindow = true;
        PSI.UseShellExecute = false;
        PSI.RedirectStandardError = true;
        PSI.RedirectStandardOutput = true;
        using (Process process = Process.Start(PSI))
            using (StreamReader reader = process.StandardOutput)
            {
                string stderr = process.StandardError.ReadToEnd(); // Error(s)!!
                string result = reader.ReadToEnd(); // What we want.
                return new Tuple<String,String> (result,stderr); 
            }
    } 
```

# vba - 如何检查vba宏中的空数组

> ID：206324
> 
> 赞同：64
> 
> 时间：2008-10-15T20:31:20.837
> 
> 标签：vba, excel

我想检查空数组。谷歌给了我各种各样的解决方案，但没有奏效。也许我没有正确应用它们。

```
Function GetBoiler(ByVal sFile As String) As String
'Email Signature
    Dim fso As Object
    Dim ts As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2)
    GetBoiler = ts.ReadAll
    ts.Close
End Function

Dim FileNamesList As Variant, i As Integer
' activate the desired startfolder for the filesearch
FileNamesList = CreateFileList("*.*", False) ' Returns File names
' performs the filesearch, includes any subfolders
' present the result
' If there are Signatures then populate SigString
Range("A:A").ClearContents
For i = 1 To UBound(FileNamesList)
    Cells(i + 1, 1).Formula = FileNamesList(i)
Next i

SigString = FileNamesList(3)

If Dir(SigString) <> "" Then
    Signature = GetBoiler(SigString)
Else
    Signature = ""
End If 
```

这里如果`FileNamesList`数组为空，`GetBoiler(SigString)`则根本不应该被调用。当`FileNamesList`数组为空时，`SigString`也为空，这将调用`GetBoiler()`带有空字符串的函数。我在线上遇到错误

```
Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2) 
```

因为`sFile`是空的。有什么办法可以避免吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-15T21:14:32.120

在处理字符串数组时，您是否考虑过加入？

```
If Len(Join(FileNamesList)) > 0 Then 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-01-17T15:49:47.107

使用三重否定：

```
If (Not Not FileNamesList) <> 0 Then
    ' Array has been initialized, so you're good to go.
Else
    ' Array has NOT been initialized
End If 
```

要不就：

```
If (Not FileNamesList) = -1 Then
    ' Array has NOT been initialized
Else
    ' Array has been initialized, so you're good to go.
End If 
```

在 VB 中，无论出于何种原因，都`Not myArray`返回 SafeArray 指针。对于未初始化的数组，这将返回 -1。如果您愿意，您可以`Not`将其与 -1 进行异或运算，从而返回零。

```
 (Not myArray)   (Not Not myArray)
Uninitialized       -1                 0
Initialized    -someBigNumber   someOtherBigNumber 
```

[资源](http://www.vbforums.com/showthread.php?654880-How-do-I-tell-if-an-array-is-quot-empty-quot&p=4040234&viewfull=1#post4040234)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-03-06T19:10:57.567

如果您对数组函数进行测试，它将适用于所有范围：

```
Function IsVarArrayEmpty(anArray As Variant)

Dim i As Integer

On Error Resume Next
    i = UBound(anArray,1)
If Err.number = 0 Then
    IsVarArrayEmpty = False
Else
    IsVarArrayEmpty = True
End If

End Function 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-06-26T21:26:37.313

我在这里看到类似的答案......但不是我的......

这就是我不幸的处理方式......我喜欢 len(join(arr)) > 0 方法，但如果数组是一个空字符串数组，它就行不通了......

```
Public Function arrayLength(arr As Variant) As Long
  On Error GoTo handler

  Dim lngLower As Long
  Dim lngUpper As Long

  lngLower = LBound(arr)
  lngUpper = UBound(arr)

  arrayLength = (lngUpper - lngLower) + 1
  Exit Function

handler:
  arrayLength = 0 'error occured.  must be zero length
End Function 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-04-01T09:55:22.073

写VBA的时候脑子里有一句话：“本来可以这么简单，但是……”

这是我采用它的目的：

```
Private Function IsArrayEmpty(arr As Variant)
  ' This function returns true if array is empty
  Dim l As Long

  On Error Resume Next
  l = Len(Join(arr))
  If l = 0 Then
    IsArrayEmpty = True
  Else
    IsArrayEmpty = False
  End If

  If Err.Number > 0 Then
      IsArrayEmpty = True
  End If

  On Error GoTo 0
End Function

Private Sub IsArrayEmptyTest()
  Dim a As Variant
  a = Array()
  Debug.Print "Array is Empty is " & IsArrayEmpty(a)
  If IsArrayEmpty(a) = False Then
    Debug.Print "  " & Join(a)
  End If
End Sub 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-15T21:14:01.450

此代码不符合您的预期：

```
If Dir(SigString) <> "" Then
    Signature = GetBoiler(SigString) 
Else
    Signature = "" 
End If 
```

如果您传递一个空字符串 ( `""`) 或`vbNullString`to `Dir`，它将返回当前目录路径中的第一个文件的名称（由 返回的路径`CurDir$`）。因此，如果`SigString`为空，您的`If`条件将评估为，`True`因为`Dir`将返回一个非空字符串（当前目录中第一个文件的名称），`GetBoiler`并将被调用。如果`SigString`为空，则调用`fso.GetFile`将失败。

您应该更改条件以检查是否`SigString`为空，或者使用该`FileSystemObject.FileExists`方法而不是`Dir`检查文件是否存在。`Dir`使用起来很棘手，因为它做了你可能不希望它做的事情。就个人而言，我会使用`Scripting.FileSystemObject`over，`Dir`因为没有有趣的事情（如果文件存在则`FileExists`返回，如果不存在则返回）。更重要的是*，*它比.`True``False``FileExists`*`Dir`*

 ***方法一：先检查`SigString`非空**

```
If SigString <> "" And Dir(SigString) <> "" Then
    Signature = GetBoiler(SigString) 
Else
    Signature = "" 
End If 
```

**方法二：使用`FileSystemObject.FileExists`方法**

```
Dim fso As Object
Set fso = CreateObject("Scripting.FileSystemObject")

If fso.FileExists(SigString) Then
    Signature = GetBoiler(SigString) 
Else
    Signature = "" 
End If 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-09-30T13:52:40.890

我只是将伟大的 Chip Pearson 粘贴在代码下方。它很有魅力。
这是他[关于数组函数的页面](http://www.cpearson.com/excel/vbaarrays.htm)。

我希望这有帮助。

```
Public Function IsArrayEmpty(Arr As Variant) As Boolean
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' IsArrayEmpty
' This function tests whether the array is empty (unallocated). Returns TRUE or FALSE.
'
' The VBA IsArray function indicates whether a variable is an array, but it does not
' distinguish between allocated and unallocated arrays. It will return TRUE for both
' allocated and unallocated arrays. This function tests whether the array has actually
' been allocated.
'
' This function is really the reverse of IsArrayAllocated.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    Dim LB As Long
    Dim UB As Long

    err.Clear
    On Error Resume Next
    If IsArray(Arr) = False Then
        ' we weren't passed an array, return True
        IsArrayEmpty = True
    End If

    ' Attempt to get the UBound of the array. If the array is
    ' unallocated, an error will occur.
    UB = UBound(Arr, 1)
    If (err.Number <> 0) Then
        IsArrayEmpty = True
    Else
        ''''''''''''''''''''''''''''''''''''''''''
        ' On rare occasion, under circumstances I
        ' cannot reliably replicate, Err.Number
        ' will be 0 for an unallocated, empty array.
        ' On these occasions, LBound is 0 and
        ' UBound is -1.
        ' To accommodate the weird behavior, test to
        ' see if LB > UB. If so, the array is not
        ' allocated.
        ''''''''''''''''''''''''''''''''''''''''''
        err.Clear
        LB = LBound(Arr)
        If LB > UB Then
            IsArrayEmpty = True
        Else
            IsArrayEmpty = False
        End If
    End If

End Function 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-04-08T15:49:05.860

Auth 最接近，但他的回答引发类型不匹配错误。

至于其他答案，如果可以的话，您应该避免使用错误来测试条件，因为至少它会使调试复杂化（如果其他原因导致该错误怎么办）。

这是一个简单而完整的解决方案：

```
option explicit
Function foo() As Variant

    Dim bar() As String

    If (Not Not bar) Then
        ReDim Preserve bar(0 To UBound(bar) + 1)
    Else
        ReDim Preserve bar(0 To 0)
    End If

    bar(UBound(bar)) = "it works!"

    foo = bar

End Function 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-10-21T15:25:00.003

空数组的简化检查：

```
Dim exampleArray() As Variant 'Any Type

If ((Not Not exampleArray) = 0) Then
      'Array is Empty
Else
      'Array is Not Empty
End If 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-05-12T15:38:13.597

这是另一种方法。我在某些情况下使用过它并且它正在工作。

```
Function IsArrayEmpty(arr As Variant) As Boolean

Dim index As Integer

index = -1
    On Error Resume Next
        index = UBound(arr)
    On Error GoTo 0

If (index = -1) Then IsArrayEmpty = True Else IsArrayEmpty = False

End Function 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-07-15T22:28:59.727

基于 ahuth 的[回答](https://stackoverflow.com/a/14382846/425678)；

```
Function AryLen(ary() As Variant, Optional idx_dim As Long = 1) As Long
    If (Not ary) = -1 Then
        AryLen = 0
    Else
        AryLen = UBound(ary, idx_dim) - LBound(ary, idx_dim) + 1
    End If
End Function 
```

检查一个空数组；`is_empty = AryLen(some_array)=0`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-01-15T23:14:27.333

```
Public Function IsEmptyArray(InputArray As Variant) As Boolean

   On Error GoTo ErrHandler:
   IsEmptyArray = Not (UBound(InputArray) >= 0)
   Exit Function

   ErrHandler:
   IsEmptyArray = True

End Function 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-05-04T08:43:08.690

您可以使用以下函数检查 vba 中的变量或字符串数​​组是否为空

```
Function IsArrayAllocated(Arr As Variant) As Boolean
        On Error Resume Next
        IsArrayAllocated = IsArray(Arr) And _
                           Not IsError(LBound(Arr, 1)) And _
                           LBound(Arr, 1) <= UBound(Arr, 1)
End Function 
```

示例使用

```
Public Function test()
Dim Arr(1) As String
Arr(0) = "d"
Dim x As Boolean
x = IsArrayAllocated(Arr)
End Function 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-09-30T15:49:37.313

```
Function IsVarArrayEmpty(anArray As Variant) as boolean
    On Error Resume Next
    IsVarArrayEmpty = true
    IsVarArrayEmpty = UBound(anArray) < LBound(anArray)
End Function 
```

也许`ubound`崩溃并且它保持为真，如果`ubound < lbound`，它是空的

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-10-30T06:49:18.373

要检查 Byte 数组是否为空，最简单的方法是使用 VBA 函数`StrPtr()`。

如果 Byte 数组为空，则`StrPtr()`返回`0`; 否则，它返回一个非零值（但是，它**不是**第一个元素的地址）。

```
Dim ar() As Byte
Debug.Assert StrPtr(ar) = 0

ReDim ar(0 to 3) As Byte
Debug.Assert StrPtr(ar) <> 0 
```

但是，它仅适用于字节数组。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-02-11T14:22:17.797

另一种方法是尽早完成。将数据加载到数组后，您可以创建一个布尔变量并将其设置为 true。因此，您真正需要的只是一个简单的 if 语句，说明何时将数据加载到数组中。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-12T19:00:26.393

我将按预期概括问题和问题。对数组进行测试，并捕获最终错误

```
Function IsVarArrayEmpty(anArray as Variant)
Dim aVar as Variant

IsVarArrayEmpty=False
On error resume next
aVar=anArray(1)
If Err.number then '...still, it might not start at this index
    aVar=anArray(0)
    If Err.number then IsVarArrayEmpty=True ' neither 0 or 1 yields good assignment
EndIF
End Function 
```

当然它错过了所有负索引或所有> 1的数组......这可能吗？在异界，是的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-03-27T20:05:13.837

就个人而言，我认为可以修改上述答案之一以检查数组是否有内容：

```
if UBound(ar) > LBound(ar) Then 
```

这处理负数引用并且比其他一些选项花费更少的时间。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-06-19T16:43:05.083

你可以检查它的计数。

这里**cid**是一个数组。

```
if (jsonObject("result")("cid").Count) = 0 them
MsgBox "Empty Array" 
```

我希望这有帮助。祝你今天过得愉快！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-08-05T10:45:47.990

您可以通过使用 JScript 的对象检索总元素计数来检查数组是否为空`VBArray()`（适用于变体类型的数组，单维或多维）：

```
Sub Test()

    Dim a() As Variant
    Dim b As Variant
    Dim c As Long

    ' Uninitialized array of variant
    ' MsgBox UBound(a) ' gives 'Subscript out of range' error
    MsgBox GetElementsCount(a) ' 0

    ' Variant containing an empty array
    b = Array()
    MsgBox GetElementsCount(b) ' 0

    ' Any other types, eg Long or not Variant type arrays
    MsgBox GetElementsCount(c) ' -1

End Sub

Function GetElementsCount(aSample) As Long

    Static oHtmlfile As Object ' instantiate once

    If oHtmlfile Is Nothing Then
        Set oHtmlfile = CreateObject("htmlfile")
        oHtmlfile.parentWindow.execScript ("function arrlength(arr) {try {return (new VBArray(arr)).toArray().length} catch(e) {return -1}}"), "jscript"
    End If
    GetElementsCount = oHtmlfile.parentWindow.arrlength(aSample)

End Function 
```

对我来说，每个元素大约需要 0.3 mksec + 15 msec 初始化，所以 10M 个元素的数组大约需要 3 sec。可以通过`ScriptControl`ActiveX 实现相同的功能（它在 64 位 MS Office 版本中不可用，因此您可以使用这样的解决方法[）](https://stackoverflow.com/a/38134477/2165759)。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-12-01T11:32:04.273

```
if Ubound(yourArray)>-1 then
 debug.print "The array is not empty"
else
 debug.print "EMPTY"
end if 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2012-11-03T17:38:16.753

```
Public Function arrayIsEmpty(arrayToCheck() As Variant) As Boolean
    On Error GoTo Err:
    Dim forCheck
    forCheck = arrayToCheck(0)
    arrayIsEmpty = False
    Exit Function
Err:
    arrayIsEmpty = True
End Function 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2012-07-15T10:43:19.963

测试空数组的另一种解决方案

```
if UBound(ar) < LBound(ar) then msgbox "Your array is empty!" 
```

或者，如果您已经知道 LBound 为 0

```
if -1 = UBound(ar) then msgbox "Your array is empty!" 
```

这可能比 join() 更快。（而且我没有检查负索引）

这是我过滤 2 个字符串数组的示例，因此它们不共享相同的字符串。

```
' Filtering ar2 out of strings that exists in ar1

For i = 0 To UBound(ar1)

    ' filter out any ar2.string that exists in ar1
    ar2 = Filter(ar2 , ar1(i), False)    

    If UBound(ar2) < LBound(ar2) Then
       MsgBox "All strings are the same.", vbExclamation, "Operation ignored":
       Exit Sub

    End If

Next

' At this point, we know that ar2 is not empty and it is filtered 
' 
```

# web-services - Exchange Web Services，尝试使用 ExchangeImpersonationType

> ID：206338
> 
> 赞同：2
> 
> 时间：2008-10-15T20:34:35.243
> 
> 标签：web-services, exchange-server, impersonation, exchangewebservices

我正在尝试使用 EWS，第一次尝试使用 ExchangeServiceBinding。我正在使用的代码如下：

```
_service = new ExchangeServiceBinding();
//_service.Credentials = new NetworkCredential(userName, userPassword, this.Domain);
_service.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;
_service.Url = this.ServiceURL;

ExchangeImpersonationType ei = new ExchangeImpersonationType();
ConnectingSIDType sid = new ConnectingSIDType();
sid.PrimarySmtpAddress = this.ExchangeAccount;
ei.ConnectingSID = sid;            
_service.ExchangeImpersonation = ei; 
```

该应用程序是一个尝试使用 EWS 创建任务的 aspnet 3.5。我曾尝试使用模拟，因为我不知道登录用户的域密码，所以我认为模拟是最合适的。关于如何利用模拟的任何想法？我是否设置正确，尝试运行我的应用程序时出现错误。我也尝试不冒充，只是想看看我是否可以创建一个任务，也没有运气。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T09:19:09.130

如果没有更广泛的代码片段上下文，我无法确定出了什么问题，但这里有一些你可能会觉得有用的东西......

你提到你在没有冒充的情况下很难连接。我假设您使用的是 Exchange Server 2007 SP1，是吗？

您是否有知道用户名和密码的邮箱？如果是这样，请考虑尝试连接到该邮箱，看看您是否可以发送电子邮件或查询收件箱计数。这将至少有助于验证您的连接。

至于交换冒充，

*   是否已在客户端访问服务器 (CAS) 上设置了启用模拟的权限？
*   是否在邮箱或邮箱数据库（包含您尝试访问的邮箱）上设置了权限？
*   您是否处于需要额外信任关系的跨林场景中？

如果没有，这可能解释了您无法连接的原因。

一些您可能会觉得有用的链接

*   配置（[http://msdn.microsoft.com/en-us/library/bb204095.aspx](http://msdn.microsoft.com/en-us/library/bb204095.aspx)）
*   使用 Exchange 模拟 ( [http://msdn.microsoft.com/en-us/library/bb204088.aspx](http://msdn.microsoft.com/en-us/library/bb204088.aspx) )
*   访问多个资源邮箱 ( [http://msexchangeteam.com/archive/2007/12/13/447731.aspx](http://msexchangeteam.com/archive/2007/12/13/447731.aspx) )

# java - 滚动条的原始 Java 2D 实现

> ID：206343
> 
> 赞同：1
> 
> 时间：2008-10-15T20:35:47.427
> 
> 标签：java, scrollbar, java-2d

我将如何使用标准 Java 2D 编写自己的滚动条。

我真的不想使用swing，而且我已经为其他所有东西（例如按钮等）制作了自己的组件。

我并不是真的在寻找代码，而是在事件更改和绘图中涉及的数学。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T21:11:13.767

为什么要编写自己的 java GUI 工具包？你已经有了 Swing 和 SWT 的选择，你真的能比这两个团队做得更好吗？

如果您已经编写了工具包的其余部分，我不明白为什么滚动条会难倒您。如果不了解您的事件系统或自定义组件的结构，就不可能给出太多建议。我认为这不是特别密集的数学 - 只需保持可滚动组件的高度，以及它所在的视图，滚动条的大小应该与可见组件的比例相匹配。滚动条的位置应该与组件的哪个部分可见（这必须被缩放）。具体来说，你想知道什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:47:29.887

Java 现已开放。我会去查看 Swing 和/或 SWT 的源代码，因为它们已经实现了。数学似乎相当简单。你有一个酒吧和一个容器。为简化起见，我们将只讨论长度（滚动条移动的维度）。容器有一定的长度。条的长度等于或小于容器。定义滚动条的中心和两个端点很有用。您可以让滚动条从顶部的 0 和底部的 1 开始，或者从顶部的 0 和底部的 100 开始，重要的部分是以相同的方式定义滚动条。然后，您可以检查端点是否与边缘发生碰撞，以阻止杆移动。如果鼠标在条内的坐标上按住鼠标，该栏开始关心光标的位置，并将绘制滚动条以及滚动条最终应该影响的任何内容。因此，您会将受影响的页面映射到 0 和 1 * 滚动条的像素比例。然后你会担心两端的箭头，每次点击有多大的跳跃，以及处理 mousedown 事件等。使用给定的东西，不要重新发明轮子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T16:21:22.753

虽然不是 Java2D，但这个简单的代码片段可能会有所帮助：

[http://processing.org/learning/topics/scrollbar.html](http://processing.org/learning/topics/scrollbar.html)

# windows - 使用 JSP 打印 JPEG 文件

> ID：206349
> 
> 赞同：0
> 
> 时间：2008-10-15T20:36:40.543
> 
> 标签：windows, jsp, printing, jpeg

是否有一个 JSP 脚本可以运行以指向本地文件系统上的 JPEG 文件以打印到 Windows 默认打印机？谢谢。

编辑：我的服务器上已经有文件了。如何将文件加载到浏览器中以运行 window.print()？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T20:42:55.447

如果您不想要服务器往返，您将需要一个 java 小程序。该小程序是必需的，以便您可以：

1.  访问本地文件系统。
2.  以本机方式访问打印机。

用户将需要授予小程序权限。

请注意，从 java 打印非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T20:39:21.897

您必须让他们将图像上传到您的服务器，然后将 jpeg 放在带有 JavaScript 的页面上以调用 window.print()。网页刚开始读取本地文件系统是违反安全的。

# jquery - 如何格式化 Microsoft JSON 日期？

> ID：206384
> 
> 赞同：2104
> 
> 时间：2008-10-15T20:43:41.077
> 
> 标签：jquery, asp.net, ajax, json

我正在使用 jQuery首次尝试[Ajax 。](http://en.wikipedia.org/wiki/Ajax_%28programming%29)我正在将我的数据放到我的页面上，但是我在处理为 Date 数据类型返回的 JSON 数据时遇到了一些问题。基本上，我得到一个看起来像这样的字符串：

```
/Date(1224043200000)/ 
```

从对 JSON 完全陌生的人开始 - 如何将其格式化为短日期格式？这应该在 jQuery 代码中的某个地方处理吗？我试过使用`jQuery.UI.datepicker`插件`$.datepicker.formatDate()`没有任何成功。

仅供参考：这是我在这里使用答案组合提出的解决方案：

```
function getMismatch(id) {
  $.getJSON("Main.aspx?Callback=GetMismatch",
    { MismatchId: id },

    function (result) {
      $("#AuthMerchId").text(result.AuthorizationMerchantId);
      $("#SttlMerchId").text(result.SettlementMerchantId);
      $("#CreateDate").text(formatJSONDate(Date(result.AppendDts)));
      $("#ExpireDate").text(formatJSONDate(Date(result.ExpiresDts)));
      $("#LastUpdate").text(formatJSONDate(Date(result.LastUpdateDts)));
      $("#LastUpdatedBy").text(result.LastUpdateNt);
      $("#ProcessIn").text(result.ProcessIn);
    }
  );

  return false;
}

function formatJSONDate(jsonDate) {
  var newDate = dateFormat(jsonDate, "mm/dd/yyyy");
  return newDate;
} 
```

此解决方案从回调方法中获取我的对象，并使用日期格式库在页面上正确显示日期。

* * *

## 回答 #1

> 赞同：1745
> 
> 时间：2010-02-23T04:15:09.440

`eval()`没有必要。这将正常工作：

```
var date = new Date(parseInt(jsonDate.substr(6))); 
```

`substr()`函数取出`/Date(`部分，函数`parseInt()`获取整数并忽略`)/`最后的。结果数字被传递给`Date`构造函数。

* * *

我故意省略了基数（ 的第二个参数`parseInt`）；请参阅[下面的评论](https://stackoverflow.com/questions/206384/how-to-format-a-microsoft-json-date#comment19286516_2316066)。

另外，我完全同意[Rory 的评论](https://stackoverflow.com/questions/206384/how-to-format-a-microsoft-json-date#comment20315450_2316066)：ISO-8601 日期比这种旧格式更受欢迎——所以这种格式通常不应该用于新的开发。

对于 ISO-8601 格式的 JSON 日期，只需将字符串传递给`Date`构造函数：

```
var date = new Date(jsonDate); //no ugly parsing needed; full timezone support 
```

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2008-10-15T21:14:32.247

您可以使用它从 JSON 中获取日期：

```
var date = eval(jsonDate.replace(/\/Date\((\d+)\)\//gi, "new Date($1)")); 
```

然后您可以使用[JavaScript 日期格式](http://blog.stevenlevithan.com/archives/date-time-format)脚本（压缩和 gzip 后为 1.2 KB）根据需要显示它。

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2010-01-19T04:53:24.090

对于那些使用 Newtonsoft [**Json.NET**](http://james.newtonking.com/pages/json-net.aspx)的人，请阅读如何通过*[**IE8、Firefox 3.5 和 Json.NET 中的 Native JSON 进行**](http://james.newtonking.com/archive/2009/04/12/native-json-in-ie8-firefox-3-5-plus-json-net.aspx)*操作。

关于更改由 Json.NET 编写的日期格式的文档也很有用： [**Serializing Dates with Json.NET**](http://james.newtonking.com/projects/json/help/?topic=html/DatesInJSON.htm)

对于那些太懒惰的人，这里是快速步骤。由于 JSON 具有松散的 DateTime 实现，因此您需要使用`IsoDateTimeConverter()`. 请注意，自 Json.NET 4.5 起，默认日期格式为 ISO，因此不需要下面的代码。

```
string jsonText = JsonConvert.SerializeObject(p, new IsoDateTimeConverter()); 
```

JSON 将作为

```
"fieldName": "2009-04-12T20:44:55" 
```

最后，一些 JavaScript 将 ISO 日期转换为 JavaScript 日期：

```
function isoDateReviver(value) {
  if (typeof value === 'string') {
    var a = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(?:([\+-])(\d{2})\:(\d{2}))?Z?$/.exec(value);
      if (a) {
        var utcMilliseconds = Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4], +a[5], +a[6]);
        return new Date(utcMilliseconds);
      }
  }
  return value;
} 
```

我是这样用的

```
$("<span />").text(isoDateReviver(item.fieldName).toLocaleString()).appendTo("#" + divName); 
```

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2009-12-30T01:21:28.493

原始示例：

```
/Date(1224043200000)/ 
```

在使用内置 JSON 序列化通过 WCF REST 发送日期时，不反映 WCF 使用的格式。（至少在 .NET 3.5，SP1 上）

我发现这里的答案很有帮助，但需要对正则表达式进行轻微编辑，因为似乎时区 GMT 偏移量被附加到 WCF JSON 中返回的数字上（自 1970 年以来）。

在 WCF 服务中，我有：

```
[OperationContract]
[WebInvoke(
    RequestFormat = WebMessageFormat.Json,
    ResponseFormat = WebMessageFormat.Json,
    BodyStyle = WebMessageBodyStyle.WrappedRequest
    )]
ApptVisitLinkInfo GetCurrentLinkInfo( int appointmentsId ); 
```

ApptVisitLinkInfo 的定义很简单：

```
public class ApptVisitLinkInfo {
    string Field1 { get; set; }
    DateTime Field2 { get; set; }
    ...
} 
```

当“Field2”作为 Json 从服务返回时，值为：

```
/Date(1224043200000-0600)/ 
```

请注意包含在值中的时区偏移量。

修改后的正则表达式：

```
/\/Date\((.*?)\)\//gi 
```

它稍微急切一些，并抓住了括号之间的所有内容，而不仅仅是第一个数字。生成的时间 sinze 1970 加上时区偏移量都可以输入到 eval 中以获取日期对象。

替换的 JavaScript 结果行是：

```
replace(/\/Date\((.*?)\)\//gi, "new Date($1)"); 
```

* * *

## 回答 #5

> 赞同：66
> 
> 时间：2010-12-27T16:21:04.327

## 不要重复自己 - 使用自动日期转换`$.parseJSON()`

对您的帖子的回答提供了到 JavaScript 日期的手动日期转换。我对 jQuery`$.parseJSON()`进行了一点扩展，因此它能够在您指示它时自动解析日期。它处理 ASP.NET 格式的日期 ( `/Date(12348721342)/`) 以及 ISO 格式的日期 ( `2010-01-01T12.34.56.789Z`)，这些日期由浏览器中的本机 JSON 函数（以及 json2.js 等库）支持。

反正。如果您不想一遍又一遍地重复日期转换代码，我建议您阅读[这篇博](http://erraticdev.blogspot.com/2010/12/converting-dates-in-json-strings-using.html)文并获取可以让您的生活更轻松的代码。

* * *

## 回答 #6

> 赞同：64
> 
> 时间：2013-03-17T17:41:21.183

## **[点击这里查看演示](http://jsfiddle.net/2Nf5x/)**

## **JavaScript/jQuery**

```
var = MyDate_String_Value = "/Date(1224043200000)/"
var value = new Date
            (
                 parseInt(MyDate_String_Value.replace(/(^.*\()|([+-].*$)/g, ''))
            );
var dat = value.getMonth() +
                         1 +
                       "/" +
           value.getDate() +
                       "/" +
       value.getFullYear(); 
```

## **结果**- “2008 年 10 月 15 日”

* * *

## 回答 #7

> 赞同：63
> 
> 时间：2008-10-15T20:49:58.207

如果你用 JavaScript 说，

```
var thedate = new Date(1224043200000);
alert(thedate); 
```

你会看到它是正确的日期，你可以在任何框架的 JavaScript 代码中使用它。

* * *

## 回答 #8

> 赞同：39
> 
> 时间：2011-02-07T23:56:28.583

# 更新

我们有一个内部 UI 库，它必须同时处理 Microsoft 的 ASP.NET 内置 JSON 格式，如`/Date(msecs)/`最初在这里询问的，以及大多数 JSON 的日期格式，包括 JSON.NET 的，如`2014-06-22T00:00:00.0`. 此外，我们需要解决[oldIE 无法处理小数点后 3 位以外的任何问题](https://stackoverflow.com/a/15939945/176877)。

我们首先检测我们正在使用的日期类型，将其解析为普通的 JavaScript`Date`对象，然后将其格式化。

1）检测微软日期格式

```
// Handling of Microsoft AJAX Dates, formatted like '/Date(01238329348239)/'
function looksLikeMSDate(s) {
    return /^\/Date\(/.test(s);
} 
```

2) 检测 ISO 日期格式

```
var isoDateRegex = /^(\d\d\d\d)-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d\d?\d?)?([\+-]\d\d:\d\d|Z)?$/;

function looksLikeIsoDate(s) {
    return isoDateRegex.test(s);
} 
```

3）解析MS日期格式：

```
function parseMSDate(s) {
    // Jump forward past the /Date(, parseInt handles the rest
    return new Date(parseInt(s.substr(6)));
} 
```

4) 解析 ISO 日期格式。

我们至少有办法确保我们处理的是标准 ISO 日期或修改为始终具有 3 毫秒位置的 ISO 日期（[见上文](https://stackoverflow.com/a/15939945/176877)），因此代码因环境而异。

4a) 解析标准ISO Date格式，处理oldIE的问题：

```
function parseIsoDate(s) {
    var m = isoDateRegex.exec(s);

    // Is this UTC, offset, or undefined? Treat undefined as UTC.
    if (m.length == 7 ||                // Just the y-m-dTh:m:s, no ms, no tz offset - assume UTC
        (m.length > 7 && (
            !m[7] ||                    // Array came back length 9 with undefined for 7 and 8
            m[7].charAt(0) != '.' ||    // ms portion, no tz offset, or no ms portion, Z
            !m[8] ||                    // ms portion, no tz offset
            m[8] == 'Z'))) {            // ms portion and Z
        // JavaScript's weirdo date handling expects just the months to be 0-based, as in 0-11, not 1-12 - the rest are as you expect in dates.
        var d = new Date(Date.UTC(m[1], m[2]-1, m[3], m[4], m[5], m[6]));
    } else {
        // local
        var d = new Date(m[1], m[2]-1, m[3], m[4], m[5], m[6]);
    }

    return d;
} 
```

4b) 使用固定的三毫秒小数位解析 ISO 格式 - 更容易：

```
function parseIsoDate(s) {
    return new Date(s);
} 
```

5）格式化：

```
function hasTime(d) {
    return !!(d.getUTCHours() || d.getUTCMinutes() || d.getUTCSeconds());
}

function zeroFill(n) {
    if ((n + '').length == 1)
        return '0' + n;

    return n;
}

function formatDate(d) {
    if (hasTime(d)) {
        var s = (d.getMonth() + 1) + '/' + d.getDate() + '/' + d.getFullYear();
        s += ' ' + d.getHours() + ':' + zeroFill(d.getMinutes()) + ':' + zeroFill(d.getSeconds());
    } else {
        var s = (d.getMonth() + 1) + '/' + d.getDate() + '/' + d.getFullYear();
    }

    return s;
} 
```

6）把它们绑在一起：

```
function parseDate(s) {
    var d;
    if (looksLikeMSDate(s))
        d = parseMSDate(s);
    else if (looksLikeIsoDate(s))
        d = parseIsoDate(s);
    else
        return null;

    return formatDate(d);
} 
```

下面的旧答案对于将此日期格式绑定到 jQuery 自己的 JSON 解析中很有用，这样您就可以获得 Date 对象而不是字符串，或者如果您仍然以某种方式陷入 jQuery <1.5。

## 旧答案

如果您在 ASP.NET MVC 中使用 jQuery 1.4 的 Ajax 函数，您可以使用以下命令将所有 DateTime 属性转换为 Date 对象：

```
// Once
jQuery.parseJSON = function(d) {return eval('(' + d + ')');};

$.ajax({
    ...
    dataFilter: function(d) {
        return d.replace(/"\\\/(Date\(-?\d+\))\\\/"/g, 'new $1');
    },
    ...
}); 
```

`parseJSON`在 jQuery 1.5 中，您可以通过在 Ajax 调用中使用转换器选项来避免全局覆盖该方法。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

不幸的是，您必须切换到较旧的 eval 路线才能让 Dates 就地全局解析 - 否则您需要在解析后更具体地转换它们。

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2008-10-15T20:46:51.770

[JSON](http://www.json.org/)中没有内置的日期类型。这看起来像是某个时期的秒数/毫秒数。如果您知道纪元，则可以通过添加适当的时间来创建日期。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2013-05-15T06:36:24.000

我还必须寻找解决这个问题的方法，最终我遇到了 moment.js，这是一个很好的库，可以解析这种日期格式等等。

```
var d = moment(yourdatestring) 
```

它为我节省了一些头痛，所以我想我会与你分享。:)
你可以在这里找到更多关于它的信息：http: [//momentjs.com/](http://momentjs.com/)

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2009-10-09T01:03:56.563

我最终将“字符添加到 Panos 的正则表达式中，以摆脱 Microsoft 序列化程序在将对象写入内联脚本时生成的字符：

因此，如果您的 C#[代码隐藏](http://en.wiktionary.org/wiki/code-behind)中有一个属性，则类似于

```
protected string JsonObject { get { return jsSerialiser.Serialize(_myObject); }} 
```

在你的 aspx 中你有

```
<script type="text/javascript">
    var myObject = '<%= JsonObject %>';
</script> 
```

你会得到类似的东西

```
var myObject = '{"StartDate":"\/Date(1255131630400)\/"}'; 
```

注意双引号。

为了将其转换为 eval 将正确反序列化的形式，我使用了：

```
myObject = myObject.replace(/"\/Date\((\d+)\)\/"/g, 'new Date($1)'); 
```

我使用[Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)并添加了使用它

```
String.prototype.evalJSONWithDates = function() {
    var jsonWithDates = this.replace(/"\/Date\((\d+)\)\/"/g, 'new Date($1)');
    return jsonWithDates.evalJSON(true);
} 
```

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2011-04-08T01:59:11.947

在 jQuery 1.5 中，只要您有[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)来覆盖旧浏览器，您就可以反序列化来自 Ajax 的所有日期，如下所示：

```
(function () {
    var DATE_START = "/Date(";
    var DATE_START_LENGTH = DATE_START.length;

    function isDateString(x) {
        return typeof x === "string" && x.startsWith(DATE_START);
    }

    function deserializeDateString(dateString) {
        var dateOffsetByLocalTime = new Date(parseInt(dateString.substr(DATE_START_LENGTH)));
        var utcDate = new Date(dateOffsetByLocalTime.getTime() - dateOffsetByLocalTime.getTimezoneOffset() * 60 * 1000);
        return utcDate;
    }

    function convertJSONDates(key, value) {
      if (isDateString(value)) {
        return deserializeDateString(value);
      }
      return value;
    }

    window.jQuery.ajaxSetup({
      converters: {
        "text json": function(data) {
          return window.JSON.parse(data, convertJSONDates);
        }
      }
    });
}()); 
```

我包含了假设您以 UTC 格式从服务器发送所有日期的逻辑（您应该这样做）；然后，消费者会获得一个 JavaScript`Date`对象，该对象具有适当的刻度值来反映这一点。也就是说，`getUTCHours()`在日期调用 等将返回与在服务器上相同的值，调用`getHours()`将返回由浏览器确定的用户本地时区中的值。

这没有考虑带有时区偏移的[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)格式，尽管添加起来相对容易。

* * *

## 回答 #13

> 赞同：21
> 
> 时间：2011-08-30T09:33:08.210

使用 jQuery UI datepicker - 只有当你已经包含 jQuery UI 时才有意义：

```
$.datepicker.formatDate('MM d, yy', new Date(parseInt('/Date(1224043200000)/'.substr(6)))); 
```

输出：

> 2008 年 10 月 15 日

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2009-10-30T04:45:19.530

不要想太多。就像我们几十年来所做的那样，从 1970 年 1 月 1 日午夜 GMT/UTC/&c 的事实上的标准纪元传递一个数字偏移量，以自该纪元以来的秒数（或毫秒数）为单位。JavaScript 喜欢它，Java 喜欢它，C 喜欢它，互联网也喜欢它。

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2011-06-17T03:54:33.177

这些答案中的每个人都有一个共同点：它们都将日期存储为单个值（通常是字符串）。

另一种选择是利用 JSON 的固有结构，并将日期表示为数字列表：

```
{ "name":"Nick",
  "birthdate":[1968,6,9] } 
```

当然，您必须确保对话的双方就格式（年、月、日）以及哪些字段应为日期达成一致，......但它具有完全避免日期问题的优势- 到字符串的转换。都是数字——根本没有字符串。此外，使用顺序：年、月、日也允许按日期正确排序。

在这里跳出框框思考——JSON 日期不必存储为字符串。

这样做的另一个好处是，您可以通过利用[CouchDB](http://en.wikipedia.org/wiki/CouchDB)处理数组值查询的方式轻松（有效地）选择给定年份或月份的所有记录。

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2010-09-26T11:20:11.303

在很棒的线程中发布：

```
var d = new Date(parseInt('/Date(1224043200000)/'.slice(6, -2)));
alert('' + (1 + d.getMonth()) + '/' + d.getDate() + '/' + d.getFullYear().toString().slice(-2)); 
```

* * *

## 回答 #17

> 赞同：17
> 
> 时间：2012-05-24T19:01:41.737

只是在这里添加另一种方法，如果您不是非常小心，如此[处](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/0a6c84a3-5348-4ea0-b33f-eb411a2e1c97)和其他地方所述， [WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)采用的“刻度方法”很容易出现时区问题。所以我现在使用 .NET 和 JavaScript 都支持的 ISO 8601 格式，包括时区偏移。以下是详细信息：

**在 WCF/.NET 中：**

*其中 CreationDate 是 System.DateTime；ToString("o") 使用 .NET 的[往返格式说明符](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#Roundtrip)，生成符合 ISO 8601 的日期字符串*

```
new MyInfo {
    CreationDate = r.CreationDate.ToString("o"),
}; 
```

**在 JavaScript 中**

*就在检索 JSON 之后，我使用 Date 构造函数将日期修复为 JavaSript Date 对象，该构造函数接受 ISO 8601 日期字符串......*

```
$.getJSON(
    "MyRestService.svc/myinfo",
    function (data) {
        $.each(data.myinfos, function (r) {
            this.CreatedOn = new Date(this.CreationDate);
        });
        // Now each myinfo object in the myinfos collection has a CreatedOn field that is a real JavaScript date (with timezone intact).
       alert(data.myinfos[0].CreationDate.toLocaleString());
    }
) 
```

一旦有了 JavaScript 日期，您就可以使用所有方便可靠的 Date 方法，例如[toDateString](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toDateString)、[toLocaleString](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toLocaleString)等。

* * *

## 回答 #18

> 赞同：16
> 
> 时间：2009-09-24T11:38:51.997

```
var newDate = dateFormat(jsonDate, "mm/dd/yyyy"); 
```

在不使用 jQuery 库的情况下还有其他选择吗？

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2016-02-02T11:57:13.093

这也可能对您有所帮助。

```
 function ToJavaScriptDate(value) { //To Parse Date from the Returned Parsed Date
        var pattern = /Date\(([^)]+)\)/;
        var results = pattern.exec(value);
        var dt = new Date(parseFloat(results[1]));
        return (dt.getMonth() + 1) + "/" + dt.getDate() + "/" + dt.getFullYear();
    } 
```

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2010-09-26T11:07:09.977

我得到这样的日期：

```
"/Date(1276290000000+0300)/" 
```

在某些示例中，日期的格式略有不同：

```
"/Date(12762900000000300)/"
"Date(1276290000000-0300)" 
```

等等

所以我想出了以下正则表达式：

```
/\/+Date\(([\d+]+)\)\/+/ 
```

最终代码是：

```
var myDate = new Date(parseInt(jsonWcfDate.replace(/\/+Date\(([\d+-]+)\)\/+/, '$1'))); 
```

希望能帮助到你。

更新：我从 Microsoft 找到了这个链接： [如何使用 JSON 序列化日期？](http://www.asp.net/ajaxLibrary/jquery_webforms_serialize_dates_to_json.ashx)

这似乎是我们都在寻找的。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2012-08-09T12:14:59.823

下面是一个非常简单的解析 JSON 日期的解决方案。根据您的要求使用以下功能。您只需将获取的 JSON 格式日期作为参数传递给以下函数：

```
function JSONDate(dateStr) {
    var m, day;
    jsonDate = dateStr;
    var d = new Date(parseInt(jsonDate.substr(6)));
    m = d.getMonth() + 1;
    if (m < 10)
        m = '0' + m
    if (d.getDate() < 10)
        day = '0' + d.getDate()
    else
        day = d.getDate();
    return (m + '/' + day + '/' + d.getFullYear())
}

function JSONDateWithTime(dateStr) {
    jsonDate = dateStr;
    var d = new Date(parseInt(jsonDate.substr(6)));
    var m, day;
    m = d.getMonth() + 1;
    if (m < 10)
        m = '0' + m
    if (d.getDate() < 10)
        day = '0' + d.getDate()
    else
        day = d.getDate();
    var formattedDate = m + "/" + day + "/" + d.getFullYear();
    var hours = (d.getHours() < 10) ? "0" + d.getHours() : d.getHours();
    var minutes = (d.getMinutes() < 10) ? "0" + d.getMinutes() : d.getMinutes();
    var formattedTime = hours + ":" + minutes + ":" + d.getSeconds();
    formattedDate = formattedDate + " " + formattedTime;
    return formattedDate;
} 
```

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2013-05-15T06:21:00.740

您还可以使用 JavaScript 库[moment.js](http://momentjs.com/)，当您计划处理不同的本地化格式并使用日期值执行其他操作时，它会派上用场：

```
function getMismatch(id) {
    $.getJSON("Main.aspx?Callback=GetMismatch",
    { MismatchId: id },

    function (result) {
        $("#AuthMerchId").text(result.AuthorizationMerchantId);
        $("#SttlMerchId").text(result.SettlementMerchantId);
        $("#CreateDate").text(moment(result.AppendDts).format("L"));
        $("#ExpireDate").text(moment(result.ExpiresDts).format("L"));
        $("#LastUpdate").text(moment(result.LastUpdateDts).format("L"));
        $("#LastUpdatedBy").text(result.LastUpdateNt);
        $("#ProcessIn").text(result.ProcessIn);
    }
    );
    return false;
} 
```

设置本地化就像将配置文件（您可以在 momentjs.com 上获得）添加到您的项目并配置语言一样简单：

```
moment.lang('de'); 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2008-11-20T09:18:59.753

检查日期ISO标准；有点像这样：

```
yyyy.MM.ddThh:mm 
```

它变成`2008.11.20T22:18`.

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2010-10-14T05:02:46.490

这令人沮丧。我的解决方案是从 ASP.NET 的 JavaScriptSerializer 生成的值中解析出“/ 和 /”，这样，虽然 JSON 可能没有日期文字，它仍然被浏览器解释为日期，这就是我真正想要的想：`{"myDate":Date(123456789)}`

[DateTime 的自定义 JavaScriptConverter？](https://stackoverflow.com/questions/1341719/custom-javascriptconverter-for-datetime/3930187#3930187)

我必须强调 Roy Tinker 评论的准确性。这不是合法的 JSON。在它成为 JavaScript 的问题之前解决问题是服务器上的一个肮脏的、肮脏的 hack。它会阻塞 JSON 解析器。我用它来起步，但我不再使用它了。但是，我仍然认为最好的答案在于更改服务器格式化日期的方式，例如其他地方提到的 ISO。

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2009-10-23T06:39:45.783

一个迟到的帖子，但对于那些搜索过这个帖子的人。

想象一下：

```
 [Authorize(Roles = "Administrator")]
    [Authorize(Roles = "Director")]
    [Authorize(Roles = "Human Resources")]
    [HttpGet]
    public ActionResult GetUserData(string UserIdGuidKey)
    {
        if (UserIdGuidKey!= null)
        {
            var guidUserId = new Guid(UserIdGuidKey);
            var memuser = Membership.GetUser(guidUserId);
            var profileuser = Profile.GetUserProfile(memuser.UserName);
            var list = new {
                              UserName = memuser.UserName,
                              Email = memuser.Email ,
                              IsApproved = memuser.IsApproved.ToString() ,
                              IsLockedOut = memuser.IsLockedOut.ToString() ,
                              LastLockoutDate = memuser.LastLockoutDate.ToString() ,
                              CreationDate = memuser.CreationDate.ToString() ,
                              LastLoginDate = memuser.LastLoginDate.ToString() ,
                              LastActivityDate = memuser.LastActivityDate.ToString() ,
                              LastPasswordChangedDate = memuser.LastPasswordChangedDate.ToString() ,
                              IsOnline = memuser.IsOnline.ToString() ,
                              FirstName = profileuser.FirstName ,
                              LastName = profileuser.LastName ,
                              NickName = profileuser.NickName ,
                              BirthDate = profileuser.BirthDate.ToString() ,
            };
            return Json(list, JsonRequestBehavior.AllowGet);
        }
        return Redirect("Index");
    } 
```

如您所见，我正在利用 C# 3.0 的特性来创建“自动”泛型。这有点懒，但我喜欢它并且它有效。请注意：Profile 是我为我的 Web 应用程序项目创建的自定义类。

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2010-05-13T08:02:43.273

Mootools 解决方案：

```
new Date(Date(result.AppendDts)).format('%x') 
```

需要更多的mootools。在 Firefox 3.6.3 和 IE 7.0.5730.13 上使用 mootools-1.2.3.1-more 进行了测试

* * *

## 回答 #27

> 赞同：8
> 
> 时间：2010-07-08T01:19:36.757

仅供参考，对于在服务器端使用 Python 的任何人：datetime.datetime().ctime() 返回一个可由“new Date()”本机解析的字符串。也就是说，如果您创建一个新的 datetime.datetime 实例（例如使用 datetime.datetime.now），则该字符串可以包含在 JSON 字符串中，然后可以将该字符串作为第一个参数传递给 Date 构造函数。我还没有发现任何异常，但我也没有太严格地测试它。

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2011-07-01T08:07:32.410

```
var obj = eval('(' + "{Date: \/Date(1278903921551)\/}".replace(/\/Date\((\d+)\)\//gi, "new Date($1)") + ')');
var dateValue = obj["Date"]; 
```

* * *

## 回答 #29

> 赞同：8
> 
> 时间：2012-06-29T12:01:04.050

在页面中添加[jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)插件：

```
function DateFormate(dateConvert) {
    return $.datepicker.formatDate("dd/MM/yyyy", eval('new ' + dateConvert.slice(1, -1)));
}; 
```

* * *

## 回答 #30

> 赞同：8
> 
> 时间：2013-09-17T19:22:04.530

如果[.NET](http://en.wikipedia.org/wiki/.NET_Framework)返回...

```
return DateTime.Now.ToString("u"); //"2013-09-17 15:18:53Z" 
```

然后在 JavaScript 中......

```
var x = new Date("2013-09-17 15:18:53Z"); 
```

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2018-03-09T08:22:46.117

在下面的代码中。我有

**1.**从日期字符串中检索时间戳。

**2.**并将其解析为`Int`

**3.**最后创建了一个`Date`使用它。

```
var dateString = "/Date(1224043200000)/";
var seconds = parseInt(dateString.replace(/\/Date\(([0-9]+)[^+]\//i, "$1"));
var date = new Date(seconds);
console.log(date);
```

* * *

## 回答 #32

> 赞同：6
> 
> 时间：2019-05-31T20:02:53.490

**TLDR：您无法可靠地转换该仅限日期的值，而是发送一个字符串......**

...或者至少这就是几乎所有这些答案应该开始的方式。

这里发生了许多转换问题。

**这是一个没有时间的约会**

每个人似乎都缺少的东西是问题中有多少尾随零 - 它几乎肯定是作为一个没有时间的日期开始的：

```
/Date(1224043200000)/ 
```

当从 javascript 控制台作为新日期执行此操作时（许多答案的基础）

```
new Date(1224043200000) 
```

你得到：

[![在此处输入图像描述](https://i.stack.imgur.com/L3r43.png)](https://i.stack.imgur.com/L3r43.png)

最初的询问者可能在 EST 中，并且有一个纯日期（sql）或一个带午夜的 DateTime（不是 DateTimeOffset）。

换句话说，这里的意图是时间部分是没有意义的。但是，如果浏览器在与生成它的服务器相同的时区执行此操作，则无关紧要，并且大多数答案都有效。

**时区位**

但是，如果您在具有不同时区（例如 PST）的机器上执行上述代码：

[![在此处输入图像描述](https://i.stack.imgur.com/GGoOw.png)](https://i.stack.imgur.com/GGoOw.png)

您会注意到，我们现在在另一个时区**落后了一天。**这不会通过更改序列化程序来解决（仍将包括 iso 格式的时区）

**问题**

Date (sql) 和 DateTime (.net) 上没有时区，但是一旦将它们转换为具有时区的东西（在这种情况下通过 json 推断），.net 中的默认操作是假定当前时区.

序列化创建的数字是自 unix 纪元以来的毫秒数，或者：

```
(DateTimeOffset.Parse("10/15/2008 00:00:00Z") - DateTimeOffset.Parse("1/1/1970 00:00:00Z")).TotalMilliseconds; 
```

这是javascript中的 new Date() 作为参数的东西。Epoch 来自 UTC，所以现在无论您是否想要，您都可以在其中获得时区信息。

**可能的解决方案：**

在您的序列化对象上创建一个仅表示日期的字符串属性可能更安全 - 带有“10/15/2008”的字符串不太可能将其他任何人与这种混乱混淆。尽管即使在那里你也必须在解析方面小心： [https ://stackoverflow.com/a/31732581](https://stackoverflow.com/a/31732581)

但是，本着为所提问题提供答案的精神，如下所示：

```
function adjustToLocalMidnight(serverMidnight){ 
  var serverOffset=-240; //injected from model? <-- DateTimeOffset.Now.Offset.TotalMinutes
  var localOffset=-(new Date()).getTimezoneOffset(); 
  return new Date(date.getTime() + (serverOffset-localOffset) * 60 * 1000)
}

var localMidnightDate = adjustToLocalMidnight(new Date(parseInt(jsonDate.substr(6)))); 
```

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2013-11-27T09:02:32.557

附带说明一下，KendoUI 支持转换 Microsoft JSON 日期。因此，如果您的项目引用了“KendoUI”，您可以简单地使用

```
var newDate = kendo.parseDate(jsonDate); 
```

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2014-08-25T16:44:24.803

这使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)，它也可以工作：

```
var date = new Date(parseInt(/^\/Date\((.*?)\)\/$/.exec(jsonDate)[1], 10)); 
```

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2015-08-06T11:37:22.523

您可以尝试使用的另一个正则表达式示例：

```
var mydate = json.date
var date = new Date(parseInt(mydate.replace(/\/Date\((-?\d+)\)\//, '$1');
mydate = date.getMonth() + 1 + '/' + date.getDate() + '/' + date.getFullYear(); 
```

`date.getMonth()`返回一个 0 - 11 的整数，所以我们必须加 1 才能获得正确的月份数

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2017-12-05T15:37:25.073

我可以建议的最简单的方法是在`JS`as 上使用正则表达式：

```
//Only use [0] if you are sure that the string matches the pattern
//Otherwise, verify if 'match' returns something
"/Date(1512488018202)/".match(/\d+/)[0] 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2018-05-11T12:28:03.803

我使用这个简单的函数从 Microsoft JSON Date 获取日期

```
function getDateValue(dateVal) {
    return new Date(parseInt(dateVal.replace(/\D+/g, '')));
}; 
```

`replace(/\D+/g, '')`将删除除数字以外的所有字符

`parseInt`将字符串转换为数字

用法

```
$scope.ReturnDate = getDateValue(result.JSONDateVariable) 
```

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2018-07-06T10:43:09.180

试试这个...

```
function formatJSONDate(jsonDate) {
            var date = jsonDate;
            var parsedDate = new Date(parseInt(date.toString().substring(6)));
            var newDate = new Date(parsedDate);
            var getMonth = newDate.getMonth() + 1;
            var getDay = newDate.getDay();
            var getYear = newDate.getFullYear(); 

            var standardDate = (getMonth<10 ? '0' : '') + getMonth + '/' + (getDay<10 ? '0' : '') + getDay + '/' + getYear;
            return standardDate;
        } 
```

getYear() 返回年份 - 1900，这已经被弃用了一段时间，最好使用 getFullYear()

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2012-12-10T09:39:06.703

将 JSON 日期转换为 JavaScript 日期很容易：

```
var s = Response.StartDate;     
s = s.replace('/Date(', '');

s = s.replace(')/', '');

var expDate = new Date(parseInt(s)); 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2020-04-15T18:25:12.273

如果您使用的是 Kotlin，那么这将解决您的问题。

```
val dataString = "/Date(1586583441106)/"
val date = Date(Long.parseLong(dataString.substring(6, dataString.length - 2))) 
```

* * *

## 回答 #41

> 赞同：-6
> 
> 时间：2008-10-16T03:47:12.733

您的 JSON 可能应该返回某种对象（嗯，它的字符串表示形式）。

```
"{ myDate : Date(1224043200000) }" 
```

使用 jQuery，您可以通过以下方式访问数据对象：

```
$.get(
    "myJSONFile.php",
    function (data) {
        // data.myDate will be a date object.

        // to show in a short date format (eg: dd/mm/yyyy)
        alert (
            data.myDate.getDate() + "/"
            + (data.myDate.getMonth() + 1) + "/"
            + data.myDate.getFullYear()
        ); // alerts: "15/10/2008"
    }
); 
```

# delphi - 在第二台显示器上启动程序？

> ID：206400
> 
> 赞同：20
> 
> 时间：2008-10-15T20:47:14.343
> 
> 标签：delphi, c++builder, multiple-monitors, point-of-sale

有没有办法指定应用程序出现在 Delphi 或 C++Builder 中的哪个监视器上？

我正在为客户开发一个简单的程序，该程序在辅助监视器上显示由酒店系统生成的厨房订单。目前，他们需要在启动后手动将窗口拖到第二台显示器上。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-15T21:55:17.657

全局 Screen 对象（Forms 的一部分）具有 Monitors 的概念。我认为这是在 Delphi 6 或 7 左右添加的。以下代码将起作用：

```
// Put the form in the upper left corner of the 2nd monitor
//   if more then one monitor is present.
if Screen.MonitorCount > 1 then
begin
  Left := Screen.Monitors[1].Left;
  Top := Screen.Monitors[1].Top;
end; 
```

您可以使用从该位置的任何正偏移将其放在该监视器中的任何位置。您也可以从那里获取宽度和高度以了解尺寸。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-15T21:11:56.977

在程序关闭之前保存窗口位置并在启动时恢复它们。多显示器显示只是增加了桌面的大小；其他监视器表面仅具有同一 X/Y 平面的不同部分，其原点位于主监视器的左上角。

这可以通过[几个组件中的任何一个](http://www.torry.net/pages.php?id=96)自动为您完成。

顺便说一句，Forms 单元中的 Screen 变量有一个名为 MonitorCount 的属性和另一个可索引的属性 Monitors[Index: Integer]: TMonitor。TMonitor 具有指示左侧、顶部、宽度、高度等的属性，因此您需要的所有信息都在那里。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-15T07:51:19.447

```
procedure TMDIChild.btnShowMonClick(Sender: TObject);
begin
    if Screen.MonitorCount > 1 then
    begin
      FormShow.Left:=Screen.Monitors[1].Left;
      FormShow.Top:=Screen.Monitors[1].Top;
      FormShow.Width:=Screen.Monitors[1].Width;
      FormShow.Height:=Screen.Monitors[1].Height;
    end
    else
    begin
        FormShow.Show;
    end;
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:52:01.900

并不是您的问题所暗示的答案，但是您不能在应用程序关闭时存储窗口设置（大小、位置、最大化状态），然后在启动时应用它们吗？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-16T15:46:38.210

不久前我在 Delphi 5 中做过类似的事情：

```
procedure TForm18.FormCreate(Sender: TObject);
var
  Mon: TMonitor;
  MonitorIdx: Integer;
begin
  MonitorIdx := 1; // better read from configuration
  if (MonitorIdx <> Monitor.MonitorNum) and (MonitorIdx < Screen.MonitorCount) then begin
    Mon := Screen.Monitors[MonitorIdx];
    Left := Left + Mon.Left - Monitor.Left;
    Top := Top + Mon.Top - Monitor.Top;
  end;
end; 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-15T20:51:43.260

Windows 将允许您在 CreateWindow API 调用中指定窗口的坐标。我对 Delphi 或 C++Builder 的了解不够，不知道您是否有权访问该过程的那一部分。

您还可以在 WM_CREATE 处理程序中移动窗口。

EnumDisplayMonitors 将为您提供系统中每个监视器的坐标。

* * *

显然，Delphi 和 C++ Builder 具有使这个答案有些无关紧要的功能。我会把它留在这里，以防有人遇到这个问题，但需要在不同的环境中回答它。

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2008-10-15T20:50:03.700

我对 Windows 系统做的不多，所以我建议像这样的 hack。

抓住可视桌面的宽度（两台显示器组合），将其除以一半，然后将其设为您的起始位置。

您还可以查看 api 告诉您 monitor2 的尺寸。

# sql-server - 如何从另一个 SQL 脚本中调用 SQL 脚本？

> ID：206401
> 
> 赞同：13
> 
> 时间：2008-10-15T20:47:35.793
> 
> 标签：sql-server, sql-server-2005

我想调用一系列 .sql 脚本来创建初始数据库结构

1.  脚本1.sql
2.  script2.sql 等

如果没有 sqlcmd 或存储过程**或任何其他类型的非 sql 代码，**有什么方法可以做到这一点？就在 .sql 文件中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T21:06:11.717

你可以试试这个：

```
exec master..xp_cmdshell 'osql -E -ix:\path\filename.sql' 
```

osql 必须在路径中，必须知道完整的文件名，并且必须正确设置登录名（选项 -E 或 -U）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T18:26:00.473

当然。只需创建一个小应用程序，它会拉入您想要的所有 .sql 文件并执行它们。在 VB.NET 中执行如下操作：

```
Sub ExecuteSqlScript(FilePath As String)

    Dim Script As String
    Dim FileNumber As Integer
    Dim Delimiter As String
    Dim aSubscript() As String
    Dim Subscript As String
    Dim i As Long

    Delimiter = ";"
    FileNumber = FreeFile
    Script = String(FileLen(FilePath), vbNullChar)

    ' Grab the scripts inside the file
    Open FilePath For Binary As #FileNumber
    Get #FileNumber, , Script
    Close #FileNumber

    ' Put the scripts into an array
    aSubscript = Split(Script, Delimiter)

    ' Run each script in the array
    For i = 0 To UBound(aSubscript) - 1
        aSubscript(i) = Trim(aSubscript(i))
        Subscript = aSubscript(i)
        CurrentProject.Connection.Execute Subscript

    Next i

End Sub 
```

示例来自：[http ://snipplr.com/view/3879/run-sql-script-from-external-file/](http://snipplr.com/view/3879/run-sql-script-from-external-file/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T21:08:59.883

没有理由排除存储过程。您不需要包含“任何其他类型的非 sql 代码”，加上

执行其他人

在任何其他解决方案中都需要（或其等效项）。

你排除他们的原因是什么？我肯定认为它胜过用另一种语言编写代码。

# sql-server - 从 SQL Server 2000 到 DB2/AS400 的 OpenQuery 导致锁定

> ID：206402
> 
> 赞同：3
> 
> 时间：2008-10-15T20:47:47.823
> 
> 标签：sql-server, locking, ibm-midrange, linked-server

每天早上，我们都有一个进程在 AS400/iSeries/i6（无论 IBM 现在如何称呼它）上向 DB2 发出大量查询（约 10000 个），在过去的 2 个月中，操作员一直在抱怨我们的查询锁定了几个文件阻止他们完成夜间处理。查询非常简单，例如

```
Select [FieldName] from OpenQuery('<LinkedServerName>', 'Select [FieldName] from [LibraryName].[FieldName] where [SomeField]=[SomeParameter]') 
```

我不是 iSeries 方面的专家，我想知道是否有人从 AS400/Db2 的角度对锁升级有任何见解。导致锁定的 ID 已确认是我们注册链接服务器的 ID，我们知道它最有可能是我们，因为 [Library] 和 [FileName] 与我们发出的查询一致。

这种情况最近才开始发生。是否有可能是我们的选择语句导致 AS400 升级锁？问题是它们在没有人工干预的情况下不会被释放。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T21:20:15.963

尝试在查询中添加“FOR READ ONLY”，然后它不会在您检索记录时锁定记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T04:18:41.453

从 RPG/COBOL/JPL 作业程序写入 AS/400 端的文件将导致文件锁定（我认为默认情况下）。阅读时作业将无法获得此锁。我们使用的解决方案是......在作业运行时不要读取文件。我们在 excel 中创建了一个大的日程表，并将所有 sql 服务器和 as/400 的作业放在时间槽中，其中包含重要性和服务器的颜色编码。这样就没有冲突或过时的提取文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T22:34:04.810

您可能有承诺控制导致可重复读取的锁定。检查关联的 SQL Server ODBC 连接`<linkedServerName>`以更改承诺控制。

# c - size_t 加法溢出

> ID：206405
> 
> 赞同：9
> 
> 时间：2008-10-15T20:48:15.137
> 
> 标签：c, integer-overflow, size-t

我喜欢为 VS.NET 和 GCC 提供免费的代码警告，并且我喜欢准备好我的 64 位代码。

今天我写了一个小模块，它处理内存缓冲区并通过文件样式接口提供对数据的访问（例如，您可以读取字节、写入字节、四处寻找等）。

作为当前读取位置和大小的数据类型，我使用了 size_t，因为这似乎是最自然的选择。我绕过警告，它也应该在 64 位下工作。

以防万一：我的结构如下所示：

```
typedef struct
{
  unsigned char * m_Data;
  size_t          m_CurrentReadPosition;
  size_t          m_DataSize;
} MyMemoryFile; 
```

的符号`size_t`似乎在实践中没有定义。谷歌代码搜索证明了这一点。

现在我处于两难境地：我想检查是否有`size_t`溢出，因为我必须处理用户提供的数据，而第三方库将使用我的代码。但是，对于溢出检查，我必须知道符号。它在实施中产生了巨大的差异。

那么 - 我到底应该如何以独立于平台和编译器的方式编写这样的代码？

我可以`size_t`在运行或编译时检查签名吗？那将解决我的问题。或者，也许`size_t`一开始就不是最好的主意。

有任何想法吗？

**编辑**：我正在寻找 C 语言的解决方案！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-15T21:31:52.337

关于`size`_t 是签名还是未签名以及 GCC（来自旧的 GCC 手册 - 我不确定它是否仍然存在）：

> `size_t`2.4 版之前的 GCC 类型和版本存在潜在问题 。ANSI C 要求它 `size_t`始终是无符号类型。为了与现有系统的头文件兼容，GCC 将`size_t`in 定义`stddef.h`为系统定义的任何类型`sys/types.h`。大多数定义 `size_t`in 的Unix 系统将其定义`sys/types.h`为有符号类型。库中的某些代码依赖于`size_t`无符号类型，如果有符号则无法正常工作。
> 
> The GNU C library code which expects `size_t` to be unsigned is correct. The definition of `size_t` as a signed type is incorrect. We plan that in version 2.4, GCC will always define `size_t` as an unsigned type, and the 'fixincludes' script will massage the system's `sys/types.h` so as not to conflict with this.
> 
> In the meantime, we work around this problem by telling GCC explicitly to use an unsigned type for `size_t` when compiling the GNU C library. 'configure' will automatically detect what type GCC uses for `size_t` arrange to override it if necessary.

If you want a signed version of `size_t` use `ptrdiff_t` or on some systems there is a typedef for `ssize_t`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T20:51:15.727

`size_t`应该是无符号的。

它通常被定义为无符号长。

我从未见过以其他方式定义它。`ssize_t`是它的签名对应物。

编辑：GCC 在某些情况下将其定义为已签名。在 ASNI C 模式或 std-99 下编译应该强制它是无符号的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T21:09:12.990

`size_t`根据 C++ C 标准，是无符号整数类型。任何已`size_t`签名的实现都严重不合格，并且可能还存在其他可移植性问题。它保证在溢出时回绕，这意味着您可以编写类似`if (a + b < a)`查找溢出的测试。

`size_t`是任何涉及记忆的优秀类型。你做对了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T21:07:39.233

对于 C 语言，请使用[IntSafe](https://msdn.microsoft.com/en-us/library/windows/desktop/ff521693(v=vs.85).aspx)。也由 Microsoft 发布（不要与 C++ 库 SafeInt 混淆）。IntSafe 是一组 C 语言函数调用，可以安全地执行数学运算和转换。 [更新了 intsafe 函数的 URL](https://msdn.microsoft.com/en-us/library/windows/desktop/ff521693(v=vs.85).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T20:54:48.090

使用[安全](http://www.codeplex.com/SafeInt)。它是由 Michael Howard 设计并从 Microsoft 开源发布的一个类。它旨在处理被确定为存在溢出风险的整数。所有溢出都转换为异常并进行处理。该类旨在使正确使用变得容易。

例如 ：

```
char CouldBlowUp(char a, char b, char c)
{
   SafeInt<char> sa(a), sb(b), sc(c);

   try
   {
     return (sa * sb + sc).Value();
   }
   catch(SafeIntException err)
   {
      ComplainLoudly(err.m_code);
   }

   return 0;
} 
```

此外，微软内部在 Office 等产品中也大量使用了 safeint。

参考： [链接文本](http://msdn.microsoft.com/en-us/library/ms972705.aspx)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-15T20:58:11.717

我不确定我是否完全理解这个问题，但也许你可以这样做：

```
temp = value_to_be_added_to;

value_to_be_added_to += value_to_add;

if (temp > value_to_be_added_to)
{
  overflow...
} 
```

由于它会返回到较低的值，因此您可以轻松检查它是否溢出。

# http - 标准 404 页面何时出现？

> ID：206420
> 
> 赞同：3
> 
> 时间：2008-10-15T20:50:48.580
> 
> 标签：http, http-status-code-404

我正在为一个项目构建一个简单的 HTTP 服务器。大多数网站都有自定义 404 错误页面。但有时，您会看到 Firefox 吐出一个通用的 404 页面（或 405 等）。它如何决定做什么？HTTP 响应应该是什么？“HTTP/1.0 404 NOT FOUND”是否足够？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T21:22:35.130

如果服务器找不到请求的资源（例如网页），它会在 HTTP 标头部分发送**HTTP/1.0 404 NOT FOUND**。

**服务器可以为这个错误映射**一个错误页面，这样你就可以获得一个可读的错误页面。**浏览器还可以映射**自己的错误页面，因此您可以看到特定于浏览器的错误 404 消息。

**您可以在日志文件**的状态字段中看到错误代码。

您可以使用以下结构**将用户重定向**到特定页面：

```
<HTML>
<head>
<meta HTTP-EQUIV="Refresh" CONTENT="5; URL=not404.htm">
</head>
</HTML> 
```

请参阅[Welcome to 404 Error Pages .com上的详细信息](http://www.howtofriends.com/404error/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T20:56:34.777

如果您正在创建 HTTP 服务器，您可能需要查看描述协议的 RFC：http: [//www.faqs.org/rfcs/rfc2616.html](http://www.faqs.org/rfcs/rfc2616.html)

对于 404 状态代码，它说：

> 服务器未找到任何与请求 URI 匹配的内容。没有
> 说明这种情况是暂时的还是
> 永久性的。如果服务器通过一些内部可配置的机制知道旧资源永久不可用并且没有转发地址，则应该使用 410 (Gone) 状态代码。当服务器不希望确切地揭示请求被拒绝的原因或没有其他响应适用时，通常使用此状态代码。

您无法控制浏览器如何处理每个状态码，您应该依赖它的良好行为。

也就是说，您可能会受益于使用现有的 HTTP 服务器之一。看看几天前发布的这个关于如何用 C 或 C++ 创建 HTTP 服务器的[问题，](https://stackoverflow.com/questions/175507/cc-web-server-library)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T20:57:23.793

返回带有 404 响应代码的 html 正文是完全有效的。如果没有提供正文，则浏览器将显示默认页面。

1.  如果您只发送**HTTP/1.0 404 NOT FOUND**，那么将显示浏览器默认值。
2.  如果您在响应中添加正文，浏览器将主要使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:55:08.837

因此，Firefox 在大多数情况下不会显示通用的 404 错误页面；您正在考虑 Internet Explorer，它会忽略网站的 404 页面，如果它低于特定大小并显示自己的页面。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-15T20:52:34.973

一般设置在webserver中，即：当服务器收到404时，参考这个页面。

# rule-engine - 包含规则引擎的系统是否曾经真正成功过？

> ID：206425
> 
> 赞同：19
> 
> 时间：2008-10-15T20:51:36.550
> 
> 标签：rule-engine

我们的系统（外来商品衍生品交易捕获和风险管理）即将重新开发。我听到的一个建议是，将合并一个规则引擎，以使最终用户（商品交易者，相当复杂）更容易对业务逻辑进行某些更改。

我对规则引擎有点怀疑。我的敏捷者想知道它们是否只是流程问题的技术解决方案……即。我们的开发人员需要很长时间才能响应业务的变化需求。该问题的解决方案应该是更协作的开发方法、更好的测试覆盖率、更敏捷的实践。

了解规则引擎真正带来好处的情况（尤其是在交易环境中）肯定会有所帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-16T02:04:41.910

我见过两个使用 Fair Issac 的 Blaze Rete 引擎的应用程序。

一个应用程序将数千条规则撞到一个知识库中，出现了可怕的记忆问题，已成为一个很少人理解的黑匣子。我不会称其为成功，但它正在生产中运行。

另一个应用程序使用决策树来表示医疗表格上数百个问题的顺序，以处置客户。它做得非常优雅，业务人员可以根据需要更新规则，而无需开发人员参与。（不过，仍然必须部署一个。）我认为这是一个巨大的成功。

因此，这取决于问题的集中程度、规则集的大小以及开发人员的知识。我的偏见是，简单地让规则引擎成为单点故障并将规则转储到其中可能不是一个好方法。我会从数据驱动或表驱动的方法开始，然后不断发展，直到需要规则引擎。我还努力将规则引擎封装为对象行为的一部分。我会向用户隐藏规则引擎，并尝试将规则空间划分为域模型。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T21:04:08.303

我不知道我是否会说它们真的是一个福音，但我认为它们肯定是有价值的。我在保险行业的一个系统上工作了几年，该系统非常成功地使用了规则引擎，允许业务用户创建规则来确定哪些政策是合法的，具体取决于州。

例如，如果您在某些州必须有共付额，或者由于产品考虑，或者由于州法律它完全是非法的，因此不允许某些自付额和共付额的组合。

公司经营所在的州的数量，以及规则的不断变化（每季度）将使这成为一种令人眼花缭乱的编码实践。更重要的是，这不是程序员的专业知识。它增加了额外的毫无意义的沟通，最终用户正在向不是保险行业专家的程序员描述要生效的规则。

如果设计得当，规则引擎仍然可以启用允许进行良好测试的工作流系统。在这种情况下，规则存储在数据库中，并且有 QA 和 PROD 数据库。因此，BA 可以在 QA 中测试他们的规则，然后将它们提升为 PROD。

与任何事情一样，它通常与实现有关，而不是实际技术。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T21:20:09.597

是的，Microsoft 在 BizTalk 中有一个已成功使用多年的业务规则引擎 (BRE)。我听说他们有客户为 BRE 购买 BizTalk（非常昂贵）。

以我的经验，让业务用户更新规则的实用性微乎其微。业务规则编辑器通常需要技术人员来工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T22:59:36.920

规则引擎只不过是执行声明性语句的东西。它们有两个主要优点（我看到）：

1.  您的业​​务逻辑是从一个地方维护的，而不是分散在整个应用程序代码中。从技术上讲，一个设计良好的应用程序应该已经在架构上做到了这一点，无论是否存在规则引擎。
2.  您需要[更少]担心声明性语句之间的依赖关系。规则引擎应该足够聪明，可以根据依赖关系决定运行规则的顺序。您可能会发现某些规则引擎支持在规则集中按顺序排列规则或以特定顺序调用规则集（规则组），但这并不真正符合声明式编程的精神。许多规则引擎使用 Rete（一种算法）来决定何时安排声明性语句的执行。

我怀疑大多数（如果不是全部）规则引擎会比您编写不使用规则引擎的最佳程序增加更多开销。这类似于在汇编中编写代码通常比编译器更快（但您通常不编写汇编，因为使用更高级别的抽象更方便和高效）。

如果您要在这里停下来，那么您可能会使用程序员来维护规则并使用规则引擎作为在应用程序中构建业务逻辑层的便捷方式。一些规则引擎提供称为模板的东西，让您可以为规则定义模板。这里的优点是非技术用户应该能够编写自己的规则并修改现有规则。

规则引擎是您工具箱中的另一种工具，如果使用得当，它会很有价值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-15T21:33:36.903

许多这些规则引擎的问题是缺乏速度，并且替换或增加规则可能会以微妙的方式破坏现有的工作规则。因此，在每次规则更改后，您仍然需要彻底重新测试系统。因此，您基本上只是将一种计算机语言换成另一种计算机语言——一种用户群少得多的计算机语言。正如另一位发帖人所提到的，我还没有看到业务分析师成功使用规则引擎。无论如何，你需要一个程序员。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-15T21:42:03.970

我当然有，但不能公开谈论它们，但今年你很可能与其中一个互动过几次；）

我在两个阵营中看到它：逻辑程序员和业务用户。不同的工具针对不同的集合，有些两者兼而有之。业务用户的成功案例仅在它是逻辑的子集时才有效，并且他们也有办法定义测试用例并自己运行它们（并且他们准备进行逻辑思考）。逻辑程序员很少见，但通常可以从非命令式编程背景中找到（他们也是那种认为函数式编程直观的人）。

在一天结束时请记住，即使使用可视化工具，如果您要告诉计算机做某事，它仍在编程。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-04T21:29:45.297

我与该领域的许多供应商合作，其中一件很棒的事情是我可以与他们的很多客户交谈。所以，是的，数百家公司完全得到**了**他们所承诺的好处——提高敏捷性、更好的业务/IT 协作、更容易的法规遵从性、更好的决策一致性、更低的维护成本、更快的上市时间等。

一遍又一遍，在所有主要供应商和开源参与者中，我看到它使用正确 - 自动化和改进具有许多规则的大量运营决策，改变很多的规则，以复杂方式交互的规则或规则一个高业务领域内容——业务规则管理系统的工作。

真的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-15T20:55:25.560

我的经验仅限于（i）不多和（ii）序言；但我可以肯定地说，规则引擎可以帮助您表达比程序代码更清晰的命题概念。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-09T21:21:59.990

规则引擎通常用于保险业务。我曾在具有数百（600 条）规则的系统上工作，这些规则在规则引擎中实现。它工作得很好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-31T21:58:13.187

你有信用等级吗？也许是[FICO](http://en.wikipedia.org/wiki/FICO)分数？那就是**Fair I** saac **CO** rporation **，** Blaze 规则引擎的开发者。

 ***** * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-15T21:19:45.653

有一段时间，我为 PEATE 分布式计算项目工作，该项目正在开发一个用于计算大规模、大量大气数据的系统。该系统由三个部分组成：数据管理器、调度器和算法执行组件。可以有任意数量的任何这些组件，所有这些都通过 Web 服务完成，但它允许不同的研究人员针对任意数据执行任意作业，并且还允许随着需求的变化插入不同的调度机制。

我在项目离地太远之前离开了项目，但这似乎可能适合该场景，并作为某种规则引擎的另一个示例。然而，话虽如此，如果原始开发人员仍然要让算法运行，我看不出拥有规则引擎有太多好处，除非它处理每个规则或算法会产生的大量开销它自己的。

这听起来比简单的规则引擎要复杂一些，但这样的架构也可以适用于规则引擎。

# sql - SQL Server 中 sp_who 状态的含义

> ID：206431
> 
> 赞同：15
> 
> 时间：2008-10-15T20:52:16.457
> 
> 标签：sql, sql-server, tsql

有人能告诉我 SQL Server 的 sp_who 命令中的状态是什么意思吗？为什么 spid 会被暂停？“可运行”是什么意思？

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-15T20:57:19.270

在网上很容易找到答案。[关联](https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-who-transact-sql)

**休眠。**SQL Server 正在重置会话。

**跑步。**会话正在运行一个或多个批次。启用多个活动结果集 (MARS) 后，一个会话可以运行多个批次。有关详细信息，请参阅使用多个活动结果集 (MARS)。

**背景。**会话正在运行后台任务，例如死锁检测。

**回滚。**会话正在进行事务回滚。

**待办的。**会话正在等待工作线程可用。

**可运行。**会话的任务在等待获取时间片时位于调度程序的可运行队列中。

**自旋环。**会话的任务是等待自旋锁空闲。

**暂停。**会话正在等待事件（例如 I/O）完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T21:02:18.020

我相信这方面的部分困惑是上面显示的列表之外的状态是可见的。想到的三个是

*   睡眠
*   等待命令
*   其他

# c# - 存储信用卡详细信息

> ID：206438
> 
> 赞同：49
> 
> 时间：2008-10-15T20:54:35.750
> 
> 标签：c#, security, encryption, credit-card, pci-dss

我有一个业务需求，迫使我在短时间内存储客户的完整信用卡详细信息（号码、姓名、到期日、CVV2）。

理由：如果客户打电话订购产品并且他们的信用卡当场被拒绝，您可能会失去销售。如果您获取他们的详细信息，感谢他们的交易，然后发现卡被拒绝，您可以给他们回电话，他们更有可能找到另一种支付产品的方式。如果信用卡被接受，您将清除订单中的详细信息。

我无法改变这一点。现有系统以明文形式存储信用卡详细信息，而在我正在构建的新系统中，我显然*不会*复制它！

那么，我的问题是如何在短时间内安全地存储信用卡。我显然想要某种加密，但是最好的方法是什么？

环境：C#、WinForms、SQL-Server。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-15T21:03:02.190

基本上避免承担将CC详细信息保存在您身边的责任，但是我可以假设您正在使用第三方服务进行交易，例如PayPal / Verisign或其他任何东西，它们中的大多数都有API可以让您保存CC凭据在他们身边，他们会给你一个密钥，你可以稍后使用它来完成或启动事务，所以他们会处理困难的部分，而你所要做的就是将此字符串密钥存储在你的数据库中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-15T21:18:15.857

我不认为存储 CVV 信息实际上是非法的（从某种意义上说它违反了任何法律），但它确实违反了支付卡行业规则，他们可能会施加任何数量的不同制裁。因此，您的要求实际上可能导致您无法接受信用卡；-(

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-15T21:47:50.353

Andrew，您需要了解[PCI-DSS](https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml)，这不是一件小事。就个人而言，我觉得它非常模糊，但这是我的理解。

首先，根据您描述的情况，我将尝试对卡进行全额授权，然后如果失败，我将存储客户的信息（但不是持卡人数据），以便有人可以联系用户。在我以前工作的地方，我们的一些客户只收取 1.00 美元，然后立即取消交易，以确保卡有效。然后他们将手动处理所有订单。

成功授权后，您需要存储该号码的位置。您需要的唯一数字是信用卡号和交易代码（至少对于我曾经使用过的每个网关）。

上次我查看该标准时，并没有具体针对加密算法，而是明确表示它应该是当前不可破解的加密。

现在，您不能做的一件事是在授权后存储 CCV。我的理解是，您可以在授权之前存储它，但我永远无法让任何人把它写下来。基本上，您对卡进行了授权，最好将其擦除。

在这一点上这并不违法，但如果你被钉死，他们会把锤子砸在你身上。他们有权对您处以重罚，但他们通常所做的似乎是让您接受补救。如果您不遵守，我不知道会发生什么，因为我听说过的每个人都遵守了。但后来他们真的用显微镜放大了你的战利品。

最终，我相信他们真正拥有的唯一手段就是阻止您接受信用卡。大多数与我合作过的商人都被吓死了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-15T21:17:28.107

如果您要存储信用卡信息，您确实需要符合 PCI 标准，否则您只是自找麻烦。

话虽如此，请查看 SQL Server 2005 及更高版本中可用的单元级加密。巧合的是 :) 我最近发表了一个关于使用 SQL Server 2005/2008 加密的 T-SQL 示例的演示文稿：http: [//moss.bennettadelson.com/Lists/Events/Attachments/9/June2008.zip](http://moss.bennettadelson.com/Lists/Events/Attachments/9/June2008.zip)（链接位置已更新2008 年 12 月 23 日）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-15T22:43:30.647

如果您只想在内存中短时间存储字符串，可以查看[System.Security.SecureString](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx)。

取自这个[答案](https://stackoverflow.com/questions/122784/hidden-net-base-class-library-classes#123141)：

> SecureString 值是加密存储的（更确切地说是混淆的），但最重要的是，它们永远不会交换到磁盘，并且可以在您完成它们后立即处理掉。
> 
> 它们使用起来很棘手，因为您一次只能构建一个字符（鼓励您通过在用户输入密码时捕获击键来构建它们），并且需要三行代码来恢复然后擦除它们的纯文本，但是如果使用得当，它们可以通过避免虚拟内存漏洞使程序更加安全。
> 
> 在示例结束时，SecureString 被转换为常规托管字符串，这使其再次易受攻击（确保在完成后使用 try-catch-finally 模式将字符串归零）。SecureString 的用途是通过限制垃圾收集器复制值的数量来减少攻击的表面积，并减少被写入交换文件的可能性。

```
// Make a SecureString
SecureString sPassphrase = new SecureString();
Console.WriteLine("Please enter your passphrase");
ConsoleKeyInfo input = Console.ReadKey(true);
while (input.Key != ConsoleKey.Enter)
{
   sPassphrase.AppendChar(input.KeyChar);
   Console.Write('*');
   input = Console.ReadKey(true);
}
sPassphrase.MakeReadOnly();

// Recover plaintext from a SecureString
// Marshal is in the System.Runtime.InteropServices namespace
try {
   IntPtr ptrPassphrase = Marshal.SecureStringToBSTR(sPassphrase);
   string uPassphrase = Marshal.PtrToStringUni(ptrPassphrase);
   // ... use the string ...
}
catch {
   // error handling
} 
finally {
   Marshal.ZeroFreeBSTR(ptrPassphrase);
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-15T21:14:40.467

同意如果可以的话，您应该避免存储数据。但也许你**就是**那个第三方？如果是这样，请熟悉[PCI 标准](https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml)。在网站上浏览一下，您会发现**需要**实施的安全措施。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-16T00:58:25.273

要获得适当的合规性并能够做这种事情，需要花费大约 30,000 美元。您最好使用第三方支付服务。就个人而言，我推荐 Element Express，他们有一个绕过 PCI-DSS PAPDB 合规性的“托管”解决方案。我必须为我自己的应用程序转换为这个，甚至是销售点机器！！！这是一个很大的痛苦，但我们是一家小公司。

[http://www.elementps.com/software-providers/our-security-edge/hosted-payments/PA-DSS-Certification-vs-Elements-Hosted-Payments/](http://www.elementps.com/software-providers/our-security-edge/hosted-payments/PA-DSS-Certification-vs-Elements-Hosted-Payments/)

上面的链接有一些关于与成为合规相关的成本的好信息。我们有客户要求我们存储信用卡号码，我们不会这样做，因为我们也会被罚款。不好。不要让自己承担责任。

编辑：

此外，如果您决定存储信用卡信息，您肯定需要考虑您将使用的加密形式。对称？不对称？

如果您进行对称加密（Passkey），那么如果拥有密钥（需要加密）的服务器（站点）以任何方式受到损害，您就会面临一些严重的安全漏洞。请记住，即使编译的代码也不会隐藏文本键。

如果您使用非对称加密（公钥/私钥对），那么您会遇到一些额外的问题，但如果主要面向公众的服务器受到威胁，他们将只有*public key*，并且如果他们也访问您的数据库.. 他们不会能够解密内容。

那么问题是，您将私钥存储在哪里？在运行管理功能时，您是否有人将其从本地计算机中粘贴。有一个单独的应用程序在桌面上运行以查看订单等。

有很多事情需要考虑。

最后一点：使用支付网关（Element Express、Authorize.NET、Paypal 等），不要在本地存储任何信用卡信息。:P

这是关于在 C# 中使用 X509 非对称加密的链接： [http ://www.csharpbydesign.com/2008/04/asymmetric-key-encryption-with.html](http://www.csharpbydesign.com/2008/04/asymmetric-key-encryption-with.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-05-11T06:48:05.233

让我们以不同的方式看待需求。目前它看起来像这样：

作为网站 X 的产品所有者，我希望系统临时存储客户的抄送详细信息，以便我可以恢复被抄送公司拒绝的销售

Ppl 倾向于这样思考并以这种方式请求功能。现在我认为您的要求更方便地描述如下：

作为用户，我希望网站 X 能够为我的购买重试付款，这样我就不必再经历一次结帐过程了，因为这在...

所以没有明确要求存储任何东西（在你这边）吗？它只暗示

支付提供商可以为您的商家帐户提供程序化 API，并能够在被拒绝的情况下尝试重新验证。我认为@bashmohandes 早些时候避开了这一点

并非所有支付提供商都能做到这一点，但我认为这取决于他们与相关银行的关系。那就是你想要避免的东西，即。与银行有着密切的关系。

场景1：假设我说的都是真的

除了对授权尝试的引用之外，您无需存储任何内容。一些支付提供商甚至为您提供了一个贴心的后台工具，因此您不必自己制作重新验证。我认为paygate会这样做

我相信你最好的选择是采访一些支付提供商。他们应该对这些东西了如指掌。这可能是一个零代码解决方案

场景 2：假设我完全错了，但从法律上讲，这种存储 CC 的东西是可以的

因此，您必须将这些数据临时存储在某个地方。我建议：

*   使用非供应商特定的 2 路加密方法（自然），因此您可以使用任何语言/平台来加密/解密
*   将加密/解密服务与您的应用程序分离，并将其视为黑匣子
*   使用公钥/私钥对该服务进行身份验证
*   将此机器放在具有自己提升的防火墙规则的专用网络上（不必是硬件防火墙，但硬件更好）
*   让您的应用服务器通过 ssl 与这台机器通信（您可以使用自签名证书，因为它在您的私有 LAN 上）

我在场景 2 中所建议的只是障碍，但最终持久性赢得了获取数据的竞赛。绝对保护数据的唯一方法是将您的服务器从以太网中拔出，但该选项有点激进:-)

场景1会很好。不会吗？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-09-25T21:19:24.910

**考虑你的日志！**

如果您向您的客户解释全部影响（以及发现不合规时的补救要求），那么请相信我，您的“业务需求”将很快发生变化。

如果您必须存储信用卡号（并且我在此提出了一个想法，即没有合理的情况应该存储）并且您打算使用内置到数据库中的本机加密，那么请考虑一下：您的交易日志呢？

如果您的交易日志可以清楚地反映信用卡号，那么您不合规，如果您被抓到，您应该在您的站点预算 10,000 到 50,000 美元的法医审计。为您自己的律师预算，以防您的客户起诉您，因为您应该知道所有这些东西。

因此，如果您要存储信用卡号，请在代码中运行密码，以便交易日志（插入或更新）反映加密字符串，而不是明文的卡号。

并且在您的数据库中甚至没有用于 CVV 的字段或列 - 无论是否加密 - 法医审计都会揭示这一点（日志也会如此），然后您的客户就会遇到大麻烦。他们*将*支付罚款，并*可能*失去接受信用卡的能力。你的律师会很高兴的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-07T14:18:39.180

我有一篇博客文章处理了在数据库中存储敏感数据的确切情况。博客文章使用了我使用三重 DES 算法构建的 String Encryptor 类，但您可以根据需要插入自己的。

博客文章包含使用的视频和源代码。您可以在[http://www.wrightin.gs/2008/11/how-to-encryptdecrypt-sensitive-column-contents-in-nhibernateactive-record-video.html 查看](http://www.wrightin.gs/2008/11/how-to-encryptdecrypt-sensitive-column-contents-in-nhibernateactive-record-video.html)。我认为它肯定会解决您的问题。

# c# - 检查指定日期何时发生的最佳方法

> ID：206440
> 
> 赞同：1
> 
> 时间：2008-10-15T20:54:38.370
> 
> 标签：c#, .net, vb.net, datetime

如果时间赶上指定的 DateTime 对象，我可以使用 .NET 框架中的任何类来引发事件吗？

如果没有，检查时的最佳做法是什么？创建一个新线程不断检查？计时器（天堂禁止；））？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T21:37:36.880

我不会采用线程方法。虽然睡眠线程不消耗用户 CPU 时间，但它确实使用内核/系统 CPU 时间。其次，在 .NET 中，您无法调整 Thread 的堆栈大小。因此，即使它所做的只是休眠，您也会遇到 2MB 的命中（我相信这是新线程的默认堆栈大小）。

使用 System.Threading.Timer。它使用高效的计时器队列。它可以有数百个轻量级计时器，并且只在所有计时器之间重用的 1 个线程上执行（假设大多数计时器没有同时触发）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T21:05:45.167

当一个线程处于睡眠状态时，它不会消耗 CPU 使用率。一个非常简单的方法是让一个线程休眠到 DateTime。例如

```
 DateTime future = DateTime.Now.Add(TimeSpan.FromSeconds(30));
        new Thread(() =>
        {
            Thread.Sleep(future - DateTime.Now);
            //RaiseEvent();
        }).Start(); 
```

这基本上是说，获得未来的日期（从现在起三十秒）。然后创建一个线程，该线程将在不同的时间段内休眠。然后提出你的事件。

编辑：添加更多关于计时器的信息。计时器没有什么问题，但我认为它可能更有效。您可以有一个计时器，其时间间隔为时间差。当时间赶上日期时间对象时，这将导致 tick 事件触发。另一种我不会推荐的替代方法，我似乎认为您已经考虑过这一点，即每五秒关闭一次计时器并检查时间是否匹配。我会避免这种方法并坚持让线程休眠，直到有工作要做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T21:37:54.493

计时器可能不是一个坏方法。只需使用 DateTime.Now 来检测它是否超过目标时间。不要使用 == 除非您尝试将时间标准化为分钟或小时或其他内容。

# code-formatting - 在线代码美化器和格式化程序

> ID：206441
> 
> 赞同：91
> 
> 时间：2008-10-15T20:54:44.547
> 
> 标签：code-formatting

什么是最好的在线代码美化器和格式化程序？我不是要荧光笔。任何语言都可以。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2011-01-19T12:12:35.260

CSS：[代码美化器](http://www.codebeautifier.com/)

HTML：[HTML Tidy](http://infohound.net/tidy/)、[CleanUp HTML](http://www.cleanuphtml.com/cleanup.html)或通用的[Pretty Diff](http://prettydiff.com/?m=beautify&html)

Javascript：http: [//jsbeautifier.org/](http://jsbeautifier.org/)

PHP：[http ://beta.phpformatter.com/](http://beta.phpformatter.com/)

SQL：[http ://dpriver.com/pp/sqlformat.htm](http://dpriver.com/pp/sqlformat.htm)

XML：[http ://chris.photobooks.com/xml/default.htm](http://chris.photobooks.com/xml/default.htm)

全部着色：http: [//quickhighlighter.com/](http://quickhighlighter.com/)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-16T12:52:36.067

对于 PHP、Java、C++、C、Perl、JavaScript、CSS，您可以尝试：

[http://www.prettyprinter.de/index.php](http://www.prettyprinter.de/index.php)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-16T14:07:41.000

您可以将[Perl::Tidy](http://search.cpan.org/dist/Perl-Tidy)用于 Perl。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-16T12:37:12.383

[JsonLint](http://www.jsonlint.com/)适用于验证和格式化 JSON。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T20:57:41.577

什么语言？？几乎每一种可以想象的编程语言都有不同的工具，因为它们都有不同的语法规则和约定。

Good ol'[`indent`](http://www.gnu.org/software/indent/)是一个很好的、可定制的命令行实用程序，用于格式化 C 和 C++ 程序。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-15T20:59:16.473

这取决于您使用的语言和架构。

![替代文字](https://i.stack.imgur.com/EIY9X.png) ![替代文字](https://i.stack.imgur.com/77KYh.png)

比如在一个php平台上，几乎可以用**[GeSHi格式化语言](http://qbnz.com/highlighter/)**

正如[蓝色](https://stackoverflow.com/users/505893/bluish)评论，GeSHi 是一个通用的语法荧光笔，没有美化功能。它更多地用于服务器端，将其与美化工具结合起来可能会很棘手，如[GeSHi drupal ticket](http://drupal.org/node/1054200)所示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-15T20:58:03.667

我经常使用[快速荧光笔](http://quickhighlighter.com/)。适用于大量语言。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-13T08:03:26.310

使用[gist.github.com](http://gist.github.com)。支持多语言（java、c、c++、c#、vb、haskell、ruby、javascript、lua、HTML、SQL、Tcl、Perl、JSON、groovy...）

这是一个示例[“使用 Groovy 生成 LiquiBase 更改日志”](https://gist.github.com/2027501)

# vb.net - vb.net中模棱两可的类成员

> ID：206447
> 
> 赞同：8
> 
> 时间：2008-10-15T20:55:38.010
> 
> 标签：vb.net, visual-studio

我正在尝试在 vb.net 中使用 C# 程序集中的类。该类的成员不明确，因为 vb.net 不区分大小写。类是这样的：

```
公共类 Foo {

  公共枚举格式{一，二，三}；

  公共格式格式{
    得到 {...}
    放 {...}
   }
}

```

我尝试访问枚举：Foo.FORMAT.ONE

这是不可能的，因为还有一个名为“格式”的属性。

我无法更改 C# 程序集。我怎样才能解决这个问题并从 vb.net 引用枚举？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T21:01:23.410

我不认为你能解决这个问题。与您尝试使用的 C# 组件的作者联系，并说服他们修复他们的代码。

顺便说一句，这是该属性背后的主要原因`CLSCompliant(true)`，如果您正在编写 API 或其他很可能被其他语言使用的代码，则应始终设置该属性。它会标记这个问题，让原作者意识到并正确修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T21:37:02.717

有几种方法可以解决它，但都不是一个好的选择。

一种是创建一个 C# 项目并将类完全包装，将模棱两可的成员更改为明确的成员。根据班级的规模，可能需要做很多工作，尽管显然您只需要包装您需要的成员。

另一种是使用反射，它不像包装那样工作，但与作者一开始只是正确编写代码相比，它仍然是毫无意义的工作。

# binary - 建议阅读 BITS/Bytes 和示例代码以执行操作等

> ID：206469
> 
> 赞同：2
> 
> 时间：2008-10-15T20:59:43.947
> 
> 标签：binary, byte, hex

需要复习一下位/字节、十六进制表示法以及它与编程的关系（首选 C#）。

寻找一个好的阅读清单（最好是在线）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T00:05:22.673

这里有几个层次需要考虑：

*   电子的

在电子范式中，一切都是电线。

一根线代表一个比特。

0 为低电压，1 为高电压。电压可能是`[0,5], [-3.3, 3], [-5, 5], [0, 1.3]`等。关键是只有两个电压电平可以控制晶体管的动作。

一个字节是电线的集合（准确地说，它可能收集在一组称为寄存器的触发器中，但现在让我们将其保留为“电线”）。

*   编程

一个位是 0 或 1。

在现代系统中，一个字节是 8 位。古代系统可能有 10 位字节或其他大小；他们今天不存在。

一个*nybble*是 4 位；半个字节。

十六进制是 8 位的有效表示。例如： F 映射到`1111 1111`。这比写 15 更有效。另外，如果您要写下多个字节值，这一点非常清楚：FF 是明确的；1515 有几种不同的读取方式。

从历史上看，八进制也被使用过（以 8 为底）。但是，我遇到的唯一地方是 Unix 权限。

由于在电子层上，以 2^n 为一组收集内存是最有效的，因此十六进制是表示内存的自然符号。此外，如果您碰巧在驱动程序级别工作，您可能需要专门控制给定的位，这将需要使用位级别的运算符。如果您说 `F & outputByte`than ，则很明显哪些字节在 HI 上`15 & outputByte`。

一般来说，许多现代编程不需要关注二进制和十六进制。然而，如果你在一个你需要知道它的地方，就不会溜走——那时你*真的*需要知道它。

需要二进制知识的特定领域包括：嵌入式系统、驱动程序编写、操作系统编写、网络协议和压缩算法。

虽然您想要 C#，但 C# 确实不是位级操作的正确语言。传统上，C 和 C++ 是用于位工作的语言。Erlang 使用位操作，Perl 也支持它。VHDL 完全面向位，但从典型的编程角度来看，使用起来相当困难。

下面是一些用于执行不同逻辑操作的示例 C 代码：

```
char a, b, c;  
c = a ^ b;      //XOR
c = a & b;      //AND
c = a | b;      //OR
c = ~(a & b);   //NOT AND(NAND)
c = ~a;         //NOT
c = a << 2;     //Left shift 2 places
c = a >> 2;     //Right shift 2 places. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T21:10:25.437

一位是 1 或 0。

一个字节是 8 位。

十六进制中的每个字符都是 4 位，表示为 0-F

*   0000 是 0
*   0001 是 1
*   0010 是 2
*   0011 是 3
*   ...
*   1110是E
*   1111是F

这里有一个很好的关于 C# 的位咀嚼操作的[介绍](http://www.c-sharpcorner.com/UploadFile/chandrahundigam/BitWiserOpsInCS11082005050940AM/BitWiserOpsInCS.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T21:13:17.677

这是一些基本阅读： http: [//www.learn-c.com/data_lines.htm](http://www.learn-c.com/data_lines.htm)

位和字节几乎与 C# 无关，因为 CLR 自己处理内存。框架中也有处理十六进制表示法和所有这些东西的类和方法。但是，它仍然是一个有趣的阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T21:57:02.130

[编写出色的代码](https://rads.stackoverflow.com/amzn/click/com/1593270038)是关于这个主题的一个很好的入门书……将你从裸机带到更高阶的语言。

# java - 从命令行构建 Eclipse Java 项目

> ID：206473
> 
> 赞同：122
> 
> 时间：2008-10-15T21:00:58.530
> 
> 标签：java, eclipse, command-line

有没有办法从命令行编译基于 Eclipse 的 Java 项目？

我正在尝试自动化我的构建（使用 FinalBuilder 而不是 ant），我既不是 Java 也不是 Eclipse 专家。我可能可以弄清楚如何使用直接的 java 命令行选项来做到这一点，但是 Eclipse 项目感觉就像是浪费了很多精力。

如果无法通过命令行编译 Eclipse 项目，有没有办法从 Eclipse 中生成所需的 java 命令行？或者是否有一些文件我可以四处寻找它在幕后执行的编译步骤？

* * *

伙计们，我正在寻找一个*不*包括蚂蚁的答案。让我重新重复最初的问题.......有没有办法从命令行构建一个 Eclipse 项目？

我不认为这是一个不合理的问题，因为我可以为视觉工作室做这样的事情：

```
devenv.exe /build "Debug|Any CPU" "C:\Projects\MyProject\source\MyProject.sln" 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-09-16T14:38:32.557

您可以从命令行通过工作区构建一个 Eclipse 项目：

```
eclipsec.exe -noSplash -data "D:\Source\MyProject\workspace" -application org.eclipse.jdt.apt.core.aptBuild 
```

它使用`jdt apt`插件自动构建您的工作区。这也称为“无头构建”。该死的很难弄清楚。如果你没有使用 win32 exe，你可以试试这个：

```
java -cp startup.jar -noSplash -data "D:\Source\MyProject\workspace" -application org.eclipse.jdt.apt.core.aptBuild 
```

**更新**

几年前 eclipse 被`startup.jar`“equinox 发射器”取代

[https://wiki.eclipse.org/Equinox_Launcher](https://wiki.eclipse.org/Equinox_Launcher)

在 Eclipse Mars (MacOX) 上：

```
java -jar /Applications/Eclipse.app/Contents/Eclipse/plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jar -noSplash -data "workspace" -application org.eclipse.jdt.apt.core.aptBuild 
```

该`-data`参数指定工作区的位置。

Equinox 启动器的版本号将取决于您拥有的 Eclipse 版本。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-15T21:32:17.890

为了完成 André 的回答，ant 解决方案可能类似于[Emacs、JDEE、Ant 和 Eclipse Java Compiler](http://www.emacsblog.org/2007/02/13/emacs-jdee-ant-and-the-eclipse-java-compiler/)中描述的解决方案，如下所示：

```
 <javac
          srcdir="${src}"
          destdir="${build.dir}/classes"> 
        <compilerarg 
           compiler="org.eclipse.jdt.core.JDTCompilerAdapter" 
           line="-warn:+unused -Xemacs"/>
        <classpath refid="compile.classpath" />
      </javac> 
```

compilerarg 元素还允许您将其他命令行参数传递给 eclipse 编译器。

您可以在此处找到[完整的 ant 脚本示例，](http://dev.eclipse.org/newslists/news.eclipse.platform.rcp/msg31872.html)该示例将***在命令行中调用***：

```
java -cp C:/eclipse-SDK-3.4-win32/eclipse/plugins/org.eclipse.equinox.launcher_1.0.100.v20080509-1800.jar org.eclipse.core.launcher.Main -data "C:\Documents and Settings\Administrator\workspace" -application org.eclipse.ant.core.antRunner -buildfile build.xml -verbose 
```

* * *

但是所有涉及蚂蚁的东西，这不是基思所追求的。

关于批量编译，请参考**[编译 Java 代码](http://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.jdt.doc.isv%2Fguide%2Fjdt_api_compile.htm)**，尤其是“***使用批量编译器***”一节

> 批处理编译器类位于 JDT Core 插件中。类的名称是 org.eclipse.jdt.compiler.batch.BatchCompiler。它被打包到 plugins/org.eclipse.jdt.core_3.4.0..jar 中。从 3.2 开始，它也可以单独下载。该文件的名称是 ecj.jar。
> 从 3.3 开始，这个 jar 还包含对 jsr199（编译器 API）的支持和对 jsr269（注解处理）的支持。为了使用注释处理支持，需要 1.6 VM。

从命令行运行批处理编译器会给出

```
java -jar org.eclipse.jdt.core_3.4.0<qualifier>.jar -classpath rt.jar A.java 
```

或者：

```
java -jar ecj.jar -classpath rt.jar A.java 
```

该部分还详细介绍了所有 java 编译选项。

与 Visual Studio 命令行编译功能的不同之处在于***Eclipse 似乎并不直接在命令行参数中读取其 .project 和 .classpath***。您必须在各种命令行选项中报告 .project 和 .classpath 中包含的所有信息，才能获得完全相同的编译结果。

所以，简短的回答是：“是的，Eclipse 确实如此。” ;)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-09-30T16:52:14.073

27 年后，我也对在 IDE 中开发感到不舒服。我尝试了这些建议（上图）——可能只是没有正确地遵循一切——所以我进行了网络搜索，并在[http://incise.org/android-development-on-the-找到了对我有用的方法命令行.html](http://incise.org/android-development-on-the-command-line.html) '。

答案似乎是上述所有答案的组合（如果我错了，请告诉我，如果错了，请接受我的道歉）。

如上所述，eclipse/adt 不会创建必要的 ant 文件。为了在没有 Eclipse IDE 的情况下编译（并且不创建 ant 脚本）：

1) 在您的顶级目录中生成 build.xml：

```
android list targets  (to get target id used below)

android update project --target target_id --name project_name  --path top_level_directory

   ** my sample project had a target_id of 1 and a project name of 't1', and 
   I am building from the top level directory of project
   my command line looks like android update project --target 1 --name t1 --path `pwd` 
```

2）接下来我编译项目。我对不使用“ant”的要求有点困惑。希望——请求者的意思是他不想编写任何 ant 脚本。我这样说是因为下一步是使用 ant 编译应用程序

```
 ant target

    this confused me a little bit, because i thought they were talking about the
    android device, but they're not.  It's the mode  (debug/release)
    my command line looks like  ant debug 
```

3）要将apk安装到我不得不再次使用ant的设备上：

```
 ant target install

    ** my command line looked like  ant debug install 
```

4) 要在我的安卓手机上运行该项目，我使用 adb。

```
 adb shell 'am start -n your.project.name/.activity'

    ** Again there was some confusion as to what exactly I had to use for project 
    My command line looked like adb shell 'am start -n com.example.t1/.MainActivity'
    I also found that if you type 'adb shell' you get put to a cli shell interface
    where you can do just about anything from there. 
```

3A) 附注：查看设备使用日志：

```
 adb logcat 
```

3B）第二个附注：上面提到的链接还包括从命令构建整个项目的说明。

希望这将有助于解决这个问题。我知道我很高兴在这里找到有关此主题的*任何信息。*

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-15T21:09:25.453

通常的方法是相反的：您基于[maven](http://maven.apache.org/)或[ant](http://ant.apache.org)创建构建，然后为您选择的 IDE 使用集成，以便您独立于它，尤其是。当您尝试让新的团队成员加快速度或使用连续的集成服务器进行自动构建时，这一点很重要。我建议使用 maven 并让它为您完成繁重的工作。创建一个 pom 文件并通过 mvn eclipse:eclipse 生成 eclipse 项目。高温高压

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T21:10:05.203

[这个问题](https://stackoverflow.com/questions/133234/building-eclipse-plugins-and-features-on-the-command-line)包含一些关于无头构建的有用链接，但它们主要用于构建插件。我不确定其中有多少可以应用于纯 Java 项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-03T23:46:52.853

只是想把我的两分钱加到这个上。我尝试按照@Kieveli 对非 win32 的建议进行操作（下面重复），但它对我不起作用（在带有 Eclipse 的 CentOS 上：Luna）：

```
java -cp startup.jar -noSplash -data "D:\Source\MyProject\workspace" -application org.eclipse.jdt.apt.core.aptBuild 
```

在我使用 Eclipse (Luna) 在 CentOS 上的特定设置中，这有效：

```
$ECLIPSE_HOME/eclipse -nosplash -application org.eclipse.jdt.apt.core.aptBuild  startup.jar -data ~/workspace 
```

输出应如下所示：

```
Building workspace
Building '/RemoteSystemsTempFiles'
Building '/test'
Invoking 'Java Builder' on '/test'.
Cleaning output folder for test
Build done
Building workspace
Building '/RemoteSystemsTempFiles'
Building '/test'
Invoking 'Java Builder' on '/test'.
Preparing to build test
Cleaning output folder for test
Copying resources to the output folder
Analyzing sources
Compiling test/src/com/company/test/tool
Build done 
```

不太清楚为什么它显然做了两次，但它似乎有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T09:04:23.450

嗨，除了 VonC 评论。我正在使用 ecj 编译器来编译我的项目。一些课程没有找到，这让我感到很奇怪。但是该项目使用 javac 编译器构建得很好。

所以我只是将类添加到类路径中（我们必须将其作为参数传递），现在它工作正常...... :)

库尔比尔辛格

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-16T03:59:09.510

简短的回答。不。Eclipse 没有像 Visual Studio 这样的命令行开关来构建项目。

# asp.net - Web 服务请求是否保证到达文件末尾？

> ID：206478
> 
> 赞同：0
> 
> 时间：2008-10-15T21:02:39.913
> 
> 标签：asp.net, web-services

如果我通过 Web 服务传输数据，它是否保证已到达文件末尾？

数据发送怎么样，它是否保证它没有以某种方式损坏？

（使用 asp.net 网络服务）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T09:25:06.857

HTTP 使用 TCP 进行传输，包括错误检测和损坏数据的自动重新发送。检测非常可靠，但并不完美：一些错误仍然可以通过。

ASP.NET 没有在 TCP 提供的保护之上添加任何防止数据损坏的保护，因此您的数据可能在传输过程中被损坏。

如果您确实需要确保您的数据没有损坏，您可以对您的数据进行哈希处理，并将生成的哈希与您的请求（或响应）中的数据一起发送。在接收端，对接收到的数据进行哈希处理并比较两个哈希值。如果它们不同，则数据已损坏，您可以采取适当的措施。

这种技术非常强大：数据和散列极不可能以它们仍然对应的方式损坏。

# sql - 'where' 子句中的 SQL 切换/大小写

> ID：206484
> 
> 赞同：164
> 
> 时间：2008-10-15T21:04:17.913
> 
> 标签：sql, switch-statement, case

我尝试四处寻找，但找不到任何可以帮助我的东西。

我正在尝试在 SQL 中执行此操作：

```
declare @locationType varchar(50);
declare @locationID int;

SELECT column1, column2
FROM viewWhatever
WHERE
CASE @locationType
    WHEN 'location' THEN account_location = @locationID
    WHEN 'area' THEN xxx_location_area = @locationID
    WHEN 'division' THEN xxx_location_division = @locationID 
```

我知道我不应该把'= @locationID'放在每一个的末尾，但我无法得到接近正确的语法。SQL 在第一行 WHEN 上一直抱怨我的“=”...

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-10-15T21:10:00.057

```
declare @locationType varchar(50);
declare @locationID int;

SELECT column1, column2
FROM viewWhatever
WHERE
@locationID = 
  CASE @locationType
      WHEN 'location' THEN account_location
      WHEN 'area' THEN xxx_location_area 
      WHEN 'division' THEN xxx_location_division 
  END 
```

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-05-13T15:33:31.183

没有案例陈述...

```
SELECT column1, column2
FROM viewWhatever
WHERE
    (@locationType = 'location' AND account_location = @locationID)
    OR
    (@locationType = 'area' AND xxx_location_area = @locationID)
    OR
    (@locationType = 'division' AND xxx_location_division = @locationID) 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2008-10-15T22:08:04.493

干得好。

```
SELECT
   column1, 
   column2
FROM
   viewWhatever
WHERE
CASE 
    WHEN @locationType = 'location' AND account_location = @locationID THEN 1
    WHEN @locationType = 'area' AND xxx_location_area = @locationID THEN 1
    WHEN @locationType = 'division' AND xxx_location_division = @locationID THEN 1
    ELSE 0
END = 1 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-15T21:12:37.680

我会说这是一个有缺陷的表结构的指标。也许不同的位置类型应该在不同的表中分开，使您能够进行更丰富的查询并避免周围有多余的列。

如果您无法更改结构，可能会使用以下方法：

```
SELECT
    *
FROM
    Test
WHERE
    Account_Location = (
        CASE LocationType
          WHEN 'location' THEN @locationID
          ELSE Account_Location
        END
    )
    AND
    Account_Location_Area = (
        CASE LocationType
          WHEN 'area' THEN @locationID
          ELSE Account_Location_Area
        END
    ) 
```

等等......我们不能动态地改变查询的结构，但是我们可以通过使谓词等于它们自己来覆盖它。

编辑：上述建议当然要好得多，请忽略我的建议。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-15T21:13:20.877

这样做的问题是，当 SQL 引擎去评估表达式时，它检查 FROM 部分以提取正确的表，然后检查 WHERE 部分以提供一些基本条件，因此它无法正确评估要在哪个列上的动态条件检查对照。

在检查谓词中的 WHERE 条件时，可以使用 WHERE 子句，例如

```
WHERE account_location = CASE @locationType
                              WHEN 'business' THEN 45
                              WHEN 'area' THEN 52
                         END 
```

因此，在您的特定情况下，您将需要将查询放入存储过程或创建三个单独的查询。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-09-01T14:32:34.713

OR 运算符可以在 where 条件下替代 case

```
ALTER PROCEDURE [dbo].[RPT_340bClinicDrugInventorySummary]
    -- Add the parameters for the stored procedure here
     @ClinicId BIGINT = 0,
     @selecttype int,
     @selectedValue varchar (50)
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;
SELECT
    drugstock_drugname.n_cur_bal,drugname.cdrugname,clinic.cclinicname

FROM drugstock_drugname
INNER JOIN drugname ON drugstock_drugname.drugnameid_FK = drugname.drugnameid_PK
INNER JOIN drugstock_drugndc ON drugname.drugnameid_PK = drugstock_drugndc.drugnameid_FK
INNER JOIN drugndc ON drugstock_drugndc.drugndcid_FK = drugndc.drugid_PK
LEFT JOIN clinic ON drugstock_drugname.clinicid_FK = clinic.clinicid_PK

WHERE   (@ClinicId = 0 AND 1 = 1)
    OR  (@ClinicId != 0 AND drugstock_drugname.clinicid_FK = @ClinicId)

    -- Alternative Case When You can use OR
    AND ((@selecttype = 1 AND 1 = 1)
    OR  (@selecttype = 2 AND drugname.drugnameid_PK = @selectedValue)
    OR  (@selecttype = 3 AND drugndc.drugid_PK = @selectedValue)
    OR  (@selecttype = 4 AND drugname.cdrugclass = 'C2')
    OR  (@selecttype = 5 AND LEFT(drugname.cdrugclass, 1) = 'C'))

ORDER BY clinic.cclinicname, drugname.cdrugname
END 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-05-31T06:16:17.847

请尝试此查询。回复以上帖子：

```
select @msgID, account_id
    from viewMailAccountsHeirachy
    where 
    CASE @smartLocationType
        WHEN 'store' THEN account_location
        WHEN 'area' THEN xxx_location_area 
        WHEN 'division' THEN xxx_location_division 
        WHEN 'company' THEN xxx_location_company 
    END  = @smartLocation 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-01-27T09:24:16.633

试试这个：

```
WHERE (
    @smartLocationType IS NULL 
    OR account_location = (
         CASE
            WHEN @smartLocationType IS NOT NULL 
                 THEN @smartLocationType
            ELSE account_location 
         END
    )
) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-10T06:42:00.513

```
CREATE PROCEDURE [dbo].[Temp_Proc_Select_City]
    @StateId INT
AS  
        BEGIN       
            SELECT * FROM tbl_City 
                WHERE 
                @StateID = CASE WHEN ISNULL(@StateId,0) = 0 THEN 0 ELSE StateId END ORDER BY CityName
        END 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-14T01:13:00.020

试试这个查询，它非常简单有用：它可以执行了！

```
USE tempdb
GO

IF NOT OBJECT_ID('Tempdb..Contacts') IS NULL
    DROP TABLE Contacts

CREATE TABLE Contacts(ID INT, FirstName VARCHAR(100), LastName VARCHAR(100))
INSERT INTO Contacts (ID, FirstName, LastName)
SELECT 1, 'Omid', 'Karami'
UNION ALL
SELECT 2, 'Alen', 'Fars'
UNION ALL
SELECT 3, 'Sharon', 'b'
UNION ALL
SELECT 4, 'Poja', 'Kar'
UNION ALL
SELECT 5, 'Ryan', 'Lasr'
GO

DECLARE @FirstName VARCHAR(100)
SET @FirstName = 'Omid'

DECLARE @LastName VARCHAR(100)
SET @LastName = '' 

SELECT FirstName, LastName
FROM Contacts
WHERE  
    FirstName = CASE
    WHEN LEN(@FirstName) > 0 THEN  @FirstName 
    ELSE FirstName 
    END
AND
    LastName = CASE
    WHEN LEN(@LastName) > 0 THEN  @LastName 
    ELSE LastName
    END
GO 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-06-08T05:43:49.697

```
Case Statement in SQL Server Example

Syntax

CASE [ expression ]

   WHEN condition_1 THEN result_1
   WHEN condition_2 THEN result_2
   ...
   WHEN condition_n THEN result_n

   ELSE result

END

Example

SELECT contact_id,
CASE website_id
  WHEN 1 THEN 'TechOnTheNet.com'
  WHEN 2 THEN 'CheckYourMath.com'
  ELSE 'BigActivities.com'
END
FROM contacts;

OR

SELECT contact_id,
CASE
  WHEN website_id = 1 THEN 'TechOnTheNet.com'
  WHEN website_id = 2 THEN 'CheckYourMath.com'
  ELSE 'BigActivities.com'
END
FROM contacts; 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-03-05T04:35:33.693

这对我有用。

`CREATE TABLE PER_CAL ( CAL_YEAR INT, CAL_PER INT ) INSERT INTO PER_CAL( CAL_YEAR, CAL_PER ) VALUES ( 20,1 ), ( 20,2 ), ( 20,3 ), ( 20,4 ), ( 20,5 ), ( 20,6 ), ( 20,7 ), ( 20,8 ), ( 20,9 ), ( 20,10 ), ( 20,11 ), ( 20,12 ), ( 99,1 ), ( 99,2 ), ( 99,3 ), ( 99,4 ), ( 99,5 ), ( 99,6 ), ( 99,7 ), ( 99,8 ), ( 99,9 ), ( 99,10 ), ( 99,11 ), ( 99,12 )`

4位世纪由规则确定，如果年份为50或更多，则世纪为1900，否则为2000。

给定两个标记开始和结束时间段的 6 位数时间段，例如四分之一，返回该范围内的行。

`-- 1st quarter of 2020 SELECT * FROM PER_CAL WHERE (( CASE WHEN CAL_YEAR > 50 THEN 1900 ELSE 2000 END + CAL_YEAR ) * 100 + CAL_PER ) BETWEEN 202001 AND 202003 -- 4th quarter of 1999 SELECT * FROM PER_CAL WHERE (( CASE WHEN CAL_YEAR > 50 THEN 1900 ELSE 2000 END + CAL_YEAR ) * 100 + CAL_PER ) BETWEEN 199910 AND 199912`

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-02-03T11:21:11.960

试试这个查询。它很容易理解：

```
CREATE TABLE PersonsDetail(FirstName nvarchar(20), LastName nvarchar(20), GenderID int);
GO

INSERT INTO PersonsDetail VALUES(N'Gourav', N'Bhatia', 2),
              (N'Ramesh', N'Kumar', 1),
              (N'Ram', N'Lal', 2),
              (N'Sunil', N'Kumar', 3),
              (N'Sunny', N'Sehgal', 1),
              (N'Malkeet', N'Shaoul', 3),
              (N'Jassy', N'Sohal', 2);
GO

SELECT FirstName, LastName, Gender =
    CASE GenderID
    WHEN 1 THEN 'Male'
    WHEN 2 THEN 'Female'
    ELSE 'Unknown'
    END
FROM PersonsDetail 
```

# sql - MS SQL Server 2005 上的索引 varchar

> ID：206490
> 
> 赞同：6
> 
> 时间：2008-10-15T21:07:44.710
> 
> 标签：sql, sql-server-2005

我需要在 MS SQL Server 2005 中的表上索引一个 varchar 字段，但我不清楚该怎么做。如果我尝试在该字段上添加非聚集索引，它会显示“表 'mytable' 中的列 'xxxx' 的类型对于用作索引中的键列无效”

我的表有一个自动递增的 int ID，它被设置为表上的主键。如果我将此属性设置为索引，然后将我的 varchar 列添加为“包含列”，则索引将通过。但我不确定这就是我想要的 - 我希望能够仅基于 varchar 字段搜索表，我对索引的理解是必须提供所有索引元素才能实际看到查询中的加速，但我不想包含 int ID（因为在给定查询时我不知道它是什么）。

我是否试图错误地执行此操作？ID + my varchar 作为包含的列会完成我正在寻找的内容吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T21:14:57.377

是你的`varchar(max)`吗？我认为这些不允许在索引中使用。

否则，发布您的声明，通常将 a 添加到索引`CREATE TABLE`没有问题。`varchar`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T08:57:32.547

我假设您的列是 VARCHAR(MAX) 列，正如错误所说，它是索引的无效数据类型。建议：创建一个计算列，它是 VARCHAR(MAX) 列的哈希值（例如使用 HashBytes 函数），然后仅在计算列上创建索引。然后，在 SQL DML 的搜索条件（例如 WHERE 子句）中，您将同时使用 VARCHAR(MAX) 搜索值本身*以及*表中相应列上的 VARCHAR(MAX) 搜索值的哈希值。将搜索值的散列封装在“帮助”存储过程中可能是一个好主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T21:15:51.620

不，ID + varchar 列不起作用。这对于您在 ID 上进行查找并仅选择 ID 或/和 varchar 列的查询非常有用 - 然后您将拥有一个覆盖索引，并且只能通过查看索引来检索所有内容。

我猜你的 ID 列上有一个聚集索引，因为那是主键。然后你需要在 varchar 列上创建一个非聚集索引——这应该是可能的。非聚集索引也将自动包含 ID。

还要记住，索引只适用于 WHERE VarcharColumn = 'xyz' 和 WHERE VarcharColumn LIKE 'xyz%' 之类的查询。

它对 LIKE '%xyz%' 和 '%xyz' 查询没有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T21:27:22.203

默认情况下将列设置为主键会创建一个聚集索引，因此您不必创建另一个 INT+VARCHAR 索引。

您正在寻找的只是您的 VARCHAR 上的索引 - 没有 +INT，因为您的主键被隐式包含 - 毕竟 SQL Server 在执行索引查找时应该能够找到实际行。不过有一个限制，我相信索引列的总大小应该小于 900 字节（至少在 SQL Server 2000 中是这样）。你的 VARCHAR 有多长？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T21:17:37.637

您无需在主键中包含 varchar 字段即可对其进行索引。要创建索引，只需在 Management Studio 中修改表，单击“管理索引和键”按钮，然后单击“添加”以添加新索引。然后选择 VARCHAR 字段。应该没有问题。

# wpf - WPF 列表框在 MouseOver 上的 ItemTemplate 中显示按钮

> ID：206495
> 
> 赞同：36
> 
> 时间：2008-10-15T21:09:15.160
> 
> 标签：wpf, listbox

我有一个包含图像和按钮的列表框。默认情况下，该按钮是隐藏的。每当我将鼠标悬停在列表框中的项目上时，我都想让按钮可见。我正在使用的 XAML 如下。谢谢

```
<Window.Resources>
        <Style TargetType="{x:Type ListBox}">
    <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <Border BorderBrush="Black" BorderThickness="1" Margin="6">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{Binding Path=FullPath}" Height="150" Width="150"/>
                                    <Button x:Name="sideButton" Width="20" Visibility="Hidden"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
        </Style>
    </Window.Resources> 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-15T21:16:00.683

好的，在你的按钮声明中试试这个：

```
<Button x:Name="sideButton" Width="20">
    <Button.Style>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Visibility" Value="Hidden" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ListBoxItem}},Path=IsMouseOver}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Button.Style>
</Button> 
```

所以我使用带有触发器的样式来回顾视觉树，直到找到 a `ListBoxItem`，当它的`IsMouseOver`属性翻转到时，`True`我将`button`的可见性设置为`Visible`。

看看它是否接近你想要的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-16T07:21:00.400

这`Style`可以满足您的需要。在鼠标悬停时，该按钮仅在指针悬停在`ListBoxItem`. 特殊技巧是绑定到`TemplatedParent`forreaching`IsMouseOver`和 use `TargetName`on the`Setter`以仅影响`Button`.

```
<Style TargetType="{x:Type ListBoxItem}">
    <Setter Property="ContentTemplate">
        <Setter.Value>
            <DataTemplate>
                <Border BorderBrush="Black"
                        BorderThickness="1"
                        Margin="6">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{Binding Path=FullPath}"
                               Height="150"
                               Width="150" />
                        <Button x:Name="sideButton"
                                Width="20"
                                Visibility="Hidden" />
                    </StackPanel>
                </Border>
                <DataTemplate.Triggers>
                    <DataTrigger Binding="{Binding IsMouseOver,RelativeSource={RelativeSource TemplatedParent}}"
                                 Value="True">
                        <Setter Property="Visibility"
                                TargetName="sideButton"
                                Value="Visible" />
                    </DataTrigger>
                </DataTemplate.Triggers>
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-16T09:04:12.843

@David 展示了正确的方法，但我对您的 XAML 架构有一个建议。如果您在 Button 上没有任何 DataBinding，最好将其放入 ListBoxItem 样式而不是 DataTemplate，如下所示。

```
 <Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Border BorderBrush="Black"
                    BorderThickness="1"
                    Margin="6">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="{Binding Path=FullPath}"
                           Height="150"
                           Width="150" />                             
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </Setter.Value>
        </Setter>            
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Grid Background="Transparent">
                        <Button x:Name="sideButton" Width="20" HorizontalAlignment="Right" Visibility="Hidden" />
                        <ContentPresenter/>                            
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger  Property="IsMouseOver" Value="True">
                            <Setter Property="Visibility"
                            TargetName="sideButton"
                            Value="Visible" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>            
    </Style> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-11T05:21:02.077

> 只是想知道，如果我们使用上面的技术，我们如何确定按钮被点击的是哪个项目？

要回答 Brian 的问题，在按钮单击处理程序中，您可以沿着可视化树查找包含该按钮的项目：

```
 DependencyObject dep = (DependencyObject)e.OriginalSource;
        while ((dep != null) && !(dep is ListBoxItem))
        {
            dep = VisualTreeHelper.GetParent(dep);
        }

        if (dep != null)
        {
            // TODO: do stuff with the item here.
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-21T23:12:51.730

查找单击的项目的一种解决方案是添加以下事件设置器

XAML

C# void ListBoxItem_MouseEnter(object sender, MouseEventArgs e) { _memberVar = (sender as ListBoxItem).Content; }

# c++ - 需要通过函数指针访问类对象 - 二叉搜索树类创建相关

> ID：206498
> 
> 赞同：1
> 
> 时间：2008-10-15T21:09:32.287
> 
> 标签：c++, binary-tree, binary-search-tree

使用递归为二叉搜索树创建遍历。

```
void inOrder(void (*inOrderPtr)(T&)) 
{ 
    if(this->left != NULL) 
        inOrder((*inOrderPtr)(this->left)); 
    inOrderPtr(this->data); 
    if(this->right != NULL) 
        inOrder((*inOrderPtr)(this->right)); 
} 
```

这是功能。现在这显然是错误的。这个函数是这样调用的：

```
first.inOrder(print_vals); 
```

首先是对象，而 print vals 只是一个打印对象中数据的函数。每个对象都有三个值，数据、左和右。我如何使用该功能实际访问这些项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T21:15:40.793

看起来调用`inOrderPtr(this->data)`只是将`data`树节点的成员传递给`print_vals`函数。如果您想访问`left`和`right`元素，请使用`inOrderPtr(*this)`. 您必须更改各种声明才能编译，例如 和 的`inOrderPtr`声明`print_vals`。如果没有看到您的其余代码，很难说出您需要将它们更改为什么。

另一方面，在我看来，您可能希望将递归调用编写得更像这样：

```
this->left->inOrder(inOrderPtr); 
```

不过，我正在对您的实施做出假设。

# visual-studio-2008 - 如何让 Visual Studio 2008 对象测试台工作？

> ID：206505
> 
> 赞同：4
> 
> 时间：2008-10-15T21:10:28.103
> 
> 标签：visual-studio-2008, object-test-bench

我想在 VS2008 中使用 Object Test Bench。文档——甚至是测试台窗口中的有用文本——说在类视图中右键单击类。进一步阅读表明该类必须在启动项目或引用的程序集中。我已经在多个程序集中（启动项目或引用项目）中尝试了许多类——公共的、私有的、静态的，你可以命名它，并且上下文菜单项“创建实例”从未出现。

有没有人有这方面的运气？这是一个错误，还是我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T22:05:06.933

解决了！

我有多个项目要在启动时运行（我已经习惯了这种工作方式，我什至没有意识到有什么不同！）。

只设置一个启动项目解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T21:31:53.273

如果项目是控制台或 Windows 窗体应用程序，我只能让它在启动项目中工作。它似乎不适用于网站。

顺便提一句。我从来没有在实践中使用它。在试图弄清楚为什么它不适合你的情况下玩了一段时间之后，我现在知道为什么了！在一个完全工作的项目中做一些本应简单的事情是非常困难的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T21:58:11.720

我知道如果不安装 Visual J++，你无法让它在 VS2005 中工作，但这显然不是问题，因为你使用的是 VS2008。您确定您正在查看类视图而不是查看解决方案视图中的类吗（我知道这听起来很愚蠢，但这是我第一次尝试使用它时遇到的问题）。

# json - 替换 XML 以表示 C++ 中的数据结构

> ID：206512
> 
> 赞同：1
> 
> 时间：2008-10-15T21:11:17.510
> 
> 标签：json, xml, representation

在工作中，我们有一个用于向数据源发送查询的测试工具。该工具将输入作为 XML 文件。只要我们试图表示的数据结构是一层深的，XML 文件就很简单且易于解析。但是现在这些数据结构更加复杂，并且在 XML 中表示它们变得非常混乱。关于我可以用什么来表示数据结构而不是 XML 的任何想法？

例子：

前：

```
class Foo {
 int userId;
 string name;
 string address;
 string eMail;
} 
```

现在：

```
class Foo {
 int userId,
 string name,
 vector<Location> loc,
 map<string, string> attributes;
}

class Location {
  Address addr; //class Address
  vector<LocatedTime> lcTime; //class LocatedTime
  Position ps; //class Position
} 
```

...等等以具有任意数量的嵌套结构。

我倾向于 JSON，但对任何表示格式持开放态度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T21:16:18.450

你看过[协议缓冲区](http://code.google.com/p/protobuf/)吗？二进制序列化在处理时间和存储空间方面非常有效。目前在 C++、Java 和 Python 中得到“适当”的支持，还有更多的实现（来自第三方——比如我自己；我正在实现一个 C# 端口）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:14:08.830

[YAML](http://www.yaml.org)可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T12:05:29.217

您可能会考虑使用 Lua（或其他脚本语言）。您将获得一个很好的数据结构语法（与 JSON 大致相当），并具有编程语言的全部功能。因此，您有变量（您可以逐个构建数据结构、符号声明重复值等）、循环（测试数据通常是重复的）、函数（将它们视为数据中样板结构的宏）。

Lua 是这种用途的一个特别有吸引力的候选者，因为它很小（给你的程序增加了 100-200K）并且有一个非常优雅的 C 代码接口。

# javascript - 不一致的 JavaScript 函数结果

> ID：206528
> 
> 赞同：1
> 
> 时间：2008-10-15T21:14:36.630
> 
> 标签：javascript, html

我在我的 Javascript 代码中有这个函数，它可以在调用时用它们的新值更新 html 字段。问题不在于函数本身，因为它在除一个部分之外的每个部分都表现出色。这是JS函数：

```
 function updateFields() {
    document.getElementById('bf').innerHTML = bill.time[breakfast][bill.pointPartOfWeek];
    document.getElementById('ln').innerHTML = bill.time[lunch][bill.pointPartOfWeek];
    document.getElementById('dn').innerHTML = bill.time[dinner][bill.pointPartOfWeek];
    document.getElementById('se').innerHTML = bill.time[special][bill.pointPartOfWeek];
    document.getElementById('fdr').innerHTML = bill.time[full][bill.pointPartOfWeek];
    document.getElementById('cost').innerHTML = bill.cost;
  } 
```

它在以下情况下执行良好：

```
 <select onchange='if(this.selectedIndex == 0) {bill.unholiday();updateFields()} else { bill.holiday();updateFields()}' id='date' name='date'>
    <option value='else'>Jan. 02 - Nov. 20</option>
    <option value='christmas'>Nov. 20 - Jan. 01</option>
  </select> 
```

但是在这个非常相似的代码中，函数的最后一行似乎没有执行（它不会更新成本字段，但会更新其他所有内容）

```
 <select onchange='if(this.selectedIndex == 0) {bill.pointPartOfWeek = 1;} else { bill.pointPartOfWeek = 2;}updateFields();alert(updateFields());' id='day' name='day'>
    <option value='0'>Monday thru Thursday</option>
    <option value='1'>Friday, Saturday, or Sunday</option>
  </select>
  <br /> 
```

奇怪的是，总成本变量本身会更新，但表示该变量的字段却没有。如果您使用不会更改总成本值但再次调用 updateFields 函数的页面的另一部分，则成本字段将正确更新。一定是调用的函数有问题。

注意：我们知道函数执行是因为它完成了它应该做的 6 件事情中的 5 件。这是一个奇怪的问题。

编辑：整个页面的 pastebin 会很有帮助。这里是：

[http://pastebin.com/f70d584d3](http://pastebin.com/f70d584d3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T21:26:49.647

我很好奇，是否有可能实际上有 2 个元素的 id 为“成本”？通过更新它找到的第一个，这可能会导致此问题。不同的浏览器可能有不同的实现 document.getElementById() 的方式，因此如果是这种情况，您可能会在不同的浏览器中得到更加不一致的结果。

更新：事实证明，您需要在第二次选择中调用 updateFields() 之前调用 bill.holiday() 或 bill.unholiday() 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T21:51:01.563

我对 getElementById 的体验充其量是好坏参半，这很可能是您的问题。可能是某种浏览器 DOM 错误，其中您有两个具有相同 ID 的项目，或者类似的东西。

我使用[Prototype](http://www.prototypejs.org)，它可以让你通过一个简单的调用来避免歧义和挑剔的浏览器：

```
document.getElementById('bf') 
```

变成

```
$('bf') 
```

同样，您可以轻松地更新元素的 innerHTML：

```
$('bf').update(bill.time[breakfast][bill.pointPartOfWeek]); 
```

看看这个。它救了我的培根好几次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T22:42:29.963

问题是当您调用 updateFields() 时，台球对象上的成本属性尚未更新。您需要调用 bill.calculate() 来更新成本属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T23:28:35.877

我现在明白为什么 Eric 的解决方案有效……这让我找到了更好的解决方案。

他的帖子由于某种原因被删除，但我评论了他的另一篇帖子，解释了他的回答。

无论如何，他说要调用 holiday() 或 unholiday()。当您查看这些函数时，您会在最后一行代码中看到：

```
this.setRoom(this.pointPartOfDay,this.pointPartOfWeek); 
```

然后一切开始变得有意义。之前，我只是将 pointPartOfWeek 设置为它的新值并继续前进。但 pointPartOfDay 只是一个数组地址。我从未真正更新过房间费用。这也解释了为什么成本最终会自我纠正。只要 pointPartOfWeek 没有改变，对 setRoom 的调用仍然会固定金额（即使在另一个事件中）。

调试的乐趣...

# linq - LINQ 未更新 .SubmitChanges()

> ID：206532
> 
> 赞同：25
> 
> 时间：2008-10-15T21:15:18.093
> 
> 标签：linq, linq-to-sql, submitchanges

有什么理由这样的事情不起作用吗？

这是我多次使用 LINQ 更新表中记录的逻辑：

```
 DataClasses1DataContext db = new DataClasses1DataContext();
 User updateUser = db.Users.Single(e => e.user == user);
 updateUser.InUse = !updateUser.InUse;
 db.Log = new System.IO.StreamWriter(@"c:\temp\linq.log") { AutoFlush = true };
 db.SubmitChanges(); 
```

（updateUser.InUse 是一个位域）

由于某种原因，它不起作用。当我检查 linq.log 时，它完全是空白的。

我的 .dbml 可能有问题吗？其他表似乎工作正常，但我比较了 .dbml 中的属性，它们都匹配。

就好像`db.SubmitChanges()`; 未检测到需要任何更新。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-10-16T13:12:02.173

该表无法正确更新，因为它没有主键。（实际上它有列，但是当我执行 SELECT INTO 我的开发表时，约束没有被复制）。**DataContext 类需要用于更新的主键。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:22:31.340

就 LINQ 而言，InUse 属性是“正常”属性吗？（例如，它不是自动生成的或类似的任何时髦的东西？）

或者，我不认为它是 Nullable<bool> ，当前值为 null 吗？如果是这样，您的更新行实际上并没有做任何事情 - 对于可为空的布尔值，!null = null。

# boo - Boo 能为您做什么？

> ID：206539
> 
> 赞同：10
> 
> 时间：2008-10-15T21:16:19.433
> 
> 标签：boo

试图获得一个业余项目爱好，让我从朝九晚五的 C# 工作中保持动力，并且正在研究 Boo。一些？

*   你和 Boo 在一起是什么体验？
*   您使用 Boo 完成了哪些应用程序/项目或
*   Boo有什么能力？

猜猜是网络世界，想弄脏桌面应用程序等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T21:39:57.063

我与 Boo 的个人经历是从大约 18 个月前开始的，从那时起我就没有积极地遵循它，**所以请记住我所说**的。这是一种*很酷*的语言。但这也是实验性的。这实际上意味着什么：

*   你可以用语言做很酷的事情。他们允许的宏，加上混合了 ruby​​ 和 python 和其他语言的良好特性。
*   您可以通过 SharpDevelop 使用 WinForms 设计器（将 Boo 集成为标准开发语言）。
*   由于尚未完成，因此偶尔会在关键区域出现不一致和错误。

*   我不确定是否可以使用 Boo 创建泛型，但它们肯定可以使用。

*   性能很好，但编译器没有优化器。

*   类型推断很酷。鸭打字很酷。所有这些都可以让您接近动态类型的错觉。

就个人而言，我开发了一种工具来简化创意写作。为作家考虑 IDE。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T21:19:22.360

虽然它只使用 Boo 作为实现语言（而不是从根本上讲*Boo*），但您是否阅读过 Ayende 的“[在 Boo 中构建特定领域的语言](http://www.manning.com/rahien/)”？它尚未完全发布，但您可以获得早期访问版本。

我还没有时间仔细研究 Boo，但与 C# 3（获得 Boo 的一些特性）相比的*主要*优势似乎是简洁（大量类型推断）和元编程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-17T21:24:20.933

Boo 是非常强大的 DSL 创建工具（外部和内部）

可以使用宏、元方法和可扩展的编译器管道创建内部 DSL。Boo 语言的扩展 - Boo.OMeta.Parser 可用于创建外部 DSL。

目前解析器正在开发中，但它已经可以用于创建复杂的外部 DSL。OMeta 是一个强大的工具，它使程序员能够轻松地实现词法分析器和解析器。Boo 的可扩展编译器管道架构允许用 Boo.OMeta.Parser 替换标准的 Boo.Parser。它可以用几乎任何一种语法来扩展 Boo 语法。该示例可以在[此处](http://rulezzz.org/post/2011/05/05/How-to-compile-Shakespeare.aspx)找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-23T13:57:08.197

一些真正符合 Boo 动态思维的用法：

*   [盲文](http://www.castleproject.org/monorail/documentation/trunk/viewengines/brail/index.html)视图引擎
*   [使用Spectre](http://specter.sourceforge.net/)的 BDD
*   [将 Boo 嵌入到您的 nant 脚本](http://boo.codehaus.org/Nant+Scripting+Language)中，或者甚至从头开始[构建构建系统](http://code.google.com/p/boo-build-system/)
*   [嵌入“外壳”以与实时 Web 应用程序交互](http://bugsquash.blogspot.com/2009/12/boo-web-console.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T20:23:28.093

我正在与 Boo 合作一个辅助项目，以实现声明性数据绑定宏。语言很酷！它给了我一些我没有的编译器构造经验。

只是为了好玩，我正在 Ubuntu 8.10 上的 Mono 上使用 Boo。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T21:19:42.313

你应该看看 Boo 的一些有趣的[语言特性](http://boo.codehaus.org/Language+Features)。

# sql - 什么是“多部分标识符”，为什么不能绑定？

> ID：206558
> 
> 赞同：156
> 
> 时间：2008-10-15T21:21:59.610
> 
> 标签：sql, sql-server

当我尝试基于另一个表更新表时，我不断收到这些错误。我最终重写了查询，更改了连接的顺序，更改了一些分组，然后它最终可以工作，但我只是不太明白。

什么是“多部分标识符”？
何时无法绑定“多部分标识符”？
它到底要绑定什么？
在什么情况下会出现这个错误？
预防它的最佳方法是什么？

SQL Server 2005 的具体错误是：

> 无法绑定多部分标识符“...”。

这是一个例子：

```
UPDATE  [test].[dbo].[CompanyDetail]

SET Mnemonic = [dbBWKMigration].[dbo].[Company].[MNEMONIC], 
               [Company Code] = [dbBWKMigration].[dbo].[Company].[COMPANYCODE]

WHERE [Company Name] = **[dbBWKMigration].[dbo].[Company].[COMPANYNAME]** 
```

实际错误：

> 消息 4104，级别 16，状态 1，行 3 无法绑定多部分标识符“dbBWKMigration.dbo.Company.COMPANYNAME”。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2008-10-15T21:48:47.933

多部分标识符是包含多个部分的字段或表的任何描述 - 例如 MyTable.SomeRow - 如果它无法绑定，则意味着它有问题 - 要么你有一个简单的错字，要么之间的混淆表和列。这也可能是由于在表或字段名称中使用保留字而不用 [] 将它们括起来引起的。它也可能是由于目标表中未包含所有必需的列而导致的。

像[redgate sql prompt](http://www.red-gate.com/products/SQL_Prompt/index.htm)这样的东西非常适合避免手动输入这些内容（它甚至可以根据外键自动完成连接），但不是免费的。SQL server 2008 支持开箱即用的智能感知，尽管它不如 redgate 版本那么完整。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2011-06-20T15:58:21.343

实际上，有时当您从另一个表的数据更新一个表时，我认为导致此错误的常见问题之一是您错误地使用表缩写*或不需要它们时*。正确的说法如下：

```
Update Table1
Set SomeField = t2.SomeFieldValue 
From Table1 t1 
Inner Join Table2 as t2
    On t1.ID = t2.ID 
```

请注意，**Table1****`SomeField`**中的列没有限定符 as but is just 。 **`t1`**`t1.SomeField`**`SomeField`**

 **如果尝试通过指定**`t1.SomeField`**语句来更新它，将返回您注意到的多部分错误。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-15T21:57:05.780

这可能是一个错字。在代码中查找调用 [schema].[TableName] 的位置（基本上是引用字段的任何位置）并确保所有内容都拼写正确。

就个人而言，我试图通过为所有表使用别名来避免这种情况。当您可以将长表名缩短为它的描述的首字母缩写词（即 WorkOrderParts -> WOP）时，它会大有帮助，并且还会使您的查询更具可读性。

编辑：作为额外的奖励，当您只需键入三个或四个字母的别名与架构、表和字段名称一起时，您将节省大量的击键。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-15T21:29:29.487

绑定 = 特定列的文本表示被映射到某个表、某个数据库、某个服务器上的某个物理列。

多部分标识符可以是：MyDatabase.dbo.MyTable。如果您将这些标识符中的任何一个弄错了，那么您就有一个无法映射的多部分标识符。

避免这种情况的最好方法是第一次编写正确的查询，或者使用提供智能感知的管理工作室插件，从而通过避免拼写错误来帮助您。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T21:51:58.160

你可能有一个错字。例如，如果您在名为 Sales 的数据库中有一个名为 Customer 的表，您可以将其称为 Sales..Customer（尽管最好将其包括所有者名称（dbo 是默认所有者），如 Sales.dbo 。顾客。

如果您键入 Sales...Customer，您可能已经收到了您收到的消息。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-05-26T17:59:51.073

当我尝试缩写时，我发现我得到了很多，例如：

```
Table1 t1, Table2 t2 
where t1.ID = t2.ID 
```

将其更改为：

```
Table1, Table2 
where Table1.ID = Table2.ID 
```

使查询工作而不抛出错误。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-15T22:02:30.293

如果您确定这不是拼写错误，则可能是拼写错误。

你使用什么排序规则？核实。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-20T00:48:03.860

更新表时，请确保您没有通过别名引用您更新的字段。

我刚刚遇到以下代码的错误

```
update [page] 
set p.pagestatusid = 1
from [page] p
join seed s on s.seedid = p.seedid
where s.providercode = 'agd'
and p.pagestatusid = 0 
```

我必须删除 set 语句中的别名引用，所以它看起来像这样

```
update [page] 
set pagestatusid = 1
from [page] p
join seed s on s.seedid = p.seedid
where s.providercode = 'agd'
and p.pagestatusid = 0 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-12-15T14:35:23.960

我遇到了这个问题，结果证明是一个不正确的表别名。纠正这个问题解决了这个问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-02-15T20:14:54.137

我的错误地将架构放在表 Alias 上：

```
SELECT * FROM schema.CustomerOrders co
WHERE schema.co.ID = 1  -- oops! 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-11-22T22:56:45.323

在我的情况下，在前面的 Set 字段中添加表别名会导致此问题。

**对**

```
Update Table1
Set SomeField = t2.SomeFieldValue 
From Table1 t1 
Inner Join Table2 as t2
    On t1.ID = t2.ID 
```

**错误的**

```
Update Table1
Set t1.SomeField = t2.SomeFieldValue 
From Table1 t1 
Inner Join Table2 as t2
    On t1.ID = t2.ID 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-26T17:19:04.970

我有`P.PayeeName AS 'Payer' --,` 两个注释行抛出了这个错误

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-09-04T23:17:45.600

我实际上忘记将表格加入其他人，这就是我收到错误的原因

应该是这样的：

```
 CREATE VIEW reserved_passangers AS
  SELECT dbo.Passenger.PassName, dbo.Passenger.Address1, dbo.Passenger.Phone
  FROM dbo.Passenger, dbo.Reservation, dbo.Flight
  WHERE (dbo.Passenger.PassNum = dbo.Reservation.PassNum) and
  (dbo.Reservation.Flightdate = 'January 15 2004' and Flight.FlightNum =562) 
```

而不是这样：

```
 CREATE VIEW reserved_passangers AS
  SELECT dbo.Passenger.PassName, dbo.Passenger.Address1, dbo.Passenger.Phone
  FROM dbo.Passenger, dbo.Reservation
  WHERE (dbo.Passenger.PassNum = dbo.Reservation.PassNum) and
  (dbo.Reservation.Flightdate = 'January 15 2004' and Flight.FlightNum = 562) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-01-17T06:33:46.373

**错误代码**

```
FROM                
    dbo.Category C LEFT OUTER JOIN           
    dbo.SubCategory SC ON C.categoryID = SC.CategoryID AND C.IsActive = 'True' LEFT OUTER JOIN          
    dbo.Module M ON SC.subCategoryID = M.subCategoryID AND SC.IsActive = 'True' LEFT OUTER JOIN          
    dbo.SubModule SM ON M.ModuleID = SM.ModuleID AND M.IsActive = 'True' AND SM.IsActive = 'True' LEFT OUTER JOIN 
    dbo.trainer ON dbo.trainer.TopicID =dbo.SubModule.subModuleID 
```

**解决方案代码**

```
 FROM                
    dbo.Category C LEFT OUTER JOIN           
    dbo.SubCategory SC ON C.categoryID = SC.CategoryID AND C.IsActive = 'True' LEFT OUTER JOIN          
    dbo.Module M ON SC.subCategoryID = M.subCategoryID AND SC.IsActive = 'True' LEFT OUTER JOIN          
    dbo.SubModule SM ON M.ModuleID = SM.ModuleID AND M.IsActive = 'True' AND SM.IsActive = 'True' LEFT OUTER JOIN 
    dbo.trainer ON dbo.trainer.TopicID = SM.subModuleID 
```

如您所见，在错误代码中，`dbo.SubModule`已定义为 SM，但我`dbo.SubModule`在下一行使用，因此出现错误。使用声明的名称而不是实际名称。问题解决了。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-03-09T19:40:27.663

当出现错误时，我最好的建议是使用 [] 括号来围绕表名，表的缩写有时会导致错误，（有时表的缩写可以正常工作......奇怪）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-02-05T14:52:46.410

我收到了这个错误，只是看不到问题出在哪里。我仔细检查了我所有的别名和语法，没有任何不妥之处。该查询与我一直编写的查询相似。

我决定重新编写下面的查询（我最初是从报告 .rdl 文件中复制的），然后运行良好。现在查看查询，它们在我看来是一样的，但我重新编写的一个有效。

只是想说，如果没有其他方法，它可能值得一试。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-03-10T23:13:08.690

当您键入 FROM 表时，这些错误将消失。在您键入的内容下方键入 FROM，然后 Intellisense 将起作用，多部分标识符将起作用。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-02-11T05:34:42.743

我遇到了这个问题并解决了它，但是您和我的代码之间存在差异。尽管我认为您可以理解什么是“无法绑定多部分标识符”

当我使用此代码时

```
 select * from tbTest where email = sakira@gmail.com 
```

我遇到了多部分标识符问题

但是当我对电子邮件地址使用单引号时它解决了

```
 select * from tbTest where email = 'sakira@gmail.com' 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-06-09T09:19:55.100

我遇到了完全相同的问题，与您的编码类似，我错过了**FROM**字段，一旦添加，查询就知道从哪个表读取数据

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-07-07T19:46:22.403

在 SUBSTRING 方法中删除方括号后，我的工作。我从

> **SUBSTRING([dbo.table].[column],15,2)**

到

> **SUBSTRING(dbo.table.column,15,2)**

# .net - .NET 中的 TCP 连接质量

> ID：206560
> 
> 赞同：3
> 
> 时间：2008-10-15T21:22:22.137
> 
> 标签：.net, sockets, tcp

我有一个关键任务实时数据应用程序，它在客户端和服务器之间使用 TCP 连接。在某些情况下，连接会定期终止（SocketException）。没问题 - 只需重新连接并继续。但是，客户对这些断断续续的连接性下降并不感到兴奋。

我想知道手指在哪里。是客户端还是服务器？硬件还是软件？与以太网链接有关吗？最终结果将是向用户显示连接健康状况的指标，以便可以调查和修复不良链接。

**我可以从 TcpClient、Socket 或其他任何可以告诉我连接健康状况的指标中提取任何指标吗？**也许平均确认时间，重试次数等？

我特别想了解 TCP 连接 - 不仅仅是整个以太网连接（您的 LAN 连接可能很花哨，但到外部服务器可能会出现问题）。

当然，我可以 ping 远程主机，但我认为这不会真正给我我正在寻找的那种统计数据。一方面，如果服务器隐藏在 NAT 后面，我可能会 ping 路由器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T22:46:03.620

首先，您应该检查您获得的 SocketExceptions 的详细信息。我不知道它们在 .Net 中包含什么，但在 Java 中，详细消息提供了有用的提示，例如“连接已被对等方关闭”或“连接重置”。

根据我的经验，套接字连接被丢弃的一个常见原因是代码中的一个错误，其中读取超时异常由与所有其他与连接相关的异常相同的 catch 子句处理，因此通常导致连接无缘无故地关闭.

在企业设置中，关闭长期 TCP 连接的典型原因是防火墙设备在没有流量的情况下关闭 TCP 连接，例如 10 分钟后，或者在连接时间达到 30 分钟后关闭连接，而不管流量如何. 一般来说，最好假设这些事情会发生，并准备好优雅地重新建立连接。

一个好的方法是查看连接关闭器中是否存在模式。例如，它们是定期关闭，还是在一段时间没有活动后关闭。您还可以运行数据包嗅探器以查看哪一方启动连接关闭或发送 RST 数据包以及原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T21:49:31.693

Perfmon 是你的朋友，为所有 IP、TCP 和网络计数器运行日志。如果您可以判断连接何时终止，您可以查看图表以查看是否有任何问题 - 网络错误、无传输、无 IO 字节传输等。

还添加一些 .NET 计数器，例如 GC、内存和 CPU 使用率。

您可以做的最后一件事是增加 TCP 超时和其他设置。他们[在注册表中](http://support.microsoft.com/?id=120642)

如果远程服务器确实有问题，您将必须监视两端，但首先要查看计数器，看看是否有任何东西跳出来。

# c++ - 在 C++ 中转换为 bool 对性能有何影响？

> ID：206564
> 
> 赞同：49
> 
> 时间：2008-10-15T21:24:08.403
> 
> 标签：c++, visual-c++

*[[此问题与此](https://stackoverflow.com/questions/206106/is-a-safe-way-to-convert-to-bool-in-c)问题相关但不同。]*

我的编译器警告将某些类型隐式转换或强制转换为 bool，而显式转换不会产生警告：

```
long t = 0;
bool b = false;
b = t;                    // performance warning: forcing long to bool
b = (bool)t;              // performance warning
b = bool(t);              // performance warning
b = static_cast<bool>(t); // performance warning
b = t ? true : false;     // ok, no warning
b = t != 0;               // ok
b = !!t;                  // ok 
```

这适用于 Visual C++ 2008，但我怀疑其他编译器可能有类似的警告。

所以我的问题是：转换/转换为的性能影响是什么`bool`？在某些情况下（例如，对于某些目标架构或处理器），显式转换是否具有更好的性能？隐式转换是否会以某种方式混淆优化器？

微软对其警告的[解释](http://msdn.microsoft.com/en-us/library/b6801kcy.aspx)并不是特别有帮助。他们暗示有一个很好的理由，但他们没有解释。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-15T21:46:55.067

我对这种行为感到困惑，直到我找到了这个链接：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=99633](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=99633)

显然，来自“拥有”此警告的 Microsoft 开发人员：

> *这个警告非常有用，昨天在我的代码中发现了一个错误。我认为马丁正在断章取意地使用“性能警告”。*
> 
> **这与生成的代码无关，而与程序员是否已发出将值从 int 更改为 bool 的意图有关**。这样做是有代价的，用户可以选择一致地使用“int”而不是“bool”（或者反之亦然）以避免“boolifying”代码生成。[...]
> 
> ***这是一个古老的警告，可能已经超过了它的目的，但它的行为就像这里设计的那样。***

所以在我看来，警告更多的是关于风格和避免一些错误而不是其他任何事情。

希望这能回答你的问题...

:-p

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-15T21:26:55.840

性能在所有方面都是相同的。它涉及 x86 上的几条指令，在其他一些架构上可能是 3 条。

在 x86 / VC++ 上，它们都可以

```
cmp DWORD PTR [whatever], 0
setne al 
```

GCC 生成相同的东西，但没有警告（在任何警告级别）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T21:44:29.720

性能警告确实有点意义。我也遇到过，我的好奇心使我用反汇编程序进行调查。它试图告诉您编译器必须生成一些代码来将值强制为 0 或 1。因为您坚持使用布尔值，所以不适用 0 或其他任何东西的老式 C 思想。

如果您真的愿意，您可以避免这种微小的性能损失。最好的方法是完全避免强制转换并从一开始就使用布尔值。如果你必须有一个 int，你可以只使用 if(int) 而不是 if(bool)。生成的代码将简单地检查 int 是否为 0。如果值不是 0，则不会生成额外的代码来确保值为 1。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-15T21:28:07.443

据我所知，没有任何其他编译器对此发出警告。我认为这会导致性能损失的唯一方法是编译器必须将整个整数与 0 进行比较，然后适当地分配 bool（与 char 到 bool 之类的转换不同，其中可以复制结果，因为bool 是一个字节，因此它们实际上是相同的），或者涉及将部分或全部源复制到目标的整数转换，如果它大于源（就内存而言），可能在目标的零之后.

这是微软关于什么是好的代码的又一个无用和无用的想法，并导致我们不得不忍受这样的愚蠢定义：

```
template <typename T>
inline bool to_bool (const T& t)
  { return t ? true : false; } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-15T21:28:53.153

对我来说听起来像是过早的优化。您是否期望演员表的性能会严重影响您的应用程序的性能？也许如果您正在编写内核代码或设备驱动程序，但在大多数情况下，它们都应该没问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-30T15:41:35.950

```
long t;
bool b;
int i;
signed char c;
... 
```

如果 bool 不需要为 0 或 1，则当您执行任何“免费”的操作时，您会收到警告。 b = !!t 有效地分配了 (language built-in, non-overrideable) 的结果`bool operator!(long)`

你不应该期待！或 != 运算符即使使用优化编译器也会花费零 asm 指令。通常情况下，int i = t 通常会被完全优化掉。甚至有符号 char c = t; （在 x86/amd64 上，如果 t 在 %eax 寄存器中，在 c = t 之后，使用 c 仅意味着使用 %al。amd64 对每个寄存器都有字节寻址，顺便说一句。IIRC，在 x86 中，某些寄存器没有字节寻址.)

无论如何，;`b = t; i = b`; isn't the same as `c = t; i = c;` it's i = !!t;` instead of i = t & 0xff`

呃，我想每个人都已经从之前的回复中知道了这一切。我的意思是，警告对我来说是有意义的，因为它捕获了编译器必须做你没有真正告诉它的事情的情况，比如 !!BOOL 在返回时，因为你声明了函数 bool，但返回的是一个整数值这可能是真的并且！= 1。例如，很多 Windows 的东西返回 BOOL (int)。

这是 MSVC 为数不多的 G++ 没有的警告之一。我更习惯于 g++，它肯定会警告 MSVC 没有的东西，但我很高兴它告诉了我。我为我使用的 MFC/Win32 类/宏/函数编写了一个带有存根的 portab.h 头文件。这让我正在开发的 MFC 应用程序可以在我的 GNU/Linux 机器上编译（并使用 cygwin）。我主要希望能够编译测试我在家里工作的内容，但我最终发现 g++ 的警告非常有用。它对例如模板也更加严格......

一般来说，在 bool 上，我不确定它在用作返回值和参数传递时会产生更好的代码。即使对于本地人，g++ 4.3 似乎也没有弄清楚它不必在分支之前将值强制为 0 或 1。如果它是一个局部变量并且你从不获取它的地址，编译器应该将它保持在最快的任何大小。如果它必须将它从寄存器溢出到堆栈，它也可以将它保持在 4 个字节中，因为这可能会稍微快一些。（它在加载/存储（非本地）布尔值时使用了很多 movsx（符号扩展）指令，但我真的不记得它对自动（本地堆栈）变量做了什么。我记得看到它保留了一个奇怪的具有一些 bools 局部变量的函数中的堆栈空间量（不是 4 的倍数。）

截至去年，在 Digital Mars D 编译器中使用 bool 标志比 int 慢： [http](http://www.digitalmars.com/d/archives/digitalmars/D/opEquals_needs_to_return_bool_71813.html) ://www.digitalmars.com/d/archives/digitalmars/D/opEquals_needs_to_return_bool_71813.html （D 很像 C++，但放弃了完整的C 向后兼容以定义一些不错的新语义，以及对模板元编程的良好支持。例如，“静态 if”或“静态断言”而不是模板黑客或 cpp 宏。我真的很想在某个时候给 D 一个尝试。:)

对于数据结构，这可能是有意义的，例如，如果您想在 int 之前打包几个标志，然后在结构中打包一些双精度值，那么您将拥有很多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T21:28:26.960

根据您对 MS 解释的链接，如果该值*仅为*1 或 0，则不会影响性能，但如果是*其他*任何非 0 值，则必须在编译时进行比较？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T21:36:30.907

在 C++ 中，只有两个值 0 = false、1 = true 的 bool ISA int。编译器只需要检查一位。非常清楚，true != 0，所以任何 int 都可以覆盖 bool，这样做只需要花费处理周期。

通过在代码示例中使用 long as，您将强制执行更多位检查，这将导致性能下降。

不，这不是过早的优化，使用需要更多处理时间的代码是非常疯狂的。这只是一个很好的编码习惯。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T21:41:37.403

除非您正在为**非常**关键的内部循环（模拟器核心、光线追踪器等）编写代码，否则在这种情况下担心任何性能损失是没有意义的。您的代码中还有其他更重要的事情需要担心（我敢肯定，还有其他更重要的性能陷阱潜伏着）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-15T21:44:42.263

微软的解释似乎是他们想说的是：

> 嘿，如果您使用的是 int，但只在其中存储真假信息，请将其设为 bool！

我对性能方面会获得多少持怀疑态度，但 MS 可能已经发现有一些收益（无论如何都是为了他们的使用）。微软的代码确实经常运行，所以也许他们发现微优化是值得的。我相信 MS 编译器中有相当一部分是为了支持他们认为自己有用的东西（只有意义，对吧？）。

你摆脱了一些肮脏的小演员阵容。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-15T21:29:15.697

我不认为性能是这里的问题。您收到警告的原因是信息在从 int 转换为 bool 的过程中丢失。

# objective-c - 为了优化目的，我如何分析一段代码在 Objective-C/Cocoa 中执行的时间

> ID：206574
> 
> 赞同：1
> 
> 时间：2008-10-15T21:27:46.087
> 
> 标签：objective-c, cocoa, optimization

假设我有两段可互换的代码，我想弄清楚其中哪一段需要更少的处理器时间来执行。我该怎么做？

为了得到一个非常粗略的估计，我可以将 NSLog() 调用放在我想要分析的代码的任一侧，但看起来处理器在其他方面非常繁忙可能​​会扭曲结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T21:58:22.593

除非这两段代码之一已经在您的应用程序中，**并且**您已经分析了应用程序的整体性能以确定现有代码是一个主要瓶颈，否则您所做的就是所谓的“过早优化”。

Xcode 包含一个出色的[分析器](http://en.wikipedia.org/wiki/Performance_analysis)工具，称为“ [Shark](http://developer.apple.com/documentation/DeveloperTools/Conceptual/SharkUserGuide/Introduction/chapter_1_section_1.html) ”。对于某些版本，可以在 /Developer/Applications 中找到它；对于其他人，它位于“性能工具”子目录中。

Shark 会准确地告诉您应用程序在代码的每个部分中花费了多少时间（占总执行时间的百分比）。使用像 Shark 这样的工具的想法是遵循“80/20 规则”——你的应用程序将花费 80% 的时间运行 20% 的代码，因此为了获得最佳结果，你应该花费 80% 的**时间**来优化它相同的 20%。

因此，要直接回答您的问题，假设您**已经**运行了 Shark，并且您希望优化最顶层的瓶颈，只需将其替换为您优化的代码并再次在 Shark 下运行您的应用程序。然后，比较在替换代码中花费的总时间与原始代码的百分比。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T09:52:21.280

哇鲨鱼，耶。另请参阅[鲨鱼遥控器](http://developer.apple.com/documentation/developertools/Conceptual/SharkUserGuide/SelectingExecutiontoSampleorTrace/chapter_6_section_8.html)。基本上，`Sampling > Programmatic (Remote)`从 Shark 的菜单中选择，然后调用 chudStartRemotePerfMonitor 和 chudStopRemotePerfMonitor() 括住您要分析的特定代码。

除此之外，这是我为计时而保留的一大段代码。

先说用法

```
uint64_t startTime, stopTime;
startTime = mach_absolute_time();

< work to time goes here >

stopTime = mach_absolute_time();
logMachTime_withIdentifier_(stopTime - startTime, @"10000000 class messages"); 
```

这是辅助函数，`logMachTime_withIdentifier_`.

```
#import <mach/mach_time.h>
void logMachTime_withIdentifier_(uint64_t machTime, NSString *identifier) {
    static double timeScaleSeconds = 0.0;
    if (timeScaleSeconds == 0.0) {
        mach_timebase_info_data_t timebaseInfo;
        if (mach_timebase_info(&timebaseInfo) == KERN_SUCCESS) {    // returns scale factor for ns
            double timeScaleMicroSeconds = ((double) timebaseInfo.numer / (double) timebaseInfo.denom) / 1000;
            timeScaleSeconds = timeScaleMicroSeconds / 1000000;
        }
    }

    NSLog(@"%@: %g seconds", identifier, timeScaleSeconds*machTime);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T17:43:27.570

假设您想要分析整个应用程序（而不仅仅是一段代码），并且您的应用程序是用 C/C++/Objective-C（而不是例如 Ruby）编写的，并且您使用的是 Xcode 3.0 或更高版本，那么您还应该检查 Instruments 应用程序。“Sampler”工具将为您提供与 Shark 非常相似的信息（尽管没有 Shark 有时对提高性能*非常*有用的提示）。此外，您可以跟踪其他资源利用率（GC、Core Data、网络、磁盘 I/O 等），这些资源利用率可能比代码效率更重要（同样取决于应用程序）。Instruments 还可以利用 OS X 10.5 中的 DTrace 支持（`man dtrace`）。您可以使用 DTrace 编写自己的工具来更具体地监控您的应用程序（例如调用一个或多个方法）。

正如您所怀疑的那样，使用`NSLog`是一个坏主意，因为它可能会使用 Apple System Logging 系统。将日志写入 asl 并显示在控制台中存在不确定的延迟。我不确定时间戳何时设置。

# sql-server - VB6 支持 SQL SMO 和 .Net 2.0

> ID：206577
> 
> 赞同：1
> 
> 时间：2008-10-15T21:28:23.637
> 
> 标签：sql-server, vb6, .net-2.0, smo, sqldmo

我们正在尝试在基于 COM+ 的应用程序中从使用 SQL DMO 转移到 SMO，因为我们正在放弃对 SQL Server 2000 的支持，并在 SQL Server 2005 之外添加对 SQL Server 2008 的支持。

我一直在阅读这方面的内容，并在[这个微软论坛上找到了这个特别的俏皮话：](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=289491&SiteID=1)

> “SMO 仅在 VB/C#.Net 2005 中受支持。它需要 .Net 2.0 框架，而 VB/VC 6 中不可用。”

这是真的吗？一般谷歌搜索和谷歌搜索stackoverflow没有抛出和明确的答案。

是否可以使用 VB6 实现 SQL SMO？

**编辑：我使用了 COM Wrapper 来解决这个问题......查看下面的答案以获取更多详细信息。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T21:46:08.373

好的，我想出了如何做到这一点。

问题是 VB6 不支持 .Net 2.0，因此我们不能将 SMO 与 VB6 一起使用。

为了解决这个问题，我用 C# 编写了一个 COM 包装器，它使用 SMO 并（主要）一对一地映射我想要从我的 VB 应用程序中获得的那种功能。

基本上，创建一个 C# 项目，根据需要添加 SMO 引用，在类声明上方添加以下行以使其 COM 可见：

```
[ComVisible(true)]

[GuidAttribute("{guid here}")]

[ClassInterface(ClassInterfaceType.AutoDual)] // <--- Not recommended, but well... 
```

在项目属性的“构建”部分中，确保选中“注册 COM 互操作”框。编译并导入到 VB6 应用程序中，您就可以开始营业了！！

与尝试将任何两个不同的系统组合在一起的情况一样，您需要对在 VB6 应用程序和 C# Wrapper 之间传递的内容进行一些操作......但这并不难。

如果您需要更多信息/详细信息，请发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T00:53:09.497

我不知道您可以通过 VB6 访问 SMO 的方法。我同意 G Mastros 关于使用 COM/Interop 方法直接实现 .NET 代码的观点。

要考虑的替代方法是您可以使用 Powershell，执行一个脚本来完成您的 .NET SMO 工作。您仍然有需要 .NET 框架（显然还有 Powershell）的先决条件，但它可以完成工作。您的脚本可以采用凭据、数据库名称、备份类型等参数。

我在拥有 SQL Express（没有用于备份的 SQL 代理，如 MSDE）的客户端上实现了很多。我连接了一个计划任务，它调用脚本并管理他们的备份。

如果有帮助，这里有一个脚本——大部分是被盗的，但我对其进行了一些修改：

```
param (
  [string] $ServerName,
  [string] $DatabaseName,
  [string] $Backuptype,
  [string] $BackupPath,
  [int] $NumDays
)
Get-ChildItem $BackupPath | where {$_.LastWriteTime -le (Get-Date).AddDays(-$NumDays)} | remove-item
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.Smo") | out-null
[System.IO.Directory]::CreateDirectory($BackupPath) | out-null
$srv=New-Object "Microsoft.SqlServer.Management.Smo.Server" "$servername"
$bck=new-object "Microsoft.SqlServer.Management.Smo.Backup"

if ($Backuptype -eq "FULL") 
{
$bck.Action = 'Database' 
$extenstion=".BAK" 
$text1="Full Backup"
}

if ($Backuptype -eq "TRAN") 
{
$bck.Action = 'Log' 
$bck.LogTruncation = 2
$extenstion=".TRN" 
$text1="Transactional Log Backup"
}

if ($Backuptype -eq "DIFF") 
{ 
$bck.Incremental = 1 
$extenstion=".DIFF"  
$text1="Differential Backup"
}

$fil=new-object "Microsoft.SqlServer.Management.Smo.BackupDeviceItem"
$fil.DeviceType='File'
$fil.Name=[System.IO.Path]::Combine($BackupPath, $DatabaseName+ "_"+ [DateTime]::Now.ToString("yyyy_MM_dd_HH_mm")+$extenstion)
$bck.Devices.Add($fil)
$bck.Database=$DatabaseName
$bck.SqlBackup($srv)
write-host $text1 of $Databasename done 
```

它可以进行完整备份、差异备份和事务备份，并根据日期和时间对每个生成的文件进行唯一命名，删除超过一定天数的所有文件。

调用它的语法是：

```
.\Backup.ps1 INSTANCENAME DATABASENAME FULL|TRAN|DIFF PATH DAYSTOKEEP 
```

所以...

```
.\Backup.ps1 SQLEXPRESS Northwind FULL C:\TempHold\Test 30
.\Backup.ps1 SQLEXPRESS Northwind TRAN C:\TempHold\Test 30
.\Backup.ps1 SQLEXPRESS Northwind DIFF C:\TempHold\Test 30 
```

要在任务计划程序中进行计划，请传入：

```
powershell c:\temphold\test\backup.ps1 "SQLEXPRESS Northwind DIFF C:\TempHold\Test 30" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T17:44:55.833

谢谢你的帖子。它帮助我了解有一个使用 COM Wrapper 从 VB6 使用 SQLSMO 的解决方案。我按照您详细说明的步骤进行操作，但我的解决方案不起作用。我基本上是这样做的：

```
using System;
using System.Collections.Generic; 
```

使用 System.Text；使用 System.Runtime.InteropServices；命名空间 WrapperCOM {

```
[System.Runtime.InteropServices.ComVisible(true)]

[GuidAttribute("1d93750c-7465-4a3e-88d1-5e538afe7145")]

[ClassInterface(ClassInterfaceType.AutoDual)]
public class Class1
{
    public Class1() { }
} 
```

}

我还为 SQLSMO 添加了以下参考：

•Microsoft.SqlServer.ConnectionInfo.dll

•Microsoft.SqlServer.Smo.dll

•Microsoft.SqlServer.Management.Sdk.Sfc.dll

•Microsoft.SqlServer.SqlEnum.dll

最后，当我在导入 .tlb 文件并创建这样的对象后运行 VB6 - CreateObject("COMWrapper.Class1") 时，它失败了。它给出“运行时错误...”

请告知我在这里缺少什么...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-15T21:41:43.703

我还没有尝试过，但您可能可以编写 vb.net 代码来与 SQL SMO 交互，然后为 vb.net 代码编写一个 com 包装器。当然，您仍然需要 .net 框架才能使用它。

相反，我建议您从 SQL DMO 和 SQL SMO 迁移。您对 DMO 或 SMO 所做的任何事情都可以在没有它的情况下完成。当然，这并不容易，但在谷歌上搜索替换代码（使用直接 T-SQL 而不是 SQL DMO）将为您提供所需的答案。

# winforms - 是否应将“取消”按钮用作 Windows 窗体上的“关闭”按钮？

> ID：206594
> 
> 赞同：3
> 
> 时间：2008-10-15T21:35:04.857
> 
> 标签：winforms

三个按钮，保存、取消、关闭看起来很乱，但用户保存数据后，他们真的应该点击取消按钮吗？

我需要“保存”按钮才能使表单保持打开状态。

什么是最佳实践？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T21:38:51.200

Windows 上的标准是 OK 和 Cancel。OK 按钮将保存并关闭屏幕。取消按钮将关闭并丢失更改。如果他们想定期保存更​​改，请添加一个应用按钮。这将保存并继续而不关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:38:15.270

您应该有“确定”、“应用”和“取消”按钮。OK 按钮保存表单并关闭它。应用只是保存并保持表单打开。而且，取消只是关闭按钮，忽略所有更改。Windows 中的大多数对话框都是这样做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T21:39:04.223

一般Windows使用OK/Cancel/Apply系统；例如，查看显示属性。使用用户熟悉的东西绝不是一个坏主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T21:40:35.733

如果表单上的数据不是“脏”的，您可以有一个保存按钮和一个取消按钮，其文本更改为关闭。我在其他程序中看到过这种行为。这使得 UI 更小，只有 2 个按钮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T21:42:24.700

该按钮可以根据其显示的上下文进行标记。

例如，如果包含按钮的对话框旨在执行特定操作，如“新用户向导”，则应将其标记为**Cancel**。

但是，对于主应用程序窗口或其他通用窗口，应将其标记为**Close**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-17T08:00:57.213

对此有标准约定吗？

通过查看显示属性对话框，应用按钮位于右侧，如下所示：

[确定] [取消] [申请]

所有这些按钮都固定在右侧。我已经看到这些按钮有很多不同的顺序，以至于很难知道标准是什么（如果有的话）。

上面的 [ Cancel ] 或 [ Close ] 评论是合乎逻辑的。取消以终止/回滚进程，或关闭以关闭对话框并保留应用更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T21:39:44.783

如果用户不想保存信息怎么办？表单是回滚更改以再次显示，还是关闭？如果表单需要立即关闭，那么请务必丢弃取消按钮。如果还有其他事情可能需要发生，那么您可能希望保留它。

# asp.net - asp.net 中的 IE6 回发

> ID：206595
> 
> 赞同：1
> 
> 时间：2008-10-15T21:35:19.740
> 
> 标签：asp.net, internet-explorer-6

我有一个页面，其中包含一个用户控件，它只是一个个性化的下拉列表。我为每个项目分配了属性`onClick=__doPostBack('actrl',0)`。

当我单击页面回发罚款时，我得到了预期的结果。但是在 IE6 中，我的页面不会更改为从服务器加载的新值。

奇怪的是，当我 shift + 单击链接时，页面重新加载所有更改都很好。

我试图禁用页面上的缓存，但没有运气。

使用所有这些代码

```
Response.CacheControl = "no-cache"
Response.AddHeader("Pragma", "no-cache")
Response.Expires = -1
Response.Cache.SetExpires(DateTime.UtcNow.AddMinutes(-1))
Response.Cache.SetCacheability(HttpCacheability.NoCache)
Page.Response.Cache.SetExpires(DateTime.Now.AddDays(-30))
Page.Response.Cache.SetCacheability(HttpCacheability.NoCache)
Page.Response.Cache.SetNoServerCaching()
Page.Response.Cache.SetNoStore()
Response.Cache.SetNoStore() 
```

此外，当我调试应用程序时，我可以看到要渲染的生成的 html 是正确的，但它没有被渲染。

这个问题只发生在 IE6 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T02:48:53.070

这是一个已知的 IE6 错误 (#223)，带有神奇的 HTTP 获取请求。

在此处查看错误： [http ://webbugtrack.blogspot.com/2007/09/bug-223-magical-http-get-requests-in.html](http://webbugtrack.blogspot.com/2007/09/bug-223-magical-http-get-requests-in.html)

当内联事件处理程序导致 IE6 中的页面更改时，就会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T21:37:49.563

问题是 IE6 没有从服务器重新加载页面（它只是抓取缓存的副本），但是在 IE6 后的表单上应该重新加载。为什么要添加 _doPostBack 作为属性，这些应该在任何需要回发的 asp.net 控件上自动生成。

# visual-c++ - Vista 中 CEdit 中的 SetLimitText() 不起作用

> ID：206600
> 
> 赞同：6
> 
> 时间：2008-10-15T21:37:22.123
> 
> 标签：visual-c++, mfc, windows-vista

这发生在 Vista 上。我创建了一个新的基于对话框的 MFC 项目来测试它。我在对话框中添加了一个 CEdit 控件。我调用 SetLimitText 让我的 CEdit 接收 100000 个字符。我都试过了：

```
this->m_cedit1.SetLimitText(100000);
UpdateData(FALSE); 
```

和

```
static_cast<CEdit*>(GetDlgItem(IDC_EDIT1))->LimitText(100000); 
```

我将这些调用放在 InitDialog 上。

在我将 5461 个字符粘贴到我的 CEdit 后，它变为空且无响应。关于导致此问题的任何想法和解决方法能够将长文本字符串粘贴到 CEdit 或任何其他控件中？

注意：5461 是二进制的 0x1555 或 1010101010101，我觉得这很奇怪。

如果我粘贴 5460 个字符，我没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T19:59:22.343

我联系了微软支持。

目标是在一个可编辑的文本行中包含大约 240000 个字符。

我能够在 Windows Vista（x64 和 x32）上重现该问题，但 *不能*在 Windows XP 上重现。

此代码在 XP 中运行良好：

```
 BOOL ClongeditXPDlg::OnInitDialog()
 {
     CDialog::OnInitDialog();

     // Set the icon for this dialog.  The framework does this automatically
     //  when the application's main window is not a dialog
     SetIcon(m_hIcon, TRUE);            // Set big icon
     SetIcon(m_hIcon, FALSE);        // Set small icon

     // TODO: Add extra initialization here
     UINT limit = m_longEdit.GetLimitText();
     m_longEdit.SetLimitText(240000);
     UINT limit2 = m_longEdit.GetLimitText();

     CString str;
     str = _T("");
     for(int i = 0; i < 250000; i++)
         str += _T("a");

     m_longEdit.SetWindowText(str);

     return TRUE;  // return TRUE  unless you set the focus to a control
 } 
```

如果我改用 CRichEdit 控件，当我在里面粘贴一个长字符串后按“结束”键或“右箭头”键时，我看不到 Rich Edit 控件中的所有字符。试图滚动过去最后一个可见字符会产生哔声。其余字符都在那里，我知道这一点，因为如果我双击 Rich Edit Control 并使用 ctrl-c 复制文本，然后将其粘贴到文本编辑器上，我可以看到 240000 个字符。所以控件保留了适量的字符，但除了在外部编辑器中，最后一个字符是不可见的，所以我原来的问题仍然存在。

以下是微软代表的回答：

> 这里的问题是其中包含大量字符的编辑控件不会绘制其文本。
> 
> 我尝试设置不同的字符，发现我可以容纳更多的 'l' 而不是 'x' 而不是 'm'。问题不直接在于字符数，而可能是像素数。将可见字符的数量乘以所选字体中字符的像素宽度表明限制约为 32k 像素。

微软的另一个回答：

> 我对这个问题进行了广泛的研究，并想向您介绍案件进展情况。
> 
> Vista 上的 Edit 控件和 XP 上的主要区别在于 Vista 上的 Edit 控件预先组合了它的字形以获得更好的国际支持（在内部，它最终使用 ETO_GLYPH_INDEX 和一个字形数组而不是字符串来调用 ExtTextOut。这最终会将字形索引保存到元文件中，因此会遇到 32k 像素的限制。当提供的字符太多时，ExtTextOut 会失败并且什么也不画。XP 上的编辑控件不会预先组合字形，因此没有这个问题，但也不会处理国际字符。
> 
> XP 上的编辑控件将以 32k 剪辑，但由于它在屏幕外，因此并不明显。向右滚动时，它从第一个可见字符开始，因此控件的可见部分始终早于 32k 像素。
> 
> RichEdit 控件绘制开头，但在点击 End 后，编辑大多发生在屏幕外。RichEdit 3.0 和 4.1 给出了类似的行为。这似乎是 RichEdit 控件的 32k 像素限制，因为它在将其显示到屏幕之前将其文本绘制在离屏位图上。
> 
> 考虑到这些点，行为是设计使然。您需要创建自己的控件来获得在单行中显示 240000 的大字符串的行为。

最后一个：

> 我对这个问题进行了进一步的研究，以找到克服 32k 像素限制的任何轻量级解决方法，但不幸的是，似乎没有解决方法。
> 
> 我们尝试过的几个替代方案是 RichEdit 3.0、RichEdit 4.1、使用 UniScribe、使用不同的字体等，但它们似乎都不能满足您的要求。
> 
> 如果您希望在 Windows Vista 中显示超过 32k 像素限制的可编辑单行字符串，您可能需要创建自己的自定义控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T14:36:13.770

仅供参考——如果文本是只读的/dsiplay，您可以在字符串中添加一些 CR-LF 以修复文本的显示。换行时，ExtTextOut 函数的工作方式似乎略有不同。因为它是一个单行编辑框，所以换行符被去掉，所以文本看起来是一样的——除非你复制并粘贴它，否则换行符将在字符串中......

# c# - 如何在 KeyDown 事件中检测 NumberDecimalSeparator (C#)

> ID：206608
> 
> 赞同：5
> 
> 时间：2008-10-15T21:38:23.337
> 
> 标签：c#, internationalization, keyboard-events, culture

我正在尝试查看用户是否在文本框中按下了小数点分隔符，并根据其他参数允许或禁止它。

NumberdecimalSeparator 返回 46 或 '.' 在我的美国系统上。许多其他国家/地区使用“，”作为分隔符。当我按下句点时，KeyDown 事件将 KeyValue 设置为 190。

我只是继续寻找逗号/句号，还是有更好的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T21:49:41.550

通话

```
CultureInfo.CurrentUICulture.NumberFormat.NumberDecimalSeparator 
```

获取当前用户界面文化的小数点分隔符。您可以使用其他文化来获取其他语言的分隔符。

* * *

编辑

从我的系统（`CultureInfo.GetCultures(CultureTypes.SpecificCultures).Count()`）中报告的 166 种文化中，似乎只使用了两个分隔符：句点和逗号。你可以在你的系统中试试这个：

```
var seps = CultureInfo.GetCultures(CultureTypes.SpecificCultures)
            .Select(ci => ci.NumberFormat.NumberDecimalSeparator)
            .Distinct()
            .ToList(); 
```

假设这是真的，此方法可能会有所帮助（请注意，`keyCode`与标志进行或运算`modifiers`以消除无效组合）：

```
 private bool IsDecimalSeparator(Keys keyCode, Keys modifiers)
    {
        Keys fullKeyCode = keyCode | modifiers;
        if (fullKeyCode.Equals(Keys.Decimal))          // value=110
            return true;

        string uiSep = CultureInfo.CurrentUICulture.NumberFormat.NumberDecimalSeparator;
        if (uiSep.Equals("."))
            return fullKeyCode.Equals(Keys.OemPeriod); // value=190
        else if (uiSep.Equals(","))
            return fullKeyCode.Equals(Keys.Oemcomma);  // value=188
        throw new ApplicationException(string.Format("Unknown separator found {0}", uiSep));
    } 
```

最后一点：根据[Keys enumeration](http://msdn.microsoft.com/en-us/library/system.windows.forms.keys(VS.71).aspx)，您提到的值 46 对应于 DEL（删除）键（即 Num Lock 关闭的点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T04:02:11.707

这里的问题是 中的值`KeyEventArgs`是关键代码，而不是字符。如果您`KeyPress`改为处理，您将获得一个`KeyPressEventArgs`可用于比较的字符。

注意：您应该真正比较`NumberDecimalSeparator`字符，因为它是一个字符串，而不是单个字符，因此您需要考虑字符串中有多个字符的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-31T14:52:04.703

如果您需要知道按下的字符是否为小数分隔符：

```
private void Control_KeyPress(object sender, KeyPressEventArgs e)
{
    char separator = System.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator[0];
    if (e.KeyCahr == separador)
    {
        // true
    }
    else
    {
        // false
    }
} 
```

但是，如果您需要接受十进制小键盘键作为任何文化的小数分隔符：

```
 private bool decimalSeparator = false;
    private void Control_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Decimal)
            decimalSeparator = true;
    }

    private void Control_KeyPress(object sender, KeyPressEventArgs e)
    {
        if (decimalSeparator)
        {
            e.KeyChar = System.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator[0];
            decimalSeparator = false;
        }
    } 
```

# c# - 如何使用 VS2008（自动属性）中的“短样式”属性设置默认值？

> ID：206611
> 
> 赞同：7
> 
> 时间：2008-10-15T21:39:15.160
> 
> 标签：c#, .net, visual-studio-2008, properties

如何为定义如下的属性设置默认值：

```
public int MyProperty { get; set; } 
```

那是在VS2008（代码片段）中使用“prop”[tab][tab]。

是否有可能不退回“旧方式”？：

```
private int myProperty = 0; // default value
public int MyProperty
{
    get { return myProperty; }
    set { myProperty = value; }
} 
```

谢谢你的时间。最好的祝福。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T21:40:26.110

只需在构造函数中设置“默认”值即可。

```
public class Person
{
   public Person()
   {
       this.FirstName = string.Empty;
   }

   public string FirstName { get; set; }
} 
```

此外，它们被称为自动属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:46:06.177

我的偏好是“以旧方式”做事，而不是在构造函数中初始化。如果您稍后添加另一个构造函数，则必须确保从中调用第一个构造函数，否则您的属性将未初始化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-03T07:56:39.387

即使这是一个较旧的线程，我想添加一些在 C# > Vers 中实现的新方法。6：

[https://msdn.microsoft.com/de-de/library/bb384054.aspx](https://msdn.microsoft.com/de-de/library/bb384054.aspx)

```
public int MyInt { get; set; } = 0;
public string MyString { get; set; } = "Lorem Ipsum"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T13:48:34.497

[DefaultValue("MyFirstName")] public string FirstName { get; 放; }

# javascript - 在 VE SDK 6.2 中控制集群图钉的 VEShape

> ID：206614
> 
> 赞同：1
> 
> 时间：2008-10-15T21:40:21.367
> 
> 标签：javascript, virtual-earth

**前言**

我正在使用新发布的 Microsoft Virtual Earth SDK v6.2，它内置了对图钉集群的支持。我意识到有一些自定义的集群方法可以很容易回答我的问题，但我想尽可能地利用内置支持，所以这个问题与使用 VE 6.2 SDK 的集群特性特别相关.

**问题**

启用内置集群（通过 VEShapeLayer.SetClusteringConfiguration）后，集群会按预期创建，但是，其中包含默认信息，例如“X 项目位于此处 - 放大以查看详细信息”。在我正在开发的应用程序中，我需要显示更多信息 - 我需要允许用户单击图钉，VE 将自动放大，以便点现在不同，或者显示点的名称在附加到集群图钉的信息框中。问题是 VE 为我创建的集群形状似乎是不可编辑的，直到所有集群逻辑都运行之后......那时，我不知道哪些原始图钉属于该特定集群。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T19:31:10.487

如果其他人有同样的问题，答案刚刚发布在 VE 的 MSDN 论坛上：

[http://social.msdn.microsoft.com/Forums/en-US/vemapcontroldev/thread/d55090e2-2f5c-459c-9ecd-c3f32f0505b3/](http://social.msdn.microsoft.com/Forums/en-US/vemapcontroldev/thread/d55090e2-2f5c-459c-9ecd-c3f32f0505b3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T14:53:50.877

我们正在做的正是我认为你所要求的......试试这个

```
// Create your map
var MapCtl = new VEMap('MapContainer');

// Create a layer for your pins
MapPinLayer = new VEShapeLayer();

// Add a callback that gets called every time the cluster config changes
var clusteringOptions = new VEClusteringOptions();
clusteringOptions.Callback = clusterCallback;

MapPinLayer.SetClusteringConfiguration(VEClusteringType.Grid, clusteringOptions);

// your cluster callback method
function clusterCallback(clusters) {
    for (var i = 0; i < clusters.length; ++i) {
        var cluster = clusters[i];
        var clusterShape = cluster.GetClusterShape();

        var clusterSize = cluster.Shapes.length;

        clusterShape.SetTitle('Some Title');
        clusterShape.SetDescription('There's ' + clusterSize + ' shops in this area');
    }
} 
```

# jquery - 如何使用 jQuery 保存 AJAX 应用程序的状态

> ID：206629
> 
> 赞同：4
> 
> 时间：2008-10-15T21:43:04.403
> 
> 标签：jquery, ajax, ria

我只是想在这个 Ajax 事情上试一试。我有一个非常基本的问题

我看过 jQuery 的 UI 插件 ( [http://interface.eyecon.ro/docs/drag](http://interface.eyecon.ro/docs/drag) )，你可以在其中拖放框架、拉伸东西、动画等。所以基本上你可以在你的 web 中获得所有桌面功能应用。

在桌面世界中，您可以将对象的状态保存到文件中，但是如何在 jQuery 中保存被操作对象的状态。

例如，如果我在 jQuery 中拖动框架，或拉伸 div 元素的边框，如何将其保存到服务器上的文件中，以便下次打开时，它仍保持修改状态？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T21:45:39.920

将状态收集到一个对象中，将其序列化为[JSON](http://www.json.org)，使用[AJAX](http://docs.jquery.com/Ajax)将 HTTP POST发送到服务器上的脚本，该脚本会适当地保存它。

使用反向方法加载它（您可以跳过 AJAX 并在加载时直接将 JSON 打印到您的页面中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T09:58:59.207

是的 Nilesh - [height()](http://jquery.bassistance.de/api-browser/#height)和[width()](http://jquery.bassistance.de/api-browser/#width)方法。我不知道提供位置数据的本机方法，尽管很可能有一个插件；做不到这一点，一些原始的javascript就足够了，一些原始的javascript就足够了。

# css - 如何创建 div 以填充页眉和页脚 div 之间的所有空间

> ID：206652
> 
> 赞同：58
> 
> 时间：2008-10-15T21:50:32.750
> 
> 标签：css, html-table

我正在努力从使用表格进行布局转移到使用 div（是的，是的，这是一场大辩论）。我有 3 个 div、页眉、内容和页脚。页眉和页脚各为 50 像素。如何让页脚 div 留在页面底部，以及让内容 div 填充两者之间的空间？我不想硬编码内容 div 的高度，因为屏幕分辨率可以改变。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2016-07-28T04:40:17.490

# 弹性盒解决方案

使用 flex 布局，我们可以实现这一点，同时允许自然高度的页眉和页脚。页眉和页脚都将分别贴在视口的顶部和底部（很像原生移动应用程序），主要内容区域将填充剩余空间，而任何垂直溢出都将在该区域内滚动。

[见 JS 小提琴](https://jsfiddle.net/osvx1zoo/3/)

**HTML**

```
<body>
  <header>
    ...
  </header>
  <main>
    ...
  </main>
  <footer>
    ...
  </footer>
</body> 
```

**CSS**

```
html, body {
  margin: 0;
  height: 100%;
  min-height: 100%;
}

body {
  display: flex;
  flex-direction: column;
}

header,
footer {
  flex: none;
}

main {
  overflow-y: scroll;
  -webkit-overflow-scrolling: touch;
  flex: auto;
} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-10-16T23:13:03.427

总结一下（这来自 Traingamer 提供的[CSS Sticky Footer](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)链接），这就是我使用的：

```
html, body 
{ 
    height: 100%; 
} 

#divHeader
{
    height: 100px;
}

#divContent
{
    min-height: 100%; 
    height: auto !important; /*Cause footer to stick to bottom in IE 6*/
    height: 100%; 
    margin: 0 auto -100px; /*Allow for footer height*/
    vertical-align:bottom;
}

#divFooter, #divPush
{
    height: 100px; /*Push must be same height as Footer */
}

<div id="divContent">
    <div id="divHeader">
        Header
    </div>

    Content Text

    <div id="divPush"></div>
</div>
<div id="divFooter">
    Footer
</div> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-16T16:58:33.883

要扩展 Mitchel Sellers 的答案，请给您的内容 div height: 100% 并给它一个自动边距。

有关完整说明和示例，请参阅 Ryan Fait 的[CSS Sticky Footer](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)。

由于您知道标题的大小（高度），请将其放在内容 div 内（或使用边距）。

如果您的内容比窗口大（高），绝对位置会给您带来问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-03T06:16:39.583

使用 CSS Grid 的一种方法：

**索引.html**

```
<html>
  <head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link href="main.css" rel="stylesheet">
  </head>
  <body>
    <main>
      <header>Header</header>
      <section>Content</section>
      <footer>Footer</footer>
    </main>
  </body>
</html> 
```

**main.css**

```
body {
    margin: 0;
}
main {
    height: 100%;
    display: grid;
    grid-template-rows: 100px auto 100px;
}
section {
    height: 100%;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-13T19:30:15.550

使用 CSS 网格，几乎所有浏览器都支持它

```
html{
    height: 100%;
}
body{
    margin: 0;
    padding: 0;
    height: 100%;
}

.main-body{
    display: grid;
    /* let content auto to occupy remaining height and pass value in fit-content with min-height for header and footer */
    grid-template-rows: fit-content(8rem) auto fit-content(8rem);
    grid-template-areas: "header" "main" "footer";
}

.main-header{
    background-color: yellow;
    grid-area: header;
}

.main-content{
    grid-area: main;
}

.main-footer{
    background-color: green;
    grid-area: footer;
}
```

```
<body class="main-body">
    <header class="main-header">
        HEADER
    </header>
    <main class="main-content">
        this is content
    </main>
    <footer class="main-footer">
        this is footer
    </footer>
</body>
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-10-15T22:02:27.110

如果你想最大化你的内容 div 的高度，在 CSS 添加

高度：100%；

* * *

## 回答 #7

> 赞同：-9
> 
> 时间：2008-10-16T17:25:46.280

```
#footer {
 clear: both;
} 
```

# asp.net - 在 ASP.NET 中是否有不同的方式必须在 Firefox 中传输文件？

> ID：206659
> 
> 赞同：1
> 
> 时间：2008-10-15T21:55:25.517
> 
> 标签：asp.net, firefox, file

我正在使用 ASP.NET 传输 .jar 文件。此代码在 IE 上完美运行。但是在 Firefox 上，文件下载已损坏。修复它的最佳方法是什么？下面是我正在使用的代码。

```
private void TransferFile()
{
    try
    {
        string filePath = Server.MapPath("SomeJarFIle.jar");

        FileInfo file = new FileInfo(filePath);

        if (file.Exists)
        {
            // Clear the content of the response
            //Response.ClearContent();
            Response.Clear();

            // LINE1: Add the file name and attachment, which will force the open/cance/save dialog to show, to the header
            Response.AddHeader("Content-Disposition", "attachment; filename=" + file.Name);

            // Add the file size into the response header
            Response.AddHeader("Content-Length", file.Length.ToString());

            // Set the ContentType
            Response.ContentType = ReturnExtension(file.Extension.ToLower());

            // Write the file into the response
            //Response.TransmitFile(file.FullName);
            Response.WriteFile(file.FullName);

            // End the response
            Response.End();
        }
        else
        {
            this.Response.Write("Error in finding file.  Please try again.");
            this.Response.Flush();
        }
    }
    catch (Exception ex)
    {
        this.Response.Write(string.Format("Error: {0}", ex.Message));
    }
}

private string ReturnExtension(string fileExtension)
{
    switch (fileExtension)
    {
        case ".htm":
        case ".html":
        case ".log":
            return "text/HTML";
        case ".txt":
            return "text/plain";
        case ".doc":
            return "application/ms-word";
        case ".tiff":
        case ".tif":
            return "image/tiff";
        case ".asf":
            return "video/x-ms-asf";
        case ".avi":
            return "video/avi";
        case ".zip":
            return "application/zip";
        case ".xls":
        case ".csv":
            return "application/vnd.ms-excel";
        case ".gif":
            return "image/gif";
        case ".jpg":
        case "jpeg":
            return "image/jpeg";
        case ".bmp":
            return "image/bmp";
        case ".wav":
            return "audio/wav";
        case ".mp3":
            return "audio/mpeg3";
        case ".mpg":
        case "mpeg":
            return "video/mpeg";
        case ".rtf":
            return "application/rtf";
        case ".asp":
            return "text/asp";
        case ".pdf":
            return "application/pdf";
        case ".fdf":
            return "application/vnd.fdf";
        case ".ppt":
            return "application/mspowerpoint";
        case ".dwg":
            return "image/vnd.dwg";
        case ".msg":
            return "application/msoutlook";
        case ".xml":
        case ".sdxl":
            return "application/xml";
        case ".xdp":
            return "application/vnd.adobe.xdp+xml";
        case ".jar":
            return "application/java-archive";
        default:
            return "application/octet-stream";
    }
} 
```

更新：

我添加了类型

```
case ".jar":
    return "application/java-archive"; 
```

这并没有解决问题。如果我压缩了 .jar 文件，它就可以正常传输。

当我再次测试我的本地主机时，我确实注意到文件下载没有问题。但是，当我将其推送到 Web 服务器时，就会出现问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T21:58:46.417

我在 ReturnExtension() 函数中没有看到“.jar”的情况（我认为将其命名为“ReturnMimetype”可能会更好）。这可能是问题所在，还是您只是忘记粘贴它？

.jar 的 mimetype 应该是**application/java-archive**。详情在这里：[http ://en.wikipedia.org/wiki/Jar-file](http://en.wikipedia.org/wiki/Jar-file)

我认为这是问题所在。我记得当我传输一个 .docx 文件（它实际上是一个扩展名为 .jar 文件的不同扩展名的 zip 文件）时遇到了相同类型的问题。下载在 IE 中运行良好，但 Firefox 损坏了它。解决方案是发送正确的 mimetype。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T22:00:00.703

我只看到两件事，您似乎没有 .jar 文件扩展名的 mime 类型。

两个我个人使用 writefile 而不是传输，但我不确定区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T22:04:38.493

使用 Response.WriteFile 或 Response.BinaryWrite，TransmitFile 方法有一些已知的奇怪行为。

# perl - 在 Perl 中将文件转换为字符串的最佳方法是什么？

> ID：206661
> 
> 赞同：54
> 
> 时间：2008-10-15T21:55:47.420
> 
> 标签：perl, string, file-io, file

是[的，有不止一种方法可以做到，](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it)但必须有一种规范或最有效或最简洁的方法。我会添加我知道的答案，看看有什么渗透到顶部。

需要明确的是，问题是如何最好地将文件的内容读入字符串。每个答案一个解决方案。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-10-15T21:59:42.997

这个怎么样：

```
use File::Slurp;
my $text = read_file($filename); 
```

ETA：请注意[File-Slurp 的错误 #83126：带有编码的安全漏洞（UTF-8）](https://rt.cpan.org/Ticket/Display.html?id=83126)。我现在推荐使用[File::Slurper](https://metacpan.org/pod/File::Slurper)（免责声明：我写的），也是因为它在编码方面有更好的默认值：

```
use File::Slurper 'read_text';
my $text = read_text($filename); 
```

或[Path::Tiny](https://metacpan.org/pod/Path::Tiny)：

```
use Path::Tiny;
path($filename)->slurp_utf8; 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-15T22:30:49.767

我喜欢使用`do`我本地化的块来执行此`@ARGV`操作，因此我可以使用菱形运算符为我执行文件魔术。

```
 my $contents = do { local(@ARGV, $/) = $file; <> }; 
```

如果你需要它更健壮一点，你可以很容易地把它变成一个子例程。

~~如果您需要处理各种特殊情况的真正强大的东西，请使用[File::Slurp](http://search.cpan.org/dist/File-Slurp)。即使您不打算使用它，也请查看源代码以了解它必须处理的所有古怪情况。~~ [File::Slurp](http://search.cpan.org/dist/File-Slurp)有一个[很大的安全问题](https://rt.cpan.org/Ticket/Display.html?id=83126)，看起来没有解决方案。部分原因是它未能正确处理编码。即使我的快速回答也有这个问题。如果您需要处理编码（可能是因为默认情况下您没有将所有内容都设置为 UTF-8），这将扩展为：

```
my $contents = do {
    open my $fh, '<:encoding(UTF-8)', $file or die '...';
    local $/;
    <$fh>;
    }; 
```

如果您不需要更改文件，则可以使用[File::Map](http://www.metacpan.org/module/File::Map)。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-10-18T08:35:58.437

在编写[File::Slurp](http://search.cpan.org/perldoc?File::Slurp)（这是最好的方式）时，Uri Guttman 对多种 slurp 方式进行了大量研究，哪种方式最有效。他在这里写下了[他的发现](http://search.cpan.org/~drolsky/File-Slurp-9999.13/extras/slurp_article.pod)并将其合并到 info File::Slurp。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-10-15T21:59:40.110

```
open(my $f, '<', $filename) or die "OPENING $filename: $!\n";
$string = do { local($/); <$f> };
close($f); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-15T22:38:38.770

需要考虑的事情（尤其是与其他解决方案相比时）：

1.  词法文件句柄
2.  缩小范围
3.  减少魔法

所以我得到：

```
my $contents = do {
  local $/;
  open my $fh, $filename or die "Can't open $filename: $!";
  <$fh>
}; 
```

我不是魔法 <> 的忠实粉丝，除非实际使用魔法 <>。与其伪装出来，不如直接使用 open 调用？这不是更多的工作，而且是明确的。（真正的魔法<>，尤其是在处理“-”时，要完美模拟要付出更多的工作，但无论如何我们都不会在这里使用它。）

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-16T04:17:13.063

在以下情况下，字符串的 mmap（内存映射）可能很有用：

*   有非常大的字符串，你不想加载到内存中
*   想要一个盲目的快速初始化（你在访问时获得渐进的 I/O）
*   对字符串进行随机或惰性访问。
*   可能想要更新字符串，但只是扩展它或替换字符：

```
#!/usr/bin/perl
use warnings; use strict;

use IO::File;
use Sys::Mmap;

sub sip {

    my $file_name = shift;
    my $fh;

    open ($fh, '+<', $file_name)
        or die "Unable to open $file_name: $!";

    my $str;

    mmap($str, 0, PROT_READ|PROT_WRITE, MAP_SHARED, $fh)
      or die "mmap failed: $!";

    return $str;
}

my $str = sip('/tmp/words');

print substr($str, 100,20); 
```

**更新：2012 年 5 月**

[在将Sys::Mmap](http://search.cpan.org/dist/Sys-Mmap/)替换为[File::Map](http://search.cpan.org/dist/File-Map/)之后，以下内容应该非常等价

```
#!/usr/bin/perl
use warnings; use strict;

use File::Map qw{map_file};

map_file(my $str => '/tmp/words', '+<');

print substr($str, 100, 20); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-12-08T03:30:05.273

```
use Path::Class;
file('/some/path')->slurp; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-15T21:59:55.227

```
{
  open F, $filename or die "Can't read $filename: $!";
  local $/;  # enable slurp mode, locally.
  $file = <F>;
  close F;
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-16T06:44:44.030

这既不快，也不独立于平台，而且非常邪恶，但它很短（我在 Larry Wall 的代码中看到了这一点；-）：

```
 my $contents = `cat $file`; 
```

孩子们，不要在家里这样做;-)。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-08-10T20:09:04.453

```
use IO::All;

# read into a string (scalar context)
$contents = io($filename)->slurp;

# read all lines an array (array context)
@lines = io($filename)->slurp; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-15T22:19:39.120

[请参阅Perl6::Slurp](https://metacpan.org/module/Perl6::Slurp)的摘要，它非常灵活，通常只需很少的努力就能做正确的事情。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-11-18T05:33:15.910

以下是最流行的方法的一个很好的比较：

[http://poundcomment.wordpress.com/2009/08/02/perl-read-entire-file/](http://poundcomment.wordpress.com/2009/08/02/perl-read-entire-file/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-04-11T13:05:13.063

没有人说任何关于 read 或 sysread 的事情，所以这里有一个简单而快速的方法：

```
my $string;
{
    open my $fh, '<', $file or die "Can't open $file: $!";
    read $fh, $string, -s $file;   # or sysread
    close $fh;
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-10-28T12:36:29.417

对于单行，您通常可以使用[开关`-0`（](http://perldoc.perl.org/perlrun.html#*-0*%5b_octal%2fhexadecimal_%5d) wit `-n`​​h）让 perl 一次读取整个文件（如果文件不包含任何空字节）：

```
perl -n0e 'print "content is in $_\n"' filename 
```

如果它是二进制文件，您可以使用`-0777`：

```
perl -n0777e 'print length' filename 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-15T22:01:10.390

最糟糕的方法的候选人！（见评论。）

```
open(F, $filename) or die "OPENING $filename: $!\n";
@lines = <F>;
close(F);
$string = join('', @lines); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-05-28T22:35:14.773

调整特殊记录分隔符变量`$/`

```
undef $/;
open FH, '<', $filename or die "$!\n";
my $contents = <FH>;
close FH; 
```

# activex - 具有多个类的 ActiveX 控件

> ID：206668
> 
> 赞同：1
> 
> 时间：2008-10-15T21:57:24.000
> 
> 标签：activex

目前我有一个activex控件，我用regsvr32 foo.dll将它注册到我的电脑上。（注意：这是一个第三方的 activex 控件，所以我实际上没有它的源代码，只有一个 dll）

当我在类下启动 regedit 时，我看到我的 dll 已注册，但是它有多个类。Foo.class1、Foo.class2 和这些类中的每一个都有自己的 clsid。当我尝试将此 activex 控件嵌入到 html 页面中时，整个控件没有 clsid，只有每个类的 clsid。嵌入此控件以使用其功能的最佳方法是什么。

该公司告诉我创建一个activex控件并将activex控件放入其中。我一直在搜索互联网，但不知道如何做到这一点。

任何帮助将不胜感激！！！

谢谢

编辑：与公司的所有途径都已用尽。我们的答案是创建一个 activex 控件并将其 activex 控件嵌入其中。有谁知道开始做的例子，或者是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T22:06:57.490

不确定这是否会对您有所帮助，因为您想将其嵌入网页中。

创建 C# 控件库

在项目菜单项下，选择属性

点击组装信息

选择“使程序集 com 可见”

点击“好”

点击构建

选择“注册 com 互操作”

然后打开 assemblyinfo.cs 并更改它的位置

[assembly: AssemblyVersion("1.0.*")] 到 [assembly: AssemblyVersion("1.0.0.0")] 这样可以确保您的 GUID 在每次构建期间都不会更改。

检查这些： [http ://www.c-sharpcorner.com/UploadFile/dsandor/ActiveXInNet11102005040748AM/ActiveXInNet.aspx](http://www.c-sharpcorner.com/UploadFile/dsandor/ActiveXInNet11102005040748AM/ActiveXInNet.aspx)

[http://www.codeproject.com/KB/miscctrl/exposingdotnetcontrols.aspx](http://www.codeproject.com/KB/miscctrl/exposingdotnetcontrols.aspx)

# html - 更改所选链接的背景颜色

> ID：206689
> 
> 赞同：1
> 
> 时间：2008-10-15T22:01:33.680
> 
> 标签：html, css

我有一个正在使用的菜单，当我悬停使用时它会改变背景颜色，`a:hover`但我想知道如何改变它以使其保持不变`class=line`。

所以从首页如果他们点击联系首页

> 从 (a href="#" class="clr") 到 (a href="#")

和联系人会改变

> 从 (a href="#") 到 (a href="#" class="clr")

有什么帮助吗？

京东

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T22:06:21.487

我相信您想要突出显示您所在的导航项目。我[在这里](https://stackoverflow.com/questions/188124/programmatic-solution-to-change-navigation-id-to-highlight-current-page-aspnet#189069)的回答在这个问题上也相当有效，我相信：

这是一个更好的语义匹配，并且可能是一个更容易设置的变量，以保持导航在任何地方使用相同的类或 id，并且只更改 body 元素的 id 以匹配：

```
<li id="homeNav">home</li>
<li id="blogNav">blog</li> 
```

然后在每一页上......

```
<body id="home">
<body id="blog"> 
```

在CSS中：

```
#home #homeNav {background-image:url(homeNav-on.jpg);}
#blog #blogNav {background-image:url(blogNav-on.jpg);} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T22:05:46.993

在 javascript 中更改类的方法（我假设你在谈论 DOM）是：

```
document.getElementById("element").className='myClass'; 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T09:36:34.433

我们经常使用的机制是在 body 上安装一些通用事件侦听器，并让所有需要的事件冒泡。一旦被捕获，我们会检查触发元素上的某个类名（或类名模式）。如果找到这样的 className，我们将其视为状态标识符，并根据此类状态触发行为。

例如，我们定义了具有默认切换行为的类名对（例如“selected”和“unselected”）。或者通过为父元素指定 className “exclusive-selected”来使它们独占。

像这样的简单机制可以根据您的喜好进行扩展，并且可以非常强大。

请允许我发布一个简单的演示。非泛型，但它只是为了说明这种机制的内部工作原理。对于这个例子，我认为 className 对“selected”和“unselected”是互斥的。

```
<html>
  <head>
    <script>
      document.onclick = function(evt) {
        var el = window.event? event.srcElement : evt.target;
        if (el && el.className == "unselected") {
          el.className = "selected";
          var siblings = el.parentNode.childNodes;
          for (var i = 0, l = siblings.length; i < l; i++) {
            var sib = siblings[i];
            if (sib != el && sib.className == "selected")
              sib.className = "unselected";
          }
        }
      }
    </script>
    <style>
      .selected { background: #f00; }
    </style>
  </head>
  <body>
    <a href="#" class="selected">One</a> 
    <a href="#" class="unselected">Two</a> 
    <a href="#" class="unselected">Three</a>
  </body>
</html> 
```

它应该可以在 IE、Firefox 和其他浏览器上运行。当然，这种机制可以通用化，并实现各种类名状态和行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T07:54:33.890

这可能不适用于您，但它可能会引导您走上正确的道路。如果您使用的是 PHP，请在 doctype 声明或 (x)html 标记之前记住这一点：

```
<?php
  // Get current page file name
  $url = Explode('/', $_SERVER["PHP_SELF"]);
  $page = $parts[count($url) - 1];
?> 
```

然后，在您想要指定类的菜单项中，放置以下内容，但将“index.php”更改为页面名称：

```
<?php if ($page == "index.php") echo ' class="current"' ?> 
```

所以最终你的菜单应该看起来像这样：

```
<div id="navigation">
  <ul>
    <li><a href="index.php"<?php if ($page == "index.php") echo ' class="current"' ?>>Home</a></li>
    <li><a href="page1.php"<?php if ($page == "page1.php") echo ' class="current"' ?>>Resume</a></li>
    <li><a href="page2.php"<?php if ($page == "page2.php") echo ' class="current"' ?>>Photography</a></li>
  </ul>
</div> 
```

最后一步是添加 CSS：

```
#navigation ul li a.current {
  background-color: #FFF;
} 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T10:01:22.197

您可能想查看 jQuery (jquery.com)。

使用 jQuery，您可以像这样更改类（并粘贴它）：

```
$('#link-id').addClass('your-class'); 
```

您可以将代码绑定到这样的链接：

```
$('#link-id').mouseover(
   function(){
      $(this).addClass('your-class');
   }
); 
```

[http://docs.jquery.com/Attributes](http://docs.jquery.com/Attributes)

# podcast - 我应该如何建立一个包含播客的新网站？用什么？

> ID：206703
> 
> 赞同：0
> 
> 时间：2008-10-15T22:05:25.637
> 
> 标签：podcast

我要建立一个**经典音乐**网站，客户已经有几个播客，每个播客大约 3 分钟，我想知道是否**应该添加 QT/WMP 文件**来收听和 ZIP 下载，**还是应该使用一个网络播客托管**解决方案，只需将链接添加到它们？

...考虑到完整的跨浏览器和操作系统（mac、windows、*nix、mobiles）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T22:12:21.053

我建议 3rd 方托管播客（mp3 文件是标准文件），并在页面上在每个播客帖子上使用 flash mp3 播放器，以及下载链接。也不要忘记您的 RSS 和 iTunes，订阅是播客的重要组成部分！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T22:08:22.090

如果您期望有很多下载，那么在您自己的站点上托管文件可能会很快耗尽您的带宽。第三方主机可以解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T14:14:48.693

为了降低成本，首先要自己托管。典型的网站使用 WordPress 和 PodPress。以 MP3 形式发布；任何其他格式都是可选的，但现在并不推荐。如果您自己托管，只需观看下载并计划在您开始流行后立即转移到专用主机。

如果您有更多问题，请离线联系我。这不是一个真正的编程问题。

# c# - 如何在 C# 中用单个空格替换多个空格？

> ID：206717
> 
> 赞同：520
> 
> 时间：2008-10-15T22:10:31.993
> 
> 标签：c#, regex, string

如何在 C# 中用一个空格替换字符串中的多个空格？

例子：

```
1 2 3  4    5 
```

将会：

```
1 2 3 4 5 
```

* * *

## 回答 #1

> 赞同：707
> 
> 时间：2008-10-15T23:58:12.900

我喜欢使用：

```
myString = Regex.Replace(myString, @"\s+", " "); 
```

因为它将捕获任何类型的空格（例如制表符、换行符等）并用单个空格替换它们。

* * *

## 回答 #2

> 赞同：555
> 
> 时间：2008-10-15T22:11:21.647

```
string sentence = "This is a sentence with multiple    spaces";
RegexOptions options = RegexOptions.None;
Regex regex = new Regex("[ ]{2,}", options);     
sentence = regex.Replace(sentence, " "); 
```

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2008-10-15T22:12:52.830

```
string xyz = "1   2   3   4   5";
xyz = string.Join( " ", xyz.Split( new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries )); 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2010-05-20T22:07:09.293

我认为马特的回答是最好的，但我不认为这是完全正确的。如果要替换换行符，则必须使用：

```
myString = Regex.Replace(myString, @"\s+", " ", RegexOptions.Multiline); 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2012-08-14T07:23:16.793

另一种使用 LINQ 的方法：

```
 var list = str.Split(' ').Where(s => !string.IsNullOrWhiteSpace(s));
 str = string.Join(" ", list); 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2008-10-15T23:36:15.720

它比所有这些都简单得多：

```
while(str.Contains("  ")) str = str.Replace("  ", " "); 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2015-11-20T02:00:01.740

即使是简单的任务，正则表达式也会相当慢。这将创建一个扩展方法，可以在任何`string`.

```
 public static class StringExtension
    {
        public static String ReduceWhitespace(this String value)
        {
            var newString = new StringBuilder();
            bool previousIsWhitespace = false;
            for (int i = 0; i < value.Length; i++)
            {
                if (Char.IsWhiteSpace(value[i]))
                {
                    if (previousIsWhitespace)
                    {
                        continue;
                    }

                    previousIsWhitespace = true;
                }
                else
                {
                    previousIsWhitespace = false;
                }

                newString.Append(value[i]);
            }

            return newString.ToString();
        }
    } 
```

它会这样使用：

```
string testValue = "This contains     too          much  whitespace."
testValue = testValue.ReduceWhitespace();
// testValue = "This contains too much whitespace." 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2008-11-20T07:20:54.657

```
myString = Regex.Replace(myString, " {2,}", " "); 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-05-27T15:16:35.283

对于那些不喜欢 的人`Regex`，这里有一个使用 的方法`StringBuilder`：

```
 public static string FilterWhiteSpaces(string input)
    {
        if (input == null)
            return string.Empty;

        StringBuilder stringBuilder = new StringBuilder(input.Length);
        for (int i = 0; i < input.Length; i++)
        {
            char c = input[i];
            if (i == 0 || c != ' ' || (c == ' ' && input[i - 1] != ' '))
                stringBuilder.Append(c);
        }
        return stringBuilder.ToString();
    } 
```

在我的测试中，与静态编译的 Regex 相比，这种方法在处理大量中小型字符串时平均快 16 倍。与非编译或非静态正则表达式相比，这应该更快。

请记住，它不会*删除*前导或尾随空格，只会删除多次出现的空格。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-05-14T06:44:56.070

这是一个较短的版本，仅当您只执行一次时才应使用它，因为它`Regex`每次调用时都会创建一个新的类实例。

```
temp = new Regex(" {2,}").Replace(temp, " "); 
```

如果你对正则表达式不太熟悉，这里有一个简短的解释：

使`{2,}`正则表达式搜索它前面的字符，并找到 2 次到无限次之间的子字符串。
用`.Replace(temp, " ")`空格替换字符串 temp 中的所有匹配项。

如果您想多次使用它，这里是一个更好的选择，因为它会在编译时创建正则表达式 IL：

```
Regex singleSpacify = new Regex(" {2,}", RegexOptions.Compiled);
temp = singleSpacify.Replace(temp, " "); 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-03-06T10:37:30.127

您可以在一个解决方案中简单地做到这一点！

```
string s = "welcome to  london";
s.Replace(" ", "()").Replace(")(", "").Replace("()", " "); 
```

如果您愿意，可以选择其他括号（甚至其他字符）。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2018-01-18T16:39:51.920

没有 Regex，没有 Linq... 删除前导和尾随空格以及将任何嵌入的多个空格段减少到一个空格

```
string myString = "   0 1 2  3   4               5  ";
myString = string.Join(" ", myString.Split(new char[] { ' ' }, 
StringSplitOptions.RemoveEmptyEntries)); 
```

结果：“0 1 2 3 4 5”

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-10-15T22:39:51.077

根据乔尔的说法，安慰其他答案，并希望随着我的进展略有改善：

你可以这样做[`Regex.Replace()`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.replace(VS.71).aspx)：

```
string s = Regex.Replace (
    "   1  2    4 5", 
    @"[ ]{2,}", 
    " "
    ); 
```

或与[`String.Split()`](http://msdn.microsoft.com/en-us/library/system.string.split(VS.71).aspx)：

```
static class StringExtensions
{
    public static string Join(this IList<string> value, string separator)
    {
        return string.Join(separator, value.ToArray());
    }
}

//...

string s = "     1  2    4 5".Split (
    " ".ToCharArray(), 
    StringSplitOptions.RemoveEmptyEntries
    ).Join (" "); 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-05-17T05:32:44.240

```
// Mysample string
string str ="hi you           are          a demo";

//Split the words based on white sapce
var demo= str .Split(' ').Where(s => !string.IsNullOrWhiteSpace(s));

//Join the values back and add a single space in between
str = string.Join(" ", demo);
// output: string str ="hi you are a demo"; 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-20T17:40:24.920

我刚刚写了一个`Join`我喜欢的新的，所以我想我会重新回答：

```
public static string Join<T>(this IEnumerable<T> source, string separator)
{
    return string.Join(separator, source.Select(e => e.ToString()).ToArray());
} 
```

一个很酷的事情是它可以通过在元素上调用 ToString() 来处理不是字符串的集合。用法还是一样的：

```
//...

string s = "     1  2    4 5".Split (
    " ".ToCharArray(), 
    StringSplitOptions.RemoveEmptyEntries
    ).Join (" "); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-02-27T20:04:00.147

许多答案都提供了正确的输出，但对于那些寻求最佳性能的人来说，我确实将[Nolanar 的答案](https://stackoverflow.com/a/16776096/315493)（这是性能的最佳答案）提高了大约 10%。

```
public static string MergeSpaces(this string str)
{

    if (str == null)
    {
        return null;
    }
    else
    {
        StringBuilder stringBuilder = new StringBuilder(str.Length);

        int i = 0;
        foreach (char c in str)
        {
            if (c != ' ' || i == 0 || str[i - 1] != ' ')
                stringBuilder.Append(c);
            i++;
        }
        return stringBuilder.ToString();
    }

} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2018-08-23T14:50:24.530

使用正则表达式模式

```
 [ ]+    #only space

   var text = Regex.Replace(inputString, @"[ ]+", " "); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-07-20T05:07:11.283

我知道这已经很老了，但是在尝试完成几乎相同的事情时遇到了这个问题。在 RegEx Buddy 中找到了这个解决方案。此模式将用单个空格替换所有双空格，并修剪前导和尾随空格。

```
pattern: (?m:^ +| +$|( ){2,})
replacement: $1 
```

由于我们处理的是空白空间，因此有点难以阅读，所以这里再次将“空格”替换为“_”。

```
pattern: (?m:^_+|_+$|(_){2,})  <-- don't use this, just for illustration. 
```

“(?m:” 构造启用了“多行”选项。我通常喜欢在模式本身中包含我可以使用的任何选项，以便它更加独立。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-02-11T10:24:29.400

我可以用这个删除空格

```
while word.contains("  ")  //double space
   word = word.Replace("  "," "); //replace double space by single space.
word = word.trim(); //to remove single whitespces from start & end. 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-01-22T18:26:03.457

**试试这个方法**

```
private string removeNestedWhitespaces(char[] st)
{
    StringBuilder sb = new StringBuilder();
    int indx = 0, length = st.Length;
    while (indx < length)
    {
        sb.Append(st[indx]);
        indx++;
        while (indx < length && st[indx] == ' ')
            indx++;
        if(sb.Length > 1  && sb[0] != ' ')
            sb.Append(' ');
    }
    return sb.ToString();
} 
```

像这样使用它：

```
string test = removeNestedWhitespaces("1 2 3  4    5".toCharArray()); 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-02-16T18:38:09.633

不使用正则表达式：

```
while (myString.IndexOf("  ", StringComparison.CurrentCulture) != -1)
{
    myString = myString.Replace("  ", " ");
} 
```

可以在短字符串上使用，但在有很多空格的长字符串上表现不佳。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-11-14T04:20:38.747

这是对[Nolonar 原始答案的](https://stackoverflow.com/a/16776096/8705563)*轻微修改*。

检查字符是否不仅仅是一个空格，而是任何空格，使用这个：

它将用单个空格替换任何多个空格字符。

```
public static string FilterWhiteSpaces(string input)
{
    if (input == null)
        return string.Empty;

    var stringBuilder = new StringBuilder(input.Length);
    for (int i = 0; i < input.Length; i++)
    {
        char c = input[i];
        if (i == 0 || !char.IsWhiteSpace(c) || (char.IsWhiteSpace(c) && 
            !char.IsWhiteSpace(strValue[i - 1])))
            stringBuilder.Append(c);
    }
    return stringBuilder.ToString();
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-11-30T09:26:26.303

老派：

```
string oldText = "   1 2  3   4    5     ";
string newText = oldText
                    .Replace("  ", " " + (char)22 )
                    .Replace( (char)22 + " ", "" )
                    .Replace( (char)22 + "", "" );

Assert.That( newText, Is.EqualTo( " 1 2 3 4 5 " ) ); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-11-28T13:11:14.720

混合使用[StringBuilder](https://docs.microsoft.com/en-us/dotnet/api/system.text.stringbuilder?view=netframework-4.7.2)和[Enumerable.Aggregate()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.aggregate?view=netframework-4.7.2)作为字符串的扩展方法：

```
using System;
using System.Linq;
using System.Text;

public static class StringExtension
{
    public static string StripSpaces(this string s)
    {
        return s.Aggregate(new StringBuilder(), (acc, c) =>
        {
            if (c != ' ' || acc.Length > 0 && acc[acc.Length-1] != ' ')
                acc.Append(c);

            return acc;
        }).ToString();
    }

    public static void Main()
    {
        Console.WriteLine("\"" + StringExtension.StripSpaces("1   Hello       World  2   ") + "\"");
    }
} 
```

输入：

```
"1   Hello       World  2   " 
```

输出：

```
"1 Hello World 2 " 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-02-26T16:09:34.813

我查看了建议的解决方案，找不到可以处理我的情况可接受的空白字符混合的解决方案，例如：

*   `Regex.Replace(input, @"\s+", " ")`- 它会吃掉你的换行符，如果它们与空格混合，例如`\n \n`序列将被替换为
*   `Regex.Replace(source, @"(\s)\s+", "$1")`- 这将取决于空格的第一个字符，这意味着它可能再次吃掉你的换行符
*   `Regex.Replace(source, @"[ ]{2,}", " ")`- 当有空格字符混合时它不会正常工作 - 例如`"\t \t "`

可能并不完美，但对我来说快速的解决方案是：

```
Regex.Replace(input, @"\s+", 
(match) => match.Value.IndexOf('\n') > -1 ? "\n" : " ", RegexOptions.Multiline) 
```

想法是 - 换行符胜过空格和制表符。

这将无法正确处理 windows 换行符，但也很容易调整以使用它，不太了解正则表达式 - 可能适合单一模式。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-10-18T12:31:34.857

去无赖怎么办？

```
public static string MinimizeWhiteSpace(
    this string _this)
    {
        if (_this != null)
        {
            var returned = new StringBuilder();
            var inWhiteSpace = false;
            var length = _this.Length;
            for (int i = 0; i < length; i++)
            {
                var character = _this[i];
                if (char.IsWhiteSpace(character))
                {
                    if (!inWhiteSpace)
                    {
                        inWhiteSpace = true;
                        returned.Append(' ');
                    }
                }
                else
                {
                    inWhiteSpace = false;
                    returned.Append(character);
                }
            }
            return returned.ToString();
        }
        else
        {
            return null;
        }
    } 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-11-25T15:00:40.070

以下代码将所有多个空格删除为单个空格

```
 public string RemoveMultipleSpacesToSingle(string str)
    {
        string text = str;
        do
        {
            //text = text.Replace("  ", " ");
            text = Regex.Replace(text, @"\s+", " ");
        } while (text.Contains("  "));
        return text;
    } 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2022-02-21T10:29:25.727

**您可以使用RemoveDoubleSpaces() 之**类的方法创建 StringsExtensions 文件。

**字符串扩展.cs**

```
public static string RemoveDoubleSpaces(this string value)  
{
  while (value.Contains("  "))
  {
    value = value.Replace("  ", " ");
  }

  // this removes space at the end of the value (like "demo ")
  if (value.EndsWith(" ")) value = value.Remove(value.Length - 1);

  // this removes space at the start of the value (like " hi")
  if (value.StartsWith(" ")) value = value[1..];

  return value;
} 
```

然后你可以像这样使用它：

```
string stringInput =" hi here     is  a demo ";

string stringCleaned = stringInput.RemoveDoubleSpaces(); 
```

# c# - 将 Session[] 与页面加载一起使用

> ID：206718
> 
> 赞同：0
> 
> 时间：2008-10-15T22:10:36.563
> 
> 标签：c#, session, web-applications

我想将数据加载到会话中，以便在水晶报表查看器中单击下一个按钮时，应该从数据表中加载数据，而不是再次从数据库中检索数据。这是我的代码...

```
 ReportDocument rpt = new ReportDocument();
    DataTable resultSet = new DataTable();
    string reportpath = null;

   protected void Page_Load(object sender, EventArgs e)
    {

        if (!Page.IsPostBack)
        {

           if (Request.QueryString.Get("id") == "5")
            {
                string publication = Request.QueryString.Get("pub");
                DateTime date = DateTime.Parse(Request.QueryString.Get("date"));
                int pages = int.Parse(Request.QueryString.Get("pages"));
                int sort = int.Parse(Request.QueryString.Get("sort"));
                if (sort == 0)
                {
                    reportpath = Server.MapPath("IssuesReport.rpt");
                    rpt.Load(reportpath);
                    DataTable resultSet1 = RetrievalProcedures.IssuesReport(date,          publication, pages);
                Session["Record"] = resultSet1;
             }

          DataTable report = (DataTable)Session["Record"];
          rpt.SetDataSource(report);
          CrystalReportViewer1.ReportSource = rpt; 
```

我正在尝试这段代码，但是当我单击下一个按钮时，它给了我无效报告源的错误..我猜会话是空的，这就是它给我这个错误的原因。

任何建议我该如何解决这个问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T22:19:06.140

我认为您希望为每个用户使用具有唯一键的 Cache 对象，而不是此处的 Session 。

伪代码：

```
var data = Cache["Record_999"] as DataTable;
if (data == null) {
    // get from db
    // insert into cache
}
SetDataSource(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T01:20:57.320

问题不在于使用 Session，而在于用于确定何时检索数据的逻辑。Session 是在这里使用的正确方法，因为 Cache 在请求之间共享 - 也就是说，如果用户 B 是第一个执行使用 Cache 而不是 Session 的代码的用户，用户 A 将看到刚刚配置的报告用户 B。

```
if (!Page.IsPostBack)
{
    if (Request.QueryString.Get("id") == "5")
    {
        string publication = Request.QueryString.Get("pub");
        DateTime date = DateTime.Parse(Request.QueryString.Get("date"));
        int pages = int.Parse(Request.QueryString.Get("pages"));
        int sort = int.Parse(Request.QueryString.Get("sort"));
        // fixed the statement below to key off of session
        if (Session["Record"] == null)
        {
            reportpath = Server.MapPath("IssuesReport.rpt");
            rpt.Load(reportpath);
            Session["Record"] = RetrievalProcedures.IssuesReport(date, publication, pages);
         }

         rpt.SetDataSource((DataTable)Session["Record"]);
         CrystalReportViewer1.ReportSource = rpt;
         // ....
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T01:42:58.630

`难道那个排序不是0吗？如果 sort 不为 0 并且用户是第一次访问该页面（之前未设置 Session["Record"]），他可能会收到错误消息。可能想尝试：

```
if(sort==0 || Session["Record"] == null)
{
// do your magic
} 
```

# vba - 如何确定文本是否为西里尔字符？

> ID：206719
> 
> 赞同：3
> 
> 时间：2008-10-15T22:11:03.457
> 
> 标签：vba, unicode, outlook

我的垃圾邮件文件夹里塞满了似乎是西里尔字母的邮件。如果邮件正文或邮件主题是西里尔文，我想永久删除它。

在我的屏幕上，我看到西里尔字符，但是当我在 Outlook 中遍历 VBA 中的邮件时，邮件的“主题”属性返回问号。

如何确定邮件的主题是否为西里尔字符？

（注意：我检查了“InternetCodepage”属性——它通常是西欧的。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T03:17:52.857

VB/VBA 中的`String`数据类型可以处理 Unicode 字符，但 IDE 本身无法显示它们（因此有问号）。

我写了一个`IsCyrillic`可以帮助你的函数。如果字符串包含至少一个西里尔字符，该函数接受一个`String`参数并返回。`True`我用 Outlook 2007 测试了这段代码，它似乎工作正常。为了测试它，我给自己发了几封主题行中带有西里尔文字的电子邮件，并验证我的测试代码可以正确地从收件箱中的所有其他内容中挑选出这些电子邮件。

所以，我实际上有两个代码片段：

*   包含`IsCyrillic`函数的代码。这可以复制粘贴到新的 VBA 模块中或添加到您已有的代码中。
*   我编写的`Test`例程（在 Outlook VBA 中）以测试代码是否实际工作。它演示了如何使用该`IsCyrillic`功能。

### 编码

```
Option Explicit

Public Const errInvalidArgument = 5

' Returns True if sText contains at least one Cyrillic character'
' NOTE: Assumes UTF-16 encoding'

Public Function IsCyrillic(ByVal sText As String) As Boolean

    Dim i As Long

    ' Loop through each char. If we hit a Cryrillic char, return True.'

    For i = 1 To Len(sText)

        If IsCharCyrillic(Mid(sText, i, 1)) Then
            IsCyrillic = True
            Exit Function
        End If

    Next

End Function

' Returns True if the given character is part of the Cyrillic alphabet'
' NOTE: Assumes UTF-16 encoding'

Private Function IsCharCyrillic(ByVal sChar As String) As Boolean

    ' According to the first few Google pages I found, '
    ' Cyrillic is stored at U+400-U+52f                '

    Const CYRILLIC_START As Integer = &H400
    Const CYRILLIC_END  As Integer = &H52F

    ' A (valid) single Unicode char will be two bytes long'

    If LenB(sChar) <> 2 Then
        Err.Raise errInvalidArgument, _
            "IsCharCyrillic", _
            "sChar must be a single Unicode character"
    End If

    ' Get Unicode value of character'

    Dim nCharCode As Integer
    nCharCode = AscW(sChar)

    ' Is char code in the range of the Cyrillic characters?'

    If (nCharCode >= CYRILLIC_START And nCharCode <= CYRILLIC_END) Then
        IsCharCyrillic = True
    End If

End Function 
```

### 示例用法

```
' On my box, this code iterates through my Inbox. On your machine,'
' you may have to switch to your Inbox in Outlook before running this code.'
' I placed this code in `ThisOutlookSession` in the VBA editor. I called'
' it in the Immediate window by typing `ThisOutlookSession.TestIsCyrillic`'

Public Sub TestIsCyrillic()

    Dim oItem As Object
    Dim oMailItem As MailItem

    For Each oItem In ThisOutlookSession.ActiveExplorer.CurrentFolder.Items

        If TypeOf oItem Is MailItem Then

            Set oMailItem = oItem

            If IsCyrillic(oMailItem.Subject) Then

                ' I just printed out the offending subject line '
                ' (it will display as ? marks, but I just       '
                ' wanted to see it output something)            '
                ' In your case, you could change this line to:  '
                '                                               '
                '     oMailItem.Delete                          '
                '                                               '
                ' to actually delete the message                '

                Debug.Print oMailItem.Subject

            End If

        End If

    Next

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T22:20:53.593

> 消息的“主题”属性返回一堆问号。

一个经典的字符串编码问题。听起来该属性正在返回 ASCII，但您需要 UTF-8 或 Unicode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T23:10:08.720

在我看来，您已经有了一个简单的解决方案 - 只需查找任何带有（比如说）5个问号的主题行

# apache-flex - 带有 TextInput 和按钮的 Flex 警报

> ID：206728
> 
> 赞同：2
> 
> 时间：2008-10-15T22:14:46.260
> 
> 标签：apache-flex, actionscript-3

有谁知道是否可以将其他控件添加到 Flex 3 警报？我需要的是一个模态对话框，允许用户在单击确定或取消之前输入文件名。这似乎最好通过警报来实现，但在文档中我没有看到添加 TextInput（或除按钮之外的任何其他控件）的明显方法。我宁愿不必重新发明轮子，但如果我必须那么嘿，我会做的！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T04:50:00.157

我相信您正在寻找一个灵活的标题窗口。警报允许配置按钮和按钮的文本。[这里](https://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/containers/TitleWindow.html)有一些标题窗口的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T22:49:46.157

我相信创建自己的组件来实现此目的是您唯一的途径。不过，您始终可以使用警报对话框的样式，因此它看起来像所有其他警报，并在整个应用程序中保持相似的感觉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T08:31:45.403

您可以使用“PopUpManager”类根据您的要求发出警报， [此处的示例](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000696.html)或[自定义弹出窗口](http://blog.flexexamples.com/2008/03/20/creating-custom-pop-up-windows-with-the-popupmanager-class-redux/)

# python - 为什么属性引用在 Python 继承中会这样？

> ID：206734
> 
> 赞同：22
> 
> 时间：2008-10-15T22:18:00.417
> 
> 标签：python, class, inheritance

以下看起来很奇怪.. 基本上， somedata 属性似乎在继承自的所有类之间共享`the_base_class`。

```
class the_base_class:
    somedata = {}
    somedata['was_false_in_base'] = False

class subclassthing(the_base_class):
    def __init__(self):
            print self.somedata

first = subclassthing()
{'was_false_in_base': False}
first.somedata['was_false_in_base'] = True
second = subclassthing()
{'was_false_in_base': True}
>>> del first
>>> del second
>>> third = subclassthing()
{'was_false_in_base': True} 
```

`self.somedata`在函数中定义`__init__`显然是解决这个问题的正确方法（所以每个类都有自己的`somedata`dict）——但是什么时候需要这种行为呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-15T22:27:18.713

你是对的，`somedata`在类的所有实例及其子类之间共享，因为它是在类*定义*时创建的。线条

```
somedata = {}
somedata['was_false_in_base'] = False 
```

在定义类时执行，即在解释器遇到`class`语句时执行 -**而不是**在创建实例时执行（想想 Java 中的静态初始化程序块）。如果类实例中不存在属性，则检查类对象的属性。

在类定义时，您可以运行任意代码，如下所示：

```
 import sys
 class Test(object):
     if sys.platform == "linux2":
         def hello(self):
              print "Hello Linux"
     else:
         def hello(self):
              print "Hello ~Linux" 
```

在 Linux 系统上，`Test().hello()`将打印`Hello Linux`，在所有其他系统上，其他字符串将被打印。

相反，在*实例化*`__init__`时创建的对象仅属于实例（当它们被分配给时）：*`self`*

 *```
class Test(object):
    def __init__(self):
        self.inst_var = [1, 2, 3] 
```

在许多情况下，在类对象而不是实例上定义的对象可能很有用。例如，您可能希望缓存类的实例，以便可以共享具有相同成员值的实例（假设它们应该是不可变的）：

```
class SomeClass(object):
    __instances__ = {}

    def __new__(cls, v1, v2, v3):
        try:
            return cls.__insts__[(v1, v2, v3)]
        except KeyError:
            return cls.__insts__.setdefault(
               (v1, v2, v3), 
               object.__new__(cls, v1, v2, v3)) 
```

大多数情况下，我将类体中的数据与元类或通用工厂方法结合使用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-15T22:40:10.013

请注意，您看到的部分行为是由于`somedata`是 a `dict`，而不是像 a 这样的简单数据类型`bool`。

例如，看看这个不同的例子，它的行为不同（尽管非常相似）：

```
class the_base_class:
    somedata = False

class subclassthing(the_base_class):
    def __init__(self):
        print self.somedata

>>> first = subclassthing()
False
>>> first.somedata = True
>>> print first.somedata
True
>>> second = subclassthing()
False
>>> print first.somedata
True
>>> del first
>>> del second
>>> third = subclassthing()
False 
```

这个例子的行为与问题中给出的不同的原因是因为这里`first.somedata`被赋予了一个新值（对象`True`），而在第一个例子中`first.somedata`（以及其他子类实例）引用的 dict 对象正在被修改。

有关进一步说明，请参阅 Torsten Marek 对此答案的评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T22:55:23.133

我认为理解这一点（以便您可以预测行为）的最简单方法是意识到您`somedata`是该类的属性，而不是该类的实例，如果您以这种方式定义它。

实际上始终只有一个`somedata`，因为在您的示例中，您没有分配给该名称，而是使用它来查找字典，然后为其分配一个项目（键，值）。这是一个陷阱，它是 python 解释器工作方式的结果，一开始可能会令人困惑。

# sql - 替换空值的 SQL 查询。

> ID：206735
> 
> 赞同：2
> 
> 时间：2008-10-15T22:18:17.000
> 
> 标签：sql, null

我需要一个从下表中返回 ContactDate、SortName、City、ContactType 和 Summary 的 SQL 查询。如果任何值为空，我需要它返回文本“No Entry”。

**联系表**

*   *联系人 ID*
*   联系日期
*   用户身份
*   概括
*   联系人类型
*   排序名称

**用户表**

*   *用户身份*
*   名
*   姓
*   地址ID

**地址表**

*   *地址ID*
*   城市
*   街道
*   状态
*   压缩

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-15T22:23:07.943

```
SELECT COALESCE(CAST(CONVERT(VARCHAR(10), ContactTable.ContactDate, 101) AS VARCHAR(10)), 'No Entry') AS ContactDate,
       COALESCE(ContactTable.SortName, 'No Entry') AS SortName,
       COALESCE(AddressTable.City, 'No Entry') AS City,
       COALESCE(ContactTable.ContactType, 'No Entry') AS ContactType
FROM ContactTable
LEFT OUTER JOIN UserTable ON ContactTable.UserID = UserTable.UserID
LEFT OUTER JOIN AddressTable ON UserTable.AddressID = AddressTable.AddressID 
```

[这](http://www.blackwasp.co.uk/SQLDateTimeFormats.aspx)是上面 CONVERT 语句的 SQL DateTime 格式图表。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T22:25:21.307

COALESCE() 在任何值得盐分的平台上。

确保处理铸造问题。

如：

```
--(SQL Server)
SELECT
  C.ContactID,
  COALESCE(CAST(CONVERT(varchar(10), C.ContactDate, 101) AS varchar(10), 'No Entry') AS ContactDate,
  COALESCE(SorName, 'No Entry') AS SortName 
```

等等等等

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T22:23:37.147

```
SELECT 
  ISNULL(ContactDate, 'No Entry') AS ContactDate
FROM Table 
```

使用 ISNULL 非常简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T00:26:52.077

该函数的 Oracle 版本称为`nvl`. 用法相同—— `SELECT nvl(col_name, desired_value) FROM foo`。

更通用的版本是`decode`，它具有三个参数，并允许您指定要执行替换的列值（因此您可以将所有 'Johnny' 替换为 'John' 或其他内容）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T00:20:45.553

使用“ **IIF** ”是一种 Access DB 解决方案，但可能适用于其他 DB。

```
SELECT IIF(IsNull(Foo), 'No Entry' ,Foo), IIF(IsNull(Bar), 'No Entry' ,Bar) From TableName 
```

函数 IIF 返回 2 个值之一，具体取决于表达式的评估。
SQL 语法：IIF( 表达式, true-value1, false-value )

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T02:16:44.197

您还可以对每一列进行不同的调用。这将需要更多的个人调用，但如果您没有很多行要更新，它可能会更快。

```
更新联系人表
设置 ContactDate = '无条目'
其中 ContactDate 为空；

```

对每一列重复。

# ms-access - MS-access 报告 - 在任何记录中都找不到搜索键 - 保存时

> ID：206736
> 
> 赞同：20
> 
> 时间：2008-10-15T22:18:28.217
> 
> 标签：ms-access

偶尔我的 MS Access 报告：

> 在任何记录中都找不到搜索键

发生这种情况后，解决方案是关闭 Access，压缩并修复后端，然后删除记录。

是什么原因造成的，我该如何避免？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-06-20T21:45:02.547

这可能是我的菜鸟错误，但它仍然导致错误消息。我正在导入一个 excel 电子表格，并且在字段标题前有一个空格。删除空间后，导入的文件没有问题

**注意：**只有在 Excel 中查看文件时才会出现空格；当 Access 尝试导入时，对话框摆脱了空间，但空间仍然会导致问题。我经过惨痛的教训才学到这个...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T08:27:28.830

您没有提及您正在使用的 Access 版本。微软在 2000 年报告了一个错误：

BUG：当您在 Access 2000 中压缩数据库或保存设计更改时，您会收到“在任何记录中找不到搜索键”错误消息

[http://support.microsoft.com/kb/301474](http://support.microsoft.com/kb/301474)

如果这不是您的问题，以下是 Microsoft Access MVP Tony Toews 的一个非常全面的常见问题解答：

损坏的 Microsoft Access MDB 常见问题解答

[http://www.granite.ab.ca/access/corruptmdbs.htm](http://www.granite.ab.ca/access/corruptmdbs.htm)

如果问题不断出现，则需要查找表损坏的原因，您会在上面的站点链接中找到一些跟踪原因的建议。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-03T01:21:18.303

对我来说，问题是在一个列标题之前有一个空格。一旦我解决了这个问题，就没有更多的问题了

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-29T14:31:39.470

Excel 中列名中的任何空格都会对我造成错误。一旦我删除了任何空格，它就会毫无问题地导入。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-25T17:23:42.407

问题是由于标题（标题）中的空格。删除所有标题中的空格，它工作正常。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-24T04:02:10.720

此错误的另一个潜在原因是[Sandbox Mode](http://office.microsoft.com/en-us/access-help/use-sandbox-mode-in-access-2007-HA010167429.aspx "在 Access 2007 中使用沙盒模式")，它会阻止 MS Access 运行某些被认为不安全的语句。这可以通过设置以下注册表项来禁用...

```
HKLM\Software\Microsoft\Office\12.0\Access Connectivity Engine\Engines
    SandboxMode (DWORD Value) 
```

...到 0 或 2：

```
SETTING DESCRIPTION
   0    Sandbox mode is disabled at all times.
   1    Sandbox mode is used for Access, but not for non-Access programs.
   2    Sandbox mode is used for non-Access programs, but not for Access.
   3    Sandbox mode is used at all times. This is the default value. 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-13T15:49:23.790

我在 Excel 工作表的一个标题（标题）中找到了一个空格。一旦我删除了名称前的空格，它就顺利进行了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-18T14:41:16.977

还要检查数据库版本。我在 Access 2010 中遇到了 VBA CreateDatabase(sTempDBName, dbLangGeneral) 的问题，我正在使用 2003 数据库尝试链接 2010 数据库中的表。当我手动尝试链接时，我收到一条关于不支持链接到更高版本的消息。创建我试图使用选项 dbVersion40 "CreateDatabase(sTempDBName, dbLangGeneral, dbVersion40)" 链接到的临时数据库解决了它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T07:56:03.827

这些是我遵循的步骤可能对您有用，

1.  转到菜单-工具-数据库实用程序-压缩和修复数据库。

2.  修复数据库时删除或更新该记录。

3.  它工作正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-19T15:54:41.377

此错误的另一个可能原因是工作组文件不匹配。也就是说，如果您尝试将受保护（或部分受保护）的 MDB 与工作组文件一起使用，而不是用于保护它的工作组文件，您可能会触发错误（我自己在几年前使用 Access 2000 就看到过）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-14T15:32:30.630

是的，我和 user2315734... 有同样的问题“在任何记录中都找不到搜索键”，其中 Access db 在本地驱动器上，但我导入的 Excel 文件在网络驱动器上; 在尝试了上述大多数建议后，最后也**将 Excel 文件移动到本地驱动器来**解决它。

谢谢大家。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-24T13:24:16.800

我还收到消息“在任何记录中都找不到搜索键”。当我将我的数据库从网络驱动器移动到我的桌面时，一切都运行得更快更顺畅。我没有再遇到同样的错误。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-31T17:10:22.700

这是您在 Excel 中的一个标题的问题。从其他来源复制粘贴时，我得到了这个。修复您的标题，它应该可以解决问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-08-17T03:54:30.000

继@Wilf 的回答之后，我试图导入一个在其中一个标题中有空格的电子表格，我将其删除。我检查了前导和尾随空格，但仍然遇到同样的问题 - 直到我从最后一个真正的标题单元格中使用 Ctrl-Right，并在第一行发现另一个看起来空白但显然包含一些空格的单元格。删除后，我的导入工作。谢谢指点：）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-10-03T12:30:10.100

我知道这是一篇非常古老的帖子，但是当我在运行命令时正在寻找针对同一错误的其他解决方案时（我以前遇到过 Excel wb 标头中的空格并在每次文件更新时都使用 VBA 进行了补救，所以我知道不是那样）。我考虑了 xlsm 文件和 DB 位于不同的网络驱动器上的事实，但不想探索移动一个，除非这是我最后的手段。

我试图手动运行保存导入，它就在我面前。包含 xlsm 文件的文件夹已重命名....我将名称改回以匹配我保存的导入和....smh，一直都是这样。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2010-08-26T14:17:17.703

在 Access 2007 中，当导入具有相同列标题的两个字段的 Excel 文件时会发生此错误。

# c# - 有什么方法可以在 Sql Profiler 或类似工具中获取 .net 堆栈跟踪？

> ID：206743
> 
> 赞同：5
> 
> 时间：2008-10-15T22:20:25.857
> 
> 标签：c#, .net, sql-server, profiling, profiler

在我之前的工作中，我设计并帮助构建了一个运行时（生产）[Profiler 工具](http://www.samsaffron.com/blog/archive/2007/05/11/15.aspx)，该工具在其他很酷的功能中能够为我执行的每个 SQL 语句提供 .Net 堆栈跟踪。把它想象成 steroids 上的 SQL-Server Profiler。因此，您不仅可以看到 SQL 语句和持续时间，还可以获得 SQL 执行的上下文。在开发以数据库为中心的应用程序时，我发现这些信息是天赐良机。

问题是，由于这是我以前的公司开发的，已被赛门铁克收购，虽然该工具仍然可以下载，但很不清楚许可是什么，也不是 Symnatec 销售的 SKU。

我想知道是否有人知道任何类似的工具可以为我的 SQL 语句执行提供堆栈跟踪？

[alt 截图 http://img151.imageshack.us/img151/4357/profiler1jz3.gif](http://img151.imageshack.us/img151/4357/profiler1jz3.gif)

这仍然没有答案，ANTS et el 不这样做，考虑只是回答“否”并接受它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T12:32:09.863

I am not sure if it will do excatly what you need but the best profiling tool i have found for .Net is [ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm), If i remember it will show you the SQL and also all the .net calls.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T02:41:03.860

我们最近启动了一个名为[dynaTrace](http://www.dynatrace.com/en/)的工具。有一个工作站版本可以在一个机器上使用，还有一个服务器/代理版本可以在多个机器上运行。

基本上，您针对特定应用程序（或 IIS）设置该工具。之后，它将收集对其进行检测的方法调用。在您的场景中，您可能会针对整个命名空间进行检测并获取所有内容。

基本上，它然后使用 IL 注入跟踪每个方法调用。它通过检测 ADO.Net 来获取数据库调用，包括 SP 中的绑定变量。它显然也可以跨 Web 服务调用进行跟踪。

这很酷，因为您可以查看特定方法，查看调用该方法的所有路径，或查看对方法的所有调用。您可以查看特定的数据库调用，并查看该调用的所有代码路径。

它太酷了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-22T16:16:26.540

我在这里发布了一个答案，它汇集了来自几个帖子的信息，以及一个可用作 MySQL 的穷人查询监视器的应用程序：

[如何查看实时 MySQL 查询？](https://stackoverflow.com/questions/568564/how-can-i-view-live-mysql-queries/9398566#9398566)

# .net - FxCop 的 CollectionPropertiesShouldBeReadOnly 规则是否与 spring 框架不兼容？

> ID：206746
> 
> 赞同：2
> 
> 时间：2008-10-15T22:21:07.400
> 
> 标签：.net, fxcop, spring.net

FxCop 有[CollectionPropertiesShouldBeReadOnly 规则](http://msdn.microsoft.com/en-ca/ms182327.aspx)，如果你的类有某种客户可以设置的集合属性，它会抱怨。相反，它建议将属性设为只读并提供 Clear() 方法和 Add() 或 AddRange() 方法来更改集合的内容。

我同意这会产生一个更清洁、更可控的界面，但我正在努力使该界面与 Spring 框架一起工作。如果我想用协作者集合配置一个对象，我必须公开一些集合属性来注入协作者。我查看[了 Spring 文档](http://springframework.net/docs/1.1.2/reference/html/index.html)，但看不到任何方法可以告诉 Spring 调用 AddRange() 方法，我是否遗漏了什么？

现在，我将排除警告，并说明它是 Spring 配置所必需的。

**更新：**因为在过去的两个月里我没有在这里吃任何东西，所以我在[FxCop 论坛](http://social.msdn.microsoft.com/Forums/en-US/vstscode/thread/1f9c8929-01eb-4388-89e8-8462b61975f1)上发布了同样的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T20:21:55.760

如果集合属性仅暴露了一个 getter，我们将假定您列出的 FxCop 推荐模式已被使用并添加到集合中。还支持第一种模式。

对于泛型集合，这仅在暴露的属性是 IList 类型时才有效。我们在下一个版本中有一个[JIRA 问题](http://jira.springframework.org/browse/SPRNET-878)来解决这个问题。顺便说一句，这是基类库中非常常见的模式（您可能知道......）这是我们第一次遇到需要在 .NET 1.1 中支持这种风格的地方（不受上面列出的限制） .

干杯，马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-28T23:27:43.953

问题有你想的那么严重吗？我的理解是，如果您有这样的读/写属性，FxCop 会抱怨：

```
public List<Foo> Items { get; set; } 
```

...因为您班级的用户将能够做到这一点：

```
myInstance.Items = new List<Foo>(); 
```

显然，您不希望您班级的用户完全重新分配列表。因此，FxCop 推荐这种模式：

```
private List<Foo> _items = new List<Foo>();
public List<Foo> Items { get { return _items; } } 
```

所以现在你的类的用户只能从你的列表中添加和删除项目，而不是用一个新的 List 实例覆盖它。

Spring.NET 如何实现它的集合属性？他们真的像我的第一个例子那样读/写吗？如果是这样，看看他们对这种模式的用例会很有趣，因为它看起来不正确。

# mysql - MySQL自动增量列跳了10-为什么？

> ID：206751
> 
> 赞同：44
> 
> 时间：2008-10-15T22:23:07.320
> 
> 标签：mysql

我有几个表，我在其中创建了一个对象 ID 作为 Int 或 Bigint，在这两种情况下，它们似乎都自动递增 10（即，第一个插入是对象 ID 1，第二个是对象 ID 11，第三个是是对象 ID 21 等）。两个问题：

1.  为什么这样做？

2.  那是问题吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2015-08-12T15:05:21.077

请不要更改`auto_increment_increment`. ClearDB 是故意这样做的。[文档](https://www.cleardb.com/developers/help/faq#general_16)中对此进行了解释：

> ClearDB 使用循环复制来提供 master-master MySQL 支持。因此，必须配置某些东西，例如 auto_increment 键（或序列），以便在所有情况下一个主控器不使用与另一个主控器相同的键。为此，我们将 MySQL 配置为跳过某些键，并强制 MySQL 为使用的每个键使用特定的偏移量。我们之所以使用 10 而不是 2 的值是为了以后的发展。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-15T22:28:42.020

检查以查看自动增量的种子值未设置为 10。

您可以通过以下方式检查：

```
SELECT Auto_increment FROM information_schema.tables WHERE table_name='the_table_you_want'; 
```

如其他地方所述，您可以使用系统变量 @@set_auto_increment_increment 进行更改

```
SET @@auto_increment_increment=1; 
```

如果你想从一个数字以外的数字开始值，你可以去：

```
ALTER TABLE tbl AUTO_INCREMENT = 100; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-12-13T02:25:22.673

感谢@Jim Fiorato 提供链接。

要检查自动增量值增加了多少，请使用以下查询：

```
SHOW VARIABLES LIKE 'auto_inc%';

+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| auto_increment_increment | 10    |
| auto_increment_offset    | 4     |
+--------------------------+-------+ 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-15T22:31:45.490

自动增量增量值在 MySQL 系统变量中设置。

见这里： [http ://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#option_mysqld_auto-increment-increment](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#option_mysqld_auto-increment-increment)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-07T22:38:02.797

如果在未创建记录的情况下使用带有 IGNORE 属性的插入，则自动增量值可能会跳转

```
insert IGNORE into my_table set column=1 
```

# php - WYSIWYG 网页编辑器用于 php web 开发

> ID：206763
> 
> 赞同：1
> 
> 时间：2008-10-15T22:26:02.710
> 
> 标签：php, wysiwyg

我正在制作一个小型 php 网站。我发现在 WYSIWYG 网页编辑器中对页面进行原型设计或布局很有用。

我想获得有关在 php 开发管道中运行良好的 WYSIWIG 网页编辑器的建议。请分享您的最爱并描述您喜欢它们的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T22:35:16.857

我唯一使用的是 Dreamweaver，不能说我喜欢它，因为它显示的预览并不是它在浏览器中的实际外观。

Nvu应该是相当不错的。

我更喜欢在 IDE 中编辑，然后在真正的浏览器中查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T23:32:28.427

不幸的是，就 WYSIWYG 而言，我用过的最好的一个是 Dreamweaver，我也不太喜欢它，但它是许多网上商店工具集的标准部分，你只是习惯了它。

我目前使用 Aptana 进行这种原型设计，这并不是真正的 WYSIWYG，但具有出色的预览功能，而且我最终不必回头查看糟糕的 WYSIWYG 生成的标记并在以后清理它。

没用过Aptana的php部分（php不怎么做），但是有朋友好像很喜欢。JS 的东西很棒，CSS 编辑器也很不错。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T12:20:21.777

像许多 Web 开发人员一样，我很久以前就停止使用 WYSIWYG 编辑器，只是因为它们都不够好——而且我不相信它们中的任何一个（可能是 DreamWeaver，我不确定）来保护 PHP。

但最近我发现自己更愿意使用现有的软件。我已经交付了几个基于 WordPress 的公司网站，它为客户的页面提供了所见即所得的编辑器，同时仍然让我可以自由地编写代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T23:40:19.830

如果您想使用 WYSIWYG 编辑器，我建议您仅使用它来创建初始布局。一旦开始将 PHP 添加到页面中，编辑器就不可能准确地显示页面的外观。因此，此时，您应该开始在文本编辑器中手动编辑它。

如果您使用某种模板系统，您可以简化此操作。这可能是一个真正的模板引擎，如 Smarty，但它不是必须的。这个想法很简单，除了打印数据和控制语句（循环等）之外，尽可能多地保留 HTML 文件之外的 PHP。然后包含主脚本中的文件，它会完成所有繁重的工作。这样，如果您的设计发生变化，使用 WYSIWYG 编辑器创建新模板会更容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T01:11:18.353

我喜欢 Dreamweaver MX（及更高版本），因为它提供纯文本实用程序的代码完成功能，专注于手动编码，具有您可能希望快速编码页面的 WYSIWYG 功能。我也恰好喜欢它针对 IE、Netscape 等的 HTML 兼容性检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T01:38:42.277

我更喜欢 BBEdit 来开发任何网络，但您可以尝试 phpDesigner 2008：[http](http://www.mpsoftware.dk/phpdesigner.php) ://www.mpsoftware.dk/phpdesigner.php （适用于 PC）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T03:24:35.197

我发现键入所有内容（使用支持代码完成的文本编辑器）然后在浏览器上进行测试而不是使用所见即所得，遇到问题（“嗯，为什么看起来不同？”）并清理源代码会更快稍后编码。

当然，如果您对 HTML / CSS 有点陌生，那么坚持一段时间的 WYSIWYG 可能是一个不错的选择。

就个人而言，我发现 Adob​​e Dreamweaver CS3 对两者都足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T03:31:39.067

好吧，如果你问我，在利用 MS Frontpage 的功能（我之前使用过）之后，dreamweaver 仍然是目前最好的所见即所得

虽然今天我不再真正使用任何所见即所得的编辑器，因为我不再相信他们可以提供干净的标记......我现在使用的是记事本++，它的免费和开源，很像 unix 的记事本，但是嘿，它不再是所见即所得了纯文本编辑器

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-16T11:29:32.253

Dreamweaver 可能是最好的。不幸的是，没有与 DW 相比的开源替代品（我知道）。我之前尝试过 Kompozer (Nvu)，它非常轻巧，而且可以胜任。值得一试。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-25T09:22:21.493

TinyMCE 是一个免费的轻量级 Dreamweaver 替代方案，可以构建有效的 XHTML 代码。文本引擎在[netEditr.com](http://neteditr.com)上运行。您还可以使用那里的代码编辑器草绘一些 PHP 代码，只需在语法中选择 PHP 进行语法着色。

# mysql - 流行的 MySQL RSS 提要

> ID：206764
> 
> 赞同：1
> 
> 时间：2008-10-15T22:26:11.913
> 
> 标签：mysql, rss

你们有什么流行的 Mysql RSS 提要可以推荐吗？IBM 有随机文章，但这些通常还不够

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T23:33:23.933

Planet Mysql 是一个显而易见的答案。这是一个博客聚合器。当然，还有其他站点未包含在此聚合中，但这个站点比任何其他单个站点都多。

[http://www.planetmysql.org/rss20.xml](http://www.planetmysql.org/rss20.xml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T22:54:33.603

[http://www.mysqlperformanceblog.com/feed/](http://www.mysqlperformanceblog.com/feed/)

[http://www.mysqlperformanceblog.com](http://www.mysqlperformanceblog.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T03:16:05.370

[http://dev.mysql.com/](http://dev.mysql.com/)有开发者文章的提要。

# asp.net - 实现混合 ASP.NET 表单身份验证（AD + DB）的最佳方法是什么？

> ID：206767
> 
> 赞同：1
> 
> 时间：2008-10-15T22:27:36.700
> 
> 标签：asp.net, authentication, active-directory

我想在 ASP.NET 网站上实现表单身份验证，该站点应在数据库上寻找用户以获取一些数据，然后针对 LDAP（Active Directory）进行身份验证以验证用户/密码组合。

之后，我需要保留一个代表用户的类实例，以便以各种形式使用它。

我之前尝试使用登录控件来执行此操作，该控件检查先前的条件并执行`AuthenticateEventArgs.Authenticated = true`并将对象放置在会话中：`Session ["user"] = authenticatedUser;`但是我在同步它们时遇到了问题（会话在 auth cookie 之前过期，并且当页面出现 NullReferenceExceptions试图使用现已失效的会话对象）。

实现这一目标的最佳方法是什么？有什么方法可以将会话超时与 cookie 寿命同步？用户对象应该以任何其他方式保存？我错过了重点吗？

**更新：我不能使用 Windows 身份验证提供程序，因为该站点应该可以从外部网络访问。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T22:29:33.797

我将使用 Windows 身份验证作为主要的身份验证提供程序，但使用我自己的简单数据库持久性来获取用户信息。

您的会话方法可以工作，您可以在 IIS 中调整会话超时并将其与身份验证 cookie 超时相匹配。

此外，您可以在 HTTPModule 中执行类似的操作来捕获也清除会话的边缘情况（应用程序池回收等）

伪代码：

```
if (session["user"] == null)
{
    Authentication.SignOut();
} 
```

这将强制用户进行身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T00:09:38.507

我将会话和身份验证 cookie 超时值设置为相同的值。我为我的身份验证 cookie 使用滑动窗口。我还养成了一个习惯，即在尝试使用它们之前，永远不要假设我从会话中得到的值是非空的。我经常将所有会话功能抽象到一个代理类中，该代理类包含我存储在会话中的值的强类型属性。错误会话数据的错误处理在代理中本地化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T08:45:15.627

在会话中存储用户信息可以正常工作。要同步会话超时和身份验证 cookie 超时，只需编辑您的 web.config：

```
<sessionState timeout="XX" />
<authentication mode="Forms">
  <forms loginUrl="Login.aspx" timeout="XX" />
</authentication> 
```

这两个值都以分钟为单位。

每次从 Session 获得值时测试 null ！

# css - 如何在页眉和页脚 div 之间居中内容？

> ID：206770
> 
> 赞同：4
> 
> 时间：2008-10-15T22:28:46.043
> 
> 标签：css, html

在上一个问题中，我学习了如何在页面底部保留页脚 div。（[见其他问题](https://stackoverflow.com/questions/206652/how-to-create-div-to-fill-all-space-between-header-and-footer-div)）

现在我正在尝试将页眉和页脚 div 之间的内容垂直居中。

所以我得到的是：

```
#divHeader
{
    height: 50px;
}

#divContent
{
    position:absolute;
}

#divFooter
{
    height: 50px;
    position:absolute;
    bottom:0;
    width:100%;
}
<div id="divHeader">
    Header
</div>
<div id="divContent">
    Content
</div>
<div id="divFooter">
    Footer
</div> 
```

我尝试创建一个父 div 来容纳现有的 3 个 div，并为该 div 提供一个垂直对齐：中间；但这让我无处可去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T18:34:24.160

在 CSS2 中：

```
html,body {height:100%;}
body {display:table;}
div {display:table-row;}
#content {
    display:table-cell;
    vertical-align:middle;
} 
```

&

```
<body>
<div>header</div>
<div id="content">content</div>
<div>footer</div>
</body> 
```

[http://codepen.io/anon/pen/doMwvJ](http://codepen.io/anon/pen/doMwvJ)

在旧的 IE (<=7) 中，您必须使用 marxidad 提到的绝对定位技巧。

在最新的浏览器中[，您可以使用 flexbox 代替](http://flexboxin5.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T22:50:56.873

或者，据我记得，您可以使用这样的技巧[（](http://www.jakpsatweb.cz/css/priklady/vertical-align-final-solution-en.html)更多信息[在这里](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T22:44:44.170

您需要设置`height`div 以填充整个内容区域，或者其坐标必须位于中心。类似的东西，`top:50%; left:50%`但当然会使 div 有点偏离右下角。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-16T01:52:55.290

也许尝试：

```
#div标头
{
    高度：50px；
}

#div内容
{
    /*位置：绝对；*/
    宽度：900px；
    左边距：自动；
    边距右：自动；
}

#div 页脚
{
    高度：50px；
    位置：绝对；
    底部：0；
    宽度：100%；
}

```

# c# - 如何从任何打开的浏览器中的任何选项卡获取 URL

> ID：206775
> 
> 赞同：2
> 
> 时间：2008-10-15T22:29:58.473
> 
> 标签：c#, sharepoint, url

我正在尝试检测用户现在正在查看的共享点中的哪个网站。一种方法是从浏览器读取 URls，并尝试将它们与共享点解决方案的参考 URL 进行比较。我还没有找到任何适用于 IE 和 Firefox 的解决方案。

这个想法是编写一个小型 C# 应用程序来收集 URL 并进行比较。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T22:51:36.620

可以使用 Win32 API 函数 FindWindow 以一种非常笨拙且容易损坏的方式执行此操作。

以下 C++ 示例查找 Windows Calculator 的运行实例并获取其中的编辑字段的值。您应该能够在 C# 中执行类似的操作。免责声明：抱歉，我实际上并没有检查以确保此代码可以编译。:)

```
float GetCalcResult(void)
{
    float retval = 0.0f;

    HWND calc= FindWindow("SciCalc", "Calculator");
    if (calc == NULL) {
        calc= FindWindow("Calc", "Calculator");
    }
    if (calc == NULL) {
        MessageBox(NULL, "calculator not found", "Error", MB_OK);
        return 0.0f;
    }
    HWND calcEdit = FindWindowEx(calc, 0, "Edit", NULL);
    if (calcEdit == NULL) {
        MessageBox(NULL, "error finding calc edit box", "Error", MB_OK);
        return 0.0f;
    }

    long len = SendMessage(calcEdit, WM_GETTEXTLENGTH, 0, 0) + 1;
    char* temp = (char*) malloc(len);
    SendMessage(calcEdit, WM_GETTEXT, len, (LPARAM) temp);
    retval = atof(temp);
    free(temp);

    return retval;
} 
```

为了找出在 FindWindow 和 FindWindowEx 中使用的正确参数，请使用 Visual Studio 工具 Spy++ 检查浏览器窗口的运行实例。抱歉，我手头没有 Web 浏览器的代码示例，但应该可以。请注意，您的解决方案将特定于 Windows 操作系统，并且在未来版本的 Web 浏览器中对 UI 架构的更改可能会导致您的解决方案停止工作。

使用这种方法将 URL 直接从地址栏中取出显然仅适用于当前选项卡。除非您做了一些非常棘手的事情，例如模拟用户输入以循环浏览选项卡，否则我看不出这对所有选项卡有何作用。这将是非常侵入性的，用户可以很容易地通过输入他们自己的输入来打断您的应用程序，但如果您正在编写一些无人看管的东西（例如自动化测试脚本），它可能会起作用。如果是这种情况，您可能需要研究其他工具，例如[AutoIt](http://www.autoitscript.com/autoit3/)。

这个建议是从我曾经写过的[一篇博客文章中转述的。](http://www.elenkist.com/bushido_burrito/blog/?p=15)祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T12:47:15.853

在 IE 中使用 Javascript 中的 ActiveX shell 应用程序对象相当容易。下面是示例代码：

```
function GetURL()
{
 var oShell = new ActiveXObject('shell.application');
 var oColl = oShell.Windows();
 for (var i = 0;i<oColl.count;i++)
 {
  try
  {
   var Title = oColl(i).document.title;
   if (Title.indexOf('DesiredTitle') != -1)
   {
    alert ('Title-'+oColl(i).document.title);
    alert ('Location-'+oColl(i).location);
   }
  }
  catch (err)
  {
   alert (err);
  }
 }
} 
```

我仍在尝试在Firefox中找到一种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T22:34:09.137

你不太可能找到这样的答案。所有现代浏览器都限制页面上的 JavaScript 访问此类信息的能力，因为它给用户带来了如此大的隐私风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T15:12:24.847

就在我的脑海中，您可能会考虑使用内置的 Firefox 语言（不知道它叫什么）。我敢肯定它提供了一种机制来完全按照您所说的进行操作。否则那些为美味等而编写的插件将无法正常工作。

至于 IE，您将需要在 C++ 中执行此操作，或者为此找到一些托管包装器。我不知道如何制作一个 IE 插件，但如果你深入挖掘，你应该能够找到一些东西。

干杯!

# caching - 浏览器何时自动清除外部 JavaScript 文件的缓存？

> ID：206783
> 
> 赞同：50
> 
> 时间：2008-10-15T22:33:32.103
> 
> 标签：caching, browser

我有一个可以随时编辑的 JavaScript 资源。一旦它被编辑，我希望它能够相对快速地传播到用户的浏览器（大概 15 分钟左右），但是，这个资源的编辑频率很少而且相差很远（可能一个月 2 次）。

我宁愿将资源缓存在浏览器中，因为它会被频繁检索，但我也希望缓存以半定期的时间间隔在浏览器上重置。

我知道我可以在请求资源时传递 no-cache 标头，但我想知道如果我没有传递 no-cache，缓存何时会在浏览器上自动重置。

我想这对于每个浏览器都是独立的，但我不确定。

我试图用谷歌搜索这个，但我发现的大部分点击都是关于清除浏览器的缓存......这不是我想要的。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-16T09:04:13.157

您可以将版本字符串作为 get 参数传递给脚本标签的 URL。该参数不会由静态 JavaScript 文件评估，但会强制浏览器获取新版本。

如果您不想在每次编辑源代码时都分配版本字符串，您可以根据文件系统时间戳或您的颠覆提交号来计算它：

```
<script src="/script.js?time_stamp=1224147832156" type="text/javascript"></script>
<script src="/script.js?svn_version=678" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-15T22:35:52.473

在您的 javascript 代码上放置一个这样的版本，当您进行更改时会更新

```
<script src="/code.js?ver=123" type="text/javascript"></script> 
```

然后他们将始终获得新版本。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-15T22:48:10.233

HTTP 为浏览器以不同方式忽略的缓存提供了几个控件。如果您设置了一个合理的到期日期，大多数浏览器都会检查它们是否具有当前版本的适当频率。

您要在此处包含的搜索词（以避免浏览器用户说明）是 HTTP。

有关更多信息，请参阅：

*   [Web 作者和网站管理员的缓存教程](http://www.mnot.net/cache_docs/)
*   [Web 缓存](http://www.web-caching.com/mnot_tutorial/how.html)的工作原理（有点旧，但仍然有用）。
*   [HTTP/1.1：HTTP 中的缓存](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)

# binary - 有什么方法可以减小 Sybase 数据库的转储文件大小？

> ID：206787
> 
> 赞同：0
> 
> 时间：2008-10-15T22:35:26.467
> 
> 标签：binary, size, sybase

当我转储一个 Sybase 数据库时，表中是否有数据似乎并不重要，文件大小是相同的。有人告诉我，这是因为我的转储文件是二进制而不是逻辑的，因此转储文件的文件基于数据库的分配大小。我知道 Oracle 可以使用逻辑转储文件，但我可以让 Sybase 做类似的事情，还是有任何其他偷偷摸摸的方法来减小转储文件的大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T05:57:54.463

如果您已经在使用 compress_level 9 并且仍需要更多压缩，则可以使用 bzip2 重新压缩文件。

如果您只是简单地 bzip2 压缩文件，您将获得约 10% 的改进。如果您解压缩并重新压缩，您可能会看到 30% 范围内的改进。但请记住，您必须再次解压缩和/或 gzip 文件，以便 Sybase 加载它。

```
gunzip -c pubs_1.dmp | bzip2 > pubs.dmp.bz2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T20:25:17.583

从版本 12 左右开始，您已经能够在 ASE 中执行压缩转储。

[语法是：](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.sag2/html/sag2/sag2473.htm) dump database database_name to file_name [ with compression=compress_level]

compress_level 为 0-9。0 为无压缩，9 为最多。运行转储时压缩的越多，CPU 使用率就越高。您只需要执行一些测试即可找到大小与性能的适当平衡。

加载转储不需要特殊命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T08:59:25.290

虽然上面的链接（语法是）显然是正确的，因为它指向 sybase 文档，但注释具有误导性。

简单格式的语法是：

将数据库 {database_name} 转储到“compress::{#compression_level}::{stripe_device}”

例如：将数据库 mydb 转储到“compress::1::/sybase_dumps/mydb_17022009”

在加载数据库转储方面 ::compress; 需要再次给出选项。

例如。从“compresss::/sybase_dumps/mydb_17022009”加载数据库 mydb

请注意，不需要压缩级别，也不需要额外的分隔冒号。

找到平衡的测试是一个好点，记住你走的越高，预计转储需要的时间就越长。我发现1-3绰绰有余，我从来没有超过6，收益递减不值得。

如果我很绝望，我会按照上面的描述对文件进行 bzip2 压缩{点收入}。如果这是生产主机，我会将文件发送到另一台主机并执行此操作。资源命中可能相当大。

# windows - 为什么在我尝试过的每个 XAMPP 安装中 xdebug 都会使 apache 崩溃？

> ID：206788
> 
> 赞同：10
> 
> 时间：2008-10-15T22:35:42.613
> 
> 标签：windows, apache, crash, xampp, xdebug

我在三台不同的计算机上安装了 Windows XAMPP 包，其中两台运行 Windows Vista 32 位（1 台 Ultimate / 1 台 Home Premium），1 台运行 Windows Vista 64 Home Premium。

在 php.ini 中启用 xdebug 并重新启动 apache 后，查看默认的 XAMPP localhost 索引会导致 apache 每次都以相同的方式崩溃，并报告“php_xdebug.dll”作为故障模块名称。

这是来自 Windows Crash Reporter 的完整报告：

```
Problem signature:
Problem Event Name: APPCRASH
Application Name:   apache.exe
Application Version:    2.2.9.0
Application Timestamp:  4853f994
Fault Module Name:  php_xdebug.dll
Fault Module Version:   2.0.3.0
Fault Module Timestamp: 47fcd9b9
Exception Code: c0000005
Exception Offset:   00008493
OS Version: 6.0.6001.2.1.0.768.3
Locale ID:  1033
Additional Information 1:   a34a
Additional Information 2:   c9c5f4fd744690d388ab9d5b3eb051a7
Additional Information 3:   cb2e
Additional Information 4:   650bb5690556a17e911375b94d3e16f0 
```

我试过用谷歌搜索这个问题，但没有找到任何解决方案，只报告了类似的错误。

编辑：我为 php_xdebug.dll 启用了扩展行，到目前为止似乎已经停止了崩溃。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T10:07:01.210

我正在使用 xDebug 在我的 Win7 机器上运行适用于 Windows 版本 1.7.1 的 XAMPP，它运行良好。

检查您是否安装了 SP1，然后按照[以下说明操作](http://docs.joomla.org/Setting_up_your_workstation_for_Joomla!_development#Edit_PHP.INI_File)：

1.  找到包含的行`implicit_flush`并将其设置如下：

    `implicit_flush = On`

2.  找到被调用的部分`[Zend]`并通过在每行的开头放置一个分号（“;”）来注释掉所有的行。

3.  找到该行：`zend_extension = "c:\xampp\php\ext\php_xdebug.dll"`并取消注释。

4.  找到该`[XDebug]`部分并取消注释所有行（第一行是实际注释除外）。对于 Windows，它应该类似于以下示例：

    ```
    [XDebug]
    ;; Only Zend OR (!) XDebug
    zend_extension_ts="C:\xampp\php\ext\php_xdebug.dll"
    xdebug.remote_enable=true
    xdebug.remote_host=localhost
    xdebug.remote_port=10000
    xdebug.remote_handler=dbgp
    xdebug.profiler_enable=1
    xdebug.profiler_output_dir="C:\xampp\tmp" 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-14T00:39:19.473

我在互联网上寻找这个问题并尝试了很多解决方案，但都没有奏效。我尝试了这个配置，只是最后一次测试并为我工作，在 Eclipse 中更改 Windows/Preferences/PHP/Debug 并选择 Xdebug 作为 PHP 调试器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T22:58:55.450

确保您拥有最新版本的 xdebug？我在使用旧版本的 xampp 时遇到了同样的问题，下载了最新的 xdebug .dll，更改了 php.ini 中的映射，并且得到了很好的解决。

我花了几个小时才搞定.. grr

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-23T20:38:42.730

尤金适合我。

*   去[http://xdebug.org/download.php](http://xdebug.org/download.php)
    下载非线程安全的 dll 即 5.2 VC6 Non-thread-safe (32 bit)

*   将其保存到您的`\xampp\php\ext`目录中

*   打开你的 php.ini
    `C:\xampp\php\php.ini`

滚动到底部并查找`[XDebug]`和替换

```
zend_extension_ts="C:\xampp\php\ext\php_xdebug.dll" 
```

有了这个

```
zend_extension="C:\xampp\php\ext\php_xdebug-2.0.5-5.2-nts.dll" 
```

所以它看起来像这样：

```
[XDebug]
;; Only Zend OR (!) XDebug
zend_extension="C:\xampp\php\ext\php_xdebug-2.0.5-5.2-nts.dll"
xdebug.remote_enable=true
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.profiler_enable=1
xdebug.profiler_output_dir="C:\xampp\tmp" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T00:24:02.480

1.  打开 xampp\apache\bin 文件夹中的 php.ini（不在 xampp\php 文件夹中）。
2.  找到 extension=php_xdebug.dll 行。
3.  取消注释它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T12:59:48.207

我得到了一个适用于 Vista 的解决方案，使用上述组合，所以如果这对这里的任何人有帮助......

Eclipse Europa - 版本：3.3.2 内部版本号：M20080221-1800

XAMPP - win32 版本 1.6.8 安装程序

xdebug - php_xdebug-2.0.2-5.2.5.dll

~/xampp/apache/bin/php.ini 的内容

```
[Zend]
;zend_extension_ts = "C:\xampp\php\zendOptimizer\lib\ZendExtensionManager.dll"
;zend_extension_manager.optimizer_ts = "C:\xampp\php\zendOptimizer\lib\Optimizer"
;zend_optimizer.enable_loader = 0
;zend_optimizer.optimization_level=15
;;zend_optimizer.license_path =
; Local Variables:
; tab-width: 4
; End:

[XDebug]
;; Only Zend OR (!) XDebug
zend_extension_ts="C:\xampp\php\ext\php_xdebug-2.0.2-5.2.5.dll"
xdebug.remote_enable=true
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.profiler_enable=1
xdebug.profiler_output_dir="C:\xampp\tmp" 
```

对我来说绝对关键的一点......

```
;extension=php_xdebug-2.0.2-5.2.5.dll 
```

这是正确的 ！注释掉上面的行。

希望这可以帮助

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-02T02:24:37.650

安装新版本的 XAMPP

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-17T23:57:53.203

我找到了解决这个问题的方法。你可以在这里找到它：[http ://wiki.mpsoftware.dk/index.php?title=Tutorial_on_how_to_configure_Xdebug_to_work_with_phpDesigner_2008](http://wiki.mpsoftware.dk/index.php?title=Tutorial_on_how_to_configure_Xdebug_to_work_with_phpDesigner_2008)

问题是 XDebug 与 Zend 优化器不兼容，因此您需要注释 [Zend] 部分下的所有部分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T10:44:10.360

通过其他一些论坛，我发现了一个可能的提示 - 虽然 xampp 上的 apache 通常使用 apache/bin 目录中的 php.ini，但有些模块不使用。所以我玩弄了那个目录中的 php.ini （到目前为止，简单地将它移出对我有用的方式，如重命名/删除它）。至少可能想试一试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T15:08:28.810

PHP 通常只能有一个引擎级扩展。我目前在我的机器上使用最新的 xampp lite 包，带有 xdebug 并且它很好。

使用 grep（Windows 的 gnu32 包）或其他一些文本过滤器，获取 PHP 文件中包含“扩展”一词的每一行的列表，并确保您确切知道哪些包正在用于您的 wamp 堆栈。

接下来。xdebug 作为引擎扩展效果更好，但正如一些人指出的那样，它也可以用作常规扩展。引擎和普通扩展之间的性能损失是分析几乎没有那么准确，编辑器-> 服务器调试不可靠，并且除了显式 xdebug_break() 语句之外似乎无法正常工作。

最后要尝试的几件事是调用 php -i 并将其通过管道传输到文本文件。如果它在那里崩溃，那么是时候采取更严厉的措施了。在您的 Windows 机器上找到所有 php.ini 文件，并将它们一一重命名为 php.disabled.ini 或 disabled_php.ini 之类的名称，然后再次尝试 php -i 调用。很可能你有一个 php.ini 文件潜伏在一些奇怪的位置，比如 c:\ | c:\windows\ | c:\windows\system 或其他在路径中优先的地方然后你期望它是 xammp\apache\bin

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-04T09:12:31.297

可能我的经验会有用：我使用 XAMPP 1.7.4，当尝试使用 xdebug 2.1.0 从 eclipse 调试 php 页面时，apache 总是崩溃...我用 xdebug 2.0.5 替换了 xdebug 2.1.0，现在一切正常

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-12T03:58:15.443

[这里](http://www.apachefriends.org/winxampp/win32-compatibility-current.txt)有一个 Windows 兼容性列表。似乎Vista不支持xdebug ...

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-12T04:15:00.083

我也有这个问题。将您安装的 XAMPP 降级到以前的版本，并且该错误已修复。我不确定究竟是什么原因造成的，但这是目前已知的唯一解决方案。[您可以在此处](http://sourceforge.net/project/showfiles.php?group_id=61776&package_id=89552&release_id=627831)获取第二个最新版本。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-10-13T20:31:04.787

这可能对某人有帮助。在使用 Eclipse 和 XDebug 调试 PHP 网页时，我遇到了可重复的 Apache 崩溃，并尝试了各种重新安装和 PHP.INI 更改，最终发现我的问题与在单独的文件中使用重复的变量名有关。一个文件包含另一个文件，并且两者都有（比如说）$foo。一旦我在第二个文件中将 $foo 重命名为 $newfoo 并重新启动 Apache，我就摆脱了崩溃。

此外，有点相关，我永远无法让 PHP.INI 文件像这里和其他地方广泛记录的那样工作。我必须从 zend-extension 中删除 _ts，如下所示，以获取 phpinfo() 文本：使用 Xdebug v2.0.5，版权所有 (c) 2002-2008，由 Derick Rethans 提供。

XAMPP 1.7.2（使用自带的 php_xdebug.dll） PHP 5.3.0

这是我的 PHP.INI 文件片段：

xdebug.remote_enable=1 xdebug.remote_host="127.0.0.1" xdebug.remote_port=9000 xdebug.remote_handler="dbgp" zend_extension="C:\xampp\php\ext\php_xdebug.dll"

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-12-09T19:15:14.993

我有同样的问题。它已由最新版本的 xdebug (2.0.6) 解决。它仍处于开发模式，但对我来说它比以前的版本更稳定 :)

它是 XAMPP 1.7.3beta 的一部分[http://www.apachefriends.org/en/xampp-beta.html](http://www.apachefriends.org/en/xampp-beta.html)

启用 xdebug 只需取消注释 xampp/php/php.ini 中的一行

高温高压

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-19T21:45:37.383

Matty 的回答帮助我防止 Apache 崩溃，但我无法让远程调试会话正常工作。每当我尝试单步执行代码时，我的客户都会抱怨连接已关闭，所以我还没有调试。

但是，如果它对其他人有用，这里是我在 XAMPP 1.6.8 中对 apache\bin\php.ini 文件所做的编辑（在 1.7.0 中也是如此）。第 671 行：

```
extension=php_xdebug-2.0.4-5.2.8.dll 
```

我添加了第 1297 行：

```
[XDebug]
;; Only Zend OR (!) XDebug
zend_extension_ts="\xampplite\php\ext\php_xdebug-2.0.4-5.2.8.dll"
xdebug.remote_enable=true
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.profiler_enable=1
xdebug.profiler_output_dir="\xampplite\tmp"
xdebug.trace_output_dir="\xampplite\tmp" 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-20T03:52:41.277

在谷歌搜索时遇到了这个问题，为什么 XDebug 会导致我的 WAMP Apache 崩溃。我刚刚使用当前版本的 WAMP(2.0) 升级到 Vista 64 笔记本电脑，这是我在 php.ini 中放入的内容，以使崩溃停止。

我使用 NetBeans 作为我的 IDE，并且调试工作得很好。

首先，在您的活动 php.ini 中注释掉。

```
;extension=php_xdebug-2.0.4-5.2.8.dll 
```

然后将其添加到活动 php.ini 的底部（相应地调整目录和 xdebug 文件名。）

```
[XDebug]
; Only Zend OR (!) XDebug
zend_extension_ts="C:/Program Files (x86)/wamp/bin/php/php5.2.9-2/ext/php_xdebug-2.0.4-5.2.8.dll"
xdebug.remote_enable=on
xdebug.remote_host=localhost
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.profiler_enable=0
xdebug.profiler_output_dir="C:/Program Files (x86)/wamp/tmp" 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-06-17T09:18:55.097

Vista上的XDebug存在线程安全问题，我在使用IIS7和PHP作为ISAPI模块时遇到了同样的问题，如果加载了xdebug.dll，服务器会随机崩溃，然后我找到了一篇描述PHP+XDebug的文章（on Vista) 应该在单线程模式下运行。

我让它按照以下方式工作：

一个非线程安全的 PHP 版本，一个用于您的 PHP 版本的非线程安全 xdebug.dll，在 php.ini 中它应该被加载为 zend_extension="C:/FullPathToXdebugDll"（没有 "_ts"！），运行 php在 CGI（或更好的 FastCGI）模式下。（CGI/FastCGI 强制它是单线程的）。

这里是文章的链接： [http ://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis-70/](http://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis-70/)

现在我正在寻找一种可能性，可以用 Xampp 或 InstantRails（或类似的东西）在我的笔记本上运行它（Vista Home Premium 没有 IIS），但我不知道如何强制 apache 在单线程模式，有人知道怎么做吗？

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-02-06T15:40:25.980

[http://community.activestate.com/forum-topic/apache-crashes#comment-9812](http://community.activestate.com/forum-topic/apache-crashes#comment-9812) Obviousliy buggy apache 模块的解决方案- 将 php 作为 CGI 运行。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-12-29T22:09:34.550

我在 Windows 7 Ultimate 6.1.7600 上使用 Xampp 1.7.3 (php 5.3.1) 让它工作。按照作者对取消注释行的帖子编辑：`zend_extension = C:\xampp\php\ext\php_xdebug.dll` 在 xampp\php\php.ini 中，我设法让 apache http 服务器停止崩溃！

原来 Xampp 带有它自己的 xdebug 版本，我什至从一开始就不需要下载任何东西。您只需要取消注释上述行并在 php.ini 的 [xdebug] 部分中启用您想要的 xdebug 的其他功能。

我安装的 Xampp 附带的 xdebug 版本是 2.0.6-dev。希望这可以帮助！

编辑：忘了提到我正在运行 Windows 7 的 x64 风格：P

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-03T19:08:54.383

感谢您的评论，我使用此版本的 php_xdebug-2.0.2-5.2.5.dll 解决了问题，在 Windows Vista Business 64bit 上为我工作...... php.ini 配置相同，只是为了使用这个 xdebug dll 版本.......谢谢

爱马仕

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-04-03T23:13:21.757

我正在使用 Vista x86 SP1、XAMPP 1.6.8 和 php_xdebug-2.0.2-5.2.5.dll 插件。最近我注意到当我通过右键单击运行 xampp-control.exe => 以管理员身份运行时，所有崩溃都消失了 :) 有时会发生但非常罕见，我可以在 Eclipse PDT 中使用调试器。查看我的解决方案

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-03-20T11:48:57.090

根据此[问题](http://bugs.xdebug.org/view.php?id=410)，我建议您禁用以下两行`php.ini`：

```
;xdebug.profiler_enable=1
;xdebug.profiler_output_dir="(temp_dir)" 
```

为我工作

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-03-12T12:39:20.987

我刚刚使用 zip 文件安装了 xampp 1.7.4。如果您使用 .exe 文件，除了 1.7.4 存在错误外，它可以很好地与软件包随附的 xdebug 文件配合使用。

我还使用了[Joomla 教程](http://docs.joomla.org/Setting_up_your_workstation_for_Joomla!_development)来设置调试。现在一切似乎都运行良好。

# javascript - 最好的 JavaScript 日期解析器和格式化程序？

> ID：206790
> 
> 赞同：55
> 
> 时间：2008-10-15T22:36:25.840
> 
> 标签：javascript, jquery, datetime, parsing, formatting

自从我开始使用 jQuery 以来，我一直在做更多的 JavaScript 开发。

我需要解析不同的日期格式，然后将它们显示为另一种格式。

你知道有什么好的工具可以做到这一点吗？

你会推荐哪一个？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-15T22:39:13.323

2014 年更新：[Moment.js](http://momentjs.com/)是一个出色的日期操作库，其中包含解析功能。它不包括自动日期格式检测，但您可以[指定多个解析模式](http://momentjs.com/docs/#/parsing/string-formats/)。

您是否事先知道日期的格式，或者它们是用户输入的？

* * *

[用于解析日期的已弃用库是 Datejs](http://www.datejs.com/)。它自 2007 年以来一直没有更新。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-12-17T08:53:58.703

如果您已经在页面上使用 jqueryUI，则 $.datepicker 在大多数情况下具有足够的 parseDate() 和 formatDate() 函数。至于 DateJS - profile yu 代码，你会看到它是如何松散的以及它在处理异常上花费了多少时间

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-30T21:56:38.890

我发现[jQuery Globalization Plugin](http://docs.jquery.com/UI/Datepicker/parseDate)日期解析效果最好。其他方法存在跨浏览器问题，并且 date.js 之类的东西已经有一段时间没有更新了。

您也不需要页面上的 datePicker。您可以调用类似于文档中给出的示例的内容：

```
$.parseDate('yy-mm-dd', '2007-01-26'); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-14T15:32:41.897

只是另一种选择（我写的 - 完全披露）：

[DP_DateExtensions 库](http://depressedpress.com/javascript-extensions/dp_dateextensions/)

支持日期/时间格式、日期数学（添加/减去日期部分）、日期比较、日期解析等。它是自由开源的。

我真的很喜欢 Date.js，但发现有些语法很麻烦。我的大部分函数（至少部分）基于 CFML 中丰富的函数集——有些人可能会觉得它更舒服一些。

如果您已经在使用框架（它们都有能力），则没有理由考虑它，但如果您只需要快速将日期操作添加到项目中，请给它一个机会。

# video - H.264 流媒体要求

> ID：206792
> 
> 赞同：11
> 
> 时间：2008-10-15T22:37:34.513
> 
> 标签：video, streaming, video-streaming, h.264, codec

我正在寻找有关访问者成功流式传输 1 Mbps 640x360 H.264 编码视频所需的最低要求的更多信息。我知道用户需要最新的 Flash 9 版本。我正在寻找他们计算机的最低要求。

我们想为我们的视频切换到这个编解码器，但不想因为电脑速度较慢的人而破坏我们的网站。问题是：太慢有多慢？我们会疏远1%、5%、50%吗？我真的不知道。

我在 Microsoft 网站上找到的关于 720p 播放要求的最佳信息：http: [//www.microsoft.com/windows/windowsmedia/content_provider/film/ChoosingPC.aspx](http://www.microsoft.com/windows/windowsmedia/content_provider/film/ChoosingPC.aspx)

此处的区别在于，真正的“高清”720p (!280x720) 介于 5-10 Mbps 之间。我们正在流式传输分辨率大小的一半，并且只有 1 Mbps。

任何进一步的信息将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T23:51:30.137

它实际上很大程度上取决于您使用的编码选项。一些有助于降低比特率同时保持质量的功能需要大量的计算能力来解码。

Microsoft 链接没有表明他们正在使用什么编解码器（据我所知）。他们可能会提供 mpeg2 压缩的统计信息，与 H.264 相比，解码时 CPU 密集度要低得多。

我发现单线程解码器在播放 1080i 或 720p 视频时往往会最大化 2.4GHz 的肯茨菲尔德内核。我还发现 1.8GHz Pentium M 出现了一些在线视频（YouTube 等）。

我建议在几台不同的机器上尝试一些测试编码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-20T20:25:05.150

显然有很多变量，但这里有一个数据点：

在运行带有实时内核补丁的 Linux 2.6 的 2.2 GHz Intel Core 2 Duo 上 640x480 像素 @ 24 fps 在流式传输 H.264 第 10 部分时导致 55% 到 60% 的 CPU 利用率（由于双核而超过 200%） 1 Mbit/s 使用英特尔 IPP 库。

# c# - 为什么我到 SQL 服务器的 c# 连接字符串不能与 Windows 身份验证一起使用？

> ID：206793
> 
> 赞同：1
> 
> 时间：2008-10-15T22:38:10.440
> 
> 标签：c#, sql

为什么我到 SQL Server 的连接字符串不能与 Windows 身份验证一起使用？sql 用户可以正常工作，acme\administrator 或 administrator@acme.com 将无法正常工作。这是一个用 C# 编写的 Win Form 应用程序。

```
 {
        OdbcConnection cn = null;
        String connectionString;
            connectionString = "Driver={SQL Server};Server=" + cbxDataSources.Text +";Database=" + strDatabase + ";";

            connectionString += "UID=" + textBoxUserName.Text + ";";
            connectionString += "PWD=" + textBoxPassword.Text + ";";

        cn = new OdbcConnection(connectionString);
        return cn;
    } 
```

多谢你们

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T22:41:02.040

您正在使用 SQL Server 身份验证。

Windows 身份验证使用当前执行的进程或线程的 Windows 身份验证您的连接。您不能使用 Windows 身份验证设置用户名和密码。相反，您设置 Integrated Security = SSPI。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T22:50:15.173

您必须使用受信任的连接进行连接。

2005 年：

```
Driver={SQL Native Client};Server=myServerAddress;Database=myDataBase;Trusted_Connection=yes; 
```

2000：

```
Driver={SQL Server};Server=myServerAddress;Database=myDataBase;Trusted_Connection=Yes; 
```

# batch-file - 如何将任务列表的 CPU 时间转换为 CPU % 使用率？

> ID：206805
> 
> 赞同：9
> 
> 时间：2008-10-15T22:41:44.910
> 
> 标签：batch-file, cpu-usage, tasklist

我试图用来`tasklist`找出哪个进程消耗了我的 CPU 的 X% 以上（稍后用 . 杀死它`taskkill`。）

我如何知道时间格式代表的百分比？

文件说：

```
TASKLIST options

/FI   filter 
```

一个过滤器可能是：

```
CPUTIME         eq, ne, gt, lt, ge, le        CPU time in the format: hh:mm:ss.
                                              hh - number of hours,
                                              mm - minutes, ss - seconds 
```

如果我尝试

```
tasklist /FI "CPUTIME gt 00:00:10" 
```

有用。

但如果我

```
tasklist /FI "CPUTIME gt 90" 
```

它没有。

我怎么知道时间格式代表 90%？还是80%？CPU使用时间和CPU使用百分比有什么关系？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-16T04:18:13.483

使用任务列表似乎没有一种简单的方法可以做到这一点，所以我建议要么用 VBscript 或其他脚本语言来做到这一点，要么使用不同的方法。如果您受限于批处理文件，那么您可以使用[WMIC](http://technet.microsoft.com/en-us/library/bb742610.aspx)命令获取正在运行的进程列表及其各自的 CPUTime：

```
C:\> wmic path Win32_PerfFormattedData_PerfProc_Process get Name,PercentProcessorTime

Name                 PercentProcessorTime
Idle                 0
System               0
Smss                 0
csrss                0
winlogon             0
services             0
lsass                0

[...]

wmiprvse             100
wmic                 0
_Total               100 
```

请注意，这在我的测试中显示 wmipsrv.exe 具有 100% 的 CPU，因为它在执行 WMI 查询时出现峰值。你应该在你的脚本中考虑到这一点，否则你最终会试图不断地杀死 WMI 服务；）

参考：
[http :](http://waynes-world-it.blogspot.com/2008/09/useful-general-command-line-operations.html)
[//waynes-world-it.blogspot.com/2008/09/useful-general-command-line-operations.html http://technet.microsoft.com/en-us/library/bb742610.aspx](http://technet.microsoft.com/en-us/library/bb742610.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-06-28T16:27:32.107

tasklist 不会告诉您进程运行了多长时间。它告诉您各种进程占用了多少 CPU 时间。要获得一个百分比（这将是一个平均百分比），您需要知道您的进程已经运行了多长时间。例如，您可以相隔 10 秒拍摄快照，减去时间，然后找到最接近数字 10 的进程 CPUTIME。（嗯，是 CPU 内核数的 10 倍？不确定......）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-15T23:27:36.360

Tasklist 的 CPUTime 是自进程开始以来已使用多少 CPU 时间（周期）的度量，因此要将其转换为百分比，它将是

```
 (TotalProcessRuntime / CpuTime) / 100 
```

至少，这就是我收集到的:)

# emacs - 通过 Emacs 中的 shell 命令过滤文本

> ID：206806
> 
> 赞同：73
> 
> 时间：2008-10-15T22:41:57.733
> 
> 标签：emacs, text-editor, elisp

在 vi[m] 中，有一个[`!`命令可以让我](http://www.softpanorama.org/Editors/Vimorama/vim_piping.shtml)通过 shell 命令管道文本——比如排序或缩进——并将过滤后的文本返回到缓冲区。在 emacs 中是否有等价物？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2008-10-16T00:27:06.460

您可以选择一个区域并输入`Cu M-| command RET'，并且由于 shell-command-on-region 的交互式前缀参数，它用同一缓冲区中的命令输出替换了该区域。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-16T00:58:28.707

几年前我写了这个，它可能会对你有所帮助：

```
(defun generalized-shell-command (command arg)
  "Unifies `shell-command' and `shell-command-on-region'. If no region is
selected, run a shell command just like M-x shell-command (M-!).  If
no region is selected and an argument is a passed, run a shell command
and place its output after the mark as in C-u M-x `shell-command' (C-u
M-!).  If a region is selected pass the text of that region to the
shell and replace the text in that region with the output of the shell
command as in C-u M-x `shell-command-on-region' (C-u M-|). If a region
is selected AND an argument is passed (via C-u) send output to another
buffer instead of replacing the text in region."
  (interactive (list (read-from-minibuffer "Shell command: " nil nil nil 'shell-command-history)
                     current-prefix-arg))
  (let ((p (if mark-active (region-beginning) 0))
        (m (if mark-active (region-end) 0)))
    (if (= p m)
        ;; No active region
        (if (eq arg nil)
            (shell-command command)
          (shell-command command t))
      ;; Active region
      (if (eq arg nil)
          (shell-command-on-region p m command t t)
        (shell-command-on-region p m command))))) 
```

我发现这个功能非常有用。如果您发现它也有用，我建议将其绑定到某个功能键以方便使用，我个人使用`F3`：

```
(global-set-key [f3] 'generalized-shell-command) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-15T22:43:29.977

**后期编辑**：尽管我很欣赏这些赞成票，但 Jurta 的回答是要走的路。Greg 的 hack 比我的更简洁。

我会把剩下的留在这里，因为它可能是值得的，但是......

* * *

**`M-x shell-command-on-region`**，默认情况下似乎绑定到**`M-|`**。

* * *

我看到这并不完全符合 Rohit 的要求。使用`C-h f shell-command-on-region`表明所需的行为在命令的非交互式版本中可用（通过将参数设置`replace`为非零）。我们应该能够编写一个包装器来做到这一点。

试试这个（加载它`*scratch*`并运行`M-x eval-buffer`，如果它工作，将它复制到你的 .emacs 文件）：

```
(defun shell-command-on-region-replace (start end command)
  "Run shell-command-on-region interactivly replacing the region in place"
  (interactive (let (string) 
         (unless (mark)
           (error "The mark is not set now, so there is no region"))
         ;; Do this before calling region-beginning
         ;; and region-end, in case subprocess output
         ;; relocates them while we are in the minibuffer.
         ;; call-interactively recognizes region-beginning and
         ;; region-end specially, leaving them in the history.
         (setq string (read-from-minibuffer "Shell command on region: "
                            nil nil nil
                            'shell-command-history))
         (list (region-beginning) (region-end)
               string)))
  (shell-command-on-region start end command t t)
  ) 
```

请注意，正如我在评论中所说，这不是一件非常容易做的事情。但我认为它有效。

* * *

对于不知道如何选择区域的任何读者：

1.  将“点”（当前光标位置）移动到区域的一端，并使用`C-space`激活“标记”
2.  将点移动到区域的另一端
3.  大功告成，调用命令

# c++ - 大型代码库上的代码标准重构

> ID：206811
> 
> 赞同：3
> 
> 时间：2008-10-15T22:43:52.503
> 
> 标签：c++, refactoring

我的工作室有一个庞大的代码库，已经开发了 10 多年。我们开始使用的编码标准是由内部少数开发人员开发的，而且早在我们不得不担心任何与 C++ 相关的标准之前。

最近，我们在内部启动了一个小型研发项目，我们更新了编码约定以更适合我们的环境。研发工作将被整合到现有的项目代码中。我们面临的一个主要问题是，我们现在有两个工作领域的两个标准，现在代码库将交叉。我不希望工作室有两个标准，实际上我很高兴能推进一个单一的标准。（我们如何进入这种情况并不重要——只是我们是，我希望我们不会是。）

问题在于重构现有代码。我不太希望有两个看起来不同的代码库（一个相对较小，一个非常大）。我有兴趣对现有代码库之一进行一些重构，以使其符合其他标准。问题是，代码库越小（IMO），标准就越受欢迎。

我开始四处寻找可以为我进行大规模重构的工具。我对重新排列和收紧代码不感兴趣。我有兴趣改变一些事情，比如

```
class my_class {}
....
class my_class A; 
```

到

```
class MyClass {}
....
class MyClass A; 
```

基本上是在做函数/变量级别的重命名。我不想使用 Visual Assist 之类的东西，因为这需要很长时间。我有超过 10000 个源/头文件和数十万行代码。一次使用 VA 一个课程将是一个时间杀手，不值得付出努力。

我确实在 SO 的另一篇文章中遇到了[Vera](http://www.inspirel.com/vera/)。这似乎可以完成这项工作并且做得很好。我想知道是否有人对我所处的情况有使用 Vera 的特定经验，或者对可能完成工作的工具有任何其他建议。我认为这个工具真正理解代码结构很重要，这样我们就不会只是以搜索/替换的方式重命名变量，因为如果不小心这样做会导致微妙的错误。

编辑：虽然我的示例显示我将从在名称之间使用 _ 到驼峰式类型表示法，但换一种方式可能对我们更有利。我真的在寻找一种有助于大规模重命名的通用解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T23:26:35.380

我的过程是每次有人触摸给定模块时重命名。最终，所有模块都将被重构，但增量方法将导致更少的代码损坏（假设您有一套完整的测试。;)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T23:26:49.890

我已经使用自定义脚本进行了这样的更改。如果可以，我会使用 sed。否则，我将使用对正则表达式有良好支持的脚本语言。这是一个粗略的 hack，肯定会引入错误，但除非你找到更好的解决方案，否则它是一条前进的道路。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T08:28:52.573

除非您有 (1) 一套相当完整的可靠和自动化测试，以及 (2) 一个理解 C++ 语义的重构工具（我还没有听说过这样的工具），否则我建议不要进行自动重命名。在我工作的任何地方，实践总是只重构你目前正在处理的模块。这是一个漫长但相对轻松的过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T22:54:51.653

我认为重命名变量会很棘手-幸运的是，您将从 _ 约定变为大写，所以它不会那么难（尽管 _ 更容易阅读并且更好）

我会采用代码美化器（例如[Artistic Style](http://astyle.sourceforge.net/astyle.html)或[Uncrustify](http://uncrustify.sourceforge.net/)）并修改它们以进行转换。您只需要一些自定义规则即可进行此转换，因此不会太难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T01:29:04.853

恕我直言，变量重命名根本不值得努力。重要的是代码是健壮的、可读的和高性能的。只需采用以前使用的任何样式，然后将时间花在重要的事情上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T04:27:03.860

您可能需要考虑研究由 Mozilla 人员使用、创建和维护的“[猪肉](https://wiki.mozilla.org/pork)”，以进行很大程度上自动化的 C++ 源代码分析，包括[重构](http://blog.mozilla.com/tglek/2009/01/29/semantic-rewriting-of-code-with-pork-a-bitter-recap/)等源代码转换。它可以使用 JavaScript 编写脚本，并支持非常复杂的语义分析和转换。所以重命名符号是猪肉更容易做的事情之一。

现在[GCC 插件正在开发](http://blog.mozilla.com/tglek/2009/04/30/gcc-rant-progress/)中，未来这些事情可能会变得更容易。

# c# - 如何防止和/或处理 StackOverflowException？

> ID：206820
> 
> 赞同：72
> 
> 时间：2008-10-15T22:47:23.807
> 
> 标签：c#, .net, stack-overflow, xslcompiledtransform

我想阻止或处理`StackOverflowException`我从正在编写的`XslCompiledTransform.Transform`方法调用中得到的。`Xsl Editor`问题似乎是用户可以编写一个`Xsl script`无限递归的，它只是在调用该`Transform`方法时崩溃了。（也就是说，问题不仅仅是典型的程序错误，这通常是导致此类异常的原因。）

有没有办法检测和/或限制允许的递归次数？或者有什么其他想法可以防止这段代码对我产生影响？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-10-15T22:56:17.797

来自微软：

> 从 .NET Framework 2.0 版开始，StackOverflowException 对象无法被 try-catch 块捕获，并且默认情况下会终止相应的进程。因此，建议用户编写代码来检测和防止堆栈溢出。例如，如果您的应用程序依赖于递归，请使用计数器或状态条件来终止递归循环。

我假设异常发生在内部 .NET 方法中，而不是在您的代码中。

你可以做几件事。

*   编写代码检查 xsl 的无限递归，并在应用转换之前通知用户 (Ugh)。
*   将 XslTransform 代码加载到单独的进程中（Hacky，但工作量较少）。

您可以使用 Process 类加载将应用转换的程序集到一个单独的进程中，并在失败时提醒用户失败，而不会终止您的主应用程序。

编辑：我刚刚测试过，这是怎么做的：

主要流程：

```
// This is just an example, obviously you'll want to pass args to this.
Process p1 = new Process();
p1.StartInfo.FileName = "ApplyTransform.exe";
p1.StartInfo.UseShellExecute = false;
p1.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;

p1.Start();
p1.WaitForExit();

if (p1.ExitCode == 1)    
   Console.WriteLine("StackOverflow was thrown"); 
```

应用转换过程：

```
class Program
{
    static void Main(string[] args)
    {
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        throw new StackOverflowException();
    }

    // We trap this, we can't save the process, 
    // but we can prevent the "ILLEGAL OPERATION" window 
    static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        if (e.IsTerminating)
        {
            Environment.Exit(1);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-06-06T09:13:31.960

> **注意**@WilliamJockusch 的赏金问题和原始问题不同。
> 
> 这个答案是关于第三方库的一般情况下的 StackOverflow 以及你可以/不能用它们做什么。如果您正在寻找 XslTransform 的特殊情况，请参阅接受的答案。

* * *

堆栈溢出的发生是因为堆栈上的数据超过了某个限制（以字节为单位）。可以在[此处](https://stackoverflow.com/questions/30327674/how-is-a-stackoverflowexception-detected/30327998#30327998)找到有关此检测工作原理的详细信息。

> 我想知道是否有一种通用的方法来追踪 StackOverflowExceptions。换句话说，假设我的代码中某处有无限递归，但我不知道在哪里。我想通过某种方式来追踪它，这比在整个地方单步执行代码更容易，直到我看到它发生。我不在乎它有多骇人听闻。

正如我在链接中提到的，从静态代码分析中检测堆栈溢出需要解决无法确定的停止*问题*。既然我们已经确定*没有灵丹妙药*，我可以向您展示一些我认为有助于追查问题的技巧。

我认为这个问题可以用不同的方式来解释，因为我有点无聊:-)，我会把它分解成不同的变体。

**在测试环境中检测堆栈溢出**

基本上这里的问题是您有一个（有限的）测试环境，并且想要在（扩展的）生产环境中检测堆栈溢出。

我没有检测 SO 本身，而是利用可以设置堆栈深度的事实来解决这个问题。调试器将为您提供所需的所有信息。大多数语言允许您指定堆栈大小或最大递归深度。

基本上，我尝试通过使堆栈深度尽可能小来强制执行 SO。如果它没有溢出，我总是可以为生产环境让它更大（=在这种情况下：更安全）。当您遇到堆栈溢出时，您可以手动确定它是否是“有效”的。

为此，请将堆栈大小（在我们的示例中：一个小值）传递给 Thread 参数，然后看看会发生什么。.NET 中的默认堆栈大小为 1 MB，我们将使用更小的值：

```
class StackOverflowDetector
{
    static int Recur()
    {
        int variable = 1;
        return variable + Recur();
    }

    static void Start()
    {
        int depth = 1 + Recur();
    }

    static void Main(string[] args)
    {
        Thread t = new Thread(Start, 1);
        t.Start();
        t.Join();
        Console.WriteLine();
        Console.ReadLine();
    }
} 
```

*注意：我们也将在下面使用此代码。*

一旦溢出，您可以将其设置为更大的值，直到获得有意义的 SO。

**在你之前创建例外**

`StackOverflowException`是不可捕捉的。这意味着当它发生时你无能为力。所以，如果你认为你的代码一定会出错，你可以在某些情况下自己制造异常。您唯一需要的是当前堆栈深度；不需要计数器，您可以使用 .NET 中的实际值：

```
class StackOverflowDetector
{
    static void CheckStackDepth()
    {
        if (new StackTrace().FrameCount > 10) // some arbitrary limit
        {
            throw new StackOverflowException("Bad thread.");
        }
    }

    static int Recur()
    {
        CheckStackDepth();
        int variable = 1;
        return variable + Recur();
    }

    static void Main(string[] args)
    {
        try
        {
            int depth = 1 + Recur();
        }
        catch (ThreadAbortException e)
        {
            Console.WriteLine("We've been a {0}", e.ExceptionState);
        }
        Console.WriteLine();
        Console.ReadLine();
    }
} 
```

请注意，如果您正在处理使用回调机制的第三方组件，此方法也适用。唯一需要的是您可以拦截堆栈跟踪中的*一些*调用。

**在单独的线程中检测**

你明确提出了这个建议，所以这里是这个。

您可以尝试在单独的线程中检测 SO.. 但这可能对您没有任何好处。即使在您获得上下文切换之前，堆栈溢出也可能*很快发生。*这意味着这种机制根本不可靠……**我不建议实际使用它**。不过构建起来很有趣，所以这里是代码:-)

```
class StackOverflowDetector
{
    static int Recur()
    {
        Thread.Sleep(1); // simulate that we're actually doing something :-)
        int variable = 1;
        return variable + Recur();
    }

    static void Start()
    {
        try
        {
            int depth = 1 + Recur();
        }
        catch (ThreadAbortException e)
        {
            Console.WriteLine("We've been a {0}", e.ExceptionState);
        }
    }

    static void Main(string[] args)
    {
        // Prepare the execution thread
        Thread t = new Thread(Start);
        t.Priority = ThreadPriority.Lowest;

        // Create the watch thread
        Thread watcher = new Thread(Watcher);
        watcher.Priority = ThreadPriority.Highest;
        watcher.Start(t);

        // Start the execution thread
        t.Start();
        t.Join();

        watcher.Abort();
        Console.WriteLine();
        Console.ReadLine();
    }

    private static void Watcher(object o)
    {
        Thread towatch = (Thread)o;

        while (true)
        {
            if (towatch.ThreadState == System.Threading.ThreadState.Running)
            {
                towatch.Suspend();
                var frames = new System.Diagnostics.StackTrace(towatch, false);
                if (frames.FrameCount > 20)
                {
                    towatch.Resume();
                    towatch.Abort("Bad bad thread!");
                }
                else
                {
                    towatch.Resume();
                }
            }
        }
    }
} 
```

在调试器中运行它并享受所发生的事情。

**使用堆栈溢出的特性**

您的问题的另一种解释是：“可能导致堆栈溢出异常的代码片段在哪里？”。显然这个问题的答案是：所有代码都带有递归。对于每段代码，您可以进行一些手动分析。

也可以使用静态代码分析来确定这一点。为此，您需要做的是反编译所有方法并确定它们是否包含无限递归。这是一些为您执行此操作的代码：

```
// A simple decompiler that extracts all method tokens (that is: call, callvirt, newobj in IL)
internal class Decompiler
{
    private Decompiler() { }

    static Decompiler()
    {
        singleByteOpcodes = new OpCode[0x100];
        multiByteOpcodes = new OpCode[0x100];
        FieldInfo[] infoArray1 = typeof(OpCodes).GetFields();
        for (int num1 = 0; num1 < infoArray1.Length; num1++)
        {
            FieldInfo info1 = infoArray1[num1];
            if (info1.FieldType == typeof(OpCode))
            {
                OpCode code1 = (OpCode)info1.GetValue(null);
                ushort num2 = (ushort)code1.Value;
                if (num2 < 0x100)
                {
                    singleByteOpcodes[(int)num2] = code1;
                }
                else
                {
                    if ((num2 & 0xff00) != 0xfe00)
                    {
                        throw new Exception("Invalid opcode: " + num2.ToString());
                    }
                    multiByteOpcodes[num2 & 0xff] = code1;
                }
            }
        }
    }

    private static OpCode[] singleByteOpcodes;
    private static OpCode[] multiByteOpcodes;

    public static MethodBase[] Decompile(MethodBase mi, byte[] ildata)
    {
        HashSet<MethodBase> result = new HashSet<MethodBase>();

        Module module = mi.Module;

        int position = 0;
        while (position < ildata.Length)
        {
            OpCode code = OpCodes.Nop;

            ushort b = ildata[position++];
            if (b != 0xfe)
            {
                code = singleByteOpcodes[b];
            }
            else
            {
                b = ildata[position++];
                code = multiByteOpcodes[b];
                b |= (ushort)(0xfe00);
            }

            switch (code.OperandType)
            {
                case OperandType.InlineNone:
                    break;
                case OperandType.ShortInlineBrTarget:
                case OperandType.ShortInlineI:
                case OperandType.ShortInlineVar:
                    position += 1;
                    break;
                case OperandType.InlineVar:
                    position += 2;
                    break;
                case OperandType.InlineBrTarget:
                case OperandType.InlineField:
                case OperandType.InlineI:
                case OperandType.InlineSig:
                case OperandType.InlineString:
                case OperandType.InlineTok:
                case OperandType.InlineType:
                case OperandType.ShortInlineR:
                    position += 4;
                    break;
                case OperandType.InlineR:
                case OperandType.InlineI8:
                    position += 8;
                    break;
                case OperandType.InlineSwitch:
                    int count = BitConverter.ToInt32(ildata, position);
                    position += count * 4 + 4;
                    break;

                case OperandType.InlineMethod:
                    int methodId = BitConverter.ToInt32(ildata, position);
                    position += 4;
                    try
                    {
                        if (mi is ConstructorInfo)
                        {
                            result.Add((MethodBase)module.ResolveMember(methodId, mi.DeclaringType.GetGenericArguments(), Type.EmptyTypes));
                        }
                        else
                        {
                            result.Add((MethodBase)module.ResolveMember(methodId, mi.DeclaringType.GetGenericArguments(), mi.GetGenericArguments()));
                        }
                    }
                    catch { } 
                    break;

                default:
                    throw new Exception("Unknown instruction operand; cannot continue. Operand type: " + code.OperandType);
            }
        }
        return result.ToArray();
    }
}

class StackOverflowDetector
{
    // This method will be found:
    static int Recur()
    {
        CheckStackDepth();
        int variable = 1;
        return variable + Recur();
    }

    static void Main(string[] args)
    {
        RecursionDetector();
        Console.WriteLine();
        Console.ReadLine();
    }

    static void RecursionDetector()
    {
        // First decompile all methods in the assembly:
        Dictionary<MethodBase, MethodBase[]> calling = new Dictionary<MethodBase, MethodBase[]>();
        var assembly = typeof(StackOverflowDetector).Assembly;

        foreach (var type in assembly.GetTypes())
        {
            foreach (var member in type.GetMembers(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Static | BindingFlags.Instance).OfType<MethodBase>())
            {
                var body = member.GetMethodBody();
                if (body!=null)
                {
                    var bytes = body.GetILAsByteArray();
                    if (bytes != null)
                    {
                        // Store all the calls of this method:
                        var calls = Decompiler.Decompile(member, bytes);
                        calling[member] = calls;
                    }
                }
            }
        }

        // Check every method:
        foreach (var method in calling.Keys)
        {
            // If method A -> ... -> method A, we have a possible infinite recursion
            CheckRecursion(method, calling, new HashSet<MethodBase>());
        }
    } 
```

现在，方法循环包含递归这一事实决不能保证会发生堆栈溢出 - 它只是堆栈溢出异常最可能的前提条件。简而言之，这意味着该代码将确定*可能*发生堆栈溢出的代码片段，这将大大缩小大多数代码的范围。

**还有其他方法**

您可以尝试其他一些我没有在这里描述的方法。

1.  通过托管 CLR 进程并对其进行处理来处理堆栈溢出。请注意，您仍然无法“抓住”它。
2.  更改所有 IL 代码，构建另一个 DLL，添加递归检查。是的，这很有可能（我过去已经实现了：-）；这很困难，并且需要大量代码才能使其正确。
3.  使用 .NET 分析 API 来捕获所有方法调用并使用它来确定堆栈溢出。例如，您可以实施检查，如果您在调用树中遇到 X 次相同的方法，您会发出信号。有一个项目[clrprofiler](https://github.com/MicrosoftArchive/clrprofiler)可以让您抢先一步。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-01-22T13:00:20.573

我建议围绕 XmlWriter 对象创建一个包装器，以便计算对 WriteStartElement/WriteEndElement 的调用次数，如果您将标签数量限制为某个数字（fe 100），您将能够抛出不同的异常，例如 -无效操作。

这应该可以解决大多数情况下的问题

```
public class LimitedDepthXmlWriter : XmlWriter
{
    private readonly XmlWriter _innerWriter;
    private readonly int _maxDepth;
    private int _depth;

    public LimitedDepthXmlWriter(XmlWriter innerWriter): this(innerWriter, 100)
    {
    }

    public LimitedDepthXmlWriter(XmlWriter innerWriter, int maxDepth)
    {
        _maxDepth = maxDepth;
        _innerWriter = innerWriter;
    }

    public override void Close()
    {
        _innerWriter.Close();
    }

    public override void Flush()
    {
        _innerWriter.Flush();
    }

    public override string LookupPrefix(string ns)
    {
        return _innerWriter.LookupPrefix(ns);
    }

    public override void WriteBase64(byte[] buffer, int index, int count)
    {
        _innerWriter.WriteBase64(buffer, index, count);
    }

    public override void WriteCData(string text)
    {
        _innerWriter.WriteCData(text);
    }

    public override void WriteCharEntity(char ch)
    {
        _innerWriter.WriteCharEntity(ch);
    }

    public override void WriteChars(char[] buffer, int index, int count)
    {
        _innerWriter.WriteChars(buffer, index, count);
    }

    public override void WriteComment(string text)
    {
        _innerWriter.WriteComment(text);
    }

    public override void WriteDocType(string name, string pubid, string sysid, string subset)
    {
        _innerWriter.WriteDocType(name, pubid, sysid, subset);
    }

    public override void WriteEndAttribute()
    {
        _innerWriter.WriteEndAttribute();
    }

    public override void WriteEndDocument()
    {
        _innerWriter.WriteEndDocument();
    }

    public override void WriteEndElement()
    {
        _depth--;

        _innerWriter.WriteEndElement();
    }

    public override void WriteEntityRef(string name)
    {
        _innerWriter.WriteEntityRef(name);
    }

    public override void WriteFullEndElement()
    {
        _innerWriter.WriteFullEndElement();
    }

    public override void WriteProcessingInstruction(string name, string text)
    {
        _innerWriter.WriteProcessingInstruction(name, text);
    }

    public override void WriteRaw(string data)
    {
        _innerWriter.WriteRaw(data);
    }

    public override void WriteRaw(char[] buffer, int index, int count)
    {
        _innerWriter.WriteRaw(buffer, index, count);
    }

    public override void WriteStartAttribute(string prefix, string localName, string ns)
    {
        _innerWriter.WriteStartAttribute(prefix, localName, ns);
    }

    public override void WriteStartDocument(bool standalone)
    {
        _innerWriter.WriteStartDocument(standalone);
    }

    public override void WriteStartDocument()
    {
        _innerWriter.WriteStartDocument();
    }

    public override void WriteStartElement(string prefix, string localName, string ns)
    {
        if (_depth++ > _maxDepth) ThrowException();

        _innerWriter.WriteStartElement(prefix, localName, ns);
    }

    public override WriteState WriteState
    {
        get { return _innerWriter.WriteState; }
    }

    public override void WriteString(string text)
    {
        _innerWriter.WriteString(text);
    }

    public override void WriteSurrogateCharEntity(char lowChar, char highChar)
    {
        _innerWriter.WriteSurrogateCharEntity(lowChar, highChar);
    }

    public override void WriteWhitespace(string ws)
    {
        _innerWriter.WriteWhitespace(ws);
    }

    private void ThrowException()
    {
        throw new InvalidOperationException(string.Format("Result xml has more than {0} nested tags. It is possible that xslt transformation contains an endless recursive call.", _maxDepth));
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-06-06T10:22:50.053

这个答案是给@WilliamJockusch 的。

> 我想知道是否有一种通用的方法来追踪 StackOverflowExceptions。换句话说，假设我的代码中某处有无限递归，但我不知道在哪里。我想通过某种方式来追踪它，这比在整个地方单步执行代码更容易，直到我看到它发生。我不在乎它有多骇人听闻。例如，如果有一个模块我可以激活，甚至可以从另一个线程激活，它会轮询堆栈深度并抱怨它是否达到我认为“太高”的级别，这将是很棒的。例如，我可能将“太高”设置为 600 帧，认为如果堆栈太深，那一定是个问题。有没有可能。另一个例子是将我的代码中的每 1000 个方法调用记录到调试输出。这将获得一些过低的证据的机会非常好，而且它可能不会太严重地破坏输出。关键是它不能在发生溢出的地方写检查。因为整个问题是我不知道那在哪里。最好解决方案不应该取决于我的开发环境是什么样的；即，它不应该假设我通过特定的工具集（例如VS）使用C#。

听起来你很想听一些调试技术来捕捉这个 StackOverflow，所以我想我会分享一些给你尝试。

## 1\. 内存转储。

**专业**人士：内存转储是找出堆栈溢出原因的可靠方法。AC# MVP 和我一起对 SO 进行了故障排除，他继续在[此处](http://blog.tatham.oddie.com.au/2009/07/04/diagnosing-stack-overflow-faults-in-asp-net-production-environments/)写博客。

这种方法是追查问题的最快方法。

此方法不需要您按照日志中的步骤重现问题。

**缺点：内存转储非常大，您必须附加 AdPlus/procdump 进程**。****

 **## 2\. 面向方面的编程。

**专业**人士：这可能是您实现代码的最简单方法，该代码可以从任何方法检查调用堆栈的大小，而无需在应用程序的每个方法中编写代码。有一堆[AOP 框架](http://www.codeproject.com/Articles/28387/Rating-of-Open-Source-AOP-Frameworks-in-NET)允许您在调用之前和之后进行拦截。

将告诉您导致堆栈溢出的方法。

允许您检查`StackTrace().FrameCount`应用程序中所有方法的入口和出口。

**缺点**：它会对性能产生影响——每个方法的钩子都嵌入到 IL 中，你不能真正“取消激活”它。

这在某种程度上取决于您的开发环境工具集。

## 3\. 记录用户活动。

一周前，我试图寻找几个难以重现的问题。我发布了这个 QA [User Activity Logging, Telemetry (and Variables in Global Exception Handlers)](https://stackoverflow.com/questions/30326673/user-activity-logging-see-variables-in-a-global-exception-handler)。我得出的结论是一个非常简单的用户操作记录器，用于查看当发生任何未处理的异常时如何在调试器中重现问题。

**专业**人士：您可以随意打开或关闭它（即订阅事件）。

跟踪用户操作不需要拦截每个方法。

*您可以比使用 AOP 更简单地*计算订阅方法的事件数量。

日志文件相对较小，主要关注重现问题所需执行的操作。

它可以帮助您了解用户如何使用您的应用程序。

**缺点**：不适合 Windows 服务*，我敢肯定有更好的类似这样的工具用于 web 应用程序*。

不一定*会*告诉您导致堆栈溢出的方法。

要求您逐步通过日志手动重现问题，而不是通过内存转储，您可以在其中立即获取并调试它。

* * *

也许您可以尝试我上面提到的所有技术以及@atlaste 发布的一些技术，并告诉我们您发现哪些是在 PROD 环境/等中运行最简单/最快/最脏/最可接受的技术。

无论如何，祝你好运追踪这个 SO。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-09-01T14:40:33.497

如果您的应用程序依赖于 3d 方代码（在 Xsl 脚本中），那么您必须首先决定是否要防御其中的错误。如果您真的想捍卫，那么我认为您应该在单独的 AppDomain 中执行容易出现外部错误的逻辑。捕获 StackOverflowException 并不好。

还要检查这个[问题](https://stackoverflow.com/questions/107735/stackoverflowexception-in-net)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-25T09:54:02.593

在 .NET 4.0 中，您可以将`HandleProcessCorruptedStateExceptions`System.Runtime.ExceptionServices 中的属性添加到包含 try/catch 块的方法中。这真的奏效了！也许不推荐但有效。

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Runtime.ExceptionServices;

namespace ExceptionCatching
{
    public class Test
    {
        public void StackOverflow()
        {
            StackOverflow();
        }

        public void CustomException()
        {
            throw new Exception();
        }

        public unsafe void AccessViolation()
        {
            byte b = *(byte*)(8762765876);
        }
    }

    class Program
    {
        [HandleProcessCorruptedStateExceptions]
        static void Main(string[] args)
        {
            Test test = new Test();
            try {
                //test.StackOverflow();
                test.AccessViolation();
                //test.CustomException();
            }
            catch
            {
                Console.WriteLine("Caught.");
            }

            Console.WriteLine("End of program");

        }

    }      
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-09T16:22:20.217

我今天有一个stackoverflow，我阅读了你的一些帖子并决定帮助垃圾收集器。

我曾经有一个近乎无限的循环，像这样：

```
 class Foo
    {
        public Foo()
        {
            Go();
        }

        public void Go()
        {
            for (float i = float.MinValue; i < float.MaxValue; i+= 0.000000000000001f)
            {
                byte[] b = new byte[1]; // Causes stackoverflow
            }
        }
    } 
```

而是让资源超出范围，如下所示：

```
class Foo
{
    public Foo()
    {
        GoHelper();
    }

    public void GoHelper()
    {
        for (float i = float.MinValue; i < float.MaxValue; i+= 0.000000000000001f)
        {
            Go();
        }
    }

    public void Go()
    {
        byte[] b = new byte[1]; // Will get cleaned by GC
    }   // right now
} 
```

它对我有用，希望对某人有所帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-12T08:30:06.460

@WilliamJockusch，如果我正确理解了您的担忧，那么（从数学的角度来看）不可能**总是**识别出无限递归，因为这意味着要解决[Halting problem](http://en.wikipedia.org/wiki/Halting_problem)。为了解决这个问题，你需要一个[超级递归算法](http://en.wikipedia.org/wiki/Super-recursive_algorithm)（例如[试错谓词](http://www.ninagierasimczuk.com/flt2013/wp-content/uploads/2013/01/Putnam_1965.pdf)）或一台可以进行[超计算](http://en.wikipedia.org/wiki/Hypercomputation)的机器（一个例子在[本书的](http://www.springer.com/us/book/9780387308869)[下一节](https://books.google.it/books?id=3tejKrkWkD8C&pg=PA31&lpg=PA31&dq=hintikka%20mutanen%20trial%20and%20error%20machines&source=bl&ots=CNquYM2lBb&sig=jBaAyN8XEzPJGUeHlCXOziSfQtc&hl=it&sa=X&ved=0CCEQ6AEwAGoVChMI-euAgeCJxgIVhizbCh07qQAP#v=onepage&q=hintikka%20mutanen%20trial%20and%20error%20machines&f=false)中解释- 可作为预览提供）。

从实际的角度来看，您必须知道：

*   在给定时间您还剩下多少堆栈内存
*   在给定时间，您的递归方法需要多少堆栈内存才能用于特定输出。

请记住，对于当前的机器，由于多任务处理，这些数据非常易变，我还没有听说过可以完成这项任务的软件。

如果有不清楚的地方，请告诉我。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-11T13:47:43.830

从表面上看，除了启动另一个进程之外，似乎没有任何方法可以处理`StackOverflowException`. 在其他人问之前，我尝试使用`AppDomain`，但这没有用：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Threading;

namespace StackOverflowExceptionAppDomainTest
{
    class Program
    {
        static void recrusiveAlgorithm()
        {
            recrusiveAlgorithm();
        }
        static void Main(string[] args)
        {
            if(args.Length>0&&args[0]=="--child")
            {
                recrusiveAlgorithm();
            }
            else
            {
                var domain = AppDomain.CreateDomain("Child domain to test StackOverflowException in.");
                domain.ExecuteAssembly(Assembly.GetEntryAssembly().CodeBase, new[] { "--child" });
                domain.UnhandledException += (object sender, UnhandledExceptionEventArgs e) =>
                {
                    Console.WriteLine("Detected unhandled exception: " + e.ExceptionObject.ToString());
                };
                while (true)
                {
                    Console.WriteLine("*");
                    Thread.Sleep(1000);
                }
            }
        }
    }
} 
```

但是，如果您最终使用了分离进程解决方案，我建议您自己使用`Process.Exited`并`Process.StandardOutput`处理错误，以便为您的用户提供更好的体验。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-12-27T18:18:10.683

您可以每隔几次调用就读取此属性`Environment.StackTrace`，如果堆栈跟踪超出了您预设的特定阈值，则可以返回该函数。

您还应该尝试用循环替换一些递归函数。

# python - Ruby 到 Python 的桥梁

> ID：206823
> 
> 赞同：8
> 
> 时间：2008-10-15T22:49:36.017
> 
> 标签：python, ruby, interop

我有兴趣让一些 Python 代码在 Windows、Linux 和可能的其他平台上与一些 Ruby 代码对话。具体来说，我想从 Python 访问 Ruby 中的类并调用它们的方法、访问它们的数据、创建新实例等等。

一个明显的方法是通过 XML-RPC 或 CORBA 之类的方法，但我会对任何其他方法感兴趣。

其他人做了什么来让 Python 和 Ruby 的代码相互通信，无论是在同一系统上本地还是通过网络远程通信？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T23:11:54.427

好吧，您可以尝试[命名管道](http://en.wikipedia.org/wiki/Named_pipe)或类似的东西，但我真的认为 XML-RPC 将是最令人头疼的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T22:55:14.867

请注意，我在这里不是根据个人经验说话，但我认为 JRuby 和 Jython（JVM 中的 ruby​​ 和 python 实现）能够轻松地相互交谈，以及 Java 代码。你可能想调查一下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T08:50:10.033

这不是你想要的，但值得一读：embed Python interpreter in Ruby: this code's pretty old

[http://www.goto.info.waseda.ac.jp/~fukusima/ruby/python/doc/index.html](http://www.goto.info.waseda.ac.jp/~fukusima/ruby/python/doc/index.html)

或者：为什么，重写字节码

[http://github.com/why/unholy/tree/master](http://github.com/why/unholy/tree/master)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-01T06:46:58.080

[使用 JRuby/Jython 实现 Ruby/Python 互操作性？](https://stackoverflow.com/questions/2752979/using-jruby-jython-for-ruby-python-interoperability) 有更多信息。注意：JRuby 和 Jython 没有对象兼容性，但 IronPython 和 IronRuby 有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-01T06:53:07.367

使用 Sinatra、Rails 或普通的旧 Rack 将 Ruby 类公开为 Web 服务。

使用 web.py、flask、Django 或 App Engine 将 Python 类公开为 Web 服务。

使用 HTTParty for Ruby 将 API 构建到 Python 类中。

使用 Python REST 库将 API 构建到 Ruby 类中。

# java - java中已提交内存的确切状态

> ID：206847
> 
> 赞同：13
> 
> 时间：2008-10-15T22:59:02.520
> 
> 标签：java, memory, jvm-hotspot

我很好奇从 MemoryUsage 类中查询值时“已提交”内存的确切含义是什么。该类将其解释为“已提交表示保证可供 Java 虚拟机使用的内存量（以字节为单位）。” 这是否意味着该内存正在被 jvm 进程使用，并且在它被 java 进程释放之前不可用于其他进程，还是意味着如果 java 进程尝试分配最多该内存量，它将成功? 我意识到这可能是特定于实现的，但我只对热点感兴趣。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-15T23:31:21.253

提交的大小是实际分配的内存，使用的大小是用于存储实际数据的大小（当使用 ~= 提交时，是主要 GC 的时间并可能增加堆）。最大大小是堆可以增长的硬限制——如果不够，JVM 会抛出 OutOfMemoryError。

如果内存被提交，那么它肯定可以使用。此外，JVM 无法提交更多内存（在现代操作系统上）的唯一情况是硬件虚拟内存不足。

所有这些大小仅告诉您堆区域的大小。JVM 也有其他内存区域（线程堆栈、JIT 缓存等）。堆区域通常是最大的，这大致对应于进程占用空间。

两个注意事项：

*   如果提交的大小不适合物理内存，它的一部分将被交换到页面文件。这会导致 GC 期间的速度大幅下降，在这种情况下，您将通过减小堆大小来提高应用程序的性能。
*   一些操作系统允许双重预订内存 - 只要你不尝试使用它，你就可以分配尽可能多的内存（忘记它是哪个操作系统 - 有人填写我）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T23:16:26.260

“这是否意味着内存正在被 jvm 进程使用而其他进程不可用”将是正确的。所以它小于（或等于）操作系统看到的 JVM 进程占用的内存量。

[http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html](http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html)（抱歉没有锚链接到）。

# c# - 在 C# 中重定向包含伪 loc (unicode) 字符串的 ConsoleOutput

> ID：206853
> 
> 赞同：6
> 
> 时间：2008-10-15T23:00:46.900
> 
> 标签：c#, command-line, unicode, process, console

我正在运行一个控制台应用程序（myApp.exe），它将伪本地化（unicode）字符串输出到标准输出。如果我在常规命令提示符 (cmd.exe) 中运行它，则 unicode 数据会丢失。如果我在 unicode 命令提示符（cmd.exe /u）中运行它或将控制台的属性设置为“Lucida Console”，那么将保留 unicode 字符串。

我想在 C# 中运行这个应用程序并将 unicode 字符串重定向到一个局部变量中。我正在使用 RedirectStandardOutput = true 的 Process 对象，但 unicode 字符串总是丢失。

如何指定保留此 Unicode 信息？

```
 private static int RunDISM(string Args, out string ConsoleOutput)
        {
            Process process = new Process();
            process.StartInfo.FileName = "myApp.exe";
            process.StartInfo.Arguments = Args;

            try
            {
                process.StartInfo.CreateNoWindow = true;
                process.StartInfo.UseShellExecute = false;
                process.StartInfo.RedirectStandardOutput = true;
                process.StartInfo.WorkingDirectory = Environment.CurrentDirectory;

                process.Start();
                process.WaitForExit(Int32.MaxValue);
            }
            catch (Exception e)
            {
                WEX.Logging.Interop.Log.Assert("Failure while starting or running process.\nERROR: " + e.Message);
                ConsoleOutput = null;
                return EXITCODE_ERROR;
            }

            ConsoleOutput = process.StandardOutput.ReadToEnd();
            return process.ExitCode;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T01:28:30.347

看起来您需要使用ProcessStartInfo 上的[StandardOutputEncoding属性从控制台应用程序更改 StandardOutput 流的编码。](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.standardoutputencoding.aspx)在开始该过程之前，尝试在 try/catch 块中添加以下代码：

```
process.StartInfo.StandardOutputEncoding = Encoding.Unicode; 
```

您可能必须尝试不同的编码，才能确定哪种编码适合您的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-14T20:17:50.530

取出字节，看看它们是否有意义：

```
var b = p.StandardOutput.CurrentEncoding.GetBytes(p.StandardOutput.ReadToEnd()); 
```

一旦确定了实际编码，您就可以使用[标准编码 API](http://msdn.microsoft.com/en-us/library/zs0350fy.aspx)将字节转换为字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-08T09:59:43.903

第一套`process.StartInfo.StandardOutputEncoding = Encoding.Default`。

然后转到`Control Panel`> `Region`> `Administrative`>`Change system locale...`并在那里设置伪本地化字符串的编码。

# python - 抓取动态网站

> ID：206855
> 
> 赞同：12
> 
> 时间：2008-10-15T23:04:13.913
> 
> 标签：python, ajax, screen-scraping, beautifulsoup

抓取大部分内容由看似 ajax 请求生成的动态网站的最佳方法是什么？我以前有过使用 Mechanize、BeautifulSoup 和 python 组合的经验，但我准备尝试一些新的东西。

--编辑--有关更多详细信息：我正在尝试抓取 CNN[主数据库](http://www.cnn.com/ELECTION/2008/primaries/results/state/ "主数据库")。那里有丰富的信息，但似乎没有api。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-19T07:38:59.830

我发现的最佳解决方案是使用 Firebug 监控 XmlHttpRequest，然后使用脚本重新发送它们。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T23:09:14.620

这是一个难题，因为您要么必须对每个站点的 javascript 进行逆向工程，要么实现 javascript 引擎并运行脚本（这有其自身的困难和陷阱）。

这是一个重量级的解决方案，但我看到人们使用greasemonkey 脚本执行此操作——允许Firefox 渲染所有内容并运行javascript，然后抓取元素。如果需要，您甚至可以在页面上启动用户操作。

-亚当

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T01:15:19.467

Selenium IDE 是一种测试工具，我用它来进行大量的屏幕抓取。有一些事情它不能很好地处理（Javascript window.alert() 和一般的弹出窗口），但它通过实际触发点击事件并在文本框中输入来在页面上工作。因为 IDE 部分在 Firefox 中运行，所以您不必进行所有会话管理等，因为 Firefox 会处理它。IDE 记录并回放测试。

它还导出 C#、PHP、Java 等代码以构建在 Selenium 服务器上执行的编译测试/爬虫。我已经为我的多个 Selenium 脚本做到了这一点，这使得将抓取的数据存储在数据库中之类的事情变得更加容易。

脚本的编写和修改相当简单，由 ("clickAndWait","submitButton") 之类的东西组成。考虑到您所描述的内容，值得一看。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-15T23:34:37.487

亚当戴维斯的建议是中肯的。

我还建议您尝试“逆向工程”JavaScript 正在做什么，而不是尝试抓取页面，而是发出 JavaScript 发出的 HTTP 请求并自己解释结果（很可能是 JSON 格式，很好且易于解析）。根据 JavaScript 的复杂性，这种策略可能是微不足道的，也可能是彻头彻尾的噩梦。

当然，最好的可能性是说服网站的维护者实现对开发人员友好的 API。这些天所有很酷的孩子都在这样做 8-) 当然，他们可能不希望他们的数据以自动化的方式被抓取......在这种情况下，你可以期待一个猫捉老鼠的游戏，让他们的页面越来越难以抓取:-(

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T21:22:06.033

有一点学习曲线，但是像 Pamie (Python) 或 Watir (Ruby) 这样的工具可以让您进入 IE 网络浏览器并了解这些元素。事实证明，这比 Mechanize 和其他 HTTP 级别的工具更容易，因为您不必模拟浏览器，只需向浏览器询问 html 元素。而且它比逆向工程 Javascript/Ajax 调用要容易得多。如果需要，您还可以将诸如美丽汤之类的工具与 Pamie 结合使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-19T08:03:11.200

可能最简单的方法是在 C#（或任何其他语言）中使用 IE 浏览器控件。您可以开箱即用地访问浏览器内的所有内容 + 您不需要关心 cookie、SSL 等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T10:47:39.907

我发现 IE Webbrowser 控件有各种各样的怪癖和变通方法，可以证明一些高质量的软件可以处理所有这些不一致，围绕 shvwdoc.dll api 和 mshtml 分层并提供一个框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T00:58:10.813

这似乎是一个非常普遍的问题。我想知道为什么没有人开发程序化浏览器？我正在设想一个 Firefox，您可以从命令行使用 URL 作为参数调用它，它将加载页面，运行所有初始页面加载 JS 事件并保存结果文件。

我的意思是 Firefox 和其他浏览器已经这样做了，为什么我们不能简单地剥离 UI 的东西呢？

# c++ - 如何使用 POSIX 线程实现阻塞读取

> ID：206857
> 
> 赞同：5
> 
> 时间：2008-10-15T23:05:08.810
> 
> 标签：c++, multithreading, pthreads, producer-consumer

我想实现一个生产者/消费者场景，该场景遵循大致如下的接口：

```
class Consumer {
private:
    vector<char> read(size_t n) {
        // If the internal buffer has `n` elements, then dequeue them
        // Otherwise wait for more data and try again
    }
public:
    void run() {
        read(10);
        read(4839);
        // etc
    }
    void feed(const vector<char> &more) {
        // Safely queue the data
        // Notify `read` that there is now more data
    }
}; 
```

在这种情况下，`feed`and`run`将在单独的线程上运行，并且`read`应该是阻塞读取（如`recv`and `fread`）。显然，我需要在我的双端队列上进行某种互斥，并且我需要某种通知系统来通知`read`重试。

我听说**条件变量**是要走的路，但我所有的多线程体验都在 Windows 上，我很难理解它们。

谢谢你的帮助！

（是的，我知道返回向量是低效的。我们不要讨论这个。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-15T23:42:48.093

此代码尚未准备好生产。不对任何库调用的结果进行错误检查。

我已经在 LockThread 中包装了互斥锁的锁定/解锁，所以它是异常安全的。但仅此而已。

此外，如果我认真地这样做，我会将互斥锁和条件变量包装在对象中，这样它们就可以在 Consumer 的其他方法中被滥用。但是只要您注意必须在使用条件变量（以任何方式）之前获取锁，那么这种简单的情况就可以保持原样。

出于兴趣，您检查过 boost 线程库吗？

```
#include <iostream>
#include <vector>
#include <pthread.h>

class LockThread
{
    public:
    LockThread(pthread_mutex_t& m)
        :mutex(m)
    {
        pthread_mutex_lock(&mutex);
    }
    ~LockThread()
    {
        pthread_mutex_unlock(&mutex);
    }
    private:
        pthread_mutex_t& mutex;
};
class Consumer
{
    pthread_mutex_t     lock;
    pthread_cond_t      cond;
    std::vector<char>   unreadData;
    public:
    Consumer()
    {
        pthread_mutex_init(&lock,NULL);
        pthread_cond_init(&cond,NULL);
    }
    ~Consumer()
    {
        pthread_cond_destroy(&cond);
        pthread_mutex_destroy(&lock);
    }

    private:
        std::vector<char> read(size_t n)
        {
            LockThread  locker(lock);
            while (unreadData.size() < n)
            {
                // Must wait until we have n char.
                // This is a while loop because feed may not put enough in.

                // pthread_cond() releases the lock.
                // Thread will not be allowed to continue until
                // signal is called and this thread reacquires the lock.

                pthread_cond_wait(&cond,&lock);

                // Once released from the condition you will have re-aquired the lock.
                // Thus feed() must have exited and released the lock first.
            }

            /*
             * Not sure if this is exactly what you wanted.
             * But the data is copied out of the thread safe buffer
             * into something that can be returned.
             */
            std::vector<char>   result(n); // init result with size n
            std::copy(&unreadData[0],
                      &unreadData[n],
                      &result[0]);

            unreadData.erase(unreadData.begin(),
                             unreadData.begin() + n);
            return (result);
        }
public:
    void run()
    {
        read(10);
        read(4839);
        // etc
    }
    void feed(const std::vector<char> &more)
    {
        LockThread  locker(lock);

        // Once we acquire the lock we can safely modify the buffer.
        std::copy(more.begin(),more.end(),std::back_inserter(unreadData));

        // Only signal the thread if you have the lock
        // Otherwise race conditions happen.
        pthread_cond_signal(&cond);

        // destructor releases the lock and thus allows read thread to continue.
    }
};

int main()
{
    Consumer    c;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T23:57:04.117

我倾向于使用我所说的“同步队列”。我包装普通队列并使用 Semaphore 类来锁定和读取块，就像你想要的那样：

```
#ifndef SYNCQUEUE_20061005_H_
#define SYNCQUEUE_20061005_H_

#include <queue>
#include "Semaphore.h"

// similar, but slightly simpler interface to std::queue
// this queue implementation will serialize pushes and pops
// and block on a pop while empty (as apposed to throwing an exception)
// it also locks as neccessary on insertion and removal to avoid race 
// conditions

template <class T, class C = std::deque<T> > class SyncQueue {
protected:
    std::queue<T, C>    m_Queue;
    Semaphore           m_Semaphore;
    Mutex               m_Mutex;

public:
    typedef typename std::queue<T, C>::value_type value_type;
    typedef typename std::queue<T, C>::size_type size_type;

    explicit SyncQueue(const C& a = C()) : m_Queue(a), m_Semaphore(0) {}

    bool empty() const              { return m_Queue.empty(); }
    size_type size() const          { return m_Queue.size(); }

    void push(const value_type& x);
    value_type pop();
};

template <class T, class C>
void SyncQueue<T, C>::push(const SyncQueue<T, C>::value_type &x) {
    // atomically push item
    m_Mutex.lock(); 
    m_Queue.push(x); 
    m_Mutex.unlock(); 

    // let blocking semaphore know another item has arrived
    m_Semaphore.v();
}

template <class T, class C>
typename SyncQueue<T, C>::value_type SyncQueue<T, C>::pop() {
    // block until we have at least one item
    m_Semaphore.p();

    // atomically read and pop front item
    m_Mutex.lock();
    value_type ret = m_Queue.front();
    m_Queue.pop();
    m_Mutex.unlock();

    return ret;
}

#endif 
```

您可以在线程实现中使用适当的原语来实现信号量和互斥锁。

注意：此实现是队列中单个元素的示例，但您可以轻松地将其包装为缓冲结果直到提供 N 的函数。如果它是一个字符队列，则如下所示：

```
std::vector<char> func(int size) {
    std::vector<char> result;
    while(result.size() != size) {
        result.push_back(my_sync_queue.pop());
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T23:13:29.743

我会扔掉一些半伪代码。以下是我的评论：

1）这里有非常大的锁定颗粒。如果您需要更快的访问速度，您将需要重新考虑您的数据结构。STL 不是线程安全的。

2）锁定将阻塞，直到互斥锁允许它通过。互斥体结构是它使用锁定/解锁机制一次允许 1 个线程通过它。不需要轮询或某种异常式结构。

3）这是一个在句法上相当老套的问题。我对 API 和 C++ 语法并不精确，但我相信它提供了语义上正确的解决方案。

4）根据评论进行编辑。

```
class piper
{
pthread_mutex queuemutex;
pthread_mutex readymutex;
bool isReady; //init to false by constructor

//whatever else
};

piper::read()
{//whatever
pthread_mutex_lock(&queuemutex)
if(myqueue.size() >= n)
{ 
   return_queue_vector.push_back(/* you know what to do here */)

    pthread_mutex_lock(&readymutex)
    isReady = false;
    pthread_mutex_unlock(&readymutex)
}
pthread_mutex_unlock(&queuemutex)
}

piper::push_em_in()
{
//more whatever
pthread_mutex_lock(&queuemutex)
//push push push
if(myqueue.size() >= n)
{
    pthread_mutex_lock(&readymutex)
    isReady = true;
    pthread_mutex_unlock(&readymutex)
}
pthread_mutex_unlock(&queuemutex)
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T00:04:31.873

只是为了好玩，这里是一个使用 Boost 的快速而肮脏的实现。它在支持它的平台上使用 pthreads，在 windows 上使用 windows 操作。

```
boost::mutex access;
boost::condition cond;

// consumer
data read()
{
  boost::mutex::scoped_lock lock(access);
  // this blocks until the data is ready
  cond.wait(lock);

  // queue is ready
  return data_from_queue();
}

// producer
void push(data)
{
  boost::mutex::scoped_lock lock(access);
  // add data to queue

  if (queue_has_enough_data())
    cond.notify_one();  
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T00:36:49.483

为了更有趣，这是我的最终版本。没有充分理由的 STL 化。:-)

```
#include <algorithm>
#include <deque>
#include <pthread.h>

template<typename T>
class MultithreadedReader {
    std::deque<T>   buffer;
    pthread_mutex_t moreDataMutex;
    pthread_cond_t  moreDataCond;

protected:
    template<typename OutputIterator>
    void read(size_t count, OutputIterator result) {
        pthread_mutex_lock(&moreDataMutex);

        while (buffer.size() < count) {
            pthread_cond_wait(&moreDataCond, &moreDataMutex);
        }
        std::copy(buffer.begin(), buffer.begin() + count, result);
        buffer.erase(buffer.begin(), buffer.begin() + count);

        pthread_mutex_unlock(&moreDataMutex);
    }

public:
    MultithreadedReader() {
        pthread_mutex_init(&moreDataMutex, 0);
        pthread_cond_init(&moreDataCond, 0);
    }

    ~MultithreadedReader() {
        pthread_cond_destroy(&moreDataCond);
        pthread_mutex_destroy(&moreDataMutex);
    }

    template<typename InputIterator>
    void feed(InputIterator first, InputIterator last) {
        pthread_mutex_lock(&moreDataMutex);

        buffer.insert(buffer.end(), first, last);
        pthread_cond_signal(&moreDataCond);

        pthread_mutex_unlock(&moreDataMutex);
    }
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T16:44:36.993

Glib 异步队列在读取您正在寻找的空队列时提供锁定和睡眠。请参阅[http://library.gnome.org/devel/glib/2.20/glib-Asynchronous-Queues.html](http://library.gnome.org/devel/glib/2.20/glib-Asynchronous-Queues.html)您可以将它们与 gthread 或 gthread 池结合使用。

# .net - .NET CLR 线程转储是否有相当于 Java 的“kill -3”？

> ID：206858
> 
> 赞同：2
> 
> 时间：2008-10-15T23:05:39.620
> 
> 标签：.net, multithreading, clr, dump

Java 具有由发送到进程的信号 3 触发的线程转储（例如“kill -3 PID”）。我为 .NET 找到的等价物是使用 ADPlus ( [http://support.microsoft.com/kb/286350](http://support.microsoft.com/kb/286350) )。这基本上附加了一个调试器，进行一个小型转储，并执行一些命令。我发现 .NET 的方法是一种非常粗暴、笨拙的方法，而且它似乎也更慢。

有谁知道任何替代方案？

（顺便说一句，我最近找到了以下网址但还没有尝试过：http: [//www.interact-sw.co.uk/iangblog/2004/11/16/stackdump](http://www.interact-sw.co.uk/iangblog/2004/11/16/stackdump)）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T08:30:20.917

msdn 上有一个[“如何创建转储”](http://msdn.microsoft.com/en-us/library/d5zhxt22.aspx)，它提供了 4 种方法，也许第三种方法可能值得您尝试。

1.  在 Visual Studio 中调试本机进程时，可以从“调试”菜单保存转储。有关详细信息，请参阅[如何：保存和打开转储文件](http://msdn.microsoft.com/en-us/library/fk551230.aspx)。

2.  如果您启用了即时调试，您可以附加到在调试器外部运行的崩溃进程，中断该进程，然后保存转储文件。有关详细信息，请参阅[如何：保存和打开转储文件](http://msdn.microsoft.com/en-us/library/fk551230.aspx)。

3.  您可以使用 UserDump 实用程序创建转储，该实用程序是 OEM 支持工具包的一部分。[您可以从http://download.microsoft.com/download/win2000srv/Utility/3.0/NT45/EN-US/Oem3sr2.zip](http://download.microsoft.com/download/win2000srv/Utility/3.0/NT45/EN-US/Oem3sr2.zip)下载副本。

4.  您可以使用 Autodump+ (AD+) 实用程序创建转储，它是 Microsoft Debugging Tools for Windows 的一部分。[您可以从位于http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)的 Windows 硬件开发人员中心下载适用于 Windows 的调试工具。

# c# - 从工作线程更新表单控件的最佳方法是什么？

> ID：206867
> 
> 赞同：6
> 
> 时间：2008-10-15T23:12:32.647
> 
> 标签：c#, multithreading, forms

我已经做了一些研究，但我真的找不到从 C# 中的工作线程更新表单控件的首选方法。我知道 BackgroundWorker 组件，但是不使用 BackgroundWorker 组件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T23:24:09.300

有一条一般的经验法则是说不要从 UI 线程本身以外的任何线程更新 UI。使用 BackgroundWorker 的功能是个好主意，但您不想这样做，并且在不同的线程上发生了一些事情，您应该执行“Invoke”或 BeginInvoke 以强制委托在 UI 线程上执行该方法。

编辑：Jon B 在评论中提出了这一点：

> 请记住，Invoke() 是同步的，而 BeginInvoke() 是异步的。如果使用 Invoke()，则必须小心不要导致死锁。我会推荐 BeginInvoke() 除非你真的需要同步调用。

一些简单的示例代码：

```
// Updates the textbox text.
private void UpdateText(string text)
{
  // Set the textbox text.
  m_TextBox.Text = text;
}

public delegate void UpdateTextCallback(string text);

// Then from your thread you can call this...
m_TextBox.Invoke(new UpdateTextCallback(this.UpdateText),
    new object[]{"Text generated on non-UI thread."}); 
```

上面的代码来自一个关于它的常见问题解答[这里](http://blogs.msdn.com/csharpfaq/archive/2004/03/17/91685.aspx)和一个更长的涉及更多的一个[这里](http://weblogs.asp.net/justin_rogers/articles/126345.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T23:16:11.470

你为什么不想使用 BackgroundWorker 来做呢？它有一个很棒的回调事件，叫做 ProgressChanged，它让 UI 线程知道更新，非常适合进度条类型的更新等。

[链接到详细信息](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T23:18:11.590

有一个与此相关的讨论[这里](https://stackoverflow.com/questions/6184/how-do-i-make-event-callbacks-into-my-win-forms-thread-safe#6189)和一个[这里](https://stackoverflow.com/questions/120540/how-to-update-components-in-different-threads-net-cf)。

本质上，您使用 Invoke 来完成它。

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T00:16:14.970

调用 Invoke 时，我也会考虑 InvokeRequired（仅限 VS2008）。有时您不会从单独的线程更新 UI。它节省了创建委托等的开销。

```
if (InvokeRequired)
        {
            //This.Invoke added to circumvent cross threading exceptions.
            this.Invoke(new UpdateProgressBarHandler(UpdateProgressBar), new object[] { progressPercentage });
        }
        else
        {
            UpdateProgressBar(progressPercentage);
        } 
```

# c# - 从 Web 应用程序打印到客户端打印机

> ID：206880
> 
> 赞同：6
> 
> 时间：2008-10-15T23:21:30.117
> 
> 标签：c#, .net, asp.net, javascript, printing

如果我有一台打印机直接连接到一台电脑（带有打印机的信息亭），我将如何创建网页（.net Web 应用程序）在没有用户干预的情况下将 jpg 打印到信息亭打印机的能力，除了点击页面上的按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T23:30:13.377

这已经被问过好几次了，结果总是你*不能通过*普通的网络技术（HTML + Javascript）来做到这一点。您能做的最好的事情就是打开打印对话框，这是*设计使然*。由于您控制了信息亭，您可以做的是创建某种浏览器扩展（如 Flash 对象、.Net 托管控件、Java 小程序等）并将其提供给您的页面，以便它为您处理打印部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T00:00:51.723

我以两种不同的方式解决了这个问题：

1.  使用 ActiveX
2.  创建像 myprint://PRINT_DATA 这样的协议

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T23:47:06.103

如果您创建了一个托管 Web 浏览器控件的应用程序（而不是直接使用 Web 浏览器），您可以更直接地控制打印过程。

（假设可以使用 Windows + IE）

以下是一些可能有帮助的示例文章：

[配置 WebBrowser 控件](http://en.csharp-online.net/Configure_a_WebBrowser_Control)

[在 C# 应用程序中使用 Web 浏览器控件](http://ryanfarley.com/blog/archive/2004/12/23/1330.aspx)

以及具有 Print 方法的 WebBrowser 类的不断变化的 MSDN 文档。

来自 print 方法的注释：“您可以使用此方法实现类似于 Internet Explorer 中的打印按钮。此方法打印当前文档而无需进一步的用户输入。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T03:49:08.767

其他评论涵盖了您要在网络浏览器的计算机上打印的场景。

However, if you want to print to a printer connected to the web server (ie, the machine running the web application), you can use regular C# printing with the following twist: [http://support.microsoft.com/kb/184291/](http://support.microsoft.com/kb/184291/)

In my context, my kiosk runs both the web server and the web browser, so that solved my problem.

# mysql - 我是否必须将数据库连接/初始化放在 FCGI 循环之外才能利用 Perl 中的 FastCGI？

> ID：206885
> 
> 赞同：6
> 
> 时间：2008-10-15T23:24:24.560
> 
> 标签：mysql, perl, fastcgi

假设我有一些 Perl 代码，每次命中时都会在数据库的特定行中增加一列，我希望它会经常被命中，所以我想用 FCGI 对其进行优化。现在，我基本上将大部分代码包装成这样的：

```
while (FCGI::accept() >= 0) {
 [code which currently creates a db connection and makes calls through it]
} 
```

我想知道将数据库连接（我的 $dbh = DBI->connect(etc)）放在 FCGI 循环之外是否更好，以便脚本保持连接处于活动状态，或者我仍然可以获得 FCGI 在速度方面的优势和资源，让它留在循环中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T01:43:45.777

bmdhacks 是对的，如果您使用的是 MySQL 或 PostgreSQL，那么它并不重要，因为连接非常便宜。但无论您的数据库如何，您都可以通过使用持久连接获得速度提升。

但是，如果您决定使用持久连接，则需要担心连接超时。这些将在您的程序生命周期内的任何时候发生，具体取决于您的服务器设置和您获得的流量。`ping()`是你的朋友吗？如果您需要更多帮助，请查看`Apache::DBI`它是如何实现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T08:45:51.367

不要将连接放在循环之外，您可能会失去连接，然后无法重新连接。您可以将其放入全局，但随后您必须进行连接检查并自己重新连接。

相反，请使用[Ima::DBI](http://search.cpan.org/perldoc?Ima::DBI)或[`DBI->connect_cached()`](http://search.cpan.org/perldoc?DBI#connect_cached)为您进行连接缓存。它将完成所有工作以确保连接处于活动状态并在必要时重新连接。

但在你费心之前，先做一些基准测试来找出你的瓶颈到底在哪里。过去我曾让数据库连接成为瓶颈，但那是 Oracle 的问题，也是 10 多年前的事了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T23:29:26.670

即使您确实将数据库连接保持在循环中，您仍然会从 FCGI 中受益——但如果您将其移出，您将获得更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T23:55:24.370

连接性能很大程度上取决于您使用的数据库。PostgreSQL 和 MySQL 的连接速度非常快（尤其是 MySQL），因此通常会在每个请求上连接。Oracle 等其他数据库的速度稍慢，并且往往需要更长的连接生命周期。通过使用 DBI->connect() 编写一个 while 1..100000 循环并断开连接以查看数据库的速度应该很容易测试。

# wcf - 为 WCF 服务定义 SLA

> ID：206890
> 
> 赞同：2
> 
> 时间：2008-10-15T23:26:49.593
> 
> 标签：wcf, web-services, soa

我必须对一堆相互依赖的服务进行性能/负载测试。他们都使用 net.tcp 并且大多数使用双工合同和内部排队。[使用 lock(syncRoot) { if(queue.Empty) Thread.Wait(); 处理 POCO 队列类 }]

这是我想出的方法：

1.  确定要进行性能测试的 WCF 服务
2.  确定每个服务的相关性能计数器
3.  确定将通过正在测试的服务执行的逻辑起点
4.  使用 VS.Net 为每个服务自动生成单元测试
5.  编写特定的功能测试（例如，我可以使用一个用例 - “下订单” - 并编写对相关服务进行所有调用并通常执行几乎所有所需功能的测试）
6.  使用运行 #5 中的跟踪文件生成单元测试 [使用 CodePlex 的 WCF 负载测试]（在我看来，这似乎是在调试环境中重新创建生产/字段中的用户错误的理想工具。免责声明：未使用该工具。印象从阅读项目描述）
7.  可以调整上面的测试以使用自动生成的输入数据进行调用
8.  为输入引入变化，以便执行不同的代码路径
9.  来自性能计数器的日志数据
10.  分析和识别瓶颈

问题：

1.  有更好的方法吗？
2.  对于使用内部队列的服务，使用标准性能计数器测量性能是一个问题。我可能需要自定义计数器？
3.  如果 #1 为真，有没有办法在不更改被测试服务代码的情况下引入客户计数器？
4.  我应该关心我的功能测试的结果吗？
5.  有没有办法 [非侵入式] 为 WCF 服务实施 SLA？（我认为，如果我的计数器有足够的数据，例如服务的请求、发生的异常、响应时间等，我应该能够验证我的 SLA - 在 5 分钟内处理 200,000 个请求，每个请求的响应时间为 2 秒 -反对这些数字。我的问题也许是我是否可以仅指定我的 SLA，并且产品/工具可以在幕后完成所有工作并为我提供表格答案？我知道...我知道...我做白日梦:))
6.  旁白：在 WCF 服务内部对请求进行排队的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T03:28:22.443

哇……标题绝对是冰山一角！希望我的回答不会离题！:)

1.  WCF 服务的性能测试可以通过多种不同的方式完成：使用 Microsoft Team Test、Borland Silk Performer、Mercury LoadRunner 等测试工具，或 LoadGen 或自定义测试工具等工具。我的偏好是尝试采用您在创建某种功能单元测试然后将数据输入该测试中所做的方法，同时使用测试工具来启动该测试的多个并发实例（虚拟“用户”） . 大多数商业测试工具的工具确实促进了这种类型的测试，因此在这里很难出错。最大的挑战通常来自维护测试用例和测试数据以支持测试应用程序。

2.  WCF 没有任何与性能相关的内置计数器。这实际上是一个盲点。当然，您可以看到与服务器建立了多少连接，但这是粗略的信息，您可能想知道哪些服务正在为这些请求提供服务。有传言称，作为为 WCF/WF 提供丰富托管环境的一部分，Microsoft 的“都柏林”将包括为托管服务显示性能计数器。我们将不得不拭目以待，看看实际会发生什么。

3.  如果我需要在不影响现有代码库的情况下检测 WCF 服务，我会研究我可以从 WCF 行为中获得多少里程并将其应用于服务。这种自定义行为可能会显示您可能需要的性能计数器。

4.  是的。我会关心功能测试的结果（意味着性能？）。需要注意的是，可能存在一些可以忽略的启动 (JIT)。我可能希望分析功能测试的执行以获取执行指标 - 但我不会在性能运行期间打开代码分析。

5.  对于 SLA 的再次自定义行为可能是答案。您可以将操作指标记录到数据库中，然后将其报告出来。Amberpoint 和 SOA Software 等商业产品也将为此提供支持（包括性能计数器）。

6.  排队对 wcf 服务的请求？我立即想到 net.msmq 绑定，特别是如果您希望使请求持久。

# c# - 尝试在调试中编辑时不允许更改为 64 位，为什么？

> ID：206894
> 
> 赞同：1
> 
> 时间：2008-10-15T23:27:40.510
> 
> 标签：c#, .net, .net-2.0, editing, compilation

当我尝试在调试中编辑时收到此消息（见下图）。这仅发生在我的 Vista64 位操作系统中，而不发生在我的 XP 计算机中。为什么以及我应该怎么做？

**更新** 我发现我需要在 x86 中编译才能在调试时更改值。所以我的问题是为什么我不能在 x64 中做到这一点？

[替代文字 http://img183.imageshack.us/img183/8523/changetohe5.png](http://img183.imageshack.us/img183/8523/changetohe5.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T23:35:10.073

没有技术原因，只是没有实施。根据一些消息来源，微软希望在 CLR 的下一个版本中实现它。

请参阅：http: [//blogs.msdn.com/stevejs/archive/2005/11/15/493018.aspx#499593](http://blogs.msdn.com/stevejs/archive/2005/11/15/493018.aspx#499593)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T23:37:26.653

迈克·斯托尔[说](http://blogs.msdn.com/jmstall/archive/2006/02/13/cant-do-enc.aspx)：

> EnC 做了一些非常低级的事情，这些事情非常特定于操作系统，因此限制在单个平台上主要是资源限制。未来的 CLR 无疑会扩展这一点。我们的移植工作在 V2 中也是从头开始的，因此所有其余的调试服务也必须移植，所以我们在这里已经有了一个非常大的项目。此外，我们认为 EnC 的最大场景将围绕纯 IL 应用程序展开，这些应用程序至少允许人们在 x86 中进行开发。在这种情况下有一个解决方法：在 64 位机器上，您可以在 WOW 中将纯 IL 应用程序作为 32 位应用程序启动，然后对其执行 EnC。
> 
> 这些都是 CLR 的限制，而不是 Visual Studio，这意味着如果第 3 方调试器添加 EnC，它们将具有相同的限制。在所有情况下，我们都感到高兴的是，启用每个案例的成本可以更好地用于使核心场景更强大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T23:30:18.680

我更改了配置管理器。它正在编译到任何 Cpu ......并且任何 Cpu 设置为 x64 ......我将任何 Cpu 更改为 x86 并且它可以工作。于是问题就解决了……

有人能告诉我为什么在 X64 中我们不能在调试中编辑吗？（如果有人有这个子问题的答案，我会接受）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T23:34:15.723

大概他们还没有为 x64 代码实现编辑并继续。我不认为有任何更深层次的原因。

# html - 截断 URL 以使其适合布局的最佳方法是什么

> ID：206899
> 
> 赞同：5
> 
> 时间：2008-10-15T23:30:15.107
> 
> 标签：html, css

在网页中显示 URL 时截断 URL 的最佳方法是什么？我的意思不是链接，而是将 URL 作为值显示给用户，假设文本可能位于固定宽度的容器中，并且您不想在容器外包装或运行？

从末尾截断是否更好，有利于 url 的早期部分：

例如。http/really.long/urlthaticantf...ere.html

或者将“...”放在中间，以支持链接的开头和结尾作为提供上下文的最大价值：

例如。http/really.long/ur...aticantfithere.html

此外，在选择截断 URL 的时间长度时，有什么好的经验法则？您是否应该悲观并选择一个可能的宽字符，例如大写“M”，看看其中有多少适合布局？一般来说，这往往会给出非常短的 URL，因为大多数字符都比“M”窄得多。

或者您应该乐观地使用截断，这种截断通常会提供良好的长度，但当 URL 包含许多大字符时可能会出现溢出的风险？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T02:10:35.877

我的偏好是显示 URL 中最关键的部分。这是被请求的文件，请求的域是我认为关键的，中间路径和查询字符串是我认为非关键的东西。

因此，如果您有[http://www.Example.com/archives/2005/08/09/something.html](http://www.Example.com/archives/2005/08/09/something.html)，我会将其截断为 www.Example.com/.../something.html

当然，在某些情况下这是行不通的。获取此页面的 URL：

[截断 URL 以使其适合布局的最佳方法是什么](https://stackoverflow.com/questions/206899/whats-the-best-way-to-truncate-a-url-so-that-it-fits-within-a-layout)

在这种情况下，我会将 URL 的最后一部分截断为合理数量的字符（最好在非 alpha 上中断），例如：

stackoverflow.com/.../whats-the-best...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T23:33:56.100

由于您给出的原因，截断中间部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T07:45:13.517

摆脱中间，没有人需要知道一个链接的目录结构。域很重要，实际文件很重要。

例子：

```
http://www.domainname.com/folder/.../file.php 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T23:34:06.817

我总是想看看服务器。在我访问的一些论坛中，来自可疑服务器的键盘记录器出现了一波又一波，这让我对服务器产生了偏执。

理想情况下，我可以滚动并查看容器中的整个 url。:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T23:35:23.960

我希望至少能看到服务器。只要我可以将鼠标悬停在链接上并在我的状态栏中看到它的其余部分，我就很高兴。

想想 Slashdot 评论系统中的链接。

# python - 帮助 python Entry小部件中的事件

> ID：206916
> 
> 赞同：1
> 
> 时间：2008-10-15T23:35:52.070
> 
> 标签：python, events, widget, tkinter

我正在用 python 编写一些代码，但在尝试检索 Entry 小部件的内容时遇到了麻烦。问题是：我想限制可以输入的字符，所以当我达到特定的字符数（在这种情况下为 2）时，我试图清除 Entry 小部件，但看起来我总是错过最后一次输入特点。我在打印中添加了丢失的字符以显示。

这是示例代码：

```
from Tkinter import *
class sampleFrame:
    def __init__(self, master):
        self.__frame = Frame(master)
        self.__frame.pack()
    def get_frame(self):
        return self.__frame

class sampleClass:
    def __init__(self, master):
        self.__aLabel = Label(master,text="aLabel", width=10)
        self.__aLabel.pack(side=LEFT)
        self.__aEntry = Entry (master, width=2)
        self.__aEntry.bind('<Key>', lambda event: self.callback(event, self.__aEntry))
        self.__aEntry.pack(side=LEFT)

    def callback(self, event, widgetName):
        self.__value = widgetName.get()+event.char
        print self.__value
        if len(self.__value)>2:
            widgetName.delete(2,4)

root = Tk()
aSampleFrame = sampleFrame(root)
aSampleClass = sampleClass(aSampleFrame.get_frame())
root.mainloop() 
```

任何帮助都感激不尽！

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T00:30:58.950

首先，在您进行删除后，事件会继续正常处理，即插入字符。您需要向 Tkinter 发出信号，表明该事件应该被忽略。

因此，在上面的代码中，添加标记的行：

```
if len(self.__value) > 2:
    widgetName.delete(2,4)
    return "break" # add this line 
```

另一方面，你为什么要通过 lambda？事件具有您可以使用的 .widget 属性。因此，您可以将代码更改为：

```
 self.__aEntry.bind('<Key>', self.callback) # ※ here!
    self.__aEntry.pack(side=LEFT)

def callback(self, event):
    self.__value = event.widget.get()+event.char # ※ here!
    print self.__value
    if len(self.__value)>2:
        event.widget.delete(2,4) # ※ here!
        return "break" 
```

所有更改的行都标有“这里！”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T14:06:30.483

更具体地说，Tk 小部件具有所谓的“绑定标签”。处理事件时，会考虑小部件上的每个绑定标签，以查看它是否具有绑定。默认情况下，小部件将具有小部件、小部件类、根小部件和“全部”作为其绑定标签。因此，与小部件的绑定将在默认绑定之前发生。处理完绑定后，您可以通过返回“中断”来防止考虑任何进一步的绑定标签。

后果是这样的：如果您在小部件上进行绑定，则类、根窗口和“所有”绑定也可能会触发。此外，您附加到小部件的任何绑定都会在类绑定*之前*触发，这是默认行为（例如：插入字符）发生的地方。在您可能希望在默认行为之后而不是之前处理事件的情况下，请务必注意这一点。

# java - 如何使用 Eclipse 开发 Java Servlet？

> ID：206924
> 
> 赞同：63
> 
> 时间：2008-10-15T23:42:00.637
> 
> 标签：java, eclipse, servlets, plugins

我想使用 Eclipse 对 Java servlet 进行编程，并计划使用 Tomcat 部署它们。我想我可以使用与 Eclipse 捆绑的 Ant 构建项目。我有标准的 Eclipse IDE。在 Eclipse 中进行 Servlet 开发有哪些选择？我需要对 Eclipse 进行哪些更改？我需要安装插件吗？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-10-15T23:54:17.213

你需要安装一个插件，eclipse 基金会有一个免费的，叫做[Web Tools Platform](http://www.eclipse.org/webtools/)。它具有您需要的所有开发功能。

您可以获得[Java EE 版的](http://www.eclipse.org/downloads/)eclipse 并预先安装它。

要创建并运行您的第一个 servlet：

1.  新建...项目...动态 Web 项目。
2.  右键单击项目...新建 Servlet。
3.  `doGet()`在方法中写一些代码。
4.  在 Java EE 透视图中找到服务器视图，它通常是底部的选项卡之一。
5.  右键单击那里并选择新服务器。
6.  选择 Tomcat XX，向导将引导您找到安装。
7.  右键单击您刚刚创建的服务器并选择*添加和删除...*并添加您创建的 Web 项目。
8.  右键单击您的 servlet，然后选择运行 > 在服务器上运行...

那应该为你做。如果您愿意，您可以在此处使用 ant 构建，但 eclipse 实际上会执行构建并自动将更改部署到服务器。使用 Tomcat，您可能需要根据更改不时重新启动它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T23:46:59.473

我用的是 Eclipse Java EE 版

创建“动态 Web 项目”

对于我正在使用的 Tomcat 版本，在服务器视图中安装本地服务器。然后调试，并在该服务器上运行以进行测试。

当我部署时，我将项目导出到一个战争文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-15T18:21:26.153

或者，您可以使用 Jetty，它是（现在）Ecipe 平台的一部分（帮助系统正在运行 Jetty）。除了 Jetty 被 Android、Windows Mobile 使用。

要开始查看[Eclipse Wiki](http://wiki.eclipse.org/Jetty/Starting/Quick_Start_Guide) ，或者如果您更喜欢[视频](http://www.redmonk.com/cote/2009/04/16/jetty-at-eclipse-eclipsecon-2009/) 并查看此相关[帖子](https://stackoverflow.com/questions/1515654/what-is-a-lightweight-fast-java-servlet-container)！

# optimization - 稀疏最小二乘回归工具

> ID：206948
> 
> 赞同：7
> 
> 时间：2008-10-15T23:59:30.230
> 
> 标签：optimization, math, statistics, regression, least-squares

我想用几十万个例子做稀疏的高维（几千个特征）最小二乘回归。我很高兴使用非花哨的优化——随机梯度下降很好。

有谁知道任何已经为此实现的软件，所以我不必自己写信？

亲切的问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T00:02:26.917

虽然我不确定，但这让我觉得[LAPACK](http://www.netlib.org/lapack/)（线性代数包）能够提供支持。他们通常对大型矩阵数学感兴趣，包括稀疏矩阵和核外大小。基本版本是 FORTRAN，但有 C 和其他语言的库端口。

由于 LAPACK 的许多底层调用使用 BLAS（基本线性代数子程序），您可能还想查看[Sparse BLAS](http://math.nist.gov/spblas/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T00:35:15.680

我很确定[R 包](http://www.r-project.org/)可用于解决此类问题。它非常强大和灵活。从该页面链接的许多在线资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T00:02:44.823

我建议看看[LAPACK](http://www.netlib.org/lapack/)。它是一个非常成熟的线性代数库，虽然与它的接口可能有点棘手，因为它是用 Fortran 编写的。不过，这很好，因为 Fortran 与 C 的 ABI 兼容，如果你的函数原型正确的话。

[编辑] 经过进一步审查，LA​​PACK 似乎不支持稀疏矩阵。它可以出于某些目的处理带状矩阵，但对于线性最小二乘问题，它只支持一般矩阵。

# c# - 将数据集导出到 excel 错误：HRESULT 异常：0x800A03EC

> ID：206950
> 
> 赞同：0
> 
> 时间：2008-10-15T23:59:47.873
> 
> 标签：c#, excel

我在导出到 excel 时遇到问题，它在 .set_Value 函数处崩溃。

如果我将 object[,] 更改为 string[,] 似乎可以工作，但这样做会丢失格式。

有人帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T00:03:17.320

你传递 ' `null`' 是为了缺少参数而不是`System.Reflection.Missing.Value`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T21:17:14.690

我正在通过，`Missing.Value`但我发现了导致这种特殊失败的原因。object[,] 有一个`=`符号作为某些单元格中的第一个字符，这导致 Excel 失败，所以我检查了列类型字符串并检查了值，然后在符号前面`if substring(0,1) == "="`添加了一个。`'``=`

# java - 如何将排序后的索引映射回我正在排序的集合的原始索引

> ID：206953
> 
> 赞同：1
> 
> 时间：2008-10-16T00:00:22.753
> 
> 标签：java, sorting, collections

我有一个集合 (List<Rectangle>)，我需要对它进行左右排序。那部分很容易。*然后我想以原始*顺序遍历矩形，但很容易在排序集合中找到它们的索引。indexOf() 不起作用，因为我可能有许多相等的对象。我不禁觉得应该有一个简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T00:06:32.820

如果您没有数以万计的对象，您可以将它们存储在两个单独的集合中，一个是原始的，一个是排序的。请记住，Java 中的集合类仅存储对对象的*引用*，因此它不会像看起来那样占用太多内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T00:29:25.270

我找到了一个解决方案 - 但也许有一个更整洁/更优化的解决方案。

```
List<Rectangle> originalRects = ...;

/* record index of each rectangle object.
 * Using a hash map makes lookups efficient,
 * and using an IdentityHashMap means we lookup by object identity
 * not value.
 */
IdentityHashMap<Rectangle, Integer> originalIndices = new IdentityHashMap<Rectangle, Integer>();
for(int i=0; i<originalRects.size(); i++) {
    originalIndices.put(originalRects.get(i), i);
}

/* copy rectangle list */
List<Rectangle> sortedRects = new ArrayList<Rectangle>();
sortedRects.addAll(originalRects);

/* and sort */
Collections.sort(sortedRects, new LeftToRightComparator());

/* Loop through original list */
for(int i=0; i<sortedRects.size(); i++) {
    Rectangle rect = sortedRects.get(i);
    /* Lookup original index efficiently */
    int origIndex = originalIndices.get(rect);

    /* I know the original, and sorted indices plus the rectangle itself */
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:16:53.063

克隆列表并对其中一个进行排序。对同一个对象有两个引用对 indexOf() 来说并不重要，因为指向同一个对象的指针是相同的，你无法分辨它们。如果您有两个相等但不相同的对象，并且您确实想区分它们，那么您确实遇到了问题，因为 indexOf() 正在使用 equal 方法。在这种情况下，最好的解决方案可能是简单地遍历列表并检查对象身份 (==)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T01:32:55.127

另一种方法是对索引数组进行排序，而不是对原始列表进行排序。该数组以标识数组 a[0] = 0、a[1] = 1 等开始，然后使用自定义比较器/排序来获取索引数组。不需要太多额外空间，因为您只有一个额外的整数数组而不是另一个集合。

# .net - 如何在 .net Web 服务中序列化可为空的 DateTime？

> ID：206957
> 
> 赞同：3
> 
> 时间：2008-10-16T00:01:50.660
> 
> 标签：.net, web-services, datetime, serialization

我正在尝试通过 Web 服务将一些 Subsonic 集合传递给客户端。当我引用 Web 服务时，IDE 抱怨：

无法序列化 System.Nullable`1[System.DateTime] 类型的成员“EndDate”。XmlAttribute/XmlText 不能用于编码复杂类型。

有没有办法在 .net Web 服务中序列化可为空的复杂类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T23:33:17.393

处理可选属性的方式是包含一个布尔值 XXXSpecified 成员，其中 XXX 是属性的名称。ASMX 使用的 xml 序列化程序未正确处理可空类型。请注意，这不是 WCF 的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T00:05:23.213

这是 .NET 限制

如果您愿意，可以尝试在 web.config 文件的 SubSonicService 部分中使用此属性生成您的类。

generateNullableProperties="false"

[http://forums.subsonicproject.com/forums/t/3285.aspx](http://forums.subsonicproject.com/forums/t/3285.aspx)

# language-agnostic - 我应该把“丑”放在哪里？

> ID：206968
> 
> 赞同：2
> 
> 时间：2008-10-16T00:06:37.983
> 
> 标签：language-agnostic, refactoring

场景：我有一个需要以某种方式调整的功能（例如；使其在不同地方的工作方式略有不同）。出于某种原因，我最终不得不在代码中添加一些丑陋的东西，无论是在函数中还是在现有的调用站点。假设在这两种情况下，“丑陋”的总和是相同的。

问题是我应该选择哪个选项，为什么？

我应该封装它以便我不需要查看它还是应该提取它以便它不会向函数添加语义垃圾？

什么会影响你的选择？如果：

*   除了从当前位置之外，该函数将“永远不会”被调用。
*   对函数的新调用不需要“丑陋”。
*   该功能现在非常干净和通用
*   该功能已经是一项黑客工作。
*   你写了函数
*   你没有写出这个功能
*   等等

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T00:18:40.767

把丑陋的东西放在功能中，放下手。如果这是在 C++ 中，请确保在 .cpp 文件中有实现。也许您可以考虑编写两个函数来从主函数体中抽象出丑陋的东西。

程序/OOP 编程的存在是为了将“丑陋”从界面中剔除（除其他外）。重要的是要意识到调用函数所需的代码越多，它的用处就越少。还要记住清楚地记录代码并注意那里有丑陋的代码以及原因。

此外，如果此函数足够大，您可以考虑将其放入自己的 .cs 文件或 .cpp/.h 对（取决于您使用的语言）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T00:20:28.017

如果新调用者不需要丑陋，那么我会将丑陋封装在一个新函数/助手/任何东西中，并从旧调用者那里调用它，这样它就不会污染新调用者的现有函数，也不会在老来电者之间重复。

如果新的调用者永远不需要它，那么我会将它添加到函数中（如果它在函数的上下文中有意义），因为它本质上是一个遗留组件，只要你可以适当地测试功能。

最重要的是，我会尽量减少在多个调用者之间没有重复和最大限度地减少对新代码的暴露的丑陋。我会将它封装到可以对其进行单元测试的程度。

谁写的不会影响我的决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T02:30:39.050

我会将丑陋的东西封装在一个包装器函数中，并更改所有需要丑陋器的函数来使用包装器。

```
//old call
call_some_function_with_ugly(params, case)

// new call
call_some_function(params)

void call_some_function(params){ }

void call_some_function_with_ugly(params, case){
    // do ugly depending on case
    switch(case) { ... }

    call_some_function(params);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T00:22:00.043

我会亲自将它放在函数声明中 - 我无法理解将它放在函数调用中如何“不那么难看”，因为您可能（至少，您暗示）您必须使用“丑”不止一次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T06:31:50.623

绝对把丑陋放在函数里。您可以做的最糟糕的事情之一是将丑陋传播到代码的其余部分，在许多单独的实例中它将被隔离。一旦丑陋以某种不可预见的方式发生变化（丑陋经常发生这种情况），这些将无法追踪。

当然，最好的选择是一开始就没有任何丑陋……你现在在想什么特别的例子？

# database-design - 在数据库中存储多个标志的最佳方法

> ID：206970
> 
> 赞同：15
> 
> 时间：2008-10-16T00:07:40.367
> 
> 标签：database-design

我有一个基于 Web 的应用程序，它通过电子邮件通知用户网站上的活动。用户可以选择他们想要接收的通知类型。到目前为止，大约有 10 种不同的选项（每一种都是真/假）。

我目前将它作为 0 或 1 以逗号分隔的形式存储在一个 varchar 字段中。例如：1,0,0,0,1,1,1,1,0,0

这可行，但很难添加新的通知标志并跟踪哪个标志属于哪个通知。这样做有公认的标准吗？我正在考虑为每种通知类型添加另一个包含一列的表。然后，如果需要，我可以添加新列，但我不确定这有多有效。

提前致谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-16T00:18:43.340

我会用两张桌子。一个表将存储用户数据，另一个表将存储他们订阅的通知。第二个表看起来像这样：

```
create table notifications (
   user_id int,
   notification_type int
); 
```

我会在 user_id 和用户表中的用户 id 之间建立 FK 关系，并在删除时进行级联。使用 user_id 和 notification_type 作为主键。要检查用户是否需要特定通知，只需在两个表之间进行连接，然后选择 notification_type 与所讨论的匹配的行。如果结果集非空，则用户需要通知。

添加新通知变得微不足道（删除也是如此）。只需添加（删除）一个新的类型值，让用户选择接受或不接受。如果您想将通知类型保存在表格中以通过也可以工作的应用程序进行管理，但这会稍微复杂一些。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T00:42:55.710

使用 MySQL？

那么，SET 数据类型就是答案。

“MySQL SET 数据类型在 MySQL 表中存储为整数值，占用 1 到 8 个字节，具体取决于可用元素的数量。” - [http://dev.mysql.com/tech-resources/articles/mysql-set-datatype.html](http://dev.mysql.com/tech-resources/articles/mysql-set-datatype.html) “

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T00:13:04.163

我会使用 10 个不同的位或布尔字段。但是，如果您要在一个字段中执行此操作，则可以使用位图 0x1111111111 作为大整数或不带逗号的文本字段。我使用所有这些技术处理过不同的应用程序。但我实际上只是使用多个字段。在上面做选择语句会容易得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T02:06:43.093

如果您确实决定使用像@stephenbayer 提到的位字段，您始终可以在表格上使用视图，以使开发人员更容易使用。这意味着您仍然可以节省位字段的空间，并且可以轻松使用每个字段的单独列，同时避免解析列。

如前所述，如果您希望您的解决方案更具可扩展性，那么单独的表格是一个很好的选择。唯一的缺点是稍微增加了复杂性。

这是权衡。如果您想要一些非常容易实现且速度很快的东西，请考虑位域。如果你想要一些更容易扩展和维护的东西，代价是稍微复杂一点，那么一定要选择单独的表。如果投票告诉您任何事情，您可能想要遵循单独的表格实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T00:10:23.607

我希望让数据库通过使用 Bool 列来管理它会更好。我似乎记得有些系统会将布尔值打包成比特（null 可能会搞砸）。为避免混乱，您可以将其设为单独的表。

（我不是 DBA）

*编辑：拍脑袋“我只是建议你到底是什么”：b*

# vb.net - VB.NET 中的泛型函数

> ID：206982
> 
> 赞同：1
> 
> 时间：2008-10-16T00:15:52.770
> 
> 标签：vb.net, nhibernate, generics

我一般不太熟悉泛型（概念或语法）（缺少在集合中使用它们等等），但我想知道以下是否是完成我想要的最佳方式。实际上，我并不完全肯定泛型会在这种情况下解决我的问题。

我已经在 NHibernate 中建模和映射了几十个对象，并且需要某种通用类来进行我的 CRUD 操作，而不是为每种类型创建一个单独的持久类。例如

```
Sub Update(someObject as Object, objectType as String)
     Dim session As ISession = NHibernateHelper.OpenSession
     Dim transaction As ITransaction = session.BeginTransaction
     session.Update(ctype(someObject, objectType))
     transaction.Commit()
End Sub 
```

其中 someObject 可以是不同的类型。我知道这不是最好的方法（或者它甚至会起作用），但我希望有人能引导我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T00:57:29.770

这里的关键问题是： session.Update 将什么作为参数？如果 session.Update 允许一个通用对象，那么我就使用它：

```
 Sub Update(Of T)(ByVal someObject As T)
     Dim session As ISession = NHibernateHelper.OpenSession
     Dim transaction As ITransaction = session.BeginTransaction
     session.Update(someObject)
     transaction.Commit()
 End Sub 
```

这会将泛型类型 T 流向 session.Update。

如果 session.Update 只接受一个对象，那么只需传入该对象；无需 CType 它。此外，如果 objectType (string) 只是当前对象的类型名称，则最好首先使用 someObject.GetType()。

# asp.net - 以编程方式将 gridview 行置于编辑模式

> ID：206983
> 
> 赞同：14
> 
> 时间：2008-10-16T00:16:11.613
> 
> 标签：asp.net, gridview

如何以编程方式将 gridview 行置于编辑模式？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-16T00:30:02.977

将 EditIndex 属性设置为适当的行，然后将 GridVIew 再次重新绑定到它的 DataSource。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T00:23:31.523

只需实现 Row_Editing 事件并执行以下操作：

```
protected void Row_Editing(object sender, GridViewEditArgs e) 
{
  myGridView.EditItemIndex = e.EditItemIndex; 
  BindData(); 
} 
```

绑定数据将使用数据填充 GridView。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-24T00:55:09.347

```
protected void gridview_RowEditing(object sender, GridViewEditEventArgs e)
{
    GridView gv = (GridView)sender;
    // Change the row state
    gv.Rows[e.NewEditIndex].RowState = DataControlRowState.Edit;           
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-03T14:57:33.153

您可能还需要知道如何取消编辑。就像您在gridview 中设置“OnRowEditing”命令一样，您需要设置“OnRowCancelingEdit”命令。后端应该与此类似。(五)

```
Sub gridView1_rowCanceling(ByVal sender As Object, ByVal e As GridViewCancelEditEventArgs)
    gridView1.EditIndex = -1
    BindData()  // <-- Whatever procedure you use to bind your data to the gridView
End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-27T14:47:00.510

```
protected void btnEdit_Click(object sender, EventArgs e)
{
    GridView1.EditIndex = 1;
} 
```

用 vs-2008 测试。叉很好。

# javascript - 如何在javascript中取消设置数组中的元素？

> ID：206988
> 
> 赞同：152
> 
> 时间：2008-10-16T00:17:42.267
> 
> 标签：javascript, arrays

如何从数组 foo 中删除键 'bar' 以使 'bar' 不会出现在

```
for(key in foo){alert(key);} 
```

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2009-08-28T05:08:40.943

不要使用**delete**，因为它不会从数组中删除元素，只会将其设置为未定义，然后不会正确反映在数组的长度中。

如果您知道密钥，则应使用**splice**即

```
myArray.splice(key, 1); 
```

对于像史蒂文这样的人，你可以尝试这样的事情：

```
for (var key in myArray) {
    if (key == 'bar') {
        myArray.splice(key, 1);
    }
} 
```

或者

```
for (var key in myArray) {
    if (myArray[key] == 'bar') {
        myArray.splice(key, 1);
    }
} 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2008-10-16T00:21:10.857

```
delete foo[key]; 
```

:D

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2014-01-09T12:28:52.410

如果您知道键名，只需这样做：

```
delete array['key_name'] 
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2010-05-04T15:06:29.833

一个重要的提示：JavaScript 数组与您可能在 PHP 中使用的那些关联数组不同。如果您的“数组键”是字符串，则您不再对数组的内容进行操作。您的数组是一个对象，并且您使用括号表示法来访问名为 <key name> 的成员。因此：

```
var myArray = [];
myArray["bar"] = true;
myArray["foo"] = true;
警报（myArray.length）；// 返回 0。

```

因为您没有向数组中添加元素，所以您只修改了 myArray 的 bar 和 foo 成员。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-10-12T06:23:04.307

我会这样做

```
 myArray.splice( myArray.indexOf('bar') , 1) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-04T08:01:39.940

[http://www.internetdoc.info/javascript-function/remove-key-from-array.htm](http://www.internetdoc.info/javascript-function/remove-key-from-array.htm)

```
removeKey(arrayName,key);

function removeKey(arrayName,key)
{
 var x;
 var tmpArray = new Array();
 for(x in arrayName)
 {
  if(x!=key) { tmpArray[x] = arrayName[x]; }
 }
 return tmpArray;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-12T22:58:27.293

删除和拼接之间有一个重要的区别：

原始数组：

[<1 个空项>，'一'，<3 个空项>，'五'，<3 个空项>，'九个']

拼接后（array.splice(1,1)）：

[<4 个空项>，'5'，<3 个空项>，'9']

删除后（删除数组 [1]）：

[<5 个空项>，'5'，<3 个空项>，'9']

# javascript - JQuery/Javascript：IE 悬停不包括选择框选项？

> ID：206997
> 
> 赞同：3
> 
> 时间：2008-10-16T00:22:07.157
> 
> 标签：javascript, cross-browser

我有这段脚本可以在鼠标悬停时加宽文本框并在鼠标悬停时缩短文本框。

我遇到的问题是 Internet Explorer 似乎没有将其悬停在选择框的选项上。

这意味着在 IE 中我可以单击选择，下拉选项，但是如果我尝试选择一个，它们就会消失，并且一旦我离开选择框本身，选择框就会重新调整大小。

示例代码：

```
<script type='text/javascript'>
$(function() {
$('#TheSelect').hover(
    function(e){
        $('#TheText').val('OVER');
        $(this).width( 600 );
    },
    function(e){
        $('#TheText').val('OUT');
        $(this).width( 50 );
   }
);
});
</script> 
```

和：

```
<input type='text' id='TheText' /><br /><br />

<select id='TheSelect' style='width:50px;'>
    <option value='1'>One</option>
    <option value='2'>Two</option>
    <option value='3'>Three</option>
    <option value='42,693,748,756'>Forty-two billion, six-hundred and ninety-three million, seven-hundred-forty-some-odd..... </option>
    <option value='5'>Five</option>
    <option value='6'>Six</option>
    <option value='7'>Seven...</option>
</select> 
```

IE中的选择框有什么解决方法吗？如果有人可以推荐一个真正可靠的，我什至会考虑替换 jquery。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T15:59:19.713

看起来这篇文章已经发布了一段时间，但希望仍有人对解决方法感兴趣。我在构建我正在开发的新站点时遇到了这个问题。它上面是一个产品滑块，对于每个产品，将鼠标悬停在产品上会弹出一个带有产品信息的大信息气泡、一个用于选择购买选项的下拉菜单和一个购买按钮。我很快发现，只要我的鼠标离开选择菜单的初始可见区域（即尝试选择一个选项），整个气泡就会消失。

答案（感谢开发 jQuery 的聪明人）都是关于事件冒泡的。我知道解决问题的最直接方法必须是暂时“禁用”悬停的退出状态。幸运的是，jQuery 内置了处理事件冒泡的功能（他们称之为传播）。

基本上，只有大约一行左右的新代码，我将一个方法附加到下拉列表的“onmouseleave”事件（将鼠标悬停在选择列表中的一个选项上似乎可靠地触发了这个事件 - 我尝试了一些其他事件, 但这似乎相当可靠）关闭了事件传播（即不允许父元素从下拉列表中听到“onmouseleave”事件）。

就是这样！解决方案比我预期的要优雅得多。然后，当鼠标离开气泡时，悬停状态正常触发，站点继续其业务。这是修复（我把它放在 document.ready 中）：

```
$(document).ready(function(){
  $(".dropdownClassName select").mouseleave(function(event){
    event.stopPropagation();
  });
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T01:51:08.693

显然 IE 不考虑选择元素的下拉位部分。这是可行的，但是当鼠标进入元素的下拉部分时，它需要使用 expando 属性和模糊/焦点事件来启用和禁用“隐藏”效果以阻止它启动。

试试这个：

```
$(function() {
    var expand   = function(){ $(this).width(600) }
    var contract = function(){ if (!this.noHide) $(this).width(50) }
    var focus    = function(){ this.noHide = true }
    var blur     = function(){ this.noHide = false; contract.call(this) }
    $('#TheSelect')
        .hover(expand, contract)
        .focus(focus)
        .click(focus)
        .blur(blur)
        .change(blur)
}); 
```

（抱歉，如果这不是一个人应该如何使用 jQuery - 我以前从未使用过它:)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-02T19:17:27.870

WorldWideWeb 的答案非常有效。

我遇到了一个稍微不同的问题，我对表单字段的包含项（悬停以显示选择菜单）产生了悬停效果，并且 IE 用户无法从下拉列表中进行选择（它一直在重置值）。我添加了worldwideweb的建议（带有选择的ID）和中提琴，它起作用了。

这就是我所做的：

```
$(".containerClass").hover(function() {
    $(this).children("img").hide();
    $('#idOfSelectElement').mouseleave(function(event) { event.stopPropagation(); });
}, function() {
    $(this).children('img').show();
    $('#idOfSelectElement').mouseleave(function(event) { event.stopPropagation(); });

}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T00:19:44.537

我有一个基于悬停隐藏/显示的表单。如果用户专注于选择，则表单将被隐藏。我能够通过以下方式解决我的问题：

```
element.find('select').bind('mouseenter mouseleave',function(){
    //Prevent hover bubbling
    return false;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-12T00:39:25.357

有同样的问题，WorldWidewebb 的答案在 IE8 上运行得很好。我只是做了一点改动，从选择器中删除了“select”，因为我在选择器中包含了选择框的类。使它成为一个非常简单的修复。

另外，我在使用 hoverIntent jquery 插件的菜单上实现了它，没有问题。（无干扰）。

# c++ - “常量类”是什么意思？

> ID：206998
> 
> 赞同：40
> 
> 时间：2008-10-16T00:23:11.210
> 
> 标签：c++, class, constants

经过一些查找和替换重构后，我最终得到了这个宝石：

```
const class A
{
}; 
```

“常量类”是什么意思？似乎编译正常。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-16T00:26:57.803

在那个例子中 是没有意义的，你的编译器应该给你一个错误，但是如果你用它在关闭和`const`之间声明该类的变量，那么将这些实例定义为，例如：`}``;``const`

```
 const class A
{
public:
    int x, y;
}  anInstance = {3, 4};

// The above is equivalent to:
const A anInstance = {3, 4}; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-10-16T00:26:15.293

> “常量类”是什么意思？似乎编译正常。

对我来说不是。我认为您的编译器只是出于礼貌而忽略了它。

**编辑：**是的，VC++ 默默地忽略了 const，GCC 抱怨。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-16T00:25:37.650

如果你有这个：

```
const class A
{
} a; 
```

那么它显然意味着'a'是const。否则，我认为它可能是无效的 c++。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-10-24T04:25:37.247

除非你在之后声明一个类的实例，否则它是没有意义的，比如这个例子：

```
const // It is a const object...
class nullptr_t 
{
  public:
    template<class T>
      operator T*() const // convertible to any type of null non-member pointer...
    { return 0; }

    template<class C, class T>
    operator T C::*() const   // or any type of null member pointer...
    { return 0; }

  private:
    void operator&() const;  // Can't take address of nullptr

} nullptr = {}; 
```

`nullptr`如果您正在等待 C++0x，则为临时实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-24T11:03:27.873

尝试用 GCC 编译它，它会给你以下错误：
`error: qualifiers can only be specified for objects and functions.`

从错误中可以看出，只有对象（变量、指​​针、类对象等）和函数可以是常量。因此，尝试将对象设为常量，然后它应该可以正常编译。
`const class A {};`
`const A a ;`*************