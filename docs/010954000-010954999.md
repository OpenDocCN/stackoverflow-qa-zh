# StackOverflow 问答 10954000-10954999

# c# - 通过 C# 登录网站，导航到另一个网页，然后将源代码输出为字符串

> ID：10954004
> 
> 赞同：8
> 
> 时间：2012-06-08T18:17:06.800
> 
> 标签：c#, .net, c#-4.0

我对在 C# 中处理网页比较陌生。我要做的是登录特定网站（[https://www15.swalife.com/PortalWeb/portal/cwaLogon.jsp](https://www15.swalife.com/PortalWeb/portal/cwaLogon.jsp)）并允许将页面重定向到默认页面，然后从那里导航到（ https://www15.swalife.com/csswa/ea/plt/accessELITT.do）并下载源代码并将其输出为字符串。

我已经想出了如何通过 HTTPWebRequest 和 HTTPWebResponse 下载源代码，但是在编写登录功能时遇到了麻烦。我想我将不得不对 POST 做点什么？我也看过[http://www.dreamincode.net/forums/topic/152297-c%23-log-in-to-website-programmatically/](http://www.dreamincode.net/forums/topic/152297-c%23-log-in-to-website-programmatically/)。

## 提前致谢！！

## 编辑：

jimmyjambles 提供的代码完美无缺，但它并没有完全得到我想要的页面的源代码。该代码表明登录过程失败，但我相信通过一些调整我可以让它工作......也适用于每个有问题的人：

```
ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(AcceptAllCertifications); 
```

尝试将“公共字符串”和“公共布尔”函数分别更改为“公共静态字符串”和“公共静态布尔”:)

## 编辑2：

响应 HTML：

```
"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n<HTML>\n<HEAD>\n\n\n\n\n\n\n<META http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n<META name=\"GENERATOR\" content=\"IBM WebSphere Studio\">\n<TITLE>endSession.jsp</TITLE>\n<LINK rel=\"stylesheet\" href=\"eipPortletStyles/swalife.css\" type=\"text/css\">\n\t<script type=\"text/javascript\" language=\"JavaScript\" \n\t\tsrc=\"eipCommonJavaScript/eipGeneralFunctions.js\"/> </script>\n\t\t\n<script type=\"text/javascript\">\n\n\tfunction refreshParent()\n\t{\n\t    if(window.parent)\n\t    {\n\t    if(window.parent.name == 'appMainFrame')\n\t       window.parent.location = \"/csswa/ea/plt/logout.do\";\n\t    //  alert('Your session has expired.  Please login again. ');\n\t    }\n\t}\n\n</script>\n</HEAD>\n<BODY onload=\"refreshParent();\">\n \n\t \t<div class=\"eipErrors\">\n  \t\t\t<div class=\"legendLabel\">Message</div>\n  \t\t\t\n  \t\t\t    <div class=\"errorsHeader formTitle\">You Have Exited Out of Crew Web Access.<br>  \t\t\t \n  \t\t\t    </div>\n  \t\t\t \n  \t\t\t<div class=\"errorsHeader formTitle\"> Please Close this Window and <font  size=\"+1\">Log Out of SWALife</font> to Complete the Log Out Process.  </div>\n  \t\t<div class=\"errorsText\">\n  \t\t  &nbsp;\n  \t\t\t\t\n  \t\t</div>\n  \t\t\n  \t\t\t\n  \t\t\n  \t\t<div class=\"errorsFooter\">You will need to log back in before continuing.</div>  \t\n  \t\t\n \t</div>\n  \n</BODY>\n</HTML>\n" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:31:09.867

为了在登录后使用 HttpWebRequest 访问辅助 URL，您需要记住一些事情。

首先，正如 Casperah 提到的，您需要检查登录表单并确定用于接收登录数据的控件的“名称”属性。

完成此操作后，您将需要相应地格式化帖子字符串并将其提供给 WebRequest。

最后一个考虑是，一旦您登录，您将需要存储和维护从保持您登录的服务器分配给您的 cookie。

我从[这篇 msdn 文章](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)中获取了一个 WebRequest 片段，并对其进行了修改以在登录后执行第二个页面请求。

```
 string loginurl = "http://www.gmail.com";
        string secondurl = "http://mail.google.com/prefs";

        string username = "bob@gmail.com";
        string password = "12345";
        GetSecondaryLoginPage(loginurl, secondurl, username, password);

    public string GetSecondaryLoginPage(string loginurl, string secondurl, string username, string password, string cookieName = null)
    {
        // Create a request using a URL that can receive a post. 
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(loginurl);
        // Set the Method property of the request to POST.
        request.Method = "POST";

        CookieContainer container = new CookieContainer();

        if (cookieName != null)
            container.Add(new Cookie(cookieName, username, "/", new Uri(loginurl).Host));

        request.CookieContainer = container;

        // Create POST data and convert it to a byte array.  Modify this line accordingly
        string postData = String.Format("username={0}&password={1}", username, password);

        ServicePointManager.ServerCertificateValidationCallback = new System.Net.Security.RemoteCertificateValidationCallback(AcceptAllCertifications);

        byte[] byteArray = Encoding.UTF8.GetBytes(postData);
        // Set the ContentType property of the WebRequest.
        request.ContentType = "application/x-www-form-urlencoded";
        // Set the ContentLength property of the WebRequest.
        request.ContentLength = byteArray.Length;
        // Get the request stream.
        Stream dataStream = request.GetRequestStream();
        // Write the data to the request stream.
        dataStream.Write(byteArray, 0, byteArray.Length);
        // Close the Stream object.
        dataStream.Close();
        // Get the response.
        WebResponse response = request.GetResponse();
        // Get the stream containing content returned by the server.
        dataStream = response.GetResponseStream();
        // Open the stream using a StreamReader for easy access.
        StreamReader reader = new StreamReader(dataStream);
        // Read the content.
        string responseFromServer = reader.ReadToEnd();

        using (StreamWriter outfile =
        new StreamWriter("output.html"))
        {
            outfile.Write(responseFromServer.ToString());
        }

        // Clean up the streams.
        reader.Close();
        dataStream.Close();
        response.Close();

        request = (HttpWebRequest)WebRequest.Create(secondurl);
        request.CookieContainer = container;

        response = request.GetResponse();
        // Get the stream containing content returned by the server.
        dataStream = response.GetResponseStream();
        // Open the stream using a StreamReader for easy access.
        reader = new StreamReader(dataStream);
        // Read the content.
        responseFromServer = reader.ReadToEnd();

        // Clean up the streams.
        reader.Close();
        dataStream.Close();
        response.Close();

        return responseFromServer;
    }

    public bool AcceptAllCertifications(object sender, System.Security.Cryptography.X509Certificates.X509Certificate certification, System.Security.Cryptography.X509Certificates.X509Chain chain, System.Net.Security.SslPolicyErrors sslPolicyErrors)
    {
        return true;
    } 
```

唯一添加的行是 postData 和 cookie。

您将需要修改该行

```
string postData = String.Format("username={0}&password={1}", username, password); 
```

基于您在表单上的控件，因为您发布了您尝试使用的网站，我猜您可能正在寻找

```
string postData = String.Format("uid={0}&portalBase=cwa&password={1}", username, password); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:43:43.203

在表单中使用 WebBrowser 相当容易。首先导航到 cwaLogon.jsp 页面并找到输入控件并调用提交按钮上的“单击”。要么使用 HTTPWebRequest 和 Response 进行适当的 GET/POST。使用 Fiddler2 检查要发布的内容是一个很好的开始。

# extjs - 第一个 POST 操作 ExtJS 未定义 rawData

> ID：10954007
> 
> 赞同：1
> 
> 时间：2012-06-08T18:17:23.683
> 
> 标签：extjs

我正在尝试使用单击网格中的名称时获得的服务器响应数据填写表单。在大多数情况下，我已经成功地做到了这一点。但是，由于某种原因，当我第一次单击网格中的名称时，我得到 store.proxy.reader.rawData 的“未定义”。我首先单击哪个名称并不重要，它总是这样做。任何后续点击都会返回预期的 json 字符串。我正在使用萤火虫来帮助我解决问题。

以下是我发出 ajax 请求的商店“PersonS”的代码：

```
Ext.define('CX.store.PersonS',
{
    extend: 'Ext.data.Store', 
    model: 'CX.model.PersonM',
    autoLoad: false,
    proxy:
    {
        type: 'ajax',
        actionMethods: {
            update:'POST'
        },
        url: '.../CensusXPHP/app/store/getUserIdInfo.php',
        reader: 
        {
            type: 'json'
        }    
    }
}); 
```

以下是加载上述商店的控制器内的函数。

```
showMess: function(grid,record)
    {
        var tempId = record.get('transId');                         //grab translation ID
        var name = record.get('fname') + ' ' + record.get('lname'); //grab name of current user
        var store = this.getPersonSStore();
        store.load(
        {
            params:{cid:tempId}
        })               

        var info = store.data;
        console.log(info)
        console.log(store.proxy.reader.rawData)
    }
}; 
```

我正在向控制台打印两件事：store.data 对象和 store.proxy.reader.rawData。下面的打印输出显示了前两个单击事件的 POST 和控制台打印语句：

```
> POST http:app/store/getUserIdInfo.php?_dc=1339179358498  
> Object { items=[0], map={...}, keys=[0], more...}
> 
> POST http:/app/store/getUserIdInfo.php?_dc=1339179359680  
> Object { items=[1], map={...}, keys=[1], more...} Object { id="123", bday="1/5/89", payPref="credit", more...} 
```

我两次都点击了同一个名字。如您所见，store.data 对象表示在第一次单击期间它有零个项目，而 rawData 是“未定义；但是，当我为第一次单击展开 store.data 对象的信息时，您可以看到确实有一个带有 json 字符串的项目（它与第二次单击项目的信息相同，因为我单击了两次相同的名称）。下面的打印输出显示了这一点：

```
> $className    "Ext.util.MixedCollection"   
>.    
>.     
>.           
>   -items: [Object {internalId="123", raw={...}, data={...}, more...}]         
>   --0: Object {internalId="123", raw={...}, data={...}, more...}  
>   ---$className: "CX.model.PersonM"       
>   ---$inheritableStatics: ["setProxy","getProxy", "load"] 
>   ---alternateClassName: "Ext.data.Record"    
>   ---associations: Object { items=[0], map={...}, keys=[0], more...}  
>   ---onfig: Object {}         
>   ---data: Object { bday="1/5/89", street="123 Main St", city="Los Angeles", more...}         
>   ---defaultProxyType: "ajax"     
>   ---dirty:           false       
>   ---editing:         false   
>.   
>.   
>. 
```

我不知道是怎么回事。我已经使用 ExtJS 大约两个星期了，所以我很难看到任何细微的错误（甚至是明显的错误）。有人会指出我正确的方向吗？

谢谢你的帮助！-K

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-19T18:47:48.720

正如 Lolo 所说，store.load 是异步的。除了使用事件，您还可以使用回调。

```
store.load(
{
  params: {cid:tempId},
  callback: function(records, operation, success){
       var info = records;
       console.log(info);
       console.log(store.proxy.reader.rawData);
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:46:29.190

`store.load`方法是异步的，所以调用后它开始加载数据并返回控制。当您`showMess`第一次调用时，`rawData`未定义，因为此时尚未加载数据。另一个调用显示先前请求的结果。使用`load`事件例如：

```
showMess: function(grid,record)
{
    var tempId = record.get('transId');                         //grab translation ID
    var name = record.get('fname') + ' ' + record.get('lname'); //grab name of current user
    var store = this.getPersonSStore();
    store.load(
    {
        params:{cid:tempId}
    });            

    store.on('load', function() {
        var info = store.data;
        console.log(info);
        console.log(store.proxy.reader.rawData);
    }, this, { single: true });
} 
```

# php - 在 PHP 中结合复选框和文本字段

> ID：10954014
> 
> 赞同：0
> 
> 时间：2012-06-08T18:17:50.543
> 
> 标签：php, forms, for-loop

我尝试将复选框值与文本字段组合到一个变量中，这样当我回显它时，它会显示正确的字段值。

我想将复选框的帖子与数量文本字段的帖子结合起来，因为有几个项目我正在使用 forloop 但似乎无法将两个值合并为一个，以便它使用该项目创建一个新的表格行左边是名称，右边是数量。

```
<tr>
   <td>
      <input type="checkbox" name="check[]" value="<?php echo get_post_meta($post->ID, '_stitle', true); ?>" />
   </td>

   <td>
      <input id="quantity" name="check[quantity]" type="text" maxlength="3" /><br />
   </td> 
```

```
 $data = $_POST['check'];
        foreach ($data as $value) {
        $item .= '<tr style="background: #eee;">
                <td>Item: </td>
                <td>'.$value.'</td>
            </tr>';
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:23:18.333

你可能应该改变：

```
<input id="quantity" name="check[quantity]" type="text" maxlength="3" /><br /> 
```

至：

```
<input id="quantity" name="check[quantity][]" type="text" maxlength="3" /><br /> 
```

您标量您的复选框，但不是文本字段。

此外，将您的两个字段与 for 相关联可能会更简单，因为每个复选框和输入字段之间的数组键将是相同的。

例子：

```
for($i=0;$i<=sizeof($_POST['check'])-2;$i++){
    $item .= '<tr style="background: #eee;">
            <td>Item: '.$_POST['check'][$i].'</td>
            <td>'.$_POST['check']['quantity'][$i].'</td>
        </tr>';
} 
```

另外，请注意 sizeof $_POST 中的 -2。你必须减去你的数量键和你的偏移量来设置你的结束点等于那个，因为你从 0 开始计数。

# php - 对复杂的连接查询绝望（mysql & php）

> ID：10954018
> 
> 赞同：0
> 
> 时间：2012-06-08T18:18:00.870
> 
> 标签：php, mysql, join

好的，我正在建立一个多用户聊天系统。

我有一个消息表，其中包含所有消息 - 简化：

```
messages:

id,
content,
thread_id 
```

然后我有一个线程表：

```
messages_threads:

id,
participantlist_id 
```

然后我有一个参与者列表：

```
participantlist:

list_id,
name 
```

我有一个参与者列表链接表：

```
participantlist_links:

list_id,
participant_id 
```

现在我想从参与者列表（数组）中找出线程ID，我想出了这个：

```
$threadid_sqlquery = "
                SELECT messages_threads.id FROM messages_threads
                JOIN participantlist_links 
                ON messages_threads.participantlist_id = participantlist_links.list_id";

foreach($participants_array as &$participant_id){
    $maxid_sqlquery .= "
        AND participantlist_links.participant_id='".$participant_id."'";
} 
```

但现在：我正在寻找用户 1 和 2 之间聊天的 thread_id - 有一个与用户 1、2、3 的多用户聊天和一个与用户 1、2、3、4 的聊天我得到的结果三行，但我只想要只有用户 1 和 2 是参与者的那一行。

有什么方法可以查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:28:58.700

```
SELECT  mt.id
FROM    (
        SELECT  list_id
        FROM    participantlist_links pll
        WHERE   participant_id IN (1, 2)
        GROUP BY
                list_id
        HAVING  COUNT(*) = 2
        ) q
JOIN    message_threads mt
ON      mt.participantlist_id = q.list_id
WHERE   NOT EXISTS
        (
        SELECT  NULL
        FROM    participantlist_links pll
        WHERE   pll.list_id = q.list_id
                AND pll.participant_id NOT IN (1, 2)
        ) 
```

创建以下索引：

```
participantlist_links (participant_id, list_id) -- unique
participantlist_links (list_id) 
```

# asp.net-mvc - mvc视图上的多个下拉列表

> ID：10954019
> 
> 赞同：1
> 
> 时间：2012-06-08T18:18:22.383
> 
> 标签：asp.net-mvc, model-view-controller

如何使用来自我的数据库的值在我的视图中创建多个下拉列表？我可以得到一个下拉菜单，但如何添加另一个？

```
 public class MyModel
    {
        public Category Category { get; set; }
        public IEnumerable<SelectListItem> List { get; set; }

     }

public ActionResult Page()
    {
        var query = model.MyModel.Select(c => new SelectListItem
        {

            Value = c.ModelDescription,
            Text = c.ModelDescription

        });
        var model = new MyModel
        {
            List = query.AsEnumerable()
        };

        return View(model);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:28:20.060

您可以添加更多属性以包含您的其他选择列表项

```
public class MyModel
{
    public Category Category { get; set; }
    public IEnumerable<SelectListItem> List1 { get; set; }
    public IEnumerable<SelectListItem> List2 { get; set; }
    public IEnumerable<SelectListItem> List3 { get; set; }
 } 
```

并且只需运行您需要填充它们的其他查询。然后你可以在视图中使用它们。

# java - 为什么我需要在 BufferedReader 中而不是在 PrintWriter 中捕获 close() 异常？

> ID：10954021
> 
> 赞同：2
> 
> 时间：2012-06-08T18:18:25.977
> 
> 标签：java

我有一个简单的文件读写功能。

```
private void WriteToFile(String filename, String val) {
    PrintWriter outStream = null;
    FileOutputStream fos = null;
    try {
        fos = new FileOutputStream(filename);
        outStream = new PrintWriter(new OutputStreamWriter(fos));
        outStream.print(val);
        outStream.close();
    } catch (Exception e) {
        if (outStream != null) {
            outStream.close();
        }
    }
}

private String ReadFile(String filename) {
    String output = "";
    FileReader fr = null;
    BufferedReader br = null;
    try {
        fr = new FileReader(filename);
        br = new BufferedReader(fr);
        output = br.readLine();
        br.close();
    } catch (Exception e) {
        if (br != null) {
            br.close();
        }
    }

    return output;
} 
```

构建时我得到：

```
unreported exception java.io.IOException; must be caught or declared to be thrown
            br.close();
                    ^ 
```

为什么我需要捕获 br.close 但它不会抱怨 WriteToFile 的 close()？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T18:24:38.840

取自 java.io.PrintWriter 的源代码：

```
public void close() {
    try {
        synchronized (lock) {
            if (out == null)
                return;
            out.close();
            out = null;
        }
    }
    catch (IOException x) {
        trouble = true;
    }
} 
```

IOException 在 PrintWriter 的 close() 方法中被吃掉了

来自 java.io.BufferedReader 的源代码：

```
public void close() throws IOException {
    synchronized (lock) {
        if (in == null)
            return;
        in.close();
        in = null;
        cb = null;
    }
} 
```

BufferedReader 抛出 IOException。

那应该回答你的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T18:24:17.780

*为什么我需要捕获 br.close 但它不会抱怨 WriteToFile 的 close()？*

您可以查看 Java 文档。[BufferedReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html#close%28%29)的`close()`方法：

```
public void close()
           throws IOException 
```

[以及PrintWriter](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/PrintWriter.html#close%28%29)的`close()`方法：

```
public void close() 
```

这个答案是关于为什么 JVM 不抱怨的问题。因为从方法签名中很清楚；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T18:23:23.523

`PrinterWriter.close()`不会抛出任何异常。如果你打电话`fos.close()`，它会要求你捕捉/抛出异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T18:28:01.793

在 PrintWriter.java 中。异常被捕获和处理。所以你不需要在使用时抓住它。

Java 源代码：

```
 public void close() {
        try {
            synchronized (lock) {
                if (out == null)
                    return;
                out.close();
                out = null;
            }
        }
        catch (IOException x) {
            trouble = true;
        }
    } 
```

但是在 BufferedReader 中抛出异常。所以在使用的时候一定要抓住它。

Java 源代码：

```
 public void close() throws IOException {
            synchronized (lock) {
                if (in == null)
                    return;
                in.close();
                in = null;
                cb = null;
            }
        } 
```

# android - Android版icloud dropbox（文件自动同步&云epub）

> ID：10954023
> 
> 赞同：0
> 
> 时间：2012-06-08T18:18:36.653
> 
> 标签：android, synchronization, rsync

我是大学生。

我正在做一些云项目，这正是 android 版本的 iCloud 和 iBooks 应用程序。

开发环境：

*   服务器模型：epoll server(C语言)

*   文件管理：Hadoop

*   客户端：android(java) 和 windows PC(C#)

限制：不使用 dropbox API（我必须构建自己的服务器和客户端）

情况：

文件自动同步和云电子书查看器，如 icloud（或保管箱）和 iBooks 应用程序。

当您在 Android 智能手机中拍照时，它会自动拍摄

在您的 android 平板电脑和 Windows PC 中作为“真实图片文件”，而不仅仅是文件名列表。

我的问题是：

1.  icloud 或 Dropbox 应用了哪些技术？

我怎样才能注意到新文件和文件自动更改？

2 我们在服务器客户端中分别使用 3 种不同的编程语言 C、C#、java。

我应该考虑并会遇到什么网络问题？

目前搜索到的信息：

1.  rsync（库）

2.  zookeeper(hadoop 子项目)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:38:41.837

我会使用 Amazon Web Services 来完成这项任务。您可以使用 Amazon S3 来存储文件（这实际上是 DropBox 使用的）。

# xaml - 如何在 Silverlight 5 中使用 VisualStateManager 重用 Storyboard

> ID：10954024
> 
> 赞同：4
> 
> 时间：2012-06-08T18:18:40.513
> 
> 标签：xaml, animation, silverlight-5.0, resourcedictionary, visualstatemanager

这个问题以前曾被问过，但在大多数情况下不超过 2 年前，并且通常特定于 WPF。答案可能仍然相同，但它就在这里。我正在尝试构建一个三角形（箭头）按钮，当鼠标悬停在它上面时，它会改变颜色并增大大小。我已经为一个按钮工作了。但现在我需要带有指向不同方向的箭头的按钮。我想尽可能多地重用代码。如果不使用自定义按钮控件，我想不出一种完全使用相同样式的方法，所以我试图通过使其成为资源来重用鼠标悬停动画。当我在按钮模板的 VisualStateManager 中将 Storyboard 引用为 StaticResource 时，它​​会使我的按钮完全消失。为什么这不起作用？

```
<UserControl
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:System="clr-namespace:System;assembly=mscorlib" mc:Ignorable="d"
x:Class="SilverlightTest.MainPage"
Width="640" Height="480">
<UserControl.Resources>
    <Storyboard x:Key="ArrowMouseOver">
        <DoubleAnimation Duration="0:0:0.165" To="1.25" Storyboard.TargetProperty="(UiElement.RenderTransform).(ScaleTransform.ScaleX)" Storyboard.TargetName="polygon"/>
        <DoubleAnimation Duration="0:0:0.165" To="1.25" Storyboard.TargetProperty="(UiElement.RenderTransform).(ScaleTransform.ScaleY)" Storyboard.TargetName="polygon"/>
        <ColorAnimation Duration="0:0:0.165" To="#FF9BD6FF" Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
        <ColorAnimation Duration="0:0:0.165" To="#FF70ACDF" Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[0].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
        <ColorAnimation Duration="0:0:0.165" To="#FF7DAEFF" Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
        <ColorAnimation Duration="0:0:0.165" To="#FF2B5CB4" Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[0].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
    </Storyboard>

    <Style x:Key="LeftArrow" TargetType="Button">
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid x:Name="grdRoot" RenderTransformOrigin="0.5,0.5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.165"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver" Storyboard="{StaticResource ArrowMouseOver}">
                                </VisualState>
                                <VisualState x:Name="Pressed"/>
                                <VisualState x:Name="Disabled"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Polygon x:Name="polygon" Grid.Row="0" Margin="1" StrokeThickness="{TemplateBinding BorderThickness}" HorizontalAlignment="Center" RenderTransformOrigin="0.5,0.5">
                            <Polygon.Points>
                                <Point X="10"/>
                                <Point X="0" Y="5" />
                                <Point Y="10" X="10" />
                            </Polygon.Points>
                            <Polygon.RenderTransform>
                                <ScaleTransform />
                            </Polygon.RenderTransform>
                            <Polygon.Fill>
                                <LinearGradientBrush EndPoint="0.5,0" StartPoint="0.5,1">
                                    <GradientStop Color="#FFA9A9A9"/>
                                    <GradientStop Color="#FFD3D3D3" Offset="1"/>
                                </LinearGradientBrush>
                            </Polygon.Fill>
                            <Polygon.Stroke>
                                <LinearGradientBrush EndPoint="0.5,0" StartPoint="0.5,1">
                                    <GradientStop Color="#FF696969"/>
                                    <GradientStop Color="#FF939393" Offset="1"/>
                                </LinearGradientBrush>
                            </Polygon.Stroke>
                        </Polygon>
                        <ContentPresenter Grid.Row="1" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</UserControl.Resources>
<Grid x:Name="LayoutRoot" Background="White">
    <Button Style="{StaticResource LeftArrow}" HorizontalAlignment="Left" VerticalAlignment="Top">
    </Button>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-26T17:59:20.313

听起来您应该介绍自己的`Button`课程。我会这样做：

```
<my:GlowingArrowButton ArrowDirection="Left"/> 
```

还有你的 generic.xaml：

```
<Style TargetType="my:GlowingArrowButton">
    <Setter Property="Cursor" Value="Hand"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="my:GlowingArrowButton">
                <Grid x:Name="grdRoot" RenderTransformOrigin="0.5,0.5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualStateGroup.Transitions>
                                <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.165"/>
                            </VisualStateGroup.Transitions>
                            <VisualState x:Name="Normal"/>
                            <VisualState x:Name="MouseOver"
<Storyboard>
    <DoubleAnimation Duration="0:0:0.165" To="1.25" Storyboard.TargetProperty="(UiElement.RenderTransform).(ScaleTransform.ScaleX)" Storyboard.TargetName="polygon"/>
    <DoubleAnimation Duration="0:0:0.165" To="1.25" Storyboard.TargetProperty="(UiElement.RenderTransform).(ScaleTransform.ScaleY)" Storyboard.TargetName="polygon"/>
    <ColorAnimation Duration="0:0:0.165" To="#FF9BD6FF" Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
    <ColorAnimation Duration="0:0:0.165" To="#FF70ACDF" Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[0].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
    <ColorAnimation Duration="0:0:0.165" To="#FF7DAEFF" Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
    <ColorAnimation Duration="0:0:0.165" To="#FF2B5CB4" Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[0].(GradientStop.Color)" Storyboard.TargetName="polygon" d:IsOptimized="True"/>
</Storyboard>
                            </VisualState>
                            <VisualState x:Name="Pressed"/>
                            <VisualState x:Name="Disabled"/>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>

                  <LayoutTransformer
                         LayoutTransform="{Binding Path=ArrowDirection,
                           RelativeSource={RelativeSource TemplatedParent},
                           Converter={StaticResource RotationTranslator_ToBeImplemented}}"
                         Grid.Row="0"
                         HorizontalAlignment="Center">
                    <Polygon
                        x:Name="polygon"

                        Margin="1"
                        StrokeThickness="{TemplateBinding BorderThickness}"

                        RenderTransformOrigin="0.5,0.5">
                        <Polygon.Points>
                            <Point X="10"/>
                            <Point X="0" Y="5" />
                            <Point Y="10" X="10" />
                        </Polygon.Points>
                        <Polygon.RenderTransform>
                            <ScaleTransform />
                        </Polygon.RenderTransform>
                        <Polygon.Fill>
                            <LinearGradientBrush EndPoint="0.5,0" StartPoint="0.5,1">
                                <GradientStop Color="#FFA9A9A9"/>
                                <GradientStop Color="#FFD3D3D3" Offset="1"/>
                            </LinearGradientBrush>
                        </Polygon.Fill>
                        <Polygon.Stroke>
                            <LinearGradientBrush EndPoint="0.5,0" StartPoint="0.5,1">
                                <GradientStop Color="#FF696969"/>
                                <GradientStop Color="#FF939393" Offset="1"/>
                            </LinearGradientBrush>
                        </Polygon.Stroke>
                    </Polygon>
                 </LayoutTransformer>

                    <ContentPresenter
                        Grid.Row="1"
                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

和代码：

```
public class GlowingArrowButton : ButtonBase
{
    public GlowingArrowButton()
    {
        DefaultStyleKey = typeof (GlowingArrowButton);
    }

    public ArrowDirection ArrowDirection
    {
        get { return (ArrowDirection) GetValue( ArrowDirectionProperty ); }
        set { SetValue( ArrowDirectionProperty, value ); }
    }

    public static readonly DependencyProperty ArrowDirectionProperty =
        DependencyProperty.Register( "ArrowDirection", typeof( ArrowDirection ), typeof( GlowingArrowButton ), new PropertyMetadata( default( ArrowDirection ) ) );
}

public enum ArrowDirection
{
    Left,
    Up,
    Right,
    Down
} 
```

[编辑] 书面但未经测试：

```
public class RotationTranslator : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var arrowDirection = (ArrowDirection) value;
        switch (arrowDirection)
        {
                case ArrowDirection.Left: return new RotateTransform{ Angle = 0 };

                case ArrowDirection.Up: return new RotateTransform { Angle = 90 };

                case ArrowDirection.Right: return new RotateTransform { Angle = 180 };

                case ArrowDirection.Down: return new RotateTransform { Angle = -90 };
        }
        throw new InvalidOperationException();
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture){throw new NotSupportedException();}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T21:56:39.460

`Storyboard`需要`DynamicResource`标记扩展并且“ [Silverlight 不支持动态资源。](http://msdn.microsoft.com/en-us/library/cc903925%28v=vs.95%29.aspx) ” Strewth。

# facebook - 2012 年 2 月后合并具有相同名称的应用程序 + 个人资料页面

> ID：10954028
> 
> 赞同：0
> 
> 时间：2012-06-08T18:18:56.910
> 
> 标签：facebook, merge

我是两个页面的管理员。其中一个是应用页面，另一个是我们的品牌页面。

应用页面名称是Talkwheel Community（Facebook给我们的名称，因为我们的应用名称是Talkwheel），品牌页面是拥有更多粉丝的Talkwheel。我想将它们合并到应用程序页面中，并且是两者的管理员。我该怎么做呢？我在编辑页面>更新信息>资源中看不到合并页面链接。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:36:05.810

不，这是不可能的 - 您可以通过页面合并过程将现有页面合并到应用程序的社区页面，但我不能 100% 确定它是如何工作的 - 对于这个网站来说，这不是主题，你会需要查看 Facebook 的帮助中心：[https ://www.facebook.com/help](https://www.facebook.com/help)

# c - 错误：预期标识符或“（”之前，宏定义

> ID：10954029
> 
> 赞同：2
> 
> 时间：2012-06-08T18:18:58.657
> 
> 标签：c, c-preprocessor

我在尝试定义这个类似函数的宏时遇到了麻烦，它采用 4 个矢量幅度来表示一般圆柱体顶面的长轴和短轴，并确定一般圆柱体的类型。EQUAL 是一个已定义的宏，用于查看两个浮点值是否彼此“相等”。

```
3080 #define GET_TGC_TYPE(_type, _a, _b, _c, _d) { \
3081     if (EQUAL((_a), (_b)) && EQUAL((_c), (_d))) { \
3082         /* circular base and top */
3083         if (EQUAL((_a), (_c))) { \
3084             /* right circular cylinder */
3085             (_type) = RCC; \
3086         } else { \
3087             /* truncated right cone */
3088             (_type) = TRC; \
3089         } \
3090     } else { \
3091         /* elliptical base or top */
3092         if (EQUAL((_a), (_c)) && EQUAL((_b), (_d))) { \
3093             /* right elliptical cylinder */
3094             (_type) = REC; \
3095         } else { \
3096             /* truncated elliptical cone */
3097             (_type) = TEC; \
3098         } \
3099     }
3100 } 
```

我得到的错误是

```
3083:9: error: expected identifier or ‘(’ before ‘if’
3086:11: error: expected identifier or ‘(’ before ‘else’
3090:5: error: expected identifier or ‘(’ before ‘}’ token
3090:7: error: expected identifier or ‘(’ before ‘else’
3100:1: error: expected identifier or ‘(’ before ‘}’ token 
```

我对 C 宏没有太多经验，所以我完全有可能遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T18:20:43.077

带有注释的行不包含尾随`\`，因此宏定义在其中的第一个处停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:22:09.653

看起来您缺少注释行上的反斜杠。

# android - Android 包名称的有效名称

> ID：10954030
> 
> 赞同：11
> 
> 时间：2012-06-08T18:19:11.097
> 
> 标签：android

如果我拥有像 Dan-Carlos.com 这样的域名

Android 包名称是否允许像 com.dan-carlos.com 一样使用？

我还没有尝试过使用它，但我很好奇是否有人尝试使用带有连字符“-”的域名。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T18:24:32.357

[参考我的工作年限和一些这样](http://blog.eisele.net/2010/09/hyphen-ussage-in-package-names.html)的网页， 您应该将“-”破折号替换为“_”下划线。

如果网站是：dan-carlos.com

包名是：com.dan_carlos

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-11T09:48:26.920

根据[**文档**](http://developer.android.com/guide/topics/manifest/manifest-element.html#package)：

> 应用程序的完整 Java 语言样式的包名称。名称应该是唯一的。名称可以包含大写或小写字母（“A”到“Z”）、数字和下划线（“_”）。但是，单个包名称部分只能以字母开头。

所以，很遗憾，除了英文字母、数字、字符“。”之外，你不能使用其他任何东西。和字符 "_" 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:24:44.993

不，不幸的是，连字符“-”在包名称中是不可接受的。

您可以通过右键单击项目并转到属性 -> Android -> 重命名应用程序包并尝试接受什么来简单地测试它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-11T10:00:34.753

包名称中允许的字符是 A 到 Z（小写和大写）、句点 (.) 和下划线 (_)。所以你可以有包名 com.dan.carlos 或 com.dan_carlos

# oracle - ColdFusion 使用 Oracle 的“INSERT ... RETURNING ... INTO”语句

> ID：10954033
> 
> 赞同：3
> 
> 时间：2012-06-08T18:19:16.550
> 
> 标签：oracle, coldfusion

我正在使用 ColdFusion 构建一个简单的聊天应用程序，并且在运行插入时尝试获取消息 ID。这是我到目前为止所拥有的

```
<cffunction name="putMessage" access="remote" returnformat="JSON">

     <cfargument name="message" />
     <cfset LOCAL.id = 0 />

     <cfquery name="insertquery" datasource="myDS"> 
          insert into 
               chat (message) 
          values 
               (<cfqueryparam cfsqltype="cf_sql_varchar" value="#ARGUMENTS.message#">)
          RETURNING
               id
          INTO
               <cfqueryparam cfsqltype="cf_sql_numeric" value="#LOCAL.id#">
     </cfquery>

     <cfreturn LOCAL.id />

</cffunction> 
```

我得到的错误是

> 执行数据库查询时出错。
> 
> 并非所有返回参数都已注册

我知道有存储过程的解决方法，并运行多个查询。我想知道如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-03-24T14:54:36.237

这是一个老问题，所以提前为死灵术道歉。在我看来，最好的（也许是唯一的）实现这一点的方法是将`INSERT`语句包装在存储过程中，并`RETURNING ... INTO`在输出参数中返回子句中的值。

```
CREATE OR REPLACE PROCEDURE chat_insert
  ( p_message IN VARCHAR2, r_id OUT NUMBER )
AS
BEGIN
  INSERT INTO chat ( message )
  VALUES ( p_message )
  RETURNING id INTO r_id;
END;
/ 
```

然后，您可以从 ColdFusion 调用此存储过程，如下所示：

```
<cffunction name="putMessage" access="remote" returnformat="JSON">
    <cfargument name="message" />
    <cfset LOCAL.id = 0 />

    <cfstoredproc procedure="chat_insert" datasource="myDS">
        <cfprocparam cfsqltype="CF_SQL_VARCHAR" type="in" value="#ARGUMENTS.message#" />
        <cfprocparam cfsqltype="CF_SQL_VARCHAR" type="out" variable="LOCAL.id" />
    </cfstoredproc>

    <cfreturn LOCAL.id />
</cffunction> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T18:26:57.513

ID 是查询*返回*的东西——不是你要发送到查询中的东西——对吗？类似的东西（注意 - 未经测试）：

```
 <cfargument name="message" />
 <cfset LOCAL.id = 0 />

 <cfquery name="insertquery" datasource="myDS"> 

      DECLARE newID NUMBER;

      insert into 
           chat (message) 
      values 
           (<cfqueryparam cfsqltype="cf_sql_varchar" 
                                  value="#ARGUMENTS.message#">)
      RETURNING
           id
      INTO
          newID
 </cfquery>

 <cfreturn insertquery.newID /> 
```

否则，您希望驱动程序在 CF 实际收到来自驱动程序连接的结果*之前*将 Oracle var 转换为 CF var （您还传递了*值*0，而不是您在使用 #local 时希望返回的 var的*名称*.id# in value="")。

编辑：如果这是一个“自动增量”字段，另一种方法是使用“结果”变量。看起来像这样。

```
<cfquery name="insertquery" datasource="myDS" result="r"> 
      insert into 
           chat (message) 
      values 
           (<cfqueryparam cfsqltype="cf_sql_varchar" 
                                  value="#ARGUMENTS.message#">)

 </cfquery>

<cfreturn r.rowID/> 
```

RowID 是我认为的 Oracle 版本。注意 - 这是 CF8 或更高版本。

# java - 管理 Iframe 和父窗口的会话超时

> ID：10954038
> 
> 赞同：3
> 
> 时间：2012-06-08T18:19:28.813
> 
> 标签：java, iframe, session-timeout

我有一个基于 iframe java 的 web 应用程序，其中有导航，用户可以从中选择一些站点并在 iframe 中打开。站点正在打开 SSO（单点登录）。

我必须管理在 iframe 中打开的父应用程序和应用程序的会话超时。

怎么做？

# windows - 重新启动 explorer.exe 只会打开一个资源管理器窗口

> ID：10954041
> 
> 赞同：23
> 
> 时间：2012-06-08T18:19:41.283
> 
> 标签：windows, batch-file, explorer, taskkill

**问题**

在批处理文件的一部分（类型，请参阅额外信息）中，我需要重新启动资源管理器，因此我使用了久经考验的方法

```
taskkill /f /im explorer.exe >nul
explorer.exe 
```

然后发生这种情况

1.  `explorer.exe`已成功终止
2.  `explorer.exe`已启动（见图 2），但只打开一个资源管理器窗口，我无限期地留下了（见图 1）

然后，我只能通过从任务管理器启动新任务来正确重新启动资源管理器，因为我假设`Win + R`它是资源管理器的一部分。

**额外的信息**

现在，当我从使用 WinRAR 创建的自动执行 SFX 存档运行批处理文件时，我说“有点”。因此，在执行时，存档的内容被提取到`%temp%`一个用户定义的文件（通常是引导程序，在本例中是我的批处理文件）在成功提取后运行。

到目前为止，我已经推断出

1.  `explorer.exe`绝对是被完全杀死了。
2.  批处理文件肯定被正确调用和执行，因为它运行并且脚本中的所有其他内容都按设计工作，除了开始的行`explorer.exe`
3.  重新启动资源管理器的命令不是“时间错误”或任何东西，因为我尝试过延迟它。
4.  当从存档中手动提取时，批处理文件可以完美运行，因此压缩或提取过程没有问题。
5.  即使使用像`start explorer.exe | cmd.exe`资源管理器这样的命令也不能正确重启，所以`.bat`文件绝对不是问题。

我可以确认它适用于 Windows XP 和 Windows 7 x86，但不适用于 Windows 7 x64（这是我的系统）。

**地位**

目前，我对 WinRAR 持怀疑态度，因为我已经证明代码本身可以工作。因此，我正在使用不同版本的 WinRAR 创建自执行 SFX。到目前为止，我已经尝试过以下版本：

*   4.11 x86
*   4.11 x64
*   4.20b3 x86
*   4.20b3 x64

并且每次都有相同的结果。

我昨天向 dev@rarlab.com 提交了一个错误报告，今天早上**得到了 Eugene Roshal 本人的回复**

> 您好，SFX 模块使用 ShellExecuteEx 启动设置应用程序。通常它运作良好。我不知道为什么 Explorer 决定切换到窗口模式。现在我建立了一个小的独立程序

```
#include <windows.h>    
void main()
{
  SHELLEXECUTEINFO si;
  memset(&si,0,sizeof(si));
  si.cbSize=sizeof(si);
  si.lpFile="test.bat";
  si.nShow=SW_SHOWNORMAL;
  ShellExecuteEx(&si);
} 
```

> 它运行 test.bat 的内容与您的示例中的内容相同。该程序显示与 WinRAR SFX 完全相同的行为，因此资源管理器在窗口中启动。

和今天早上的第二封电子邮件

> 对不起，现在没有建议。我用 CreateProcess 替换了 ShellExecuteEx

```
#include <windows.h>
void main()
{
  STARTUPINFO si;
  PROCESS_INFORMATION pi;
  memset(&si,0,sizeof(si));
  si.cb=sizeof(si);
  CreateProcess(NULL,"test.bat",NULL,NULL,TRUE,0,NULL,NULL,&si,&pi);
} 
```

> 但结果是一样的。我尝试将其他 SW_ 标志（如 SW_SHOWDEFAULT 或 SW_RESTORE）与 ShellExecuteEx 一起用作“open”和“explore”lpVerb，但它没有帮助。现在我不明白这种窗口模式与桌面模式背后的逻辑。

我意识到前景很严峻，但我希望这对某人有所帮助..

**证明/证据**

链接到演示此的 SFX 存档，如果有人想要的话： [https ://dl.dropbox.com/u/27573003/Social%20Distribution/restart-explorer.exe](https://dl.dropbox.com/u/27573003/Social%20Distribution/restart-explorer.exe)

![图 1](../Images/12f14493c21bd1368e697d2578484fe2.png)

![图 2](../Images/d596abd815e0a5c0abc093048997b8eb.png)

您可能会注意到，我在 VM 中运行命令（用 表示 `VMwareTray.exe`），但这不是由 VM 引起的冲突。我已经在我自己的主机系统（相同的操作系统）上测试了完全相同的文件并且得到了相同的结果。

**更新**

`REG ADD`在完全不同的项目中使用时，我遇到了类似的“在 SFX 存档之外工作但不是来自一个”的问题。我只是不认为 SFX 档案与批处理文件配合得很好。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-11-17T23:17:58.533

我认为 user1631170 正在做一些事情，“我想知道 Win-RAR 的某些部分是否在 32 位模式下运行？你甚至可以从 32 位进程启动 explorer64 吗？我很确定 Windows 不会那样做。”

当我从 ProcessHacker（32 位进程管理器）启动 explorer.exe 时，我得到一个资源管理器窗口。

但我可以强制它启动 64 位资源管理器：

```
%systemroot%\sysnative\cmd.exe /c start /B explorer.exe 
```

sysnative 是 Windows 识别为绕过 32 位/64 位文件系统重定向的关键字 ( [http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187(v=vs.85) .aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187%28v=vs.85%29.aspx) 享受吧！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-27T12:27:14.830

我遇到了同样的问题，发现这里的所有解决方案仍然无法从批处理脚本中运行。

这些都没有完全奏效：

```
start explorer.exe
start explorer
explorer.exe
explorer 
```

因为他们都打开了一个窗口（并且没有再次显示任务栏），或者批处理脚本随后挂起并且无法再执行任何命令

我发现批处理文件中的这一行确实有效（在杀死 explorer.exe 之后）：

```
start "" "%windir%\explorer.exe" 
```

并且还允许在脚本中执行其他命令

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-09T14:33:32.053

这适用于 Windows 7：

```
taskkill /f /IM explorer.exe
start explorer.exe
exit 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-10T00:21:28.910

对于重新启动 explorer.exe，这对我有用。

```
powershell.exe Stop-Process -processname explorer 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T19:17:35.947

尝试

```
%windir%\explorer.exe
start %windir%\explorer.exe
start /d%windir% explorer.exe 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-18T01:08:32.720

当您在 64 位窗口中从 32 位应用程序运行 explorer.exe 时，路径将被重定向到包含 32 位 explorer.exe 的 SysWOW64 目录。

在 XP64 中，这没什么大不了的。在任务管理器中，您可以看到 32 位 explorer.exe 正在运行，但它确实以 shell 启动。在 Windows 10 中（当我遇到这个问题时，它看起来像是在 Windows 7 中引入的），32 位 explorer.exe 是一个存根，它创建 64 位 explorer.exe 的新实例。它可能在此处通过命令行上的路径，因此 64 位 explorer.exe 打开一个窗口而不是启动 shell。

所以它仍然像以前一样，您可以通过使用或不使用路径作为命令行参数启动 explorer.exe 来控制是否应该启动窗口或 shell。

相反，您应该强制从 32 位应用程序启动 64 位 explorer.exe，一切正常。为此，一种方法是使用上面提到的 sysnative 目录。但另一种方法是使用 Wow64DisableWow64FsRedirection/Wow64RevertWow64FsRedirection。

我做了后者，并且可以确认它运行良好。对于 CreateProcess 和 ShellExecuteEx API。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-11T09:29:43.933

在 C# 中执行此操作之前，我已经看到了类似的问题。该过程必须通过调用资源管理器外壳而不是资源管理器窗口来调用，但我批量没有任何问题。

尝试使用这个：

```
taskkill /im explorer.exe /f
explorer 
```

其他答案之间的区别是，`explorer`而不是`explorer.exe`哪个给我带来了问题。

这适用于我的 Win7 x64 PC。

希望这可以帮助！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-25T22:27:07.893

前几天，我浏览了 WinRAR 的一些更高级的选项，发现了这个选项卡：

![在此处输入图像描述](../Images/c8ea8b2407febd3df415aaa8a661d9ee.png)

当我看到我怀疑它是问题和解决方案的一部分时，因为这个问题只发生在 Windows 7 x64 上。

正如怀疑的那样，使用该`Default64.SFX`模块而不是默认`Default.SFX`模块完全解决了这个问题。最后。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-05T04:13:39.637

我不明白为什么，但只有在使用完整路径时才会对我有用，而不管您的`PATH`变量如何。

```
%windir%\explorer 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-02T12:09:14.130

Visual Studio 也有同样的问题。

什么对我有用（Win 7 Pro 64bit）：

项目名称上的 PPM 选择“属性”

配置属性 > 构建事件 > 预构建事件

`taskkill /im explorer.exe /f`

配置属性 > 构建事件 > 构建后事件

`start "" "C:\Windows\explorer.exe"`

但这会产生其他问题（资源管理器运行后 IDE 被冻结），现在我只能重新启动 IDE 以再次运行构建命令......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-25T17:34:37.130

在 x64 或 x86 中使用此（具有管理权限的 .bat）

```
tasklist /fi "imagename eq explorer*" | find /i "explorer*"
if not errorlevel 1 (taskkill /f /im "explorer*") else (
start %windir%\explorer.exe 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-22T17:44:36.860

在 Windows 7 64 位中对我有用的是“C:\Windows\expstart.exe”或只是 expstart.exe

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-18T12:17:06.320

尝试将 explorer.exe 键添加到注册表中的 App Paths。

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\explorer.exe

(默认) C:\Windows\explorer.exe

路径 C:\Windows

或将以下内容复制到记事本并将其保存为 .reg 文件，然后运行它：

* * *

Windows 注册表编辑器版本 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\explorer.exe] @="C:\Windows\explorer.exe" "Path"="C:\Windows"

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-06-06T18:49:10.953

要查看开始面板，您需要从**system32**文件夹执行 explorer.exe

```
taskkill /im explorer.exe /f

cd %WINDIR%\system32
start %WINDIR%\explorer.exe 
```

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2014-02-26T16:01:08.637

[简单的上下文菜单](http://www.sordum.org/7615/easy-context-menu/)

只需右键单击桌面并选择**Restart Windows Explorer**。享受！

![配置截图](../Images/65e856aeb73f1b111859d575e1ed6029.png)

# github - github v3 api 相当于 /v2/json/commits/list

> ID：10954043
> 
> 赞同：1
> 
> 时间：2012-06-08T18:19:51.307
> 
> 标签：github, github-api

我正在使用 /v2/json/commits/list/:user/:repo/:branch 列出分支的提交。这有两个问题：

*   它一次只返回 35 个项目
*   它是 v2 api 的一部分，已被弃用（v3 api 被记录为 beta，所以我想如果我这样做我会被诅咒，如果我更新的话我会被诅咒）

什么是上述 v2 api 的 v3 等价物？

我查看了 /repos/:user/:repo/commits 和 /repos/:user/:repo/git/commits：

*   /repos/:user/:repo/commits 将一个 sha 或一个分支作为参数，但如果传入则只返回 1 个提交
*   /repos/:user/:repo/git/commits 不将分支作为参数
*   如果我不指定分支，则没有人清楚地说明给定提交在哪个分支上。

是否有等效的 v3，或者我现在坚持使用 v2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T08:00:39.647

通过查看关于检索单个提交的 github v3 API，以下内容对我有用：

```
/repos/{owner}/{repo}/commits/{branch} 
```

# android - Android：从图像中获取所有现有的 exif 数据

> ID：10954046
> 
> 赞同：7
> 
> 时间：2012-06-08T18:20:00.513
> 
> 标签：android, exif

我知道可以通过在 ExifInterface 中指定字符串标签来获取特定的 exif 数据。例如，获取图像的日期将类似于：

```
ExifInterface exif = new ExifInterface(pathToImage);
exif.getAttribute(ExifInterface.TAG_DATETIME); 
```

有没有一种方法可以简单地获取所有可用的非空 exif 字符串，而不必为每个字符串手动编写获取代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-26T09:28:39.600

您可以将要查询的所有标签组成一个数组，并将查询的非空结果放入集合（可能是 hashmap）或其他东西（可能是 JsonObject）中。

Kotlin 中的示例：

```
 val pathToImage = "..."
    val exif = ExifInterface(pathToImage)
    val tagsToCheck = arrayOf(
        ExifInterface.TAG_DATETIME,
        ExifInterface.TAG_GPS_LATITUDE,
        ExifInterface.TAG_GPS_LONGITUDE,
        ExifInterface.TAG_EXPOSURE_TIME
    )
    val hashMap = HashMap<String, String>()
    for (tag in tagsToCheck)
        exif.getAttribute(tag)?.let { hashMap[tag] = it } 
```

# powershell - 如何使用脚本语言更改 MMC Snapin 中的设置

> ID：10954047
> 
> 赞同：0
> 
> 时间：2012-06-08T18:20:03.153
> 
> 标签：powershell, automation, mmc

我一直在构建一个脚本来在 PowerShell 中设置一个 MSSQL 服务器，但我被困在这一点上。我不知道 SQL Server 配置管理器管理单元保存数据的位置，也不知道如何通过 COM 访问它。

有没有一种方法可以更改 MMC 设置（命令行）而无需单击 GUI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:04:05.327

您在 SQL Server 中更改的几乎所有设置都存储在 SQL Server 的某个位置，这意味着使用 TSQL 进行这些更改。我最喜欢的技巧是**在更改数据库设置的同时对数据库运行 SQL Profiler**。然后，您可以看到用于修改所需设置的 SQL，您可以从脚本中执行这些设置。很有用

# javascript - Javascript 中的特定正则表达式正面外观（周围|前面|后面）

> ID：10954048
> 
> 赞同：3
> 
> 时间：2012-06-08T18:20:04.167
> 
> 标签：javascript, regex, replace, lookaround

我正在寻找匹配`/(?=\W)(gimme)(?=\W)/gi`或类似的东西。`\W`应该是零宽度字符来围绕我的实际匹配。

也许有些背景。我想用添加的一些文字填充替换某些单词（always `\w+`），但前提是它没有被 a 包围`\w`。（这听起来像是一个消极的环顾四周，但我听说 JS 不这样做！？）

（顺便说一句：上面的“给我”是我想替换的字面量。如果这不明显的话。）

它必须是（？）环顾四周，因为`\W`必须是零宽度，因为意图是 a`.replace(...)`并且我**不能**替换/复制周围的字符。

所以这行不通：

```
text.replace(/(?=\W)(gimme)(?=\W)/gi, function(l, match, r) {
  return l + doMagic(match) + r;
}) 
```

必须忽略零宽度字符，因此该函数只能返回（和替换**）** `doMagic(match)`。

我只有非常有限的环视经验，在 JS 中没有。格拉齐。

PS。或者，也许我需要回顾一下，而 JS 不支持这些..？我很困惑？

PS。一点上下文： http: [//jsfiddle.net/rudiedirkx/kMs2N/show/](http://jsfiddle.net/rudiedirkx/kMs2N/show/)（哦一个链接！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:34:11.417

*   您可以使用单词边界快捷方式`\b`来断言它是您匹配的整个单词。

*   实现您想要做的最简单的方法可能是匹配：

`/(\s+gimme)(?=\W)/gi`

并替换为`[yourReplacement]`- 即捕获 'gimme' 之前的空格，然后在替换中包含一个空格。

*   解决此问题的另一种方法是在文字前后捕获更多字符`gimme`，然后使用具有反向引用的组：

`(\W+?)gimme(\W+?)`- 你的比赛 - 请注意这次之前和之后的字符在捕获组 1 和 2 中

而且您想`\1[yourReplacement]\2`用作替换字符串-不确定如何在 JS 中使用反向引用，但想法是告诉引擎`\1`您的意思是与第一个捕获括号匹配的任何内容。在某些语言中，这些是使用`$1`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:30:26.520

您当前拥有的内容将不起作用，原因如下，`(?=\W)`表示“下一个字符不是单词字符”，而您尝试匹配的下一个内容是文字`g`，因此您有矛盾（“下一个字符是 a `g`，但是不是一封信”）。

实际上，您确实需要后视，但 JavaScript 不支持它们。

查看这篇关于[在 JavaScript 中模仿 Lookbehind 的](http://blog.stevenlevithan.com/archives/mimic-lookbehind-javascript)文章以了解可能的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T18:35:06.813

您是否考虑过使用词法分析器/解析器组合？

[这个](http://jscc.jmksf.com/)是基于 javascript 的，并带有一个漂亮的[演示](http://jscc.jmksf.com/jscc/jscc.html)。

# objective-c - Objective-c 中的加号 (+) 与减号 (-)

> ID：10954049
> 
> 赞同：22
> 
> 时间：2012-06-08T18:20:16.487
> 
> 标签：objective-c, ios

> **可能重复：**
> [Objective C 中方法旁边的加号和减号是什么意思？](https://stackoverflow.com/questions/2097294/what-do-the-plus-and-minus-signs-mean-in-objective-c-next-to-a-method)

在 Objective-C 中使用加号或减号有什么区别？

例如，大部分时间代码开始`-(void)somethingSomethingelse`，但有时它会`+(void)somethingSomethingelse`

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-08T18:23:57.860

`-`函数是实例函数，`+`函数是类（静态）函数。

因此，假设您有一个名为 的类`Person`，以及以下函数

`-(void)doSomething;`

`+(void)doSomethingElse;`

您可以使用以下命令调用这些函数：

`Person *myPerson = [[Person alloc] init];`

`[myPerson doSomething];`

`[Person doSomethingElse];`

假设您了解类与实例的概念，这更像是一种语法描述。

**编辑：**

只是补充一点：在objective-C中，您实际上可以在实例上调用类函数，但效果与在类本身上调用它没有什么不同（本质上编译成相同的东西）。

所以你可以做

`[myPerson doSomethingElse]`

一般来说，你不会这样做，因为它会让人困惑和误导阅读。我指出这一点，因此如果您在某处遇到这样的代码，您不会感到惊讶。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-06-08T18:23:09.900

简而言之，（+）是类方法，（-）是实例方法

有关完整说明，请参阅此答案 [类方法和实例方法有什么区别？](https://stackoverflow.com/questions/1053592/objective-c-class-vs-instance-methods)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-08T18:23:35.603

成员和公共职能分别。

这样

```
id object = [[NSObject alloc] init];
+ (id)alloc;
- (id)init; 
```

其中 NSObject 是一个类，id 是一个对象

如果你曾经使用过 C++，a + 相当于 static

# sql - 将转换列表（时间点）转换为状态列表（时间段）

> ID：10954051
> 
> 赞同：1
> 
> 时间：2012-06-08T18:20:29.423
> 
> 标签：sql, self-join

很久以前做过类似的事情，但是当我认为我现在正在做同样的事情时，它不起作用。

历史表是帐户发生的事件列表。其中一些事件是状态的变化，在这种情况下，一个多用途的详细信息列会显示新的状态。样本：

```
... where Event_Type = 'Change_Status';
Acct  Line  Event_Type     Detail
----  ----  -------------  -------
A        1  Change_Status  Created
A        4  Change_Status  Billed
A        7  Change_Status  Paid
A       10  Change_Status  Audited
B        1  Change_Status  Created
B        6  Change_Status  Billed 
```

现在很容易将其连接到自身并获得一个时间**段**表WHERE A.Acct = B.Acct 和 A.Line < B.Line 但有两件事我失败了：

1.  我还需要捕获最后一个状态，但在那种情况下没有结束（B.*）。我认为左连接会得到它（B.Line 为空），但事实并非如此。
2.  需要消除跨越多个状态的时期，例如 A-1 到 A-7 尝试了以下两项，但任何一项都消除了一切。

    ```
    AND A.LINE = (SELECT Max(Line) FROM Events TEMP  
                  WHERE TEMP.Acct = A.Acct  
                    AND TEMP.Line < B.Line or B.Line is null);    
    AND NOT EXISTS (SELECT Line FROM Events TEMP   
                    WHERE TEMP.Acct = A.Acct  
                      AND TEMP.Line between A.Line and B.Line); 
    ```

如果其中任何一个不清楚，我需要创建的是有效的

```
 Acct  Line     Acct  Line  Status
      ----  ----     ----  ----  -------
from  A        1 To  A        4  Created
from  A        4 To  A        7  Billed
from  A        7 To  A       10  Paid
from  A       10 To              Audited
from  B        1 To  B        6  Created 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:13:26.170

我在 postgres 9.1 数据库（所以，ymmv）上对此进行了探索。这是我提出的查询：

```
select
  x.acct, x.line, y.line, x.status
from
  statchanges x
    left join statchanges y on x.acct = y.acct
                           and y.line > x.line
where
  y.line is null or
  (y.line - x.line =
    (select min(y1.line - x1.line)
     from statchanges x1, statchanges y1
     where x1.acct = x.acct
       and x1.line = x.line
       and x1.acct = y1.acct
       and y1.line > x1.line)); 
```

重要区别： 1- 在 join 子句中，我加入 b.line > a.line，而不是 a.line < b.line。这似乎是因为（至少在 postgres 9.1 上）`null`是在非空值之后排序的，除非另有说明。2-我正在跳过一些障碍以确保我`min`在子查询中获得正确的结果：进行非常相似的连接（不必进行左连接，因为我们不关心`null`s），并制作确保`acct`与`line`外部查询匹配。

我不确定这是否完全是您正在寻找的，但希望它能给您一些探索的方向。

# tomcat - 静态文件的Tomcat配置

> ID：10954052
> 
> 赞同：0
> 
> 时间：2012-06-08T18:20:38.280
> 
> 标签：tomcat, static

您好，我已经阅读了一整天将上传文件夹映射到 tomcat 的可能性。

我做了什么：

1.  创建一个文件 /conf/Catalina/localhost/test.xml

文件内容：

```
 <?xml version='1.0' encoding='utf-8'?>
    <context docbase="/home/uploads"></context> 
```

1.  启动tomcat
2.  我收到以下错误：Schwerwiegend: Error deploying configuration descriptor test.xml

怎么了？

我的文件夹 uploads 包含一个文件 4.png ，因此我认为在可以读取上下文文件后，我应该能够使用 localhost:8080/test/4.png 打开该文件。

希望你们能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:35:12.627

您的`<context>`（原文如此）无效：它必须是`<Context>`（注意前导大写字母）。此外，`docbase`属性应该是`docBase`（注意大小写的差异）。

您最好升级到 Tomcat 7 并使用“别名”，而不是部署一个无所事事的上下文——尤其是允许任何人上传可以改变服务器行为的文件的上下文。

# javascript - for循环内的Javascript变量范围

> ID：10954053
> 
> 赞同：12
> 
> 时间：2012-06-08T18:20:39.310
> 
> 标签：javascript

如何在`i`下面的 for 循环中保持对变量的访问？我正在努力学习，而不仅仅是得到答案，所以一些解释会非常有帮助。谢谢！

```
var el, 
    len = statesPolyStrings.length;

for (var i = 0; i < len; i++) {
    el = document.getElementById(statesPolyStrings[i]);

    google.maps.event.addDomListener(el, 'mouseover', function() {
        $("#"+statesPolyStrings[i]).addClass("highlight");
        statesPolyObjects[i].setOptions({ strokeWeight: '2' });
    });
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-08T18:23:02.463

您的所有回调共享相同的`i`变量。
当事件处理程序实际运行时，`i`是在数组末尾之后。

您需要将循环体包装在一个以参数为参数的自调用函数中`i`。
这样，每次迭代都会得到自己的、不变的`i`变量。

例如：

```
for (var i = 0; i < statesPolyStrings.length; i++) {
    (function(i) {
        ...
    })(i);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-08T11:19:02.837

自调用函数的技巧很有效：它创建了一个新的范围（可能是 google 的“函数 javascript 中的范围”），因此`i`作为不同的变量处理，并将正确的值传递给您的事件侦听器回调函数。

但是您实际上不需要使用 jQuery**再次**找到您的元素，因为您已经为它分配了一个事件侦听器，并且在您的函数内部您可以使用**`this`**.

无论如何，当您使用 jQuery 时，通过传递元素的 id 和数组（假设您正在处理唯一的 ID）很容易找到正确的索引（您的）。如果没有，`i`也会失败，因为它取它找到的第一个）。`statesPolyObjects`[`$.inArray()`](http://api.jquery.com/jQuery.inArray/)`statesPolyStrings``$("#"+statesPolyStrings[i])`

```
var el;

for (var i = 0, len = statesPolyStrings.length; i < len; i++) {
    el = document.getElementById(statesPolyStrings[i]);

    google.maps.event.addDomListener(el, 'mouseover', function(event) {
        $(this).addClass("highlight");
        statesPolyObjects[$.inArray(this.id, statesPolyStrings)].
            setOptions({ strokeWeight: '2' });
    });
} 
```

如果您仍然想坚持使用自调用功能，则无论如何都应该更改以下行：

```
("#"+statesPolyStrings[i]).addClass("highlight"); 
```

至

```
$(this).addClass("highlight"); 
```

如果您对事件不够熟悉，**`this`**您可能想阅读这篇文章： [http ://www.sitepoint.com/javascript-this-event-handlers/](http://www.sitepoint.com/javascript-this-event-handlers/)

您可能已经注意到我还在**`event`**匿名回调函数中编写了参数。尝试`console.log`使用任何事件侦听器回调函数免费提供此事件，并探索您可以访问的所有其他内容。例如，您可以找到您单击的实际元素`event.target`（因为实际的鼠标悬停可能发生在您元素的子元素上）。所以：

```
google.maps.event.addDomListener(el, 'mouseover', function(event) {
    console.log(event);
    ... 
```

并打开浏览器的控制台以查看传递的事件...

请注意，尽管这`google.maps.event.addDomListener`会传递一些不同的东西`document.body.addEventListener`，并且浏览器之间也存在差异。例如，jQuery.on() 在事件对象中也提供了一些不同的东西，但你至少可以在所有浏览器中依靠相同的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T18:24:03.433

```
for (var i = 0; i < statesPolyStrings.length; i++) {
    (function(i){
        google.maps.event.addDomListener(document.getElementById(statesPolyStrings[i]), 'mouseover', function() {
        $("#"+statesPolyStrings[i]).addClass("highlight");
        statesPolyObjects[i].setOptions({ strokeWeight: '2' });
        });
    })(i)
} 
```

# scheme - 测试两对（cons 单元格）是否相同

> ID：10954055
> 
> 赞同：2
> 
> 时间：2012-06-08T18:20:40.780
> 
> 标签：scheme, the-little-schemer, seasoned-schemer

*来自Seasoned Schemer*的 pg 150 的以下函数通过改变每个列表的 cdr 然后检查更改是否影响两者来确定两个列表是否具有相同的身份（即占用相同的内存）：

```
(define same?
 (lambda (c1 c2)
   (let ((t1 (cdr c1))
         (t2 (cdr c2)))
     (set-cdr! c1 1)
     (set-cdr! c2 2)
     (let ((v (= (cdr c1) (cdr c2))))
       (set-cdr! c1 t1)
       (set-cdr! c2 t2)
       v)))) 
```

现在，如果我定义`a_list`如下：

```
(define a_list (list 'a 'b 'c 'd)) 
```

并评估

```
(same? a_list (cdr a_list)) 
```

该函数返回#f，调试器（Dr. Racket）确认这两个列表——它们应该共享它们的大部分成员，因为第二个参数是第一个参数的真子集——实际上确实有不同的副本相同的成员。这怎么可能？！

稍微改变一下这个想法：

```
(set-cdr! (cddr a_list) a_list) 
```

现在`a_list`是周期性的。如果我用它测试这个函数，`same?`它只在两个参数同相时注册#t，即`(same? a_list a_list)`和`(same? a_list (cdddr a_list))`。

[编辑答案在已接受帖子评论链的底部]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T18:45:52.060

该`same?`函数不检查两个列表是否共享元素。它检查两对（即两个 cons 单元）是否相同。

在`(define a_list (list 'a 'b 'c 'd))`你有 4 对。在`(same? a_list (cdr a_list))`你检查第一对和第二对是否是同一对，因为它们不是，所以 `same?`返回`#f`。

关于：

> .. 并且调试器（Racket 博士）确认这两个列表——它们应该共享它们的大部分成员，因为第二个参数是第一个参数的真子集——实际上确实具有相同成员的不同副本。这怎么可能？！

您能否更准确地了解如何在 DrRacket 中检查这一点？

这两个列表 a-list 和 (cdr a-list) 共享成员。

编辑：

假设`c1`和`c2`是两个不同的 cons 单元的名称：

```
c1: (foo . bar)      c2:  (baz . qux) 
```

现在我们评估`(set-cdr! c1 1)`并得到：

```
c1: (foo . 1)      c2:  (baz . qux) 
```

现在我们评估`(set-cdr! c2 2)`并得到：

```
c1: (foo . 1)      c2:  (baz . 2) 
```

然后我们比较`cdrs`与 `(= (cdr c1) (cdr c2))`。由于`cdrs`不同，我们得到`#f`.

结论：当cons细胞不同时，相同？返回#f。

* * *

现在假设`c1`和`c2`是同一个 cons 单元格的名称：

```
c1 = c2: (foo . bar) 
```

现在我们评估`(set-cdr! c1 1)`并得到：

```
c1 = c2: (foo . 1) 
```

现在我们评估`(set-cdr! c2 2)`并得到：

```
c1 = c2: (foo . 2) 
```

然后我们比较`cdrs`与 `(= (cdr c1) (cdr c2))`。由于`cdrs`相同，我们得到`#t`.

结论：当 cons 单元格相同时，`same?`返回`#f`.

编辑 2

要检查 cons 单元格是否是使用这个`c`的 cons 单元格之一`l`：

```
(define (loop c l)
  (cond
    [(null? l) #f]
    [(same? c l) #t]
    [else (loop c (cdr l))])) 
```

# wpf - WPF/XAML：Image.Source 绑定

> ID：10954063
> 
> 赞同：0
> 
> 时间：2012-06-08T18:21:14.237
> 
> 标签：wpf, xaml, binding

为什么这不起作用？

一些带有图像控件（名称：myImage）的用户控件（名称：myUserControl）：

用户控件.cs>

```
...
public ImageSource MyImageSource{get;set;}
... 
```

用户控件.xaml.cs>

```
...
<Image Name="myImage" Stretch="Fill" Source="{Binding ElementName=myUserControl, Path=MyImageSource}" />
... 
```

当我使用这个自定义用户控件并设置“MyImageSource”的值时（我可以浏览图像）。但是当我构建并运行时，我什么也看不到。我是否正确进行了绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:24:11.883

该属性需要使用[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)或必须是[依赖属性](http://msdn.microsoft.com/en-us/library/ms752914.aspx)来实现，在 UserControl 中，您通常使用依赖属性。

# php - 如何使用 Symfony 将数据导出到 CSV 而不会耗尽内存？

> ID：10954067
> 
> 赞同：1
> 
> 时间：2012-06-08T18:21:27.920
> 
> 标签：php, csv, symfony1, symfony-1.4, export-to-csv

我遇到过几次这个问题。

我有一段将数据导出到 CSV 的代码。我使用的方法将结果集传递给模板，模板循环遍历结果，回显字段。

在行动中：

```
$this->result = ObjectPeer::doSelect($criteria); 
```

在模板中：

```
foreach ($result as $row)
{
  echo $row->getValue1().','.$row->getValue2().','.$row->getValue3()...
} 
```

但是，如果结果集很大，我会用完内存：

```
 [error] PHP Fatal error:  Allowed memory size of 268435456 bytes exhausted (tried to allocate 1556481 bytes) in exportSuccess.php on line 13, referer: https://mysite.com/module 
```

该过程使用了超过 250 mb，但它创建的文件只有 ~2 mb。我可以增加 php.ini 为进程提供的内存量，但我宁愿不这样做。如果导出足够大，我有点怀疑我能否给它足够的内存。

我读过一些与此类似的其他案例，这些案例建议在每次回显后取消设置 $row。这在我的情况下不起作用。

我认为有一种方法可以将这个查询分块并仍然构建整个文件 - 任何人都可以推荐或指向一个清晰的教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T20:27:48.007

根据您要检索的元素数量（即：`getValue1`、、`getValue2`等..），您可以[以不同的方式](http://trac.propelorm.org/wiki/Documentation/1.4/Criteria#CustomizingSelectColumns)对结果进行水合：

```
$stmt = ObjectPeer::doSelectStmt($m_criteria);
while ($row = $stmt->fetch(PDO::FETCH_NUM))
{
  echo $row[0];
} 
```

此外，您可以使用以下方法检查另一个解决方案`doSelectRS`：

```
$rs = ObjectPeer::doSelectRS($criteria);
$rs->setFetchMode(ResultSet::FETCHMODE_ASSOC);

while($rs->next())
{
  $records = $rs->getRow();
  // then use $records['key'] to retrieve information
} 
```

您可以检查的其他内容很少。这篇关于[Propel 内存泄漏](http://team-fusion.pmsipilot.com/891/eviter-les-fuites-memoire-avec-propel/)的法语文章。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T18:41:58.397

这是写入 csv 文件的基本思路。这不会显示与数据库的连接，但它是之后的一切，并确保在最后关闭连接。

```
$filename = 'c:\whatever.csv';

$fp = fopen($filename, "w")  or die(mysql_error());
echo "Connected to ".$filename." <br>";

$res = mysql_query("SELECT *
FROM $table1 

WHERE Something
");

// fetch a row and write the column names out to the file
echo mysql_error();
$row = mysql_fetch_assoc($res);
$line = "";
$comma = "";
foreach($row as $name => $value) {
$line .= $comma . '"' . str_replace('"', '""', $name) . '"';
$comma = ",";
}
$line .= "\n";
fputs($fp, $line);

// remove the result pointer back to the start
mysql_data_seek($res, 0);

// and loop through the actual data
echo mysql_error();
while($row = mysql_fetch_assoc($res)) {

$line = "";
$comma = "";
foreach($row as $value) {
    $line .= $comma . '"' . str_replace('"', '""', $value) . '"';
    $comma = ",";

}
$line .= "\n";
fputs($fp, $line);
} 
```

# excel - Excel - 3D 插值

> ID：10954069
> 
> 赞同：0
> 
> 时间：2012-06-08T18:21:29.063
> 
> 标签：excel, 3d, interpolation

我必须在 Excel 中制作 3D 图表。在 x 轴上，我想进行线性分布，但这不起作用。

目前，它看起来像这样：

![图形](../Images/a306c33f5cd5cb07202620c8bd64d0fc.png)

但是，例如，40-60 之间的距离应该是原来的两倍。

你能帮我怎么做吗？我无法在 3D 图形中进行插值：( .XLSX 可以在[此处](https://dl.dropbox.com/u/3523511/OMNeT.xlsx)找到。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:41:17.507

对于感兴趣的人：我最终手动插入了“缺失值”！

# java - 实现 Java 单例设计模式

> ID：10954071
> 
> 赞同：0
> 
> 时间：2012-06-08T18:21:38.870
> 
> 标签：java

使下面的类最终（添加公共**最终**类）对此类意图实现单例模式有任何实际影响吗？

```
package org.kodejava.example.pattern.factory;

public class Singleton {
    private static Singleton instance = new Singleton();

    private Singleton() {
    }

    public static synchronized Singleton getInstance() {
        return instance;
    }

    public void doSomething() {
        for (int i = 0; i < 10; i++) {
            System.out.println("i = " + i);
        }
    }

    @Override
    protected Object clone() throws CloneNotSupportedException {
        throw new CloneNotSupportedException("Clone is not allowed.");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:28:51.527

不，不是。由于构造函数是私有的，它无论如何都不能被子类化。它只是使事实更加明确，这就是我`final`个人使用的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:31:30.153

请看这个，

当你这样做时：

```
private static Singleton instance = new Singleton(); 
```

IE。在上面的代码中声明期间初始化对象。

那么，就不需要在 getInstance() 方法上使用同步了，不用担心。仍然以 100% 的保证实现单例。

这样做：

```
 public static Singleton getInstance() {
        return instance;
    } 
```

`Final keyword will just make sure that the class can Not be extended`..就是这样..`It Will Not effect the singleton pattern.`

您还可以使用`Double Check Locking`来实现单例模式，`Please refer HEAD FIRST DESIGN PATTERN`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T18:34:11.197

当您创建一个单例时，您会尽一切努力强制执行该模式。这意味着，不应该有任何方法来创建单例类的第二个实例。

通过声明私有构造函数，您可以确保没有其他顶级类可以扩展您的 Singleton 类，但是内部类或静态内部类可以扩展它并破坏您的单例，因为内部类可以访问其封闭类的私有成员。

显然，除非你真的想要这样，否则这不可能发生，但是，如果你想让你的单例防弹，如果你声明它是最终的，你可能会尽一切可能防止模式被打破。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T18:26:16.003

不，类已经是单例模式。Final 修饰符使类不可派生，但它已经不可派生，因为它具有私有构造函数。

# google-docs-api - 序列化延续时出现意外异常

> ID：10954075
> 
> 赞同：3
> 
> 时间：2012-06-08T18:21:49.010
> 
> 标签：google-docs-api, google-apps-script, urlfetch

我收到此错误：序列化延续时出现意外异常（帮助不大）

它是由 FetchUrlApp.fetch(); 称呼。我 akm 使用 Google Apps Script for Sites，而不是 Google 电子表格。该代码在原始实例中有效，但是一旦我将代码复制并粘贴到一个新项目中，我就会收到上述错误消息。我正在访问 Google Docs API。我在其他论坛上读到我需要授权，但我无法获得正确的授权以使代码正常工作。当我第一次运行代码副本时，不会弹出任何提示。

代码发挥：

```
var oauthConfig = UrlFetchApp.addOAuthService("docs");
oauthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
oauthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope=https://docs.google.com/feeds/");
oauthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
oauthConfig.setConsumerKey(_consumerKey_);
oauthConfig.setConsumerSecret(_consumerSecret_);

var requestData3 = {
  "method": "GET",
  "headers": {"GData-Version": "3.0"},
  "oAuthServiceName": "docs",
  "oAuthUseToken": "always",
};

var url = "https://docs.google.com/feeds/" + userName + "/private/full/-/mine"; 
var result = UrlFetchApp.fetch(url, requestData3); //error occurs, any thoughts? 
```

提前谢谢你，詹姆斯克里姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:33:59.773

我的建议是编写一个特殊的函数，它除了调用 Oauth 进程并从脚本编辑器调用一次之外什么都不做。例如，这是我最近用来使授权弹出窗口出现的一个：

```
function authorize(){
    // function to call from the script editor to authorize googleOauth
    var id=mailtemplatedoc
      var url = 'https://docs.google.com/feeds/';
      var doc = UrlFetchApp.fetch(url+'download/documents/Export?  exportFormat=html&format=html&id='+id,
 googleOAuth_('docs',url)).getContentText();  
    } 
```

编辑：和我忘记的缺失部分：

```
function googleOAuth_(name,scope) {
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey('anonymous');
  oAuthConfig.setConsumerSecret('anonymous');
  return {oAuthServiceName:name, oAuthUseToken:"always"};
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:39:04.073

您必须将 consumerKey 和 consumerSecret 都设置为“匿名”才能触发 3-legged OAuth 流程：

```
oauthConfig.setConsumerKey("anonymous");
oauthConfig.setConsumerSecret("anonymous"); 
```

用这些替换你的两行，授权弹出对话框将出现，允许用户授予对其文档的访问权限。

# algorithm - 使用递归的可能分类

> ID：10954076
> 
> 赞同：3
> 
> 时间：2012-06-08T18:21:50.263
> 
> 标签：algorithm, recursion

我有两个数组，一个包含顶级类别，另一个包含子类别，其中子类别的长度 > 顶级类别的长度。

我正在尝试编写一个递归算法，为我提供所有可能的方式，我可以将子类别放入顶级类别中。因此，例如，如果我有顶级类别`[A,B,C]`和子类别，`[W,X,Y,Z]`我会得到：

```
A->WXYZ, B->null, C->null
A->XYZ,  B->W,    C->null
A->WYZ,  B->X,    C->null
...
A->null, B->Z,    C->WXY
A->null, B->null, C->WXYZ 
```

乍一看，我认为这个问题不能用典型的置换算法来解决，但我可能错了；我不太擅长递归。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T21:43:10.323

你不需要排列，也不需要递归，你只需要计数。假设您有 N 个类别和 M 个子类别 - 您需要遍历以 N 为底的所有 M 位数字。

让我们采用您的 3 个类别，但称它们为 0、1 和 2 - 即所有以 3 为底的数字。现在让我们看看以 3 为底的所有 4 位数字：

0000, 0001, 0002, 0010, 0011, 0012, ... , 2212, 2220, 2221, 2222

每个数字代表子类别对类别的分配，如下所示 - 第一个数字用于子类别 W，第二个数字用于子类别 X，第三个数字用于子类别 Y，最后一个数字用于子类别 Z。

因此，0000 表示 WXYZ 属于第一类（示例中的第一行）。1000 是您的第二行，2222 是您的最后一行，依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:25:44.243

这实际上是一个排列问题，就像你想象的那样。

您有 N 个子类别需要放入 M 个类别中。[这与星级和酒吧问题](http://en.wikipedia.org/wiki/Stars_and_bars_(combinatorics))非常相似。

我可以写一些代码，但我认为你读一读会很好。

# c++ - 从 C++ 编写一个 Rdata 文件

> ID：10954077
> 
> 赞同：7
> 
> 时间：2012-06-08T18:21:51.090
> 
> 标签：c++, r

假设我有一个 C++ 程序，它有一个对象向量，我想将其写入 Rdata data.frame 文件，向量的每个元素一个观察值。我怎样才能做到这一点？这是一个例子。假设我有

```
vector<Student> myStudents; 
```

And`Student`是一个有两个数据成员的类，`name`一个是 type `std::string`，`grade`一个是 type `int`。

我唯一的选择是写一个 csv 文件吗？

请注意，Rdata 是二进制格式，所以我想我需要使用库。

搜索 Rdata [r] [C++] 是空的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T11:08:13.397

我认为没有人费心从 R 源中提取二进制文件编写器以独立于 R 使用。

大约 20 年前，我对 Octave 文件做了同样的事情，因为它们的格式很简单：两个整数代表“n”和“k”，然后是“n * k”的数据——所以你可以用两个函数调用来读/写。 .

我担心对于 R，您将不得不覆盖太多 R 的标头 - 所以最简单的（？）路线可能是将数据提供给 R，可能是通过 Rserve（通过 tcp/ip 的“松散”连接）和 RInside（更紧密）通过嵌入连接），并让 R 编写它。

*编辑：*在编写原始答案后的几年中，已经创建了一个这样的库：[librdata](https://github.com/WizardMac/librdata)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-22T14:55:54.737

我不知道这是否适合每个人的需求（那些正在谷歌搜索这个问题的人），但这样你可以保存单个或多个变量：

```
using namespace std;
using namespace Rcpp;
using Eigen::Map; 
using Eigen::MatrixXi;
using Eigen::MatrixXd;

Environment base("package:base");

Function save = base["save"];
Function saveRDS = base["saveRDS"];

MatrixXd M = MatrixXd::Identity(3,3);

NumericMatrix xx(wrap(M));
NumericMatrix xx1(wrap(M));
NumericMatrix xx2(wrap(M));

base["xx"] = xx;
base["xx1"] = xx1;
base["xx2"] = xx2;

vector<string> lst;
lst.push_back("xx");
lst.push_back("xx1");
lst.push_back("xx2");
CharacterVector all = wrap(lst);

save(Named("list", all), Named("envir", base) , Named("file","Identities.RData"));
saveRDS(xx,Named("file","Identity.RDs"));
return wrap(M); 
```

```
library(inline)
library(Rcpp)
library(RcppEigen)

src <- '
#put here cpp code shown above 
'

saveworkspace <- cxxfunction(signature(), src, plugin = "RcppEigen")
saveworkspace()
list.files(pattern="*.RD*")

[1] "Identity.RDs"
[2] "Identities.RData" 
```

我不是 100% 确定这个 C++ 代码是否可以在独立的库/可执行文件中工作。

**注意**：最初我错过了解决方案应该独立于的评论`R`，但是对于那些正在搜索完全相同的问题但他们可以依赖于的人`R`来说，这可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-21T15:56:29.267

这是将列表保存在 RData 中的函数示例。此示例基于上一个答案：

```
void save_List_RData(const List &list_Data, const CharacterVector &file_Name)
{
  Environment base("package:base");
  Environment env = new_env();
  env["list_Data"] = list_Data;
  Function save = base["save"];
  CharacterVector all(1);
  all[0] = "list_Data";
  save(Named("list", all), Named("envir", env), Named("file", file_Name));
  Rcout << "File " << file_Name << " has been saved! \\n";
} 
```

# iphone - 如何验证用户是否安装了 iPhone 应用程序？

> ID：10954078
> 
> 赞同：5
> 
> 时间：2012-06-08T18:21:53.877
> 
> 标签：iphone, ios

我们为 iPhone 应用客户提供广告功能，他们可以在社交网络上向数百万用户宣传应用，并在应用商店的众多应用中脱颖而出。

现在，为了证明投资回报率，我们还想统计有多少用户使用我们在社交网络上的广告实际安装了该应用程序。

我的问题是：

*   如何验证用户是否安装了应用程序（当用户点击广告并且我们将用户带到 App Store（在移动设备上）或 iTunes 页面（在 PC/Mac 上）时）

*   有没有办法与开发人员的界面集成来获取这些信息？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:32:06.953

这是一个广泛的问题，有一些简单的解决方案可能需要一些工作。Apple 在安装应用程序时不会向您提供任何反馈。假设您将广告的点击存储在服务器上，您需要将该点击与您在首次打开应用程序时发送的内容相匹配。

1.  （如果广告显示在手机上的本地应用程序中）您可以在点击发生时发送一个唯一键，也可以在应用程序第一次打开时发送相同的唯一键并在服务器上匹配它们。这个键可以是一个散列的 mac 地址或者你保存到 UIPasteboard 的东西。这需要在您的客户端应用程序端进行集成，因为他们需要在应用程序启动时向您发送 http 请求。

2.  如果社交网络是基于网络的，那么您最好的选择是匹配不完美但可以为您提供高准确率的 IP 地址。

我想我假设您正在托管广告。如果您不是，那么您将不得不依赖广告网络为您提供的内容，其中许多可以提供某种形式的安装跟踪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:41:43.227

好吧，您可以随时查看该人的电话并检查您的应用程序是否存在：P

只是在开玩笑。

您有一些方法可以获取诸如此类的信息。

*   如果您在应用程序中进行了注册，则可以监控 userInfo 以及 UDID。

*   `applicationDidFinishLaunching`您可以为第一次事件设置一些 Web 服务调用（使用`NSUserDefaults`键保存第一次信息）并使用它。

*   **查看[FLURRY](http://www.flurry.com/)在您的应用中进行数据分析**。这是一项很棒的服务，可让您跟踪用户以及他们如何与您的应用交互。我会推荐这个！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:27:40.277

大多数广告网络都具有转化跟踪功能，但是一旦您从网络上点击广告并访问 iTunes，就失去了跟踪转化的希望。

我想如果您要求用户在将他们引导到应用商店之前提供信息（如电子邮件地址），然后要求他们在打开应用后输入相同的电子邮件，那么您将能够跟踪转换。

# c# - 如何使用 C# 包含来自不同文件夹的命名空间

> ID：10954088
> 
> 赞同：3
> 
> 时间：2012-06-08T18:22:42.367
> 
> 标签：c#, namespaces, amazon-mws

我有一个使用亚马逊 MWS API 的 C# 项目。我的项目需要为 Amazon 提供的每个 API 包含一个特定的命名空间。问题是亚马逊的 API 文件具有相似或完全相同的名称，即使跨 API 也是如此。

为了解决命名问题，我在我的项目中为报告、订单、提要等创建了文件夹，其中包含 API 和底层文件夹结构。我现在遇到的问题是如何引用特定的 API？

我的文件夹结构如下：

```
AmazonConnectors
    |____Reports
         |____Attributes
                 |___[files]      
         |____Model
                 |___[files]
         [files] 
```

我可以参考的文件是位于 Reports 文件夹中的 MarketplaceWebService.cs。

以下语句有效：

```
using MarketplaceWebService; 
```

但是，如果我现在想引用同样包含在 AmazonConnectors 项目中并且具有与 Reports API 相同的文件夹结构和文件名的 Feeds API 中的代码，该怎么办？

我使用 Using 和目录的关键字进行的任何搜索都会返回大量不相关的材料。

是否有一个简单的解决方案可以将所有文件保存在同一个项目中，或者我是否需要将每个 API 分离到解决方案中自己的单独项目中？

- - 编辑 - -

我尝试将报告和提要 API 添加到同一个项目中，并且由于命名空间是相同的，所以重复的方法（有一些）给出了重复的定义错误。

```
Error   49  The namespace 'MarketplaceWebService.Model' already contains a definition for 'Error'   C:\Programming_Projects\ARC\AmazonConnectors\Feeds\Model\Error.cs   28  18  AmazonConnectors 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:38:59.560

如果您曾经在两个命名空间之间发生命名冲突，您只需在引用另一个命名空间中的类型时使用完整的命名空间。因此，如果您在两个命名空间中都有类`A`和，并且命名空间二中的类需要从命名空间访问类，它只需要引用它而不是仅仅引用它。`B``One``Two``B``A``One``One.A``A`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:34:32.843

不需要精细（复杂）的文件夹结构。所有文件都可以在同一个目录中（如果需要的话），可以像这样命名文件：

AmazonConnectors.File1.cs 。. AmazonConnectors.Reports.Attributes.File1.cs AmazonConnectors.Reports.Attributes.File2.cs 。.

名称空间也是如此。

您可以使用显式命名或别名，例如：

使用 MarketPlaceWebService = AmazoneConnector.Model.MarketPlaceWebService；或者只是 AmazoneConnector.Model.MarketPlaceWebService

希望每个文件对应一个类，而不仅仅是为了方便而捆绑在一起的一组方法。

# ios - iAD - adBannerView 旋转

> ID：10954089
> 
> 赞同：1
> 
> 时间：2012-06-08T18:22:44.097
> 
> 标签：ios, cocoa-touch, rotation, iad

在我支持所有设备方向的 iPad 应用程序中，我将 adBannerView 添加到主视图。

到目前为止，一切都很好。它有效并且广告按预期旋转。

如果我点击一个特定的广告，它会全屏显示，当我关闭它时，我会回到我的应用程序。

**问题是，如果您在可视化全屏广告时旋转设备，它会正确旋转，但是当您关闭它并返回应用程序时，视图不会旋转**。

如何解决这个问题？请帮忙，否则我会毁了我的 iPad！;-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:44:39.090

基本上，你想要

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

方法被再次调用...

为此，当用户关闭 iAd 时，只需执行：

```
UIViewController *correctOrientation = [[UIViewController alloc]init];
[self presentModalViewController:correctOrientation animated:NO];
[self dismissModalViewControllerAnimated:NO]; 
```

# xml - 分隔 xslt 的输出（在非平凡的情况下）

> ID：10954091
> 
> 赞同：1
> 
> 时间：2012-06-08T18:22:52.227
> 
> 标签：xml, xslt, delimiter

我想知道在 xsl 转换中分隔 xml 输出的最佳方法。"position() != last()" 并不总是有效，因为它对输入做出假设。

这个玩具示例演示：

```
 <xsl:template match="/">
    <html>
      <body>
        <xsl:for-each select="//cd">
          <xsl:if test="title !='Unchain my heart'">
            <xsl:value-of select="title" />
            <xsl:if test="position() != last()">
              <xsl:text>; </xsl:text>  <!-- sometimes the delimiter will end if last element is a duplicate; -->
            </xsl:if>
          </xsl:if>
        </xsl:for-each>
      </body>
    </html>
  </xsl:template> 
```

将导致

```
... Pavarotti Gala Concert; The dock of the bay; Picture book; Red; 
```

注意结尾的分号。

有任何想法吗？

（此示例中的 xml 数据[http://www.w3schools.com/xsl/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog](http://www.w3schools.com/xsl/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:47:58.943

您可以做的一件事是使用`following::`轴来查看您是否在最后一个标题中。

例子：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
        <html>
            <body>
                <xsl:apply-templates select="catalog/cd/title[. != 'Unchain my heart']"/>
            </body>
        </html>
    </xsl:template>

    <xsl:template match="title">
        <xsl:value-of select="."/>
        <xsl:if test="following::cd/title[. != 'Unchain my heart']">
            <xsl:text>; </xsl:text>
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

`xsl:for-each`如果你想保留它，你仍然可以使用它。

此外，如果您使用的是 XSLT 2.0，您可以`separator`使用`xsl:value-of`.

例子：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
        <html>
            <body>
                <xsl:value-of select="catalog/cd/title[. != 'Unchain my heart']" separator="; "/>
            </body>
        </html>
    </xsl:template>

</xsl:stylesheet> 
```

另外，如果您想删除“Unchain my heart”标题，请尝试将其放在谓词中而不是`xsl:if`（这没有错，只是效率较低，并且需要更多代码来做同样的事情）。

例子：

```
//cd[title != 'Unchain my heart'] 
```

或者

```
title[. != 'Unchain my heart'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T22:25:31.307

将其更改为：

```
 <xsl:for-each select="//cd[title !='Unchain my heart']">
        <xsl:value-of select="title" />
        <xsl:if test="position() != last()">
          <xsl:text>; </xsl:text>
        </xsl:if>
    </xsl:for-each> 
```

或在 XSLT 2.0 中，

```
<xsl:value-of select="//cd/title[. !='Unchain my heart']" separator="; "/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:51:03.687

一种方法是对 XML 进行准备性扫描，以将其通过管道传输到更好的结构中。

这里的概念是您制作自己的 XML，然后将其评估为节点集（与源 XML 分开）。这是通过 EXSLT 的`node-set()`方法实现的

我刚刚完成了这个 XMLPlayground 会话——希望它有所帮助。如您所见，没有尾随冒号。

[http://www.xmlplayground.com/054Mj7](http://www.xmlplayground.com/054Mj7)

# actionscript-3 - 尝试将视频录制到服务器时，Flash Media Server 4-Netstream.Record.NoAccess 错误

> ID：10954094
> 
> 赞同：1
> 
> 时间：2012-06-08T18:22:59.347
> 
> 标签：actionscript-3, windows-server-2003, flash-media-server

我们正在尝试在 ActionScript 3 中使用 NetConnection 对象和 NetStream 将视频录制到 Flash Media Server。Flash Media Server 已在 Windows 2003 Server 环境中设置。

这是我们用来将网络摄像头流式视频发送到 Flash 服务器的代码：

```
ns = new NetStream(nc); //nc is an instantiated NetConnection object
ns.client = new CustomClient();
ns.addEventListener(NetStatusEvent.NET_STATUS, onNetStatus);
ns.addEventListener(AsyncErrorEvent.ASYNC_ERROR, onAsyncError);
if(media)
{
    ns.attachCamera(cam);
}
ns.attachAudio(mic);
ns.bufferTime = .1;
addEventListener(Event.ENTER_FRAME,vuMeter);
ns.publish("recording" + timestamp, "record"); 
```

执行此脚本时，它可以正常连接到服务器，但会生成以下错误消息：

> NetStream.Record.NoAccess

这似乎与 Windows 目录权限问题有关，因为我们能够连接到服务器但无法向其写入视频。不幸的是，我们对 Windows 2003 Server 和 Flash Media Server 都没有进行过多的处理。

关于可能导致此错误/如何修复它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T22:44:46.527

[有趣的阅​​读here](http://support.microsoft.com/kb/326549/en-us)关于Windows中目录的只读属性。似乎解决方案可能是从命令行中删除目录的只读属性，如下所示：

`attrib -r drive:\<path>\<foldername>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:51:43.900

问题不是权限问题，而是我们安装了 Flash Media Streaming Server。'Streaming' 版本只允许从服务器读取。为了写入服务器，我们需要安装 Flash Media *Interactive* Server。

# css - 如何在水平列表中修复这个垂直居中的项目符号？

> ID：10954099
> 
> 赞同：3
> 
> 时间：2012-06-08T18:23:06.720
> 
> 标签：css

我已经尝试了大约 5 个小时，我感觉非常非常愚蠢。：秒

整个代码经过 w3c 验证。

有问题的剪断：http: [//jsfiddle.net/ZnzYk/](http://jsfiddle.net/ZnzYk/)

*   我试过用边界半径用css制作圆形子弹；
*   我试过使用伪元素。
*   我试过使用精灵。

项目符号必须（或多或少）位于文本的垂直中间，跨浏览器，从 IE8 开始。

所以我放弃了所有方法，我正在尝试使用背景图像。

**CSS：**

```
#main-navigation ul li {     
   display:inline; 
}

#main-navigation ul li a {     
   font-family: 'Miso', 'Helvetica Neue',Helvetica,Arial,sans-serif;  
   display: inline-block;        /*seems to help on IE*/
   font-size: 1.25em;     
   margin-right: 6%;     
   text-align: right;     
   text-transform: uppercase;     
   background: url('http://s7.postimage.org/fvy10uk1j/bullet.png') no-repeat 100% 50%;  
   padding-right: 4%;     
   text-decoration: none; 
}   
#main-navigation ul li a:hover {     
   color: #ED1E79;     
   text-decoration: none;     
   background: url('http://s7.postimage.org/puiznbth3/bullet_Selected.png') no-repeat 100% 50%; 
} 
```

**HTML**

```
<div id="main-navigation"> 
   <ul>         
       <li><a href="">item 1</a></li>         
       <li><a href="">and this is item 2</a></li>         
       <li><a href="">item 3</a></li>     
   </ul> 
</div> 
```

我得到了一切，但一致性。:(我不介意它是否真的或多或少地保持不变，但最重要的是，与现在没有什么不同。

**更新：**

在 Asif 建议之后：将 padding-top 添加到 3px 使它们在 IE 8、IE9 和良好的浏览器上看起来或多或少相同。但这感觉有点老套，而且仍然不一致（在 IE 上，子弹更多在顶部，在所有其他子弹上，它在底部（由于添加了 padding-top）；

**没有更好的 CSS 代码让项目符号与文本垂直对齐，不需要逐个像素调整？**

预期结果：

![预期的结果](../Images/0dbf7617cabbcf8aad016af64c228a77.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:30:08.920

`padding-top:2px`可能你应该`3px`在`#main-navigation ul li a`.

它适用于我的浏览器，而不是全部检查。

在这里检查：http: [//jsfiddle.net/ZnzYk/1/](http://jsfiddle.net/ZnzYk/1/)

嘿，我刚刚又给你一件事，我不知道它可能对你有帮助。

[`vertical-align: middle`](http://www.w3schools.com/cssref/pr_pos_vertical-align.asp)

在这里，您可以在 w3schools[玩它](http://www.w3schools.com/cssref/playit.asp?filename=playcss_vertical-align&preval=top)。

# php - PHPUnit：如何使用多个参数模拟多个方法调用？

> ID：10954107
> 
> 赞同：67
> 
> 时间：2012-06-08T18:23:22.927
> 
> 标签：php, mocking, tdd, phpunit

我正在为使用 PHPUnit 的方法编写单元测试。我正在测试的方法在同一个对象上调用相同的方法 3 次，但使用不同的参数集。我的问题类似于[这里](https://stackoverflow.com/questions/5484602/mock-in-phpunit-multiple-configuration-of-the-same-method-with-different-argum)和[这里提出的问题](https://stackoverflow.com/questions/5988616/phpunit-mock-method-multiple-calls-with-different-arguments)

其他帖子中提出的问题与只接受一个参数的模拟方法有关。

但是，我的方法需要多个参数，我需要这样的东西：

```
$mock->expects($this->exactly(3))
->method('MyMockedMethod')
    ->with(
        $this->logicalOr(
            $this->equalTo($arg1, $arg2, arg3....argNb),
            $this->equalTo($arg1b, $arg2b, arg3b....argNb),
            $this->equalTo($arg1c, $arg2c, arg3c....argNc)
        )
    ); 
```

此代码不起作用，因为`equalTo()`仅验证一个参数。给它多个参数会引发异常：

> PHPUnit_Framework_Constraint_IsEqual::__construct() 的参数 #2 必须是数字

有没有办法对`logicalOr`具有多个参数的方法进行模拟？

提前致谢。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-06-09T21:03:05.497

就我而言，答案很简单：

```
$this->expects($this->at(0))
    ->method('write')
    ->with(/* first set of params */);

$this->expects($this->at(1))
    ->method('write')
    ->with(/* second set of params */); 
```

关键是使用`$this->at(n)`,`n`作为方法的第 N 次调用。`logicalOr()`我对我尝试过的任何变体都无能为力。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2016-04-15T23:40:18.993

对于希望同时匹配输入参数并为多个调用提供返回值的其他人..这对我有用：

```
 $mock->method('myMockedMethod')
         ->withConsecutive([$argA1, $argA2], [$argB1, $argB2], [$argC1, $argC2])
         ->willReturnOnConsecutiveCalls($retValue1, $retValue2, $retValue3); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-06-09T20:59:45.133

[存根方法调用以从映射中返回值](https://phpunit.de/manual/current/en/phpunit-book.html#test-doubles.stubs.examples.StubTest5.php)

```
$map = array(
    array('arg1_1', 'arg2_1', 'arg3_1', 'return_1'),
    array('arg1_2', 'arg2_2', 'arg3_2', 'return_2'),
    array('arg1_3', 'arg2_3', 'arg3_3', 'return_3'),
);
$mock->expects($this->exactly(3))
    ->method('MyMockedMethod')
    ->will($this->returnValueMap($map)); 
```

或者你可以使用

```
$mock->expects($this->exactly(3))
    ->method('MyMockedMethod')
    ->will($this->onConsecutiveCalls('return_1', 'return_2', 'return_3')); 
```

如果您不需要指定输入参数

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-01-20T12:34:38.633

如果有人在没有查看 phpunit 文档中的[相应部分](https://phpunit.de/manual/current/en/test-doubles.html#test-doubles.mock-objects)的情况下发现了这一点，您可以使用**withConsecutive**方法

```
$mock->expects($this->exactly(3))
     ->method('MyMockedMethod')
     ->withConsecutive(
         [$arg1, $arg2, $arg3....$argNb],
         [arg1b, $arg2b, $arg3b....$argNb],
         [$arg1c, $arg2c, $arg3c....$argNc]
         ...
     ); 
```

唯一的缺点是代码必须按照提供的参数顺序调用**MyMockedMethod**。我还没有找到解决这个问题的方法。

# java - Android，如何从尝试捕获错误中显示对话框？

> ID：10954114
> 
> 赞同：4
> 
> 时间：2012-06-08T18:23:48.643
> 
> 标签：java, android, eclipse, try-catch

在我的应用程序中，我连接到一个网站以从 AsyncTask 开始收集一些信息，使用 try catch，从这里我可以在我的目录日志中显示连接时的错误（如果有），但我一直在尝试显示一个对话框，但运气不佳显示连接失败并带有重新连接或退出选项，请检查我的代码并告诉我我做错了什么或如何完成此操作的想法

```
 //this is our download file asynctask
class DownloadFileAsync extends AsyncTask<String, String, String> {

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        showDialog(DIALOG_DOWNLOAD_PROGRESS);
    }

    @Override
    protected String doInBackground(String... aurl) {

        try {
        String result = "";
                    try {
                        HttpClient httpclient = new DefaultHttpClient();
                        HttpPost httppost = new HttpPost("http://mywebsiteaddress");
                        // httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                        HttpResponse response = httpclient.execute(httppost);
                        HttpEntity entity = response.getEntity();
                        InputStream webs = entity.getContent();
                        // convert response to string
                        try {
                            BufferedReader reader = new BufferedReader(
                                    new InputStreamReader(webs, "iso-8859-1"), 8);
                            StringBuilder sb = new StringBuilder();
                            String line = null;
                            while ((line = reader.readLine()) != null) {
                                sb.append(line + "\n");
                            }
                            webs.close();

                            result = sb.toString();
                        } catch (Exception e) {
                            Log.e("log_tag", "Error converting result " + e.toString());
                        }
                    } catch (Exception e) {
                        Log.e("log_tag", "Error in http connection " + e.toString());
                    }

                    // parse json data
                    try {
                        JSONArray jArray = new JSONArray(result);
                        for (int i = 0; i < jArray.length(); i++) {
                            JSONObject json_data = jArray.getJSONObject(i);
                            webResult resultRow = new webResult();
                            //infotodownload
                            arrayOfWebData.add(resultRow);

                        }
                    } catch (JSONException e) {
                        Log.e("log_tag", "Error parsing data " + e.toString());
                    }
    } catch (Exception e) {
        // this is the line of code that sends a real error message to the
        // log
        Log.e("ERROR", "ERROR IN CODE: " + e.toString());
        // this is the line that prints out the location in
        // the code where the error occurred.
        e.printStackTrace();
    }
        return null;
    }

    protected void onProgressUpdate(String... progress) {
         Log.d(LOG_TAG,progress[0]);
         mProgressDialog.setProgress(Integer.parseInt(progress[0]));
    }

    @Override
    protected void onPostExecute(String unused) {
        //dismiss the dialog after the file was downloaded
        dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
    }

}

//our progress bar settings
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
        case DIALOG_DOWNLOAD_PROGRESS: //we set this to 0
            mProgressDialog = new ProgressDialog(this);
            mProgressDialog.setTitle("Conectando al Servidor");
            mProgressDialog.setMessage("Cargando informacion...");
            mProgressDialog.setIndeterminate(false);
            mProgressDialog.setMax(100);
            mProgressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            mProgressDialog.setCancelable(true);
            mProgressDialog.show();
            return mProgressDialog;
        default:
            return null;
    }
} 
```

编辑：然后我尝试添加 Arun 建议的下一个代码

```
 catch (Exception e) {
        // this is the line of code that sends a real error message to the
        // log
        Log.e("ERROR", "ERROR IN CODE: " + e.toString());
        // this is the line that prints out the location in
        // the code where the error occurred.
        e.printStackTrace();
        return "ERROR_IN_CODE";
    }
       return null;       // if I place here return "ERROR_IN_CODE" it calls the dialog but it gets always called so I don't need it here
    }

    @Override
    protected void onPostExecute(String unused) {
        //dismiss the dialog after the file was downloaded
        dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
        if(unused.equals("ERROR_IN_CODE")){                 //I get a system crash here!
            errornote();
        }
    }

}

public void errornote() {
    AlertDialog.Builder alt_bld = new AlertDialog.Builder(this);
    alt_bld.setMessage("No se a podido descargar la informacion de los medios, deseas reintentarlo, o salir?").setCancelable(false)
            .setPositiveButton("Conectar de Nuevo", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    new DownloadFileAsync().execute();
                }
            })
            .setNegativeButton("Salir", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    // Action for 'NO' Button
                    finish();
                }
            });
    AlertDialog alert = alt_bld.create();
    // Title for AlertDialog
    alert.setTitle("Error en la Conexion!");
    // Icon for AlertDialog
    alert.setIcon(android.R.drawable.ic_dialog_alert);
    alert.show();
} 
```

但也不起作用，我的应用程序在 onPostExecute 的 if 语句行中崩溃。我仍然需要帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:29:41.527

尝试调用您的活动 runOnUiThread() 方法

```
activity.runOnUiThread(new Runnable() {
        public void run() {
            //your alert dialog builder here
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:34:47.720

由于您`protected String doInBackground(String... aurl)`要从 catch 块中返回一些自定义错误字符串并在`protected void onPostExecute(String unused)`. 检查返回的字符串对象是否是自定义错误字符串并显示对话框，`protected void onPostExecute(String unused)`但仅在关闭 progressDialog 之后，即在此行之后`dismissDialog(DIALOG_DOWNLOAD_PROGRESS);`显示错误对话框。

**编辑**

当控件进入 Catch 块时，返回一些简单的字符串，例如您使用的“ERROR_IN_CODE”。

```
catch (Exception e) {
    // this is the line of code that sends a real error message to the
    // log
    Log.e("ERROR", "ERROR IN CODE: " + e.toString());
    // this is the line that prints out the location in
    // the code where the error occurred.
    e.printStackTrace();

    return "ERROR_IN_CODE";
} 
```

并`onPostExecute(String unused)`检查以下内容

```
protected void onPostExecute(String unused) {
    //dismiss the dialog after the file was downloaded
    dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
    if(unused != null && unused.equals("ERROR_IN_CODE")){
        showDialog(SOME_DIALOG_TO_SHOW_ERROR);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:31:04.827

您没有使用`builder`创建 AlertDialog 删除该行`builder.show()`并添加

```
AlertDialog alert = builder.create();
alert.show(); 
```

我还建议通过asyc 任务的`progressUpdate()`or`preExecute()`和 'postExecute()' 进行 UI 更新。

执行

```
@ReactMethod
    public void showCustomAlert(String msg){

        final String message = msg;

        this.reactContext.runOnUiQueueThread(new Runnable() {
            @Override
            public void run() {
                AlertDialog.Builder myDialogBox = new AlertDialog.Builder(reactContext.getCurrentActivity());
                myDialogBox.setTitle(Html.fromHtml("<font color='#0037FF'>Konnect</font>"));
                myDialogBox.setMessage(message);
                myDialogBox.setCancelable(true);
                myDialogBox.setPositiveButton("Ok", new DialogInterface.OnClickListener(){

                    public void onClick(DialogInterface dialog, int whichButton) {
                            dialog.dismiss();
                    }

                });
                AlertDialog alertDialog = myDialogBox.create();
                if (Build.VERSION.SDK_INT <= 23) {
                    alertDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_SYSTEM_ALERT);
                }else if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
                    alertDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY);
                }else {
                    alertDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_PHONE);
                }

                alertDialog.show();

                WindowManager.LayoutParams wmlp = alertDialog.getWindow().getAttributes();
                wmlp.gravity = Gravity.TOP | Gravity.LEFT;
                wmlp.x = 25;   //x position
                wmlp.y = 450;   //y position
                wmlp.height = 380;
                alertDialog.show();
                alertDialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.WHITE));
            }
        });
    } 
```

# django - Django：覆盖的 __hash__ 不适用于数据库中的对象？

> ID：10954115
> 
> 赞同：0
> 
> 时间：2012-06-08T18:23:51.193
> 
> 标签：django

我有一个 django 模型对象的问题，我已经覆盖`__hash__`了 () 一些稍微复杂的唯一性/独特性约束，我想在使用它们时强制执行这些约束。这适用于我刚刚在内存中直接实例化的对象，但不适用于我从数据库中检索的对象。

像这样：

```
class Animal(models.Model):
    name = model.Charfield('name', max_length=10)

    def__hash__(self):
        return len(self.name) # silly example for purposes of illustration 
```

然后这个：

```
>> a = models.Animal(name='cat')
>> b = models.Animal(name='dog')
>> len(set((a,b))
> 1
>> a.save()
>> b.save()
>> len(set(models.Animal.objects.all()))
> 2 
```

唔。无论这里使用什么散列函数，它都不是我的。我想这与尚未完全实例化状态的延迟获取/对象有关，但是如何绕过它呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:24:42.587

这是因为您已经实施`__hash__`而没有实施`__eq__`. 实施`__eq__`以及你应该很高兴。

的长度`set([a, b])`是`1`因为 Django 定义了一个默认`__eq__`函数来比较对象的主键 - 所以在保存它们之前，两者都有一个`id`of `None`，所以`a == b`将是`True`。保存后，它们都将被分配不同的主键，`a != b`因此`True`.

# php - PHP & JSON - 回调函数

> ID：10954124
> 
> 赞同：1
> 
> 时间：2012-06-08T18:24:17.637
> 
> 标签：php, jquery, ajax, arrays, json

我是 JS 新手……我有一个带有 JavaScript 函数的 PHP 页面，它可以对数据库服务器进行 JSON 调用。该 JSON 函数返回一个数组，我需要对其进行解析和处理。我理解回调的必要性（目前得到未定义的错误），但对实际语法感到困惑。任何人都可以提供一些指导吗？

这是我在 PHP 页面中的 JSON 函数：

```
var GETDATA = function() 
  {
   $(document).ready(function()
   {
     $.getJSON('api.php', function(data) 
      {
     $.each(data, function(key, val) 
      {
        UpdateGraph(val.x, val.y, val.z);
      });
      });
   });
  };` 
```

**UpdateGraph 函数接受变量并执行一些进一步的业务逻辑

api.php 页面连接到数据库，获取记录集，并将其放入 JSON 数组。最后一行是

```
echo json_encode($arr); 
```

我理解这种不对称流程，并且我需要一个回调函数来在收到数据时触发......但我不知道如何实现这一点。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:29:27.157

首先，**JSON**是一种格式，而不是一种语言。

你已经有回调

```
$.getJSON('api.php', function(data) 
```

**function(data)** 是你的回调，data 是你从 php 返回的数据，在其中你应该添加你的代码或者你想对数据做什么。

```
 $.each(data, function(key, val){
        UpdateGraph(val.x, val.y, val.z);
 }); 
```

**$.each**将循环遍历您的**数据**数组并调用**UpdateGraph**函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T08:35:34.190

您返回的 json 对象（数据）还应该与“数据”内的每个嵌套对象具有键值关系。用一个简单的短语...将 json 对象视为具有键/值的哈希映射

所以说我有两个对象：“数据”内的对象a和对象b

```
 $.each(data.a, function(key, val){
        UpdateGraph(val.x, val.y, val.z);
 });

 $.each(data.b, function(key, val){
        UpdateGraph(val.x, val.y, val.z);
 }); 
```

有效

# c# - 表格更改后gridview不更新

> ID：10954128
> 
> 赞同：1
> 
> 时间：2012-06-08T18:24:25.157
> 
> 标签：c#, .net, visual-studio-2010, gridview, oracle11g

下面的代码是我为在单击按钮时使用 oracle 数据库中的值填充网格视图而编写的。我面临的问题是，当我手动从“sqlplus”中删除表中的行然后单击按钮时，它仍然显示我之前输入的值而不是空网格。我对 gridview 很陌生，所以请帮帮我

```
protected void Button1_Click(object sender, EventArgs e)
{
    string v =System.Configuration.ConfigurationManager.ConnectionStrings["harish"].ConnectionString;
    con = new OracleConnection(v);
    con.Open(); 
    cmd = new OracleCommand("select *  from leave_module1 order by name", con);
    dr = cmd.ExecuteReader();

    GridView1.DataSource=dr;
    GridView1.DataBind();
    con.Close();
    dr.Close();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:38:17.130

删除 sqlplus 中的行后，必须触发提交。

如果您删除并运行选择，您将不会在该会话中看到任何行。但是您的行还没有真正删除。

只有在您要求 sqlplus 提交更改后，它们才会从实际表中删除。

这是必需的，因为默认情况下 oracle 不会自动提交。

# c# - 如何将锯齿状双精度数组转换为字符串并再次返回？

> ID：10954142
> 
> 赞同：0
> 
> 时间：2012-06-08T18:25:02.317
> 
> 标签：c#, multidimensional-array

我有一个参差不齐的双精度数组，我需要将其转换为可以添加到 xml 文档中的内容，然后再转回参差不齐的数组。有人知道这样做的方法吗？提前致谢。

```
 public double[][] Coordinates { get; set; }

 //For context this is how I'm creating the array

 //convert the geography column back in lat\long points
 for (var g = 1; g <= geography.STNumGeometries(); g++)
 {
     var geo = geography.STGeometryN(g);
     var points = new List<double[]>();
     for (var i = 1; i <= geo.STNumPoints(); i++)
     {
         var point = new double[2];
         var sp = geography.STPointN(i);
         // we can safely round the lat/long to 5 decimal places 
         // as thats 1.11m at equator, reduces data transfered to client
         point[0] = Math.Round((double) sp.Lat, 5);
         point[1] = Math.Round((double) sp.Long, 5);
         points.Add(point);
     }

     transitLineSegment.Coordinates = points.ToArray();
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:52:04.620

linq 的力量（根据评论中的建议修改代码）

```
var doubleAR = new List<List<Double>>()
{
   new List<double>(){ 12.5, 12.6, 12.7 },
   new List<double>(){ .06 },
   new List<double>(){ 1.0, 2.0 }
};

   var asXml = new XElement("Data",
                            doubleAR.Select(sList => new XElement("Doubles", sList.Select (sl => new XElement("Double", sl) )))
                           );

    Console.WriteLine ( asXml );
/* Output
<Data>
  <Doubles>
    <Double>12.5</Double>
    <Double>12.6</Double>
    <Double>12.7</Double>
  </Doubles>
  <Doubles>
    <Double>0.06</Double>
  </Doubles>
  <Doubles>
    <Double>1</Double>
    <Double>2</Double>
  </Doubles>
</Data> */

// Then back
   List<List<Double>> asDoubleArray =
         XDocument.Parse( asXml.ToString() )
                  .Descendants("Doubles")
                  .Select (eDL => eDL.Descendants("Double")
                                     .Select (dl => (double) dl))
                                      .ToList())
                  .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:40:51.400

您需要序列化对象以将其存储为字符串。这是一个例子：http: [//support.microsoft.com/kb/815813](http://support.microsoft.com/kb/815813)

# jquery - Coffeescript 中的 VIM 快捷键

> ID：10954145
> 
> 赞同：1
> 
> 时间：2012-06-08T18:25:25.427
> 
> 标签：jquery, coffeescript

我正在尝试构建一个应用程序，以便当您按“i”时进入插入模式。这很棒并且有效，但是它当前将字符“i”插入到文本字段中。以下是我已经尝试过但失败的方法

```
 $("body").keypress (e) ->
      if e.which == 105
        $("#_messages_content").focus()

  $("body").keypress (e) ->
      if e.which == 105
        $("#_messages_content").focus() && $("#_messages_content").val(" ") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:44:06.827

你需要防止一些动作：如果输入已经有焦点，你不需要再跳转到那里。否则，您希望将焦点设置为输入，但要阻止默认行为，即插入“i”。

```
$('body').keypress (e) ->
  if e.which is 105
    $('#_messages_content').focus()
    e.preventDefault()   # Don't insert the "i"

$('#_messages_content').keypress (e) ->
  e.stopPropagation()​​​​​​​​​​​​​​​​​​​​​    # User is typing, don't propagate the event 
```

[http://jsfiddle.net/whXmj/](http://jsfiddle.net/whXmj/)

* * *

如果您想允许在所有文本字段中输入，则可能更容易不停止按键事件的传播，而是检查事件的来源。

```
$('body').keypress (e) ->
  if e.which is 105 and e.target.nodeName.toUpperCase() is 'BODY'
    $('#_messages_content').focus()
    e.preventDefault()​​​​​​​​​​ 
```

[http://jsfiddle.net/whXmj/1/](http://jsfiddle.net/whXmj/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T10:56:07.313

我认为您需要使用该`keydown`事件，因为在`keypress`处理字符后触发（[keydown、keypress、keyup](http://www.quirksmode.org/dom/events/keys.html)）。

所以，也许是这样的：

```
$("body").keydown (e) ->
    if e.which == 105
        e.preventDefault()
        $("#_messages_content").focus() 
```

# javascript - HTML5 Canvas Tileset 绘图

> ID：10954147
> 
> 赞同：3
> 
> 时间：2012-06-08T18:25:41.057
> 
> 标签：javascript, html, canvas

像我这样的东西有tileset - [http://flashpunk.net/img/tut/swordguy.png](http://flashpunk.net/img/tut/swordguy.png)

我的绘图代码是 - [http://jsfiddle.net/WnjB6/](http://jsfiddle.net/WnjB6/)

但是如何做类似的事情 - drawTile(x, y, tile, width, height);

现在需要在 tile 上设置 tileX 和 tileY，但是如何只设置一个 tile 并从所有 tileset 中设置和绘制 tile？

现在需要 tileX = 3，tileY = 1，但我需要 - tile = 8 并绘制相同的图块。'http://flashpunk.net/img/tut/swordguyframes.png

如何做类似的事情？

感谢您的帮助，并为我糟糕的英语感到抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T18:40:07.073

你知道一排有 6 个瓷砖，所以你可以这样做：

```
var drawTile = function(x, y, tile, width, height) {
    context.drawImage(image, (tile % 6) * width, Math.floor(tile / 6) * height, width, height, x, y, width, height);
}; 
```

所以传入`6`将进入第二行的第一个图块，依此类推。

这是一个示例，它循环遍历所有图块：

[http://jsfiddle.net/Jrjyq/](http://jsfiddle.net/Jrjyq/)

# java - 完成游戏循环并转到另一个活动 Android 2.1

> ID：10954150
> 
> 赞同：2
> 
> 时间：2012-06-08T18:25:48.853
> 
> 标签：java, android, multithreading, android-intent, android-activity

请帮我回答这个挑战。我一直在寻找整个互联网和这个委员会的答案。我不能引用之前在互联网上任何地方发布的任何内容。对于知道自己在 Android 中做什么的人来说，这个问题可能是微不足道的。

基本上我想做的是完成游戏循环并进入结果页面。当游戏到达结束游戏的 if() 时。动画停止，但意图仍在屏幕顶部。

我如何创建意图：

```
package com.droidnova.android.tutorial2d;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.Window;
import android.widget.Button;

public class Menu extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.menu);
    Button btnStart = (Button) findViewById(R.id.btnStart);

 btnStart.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
        Intent intent = new Intent(getApplicationContext(),Tutorial2D.class);
        startActivity(intent);
        finish();
        }});

}
} 
```

我如何创建面板：

```
package com.droidnova.android.tutorial2d;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.Window;
import android.widget.Button;
import android.view.SurfaceHolder;
public class Tutorial2D extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(new Panel(this));
}
@Override
protected
 void onStop(){
    //finish();
    setContentView(R.layout.wynik);
    Intent intent = new Intent(getApplicationContext(),Wynik.class);
    startActivity(intent);
    //getParent();
    super.onStop();
}
protected void onPause(){
finish();
getParent();
super.onPause();
}} 
```

控制板：

```
package com.droidnova.android.tutorial2d;

import java.util.*;
import android.content.Context;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class Panel extends SurfaceView implements SurfaceHolder.Callback {

public static float mWidth;
public static float mHeight;
boolean koniec=false;

public float ostatnix;
public float ostatniy;
public int testx,testy;
public static int c=1;
public int punkty;

public ViewThread mThread;
private ArrayList<Element> mElements = new ArrayList<Element>();
private int mElementNumber = 0;
private Bitmap tlo;

private Paint mPaint = new Paint();

public Panel(Context context) {
    super(context);
    getHolder().addCallback(this);
    mThread = new ViewThread(this);
    mPaint.setColor(Color.WHITE);
    tlo = BitmapFactory.decodeResource(getResources(), R.drawable.tlo);
}

public void doDraw(long elapsed, Canvas canvas) {//rysujemy!!
    if(!koniec){

    canvas.drawBitmap(tlo, 0, 0, null);
    synchronized (mElements) {
        for (Element element : mElements) {
            element.doDraw(canvas);
        }
        }
    }
    else{canvas.drawColor(Color.BLACK);
    //canvas.draw
    };   

    }
//   Element znajdz = mElements.get(0);
//    canvas.drawText("FPS: " + Math.round(1000f / elapsed) + " Elements: " + mElementNumber +"X:  "+znajdz.x1+"Y:   "+znajdz.y1, 10, 10, mPaint);
//    canvas.drawText("Ostatni X:  "+ostatnix+"  Y:   "+ostatniy+" testx: "+testx+" testy: "+testy+" Punkty: "+punkty, 20, 20, mPaint);
//  }

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
    mWidth = width;
    mHeight = height;
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    if (!mThread.isAlive()) {
        //c=0;
        mThread = new ViewThread(this);
        mThread.setRunning(true);
        mThread.start();
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    if (mThread.isAlive()) {

        mThread.setRunning(false);

    }
}

public void addelements(){
    int i;
    for(i=0;i<1;i++){
        mElements.add(new Element(getResources(), (int) 100, (int) 100));
        mElementNumber = mElements.size();
    }
}
public void koniec(){
    int i;
    for(i=0;i<mElements.size();i++){
        Element znajdz = mElements.get(i);
if(znajdz.y1>mHeight*0.9){
koniec=true; 
```

在这里，我需要放置一些代码，当 if() 为真时，这些代码将进入结果屏幕。}

```
 }
}    
@Override
public boolean onTouchEvent(MotionEvent event) {
    synchronized (mElements) {  
 //       mElements.add(new Element(getResources(), (int) event.getX(), (int) event.getY()));
   //     mElementNumber = mElements.size();
ostatnix=(float) event.getX();
ostatniy=(float) event.getY();

int b;
for(b=0;b<mElements.size();b++){
        Element znajdz = mElements.get(b);
        testx=(int) znajdz.x1;testy=(int) znajdz.y1;
        if(znajdz.x1+5<event.getX()&&event.getX()<znajdz.x1+64&&
                znajdz.y1+5<event.getY()&&event.getY()<znajdz.y1+66 
                ){
            punkty++;
            mElements.remove(znajdz);
        }
};
(mElements.to(array));
            //array = list.toArray(EMPTY_STRING_ARRAY);
            mElements.trimToSize(); 
            mElementNumber = mElements.size();
            if(mElements.size()==0){        int i;
                for(i=0;i<c;i++){
                mElements.add(new Element(getResources(), (int) i, (int) i));
                mElementNumber = mElements.size();
                }
            c++;    
            }
    };

    }
    return super.onTouchEvent(event);
}

public void animate(long elapsedTime) {
    synchronized (mElements) {
        for (Element element : mElements) {
            element.animate(elapsedTime);
        }
    }
}
} 
```

我不想在这里问，但由于我对该主题缺乏了解并且无法找到答案，我被迫:(请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:36:08.680

见[`startActivity`](http://developer.android.com/reference/android/app/Activity.html#startActivity%28android.content.Intent%29)：

```
startActivity(new Intent(context, ResultsActivity.class)); 
```

确保将结果 Activity 声明到`AndroidManifest.xml`文件中。

# wpf - 将 DataTemplate 的父级可见性（IsVisible 或 Visibility）绑定到 ViewModel

> ID：10954158
> 
> 赞同：0
> 
> 时间：2012-06-08T18:26:27.473
> 
> 标签：wpf, data-binding, mvvm, datatemplate

从经典数据模板开始：

```
<DataTemplate x:Key="RegularTemplate">

   <Grid>
     ...
   </Grid>

</DataTemplate> 
```

假设使用上述模板呈现的 ViewModel 对象具有以下属性：

```
 private Visibility _Visibility;
    public Visibility VMVisibility
    {
        set
        {
            if (value == _Visibility) return;
            _Visibility = value;
            if (value == System.Windows.Visibility.Visible)
            {
                ViewRefresher.TwentySecondsTick += Tick;
            }
            else
            {
                ViewRefresher.TwentySecondsTick -= Tick;
            }
        }

        private get
        {
            return _Visibility;
        }
    } 
```

我希望该 setter 代码在包含它的面板未呈现 listboxitem 时以某种方式运行。这是一个自定义面板，在滚动过程中隐藏/显示项目，所以我只需要以某种方式绑定到列表框项目的可见性。

我已经尝试过以下内容：

```
<DataTemplate x:Key="RegularTemplate">

    <Grid>
     ...
    </Grid>

    <DataTrigger Binding="{Binding IsVisible,RelativeSource=
                      {RelativeSource FindAncestor,  
                      AncestorType={x:Type ListBoxItem}}}" Value="False">
         <Setter  Property="{Binding VMVisibility}" Value="False"/>
     </DataTrigger>

</DataTemplate> 
```

但你不能那样使用数据触发器。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:07:48.250

当您花费 2 小时寻找解决方案、放弃、在 stackoverflow 上发帖，却在 5 分钟后找到它时，您不讨厌它吗？

回答：

使用这家伙的行为：[https ://stackoverflow.com/a/3667609/855551](https://stackoverflow.com/a/3667609/855551)

您可以将父级的 isVisible 绑定到您的视图模型：

```
<DataTemplate x:Key="RegularTemplate">

<Grid>
<behaviour:DataPiping.DataPipes>
        <behaviour:DataPipeCollection>
              <behaviour:DataPipe Source="{Binding RelativeSource=
                   {RelativeSource AncestorType={x:Type ListBoxItem}}, 
                         Path=IsVisible}"
                     Target="{Binding Path=Visible, Mode=OneWayToSource}"/>
              </behaviour:DataPipeCollection>
        </behaviour:DataPiping.DataPipes>
 ...
</Grid>

</DataTemplate> 
```

虚拟机对象：

```
 private bool _Visible;
    public bool Visible
    {
        set
        {
            if (value == _Visible) return;
            _Visible = value;
            if (value == true)
                EnableRefresh();
            else
                DisableRefresh();
        }

        private get
        {
            return _Visible;
        }
    } 
```

# iframe - 如何使用jsoup从多个iframe中提取数据并将其写入一个xml文件

> ID：10954162
> 
> 赞同：1
> 
> 时间：2012-06-08T18:26:41.803
> 
> 标签：iframe, jsoup

我正在使用 jsoup 从 html 页面中提取数据。如果页面只有一个 iframe，我可以提取数据。但是，如果页面有可以打开另一个 iframe 的链接，我如何从第二个 iframe 中提取数据并将所有数据写入一个 xml 文件。请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:28:19.687

一种方法是解析父网站的 iframe 标签并提取“src”。“src”值可用于下载每个 iframe 内容并对其进行解析，如果确实有必要也将它们组合起来。

```
 String url = "http://example.com/";
    Document document = Jsoup.connect("url").get();

Elements es = document.select("iframe"); 

String[] iframesrc;
int iframeCount = es.size();
iframesrc = new String [iframeCount];
//extract iFrame sources:
int i=0;
for(Element e : es)
{
    iframesrc[i] = e.getElementsByTag("iframe").attr("src"); 
    i++;
}

//get iFrame content
Document [] iframeDoc;
iframeDoc = new Document[iframeCount];
int j = 0;
for (String s : iframesrc){
    iframeDoc[j] = Jsoup.connect("url"+iframesrc[j]).get(); //pay attention that the correct url is built at this point!!!
j++;
}

/*now you got the parent site as well as the iframe "childs" as documents. I've no experience in combining Documents. If nothing works you may try document.tostring()*/ 
```

要将文档写入文件，我使用以下代码：

```
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;

import org.jsoup.nodes.Document;

public class Write2File {
     public static void saveFile(Document xmlContent, String saveLocation) throws IOException {
         FileWriter fileWriter = new FileWriter(saveLocation);
         BufferedWriter bufferedWriter = new BufferedWriter(fileWriter);
         bufferedWriter.write(xmlContent.toString());
         bufferedWriter.close();
         System.out.println("File writing completed.");
     }
} 
```

# java - Java：我们通常不希望向用户显示错误堆栈跟踪中的哪些信息？

> ID：10954166
> 
> 赞同：11
> 
> 时间：2012-06-08T18:26:46.030
> 
> 标签：java, security, stack-trace

我是 java 新手，我不太熟悉错误堆栈跟踪在抛出并随后显示给我的 Web 应用程序的最终用户时使用的格式规则。

我对 Oracle 数据库的体验是错误堆栈包含内部信息，例如模式和过程名称以及行号，这些信息虽然对调试很有用，但我希望防止用户看到这些信息。这是一个例子：

```
java.sql.SQLException : ORA-20011: Error description here
ORA-07894: at "NAME_OF_SCHEMA.PROCEDURE_NAME", line 121
ORA-08932: at line 10 
```

我想向用户显示的字符串是`Error description here`. 我可以使用正则表达式提取这个字符串，因为我知道（1）这个字符串总是在第一行，所以我可以提取错误堆栈跟踪的第一行，并且（2）这个字符串总是以结尾开头`Error`和结尾的线。[Oracle 用户注意事项（我不想误导您）：上述内容仅适用于使用带有以 开头的错误字符串的 RAISE_APPLICATION_ERROR 时`Error`，否则文本`Error`不存在]。

我对 Java 的问题是：

(1) 是否有任何您不希望用户在错误堆栈中看到的潜在敏感信息？如果是这样，是什么？例如，文件路径、服务器名称/IP 等。

(2) Java 错误堆栈跟踪是否有任何格式化规则可以用来提取非敏感信息？或者，其他人如何解决这个问题？

更新 1：

感谢到目前为止的所有回复，他们非常有帮助。尽管许多人评论使用诸如`getUserFriendlyMessage()`将错误映射到有用的用户消息之类的功能，但我想知道是否有人可以扩展此映射。也就是说，对于常见错误（SQL、I/O 等），可以使用什么“可靠”标识符来搜索此错误堆栈以识别发生的错误类型，然后您会推荐什么相应的文本字符串映射到此错误消息以显示给用户？@Adarshr 下面的回复是一个好的开始。例如，

```
Identified Expected   If found in error stack, display this friendly msg to user
-------------------   ----------------------------------------------------------
SQLException          An error occurred accessing the database. Please contact support at support@companyname.com.
IOException           Connection error(?). Please check your internet connection. 
```

假设不需要解决与编译相关的错误，而是关注最终用户在正常使用过程中可能遇到的错误。作为参考，这里是运行时错误消息的列表：http: [//mindprod.com/jgloss/runerrormessages.html#IOEXCEPTION](http://mindprod.com/jgloss/runerrormessages.html#IOEXCEPTION)

或者，是否可以只使用堆栈跟踪的第一行显示给用户？这个链接是我在上面的原始问题中得到的：

[http://www3.ntu.edu.sg/home/ehchua/programming/howto/ErrorMessages.html](http://www3.ntu.edu.sg/home/ehchua/programming/howto/ErrorMessages.html)

例如，如果`Exception`始终使用标识符，则可以简单地提取介于`Exception`第一行和结尾之间的文本。我不知道我们是否可以依靠`Exception`一直在那里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:29:36.487

您不应该向您的用户展示任何这些 gobbledygook。这对他们中的大多数人来说毫无意义，也对你没有帮助。正如您所怀疑的那样，它还暴露了您的实现的内部结构，这些内部结构可能暗示恶意用户可能能够使用的漏洞。

相反，您应该捕获异常、记录它们并向用户显示更易于理解的错误消息。您可以使用`getMessage()`异常来提取消息部分。如果异常没有消息，则显示“没有可用的详细信息”之类的内容。

更新：

我有一些基于问题更新的评论。首先，我会将用户与您系统的任何内部完全隔离，既要善待用户，又要确保安全。（例如，即使知道您正在使用 java.sql 包也可能会向聪明的黑客暗示漏洞。）因此，在向用户显示任何内容时，不要使用异常消息、堆栈跟踪的第一行或类似的东西.

其次，您应该将所有错误从异常级别（它们在您的代码中遇到）映射到对用户而言处于正确抽象级别的消息。执行此操作的正确方法取决于系统的内部结构以及引发异常时用户可能尝试执行的操作。这可能意味着将您的系统结构化为层，以便捕获异常的每一层都将其转换为更高抽象层的异常。Java 异常可以包装另一个异常（原因）。例如：

```
public boolean copyFile(File source, File destination) throws CopyException {
    try {
        // lots of code
        return true;
    } catch (IOException e) {
        throw new CopyException("File copy failed", e);
    }
} 
```

然后可以在 User 类的更高级别上使用它：

```
public boolean shareFile(File source, User otherUser) throws ShareException {
    if (otherUser.hasBlocked(this) {
        throw new ShareException("You cannot share with that user.");
    }
    try {
        return copyFile(source, otherUser.getSharedFileDestination(source));
    } catch (CopyException e) {
        throw new ShareException("Sharing failed due to an internal error", e);
    }
} 
```

（我希望很清楚，上面的代码是为了说明将异常转换为更高级别的抽象的想法，而不是作为您应该在系统中使用的代码的建议。）

您想要处理这样的事情（而不是以某种方式按摩消息和/或堆栈跟踪）的原因是异常（例如带有消息“权限被拒绝”的 IOException）可能对用户意味着完全不同的事情（并且您的系统）在不同的上下文中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T18:31:47.063

不要直接向最终用户显示异常消息/堆栈跟踪。而是尝试使用异常 - 消息映射方法。

例如：

*   `SQLException`- 抱歉，发生数据库错误。请稍后再试
*   `RuntimeException`/ `Exception`- 抱歉，发生错误。请稍后再试

实际上，您可以使其尽可能通用。也许您可以使用自定义错误代码映射。例如，`E0001`for `SQLException`，`E0000`for`Exception`等等，并将其显示给最终用户。当他们最终使用错误代码联系客户服务时，这将很有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T18:31:50.107

您不应向最终用户显示他们无法理解的任何信息，其中包括完整的所有堆栈跟踪。当你捕捉到这样的异常时应该显示的错误应该是这样的，用你的最终用户的语言：

*   我们的计划遇到了暂时的困难。请拨打技术支持热线寻求帮助。

最终用户不会关心程序的内部组织、数据库、堆栈等。他们所知道的是，他们认为应该有效的事情失败了，所以他们正在寻求帮助。

堆栈跟踪用于错误日志：您可以自己保存它们，或通过电子邮件将它们发送给技术支持，但您不想将它们显示给最终用户。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T18:30:58.453

您应该只在您的应用程序处于调试模式时显示堆栈跟踪。在生产模式下，您应该显示通用错误消息（或实现`Exception.getUserFriendlyMessage()`）并记录错误（如果可能，提供日志 ID）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T18:31:08.700

> 我想向用户显示的字符串是`Error description here`.

您可以将`Exception.getMessage()`其用于此目的，但正如 Juan Mendez 建议的那样，考虑实施一种更“用户友好”的错误消息机制，以便向最终用户显示错误。

如果您不希望最终用户在堆栈跟踪中看到您的类、方法和字段的名称，请考虑使用像[Proguard](http://proguard.sourceforge.net/)这样的混淆器。我喜欢在日志文件中打印混淆的堆栈跟踪，然后使用 ReTrace 对它们进行去混淆以进行调试。

> (1) 是否有任何您不希望用户在错误堆栈中看到的潜在敏感信息？如果是这样，是什么？例如，文件路径、服务器名称/IP 等。

我认为这可能取决于抛出的异常。选择是否记录异常是应用程序安全性和能够有效诊断问题之间的权衡，我会根据具体情况进行处理，并在必要时留下评论以解释我记录或不记录它的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T18:37:08.173

用户名和密码显然是您不希望向用户显示的敏感信息。此外，正如您所说，文件系统路径、服务器名称和 IP 地址也应该被隐藏。

该`Exception.getMessage()`方法将只返回抛出异常的消息，而不是整个堆栈跟踪。但看起来在您给出的示例中，第 2 行和第 3 行也是异常消息的一部分，所以这对您没有帮助。

**但是**，向您的用户显示堆栈跟踪并不是*一个好的做法。*它们不仅可以包含敏感信息，而且对于用户来说，它们与克林贡语一样具有可读性。您应该记录所有未捕获的异常，然后向用户显示更用户友好的消息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-12T13:17:45.353

正如其他人所说，您不应该向用户报告堆栈跟踪。其他几个人建议您显示`getMessage()`文本。我建议**不**要这样做。正如[我之前所说](https://stackoverflow.com/q/7320080/545127)：

*   该消息是在引发异常时创建的。因此，它最多只能提供非常低级别的信息，这可能不适合向用户报告。
*   从哲学上讲，在我看来，使用消息与异常的全部意义背道而驰，即将错误处理的检测和启动（`throw`部分）与处理和报告的完成（部分）分开`catch`。使用消息意味着消息必须有利于报告，这将报告的责任转移到应该只负责检测和启动的位置。也就是说，我认为`getMessage()`设计的部分`Throwable`是错误的。
*   消息未本地化。尽管有它的名字，但`getLocalizedMessage()`并不是很好，因为您可能不知道要使用什么语言环境，直到您`catch`出现异常（报告是转到您的英语系统管理员阅读的系统日志，还是在一个窗口中弹出GUI 的法国用户？）。

# r - 以月份为自变量（标签）的 R 回归

> ID：10954167
> 
> 赞同：7
> 
> 时间：2012-06-08T18:26:46.483
> 
> 标签：r

我想知道是否有一种比虚拟编码月份（例如，isJan、isFeb...）更简洁的方法来获得更有意义的自变量名称（在拦截下）。我的数据集比较大，所以这里模拟了一个简单的。

```
#create simulated data set with sales, and date
sales <- rnorm(1000, mean = 1000, sd = 40)
dates <- seq(from = 14610, to = 15609)
data <- cbind(sales, dates)

#regression with months 
model <- lm(sales ~ months(dates))
summary(model) 
```

我希望拦截标签显示它们所指的实际月份......目前我的输出如下所示：

```
 Estimate Std. Error t value Pr(>|t|)    
(Intercept)      999.1934     1.2673 788.432   <2e-16 ***
months(dates).L   -4.9537     4.5689  -1.084   0.2785    
months(dates).Q   -6.4931     4.4211  -1.469   0.1422    
months(dates).C   -5.5078     4.4180  -1.247   0.2128    
months(dates)^4    2.3713     4.4864   0.529   0.5972    
months(dates)^5   -1.7749     4.4605  -0.398   0.6908    
months(dates)^6    1.5774     4.4555   0.354   0.7234    
months(dates)^7  -10.9954     4.4511  -2.470   0.0137 *  
months(dates)^8   -0.9627     4.4032  -0.219   0.8270    
months(dates)^9    1.8847     4.2996   0.438   0.6612    
months(dates)^10  -8.5990     4.1776  -2.058   0.0398 *  
months(dates)^11   7.8436     4.1292   1.900   0.0578 . 
```

提前致谢，--JT

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:56:43.820

The problem you have is that R has created an ordered factor and the contrasts produced for an ordered factor a polynomial contrasts (`.L` is linear, `.Q` is quadratic, `.C` cubic and `.^n` is the n-th order polynomial. It may be better to define the month as a factor, set the first level to January and then fit the model.

If in an English locale, then we can use the `month.name` or `month.abb` constants as follows

```
set.seed(42)
dat <- data.frame(sales = rnorm(1000, mean = 1000, sd = 40),
                  dates = as.Date(seq(from = 14610, to = 15609),
                                  origin = "1970-01-01"))
dat <- transform(dat, month = factor(format(dates, format = "%B"),
                                     levels = month.name)) 
```

This gives

```
> head(dat)
      sales      dates   month
1 1054.8383 2010-01-01 January
2  977.4121 2010-01-02 January
3 1014.5251 2010-01-03 January
4 1025.3145 2010-01-04 January
5 1016.1707 2010-01-05 January
6  995.7550 2010-01-06 January
> with(dat, levels(month))
 [1] "January"   "February"  "March"     "April"     "May"      
 [6] "June"      "July"      "August"    "September" "October"  
[11] "November"  "December" 
```

Note the order of the levels is in a logical rather than alphabetical order. If you are in a none English locale then the output of `"%B"` will be the month names in your local language or convention. You will then need to provide the correct levels as a character vector to the `levels` argument in the code above.

This data set can then be used to fit the model and we get more meaningful coefficient names

```
> mod <- lm(sales ~ month, data = dat)
> summary(mod)

Call:
lm(formula = sales ~ month, data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-140.333  -24.551    0.108   28.102  134.349 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)    1001.7034     4.1567 240.983   <2e-16 ***
monthFebruary    -8.3618     6.0153  -1.390    0.165    
monthMarch       -0.5347     5.8785  -0.091    0.928    
monthApril       -7.5618     5.9273  -1.276    0.202    
monthMay         -2.2961     5.8785  -0.391    0.696    
monthJune         3.5091     5.9273   0.592    0.554    
monthJuly        -4.9975     5.8785  -0.850    0.395    
monthAugust      -0.3558     5.8785  -0.061    0.952    
monthSeptember    3.7597     5.9970   0.627    0.531    
monthOctober     -2.5948     6.5724  -0.395    0.693    
monthNovember   -10.5670     6.6378  -1.592    0.112    
monthDecember    -6.9064     6.5724  -1.051    0.294    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 40.09 on 988 degrees of freedom
Multiple R-squared: 0.01173,    Adjusted R-squared: 0.0007317 
F-statistic: 1.066 on 11 and 988 DF,  p-value: 0.3854 
```

In the above, note that January is the first level so its mean is the `(Intercept)` estimate and the other estimates are deviations from the January mean. An alternative parameterisation of the model is to suppress the intercept:

```
> mod2 <- lm(sales ~ month - 1, data = dat)
> summary(mod2)

Call:
lm(formula = sales ~ month - 1, data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-140.333  -24.551    0.108   28.102  134.349 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
monthJanuary   1001.703      4.157   241.0   <2e-16 ***
monthFebruary   993.342      4.348   228.5   <2e-16 ***
monthMarch     1001.169      4.157   240.9   <2e-16 ***
monthApril      994.142      4.225   235.3   <2e-16 ***
monthMay        999.407      4.157   240.4   <2e-16 ***
monthJune      1005.213      4.225   237.9   <2e-16 ***
monthJuly       996.706      4.157   239.8   <2e-16 ***
monthAugust    1001.348      4.157   240.9   <2e-16 ***
monthSeptember 1005.463      4.323   232.6   <2e-16 ***
monthOctober    999.109      5.091   196.3   <2e-16 ***
monthNovember   991.136      5.175   191.5   <2e-16 ***
monthDecember   994.797      5.091   195.4   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 40.09 on 988 degrees of freedom
Multiple R-squared: 0.9984, Adjusted R-squared: 0.9984 
F-statistic: 5.175e+04 on 12 and 988 DF,  p-value: < 2.2e-16 
```

Now the Estimates are of the monthly means and the t-tests are of the hypothesis that the individual monthly means are zero (0).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:45:06.603

创建一个作为因子的月份变量，R 将自动创建漂亮的名称。

```
sales <- rnorm(1000, mean = 1000, sd = 40)
dates <- as.Date(seq(from = 14610, to = 15609),origin='1970-01-01')
data <- data.frame(sales, dates)
data$months=as.factor(months(dates))

model <- lm(sales ~ months,data=data)
summary(model) 
```

它会自动选择四月作为对比月份，但您可以使用`contrasts`.

```
Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     1001.3989     4.2880 233.535   <2e-16 ***
monthsAugust       6.8982     6.0150   1.147   0.2517    
monthsDecember    -6.0561     6.7140  -0.902   0.3673    
monthsFebruary    -1.3977     6.1527  -0.227   0.8203    
monthsJanuary     -3.2086     6.0150  -0.533   0.5939    
monthsJuly       -10.0742     6.0150  -1.675   0.0943 .  
monthsJune        -3.3393     6.0641  -0.551   0.5820    
monthsMarch        0.3159     6.0150   0.053   0.9581    
monthsMay         -0.1448     6.0150  -0.024   0.9808    
monthsNovember     3.4901     6.7799   0.515   0.6068    
monthsOctober      3.2082     6.7140   0.478   0.6329    
monthsSeptember   -7.3039     6.1343  -1.191   0.2341 
```

# objective-c - fetchedResultsController 没有正确更新第一行

> ID：10954174
> 
> 赞同：3
> 
> 时间：2012-06-08T18:27:02.660
> 
> 标签：objective-c, ios, uitableview, core-data, nsfetchedresultscontroller

我正在使用实体“客户”和属性“名称”测试一个简单的核心数据项目。我正在使用主从模板的修改版本；Master包含名称的tableview，detail用于输入名称。

在 Master 的 prepareForSegue 中，我将 Details 的 Customer 对象设置如下：

```
...
else if ([segue.identifier isEqualToString:@"Add Customer"]) {
    [[segue destinationViewController] setDelegate:self];
    [[segue destinationViewController] setCust:(Customer *) [NSEntityDescription insertNewObjectForEntityForName:@"Customer"inManagedObjectContext:self.managedObjectContext]];
} 
```

Master的insertNewObject添加了一个通用名称：

```
...
[newManagedObject setValue:sender forKey:@"name"];
... 
```

详细来说，名称是通过委托添加的：

```
- (IBAction)save:(UIBarButtonItem *)sender {
self.cust.name = self.customerName.text;
[self.delegate addNameController:self selectedSave:YES]; 
```

Master的委托方法：

```
- (void)addNameController:(AddNameController *)controller selectedSave:(BOOL)save {
if (!save) {
    [self.managedObjectContext deleteObject:controller.cust];
}
NSError *error = nil;
if (![self.managedObjectContext save:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}
[self dismissViewControllerAnimated:YES completion:nil];} 
```

* * *

这一切都很好，并且 tableview 为所有新名称条目正确更新，**除了**任何条目，排序明智，成为第一个条目。在这种情况下，虽然名称*被*添加到数据库中，但在 tableview 的第一行中放置了一个空白条目。我可以通过点击“编辑”按钮或添加一个新名称来显示该名称，该名称排序在不可见名称之前。

为了解决这个问题，我强制在 Master 中重新加载：

```
- (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];
[self.tableView reloadData];} 
```

这对我来说似乎有点骇人听闻。据我了解，Core Data 将负责正确更新显示以响应任何内容更改。

我的实现方式是否存在问题，或者这是 Core Data 的特质？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:39:14.760

实际上，必须显式更新该表，除非您有一个链接到`NSFetchedResultsController delegate`您执行此操作的位置的方法。（委托方法是`controllerDidChangeContent:`。）

一种更方便和明显的方法是在关闭详细视图时在您的主代理回调中正确执行此操作。这不是“黑客”。

# hibernate - 休眠与多部分所有者类型的一对多关联

> ID：10954176
> 
> 赞同：0
> 
> 时间：2012-06-08T18:27:19.807
> 
> 标签：hibernate

我的应用程序中有几个类：

1.  **个人**，映射到个人表
2.  **公司**，映射到公司表
3.  **地址**，映射到地址表

我想在**Individual**和**Address**之间以及**Company**和**Address**之间建立持续的关联，因为自然地，个人和公司都可以有零个或多个地址。我还想使用 Address 表中的相同列来表示 DB 中的这种关联——一列指的是所有者实体的 ID，另一列表示其类型。所以在 SQL 中，我会做这样的事情来提取 id 为 5 的个人的地址：

```
select * from Address where ref_id = 5 and ref_type = 'Individual' 
```

对于那些想知道我为什么这样做的人，我的动机是双重的：

1.  合并使用相似数据的表/列。
2.  使用更通用的模式来提供领域模型的未来扩展，而不需要 DDL。

所以问题是：如何在 Hibernate 中定义这种关联？我是 Hibernate 的新手，经过几个小时的努力，我找不到解决方法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:27:51.263

使用 xml：

```
<set name="adresses" where="ref_type = 'Individual'">
  ...
</set> 
```

AFAIK 有一个休眠注释来指定集合属性的 where 子句

# mysql - 如何运行一组选择查询？

> ID：10954179
> 
> 赞同：2
> 
> 时间：2012-06-08T18:27:38.250
> 
> 标签：mysql, sql

我有这个查询

```
SELECT 'GRANT SELECT ON ' + TABLE_NAME + ' TO '+ @UserName
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE' AND 
TABLE_NAME LIKE 'aspnet%' 
```

结果如下：

```
GRANT SELECT ON aspnet_Applications TO user04
GRANT SELECT ON aspnet_Membership TO user04
GRANT SELECT ON aspnet_Paths TO user04
GRANT SELECT ON aspnet_PersonalizationAllUsers TO user04
GRANT SELECT ON aspnet_PersonalizationPerUser TO user04
GRANT SELECT ON aspnet_Profile TO user04
GRANT SELECT ON aspnet_Roles TO user04
GRANT SELECT ON aspnet_SchemaVersions TO user04 
```

我想在这个结果中运行所有的选择查询。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:48:06.917

```
DECLARE @Sql NVARCHAR(MAX)
SET @Sql = ''

SELECT @Sql = @Sql + 'GRANT SELECT ON ' + TABLE_NAME + ' TO '+ @UserName + '
' -- Newline to keep statements from being just one long line.
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE' AND 
TABLE_NAME LIKE 'aspnet%'

-- Print it first to double-check that it looks right before running.
PRINT @Sql

-- After you've validated it with print, run it.
EXEC sp_executeSql @Sql 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T03:48:59.507

我解决了，记得在 GRANT 之前有一个空间。

```
 DECLARE @Sql NVARCHAR(MAX)
SET @Sql = ''
SELECT @Sql =@Sql + ' GRANT SELECT ON ' + TABLE_NAME + ' TO '+ @UserName +''
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE' AND 
TABLE_NAME LIKE 'aspnet%'
PRINT @Sql
EXEC sp_executeSql @Sql 
```

# php - 如何使用 php 从 iframe 中获取 dom 元素

> ID：10954180
> 
> 赞同：1
> 
> 时间：2012-06-08T18:27:38.673
> 
> 标签：php, dom, simple-html-dom

我正在使用 php 和 simple_html_dom 库。我的网站上有一个页面加载 iframe，当在旁边的框中选择某些字段时，iframe 会更改内容。我想找到一个 dom 元素，特别是在我的网站页面加载时最初不在 iframe 中的表单内的文本字段。做这个的最好方式是什么？我试过了

```
$page->find("form[name='partSpecifications'] h5 text",0)->style = "width:200px;" ; 
```

但它似乎不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:32:38.650

与 iframe 中的后加载内容进行交互的唯一方法应该是使用 javascript，但由于安全策略，您不能这样做。指[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:34:41.620

在 php 脚本执行结束后加载内容时，您不能使用 PHP 和 simple_html_dom。您可以在页面加载到 iframe 之前卷曲到页面并以这种方式获取内容，但是按照您描述设置的方式，这并不是一个真正的选择。否则，Javascript 将是与 iframe 内容交互的最佳方式。

# html - 表格列的 HTML 文本显示限制

> ID：10954188
> 
> 赞同：4
> 
> 时间：2012-06-08T18:28:17.957
> 
> 标签：html, css

我有一个宽度为 200 像素的表格。

它有 2 列：

1.  标题（简单的文本、链接、...）
2.  徽标（图片）

**问题是**：当 Title + Logo 超过 200px 我只需要限制**Title**。

```
------------------------
|Title      |Logo      |
------------------------
|Helloooo...|img       |
------------------------ 
```

**仅限制**HTML 和 CSS

我尝试不同的想法：

```
overflow: hidden; 
text-overflow: ellipsis; 
white-space: nowrap;
table-layout:fixed;
... 
```

我得到的唯一结果是：

```
------------------------
|Title      |Logo      |
------------------------
|Helloooooooooooo|img       | -> more than 200px
------------------------ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-15T05:58:02.613

/*编写 CSS 代码如下*/

.appadd {

```
white-space: nowrap;
overflow: hidden;
width: 180px;
height: 30px;
text-overflow: ellipsis; 
```

}

[现场演示 - 转到此链接](http://jsfiddle.net/chathuramadhusanka/aNHa6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:33:33.700

您可以使用**CSS** `word-wrap`来拆分那些非常大的单词：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/ySJGC/)示例！

```
.title {
    width: 100px;            /* adjust the value to fit your needs */
    word-wrap: break-word;
    display: inline-block;
} 
```

**笔记：**

*   由于自动换行需要一些块级元素，因此您至少需要设置`TD`with `display:inline-block`。
*   由于`word-wrap`当她溢出包装器时会破坏单词，因此您需要为`TD`.

* * *

[您可以在 MDN](https://developer.mozilla.org/en/CSS/word-wrap#AutoCompatibilityTable)上查看浏览器兼容性表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:34:18.460

我相信这不适用于 HTML 和 CSS，如果您想在客户端执行此操作，您可以使用 javascript，获取标题单元格的宽度，然后相应地修剪文本，为此您可以使用[Substring 函数](http://www.w3schools.com/jsref/jsref_substring.asp)，虽然你可能想使用像 jQuery 这样的 JavaScript 库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-22T22:19:23.753

CSS 解决方案在某种程度上对我有用，但在浏览器中并不一致。所以，我接受了 Rafael 的建议并使用了 Substring。就我而言， Html.Raw 不是风险。这是我的代码 - 可能不是很优雅但效果很好：

```
 @foreach (var item in Model)
        {
            var exploreText = item.ExploreText;
            var exploreTextShort = "";
            if (exploreText != null)
            {
                if (exploreText.ToString().Length > 15)
                {
                    exploreTextShort = exploreText.ToString().Substring(0, 15);
                }
                else { exploreTextShort = exploreText; }
            }
            <tr>
                <td>
                    @Html.Raw(exploreTextShort)
                </td>
            </tr>
        } 
```

# android - android中的上下文菜单

> ID：10954191
> 
> 赞同：0
> 
> 时间：2012-06-08T18:28:31.523
> 
> 标签：android, menu

我参考了很多文章，但我没有得到“如果任何用户点击手机的菜单按钮，那么它将只显示选项菜单而不是上下文菜单......如果有另一种方式通过点击菜单按钮来显示上下文菜单移动然后建议我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T09:00:27.103

我要关注的链接是您正在寻找的内容： [Android：如何为 MenuButton 设置侦听器？](https://stackoverflow.com/questions/2478418/android-how-can-i-set-a-listener-to-the-menubutton/2478556#2478556)

即通常您不应该覆盖`MENU`用户期望菜单出现的行为，但是您可以使用以下内容：

```
/* 
 * @see android.app.Activity#onKeyDown(int, android.view.KeyEvent)
 */
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ( keyCode == KeyEvent.KEYCODE_MENU ) {
        Log.d(TAG, "MENU pressed");
        // Your context opening code....
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:05:17.607

> 从 Android 3.0（API 级别 11）开始，Android 驱动的设备不再需要提供专用的菜单按钮。

从[文档](http://developer.android.com/guide/topics/ui/menus.html)

因此，虽然我建议不要这样做，但这是解决您的问题的一种方法。

当您想显示 ContextMenu 而不是选项菜单时，请在以下位置添加如下命令`onPrepareOptionsMenu()`：

```
openContextMenu(getCurrentFocus()); 
```

# c# - c# winforms 如何旋转图像（但不是围绕其中心）

> ID：10954192
> 
> 赞同：3
> 
> 时间：2012-06-08T18:28:31.887
> 
> 标签：c#, winforms, image, animation

我正在尝试开发一个我几乎完成的节拍器应用程序。

我剩下的唯一部分是次要视觉效果，它需要我及时前后旋转手臂的图像（想想时钟上的分针）。

如何旋转图像并且不围绕其中心点旋转它。在我正在编写的场景中，我需要能够围绕其底部边框中间的一个点旋转图像。

另外，我希望能够在 n 毫秒内将图像从 X 旋转到 Y，并让它在动画中轻松进出。这对于 C# 来说是否是一座太远的桥梁，是否有任何库可以帮助我实现这种高级类型的物理动画。

非常感谢

担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T21:45:18.420

**扩展回复**

没有*任何闪烁*。ctor 中的 SetStyle 负责这一点。您所看到的“闪烁”是由三个因素造成的伪影：

1.  更新速率仅为 10/秒。尝试将其增加到 20 或 30。
2.  方向值是当然的。它应该基于时间/加速度。那是留给你的练习。
3.  蹩脚的“手”图像具有坚硬的锯齿边缘。无论您更新的速度有多快或动画效果有多流畅，它都会看起来很紧张。再次，进行抗锯齿、混合图形处理留作练习。

更仔细地查看代码。这不是“在表单上绘制”，它是一个自定义控件。看看是怎么`MetronomeControl`派生的`Control`？看看我们是如何通过添加 MetronomeControl 来创建表单的？

**图片框是用来展示静态图片的，不是用来自定义控件的！**

它更新的方式是创建一个计时器。当计时器的 Tick 事件触发时，我们会更新角度和方向，更一般地说，我们会更新控件的状态。对 Invalidate 的调用告诉操作系统，“嘿，我需要重新绘制，方便时给我发送 WM_PAINT 消息！”。我们的 OnPaint 覆盖只是绘制控件的当前状态。

```
using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.Windows.Forms;

class MetronomeControl : Control
{
    private Bitmap hand;
    private float angle = 0;
    private float direction = 2;
    private Timer timer = new Timer { Enabled = true, Interval = 30 };

    public MetronomeControl()
    {
        SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.UserPaint | ControlStyles.Opaque | ControlStyles.AllPaintingInWmPaint, true);
        hand = CreateCrappyHandBitmap();
        timer.Tick += new EventHandler(timer_Tick);
    }

    void timer_Tick(object sender, EventArgs e)
    {
        if (angle < -45 || angle > 45)
            direction = -direction;
        angle += direction;
        Invalidate();
    }

    private static Bitmap CreateCrappyHandBitmap()
    {
        Bitmap bitmap = new Bitmap(100, 300, PixelFormat.Format32bppArgb);
        using (Graphics graphics = Graphics.FromImage(bitmap))
        {
            graphics.Clear(Color.Transparent);
            graphics.FillRectangle(Brushes.LightGray, 50 - 5, 0, 10, 300);
            graphics.FillPolygon(Brushes.LightSlateGray, new Point[] { new Point(50 - 30, 40), new Point(50 + 30, 40), new Point(50 + 20, 80), new Point(50 - 20, 80) });
            graphics.FillEllipse(Brushes.LightSlateGray, 0, 200, 100, 100);
        }
        return bitmap;
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        // Erase background since we specified AllPaintingInWmPaint
        e.Graphics.Clear(Color.AliceBlue);

        e.Graphics.DrawString(Text, Font, Brushes.Black, new RectangleF(0, 0, ClientSize.Width, ClientSize.Height), new StringFormat { Alignment = StringAlignment.Center, LineAlignment = StringAlignment.Center });

        // Move the 0,0 point to the just below the bottom-center of our client area
        e.Graphics.TranslateTransform(ClientSize.Width / 2, ClientSize.Height + 40);
        // Rotate around this new 0,0
        e.Graphics.RotateTransform(angle);
        // Turn on AA to make it a bit less jagged looking
        e.Graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;
        // Draw the image so that the center of the ellipse is at 0,0
        e.Graphics.DrawImage(hand, 0 - hand.Width / 2, 0 - hand.Height + 50);

        // Reset the transform for other drawing
        e.Graphics.ResetTransform();

        base.OnPaint(e);
    }
}

static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form
        {
            Text = "Metronome Control Demo",
            ClientSize = new Size(640, 480),
            Controls =
            {
                new MetronomeControl
                {
                    Location = new Point(10, 10),
                    Size = new Size (340, 300),
                    Font = new Font(FontFamily.GenericSansSerif, 24),
                    Text = "Metronome Control Demo",
                }
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:40:26.173

不是你要求的，而是：

与其每秒多次执行处理器密集型操作，不如考虑翻阅一组静态图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:34:59.387

可能这个示例代码很有用：

```
Graphics x=Graphics.FromImage(m);
x.TranslateTransform(m.Width / 2, m.Height / 2);
x.RotateTransform(30);
SizeF textSize = x.MeasureString("hi", font);
x.DrawString("hi", font, Brushes.Red, -(textSize.Width / 2), -(textSize.Height / 2); 
```

# ruby - 将 HTML 文件转换为 PDF

> ID：10954193
> 
> 赞同：1
> 
> 时间：2012-06-08T18:28:38.110
> 
> 标签：ruby, pdfkit

我正在尝试使用 ruby​​ gem pdfkit 将 html 文件转换为 pdf。我可以创建一个 pdf 文件，但是 pdf 文件中的链接不起作用。有人可以告诉我是否有任何其他工具可以将 html 文件转换为 pdf 或者我们可以使用 pdfkit 修复链接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T07:26:06.620

检查[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)库，已经使用了很长时间......从未遇到任何问题。

# java - 使用 ProcessBuilder 启动 CMD

> ID：10954194
> 
> 赞同：10
> 
> 时间：2012-06-08T18:28:41.807
> 
> 标签：java, cmd, runtime.exec, processbuilder

我正在尝试使用以下代码在 Windows 中启动 CMD 应用程序，但它没有按预期工作。来自不同网站的几个示例表明，“cmd”作为 ProcessBuilder 构造中的参数应该可以工作。

我必须做什么才能让我的 Java 应用程序在 Windows 中打开 CMD 应用程序？

```
 public class JavaTest
 {
     public static void main(String[] args) 
     {
         ProcessBuilder pb = new ProcessBuilder("cmd");

         try 
         {
             pb.start();
             System.out.println("cmd started");
         } 
         catch (IOException e) 
         {
             System.out.println(e.getMessage());
         }  
     }
 } 
```

当我尝试使用一个不存在的应用程序时，它实际上会打印出一个错误，这意味着它实际上运行的是“CMD”。但是 CMD 应用程序没有按预期弹出？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-13T12:47:08.270

要将它与 ProcessBuilder 一起使用，您必须将命令分开，如下所示：

```
final List<String> commands = new ArrayList<String>();                

commands.add("cmd.exe");
commands.add("/C");
commands.add("start");
ProcessBuilder pb = new ProcessBuilder(commands);
pb.start(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-08T18:48:11.900

您需要使用[启动](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/start.mspx?mfr=true)命令。实际上，即使我没有看到弹出新的命令提示符，但您可以`cmd.exe`使用您的`task manager`.

```
ProcessBuilder pb = new ProcessBuilder("cmd.exe", "/C", "start"); 
```

不过，使用 可以实现相同的功能`Runtime.exec()`，这实际上会弹出一个新的命令提示符。

```
Runtime.getRuntime().exec("cmd.exe /C start"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-19T12:20:45.963

**如果您是 Windows，请使用此命令**

```
ProcessBuilder processBuilder = new ProcessBuilder("cmd.exe", "/c", "ping -n 3 google.com"); 
```

# c# - 如何在客户端使用自定义类型对象

> ID：10954198
> 
> 赞同：4
> 
> 时间：2012-06-08T18:28:57.120
> 
> 标签：c#, .net, wcf, web-services, iis

我是 C# 和 WCF 的新手，来自 Java 背景。

我有一个托管在 IIS 上的 WCF 服务的解决方案，它有一个 Employee 类和一个方法......

```
public Employee getEmployee(int loginId) 
```

此方法获取 loginId，查询数据库并使用结果创建一个 Employee 对象，然后返回 Employee 对象。很简单。

所以我有一个客户端，到目前为止，它所做的只是调用一个简单的“Hello World”Web 方法来向我证明它已正确配置为与服务对话。现在我想要一个登录按钮来获取输入的 loginId，调用 getEmployee，并使用返回值创建一个本地 Employee 对象。

所以，我对如何在客户端定义 Employee 类感到困惑？关于如何做如此简单的事情的信息并不多。就像 AXIS2 和 NetBeans for Java 一样，这将是非常简单的，有很多教程来展示如何，但是对于 WCF，似乎每个教程都假设我没有某些知识。

所以下面的帖子说这可以通过在单独的程序集中定义我的 Employee 类来完成，并从 WCF 服务项目和客户端项目中引用 .dll（顺便说一句，两者都在单独的解决方案中）。

[WCF 将自定义对象传递给客户端并运行它的方法](https://stackoverflow.com/questions/7718875/wcf-passing-a-custom-object-to-client-and-running-its-methods)

它说“您可以创建一个合同程序集（一个包含您的瘦域模型（例如 Person 等）的程序集，您可以将自己的逻辑添加到其中。”，但没有解释如何执行此操作或提供任何参考我在哪里可以找到更多信息或说明。

无论如何，我的 Employee 类已经直接在 WCF 服务项目中定义了。如果有人可以提供有关如何将其移至“合同程序集”的任何信息（我是 C# 菜鸟，以前甚至从未创建过 DLL；只是 Windows 窗体项目），那将不胜感激。

另外，我在同一篇文章的另一个答案中看到以下内容......

“1.如果你不能改变dll的来源，并且想调用dll的公共方法，最好使用反射。所以，你从WCF接收对象，设置Person属性返回值，调用方法。”

我理解上面的概念；我会在客户端定义一个单独的 Employee 类，然后以某种方式使用反射从 web 方法返回的对象中获取值，并将它们分配给一个新的 Employee 对象，对吧？只是，我不知道如何使用反射来获取值。

什么是最佳做法？我是否应该像其他帖子所建议的那样定义一个 IEmployee 接口，然后将其放入具有常规 Employee 类的 DLL 中，并从服务器和客户端引用它，并从 web 方法返回 IEmployee 而不是 Employee？如果这是最好的做法，是否有什么特别的事情需要做，或者只要这样的 DLL 在双方都引用，我可以直接做这样的事情吗？

```
int loginId = Int32.Parse(this.loginInputTxt.Text);
LaborService.LaborServiceClient proxy = new LaborService.LaborServiceClient();
Employee emp = (Employee)proxy.getEmployee(loginId); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T21:10:26.130

WCF 支持开箱即用的共享实体。

您需要执行以下步骤：

1.  **将实体类移动到单独`Contract`的类库。**确保 `[DataContract]`和`[DataMember]`属性到位。
2.  **向`Client`和项目**添加对合同项目的引用**`Server`。**
***   **生成服务参考。**检查是否选中了“合同程序集中的重用类型”。为此，单击“添加服务引用”对话框中的“高级...”按钮。*   您的代理类将引用合同项目中描述的类型。**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:41:12.760

当您添加对 WCF 服务的引用时，它将自动在客户端项目中为您创建代理类。它们是在子命名空间中创建的。如果您在解决方案资源管理器中显示所有文件，则可以在 Web 参考下看到它们。**

# asp.net - 使用后面的代码将数据从 ASP.NET 弹出窗口发送到父窗口

> ID：10954200
> 
> 赞同：0
> 
> 时间：2012-06-08T18:29:00.463
> 
> 标签：asp.net

我有一个 ASP.NET 弹出窗口。单击弹出窗口中的按钮后，服务器端会进行一些处理并创建一个复杂对象，然后子窗口关闭。现在在关闭子窗口时，我想在不使用 javascript 的情况下将此复杂对象发送到父窗口。如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:36:36.790

由于您需要主页面和弹出窗口之间的密切交互，您是否要将其保留为单独的页面？更好的解决方案可能是将弹出窗口的控件包含在 asp:Panel 中，并使用[AJAX Modal Popup Extender](http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/ModalPopup/ModalPopup.aspx)将其显示为模式弹出窗口。这样，您可以在单击弹出窗口中的控件时访问主页的所有状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:34:55.010

不要打开弹出窗口来创建这个“复杂对象”。在服务器端创建它，然后在您的响应中呈现它。将回到您原来的窗口。

在执行任务的地方使用 javascipt 没有任何问题。Asp.net 本身使用了大量的 javascript。

# android - SQLite 光标未正确循环 - Android

> ID：10954205
> 
> 赞同：0
> 
> 时间：2012-06-08T18:29:28.450
> 
> 标签：android, sqlite, cursor

这是方法：

```
 public ArrayList<Integer> getDays() {
    Cursor c = database.rawQuery("SELECT * FROM debt;", null);

    nameList = new ArrayList<String>();
    dayList = new ArrayList<Integer>();

    String indName[] = new String[c.getCount()];
    String indDay[] = new String[c.getCount()];

    int d = 0, j = 0, u = 0;

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
        indName[j++] = c.getString(c.getColumnIndex("debt_name")); 
        indDay[d++] = c.getString(c.getColumnIndex("pay_day")); // line 384
    }   

    for (String name : indName) {
        if ((indDay[u] != "") || (indDay[u] != null)) {
            dayList.add(Integer.valueOf(indDay[u++]));

        }
    }
    c.close();

    return dayList;
} 
```

我在第 384 行收到一条错误消息：“无法读取第 0 行，列 -1。确保游标已初始化。”

第 384 行标记在上面。你能找到我在这里想念的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:40:09.433

消除 ; 从您的查询结束：`SELECT * FROM debt`

调用此行：

```
//optional
//"this"  is your DBHELPER class
SQLiteDatabase database = this.getWritableDatabase(); 
```

用这个替换（标记为块）

```
if(c.moveToFirst()){
    while(c.moveToNext()) {
            indName[j++] = c.getString(c.getColumnIndex("debt_name"));
            indDay[d++] = c.getString(c.getColumnIndex("pay_day"));

        }   ( Line 386!!! )

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T23:06:42.450

放 c.moveToNext();

```
for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
        indName[j++] = c.getString(c.getColumnIndex("debt_name")); 
        indDay[d++] = c.getString(c.getColumnIndex("pay_day")); // line 384

    enter code here// c.moveToNext();
    } 
```

# java - 在编译 Java 类并从命令控制台运行 Java 文件时，我将如何包含 Java jar 文件？

> ID：10954207
> 
> 赞同：2
> 
> 时间：2012-06-08T18:29:40.667
> 
> 标签：java, jar, compilation

我有一个与 postgresql 数据库交互的小型 Java 文件，因此我下载了驱动程序并在我的文件中导入了`org.postgresql.Driver`.

在命令控制台中，我键入`javac Myfilename.java`; 然后它编译我运行`java Myfilename`它会抛出一个错误，说它找不到`org.postgresql.Driver`文件。

那么如何在运行文件或编译文件时导入 jar，不确定何时导入？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:35:28.583

编译：

```
javac -cp ".:postresql.jar" -d . MyFileName.java 
```

跑：

```
java -cp ".:postresql.jar" MyFileName 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:32:52.710

您需要在运行时将驱动程序 jar 添加到构建路径中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T18:33:51.953

您需要列出包含的驱动程序的文件路径

```
javac -cp "filepath.jar" MyFileName.java 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T18:35:16.607

您可以设置环境变量`CLASSPATH`并将 jar 附加到此`CLASSPATH`变量，也可以使用`java -cp`或`java -classpath`运行您的代码。

`javac -classpath C:\java\postresql.jar MyClass.java`或者`javac -cp C:\java\postresql.jar MyClass.java`

# java - Java打印在PC上添加裁剪

> ID：10954217
> 
> 赞同：1
> 
> 时间：2012-06-08T18:30:33.987
> 
> 标签：java, windows, printing, applet, high-resolution

几年没有接触过Java，但我被要求编写一些Java代码来打印图片和一些文本几次。它在 Mac 上运行良好，但从 Windows 机器打印时打印出来的内容会被裁剪。图像是他的分辨率，大约 8x10，300DPI。

```
public class printClass implements Printable {

BufferedImage image;
private URL url;

printClass(URL url1) {
    url = url1;
}

public int print(Graphics g, PageFormat pf, int page) throws PrinterException {

    Graphics2D g2d = (Graphics2D) g;
    g2d.translate(pf.getImageableX(), pf.getImageableY());

    AffineTransform theAT = g2d.getTransform();

    double theScaleFactor = (72d / 300d);

    Font font = new Font("Arial", Font.PLAIN, 10);
    Font font2 = new Font("Arial", Font.PLAIN, 5);

    g2d.setFont(font);

    if (page < 10) {
        g2d.scale(theScaleFactor, theScaleFactor);
        g2d.drawRenderedImage(image, null);
        g2d.setTransform(theAT);
        return PAGE_EXISTS;
    } else {
        return NO_SUCH_PAGE;
    }

}public void init() {

    try {
        img = ImageIO.read(url);
        image = (BufferedImage) img;
    } catch (IOException e) {
        System.out.println("Error: " + e);
    }
    PrinterJob job = PrinterJob.getPrinterJob();
    PrinterResolution pr = new PrinterResolution(300, 300, PrinterResolution.DPI);
    PrintRequestAttributeSet attrib = new HashPrintRequestAttributeSet();
    PageFormat pFormat = job.getPageFormat(attrib);
    Paper paper = pFormat.getPaper();
    paper.setImageableArea(0.0,0.0,pFormat.getPaper().getWidth(), pFormat.getPaper().getHeight());
    pFormat.setPaper(paper);

    attrib.add(pr);
    attrib.add(PrintQuality.HIGH);

    job.setPrintable(this);

    boolean ok = job.printDialog();
    if (ok) {
        try {
            job.print(attrib);
        } catch (PrinterException ex) {
        }
    }
}
} 
```

URL 是正在打印的图像。这是 Java 小程序的一部分。此代码中缺少文本添加部分，但如下所示：

```
 g.drawString(markUpText, x, y); 
```

一如既往地提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T19:53:20.167

好的，所以我解决了我自己的问题。我没有将打印格式包含在可打印文件中。

```
 job.setPrintable(this,pFormat); 
```

这会导致 Windows 中的打印质量和位置以及 Mac 中的位置出现其他一些有趣的问题。

我通过从属性中删除 DPI 和 PrintQuality.HIGH 解决了质量问题。

我在 priatble 函数中使用以下代码解决了位置问题：

```
 g2d.translate(pf.getImageableX() + 30, pf.getImageableY()+30); 
```

我还切换到新的 Copies to 属性，让我可以轻松控制他们想要打印的份数。

仍然不确定这是否是解决此问题的最佳方法，但它有效！

# shell - 通过shell删除文件

> ID：10954218
> 
> 赞同：1
> 
> 时间：2012-06-08T18:30:35.660
> 
> 标签：shell, unix

我是 shell 编程的新手。基本上，我编写了一个小脚本，它在执行时会清除该特定文件夹中的某些文件类型：

```
#!/bin/bash
echo "cleaning temp extensions "
find -type f -name '*.pyc' -exec rm -f {} ';' 
find -type f -name '.*.swp' -exec rm -f {} ';'
find -type f -name '*~' -exec rm -f {} ';'
echo "files cleaned!!" 
```

但是现在，我想清除该 shell 脚本所在文件夹中的所有文件。

例如，如果我有类似的东西

```
 folderA/  folderB/ folderC/   clean.sh 
```

当我运行这个 clean.sh 时，它会删除文件夹 A、文件夹 B 和文件夹 C 中的所有文件类型我应该在这个脚本中进行哪些修改？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:40:04.433

您可以将所有 3 个查找命令组合成一个，如下所示：

```
find -type f \( -name '*.pyc' -o -name '.*.swp' -o -name '*~' \) -exec rm -f {} \; 
```

现在要在文件夹A中执行此查找，请使用：

```
find folderA/ -type f \( -name '*.pyc' -o -name '.*.swp' -o -name '*~' \) -exec rm -f {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:41:04.773

目前尚不完全清楚您的要求。

删除当前目录中的所有文件：

```
find . -maxdepth 1 -type -f -delete 
```

要删除当前目录中的所有文件及其下的所有目录：

```
find . -type -f -delete 
```

删除当前目录中的所有文件和目录：

```
find . -delete 
```

如果您真的想删除“存在此 shell 脚本的文件夹中的所有文件”，那真是太疯狂了。为什么要将脚本复制到目录中以删除该目录中的文件？如果您的意思是“我无法删除指定目录中具有指定扩展名的文件”，那么它的工作方式如下：

```
#!/usr/bin/env bash

find "$@" -type f \( -name '*.pyc' -o -name '*.swp' -o -name '*.~' \) -delete 
```

并将其保存到 PATH 中的目录（例如`/usr/local/bin`），然后您可以说：

```
clean.sh folderA folderB folderC 
```

或者你想要的任何其他东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:40:19.187

要删除所有文件，请删除`-name ...`过滤器：

```
find -type f -exec rm -f {} ';' 
```

明显的警告：要小心。

# facebook - facebook喜欢小部件的奇怪行为

> ID：10954219
> 
> 赞同：0
> 
> 时间：2012-06-08T18:30:38.780
> 
> 标签：facebook, facebook-like

我在我的页面中使用 fb，单击它后，小部件看起来像是 clickec 并且计数器按预期显示 1，但在刷新页面后，类似小部件返回到其原始状态 - 未单击且没有类似计数器。当我在 facebook 调试工具中查看该 url 时，它似乎被正确抓取，所以它不是 og: meta 问题，facebook 确实正确识别了这个页面。我试图用 fb link_stat 工具检查它，数据似乎是正确的 -

[https://api.facebook.com/method/fql.query?query=SELECT+url%2C+normalized_url%2C+share_count%2C+like_count%2C+comment_count%2C+total_count%2C+commentsbox_count%2C+comments_fbid% 2C+click_count+FROM+link_stat+WHERE+url%3D%22http://107.21.224.181/recommendation/201%22&access_token=](https://api.facebook.com/method/fql.query?query=SELECT+url%2C+normalized_url%2C+share_count%2C+like_count%2C+comment_count%2C+total_count%2C+commentsbox_count%2C+comments_fbid%2C+click_count+FROM+link_stat+WHERE+url%3D%22http://107.21.224.181/recommendation/201%22&access_token=) {your_access_token}

但类似的小部件仍然没有显示 - [http://www.facebook.com/plugins/like.php?api_key=190673301047799&channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion% 3D6%23cb%3Df1ff56763%26origin%3Dhttp%253A%252F%252F107.21.224.181%252Ff328f6c124%26domain%3D107.21.224.181%26relation%3Dparent.parent&extended_social_context=false&href=21.%24.% 2Frecommendation%2F201&layout=button_count&locale=en_US&node_type=link&sdk=joey&send=false&show_faces=false&width=90](http://www.facebook.com/plugins/like.php?api_key=190673301047799&channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D6%23cb%3Df1ff56763%26origin%3Dhttp%253A%252F%252F107.21.224.181%252Ff328f6c124%26domain%3D107.21.224.181%26relation%3Dparent.parent&extended_social_context=false&href=http%3A%2F%2F107.21.224.181%2Frecommendation%2F201&layout=button_count&locale=en_US&node_type=link&sdk=joey&send=false&show_faces=false&width=90)

这个问题的任何线索或方向？过去我们让那些类似按钮（fbml 版本）工作得很好，但现在似乎一个多月都不能工作。

这就像小部件代码 -

```
<div class="fb-like" data-href="http://107.21.224.181/recommendation/201" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T09:19:16.333

所以问题是根据2个问题：

1.  需要添加 fb:app_id（或 fb:admins）和 og:site_nmae 元标记（根据这篇文章 - [http://www.facebook.com/help/?faq=210086019031867](http://www.facebook.com/help/?faq=210086019031867)）。

2.  我的内页只能对有会话的用户查看，但 facebook 需要在没有会话的情况下访问特定的 url。因此，没有会话的用户现在将被重定向到显示部分信息的外部页面。

# mysql - MySQL NOT IN 查询仅包括我想排除的结果

> ID：10954225
> 
> 赞同：0
> 
> 时间：2012-06-08T18:31:09.140
> 
> 标签：mysql

询问：

```
SELECT * 
from t1
INNER JOIN t2 ON t1.item_id = t2.item_id
WHERE t1.item_id NOT IN
(Select t2.item_id from t2) 
```

基本上，我试图排除 t2 表中带有 item_id 的所有结果，但它只包括 t2 表中带有 item_id 的结果。我在这里想念什么......

感谢您的所有回复！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:35:19.003

我很惊讶您从该查询中得到了任何东西，因为您似乎排除了您通过联接包含的任何内容。尝试将您的查询更改为：

```
SELECT * from t1
WHERE item_id NOT IN (SELECT item_id from t2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:39:36.940

你加入然后排除一切：/

至少这就是sql[在这里所说的](http://sqlfiddle.com/#!3/2a4f8/1)

尝试这样的事情：

```
SELECT 
    item_id
FROM 
    t1
WHERE 
    item_id NOT IN (SELECT item_id from t2) 
```

就像在[这里](http://sqlfiddle.com/#!3/2a4f8/3)一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:44:30.273

这将从 T1 中选择在 T2 中没有相应条目的项目。我想这就是你想要的。

```
SELECT * 
from t1
LEFT JOIN t2 ON t1.item_id = t2.item_id
WHERE t2.item_id IS NULL 
```

# php - PHP AJAX排序数组无需重新加载页面

> ID：10954231
> 
> 赞同：1
> 
> 时间：2012-06-08T18:31:46.043
> 
> 标签：php, jquery, ajax, arrays, sorting

我有以下代码对 XML 文件运行查询并返回结果。然后我使用 usort 对其进行排序。（我的排序功能在单独的页面 sort.php 上）。我现在已经注释掉了 usort，但是 usort 函数可以按预期工作。

```
$xml = simplexml_load_file($url);

//RUN QUERY ON XML
$xQuery = $xml->xpath($query);

//DISPLAY RESULTS OF QUERY

$i = 0;
//usort($xQuery, 'sortMake');
    for ($f = 0; $f <= 9; $f++) {               
        ?>
            <img src= "<?php echo $xQuery[$i]->MainPhoto;?>"><br />
            MAKE:  <?php echo $xQuery[$i]->Make;?><br />
            Model: <?php echo $xQuery[$i]->Model;?><br />
            $i++;

    <?php } ?> 
```

所以上面的代码会显示所有未排序的内容。我想在循环之前有一个排序链接，单击该链接会对数组进行排序并显示它，而无需重新加载整个页面。我知道它可能与 AJAX 有关，但我发现的所有 AJAX 资源都是使用 MySQL 的函数的示例。我没有使用 MySQL。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T20:24:41.557

您可以在页面上对其进行排序，无需 AJAX 或 PHP 排序。您需要稍微修改您的 HTML。将结果放在具有 id 的父元素中。将每个结果放在一个带有类的 div 中。将要排序的数据放在一个类中：

```
<div id="carList">
    <div class="car">
        <img src= "<?php echo $xQuery[$i]->MainPhoto;?>"><br />
        MAKE:  <span class="make"><?php echo $xQuery[$i]->Make;?></span><br />
        Model: <span class="model"><?php echo $xQuery[$i]->Model;?></span><br />
        $i++;
    </div>
    ...
</div> 
```

要对元素进行排序，首先将它们放入`Array`：

```
var listEl = $("#carList");
var cars = listEl.children(".car").get(); 
```

然后调用`.sort()`你的`Array`. 您将创建一个自定义比较函数以传递给`.sort()`：

```
cars.sort(function (a, b) {
    var aMake = $(a).find(".make").text();
    var bMake = $(b).find(".make").text();
    return a - b;
}); 
```

现在，只需将元素附加回父元素：

```
listEl.append(cars); 
```

**演示：http:** [//jsfiddle.net/gilly3/ZNmEh/](http://jsfiddle.net/gilly3/ZNmEh/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:52:51.063

查看[jQuery 的 .get() 函数](http://api.jquery.com/jQuery.get/)。这至少应该让你指出正确的方向。jQuery 是一个 Javascript 库，绝对可以用于您的目的。单独的 Javascript 也可以完成这项任务，但是 jQuery 的目标是通过最小化你必须做的编码量来简化你的生活。您必须下载或引用`<head>`标签中的 jQuery 库。如果您真的想开始使用 jQuery，您绝对应该阅读选择器以及如何使用它们。

**我个人**喜欢 jQuery 并且使用过其他几个库。我发现 jQuery 非常适合初学者，而且在线文档也很棒。它拥有庞大的用户群，可以为您回答任何和所有问题。

基本上，您需要将显示的数据包装在 jQuery 能够找到的标签中，即：

```
<a href='#' id='link'>Sort Data</a>
<div id='xmlData'>...DATA...</div>` 
```

然后有你的脚本：

```
$("#link").click(function(){
    $.get('xmldata.php',function(d){
        $('#xmlData').html(d);
    });
}); 
```

然后有一个标题`xmldata.php`为内容的脚本：

```
$xml = simplexml_load_file($url);

//RUN QUERY ON XML
$xQuery = $xml->xpath($query);

//DISPLAY RESULTS OF QUERY

$i = 0;
usort($xQuery, 'sortMake');
for ($f = 0; $f <= 9; $f++) {               
    ?>
        <img src= "<?php echo $xQuery[$i]->MainPhoto;?>"><br />
        MAKE:  <?php echo $xQuery[$i]->Make;?><br />
        Model: <?php echo $xQuery[$i]->Model;?><br />
        $i++;
<?php } ?> 
```

# java - Java Spring：代理对象可以返回另一个代理对象吗？

> ID：10954234
> 
> 赞同：1
> 
> 时间：2012-06-08T18:31:54.083
> 
> 标签：java, spring, proxy, remoting

我在Java中有这样的情况：

```
interface IService {
    IMyObject getObject();
}

// This class is not serializable...
class NotSerializable implements IMyObject {
    ...
} 
```

我已经设置了 Spring 3.1 远程处理，以便我的客户端获得对 IService 实现的代理引用。此实现在调用 getObject() 时返回不可序列化的对象，这会导致封送处理异常。 **有没有办法让 Spring 自动返回 IMyObject 实现的代理？** 客户端代码如下所示：

```
IService remoteService = ....;            // Get proxied service object from Spring.
IMyObject o = remoteService.getObject();  // Returns a proxied IMyObject
o.someMethod();                           // Runs the method on the proxied object. 
```

谢谢！

# linux - 在mercurial中在哪里设置分支？

> ID：10954235
> 
> 赞同：3
> 
> 时间：2012-06-08T18:31:56.613
> 
> 标签：linux, mercurial, repository, branch, remote-branch

我是 Mercurial 的新手，想就我团队项目的情况在哪里设置分支寻求一些有经验的建议。该项目将由其他 4 名成员共享。

我在本地机器上的目录 /home/Cassie/localRepository/src1 有一个存储库。我的机器 /home/Cassie/localRepository/src2 上还有另一个目录，其中包含大多数常见文件作为 src1 目录，但也有一些不同的文件。例如，在 /home/Cassie/localRepository/src1，有

```
file1 file2 file3 file4 file5 
```

在 /home/Cassie/localRepository/src2，有

```
file1 file2 file3 file4(version2) file5(version 2) 
```

我想让它们成为两个不同的分支并分别处理它们。但是，我仍在继续研究 file1、file2 和 fil3，并希望这两个分支都能随着时间的推移获得更新的 files1、file2、file3。请注意，src1 目录中的 file4 和 file5 与 src2 目录中的文件名称相同。如果我将每个文件都移动到同一目录中，则无法区分哪个版本。这就是为什么我将一个版本的 file4 和 file5 保存在 src1 目录中，并将另一个版本的 file4 和 file5 保存在 scr2 目录中。我在 bitbucket 有一个团队帐户，并将 src1 目录推送到该帐户。因此，bitbucket 将 src1 中的所有文件作为中央存储库。现在，我遇到了在哪里为 src2 设置分支并实现我的目标的问题。

顺便说一句，我的本地机器是 Linux RedHat 工作站 6.2，有 mercurial 1.7 和 tortoisehg 1.5。

我尝试了一些实验：

(1) 我创建了另一个目录 src 作为我的本地存储库。将 file1,2,3 复制到其中，添加并提交它们。

(2) 然后，我将 src1 目录中的 file4 复制到 src 并使其成为一个名为 src1-Branch 的分支，复制并将 file4.txt 添加到 src1-branch 并提交。

(3) 创建了另一个名为 src2-branch 的分支，通过切换到 src2-branch

```
hg update src2-branch 
```

，将file4（version2）从src2目录复制到当前目录

```
 cp ../src2/file4.txt . 
```

，添加了file4并尝试提交file4.txt。但是，我遇到了一条错误消息

```
waiting for lock on working directory of /home/Cassie/src held by 'Cassie-PC:20994' 
```

然后我在网上搜索，人们建议删除 .hg/wlock。有效 ！

任何人都知道为什么问题首先发生？当我将 file4.txt 从 src2 添加到 src2-branch 时，我做错了吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:40:43.263

我认为你可以使用 Mercurial 分支完成你想要的。您可以将对文件的更改单独保存在各个分支中，也可以选择将这些更改合并到其他分支中。在您的 src1 存储库中，创建一个 src2 分支：

```
 > hg branch src2 
```

然后，您可以删除文件 4 和 5 并添加文件 6 和 7：

```
> hg remove file4 file5
> cp ..\src2\file6 .
> cp ..\src2\file7 .
> hg add file6 file7
> hg commit -m "Removing file4 and file5; adding file6 and file7." 
```

然后您使用 Mercurial 的合并命令将更改从一个分支带入另一个分支。从您最初的问题来看，听起来您想将默认（src1）分支的更改带入 src2 分支。在这种情况下，你会：

```
> hg up src2
> hg merge default
> hg commit -m "Merging default -> src2" 
```

合并将所有未合并的更改从源分支带入目标分支。如果您只想进行*一些*更改，如果您使用 Mercurial 2.0 或更高版本，请使用[graft 命令](http://www.selenic.com/mercurial/hg.1.html#graft)，如果使用早期版本，请使用[移植扩展。](http://mercurial.selenic.com/wiki/TransplantExtension)

# pagespeed - 查看 google pagespeed 等级的最佳方法是什么？

> ID：10954236
> 
> 赞同：0
> 
> 时间：2012-06-08T18:31:57.883
> 
> 标签：pagespeed, google-pagespeed

google pagespeed 测试会给出 json 格式的结果，我的问题是有没有好的开源查看器程序来可视化结果？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:33:56.973

PageSpeed 有两个针对 Chrome 和 Firefox 的浏览器扩展，它们运行与在线 API 相同的测试，并且还提供了许多额外的提示和解释：[https ://developers.google.com/speed/pagespeed/insights_extensions](https://developers.google.com/speed/pagespeed/insights_extensions)

两者背后的代码都是开源的，因此您可以根据需要提取这些位。

# haskell - 二维坐标矢量的设计

> ID：10954237
> 
> 赞同：0
> 
> 时间：2012-06-08T18:31:59.630
> 
> 标签：haskell, types

我正在寻找二维坐标矢量的简单表示。我的第一个想法是一个简单的`(c, c)`元组，但这不适合我的需要。

这就是我想要的：

*   Functor 和 Applicative 的实例
*   能够拥有具有相同语义的不同类型（例如`ScreenCoord`和`GameCoord`）。
*   简单的数据构造函数（例如`ScreenCoord c c`）
*   能够编写通用代码`Coord`。

我不确定如何做到这一点。我尝试过的所有事情要么需要复制`instance`代码来获得不同的类型，要么它有很长的数据构造函数`ScreenCoord (Coord c c)`，这似乎是不必要的。

这里的理想代表是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:47:47.380

您可能对[张量](http://hackage.haskell.org/package/Tensor)和[向量空间感兴趣](http://hackage.haskell.org/package/vector-space)

[Vertex2](http://hackage.haskell.org/packages/archive/Tensor/1.0.0.1/doc/html/Data-Tensor.html#t%3aVertex2)和 Vertex 系列中的其他点表示屏幕上的点（不是向量）。[vector-space-opengl提供了适当的](http://hackage.haskell.org/package/vector-space-opengl)[vector-space](http://hackage.haskell.org/package/vector-space)实例。

# .net - 工作流服务指导客户下一步可能的步骤

> ID：10954241
> 
> 赞同：2
> 
> 时间：2012-06-08T18:32:19.233
> 
> 标签：.net, workflow, workflow-foundation-4, workflowservice

工作流服务使用`Receive`活动来使用用户输入。`Workflow`使用 Workflow 中嵌入的业务逻辑从调用者获取数据时做一些工作。这听起来不错，但有一个例外。呼叫者如何知道下一个工作流程步骤应该是什么？

例如我们有文件处理`Workflow`。文档到达系统时会创建新的工作流实例。

创建后，文档可以由不同的经理进行验证，发送附加信息请求，查看，关闭，取消，合并等。可能操作的顺序存储在工作流中。`Receive`操作在工作流之外执行，并通过几个已发布的活动与工作流通信。这些操作的顺序`Receive`在 Workflow 内部（实际上就是 Workflow）。

逻辑可能因部门而异。所以我们不想在我们的工作流程之外对其进行硬编码。

现在文档处理处于以下状态：

1.  执行了以前`Receive`的活动
2.  `Workflow`做了一些工作，现在坚持
3.  `Receive`如果用户执行某些操作并调用下一个活动，则可以唤醒工作流

问题是外部代码如何知道该操作是什么以及`Receive`应该调用哪个端点正在等待？

有什么简单的方法可以询问 Workflow 在 GUI 中使用该信息的后续步骤是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T04:16:15.487

这是 Ron Jacobs 的一篇博客文章，它将引导您完成 WF 4 的扩展注册 - 这将为您提供构建所需内容所需的基础。

[http://blogs.msdn.com/b/rjacobs/archive/2012/05/06/extending-asp-net-mvc-account-registration-with-workflow-wf4.aspx](http://blogs.msdn.com/b/rjacobs/archive/2012/05/06/extending-asp-net-mvc-account-registration-with-workflow-wf4.aspx)

**编辑以更好地解决“了解下一个状态”的问题。**

好的，不会有查询工作流的方法，主要原因是工作流服务在 WSH 上运行，当它遇到新书签时，它处于空闲状态（你永远不知道它真正在哪里运行）。因此，最好的办法是在空闲之前发布该信息，我建议通过回复将其发布给调用者，因为那是 UX 响应的理想时间。

**编辑以提供可能是您正在寻找的“魔法”的链接。**

这是@RonJacobs 在第 9 频道上的一个视频——这个人真的很棒，因为他为开发人员努力工作——我认为这可能是你正在寻找的魔法。但是，它可能需要您更新正在使用的版本，但也可能不需要。如果您还没有，您可能还需要获取 Microsoft.Activities.Extensions NuGet 包。我已经将他的自定义跟踪机制用于单元测试，但不是为了这个。让我知道你发现了什么！

[http://channel9.msdn.com/Shows/Workflow-TV/Workflow-TV-Tracking-StateMachines](http://channel9.msdn.com/Shows/Workflow-TV/Workflow-TV-Tracking-StateMachines)

# c# - Winforms构造函数时间顺序错误？

> ID：10954243
> 
> 赞同：1
> 
> 时间：2012-06-08T18:32:31.647
> 
> 标签：c#, winforms

我有以下 Winforms 层次结构。

```
Form ==> AForm ==> BForm 
```

`int? X;`并且在 中定义了一个可以为空的成员`FormA`。在 中`FormB`，有以下代码。

```
public partial class FormA: Form
{
    public int? X { get; set; }
    public FormA(int? x) { X = x }
....

public partial class FormB: FormA, IFormAView
{
    public FormB()
    {
        AsyncCall(() => 
        {
            int z = X ?? 0;
            System.Diagnostics.Debug.WriteLine("X: " + X.ToString() + " z: " + z.ToString());
            return z;
        }

public static T GetForm<T>(int? x)
{
    T form = new T();
    form.X = x;
    form.Show();
}
GetForm<FormB>(100); 
```

`X`从未被分配为空或零。我正在尝试关闭并打开表单`FormB`。偶尔`z`为零（可能每 10 次）。我设置了一个条件中断，它在`z==0`上线时中断`return z`。

当击中断点时。调试写入

```
 X:  z: 0 
```

即使调试显示 FormA:X 也不为零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:15:24.720

您正在另一个线程上调用代码来测试 X（使用 AsyncCall 和“X ??”），在 FormA 构造函数中分配 X 之前或之后，该代码可能运行也可能不运行。

即如果你停止使用 AsyncCall，你应该得到一致的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:47:17.427

在 FormA 中，X 是一个[Nullable](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=VS.80%29.aspx) int 属性，默认为`null`. 您永远不会`public FormA(int? x)`从构造函数中调用基本构造`public FormB()`函数，因此 X 永远不会被设置为其他任何值。

由于您在调用 FormB 的构造函数（调用 AsyncCall）之后设置 X 的值，因此您将遇到时间问题，因为 AsyncCall 可能会在您`form.X = x;`在 GetForm 函数中设置之前或之后强制执行。

如果你希望你的 AsyncCall 仍然是一个 AsyncCall，你应该更新 FormB() 的构造函数如下：

公共 FormB(int?x) : base(x) { // ...

然后更新 GetForm 如下（注意 where 子句，这让我们知道 T 至少是从 FromA 派生的，所以它有一个接受 int 的构造函数？）：

```
public static T GetForm<T>(int? x) where T : FormA
{
     T form = new T(x);
     form.Show();
} 
```

# mapreduce - HDFS：如何使写入原子化？

> ID：10954245
> 
> 赞同：0
> 
> 时间：2012-06-08T18:32:44.233
> 
> 标签：mapreduce, hdfs

我有一些（奇怪的）用例，需要从多个映射器写入 HDFS 文件（侧 HDFS 文件）。但我不确定在不破坏文件完整性的情况下是否允许这样做。请指教。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:21:31.180

HDFS 本​​身无法满足这种需求。在单个点上仅支持一个活动编写器。

您可以在编写器中使用分布式锁定机制，在每个写入实例处追加和关闭（缓慢但达到您想要的效果），或者单独编写并在最后合并（在分布式环境中更快）。

# powershell - 在 Powershell CSV 导出中识别断开连接的 Exchange 邮箱

> ID：10954246
> 
> 赞同：0
> 
> 时间：2012-06-08T18:32:44.927
> 
> 标签：powershell, csv, exchange-server

我有一个 PS 脚本（见下文），它会给我一个包含项目计数、数据库名称和大小的所有邮箱的列表。但是，我注意到此列表中包含断开连接的邮箱。这完全没问题，但我正在寻找一种方法来标记 CSV 导出中断开连接的邮箱。有人有想法吗？我环顾四周，但没有找到任何东西。谢谢！

```
Get-MailboxDatabase "DB9" | Get-MailboxStatistics | Select DisplayName, TotalItemSize, ItemCount, DatabaseName | Export-CSV d:\mailboxscript\mailboxesizesDB1.csv 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T22:23:36.517

您可以检查 DisconnectDate 是否不等于 null：

获取邮箱数据库“DB9”| Get-MailboxStatistics | 选择 DisplayName, TotalItemSize, ItemCount, DatabaseName,@{n='Disconnected';e={$_.DisconnectDate -ne $null}}| 导出-CSV d:\mailboxscript\mailboxesizesDB1.csv

# android - 在textview中查找字符数

> ID：10954253
> 
> 赞同：3
> 
> 时间：2012-06-08T18:33:01.667
> 
> 标签：android, textview

我`textview`在整个布局中都有一个。我想知道上面可以显示多少个字符`textview`。我知道宽度和高度`textview`以及字体大小现在我只想知道可以显示这个的字符数`textview`。我试过`textview.getText().toString().length()`了，但它返回了我通过字符串传递的字符总数，但它显示的更少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:49:16.617

*虽然 K-ballo 关于固定宽度（和可变宽度）字体的观点很明确，但如果您想知道特定字符串的*多少个字符可以放入 a 中`TextView`，您可以使用类似[`Paint.getTextWidths`](http://developer.android.com/reference/android/graphics/Paint.html#getTextWidths%28java.lang.String,%20float%5B%5D%29). 只要确保在调用它之前设置正确的样式/字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:37:40.640

所以我虽然会有一个很好的解决方案，比如 text.getMaxLength()

但我想没有。您必须使用一些 xml 来为您设置值，以便您知道它是什么。查看这篇文章中的示例代码

[如何在代码中获取 EditText maxLength 设置](https://stackoverflow.com/questions/8069015/how-to-get-edittext-maxlength-setting-in-code)

# c# - 从 DataTable/DataSet 中的搜索创建 DataRow

> ID：10954259
> 
> 赞同：1
> 
> 时间：2012-06-08T18:33:30.917
> 
> 标签：c#, asp.net, .net

我在这个数据库访问的东西上取得了进展......这是我需要做的：我有一个在类命名空间中定义的现有 DataSet（因此也是一个 DataTable），我正在尝试创建一个允许用户的函数从项目列表中选择，并使用`SelectedItem.Value`（其中包含来自数据库的唯一主键）显示有关所选项目的更多信息。我相信我需要搜索 DataSet 并将其读入类似 DataRow 的内容，以便我可以显示其中的值（有一种方法可以根据列名执行此操作，对吗？）

我只是不知道怎么说“复制/选择主键“partnumber”等于`SelectedItem.Value`“

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:45:01.837

常用的方法有以下三种

1.  使用[DataRowCollection.Find](http://msdn.microsoft.com/en-us/library/ydd48eyk.aspx)只能在列已定义为主键时使用

    ```
    var row = table.Rows.Find(SelectedItem.Value) 
    ```

2.  使用[DataTable.Select(String)](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)，它使用像字符串一样的过滤器

    ```
    var rows = table.Select("IdFieldSelectedItem.Value = " + SelectedItem.Value);
    var row = rows[0]; 
    ```

3.  使用[Linq 到数据集](http://msdn.microsoft.com/en-us/library/bb552415.aspx)

    ```
    var row =  (from t in table.AsEnumerable()
                where t.Field<int>("Id") == SelectedItem.Value
                select t).First(); 
    ```

# sharepoint - 我可以在本地计算机上创建 Sharepoint 站点吗？

> ID：10954267
> 
> 赞同：10
> 
> 时间：2012-06-08T18:34:07.443
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-designer

我正在尝试自己学习 Sharepoint，以便我们可以在我的工作中实现一个网站。我什至遇到的麻烦是在服务器上创建一个它想要的站点。有没有办法在我的本地机器上创建一个站点，以便我可以开始修改一些设计功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T20:07:47.190

如果您在本地机器上安装了 SharePoint Foundation 的 SharePoint Server，那么您当然可以在本地机器上创建 SP 站点（或 SharePoint 应用程序）。如果您没有安装任何这些元素，那么不，您无法创建 SharePoint 网站。

SharePoint 网站虽然是在 IIS 内创建的，但需要服务器软件和 SQL。想一想：如果你没有 Apache 服务器，你就不能创建 Apache 站点，对吧？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-05-27T09:35:00.930

如果你想为你的 Intranet 创建一个本地共享点，那么你必须在你的任何机器上安装 iis 或 tomcat 服务器，然后你可以创建一个网站并在你的 Intranet 上发布

# objective-c - 我该如何做这个 NSPredicate 代码？

> ID：10954273
> 
> 赞同：1
> 
> 时间：2012-06-08T18:34:31.907
> 
> 标签：objective-c, ios, cocoa-touch, core-data, nspredicate

我在使用 NSPredicate 时遇到问题。我有一个名为 Entry 的核心数据对象，其中包含一个名为 creationDate 的 NSDate。我想将此与我称为日期的变量进行比较。

我正在使用 NSDate 类别来提取两个对象的单独年份，并使用核心数据类别来对我的核心数据存储中的所有 Entry 对象执行谓词。

```
[Entry allForPredicate:[NSPredicate predicateWithFormat:@"creationDate.year == %i",  date.year]]; 
```

我认为这是错误的，因为它没有给我预期的结果，而是出现空白。

我哪里错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T18:52:30.987

我怀疑，Core Data 在创建原始数据库调用时可以合并类别。

为您的案例创建 2 个日期，一个是今年 1 月 1 日 0:00，一年后

```
 NSString *basePredicateString = @"creationDate >= %@ AND creationDate < %@";
 NSPredicate *predicate = [NSPredicate predicateWithFormat:basePredicateString, startDate, endDate]; 
```

为了完整起见——我将如何生成实际年份的开始和结束日期：

```
NSDate *startDate = [NSDate date];
[[NSCalendar currentCalendar] rangeOfUnit:NSYearCalendarUnit startDate:&startDate interval:NULL forDate:startDate];

NSDateComponents *comps = [[[NSDateComponents alloc] init] autorelease];
comps.year = 1;
NSDate *endDate = [[NSCalendar currentCalendar] dateByAddingComponents:comps toDate:startDate options:0]; 
```

在这个答案下面的评论中，jbrennan 提出，确实可以将一个类别合并到一个谓词中。虽然他适合作为 NSArrays 的集合（他添加了一个指向测试项目的链接），但在涉及 Core Data 获取请求时它不起作用——至少我不能让它起作用。我试过了。这是我的测试：[https ://github.com/vikingosegundo/CoreDataCategoryTest](https://github.com/vikingosegundo/CoreDataCategoryTest)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:58:48.327

@vikingosegundo 有正确的答案 - 您不能在谓词中使用类别。

如果您了解 SQL，请尝试设置以下“**启动时传递的参数**”：

`-com.apple.CoreData.SQLDebug 1`

这将允许您查看请求生成的 SQL。这应该可以帮助您了解您编写的谓词是如何转换为 SQL 的。

* * *

**再次按@vikingosegundo**编辑-根据OP 的问题与CoreData 一起使用时，上述内容适用。****

# angularjs - AngularJS - 如何在 ng-Repeat 中引用属性名称

> ID：10954286
> 
> 赞同：136
> 
> 时间：2012-06-08T18:35:10.230
> 
> 标签：angularjs, angularjs-ng-repeat

除了呈现对象中的属性值之外，我还想将属性名称呈现为标签。有没有办法做到这一点`ng-repeat`？例如：

```
<ul>
    <li ng-repeat="option in data">{{propertyName}}: {{option}}</li>
</ul> 
```

这可能会吐出这样的东西：

```
<ul>
    <li>Name: John</li>
    <li>Phone: (123) 456-7890</li>
    <li>Country: England</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2012-06-08T19:31:13.147

试试这个：

```
<ul>
    <li ng-repeat="(key,val) in data">{{key}}: {{val}}</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-10-29T16:04:10.193

文档的问题在于它说`(key, value)`那个空间......我花了一些时间才弄清楚因为它不起作用

# maven - OSGi 和 Maven 检测私有包的使用

> ID：10954288
> 
> 赞同：4
> 
> 时间：2012-06-08T18:35:16.237
> 
> 标签：maven, osgi

我正在开始一个编写 OSGi 包并使用 Maven 作为构建管理工具的项目。我的理解是对于 OSGi 捆绑包，您可以选择要保持私有/公开的包。

这是问题：

*   如果我依赖于将包声明`com.example`为导出包并声明`com.example.internal`为私有包的捆绑包，那么在构建期间有什么方法可以检测`com.example.internal`（构建应该失败）的使用吗？

如果 Eclipse 可以在开发期间检测到这将是很棒的，但我非常怀疑它可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:13:21.127

一种选择是使用 Eclipse 的插件开发环境 (PDE)，这是一套支持 OSGi 的工具。它不会让您针对内部包进行编译，因此它为您提供了开发时检查。与 maven 的 bundle 插件不同，它是 manifest-first 而不是 code first，这并不符合每个人的口味。

要将 PDE 与 Maven 集成，最好的办法是使用 Maven [Tycho 插件](http://www.sonatype.org/tycho)。这在 Maven 中为您提供了一个完全支持 OSGi 的编译阶段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T07:20:47.037

在认为你会在 bnd(tools) 中找到很多对此的支持。一般来说，我通过查看 Import-Package 语句来找到这些罪魁祸首，该语句在 bndtools 中很好地可视化。bnd(tools) 支持在导入包没有导入范围时生成警告/错误，当您导入私有或不存在的包时会发生这种情况。

# php - 开源 CMS 的版本控制风格

> ID：10954291
> 
> 赞同：0
> 
> 时间：2012-06-08T18:35:27.133
> 
> 标签：php, content-management-system, github

我已经开发了自己的 CMS - 我并没有声称它是最好的，甚至不是最好的，我只是想面对创建这样的系统可能带来的问题。
目前，我在为我的 CMS 设计一些合理的版本控制系统时遇到了问题。

我现在所拥有的：

1.  项目托管在 GitHub 上（实际上还没有），
2.  有两个分支：
    *   针对当前变化进行开发
    *   主要用于稳定的变化形式发展

我的第一个想法是使用 GitHub API 创建更新系统——用户正在将他的本地最新提交 sha 与项目页面上的 sha 进行比较——如果不是最新的下载文件。这个解决方案有一个很大的缺点 - API 的请求限制，由于每分钟的请求太多，一个用户将能够关闭整个“更新服务器”。
取而代之的是，我将使用“GitHub Pages”来存储项目页面并更新我自己在本地生成的变更集（以 JSON 格式修改的 git diff 输出以及附加信息）。在这个想法中，我不使用提交来检查更新状态，而是使用版本号。
假设我的 GitHub 页面如下所示：

```
index.html
/changsets
+--0.0.1.json
+--0.0.2.json
...
+--1.0.0.json 
```

changsets 目录中的每个 JSON 文件都将保存自其名称版本以来更改的文件列表 - 如果 1.0.0 是当前版本文件 1.0.0.json 将包含一个空数组。
版本号应该是什么格式？三个整数在 1.0.55 或 1.55.21 时可能看起来不太好。我什么时候应该将更改从开发分支推送到主分支？我不像 Joomla / Drupal 团队那样有经验，所以我没有任何时间表或功能列表来发布版本 X（大多数更新肯定是错误修复）。
如果版本更改太频繁，我将需要生成数十个 JSON 文件，这将浪费时间和资源。也许我应该有六个月的最后期限，那时不会生成任何变更集？
我知道我应该有一些带有 REST API 的网络服务器来处理它，但我希望我的项目完全托管在 GitHub 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:40:57.363

对于版本方案，您可以使用[语义版本控制](http://www.semver.org)

每次查看页面时检查更新是不现实的，如果知名网站正在使用您的脚本，这实际上可能是一种威胁。相反，您可以在管理面板中添加一个页面或选项，让管理员检查更新。

# vba - 如何使用 VBA 通过 HTTP_POST 和 Excel 发送文件？

> ID：10954293
> 
> 赞同：10
> 
> 时间：2012-06-08T18:35:32.060
> 
> 标签：vba, excel, http-post, winhttprequest

这里提出的问题：[如何使用 VBA 从 Excel 向服务器发送 HTTP POST 请求？](https://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba)几乎正是我想要的，只是我试图将一些文件发送到服务器。我进一步搜索并发现[如何使用 VBA 通过 HTTP 帖子上传 zip 文件？](https://stackoverflow.com/questions/3939578/how-do-i-upload-a-zip-file-via-http-post-using-vba)这也很好，但很令人沮丧——这似乎需要做很多工作（不仅仅是在这里制作 HTML 表单......）。

此处的选项#2：[http](http://www.motobit.com/tips/detpg_post-binary-data-url/) ://www.motobit.com/tips/detpg_post-binary-data-url/ （如上面提到的 SO 问题中所引用的）似乎效果很好，但是当我在 JS 和CSS，我不知道如何在示例中创建 FormData（发送到服务器的二进制文件）。

谁能帮帮我吗？本质上，我想通过 VBA 通过 HTTP_POST 从 Excel 内部将 3-6 个文件发送到 Web 服务器上的 PHP 脚本，该脚本需要诸如 . 处理此问题的 HTML 表单如下所示：

```
<form action="upload_file.php" method="post" enctype="multipart/form-data">
  <input name="userfile[]" type="file" /><br />
  <input name="userfile[]" type="file" /><br />
  <input name="userfile[]" type="file" /><br />
  <input type="submit" />
</form> 
```

谢谢大家。

编辑——2012 年 8 月 2 日

我仍在努力解决这个问题。我不知道 VBA/6，几乎只是基本的 JS，所以我有点迷茫。这是我到目前为止所做的：

```
Sub HTTPInternetPutFile()

    ' create new object with WinHttpRequest for this operation
    Dim WinHttpReq As Object
    Set WinHttpReq = CreateObject("WinHttp.WinHttpRequest.5.1")
    Dim FormFields As String

    ' initialize variables that we will set and pass as parameters
    Dim sfpath
    Dim strURL As String
    Dim StrFileName As String

       StrFileName = "CLIPrDL.csv"
       sfpath = "C:\CLIPr\"
       strURL = "http://s0106001c10187ab1.gv.shawcable.net/uploadtest/upload_file.php"

       WinHttpReq.Open "POST", strURL, False

       ' Set headers
       WinHttpReq.setRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
       WinHttpReq.setRequestHeader "Accept-Charset", "ISO-8859-1,utf-8"
       WinHttpReq.setRequestHeader "Content-Type", "multipart/form-data"
       ' WinHttpReq.setRequestHeader "Content-Type", "text/html;charset=UTF8"
       WinHttpReq.setRequestHeader "Content-Disposition", "form-data; name=""userfile[]"""

       ' I dont understand this... why use fileup??
       FormFields = """filename=" & StrFileName & """"
       FormFields = FormFields & "&"
       FormFields = FormFields & sfpath

       ' so comment it out for now
       ' WinHttpReq.Send FormFields
       WinHttpReq.Send sfpath & StrFileName

       ' output this var to a message box becuase I dont know what it does really
       MsgBox FormFields
       ' Display the status code and response headers.
       MsgBox WinHttpReq.GetAllResponseHeaders
       MsgBox WinHttpReq.ResponseText

End Sub 
```

脚本底部的消息框会输出服务器的标题和响应（空白 HTML 页面）。我觉得我没有在标题中设置一些东西来让服务器开心（注意：尝试注释掉 Content-Type）。

如果有人有使用 VBA/6 中的 WinHttpRequest 对象通过 HTTP POST 二进制文件的经验，请帮助！:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-13T23:13:04.910

这（使用 WinInet）是 VB6，但也应该在 VBA/Excel 中工作：

[http://wqweto.wordpress.com/2011/07/12/vb6-using-wininet-to-post-binary-file/](http://wqweto.wordpress.com/2011/07/12/vb6-using-wininet-to-post-binary-file/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-11T11:26:50.903

我成功使用了下面的一个（它使用 ADODB.Stream 和 WinHttp.WinHttpRequest.5.1）：

[http://www.ercphelps.com/scripting/samples/reference/web/http_post.txt](http://www.ericphelps.com/scripting/samples/reference/web/http_post.txt)

^(（如果网站消失，也[可以在 Internet Archive 上找到](http://web.archive.org/web/20160423151412/http://www.ericphelps.com/scripting/samples/reference/web/http_post.txt)）)

# django - 数据来自外部 Web 服务而不是数据库的 Django 应用程序

> ID：10954300
> 
> 赞同：3
> 
> 时间：2012-06-08T18:36:10.853
> 
> 标签：django, web-services, django-models

我计划开发一个 Django 应用程序，其中大部分数据都在外部 Web 服务中，而不是存储在 Django 将使用的数据库中。在这种情况下如何构建模型？我可以使用纯字符串和整数而不是 Django 字段类型，或者阻止 Django 将字段写入数据库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:06:57.557

您可以正常构建模型......只是避免调用`save()`您的模型实例。

但是，使用 Django 模型几乎没有什么好处，因为它们是 ORM 的一部分，并且功能主要与数据库相关。

如果 Web 服务超过 json，那么您不妨使用从中获得的 dict/list 对象`simplejson.loads`

如果 Web 服务是 SOAP，请尝试[http://soapy.sourceforge.net/](http://soapy.sourceforge.net/)

如果您需要验证服务响应，您可以考虑制作 Django 表单并传递解析的字典，`data`而不是`request.POST`像您通常所做的那样。

# jquery - 使用效果 Jquery 隐藏/显示 div

> ID：10954304
> 
> 赞同：1
> 
> 时间：2012-06-08T18:36:28.390
> 
> 标签：jquery, html, menu, hide, show

我正在尝试隐藏主 div 并显示另一个，使用 jquery，我对此进行了编码，但它不起作用。这是jquery和css。

```
 <script>
 $(".mib").click(
function Mision() {
      var $next = $('#content #mision');
      var $active = $('#content .activec');
      $active.fadeOut(function(){
        $active.removeClass('activec');
        $next.fadeIn().addClass('activec');
            });   
          });

  </script>

<style>
#content div {
    display: none;
    position: relative;
    top: 0;
    left: 0;
}
#content div.activec {
    display: block;
}
</style> 
```

这是html

```
<div id="menu">
<a href="" class="mib">Mision(actually here goes an image)</a>
</div>

<div id="content">
<div id="intro" class="activec">Intro Text</div>
<div id="mision">Mision Text</div>
</div> 
```

我修改了代码，但我仍然找不到错误..请帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:46:12.460

保持简单 - [http://jsfiddle.net/4KP5F/1/](http://jsfiddle.net/4KP5F/1/)

```
$(".mib").on("click", function(e) {
    e.preventDefault();

    $("#intro").fadeOut(400, function() {
        $("#mision").fadeIn(400);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:44:20.803

尝试这个：

```
<a href="javascript:void(0)" class="mib">Mision(actually here goes an image)</a> 
```

并将您的脚本封装在`ready`回调中：

```
$(document).ready(function(){
   $(".mib").click(function Mision() {
      var $next = $('#content #mision');
      var $active = $('#content .activec');
      $active.fadeOut(function(){
         $active.removeClass('activec');
         $next.fadeIn().addClass('activec');
      });   
   });
}); 
```

**[演示](http://jsfiddle.net/9vvkk/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T18:51:39.117

```
$(".mib").bind('click',function Mision() {
      var $next = $('#content #mision');
      var $active = $('#content .activec');
      $active.fadeOut(function(){
         $active.removeClass('activec');
         $next.fadeIn().addClass('activec');
      });   
   }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T18:40:07.407

尝试改变

```
$(".mib").click(
function Mision() { 
```

至

```
$(".mib").click(
function() { 
```

（没关系，最后一次编辑，你有正确数量的右括号。）

# binary-tree - 二叉树前序和后序遍历相同吗？

> ID：10954306
> 
> 赞同：1
> 
> 时间：2012-06-08T18:36:30.920
> 
> 标签：binary-tree, traversal, postorder, preorder

是否存在这种情况为真的二叉树？

我不这么认为，除非二叉树只包含一个根节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:49:46.457

你是对的：假设根节点至少有一个孩子。

在前序遍历中，首先处理根节点。孩子跟着它。这在伪代码中很容易看出：

```
preorder(node)
  if node == null then return
  print node.value
  preorder(node.left) 
  preorder(node.right) 
```

在后序遍历中，根节点是最后被处理的，子节点是最先处理的；再次查看代码：

```
postorder(node)
  if node == null then return
  postorder(node.left)
  postorder(node.right)
  print node.value 
```

[（来自维基百科](http://en.wikipedia.org/wiki/Tree_traversal)的伪代码）。

总之，如果二叉树有多个节点，则遍历必然不同。

# asp.net - Response.IsClientConnected 在 IE9 中始终为真

> ID：10954307
> 
> 赞同：1
> 
> 时间：2012-06-08T18:36:35.077
> 
> 标签：asp.net, iis, internet-explorer-9

我有一个长时间运行的网页，如果用户导航离开（它将页面加载到 iframe 中），我需要杀死它，但即使用户导航到不同的页面，Response.IsClientConnected 也总是返回 true。

Fiddler 报告连接仍然发生。

关于如何确定用户是否离开页面的任何想法？

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T11:42:51.300

您使用的是 VS 开发 Web 服务器还是 IIS？当代码在 IIS 下运行时，HttpResponse.IsClientConnected 可以正常工作，但在 Cassini（开发 Web 服务器）下却不能。

顺便说一句，Fiddler 本身可以成为持久连接的原因。我注意到，如果 Fiddler 正常工作，连接的活动时间会更长。在一些测试场景中，我在我的项目中实现了一个 Web 应用程序（代码依赖于 IsClientConnected）在没有运行 Fiddler 的情况下运行良好，但是打开 Fiddler 会立即带来错误。

# objective-c - 计算 ALAsset 的 CRC 校验和

> ID：10954309
> 
> 赞同：2
> 
> 时间：2012-06-08T18:36:37.843
> 
> 标签：objective-c, crc, alassetslibrary, crc32, alasset

我正在尝试计算 ALAsset 的 CRC 校验和。我的目标是保存所有 CRC 并在以后比较它们以查看资产是否已更改，但每次为相同资产生成 CRC 时，我都会得到不同的结果。

要生成 CRC：

```
#import "CRC32.h"
#import <zlib.h>

@implementation CRC32

+ (uint32_t)CRC32Value:(NSData*)data
{
  uLong crc = crc32(0L, Z_NULL, 0);
  crc = crc32(crc, [data bytes], [data length]);
  return crc;
}

@end 
```

如何使用：

```
void(^assetEnumerator)(ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop) 
  {         
    if(result == nil) 
    {
      return;
    }

    CrawlAssetData *assetData = [[CrawlAssetData alloc] init];
    [assetData setCrc:[CRC32 CRC32Value:[NSData dataWithBytes:&(result) 
                                                       length:sizeof(result)]]]; 
```

这是我在不同场合为同一资产生成 CRC 时的结果：

id: 17575
url: assets-library://asset/asset.JPG?id=BB282CBD-F5B1-4771-B48B-E021224C7384&ext=JPG
文件大小: 1394332
**crc: 3605102491**
创建时间: 2456085.397025

id:
17826 url: assets-library://asset/asset.JPG?id=BB282CBD-F5B1-4771-B48B-E021224C7384&ext=JPG
文件大小: 1394332
**crc: 1383370697**
创建时间: 2456085.397025

如您所见，文件大小和 url 相同，但 CRC 不同。

我计算CRC错误吗？或者我应该使用 ALAsset 的不同部分来生成 CRC？也许每次检索 ALAsset 时某些数据都会有所不同？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:48:33.543

这一行：

```
[assetData setCrc:[CRC32 CRC32Value:[NSData dataWithBytes:&(result) 
                                                   length:sizeof(result)]]]; 
```

...正在计算您的 ALAsset 实例的*地址的 CRC，而不是它的数据。*

您可以通过拆分行来验证这一点：

```
NSData *crcData = [NSData dataWithBytes:&(result) 
                                 length:sizeof(result)];
NSLog( @"crcData length: %d", [crcData length]);
[assetData setCrc:[CRC32 CRC32Value:crcData]]; 
```

我的猜测是在输出中你会看到`crcData length: 4`.

根据提问者的后续评论（带有更正），执行此操作的代码是：

```
ALAssetRepresentation *rep = [result defaultRepresentation];
uint8_t *buffer = malloc(rep.size);
NSUInteger buffered = [rep getBytes:buffer
                         fromOffset:0
                             length:rep.size
                              error:nil];
NSData *data = [NSData dataWithBytesNoCopy:buffer
                                    length:buffered
                              freeWhenDone:YES];   
uint32_t CRC32 = [CRC32 CRC32Value:data];
[assetData setCrc:CRC32]; 
```

特别要注意，`sizeof(NSData*)`（或`NSData *a; sizeof(A)`）总是*指针*的大小（在 iPhone 等 32 位系统上为 4，在 64 位 Mac OS X 上为 8），而不是存储在`NSData`. `sizeof()`获取NSObject*指针*没有正常的理由。

# c# - 未处理的 PageIndexChanging

> ID：10954310
> 
> 赞同：0
> 
> 时间：2012-06-08T18:36:47.560
> 
> 标签：c#, .net, page-index-changed

我已经为 gridview 设置了 EnableSortingAndPagingCallbacks="True" 并且我没有任何模板列。

分页在所有浏览器上都可以正常工作，没有任何错误，但只有少数 IE8 用户（不是所有 IE8 用户）报告 PageIndexChanging 未处理错误。是他们浏览器的选项设置问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:40:30.227

尝试`OnPageIndexChanging`像这样设置网格视图的事件处理程序

```
protected void gridView_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
   gridView.PageIndex = e.NewPageIndex;
   gridView.DataBind();
} 
```

# sql-server - 自定义审计与自定义日志记录 - SSIS

> ID：10954312
> 
> 赞同：0
> 
> 时间：2012-06-08T18:36:57.147
> 
> 标签：sql-server, logging, ssis, business-intelligence, audit-logging

他们两个不是一样的吗？

我正在阅读[这篇文章][1]

[1]：[http](http://www.sqlmag.com/content1/topic/ssis-logging-and-data-auditing/catpath/business-intelligence-development-studio-bids/page/2) ://www.sqlmag.com/content1/topic/ssis-logging-and-data-auditing/catpath/business-intelligence-development-studio-bids/page/2我还不清楚自定义日志记录和审计之间的区别。他们似乎都在包运行时记录事件......我对此没有太多经验，所以如果有人这样做/做过这个，你能为我澄清一下吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:17:36.657

这取决于您要捕获的信息类型，除了您引用的文章中提供的示例之外，在 SSIS 中还有很多方法可以做到这一点。日志记录通常捕获有关包执行本身的信息——遇到的错误、包或包内步骤的执行时间、数据流缓冲区详细信息等。审计通常是关于数据的信息——插入、更新和删除的记录数量；什么时候完成；来源是什么；谁运行了这个包；它在什么机器上运行，等等。

# jsf-2 - jsf 2 response.sendRedirect 不工作

> ID：10954319
> 
> 赞同：3
> 
> 时间：2012-06-08T18:37:37.797
> 
> 标签：jsf-2, richfaces

我在我的 JSF2.1/Richfaces 4.2 应用程序中观察到一件有趣的事情。过滤器（或）JSF Bean 操作方法中的所有 response.sendRedirect() 调用如何不起作用。

如果我们在客户端（浏览器）上使用 location.href，它工作正常。

关于可能导致发送重定向失败的任何建议？我试过下面的签名。

```
response.sendRedirect("/appRoot/mypage.xhtml");
  or 
(HttpServletResponse) facesCtx.getResponse()).sendRedirect(((HttpServletRequest)request).getContextPath()+"/appRoot/mypage.faces"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:41:15.790

> *过滤器（或）JSF Bean 操作方法中的所有 response.sendRedirect() 调用如何不起作用。*

如果请求实际上是 ajax 请求，就会发生这种情况。网络浏览器根本不会将重定向翻译`XMLHttpRequest`到主窗口。发送 ajax 请求的 JS 代码对此负责。它需要特殊/不同的响应，以便 JS 代码了解它需要更改窗口位置，或者需要更改 JS 代码本身以便它可以相应地处理响应。

如果 ajax 请求是由 JSF 本身发起的（例如`<f:ajax>`等等）并且 Java 代码在 JSF 上下文中运行，那么您应该使用它[`ExternalContext#redirect()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#redirect%28java.lang.String%29)。这会自动检测当前请求是否为 ajax 请求，并将返回一个特殊的 XML 响应，告诉 JSF ajax 引擎更改窗口的位置。如果您不在 JSF 上下文中（例如在 a 中`Filter`），那么您需要自己创建这个特殊的 XML 响应，如下所示：

```
response.setContentType("text/xml");
response.getWriter()
    .append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>")
    .printf("<partial-response><redirect url=\"%s\"></redirect></partial-response>", url); 
```

### 也可以看看：

*   [使用 JSF 2.0 / Facelets，有没有办法将全局侦听器附加到所有 AJAX 调用？](https://stackoverflow.com/questions/9305144/using-jsf-2-0-facelets-is-there-a-way-to-attach-a-global-listener-to-all-ajax/9311920#9311920)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T16:31:19.277

```
FacesContext.getCurrentInstance().getExternalContext().redirect(url); 
```

# asp.net - IIS 缓存和 Web 服务

> ID：10954320
> 
> 赞同：1
> 
> 时间：2012-06-08T18:37:39.310
> 
> 标签：asp.net, .net, wcf, iis, caching

我在 IIS 下使用 http 绑定托管我的 wcf 服务。

最近我注意到正在进行某种缓存。

我需要刷新我的网络服务，直到我得到真实的数据，而不是几分钟前。

有没有办法禁用这种缓存？以及如何做到这一点...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:55:18.927

You could add an `[AspNetCacheProfile("NoCacheProfile")]` attribute to the service method(s) that is defined like this in the web.config for the application (child of the `<system.web>` element) :

```
<caching>
  <outputCacheSettings>
    <outputCacheProfiles>
      <add name="NoCacheProfile" noStore="true" duration="0" varyByParam="none" enabled="true"/>
    </outputCacheProfiles>
  </outputCacheSettings>
</caching> 
```

This is a .NET Framework 4 [feature](http://msdn.microsoft.com/en-us/library/ee230443.aspx).

# ssrs-2008 - 尝试在父级中添加子行组但在嵌套单元格中向左对齐

> ID：10954323
> 
> 赞同：17
> 
> 时间：2012-06-08T18:37:46.913
> 
> 标签：ssrs-2008, reporting-services, ssrs-tablix, ssrs-grouping

我正在尝试做的事情：

我正在尝试创建嵌套组，但我希望子行组直接显示在父级下方，像父级一样向左对齐。

因此，在这种情况下，您将拥有：

```
Market
SubMarket 
```

所以结果例如是：

```
California <<< market
SanJose
Pleasanton
Walnut Creek

Illinois <<< market
Chicago Suburbs
Chicago 
```

... 等等

我无法弄清楚为什么我不能让子行组直接显示在

谁可以帮我这个事？我对 SSRS 真的很失望。不知道为什么它不只是在我单击的单元格上添加分组。相反，它会创建新列！是的，设计使然，但为什么呢？以及如何解决这个问题。我想做的事情看起来很简单……但在 SSRS 中却很难。

**这是我尝试做的一个例子：**

*   **在父级中创建父行组**：如果您单击父组（在本例中为市场）中的一个单元格，然后在该单元格上添加另一个父组，它将在您的 SSRS 报告中将一个新列添加到父组的右侧你在：

![在此处输入图像描述](../Images/e6ab192090a49beacd37073e6e950891.png)

*   **在父组中创建子行组**：如果您在父组中并单击单元格并添加子行组，它将将该行添加到父组的右侧

![在此处输入图像描述](../Images/e6ab192090a49beacd37073e6e950891.png)

**我想做的是这个**，我不能让 SSRS 把那个子市场放在这里：

![在此处输入图像描述](../Images/cc217b1af15e63f2acfbf9f705d4b06b.png)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-16T13:08:16.487

如果我正确理解了您的问题，那么您想要的肯定是可能的，而且让它工作肯定很痛苦。这是一个小示例，其中包含一些模拟数据，应该或多或少类似于您的情况。

数据集：

```
Market    SubMarket
------    ---------
A         1
A         2
A         3
B         4
B         5
B         6
B         7 
```

以下是我为创建表所采取的步骤：

1.  将新表拖放到设计器中。

2.  将字段拖放`SubMarket`到第一列。

3.  右键单击详细信息行并添加新的父组。

    ![添加父组](../Images/eb18f0e4ad722c35b487e9fc8004ee7e.png)

4.  分组`Market`并选择添加组标题行。

    ![新组设置](../Images/2e2a28af237007cf6325646a81fbee4e.png)

    正如您已经注意到的，SSRS “帮助”并添加了一个额外的列。

5.  右键单击额外的（第一）列并将其删除。

6.  选择组标题行中的单元格并输入“[市场]”，或从快速列表中选择。

    ![将字段添加到标题行](../Images/6cee7268d950fc1ff03b5e3efc1449ef.png)

7.  通过填写其他字段/列/单元格来完成。对于标题行拖放不起作用，您必须自己选择该行的字段（或键入'em）。

    这是预览中的结果表（重点放在标题行）：

    ![样本输出](../Images/1f89d8666c4075608be2dc04a64a7b98.png)

希望这有帮助！

# github - github中的未分级更改是什么？

> ID：10954329
> 
> 赞同：13
> 
> 时间：2012-06-08T18:38:31.047
> 
> 标签：github

我刚刚更改了 README 文件并想在 github 中同步它，但它总是告诉我“您无法与未暂存的更改同步”。有人可以告诉我它是什么以及我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-08T18:57:22.537

看看[learn.github](https://github.com/github/learn.github.com/blob/gh-pages/p/normal.md#using-the-staging-area)：

![分期](../Images/f2ab6207263cee23b4c7b0279e00fe14.png)

你需要：

*   将您的文件添加到索引 ( [`git add`](http://git-scm.com/docs/git-add))，
*   并提交它（[`git commit -m "your modification comment"`](http://git-scm.com/docs/git-commit)），
*   在推动它之前（[`git push`](http://git-scm.com/docs/git-push)）。
    另见“[使用遥控器](http://git-scm.com/book/en/Git-Basics-Working-with-Remotes)”）

因此，“未暂存的更改”没有链接到 GitHub，而是在您的本地存储库上进行的本地修改，您尚未将其添加到索引中（“暂存的”），以供将来提交。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T18:40:12.620

您需要将更改提交到本地 GIT 存储库。

# asp.net - asp:Literal 标签在被渲染

> ID：10954332
> 
> 赞同：0
> 
> 时间：2012-06-08T18:38:38.237
> 
> 标签：asp.net

我正在尝试在母版页上的元素中放置一个 asp:literal 标记。当我在母版页后面的代码中设置值，然后查看正在使用该母版页的页面时，文字的值在 <body> 中输出。

我有以下母版页：

```
 <%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Test1.master.cs" Inherits="Corporate.Presentation.Web.Test1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <asp:Literal runat="server" ID="ltlGoogleAnalytics"></asp:Literal>
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">

        </asp:ContentPlaceHolder>
    </div>
    </form>
</body>
</html> 
```

代码背后：

```
using System;

namespace Corporate.Presentation.Web
{
    public partial class Test1 : System.Web.UI.MasterPage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            ltlGoogleAnalytics.Text = "test";
        }
    }
} 
```

测试 ASPX 页面：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Test1.Master" AutoEventWireup="true" CodeBehind="TestForm1.aspx.cs" Inherits="Corporate.Presentation.Web.TestForm1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
</asp:Content> 
```

HTML 输出：

```
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>

</title></head><body>test

    <form method="post" action="TestForm1.aspx" id="aspnetForm">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTY1NDU2MTA1Mg9kFgJmD2QWAgIBD2QWAgIBDxYCHgRUZXh0BQR0ZXN0ZGQVhLZ0Btj29J7NtToygADkXCPCuLkULTvV5jvIb8hFFw==">
</div>

    <div>

    </div>
    </form>

</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:01:24.563

尝试放置实际的脚本参考而不是放置文本。如果您在头部区域中允许作为文字文本的适当内容，它将被放置在头部。

```
ltlGoogleAnalytics.Text = "<script src='/scripts/analytics.js' type='text/javascript'></script>" 
```

# javascript - FF mouseleave/mouseenter 事件

> ID：10954337
> 
> 赞同：0
> 
> 时间：2012-06-08T18:38:53.053
> 
> 标签：javascript, firefox, firefox-addon

我为 FF 编写扩展，这部分代码不适用于早期版本 6.0-8.0。但是在 12.0-13.0 版本上，一切都很好。是什么原因？

```
 for(var i = 0; i < doc.getElementsByClassName('repInfo').length; i++)
        {
            doc.getElementsByClassName('repInfo')[i].getElementsByTagName('a')[0].style.visibility = "hidden";
            doc.getElementsByClassName('repInfo')[i].getElementsByTagName('a')[1].style.visibility = "hidden";

            doc.getElementsByClassName('repInfo')[i].addEventListener('mouseleave', 
                function(e) {
                    e.target.getElementsByTagName('a')[0].style.visibility = "hidden";
                    e.target.getElementsByTagName('a')[1].style.visibility = "hidden";
                }, false);
            doc.getElementsByClassName('repInfo')[i].addEventListener('mouseenter', 
                function(e) { 
                    e.target.getElementsByTagName('a')[0].style.visibility = "visible";
                    e.target.getElementsByTagName('a')[1].style.visibility = "visible";
                }, false);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:52:24.700

[`mouseenter`](https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseenter)[`mouseleave`](https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseleave)Firefox 10 添加了支持。

# perl - perl 测试符号函数名是否存在

> ID：10954338
> 
> 赞同：3
> 
> 时间：2012-06-08T18:38:58.407
> 
> 标签：perl

如果我编一个子程序名称，说

```
$type = 'Circle';
$fn = 'My'.$type.'Renderer'; 
```

如何测试 $fn 中命名的子例程是否已定义？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T19:40:05.573

您可能很想使用该`can`方法，但这是错误的，它可能导致误报，因为它遵循继承。你想用[`exists`](http://perldoc.perl.org/functions/exists.html).

```
my $name = ...;
my @args = ...;
die("$name doesn't exist\n") if !exists(&$name);
(\&$name)->(@args); 
```

`$name->(@args)`没有严格就足够了。奇怪的语法绕过严格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T18:43:01.153

1.  `PACKAGE->can($fn)`, 默认为 PACKAGE `main`。
2.  `defined &{$fn}`

[`can`](http://p3rl.org/UNIVERSAL)如果它存在，还将返回您对此函数的 CODE 引用。

# c# - 线程会提高性能吗？

> ID：10954340
> 
> 赞同：2
> 
> 时间：2012-06-08T18:39:07.543
> 
> 标签：c#, multithreading

我有一个这样的程序。它是一个 .Net Framework 4 控制台应用程序。该程序用于从每个服务器上的每个日志文件（从前一周）收集 sc-bytes 和 cs-bytes。该程序已完成，但需要很长时间才能运行。

```
foreach (string server in servers)
            {

                foreach (string website in Directory.GetDirectories(server))
                {

                    foreach (string file in Directory.GetFiles(website))
                    { 
```

我只是想知道是否可以使用线程或 PLINQ 之类的东西来加速该过程？如果这会提高性能，我不确定实现它的最佳方法，因为为每个日志文件（甚至每个网站）设置一个新线程似乎不合逻辑，因为拥有这么多线程显然不会提高性能。

如果您需要查看更多代码，请询问，但该程序基本上读取过去 7 天内创建的每个文件的每一行，添加字节数，然后使用目录条目获取网站名称（来自 ID） ，然后将每个网站的名称和总字节数输出到一个文本文件（最终将是一个数据库）。我不需要任何实际代码，只需建议（如果可能的话）提高性能的最佳方法。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T18:42:06.927

在像这样的 IO 绑定任务中（遍历目录和文件并读取它们），瓶颈是磁盘 IO，而不是 CPU。

并行化（？）这不太可能有助于加快速度，甚至可能会损害性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:58:17.907

如果服务器是不同机器上的磁盘，那么并行化来自每个服务器的请求目录和文件会提高性能。那是一台运行在 1 个线程中的服务器，可能有 1000 台服务器运行在 10 个线程中。您的程序将等待大量 IO 并且网络带宽可能是瓶颈。更好的方法是在每个执行计数的服务器上都有一个 Web 服务，然后向每个 Web 服务询问结果。这样网络就不会成为瓶颈，您甚至可以以一种在您询问时他们已经知道答案的方式制作 Web 服务（也许使用文件系统观察程序。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T20:20:26.560

Paralleling makes sense only if performance of several threads is better than performance of one thread.

Actual result depends on hardware you have.

If you have very fast network and data is stored in SSDs in every server you may try to parallel all your processes.

configuration described above is rare case in real world.

In regular environment check your network utilization. If it is below 20% **you may try paralleling for servers**.

Sequential read is much faster with HDD (not SSD) comparing to multi-threaded read so paralleling of nested loops unlikely will help you.

**P.S.** Do not try to utilize 100% of your network. Your IT will not be happy about that.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T18:42:16.787

使用多个并发线程是否会提高性能实际上取决于完成的“处理”。根据您的描述，您很可能受 I/O 限制，因此多线程不会有太大帮助，甚至可能更糟。

因此，除非您自己衡量，否则答案是肯定的“也许”。测量是这里的关键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T19:09:14.267

答案取决于几件事：运行客户端程序的机器有多少 CPU，log-checking-per-server 是直接进入每台服务器上的日志文件夹还是检查每台服务器上的每个目录（如果是，如何文件系统在服务器上的大小），以及文件夹在代码片段中可能通过 Directory.GetDirectories 递归的深度。

您说此任务需要“很长时间”才能运行。*一些基本的 Perfmon 统计数据和一些 TaskManager 视图可以帮助您确定在收集数据时本地*使用了多少 CPU 和磁盘，但我怀疑并没有您想象的那么多。

如果您使用 .Net 的 System.Threading 同时处理多个远程服务器上的日志，您可能会发现 I/O 负载随着 I/O 负载分散到多线程下的各个服务器上。然后，客户端机器上试图从不同服务器同时收集这些数据的可能瓶颈将取决于客户端机器多处理线程所必须的 CPU 数量以及它可以提供的网络带宽，以通过网络路径接收答案。各种服务器同时进行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T19:11:37.840

文件系统缓存对数据的访问，尤其是目录和文件信息。因此，如果您使用 PLINQ 之类的东西，您应该能够看到性能的轻微改进。在控制台应用程序中，我真的不明白这一点。如果性能和对性能的感知很重要，那么这种事情将在带有进度和取消的 GUI 中完成......

但是，我认为您发布的代码存在一些问题。从网站获取文件？这将需要通过网络向另一台服务器发送某种请求；我建议异步完成操作。不过，您还没有向任何人提供详细信息来建议您如何做到这一点。

# php - 用 php 回显 javascript 是不好的做法吗

> ID：10954341
> 
> 赞同：3
> 
> 时间：2012-06-08T18:39:22.977
> 
> 标签：php, jquery, decoupling

我有一个使用 Listener 类的 php 应用程序，它基本上只是用 jquery 设置了一个 ajax 请求（下面的示例）。但出于某种原因，呼应 javascript 似乎并不优雅。更好的做法是为要传递的 javascript 构建一个单例类（这可能会引入耦合）还是像我现在正在做的那样回显脚本？

这是我正在做的代码片段。

```
<?php

        $script = "
                    <script>
                    $(document).ready(function(){
                        $('".$trigger."').".$action."(function() {
                        ".$js_variables."
                            var ajax_load = '';
                            var loadUrl = '".$this->controller_path."';
                            var action = $(this).attr('id');

                            $('".$this->parent."')
                            .hide(2)
                            .html(ajax_load)  
                            .load(loadUrl, {action: action, ".$post_mapper."})
                            .fadeIn(800);
                        });
                    });
                </script>
        ";

      echo $script;

?> 
```

编辑：使用单例类也将允许我只使用一次`$(document).ready()`或快捷方式版本`$(function(){})`，而不是每次添加侦听器时。但我不确定这是否值得额外的时间和精力......有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T18:59:42.463

> 用 php 回显 JavaScript 是不好的做法吗？

一般：是

从 php 中回显 JavaScript 是一种常见的做法，但我**强烈反对**这样做。

在大多数情况下，您可以通过遵循前端 MVC 结构来避免混合语言：

HTML 属于`.html`* 文件。就是模型。
CSS 属于`.css`文件。是景色。
JS 属于`.js`文件。是控制器。

我发现实际上需要从服务器端语言生成 JavaScript 的情况非常少见。大多数时候，我真正需要的是传递 JavaScript 可以使用的信息。

而不是试图输出：

```
<a href="#" id="foo">bar</a>
<script>
    $('#foo').click(function () {
        $.ajax('http://example.com')...
        return false;
    });
</script> 
```

对于每个链接，尝试使用原生 HTML 属性来完成大部分繁重的工作：

```
<a href="http://example.com/" class="ajax-link">bar</a> 
```

在你的脚本中你可以有：

```
$(document).on('click', '.ajax-link', function () {
    $.ajax($(this).attr('href'))...
    return false;
}); 
```

委托函数只需绑定一次，可以从静态 JS 文件中完成，无需尝试将 JS 注入 PHP 代码。

如果您需要传递的更多信息，请结合使用[`data-*`属性](http://dev.w3.org/html5/spec/global-attributes.html#embedding-custom-non-visible-data-with-the-data-attributes)[`.data(...)`](http://api.jquery.com/data)。

[* 或`.php`用于模板的任何其他服务器端语言。]

* * *

从服务器回显客户端代码是有特殊原因的。一个示例是为 JSONP API 生成 JSON，您需要在其中动态生成回调。

如果你没有充分的理由使用服务器端语言生成 JS，***那就不要。***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:47:35.987

嗯，这都是偏好......我通常会这样做，这样我的文本编辑器就能够确定什么是 javascript 和什么是 PHP，这样它就不会让我的眼睛流血，试图查看非代码颜色的文本。

```
<script>
    $(document).ready(function(){
        $('<?php echo $trigger ?>').<? echo $action ?>(function() {
            <?php echo $js_variables ?>
            var ajax_load = '';
            var loadUrl = '<?php echo $this->controller_path ?>';
            var action = $(this).attr('id');

            $('<?php echo $this->parent ?>')
                .hide(2)
                .html(ajax_load)  
                .load(loadUrl, {action: action, <?php echo $post_mapper ?>})
                .fadeIn(800);
            });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:07:13.523

一如既往，这取决于。如果您正在编写一个小型应用程序，这种混合物不会伤害您。当应用程序增长到一定大小时，我个人觉得更容易维护，因为我不在一个文件中混合语言。

历史告诉我们前端不要在一个文件中混合 HTML、JavaScript 和 CSS。最好将它们分开，否则当您尝试跟踪错误时很难找到合适的位置。混合使用 JavaScript 和服务器端语言也好不到哪里去。我仍然想到一些我觉得没问题的事情。例如，需要具有动态值的配置或本地化文件。

在您的示例中，我宁愿将其分开。您所做的一切都可以通过 HTML 元素上的（数据）属性和一些 DOM 查找来完美完成。您似乎还需要为您的视图收集一些信息，以便更好地存储在 HTML 中。例如：`$action`这可以从一个形式相当简单地推导出来：

HTML

```
<from method="POST" action="/you-name-it">
  ...
</form> 
```

JS

```
$(function(){
    var form = $('form');
    $.ajax( {
      type: "POST",
      url: form.attr( 'action' ),
      data: form.serialize(),
      success: function( response ) {
        console.log( response );
      }
    } );
}); 
```

提交此确切表单的逻辑可以是 JavaScript 和/或 PHP。他们如何沟通并不重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T19:15:04.793

这是完全可以接受的，但有点冒险——您正在动态生成部分 JS，这意味着您必须生成**VALID** JS 代码，否则整个代码块将被语法错误杀死。

例如，如果您使用 PHP 在 JS 代码块中插入 PHP 变量的值，例如：

```
<script type="text/javascript">
var last_name = '<?php echo $last_name ?>';
</script> 
```

并且 $last_name 恰好是`O'Brien`，您现在引入了语法错误，因为生成的代码将是：

```
var last_name = 'O'Brien';
                ^^^--- string with contents O
                   ^^^^^--- unknown/undefined variable Brien
                  ^^--string followed by variable, but no operator present.
                        ^--- start of a new unterminated string containing a ; 
```

每当您将基于 PHP 的原始数据插入到 Javascript 变量中时，您基本上必须使用[json_encode()](http://php.net/json_encode)，这可以保证生成的 JS 数据是语法上有效的 JS 代码：

```
var last_name = <?php echo $last_name ?>; 
```

请注意，我没有`'`在这个版本中添加任何内容 - json_encode 会为您处理这些。

# android - Android CursorAdapter 在错误的列表项中绘制东西

> ID：10954344
> 
> 赞同：2
> 
> 时间：2012-06-08T18:39:27.940
> 
> 标签：android, android-listview, android-adapter

我有一个`CursorAdapter`从数据库构建的`Cursor`，如果`View`第一个项目中的 a 未填写，它会使用设置了的第一个后续列表项中`View`出现的任何数据填充第一个项目的 s 。此外，我发现每个列表项都会触发 3 次，这似乎很奇怪。它只对第一个列表项执行此操作，而不是所有带有 null的项目。这是它的样子：`View``View``onBindView``View`

![例子](../Images/e4e5d6fb6e6b0a626398d177e5053b35.png)

请注意，“Julian”的地址已复制到“Alice”。每当我在 onBindView 方法中设置断点时，我可以看到当 customerName 为“Alice Martin”时，`if(billingAddressCursor!=null && billingAddressCursor.getCount()>0)`对于所有三个调用，总是评估为 false `onBindView`，所以我知道它永远不会进入计费条件。

为什么它在第一个位置绘制错误的值，我该如何阻止它？代码：

```
private class CustomerAdapter extends CursorAdapter {
    /*** DEBUG CODE, TO BE REMOVED ***/
    int aliceBindCount = 0;
    int blakeBindCount = 0;
    int cscBindCount = 0;
    int julianBindCount = 0;
    /*** ^^^^^^^^^^^^^^^^^^^^^^^^^ ***/
    public CustomerAdapter(Context context, Cursor cursor) {
        super(context, cursor);
    }

    public void bindView(View convertView, Context context, Cursor cursor) {
        if(convertView!=null) {
            String customerName = cursor.getString(cursor.getColumnIndex(CustomerSchema.NAME));
            ((TextView)convertView.findViewById(R.id.cli_customer_name)).setText(customerName);
            /*** DEBUG CODE, TO BE REMOVED ***/
            if(customerName.equals("Alice Martin")) {
                aliceBindCount += 1;
            } else if(customerName.equals("Blake Slappey")) {
                blakeBindCount += 1;
            } else if(customerName.equals("Conceptual Systems")) {
                cscBindCount += 1;
            } else if(customerName.equals("Julian")) {
                julianBindCount += 1;
            }
            /*** ^^^^^^^^^^^^^^^^^^^^^^^^^ ***/
        }
        final Long billingAddressID = cursor.getLong(cursor.getColumnIndex(CustomerSchema.BILLING_ADDRESS_ID));
        Cursor billingAddressCursor = DbDesc.getInstance().getDatabase(getActivity()).query(
                LocationSchema.TABLE_NAME,
                null,
                LocationSchema._ID+"=?",
                new String[]{ String.valueOf(billingAddressID) },
                null,
                null,
                null
        );
        if(billingAddressCursor!=null && billingAddressCursor.getCount()>0) {
            billingAddressCursor.moveToFirst();
            String street = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.STREET));
            String city = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.CITY));
            String state = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.STATE));
            String zip = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.ZIP));
            if(zip==null || zip.equals("")) {
                zip = "[NO ZIP]";
            }
            if(street==null || street.equals("")) {
                street = "[NO STREET]";
            }
            if(city==null || city.equals("")) {
                city = "[NO CITY]";
            }
            if(state==null || state.equals("")) {
                state = "[NO STATE]";
            }
            ((TextView)convertView.findViewById(R.id.cli_street)).setText(street);
            ((TextView)convertView.findViewById(R.id.cli_city_state_zip)).setText(city+", "+state+" "+zip);
        }
    }

    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        LayoutInflater inflater = LayoutInflater.from(context);
        View v = inflater.inflate(R.layout.customer_list_item, parent, false);
        return v;
    }
} 
```

而且我确信 Alice 不应该有与该记录相关联的帐单地址。这是来自 sqlite3 的表查询。唯一带有帐单地址 ID 的记录是 Julian 的记录，如您所见：

```
sqlite> .tables
.tables
android_metadata  contract          location
contact           customer          phone
sqlite> select * from customer;
select * from customer;
2|Conceptual Systems|||||||
3|Blake Slappey|||||||
4|Julian|1||||||
5|Alice Martin||||||| 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T19:00:49.367

通过查看代码（起初有点混乱），您似乎在该适配器的内部有一个 Custom `CursorAdapter`，`customer`您`bindView()`正在`location`对该人进行二次查询（即 Join from `customer`to `location`）。这将执行得很糟糕，因为在 UI 线程上，对于每个客户，您都在执行辅助查询。

[使用SimpleCursorAdapter](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)`customer`和and之间的连接查询可以更轻松地解决这个问题吗`location`？（在我看来，自定义适配器的唯一目的是以非常低效的方式“加入” `customer`and `location`）

这样，查询将在后台发生，使用`Loaders`可能，并且绑定将相当有效，永远不需要进行备用查询。

初始查询可能类似于..

```
select customer.name, location.address1, location.address2 from customer, location where customer.location_id = location._id 
```

（我不确定您的字段名称是什么，但希望能传达基本结构）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T12:18:41.593

`ListView`回收其行视图，因此未明确设置的旧值将在后续使用中保留。在您的代码中，如果活页夹中的查询未返回任何行，则视图中先前使用的值将保留。不是你想要的。

这是应该解决问题的重新编码：

```
 String street = "[NO STREET]";
   String city = "[NO CITY]";
   String state = "[NO STATE]";
   String zip = "[NO ZIP]";
   if(billingAddressCursor!=null && billingAddressCursor.getCount()>0) {
        billingAddressCursor.moveToFirst();
        String tmp = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.STREET));
        if (tmp != null) street = tmp;
        tmp = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.CITY));
        if (tmp != null) city = tmp;
        tmp = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.STATE));
        if (tmp != null) state = tmp;
        tmp = billingAddressCursor.getString(billingAddressCursor.getColumnIndex(LocationSchema.ZIP));
        if (tmp != null) zip = tmp;

    }
    ((TextView)convertView.findViewById(R.id.cli_street)).setText(street);
    ((TextView)convertView.findViewById(R.id.cli_city_state_zip)).setText(city+", "+state+" "+zip); 
```

话虽如此，这不是填写此列表的正确方法。每个列表项一个数据库查询将产生一个性能狗。最简单的解决方法是使用单个`INNER JOIN`查询从两个表中检索所有信息。如果在 UI 线程上运行，查询仍然可能需要很长时间。首选的解决方法是使用 `Loader`Android 的后台功能来执行此操作，而不会占用 UI 线程。

# asp.net-mvc-4 - 带有对象参数的 MVC 操作的 URL（使用 Web API）

> ID：10954345
> 
> 赞同：0
> 
> 时间：2012-06-08T18:39:32.990
> 
> 标签：asp.net-mvc-4, asp.net-web-api

在[这个问题](https://stackoverflow.com/a/9553719/579299)中，答案建议使用对象作为参数。我将使用什么 URL 来访问它？在 OP 的第一个示例中，我最初的方法是重载动作（不确定重载是否是正确的词）所以我有：

```
public IEnumerable<NTOrder> Get()...

public IEnumerable<NTOrder> Get(int p)...

public IEnumerable<NTOrder> Get(int p, int q) 
```

不优雅，我知道，但如果我将其更改为一个对象，我不知道如何格式化 URL...

旧代码

```
public IEnumerable<NTOrder> Get() {
    //build NTOrderList
    return NTOrderList;
} 
```

新代码

```
public class FilterView
{
    public int? fID { get; set; }
    public int? fCustomer { get; set; }
    public string fSalesPerson{ get; set; }
}

public IEnumerable<NTOrder> Get(FilterView queryFilter) {
    //build NTOrderList
    List<NTOrder> result = (from order in NTOrderList
                               where (order.OrderID == queryFilter.fID || queryFilter.fID == null)
                                  && (order.CustomerID == queryFilter.fCustomer || queryFilter.fCustomer == null)
                                  && (queryFilter.fSalesPerson == null || order.Salesperson.Equals(queryFilter.fSalesPerson))
                                select order).ToList();

    return result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T14:32:14.707

我发现[这个答案](http://forums.asp.net/t/1807316.aspx/1)是一个可能的解决方案，它基本上建议在 url 中将数据作为 JSON 传递并添加一个过滤器以将其转换为一个复杂的对象，但正如该帖子中的 OP 所暗示的那样，这不是最优雅的方式......任何人有更优雅的解决方案吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:41:21.183

URL 将以完全相同的方式工作，对象中的每个属性都有一个查询字符串参数。

# java - 使用 ClasspathSuite 进行参数化测试

> ID：10954348
> 
> 赞同：1
> 
> 时间：2012-06-08T18:39:50.160
> 
> 标签：java, junit4

我需要连续多次运行我的测试（4 次，我用 WebDriver 测试的每个浏览器一个）。我知道这是参数化测试的用例。但是，我正在使用`ClasspathSuite`，所以我似乎无法指定多个`@RunWith`注释。

有什么办法可以让我的测试多次运行并将某种参数（比如我需要的 4 次运行的 0 - 3）发送到测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T09:15:45.700

我刚面对这个，`ClasspathSuite`处理得很好。诀窍是在查找和启动测试的小虚拟项目中使用这些注释（跨其他项目）：

```
@RunWith(ClasspathSuite.class)
@SuiteTypes(RUN_WITH_CLASSES) 
```

然后任何需要特定跑步者的测试都直接使用该跑步者，例如`@RunWith(Parameterized.class)`

请参阅此处**的“运行其他 RunWith-Suites”**部分：[https ://github.com/takari/takari-cpsuite](https://github.com/takari/takari-cpsuite)

由于进行了广泛的测试，我选择使用所有选项：

```
@SuiteTypes({RUN_WITH_CLASSES, TEST_CLASSES, JUNIT38_TEST_CLASSES}) 
```

（默认似乎只是 TEST_CLASSES。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-11T17:17:58.867

解决方案：我对每个测试用例进行了相同的参数化（在 Eclipse 中使用 find an replace 为每个测试用例添加相同的代码。然后我设置了代码清理和格式化，因此当我运行它们时，它会将我的代码返回到一个漂亮的状态（因为我的插入都在一行上）

# css - CSS选择最近的后代？

> ID：10954359
> 
> 赞同：10
> 
> 时间：2012-06-08T18:40:26.370
> 
> 标签：css, css-selectors

使用 CSS，有没有办法选择与某个选择器匹配的元素最近的后代？

```
<div class="foo"> <!-- if we're inside this -->
  <div>
    <br />
    <div class="bar"> <!-- match this -->
      <div class="bar"> <!-- but not this -->
        <div class="bar"> <!-- or this -->
        </div>
      </div>
    </div>
    <div class="bar"> <!-- I don't really care whether we match this -->
    </div>
  </div>
</div> 
```

也就是说，可以`.bar`在 any中选择第一个`.foo`（无论中间有多少子元素或兄弟元素），但不会选择第二个或第三个`.bar`。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T19:08:20.167

这是我的 hacktastic 答案：http: [//jsfiddle.net/thirtydot/gqJdP/2/](http://jsfiddle.net/thirtydot/gqJdP/2/)

```
/*repeat for as many levels as there could be*/
.foo > .bar,
.foo > :not(.bar) > .bar,
.foo > :not(.bar) > :not(.bar) > .bar {
    border-color: blue;
}
.bar {
    border: 1px solid red;
    padding: 10px;
} 
```

从评论中引用我自己：

我的建议是可行的，尽管令人反感，*如果*`.foo`您可以对`.bar`您想要匹配的父母之间的可能数量设置上限。即使您必须重复选择器（比方说）10 次，也不算太糟糕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:46:21.663

不，没有办法*完全*使用 CSS 来完成您要求的事情。您可以选择`nth-child`或`nth-of-type`，但不能选择`the-nth-item-matching-this-selector`。

作为“证明”，请查看可用的 CSS3 选择器列表（涵盖 CSS1 和 CSS2.1 的所有功能）：
[http ://www.w3.org/TR/selectors/](http://www.w3.org/TR/selectors/)

您将需要使用 JavaScript（在客户端）或服务器端操作（例如，使用特殊类注释第一个此类项目）。

* * *

**编辑**：根据您的编辑，您可以执行以下操作：

```
.foo .bar      { font-weight:bold; color:red }
.foo .bar .bar { font-weight:normal; color:black } 
```

即，您需要明确“撤消”应用于将被继承的祖先的​​样式。这是“脆弱的”——如果你改变一个祖先的样式，你需要确保也改变相应的“覆盖”规则的值——但有效。

而且，如果@thirtydot 将他的 hack 作为答案发布，我们也都可以接受。

*尽管它可能无济于事，但请注意，您可以[使用 XPath](https://stackoverflow.com/questions/7665441/select-an-nth-matched-node-from-a-list-of-matching-nodes)实现此目标。*

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-06-08T19:05:44.517

这应该只得到第一个子元素`.foo`：

```
.foo > .bar 
```

并且不要选择更远的链条。

# windows - 触发后备列表

> ID：10954376
> 
> 赞同：0
> 
> 时间：2012-06-08T18:41:50.393
> 
> 标签：windows, visual-c++, memory-management, heap-memory, internals

我正在尝试让我的应用程序使用后备列表进行内存管理。我从有关此主题的各种论文中了解以下详细信息。

1.  后备列表位于堆基的偏移量 +0x688
2.  每个成员的长度为 48 个字节。
3.  lookasidelist[0],lookasidelist[1] 未使用。
4.  lookasidelist[n] 块大小为 n*8，用于存储 (n-1)*8 字节块（剩余 8 字节用于头部），偏移量 0 指向包含大小为 (n-1) 的空闲块的链表)*8 以 null 结尾。
5.  在 XP SP3 中默认启用后备列表，在 Vista/Win 7 系统中禁用（在 Vista/Win 7 中使用低碎片堆）

我面临的问题是我的应用程序似乎没有使用后备列表。似乎没有分配来自后备列表，并且所有释放的块都被移动到空闲列表。为了让应用程序使用后备列表，是否需要满足特定的编译器标志或条件？应用程序在 Microsoft Visual C++ 2010 速成版中编译，并在 Windows XP SP3 下进行测试。我正在使用免疫调试器来验证是否正在使用后备列表。如果有更好的方法请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T20:37:34.390

不是通过调试器运行进程，而是在运行时附加到进程显示应用程序决定在未调试时使用后备列表。[这](http://blogs.technet.com/b/askperf/archive/2007/06/29/what-a-heap-of-part-two.aspx)是我看到它记录的唯一地方。

> 堆管理器会在创建堆时自动创建后备列表，只要没有启用调试选项并且堆是可扩展的。

# iphone - 将照片保存到 iPhone 照片库中的自定义相册

> ID：10954380
> 
> 赞同：24
> 
> 时间：2012-06-08T18:42:09.860
> 
> 标签：iphone, objective-c, uiimage, uiimagepickercontroller, alassetslibrary

我正在尝试在 iPhone 的照片库中创建一个自定义相册，然后将我用相机拍摄的照片或从手机相机胶卷中选择的照片保存到该自定义相册。我可以成功创建相册，但照片没有保存在那里，而是保存到模拟器 Saved Photos 相册中......我不知道如何告诉我如何`UIImageWriteToSavedPhotosAlbum`保存到我刚刚创建的新相册中`addAssetsGroupAlbumWithName`。 ..

这是我到目前为止的代码 - 我已经剪掉了几个部分以保持我的代码示例简短......

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{     
  NSString *mediaType = [info objectForKey:UIImagePickerControllerMediaType];
  if([mediaType isEqualToString:(__bridge NSString *)kUTTypeImage])
  {        
    // pull GPS information from photos metadata using ALAssetsLibrary
    void (^ALAssetsLibraryAssetForURLResultBlock)(ALAsset *) = ^(ALAsset *asset)
    {
        // code snipped out 
    };
    NSURL *assetURL = [info objectForKey:UIImagePickerControllerReferenceURL];
    ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
    [library assetForURL:assetURL
             resultBlock:ALAssetsLibraryAssetForURLResultBlock
            failureBlock:^(NSError *error) 
            {
                // code snipped out
            }];

    // getimage from imagePicker and resize it to the max size of the iPhone screen 
    UIImage *originalImage = [info objectForKey:UIImagePickerControllerOriginalImage]; 
    UIImage *resizedImage = [util_ createThumbnailForImage:originalImage thumbnailSize:[util_ determineIPhoneScreenSize]];
    NSData *imageData = UIImagePNGRepresentation(resizedImage);

                // code snipped out
                // code snipped out
                // code snipped out
                // code snipped out
                // code snipped out
                // code snipped out

    // create a new album called "My Apps Photos"
    [library addAssetsGroupAlbumWithName:@"My Apps Photos"
            resultBlock:^(ALAssetsGroup *group) 
            {
                NSLog(@"in addAssetsGroupAlbumWithName resultBlock");

                // save file to album
                UIImageWriteToSavedPhotosAlbum(resizedImage, self, nil, nil);

            } 
            failureBlock:^(NSError *error) 
            {
                NSLog(@"in addAssetsGroupAlbumWithName failureBlock");

            }
     ];
  }
} 
```

所以...就像我说的那样，它会创建新相册，但不会将照片保存在那里。我如何告诉它保存到新专辑中？也许我听起来不使用`UIImageWriteToSavedPhotosAlbum`？？

注意：我使用的是 Xcode 4.3.2、IOS 5.1 和 ARC

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-12-05T00:04:46.100

如果您使用的是 iOS6，Fernando 的回答将不起作用，因为 saveImage 选择器不再可用。

这个过程非常混乱，我还没有看到任何明确的答案，所以这是我在 iOS6 中用来解决这个问题的方法。

您将需要使用以下组合：

**创建相册：**

```
[self.library addAssetsGroupAlbumWithName:albumName 
                              resultBlock:^(ALAssetsGroup *group) {
         NSLog(@"added album:%@", albumName);
}
                             failureBlock:^(NSError *error) {
         NSLog(@"error adding album");
}]; 
```

**查找专辑：**

```
__block ALAssetsGroup* groupToAddTo;
[self.library enumerateGroupsWithTypes:ALAssetsGroupAlbum
                             usingBlock:^(ALAssetsGroup *group, BOOL *stop) {
      if ([[group valueForProperty:ALAssetsGroupPropertyName] isEqualToString:albumName]) {
          NSLog(@"found album %@", albumName);
          groupToAddTo = group;
      }
}
                           failureBlock:^(NSError* error) {
     NSLog(@"failed to enumerate albums:\nError: %@", [error localizedDescription]);
}]; 
```

**将图片保存到资源库，并放入相册：**

```
CGImageRef img = [image CGImage];
[self.library writeImageToSavedPhotosAlbum:img
                                  metadata:[info objectForKey:UIImagePickerControllerMediaMetadata]
                           completionBlock:^(NSURL* assetURL, NSError* error) {
     if (error.code == 0) {
         NSLog(@"saved image completed:\nurl: %@", assetURL);

         // try to get the asset
         [self.library assetForURL:assetURL
                       resultBlock:^(ALAsset *asset) {
              // assign the photo to the album
              [groupToAddTo addAsset:asset];
              NSLog(@"Added %@ to %@", [[asset defaultRepresentation] filename], albumName);
          }
                      failureBlock:^(NSError* error) {
              NSLog(@"failed to retrieve image asset:\nError: %@ ", [error localizedDescription]);
          }];
     }
     else {
         NSLog(@"saved image failed.\nerror code %i\n%@", error.code, [error localizedDescription]);
     }
 }]; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-05T17:26:00.260

Fernando 的回答在 iOS 7 中对我有用。

脚步 ：

1) 从此处下载 ALAssetsLibrary+CustomPhotoAlbum 代码：[​​http://www.touch-code-magazine.com/wp-content/uploads/2011/11/ALAssetsLibrary_CustomPhotoAlbum.zip?a071b6](http://www.touch-code-magazine.com/wp-content/uploads/2011/11/ALAssetsLibrary_CustomPhotoAlbum.zip?a071b6) 并复制您的类别中的 2 个文件Xcode 项目。

2）在你的头文件中，添加以下行

```
#import <AssetsLibrary/AssetsLibrary.h>
#import "ALAssetsLibrary+CustomPhotoAlbum.h"

@property (strong, atomic) ALAssetsLibrary* library; 
```

3）在您的实现文件中，添加以下行

```
@synthesize library=_library; 
```

**编辑**：4）初始化资产库实例，最好在“viewDidLoad”方法中，否则下面的saveImage方法将不会执行。*（**确认**）：*

[我正在重新提交建议的编辑，因为非 iphone 技能的人拒绝了之前的提交。这无疑是@santhu & Fernando 的一个很好的答案，对我帮助很大，但是，初始化代码片段丢失了，所以我花了一些时间来弄清楚为什么代码不起作用。因此，如果具有 iPhone 开发技能的版主审核编辑，我将不胜感激。]

```
_library = [[ALAssetsLibrary alloc] init]; 
```

5）将其添加到您要保存的方法中

```
 //Add this in the method where you wish to save
  [self.library saveImage:(UIImage *) toAlbum:(NSString *) withCompletionBlock:^(NSError                 *error) {
    if (error!=nil) {
        NSLog(@"Big error: %@", [error description]);
    }
}]; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-11-10T11:01:00.580

对于 swift 用户：- 我做了同样的事情。

*声明闭包超大类定义（高于类定义）*

```
typealias CompletionHandler = (success:Bool!) -> Void 
```

*在类中声明库变量*

```
var library:ALAssetsLibrary?; 
```

*在 viewDidLoad 中初始化变量*

```
library = ALAssetsLibrary(); 
```

*将图像添加到特定相册的方法*

```
func addImage(image:UIImage, metaData:NSDictionary, toAlbum albumName:String, handler:CompletionHandler){

    library?.addAssetsGroupAlbumWithName(albumName, resultBlock: {(group:ALAssetsGroup!) -> Void in
        print("\nAlbum Created:=  \(albumName)");
        /*-- Find Group --*/

        var groupToAddTo:ALAssetsGroup?;

        self.library?.enumerateGroupsWithTypes(ALAssetsGroupType(ALAssetsGroupAlbum),
            usingBlock: { (group:ALAssetsGroup?, stop:UnsafeMutablePointer<ObjCBool>) -> Void in

                if(group != nil){

                    if group!.valueForProperty(ALAssetsGroupPropertyName) as String == albumName{
                        groupToAddTo = group;

                        print("\nGroup Found \(group!.valueForProperty(ALAssetsGroupPropertyName))\n");

                        self.library?.writeImageToSavedPhotosAlbum(image.CGImage, metadata:metaData, completionBlock: {(assetURL:NSURL!,error:NSError!) -> Void in

                            if(error == nil){
                                self.library?.assetForURL(assetURL,
                                    resultBlock: { (asset:ALAsset!) -> Void in
                                        var yes:Bool? = groupToAddTo?.addAsset(asset);
                                        if (yes == true){
                                            handler(success: true);
                                        }
                                    },
                                    failureBlock: { (error2:NSError!) -> Void in
                                        print("Failed to add asset");
                                        handler(success: false);
                                });
                            }
                        });
                    }
                } /*Group Is Not nil*/
            },
            failureBlock: { (error:NSError!) -> Void in
                print("Failed to find group");
                handler(success: false);
        });

        }, failureBlock: { (error:NSError!) -> Void in
            print("Failed to create \(error)");
            handler(success: false);
    });
} 
```

*将此方法称为：--*

```
func imagePickerController(picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [NSObject : AnyObject]){

    var image:UIImage = info[UIImagePickerControllerOriginalImage] as UIImage;
    var metadata:NSDictionary = info[UIImagePickerControllerMediaMetadata] as NSDictionary;

    self.addImage(image, metaData: metadata, toAlbum: "SwiftAlbum") { (success) -> Void in
        print("Image Added : \(success)");
    }

    picker.dismissViewControllerAnimated(true, completion: nil);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-06T14:11:54.663

@Scott Allen 的代码很接近，但第一次不会为我保存图像。因此，如果我还没有创建相册，图像将不会保存。我的解决方案是将创建专辑的这个片段移动到应用程序委托 didFinishLaunchingWithOptions：

```
 NSString *albumName=@"album name";
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
[library addAssetsGroupAlbumWithName:albumName
                         resultBlock:^(ALAssetsGroup *group) {
                             NSLog(@"added album:%@", albumName);
                         }
                        failureBlock:^(NSError *error) {
                            NSLog(@"error adding album");
                        }]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-15T21:16:06.860

我还没有看到这些问题的真正明确的答案和代码。对我来说，我想确保在打开相机之前找到或创建了专辑。这段代码似乎是正确的，我认为它更干净，更容易窃取^H^H^H^H^Hstart。

```
// find or create our photo album.  If either works
// we fire up the camera. Crazy asynchronous code here.

__weak PhotoVC *weakSelf = self;
__block BOOL found = NO;

ALAssetsLibraryGroupsEnumerationResultsBlock
assetGroupEnumerator = ^(ALAssetsGroup *group, BOOL *stop){
    if (group) {
        NSString *thisGroup = [group valueForProperty:ALAssetsGroupPropertyName];
        if ([album isEqualToString:thisGroup]) {
            NSLog(@"album found!");
            [weakSelf startCamera: group];
            *stop = YES;
            found = YES;
        }
    } else { // not found, create the album
        if (found)
            return;
        NSLog(@"album not found, try making album");

        ALAssetsLibraryGroupResultBlock addGroup =
        ^(ALAssetsGroup *group){
            NSLog(@"album created");
            [weakSelf startCamera: group];
        };

        ALAssetsLibraryAccessFailureBlock addGroupFailed =
        ^(NSError *err){
            NSLog(@"add group failed: %@", [err localizedDescription]);
        };

        [library addAssetsGroupAlbumWithName:album resultBlock:addGroup failureBlock:addGroupFailed];
    }
};

[library enumerateGroupsWithTypes:ALAssetsGroupAlbum
                       usingBlock:assetGroupEnumerator
                     failureBlock:^(NSError *error) {
                         NSLog(@"album access denied");
                     }]; 
```

汤姆达夫定律：尽可能窃取代码。

# xmpp - user1 (admin) 如何从 user2 向用户 3 提交出席信息订阅请求

> ID：10954382
> 
> 赞同：0
> 
> 时间：2012-06-08T18:42:40.507
> 
> 标签：xmpp, ejabberd

我希望这是可能的，因为我在网络上或 XMPP/ejabberd 文档中的任何地方都找不到它：我运行 ejabberd 并希望 user1（管理员帐户）能够将出席信息订阅请求推送给 user3这似乎来自user2。出于安全原因，我将 user1 指定为有权执行此操作的用户。这可能吗？你能给我任何指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T09:26:56.333

它可以通过 Ejabberd 数据库进行管理。

配置 Ejabberd 以与外部数据库（mysql 或`mssql`）进行通信。

在任何服务器端程序中创建动态网页。在 ejabberd 上使用 admin 登录并更改外部数据库中的 rosterusers 表。

默认情况下，Ejabberd 使用`mnesia`数据库。您可以使用`mssql`或对其进行配置`mysql`。

对于 mssql ：

[http://www.ejabberd.im/mssql](http://www.ejabberd.im/mssql)

# c# - 网络流和多个连接

> ID：10954383
> 
> 赞同：1
> 
> 时间：2012-06-08T18:42:54.347
> 
> 标签：c#, tcp, xna, networkstream

我正在为我和朋友正在创建的 XNA 游戏编写 Tcp 服务器，我想知道您如何发送到使用 NetworkStream 连接到服务器的特定客户端。例如，您可以获取主机的玩家位置并将其发送到服务器，服务器将其发送到其他连接的客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:28:19.853

您需要阅读以下内容：

这应该让你开始：

1.  [Tcp监听器](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)
2.  [TcpClient](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.aspx)

您的服务器将需要有一个`TcpListener`. 如果要支持多个客户端，请创建客户端列表。您将为`TcpClient`每个连接的客户端获得一个。`NetworkStream`从这些客户端中的每一个上读取数据。当您收到其中一个的数据时，将其发送给其他人。

您将需要定义某种协议，以便知道来自客户端的消息何时完成并且可以提前发送。

# python - 在 tkinter 中动态添加和删除列表框

> ID：10954386
> 
> 赞同：0
> 
> 时间：2012-06-08T18:42:55.883
> 
> 标签：python, tkinter

所以，我对如何在 Tkinter 中做某事更加好奇。这不是必需的，但我有点想实现它。无论如何，我想要做的是，选择Apselect ListBox中的一个项目时，我想创建一个或两个多个listbox，然后从文件中填充来自数据的数据（用于简单缘故，让我们只是从预设中说出它列表。）除此之外，如果在 apSelect 中选择了不同的条目，我希望它们消失。另一件事是抓取在这些动态列表框中选择的任何数据（假设它们存在）。这是使用 Tkinter 的代码。真正唯一重要的部分是**init_**方法（​​这可能是我可以为动态生成设置的地方）和 generate 方法（我需要提取数据的地方）。

```
class App:
    def __init__(self, master):
        dateFrame= Frame(master)
        dateFrame.pack()
        apSelectFrame = Frame(master)
        apSelectFrame.pack()
        entryFrame = Frame(master)
        entryFrame.pack()
        buttonFrame = Frame(master)
        buttonFrame.pack()

        Label(dateFrame, text="Period:").grid(row=0)
        self.period = Entry(dateFrame)
        self.period.grid(row=0, column=1)
        Label(dateFrame, text="Year:").grid(row=1)
        self.year = Entry(dateFrame)
        self.year.grid(row=1, column=1)

        Label(apSelectFrame, text="Select Report Type:").grid(row=0)
        self.apSelect = Listbox(apSelectFrame, selectmode=SINGLE, height=3)
        self.apSelect.grid(row=1)
        for item in ["Artists", "Publishers", "Both"]:
            self.apSelect.insert(END, item)
        self.allTheThings = IntVar()
        self.checkAll = Checkbutton(apSelectFrame, text="All?", variable=self.allTheThings)
        self.checkAll.grid(row=1, column=1)

        Label(entryFrame, text="Client Name: ").grid(row=0)
        self.client = Entry(entryFrame)
        self.client.grid(row=0, column=1)
        Label(entryFrame, text="Publisher Name: ").grid(row=1)
        self.pub = Entry(entryFrame)
        self.pub.grid(row=1, column=1)

        self.generateBt = Button(buttonFrame, text="Generate!", command=self.generate)
        self.generateBt.pack(side=LEFT)
        self.resetBt = Button(buttonFrame, text="Reset!", command=self.reset)
        self.resetBt.pack(side=LEFT)
        self.quitBt = Button(buttonFrame, text="Quit!", fg="red", command=buttonFrame.quit)
        self.quitBt.pack(side=LEFT)

    def fileChecker(self, filename):
        if(not os.path.isfile(filename)):
            return "Missing file: "+filename+"\n"

    def checkForFiles(self, srFilename):
        errorFlag = False
        errorReport = []    
        errorReport.append(self.fileChecker("albums.csv"))
        errorReport.append(self.fileChecker("clients.csv"))
        errorReport.append(self.fileChecker("composition_copyright_holders.csv"))
        errorReport.append(self.fileChecker("compositions.csv"))
        errorReport.append(self.fileChecker("copyright_holders.csv"))
        errorReport.append(self.fileChecker("track_compositions.csv"))
        #errorReport.append(self.fileChecker("track_copyright_holders.csv"))
        errorReport.append(self.fileChecker("tracks.csv"))
        errorReport.append(self.fileChecker("copyright_holders_previously_owed.csv"))
        errorReport.append(self.fileChecker("artist_override.csv"))
        errorReport.append(self.fileChecker(srFilename))
        if(errorFlag):
            tkMessageBox.showerror("Error",
                "Either select all or enter publisher name!")
        else:
            return

    def generate(self):
        #TODO File checker
        month = self.period.get()
        #month = 'q1'
        year = self.year.get()
        #year = '2012'
        clname = self.client.get()
        pubname = self.pub.get()
        report_type = self.apSelect.curselection()
        #report_type = '1'
        allTheThings = self.allTheThings.get()
        #allTheThings = True
        if len(month)==0:
            tkMessageBox.showerror("Error",
                "You forgot to enter a period!")
            return
        if len(year)==0:
            tkMessageBox.showerror("Error",
                "You forgot to enter a year!")
            return
        if len(report_type)==0:
            tkMessageBox.showerror("Error",
                "You forgot to select a report type!")
            return
        if report_type[0]=='0' and allTheThings==0 and clname=="":
            tkMessageBox.showerror("Error",
                "Either select all or enter a client name!")
            return
        if report_type[0]=='1' and allTheThings==0 and pubname=="":
            tkMessageBox.showerror("Error",
                "Either select all or enter publisher name!")
            return
        if report_type[0]=='2' and allTheThings==0 and clname=="" and pubname=="":
            tkMessageBox.showerror("Error",
                "Either select all or enter a client and publisher name!")
            return
        if(not os.path.exists("reports")):
            os.makedirs("reports")
        if(not os.path.exists('reports/'+month+'_'+year+'')):
            os.makedirs('reports/'+month+'_'+year)
        if(not os.path.exists('reports/'+month+'_'+year+'/artists')):
            os.makedirs('reports/'+month+'_'+year+'/artists')
        if(not os.path.exists('reports/'+month+'_'+year+'/publishers')):
            os.makedirs('reports/'+month+'_'+year+'/publishers')
        if(not os.path.exists('reports/'+month+'_'+year+'/artists/empty')):
            os.makedirs('reports/'+month+'_'+year+'/artists/empty')
        if(not os.path.exists('reports/'+month+'_'+year+'/publishers/empty')):
            os.makedirs('reports/'+month+'_'+year+'/publishers/empty')
        srFilename="sr1_"+month+"_"+year+".csv"
        self.checkForFiles(srFilename)
        tester=ACR_CALC()
        tester.calc(month, year, clname, pubname, report_type, allTheThings,srFilename)

    def reset(self):
        print "RESETING!"
        self.period.delete(0, END)
        self.year.delete(0, END)
        self.allTheThings.set(0)
        self.client.delete(0, END)
        self.pub.delete(0, END)
        self.apSelect.select_clear(0,END)

root = Tk()
app = App(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:55:55.410

使用网格几何管理器，您可以轻松地让小部件在给定事件上出现/消失，就像我在下面的示例中所做的那样。

`pack`有一个类似的`pack_forget`方法，但我想如果它不局限于固定的专用框架，让你的小部件消失/重新出现在同一个地方可能会有点困难。

此代码中的小部件会在按下按钮时出现/消失，但如果您了解如何在 Tkinter 中绑定事件（查找`bind`方法了解更多信息）。

```
import Tkinter as tk

class App(tk.Frame):
    def __init__(self,master):
        tk.Frame.__init__(self,master)
        self.b=tk.Button(self,text='hide',command=self.hide)
        self.lbl=tk.Label(self,text="This is a label you can hide")
        self.b.grid(row=0,column=0)
        self.lbl.grid(row=0,column=1)

    def hide(self):
        self.lbl.grid_forget()
        self.b.config(command=self.show,text='show')

    def show(self):
        self.lbl.grid(row=0,column=1)
        self.b.config(command=self.hide,text='hide')

if __name__ == '__main__':
    root = tk.Tk()
    f=App(root)
    f.grid(row=0,column=0)
    root.mainloop() 
```

我不完全确定我已经在这里回答了整个问题-您的问题有很多需要整理...如果您还有其他问题，请告诉我...

# java - PixelGrabber 和 getRGB 哪个更快？

> ID：10954389
> 
> 赞同：1
> 
> 时间：2012-06-08T18:43:17.493
> 
> 标签：java, performance, image, java-2d

我试图通过抓取图像的像素来在图像上实现[希尔密码算法。](http://en.wikipedia.org/wiki/Hill_cipher)事实证明，小图像加载良好。

但是对于更大的图像（8MP 或 12MP），加载速度很慢；结果写入图像也很慢。

我使用 抓取每个像素`bufferedImage.getRGB(x,y)`，使用算法对其进行修改，并同时使用`bufferedImage.setRGB(x,y,rgb)`.

现在，我需要一些建议来加快加载/写入速度。我想知道是否`PixelGrabber`会更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:56:44.950

getRGB/setRGB**非常慢**，因为每次调用它们时它们都会进行大量颜色空间检查和颜色转换。考虑到典型图像中的像素数量，绝对不是任何图像处理的方法。

通过旧的 PixelGrabber 或通过 BufferedImage.getRaster() 将原始图像数据放入数组更难（您必须了解一些概念）但运行速度更快。

# objective-c - 从 NSString 填充 NSMutableArray

> ID：10954391
> 
> 赞同：-2
> 
> 时间：2012-06-08T18:43:21.997
> 
> 标签：objective-c, xcode

如果我有这个字符串：

```
NSString *fileContent = [[NSString alloc] initWithContentsOfFile:groupPath]; 
```

...具有以下内容（来自路径）：

A B C D，

...如何使用上述对象填充数组？

我试过了：

```
 self.itemArray = [[NSMutableArray alloc]init];

[itemArray initWithObjects:fileContent, nil]; 
```

...目的是获得：

```
[itemArray initWithObjects:a, b, c, d, nil]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:49:38.380

如果字符串是用 分隔的`", "`，那么[`componentsSeparatedByString:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/componentsSeparatedByString%3a)in 的方法`NSString`就是你想要的。所以你会有类似的东西：

```
NSMutableArray* array = [[NSMutableArray alloc] initWithArray:[fileContent componentsSeparatedByString:@", "]];
self.itemArray = array;
[array release]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:45:32.990

用“,”分割字符串并创建该数组的可变副本。

# c++ - 使用 boost::asio::read_async 读取 Protobuf 对象

> ID：10954392
> 
> 赞同：8
> 
> 时间：2012-06-08T18:43:29.250
> 
> 标签：c++, boost-asio, protocol-buffers

我正在使用 Boost asio 编写一个应用程序，其中客户端和服务器交换使用 google proto-buffers 序列化的消息。我不知道通过网络发送的序列化消息的大小。proto-buf 对象似乎没有任何分隔符。

这是 .proto 文件的内容。

```
 package tutorial;

message Person {
        required string name = 1;
        required int32 id = 2;
        optional string email = 3;
} 
```

这是我从服务器写入的方式

```
 tutorial::Person p;
        p.set_name("abcd pqrs");
        p.set_id(123456);
        p.set_email("abcdpqrs@gmail.com");
        write(p);

        boost::asio::streambuf b;
        std::ostream os(&b);
        p.SerializeToOstream(&os);
        boost::asio::async_write(socket_, b,
                        boost::bind(&Server::handle_write, this,
                                boost::asio::placeholders::error)); 
```

在客户端中，我正在阅读上面使用 boost::asio::async_read 发送的消息。如何在下面的代码中找出`arg`被设置为参数的值`boost::asio::transfer_at_least`？

```
 boost::asio::async_read(socket_, response_,
                            boost::asio::transfer_at_least(arg),
                            boost::bind(&Client::handle_read_header, this,
                                    boost::asio::placeholders::error)); 
```

否则我如何确保 boost::async_read 在读取整个对象后返回？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:44:56.867

正确，protobuf 没有分隔。不知道消息从字节流结束的地方——即使你已经看过所有你知道的字段，也可能有更多重复的元素，或者有人用你不知道的字段扩展了原型。

一个常见的解决方案是在帧前加上长度（通常编码为`VarInt`s）。 [例如， LevelDB](http://code.google.com/p/leveldb/source/browse/util/coding.cc)和[Szl](http://code.google.com/p/szl/source/browse/trunk/src/utilities/recordio.cc)都使用这种方法。A`VarInt`可以逐字节明确解码，然后您就知道在解析完整消息之前还要读取多少字节。

# c - 何时复制填充字节 - 结构赋值，按值传递，其他？

> ID：10954393
> 
> 赞同：5
> 
> 时间：2012-06-08T18:43:31.103
> 
> 标签：c, struct, padding, memory-alignment

在调试问题时，出现了以下问题。（请忽略小代码错误；代码仅用于说明。）

定义了以下结构：

```
typedef struct box_t {
  uint32_t x;
  uint16_t y;
} box_t; 
```

这个结构的实例是按值从一个函数传递到另一个函数（显然是简化的）：

```
void fun_a(box_t b)
{
    ... use b ...
}

void fun_b(box_t bb)
{
    // pass bb by value
    int err = funa(bb);
}

void fun_c(void)
{
    box_t real_b;
    box_t some_b[10];
    ...
    ... use real_b and some_b[]  ...
    ...
    funb(real_b);
    funb(some_b[3]);
    ...
    box_t copy_b = some_b[5];
    ...
} 
```

在某些情况下，box_t 的两个实例是这样比较的：

```
 memcmp(bm, bn, sizeof(box_t)); 
```

在几个嵌套调用中，box_t arg 的字节使用如下方式转储：

```
char *p = (char*) &a_box_t_arg;
for (i=0; i < sizeof(box_t); i++) {
    printf(" %02X", *p & 0xFF);
    p++;
}
printf("\n"); 
```

sizeof(box_t) 为 8；有 2 个填充字节（发现在 uint16_t 之后）。转储显示结构的字段相等，但填充字节不相等；这导致 memcmp 失败（不足为奇）。

有趣的部分是发现“损坏的”焊盘值来自何处。往回追踪后发现，一些 box_t 实例被声明为局部变量，并像这样初始化：

```
box_t b;
b.x = 1;
b.y = 2; 
```

上面没有（似乎）初始化填充字节，填充字节似乎包含“垃圾”（无论在为 b 分配的堆栈空间中是什么）。在大多数情况下，初始化是使用`memset(b, 0, sizeof(box_t))`.

问题是通过 (1) 结构赋值或 (2) 通过值传递来初始化 box_t 的实例是否总是等同于 sizeof(box_t) 的 memcpy。是否只复制了“真实字段”的 6 个字节（而不是填充字节）。

从调试看来，memcpy sizeof(box_t) 等效项总是完成。是否有任何东西（例如，在标准中）实际指定了这一点？随着调试的进行，了解在处理填充字节方面可以依靠什么会很有帮助。

谢谢！（在 Ubuntu LTS 10.4 64 位上使用 GCC 4.4.3）

对于奖励积分：

```
void f(void)
{
    box_t ba;
    box_t bb;
    box_t bc; 
```

这 3 个实例被分配了 16 个字节，而 sizeof() 显示为 8。为什么会有额外的空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T18:58:14.393

填充字节的值未指定（C99/C11 6.2.6.1 §6）：

> 当一个值存储在结构或联合类型的对象中时，包括在成员对象中，对应于任何填充字节的对象表示的字节采用未指定的值。

另见脚注 42/51（C99:TC3，C1x 草案）：

> 因此，例如，结构分配不需要复制任何填充位。

编译器可以自由复制或不复制它认为合适的填充。在 x86[1] 上，我的猜测是 2 个尾随填充字节将被复制，但 4 个字节不会（即使在 32 位硬件上也可能发生，因为结构可能需要 8 字节对齐，例如允许原子读取`double`值）。

[1]*未进行实际测量。*

* * *

*扩展答案：*

该标准不保证*涉及*填充字节。但是，如果您使用静态存储持续时间初始化对象，那么您最终会得到零填充的可能性很高。但是，如果您使用该对象通过赋值来初始化另一个对象，那么所有的赌注都会再次关闭（我希望尾随的填充字节 - 再次，没有进行测量 - 是特别好的候选者，可以从复制中省略）。

使用`memset()`and `memcpy()`- 即使分配给单个成员，因为这也会使填充无效 - 是一种在合理实现上保证填充字节值的方法。但是，原则上，编译器可以随时“在你背后”随意更改填充值（这*可能*与寄存器中的缓存成员有关——再次疯狂猜测），你可以通过使用`volatile`存储来避免这种情况。

我能想到的*唯一*合理可移植的解决方法是通过引入适当大小的虚拟成员来明确指定内存布局，同时使用特定于编译器的验证意味着没有引入额外的填充（`__attribute__ ((packed))`对于`-Wpadded`gcc）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T19:31:38.753

C11 将允许您定义匿名结构和联合成员：

```
typedef union box_t {
  unsigned char allBytes[theSizeOfIt];
  struct {
    uint32_t x;
    uint16_t y;
  };
} box_t; 
```

该联合的行为几乎与以前相同，您可以访问`.x`等，但默认初始化和分配会改变。如果您始终确保您的变量像这样正确初始化：

```
box_t real_b = { 0 }; 
```

或者像这样

```
box_t real_a = { .allBytes = {0}, .x = 1, .y = 2 }; 
```

所有填充字节都应正确初始化为`0`. *如果您的整数类型有填充位*，这将无济于事，但至少`uintXX_t`您选择的类型不会有它们的定义。

gcc 和追随者已经将其作为扩展实现，即使它们尚未完全 C11。

**编辑：**在[P99](http://p99.gforge.inria.fr/)中有一个宏可以以一致的方式执行此操作：

```
#define P99_DEFINE_UNION(NAME, ...)                     \
 union NAME {                                           \
   uint8_t p00_allbytes[sizeof(union { __VA_ARGS__ })]; \
   __VA_ARGS__                                          \
 } 
```

也就是说，数组的大小是通过仅针对其大小声明一个“未标记”联合来确定的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T21:25:11.717

正如克里斯托夫所说，没有关于填充的保证。你最好的选择是不要`memcmp`用来比较两个结构。它在错误的抽象级别上工作。`memcmp`在表示中按字节工作，而您需要比较成员的值。

最好使用单独的比较函数，该函数采用两个结构并分别比较每个成员。像这样的东西：

```
int box_isequal (box_t bm, box_t bn)
{
    return (bm.x == bn.x) && (bm.y == bn.y);
} 
```

为了您的奖励，这三个对象是独立的对象，它们不是同一个数组的一部分，并且它们之间的指针算术是不允许的。作为函数局部变量，它们通常分配在堆栈上，并且由于它们是独立的，编译器可以以任何最佳方式对齐它们，例如为了性能。

# mysql - MYSQL：使用时间戳列和分组选择时间范围

> ID：10954394
> 
> 赞同：0
> 
> 时间：2012-06-08T18:43:42.860
> 
> 标签：mysql, select, timestamp, duration

我有一张这样的桌子：

```
CREATE TABLE `hoststatus` (
  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `host` varchar(100) NOT NULL,
  `result` tinyint(1) NOT NULL,
  PRIMARY KEY (`timestamp`,`host`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `hoststatus` (`timestamp`, `host`, `result`) VALUES
('2012-06-08 14:18:01', 'host1', 0),
('2012-06-08 14:19:01', 'host1', 0),
('2012-06-08 14:20:01', 'host1', 1),
('2012-06-08 14:21:01', 'host1', 1),
('2012-06-08 14:22:01', 'host1', 1),
('2012-06-08 14:23:01', 'host1', 1),
('2012-06-08 14:24:01', 'host1', 0),
('2012-06-08 14:25:01', 'host1', 0),
('2012-06-08 14:26:01', 'host1', 0),
('2012-06-08 14:27:01', 'host1', 0),
('2012-06-08 14:28:01', 'host1', 1),
('2012-06-08 14:29:01', 'host1', 1),
('2012-06-08 14:29:04', 'host2', 0),
('2012-06-08 14:30:01', 'host1', 0),
('2012-06-08 14:30:03', 'host2', 0),
('2012-06-08 14:31:01', 'host1', 0),
('2012-06-08 14:32:01', 'host1', 0),
('2012-06-08 14:32:02', 'host2', 1),
('2012-06-08 14:33:01', 'host1', 0); 
```

这包含一些主机的连接状态：1 表示“离线”，0 表示“在线”。我想使用选择请求推断的是每个主机的每个“离线”状态的开始和结束时间戳。在上面的示例中，请求应返回如下内容：

```
begin                  end                     host
'2012-06-08 14:20:01'  '2012-06-08 14:23:01'   'host1'
'2012-06-08 14:28:01'  '2012-06-08 14:29:01'   'host1'
'2012-06-08 14:32:02'  '2012-06-08 14:32:02'   'host2' 
```

有人可以给我解决这个问题的方法吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:18:10.927

您实际上是在尝试在数据中找到“运行”或“条纹”。[这个答案](https://stackoverflow.com/questions/10840119/calculate-run-or-streak-across-years-in-mysql)可能会为您提供一些关于如何完成任务的指导。

编辑：针对您的具体问题，链接的答案可以翻译为以下内容：

```
SELECT
    host,
    MIN(ts) as StartDate, 
    MAX(ts) as EndDate
FROM (
    SELECT
        ts,
        host,
        result,
        (   SELECT
                COUNT(*) 
            FROM
                hoststatus h2 
            WHERE
                h1.host = h2.host
                and h1.result <> h2.result
                and h2.ts >= h1.ts) as rungroup
    FROM
        hoststatus h1) A
WHERE result = 1
GROUP BY host, rungroup
ORDER BY rungroup desc; 
```

# jquery - 转换为 JSON 时忽略 null 属性

> ID：10954397
> 
> 赞同：2
> 
> 时间：2012-06-08T18:43:55.330
> 
> 标签：jquery, json, asmx

我有一个问题似乎很容易，但结果却是一个非常难的问题。

我写了这样的东西

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
[System.Web.Script.Services.ScriptService]
public class UIService : System.Web.Services.WebService
{

public UIService () {

    //Uncomment the following line if using designed components 
    //InitializeComponent(); 
}

[WebMethod(EnableSession=true)]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
[System.Security.Permissions.PrincipalPermission(System.Security.Permissions.SecurityAction.Demand, Authenticated = true)]
public Accordion ConstructAccordian(string accordionId)
{
    Accordion result = new Accordion();
    result.Name = "MenuAccordion";
    AccordionItem item1 = new AccordionItem("Test");
    item1.Items.Add(new MenuItem("User", "UserList"));
    item1.Items.Add(new MenuItem("OnlineUser", "OnlineUser"));        
    result.Items.Add(item1);

    return result;

}

function get(url, pdata, func) {
var msg = "Exception";

$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: url,
    data: JSON.stringify(pdata),
    dataType: "json",
    async: true,
    success: function (data, textStatus) {
        if (textStatus == "success") {

            if (data.hasOwnProperty('d')) {
                msg = data.d;

            } else {
                msg = data;
            }
            func(msg);
        }

    },
    error: function (data, textStatus) {
        get(MEMBERSHIP_SERVICE_AUTHCHCK_URL, {}, function (msg) {
            if (msg.error == true) {
                window.location = PORTAL_LOGIN_URL;
            }
            else {
                get(url, pdata, func);
            }
        });
    }
});
} 
```

它工作正常。但是当手风琴中的属性为空时。该属性出现在 JSON 字符串中，其值为 null。我希望 System.Web.Script.Services.ScriptService 使用的 JavaScriptSerializer 忽略空属性，因此不在 json 字符串中生成它们。我搜索了很多，我认为 JavaScriptSerializer 不能做到这一点。是否有一种简单的方法来更改 JavaScriptSerializer，例如使用 JSON.net 作为 ScriptService 的默认格式器，或者在序列化为 JSON 时如何忽略生成空属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T05:39:48.440

1.  [使用来自http://json.org/](http://json.org/)的C# 库将对象转换为 json 字符串
2.  从服务器发送 json 字符串。
3.  在客户端使用 var obj = $.parseJSON(jsonString);

# javascript - 确定 JavaScript 中缓存的 DOM 元素的内存使用情况？

> ID：10954399
> 
> 赞同：9
> 
> 时间：2012-06-08T18:44:11.997
> 
> 标签：javascript, dom, memory, profiling

假设我编写了一些 JavaScript 代码，将数据库中的前十条记录显示为表格行元素。当用户单击以加载更多行时，表格行元素将从页面中删除，但保存在 Javascript 中。

现在，假设我有一个类似的页面，一次显示 100 行，并且用户可能会翻阅数千行。

当这些元素缓存在 Javascript 中时，我如何知道使用了多少内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:46:04.177

使用 Chrome 的内存分析器：[https ://developers.google.com/chrome-developer-tools/docs/heap-profiling](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)

它具有您对此类分析所期望的所有功能。

# android - 调整 BitmapFactory.decodeByteArray() 生成的图像大小

> ID：10954401
> 
> 赞同：4
> 
> 时间：2012-06-08T18:44:17.280
> 
> 标签：android, image-resizing, bitmapfactory

我正在创建音频播放器，我想向播放器显示歌曲封面，它使用小图像但如果 mp3 文件有大图像，那么它会超出布局视图。我正在使用以下代码将图像大小调整为 300x300：

```
BitmapFactory.Options opt = new BitmapFactory.Options();
opt.inDensity = 300;
opt.inTargetDensity = 300;

songCoverView.setImageBitmap(BitmapFactory.decodeByteArray(songCover, 0, songCover.length, opt)); 
```

但它仍然显示更大并且超出布局。

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T13:28:50.013

事实证明，Android 中存在一个错误：decodeByteArray 以某种方式忽略了一些输入选项。一个已知的解决方法是使用 decodeStream 并将输入数组包装到 ByteArrayInputStream 中，如下所示：

```
BitmapFactory.Options opt = new BitmapFactory.Options();
opt.inDensity = 300;
opt.inTargetDensity = 300;

songCoverView.setImageBitmap(BitmapFactory.decodeStream(new ByteArrayInputStream(songConver), null, opt)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-09T03:25:53.103

尝试[Bitmap.createScaledBitmap](http://developer.android.com/reference/android/graphics/Bitmap.html#createScaledBitmap)

`bitmap = Bitmap.createScaledBitmap(songCover, 300, 300, true);`

您可以为旧图像保持相同的纵横比......我使用以下逻辑：

```
 int width  = songCover.getWidth();
        int height = songCover.getHeight();
        float scaleHeight = (float)height/(float)300;
        float scaleWidth  = (float)width /(float)300;
        if (scaleWidth < scaleHeight) scale = scaleHeight;
        else                          scale = scaleWidth;

        bitmap = Bitmap.createScaledBitmap(songCover, (int)(width/scale), (int)(height/scale), true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-23T22:31:18.967

你可以使用属性 Bitmap

```
Bitmap bitmap = Bitmap.createScaledBitmap(image, (int)x, (int)y, true); 
```

# sql - 查找从月初到当天的天数（Oracle）

> ID：10954410
> 
> 赞同：-1
> 
> 时间：2012-06-08T18:44:50.687
> 
> 标签：sql, oracle, date

如何确定一个月中有多少天，从第一天到当天（可能是一个月的任何地方）。因此，如果我有一个字段给出 6/01/12 5:32:13 PM 和 6/07/12 5:33:04 PM 我如何获得差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:48:40.490

我认为应该这样做：

```
SELECT TRUNC(SYSDATE) - TRUNC(SYSDATE,'MONTH') + 1 FROM DUAL 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-09T11:25:14.623

```
SELECT EXTRACT(DAY FROM sysdate) FROM dual; 
```

# javascript - jquery中的滑块活动状态

> ID：10954411
> 
> 赞同：0
> 
> 时间：2012-06-08T18:44:56.787
> 
> 标签：javascript, jquery

我有一个滑块，其代码是

```
var jq = jQuery.noConflict();
jq(document).ready(function(){

 jq("a.zootoggle").click(function () {

    jq(this).parent().next('div.zoocontent').slideToggle('slow', function() {
     jq("a.zootoggle").parent().toggleClass('active', jq(this).is(':visible'));
  });
      return false;

    });
    }) 
```

html

```
 <h3><a class="zootoggle">openme</a></h3>
    <div class="zoocontent>content here</div>
<h3><a class="zootoggle">openme</a></h3>
    <div class="zoocontent>content here</div> 
```

这样做的原因是它在单击时打开了正确的框（单击的 h3 的下一个同胞包含 a），但随后它将活动类应用于所有 h3 而不仅仅是单击的那个。我希望活动课程仅适用于当前的 h3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:56:02.293

这行得通吗？

```
jq("a.zootoggle").click(function () {

    jq(this).parent().toggleClass('active').next('div.zoocontent').slideToggle('slow');
    // Note, there's no callback in the slideToggle function anymore.
    return false;
});​ 
```

# objective-c - 在自定义 NSView 上手动公开绑定需要什么？

> ID：10954419
> 
> 赞同：2
> 
> 时间：2012-06-08T18:45:32.613
> 
> 标签：objective-c, xcode, macos, xcode4, cocoa-bindings

我有一个`NSView`子类，我想公开一个属性（`NSGradient`确切地说是一个），以便我可以将它与其他对象绑定（以编程方式使用该`bind:toObject:withKeyPath:options:`方法）。

我应该采取哪些步骤？

这是我所做的：

```
+(void)initalize {
  [self exposeBinding:@"gradient"];
}
- (Class)valueClassForBinding:(NSString*)binding {
  if ([binding isEqualToString:@"gradient"]) { return([NSGradient class]); }

  return(nil);
}
-(NSArray*)exposedBindings {
  return([NSArray arrayWithObjects:@"gradient",nil]);
} 
```

我不介意绑定没有显示在 Interface Builder 中。这`gradient`是一个实现的属性`@property (nonatomic, retain) NSGradient* gradient`，它在当前实现中运行良好。

**只需要上面**的代码来实现吗？（这似乎太容易了）我相信我错过了一些东西。

注意：我不是 Bindings 专家，但我在大部分 Objective-C 方面都做得很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:37:55.300

**要绑定的属性必须是 KVO 和 KVC 兼容的**；这实质上就是所有必要的。以您的方式声明属性，然后`@synthesize`ing 他们或做一些等效的事情就足够了。

`bind:toObject:withKeyPath:options:`出于某种原因，这只是一种方式，因此您必须使用 KVC 作为 Tom Dalling 注释来传播值。对`-bind:etc`消息接收者所做的更改必须手动传播。

据我所知`-exposeBinding:`，在 Xcode 4 中并没有真正做任何事情，也没有必要，因为 IB 不再支持插件。从[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaBindings/Concepts/HowDoBindingsWork.html#//apple_ref/doc/uid/20002373-174515)中：

> 在大多数情况下，您需要使用 bind:toObject:withKeyPath:options:，然后仅当您以编程方式建立绑定时。解除绑定的使用：在“解除绑定”中讨论。其他方法——类方法exposeBinding: 和实例方法exposedBindings 和valueClassForBinding:——仅在Interface Builder 面板中有用。

据我所知，只要您使用`-bind:toObject:withKeyPath:options:`. 您将保留该代码以在 Interface Builder 中公开绑定，但由于我们现在是 2012 年，IB 不再有插件......

# java - Coldfusion 使用 Dynamics NAV Webservice

> ID：10954424
> 
> 赞同：1
> 
> 时间：2012-06-08T18:45:56.647
> 
> 标签：java, web-services, coldfusion, coldfusion-9, dynamics-nav

我正在尝试从 Coldfusion 中使用 Dynamics NAV Web 服务。但是它失败并显示此消息：

> ... { [http://xml.apache.org/axis/](http://xml.apache.org/axis/) }HttpErrorCode:401 ...

我已经在一个 C# 项目中测试了相同的 Web 服务，这就像一个魅力。所以它确实是一个安全问题。

互联网上有很多关于调用 Dynamics NAV webservices 的讨论，例如参见[http://blogs.msdn.com/b/freddyk](http://blogs.msdn.com/b/freddyk)

问题似乎是如何让 Coldfusion 使用 NTLM 身份验证。[在 ColdFusion 中的 NTLM 身份验证](https://stackoverflow.com/questions/895361/ntlm-authentication-in-coldfusion)上有一篇关于此主题的帖子，但在从 Coldfusion 调用 web 服务时，我看不到如何实现这一点。

可以使用 C# 创建中间服务并从 Coldfusion 中调用此服务。但我正在寻找一种直接的方法。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:51:11.137

默认情况下，Axis（ColdFusion 中使用的 Web 服务器）仅支持基本身份验证，但 NAV 仅支持 Windows 身份验证（NTLM 或协商，取决于服务器配置键 WebServicesUseNTLMAuthentication 的值）。

我发现[这个](http://tjordahl.blogspot.co.uk/2007/03/apache-axis-and-commons-httpclient.html)页面描述了一种解决方法。万一链接失效，解决方法是将 Axis 配置为使用 Jakarta Commons HTTPClient 库。

您需要编辑 client-config.wsdd Axis 配置文件，并更改此行：

```
<transport name="http" pivot="java:org.apache.axis.transport.http.HTTPSender" />; 
```

对此：

```
<transport name="http" pivot="java:org.apache.axis.transport.http.CommonsHTTPSender" />; 
```

# sql - 创建 SQL 表，其中 DATETIME 或 INT 上的空字符串不默认

> ID：10954426
> 
> 赞同：3
> 
> 时间：2012-06-08T18:46:06.093
> 
> 标签：sql, datetime, default, sqldatatypes

如何创建一个表，以使`INSERT INTO`带有空字符串的数据类型不默认为 1900 年 1 月 1 日`DATETIME`，或者数据类型不默认为 0 `INT`？

```
CREATE TABLE TEST
(
  TS DATETIME,
  VA INT
)

INSERT INTO TEST VALUES ('','')
INSERT INTO TEST VALUES ('','2')
INSERT INTO TEST VALUES ('2012-06-08 12:13:14','')

SELECT * FROM TEST 
```

[SQL 小提琴](http://sqlfiddle.com/#!3/4fafb/1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:49:06.660

不要尝试`''`为 DATETIME 列插入空字符串。

改为使用`NULL`。

如果您将列定义为 NULL，这将起作用。

```
INSERT INTO TEST VALUES (NULL,'')
INSERT INTO TEST VALUES (NULL,'2')
INSERT INTO TEST VALUES ('2012-06-08 12:13:14','') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:55:50.267

这是您的问题的答案：

```
CREATE TABLE TEST
(
  TS DATETIME  NULL DEFAULT NULL,
  VA INT  NULL DEFAULT NULL
)

INSERT INTO TEST (VA) VALUES (1)
INSERT INTO TEST (TS) VALUES ('2012-06-08 12:13:14') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:56:30.767

在创建表本身时为列配置一些默认值。例如：默认为空

```
 CREATE TABLE TEST
    (
      TS DATETIME DEFAULT NULL,
      VA INT DEFAULT NULL
    ) 
```

这将存储 0000:00:00 00:00:00 和 '' 作为插入时的值。

# c++ - 关于如何在 C++ 中处理不同项目中的文件所需的课程

> ID：10954434
> 
> 赞同：1
> 
> 时间：2012-06-08T18:46:38.067
> 
> 标签：c++, visual-studio-2010, googletest

我已经能够在同一个项目中工作一段时间，编写并成功运行 c++ 代码。但是，我发现我仍然缺少一些关于如何将我的 .h 文件导出到另一个项目并在那里成功使用它们的要点。

我创建了第二个项目，**项目 B**来测试我在**项目 A**中的类。 [visual c++: #include files from other projects in the same solution我将](https://stackoverflow.com/questions/601268/visual-c-include-files-from-other-projects-in-the-same-solution)**Project A** 中头文件的路径添加到**Project B**的项目配置中的 Additional Include Directories(C\C++>general and Linker>general) 部分。我尝试按照此页面[http://msdn.microsoft.com/en-us/library/ms235636.aspx](http://msdn.microsoft.com/en-us/library/ms235636.aspx)上的教程进行操作，但我仍然遇到以下错误

** 链接：致命错误 LNK1104：无法打开文件 'C:\Users\LaC\Projects\OSGB\Debug\OSGB.lib**

如果能帮助我准确理解这是如何完成的，我将不胜感激，以便将来遇到此问题时，我可以知道如何进行故障排除。

下面的代码就是我正在使用的所有代码。

```
IN PROJECT A
=============

//Utility.h
class Utility
{
    private:

    protected:

    public:
        Utility(void);
        ~Utility(void);
        double square_root (const double);
};

//Utility.cpp

    #include "StdAfx.h"
    #include "Utility.h"

    Utility::Utility(void)
    {
        //do nothing for now
    }

    Utility::~Utility(void)
    {
        //do nothing for now
    }

    double Utility::square_root (const double)
    {
        return 0;

    }

IN PROJECT B
===============

#include "gtest/gtest.h"
#include "Utility.h"

TEST (SquareRootTest, PositiveNos) { 

    Utility u; 
    EXPECT_EQ (50.3321, u.square_root (2533.310224));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:01:10.243

有两种（一般）方法可以将文件包含到您的项目中：

*   使它们成为您项目的一部分（从解决方案资源管理器中添加它们）或
*   将它们作为库导入（静态或动态链接）

如果将它们作为项目的一部分，则必须添加头文件和源文件才能正确编译项目。但是，这通常不是您想要做的，因为它违背了拥有外部库的目的。

第二种情况是使用外部库，这需要您：

*   在 C++ 属性中包含由库导出的头文件。
*   对于静态链接：您还必须在链接器属性中包含 *.lib 文件（构建库的输出）。

或者

*   对于动态链接：[见教程。](http://msdn.microsoft.com/en-us/library/ms235636%28v=vs.80%29.aspx)

* * *

所以请记住：构建 C++ 项目有两个部分——**编译**和**链接**。

**编译器错误：**
如果您收到一个错误，其代码以`C*`（例如 C1083）开头并且与文件的问题标头有关，请检查属性-> C/C++ -> 常规-> 附加包含目录。

**链接器错误：**
如果您收到代码以 开头的错误`LNK*`，请检查

*   属性 -> 链接器 -> 常规 -> 附加库目录（确保这指向 *.lib 文件所在的位置）
    **和**
*   属性 -> 链接器 -> 输入 -> 附加依赖项（确保在此处添加 *.lib 文件）。

如果您正在动态链接，请检查您是否正确引用了 DLL。

* * *

因此，在您的情况下，您必须确定是静态链接还是动态链接，然后进行适当的引用。*那么你是从动态库还是静态库中获取这些头文件的呢？*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:49:58.057

当链接器发出`unresolved external symbol`存在于另一个库（DLL 或共享库）中的符号时，这表明您需要将您的应用链接到该其他库的 .lib 文件。这很可能是这里发生的事情。

有关更多信息，请参阅：

[(MSDN) 演练：创建和使用动态链接库 (C++)](http://msdn.microsoft.com/en-us/library/ms235636.aspx)

# erlang - 在 Erlang 中创建闭包：为什么没有绑定变量？

> ID：10954436
> 
> 赞同：1
> 
> 时间：2012-06-08T18:46:46.780
> 
> 标签：erlang, closures, shadowing

我有一段代码是这样的：

```
Fi_F = fun (F, I, Xs) -> 
           fun ( X ) -> 
                F( x_to_list(X, Xs, I) ) 
           end 
end, 
```

我只需要将列表的功能转换为一个数字的功能。例如，对于 Xs = [1,2,3] 和 I = 2，我希望这可以授予我以下功能：

```
fun ( X ) -> F([ 1, X, 3]) end. 
```

但不知何故，F、I 和 X 被遮蔽，而不是关闭，因此它在 x_to_list 中失败，列表为空。

我还是 Erlang 的新手，我认为我缺少概念性的东西，而不仅仅是语法问题。

**UPD：**发现了一个错误。我这样写 x_to_list/3 ：

```
x_to_list( X, L, I ) ->
    lists:sublist(L, I) ++ [ X ] ++ lists:nthtail(I+1, L). 
```

所以它从 0 开始计算列表元素，而不是 1。当我用 I = 3 调用它时，它会失败。所以这不是关闭。

我仍然有阴影警告，但这完全是另一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:19:36.623

`x_to_list/3`（只是为了测试）的一个有点快速和肮脏的实现将是：

```
x_to_list(X, Xs, I) ->
   { Pre, Post } = lists:split(I-1, Xs),
   Pre ++ [X] ++ tl(Post). 
```

然后，您的代码可以正常工作：

```
> Q = fun ( F, I, Xs ) -> fun (X) -> F( x_to_list(X, Xs, I)) end end.
> Y = Q( fun(L) -> io:format("~p, ~p, ~p~n", L) end, 2, [1,2,3] ).
> Y(4).
1, 4, 3
ok 
```

# xml - 是否可以使用 XPath 根据结构更深的节点中的条件来检索节点的值？

> ID：10954437
> 
> 赞同：0
> 
> 时间：2012-06-08T18:46:47.427
> 
> 标签：xml, xpath

这是我的意思的一个例子：

```
<Data>
  <ID>ID 1</ID>
  <Type>
    <Text>Type 1</Text>
  </Type>
  <Value>Value 1</Value>
</Data>
<Data>
  <ID>ID 2</ID>
  <Type>
    <Text>Type 2</Text>
  </Type>
  <Value>Value 2</Value>
</Data> 
```

如果 Text='Type 1'，那么我想返回该元素内的值（在这种情况下，我将返回“Value 1”）。

我可以使用谓词来检索整个元素，但我想找到一种仅获取的方法，以避免在 XPath 评估之后必须实现更多逻辑。

任何建议或意见将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:52:35.477

就像是

```
//Data/Value/text()[../../Type/Text/text()='Type 2'] 
```

或者可能

```
//Data[Type/Text/text()='Type 2']/Value/text() 
```

# sql-server-2005 - SQL QUERY 搜索每个单词，分割空间

> ID：10954438
> 
> 赞同：0
> 
> 时间：2012-06-08T18:47:05.473
> 
> 标签：sql-server-2005, search

sql server 查询的问题。

我尝试创建一个查询来搜索句子中的每个单词。单词由空格分隔。

结果包含值包含每个单词而不是至少 1 的行。

样本：

```
DECLARE @DATATABLE TABLE (ID INT,COL1 VARCHAR(MAX))
INSERT INTO @DATATABLE (ID,COL1) VALUES (1,'ALPHA')
INSERT INTO @DATATABLE (ID,COL1) VALUES (2,'ALPHA BETA')
INSERT INTO @DATATABLE (ID,COL1) VALUES (3,'ALPHA BETA CHARLIE')
INSERT INTO @DATATABLE (ID,COL1) VALUES (4,'ALPHA BETA CHARLIE DELTA')

DECLARE @TESTTABLE AS TABLE (ID INT,COL1 VARCHAR(MAX))

INSERT INTO @TESTTABLE (ID,COL1) VALUES (1,'ALPHA')             -- RETURN 1,2,3,4
INSERT INTO @TESTTABLE (ID,COL1) VALUES (2,'ALPHA BETA')            -- RETURN 2,3,4
INSERT INTO @TESTTABLE (ID,COL1) VALUES (3,'BETA CHARLIE ALPHA')    -- RETURN 3,4
INSERT INTO @TESTTABLE (ID,COL1) VALUES (4,'BETA DELTA')            -- RETURN 4
INSERT INTO @TESTTABLE (ID,COL1) VALUES (5,'CHARLIE')           -- RETURN 3,4

SELECT * FROM @DATATABLE

DECLARE @I AS INT
SET @I = 1

DECLARE @COUNTLINE AS INT
SET @COUNTLINE = (SELECT MAX(ID) FROM @TESTTABLE )

DECLARE @CURRENTVALUE AS VARCHAR(MAX)

WHILE(@I <=  @COUNTLINE)
BEGIN

    SET @CURRENTVALUE = (SELECT COL1 FROM @DATATABLE WHERE ID = @I)

    --  **  TODO    **
    -- QUERY SHOULD RETURN EVERY LINE CONTAINING EACH WORD OF THE CURRENT TEST VALUE
    SELECT * FROM @DATATABLE WHERE COL1 LIKE @CURRENTVALUE

    SET @I = @I + 1
END 
```

我在第一个测试的地方写了“TODO”（看到不应该做的事情）。

我无法创建 SP 或函数。

我在我这边寻找“with”和“in”或其他东西。

任何提示的坦克

周末愉快

# php - PHP 搜索和回显特定文本

> ID：10954439
> 
> 赞同：0
> 
> 时间：2012-06-08T18:47:10.397
> 
> 标签：php, search, scripting, echo

我有问题。我想要做的是让我的 PHP 代码进行搜索，直到找到输入的内容。例如，如果我搜索数字“12”。我希望它进入一个像下面这样的文件中，并找到其中包含“12”的行。

```
Dark Green = 11 = No = 20,
Light Blue = 12 = No = 20,
Lime Green = 13 = No = 20,
Sensei Gray = 14 = Yes = 0, 
```

在这种情况下，这一行将包含 12：

```
Light Blue = 12 = No = 20, 
```

接下来我希望代码在找到该行后执行的操作是让它读取其左侧“=”符号之前的文本。在这种情况下，我希望我的代码阅读：

```
Light Blue 
```

我一直想这样做，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:14:33.173

试试下面的代码

```
$string = 'Dark Green = 11 = No = 20,
Light Blue = 12 = No = 20,
Lime Green = 13 = No = 20,
Sensei Gray = 14 = Yes = 0';

$string = explode(',',$string);
foreach($string as $row)
{
    preg_match('/^(\D+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches);
    echo $matches[1];//Dark Green
    echo $matches[2];//11
    echo $matches[3];//No
    echo $matches[4];//20
} 
```

在循环中用于检查要搜索的单词

像那样

```
if($matches[1] == 'Dark Green')
{
   echo $matches[1];
} 
```

或者

```
 if($matches[2] == 11)
    {
       echo $matches[2];
    } 
```

(...) 要获取文件中的文本，请尝试使用

```
 $string = file_get_contents('file.txt'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:58:58.393

从广义上讲，您可以使用 php fgets 命令逐行处理任何文本文件。然后，您可以在每一行上运行一个操作，使用上面建议的 explode 来查找您的字符串并打印它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T18:58:58.733

尝试这样的事情

```
$lines = explode("\n",$filetext);
$searchString = preg_quote('12','/');
foreach($lines as $line) {
    preg_match("/([^=])\s*=\s*$searchString/");
    if($matches[1]) {
         print $matches[1]; 
         break;
    }
} 
```

其中 $filetext 使用 fgets 逐行读取文本（然后您不需要爆炸），甚至使用 file_get_contents 更简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T18:59:19.877

这是 preg_grep 和 explode 的混合。

```
$arr = explode("\n", file_get_contents('file.txt'));
$matches = preg_grep('/12/', $arr); 
```

您的匹配项将在 $matches 数组中；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T19:30:14.677

用这个：

```
$data = file("file.txt");
$num = 12;
foreach((array)$data as $key=>$line) {
   if (strstr($line,"= $num ") || strstr($line," = $num,")) {
      echo $line;
      break;
   }
} 
```

# arrays - 如何查找数组的值是否是 Perl 中的哈希键？

> ID：10954442
> 
> 赞同：7
> 
> 时间：2012-06-08T18:47:22.480
> 
> 标签：arrays, perl, hash

我有一个数组说@array。我想知道数组的哪些值构成哈希的键，比如 %hash。除了使用 for 循环之外，还有其他简单的方法吗？

例如，

```
 @array = qw (a b c);   
 %hash = ( a => 1, b=> 2 ); 
```

在这种情况下，它应该只输出“a”和“b”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T18:56:45.937

这应该这样做：

```
my @array = qw(a b c) ;
my %hash = ( a => 1 , b => 2 ) ;

my @result = grep { exists $hash{$_} } @array ; 
```

# android - ADT Eclipse/Android 始终以调试模式构建/运行

> ID：10954452
> 
> 赞同：4
> 
> 时间：2012-06-08T18:48:15.753
> 
> 标签：android, eclipse, debugging, adt

对所有人来说，

忙着写我的第一个 Android 应用程序，使用 ADT/Eclipse。我使用手机作为部署环境，因为我的 PC 上的模拟器太慢了。

取得了很大进展，除了最近应用程序总是以调试模式部署，即使我在正常模式下“运行”应用程序也是如此。

尝试重建/卸载，但无论我做什么，它都没有影响。

任何帮助表示赞赏。巴里

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T19:15:24.267

> 重新启动设备应该可以解决您的问题。

您可以在此处找到详细信息：[eclipse-android-project-always-lauching-in-debug](https://stackoverflow.com/questions/4342588/eclipse-android-project-always-lauching-in-debug)

* * *

还要看看[eclipse-runs-debug-mode-even-when-i-click-run](https://stackoverflow.com/questions/6460370/eclipse-runs-debug-mode-even-when-i-click-run)

# python - 导入文件全部内容的 Python 语法是什么？

> ID：10954453
> 
> 赞同：1
> 
> 时间：2012-06-08T18:48:17.867
> 
> 标签：python, django

我希望将所有类从一个 Python 文件导入到另一个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T18:50:12.053

在您希望从中导入的类中，包括一个名为 的变量`__all__`，并用您想要的类/变量的名称填充它。

```
__all__ = ['Class1', 'Class2', 'variable_i_want'] 
```

在您希望将它们导入到的类中，您可以使用星号来访问所有类。

```
from foo import * 
```

如建议的那样，在执行此操作时要小心名称冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:51:12.960

只需像其他任何文件一样导入文件

```
import mythings 
```

然后你可以使用

```
myClass = mythings.MyClass() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T19:07:02.597

除了其他人所说的之外，您要导入的文件必须存在于`sys.path`. （通常你的当前目录在那里，所以同目录导入没有问题）例如，如果你想从你的父目录导入：

```
#want to import ../myotherfile.py
import os
import sys
sys.path.append(os.path.abspath(os.pardir))
import myotherfile  

print(myotherfile.func()) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T18:50:05.307

```
from module import * 
```

执行此操作时必须小心，因为可能会发生名称冲突。

# ruby-on-rails - Rails 版本卡在 2.3.5 如何更新到 3.x

> ID：10954462
> 
> 赞同：1
> 
> 时间：2012-06-08T18:49:15.940
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

您好，感谢您对此进行调查。

全新安装 Linux ubuntu 10.10 后，我尝试重新安装 rails。

完成后`sudo gem install rails`，我可以看到我返回了 rails 3.2.3 版本

但是在生成一个新项目之后我找不到我的 gemfile 所以我尝试了 ruby​​ -v 它返回 2.3.4 这很奇怪，因为我知道我得到了最新的。

此外，在尝试 sudo gem update --system 时，我收到一个错误，因为我可能会覆盖系统文件。这里有什么解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:53:01.453

我建议使用[rvm](https://rvm.io/)来管理您的 ruby​​ 集 - 以及为每个项目定义 gemset，这将允许您确保每个项目都有它需要的 gem。

这是 rvm 安装说明的链接（它们应该与 ubuntu 一起使用）：

[https://rvm.io/rvm/install/](https://rvm.io/rvm/install/)

以下是有关 rvm gemsets 基本使用的一些信息：

[https://rvm.io/gemsets/basics/](https://rvm.io/gemsets/basics/)

此外，在使用 rails 3+ 时，您应该练习打字`bundle exec rails -v`——这样您将使用为您所在项目定义的 gem。

您可以尝试输入`bundle exec rails -v`并告诉我们您看到的内容吗？

# winapi - 子窗口闪烁

> ID：10954465
> 
> 赞同：0
> 
> 时间：2012-06-08T18:49:20.660
> 
> 标签：winapi, user-interface

我的应用程序是注入到第 3 方 GUI 应用程序中的 dll。dll 在应用程序的主窗口上创建包含少量控件的子窗口。问题是我的窗口及其控件在重绘主窗口时闪烁。我已经阅读了许多关于类似问题的文章，但无法解决它。这是一些代码

```
hwndContainer = CreateWindowEx( WS_EX_TOPMOST, PANEL_CLASS_NAME, "", WS_CHILD | WS_VISIBLE, 0, 0, width, height, hwnd, 0, g_hInstance, cd );
CreateWindowEx( WS_EX_TOPMOST, "button", "Click me", WS_CHILD | WS_VISIBLE | WS_TABSTOP, x, y, w, h, hwndContainer, 0, 0, 0 );

...

case WM_PAINT:
    PAINTSTRUCT ps;
    HDC hdc = BeginPaint( hwndPanel, &ps );
    RECT r;
    GetClientRect( hwndPanel, &r );

    SelectObject( hdc, hpenBorder );
    SelectObject( hdc, GetStockObject( NULL_BRUSH ) );

    RoundRect( hdc, 0, 0, r.right, r.bottom, 5, 5 );

    EndPaint( hwndPanel, &ps ); 
    return 0; 
```

我尝试将 WS_CLIPCHILDREN 添加到主窗口样式，处理主窗口的 WM_PAINT 等。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:03:03.113

你可以试试 WS_CLIPSIBLINGS...自从我直接对窗口样式做任何事情以来已经很长时间了，但我似乎记得这种样式需要帮助减少非顶级窗口中的重绘闪烁。祝你好运。

# jquery - 悬停一个 div 改变另一个？

> ID：10954470
> 
> 赞同：0
> 
> 时间：2012-06-08T18:49:50.047
> 
> 标签：jquery, css, addclass, removeclass

我想知道是否有人可以帮助我解决 Jquery css 问题。

```
<div class='post'>
    <h1 class='title'>Title</h1>
</div> 
```

我想知道的是如何在将鼠标悬停在帖子 div 上时在标题旁边添加图像。然后鼠标移出图像将不会显示。

我正在使用 php while 循环来显示每页十个帖子 div。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:54:21.657

像这样的东西应该工作。

```
$('.post').bind({
    'mouseenter': function() {
        $(this).append('<img />');
    },
    'mouseleave': function() {
        $('img', this).remove();
    }
}); 
```

[JSFiddle](http://jsfiddle.net/NrCwV/ "JSFiddle")

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T18:55:45.240

目前尚不清楚您想要什么（您希望图像去哪里？），但您可以使用 CSS 轻松完成类似的操作：

```
.post h1 {
    padding-left: 25px;   
}

.post:hover h1 {
    background: url(http://www.dummyimage.com/20x20/000000/000) no-repeat 0 0;
} 
```

[**​JSFiddle**](http://jsfiddle.net/Paulpro/rBYMZ/)[](http://jsfiddle.net/Paulpro/rBYMZ/)

 **这将适用于 IE 7 和更新的浏览器，前提是您使用[严格的文档类型](http://www.bernzilla.com/item.php?id=762)（用于 IE 7 支持）。它仍然无法在 IE 6 中运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T18:58:54.103

看，没有 JavaScript [http://jsfiddle.net/zNbHE/](http://jsfiddle.net/zNbHE/)

```
<div class='post'>
    <h1 class='title'>Title</h1>
    <img width="50" height="50">
</div>​

div:hover img {
    visibility: visible;
}   
div img {
    visibility: hidden;
}
​ 
```

如果你需要支持非常老的浏览器（`:hover`除了链接什么都不支持）你可以用 jQuery 伪造它。额外的好处是，如果禁用 JS，图像将一直存在。

```
$(".post").hover(
  function () {
    $(this).addClass("hover");
  }, 
  function () {
    $(this).removeClass("hover");
  }
);

div.hover img {
    visibility: visible;
}   
div img {
    visibility: hidden;
} 
```**

# php - Jquery - 尝试从 php 文件中检索输出

> ID：10954473
> 
> 赞同：1
> 
> 时间：2012-06-08T18:49:58.647
> 
> 标签：php, jquery, ajax, post

这是我第一次尝试 AJAX，无法从 data.php 文件中检索输出。

这是到目前为止的代码，并非所有代码都包括在内，仅适用于：

索引.php

```
<article class="post">
    <form name="form"><input type="hidden" name="postid" value="<?php echo $value['post_id'];?>" />
   </article>

<div id="main-post">
<div id="gotpostid">some text</div>
</div> 
```

.js 文件

```
$(".cover-img").click(function(){
    $("#main-post").fadeIn(1000);
    $.post("data.php", {postid: form.postid.value},
        function(output){
              $("#gotpostid").html(output).show();
    });   
 }); 
```

数据.php

```
<?php

    echo 'got this from data.php';
?> 
```

data.php 文件与 .js 位于同一目录中。

目前，当我单击图像时，它会显示“main-post” div，但其中的“gotpostid”仍然只显示“一些文本”，并且不会将其替换为 php 文件中的输出文本。

这是添加以下代码的结果：

```
.fail(function(x,y,z){ $("#gotpostid").html(x + "<br />" + y + "<br />" + z)}) 
```

> [object 对象] 错误未找到

我发现这个错误主要归功于 Kevin B 关于添加 .fail() 的建议。

.php 文件的 url 不正确，它应该是`js/data.php`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:14:02.013

向您的 ajax 处理程序添加错误方法以了解是否发生了意外情况

```
$(".cover-img").click(function(){
    $("#main-post").fadeIn(1000);
    var jqxhr = $.post("/echo/html/", {postid: form.postid.value},
        function(output){
              $("#gotpostid").html(output).show();
    })
    .error( function()
    {
        console.log( "error" );      
    })

    return false;
 });​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:05:06.440

如果尚未安装 FireBug，请在响应函数中执行 console.log(output)。你看到你的回应了吗？

# javascript - 是否可以在 IE 中实现 WebKit 滚动条效果？

> ID：10954475
> 
> 赞同：5
> 
> 时间：2012-06-08T18:50:04.253
> 
> 标签：javascript, css, internet-explorer, webkit, scrollbar

我想为我的自定义滚动条设置样式。我知道这可以通过 WebKit 实现，但是在 Internet Explorer 中是否可以实现类似的效果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T09:57:00.220

一般来说，是的，只有针对 IE 的特定于浏览器的 CSS：

```
BODY {
    background-color          : orange;
    scrollbar-face-color      : red;
    scrollbar-arrow-color     : green;
    scrollbar-track-color     : yellow;
    scrollbar-shadow-color    : pink;
    scrollbar-highlight-color : white;
    scrollbar-3dlight-color   : brown;
    scrollbar-darkshadow-Color: gray;
} 
```

你可以玩弄它。[更多细节](http://www.spectrum-research.com/v2/projects_scrollbar_generator.asp)

**为了获得更多控制**，有几个 JS 插件可以实现与 Webkit 中相同的 IE 外观。我发现很难应用这些，但我认为这里有一个插件列表，它们没问题：

*   [jQuery 自定义内容滚动器](http://manos.malihu.gr/jquery-custom-content-scroller)
*   [dw_scroll](http://dyn-web.com/code/scroll/demos.php)
*   [滚动窗格](http://jscrollpane.kelvinluck.com/)

类似插件列表：[http ://slodive.com/web-development/jquery-scroll/](http://slodive.com/web-development/jquery-scroll/)

为了让它工作，将您的 HTML 标记设置为与示例中的完全相同是很重要的。

您可以做的是，打开示例 HTML 并根据您的需要对其进行修改。我认为这是最简单的方法。

希望这可以帮助 ：）

# c++ - 同一功能的模板版本和非模板版本

> ID：10954479
> 
> 赞同：1
> 
> 时间：2012-06-08T18:50:24.713
> 
> 标签：c++, templates

考虑以下简单函数

```
void foo_rt(int n) {
    for(int i=0; i<n; ++i) {
        // ... do something relatively cheap ...
    }
} 
```

如果我`n`在编译时知道参数，我可以编写相同函数的模板版本：

```
template<int n>
void foo_ct() {
    for(int i=0; i<n; ++i) {
        // ... do something relatively cheap ...
    }
} 
```

这允许编译器执行循环展开之类的操作，从而提高速度。

但是现在假设我*有时*在编译时知道`n`，*有时*只在运行时知道。如何在不维护两个版本的函数的情况下实现这一点？我在想一些事情：

```
inline void foo(int n) {
    for(int i=0; i<n; ++i) {
        // ... do something relatively cheap ...
    }
}

// Runtime version
void foo_rt(int n) { foo(n); }

// Compiletime version
template<int n>
void foo_ct() { foo(n); } 
```

但我不确定是否所有编译器都足够聪明来处理这个问题。有没有更好的办法？

编辑：

显然，一种可行的解决方案是使用宏，但我*真的*想避免这种情况：

```
#define foo_body \
{ \
    for(int i=0; i<n; ++i) { \
        // ... do something relatively cheap ... \
    } \
}

// Runtime version
void foo_rt(int n) foo_body

// Compiletime version
template<int n>
void foo_ct() foo_body 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T20:02:18.427

我以前做过这个，使用`integral_variable`类型和`std::integral_constant`. 这看起来像是很多代码，但如果你再看一遍，它实际上只是一系列非常简单的四个部分，其中一个只是演示代码。

```
#include <type_traits>

//type for acting like integeral_constant but with a variable
template<class underlying>
struct integral_variable {
    const underlying value;
    integral_variable(underlying v) :value(v) {}
}; 

//generic function
template<class value> 
void foo(value n) {
    for(int i=0; i<n.value; ++i) {
        // ... do something relatively cheap ...
    }
} 

//optional: specialize so callers don't have to do casts
void foo_rt(int n) { return foo(integral_variable<int>(n)); }
template<int n>
void foo_ct() { return foo(std::integral_constant<unsigned, n>()); }
//notice it even handles different underlying types.  Doesn't care.

//usage is simple
int main() {
    foo_rt(3);
    foo_ct<17>();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:55:42.033

尽管我很欣赏[DRY 原则](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，但我认为没有办法将它写两次。

尽管代码相同，但这是两个非常不同的操作——使用已知值与使用未知值。

您希望将已知的优化放在快速轨道上，而未知的优化可能不符合条件。

我要做的是将所有不依赖于 n 的代码分解到另一个函数中（希望是`for`循环的整个主体），然后让模板化和非模板化版本在它们的循环中调用它。这样，您唯一重复的是`for`循环的结构，我认为这没什么大不了的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T20:53:45.307

如果一个值在编译时已知，则通过模板将其路由为模板参数不会使其在编译时*更加*已知。我认为不太可能有任何编译器会内联和优化函数，因为变量是模板参数而不是其他类型的编译时间常数。

根据您的编译器，您甚至可能不需要该函数的两个版本。优化编译器很可能只能够优化使用常量表达式参数调用的函数。例如：

```
extern volatile int *I;

void foo(int n) {
    for (int i=0;i<n;++i)
        *I = i;
}

int main(int argc,char *[]) {
    foo(4);
    foo(argc);
} 
```

我的编译器将其转换为从 0 到 3 的内联展开循环，然后是 argc 上的内联循环：

```
main:                                   # @main
# BB#0:                                 # %entry
        movq    I(%rip), %rax
        movl    $0, (%rax)
        movl    $1, (%rax)
        movl    $2, (%rax)
        movl    $3, (%rax)
        testl   %ecx, %ecx
        jle     .LBB1_3
# BB#1:                                 # %for.body.lr.ph.i
        xorl    %eax, %eax
        movq    I(%rip), %rdx
        .align  16, 0x90
.LBB1_2:                                # %for.body.i4
                                        # =>This Inner Loop Header: Depth=1
        movl    %eax, (%rdx)
        incl    %eax
        cmpl    %eax, %ecx
        jne     .LBB1_2
.LBB1_3:                                # %_Z3fooi.exit5
        xorl    %eax, %eax
        ret 
```

要获得这样的优化，您要么需要确保定义对所有翻译单元都可用（例如，通过将函数定义为头文件中的内联函数），要么具有进行链接时优化的编译器。

如果你使用它并且你真的依赖于在编译时计算的一些东西，那么你应该有自动化测试来验证它是否完成。

* * *

C++11 提供了 constexpr，它允许您编写一个函数，该函数将在给定 constexpr 参数时在编译时计算，或者保证在编译时计算一个值。constexpr 函数中可以包含的内容受到限制，这可能会使您的函数难以实现为 constexpr，但允许的语言显然是图灵完备的。一个问题是，虽然这些限制保证了在给定 constexpr 参数的情况下可以在编译时完成计算，但当参数*不是*constexpr 时，这些限制可能导致实现效率低下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-12T02:27:59.700

为什么不这样：

```
template<typename getter>
void f(getter g)
{
   for (int i =0; i < g.get(); i++) { blah(); }
}

struct getter1 { inline constexpr int get() { return 1; } }
struct getterN { getterN(): _N(N) {} inline constexpr int get() { return k; } }
f<getter1>(getter1());
f<getterN>(getterN(100)); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-08T18:58:07.237

我会指出，如果你有：

```
// Runtime version
void foo_rt(int n){ foo(n);} 
```

...这对您有用，那么您**实际上**在编译时就知道类型。至少，您知道一个与之协变的类型，这就是您需要知道的全部内容。您可以只使用模板版本。如果需要，您可以在调用站点指定类型，如下所示：

```
foo_rt<int>() 
```

# django - Django ManyToMany 通用“通过”模型

> ID：10954486
> 
> 赞同：3
> 
> 时间：2012-06-08T18:51:13.000
> 
> 标签：django, django-models, many-to-many, django-orm

我正在写一个画廊领域。该字段子类化`ManyToManyField`并添加了自己的 ajax 小部件和东西。我想让这个解决方案尽可能紧凑（我的意思是——如果可能的话，我想编写尽可能少的代码来在另一个项目中重新实现它）。

我决定创建一个中间表（它提供了一个 'through' 参数`ManyToManyField`），它将保存订购信息：

```
class IntermediateModel(models.Model):
    from_content_type = models.ForeignKey(ContentType)
    from_object_id = models.PositiveIntegerField()
    from_content_object = generic.GenericForeignKey('from_content_type', 'from_object_id')
    to_content_type = models.ForeignKey(ContentType)
    to_object_id = models.PositiveIntegerField()
    to_content_object = generic.GenericForeignKey('to_content_type', 'to_object_id')
    order = models.PositiveIntegerField() 
```

出现以下问题：

1.  是否有可能在 django 中为 m2m 提供一个“通过”模型，其中两个外键都指向一个通用关系（如上面的那个）？如果是这样 - 如何实现这一目标？
2.  如果可以做到这一点 - 这种模型可以在多个 m2m 字段之间保持通用关系吗？喜欢：类 <-> 中级 <-> 学生、画廊 <-> 中级 <-> 照片 - 都使用中级作为“通过”模型？
3.  **编辑：刚刚测试过 - 我可以；）我可以**使用带有“通过”表的抽象类吗？我想通了——如果上面提到的复杂场景不起作用，我可以创建两个提供排序和其他东西的抽象类，然后总是创建普通的子类来实际建立一些关系:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:50:57.410

如果中间模型之间的区别只是您处理它们的方式，也许您只需要将它与“代理”模型一起使用。我的意思是，使用 Django 模型子类化和一个`Meta`名为“代理”的选项作为`True`. 这样，您可以单独处理它们，但将它们存储在同一个数据库表中（如果这是您需要的选项）。

读[这个](https://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)。也许这就是你想要的。您可以拥有 1 个具有 2 种（或更多）访问和处理它们的方式的表，而不是 2 个具有相同结构的数据库表。

# maven - Maven：部署时 Primefaces 库的奇怪 ClassNotFoundException

> ID：10954487
> 
> 赞同：2
> 
> 时间：2012-06-08T18:51:13.197
> 
> 标签：maven, glassfish, primefaces, ear, classnotfoundexception

我有一个带有 ejb 和两个战争的企业应用程序，问题是当我在战争中使用其中一个 JSF 时，我在部署时遇到了一个奇怪的 ClassNotFoundException。maven编译顺利，两个web应用也能正常工作。

这是 Glassfish 3.1.1 服务器上的长时间日志记录示例：

```
ATTENTION: WEB9052: Unable to load class org.primefaces.component.growl.Growl, reason: java.lang.ClassNotFoundException: org.primefaces.component.growl.Growl
ATTENTION: WEB9052: Unable to load class org.primefaces.component.menuitem.MenuItem, reason: java.lang.ClassNotFoundException: org.primefaces.component.menuitem.MenuItem
ATTENTION: WEB9052: Unable to load class org.primefaces.component.poll.Poll, reason: java.lang.ClassNotFoundException: org.primefaces.component.poll.Poll
ATTENTION: WEB9052: Unable to load class org.primefaces.component.commandbutton.CommandButton, reason: java.lang.ClassNotFoundException: org.primefaces.component.commandbutton.CommandButton
ATTENTION: WEB9052: Unable to load class org.primefaces.component.outputpanel.OutputPanel, reason: java.lang.ClassNotFoundException: org.primefaces.component.outputpanel.OutputPanel
ATTENTION: WEB9052: Unable to load class org.primefaces.component.fieldset.Fieldset, reason: java.lang.ClassNotFoundException: org.primefaces.component.fieldset.Fieldset
ATTENTION: WEB9052: Unable to load class org.primefaces.component.chart.bar.BarChart, reason: java.lang.ClassNotFoundException: org.primefaces.component.chart.bar.BarChart
ATTENTION: WEB9052: Unable to load class org.primefaces.component.selectmanymenu.SelectManyMenu, reason: java.lang.ClassNotFoundException: org.primefaces.component.selectmanymenu.SelectManyMenu
ATTENTION: WEB9052: Unable to load class org.primefaces.component.separator.Separator, reason: java.lang.ClassNotFoundException: org.primefaces.component.separator.Separator
ATTENTION: WEB9052: Unable to load class org.primefaces.component.watermark.Watermark, reason: java.lang.ClassNotFoundException: org.primefaces.component.watermark.Watermark 
```

这是应用程序的层次结构：

```
 |--MavenDemo
       |-MavenDemo-ear
       |---src
       |-----main
       |-------application
       |---------META-INF
       |-MavenDemo-ejb
       |---src
       |-----main
       |-------java
       |-------resources
       |---------META-INF
       |-MavenDemo-web
       |---src
       |-----main
       |-------java
       |-------webapp
       |-MavenDemo-web2
       |---src
       |-----main
       |-------java
       |-------webapp 
```

这里是模块的 pom.xml 文件：

**项目的POM：**

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>fr.momsse</groupId>
    <artifactId>MavenDemo</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    <name>MavenDemo</name>

    <modules>
        <module>MavenDemo-ear</module>
        <module>MavenDemo-ejb</module>
        <module>MavenDemo-web</module>
        <module>MavenDemo-web2</module>
    </modules>

</project> 
```

**EAR 模块的 POM：**

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <artifactId>MavenDemo</artifactId>
    <groupId>fr.momsse</groupId>
    <version>1.0-SNAPSHOT</version>
  </parent>

  <groupId>fr.momsse</groupId>
  <artifactId>MavenDemo-ear</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>ear</packaging>

  <name>MavenDemo-ear</name>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <netbeans.hint.deploy.server>gfv3ee6</netbeans.hint.deploy.server>
  </properties>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-ear-plugin</artifactId>
        <version>2.6</version>
        <configuration>
            <version>6</version>
            <defaultLibBundleDir>lib</defaultLibBundleDir>
        </configuration>
      </plugin>
    </plugins>
  </build>
    <dependencies>
        <dependency>
            <groupId>fr.momsse</groupId>
            <artifactId>MavenDemo-ejb</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>ejb</type>
        </dependency>
        <dependency>
            <groupId>fr.momsse</groupId>
            <artifactId>MavenDemo-web</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>war</type>
        </dependency>
        <dependency>
            <groupId>fr.momsse</groupId>
            <artifactId>MavenDemo-web2</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>war</type>
        </dependency>
    </dependencies>
</project> 
```

**EJB模块的POM：**

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <parent>
    <artifactId>MavenDemo</artifactId>
    <groupId>fr.momsse</groupId>
    <version>1.0-SNAPSHOT</version>
  </parent>

    <groupId>fr.momsse</groupId>
    <artifactId>MavenDemo-ejb</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>ejb</packaging>

    <name>MavenDemo-ejb</name>

    <properties>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ejb-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                    <ejbVersion>3.1</ejbVersion>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>validate</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project> 
```

**第一个使用 Primefaces 的 WAR 模块的 POM：**

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <artifactId>MavenDemo</artifactId>
        <groupId>fr.momsse</groupId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <groupId>fr.momsse</groupId>
    <artifactId>MavenDemo-web</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>war</packaging>

    <name>MavenDemo-web</name>

    <!-- ......................................... -->
    <!-- .............. Repositories ............. -->
    <!-- ......................................... -->
    <repositories>
        <repository>
            <url>http://repository.primefaces.org/</url>
            <id>primefaces</id>
            <layout>default</layout>
            <name>Repository for library Library[primefaces]</name>
        </repository>
    </repositories>

    <dependencies>

        <!-- ............................................. -->
        <!-- ..... Java EE 6 Web API, JSTL & Taglibs ..... -->
        <!-- ............................................. -->
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-web-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>

        <!-- ......................................... -->
        <!-- .......... Java Server Faces ............ -->
        <!-- ......................................... -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.1-b04</version>
            <scope>provided</scope>
        </dependency>

        <!-- ......................................... -->
        <!-- .............. Primefaces ............... -->
        <!-- ......................................... -->
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.2</version>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>validate</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project> 
```

**第二个WAR模块的POM：**

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <parent>
    <artifactId>MavenDemo</artifactId>
    <groupId>fr.momsse</groupId>
    <version>1.0-SNAPSHOT</version>
  </parent>

    <groupId>fr.momsse</groupId>
    <artifactId>MavenDemo-web2</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>war</packaging>

    <name>MavenDemo-web2</name>

    <properties>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-web-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>validate</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project> 
```

提前感谢您的宝贵帮助。

# clang - 如何使用 Clang 获取当前版本的 AST？

> ID：10954491
> 
> 赞同：3
> 
> 时间：2012-06-08T18:51:36.850
> 
> 标签：clang, abstract-syntax-tree

我一直在尝试从 Clang 获取 AST，但到目前为止我还没有成功。我在堆栈中发现了一个一年前的[问题](https://stackoverflow.com/questions/7935008/clang-what-does-ast-abstract-syntax-tree-look-like)，其中提到了使用 Clang 获取 ast 的另外两种方法，它们是：

> ./llvmc -cc1 -ast-dump 文件.c
> 
> ./llvmc -cc1 -ast-打印文件.c

在这个[问题](https://stackoverflow.com/questions/5130695/how-to-make-use-of-clangs-ast)上，提到了 doxygen 并给出了一个 ast 的[表示](http://clang.llvm.org/doxygen/classclang_1_1SemaConsumer.html)，但我主要是在寻找一些文本形式的表示，例如 XML，以便可以执行进一步的分析。

最后，堆栈上还有另一个[关于](https://stackoverflow.com/questions/5309405/can-i-get-an-xml-ast-dump-of-c-c-code-with-clang-without-using-the-compiler)XML 导入的问题，但由于还提到了几个原因，它被停止了。

**因此，我的问题是，哪个版本以及如何从控制台使用它来获取 C 中给定代码的 ast 相关信息？**我相信这是一个非常轻松的单行命令代码，就像上面那样，但是文档索引并没有像我读过的那样引用任何关于 ast 的内容，而且我在 llvmc 发现的唯一一个是关于手动编写 AST 不是真的是我要找的。

我尝试了上面的所有命令，但它们在 2.9 版上都已经失败了，而且我已经发现 llvm 在每个版本之间都发生了很大变化。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T22:34:34.590

OP 说“也接受其他建议”。

他可能会考虑我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)及其[C 前端](http://www.semanticdesigns.com/Products/FrontEnds/CFrontEnd.html)。

虽然展示由此产生的 C AST 很容易，但展示由 DMS 使用相同的 C 前端（ObjectiveC 是 C 的方言）产生的 ObjectiveC AST [已经在 SO] 更容易。请参阅[https://stackoverflow.com/a/10749970/120163](https://stackoverflow.com/a/10749970/120163) DMS 也可以生成与此等效的 XML。

我们不建议将树导出为文本，因为真实代码的真实树非常庞大，并且根据我们的经验，很难将其作为文本或 XML 对象进行操作。通常需要解析之外的机器。请参阅我关于[解析后的生活的讨论](http://www.semanticdesigns.com/Products/DMS/LifeAfterParsing.html)

# java - .setText() 使我的 android 应用程序崩溃

> ID：10954493
> 
> 赞同：0
> 
> 时间：2012-06-08T18:51:37.657
> 
> 标签：java, android, xml, mobile

我今天在这个网站上尝试了许多其他问题，但没有一个有帮助，我似乎有相同的语法适用于其他人，但每次我点击发送（当我希望我的文本字段更新时）我的应用程序就会崩溃，我为 setText() 方法尝试了一堆不同的语法，但没有任何效果。

感谢您提前提供任何帮助

这是我的主要课程

```
package com.example.myapp;

import android.app.Activity;
import java.io.IOException;
import java.util.ArrayList;

import android.app.Activity;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.*;
import org.apache.http.client.methods.*;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

public class TestprojectsActivity extends Activity {

    private int index;
    private int QsClicked = 0;
    private ArrayList<String> categories = new ArrayList<String>();
    private ArrayList<Button> buttons = new ArrayList<Button>();
    Button b1;
    Button b2;
    Button b3;
    Button b4;
    Button changer;
    private int Qselected;
    TextView txt;
    EditText edit;
    private ArrayList<String> questions = new ArrayList<String>();
    private int qnum = 0;

    // updates all the buttons so we can see more categories
    public void updateButtons(View v){
        for(int i = 0; i < 4; i++){
              if(index >= categories.size()){
                  index = 0;
              }
              buttons.get(i).setText(categories.get(index));
              index++;
          }
    }

    public void Q1(View v){
        setContentView(R.layout.sub);
        Qselected = index;
        //send(null);
    }

    public void Q2(View v){
        setContentView(R.layout.sub);
        Qselected = (index+1);
        //send(null);
    }

    public void Q3(View v){
        setContentView(R.layout.sub);
        Qselected = (index+2);
        //send(null);
    }

    public void Q4(View v){
        setContentView(R.layout.sub);
        Qselected = (index+3);
        //send(null);
    }

    public void send(View v){
        edit.setText("WHY ISNT THIS WORKING?");
        if(qnum < questions.size()){
            txt.setText("i work!");
            qnum++;
        }
        else{
            qnum = 0;
            System.exit(0);
        }
    }

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    index = 0;
    b1 = (Button) findViewById(R.id.B1);
    buttons.add(b1);
    b2 = (Button) findViewById(R.id.B2);
    buttons.add(b2);
    b3 = (Button) findViewById(R.id.B3);
    buttons.add(b3);
    b4 = (Button) findViewById(R.id.B4);
    buttons.add(b4);
    txt = (TextView) findViewById(R.id.textView1);
    edit = (EditText) findViewById(R.id.editText2);
    categories.add("dumb questions");
    categories.add("smart questions");
    questions.add("hi there, what is your name?");
    questions.add("what did you have for breakfast today?");
    questions.add("how old are you?");
    questions.add("what color is your hair?");
    updateButtons(null);
}
} 
```

这是我的主要 xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/layoutrowtop"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >
<Button
    android:id="@+id/B4"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="B4"
    android:onClick="Q4" />
<Button
    android:id="@+id/B3"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="B3"
    android:onClick="Q3" />
<Button
    android:id="@+id/B2"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="B2"
    android:onClick="Q2" />
<Button
    android:id="@+id/B1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="B1"
    android:onClick="Q1" />
<Button
    android:id="@+id/Button05"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:text="More Categories"
    android:onClick="updateButtons" />

</LinearLayout> 
```

这是我的子 xml（我使用它，所以我可以有另一个布局）

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.22"
        android:text="Question"
         />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.51"
        android:ems="10"
        android:inputType="text" />

    <Button
        android:id="@+id/send"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.08"
        android:text="Send" 
        android:onClick="send" />

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:02:07.217

在活动的`onCreate`方法中，您将内容视图设置为`R.layout.main`并搜索`TextView`要设置文本的内容。因为`TextView`不在那个布局中（在`R.layout.sub`而不在 中`R.layout.main`）它会是`null`，当你设置文本时你会得到一个`NullPointerException`，尽管你将内容视图设置为包含它的新布局`TextView`（你已经搜索它在`onCreate`方法中，所以引用被初始化为null）。

解决方法是在设置新内容 view( )`TextView` **后**`R.layout.sub`搜索，例如：

```
public void send(View v){
        txt = (TextView) findViewById(R.id.textView1);
        edit = (EditText) findViewById(R.id.editText2);
        edit.setText("WHY ISNT THIS WORKING?");
        if(qnum < questions.size()){
            txt.setText("i work!");
            qnum++;
        }
        else{
            qnum = 0;
            System.exit(0);
        }
    } 
```

Ans 也是如此`Edittext`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:03:51.097

您的活动使用 main.xml 作为其布局，并且没有带有 id 的 TextView `editText2`。只是将这样的视图放在 sub.xml 中并不会创建视图；布局文件需要膨胀并设置为活动的内容视图。更改布局后致电`findViewById`，一切都应该很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:07:34.257

当 Oncreate 调用 main.xml 时，您是布局 xml 并且它没有 R.id.editText2 所以当时编辑将为空......

把这条线

```
edit = (EditText) findViewById(R.id.editText2); 
```

在

```
 public void Q1(View v){
        setContentView(R.layout.sub);
        Qselected = index;
 edit = (EditText) findViewById(R.id.editText2); <-----------------here in Q1 Q2 Q3 Q4
        //send(null);
    } 
```

# c++ - 初学者：我应该从高级别还是低级别开始？

> ID：10954495
> 
> 赞同：3
> 
> 时间：2012-06-08T18:51:53.463
> 
> 标签：c++, c, vim, ide

我对编程比较陌生，希望能够为 Linux 和 Windows 制作原生 C++ 程序。

我只是想知道作为初学者，我应该首先学习低级语言，例如在 vim 中的 C 和汇编，还是应该直接从带有 C++ 的 IDE 开始？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T18:59:58.067

如果你想学 C++，就学 C++。首先学习 C 或汇编语言不仅是浪费时间，而且通常会教给你相对较差的习惯，在你用好 C++ 之前，你需要在不学习的情况下工作。

这并不是说了解 C 或汇编语言就不可能很好地使用 C++——但每种语言都需要截然不同的思维方式，因此会产生额外的工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T18:55:01.747

如果你的最终目标是学习 C++，那么先学习 C 并不是先决条件。你可以，但你不必这样做。

底线是，做你觉得最舒服的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T19:05:10.800

C++ 不是（真的）一种高级编程语言。每当您犯了一个小的编程错误时，您仍然需要手动管理您的内存并获得未定义的特定于环境的行为。除此之外，C++ 对新程序员来说是一种非常不友好的语言，因为它既过于复杂又（在我看来）设计糟糕。

我建议从 Java、Python 或 C# 等实际的高级语言开始，并结合花哨的 IDE。如果您想更多地关注低级方面而不是通用编程技术和范例，那么从 C 开始也是一种选择。

如果你想开始编程，你也不必学习 vim，一个简单的编辑器，如 gedit 或 Notepad++ 也可以很好地工作。不过，专为您的语言设计的 IDE 可能是最舒适的。

**编辑**：正如 Jerry Coffin 正确指出的那样，如果您的目标是编写 C++ 应用程序，这个建议并没有真正的帮助。尽管我仍然建议您在开始使用 C++ 之前先使用一种更简单（高级）的语言来获得一般的编程技能。如果 C++ 对于您想要实现的目标不是绝对必要的，那么重新考虑您是否真的想要使用该语言也不是一个坏主意。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-08T19:02:35.580

如果您想学习 C++，请从 C++ 开始。你不需要先学习C；这实际上会适得其反，因为当您迁移到 C++ 时，您必须学习一些东西 *。*

C 和 C++ 是不同的语言，具有不同的目标和理念。一个编写良好的 C++ 程序在外观或行为上都不会像一个编写良好的 C 程序。

一旦您对高级 C++ 特性感到满意，您*就*可以开始深入研究较低级别的细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T19:29:58.530

> “如果我看得更远，那就是站在巨人的肩膀上。” ——艾萨克·牛顿爵士

### 不要重新发明轮子。

尽可能从核心开始，从核心抽象出来，只有在没有其他方法可以推进的时候才重新审视核心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T21:40:12.137

在我看来，您的问题更多是关于学习*编程*。语言选择可能次要于学习编程范式/概念。

因此，如果编程是您的重点，那么您可能首先学习面向对象编程 (OOP) 概念，这样您就不必以人们经常使用过程方法的方式“采用”它们。然后，如果需要，您可以深入研究过程方式和一些 C 习惯用法/技巧和低级方法。

OOP 可以用 C++ 教授，就像在 Java 等中一样。在那个阶段并不重要。

Once your mindset is "oriented", then the actual programming will be more about using existing libraries (APIs), which in fact will require more learning than the language itself.

So my advice is to learn OOP concepts first, then review your future language preferences. Have fun!!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T19:20:14.737

Javascript 是我学习的第一门语言，我感到很幸运。有了它，我能够跳过其他语言的许多复杂性和障碍，例如静态类型、指针和编译。使用 javascript，您甚至不必安装任何东西，只需到这里，您就可以开始尝试：http: [//jsfiddle.net/X4PpW/](http://jsfiddle.net/X4PpW/)。

在我掌握了 Javascript 之后，理解在 C 中使用指针和类的概念对我来说很容易。另一种好的语言是 Python。

还有，你打算做什么？并非所有桌面应用程序都必须用 C 编写。事实上，一些新框架借鉴了 Web 应用程序的想法，甚至允许将来自网站的 HTML 嵌入到您的应用程序中。

*   游戏：Unity3d [http://unity3d.com/](http://unity3d.com/)（这里写的游戏可以移植到移动设备或网络，但需要插件）
*   带有 UI 的通用应用程序：QT [http://qt.nokia.com/products/](http://qt.nokia.com/products/)

# excel - 如何使用 VBA Excel 等待 Internet Explorer 9 框架加载？

> ID：10954496
> 
> 赞同：2
> 
> 时间：2012-06-08T18:52:00.383
> 
> 标签：excel, vba, internet-explorer-9

有许多在线资源说明如何在 VBA Excel 中使用 Microsoft Internet Explorer 控件来执行基本的 IE 自动化任务。当网页具有基本结构时，这些工作。但是，当网页包含多个框架时，它们可能难以使用。

我需要确定网页中的单个框架是否已完全加载。例如，此 VBA Excel 代码打开 IE，加载网页，循环通过 Excel 表将数据放入网页字段，执行搜索，然后将 IE 结果数据返回到 Excel（我很抱歉省略了站点地址）。

目标网页包含两个框架：

1) searchbar.asp 框架，用于搜索值输入和执行搜索

2）用于显示搜索结果的searchresults.asp框架

在此构造中，搜索栏是静态的，而搜索结果会根据输入条件而变化。由于网页是以这种方式构建的，因此无法使用 IEApp.ReadyState 和 IEApp.Busy 来确定 IEfr1 框架加载完成，因为这些属性在初始 search.asp 加载后不会更改。因此，我使用较大的静态等待时间来避免随着互联网流量波动而出现运行时错误。这段代码确实有效，但速度很慢。请注意 cmdGO 语句后的 10 秒等待。我想通过添加可靠的逻辑来确定帧加载进度来提高性能。

如何确定自主框架是否已完成加载？

```
' NOTE: you must add a VBA project reference to "Internet Explorer Controls"
' in order for this code to work
Dim IEapp As Object
Dim IEfr0 As Object
Dim IEfr1 As Object

' Set new IE instance
Set IEapp = New InternetExplorer

' With IE object
With IEapp
    ' Make visible on desktop
    .Visible = True
    ' Load target webpage
    .Navigate "http://www.MyTargetWebpage.com/search.asp"
    ' Loop until IE finishes loading
    While .ReadyState <> READYSTATE_COMPLETE
        DoEvents
    Wend
End With

' Set the searchbar.asp frame0
Set IEfr0 = IEapp.Document.frames(0).Document 

' For each row in my worksheet
For i = 1 To 9999                

    ' Input search values into IEfr0 (frame0)
    IEfr0.getElementById("SearchVal1").Value = Cells(i, 5)
    IEfr0.getElementById("SearchVal2").Value = Cells(i, 6)

    ' Execute search
    IEfr0.all("cmdGo").Click        

    ' Wait a fixed 10sec
    Application.Wait (Now() + TimeValue("00:00:10"))

    ' Set the searchresults.asp frame1
    Set IEfr1 = IEapp.Document.frames(1).Document

    ' Retrieve webpage results data
    Cells(i, 7) = Trim(IEfr1.all.Item(26).innerText)
    Cells(i, 8) = Trim(IEfr1.all.Item(35).innerText)

Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:09:00.393

正如@JimmyPena 所说。如果我们能看到 URL，那么提供帮助会容易得多。

如果我们不能，希望此概述可以为您指明正确的方向：

1.  等待页面加载（IEApp.ReadyState 和 IEApp.Busy）
2.  从 IE 对象中获取文档对象。（完毕）
3.  循环直到文档对象不是什么都没有。
4.  从文档对象中获取框架对象。
5.  循环直到框架对象不是什么都没有。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T12:21:14.587

我使用循环选项来检查字段值，直到它像这样填充

Do While IE.Document.getElementById("USERID").Value <> "test3" IE.Document.getElementById("USERID").Value = "test3" 循环

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-23T23:25:16.713

这是一个非常古老的线程，但我想我会发布我的发现，因为我来这里是为了寻找答案......

查看本地窗口，我可以看到“readystate”变量只是 IE 应用程序本身的“READYSTATE_COMPLETE”。但是对于 iframe，它是小写的“完整”
所以我通过在我正在使用的框架的 .readystate 上使用 debug.print 循环来探索这一点。

```
Dim IE As Object
Dim doc As MSHTML.HTMLDocument
Set doc = IE.Document
Dim iframeDoc As MSHTML.HTMLDocument
Set iframeDoc = doc.Frames("TheFrameIwasWaitingFor").Document

' then, after I had filled in the form and fired the submit event, 

Debug.Print iframeDoc.readyState
   Do Until iframeDoc.readyState = "complete"
     Debug.Print iframeDoc.readyState 
     DoEvents
   Loop 
```

因此，这将在即时窗口中逐行显示“正在加载”，最终显示“完成”并结束循环。当然可以删减 debug.prints。

另一件事：

```
debug.print iframeDoc.readystate ' is the same as...
debug.print doc.frames("TheFrameIwasWaitingFor").Document.readystate
' however, you cant use...
IE.Document.frames("TheFrameIwasWaitingFor").Document.readystate ' for some reason... 
```

如果所有这些都是常识，请原谅我。我真的只是在几天前才开始使用 VBA 脚本......

# php - 准备好的语句，很多字段

> ID：10954502
> 
> 赞同：0
> 
> 时间：2012-06-08T18:52:27.000
> 
> 标签：php, mysqli, prepared-statement

我需要为游戏设计一个 hiscores 系统。我有这样存储的用户数据：userid, player_rights, level, 0, 1, 2, 3,4 .. etc

其中 0-4 是技能 ID。我最近开始更频繁地使用prepared statements，并且我知道您通常必须在执行语句后绑定参数。大约有 26 个字段，绑定每个字段并不是唯一的方法。我对此使用 mysqli 对象没有任何问题——只是想知道是否有一种方法可以使用不需要绑定所有字段的准备好的语句来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:56:31.297

幸运的是，您可以做的一件事是将值通过数组传递给 execute()。

```
$stmt->prepare('INSERT INTO .... ?,?,?,?,?...);
$stmt->execute(array(value, value, value...)); 
```

它确实取决于您使用的访问方法类型，即 PDO、MySQLi 等。因为传递给执行的值略有不同。

# python - 使用 Django 模型库时，在过滤器中创建“或”语句的语法是什么？

> ID：10954505
> 
> 赞同：1
> 
> 时间：2012-06-08T18:52:38.710
> 
> 标签：python, django

我正在寻找正确的语法：

```
SomeModel.objects.filter(propertyA = 'foo' OR propertyB = 'bar') 
```

这里的正确语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T18:55:04.287

看这里：[https ://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)

这将是 ：

```
from django.db.models import Q
SomeModel.objects.filter(Q(propertyA=foo) | Q(propertyB=bar)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:55:08.767

使用[Q 对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)：

```
from django.db.models import Q

SomeModel.objects.filter(Q(propertyA='foo') | Q(propertyB='bar')) 
```

# ruby-on-rails - 测试 -rspec Hartl 教程第 8.2 章

> ID：10954506
> 
> 赞同：0
> 
> 时间：2012-06-08T18:52:42.687
> 
> 标签：ruby-on-rails, testing, rspec, railstutorial.org

我一直无法通过考试。我认为问题出在我的 signin_path 上，但我无法弄清楚问题到底出在哪里，任何帮助将不胜感激！

这是失败消息（很长。对此感到抱歉）：

```
bundle exec rspec spec/......................FFFFFFFFFFFFFFFFFF

Failures:

  1) Authentication signin page 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in          `    _app_views_layouts__header_html_erb__3520387809765840673_2170500560'
 # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
 # ./spec/requests/authentication_pages_spec.rb:8:in `block (3 levels) in <top (required)>'

2) Authentication signin page 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:8:in `block (3 levels) in <top (required)>'

  3) Authentication signin with invalid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  4) Authentication signin with invalid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  5) Authentication signin with invalid information after visiting another page 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  6) Authentication signin with valid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  7) Authentication signin with valid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
    # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  8) Authentication signin with valid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  9) Authentication signin with valid information 
     Failure/Error: before { visit signin_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/authentication_pages_spec.rb:15:in `block (3 levels) in <top (required)>'

  10) Static pages Home page 
     Failure/Error: before { visit root_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/static_pages_spec.rb:12:in `block (3 levels) in <top (required)>'

  11) Static pages Home page it should behave like all static pages 
     Failure/Error: before { visit root_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     Shared Example Group: "all static pages" called from ./spec/requests/static_pages_spec.rb:16
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/static_pages_spec.rb:12:in `block (3 levels) in <top (required)>'

  12) Static pages Home page it should behave like all static pages 
     Failure/Error: before { visit root_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     Shared Example Group: "all static pages" called from ./spec/requests/static_pages_spec.rb:16
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/static_pages_spec.rb:12:in `block (3 levels) in <top (required)>'

  13) User pages signup page 
     Failure/Error: before { visit signup_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:8:in `block (3 levels) in <top (required)>'

  14) User pages signup page 
     Failure/Error: before { visit signup_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:8:in `block (3 levels) in <top (required)>'

  15) User pages profile page 
     Failure/Error: before { visit user_path(user) }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:17:in `block (3 levels) in <top (required)>'

  16) User pages profile page 
     Failure/Error: before { visit user_path(user) }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:17:in `block (3 levels) in <top (required)>'

  17) User pages signup with invalid information should not create a user
     Failure/Error: before { visit signup_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:26:in `block (3 levels) in <top (required)>'

  18) User pages signup with valid information should create a user
     Failure/Error: before { visit signup_path }
     ActionView::Template::Error:
       wrong number of arguments (0 for 1)
     # ./app/helpers/sessions_helper.rb:17:in `current_user'
     # ./app/helpers/sessions_helper.rb:10:in `signed_in?'
     # ./app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__3520387809765840673_2170500560'
     # ./app/views/layouts/application.html.erb:11:in `_app_views_layouts_application_html_erb___1084806681328616491_2159679840'
     # ./spec/requests/user_pages_spec.rb:26:in `block (3 levels) in <top (required)>'

Finished in 0.54083 seconds
40 examples, 18 failures

Failed examples:

rspec ./spec/requests/authentication_pages_spec.rb:10 # Authentication signin page 
rspec ./spec/requests/authentication_pages_spec.rb:11 # Authentication signin page 
rspec ./spec/requests/authentication_pages_spec.rb:20 # Authentication signin with invalid     information 
rspec ./spec/requests/authentication_pages_spec.rb:21 # Authentication signin with invalid information 
rspec ./spec/requests/authentication_pages_spec.rb:25 # Authentication signin with invalid information after visiting another page 
rspec ./spec/requests/authentication_pages_spec.rb:37 # Authentication signin with valid information 
rspec ./spec/requests/authentication_pages_spec.rb:38 # Authentication signin with valid information 
rspec ./spec/requests/authentication_pages_spec.rb:39 # Authentication signin with valid information 
rspec ./spec/requests/authentication_pages_spec.rb:40 # Authentication signin with valid information 
rspec ./spec/requests/static_pages_spec.rb:17 # Static pages Home page 
rspec ./spec/requests/static_pages_spec.rb:7 # Static pages Home page it should behave like all static pages 
rspec ./spec/requests/static_pages_spec.rb:8 # Static pages Home page it should behave like all static pages 
rspec ./spec/requests/user_pages_spec.rb:10 # User pages signup page 
rspec ./spec/requests/user_pages_spec.rb:11 # User pages signup page 
rspec ./spec/requests/user_pages_spec.rb:19 # User pages profile page 
rspec ./spec/requests/user_pages_spec.rb:20 # User pages profile page 
rspec ./spec/requests/user_pages_spec.rb:31 # User pages signup with invalid information should not create a user
rspec ./spec/requests/user_pages_spec.rb:47 # User pages signup with valid information should create a user 
```

这是 authentication_pages_spec.rb 需要'spec_helper'

```
 describe "Authentication" do

     subject { page }

      describe "signin page" do
        before { visit signin_path }

       it { should have_selector('h1', text: 'Sign in') }
       it { should have_selector('title', text: 'Sign in') }
     end

     describe "signin" do
       before { visit signin_path }

       describe "with invalid information" do
         before { click_button "Sign in"}

         it { should have_selector('title', text: 'Sign in') }
         it { should have_selector('div.alert.alert-error', text: 'Invalid') }

         describe "after visiting another page" do
           before { click_link "Home" }
           it { should_not have_selector('div.alert.alert-error') }
         end
       end

     describe "with valid information" do
       let(:user) { FactoryGirl.create(:user) }
       before do
         fill_in "Email", with: user.email
         fill_in "Password", with: user.password
         click_button "Sign in"
       end

        it { should have_selector('title', text: user.name) }
        it { should have_link('Profile', href: user_path(user)) }
       it { should have_link('Sign out', href: signout_path) }
       it { should_not have_link('Sign in', href: signin_path) }
       end
     end
   end 
```

这是 static_pages_spec.rb

```
 require 'spec_helper'

   describe "Static pages" do  
     subject { page }

     shared_examples_for "all static pages" do
       it { should have_selector('h1', text: heading) }
       it { should have_selector('title', text: full_title(page_title)) }
      end

     describe "Home page" do
       before { visit root_path }
      let(:heading)   { 'Sample App' }
      let(:page_title) { '' } 

      it_should_behave_like "all static pages"
      it { should_not have_selector 'title',   text: '| Home' }
       end

     describe "Help page" do
       before { visit help_path }
     let(:heading) { 'Help' }
     let(:page_title) { 'Help' }
      end

     describe "About Us page" do
       before { visit about_path }
     let(:heading) { 'About Us' }
     let(:page_title) { 'About Us' }
      end

     describe "Contact page" do
        before { visit contact_path }
     let(:heading) { 'Contact' }
     let(:page_title) { 'Contact' }
      end
   end 
```

这是 user_pages_spec.rb：

```
 require 'spec_helper'

   describe "User pages" do

     subject { page }

     describe "signup page" do
       before { visit signup_path }

       it { should have_selector('h1', text: 'Sign up') }
       it { should have_selector('title', text: full_title('Sign up')) }
     end

     describe "profile page" do
       let(:user) { FactoryGirl.create(:user) }
       #Code to make a user variable
       before { visit user_path(user) }

       it { should have_selector('h1', text: user.name) }
       it { should have_selector('title', text: user.name) }
     end

     describe "signup" do

       before { visit signup_path }

       let(:submit) { "Create my account" }

       describe "with invalid information" do
         it "should not create a user" do
           expect { click_button submit }.not_to change(User, :count)
         end   
       end

       describe "with valid information" do
         before do
           fill_in "Name",   with: "Example User"
           fill_in "Email",  with: "user@example.com"
           fill_in "Password", with: "foobar"
           fill_in "Confirmation",   with: "foobar"
         end

         it "should create a user" do
           expect { click_button submit }.to change(User, :count).by(1)
         end
       end
     end  
   end 
```

这是 session_helper.rb：

```
 module SessionsHelper
     require 'sessions_helper'

     def sign_in(user)
       cookies.permanent[:remember_token] = user.remember_token
       self.current_user = user
     end

     def signed_in?
        !current_user.nil?
     end

     def current_user=(user)
       @current_user = user
     end

     def current_user(user)
       @current_user ||= User.find_by_remember_token(cookies[:remember_token])
      end
end 
```

我还没有弄清楚如何让 HTML 发布，但如果查看 applicaiton.html.erb 和 _header.html.erb 会有所帮助，请告诉我，我会继续尝试。任何想法将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:03:46.483

SessionsHelper 模块中的最后一个方法 current_user 不需要使用参数 user。这就是您看到错误“参数数量错误（0 代表 1）”的原因。

# sql - oracle pl/sql 结果为一个字符串

> ID：10954511
> 
> 赞同：5
> 
> 时间：2012-06-08T18:52:48.997
> 
> 标签：sql, oracle, stored-procedures, plsql

我正在尝试创建一个简单的存储过程，将查询结果存储到一个字符串中。

```
v_string1 varchar2(100);

Select column1
From dual; 
```

将返回

```
column 1
--------
aaaa
bbbb
cccc 
```

我想将“aaaa, bbbb, cccc' 存储到 v_string1 中。我能想到的只是一个光标......有没有更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-08T19:02:43.367

使用[SQL 小提琴](http://sqlfiddle.com/#!4/d9092/7)：

```
select LISTAGG(name, ',') WITHIN GROUP (ORDER BY 1) AS names
from temp_table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T23:58:55.007

另一个使用纯 SQL 的选项可以在 Oracle 11G 之前使用，但字符串仍限制为 4000 个字符。

```
Select ltrim(max(names), ', ') as names
From (
  Select sys_connect_by_path(name, ' ,') as names
  From (
    Select name, row_number() over (order by name) as rown
    From temp_table
  )
  Start with rown = 1
  Connect by rown = prior rown + 1
) 
```

# javascript - 寻找一个公式来检查一个数字是否是一个数字 2 或更大乘以数字 3 或更大的乘积

> ID：10954513
> 
> 赞同：0
> 
> 时间：2012-06-08T18:52:51.523
> 
> 标签：javascript, math, if-statement

我正在寻找在 IF 语句中使用的公式来确定给定数字是否是数字 2 或更大乘以数字 3 或更大的乘积。

例如，6 是满足要求的最小数字 (2 x 3)。7 没有，8 有 (2 x 4)，9 有 (3 x 3)，10 有 (2 x 5)，11 没有，12 有 (2 x 6)，等等。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T18:57:33.667

听起来你在做[素数测试](https://en.wikipedia.org/wiki/Primality_testing)。您应该查看 Wikipedia 文章 - 他们有几种算法可供选择。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:56:11.687

要检查一个数字是否为 2 的倍数，请使用 mod (%) 运算符。所以

```
if((x%2 == 0) || (x%3 == 0) )
   //x is a multiple of 2 or 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:04:03.970

这会找到 n 至少为 2 的最小因子，然后找到大于该因子且大于 3 的最小因子，一旦找到，它就会返回 true。

```
function myFunction(n) {
    if (isNaN(n) || !isFinite(n) || n%1 || n<6) return false;
    var m = Math.sqrt(n);
    for (var i = 2; i <= m; i++) {
        if (n % i == 0) {
            var divided = n / i;
            for (var j = (i > 2) ? i : 3; i <= n / i; i++) {
                if (divided % j == 0) {
                    return true;
                }
            }
        }
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T19:06:47.997

x 必须是两个因子的倍数...(y, z)

```
flag = false; (boolean. set when found);
for(var y = 2; y < x; y++){
   for(var z = 3; z <= (x/y); z++){
       if(y*z == x){
          flag = true;
       }
   }  
}
if(flag){
  now we know that x meets the requirements
} 
```

# visual-studio-lightswitch - VS LightSwitch debug unable to load data

> ID：10954514
> 
> 赞同：3
> 
> 时间：2012-06-08T18:52:56.787
> 
> 标签：visual-studio-lightswitch

I have just installed Visual Studio LightSwitch 2011\. Every screen that I've created has the same red X with the message "Unable to load data."

I'm creating a desktop application which will have all components, including tech database, on the same machine.

The machine is Windows 7 Home Premium, stand-alone, running Visual Studio 2010 C# Express, SQL Server 2008 R2 Express and Visual Studio LightSwitch 2011 (evaluation period). The database I'm trying to use is a pre-existing database on the local SQL Server Express instance. Other C# apps can use this database.

Currently, the machine has no Internet connectivity since I'm traveling. It shouldn't need it, but I wonder...

Two questions:

1 - Is there anything in the configuration that suggests what may be happening?

2- How do I find the real meaning behind the red X? I've seen articles on how to use Asp.net tracing, but I don't have IIS available. I can only run as a local desktop. Is there a log somewhere that details the error?

-- Update: I haven't found the error, but it's in the project configuration somewhere. I created a new project, connected to the same database, just one table, changed as little as possible, and it runs successfully. Though my problem isn't solved yet, I'm greatly relieved that it can actually work.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T14:21:54.917

此消息似乎具有误导性。当您将表包含到 lightswitch 中时，所有字符串字段都被标记为可搜索。我有一个包含 124 列的表，其中大部分是字符串。我收到相同的错误消息“无法加载数据，请检查网络连接”。当我将可搜索列的数量减少到 20 时，该消息消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T09:40:56.907

Red X 问题通常与权限有关。尤其是附加的 SQL 数据库。您是否检查过运行该应用程序的人是否具有访问数据库的足够权限？

# apache - 用于 Rails 应用程序 Gitlab 的 Apache2 ProxyPass

> ID：10954516
> 
> 赞同：11
> 
> 时间：2012-06-08T18:53:01.260
> 
> 标签：apache, redirect, proxy, apache2, proxypass

我正在尝试使用 Apache2 设置代理，以便对**http://myipaddress.com**的传入请求转到`http://localhost:3000/`运行 Gitlab（rails 应用程序）的位置。以下是我在 Ubuntu 10.04 上的 Apache 配置文件中的内容。我最初可以成功访问 gitlab 默认页面，但是我通过单击其他页面执行的任何后续请求都会转到 404 NOT FOUND 页面。我可以在任何这些失败的重定向前手动输入 /gitlab/ ，它们工作得很好。如何在初始请求之后的每个重定向请求之后重写 /gitlab/ 来完成这项工作？

```
## Setup a proxy which listens on the port that gitlabh does ( from start_server.sh )
ProxyRequests Off
ProxyPass /gitlab/ http://localhost:3000/
ProxyPassReverse /gitlab/ http://localhost:3000/
#DocumentRoot /home/gitlabhq/gitlabhq/public
<Proxy http://localhost:3000/>
  Order deny,allow
  Allow from all
</Proxy> 
```

我知道我可以拥有下面的代码，这将解决我的问题。但是我不知道如何修改gitlab rails服务的前缀。我真的很感激一些帮助！

```
ProxyPass /gitlab/ http://localhost:3000/gitlab/
ProxyPassReverse /gitlab/ http://localhost:3000/gitlab/ 
```

更新：

感谢弗里克的评论，我已经非常接近解决这个问题了。以下是我的 http.conf 文件的一部分。唯一的问题是，当我点击主页按钮或 gitlab 应用程序上的徽标时，它会尝试重定向到 gitlab/，这给了我来自 Apache2 的基本 index.html 文件说“它有效！”。如何配置它以允许我简单地获取 /gitlab 并将我带到 gitlab 的根主视图？谢谢！

```
## For Gitlab using Apache2 Passenger
## Install on Ubuntu by:
## sudo gem install passenger && sudo passenger-install-apache2-module
## but only after running the install_and_configure_git.py script
## and creating a soft link to the rails gitlab /public directory like so:
## sudo ln -s /home/gitlabhq/gitlabhq/public /var/www/gitlab
LoadModule passenger_module /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.13/ext/apache2/mod_passenger.so
PassengerRoot /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.13
PassengerRuby /usr/local/bin/ruby
<VirtualHost *:80>

        ServerName gitlab

        ## Set the overall Document Root
        DocumentRoot /var/www
        <Directory /var/www>
                Allow from all
        </Directory>

        ## Set the Rails Base URI
        RackBaseURI /gitlab
        RailsBaseURI /gitlab
        <Directory /var/www/gitlab>
                Allow from all
                Options -MultiViews
        </Directory>

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-07T01:55:46.140

我遇到了[这个对我有用的要点](https://gist.github.com/3689615)。万一它死了，我会重新发布它。

* * *

### 独角兽配置文件

编辑文件`/home/gitlab/gitlab/config/unicorn.rb`

查找线路听`"#{app_dir}/tmp/sockets/gitlab.socket"`并评论它。取消注释行听`"127.0.0.1:8080"`

### Apache所需的模块

*   sudo a2enmod 代理
*   sudo a2enmod proxy_balancer
*   sudo a2enmod proxy_http
*   sudo a2enmod 重写

### /home/gitlab/gitlab/config/gitlab.conf

```
<VirtualHost *:80>
  ServerName git.domain.com

  # Point this to your public folder of teambox
  DocumentRoot /home/gitlab/gitlab

  RewriteEngine On

  <Proxy balancer://unicornservers>
    BalancerMember http://127.0.0.1:8080
  </Proxy>

  # Redirect all non-static requests to thin
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  RewriteRule ^/(.*)$ balancer://unicornservers%{REQUEST_URI} [P,QSA,L]

  ProxyPass / balancer://unicornservers/
  ProxyPassReverse / balancer://unicornservers/
  ProxyPreserveHost on

  <Proxy *>
    Order deny,allow
    Allow from all
  </Proxy>

  # Custom log file locations
  ErrorLog  /var/log/apache2/gitlab_error.log
  CustomLog /var/log/apache2/gitlab_access.log combined
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T10:46:23.600

```
<VirtualHost *:80>

        ServerName gitlab

        ## Set the overall Document Root
        DocumentRoot /var/www
        <Directory /var/www>
                Allow from all
        </Directory>

        ## Set the Rails Base URI
        RackBaseURI /gitlab
        RailsBaseURI /gitlab
        <Directory /var/www/gitlab>
                Allow from all
                Options -MultiViews
        </Directory>

</VirtualHost> 
```

您的 httpd.conf 或您的站点配置文件中的这些设置应该可以。，如果您有任何反向代理设置，请删除并尝试，它会起作用。，

如果您有以下几行以及上述配置，请删除以下几行，

```
ProxyPass /gitlab/ http://localhost:3000/gitlab/
ProxyPassReverse /gitlab/ http://localhost:3000/gitlab/
Proxy on 
```

重新启动您的网络服务器

```
service apache2 restart 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-13T21:42:19.547

这是以防新人遇到此问题。

这对我有帮助，请注意**ProxyPassReverse**行。我的完整问题和解决方案位于[https://stackoverflow.com/a/22390543/3112527](https://stackoverflow.com/a/22390543/3112527)。

```
<IfModule mod_ssl.c>
<VirtualHost *:443>
  Servername gitlab.my_domain.com
  ServerAdmin my_admin@my_domain.com

  SSLCertificateFile /etc/apache2/ssl.crt/gitlab_my_domain.crt
  SSLCertificateKeyFile /etc/apache2/ssl.crt/gitlab_my_domain_private.key
  SSLCACertificateFile /etc/apache2/ssl.crt/gitlab.ca-bundle

  ##### All the other Apache SSL setup skipped here for StackOverflow ####

  ProxyPreserveHost On

  <Location />
    # New authorization commands for apache 2.4 and up
    # http://httpd.apache.org/docs/2.4/upgrading.html#access
    Require all granted

    # For relative URL root "host:your_gitlab_port/relative_root"
    #ProxyPassReverse http://127.0.0.1:8085/gitlab
    #ProxyPassReverse https://gitlab.my_domain.com/gitlab

    # For non-relative URL root
    ProxyPassReverse http://127.0.0.1:8085
    ProxyPassReverse https://gitlab.my_domain.com/
  </Location>

  # apache equivalent of nginx try files
  # http://serverfault.com/questions/290784/what-is-apaches-equivalent-of-nginxs-try-files
  # https://stackoverflow.com/questions/10954516/apache2-proxypass-for-rails-app-gitlab
  RewriteEngine on
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  RewriteRule .* http://127.0.0.1:8080%{REQUEST_URI} [P,QSA]
  RequestHeader set X_FORWARDED_PROTO 'https'

  # needed for downloading attachments
  DocumentRoot /home/git/gitlab/public

  #Set up apache error documents, if back end goes down (i.e. 503 error) then a maintenance/deploy page is thrown up.
  ErrorDocument 404 /404.html
  ErrorDocument 422 /422.html
  ErrorDocument 500 /500.html
  ErrorDocument 503 /deploy.html

  LogFormat  "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b" common_forwarded
  ErrorLog      /var/log/apache2/gitlab-ssl_error.log
  CustomLog /var/log/apache2/gitlab-ssl_forwarded.log common_forwarded
  CustomLog /var/log/apache2/gitlab-ssl_access.log combined env=!dontlog
  CustomLog /var/log/apache2/gitlab-ssl.log combined
</VirtualHost>
</IfModule> 
```

（来自[https://github.com/gitlabhq/gitlab-recipes/blob/master/web-server/apache/gitlab-ssl-apache2.4.conf](https://github.com/gitlabhq/gitlab-recipes/blob/master/web-server/apache/gitlab-ssl-apache2.4.conf)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-21T14:29:14.180

我在谷歌上搜索我在使用 Apache（在端口 80 上）设置 Rails + unicorn 以代理到 unicorn（在端口 3000 上）时遇到的错误最终来到了这里。如果它对其他人有用，这是我的配置：

```
<VirtualHost example.com:80>
  ServerAdmin webmaster@example.com
  ServerName example.com
  ServerAlias www.example.com

  ProxyPreserveHost On
  <Location />
      Require all granted
      ProxyPassReverse http://example.com:3000
  </Location>

  RewriteEngine on
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  RewriteRule .* http://example.com:3000%{REQUEST_URI} [P,QSA]

  DocumentRoot /home/user/rails-dir/public
  ErrorDocument 404 /404.html
  ErrorDocument 422 /422.html
  ErrorDocument 500 /500.html
  ErrorDocument 503 /deploy.html

  LogLevel warn
  ErrorLog /home/user/rails-dir/log/apache-error.log
  CustomLog /home/user/rails-dir/log/apache-access.log combined
</VirtualHost> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-13T08:55:07.560

这个问题也困扰了我很久。现在已经修好了。
最有用的资源来自 Gitlab 官方文档，关于[using-a-non-bundled-web-server](https://docs.gitlab.com/omnibus/settings/nginx.html#using-a-non-bundled-web-server)。
他们还提供完整的可行[配方](https://gitlab.com/gitlab-org/gitlab-recipes/tree/master/web-server/apache)。

> 如果您使用的是 Apache 2.4 或更高版本，请分别使用文件 gitlab-apache24.conf 或 gitlab-ssl-apache24.conf 用于 vhost 的 HTTP 和 HTTPS 版本。
> 
> 如果您使用的是 Apache 2.2 版，请分别使用文件 gitlab-apache22.conf 或 gitlab-ssl-apache22.conf 用于虚拟主机的 HTTP 和 HTTPS 版本。

现在的问题很简单

> 确保选择正确的配置文件，具体取决于您是否选择使用 SSL 服务 GitLab。您唯一需要更改的是`YOUR_SERVER_FQDN`您自己的 FQDN，如果您使用 SSL，您的 SSL 密钥当前所在的位置。您可能还需要更改日志文件的位置。

要确保 Apache2 版本，请使用`apache2 -version`
如果使用 HTTPS 版本，您可能需要确保正确部署您的证书文件，例如文件放置与指定的配方文件一致。

# java - 为什么使用 `return x == 5 ？真：假；`？

> ID：10954518
> 
> 赞同：21
> 
> 时间：2012-06-08T18:53:06.413
> 
> 标签：java, boolean

我看不到这种编码实践的优势。我现在正在处理的项目充满了这些陈述，所以这不是一个错误。

另一个例子：

```
return getNumberOfBooks() > 5 ? true : false; 
```

还有一个：

```
return isRed() ? true : false; 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-06-08T18:55:35.160

绝对没有理由这样做。

它是多余的，使代码更难阅读。

以下内容更容易阅读：

```
return ( getNumberOfBooks() > 5 );

return isRed(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T19:03:20.103

看来您正在与新手程序员一起做一个项目。从你看到的地方开始重构：

```
return getNumberOfBooks() > 5 ? true : false;
return isRed() ? true : false; 
```

通过以下方式更改：

```
return getNumberOfBooks() > 5;
return isRed(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T18:59:06.467

三元运算符使代码几乎不可读，认为这是一种聪明的编码方式，但除非确实需要，否则不应鼓励

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-08T19:23:59.270

显然这是不必要的冗余。

我建议在 Eclipse 中这样做：

1.  找到所有匹配正则表达式“return (something) ? true : false”并将其替换为`something`
2.  和所有匹配正则表达式 "return (something) ? false : true" with !(something)

您可以将此正则表达式的编写委托给编写此项目的人：D

# python - Sending message to RabbitMQ (pika) from scheduler callback doesn't work

> ID：10954520
> 
> 赞同：0
> 
> 时间：2012-06-08T18:53:07.280
> 
> 标签：python, scheduling, rabbitmq, pika

I need different messages to be sent to the queue - each by its personal schedule. So I have message list and related interval to resend each one. I use rabbitMQ/pika and apscheduler. According to numerous examples, I created the simplest BlockingConnection/channel/queue. When immediately after that I try to push messages - everything works fine, I can see in rabbitmq web-interface that all the messages become in the queue. Here is the piece of code that works:

```
 self.cr = Queue('DIRECT_C_QUEUE', True, ex_type='direct')
    for i in range(1,10000):
        self.cr.channel.basic_publish(exchange='', routing_key='DIRECT_C_QUEUE', body='hello_world') 
```

But if I try to push messages (in exactly same way) via apscheduler callback function - only few (about 1-10) messages appear in the queue (but callbacks are fired all the time and there are no any exception when publishing message!).

Finally I begin to receive such warnings:

> /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pika/connection.py:642: UserWarning: Pika: Write buffer exceeded warning threshold at 1125 bytes and an estimated 43 frames behind warn(message % (self.outbound_buffer.size, est_frames_behind))

and still no new messages in the queue.

I am new in python, any help is much appreciate.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T07:50:04.773

我找到了问题的根源：apscheduler 在单独的线程中运行**basic_publish**调用，而 pika 不建议在线程之间共享连接 - [http://pika.github.com/faq.html](http://pika.github.com/faq.html)

所以我可以选择每次创建新连接，或者将新消息放入某个队列并从主线程（创建连接的位置）发布它们。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T16:04:25.940

我通过增加 ulimit 解决了这个问题

编辑 /etc/default/rabbitmq-server 并设置

> ulimit -n 4096

然后重启rabbitmq

> sudo /etc/init.d/rabbitmq-server 重启

# c# - ASP.Net MVC3/4 multiple templates

> ID：10954522
> 
> 赞同：2
> 
> 时间：2012-06-08T18:53:30.970
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-4

There is any way to change the defualt views path in MVC3/4\. i.e: The Url `http://localhost:000/Home` (the controller Home) will represent the view at `Views/Style1/Home/Action`.

Thanks ahead!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:46:44.527

好的，现在我在编辑后更好地理解了这个问题，我认为这就是你要找的：

您可以在 Application_Start() 中更改 ViewLocation。
下面的示例假定使用 Razor 视图引擎。

```
ViewEngines.Engines.Clear();
ViewEngines.Engines.Add(new RazorViewEngine { ViewLocationFormats = new string[] { "~/Views/Style1/{1}/{0}.cshtml" } } ); 
```

*答案部分来自[这篇文章并被引用](https://stackoverflow.com/questions/2735240/change-the-views-location)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:07:41.923

您应该能够为您的应用程序设置默认路由以使用不同的基本路径。您通常可以在 RegisterRoutes 方法的 Global.asax 中设置路由。

例子：

```
routes.MapRoute(
                "Default", // Route name
                "Style1/{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
            ); 
```

# c# - Why does the DragLeave Event not use the DragEventHandler?

> ID：10954530
> 
> 赞同：2
> 
> 时间：2012-06-08T18:54:21.360
> 
> 标签：c#, .net, winforms

I only noticed this because I mistakenly tried to attach a DragEventHandler to a DragLeave event. I was surprised to see that the DragLeave Event was just as a general EventHandler. This is odd to me because both the DragDrop Event and the DragEnter Event use DragEventHandlers. Is there a reason or explanation for this?

Resources:

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragleave](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragleave) [http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragenter](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragenter) [http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragdrop](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragdrop)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:16:43.457

是的。在处理`DragEnter`or时`DragDrop`，我们通常需要或更新附加信息（例如当前拖动效果、活动修饰键或实际涉及的数据）。因此，传递给处理程序的事件参数必须提供对该信息的访问。

另一方面，我们可以（或应该）做的事情不多`DragLeave`。我们不能取消休假。我们无法更改拖动引擎的行为或鼠标指针的形状，因为它是，嗯，*是*系统告诉我们的方式`thank you for your cooperation, we're done now, maybe we'll get in touch with you again in the future`。

# c# - How to create a custom property?

> ID：10954532
> 
> 赞同：1
> 
> 时间：2012-06-08T18:54:27.630
> 
> 标签：c#, wpf, xaml

I need to create a custom property meaning rather using

```
<Style x:Key="ABC" TargetType="Rectangle">
    <Setter Property="Fill" Value="Red"/>
</Style> 
```

I like to have something like Rectangle and assign it an ID so later when it is dropped on Canvas I can retrieve its ID.

```
<Style x:Key="ABC" TargetType="Rectangle">
    <Setter Property="Fill" Value="Red"/>
    **<Setter Property="ID" Value="1234567890-ABC"/>**
</Style> 
```

How can I define that custom property?

Regards, Amit

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:35:08.633

在单独的类中定义自定义附加属性：

```
public class Prop : DependencyObject
{
    public static readonly DependencyProperty IDProperty =
        DependencyProperty.RegisterAttached("ID", typeof(string), typeof(Prop), new PropertyMetadata(null));

    public static void SetID(UIElement element, string value)
    {
        element.SetValue(IDProperty, value);
    }

    public static string GetID(UIElement element)
    {
        return (string)element.GetValue(IDProperty);
    }
} 
```

然后你可以使用这个：

```
<Setter Property="local:Prop.ID" Value="1234567890-ABC"/> 
```

`local`必须在 XAML 的根元素中定义，大致如下：

```
xmlns:local="clr-namespace:AttPropTest" 
```

程序集的命名空间在哪里`AttPropTest`。

在代码中，您可以使用 确定 ID `Prop.GetID(myRect)`。

# android - opencv problems on Android

> ID：10954535
> 
> 赞同：1
> 
> 时间：2012-06-08T18:54:53.507
> 
> 标签：android, eclipse, opencv, edge-detection, javacv

Please we need help urgently, we are using openCv in Android (Java). We are facing a lot of problems:

convertTo() doesn't work so we can't convert 3 channel image to 1 channel without passing it on cvtColor().

```
grayImg.convertTo(grayImg, CvType.CV_8UC1); 
```

cvtColor() gives a weird output:

```
Imgproc.cvtColor(src, grayImg, Imgproc.COLOR_RGB2GRAY); 
```

Output of this line is the image repeated 4 times! The only way to get rid of this repetition is to add this line and the output is a white and black image but 3 channel so it crashes any coming function because it needs 1 channel image.

```
Imgproc.cvtColor(grayImg, grayImg, Imgproc.COLOR_GRAY2RGB,3); 
```

canny() for edge detection:

```
Imgproc.Canny(grayImg, grayImg, 10, 100,3,true); 
```

findContours() counts a horrible number of contours while number of objects in the image is only 2 input image is 3 channel bmp image and we convert it to Mat.

output image:

[https://dl.dropbox.com/u/36214963/canny.jpg](https://dl.dropbox.com/u/36214963/canny.jpg)

Thanks for your concern

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T09:31:14.630

尝试`BGR2GRAY`而不是`RGB2GRAY`。我有同样的问题，我通过这个解决了。文档中还有一个关于这个的注释

> 将图像从一种颜色空间转换为另一种颜色空间。

该函数`cvtColor`将输入图像从一种颜色空间转换为另一种颜色空间。在从 RGB 颜色空间转换的情况下，通道的顺序应明确指定 ( `RGB or BGR`)。**请注意，OpenCV 中的默认颜色格式通常称为 RGB，但实际上是 BGR（字节反转）。**因此，标准（24 位）彩色图像中的第一个字节将是 8 位蓝色分量，第二个字节将是绿色，第三个字节将是红色。然后第四、第五和第六个字节将是第二个像素（蓝色，然后是绿色，然后是红色），依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T08:55:59.480

我以前实际上没有使用过opencv，但我认为这不是`convertTo`您要寻找的答案。

通过查看 opencv 文档，我发现[了这一点](http://opencv.itseez.com/modules/imgproc/doc/miscellaneous_transformations.html)：

> cvtColor - 将图像从一种颜色空间转换为另一种颜色空间

```
Mat color; // the input image
Mat gray(color.rows, color.cols, color.depth()); 
cvtColor(color, gray, CV_BGR2GRAY); 
```

或者简单地说（该函数`cvtColor`将在内部创建图像）：

```
Mat color;
Mat gray;
cvtColor(color, gray, CV_BGR2GRAY); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T10:47:08.360

如果我正确理解您的第一个问题，您有两个选项可以将 RGB 图像转换为灰度图像。

选项 1：按照您的尝试将 3 通道图像转换为 1 通道。

```
IplImage *RGB_image = cvLoadImage("my_colored_image.jpg");
IplImage *GRAY_IMAGE = cvCreateImage(cvGetSize(RGB_image), IPL_DEPTH_8U, 1);
cvCvtColor(RGB_image, GRAY_IMAGE, CV_RGB2GRAY); 
```

选项2：直接将彩色图像读取为灰度图像。

```
IplImage* GRAY_IMAGE = cvLoadImage("my_colored_image.jpg", CV_LOAD_IMAGE_GRAYSCALE); 
```

我希望这适合你。

# python - 监控流类

> ID：10954544
> 
> 赞同：2
> 
> 时间：2012-06-08T18:55:17.040
> 
> 标签：python, stream

我正在尝试创建一个流对象，该对象在数据写入任何时候触发回调函数。

```
class MonitoredStream():
    def __init__(self, outstream, callback):
        self.outstream = outstream
        self.callback = callback

    def write(self, s):
        self.callback(s)
        self.outstream.write(s)

    def __getattr__(self, attr):
        return getattr(self.outstream, attr) 
```

当我直接调用 write 方法时，这很好用，但是当我有一个子进程的输出连接到流时，我希望它也能正常工作。例如：

```
def f(s):
    print("Write")

p = sub.Popen(["sh", "test.sh"], stdout=MonitoredStream(sys.stdout, f))
p.communicate() 
```

这只是将输出直接发送到 sys.stdout，完全绕过了 write 函数。有没有办法我也可以监控这个输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:15:59.123

我相信这里的问题是它`subprocess.Popen`不使用管道的 Python 接口 - 它而是获取文件描述符，然后使用它直接写入管道，当你给出`stdout`管道的属性时，这意味着它使用它，绕过你的代码。

解决这个问题我最好的猜测是在中间制作一个新的中间管道，让您自己处理流。我会将其实现为上下文管理器：

```
import sys
import os
from subprocess import Popen
from contextlib import contextmanager

@contextmanager
def monitor(stream, callback):
    read, write = os.pipe()
    yield write
    os.close(write)
    with os.fdopen(read) as f:
        for line in f:
            callback(line)
            stream.write(line)

def f(s):
    print("Write")

with monitor(sys.stdout, f) as stream:
    p = Popen(["ls"], stdout=stream)
    p.communicate() 
```

当然，尽管您仍然可以使用类：

```
import sys
import os
from subprocess import Popen

class MonitoredStream():
    def __init__(self, stream, callback):
        self.stream = stream
        self.callback = callback
        self._read, self._write = os.pipe()

    def fileno(self):
        return self._write

    def process(self):
        os.close(self._write)
        with os.fdopen(self._read) as f:
            for line in f:
                self.callback(line)
                self.stream.write(line)

def f(s):
    print("Write")

stream = MonitoredStream(sys.stdout, f)
p = Popen(["ls"], stdout=stream)
p.communicate()
print(stream.process()) 
```

虽然我觉得这不太优雅。

# sql-server - Meaning of CAST('1/1' + ...... as DATETIME)?

> ID：10954548
> 
> 赞同：1
> 
> 时间：2012-06-08T18:55:32.063
> 
> 标签：sql-server, tsql

In the following T-SQL Code:

```
wt.clsdt_date >= CAST('1/1/' + CAST(2011 - 1 AS varchar) AS DateTime) 
```

what does '1/1' mean?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:57:11.617

（有关 SQL 的改进，请参阅其他答案。）

`'1/1/'`is 字符串，因此`+`is之后的结果字符串`'1/1/year'`，例如

```
 '1/1/' + CAST(2011 - 1 as varchar)
-> '1/1/' + '2010'
-> '1/1/2010' 
```

然后将其强制转换（实际上是转换）为适当的类型。

如果没有更漂亮的方法来做到这一点，我会感到惊讶。

对于 SQL Server 2008 及之前[的版本，似乎没有特别好的标准方法](https://stackoverflow.com/questions/266924/create-a-date-with-t-sql)。

对于 SQL Server 2012，`DATEFROMPARTS`如[相关的 SO 帖子](https://stackoverflow.com/questions/5772866/how-to-create-dates-from-date-components-in-sql-t-sql)所示：

```
SELECT DATEFROMPARTS(@Year, @Month, @Day) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T19:12:32.950

一个更安全的方法是：

```
WHERE wt.clsdt_date >= CONVERT(CHAR(4), 2011 - 1) + '0101'; 
```

您无需将其显式转换为 a `datetime`，但您可以：

```
WHERE wt.clsdt_date >= CONVERT(DATETIME, CONVERT(CHAR(4), 2011 - 1) + '0101'); 
```

这使用非区域日期格式，并且仍然使用列上的索引（如果存在）。

[没有长度也是一个坏习惯](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)。[`varchar`](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T19:03:25.687

此技术用于评估 wt.clsdt_date 是否在 2010 年期间或之后。完成此操作的更简洁方法如下：

```
YEAR(wt.clsdt_date) >= 2010 
```

# php - Limit Text and make sure there are no tags open

> ID：10954549
> 
> 赞同：1
> 
> 时间：2012-06-08T18:55:32.500
> 
> 标签：php, truncate

So i have a list of articles, and I have a page in which shows 4 articles at a time and then shortens the description of the article to 1000 characters and allows users to "read more", my problem is within each post there could be tags IE: `<i>` or `<b>` `<img>` `<center>` etc, how when truncating the text can I see if there are any open tags within the div or within the called upon text?

Here is how it looks for now

```
$sum = strip_tags($article, '<a><i><b><u><center><br><img><a><span><iframe>');
    if (strlen($sum) > 1000) {
        $sumCut = substr($sum, 0, 1000);
        $sum = substr($sumCut, 0, strrpos($sumCut, ' ')).'... <div class="right"><a href="article-' .$record[nid]. '">Read More</a></div>'; 
}

 echo $sum; 
```

For example

If I have...

*Quisque imperdiet imperdiet fringilla. Quisque sit amet nibh odio. Fusce sit amet massa vitae mi faucibus viverra.*

The code fo that would be `<i>Quisque imperdiet imperdiet fringilla. Quisque sit amet nibh odio. Fusce sit amet massa vitae mi faucibus viverra.</i>`

but if I were to set my truncating number to say 10, it would leave that tag open and thus everything afterwords would be in italics

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:53:43.640

如此动态让我很接近，但使用`strpos()`是关键，我将它添加到我的代码中`if ((strpos($sum, '<i>')) && (!strpos($sum, '</i>'))) { echo "</i>"; }`，并为我允许的每个标签添加一个类似的，接下来要做的是弄清楚如何确保在结尾附近没有图像或 iframe在这篇文章中，我将对其进行编辑以解释我是如何做到的，但现在这是我的代码......

```
$sum = strip_tags($article, '<a><i><b><u><center><br><img><a><span><iframe>');
if (strlen($sum) > 1000) {
    $sumCut = substr($sum, 0, 1000);
    $sum = substr($sumCut, 0, strrpos($sumCut, ' '));
    $cut = 1; 
}else{
    $cut = 0; }

echo $sum;
if ((strpos($sum, '<i>')) && (!strpos($sum, '</i>'))) { echo "</i>"; }

if ($cut==1) { echo '... <div class="right"><a href="article-' .$record[nid]. '">Read More</a></div>'; } 
```

**编辑：**

好的，我想出了一个比确保帖子末尾没有图像更好的解决方案，我只是制作了`overflow: hidden;`可以调整图像大小的 div

**编辑：**

我也遇到了打破标签中间的问题`<br>`，它给我留下了`<br`一个临时修复似乎是`<br>`在所有这些情况下留下错误代码的所有内容之后添加另一个，`<br<br>`但至少一切正常并且不可见，但如果有人有更可行的解决方案请告诉我

我希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:25:06.407

使用[`strpos()`](http://php.net/manual/en/function.strpos.php)，在前 X 个字符中搜索打开的标签（其中 X 是截断的数字。）然后如果为真，则添加到字符串中。

基本上，（伪代码）

```
if(first10chars.contains[use strpos here] "<i>" and !.contains "</i>") {
$endstr .= "</i>";
} 
```

并为其他人做同样的事情。一个非常糟糕的方法，但它会工作

# asp.net - 我可以使用 GridView SelectedIndexChanged 代替 RadioButtonList SelectedIndexChanged 吗？

> ID：10954553
> 
> 赞同：0
> 
> 时间：2012-06-08T18:55:45.537
> 
> 标签：asp.net, vb.net, gridview, event-handling, radiobuttonlist

我有几个原因需要发生这种情况，但我只想说，当我使用 RadioButtonList 的事件处理程序时，发送者对象仅作为 RadioButtonList 返回，我需要来自 GridView 的更多信息，因为这就是我唯一能做到的确定我的 RadioButtonList 绑定到哪个记录。

我在我的 GridView 中添加了一个“OnSelectedIndexChanged”属性，但是当我想要它时它不会触发/处理。我假设这与 GridView 的设计工作方式有关。

有没有人对如何做到这一点或更好的选择有任何建议？

我还考虑过使用隐藏字段，但我无法将其添加到 RadioButtonList 中，因此除非它是全局的，否则它不会有帮助。它是全球性的问题是我无法将值唯一设置为已更改 RadioButtonList 的记录。

清如泥？请询问您是否需要任何澄清。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:45:55.777

只是想我会添加一个答案并解释我是如何解决我的问题的。

由于范围太窄，我需要在单选按钮列表中添加一个自定义字段。我只是继续添加以下代码：

```
MyRadioButtonList.Attributes.Add("NecessaryField") 
```

我添加了这个，以便每次网格视图行被数据绑定时，该代码都会执行，确保每个 RadioButtonList 都有这个字段。

之后就可以使用了。

# c# - Access page property from a generic ajax call to a library

> ID：10954557
> 
> 赞同：0
> 
> 时间：2012-06-08T18:56:10.307
> 
> 标签：c#, .net, ajax, telerik

I'm using telerik tools and have a tool that runs code server side from a class library on an ajax call.

This control can come from any page. And I can access the page by the telerik object that's passed in.

Now, some of these pages have a property that I want to access, but I want to keep it generic.

I can cast the page as a specific page type and expose the property, but that would require an update to the class library every time that property is added to a page.

What I'm wondering is if there is a way for me to check to see if a property exists on the page, then access it if it does?

```
((Telerik.Web.UI.ControlItemContainer)((RadComboBox)o)).Page 
```

This is how I access the page, which just returns a page object. I want to check to see if that page object contains a property without casting it.

Or if I can cast the page with using gettype(), that would work as well.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:03:13.097

你可以使用[反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.100%29.aspx)：

```
System.Reflection.PropertyInfo propInfo = 
    theObjectYouWantToReflect.GetType().GetProperty("YourPropertyName");

if (propInfo != null)
{
    object value = propInfo.GetValue(Page, null);
    // ...
} 
```

# python - 安装 Mac OSX 后检测 PythonMagick 的问题

> ID：10954568
> 
> 赞同：0
> 
> 时间：2012-06-08T18:56:44.430
> 
> 标签：python, macos, import, imagemagick, pythonmagick

我按照[https://gist.github.com/2778301](https://gist.github.com/2778301)上的说明进行操作，但是当我尝试这样做时，`import PythonMagick`我收到了错误消息：

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "PythonMagick/__init__.py", line 1, in <module>
    from . import _PythonMagick
ImportError: cannot import name _PythonMagick 
```

PythonMagick.so 在我的 python2.7 站点包中。

编辑：我通过从`make install`安装 PythonMagick`/usr/local/lib/python2.7/site-packages/PythonMagick`的位置复制到 Python 在 OS X Lion 上实际显示的位置解决了这个问题，`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:07:46.930

[您提供的链接](https://gist.github.com/2778301)上有您的问题的答案：

这可以通过更改`__init__.py`PythonMagick 中的第一行来解决，该行通常位于`site-packages`目录中，例如，

```
python2.7/site-packages/PythonMagick 
```

尝试改变：

```
from . import _PythonMagick 
```

至

```
import _PythonMagick 
```

# asp.net - VS2012 RC、AjaxControlToolkit 和智能标签未出现

> ID：10954570
> 
> 赞同：1
> 
> 时间：2012-06-08T18:56:47.803
> 
> 标签：asp.net, visual-studio, ajaxcontroltoolkit, visual-studio-2012

我正在使用 VS2012 RC。我已经使用 Nuget 添加到 Ajax Control Toolkit 中。

几个问题：

1.  工具箱应该填充 AJAX 控件吗？我知道我可以通过创建一个新选项卡并添加 dll 来添加它们，但是每次我开始一个新的 Web 项目时都需要这样做吗？

2.  在 VS2008 中，当我包含 AJAX 控件工具包时，智能标签将开始出现在文本框控件之类的东西上，允许我添加扩展器。在 VS2012 中，智能标签没有出现，所以我最终不得不手动将扩展器添加到代码中。这是预期的吗？还是配置不正确？

3.  我通常使用文本框水印控件而不是表单字段的标签。添加水印文本的首选方法是什么？AJAXControl 工具包还是 JQuery？

# java - Struts 2 Form 中 JP 和 Ko 的扭曲字符

> ID：10954577
> 
> 赞同：0
> 
> 时间：2012-06-08T18:57:25.980
> 
> 标签：java, unicode, localization, struts2, cjk

我在使用 JDK 1.7 的 Tomcat 6 服务器上使用 Struts 2 应用程序。我们支持超过 15 种语言。我有一个发送电子邮件的表格，有两个问题：

1.  当我在表单中输入任何日文或韩文字符并提交时，电子邮件正文包含所有 ????????

2.  我在表单页面上有一个验证码。如果我为日语或韩语输入了无效的验证码并单击提交，它会返回同一页面，并保留用户名、电子邮件等。但是，保留的字符已损坏，并且不会保持与输入时相同的语言. 但是，这只发生在日语和韩语中。

我在页面顶部的 JSP 中有这一行：

```
 <%@ page contentType="text/html; charset=UTF-8"%> 
```

此外，`server.xml`还有一个指定 URIEncoding="UTF-8" 的连接器元素

这两个问题在其他语言中不存在。谁能告诉我我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:39:55.917

编码问题似乎发生在您提交表单后，在准备电子邮件并发送它的代码中。您的电子邮件程序是否允许您查看电子邮件的原始数据？电子邮件的（声明的）编码是什么？您可以让您的电子邮件应用程序选择编码吗？（在这种情况下，请确保选择了 UTF-8）？

# list - ExtJS 组合框在过滤商店后调整列表框高度

> ID：10954580
> 
> 赞同：1
> 
> 时间：2012-06-08T18:57:38.070
> 
> 标签：list, extjs, autocomplete, combobox, resize

我将组合框用于自动完成目的，我想知道如何调整组合框列表的大小，以使列表的高度与列表中的当前值数相匹配。

例如，用户在框中键入“62”，自动完成功能进行 ajax 调用以从数据库中获取与此匹配的值。假设返回了 100 个值。列表的高度将是 maxHeight 值（300px），因为列表中的数据多于无法容纳的数据，并且会有一个滚动条。完美的。

但是随后用户在“62”（“623”）之后键入了“3”，因此我过滤了当前存储（具有 100 个值）并删除了任何与“623”不匹配的值。假设这给我们留下了 4 个条目。

问题是列表仍在扩展到 300px，但其中只有 4 个值。显然没有滚动条，但我仍然希望缩小高度以适应数据，就像我从数据库中重新提取数据一样（它在您加载新商店时起作用）。

我做了以下事情：

```
qe.combo.list.setHeight(qe.combo.maxHeight)                  
if (this.getStore().getCount() * 20 < qe.combo.list.getHeight()){
    qe.combo.list.setHeight(this.getStore().getCount() * 20)
} 
```

除了在一种情况下，这似乎工作正常。在下拉（选择器？）列表从组合框向下打开的任何页面上，这都很好。

但是在组合框可能位于页面底部附近的屏幕上（这使得列表在组合框上方打开），然后更改列表的高度会从下向上缩短它 - 这意味着如果框是 300 像素并且我缩短了它4 个项目的 80 像素，框将正确地为 80 像素，但现在组合框和列表之间会有 220 像素的间隙。那有意义吗？基本上，它会以与列表位于组合框下方的相同方式缩短它......它没有考虑到列表位于框上方的事实。

我真的对这个家伙不知所措。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-12T14:18:52.547

尝试使用组合框的配置属性。

```
listConfig:{
    maxHeight:  200// number which suits your need for list box height
} 
```

此配置应满足您在过滤时对动态列表高度的需求。

# objective-c - 将 struct 声明为指针，以便检查它是否已初始化

> ID：10954581
> 
> 赞同：0
> 
> 时间：2012-06-08T18:57:48.767
> 
> 标签：objective-c, c, pointers, struct, null

在下面的代码中，我想知道`viewTransform`结构是否被初始化，以确定是否旋转我的视图。所以我做`viewTransform`了一个指针，而不仅仅是一个常规变量。

这是良好的编程实践，还是有一些潜在的警告？

如果必须，我可以改为声明 a`BOOL`来跟踪是否`viewTransform`已初始化。

```
- (void)deviceOrientationDidChange
{
    UIDeviceOrientation deviceOrientation = [[UIDevice currentDevice] orientation];

    CGAffineTransform *viewTransform = NULL;

    if (deviceOrientation == UIDeviceOrientationPortrait)
    {
        *viewTransform = CGAffineTransformIdentity;
    }
    else if (deviceOrientation == UIDeviceOrientationPortraitUpsideDown)
    {
        *viewTransform = CGAffineTransformMakeRotation(M_PI * 1.0f);
    }
    else if (deviceOrientation == UIDeviceOrientationLandscapeLeft)
    {
        *viewTransform = CGAffineTransformMakeRotation(M_PI * -0.5f);
    }
    else if (deviceOrientation == UIDeviceOrientationLandscapeRight)
    {
        *viewTransform = CGAffineTransformMakeRotation(M_PI * 0.5f);
    }

    if (viewTransform != NULL)
    {
        for (UIView *view in self.autoRotateViews)
        {
            [view setTransform:(*viewTransform)];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:02:16.890

这将像地狱一样崩溃。您将 viewTransform 声明为 NULL，然后取消引用它。相反，不要让它成为指针。采用

```
CGAffineTransform viewTransform; 
```

相反，是的，使用 BOOL 跟踪初始化状态。

如果您真的想避免使用 BOOL 以使事情变得过于复杂，您还可以这样做：

```
CGAffineTransform *viewTransform = NULL;
if (deviceOrientation == UIDeviceOrientationPortrait)
{
    viewTransform = malloc(sizeof(*viewTransform));
    NSAssert(viewTransform != NULL, @"malloc() failed");
    *viewTransform = CGAffineTransformIdentity;
} 
```

然后检查 viewTransform 是否为 NULL（未初始化）或非 NULL（已初始化）。

如果您选择这种（过于复杂）的方法，使用后不要忘记`free()`转换指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T11:50:55.223

H2CO3 是正确的，你写的东西会崩溃。

您可以只附加`else return;`到 if-else-if-... 链的末尾，以避免整个需要检查转换是否已设置。

编辑澄清：当然，我的意思是上述作为使用指针的替代方法。所以，我建议只是恢复`viewTransform`为一个`CGAffineTransform`，而不是一个指针，然后如果你没有将它设置为任何东西，那么就提前返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-18T13:13:06.487

```
 switch (orientation) {
    case UIDeviceOrientationLandscapeLeft:
        t = CGAffineTransformMakeRotation(M_PI_2);
        break;
    case UIDeviceOrientationLandscapeRight:
        t = CGAffineTransformMakeRotation(-M_PI_2);
        break;
    case UIDeviceOrientationPortraitUpsideDown:
        t = CGAffineTransformMakeRotation(M_PI);
        break;
    case UIDeviceOrientationPortrait:
        t = CGAffineTransformIdentity;
        break;
    default:
        return;
} 
```

# android - 如何启动新活动实现 RadioGroup.OnCheckedChangeListener

> ID：10954582
> 
> 赞同：-3
> 
> 时间：2012-06-08T18:58:01.960
> 
> 标签：android, audio, stream, radio-button

我正在尝试启动一个“实现 RadioGroup.OnCheckedChangeListener”的新活动，但我尝试过的所有方法都会导致应用程序崩溃。有人有意见吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:59:45.723

实施不应该打扰任何事情。我实际上只是做了一个实现它的活动。问题一定在于你如何陈述你的活动。你没有给我们太多的信息来处理。您是否将 Activity 添加到您的 AndroidManifest.xml 文件中？这是最常见的事情。

# ruby - Ruby 无法识别 Grackle 对象/插件（Twitter API 包装器）——“NameError：未初始化的常量 Grackle”

> ID：10954586
> 
> 赞同：-1
> 
> 时间：2012-06-08T18:58:26.707
> 
> 标签：ruby, rubygems, require, nameerror, uninitialized-constant

该程序的第一行是错误发生的地方，

```
require 'grackle' 
```

这是我今天早上在课堂上写的代码，整个程序（以'require grackle'开头）我能够阅读推文并直接从命令行编写它们。现在我回到家并尝试在我的 mac（来自 irb）上运行完全相同的程序并得到这个：

```
source "grackle.rb"

>> require 'grackle'
NameError: uninitialized constant Grackle
 from ./grackle.rb:5
 from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require'
 from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'
 from grackle.rb:2
>> require 'json'
=> false
>> require 'highline/import'
=> false
>> 
?>  $client = Grackle::Client.new( :auth => {
...(Oauth keys)...
NameError: uninitialized constant Grackle
from grackle.rb:6
etc etc, every time Grackle gets called a similar error occurs 
```

在它尝试运行第一行之后。然后，这个初始错误会触发一连串错误。

我已经安装了 grackle gem。这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:10:49.380

您正在运行 ruby​​ 1.8。你需要`require 'rubygems'`在你可以`require 'grackle'`（宝石）之前。

您很困惑，因为您`grackle.rb`在当前目录中有一个名为的文件，但您没有`rubygems`在`irb`第一次初始化，因此`require 'grackle'`将加载本地`grackle.rb`而不是 gem。

# wpf - 控制模板绑定错误

> ID：10954587
> 
> 赞同：1
> 
> 时间：2012-06-08T18:58:29.247
> 
> 标签：wpf, xaml, styles, custom-controls

下面是 TabItem 样式的一部分，我收到类似于下图所示的绑定错误。

如何清理代码？

# 错误

```
System.Windows.Data Error: 40 : BindingExpression path error: 'HoverForeground' property not found on 'object' ''TabItem' (Name='')'. BindingExpression:Path=HoverForeground; DataItem='TabItem' (Name=''); target element is 'GlyphButton' (Name='HideButton'); target property is 'Foreground' (type 'Brush') 
```

# TabItem 样式

```
<Style x:Key="OrangeTabItemStyle" TargetType="{x:Type TabItem}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TabItem}">
                <Border AllowDrop="true" ToolTip="{Binding DisplayName}">
                    <Border Name="Border" Background="Transparent" BorderBrush="Transparent" BorderThickness="1,1,1,0" CornerRadius="2,2,0,0">
                        <DockPanel x:Name="TitlePanel" TextElement.Foreground="{StaticResource FileTabTextBrush}">
               ******             <ctrl:GlyphButton x:Name="HideButton" 
                        DockPanel.Dock="Right" 
                        GlyphForeground="Transparent" 
                        HoverBackground="{StaticResource ToolWindowButtonHoverActiveBackgroundBrush}" 
                        HoverBorderBrush="{StaticResource ToolWindowButtonHoverActiveBorderBrush}" 
              *****          HoverForeground="{StaticResource ToolWindowButtonHoverActiveGlyphForegroundBrush}" 
                        PressedBackground="{StaticResource ToolWindowButtonPressedBackgroundBrush}" 
                        PressedBorderBrush="{StaticResource ToolWindowButtonPressedBorderBrush}" 
                        PressedForeground="{StaticResource ToolWindowButtonPressedActiveGlyphForegroundBrush}"
                        HoverBorderThickness="1" PressedBorderThickness="1" Margin="3,2,3,4" 
                        Command="{Binding CloseCommand}"
                        CommandParameter="{Binding}"
                        ToolTip="Close">
                                <Path x:Name="CloseButtonStroke" Width="10" Height="8" Stretch="Uniform" 
                                      Data="F1 M 0,0 L 2,0 5,3 8,0 10,0 6,4 10,8 8,8 5,5 2,8 0,8 4,4 0,0 Z" 
                            Fill="{Binding Path=(TextElement.Foreground), RelativeSource={RelativeSource Self}}" />
                            </ctrl:GlyphButton>

                            <ContentPresenter x:Name="Content" HorizontalAlignment="Stretch" Margin="4,2,4,4" VerticalAlignment="Stretch" 
                                              RecognizesAccessKey="true" ContentSource="Header" />
                        </DockPanel>
                    </Border>
                    <Border.InputBindings>
                        <KeyBinding Command="{Binding CloseCommand}" Key="F4" Modifiers="Control" />
                    </Border.InputBindings>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter TargetName="Border" Value="{StaticResource FileTabIsMouseOverBorderBackgroundBrush}" Property="Background" />
                        <Setter TargetName="Border" Value="{StaticResource FileTabIsMouseOverBorderBrush}" Property="BorderBrush" />
                        <Setter TargetName="TitlePanel" Value="{StaticResource FileTabIsMouseOverTextForegroundBrush}" Property="TextElement.Foreground" />
                        <Setter TargetName="HideButton" Value="{StaticResource FileTabIsMouseOverGlyphForegroundBrush}" Property="GlyphForeground" />
                    </Trigger>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Panel.ZIndex" Value="1" />
                        <Setter TargetName="Border" Value="{StaticResource FileTabIsSelectedBackgroundBrush}" Property="Background" />
                        <Setter TargetName="Border" Value="{StaticResource FileTabIsSelectedBackgroundBrush}" Property="BorderBrush" />
                        <Setter TargetName="Border" Property="BorderThickness" Value="0" />
                        <Setter TargetName="Border" Property="Padding" Value="0,1,0,0" />
                        <Setter TargetName="HideButton" Property="Margin" Value="3" />
                        <Setter TargetName="TitlePanel" Value="{StaticResource FileTabIsSelectedTextForegroundBrush}" Property="TextElement.Foreground" />
                        <Setter TargetName="HideButton" Value="{StaticResource FileTabIsSelectedGlyphForegroundBrush}" Property="GlyphForeground" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# 字形按钮控件

```
public class GlyphButton : Button
{

    public static readonly DependencyProperty HoverForegroundProperty = DependencyProperty
        .Register("HoverForeground", typeof(Brush), typeof(GlyphButton));

    public Brush HoverForeground
    {
        get { return (Brush) GetValue(HoverForegroundProperty); }
        set { SetValue(HoverForegroundProperty, value); } 
    }

    // other properties similar to this omitted....
} 
```

# 编辑 - 字形按钮样式

```
<Style TargetType="{x:Type ctrl:GlyphButton}">
    <Setter Property="Width" Value="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}" />
    <Setter Property="Foreground" Value="{Binding Path=GlyphForeground, RelativeSource={RelativeSource Self}}" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderBrush" Value="Transparent" />
    <Setter Property="BorderThickness" Value="1" />
    <Setter Property="Focusable" Value="false" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ctrl:GlyphButton}">
                <Border 
                    Name="Border" Background="{TemplateBinding Background}" 
                    BorderBrush="{TemplateBinding BorderBrush}" 
                    BorderThickness="{TemplateBinding BorderThickness}">
                    <ContentPresenter />
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter TargetName="Border" Value="{Binding HoverBackground , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="Background" />
                        <Setter TargetName="Border" Value="{Binding HoverBorderBrush , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="BorderBrush" />
                        <Setter TargetName="Border" Value="{Binding HoverBorderThickness , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="BorderThickness" />
                        <Setter Value="{Binding HoverForeground , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="Foreground" />
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter TargetName="Border" Value="{Binding PressedBackground , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="Background" />
                        <Setter TargetName="Border" Value="{Binding PressedBorderBrush , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="BorderBrush" />
                        <Setter TargetName="Border" Value="{Binding PressedBorderThickness , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="BorderThickness" />
                        <Setter Value="{Binding PressedForeground , RelativeSource={RelativeSource TemplatedParent}}" 
                                Property="Foreground" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:35:52.877

查看 Setter Value="{Binding HoverForeground , RelativeSource={RelativeSource TemplatedParent}}" - 它获取对此元素的模板父级的引用并尝试查找属性 HoverForeground。您的 controltemplate 的模板化父级是 Tab 控件（第一种样式）...

# orientation - 纵向视图控制器和横向子视图

> ID：10954589
> 
> 赞同：0
> 
> 时间：2012-06-08T18:58:37.683
> 
> 标签：orientation, mpmovieplayercontroller, subview

我希望我的视图控制器保持纵向，并且我希望我的子视图能够根据设备的方向旋转。我怎样才能做到这一点？我在子视图中有一个 MPMoviePlayerController，我希望能够以横向观看视频，但我希望我的主视图控制器始终保持纵向。我已经在许多应用程序上看到了这一点，我只是无法在任何地方找到答案。

这是我的代码。

```
-(IBAction)playMovie:(id)sender{

NSURL *fileURL   =   [NSURL URLWithString:@"http://www.thebasementonline.com/btv/NicoSmall.mov"];
MPMoviePlayerController *moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL];  

[[AVAudioSession sharedInstance] setDelegate: self];
NSError *setCategoryError = nil;
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: &setCategoryError];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlaybackComplete:)
                                             name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayerController];

[self.view addSubview:moviePlayerController.view];
moviePlayerController.fullscreen = YES;

[moviePlayerController play]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:21:09.157

你可以在你的 shouldRotateOrientation 中做这个......

```
if(self.view.subviews containsObject:moviePlayer.view){
 return YES;
}
return (interfaceOrientation == UIInterfaceOrientationPortrait); 
```

问题是，如果您删除播放器视图并且它在横向，您的主控制器也将在横向：/所以您应该使用另一个视图控制器...

# twitter-bootstrap - 推特导航栏下方的隐藏区域

> ID：10954591
> 
> 赞同：0
> 
> 时间：2012-06-08T18:58:50.890
> 
> 标签：twitter-bootstrap

在 twitter navbar 的文档中，它写道：

“当你贴上导航栏时，记住要考虑下面的隐藏区域。添加 40px 或更多的填充到 . 确保在核心 Bootstrap CSS 之后和可选的响应式 CSS 之前添加它。”

这是什么意思？为什么会有隐藏区域？是因为推特的做法还是它应该如何工作？我对 HTML/CSS/Bootstrap 比较陌生

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:42:12.907

我认为这意味着当导航栏固定在页面顶部时，它需要一些固定的高度（40px），它需要显示所有内容。然后你必须为你的 html 页面的 body 设置一个顶部填充，以便在导航栏下没有任何布局。

也许你应该在包含响应式 css 之前这样做，因为它本身需要一些绝对值来计算最佳布局。

# java - Java 7，使用 HTML 格式标签时按钮文本的颜色

> ID：10954597
> 
> 赞同：1
> 
> 时间：2012-06-08T18:58:57.280
> 
> 标签：java, swing, jbutton, java-7

我有一个特定按钮的自定义 UI，通过子类化 MetalButtonUI 实现。这些按钮使用 HTML 格式的标签。这是对我的要求，我需要支持多行按钮标签。

出于某种原因，当我的应用程序在 Java 7（科学更新 4，最新）上运行时，禁用按钮时的文本颜色现在为灰色。在 Java 4 或 6 上运行时不会发生这种情况。

在按钮标签的 HTML 中，我可以使用设置字体颜色`<font color=..>`但是当按钮被禁用时，这个值会被忽略。好像在某个地方，当按钮被禁用时，我的字体颜色被覆盖了。使用`<body style='color: ..'>`也是无效的。

我尝试在 UIDefaults 中设置 Button.disabledText。这不是我真正想做的，因为它影响了太多按钮。但无论如何，它对 HTML 格式的按钮标签无效。

MetalButtonUI 定义了getDisabledTextColor，但实现它并没有效果。

同样，实现paintText方法也无效。它不会为 HTML 格式的标签调用。

我可以覆盖整个绘制方法，但这似乎是一个过于复杂的解决方案。

该区域有一个错误修复，报告在 Java 7 中已修复，请参阅[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4783068](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4783068)但是错误报告对我来说不是很清楚。目前尚不清楚具体更改了什么，或者如何覆盖新行为。

有谁知道如何控制禁用按钮的文本颜色？

编辑：对不起，我应该从一开始就包含示例代码。我的原始代码有用于按钮和 UI 的自定义类，在 UI 类中有自定义的 paint() 方法。但我现在看到核心问题可以非常简单地演示，只需调用 button.setForeground(Color.black); 在 Java 6 中，这会影响启用和禁用状态的文本颜色。在 Java 7 中，它只影响启用状态。mKorbel ...感谢您帮助隔离问题！！！！

```
 import java.awt.*;
    import java.awt.event.ActionEvent;
    import java.awt.event.ActionListener;

    import javax.swing.*;

    public class DisabledButtonDemo {

        public DisabledButtonDemo() {
            final JToggleButton button = new JToggleButton(
               "<html><center>Button<br/>Label</center></html>");      

            // Next line sets the text color. 
            // In Java 6 it is respected, for both enabled and disabled state.
            // In Java 7, it is only used for the enabled state.
            button.setForeground(Color.black); 
            button.setPreferredSize(new Dimension(100, 100));

            final JButton controlButton = new JButton(
               "Toggle Enabled/Disabled");
            controlButton.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    button.setEnabled(!button.isEnabled());
                }
            });

            JFrame f = new JFrame("ButtonTest");
            f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            f.setLayout(new GridLayout(2,1));
            f.add(button);
            f.add(controlButton);
            f.pack();
            f.setLocationRelativeTo(null);
            f.setVisible(true);
        }

        public static void main(String[] args) {
            SwingUtilities.invokeLater(new Runnable() {

                @Override
                public void run() {
                    DisabledButtonDemo t = new DisabledButtonDemo();
                }
            });
        }
    } 
```

编辑 #2：这现在被 Oracle 跟踪为一个错误，请参阅[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7176683](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7176683)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:52:59.173

> 有谁知道如何控制禁用按钮的文本颜色？

一种方式（你的意思是Html）是

![在此处输入图像描述](../Images/4bf371607c9286ba13a3a84b91ca0469.png)

![在此处输入图像描述](../Images/3faaff4a2f0d507c0d6de5526ba1c66c.png)

![在此处输入图像描述](../Images/a3129b198078619b988f82464dfe299b.png)

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class HtmlAndJButton {

    public HtmlAndJButton() {
        final String buttonText = " Whatever, but nothing wise";
        final JButton button = new JButton(buttonText);
        JButton btn1 = new JButton("Toggle");
        btn1.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                button.setText("<html><font color=" + (button.isEnabled() ? "blue" : "red") + ">"
                + buttonText + "</font></html>");
                button.setEnabled(!button.isEnabled());
            }
        });
        JFrame f = new JFrame("ButtonTest");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setLayout(new GridLayout(2,1));
        f.add(button);
        f.add(btn1);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                HtmlAndJButton t = new HtmlAndJButton();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:41:12.200

我阅读了您在问题上发布的错误报告，他们提供了解决此问题的解决方法。创建以下类：

```
/**
 * Attaches to a JButton to work around Sun bug 4783068.
 * <p>http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4783068</p>
 */
public final class SunBug4783068Fixer implements PropertyChangeListener {

private static final SunBug4783068Fixer INSTANCE = new SunBug4783068Fixer();

public static void attach(AbstractButton to) {
    // Prevents adding it more than once to any single component.
    to.removePropertyChangeListener(INSTANCE);

    to.addPropertyChangeListener(INSTANCE);
}

public static void remove(AbstractButton from) {
    from.removePropertyChangeListener(INSTANCE);
}

public void propertyChange(PropertyChangeEvent evt) {
    if ((evt.getSource() instanceof AbstractButton)
         && "enabled".equals(evt.getPropertyName())) {
        AbstractButton target = (AbstractButton) evt.getSource();
        target.setForeground(target.isEnabled()
            ? (Color) UIManager.getDefaults().get("Button.foreground")
            : (Color) UIManager.getDefaults().get("Button.disabledText"));
    }
  }
} 
```

然后像这样将它添加到您的 JToggleButton

```
 final JButton controlButton = new JButton("Toggle Enabled/Disabled");
        controlButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                button.setEnabled(!button.isEnabled());
            }
        });
 controlButton.addPropertyChangeListener(new SunBug4783068Fixer()); 
```

# r - 处理 R 中缺少的因子组合

> ID：10954602
> 
> 赞同：10
> 
> 时间：2012-06-08T18:59:13.337
> 
> 标签：r

所以，我有一个包含两个因素和一个数字变量的数据框，如下所示：

```
>D
f1 f2 v1 
1   A  23
2   A  45
2   B  27
     .
     .
     . 
```

所以 f1 的级别是 1 和 2，f2 的级别是 A 和 B。事情是这样的，当 f1=1 和 f2=B 时没有输入值（即 D$V1[D$f1=1 & D$f2=B] 不存在）实际上这应该为零。

在我的实际数据框中，我有 11 个级别的 f1 和接近 150 个级别的 f2，我需要为我的数据框中缺少的每个 f1 和 f2 组合创建一个 v1=0 的观察。

我该怎么做呢？

提前致谢，

伊恩

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-08T19:12:51.187

使用您的数据：

```
dat <- data.frame(f1 = factor(c(1,2,2)), f2 = factor(c("A","A","B")),
                  v1 = c(23,45,27)) 
```

一种选择是创建一个包含水平组合的查找表，这是使用`expand.grid()`两个因子的水平提供的函数完成的，如下所示：

```
dat2 <- with(dat, expand.grid(f1 = levels(f1), f2 = levels(f2))) 
```

然后可以使用`merge()`我们指定查找表中的所有值都包含在连接中的函数来执行类似数据库的连接操作 ( `all.y = TRUE`)

```
newdat <- merge(dat, dat2, all.y = TRUE) 
```

上面的行产生：

```
> newdat
  f1 f2 v1
1  1  A 23
2  1  B NA
3  2  A 45
4  2  B 27 
```

如您所见，缺失的组合被赋予`NA`表示缺失的值。然后用 s 替换这些`NA`s非常简单`0`：

```
> newdat$v1[is.na(newdat$v1)] <- 0
> newdat
  f1 f2 v1
1  1  A 23
2  1  B  0
3  2  A 45
4  2  B 27 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-10-16T21:10:56.807

我添加`tidyr`解决方案，传播`fill=0`和收集。

```
library(tidyr)
df %>% spread(f2, v1, fill=0) %>% gather(f2, v1, -f1)

#  f1 f2 v1
#1  1  A 23
#2  2  A 45
#3  1  B  0
#4  2  B 27 
```

你也可以这样做`df %>% spread(f1, v1, fill=0) %>% gather(f1, v1, -f2)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-26T13:51:04.237

晚了两年，但我遇到了同样的问题并想出了这个`plyr`解决方案：

```
dat <- data.frame(f1 = factor(c(1,2,2)), f2 = factor(c("A","A","B")), v1 = c(23,45,27))

newdat <- ddply(dat, .(f1,f2), numcolwise(function(x) {if(length(x)>0) x else 0.0}), .drop=F)

> newdat
  f1 f2 v1
1  1  A 23
2  1  B  0
3  2  A 45
4  2  B 27 
```

# c# - Fluent NHibernate 生成的审计

> ID：10954605
> 
> 赞同：2
> 
> 时间：2012-06-08T18:59:41.943
> 
> 标签：c#, nhibernate, fluent-nhibernate

我需要一些帮助来设置我的 Fluent NHibernate POCO 类结构。我试图简单地让对象可审计。在创建时，我希望设置我创建和修改的日期时间，在更新时，我希望更新我的修改。我一直在关注一些例子，但我遇到了障碍。这是我目前的设置：

IAuditable.cs

```
namespace ZeroBase.Domain.Entities
{
public interface IAuditable
{
    DateTime Created
    {
        get;
    }

    DateTime Modified
    {
        get;
    }

    string CreatedPropertyName
    {
        get;
    }

    string ModifiedPropertyName
    {
        get;
    }

    void SetCreationDate(DateTime created);
    void SetModifiedDate(DateTime modified);
}
} 
```

可审计实体.cs

```
namespace ZeroBase.Domain.Entities
{
public class AuditableEntity<T> : IAuditable
{
    public DateTime Created { get; private set; }
    public DateTime Modified { get; private set; }

    void IAuditable.SetCreationDate(DateTime created)
    {
        this.Created = created;
    }

    void IAuditable.SetModifiedDate(DateTime modified)
    {
        this.Modified = modified;
    }

    string IAuditable.CreatedPropertyName
    {
        get
        {
            string createdPropName = "Created";

        #if DEBUG
            CheckIfPropertyExists(createdPropName);
        #endif

            return createdPropName;
        }
    }

    string IAuditable.ModifiedPropertyName
    {
        get
        {
            string modifiedPropName = "Modified";

        #if DEBUG
            CheckIfPropertyExists(modifiedPropName);
        #endif

            return modifiedPropName;
        }
    }

    private void CheckIfPropertyExists(string propertyName)
    {
        PropertyInfo pi = this.GetType().GetProperty(propertyName);
        Debug.Assert(pi != null, String.Format("There exists no property {0}", propertyName));
    }
}
} 
```

用户.cs

```
namespace ZeroBase.Domain.Entities
{
public class User : AuditableEntity<User>
{
    public virtual Guid Id { get; set; }
    public virtual string Username { get; set; }
    public virtual string Password { get; set; }
    public virtual string FirstName { get; set; }
    public virtual string LastName { get; set; }
    public virtual string EmailAddress { get; set; }
    public virtual IEnumerable<Comment> Comments { get; set; }
}
} 
```

审计拦截器.cs

```
namespace ZeroBase.Infrastructure.Data
{
public class AuditInterceptor : EmptyInterceptor
{
    public override bool OnFlushDirty(object entity, object id, object[] currentState, object[] previousState,
        string[] propertyNames, NHibernate.Type.IType[] types)
    {
        IAuditable auditableObject = entity as IAuditable;

        if (auditableObject != null)
        {
            for (int i = 0; i < propertyNames.Length; i++)
            {
                if (propertyNames[i] == auditableObject.ModifiedPropertyName)
                {
                    currentState[i] = DateTime.Now;
                }
            }
            return true;
        }

        return false;
    }

    public override bool OnSave(object entity, object id, object[] state, string[] propertyNames, NHibernate.Type.IType[] types)
    {
        IAuditable auditableObject = entity as IAuditable;

        if (auditableObject != null)
        {
            DateTime currentDate = DateTime.Now;

            for (int i = 0; i < propertyNames.Length; i++)
            {
                if (propertyNames[i] == auditableObject.CreatedPropertyName)
                {
                    state[i] = currentDate;
                }
                if (propertyNames[i] == auditableObject.ModifiedPropertyName)
                {
                    state[i] = currentDate;
                }
            }

            System.Diagnostics.Debug.WriteLine("interceptor: created: " + auditableObject.Created);
            System.Diagnostics.Debug.WriteLine("interceptor: modified: " + auditableObject.Modified);

            return true;
        }

        return false;
    }
}
} 
```

审计地图.cs

```
namespace ZeroBase.Infrastructure.Data
{
public class AuditMap<T>: ClassMap<T> where T : AuditableEntity<T>
{
    public AuditMap()
    {
        Map(p => p.Created);
        Map(p => p.Modified);
    }
}
} 
```

用户地图.cs

```
namespace ZeroBase.Infrastructure.Data
{
public class UserMap : AuditMap<User>
{
    public UserMap()
    {
        Id(x => x.Id)
            .Column("Id")
            .GeneratedBy.Guid();
        Map(x => x.Username);
        Map(x => x.Password);
        Map(x => x.FirstName);
        Map(x => x.LastName);
        Map(x => x.EmailAddress);
        HasMany(x => x.Comments);
        Table("Users");
    }
}
} 
```

会话助手.cs

```
_sessionFactory = Fluently.Configure()

            // Set up database connection
            .Database(MsSqlConfiguration.MsSql2005
                .ConnectionString(x => x.Is(_connectionString))
                //.ShowSql()
            )

            // Use class mappings
            .Mappings(m => m.FluentMappings
                .AddFromAssemblyOf<UserMap>())

            .ExposeConfiguration(c => c.SetInterceptor(new AuditInterceptor()))

            .BuildSessionFactory(); 
```

当我尝试运行此程序时，出现此运行时错误：以下类型可能无法用作代理：ZeroBase.Domain.Entities.User：方法 get_Created 应为“公共/受保护的虚拟”或“受保护的内部虚拟”ZeroBase.Domain .Entities.User：方法 get_Modified 应该是“公共/受保护的虚拟”或“受保护的内部虚拟””}

这是想告诉我什么？

这与 Fluent NHibernate 有什么关系吗？

我有点困惑，希望得到一些帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T19:03:33.453

`Created`并且`Modified`你的`AuditableEntity<T>`类中的属性需要是虚拟的。这是 NHibernate 的[要求](http://davybrion.com/blog/2009/03/must-everything-be-virtual-with-nhibernate/)，如果您使用延迟加载（默认情况下）。

另外，这里有[一些](https://stackoverflow.com/questions/848108/nhibernate-and-virtual-class-properties) [关于](https://stackoverflow.com/questions/8583912/how-do-i-tell-fluent-nhibernate-to-ignore-specific-properties-without-automappin)它的[问题。](https://stackoverflow.com/questions/1473723/why-does-nhibernate-need-non-settable-members-to-be-virtual)

# php - 如何使网页抓取页面连续工作

> ID：10954607
> 
> 赞同：-1
> 
> 时间：2012-06-08T18:59:42.963
> 
> 标签：php, web-scraping

假设我创建了一个网页抓取 PHP 页面 ( `getdata.php`)，它通过 cUrl 获取特定网站页面的内容，而不是将一些有用的信息保存到 txt 文件或数据库中。

的伪代码`getdata.php`，

```
min = get latest search id from database
max = 1.000.000 (yes one million different pages)

while (min < max) {

  url = "http://www.website.com/page.php?id=".$min
  content = getContentFromURL(url)
  saveUsefulInfoToDb(content)
  min++
  set latest search id as min in database
} 
```

没关系，流程是，

1.  `getdata.php`在浏览器上打开
2.  等待
3.  还是等等吧，因为大约有一百万页会被刮掉。
4.  等待
5.  最后请求超时。
6.  失败

所以问题是我不知道如何使这个过程合理。在浏览器上打开页面并等待它完成抓取 URL，我认为这是一个非常糟糕的做法。

如何让 getdata.php 像 cron 一样在后台运行？

最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:02:21.320

除了@hackartists 的回答，我还要补充一点，根本不要通过浏览器调用这个 PHP 页面。相反，从命令行调用它

[http://www.php.net/manual/en/features.commandline.introduction.php](http://www.php.net/manual/en/features.commandline.introduction.php)

> 在浏览器上打开 getdata.php

应该

> 使用 cron 安排 getdata.php 从命令行运行

此外，记录成功或失败，以便您可以设置一些日志文件监控以了解您的网络抓取作业何时失败（毕竟，您不想每天坐在浏览器前并自己监控）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T19:01:10.353

在代码顶部使用

```
set_time_limit(0);
ignore_user_abort(true); 
```

然后每天或在需要时使用 cron 启动它。您肯定希望这是一个后台进程而不是网页。这两行将允许它作为网页或 cmd 行脚本无限期地运行。如果你想把它做成一个网页，你仍然可以使用 cron 来“触发”它，比如

```
0 0 * * * /usr/bin/curl "http://yoursite.com/getdata.php" >> "/var/www/errors.log" 
```

一些建议，因为我已经这样做了很多次了：一定要创建一个日志功能来打印到一个文件，这样你就可以在它运行时看到它在做什么，或者你将看不到它并且在 php 文件中编写一个终止开关所以您可以告诉它停止运行，而无需使用 unix top 或重新启动 apache。在终止时间内硬编码可能是一个好主意，如果在某个小时后它会停止，以免它运行超过一天并且第二个实例启动并且您同时运行多个实例。

# javascript - 将变量从 JavaScript 传递到动作类

> ID：10954611
> 
> 赞同：0
> 
> 时间：2012-06-08T19:00:04.163
> 
> 标签：javascript, struts

我有一个 view.jsp，我在这个 JSP 的 JavaScript 函数中声明了一个变量（parentUrl）。我想将此变量传递给我的 Java 类 (MyAction)。这是我的代码

```
function editAddress(){ 
    var parentUrl=document.referrer;
    request.setAttribute("url", parentUrl);
    document.forms[0].action = "path of the Myaction class";
    document.forms[0].submit();         
} 
```

单击 view.jsp 中的 SAVE 按钮后，将调用上述函数，将我的请求转发到 MyAction 类，然后 MyAction 类将请求转发到另一个 jsp 页面。我想传递要在 MyAction 类中传递的 parentUrl 变量，这样我就可以使用这个变量的值来编写一些逻辑。这是从请求中检索变量值的 myAction 类代码：

```
String parentURL = (String)request.getParameter("url"); 
```

基本上我想从请求的来源获取父页面的 URL。这就是我使用 document.referrer 功能的原因。

我的问题是当我在函数 editAddress() 中添加这两行时，我的 SAVE 按钮停止工作并且它没有导航到另一个页面。我不知道为什么会这样。

```
var parentUrl=document.referrer;
request.setAttribute("url", parentUrl); 
```

请让我知道将这个 parentUrl 变量从 JavaScript 传递给 \MyAction 类的任何其他更好的方法。谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T08:59:35.163

`request.setAttribute()`不是 javascript 方法，因此您不能以这种方式使用它。相反，在表单中声明一个隐藏字段并将其值设置为提交。

```
<form>
...
<input type="hidden" name="parentURL">
...
</form>

function editAddress(){ 
    var parentUrl=document.referrer;
    document.forms[0].parentURL.value=parentUrl;
    document.forms[0].action = "path of the Myaction class";
    document.forms[0].submit();         
} 
```

在您的操作类中声明`parentURL`（getter/setter）以访问其值

# iphone - IOS中如何调用拍照方法

> ID：10954612
> 
> 赞同：-6
> 
> 时间：2012-06-08T19:00:10.077
> 
> 标签：iphone, objective-c, ios, camera

我的朋友们，我用谷歌搜索了很多，但一无所获。我正在关注本教程：[http](http://www.musicalgeometry.com/?p=821) ://www.musicalgeometry.com/?p=821 ，我的目标是放置一个新按钮来拍照。但我不知道调用拍照相机方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:05:02.353

最简单的方法是使用 UIImagePickerController 类。您可以以模态方式呈现此视图控制器，并且您将获得带有所拍摄图片的委托回调。

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
[imagePicker setDelegate:self];
if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])
     [imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
else // The device doesn't have a camera, so use something like the photos album
     [imagePicker setSourceType:UIImagePickerControllerSourceTypeSavedPhotosAlbum];

[self presentViewControler:imagePicker animated:YES completion:nil]; 
```

要使用的委托方法是：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info 
```

如果你需要在不使用 UIImagePickerController 的情况下拍照，比如说如果你想要自己的自定义界面，你需要深入研究 AVFoundation，这是一个你可能还没有准备好的高级主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:05:06.043

您需要查看[UIImagePickerController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)类，该类可让您访问 iOS 设备的相机功能。

具体来说，您需要使用源类型`UIImagePickerControllerSourceTypeCamera`（首先检查设备是否有摄像头 via `isSourceTypeAvailable:`），使用媒体类型`kUTTypeImage`，通过展示摄像头控制器`presentViewController`，然后您可以显示默认摄像头控件，或隐藏它们并拍摄图片通过`takePicture`在用户按下自定义按钮时触发该方法。

# php - 如何在 Zend 框架中使用守护进程访问我的模型

> ID：10954616
> 
> 赞同：3
> 
> 时间：2012-06-08T19:00:42.053
> 
> 标签：php, zend-framework, daemon, phirehose

我正在开发一个使用[Phirehose](https://github.com/fennb/phirehose/)收集和使用 Twitter 流 API 的项目。Phirehose 库设计为从命令行运行，最好作为守护程序或 cron 作业。

我创建了一个守护进程并将其放在库文件夹中。Bootstrap.php 已更新为自动加载自定义库。因此，应用程序本身可以看到我的守护进程。

我的问题是如何将它与 Zend Framework 正确集成。我需要能够直接调用守护程序文件以从命令行或使用诸如[Upstart](http://upstart.ubuntu.com/)之类的工具启动它，但这样做不会加载 Zend 应用程序，这意味着我无法访问我的模型。

我可以创建一个控制器来启动它，但我不想添加某人能够从 Web 界面控制守护程序的安全问题。我也可以编写 PDO 来手动连接到数据库，但出于扩展原因，我试图避免它。我希望所有数据库连接数据都驻留在 application.ini 中。

有没有办法在我的守护进程类中初始化我的 Zend Framework 应用程序以便我可以使用模型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T04:08:04.530

这个例子演示了我如何使用 Zend_Queue 执行后台任务。在这个特定的示例中，我使用 Zend_Queue 和 cronjob 在后台生成发票，我的 Zend_Queue 被初始化并在引导程序中注册。

**创建工作，My_Job 源在[这里](https://gist.github.com/2899315)：**

```
class My_Job_SendInvoice extends My_Job
{
    protected $_invoiceId = null;

    public function __construct(Zend_Queue $queue, array $options = null)
    {
        if (is_array($options)) {
            $this->setOptions($options);
        }

        parent::__construct($queue);
    }

    public function job()
    {
        $filename = InvoiceTable::getInstance()
            ->generateInvoice($this->_invoiceId);

        return is_file($filename);
    }
} 
```

**在您的服务或模型中的某处注册工作：**

```
$backgroundJob = new My_Job_SendInvoice(Zend_Registry::get('queue'), array(
    'invoiceId' => $invoiceId
));
$backgroundJob->execute(); 
```

**创建后台脚本：**

```
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/..'));

// temp, environment should be specified prior execution
define('APPLICATION_ENV', 'development');

set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

require_once 'Zend/Application.php';

$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);

$application->bootstrap();

/* @var $queue Zend_Queue */
$queue    = Zend_Registry::get('queue');
$messages = $queue->receive(5);

foreach ($messages as $i => $message) {
    /* @var $job My_Job */
    $job = unserialize($message->body);
    if ($job->job()) {
        $queue->deleteMessage($message);
    }
} 
```

# asp.net-mvc - 使用 Fluent Validation 进行不显眼的自定义/条件验证

> ID：10954617
> 
> 赞同：7
> 
> 时间：2012-06-08T19:00:50.727
> 
> 标签：asp.net-mvc, asp.net-mvc-3, unobtrusive-validation, fluentvalidation

我正在寻找一种方法来为 Fluent Validation 实现不显眼的自定义验证。根据[文档](http://fluentvalidation.codeplex.com/wikipage?title=Custom&referringTitle=Documentation)，它似乎并不表明它支持不显眼的验证。

同样适用于使用条件验证（[When/Unless](http://fluentvalidation.codeplex.com/wikipage?title=Customising&referringTitle=Documentation&ANCHOR#WhenUnless)）。我在他们的[MVC 文档](http://fluentvalidation.codeplex.com/wikipage?title=mvc)中看到，条件验证和其他复杂验证不支持不显眼的验证：

> 请注意，FluentValidation 也适用于 ASP.NET MVC 的客户端验证，但并非所有规则都受支持。例如，使用条件（使用 When/Unless）、自定义验证器或对 Must 的调用定义的任何规则都不会在客户端运行。客户端支持以下验证器：
> 
> *NotNull/NotEmpty
> *Matches (regex)
> *InclusiveBetween (range)
> *CreditCard
> *Email
> *EqualTo (cross-property相等比较)
> *Length

那么有没有人想出如何让它发挥作用？如果没有，是否有其他验证选项可以更好地支持不显眼的自定义/复杂验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T19:54:14.383

通过遵循与 ASP.NET MVC文档的[集成，](http://fluentvalidation.codeplex.com/wikipage?title=mvc&referringTitle=Documentation)我已成功将 FluentValidation 插入到 ASP.NET MVC 3 。

简单的方法是将 FluentValidation 插入 Global.asax Application_Start() 中的 MVC 验证框架，如下所示：

```
FluentValidationModelValidatorProvider.Configure(); 
```

然后你可以用属性装饰你的 POCO 类，指定它们使用的验证器。

```
[Validator(typeof(PersonValidator))]
public class Person {
    public int Id { get; set; }
    public string Name { get; set; }
    public string Email { get; set; }
    public int Age { get; set; }
} 
```

就我而言，我不想这样做（使用属性），实际上需要针对不同的验证器验证相同的 POCO 类，具体取决于业务规则。

如果您想以这种方式选择不同的验证器，请遵循“[带有 IoC 容器的自定义验证器工厂](http://fluentvalidation.codeplex.com/wikipage?title=ValidatorFactory&referringTitle=mvc)”的文档。创建一个FluentMvcValidatorFactory 子类ValidatorFactoryBase，它实现了接口IValidatorFactory。自定义验证器工厂可以处理选择正确的验证器。

我试图让客户端验证工作（确实如此），但它似乎也插入了不显眼的验证。我的 html 输出如下所示：

```
<input type="text" value="" name="Email" id="Email" data-val-length-max="128" data-val-length="&amp;#39;Email&amp;#39; must be between 0 and 128 characters." data-val-email="&amp;#39;Email&amp;#39; is not a valid email address." data-val="true" class="text-box single-line"> 
```

只要您正确地将其插入 MVC，我认为不显眼应该可以工作。

在实践中，您不应该完全依赖客户端或不显眼的验证，仅在输入期间使用它来帮助用户。最终服务器需要验证，但您可以让服务器端代码使用相同的 FluentValidation 验证器。

# php - 如何在 Wordpress 中按类别过滤 archive-{custom-post-type}.php？

> ID：10954620
> 
> 赞同：1
> 
> 时间：2012-06-08T19:01:12.787
> 
> 标签：php, wordpress, archive, custom-post-type

**我使用名为Custom Post Type UI v0.7.1**的插件创建了一个名为“Portfolio”的自定义帖子类型。我为它创建了几个类别，例如徽标、包装等。

我需要使用archive.php 按类别过滤。

现在我有一个`archive-portfolio.php`包含以下代码的代码：

```
<?php $wp_query = null; $wp_query = $temp;?>
<?php $temp = $wp_query;
$wp_query= null;
$wp_query = new WP_Query(); ?>
<?php $wp_query->query("post_type=portfolio&". $catinclude ."&paged=".$paged.'&showposts=20'); ?>

<ul>
    <?php if ( have_posts() ) while ( have_posts() ) : the_post(); ?>
        echo '<li><a href="'; the_permalink(); echo '">';
        echo '<strong>'; the_title();
        echo '</strong>';
        echo '</a></li>';
    ?>
    <?php endwhile; ?>
</ul> 
```

我尝试过使用类似的 URL `/?category_name=logos`，`/?cat=logos`但都没有奏效；它只显示所有投资组合项目，无论类别如何。

投资组合自定义帖子类型启用了“**存档**”和“**分层”。**

对于内置分类法，它还启用了类别和标签。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:34:52.723

我会像下面这样使用 query_posts，你也可以简化代码：

```
<?php query_posts( array( 'post_type' => 'portfolio', 'showposts' => 10, 'orderby' => 'date', 'order' => 'desc')); ?>

<ul>
<?php if (have_posts()) : while (have_posts()) : the_post(); ?>
    <li>
         <a href="<?php the_permalink();?>">
             <strong><?php the_title(); ?></strong>
         </a>
    </li>
<?php endwhile; ?>
</ul>
<?php endif; ?> 
```

[您可以在WordPress Codex](http://codex.wordpress.org/Class_Reference/WP_Query#Parameters)中找到[query_posts](http://codex.wordpress.org/Function_Reference/query_posts)接受的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T18:16:56.283

我实际上最终让它与这个一起工作：

```
 <?php 
            $wp_query = null; $wp_query = $temp;
            $temp = $wp_query;
            $wp_query= null;
            $wp_query = new WP_Query();
            $wp_query->query("post_type=portfolio&category_name=" . $_GET["category"] . "&". $catinclude ."&paged=".$paged.'&showposts=20'); 
            if ( have_posts() ) while ( have_posts() ) : the_post(); ?>
            ...
            <?php endwhile; ?> 
```

# perl - 在参数化角色中定义属性触发器不起作用 - 不允许/不可能？

> ID：10954633
> 
> 赞同：0
> 
> 时间：2012-06-08T19:02:03.333
> 
> 标签：perl, moose

在以下代码中，我尝试为参数化角色中的属性定义触发器。

```
#!/usr/bin/env perl

package WordSizeRoleParameterized;
use MooseX::Role::Parameterized;

# a parameterized role with a trigger for an attribute
# does not work
role {   
    has 'word' => ( is => 'rw', trigger => \&_trigger_word_size,);

    has 'word_size' => ( is => 'ro', writer => '_set_word_size', );

    method '_trigger_word_size' => sub {
        my $self = shift;
        my $size;

        if ( $self->word ) { $size = split //, $self->word; }
        else               { $size = 0; }

        print "WordsizeRoleParameterized::_trigger_word_size() called : size = $size \n";
        $self->_set_word_size($size);
    };
};

1;

package WordSizeRole;
use Moose::Role;

# a plain role with a trigger for an attribute
# works as expected 
    has 'word' => ( is => 'rw', trigger => \&_trigger_word_size,);

    has 'word_size' => ( is => 'ro', writer => '_set_word_size', );

    sub _trigger_word_size {
        my $self = shift;
        my $size;

        if ( $self->word ) { $size = split //, $self->word;}
        else               { $size = 0;}
        $self->_set_word_size($size);
    }

1;

package ClassWordSizeParameterized;
use Moose;
with 'WordSizeRoleParameterized';
1;

package ClassWordSize;
use Moose;
with 'WordSizeRole';
1;

#------------
package main;
#------------

use strict;
use warnings;

# no error
my $wordy = ClassWordSize->new({'word' => 'goodie'});
print "word : '", $wordy->word, "', size: ", $wordy->word_size, "\n";

# but using the paramaeterized role ...
my $wordy_parameterized = ClassWordSizeParameterized->new();

# will cause an error if calling $wordy_parameterized->word('Superdubadubaduuuh')); 
#
# Undefined subroutine &WordSizeRoleParameterized::_trigger_word_size called at accessor
# ClassWordSizeParameterized::word (defined at roleTrigger.pl line 8) line 7.
$wordy_parameterized->word('Superdubadubaduuuh');
print "word : '", $wordy_parameterized->word, "', size: ", $wordy_parameterized->word_size, "\n"; 
```

调用 $wordy_parameterized->word('Superdubadubaduuuh')，它应该触发触发例程导致错误：Undefined subroutine &WordSizeRoleParameterized::_trigger_word_size called

有趣的是，WordSizeRoleParameterized::_trigger_word_size 方法存在（您可以调用 $wordy_parameterized->_trigger_word_size();），但它不会作为属性的触发例程触发。MooseX::Role::Parameterized 的文档没有说明任何内容。

MooseX::Role::Parameterized 的某些实现细节是否不允许或完全不可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:22:37.613

它或多或少是`MooseX::Role::Parameterized`. 使用`method`关键字时，它不会在`WordSizeRoleParameterized`包中创建方法。同样，`has`您在块中使用的其他关键字`role {}`不会影响使用`MooseX::Role::Parameterized`. 此类声明仅影响`role {}`块在幕后生成的匿名角色，然后影响使用该匿名角色的类（或其他角色）。

这里的问题`\&_trigger_word_size`是绑定到错误的包（`WordSizeRoleParameterized`当它应该绑定到匿名角色的包时）。更改`\&_trigger_word_size`为`sub { shift->_trigger_word_size(@_) }`可以解决问题，因为它使用正常的方法解析，因此该方法将在正确的包 ( `ClassWordSizeParameterized`) 中找到。

```
word : 'goodie', size: 6
WordsizeRoleParameterized::_trigger_word_size() called : size = 18 
word : 'Superdubadubaduuuh', size: 18 
```

您看到`$wordy_parameterized->_trigger_word_size`的是因为该方法是通过匿名角色复制到类中的，而不是通过`WordSizeRoleParameterized`.

# iphone - 自定义滑块控件上的 UIAccessibility

> ID：10954634
> 
> 赞同：0
> 
> 时间：2012-06-08T19:02:05.093
> 
> 标签：iphone, uiaccessibility

我有一个自定义控件（UIView 子类），它与锁定屏幕上的“滑动解锁”控件相同。

有没有办法在 Voiceover 选择视图时收到通知？此外，当它被选中时，手势识别器不会接收手势，从而使控件无用。

有小费吗？到目前为止，我已经设置了 isAccessibilityElement 和标签/提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T17:18:20.407

我必须做两件事才能使它工作：

```
self.accessibilityTraits = UIAccessibilityTraitAllowsDirectInteraction; 
```

并添加了仅在语音运行时触发的双击手势识别器

```
 UITapGestureRecognizer *doubleTapGestureRecognizer = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(didDoubleTap:)];
    doubleTapGestureRecognizer.numberOfTapsRequired = 2;
    [self addGestureRecognizer:doubleTapGestureRecognizer];

- (void)didDoubleTap:(UITapGestureRecognizer*)tapGesture {
    if(UIAccessibilityIsVoiceOverRunning()){
        [self slideHandleToFinish];
    } } 
```

# php - 无法更改 GD imagestring() 的字体大小

> ID：10954652
> 
> 赞同：18
> 
> 时间：2012-06-08T19:03:50.917
> 
> 标签：php, image

我正在尝试按照[此示例](http://designgala.com/how-to-add-text-in-an-image/)生成带有动态文本的图像。

我想改变字体的大小，我什至放了 100 而不是 4，但它仍然和以前一样。

我不是很擅长 PHP。任何形式的帮助将不胜感激。

这是一个看起来有多小[的例子:(](http://sushi.usask.ca/passimagemodels/levAclue1.png)

这是我的示例代码 -

```
 $font = 'arial.ttf'; //FONT SIZE

       $width = imagefontwidth($font) * strlen($string) ;
       $height = imagefontheight($font) ;
       $im = imagecreatefrompng($imageO);

       $x = imagesx($im) / 2;   //PLACEMENT CENTERISH – X
       $y = imagesy($im) / 2;   //PLACEMENT CENTERISH – Y

      // $backgroundColor = imagecolorallocate ($im, 255, 255, 255);

       $transparency = 25;
       imagesavealpha($im, true);
       $background = imagecolorallocatealpha($im, background_r, background_g, background_b, $transparency);

       $textColor = imagecolorallocate ($im, 0,0,0);
       imagestring ($im, $font, $x, $y, $string, $textColor);
       imagepng($im,$imageN[$k]);
       $w = imagesx($im);
       $h = imagesy($im); 
```

谢谢

## 稍后添加

好的，现在这就是我所做的，但结果，标注框中没有文本可见。

```
 $font = 'arial.ttf'; //YOUR FONT SIZE

       $im = imagecreatefrompng($imageO);
       $string = "My Text";
       $imageN ="NewImage.png";

       $transparency = 25;
       imagesavealpha($im, true);
       $background = imagecolorallocatealpha($im, background_r, background_g, background_b, $transparency);

       $textColor = imagecolorallocate ($im, 0,0,0);
       //imagestring ($im, 5, $x, $y, $string, $textColor);
       imagettftext($im, 36, 0, 10, 20, $textColor, $font, $string);
       imagepng($im,$imageN); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-08T19:06:32.910

你不能放 100 - [http://php.net/manual/en/function.imagestring.php](http://php.net/manual/en/function.imagestring.php)

只有 1-5 个（默认）

**更新**

为了能够完全控制您可能想要使用的字体大小[http://php.net/manual/en/function.imagettftext.php](http://php.net/manual/en/function.imagettftext.php)

示例（来自同一站点）：

```
<?php
// Set the content-type
header('Content-Type: image/png');

// Create the image
$im = imagecreatetruecolor(400, 30);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 128, 128, 128);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 399, 29, $white);

// The text to draw
$text = 'Testing...';
// Replace path by your own font path
$font = 'arial.ttf';

// Add some shadow to the text
imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

// Add the text
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

// Using imagepng() results in clearer text compared with imagejpeg()
imagepng($im);
imagedestroy($im);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-01T18:30:22.543

有人喜欢跳出框框思考吗？我也是。

因此，如果您必须使用 PHP`imagestring`而不是`imagettftext`有一种方法可以创建大于标准 1-5 范围的文本大小，并且它需要您将文本创建为大小 A，然后将您创建文本的图像调整为变大。多大取决于你想要的文本有多大。

所以让我们来看看它......

：1。创建空白 png 只是为了将我们的文本放到上面。我们还需要一个最终的图像来编译东西。这些可以`imagecreatetruecolor`用于透明背景。

```
$ImageText1Small = imagecreate( 148, 16 );
$ImageText1Large = imagecreate( 148, 16 );
$ImageText2Small = imagecreate( 308, 40 );
$ImageText2Large = imagecreate( 308, 40 );
$ImageFinal = imagecreate( 500, 100 ); 
```

:2。对我们的文本图像的背景和文本颜色进行排序。黑与白。多么原始。

```
$backgroundColor1 = imagecolorallocate($ImageText1Small, 255,255,255);
$textColor1 = imagecolorallocate($ImageText1Small, 0,0,0);

$backgroundColor2 = imagecolorallocate($ImageText2Small, 255,255,255);
$textColor2 = imagecolorallocate($ImageText2Small, 0,0,0); 
```

:3。我们需要文字。添加它。

```
imagestring( $ImageText1Small, 1, 1, 0, 'Stack Overflow',  $textColor1 );
imagestring( $ImageText2Small, 5, 1, 0, 'Harry Harry Harry',  $textColor2 ); 
```

:4。这是聪明的一点。调整较小的文本图像，使其大于最大 5 字体。

```
imagecopyresampled($ImageText1Large, $ImageText1Small, 0, 0, 0, 0, 148, 16, 74, 8);
imagecopyresampled($ImageText2Large, $ImageText2Small, 0, 0, 0, 0, 308, 40, 154, 20); 
```

：5。在这里我做了一些旋转，但显然这是可选的。

```
$ImageText1Large = imagerotate ( $ImageText1Large, 20, $backgroundColor1 );
$ImageText2Large = imagerotate ( $ImageText2Large, -5, $backgroundColor2 ); 
```

:6。获取我们新旋转图像的尺寸。如果您旋转，这也是可选的。

```
$ImageText1W = imagesx($ImageText1Large);
$ImageText1H = imagesy($ImageText1Large);

$ImageText2W = imagesx($ImageText2Large);
$ImageText2H = imagesy($ImageText2Large); 
```

:7。将文本图像层粘贴到最终图像上：

```
imagecopymerge($ImageFinal, $ImageText1Large, 350, 20, 0, 0, $ImageText1W, $ImageText1H, 100);
imagecopymerge($ImageFinal, $ImageText2Large, 20, 20, 0, 0, $ImageText2W, $ImageText2H, 100); 
```

:4。打印出来，或者保存：

```
header( 'Content-type: image/png' );
imagepng($ImageFinal, 0); 
```

：5。自己清理：

```
imagecolordeallocate( $ImageText1Small, $textColor1 );
imagecolordeallocate( $ImageText1Small, $backgroundColor1 );
imagecolordeallocate( $ImageText1Large, $textColor2 );
imagecolordeallocate( $ImageText1Large, $backgroundColor2 );
imagedestroy($ImageText1); 
imagedestroy($ImageText2);
imagedestroy($ImageFinal); 
```

显然你可以玩弄： * 起始图像大小 * 起始字体 (1-5) * 旋转 * 进一步放大 * 背景颜色 * 透明背景 * 定位 *`imagepng`压缩级别

整个脚本，不完美，但功能在这里：

```
$ImageText1Small = imagecreate( 148, 16 );
$ImageText1Large = imagecreate( 148, 16 );
$ImageText2Small = imagecreate( 308, 40 );
$ImageText2Large = imagecreate( 308, 40 );
$ImageFinal = imagecreate( 500, 100 );

$backgroundColor1 = imagecolorallocate($ImageText1Small, 255,255,255);
$textColor1 = imagecolorallocate($ImageText1Small, 0,0,0);

$backgroundColor2 = imagecolorallocate($ImageText2Small, 255,255,255);
$textColor2 = imagecolorallocate($ImageText2Small, 0,0,0);

imagestring( $ImageText1Small, 1, 1, 0, 'Stack Overflow',  $textColor1 );
imagestring( $ImageText2Small, 5, 1, 0, 'Harry Harry Harry',  $textColor2 );

imagecopyresampled($ImageText1Large, $ImageText1Small, 0, 0, 0, 0, 148, 16, 74, 8);
imagecopyresampled($ImageText2Large, $ImageText2Small, 0, 0, 0, 0, 308, 40, 154, 20);

$ImageText1Large = imagerotate ( $ImageText1Large, 20, $backgroundColor1 );
$ImageText2Large = imagerotate ( $ImageText2Large, -5, $backgroundColor2 );

$ImageText1W = imagesx($ImageText1Large);
$ImageText1H = imagesy($ImageText1Large);

$ImageText2W = imagesx($ImageText2Large);
$ImageText2H = imagesy($ImageText2Large);

imagecopymerge($ImageFinal, $ImageText1Large, 350, 20, 0, 0, $ImageText1W, $ImageText1H, 100);
imagecopymerge($ImageFinal, $ImageText2Large, 20, 20, 0, 0, $ImageText2W, $ImageText2H, 100);

header( "Content-type: image/png" );
imagepng($ImageFinal);

imagecolordeallocate( $ImageText1, $textColor1 );
imagecolordeallocate( $ImageText2, $textColor2 );
imagedestroy($ImageText1); 
imagedestroy($ImageText2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:10:51.320

如果您想以您选择的任何字体编写更大的文本，我建议您使用 imagettftext。

[http://php.net/manual/en/function.imagettftext.php](http://php.net/manual/en/function.imagettftext.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-12T08:36:40.757

很多建议，但没有解决方案...

这是一个有效的解决方案。诀窍是为此使用**imagettftext()**。它使您可以选择任何大小的任何 truetype 字体。

在现有图像上使用以下代码：

```
<?php
  $txt = 'This is the text overlay';

  header('Content-type: image/png');

  $image = ImageCreateFromJPEG('existingimage.jpg'); // path to the existing image
  $color = imagecolorallocate($im, 0, 0, 0); // black
  $font = 'fontname.ttf'; // path to font
  imagettftext($image, 14, 0, 395, 85, $color, $font, $txt );

  imagepng($image); // png gets better font results than jpg
  imagedestroy($image);
?> 
```

这对我有用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-16T12:28:08.063

可以使用 imagettftext() 函数或 imageloadfont() 更改字符串的字体样式。两者都可以更改字体样式，但使用 imageloadfont() 只是加载定义明确的二进制字体文件，在这种情况下，您无法控制字体的确切大小，无法自定义它。您也不能加载真正的字体文件，它们应该是 GDF 文件。使用 imagettftext() 函数，您可以完全控制字体样式、大小、字体系列等。在这种情况下，您应该通过在计算机/服务器上分配文件来直接使用真字体文件。以下是两个具有这两个功能的示例： 使用 imageloadfont() 的验证码功能示例：

//设置图片宽高 $width = 150; $高度 = 30;

```
//Create the image resource 
$image = ImageCreate($width, $height);  

//We are making three colors, white, black and gray 
$white = ImageColorAllocate($image, 255, 255, 255); 
$black = ImageColorAllocate($image, 46, 29, 29); 
$grey = ImageColorAllocate($image, 204, 204, 204); 

//Make the background black 
ImageFill($image, 0, 0, $black); 

$font = imageloadfont('04b.gdf');

$text='Testing'; 
//Add randomly generated string in white to the image
ImageString($image, $font, 20, 3, $text, $white);

ImageRectangle($image,0,0,$width-1,$height-1,$grey); 
imageline($image, 0, $height/3, $width, $height/3, $grey);
imageline($image, 0, ($height/3)*2, $width, ($height/3)*2, $grey);
imageline($image, $width/2, 0, $width/2, $height, $grey); 

//Tell the browser what kind of file is come in 
header("Content-Type: image/jpeg"); 

//Output the newly created image in jpeg format 
ImageJpeg($image); 
```

这是 imagettftext() 函数的示例：

```
//Set the image width and height 
$width = 150; 
$height = 30;

//Create the image resource 
$image = ImageCreate($width, $height);  

//We are making three colors, white, black and gray 
$white = ImageColorAllocate($image, 255, 255, 255); 
$black = ImageColorAllocate($image, 46, 29, 29); 
$grey = ImageColorAllocate($image, 204, 204, 204); 

//Make the background black 
ImageFill($image, 0, 0, $black); 

$font = 'arial.ttf';
$text='Testing';
imagettftext($image, 20, 5, 10, 20, $white, $font, $text);
ImageRectangle($image,0,0,$width-1,$height-1,$grey); 
imageline($image, 0, $height/3, $width, $height/3, $grey);
imageline($image, 0, ($height/3)*2, $width, ($height/3)*2, $grey);
imageline($image, $width/2, 0, $width/2, $height, $grey); 

//Tell the browser what kind of file is come in 
header("Content-Type: image/jpeg"); 

//Output the newly created image in jpeg format 
ImageJpeg($image); 
```

# ruby - Ruby 需要加载错误

> ID：10954655
> 
> 赞同：0
> 
> 时间：2012-06-08T19:03:59.187
> 
> 标签：ruby, gem, require

我试图需要两个宝石：json 和 rinku。

我在一个托管的 Linux 机器上工作，没有 root/sudo 访问权限，最终将 gems 安装在我的主目录中：

```
-jailshell-3.2$ gem which json
/home/cygnetrc/ruby/gems/gems/json-1.7.3/lib/json.rb
-jailshell-3.2$ gem which rinku
/home/cygnetrc/ruby/gems/gems/rinku-1.5.1/lib/rinku.rb 
```

红宝石版本是：

```
-jailshell-3.2$ ruby --version
ruby 1.8.7 (2011-02-18 patchlevel 334) [x86_64-linux] 
```

RubyGems 环境是：

```
 - RUBYGEMS VERSION: 1.8.11
  - RUBY VERSION: 1.8.7 (2011-02-18 patchlevel 334) [x86_64-linux]
  - INSTALLATION DIRECTORY: /home/cygnetrc/ruby/gems
  - RUBY EXECUTABLE: /usr/bin/ruby
  - EXECUTABLE DIRECTORY: /home/cygnetrc/ruby/gems/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /home/cygnetrc/ruby/gems
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "gempath" => []
     - "gem" => "--remote --gen-rdoc --run-tests"
     - "gemhome" => "/home/cygnetrc/ruby/gems"
     - "rdoc" => "--inline-source --line-numbers"
  - REMOTE SOURCES:
     - http://rubygems.org/

-jailshell-3.2$ ruby -e 'puts $:'
/usr/lib/ruby/site_ruby/1.8
/usr/lib/ruby/site_ruby/1.8/x86_64-linux
/usr/lib/ruby/site_ruby
/usr/lib/ruby/vendor_ruby/1.8
/usr/lib/ruby/vendor_ruby/1.8/x86_64-linux
/usr/lib/ruby/vendor_ruby
/usr/lib/ruby/1.8
/usr/lib/ruby/1.8/x86_64-linux
. 
```

我尝试使用以下方法包含宝石：

```
-jailshell-3.2$ head gettweets.rb 
#!/usr/bin/ruby 

require 'rubygems'
require 'json'
require 'net/https'
require 'uri'
require 'rinku' 
```

但最终得到：

```
-jailshell-3.2$ ./gettweets.rb 
/usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require': no such file to load -- json (LoadError)
        from /usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'
        from ./gettweets.rb:7 
```

我环顾四周，发现了很多关于各种不同路径变量（如 RUBYOPTS）的信息，但似乎没有什么对我有用。

更复杂的是，我将从 cron 作业中调用脚本，因此无论我使用什么解决方案，它都不能依赖于更改我的主目录中的任何内容，例如我的 .profile。

我正在拔头发-有人可以帮忙吗？

* * *

更新：

感谢您的反馈意见！根据您的一些建议，我阅读了`GEM_PATH`如果我将其设置并导出为 shell 环境变量，哪些方法有效。但是，由于我想从 cron 运行脚本，我需要能够从脚本本身中设置它。我试过这样做，但它似乎不起作用。还有什么想法吗？

```
-jailshell-3.2$ ruby -I ~/ruby/gems ./gettweets.rb 
/usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require': no such file to load -- json (LoadError)
        from /usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'
        from ./gettweets.rb:4
-jailshell-3.2$ head -20 ./gettweets.rb 
#!/usr/bin/ruby 

require 'rubygems'
require 'json'
require 'net/https'
require 'uri'
require 'rinku'
require 'optparse'

OptionParser.new do |o|
  o.on('-d', "Turn on debugging messages") { |b| $debug = b }
  o.on('-h', "Print this help screen") { puts o; exit }
  o.parse!
end

puts "[*] Starting..." if $debug

# Setenv to catch json gem
ENV['GEM_PATH'] = '~/ruby/gems'
puts "ENV " + ENV['GEM_PATH'] if $debug
-jailshell-3.2$ export GEM_PATH=~/ruby/gems
-jailshell-3.2$ ruby ./gettweets.rb  -d
[*] Starting...
ENV ~/ruby/gems
[*] Filepath = /home/cygnetrc/www/drupal/tweets.html
The queens of the women's single sculls - a look back at the Olympic history: http://t.co/d0YmNr40 #rowing #wr #London2012 #Olympics<br />
<em>Fri Jun 08 16:05:38</em><br />
1 week until #WRCMunich! NZL's Storm Uru will be racing the LM2x with @petertaylorNZ. Here, Uru talks about teamwork: http://t.co/NvjRgtwW<br />
<em>Fri Jun 08 14:38:02</em><br />
The 2012 @Paralympic Games Qualification Process is complete: http://t.co/D6DRG0bO #rowing #adaptive #Paralympic #London2012 #wr<br />
<em>Fri Jun 08 13:23:14</em><br />
true
[*] Finished
-jailshell-3.2$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T08:36:07.203

我在通过 Apache mod_cgi 运行 Ruby 时遇到了类似的问题。没有设置环境变量，但 CGI 脚本以用户而不是 Apache 的身份运行。这是我的解决方法。

```
#!/bin/bash
source "/home/username/.bashrc"
rubyscript.cgi 
```

但是，我想要一种真正的方法来添加到 Ruby 脚本本身的 gems 路径以避免这种变通方法，并发现了这个：

```
ENV["HOME"] = "/home/user"
ENV["GEM_HOME"] = ENV["HOME"] + "/ruby/gems"
ENV["GEM_PATH"] = ENV["GEM_HOME"] + ":/usr/lib/ruby/gems/1.8"
ENV["GEM_CACHE"] = "GEM_HOME/cache"
ENV["PATH"] = ENV["PATH"] + ":" + ENV["HOME"] + "/ruby/gems/bin" 
```

这可以放在 Ruby 脚本的头部，也可以放在一个文件中，并以“必需”开头，即 environment.rb：

```
ENV["HOME"] = "/home/user"
ENV["GEM_HOME"] = ENV["HOME"] + "/ruby/gems"
ENV["GEM_PATH"] = ENV["GEM_HOME"] + ":/usr/lib/ruby/gems/1.8"
ENV["GEM_CACHE"] = "GEM_HOME/cache"
ENV["PATH"] = ENV["PATH"] + ":" + ENV["HOME"] + "/ruby/gems/bin" 
```

ruby.cgi:

```
#!/usr/bin/ruby
require "environment"
require "rubygems"
require "json"
puts "Content-type: text/json"
puts ""
puts "{'bacon':['yum','tasty']}" 
```

# php - php检查匹配的时间范围与数组中的当前时间

> ID：10954663
> 
> 赞同：0
> 
> 时间：2012-06-08T19:04:52.807
> 
> 标签：php, arrays, date, multidimensional-array

我有一个时间范围的数组，时间范围有特定的视频，我要显示与当前时间匹配的视频

**我创建了一个如下所示的变量，并分配给数组，请任何人帮助我从数组中过滤当前时间的视频**

**ex-如果服务器时间是 2012-06-08 14:45:10 这我需要显示视频 2**

```
$d1 = "2012-06-08 14:26:39";
$video1='http://video-js.zencoder.com/oceans-clip.mp4';
$d2 = "2012-06-08 14:39:39";
$video2='http://video-js.zencoder.com/oceans-clip.mp4';
$d3 = "2012-06-08 14:56:10";

$cc=array(
1=>array($d,$d2,$video1),
2=>array($d2,$d3,$video2)
);

//get current time
$ctime=date('Y-m-d H:i:s',time());
//need to check matched array element for current time within above array date ranges
//Ex - if the server time is  2012-06-08 14:45:10 this need show video 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:14:47.573

你可以试试这个

```
$showvideo = "";
for ($i = 1; $i <= sizeof($cc); $i++) {
    $video = $cc[$i];
    if ($ctime >= $video[0] && $ctime <= $video[1]) {
        $showvideo = $video[2];
        break;
    }
}

if ($showvideo == "") {
    // Error
} 
```

基本上 PHP 允许您比较日期，因此只需通过数组并比较每个日期以查看您拥有的日期是否介于两者之间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:18:34.940

您需要为每个视频分配一个时间范围，然后您可以根据输入的时间查找正确的视频

例如

```
$ctime=date('Y-m-d H:i:s',time());

$video1=array("http://video-js.zencoder.com/oceans-clip.mp4","2012-06-08 14:26:39","2012-06-08 14:39:39")

if ($ctime >= $video1[2]) && ($ctime <= $video1[3]) { echo $video1[1]; } 
```

我相信这应该可以解决您的问题

# .net - pex真的还活跃吗？

> ID：10954668
> 
> 赞同：7
> 
> 时间：2012-06-08T19:05:06.263
> 
> 标签：.net, pex

对不起初学者的问题。我的位是 2010 年的。我发现一个线程说 2011 年会有更新。我真的找到了最后一点吗？我不想骑另一个死工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:13:52.083

看起来它正在集成到 VS 2012 中。

> [Visual Studio 11 中的 Fakes Framework](http://research.microsoft.com/en-us/projects/pex/)是 Moles & Stubs 的下一代，最终将取代它。
> 
> 当最终版本可用时，Pex 和 Moles 团队将发布适用于 Visual Studio 11 的 Pex 更新。Moles 不会进一步发展，因此我们建议迁移到 Fakes。

# c# - 时间：2019-01-01 标签：c#bulkaddcommentswithexcelinterop

> ID：10954672
> 
> 赞同：0
> 
> 时间：2012-06-08T19:05:23.363
> 
> 标签：c#, excel, comments, excel-interop

我有一个数据表（在我的代码中创建）和磁盘上现有的电子表格。我想将数据表中的数据作为注释转储到电子表格单元格中。在“嵌套 for 循环”中执行此操作并逐个单元格地导航 excel 以在每个单元格中添加注释需要大量时间。我想知道是否有更好的性能操作或其他解决方法可以做到这一点？

Excel 互操作为如下值提供批量编辑：

```
object[,] data = MY_DATA;
Range[Cells[1,1], Cells[x,x].Value2 = data; 
```

是否有等效的评论 API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:59:41.663

如果您对开源库开放，那么您应该尝试 EPPlus（网址：[http](http://epplus.codeplex.com/) ://epplus.codeplex.com/ ）。您可以使用 EPPlus 打开任何现有的 excel 文件，并使用 AddComment 方法为单元格提供注释。

```
private static void AddComment(ExcelWorksheet ws, int colIndex, int rowIndex, string comment, string author)
{
    //Adding a comment to a Cell
    var commentCell = ws.Cells[rowIndex, colIndex];
    commentCell.AddComment(comment, author);
} 
```

# python - 我可以在 GAE Pipeline API 工作人员之间保持状态吗？

> ID：10954677
> 
> 赞同：3
> 
> 时间：2012-06-08T19:05:37.167
> 
> 标签：python, google-app-engine, pipeline

我已经开始使用新的 Google App Engine Pipeline API 创建 MapReduce 作业，并且遇到了一种情况，我希望每个工作人员在运行时都拥有相同列表的副本。

一种选择是使用 memcache，但我担心这个列表的大小最终可能会大于我可以使用 memcache 设置的大小。我认为我的另一个选择是在运行时使用此列表上下文初始化每个工作人员，但我在文档中找不到任何方法来执行此操作，并且查看源代码并没有提供任何明显的答案。

有没有办法将额外的参数添加到 map reduce 函数中或以其他方式将状态注入 MapReduce 工作上下文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:36:57.013

目前没有官方的方法。您可能可以在 MapReduce 管道中添加一个任务来计算和缓存列表（在数据存储或 Blob 存储中，以最合适的为准，加上内存缓存中的副本）。然后让你的 mapper 和/或 reducer 函数对保存列表的全局变量进行延迟初始化，首先检查 memcache，并在必要时回退到 datastore/blobstore（并重新缓存列表）。随着新实例的启动以处理任务，它们将自行初始化。

假设列表在 MapReduce 启动时是固定的，来自不同实例的竞争读取不会成为问题。

# ios - 应用获得批准，iAd 未显示

> ID：10954681
> 
> 赞同：12
> 
> 时间：2012-06-08T19:05:48.230
> 
> 标签：ios, app-store, app-store-connect, iad

我的应用刚刚获得批准，不幸的是我的 iAd 横幅是空白的。

我已经在 iTunes Connect 上配置了 iAd。

谢谢，

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-09T01:09:14.970

值得注意的是，如果您在调试中运行您的应用程序，您将确认您实施的系统是否有效，因为您将看到测试广告（带有 Apple 品牌的灰色广告，单击一个将显示一条消息说测试广告有效）。如果不是这种情况，则代码存在问题。您需要披露该代码以获得更多帮助。

如果测试广告确实有效，那么它可以归因于部分/所有这些问题。

1.  您没有在 iTunes Connect 中为您的应用程序正确设置 iAd。您需要在 iTunes 连接的“管理您的应用程序”部分启用它。

2.  您没有正确设置 iAd 合同。请参阅 iTunes 连接的“合同、税务和银行业务”部分，并确保全球地区的 iAd 网络一切正常。

3.  没有任何广告可显示。您不会得到 24/7 全天候显示的广告，它们只会在特定时间出现（这是按设计工作的）。长时间测试您的应用程序的应用商店构建，以查看是否出现广告。请注意，不同的地区会以不同的频率获得广告（我相信美国最受欢迎）。注意：iAd 框架提供了确定广告是否已准备好显示的方法（例如，请参见 ADBannerViewDelegate 中的`bannerViewWillLoadAd:`和）。`bannerViewDidLoadAd:`只有当有广告可用时，您才应该为 iAd 横幅腾出空间，否则您的应用应该看起来从一开始就没有横幅。否则你会得到你提到的空白

# php - HTML 表单在表格外有效，但在表格中无效

> ID：10954683
> 
> 赞同：1
> 
> 时间：2012-06-08T19:05:57.760
> 
> 标签：php, html

只是简单而愚蠢的问题。

我在一个使用 HTML 和 PHP 的简单网站上工作。

今天我添加了更改头像并将上传表单放在表格中的选项。我花了 5 分钟来创建它，但随后，大约 5 个小时试图调试它，突然间，我遇到了一些问题。我只是从表格中复制并粘贴了表格，一切正常。但是，如果我的表格在表格中，它仍然不起作用。

PS：当我的表单在表格中时，提交按钮只是刷新页面。

有人可以给我一个合乎逻辑的理由吗？

**编辑：**好的，有人要求代码，但由于其他人回答了我的问题 - 有光。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:13:23.887

表格不能介于`<table>`和之间`<td>`。不过，他们可以进去`<td>`。而且，显然他们可以（并且通常应该）走出`<table>`.

# python - 在 Python 中用双引号而不是单引号打印空字符串

> ID：10954687
> 
> 赞同：3
> 
> 时间：2012-06-08T19:06:15.177
> 
> 标签：python, string

我有一个想要漂亮打印的列表，其中包含空列表以及带有字符串成员的列表。问题是包含字符串的列表用双引号打印：

> >>>str(['a'])
> "['a']"

但是一个空列表用单引号打印：

> >>> str([])
> '[]'

有没有办法总是用双引号强制打印字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:09:33.220

这取决于被打印对象的表示；如果要打印的字符串包含该`\"`字符，则将使用单引号；如果字符串包含该`\'`字符，则将使用双引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:07:59.100

使用自定义字符串格式：

```
print '"{}"'.format(str([])) 
```

印刷

```
"[]" 
```

不过，这不会影响嵌套在容器中的字符串：

```
print '"{}"'.format(str(["a"])) 
```

印刷

```
"['a']" 
```

# r - 在 R 中保留地图缩放比例？

> ID：10954688
> 
> 赞同：2
> 
> 时间：2012-06-08T19:06:18.047
> 
> 标签：r

我有一些空间数据，我正在使用地图库在 R 中进行映射。具体来说，我正在美国地图上绘制圆圈。我有每个圆的纬度/经度中心坐标和半径，并像这样映射它们：

```
library(maps)
library(plotrix)
map('state')
draw.circle(x=-73.76275, y=41.04181, radius=2) 
```

这个特殊的圆需要 205 公里的半径。我已经能够匹配它并在图形窗口中准确绘制，但是缩放或导出为 png 会改变相对于地图的圆圈大小。

有没有办法a）自动化圆圈大小，b）在导出时保持缩放？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:07:31.600

试试这个：

```
map('state')
x <- -73.76275
y <- 41.04181
radius <- 205 # in kilometers
s <- seq(0,2*pi,length=1000)
yradius <- optimize(interval=c(0,3),f=function(z){
  abs(pointDistance(c(x,y),c(x,y+z),longlat=T) - radius*1000)})$par
xradius <- optimize(interval=c(0,3),f=function(z){
  abs(pointDistance(c(x,y),c(x+z,y),longlat=T) - radius*1000)})$par
lines(cos(s)*xradius+x,sin(s)*yradius+y) 
```

这为您提供了一个圆圈，其中最北端位于中心以北 205 公里处，最东端位于中心以东 205 公里处。

# delphi - LockBox Stream 读取错误，RSA

> ID：10954693
> 
> 赞同：1
> 
> 时间：2012-06-08T19:06:37.493
> 
> 标签：delphi, encryption, lockbox-3

我正在从流中加载 RSA 密钥并收到“流读取”错误？我应该尝试让我的代码正常工作的第一件事是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:42:33.830

有点疯狂的猜测，但是如果在写入后尝试从流中读取时流的位置未重置为 0，则可能会发生这种情况。尝试设置

```
SigStore.Position := 0; 
```

在使用流加密之前。

# symfony - Symfony2，如何通过电子邮件执行某些操作？

> ID：10954694
> 
> 赞同：0
> 
> 时间：2012-06-08T19:06:41.440
> 
> 标签：symfony, security

我想通过一些自动生成的电子邮件访问我的 Web 应用程序的安全部分。

senario 将如下所示：

系统生成一些用于`Approval`操作的电子邮件并将其发送给相关用户；我在项目的安全区域中有控制器，当用户登录时它正在工作。

我想通过一些链接来实现这一点，以便用户轻松做到这一点。

换句话说，如何通过电子邮件中存在的链接安全地访问控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:31:32.013

我认为至少有两种解决方案：

1) 更简单的是建立到安全区域的链接。当用户单击此链接时，他将被重定向到登录页面（如果他没有登录）。

2）您可以在您的 url 链接中使用确认令牌，如 FOSUserBundle 用于电子邮件确认：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Controller/RegistrationController.php#L99](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Controller/RegistrationController.php#L99)

# c++ - stringstream：为什么这段代码没有返回 4？

> ID：10954697
> 
> 赞同：1
> 
> 时间：2012-06-08T19:06:49.910
> 
> 标签：c++, stringstream

```
#include <iostream>
#include <sstream>

using namespace std;

int get_4()
{
  char c = '4';
  stringstream s(ios::in);
  s << c;
  int i;
  s >> i;
  return i;
}

int main()
{
  cout << get_4() << endl;
} 
```

转换对我不起作用。如果我将字符 '4' 或字符数组 {'4','\0'} 写入 stringstream，然后将其读出到 int i，我不会取回 4。上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T19:10:17.867

因为您将 设置`stringstream`为仅输入 - 无输出。

如果您在*尝试*提取`fail()`后检查该位，您会发现它不起作用：*`int`*

 *```
 s >> i;
  bool b = s.fail();
  if( b )
      cerr << "WHOA DOGGIE!  WE BLOWED UP\n"; 
```

* * *

在您的代码中，更改：

```
stringstream s(ios::in); 
```

到：

```
stringstream s; 
```*

# objective-c - 将 openGL ES 纹理读取到原始数组

> ID：10954703
> 
> 赞同：3
> 
> 时间：2012-06-08T19:07:14.067
> 
> 标签：objective-c, opengl-es, textures

我正在尝试从 openGL ES 中的 RGBA 纹理中获取字节。我想我正在尝试模仿`glGetTexImage`香草 openGL。就像现在一样，像素都是零，从调用到`glClear`，而不是我正在寻找的纹理数据。

这是从 Sparrow 框架扩展 SPTexture 的类别中的一种方法。

```
-(NSMutableData *) getPixelsFromTexture
{
    GLsizei width = (GLsizei) self.width;
    GLsizei height = (GLsizei) self.height;
    GLint oldBind = 0;
    glGetIntegerv(GL_TEXTURE_BINDING_2D, &oldBind);
    glBindTexture(GL_TEXTURE_2D, self.textureID);

    GLuint fbo[1];
    glGenFramebuffersOES(1, fbo);
    glBindFramebufferOES(GL_FRAMEBUFFER_OES, fbo[0]);

    GLuint rbo[1];
    glGenRenderbuffersOES(1, rbo);
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, rbo[0]);
    glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_RGBA4_OES, width, height);

    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, rbo[0]);

    GLenum status = glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES);
    if (status != GL_FRAMEBUFFER_COMPLETE_OES) {
        NSLog(@"Incomplete FBO");
    }

    // draw
    static float texCoords[8] = { 0.0f, 0.0f, 1.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f };
    static float vertexCoords[8] = { -1.0f, -1.0f, 1-.0f, 1.0f, 1.0f, 1.0f, 1.0f, -1.0f };

    glMatrixMode (GL_PROJECTION);
    glPushMatrix();
    glLoadIdentity ();
    glOrthof(0.0f, self.width, self.height, 0.0f, 0.0f, 1.0f);
    glMatrixMode (GL_MODELVIEW);
    glPushMatrix();
    glLoadIdentity();
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    glEnableClientState(GL_TEXTURE_COORD_ARRAY);
    glEnableClientState(GL_VERTEX_ARRAY);

    glTexCoordPointer(2, GL_FLOAT, 0, texCoords);
    glVertexPointer(2, GL_FLOAT, 0, vertexCoords);

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glDisableClientState(GL_VERTEX_ARRAY);

    glPopMatrix();
    glMatrixMode(GL_PROJECTION);
    glPopMatrix();
    // end draw

    GLsizei count = width * height * 4;
    GLubyte * pixels = (GLubyte *)malloc((sizeof(GLubyte) * count));
    glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);

    glBindRenderbufferOES(GL_RENDERBUFFER_OES, 0);
    glBindFramebufferOES(GL_FRAMEBUFFER_OES, 0);
    glBindTexture(GL_TEXTURE_2D, oldBind);
    glDeleteRenderbuffersOES(1, rbo);
    glDeleteFramebuffersOES(1, fbo);

    return [NSMutableData dataWithBytes:pixels length:count];
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:21:05.853

所以，我最终能够使用[这里](http://wiki.sparrow-framework.org/tutorials/rendering_objects_into_a_uiimage)看到的代码的变体来解决这个问题。我的代码是：

```
@interface SPRenderTexture (RenderToImage)

- (NSMutableData *)renderToPixelData;

@end

@implementation SPRenderTexture (RenderToImage)

- (NSMutableData *)renderToPixelData
{
    __block NSMutableData * pixels = nil;

    [self bundleDrawCalls:^() 
    {
    float scale = [SPStage contentScaleFactor];
    int width = scale * self.width;
    int height = scale * self.height;
    int nrOfColorComponents = 4; //RGBA
    int rawImageDataLength = width * height * nrOfColorComponents;
    GLenum pixelDataFormat = GL_RGBA;
    GLenum pixelDataType = GL_UNSIGNED_BYTE;

    GLubyte *rawImageDataBuffer = (GLubyte *) malloc(rawImageDataLength);
    glReadPixels(0, 0, width, height, pixelDataFormat, pixelDataType, rawImageDataBuffer);

    pixels = [[NSMutableData alloc] initWithBytes:rawImageDataBuffer length:rawImageDataLength];

    }];

    return [pixels autorelease];
}

@end 
```

我希望这对其他人有用。

# regex - 搜索源代码搞砸了，因为单词之间有多余的空格

> ID：10954705
> 
> 赞同：0
> 
> 时间：2012-06-08T19:07:37.260
> 
> 标签：regex, notepad++

我被告知要在网页上的现有段落中添加一些文本。我打开了相应的文件，复制了一些现有的文本，并在源代码中进行了搜索。搜索什么也没找到，我快疯了。事实证明，在源代码中，一些单词之间有额外的空格，由于浏览器中没有显示，所以在代码中搜索它们时出错了。

有人有避免这种情况的提示吗？例如，有没有办法忽略空格，也许使用正则表达式？添加一句文本应该很简单，但我最终使用了 Dreamweaver 中的设计视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:16:33.250

`using +a +pattern +like +this`使用正则表达式，您可以通过在每个空格后面放置一个来搜索多个空格`+`，这将指示搜索查找一个或多个。

# java - 为什么 boolean 是唯一没有定义强制或强制转换的类型？

> ID：10954709
> 
> 赞同：2
> 
> 时间：2012-06-08T19:07:49.570
> 
> 标签：java, language-design

不允许似乎是合理的

```
int a = 8;
boolean b = (boolean)a; 
```

因为这可能导致程序员错误，因为对于偶数整数，结果布尔值将是错误的，但为什么不扩大强制，例如`int a = true`工作？

**编辑：**

根据 JVM 规范，第 3.3.4 节：

> Java 虚拟机使用 1 表示 true 和 0 表示 false 对布尔数组组件进行编码。在 Java 编程语言布尔值由编译器映射到 Java 虚拟机类型 int 的值时，编译器必须使用相同的编码。

例如：

```
public static boolean returnFalse() {
    return false;
}

public static boolean returnTrue() {
    return true;
} 
```

编译为：

```
public static boolean returnFalse();
  Code:
     0: iconst_0
     1: ireturn

public static boolean returnTrue();
  Code:
     0: iconst_1
     1: ireturn 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T19:33:07.050

内部表示不相关。

Java 是强类型的：an`int`不是 a `boolean`，并且 a`boolean`不是`int`.

这是一个设计决定——如果你想使用真/假，使用布尔值；沟通的东西。

如果您想使用整数来*表示*真/假，请使用数学比较——这也很好。

该语言不支持直接转换，因为它在设计上不支持。

* * *

关于 JVM 规范和布尔值的内部表示，这句话很有意思：

> 在 Java 编程语言布尔值由编译器映射到 Java 虚拟机类型 int 的值时，编译器必须使用相同的编码。

对我来说，上面写着：

> *如果*编译器/VM 使用 VM 整数来表示真/假，*那么*它必须使用 1/0 约定。*这意味着：*如果编译器/VM*没有*使用 VM 整数来表示真/假，则这不是必需的。

澄清这一点会很有趣，但最终并不相关，真的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:11:27.727

Java 不是 C++ 来持有一个 0 代表假和 1 代表真。在 java 中，布尔值是一种不同的数据类型。C++ 需要至少 1 个字节才能有一个布尔值。在 java 中，它取决于 JVM 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:13:54.027

这只是一个约定，在 C++ 等语言中，0 为假，所有其他整数为真。Java 没有任何约定为任何整数指定布尔值。

我对“为什么不扩大强制，例如 int a = true 起作用”感到困惑，您想知道为什么他们没有做到，所以这会将 1 分配给 a？

# c# - Oracle 查询生成

> ID：10954717
> 
> 赞同：-5
> 
> 时间：2012-06-08T19:08:29.833
> 
> 标签：c#, .net, sql, visual-studio-2010, oracle11g

我有一个文本框，其中填充了来自日期选择器的日期（日期类型）。

我有一个包含 3 列的表（名称、从日期（日期）、今天（日期））。在按钮单击活动上，它应该只显示那些在开始日期和截止日期之间指定日期的名称。

我想在这方面帮助我

```
 string v = System.Configuration.ConfigurationManager.ConnectionStrings["harish"].ConnectionString;
    con = new OracleConnection(v);
    con.Open(); 
    cmd = new OracleCommand("________", con); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:11:49.850

你甚至没有尝试。为此尝试 Oracle 和 MSDN。

但既然你陷入困境......

```
var cmd = new OracleCommand();
cmd.Connection = conn;      
cmd.CommandType = CommandType.Text;         
cmd.CommandText = "INSERT INTO Table (name, fromDate, toDate)VALUES(:nameVal, :fromVal, :toVal)";
cmd.Parameters.Add(new OracleParameter(":fromVal", OracleType.DateTime)).Value = fromDateVal;
cmd.Parameters.Add(new OracleParameter(":toVal", OracleType.DateTime)).Value = toDateVal;
cmd.ExecuteNonQuery();

//close the connection after done.... release the resources 
```

# modx-revolution - MODX 从片段访问页面内容

> ID：10954720
> 
> 赞同：0
> 
> 时间：2012-06-08T19:09:00.350
> 
> 标签：modx-revolution, chunks

我有一个父页面，我想通过一个块加载几个子页面的内容，就像在博客卷中一样：

Child1 内容是文本：Child 1 页面的文本

Child2 内容是文本：Child 2 页面的文本

Child3 内容是文本：Child 3 页面的文本

我不知道的是如何访问chunk中Child1、Child2、Child3页面的内容。我试过这样`[[~id_of_each_page]]`但它没有显示任何东西。

对此有什么想法吗，伙计们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:32:56.670

我知道这是一个老问题，但是`getResources`（额外的）是为此而生的。您可以使用它来指定要列出哪些子级或哪些父级的内容。它也是非常可定制的，因此您可以包含模板变量或您喜欢的任何内容、订单、限制等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T21:55:59.533

我找到了答案：我应该从父页面调用这些片段：

```
[[getResourceField? &id=`6` &field=`content`]]
[[getResourceField? &id=`7` &field=`content`]]
[[getResourceField? &id=`8` &field=`content`]] 
```

显然，您必须先从附加组件中获取 getResourceField。

# c# - 使用RegisterWaitForSingleObject 的asp.net 聊天？

> ID：10954726
> 
> 赞同：0
> 
> 时间：2012-06-08T19:09:25.403
> 
> 标签：c#, asp.net, .net, multithreading, .net-4.0

我已经*成功*地对客户端进行了服务器响应（我正在*学习*实现我自己的聊天）......

我有 2 个版本（一个工作，另一个不是）。

这是工作版本的代码。

```
 static EventWaitHandle _waitHandle = new AutoResetEvent(false);
   protected void Page_Load(object sender, EventArgs e)
    {
       var t = HttpContext.Current; //capture the context
       Response.Write("starting...");
       Response.Flush();
       new Thread(() => Waiter(t)).Start(); //start a new thread for later setting the wait handle...
       _waitHandle.WaitOne();  //wait - STOP THE THREAD !!
    }

private object Waiter(HttpContext httpContext)
{
    httpContext.Response.Write("111");
    httpContext.Response.Flush();
    Thread.Sleep(4000); 
    httpContext.Response.Write("222");
    httpContext.Response.Flush();
   /*... 2 more responsed like 222*/
    _waitHandle.Set(); //wakt the other thread
    return null;
} 
```

这是输出：

![在此处输入图像描述](../Images/77614c308d01fa18792a2c041094a033.png)

请注意，直到 set() 命令才释放 asp.net 线程。

让我们谈谈版本 2：

**[我](http://acessoparadesenvolvedor.blogspot.co.il/2011/07/c-thread-synchronization-essentials-18.html)**读到：

> 如果您的应用程序有很多线程将大部分时间都阻塞在等待句柄上，您可以通过调用 ThreadPool.Register WaitForSingleObject 来减少资源负担。

所以我的代码是：

```
 protected void Page_Load(object sender, EventArgs e)
    {
1       var t = HttpContext.Current;
2       Response.Write("starting...");
3       Response.Flush();
4       RegisteredWaitHandle reg = ThreadPool.RegisterWaitForSingleObject (_starter, Go, t, -1, true);
5       new Thread(() => { Thread.Sleep(4000); _starter.Set(); }).Start();
       ...
    } 
```

有问题...

在第 4 行之后 - 它继续（不阻塞）并且响应完成（asp.net 响应）...

我**以为**它应该**等到** **我发出信号**...？

我如何修复第二个版本？（我希望它像版本 1 一样 - 但没有*资源负担*问题（来自上面的链接）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T21:58:29.223

`RegisterWaitForSingleObject`不会阻塞你当前的线程；它基本上启动了一个线程池线程（新的或重用的）并`WaitForSingleObject`在调用你的“回调”之前调用。

您无法“修复”它，因为它应该是这样工作的。

# java - Facebook Android sdk 和 Facebook 应用重叠

> ID：10954727
> 
> 赞同：1
> 
> 时间：2012-06-08T19:09:30.353
> 
> 标签：java, android, facebook

我开发了一款集成了 facebook SDK 的 Android 游戏，用于检查一个人是否喜欢并分享结果。

我从我的朋友那里听说他的问题导致他无法在我的应用程序上使用点赞功能，所以我决定自己安装 facebook 应用程序来检查问题。

出于某种原因，如果我试图从 URL“https://api.facebook.com/method/pages.isFan?format=json&access_token=ACCESS_TOKEN&page_id=PAGE_ID”访问 fb api 读取数据，它会在 Android 上打开 Facebook 应用程序，该应用程序仅闪烁然后关闭.. 我怎样才能避免这种情况，或者有更好的方法来检查一个人是否喜欢我的页面以便给他奖励？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T10:59:45.093

我没有使用 Facebook API，但 Facebook 应用程序可能正在打开，因为它正在监听“api.facebook.com”的广播意图。您可以将意图显式发送到浏览器包，但这不是一个好的解决方案，因为有很多浏览器。

我会尝试使用 Loader 执行 HTTPS 请求来获取和解析 json。你试过这个吗？

我现在无法粘贴任何代码，抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T07:17:03.343

从您的评论到上面的答案，很高兴知道您解决了您的问题，这是您问题的答案

> 有没有更好的方法来检查一个人是否喜欢我的页面

您当然可以使用**FQL** - Facebook 查询语言来做到这一点，在 Facebook 网站的开发人员文档中给出。

有两个不同的表

1\. [Page](http://developers.facebook.com/docs/reference/fql/page/) - 您可以在其中获取有关页面的所有详细信息
2\. [Page_Fan](http://developers.facebook.com/docs/reference/fql/page_fan/) - 您可以使用它来了解页面的 fan-id

# drupal - 如何破解现有的 drupal 模块并添加实体引用？

> ID：10954730
> 
> 赞同：-1
> 
> 时间：2012-06-08T19:09:35.650
> 
> 标签：drupal, drupal-7, drupal-modules

我正在使用图像字段标记，并希望描述框加载节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T20:29:54.793

请不要使用预处理。那是为主题层。

使用[字段 API](http://api.drupal.org/api/drupal/modules!field!field.module/group/field/7)。

如果是针对节点编辑表单上的特定字段，请使用[表单更改](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_alter/7)来更改表单元素的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:53:28.783

如果您想修改字段行为，您可以在 template.php 中使用预处理字段挂钩

```
template_preprocess_field(&$vars, $hook){
if($vars['element']['#field_name'] == 'myfield')
$variables['loaded_node'] = drupal_render(node_view(node_load($nid)));
} 
```

然后创建主题文件**field--field-name.tpl.php**并从那里打印变量。

希望这有助于您的问题对您想要做什么有点模糊。

# php - 使用注解进行路由时，symfony2 ajax post 变为 get

> ID：10954731
> 
> 赞同：0
> 
> 时间：2012-06-08T19:09:45.673
> 
> 标签：php, ajax, symfony

我最近将 symfony2 包上的路由切换为在控制器中使用内联注释而不是 routing.yml 文件。之后，ajax 发布请求开始通过没有参数。我查看了它并注意到日志将发布请求显示为 [REQUEST_METHOD] => GET。取消带注释的路线会将请求变成帖子。在我切换路由之前，事情运行良好。

这是控制器和路线

```
class DefaultController extends Controller
{

  /**
   * @Route("/emailShare/", name="emailShare")
   * @Method({"GET", "POST"})
   */
  public function indexAction() 
```

和 jquery ajax

```
$.ajax({
        type : 'post',
        url: '/v2/social/emailShare', 
```

如果我使用 curl 发布到相同的 url，它会在日志中显示为帖子。

```
curl -d "param1=value1&param2=value2" http://mysite.com/v2/social/emailShare/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:23:49.897

我的基于注释的路由通过 POST 执行 Ajax 调用没有问题。与您的设置有几个不同之处：我根本没有在控制器中使用 @Method 注释，并且（FWIW）我的 jQuery Ajax 方法值全部大写。例如：

```
class DefaultController extends Controller
   {
    /**
     *
     * @Route("/", name="emailShare")
     */
    public function indexAction() 
```

和 jQuery（我使用 Twig 来设置路径）：

```
 $.ajax({
      type: 'POST',
      url: '{{path("emailShare")}}', 
```

以及相关的 routing.yml 行：

```
AcmeDemoBundle:
resource: "@AcmeDemoBundle/Controller/"
type:     annotation
prefix:   / 
```

# sql - XML Shredding 包括属性和内部元素值

> ID：10954737
> 
> 赞同：2
> 
> 时间：2012-06-08T19:10:27.180
> 
> 标签：sql, xml, xml-parsing, xquery, shred

考虑以下 XML 片段：

```
<Orders>
  <Totals>
     <Total Type="Merchandise">56.89</Total>
     <Total Type="Shipping">10.75</Total>
     <Total Type="Tax">0.00</Total>
     <Total Type="Order">67.64</Total>
     <Total Type="Discount">0.00</Total>
     <Total Type="ServiceFee">0.00</Total>
     <Total Type="ServiceFeeDiscount">0.00</Total>
  </Totals>  
</Orders> 
```

我想（使用 SQL 内置的 XQuery/XPath 支持），将 Type 属性和每个 Total 的值分解到它自己的列中，并将每个元素的内部值分解到它自己的列中，如下所示：

```
 Type           Amount  
Merchandise        56.89  
  Shipping         10.75  
     Tax            0.00 
```

我已经使用了我所知道的所有 XQuery 和 XPath，但无济于事。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:29:35.633

哇，不知道为什么我以前无法弄清楚这一点。请参见下面的代码：

```
select T.data.value('@Type', 'varchar(20)'),
   T.data.value('.', 'varchar(20)')
from @data.nodes('Orders/Totals/Total') T(data) 
```

# php - extjs 警报响应

> ID：10954739
> 
> 赞同：1
> 
> 时间：2012-06-08T19:10:42.830
> 
> 标签：php, extjs

我有以下代码

```
Ext.Ajax.request({
    url: 'newRecord.php',
    method: 'POST',
    type: 'json',
    params: {
        "author" : list.Author,
        "title" : list.Title,
        "manufacturer" : list.Manufacturer,
        "product_group" : list.ProductGroup
    },
    success: function(response) {
        alert(response.author);
    },
    failure: function() {
        alert('Failure');
    }
}); 
```

警报返回 undefined 但是我的 php 返回 {"author":"The author here"}

这里有什么错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:14:41.783

经过一番研究，我找到了答案：

诀窍是把它放在成功函数中

```
// resp is the XmlHttpRequest object
var options = Ext.decode(resp.responseText).author;
alert(options); 
```

# json - Json 数据未填充 jqGrid

> ID：10954744
> 
> 赞同：2
> 
> 时间：2012-06-08T19:11:01.827
> 
> 标签：json, jqgrid, asp.net-mvc-4

我的 jqGrid 没有填充在 Asp.net MVC 4 中提交我的表单...我想找出原因...我有一个返回此 Json 字符串的 ajax 方法，它是网络响应浏览器中的 Json 字符串...

```
"{\"total\":1,\"page\":1,\"records\":1,\"rows\":[{\"cell\":[\"\",\"342352857634\",\"test\",\"test\",\"5/8/2012 11:39:38 AM\",\"1\",\"\",\"1/1/0001 12:00:00 AM\",\"1/1/0001 12:00:00 AM\",\"1/1/0001 12:00:00 AM\"]}]}" 
```

这是完成所有魔术的功能。

```
$('#SearchPatID').submit(function (event) {
        //alert("What the motherFuck is going on here!");
        debugger;
        var theURL = this.action;
        var type = this.methd;
        event.preventDefault();
        $.ajax({
            url: this.action,
            type: this.method,
            data: $(this).serialize(),
            dataType: "json",
            success: function (result) {
                debugger;
                bindData(result);
            }
        });
        return false;
    });
    var bindData = function (result) {
    debugger;
    alert('Glad this is kind-of working!');
    $("#list").setGridParam({
        datatype: 'jsonstring',
        datastr: result,
        caption: 'Suck It!'
    }).trigger("reloadGrid");
    } 
```

**更新...我将我的 bindData 函数更改为 Just setGridParam。并重新加载......仍然无法正常工作，但我认为我终于走上了正确的道路......下面有更多更新......**

我错过了什么？我有我的 Json 数据，一切都应该正常吗？

更新：
我意识到我发送的是一个 JSON 字符串，而不是一个 JSON 对象......所以我将数据类型从 json 更改为 jsonstring......仍然不起作用。

这是返回我的 JSON 数据的内容。 **更新到我现在正在尝试的内容：我想尝试将列名放入数据中......出于某种原因，我认为这可能会有所帮助**

```
public static object JsonHelper(TemplateModel model){

        var values = model.Template;
        var JsonDataList = new {
            total = 1,
            page = 1,
            records = model.Template.Count,
            rows = (from val in values
                    select new {
                        cell = //new string(
                            "[\"id\" :\"" + val.EncounterId +",\""+
                            //"\"MRN\" :" + 
                            "\"MRN\" :\"" + val.MRN + ",\"" +
                            //"\"Hospital_Fin\" :" + 
                            "\"Hospital_Fin\" :\"" + val.HostpitalFinNumber + ",\"" +
                            //"\"First_Name\" :"+ 
                            "\"First_Name\" :\"" + val.FirstName + ",\"" +
                            //"\"Last_Name\" :" + 
                            "\"Last_Name\" :\"" + val.LastName + ",\"" +
                            //"\"Date_of_birth\" :" + 
                            "\"Date_of_birth\" :\"" + val.DateOfBirth.ToString() + ",\"" +
                            //"\"Completed_Pathway\" :" + 
                            "\"Completed_Pathway\" :\"" + val.CompletedPathway + ",\"" +
                            //"\"Completed_Pathway_Reason\" :" + 
                            "\"Completed_Pathway_Reason\" :\"" + val.CompletedPathwayReason + ",\"" +
                            //"\"PCP_Appointment\" :" + 
                            "\"PCP_Appointment\" :\"" + val.PCPAppointmentDateTime.ToString() + ",\"" +
                            //"\"Specialist_Appointment\" :" + 
                            "\"Specialist_Appointment\" :\"" + val.SpecialistAppointmentDateTime.ToString() + ",\"" +
                            //"\"Admit_Date\" :" + 
                            "\"Admit_Date\" :\"" + val.AdminDate.ToString() + "\"]"                            
                    })//.ToArray()
        };
        return JsonDataList;
    } 
```

加...

```
return Json(DataRepository.JsonHelper(model.FirstOrDefault()), JsonRequestBehavior.AllowGet); 
```

**这就是我设置jqGrid的方式......**

```
$(document).ready(function () {
        $("#list").jqGrid({
                        shrinkToFit: false,
                        autowidth: true,
                        datatype: 'local',
                        mtype: 'POST',
                        colNames: ['Edit',
                                   'MRN',
                                   'Hospital Fin',
                                   'First Name',
                                   'Last Name',
                                   'Date of birth',
                                   'Completed Pathway',
                                   'Completed Pathway Reason',
                                   'PCP Appointment',
                                   'Specialist Appointment',
                                   'Admit Date'
                                   ],
                        colModel: [
                                   { name: 'Edit', width: 95, align: 'left' },
                                   { name: 'MRN', width: 125, align: 'left' },
                                   { name: 'Hospital_Fin', width: 145, align: 'left' },
                                   { name: 'First_Name', width: 115, align: 'left' },
                                   { name: 'Last_Name', width: 115, align: 'left' },
                                   { name: 'Date_of_birth', width: 145, align: 'left' },
                                   { name: 'Completed_Pathway', width: 125, align: 'left' },
                                   { name: 'Completed_Pathway_Reason', width: 165, align: 'left' },
                                   { name: 'PCP_Appointment', width: 115, align: 'left' },
                                   { name: 'Specialist_Appointment', width: 125, align: 'left' },
                                   { name: 'Admit_Date', width: 185, align: 'left' }],
                        rowNum: 10,
                        rowList: [5, 10, 20, 50],
                        sortname: 'Id',
                        sortorder: "desc",
                        viewrecords: true,
                        imgpath: '/Content/themes/UPMC-theme/images',
                        caption: 'My first grid'
    }); }) 
```

我在网上某处读到将数据类型设置为“本地”，然后执行 setGridParam 和 trigger('reload') 会有所帮助。似乎合乎逻辑。但我仍然有点不确定这将如何工作......仍然没有工作，但我正在给它旧大学尝试......

**UDPATE：进一步解释** 我的 JsonHelper 只是试图写出一个有效的 JsonString ......有人有他们如何定期执行此操作的示例吗？每当我只使用标准的 Json ActionHelper 东西时......我想我可以制作一个不同的对象返回值，但这意味着我将不得不使用更多的 linq......这是另一天的冒险。

**UPDATE2：几个月过去了“你好。我已经被另一个项目分心了大约一个月。现在它开始结束了，这段代码又开始让我烦恼了。我觉得我很接近了，但到目前为止...

无论如何，这是我正在谈论的空 jqGrid 的示例... ![示例空 jqGrid](../Images/e924a3c526abcf4dd89af5ac3f773e15.png)
如您所见，我有两行数据，但它们中的任何一行都没有通常应该包含的任何数据...

这是调试模式下的数据...

```
["id" :"2005,""MRN" :"840108105,""Hospital_Fin" :"999999999999985,""First_Name" :"BETTY,""Last_Name" :"WHITE,""Date_of_birth" :"1/18/1951 12:00:00 AM,""Completed_Pathway" :",""Completed_Pathway_Reason" :",""PCP_Appointment" :"6/12/2012 12:00:00 AM,""Specialist_Appointment" :"6/12/2012 12:00:00 AM,""Admit_Date" :"7/5/2012 12:00:00 AM"]
["id" :"2025,""MRN" :"840108105,""Hospital_Fin" :"789654123000123,""First_Name" :"BETTY,""Last_Name" :"WHITE,""Date_of_birth" :"1/18/1951 12:00:00 AM,""Completed_Pathway" :",""Completed_Pathway_Reason" :",""PCP_Appointment" :"1/1/0001 12:00:00 AM,""Specialist_Appointment" :"1/1/0001 12:00:00 AM,""Admit_Date" :"7/6/2012 12:00:00 AM"] 
```

这直接来自我的 JSON 助手......它基本上从我返回的模型中创建了两个字符串对象......这就是 JSON 数据在绑定期间在客户端的样子......

```
{"total":1,"page":1,"records":2,"rows":[{"cell":"[\"id\" :\"2005,\"\"MRN\" :\"840108105,\"\"Hospital_Fin\" :\"999999999999985,\"\"First_Name\" :\"BETTY,\"\"Last_Name\" :\"WHITE,\"\"Date_of_birth\" :\"1/18/1951 12:00:00 AM,\"\"Completed_Pathway\" :\",\"\"Completed_Pathway_Reason\" :\",\"\"PCP_Appointment\" :\"6/12/2012 12:00:00 AM,\"\"Specialist_Appointment\" :\"6/12/2012 12:00:00 AM,\"\"Admit_Date\" :\"7/5/2012 12:00:00 AM\"]"},{"cell":"[\"id\" :\"2025,\"\"MRN\" :\"840108105,\"\"Hospital_Fin\" :\"789654123000123,\"\"First_Name\" :\"BETTY,\"\"Last_Name\" :\"WHITE,\"\"Date_of_birth\" :\"1/18/1951 12:00:00 AM,\"\"Completed_Pathway\" :\",\"\"Completed_Pathway_Reason\" :\",\"\"PCP_Appointment\" :\"1/1/0001 12:00:00 AM,\"\"Specialist_Appointment\" :\"1/1/0001 12:00:00 AM,\"\"Admit_Date\" :\"7/6/2012 12:00:00 AM\"]"}]} 
```

光看我的数据，好像有点乱。我将尝试修复它是否会使它看起来更好。但如果您有任何其他建议，我肯定会很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T22:14:04.097

我想您在使用的服务器代码中存在严重问题。如果您`$.ajax`使用参数发出请求，`dataType: "json"`则将`$.ajax`数据转换为对象。来自服务器的响应好像您将返回的对象转换为 JSON**两次**。

我假设您首先使用or手动将带有`total`、`page`和属性的对象转换为 JSON ，`records`然后使用. 结果，字符串将被额外编码。`rows``JavaScriptSerializer``DataContractJsonSerializer``return Json(myJsonString);``JSON`

此外，如果您想使用`datastr: result`必须使用的数据`datatype: 'jsonstring'`而不是`datatype: 'json'`需要`url`参数。

告诉信任您的代码还有其他问题。从元素`$("#list").jqGrid({...});` **创建**`<table id="list"></table>`网格，代码只能执行**一次**。您当前的代码是这样编写的，以便`bindData`可以在每次提交表单时多次调用该函数。

此外，您使用`gridview: false`which 会降低性能（您应该始终使用`gridview: true`）。`imgpath`多年来，jGrid 中不存在该选项。我想您得到了一些非常古老的 jqGrid 用法示例，并尝试根据您的目的对其进行修改。

我建议您获取一些更新的示例，例如从[答案](https://stackoverflow.com/a/9349688/315935)或以[这个](https://stackoverflow.com/a/5501644/315935)为起点。您应该更好地`datatype: 'json'`直接使用并将附加参数发送到服务器，例如[此处](https://stackoverflow.com/questions/2928371/how-to-filter-the-jqgrid-data-not-using-the-built-in-search-filter-box/2928819#2928819)描述的或使用`$.serializeArray`示例（请参阅[此处](https://stackoverflow.com/a/9654271/315935)）。

**更新**：**没有 JSON 对象**。要么您只有一个 Object ，要么您有一个可以表示 Object 编码的字符串对应于[JSON 标准](http://www.ietf.org/rfc/rfc4627.txt)。

你不需要使用任何`JsonHelper`. MVC 动作应该`Json(theObject)`像这样返回

```
return new {
        total = 1,
        page = 1,
        records = model.Template.Count,
        rows = ... 
```

};

[此外，这里](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data#json_data)描述的 jqGrid 的 JSON 数据的默认格式。您发布的代码`JsonHelper`包含

```
rows = (from val in values
        select new {
            invdata = new string[]{ ...}
        }).ToArray() 
```

并生成为没有属性和有属性`rows`的对象数组，而不是. 要读取数据，您至少需要包含. 更好的办法是返回正确的数据。如果可以将列表中的某些内容解释为可以包含在相应列中的行的唯一 ID，请使用并填充为或作为数组，其中元素为数组或字符串。`id``invdata``cell``jsonReader: {cell: "invdata"}``id``key: true``jsonReader: {cell: ""}``rows``List<List<string>>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T22:24:22.547

我认为您缺少评估。

```
 success: function (result) {
            debugger;
            var data = eval("(" + result.d + ")");
            bindData(data);
        } 
```

# ios - 将遮罩应用到 UIView 以模拟玻璃微光

> ID：10954745
> 
> 赞同：1
> 
> 时间：2012-06-08T19:11:08.880
> 
> 标签：ios, cocoa-touch, core-graphics

我的基本图像是具有多种颜色和 alpha 背景的复杂形状。

我的微光效果是带有 alpha 背景的白色倾斜渐变。

我的目标是在基本图像之上为微光图像设置动画，但使微光的 alpha 值与基本图像的相匹配。

我只使用图层蒙版来隐藏基于颜色的区域，而不是同时显示和隐藏图像的一部分。我需要创建多个蒙版来实现这一点吗？我的基础图像的白色版本将通过蒙版的微光图像显示，全部位于我的彩色基础图像之上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:32:16.063

由于您的微光效果是通过在基础图像上移动单个图像/图层来创建的，因此您只需要一个形状为基础图像中非 alpha 值的蒙版。您可能需要为覆盖在基础图像上的微光图像视图/图层使用容器视图，然后在容器上设置图像蒙版。

# python - 删除csv中的最后一行

> ID：10954748
> 
> 赞同：4
> 
> 时间：2012-06-08T19:11:23.917
> 
> 标签：python, csv

我正在尝试删除 csv 中的最后一行，但出现错误：`_csv.Error: string with NUL byte`

这是我到目前为止所拥有的：

```
dcsv = open('PnL.csv' , 'a+r+b')
cWriter = csv.writer(dcsv, delimiter=' ')
cReader = csv.reader(dcsv)
for row in cReader:
    cWriter.writerow(row[:-1]) 
```

我无法弄清楚为什么我不断收到错误

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:27:50.463

我会用 readlines() 读入整个文件，弹出最后一行，然后用 csv 模块写入

```
import csv
f = open("summary.csv", "r+w")
lines=f.readlines()
lines=lines[:-1]

cWriter = csv.writer(f, delimiter=',')
for line in lines:
    cWriter.writerow(line) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-21T01:34:44.140

这应该工作

```
import csv
f = open('Pnl.csv', "r+")
lines = f.readlines()
lines.pop()
f = open('Pnl.csv', "w+")
f.writelines(lines) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T22:35:15.923

我不确定您在使用“a+r+b”文件模式以及读取和写入同一个文件时做了什么，因此不会提供完整的代码片段，但这里有一个简单的方法可以跳过任何行在您正在阅读的文件中包含一个 NUL 字节，无论它是最后一个、第一个还是正在读取的中间文件。

诀窍是要意识到文档说`csv.writer()`“可以是任何支持*迭代器*协议并在每次`next()`调用其方法时返回一个字符串的对象”的 csvfile 参数。这意味着您可以使用以这种方式定义的简单过滤器迭代器函数替换调用中的文件参数：

```
def filter_nul_byte_lines(a_file):
    for line in a_file:
        if '\x00' not in line:
            yield line 
```

并以类似的方式使用它：

```
dcsv = open('Pnl.csv', 'rb+')
cReader = csv.reader(filter_nul_byte_lines(dcsv))
for row in cReader:
    print row 
```

这将导致在读取文件时忽略其中包含 NUL 字节的任何行。此外，该技术在读取每一行时即时工作，因此它不需要一次将整个文件读入内存或提前对其进行预处理。

# php - Ajax 调用的返回变量对于 JS 日期对象的类型无效

> ID：10954750
> 
> 赞同：0
> 
> 时间：2012-06-08T19:11:33.520
> 
> 标签：php, jquery, ajax

我正在尝试使用 Ajax 调用获取服务器日期和时间。我能够检索我需要的值，但是当我尝试使用它来创建一个 javascript 日期对象时，我得到一个无效的日期错误。我也尝试使用修剪来删除任何空格。有任何想法吗？

阿贾克斯调用：

```
// ajax call to getcurrent server time
$.ajax({
   type: GET',
   url: 'datetime.php',
   success: function(data) {
         console.log("Data: " + data);
         currentdate = new Date($.trim(data));
         console.log("Current date from server: " + currentdate);
  },
}); 
```

PHP代码：

```
<?php
    echo date('y,m,d,H,i,s');
?> 
```

控制台输出（铬）：

```
Data: 12,06,08,15,07,57 
Current date from server: Invalid Date 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:14:16.170

您正在尝试使用字符串，就好像它是文字代码一样。有点像使用`eval`，但实际上不包括`eval`.

是的，`eval`这是一种方法：`currentdate = eval("return new Date("+$.trim(data)+");");`

然而`eval`是邪恶的。相反，您应该这样做：

```
var elems = $.trim(data).explode(",");
elems[1]--; // remember months are zero-based in JS
currentdate = new Date(elems[0],elems[1],elems[2],elems[3],elems[4],elems[5]); 
```

不过，更好的是让你的 PHP 脚本是`echo time();`，那么你的 JS 可以是：

```
currentdate = new Date();
currentdate.setTime(data); 
```

# java - 遍历 JPA 对象列表并将它们存储在非 JPA 对象中

> ID：10954754
> 
> 赞同：0
> 
> 时间：2012-06-08T19:11:48.427
> 
> 标签：java, algorithm, spring, design-patterns, jpa

我有查询，当我使用 Group By 语句运行时，我得到以下格式的结果。

```
Country     Region      Town
---------------------------------------
England     North       NewCastle
England     North       Manchester
England     North       Leeds
England     South       London
England     South       Bristol
England     South       Birmingham
England     South       Portsmouth
Norway      North       Trondheim
Norway      North       Tromso
Norway      South       Oslo
Norway      South       Stavanger
Norway      West        Bergen 
```

结果返回一个 JPA 对象列表，如下所示

```
@Entity
@Indexed
@Table(name="Country")
public class Country extends AbstractDomainObject {

    private static final long serialVersionUID = 8619373591913330663L;

    private String country;
    private String region;
    private String town

    @Id 
    @Column(name="COUNTRY")
    public Long getCountry() {
        return batchNumber;
    }
    public void setCountry(String country) {
        this.country = country;
    }

    @Id
    @Column(name="REGION")
    public Date getRegion() {
        return region;
    }
    public void setRegion(String region) {
        this.region = region;
    }

    @Id
    @Column(name="TOWN")
    public String getTown() {
        return description;
    }
    public void setTown(String town) {
        this.description = description;
    }

    @Override
    public String toString() {
        return ToStringBuilder.reflectionToString(this);
    }
} 
```

我必须遍历 JPA 对象列表并创建新对象。我似乎无法获得循环结构。我花了太多时间试图做到这一点，所以我想知道是否有更好、更简单的方法来做到这一点。我想要实现的是将数据存储在以下类型的集合中：

```
class CountryTowns{

    String Country;
    List<Region> regions;

    //getters and setters
}

class Region{
    String region;
    List<String> towns;

    //getters and setters;
} 
```

要将数据存储在上面显示的对象中，我试图遍历数据并在 Country 或 Town 发生变化时创建对象，但我似乎无法正确处理。

```
List<CountryTowns> countryTowns = new ArrayList();
List<Country> countries = dataServicesFacade.getListOfCountries();
boolean firstIteration = false;

for(Country country : countries){

    if (firstIteration){
        CountryTowns countryTowns = new CountryTowns;
        Region region = new Region;
    }

    if(prevCountry.equals(country.getCountry())){
        if(prevRegion.equals(country.getRegion())){             

            region.setRegion(countryGetRegion())
            region.towns.add(country.getTown());            

        }else{          
            countryTowns.regions.add(region);
            Region region = new Region();
        }
    }else{
        CountryTowns countryTowns = new CountryTowns;
    }

    prevCountry = country.getCountry();
    prevRegion = country.getRegion();
} 
```

对于比上面显示的列多得多的列表，它很快就会变得混乱。您将如何解决上述问题，是否有推荐的方法或设计模式可以更轻松地遍历列表？

# html - tr 的背景色只出现在文本后面

> ID：10954757
> 
> 赞同：0
> 
> 时间：2012-06-08T19:11:56.360
> 
> 标签：html, css, asp.net-mvc-3, model-view-controller

我在 MVC 3 Web 应用程序生成的页面中有一个表格。我试图通过为 tr 标签设置背景颜色来突出显示特定行。当我这样做时，背景色只出现在实际文本周围，而不是单元格之间的空白处。我怎样才能让它覆盖单元格之间的空白？单元格没有边界。这是一些代码，@schedule.classString 解析为 ActiveSet 以获得我想要突出显示的条目。

```
<style>
    .ActiveSet
    {
        background-color:#b4c2e3;
    }
</style>

@foreach (var schedule in device.Schedules)
                    {
                        <tr class="@schedule.classString"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:15:45.320

```
table{
   border-collapse: collapse;
} 
```

这将删除单元格边界之间的空格，因此您也不会拥有此空白。

# javascript - 如何获得新的画布弧形描边样式？

> ID：10954761
> 
> 赞同：3
> 
> 时间：2012-06-08T19:12:06.123
> 
> 标签：javascript, html, dom, canvas

所以我正在尝试绘制一个简单的色轮，显示红色、绿色和蓝色分量以及它们之间的关系。问题是我的（简单的，1 度的）弧线正在采用后来的弧线的笔划，即使我正在使用`beginPath()`and `closePath()`。

我目前的进展是在[http://meyerweb.com/eric/css/colors/hsl-from-rgb.html](http://meyerweb.com/eric/css/colors/hsl-from-rgb.html)。最里面的戒指是该戒指的用途，蓝色渐变为黑色。下一个响铃应该只显示绿色渐变到黑色，第三个响铃应该只有红色渐变到黑色。最外面、最厚的环旨在显示色轮周围的全光谱，您可以在细辐条中看到（就像在其他环中一样）。

如果我颠倒绘图块的顺序，那么最外圈很好，所有内圈都乱了，所以很明显笔画样式正在向前泄漏。我只是不知道如何或为什么，也不知道如何克服这个问题。我应该只定义四个单独的对象（例如，`ctx1`通过`ctx4`）并分别绘制到每个对象吗？

我查看[了画布中 arc 的不同 fillStyle 颜色，](https://stackoverflow.com/questions/8549725/different-fillstyle-colors-for-arc-in-canvas)但那里的建议似乎对我没有帮助。其他谷歌搜索没有产生任何用处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:50:27.240

RGB 值不能使用小数，需要四舍五入。

[http://jsfiddle.net/M6KbD/](http://jsfiddle.net/M6KbD/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:38:01.960

我没有仔细看你的代码，但问题可能不在于画布，它可能是你绘制所有内容的顺序。

你有4套，对吧？您正在从第一组中抽取 1 个，从第二个中抽取 1 个，从第三个中抽取 1 个，从第四个中抽取 1 个，然后从第一个中抽取另外 1 个......

如果您更改顺序，一切都会好起来的：

[http://jsfiddle.net/muatT/](http://jsfiddle.net/muatT/)

（懒惰地，我只是照原样复制了整个 for 循环。你可能可以简化很多代码）

# c - 运行我的 Turbo-C HelloWorld 示例时出错

> ID：10954762
> 
> 赞同：-3
> 
> 时间：2012-06-08T19:12:08.880
> 
> 标签：c

当我运行简单的 printf 命令时，出现以下错误：

```
First.c 1: Unable to open file stdio.h
First.c 2: Unable to create output file 'D:\TCC\First.obj' 
```

请让我知道我在这里做错了什么。

平台：Windows IDE：Turbo C

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:14:35.233

**Windows 中的解决方案**

检查[此链接](http://in.answers.yahoo.com/question/index?qid=20070420045034AAtLR8Z)和以下解决方案：

*此解决方案从 stackoverflow.com 页面之一复制*

检查 INCLUDE 文件夹和 LIB 文件夹下是否有类似 stdio.h 文件和其他头文件的内容。LIB 包含一些文件。就我而言，我遇到了同样的问题，但是这两个文件夹都是空白的……很高兴知道。脚步：

1.  按：ALT + O + D（即按ATL（按住）然后按O英文字符）然后按D）。
2.  您将看到一个弹出窗口。

3.  此窗口将包含 INCLUDE 和 LIB 目录的值。弹出窗口中这两个框的默认值为： 安装 TC 的驱动器号... 即 C:\ 或 D:\ 或后面跟着 INCLUDE 和 LIB 文件夹路径的任何内容。所以，就我而言，

INCLUDE 框设置为：“C:\TC\INCLUDE”，LIB 目录值框设置为：“C:\TC\LIB”（不带引号）。解决步骤：

1.  按 ALT + C。
2.  将当前目录设置为 C:\TC\BGI
3.  按 ALT + O + D，然后将 ../INCLUDE 和 ../LIB 放入 Include/Lib 目录值中。
4.  现在......当你运行你的进度时，你会感谢我。我喜欢我现在在 DOS Turbo C 上运行的 archduchess C 分形图形。哈哈。

* * *

**Linux中的解决方案**

（不是在这个问题的情况下，但通常这种方法是有用的方法之一）

可能是您在 linux 中，并且您缺少一些 .h 和其他库文件。如果您在 linux 中执行此操作（此命令仅适用于基于 debian 的 linux 发行版）：

```
sudo apt-get install build-essential 
```

对于像fedora这样的其他人，你可以使用这个等价物：

```
# yum install make automake gcc gcc-c++ kernel-devel byacc 
```

或尝试

```
# yum groupinstall ‘Development Tools’

# yum groupinstall ‘Development Libraries’ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-18T14:24:21.910

**Windows**
*Turbo 下的解决方案对文件和目录名称有奇怪的速记规则。*
例如：
     我的 Turbo 的位置：
          C:\TC200
          C:\TC200\INCLUDE
          C:\TC200\LIB
          C:\TC200\MYPROJECTS

     My Turbo 的 Options->Directories 设置：
          包含目录：C:\TC200\INCLUDE
          库目录：C:\TC200\LIB
          输出目录：**C:\TC200\MYPROJECTS**
          Turbo C 目录：C:\TC200

     *注意上面的高亮设置是错误的，正确的方式是* **C:\TC200\MYPROJ~1**

# dynamic - NetStream 创建无缝动态播放列表 AS3

> ID：10954763
> 
> 赞同：2
> 
> 时间：2012-06-08T19:12:15.343
> 
> 标签：dynamic, playlist, netstream

我需要在 AS3 中动态创建一个具有近乎无缝过渡的播放列表。

我曾尝试将 play2 命令与 .APPEND 一起使用。它确实在非动态设置中工作。但我所拥有的是，在应用程序启动时，我知道第一个视频是什么，然后，在该视频结束之前，我会知道下一个要播放的视频是什么，依此类推，直到我收到消息，我播放了最后一个视频。

所以，一开始，我不知道会有多少个视频，也不知道要播放的文件的顺序。

如果我在流已经播放时尝试使用 APPEND 添加视频，它似乎会替换当前播放的视频，而不是开始缓冲并仅在当前视频的结尾播放。

我也不能使用 appendBytes，因为视频文件必须是 h.264 格式

任何人的帮助将不胜感激，因为我不知道该往哪个方向看了。如有必要，我可以提供更多详细信息。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:30:13.970

This is a bit of an off-the-cuff answer, but the logic is sound & should give you another direction to pursue.

Firstly, the concept: with Flash video you have 2 completely separate processes occurring simultaneously:

1.  buffering / loading

2.  the video playing

Thus, playing & streaming can & do occur simultaneously, but separately & that is where the logic should be hooked in.

So, on to the implementation: would be to have a primary player, and a secondary (shadow) player / loader. The primary player should be responsible for loading the initial video & playing it.

[& here comes the magic]

Once buffering in the primary player is complete, determined by the NetStream.Buffer.Flush NetStatusEvent on the NetStream object. Then begin buffering the following video in the shadow player, initialising the connection & using NetStream.Pause, to begin buffering, but not playing, while the primary player plays out.

When playing is complete in the primary player (determined by the NetStream.Play.Stop event) you can pass the variables (NetConnention, NetStream & Video) (always passed by reference) from the shadow player over to the primary player & it *should* continue practically seamlessly. Then clear the values from the shadow player & repeat the above process, waiting for buffering to complete before loading the next video; ad infinitum.

Alternatively, you can have a more balanced approach - although in my mind this will be more resource intensive (as you'll have 2 video players continually active) - and have a primary & secondary player, where they alternate. As soon as one buffer is complete, you begin buffering the next, as soon as playing is complete, you switch from one player to the other.

This will be be pretty fiddly to assemble (hence the lack of an example, as it is complicated, and in essence, your job ;) as you'll be dealing with 2 sets of NetConnections, NetStreams & Videos - which are complicated to begin with, lots of events that require handling...

But, I don't think play2() is your answer here, that is used primarily to reawaken broken/closed NetConnections. The problem that faces you here is seamless asynchronisation of 2 separate NetConnections & NetStreams.

Ping me if you still need assistance/explanation here, this is a bit of an old Q & I don't want to write a few hundred lines of code if you've already moved on...

Best, a.)

# jquery - 如何使用 jQuery 获取表格中突出显示的行的数组？

> ID：10954765
> 
> 赞同：1
> 
> 时间：2012-06-08T19:12:18.863
> 
> 标签：jquery, row, css-tables

我有一张桌子，当用户点击一行时，它以黄色突出显示。我使用一个类来使用 CSS 设置颜色，如下所示：

```
.highlight {
    background-color: yellow; 
} 
```

现在，当用户单击提交按钮时，我想获取所有突出显示的行，然后从该行获取特定列值，然后将它们放入数组中。我遗漏了一些东西，因为我的选择器没有在数组中放入任何行数据。

```
var arr = $('#tbl tr').filter(":has(.highlight)"); 
```

这是我在另一个函数中用来在用户单击它时从单行获取值的方法。下面的代码有效，但我需要对所有突出显示的行执行此操作。

```
$(this).find('#selectedRowItem').text() 
```

我正在使用 jQuery 1.6.4。顺便一提。

此外，我正在考虑使用 data 函数来缓存它作为更好的选择，但选择了数组作为更简单的解决方案。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:15:46.810

```
var highlighted=$('body .highlight'); 
```

这样就可以了，然后您可以使用**$.each**循环遍历数组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:26:29.667

詹姆斯，你不需要在你的选择器中加上“有”。因此，使用下面的代码，您的选择器将起作用

```
$('#tbl tr').filter(".highlight") 
```

看看这个小提琴：http: [//jsfiddle.net/estevao_lucas/kDSmS/](http://jsfiddle.net/estevao_lucas/kDSmS/)。我希望这对你有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:18:43.593

```
var $highlighted = $('#tbl tr.highlight'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T19:19:33.813

尝试这个：

```
var $highlighted = $("#tbl .highlight [id=selectedRowItem]");
var arr = $.map( $highlighted, function (el, i) {
    return $highlighted.eq(i).text();
}); 
```

但是，我强烈建议您将 selectedRowItem ID 更改为类名，ID 必须是唯一的。

# facebook - 如何从 iPhone 应用程序以用户身份登录 Facebook，以便在他们的墙上发帖？

> ID：10954767
> 
> 赞同：0
> 
> 时间：2012-06-08T19:12:22.100
> 
> 标签：facebook, facebook-graph-api

我有一个必须将游戏分数发送到某人的 Facebook 墙上的应用程序，但我不知道如何从该应用程序登录。

您可以仅使用 url 参数或 PHP 代码登录 facebook 吗？类似于： `http://facebook.com?login=**myusername**&password=**thepass**`使用 GET 或 POST。如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:16:23.043

不可以。要在 Facebook 上发布到用户的墙上，您需要让他们安装您编写的具有[`publish_stream`权限](https://developers.facebook.com/docs/authentication/permissions/)的应用程序，然后您可以使用[`scores`端点](https://developers.facebook.com/docs/score/)发布这些分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:14:06.943

不，Facebook 永远不会对此进行编码，因为它是暴力破解用户密码的安全漏洞。

你应该看看[Facebook API。](http://developers.facebook.com/)

# c++ - 尝试将 << 流作为朋友重载时无法访问的成员函数？

> ID：10954769
> 
> 赞同：1
> 
> 时间：2012-06-08T19:12:24.917
> 
> 标签：c++, friend

* * *

问题已解决，谢谢大家的帮助！

* * *

我遇到了一个我似乎无法弄清楚的问题。

我试图将 ostream 运算符重载为友元函数，以便能够打印出该对象的成员数据，但我似乎无法让它工作。

这是我到目前为止得到的：

.h 文件：

```
Class TestIt:
{
public:
TestIt();
TestIt(int a, b);

friend ostream& operator <<(ostream& outputStream, const TestIt& a);

Private:
int NUMBER1;
int NUMBER2;
}; 
```

.cpp 文件：

```
ostream& operator <<(ostream& outputStream, const TestIt& a)
{
 outputStream << a.NUMBER1 << " " << a.NUMBER2;

return(outputStream);
} 
```

我想做的是，在 ostream 中传入一个对象，然后输出其成员数据。我收到的错误是

“在 TestIt.h 中声明的成员 TestIt::NUMBER1 不可访问。

我的其他成员数据也存在同样的错误。

为什么会这样？

谢谢您的帮助。

* * *

这是我刚刚编写的整个程序，给了我同样的错误：

测试类.cpp

```
#include "TestClass.h"
#include <iostream>

using namespace std;

TestClass::TestClass(int a, int b)
{
    age = a;
    whole = b;
}

int TestClass::GetAge() const
{
    return(age);
}

ostream& operator <<(ostream& outputStream, const TestClass& t1)
{
    t1.whole;
    t1.age;

    return(outputStream);
} 
```

测试类.h

```
#ifndef TestClass_H
#define TestClass_H

class TestClass
{

public:
    TestClass(int a, int b);
    int GetAge() const;

    friend ostream& operator <<(ostream& outputStream, const TestClass& t1);

private:
    int whole;
    int age;

#endif 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:20:47.100

`operator<<`你定义的那个和`operator<<`你加为好友的那个不是同一个名字。你在使用命名空间吗？

# css - 如何使这个布局在 CSS 中更具响应性？

> ID：10954775
> 
> 赞同：0
> 
> 时间：2012-06-08T19:12:52.907
> 
> 标签：css, layout, responsive-design

理想情况下，我希望以更直观的方式对齐 div，请参阅小提琴：http: [//jsfiddle.net/stefek99/jZB2q/](http://jsfiddle.net/stefek99/jZB2q/)

![在此处输入图像描述](../Images/9fcffb42859b613111483383ed51f4b9.png)

我正在考虑“获取计算样式”来计算高度，然后更改列的顺序，但我认为这太过分了。有什么简单的策略可以让这个 CSS 布局更加对齐吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:17:15.420

看看 jQuery [masonry 插件](http://masonry.desandro.com/)。它完全符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:54:47.813

您可以使用`inline-block`它们将它们打包成等高的行。

您可以提供偶数元素`float:left`和奇数元素，`float:right`以减少糟糕的包装。

# html - 在 Firefox/IE/Chrome 中设置相同的 td

> ID：10954781
> 
> 赞同：0
> 
> 时间：2012-06-08T19:13:38.113
> 
> 标签：html, html-table, cross-browser

我有一个表格，我给每个`<td>`s 一些样式以具有背景颜色等。它们中也有不同数量的数据。具体来说，我有两个`<td>`相邻的 s，其中一个包含使其比另一个更高的内容。在 Chrome 中，较短`<td>`的高度与较高的高度相同`<td>`，具有样式和所有内容。在 Firefox/IE 中，较短的`<td>`只是根据需要占用尽可能多的空间。我试过给出`<td>`高度：100%，但这并没有真正做任何事情。我还尝试在 td 内设置一个高度为 100% 的 div，但这也无济于事。

我怎样才能让它在所有三个浏览器中表现相同？我不一定需要它是任何一种方式，尽管实际上能够控制它会很好。我主要只需要它的行为相同。

这是最终的html。这可能有点难以理解，因为那里有很多淘汰赛的东西。

```
 <div class="container">
    <div class="inner-container">
<table>
        <tbody><tr><td style="text-align: right"><input type="button" id="manageSaveButtonTop" class="journal-button manage-save-button manage-save-button-top" value="Save"></td></tr>
        <tr>
            <td id="template" class="outer-div">
                    <h6>Templates</h6>
                    <ol class="journalTree sortable template manageJournal ui-sortable" >
<li class="group mine template">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">New Group</span>
</li>

<li class="no-nest mine template">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">New Objective</span>
</li>

                    </ol>
                <!--</div>-->
            </td>
            <td id="myJournal" class="outer-div droppable ui-droppable">
                <!--<div id="myJournal" class="outer-div droppable ui-droppable">-->
                    <h6>My Journal</h6>
                    <ol class="journalTree sortable myJournal manageJournal ui-sortable">
<li class="group mine ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">New Group</span>
</li>

<li class="no-nest deleted ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">Blank Objective</span>
</li>

<li class="group deleted ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">Deleting Group</span>
    <input type="text" style="display:none" class="itemTextBox"></div>
        <ol >
<li class="no-nest deleted ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">Test Deleting</span>
</li>
        </ol>
</li>

<li class="group deleted ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">New Group</span>
    <input type="text" style="display:none" class="itemTextBox"></div>
        <ol>
<li class="no-nest deleted ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">New Objective</span>
</li>

        </ol>
</li>

                    </ol>
                <!--</div>-->
            </td>
        </tr>
        <tr><td style="text-align: right"><input type="button" id="manageSaveButtonBottom" class="journal-button manage-save-button bottom" value="Save"></td></tr>
    </tbody></table></div></div> 
```

​</p>

我无法将高度设置为特定高度，因为右表的高度会动态变化（通过向其添加更多内容）。这是相关的CSS：

```
#myJournal
{
    border: 1px solid black;
    display: inline-block;
    vertical-align: top;
    background-color: #dde5e4;
    width: 650px;
    height: 100%;
    border-radius: 25px;
    -moz-border-radius: 25px;
}

#template
{
    border: 1px solid black;
    display: inline-block;
    vertical-align: top;
    background-color: #dde5e4;
    width: 500px;
    height: 100%;
    margin-right: 100px;
    border-radius: 25px;
    -moz-border-radius: 25px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:17:38.060

避免设置任何内联属性，而是使用 CSS 来设置表格样式。尝试使用 CSS 设置单元格宽度。你可以做这样的事情（理想情况下你希望你的 CSS 在一个单独的文件中，但只是为了说明）：

```
<style type="text/css">
    table#myTable td {
        height: 200px;
        width: 200px;
    }
</style>

<table id="myTable">
    <tbody>
        <tr>
          <td>My data</td>
        </tr>
    </tbody>
</table> 
```

如果您想要不同的大小，请创建单独的类并将它们应用于您的单元格：

```
<style type="text/css">
    td.small-cell {
        width: 100px;
    }
</style>

<table id="myTable">
    <tbody>
        <tr>
          <td class="small-cell">My data</td>
        </tr>
    </tbody>
</table> 
```

最后，如果您正在开始一个项目，您可能希望节省一些时间并使用 CSS 框架，例如[Twitter Bootstrap](http://twitter.github.com/bootstrap/)，它会为您解决浏览器的不一致问题。

# css - 如何构建类似 Twitter 的半透明背景叠加层？

> ID：10954788
> 
> 赞同：1
> 
> 时间：2012-06-08T19:14:28.807
> 
> 标签：css, twitter, overlay, opacity

[我指的是Twitter 页面](https://twitter.com/RealSkipBayless/status/210933175684313088)主要内容周围的半透明白色边框。它是一直延伸到标题的白色边框。

只是想知道是否有人有一个方便的快速演示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T12:24:29.977

最新的 Twitter 更新使其只有以下内容才能让您的 Twitter 变得透明...... [http://userstyles.org/styles/75782/newtwitter-semi-transparent-stream-and-dash-v0-2](http://userstyles.org/styles/75782/newtwitter-semi-transparent-stream-and-dash-v0-2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T19:26:01.047

你可以用css3做到这一点。制作一个div：

```
<div class="container transparent">
  Your content
</div> 
```

然后在您的样式表中（现已修复）：

```
.transparent {
    background: rgba(255,255,255,.5);
} 
```

不过，查看该推特页面的来源，看起来他们使用了透明的 png：

```
background: url(https://si0.twimg.com/a/1339096274/t1/img/wash-white-30.png); 
```

# php - 无法使用 fwrite 在 PHP 中换行

> ID：10954795
> 
> 赞同：0
> 
> 时间：2012-06-08T19:14:48.230
> 
> 标签：php

我正在使用此代码将用户输入添加到文本文件：

```
<?php

//establish variables
$myFile = "chapter2.txt";
$fh = fopen($myFile, 'a') or die("can't open file");
$name = $_POST["name"];
$gnumber = $_POST["gnumber"];

fwrite($fh, $name); 
fwrite($fh, "\n");
fwrite($fh, $gnumber);

fclose($fh);

?> 
```

但是，它将它添加到文本文件中，如下所示：

名字gnumber

而不是这个：

姓名

编号

为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T19:18:03.890

您可以尝试几件事。主要的是：尝试使用`fwrite($fh,PHP_EOL)`而不是`fwrite($fh,"\n");`，因为这将确保您的脚本为您所在的操作系统生成正确的行尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:16:35.217

听起来您正在通过 HTML 查看输出，在这种情况下，输出不会只用 \n 换行。

```
fwrite($fh, "<br />".PHP_EOL); 
```

# ios - Box2d 度数被翻转

> ID：10954796
> 
> 赞同：0
> 
> 时间：2012-06-08T19:14:53.877
> 
> 标签：ios, box2d

我有一个 B2Body，我正在设置它的速度。我正在使用 Box2d 并注意到度数被翻转了。换句话说，我基本上有一个向后量角器（一个从右侧而不是左侧从零开始的量角器）。谁能给我一个算法让它从左边开始从零开始？

注意：我尝试了角度 += 180；但是现在当我有 90 作为角度时，它会下降而不是上升，但 180 和 0 可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:24:38.867

您可以将角度乘以 -1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:57:44.653

我使用了 iforce2d 的建议，并进行了一些修改。

# android - 为什么画布与onDraw中的视图大小不同？（安卓）

> ID：10954798
> 
> 赞同：10
> 
> 时间：2012-06-08T19:15:00.123
> 
> 标签：android, android-canvas

我试过这个

```
@Override
protected void onDraw(Canvas canvas)
{
    Log.e("TEST", "canvas width: " + canvas.getWidth() + "");
    Log.e("TEST", "view width: " + this.getWidth() + "");

    Log.e("TEST", "canvas height: " + canvas.getHeight() + "");
    Log.e("TEST", "view height: " + this.getHeight() + "");
    super.onDraw(canvas);
    Log.e("TEST", "canvas width: " + canvas.getWidth() + "");
    Log.e("TEST", "view width: " + this.getWidth() + "");

    Log.e("TEST", "canvas height: " + canvas.getHeight() + "");
    Log.e("TEST", "view height: " + this.getHeight() + "");
} 
```

这是结果：

```
canvas width: 320
view width: 480
canvas height: 533
view height: 300
canvas width: 320
view width: 480
canvas height: 533
view height: 300 
```

部分来自我的 main.xml

```
 android:layout_width="480px"
    android:layout_height="300px" 
```

根据我的日志打印和我的部分 xml，视图大小是正确的。我的设备是 480x800，宽度和高度除以 Log 结果为 1.5（800/533=1.5 和 480/320=1.5），所以我似乎从整个屏幕上得到了画布。为什么会这样，为什么这么小，我应该怎么做才能以正常方式绘制？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T23:24:57.000

西装，

视图管理的画布对象可能总是与您的屏幕尺寸不同。很大程度上取决于您使用上述逻辑的对象。这样做的原因是，Android 创建一个新的画布或重用旧的画布，这取决于您的父母和孩子的渲染方式以及在处理周期中调用它的位置。当您覆盖行为并动态更改视图时，事情会变得更加奇怪（尤其是在布局/测量/绘制周期中这样做时。

> 为什么会这样，为什么这么小……

画布的大小基于它所在对象的布局参数。如果覆盖 onMeasure 或 onLayout，画布将仅重新调整需要重新调整的内容。如果你对画布大小有疑问，你真的想看看你正在绘制的视图的布局参数。有时它会更大，有时它会更小。它只会与顶级 View/ViewGroup 中的屏幕大小相同，该 View/ViewGroup 具有`match_parent`（或`fill_parent`）用于全屏（无通知栏）且不使用样式的 Activity`layout_width`和Activity。`layout_height``Theme.Dialog`

> ...我应该怎么做才能以正常方式绘制？

这取决于您所说的正常以及您的需求是什么。如果您尝试手动管理整个 UI，那么您必须控制顶级对象。这通常是通过扩展顶级视图来完成的，以便您可以覆盖该行为。启动器通过覆盖顶层 FrameLayout 及其子视图来实现这一点。请注意，这可能会很昂贵，因为如果你有足够大的画布，你可以从屏幕上画出东西。

大多数程序利用子视图并简单地覆盖它们绘制的方式，理解子视图不应该控制父视图的绘制方式。在这种情况下，画布很小且有限，但它优化了逻辑并允许对象相应地移动，同时保持渲染稳定。

游戏使用全屏`SurfaceView`来满足他们的需求。这提供了一个非常灵活的画布，优先考虑手动和不断变化的演示文稿。有许多示例和教程展示了如何执行此操作。只需在 Google 中搜索`SurfaceView`.

通常，对于大多数视图，可以在其面向对象的性质中使用默认的渲染和绘图方法。正确使用 onMeasure 和 onLayout 等函数通常可以达到预期的效果。在不了解您的特定需求的情况下，这是可以给出的最佳建议。

**更多信息（不确定相关性）**

了解 Android 如何呈现视图对于实现理想的结果至关重要。引擎中包含了太多内容，以至于它必须考虑多个屏幕，以及在给定许多不同参数的情况下呈现相同视图的不同方式。我会研究如何利用布局参数来减少你必须做的工作量。此外，还有很多关于 onMeasure、onLayout 和 onDraw 之间关系的信息。在许多情况下，只需将正确的参数应用到正确的视图中，就会对正确渲染对象所需的控制量产生巨大影响。

希望这可以帮助，

模糊逻辑

# c# - 如何在 C# 中进行字符串显示限制？

> ID：10954801
> 
> 赞同：2
> 
> 时间：2012-06-08T19:15:06.087
> 
> 标签：c#

今天我学到了两件事

1 - 在文本框中显示 int 格式：0001

> Number.ToString("0000.");

2 - 以这种格式显示双倍：03.00 英镑在文本框中

> Price.ToString("£ 00.00");

我的问题是：如何在 c# 中显示字符串的限制？

我的意思是字符串中的值是

```
string myString = "Hello World!" 
```

我希望它显示 20 个字母，以便显示

```
"Hello World!        " 
```

如果超过 20 个字母，它将跳过显示其余部分，例如：

```
string myString = "I Love every thing you say :*" 
```

它只会显示以下内容：

```
"I Love every thing y" 
```

最多显示 20 个字母（计算空格）..

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:19:53.047

您需要使用 Substring 或 PadRight

```
int length = 20;
string original = "I Love every thing you say :*";

string finalString = original.Length > length ? 
                   original.Substring(0, length) : 
                   original.PadRight(length); 
```

这将根据需要采用适当长度的子字符串或用空格填充。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T19:17:43.717

```
string myString = "I Love every thing you say :*"

string fixedWidth = string.Format("{0, -20}", (myString.Length > 20 ? myString.Substring(0,20) : myString)); 
```

作为字符串扩展：

```
public static string ToFixedWidth(this string s, int length)
{
    return string.Format("{0, -20}, s.Length > length ? s.Substring(0, length) : s);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:22:00.587

我相信

```
String.Format("{0,-20}", "Hello World!"); 
```

会给你你需要的。

编辑：应该是逗号

编辑：没关系，这不会修剪。也许与子字符串结合：

```
String.Format("{0,-20}", "Hello World!").Substring(0,20); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T21:14:29.010

您还可以添加一个包含 21 个空格的字符串，然后删除以获得正确的长度：

```
string formattedStr = (myString + new string(' ', 21)).Remove(20); 
```

# jdbc - 查看 JBoss EDS/Teiid VDB 的 SYS 模式表

> ID：10954802
> 
> 赞同：2
> 
> 时间：2012-06-08T19:15:11.297
> 
> 标签：jdbc, jboss, odbc, microstrategy, teiid

有人可以帮助我了解如何在通过 ODBC-JDBC 桥连接时公开 JBoss Teiid 虚拟数据库的 SYS 模式对象吗？

客户端连接到桥的 ODBC 端，它的 JDBC 端连接到运行在 JBoss SOA 服务器上的虚拟数据库（VDB）。

在当前设置下，只有通过 JBoss Studio 的 Teiid Designer 建模的表和列被公开，但 SYS 模式及其底层对象不公开。客户端应用程序是 Microstrategy BI 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-07T06:53:05.270

您可以使用本机 JDBC JAVA API 遍历所有使用过的数据源中的所有元数据。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T15:58:43.480

我是 Teiid 的新手，也有类似的问题。

当您使用 JBoss 设计器创建 VDB 时，您可以指定哪些模型将公开给客户端应用程序。作为一种好的做法，只公开 View 模型，不公开 Source 模型。因此，查询 VDB 的系统表只会显示视图模型中的元数据，这将是基础数据源中元数据的子集。

希望这可以帮助。

# php - 如何在 PHP 中将 base64 转换为 base10？

> ID：10954803
> 
> 赞同：1
> 
> 时间：2012-06-08T19:15:12.830
> 
> 标签：php, algorithm, base-conversion

我目前在 PHP 中将 base10 数字转换为 base64。但我不知道在php中将base64转换为base10！

我该怎么做？

我将base10转换为base64的算法：

```
$rep = array('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','-','_');
$new = "";
while ($num>0) {
    $r = $num % 64;
    $new .= $rep[$r];
    $num = floor($num/64);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:19:19.907

这是一种 Javascript 方法。也许您可以为 php 编写一个代码。

```
var ALPHABET = {'-': 62, '1': 53, '0': 52, '3': 55, '2': 54, '5': 57, '4': 56, '7': 59, '6': 58, '9': 61, '8': 60, 'A': 0, 'C': 2, 'B': 1, 'E': 4, 'D': 3, 'G': 6, 'F': 5, 'I': 8, 'H': 7, 'K': 10, 'J': 9, 'M': 12, 'L': 11, 'O': 14, 'N': 13, 'Q': 16, 'P': 15, 'S': 18, 'R': 17, 'U': 20, 'T': 19, 'W': 22, 'V': 21, 'Y': 24, 'X': 23, 'Z': 25, '_': 63, 'a': 26, 'c': 28, 'b': 27, 'e': 30, 'd': 29, 'g': 32, 'f': 31, 'i': 34, 'h': 33, 'k': 36, 'j': 35, 'm': 38, 'l': 37, 'o': 40, 'n': 39, 'q': 42, 'p': 41, 's': 44, 'r': 43, 'u': 46, 't': 45, 'w': 48, 'v': 47, 'y': 50, 'x': 49, 'z': 51};

function decode(s) {
    var n = 0;
    for(var i=0; i < s.length; i++) {
        var c = s.charAt(i);
        n = n * 64 + ALPHABET[c];
    }
    return n;
}

console.log(decode('EqfyK')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-15T01:02:21.103

这是史蒂夫回答中 Javascript 的 PHP 版本：

```
function lengthen($id) {
    $alphabet='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-';

    $number=0;
    foreach(str_split($id) as $letter) {
        $number=($number*64) + strpos($alphabet,$letter);
    }
    return $number;
} 
```

请注意，字母表与您的字母表不同。字母表基于此处的答案： [Base10 to base64 url​​ shorting](https://stackoverflow.com/questions/3199771/base10-to-base64-url-shortening)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T03:25:44.737

如果您尝试使用数字文字编写用于基本转换的 PHP 代码，那么这可能是不可能的。

PHP 似乎并没有真正处理十六进制文字（或八进制）。显然，当解析一个十六进制时，PHP 在使用之前会在内部将十六进制转换为十进制！

这里有几个场景可以证明这一点。（检查[PHP: Integers - Manual](http://php.net/manual/en/language.types.integer.php)以查看 PHP 用于数字文字的符号。）

## 回响

数字文字在输出之前被解析为其十进制等价物。

```
// code       output

echo 26;      // 26
echo 0x1A;    // 26 
```

## 基础转换

使用 PHP 的函数可以`base_convert()`更好地演示 PHP 在使用前如何将十六进制解释为十进制。（检查[PHP：base_convert - Manual](http://php.net/manual/en/function.base-convert.php)。）

使用标准用法，我们将十六进制 0x1A 转换为十进制，反之亦然。

```
echo base_convert('0x1A', 16, 10);       // 26
echo base_convert('26', 16, 10);         // 1a 
```

现在对于非标准用法，十进制到十六进制可以正常工作，反之亦然。

```
echo base_convert(0x1A, 16, 10);         // 38
echo base_convert(26, 10, 16);           // 1a 
```

显然，十六进制在使用前`0x1A`会在内部转换为十进制`26`。这可以通过将十六进制转换`'26'`为十进制来证明。

```
echo base_convert(0x1A, 16, 10);         // 38
echo base_convert(26, 16, 10);           // 38 
```

# windows - 崩溃后的 Windows 事件查看器错误代码

> ID：10954804
> 
> 赞同：0
> 
> 时间：2012-06-08T19:15:13.280
> 
> 标签：windows, crash, event-log

> 错误代码10000050，参数1 e60c0000，参数2 00000001，参数3 bf04963f，参数4 00000001

我有一台反复蓝屏的计算机，这是系统日志中唯一看起来异常的错误。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:20:12.737

您需要确保所有驱动程序都是最新的。此外，一些简单的谷歌搜索会发现这个错误往往来自 XP 系统上的声音驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:21:32.173

似乎这里不是问这个问题的正确地方，但我们在这里为您带来了一些有用的信息：

1.  扫描您的计算机以查找病毒。病毒活动会影响控制视频卡功能的 DLL（动态链接库）文件。

2.  为您的视频卡下载最新的驱动程序。驱动程序取决于您的视频卡制造商，无论是 ATI 还是 Nvidia。

3.  单击“开始”，然后在搜索栏中键入“内存”。Windows 内存诊断工具应该是唯一的选择。单击它并选择“立即重新启动并检查问题”选项。如果严重错误仍然存​​在，则必须更换计算机中的随机存取存储器 (RAM)。

# c++ - 当向量被清除时，stl 向量中的 stl 向量是否超出范围？

> ID：10954806
> 
> 赞同：3
> 
> 时间：2012-06-08T19:15:20.087
> 
> 标签：c++, stl, vector

在这段代码中：

```
class myClass
{
    ...
    vector<myThing> thing(10);
    vector<myStuff> stuff(10);
    ...
}

vector<myClass> vecClass(10);
...
vecClass.clear();  /// calls destructor on myClass instances 
```

的每个元素`vecClass`包含 10 个元素向量。什么时候`clear()`被调用，这是否会使事物超出范围，从而被正确销毁？还是我必须做一些明确的事情？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T19:16:51.880

是的，它们的析构函数将被调用。您无需在这里做任何其他事情。

# javascript - 如何根据复选框显示不同的下拉菜单？

> ID：10954807
> 
> 赞同：0
> 
> 时间：2012-06-08T19:15:23.137
> 
> 标签：javascript, asp.net

我有一堆复选框项目，其中一个称为 nocalls 和几个下拉列表框。

以下是下拉框：

```
<tr>
                                        <td align="right"><FONT class="Arial10"><B>Profile<font color="#ff0000">*</font></B></FONT></td>
                                        <td>
                                        <asp:dropdownlist id="eProfile" runat="server" Width="144px">
                                                <asp:listitem Value="" Selected="True">--Select A Profile--</asp:listitem>
                                                <asp:listitem Value="Add Profile">Add Profile</asp:listitem>
                                                <asp:listitem Value="Delete Profile">Delete Profile</asp:listitem>
                                                <asp:listitem Value="Update Profile">Update Profile</asp:listitem>
                                                <asp:listitem Value="Transfer">Transfer</asp:listitem>
                                                <asp:listitem Value="See Notes">See Notes</asp:listitem>
                                            </asp:dropdownlist>
                                      </td>
                                    </tr>
                                    <TR>
                                        <td align="right"><FONT class="Arial10"><B>Profile<font color="#ff0000">*</font></B></FONT></td>
                                        <td>
                                        <asp:dropdownlist id="kProfile" runat="server" Width="144px">
                                                <asp:listitem Value="" Selected="True">--Select A Profile--</asp:listitem>
                                                <asp:listitem Value="Add Manager Profile">Add Manager Profile</asp:listitem>
                                                <asp:listitem Value="Add User Profile">Add User Profile</asp:listitem>
                                                                    </asp:dropdownlist>
                                      </td>
                                    </TR> 
```

下面是复选框列表

```
 <input id="CheckBox9" runat="server" type="checkbox" value="Notary" />Notary
                                                <input id="CheckBox10" runat="server" type="checkbox" value="VPN"  />VPN
                                                <input id="CheckBox11" runat="server" type="checkbox" value="VPSPagecenter"  />VPS-Pagecenter
                                                <input id="CheckBox12" runat="server" type="checkbox" value="PCDOC"  />PC DOC
                                            <input id="CheckBox13" runat="server" type="checkbox" value="nocalls" />nocalls 
```

如果用户选中 nocalls 复选框，我们希望只显示 kProfile 下拉列表，同时隐藏 eProfile 下拉列表。

如果用户点击了一个或多个复选框，但没有点击 nocalls 复选框，则 kProfile 下拉菜单会隐藏，而 eProfile 下拉菜单会显示。

我尝试使用 Javascript 来执行此操作，但我一直看到 2 个下拉菜单。

我知道我在做一些非常愚蠢的事情。

```
if (theForm.service.value.indexOf("nocalls") >= 0) {

    var kprofobj = document.getElementById("kProfile");
    var eprofobj = document.getElementById("eProfile");

        kprofobj.style.visiblilty = "visible";
        eprofobj.style.visiblilty = "hidden";
        kprofobj.style.display = "block";

}

<script type="text/javascript"> 
   $(document).ready(function () {
    if ($('#nocalls').attr('checked')) { 
        $('#eProfile').hide(); 
        $('#kProfile').show() 
    }; 
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:23:24.967

对于复选框，不要寻找值，而是寻找 CHECKED 属性。

```
if (theForm.service.checked) 
```

不是：

```
if (theForm.service.value.indexOf("nocalls") >= 0) 
```

基于 PS 表格的布局和内联样式是邪恶的。

PPS .NET 带有 jQ​​uery，允许您执行`$('#kProfile').hide()`/`$('#kProfile').show()`无需所有其他 JS 代码。

# java - Google 的 Json Parsing Gson 库：JsonElement 和 JsonObject 有什么区别？

> ID：10954815
> 
> 赞同：43
> 
> 时间：2012-06-08T19:16:04.267
> 
> 标签：java, android, gson

```
public abstract class JsonElement extends Object 
```

表示 Json 元素的类。它可以是 JsonObject、JsonArray、JsonPrimitive 或 JsonNull。

```
public final class JsonObject extends JsonElement 
```

在 Json 中表示对象类型的类。对象由名称-值对组成，其中名称是字符串，值是任何其他类型的 JsonElement。这允许创建 JsonElements 树。此对象的成员元素按添加顺序进行维护。

耶谷歌！

别管那个问题。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-08T19:37:09.250

`JsonElement`包含 JSON 中所有有效类型的通用代码：

*   JsonObject
*   json数组
*   JsonPrimitive（字符串、数字、布尔值）
*   JsonNull

这允许您编写一个方法，该方法采用`JsonElement`适用于上述任何类型的 a。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T19:35:46.083

`JsonElement`是所有不同特定类型的基类型——它是一个基类，具有所有节点都应该实现的共同事物。从逻辑上讲，这很有意义。

所有特定类型继承 `JsonElement`的东西对你来说也是一件好事。它允许您测试对象是否是 Json 节点表示，只需检查它是否继承自`JsonElement`.

该类`JsonElement`作为公共类可供您使用，这可能不是因为您想要子类化它，而是因为您想要测试它的子类。

# python - 如何关闭我没有分配给 Python 中的变量的文件？

> ID：10954816
> 
> 赞同：-1
> 
> 时间：2012-06-08T19:16:06.113
> 
> 标签：python, python-2.7

以下链接的解决方案没有解决我的问题：[如何关闭我从未分配给变量的文件对象？](https://stackoverflow.com/questions/9426978/how-do-i-close-a-file-object-i-never-assigned-to-a-variable)

如何关闭以下行中的文件？

```
file = open(filename, 'r').read().splitlines() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T19:19:05.427

这样的文件会自动被垃圾收集并关闭。但是，通常应该避免这种模式。相反，请使用以下`with`语句：

```
with open(filename, 'r') as fd:
    lines = fd.read().splitlines() 
```

# ios - 加载后视图框架发生变化

> ID：10954820
> 
> 赞同：3
> 
> 时间：2012-06-08T19:16:29.190
> 
> 标签：ios

看来我可能误会了什么。我有一个 iPad 应用程序，它是全屏的，没有状态栏或其他任何东西。它也总是处于横向模式，所以我不需要担心纵向。我正在使用正确的框架以编程方式创建视图，但是当视图实际加载并显示时，框架似乎有所不同。

这是我用来生成视图的代码（我在下面的视图中添加了更多内容，但它们与我的问题无关）：

```
- (void)loadView{
    self.view = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, 1024.0, 768.0)];

    backgroundImage = [[UIImageView alloc] initWithFrame:self.view.bounds];
    [backgroundImage setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight];
    [self.view addSubview:backgroundImage];
} 
```

在视图中确实出现了，我 NSLog 的框架 self.view 并得到`{{-128, -128}, {1024, 768}}`。大小正确，但原点已更改。为了看看会发生什么，我尝试使用 128、128 的原点初始化视图——这产生了一个`{{0, -256}, {1024, 768}}`我也无法解释的框架。

谁能告诉我到底发生了什么？我尝试设置自动调整大小的蒙版等，但它并没有真正改变任何东西。我有点卡住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:19:41.977

所有`UIViews`' 正确的几何图形仅在该`viewWillAppear:`方法中和之后可用。在此之前，尚未设置视图层次结构的几何形状，并且值不准确。如果你需要知道、改变、计算你不应该在`viewWillAppear:`方法之前做的帧。
**更新：**
重写`-loadView`方法以`self.view`使用`UIView`. 如果您使用的是 nib 文件，这将自动为您完成，您不应覆盖此方法。真实视图几何在此方法中不可用。
`-viewDidLoad`是设置视图层次结构的地方。这是您通常初始化子视图并将它们添加到您的`self.view`. 只要不需要多线程，您就可以执行一些较重的操作。视图几何在此方法中也不可用 - 自动调整大小的蒙版在这里仍然不起作用，您不能指望`frame`属性。
`-viewWillAppear:`是正确设置所有内容的地方，调整视图大小 - 如果要计算和设置其他几何图形，请使用此方法，`frame`属性是正确的。在这里只执行轻量级操作，因为这个方法不应该阻塞主线程，它应该尽可能快地执行。
对于`viewDidAppear:`.

# css - 让网站标题在多行上对齐

> ID：10954825
> 
> 赞同：-2
> 
> 时间：2012-06-08T19:16:38.790
> 
> 标签：css

在我的网站中，标题很长，因此它出现在两行中，但第二行没有对齐。如何使用 css 将两条线对齐在一起？

一个例子可以在[这里查看](http://pligg.marsgibson.info/story.php?title=when-i-was-responsible-for-all-the-pcs-in-a-large-studio-i-learned-that-i-needed-to-carry-a-recovery-disk-at-all-times-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:30:09.517

您需要创建一个样式以使头像向左浮动。这是一个例子：

```
#ls_avatar-0 {
float: left;
} 
```

此外，您可能希望清除浮动以防止区域崩溃，如下所示：

```
.subtext1 {
clear: both;
} 
```

# perl - Perl / Moose - 如何动态选择方法的特定实现？

> ID：10954827
> 
> 赞同：6
> 
> 时间：2012-06-08T19:16:46.047
> 
> 标签：perl, moose

我编写了一个简单的基于[Moose](https://metacpan.org/module/Moose)的类，名为`Document`. 这个类有两个属性：`name`和`homepage`。

该类还需要提供一个名为的方法，该方法`do_something()`根据`homepage`属性从不同来源（如网站或不同数据库）检索和返回文本。

由于 会有很多完全不同的实现`do_something()`，我希望将它们放在不同的包/类中，并且每个类都应该知道它是否负责该`homepage`属性，或者是否不是。

到目前为止，我的方法涉及两个角色：

```
package Role::Fetcher;
use Moose::Role;
requires 'do_something';
has url => (
    is => 'ro',
    isa => 'Str'
);

package Role::Implementation;
use Moose::Role;
with 'Role::Fetcher';
requires 'responsible'; 
```

一个名为的类，它为常用方法（如 HTTP GET 请求）`Document::Fetcher`提供默认实现：`do_something()`

```
package Document::Fetcher;
use Moose;
use LWP::UserAgent;
with 'Role::Fetcher';

has ua => (
    is => 'ro',
    isa => 'Object',
    required => 1,
    default => sub { LWP::UserAgent->new }
);

sub do_something {'called from default implementation'}
sub get {
    my $r = shift->ua->get(shift);
    return $r->content if $r->is_success;
    # ...
} 
```

以及通过名为的方法确定其职责的具体实现`responsible()`：

```
package Document::Fetcher::ImplA;
use Moose;
extends 'Document::Fetcher';
with 'Role::Implementation';

sub do_something {'called from implementation A'}
sub responsible { return 1 if shift->url =~ m#foo#; }

package Document::Fetcher::ImplB;
use Moose;
extends 'Document::Fetcher';
with 'Role::Implementation';

sub do_something {'called from implementation B'}
sub responsible { return 1 if shift->url =~ m#bar#; } 
```

我的`Document`课看起来像这样：

```
package Document;
use Moose;

has [qw/name homepage/] => (
    is => 'rw',
    isa => 'Str'
);

has fetcher => (
    is => 'ro',
    isa => 'Document::Fetcher',
    required => 1,
    lazy => 1,
    builder => '_build_fetcher',
    handles => [qw/do_something/]
);

sub _build_fetcher {
    my $self = shift;
    my @implementations = qw/ImplA ImplB/;

    foreach my $i (@implementations) {
        my $fetcher = "Document::Fetcher::$i"->new(url => $self->homepage);
        return $fetcher if $fetcher->responsible();
    }

    return Document::Fetcher->new(url => $self->homepage);
} 
```

现在这可以正常工作。如果我调用以下代码：

```
foreach my $i (qw/foo bar baz/) {
    my $doc = Document->new(name => $i, homepage => "http://$i.tld/");
    say $doc->name . ": " . $doc->do_something;
} 
```

我得到了预期的输出：

```
foo: called from implementation A
bar: called from implementation B
baz: called from default implementation 
```

但是这段代码至少有两个问题：

1.  我需要在`_build_fetcher`. 我更喜欢代码会自动从命名空间下的每个加载的模块/类中选择的方式`Document::Fetcher::`。或者也许有更好的方法来“注册”这些插件？

2.  目前整个代码看起来有点过于臃肿。我相信人们以前写过这种插件系统。[MooseX](https://metacpan.org/module/Moose%3a%3aManual%3a%3aMooseX)中没有提供所需行为的东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T00:47:18.833

您正在寻找的是[Factory](http://en.wikipedia.org/wiki/Factory_%28software_concept%29)，特别是[Abstract Factory](http://perldesignpatterns.com/?AbstractFactory)。Factory 类的构造函数将根据其参数确定要返回的实现。

```
# Returns Document::Fetcher::ImplA or Document::Fetcher::ImplB or ...
my $fetcher = Document::Fetcher::Factory->new( url => $url ); 
```

中的逻辑`_build_fetcher`将进入`Document::Fetcher::Factory->new`. 这会将 Fetchers 与您的文档分开。与 Document 知道如何确定它需要哪个 Fetcher 实现不同，Fetchers 可以自己完成。

如果您的首要任务是允许人们添加新的 Fetcher 而无需更改 Factory，那么您让 Fetcher 角色能够通知 Factory 是否能够处理它的基本模式是好的。不利的一面是，Fetcher::Factory 无法知道多个 Fe​​tcher 可能对给定的 URL 有效，并且一个可能比另一个更好。

为了避免在 Fetcher::Factory 中硬编码一大堆 Fetcher 实现，让每个 Fetcher 角色在加载时向 Fetcher::Factory 注册自己。

```
my %Registered_Classes;

sub register_class {
    my $class = shift;
    my $registeree = shift;

    $Registered_Classes{$registeree}++;

    return;
}

sub registered_classes {
    return \%Registered_Classes;
} 
```

如果你想要你的蛋糕并吃掉它，你可以有一些东西，可能是 Document，预加载一堆常见的 Fetchers。

# c# - 如何在没有 RowDataBound 的 GridView ItemTemplate 中找到 DropDownList？

> ID：10954834
> 
> 赞同：3
> 
> 时间：2012-06-08T19:17:17.167
> 
> 标签：c#, asp.net

我在 GridView 之外有一个 DropDownList，在 GridView 的 ItemTemplate 中有一个 DropDownList。外部的 DropDownList 有一个 SelectedIndex_Changed 事件，当该事件触发时，它应该填充 GridView 内的 DropDownList。问题是在我用来填充内部 DropDownList 的方法中，它找不到控件：这是在外部 DropDownList 更改时调用的示例代码：

```
 //Does not find ddlRoom
 DropDownList ddlRoom = (DropDownList)gv.TemplateControl.FindControl("ddlRoom");
    if (rows.Count() > 0)
    {

        var rooms = rows.CopyToDataTable();
        ddlRoom.Items.Clear();
        ddlRoom.Items.Add(new ListItem("Select...", "-1"));
        ddlRoom.DataSource = rooms;
        ddlRoom.DataBind();
    } 
```

我也试过：

```
DropDownList ddlRoom = (DropDownList)gv.FindControl("ddlRoom"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T19:24:45.437

您需要为每一行绑定下拉列表。尝试这样的事情

```
DropDownList ddlRoom = null;
foreach(var gridRow in gv.Rows)
{
    ddlRoom = gridRow.FindControl("ddlRoom") as DropDownList;
    if (ddlRoom != null)
    {
        //your code here
    }
} 
```

# android - android UI 上的每个小部件都是一个 View 对象？

> ID：10954836
> 
> 赞同：0
> 
> 时间：2012-06-08T19:17:20.100
> 
> 标签：android, user-interface, dialog, android-preferences, robotium

我在 SDk 上读到，View 代表用户界面组件的基本构建块。我想知道对话框或首选项是否也可以视为视图对象？我可以通过 Robotium 的 getCurrentViews() 方法获取当前活动的所有小部件吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:35:05.353

[此处](http://developer.android.com/reference/android/view/View.html)列出了每个直接和间接子类（“已知直接子类”和“已知间接子类”部分）

据此，您将获得所有视图的列表，例如 Buttons、ImageViews、ImageButtons 等

# javascript - 取消选中 Mozilla Refresh 上的复选框

> ID：10954839
> 
> 赞同：3
> 
> 时间：2012-06-08T19:17:35.250
> 
> 标签：javascript, jquery, html

我注意到 Mozilla 的刷新并没有将页面变为空白。我在加载/刷新页面时需要取消选中表单上的复选框。目前我正在使用这个：

```
<body onLoad="uncheck()">

function uncheck() {
    // Uncheck all checkboxes on page load    
    $("input:checkbox:checked").attr("checked", "");
    console.log("uncheck");
} 
```

这适用于完全加载页面，但如果我单击刷新（在 Mozilla 中），该函数会正确调用，因为“取消选中”正在打印到控制台，但复选框仍处于选中状态。

有什么想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T19:21:22.627

改用[道具](http://api.jquery.com/prop/)：

```
$(':checkbox:checked').prop('checked',false); 
```

或[removeAttr](http://api.jquery.com/removeAttr/)：

```
$(':checkbox:checked').removeAttr('checked'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:02:33.133

通过将 window onunload 设置为任何内容来禁用“页面缓存”-

```
window.onunload=function(){return true;}; 
```

# jquery - 单击jqgrid单元格时调用带有参数的函数

> ID：10954849
> 
> 赞同：1
> 
> 时间：2012-06-08T19:18:04.847
> 
> 标签：jquery, jqgrid

如果满足某些条件，我正在尝试使单元格着色且可单击。我遇到的问题是将参数传递给元素的 onclick。我正在做类似的事情：

```
{
    name: 'numberOfUnits',
    index: 'numberOfUnits',
    sorttype: 'integer',
    cellattr: function (rowId, tv, rawObject, cm, rdata) {
        if (...) {
            return 'style="background-color:red" onClick="javascript:showReceivedLockedPieChartDialog(' + '\'' + lockedCellId + '\'' + ')"';
        }
        else {
            return 'style="color:black"';
        }
    }
} 
```

我看到文本正在形成为：

```
style="background-color:red" onClick="javascript:showReceivedLockedPieChartDialog('ABC')" 
```

我看到它正在创造这样的东西......

```
<td aria-describedby="reportGrid_numberOfUnits" title="13" ABC")"="" onclick="javascript:showReceivedLockedPieChartDialog(" style="background-color:red" role="gridcell">13</td> 
```

请帮我将参数传递给这个函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T21:39:44.497

哦好！您的代码显示，从返回的字符串的分割`cellattr`将被解析得不够仔细。我发现最好重写将在内部使用的函数[formatCol 。](https://github.com/tonytomov/jqGrid/blob/v4.3.3/js/grid.base.js#L963-993)我想在下次发布 trirand 建议以使用`RegEx`匹配更改代码。

尽管如此，还是有一些简单的规则可以允许`cellattr`在当前实现中使用：

*   您应该使用`style`属性作为返回的字符串中的**最后一个属性**`cellattr`
*   如果您不仅返回属性`' '`的值，则应包含额外的空白作为返回值的第一个字符。`style`
*   你不应该使用 words `style`，`title`而`class`只能作为相应属性的名称。

最后一条规则意味着您不应该使用`class="mytitle"`or `title="my class style"`。返回字符串的解析就没有那么仔细了。所以这样的名字会有一些副作用。正如我之前写的那样，我认为应该更改解析结果的代码 jqGrid 的相应部分。下次我会尝试将相应的建议发布到trirand。

在您的情况下，您应该将代码重写`cellattr`为

```
cellattr: function (rowId, tv, rawObject, cm, rdata) {
    if (...) {
        return ' onclick="showReceivedLockedPieChartDialog(' + '\'' +
            lockedCellId + '\'' + ')" style="background-color:red"';
    } else {
        return 'style="color:black"';
    }
} 
```

[演示](http://www.ok-soft-gmbh.com/jqGrid/cellattrUsage.htm)显示更改有效。

# github - Github：来自标记的 Wiki 页面标题不是文件名/网络客户端

> ID：10954850
> 
> 赞同：13
> 
> 时间：2012-06-08T19:18:10.523
> 
> 标签：github, markdown, restructuredtext, gollum-wiki

github中有没有办法让wiki的标题基于标记？我发现另一个使用 Markdown 的项目，其 Home.md wiki 页面的标题来自该文件。作者也可以使用 Web 界面并将页面标题与 Markdown 相同。那个项目在这里：

[https://github.com/sitaramc/gitolite/wiki](https://github.com/sitaramc/gitolite/wiki)

当我尝试使用 ='s 的下划线对 restructuredtext (Home.rest) 做同样的事情时，标题最终被忽略，甚至没有显示在呈现的页面中。使用降价时也会发生同样的事情。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-23T22:36:02.490

查看几个月前的[这个拉取请求和相关讨论，页面标题似乎](https://github.com/gollum/gollum/issues/308)*过去*是基于降价设置的，但现在完全基于文件名。

这可以解释为什么一个项目可能有 RestructuredText/Markdown 似乎定义了标题（*它曾经做过！*），但同样对你不起作用。

这些天来，您似乎不走运通过 RestructuredText/MarkDown 文件定义 wiki 页面标题。

# facebook - facebook like 按钮未在第一次请求时显示

> ID：10954853
> 
> 赞同：0
> 
> 时间：2012-06-08T19:18:24.623
> 
> 标签：facebook, asp.net-mvc-3, jquery-mobile, facebook-like

我在 asp.net mvc3 中查看了产品列表，当用户单击产品时，用户会转到带有产品详细信息的另一个视图，问题是当页面完成加载时，facebook like 按钮没有显示。但是，如果我刷新页面，它就会显示，其中 google plus +1 按钮工作正常。帮助请。

```
<!DOCTYPE html>
<html>
    <head>
         <meta charset="utf-8" />
         <meta name="viewport" content="initial-scale=1.0, width=device-width, height=device-height,user-scalable=no" />
         <title>xxxxxxxx</title>
         <link href="/Content/Site.css" rel="stylesheet" type="text/css" />
         <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"> </script>
         <link href="/Content/JqueryContent/themes/base/jquery.ui.all.css" rel="stylesheet" type="text/css" />
         <script src="/Content/JqueryContent/jquery.ui.core.js.js" type="text/javascript"></script> 
         <script src="/Content/JqueryContent/jquery.ui.widget.js.js" type="text/javascript"></script>
         <script src="/Content/JqueryContent/jquery.ui.position.js" type="text/javascript"></script>
         <script src="/Content/JqueryContent/jquery.ui.autocomplete.js" type="text/javascript"></script>
         <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
         <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js" type="text/javascript"> </script>
    </head>
    <body>
    <div id="fb-root"></div>
    <script type="text/javascript">
            window.fbAsyncInit = function() {
              FB.init({
                appId      : 'xxxxxxxxxxxx',
                status     : true, 
                cookie     : true,
                xfbml      : true,
                oauth      : true,
              });
              FB.Event.subscribe('auth.statusChange', handleStatusChange);
            };

            (function(d){
               var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
               js = d.createElement('script'); js.id = id; js.async = true;
               js.src = "//connect.facebook.net/en_US/all.js";
               d.getElementsByTagName('head')[0].appendChild(js);
             }(document));
    </script>
    <header data-role="header" data-theme="a"><h3>xxxxx</h3></header>
    <div data-role="content">
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="true"></div>
    <style>.fb_edge_comment_widget {display: none !important; }</style> 
    <div class="g-plusone" data-size="medium"></div>
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>    
    </div>
    <footer data-role="footer" data-theme="a" style="font-family:Trebuchet MS;"><h5></h5></footer>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:43:14.497

您可能想要更新您的 FB sdk 片段。我刚刚检查了 Facebook Javascript SDK 页面，它是这样做的：

```
// Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document)); 
```

注意插入 js 的新方法，`insertBefore()`. 也许这会有所帮助。

干杯!

# php - 在 non_object 上调用成员函数 bind_param

> ID：10954856
> 
> 赞同：0
> 
> 时间：2012-06-08T19:18:39.390
> 
> 标签：php, mysql, database, mysqli

好的，在我开始之前，我只想说我已经阅读了该网站上与此问题有关的所有答案，但我仍然无法正确理解。我知道 PHP 抛出这个错误是因为 prepare 语句没有返回一个对象。我只是不知道为什么。这是我的代码：

```
$stmt = $this->db->prepare("INSERT INTO locations (type, time, street, city, state, country, age, admission, rsvp_limit, keyword1, keyword2, keyword3, description, latitude, longitude, date_posted, member_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, now(), '1')");
    var_dump($stmt);
    if (!$stmt->bind_param("sssssssiissssdd", $type, $date, $street, $city, $state, $country, $age, $admission, $rsvp, $keyword1, $keyword2, $keyword3, $description, $latitude, $longitude)) {
      throw new ErrorException($stmt->error, $stmt->errno);
    }
    $stmt->execute();

    $stmt->close(); 
```

以下是发送到此语句的回显值：

```
TYPE: Party DATE: 1969-12-31 19:12:00 STREET: 50 Barret Parkway CITY: Marietta STATE: Georgia COUNTRY: United States AGE: 25+ ADMISSION: 20 RSVP: 1000 KEYWORD1: key1test KEYWORD2: key2test KEYWORD3: key3test DESCRIPTION: Description test LATITUDE: 33.950500 LONGITUDE: -84.535900 
```

现在请记住，前一个字符串只是一个回显字符串，因此所有大写的单词实际上并没有发送到数据库，只是冒号后面的语句。我已经检查了 20 次数据库，所有的拼写对数据库中的行都是正确的，并且都有足够的空间和正确的类型。

在过去的 5 个小时里，我一直盯着这个问题，一边休息一边在网上搜索答案，然后我画了个空白。有谁知道怎么回事。如果有任何安慰，我可以手动手动将字段添加到数据库中，并使用 $_GET 变量检索它们就好了。

# c# - 每秒运行一次函数 Visual C#

> ID：10954859
> 
> 赞同：4
> 
> 时间：2012-06-08T19:19:02.023
> 
> 标签：c#, timer, draw

我的计时器有问题。我在函数中有函数（在函数中绘制）

```
void func(){

 /*...do something ... */
for(){
   for() {
  /*loop*/

 draw(A,B, Pen);

 }

/*... do something ...*/
  }
} 
```

这是绘图功能

```
 public void draw1(Point Poc, Point Kra, Pen o) {
      Graphics g = this.CreateGraphics();
      g.DrawLine(o,Poc.X+4, Poc.Y+4,Kra.X+4, Kra.Y+4);
      g.Dispose();
      } 
```

我在按钮单击时调用函数'func'

```
private void button4_Click(object sender, EventArgs e){

    func();

} 
```

我想每隔一秒调用一次绘图函数（每秒画一条线）。在绘图之间，函数需要继续工作并计算=循环，并绘制下一行一段时间（间隔）。我试过了

```
timer1.Tick += new EventHandler(timer1_Tick); 
```

ETC..

```
private void timer1_Tick(object sender, EventArgs e)
    {
        ...
        draw(A, B, Pen)
    } 
```

ETC..

但这一切都停止了我的功能，并随机画了一条线。我只想要函数'func'中两个绘图之间的时间（间隔）。没有计时器可以正常工作，但立即绘制所有线条，我需要缓慢绘制。干杯。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-08T19:26:32.110

我并不***完全***清楚您要做什么，但是，通常，您可以使用 Timer 类的对象来指定要在指定时间间隔内执行的代码。代码看起来像这样：

```
Timer myTimer = new Timer();
myTimer.Elapsed += new ElapsedEventHandler(DisplayTimeEvent);
myTimer.Interval = 1000; // 1000 ms is one second
myTimer.Start();

public static void DisplayTimeEvent(object source, ElapsedEventArgs e)
{
    // code here will run every second
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T19:30:18.317

试试这个

```
var aTimer = new System.Timers.Timer(1000);

aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

aTimer.Interval = 1000;
aTimer.Enabled = true;       

//if your code is not registers timer globally then uncomment following code

//GC.KeepAlive(aTimer);

private void OnTimedEvent(object source, ElapsedEventArgs e)
{
    draw(A, B, Pen);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T19:28:51.360

您不会在 WinForms 应用程序中*绘图*，而是响应更新或绘制消息。在表单的事件中执行您想要执行的操作`Paint`（或覆盖该`OnPaint`方法）。当您希望重新绘制表单时，请使用`Form.Invalidate`. 例如调用`Form.Invalidate`计时器滴答声...

* * *

## 回答 #4

> 赞同：-14
> 
> 时间：2012-06-09T15:32:21.373

现在解决了

```
System.Threading.Thread.Sleep(700); 
```

# .net - IDP 发起的实施能否成为符合 SAML 2.0 的技术？

> ID：10954865
> 
> 赞同：0
> 
> 时间：2012-06-08T19:19:34.250
> 
> 标签：.net, single-sign-on, saml

我是尝试学习 SAML SSO 的新手。我听说 IDP 发起的 SSO 实施不是符合 SAML 2.0 的标准。只有 SP 发起的 SSO 实施符合 SAML 2.0。请让我知道这是否属实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T20:59:28.993

这是错误的。IDP-Init 是 SAML 2.0 Web SSO 配置文件的一部分。您可以在第 4.1.5 节 SAML 2.0 配置文件文档中找到它——“未经请求的响应”。我相信未经请求的响应作为大多数主要联邦供应商过去参加的 SAML 2.0 一致性活动的一部分进行了测试。

# c# - 使链接从 window.open 弹出窗口中消失

> ID：10954868
> 
> 赞同：0
> 
> 时间：2012-06-08T19:19:51.630
> 
> 标签：c#, javascript, asp.net

我有打开一个窗口的链接，`window.open("mytest.aspx");`我遇到的问题是当他们关闭该弹出窗口时，我需要在父页面上隐藏该链接。所以基本上，如何从使用 window.open() 打开的弹出窗口中隐藏父页面上的链接（这是一个锚点）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:28:14.393

试试这个，链接的 JavaScript 代码 onclick 事件：

```
function OpenPopup()
{
  document.getElementById("linkID").style.visibility='hidden';
  window.open("mytest.aspx");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:24:03.320

我想念这个问题。您可以执行以下操作：

```
function Popup(){
  parentWindow = this;
  window.open('mytest.aspx');  
} 
```

在父窗口中有另一个功能：

```
function hideLink(){
  $("#linkID").hide()
} 
```

然后在弹出窗口之前调用以下函数：

```
parentWindow.hideLink(); 
```

我为之前的回答道歉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:34:47.947

我想你可能想看看这个类似的帖子 -[处理弹出关闭的正确方法](https://stackoverflow.com/questions/1853875/the-proper-way-to-handle-popup-closing)

OP 和接受的答案用于`setInterval`轮询弹出窗口。关闭后，执行“隐藏锚点”逻辑。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T19:46:42.920

您可以尝试使用 onunload 事件仅在窗口关闭时隐藏链接，“hr1”是您在打开页面上的链接 ID：

在您弹出的页面上

```
function CloseOpener(){ 
window.opener.document.getElementById('hr1').style.display='none'; 
} 
```

然后在同一个弹出页面上：

```
<body onunload="CloseOpener();"> </body> 
```

或者使用同一页面上的单独按钮来触发关闭：

```
 <input id="Button1" type="button" value="button" onclick="CloseOpener();"/> 
```

我已经对此进行了测试，它适用于我安装的浏览器，但在使用此事件时仍有一些注意事项，您可以在此处了解它：[onunload not working in Chrome and safari](https://stackoverflow.com/questions/6843565/onunload-not-working-in-chrome-and-safari)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T22:16:31.133

您也许可以尝试这样的事情：

```
var popup = window.open('mytest.aspx');
popup.onbeforeunload = function(){ 
   document.getElementById("theLink").style.visibility='hidden';   
} 
```

请注意，这假定弹出页面与父页面位于同一域中。

# regex - Groovy 删除多行注释

> ID：10954870
> 
> 赞同：2
> 
> 时间：2012-06-08T19:20:00.193
> 
> 标签：regex, groovy, comments, multiline, replaceall

如何使用 groovy 删除多行注释？

```
/* Use groovy replaceAll regex to 
   remove this comment */ 
```

我将上述文本从文件读入文件对象，然后将其转换为字符串。如果评论跨越一行，我可以使用 replaceAll 方法将其删除，如下所示：

```
def file = new File('myfile')
def fileString = file.getText()

println fileString.replaceAll('/\\* .* \\*/','') 
```

我曾尝试使用 (?m) 标志，但无法让它识别我的模式。我尝试了以下语句，但它们都与我的模式不匹配。

```
fileString.replaceAll('(?m)/\\* (.*) \\*/'    ,'')  #multiline switch
fileString.replaceAll('(/\\*)(.|\n\r)*(\\*/)' ,'')  #match all .* (include \n\r) 
```

我考虑过使用 DotAll、末尾的 (\s) 和 ${}。但是，我不确定如何有效地将它混合到正则表达式中。欢迎任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:30:39.563

试试这个表达式：

```
'(?s)/\\*.*?\\*/' 
```

`(?m)`不`.`匹配新行，`(?s)`这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:27:15.417

做类似的事情

```
/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/ 
```

为正则表达式工作？

（来自[http://ostermiller.org/findcomment.html](http://ostermiller.org/findcomment.html)）

# cqrs - 可以在事件溯源中创建大型事件吗？

> ID：10954877
> 
> 赞同：8
> 
> 时间：2012-06-08T19:20:30.087
> 
> 标签：cqrs, aggregateroot, event-sourcing

我们正在使用事件溯源并从事件流中构建聚合。我有 2 个聚合 - A1 和 A2。A1 用作模板以创建 A2。A1 的尺寸可能相当大。事件溯源的基本思想是确保对应用程序状态的每次更改都被捕获到事件对象中。所以要保存 A2，我们必须在第一个事件中存储大量信息。

这种情况是常见的还是从模板创建不是一个好主意？有没有更好的方法来解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T13:23:52.013

如果您发布更多关于聚合和事件的具体示例，将会更有帮助。一般来说，如果在您的情况下有意义，您可以创建更精细的事件。然后，命令和事件之间不是 1-1 关系，而是 1-N 关系，这完全符合 CQRS 理论。

所以给你举个例子：

```
CreateInvoice : Command
- InvoiceId
- Customer (10 fields)
- Address (5 more fields)
- InvoceLine[] (where each InvoiceLine also have 10 fields or so)
- Rest of 100 or so fields

InvoiceCreated : Event
- InvoiceId
- Customer (10 fields)
- Address (5 more fields)
- InvoceLine[] (where each InvoiceLine also have 10 fields or so)
- Total
- Rest of 100 or so fields 
```

在命令处理程序中：

```
void Handle(CreateInvoce cmd)
{
  var invoice = new Invoice(cmd.InvoiceId, cmd.Customer, cmd.Address, cmd.Lines ....)
  uow.Register(invoice);
} 
```

只会引发一个 InvoceCreated 事件。

相反，您可以拥有更精细的事件：

```
InvoiceCreated : Event
- InvoiceId
- Customer
- Address

InvoiceLineAdded
- InvoiceId
- Item
- Vat
- Subtotal
- Etc 
```

然后在命令处理程序中：

```
void Handle(CreateInvoce cmd)
{
  var invoice = new Invoice(cmd.InvoiceId, cmd.Customer, cmd.Address);

  foreach (var line in cmd.Lines)
  {
      invoice.AddLine(line.Item, line.Quantity, line.Price, ...);
  }

  uow.Register(invoice);
} 
```

这里 ctor 将引发 InvoiceCreated 事件，而 AddLine 方法将引发 InvoiceLineAdded 事件。然后，您可以拥有像 InvoiceLineChanged/InvoiceLineRemoved 这样的事件，您可以将其与更新一起使用。

这将允许您拥有更细粒度的事件，同时仍允许发出更粗粒度的命令。

当它们代表来自用户/系统 PoV 的原子操作时，大命令是可以的。

PS关于使用聚合作为模板，我不会为此烦恼，而是会创建数据结构作为累加器来收集中间状态。然后可以简单地对其进行序列化/反序列化。如果填充模板后没有任何行为 - 那么您根本不需要聚合。它只是一个数据块，稍后将用于创建聚合和运行业务规则。您可能正在使用这个“模板”对象来存储用户在多个请求之间输入的状态，比如会话状态，对吧;)？

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-25T02:22:48.920

我在这里有一个类似的问题：[域事件应该有多精细？](https://stackoverflow.com/questions/23833068/how-granular-should-a-domain-event-be/23850788#23850788)

通常一个巨大的类表明你必须检查它的职责并根据 SRP 将它分成更小的类。通过聚合、领域事件等......您可以采用相同的方法。通过太多的类，您可以考虑多个有界上下文，等等......

问题的另一部分，即命令和事件粒度是业务决策。如果你的大型活动对你的领域模型有意义，那么就使用它。否则，您（或领域专家）应该问自己，用户意图是什么，当前事件是否表达了它？只是一个非常简单的例子，你甚至可以有非常小的域事件：`PhoneNumberChanged`甚至更小的：`PhoneNumberCorrected`，`PhoneNumberMigrated`（它们都只包含一个属性，新的电话号码）。据此，您也可以举办大型活动。办公室。维护它们要困难得多，一段时间后您可能会开始对它们进行版本控制，或者将整个事件存储迁移到另一个域结构下。

*如果对问题一无所知，很难提供更多帮助。您可能应该告诉我们一些关于您在过去几年中发生的大型域事件的情况，您后来有问题吗？*

# version-control - 在源代码中查找符号依赖项

> ID：10954879
> 
> 赞同：2
> 
> 时间：2012-06-08T19:20:32.347
> 
> 标签：version-control

我今天遇到了一个错误，让我想知道检查源代码一致性的工具。首先，错误：

我的 jQuery 选择器是预期`.attached_reports`的，但 HTML 模板正在创建一个带有类的 div `attached-reports`。发生的事情是，我们热心的主题决定标准化所有类名以使用连字符而不是下划线，结果我们的代码中断了。

问题：是否有一种工具或方法可以解析源代码，并将每次出现的事件关联`attached-reports`在一起。那么，如果其中一个符号被更改（例如在版本控制提交时），它可以提醒团队更改吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:10:29.613

您想要的是跨语言一致性检查器，它可以静态检查运行时可能发生的错误。

为此，您需要一个可以处理所有相关语言的工具（您有两个：Javascript？[for Jquery] 具有对 HTML 模板的特殊引用，以及 HTML 模板语言（不完全是 HTML）。该工具有要知道 JavaScript 代码将使用名称引用模板（大概这只是一个字符串；你怎么知道模板名称不是由一些神秘的过程计算出来的？），并且 HTML 模板条目将被引用（如果有没有被引用的模板槽，可以吗？）

世界充满了有趣的小语言和它们之间和之间更有趣的约束（随着人们发明更多的 DSL 和集成规则，情况变得更糟）。您不太可能为每种组合找到现成的工具。

我们的[DMS 软件再造工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)旨在轻松接受新的语言描述或方言变体（因此您可以定义 HTML 模板变体）和自定义分析器（以便您可以检测违规行为）。[DMS 已经拥有一套稳定的传统和非传统[语言前端](http://www.semanticdesigns.com/Products/FrontEnds)，包括一个用于[JavaScript](http://www.semanticdesigns.com/Products/FrontEnds/ECMAScriptFrontEnd.html)的前端。DMS 在多个维度上是可扩展的；一个是它可以同时处理的语言数量......比如你的情况是“两种”。

DMS 使您能够对自定义分析器或转换器进行编码。当然，实施的任何分析都受可计算性约束；如果您的模板名称是由晦涩的 JavaScript 代码计算的，那么该工具不太可能确定该计算名称是否与模板中的某些内容匹配。

# ios - UIButton 上的左对齐图像和居中文本

> ID：10954880
> 
> 赞同：76
> 
> 时间：2012-06-08T19:20:35.093
> 
> 标签：ios, uiimage, uibutton

我看过关于右对齐的帖子，但我无法让左对齐工作。我希望按钮占据屏幕的宽度，左侧是图像，中间是标题/文本。

这不起作用（至少可靠）：

```
 button.titleLabel.textAlignment = UITextAlignmentCenter;
    [button setImageEdgeInsets:UIEdgeInsetsMake(0, -60.0, 0, 0)];
    button.frame = CGRectMake((self.view.frame.size.width - w ) / 2, self.view.frame.size.height - 140.0,  self.view.frame.size.width - 10.0, 40.0); 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2017-01-10T17:41:09.583

此解决方案适用于 Swift 3 并尊重原始内容和图像边缘插图，同时保持标题标签始终位于可用空间的中心，这使得调整边距变得更加容易。

它覆盖`titleRect(forContentRect:)`方法并返回正确的帧：

```
@IBDesignable
class LeftAlignedIconButton: UIButton {
    override func titleRect(forContentRect contentRect: CGRect) -> CGRect {
        let titleRect = super.titleRect(forContentRect: contentRect)
        let imageSize = currentImage?.size ?? .zero
        let availableWidth = contentRect.width - imageEdgeInsets.right - imageSize.width - titleRect.width
        return titleRect.offsetBy(dx: round(availableWidth / 2), dy: 0)
    }
} 
```

以下插图：

[![在此处输入图像描述](../Images/c73fe3d95439186eab5148ae7c36fe42.png)](https://i.stack.imgur.com/qNHkV.png)

会导致：

[![在此处输入图像描述](../Images/acd0f44a209db1b73a86d5033c2d6d84.png)](https://i.stack.imgur.com/VU3MB.png)

* * *

**已弃用先前的答案**

这在大多数情况下都有效，但某些布局会导致`layoutSubviews`在无限循环中递归调用自身，因此**请谨慎使用**。

```
@IBDesignable
class LeftAlignedIconButton: UIButton {
    override func layoutSubviews() {
        super.layoutSubviews()
        contentHorizontalAlignment = .left
        let availableSpace = UIEdgeInsetsInsetRect(bounds, contentEdgeInsets)
        let availableWidth = availableSpace.width - imageEdgeInsets.right - (imageView?.frame.width ?? 0) - (titleLabel?.frame.width ?? 0)
        titleEdgeInsets = UIEdgeInsets(top: 0, left: availableWidth / 2, bottom: 0, right: 0)
    }
} 
```

此代码将执行相同的操作，但将图标与右边缘对齐：

```
@IBDesignable
class RightAlignedIconButton: UIButton {
    override func layoutSubviews() {
        super.layoutSubviews()
        semanticContentAttribute = .forceRightToLeft
        contentHorizontalAlignment = .right
        let availableSpace = UIEdgeInsetsInsetRect(bounds, contentEdgeInsets)
        let availableWidth = availableSpace.width - imageEdgeInsets.left - (imageView?.frame.width ?? 0) - (titleLabel?.frame.width ?? 0)
        titleEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: availableWidth / 2)
    }
} 
```

[![在此处输入图像描述](../Images/79a700933377c6ecdb89ab1ca09d9cff.png)](https://i.stack.imgur.com/yWhjh.png)

使用正确的对齐版本`semanticContentAttribute`，因此它需要 iOS 9+。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-05-06T21:55:55.927

最后，我使用 UIEdgeInsetsMake 执行此操作，计算左角以使其居中。我不确定是否真的可以使文本居中对齐，但这对我有用。确保通过计算宽度将左角设置为所需位置。例如 `UIEdgeInsetsMake(0.0f, 42.0f, 0.0f, 0.0f)`

```
UIButton *scanBarCodeButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
scanBarCodeButton.frame = CGRectMake(center, 10.0f, fieldWidth, 40.0f);
[scanBarCodeButton setImage:[UIImage imageNamed:@"BarCodeIcon.png"] forState:UIControlStateNormal];
[scanBarCodeButton setTitle:@"Scan the Barcode" forState:UIControlStateNormal];
scanBarCodeButton.titleEdgeInsets = UIEdgeInsetsMake(0.0f, 42.0f, 0.0f, 0.0f);
[scanBarCodeButton setContentHorizontalAlignment:UIControlContentHorizontalAlignmentLeft];
[scanBarCodeButton addTarget:self action:@selector(scanBarCode:) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:scanBarCodeButton]; 
```

输出看起来像，

[![带有图像的居中文本](../Images/6f821e7a107e080ffdaae2bd4d0132c8.png)](https://i.stack.imgur.com/5HRA8.png)

在**斯威夫特**：

```
var scanBarCodeButton: UIButton = UIButton(type: .roundedRect)
scanBarCodeButton.frame = CGRectMake(center, 10.0, fieldWidth, 40.0)
scanBarCodeButton.setImage(UIImage(named: "BarCodeIcon.png"), for: UIControlStateNormal)
scanBarCodeButton.setTitle("Scan the Barcode", for: UIControlStateNormal)
scanBarCodeButton.titleEdgeInsets = UIEdgeInsetsMake(0.0, 42.0, 0.0, 0.0)
scanBarCodeButton.contentHorizontalAlignment = .left
scanBarCodeButton.addTarget(self, action: "scanBarCode:", for: UIControlEventTouchUpInside)
self.view.addSubview(scanBarCodeButton) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-05-02T04:32:54.810

对于 Swift 4.0，这是一个有效的扩展 -

```
extension UIButton {

  func leftImage(image: UIImage, renderMode: UIImage.RenderingMode) {
       self.setImage(image.withRenderingMode(renderMode), for: .normal)
       self.imageEdgeInsets = UIEdgeInsets(top: 0, left: 10, bottom: 0, right: 0)
       self.titleEdgeInsets.left = (self.frame.width/2) - (self.titleLabel?.frame.width ?? 0)
       self.contentHorizontalAlignment = .left
       self.imageView?.contentMode = .scaleAspectFit
   }

    func rightImage(image: UIImage, renderMode: UIImageRenderingMode){
        self.setImage(image.withRenderingMode(renderMode), for: .normal)
        self.imageEdgeInsets = UIEdgeInsets(top: 0, left:image.size.width / 2, bottom: 0, right: 0)
        self.contentHorizontalAlignment = .right
        self.imageView?.contentMode = .scaleAspectFit
    }
} 
```

用法：

```
myButton.rightImage(image: UIImage(named: "image_name")!, renderMode: .alwaysOriginal)
myButton.leftImage(image: UIImage(named: "image_name")!, renderMode: .alwaysOriginal) 
```

`renderMode`可以是`.alwaysTemplate`或`.alwaysOriginal`。另外，`myButton`应该是`custom`type `UIButton`。

这个扩展的`leftImage`and`rightImage`也可以`UIButton`在`UIBarButtonItem`for中使用`UINavigationBar`（注意：从 iOS 11 开始，导航栏遵循自动布局，因此您需要在 中添加宽度/高度约束`UIBarButtonItem`）。要在导航栏上使用，请确保遵循 Apple 推荐的 @2x 和 @3x 图像尺寸（即 50x50、75x75）并在 iPhone 6、7、8、6s、7s、8s、Plus 变体和 iPhone 上获得更好的可访问性x 的宽度和高度`UIBarButton`可以是高度 - 25 和宽度 - 55（或者无论您的应用程序需要什么，这些数字都是一些基本数字，应该适用于大多数情况）。

* * *

**更新**：在 Swift 4.2 中，`UIImageRenderingMode`已重命名为`UIImage.RenderingMode`

```
extension UIButton {
    func leftImage(image: UIImage, renderMode: UIImage.RenderingMode) {
        self.setImage(image.withRenderingMode(renderMode), for: .normal)
        self.imageEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: image.size.width / 2)
        self.contentHorizontalAlignment = .left
        self.imageView?.contentMode = .scaleAspectFit
    }

    func rightImage(image: UIImage, renderMode: UIImage.RenderingMode){
        self.setImage(image.withRenderingMode(renderMode), for: .normal)
        self.imageEdgeInsets = UIEdgeInsets(top: 0, left:image.size.width / 2, bottom: 0, right: 0)
        self.contentHorizontalAlignment = .right
        self.imageView?.contentMode = .scaleAspectFit
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-03-26T19:25:42.037

我已经尝试了上面几乎所有的解决方案，但都没有像我预期的那样工作（我有两个按钮，每个按钮都有不同的标题和不同的图像宽度）。所以我为 UIButton 编写了我自己的扩展，它可以完美地适用于不同的图像宽度以及不同的标题。

```
extension UIButton {
    func moveImageLeftTextCenter(imagePadding: CGFloat = 30.0, titlePadding: CGFloat = 0.0, minImageTitleDistance: CGFloat = 10.0){
    guard let imageViewWidth = imageView?.frame.width else{return}
    guard let titleLabelWidth = titleLabel?.intrinsicContentSize.width else{return}
    contentHorizontalAlignment = .left

    let imageLeftInset = imagePadding - imageViewWidth / 2
    var titleLeftInset = (bounds.width - titleLabelWidth) / 2 - imageViewWidth + titlePadding

    if titleLeftInset - imageLeftInset < minImageTitleDistance{
        titleLeftInset = imageLeftInset + minImageTitleDistance
    }

    imageEdgeInsets = UIEdgeInsets(top: 0.0, left: imageLeftInset, bottom: 0.0, right: 0.0)
    titleEdgeInsets = UIEdgeInsets(top: 0.0, left: titleLeftInset, bottom: 0.0, right: 0.0)
    }
} 
```

用法：`myButton.moveImageLeftTextCenter()`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-09-13T10:04:15.000

正如我认为的那样，好的解决方案必须对任何文本都有用，没有硬编码的插入值（这是关于 toytoy 提供的解决方案）。我使用与此类似的代码：

```
NSString *sometitle = @"blabla button title";
NSString *someimage = @"blablaimage";
UIImage *image = [[UIImage imageNamed:someimage];
int buttonWidth = A;
int buttonHeight = B;
int imageWidth =image.size.width;
int imageHeight = image.size.height;
int titleWidth = buttonWidth - imageWidth;

// create button and set image and title
buttonView = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, buttonWidth, buttonHeight)];
[buttonView setImage:image forState:UIControlStateNormal];
[buttonView setTitle:sometitle forState:UIControlStateNormal];

// make button all content to be left aligned
[buttonView setContentHorizontalAlignment:UIControlContentHorizontalAlignmentLeft];

// set title font 
[buttonView.titleLabel setFont:[UIFont fontWithName:@"HelveticaNeue" size:14]];

// calculate font text width with selected font
CGSize stringBoundingBox = [number sizeWithFont:[buttonView.titleLabel font]];

// make title inset with some value from left 
// it place the title right on the center of space for the title
int titleLeft = (titleWidth - stringBoundingBox.width) / 2;
[buttonView setTitleEdgeInsets:UIEdgeInsetsMake(0, titleLeft, 0, 0)]; 
```

在带有 stringBoundingBox init 的字符串之后，我还添加了一些这样的字符串：

```
if (stringBoundingBox.width > titleWidth)
{
    [_backgroundView.titleLabel setFont:[UIFont fontWithName:@"HelveticaNeue" size:13]];
    stringBoundingBox = [number sizeWithFont:[_backgroundView.titleLabel font]];
}
if (stringBoundingBox.width > titleWidth)
{
    [_backgroundView.titleLabel setFont:[UIFont fontWithName:@"HelveticaNeue" size:12]];
    stringBoundingBox = [number sizeWithFont:[_backgroundView.titleLabel font]];
} 
```

它允许我通过选择一些较小的字体来设置比可用空间更长的标题。我这样做是因为另一种方式：

```
[buttonView.titleLabel setAdjustsFontSizeToFitWidth:YES]; 
```

效果不是很好，看起来它会将字体大小一步缩小 3-4 点，所以一些不太长的线条变得太小了，比它必须的要小。

此代码允许我们将按钮标题空间中的任何文本准确地放在中心。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-07-08T12:22:01.553

```
[self.button setImage:[UIImage imageNamed:@"image.png"] forState:UIControlStateNormal];

[self.button setTitleEdgeInsets:UIEdgeInsetsMake(0.0, self.button.center.x/2 , 0.0, 0.0)];

[self.button setContentHorizontalAlignment:UIControlContentHorizontalAlignmentLeft]; 
```

让我知道它是否不起作用。

> 我的输出[![在此处输入图像描述](../Images/106d96d22d05877c7c05e646d004bd7d.png)](https://i.stack.imgur.com/LrTzT.png)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-06-09T15:12:32.277

我写了一个 UIButton 扩展。

```
extension UIButton {

  /// Add image on left view
  func leftImage(image: UIImage) {
    self.setImage(image, for: .normal)
    self.imageEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: image.size.width)
  }
} 
```

你可以这样使用：

```
yourButton.leftImage(image: yourImage) 
```

瞧！

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-06-29T03:04:16.747

创建您的按钮并将文本对齐设置为居中，然后添加：

```
UIImage *image = [UIImage imageNamed:@"..."];
CGSize imageSize = image.size;
CGFloat offsetY = floor((self.layer.bounds.size.height - imageSize.height) / 2.0);

CALayer *imageLayer = [CALayer layer];
imageLayer.contents = (__bridge id) image.CGImage;
imageLayer.contentsGravity = kCAGravityBottom;
imageLayer.contentsScale = [UIScreen mainScreen].scale;
imageLayer.frame = CGRectMake(offsetY, offsetY, imageSize.width, imageSize.height);
[self.layer addSublayer:imageLayer]; 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-06-07T10:30:17.213

没有运气尝试了大多数答案。我大部分时间都得到蓝色图像，或者标题不在中心。使用了一些答案中的代码并编写了这个扩展，就像一个魅力。

斯威夫特 4.2：

```
import UIKit

extension UIButton {
    func moveImageLeftTextCenter(image : UIImage, imagePadding: CGFloat, renderingMode: UIImage.RenderingMode){
        self.setImage(image.withRenderingMode(renderingMode), for: .normal)
        guard let imageViewWidth = self.imageView?.frame.width else{return}
        guard let titleLabelWidth = self.titleLabel?.intrinsicContentSize.width else{return}
        self.contentHorizontalAlignment = .left
        let imageLeft = imagePadding - imageViewWidth / 2
        let titleLeft = (bounds.width - titleLabelWidth) / 2 - imageViewWidth
        imageEdgeInsets = UIEdgeInsets(top: 0.0, left: imageLeft, bottom: 0.0, right: 0.0)
        titleEdgeInsets = UIEdgeInsets(top: 0.0, left: titleLeft , bottom: 0.0, right: 0.0)
    }
} 
```

希望对一些人有所帮助！

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-09-25T09:39:35.430

这对我来说很好，对于几个按钮，具有不同的图像宽度和不同的标题长度：

子类`UIButton`，并添加以下方法：

```
override func layoutSubviews() {
    super.layoutSubviews()

    if let image = imageView?.image {

        let margin = 30 - image.size.width / 2
        let titleRect = titleRectForContentRect(bounds)
        let titleOffset = (bounds.width - titleRect.width - image.size.width - margin) / 2

        contentHorizontalAlignment = UIControlContentHorizontalAlignment.Left
            imageEdgeInsets = UIEdgeInsetsMake(0, margin, 0, 0)
            titleEdgeInsets = UIEdgeInsetsMake(0, (bounds.width - titleRect.width -  image.size.width - margin) / 2, 0, 0)
    }

} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-05-11T10:38:44.657

我用 swift 写了一个 UIButton 扩展 -

```
extension UIButton {

func setLeftImage(imageName:String, padding:CGFloat) {
        //Set left image
        let image = UIImage(named: imageName)
        self.setImage(image, forState: .Normal)

        //Calculate and set image inset to keep it left aligned
        let imageWidth = image?.size.width
        let textWidth = self.titleLabel?.intrinsicContentSize().width
        let buttonWidth = CGRectGetWidth(self.bounds)

        let padding:CGFloat = 30.0
        let rightInset = buttonWidth - imageWidth!  - textWidth! - padding

        self.imageEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: rightInset)
    }
} 
```

我会以任何我想要的方式设置我的按钮文本，使其保持居中对齐。然后我会在我的按钮上调用这个方法，比如 -

```
myButton.setLeftImage("image_name", 30.0) 
```

这将导致我的图像与左边框的一些填充对齐。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-01-17T10:22:57.423

1)`button.frame = self.view.bounds;`

2）`setImageEdgeInsets`负值，当你的按钮填满屏幕时，是疯狂的。重新考虑你想在这里做什么？

3)`UITextAlignmentCenter`现在是`NSTextAlignmentCenter`

4)`button.contentHorizontalAlignment = UIControlContentHorizontalAlignmentLeft;`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-05-08T22:38:59.787

我在这里看到了很多专注于将图标设置在左侧的解决方案。我认为添加 UIImageView、将按钮的左侧与图像对齐并将它们居中对齐会更容易。然后你可以使用偏移量来让它看起来不错。

无需代码，全部在 Interface Builder 中。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-04-30T14:13:08.960

我的**SWIFT 5.2**解决方案。

您必须继承 UIButton 类。无需像其他人在其他答案中所做的那样更改内容水平对齐方式，将其保持为“中心”（.center）。标题将自动居中，而 imageRect() 的覆盖将为图像解决问题。

您要做的第一件事是将 CustomButton 类分配给情节提要的 Identity Inspector 部分中的按钮。然后，您可以在 Attribute Inspector 部分将“alignImageToLeft”切换为 ON 或 OFF（默认为 OFF）。

```
class CustomButton : UIButton {

    @IBInspectable var alignImageToLeft : Bool = false

    override func imageRect(forContentRect contentRect: CGRect) -> CGRect {
        if(alignImageToLeft){
            let imageRect = super.imageRect(forContentRect: contentRect)
            let offset = contentRect.minX - imageRect.minX
            return imageRect.offsetBy(dx: offset, dy: 0.0)
        }
        return super.imageRect(forContentRect: contentRect)
    }
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-05-01T15:50:16.237

我知道这个答案有点晚了。但是对于想要使用 UIImageView 在带有居中文本的 UIButton 左侧添加图像的人们，我有一个非常简单的解决方案。全部以编程方式

```
class RandomVC: UIViewController{

    var imageDemo: UIImageView = {
    let img = UIImageView()
    img.translatesAutoresizingMaskIntoConstraints = false
    img.image = UIImage(named: "someImgFromAssets")
    return img
    }()

    lazy var someButton: UIButton = { //lazy var: so button can have access to self class
    let button = UIButton(type: .system)
    button.setTitle("This is your title", for: UIControlState.normal)
    button.translatesAutoresizingMaskIntoConstraints = false 
    button.setTitleColor(UIColor.white, for: UIControlState.normal)
    button.addTarget(self, action: #selector(handleButtonClick), for: .touchUpInside) //make sure you write function "handleButtonClick" inside your class
    button.titleLabel?.textAlignment = .center
    return button
    }()

    override func viewDidLoad() {
        super.viewDidLoad()
        view.addSubView(someButton)
        someButton.addSubview(imageDemo)
        imageDemo.centerYAnchor.constraint(equalTo: someButton.centerYAnchor).isActive = true
        imageDemo.leftAnchor.constraint(equalTo: someButton.leftAnchor, constant: 10).isActive = true
        imageDemo.heightAnchor.constraint(equalToConstant: 25).isActive = true
        imageDemo.widthAnchor.constraint(equalToConstant: 25).isActive = true
    }

} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-01-31T20:22:07.790

以下扩展适用于 Swift 4.2

```
func leftImage(image: UIImage, padding: CGFloat, renderMode: UIImage.RenderingMode) {
    self.setImage(image.withRenderingMode(renderMode), for: .normal)
    contentHorizontalAlignment = .left
    let availableSpace = bounds.inset(by: contentEdgeInsets)
    let availableWidth = availableSpace.width - imageEdgeInsets.right - (imageView?.frame.width ?? 0) - (titleLabel?.frame.width ?? 0)
    titleEdgeInsets = UIEdgeInsets(top: 0, left: availableWidth / 2, bottom: 0, right: 0)
    imageEdgeInsets = UIEdgeInsets(top: 0, left: padding, bottom: 0, right: 0)
}

func rightImage(image: UIImage, padding: CGFloat, renderMode: UIImage.RenderingMode){
    self.setImage(image.withRenderingMode(renderMode), for: .normal)
    semanticContentAttribute = .forceRightToLeft
    contentHorizontalAlignment = .right
    let availableSpace = bounds.inset(by: contentEdgeInsets)
    let availableWidth = availableSpace.width - imageEdgeInsets.left - (imageView?.frame.width ?? 0) - (titleLabel?.frame.width ?? 0)
    titleEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: availableWidth / 2)
    imageEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: padding)
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-06-05T19:51:31.247

可以使用扩展来应用此解决方案。不需要子类化。

警告：每次更新文本/图像时都必须调用它。

```
let width = frame.width
guard let imageWidth = imageView?.frame.width, let labelWidth = titleLabel?.frame.width else {
      return
}
titleEdgeInsets = UIEdgeInsets(top: 0, left: (width - labelWidth)/2.0 - imageWidth, bottom: 0, right: 0) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-10-16T08:42:31.940

您可能会忘记 UIEdgeInsets 并简单地覆盖 UIButton 子类中 layoutSubviews() 中的框架。

要使 titleLable 居中，只需通过 super.bounds.midX 和 titleLabel.frame.midX 之间的差异将水平偏移量添加到 titleLabel 框架

```
 override func layoutSubviews() {
       super.layoutSubviews()

       if let label = titleLabel {
           label.frame = label.frame.offsetBy(dx: super.bounds.midX - 
                label.frame.midX , dy: 0)
       }

       // Available space to the left of the titleLabel is simply:
       let leftAvailableWidth = label.frame.minX

       imageView?.frame = CGRect(x: 0, y: 0, width: <Some width smaller than leftAvailableWidth>, height: super.bound.height)
   } 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-02-15T17:36:19.480

一个技巧是：

1.  覆盖`titleRectForContentRect`以使按钮的`titleLabel`'`frame`等于按钮的边界
2.  将`titleLabel`'s设置`textAlignment`为`.Center`
3.  覆盖`imageRectForContentRect`以指定`origin.x`按钮的`imageView`

    ```
    import UIKit

    class ButtonWithLeftAlignedImageAndCenteredText: UIButton {

        override init(frame: CGRect) {
            super.init(frame: frame)

            titleLabel?.textAlignment = .Center
        }

        override func imageRectForContentRect(contentRect: CGRect) -> CGRect {
            var imageFrame = super.imageRectForContentRect(contentRect)
            imageFrame.origin.x = 20 //offset from left edge
            return imageFrame
        }

        override func titleRectForContentRect(contentRect:CGRect) -> CGRect {
            var titleFrame = super.titleRectForContentRect(contentRect)
            titleFrame = self.bounds
            return titleFrame
        }

        required init?(coder aDecoder: NSCoder) {
            fatalError("init(coder:) has not been implemented")
        }
    } 
    ```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-05-02T09:34:10.117

您可以使用以下代码在 UIButton 上左对齐图像：-

步骤1：

```
//create your UIButton
UIButton *post_bNeeds_BTN= [UIButton buttonWithType:UIButtonTypeRoundedRect];
post_bNeeds_BTN.frame= CGRectMake(160 ,5 ,150 ,40);
[post_bNeeds_BTN addTarget:self action:@selector(post_Buying_Needs_BTN_Pressed:) forControlEvents:UIControlEventTouchUpInside];
[post_bNeeds_BTN setBackgroundColor:[UIColor colorWithRed:243/255.0 green:131/255.0 blue:26/255.0 alpha:1.0f]];//230
[self.view addSubview:post_bNeeds_BTN];
post_bNeeds_BTN.autoresizingMask= UIViewAutoresizingFlexibleWidth; 
```

第2步：

```
//Add UIImageView on right side the button
UIImageView *bNeedsIVw= [[UIImageView alloc] initWithFrame:CGRectMake(5,5,30,30)];
bNeedsIVw.image= [UIImage imageNamed:@"postRequir_30.png"];
bNeedsIVw.image= [bNeedsIVw.image imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate];
bNeedsIVw.tintColor= [UIColor whiteColor];
[post_bNeeds_BTN addSubview:bNeedsIVw]; 
```

第 3 步：

```
//also set UILable on UIButton
UILabel *bNeedsLbl= [[UILabel alloc] initWithFrame:CGRectMake(40 ,0 ,post_Prod_BTN.frame.size.width-40 ,post_Prod_BTN.frame.size.height)];
bNeedsLbl.text= @"Requirements";
bNeedsLbl.font= [UIFont systemFontOfSize:16];
bNeedsLbl.textColor= [UIColor whiteColor];
bNeedsLbl.textAlignment= NSTextAlignmentLeft;
[post_bNeeds_BTN addSubview:bNeedsLbl]; 
```

第4步：

```
-(void)post_Buying_Needs_BTN_Pressed:(id)sender{
    //write your code action here,,
} 
```

谢谢，

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-10-02T15:24:22.107

此代码使您的按钮图像左对齐，并且标题标签移动到按钮的中心。b是按钮:)

```
b.contentHorizontalAlignment = .Left
let left = (b.frameWidth() - b.titleLabel!.frameWidth()) / 2 - CGRectGetMaxX(b.imageView!.frame)
b.titleEdgeInsets = UIEdgeInsetsMake(0, left, 0, 0) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2022-02-09T14:43:57.327

@trishcode 答案对我有用。我只是将它与 UIButton 的扩展一起使用。

这是代码：

```
extension UIButton {
func centerImageLeft(padding: CGFloat = 30.0){
    let buttonWidth = self.frame.width
    let textWidth = self.titleLabel?.intrinsicContentSize.width ?? 0
    let imageViewWidth = self.imageView?.frame.size.width ?? 0
    let offsetToLeftButtonEdge = buttonWidth - textWidth - imageViewWidth
    let offset = offsetToLeftButtonEdge - padding
    self.imageEdgeInsets = UIEdgeInsets(top: 0.0, left: 0, bottom: 0.0, right: offset)
}
} 
```

然后你可以在 viewDidAppear 方法中这样调用它：

```
button.centerImageLeft() 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-07-20T07:07:44.903

斯威夫特版本：

```
var button = UIButton()

newGameButton.setTitle("Новая игра", for: .normal)
newGameButton.setImage(UIImage(named: "energi"), for: .normal)
newGameButton.backgroundColor = .blue
newGameButton.imageEdgeInsets.left = -50 
```

[![在此处输入图像描述](../Images/53a03450e3b3ee26f3ef68866416109a.png)](https://i.stack.imgur.com/rwS5k.png)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-10-21T20:05:22.763

这适用于我的不同按钮文本大小。

准确的按钮文本宽度的关键是获取intrinsicContentSize。由于我对按钮宽度使用自动布局，因此我必须从 viewDidAppear 而不是 viewDidLoad 运行此代码，以便已经绘制按钮，因此按钮框架大小将是准确的。

```
private func calculateAccountButtonImageViewOffset(button: UIButton, padding: CGFloat = 30.0) -> CGFloat {
    let buttonWidth = button.frame.width
    let textWidth = button.titleLabel?.intrinsicContentSize.width ?? 0
    let imageViewWidth = button.imageView?.frame.size.width ?? 0
    let offsetToLeftButtonEdge = buttonWidth - textWidth - imageViewWidth
    return offsetToLeftButtonEdge - padding
} 
```

用法：

```
let imageViewOffset = calculateAccountButtonImageViewOffset(button: button)
button.imageEdgeInsets = UIEdgeInsets(top: 0.0, left: 0, bottom: 0.0, right: imageViewOffset) 
```

按钮标题可以根据需要使用 IB 上的 Title Insets 进行偏移： [![在此处输入图像描述](../Images/b0de11d9ab94fa985cfac3525e8042af.png)](https://i.stack.imgur.com/w4ZQM.png)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-01-23T09:03:47.913

**Swift 5：** 您可以通过使用 UIButton 的自定义类来实现这一点。

```
class CustomButton: UIButton {

    var imageV = UIImageView()
    var titleV = UILabel()

    override func awakeFromNib() {

        self.imageView?.isHidden = true
        self.titleLabel?.isHidden = true

        imageV.frame = CGRect(x: 0, y: 0, width: 40, height: self.bounds.height)
        imageV.contentMode = .scaleAspectFit

        titleV.frame = CGRect(x: 40, y: 0, width: self.bounds.width - 40, height: self.bounds.height)
        titleV.font = self.titleLabel?.font
        titleV.textAlignment = .center

        self.addSubview(imageV)
        self.addSubview(titleV)

        imageV.image = self.imageView?.image; titleV.text = self.titleLabel?.text

        imageV.translatesAutoresizingMaskIntoConstraints = false
        imageV.topAnchor.constraint(equalTo: self.topAnchor, constant: 0).isActive = true
        imageV.bottomAnchor.constraint(equalTo: self.bottomAnchor, constant: 0).isActive = true
        imageV.leadingAnchor.constraint(equalTo: self.leadingAnchor, constant: 0).isActive = true
        imageV.trailingAnchor.constraint(equalTo: titleV.leadingAnchor, constant: 0).isActive = true
        imageV.widthAnchor.constraint(equalToConstant: 40).isActive = true

        titleV.translatesAutoresizingMaskIntoConstraints = false
        titleV.topAnchor.constraint(equalTo: self.topAnchor).isActive = true
        titleV.bottomAnchor.constraint(equalTo: self.bottomAnchor).isActive = true
        titleV.trailingAnchor.constraint(equalTo: self.trailingAnchor, constant: 0).isActive = true
    }
} 
```

稍后您可以像这样设置图像和文本。

```
button.imageV.image = myImage
button.titleV.text = myText 
```

**结果**

[![在此处输入图像描述](../Images/dd12b89d4d994fcf835660d07f3f9275.png)](https://i.stack.imgur.com/ejcAE.png)

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2012-06-08T19:22:02.407

最好创建一个自定义 UIButton 子类以更好地解决此问题。Apple 可能正在“重置”您的设置。

# hadoop - 将 PIG 中 UNION 的结果存储在单个文件中

> ID：10954883
> 
> 赞同：8
> 
> 时间：2012-06-08T19:20:50.337
> 
> 标签：hadoop, apache-pig, hdfs

我有一个 PIG 脚本，它产生四个结果，我想将它们全部存储在一个文件中。我尝试使用`UNION`，但是当我使用时，`UNION`我得到了四个文件 part-m-00000、part-m-00001、part-m-00002、part-m-00003。我不能得到一个文件吗？

这是 PIG 脚本

```
A = UNION Message_1,Message_2,Message_3,Message_4 into 'AA'; 
```

在 AA 文件夹中，我得到了上面提到的 4 个文件。我不能得到一个包含所有条目的文件吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-09T13:26:55.757

Pig 在这里做的是正确的事情，并且正在合并数据集。全部是一个文件并不意味着Hadoop中的一个数据集...... Hadoop中的一个数据集通常是一个文件夹。因为它不需要在这里运行reduce，所以它不会。

你需要欺骗 Pig 来运行 Map AND Reduce。我通常这样做的方式是：

```
set default_parallel 1

...
A = UNION Message_1,Message_2,Message_3,Message_4;
B = GROUP A BY 1; -- group ALL of the records together
C = FOREACH B GENERATE FLATTEN(A);
... 
```

将`GROUP BY`所有记录组合在一起，然后将该`FLATTEN`列表分解出来。

* * *

这里要注意的一件事是，这与执行以下操作没有太大区别：

```
$ hadoop fs -cat msg1.txt msg2.txt msg3.txt msg4.txt | hadoop fs -put - union.txt 
```

（这是连接所有文本，然后将其作为新文件写回 HDFS）

这根本不是并行的，但也不是通过一个 reducer 汇集所有数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T22:27:35.680

您是否尝试过设置 default_parallel 属性？

```
grunt> set default_parallel 1
grunt> A = UNION Message_1,Message_2,Message_3,Message_4; 
```

# php - PHP 搜索数组行

> ID：10954884
> 
> 赞同：0
> 
> 时间：2012-06-08T19:20:52.050
> 
> 标签：php, search, scripting

> **可能重复：**
> [PHP 搜索和回显特定文本](https://stackoverflow.com/questions/10954439/php-search-and-echo-specific-text)

我有问题。我想要做的是让我的 PHP 代码进行搜索，直到找到输入的内容。例如，如果我搜索数字“12”。我希望它进入像下面这样的文件中，并找到其中包含“12”的行。

```
Dark Green = 11 = No = 20,
Light Blue = 12 = No = 20,
Lime Green = 13 = No = 20,
Sensei Gray = 14 = Yes = 0, 
```

找到该行后，我希望我的代码回显其中包含“12”的行。所以这会出现：

```
Light Blue = 12 = No = 20, 
```

请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:24:04.977

使用[file](http://php.net/file)从文件中读取所有行：

```
$lines = file('file.txt'); 
```

[遍历所有行并使用strpos](http://php.net/strpos)搜索子字符串：

```
$search = 12;
foreach($lines as $line) {
    if(strpos($line, $search) !== false) {
        printf('Found %s in %s', $search, $line);
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:28:59.590

你可以使用这个：（假设 file.txt 保存你的信息）

```
$num = 12;
$data = file("file.txt");
foreach((array)$data as $key=>$line) {
   if (strstr($line,"= $num ") || strstr($line," = $num,")) {
      echo $line;
      break;
   }
} 
```

# python - “警告：列的值超出范围”将日期时间值插入 MySQL

> ID：10954885
> 
> 赞同：3
> 
> 时间：2012-06-08T19:21:07.840
> 
> 标签：python, mysql, mysql-python

使用 Python 和 Mysqldb 库从 MongoDB 中提取一些数据并将其插入 MySQL 数据库。

```
+-------------------+------------+------+-----+---------+----------------+
| Field             | Type       | Null | Key | Default | Extra          |
+-------------------+------------+------+-----+---------+----------------+
| id                | int(16)    | NO   | PRI | NULL    | auto_increment |
| subject           | tinytext   | NO   |     | NULL    |                |
| created_at        | datetime   | NO   |     | NULL    |                |
+-------------------+------------+------+-----+---------+----------------+ 
```

* * *

```
created_at  = "2012/06/08 11:47:40 -0700"
sql1 = ("INSERT INTO `items` (`description`, `created_at`) VALUES (%s, %s)", (description, created_at)
try:
    cursor.execute(*sql1)
except MySQLdb.Error, e:
    print "Error %s: %s" % (e.args[0], e.args[1]) 
```

* * *

对于第一次插入数据库，我收到一个警告，但是我没有收到后续插入的警告。

> conf/db_tools-import.py:53：警告：第 1 行 cursor.execute(*sql1) 列“created_at”的值超出范围

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T20:50:59.520

您收到警告是因为您在日期字段中插入了一个长日期。提交的日期是“YYYY-MM-DD”（http://dev.mysql.com/doc/refman/5.1/en/datetime.html）。

我在Mysql中做了自己的测试，看看：

```
mysql> create table bigtable (created_at date);
Query OK, 0 rows affected (0.07 sec)

mysql> 

Query OK, 1 row affected, 1 warning (0.00 sec)

mysql> show warnings;
+---------+------+-------------------------------------------------+
| Level   | Code | Message                                         |
+---------+------+-------------------------------------------------+
| Warning | 1265 | Data truncated for column 'created_at' at row 1 |
+---------+------+-------------------------------------------------+
1 row in set (0.00 sec)

mysql> select * from bigtable;
+------------+
| created_at |
+------------+
| 2012-06-08 |
+------------+
1 row in set (0.00 sec) 
```

如果您想避免警告，只需传递“YYYY-MM-DD”或将列更改为日期时间，

祝你好运

# android - 如何持续测试处理程序的可运行对象是否完成？

> ID：10954888
> 
> 赞同：1
> 
> 时间：2012-06-08T19:21:30.223
> 
> 标签：android, pausing-execution

Android 代码如何检测处理程序的可运行进程何时完成？在这个特定的应用程序中，除了处理程序完成其工作之外，不会生成其他事件。

简单地`while()`围绕全局布尔标志的连续测试循环似乎不起作用：

```
... stuff to do before the handler's runnable is started
while (globalBooleanFlagStatingThatRunnableIsNotYetFinished)
                     Thread.sleep(5);
... stuff to do only after the handler's runnable is finished, like process data 
```

使用该`while()`方法，执行似乎在分号处永远暂停，直到操作系统推动强制关闭，而不管可运行对象是否成功设置所述布尔标志。

其他人如何检测到可运行进程的完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:42:31.007

您正忙于等待，或者实际上*完全等待*的事实表明您的应用程序的设计理念可能存在缺陷。通常，如果您正在等待某事，您应该做的是触发一个动作作为对某个处理程序的响应。例如，在这种情况下，您可能只是能够处理一个`onClick`事件。如果你在一个线程中等待这个，为什么？相反，杀死线程，留下一些状态（通过状态机，实现延续），当 onClick 被调用时，启动一个新任务来执行其余的工作。

基本上，我不确定我是否认为您实际上*需要*在这里等待，而是您应该使用处理程序。

编辑：您正在寻找的那种编程在应用程序的主线程上是不可能的。相反，您应该做的是使用`AsyncTask`，您在其中完成任务中的工作（即，定期打开和关闭闪光灯）或产生线程的服务。无论如何，您应该阅读 Android 线程，您的问题可能与您尝试使用主线程进行长时间运行的操作有关。是的，这是可能的，但我不会称之为“实时编程”，这只是一个简单的线程问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:18:43.713

您的 while 循环占用了所有 cpu 时间，因此没有其他东西（例如 UI 消息）有时间处理。

`Sleep()`通常的解决方法是在循环内放一个短路。这导致对内核的调用允许它在一段时间内运行其他任务位。

其他**I/O**（例如控制台打印文件读/写）也执行此操作。

# maven - 我可以在运行时指定一个 Maven project.artifactId 吗？

> ID：10954890
> 
> 赞同：8
> 
> 时间：2012-06-08T19:21:38.143
> 
> 标签：maven, maven-3

我有一个 maven POM，我想将其用作模板，根据我传递给它的参数生成具有不同名称的工件。但我不知道如何在运行时指定 artifactId。

如果我`<artifactId>`像这样参数化元素：

```
<artifact>foo-${bar}</artifact> 
```

行家抱怨：

[警告] 'artifactId' 包含一个表达式，但应该是一个常量。

如果我`<artifactId>`在 POM 中省略并尝试在命令行中指定它

```
mvn -Dproject.artifactId=foo ... 
```

行家抱怨：

[错误] 'artifactId' 丢失。

除了诉诸从模板即时生成 POM 文件之外，还有其他技巧可以用来完成此操作吗？[嗯，也许我可以使用 maven 资源过滤来做到这一点......]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T20:05:13.920

如果我做对了，您想重用蓝图 Maven 应用程序并能够更改 artifactId。

这个用例最好用**Maven 原型**来完成。看到[这个让你开始](http://maven.apache.org/guides/mini/guide-creating-archetypes.html)。它相当简单，值得学习。你有一个普通的 Maven 项目，你可以`${groupId}`在你的蓝图 pom.xml 中添加变量。然后它们被您在原型生成时给出的参数替换：

```
mvn archetype:generate                                  \
-DarchetypeGroupId=<archetype-groupId>                \
-DarchetypeArtifactId=<archetype-artifactId>          \
-DarchetypeVersion=<archetype-version>                \
-DgroupId=<my.groupid>                                \
-DartifactId=<my-artifactId> 
```

GitHub 上还有很多人创建的原型，您可以在其中了解更多关于 Maven 原型中的结构化和过滤的信息，[例如](https://github.com/jboss-eap/wfk-archetypes/blob/master/spring-mvc-archetype/src/main/resources/archetype-resources/pom.xml)。

或者，您可以尝试在不使用原型系统的情况下设置 Maven 过滤，但我没有这方面的经验。我认为没有有效的 artifactId 就无法运行项目，必须在此之前发生一些生成（例如从原型生成），但我不确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-18T09:49:45.743

可以在运行时设置 artifactId（我将以下解决方案用于包含多个应用程序的单一存储库）。您的项目 pom.xml 应包括：

```
<project>
  <artifactId>${artifactId}</artifactId> 
  ...
  <properties>
    <artifactId>defaultArtifactId</artifactId>
  </properties>
  ... 
```

要在运行时设置 artifactId，请使用`mvn`带有`-DartifactId=foo`选项的命令。

例子 ：`mvn verify -DartifactId=foo`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T21:10:16.967

你违背了一个 maven 原则，即 pom 应该代表一个自包含项目，生成一个稳定的工件（即避免无法轻松复制的参数化构建）。

如果这确实是您想要的，我会使用 maven-install-plugin 作为生命周期步骤（特别是安装文件）并将其参数化，而不是尝试参数化 pom 本身的 artifactId。

# c++ - C++ 数组转移到元素

> ID：10954893
> 
> 赞同：4
> 
> 时间：2012-06-08T19:21:46.340
> 
> 标签：c++, arrays, shift

好的，标题不是最好的，但这就是我要找的。

```
int arr[] = {3, 4, 5, 6, 7};
int index = 2;
someFunctionICantRemember(int arr, int index);

// result {5, 6, 7, 3, 4} 
```

我在 www.cplusplus.com 上看到了这个功能，但我再也找不到了。据我所知，它是“内置”的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:24:01.857

`std::rotate`( `#include <algorithm>`)。

```
#include <algorithm>
#include <iterator>
std::rotate(std::begin(arr), std::begin(arr) + index, std::end(arr)); 
```

请注意，这会将阵列旋转到位。

# php - htaccess 重写 URL 中的 GET 变量，但仍然可以访问它们

> ID：10954894
> 
> 赞同：1
> 
> 时间：2012-06-08T19:21:53.520
> 
> 标签：php, .htaccess, mod-rewrite

我正在尝试在我的 .htaccess 文件中添加一些内容，以允许我更改以下 URL：

```
http://www.mysite.com/profile?user=theuser 
```

类似于：

```
http://www.mysite.com/profile/theuser 
```

但在页面中，仍然可以执行以下操作：

```
echo $_GET['user']; // echos "theuser" 
```

这可能吗？我该怎么做？

注意：我正在尝试获取地址栏中的 URL 以显示`http://www.mysite.com/profile/theuser`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:40:47.727

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^(profile)/(theuser)/?$ $1?user=$2 [L,QSA,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:24:15.230

是的，这就是 URL 重写的设计方式。

URL 在内部被重写为

```
http://www.mysite.com/profile?user=theuser 
```

格式。

# grails - Grails锁插入并发问题

> ID：10954901
> 
> 赞同：2
> 
> 时间：2012-06-08T19:22:25.230
> 
> 标签：grails, grails-orm

使用 GORM 插入记录时如何锁定整个表？这会占用更多内存并导致烫发宝石吗？

# iphone - 使用简单音频引擎的声音循环之间的轻微停顿

> ID：10954903
> 
> 赞同：0
> 
> 时间：2012-06-08T19:22:41.610
> 
> 标签：iphone, objective-c, ios, audio, cocos2d-iphone

在使用 Simple Audio Engine 播放背景音乐时`playBackgroundMusic loop:YES`，在音频循环回到开头并重新开始之前似乎有一点延迟。有什么办法可以防止这种轻微的停顿吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:27:41.470

暂停实际上是 MP3 编码/压缩算法的产物。通过对流的“最后一帧”和第一帧进行一些数学运算，有一些方法可以抑制暂停。为此存在一些软件工具。我最终为此使用了 Winamp pro，使用了内置的 LAME 编码器。

有关这方面的更多信息，请看[这里](http://www.compuphase.com/mp3/mp3loops.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:00:45.373

我尝试了 MP3Loop 实用程序，它确实帮助了我。使用此实用程序转换后的 Mp3 文件作为背景音乐循环播放，没有任何延迟。但它仅适用于 Windows。 [http://www.compuphase.com/mp3/mp3loops.htm](http://www.compuphase.com/mp3/mp3loops.htm)

# android - 由于父级在android中的LinearLayout wrap_content，TextView切断了线条

> ID：10954904
> 
> 赞同：1
> 
> 时间：2012-06-08T19:22:43.190
> 
> 标签：android, xml, android-layout, android-linearlayout

我想要做的是制作一个居中的框，其中包含一些文本简介和一个按钮以继续。通过使用 wrap_content，我能够使框居中并且不占用整个屏幕，但是简介有几行长，并且包含它们的文本视图没有显示所有文本。这是我所拥有的：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center"
    android:background="@color/background"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_gravity="center"
        android:background="@color/content"
        android:padding="10dp"
     >

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center"
            android:text="@string/title"
            android:textColor="@color/black" />

       <TextView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="@string/teacher_head" 
            android:textColor="@color/black" />

        <TextView
            style="@style/home_blurb"
        android:text="@string/teacher_blurb" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="@string/student_head"
            android:textColor="@color/black"  />

        <TextView
        android:text="@string/student_blurb" 
            style="@style/home_blurb" />

        <Button
            android:layout_width="wrap_content"
        android:layout_height="0dip"
        android:layout_gravity="center"
        android:layout_weight="0.1"
        android:gravity="center"
            android:paddingTop="5dp"
            android:text="@string/go_to_app" />

</LinearLayout>
</LinearLayout> 
```

home_blurb 在哪里

```
<style name="home_blurb" parent="android:TextAppearance">
    <item name="android:paddingBottom">5dp</item>
    <item name="android:textColor">@color/black</item>
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">fill_parent</item>
    <item name="android:layout_weight">1</item>
    <item name="android:textSize">12dp</item>     
</style> 
```

内部 LinearLayout 将自身设置为按钮的宽度，我可以接受，但是有没有办法让它足够宽以包含所有文本而不设置特定的像素测量值（如 html/css 中的屏幕百分比）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-02T17:39:55.647

我遇到过同样的问题。碰巧我正在使用：

```
android:layout_gravity="center" 
```

不要用那个。利用：

```
android:gravity="center" 
```

反而。也许您应该在被切断的 TextView 上使用 android:gravity="center" 。

一些帮助：

android:layout_gravity 是视图的外部重力。这意味着，要指定 View 应该触摸它的父边框的方向。

android:gravity 是该视图的内部重力。这意味着，它的内容应该在哪个方向对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:38:48.603

你可以在第二次使用`LinearLayout`

```
android:layout_marginLeft="20dp"
android:layout_marginRight="20dp"
android:layout_marginBottom="20dp"
android:layout_marginTop="20dp" 
```

这样无论您的文本有多大，您的布局每次都将保持在中心并在其周围留出一些空间。

如果你愿意，你可以给每个元素滚动条，你可以通过为每个元素添加特定的最大高度来做到这一点，那么你可以这样做

`android:scrollbars="vertical"`并在代码中`textview.setMovementMethod(new ScrollingMovementMethod());`

# c# - Google Charts C# API 重叠条形图

> ID：10954906
> 
> 赞同：0
> 
> 时间：2012-06-08T19:22:57.700
> 
> 标签：c#, bar-chart, google-visualization

嗨，我正在尝试利用 C# GCharts API，但绝对需要“重叠”而不是“堆叠”条形图功能。有没有办法通过 API 实现这一点.. 我正在研究一些 jQuery 插件，它们似乎有一些重叠的能力.. 但更喜欢使用包装器。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:40:19.130

我通过绘制数据点之间的差异来解决这个问题，以呈现重叠的外观。执行此操作时，请记住应用自定义工具提示，以便鼠标悬停显示正确的值。

# c# - 如果角色包含空格，如何编写 AuthorizeAttribute

> ID：10954907
> 
> 赞同：6
> 
> 时间：2012-06-08T19:23:03.593
> 
> 标签：c#, asp.net-mvc-3, authorization

我正在使用 MVC3/4。但这只是授权中的一个普遍问题。

我的角色之一在数据库中被命名为“Trip Leader”，其中包含一个空格。

我试过`[Authorize(Roles="'Trip Leader', Administrator")]`了，但没有奏效。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T07:05:05.250

创建您自己的属性并从 AuthorizeAttribute 派生。然后覆盖 AuthorizeCore 方法并通过验证包含空格的角色实现您自己的逻辑。

一个例子可能是这样的：

```
 public class CustomAuthAttribute : AuthorizeAttribute
    {
       private readonly IUserRoleService _userRoleService;
       private string[] _allowedRoles;

       public CustomAuthAttribute(params string[] roles)
       {
          _userRoleService = new UserRoleService();
          _allowedRoles = roles;
       }
       protected override bool AuthorizeCore(HttpContextBase httpContext)
       {
        //something like this.
        var userName = httpContext.User.Identity.Name;
        var userRoles = _userRoleService .GetUserRoles(userName); // return list of strings
        return _allowedRoles.Any(x => userRoles.Contains(x));
       }
   } 
```

**用法**

```
[CustomAuth("role withspace","admin")]
public ActionResult Index()
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:30:02.903

试试这个：

```
[Authorize(Roles="Trip Leader")]
[Authorize(Roles="Administrator")] 
```

编辑：上面的代码要求用户同时履行这两个角色。如果您正在寻找非此即彼的授权，请尝试以下操作：

```
[Authorize(Roles="Trip Leader, Administrator")] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-01T06:02:32.030

我无法得到其他答案。我的角色中有逗号，不能与原始 AuthorizeAttribute 一起使用。

```
 //Custom Authorize class that derives from the existing AuthorizeAttribute
    public class CustomAuthorizeAttribute : AuthorizeAttribute
    {

        private string[] _allowedRoles;

        public CustomAuthorizeAttribute(params string[] roles)
        {
            //allowed roles
            _allowedRoles = roles;
        }
        protected override bool AuthorizeCore(HttpContextBase httpContext)
        {
            var roleManager = httpContext.GetOwinContext().Get<ApplicationUserManager>();
            //Grab all of the Roles for the current user
            var roles = roleManager.GetRoles(httpContext.User.Identity.GetUserId());
            //Determine if they are currently in any of the required roles (and allow / disallow accordingly) 
            return _allowedRoles.Any(x => roles.Contains(x));
        }
    } 
```

# android - MonoDroid：缺少 Button.SetText（跨度）

> ID：10954910
> 
> 赞同：1
> 
> 时间：2012-06-08T19:23:26.783
> 
> 标签：android, html, button, xamarin.android

我正在尝试使用`Html.FromHtml("some html")`in设置按钮的文本`Mono for Android`。

在`Java`这个作品中：

```
myButton.setText(Html.fromHtml("<small>(sub comment)</small>")); 
```

但是在 Mono for Android 中失败了，因为`no signature`它`SetText`接受了`Html.FromHtml`跨度。

这应该有另一种方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:43:18.153

`Html.fromHtml()``Spanned`return ，它`CharSequence`在 Android 和 MonoDroid 中都有扩展。但似乎 Android`Button`类有一个[`setText(CharSequence)`](http://developer.android.com/reference/android/widget/TextView.html#setText%28java.lang.CharSequence%29)方法（来自`TextView`），但 MonoDroid`Button`没有（[`TextView`](http://docs.mono-android.net/?link=T%3aAndroid.Widget.TextView/M)无论如何都不是）。

似乎还有其他选项包含`CharSequence`虽然，也许您可​​以使用其中一个来代替？

1.  `TextView.SetText(Java.Lang.ICharSequence, TextView.BufferType)`
2.  `TextView.set_TextFormatted(Java.Lang.ICharSequence)`
3.  '`button.SetText(span, TextView.BufferType.Spannable);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T16:55:32.153

Java [TextView.setText(CharSequence)](http://developer.android.com/reference/android/widget/TextView.html#setText(java.lang.CharSequence))方法绑定为[TextView.Text](http://androidapi.xamarin.com/?link=P%3aAndroid.Widget.TextView.Text)和[TextView.TextFormatted](http://androidapi.xamarin.com/?link=P%3aAndroid.Widget.TextView.TextFormatted)属性：

```
myButton.TextFormatted = Html.FromHtml ("<small>(sub comment)</small>"); 
```

# javascript - 使用 javascript 或 jquery 将 Div 动态添加到 html 页面

> ID：10954911
> 
> 赞同：7
> 
> 时间：2012-06-08T19:23:35.920
> 
> 标签：javascript, jquery, html, dynamic

我想要一个主 div，并且能够动态添加与主 div 相同级别的新 div。像这样的东西：

```
<div id="main"></div>
<div id="created_div"></div> 
```

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T19:25:00.257

```
$("#parent_div").append('<div id="created_div"></div>'); 
```

或者如果您希望新创建的`<div>`-s 出现在其他人之前

```
$("#parent_div").prepend('<div id="created_div"></div>'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T19:25:31.073

```
$('#main').after('<div id="created_div"></div>'); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T19:25:54.900

```
$('<div id="created_div"></div>').insertAfter('#main'); 
```

# php - Chrome 正在创建具有相同 ID 的重复会话

> ID：10954917
> 
> 赞同：3
> 
> 时间：2012-06-08T19:24:10.357
> 
> 标签：php, google-chrome, cookies

我今天在修改会话库时遇到了一个问题，这可能是我第一次在后端脚本上看到特定于浏览器的问题。我希望有人能解释一下。

会话库的基本工作方式是：实例化时，它会在客户端机器上检查名为“id”的 cookie（以 uniqid 结果的形式）。如果找到 cookie，脚本会检查该 cookie 以及用户代理字符串的散列副本与会话表中的条目。如果找到匹配条目，脚本将恢复会话。如果没有找到名为 'id' 的 cookie，或者会话表中不存在匹配条目，则脚本会同时创建两者。我认为相当标准。

现在这是奇怪的部分：在 Firefox 中，一切都按预期工作。用户获得一个会话，只要未超过 24 小时不活动，他将始终在连接后恢复该会话。但是当我在 Chrome 中访问该页面时，即使它看起来相同并且似乎正在以相同的顺序执行查询，我在会话表中看到了两个条目。会话共享一个代理字符串，但 id 不同，时间戳日志表明在为用户创建的会话之后不久（一秒内）创建了幽灵会话。

出于调试目的，我一直在执行查询时将查询打印到屏幕上，这是我在 Chrome 应该打开一个会话并且以某种方式打开两个会话时所看到的示例：

```
// Attempting to resume a session
SELECT id FROM sessions WHERE id = '4fd24a5cd8df12.62439982' AND agent = '9bcd5c6aac911f8bcd938a9563bc4eca'

// No result, so it creates a new one
INSERT INTO sessions (id, agent, start, last) VALUES ('4fd24ef0347f26.72354606', '9bcd5c6aac911f8bcd938a9563bc4eca', '1339182832', '1339182832')

// Clear old sessions
DELETE FROM sessions WHERE last < 1339096432 
```

以下是我之后在数据库中看到的内容：

```
id, agent, start, last
4fd24ef0347f26.72354606, 9bcd5c6aac911f8bcd938a9563bc4eca, 1339182832, 1339182832
4fd24ef0857f94.72251285, 9bcd5c6aac911f8bcd938a9563bc4eca, 1339182833, 1339182833 
```

我错过了一些明显的东西吗？我唯一能想到的是 Chrome 可能会在后台创建一个隐藏会话，可能是为了抓取页面。但是，如果是这种情况，那么当我开始将活动会话与用户表中的条目相关联时，它可能会成为一个问题。我一直在寻找我的脚本中可能存在的错误，但到目前为止我还没有发现任何东西，并且在 Firefox 中一切正常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:13:14.977

我以前遇到过这种情况，同样感到困惑。从几个月前开始，Chrome 就启用了预取功能。因此，为了加快用户的感知速度，它会抓取页面上的大多数链接，并提前部分检索和呈现它们。非常适合最终用户，因为如果您使用宽带，它可以真正减少页面更改时间。

不幸的是，对于我们 Web 开发人员来说，它会导致像上面这样的混乱。例如，当 Chrome 用户访问网站但尚未分配 cookie 或会话，但浏览器已预先获取多个页面并分配了多个会话时，就会发生这种情况。

因此，假设某人访问了一个带有指向您 PHP 脚本不同区域的链接的页面，并且该脚本旨在为所有访问者分配一个 cookie……如果 Chrome 同时或接近它获取其中两个页面，PHP 将最终分配不同的会话，因为 Chrome 中的另一个线程在完成其他分配之前基本上需要一个新的会话/cookie。

我知道有两种解决方案：一种是[用于处理预渲染的 Google 的 JavaScript API](https://developers.google.com/chrome/whitepapers/pagevisibility)，我还没有发现它特别好。另一种方法是在从 PHP 分发会话和 cookie 时执行更严格的检查。要么不将会话分配给来宾用户，要么添加一些额外的检查（IP、主机名等）。

希望有帮助。

# c# - 为什么我的进程只是打开一个空白窗口并立即关闭它？

> ID：10954918
> 
> 赞同：1
> 
> 时间：2012-06-08T19:24:14.327
> 
> 标签：c#, imagemagick

我正在尝试通过 C# 中的 Process 类调用 convert.exe 以将特定图像转换为另一种格式，如下所示：

```
File.WriteAllBytes(inputFilePath, Convert.FromBase64String(image.Content));
Elmah.ErrorLog.GetDefault(HttpContext.Current).Log(new Error(new Exception("Succesfully wrote the image to: " + inputFilePath)));

var proc = new Process();
proc.StartInfo.Arguments = string.Format("{0} {1}", inputFilePath, outputFilePath);

proc.StartInfo.FileName = @"c:\Program Files (x86)\ImageMagick-6.7.7-Q16\convert.exe";
proc.StartInfo.CreateNoWindow = false;
proc.StartInfo.UseShellExecute = false;
proc.Start();
proc.WaitForExit(); 
```

我不明白为什么它会打开命令提示符并立即将其关闭...您在代码中看到任何错误吗？convert.exe 的路径肯定没问题...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:33:56.333

您的 Web 应用程序在 IIS 用户的上下文中运行，它可能无权执行 convert.exe。您可以尝试在特定用户下运行 IIS（如您，如果 convert.exe 适合您）或以某种方式授予访问权限以让 convert.exe 运行）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T19:30:58.533

您可以将 Stream 附加到 Process 对象以捕获输出。

请参阅[msdn 文档](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput)

# c - 尽管终止客户端，write() 仍返回正确的字节数

> ID：10954921
> 
> 赞同：4
> 
> 时间：2012-06-08T19:24:22.933
> 
> 标签：c, networking, network-programming

我有一个多线程客户端-服务器应用程序。第一个线程是一个“监听器”，它将客户端添加到文件描述符数组中：

```
while (1) {
    if ((connfd = accept(listenfd_service, (struct sockaddr *) &cliaddr, &clilen)) > 0) {
        printf("service connected...\n");
        int i;
        for (i = 0; i < MAX_SERVICES; i++) {
            if (service_sockets[i] == -1) {
                service_sockets[i] = connfd;
                break;
            }
        }
    }
} 
```

问题是当我使用 Ctrl+C 终止客户端并运行以下行时

```
for (j = 0; j < MAX_SERVICES; j++) {
    if (service_sockets[j] != -1) {
        int test = write(service_sockets[j], c, 72);
        if (test == -1) {
            service_sockets[j] = -1;
        }
    }
} 
```

我在“测试”变量中得到 72。如果我第二次尝试运行这些行，我会收到一个 SIGPIPE 信号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:31:36.600

这是正常和预期的行为。当客户端退出时，服务器不会立即发现，因为通常当没有数据通过网络连接时，没有数据正在传输。相反，下次服务器发送数据时，它将发送一个数据包（即您成功写入 72 个字节），并且客户端计算机（如果操作系统仍在运行）将以“连接重置”消息进行响应。这将导致服务器操作系统关闭其连接端，从而在服务器下一次写入套接字时导致 SIGPIPE/EPIPE。

处理这个问题的正常方法是忽略 SIGPIPE 信号，并处理返回 EPIPE 错误的写入。几乎任何处理多个连接并且可能有一个连接而其他连接仍然有用的进程都需要忽略 SIGPIPE。

# javascript - javascript中的javascript，传递变量

> ID：10954923
> 
> 赞同：0
> 
> 时间：2012-06-08T19:24:28.860
> 
> 标签：javascript, html

我在 JavaScript 函数中有一个 JavaScript 函数。`div`下面的 JavaScript 在using中插入一些 HTML `getElementbyID`。

它正在传递一个变量，好吧——这似乎是一个对象的子对象，`this.value`--btw，我是一个 JavaScript 新手，但是，当我尝试给它另一个变量来传递时，`l`它所代表的字符串停止工作。下面`type 1`尝试传递变量`l`不起作用，否则。我也刚刚尝试过推杆`l '+`，但没有奏效。任何人都可以帮助我使用正确的语法来传递变量吗？谢谢你。

```
if (type==1)
  {
  var mailbox = '<form action="mail.php" method="post"><input type="text" onkeyup="showResult(this.value,'+l+')"><input type="submit" name="submit" value="Email"><div id="livesearch"></div></form>';
  }
else
  {
  var mailbox = '<form action="share.php" method="post"><input type="text" onkeyup="showResult(this.value)"> Share<div id="livesearch"></div></form>';
  } 
document.getElementById(target).innerHTML = mailbox;
return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:41:50.677

如果字符串包含`"Check this out."`双引号，这就是生成的 HTML 标记的样子（添加了格式）：

```
<form action="mail.php" method="post">
  <input type="text" onkeyup="showResult(this.value,"Check this out.")">
  <input type="submit" name="submit" value="Email">
  <div id="livesearch"></div>
</form> 
```

请注意 的属性值如何`onkeyup`包含 a `"`，这将关闭该属性，从而导致无效的 HTML。如果字符串包含`Check this out.`没有任何引号，则最终结果仍然无效，原因有：

```
<form action="mail.php" method="post">
  <input type="text" onkeyup="showResult(this.value,Check this out.)">
  <input type="submit" name="submit" value="Email">
  <div id="livesearch"></div>
</form> 
```

在这种情况下，`showResult(this.value,Check this out.)`是事件处理程序 JavaScript，并且有语法错误。您想要的是将字符串放在单引号中，这样它就不会破坏属性，因此它是有效的 JavaScript：

```
var mailbox = '<form action="mail.php" method="post"><input type="text" onkeyup="showResult(this.value,\''+l+'\')"><input type="submit" name="submit" value="Email"><div id="livesearch"></div></form>'; 
```

请注意，不建议以这种方式附加事件，因为很容易犯这种类型的错误。相反，将事件处理程序分配给 DOM 元素，而不是 HTML：

```
var mailboxHtml;
var keyUpHandler;
if (type==1)
{
    mailboxHtml = '<form action="mail.php" method="post"><input type="text" id="search"><input type="submit" name="submit" value="Email"><div id="livesearch"></div></form>';
    keyUpHandler = function() { showResult(this.value, l); };
}
else
{
    mailboxHtml = '<form action="share.php" method="post"><input type="text" id="search"> Share<div id="livesearch"></div></form>';
    keyUpHandler = function() { showResult(this.value); };
} 

document.getElementById(target).innerHTML = mailbox;
document.getElementById('search').onkeyup = keyUpHandler;

return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:29:17.723

如果`l`是字符串，则需要使其看起来像呈现代码中的字符串。

您可以使用`JSON.stringify()`它（实际上是任何类型的变量，包括对象！）。

```
'..... onkeyup="showResult(this.value,'+JSON.stringify(l)+');" .....' 
```

# javascript - 如何在jQuery中获得相对于父级的偏移量（）？

> ID：10954931
> 
> 赞同：64
> 
> 时间：2012-06-08T19:25:06.400
> 
> 标签：javascript, jquery

这给了我一些元素在主窗口左边缘的位置：

```
$('#bar').offset().left; 
```

如果该元素位于其他元素内，并且我想要 #bar 相对于 #foo 的位置（它是父元素），我怎么能得到它？

```
<style>
#foo { width: 200px; margin: 0 auto; }
#foo #bar { width: 50px; margin: 0 auto; }
</style>

<div id="foo">
   <span id="bar"></span>
</div> 
```

我看到有一个函数被调用`offsetParent()`，但是当控制台登录时，这个函数似乎没有任何名为`left`or的属性`x`。所以不确定这是否可以用来获得我需要的东西。

所以在我上面的例子中，偏移量应该是距离父级边缘大约 125 像素，而不是距离主窗口边缘数千像素。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-06-08T19:27:12.833

使用 position() 方法。

```
$('#bar').position().left; 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-06-08T19:27:36.977

这很简单：获取元素的偏移量并减去其父元素的偏移量。

```
var elem = $("#bar");
var offset = elem.offset().left - elem.parent().offset().left; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-06-14T11:05:35.607

**在 div 中相对于其父级的位置：**

*就我而言，当滚动更改时，计算出的偏移量也发生了变化，它不应该因此我最终使用纯javascript，无论如何它更快......*

**element.get(0).offsetTop**

*像 Left 等其他变化也是可能的**element.get(0).offsetLeft***

**结论**

element.offset().top 或 position() 对于位置相关情况不是最佳的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-08T19:28:26.970

```
offsetLeft = $('#bar').position().left;
offsetTop = $('#bar').position().top; 
```

# f# - 具有惯用代码的开源 F# 项目

> ID：10954944
> 
> 赞同：0
> 
> 时间：2012-06-08T19:26:37.993
> 
> 标签：f#, functional-programming

我正在学习 F#，我想找到一些用惯用 F# 编写的中型开源项目以供进一步学习。谁能推荐一些项目？先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:35:02.720

我认为没有一个好的惯用开源项目可供查看，但这里有几个链接。首先，F# 本身有很多值得探索的地方：

*   [F# 编译器和核心库](https://github.com/fsharp/fsharp/tree/master/src/fsharp/FSharp.Core)是开源的，值得一试。编译器相当困难，但一些库是很好的 F# 代码示例。
*   [F# PowerPack](https://github.com/fsharp/powerpack)也是开源的，并实现了一些有趣的类型（如矩阵、向量和一些不可变集合）

一些非常不错（已评论！）且规模合理的 F# 项目包括：

*   [Cellz](http://cellz.codeplex.com/) - 使用 Silverlight 编写的类似 Excel 的电子表格应用程序。它具有简单表达式的解析器和处理单元之间依赖关系的出色评估引擎。

*   [TickSpeck](http://tickspec.codeplex.com/) - 用 F# 编写的行为驱动开发 (BDD) 框架
    （如果您对开发方法感兴趣，那么您可能会感兴趣）

*   [MonoDevelop 的 F# 绑定](https://github.com/fsharp/fsharpbinding)- 是一个很好的评论（我相信 :-)）但相当小的项目，它为 MD 实现了 F# 绑定。它`MailboxProcessor`以一种有趣的方式使用（又名“代理”）。

*   另一个大型 F# 开源项目是[FSharpX](https://github.com/fsharp/fsharpx) - 一个包含各种 F# 库的包 - 但是我不推荐它作为*惯用*的F# 代码。它从 Haskell 中汲取了很多想法和一些语法，这在 F# 中并不是非常惯用的，但它包含许多有趣且有用的部分。

除了项目之外，如果您想学习如何编写惯用的 F# 代码，那么 F# 团队提供了一份出色的[F# 组件设计指南](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=1&ved=0CFIQFjAA&url=http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/fsharp-component-design-guidelines.pdf&ei=Q1XST4zwGcjU8QOI7rWeAw&usg=AFQjCNG_EV9hAPks_Ll-Av-5NTX9TsqrJw&sig2=h2pvEUA9RlvxJf99dH_iJg)文档。

# ruby-on-rails - 是否可以使用 .powrc 文件根据正在访问的 URL 将会话变量传递给 Rails？

> ID：10954945
> 
> 赞同：0
> 
> 时间：2012-06-08T19:26:46.620
> 
> 标签：ruby-on-rails, rack-pow

我有一个服务于多个域的 Rails 2 应用程序。也就是说，[http://domainA.com](http://domainA.com)和[http://domainB.com](http://domainB.com)都由同一个 Rails 应用程序提供服务。`site`当我手动启动这些时，我通过传递一个变量来指定我想要查看的站点： `site=domainB ruby script/server`.

我想使用 Pow 以便我可以通过[http://domainA.myapp.dev](http://domainA.myapp.dev)和[http://domainB.myapp.dev](http://domainB.myapp.dev)访问这两个站点（我也会对[http://domainA.dev](http://domainA.dev)和[http://domainB.dev](http://domainB.dev)如果这更容易）。

我可以通过添加`export site="domainB"`到我的`.powrc`文件中手动执行此操作，并在每次我想切换站点时手动编辑（然后执行`touch tmp/restart.txt`）......不过，我更喜欢自动的东西。我正在考虑类似于文件`subdomain == domainA ? export site="domainA" : export site="domainB"`内的`.powrc`内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:37:55.930

我已经编写了以下 rake 任务来切换站点，`rake pow[SITENAME]`直到找到更自动化的解决方案。此代码也可用作[Gist](https://gist.github.com/2898018)。

```
desc "Switches site that Pow serves"
task :pow, :site_name do |t, args|
  pow_config = "#{Rails.root}/.powrc"
  args.with_defaults(:site_name => "domainA")

  # Overwrite .powrc file with new site name
  file = File.open(pow_config, 'w')
  file.write "if [ -f \"$rvm_path/scripts/rvm\" ] && [ -f \".rvmrc\" ]; then
source \"$rvm_path/scripts/rvm\"
source \".rvmrc\"
fi

export site=#{args.site_name}"
  file.close

  # Restart Pow
  FileUtils.touch "#{Rails.root}/tmp/restart.txt"

  # Announce site change
  puts "Switched to #{args.site_name}"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:47:11.320

我想出了如何做到这一点，并在[这里](http://www.commonmediainc.com/blog/how-serve-multi-site-rails-apps-and-use-pow-make-it-easy)写了一篇关于它的博客文章。这是它如何完成的要点......

我将 my 配置`before_filter`为获取正在访问的域，并在整个 Rails 应用程序中使用它。如果通过标准 Rails 应用程序访问该站点，它将没有域（它只是`localhost`）。在这种情况下，`before_filter`查找`site`在命令行中传递的变量（如果未传递，则使用默认站点）。

```
def set_site
  if RAILS_ENV == "development"
    session[:site] = case request.domain
      when "domainA.dev" then "domainA"
      when "domainB.dev" then "domainB"
      else ENV['site'] || "domainA"
    end
  else session[:site].blank?
    if RAILS_ENV == "staging"
      session[:site] = case request.subdomains.last # *.yourstagingdomain.com
        when "domainA" then "domainA"
        when "domainB" then "domainB"
      end
    elsif RAILS_ENV == "production"
      session[:site] = case request.domain
        when "domainA.com" then "domainA"
        when "domainB.com" then "domainB"
        else "domainA"
      end
    else
      session[:site] = "domainA" # default
    end
  end
  if @site.nil?
    @site ||= Site.find_by_name(session[:site])
  end
end 
```

整个事情实际上是在 Rails 本身内完成的，Pow 唯一参与的是 Rails 应用程序服务的每个站点都必须有一个符号链接。

符号链接还必须与`request.domain`在`before_filter`. 因此，在此示例中，将有两个符号链接 -`domainA`和`domainB`.

# javascript - Grails 从视图中访问控制器值

> ID：10954948
> 
> 赞同：1
> 
> 时间：2012-06-08T19:27:08.220
> 
> 标签：javascript, ajax, grails, view, controller

我对 Grails 很陌生，所以请多多包涵。

我的观点有这样的javascript代码：

```
//js code in my View
function validateEmailAndSetEmail(){
    var result =${remoteFunction(controller:'myController',action:'validateEmail',update:'responseDiv', params:'\'email=\'+document.getElementById(\'email\').value')};

    if (result) { //doSomething}
} 
```

我的控制器看起来像：

```
def validateEmail = {
    def emailToValidate = request.getParameter("email")
    def matchingEmailFound = myService.checkEmailAddress(emailToValidate)

    if (matchingEmailFound){
        render "This email is already in use.<br>If you have already created an account with this email, please try to reset the password from Login page."}
    else{
        //setEmail to send here
        render "This email is not in use. This email will be used as your account email"}

    return !matchingEmailFound 
```

我的问题有两个部分：

1.  当我从 firebug 检查我的 js 代码中的*结果*值时，它不是布尔类型（true/false）并且该值似乎不正确，有没有办法将此值正确传递给控制器​​视图中的 js？

2.  我可以将设置电子邮件值调用到控制器中的某个变量并在我的视图中调用 js 之外的变量吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T20:42:04.963

请记住，Ajax 是异步`if(result)`的——远程调用一发送就执行，而不是在它完成时执行。

更好的方法是更改​​控制器操作以返回一些 JSON 数据：

```
def model = [matchFound:matchingEmailFound]
if(matchingEmailFound) {
  model.message = "This email is already in use.<br>If you have already created an account with this email, please try to reset the password from Login page."
} else {
  model.message = "This email is not in use. This email will be used as your account email"
}
render (model as JSON) 
```

然后在客户端使用`onSuccess`函数而不是更新。

```
${remoteFunction(controller:'myController',action:'validateEmail',
   params:'\'email=\'+document.getElementById(\'email\').value', onSuccess:'checkEmail(e)')}; 
```

并定义

```
function checkEmail(response) {
  var r = JSON.parse(response.text);
  $('responseDiv').innerHTML = r.message;
  if(r.matchFound) {
    // do stuff
  }
} 
```

我不是 JavaScript 专家，但你明白了。

# .net - 无法从 WCF 服务反序列化 BitmapSource

> ID：10954949
> 
> 赞同：1
> 
> 时间：2012-06-08T19:27:10.330
> 
> 标签：.net, wpf, wcf, bitmapsource

我正在尝试将 BitmapSource 从我的 WCF 服务发送到我的客户端应用程序。两者都是 .NET 3.5 应用程序。我似乎能够毫无问题地序列化对象（没有异常发生），但我在客户端上的回调永远不会被调用。在我的客户端上添加跟踪以记录异常后，我看到 DataContractSerializer 无法反序列化 BitmapSource。

错误是：'元素'http://schemas.datacontract.org/2004/07/Test.VisionStudio.Remote:Image'包含'http://schemas.datacontract.org/2004/07/System 的数据。 Windows.Interop:InteropBitmap' 数据协定。反序列化器不知道映射到该合约的任何类型。将与“InteropBitmap”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将其添加到传递给 DataContractSerializer 的已知类型列表中。

所以，我按照它所说的做了，并将已知类型添加到服务合同和回调合同中，但我仍然遇到同样的错误。

这是我正在发送的服务回调合同和数据合同（删除不相关的 DataMembers）：

```
[ServiceKnownType(typeof(BitmapSource))]
[ServiceKnownType(typeof(InteropBitmap))]
public interface IZynVisionStudioRemoteServiceCallback
{
    [OperationContract(IsOneWay=true)]
    void OnVisionResultsReady(RemoteVisionProductResult result);

    [OperationContract(IsOneWay = true)]
    void ServiceShuttingDown();
}

[DataContract]
public class RemoteVisionProductResult
{
    private bool _status;
    /// <summary>
    /// Status of the overall inspection. Pass = True, Fail = False
    /// </summary>
    [DataMember]
    public bool Status
    {
        get { return _status; }
        set { _status = value; }
    }

    private string _product;
    /// <summary>
    /// Name of the product the results came from
    /// </summary>
    [DataMember]
    public string Product
    {
        get { return _product; }
        set { _product = value; }
    }

    private string _inspection;
    /// <summary>
    /// Name of the inspection the results came from
    /// </summary>
    [DataMember]
    public string Inspection
    {
        get { return _inspection; }
        set { _inspection = value; }
    }

    private List<RemoteVisionImage> _images = new List<RemoteVisionImage>();
    [DataMember]
    public List<RemoteVisionImage> Images
    {
        get { return _images; }
        set { _images = value; }
    }

    private List<RemoteVisionImage> _imagesWithGraphics = new List<RemoteVisionImage>();
    [DataMember]
    public List<RemoteVisionImage> ImagesWithGraphics
    {
        get { return _imagesWithGraphics; }
        set { _imagesWithGraphics = value; }
    }
}

[DataContract]
public class RemoteVisionImage
{
    /// <summary>
    /// Image uploaded from the vision system
    /// </summary>        
    [DataMember]
    public BitmapSource Image { get; set; }

    /// <summary>
    /// Name of the camera the image was uploaded from
    /// </summary>
    [DataMember]
    public string Camera { get; set; }

    public RemoteVisionImage()
    {
    }
} 
```

谁能帮我弄清楚为什么我不能通过网络发送这张图片？

编辑：我应该添加，我的客户端按预期更新服务引用，并与服务共享程序集，因此 RemoteVisionProductResult 和 RemoteVisionImage 的实现也在客户端上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:55:36.253

我在过去解决了一个类似的问题（为 BimapSources 创建一个 VS 调试可视化器），方法是实现读/写的序列化和反序列化方法：

*   格式（像素格式）
*   像素高度
*   像素宽度
*   跨步
*   缓冲

`CopyPixels(Int32Rect, IntPtr, Int32, Int32)`在序列化器
和反序列化器中使用`Create(Int32, Int32, Double, Double, PixelFormat, BitmapPalette, IntPtr, Int32, Int32)`。

不幸的是，我没有源代码，但是，实现非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T14:39:14.647

这通过向 DataContract 添加 Bitmap 属性、在服务端从 BitmapSource 转换为 Bitmap、通过网络发送它并在客户端使用调色板和来自 Bitmap 的其他属性重新构建 BitmapSource 来解决。

# xcode4.3 - 故事板segue翻转了错误的方向

> ID：10954955
> 
> 赞同：1
> 
> 时间：2012-06-08T19:27:45.630
> 
> 标签：xcode4.3, segue

我有一个主视图控制器，它通过滑动手势调用其他故事板视图......在其中一个视图上，我有一个按钮通过 segue 调用另一个视图（我的按钮链接到这个模态视图）......当我测试它时, 屏幕出现然后突然转向侧面...我的“ `shoudRotateToInterfaceDirection`”设置为

```
(BOOL)shouldAutorotateToInterfaceOrientation:
    (UIInterfaceOrientation)interfaceOrientation
    {
    return (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
    } 
```

这在任何地方都是一样的......并且其他观点正在按预期工作......

整个应用程序设置为`lanscapeRight`（并且是唯一允许的方向）...

任何线索？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:46:39.207

好的，所以在做了一些测试之后，似乎使用“默认”演示文稿导致了问题......我将它切换到“当前上下文”，现在它看起来很好......

# sql-server - 从表中删除数据

> ID：10954956
> 
> 赞同：1
> 
> 时间：2012-06-08T19:27:47.863
> 
> 标签：sql-server, sql-server-2008, tsql, sql-delete

可能是我今天花了太长时间看这个所以很愚蠢。但........

我有一个简单的存储过程可以做到这一点；

```
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    DELETE FROM ProductLoading
END 
```

该表`ProductLoading`由 3 个字段组成，其中非关键字段。这是一个临时表，当从单独的数据源加载数据时，它需要在短时间内保存数据。我这样做是为了检查产品是否被删除。

现在，当此代码运行时，**它还会从另一个表中删除所有内容**，`Products3`. 如果我将此行注释掉，则不会。

不是键和索引方面的专家，但有基本的掌握。但是查看了这两个表后，看不到任何依赖项。另外，当我运行执行计划时，它不会对`Products3`表进行任何引用。

真的卡在这个了。任何人都可以告诉我我忽略了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:32:23.883

听起来像[级联参照完整性约束](http://msdn.microsoft.com/en-us/library/ms186973%28v=sql.105%29.aspx)。您确定其中的 3 个字段之一`ProductLoading`不是键吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T11:59:15.007

不知道发生了什么故障。

但是经过一番头大的困惑，基本上是在存储过程中添加了一个虚拟的插入语句并重新编译它。

奇怪的是，删除语句没有过滤到 Products3 表。

然后我删除了这个虚拟的插入语句，更奇怪的是存储过程继续工作。

现在唯一不同的是，当这些表是用错误的模式创建的时候。我立即意识到这一点，并在正确的架构下重新创建了表，并删除了错误创建的表。此时没有数据存在，因此不确定在此期间是否有任何损坏。看不出是怎么回事，但是嘿，1 和 0 有时不能加起来。

所以没有这样的解决方案，只是 li 之一

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:33:15.210

理论上，您的表 ProductLoading 可能有删除触发器？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T19:30:14.763

ProductLoading 加载必须包含一个主键，该主键是另一个启用了级联删除的表的外键。

![在此处输入图像描述](../Images/3c73de1960a570280cfc45111fe444de.png)

# java - 获取上一季度的结束日期

> ID：10954960
> 
> 赞同：3
> 
> 时间：2012-06-08T19:28:10.247
> 
> 标签：java, date

对于给定日期，如何获取上一季度的结束日期？我需要运行一份工作，这会考虑到这一点。编辑：第一季度是一月、二月、三月；2日是4月、5月、6月，以此类推；

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T19:39:59.740

基本上：

1.  找出当前季度
2.  返回上一季度的最后日期（3月31日、6月30日、9月30日、12月31日）

所以要弄清楚哪个是当前季度：（ `int quarter = (myDate.getMonth() / 3) + 1;` 请注意，不推荐使用[getMonth()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Date.html#getMonth%28%29)来支持`Calendar.get(Calendar.MONTH)`.）

然后将上一季度与日期相匹配。

```
int prevQuarter = (myDate.getMonth() / 3); 
switch(prevQuarter) {
    case 3 : 
        // return September 30
    case 2 :
        // return June 30
    case 1 :
        // return March 31
    case 0 : default :
        // return December 31
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:36:52.633

井季度仅在 12、9、6 和 3 个月结束。所有这些都有静态长度。所以只有 4 个有效的结束日期。比较你的月份，如果是 1 或 2 或 3，答案是 year-1 的 31.12，如果是 4,5,6，则为今年的 31.3，如果是 7,8,9，则为今年的 30.6 . 如果是 10.11.12，那么今年是 30.9。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T19:32:07.810

[http://www.taggercat.com/docs/api/TaggerCat/com/taggercat/util/DateUtils.html#last90Days%28%29](http://www.taggercat.com/docs/api/TaggerCat/com/taggercat/util/DateUtils.html#last90Days%28%29)

```
public static java.util.Date[] last90Days() 
```

返回表示上一季度开始和结束的两个日期

返回：代表此期间的两个日期

这将有助于使用这些日期和给定的日期，您可以确定上一季度的日期。如果我正确理解您的问题，那就是。

# eclipse - 如何在 Eclipse 中更改潜在匹配的背景颜色

> ID：10954965
> 
> 赞同：5
> 
> 时间：2012-06-08T19:28:50.593
> 
> 标签：eclipse, color-scheme

> **可能重复：**
> [更改 Eclipse 变量自动突出显示颜色](https://stackoverflow.com/questions/1126802/change-eclipse-variable-autohighlight-color)

我正在尝试自定义 Eclipse 以获得更适合我眼睛的配色方案。我有一些问题

1.  有没有办法保存我迄今为止在我自己的“主题”下所做的所有更改？
2.  我已经完成了我想要的所有更改，除了一个：当我在代码中选择一个单词时，eclipse 将突出显示该单词的所有出现。它通过将背景设置为黄色来做到这一点。问题是我的配色方案无法让我看到实际存在的内容。我附上了一张图片，以便您可以看到我在说什么。

我在 iMac 中使用 Pydev。任何有关此或如何减轻眼睛疲劳的建议将不胜感激。

![我的日食截图](../Images/52649ee098091e28019514a91d0e8ea0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T11:17:52.180

如另一个答案中所述：窗口>首选项>常规>编辑器>文本编辑器>注释>出现。

至于答案的另一部分，是的，您应该能够导出/导入 Eclipse 首选项来配置您的主题。有关详细信息，请参阅：[http](http://pydev.blogspot.com.br/2009/07/creating-dark-theme-and-exporting-and.html) ://pydev.blogspot.com.br/2009/07/creating-dark-theme-and-exporting-and.html 。

但我建议不要走这条路，而是建议以下方法之一：

1.  使用内置主题概念的 Aptana Studio 3（有关获取它的详细信息，请参见： [http ://pydev.org/download.html）](http://pydev.org/download.html)
2.  使用 Eclipse Color Themes 插件：[http](http://eclipsecolorthemes.org/) ://eclipsecolorthemes.org/ （它将一次将给定的主题应用于多个编辑器）

# mysql - MySql 简单子查询/加入

> ID：10954970
> 
> 赞同：0
> 
> 时间：2012-06-08T19:29:13.367
> 
> 标签：mysql, database

这是我的查询：

```
SELECT * From `users` AS `User`
LEFT JOIN `picks` AS `Pick` ON (`Pick`.`User_id` = `User`.`id`)
LEFT JOIN  `owners` AS `owner` ON (`owner`.`id` = `Pick`.`owner_id`)
LEFT JOIN  `owners_seeds` AS `OwnersSeed` ON (`OwnersSeed`.`ownerdate` = (`owner`.`id`)
LEFT JOIN  `labels` AS `Label` ON (`Label`.`id` = `Pick`.`label_id`) WHERE User.market_id = 1111 
```

查询工作正常，但结果如下：

```
USER X

PICK X

OWNER X 
```

ETC..

由于每个用户都有很多选择，但每个选择只有一个所有者等等，我希望我的结果打印如下：

> 用户 X
> 
> 1.  选择 1
>     1.  所有者 1
>         1.  所有者种子
>     2.  所有者 2
>         1.  所有者种子
>     3.  业主 3...
> 2.  选择 2

ETC

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:37:12.430

```
SELECT
    users.user,
    picks.pick,
    owners.owner,
    owners_seeds.seed
From
    `users`
    LEFT JOIN `picks` ON (`Picks`.`User_id` = `Users`.`id`)
    LEFT JOIN  `owners` ON (`owners`.`id` = `Picks`.`owner_id`)
    LEFT JOIN  `owners_seeds` ON (`Owners_Seeds`.`ownerdate` = (`owners`.`id`)
    LEFT JOIN  `labels` ON (`Labels`.`id` = `Picks`.`label_id`)
WHERE
    users.market_id = 1111
group by users.user, picks.pick, owners.owner, owners_seeds.seed
order by users.user, picks.pick, owners.owner, owners_seeds.seed; 
```

如果您的架构与您描述的一样，则应输出类似于以下内容的结果：

```
user     pick     owner    seed
------------------------------------
1        1        x        a
1        2        y        b
1        3        z        c
2        1        x        a
. . . 
```

# java - 更新 setText() 时 JLabel 的背景颜色发生变化

> ID：10954975
> 
> 赞同：1
> 
> 时间：2012-06-08T19:29:29.000
> 
> 标签：java, swing, jlabel

编辑（这不是导致问题的不透明属性，它正在更新 JLabel 的背景属性）：我正在使用 MouseMotionListener 将 JLabel 的 setText() 设置为鼠标当前的位置。JLabel 在程序第一次运行时以正确的背景颜色/透明度开始。每当更新 text/mouseMotion 时，JLabel 就不再透明。

更新的可运行代码：

例如：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.TextArea;
import java.awt.Toolkit;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;

public class MouseTester extends JFrame {
public static void main(String[] args) {
try {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            MouseTester.createMouseTester();
        }
    });
} catch (Throwable t) {
    System.exit(1);
}
}
private static MouseTester mt = null;
private JLabel mouseLocation = null;
private static Color labelBackgroundColor = new Color(0, 0, 0, 127);
private static Color labelForegroundColor = Color.WHITE;

public static void createMouseTester() {
      if (mt != null)
          return;
      mt = new MouseTester();
      mt.setVisible(true);
}

private MouseTester() {
      super();
      mt = this;
      setResizable(true);
      Dimension dScreen = Toolkit.getDefaultToolkit().getScreenSize();
      setMinimumSize(new Dimension(Math.min(800, dScreen.width), Math.min(590,
      dScreen.height)));
      setSize(getMinimumSize());
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

      mouseLocation = new JLabel(" Lat/Long ");
      mouseLocation.setOpaque(true);
      mouseLocation.setBackground(labelBackgroundColor);
      mouseLocation.setForeground(labelForegroundColor);
      mouseLocation.setToolTipText("The MGRS coordinates.");

      Component textArea = new TextArea("Move mouse here to see mouse motion info...");

      // Add a mouse motion listener to capture mouse motion events
      textArea.addMouseMotionListener(new MouseMotionAdapter() {

public void mouseMoved(MouseEvent evt) {
      TextArea source = (TextArea) evt.getSource();
          // Process current position of cursor while all mouse buttons are up.
            mouseLocation.setText(source.getText() + "\nMouse moved [" + 
          evt.getPoint().x + "," + evt.getPoint().y + "]");
            mouseLocation.setBackground(labelBackgroundColor);
            mouseLocation.setForeground(labelForegroundColor);
            mouseLocation.setOpaque(true);
            mouseLocation.repaint();

      }
      public void mouseDragged(MouseEvent evt) {

      }
  });

  // Add the components to the frame; by default, the frame has a border layout
        mt.add(textArea, BorderLayout.NORTH);
        mouseLocation.setOpaque(true);
        mouseLocation.setBackground(labelBackgroundColor);
        mouseLocation.setForeground(labelForegroundColor);
        mt.add(mouseLocation, BorderLayout.SOUTH);

        int width = 300;
        int height = 300;
        mt.setSize(width, height);
  }
} 
```

JLabel 开始时透明/略带灰色，然后随着鼠标移动变为不透明且完全黑色。透明度由背景颜色决定。

我几乎尝试过在我能想到的任何地方更改背景颜色，但它不起作用..

我希望它一直保持颜色（它在启动时的颜色）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:25:20.633

您已声明您的 JLabel 是不透明的，这意味着它完全负责绘制自己的背景。但是您已将其背景颜色设置为半透明颜色。这是一个矛盾，是你的问题的原因。

您可以通过使用`mt.repaint();`而不是`mouseLocation.repaint();`强制重新绘制 JLabel 后面的整个面板区域（灰色）来修复 JLabel 的外观，然后以半透明颜色重新绘制 JLabel。

如果您想避免重新绘制整个`mt`对象的成本，那么您需要将 JLabel 嵌套在一些可以快速重绘的较小组件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T20:07:09.790

您必须调用`JLabel#repaint()`from `Opaque(true)`to `Opaque(false)`，反之亦然，对于`MouseEvents`从 触发的每一个`(Xxx)MouseListeners`，因为 API 中缺少此方法，其余部分[由@kleapatra 描述](https://stackoverflow.com/a/7634488/714968)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-09T14:17:49.367

我不确定您为什么要更改标签的[透明度](https://stackoverflow.com/a/2234020/230513)。使标签[不透明](http://java.sun.com/products/jfc/tsc/articles/painting/index.html#props)并调整其背景[饱和度](https://stackoverflow.com/questions/2123841/javax-swing-timer-repeats-fine-but-actionlistener-doesnt-do-anything/2124507#2124507)可能就足够了，如下所示。

关于您的实施的一些注意事项：

*   感谢使用[事件调度线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)。
*   让布局完成工作；`setSize()` [谨慎](https://stackoverflow.com/a/7229662/230513)使用。
*   不要不必要地混合 AWT 和 Swing 组件。
*   不要吞下异常。

![在此处输入图像描述](../Images/8f3418f17624f3cac43ea31a4eab63a1.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;

public class MouseTester extends JFrame {
    private static MouseTester mt;
    private static Color labelBackgroundColor = Color.gray;
    private static Color labelForegroundColor = Color.white;
    private JLabel mouseLocation;

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                MouseTester.createMouseTester();
            }
        });
    }

    public static void createMouseTester() {
        mt = new MouseTester();
        mt.setVisible(true);
    }

    private MouseTester() {
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        mouseLocation = new JLabel("Lat/Long", JLabel.CENTER);
        mouseLocation.setOpaque(true);
        mouseLocation.setBackground(labelBackgroundColor);
        mouseLocation.setForeground(labelForegroundColor);
        mouseLocation.setToolTipText("The MGRS coordinates.");
        JTextArea textArea = new JTextArea(
            "Move mouse here to see mouse motion info...");
        textArea.addMouseMotionListener(new MouseMotionAdapter() {

            @Override
            public void mouseMoved(MouseEvent me) {
                mouseLocation.setText("Mouse moved ["
                    + me.getX() + ", " + me.getY() + "]");
            }
        });
        this.add(textArea, BorderLayout.CENTER);
        this.add(mouseLocation, BorderLayout.SOUTH);
        this.pack();
        this.setSize(320, 240); // content placeholder
        this.setLocationRelativeTo(null);
    }
} 
```

# php - PHP 上的类实例？

> ID：10954977
> 
> 赞同：3
> 
> 时间：2012-06-08T19:29:36.803
> 
> 标签：php

我不知道它叫什么，我相信它是实例。

假设我们有一个“怪物”类。此类应包含“健康”值。在创建类时设置为“5”。它还应该包含每个怪物的唯一 ID 值。

我想这样的事情：

```
$monster_1 = new Monster(); //sets monster ID to 1
$monster_2 = new Monster(); //sets monster ID to 2
$monster_3 = new Monster(); //sets monster ID to 3 
```

所以，假设我想计算所有怪物的总生命值。

```
$totalHp = $monster_1->getHp() + $monster_2->getHp() + $monster_3->getHp(); 
```

它也可以，但是如果我添加一个名为`$monster_4`. 我必须手动将其添加到 $totalHp 计算中。

我可以创建一个数组而不是`$monster`变量，并使用 foreach 计算 $totalHp - 但它看起来很奇怪......

我不知道它是如何在其他语言中完成的。

有没有其他方法来归档这个？

附言。我试图了解“ [http://www.scirra.com/demos/ghosttutorial/](http://www.scirra.com/demos/ghosttutorial/) ”游戏背后的逻辑。你创建了一个 Monster 类，每个 Monster 都使用这个类作为实例。我的解决方案肯定会奏效，但我不确定这是否是一种破解方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:38:23.743

创建一个包含一组怪物的辅助类，可能是一个 MonsterTeam 类；

```
class Monster {
     ...
}

class MonsterTeam {
    private $_monsters = [];

    public function addMonster(Monster &$monster) {
        array_push($this->_monsters, $monster);
    }

    public function getTotalHp() {
        $hp = 0;

        foreach ($this->_monsters as $monster) {
            $hp += $monster->getHp();
        }

        return $hp;
    }
}

$team = new MonsterTeam();

$monsterA = new Monster();
$team->addMonster($monsterA);

$monsterB = new Monster();
$team->addMonster($monsterB);

echo "Total HP: " . $team->getTotalHp(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T19:34:32.303

首先，它们被称为**Objects**或**Instances**，就像在**面向对象**的编程中一样？

其次，没有什么能阻止你创建一个怪物数组（看起来并不奇怪）：

```
$monsters = array(
    new Monster(),
    new Monster(),
    new Monster(),
    new Monster()
);

foreach($monsters as $monster) {
    $totalHP += $monster->hp;
} 
```

关于唯一ID，应该是那个人的责任`MonsterFactory`，意思是怪物应该被**分配**一个ID，它不应该**分配给它自己**，而是ID应该**分配给它**。创建怪物时是这样的：

```
new Monster(4); //ID is 4 
```

谁跟踪它？别人，不是怪物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:34:30.130

您可以使用一个对象作为怪物的容器并使用它来跟踪您：

```
class MonsterContainer
{
    private $monsters = array();

    public function __construct()
    {
       // do stuff   
    }   

    public function addMonster(Monster $monster)
    {
        $this->monsters[] = $monster;   
    }

    public function totalMonstersHP()
    {
        $hp = 0;
        foreach ($this->monsters as $monster)
        {
            $hp += $monster->getHp()
        }
        return $hp;
    }
}

$monster_1 = new Monster(); 
$monster_2 = new Monster(); 
$monster_3 = new Monster(); 

$container = new MonsterContainer();
$container->addMonster(monster_1);
$container->addMonster(monster_2);
$container->addMonster(monster_3);
echo $container->totalMonstersHP(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T19:36:01.700

你可以像这样创建一个`$monsters`数组：

```
$monsters = array(); 
```

然后每次你想添加一个怪物，你这样做：

```
$monsters[] = new Monster(); 
```

然后，您可以循环遍历您的数组以获得总生命值，如下所示：

```
$totalHP = 0;
foreach($monsters as $monster) {
    $totalHP += $monster->getHp();
} 
```

在该循环之后，`$totalHP`将包含阵列中所有怪物的总生命值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T19:45:20.393

您可以创建一个集合工厂；它将负责创造新的怪物。将两个类融合在一起通常不是我的事，但我喜欢这样一个事实，即我可以通过这种方式将构造函数设为私有 :)

它使用两个静态变量（我想是全局变量），一个用于怪物 id，一个用于怪物集合，使用`SplObjectStorage`.

需要遍历所有怪物的方法使用该`each()`方法，因此您想要的任何逻辑都可以在类之外定义。

```
class Monster
{
  private $id;
  public $health;

  private static $instances;
  private static $nextid = 1;

  // private constructor
  private function __construct($id)
  {
    $this->id = $id;
    $this->health = 5;
  }

  public static function create()
  {
    if (!self::$instances) {
      self::$instances = new SplObjectStorage;
    }
    $o = new self(self::$nextid++);
    self::$instances->attach($o);

    return $o;
  }

  public static function remove($o)
  {
    if (!self::$instances) { return; }
    self::$instances->detach($o);
  }

  // iterate over all objects
  public static function each($cb)
  {
    if (!self::$instances) { return; }
    foreach (self::$instances as $o) {
      $cb($o);
    }
  }
} 
```

小用法示例

```
$m1 = Monster::create();
$m2 = Monster::create();

$total_health = 0;
Monster::each(function(Monster $m) use (&$total_health) {
  $total_health += $m->health;
});
echo "Total health: $total_health\n"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T19:34:56.000

我第二个 alexn，使用数组来存储你的类实例（是的，这是正确的术语）非常好。

然后你可以用它`foreach`来计算总HP。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T19:34:59.057

创建 MonstersCollection 类，该类将包含方法`getNewMonster()`和`getTotalHP()`.

伪代码：

```
class MonstersCollection
{
   private $Monsters;

   public function getNewMonster()
   {
       $Monster=new Monster();
       $this->monsters[]=$Monster;
       return $Monster;
    }

   //and you know how to write method to get total HP :)
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-06-08T19:47:13.690

类跟踪其实例是很常见的。

```
class Monster {
    private $monsters = array();
    public function __construct() {
       self::monsters[] = $this;
    }

    public  function __destruct() {
        array_splice(self::monsters, array_search($this, self::monsters), 1 );
    }

    public static function getTotalHp() {
         $total = 0;
         foreach(self::monsters as $monster) {
            $total += $monster->getHp();
         }
         return $total;
    }    
} 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-06-08T19:36:46.673

也许您可以在构造函数中调用的同一个 Monster 类中创建一个新类或函数，并且每次创建该类时，它都会调用一个增加的全局变量。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-06-08T19:38:45.030

您可以创建观察者模式，该模式可以在 Monster 实例化时自动更新集中对象中的 totalHp 属性。

但是在你的 Monster 类中，一个更快/更简单的方法是这样的：

```
class Monster {

   ...
   private $hp = 5;
   private static $totalHp = 0;
   ...

   public function getHp() {
       return $this->hp;
   }

   public function __construct(...) {
       ...
       self::totalHp += $this->getHp();
       ...
   }

   public function __destruct(...) {
       ...
       self::totalHp -= $this->getHp();
       ...
   }

   ...

   public static function getTotalHp() {
       return self::totalHp;
   }

   /**
    * Provide negative number to reduce HP or positive to increase HP.
    */
   public function alterHp($hp) {
       $this->hp += $hp;
       self::totalHp += $hp;
   }
} 
```

然后要获取当前的 totalHp 值，您必须在客户端代码中执行以下操作：

```
$totalHp = Monster::getTotalHp(); 
```

# javascript - 什么时候在回调函数名后使用 ()？

> ID：10954979
> 
> 赞同：2
> 
> 时间：2012-06-08T19:29:45.703
> 
> 标签：javascript

> **可能重复：**
> [在 JavaScript 中，如果我用括号调用函数会有所不同吗？](https://stackoverflow.com/questions/3246928/in-javascript-does-it-make-a-difference-if-i-call-a-function-with-parentheses)

这有什么区别：

```
$("a").on("click", anotherFunction); 
```

还有这个：

```
$("a").on("click", anotherFunction()); 
```

有没有办法在没有匿名函数的情况下不让最后一个自我可执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T19:31:55.330

第一个通过实际功能；第二个传递函数的返回值。

我不清楚你最后一个问题的含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:32:08.043

`anotherFunction`是对函数的引用。`anotherFunction()`是在没有参数的情况下评估的函数（因此没有对 的引用`anotherFunction`）。您想要调用函数以将函数传递到预期函数的唯一原因是该函数是否返回另一个函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:32:23.963

`anotherFunction`它本身就是对函数本身的引用。

`anotherFunction()`调用函数并产生函数返回的任何结果。

这是一个极其巨大的差异。

这就像以下之间的区别：

```
function test() {
    alert("Hello!");
}
setTimeout(test,1000); // called after one second
setTimeout(test(),1000); // called immediately, timeout fails. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T19:32:25.097

你应该使用第一个。这是因为 () 执行它们之前定义的函数。如果您使用第一个，则回调 anotherFunction 仅在您需要时调用。JQuery 会做类似 anotherFunction 的事情（在一个名为回调的 var 中） callback()

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T19:32:49.313

区别在于传递函数引用和调用该函数。

第一种情况（可能是正确的）意味着：当事件发生时调用这个函数。

第二个将被解释为：立即调用此函数并将返回的任何内容用作回调。最好是我以后可以调用的函数。

后一种情况仅在函数定义如下时才有效：

```
function anotherFunction() {
    return function() {
        //real handler
    }
} 
```

# r - R中的另一个POSIXlt困境

> ID：10954993
> 
> 赞同：1
> 
> 时间：2012-06-08T19:31:00.293
> 
> 标签：r, time, base

每隔一段时间，我就会发现一个真正的挠头……知道这里发生了什么吗？

```
> a = strptime("2003-11-01", "%Y-%m-%d")
> b = strptime("2004-01-31", "%Y-%m-%d")
> unlist(a)
  sec   min  hour  mday   mon  year  wday  yday isdst 
    0     0     0     1    10   103     6   304     0 
> unlist(b)
  sec   min  hour  mday   mon  year  wday  yday isdst 
    0     0     0    31     0   104     6    30     0 
> a$mon = a$mon-1
> b$mon = b$mon-1
> a=as.POSIXlt(as.POSIXct(a))
> b=as.POSIXlt(as.POSIXct(b))
> a
[1] NA
> b
[1] "2003-12-31 PST"
> unlist(a)
  sec   min  hour  mday   mon  year  wday  yday isdst 
   NA    NA    NA    NA    NA    NA    NA    NA    -1 
> unlist(b)
  sec   min  hour  mday   mon  year  wday  yday isdst 
    0     0     0    31    11   103     3   364     0 
```

为什么我可以编辑 b 而不能编辑 a？我觉得我一定是错过了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T19:52:28.143

`a`当您减去一个月时，您的日期在技术上是 dst 。除非您还更改了`isdst`属性，否则它不是有效日期。

```
> a <- strptime("2003-11-01", "%Y-%m-%d")
> a2 <- a
> a$mon <- a$mon - 1
> as.POSIXct(a)
[1] NA

> a2$mon <- a2$mon - 1
> a2$isdst <- 1
> as.POSIXct(a2)
[1] "2003-10-01 EDT" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T19:43:16.607

这 ( `a`) 对我有用，R 和会话详细信息如下：

```
> a$mon = a$mon-1
> a=as.POSIXlt(as.POSIXct(a))
> a
[1] "2003-10-01 01:00:00 BST"
> unlist(a)
  sec   min  hour  mday   mon  year  wday  yday isdst 
    0     0     1     1     9   103     3   273     1 
```

根据您的语言环境和时区设置等，如果没有任何进一步的信息，我不得不猜测在您的语言环境/时区中，您从元素中减去 1`a` **后**`$mon`指示的日期/时间不存在。R 在这些事情上非常聪明，但时区和语言环境往往会让人抓狂。

真正的问题是，当您只处理日期时，为什么要使用日期/时间对象？ `a <- as.Date("2003-11-01", "%Y-%m-%d")`在这个例子中就足够了。

我的 R 会话的详细信息：

```
> sessionInfo()
R version 2.15.0 Patched (2012-04-14 r59019)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C             
 [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8    
 [5] LC_MONETARY=en_GB.utf8    LC_MESSAGES=en_GB.utf8   
 [7] LC_PAPER=C                LC_NAME=C                
 [9] LC_ADDRESS=C              LC_TELEPHONE=C           
[11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C      

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods  
[7] base     

other attached packages:
[1] ggplot2_0.9.1

loaded via a namespace (and not attached):
 [1] colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2      
 [4] grid_2.15.0        labeling_0.1       MASS_7.3-18       
 [7] memoise_0.1        munsell_0.3        plyr_1.7.1        
[10] proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.1    
[13] scales_0.2.1       stringr_0.6        tools_2.15.0 
```

# c# - SQL：指定的强制转换无效

> ID：10954994
> 
> 赞同：15
> 
> 时间：2012-06-08T19:31:01.107
> 
> 标签：c#, sql

**注意：我正在寻找为什么会发生这种情况以及如何解决它，我不是在寻找解决方法。这似乎是服务器（SQL Server 或连接字符串）问题。**

我有一个连接到 sql 2008 数据库（数据库 A）的程序，并且我有运行的内联 sql，它返回了整数和字符串，它工作正常。但是我被要求切换到另一个 2008 数据库（数据库 B），现在所有内容都以字符串形式返回，并且当我连接到 sql 2008（数据库 A）时，我从 C# 得到一个指定的强制转换无效不说这个。这是一个内联 sql 语句，因此 sql 语句没有变化，并且数据库的表模式是相同的。它在 int 主键上执行此操作有人有任何想法吗？

我最初认为这是 2000 年到 2008 年的问题，但我现在在 2008 年也遇到了一些问题。两个数据库都在同一个 sql server 实例上，这些是连接字符串

连接字符串

```
 Server=Server01\instance;Database=Fraud_Micah; Trusted_Connection=yes <- Server 2008 (this one does not)
  Server=Server02\instance;Database=Fraud; Trusted_Connection=yes <- Server 2008 (this one works) 
```

两个数据库的数据库兼容性级别均为 100

选择语句

```
select *, delimeter, file_filetype.LocalPath, ArchiveDir, EmailList
from file_importtable 
join file_filetype on file_importtable.FileTypeID = file_filetype.ID
where importsuccessdate is null and transferdate is not null
and remotediscoverdate is not null 
and OriginalFileName in ('Test987.xml.pgp') 
```

`fileTypeID`是它破裂的地方->`InvalidCastException: Specified cast is not valid.`

C# 代码（注意阅读器是 SQLDataReader 类型）

```
if (!(reader.IsDBNull(reader.GetOrdinal("FileTypeID"))))
{
    file.FileTypeID = reader.GetInt32(reader.GetOrdinal("FileTypeID"));
} 
```

这是列定义：`[FileTypeID] [int] NULL`，表中没有空值。

我不认为 C# 代码来自这个，它是一个 int？`public int? FileTypeID { get; set; }`

在调试模式下：`reader["FileTypeID"]`-> "1" 它实际上是一个字符串，但是为什么当我连接到 2008 数据库时它会返回 1 而不是 "1"

2008 表 A 定义

```
[ProcessSuccessDate] [datetime] NULL,
[ProcessSuccessUser] [datetime] NULL,
[FileTypeID] [int] NULL,
[HoldDate] [datetime] NULL, 
```

2008 表 B 定义

```
ProcessSuccessDate] [datetime] NULL,
[ProcessSuccessUser] [datetime] NULL,
[FileTypeID] [int] NULL,
[HoldDate] [datetime] NULL, 
```

`file.FileTypeID = (int)reader["FileTypeID"];`产生相同的结果。

做一个

```
 file.FileTypeID (int)reader.GetInt32(reader.GetOrdinal("FileTypeID")); 
```

确实有效，但我不想对已经应该以 int 形式返回的每一列都这样做，也像这样编写 sql

```
 select Convert(int, FileTypeID) as FileTypeId, delimeter, file_filetype.LocalPath, ArchiveDir, EmailList 
```

也可以解决这个问题，但是如果我已经在表中将类型设置为 int，我想知道为什么我必须这样做。我还不如把所有类型作为字符串放在表中。在这一点上，我不是在寻找解决方法，我想了解为什么它不能正常工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T13:28:51.527

您列出的两个表都显示`int`为数据类型，但听起来它们是两个不同数据库中同一个表的两个版本。

我相信您`JOIN`要使用的 OTHER 表在一个数据库中具有不同的数据类型。

**两个数据库中的数据类型是什么`File_fileType.Id`？**

你的`JOIN`：

`join file_filetype on file_importtable.FileTypeID = file_filetype.ID`

导致隐式转换。

![在此处输入图像描述](../Images/b632cee14bb12119ccf5fe77c94d9422.png)

上图显示了 SQL Server 如何允许或执行数据类型转换。

你能在上面显示两个表的两个版本的 DDL`JOIN`吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T19:35:11.683

对我来说，听起来有些古怪的配置设置很难找到。有一个名为[Redgate SQL Compare](http://www.red-gate.com/products/sql-development/sql-compare/)的工具在检测数据库模式之间的差异方面做得**非常出色。**

他们有 14 天的试用期。我会尝试下载它并在您的数据库之间进行比较。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-11T15:38:50.050

SQL 排序规则是否匹配？如果您在数据库之间遇到不同的行为，这可能是您的问题。右键单击每个数据库并选择属性，排序规则应指定为 *Latin1_General_CI_AS* 如果它们不同，则绝对要排除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T13:12:26.680

至少存在一个错误已被确认。由于我没有完整的图像，因此很难精确。因此，我建议进行两次检查。

第一次检查应该使用 INFORMATION_SCHEMA.COLUMNS 对两个数据库进行检查（对于所需级别来说已经足够了），以验证模式是否相同。[您可以在http://msdn.microsoft.com/en-us/library/aa933218(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa933218(v=sql.80).aspx) (SQL 2000) 或[http://msdn.microsoft.com/](http://msdn.microsoft.com/en-us/library/ms188348)阅读有关 INFORMATION_SCHEMA.COLUMNS 的更多信息[en-us/library/ms188348](http://msdn.microsoft.com/en-us/library/ms188348) (SQL 2008)。来自不同来源的相同信息。

样本：

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS; 
```

如果架构相同，则代码中可能存在在您提供的部分中不可见的错误。为了验证您的完整代码是否正确，请通过更改您的 select 语句进行简单检查，如下所示：

```
select CAST(fileTypeID as int), ..., file_filetype.LocalPath, ArchiveDir, EmailList
from file_importtable 
join file_filetype on file_importtable.FileTypeID = file_filetype.ID
where importsuccessdate is null and transferdate is not null
and remotediscoverdate is not null 
and OriginalFileName in ('Test987.xml.pgp') 
```

如果失败，则在调试模式下运行使用断点和 F11 逐步测试。（有时回到根源可能会帮助我们看到我们眼前看不见的东西——在这种情况下更不可能）。

按照上述操作，您将找到原因（希望如此）。

最后一个提示（这可能是您在做任何其他事情之前的第一步）：确保您的 sql 服务器已使用最新的服务包进行修补。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-13T20:21:12.173

在事情的计划中，我决定删除表并使用重新创建它

[脚本表] -> [创建]

从给我问题的同一张表中，然后重新插入所有相同的数据。这解决了这个问题。所以我不相信表格的 DML 改变了，数据也没有改变，但这就是解决我的问题的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-11T19:39:33.547

Visual Studio（根据[此](http://msdn.microsoft.com/en-us/library/aa833435.aspx)版本的 Premium 和 Ultimate 版）带有一个数据库比较工具 - 您选择两个数据库，它会向您显示差异并为您提供一组脚本，将一个移动到另一个状态。从那里开始并尝试找出不同的配置（因为我认为这是一个配置问题）。查看 Visual Studio 中的数据\架构比较和数据\数据比较。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-08T20:29:29.483

您将不得不从字符串中转换。

```
file.FileTypeID = int.Parse((string)reader["FileTypeID"]); 
```

编辑：如果您想要一种适用于 sql server 2008 和 2000 的解决方法

```
file.FileTypeID = Convert.ToInt32(reader["FileTypeID"]); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-09T05:32:43.837

鉴于您尚未解决此问题，请尝试使用该`GetSqlInt32`方法。

```
file.FileTypeID = reader.GetSqlInt32((fieldTypeIDOrdinal).ToNullableInt32(); 
```

**请注意**，自那以后我没有包括`IsDBNull`检查，并结合`SqlInt32`应付`ToNullableInt32`这一点。

`ToNullableInt32`扩展方法在哪里。

```
public static int? ToNullableInt32(this SqlInt32 value)
{
    return value.IsNull ? (int?) null : value.Value;
} 
```

作为旁注，您提到这是一个性能优先应用程序，在这种情况下，您可能希望预先计算您的序数值，而不是让`reader.GetOrdinal("FileTypeID")`您的每个循环`reader.Read()`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-11T15:00:10.777

`file.FileTypeID = Convert.ToInt32(reader["FileTypeID"]);` **代替** `file.FileTypeID = (int)reader["FileTypeID"];`