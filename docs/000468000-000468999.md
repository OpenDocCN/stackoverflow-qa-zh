# StackOverflow 问答 000468000-000468999

# html - 解决不打印 CSS 背景的最佳方法

> ID：468008
> 
> 赞同：3
> 
> 时间：2009-01-22T04:01:48.273
> 
> 标签：html, css

不打印 CSS 背景通常效果很好，但是，有时我使用它们来传达上下文信息。绕过不打印但您真的想显示的 CSS 背景的最佳方法是什么。我目前正在处理的示例是一个显示财务信息的表格。不同的背景颜色用于表示一个数字有多“好”（例如非常有利可图、有利可图、中性、负面、非常负面）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T04:21:42.007

当我真的需要背景颜色时，我使用边框来模拟背景。像这样的东西会起作用（但我很抱歉没有测试这个）：

```
div.must-have-background-for-print {
    position: relative;
    width: 400px;
}
div.must-have-background-for-print div.background {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    border-left: 400px solid #999;
} 
```

作为对@Steve Quezadas 评论的回应，想法是不使用背景，而是将元素插入需要背景的元素中，并为其应用极宽的边框，以便填充外部元素。这很可能要求该元素的内容也位于另一个包装器内，以便它们出现在新背景元素的上方......

如果你从这个开始：

```
<div class="has-background">Some stuff in here</div> 
```

你可能会使用这个：

```
<div class="has-background">
    <div class="background" />
    <div class="content">Some stuff in here</div>
</div> 
```

这非常难看，但我过去使用过它，它确实解决了背景颜色不打印的问题。而且，在你问之前，你必须让 css 适应你的具体情况。我只是在描述使用边框替换背景的概念。您的实现将取决于您的页面的结构，如果您的元素没有固定的宽度或高度，这将非常困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T04:14:58.760

我在 html 中遇到了同样的问题颜色编码表格数据，最终我只是切换到 pdf 生成以进行彩色打印输出，并且只在 html 中提供了黑白

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T05:13:22.747

这是浏览器设置。[在 IE 中打开后台打印](http://www.febooti.com/support/faq/iezoom/print-web-page-background.html)。因此，您可以更改浏览器设置（如果在 Intranet 上可能）或将报告导出到 Excel 或其他格式进行打印。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T18:11:46.887

两个建议：

1.  表格行中的颜色代码文本
2.  将颜色编码的图标添加到表格行的开头或结尾

您甚至可以将这些与您的背景颜色合并到普通视图中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T04:05:55.393

您可以使字体更大和/或粗体和/或斜体和/或彩色。

# design-patterns - 让域对象知道数据访问层是不正确的吗？

> ID：468015
> 
> 赞同：8
> 
> 时间：2009-01-22T04:04:22.963
> 
> 标签：design-patterns, orm, domain-driven-design, poeaa

我目前正在重写一个应用程序以使用从域层完全抽象数据库的数据映射器。但是，我现在想知道处理域对象之间关系的更好方法是：

1.  直接在域对象内从相关数据映射器调用必要的 find() 方法
2.  将关系逻辑写入本机数据映射器（这是示例在 PoEAA 中倾向于执行的操作），然后在域对象中调用本机数据映射器函数。

在我看来，为了保留“胖模型，瘦控制器”的口头禅，域对象必须了解数据映射器（无论是它们自己的还是它们可以访问系统中的其他映射器） . 此外，选项 2 似乎不必要地使数据访问层复杂化，因为它跨多个数据映射器创建表访问逻辑，而不是将其限制在单个数据映射器中。

那么，让域对象知道相关的数据映射器并直接从域对象调用数据映射器函数是不正确的吗？

**更新：**这是我可以设想的处理域对象之间关系问题的仅有的两种解决方案。欢迎任何显示更好方法的示例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T04:19:44.023

是的。问问自己为什么域对象会知道这样的事情？甚至不是为什么，而是如何？您要将 DAL 注入您的域对象吗？

域应该遵循 SRP 只是生活其他一切。当您遍历您的域时，您应该不知道这些属性是通过延迟加载填充的，还是从实例化中补充的。

我编写了一个包含 DAL 对象的域模型，维护起来简直就是一场噩梦。然后我学习了 NHibernate，我的域由我想要封装的 POCO 和它们各自的业务逻辑组成。

[编辑]

这里有更多信息。如果我试图解释它，我只会让自己尴尬。我只能以用户的身份谈论实现。这是一篇关于[域模型管理](http://www.infoq.com/articles/aspects-of-domain-model-mgmt)的精彩文章。您感兴趣的是拦截器和混入的实现。

使用这些工具，您可以编写一个员工类，如下所示：

```
public class Employee
{
    public Employee()
    {
        Skills = new List<Skill>();
    }

    public string Name { get; set; }
    public IList<Skill> Skills { get; private set; }

    public void AddSkill(Skill skill)
    {
        // Perform Domain specific validation here...

        Skills.Add(skill);
    }
} 
```

如您所见，我的数据访问需求不会强加于我的域设计。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T22:23:00.157

恐怕你稍微误解了存储库模式的意图。

存储库的行为类似于特定域对象的内存集合，通常是聚合根：

```
interface EmployeeRepository
{
    List<Employee> retrieveBy(Criteria someCriteria);
    void store(Employee someEmployee);
    int countOf(Criteria someCriteria);
    // convenience methods
    Employee retrieveById(String id);
    Employee retrieveBySSN(String ssn);
} 
```

这段代码的客户不知道集合是否在内存中，就像你在单元测试中那样，或者在某些情况下与 ORM 映射器交谈，或者在其他情况下调用存储过程，或者为某些域对象维护缓存.

这仍然不能回答你的问题。事实上，您可能让域对象具有委派给正确存储库的 save() 和 load() 方法。我认为这不是正确的方法，因为持久性几乎从来都不是业务领域的一部分，它为您的领域对象提供了不止一个改变的理由。

查看[此相关问题](https://stackoverflow.com/questions/437067/domain-objects-and-services)以了解更多内容。

针对对此答案的一些评论：

> 一个有效的批评。但是，我仍然对如何在现有域对象的上下文中获取单个域对象或相关域对象的集合感到困惑。– 加布里埃尔1836

假设一个员工有很多技能。我认为员工存储库调用技能存储库没有任何问题，如下所示：

```
// assume EmployeeRepository talks to a DB via sprocs
public Employee retrieveById(String id)
{
    ResultSet employeeResultSet = this.database.callSproc("PROC_GetEmployeeById", 
        new Object[] { id });

    List<Skill> skills = 
        new SkillRepository().retrieveBy(new EqualsCriteria("EmployeeId", id));

    Employee reconstructed = new EmployeeFactory().createNew().
                                  fromResultSet(employeeResultSet).
                                  withSkills(skills).
                                  build();

    return reconstructed;    
} 
```

另一种方法是不调用技能存储库，而是让员工存储库调用（在此示例中）存储过程以加载技能的结果集，然后委托给技能工厂以获取技能列表。

> 我不能调用存储库，它是否会调用数据映射器或将对象加载到内存中，不是吗？– 加布里埃尔1836

非常正确。我通常以这种方式在我的单元测试中模拟出整个数据层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T17:09:26.327

在进一步阅读并搜索了合适的模式之后，我偶然发现[了 Repository Pattern](http://martinfowler.com/eaaCatalog/repository.html)。

据我所知，这正是设想的解决方案，它允许像 Person 这样的域对象将查询正确地委托给适当的数据映射器，同时完全抽象域对象和数据映射器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-06T14:55:23.843

我不同意，我认为域对象可以通过抽象工厂访问存储库。

```
public class Client
{
  public void ChangeZipCode(string zipCode)
  {
    // This method access memory or database depending on the factory context
    bool zipCodeExists = RepositoryFactory.Get<IZipCode>().Exists(zipCode);
    this.zipCode = zipCode;
  }
} 
```

通过使用这种模式，不需要在整个代码中注入存储库接口，而只需在存储库工厂中注入。

```
public abstract class RepositoryFactory
{
  // Class operations
  private static _globalInstance;
  public static CreateGlobalInstance(RepositoryFactory factory)
  {
    _glocalInstance = factory;
  }
  public static I Get<I>()
  {
    return _globalInstance.Get<I>();
  }
  /////////////////////

  ///// this operation should be inherited by:
  ///// * NHibernateRepositoryFactory //
  ///// * Linq2SqlRepositoryFactory ////
  ///// * NUnitRepositoryFactory ///////      
  ///// it depends in your context ////////////////////////
  public abstract I GetRepository<I>();
} 
```

我已经做了很多年了，在我的单元测试中没有任何问题。

因此，仅在此类 RepositoryFactory 中才需要依赖注入。

# .net - 发现内部网络上的 Microsoft SQL Server

> ID：468025
> 
> 赞同：2
> 
> 时间：2009-01-22T04:13:55.407
> 
> 标签：.net, sql-server, wmi

使用 .NET 发现内部网络上的 Microsoft SQL Server 的正确方法是什么？我认为 SQL Server 7 天后的 SQL 管理界面在下拉列表中为您提供了服务器列表。我怎么能用 .NET 3.5 做同样的事情。

# asp.net - 密码保护 ATOM 提要

> ID：468033
> 
> 赞同：0
> 
> 时间：2009-01-22T04:19:09.813
> 
> 标签：asp.net, authorization, atom-feed

Twitter ATOM 提要需要您的登录名和密码（显然），IE7 很好地支持了这一点（显然 IE7 无法使用 login/pw 处理 RSS 提要）。注册提要时，IE 会显示一个简单的登录提示。

如何在不访问服务器或 IIS 的情况下在 ASP.NET 中实现类似的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T04:55:11.580

您可以使用一些基本的 ASP 手动发送标头来请求通用 http 身份验证。

（复制自： http: [//psacake.com/web/fl.asp](http://psacake.com/web/fl.asp)）

如果您使用的是 asp.net，您还可以在 web.config 中定义身份验证设置

<!-- Web.config 文件 --> <system.web> <authentication mode="basic" /> </system.web>

# html - 在 CSS 中，如何获得一个左侧固定宽度列和一个使用其余宽度的右侧表格？

> ID：468038
> 
> 赞同：40
> 
> 时间：2009-01-22T04:23:04.953
> 
> 标签：html, css, liquid-layout

所以我尝试使用纯 CSS、从不使用表格换布局的福音，我真的有。但在经历了令人难以置信的痛苦和痛苦之后，我正准备放弃。我愿意付出一些努力在 CSS 中完成一些事情，不要误会我的意思。但是当看起来可以用布局表完成的一些最简单的事情在 CSS 中*完全不可能*时，我不在乎概念纯度是否真的开始受到打击。

现在，我似乎很生气，而且我很生气；我对自己浪费的时间感到愤怒，我对那些从 QuarkXpress 背景出来的人给我无用的固定宽度设计感到愤怒，我对 CSS 的失败承诺感到愤怒。但我并不是要开始争论。我真的很想知道一个简单问题的答案，这个问题将决定我是再尝试一下纯 CSS 的东西还是把它混为一谈，并在我喜欢的时候使用布局表。因为我不想回到布局表，认为如果实际上不是，这件事是不可能的。

问题是这样的：有*没有办法*使用纯CSS布局在左边有一个固定宽度的列，在它的右边放置一个数据表，并让数据表整齐地占据其余部分有什么可用空间？也就是说，通过在左侧单元格上设置宽度为 100% 和固定宽度的两单元格布局表可以轻松实现相同的布局？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-22T04:54:46.900

```
<div style="width: 200px;background-color: #FFFFCC; float: left;">
Left column
</div>

<div style="margin-left: 200px; background-color: #CCFFFF">
Right column
</div> 
```

应该这样做（显然实现会根据它在页面中的位置而有所不同，但我认为这是您正在寻找的概念）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-22T04:26:55.570

这是[你](http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-21-fixed-fluid/)要找的吗？

```
body {
  margin: 0;
  padding: 0;
  border: 0;
  overflow: hidden;
  height: 100%;
  max-height: 100%;
}
#framecontent {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  width: 200px;
  /*Width of frame div*/
  height: 100%;
  overflow: hidden;
  /*Disable scrollbars. Set to "scroll" to enable*/
  background: navy;
  color: white;
}
#maincontent {
  position: fixed;
  top: 0;
  left: 200px;
  /*Set left value to WidthOfFrameDiv*/
  right: 0;
  bottom: 0;
  overflow: auto;
  background: #fff;
}
.innertube {
  margin: 15px;
  /*Margins for inner DIV inside each DIV (to provide padding)*/
}
* html body {
  /*IE6 hack*/
  padding: 0 0 0 200px;
  /*Set value to (0 0 0 WidthOfFrameDiv)*/
}
* html #maincontent {
  /*IE6 hack*/
  height: 100%;
  width: 100%;
}
```

```
<div id="framecontent">
    <div class="innertube">

      <h1>CSS Left Frame Layout</h1>
      <h3>Sample text here</h3>

    </div>
  </div>

  <div id="maincontent">
    <div class="innertube">

      <h1>Dynamic Drive CSS Library</h1>
      <p style="text-align: center">Credits: <a href="http://www.dynamicdrive.com/style/">Dynamic Drive CSS Library</a>
      </p>

    </div>
  </div>
```

我感觉到你的痛苦，但尽量不要把它看作是浪费时间。我相信你对 CSS 的理解比以前要好得多。继续使用它，您将开始看到优势。我个人发现 CSS 是需要大量练习才能精通的东西之一。我使用基于 CSS 的布局已经 5 年了，我仍然每天都在学习有趣的技巧。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-22T04:51:25.550

我想这就是你要找的：

```
<table style='width: 100%;'>
  <tr>
    <td style='width: 200px;'></td>
    <td></td>
  </tr>
</table> 
```

晚点再谢我。=P

（我显然是在开玩笑……有点……）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-05-27T07:12:29.693

为了让这个问题保持最新，这里有 5 种方法可以让你同时使用 CSS2 和 CSS3 来实现相同的目标。

* * *

# 示例 1：浮动和保证金

这就是它多年来的做法：简单而有效。

```
#example1 .fixedColumn {
    width: 180px;
    float: left;
    background: #FCC;
    padding: 10px;
}
#example1 .flexibleColumn {
    margin-left: 200px;
    background: #CFF;
    padding: 10px;
}
```

```
<div id="example1">

    <div class="fixedColumn">
        Fixed Column
    </div>
    <div class="flexibleColumn">
        Flexible Column
    </div>

</div>
```

* * *

# 示例 2：CSS calc();

`calc()`从 IE9 向上工作，尽管对某些版本的 android 浏览器的支持有点不稳定：http: [//caniuse.com/#feat=calc](http://caniuse.com/#feat=calc)

```
#example2.calc {
    overflow: hidden;
}
#example2.calc .fixedColumn {
    width: 180px;
    float: left;   
    background: #FCC;
    padding: 10px; 
}
#example2.calc .flexibleColumn {
    width: calc(100% - 220px); /*200px for the fixed column and 20 for the left and right padding */
    float: left;  
    background: #CFF;
    padding: 10px;
}
```

```
<div id="example2" class="calc">

    <div class="fixedColumn">
        Fixed Column
    </div>
    <div class="flexibleColumn">
        Flexible Column
    </div>

</div>
```

* * *

# 示例 3：CSS 显示为表格

```
#example3.table {
    display: table;   
    width: 100%;
}
#example3.table .fixedColumn {
    width: 180px;
    display: table-cell;   
    background: #FCC;
    padding: 10px;   
}
#example3.table .flexibleColumn {    
    display: table-cell; 
    background: #CFF;
    padding: 10px;  
}
```

```
<div id="example3" class="table">

    <div class="fixedColumn">
        Fixed Column
    </div>
    <div class="flexibleColumn">
        Flexible Column
    </div>

</div>
```

* * *

# 示例 4：CSS3 弹性盒

Flexbox 对跨浏览器的支持出奇的好：http: [//caniuse.com/#search=flex](http://caniuse.com/#search=flex)

```
#example4.flex {
    display: flex;
}
#example4.flex .fixedColumn {
    width: 180px;
    background: #FCC;
    padding: 10px;  
}
#example4.flex .flexibleColumn {
    flex: 1 100%;
    flex-basis: auto;
    background: #CFF;
    padding: 10px; 
}
```

```
<div id="example4" class="flex">

    <div class="fixedColumn">
        Fixed Column
    </div>
    <div class="flexibleColumn">
        Flexible Column
    </div>

</div>
```

* * *

# 示例 5：CSS3 网格

CSS Grid 使 CSS 中的复杂布局变得非常直观和简单。

[http://caniuse.com/#search=grid](http://caniuse.com/#search=grid)

```
#example5.grid {
    display: grid;
    grid-template-columns: 200px 1fr;
}
#example5.grid .fixedColumn {
    grid-column: 1;
    background: #FCC;
    padding: 10px;
}
#example5.grid .flexibleColumn {
    grid-column: 2;
    background: #CFF;
    padding: 10px;
}
```

```
<div id="example5" class="grid">

    <div class="fixedColumn">
        Fixed Column
    </div>
    <div class="flexibleColumn">
        Flexible Column
    </div>

</div>
```

这是一个包含所有 5 种技术的代码笔：

# [2 列（1 个固定，1 个弯曲）5 种不同的方式！](http://codepen.io/chrissp26/pen/GJNBRV)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-22T04:48:47.617

首先，我推荐 Eric Meyer 的 CSS 书籍以及网络上*的*CSS 参考：[A List Apart](http://www.alistapart.com/)。我在工作中广泛使用 CSS，我认为我已经做得很好了。

说了这么多：做有效的事。我经历的正是你刚刚经历的痛苦。最后，我认为仅仅为了能够说我没有使用过桌子而妥协我的设计是不值得的。

请记住：你不是为编写 CSS 而获得报酬的——你是为编写工作软件而获得报酬的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T04:31:04.767

像这样的东西：

```
<div style="position: relative; width: 100%">
    <div style="position: absolute; left: 0; top: 0; width: 200px">
        left column
    </div>
    <div style="position: absolute; left: 200px; top: 0">
         other stuff
    </div>
</div> 
```

当然，您可能应该将样式放在单独的样式表中，而不是内联。左侧的单个固定宽度列相当简单，但偶尔我确实看到其他布局可以使用表格轻松完成，但据我所知，使用 CSS 非常困难。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T05:01:30.430

你可能想试试这些：

[http://www.alistapart.com/stories/practicalcss/](http://www.alistapart.com/stories/practicalcss/)

[http://www.w3.org/2002/03/csslayout-howto](http://www.w3.org/2002/03/csslayout-howto)

原因如下：

[http://en.wikipedia.org/wiki/Tableless_web_design](http://en.wikipedia.org/wiki/Tableless_web_design)

[http://davespicks.com/essays/notables.html](http://davespicks.com/essays/notables.html)

更多操作指南：

```
 div.row {
      clear: both;
      padding-top: 10px;
    }

    div.row span.label {
      float: left;
      width: 100px;
      text-align: right;
    }

    div.row span.formw {
      float: right;
      width: 335px;
      text-align: left;
    }

    <div style="width: 350px; background-color: #cc9;
      border: 1px dotted #333; padding: 5px;
      margin: 0px auto";>
      <form>
        <div class="row">
          <span class="label">Name:</span><span
            class="formw"><input type="text" size="25" /></span>
        </div>
        <div class="row">
          <span class="label">Age:</span><span
            class="formw"><input type="text" size="25" /></span>
        </div>
        <div class="row">
          <span class="label">Shoe size:</span><span
            class="formw"><input type="text" size="25" /></span>
        </div>
        <div class="row">
          <span class="label">Comments:</span><span
              class="formw">
            <textarea cols="25" rows="8">
            Go ahead - write something...
            </textarea>
          </span>
        </div>
        <div class="spacer">
          &nbsp;
        </div>
      </form>
    </div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T04:41:57.567

我喜欢 CSS 仍然需要一整页代码来复制几行使用表格的方式。

在与 CSS 大战之后，我得出结论，“纯粹”在旁观者眼中，并且已经转向更多“让我们只使用有效的方法”的方法。

将 CSS 用于它的好处：让事物看起来很漂亮。尽可能使用 DIV 和 SPAN。但是，如果您发现自己花了一天的时间试图让所有不同的浏览器风格都对齐，那么就在那儿拍一张桌子然后继续前进。别担心，与大多数人的想法相反，小狗实际上不会死。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-22T04:35:30.967

几乎可以肯定有一个答案涉及将 display:table 和 display:table-cell 应用于相关元素。也就是说……不。

# asp.net - 为什么 ASP.NET MVC 视图的某些部分中缺少 Intellisense？

> ID：468039
> 
> 赞同：2
> 
> 时间：2009-01-22T04:25:39.720
> 
> 标签：asp.net, asp.net-mvc

我做错了什么这是 ASP.NET MVC beta 的一个已知问题吗？

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="Index.aspx.cs" Inherits="MyProject.Web.Views.Searching.Index" %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
<%Html.BeginForm("SearchForBusiness", "BusinessSearch", FormMethod.Post); %>
<select id="myid" name="myid">
<%foreach (MyProject.DomainModel.DomainModelCategory.Category cat in ViewData.Model) %>
<%{ %>
<option value="<%=cat.Id %>"><%=cat.CategoryName %></option>
<%} %>
</select>
<input type="submit" value="search" />
<%Html.EndForm(); %>
</asp:Content> 
```

我遇到的麻烦（实际上只是一个烦恼）在 OPTION 行上...cat.Id 没有启用智能感知，但 cat.CategoryName 确实...

我知道它仍然是 Beta 但我想知道是否有人知道它的状态......

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T07:02:04.743

不幸的是，智能感知在 HTML 属性中不起作用。我不知道为什么，只是没有。

当我真的需要 Intellisense 来获取属性值时，我会先在属性之外编写服务器端代码，然后将其剪切粘贴进去。例如，我会这样写：

```
<%=cat.Id %>    
<option value=""><%=cat.CategoryName %></option> 
```

然后剪切粘贴使其看起来像这样

```
<option value="<%=cat.Id %>"><%=cat.CategoryName %></option> 
```

这是一种解决方法，但它有效。

这通常是 ASP.Net 设计器的问题，因此它不是孤立于 MVC 的（它也发生在 WebForms 中）。现在这个问题更加突出，因为越来越多的人使用“<%= %>”标签来构建 HTML（感谢 MVC）。

# .net - 有没有办法在 .NET 中快速将 jpeg 的大小调整为原始大小的 1/8？

> ID：468043
> 
> 赞同：2
> 
> 时间：2009-01-22T04:27:50.623
> 
> 标签：.net, algorithm, image-processing, jpeg

希望尽可能少的损失，因为我听说过一个名叫 Guido Vollbeding 的人提出的实现。标准 GDI+ 似乎没有这种能力，到目前为止我发现的只是规范或完全集成的工具。一个精简的、可插拔的 .NET 组件将是非常可取的。如果我自己实现它，常见的陷阱是什么？

感谢每一个想法和指导！

**编辑**：我的目标是绕过解压缩到 .NET 位图的明显循环，在那里调整它的大小，然后再次压缩它。这篇[文章](http://sylvana.net/jpegcrop/jidctred/)似乎指向了正确的方法，但到目前为止我从未见过任何 .NET 实现

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T04:50:17.753

这很容易使用 .NET Bitmap 类：

```
void ResizeImage(string inFname, string outFname, float scale)
{
    Bitmap bmpOrig = new Bitmap(inFname);
    int w = (int)(scale * bmpOrig.Width);
    int h = (int)(scale * bmpOrig.Height);
    Bitmap bmpNew = new Bitmap(bmpOrig, new Size(w, h));
    bmpNew.Save(outFname, ImageFormat.Jpeg);
} 
```

您需要添加对 System.Drawing 的引用，并在代码中同时使用 System.Drawing 和 System.Drawing.Imaging：

我不能说那会有多少损失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T05:17:44.703

我不知道任何专门处理 1/(2^n) 的算法，但如果你能找到一个，你将需要能够锁定位图上的位（如果你想要任何合理的速度形式）。使用设置/获取像素是个坏主意。

[可点击](http://www.switchonthecode.com/tutorials/csharp-tutorial-convert-a-color-image-to-grayscale "位图锁定文章")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-11T19:40:07.127

将它作为位图加载到内存中，然后获取它的数据并使用不安全的代码，就像用 C++ 一样编写来调整它的大小。[这](https://stackoverflow.com/questions/893283/unsafe-per-pixel-access-30ms-access-for-1756000-pixels)是我学习如何快速调整图像大小的地方（我不认为该链接会调整它们的大小，但它向您展示了如何在 .Net 中编写快速成像代码）

在“反汇编”窗口中设置断点并单步执行代码会告诉你你在做什么。避免任何数组访问，只使用指针，数组访问是 .Net 中紧密性能循环的死亡之吻（因为检查索引是否在边界内，然后有条件跳转以抛出 Every.Single 。 使用权。）

# asp.net - 错误 - SqlDateTime 溢出。必须在 1753 年 1 月 1 日上午 12:00:00 到 9999 年 12 月 31 日晚上 11:59:59 之间

> ID：468045
> 
> 赞同：89
> 
> 时间：2009-01-22T04:29:26.453
> 
> 标签：asp.net, linq-to-sql, sql-server-2008

我一直在使用我编写的这段代码，它以这种最不清楚的方式工作。我希望在数据库中插入一行，其中包含两列 DateTime：

```
myrow.ApprovalDate = DateTime.Now
myrow.ProposedDate = DateTime.Now 
```

然而，当我更新数据库时，我收到了这个错误：

> SqlDateTime 溢出。必须介于 1753 年 1 月 1 日上午 12:00:00 和 9999 年 12 月 31 日晚上 11:59:59 之间。

我什至尝试从数据库中复制插入的值并将其硬编码到正在更新的对象中：

```
// I copied this value from the DB
myrow.ApprovalDate =  Convert.ToDateTime("2008-12-24 00:00:00.000"); 
```

仍然是同样的错误，奇怪的部分是上述技巧适用于第一次插入数据库但从那里失败。有什么想法吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-01-22T05:03:46.477

C# 中的A`DateTime`是值类型，而不是引用类型，因此不能为 null。然而，它可以`DateTime.MinValue`是超出 Sql Servers`DATETIME`数据类型范围的常量。

值类型保证始终具有（默认）值（零），而无需始终显式设置（在本例中为 DateTime.MinValue）。

结论是您可能有一个未设置的 DateTime 值，您正试图将其传递给数据库。

```
DateTime.MinValue = 1/1/0001 12:00:00 AM
DateTime.MaxValue = 23:59:59.9999999, December 31, 9999, 
                    exactly one 100-nanosecond tick 
                    before 00:00:00, January 1, 10000 
```

MSDN：日期时间[.MinValue](http://msdn.microsoft.com/en-us/library/system.datetime.minvalue.aspx)

* * *

关于 Sql Server

> datetime
> 从 1753 年 1 月 1 日到 9999 年 12 月 31 日的日期和时间数据，精度为百分之一秒（相当于 3.33 毫秒或 0.00333 秒）。值四舍五入为 0.000、0.003 或 0.007 秒的增量
> 
> smalldatetime
> 从 1900 年 1 月 1 日到 2079 年 6 月 6 日的日期和时间数据，精确到分钟。29.998 秒或更低的 smalldatetime 值向下舍入到最接近的分钟；29.999 秒或更高的值向上舍入到最接近的分钟。

MSDN：[Sql Server DateTime 和 SmallDateTime](http://msdn.microsoft.com/en-us/library/aa258277(SQL.80).aspx)

* * *

最后，如果您发现自己将 C#`DateTime`作为字符串传递给 sql，则需要将其格式化为保持最大精度并防止 sql server 引发类似错误。

```
string sqlTimeAsString = myDateTime.ToString("yyyy-MM-ddTHH:mm:ss.fff"); 
```

* * *

更新（8 年后）

考虑使用 sql数据类型，它与具有日期范围和时间范围`DateTime2`的 .net 更好地对齐`DateTime``0001-01-01 through 9999-12-31``00:00:00 through 23:59:59.9999999`

```
string dateTime2String = myDateTime.ToString("yyyy-MM-ddTHH:mm:ss.fffffff"); 
```

MSDN [datetime2 (Transact-SQL)](https://msdn.microsoft.com/en-us/library/bb677335.aspx)

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2010-12-16T23:53:18.977

在出现许多与数据库相关的错误后，我发现使用以下方法非常适用于 SQL 最小/最大日期：

```
DateTime rngMin = (DateTime)System.Data.SqlTypes.SqlDateTime.MinValue;

DateTime rngMax = (DateTime)System.Data.SqlTypes.SqlDateTime.MaxValue; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-08-09T03:22:34.827

将 .Net DateTime 与 SqlDateTime.MinValue 或 MaxValue 进行比较时要小心。例如，以下将引发异常：

```
DateTime dte = new DateTime(1000, 1, 1);
if (dte >= SqlDateTime.MinValue)
    //do something 
```

原因是 MinValue 返回的是 SqlDateTime，而不是 DateTime。因此 .Net 尝试将 dte 转换为 SqlDateTime 以进行比较，并且因为它超出了可接受的 SqlDateTime 范围，所以它会引发异常。

一种解决方案是将您的 DateTime 与 SqlDateTime.MinValue 进行比较。**价值**。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-22T05:02:32.923

您为两列提供的代码看起来不错。查找该映射类上的任何其他日期时间列。此外，启用数据上下文的日志记录以查看查询和参数。

```
dc.Log = Console.Out; 
```

DateTime 初始化为 c# 的 0 - 即 0001-01-01。这由 linqtosql 通过 sql 字符串文字传输到数据库：'0001-01-01'。Sql 无法从该日期解析 T-Sql 日期时间。

有几种方法可以解决这个问题：

*   确保使用 SQL 可以处理的值初始化所有日期时间（例如 Sql 的 0 : 1900-01-01 ）
*   确保任何可能偶尔被忽略的日期时间都是可以为**空**的日期时间

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-08-05T11:27:29.163

如果您尝试将*DateTime*类型的变量设置为*null* ，则会发生此错误。将变量声明为可为空，即***DateTime?*** . 这将解决问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-12-17T18:17:38.857

有时为了编写更少的代码，通常会通过将字段的默认值设置为`GETDATE()`或来让 SQL 服务器在插入时设置日期、时间和 ID 等字段`NEWID()`。

在这种情况下，实体类中这些字段的**自动生成值**属性应设置为 true。

这样您就不需要在代码中设置值（防止能源消耗！！！）并且永远不会看到该异常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-13T09:16:32.863

使用扩展方法

```
 public static object ToSafeDbDateDBnull(this object objectstring)
    {
        try
        {
            if ((DateTime)objectstring >= SqlDateTime.MinValue)
            {
                return objectstring;
            }
            else
            {
                return DBNull.Value;
            }
        }
        catch (Exception)
        {

            return DBNull.Value;
        }

    }

DateTime objdte = new DateTime(1000, 1, 1);
dte.ToSafeDbDateDBnull(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T04:56:51.047

这通常意味着一个空值被发布到查询而不是你想要的值，你可能会尝试运行 SQL Profiler 来查看从 linq 传递给 SQL Server 的确切内容。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-21T15:07:42.773

通常在进行 DateTime 转换或解析时会出现这种错误。检查托管应用程序的服务器中的日历设置，主要是时区和短日期格式，并确保将其设置为该位置的正确时区。希望这能解决问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-12-20T15:03:11.223

如果您`DateTime?`在模型中放置 Datetime 可为空的，则它不会引发异常。

在我的情况下，我解决了这样的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-28T15:38:18.807

我看到了同样的事情。该错误不会在插入行时发生，而是在更新时发生。我引用的表有两个 DateTime 列，它们都不能为空。

我已经将场景归结为获取行并立即保存它（没有数据更改）。get 工作正常，但更新失败。

我们正在使用 NHibernate 3.3.1.4000

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-30T15:48:56.797

如果您使用的是 NHibernate，请检查映射中是否将可空的相应 DateTime 属性设置为可空。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-03-18T13:36:31.470

在我的情况下，出现此错误是因为表日期列不可为空

如下：

```
Create Table #TempTable(
 ...
 ApprovalDate datatime not null.
 ...) 
```

为避免此错误，只需使其可空

```
 Create Table #TempTable(
 ...
 ApprovalDate datatime null.
 ...) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-03-06T01:05:31.083

将您的 db 列类型更改为`datetime2`并将其添加到您的查询/命令构造函数中：

```
SqlMapper.AddTypeMap(typeof(DateTime), System.Data.DbType.DateTime2); 
```

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2013-08-30T09:45:20.287

DateTime.MinValue 和 DateTime.MaxValue

```
DateTime.MinValue = 1/1/0001 12:00:00 AM

DateTime.MaxValue = 23:59:59.9999999, December 31, 9999, 

                exactly one 100-nanosecond tick 

                before 00:00:00, January 1, 10000 
```

# php - 按子数组的长度对数组数组进行排序？

> ID：468048
> 
> 赞同：2
> 
> 时间：2009-01-22T04:31:45.653
> 
> 标签：php, arrays, sorting

PHP中根据数组长度对数组进行排序的最佳方法是什么？

例如

```
$parent[0] = array(0, 0, 0);
$parent[2] = array("foo", "bar", "b", "a", "z");
$parent[1] = array(4, 2);

$sorted = sort_by_length($parent)

$sorted[0] = array(4, 2);
$sorted[1] = array(0, 0, 0);
$sorted[2] = array("foo", "bar", "b", "a", "z"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T04:38:52.613

这将起作用：

```
function sort_by_length($arrays) {
    $lengths = array_map('count', $arrays);
    asort($lengths);
    $return = array();
    foreach(array_keys($lengths) as $k)
        $return[$k] = $arrays[$k];
    return $return;
} 
```

请注意，此功能将保留数字键。如果要重置键，请将其包装在对[array_values()](http://www.php.net/array_values)的调用中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T04:39:43.530

我赞成彼得的，但我认为这是另一种方式：

```
function cmp($a1, $a2) {
    if (count($a1) == count($a2)) {
        return 0;
    }
    return (count($a1) < count($a2)) ? -1 : 1;
}

usort($array, "cmp"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T04:36:20.807

仅使用长度作为数组键，然后进行 ksort 怎么样？例如：

```
function sort_by_length($parent) { 
  foreach($parent as $child) {
   $sorted[count($child)] = $child;
  }
  return ksort($sorted);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T04:42:03.713

试试这个`usort`功能：

```
function sortByLength( $arr1, $arr2 )
{
    $c1 = count($arr1);
    $c2 = count($arr2);

    return $c1 < $c2 ? -1 : $c1 == $c2 ? 0 : 1;
}

usort($initial_array,'sortByLength'); 
```

**编辑以尊重参考参数；无论如何，这与@david的答案相同**

# java - Canvas 没有在 Java 中使用窗口调整大小？

> ID：468059
> 
> 赞同：3
> 
> 时间：2009-01-22T04:41:48.300
> 
> 标签：java, swing, awt

我有一个带有 Canvas 的 jFrame。当我在 Windows XP/Vista 中运行我的程序并调整窗口大小时，画布会与窗口一起按比例调整大小。

但是，在 Ubuntu linux 中，当我编译相同的 java 应用程序并调整窗口大小时，Canvas 的大小保持不变。

在 Windows 和 Linux 中，我需要做什么才能使 Canvas 与我的窗口一起调整大小？与差异有什么关系？

**主.java**

```
public class Main {
    public static void main(String[] args)
    {
        JFrame frame = new JFrame("BallBounce");
        frame.setDefaultCloseOperation(Jframe.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new BoxLayout(frame.getContentPane(),BoxLayout.Y_AXIS));

        BallCanvas ballCanvas = new BallCanvas();

        frame.getContentPane().add(ballCanvas);
        frame.getContentPane().add(controlPanel);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

**BallCanvas.java**

```
public class BallCavnas extends Canvas {
    public BallCanvas()
    {
        setPreferredSize(new Dimension(640, 400));
        setIgnoreRepaint(true);

        ... various gui controls are wired up here
    }
    ... rest of canvas code
} 
```

* * *

编辑：我的源代码被压缩在这里以防有人想看看：
[http ://www.filedropper.com/ballbounce](http://www.filedropper.com/ballbounce)

我已经完成了 Dave Ray 的建议，但它仍然没有调整 Canvas 的大小？请记住，当我编译这个 java 程序并在 Windows 中运行它时，它可以很好地调整大小。只有在 linux 中它才会对我这样做。如果重要的话，我也在运行 Java 6 Sun 1.6.0.10 JVM。

[替代文字 http://img158.imageshack.us/img158/7642/screenshotww0.png](http://img158.imageshack.us/img158/7642/screenshotww0.png)

也许我的画布正在通过我的**BufferStrategy/Graphics**不调整大小来调整大小？

编辑 2：从截图来看，它肯定设置为 CENTER：

```
frame.getContentPane().add(ballCanvas, BorderLayout.CENTER);
frame.getContentPane().add(controlPanel, BorderLayout.SOUTH); 
```

* * *

# 解决

显然“画布”正在调整大小，但我用它的缓冲策略做了一些奇怪的事情，它不允许调整 IT 的大小。我修好了它。感谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T05:47:16.030

也许，布局管理器只是试图尊重您的首选尺寸。

我会：

A）删除首选只是为了看看会发生什么（无论如何都不是一个好主意）

或者

B）首先不使用画布，而是使用 JComponent。毕竟 Canvas 是 AWT 组件，我不太确定它们现在是如何工作的。JComponent 是一个轻量级组件，并且由于您使用 JComponent 作为容器，它们会... mmhhh 一起工作得更好？

哎呀..我现在正在给巫毒编程建议。最好去上班。

C) 一直对我有用的东西。通过在我的代码中逐步添加内容来做一个小的概念证明。从空画布开始，然后添加首选大小，然后等等等等。机会是，错误在绘制方法上：P

祝你好运。

:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T04:48:14.373

改用边框布局：

```
frame.getContentPane().setLayout(new BorderLayout());
BallCanvas ballCanvas = new BallCanvas();
frame.getContentPane().add(ballCanvas, BorderLayout.CENTER);            
frame.getContentPane().add(controlPanel, BorderLayout.SOUTH); 
```

也摆脱 setPreferredSize() 支持 frame.setSize() 来设置显示的初始大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-29T00:29:17.633

另一个好的解决方案是将画布放入 JPanel 中，就像我做的那样

```
 panel.add(new JPanel() {

        @Override
        public void paint(Graphics g) {
          // do not paint
        }

    }.add(capture)); 
```

在画布功能中类似于

```
@Override
public void paint(Graphics g) {
    Dimension currentSize = getParent().getSize();
    int width = currentSize.width;
    int height = currentSize.height;
    if (offscreenImage == null || !currentSize.equals(offscreenDimension)) {
        // call the 'java.awt.Component.createImage(...)' method to get an
        // image
        offscreenImage = createImage(width, height);
        offscreenGraphics = offscreenImage.getGraphics();
        offscreenDimension = currentSize;
    }

    if (image != null) {
        offscreenGraphics.drawImage(image, 0, 0, width, height, null);
    } else {
        offscreenGraphics.setColor(Color.BLACK);
        offscreenGraphics.fillRect(0, 0, width, height);
    }
    //scratch image
    g.drawImage(offscreenImage, 0, 0, this);
} 
```

例如。这使它非常简单。带上父面板以满足您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T05:38:57.967

如果你听从了戴夫的建议，尤其是。将 ballCanvas 放在 CENTER 中，那么您必须为 ballCanvas 设置最大尺寸。

# coding-style - The "Should be easy for a junior developer to understand" argument

> ID：468062
> 
> 赞同：32
> 
> 时间：2009-01-22T04:43:35.693
> 
> 标签：coding-style

Does anyone actually think this is a good reason to "Dumb down" your code? When a manager asks you to make your code simple (in terms of technology skills required to understand it) at the cost of more verbose cluttered code what should you do?

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-22T04:49:13.183

I highly disagree. Junior developers will end up being Senior developers. How? By encountering advanced topics that aren't taught in school.

My code base now makes heavy use of **Inversion of Control** containers. I would **never** revert my code to the old way because a junior developer had issues groking IoC. Instead I would take them out for a beer after work and discuss it. The more the junior dev learns the less hand holding needs to be done.

Here's a [blog post](http://elegantcode.com/2008/12/27/thinking-only-of-the-junior-developer/) discussing this very topic.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-22T04:50:54.973

If you're constantly dumbing down your code or designs, it's a pretty good way to make sure your junior developers stay dumb. Challenge them and use it as a mentoring opportunity. Of course, some will never learn, but you've got bigger problems at that point.

It's not just pointy-haired bosses either. As a senior dev, it's often difficult to resist the urge to mommy junior developers. "Oh I'll just do this part because it's way too hard for them", or it'll take them too long, or they'll get way off in the weeds.

And finally, make sure you strike a balance between idiomatic code that uses the full power of a language vs idiomatic code that abuses that power. There's no reason you need to override the || operator just to run its args in two separate threads. At least dumb the code down a little for your older, dumber, future self.

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-22T06:28:32.250

Well, I think it's reasonable to avoid using "clever" language constructs unless they really, really make the code better - at which point if a junior developer sees it, hopefully they'd ask rather than just being flumoxed.

Here's an alternative way of phrasing it though: "Write your code so that it's easy enough to understand that if you get called at 3am and asked to fix a bug in it, *you* can still understand it."

Seriously, make it as easy to understand as possible. That *doesn't* mean a comment every other line - it means a comment where the purpose of a piece of code isn't obvious, and only then where the preferred choice of "well *make* it obvious then" doesn't work.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-22T04:52:34.660

There's a difference between puzzle code and complex code.

I've found that the single biggest issue is that there is a big difference between "easy to understand by reading" versus "well-factored", and that the two goals are often in direct tension with one another. In well-factored code, there is a lot more jumping around between classes and a lot of virtual dispatch, so the path through the code is very non-linear.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-22T04:51:06.830

Yes readability and being able to easily understand code is a big part of maintainability in my opinion.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-22T04:50:27.237

Well if you intend to maintain your code forever, never change jobs, never feel the urge to work on something new, and can assure everyone you will never be hit by a truck, then sure there is no need to dumb down that puzzle code.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-22T04:49:13.683

No. In the past, I've learned a lot from seeing the tricks of more experienced developers. I'd much rather have had the opportunity to learn something new from them than have had them dumb things down for me.

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-22T05:35:00.597

Its a balancing act...
If any 3 people on your team can 'read' your code and know what its doing... no need to change. However if you're the only person who can understand your code (no matter how rad/clever you think it is).. maybe you should take it down a few notches.

Another guideline to help would be to 'Try the simplest thing that works.' All the latest buzz words are nice to know however what it is even more important is having the skill to spot where you could get by without using them. You don't need to spray paint your code with IOC or Frameworks or Design Patterns...

The manager's side of this argument is sorely missed in this thread :) (and for the record.. I'm not one). His/Her major concern being he doesn't want a dark area of code that no one else dares to venture into.. so if you can convince your boss that a few other people on the team can make an arbitrary fix (or better yet.. show an actual bug fixed by someone else) - the mgr should let you off the hook. Disagreeing with your boss is another art :).. but you can talk things out usually.
**You dont have to go all the way backward to Lowest Common Denominator.. strike a balance.**

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-22T13:15:28.200

Your goal should not be for your code to be easy to understand for a junior developer. Instead, it should be easy to understand for a maintainence programmer.

This means:

*   Local "complexity" is okay, when needed. If they see the complex code they'll know they need to dig deeper.
*   Hidden complexity is bad. If you can't see that changing a piece of code will have subtle side effects then maintaining the code will be a nightmare.
*   New technologies that are visible are also okay, when not taken to extremes.

This is because those that maintain code rarely have the same overall understanding of the system. Or the time to develop it.

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-22T04:47:12.970

Yes. It's a very valid reason to take it down a notch. The reality is that a very, very large number of developers (as in most) are at the junior level.

As far as what you should do... Say "Yes Sir" or "Yes Ma'am" and do it. There is only one boss in that relationship.

**UPDATE:** As some people seem to think that having a jr dev learning advanced topics while wading through obfuscated code I want to throw one more thing in here.

When ANY developer (jr or otherwise) runs into code they don’t understand, their first approach is to refactor it into something that is understandable. This is called the “Wow that code is crap I must rewrite it!” syndrome. I’m willing to bet everyone on this board has experienced it. So, as a business owner, do I want to pay for code to be developed each time a new person comes by or do I want to pay for new features to be added?

Guess which person I’m going to keep around longer.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-22T04:53:02.117

I disagree with the manager: What needs to be simple is the code, not the technology used to write it.

I would, however, impose a closely related requirement:

*   The internal documentation states clearly what technologies are needed to understand this code, and it gives references to places where those technologies can be learned.

For example, even as a senior developer, I find all matrix codes baffling. But if somebody gives me a reference to the right part of [Numerical Recipes](http://www.nr.com/), I can puzzle out the details.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-22T04:55:02.487

If you dumb down your code, you're going to be stuck working with dummy junior programmers who will never be familiar with advanced coding techniques. If there's any verbose code that's trying to express an inherently complex procedure that you wrote, the aforementioned junior developer probably wouldn't be able to see the forest for the trees anyways. And they'd probably screw up if they had to express a complex concept if all they knew were basic primitive constructs whereas if they knew how to express what they meant tersely and elegantly, the code has a better chance of being correct.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-22T06:02:47.997

Scott Muc said:

"I've found that the single biggest issue is that there is a big difference between "easy to understand by reading" versus "well-factored", and that the two goals are often in direct tension with one another. In well-factored code, there is a lot more jumping around between classes and a lot of virtual dispatch, so the path through the code is very non-linear."

Quoted for truth, and I think this is one of the biggest problems with C++ code in general. If you're the one that wrote the code, it's pretty easy to come up with a very complicated set of stuff that is well factored, makes lots of sense if you already know it, works well, and generally resembles a diamond crystal, etc. but which, from the perspective of someone who's trying to figure out how you got there and why things are the way they are and how things work, and how one might make changes that fit into the existing system and satisfy new requirements, is almost completely opaque and impenetrable.

How does this kind of situation *help* maintainability? That situation is one of my main beefs with C++ programmers. Far better to have a mess of plain C code which can be hacked upon than a diamond crystal of inpenetrably super-factored code which nearly nobody can figure out how to sensibly modify without smashing the crystalline structure.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-22T06:59:12.127

One way to "dumb down" code that I actually think is an excellent practice is to use longer variable names and longer function names. Naming variables and functions to make their purpose easily understandable is a significant engineering task, IMHO, and takes extra effort on the part of the original author of the code. Damian Conway has some excellent examples in "Perl Best Practices". Some examples include: Prefer "`final_total" to "sum`"; prefer "`previous_appointment" to "previous_elem"`, prefer "`next_client" to "next_elem"`. Prefer "sales_records" to "data"`.` Etc. He also pushes for using grammatical templates (Noun-adjective) and staying consistent. Don't use `max_displacement` one place and then use `VelocityMax` in another. Index variables need real names too:
`sales_record[i] vs sales_record[cancelled_transaction_number]`

I frequently "refactor" my code at the end of a development cycle by finding new names for all my functions and variables. In a modern editor it's trivial to change them all, and it's only at the end that I really figure out what I used them for. "Dumbing down" code this way isn't classic C, but it's easier for me when I come back months later asking WTF did I do?

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-22T04:56:15.917

It depends on the code. Is this something being shipped in your flagship product that requires use of the features your manager wants you to remove for performance reasons? If the answer is yes I would try to have your manager let you keep the code and just write up a document explaining in detail the section of code that is hard to understand. If it's an internal app that needs to be maintained by lots of different people and the complex features can be removed with out negatively affecting the program remove them and pick more important battles to fight.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-22T07:46:32.547

You should just remind your boss that you can build rocket ships or chicken coops, and he will have to pay you the same for either one. Do what they say but generally an environment like that lends itself to people looking for a new environment.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-23T03:38:52.140

I've known developers who wrote highly obfuscated code that they felt was advanced but which the rest of the team felt was unreadable and unmaintainable. Part of this involved overuse of advanced language features (in C, the ternary operator and the comma operator) and writing in an obscure personal idiom (for example, replacing ptr->item with (*ptr).item everywhere) that no-one else would ever be able to maintain. The author was trying to outsmart the optimizer (which to be fair, was far from good).

Note: I'm not suggesting that "x = (p == NULL) ? "default" : p->value;" is complicated, but when someone uses ternary operators that span many lines, are nested, and make heavy use of the comma operator, code quickly becomes unreadable.

In this sort of case, "dumbing down" the code would have been a good idea. The problem was not advanced algorithms nor advanced language features, but overuse and inappropriate use of advanced language features, and an obscure personal idiom.

However, in the case you are asking about, where the manager's changes make the code more difficult to read and maintain, I agree with you and the others who have responded. I just wanted to point out the alternative that no-one else has mentioned.

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-23T04:02:28.037

The old quote is appropriate here:

> Make everything as simple as possible, but not simpler.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-22T04:55:03.657

I suggest keeping the code in a "Geeky-level" and comment it well so that the juniors can understand the intention behind the code and simultaneously learn a better way (or a right way) to code, so we have the best of both he worlds.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-22T05:49:28.103

I think it is the manager's way of politely telling you that your code is too obfuscated/complex/jumbled/puzzle code...whatever you want to call it. Sometimes we get so involved writing our codes that we forget that someone else will have to come along and read it later.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-22T08:00:51.393

I learned it the hard way and, in retrospect, find that it was the better way. Let the cycle repeat itself.

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-22T11:10:22.260

I agree 100% with the argument. With one major addition: Train your junior developers until they understand your code ;-)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-22T11:19:49.060

I'm talking about using "unusual" technologies. In this case it's JQuery. This issue came up when I was writing a wizard control for user registration. The navigation menu needed to be customised and the current step in the wizard had to have a different css class in the menu. This meant I needed to get access to the currently selected step when generating the menu. My solution was to output the current step index in a hidden html field which could then be read by JQuery in order to customise the css.

I thought that this was much nicer and cleaner than using the databinding syntax in ASP.NET which doesn't have compile-time checking and messes up the layout of the html.

The databinding solutions is "standard" while the JQuery one is "unusual" which means that it's less likely to be understood by a junior.

I'm trying more and more these days to provide the required data for the UI rather than hack it into the UI with databinding which is why I added the hidden field with the current step index.

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-23T04:21:11.367

It is simply impossible to make progress or to innovate in any industry without doing things that others don't understand. Innovation is necessarily blasphemous. Why? Because if you're doing things that make sense to everyone else around you, the odds are you're not the first one doing it. ;)

That being said, there is a significant difference between doing something that is difficult to understand simply because it's a new or complicated problem versus doing something that's difficult to understand because you're trying to show off or you think confusing people will somehow gain you job security (which I've never seen work, but I've heard of people trying).

Should you make things easy to understand? Yes absolutely, as much as humanly possible. However a program that works and does its job well is the higher priority.

The manager's complaint should never be "don't do this because our junior guys don't understand it" -- it should only ever be "do x instead of y whenever feasible because x is easier to read / understand". This also assumes that x and y are equivalent (accept the same input and produce the same result).

I can't stand when managers do that... I've had three different managers bawl me out for using perfectly normal code the way it was designed to work, not because I was doing anything complicated, but rather only because they felt like it was too much effort for the other guys on our team to go RTFM on the language we were using. As a management strategy, that's totally backwards. It's like being the Holy Roman Catholic church and insisting that the laymen are too dumb to be trusted with literacy.

If you want to know really how ridiculous some of these managers get, try this: I had one manager bawl me out for declaring a variable as a type of "boolean" because he didn't feel the other programmers could handle it. Actually when I asked why, his answer was "because we don't do that here", which is a non-answer, but I interpreted it to mean "dumb it down". They were also berating me for that and similar practices as though it should be obvious that good programming habits were actually "bad" and that I should already know why even though they had never expressed a preferred programming style (either formally or informally). Needless to say, it was a bad job.

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-23T20:48:58.503

Make sure you can understand what it does 6 months down the road.

When in doubt, COMMENT your code. That's what comments are for.

# javascript - 设置 CDO.Message 选项时使用的 f(x) = y JScript 惯用语的 JavaScript 友好替代方案

> ID：468089
> 
> 赞同：1
> 
> 时间：2009-01-22T04:59:51.867
> 
> 标签：javascript, email, asp-classic, cdo.message

我有一个用 JScript 编写的 ASP 页面，它使用 CDO.Message 发送电子邮件。为了指定 SMTP 服务器（和其他选项），我正在做这样的事情：

```
mail.Configuration.Fields.Item(
    "http://schemas.microsoft.com/cdo/configuration/smtpserver") =
    "smtp.example.com"; 
```

现在，问题来了。我将此代码放在一个独立的包含文件中，该文件作为 JavaScript 包含在 HTML 页面中，以便我可以在浏览器中针对它运行单元测试（使用 JsUnit 等）。我有 JavaScript 模拟对象（服务器、请求等），它们为包含的 JScript 代码创建模拟 ASP 环境。我剩下的唯一问题是 CDO.Message 选项设置。由于`f(x) = y`上述代码摘录中使用的语法不是有效的 JavaScript（无效的左操作数），我无法在浏览器中运行这段代码（原样）。我目前只是在我的单元测试中使用检测环境是否是真正的 ASP 的条件绕过它。

我认为没有 JavaScript 解决方法。我正在寻找一种替代语法（可能以不同方式使用 ActiveX 接口）来设置 CDO.Message 选项，该选项在语法上也是有效的 JavaScript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T17:24:33.987

[在查看http://msdn.microsoft.com/en-us/library/ms526318(EXCHG.10).aspx](http://msdn.microsoft.com/en-us/library/ms526318%28EXCHG.10%29.aspx)上的 C++ 代码示例时，我找到了答案。

解决方案是明确地对`Value`属性进行分配：

```
mail.Configuration.Fields.Item(
    "http://schemas.microsoft.com/cdo/configuration/smtpserver").Value =
    "smtp.example.com"; 
```

这样，上面的代码是有效的 JavaScript，可以使用模拟配置对象进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T06:06:53.637

在为 IIS 编写服务器端 Javascript 时，我遇到了同样的问题，该`f(x) = y`语法在我的 IDE 语法检查器中失败。我发现有用的解决方案是 JScript 条件注释，如下所示：

```
f(x)/*@cc_on@if(0)*/[0]/*@end@*/ = y; 
```

它将下标索引 [0] 放在末尾，*除非*在 Microsoft 的 JScript 引擎中运行。但是，不可否认，我的解决方案有点老套。我认为在大多数情况下，你的更干净，所以感谢分享。

-西蒙

# c++ - 如何重构此代码层次结构（与得墨忒耳法则有关）

> ID：468090
> 
> 赞同：3
> 
> 时间：2009-01-22T05:00:23.723
> 
> 标签：c++, oop, refactoring, law-of-demeter

我有一个游戏引擎，我将物理模拟与游戏对象功能分开。所以我有一个物理身体的纯虚拟课程

```
class Body 
```

我将从中推导出物理模拟的各种实现。我的游戏对象类看起来像

```
class GameObject {
public:
   // ...
private:
   Body *m_pBody;
}; 
```

我可以插入该特定游戏所需的任何实现。但是`Body`当我只有一个`GameObject`. 所以我发现自己写了很多东西，比如

```
Vector GameObject::GetPosition() const { return m_pBody->GetPosition(); } 
```

我很想把所有这些都抓起来，然后做类似的事情

```
pObject->GetBody()->GetPosition(); 
```

但这似乎是错误的（即违反了得墨忒耳法则）。另外，它只是将详细程度从实现推到了使用。所以我正在寻找一种不同的方式来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T05:11:48.583

您可以采取的一种方法是将`Body`接口拆分为多个接口，每个接口都有不同的用途，并`GameObject`仅授予它必须公开的接口的所有权。

```
class Positionable;
class Movable;
class Collidable;
//etc. 
```

具体`Body`实现可能会实现所有接口，但`GameObject`只需要公开其位置的只会引用（通过依赖注入）`Positionable`接口：

```
class BodyA : public Positionable, Movable, Collidable {
    // ...
};

class GameObjectA {
private:
    Positionable *m_p;
public:
    GameObjectA(Positionable *p) { m_p = p; }
    Positionable *getPosition() { return m_p; }
};

BodyA bodyA;
GameObjectA objA(&bodyA);

objA->getPosition()->getX(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T08:37:53.003

The idea of the law of Demeter is that your `GameObject` isn't supposed to have functions like `GetPosition()`. Instead it's supposed to have `MoveForward(int)` or `TurnLeft()` functions that may call `GetPosition()` (along with other functions) internally. Essentially they translate one interface into another.

If your logic requires a `GetPosition()` function, then it makes sense turn that into an interface a la Ates Goral. Otherwise you'll need to rethink why you're grabbing so deeply into an object to call methods on its subobjects.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T06:08:06.410

游戏层次结构不应涉及大量继承。我无法将您指向任何网页，但这是我从多个来源收集到的感觉，其中最著名的是游戏宝石系列。

You can have hierarchies like ship->tie_fighter, ship->x_wing. But not PlaysSound->tie_fighter. Your tie_fighter class should be composed of the objects it needs to represent itself. A physics part, a graphics part, etc. You should provide a minimal interface for interacting with your game objects. Implement as much physics logic in the engine or in the physic piece.

With this approach your game objects become collections of more basic game components.

All that said, you will want to be able to set a game objects physical state during game events. So you'll end up with problem you described for setting the various pieces of state. It's just icky but that is best solution I've found so far.

I've recently tried to make higher level state functions, using ideas from Box2D. Have a function SetXForm for setting positions etc. Another for SetDXForm for velocities and angular velocity. These functions take proxy objects as parameters that represent the various parts of the physical state. Using methods like these you could reduce the number of methods you'd need to set state but in the end you'd probably still end up implementing the finer grained ones, and the proxy objects would be more work than you would save by skipping out on a few methods.

So, I didn't help that much. This was more a rebuttal of the previous answer.

In summary, I would recommend you stick with the many method approach. There may not always be a simple one to 1 relationship between game objects and physic objects. We ran into that where it was much simpler to have one game object represent all of the particles from an explosion. If we had given in and just exposed a body pointer, we would not have been able to simplify the problem.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T06:53:14.243

Do I understand correctly that you're separating the physics of something from it's game representation?

i.e, would you see something like this:

```
class CompanionCube
{
    private:
        Body* m_pPhysicsBody;
}; 
```

?

If so, that smells wrong to me. Technically your 'GameObject' *is* a physics object, so it should derive from Body.

It sounds like you're planning on swapping physics models around and that's why you're attempting to do it via aggregation, and if that's the case, I'd ask: "Do you plan on swapping physics types at runtime, or compile time?".

If compile time is your answer, I'd derive your game objects from Body, and make Body a typedef to whichever physics body you want to have be the default.

If it's runtime, you'd have to write a 'Body' class that does that switching internally, which might not be a bad idea if your goal is to play around with different physics.

Alternatively, you'll probably find you'll have different 'parent' classes for Body depending on the type of game object (water, rigid body, etc), so you could just make that explicit in your derivation.

Anyhow, I'll stop rambling since this answer is based on a lot of guesswork. ;) Let me know if I'm off base, and I'll delete my answer.

# visual-studio - 在 Visual Studio 2008 中构建特定解决方案后，有没有办法运行外部可执行文件？

> ID：468092
> 
> 赞同：2
> 
> 时间：2009-01-22T05:01:54.203
> 
> 标签：visual-studio, build, macros, solution

[我和这个线程](https://stackoverflow.com/questions/177188/is-there-a-way-to-run-an-outside-executable-after-a-solution-is-built-in-visual)中提出的问题相同，即我正在寻找一种在 Visual Studio 中构建解决方案后运行可执行文件或脚本的方法。

我尝试了使用宏捕获 OnBuildDone 事件的建议解决方案，该宏（据我了解）需要放置在宏 IDE 中 MyMacros 下的 EnvironmentEvents 部分中。这样做的问题是它使宏对我在 Visual Studio 中所做的一切都是全局的。换句话说，无论我正在构建哪种解决方案，它都会运行宏。但是，我只希望它为那个解决方案运行。

有没有办法制作一个仅针对特定解决方案捕获 OnBuildDone 事件的宏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T05:13:39.780

一种方法是：

*   在该解决方案中定义一个新的、失败的空项目
*   指定这个新项目依赖于所有其他项目（这样这个新项目将在所有其他项目之后构建）
*   调用您的可执行文件或脚本作为这个新**项目**的构建事件（而不是解决方案）

# svn - git 日志输出，如 svn ls -v

> ID：468106
> 
> 赞同：6
> 
> 时间：2009-01-22T05:08:18.917
> 
> 标签：svn, git

有没有办法让 git 像 svn ls -v 那样给我输出。基本上是每个文件的列表以及最后一次编辑该文件的人？像这样：

```
filea.txt     Someone Else
fileb.txt     Another Person 
```

也许甚至使用 SHA 来识别更改发生的提交？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T14:08:57.423

在 git 中问这不是一个很自然的问题，但是您可能可以通过这样的方式实现您想要的东西。

```
for a in $(ls); do git log --pretty=format:"%h%x09%an%x09%ad%x09$a" -1 -- "$a"; done 
```

这将遍历当前目录中的每个文件并对其执行 a`git log`以找到影响它的最后一个提交。

它不是很有效，因为它搜索每个文件的 git 历史记录，并且不努力重用以前搜索的结果。然而，它是单行的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T05:47:59.650

你想玩弄[git log](http://git-scm.com/docs/git-log)及其漂亮的格式。这是一个示例，它不能完全解决您想要的问题，但应该可以帮助您：

```
git log --pretty=format:"%h: %s -- %an" 
```

印刷：

```
...
58a2e46: Added readme for github. -- DylanFM
... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T13:41:34.503

问题是：你为什么需要它？目前 git 缺少可以执行“svn ls -v”等效的单个命令，并且您必须编写一些脚本：我认为“git log -1 -- $filename”的想法是最简单的解决方案（术语要编写的脚本行数）；如果会，它可能会是“git blame”。

但我想有另一种方法可以解决您使用“svn ls -v”解决的问题。

还请记住，对于非线性历史，上次更改文件的概念并不是明确的。

# firefox - 如何在 firefox XUL 文档中使用 usemap

> ID：468112
> 
> 赞同：0
> 
> 时间：2009-01-22T05:15:15.877
> 
> 标签：firefox, xul, imagemap

在我的 XUL 中，我有以下代码片段：

```
<map name="KeypadMap">
<area href="javascript:pad('A')" coords="1,1,31,31" shape="rect"/>
</map>
...
<hbox flex="1">
 <image src="./keypad.png" width="32" height="32" useMap="#KeypadMap"/>
</hbox> 
```

图像显示得很好，但是，当我将鼠标悬停时，光标不会变为手形，并且单击不会调用 pad 函数。

类似的代码在纯 HTML 中运行良好，因此必须有一些技巧才能通过 Firefox XUL 文件使其运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T05:23:37.420

您必须使用命名空间在 XUL 中嵌入 HTML。检查本[指南](https://developer.mozilla.org/en/XUL_Tutorial/Adding_HTML_Elements)。

# filesystems - 如何预测 ISO 9660 文件系统的大小？

> ID：468117
> 
> 赞同：7
> 
> 时间：2009-01-22T05:20:15.290
> 
> 标签：filesystems, dvd-burning, iso9660

我正在将数据存档到 DVD，并且我想将 DVD 打包完整。我知道 DVD 上所有我想要的文件的名称和大小，但我不知道元数据占用了多少空间。我想在每张 DVD 上获取尽可能多的文件，所以我使用了带有贪婪装箱的 Bubblesearch 启发式算法。我尝试了 10,000 种替代方法，并获得了最好的一种。目前我知道所有文件的大小，因为我不知道文件是如何存储在 ISO 9660 文件系统中的，所以我为元数据添加了很多内容。我想减少污水。

我可以使用`genisoimage -print-size`，但它太慢了——假设 40,000 个文件占用 500MB，大约需要 3 秒。每张 DVD 花费 8 小时是不可能的。我之前修改过`genisoimage`源代码，真的不热衷于尝试将算法从源代码中挤出来；我希望有人知道一种更好的方法来进行估算，或者可以为我指出一个有用的规范。

* * *

澄清问题和问题：

*   我需要刻录分散在多张 DVD 上的档案，通常一次大约五个。我要解决的问题是决定将哪些文件放在每张 DVD 上，以便每张 DVD（最后一张除外）尽可能满。这个问题是 NP 难的。

*   我正在使用标准贪婪打包算法，您首先放置最大的文件，然后将其放入第一张有足够空间的 DVD 中。所以j_random_hacker，我绝对*不是*从随机开始的。我从排序开始，并使用 Bubblesearch 来扰乱文件打包的顺序。此程序将我的包装从估计容量的 80% 左右提高到估计容量的 99.5% 以上。这个问题是关于**更好地估计容量**；目前我的估计容量低于实际容量。

*   我编写了一个尝试 10,000 次扰动的程序，每个扰动都涉及两个步骤：

    1.  选择一组文件
    2.  估计这些文件将在 DVD 上占用多少空间

    第 2 步是我要改进的步骤。目前，正如 Tyler D 所暗示的那样，我“谨慎行事”。但我想做得更好。我用不起，`genisomage -print-size`因为它太慢了。同样，我无法将文件 tar 到磁盘，因为它太慢了，但是 tar 文件的大小与 ISO 9660 映像不同。这是我需要预测的 ISO 9660 图像的大小。原则上这可以完全准确地完成，但我不知道该怎么做。这就是问题所在。

* * *

注意：这些文件位于具有 3TB 硬盘存储空间的机器上。在所有情况下，文件的平均大小至少为 10MB；有时它明显更大。所以毕竟它可能`genisomage`会足够快，但我怀疑它 - 它似乎可以通过将 ISO 映像写入 /dev/null 来工作，我无法想象当图像大小接近时它会足够快4.7GB。我现在无法访问那台机器，或者当我发布原始问题时。当我晚上可以访问时，我会尝试为这个问题获得更好的数字。但我认为这不会`genisomage`是一个好的解决方案——尽管它可能是学习文件系统模型的好方法，它告诉我它是如何工作的。知道块大小为 2KB 已经很有帮助。

知道同一目录中的文件被刻录到 samae DVD 也可能很有用，这简化了搜索。我想直接访问文件，这排除了 tar-before-burning。（大多数文件是音频或视频，这意味着尝试用 . 来打击它们是没有意义的`gzip`。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:28:19.620

我不确定你目前是如何做到这一点的——根据我的谷歌搜索，“Bubblesearch”是指一​​种选择在某种意义上*接近*贪婪排序的项目排序方式，但在你的情况下，将文件添加到 DVD 不会改变空间要求，因此这种方法会浪费时间考虑多个不同的订单，这些订单相当于同一**组**文件。

换句话说，如果您正在执行以下操作来生成候选文件列表：

1.  随机打乱文件列表。
2.  从列表顶部开始，贪婪地选择所有您认为 DVD 适合的文件，直到不再适合。

然后，您搜索解决方案空间的效率很低——对于任何*n 个*文件的最终候选集，您可能正在考虑所有*n*！制作该套装的方法。我的建议：

1.  按文件大小的降序对所有文件进行排序。
2.  将顶部（最大）文件标记为“包含”，并将其从列表中删除。（它必须包含在某些 DVD 中，所以我们不妨现在就包含它。）
3.  列表中最上面的文件是否可以包含在（估计的）ISO 文件系统大小不超过 DVD 容量的情况下？如果是这样的话：
    *   以概率*p*（例如*p* = 0.5），将文件标记为“包含”。
4.  从列表中删除最上面的文件。
5.  如果列表现在为空，则您有一个候选文件列表。否则，转到 3。

重复此多次并选择最佳文件列表。

Tyler D 的建议也很好：如果您有 ~40000 个文件，总计 ~500Mb，这意味着平均文件大小为 12.5Kb。ISO 9660 使用 2Kb 的块大小，这意味着这些文件平均浪费了 1Kb 的磁盘空间，大约是它们大小的 8%。因此，首先将它们与 tar 打包在一起将节省大约 8% 的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T15:54:18.100

感谢您的详细更新。我很满意您当前的装箱策略非常有效。

至于问题，“对于总共*b*字节的*n 个文件，ISO 9660 文件系统**究竟*需要多少开销？” 只有两个可能的答案：

 **1.  有人已经编写了一个有效的工具来精确测量这一点。然而，快速的谷歌搜索却一无所获，这令人沮丧。SO上的某个人可能会回复他们自制工具的链接，但如果你几天没有收到更多回复，那么这可能也已经结束了。
2.  您需要阅读[现成的 ISO 9660 规范](http://www.ecma-international.org/publications/standards/Ecma-119.htm)并自己构建这样的工具。

其实还有第三个答案：

(3) 您并不真正关心使用每张 DVD 上的每个*最后一个字节。*在这种情况下，抓取一小部分具有代表性的不同大小的文件（比如 5 个），填充它们直到它们是 2048 字节的倍数，然后将所有 2^5 个可能的子集放入`genisoimage -print-size`. 然后在该数据集上拟合方程*nx + y = iso_size - total_input_size*，其中*n* = 给定运行中的文件数，找到*x*，它是每个文件的开销字节数，和*y*，它是常数开销（不包含文件的 ISO 9660 文件系统的大小）。圆*x*和*y*up 并使用该公式来估计给定文件集的 ISO 文件系统大小。为了安全起见，请确保使用集合中出现的最长文件名作为测试文件名，并将每个文件名放在与集合中最深层次结构一样深的单独目录层次结构下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T06:39:45.253

不能使用 tar 将文件存储在磁盘上？目前尚不清楚您是在编写程序来执行此操作，还是只是进行一些备份。

也许做一些实验并谨慎行事 - 磁盘上的一些可用空间不会受到伤害。

不知何故，我想你已经考虑过这些，或者我的回答没有抓住重点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:59:38.910

我最近进行了一项实验，以找到一个公式来对 dvds 进行类似的填充估计，并在给出一些假设的情况下找到了一个简单的公式......从你原来的帖子来看，这个公式对你来说可能是一个很低的数字，听起来你有多个目录和更长的文件名。

假设：

*   所有文件都是 8.3 个字符。
*   所有文件都在根目录中。
*   没有诸如 Joliet 之类的扩展。

公式：

```
174 + floor(count / 42) + sum( ceil(file_size / 2048) ) 
```

*   count 是文件数
*   file_size 是每个文件的大小（以字节为单位）
*   结果是 2048 字节块。

一个示例脚本：

```
#!/usr/bin/perl -w
use strict;
use POSIX;

sub sum {
    my $out = 0;
    for(@_) {
        $out += $_;
    }
    return $out;
}

my @sizes = ( 2048 ) x 1000;
my $file_count = @sizes;

my $data_size = sum(map { ceil($_ / 2048) } @sizes);
my $dir_size = floor( $file_count / 42 ) + 1;
my $overhead = 173;

my $size = $overhead + $dir_size + $data_size;

$\ = "\n";
print $size; 
```

我在具有多达 150k 个文件的磁盘上验证了这一点，文件大小从 200 字节到 1 MiB 不等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T03:47:50.250

好主意，J. Random。当然我不需要每个最后一个字节，这主要是为了好玩（以及在午餐时吹牛的权利）。我希望能够`du`在 CD-ROM 上键入并使其非常接近 4700000000。

我查看了 ECMA 规范，但与大多数规范一样，它是中等痛苦的，我对自己能否正确处理它没有信心。此外，它似乎没有讨论 Rock Ridge 扩展，或者如果有，我错过了。

我喜欢你的想法#3，并认为我会更进一步：我将尝试构建一个相当丰富的模型，然后`genisoimage -print-size`在多个文件集上使用来估计模型的参数。然后我可以使用该模型进行估计。这是一个爱好项目，所以需要一段时间，但我最终会解决它。我将在这里发布一个答案，说明消除了多少浪费！

# c# - 在 .NET 中计算目录大小的最佳方法是什么？

> ID：468119
> 
> 赞同：82
> 
> 时间：2009-01-22T05:21:16.647
> 
> 标签：c#, .net, windows

我编写了以下例程来手动遍历目录并在 C#/.NET 中计算其大小：

```
 protected static float CalculateFolderSize(string folder)
{
    float folderSize = 0.0f;
    try
    {
        //Checks if the path is valid or not
        if (!Directory.Exists(folder))
            return folderSize;
        else
        {
            try
            {
                foreach (string file in Directory.GetFiles(folder))
                {
                    if (File.Exists(file))
                    {
                        FileInfo finfo = new FileInfo(file);
                        folderSize += finfo.Length;
                    }
                }

                foreach (string dir in Directory.GetDirectories(folder))
                    folderSize += CalculateFolderSize(dir);
            }
            catch (NotSupportedException e)
            {
                Console.WriteLine("Unable to calculate folder size: {0}", e.Message);
            }
        }
    }
    catch (UnauthorizedAccessException e)
    {
        Console.WriteLine("Unable to calculate folder size: {0}", e.Message);
    }
    return folderSize;
} 

```

我有一个应用程序为大量文件夹重复运行此例程。我想知道是否有更有效的方法来计算.NET 文件夹的大小？我没有在框架中看到任何具体内容。我应该使用 P/Invoke 和 Win32 API 吗？在 .NET 中计算文件夹大小的最有效方法是什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-01-22T05:28:17.770

不，这看起来像是计算目录大小的[推荐方法，相关方法如下：](https://msdn.microsoft.com/en-us/library/system.io.directory(v=vs.100).aspx)

```
public static long DirSize(DirectoryInfo d) 
{    
    long size = 0;    
    // Add file sizes.
    FileInfo[] fis = d.GetFiles();
    foreach (FileInfo fi in fis) 
    {      
        size += fi.Length;    
    }
    // Add subdirectory sizes.
    DirectoryInfo[] dis = d.GetDirectories();
    foreach (DirectoryInfo di in dis) 
    {
        size += DirSize(di);   
    }
    return size;  
} 
```

您可以使用 root 调用：

```
Console.WriteLine("The size is {0} bytes.", DirSize(new DirectoryInfo(targetFolder)); 
```

...`targetFolder`要计算的文件夹大小在哪里。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2014-03-01T06:54:33.147

```
DirectoryInfo dirInfo = new DirectoryInfo(@strDirPath);
long dirSize = await Task.Run(() => dirInfo.EnumerateFiles( "*", SearchOption.AllDirectories).Sum(file => file.Length)); 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-01-22T05:42:26.447

我不相信有一个 Win32 API 来计算一个目录消耗的空间，尽管我对此有待纠正。如果有的话，我会假设 Explorer 会使用它。如果您在资源管理器中获得大型目录的属性，则为您提供文件夹大小所需的时间与其包含的文件/子目录的数量成正比。

你的日常工作看起来相当整洁和简单。请记住，您计算的是文件长度的总和，而不是磁盘上消耗的实际空间。集群末尾浪费的空间、文件流等所消耗的空间将被忽略。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-05-24T19:26:10.173

```
public static long DirSize(DirectoryInfo dir)
{
    return dir.GetFiles().Sum(fi => fi.Length) +
           dir.GetDirectories().Sum(di => DirSize(di));
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-09-05T03:04:42.593

### 真正的问题是，*您打算将大小用于*什么？

您的*第一个*问题是“文件大小”*至少有**四个***定义：

*   “文件结尾”偏移量，即从文件开头到结尾必须跳过的字节数。
    换句话说，它是文件中*逻辑上*的字节数（从使用角度来看）。

*   “有效数据长度”，等于*未实际存储*的第一个字节的偏移量。
    这总是小于或等于“文件结尾”，并且是簇大小的倍数。
    例如，一个 1 GB 的文件可以有 1 MB 的有效数据长度。如果您要求 Windows 读取前 8 MB，它将读取前 1 MB 并假装其余数据在那里，并将其返回为零。

*   文件的“分配大小”。这总是大于或等于“文件结尾”。
    这是操作系统为文件分配的簇数乘以簇大小。
    与“文件结尾”大于“有效数据长度”的情况不同，多余的字节**不**被视为文件数据的一部分，因此如果您尝试读入，操作系统*不会*用零填充缓冲区超出文件末尾的分配区域。

*   文件的“压缩大小”，仅对压缩（和稀疏？）文件有效。
    它等于簇的大小乘以卷上*实际分配*给该文件的簇数。
    对于非压缩和非稀疏文件，没有“压缩大小”的概念；您将改用“分配的大小”。

您的*第二个*问题是“文件”之类的`C:\Foo`实际上可以有多个*数据流*。
此名称仅指*默认*流。一个文件可能有*备用*流，例如`C:\Foo:Bar`，其大小甚至没有显示在资源管理器中！

您的*第三个*问题是“文件”可以*有多个名称*（“硬链接”）。
例如，`C:\Windows\notepad.exe`和是*同一个*文件 `C:\Windows\System32\notepad.exe`的两个*名称。**任何*名称都可用于打开文件的*任何*流。

 ***您的*第四个*问题是“文件”（或目录）实际上可能甚至不是文件（或目录）：
它可能是其他文件的*软链接*（“符号链接”或“重解析点”）（或目录）。
该其他文件甚至可能不在同一个驱动器上。它甚至可能指向网络上的某些东西，或者它甚至可能是递归的！如果它是递归的，大小应该是无穷大吗？

您的*第五个*是“过滤器”驱动程序使某些文件或目录*看起来*像实际的文件或目录，即使它们不是。例如，可以使用名为 ImageX 的工具将 Microsoft 的 WIM 图像文件（已压缩）“挂载”到文件夹中，这些文件看起来*不像*重解析点或链接。它们看起来就像目录——除了它们实际上不是目录，而且“大小”的概念对它们没有意义。

您的*第六个*问题是每个文件都需要元数据。
例如，同一个文件有 10 个名称需要更多元数据，这需要空间。如果文件名很短，拥有 10 个名称可能与拥有 1 个名称一样便宜 - 如果文件名很长，则拥有多个名称可以*为元数据*使用更多磁盘空间。（同一个故事有多个流，等等）
你也算这些吗？

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2015-09-02T23:40:26.473

```
var size = new DirectoryInfo("E:\\").GetDirectorySize(); 
```

这是此扩展方法背后的代码

```
public static long GetDirectorySize(this System.IO.DirectoryInfo directoryInfo, bool recursive = true)
{
    var startDirectorySize = default(long);
    if (directoryInfo == null || !directoryInfo.Exists)
        return startDirectorySize; //Return 0 while Directory does not exist.

    //Add size of files in the Current Directory to main size.
    foreach (var fileInfo in directoryInfo.GetFiles())
        System.Threading.Interlocked.Add(ref startDirectorySize, fileInfo.Length);

    if (recursive) //Loop on Sub Direcotries in the Current Directory and Calculate it's files size.
        System.Threading.Tasks.Parallel.ForEach(directoryInfo.GetDirectories(), (subDirectory) =>
    System.Threading.Interlocked.Add(ref startDirectorySize, GetDirectorySize(subDirectory, recursive)));

    return startDirectorySize;  //Return full Size of this Directory.
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-08-28T06:47:57.183

更多更快！添加 COM 引用“Windows 脚本宿主对象...”

```
public double GetWSHFolderSize(string Fldr)
    {
        //Reference "Windows Script Host Object Model" on the COM tab.
        IWshRuntimeLibrary.FileSystemObject FSO = new     IWshRuntimeLibrary.FileSystemObject();
        double FldrSize = (double)FSO.GetFolder(Fldr).Size;
        Marshal.FinalReleaseComObject(FSO);
        return FldrSize;
    }
private void button1_Click(object sender, EventArgs e)
        {
            string folderPath = @"C:\Windows";
        Stopwatch sWatch = new Stopwatch();

        sWatch.Start();
        double sizeOfDir = GetWSHFolderSize(folderPath);
        sWatch.Stop();
        MessageBox.Show("Directory size in Bytes : " + sizeOfDir + ", Time: " + sWatch.ElapsedMilliseconds.ToString());
          } 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-06-17T10:45:33.577

看来，以下方法比递归函数更快地执行您的任务：

```
long size = 0;
DirectoryInfo dir = new DirectoryInfo(folder);
foreach (FileInfo fi in dir.GetFiles("*.*", SearchOption.AllDirectories))
{
   size += fi.Length;
} 
```

一个简单的控制台应用程序测试表明，这个循环比递归函数更快地对文件求和，并提供相同的结果。您可能希望使用 LINQ 方法（如 Sum()）来缩短此代码。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-08-22T19:18:56.783

这个解决方案效果很好。它正在收集所有子文件夹：

```
Directory.GetFiles(@"MainFolderPath", "*", SearchOption.AllDirectories).Sum(t => (new FileInfo(t).Length)); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-22T05:49:25.950

这是计算目录大小的最佳方法。只有其他方式仍会使用递归，但更容易使用并且不那么灵活。

```
float folderSize = 0.0f;
FileInfo[] files = Directory.GetFiles(folder, "*", SearchOption.AllDirectories);
foreach(FileInfo file in files) folderSize += file.Length; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-06-13T08:18:56.673

直到最近我一直在摆弄 VS2008 和 LINQ，这种紧凑而简短的方法对我来说非常有用（例如在 VB.NET 中；当然需要 LINQ / .NET FW 3.5+）：

```
Dim size As Int64 = (From strFile In My.Computer.FileSystem.GetFiles(strFolder, _
              FileIO.SearchOption.SearchAllSubDirectories) _
              Select New System.IO.FileInfo(strFile).Length).Sum() 
```

简而言之，它会搜索子目录，如果您了解 LINQ 语法，则很容易理解。您甚至可以使用 .GetFiles 函数的第三个参数指定通配符来搜索特定文件。

我不是 C# 专家，但您可以通过[这种方式](http://msdn.microsoft.com/en-us/library/ms173136.aspx)在 C# 上添加 My 命名空间。

我认为这种获取文件夹大小的方式不仅比 Hao 的[链接](http://msdn.microsoft.com/en-us/library/system.io.directory.aspx)上描述的方式更短、更现代，而且它基本上使用了最后描述的相同的循环 FileInfo 方法。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-01-22T17:16:30.163

我使用相同的计数原则扩展了@Hao 的答案，但支持更丰富的数据返回，因此您可以返回大小、递归大小、目录计数和递归目录计数，N 级深。

```
public class DiskSizeUtil
{
    /// <summary>
    /// Calculate disk space usage under <paramref name="root"/>.  If <paramref name="levels"/> is provided, 
    /// then return subdirectory disk usages as well, up to <paramref name="levels"/> levels deep.
    /// If levels is not provided or is 0, return a list with a single element representing the
    /// directory specified by <paramref name="root"/>.
    /// </summary>
    /// <returns></returns>
    public static FolderSizeInfo GetDirectorySize(DirectoryInfo root, int levels = 0)
    {
        var currentDirectory = new FolderSizeInfo();

        // Add file sizes.
        FileInfo[] fis = root.GetFiles();
        currentDirectory.Size = 0;
        foreach (FileInfo fi in fis)
        {
            currentDirectory.Size += fi.Length;
        }

        // Add subdirectory sizes.
        DirectoryInfo[] dis = root.GetDirectories();

        currentDirectory.Path = root;
        currentDirectory.SizeWithChildren = currentDirectory.Size;
        currentDirectory.DirectoryCount = dis.Length;
        currentDirectory.DirectoryCountWithChildren = dis.Length;
        currentDirectory.FileCount = fis.Length;
        currentDirectory.FileCountWithChildren = fis.Length;

        if (levels >= 0)
            currentDirectory.Children = new List<FolderSizeInfo>();

        foreach (DirectoryInfo di in dis)
        {
            var dd = GetDirectorySize(di, levels - 1);
            if (levels >= 0)
                currentDirectory.Children.Add(dd);

            currentDirectory.SizeWithChildren += dd.SizeWithChildren;
            currentDirectory.DirectoryCountWithChildren += dd.DirectoryCountWithChildren;
            currentDirectory.FileCountWithChildren += dd.FileCountWithChildren;
        }

        return currentDirectory;
    }

    public class FolderSizeInfo
    {
        public DirectoryInfo Path { get; set; }
        public long SizeWithChildren { get; set; }
        public long Size { get; set; }
        public int DirectoryCount { get; set; }
        public int DirectoryCountWithChildren { get; set; }
        public int FileCount { get; set; }
        public int FileCountWithChildren { get; set; }
        public List<FolderSizeInfo> Children { get; set; }
    }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-09-11T12:35:54.683

```
public static long GetDirSize(string path)
{
    try
    {
        return Directory.EnumerateFiles(path).Sum(x => new FileInfo(x).Length)  
            +
               Directory.EnumerateDirectories(path).Sum(x => GetDirSize(x));
    }
    catch
    {
        return 0L;
    }
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-22T05:51:27.943

就最佳算法而言，您可能做对了。我建议您解开递归函数并使用自己的堆栈（请记住堆栈溢出是 .Net 2.0+ 应用程序中的世界末日，IIRC 无法捕获异常）。

最重要的是，如果您在任何形式的 UI 中使用它，请将其放在工作线程上，该工作线程向 UI 线程发出更新信号。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-08-08T09:21:33.667

为了提高性能，您可以使用任务并行库 (TPL)。这是一个很好的示例：[目录文件大小计算 - 如何使其更快？](https://stackoverflow.com/questions/2979432/directory-file-size-calculation-how-to-make-it-faster)

我没有测试，但是作者说它比非多线程方法快3倍......

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-08-21T05:41:07.473

```
Directory.GetFiles(@"C:\Users\AliBayat","*",SearchOption.AllDirectories)
.Select (d => new FileInfo(d))
.Select (d => new { Directory = d.DirectoryName,FileSize = d.Length} )
.ToLookup (d => d.Directory )
.Select (d => new { Directory = d.Key,TotalSizeInMB =Math.Round(d.Select (x =>x.FileSize)
.Sum () /Math.Pow(1024.0,2),2)})
.OrderByDescending (d => d.TotalSizeInMB).ToList(); 
```

调用`GetFiles`with返回指定目录`SearchOption.AllDirectories`中所有文件的全名。`subdirectories`OS 以字节为单位表示文件的大小。您可以从其 Length 属性中检索文件的大小。将其除以 1024 的 2 次方，即可得出文件的大小（以兆字节为单位）。因为目录/文件夹可以包含许多文件，所以`d.Select(x => x.FileSize)`返回以兆字节为单位的文件大小的集合。最后调用`Sum()`查找指定目录中文件的总大小。

更新： filterMask=" *.* " 不适用于没有扩展名的文件

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-09-06T22:54:52.860

Trikaldarshi 的单线解决方案的替代方案。（它避免了构造 FileInfo 对象）

```
long sizeInBytes = Directory.EnumerateFiles("{path}","*", SearchOption.AllDirectories).Sum(fileInfo => new FileInfo(fileInfo).Length); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-09-09T06:55:03.430

我想出的最快方法是使用 EnumerateFiles 和 SearchOption.AllDirectories。此方法还允许在浏览文件并计算大小时更新 UI。长路径名不会导致任何问题，因为不会尝试为长路径名创建 FileInfo 或 DirectoryInfo。在枚举文件时，即使文件名很长，只要起始目录名不太长，EnumerateFiles 返回的 FileInfo 就不会导致问题。UnauthorizedAccess 仍然存在问题。

```
 private void DirectoryCountEnumTest(string sourceDirName)
    {
        // Get the subdirectories for the specified directory.
        long dataSize = 0;
        long fileCount = 0;
        string prevText = richTextBox1.Text;

        if (Directory.Exists(sourceDirName))
        {
            DirectoryInfo dir = new DirectoryInfo(sourceDirName);
            foreach (FileInfo file in dir.EnumerateFiles("*", SearchOption.AllDirectories))
            {
                fileCount++;
                try
                {
                    dataSize += file.Length;
                    richTextBox1.Text = prevText + ("\nCounting size: " + dataSize.ToString());
                }
                catch (Exception e)
                {
                    richTextBox1.AppendText("\n" + e.Message);
                }
            }
            richTextBox1.AppendText("\n files:" + fileCount.ToString());
        }
    } 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-02-26T09:16:12.447

这个 .NET 核心命令行应用在这里计算给定路径的目录大小：

[https://github.com/garethrbrown/folder-size](https://github.com/garethrbrown/folder-size)

关键方法是递归检查子目录以得出总大小的方法。

```
private static long DirectorySize(SortDirection sortDirection, DirectoryInfo directoryInfo, DirectoryData directoryData)
{
        long directorySizeBytes = 0;

        // Add file sizes for current directory

        FileInfo[] fileInfos = directoryInfo.GetFiles();

        foreach (FileInfo fileInfo in fileInfos)
        {
            directorySizeBytes += fileInfo.Length;
        }

        directoryData.Name = directoryInfo.Name;

        directoryData.SizeBytes += directorySizeBytes;

        // Recursively add subdirectory sizes

        DirectoryInfo[] subDirectories = directoryInfo.GetDirectories();

        foreach (DirectoryInfo di in subDirectories)
        {
            var subDirectoryData = new DirectoryData(sortDirection);

            directoryData.DirectoryDatas.Add(subDirectoryData);

            directorySizeBytes += DirectorySize(sortDirection, di, subDirectoryData);
        }

        directoryData.SizeBytes = directorySizeBytes;

        return directorySizeBytes;
    }
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-12-03T07:54:32.337

[从Microsoft Docs](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/how-to-write-a-simple-parallel-for-loop)计算目录大小的多线程示例，这会更快

```
using System;
using System.IO;
using System.Threading;
using System.Threading.Tasks;

public class Example
{
   public static void Main()
   {
      long totalSize = 0;

      String[] args = Environment.GetCommandLineArgs();
      if (args.Length == 1) {
         Console.WriteLine("There are no command line arguments.");
         return;
      }
      if (! Directory.Exists(args[1])) {
         Console.WriteLine("The directory does not exist.");
         return;
      }

      String[] files = Directory.GetFiles(args[1]);
      Parallel.For(0, files.Length,
                   index => { FileInfo fi = new FileInfo(files[index]);
                              long size = fi.Length;
                              Interlocked.Add(ref totalSize, size);
                   } );
      Console.WriteLine("Directory '{0}':", args[1]);
      Console.WriteLine("{0:N0} files, {1:N0} bytes", files.Length, totalSize);
   }
}
// The example displaysoutput like the following:
//       Directory 'c:\windows\':
//       32 files, 6,587,222 bytes 
```

这个例子只计算当前文件夹中的文件，所以如果你想递归计算所有文件，你可以改变

```
String[] files = Directory.GetFiles(args[1]); 
```

到

```
String[] files = Directory.GetFiles(args[1], "*", SearchOption.AllDirectories); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-06-02T01:14:19.683

我尝试更改样本（Alexandre Pepin 和 hao 的回答）

原样

```
 private long GetDirectorySize(string dirPath)
    {
        if (Directory.Exists(dirPath) == false)
        {
            return 0;
        }

        DirectoryInfo dirInfo = new DirectoryInfo(dirPath);

        long size = 0;

        // Add file sizes.
        FileInfo[] fis = dirInfo.GetFiles();
        foreach (FileInfo fi in fis)
        {
            size += fi.Length;
        }

        // Add subdirectory sizes.
        DirectoryInfo[] dis = dirInfo.GetDirectories();
        foreach (DirectoryInfo di in dis)
        {
            size += GetDirectorySize(di.FullName);
        }

        return size;
    } 
```

成为

```
 private long GetDirectorySize2(string dirPath)
    {
        if (Directory.Exists(dirPath) == false)
        {
            return 0;
        }

        DirectoryInfo dirInfo = new DirectoryInfo(dirPath);

        long size = 0;

        // Add file sizes.
        IEnumerable<FileInfo> fis = dirInfo.EnumerateFiles("*.*", SearchOption.AllDirectories);
        foreach (FileInfo fi in fis)
        {
            size += fi.Length;
        }

        return size;
    } 
```

最后你可以检查结果

```
 // ---------------------------------------------
        // size of directory
        using System.IO;

        string log1Path = @"D:\SampleDirPath1";
        string log2Path = @"D:\SampleDirPath2";
        string log1DirName = Path.GetDirectoryName(log1Path);
        string log2DirName = Path.GetDirectoryName(log2Path);
        long log1Size = GetDirectorySize(log1Path);
        long log2Size = GetDirectorySize(log2Path);
        long log1Size2 = GetDirectorySize2(log1Path);
        long log2Size2 = GetDirectorySize2(log2Path);

        Console.WriteLine($@"{log1DirName} Size: {SizeSuffix(log1Size)}, {SizeSuffix(log1Size2)}
        {log2DirName} Size: {SizeSuffix(log2Size)}, {SizeSuffix(log2Size2)}"); 
```

这是 SizeSuffix 函数

```
 private static readonly string[] SizeSuffixes =
               { "bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB" };

    /// <summary>
    /// Size Display
    /// </summary>
    /// <param name="value">bytes 數值&lt;/param>
    /// <param name="decimalPlaces">小數位數</param>
    /// <returns></returns>
    public static string SizeSuffix(Int64 value, int decimalPlaces = 2)
    {
        if (decimalPlaces < 0) { throw new ArgumentOutOfRangeException("decimalPlaces"); }
        if (value < 0) { return "-" + SizeSuffix(-value); }
        if (value == 0) { return string.Format("{0:n" + decimalPlaces + "} bytes", 0); }

        // mag is 0 for bytes, 1 for KB, 2, for MB, etc.
        int mag = (int)Math.Log(value, 1024);

        // 1L << (mag * 10) == 2 ^ (10 * mag) 
        // [i.e. the number of bytes in the unit corresponding to mag]
        decimal adjustedSize = (decimal)value / (1L << (mag * 10));

        // make adjustment when the value is large enough that
        // it would round up to 1000 or more
        if (Math.Round(adjustedSize, decimalPlaces) >= 1000)
        {
            mag += 1;
            adjustedSize /= 1024;
        }

        return string.Format("{0:n" + decimalPlaces + "} {1}",
            adjustedSize,
            SizeSuffixes[mag]);
    } 
```

* * *

## 回答 #22

> 赞同：-4
> 
> 时间：2019-05-17T22:25:07.697

我知道这不是 .net 解决方案，但无论如何它都来了。对于拥有 Windows 10 并想要更快解决方案的人来说，它可能会派上用场。例如，如果您在命令提示符下运行此命令或按`winKey + R`：

```
bash -c "du -sh /mnt/c/Users/; sleep 5" 
```

*这样`sleep 5`您就有时间查看结果并且窗口不会关闭*

在我的电脑上显示：

[![在此处输入图像描述](https://i.stack.imgur.com/cR7KX.png)](https://i.stack.imgur.com/cR7KX.png)

请注意最后它如何显示 85G（85 GB）。与使用 .Net 相比，它的速度非常快。如果您想更准确地查看大小，请删除`h`代表人类可读的大小。

所以只是做类似的事情，`Processes.Start("bash",... arguments)`这不是确切的代码，但你明白了。

# asp.net - 在类库的配置文件中指定连接字符串并在 ASP.NET Web 应用程序中重用/修改

> ID：468120
> 
> 赞同：0
> 
> 时间：2009-01-22T05:22:17.843
> 
> 标签：asp.net, app-config, configuration-files, class-library

如何在类库的配置文件中指定连接字符串，然后在 ASP.NET Web 应用程序中使用时对其进行修改？

类库是一个数据访问层，它有一个基于配置文件 (Settings.settings/app.config) 中指定的连接字符串连接到数据库的数据集。

该类库用于用户输入数据并使用类库中公开的 DAL 类和方法写入数据库的 Web 应用程序。

现在，我想将此应用程序从开发环境迁移到测试环境，然后再迁移到生产环境。我面临的问题是迁移到测试后，测试中的应用程序仍然连接到开发数据库。我已经更改了**<class library>.dll.config**文件中提到的连接字符串，但这似乎没有影响。

有人可以解释实现这一目标的正确方法吗？提前感谢您的帮助。干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T05:28:07.037

对于 .config 文件，名称必须与主执行程序集相匹配。例如，我遇到了像您这样的情况，我需要一个类库来将其设置保存在 .dll.config 文件中。虽然它能够引用它，但实际的应用程序将无法读取配置文件，因为它需要 .exe.config。将 .dll.config 重命名为 .exe.config 解决了该问题。

在您的情况下，将连接字符串从 .dll.config 迁移到 web.config 应该可以解决您的问题！

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T14:04:28.233

约书亚是部分正确的......对于后人，我想在这个答案中添加更多内容，因为我曾多次遇到相同的问题。首先，必须考虑他们的架构。基于部署的 ASP.NET 中的 .config 文件可能会遇到几个问题。

考虑到架构的影响：

单层（一台服务器）：一个简单的 Web 应用程序可能能够利用对站点 Web.config 文件的引用并解决您的问题。对于单层应用程序来说，这将是一个很好的解决方案。在将 Windows 应用程序用作 .exe 文件的情况下，App.config 也可以工作。

多层（多台服务器）：这是我第一次跨边界使用 .config 文件时事情变得有点棘手的地方。记住配置结构的层次结构并牢记这一点（[关于 .Config 结构的 MSDN 文章](http://msdn.microsoft.com/en-us/library/w7w4sb0w%28v=VS.100%29.aspx)) - 在相应的 ASP.NET 文件夹的根目录中有一个 machine.config。它们驻留在每个物理服务器上。这些被站点 Web.config（或 App.config）覆盖，而这些站点又被子文件夹 .config 文件覆盖。如果您有多个 .config 文件，您可能希望使用其中一种方法来传递您要使用的特定 .config 的文件路径。更重要的是，这些文件每个都可能有连接信息。ASP.NET 的 machine.config 包含一些框架......所以你至少应该对这是一个“继承”链的事实保持敏感。其次，部署后对 Web.config 文件的任何更改都会通知应用程序重新启动。这将导致状态丢失（如果您在网站上有活跃用户，那就不好了）。解决此问题的方法是保留一个单独的 .config 文件（例如，connections.config）。config) 并将对该文件的引用放在 Web.config 中。这将允许您更改连接信息（例如密码），而无需重新启动应用程序。这是更多信息的链接：[MSDN：使用配置文件](http://msdn.microsoft.com/en-US/library/ms254494%28v=vs.110%29.aspx). 本文列出了在普通服务器/IIS 部署的应用程序中需要注意的所有细节。请记住，.config 文件主要用于应用程序，而不是库。如果您有多个层，那么您可能正在使用一些通信/消息传递层（例如 WCF）。这将有/允许它自己的Web.config。您可以将连接字符串保留在那里（并在需要时对其进行加密），但更好的是，将它们放在 Web.config 引用的第二个文件中以便于管理。最后一点，如果您要考虑云，则为应用程序部署打包 .config 文件，这实际上消除了它们在“无需重新启动或重新部署”方面提供的所有好处。Azure 部署需要考虑这篇文章来避免维护的噩梦： [Bill Lodin 博客 - Azul/Cloud 中的配置文件](http://blogs.itmentors.com/bill/2009/11/04/configuration-files-and-windows-azure/)。本文还有一点——关于如何根据部署以编程方式选择配置的好例子！如果您想增加在云端或云端部署的灵活性，请务必检查一下。

我希望这些要点可以节省大家的时间和头痛。我知道我浪费了几天的编程时间来处理这些问题......而且很难在一个地方找到所有可能的应用程序没有“实现”其连接对象的原因。希望这将使你们所有人免于和我一样的命运。

# castle-activerecord - Castle.ActiveRecord 中的懒惰阅读

> ID：468124
> 
> 赞同：0
> 
> 时间：2009-01-22T05:24:56.700
> 
> 标签：castle-activerecord, database

我正在编写一个应用程序，它需要定期（例如每周）循环遍历数据库中的几百万条记录并在每一行的结果上执行代码。

由于表太大，我怀疑当我调用 SomeObject.FindAll() 时，它正在读取所有 140 万行并试图返回 SomeObject[] 中的所有行。

有没有办法可以执行 SomeObject.FindAll() 表达式，但以更 DBMS 友好的方式加载值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T19:56:22.353

不使用`FindAll()`- 正如您所推测的那样，它会尝试一次加载指定类型的所有实例（并且，根据您设置 NHibernate 的方式，可能会发出大量 SQL 查询来执行此操作） .

延迟加载仅适用于对象的属性，因此，例如，如果您有一个持久类型`SomeObjectContainer`，它具有一个映射列表作为属性`SomeObject`，它应该匹配所有`SomeObject`s 和 with `lazy="true"`，然后`foreach`在该列表属性上执行一个，您d得到你想要的，有点; 默认情况下，NHibernate 会为列表中的每个元素发出一个查询，一次只加载一个。当然，读取缓存会变得巨大，因此您可能需要大量刷新。

您可以做的是发出一个 HQL（甚至是嵌入式 SQL）查询来检索所有 SomeObjects 的所有 ID，然后一次循环遍历 ID，使用 FindByPrimaryKey 获取相关对象。同样，它不是特别优雅。

老实说，在这种情况下，我可能会将其变成存储过程中的计划维护工作——除非你真的必须在对象上运行*代码*而不是以某种方式操纵数据。它可能会惹恼对象纯粹主义者，但有时存储过程是正确的方法，尤其是在这种批处理作业场景中。

# c++ - 关于手动内存管理和深度复制的新手问题

> ID：468134
> 
> 赞同：1
> 
> 时间：2009-01-22T05:32:03.287
> 
> 标签：c++, memory-management, deep-copy

好的，所以我是第一次尝试 C++，因为看起来我将不得不在即将到来的大学课程中使用它。我有几年的编程经验，但在非垃圾收集领域并不多。

我有一个类，一个用于双向链表的节点。所以基本上它有一个值和两个指向其他节点的指针。主构造函数看起来像`Node(const std::string & val, Node * prev, Node * next)`. 该练习包括一个复制构造函数，该构造函数对另一个节点进行浅拷贝，并在其上方添加一条注释，说明将其更改为深拷贝。

这就是我认为的意思：

```
Node(const Node & other)
      : value(other.value)
{
  prev = new Node(other.prev->value, other.prev->prev, other.prev->next);
  next = new Node(other.next->value, other.next->prev, other.next->next);
} 
```

这似乎实现了使更改复制的节点不会影响新节点的目标。但是，当我这样做时，我在堆上分配新的东西。这让我很担心，因为我认为这意味着我也应该在节点的析构函数中删除它。但这现在与另一个构造函数不一致，其中指向节点的指针刚刚传入，已经指向某些东西。我不能在这种情况下正确地进入析`delete`构函数，对吗？`next``prev`

我真的很困惑，感谢指导！

编辑：这是代码（在我上面的更改之前），根据要求：

```
#include <string>

//! Node implements a doubly-linked list node
class Node {
    friend class LinkedList;  //!< LinkedList can access private members of Node
public:

    //!  Constructor
    Node(const std::string & v, Node * p, Node * n) :
      value(v), prev(p), next(n)
    {
    }

    //! Change to deep copy
    Node(const Node & other) :
      value(other.value), prev(other.prev), next(other.next)
    {
    }

    //!  Read-only public methods for use by clients of the LinkedList class
    const std::string & GetValue() const
    {
      return value;
    }

    Node * GetPrevious()const
    {
      return prev;
    }

    Node * GetNext()const
    {
      return next;
    }

    //! Change to deep copy
    Node & operator=(const Node & other)
    {
        if(this!=&other)
        {
            value=other.value;
            prev=other.prev;
            next=other.next;
        }
        return *this;
    }

 private:
    std::string value;        //!< value stored in the node
    Node * prev;            //!< pointer to previous node in the list
    Node * next;            //!< pointer to next node in the list
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T05:51:31.670

通常“深拷贝”涉及遍历数据结构并复制整个事物。在您的情况下，给定一个节点，制作列表的完整副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T06:02:52.193

深拷贝制作结构的完整拷贝。我所说的结构是指协同工作以执行任务的对象的集合。如果您有一个汽车类，其中每个车轮和车身都有一个对象 - 深度副本将复制整个汽车（并复制车轮和车身）。

在您的情况下，“整个结构”是列表。只有在“列表级别”执行深层复制操作才有意义。节点的深层副本将复制节点指向的数据 - 但不会将自己分配为列表的一部分（因为节点应该不知道“主”列表对象）。

```
List* List::CopyList()
{
    List* nlist = new List();
    ListNode* node = NULL, prev = NULL;
    ListNode* newNodes = new ListNode[m_nodeCount];
    int i = 0;
    while ((node == NULL && node = m_first) || (node = node->Next()) != NULL)
    {
        newNodes[i] = node->CopyNode(); // also makes a new copy of the node's data
        newNodes[i]->SetNext(NULL);
        newNodes[i]->SetPrev(prev);
        if (prev) prev->SetNext(newNodes[i]);
        prev = newNodes[i];
        ++i;
    }

    if (m_len > 0)
        nlist->SetFirst(newNodes[i]);
    if (m_len > 1)
        nlist->SetLast(newNodes[m_len - 1]);
    return nlist;
} 
```

注意：我只是从我的屁股中提取了那个代码，所以它没有经过测试。希望它有所帮助:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T06:28:14.687

首先，我不太确定应该如何理解练习的目标。副本应该有多深？在像你这样的解决方案中，`this->next->next`仍然`other.next->next`是同样的事情。这个对象也应该被复制吗？清单的其余部分？它在哪里结束？当然可以深度复制整个列表，但我认为这将是单个节点的复制构造函数的一种非常出乎意料的行为。

也许`value`成员变量是一个指针，应该被深度复制？这对我来说更有意义。

但回到你的解释：

```
Node a(...);
// ... more code that adds a whole list to a
Node b(a); 
```

您的实施存在两个问题。为一个`b->next->prev`点到`a`，而我怀疑它应该点回`b`。其次，您需要考虑极端情况，其中`a`可能是列表中的第一个或最后一个节点。

对于你的主要问题：你当然是对的，新创建的对象需要`delete`再次被 d 。无论您只是复制`prev`and`next`节点还是整个列表，我都会说该副本的用户有责任再次删除所有复制的节点。我假设对于一个正常的、未复制的列表，该列表的用户将遍历所有节点，并在完成列表后一个接一个地手动删除它们。他不会假设一个节点的析构函数会删除整个列表。副本也是如此，它们的行为应该相同。复制内容的用户应删除所有副本。（在实践中，您可能会有一个`list`类，它为您完成所有节点管理）。

但是同样，如果节点的复制构造函数复制整个列表，甚至只是其中的几个节点，这将是非常出乎意料的，人们总是会忘记清理所有这些副本。但这不是你的节点类的错，而是练习要求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T06:28:20.473

你的担心是对的。

通过将指针传递给 Node 构造函数，没有关于随指针传递的所有权信息。这是构造函数的糟糕设计。要么你应该传递一个引用来表明你不拥有下一个节点，要么传递一个 std::auto_ptr<> 来表明你必须拥有所有权。有人可能会争辩说 next 或 prev 可能是 NULL（列表的开头或结尾），因此您不能使用引用，但这可以通过使用替代构造函数来克服。

当然也有例外：
Node 类是否是另一个类的私有成员。如果是这种情况，Node 类的使用完全由所有者控制，因此其正确使用将由所属类控制。

您没有提供的是析构函数的定义。有了这个，我们将能够判断节点是否实际上拥有传递给构造函数的指针的所有权（或者 next 和 prev 是否​​已经是智能指针）？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T12:12:15.610

如果每个节点都复制它指向的节点，那么您可以安全地删除析构函数中的对象。如果您要传递指针（作为构造函数 Node(const std::string & v, Node * p, Node * n)），那么您不会“拥有”指针，也不应该删除它们。如果这是链表类的一部分，那么该类应该拥有指针并根据需要删除对象。您还可以使 Node 成为链表类的私有子类，以避免用户（或您自己）弄乱您的指针。

您在实现中的递归也犯了一个错误，复制构造函数包含一层深层复制并调用“普通”构造函数，该构造函数采用指针，使其变浅。这意味着您的深度复制只有一层深度。它应该重复调用复制构造函数，如下所示：

```
Node(const Node & other) : value(other.value)
{
  prev = new Node(*(other.prev));
  next = new Node(*(other.next));
} 
```

AFAIK 虽然在这里使用深拷贝没有任何好处，但我能想到的唯一实际应用是在复制整个列表时，这可以在表示所述列表的类中更有效地处理。

# php - CodeIgniter 表单验证 - 将结果作为“数组”而不是“字符串”获取

> ID：468139
> 
> 赞同：16
> 
> 时间：2009-01-22T05:35:35.073
> 
> 标签：php, codeigniter

我正在使用 CodeIgniter 编写表单验证类。有什么方法可以让我在名称值对中收到错误消息？例如，在示例表单中有四个字段：`user_name`、`password`、`password_conf`和`timezone`。其中`user_name`，`password`执行以下操作后验证失败：

```
$result = $this->form_validation->run(); 
```

如果上面的函数返回 false，我想得到名称值对中的错误，如下所示：

```
Array
{
  'user_name' => 'user name is required',
  'password' => 'passord is required'
} 
```

我真的想形成一个 JSON，我可以将它传递回 AJAX 调用。我有一个（肮脏的）解决方案：我可以像下面这样一个一个地调用验证方法：

```
$this->form_validation->required($user_name);
$this->form_validation->required($password); 
```

有没有其他方法可以**一次**在名称值对中获取所有错误消息？

**编辑**：有人建议我从答案之一中使用 jQuery 进行验证：

**jQuery 将有助于客户端验证，但服务器端呢，我正在使用 CodeIgniter 验证。**

我设计它是为了：

1.  我使用 AJAX 发布所有值。
2.  在服务器端（PHP）验证。
3.  如果输入有效，则执行所需的操作；否则返回错误给用户。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-22T15:05:59.397

通过查看 CodeIgniter 代码，我自己找到了一种方法：我扩展了 CI_Form_validation 库，例如：-

```
class MY_Form_validation extends CI_Form_validation
{
    public function getErrorsArray()
    {
        return $this->_error_array;
    }
} 
```

我知道，这是一个 hack，但会满足我的时间需求。我希望 CodeIginter 团队很快能提供一个访问该数组的接口。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-13T20:02:05.587

你可以简单地使用，

`$this->form_validation->error_array();`

这是来自 CodeIgniter 的[类参考文档](https://www.codeigniter.com/userguide3/libraries/form_validation.html#class-reference)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:35:55.223

我最喜欢的解决方案不涉及在任何地方添加函数或扩展验证库：

```
$validator =& _get_validation_object();
$error_messages = $validator->_error_array; 
```

参考：[http ://thesimplesynthesis.com/post/how-to-get-form-validation-errors-as-an-array-in-codeigniter/](http://thesimplesynthesis.com/post/how-to-get-form-validation-errors-as-an-array-in-codeigniter/)

您应该可以在代码中的任何位置调用它。此外，值得注意的是还有一个[更新的线程](https://stackoverflow.com/questions/4676915/form-validation-errors-into-array/15550338)也讨论了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-08T18:13:46.170

您可以在控制器中创建私有函数

```
 private function return_form_validation_error($input)
{
    $output = array();
    foreach ($input as $key => $value)
    {
        $output[$key] = form_error($key);
    }
    return $output;
} 
```

然后在您的验证方法中，只需调用它，这是我的

```
public function add_cat_form()
    {
        $this->output->unset_template();
        $this->load->library('form_validation');
        $this->form_validation->set_rules('name', 'Name', 'required');
        if ($this->form_validation->run())
        {
            if (IS_AJAX)
            {
                $dataForInsert = $this->input->post();
                if ($dataForInsert['parentid'] == -1)
                {
                    unset($dataForInsert['parentid']);
                }
                $this->post_model->add_cat($dataForInsert);
                echo json_encode('success');
            } else
            {
                #in case of not using AJAX, the AJAX const defined
            }
        } else
        {
            if (IS_AJAX)
            {
                #This will be return form_validation error in an array
                $output = $this->return_form_validation_error($this->input->post());
                echo $output = json_encode($output);
            } else
            {
                #in case of not using AJAX, the AJAX const defined
            }
        }
    }
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T11:22:56.807

看到代码点火器验证会在正常页面刷新时为您提供错误消息，使用像[jquery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)这样的东西会更好吗？它将在发送表单之前完全验证客户端？这样就不需要 AJAX。

编辑：我不是建议不要进行服务器端验证，只是为了验证而使用 AJAX 发布是没有必要的，如果你在客户端进行它会减少服务器命中。它将优雅地降级为常规页面刷新，并显示错误或成功消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-24T04:29:23.383

已经有一个正确的答案，但我认为这个更容易理解如何执行这个过程。

在您的**控制器中执行此操作**

```
$this->form_validation->set_rules('username', 'Username', 'required');
$this->form_validation->set_rules('password', 'Password', 'required');
if($this->form_validation->run() === FALSE){
    $data['error'] = validation_errors();
}else{
  //success
}
echo json_encode($data); 
```

在你的**JS中做**

```
success:function(response){
 if(response.error){
  $('#notif').html(response.error); 
 }else{
   //do stuff here...
 }
} 
```

最后在你的js中显示与给定id对应的错误。

在您的**HTML中执行此操作**

```
<span id="notif"></span> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-10T07:53:25.493

这可能为时已晚，但我想分享一个我使用过的解决方案，希望它能让其他人受益。

Unfortunately, CodeIgniter's `$this->form_validation->error_array()` method returns only the errors that emanate from the `set_rules()` method. It does not account for the name of the form field that generated the error. However, we can leverage another of CodeIgniter's method `$this->form_validation->error()`, which returns the error(s) associated with a particular form field, by passing the name of the field as parameter.

```
//form validation rules
$this->form_validation->set_rules('f_name', 'First Name', 'trim|required', 
    ['required' => 'First Name is required']
);
$this->form_validation->set_rules('l_name', 'Last Name', 'trim|required', 
    ['required' => 'Last Name is required']
);
$this->form_validation->set_rules('email', 'Email', 'trim|required|valid_email|is_unique[users.email]', 
    [
        'required'      => 'Email is required',
        'valid_email'   => 'Email format is invalid',
        'is_unique'     => 'Email already exists'
    ]
);
$error_arr = []; //array to hold the errors
//array of form field names
$field_names= ['f_name', 'l_name', 'email'];
//Iterate through the form fields to build a field=error associative pair.
foreach ($field_names as $field) {
    $error = $this->form_validation->error($field);
    //field has error?
    if (strlen($error)) $error_arr[$field] = $error;
}

//print_r($error_arr); 
```

# language-agnostic - 类型和类有什么区别？

> ID：468145
> 
> 赞同：179
> 
> 时间：2009-01-22T05:44:04.213
> 
> 标签：language-agnostic, class, programming-languages, types, glossary

是什么让类型与类不同，反之亦然？

（在一般语言不可知的意义上）

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-04-20T17:58:31.873

以下答案来自 Gof 书（[设计模式](https://amazon.co.uk/dp/0201633612)）

> 对象的**类**定义了对象的实现方式。该类定义对象的内部状态及其操作的实现。

> 相反，一个对象的 **类型**只指它的接口——它可以响应的一组请求。

> 一个对象可以有多种类型，不同类的对象可以有相同的类型。

```
//example in c++
template<typename T> 
const T & max(T const &a,T const &b)
{
return a>b?a:b;  //> operator of the type is used for comparison
} 
```

max 函数需要一个具有**操作 >**的类型，它具有自己的类型作为接口之一，任何满足上述要求的类都可以用于为该类生成特定的 max<特定类/原始类型> 函数。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-01-22T06:25:12.850

我一直认为“类型”是“类”和“原始”的总称。

`int foo; // Type is int, class is nonexistent.`

`MyClass foo; // Type is MyClass, class is MyClass`

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2014-08-04T08:44:21.960

灵感来自[维基百科](http://en.wikipedia.org/wiki/Class_%28computer_programming%29)...

在**类型论**方面；

*   **类型**是一个抽象接口。
    类型一般代表名词，例如人、地点或事物，或名词化的事物，

*   一个**类**表示该类型的一个实现。
    它是一个具体的数据结构和子程序的集合

    不同的具体类可以产生相同抽象类型的对象（取决于类型系统）。

    *例如，可以使用两个*类来实现该**类型* ：（对于小堆栈来说速度很快，但扩展性很差）和（对于小堆栈来说扩展性很好但开销很大）。*`Stack`*`SmallStack``ScalableStack`*

     *同样，一个给定的类可能有几个不同的**构造函数**。* 

 *> ![在此处输入图像描述](https://i.stack.imgur.com/bbFGN.jpg)
> 
> 香蕉的例子。
> 
> *   一个`Banana` *类型*通常代表香蕉的属性和功能。
>     
>     
> *   `ABCBanana`和`XYZBanana` *类*将代表生产香蕉的方式。
>     （现实生活中不同的香蕉供应商，或者在视频游戏中表示和绘制香蕉的不同数据结构和函数）。
>     
>     
>     
>     然后`ABCBanana`该类可以生成 作为*该类****实例***的特定香蕉，它们将是**Banana****类型*****的******对象***。`ABCBanana`

 ***程序员为一种类型提供单一且唯一的实现并不罕见。在这种情况下，*类*名通常与*类型名*相同。但是仍然有一个类型（如果需要，可以在接口中提取）和一个构建类的实例（对象）的实现（它将实现单独的接口）。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-01-22T06:42:09.697

类型是所有可用对象模板或概念的总称。类就是这样一种对象模板。结构类型、整数类型、接口类型等也是如此。这些都是类型

如果你愿意，你可以这样看：类型是父概念。所有其他概念：类、接口、结构、整数等都继承自这个概念。即它们是类型

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-09-23T16:17:26.473

摘自下面的 GoF 引文：

> 对象的**类**定义了对象的实现方式。类定义了对象的内部状态及其操作的实现。
> 
> 相反，一个对象的 **类型**只指它的接口——它可以响应的一组请求。

我想提供一个使用 Java 的示例：

```
public interface IType {
}

public class A implements IType {
    public A{};
}

public class B implements IType {
    public B{};
} 
```

两个类都`A`实现`B`了接口，因此属于`IType`. 此外，在 Java 中，这两个类都产生自己的类型（分别根据它们的类名）。因此，类`A`是类型`A` **和** `IType`类`B`是类型`B` **和** `IType`满足：

> 一个对象可以有多种类型，不同类的对象可以有相同的类型。

子类型和子类之间的区别可能也有助于理解这个问题：

[https://www.cs.princeton.edu/courses/archive/fall98/cs441/mainus/node12.html](https://www.cs.princeton.edu/courses/archive/fall98/cs441/mainus/node12.html)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-02-27T20:42:51.927

一般而言，*与语言无关*- **Class**是**Type**的*实现*。

 **通常，当这是该类型的*唯一*实现时，您可以在某些上下文中使用这两个术语来引用它。

相反，例如，在 C# 上下文中 -**类**只是**类型**概念（如基元、结构、指针等）的[众多](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/types)*实现**之一。*

 **** * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-22T05:50:50.890

类型在概念上是类的超集。在更广泛的意义上，类是类型的一种形式。

与类密切相关的是接口，它可以被看作是一种非常特殊的类——一个纯粹的抽象类。这些也是类型。

所以“类型”包括类、接口和大多数语言中的原语。像点网CLR这样的平台也有结构类型。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-22T05:51:18.487

类型包含数据的描述（即属性、操作等），

类是一种特定类型——它是创建[对象](http://en.wikipedia.org/wiki/Object_(object-oriented_programming))实例的模板。

严格来说类是一个特殊的概念，它可以看作是一个包，包含描述对象某些方面的[元数据子集。](http://en.wikipedia.org/wiki/Metadata)

例如，在 C# 中，您可以找到接口和类。它们都是类型，但接口只能定义一些契约，不能像类那样实例化。

简单地说，*类*是一种*专门*用于封装对象的属性和行为的类型。

维基百科可以给你一个更完整的答案：

*   [类的定义](http://en.wikipedia.org/wiki/Class_(computer_science))
*   [数据类型定义](http://en.wikipedia.org/wiki/Data_type)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-22T06:33:07.420

以最快的方式说明它：

结构是类型，但结构不是类。

如您所见，Type 是一个“抽象”术语，不仅用于定义类，还用于结构和原始数据类型，如 float、int、bool。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-22T06:43:20.380

我认为类型是您可以使用特定值执行的一组操作。例如，如果您有一个整数值，您可以将其添加到其他整数（或执行其他算术运算），或将其传递给接受整数参数的函数。如果你有一个对象值，你可以调用它的类定义的方法。

因为一个类定义了您可以对该类的对象做什么，所以一个类定义了一个类型。一个类不仅如此，因为它还提供了如何实现方法的描述（类型没有暗示的东西）以及对象的字段是如何布局的。

还要注意，一个对象值只能有一个类，但它可能有多种类型，因为每个超类都提供了对象类中可用功能的子集。

因此，尽管对象和类型密切相关，但它们实际上并不是一回事。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-22T07:09:38.377

添加另一个区别示例：在 C++ 中，您有指针和引用类型，它们可以引用类，但它们本身不是类。

```
Bar b; // b is of type "class Bar"
Bar *b2 = &b; // b2 is of type "pointer to Class Bar"
Bar &b3 = b; // b3 is of type "reference to Class Bar"
Bar *b4[7]; // b4 is of type "7-element array of pointers to Class Bar"
Bar ***b5; //b5 is of type "pointer to a pointer to a pointer to Class Bar" 
```

请注意，只涉及一个类，但可以使用几乎无限数量的类型。在某些语言中，函数被认为是“一等对象”，在这种情况下，函数的类型是类。在其他情况下，函数的类型仅仅是一个指针。类通常具有能够保存数据以及对该数据进行操作的概念。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-12-01T23:03:28.213

我的想法与aku的回答几乎一致。

我将类视为构建对象的模板，而类型是对这些对象进行分类的一种方式，并为我们提供了与它们的接口。

Python 还添加了元类，它只是一种构建类的机制，就像类构建对象一样（而且，类和元类都是对象）。

[在我看来，终极版兰巴对同一问题的回答](http://lambda-the-ultimate.org/node/2079#comment-25536)似乎是一个完美的解释。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-04-16T03:38:05.263

C 中的类型，如 Int Float、char 等，定义了可以使用特定方法对它们进行操作的数据。没有比这更复杂的了。就像 int 我可以加，减乘，也许除。这些是我的 int 方法（或操作）。类只是一种新类型的定义。我首先定义数据的样子。也许是一点点。也许这两个词就像一个复合体，有一个真实的部分和一个想象的部分。或者可能是这个复杂的东西，它有 309734325 个字节，代表木星上一个奇怪粒子的原子构成。我不在乎。就像整数一样，我可以使用这种新数据类型来完成我可以执行的操作。在整数的情况下，我有加、减等。使用这种新数据类型，我可以定义我认为有意义的任何操作。他们可能是加减法等。但他们可能会添加其他内容。这些是我决定添加到课堂上的任何方法。

底线是，使用 C 中的类型，您可以定义数据是什么，即；一个字节、字、浮点数、字符等。但其中任何一个也暗示了哪些操作是合法的并且会产生可靠的结果。

除了由您来定义接口和可接受的操作外，一个类没有什么不同。类定义了这些东西，当您在 Object 中实例化它时，它定义了对象的行为，就像类型定义定义了对整数进行操作时的行为一样。

类只是让您灵活地定义新类型以及有关它们如何操作的所有内容。

一旦定义了它，每次我实例化一个“thingy”类的对象时，它都有我定义的数据结构和我说你可以用它做的操作（方法）。“thingy”类显然只不过是 C++ 让我定义的一种新类型。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-22T06:46:51.497

**类型**一般是指原始值的分类——整数、字符串、数组、布尔值、null 等。通常，你不能创建任何新类型。

**类**是指对象在创建时与之关联的一组命名的属性和方法。您通常可以根据需要定义任意数量的新类，尽管某些语言您必须创建一个新对象，然后将方法附加到它。

这个定义大部分是正确的，但是一些语言试图以各种方式组合类型和类，并产生各种有益的结果。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-22T18:12:05.543

类型和类是相关但不相同的。我的看法是类用于实现继承，而类型用于运行时替换。

[这](http://ocw.mit.edu/NR/rdonlyres/Electrical-Engineering-and-Computer-Science/6-170Fall-2005/915D0C58-87BE-46B4-893A-42CFCA08A717/0/lec14.pdf)是一个链接，解释了*替换原理*以及为什么子类和子类型并不总是相同的东西（例如在 Java 中）。关于协变和逆变的[维基百科](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))页面有更多关于这种区别的信息。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-05-31T02:33:18.627

在 Haskell 等语言中，不存在 Class 的概念。它只有类型。（和**Type Class 。不要与***Class*混淆，**Type Class**更像是 Type 的抽象版本）。

Monad 是一个**类型类**。

```
class Monad m where
  (>>=)  :: m a -> (  a -> m b) -> m b
  (>>)   :: m a ->  m b         -> m b
  return ::   a                 -> m a
  fail   :: String -> m a 
```

从（纯）函数式编程的角度来看，Type 比 Class 更基础，因为它的根源可以追溯到[类型理论](https://en.wikipedia.org/wiki/Type_theory)（例如，从 PTL 的角度来看，带类型和不带类型的 lambda 演算的行为完全不同），而 Class 实际上只是一个构造启用 OO。

在只支持 Type 而不支持 Class 的语言中，函数通常被视为一等公民。

同时，当一种语言区分类型和类时，函数更像是可以附加到对象等的二等公民。是的，通常您可以将函数附加到类本身（也称为静态函数） .

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-22T07:57:11.743

有趣的问题。我认为aku的答案是正确的。以java`ArrayList`类为例

```
public class ArrayList<E> extends AbstractList<E>
    implements List<E>, RandomAccess, Cloneable, java.io.Serializable 
```

类的实例`ArrayList`被称为它扩展的每个超类和它实现的每个接口的类型。因此，`ArrayList`该类的实例具有类型`ArrayList`、`RandomAccess`、`Cloneable`等。换句话说，值（或实例）属于一种或多种类型，类定义这些类型是什么。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-07-16T09:18:02.720

**不同的类可能描述相同的类型。**

类型由以下部分组成：

1.  操作 = 语法
2.  操作描述=语义

类由以下部分组成：

1.  操作 = 语法
2.  实现（=各种实现描述相同的语义）

一些注意事项：

*   接口（如在 Java 中）不是类型，因为它不描述语义（仅描述语法）

*   子类不是子类型，因为子类可能会改变超类中定义的语义，子类型不能改变超类语义（参见 Liskov Substitution Principle，例如[这个 LSP 示例](http://www.oodesign.com/liskov-s-substitution-principle.html)）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-11-25T16:30:30.623

显然，由于有类型系统的语言不是面向对象编程语言，因此*类型*必须是比*类更广泛的概念*

即使在像 Java 这样的语言中，`int`它也是一个（原始）类型，而不是一个类。

因此：每个类都是一个类型，但不是每个类型都是一个类。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-01-11T07:33:31.647

如果我们在 C# 上下文中思考这个问题，我们会得到下面的答案。

C#类型系统分为以下几类：

值类型：

*   简单类型：如 int、long、float 等。
*   枚举类型
*   结构类型
*   可空类型

参考类型：

*   班级类型
*   接口类型
*   数组类型
*   委托类型

如您所见，C# 中有许多类型，Class 只是其中之一。只有一个重要的注意事项：C# 的类型系统是统一的，因此任何类型的值都可以被视为对象。C# 中的每一种类型都直接或间接地派生自 object 类类型，而 object 是所有类型的最终基类。只需将值视为类型对象，即可将引用类型的值视为对象。通过执行装箱和拆箱操作，值类型的值被视为对象。

如我所见，类型是许多项目的保护伞，其中类是其中之一。

参考：CSahrp 语言规范文档，第 4 页

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2019-03-31T16:39:06.650

这对我来说是一个很好的问题，这让我很难思考。我敢说 Class 是编译时的东西，而 Type 是运行时的东西。我这么说是因为你写的是类而不是类型。然后编译器从类中创建类型，运行时使用类型来创建对象的实例。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2021-06-08T08:50:34.883

类型是帮助编译器执行类型检查并确保变量具有正确的操作属性的编程结构。

类是引用它们的对象或变量可能具有的用户定义类型。这些也受到类型检查。

# visual-studio-2005 - Visual Studio 2005 中的函数指针不正确，代码从 1 字节偏移开始

> ID：468147
> 
> 赞同：2
> 
> 时间：2009-01-22T05:45:44.053
> 
> 标签：visual-studio-2005, linker, callback, disassembly, rebasing

有问题的代码挂接到 explorer.exe，但在进入回调函数时崩溃：

```
explorer.exe 中 0x60055b50 (redacted.dll) 处的未处理异常：0xC0000005：访问冲突写入位置 0x548b0cca。
```

调用栈：

```
> redacted.dll!myCallWndProcRetCallback(int nCode=0x00000000, unsigned int wParam=0x00000000, long lParam=0x015afa58) Line 799 C++
      user32.dll!_DispatchHookW@16() + 0x31 字节    
      user32.dll!_fnHkINLPCWPRETSTRUCTW@20() + 0x5e 字节  
      user32.dll!___fnDWORD@4() + 0x24 字节   
      ntdll.dll!_KiUserCallbackDispatcher@12() + 0x13 字节      
      user32.dll!_NtUserMessageCall@28() + 0xc 字节
      user32.dll!_SendMessageW@16() + 0x49 字节     
      explorer.exe!CTaskBand::_FindIndexByHwnd() + 0x21 字节    
      explorer.exe!CTaskBand::_HandleShellHook() + 0x48 字节    
      explorer.exe!CTaskBand::v_WndProc() + 0x660 字节    
      explorer.exe!CImpWndProc::s_WndProc() + 0x3f 字节   

```

Visual Studio 2005 给出了以下反汇编：

```
--- c:\projects\redacted.cpp -------------------------
//------------------------------------------------ ------------------------------
LRESULT CALLBACK myCallWndProcRetCallback(int nCode, WPARAM wParam, LPARAM lParam) {
60055B50 inc dword ptr [ebx+548B0CC4h]
60055B56 和 al,18h
60055B58 mov eax,dword ptr [g_callWndProcRetHook (600B9EE8h)]
60055B5D推esi  

```

而0x548B0CC4周围的内存都是?????? 所以它不是映射内存，因此崩溃。

myCallWndProcRetCallback 开头的机器代码是这样的：

```
0x60055B50：ff 83 c4 0c 8b 54 24 18 a1 e8 9e 0b 60 56 52 57 50 ff 15 8c a6 09 60 5f 5e 83 c4 08 c2 0c 00 cc 8b 4c 24 04 8b 01 8b 50 

```

但 Visual Studio 有时也会为此函数提供以下反汇编：

```
--- c:\projects\redacted.cpp -------------------------
60055B51 添加 esp,0Ch
    if ( nCode == HC_ACTION && lParam != NULL) {
60055B54 mov edx,dword ptr [esp+18h]
60055B58 mov eax,dword ptr [g_callWndProcRetHook (600B9EE8h)]
60055B5D推esi  

```

这看起来像是正确的反汇编，但它比上面的反汇编晚 1 个字节！您可以看到从 0x60055B58 开始的指令是相同的。

因此，看起来链接器说函数位于 0x60055B50，但代码实际上从 0x60055B51 开始。我已经确认前者是设置到 Windows 挂钩中的回调。因此，当 Windows 回调函数时，它会执行错误的代码。

我的问题是链接器怎么会出错？我进行了重建，问题消失了，这似乎是随机的。当时 /FORCE:MULTIPLE 链接器选项有效，但如果没有它，则不会报告此回调的链接错误。

后期添加：这可能与 DLL 的重定位或变基有关吗？如果重定位偏移了 1 个字节，这可能会导致问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T23:59:27.480

重定位几乎不会偏离 1 个字节；.dll 映像必须与 VirtualAlloc 返回的分配粒度对齐，在大多数机器上应该是 64k。

这段代码工作了多长时间？如果它是随机的，那么 /FORCE:MULTIPLE**可能**是可疑的。或者您可以使用 Incredibuild...

# html - 有没有学习 HTML 的好网站？

> ID：468151
> 
> 赞同：1
> 
> 时间：2009-01-22T05:47:58.853
> 
> 标签：html

我正在寻找有关学习如何编写 HTML 代码的起始网站的建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T05:52:13.183

这个问题似乎有点奇怪......“沙盒”是什么意思？

通常，您只需通过使用文本编辑器并从浏览器打开本地文件来练习编写 HTML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T06:02:03.770

[从](http://www.w3schools.com/)w3schools.com 开始。它们为您的所有网页设计元素问题提供了一个带有示例代码的漂亮小沙箱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T06:05:03.623

**记事本 + 任何浏览器**- 这对我来说效果很好。只需将文件保存到 .htm

或者，如果您愿意，可以获取 FireFox 或 Opera，访问任何站点（例如 stackoverflow.com 或 w3schools.com），查看源代码，进行编辑，然后应用更改。不用担心，这些更改只会影响单个选项卡，不会更改网络上的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T06:42:54.920

HTML沙箱？你一定是在开玩笑。即使你的 HTML 出错了，也没有受伤的机会。所以你不需要沙箱。

使用任何体面的编辑器，它为源代码和快速视图提供两个选项卡视图，你就完成了。您可以使用 MS Frontpage 或 EditPlus，它们都提供这些功能。您无需保存即可看到效果。

**请不要仅仅为了测试和调试 HTML 而阻塞带宽。这不值得。**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T07:43:28.450

由于安全协议，当从 file:// 提供某些东西时，Javascript 无法使用，有时尝试启动并运行虚拟主机以进行试验可能会非常痛苦。

[http://www.webdevout.net/test](http://www.webdevout.net/test)

我发现这是一个方便的游乐场工具，当您弄乱某些东西并且想要帮助找出您做错了什么时，您可以将链接发布给某人，他们可以看到您所做的事情而无需担心关于安全、托管或防火墙。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-30T14:55:12.683

我想说看看这些来自 net tuts 的视频教程。它从最基本的开始，然后转向更深入的东西。这些教程被组织为一个为期 30 天的课程，他们每天都会向您邮寄视频教程的链接。想法是您将在 30 天内学​​会 html/css。但是您真的不需要注册邮寄服务，只需按照自己的步调进行即可。

[http://learncss.tutsplus.com/](http://learncss.tutsplus.com/)

# c# - 将一对多 sql 查询转换为嵌套类列表

> ID：468155
> 
> 赞同：0
> 
> 时间：2009-01-22T05:49:08.523
> 
> 标签：c#, asp.net, sql, linq, class

在不对每一行进行子选择的情况下进行查询并将其转换为嵌套类列表的最佳方法是什么？

例如。

```
1   aaaa
1   bbbb
1   cccc
2   dddd
3   eeee 
```

进入

```
1   
    aaaa
    bbbb
    cccc
2   
    dddd
3   
    eeee 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T05:51:55.210

```
var result = myList
  .GroupBy(x => x.Id)
  .Select(g => new Parent()
  {
    Key = g.Key,
    Children = g.Select(x => x.SomeString).ToList()
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T05:58:13.980

只需在父表和子表之间进行连接，并遍历行，当感兴趣的字段发生变化时创建一个新的外部类。

数据传输开销可以忽略不计。更重要的是其他人可以轻松阅读的清晰简单的代码。

如果您的整个同行组都精通 LINQ，那么 David 的反应非常优雅。我印象深刻。但是，我不能告诉你它是否正确。

# c# - 是否可以在 RowCommand 事件的 gridview 行之间显示面板或 div

> ID：468170
> 
> 赞同：1
> 
> 时间：2009-01-22T05:55:12.567
> 
> 标签：c#, asp.net, gridview

目前我正在使用gridView，并且在gridview 的RowCommand 事件中，所选行的详细信息显示在Gridview 下方。但是现在我必须在单击的行下方显示详细信息。表示它将显示在所选行和下一行之间。gridview 代码如下

```
 <asp:GridView ID ="gvUserDataReadOnly" AutoGenerateColumns ="false" runat ="server"   OnRowCommand ="gvUserDataReadOnly_RowCommand"  DataKeyNames ="Guid">
        <Columns >
            <asp:ButtonField ItemStyle-Width ="100px" DataTextField ="FirstName" HeaderText ="<%$ Resources:StringsRes,pge_ContactManager_FirstName %>" SortExpression ="FiratName" CommandName ="show_Details" ButtonType ="link" />
            <asp:ButtonField ItemStyle-Width ="100px" DataTextField ="LastName" HeaderText ="<%$ Resources:StringsRes,pge_ContactManager_LastName %>" SortExpression ="LastName" CommandName ="show_Details" ButtonType ="link" />                
            <asp:BoundField ItemStyle-Width ="100px" DataField ="TypeName" HeaderText ="<%$ Resources:StringsRes,pge_ContactManager_TypeName %>" SortExpression ="TypeId" />
        </Columns>
        <RowStyle Height="25px" />
        <HeaderStyle Height="30px"/>
    </asp:GridView> 
```

我想在行间显示的 div 标签是

```
<div id ="dvUserDatails" runat ="server" visible ="false" class ="eventcontent">
        <h2><asp:Literal ID ="ltUserName" runat ="server" ></asp:Literal></h2>
        <asp:Label Text ="Type : " runat ="server" ID ="Type"></asp:Label><asp:Literal ID ="ltType" runat ="server" ></asp:Literal><br />
        <asp:Label Text ="Address : " runat ="server" ID ="Address"></asp:Label><asp:Literal ID ="ltAddress" runat ="server" ></asp:Literal><br />
        <asp:Label Text ="Phone No : " runat ="server" ID ="PhoneNo"></asp:Label><asp:Literal ID ="ltPhoneNo" runat ="server" ></asp:Literal><br />
        <asp:Label Text ="Mobile No : " runat ="server" ID ="MobNo"></asp:Label><asp:Literal ID ="ltMobNo" runat ="server" ></asp:Literal><br />
        <asp:Label Text ="Email Id : " runat ="server" ID ="emailId"></asp:Label><asp:Literal ID ="ltemail" runat ="server" ></asp:Literal><br />
    </div> 
```

我不能使用 EditItem 模板，因为我没有使用 gridview 的编辑按钮。谁能告诉我如何完成这项任务？还有其他方法可以做到这一点吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T06:43:43.530

您可能想使用中继器并自己构建表。我认为您无法让 GridView 工作，因为您只能控制每一行中的内容，而您想要做的是在一般信息和详细信息之间交替行。有关如何将其连接到数据源并处理按钮单击的更多信息，请参见[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.aspx)。

```
<asp:Repeater ID="gvUserDataReadOnly" runat="server" DataKeyNames="Guid">
   <HeaderTemplate>
      <table>
         <tr>
            <th>Header 1</th>
             ...
         </tr>
   </HeaderTemplate>
   <ItemTemplate>
       <tr>
          <td>
             ... first name button ...
          </td>
          ...
       </tr>
   </ItemTemplate>
   <AlternatingItemTemplate>
      <tr runat="server" visible="false">
         <td colspan="3">
            ... details (minus div) here ...
        </td>
      </tr>
   </AlternatingItemTemplate>
   <FooterTemplate>
      </table>
   </FooterTemplate>
</asp:Repeater> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T06:56:17.997

请参阅以下文章，准确描述您想要的内容：
[DataGrid 和使用 ASP.NET、C# 和 JavaScript 的详细信息（展开/折叠行）](http://www.progtalk.com/ViewArticle.aspx?ArticleID=1)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-22T07:15:41.080

是的 - GridView 可以完全满足您的需求。

```
<asp:GridView ...>
    <RowStyle ...>
    <Columns>
        <asp:TemplateField>
            <HeaderTemplate>
            </HeaderTemplate>
            <ItemTemplate>
            </ItemTemplate>
            <FooterTemplate>
            </FooterTemplate
        </asp:TemplateField>
    </Columns>    
</asp:GridView> 
```

HeaderTemplate 和 FooterTemplate 是可选的 - 我认为即使 ItemTemplate 也是可选的。在任何情况下，您都可以在这些标签中放置任何东西——甚至是另一个 gridview。

# html - Webapp 中域对象的有意义的标记

> ID：468173
> 
> 赞同：1
> 
> 时间：2009-01-22T05:56:44.373
> 
> 标签：html, xhtml, semantic-web

我正在寻找在我正在编写的 Web 应用程序中表示一些域模型对象，并且我正在寻找标记的最佳实践。

例如在 yaml 中：

```
--- !ruby/object:User 
email: jd@example.org
first: John
last: Doe
login: jdoe
member_since: 2009-01-22 00:54:08.128094 -05:00 
```

什么是一个明智的方式来呈现这个？或标记此数据的最佳实践。

编辑：我现在只关心结构，我会在需要时应用样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T06:42:21.473

有点开放式的问题，但我会建议一个方向来进行对话。

由于您的示例使用 User 对象，因此我建议您查看[hCard 微格式](http://microformats.org/wiki/hcard)使用的结构。[微格式的一个很好的例子](http://rhizohm.net/contact.html)。

Mix Online 的超级酷的人在他们的 Oomph 工具包中创建了[一堆 CSS 选项](http://www.visitmix.com/Lab/oomph)，以展示微格式在需要对数据进行样式化时的多功能性。

话虽如此，微格式在这里并不是真正重要的部分，它是微格式结构让您将原始数据转换为机器可读但仍然易于样式化的标记结构的方式。

# drupal - 如何更改upload.module 生成的内容的#weight？

> ID：468185
> 
> 赞同：2
> 
> 时间：2009-01-22T06:07:17.520
> 
> 标签：drupal, drupal-6, themes

在我的 Drupal 支持的网站上，我想在节点页面的顶部（在一个狭窄的 float:right 内`<div>`）列出可用的下载，而不是在它们通常出现的底部。

在我的主题中，我重写了`theme_upload_attachments()`生成`<div>`宽度为 40% 的函数，但这显示在页面底部。

文件中的代码控制附件在`upload.module`页面上的列出位置：

```
// function upload_nodeapi(), line #284 of upload.module
$node->content['files'] = array(
    '#value' => theme('upload_attachments', $node->files),
    '#weight' => 50,
); 
```

如果我手动将此#weight 修改为-1，我的自定义附件列表会显示我想要的位置，浮动在内容区域顶部的右侧。

但是，我不想手动破解核心文件`upload.module`，因为我的更改将在下次应用升级时丢失（例如，对于安全补丁）。

如何/在哪里修改`content['files']`我的主题代码中的#weight？
或者，我是不是走错了路？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T15:48:24.897

您需要一个模块来执行此操作，而不仅仅是一个主题。模块可以实现 hook_nodeapi()，这将使它有机会在呈现之前更改 $node->content 数组的内容。例如，如果您的模块名为“upload_tweaker”，您将使用以下函数：

```
function upload_tweaker_nodeapi(&$node, $op) {
  if ($op == 'view') {
    $node->content['files']['#weight'] = -1;
  }
} 
```

在此“nodeapi”事件期间，每个模块都可以更改节点；如果你想改变一个模块添加的东西，你需要确保你的模块在它之后加载。这可以通过将其命名为“zzz”之类的名称来完成，或者通过更改站点数据库系统表中的“权重”字段来完成。模块可以像表单元素一样被加权。

[api.drupal.org](http://api.drupal.org/api/function/hook_nodeapi)有更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T11:10:48.813

对于那些使用 CCK 并想改变体重的人：

CCK 模块使用 pre_render 函数

```
/**
 * Pre-render callback to adjust weights of non-CCK fields.
 */
function content_alter_extra_weights($elements) {
  if (isset($elements['#content_extra_fields'])) {
    foreach ($elements['#content_extra_fields'] as $key => $value) {
      // Some core 'fields' use a different key in node forms and in 'view'
      // render arrays. Check we're not on a form first.
      if (!isset($elements['#build_id']) && isset($value['view']) && isset($elements[$value['view']])) {
        $elements[$value['view']]['#weight'] = $value['weight'];
      }
      elseif (isset($elements[$key])) {
        $elements[$key]['#weight'] = $value['weight'];
      }
    }
  }
  return $elements;
} 
```

因此，由于此回调，您无法使用正常行为改变体重。

你应该做这个：

```
function YOUR_MODULE_nodeapi(&$node, $op, $a3 = NULL, $a4 = NULL) {
  // Only for node pages.
  if ($op == 'view' && $a4) {
    $body_weight = 15 // Any weight.
    $node->content['#content_extra_fields']['body']['weight'] = $body_weight; // This value CCK module will use to alter body weight in the callback from above.
  }
} 
```

# graphics - 您会推荐哪种图标编辑软件来为应用程序创建图标

> ID：468195
> 
> 赞同：3
> 
> 时间：2009-01-22T06:16:19.547
> 
> 标签：graphics, icons

[我曾经购买了一个Microangelo](http://www.microangelo.us/)的单一许可证来创建过去对我很有帮助的图标，但现在我正在帮助运行一个新的虚拟机基础供我们的开发团队使用，并希望在其中包括一个**体面的免费图标编辑**器.

我更喜欢完全支持为 Windows Vista 创建图标的东西。

对于所有想“不要让开发人员设计图形！”的人。假装我说的是“为我们的 UI 设计团队”而不是“开发团队”，哈哈。;)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T06:20:36.743

这很简单，因为它是免费的、功能强大的并且支持 Vista 图标 (256x256)：[IcoFx](http://www.icofx.ro)

在此站点上，您也可以找到用于（动画）光标的工具：[AniFx](http://www.icofx.ro/anifx/index.html)

如果你想付费，我会推荐一个更强大的：[Axialis Iconworkshop](http://www.axialis.com/iconworkshop/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T06:25:42.723

我会使用[Inkscape](http://www.inkscape.org/)来设计图标，然后将它们按比例缩小并使用[Gimp将它们转换为最终格式](http://www.gimp.org/)

这样做的好处是您可以设计一次图标，并毫不费力地以多种目标尺寸制作它。

这就是开源世界现在正在做的事情:)（我们现在甚至有原生 SVG 图标）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T06:19:09.070

我会推荐[Paint.NET](http://www.paint.net)或[The GIMP](http://www.gimp.org)。它们不是专门用于图标的，但会完成这项工作等等。而且，两者都是免费的。

编辑：Paint.NET 需要[插件](http://www.evanolds.com/pdnicocur.html)（免费）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T07:11:05.550

对于图标，有[IcoFX](http://icofx.ro/)。

# eclipse-cdt - 开始使用 Eclipse CDT 和 mingw 时遇到问题

> ID：468196
> 
> 赞同：4
> 
> 时间：2009-01-22T06:16:37.283
> 
> 标签：eclipse-cdt

大家好，

我已经用 GCC 安装了 Eclipse CDT 和 MinGW。

将 mingw\bin 添加到我的路径环境变量中。

尝试使用 HelloWorld 向导创建新的 C++ 项目时，出现构建错误：

```
make: **** [app.o] Error 127

Error launching external scanner info generator (gcc -E -P -v -dD ... 
```

编辑：

好的，制作问题已解决，有谁知道如何解决有关外部扫描仪的其他警告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T06:21:19.300

啊哈！

在 C/C++ 构建设置中，确保构建命令是：

```
mingw32-make -f makefile 
```

谢谢我！

# c# - 通过 COM 使用 .Net 库或在 Java 中直接集成

> ID：468198
> 
> 赞同：3
> 
> 时间：2009-01-22T06:19:53.907
> 
> 标签：c#, java, com

我不得不承认我最后一次用 Java 编程是在高中的数据结构课上。所以请善待这个Java菜鸟。

我花了很多时间在工作中整理一个 C# COM 库。这个库严重依赖于一些新的 .Net 技术（WPF 是最重要的），因此将其翻译成另一种语言并不是一个真正的选择。我已经测试通过 COM 接口从 C++ 使用这个库，这很简单。我还想证明同样的库可以在 Java 程序中使用。

所以我遇到的问题是我找不到一种免费甚至廉价的方式来使用 Java 中的 COM 对象。我想另一种解决方案是找到一种直接集成库的方法。有没有人对实现这一目标的最佳方法有任何意见？我将 Eclipse 用于我的 java 环境。下面是我的 C# 代码暴露的示例。感谢您提供的任何方向。

```
//Example C# Object Code

[Serializable,
ComVisibleAttribute(true),
Guid("Long Guid String"),
ClassInterface(ClassInterfaceType.None),
ComSourceInterfaces(typeof(IFooBarStructure)),
ProgID("My Application")]

public class MyFooBarObject
{

   public MyFooBarObject(){}

   public string DotNetMethod(){ return String.Empty; }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T06:39:33.180

您可以使用[JACOB](http://danadler.com/jacob/)

从网站：

> *JACOB 是一个 JAVA-COM 桥接器，它允许您从 Java 调用 COM 自动化组件。它使用 JNI 对 COM 和 Win32 库进行本地调用。*

听起来像你正在寻找的那种东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T14:13:39.410

如果您有一点钱可以花在商业产品上，我建议您看看 Intrinsyc 的[用于 COM 的 J-Integra](http://j-integra.intrinsyc.com/products/com/index.asp)或[用于 .NET](http://j-integra.intrinsyc.com/products/net/index.asp)产品的 J-Integra。我使用他们的 COM 产品从 Java 代码访问第 3 方 ActiveX 控件（Bloomberg 数据访问库），用于我几年前从事的一个项目，并且效果非常好。他们有合理的试用/演示政策，并且对支持请求非常敏感。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T20:12:26.827

直接的 Java/.NET 集成可以通过 OOJNI 完成。谷歌“.NET 的面向对象的 JNI”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T14:05:26.010

如果您可以通过 C++ 访问您的库，则可以通过 JNI 访问它。JNI 很容易做到，只需仔细阅读[指南](http://java.sun.com/docs/books/jni/html/jniTOC.html)，尤其是第 8.6 节，其中讨论了 C 和 C++ 之间的区别

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-31T19:57:09.750

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程内桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

# android - 如何在我的内容提供商中获取 _count？

> ID：468211
> 
> 赞同：42
> 
> 时间：2009-01-22T06:27:36.620
> 
> 标签：android, count, android-contentprovider

我应该怎么做才能让我的内容提供者返回带有记录数的 _count 列？文档说它是自动的，但也许它只需要一些内置的内容提供程序。对数据库运行查询似乎不会返回它。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2011-05-09T10:13:36.730

如果您使用的是 contentProvider，那么您必须像**`count(*) AS count`**.

如果您使用`cursor.getCount()`，那将不如上述方法有效。与`cursor.getCount()`您一起获取所有记录只是为了计数。整个代码应如下所示 -

```
 Cursor countCursor = getContentResolver().query(CONTENT_URI,
                new String[] {"count(*) AS count"},
                null,
                null,
                null);

        countCursor.moveToFirst();
        int count = countCursor.getInt(0); 
```

之所以可行，是因为 android 需要定义一个列名。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-22T22:41:40.367

如果您使用`ContentProvider.query()`的`Cursor`是返回。调用`Cursor.getCount()`以获取返回游标中的记录数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-25T01:23:48.493

我有一个类似的问题，发现这对我有用。在下面的示例中，我想从 MediaStore 提供程序获取图像计数。

```
 final String[] imageCountProjection = new String[] {
                "count(" + MediaStore.Images.ImageColumns._ID + ")",
        };

        Cursor countCursor = getContentResolver().query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                imageCountProjection,
                null,
                null,
                null);

        countCursor.moveToFirst();
        int existingImageCount = countCursor.getInt(0); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-06T15:36:17.010

`cursor.getCount()`不能保证它返回的是真实的返回项目数。有很多更好的方法：

1-如果您使用的是 Content Providers，您可以进行查询并使用`Column (_COUNT)`BaseColumns 中包含的内容进行投影

```
@Override
public Cursor query(SQLiteDatabase db, Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) {
    ...

    projection = new String[] {
        ContentContract.NotificationCursor.NotificationColumns._COUNT,
    };

    ...

    Cursor cursor = queryBuilder.query(db, projection, selection, selectionArgs, groupBy, having, sortOrder);
    return cursor;
} 
```

`SELECT COUNT(*)`2- 使用@saurabh 在他的回复中说的那样做一个 rawQuery 。

# android - 如何从 Eclipse 运行 Android 仪器测试？

> ID：468220
> 
> 赞同：12
> 
> 时间：2009-01-22T06:31:32.587
> 
> 标签：android, eclipse, testing

目前我正在以这种方式从命令行运行仪器测试：

```
adb shell am instrument -w com.blah.blah/android.test.InstrumentationTestRunner 
```

有没有办法从 Eclipse 运行它们（自动安装应用程序）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T04:20:16.793

我无法确定自动部署到模拟器。但是，您可以使用相同的“adb shell”命令并创建外部启动配置。我在[这里](http://stuffikeepforgettinghowtodo.blogspot.com/2009/01/unit-testing-android-applications.html)写了同样的话题。当您还使用“-e debug true”参数时，以这种方式启动会更加直观。

但是，我认为我已经从 bash shell 脚本中获得了更多的成果（如果您使用的是一个*好的*开发平台）：

```
function adbtest() {
    adb shell  am instrument -w -e class blah.package.$1 blah.package.test/android.test.InstrumentationTestRunner;
} 
```

这样，当我想测试 blah.package.FooTest 时，我只需要记住输入：

```
james@trex:~$ adbtest FooTest 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T05:00:42.423

我不知道从 Eclipse 自动运行测试的好方法，但我已经整理了一种使用 ant 自动构建和部署测试的直接方法。

我的项目组织如下：

1.  我们把项目根目录叫做root
2.  在里面，我有 SDK 中的[activityCreator](http://developer.android.com/guide/developing/other-ide.html#buidingwithant)脚本生成的 build.xml。
3.  我有第二个项目，其中包含位于 root/tests 中的测试
    *   这个项目有它自己的AndroidManifest.xml（以[Android API Demos](http://d.android.com/guide/samples/ApiDemos/tests/index.html)的结构为例）
    *   这个项目也有它自己的 build.xml

为了在root/tests/build.xml 中支持junit，需要添加junit 的路径。一种方法是添加 compile、dex、debug 和 release 目标的路径（release 被省略，但它需要与 debug 相同的更改）。同样在编译目标中，我们包含 ../src 路径：

```
<!-- Compile this project's .java files into .class files. -->
<target name="compile" depends="dirs, resource-src, aidl">
    <javac encoding="ascii" target="1.5" debug="true" extdirs=""
            srcdir="src/:../src"
            destdir="${outdir-classes}"
            bootclasspath="${android-jar}">
        <classpath>
            <fileset dir="${external-libs}" includes="*.jar"/>
            <fileset file="${junit-path}"/>
        </classpath>
     </javac>
</target>

<!-- Convert this project's .class files into .dex files. -->
<target name="dex" depends="compile">
    <echo>Converting compiled files and external libraries into ${outdir}/${dex-file}...</echo>
    <apply executable="${dx}" failonerror="true" parallel="true">
        <arg value="--dex" />
        <arg value="--output=${intermediate-dex-ospath}" />
        <arg path="${outdir-classes-ospath}" />
        <fileset dir="${external-libs}" includes="*.jar"/>
        <fileset file="${junit-path}"/>
    </apply>
</target>

<!-- Package the application and sign it with a debug key.
     This is the default target when building. It is used for debug. -->
<target name="debug" depends="dex, package-res">
    <echo>Packaging ${out-debug-package}, and signing it with a debug key...</echo>
    <exec executable="${apk-builder}" failonerror="true">
        <arg value="${out-debug-package-ospath}" />
        <arg value="-z" />
        <arg value="${resources-package-ospath}" />
        <arg value="-f" />
        <arg value="${intermediate-dex-ospath}" />
        <arg value="-rf" />
        <arg value="${srcdir-ospath}" />
        <arg value="-rj" />
        <arg value="${external-libs-ospath}" />
        <arg value="-rj" />
        <arg value="${junit-path}" />
        <arg value="-nf" />
        <arg value="${native-libs-ospath}" />
    </exec>
</target> 
```

现在，我们可以分别构建这两个项目。最后一步是向 root/build.xml 添加一个新目标，它将构建和部署项目和测试并执行测试。为此，将以下目标添加到 root/build.xml：

```
<target name="tests" depends="reinstall">
    <echo>Building and installing tests..</echo>
    <exec executable="ant" failonerror="true">
        <arg value="-f" />
        <arg value="tests/build.xml" />
        <arg value="reinstall"/>
    </exec>
    <mkdir dir="${log-dir}" />
    <exec executable="${adb}">
    <arg value="shell" />
    <arg value="am" />
    <arg value="instrument" />
    <arg value="-w" />
    <arg value="-e" />
    <arg value="class" />
    <arg value="org.yourproject.AllTests" />
    <arg value="org.yourproject.tests/android.test.InstrumentationTestRunner" />
    </exec>
</target> 
```

一切就绪后，启动模拟器，然后运行“ant 测试”。这将在一个命令中构建、部署和执行您的测试。

# c# - 使用 ASP.Net 的搜索引擎优化 (SEO) 和友好的 URL

> ID：468224
> 
> 赞同：-1
> 
> 时间：2009-01-22T06:34:49.447
> 
> 标签：c#, asp.net

请告诉我使用 ASP.Net 实现搜索引擎优化 (SEO) 和友好 URL 的最佳方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T10:39:22.513

就 SEO 而言，请查看 Google 的本指南：[http ://www.google.com/support/webmasters/bin/answer.py?answer=35291&topic=15260](http://www.google.com/support/webmasters/bin/answer.py?answer=35291&topic=15260)

它不会确切地告诉您如何在 ASP.NET 中执行此操作，但会就如何总体上改进您的网站 SEO 提供建议。然后，一旦您决定改进您的 SEO 的任务，您就可以专注于如何在 ASP.NET 中实现该特定项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-16T15:54:56.940

我有一些想法给你；

```
1- avoid using table. use div instead.
2- write the title of the page then use general description of the page;
  for instance; Apples , Goldville Co. 
3- keep your keywords up to five for each page. use a sentence for the description which only describes the current page.
4- for asp.net I recommend intelligencia component which is free. or if you use asp.net mvc, friendly url comes default.
5- keep linking among pages. like wikipedia does. 
```

永远不要忘记；内容为王！

祝你好运

# python - 在 Python 中跟踪文件加载进度

> ID：468238
> 
> 赞同：3
> 
> 时间：2009-01-22T06:44:52.157
> 
> 标签：python, file, load, progress

我使用的许多模块将整个文件导入内存或在处理文件时将文件内容滴入其中。我想知道是否有任何方法可以跟踪这种加载进度？可能是一个接受回调的包装类？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T07:46:14.763

我会通过确定文件的大小来做到这一点，然后简单地将总数除以读取的字节数。像这样：

```
import os

def show_progress(file_name, chunk_size=1024):
    fh = open(file_name, "r")
    total_size = os.path.getsize(file_name)
    total_read = 0
    while True:
        chunk = fh.read(chunk_size)
        if not chunk: 
            fh.close()
            break
        total_read += len(chunk)
        print "Progress: %s percent" % (total_read/total_size)
        yield chunk

for chunk in show_progress("my_file.txt"):
    # Process the chunk
    pass 
```

**编辑：**我知道这不是最好的代码，但我只是想展示这个概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T11:41:32.383

如果您实际上是指“导入”（而不是“读取”），那么您可以覆盖导入模块定义。您可以添加计时功能。

请参阅[imp](http://www.python.org/doc/2.5.2/lib/module-imp.html)模块。

如果您的意思是“读取”，那么您可以使用自己的类似文件的包装器轻松包装 Python 文件。文件不会暴露太多方法。您可以覆盖有趣的内容以获取计时数据。

```
>>> class MyFile(file):
...     def read(self,*args,**kw):
...         # start timing
...         result= super(MyFile,self).read(*args,**kw)
...         # finish timing
...         return result 
```

# python - Python：将按字母顺序拼写的数字转换为数字？

> ID：468241
> 
> 赞同：0
> 
> 时间：2009-01-22T06:47:33.507
> 
> 标签：python, parsing

我正在寻找一个图书馆、服务或代码建议，以将拼出的数字和金额（例如“三十五美元和十五美分”、“一点五”）转换为数字（35.15 美元、1.5 美元）。建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T06:52:37.320

不久前，我为整数编写了一些代码：http: [//github.com/ghewgill/text2num](http://github.com/ghewgill/text2num)

随意分叉和破解。

# c# - .NET 在运行时再次加载程序集

> ID：468243
> 
> 赞同：4
> 
> 时间：2009-01-22T06:48:13.303
> 
> 标签：c#, .net, reflection, assemblies

我前一段时间发布了一个类似的问题。我需要在运行时加载程序集。

如果我在运行时知道 dll 的绝对路径，这很容易。

但我不:( 如果文件不在应用程序根目录中，则 assembly.Load() 或 LoadFromFile() 失败。

我唯一拥有的是 dll 名称。dll 可能位于根目录、system32 甚至 GAC 中。

.net 是否可以自动确定 dll 的位置，例如：它应该首先查看根目录。如果它不存在，请转到系统文件夹，否则尝试 GAC。

**已编辑**

我正在使用插件架构。我不需要注册 dll。我有一个多用户应用程序。我有一个应用程序表，其中包含有关应用程序的信息。每个应用程序都有一个与之关联的 dll 路径，其中包含与该应用程序关联的某些算法。希望这可以帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:07:22.610

`AppDomain.CurrentDomain.AssemblyResolve`您可以根据需要手动连接到事件并为您的应用程序加载程序集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-24T00:43:24.837

当前应用程序查找程序集时，它会在多个位置（bin 文件夹、gac 等）查找，如果找不到，则开发人员需要手动告诉应用程序在哪里查找。您可以通过拦截 AssemblyResolve 事件并使用事件参数告诉 CLR 您的程序集在哪里来做到这一点。

```
AppDomain.CurrentDomain.AssemblyResolve += CurrentDomain_AssemblyResolve;
....................
Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
{
   var strTempAssmbPath=
          Path.GetFullPath("C:\\Windows\\System32\\" + args.Name.Substring(0,  args.Name.IndexOf(",")) + ".dll");

   var strTempAssmbPath2=
          Path.GetFullPath("C:\\Windows\\" + args.Name.Substring(0,  args.Name.IndexOf(",")) + ".dll");

    if (File.Exists(strTempAssmbPath))
            return Assembly.LoadFrom(strTempAssmbPath);

    if (File.Exists(strTempAssmbPath2))
            return Assembly.LoadFrom(strTempAssmbPath2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-16T09:32:54.243

你有三个选择

1.  在全局程序集缓存 (GAC) 中安装程序集
2.  使用带有标签的应用程序配置 (.config) 文件
3.  使用 AssemblyResolve 事件

您可以在[此处](http://support.microsoft.com/kb/837908)找到详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T08:38:35.387

我希望你已经阅读了以下内容。我的建议...

*   [运行时如何定位程序集](http://msdn.microsoft.com/en-us/library/yx7xezcf(VS.71).aspx)
*   你可以给Assembly。**LoadWithPartialName**一个旋转.. 可能会工作..[它说它将搜索应用程序文件夹和 GAC，这](http://msdn.microsoft.com/en-us/library/0a7zy9z5(VS.71).aspx)与 Assembly.Load 不同。（但是它不太安全..因为您没有指定程序集名称的所有 4 个部分，因此您最终可能会得到错误版本的 DLL）
*   还可以尝试 AppDomainSetup.PrivateBinPath（AppDomain.AppendPrivatePath 已被弃用以支持此操作）将应用程序根目录的子文件夹添加到要探测程序集的文件夹列表中。您也可以尝试将文件从其他位置复制到 [AppFolder]\MySandboxForDLLsToLoad，该文件已添加到 PrivateBinPath。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T12:20:50.907

.NET 用于查找程序集及其依赖项的解析算法是直截了当的。

1.  .NET 标识所需的版本。通常有关依赖程序集的信息存在于应用程序的程序集清单中。
2.  .NET 搜索 GAC（全局程序集缓存），仅当程序集是强命名的。
3.  如果在 GAC 中未找到，并且存在 .config 文件，则 .NET 搜索配置文件中指定的位置，否则 .NET 搜索包含可执行文件 (.EXE) 的目录
4.  在此之后，如果仍然没有找到该程序集，则应用程序将因错误而终止。

[单击此处](http://csharp-video-tutorials.blogspot.co.uk/2012/07/how-net-finds-assemblies-during-program.html)观看解释 .net 解析算法的视频，并[单击此处](http://csharp-video-tutorials.blogspot.com/2012/07/part-55-c-tutorial-late-binding-using.html)观看有关后期绑定程序集的视频

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T06:51:25.777

如果 dll 位于 PATH 系统变量（即 system32）中引用的某个位置，或者如果 dll 已注册，则会自动找到该 dll。*如果它可以在磁盘上的任何位置*，您就找不到它，但无论如何没有人需要该功能。

编辑：可以注册 dll 吗？如果您不提前知道程序集，您如何获得程序集名称？您是否正在创建某种类型的插件架构？我认为如果你能多解释一下你的情况会有所帮助。

EDIT2：如果是这样，为什么不提供一种方法让用户注册他或她的插件？您可以从打开的文件对话框中获取所需的所有信息。那或者只是让他们将其转储到您指定的文件夹中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T07:14:01.177

是的，有一种方法，它取决于您的 dll 是弱命名（没有公钥令牌）还是强命名（使用公钥令牌）。如果它的名称很弱，并且您在 VS 中使用 dll 添加了对程序集的引用，那么 VS 将首先在应用程序文件夹根目录中查找，如果找不到，它将在您指定为值的子目录中查找您的 XML 配置文件中的 privatePath 属性。

如果它是一个强命名的 dll，则 CLR 将在 GAC 中搜索，因此您需要在 GAC 中安装该 dll。如果您安装了一个 XML 配置文件，该文件的 codeBase 元素指向 dll 的路径，CLR 也可以查看应用程序目录。

要在 GAC 中指定程序集，您可以在编译程序集时使用 /reference:[DLL name] 开关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-23T12:27:08.227

使用这个 Assembly.LoadWithPartialName(assemblyName);

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T07:06:37.073

将此程序集注册到 GAC。[怎么做](http://www.google.com/search?q=register+assembly+gac)

# javascript - 什么是好的 Javascript 时间选择器？

> ID：468253
> 
> 赞同：88
> 
> 时间：2009-01-22T06:54:51.573
> 
> 标签：javascript, jquery, time, input

jquery 或独立 js 的好时间选择器是什么？我想要像谷歌在他们的日历中使用的东西，它以 15 分钟的间隔下拉常用时间，或者让你手动输入时间并对其进行验证。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-22T07:13:06.280

一些资源：

*   [TimeDatePicker](https://github.com/perifer/timePicker)（jQuery 插件）
*   [jQuery.timepickr](http://haineault.com/media/jquery/ui-timepickr/page/)
*   [jQuery.ptTimeSelect](http://pttimeselect.sourceforge.net/example/index.html)
*   [时间选择器](http://www.pit-r.de/timepicker/demo/pickerDemo.htm)
*   [花式时间选择器](http://www.java2s.com/Code/JavaScript/GUI-Components/FancyTimePicker.htm)
*   [NoGray 时间选择器](http://www.nogray.com/time_picker.php)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-08-17T17:42:19.790

这是迄今为止我发现的最好的[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-07-30T13:16:23.863

我对任何建议的时间选择器都不满意，所以我从 Perifer 和 HTML5 规范的灵感中创建了自己的时间选择器：

[http://github.com/gregersrygg/jquery.timeInput](http://github.com/gregersrygg/jquery.timeInput)

您可以使用[新的 html5 属性](http://dev.w3.org/html5/markup/input.time.html)进行时间输入（步长、最小值、最大值），也可以使用选项对象：

```
<input type="time" name="myTime" class="time-mm-hh" min="9:00" max="18:00" step="1800" />
<input type="time" name="myTime2" class="time-mm-hh" />

<script type="text/javascript">
    $("input[name='myTime']").timeInput(); // use default or html5 attributes
    $("input[name='myTime2']").timeInput({min: "6:00", max: "15:00", step: 900}); // 15 min intervals from 6:00 am to 3:00 pm
</script> 
```

像这样验证输入：

*   如果缺少，请插入“：”
*   无效时间？替换为空白
*   不是根据步骤的有效时间？向上/向下舍入到最近的步骤

HTML5 规范不允许 am/pm 或本地化时间语法，因此它只允许格式 hh:mm。根据规范允许秒数，但我还没有实现它。

它非常“alpha”，因此可能存在一些错误。随时向我发送补丁/拉取请求。已在 IE 6&8、FF、Chrome 和 Opera 中手动测试（后者在 Linux 上最新稳定）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-22T07:10:25.130

你可以在这里阅读 jQuery 创建者 John Resig 的帖子：http: [//ejohn.org/blog/picking-time/](http://ejohn.org/blog/picking-time/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-22T16:02:57.237

如果有人对另一个 JavaScript TimPicker 感兴趣，我开发并维护了一个 jQuery 插件来完成这项工作。它的工作原理类似于 EZ Time JS（尽管我直到 5 分钟前才知道它：D），允许用户以几乎任何他们觉得舒服的方式输入时间，并将输入转换为通用格式。

查看[jQuery TimePicker 选项页面](http://wvega.github.com/timepicker/#options)以查看它的实际效果。

# .net - Windows 中的假快捷方式 - 是否有 API？一个用于 C#？

> ID：468254
> 
> 赞同：4
> 
> 时间：2009-01-22T06:55:13.243
> 
> 标签：.net, winapi, shortcuts

我不确定他们现在在 Windows 中经常看到的假快捷方式是什么。一个很好的例子是任何 Office 2007 程序的链接。您可以从常规快捷方式中分辨出其中之一，因为目标显示为灰色并且不是真实路径。您可以通过 .NET API 访问这些吗？比如问目标？或获取其中存储的任何信息。

我认为这些在某种程度上与 Windows Installer 和 Advertised 程序有关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T09:44:04.603

是的，这是一条广告捷径。

您必须调用 Windows 安装程序来获取目标。

目前我只有一个 delphi 源给你，但也许你可以挑选一些信息。

[delphi图书馆](http://www.delphi-library.de/topic_Die+ausfuehrbare+Datei+eines+quotadvertised+shortcutquot+ermitteln_51393.html)

简而言之 - 它使用**MsiGetShortcutTarget**函数来获取目标。

# xaml - 在 Windows 窗体/WPF 中使用 SVG 的库？

> ID：468259
> 
> 赞同：20
> 
> 时间：2009-01-22T06:58:43.423
> 
> 标签：xaml, svg, inkscape

有没有图书馆

1.  允许将 svg 直接绘制到 Windows 窗体应用程序
2.  到 WPF 应用程序

[我用Inkscape](http://www.inkscape.org)绘制图形和设计一切，因为我喜欢那个程序。然后我有那些令人惊叹的 svgs 并且必须将它们导出到 png (WinForm) 以使用它们或将它们转换为 xaml-code (WPF) ( [Kaxaml](http://www.kaxaml.com/)帮助我)。

有没有办法直接使用我的 svgs？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T07:16:46.710

**哇**，我[刚刚读到](http://weblogs.asp.net/jgalloway/archive/2008/01/10/inkscape-to-support-xaml-export.aspx)Inkscape 支持另存为 XAML。到现在为止我还没有意识到这种*耻辱*。

但这仍然不能解决我的 WinForms 问题......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-23T19:49:49.403

我个人讨厌微软的产品/开发工具中没有对 SVG 的原生支持。我发现了两个相当完整但仍然不成熟的 SVG 库，它们在撰写本文时似乎很活跃，但肯定需要贡献者。

*   **WPF**：[Svg2Xaml（开源）](http://svg2xaml.codeplex.com/)
*   **WinForms**：[SVG 渲染引擎（开源）](http://svg.codeplex.com)

IIRC 两个库都输出一个可以通过 Image 类直接使用的绘图对象；你会明白的，它们都非常易于使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-27T08:55:26.983

如果您想将它们直接加载到 WPF 中，我可以从以下位置获得更好的结果：[https ://github.com/ElinamLLC/SharpVectors](https://github.com/ElinamLLC/SharpVectors)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T07:58:16.433

是的，您可以使用[AB4D](https://www.ab4d.com/ReaderSvg.aspx)的 ReaderSVG 直接从 XAML 获取 WPF。

关于 WinForms，删除了之前指向 Kent Boogart 示例的链接，因为它在 2019 年的某个时候被删除。

[从此dotnetways 帖子](http://dotnetways.blogspot.com/2010/10/host-wpf-controls-in-windows-forms.html)中复制以下内容

要将 WPF 控件或 WPF 用户控件（在此示例中为 wpfControl）托管到 Windows 窗体应用程序中，请创建 ElementHost 类的实例并将您的 WPF 控件/用户控件作为子项添加到 ElementHost 的实例中。

```
 using System.Windows.Forms.Integration;   
    //Assembly:   WindowsFormsIntegration (in WindowsFormsIntegration.dll) 

//...

    ElementHost elementHost = new ElementHost();  
    elementHost.Dock = DockStyle.None;  
    elementHost.Child = wpfControl; 
```

现在，将 ElementHost 的实例添加到 Windows 窗体中的容器控件（例如此处的 containerPanel）

```
 containerPanel.Controls.Add(elementHost); 
```

# c - 如果没有 C 中的库函数，您将如何打印变量的任何字符、字符串或值？

> ID：468262
> 
> 赞同：9
> 
> 时间：2009-01-22T06:59:57.710
> 
> 标签：c, printing, printf, character, putchar

例如，如果我不应该使用标准库函数`printf()`，`putchar()`那么如何将字符打印到屏幕上？

有没有一种简单的方法来做到这一点。我对系统调用了解不多，如果我必须使用它们，那么我该如何使用它们？那么任何人都可以建议一种不使用库函数的简单打印方法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-22T07:15:31.250

在标准C中，你不能。C 中定义的唯一 I/O 是通过 C 标准库函数。

在给定的平台上，可能有办法做到这一点：

*   直接进行内核调用。您可能需要编写一些内联程序集来执行此操作。您可以直接调用 litb `write`，而无需使用 C 库。获取 C 库的源代码，看看它是如何完成的。
*   直接写入帧缓冲区。多用户操作系统通常不允许这样做（至少不进行任何库/内核调用）。

除非您正在编写自己的 C 库，否则我不确定您为什么要这样做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T07:05:11.600

在 linux 中，您可以使用`write`系统调用：

```
write(1, "hello\n", 6); // write hello\n to stdout 
```

如果你不能得到足够的，你可以降低一步，一般调用系统调用：

```
syscall(__NR_write, 1, "hello\n", 6); 
```

值得了解的是`strace`，您可以使用它来查看任何特定程序在运行时使用了哪些系统调用。但请注意，对于“一些简单的解析器”，几乎不需要使用原始系统调用。更好地使用c库的功能。

顺便说一句，如果您想在 Windows 中执行上述操作而不使用 c 标准库，请注意 WriteFile 和 GetStdHandle 函数。虽然不会像 linux 解决方案那样 l33t。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T09:20:02.077

好吧，谢谢大家的回答。我在问题下方的郝先生的评论中找到了一个简单的答案。他的答案是这样的简单程序

Turbo C（DOS程序）：

```
char far* src = (char far*) 0xB8000000L; 
*src = 'M'; 
src += 2; 
*src = 'D'; 
```

或试试这个：[http](http://en.wikipedia.org/wiki/Brainfuck) ://en.wikipedia.org/wiki/Brainfuck :) – //Hao（一小时前）

我在 Turbo C 和它的工作上试过它。我想要一个像这样的简单解决方案，我想接受它作为正确答案，但他（郝）将其作为评论给出，所以我将其粘贴在这里，让其他用户代表他了解并接受它。再次感谢郝先生。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-06-29T02:57:03.100

C 标准库（请参阅[https://en.wikipedia.org/wiki/C_standard_library](https://en.wikipedia.org/wiki/C_standard_library)）具有一组输入和输出例程，用于读取和写入各种输入和输出资源。C 标准库通常建立在目标操作系统提供的系统服务和系统调用之上，尽管在没有操作系统的嵌入式微控制器的情况下使用不同的方法。

除了 C 标准库之外，还有其他经常使用的库，例如 POSIX 库（参见[https://en.wikipedia.org/wiki/C_POSIX_library](https://en.wikipedia.org/wiki/C_POSIX_library)）。

我使用术语资源是因为输入请求或输出请求的目标可能是各种各样的不同事物。

*   磁盘上的文件

*   网络连接

*   控制台设备

*   一个串行通信端口

*   一个传感器

*   打印机设备

*   屏幕上的一个窗口

C 标准库采用的模型与 Unix 操作系统的模型相似，因为所有各种资源都被视为一个设备，您可以从中读取字符或字节流并写入字符或字节流.

在某些情况下，这是抽象允许您忽略资源物理连接的细节。因此，您可以打开 SATA 硬盘、USB 拇指驱动器或网络服务器上的文件。无论打印机是在串行通信端口、USB 端口还是网络打印机上，您都可以打印到打印机。

对于某些类型的资源，例如控制台设备或具有行和列以及可以移动的光标的打印机，您通常会在写入设备的字符内提供光标定位信息。因此，您将输出要在控制台上打印的文本以及将光标定位到您要写入的位置或其他一些操作（例如突出显示文本）的转义码。

一种这样的控制台设备是 DEC 的 VT100 终端（参见[https://en.wikipedia.org/wiki/VT100](https://en.wikipedia.org/wiki/VT100)），它在输出中使用特殊的转义码来执行诸如将光标定位在屏幕上的操作。这非常方便，以至于 Unix、Linux 和 Windows 上的控制台窗口使用类似的转义码在控制台或命令窗口上执行类似的操作（请参阅[如何使 win32 控制台识别 ANSI/VT100 转义序列？](https://stackoverflow.com/questions/16755142/how-to-make-win32-console-recognize-ansi-vt100-escape-sequences)）。

C 标准库为各种设备提供标准接口，由编写库的人员提供库实际进行读写所需的底层功能。

然而，标准库确实有字符流的限制，作为它使用或呈现给程序员的模型的一部分。这就是为什么还有其他库不属于图形用户界面和游戏的 C 标准库的一部分的原因，例如来自 Microsoft、Qt 和各种其他组（例如 OpenGL）（请参阅[https://en.wikipedia.org/wiki/ OpenGL](https://en.wikipedia.org/wiki/OpenGL)、[https://en.wikipedia.org/wiki/DirectX](https://en.wikipedia.org/wiki/DirectX)、[https://en.wikipedia.org/wiki/Graphical_user_interface](https://en.wikipedia.org/wiki/Graphical_user_interface)和[什么是 Linux 的原生 GUI API？](https://stackoverflow.com/questions/12717138/what-is-linux-s-native-gui-api)）。也请参阅[GUI 是如何真正制作的？](https://stackoverflow.com/questions/17002308/how-are-guis-really-made)[操作系统如何在屏幕上绘制窗口](https://stackoverflow.com/questions/41137700/how-does-an-operating-system-draw-windows-on-the-screen)？

如果您想绕过 C 标准库并直接使用操作系统 I/O 系统调用或服务，您可以这样做。然而，与满足 C 标准要求的跨编译器的标准 C 标准库不同，操作系统 I/O 服务将因操作系统而异。并且某些操作系统可能有几种方法来执行相同类型的 I/O。例如，Windows 有许多不同的方式来执行文件 I/O（请参阅[https://en.wikipedia.org/wiki/Windows_API](https://en.wikipedia.org/wiki/Windows_API)）。

在某些情况下，您可以绕过操作系统并直接与设备或资源对话。这通常是通过嵌入式应用程序完成的，在许多情况下，对于某些微控制器上的嵌入式应用程序，没有可用的真正操作系统，您必须直接与设备交互。

微控制器上的嵌入式应用程序通常使用特定的内存地址与传感器交互，以便为传感器做好传感准备以及从传感器读取温度等数据。传感器有许多不同的连接方法，这要求程序员了解电气设置和用于与传感器通信的协议，例如 I2C（参见[https://en.wikipedia.org/wiki/I²C](https://en.wikipedia.org/wiki/I%C2%B2C)）， 1-wire（参见[https://en.wikipedia.org/wiki/1-Wire](https://en.wikipedia.org/wiki/1-Wire)）等。

在旧的 MSDOS 操作系统下，您可以调用 BIOS 例程直接与包括屏幕在内的设备进行交互。或者，如果您知道屏幕缓冲区的地址和内存区域的正确格式，您可以通过直接写入屏幕帧缓冲区所在的内存区域来修改屏幕上显示的内容。

现代多线程和多处理操作系统在其系统调用中具有复杂的功能，以处理多个应用程序都试图使用相同的设备和资源时可能出现的各种同步和协调问题。由于 C 标准库是建立在这些操作系统服务之上的，因此当您使用 C 标准库时，您将获得诸如文件锁定之类的复杂功能。通过标准库使用操作系统服务，您可以获得专家的专业知识和知识，他们已经完成了您可以使用的工作。

现代操作系统提供了丰富多样的服务，例如文件 I/O、网络 I/O、打印服务等。C 标准库以及来自其他组的其他库（例如 POSIX）提供了一种标准的、可移植的方式来访问这些服务.

当 C 标准库和 POSIX 库移植到微控制器时，您可以访问相同的功能，而无需编写自己的库的巨大学习曲线。

# java - 如何在java中重新启动线程？

> ID：468266
> 
> 赞同：8
> 
> 时间：2009-01-22T07:04:25.907
> 
> 标签：java, multithreading, exception

我创建了一个在源文件夹中搜索文件的程序。如果找到任何文件，它会处理该文件并将其移动到目标文件夹，然后在源文件夹中查找新文件。它必须继续检查文件的源文件夹。

我使用线程在源文件夹中查找文件。我面临的问题是，只要在文件处理过程中抛出任何异常，线程就会停止。即使抛出异常，我也希望线程能够运行。它必须将导致错误的文件移动到其他文件夹并在源文件夹中查找新文件。如何让线程继续运行？

例如：

```
public void run() {
    try {
        searchfile();
    }
    catch(Exception e) {
        e.printStackTrace();
    }
}

public void searchfile(){
  ...
} 
```

* * *

*更新*：

我的问题应该更清楚。实际上有 4 个源文件夹和 4 个目标文件夹。我必须在每个源和目标对中执行相同的操作。所以我在一个类中创建了 4 个线程并在单独的类中进行操作。

```
class MainClass
{
   public static void main(String[] args){
      for(int i=0;i<4;i++){
         SearchClass search = new SearchClass();
         Thread thread = new Thread(search);
         thread.start();
     }
   }   
}

class SearchClass
{
   public void run() {
   try {
      searchfile();
   } catch(Exception e) {
      e.printStackTrace();
   }
}

public void searchfile(){ ... } } 
```

即使在中间捕获任何异常，所有线程也不会停止运行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-22T07:10:39.343

如果一个线程由于未捕获的异常而死亡，答案很简单：在适当的地方捕获异常，这样你就可以继续前进。要么在你的 searchfile 方法中捕获异常，要么让 run 方法在循环中调用 searchfile。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T20:13:15.377

如果您希望线程继续运行，请使用循环。

```
public void run() {
   while(!Thread.interrupted())
      try {
           searchfile();
      }
      catch(Exception e) {
          e.printStackTrace();
      }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T08:10:09.083

除非我弄错了，否则您的代码缺少“继续运行”的性质，即您需要在某处有一个循环：

```
public static void main(String[] args){

    ExecutorService service = Executors.newFixedThreadPool(4);

    // for each of your 4 folders
    while (true) {
        Future<File> searchResult = service.submit(new SearchTask());
        try {
          File foundFile = searchResult.get();
          // handle found file
        } catch (Exception e) {
          //    handle exception
        }
    }
}

private static class SearchTask implements Callable<File> {

    @Override
    public File call() {
      return searchFile();
    }

    public File searchFile() {
      // search & return found file
    }

} 
```

请注意，这只是您的示例的一个非常简单的扩展。它仍然缺少 SearchTask 的参数化以实际特定于文件夹、文件和异常的处理等。如前面的答案中所述，您的 SearchTask 应该实现 Runnable （我更喜欢 Callable ...），恕我直言，它总是更好使用 ExecutorService 而不是手动生成线程。希望这可以帮助...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T07:11:02.307

在您的捕获中，您可以将文件移动到错误文件夹，然后创建同一线程的新对象并重新启动它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-29T04:49:42.333

我不完全确定这是否可行，但这是一个尝试。

```
public void run() {
    try {
        searchFile();
    } catch(Exeption e) {
        e.printStackTrace();
        if(!Thread.currentThread().isAlive())
            Thread.currentThread().start();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T08:32:56.040

你说在文件处理过程中可能会抛出异常，所以我把它`processFile()`放在一个 try-catch 块中。但是如果它可能在搜索过程中被抛出，你也可以把它放在一个 try-catch 中。

```
public void run() {
    while(!terminated) {    
        findNextFile();
        try {
            processFile();
        } catch {
            // handle error
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-01T17:05:24.270

以下是我根据您的问题和您的说明做出的假设：

*   方法中的每个线程`run()`只调用`searchfile()`一次，而不是循环调用
*   您的`searchfile()`方法中有一个循环，并且您希望**该循环**继续运行，即使其中引发了异常。
*   你有一些方法来初始化你没有向我们展示的每个线程（这对于这个特定的问题并不是非常重要）
*   `searchfile()`没有声明它抛出任何`Exception`
*   您没有使用日志框架，而是使用`System.out`（尽管使用日志框架是一个非常好的主意
*   Java 5 没问题（否则你必须在`for()`下面使用不同的循环

有了这些假设，您不希望计划`Exception`在您的`run()`方法中捕获一个，除非是为了记录出现严重错误的目的：

```
public void run() {
    try {
        searchfile();
    } catch (RuntimeException e) {
        System.out.println("Something went very wrong!  Unexpected RuntimeException");
        e.printStackTrace();
    }
} 
```

请注意，代码会捕获`RuntimeException`. 始终抓住最具体`Exception`的，可以满足您的需求。那么您需要的是您的`searchfile()`方法中的以下内容：

```
File[] files = directory.listFiles();
for (File file : files) {
    try {
        // Do your normal file/directory processing here
    } catch (Exception e) {
        System.out.println("Exception processing file " + file.getName() + " " + e);
        // Move "file" to another area
    }
} 
```

由于您`Exception`在 的主循环中捕获了意外的 s，因此`Thread`您的线程将在处理`Exception`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-17T08:32:06.787

您可以轻松地使用解决方法。只需运行所需的逻辑一段时间并根据某些标准完成工作。

```
public class ThreadRestartWorkaround extends Thread {

public static void main(String[] args) {
    ThreadRestartWorkaround th = new ThreadRestartWorkaround(5);
    th.start();
}

private int maxCycles;
private int currentCycle;

public ThreadRestartWorkaround(int maxCycles) {
    this.maxCycles = maxCycles;
}

@Override
public void run() {
    while(executeSomeLogicUntilReachingTheLimit());
    System.out.println("Finished due to exceeding the maxCycles config");
}

private boolean executeSomeLogicUntilReachingTheLimit() {
    currentCycle++;
    System.out.println("Executing logic for " + currentCycle + " time");
    return currentCycle < maxCycles;
}
} 
```

输出是

```
Executing logic for 1 time
Executing logic for 2 time
Executing logic for 3 time
Executing logic for 4 time
Executing logic for 5 time
Finished due to exceeding the maxCycles config 
```

# network-programming - 我在哪里可以找到 ICQ 用来开发我自己的客户端的协议堆栈？

> ID：468273
> 
> 赞同：0
> 
> 时间：2009-01-22T07:08:00.330
> 
> 标签：network-programming, tcp, network-protocols, icq

我要开发 ICQ 客户端，我只是想知道在哪里可以找到参考来了解他们使用的协议？任何链接、书籍等。
顺便说一句，如果我没记错的话——所有 ICQ 客户端——QIP、Miranda、ICQ Lite 等——都使用相同版本的协议与 ICQ 服务器正确通信？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:45:50.737

[libpurple](http://developer.pidgin.im/wiki/WhatIsLibpurple)是一个实现大量 IM 协议的库，其中包括 icq 使用的 oscar 协议。它被许多 IM 客户端使用，并且非常稳定，因此我建议您直接使用它。如果你想了解 oscar，学习 libpurple 可能是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T07:13:47.400

维基百科有一篇关于[OSCAR](http://en.wikipedia.org/wiki/OSCAR_protocol)协议的文章，尽管它是专有的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T07:17:39.313

Pidgin 是开源的，或许你可以参考它的源代码。

# asp.net - 使用 WCF Web 服务进行数据授权

> ID：468274
> 
> 赞同：1
> 
> 时间：2009-01-22T07:08:53.480
> 
> 标签：asp.net, wcf, validation

我是 Web 开发和 WCF 的新手。我正在阅读一些关于它的基础知识，其中大部分内容看起来都很有趣。

我读过可以使用 SOAP 和其他协议公开 WCF 服务。我想知道在传输过程中是否有针对数据损坏的明确实现内置或留给用户？

例如，如果一个服务返回一个字符串，那么如何保证它在传输过程中没有损坏（由于连接不良）。这不是关于检测是否有人入侵了系统，我只是想问一下普通的传输错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:24:08.537

你的意思是[消息的可靠性](http://books.google.com.au/books?id=DW2ldput788C&pg=PA51&lpg=PA51&dq=wcf+message+reliability&source=web&ots=qi8sfpZMDM&sig=3UHgy0HJXmgwtRLnuzwR7GDhgkM&hl=en&sa=X&oi=book_result&resnum=2&ct=result)？如果是这样，该链接将显示不同类型绑定的可靠性。

# lucene - 前导通配符在 Lucene.NET 中引发错误

> ID：468279
> 
> 赞同：4
> 
> 时间：2009-01-22T07:10:58.373
> 
> 标签：lucene, lucene.net, wildcard

如果搜索查询包含前导通配符（`*`或`?`），则`QueryParser`'`Parse`函数将引发错误。

```
Dim q As String = "*abc"
Dim qp As New QueryParser("text", New StandardAnalyzer())
Dim query As Query = qp.Parse(q) 
```

有没有办法在 Lucene.NET v2.0.0.4 中解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T20:31:28.413

将[QueryParser.SetAllowLeadingWildcard 方法](http://incubator.apache.org/lucene.net/docs/2.1/Lucene.Net.QueryParsers.QueryParser.SetAllowLeadingWildcard.html)设置为 true。API 页面指出“这会在大索引上产生非常慢的查询”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T07:23:05.370

也许您必须使用[WildcardQuery](http://incubator.apache.org/lucene.net/docs/2.1/Lucene.Net.Search.WildcardQuery.html)，但是

> ...为了防止通配符查询速度极慢，通配符术语不应以通配符之一开头...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-12T09:13:00.140

`NGramFilter`您可以通过使用索引分析器来避免通配符查询。比你必须使用`search_analyzer`没有`NGramFilter`. 这样，您`like "%text%"`甚至不需要通配符就可以进行类似的搜索。您只需输入“abc”，您的索引将很快搜索所有包含“abc”的条目。

# firefox - 在 Firefox 中触发 onclick 事件

> ID：468286
> 
> 赞同：1
> 
> 时间：2009-01-22T07:13:43.453
> 
> 标签：firefox, onclick

我有一个动态构建的 HTML 表。在表中，我附加了一个事件处理程序，它在单击列时对列进行排序。一旦页面完成加载，我希望强制进行列排序（即按特定列对表进行排序）。

目前，我使用`document.getElementById(ElementName).click();` This works in IE 但不是 Firefox。如何在 Firefox 中实现相同的效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:29:48.523

无需调用点击处理程序，只需直接调用处理程序函数即可。假设您的处理程序位于包含列名的跨度上，它可能类似于：

```
<span id='defaultColumn' onclick='sortBy(this);'>Column</span> 
```

所以你会这样做：

```
sortBy( document.getElementById('defaultColumn') ); 
```

或者可能

```
<span id='defaultColumn' onclick='sortBy("Column Name");'>Column Name</span> 
```

这会给你

```
sortBy( document.getElementById('defaultColumn').innerHTML ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T09:35:02.630

您可以使用“dispatchEvent”，详细信息在[https://developer.mozilla.org/en-US/docs/DOM/element.dispatchEvent](https://developer.mozilla.org/en-US/docs/DOM/element.dispatchEvent)

```
document.getElementById(ElementName).dispatchEvent(eventObj) 
```

# html - 输入type=password，不要让浏览器记住密码

> ID：468288
> 
> 赞同：103
> 
> 时间：2009-01-22T07:13:56.153
> 
> 标签：html, passwords

我记得有一种方法可以让`<input type="password" />`浏览器**不会**提示用户保存密码。但我正在画一个空白。是否有一个 HTML 属性或一些 JavaScript 技巧可以做到这一点？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-01-22T07:15:41.533

尝试使用`autocomplete="off"`. 不过，不确定是否每个浏览器都支持它。MSDN 文档[在这里](http://msdn.microsoft.com/en-us/library/ms533486(VS.85).aspx)。

*编辑*：注意：大多数浏览器已经放弃了对这个属性的支持。请参阅[autocomplete="off" 是否与所有现代浏览器兼容？](https://stackoverflow.com/questions/3868299/is-autocomplete-off-compatible-with-all-modern-browsers/21348793#21348793)

这可以说是应该留给用户而不是网站设计者的事情。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-01-22T07:17:15.290

`<input type="password" autocomplete="off" />`

我想补充一点，作为用户，我认为这**很**烦人，而且很难克服。我强烈建议不要使用它，因为它很可能会激怒您的用户。

密码已经没有存储在 MRU 中，正确配置的公共机器甚至不会保存用户名。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-09-30T06:38:33.010

我用另一种方式解决了。你可以试试这个。

```
<input id="passfld" type="text" autocomplete="off" />
<script type="text/javascript">
// Using jQuery
$(function(){                                               
    setTimeout(function(){
        $("input#passfld").attr("type","password");
    },10);
});

// or in pure javascript
 window.onload=function(){                                              
    setTimeout(function(){  
        document.getElementById('passfld').type = 'password';
    },10);
  }   
</script> 
```

＃其他方式

```
 <script type="text/javascript">    
 function setAutoCompleteOFF(tm){
    if(typeof tm =="undefined"){tm=10;}
    try{
    var inputs=$(".auto-complete-off,input[autocomplete=off]"); 
    setTimeout(function(){
        inputs.each(function(){     
            var old_value=$(this).attr("value");            
            var thisobj=$(this);            
            setTimeout(function(){  
                thisobj.removeClass("auto-complete-off").addClass("auto-complete-off-processed");
                thisobj.val(old_value);
            },tm);
         });
     },tm); 
    }catch(e){}
  }
 $(function(){                                              
        setAutoCompleteOFF();
    });
</script> 
```

**// 你需要添加属性 autocomplete="off" 或者你可以在输入框中添加类 .auto-complete-off 并享受**

例子：

```
 <input id="passfld" type="password" autocomplete="off" />
    OR
  <input id="passfld" class="auto-complete-off" type="password"  /> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-10T16:53:01.550

我尝试了以下方法，似乎适用于任何浏览器：

```
<input id="passfld" type="text" autocomplete="off" />

<script type="text/javascript">
    $(function(){  
        var passElem = $("input#passfld");
        passElem.focus(function() { 
            passElem.prop("type", "password");                                             
        });
    });
</script> 
```

这种方式比使用超时技术更安全，因为它保证了当用户聚焦时输入字段将屈服于密码。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-09-10T14:38:02.317

```
<input type="password" placeholder="Enter New Password" autocomplete="new-password"> 
```

干得好。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-05-23T16:51:33.493

至于安全问题，以下是安全顾问将就整个现场问题告诉您的内容（来自实际的独立安全审计）：

> 启用 HTML 自动完成 - HTML 表单中的密码字段已启用自动完成。大多数浏览器都具有记住输入到 HTML 表单中的用户凭据的功能。
> 
> 相对风险：低
> 
> 受影响的系统/设备：o https:// ***** ** *** ***** /

我也同意这应该涵盖*任何*包含真正私人数据的领域。我认为，只要该站点要访问任何应该保持安全的内容[普遍或符合法律合规要求]，就可以强制一个人始终输入他们的信用卡信息、CVC 代码、密码、用户名等。例如：购买表格、银行/信贷网站、税务网站、医疗数据、联邦、核等 -*而不是*Stack Overflow 或 Facebook 等网站。

其他类型的网站 - 例如用于上班和下班的 TimeStar Online - 这很愚蠢，因为我在工作时总是使用相同的 PC/帐户，我无法在该网站上保存凭据 - 奇怪的是，我可以在我的 Android 上但不是在 iPad 上。即使是共享的个人电脑，这也不会太糟糕，因为替别人打卡/打卡除了惹恼你的主管之外真的没有任何作用。（他们必须进去并删除错误的拳头——只是选择不保存在公共电脑上）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-08-26T21:45:01.550

这是最好的答案，也是最简单的！在您的字段前面放置一个额外的密码字段`input`并设置`display:none`，以便当浏览器填写它时，它会在`input`您不关心的情况下执行它。

改变这个：

```
<input type="password" name="password" size="25" class="input" id="password" value=""> 
```

对此：

```
<input type="password" style="display:none;">
<input type="password" name="password" size="25" class="input" id="password" value=""> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-01T12:58:21.287

另请阅读[此答案](https://stackoverflow.com/questions/2530/how-do-you-disable-browser-autocomplete-on-web-form-field-input-tag#answer-24247840)，他正在使用这种适用于任何地方的简单解决方案（另请参阅 Safari 移动版的修复）：

```
<input type="password" readonly onfocus="this.removeAttribute('readonly');"/> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-05T20:34:47.540

您可以使用 JQuery，通过 id 选择项目：

```
$("input#Password").attr("autocomplete","off"); 
```

或按类型选择项目：

```
$("input[type='password']").attr("autocomplete","off"); 
```

或者还有：

您可以使用纯 Javascript：

```
document.getElementById('Password').autocomplete = 'off'; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-04T11:15:40.123

你也可以像下面这样使用它

```
$('#Password').attr("autocomplete", "off");
setTimeout('$("#Password").val("");', 2000); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-11-18T10:12:27.753

看到*autocomplete=off*已弃用，我建议使用更新的解决方案。

将您的密码字段设置为普通文本字段，并使用 CSS 用“光盘”屏蔽您的输入。代码应如下所示：

```
<input type="text" class="myPassword" /> 

input .myPassword{
    text-security:disc;
    -webkit-text-security:disc;
    -mox-text-security:disc;
} 
```

请注意，这在 Firefox 浏览器上可能无法正常工作，需要额外的解决方法。在此处阅读更多信息：[https](https://stackoverflow.com/a/49304708/5477548) ://stackoverflow.com/a/49304708/5477548 。

该解决方案取自[此链接](https://medium.com/@idanhareven/how-to-workaround-browsers-save-password-password-autocomplete-features-135b91ad06d2)，但为了遵守 SO“无热链接”，我在此处对其进行了总结。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-08-19T12:27:21.497

你可以使用这个： autocomplete="new-password"

例子：

```
<input type="password" placeholder="Enter New Password" autocomplete="new-password"> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-02T19:22:43.823

在大多数主要浏览器的情况下，在任何表单之外进行输入并且未连接到任何表单都会欺骗浏览器认为没有提交。在这种情况下，您必须使用纯 JS 验证进行登录，并且还需要对密码进行加密。

前：

```
<form action="..."><input type="password"/></form> 
```

后：

```
<input type="password"/> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-28T21:46:26.453

我在 Firefox 和 Chrome 上发现了以下作品。

```
<form ... > <!-- more stuff -->
<input name="person" type="text" size=30 value="">
<input name="mypswd" type="password" size=6 value="" autocomplete="off">
<input name="userid" type="text" value="security" style="display:none">
<input name="passwd" type="password" value="faker" style="display:none">
<!-- more stuff --> </form> 
```

所有这些都在表格部分中。"person" 和 "mypswd" 是你想要的，但是浏览器会保存一次 "userid" 和 "passwd"，因为它们不会改变，所以再也不会保存。如果您真的不需要它，您可以消除“人员”字段。在这种情况下，您所需要的只是“mypswd”字段，它可能会以您网页用户已知的某种方式发生变化。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-06-02T20:01:27.093

我可以让 firefox、edge 和 Internet Explorer 关闭自动完成功能的唯一方法是在我的表单语句中添加 autocomplete="false"，例如：

```
 <form action="postingpage.php" autocomplete="false" method="post"> 
```

我必须将 autocomplete="off" 添加到我的表单输入并将类型更改为文本，例如：

```
 <input type="text" autocomplete="off"> 
```

看来这个html代码需要用浏览器标准化。应修改表单类型 = 密码，使其覆盖浏览器设置。我唯一的问题是我丢失了输入屏蔽。但从好的方面来说，烦人的“这个网站不安全”并没有出现在 Firefox 中。

对我来说，这没什么大不了的，因为用户已经过身份验证，并且我更改了用户名和密码部分

# c# - 将 2 个 DOCX 文件合并为 1 个？

> ID：468291
> 
> 赞同：2
> 
> 时间：2009-01-22T07:14:55.760
> 
> 标签：c#, msbuild, merge, docx

我需要以编程方式合并一大堆 docx 文件。想象一下它们的编号是 1 到 10。我基本上需要一个包含所有 10 个文档的 final.docx 文件。如果我可以以某种方式将第二个附加到第一个，那么我可以重复第三个，然后是第四个，等等。

请注意，我不需要重建目录或类似的东西。每个 docx 都只有一些静态内容。但是，这些文档上有页脚，需要保留。

最好是 C# 或 MSBuild 中的答案。

感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T12:39:08.977

我在 C# 中创建了一个应用程序，将 RTF 文件合并到一个文档中，我希望它也适用于 DOC 和 DOCX 文件。

```
 Word._Application wordApp;
        Word._Document wordDoc;
        object outputFile = outputFileName;
        object missing = System.Type.Missing;
        object vk_false = false;
        object defaultTemplate = defaultWordDocumentTemplate;
        object pageBreak = Word.WdBreakType.wdPageBreak;
        string[] filesToMerge = new string[pageCounter];
        filestoDelete = new string[pageCounter];

        for (int i = 0; i < pageCounter; i++)
        {
            filesToMerge[i] = @"C:\temp\temp" + i.ToString() + ".rtf";
            filestoDelete[i] = @"C:\temp\temp" + i.ToString() + ".rtf";                
        }
        try
        {
            wordDoc = wordApp.Documents.Add(ref missing, ref missing, ref missing, ref missing);
        }
        catch(Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        Word.Selection selection= wordApp.Selection;

        foreach (string file in filesToMerge)
        {
            selection.InsertFile(file,
                ref missing,
                ref missing,
                ref missing,
                ref missing);

            selection.InsertBreak(ref pageBreak);                                     
        }
        wordDoc.SaveAs(ref outputFile, ref missing, ref missing, ref missing, ref missing, ref missing,
               ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing,
               ref missing, ref missing); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-09T01:16:33.403

使用 Open XML Power Tools，描述于[http://blogs.msdn.com/b/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using-the-打开-xml-sdk.aspx](http://blogs.msdn.com/b/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using-the-open-xml-sdk.aspx)

# perl - 是否有使用 T_DB(Temp - Dry Bulb) 和 DP ( Dew Point) 计算相对湿度 (%) 的 shell 脚本或 Perl 脚本？

> ID：468292
> 
> 赞同：2
> 
> 时间：2009-01-22T07:15:01.470
> 
> 标签：perl

我只有这个

Tc=摄氏温度

Tdc=以摄氏度为单位的露点温度

(1) Es=6.11*10.0** (7.5*Tc/ (237.7+Tc))

(2) E=6.11*10.0** (7.5*Tdc/ (237.7+Tdc))

(3) 相对湿度 (RH) 百分比 = (E/Es)*100

实际上（来自 CSV 文件）我需要从 Column9 中获取一个值，并从 Col 10 中获取一个值来计算相对湿度（％）并将结果放在记录/行的末尾。这需要重复到 csv 文件结束。

任何帮助表示赞赏

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T07:46:00.440

将以下代码放入`calc_rh.pl`：

```
#!/usr/bin/perl

while (<>) {
    chomp;
    @f = map { /^\"(.*)\"$/ ? $1 : $_ } split /,/;   # Strips double quotes if present
    ($Tc, $Tdc) = @f[8, 9];       # Assuming Tc in column 9, Tdc in column 10
    $Es=6.11*10.0** (7.5*$Tc/ (237.7+$Tc));
    $E=6.11*10.0** (7.5*$Tdc/ (237.7+$Tdc));
    $RH = sprintf "%.2f", $E/$Es*100;    # Or use e.g. "%.4f" for 4 digits after d.p.
    print join(",", map { "\"$_\"" } @f, $RH), "\n";
} 
```

运行：

```
perl calc_rh.pl < infile.csv > outfile.csv 
```

注意：如果您的任何列包含逗号，上面的代码将中断。可以使用可下载的模块来解决这个问题，但我觉得你只需要一个快速脚本。

此外，如果您在 Linux 中运行，则可能需要运行：

```
perl ./calc_rh.pl < infile.csv > outfile.csv 
```

反而。

# opengl - 在 OpenGL 中，如何制作简单的背景四边形？

> ID：468297
> 
> 赞同：3
> 
> 时间：2009-01-22T07:16:27.600
> 
> 标签：opengl, graphics, image, background, glut

假设我想画一个像这样的简单四边形：

```
glBegin(GL_QUADS);
glVertex2f(-1.0,-1.0);
glVertex2f(1.0,-1.0);
glVertex2f(1.0, 1.0);
glVertex2f(-1.0, 1.0);
glEnd(); 
```

有没有办法绘制它，使它出现在所有 3D 对象的后面并填满整个屏幕？我的相机随着鼠标移动，所以这个四边形也必须随着相机的移动而显得静止。目的是做一个简单的背景。

我是否必须根据眼睛位置/旋转进行一些疯狂的转换，或者是否有更简单的方法使用 glMatrixMode()？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T08:09:58.270

听起来您想要做的类似于在简单游戏中绘制 2D HUD 时所做的事情，或者只是一个持久的背景。我不是专家，但我最近才这样做。您想要做的是将投影矩阵更改为正交投影，渲染您的四边形，然后切换回您之前的任何投影。您可以使用矩阵堆栈来做到这一点，它完全独立于任何相机。

所以，首先：

```
glMatrixMode(GL_PROJECTION);
glPushMatrix();
glLoadIdentity();
int w = glutGet(GLUT_WINDOW_WIDTH);
int h = glutGet(GLUT_WINDOW_HEIGHT);
gluOrtho2D(0, w, h, 0); 
```

这会将一个新的投影矩阵推送到投影堆栈上（我在这个项目中使用了 glut，但它应该只转换为普通的 OpenGL）。然后，我得到窗口的宽度和高度，并使用 gluOrtho2D 设置我的正交投影。

下一个：

```
glMatrixMode(GL_MODELVIEW);
glPushMatrix();
glLoadIdentity();
// Draw your quad here in screen coordinates 
```

Here I just push a new, clean matrix onto the modelview. You may not need to do this.

Lastly:

```
glPopMatrix() // Pops the matrix that we used to draw the quad
glMatrixMode(GL_PROJECTION);
glPopMatrix(); // Pops our orthographic projection matrix, which restores the old one
glMatrixMode(GL_MODELVIEW); // Puts us back into GL_MODELVIEW since this is probably what you want 
```

I hope this helps. As you can tell, it requires no use of the eye position. This is mainly because when we use a new orthographic projection that perfectly fits our window, this is irrelevant. This may not put your quad in the back however, if this is executed after the other draw calls.

EDIT: Turning off depth testing and clearing the depth buffer could help as well, as Boojum suggests.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T08:04:08.110

以下是我对每一帧使用的步骤：

1.  清除深度缓冲区`glClear(GL_DEPTH_BUFFER_BIT);`
2.  关闭深度测试`glDisable(GL_DEPTH_TEST);`
3.  加载一个固定的正交投影`gluOrtho2D(-1.0, 1.0, -1.0, 1.0);`
4.  按照你的描述画出你的四边形。
5.  重新打开深度测试。
6.  加载您的常规透视投影并绘制视图的其余部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T07:46:28.287

你不能把它放在背景中，如果你想要它在你身边，就把自己装进去。您需要先绘制它以使其位于所有对象的后面。

# cocoa-touch - 为使用 Interface Builder 添加的对象释放内存

> ID：468301
> 
> 赞同：0
> 
> 时间：2009-01-22T07:18:15.647
> 
> 标签：cocoa-touch, interface-builder

我有一种情况，我用一个表和另一个表头视图（包含图像、标签和按钮）构建一个视图。现在我将表格、图像、标签、按钮连接到我的 Controller 类中的变量。`-dealloc`我应该为使用 Interface Builder 连接的所有变量释放方法中的内存吗？我相信内存是自动为这些变量分配的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T08:11:22.653

答案最好由[Apple 的 Nib Objects 内存管理](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemMgmtNibObjects.html)文档提供。如果您的代码“拥有”NIB（即您调用了`+[NSBundle loadNibNamed: foo owner: bar]`），那么您的代码需要销毁 NIB 资源。

# c++ - 使用“非常困”的分析器来分析 DLL

> ID：468311
> 
> 赞同：18
> 
> 时间：2009-01-22T07:23:50.423
> 
> 标签：c++, profiling, verysleepy

我有一个要分析的 DLL。我尝试使用[Very Sleepy](http://www.codersnotes.com/sleepy/)，但我似乎无法让源文件列显示函数来自哪个源文件，它显示的只是“未知”。无论如何，我真的很困惑如何使用这个应用程序。任何人都可以指点我一些帮助吗？关于它的文档并不多，而且它似乎最近没有维护.. =/

谢谢..

编辑：添加另一个问题：

在这个应用程序中，术语排他性和包容性是什么意思？谢谢..

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-22T08:14:53.423

如果您想知道源文件和列，您将需要调试信息（PDB 文件）。除非您要求，否则该信息不会被保存。

* * *

不幸的是，探查器没有我能找到的文档。但是，[在进行分析时，有包容性和排他性的定义](http://blogs.msdn.com/b/profiler/archive/2004/06/09/152023.aspx)：

*   包含：在函数中花费的总时间
*   独占：函数花费的时间减去调用其他函数花费的时间

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T08:56:14.590

如果您已经拥有 PDB 文件，请记住将其保存在生成​​它的同一目录中。

如果您不记得它应该保存在哪个目录中，只需使用文本/十六进制编辑器打开您的 .exe 或 .dll 并滚动到文件的最后，pdb 目录就会在那里。至少，如果您使用的是 MSVC6，这是正确的。

我希望它有所帮助。

# eclipse - Eclipse插件开发由于java.lang.NoClassDefFoundError无法实例化类：

> ID：468316
> 
> 赞同：4
> 
> 时间：2009-01-22T07:25:11.043
> 
> 标签：eclipse, plugins

标题：Eclipse插件开发由于java.lang.NoClassDefFoundError无法实例化类：

试图构建一个 Eclipse 插件，但得到一些运行时错误..

我知道这是由于代码依赖的类文件，它在编译时存在但在运行时找不到......

我不确定我必须做些什么来解决这个问题。未找到的文件的源文件在我的项目工作区中。

包含源文件的项目也在问题项目的 JavaBuildPath 中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T07:38:03.297

您还需要将丢失文件的项目作为依赖项放入插件配置文件中。然后它将在运行时可用。

# sql - 数据库比较工具

> ID：468327
> 
> 赞同：5
> 
> 时间：2009-01-22T07:32:09.017
> 
> 标签：sql, sql-server, comparison, compare

有人使用过数据库比较工具吗？你会推荐哪一个？

我们目前正在使用 Redgate 的“SQLCompare”，但我很想知道市场上是否有更好的工具。

主要要求是他们应该能够将脚本文件夹与实时数据库进行比较。

谢谢，迪米

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T07:42:36.157

SQL比较是相当不错的。我还使用了 SQL Delta，它提供了更好的 delta 脚本。此外，如果您是 Visual Studio 用户，Visual Studio Team System Database Edition 也不是一个坏方法（包括用于自动化数据库构建和版本控制的 MSBuild 任务）。如果您获得了 VSTS 开发者版的许可，那么 VSTS DB（又名数据花花公子）现在也是免费的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T08:56:18.287

我为 Innovartis 工作，我们制作 DB Ghost，您可能想看看。它可以做你想做的事——将脚本与数据库进行比较。它可以通过构建和比较使用变更管理器一步完成。它非常非常快。构建数据库还为您提供了对数据库进行依赖性检查的额外好处，以防万一有人通过更改或引入另一段代码破坏了一段数据库代码。我们相信该软件提供了一种快速且经济高效地管理数据库更改的方法，并且与您的源代码控制相结合可以让您完全控制。像团队系统，但便宜得多。

脚本、构建、比较、升级、创建更改脚本、部署和复制数据库功能，这是免费的。www.dbghost.com

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T07:35:49.823

Redgate 的 SQL Compare 是我用于 db compare 的最佳工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T08:14:22.053

我已经使用[AdeptSQL](http://www.adeptsql.com/)工具很多年了，印象非常深刻。他们也有很好的支持，上次我看他们的价格很合理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T08:57:30.063

不错的比较工具在[TOAD for SQL server](http://www.toadsoft.com/toadsqlserver/toad_sqlserver.htm)中。它是独立的免费应用程序，但现在它只是完整包的一部分。但是您可以尝试测试版。您可以制作结构快照，并随时将实时服务器与快照进行比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T17:39:21.943

我真的很喜欢[Apex SQL 工具](http://www.apexsql.com)- 无论我更喜欢 Red-Gate 还是 Apex 工具来完成相同的工作，这总是有点麻烦 :-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-09T10:59:05.360

我们可以向您推荐一个可靠的[SQL 比较工具](http://www.devart.com/dbforge/sql/)，它可以将您的 SQL Server 数据库中的表数据的比较和同步速度提高 3 倍。这是[SQL Server 的 dbForge 数据比较](http://www.devart.com/dbforge/sql/datacompare/)。

主要优点：

*   大型数据库的更快比较和同步
*   支持本机 SQL Server 备份
*   表、列和模式的自定义映射
*   调整比较和同步的多个选项
*   生成比较和同步报告

加上 30 天免费试用和无风险购买以及 30 天退款保证。

# java - Java、GUI 构建器还是手动编码？

> ID：468328
> 
> 赞同：28
> 
> 时间：2009-01-22T07:34:33.617
> 
> 标签：java, forms, user-interface

我公司的软件形式很多，到现在都是手工写代码（MVC方式）。

我们正在考虑开始使用 GUI builder。

使用 Builder 几乎没有问题。

1.  部分代码 **不可读**。
2.  部分代码不可 **编辑**。
3.  以后编辑代码会更难。
4.  未来我们将不得不继续使用构建器，即使我们想替换构建器或手写，也没有人能保证该工具将来会可用和支持。

我想借鉴别人的经验：

*   你推荐使用工具还是我们应该继续手工编写代码？
*   哪个建设者更好？
*   他如何处理这些问题？（还有其他问题吗？）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-22T07:52:25.810

对于一些表单，我建议使用 Builder。它会更快地完成。但是，如果您有很多表单需要维护一段时间，我建议您不要使用构建器。在这种情况下，您花在阅读代码和维护上的时间远大于初始设计时间。因此，虽然构建器在初始阶段为您节省了一些时间，但它使代码阅读和维护更加困难。此外，它使代码重用变得更加困难，即使是从一种形式复制和粘贴到另一种形式也是如此。

我不知道您指的是 Web 应用程序还是桌面应用程序，但总的来说，我还没有找到能够产生优雅输出的 Java Gui 构建器。例如 Netbeans Swing 生成的代码就是一团糟。也许，如果有一个不错的建筑商，我会改变主意。我使用 Visual Studio 的表单设计器没有任何问题——它生成了很好的代码，你可以阅读和理解。

对于桌面应用程序，请查看[MiGLayout](http://www.migcalendar.com/miglayout/)。它是 Swing 和 SWT 的布局管理器，而不是构建器，它将让您的生活更轻松。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-22T07:50:32.927

通过使用一个好的构建器，开发会快很多。

您无法修改代码的焦虑可能是由于您在视图中有很多不属于它的逻辑。实际上，这种更改可能会帮助您将逻辑从视图中移出，这恰好有助于在不破坏代码的情况下更改视觉元素。

根据“不可读”，您应该考虑使用更好的 GUI 生成器。我只听说过有关 NetBeans 的积极消息，而且我使用了 IntelliJ GUI builder，它的代码非常干净。

两者的源代码都是可读和可编辑的，但仅用于细微调整。对于主要的，请使用 GUI 构建器。

我认为对于少数表格，手动处理没有问题，但是由于您刚才所说的“其中很多”，因此使用此工具将是最有益的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-22T07:58:32.960

这是我的经验：

我从不喜欢 GUI 构建器生成的代码。至少，在 VB 世界中，每个人（嗯，几乎）都不会使用同一个 IDE 来构建应用程序。在 Java 中，人们使用多种 IDE，有些人还使用 VIM 和记事本。并且所有 IDE 都不会生成相同类型的代码。另一个问题是，他们通常不理解其他 IDE 生成的代码。所以要回答你的第一个问题，**我不推荐**.

您的下一个问题：哪个建筑商更好？我上次使用时，**Netbeans**比我尝试过的大多数都好。

如果您因为需要更快地开发应用程序而必须使用 GUI 构建器，那么请确保您的所有团队成员都使用同一个构建器。最好听取他们的意见，否则 IDE 生成的源代码会伤害他们的眼睛。

让我们知道您的决定！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-19T14:02:19.167

我会远离 gui 建设者。根据我的经验（matisse），你最终会花费同样多的时间与构建器一起手动编写 gui，如果不是更多的话。由于在进行更改时尝试读取生成的代码并对其进行清理。另外，如果你手工写gui，你必须理解代码才能写gui，这将有助于加班变得更加熟练，你写gui的速度会更快，你会更快地手写它们. 随着时间的推移，您还可以为您发现自己多次编写的 gui 功能开发组件库。我会远离建筑商。一个优秀的开发者会在任何时候用一个建造者击败一个普通的开发者。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-07-10T22:17:57.863

在过去的 3 1/2 年里，我一直在为我的所有项目使用 Netbeans 的 Java Swing GUI Builder (Matisse)。我读过很多人对 GUI Builders 的抱怨，而且最有经验的程序员会责备每个甚至暗示要使用 GUI Builders 的人，但这是我的经验：

1.  永远不需要编辑不可编辑的代码。实际上，GUI Builder 为您的 GUI 提供了一个框架。您可以使用编辑器拖放、调整大小和约束组件，但表格的**内容**、组合框的列表等都需要在后端处理。GUI 构建器允许您专注于这一点，同时它负责使事物看起来漂亮并保持原位。
2.  所见即所得总是更有效率。文字处理器就是证明。人们会告诉你：“你不会过多地编辑 GUI 代码，所以如果它可以节省你的时间，那就没那么多时间了。” 但这种说法是极其相对的。当您在具有由于业务模型更改而需要不断更新的流程模型的软件环境中工作时，此陈述是错误的。另外，你大部分时间都花在你的英语论文的**内容**上，不是吗？所以这个论点会说所见即所得的文字处理器不会为你节省那么多时间，而且这样的说法会被置若罔闻，因为没有人愿意手动编码他们文章的外观。
3.  GUI Builder 没有什么是手写代码做不到的，而我花了几个小时试图用手写 GUI 代码解决一些小挑战，我在 GUI builder 中花了 1 分钟。

尤其是 Netbeans 的 GUI 构建器，这些年来已经变得非常好，以至于它收到的很多攻击（类似于 Java 收到的很多攻击）实际上已经无效。这是一个很棒的程序，它是一种以高效的方式构建功能丰富、美观的界面的好方法。我强烈推荐一个好的 GUI Builder，尤其是 Netbeans。

在那里，我说了算。

不，我不为他们工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T15:35:47.107

如果您没有太复杂的表单要构建，那么您可以看一下[DesignGridLayout](https://designgridlayout.java.net/)，它是 Swing LayoutManager ，具有流畅的 API，可以很容易地为您的表单编写代码并且易于阅读此代码（和维护，我的意思是如果需要修改）并通过代码可视化表单。

使用 DesignGridLayout，表单中的一行组件就是一行代码。没有 XML，完全的编译时安全。没有硬编码的间距值，对齐方式... DesignGridLayout 为您处理这一切。

学习曲线短，布局表单的速度与 GUI 设计师一样快！

从大约 2 年前我发现它开始，我就一直在专门使用它（我一直对 GUI 设计师过敏，因为生成的代码很糟糕）。这就是我在 8 个月前接手这个项目的原因，因为我想充分发挥它的潜力。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-22T07:53:19.083

我们手工完成，但有一个库帮助我们进行布局（[JGoodies Forms](http://www.jgoodies.com/freeware/forms/index.html)）等等。此外，我们使用一组预定义的组件插入到我们的 UI ( [Jide](http://www.jidesoft.com) ) 中。对我们来说效果很好。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-22T08:24:58.927

多年来，我使用过许多 GUI 设计器（针对不同的语言）：Delphi、Visual Studio、JBuilder、Netbeans。

他们生成的代码质量和数量很重要。Delphi 非常棒，它生成的代码相对于表单大小而言很少，而且代码很容易理解，而且双向工具让您可以放心地更改生成的代码。这得益于一个简单理解的 GUI 库。VS 会产生大量代码，而您确实害怕更改它。

Java 部分被语言所拖累，没有委托或闭包，因此基于事件的代码很快就会蔓延开来。

我会用 Netbeans Matisse 敲出简单的东西，然后——一旦有信心——手工编码。复杂的东西值得计划和手工编码，这样你就可以很好地定义你的模型。

如果您构建一个可以重用的自己的 GUI 组件库，这将很有帮助。这与具有 GUI 库的所有语言相关。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-22T08:40:48.210

对于有*很多*简单表单的系统，我倾向于走 XML 路线 -

*   为每个表单的信息和任何工作流程定义 XML 文件
*   创建 XSLT 以生成 Java/XHTML/任何代码以在桌面 PC/移动/网络上运行表单
*   还创建 XSLT 以生成源代码数据对象等。

您可以使用 XForms 及其实现，但通常我工作的地方是购买解决方案比构建自己的简单 XSLT 需要更长的时间。如果表单中没有太多专门的小部件，通常需要一周的时间才能使所有内容启动并运行。如果您制作自己的代码生成器，则可以完全控制。如果您发现您想要将所有表单从向上/向下滚动切换为在列中显示，那么您只需更改一个地方，而不是更改每个表单的实现。（虽然您可以创建一个框架来从 Java 中的表示中抽象出表单信息，但它不太适合这种声明式编程）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-22T07:52:32.910

我个人非常喜欢将 GUI 布局与代码分开（否则您最终会遇到刚才提到的问题）。这似乎也是一种趋势：微软有他们的 XAML，你不断听到 MVC 的不同视图引擎等。

为什么不采用基于 XML 的 GUI 设计呢？您可以尝试[JFormDesigner](http://www.jformdesigner.com/doc/help/index.html)之类的东西，它可以同时处理 XML 和代码生成的布局。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-22T08:05:14.567

我最近一直在做这两件事——我正在使用 Netbeans，最初对生成的代码缺乏控制感到沮丧。然后我发现您可以从 GUI 构建器添加自定义代码，从而克服了大部分问题。但是，我对 NetBeans 中的布局管理器感到更加沮丧，并发现这对我的工作效率的影响最大。我现在改用[MiGLayout](http://www.miglayout.com)并手动完成大部分编码。话虽如此，NetBeans 总体来说还是不错的，也许我应该花更多的时间来学习 GroupLayout。

如果您正在进行团队开发，请确保您都使用相同的工具（如果依赖 GUI 构建器）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-05-31T18:19:11.903

如果您的表单很简单且不是动态的，那么 GUI 构建器就是完美的选择。表单越复杂，使用 GUI builder 获得的好处就越少。

我工作的公司就是这样做的。使用 GUI 构建器开发更简单的应用程序，手动完成更复杂的应用程序。一旦有足够的时间试图解决 GUI 构建器的限制，它通常会被放弃。此外，每个 GUI 构建器的创建方式并不相同，因此您需要进行一些评估才能确定 GUI 构建器在哪些情况下是合适的。（NetBeans GUI Builder 非常好。）

就我个人而言，我喜欢使用 GUI 构建器来构建应用程序/表单的整体布局并使用不同的布局，但随后我将其转换为更具可读性的代码并手动完成其余的工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-23T22:48:54.610

我过去使用 Netbeans 构建 GUI 代码并使用 Eclipse 编写程序逻辑。只需将 GUI 代码作为单独的 LINKED 源文件夹包含在内。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-30T22:07:52.997

无论您是否使用 GUI 编辑器构建 GUI 表单，我都强烈建议您开发一组可以放置在表单上的标准“bean”面板。

我们有大约 100 个这样的 bean，我们以 600 多种形式使用过。下面是一张显示这些豆子之一的图片：

![在此处输入图像描述](https://i.stack.imgur.com/ELyOQ.png)

该面板由一个标准标签、一个强制指示符（红色星号）、一个编辑器字段（在本例中为组合框）和一个仅显示字段（灰色框）组成。在这种情况下，组合框和仅显示字段是互斥的 - 一次只有一个可见，具体取决于表单/字段所处的模式。

这些 bean 包含我们的标准（框架）功能，其中包括标准的外观颜色、字体等。如果我们想要更改这些字段的所有出现的方式或它们的外观，我们在一个类中进行更改它会在包含它的所有形式上发生变化。

现在，我们如何构建表单？好吧，我们在 NetBeans Matisse GUI 构建器中完成所有表单。我们对此非常满意。虽然您无法编辑它生成的代码，但我从未遇到过任何阻止我在 GUI 中执行某些操作的实例。我上面提到的 bean 可以很容易地添加到 Palette，因此将它们添加到表单是一个拖放操作。

在我看来，有一些技术可以让事情变得更容易。我们在大多数表单上使用`BoxLayout`（在页面轴上），并结合我们的标准 bean 面板，构建表单实际上只需几分钟即可完成（至少在图形方面）。此外，`FlowLayout`如果您在表单上的同一“行”上有多个控件（例如多个复选框），这也很有用。

而且这也很容易，这意味着我们可以让一些（非程序员）业务分析师在程序员“幕后”添加代码之前构建表单。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-01-07T07:08:34.273

我从 VB 程序员开始，然后转向 C#。我想说 Netbean GUI builder 离微软还很远，尤其是表单中的布局管理器。当您尝试移动按钮和标签以与您想要的对齐并且那些您不想移动的图标开始在整个地方移动时，它会变得非常沮丧。

自动生成的代码也不能在源代码中编辑，这使得它更加非用户友好

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-24T20:47:55.387

我会说，如果您对您正在尝试做的事情有足够的了解并且您可以自己做，那么您只能使用 GUI 构建器。

# javascript - 在 HTML 中包含一个 js 文件

> ID：468329
> 
> 赞同：0
> 
> 时间：2009-01-22T07:34:36.157
> 
> 标签：javascript, header

我在我的 HTML 中包含一个巨大的 javascript 文件（500K）。有没有一种聪明的方法可以知道它是否已加载。我能想到的一种方法是在其构造函数中有一个变量来初始化并通知我。加载是异步的，在包含该 JS 的 function 之前我无法继续。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T08:11:38.673

通过使用 jQuery，您可以处理加载脚本文件时运行的回调函数：

```
$.getScript("yourScriptFile.js", function(){
  // What to do when the script is loaded
}); 
```

[文档](http://docs.jquery.com/Ajax/jQuery.getScript)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T08:19:53.213

作为对奥斯卡答案的澄清：

```
<script type='text/javascript' src='script.js'></script>
<script type='text/javascript'>
 alert('the file has loaded!'); 
 //Anything here will not be executed before the script.js was loaded
</script> 
```

此外，如果文件很大，最好在页面加载后加载它，以便您在连接速度较慢的情况下可以在加载之前使用该页面：

```
<头部>
<script type='text/javascript' src='script.js'></script>
</head>
<正文>
 在脚本完成加载之前，这里不会呈现任何内容
</正文>

```

更好的是：

```
<头部>
</head>
<正文>
 我将立即被渲染
</正文>
<script type='text/javascript' src='script.js'></script>
</html>

```

这样用户就可以快速获得页面，然后才需要等待 javascript 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T07:56:18.500

```
<SCRIPT LANGUAGE="JavaScript" SRC="filename">
</SCRIPT> 
```

??

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T08:01:41.377

您是否尝试过压缩 javascript 文件？将一些函数移动到单独的 Javascript 文件中，并且只包含所需的 javascript？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T08:16:47.900

您可以在脚本文件的末尾调用一个函数，该函数将通知页面上的脚本它已准备好使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T13:16:53.423

也许这个问题可以重述：我怎么知道我的脚本被加载到一个 html 页面中？将脚本放在页面底部可以确保所有 DOM 元素都可用于您的脚本。当您想知道您的脚本是否可用时，您应该检查要运行的函数是否可用。也许这个构造函数可以帮助：

```
function Wait(what,action,id){
 var _x = this,
     rep = document.getElementById('report'),
     cnt = 0,
     timeout = 5,
     interval = 100;

  _x.id = id;

  if (!(what instanceof Function)) {
   return true; //or say something about it
  }

  function dowait() {
   cnt += interval;
   if (what())
   {
      clearInterval(_x.iv);
      action();
      return true;
   }
   if (cnt>(timeout*1000))
   {
      clearInterval(_x.iv);
          //[do some timeout-action]
      return true; 
   }
 }
 _x.iv = setInterval(dowait,interval); 
```

}

构造函数将一个函数（返回一个布尔值）作为它的第一个参数。像

```
function(){return document.getElementById('someelement').innerHTML = '';} 
```

因此，如果您在 javascript 之前包含此内容，则可以执行以下操作：

```
var testfn = 
     function(){return document.getElementById('someElement').innerHTML = '';},
   callback = 
     function(){alert('someElement is empty')},
   dummy = null;
window.onload=function(dummy=new Wait(testfn,calllback); 
```

# .net - <,> 在xml文档中

> ID：468334
> 
> 赞同：0
> 
> 时间：2009-01-22T07:38:32.280
> 
> 标签：.net, xml

当我尝试在 xml 标记的 InnerText 部分中插入 < 或 > 之类的符号时，然后在通过 xmlDocument.InnerXml 访问 xml 之后，这些符号将被它们的 html 代码替换为 < 或 >，有人可以向我解释一下吗？也许给我一个解决这个问题的方法？

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T07:41:53.290

这些符号必须转义，因为尖括号用作文档结构。要解决此问题，只需确保正确解码文本即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T07:45:30.130

您也可以尝试将您的文本包含在[CDATA 部分](http://www.w3schools.com/XML/xml_cdata.asp)中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T07:50:59.213

根据XML 文件中的定义（参见[规范](http://www.w3.org/TR/2006/REC-xml-20060816/)`<`），用于打开元素。同样，`>`用于关闭一个元素。

为了允许这些（以及一些其他字符）出现在 XML 文件中，它们被编码为[实体](http://www.w3.org/TR/2006/REC-xml-20060816/#sec-references)。

您应该会发现这一切都是透明地为您处理的 - 如果您将 a`<`放入元素的内容中，它将被存储为`&lt;`，然后在您再次取出内容时将其翻译回来。

如果这是因为您试图在输出文件中添加额外的元素而妨碍您，您应该查看用于直接创建元素的各种 API —— 编写文本将会失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T07:46:51.250

这取决于您希望在内部文本中出现的内容。如果您实际上是在尝试插入新元素，则最好将新节点添加到 Nodes 集合（类型 = 元素）中。如果您确实想要呈现为 < 和 > 的文本，那么这已经完全符合您的需要。

如果您可以解释您希望通过此操作获得的最终结果，我们可以准确地告诉您需要做什么。

# sql-server - SQL Server - 更改 PK 数据类型的最佳方法是什么？

> ID：468345
> 
> 赞同：1
> 
> 时间：2009-01-22T07:45:46.213
> 
> 标签：sql-server, database, sql-server-2005, primary-key

我目前有一个包含大约 20 个参考表的数据库，例如产品、资产、仓库、用户等。这些信息存储在中央数据库中，并下载到在路上的工程师的 PDA 上。我数据库中的每个表都有一个唯一标识符的 PK（即 GUID）。

经过 2 年的产品开发，我意识到我从不做也永远不需要编辑这些参考表中的任何一个。因此，他们不需要将 UniqueIdentifiers 作为主键。

由于我在通过 Web 服务将所有集合发送到 PDA 之前对它们进行序列化，因此由于 GUID 的长度，实际的序列化数据非常庞大。

无论如何，切入正题 - 我想将表的所有 PK 更改为 IDENTITY Ints。有什么简单的方法可以做到这一点，还是我必须按照切断所有 FK，创建临时表，然后编写一些软件来重新映射数据？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:25:35.573

首先 - 大声笑。我认识贵公司的许多其他人......“哇 - GUID 很酷，我将在任何地方使用它们......” 至少你认识到走这条路的一个问题。

其次 - 您可能会发现这些命令很有帮助：

```
exec sp_MSforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL' 

<do stuff here>

exec sp_MSforeachtable 'ALTER TABLE ? CHECK CONSTRAINT ALL' 
```

第三 - 它说的部分 - 在这里做东西 -

```
1) add an int autoincrementing identity column to ref table
2) set the current fk guid in data tables to the db key you just created in step 1
3) rinse/repeat for each ref table/data table combination
4) after all is done, refactor code to use id (int) instead of guid 
```

以防万一您需要调整/修复任何东西，我会让向导单独待几个月。在将来的某个时候，您应该能够从您的参考表中删除 guid。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T07:55:46.973

如果你有 FK 引用你的 PK，那么你就有大麻烦了。我猜您使用 GUID 是因为您的应用程序 (PDA) 的分布式特性，并且最初的意图可能是从这些 PDA 添加新数据，在这种情况下 GUID 是理想的。不利的一面是您无法在 GUID 上建立索引。

我的建议是不要一开始就使用身份整数。首先，禁用您的 FK。为对该 PK 的所有引用（即所有具有 FK 的表）添加一个新列，即 INT（不是标识）。然后对于每个 GUID，创建一个新的 int（下一个值）并将其插入到 guid 以及其他表中对 guid 的所有引用。然后为 int 打开新的 FK，然后将您的 PK 转移到新的 int 列。最后删除您的 GUID 列，然后重建您的索引。

希望这不是太乱码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T07:56:05.320

只要您有一些唯一的字段（或一组字段），您就可以将 PK 重新分配给该字段。即，如果您不需要 guid，您可能也不需要 IDENTITY 代理键。总的来说，最简单的事情就是在一个或多个唯一的非空现有列上使用 PK。

否则，只需添加一个 IDENTITY 列并将 PK 重新分配给它。（它会在您保存更改后的表时填充。）然后您可以使用 guid 删除该列。

（我假设我们正在讨论这个问题，因为您的 guid 列当前没有用于任何事情。即使它是另一个表中的 FK，如果您有唯一的列要加入，您也不需要它.)

如果这些都不符合您的情况，请再次发布更多详细信息。这可以毫不费力地完成。

（我不确定为什么您认为即使要编辑表，您的主键也需要唯一标识符，顺便说一句。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T07:57:37.343

好吧，我不明白的是，一方面您声明您不需要 Id 列，但另一方面您正在通过您的网络服务发送它们。

因此，我会首先查看我的查询，以查看获取的内容并根据返回的结果集进行优化。

更改 PK 是一项艰巨的任务，但在“SQL 比较”的帮助下，它可以完成。

# git - 匹配 SHA1 的正则表达式

> ID：468370
> 
> 赞同：46
> 
> 时间：2009-01-22T07:58:50.790
> 
> 标签：git, sha1

我正在尝试将通用文本中的 SHA1 与正则表达式匹配。

理想情况下，我想避免匹配单词。

可以肯定地说，完整的 SHA1 具有独特的模式（它们很长且长度一致） - 所以我可以可靠地匹配这些 - 但是缩写的 SHA1 呢？

我可以依赖数字的存在吗？

查看我的提交日志中的 SHA1 - 数字总是出现在前 3 个字符中。但这太短了吗？在我假设一个数字会出现之前，我需要考虑多少个 SHA1 字符？

这不一定是 100% 准确 - 我只需要 99% 的时间匹配缩写的 SHA1。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-22T08:04:56.440

您可以认为 SHA1 哈希是完全随机的，因此这减少了概率问题。给定数字不是数字的概率是 6/16，即 0.375。三个 SHA1 数字都不是数字的概率是 0.375 ** 3，或 0.0527（5% ish）。在六位数时，这再次减少到 0.00278 (0.2%)。在五位数时，所有字母的概率下降到 1% 以下（你说你想匹配 99% 的时间）。

制作始终与 SHA1 值匹配的正则表达式很容易：

```
\b[0-9a-f]{5,40}\b 
```

但是，这也可能匹配完美的五个字母单词，例如“添加”或“褪色”。在我的`/usr/share/dict/words`文件中，有几个六个字母的单词会匹配：“accede”、“beaded”、“bedded”、“decade”、“deface”、“efface”和“facade”是最有可能的。在七个字母中，只有不太可能出现在散文中的“契约”。这完全取决于您可以容忍多少误报，以及您实际遇到的可能单词是什么。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-22T08:15:26.623

你到底想做什么？你不应该需要用启发式解析任何 git 输出——你总是可以准确地请求你需要的数据。

如果要匹配 SHA1 和的完整十六进制表示，请尝试：

```
/\b([a-f0-9]{40})\b/ 
```

也就是说，一个由 40 个字符组成的单词，这些字符要么是数字，要么是字母 a 到 f。

如果你只有几个字符并且不知道它们在哪里，那么你就很不走运了。“e78fd98”是缩写的提交 ID 吗？也许吧，但是“1234567”呢？那是提交ID吗？有问题的票号？使测试失败的数字？

没有上下文，您无法真正了解数据的含义。

要回答您的直接问题，SHA1 没有属性可以使前三个字符（以十六进制形式）为数字。你只是幸运，或者可能是不幸，这取决于你如何看待它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-22T08:25:29.613

我将假设您想要匹配 SHA1 的十六进制打印表示，而不是与等效的 20 个原始字节匹配。此外，我将假设所讨论的 SHA1 仅使用小写字母来表示十六进制数字。如果您的要求不同，则必须调整正则表达式。

```
grep -o -E -e "[0-9a-f]{40}" 
```

将匹配这样的 SHA1。您需要将上述正则表达式从 egrep 的方言转换为您碰巧使用的任何工具。由于匹配必须正好有 40 个字符长，我认为您不会有意外匹配单词的危险。我不知道任何仅由字母 a 到 f 组成的 40 个字符的单词。

编辑：

更好的是：使用[A Regex 匹配 SHA1](https://stackoverflow.com/questions/468370/a-regex-to-match-a-sha1#468397)，因为他的解决方案包括检查两端的单词边界。我忽略了上面的那个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-02T06:08:31.107

如果您有权访问 repo，则可以使用`git cat-file -e`它来检查它是否代表 repo 中的对象。这也非常快。如果您进一步想将其限制为仅提交和标签，您可以使用`git cat-file -t`来找出对象的类型。

例如，这可用于搜索人工生成的文本以查找提及 git 提交并生成指向 git Web 界面的超链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-29T22:40:09.983

我在红宝石中使用它。它允许 sha 的简短版本（在发生冲突的情况下为 6 - 8）和 40 个字符长的完整 sha。

```
\A(([0-9a-f]{40})|([0-9a-f]{6,8}))\z 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-08-28T13:31:32.063

对于这种类型的哈希 : `43:A4:02:B7:B6:1D:89:86:C5:CE:AD:52:96:D9:2E:7B:64:98:45:6A`:

```
/^[0-9A-F]{2}(:[0-9A-F]{2}){19}$/ 
```

# java - 对线程概念的怀疑

> ID：468372
> 
> 赞同：-2
> 
> 时间：2009-01-22T08:00:42.503
> 
> 标签：java

> **可能重复：**
> [如何在 java 中重新启动线程？](https://stackoverflow.com/questions/468266/how-to-restart-thread-in-java)

我创建了一个在源文件夹中搜索文件的程序。如果找到任何文件，它会处理该文件并将文件移动到目标文件夹并在源文件夹中查找新文件。就像它必须继续检查文件的源文件夹一样。我使用线程在源文件夹中查找文件。我面临的问题是在文件进程线程停止期间抛出任何异常。即使在文件处理期间抛出异常，我也希望线程能够运行。它必须将该错误移到其他文件夹中并在源文件夹中查找新文件。我怎样才能让线程继续运行？

实际上有 4 个源文件夹和 4 个目标文件夹。我必须在每个源和目标对中执行相同的操作。所以我在一个类中创建了 4 个线程，在第二类中创建了搜索操作，在第三类中创建了文件处理。

```
class MainClass
{
    public static void main(String[] args){
        for(int i=0;i<4;i++){
           SearchClass search = new SearchClass();
           Thread thread = new Thread(search);
           thread.start();
       }
   }
}

class SearchClass implements Runnable
{
   public void run() {
     try {
        searchfile();
     } catch(Exception e) {
        e.printStackTrace();
     }
   }

   public void searchfile(){
     try{
        ProcessClass p = new ProcessClass();
        p.fileProcess();
     }catch(Exception){
        e.printStackTrace();
     }
   }
}

class ProcessClass
{
    public void fileProcess(){
      try{
          .........................
          ...........  -----> 
          // Thread1 throws exception here and get stopped.
          // Its searching file in source folder again.
      }catch(Exception){
          e.printStackTrace();
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T08:09:54.887

这与线程无关，而与异常处理有关。

您的线程可能应该通过一个循环：

*   尝试在源文件夹中查找文件
*   如果没有，你就完成了（或者可能等待一段时间再试一次）
*   处理文件
*   捕获您理解的任何异常，并采取适当的措施 - 例如记录、将文件移动到“错误”文件夹，无论
*   返回步骤 1

# .net - 在 .NET 中，同一台机器上的两个进程进行通信的最佳方式是什么？

> ID：468375
> 
> 赞同：6
> 
> 时间：2009-01-22T08:02:48.660
> 
> 标签：.net, process, communication

同一台机器上的两个进程使用 .NET 进行通信的最佳（或者可能不是最好的——只是好的）方式是什么？

实际上，我正在开发的应用程序中的两个进程甚至不是两个不同的程序。它们只是同一个 EXE 的两个实例。我想做类似单例应用程序的事情，但每个用户都有它（意味着具有多个用户的终端服务器或 Citrix 或 App-V 服务器应该能够启动他们自己的应用程序的单个副本）。如果另一个实例由同一个用户运行，它应该将任务委托给已经运行的实例，然后退出。该程序的每个用户只能运行一个实例。到目前为止，我已经完成了（感谢 StackOverflow）使用 Mutex 检测应用程序实例是否已在运行的部分。但我需要第二个应用程序实例才能将数据发送到第一个应用程序实例。

我倾向于为此使用命名管道和 WCF 的 NetNamedPipeBinding，但如果您有更好的想法，我将不胜感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:06:30.447

命名管道通常是最好的，但也考虑使用 MSMQ 来确保消息随时间传递。这实际上也取决于您的消息大小。TCP 会变得很棘手，因为您需要每个用户都有一个唯一的端口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T09:55:48.260

IPC 是我过去为此使用的。这非常容易。.Net 远程处理**是**一个不错的选择，但不幸的是，它是一个受限选项，因为您不能例如在 CF 上使用它。

下面是我用来执行进程间通信的类的副本，如果您愿意，可以将它与 MutEx 结合使用，但这不是必需的。只要两个进程中的“pMappedMemoryName”和“pNamedEventName”相同，它就可以正常工作。我尽量让它成为事件驱动的。

只需使用 Poke 方法写入数据，并使用 Peek 方法读取数据，尽管我将其设计为在有新数据可用时自动触发事件。通过这种方式，您可以简单地订阅 IpcEvent 事件，而不必担心昂贵的轮询。

```
 public class IpcService {
    private IServiceContext mContext;
    const int maxLength = 1024;
    private Thread listenerThread;
    private readonly string mMappedMemoryName;
    private readonly string mNamedEventName;
    public event EventHandler<TextualEventArgs> IpcEvent;
    private readonly bool mPersistantListener;

    public IpcService(bool pPersistantListener)
      : this(pPersistantListener, "IpcData", "IpcSystemEvent") {
      ;
    }

    public IpcService(bool pPersistantListener, string pMappedMemoryName, string pNamedEventName) {
      mPersistantListener = pPersistantListener;
      mMappedMemoryName = pMappedMemoryName;
      mNamedEventName = pNamedEventName;
    }

    public void Init(IServiceContext pContext) {
      mContext = pContext;
      listenerThread = new Thread(new ThreadStart(listenUsingNamedEventsAndMemoryMappedFiles));
      listenerThread.IsBackground = !mPersistantListener;
      listenerThread.Start();
    }

    private void listenUsingNamedEventsAndMemoryMappedFiles() {
      IntPtr hWnd = EventsManagement.CreateEvent(true, false, mNamedEventName);
      while (listenerThread != null) {
        if (Event.WAITOBJECT == EventsManagement.WaitForSingleObject(hWnd, 1000)) {
          string data = Peek();
          EventsManagement.ResetEvent(hWnd);
          EventHandler<TextualEventArgs> handler = IpcEvent;
          if (handler != null) handler(this, new TextualEventArgs(data));
        }
      }
      EventsManagement.SetEvent(hWnd);
      Thread.Sleep(500);
      HandleManagement.CloseHandle(hWnd);
    }

    public void Poke(string format, params object[] args) {
      Poke(string.Format(format, args));
    }

    public void Poke(string somedata) {
      using (MemoryMappedFileStream fs = new MemoryMappedFileStream(mMappedMemoryName, maxLength, MemoryProtection.PageReadWrite)) {
        fs.MapViewToProcessMemory(0, maxLength);
        fs.Write(Encoding.ASCII.GetBytes(somedata + "\0"), 0, somedata.Length + 1);
      }
      IntPtr hWnd = EventsManagement.CreateEvent(true, false, mNamedEventName);
      EventsManagement.SetEvent(hWnd);
      Thread.Sleep(500);
      HandleManagement.CloseHandle(hWnd);
    }

    public string Peek() {
      byte[] buffer;
      using (MemoryMappedFileStream fs = new MemoryMappedFileStream(mMappedMemoryName, maxLength, MemoryProtection.PageReadWrite)) {
        fs.MapViewToProcessMemory(0, maxLength);
        buffer = new byte[maxLength];
        fs.Read(buffer, 0, buffer.Length);
      }
      string readdata = Encoding.ASCII.GetString(buffer, 0, buffer.Length);
      return readdata.Substring(0, readdata.IndexOf('\0'));
    }

    private bool mDisposed = false;

    public void Dispose() {
      if (!mDisposed) {
        mDisposed = true;
        if (listenerThread != null) {
          listenerThread.Abort();
          listenerThread = null;
        }
      }
    }

    ~IpcService() {
      Dispose();
    }

  } 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T08:55:49.910

我会选择命名管道。

基本上，每个用户都需要一个唯一的端点。与您的 Mutex 一样，您可能会使用用户名来找出要使用的命名管道的名称。这甚至可能取代您对 Mutex 的使用：尝试找出此特定的命名管道是否已经存在，如果存在，则意味着您是第二个运行的实例。

将 TCP 端口映射到用户更难。

哦，通过使用命名管道，我实际上是在说“通过命名管道进行远程处理”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T08:55:18.070

Sendmessage/Postmessage 和 Getmessage 是我喜欢的 API。

[发送消息： http](http://pinvoke.net/default.aspx/user32.SendMessage) ://pinvoke.net/default.aspx/user32.SendMessage

[留言： http](http://pinvoke.net/default.aspx/user32.PostMessage) ://pinvoke.net/default.aspx/user32.PostMessage

获取消息：http :
[//pinvoke.net/default.aspx/user32.GetMessage](http://pinvoke.net/default.aspx/user32.GetMessage)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T08:31:11.847

.Net Remoting 也可能很方便。它快速且易于实施。

[在 MSDN 上阅读更多内容](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.71).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T08:50:01.013

您可以将 Mutex 的范围设置为“会话本地”，方法是在其名称前加上“Local\”；阅读[MSDN](http://msdn.microsoft.com/en-us/library/f55ddskf.aspx)了解更多信息。通过这种方式，您可以限制每个终端会话的流程实例（好吧，这不是您所要求的）。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-22T09:56:01.583

另一种方法是使用旧的 DDE（动态数据交换）： http: [//www.codeplex.com/ndde](http://www.codeplex.com/ndde)

DDE 建立在 Windows 消息之上，但在它之上是一个抽象层。

（是的，我喜欢我的朋友 WIN32-api）；）

# tfs - TFS 有哪些 ALM 替代方案？

> ID：468377
> 
> 赞同：3
> 
> 时间：2009-01-22T08:04:17.033
> 
> 标签：tfs, alm

我也熟悉开发室中使用的“Subversion + Cruise Control + Fogbugz + nCover + ...”设置。但是还有哪些其他选择？在这两种组合之外，我很天真。我来自 .net 世界，也许 Ruby 开发人员的 LISP 做的完全不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T18:11:22.020

我主要关注在 .NET 中开发的开源软件堆栈（Microsoft Project 除外，当您需要处理非常复杂的项目时，它没有任何替代方案）。

简而言之，主要的软件成分是：

*   CruiseControl.NET
*   颠覆
*   Trac (issues + wiki + SVN) / 开源项目的谷歌代码
*   NCover、NUnit、FxCop、SandCastle、Wix、Lokad 共享库、Autofac、FxCop 等。

**项目管理方法：**以 PM 风格开始项目（大量计划、澄清和原型设计），进入第一个版本（功能最少，所有服务都是模拟的，简单的 UI），然后打开持续集成并切换到敏捷（同时仍在使用 PM 进行更大规模的计划和调度）。

**相关链接：**

*   [我一直在使用的软件](http://abdullin.com/journal/2008/1/3/development-software-requirements-for-the-xlim-2-solutions.html)
*   [共同发展原则](http://abdullin.com/journal/2008/1/8/common-development-principles-for-xlim.html)
*   [组件驱动的应用程序开发](http://abdullin.com/journal/2009/6/3/developing-component-driven-applications-powered-by-ioc-cont.html)
*   [xLim 开发方法](http://abdullin.com/xlim/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T05:45:25.413

在此处查找[应用程序生命周期起点](http://en.wikipedia.org/wiki/Application_Lifecycle_Management)

[ALM + TFS 链接在这里](http://blogs.msdn.com/markcarroll/pages/alm-using-vsts-tfs-more-links-than-you-shake-a-stick-at.aspx)

有些人（例如我）所做的只是让[Git](http://git-scm.com/) 进行源代码版本控制，并使用 SharePoint (WSS 3.0) 或 MOSS 和/或 Microsoft Office Project 分别执行项目管理

（[Windows 应用程序](http://en.wikipedia.org/wiki/Microsoft_Project)、[服务器](http://en.wikipedia.org/wiki/Microsoft_Office_Project_Server)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-06T08:35:40.997

关于代码质量检查、架构探索、代码版本差异等等……你可以看看[NDepend](http://www.ndepend.com/)。

# python - 用于将文件分类到文件夹中的 Python 代码

> ID：468383
> 
> 赞同：3
> 
> 时间：2009-01-22T08:07:43.113
> 
> 标签：python, scripting, recovery

Python 2.5.1

[http://www.cgsecurity.org/wiki/After_Using_PhotoRec](http://www.cgsecurity.org/wiki/After_Using_PhotoRec)

我刚刚运行了 PhotoRec，作为将文件类型分类到它们自己的文件夹中的一种方式给出的代码返回了这个错误。关于如何改变的任何建议？谢谢 ：

[EDIT2：两点：

1.  这个问题被否决了，因为它是代码的“用法”，而不是编程问题。它是否符合编码问题？我认为是的。
2.  我已经返回并编辑了代码来自的页面，以阐明对参数的需求以造福他人。]

    gyaresu$ python recovery.py Traceback（最近一次调用最后一次）：文件“recovery.py”，第 8 行，在 source = sys.argv[1] IndexError: list index out of range

脚本：

```
#!/usr/bin/env python
import os
import os.path
import shutil
import string
import sys

source = sys.argv[1]
destination = sys.argv[2]

while os.path.exists(source) != True:
    source = raw_input('Enter a valid source directory\n')
while os.path.exists(destination) != True:
    destination = raw_input('Enter a valid destination directory\n')

for root, dirs, files in os.walk(source, topdown=False):
    for file in files:
        extension = string.upper(os.path.splitext(file)[1][1:])
        destinationPath = os.path.join(destination,extension)

        if os.path.exists(destinationPath) != True:
            os.mkdir(destinationPath)
        if os.path.exists(os.path.join(destinationPath,file)):
            print 'WARNING: this file was not copied :' + os.path.join(root,file)
        else:
            shutil.copy2(os.path.join(root,file), destinationPath) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T08:14:34.033

它只是意味着程序需要两个命令行参数：源和目标。如果您希望在另一个函数中使用相同的代码，请将 sys.argv[1] 和 [2] 替换为您自己的变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T08:57:37.207

或者您可以修改原始脚本并添加

```
if len(sys.argv) != 3:
    print "Require 2 arguments: %s <source> <destination>" %(sys.argv[0])
    sys.exit(1) 
```

在导入语句之后进行正确的错误处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T08:55:29.427

由于脚本会在路径不存在时询问路径，因此您可以将程序参数设为可选。

改变

```
source = sys.argv[1]
destination = sys.argv[2] 
```

到

```
source = sys.argv[1] if len(sys.argv > 1) else ""
destination = sys.argv[2] if len(sys.argv > 2) else "" 
```

# c++ - “不继承，不包含”或“继承，不包含”

> ID：468388
> 
> 赞同：0
> 
> 时间：2009-01-22T08:10:59.313
> 
> 标签：c++, inheritance

我有一个应用程序，它产生了很多子对象，每个子对象都与一些全局应用程序对象一起工作，例如在全局应用程序注册表中注册自身，更新应用程序统计信息等。

应用程序应该如何将访问这些全局对象的能力转移给孩子？每个孩子都应该从静态 CRegistry 和 CStatistics 继承，还是应用程序在创建时将 Registry 和 Statistics 传递给孩子？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:13:42.990

从 CRegistry 继承似乎很奇怪——子对象不仅仅是专门的注册表，是吗？他们与注册表的交互只是为了注册自己，然后在注册表中找到，我想。同上统计。

在我看来，注册表和统计信息当然应该适当地传入（例如，传入构造函数）。如果对象只需要注册然后稍后可以找到，您甚至可能不需要将注册表保留为成员变量。

如果这真的是一个单一的全局注册表，那么它*可能*是使用单例模式的好时机——尽管根据我的经验，这往往会使测试变得更加困难。

或者，*创建*对象的任何东西都可以注册它们吗？它真的应该是子对象的工作吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T08:38:51.800

不，他们当然不应该从注册表继承。在每个中包含一个注册表对象似乎也有点矫枉过正，而且肯定意味着大量重复的代码。

我个人可能会选择 mixin 方法。沿着 MRegistryObjectMixin 的思路创建一个类，它封装了注册（和注销）然后继承（可能是私有的，所以你有'is-implemented-in-terms-of'，而不是'is-a'语义）的过程进入所有需要注册的对象。在设计你的继承树时要小心，这样你也可以避免可怕的“死亡钻石”。

# windows - GetOpenFileName 更改目录

> ID：468398
> 
> 赞同：1
> 
> 时间：2009-01-22T08:15:33.407
> 
> 标签：windows, dialog, openfiledialog

**问题：**

有谁知道如何更改已经运行的打开文件对话框的当前目录？

**细节：**

我有一个自定义的打开文件对话框（使用自定义模板添加额外的控件），它还关闭了所有验证、现有检查和创建测试（通过 OpenFileName 标志）。

关闭这些功能会禁用对话框的内置行为，如果用户在“文件名”组合框中键入文件夹名称并按回车键，对话框会更改当前显示的文件夹。

我想重新添加该行为。我可以通过钩子程序检测到何时发生这种情况。我已经隐藏了 OK 按钮，关闭了它的加速器，并将我自己的“选择”按钮放在了控件上。这意味着我收到 CDN_FILEOK 消息的唯一时间是用户在键入后在文本框中按 Enter 键。

但是，我无法弄清楚如何以编程方式告诉对话框更改当前目录。

我在想我可以通过向窗口中的 SHELLDLL_DefView 控件发送某种消息来完成此操作，但我无法找到任何文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T08:28:35.410

我不确定直接的答案，但是如果您有 SPY++ 或任何其他消息侦听程序，请尝试检查在更改普通 OpenFileName 对话框的目录时经过的消息。您可能会在那里找到答案（尽管这是一个艰难的出路）。

不过，其他人可能会立即知道答案；让我们希望他们这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T00:14:28.043

我能够找到解决方法。

事实证明，当关闭验证时，输入以“\”结尾的目录名称仍会更改正在显示的文件夹，但输入不以“\”结尾的目录名称不会。

使用 spy++ 我可以看到，当按下回车键时，一条 WM_COMMAND 消息将被发送到带有 wParam 参数的公共对话框控件，该参数的高位字为 BN_CLICKED，低位字为 ID_OK。

如果我将通用对话框子类化，我可以截取消息，更改文件名组合框中的文本，将消息转发到原始子类过程，然后再将文本更改回来。

这有点小技巧，但它使我能够从对话框中获得我想要的行为。

# windows - windows什么时候发出进程句柄的信号？

> ID：468403
> 
> 赞同：8
> 
> 时间：2009-01-22T08:19:11.030
> 
> 标签：windows, winapi, synchronization

我实现了一个自我升级过程，其中我的主应用程序 exe 启动一个更新程序 exe，在命令行上将句柄传递给自身。应用程序 exe 然后调用 ExitProcess 退出，更新程序在传入的句柄上调用 WaitForSingleObject 以等待应用程序 exe 终止。

WaitForSingleObject 确实等待。直到应用程序调用 ExitProcess，更新程序才会停止。

但是，有时，当更新程序尝试用新版本覆盖应用程序 dll 时，我会收到一个文件锁定错误，我的更新程序的当前版本将其视为不可恢复的错误并终止。似乎包含任意 sleep(100) 足以绕过这个“问题”，但我真的很讨厌这样的代码。真的很讨厌。

对我来说似乎很奇怪，当主应用程序仍然存活到足以锁定 dll 文件时，可以向进程句柄发出信号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:27:48.017

当应用程序代码退出时，进程会发出信号。操作系统可能需要更多时间才能完全卸载该进程。发出信号的重点是说“我已经完成了我需要做的事情”，它更有效地释放其他可能有真正有用的东西要做的代码，而不是让那些代码等待操作系统做一些家务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T01:24:03.777

正如另一个答案指出的那样，当进程停止执行时，进程句柄会收到信号，并且操作系统可能需要更长的时间来释放 DLL。

你说得对，依赖 Sleep(100) 是个坏主意。您应该将覆盖您的 DLL 包装在这样的循环中：

```
BOOL UpdateDll(LPCTSTR dll_name, WHATEVER whatever) {
  int tries = 150;
  while (tries--) {
    if (TryUpdateDll(dll_name, whatever))
      return TRUE;
    Sleep(200);
  }
  return FALSE;
} 
```

这会一直尝试卸载您的 DLL 30 秒，然后放弃。即使系统负载很重，30 秒也足够了，但仍然可以保护您的更新程序不会永远挂起。（如果 UpdateDll 返回 FALSE，请务必向您的用户提供有意义的错误消息，说明违规 DLL 的名称。）

如果您在搞乱 COM，在退出之前调用 CoFreeUnusedLibraries 也可能会有所帮助。( [http://msdn.microsoft.com/en-us/library/ms679712.aspx](http://msdn.microsoft.com/en-us/library/ms679712.aspx) ) 坦率地说，我不知道即使在您的进程退出后 COM 是否会保留 DLL，但最好是安全的。

底线是 Win32 API 有很多奇怪之处。只要您能找到可接受的解决方案，您就不必处理每个案例。显然 Sleep(100) 可能会中断，但我似乎可以接受 30 秒的轮询循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T07:35:23.243

可能是 DLL 当时被其他进程锁定。对此进行测试的一种方法是在发生这种情况时生成一份报告，说明 DLL 上的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T02:47:05.983

大约六个月前，使用一些防病毒软件看到了这些问题。尝试不使用 AV，至少确保 AV 是最新的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T07:45:10.827

如果您正在使用的任何 DLL 正在使用线程，如果您没有显式卸载它们，它们可能不会足够快地终止（或连接）——如果您使用 LoadLibrary 显式加载它们当然会发生这种情况

看看这里： http: [//msdn.microsoft.com/en-us/library/ms682596 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682596(VS.85).aspx)

特别是这一行：

> ...当进程终止或调用 FreeLibrary 函数并且引用计数变为零时，DLL 被卸载。如果进程因 TerminateProcess 或 TerminateThread 函数而终止，则系统不会调用 DLL 入口点函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T20:04:38.240

一个可能为您解决的问题...虽然您无法替换正在使用的 dll，但您可以重命名它。因此，如果您有需要替换的 dll，但由于某种原因正在使用中，请将其重命名为 .delete 或类似的名称。进行更新，然后让您的主程序搜索任何 .delete 文件并在启动时将其删除。

-大学教师

# vb.net - 如何在 QueryParser 中合并多个字段？

> ID：468405
> 
> 赞同：34
> 
> 时间：2009-01-22T08:20:52.353
> 
> 标签：vb.net, lucene, lucene.net

```
Dim qp1 As New QueryParser("filename", New StandardAnalyzer())
Dim qp2 As New QueryParser("filetext", New StandardAnalyzer())
.
. 
```

我正在使用“Lucene.Net”库并有以下问题。

与其创建两个单独的`QueryParser`对象并使用它们来获得两个 Hits 对象，是否可以使用单个`QueryParser`对象在两个字段上执行搜索，以便我只有一个 Hits 对象可以为我提供每个文档的总分？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2010-01-10T11:54:34.840

有 3 种方法可以做到这一点。

第一种方法是手动构建查询，这是`QueryParser`内部正在做的事情。这是最有效的方法，这意味着如果您想阻止访问以下一些更奇特的功能，则不必解析用户输入`QueryParser`：

```
IndexReader reader = IndexReader.Open("<lucene dir>");
Searcher searcher = new IndexSearcher(reader);

BooleanQuery booleanQuery = new BooleanQuery();
Query query1 = new TermQuery(new Term("filename", "<text>"));
Query query2 = new TermQuery(new Term("filetext", "<text>"));
booleanQuery.add(query1, BooleanClause.Occur.SHOULD);
booleanQuery.add(query2, BooleanClause.Occur.SHOULD);
// Use BooleanClause.Occur.MUST instead of BooleanClause.Occur.SHOULD
// for AND queries
Hits hits = searcher.Search(booleanQuery); 
```

第二种方法是使用`MultiFieldQueryParser`, 这表现得像`QueryParser`，允许访问它拥有的所有权力，除了它将搜索多个字段。

```
IndexReader reader = IndexReader.Open("<lucene dir>");
Searcher searcher = new IndexSearcher(reader);

Analyzer analyzer = new StandardAnalyzer();
MultiFieldQueryParser queryParser = new MultiFieldQueryParser(
                                        new string[] {"filename", "filetext"},
                                        analyzer);

Hits hits = searcher.Search(queryParser.parse("<text>")); 
```

最后一种方法是使用`QueryParser` [see here](http://lucene.apache.org/java/2_3_2/queryparsersyntax.html)的特殊语法。

```
IndexReader reader = IndexReader.Open("<lucene dir>");
Searcher searcher = new IndexSearcher(reader);    

Analyzer analyzer = new StandardAnalyzer();
QueryParser queryParser = new QueryParser("<default field>", analyzer);
// <default field> is the field that QueryParser will search if you don't 
// prefix it with a field.
string special = "filename:" + text + " OR filetext:" + text;

Hits hits = searcher.Search(queryParser.parse(special)); 
```

您的另一种选择是在索引名为文件名和文本的内容时创建新字段，您可以将文件名和文件文本的内容放入其中*，*然后您只需搜索一个字段。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T14:03:09.080

只需为每个术语构建一个查询字符串：

```
"filename:searchText OR filetext:searchText" 
```

在 QueryParser 的构造函数中作为初始字段传递的内容并不重要。只需确保在查询字符串上调用 .Parse() 即可让 Query 对象重新执行。

如果您想使用“和”搜索：

```
"+filename:searchText +filetext:searchText" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T07:51:19.917

** 您也可以使用`MultiFieldQueryParser`它在所有可用字段中进行搜索。**

例如

```
Dim queryParser = New MultiFieldQueryParser(Version.LUCENE_29, 
indexReader__1.GetFieldNames(IndexReader.FieldOption.ALL).ToArray(), analyzer) 
```

这是一个完整的例子。

```
//get index directory
Dim directory As Directory = FSDirectory.Open(New DirectoryInfo(HostingEnvironment.MapPath(VirtualIndexPath)))

//get analyzer
Dim analyzer As Analyzer = New StandardAnalyzer(Version.LUCENE_29)

//get index reader and searcher
Dim indexReader__1 As IndexReader = IndexReader.Open(directory, True)
Dim indexSearch As Searcher = New IndexSearcher(indexReader__1)

//add all possible fileds in multifieldqueryparser using indexreader getFieldNames method
Dim queryParser = New MultiFieldQueryParser(Version.LUCENE_29, indexReader__1.GetFieldNames(IndexReader.FieldOption.ALL).ToArray(), analyzer)
Dim query = queryParser.Parse(Criteria)
Dim resultDocs As TopDocs = Nothing

//perform search
resultDocs = indexSearch.Search(query, indexReader__1.MaxDoc())
Dim hits = resultDocs.scoreDocs 
```

**希望有帮助**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T10:36:01.503

对于每个字段，从上述查询解析器创建一个查询，然后将查询添加到布尔查询，说明它“必须”发生。

或者，查看 MultiFieldQueryParser，这是一种简化的方法。

# c# - C# 创建多个类使用的枚举的最佳方法是什么？

> ID：468413
> 
> 赞同：16
> 
> 时间：2009-01-22T08:26:29.313
> 
> 标签：c#, enums

我有一个由多个类使用的枚举。实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T08:35:03.167

通常我只是把它们扔进命名空间。这是微软在编写 .NET 框架时所做的，所以我也是这样做的，为了您理解的一致性:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T08:29:49.637

1.  将枚举放在您的命名空间中（或为它们创建一个新的命名空间）或
2.  如果这更有意义，请将它们放在某个（静态？）类中。

无论哪种方式，我都会将它们保存在自己的文件中，以便于访问和良好的组织。

我通常不会把他们放在一个班级，除非他们以某种方式“属于”那里。就像您有一个带有汽车类型枚举的 Car 类，以及可以为汽车类型设置限制的 Road 类和 Bridge 类。`Car.CarType`这似乎是一个合乎逻辑的组织......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-22T08:29:40.430

将它放在自己的文件中并声明它：

公共枚举 Foo { a, b, c, d }

当然考虑你的命名空间。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-22T09:35:28.207

XML 注释很有帮助，特别是如果其他人会使用它

```
 /// <summary>
/// Defines the types of cars we support
/// </summary>
public enum CarType
{
    /// <summary>
    /// VW - the peoples car
    /// </summary>
    Volkswagen, 
```

您的枚举名称应该是复数（按照 FxCop 的指示）

```
public enum CarTypes 
```

即使您不打算按位使用，也可以添加数值并使用按位编号（以后重新编号会很痛苦）。

```
 Volkswagen = 1,

    /// <summary>
    /// They own lambo... can't be all that bad
    /// </summary>
    Audi = 2,

    /// <summary>
    /// Good, cheap, reliable
    /// </summary>
    Toyota = 4, 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-22T09:17:19.023

这是一个在不同命名空间中有两个枚举的示例：

```
using TotallyDifferentNameSpace.Enums;

namespace EnumEx
{
    class Program
    {
        static void Main(string[] args)
        {
            CarType car = CarType.Audi;
            PetrolType pType = PetrolType.Diesel;
        }
    }

    public enum CarType
    {
        Volkswagen,
        Audi,
        Toyota,
        Ford,
        Porsche,
        Lada
    }
}

namespace TotallyDifferentNameSpace.Enums
{
    public enum PetrolType
    {
        Gasoline,
        Diesel
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T13:05:22.870

您可以将枚举放置为带有 .cs 扩展名的新代码文件，以便智能感知工作确保它是您的项目/解决方案的一部分，当然它应该是一个公共枚举，以便您拥有它的解决方案范围。如果智能感知是一个问题，请确保您构建一次解决方案，我曾经遇到过这个问题，只是重建解决了它。如果您想正确组织代码并且正在编写大型项目，命名空间是一个不错的选择。.NET 框架很大。所以它在命名空间下有枚举，只是为了更好地理解和代码组织。

* * *

## 回答 #7

> 赞同：-9
> 
> 时间：2009-01-22T09:23:04.927

我的建议是根本不要使用枚举。改用单例。

像

```
 public class A : ISomeInterface
    {
        public static readonly A Instance = new A();
        private A()
        {
        }

    }

    public class B : ISomeInterface
    {
        public static readonly B Instance = new A();
        private B()
        {
        }
    } 
```

在大多数情况下，效果更好，最好在以后扩展。

最良好的祝愿

马策

# python - Ruby 相当于 Python 的“目录”？

> ID：468421
> 
> 赞同：58
> 
> 时间：2009-01-22T08:32:05.620
> 
> 标签：python, ruby, inspection

在 Python 中，我们可以“dir”一个模块，如下所示：

```
>>> import re
>>> dir(re) 
```

它列出了模块中的所有功能。在 Ruby 中是否有类似的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-22T08:39:41.987

据我不完全知道，但你得到某个地方

```
object.methods.sort 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-01T08:20:38.150

我喜欢在我的 .irbrc 中有这个：

```
class Object
  def local_methods
    (methods - Object.instance_methods).sort
  end
end 
```

所以当我在 irb 时：

```
>> Time.now.local_methods 
=> ["+", "-", "<", "<=", "<=>", ">", ">=", "_dump", "asctime", "between?", "ctime", "day", "dst?", "getgm", "getlocal", "getutc", "gmt?", "gmt_offset", "gmtime", "gmtoff", "hour", "isdst", "localtime", "mday", "min", "mon", "month", "sec", "strftime", "succ", "to_f", "to_i", "tv_sec", "tv_usec", "usec", "utc", "utc?", "utc_offset", "wday", "yday", "year", "zone"] 
```

甚至更可爱 - 使用 grep：

```
>> Time.now.local_methods.grep /str/
=> ["strftime"] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T11:33:44.913

在 irb 中“搜索”方法的提示：

```
"something".methods.select {|item| item =~ /query/ } 
```

尝试比较值的方法的提示：

```
value = "something"
[:upcase, :downcase, :capitalize].collect {|method| [method, value.send(method)] } 
```

另外，请注意，您不会通过 object.methods 获得与 Python 目录相同的所有信息。您必须使用 object.methods 和 class.constants 的组合，以及 class.singleton_methods 来获取类方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T08:41:01.267

您可以获取一个模块，例如`Enumerable`，并发送`methods`列出该模块定义的所有方法的方法。包含此模块的类将响应这些方法。

```
>> Enumerable.methods
=> ["inspect", "private_class_method", "const_missing", "clone", "method", "public_methods", "public_instance_methods", "instance_variable_defined?", "method_defined?", "equal?", "freeze", "included_modules", "const_get", "yaml_as", "methods", "respond_to?", "module_eval", "class_variables", "dup", "protected_instance_methods", "instance_variables", "public_method_defined?", "__id__", "object_id", "taguri", "yaml_tag_read_class", "eql?", "const_set", "id", "to_yaml", "taguri=", "singleton_methods", "send", "class_eval", "taint", "frozen?", "instance_variable_get", "include?", "private_instance_methods", "__send__", "instance_of?", "private_method_defined?", "to_a", "name", "to_yaml_style", "autoload", "type", "yaml_tag_class_name", "<", "protected_methods", "instance_eval", "<=>", "==", ">", "display", "===", "instance_method", "instance_variable_set", "to_yaml_properties", "kind_of?", "extend", "protected_method_defined?", "const_defined?", ">=", "ancestors", "to_s", "<=", "public_class_method", "hash", "class", "instance_methods", "tainted?", "=~", "private_methods", "class_variable_defined?", "nil?", "untaint", "constants", "autoload?", "is_a?"] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T10:25:56.780

我会去做这样的事情：

```
y String.methods.sort 
```

这将为您提供已排序方法数组的 yaml 表示形式。请注意，这可用于列出类和对象的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-02T19:32:19.757

也许没有回答原始问题（取决于用例），但对于那些正在寻找`irb`仅用于此的人，您可以使用“双制表符”进行自动完成。实际上，它还可以列出（几乎所有）给定对象可用的方法。

将以下行放入您的`~/.irbrc`文件中：

```
require 'irb/completion' 
```

现在，（重新）启动`irb`，开始输入一个方法并按两次 TAB - irb 自动完成输入！

我实际上是在这里学到的：http: [//drnicwilliams.com/2006/10/12/my-irbrc-for-consoleirb/](http://drnicwilliams.com/2006/10/12/my-irbrc-for-consoleirb/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T16:53:00.120

I would have made this a comment to jonelf's answer, but apparently I don't have enough rep.

some_object.methods.sort - Object.new.methods

This isn't exactly what you were asking as others have said, but it gives you the info you are after.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T12:57:58.750

Not really. Like the others said, you can get part of what you want by listing class instance methods (e.g. `String.instance_methods`) but that doesn't help you if a file you open reopens a class (unless you check before and after).

If you don't need programmatic access to the list of methods, consider checking out the documentation for a class, module or method using the `ri` command line tool.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T21:50:35.137

如果我严格阅读您的问题，我必须这样回答：`require`Ruby 中指定的文件只是一个容器，与类没有任何关系。内容可以是：

*   一类
*   一个模块
*   明码

或以上任意组合，多次。所以你不能直接询问给定文件中的所有方法。

如果您打算列出给定模块或类的所有方法，那么其他答案就是您所寻求的（主要使用`#methods`模块名称或类上的方法）。

# iphone - iPhone 属性字符串

> ID：468422
> 
> 赞同：1
> 
> 时间：2009-01-22T08:32:36.493
> 
> 标签：iphone, cocoa-touch

关于如何在 iPhone 上获取属性字符串功能的任何想法。

具体来说，我正在写出化合物并希望正确显示下标：例如：

H [2] O（2应该是下标）

感谢您的任何建议

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T00:27:08.813

您可能会发现使用为下标设置的 Unicode 字符更方便：

下标二是 U+2082: H₂0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T13:25:20.910

您可以使用 UIWebView 和 HTML，或者使用 NSString + UIKit 添加或 CoreGraphics 自己绘制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-09T12:13:56.873

只是发布这个来帮助其他人试图使科学记数法工作。适用于 3.2 及更高版本（也许更低，试一试；））

```
// Property to show
NSString *formula = cellData.formula;

// Setup font
UIFont *font = [UIFont fontWithName:@"Dax-Bold" size:5];

// Draw property
UIGraphicsPushContext(context);
[formula drawAtPoint:CGPointMake(cellData.rect.origin.x + 2, cellData.rect.origin.y + 15) withFont:font];
UIGraphicsPopContext(); 
```

使用`drawAtPoint:`当前上下文，因此请确保在 drawRect: 方法中使用此方法。

我必须`drawAtPoint:`用两个 UIGraphics 方法包装该方法，以确保我的文本在多线程应用程序中呈现。

确保您的字体支持 Unicode 字符。如果不是，将使用默认字体。您可以使用名为 FontLab 的工具添加缺失的字体字形。

# java - Lobo Cobra HtmlPanel 在 JavaScript 操作后不更新 GUI

> ID：468424
> 
> 赞同：1
> 
> 时间：2009-01-22T08:33:20.423
> 
> 标签：java, javascript, browser, lobo, cobra

你好，

我开始在 Swing 中实现 HTML 浏览器。我想使用[Lobo Cobra](http://lobobrowser.org/) 工具包，因为该工具包包含 CSS 和 JavaScript 的渲染器和解析器。这些页面看起来非常漂亮并且易于使用（一个类实现来显示一个 html 页面）。

我想在 swing 中显示 HTML 页面，它可以显示 javascript 生成和修改的对象，如闪烁的圆圈。据我所知，cobra 工具包可以显示静态 javascript 命令，如“document.write”或 closwWindow() 实现，但不能从 JavaScript 更新 GUI。

是否有人以前使用过 Lobo Cobra Toolkit，并给了我一些示例代码或提示，以显示带有动画 JavaScript 对象的 HTML 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T03:37:12.530

我的印象是，只要您为通知设置好自己，无论是在页面加载时完成还是在页面加载后由 Javascript 动态地完成对 DOM 的所有更改，都会调用您的代码。

我最初会设置一个实现 DocumentNotificationListener 接口的对象 (X)，并为每个调用的方法记录一条消息。然后使用 Y.addDocumentNotificationListener(X) [其中 Y 是您的 HTMLDocumentImpl 对象] 将其设置为侦听器并加载您的页面以查看实际调用了哪些方法。

最坏的情况是您必须在每次方法调用时重新渲染 HTML 页面，但您应该能够优化其中的大部分。例如，更改导致调用 X.lookInvalidated(...) 的节点（DOM 对象）的颜色不需要重新渲染整个页面，因为节点大小不会改变。

# .net - 我怎样才能克服 Compat。VS2005/8 SOLUTION 文件有问题吗？

> ID：468435
> 
> 赞同：3
> 
> 时间：2009-01-22T08:40:19.787
> 
> 标签：.net, visual-studio-2008, visual-studio-2005

我在家里使用 VS2008 并喜欢它，在着手将 2005 升级到 2008 的工作时，我明显担心的原因之一是我们拥有的所有 2005 解决方案。

虽然升级到 2008 对我们来说可能很简单，但我们确实与使用 2005 的其他开发人员合作，并且在不久的将来不会升级到 2008。

**我知道**项目*文件*是交叉兼容的，没有问题，但*解决方案*文件**不是**.

以下是我到目前为止遇到的一些链接：

*   [Visual Studio 2008 解决方案/项目文件转换和技巧](http://petesbloggerama.blogspot.com/2007/11/visual-studio-2008-solution-project.html)
*   [Visual Studio 2008 解决方案文件兼容性](http://www.platinumbay.com/blogs/dotneticated/archive/2007/12/19/visual-studio-2008-solution-file-compatibility.aspx)
*   [在 Orcas 和 Visual Studio 2005 之间移动项目/解决方案](http://www.west-wind.com/Weblog/posts/122975.aspx)

我很好奇，**MS 有没有正面解决这个问题？**他们是否有任何修补程序来解决它？这似乎是一个非常糟糕的交叉兼容尝试，因为解决方案文件之间没有**真正的**变化（即 2008 可以很容易地忽略 2005 的额外内容）..

**PS：**这当然都是假设我们没有使用 3.5 中的任何新框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:43:29.170

最简单的方法是简单地保留 sln 文件的两个副本——一个 2005 集和一个 2008 集。实际上，我经常认为 sln 文件完全是临时文件和开发人员特定的（很少在源代码控制中），但不同的人发现不同的设置很有帮助。MSTest 是这里的罪魁祸首（该死的 testrunco​​nfig 文件......纯粹是疯狂......）。

请注意，使用 2005 和 2008 还会带来 2008 开发人员意外使用 C# 3 功能的风险。其中一些并不明显，例如改进的泛型类型推断 - 例如：

```
int[] data = {1,2,3,4,5};
string[] strings = Array.ConvertAll(data, delegate(int i)
    {return i.ToString();}); 
```

这需要`<int,string>`在 C# 2.0 中，但在 C# 3.0 中不需要。类似的风险是任何生成代码的设计人员/其他工具 - VS2008/C# 3.0 版本可能包含“部分方法”，这在 C# 2.0 中不起作用。

如果可以的话，尝试在相当短的时间内升级每个人，以尽量减少这种风险带来的任何痛苦......

# jquery-ui - IE7 选中状态下的 jQuery 选项卡

> ID：468444
> 
> 赞同：0
> 
> 时间：2009-01-22T08:42:21.293
> 
> 标签：jquery-ui

我正在使用 jQuery 为 Web 应用程序创建大量选项卡。到目前为止，我只使用了[这里提供](http://docs.jquery.com/UI/Tabs)的基本示例，没有任何运气。选项卡内容有效，主题显示正确，但是当我单击选项卡时，选项卡的状态没有改变。此应用程序必须在 IE7 下运行，任何其他浏览器都无所谓（我可以补充一点，我不是 IE7 用户，我是狂热的 Firefox 用户）

```
<div class="ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">
<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
  <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#tabs-1"><span>Nunc tincidunt</span></a></li>
  <li class="ui-state-default ui-corner-top"><a href="#tabs-2"><span>Proin dolor</span></a></li>
</ul>
<div class="ui-tabs-panel ui-widget-content ui-corner-bottom" id="tabs-1">
  <p>Tab one content goes here.</p>
</div>
<div class="ui-tabs-panel ui-widget-content ui-corner-bottom" id="tabs-2">
  <p>Tab1 one content goes here.</p>
</div> 
```

[下面是jQuery 的 ThemeRoller](http://ui.jquery.com/themeroller)提供的 CSS，所以我的包含如下所示：

```
<link href="/intranet/common/stylesheets/jquery-ui/ui.all.css" rel="stylesheet" type="text/css" />
<script src="/intranet/common/javascript/jquery-1.2.6.min.js" type="text/javascript"></script>
<script src="/intranet/common/javascript/jquery-ui.js" type="text/javascript"></script> 
```

然后，我使用以下命令启用选项卡：

```
<script type="text/javascript">
  $(document).ready(function() {
    $("#tabs > ul").tabs();
  });
</script> 
```

正如我所说，选项卡内容有效，一切都是主题，但是一旦我“单击”选项卡，选项卡的状态就不会变为活动状态。ThemeRoller 在 IE7 中工作，但我的页面没有。我不知道我哪里出错了，我已经玩了几个小时至少试图让它工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T08:56:29.037

考虑升级到最新版本的 jQuery (1.3)。我已经用 1.2.6 的旧 css (flora) 测试了你的代码，它可以工作。使用我刚刚下载的 ThemeRoller，它不适用于 Firefox 或 IE。

还可以尝试使用最新版本的 jquery-ui。最安全的选择是直接从 ThemeRoller 下载中尝试 javascript 文件和 css 文件和图像。

# sql - 使用 SQL Server 2000/2005 中的存储过程交换不包括少数列的两条记录

> ID：468448
> 
> 赞同：1
> 
> 时间：2009-01-22T08:47:13.343
> 
> 标签：sql, sql-server

如何创建存储过程（对于 SQL Server 2000 / 2005）来交换 2 条记录，不包括几列，它必须获取“表名”、“记录 id (2 id)”和“要排除的列”作为参数。这里的列是动态的，因为我们将“表”作为参数，并且列数可能超过 50。

这里我相信，“update [table name] set [field] = [value] ......”

类型语句将非常冗长，因为列数将超过 50 并且它是一个变体。

有什么简单的方法可以在 SQL Server 2000/2005 中交换记录吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T11:31:30.630

检查[Tom H.](https://stackoverflow.com/questions/484040/swapping-the-2-rows-in-ms-sql-server-retaining-the-original-primary-key-and-witho#484787)对类似问题的回答。

此外[，发布在 SQLServerCentral 上的此解决方案](http://www.sqlservercentral.com/Forums/Topic560225-169-1.aspx)可能对您有所帮助（该站点需要注册，但它是免费的）

# windows - 如何在 Windows 中获取 COM 端口的 base_baud 频率

> ID：468456
> 
> 赞同：0
> 
> 时间：2009-01-22T08:52:05.910
> 
> 标签：windows, ioctl, baud-rate

是否有一个 Windows 调用来获取波特基频率，就像 linux 中的这个。

```
struct serial_struct ser;
ioctl(com, TIOCGSERIAL, &ser);
base = ser.baud_base; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T09:11:51.267

```
DCB系列；
ser.DCBlength = sizeof (DCB);
if (GetCommState (com, &ser))
  基数 = ser.BaudRate;

```

请参阅MSDN 上[的配置通信资源](http://msdn.microsoft.com/en-us/library/aa363201(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:40:51.763

不，我要的是用于生成波特率的内部时钟。我想计算可以设置哪些非标准波特率。在linux中是：

```
struct serial_struct ser;
ioctl(com, TIOCGSERIAL, &ser);
base = ser.baud_base;
baudrate = ser.baud_base / ser.custom_divisor; 
```

# php - 如何在 PHP 中获取 MySQL 表结构？加上所有表的列表？

> ID：468458
> 
> 赞同：32
> 
> 时间：2009-01-22T08:54:01.410
> 
> 标签：php, mysql

我需要在 PHP 中运行什么查询来获取数据库中给定表的结构？我需要运行什么查询来获取所有表的列表？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-22T08:56:19.067

要获取表的列列表，请使用 DESCRIBE SQL 语句。语法如下：

```
DESCRIBE TableName 
```

要获取数据库中的表列表，请使用以下 SQL 语句：

```
SHOW TABLES 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-08-19T02:47:40.983

```
$q = mysql_query('DESCRIBE tablename');
while($row = mysql_fetch_array($q)) {
    echo "{$row['Field']} - {$row['Type']}\n";
} 
```

[在http://www.electrictoolbox.com/mysql-table-structure-describe/](http://www.electrictoolbox.com/mysql-table-structure-describe/)找到它

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-01-22T09:06:16.707

要获得 CREATE 语法，请使用

```
SHOW CREATE TABLE table_name; 
```

还可以查看 information_schema 数据库。关于您的数据库、表、索引等的许多非常有用的信息。

请参阅：[如何在 MySQL 中查找所有具有特定列名的表？](https://stackoverflow.com/questions/193780/how-to-find-all-the-tables-in-mysql-with-specific-column-names-in-them)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-23T14:35:56.470

要获取您可以使用的字段的评论：

```
SHOW FULL COLUMNS FROM table_name; 
```

注意关键字 FULL，这就是 MySQL 在响应中包含特权和评论信息的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-23T12:39:53.580

用 MYSQLI 更新：

连接数据库

```
function conectadb($banco) 
{
$endereco = "localhost";
$usuario  = "root";
$senha    = "";
try
{
    $con = new mysqli($endereco, $usuario, $senha, $banco);
    $con->set_charset("utf8"); // acentuação
    return $con;
}
catch (Exception $e)
{
    echo "<h1>Falha</h1><br/>";
    echo $e->getMessage();
    die();
}
} 
```

显示列表：

```
function show_table($tabela)
{
$conexao=conectadb('venda');
$sql = "DESCRIBE $tabela";
$result = $conexao->query($sql);
while ($coluna = $result->fetch_assoc()) 
{
    echo "<p>".$coluna['Field']." - ";
    echo $coluna['Type']."</p>";
} 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-30T04:49:20.643

```
 $result= mysqli_query($conn, "DESCRIBE your_table");
 while($table = mysqli_fetch_array($result)) 
{ 
  echo($table[0]." ".$table[1]." ". $table[2]." ". $table[3]." ". $table[4]);  
 } 

```

# .net - 有什么理由使用带有 SQL Server CE 的本地数据库的数据集？

> ID：468460
> 
> 赞同：0
> 
> 时间：2009-01-22T08:54:40.553
> 
> 标签：.net, database, ado.net, dataset, sql-server-ce

即使在使用本地进程内数据库进行应用程序数据持久性的应用程序中使用 .NET 数据集是否有意义？

如果 DataSet 主要用于数据库结果的内存缓存，那么在使用与应用程序在同一进程中运行的 SQL Server Compact 本地数据库之类的东西时，它们听起来并不是那么有用。

使用类型化数据集还有其他原因吗？比如说，他们是否简化了 WPF 数据绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T10:15:37.563

让我试着回答我自己的问题。

在我看来，DataSets 是为以下用例设计的：

1.  数据从远程 DB 加载到内存缓存（DataSet）。
2.  缓存副本以非平凡的方式（多个表、删除、添加、更新）进行操作，而无需与数据库建立活动连接。
    *   需要将数据库关系建模到本地缓存中以启用这些操作。
    *   数据绑定到 UI（例如，WPF）是微不足道的，因为我们正在处理数据的内存副本。
3.  缓存的副本有时会更新到远程数据库以实现真正的持久性。
    *   例如，当客户端返回在线状态或用户按下“应用”以真正提交他的数据时，可能会发生这种情况。

使用本地进程内数据库，无需完全脱机工作——本地数据库连接始终可用。这表明无需将（可能）复杂的数据库关系建模到本地缓存中以启用添加、删除和更新。相反，人们会直接修改数据库中的数据，并且只维护一个自定义的本地缓存来查看数据。本地缓存可以与 DB 层分离，并放入它自己的 ViewModel 层 (MVVM)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T09:07:30.120

我已经从我的应用程序中删除了所有类型化的数据集。创建它们需要很长时间。通过创建，我的意思是新的语句/构造函数。此外，检索数据不如直接使用 DataReaders 高效。

不知道对进程内数据库的许多查询（使用 DataReader）是否会使您的应用程序变慢很多。我认为这仅取决于您的应用程序。

大多数情况下，缓存数据以解析额外的 SQL 语句并检索信息会更快。但话又说回来，它需要的额外内存也是有代价的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T14:15:06.377

您可以使用 SQL server compact 轻松对应该与 SQL server 一起使用的应用程序进行单元测试。如果没有 Sql server compact，您的测试是集成测试而不是单元测试（更难配置并且需要更多时间运行）。

# c# - 如何将文件上传到 sharepoint 中的文档库？

> ID：468469
> 
> 赞同：51
> 
> 时间：2009-01-22T08:57:15.913
> 
> 标签：c#, sharepoint, upload

您如何以编程方式将文件上传到 sharepoint 中的文档库？

我目前正在使用 C# 制作一个 Windows 应用程序，它将文档添加到文档库列表中。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-01-22T11:01:14.667

您可以使用对象模型或[SharePoint Webservices](http://msdn.microsoft.com/en-us/library/lists.lists.aspx)将文档上传到 SharePoint 库。

使用对象模型上传：

```
String fileToUpload = @"C:\YourFile.txt";
String sharePointSite = "http://yoursite.com/sites/Research/";
String documentLibraryName = "Shared Documents";

using (SPSite oSite = new SPSite(sharePointSite))
{
    using (SPWeb oWeb = oSite.OpenWeb())
    {
        if (!System.IO.File.Exists(fileToUpload))
            throw new FileNotFoundException("File not found.", fileToUpload);                    

        SPFolder myLibrary = oWeb.Folders[documentLibraryName];

        // Prepare to upload
        Boolean replaceExistingFiles = true;
        String fileName = System.IO.Path.GetFileName(fileToUpload);
        FileStream fileStream = File.OpenRead(fileToUpload);

        // Upload document
        SPFile spfile = myLibrary.Files.Add(fileName, fileStream, replaceExistingFiles);

        // Commit 
        myLibrary.Update();
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-05T15:34:05.387

如果您在此行中收到此错误“**值不在预期范围内**”：

```
SPFolder myLibrary = oWeb.Folders[documentLibraryName]; 
```

改用它来修复错误：

```
SPFolder myLibrary = oWeb.GetList(URL OR NAME).RootFolder; 
```

始终使用 URl 来获取列表或其他，因为它们是唯一的，名称不是最好的方法；）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-07-13T12:22:45.420

使用 SharePoint 2013 新库，我设法做到了这样的事情：

```
private void UploadToSharePoint(string p, out string newUrl)  //p is path to file to load
{
    string siteUrl = "https://myCompany.sharepoint.com/site/";
    //Insert Credentials
    ClientContext context = new ClientContext(siteUrl);

    SecureString passWord = new SecureString();
    foreach (var c in "mypassword") passWord.AppendChar(c);
    context.Credentials = new SharePointOnlineCredentials("myUserName", passWord);
    Web site = context.Web;

    //Get the required RootFolder
    string barRootFolderRelativeUrl = "Shared Documents/foo/bar";
    Folder barFolder = site.GetFolderByServerRelativeUrl(barRootFolderRelativeUrl);

    //Create new subFolder to load files into
    string newFolderName = baseName + DateTime.Now.ToString("yyyyMMddHHmm");
    barFolder.Folders.Add(newFolderName);
    barFolder.Update();

    //Add file to new Folder
    Folder currentRunFolder = site.GetFolderByServerRelativeUrl(barRootFolderRelativeUrl + "/" + newFolderName);
    FileCreationInformation newFile = new FileCreationInformation { Content = System.IO.File.ReadAllBytes(@p), Url = Path.GetFileName(@p), Overwrite = true };
    currentRunFolder.Files.Add(newFile);
    currentRunFolder.Update();

    context.ExecuteQuery();

    //Return the URL of the new uploaded file
    newUrl = siteUrl + barRootFolderRelativeUrl + "/" + newFolderName + "/" + Path.GetFileName(@p);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-10T15:58:17.157

```
string filePath = @"C:\styles\MyStyles.css"; 
string siteURL = "http://example.org/"; 
string libraryName = "Style Library"; 

using (SPSite oSite = new SPSite(siteURL)) 
{ 
    using (SPWeb oWeb = oSite.OpenWeb()) 
    { 
        if (!System.IO.File.Exists(filePath)) 
            throw new FileNotFoundException("File not found.", filePath);                     

        SPFolder libFolder = oWeb.Folders[libraryName]; 

        // Prepare to upload 
        string fileName = System.IO.Path.GetFileName(filePath); 
        FileStream fileStream = File.OpenRead(filePath); 

        //Check the existing File out if the Library Requires CheckOut
        if (libFolder.RequiresCheckout)
        {
            try {
                SPFile fileOld = libFolder.Files[fileName];
                fileOld.CheckOut();
            } catch {}
        }

        // Upload document 
        SPFile spfile = libFolder.Files.Add(fileName, fileStream, true); 

        // Commit  
        myLibrary.Update(); 

        //Check the File in and Publish a Major Version
        if (libFolder.RequiresCheckout)
        {
                spFile.CheckIn("Upload Comment", SPCheckinType.MajorCheckIn);
                spFile.Publish("Publish Comment");
        }
    } 
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-22T19:25:35.677

作为 Web 服务的替代方法，您可以使用 FrontPage RPC API 中的[put 文档](http://msdn.microsoft.com/en-us/library/ms479623.aspx)调用。这具有使您能够在与文件数据相同的请求中提供元数据（列）的额外好处。明显的缺点是该协议有点晦涩（与记录良好的 Web 服务相比）。

有关说明 Frontpage RPC 使用的参考应用程序，请参阅 CodePlex 上的[SharePad](http://www.codeplex.com/sharepad)项目。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-05-08T08:23:22.323

```
try
{
    //Variablen für die Verarbeitung
    string source_file = @"C:\temp\offer.pdf";
    string web_url = "https://stackoverflow.sharepoint.com";
    string library_name = "Documents";
    string admin_name = "admin@stackoverflow.com";
    string admin_password = "Password";

    //Verbindung mit den Login-Daten herstellen
    var sercured_password = new SecureString();
    foreach (var c in admin_password) sercured_password.AppendChar(c);
    SharePointOnlineCredentials credent = new 
    SharePointOnlineCredentials(admin_name, sercured_password);

    //Context mit Credentials erstellen
    ClientContext context = new ClientContext(web_url);
    context.Credentials = credent;

    //Bibliothek festlegen
    var library = context.Web.Lists.GetByTitle(library_name);

    //Ausgewählte Datei laden
    FileStream fs = System.IO.File.OpenRead(source_file);

    //Dateinamen aus Pfad ermitteln
    string source_filename = Path.GetFileName(source_file);

    //Datei ins SharePoint-Verzeichnis hochladen
    FileCreationInformation fci = new FileCreationInformation();
    fci.Overwrite = true;
    fci.ContentStream = fs;
    fci.Url = source_filename;
    var file_upload = library.RootFolder.Files.Add(fci);

    //Ausführen
    context.Load(file_upload);
    context.ExecuteQuery();

    //Datenübertragen schließen
    fs.Close();
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message, "Fehler");
    throw;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-24T21:07:10.283

我使用这篇文章允许 c# 访问一个共享点站点。

[http://www.thesharepointguide.com/access-office-365-using-a-console-application/](http://www.thesharepointguide.com/access-office-365-using-a-console-application/)

基本上，您创建一个 ClientId 和 ClientSecret 密钥以使用 c# 访问该站点

希望这可以帮到你！

# com - 使浏览器与 COM 端口通信的可能性是什么？

> ID：468473
> 
> 赞同：0
> 
> 时间：2009-01-22T08:58:09.907
> 
> 标签：com, browser

我的项目的要求之一是让网站从称重模块中获取测量值。该模块目前通过 COM 端口与独立应用程序一起使用。
通过浏览器执行这样的事情的可能性是什么？有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T09:01:16.000

一种方法是使用与 COM 端口通信的 ActiveX 控件。但是，这要么假设 Windows 和 IE，要么假设在另一个浏览器中运行 ActiveX 的笨拙方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T09:14:14.897

您可以尝试[使用 Java 小程序与 COM 端口通信](http://www.velocityreviews.com/forums/t130530-applet-with-access-to-port-serials.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T10:04:19.087

制作一个在客户端计算机上运行的小程序，通过 HTTP 和 JSON 公开体重数据。这样你的 webapp 仍然是跨浏览器的，一切都很简单，你可以完全控制。如果您的 webapp 无法连接到 localhost 来获取数据，请让用户为重量服务器输入另一个地址，或者让他们下载并安装重量服务器程序，这样您就可以让多个客户端使用相同的秤。

# java - 什么是一个好的 html 电子邮件模板系统，它也正确地呈现文本/纯文本替代方案？

> ID：468478
> 
> 赞同：4
> 
> 时间：2009-01-22T09:01:32.270
> 
> 标签：java, html, text, templates, email

我们有一个网络应用程序，它会定期向用户发送电子邮件。目前我们在代码中生成html版本和文本版本。但是，这维护起来很麻烦。

是否有一个好的电子邮件模板系统可以从同一个 Java 模板生成电子邮件的 html 和文本版本？

一些要求：

*   任何图片/图标正确嵌入为 mimeparts 并正确链接
*   文本版本需要与 html 版本有点相似——为了看到文本版本和垃圾邮件检测器的用户的利益
*   链接需要在文本版本中显示 URL
*   完全控制（或尽可能多地）布局和样式

如果您的回答很重要，我们正在使用 Struts…<cough>1</cough>。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T09:45:54.443

您可以使用一种实用程序，通过剥离标签和转换特殊的 HTML 字符，将 HTML 转换为 Java 中的文本（Google 为它，例如[这个）。](http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/html/HTMLUtil.html#makeCharacterEntities(java.lang.String))但是，这不会为您提供所需的一切，尤其是格式（如列表）和链接。

另一种选择是使用 XSLT 将您的 XHTML（正确编写...）转换为文本并使用 XSLT 处理器（如[Xalan-J](http://xml.apache.org/xalan-j/)或[Saxon](http://saxon.sourceforge.net/)）来运行它。这是一个相当简单的 XSLT 练习，只要您的要求很简单（例如，您不关心 CSS 问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T10:55:37.470

我还建议使用模板引擎。创建两个模板，一个用于文本部分，一个用于 HTML 部分。使用模板引擎的包含功能，这样您就可以在两个模板中重复使用文字文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T09:11:45.900

我已成功使用[Freemarker](http://freemarker.sourceforge.net)模板为电子邮件准备 txt 和 html 内容。如果您使用 Spring，它可以使事情变得更容易，因为它具有所有必要的管道。即使没有 Spring，JavaMail API 也是用户友好的，所以它应该不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T09:24:14.800

以[Apache Velocity](http://velocity.apache.org/engine/releases/velocity-1.5/)为例。我不知道更强大的模板引擎。

# c++ - 警告 C4099：第一次看到使用“类”的类型名称现在使用“结构”看到（MS VS 2k8）

> ID：468486
> 
> 赞同：18
> 
> 时间：2009-01-22T09:06:58.157
> 
> 标签：c++, compiler-warnings

这个警告有什么可担心的吗？我读过它会导致不稳定的行为？

这是我正在尝试编译的示例，有人可以向我解释为什么作者将对象声明为类，然后将 typedef 定义为结构吗？[如果班级是POD](http://en.wikipedia.org/w/index.php?title=Plain_old_data&redirect=no)这样做是完全正常的吗？

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-22T09:52:56.380

当您有一个与另一个相矛盾的类型声明（一个说“类”，另一个说“结构”）时，会出现此警告。给定一个定义规则，除了至多一个之外的所有声明都必须是前向声明。警告通常表明一个类型的前向声明是错误的，通常是一个简单的错字，应该修复。在这种情况下应该没有副作用，但你真的应该修复它。

但是，如果您有类型名称冲突（可能是由使用“使用命名空间”子句或全局命名空间污染引起的），可能会发生一些非常讨厌的事情。这些警告可能表明您正在混合来自两个不同库的标头并且类型名称有冲突。在这些条件下编译的代码可能会做一些非常意想不到的事情。

我的建议 - 了解警告出现的原因并修复它。如果警告出现在第三方产品中，请坚持让他们修复它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T18:27:31.270

只是为了将 MSalters 对上面[这篇](https://stackoverflow.com/questions/468486/warning-c4099-type-name-first-seen-using-class-now-seen-using-struct-ms-vs#468545)文章的评论带到顶层。由于 VC 在其名称的重整中使用“类”或“结构”关键字，我遇到了几个很难找到的链接器错误。

如果您不认为这是一个问题，您可能会摸不着头脑好几个小时！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-22T20:59:53.797

[我在我的博客文章“ C4099 真的是一个愚蠢的警告吗？”](http://alfps.wordpress.com/2010/06/22/cppx-is-c4099-really-a-sillywarning-disabling-msvc-sillywarnings/)中深入讨论了这个警告。. 我的结论是最好关闭它。:-) 好吧，至少对我来说。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T13:43:53.690

Richard Corden 是正确的 - MS 有这个警告是有原因的。对于 MS 编译器，修饰（损坏）名称包括哪个*类键*（`struct`或`class`) 用于声明类型。如果当错误的类键可见时，某个将某个对象作为参数或返回该对象的函数在某处被引用，您将不会收到编译器错误，但链接器会抱怨，因为修饰名称不同。链接器错误只显示它正在寻找的符号，并且很容易忽略那里的类键不匹配，因此更早、更详细的编译器警告很有价值。当然，这两个版本仍然有可能不会出现在同一个编译单元中，如果您认为唯一的区别是默认成员可见性，您可能会摸不着头脑。

mangling 的区别与 C++ 标准相冲突，C++ 标准说前向声明类似于`struct Foo;`和`class Foo;`是等价的，因此应该使用相同的 mangling。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T09:47:20.913

虽然这被认为是不好的做法，但我认为混合类定义和结构声明应该没有问题，因为它们基本上是相同的数据类型。主要区别在于结构成员默认是公共的，与私有的类成员相反，但内存布局是相同的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T09:48:08.277

在 C++ 中，类和结构的**唯一**区别是类的成员变量、成员函数和基类默认是私有的，而在结构中它们默认是公有的；所以，类是 POD 的事实在这里不应该有任何区别。
我猜这个警告来自代码维护（定义在某处更新但没有在其他地方更新），并修复代码以使警告消失（例如在 typedef 中使用类）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-25T03:17:15.363

我看到可能导致此警告的一件事是尝试从 DLL 中 #import .tlb 文件，同时在项目中使用相同的 DLL 作为引用。我刚刚通过从我的项目中删除 DLL 作为引用来解决这个问题。

# debugging - 解释 MSVC++6 中的调试符号

> ID：468517
> 
> 赞同：0
> 
> 时间：2009-01-22T09:32:15.920
> 
> 标签：debugging, visual-c++, visual-c++-6, symbols

您将如何以像我这样的新手程序员能够理解的方式来解释“符号”？

这些是什么？它们是某种到函数的映射吗？

我想学习更高级的调试技术，这个学期对我来说是一个障碍。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T12:42:36.207

对于新手来说，一个可能比维基百科文章更简单的 MSVC++ 6 答案如下；

符号是正在调试的可执行文件与其源之间的链接，存储在 .PDB（符号信息）文件中。如果我正在调试一个可执行文件，或者我的 EXE 崩溃并且我最终进入调试器，并且我有相关的符号信息，我将能够查看我的 C++ 源代码的情况，假设源可用。如果我没有这些信息，我会看到 x86 汇编/机器代码。

出于这个原因，在测试机器上，向测试人员提供 PDB 和调试器通常是一个好主意，因为在发生崩溃时，您将能够找出它发生的原因。没有 PDB 和调试器，您必须在开发 PC 上重新创建崩溃，这可能很困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T09:43:19.503

试试这个：[调试符号](http://en.wikipedia.org/wiki/Debug_symbol)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T01:48:58.430

只是为了让未来的搜索者可以有更轻松的时间，我找到了一些关于这个主题的好资源..

*   [这里](http://blogs.msdn.com/arvindsh/archive/2006/08/30/731150.aspx)
*   [这里](http://blogs.msdn.com/tess/archive/2005/12/05/why-do-i-get-weird-function-names-on-my-stack-a-discussion-on-symbols.aspx)
*   [在](http://mtaulty.com/communityserver/blogs/mike_taultys_blog/archive/2004/08/03/4656.aspx)这里..

# .net - ASP.NET MVC 的路由文件太聪明了，我看不出怎么做！

> ID：468523
> 
> 赞同：1
> 
> 时间：2009-01-22T09:36:37.240
> 
> 标签：.net, asp.net-mvc

我在 ASP.NET MVC 应用程序中有两个路由规则：

```
 routes.MapRoute(
               "Products AJAX",
               "Products/Ajax/{action}",
               new { controller = "Products" }
            );

            routes.MapRoute(
               "Product",                                             
               "Products/{id}",                                        
               new { controller = "Products", action = "ViewProduct", id = "1001" }  
            ); 
```

这里的第二条规则允许我创建一个 url`/Products/1002`来查看产品 1002。这是我创建的原始唯一规则。

我想在视图上添加一些 AJAX 以允许它检索一个简单的字符串：

```
 public class ProductsController : Controller {
    public ContentResult GetStatus()
        {
            return new ContentResult()
            {
                Content = "Status is OK at " + DateTime.Now.ToLongTimeString()
            };
        }
  } 
```

这就是我在上面添加第一个路由规则的原因。我希望它是一个更具体的 URL，可用于转到我的控制器中定义的任何其他操作。（如果我没有此规则，它会尝试查找 SKU 为“GetStatus”的产品，这不好！）

所以我认为没关系，我只需要在我的视图中编写我的 AJAX 命令：

```
<%= Ajax.ActionLink("Update Status", "AJAX/GetStatus", new AjaxOptions { UpdateTargetId = "status" })%> 
```

我假设这将调用链接`Products/AJAX/GetStatus`，这将触发第一个路由规则并正确转到我的控制器的 GetStatus 方法。

令我惊讶的是，当我在 Internet Explorer（或查看源代码）中将鼠标悬停在此命令上时，URL 变为`/Products/AJAX/AJAX/GetStatus`.

所以我在想whaaat，我回溯到做一些侦探工作。

我将我的第一条规则更改为：

```
MapRoute(
               "Products AJAX",
               "Products/Foo/{action}",
               new { controller = "Products" }
            ); 
```

我改变我的行动

```
<%= Ajax.ActionLink("Update Status", "GetStatus", new AjaxOptions { UpdateTargetId = "status" })%> 
```

令我惊讶的是，为这个 ActionLink 生成的 URL 实际上是 /Products/Foo/GetStatus。这基于我的第一条规则正确转发到我的 AJAX 处理程序，并且一切正常。当然，/Products/1003 的链接将匹配第二条规则并转到产品 1003。

我的申请完成了！我很高兴 - 有点。

但我不知道为什么！在我的整个代码库中，我拥有的唯一位置`Foo`是在我的映射规则中，那么 Ajax.ActionLink 到底如何能够确定我想要那个链接？

显然，正在完成某种“聪明”的反向映射。我似乎找不到任何有关此的文档，并想了解更多信息。

我认为它必须解析它找到的第一个规则或类似的东西，但这似乎有点可怕，因为我想知道发生了什么。

注意：有一篇关于路由的[非常好的文章](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)——包括从 ScottGu 的博客上的路由表生成 URL。不幸的是，我似乎无法在该博客中找到对我的情况的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T14:09:43.507

既然你有一个命名路线，为什么不使用它呢？改为使用 Ajax.RouteLink，并指定路由名称。这样您就不必担心 ASP.NET “猜测”错误的路线。这也不会伤害任何[东西](http://weblogs.asp.net/leftslipper/archive/2008/12/17/optimizing-your-route-collection-for-url-generation-in-asp-net-mvc-and-more.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:16:42.497

是的，这就是 ActionLink 帮助器和路由的重点——如果您更改整个路由结构，您只需在一个地方更新它，ActionLink 会继续生成正确的 URL。

更详细地说，当您使用 ActionLink 帮助程序时，您实际上是在对系统说“链接到控制器和操作，我不在乎它是*如何*完成的”

# eclipse-plugin - TableViewer - 如何显示（）和项目*和*选择它？

> ID：468529
> 
> 赞同：2
> 
> 时间：2009-01-22T09:38:50.277
> 
> 标签：eclipse-plugin, eclipse-rcp, eclipse-pde

到目前为止，我已经构建了一个编辑器和一个查看器，它们都在同一种数据库资源上工作。

我正在尝试实现 JDT 中看到的那种行为：选择文件编辑器会在 Package Explorer 中选择相同的文件。

我已经停止与 TableView 的交互。谁能告诉我如何 1) 遍历查看器中显示的域项目集合 2) 然后更改选择，如果我找到我需要的项目。

换句话说，revealAndSelect(Object) 方法。

您的经验将不胜感激。

M。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T09:49:16.230

啊。傻我：解决方案当然是

```
viewer.setSelection( new StructuredSelection( domainObjectToSelect ), true ); 
```

# css - 在 CSS 中设计图片库

> ID：468534
> 
> 赞同：0
> 
> 时间：2009-01-22T09:42:09.723
> 
> 标签：css

我是新来的。我想在我的网页中设计一个图片库。目前我正在为我的网站使用 bluprint CSS 框架。谁能给我一个更好的设计图片库的方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T09:53:22.570

[你可以从dynamicdrive](http://www.dynamicdrive.com/style/csslibrary/item/css-image-gallery/)看这个

[悬停](http://sonspring.com/journal/hoverbox-image-gallery)框。

[一个非常不错的 jQuery 插件](http://fancy.klade.lv/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T09:48:00.397

蓝图 CSS 会很好。不过，您需要亲自动手，Blueprint 不会完成设计画廊的所有工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T09:56:55.623

也许您已经查看了[照片库软件的维基百科比较，](http://en.wikipedia.org/wiki/Comparison_of_photo_gallery_software)以获得类似软件包的不错列表。我个人对[4images](http://www.4homepages.de)有很好的体验。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-29T18:59:35.427

简单的。使用[Lightbox](http://leandrovieira.com/projects/jquery/lightbox/)作为 JQuery 插件！

# sql - 由于本机客户端错误，无法安装 SQL Server 2005 Enterprise x64 的客户端组件

> ID：468538
> 
> 赞同：1
> 
> 时间：2009-01-22T09:43:46.523
> 
> 标签：sql, sql-server-2005, 64-bit, windows-server-2003

所以我得到了一个运行 x64 Windows Server 2003 Standard Edition 的 64 位虚拟机，带有来自 blacknight.ie 的 plesk。除了组策略、终端服务和 Windows 搜索，我从 windowsupdate.microsoft.com 安装了所有更新。然后我尝试安装 SQL 2005 x64 Enterprise。我告诉它安装所有内容，包括所有客户端组件、报告、分析、集成等。它似乎设置一切正常，直到它到达客户端组件并出现以下错误（单击链接）； [http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.06&EvtSrc=setup.rll&EvtID=50000&EvtType=packageengine%5cinstallpackageaction.cpp%40InstallToolsAction.11%40sqls%3a%3aInstallPackageAction%3a %3执行%400x643](http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.06&EvtSrc=setup.rll&EvtID=50000&EvtType=packageengine%5cinstallpackageaction.cpp%40InstallToolsAction.11%40sqls%3a%3aInstallPackageAction%3a%3aperform%400x643)

现在我必须上传 sql 安装，所以我尝试对我放置的 zip 文件进行 md5ing，这很好。我尝试卸载本机客户端并重新安装它，我得到了同样的错误。

**我能想到的可能原因** 现在我看到有一些网络错误或什么，我在想可能是权限错误，我告诉它以本地系统运行sql server，也许我不应该有？

它运行在 3/4 的 gig ram 上，对 sql server 的要求是 1gig ram，我很快就会升级 vps，但我很确定这不是问题的原因。

某种32位不兼容？

托管公司有一些本机客户端的东西不会消失 也许是因为 plesk？

如果您需要任何其他信息来帮助解决，请询问，我将全天查看此线程。

编辑：仍然没有解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T11:50:23.597

好的，经过太多努力，我终于找到了解决方案。

原来我需要做以下事情。

清除以前的安装，包括程序文件

从此网址下载并安装本机客户端：http: [//download.microsoft.com/download/2/7/c/27c60d49-6dbe-423e-9a9e-1c873f269484/sqlncli_x64.msi](http://download.microsoft.com/download/2/7/c/27c60d49-6dbe-423e-9a9e-1c873f269484/sqlncli_x64.msi)

创建两个文件夹 SERVERS 和 TOOLS。然后将光盘 1 放入 SERVERS，将光盘 2 放入 TOOLS。我使用该配置重新运行设置，一切正常。

我不知道为什么会这样，它只是这样做，出于某种原因，mssql 安装使用了工具目录，并且当它不存在时不会抱怨。

# c# - C# 枚举和布尔值——寻找更优雅的方式

> ID：468541
> 
> 赞同：3
> 
> 时间：2009-01-22T09:44:15.350
> 
> 标签：c#, enums

我有一个具有枚举属性和布尔属性的类，基于它调用具有特定参数的特定方法。在开关的每种情况下，我对枚举使用 switch 语句，对布尔值使用 if。这是一个很长的列表，我觉得这不是最优雅的解决方案。有人有更优雅或更简单的方法来实现这个吗？

```
 switch (ReadDecision)
            {
                case ReadDecisions.ReadNext:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.Receive(Timeout);
                        }
                        else
                        {
                            Message = queue.Receive();
                        }
                        break;
                    }
                case ReadDecisions.PeekNext:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.Peek(Timeout);
                        }
                        else
                        {
                            Message = queue.Peek();
                        }
                        break;
                    }
                case ReadDecisions.ReadMessageId:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.ReceiveById(Id, Timeout);
                        }
                        else
                        {
                            Message = queue.ReceiveById(Id);
                        }
                        break;
                    }
                case ReadDecisions.PeekMessageId:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.PeekById(Id, Timeout);
                        }
                        else
                        {
                            Message = queue.PeekById(Id);
                        }
                        break;
                    }
                case ReadDecisions.ReadCorrelationId:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.ReceiveByCorrelationId(Id, Timeout);
                        }
                        else
                        {
                            Message = queue.ReceiveByCorrelationId(Id);
                        }
                        break;
                    }
                case ReadDecisions.PeekCorrelationId:
                    {
                        if (UseTimeout)
                        {
                            Message = queue.PeekByCorrelationId(Id, Timeout);
                        }
                        else
                        {
                            Message = queue.PeekByCorrelationId(Id);
                        }
                        break;
                    }
                default:
                    {
                        throw new Exception("Unknown ReadDecisions provided");
                    }
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T09:52:11.997

根据什么，您可以将and`queue`的签名更改为吗？（其余方法也应遵循。）`Peek()``Peek(bool)``Peek(bool?)`

这样，而不是：

```
if (UseTimeout)
{
    Message = queue.Peek(Timeout);
}
else
{
    Message = queue.Peek();
} 
```

你可以有：

```
Message = queue.Peek(UseTimeout ? Timeout : null); 
```

另一个想法是您可以将决策结构推送到队列类：

```
if(UseTimeout)
    Message = queue.PerformAction(ReadDecision, Timeout)
else
    Message = queue.PerformAction(ReadDecision) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T09:49:02.237

用类替换枚举：
[http ://www.refactoring.com/catalog/replaceTypeCodeWithClass.html](http://www.refactoring.com/catalog/replaceTypeCodeWithClass.html)

您可能还想看看策略模式： http:
[//www.dofactory.com/Patterns/PatternStrategy.aspx](http://www.dofactory.com/Patterns/PatternStrategy.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T09:56:36.277

我在这里看到的模式是很多名为 foo(ID) 和 foo(ID, timeout) 的方法对。在你的情况下，我会：

*   创建第三种方法`foo(ID, timeout, bool useTimeout)`，通过合并 和 的 `foo(ID)`主体`foo(ID, timeout)`。
*   改变`foo(ID)`呼叫`foo(ID, null, false)`和`foo(ID, timeout)`呼叫`foo(ID, timeout, true)`
*   将您的 switch 语句更改为始终调用`foo(ID, Timeout, UseTimeout)`.
*   对每对适用的方法重复上述操作。

通过这样做，您将控制超时使用的标志移到更接近实际需要使用的位置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T10:02:27.873

一个常用的约定是超时为零意味着没有超时。也许您可以删除 UseTimeout （属性？）并改用零值。那会消除一些东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T11:42:27.297

我喜欢 Scott 的建议，即零超时意味着没有超时。这将导致以下代码更具可读性，但不涉及创建任何额外的类。OTOH，如果您在代码中的其他任何地方都有相同的 switch 语句，我会选择 enum->classes 重构。

```
switch (ReadDecision)
 {
  case ReadDecisions.ReadNext:
   {
    Message = queue.Receive(Timeout);
    break;
   }
  case ReadDecisions.PeekNext:
   {
    Message = queue.Peek(Timeout);
    break;
   }
  case ReadDecisions.ReadMessageId:
   {
    Message = queue.ReceiveById(Id, Timeout);
    break;
   }
  case ReadDecisions.PeekMessageId:
   {
    Message = queue.PeekById(Id, Timeout);
    break;
   }
  case ReadDecisions.ReadCorrelationId:
   {
    Message = queue.ReceiveByCorrelationId(Id, Timeout);
    break;
   }
  case ReadDecisions.PeekCorrelationId:
   {
    Message = queue.PeekByCorrelationId(Id, Timeout);
    break;
   }
  default:
   {
    throw new Exception("Unknown ReadDecisions provided");
   }
  } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T10:03:14.097

我将使用包含枚举作为键和您执行的操作作为值的字典：

```
Dictionary<ReadDecisions,YourAction> decisions = new
           Dictionary<ReadDecisions,YourAction>();

decisions[ReadDecisions.ReadNext] = queue.Receive;
decisions[ReadDecisions.PeekNext] = queue.PeekById;
// you understand the main idea
//.... 
```

然后将您的开关替换为：

```
if(UseTimeout)
   decisions[ReadDecision](id, Timeout);
else
   decisions[ReadDecision](id, 0);  //or another value 
                                    //telling you there is no timeout .
                                    // it just have to be the same signature 
```

唯一的问题是您必须拥有具有相同签名的所有方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T10:07:06.817

您可以使用代表的哈希表，其中键是 ReadDecision 和 UseTimeout 的组合吗？
我有一种感觉，我在这里要求投反对票……

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T11:07:31.283

为什么不简化传递的参数

```
int? optionalTimeout = UseTimeout ? Timeout : null;

switch (ReadDecision) {
    case ReadDecisions.ReadNext:
        Message = queue.Receive( optionalTimeout ); break;

    case ReadDecisions.PeekNext:
        Message = queue.Peek( optionalTimeout ); break;

    // and so on ... 
```

然后在您的队列方法中处理`Timeout`为“不要超时”传递的空值

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T12:01:10.880

我可以提出以下建议：

**1] 'pair' 方法可以组合在一起**

每个个体都应该能够处理 NULL 值。因此，您将拥有以下两组：

```
Queue.Peek(TimeOut)
Queue.Receive(TimeOut)

Queue.ReceiveById(Id, TimeOut)
Queue.PeekById(Id, TimeOut)
... 
```

**2] 为方法组声明两个委托**

```
delegate Message MethodType1(Timeout)
delegate Message MethodType2(Id, TimeOut) 
```

**3] 有一个 GetDelegate() 方法，该方法将返回适当的方法来执行**

```
object GetDelegate(ReadDecisions param)
{
 switch(param)
 {

   case ReadNext:
             MethodType1 receiveDlgt = new MethodType1(queue.Receive);
   case PeekMessageId:
             MethodType2 peekDlgt = new MethodType2(queue.Peek);
   ...
 }
} 
```

**4]根据委托类型进行适当的调用**

```
InvokingMethod()
{
  object methodToExecute = GetDelegate(ReadDecision)
  if (methodToExecute.GetType() == typeof(MethodType1)) 
    {
    methodToExecute(TimeOut)
    }
    else
    {
    methodToExecute(Id, TimeOut)
    }

} 
```

希望这可以帮助。根据良好的编程实践，某些部分可能需要改进。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T22:31:18.817

您可能不想像现在那样阅读 q 。也许重构事物以使用回调？MessageQueue queue = new MessageQueue(queuePath); // 事件处理程序 queue.ReceiveCompleted += QueueMessageReceived; // 被调用的方法的名称 // 开始“监听”消息 queue.BeginReceive();

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-22T09:56:58.023

你所拥有的对我来说看起来不错。阅读是可以理解的，我有信心维护它。没有必要对它进行幻想。

例如，使用其他人建议的关于使用类而不是枚举的花哨模式可能会为每个 case 语句生成一个新类，并且它们可能会分别进入一个文件，并且您需要另一个文件基本界面......这将是很多东西。我不知道任何人怎么能证明这种大量的东西是一种更简单的方式来表达你已经做得很好的东西。

# asp.net - 如何将 Acrobat XML 表单转换为“真实”PDF

> ID：468546
> 
> 赞同：2
> 
> 时间：2009-01-22T09:47:35.157
> 
> 标签：asp.net, pdf-generation

我目前正在使用[DynamicPDF Merger for .NET](http://www.cete.com/Products/DynamicPDF_Merger.csp)填写 Adob​​e Designer 生成的 XML 表单中的字段（PDF 版本 1.6 Acrobat 7）

XML 表单 PDF 很大 (1.5 MB)，因为每个单词都是一个单独的对象。如果可能，我们不想从头开始重建 PDF。

如果我使用“打印到 PDF”，那么文件会变成“真正的”PDF（不是表格），然后非常小（72 KB）。

有什么方法可以在 ASP.NET Web 服务器上重现此“打印到 PDF”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-31T19:54:32.943

我找到了！！！

好的 - 这就是你要做的。

在 XML PDF 中单击 Print 找到名为 Adob​​e PDF 的打印机 选择类似桌面的位置 当它“打印”时，它将创建一个“真正的”Adobe PDF。然后，您可以将所需的任何页面粘贴到 Adode PDF 中

完美地为我工作！

# cocoa-touch - 播放完成后留在 MPMoviePlayerController

> ID：468555
> 
> 赞同：0
> 
> 时间：2009-01-22T09:51:03.667
> 
> 标签：cocoa-touch, media-player

我正在使用 tableview，当用户选择一行时，我正在使用 MPMoviePlayerController 对象播放与该行关联的视频。现在，一旦播放完成，MPMoviePlayerController 就会被释放，控制权会返回到前一个控制器。

我怎样才能防止这种情况发生？我只想在用户按下“完成”按钮后将用户带回上一个控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-19T13:13:39.833

我认为我已经做了类似的事情。我想做的是让电影停在最后一帧，并在静止图像的顶部放置一些半透明按钮。我这样做的方法是将最后一帧存储为单独的图像，我将其加载到电影播放器​​下方的视图中。您设置`movie.backgroundColor = [UIColor clearColor]`为使电影淡化为 alpha，从而在其下方显示相同的图像，并且看起来根本没有淡化！

整洁的事情是我添加的按钮**确实**出现了褪色，因为它们逐渐被电影播放器​​ alpha fade 显示出来。

# c# - 将所有文件记录在一个大目录中

> ID：468556
> 
> 赞同：1
> 
> 时间：2009-01-22T09:51:13.713
> 
> 标签：c#, .net, multithreading, directoryinfo

我有许多目录，其中包含大量文件（〜10,000）。我想在我的应用程序中创建这些文件的列表，并且已经线程化了 io 访问，以便应用程序在加载时不会冻结。但是，如果我在加载所有文件之前退出应用程序，则线程不会响应 .Join() 直到对 dirInfo.GetFiles(...) 的调用完成：

```
// ... mythread
    DirectoryInfo dirInfo = new DirectoryInfo(path);
    foreach(FileINfo file in dirInfo.GetFiles(extension)) 
    {
        // with large directories, the GetFiles call above 
        //    can stall for a long time
        ... 
```

从 foreach 中缓存文件只是解决了问题。我需要某种线程化的回调方式来查找目录中的文件，但我不知道该怎么做。任何帮助，将不胜感激。

非常感谢，tenpn。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T10:09:09.140

您应该使用 ThreadPool 类中的 Thread。这将使它成为一个后台线程，并且在应用程序关闭时它应该收到一个 ThreadInteruptException。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T10:59:08.523

当您的应用程序即将关闭时（在*Join*之前），您可以调用[Thread.Abort(](http://msdn.microsoft.com/en-us/library/ty8d3wta.aspx) ) 。

 *```
myThread.Abort();
// Wait for myThread to end.
myThread.Join(); 
```

此外，如果需要，您可能希望`ThreadAbortException`在线程方法中捕获并进行一些终结/清理。

```
try {
    DirectoryInfo dirInfo = new DirectoryInfo(path);
    foreach(FileINfo file in dirInfo.GetFiles(extension)) 
    {
        // with large directories, the GetFiles call above 
        //    can stall for a long time
        ...
    }
}
catch (ThreadAbortException e)
{
    // cleaning
} 
```

# .net - 有没有办法在 Visual Studio 2005 中按字母顺序自动对 using 指令进行排序？

> ID：468560
> 
> 赞同：0
> 
> 时间：2009-01-22T09:53:26.800
> 
> 标签：.net, visual-studio, ide, visual-studio-2005

Visual Studio 2008 中提供了此[选项。](http://msdn.microsoft.com/en-us/library/bb514113.aspx)

Visual Studio 2005 中是否有类似的选项？或者其他可以完成这样一项任务的东西？一个加载项，也许？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T13:08:39.883

如果您有 Visual Assist，则有一个“排序选定行”命令，可以满足您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T10:04:19.303

Resharper 可以删除未使用的“使用”语句。我不是 100% 确定它也可以对它们进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T10:12:18.070

如果您使用未排序的语句清理文件`using`一次（而不是必须持续处理它们，可能是因为一个马虎/不合作的同事？），并且您愿意使用其他工具来完成这项工作，还有另一种选择。

我喜欢使用 VS 2005 的智能感知，但有时会发现编辑器与 Emacs 相比功能不足。我有 Epsilon（一个 Emacs 克隆），它具有 command `sort-region`，它采用当前选择中的行并按字母顺序对它们进行排序。我什至可以在 Epsilon 中输入一个键盘宏：

*   在文件中查找第一个 using 语句并从那里开始选择。
*   查找文件中的最后一个 using 语句。
*   对第一个和最后一个 using 语句之间的行进行排序。
*   保存文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T10:13:46.977

Resharper 有一个排序功能。但看起来所有系统使用都放在最上面，然后按字母顺序排列。

还要检查[this question](https://stackoverflow.com/questions/356010/have-resharper-keep-using-system-when-optimizing-usings) on optimization usings with Resharper。

# java - 如何测量通过 RMI 发送的对象的大小？

> ID：468562
> 
> 赞同：2
> 
> 时间：2009-01-22T09:54:03.287
> 
> 标签：java, performance, rmi

我正在对我的应用程序进行一些性能调整，并且想知道一种测量通过 RMI 发送的对象大小的好方法。

目的是使我的对象更精简。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T10:22:15.023

因为您的对象已经是可序列化的 - 您可以使用 ObjectOutputStream 上的 size() 方法来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T15:01:59.280

最简单的方法是放入一些将对象写入文件的测试代码。然后，查看文件的大小。

或者，如果您不想写入磁盘（并且您的对象不会耗尽内存）：

```
ByteArrayOutputStream bout = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(bout);
oos.writeObject(theObjectIWantTheSizeOf);
oos.close();
System.out.println("The object size is: " + bout.toByteArray().length: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T20:23:26.760

> 这还不够——可以发送类及其实例的序列化形式。

该类应该只发送一次，它将是它在磁盘上的大小。您是只发送对象一次还是多次？如果是后者，班级的规模应该不重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-07T16:59:06.360

您需要首先检查您使用的 RMI 协议。如果您使用的是**EJB 3**，它可能会调用 CORBA (RMI-IIOP)。如果您想提高性能，可以使用 RMI over-Zipped IOP ( **ZIOP** ) — GIOP 的压缩版本，可减少带宽使用。试试[http://docs.jboss.org/jbossremoting/2.5.2.SP2/html_single/](http://docs.jboss.org/jbossremoting/2.5.2.SP2/html_single/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-22T13:23:12.133

几个月前，我在[Javaspecialist网站上发现了这篇文章](http://www.javaspecialists.eu/)[Instrumentation Memory Counter](http://www.javaspecialists.eu/archive/Issue142.html)，关于计算 Java 对象的内存使用情况。也许它对你有帮助。

# project-management - Scrum 可以在现实世界中工作吗

> ID：468563
> 
> 赞同：6
> 
> 时间：2009-01-22T09:55:40.383
> 
> 标签：project-management, agile, scrum

我所在的团队已经在很大程度上接受了 Scrum。我真的很喜欢它的想法，但发现我们必须不断做出妥协以适应我们的发展现实。这会降低 Scrum 的效率并导致其他开销。

我要问的是，有没有人设法使用纯 scrum 工作，这样做是否值得。还是不可避免地不得不做出妥协。

我问这个问题是因为 scrum 似乎对偏差有点不容忍，如果它接受世界不能总是改变以适应 scrum 并在它不起作用的地方解决问题，它可能会成为一种更好的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T10:09:01.103

Scrum 绝对可以容忍偏差，但我认为这里的关键点是你的陈述“我们不断地做出妥协以适应......”。当然，如果你改变你的方法，你就会改变你做事的方式。就像说“我们现在是一家 LISP 商店。但是我们真的必须用 LISP 编写代码还是仍然可以使用 C#？”

拥抱 scrum 并接受你做事的方式会改变。你一定会得到好处。不幸的是，scrum 需要被所有利益相关者接受，而不仅仅是开发团队，才能真正高效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T10:54:09.873

仔细看看你所做的妥协，如果它们没有让你远离 Scrum / 敏捷的核心价值观。

很长一段时间以来，我店里的人们一直声称我们是敏捷的，但他们真正的意思是，几乎可以随时将需求更改推向开发。我们有各种程序和指示要遵循，这绝不是“轻装旅行”。*如果每个人都清楚我们并没有真正*在做 Scrum、XP 或其他真正的敏捷方法，
那这不一定是一个大问题。

*只有在没有调整其他核心内容的情况下引入某些东西时，它才会变得危险——你最终会试图在一个只会惩罚你的系统中保持敏捷。您尝试修复 4 周的迭代，但无论如何您每周都会收到新的最优先需求，并且您不能忽略它们。你被要求进行详细的计划，并在冲刺期间只要有一些事情稍微偏离计划就会收到投诉。您最好的团队成员经常被打断，以帮助其他团队解决问题。*

 *这不是敏捷，无论你多么努力地称它为敏捷，它都不会起作用。

所以也许你的实际情况是一样的，你的组织也还没有真正准备好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T10:21:54.167

我们的团队现在使用 scrum 已经好几年了，虽然一开始就出现了问题，需要进行大量宣传，直到管理层接受它并改变了与团队合作的方式，它利用了我们的生产力并增强了我们的知识转移跨越团队成员。

据我了解，Scrum 非常容易出现偏差，依赖于通过回顾（针对开发人员）和短迭代（来自项目规划方/管理）的持续反馈和适应。当然，所有相关方（开发人员、Scrum 主管、产品所有者/管理人员/客户）都必须接受 Scrum 的工作方式与大多数其他非敏捷开发方法不同，并且他们必须修改他们当前的一些方法。

我个人认为，与我过去经历的其他“静态”开发/项目方法相比，Scrum 给了我更大的自由和效率。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T10:17:43.083

可以，但并不适合所有人。事实上，它不适用于大多数地方，因为那里有大量商店无法满足它的先决条件。此外，几乎每个人都使用自己的 Scrum 版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T10:19:40.210

我们最近开始使用 Scrum，我们也在调整它以适应我们的需求。不过，我认为所有方法都是如此。

有些事情，比如每天的 Scrum 会议，我们觉得有点过于频繁：我们现在每周举行两次 Scrum 会议。

我们的 sprint 并不像他们应该的那样死板：我们经常在 sprint 结束前的中途添加一两个功能。

最后，可能也是最重要的一点，我们的 Scrum Master 和产品负责人是同一个人。

总的来说，事情进展顺利。我最喜欢的是燃尽图。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T16:54:05.057

如果你能阐明你正在谈论的一两个“妥协”，你可能会得到更好的答案。我不确定您是在谈论程序问题、任务积压管理、召开站立会议多长时间，还是如何处理版本控制。

我在大型企业环境中使用“纯 scrum”的经验非常好。我想不出任何因使用 Scrum 模型而受到负面影响的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T19:00:50.137

是的，有什么妥协？也许你并不总是成对编程？

所有开发人员都需要让每个人都意识到中断的影响。如果有人用 2 秒时间触摸湿油漆，它会从画家身上带走多少时间？如果你只是画了这个地方，那就没什么了，但是如果所有的用品都被收起来了怎么办？

让您的经理、用户、客户团队负责人知道您可以处理他们的新紧急情况，但他们想放弃/延迟什么？没有人免费乘车。

# .net - 为什么我不能在 Asp.net MVC Beta 中使用 NVelocity？

> ID：468567
> 
> 赞同：0
> 
> 时间：2009-01-22T09:56:52.673
> 
> 标签：.net, asp.net-mvc, nvelocity

我已经添加了所需的程序集并在 global.asax.cs 页面中注册了 NVelocityViewFactory 但是当我运行该站点时出现以下错误

```
Could not load file or assembly 'Microsoft.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified. 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T10:51:32.267

`Microsoft.Web.Mvc`已移至 ASP.NET 期货。它在 CodePlex 上。

# cocoa-touch - iPhone 开发 - 没有堆栈跟踪的 EXC_BAD_ACCESS 错误

> ID：468575
> 
> 赞同：6
> 
> 时间：2009-01-22T09:58:57.007
> 
> 标签：cocoa-touch

这是我的情况：我有一个显示联系人的表格视图。导航栏中的添加按钮用于加载另一个视图以进行数据输入。这个新视图在表格标题中有图像，每个表格单元格都有一个*UITextField*或一个*UITextView*。当我按下取消时，视图会弹出并释放内存。

这是我的问题：当我打开“添加”界面时，在任何 UITextField 或 UITextView 中提供一个值，然后按“取消”返回父视图，我收到*EXC_BAD_ACCESS*错误。当我跟踪它时，“添加控制器”会正确调用 dealloc，但是当我按 Continue 时*[super dealloc]*之后，它会引发此错误。只是这个，没有痕迹，虽然我正在使用*NSZombieEnabled。*当我使用 Instruments 运行代码时，我没有收到任何错误:(

我希望我能清楚地解释这个问题。任何指针？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T11:49:56.003

此错误的最常见原因是当您释放对象并且某些其他机制稍后尝试访问/释放/释放它时。

每当我收到`EXC_BAD_ACCESS`错误报告时，我的第一个建议是单步执行代码以确定导致错误的行，然后搜索`[object release]`引用该对象的任何显式调用。将它们一一注释掉，以找出您可能出错的地方（当然，还要确保稍后正确释放对象）。

如果该行无法帮助您确定是哪个对象导致了问题，请开始查看您的`[object release]`调用，并确保您不会意外释放对象太多次，或者释放您没有释放的对象自己的。

这导致了关于`release`Objective-C 的一个很好的通用指南：

> 如果你拥有一个对象（分配或保留它），你释放它。如果你不拥有它（通过便利方法或其他人分配它），你不会释放它。

（通过[Objective C / Cocoa / iPhone 的内存管理](http://memo.tv/memory_management_with_objective_c_cocoa_iphone)，其中也有一些很好的技巧。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-29T23:48:51.660

尽管这通常是内存管理不善的结果，但也可能由于其他原因而发生（并且比简单地打开更难调试`NSZombieEnabled`）。例如，如果您未能为格式字符串提供正确数量的参数（即在使用 调试另一个问题时`NSLog`），即使启用了所有调试参数，您最终也可能没有堆栈跟踪。幸运的是，您可以在 Xcode 中使用 GDB[将堆栈跟踪恢复到以前的状态](http://www.mulle-kybernetik.com/weblog/2010/07/exc_bad_access_and_no_stack_tr.html)。

在 GDB 控制台中，您应该会看到导致程序崩溃的指令。在失败的返回指令之前找到最后一条成功的返回指令。它应该看起来像这样：

```
je    0x986cef35 <objc_msgSend+117> 
```

记下十六进制值并在 GDB 中执行以下命令：

```
set $eip = 0x986cef35
stepi
where 
```

您现在应该（希望）获得更多信息的堆栈跟踪。

[来源](http://www.mulle-kybernetik.com/weblog/2010/07/exc_bad_access_and_no_stack_tr.html)（与上面的链接相同）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-01T18:03:43.490

Cameron Spickert 的回答有点过时，因为 Xcode 现在使用 lldb 而不是 gdb。源文章的链接也失效了。

使用以下 lldb 命令可以很简单地完成相同的操作：

```
(lldb) thread backtrace 
```

这将显示当前线程的 bt。如果要更改要从中获取 bt 的线程，请选择框架并像这样获取它：

```
(lldb) thread list
(lldb) thread select 2
(lldb) thread backtrace 
```

如果要复制 Cameron Spickert 答案的确切行为，请使用以下命令：

```
(lldb) expr unsigned int $eip = 0x1979c81d4
(lldb) stepi
(lldb) thread backtrace 
```

[来源 1](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/gdb_to_lldb_transition_guide/document/lldb-terminal-workflow-tutorial.html#//apple_ref/doc/uid/TP40012917-CH4-SW9)

[来源 2](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/gdb_to_lldb_transition_guide/document/lldb-command-examples.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-17T20:48:28.287

将 [super dealloc] 作为类 dealloc 方法的最后一条语句。当你首先解除超类时，你会得到这种行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T16:07:59.243

一般的经验法则是，您创建的任何东西都需要管理（保留/释放）。任何来自 NIB 的东西，通常都不应该在代码中发布。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-24T02:10:19.613

上面关于您不应该释放 NIB 对象的陈述与 Apple 相矛盾：请参阅[此处](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmNibObjects.html%23//apple_ref/doc/uid/TP40004998-SW2)，其中说您有出口的对象应该在 dealloc 中释放，并且您应该确保在之后将对象引用设置为 nil .

免责声明：我是一个 iPhone 编程新手，虽然已经编程了很长时间。

# unix - 使用 unix 按百分比确定已用和可用磁盘空间

> ID：468577
> 
> 赞同：2
> 
> 时间：2009-01-22T09:59:27.427
> 
> 标签：unix

如何使用unix查找可用磁盘空间和已用磁盘空间百分比？我只想要百分比。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T10:03:22.880

你的意思是这样的： df -h | awk '{打印 $1 $5}' ？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T10:01:47.343

在 unix 命令行

```
df -h 
```

列出已挂载文件系统的所有可用空间。

# .net - 修改后如何重新启动应用程序/重新读取 app.config 文件（.NET）？

> ID：468603
> 
> 赞同：5
> 
> 时间：2009-01-22T10:10:54.813
> 
> 标签：.net, app-config, restart

我们都知道修改 .NET Web 应用程序的 web.config 文件会重新启动应用程序并使其读取更新的配置。您如何使用控制台或 WinForms 应用程序做到这一点？谢谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T10:13:30.223

可能需要一个 FileSystemWatcher 来监视文件，并处理相关事件。System.Configuration.ConfigManager 类可能具有重新加载的相关方法（方法调用等）。我面前没有VS，但我想说肯定有一些钩子。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T12:59:39.390

使用 FileSystemWatcher 在您的配置文件更改时收到通知。

使用[ConfigurationManager.RefreshSection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.refreshsection.aspx) 从磁盘刷新它，而无需重新启动您的应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T12:27:48.550

[这里](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.refreshsection.aspx)有一个关于实际重新加载数据的好部分。将它与 DarkwingDuck 建议的 FileSystemWatcher 结合起来，您很可能会成为赢家。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T12:32:12.643

创建一个[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)并监听配置文件的变化。
触发时，使用以下代码：

```
MyGeneratedSettingsFile.Default.Reload(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T12:40:25.950

log4net 可以选择检测 *.config 文件的外部更改。正如其他人已经说过的那样，这是通过使用设置为侦听 *.config 文件更改的 FileSystemWatcher 来完成的。

底线；FileSystemWatcher 是要走的路。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T12:40:57.073

不过，简单地重新加载配置文件有更广泛的含义，这就是应用程序的其余部分应该对此做出反应的方式。

例如，您可以在从配置中读取要与 SQL Server 对话并获取它的连接字符串后，为 SQL Server 配置数据库上下文层。

但是，如果用户随后更改并指定 Oracle 数据库怎么办？仅仅重新加载配置文件是不够的，您需要能够告诉应用程序的其余部分也发生了一些变化。

我想说你应该抽象出一个新类中的配置部分，它有事件。一旦你决定重新加载配置，这个类应该在内部找出哪些设置发生了变化并触发适当的事件。

如果您使用的是 IoC 容器，由于新设置，您可能需要重新连接它的一些依赖项。

这样，依赖于配置的应用程序的零碎部分，无论出于何种原因，可能会在给定的时间间隔内在本地缓存配置设置，这将需要挂钩相关事件并响应它们的触发。

至于实际检测和重新加载配置文件本身，其他答案似乎已经涵盖了这一点，所以我不会在这里重复。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T12:43:06.990

如果您使用的是 .NET Framework 2 并且您使用的是**用户**范围设置，那么它是非常透明的。更改设置后，只需调用 Save() 方法，新设置立即可用

例如

```
My.Settings.UpdateInterval = 10
My.Settings.Save() 
```

如果设置是应用程序范围，那么 FileSystemWatcher 可能是要走的路

# .net - 仅在从应用程序运行时导致超时的存储过程

> ID：468605
> 
> 赞同：10
> 
> 时间：2009-01-22T10:11:33.487
> 
> 标签：.net, sql-server, performance, stored-procedures, .net-2.0

我们遇到了一个 sp 的问题。

我们有一个非常简单的 sp，其中包含一个声明的表和几个最终返回 20 到 100 行的外连接。

由于查询这个 sp 在生产和测试环境中都给我们带来了糟糕的性能，我们最近重写了它以提高效率，并在我们的测试环境中以出色的性能进行了彻底的测试。

我们将它发布到生产环境中只是为了发现它仍然很慢并且导致我们的 .NET 2.0 应用程序在调用它时超时。

我们什么都不懂，然后进入生产数据库上的 Management Studio 并在那里运行 sp，它在 1 秒内执行。

也就是说，当从我们的应用程序运行时，它非常慢并导致超时，当从 Management Studio 运行时，它非常快，并且不会超过一秒钟。

任何对 SQL Server 2005 有深入了解的人都可以给我们一些提示吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-16T06:46:01.213

我认为您的问题可能是“参数嗅探”。它是 SQL Server 的执行环境在编译或重新编译期间“嗅探” sp 的参数值以生成更快的执行计划的过程。但有时它会得到一个参数组合，这些参数与 sp 将返回的当前数据一起构成一个非常慢的 sp。

那里有几个很好的解释。在 Stackoverflow 上搜索。这是一个很好的：http: [//omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html](http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html)

一种可能的解决方案是在 sp 中创建局部变量并将传入参数值设置为它们。然后只使用 sp 中的局部变量。

```
CREATE PROCEDURE [dbo].spTest
  @FromDate as DATETIME
AS
BEGIN
  DECLARE @FromDate_local as DATETIME
  SET @FromDate_local = '2009-01-01'

  SET @FromDate_local = @FromDate
  ...
  SELECT * FROM TestTbl WHERE FromDate >= @FromDate_local
END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T14:21:38.453

重新编译是一种钝器。这很可能是参数嗅探

看到这个问题：[Stored Procedure failed on a specific user](https://stackoverflow.com/questions/272726/stored-procedure-failing-on-a-specific-user/275739#275739)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T07:51:11.100

感谢各位的回复，运行 sp_recompile 似乎解决了问题，至少自从我昨天下午执行它以来，一切都在顺利运行，将继续关注它，看看它是否保持快速。

但是不明白当我更改 sp 中的内容时没有进行重新编译？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T10:22:07.707

确保您的生产数据库具有最新的统计信息并且索引处于良好状态（如果可能，请考虑重建所涉及的索引）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T10:43:26.107

你能确定没有发生死锁情况吗？管理工作室的运行将与应用程序隔离，这可能是更大事务的一部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-08-08T09:56:27.387

我建议您在 SSMS 中更改您的首选项，以便默认连接 ARITHABORT OFF 以避免这种混淆。但实际上与应用程序具有相同设置有一个小缺点：您可能没有观察到性能问题与参数嗅探有关。但是，如果您在调查性能问题时养成了使用 ARITHABORT ON 和 OFF 运行问题程序的习惯，您可以很容易地断定是否涉及参数嗅探。

查看这些链接： [https ://www.sommarskog.se/query-plan-mysteries.html#sniffinfo](https://www.sommarskog.se/query-plan-mysteries.html#sniffinfo)

[https://docs.microsoft.com/en-us/sql/t-sql/statements/set-arithabort-transact-sql?view=sql-server-ver15](https://docs.microsoft.com/en-us/sql/t-sql/statements/set-arithabort-transact-sql?view=sql-server-ver15)

# xml - 如何从 XSLT 中获取未解析的实体属性值？

> ID：468608
> 
> 赞同：3
> 
> 时间：2009-01-22T10:13:38.367
> 
> 标签：xml, xslt, dtd, saxon, xalan

我对 XSLT 和 XML 中未解析的实体有疑问。这是一个虚构的场景。首先，我得到一个名为 doc.xml 的 XML 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE document [
<!ELEMENT document (employee)*>
<!ELEMENT employee (lastname, firstname)>
<!ELEMENT lastname (#PCDATA)>
<!ELEMENT firstname (#PCDATA)>
<!NOTATION FOO SYSTEM 'text/xml'>
<!ENTITY ATTACHMENT SYSTEM 'attach.xml' NDATA FOO>
<!ATTLIST employee
       detail ENTITY #IMPLIED>
]>
<document>
    <employee detail="ATTACHMENT">
        <lastname>Bob</lastname>
        <firstname>Kevin</firstname>
    </employee>
</document> 
```

在这个 XML 文件中，我对元素“employee”的属性“detail”使用了一个未解析的实体 (NDATA)。attach.xml 是：

```
<?xml version="1.0" encoding="UTF-8"?>

<name>Bob Kevin</name> 
```

然后我想使用 XSLT 生成输出以及嵌入的 attach.xml。我的 XSLT 文件名为 doc.xsl：

```
<?xml version="1.0"?>

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="document">
<Document>
        <xsl:apply-templates select="employee"/>
</Document>
</xsl:template>

<xsl:template match="employee">
Employee is:  <xsl:value-of select="@detail"/>
</xsl:template>

</xsl:stylesheet> 
```

最后，我使用 Xalan 2.7.1 运行：

```
java -jar xalan.jar -IN doc.xml -XSL doc.xsl -OUT docout.xml 
```

输出是：

```
<?xml version="1.0" encoding="UTF-8"?>
<Document>
Employee is:  ATTACHMENT
</Document> 
```

这不是我想要的。我希望输出如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<Document>
Employee is:  <name>Bob Kevin</name>
</Document> 
```

我应该如何重写 XSLT 脚本以获得正确的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T15:00:39.487

**XSLT 2.0 中的解决方案**：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="document">
<Document>
        <xsl:apply-templates select="employee"/>
</Document>
</xsl:template>

<xsl:template match="employee">
Employee is:  <xsl:value-of select=
"unparsed-text(unparsed-entity-uri(@detail))"/>
</xsl:template>

</xsl:stylesheet> 
```

**请注意**以下事项：

1.  **使用 XSLT 函数[`unparsed-text()`](http://www.w3.org/TR/xslt20/#function-unparsed-text)和[`unparsed-entity-uri()`](http://www.w3.org/TR/xslt20#function-unparsed-entity-uri).**

2.  **attach.xml 文件的文本将在输出中转义**。如果您想看到它未转义，请使用指令的**[`"cdata-section-elements"`](http://www.w3.org/TR/xslt#output)**属性。**[`<xsl:output/>`](http://www.w3.org/TR/xslt#output)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T03:16:37.397

谢谢你，迪米特雷·诺瓦切夫。根据您的回答，我在 XSLT 1.0 中得到了结果。对于那些可能感兴趣的人，请参阅[http://www.xml.com/lpt/a/1243](http://www.xml.com/lpt/a/1243)进行讨论。这是我的解决方案：

```
<?xml version="1.0"?>

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="document">
<Document>
        <xsl:apply-templates select="employee"/>
</Document>
</xsl:template>

<xsl:template match="employee">
Employee is: <xsl:copy-of select="document(unparsed-entity-uri(@detail))"/>
</xsl:template>

</xsl:stylesheet> 
```

请注意上面的以下行：

```
 <xsl:copy-of select="document(unparsed-entity-uri(@detail))"/> 
```

# c - 指针的正确用法

> ID：468611
> 
> 赞同：1
> 
> 时间：2009-01-22T10:14:28.957
> 
> 标签：c, pointers

我有一个函数，它接受指向结构的指针。

结构ABC；

```
void func(ABC ** ptr);  //func is provided by someone else and i don't know about the implementation.
{

} 
```

现在，我有以下代码。

```
ABC xyz[2];
ABC * ptr = xyz;

ABC **dptr1 = &ptr;     //pointer to ponter

ABC ** dptr2 = (ABC **)malloc(2*sizeof(struct abc*)); //pointer to arrary of pointers

dptr2[0] = &xyz[0];
dptr2[1] = &xyz[1]; 
```

如果我将 dptr1 传递给 func，并且 func 执行 *ptr[0] 和 *ptr[1] 之类的操作来访问实际值，则会失败。

那么，传递双指针的标准方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T10:34:16.077

当您传递`ptr1`到时`func`，您实际上是在传递一个指向所占用内存的指针`ptr`。问题是这`func`似乎假设它`ptr1`实际上指向一个指针数组的开头，但是你已经将一个指针传递给了一个只有一个指针的“数组”，`ptr`. `func`可能会对您的堆栈造成重大损害。

将指针传递给函数时应该做的是确定该函数是否将指针视为只是那样，还是将指针视为指向数组的指针（这里的 func 似乎就是这种情况）。在后一种情况下，您必须小心确实为函数提供了一个数组。

在你的代码中，我会写

```
ABC xyz[2];     // two ABC's
ABC * ptrs[2];  // array of pointers to ABC's
ptrs[0] = &xyz[0];
ptrs[1] = &xyz[1];
func(ptrs);    // C compiler convers an array of pointers to
               // a pointer to pointers when passing it to a function 
```

顺便说一句，由于 C 没有数组参数的概念，因此通常最好指定一个带有相关数组长度的附加参数，否则您可能会面临缓冲区溢出漏洞。您的`func`函数可以编写`func(ABC ** ppabc, int elements)`为更好地反映它打算如何使用其参数。当前的函数签名意味着 func 实际上只会使用指向指针的指针所指向的指针（尝试说快三遍！）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T11:43:13.007

从功能界面：

```
void func(ABC** ptr)
{
} 
```

这可能是两件事之一。

*   您正在将指针传递给指针
*   您正在传递一个指向二维数组的指针。

差异是微妙的。
指向指针的指针表示 func() 将更改 (*ptr) 以指向某个对象。这可能是一些内存分配或其他操作。

如果它是一个二维数组（因为你也在你的问题中回避）

```
ABC   xyz[2];
ABC*  ptr = xyz;

ABC** dptr1   = &ptr;     //pointer to ponter
// or 
ABC*  dptr1[] = {xyz};    //pointer to an array.
                          //Thus making dptr the 'logical' equivalent of ABC[1][2]

> if i pass dptr1 to func, and func does something like *ptr[0] and *ptr[1] to access the actual values, it fails. 
```

如果传递的值是一个二维数组。不要将此与此混淆：

```
ABC  value[1][2]; 
```

从技术上讲，这也是一个二维数组，但两种形式的内存布局完全不同。原始数组实际上是一个 ABC 数组，而这是一个真正的二维数组。

```
ABC   row1[3] = {/*STUFF 1*/};
ABC   row2[3] = {/*STUFF 2*/};
ABC   row3[3] = {/*STUFF 3*/};
ABC*  data[3] = {row1,row2,row3};  // logical ABC data[3][3];

func(data); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T10:47:30.747

C中的数组基本上是指针。唯一真正的区别是编译器知道它指向多少个元素。

这意味着无论您的代码需要一个指针，您都可以使用数组的名称，因为它将隐式转换为指向其第一个元素的指针。

如前所述，数组和指针之间的重要区别在于`sizeof()`运算符的结果：对于指针，它将返回存储指针所需的字节数，对于数组，它将返回存储元素所需的字节数！

因此，可以使用以下宏确定数组中元素的数量：

```
#define count(ARRAY) (sizeof(ARRAY)/sizeof(*ARRAY)) 
```

代替`*ARRAY`，您也可以使用`ARRAY[0]`。

无论如何，要将数组传递给函数，只需将其视为指针即可。因为编译器不知道它包含的元素数量（它在转换过程中丢失了这些信息），所以也传递另一个参数来指定它：

```
void func(struct ABC * array, size_t elementCount) {...}

struct ABC anArray[2] = {...};
func(anArray, count(anArray)); 
```

我们使用`count()`宏，因此我们只需要在一处更改数组的大小。

* * *

那么，为什么你的函数需要一个双指针呢？最有可能的是，允许将数组的元素任意放置在内存中。因此，如果您将元素存储在一个普通的旧数组中，则必须对其进行转换：

```
struct ABC array[2] = {...};
struct ABC * parray[count(array)];

for(size_t i = 0; i < count(array); ++i)
    parray[i] = &array[i]; 
```

此外，如果`func`真的不接受数组大小的第二个参数，这可能意味着它要么只接受特定大小的数组（那么，函数的签名应该类似于`func(struct ABC * array[5])`），或者它需要某个元素表示数组的结尾（很可能`NULL`）。在这种情况下，你必须做

```
struct ABC * parray[count(array) + 1];
parray[count(array)] = NULL; 
```

* * *

此外，另一种解决方案是使用二维数组：

```
struct ABC parray[][1] = {
     { {/* first struct's initializer */} },
     { {/* second struct's initializer */} },
     { {/* third struct's initializer */} }
};

func(parray, count(parray)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T10:22:09.783

我已经写了一个关于如何使用指针和双指针的指南，你可以在[这里](http://fekberg.wordpress.com/2008/11/11/pointers-double-pointers/)找到它，这应该解释一些关于它的基础知识并帮助你前进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T10:27:01.350

好吧，您将其标记为 C++，因此在示例中我将使用 new 而不是 malloc。Malloc 的 C 语言有点简单。如果您真的想正确使用 C++，我建议您实际上使用 std::vector 代替。

```
struct ABC
{
  // some members;
};

void func( ABC* firstElemOfArray, int countOfElementsInArray)
{
  for( int i = 0; i < countOfElementsInArray; ++i )
  {
     ABC* currentElement = firstElemOfArray + i;
     // do something with current elements
  }
}

void useFunc()
{
   ABC array[2] = { new ABC(), new ABC() };

   func( array, sizeof(array/sizeof(array[0]) );
} 
```

基本上，您不需要做任何太花哨的事情，只需将指针传递给具有数组长度的数组的第一个元素即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T10:39:46.207

使用类型定义使代码阅读更容易：

```
typedef ABC* ABC_ptr; 
```

然后使用 new 而不是 malloc：

```
ABC_ptr *dptr2 = new ABC_ptr[2]; 
```

您应该能够在 func 中访问 *ptr[0]。您确定初始 ABC 表已初始化吗？

# language-agnostic - 如何解决违反得墨忒耳法则的问题？

> ID：468615
> 
> 赞同：37
> 
> 时间：2009-01-22T10:16:59.917
> 
> 标签：language-agnostic, design-patterns, coupling, law-of-demeter

我和一位同事为我们的客户设计了一个系统，我们认为我们创造了一个很好的干净设计。但是我在我们引入的一些耦合方面遇到了问题。我可以尝试创建一个示例设计，其中包含与我们的设计相同的问题，但如果您原谅我，我将创建我们设计的摘录来支持这个问题。

我们正在开发一个系统，用于为患者注册某些治疗。为了避免到图像的链接断开，我将把 UML 概念类图描述为 ac# 样式类定义。

```
class Discipline {}
class ProtocolKind 
{ 
   Discipline; 
}
class Protocol
{
   ProtocolKind;
   ProtocolMedication; //1..*
}
class ProtocolMedication
{
   Medicine;
}
class Medicine
{
   AdministrationRoute;
}
class AdministrationRoute {} 
```

我将尝试解释一下设计，协议是新治疗的模板。并且协议属于某种类型并且具有需要管理的药物。根据协议，相同药物的剂量可能不同（除其他外），因此存储在 ProtocolMedication 类中。AdministrationRoute 是与协议管理分开管理和创建/更新药物的方式。

我发现以下我们将违反德墨忒耳法则的地方：

## 违反得墨忒耳法则

### BLL 内部

例如，在 ProtocolMedication 的业务逻辑中，有一些规则依赖于药物的 AdministrationRoute.Soluble 属性。代码将变为

```
if (!Medicine.AdministrationRoute.Soluble)
{
   //validate constrains on fields
} 
```

### 存储库内部

列出特定学科中所有协议的方法将被写为：

```
public IQueryable<Protocol> ListQueryable(Discipline discipline)
{
    return ListQueryable().Where(p => (p.Kind.Discipline.Id == discipline.Id)); // Entity Frameworks needs you to compare the Id...
} 
```

### 用户界面内部

我们使用 ASP.NET（无 MVC）作为我们系统的接口，在我看来，这一层目前的违规行为最严重。gridview 的数据绑定（必须显示协议纪律的列必须绑定到 Kind.Discipline.Name），它们是字符串，**所以没有编译时错误**。

```
<asp:TemplateField HeaderText="Discipline" SortExpression="Kind.Discipline.Name">
   <ItemTemplate>
      <%# Eval("Kind.Discipline.Name")%>
   </ItemTemplate>
</asp:TemplateField> 
```

所以我认为实际的问题可能是，什么时候可以将其更多地视为德墨忒耳的建议，以及如何解决违反德墨忒耳法则的行为？

*我对自己有一些想法，但我会将它们作为答案发布，以便可以单独对其进行评论和投票。（我不确定这是这样做的方式，如果不是，我将删除我的答案并将它们添加到问题中）。*

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-22T13:33:08.697

我对得墨忒耳定律后果的理解似乎与 DrJokepu 的不同——每当我将它应用于面向对象的代码时，都会导致更紧密的封装和内聚，而不是在程序代码的契约路径中添加额外的 getter。

维基百科的规则为

> 更正式地说，函数的得墨忒耳定律要求对象 O 的方法 M 只能调用以下类型对象的方法：
> 
> 1.  O本身
> 2.  M的参数
> 3.  在 M 中创建/实例化的任何对象
> 4.  O 的直接组件对象

如果您有一个将“厨房”作为参数的方法，Demeter 说您无法检查厨房的组件，而不是您只能检查直接组件。

> 像这样写一堆函数来满足得墨忒耳定律
> 
> ```
> Kitchen.GetCeilingColour() 
> ```
> 
> 对我来说看起来完全是浪费时间，实际上得到是我完成工作的方式

如果将 Kitchen 之外的方法传递给厨房，则严格的 Demeter 也不能对 GetCeilingColour() 的结果调用任何方法。

但无论哪种方式，重点是消除对结构的依赖，而不是将结构的表示从一系列链接方法移动到方法的名称。在 Dog 类中创建诸如 MoveTheLeftHindLegForward() 之类的方法对实现 Demeter 没有任何作用。相反，调用 dog.walk() 并让狗处理自己的腿。

> 例如，如果要求发生变化，我也需要天花板高度怎么办？

我会重构代码，以便您使用房间和天花板：

```
interface RoomVisitor {
  void visitFloor (Floor floor) ...
  void visitCeiling (Ceiling ceiling) ...
  void visitWall (Wall wall ...
}

interface Room { accept (RoomVisitor visitor) ; }

Kitchen.accept(RoomVisitor visitor) {
   visitor.visitCeiling(this.ceiling);
   ...
} 
```

或者，您可以更进一步，通过将上限参数传递给 visitCeiling 方法来完全消除 getter，但这通常会引入脆弱的耦合。

将其应用于医学示例，我希望 SolubleAdminstrationRoute 能够验证药物，或者如果药物类中封装了验证所需的信息，至少调用药物的 validateForSolubleAdministration 方法。

但是，Demeter 适用于 OO 系统 - 其中数据被封装在对数据进行操作的对象中 - 而不是您正在谈论的系统，它具有不同的层，数据以愚蠢的可导航结构在层之间传递。我认为 Demeter 不一定能像应用于单片系统或基于消息的系统那样容易地应用于此类系统。（在基于消息的系统中，您无法导航到消息中不包含的任何内容，因此无论您喜欢与否，您都会被 Demeter 卡住）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-22T10:47:58.437

我知道我会被彻底消灭，但我必须说我有点不喜欢得墨忒耳法则。当然，像

```
dictionary["somekey"].headers[1].references[2] 
```

真的很丑，但考虑一下：

```
Kitchen.Ceiling.Colour 
```

我对此没有任何反对意见。像这样写一堆函数来满足得墨忒耳定律

```
Kitchen.GetCeilingColour() 
```

对我来说，这看起来完全是在浪费时间，实际上得到是我完成工作的方式。例如，如果要求发生变化，我也需要天花板高度怎么办？使用得墨忒耳定律，我将不得不在 Kitchen 中编写另一个函数，这样我就可以直接获得天花板高度，最后我会到处都有一堆微小的 getter 函数，我认为这是一团糟。

**编辑：**让我重新表述我的观点：

这种抽象级别的东西是否如此重要，以至于我将花时间编写 3-4-5 级别的 getter/setter？它真的使维护更容易吗？最终用户有什么收获吗？值得我花时间吗？我不这么认为。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-22T13:57:57.883

Demeter 违规的传统解决方案是“告诉，不要问”。换句话说，根据你的状态，你应该告诉一个托管对象（你持有的任何对象）采取一些行动——它会根据自己的状态决定是否按照你的要求去做。

举个简单的例子：我的代码使用了一个日志框架，我告诉我的记录器我想输出一个调试消息。然后，记录器根据其配置（可能未启用调试）决定是否将消息实际发送到其输出设备。在这种情况下，LoD 违规将是我的对象询问记录器是否会对消息执行任何操作。通过这样做，我现在将我的代码与记录器内部状态的知识相结合（是的，我故意选择了这个例子）。

但是，这个例子的关键点是记录器实现了*行为*。

我认为 LoD 发生故障的地方是在处理表示*数据*的对象时，*没有任何行为*。

在这种情况下，IMO 遍历对象图与将 XPath 表达式应用于 DOM 没有什么不同。添加诸如“isThisMedicationWarranted()”之类的方法是一种更糟糕的方法，因为现在您在对象之间分配业务规则，使它们更难理解。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-16T23:44:54.653

就像你们中的许多人一样，我一直在为 LoD 苦苦挣扎，直到我观看了 The Clean Code Talks” 会议：

[《不要找东西》](http://www.youtube.com/watch?v=RlfLCWKxHJ0)

该视频可帮助您更好地使用依赖注入，它本质上可以解决 LoD 的问题。通过稍微改变您的设计，您可以在构造父对象时传入许多较低级别的对象或子类型，从而避免父对象必须遍历子对象的依赖链。

在您的示例中，您需要将 AdministrationRoute 传递给 ProtocolMedication 的构造函数。你必须重新设计一些东西，这样才有意义，但这就是想法。

话虽如此，作为 LoD 的新手且不是专家，我倾向于同意你和 DrJokepu 的观点。像大多数规则一样，LoD 可能有例外，它可能不适用于您的设计。

*[晚了几年，我知道这个答案可能对发起人没有帮助，但这不是我发布这个的原因]*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T12:57:08.457

我不得不假设需要可溶性的业务逻辑也需要其他东西。如果是这样，它的某些部分是否可以以有意义的方式封装在医学中（比 Medicine.isSoluble() 更有意义）？

另一种可能性（可能是过度杀伤且同时不完整的解决方案）是将业务规则呈现为其自己的对象并使用双重调度/访问者模式：

```
RuleCompilator
{
  lookAt(Protocol);
  lookAt(Medicine);
  lookAt(AdminstrationProcedure) 
}

MyComplexRuleCompilator : RuleCompilator
{
  lookaAt(Protocol)
  lookAt(AdminstrationProcedure)
}

Medicine
{
  applyRuleCompilator(RuleCompilator c) {
    c.lookAt(this);
    AdministrationProtocol.applyRuleCompilator(c);
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T10:18:17.653

对于 BLL，我的想法是在 Medicine 上添加一个属性，如下所示：

```
public Boolean IsSoluble
{
    get { return AdministrationRoute.Soluble; } 
} 
```

这就是我认为关于得墨忒耳法则的文章中描述的内容。但这会给课堂带来多大的混乱呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T11:03:38.263

关于“可溶”属性的第一个示例，我有几点意见：

1.  什么是“AdministrationRoute”？为什么开发人员希望从中获得药物的可溶性？这两个概念似乎完全无关。这意味着代码不能很好地通信，也许您已经拥有的类的分解可以改进。更改分解可能会导致您看到针对您的问题的其他解决方案。
2.  可溶性不是医学的直接成员是有原因的。如果您发现必须直接访问它，那么它可能应该是直接成员。如果需要额外的抽象，则从医学中返回该额外的抽象（直接或通过代理或外观）。任何需要可溶性属性的东西都可以在抽象上起作用，并且您可以将相同的抽象用于多种其他类型，例如底物或维生素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T11:27:52.427

与其一路走来为每个包含对象的每个成员提供 getter/setter，您可以进行的一种更简单的更改为您提供一些未来更改的灵活性，即为对象提供返回其包含对象的方法。

例如在 C++ 中：

```
class Medicine {
public:
    AdministrationRoute()& getAdministrationRoute() const { return _adminRoute; }

private:
    AdministrationRoute _adminRoute;
}; 
```

然后

```
if (Medicine.AdministrationRoute.Soluble) ... 
```

变成

```
if (Medicine.getAdministrationRoute().Soluble) ... 
```

这使您可以灵活地在将来更改 getAdministrationRoute()，例如按需从数据库表中获取 AdministrationRoute。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-08T04:57:52.837

我认为这有助于记住 LoD 的*存在理由*。也就是说，如果关系链中的细节发生变化，您的代码可能会中断。由于您拥有的类是*接近问题*域的抽象，因此如果问题保持不变，则关系不太可能改变，例如，Protocol 使用 Discipline 来完成其工作，但抽象是高级别的，不太可能改变。想想信息隐藏，协议不可能忽略学科的存在，对吧？也许我对领域模型的理解不了解......

Protocol 和 Discipline 之间的这种联系不同于“实施”细节，例如列表的顺序、数据结构的格式等，这些细节可能会因性能原因而改变。确实，这是一个有点灰色的区域。

我认为如果你做了一个域模型，你会看到比 C# 类图中更多的耦合。[编辑] 我在下图中用虚线添加了我怀疑是问题域中的关系：

[![领域模型UML图](https://i.stack.imgur.com/eiwdG.png)](https://i.stack.imgur.com/eiwdG.png)
[（来源：[plantuml.com](https://www.plantuml.com:80/plantuml/img/VP5D2iCW48NtdcB8ig3GTLQ5xagXz0PMBHtgJr2p2A5thqaROufq8_Y-zsR6CJpHTjnp0o4EMgNJeuYzqUI1Ke4oNHp0A7DJFX2XUGXmn22mqsZLLxXu5vrm-eHMmWW4eF2qG5u_ld5obA6s5CvAek0HdQr4LmXpbVa-TSdEHVdmWpHeCJrgpbnT7mjh1P8SfxJAAuCavvBA61YhY_zgJhnORfQfLlT8Dnih83HxndPDPKLayp5fpBNu6m00)）]

另一方面，你总是可以通过应用[*Tell, don't ask*来](https://web.archive.org/web/20200513213948/https://pragprog.com/articles/tell-dont-ask)重构你的代码：

> *也就是说，你应该努力告诉对象你想让他们做什么；不要问他们关于他们的状态的问题，做出决定，然后告诉他们该怎么做。*

您已经用您的[答案](https://stackoverflow.com/questions/468615/how-to-solve-the-violations-of-the-law-of-demeter/468621#468621)重构了第一个问题 (BLL) 。（进一步抽象 BLL 的另一种方法是使用规则引擎。）

重构第二个问题（存储库），内部代码

```
 p.Kind.Discipline.Id == discipline.Id 
```

可能会被使用集合的标准 API 的某种 .equals() 调用替换（我更多的是 Java 程序员，所以我不确定 C# 的精确等效项）。这个想法是隐藏如何确定匹配的细节。

为了重构第三个问题（在 UI 内部），我也不熟悉 ASP.NET，但是如果有办法*告诉*Kind 对象返回 Disciplines 的名称（而不是像在 Kind. Discipline.Name)，这是尊重 LoD 的方法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-18T22:03:54.400

第三个问题很简单：`Discipline.ToString()`应该评估`Name`属性 那样你只调用`Kind.Discipline`

# javascript - jquery interface.js com 是否总是使用新版本的 jQuery？

> ID：468616
> 
> 赞同：-1
> 
> 时间：2009-01-22T10:17:03.273
> 
> 标签：javascript, jquery

在 interface.js 网站（[http://interface.eyecon.ro/](http://interface.eyecon.ro/)）上，他们建议`interface.js`使用 jQuery 1.1.2 下载。我想知道 interface.js 是否仍然与新版本的 jQuery 兼容，以及是否会有这个库的新版本。

我在使用带有接口 1.2 的 jQuery 1.2.x 时遇到了一些麻烦，并且使用 jQuery 1.1.4 来纠正我遇到的错误。

对不起我的英语不好，希望有人能理解我的问题^^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T10:53:25.163

我不会使用接口库。它现在不受[jquery-ui](http://ui.jquery.com/)支持和取代，我怀疑在使用最新的 jQuery 1.3 时会出现重大问题。

请参阅[以下帖子](http://groups.google.com/group/jquery-ui/browse_thread/thread/9436f24519e35369/1f06c0bdd28155e8)并由 jquery-ui 开发人员之一 Scott 回复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T10:53:32.247

接口库现在更像是一个存档。最新版本的 jquery (1.3) 将无法使用它。

所有接口的东西现在都是 jquery 站点的官方部分，并且有据可查。您可以从[http://ui.jquery.com/下载它](http://ui.jquery.com/)

# apache-flex - flex编辑ResultEvent结果

> ID：468617
> 
> 赞同：1
> 
> 时间：2009-01-22T10:17:29.463
> 
> 标签：apache-flex, resultevent

我有一个具有自动完成功能的文本输入字段，我从 Web 服务填充它的数据提供程序。

我将 web 服务调用的结果分配给 dataprovider

```
ac.dataProvider = e.result; 
```

但是我现在想编辑从 ResultEvent 返回的每个字段，以便添加更多信息，我尝试做这样的事情；

```
var results:ArrayCollection = new ArrayCollection(new Array(e.result));
var newResultsArray:ArrayCollection;
var array:Array = new Array;
for(var i:int = 0 ; i < results.length; i++)
{
   array[i] = results.getItemAt(i) + "extraInformation";    
}
newResultsArray = new ArrayCollection(array);
acu.dataProvider = newResultsArray; 
```

然而，这只会使所有结果出现在一个领域。关于如何以与 result.event 返回的格式相同的格式将编辑的数据分配给我的数据提供者的任何建议？

问题似乎是包含

```
results.getItemAt(i) + "extraInformation"; 
```

正在将调用的完整内容返回到一行中。有什么方法可以将其分解，以便我可以从 ResultEvent 中获取每一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T10:57:46.700

这完全取决于 e.result 是什么。我怀疑它是某种对象/xml，因此当您将其放入数组然后放入arrayCollection 时，它只会填充arrayCollection 中的元素0。

我认为您需要做的是遍历任何 e.result 并将其每个元素添加到 arrayCollection。

因此，例如，如果 e.result 是 XML，那么请尝试以下操作

```
var xmlBack : XML = XML(e.result);
var xmllist : XMLList = new XMLList();
xmllist = xmlBack.nodeYourLookFor;
var results = new ArrayCollection();
for each(var xml : XML in xmllist ){
    results.addItem(xml.toString));
}

yourAutoComplete.dataProvider = results; 
```

正如我所说，这一切都取决于 e.result 是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:11:13.897

它实际上是我找回的一个对象，

当我调试并查看我的 web 服务的内容时，将其称为 arrayCollection。我是 Flex 的新手，所以这个基本的东西仍然给我带来了问题！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T13:27:24.543

通过执行以下操作对其进行排序；

```
var lengthOfResult:int = e.result.length;
var arrayCollResults:ArrayCollection = new ArrayCollection();
var resultArray:Array = new Array(e.result);
    for(var i:int = 0 ; i < lengthOfResult; i++){
    arrayCollResults.addItem(e.result[i] + additionalInfo);
}
ac.dataProvider = arrayCollResults; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T13:37:00.107

从你的问题来看，听起来你想保持数据（及其类型）完好无损，你应该能够在你的事件处理程序中，而无需创建新的集合、强制转换等。但是 kenneth 是对的——这很难在不知道结果的类型和结构的情况下具体。

从您在我回复时发布的附录判断，您应该能够做到这一点，因为结果看起来是一个数组：

```
for (var i:int = 0; i < e.result.length; i++)
{
    e.result[i] += newInformation;
}

var ac:ArrayCollection = new ArrayCollection(e.result); 
```

...直接更改结果数据，然后从中创建一个新的 ArrayCollection。不过，您想出的内容与此之间没有重大区别 - 只是想说明如何在转换结果数据或从中创建新对象之前直接修改结果数据。

# iphone - 如何从 iPhone 连接到 MySQL 数据库？

> ID：468618
> 
> 赞同：14
> 
> 时间：2009-01-22T10:17:41.897
> 
> 标签：iphone, sql, mysql, cocoa-touch

我正在尝试从 iPhone 连接到远程 mysql 数据库。我搜索了许多网站，但没有找到任何帮助。如果有人使用过这个，请发送解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T19:58:09.493

假设您对服务器端编程（如 PHP 或 Rails）有一定的经验，您可以从建立与 MySQL 服务器的连接的 URL 的内容创建一个 NSArray，并以 ASCII 或 XML 格式打印您想要的结果。

```
NSURL *myURL = [NSURL URLWithString:@"http://www.myserver.com/results.php"];
NSArray *sqlResults = [[NSArray alloc] initWithContentsOfURL:myURL]; 
```

对于帮助您格式化服务器页面打印的结果也很有用：http: [//developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T10:22:49.890

[一个快速的谷歌](http://www.google.co.uk/search?q=objective+c+mysql)会告诉你的方式......

# tfs - 如何在团队基础服务器源代码控制结构中处理共享项目

> ID：468626
> 
> 赞同：4
> 
> 时间：2009-01-22T10:20:27.120
> 
> 标签：tfs, shared-libraries, projects-and-solutions

在阅读[了 Team Foundation Server 源代码控制结构](https://stackoverflow.com/questions/381020/team-foundation-server-source-control-structure)之后，我想到了几个问题，我想知道是否有人可以发表评论。

我有几个组成我正在从事的项目的组件。我有一个智能客户端、一个网络服务、一个智能客户端使用的网络服务代理、一个守护进程和一个在智能客户端和网络服务中都使用的通用实用程序库。每个组件都与同一个工作项目相关。

我已经构建了我的源代码树，以便每个组件都是独立的 - 换句话说，每个组件（智能客户端、Web 服务、守护程序、代理、常用实用程序）都有自己的主干和自己的解决方案文件，因为我希望能够发布每个组件独立。对于其他组件使用的组件，例如在 smartclient 使用代理和通用实用程序的情况下，我创建了像任何其他 3rd 方库一样处理的版本（引用二进制文件而不是项目）。任何人都可以确认这在某种程度上是一个最佳实践，如果不是，否则应该如何做？

我一直在使用 tfs build 构建我的组件的版本，我想知道如果除了所有 tf​​s 构建所在的构建输出目录之外的任何地方，我应该将这些版本放在哪里。我是否应该将它们（例如智能客户端使用的代理发布程序集）与任何其他第 3 方库一起检查到 TFS 中，然后将发布程序集分支到要使用它们的位置（例如，将代理发布 dll 分支到智能客户端 lib 目录） ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-30T13:31:23.733

我们所做的是在 TFS 服务器上创建一个公共**\common**共享，其中包含对应于每个主要共享项目的子文件夹。例如：

```
\\常见的  
    \共享项目1
        \v1.0.0
        ...
        \vN.0.0
    ...
    \sharedprojectN

```

我们的每个非共享项目都**引用**了 \ **common** \ **sharedprojectN** \v **M.mn中的特定共享程序集**

我们首先在需要时运行共享项目的自动构建。
然后将构建质量更改为特定值（例如“Ready For Reference”）表示构建的输出需要自动复制到这些共享版本之一。

然后，我们可以使用这些共享项目的输出为项目运行自动构建。
我们使用其他构建质量状态（例如“系统集成准备就绪”）来指示主应用程序的构建已准备好部署到特定环境（例如测试）。
这会触发将项目输出打包到我们公共**\release**共享上的特定发布文件夹中。

最后，我们使用自动部署工具将给定版本安装到给定目标环境中的适当服务器上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T10:25:37.437

所以你本质上指的是通常所说的“依赖复制”。利用 Team Build 并复制您的依赖项。有一个名为“Dependency Replicator”的工具可以让你将构建链接在一起。

因此，例如，您的实用程序类可能不会有太大变化。但是当它这样做时，您需要确保：A）它构建在服务器上 B）所有依赖项目也构建。

依赖关系复制器允许您（在 XML 中）指定程序集如何相互依赖，以及在更新依赖关系时运行哪个“构建”。

# python - 是否有独立的 Python 类型转换库？

> ID：468639
> 
> 赞同：0
> 
> 时间：2009-01-22T10:29:33.450
> 
> 标签：python, type-conversion

有没有独立的类型转换库？

我有一个只能理解字节/字符串的数据存储系统，但我可以标记元数据，例如要转换为的类型。

我可以破解一些简单的类型转换器系统，就像在我之前所有其他应用程序所做的那样，或者我可以希望使用一个独立的库，除非我找不到。这种常见的活动很奇怪。

只是为了澄清，我会有类似的东西：

('123', 'integer') 我想出去 123

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T10:59:44.637

您有两个选择，使用[struct](http://docs.python.org/library/struct.html#module-struct)或[pickle](http://docs.python.org/library/pickle.html#module-pickle)模块。

使用 struct 指定格式并将数据压缩为字节数组。这对于使用 C 结构或写入需要二进制协议的网络应用程序很有用。

pickle 可以自动将复杂的 Python 结构序列化和反序列化为字符串。有一些警告，所以最好阅读[文档](http://docs.python.org/library/pickle.html#module-pickle)。我认为这很可能是您想要的库。

```
>>> 进口泡菜
>>> v = pickle.dumps(123)
>>> v
'I123\n.'
>>> pickle.loads(v)
123
>>> v = pickle.dumps({"abc": 123})
>>> v
“（dp0\nS'abc'\np1\nI123\ns。”
>>> pickle.loads(v)
{'abc'：123}

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T12:02:48.193

考虑一下。

```
import datetime

def toDate( someString ):
    return datetime.datetime.strptime( someString, "%x" ).date()

typeConversionMapping = { 'integer': int, 'string': str, 'float': float, 'date': toDate }
def typeConversionFunction( typeConversionTuple ):
    theStringRepresentation, theTypeName = typeConversionTuple
    return typeConversionMapping[theTypeName](theStringRepresentation) 
```

对于这样一个常见的活动，这是一个足够好的独立库吗？一个经过良好测试的、具有容错性的库就足够了吗？还是需要更多的东西？

如果您需要更多或不同的日期/时间转换，您只需添加`toDate`不同格式的新函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-18T12:51:46.813

平地在这方面做得很好。[http://discorporate.us/projects/flatland/](http://discorporate.us/projects/flatland/)

# tfs - 我应该如何引用 Team Foundation Server 版本？

> ID：468640
> 
> 赞同：0
> 
> 时间：2009-01-22T10:29:53.323
> 
> 标签：tfs, versioning, tfsbuild

我正在使用 tfs build 构建我的项目的版本，它为 tfs 构建浏览器中的构建生成唯一标识，例如“MyProject_20090122.1”，表明这是 2009 年 1 月 22 日的第一个构建。然而，这是我发布的 MyProject 1.0.0。有没有办法连接这两个标识符，还是我必须在外部和其他地方维护映射？

我是否应该让我的版本标识符确认 tfs 构建名称的方式，以便我的上述版本号应该是 1.0.20090122.1？

有没有办法向 tfsbuild 添加评论？

你怎么做呢？

编辑：

正如一些人所建议的，版本号可以通过 msbuild 更新并自动递增。然而，问题是我如何确定特定团队构建的版本，因为版本号未嵌入构建名称中？我可以控制 tfs 构建名称的标识符吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T10:50:12.690

您可以覆盖版本控制目标以提供您自己的版本号。这样你就可以符合 xxx 或任何你想要的风格。理想情况下，xyx 意味着 x 是主要版本，y 是次要版本（点发布），z 是一个唯一的版本号，每次构建都会递增。您可能还想使用新更新的内部版本号（例如 1.0.1423）再次签入 assemblyinfo.cs。

通过谷歌有很多关于这个的信息。特别是：http: [//geekswithblogs.net/etiennetremblay/archive/2008/10/03/matching-tfs-build-labels-with-custom-build-number.aspx](http://geekswithblogs.net/etiennetremblay/archive/2008/10/03/matching-tfs-build-labels-with-custom-build-number.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T10:50:22.597

我已经获取了我的 msbuild 文件并覆盖了版本号生成步骤。这允许我推送我自己的版本号，然后 MSBuild 在整个构建步骤中使用该版本号。

您需要编辑的文件是 TFSBuild.proj 文件，它本质上只是一个 MSBuild 文件。

如果您有一个名为“BuildNumberOverrideTarget”的目标，如下面的代码所示，您可以告诉 MSBuild 使用您的自定义编号。还有一篇关于如何覆盖内部版本号的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/aa395241(VS.80).aspx)

```
<Target Name = "BuildNumberOverrideTarget" >
    <BuildNumberGenerator> 
    <Output TaskParameter="BuildNumber" PropertyName="BuildNumber"/> 
    </BuildNumberGenerator> 
  </Target> 
```

本质上，您所要做的就是编写一个覆盖 BuildNumberOverrideTarget 的目标，您的构建将反映这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T03:39:14.430

查看我的博客文章，了解有关如何创建和集成您自己的 TFS 内部版本号生成器的完整详细信息：http: [//www.grahamzero.com/blog/2009/03/team-foundation-server-2008-build-number-generator .html](http://www.grahamzero.com/blog/2009/03/team-foundation-server-2008-build-number-generator.html)

# sql-server - 将 BIT 列与 0 而不是 1 进行比较时，查询的工作速度要慢几倍

> ID：468641
> 
> 赞同：2
> 
> 时间：2009-01-22T10:30:18.567
> 
> 标签：sql-server, performance, bit

我使用基于具有 17 个连接（内部和左/右外部）和子查询的复杂查询的视图。所有视图行在大约 5 秒内显示。

```
SELECT * FROM a_view; 
```

视图列之一具有 BIT 类型。当我过滤视图行将其与 1 进行比较时，查询会再次运行大约 5 秒。

```
SELECT * FROM a_view WHERE c = 1; 
```

但是当我将此 BIT 列与 0 进行比较时，查询的工作时间约为 50 秒（慢 10 倍）。

```
SELECT * FROM a_view WHERE c = 0; 
```

这个返回相同结果行的查询按预期工作大约 10 秒：

```
SELECT * FROM a_view 
EXCEPT
SELECT * FROM a_view WHERE c = 1; 
```

所以我想知道为什么与 0 或 'FALSE' 比较需要这么多时间？请有任何想法。

在这个 BIT 字段上排序很快。按其他列过滤也很快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-08-25T07:58:06.487

我知道这是一个非常古老的问题，但如果有人仍在寻找解决方案，你可以试试这个。我最近遇到了同样的问题，它是在一个相对简单的查询上，一个连接中只有 3 个表，其中最大的只有 1000 多行。不幸的是，我没有权限查看执行计划，所以我不得不即兴发挥。

```
select * from subquery_x; 
```

非常快，基本上立即完成（仅返回大约 500 行），因为它应该

```
select * from subquery_x where column_x = 1 
```

dtto，非常快，column_x 是非空位列

```
select * from subquery_x where column_x = 0
select * from subquery_x where column_x != 1 
```

应该返回大约 300 行，两者都非常非常慢，实际上花了几分钟！

**简单（但奇怪）的解决方案**- 将 where 子句中的列转换为 tinyint

```
select * from subquery_x where convert(tinyint,column_x) = 0 
```

我知道这可能会产生一些性能副作用，但它就像一个魅力，将转换后的列值与 1 进行比较也非常快，所以我让它这样（它在报告中使用，比较值作为参数提供)

如果有人知道为什么会发生这种情况，请告诉我们，我怀疑这是一个错误，但谁知道呢，也可能是一个讨厌的功能 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T10:59:17.307

SQL Server sql 引擎将视图的整个 SQL 查询放在您在视图上编写的 SQL 语句中，然后尝试对其进行优化。

这可能导致在 c=0 的情况下，所用表的统计信息显示与该谓词匹配的行比 c=1 的多得多。例如，在 c=1 的情况下，包含作为连接中心的 c 字段的表可能只返回 5 个匹配的行，这会导致与表返回 100 万行（例如c=0 的情况）。

因此，请检查两者的执行计划。还要检查两者的服务器分析器结果，与 c=0 一样，读取次数可能比 c=1 多得多，返回的结果也比 c=1 多得多。返回所有行可能需要一段时间，所以这也可能是查询速度较慢的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T11:03:35.830

通常有不止一种方法可以执行涉及连接的查询。所有现代 RDBMS 都会搜索不同的连接计划，通过估计每个计划的成本（CPU 和磁盘访问时间）来寻找最佳计划。

问题是，查询中的每个附加连接都会将可能的计划数量乘以不断增加的数量，导致随着连接数量的增加，要考虑**的计划数量出现双因子（比指数更差）增长**。出于这个原因，数据库必须将搜索限制在某个地方，这意味着对于涉及许多连接的查询，不可避免地会选择次优计划。

作为参考，PostgreSQL 默认在 12 次连接后停止评估所有可能的计划。SQL Server 肯定会有类似的限制。评估 17 个连接需要 (2 * 13) * (2 * 14) * (2 * 15) * (2 * 16) * (2 * 17) 次 - 这足以压倒任何具有曾经存在过，*或将*永远存在。

还有一个事实要考虑的是，DB 根据粗略的统计数据估算成本，例如一列中不同值的数量和/或一列中 10 个最常见值的列表。这一切都表明，随着连接数量的增加，选择最佳（甚至合理）连接策略的可能性会*下降*。

为什么需要加入 17 个表？有没有办法可以简化您的数据库架构？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-22T15:22:13.613

类似于[horcic.roman](https://stackoverflow.com/a/45876832/221683)的解决方案...我将值或列转换为 BIT 以大幅提高速度。

```
myColumn = CAST(1 AS BIT)

CAST(myColumn AS BIT) = 1 
```

显然很奇怪，因为该列是 BIT NOT NULL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-18T17:41:41.700

慢的 ：

select * from bigTable where column = 1

慢的

select * from bigTable where column = cast(1 as bit)

快速地 ：

将@b 声明为位 = 1

select * from bigTable where column = @b

# php - 是否可以在 PHP 中创建静态类（如在 C# 中）？

> ID：468642
> 
> 赞同：147
> 
> 时间：2009-01-22T10:30:57.910
> 
> 标签：php, design-patterns, oop, static

我想在 PHP 中创建一个静态类，并让它像在 C# 中一样，所以

1.  构造函数在第一次调用类时自动调用
2.  无需实例化

这种东西...

```
static class Hello {
    private static $greeting = 'Hello';

    private __construct() {
        $greeting .= ' There!';
    }

    public static greet(){
        echo $greeting;
    }
}

Hello::greet(); // Hello There! 
```

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2009-01-22T10:39:12.947

您可以在 PHP 中使用静态类，但它们不会自动调用构造函数（如果您尝试调用`self::__construct()`，则会收到错误消息）。

因此，您必须创建一个`initialize()`函数并在每个方法中调用它：

```
<?php

class Hello
{
    private static $greeting = 'Hello';
    private static $initialized = false;

    private static function initialize()
    {
        if (self::$initialized)
            return;

        self::$greeting .= ' There!';
        self::$initialized = true;
    }

    public static function greet()
    {
        self::initialize();
        echo self::$greeting;
    }
}

Hello::greet(); // Hello There!

?> 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-07-20T09:49:39.060

除了 Greg 的回答，我建议将构造函数设置为私有，这样就不可能实例化该类。

所以在我看来，这是一个基于 Greg 的更完整的例子：

```
<?php

class Hello
{
    /**
     * Construct won't be called inside this class and is uncallable from
     * the outside. This prevents instantiating this class.
     * This is by purpose, because we want a static class.
     */
    private function __construct() {}
    private static $greeting = 'Hello';
    private static $initialized = false;

    private static function initialize()
    {
        if (self::$initialized)
            return;

        self::$greeting .= ' There!';
        self::$initialized = true;
    }

    public static function greet()
    {
        self::initialize();
        echo self::$greeting;
    }
}

Hello::greet(); // Hello There!

?> 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-01-22T10:44:34.903

你可以拥有那些类似“静态”的类。但我想，缺少一些非常重要的东西：在 php 中你没有应用程序周期，所以你不会在整个应用程序中获得真正的静态（或单例）......

参见[PHP 中的单例](https://stackoverflow.com/questions/432192/singleton-in-php)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-08-24T09:37:29.973

```
final Class B{

    static $staticVar;
    static function getA(){
        self::$staticVar = New A;
    }
} 
```

b 的结构称为 singeton 处理程序，您也可以在 a 中执行此操作

```
Class a{
    static $instance;
    static function getA(...){
        if(!isset(self::$staticVar)){
            self::$staticVar = New A(...);
        }
        return self::$staticVar;
    }
} 
```

这是单例使用 `$a = a::getA(...);`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-30T21:43:21.180

我通常更喜欢编写常规的非静态类并使用工厂类来实例化对象的单个（sudo static）实例。

这种方式构造函数和析构函数正常工作，如果我愿意，我可以创建额外的非静态实例（例如第二个数据库连接）

我一直使用它，对于创建自定义数据库存储会话处理程序特别有用，因为当页面终止时，析构函数会将会话推送到数据库。

另一个优点是您可以忽略调用顺序，因为一切都将按需设置。

```
class Factory {
    static function &getDB ($construct_params = null)
    {
        static $instance;
        if( ! is_object($instance) )
        {
            include_once("clsDB.php");
            $instance = new clsDB($construct_params);   // constructor will be called
        }
        return $instance;
    }
} 
```

数据库类...

```
class clsDB {

    $regular_public_variables = "whatever";

    function __construct($construct_params) {...}
    function __destruct() {...}

    function getvar() { return $this->regular_public_variables; }
} 
```

任何你想使用它的地方只需调用...

```
$static_instance = &Factory::getDB($somekickoff); 
```

然后将所有方法视为非静态的（因为它们是）

```
echo $static_instance->getvar(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-29T15:46:27.753

对象不能静态定义，但这有效

```
final Class B{
  static $var;
  static function init(){
    self::$var = new A();
}
B::init(); 
```

# java - 如何在多个上下文之间共享我的 JSP .tag 文件？

> ID：468649
> 
> 赞同：0
> 
> 时间：2009-01-22T10:39:13.837
> 
> 标签：java, jsp, tomcat, web-applications, tags

我有一组 .tag 文件（例如呈现版权声明的标签），我想在我的 Tomcat 应用程序服务器上的所有应用程序上下文中共享它们。

我只在上下文的 /WEB-INF/tags 目录中使用过它们，通过 taglib 指令 tagdir = "/WEB-INF/tags" 引用它们

如何使标签可用于我的所有上下文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T10:59:47.163

您可能必须将它们放在共享 JAR 所在的目录中。正确的位置取决于您运行的 Tomcat 版本。在 4.x 和 5.x 版本上，它可能是 common/lib，因为该目录中的文件对服务器和所有上下文都是可见的。在 6.x 版本上，它可能是 /lib 目录。检查您的文档并尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:10:44.567

作为将标记文件添加到所有上下文的替代方法，为什么不尝试在 web.xml 的 taglib 元素中给出 taglib-location 的绝对路径：

```
 <taglib>
    <taglib-uri>mytaglib</taglib-uri>
    <taglib-location>/mytaglib.tld</taglib-location>
  </taglib> 
```

您需要为所有应用程序定义一个公共存储库。我自己没试过。

# javascript - 使用 RegEx 的 JavaScript 小数位限制

> ID：468655
> 
> 赞同：12
> 
> 时间：2009-01-22T10:46:59.997
> 
> 标签：javascript, regex

我对文本框进行了一些客户端验证，该文本框只允许最多两位小数的数字而没有其他输入。

该脚本是仅用于输入数值的基础，但需要对其进行调整，以便它可以带一个小数点，后跟最多两位小数。

我已经尝试过诸如 之类的东西`/[^\d].\d{0,2}`，但是替换调用不起作用，而且我不知道该怎么做。

## 代码

```
<script type="text/JavaScript">
  function valid(f) {
    if (!/^\d*$/.test(f.value)) {
      f.value = f.value.replace(/[^\d]/g,"");
      alert("Invalid number");
    }
  }
</script> 
```

* * *

### 笔记

我需要匹配一个空字符串。如果提供了一个空字符串并提交了表单，则该值默认为零。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-22T10:57:58.150

这 。字符在 RegEx 中具有特殊含义，因此需要转义。

```
/^(?:\d*\.\d{1,2}|\d+)$/ 
```

这匹配 123.45、123.4、123 和 .2、.24 但不匹配空字符串 123.、123.456

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T10:59:34.527

`.`在 RegEx 中表示：任何字符，你必须在它前面加上一个反斜杠。`\.`

这会更好：

```
/^\d+(\.\d{0,2})?$/ 
```

我包括的部分：

*   点前至少需要 1 个数字。如果您不想要这个，请替换`+`为，`*`但也会匹配空字符串。
*   如果你有十进制值，你需要前面的点。
*   数字后面不应该有任何内容，`$`代表输入的结束。

对于替换部分，您还应该包括点

```
f.value.replace(/[^\d\.]/g, "") 
```

**编辑：**

如果是用于输入的实时验证，为什么不截取关键事件并测试它们的有效性（通过在内存中创建字符串）或删除字段中的最后一个字符？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T11:54:04.090

你真的想用正则表达式来做这件事吗？

```
function valid(f) {
    if(isNaN(f)){return false;}
    return 100 * f == parseInt(100*f,10);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T11:32:41.217

gs：这很接近，但是线

```
f.value = f.value.replace(/[^\d\.]/g, ""); 
```

实际上似乎不起作用。事实上，由于某种原因，我失去了文本框的焦点。虽然也许这是我的代码；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-22T16:24:01.253

您可以使用 javascript 函数而不是正则表达式

```
function IsValid(value) {
    var split = value.split('.');

    if (split.length != 2) {
        return false;
    }
    else if (split[1].length > 2 || !Number(split[1])) {
        return false;
    }
    else if (!(split[0] == '' || split[0] == '0')) {
        return false;
    }

    return true;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-12T10:11:18.337

## 正则表达式

```
/^\d+(\.\d{1,2})?$/ 
```

* * *

## JavaScript

```
function valid(f) {
  if(!f.value) { // Test if text field is empty
    f.value = 0; // Initialize value to 0
    console.log("Valid number"); // Let user know input is OK
  } else if (!/^\d+(\.\d{1,2})?$/.test(f.value)) { // Test regex
    f.value = ""; // Empty the text box
    console.error("invalid number"); // Let user know input is not OK
  } else {
    console.log("Valid number"); // Let user know input is OK
  }
}

document.getElementById("testbutton").addEventListener( // Add event listener to button
  "click",
  valid.bind( // Bind the text field to the `value` function
    this, 
    document.getElementById("testfield")
  )
);
```

```
<input id="testfield" value="15.1" />
<button id="testbutton">Test expression</button>
```

* * *

## 解释

1.  `/ /`: 表达式的开头和结尾
2.  `^`: 后面的内容应该在你正在测试的字符串的开头
3.  `\d+`: 应该至少有一位数字
4.  `( )?`: 这部分是可选的
5.  `\.`: 这里有一个点
6.  `\d{1,2}`: 这里应该有一位到五位数字
7.  `$`: 前面的任何内容都应该在您正在测试的字符串的末尾

* * *

## 提示

您可以使用[regexr.com](https://regexr.com/)或[regex101.com](https://regex101.com/)直接在浏览器中测试正则表达式！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-24T12:56:20.993

如果我们需要验证文本框中的数字值，我们希望防止多于一位小数（例如 2..3、.2\. 等）

下面是 Javascript 函数。

```
 if (MoreThanOnePoint(document.getElementById("txtNoofHrs").value) == false) {
     alert("Please enter one decimal only");
     document.forms[0].txtNoofHrs.focus();
     return false;
 }

 function MoreThanOnePoint(strString) {
     var strChar;
     var blnResult = true;
     var varcount = 0;

     for (i = 0; i < strString.length && blnResult == true; i++) {

         if (strString.charAt(i) == ".") {
             varcount++;
             if (varcount > 1) {
                 //alert("Please enter one decimal only");
                 blnResult = false;
             }
         }
     }
     return blnResult;
 } 
```

# c# - IIS 7.0 中的奇怪行为 - System.DirectoryServices

> ID：468658
> 
> 赞同：0
> 
> 时间：2009-01-22T10:49:17.513
> 
> 标签：c#, iis-7, active-directory

我在 IIS 7.0 中遇到了一个奇怪的问题：

我在 IIS 中有以下虚拟目录： [![替代文字](https://i.stack.imgur.com/EEhGd.jpg)](https://i.stack.imgur.com/EEhGd.jpg)

**并且在 IIS 中的虚拟目录上仅启用了 Windows 身份验证模式**

现在，如果我尝试以这种方式为 TestV/Folder/file.aspx 获取关联的 DirectoryEntry：

```
string vDir = @"/TestV/folder/file.aspx";

            DirectoryEntry dir = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/ROOT" + vDir, @"adminusername", @"password");
            dir.AuthenticationType = AuthenticationTypes.Secure;

            try
            {
                Console.WriteLine(dir.Name);
            }
            catch (Exception exp)
            {
                Console.WriteLine(exp.Message);
            }

            Console.WriteLine(""); 
```

我得到异常：“系统找不到指定的路径”

现在，如果我回到 IIS，然后执行以下步骤：右键单击 TestV/Folder*并启用匿名身份验证模式，然后再次禁用它*

右键单击 TestV/Folder/file.aspx*并启用匿名身份验证模式，然后再次禁用它*

本质上，我只是对 aspx 文件 Testv/Folder/file.aspx 执行了一些手动访问。

经过上述步骤，如果我重新运行程序，代码成功地能够访问目录条目并成功打印名称（file.aspx）

这里有什么问题？

还有一个信息：

我在 IIS 6.0 上也看到了这种行为。因此，除非我在 IIS 中对虚拟目录中的文件夹/文件进行一些手动操作，否则它似乎不会在活动目录中创建相应的元数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T06:23:23.077

我得到了问题的答案（在我的一位同事的帮助下）

解决方法如下： 1\. 程序在访问虚拟目录下的文件/文件夹之前，需要在 IIS 元数据中添加（伪？）条目，然后我们才能访问该条目：

```
try
            {
                // make pseudo entries:
                DirectoryEntry folder = rootDir.Children.Add("Folder", "IISWebDirectory");
                folder.CommitChanges();
                file = folder.Children.Add("File.aspx", "IISWebFile");
                file.CommitChanges();
            } 
```

然后瞧它的工作原理

PS：

```
DirectoryEntry dir = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/ROOT" + vDir, @"adminusername", @"password");
dir.AuthenticationType = AuthenticationTypes.Secure;
dir.RefreshCache(); 
```

**Directory.Refresh 没有帮助**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T16:08:48.413

如果您在第三行之后立即调用 RefreshCache() 会有所帮助吗？

```
DirectoryEntry dir = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/ROOT" + vDir, @"adminusername", @"password");
dir.AuthenticationType = AuthenticationTypes.Secure;
dir.RefreshCache(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T17:04:11.000

虽然这不完全是一个答案，但我会指出 System.DirectoryServices 通常不用于与 IIS 交互。虽然它可以让您访问 IIS 设置，但 WMI 通常是更好的选择。

# mysql - 如何在mysql中查找列是否为auto_increment？

> ID：468664
> 
> 赞同：8
> 
> 时间：2009-01-22T10:52:57.957
> 
> 标签：mysql, database

我正在尝试检查我的 mysql 数据库 information_schema 以找出列的属性。我找不到关于哪些列是 auto_increment 的详细信息。有谁知道我可以在 information_schema 数据库中的哪里找到此信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-22T11:02:04.493

请参阅 COLUMNS 表中的 EXTRA 列：

```
select * from COLUMNS where  TABLE_SCHEMA='yourschema' and TABLE_NAME='yourtable' and EXTRA like '%auto_increment%' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-30T21:32:47.050

你可以使用

```
mysql> DESCRIBE yourtable; 
```

例子：

```
mysql> use my_database;
mysql> describe users;
+----------+--------------+------+-----+---------+----------------+
| Field    | Type         | Null | Key | Default | Extra          |
+----------+--------------+------+-----+---------+----------------+
| user_id  | int(11)      | NO   | PRI | NULL    | auto_increment |
| password | varchar(128) | NO   |     | NULL    |                |
| email    | varchar(128) | NO   |     | NULL    |                |
+----------+--------------+------+-----+---------+----------------+ 
```

# web-services - 向 Web 服务代理添加属性

> ID：468665
> 
> 赞同：0
> 
> 时间：2009-01-22T10:52:58.613
> 
> 标签：web-services, oop

我有一个 vb.net 解决方案，其中包含对 Web 服务的 Web 引用。现在我需要设计器生成的代码中的另一个属性。这有一个缺点，一旦你更新了网络参考，你添加的代码就会被覆盖。

将属性添加到类的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T11:03:16.113

将类更新为部分类（可能已经来自代码生成），然后在您的解决方案中创建另一个不会被覆盖的代码文件。在那里创建一个与生成的代码同名（在同一命名空间中）的部分类，并将属性添加到此。这将具有在重新生成 Web 服务代码时不会被覆盖的好处。

当您调用生成的代码类时，您应该能够访问已添加到分部类的另一部分的属性。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-22T10:56:10.277

从您的 Web 服务代理派生一个子类，然后将您想要的所有属性添加到子类，然后更改您的代码以使用子类的实例而不是直接使用代理。

您的代理现在可以根据需要多次重新生成，但您的派生子类及其额外代码保持稳定。

# windows-mobile - 访问 WinMobile 手机中的 GPS 功能

> ID：468666
> 
> 赞同：4
> 
> 时间：2009-01-22T10:53:04.323
> 
> 标签：windows-mobile, gps

假设您有一部装有 GPS 接收器的 Windows Mobile 6.0 手机。WinMobile SDK 是否支持访问 GPS 功能？

如果没有，使用 GPS 编程的选项 (API) 是什么，即编写将使用 GPS 功能的应用程序。我主要对 Windows Mobile 6.x 感兴趣，但也请包含通用回复。

我一定会投票选出最有帮助的答案。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T11:08:28.240

两种选择：

1.  有中间 GPS 驱动程序，在 MSDN 上有[一篇关于 .Net的操作指南文章](http://msdn.microsoft.com/en-gb/library/bb158708.aspx)
2.  您可以连接到串行端口（当然可以在 UI 中配置）并自己解析 NMEA 字符串

选项（1）可能是可取的

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T11:22:46.760

**Chris Craft 在他的 .NET Windows Mobile 应用程序 30 天**系列中为这类事情提供了大量源代码

 ***   第 1 周 - 包括 GPS 指南针
*   第 3 周 - 包括 GPS 速度计和 GPS 高度计
*   第 4 周 - 包括 GPS 时钟

遗憾的是，这个博客系列似乎已经死了，但幸运的是代码保存在 Codeplex 上：

> [30 天的 Windows 移动应用程序](https://windowsmobileapps.codeplex.com/)

可以在[/dev/mobile上找到到 C 的端口以及围绕一些原始帖子的一些讨论](http://www.christec.co.nz/projects/30-days-of-windows-mobile)

[Raffaele Limosani](http://blogs.msdn.com/raffael/archive/2008/03/25/gps-programming-tips-for-windows-mobile-part-1.aspx)的博客上还有一些关于使用中级 GPS 驱动程序的说明

* * *

编辑添加：

GPS.NET 最近已经开源，现在可以在 CodePlex 上使用：

> [GPS.NET 3.0](http://gps3.codeplex.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T11:08:01.127

如果您计划在 .NET Compact Framework 中进行开发，Windows Mobile Developer Samples 中有一个相当广泛的 GPS 示例。这基本上利用了 gpsapi.dll 的环绕，但它显示了作品。我已经在 C:\Program Files\Windows Mobile 6 SDK 中安装了 WM6 套件，然后 GPS 示例位于 C:\Program Files\Windows Mobile 6 SDK\Samples\PocketPC\CS\GPS

祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T11:34:13.430

尝试查看[CodeProject.com](http://www.codeproject.com/info/search.aspx?artkw=GPS+windows+mobile)上的一些解决方案。有很多关于 Windows Mobile 和 GPS 的非常好的文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T11:34:15.597

对于使用中间驱动程序的测试代码（请参阅其他答案），不要忘记 SDK 中的 FakeGPS 实用程序，您可以使用该实用程序通过此中间驱动程序将存储在文件中的 NMEA 流传输到文件中，以便您可以轻松地测试 GPS 软件该位置数据实际上不必接收 GPS 并开始四处走动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-19T13:06:43.433

从我的角度来看，读取串行端口（在我的情况下为 COM5，波特率 4800）和解析接收到的数据要容易得多。（如何解析字符串可以通过谷歌和短语找到：gps NMEA句子）

对我来说是不可能理解地址上的例子：

```
C:\Program Files\Windows Mobile 6 SDK\Samples\PocketPC\CS\GPS 
```

这一切都是如此复杂和不直截了当。我希望界面更简单，更有用，例如：

```
myGps = new GPS()
myGPS.getPosition 
```

但这可能是不可能的:(

**以及如何通过 RS232 做到这一点？**（我在 VB.NET 中工作）

在 GUI 中（或以编程方式）创建对象 System.IO.Ports.SerialPort 并使用其事件 DataReceived。每当数据来自 GPS 时，就会发生此事件，并且您可以在其主体中对其进行处理。

数据采用 loooong 字符串的格式，分为 $GPGGA、$GPGSA 等部分。重要的是 $GPGGA。每个特定信息由逗号分隔。比你只解析这个字符串 - 在 VB.net 中使用：myArray = myData.Split(","c)。

[http://aprs.gids.nl/nmea/](http://aprs.gids.nl/nmea/)

PS：","c 表示逗号是字符，而不是字符串 (VB.NET)

如您所见，只需编写几行代码即可。MS的例子是不必要的困难，不适合初学者。

PS2：请注意，您不会向 GPS 发送任何命令。它会自动定期向您的程序发送数据。您只需打开端口，从缓冲区读取所有数据，使用 Chr() 将其转换为字符串并解析它。没什么大不了的。

# apache-flex - 将 Web 服务结果与 Flex 中的请求匹配

> ID：468669
> 
> 赞同：3
> 
> 时间：2009-01-22T10:53:45.117
> 
> 标签：apache-flex, web-services, actionscript, asynchronous

在我回答这个问题之前，有一点（！）一点背景知识：

我有一个装有网格数组的手风琴控件，每个网格都是延迟加载的东西数组。我正在使用自动生成的 Web 服务代理来检索这些列表。我希望用户能够更改手风琴中选定的子项，而无需等待 Web 服务响应。我最初对所有请求使用相同的代理实例，并按照发出的顺序跟踪请求，但这样做的问题是较短的数组从服务器返回的速度更快，因此发出请求的顺序变得无关紧要.

在处理代理结果事件时，我找不到一个明显的方法来确定原始请求，所以我最终得到的是一个函数，它处理手风琴上的更改事件，实例化一个新的 web 服务代理，将其推入哈希表中选定子项的索引，然后添加一个闭包作为事件处理程序。即有点像这样：

```
private proxyTable:Object = new Object();
private function PopulateThingGrid(index:Number):void
{
    var grid:ThingGrid = myAccordion.getChildAt(index) as ThingGrid;
    grid.things = ArrayCollection(proxyTable[index].getThings_lastResult);
}

private function SendThingRequest(index:int):void
{
    var grid:ThingGrid= myAccordion.getChildAt(index) as ThingGrid;
    if (grid.things.length == 0)
    {
        if (proxyTable[index] == null)
        {
            proxyTable[index] = new MyWebServiceProxy();
        }
        var proxy:MyWebServiceProxy= proxyTable[index];
        proxy.addgetThingsEventListener(function ():void { PopulateThingGrid(index); });

        var list:ThingList = thingLists.getItemAt(index) as ThingList;
        proxy.getThings("thinglist", list.ListID);
    }
}

private function myAccordion_Change(event:IndexChangedEvent):void
{
    SendThingRequest(event.newIndex);
}
```

（我试着匿名了一点，所以我可能错过了一些东西，但希望你明白）

那么，对于问题：有没有一种更简单的方法可以将代理结果与我刚刚丢失的原始请求相匹配？

如果不是，我所做的是否合理？我有点担心我最终可能生成然后正确处理它们的代理实例的数量（当有必要时） - 有没有我可能不知道的陷阱？

**更新：** 我认为可能会出现问题，因为生成的代理代码从 flash.events.Event 子类化 ResultEvents，而不是 mx.rpc.events.ResultEvent。我不完全确定它为什么这样做 - 访问 AsyncToken 的唯一方法是它最初由方法调用返回。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T15:26:00.170

不确定这是否有帮助，但我有类似的情况，我有一个 RemoteObject，我在其上调用 4 个 CRUD 方法，但只有一个 resultHandler。我使用`AsyncToken`.

我的 RemoteObject 调用如下所示：

```
public function list() {
    var token:AsyncToken = myService.list();
    token.operation = "list";
}

public function update() {
    var token:AsyncToken = myService.update(selectedItem);
    token.operation = "update";
}

public function create() {
    var token:AsyncToken = myService.create(selectedItem);
    token.operation = "create";
}

public function delete() {
    var token:AsyncToken = myService.delete(selectedItem);
    token.operation = "delete";
} 
```

然后，`resultHandler`看起来像这样：

```
public function resultHandler(event:ResultEvent):void {
    if( event.token.operation == "list" ) {
      // do something
    }   else if( event.token.operation == "update" ) {
    // do something
    }   
    // etc... 
```

`operation`是一个动态属性，不是 AsyncToken 的成员，所以你可以随意调用它。[这里](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=922&productId=2)有一篇 Cookbook 文章描述它：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T14:19:42.923

好的，我想我明白了：由于请求是在选择时发出的，并且您通过本地代理进行调用，并且响应随机返回，因此您无法分辨哪个响应映射到哪个 UI 元素。说得通。

唔。如果不知道您的代理对象是什么“事物”，这很难说，但假设它是适当映射到 UI 对象的具体事物——例如，ListOfWidgets 到 DataGrid——那么最好让每个网格映射无论如何，它自己的 ListOfWidgets 代理实例。在这种情况下，当您实例化代理时，您可以将其结果应填充的网格的索引传递给它（类似于您在上面所做的，但目的是将索引存储为代理对象上的公共成员，而不是在一个单独的对象中）。然后，由于每个代理的结果事件处理程序应该通过事件的目标属性为您提供对代理的访问，您可以检索代理的目标索引（例如，event.target.index）并填充适当的网格。

```
public class MyProxy
{
    public var targetIndex:uint;

    public function MyProxy()
    {
        // ...
    }
}

private function handleSelection():void
{
    var proxy:MyProxy = new MyProxy();
    proxy.addGetThingsEventListener(Event.YOUR_RESULT_EVENT, yourHandler); 
    proxy.targetIndex = 1;
}

private function yourHandler(event:Event):void
{
    fillGridWithResults(event.target.targetIndex);
} 
```

如果您使用数据绑定，编码模型会稍微简单一些，在这种情况下，您可以做更多类似的事情，前提是您的代理类或其结果集合被标记为可绑定：

```
<mx:DataGrid dataProvider="{proxy.results}" /> 
```

...并让事情“正常工作”（因为每个代理的实例都是唯一的）。这有意义吗？希望我已经正确理解了这个问题。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T14:31:20.153

恐怕我不完全理解您正在尝试做的所有事情，但如果我理解正确，您正在发出许多请求并异步返回多个响应，并且您正在尝试将响应与请求相匹配。

我过去曾为类似的问题这样做过，我在文本字段中调用 keyup 上的 web 服务来执行“键入时搜索”之类的功能，但这意味着我总是只关心响应最后一个请求。因此，我将服务更改为还采用时间戳参数（精确到毫秒）并将其与其余响应一起返回。然后我可以在响应中或在 flex 端查找最新的时间戳，跟踪最后一个请求的时间戳并查找该特定响应。

您也可以使用任何类型的 UUID 或任何独特的东西来执行此操作。在服务方面需要做更多的工作，但它可以很好地扩展并且易于理解。

您可能会看到的另一件事，我很抱歉自己没有对此进行更多研究，即在调试中查看生成的请求和响应对象。您可能会在可以查看以进行匹配的那些对象中找到一些辅助信息。但我担心这将在很大程度上取决于你如何打电话和收到回复。

HTH 并希望我已经很好地理解了这个问题。

# sql - SQL Server - “sys.functions”在哪里？

> ID：468672
> 
> 赞同：119
> 
> 时间：2009-01-22T10:56:08.700
> 
> 标签：sql, sql-server, sql-server-2005, stored-functions

SQL Server 2005`sys.XXX`对我经常使用的系统目录有很好的看法。

让我感到困惑的是：为什么有一个`sys.procedures`视图可以查看有关您的存储过程的信息，但没有`sys.functions`视图可以查看您的存储函数的信息？

没有人使用存储函数吗？我发现它们对于计算列等非常方便！

是否缺少特定原因`sys.functions`，或者只是一些被认为不够重要而无法放入`sys`目录视图的原因？它在 SQL Server 2008 中可用吗？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-01-22T11:35:51.397

我发现 UDF 非常方便，我一直都在使用它们。

我不确定微软在 SQL Server 2005（或 SQL Server 2008，据我所知）中不包含等效的 sys.functions 的理由是什么，但很容易推出自己的：

```
CREATE VIEW my_sys_functions_equivalent
AS
SELECT *
FROM sys.objects
WHERE type IN ('FN', 'IF', 'TF')  -- scalar, inline table-valued, table-valued 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-01-22T14:06:47.287

列出函数的另一种方法是使用 INFORMATION_SCHEMA 视图。

```
SELECT * FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_TYPE = 'FUNCTION' 
```

根据 Microsoft 网站，“信息架构视图提供了一个内部的、独立于系统表的 SQL Server 元数据视图。信息架构视图使应用程序能够正常工作，尽管对底层系统表进行了重大更改”。换句话说，底层系统表可能会随着 SQL 的升级而改变，但视图应该保持不变。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-03-01T18:37:38.563

这在 2008 R2 中有效，根据 SSMS 在您编写函数的 DROP 脚本时生成的内容：

```
SELECT  *
FROM    sys.objects
WHERE   type IN (N'FN', N'IF', N'TF', N'FS', N'FT') ;

/*
From http://msdn.microsoft.com/en-us/library/ms177596.aspx:
 FN SQL_SCALAR_FUNCTION
 FS Assembly (CLR) scalar-function
 FT Assembly (CLR) table-valued function
 IF SQL_INLINE_TABLE_VALUED_FUNCTION
 TF SQL_TABLE_VALUED_FUNCTION
*/ 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T11:35:41.087

它稍微有点冗长，但这应该做完全相同的事情：

```
select * from sys.objects where (type='TF' or type='FN') 
```

据我所知，它也不在 SQL Server 2008 中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-23T11:16:18.070

这并没有添加任何新内容，但我发现以下内容更容易记住：

```
select * from sys.objects where type_desc like '%fun%' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-01-27T10:02:11.050

试试这个 ：

```
SELECT * FROM sys.objects
where type_desc = 'SQL_SCALAR_FUNCTION' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-07T11:26:15.823

顺便说一句，您不想包括 type = 'FS' 吗？

```
name    type    type_desc
getNewsletterStats  FS  CLR_SCALAR_FUNCTION 
```

这就是 sys.objects 中的项目对应于我的 UDF 的内容，该 UDF 派生自外部 DLL

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-03-08T15:01:06.083

要扩展@LukeH 的答案，返回函数定义也需要连接到`sys.sql_modules`表。所以这个查询是：

```
SELECT O.name as 'Function name', M.definition as 'Definition', O.object_id
FROM sys.objects as O INNER JOIN sys.sql_modules as M
    ON O.object_id = M.object_id
WHERE type IN ('FN', 'IF', 'TF')  -- scalar, inline table-valued, table-valued 
```

其中，上面分别显示了函数名称、函数定义和对象标识符。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-03-27T18:14:52.293

有关标量函数的更完整描述，包括所有者和返回类型：

```
SELECT f.name, s.name AS owner, t.name as dataType, p.max_length, p.precision, p.scale, m.definition
FROM sys.objects f
JOIN sys.schemas s on s.schema_id = f.schema_id
JOIN sys.parameters p on p.object_id = f.object_id AND p.parameter_id = 0
JOIN sys.types t ON t.system_type_id = p.system_type_id 
JOIN sys.sql_modules as m ON m.object_id = f.object_id
WHERE type='FN'; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-03T00:06:08.567

`SQL 2000`具体的，对对象名称稍作调整：

```
SELECT *
FROM sysobjects
WHERE type IN ('FN', 'IF', 'TF') 
```

或者

```
SELECT *
FROM dbo.sysobjects
WHERE type IN ('FN', 'IF', 'TF') 
```

# sql - 在生产箱上部署 Sql Server Reporting Services 报告

> ID：468674
> 
> 赞同：7
> 
> 时间：2009-01-22T10:56:21.057
> 
> 标签：sql, sql-server, sql-server-2005, reporting-services

如何在生产箱上部署 Sql 服务器报告？在本地这不是问题，我只需指定 url 然后右键单击项目并说 deploy which deploy 在我的本地服务器上。

但生产服务器不会这样

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T11:11:00.963

我建议您创建可以在生产服务器上执行的 rs 脚本。看看 Reporting Services Scripter。它根据您当前的安装创建部署脚本。

[http://www.sqldbtips.com/showarticle.asp?ID=62](http://www.sqldbatips.com/showarticle.asp?ID=62)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T11:04:59.977

任何一个：

1.  通过 Web 界面上传 RDL 文件。
2.  从 SQL Management Studio 连接到 Reporting Services 并通过该接口上传 RDL。

# perl - 如何测试独立的 Perl 脚本？

> ID：468675
> 
> 赞同：24
> 
> 时间：2009-01-22T10:57:24.907
> 
> 标签：perl, unit-testing, scripting, module

我写了一个小的 Perl 脚本，现在我想为它创建一个测试套件。我认为能够将`use`脚本作为一个模块，导入脚本中定义的 subs 并测试它们会很好。有没有办法让脚本同时具有独立的 Perl 脚本和 Perl 模块？（我不想将脚本拆分为单独的模块和“可执行文件”，因为我打算将脚本作为单个文件分发。）

还是有更好的方法来测试脚本？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-22T12:32:16.807

由于 brian 现在似乎睡着了，这里有一个指向他所谓的[modulinos](http://www.drdobbs.com/web-development/184416165)的指针。这基本上是构建像模块一样运行的脚本或可以像脚本一样运行的模块的秘诀。听起来与您正在寻找的完全一样。

[Mastering Perl](http://shop.oreilly.com/product/9780596527242.do)绝对是一本值得阅读（和购买）的书。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-22T12:09:10.893

> （我不想将脚本拆分为单独的模块和“可执行文件”，因为我打算将脚本作为单个文件分发。）

大多数人在构建时像这样将文件拼接在一起。CPAN 上的 App::Ack 就是一个可以这样构建的例子。

如果你真的想正确地测试你的应用程序，你需要把功能放在一个模块中，然后编写一个基于 Test::More 的测试脚本来练习模块提供的功能。然后实际的脚本只是模块的一个薄包装，通常是这样的：

```
#!/usr/bin/env perl
use Your::Class;
Your::Class->new(args => \@ARGV)->run; 
```

另请参阅：[MooseX::Getopt](http://search.cpan.org/perldoc?MooseX::Getopt)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-14T11:21:06.353

我想做同样的事情。是否有理由不执行以下操作？（我不是 perl 专家，但该解决方案似乎对我来说很好用。）：

在脚本的开头，我要求切换（“-test”）或其他任何东西，然后分支到这样的子：

```
my $myargs = CmdLineOptions->new( args=>\@ARGV );
if ($myargs->was_given(option=>"-test"))    { &tests; }

sub tests   {
    require "Test/More.pm";
    Test::More->import('no_plan');

    is(1,1,"my tests go here");
    exit;
} 
```

（通过使用 require 和 import 我抑制了 '#No tests run!' 使用 'use Test::More' 而不进行任何测试时收到的消息。我想它也减少了开销。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T12:14:18.137

这取决于您是要测试脚本本身，还是要测试组成脚本的子程序。如果您想测试脚本，那么外部测试会更合适，例如 shell 脚本。如果您想测试组成脚本的函数，那么您可以将这些测试编写为脚本中的更多函数，或者将元素重构为 Perl 模块并测试模块（您说您不想这样做） .

如果脚本足够小，则可能不需要重构。只需添加一个“-test”命令行参数并调用一个测试子程序，它反过来测试其他所有内容。如果这样做，我喜欢打印出某种进度指示器（例如，每个通过的测试都有一个“.”）。

但是，如果脚本更复杂，您可能需要考虑将位重构为一个或多个模块并使用[Test::Simple](http://search.cpan.org/~mschwern/Test-Simple-0.86/lib/Test/Simple.pm)或[Test::More](http://search.cpan.org/~mschwern/Test-Simple-0.86/lib/Test/More.pm)测试它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T11:25:07.643

为什么不在 shell 脚本中编写一个测试套件，像任何其他 shell 命令一样调用 Perl 脚本？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-10T07:57:50.780

因为我只是想测试一个子，我使用了将那个子提取到一个带有 perl 单行器的模块中的 hacky 解决方案，这很容易理解并且不需要安装任何模块（我提取了带有子的段落名字当然很脆弱）。所以在我的 Makefile 我有：

```
MyModule.pm: my_script.pl
    perl -00 -lnE 'if(/^\s*sub my_sub \{/){say "package MyModule;";say;say "1;";}' my_script.pl >|MyModule.pm 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-10T02:06:48.900

在使一些 CGI 风格的 perl 脚本可远程测试（不通过 CGI 测试模块循环）时，我最终做了这样的事情：

bin/myscript.pl：

```
use …;

do {
  return 1 if $ENV{INCLUDED_AS_MODULE};

  … original script without the subs …
};

sub some_sub {
 …
}
sub …
sub … 
```

t/mytest.t：

```
use Test::More;
use FindBin qw/$Bin/;

BEGIN {
  $ENV{INCLUDED_AS_MODULE} = 1;
  my $filename = "$Bin/../bin/myscript.pl";
  do $filename or die "Unable to open '$filename': $! ($@)";
}

ok some_sub(), 'some sub returns true';
…
done_testing; 
```

这会将 subs 导入到测试的主命名空间中，并且可以轻松地进行测试。

**编辑**：在搜索了我一直在寻找的东西之后，我意识到`modulinos`基本上是我所做的，但避免通过 ENV 进行通信，将所有代码放在一个方法中并检查是否有调用者（）：

[https://www.perlmonks.org/bare/?node_id=537377](https://www.perlmonks.org/bare/?node_id=537377)（先前答案中的链接似乎不起作用）

# c# - 在 WindsorContainer 上调用 AddComponent 时为什么要使用 key 参数？

> ID：468681
> 
> 赞同：3
> 
> 时间：2009-01-22T10:59:28.490
> 
> 标签：c#, castle-windsor

IWindsorContainer 接口上的 AddComponent 方法有几个重载，例如：

```
WindsorContainer.AddComponent<I,T>() 
```

和

```
WindsorContainer.AddComponent<I,T>(string key) 
```

关键参数有什么用，为什么要使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T13:47:25.920

如果您注册了同一接口的多个实现，您将使用 key 参数。这样，您以后可以检索特定的。例如，我可能有多个版本的 IHandler。

```
container.AddComponent<IHandler, FileHandler>("handlers.file");
container.AddComponent<IHandler, HttpHandler>("handlers.http");
//I can retrieve the first one like this (or something like this).
IHandler fileHandler = container.Resolve<IHandler>();
//I can retrieve the http handler like this 
IHandler httpHandler = container.Resolve<IHandler>("handlers.http"); 
```

另外，当你注册一个没有键的组件时，我相信它的类型被用作键。

```
container.AddComponent<IHandler, FileHandler>(); 
```

我相信这是使用“{Namespace}.IHandler”键注册的。所以它实际上也可以在以后使用自动密钥检索。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T08:53:19.150

终于在文档的某个地方找到了它。

他们说[在这个页面的](http://www.castleproject.org/container/documentation/trunk/usersguide/usingmicrokernel.html)一半左右

> 请注意，可以为同一服务添加多个实现。在这种情况下，当您通过服务请求组件时，将返回为该服务注册的第一个组件。要获得同一服务的其他实现，您必须使用密钥。

# javascript - 在 Internet Explorer 中加载网页时出现“操作中止”错误消息

> ID：468691
> 
> 赞同：2
> 
> 时间：2009-01-22T11:04:14.113
> 
> 标签：javascript, html, internet-explorer

嗨朋友们，我为我的项目设计了一个页面。在那里我显示来自数据库的数据。

问题是它显示了数据，但随后会出现一个消息框，说明：

> Internet Explorer 无法打开 Internet 站点“ [http://localhost/](http://localhost/) ....”操作中止

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:07:10.893

当您使用 javascript 并且您尝试在元素完成加载之前对其进行修改时，IE 中经常会出现“操作中止”消息。

如果可能，请延迟运行脚本直到`onload`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T17:15:50.150

这是IE 6中的一个[已知错误。IE 中止操作可能有多种原因。](http://support.microsoft.com/kb/884022)

可能的原因可能是：

1.  浏览器中安装的第 3 方插件（通过转到 IE > 工具 > Internet 选项 > 高级选项卡 > 启用第 3 方浏览器扩展来禁用它）
2.  您甚至在创建 DOM 节点之前就对其进行了修改。尝试在 window.onDOMReady 事件之后修改 DOM 节点。
3.  正如[错误](http://support.microsoft.com/kb/884022)所说，您可能在 aspx 页面中使用 SmartNav 功能。（我不知道）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T16:17:27.413

导致此问题的最常见代码 ( [KB927917](http://support.microsoft.com/kb/927917) ) 是从不是 body 元素的直接子脚本的脚本附加到 body 元素。换句话说，从孙节点写入 body 元素会引发此错误。

## 没有错误

```
<body>
  <script type="text/javascript">
    document.body.appendChild(document.createElement('div'))
  </script>
</body> 
```

## 操作中止

```
<body>
  <div>
    <script type="text/javascript">
      document.body.appendChild(document.createElement('div'))
    </script>
  </div>
</body> 
```

## 解决方案

创建一个可以写入的元素是**关闭**的。

```
<body>
  <div><!-- add content to me instead of appending to the body --></div>
  <div>
    <script type="text/javascript">
      document.getElementsByTagName('div')[0].appendChild(document.createElement('div'))
    </script>
  </div>
</div> 
```

您也可以以编程方式创建该 div。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-21T08:42:43.343

您可以使用 IE 博客提供的脚本来调查问题。请参阅：http: [//blogs.msdn.com/ie/archive/2009/09/03/preventing-operation-aborted-scenarios.aspx](http://blogs.msdn.com/ie/archive/2009/09/03/preventing-operation-aborted-scenarios.aspx)

# java - Java 日期和日历控件

> ID：468696
> 
> 赞同：12
> 
> 时间：2009-01-22T11:06:27.027
> 
> 标签：java, swing, controls, components, javabeans

有没有人推荐在 Java Swing 应用程序中使用的好的日期选择器（下拉日历或小型日历组件）——bean 或源代码？它们需要足够强大以适应商业应用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T11:18:45.440

[JCalendar](http://toedter.com/jcalendar/)是免费的，并提供 bean 和源代码。它是非常可配置的，并且到目前为止在我的应用程序中都很好地达到了它的目的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T16:17:22.373

试试[摇摆实验室](http://swinglabs.org/index.jsp)。除了日期选择器之外，还有很多……享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T17:02:15.030

我同意 Dan Dimerman 的观点，可以推荐 swingX 库。我们`JXDatePicker`也在商业应用程序中使用。并且`JXMonthView`您可以编写自己的日期选择器变体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T01:20:01.733

你可以使用这个，只是根据你的需要改变主要的^^

```
 import java.awt.BorderLayout;
   import java.awt.Color;
   import java.awt.Dimension;
   import java.awt.GridLayout;
   import java.awt.event.ActionEvent;
   import java.awt.event.ActionListener;

   import javax.swing.JButton;
   import javax.swing.JDialog;
   import javax.swing.JFrame;
   import javax.swing.JLabel;
   import javax.swing.JPanel;
   import javax.swing.JTextField;

   public class DatePicker {
 int month = java.util.Calendar.getInstance().get(java.util.Calendar.MONTH);
 int year = java.util.Calendar.getInstance().get(java.util.Calendar.YEAR);;
 JLabel l = new JLabel("", JLabel.CENTER);
 String day = "";
 JDialog d;
 JButton[] button = new JButton[49];

 public DatePicker(JFrame parent) {
         d = new JDialog();
         d.setModal(true);
         String[] header = { "Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat" };
         JPanel p1 = new JPanel(new GridLayout(7, 7));
         p1.setPreferredSize(new Dimension(430, 120));

         for (int x = 0; x < button.length; x++) {
                 final int selection = x;
                 button[x] = new JButton();
                 button[x].setFocusPainted(false);
                 button[x].setBackground(Color.white);
                 if (x > 6)
                         button[x].addActionListener(new ActionListener() {
                                 public void actionPerformed(ActionEvent ae) {
                                         day = button[selection].getActionCommand();
                                         d.dispose();
                                 }
                         });
                 if (x < 7) {
                         button[x].setText(header[x]);
                         button[x].setForeground(Color.red);
                 }
                 p1.add(button[x]);
         }
         JPanel p2 = new JPanel(new GridLayout(1, 3));
         JButton previous = new JButton("<< Previous");
         previous.addActionListener(new ActionListener() {
                 public void actionPerformed(ActionEvent ae) {
                         month--;
                         displayDate();
                 }
         });
         p2.add(previous);
         p2.add(l);
         JButton next = new JButton("Next >>");
         next.addActionListener(new ActionListener() {
                 public void actionPerformed(ActionEvent ae) {
                         month++;
                         displayDate();
                 }
         });
         p2.add(next);
         d.add(p1, BorderLayout.CENTER);
         d.add(p2, BorderLayout.SOUTH);
         d.pack();
         d.setLocationRelativeTo(parent);
         displayDate();
         d.setVisible(true);
 }

 public void displayDate() {
         for (int x = 7; x < button.length; x++)
                 button[x].setText("");
         java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(
                         "MMMM yyyy");
         java.util.Calendar cal = java.util.Calendar.getInstance();
         cal.set(year, month, 1);
         int dayOfWeek = cal.get(java.util.Calendar.DAY_OF_WEEK);
         int daysInMonth = cal.getActualMaximum(java.util.Calendar.DAY_OF_MONTH);
         for (int x = 6 + dayOfWeek, day = 1; day <= daysInMonth; x++, day++)
                 button[x].setText("" + day);
         l.setText(sdf.format(cal.getTime()));
         d.setTitle("Date Picker");
 }

 public String setPickedDate() {
         if (day.equals(""))
                 return day;
         java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(
                         "dd-MM-yyyy");
         java.util.Calendar cal = java.util.Calendar.getInstance();
         cal.set(year, month, Integer.parseInt(day));
         return sdf.format(cal.getTime());
 }
}

  class Picker {
 public static void main(String[] args) {
         JLabel label = new JLabel("Selected Date:");
         final JTextField text = new JTextField(20);
         JButton b = new JButton("popup");
         JPanel p = new JPanel();
         p.add(label);
         p.add(text);
         p.add(b);
         final JFrame f = new JFrame();
         f.getContentPane().add(p);
         f.pack();
         f.setVisible(true);
         b.addActionListener(new ActionListener() {
                 public void actionPerformed(ActionEvent ae) {
                         text.setText(new DatePicker(f).setPickedDate());
                 }
         });
 }

  } 
```

# sql - 源代码管理和存储过程

> ID：468703
> 
> 赞同：5
> 
> 时间：2009-01-22T11:10:06.957
> 
> 标签：sql, sql-server, version-control, stored-procedures

我一直想知道如何将 SQL 2000 上的所有存储过程置于源代码控制之下。
我们对所有正常的源代码都使用 Subversion，所以如果有使用 Subversion 的问题的解决方案，那就太好了。

你有什么想法？

2009 年 2 月 16 日更新：这是我用来导出所有存储过程的 vbs 脚本：

```
Set con = CreateObject("ADODB.Connection")
con.ConnectionString = "*** Database connection string here ***"
con.Open 
Set rs = CreateObject("ADODB.RecordSet")
rs.ActiveConnection = con

strSQL = "SELECT ROUTINE_NAME, ROUTINE_DEFINITION " & _
"FROM INFORMATION_SCHEMA.routines " & _
"WHERE ROUTINE_NAME NOT LIKE 'dt_%' " & _
"ORDER BY 1"

Set fso = CreateObject("Scripting.FileSystemObject")
rs.Open strSQL 
While Not rs.Eof 
    filename = rs("ROUTINE_NAME") & ".sql"
    routineSQL = rs("ROUTINE_DEFINITION")
    Set tf = fso.CreateTextFile(filename, True)
    tf.Write routineSQL
    tf.Close
    set tf = Nothing 
    rs.MoveNext
Wend
Set fso = Nothing 
rs.Close 
Set rs = Nothing 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:15:09.473

通常您在源代码管理中跟踪对 SQL 脚本的更改。例如，您有一个签入数据库的基本模式。然后，您不断添加新的 SQL 文件以更改您的架构。这样，您就可以部署到精确的版本以进行测试。然后，您可以使用构建自动化来自动测试您的一些脚本，方法是针对包含实际数据的测试数据库执行它们。

有很多数据库差异工具可以帮助您找出版本之间的变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T11:29:50.037

将所有存储过程编写到一个文件夹中。每个存储过程一个文件。

然后只需将包含文件的文件夹置于源代码控制之下，就像您对其他源代码所做的那样。

如果有批处理文件或类似文件将这些存储过程附加在一起也很有帮助，这将是您的“将数据库升级到最新版本”脚本。

有一些方法可以在数据库本身中管理存储过程，但我发现这是最简单的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T11:53:12.627

正如其他人所说，从源代码控制下的单独文本文件中的每个存储过程开始。编写一个脚本，删除所有存储过程，然后从文本文件中重新创建它们（同时记录/报告任何错误）——这个脚本应该很容易运行。然后每次从源代码管理更新时重新运行脚本。对存储过程的所有编辑都应该对文本文件进行，而不是本地数据库上的“实时”副本，否则在进行更新时会丢失更改。

您很快就会想要以某种方式审核您的数据库架构并创建升级脚本等。

如果您只使用 SQL 服务器，请考虑使用Reg [-Gate 的](http://www.red-gate.com/)[SQL 比较](http://www.red-gate.com/products/SQL_Compare/index.htm)。我认为它会将文本文件中存储的过程（和其他 sql）与数据库中的内容进行比较并同步两者。因此，让您使用 SqlServer 中的编辑工具来编辑实时存储过程。

（截至 2009 年底，Red-Gate 即将[推出 Sql Compare for Oracle](http://www.red-gate.com/products/schema_compare_for_oracle/index.htm)）

我被告知 ApexSQL 的[Diff](http://www.apexsql.com/sql_tools_diff.asp)工具是另一种选择，而不是 Sql Compare，ApexSQL 的[Edit](http://www.apexsql.com/sql_tools_edit.asp)声称提供源代码控制集成。

在高端考虑 Visual Studio Team System Database Edition，但它的成本很高，那么您可能需要为来自第三方的 Oracle 支持支付更多费用。但是，如果您是 Microsoft 的合作伙伴（或可以成为其中之一），您可能会非常便宜地得到一些应对。

[另请参阅您是否对数据库进行源代码控制？](https://stackoverflow.com/questions/115369)在 StackOverflow 上获得关于更大问题的一组很好的答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T21:10:02.423

除了 Red Gate 的 SQL 比较之外，还可以考虑使用 ApexSQL 的[Diff](http://www.apexsql.com/sql_tools_diff.asp "差异")工具来检查数据库之间的结构差异。您可能还需要考虑集成源代码控制的管理工具。ApexSQL 的[Edit](http://www.apexsql.com/sql_tools_edit.asp "编辑")提供源代码控制集成。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-30T15:14:57.817

请在此处查看 Josef 的解决方案：[版本控制我的 SQL 服务器存储过程的最佳方法是什么？](https://stackoverflow.com/questions/146543/what-is-the-best-way-to-version-control-my-sql-server-stored-procedures)

他有一个用于自动创建脚本文件的工具，然后可以将其签入到 SVN（或任何其他存储库，实际上）。

# bash - maildir 标头问题

> ID：468704
> 
> 赞同：1
> 
> 时间：2009-01-22T11:10:08.830
> 
> 标签：bash, unix, email, sed, maildir

我有以下 bash 脚本来更新 maildir 文件的 mtimes：

```
#!/bin/bash

for i in /test/emailfile

do
    date=$(sed -n '/Received: from/ { :a; n; /;/ {s/.*; //p;q}; b a }' "$i")
    newdate=$(date -d "$date" +'%Y%m%d%H%M.%S')
    touch -t "$newdate" "$i"
done 
```

该脚本一直运行良好，具有如下标准标头：

```
Delivery-date: Sun, 22 Apr 2007 00:15:13 -0600
Received: from an-out-0708.google.com ([209.85.132.243])
    by x.xxxx.com with esmtp (Exim 4.63)
    (envelope-from <xxxxxx@gmail.com>)
    id 1HfVLs-0002Io-RQ
    for x@xxxxx.com; Sun, 22 Apr 2007 00:15:13 -0600 
```

交货日期为 2007 年。如果我触摸该文件以使文件日期从今天开始，然后运行我的脚本，则文件日期将恢复为接收日期。

但是，当尝试在具有以下标题的电子邮件上运行我的脚本时：

```
Delivery-date: Mon, 15 Dec 2008 17:26:37 -0800
Received: from xxxxxx ([130.194.13.165])
    by xxxxxxx with esmtp (Exim 4.69)
    (envelope-from <xxxxxi@xxxxx.xxx.xx>)
    id 1LCOhp-0006fm-2g
    for xxxxx@xxxxxx.com; Mon, 15 Dec 2008 17:26:37 -0800 
```

日期显然没有恢复。我看不出标题以任何方式明显不同。我需要重置 mtimes，因为许多邮件客户端使用文件时间显示为收到的时间。我的脚本已经处理了超过 3000 封电子邮件，确保所有客户端在移动服务器和所有具有相同日期的文件后以正确的顺序显示电子邮件，但由于某种原因，它不适用于特定的电子邮件。我是否在脚本中留下了一些明显的东西？

编辑：日期显然是从脚本中恢复的，但是无论脚本将日期设置为什么，依赖 mtimes 的客户端都不会显示此消息。权限相同，布局和文件名格式也相同。以下是来自 ls -la 的帖子

```
-rw-rw----   1 username username    11769 Dec 14 21:25 1229318728.H329820P11297.xxxxx.serverxxxxx.com:2,S
-rw-rw----   1 username username     3366 Dec 15 17:26 1229390797.H476913P25671.xxxxx.serverxxxxx.com:2,S
-rw-rw----   1 username username     1149 Dec 22 05:39 1229953142.H901034P11016.xxxxx.serverxxxxx.com:2,S
-rw-rw----   1 username username     7557 Dec 23 15:43 1230075791.H700954P8392.xxxxx.serverxxxxx.com:2,S 
```

无法正确显示的文件是倒数第二个。有什么方法可以调试为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T11:47:13.497

它似乎对我来说很好用，试试这个小曲子，看看你会得到什么。

```
#!/bin/bash
echo 'Delivery-date: Sun, 22 Apr 2007 00:15:13 -0600
Received: from an-out-0708.google.com ([209.85.132.243])
    by x.xxxx.com with esmtp (Exim 4.63)
    (envelope-from <xxxxxx@gmail.com>)
    id 1HfVLs-0002Io-RQ
    for x@xxxxx.com; Sun, 22 Apr 2007 00:15:13 -0600' | sed -n '/Received: from/ { :a; n; /;/ {s/.*; //p;q}; b a }'
date -d "Sun, 22 Apr 2007 00:15:13 -0600" +'%Y%m%d%H%M.%S'
echo 'Delivery-date: Mon, 15 Dec 2008 17:26:37 -0800
Received: from xxxxxx ([130.194.13.165])
    by xxxxxxx with esmtp (Exim 4.69)
    (envelope-from <xxxxxi@xxxxx.xxx.xx>)
    id 1LCOhp-0006fm-2g
    for xxxxx@xxxxxx.com; Mon, 15 Dec 2008 17:26:37 -0800' | sed -n '/Received: from/ { :a; n; /;/ {s/.*; //p;q}; b a }'
date -d "Mon, 15 Dec 2008 17:26:37 -0800" +'%Y%m%d%H%M.%S' 
```

我得到（如预期的那样）：

```
Sun, 22 Apr 2007 00:15:13 -0600
200704221415.13
Mon, 15 Dec 2008 17:26:37 -0800
200812161026.37 
```

所以我不确定为什么你的不起作用，尽管该脚本的输出应该是一个很好的起点。

您可以做的另一件事是临时修改您的脚本，如下所示：

```
: : : : :
echo touch -t "$newdate" "$i"
touch -t "$newdate" "$i"
: : : : : 
```

这将输出您正在尝试的实际命令。

还要检查目录和单个文件的文件权限。

“ls -l”（mtime）和“ls -lc”（ctime）在实际的可疑邮件文件中为您提供了什么？可能是您的脚本运行良好，但用户电子邮件客户端未使用 mtime/ctime。

编辑后：

引用“但是无论脚本将日期设置为什么，依赖 mtime 的客户端都不会显示此消息”，我的回答是客户端**不**依赖 mtime。

用Sherlock自己的话说，一旦你排除了所有其他可能性，剩下的无论多么不可能，都必须如此。我注意到一件事：您是否只是说消息根本没有显示（或者我认为我们正在谈论的日期错误）？

如果是后者，您需要查看邮件客户端以查看其实际获取日期的位置。只是出于兴趣，客户认为它是什么日期（它是否与标题中的任何日期匹配？

如果是前者，那是我们可以讨论的另一个问题。

我认为这是您需要从这里开始的（客户端），由于我的专业知识更多是脚本而不是电子邮件客户端，因此我可能无法提供进一步的帮助。不过，我很想看看结果如何，所以我会喜欢这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-24T19:34:17.660

以下脚本使用日期而不是邮件消息的接收日期属性。这将日期设置为与某些邮件应用程序使用的日期相匹配，并且还简化了 sed 语句。它还包括在遇到错误/无效日期时改进的错误处理。

```
#!/bin/bash
echo "Process folder : $@"
for i in $( ls -1 $@ )
do
#    date=$(sed -n '/Received: from/ { :a; n; /;/ {s/.*; //p;q}; b a }' "$i") 
#    date=$(sed -n -f ~/scripts/fix.sed "$i")
    date=$(sed  -n '/^Date: / {s/^Date: //p;q}' "$i")
    newdate=$(date -d "$date" +'%Y%m%d%H%M.%S')
    returnCode=$?
    if [ "$returnCode" != "0" ]
    then
      echo "Date Return Code : $returnCode"
      echo "Message file : $i received at : $date"
    fi
touch -c -t "$newdate" "$i"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T11:45:44.577

你确定 - 它对我有用。

我所做的唯一更改是：

```
#!/bin/bash

for i in "$@"

do
    date=$(sed -n '/Received: from/ { :a; n; /;/ {s/.*; //p;q}; b a }' "$i")
    newdate=$(date -d "$date" +'%Y%m%d%H%M.%S')
    touch -c -t "$newdate" "$i"
done 
```

`touch -c`这样文件就不会通过触摸创建。

`for i in "$@"`以便它在命令行参数而不是固定文件上运行。

```
$ touch data2 ; ls -l data2
-rw-r--r-- 1 leeder leeder 250 2009-01-22 11:43 data2
$ bash test.sh data data2 ; ls -l data2
-rw-r--r-- 1 leeder leeder 250 2008-12-16 01:26 data2 
```

# asp-classic - 等价于 asp 的 ob_get_contents

> ID：468710
> 
> 赞同：1
> 
> 时间：2009-01-22T11:11:05.333
> 
> 标签：asp-classic

在 asp 经典中的旧网站上工作。我想编写一个返回一些 html 的函数。现在，我只能将所有内容都写在一个字符串中。

缺点是：

*   我必须逃避引号
*   标签和属性上没有代码完成

在 php 中，我知道如何使用 ob_get_contents 获取输出缓冲区的内容。asp经典中是否有等效功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T11:25:32.183

在 ASP 中无法访问响应缓冲区的内容。

当生成 HTML 内容字符串的代码变得丑陋时，我倾向于使用 MSXML dom 文档作为创建内容的地方。然后返回 DOM 的 .XML 属性，虽然效率不高，但如果做得好，可读性会更高。

或者，如果您知道一旦返回的字符串唯一要做的就是将其写入响应，那么您可以直接在函数中执行此操作（如果您使用的是 VBScript，则可以使用 Sub）。

值得注意的是，您在 ASP 的 Sub 过程中执行此类操作：-

```
Sub WriteRow(first, second)
%>
    <tr>
      <td><%=Server.HTMLEncode(first)%></td>
      <td><%=Server.HTMLEncode(second)%></td>
    </tr>
<%
End Sub 
```

现在您可以循环调用 WriteRow。如果您有很多带有少量动态内容的样板 HTML，那么这可能是一种选择。

# c# - 我可以确定给定字符串的内置哈希总是相同的吗？

> ID：468713
> 
> 赞同：10
> 
> 时间：2009-01-22T11:11:40.400
> 
> 标签：c#, .net, string, hash

我得到一个这样的字符串哈希：

```
string content = "a very long string";
int contentHash = content.GetHashCode(); 
```

然后，我将散列存储到字典中，作为到另一个 ID 的键映射。这很有用，因此我不必在默认字典哈希计算期间比较[大字符串](http://dotnetperls.com/Content/Dictionary-String-Key.aspx)，但我可以通过键从字典中获取 ID。

我可以确定给定字符串（“很长的字符串”）的哈希值总是相同的吗？

我可以确定两个不同的字符串不会有相同的哈希吗？

另外，如果可能的话，为不同的字符串获得相同哈希的可能性有多大？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T11:17:32.353

是的，它将是一致的，因为字符串是不可变的。但是，我认为您在滥用字典。您应该让字典使用字符串作为键为您获取字符串的哈希值。哈希不保证是唯一的，因此您可以用另一个键覆盖一个键。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T11:45:44.530

只是为了添加一些关于更改哈希码的想法可能来自何处的细节。

正如其他答案正确地说，特定字符串的哈希码对于特定运行时版本将始终相同。出于性能原因，不能保证较新的运行时可能会使用不同的算法。

String 类覆盖对象中的默认 GetHashCode 实现。

.NET 中引用类型的默认实现是分配一个顺序 ID（由 .NET 内部保存）并将其分配给对象（对象堆存储具有用于存储此哈希码的插槽，它仅在第一次调用 GetHashCode 时分配对于那个对象）。

因此，创建一个类的实例，为其分配一些值，然后检索哈希码，然后使用相同的一组值执行完全相同的序列将产生不同的哈希码。这可能是一些人被引导相信哈希码可以改变的原因。事实上，尽管它是一个类的实例，一旦分配了一个哈希码，该哈希码就不会改变该实例。

**编辑**：我刚刚注意到没有一个答案直接引用你们每个问题（尽管我认为他们的答案很清楚），但只是为了整理一下：-

> 我可以确定给定字符串（“很长的字符串”）的哈希值总是相同的吗？

在您的使用中，是的。

> 我可以确定两个不同的字符串不会有相同的哈希吗？

不，两个不同的字符串可能具有相同的哈希值。

> 另外，如果可能的话，为不同的字符串获得相同哈希的可能性有多大？

概率非常低，产生的哈希在 4G 域中非常随机。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T11:14:06.387

是的，这就是哈希码的目的！不保证在不同版本的运行时之间是相同的。[有关MSDN](http://msdn.microsoft.com/en-us/library/system.string.gethashcode.aspx)的更多信息

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T11:28:51.037

正如其他人指出的那样，哈希值将随着时间的推移保持不变。但是为什么你要散列一个字符串然后把它作为字典的键？不保证哈希是唯一的。所以你的比较可能是不正确的。让字典完成它的工作。我认为最适合这种情况的集合是[**HashSet**](http://msdn.microsoft.com/en-us/library/bb359438.aspx)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-19T13:39:49.297

正如许多其他人所说，实现取决于框架的版本，但也取决于[架构](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=344006)。string.GetHashCode() 的实现在 x86 和 x64 版本的框架中是不同的，即使它们具有相同的版本号。

例如，如果您正在编写客户端/服务器或 .net 远程处理类型的架构，并希望使用字符串 HashCode 来停止下载大型资源，则只有在两者版本和位数相同时才能这样做。否则，您应该使用不同的哈希值——MD5、SHA 等将正常工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T11:15:44.653

[Object.GetHashCode](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)的文档状态

> 如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。

所以你可以保证哈希码对于给定的字符串是相同的。但是，您不能保证它是唯一的（可能有其他字符串具有相同的哈希码）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-03T03:09:48.667

您不必猜测运行时间或版本，只需使用我在业余时间制作的这个 CaseInsensitiveStringComparer 类（您可以将其传递给字典的构造函数，或者如果您使用的是 .NET 3.5，则为 HashSet）：

```
/// <summary>
/// StringComparer that is basically the same as StringComparer.OrdinalIgnoreCase, except that the hash code function is improved and guaranteed not to change.
/// </summary>
public class CaseInsensitiveStringComparer : StringComparer
{
    /// <summary>
    /// Compares two strings, ignoring case
    /// </summary>
    /// <param name="x">First string</param>
    /// <param name="y">Second string</param>
    /// <returns>Compare result</returns>
    public override int Compare(string x, string y)
    {
        return StringComparer.OrdinalIgnoreCase.Compare(x, y);
    }

    /// <summary>
    /// Checks if two strings are equal, ignoring case
    /// </summary>
    /// <param name="x">First string</param>
    /// <param name="y">Second string</param>
    /// <returns>True if strings are equal, false if not</returns>
    public override bool Equals(string x, string y)
    {
        return Compare(x, y) == 0;
    }

    /// <summary>
    /// Gets a hash code for a string, ignoring case
    /// </summary>
    /// <param name="obj">String to get hash code for</param>
    /// <returns>Hash code</returns>
    public override int GetHashCode(string obj)
    {
        if (obj == null)
        {
            return 0;
        }
        int hashCode = 5381;
        char c;
        for (int i = 0; i < obj.Length; i++)
        {
            c = obj[i];
            if (char.IsLower(c))
            {
                c = char.ToUpperInvariant(c);
            }
            hashCode = ((hashCode << 5) + hashCode) + c;
        }
        return hashCode;
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T11:13:13.050

字符串根据其内容进行散列，所以是的，如果您使用默认的 GetHashCode，该散列应该随着时间的推移保持不变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-22T11:20:34.737

正如已经提到的，您可以确定特定字符串的哈希值与基于内容的哈希值相同。但是，您不能确定对于更高版本的 .NET 框架，特定字符串是否会被散列相同，如此处[所述](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)

所以我想说，如果它在应用程序内部使用，这种方法很好。如果您将值保存到数据存储中，那么最好滚动您自己的函数以确保它在各个版本之间保持一致。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-22T12:41:52.870

> 我可以确定给定字符串（“很长的字符串”）的哈希值总是相同的吗？

是的

> 我可以确定两个不同的字符串不会有相同的哈希吗？

不

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-03T04:01:52.243

鉴于有无限数量的不同字符串，不可能为每个字符串分配不同的 int（32 位，最多可表示 40 亿）数字。

只需 8 个字符，就有 2^60 个不同的字符串。这无限大于 2^32。自然地，其中一些字符串的哈希码必须发生冲突。

具有相同哈希码的两个对象不必相等。要确定使用 equals 方法。这基本上是 hashmap 用来确定键是否相等的策略。

Map.get（字符串键）

*   计算key的hashcode
*   使用模来确定哪个桶键也属于。
*   遍历该存储桶中的所有条目，试图找到匹配的键。
*   当找到键匹配时，返回该条目的值。

作为旁注，随着地图获得越来越多的元素，它将重新创建更多桶并将所有旧条目放入新桶中。这有助于将存储桶条目列表从增长到非常长的列表。地图需要许多带有短列表的存储桶。

Object.hashcode 的 javadoc 使阅读变得有趣——我在下面粘贴了一个片段。

```
 The equals method implements an equivalence relation:

* It is reflexive: for any reference value x, x.equals(x) should return true.
* It is symmetric: for any reference values x and y, x.equals(y) should return true if and only if y.equals(x) returns true.
* It is transitive: for any reference values x, y, and z, if x.equals(y) returns true and y.equals(z) returns true, then x.equals(z) should return true.
* It is consistent: for any reference values x and y, multiple invocations of x.equals(y) consistently return true or consistently return false, provided no information used in equals comparisons on the object is modified.
* For any non-null reference value x, x.equals(null) should return false. 
```

Object 类的 equals 方法实现了对象上最有区别的可能等价关系；也就是说，对于任何引用值 x 和 y，当且仅当 x 和 y 引用同一个对象（x==y 的值为 true）时，此方法才返回 true。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-22T12:12:03.710

这是过早优化弊端的一个很好的例子。

您是否有分析器或基准测试的输出告诉您同一哈希桶中的条目之间的字符串比较实际上导致了性能问题？

没想到。只需将字符串本身用作字典中的键即可。这就是你应该如何使用它。

顺便说一句，不同的字符串比不同的 int 多得多，所以基本逻辑告诉你，每个不同的字符串不可能有不同的哈希码。

# c# - 将 OpenFolderDialog 设置为特殊文件夹

> ID：468721
> 
> 赞同：1
> 
> 时间：2009-01-22T11:14:11.083
> 
> 标签：c#, .net, file, directory

我知道可以将 OpenFolderDialog 的当前文件夹设置为特殊文件夹，如“程序文件”或桌面？

但是我在哪里可以找到这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T11:17:10.670

查看 System.Environment 类，例如：

```
string programFiles = System.Environment.GetFolderPath(
     System.Environment.SpecialFolder.ProgramFiles); 
```

更新：

我不确定这是否是问题的一部分，但要打开文件夹选择对话框，您可以使用以下代码：

```
using System.Windows.Forms;

//...

FolderBrowserDialog dialog = new FolderBrowserDialog();
dialog.SelectedPath = programFiles;
dialog.ShowDialog();

string selectedPath = dialog.SelectedPath; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T11:17:37.627

您是否尝试将文件夹设置为`System.Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles)`？这应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T11:30:36.430

您可以简单地将 的初始文件夹设置`OpenFolderDialog`为`System.Environment.GetFolderPath()`.

# .net - 为 Windows Mobile Phone 开发，无需合同

> ID：468722
> 
> 赞同：2
> 
> 时间：2009-01-22T11:15:09.443
> 
> 标签：.net, windows-mobile

问候！

无论如何，我的问题是，如果您想尝试为 Windows Mobile 设备进行开发，您将如何测试您的应用程序？我知道有一个模拟器，但不是很理想。

无论如何，在不支付愚蠢的天文成本的情况下，有没有得到一部开发电话？类似于 Google 对 android 所做的事情，我猜 Apple 对 iPod touch 所做的事情。理想情况下，随用随付，以便您可以测试连接功能。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T11:25:33.290

对于实验，模拟器很好，除非您必须与设备中的实际硬件进行交互。即使在那里，您也有来自 SDK 的蜂窝模拟器（用于呼叫管理、SMS 和数据连接，包括 GPRS 和 3G，可以从一个更改为另一个）和 FakeGPS（模拟 GPS 数据到中间驱动程序）。模拟器应该是一个很好的实验开始，真的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T11:49:52.383

您可以获得比 Android Dev 手机便宜得多的 WinMobile 手机免费 SIM 卡。

看看三星 I200 - WinMobile 6.1 Pro 和英国 160 英镑的免费 SIM 卡 - 价格是安卓开发手机的一半。

Sim 免费电话是理想的选择，您可以使用这些天所有网络赠送的免费 PAYG sim 卡。

编辑：即使 160 英镑也很多 - 以 100 英镑尝试[BenQ E72](http://www.expansys.com/d.aspx?i=171963&se=1435) (WinMobile 6) 或以 70 英镑尝试[三星 i300](http://www.expansys.com/d.aspx?i=124197) (WinMobile 2003 SE)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T11:24:54.120

我不知道有什么方法可以获得开发设备，如果有的话我会感到惊讶。请记住，微软不生产设备，他们只是授权操作系统。所以你需要从制造商那里得到一个设备，我认为他们不会有兴趣支持开发人员。

我也不知道呼叫、短信或数据服务有任何开发减少。该模拟器具有很好的 SMS 发送/接收功能。对于数据服务，您可以通过 ActiveSync 连接到您的 PC 并使用您的互联网连接。它与 GPRS 或 3G 网络不同，但您可以免费测试设备上的数据连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T12:04:20.980

Visual Studio Pro 拥有 Windows Mobile 开发所需的所有工具，我以前玩过它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T13:40:33.797

我建议在 eBay 或亚马逊上使用解锁手机。您可以从亚马逊以大约 60 美元的价格购买[AT&T 8525](https://rads.stackoverflow.com/amzn/click/com/B000NYNRA8)，这是我每天使用的设备。它相当有活力，并且与 Visual Studio 集成得很好。我已经为它编写了一些应用程序，以避免你的下一个问题：[OpenNetCF 的智能设备框架](http://www.opennetcf.com/Products/SmartDeviceFramework/tabid/65/Default.aspx)。真的。你所有的琐碎事情都可以正常工作，但是当你想做一些不平凡的事情时，你会感到痛苦，但很可能它已经在 OpenNetCF 的代码中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T23:22:55.767

与其他帖子所说的不同，您不需要为它开发 Windows 手机的“无 SIM 卡”版本。无 SIM 卡电话仅意味着该电话未锁定到移动运营商。

真正重要的是手机上启用的安全手机。所有智能手机（非触摸屏）设备都启用了受限安全模型。一些触摸屏设备启用了受限安全模型，这取决于移动运营商是否希望销售启用受限安全模型的设备。

“启用受限安全模型”是什么意思？

基本上这意味着未签名的代码不能在设备上运行。因此，您需要使用设备上受信任的证书对代码进行签名。大多数移动运营商都支持[Mobile 2 Market](http://msdn.microsoft.com/en-us/windowsmobile/bb250547.aspx)证书，一些运营商不喜欢[Orange](http://www.orange.com)。

“禁用受限安全模型”是什么意思？

这意味着未签名的代码通常在第一次运行或安装时被提示，然后如果用户这样说，则给予完全信任（特权）权限。这可以配置一些，但注册表设置。

您可以使用两种类型的证书进行签名：

非特权： - 可以访问除特权 API 之外的所有 API。此外，一些 DLL 和所有驱动程序都需要经过特权签名。

特权： - 可以访问所有 API。

获得特权签名有很多步骤，但可以做到。

这是关于 WM5 安全模型的[常见问题解答。](http://blogs.msdn.com/windowsmobile/archive/2005/12/17/security_model_faq.aspx)WM6、WM6.1也是一样。WM7 推出时，拥有全新的安全模型。

因此，对于在 WM 平台上进行开发的人来说，他们所需要的只是一个禁用了安全模型的设备。这允许您开发任何东西（包括特权 API 使用）。在销售 WM 应用程序时，请考虑使用 Mobile 2 Market 证书进行签名，在这种情况下，您可能会被出售给被锁定的设备。

# cocoa-touch - 我应该将@property 用于控制器类变量吗？

> ID：468730
> 
> 赞同：0
> 
> 时间：2009-01-22T11:18:08.173
> 
> 标签：cocoa-touch

问题是我应该为我的视图控制器使用属性吗？

考虑以下情况：

1.  我的父类中有一个视图控制器对象： MyViewController *myVC;

2.  我不会在父类的*dealloc*方法中释放这个视图控制器。

3.  我使用这样的视图控制器：

    ```
    // Allocate and Initialize view controller
    myVC = [[MyViewController alloc] initWithNibName:@"newView" bundle:nil];

    // Push View Controller
    [self.navigationController pushViewController:myVC animated:YES];

    // Release memory
    [myVC release];
    myVC = nil; 
    ```

这种方法有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T18:25:42.227

布拉德·拉尔森所说的。myVC 会泄漏，除非你在所属类的 dealloc 方法中释放它。将其设为属性不会影响此行为（itemEditVC 变量从何而来？）将其作为属性公开的唯一原因是外部类需要访问此变量，并且您希望确保正确的释放/保留语义此属性已修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T19:33:17.890

在您修改后的代码中，myVC 由导航控制器保留，并在它从堆栈中弹出时被释放（并解除分配）。如果这是您正在寻找的行为，那么是的，这段代码就可以了。

如果您需要 myVC 以供重用或稍后进行其他操作，则将发布移动到父类的 dealloc 方法并将分配删除为 nil。

# python - 模板中的模板。如何避免渲染两次？

> ID：468736
> 
> 赞同：1
> 
> 时间：2009-01-22T11:22:00.927
> 
> 标签：python, django, django-templates

我有一个 CMS，它采用一些动态内容并使用标准模板呈现它。但是我现在在动态内容本身中使用模板标签，所以我必须做一个 render_to_string，然后将其结果作为上下文变量传递给 render_to_response。这似乎很浪费。

有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T11:28:28.527

“这似乎很浪费” 为什么会这样？

每个模板都是标签和文本的混合体。在您的情况下，模板引擎已经访问了一些文本块。所以呢？一旦它被转换，它只是文本，并且非常非常快地通过下一个模板引擎。

你有具体的性能问题吗？您没有满足您的交易吞吐量要求吗？有没有具体问题？

代码是不是太复杂了？很难维护吗？会一直断吗？

我认为你的解决方案是足够的。从调试的角度来看，我不确定动态内容中的模板标签是否良好，但从基本的“模板渲染”角度来看，它很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T12:39:47.227

你在做什么听起来不错，但可能会问一个问题：为什么不将模板标签引用直接放在你的模板中，而不是手动渲染它们？

```
<div>
    {% if object matches some criteria %}
        {% render_type1_object object %}
    {% else %}
        {% render_type2_object object %}
    {% endif %
    ... etc ...
</div> 
```

或者，更好的是，有一个用于呈现对象（或对象列表）的中央模板标签，它封装了对象类型到模板标签的映射。然后，您的所有模板都只需引用一个模板标签，模板本身不需要类型知识。

关键是您正在迁移有关如何将单个对象渲染到视图之外的知识。

# optimization - Yslow 替代品 - 小型网站的优化

> ID：468739
> 
> 赞同：4
> 
> 时间：2009-01-22T11:22:47.150
> 
> 标签：optimization, caching, yslow

我正在开发一个基于 Intranet 的小型 Web 应用程序。我安装了 YSlow，它建议我做几件事，但它们似乎与我无关。例如，我不需要 CDN。我的应用程序很慢，所以我想减少请求的带宽。

1.  我应该遵守哪些 YSlow 规则？
2.  是否有适用于小型网站的替代工具？
3.  在推出我的申请之前，我应该申请什么清单？

我正在使用 ASP.net。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:32:43.883

Intranet 站点上的带宽根本不应该成为问题（除非您有 VPN 用户）。如果您不这样做并且它仍在爬行，则可能与后端有关，而不是与前端结构有关。

如果您正在尝试针对远程用户进行优化，一些相同的事情适用于尝试优化整个事情：

*   不要使用 30 个样式表 - 将它们合二为一
*   不要使用30个JS文件，将它们合二为一
*   考虑使用压缩器或 YUI 压缩器压缩 JS 和 CSS。
*   考虑使用精灵（具有多个版本的图像 - 例如按钮向上和按钮向下，一个在另一个之上）
*   显然，大量图像是禁忌
*   确保发送过期标头以确保 stylesheets/js/images/etc 都被缓存了一段合理的时间。
*   确保您的页面不是大得离谱。如果您处于受控环境中并且可以保证 JS 的可用性，您可能希望使用 AJAX 对数据进行分页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T11:36:53.673

开始，

1.  通过尽可能组合来限制对图像、脚本和其他资源发出的 HTTP 请求的数量。考虑缩小它们。我会推荐[Fiddler](http://www.fiddlertool.com/)来调试 HTTP

2.  注意 Viewstate 的大小，在可能的情况下设置 EnableViewState = false 例如，对于从不更改其项目列表的下拉列表控件，禁用 Viewstate 并填充 Page_Init 或覆盖 OnLoad。[真正了解 Viewstate](http://infinitiesloop.blogspot.com/2006/03/truly-understanding-viewstate.html)是关于该主题的必读文章

Oli 在写这篇文章时发布了一个答案，并且必须同意带宽考虑对于 Intranet 应用程序应该是次要的或第三的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-24T14:45:27.340

自从提出这个问题后，我就发现了[Page speed 。](http://code.google.com/speed/page-speed/)它不是真正适用于较小的站点，而是另一个很棒的防火虫插件。

**更新：**截至 2015 年 6 月，Firefox 和 Chrome 的*Page Speed*插件不再维护和可用，相反，Google 建议使用[网络](https://developers.google.com/speed/pagespeed/)版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T23:11:56.700

[Pingdom 工具](http://tools.pingdom.com)为任何可公开访问的网页提供快速测试。

# .net - 在 Mvc asp.net 中获取选中的复选框值

> ID：468742
> 
> 赞同：5
> 
> 时间：2009-01-22T11:24:09.877
> 
> 标签：.net, asp.net, asp.net-mvc

我在列表中显示了复选框，我想访问是否选中了哪个复选框，并想调用控制器操作，我从下拉列表中选择选项

```
<div id="pnlSent" style="display: none">
            <%= Html.DropDownList("select","msgtype") %>
            <% foreach (Usp_GetUserMessagesResult w in (List<Usp_GetUserMessagesResult>)ViewData["UListM"])
               { %>
                <li>
            <div class="question-info">

                <input id="Checkbox1" type="checkbox" onclick="function() { alert("df") ; } "  />

                <div class="views count"><span></span></div>
                <div class="question">
                    <div class="meta">Subject:  <%= w.Subject %></div>
                    <div class="meta">To: <%= w.Username  %></div>
                    <h3 class="title"><%= Html.Encode(w.Mesg)%></h3>
                </div>
            </div>
        </li>
            <% } %>

    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T15:28:14.533

在 asp.net-MVC 中，您应该以表单形式在控制器端访问您希望能够访问的信息，我注意到您没有在复选框中添加 ID，我的是动态绑定的，我正在使用asp.net-mvc 附带的 HTML 助手：

```
 <% using(Html.BeginForm("Retrieve", "Home")) %>//Retrieve is the name of the action while Home is the name of the controller
   <% { %>
        <%foreach (var app in newApps)              { %>  
      <tr> 
           <td><%=Html.CheckBox(""+app.ApplicationId )%></td>      

       </tr>  
    <%} %>
   <input type"submit"/>
 <% } %> 
```

然后在控制器上，您可以访问如下信息：

```
 public ActionResult Retrieve()
   {
    //since all variables are dynamically bound you must load your DB into strings in a for loop as so:
  List<app>=newApps;
  for(int i=0; i<app.Count;i++)
  {

    var checkbox=Request.Form[""+app[i].ApplicationId];
    // the reason you check for false because the Html checkbox helper does some kind of freaky thing for value true: it makes the string read "true, false"
      if(checkbox!="false")
      {
      //etc...almost same for other parameters you want that are in thr form
      }

   }
//of course return your view
return View("Index");//this vaires by the name of your view ex: if Index.aspx
  } 
```

该站点提供了有关在视图中处理控件时如何检查控制器信息的更多详细信息：http: [//quickstarts.asp.net/previews/mvc/mvc_HowToRenderFormUsingHtmlHelpers.htm](http://quickstarts.asp.net/previews/mvc/mvc_HowToRenderFormUsingHtmlHelpers.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T16:44:31.943

如果您打算提交此表单，并对服务器端的复选框值执行任何操作，您需要为它们提供**名称**和**值**属性（并且组中每个复选框的名称应该相同）。TStamper 提到的复选框助手会为您处理这些问题。

如果您只想在选中或取消选中复选框时发生客户端操作，您可以执行以下操作（我假设这些对象具有某种关键字段；我称之为**MessageID**）：

```
<script type="text/javascript">
function handleCheckbox( theBox ) {
  if( theBox.checked) {
    // do checked stuff
  }
  else {
    // do un-checked stuff
  }
}
</script>

...

<input type="checkbox" value="<%= w.MessageID %>" onclick="handleCheckbox(this)"  /> 
```

请注意，**id**值在 HTML 文档中必须是唯一的。因此，创建大量 ID 为“Checkbox1”的复选框并不是一个好主意。（如果该输入元素是 runat="server"，那么 .NET 将从WebForms **ID生成一个唯一的 HTML** **id**。

 *** * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-22T14:04:35.200

您可以遍历 div pnlsent 上的所有控件，如果控件类型是复选框，则可以确定是否选中了该复选框。

VB中循环控件的示例......

```
 For Each ctrl As Control In Page.Controls
        If TypeOf ctrl Is TextBox Then
            CType(ctrl, TextBox).BackColor = clr
        Else
            If ctrl.Controls.Count > 0 Then
                SetTextBoxBackColor(ctrl, clr)
            End If
        End If
    Next 
```

# .net - ASP.AJAX UpdatePanel - 可能与应用程序映射有关

> ID：468756
> 
> 赞同：0
> 
> 时间：2009-01-22T11:29:13.830
> 
> 标签：.net, asp.net, ajax, updatepanel

我正在尝试将 Axinom CMS 与 ASP Ajax 一起使用，并创建了一个包含 ScriptManager、UpdatePanel 和 Timer 的页面。

在 CMS 中发布页面时，实际页面创建在

> (1) [http://localhost/Site/publish/PageName.aspx](http://localhost/Site/publish/PageName.aspx)

但用户应该在下面访问它

> (2) [http://localhost/Site/PageName.AxCMS](http://localhost/Site/PageName.AxCMS)

它是通过 IIS 中的应用程序映射到 .AxCMS 扩展名建立的。

如果通过 (1) 访问页面一切正常，则使用 (2) 页面加载正确，并且当计时器第一次启动时页面看起来很好。然后在第二个计时器事件页面被重定向到 PageNotFound.aspx。

当使用 FireBug 进行调查时，第一个 POST 返回更新，但第二个 POST 返回 403 Forbidden。

有没有人知道如何进一步解决或解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T11:42:52.007

回调后，该过程似乎变得混乱。这可能归结为重写的网址。在 asp.net 中存在一个已知问题，即表单操作属性试图找到错误页面的 url 重写，请参见此处[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick- url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T15:36:15.657

.AxCMS ISAPI 扩展是否注册到 IIS 中？您是否有网络服务用户在 MS 和 LS 环境下发布和上传文件夹并具有修改权限？

# .net - 适合新手的 Quartz.net

> ID：468758
> 
> 赞同：5
> 
> 时间：2009-01-22T11:29:23.110
> 
> 标签：.net, asp.net, quartz.net

什么是quartz.net 如何开始使用它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T16:25:07.490

Suggest you start with the tutorial for Quartz.Net at [http://quartznet.sourceforge.net/tutorial/index.html](http://quartznet.sourceforge.net/tutorial/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-04T13:34:01.307

您可以查看文件夹 src\Quartz.Examples 中的示例。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-22T00:03:28.173

您需要首先想到几点，如果要使用内存中或存储在数据库中的 Quartz，它将启动服务器等。之后您必须创建一个类来管理您的 Schedule 和另一个包含您的 Job想跑，我说的是一个简单的例子。我将在以下场景中演示如何执行此操作：存储数据的 Sqlite、带有日志的 Job 类以及使用 Log 的所有其他内容。并将在每天上午 10:30 运行。

你的 web.config

```
<add key="quartz.scheduler.instanceName" value="ServerScheduler" />
<add key="quartz.threadPool.type" value="Quartz.Simpl.SimpleThreadPool, Quartz" />
<add key="quartz.threadPool.threadCount" value="10" />
<add key="quartz.threadPool.threadPriority" value="2" />

<add key="quartz.jobStore.type" value="Quartz.Impl.AdoJobStore.JobStoreTX, Quartz" />

<add key="quartz.jobStore.dataSource" value="default" />
<add key="quartz.dataSource.default.connectionString" value="Data Source=yourdb.db;Version=3;Foreign Keys=ON;" />
<add key="quartz.jobStore.tablePrefix" value="QRTZ_" />
<add key="quartz.jobStore.clustered" value="false" />
<add key="quartz.jobStore.lockHandler.type" value="Quartz.Impl.AdoJobStore.UpdateLockRowSemaphore, Quartz" />
<add key="quartz.jobStore.driverDelegateType" value="Quartz.Impl.AdoJobStore.StdAdoDelegate, Quartz" />
<add key="quartz.dataSource.default.provider" value="SQLite-1094" />
<add key="quartz.jobStore.useProperties" value="true" />
<add key="quartz.scheduler.exporter.type" value="Quartz.Simpl.RemotingSchedulerExporter, Quartz" />
<add key="quartz.scheduler.exporter.port" value="555" />
<add key="quartz.scheduler.exporter.bindName" value="QuartzScheduler" />
<add key="quartz.scheduler.exporter.channelType" value="tcp" /> 
```

创建一个名为 Schedule.cs 的类：

```
public static class Schedule
{

    private static readonly ILog logger = LogManager.GetLogger(typeof(Schedule));

    public static ITrigger BuildTrigger(int hour, int minute)
    {

        var trigger = TriggerBuilder.Create()
                                    .StartNow()
                                     .WithSchedule(CronScheduleBuilder.DailyAtHourAndMinute(hour,minute))
                                    .Build();
        return trigger;
    }

    public static IScheduler InicializarScheduler()
    {

        var scheduleMigracao = Schedule.GetScheduler();

        if (!scheduleMigracao.IsStarted)
            scheduleMigracao.Start();

        logger.Info("Scheduler started successfully");

        return scheduleMigracao;
    }

    public static IJobDetail BuildJogDetail<T>(string WorkFlowId, string Group) where T : IJob
    {
        return JobBuilder.Create<T>()
               .WithIdentity(WorkFlowId, Group)
               .RequestRecovery()
               .Build();
    }

    private static IScheduler GetScheduler()
    {
        try
        {

            IScheduler scheduler = SchedulerRepository.Instance.Lookup("DefaultQuartzScheduler");
            if (scheduler == null)
            {
                var factoryScheduler = new StdSchedulerFactory();

                return factoryScheduler.GetScheduler();
            }
            else
            {
                return scheduler;
            }
        }
        catch (Exception ex)
        {
            logger.Error("Server initialization failed:" + ex.Message, ex);
            throw;
        }
    }
} 
```

创建一个名为 TestJob.cs 的类

```
public class TestJob : IInterruptableJob
{
    private static readonly ILog Log = LogManager.GetLogger(typeof(TestJob));

    public void Interrupt()
    {

    }

    public void Execute(IJobExecutionContext context)
    {
        try
        {

            Log.DebugFormat("{0}****{0}Job {1} Start @ {2} next scheduled for {3}{0}***{0}",
                                                                    Environment.NewLine,
                                                                    context.JobDetail.Key,
                                                                    context.FireTimeUtc.Value.ToString("r"),
                                                                    context.NextFireTimeUtc.Value.ToString("r"));

           //implement your logic

            Log.DebugFormat("{0}****{0}Job {1} executed with sucess at  @ {2}",
                                                                    Environment.NewLine,
                                                                    context.JobDetail.Key,
                                                                    context.FireTimeUtc.Value.ToString("r"));

        }
        catch (Exception ex)
        {

            Log.DebugFormat("{0}***{0}Failed: {1}{0}***{0}", Environment.NewLine, ex.Message);
        }
    }
} 
```

在您的 Global.asax 位置：

```
 public class Global : System.Web.HttpApplication
{
    private static void BuildingQuartzMetadataSqLite1090()
    {
        var metaData = new DbMetadata();
        metaData.AssemblyName = "System.Data.SQLite, Version = 1.0.94.0,Culture=neutral, PublicKeyToken=db937bc2d44ff139";
        metaData.BindByName = true;
        metaData.CommandBuilderType = typeof(System.Data.SQLite.SQLiteCommandBuilder);
        metaData.CommandType = typeof(System.Data.SQLite.SQLiteCommand);
        metaData.ConnectionType = typeof(System.Data.SQLite.SQLiteConnection);
        metaData.ExceptionType = typeof(System.Data.SQLite.SQLiteException);
        metaData.ParameterDbType = typeof(System.Data.SQLite.TypeAffinity);
        metaData.ParameterDbTypePropertyName = "DbType";
        metaData.ParameterNamePrefix = "@";
        metaData.ParameterType = typeof(System.Data.SQLite.SQLiteParameter);
        metaData.UseParameterNamePrefixInParameterCollection = true;

        DbProvider.RegisterDbMetadata("SQLite-1094",metaData);
    }

    protected void Application_Start(object sender, EventArgs e)
    {
          BuildingQuartzMetadataSqLite1090();
           Schedule.InicializarScheduler();
           Schedule.ScheduleJob(Schedule.BuildJogDetail<TestJob>("TestJob","GrupoTest"), Schedule.BuildTrigger(10, 30));
    }
} 
```

任何问题只要问

# jdbc - 如何从 Jython 连接到数据库

> ID：468763
> 
> 赞同：2
> 
> 时间：2009-01-22T11:32:24.820
> 
> 标签：jdbc, jython

我无法从我的 Jython 程序连接到数据库。纯 Java 程序可以连接，我可以从 Jython 连接到 db，但只能使用 JDBC-ODBC 桥：“sun.jdbc.odbc.JdbcOdbcDriver”。如果我使用本机 JDBC 驱动程序，我的程序将因“找不到驱动程序”异常而失败。

代码：

```
import sys
from com.ziclix.python.sql import zxJDBC

connection1 = zxJDBC.connect('jdbc:odbc:test_odbc', 'postgres', 'postgres', 'sun.jdbc.odbc.JdbcOdbcDriver')
print "JDBC:ODBC connection set"
connection2 = zxJDBC.connect('jdbc:postgresql://127.0.0.1/test?stringtype=unspecified', 'postgres', 'postgres', 'org.postgresql.Driver')
print "JDBC native connection set" 
```

输出：

```
C:\tools\pyscripts\scripts\db_examples>jython --version
Jython 2.5b1 (trunk:5903:5905, Jan 9 2009, 16:01:29)
[Java HotSpot(TM) Client VM (Sun Microsystems Inc.)] on java1.6.0_11

C:\tools\pyscripts\scripts\db_examples>jython pg_test.py
JDBC:ODBC connection set
Traceback (most recent call last):
  File "pg_test.py", line 6, in <module>
    connection2 = zxJDBC.connect('jdbc:postgresql://127.0.0.1/test?stringtype=un
specified', 'postgres', 'postgres', 'org.postgresql.Driver')
zxJDBC.DatabaseError: driver [org.postgresql.Driver] not found 
```

我认为我的 CLASSPATH 设置正确，而本机 Java 程序可以使用本机驱动程序连接到该数据库。我发现所有 JDBC 驱动程序在 cachedir\packages 中都有 .pkc 文件。

我应该设置什么来获得数据库连接？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T08:54:51.643

我会回答自己：

Jython 2.5b1 中存在错误：[当安装在引导类路径上时，Jython 无法动态加载类](http://bugs.jython.org/issue1127)

如果我使用 --verify 标志调用它，我就能够运行我的程序。

错误在 Jython 2.5b3 中消失了

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-25T19:18:36.307

经过一天的努力，我终于找到了解决方案。不要为 zxJDBC、Class.forName、DriverManager 等烦恼——只需直接实例化驱动程序：

```
import os
import sys
from java.util import Properties

# add the jar to your classpath, then import it
sys.path.append('/tmp/postgresql-8.4-701.jdbc4.jar')
import org.postgresql.Driver as Driver

props = Properties()
props.put('user', 'u')
props.put('password', 'p')

conn = Driver().connect('jdbc:postgresql://127.0.0.1', props) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T22:07:59.113

我遇到了同样的问题，无法使用 --verify 标志（jython 抱怨未知开关）。一旦我将我的 OS X Leopard Java 配置为使用 1.6 虚拟机而不是 1.5，问题就神奇地消失了。

# sql - TOP 与 SET ROWCOUNT

> ID：468764
> 
> 赞同：13
> 
> 时间：2009-01-22T11:32:26.520
> 
> 标签：sql, performance

两者之间的性能是否存在差异，`TOP`或者`SET ROWCOUNT`它们是否只是以相同的方式执行？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-22T11:36:03.130

是的，在功能上它们是一样的。据我所知，两者之间没有显着的性能差异。

需要注意的一件事是，一旦您拥有`set rowcount`它，它将在连接的整个生命周期内持续存在，因此请确保`0`在完成后将其重置为。

* * *

### 编辑（发表马丁的评论）

的范围`SET ROWCOUNT`仅适用于当前程序。这包括当前过程调用的过程。它还包括通过`EXEC`或`SP_EXECUTESQL`因为它们被视为“子”范围而执行的动态 SQL。

请注意，`SET ROWCOUNT`它在一个`BEGIN/END`范围内，但它超出了范围。

```
create proc test1
as
begin
    begin
    set rowcount 100
    end
    exec ('select top 101 * from master..spt_values')
end
GO

exec test1
select top 102 * from master..spt_values 
```

结果 = 100 行，然后是 102 行

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-20T14:54:04.630

根据 BOL，关于性能的另一项说明：

> 作为 SELECT 语句的一部分，查询优化器可以在查询优化期间考虑 TOP 或 FETCH 子句中的表达式值。因为 SET ROWCOUNT 在执行查询的语句之外使用，所以在查询计划中不能考虑它的值。

[关于 BOL 的文章](http://technet.microsoft.com/en-us/library/ms189463.aspx)

这意味着这些实际上可能存在性能差异。

# c - 检测对打开文件的更改

> ID：468768
> 
> 赞同：8
> 
> 时间：2009-01-22T11:33:15.037
> 
> 标签：c, linux, file

假设我有一个打开的文件。如何检测文件何时被后台另一个程序更改。如果打开的文件被另一个进程更改，一些文本编辑器可以检测并更新它。

我特别要求在 Linux 下使用 C 进行此操作（这似乎取决于操作系统）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-22T12:07:01.210

如果您不想使用 轮询文件`stat`，并且不介意特定于 Linux，那么您可以使用 inotify API。您的内核需要是 2.6.13 或更新的版本以及 glibc 2.4 或更新的版本（如果您的目标是过去 2 或 3 年的任何东西，它们将是）。API 基本上为您提供了一个文件描述符，您可以`poll`或`select`, 并`read`获取有关已修改文件的信息。如果您的应用程序是交互式的，例如编辑器，那么它通常会有某种事件循环调用`select`or `poll`，并且可以观察您的 inotify 文件描述符中的事件。

通常最好使用 inotify `stat`，因为您会立即收到通知，并且不会在文件未更改时浪费时间和磁盘 I/O 轮询。缺点是它可能无法在 NFS 或其他网络文件系统上运行，而且它不可移植。

[IBM Developerworks 的这个页面](http://www.ibm.com/developerworks/linux/library/l-ubuntu-inotify/)提供了一些示例 C 代码，[手册页](http://linux.die.net/man/7/inotify)是权威参考。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T11:42:25.003

使用[统计](http://www.opengroup.org/onlinepubs/000095399/functions/stat.html)功能。页面中的示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T11:40:48.017

我在 Windows 和 Linux 上看到的文本编辑器也是这样做的：他们不检查文件是否真的发生了变化，他们只是查看文件的 stat mtime。

# c# - 每当满足某个基于时间的条件时，如何让 WinForms 程序做一些**特定的事情**？

> ID：468779
> 
> 赞同：0
> 
> 时间：2009-01-22T11:35:47.543
> 
> 标签：c#, .net

每当满足某个基于时间的条件时，如何让 WinForms 程序做一些**特定的事情？**

我在想我可以用两个线程做一些事情，一个线程运行正常程序，另一个线程只是循环检查基于时间的条件是否为真，当条件为真时，它会发出一个事件信号。

但是我不确定最好的方法。我将在程序的哪个位置调用这两个线程？也许我在想这一切都错了？

你会怎么做？

**更多信息：** 它要做的是检查 data.dat 文件并查看上次更新的时间。如果是一个月或更长时间，那就做**具体的事情**。这仍然可以用定时器来完成吗？

**注意：** 我认为注意 System.Timers 和 System.Windows.Forms.Timer 之间的区别可能很有用......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T11:38:53.793

我认为您应该使用设置为智能间隔的[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.80).aspx)来检查您的基于时间的条件是否得到满足。

这取决于您基于时间的条件是什么。这是一个特殊的时间或间隔，之后你想做一些特别的事情？如果是第二个，您可以只使用 Timer 并在触发 Timer.Elapsed 事件时执行您必须执行的操作。

* * *

编辑后编辑：如果您希望在每次文件更改时触发事件，请使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher(VS.80).aspx)

* * *

Edit2： [这是](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer(VS.80).aspx)System.Windows.Forms.Timer 和 System.Timers 之间的区别：

> Windows 窗体计时器组件是单线程的，精度限制为 55 毫秒。如果您需要更准确的多线程计时器，请使用 System.Timers 命名空间中的 Timer 类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T11:41:55.097

您可以将**System.Windows.Forms.Timer**控件添加到您的窗体（请参阅工具箱中的组件类别）。

然后将计时器的时间间隔设置为某个值（例如 1000）并为其 Tick 事件添加一个处理程序。然后将每 1000 毫秒调用一次此处理程序。

然后，您可以在处理程序中检查是否满足条件，如果满足，则开始您的特定操作。

* * *

更新（更新问题后）：

要检查文件的最后修改是否是一个多月前，您可以使用以下代码：

```
if (File.GetLastWriteTime("data.dat").AddMonths(1) < DateTime.Now)
{
    // do whatever has to be done
    // if it is a time-consuming task, start a new thread!
} 
```

您仍然可以将其放入计时器组件的 Tick 事件处理程序中。但在这种情况下，每秒触发一次计时器可能没有意义。

根据您的应用程序（例如，如果它会经常启动），另一种可能性是在您的应用程序启动期间执行上述检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T11:53:01.567

关于您的“更多信息”：它必须检查该特定文件的修改日期多少次？只有一次（例如在启动期间），还是应该在应用程序执行期间多次检查该文件的修改日期？

如果它必须只做一次，那么使用计时器是没有用的。如果必须多次执行，那么可以，您可以使用计时器。

Elapsed 事件的事件处理程序然后可以检查文件的 ModificationDate，并查看是否需要采取措施。

另一种可能更优雅的解决方案是使用 FileSystemWatcher。此 FileSystemWatcher 可以“监视”该特定文件。在 FileSystemWatcher 上指定一个过滤器，以便每次更改特定文件时都会引发一个事件。在 FileSystemWatcher 的事件处理程序中，您可以采取必要的措施：

```
FileSystemWatcher dataFileWatcher = new FileSystemWatcher();
dataFileWatcher.Path = "path to your file";
dataFileWatcher.Filter = "yourfilename";
dataFileWatcher.Changed += new FileSystemEventHandler(OnFileChanged);
dataFileWatcher.NotifyFilter = NotifyFilters.LastWrite;
dataFileWatcher.EnableRaisingEvents = true;

private void OnFileChanged( object sender, FileSystemEventArgs e )
{
   // take action.
} 
```

但是请注意，FileSystemWatcher 中有一个微妙的错误/功能，它会导致 Changed 事件多次引发，以对您正在观看的文件进行一次更改。

你可以像这样解决这个[问题](https://stackoverflow.com/questions/449993/vb-net-filesystemwatcher-multiple-change-events#450046)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T12:24:51.253

如果您知道文件更新之间的时间（一个月），另一种选择是在启动时检查一次。如果文件过期，您可以立即处理它。如果没有，您可以计算出在再次检查之前需要等待多长时间。然后，您可以使用等待计时器或答案中描述的其他方法来安排任务。

基本上，在启动时，您可以找出您必须等待多长时间的限制/最坏情况，然后您不需要在此期间进行任何额外的检查。这当然假设在程序运行期间不能将文件更改为旧版本，这似乎不太可能，但并非不可能！

# java - Java中有没有办法在不尝试创建文件的情况下确定路径是否有效？

> ID：468789
> 
> 赞同：86
> 
> 时间：2009-01-22T11:39:26.820
> 
> 标签：java, validation, filesystems

我需要确定用户提供的字符串是否是有效的文件路径（即，是否`createNewFile()`会成功或抛出异常），但我不想用无用的文件使文件系统膨胀，这些文件只是为了验证目的而创建的。

有没有办法在不尝试创建文件的情况下确定我拥有的字符串是否是有效的文件路径？

我知道“有效文件路径”的定义因操作系统而异，但我想知道是否有任何快速的方法来接受`C:/foo`或`/foo`拒绝`banana`.

一种可能的方法可能是尝试创建文件并在创建成功后最终将其删除，但我希望有一种更优雅的方式来实现相同的结果。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2016-02-17T09:31:09.973

Java 7 中引入的 Path 类添加了新的替代方案，如下所示：

```
/**
 * <pre>
 * Checks if a string is a valid path.
 * Null safe.
 *  
 * Calling examples:
 *    isValidPath("c:/test");      //returns true
 *    isValidPath("c:/te:t");      //returns false
 *    isValidPath("c:/te?t");      //returns false
 *    isValidPath("c/te*t");       //returns false
 *    isValidPath("good.txt");     //returns true
 *    isValidPath("not|good.txt"); //returns false
 *    isValidPath("not:good.txt"); //returns false
 * </pre>
 */
public static boolean isValidPath(String path) {
    try {
        Paths.get(path);
    } catch (InvalidPathException | NullPointerException ex) {
        return false;
    }
    return true;
} 
```

编辑：
注意 Ferrybig 的 [评论](https://stackoverflow.com/questions/468789/is-there-a-way-in-java-to-determine-if-a-path-is-valid-without-attempting-to-cre/35452697#comment98546017_35452697)：“Linux 上文件名中唯一不允许的字符是 NUL 字符，这在**Linux**下确实有效。”

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-22T11:41:55.240

这也将检查目录的存在。

```
File file = new File("c:\\cygwin\\cygwin.bat");
if (!file.isDirectory())
   file = file.getParentFile();
if (file.exists()){
    ...
} 
```

似乎 file.canWrite() 没有明确指示您是否有权写入目录。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-22T13:25:24.517

[**`File.getCanonicalPath()`**](http://java.sun.com/javase/6/docs/api/java/io/File.html#getCanonicalPath())为此目的非常有用。针对操作系统或文件系统解析时，某些类型的无效文件名（例如，Windows 中的 ,​​ ）会引发 IO 异常`CON`。但是，这仅作为初步检查；在实际创建文件时，您仍然需要处理其他故障（例如权限不足、驱动器空间不足、安全限制）。`PRN``*?*`

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-22T11:53:29.350

当您尝试创建文件时，可能会出现许多问题：

*   您缺乏必要的权限；
*   设备空间不足；
*   设备出现错误；
*   某些自定义安全策略禁止您创建特定类型的文件；
*   等等

更重要的是，这些可能会在您尝试查询是否可以和实际可以之间发生变化。在多线程环境中，这是竞争条件的主要原因之一，并且可能是某些程序的真正漏洞。

基本上你只需要尝试创建它，看看它是否有效。这是正确的方法。这就是为什么像这样的事情`ConcurrentHashMap`，`putIfAbsent()`所以检查和插入是一个原子操作并且不会受到竞争条件的影响。完全相同的原理在这里起作用。

如果这只是某些诊断或安装过程的一部分，请执行此操作并查看它是否有效。同样，不能保证它稍后会起作用。

基本上，您的程序必须足够健壮，才能在无法编写相关文件时优雅地死掉。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-14T18:07:00.533

```
boolean canWrite(File file) {
  if (file.exists()) {
    return file.canWrite();
  }
  else {
    try {
      file.createNewFile();
      file.delete();
      return true;
    }
    catch (Exception e) {
      return false;
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-15T18:59:15.997

**这是您可以跨操作系统执行的操作**

使用正则表达式匹配来检查现有的已知无效字符。

```
if (newName.matches(".*[/\n\r\t\0\f`?*\\<>|\":].*")) {
    System.out.println("Invalid!");
} else {
    System.out.println("Valid!");
} 
```

**优点**

*   这适用于操作系统
*   您可以通过编辑该正则表达式以任何方式自定义它。

**缺点**

*   这可能不是一个完整的列表，需要更多的研究来填写更多无效的模式或字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-01T15:30:39.630

# 就这样做（然后自己清理）

> 一种可能的方法可能是尝试创建文件并在创建成功后最终将其删除，但我希望有一种更优雅的方式来实现相同的结果。

也许这是最稳健的方式。

下面是`canCreateOrIsWritable`确定您的程序是否能够在给定路径创建文件*及其父目录*，或者，如果那里已经有文件，则写入它。

它通过实际创建必要的父目录以及路径中的空文件来实现。之后，它会删除它们（如果路径中存在文件，则保留它）。

以下是您可以如何使用它：

```
var myFile = new File("/home/me/maybe/write/here.log")

if (canCreateOrIsWritable(myFile)) {
    // We're good. Create the file or append to it
    createParents(myFile);
    appendOrCreate(myFile, "new content");
} else {
    // Let's pick another destination. Maybe the OS's temporary directory:
    var tempDir = System.getProperty("java.io.tmpdir");
    var alternative = Paths.get(tempDir, "second_choice.log");
    appendOrCreate(alternative, "new content in temporary directory");
} 
```

带有一些辅助方法的基本方法：

```
static boolean canCreateOrIsWritable(File file) {
    boolean canCreateOrIsWritable;

    // The non-existent ancestor directories of the file.
    // The file's parent directory is first
    List<File> parentDirsToCreate = getParentDirsToCreate(file);

    // Create the parent directories that don't exist, starting with the one
    // highest up in the file system hierarchy (closest to root, farthest
    // away from the file)
    reverse(parentDirsToCreate).forEach(File::mkdir);

    try {
        boolean wasCreated = file.createNewFile();
        if (wasCreated) {
            canCreateOrIsWritable = true;
            // Remove the file and its parent dirs that didn't exist before
            file.delete();
            parentDirsToCreate.forEach(File::delete);
        } else {
            // There was already a file at the path → Let's see if we can
            // write to it
            canCreateOrIsWritable = java.nio.file.Files.isWritable(file.toPath());
        }
    } catch (IOException e) {
        // File creation failed
        canCreateOrIsWritable = false;
    }
    return canCreateOrIsWritable;
}

static List<File> getParentDirsToCreate(File file) {
    var parentsToCreate = new ArrayList<File>();
    File parent = file.getParentFile();
    while (parent != null && !parent.exists()) {
        parentsToCreate.add(parent);

        parent = parent.getParentFile();
    }
    return parentsToCreate;
}

static <T> List<T> reverse(List<T> input) {
    var reversed = new ArrayList<T>();
    for (int i = input.size() - 1; i >= 0; i--) {
        reversed.add(input.get(i));
    }
    return reversed;
}

static void createParents(File file) {
    File parent = file.getParentFile();
    if (parent != null) {
        parent.mkdirs();
    }
} 
```

请记住，在调用`canCreateOrIsWritable`和创建实际文件之间，文件系统的内容和权限可能已经改变。

# c# - 有没有办法为整个应用程序设置文化？所有当前线程和新线程？

> ID：468791
> 
> 赞同：178
> 
> 时间：2009-01-22T11:39:58.410
> 
> 标签：c#, multithreading, cultureinfo

**有没有办法为整个应用程序设置文化？所有当前线程和新线程？**

我们将文化的名称存储在数据库中，当我们的应用程序启动时，我们执行

```
CultureInfo ci = new CultureInfo(theCultureString);
Thread.CurrentThread.CurrentCulture = ci;
Thread.CurrentThread.CurrentUICulture = ci; 
```

但是，当然，当我们想在新线程中做某事时，这会“丢失”。有没有办法为整个应用程序设置`CurrentCulture`它`CurrentUICulture`？所以新线程也得到了这种文化？还是每当创建一个我可以连接的新线程时都会触发一些事件？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2011-09-24T00:25:59.320

在 .NET 4.5 中，您可以使用该[`CultureInfo.DefaultThreadCurrentCulture`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.defaultthreadcurrentculture.aspx)属性来更改 AppDomain 的区域性。

对于 4.5 之前的版本，您必须使用反射来操纵 AppDomain 的文化。有一个私有静态字段`CultureInfo`（`m_userDefaultCulture`在 .NET 2.0 mscorlib 中，`s_userDefaultCulture`在 .NET 4.0 mscorlib 中）控制`CurrentCulture`如果线程没有在其自身上设置该属性时返回的内容。

这不会改变本机线程语言环境，并且以这种方式发布改变文化的代码可能不是一个好主意。不过，它可能对测试有用。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-22T11:43:01.913

这被问了很多。基本上，没有，不是 .NET 4.0。`ThreadPool`您必须在每个新线程（或函数）开始时手动执行此操作。您也许可以将区域性名称（或仅区域性对象）存储在静态字段中，以省去访问数据库的麻烦，仅此而已。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-11-08T01:01:37.507

如果您正在使用资源，您可以通过以下方式手动强制它：

```
Resource1.Culture = new System.Globalization.CultureInfo("fr"); 
```

在资源管理器中，有一个自动生成的代码如下：

```
/// <summary>
///   Overrides the current thread's CurrentUICulture property for all
///   resource lookups using this strongly typed resource class.
/// </summary>
[global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
internal static global::System.Globalization.CultureInfo Culture {
    get {
        return resourceCulture;
    }
    set {
        resourceCulture = value;
    }
} 
```

现在，每次您在此资源中引用您的单个字符串时，它都会使用指定的 resourceCulture 覆盖区域性（线程或进程）。

您可以将语言指定为“fr”、“de”等，也可以将语言代码放在 en-US 的 0x0409 或 it-IT 的 0x0410 中。有关语言代码的完整列表，请参阅：[语言标识符和语言环境](http://msdn.microsoft.com/en-us/library/aa912040.aspx)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-12-13T13:52:18.850

对于 .NET 4.5 及更高版本，您应该使用：

```
var culture = new CultureInfo("en-US");
CultureInfo.DefaultThreadCurrentCulture = culture;
CultureInfo.DefaultThreadCurrentUICulture = culture; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-17T05:19:42.603

实际上你*可以*设置默认的线程文化和 UI 文化，但仅限于 Framework 4.5+

我放入了这个静态构造函数

```
static MainWindow()
{
  CultureInfo culture = CultureInfo
    .CreateSpecificCulture(CultureInfo.CurrentCulture.Name);
  var dtf = culture.DateTimeFormat;
  dtf.ShortTimePattern = (string)Microsoft.Win32.Registry.GetValue(
    "HKEY_CURRENT_USER\\Control Panel\\International", "sShortTime", "hh:mm tt");
  CultureInfo.DefaultThreadCurrentUICulture = culture;
} 
```

并在 ValueConverter 的 Convert 方法中放置一个断点，以查看到达另一端的内容。CultureInfo.CurrentUICulture 不再是 en-US，而是变成了 en-AU，我的小技巧使它尊重 ShortTimePattern 的区域设置。

万岁，世界上一切都好！或不。传递给 Convert 方法的区域性参数*仍然*是en-US。呃，WTF？！但这是一个开始。至少这样

*   您可以在应用加载时修复一次 UI 文化
*   它总是可以从`CultureInfo.CurrentUICulture`
*   `string.Format("{0}", DateTime.Now)`将使用您自定义的区域设置

如果您不能使用 4.5 版框架，那么放弃将 CurrentUICulture 设置为 CultureInfo 的静态属性，并将其设置为您自己的类之一的静态属性。这不会修复 string.Format 的默认行为或使 StringFormat 在绑定中正常工作，然后遍历应用程序的逻辑树以重新创建应用程序中的所有绑定并设置其转换器文化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-01-20T09:44:50.787

`DefaultThreadCurrentCulture`并且`DefaultThreadCurrentUICulture`也存在于 Framework 4.0 中，但它们是私有的。使用反射，您可以轻松设置它们。这将影响所有`CurrentCulture`未明确设置的线程（也正在运行线程）。

```
Public Sub SetDefaultThreadCurrentCulture(paCulture As CultureInfo)
    Thread.CurrentThread.CurrentCulture.GetType().GetProperty("DefaultThreadCurrentCulture").SetValue(Thread.CurrentThread.CurrentCulture, paCulture, Nothing)
    Thread.CurrentThread.CurrentCulture.GetType().GetProperty("DefaultThreadCurrentUICulture").SetValue(Thread.CurrentThread.CurrentCulture, paCulture, Nothing)
End Sub 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-03-07T11:28:43.210

对于 ASP.NET5，即 ASPNETCORE，您可以在 中执行以下操作`configure`：

```
app.UseRequestLocalization(new RequestLocalizationOptions
{
    DefaultRequestCulture = new RequestCulture(new CultureInfo("en-gb")),
    SupportedCultures = new List<CultureInfo>
    {
        new CultureInfo("en-gb")
    },
            SupportedUICultures = new List<CultureInfo>
    {
        new CultureInfo("en-gb")
    }
}); 
```

以下是提供更多信息的一系列博客文章：

*   [ASP.NET 5 如何确定本地化的文化设置](https://www.jerriepelser.com/blog/how-aspnet5-determines-culture-info-for-localization/)
*   允许用户在 ASP.NET 5 中设置文化设置：
    *   [第1部分](https://www.jerriepelser.com/blog/allowing-user-to-set-culture-settings-aspnet5-part1/)
    *   [第2部分](https://www.jerriepelser.com/blog/allowing-user-to-set-culture-settings-aspnet5-part2/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-08-16T05:39:45.307

这个答案是@rastating 的好答案的一些扩展。您可以将以下代码用于所有版本的 .NET，而无需担心：

```
 public static void SetDefaultCulture(CultureInfo culture)
    {
        Type type = typeof (CultureInfo);
        try
        {
            // Class "ReflectionContext" exists from .NET 4.5 onwards.
            if (Type.GetType("System.Reflection.ReflectionContext", false) != null)
            {
                type.GetProperty("DefaultThreadCurrentCulture")
                    .SetValue(System.Threading.Thread.CurrentThread.CurrentCulture,
                        culture, null);

                type.GetProperty("DefaultThreadCurrentUICulture")
                    .SetValue(System.Threading.Thread.CurrentThread.CurrentCulture,
                        culture, null);
            }
            else //.NET 4 and lower
            {
                type.InvokeMember("s_userDefaultCulture",
                    BindingFlags.SetField | BindingFlags.NonPublic | BindingFlags.Static,
                    null,
                    culture,
                    new object[] {culture});

                type.InvokeMember("s_userDefaultUICulture",
                    BindingFlags.SetField | BindingFlags.NonPublic | BindingFlags.Static,
                    null,
                    culture,
                    new object[] {culture});

                type.InvokeMember("m_userDefaultCulture",
                    BindingFlags.SetField | BindingFlags.NonPublic | BindingFlags.Static,
                    null,
                    culture,
                    new object[] {culture});

                type.InvokeMember("m_userDefaultUICulture",
                    BindingFlags.SetField | BindingFlags.NonPublic | BindingFlags.Static,
                    null,
                    culture,
                    new object[] {culture});
            }
        }
        catch
        {
            // ignored
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-22T15:44:08.790

这是 c# MVC 的解决方案：

1.  首先：创建一个自定义属性和覆盖方法，如下所示：

    ```
    public class CultureAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            // Retreive culture from GET
            string currentCulture = filterContext.HttpContext.Request.QueryString["culture"];

            // Also, you can retreive culture from Cookie like this :
            //string currentCulture = filterContext.HttpContext.Request.Cookies["cookie"].Value;

            // Set culture
            Thread.CurrentThread.CurrentCulture = new CultureInfo(currentCulture);
            Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(currentCulture);
        }
    } 
    ```

2.  第二：在App_Start中，找到FilterConfig.cs，添加这个属性。（这适用于整个应用程序）

    ```
    public class FilterConfig
    {
        public static void RegisterGlobalFilters(GlobalFilterCollection filters)
        {
            // Add custom attribute here
            filters.Add(new CultureAttribute());
        }
    } 
    ```

就是这样 ！

如果你想为每个控制器/动作而不是整个应用程序定义文化，你可以像这样使用这个属性：

```
[Culture]
public class StudentsController : Controller
{
} 
```

或者：

```
[Culture]
public ActionResult Index()
{
    return View();
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-04-21T11:11:47.187

为所有线程和窗口设置 CultureInfo 的工作解决方案。

1.  打开**App.xaml**文件并添加一个新的“启动”属性来为应用分配启动事件处理程序：

```
<Application ........
             Startup="Application_Startup"
> 
```

2.  打开**App.xaml.cs**文件并将此代码添加到创建的启动处理程序（在本例中为 Application_Startup）。类 App 将如下所示：

```
 public partial class App : Application
    {
        private void Application_Startup(object sender, StartupEventArgs e)
        {
            CultureInfo cultureInfo = CultureInfo.GetCultureInfo("en-US");
            System.Globalization.CultureInfo.DefaultThreadCurrentCulture = cultureInfo;
            System.Globalization.CultureInfo.DefaultThreadCurrentUICulture = cultureInfo;
            Thread.CurrentThread.CurrentCulture = cultureInfo;
            Thread.CurrentThread.CurrentUICulture = cultureInfo;
        }
    } 
```

# c# - 使用 asp.net 在用户友好的 url 中转换 aspx 动态页面 url 的最佳方法

> ID：468793
> 
> 赞同：2
> 
> 时间：2009-01-22T11:40:20.657
> 
> 标签：c#, asp.net

使用 asp.net 2.0 在用户友好的 url 中转换 aspx 动态页面 url 的最佳方法是什么。

我想将**[http://www.mydomain.com/product.aspx?Id=4](http://www.mydomain.com/product.aspx?Id=4)**转换为 ** [http://www.mydomain.com/product4.aspx](http://www.mydomain.com/product4.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:44:46.013

通过使用url重写方法！[以下是 ScottGu 提供的一些](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)信息。

您需要以下内容：

*   无动作形式
*   用于 ASP.NET 的 URL 重写器模块

就是这样，您想找到一个简单的方法，您只需在 web.config 中添加 regexped-routes。如果要删除 .aspx，可以通过在 IIS 中进行更改来完成。ScottGu 的博客上也有一些关于此的信息！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:45:23.657

使用[ASP.NET MVC](http://www.asp.net/mvc/)怎么样？您应该能够很容易地将其映射到路线 - 无论是`"product{id}"`还是`"product/{id}"`. 我个人会放弃`.aspx`，但这取决于你。

# visual-studio - 链接列表 ADT 的编译和链接

> ID：468802
> 
> 赞同：1
> 
> 时间：2009-01-22T11:42:30.760
> 
> 标签：visual-studio, visual-c++, linker

在 Microsoft Visual C++ 中链接我的实现文件时遇到问题，并收到此错误：

正在编译...跳过...（未检测到相关更改） slList.cpp 链接...链接：致命错误 LNK1104：无法打开文件“.\Debug\slList.obj” 执行链接.exe 时出错。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T11:46:38.660

这通常意味着

1.  您要么正在使用该文件
2.  你无权访问它

有关该错误的更多信息[here](http://vcfaq.mvps.org/lang/10.htm)

尝试对解决方案进行清理，然后重建。如果那不起作用，只需删除调试/发布文件夹并编译。

另外，如果您愿意，可以在[这里](http://frw.se/List_CPP/)查看我的 Linked List 实现，不过它已经有几年历史了，是我大学的一门课程。

# apache - 重写无法捕获简单的错误

> ID：468814
> 
> 赞同：0
> 
> 时间：2009-01-22T11:45:53.797
> 
> 标签：apache, .htaccess, mod-rewrite

最近我添加了这个文件的尾部来优化 url，比如 site/5/john-doe[.php] 而不是 site/5/john-doe/[index.php]，但是，我更喜欢我的自定义错误文档，并且这些修改称为黑白“内部服务器错误”和“附加 404”错误页面。知道大多数站点将保持旧的、面向目录的格式，并且必须与新的面向文件的系统共存，这可能会有所帮助。感谢您的帮助。

```
<Files .htaccess>
order allow,deny
deny from all
</Files>

Options -Indexes

ErrorDocument 403 /errors/forbidden.php
ErrorDocument 404 /errors/notfound.php

#AddType 'text/html; charset=UTF-8' html php

# If you want Apache to use index.rhtml in addition to index.php etc.
DirectoryIndex index.rhtml index.php index.html index.htm

AddHandler rubypage .rhtml
Action rubypage /scripts/erb.cgi

RewriteEngine On

RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f

RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ $1.php [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T20:19:16.493

试试这个：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule !\.php$ %{REQUEST_URI}.php [L,QSA] 
```

# open-source - 有人对开源程序员做过调查吗？

> ID：468817
> 
> 赞同：-1
> 
> 时间：2009-01-22T11:46:23.187
> 
> 标签：open-source, survey

我试图通过搜索来研究这个，但一无所获。有没有人对开源程序员进行过调查以回答以下问题：

*   你这样做是你工作的一部分吗？
*   如果是这样，你的工作有多少？
*   如果你在业余时间做，你会花多少时间在上面？
*   你是学生吗？
*   是什么激励了你？

我很惊讶已经编写了多少行开源代码，我想知道这一切都是从哪里来的。

我不想自己做这样的调查，这只是好奇，而不是我需要找出的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:10:24.900

有数百个这样的研究可用。我至少每月从不同的公司/大学收到一次这样的问卷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T11:51:07.623

我会说，对于随机选择的人，1-4 的答案是“是”:)。

有关我建议阅读的动机的更多信息：

[大教堂和集市](http://www.amazon.co.uk/Cathedral-Bazaar-Eric-Raymond/dp/0596001088) 以及 [黑客和画家](http://www.amazon.co.uk/Hackers-Painters-Computer-Essays-Programming/dp/0596006624/ref=sr_1_1?ie=UTF8&s=books&qid=1232625045&sr=8-1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-29T12:46:46.663

2002 年有一个详细的研究：[自由/自由和开源软件：调查和研究](http://www.flossproject.org/report/)

第四部分涵盖了您提出的大部分问题：[第四部分：开发人员调查 (PDF)](http://www.flossproject.org/report/FLOSS_Final4.pdf)

# perl - 是否必须存在以包名称命名的文件夹才能创建包？

> ID：468818
> 
> 赞同：4
> 
> 时间：2009-01-22T11:46:27.977
> 
> 标签：perl, package

我们正在从 Perl 项目中提取通用代码。一个主程序应该分成几个可重用的模块。

我们的程序名称是`validate_results.pl`其中包含一组验证命令。我们计划将其拆分为小模块，`validate_results.pl`如下所示：

```
use Common::Validate_Results;
use Common::Validate_Results::CommonCommands;
use Common::Validate_Results::ReturnCodeValidation;
... 
```

根据我的理解，我应该创建一个 Common 文件夹，并且`Validate_Results.pm`应该在该文件夹下。再次在 下`Common`，`Validate_Results`应创建文件夹，在该`CommonCommands`文件`ReturnCodeValidation`夹下应存在文件夹。

是否必须存在所有这些文件夹，或者我们可以将所有 Perl 程序放在一个文件夹中并对它们进行逻辑分组，并且仍然使用上述方式访问模块（比如这样使用`common::validate_results`）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T12:18:40.593

文件系统层次结构是必需的。A::B::C 将始终位于 A/B/C.pm 中，在 @INC 中的某个位置。

如果您*必须*解决这个问题，请阅读[perldoc -f require](http://perldoc.perl.org/functions/require.html)，特别是在 @INC 中查找有关子例程引用的部分。是的，如果这是你真正想要的，你可以让模块加载器做一些奇怪的事情；但这不是你想要的，相信我。只要遵守约定，就像其他 99.9999999% 的 Perl 应用程序一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T12:27:24.570

如果你想“使用”你的模块，那么你必须符合结构。如果您想解决这个问题，您可以“要求”您的模块，将文件名传递给要求。

不过，你真的不应该这样做。如果您真的不想拥有目录结构，请将其从模块名称中删除（尽管如果您的模块名称与 CPAN 中更通用的名称冲突，这可能会导致将来出现问题）。只需通过 Find::Bin 将脚本目录添加到 INC 路径并直接使用模块：

```
use FindBin;
use lib $FindBin::Bin;

use ValidateResults;
use CommonCommands;
use ReturnCodeValidation; 
```

高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T14:27:12.283

这是一个模块的示例，它是同一文件中的子模块：

```
package Foo;
use strict;
use Exporter 'import';

our @EXPORT = ( 'from_foo' );

sub from_foo { print "from_foo\n"; }

package Foo::Bar;
use strict;
use Exporter 'import';

our @EXPORT = ( 'from_foo_bar' );

sub from_foo_bar { print "from_foo_bar\n"; }

1; 
```

在您的程序中，如果您使用模块*Foo*（带有 .pm 文件的模块）：

```
use Foo; 
```

您将可以访问*Foo::Bar*函数，但只能作为规范名称 (Foo::Bar::from_foo_bar)。您可以像这样导入它们：

```
use Foo;
Foo::Bar->import; 
```

请注意，您不能这样做：

```
use Foo::Bar; 
```

因为没有文件*Foo/Bar.pm*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T03:55:42.937

“使用”命令中的包名实际上只是一个以 .pm 文件结尾的路径，因此您不需要包含每个包名的文件夹。在您的示例中，您需要文件夹：

```
Common
Common/Validate_Results 
```

但是您不需要文件夹：

```
Common/Validate_Results/CommonCommands
Common/Validate_Results/ReturnCodeValidation 
```

.pm 文件中的实际包名称不必与加载它的“使用”命令中的名称相同。但是保持路径与包名一致总是一个好主意。

# c# - 绑定重定向

> ID：468825
> 
> 赞同：2
> 
> 时间：2009-01-22T11:49:26.877
> 
> 标签：c#, binding, redirect

哪里是查找绑定重定向信息的最佳位置？或者只是对您在项目中放置这些重定向的位置的基本解释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:51:06.373

为什么不从头[开始](http://msdn.microsoft.com/en-us/library/2fc472t2(VS.80).aspx)呢？

在理解了它的作用之后，你最终会得到类似的东西：

```
<configuration>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <dependentAssembly>
            <assemblyIdentity name="myAssembly"
                              publicKeyToken="32ab4ba45e0a69a1"
                              culture="neutral" />
            <bindingRedirect oldVersion="1.0.0.0"
                             newVersion="2.0.0.0"/>
         </dependentAssembly>
      </assemblyBinding>
   </runtime>
</configuration> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T11:51:24.737

你放的地方只能是配置。[在此处](http://msdn.microsoft.com/en-us/library/2fc472t2(vs.71).aspx)查找详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-26T20:54:27.883

有几个[配置文件](http://msdn.microsoft.com/en-us/library/8f6988ab.aspx)可以包含绑定重定向。除了配置文件之外的另一个选项是使用[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件在运行时决定重定向。我在[这个答案](https://stackoverflow.com/questions/1460271/how-to-use-assembly-binding-redirection-to-ignore-revision-and-build-numbers/2344624#2344624)中包含了一些示例代码。

# user-interface - 用户界面：零行的“第 1 页，共 0 页”或“第 1 页，共 1 页”或“第 0 页，共 0 页”？

> ID：468827
> 
> 赞同：0
> 
> 时间：2009-01-22T11:49:47.157
> 
> 标签：user-interface

在一个空的数据集中，将分页信息放在屏幕中更正确的是什么？

*   第 1 页，共 0 页
*   第 1 页，共 1 页
*   第 0 页，共 0 页

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-22T11:51:18.947

“第 1 页，共 1 页”

您仍在打印页面，即使它是说“没有可用于您的查询的数据”。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-22T11:52:48.557

**“未找到结果”**并且根本不显示格式错误的数据集将是我选择的 UE 方法，95% 的时间。

0 of 0 如果你必须的话，其他任何东西都意味着存在一些数据。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-22T11:52:38.587

或者，如果没有数据集，您只是不打印分页。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T11:52:22.177

如果页面存在，它必须是第 1 页，共 1 页。IMO 不应该有空数据集的任何页面。

# .net - 为什么 .NET 中的多维数组比普通数组慢？

> ID：468832
> 
> 赞同：56
> 
> 时间：2009-01-22T11:50:26.470
> 
> 标签：.net, performance, arrays

**编辑：**我向大家道歉。当我实际上想说“多维数组”时，我使用了“锯齿状数组”一词（如下面的示例所示）。对于使用错误的名称，我深表歉意。我实际上发现锯齿状数组比多维数组更快！我已经为锯齿状阵列添加了我的测量值。

我试图使用~~锯齿状的~~今天多维数组，当我注意到它的性能并不像我预期的那样。使用一维数组并手动计算索引比使用二维数组快得多（几乎是两倍）。我使用数组（初始化为随机值）编写了一个测试 `1024*1024`，进行了 1000 次迭代，我在我的机器上得到了以下结果：

```
sum(double[], int): 2738 ms (100%)
sum(double[,]):     5019 ms (183%)
sum(double[][]):    2540 ms ( 93%) 
```

这是我的测试代码：

```
public static double sum(double[] d, int l1) {
    // assuming the array is rectangular
    double sum = 0;
    int l2 = d.Length / l1;
    for (int i = 0; i < l1; ++i)
        for (int j = 0; j < l2; ++j)
            sum += d[i * l2 + j];
    return sum;
}

public static double sum(double[,] d) {
    double sum = 0;
    int l1 = d.GetLength(0);
    int l2 = d.GetLength(1);
    for (int i = 0; i < l1; ++i)
        for (int j = 0; j < l2; ++j)
            sum += d[i, j];
    return sum;
}

public static double sum(double[][] d) {
    double sum = 0;
    for (int i = 0; i < d.Length; ++i)
        for (int j = 0; j < d[i].Length; ++j)
            sum += d[i][j];
    return sum;
}

public static void Main() {
    Random random = new Random();
    const int l1  = 1024, l2 = 1024;
    double[ ] d1  = new double[l1 * l2];
    double[,] d2  = new double[l1 , l2];
    double[][] d3 = new double[l1][];

    for (int i = 0; i < l1; ++i) {
        d3[i] = new double[l2];
        for (int j = 0; j < l2; ++j)
            d3[i][j] = d2[i, j] = d1[i * l2 + j] = random.NextDouble();
    }
    //
    const int iterations = 1000;
    TestTime(sum, d1, l1, iterations);
    TestTime(sum, d2, iterations);
    TestTime(sum, d3, iterations);
} 
```

进一步研究表明，第二种方法的 IL 比第一种方法大 23%。（代码大小 68 与 52。）这主要是由于调用`System.Array::GetLength(int)`. 编译器还会发出`Array::Get`对~~锯齿状的~~多维数组，而它只是调用`ldelem`简单数组。

所以我想知道，为什么通过多维数组访问比普通数组慢？我会假设编译器（或 JIT）会做一些类似于我在第一个方法中所做的事情，但事实并非如此。

你能帮我理解为什么会这样吗？

* * *

**更新：**按照 Henk Holterman 的建议，这里是`TestTime`：

```
public static void TestTime<T, TR>(Func<T, TR> action, T obj,
                                   int iterations)
{
    Stopwatch stopwatch = Stopwatch.StartNew();
    for (int i = 0; i < iterations; ++i)
        action(obj);
    Console.WriteLine(action.Method.Name + " took " + stopwatch.Elapsed);
}

public static void TestTime<T1, T2, TR>(Func<T1, T2, TR> action, T1 obj1,
                                        T2 obj2, int iterations)
{
    Stopwatch stopwatch = Stopwatch.StartNew();
    for (int i = 0; i < iterations; ++i)
        action(obj1, obj2);
    Console.WriteLine(action.Method.Name + " took " + stopwatch.Elapsed);
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-22T12:04:18.220

`vector`下限为 0 的一维数组与 IL（与`array`IIRC）中的多维或非 0 下限数组不同。`vector`使用起来更简单 - 要到达元素 x，您只需`pointer + size * x`. 对于 a `array`，您必须`pointer + size * (x-lower bound)`对一维数组执行操作，并且为添加的每个维度执行更多算术运算。

基本上，CLR 针对更常见的情况进行了优化。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-22T11:57:06.020

数组边界检查？

一维数组有一个可以直接访问的长度成员——编译时这只是一个内存读取。

多维数组需要一个 GetLength(int dimension) 方法调用来处理参数以获取该维度的相关长度。这不会编译为内存读取，因此您会获得方法调用等。

此外，GetLength(int dimension) 将对参数进行边界检查。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-29T00:02:00.550

有趣的是，我在 Vista 机器上使用 VS2008 NET3.5SP1 Win32 从上面运行了以下代码，在发布/优化中几乎无法测量差异，而调试/noopt 多暗阵列要慢得多。（我两次运行这三个测试以减少对第二组的 JIT 影响。）

```
 Here are my numbers: 
    sum took 00:00:04.3356535
    sum took 00:00:04.1957663
    sum took 00:00:04.5523050
    sum took 00:00:04.0183060
    sum took 00:00:04.1785843 
    sum took 00:00:04.4933085 
```

看第二组三个数字。差异不足以让我将所有内容编码在一维数组中。

虽然我没有发布它们，但在调试/未优化中，多维与单/锯齿状确实有很大的不同。

完整程序：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace single_dimension_vs_multidimension
{
    class Program
    {

        public static double sum(double[] d, int l1) {    // assuming the array is rectangular 
            double sum = 0; 
            int l2 = d.Length / l1; 
            for (int i = 0; i < l1; ++i)   
                for (int j = 0; j < l2; ++j)   
                    sum += d[i * l2 + j];   
            return sum;
        }

        public static double sum(double[,] d)
        {
            double sum = 0;  
            int l1 = d.GetLength(0);
            int l2 = d.GetLength(1);   
            for (int i = 0; i < l1; ++i)    
                for (int j = 0; j < l2; ++j)   
                    sum += d[i, j]; 
            return sum;
        }
        public static double sum(double[][] d)
        {
            double sum = 0;   
            for (int i = 0; i < d.Length; ++i) 
                for (int j = 0; j < d[i].Length; ++j) 
                    sum += d[i][j];
            return sum;
        }
        public static void TestTime<T, TR>(Func<T, TR> action, T obj, int iterations) 
        { 
            Stopwatch stopwatch = Stopwatch.StartNew();
            for (int i = 0; i < iterations; ++i)      
                action(obj);
            Console.WriteLine(action.Method.Name + " took " + stopwatch.Elapsed);
        }
        public static void TestTime<T1, T2, TR>(Func<T1, T2, TR> action, T1 obj1, T2 obj2, int iterations)
        {
            Stopwatch stopwatch = Stopwatch.StartNew(); 
            for (int i = 0; i < iterations; ++i)    
                action(obj1, obj2); 
            Console.WriteLine(action.Method.Name + " took " + stopwatch.Elapsed);
        }
        public static void Main() {   
            Random random = new Random(); 
            const int l1  = 1024, l2 = 1024; 
            double[ ] d1  = new double[l1 * l2]; 
            double[,] d2  = new double[l1 , l2];  
            double[][] d3 = new double[l1][];   
            for (int i = 0; i < l1; ++i)
            {
                d3[i] = new double[l2];   
                for (int j = 0; j < l2; ++j)  
                    d3[i][j] = d2[i, j] = d1[i * l2 + j] = random.NextDouble();
            }    
            const int iterations = 1000;
            TestTime<double[], int, double>(sum, d1, l1, iterations);
            TestTime<double[,], double>(sum, d2, iterations);

            TestTime<double[][], double>(sum, d3, iterations);
            TestTime<double[], int, double>(sum, d1, l1, iterations);
            TestTime<double[,], double>(sum, d2, iterations);
            TestTime<double[][], double>(sum, d3, iterations); 
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T11:54:23.577

~~因为多维数组只是一种语法糖，因为它实际上只是一个具有一些索引计算魔法的平面数组。另一方面，锯齿状数组就像一个数组数组。对于二维数组，访问一个元素只需要读取一次内存，而对于两级锯齿数组，您需要读取两次内存。~~

**编辑：**显然原始海报将“锯齿状数组”与“多维数组”混为一谈，所以我的推理并不完全成立。对于真正的原因，请查看上面 Jon Skeet 的重型火炮答案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-22T09:26:19.303

哪个最快取决于您的数组大小。

### 便于阅读的图片：

[![在此处输入图像描述](https://i.stack.imgur.com/K57LJ.png)](https://i.stack.imgur.com/K57LJ.png)

### 控制台结果：

```
// * Summary *

BenchmarkDotNet=v0.12.1, OS=Windows 10.0.18363.997 (1909/November2018Update/19H2)
Intel Core i7-6700HQ CPU 2.60GHz (Skylake), 1 CPU, 8 logical and 4 physical cores
.NET Core SDK=3.1.302
  [Host]        : .NET Core 3.1.6 (CoreCLR 4.700.20.26901, CoreFX 4.700.20.31603), X64 RyuJIT
  .NET Core 3.1 : .NET Core 3.1.6 (CoreCLR 4.700.20.26901, CoreFX 4.700.20.31603), X64 RyuJIT

Job=.NET Core 3.1  Runtime=.NET Core 3.1

|           Method |    D |            Mean |         Error |        StdDev |      Gen 0 |     Gen 1 |     Gen 2 |  Allocated |
|----------------- |----- |----------------:|--------------:|--------------:|-----------:|----------:|----------:|-----------:|
| 'double[D1][D2]' |   10 |        376.2 ns |       7.57 ns |      12.00 ns |     0.3643 |         - |         - |     1144 B |
| 'double[D1, D2]' |   10 |        325.5 ns |       3.71 ns |       3.47 ns |     0.2675 |         - |         - |      840 B |
| 'double[D1][D2]' |   50 |      4,821.4 ns |      44.71 ns |      37.34 ns |     6.8893 |         - |         - |    21624 B |
| 'double[D1, D2]' |   50 |      5,834.1 ns |      64.35 ns |      60.20 ns |     6.3629 |         - |         - |    20040 B |
| 'double[D1][D2]' |  100 |     19,124.4 ns |     230.39 ns |     454.77 ns |    26.2756 |    0.7019 |         - |    83224 B |
| 'double[D1, D2]' |  100 |     23,561.4 ns |     299.18 ns |     279.85 ns |    24.9939 |         - |         - |    80040 B |
| 'double[D1][D2]' |  500 |  1,248,458.7 ns |  11,241.19 ns |  10,515.01 ns |   322.2656 |  160.1563 |         - |  2016025 B |
| 'double[D1, D2]' |  500 |    966,940.8 ns |   5,694.46 ns |   5,326.60 ns |   303.7109 |  303.7109 |  303.7109 |  2000034 B |
| 'double[D1][D2]' | 1000 |  8,987,202.8 ns |  97,133.16 ns |  90,858.41 ns |  1421.8750 |  578.1250 |  265.6250 |  8032582 B |
| 'double[D1, D2]' | 1000 |  3,628,421.3 ns |  72,240.02 ns | 177,206.01 ns |   179.6875 |  179.6875 |  179.6875 |  8000036 B |
| 'double[D1][D2]' | 1500 | 26,496,994.4 ns | 380,625.25 ns | 356,037.09 ns |  3406.2500 | 1500.0000 |  531.2500 | 18048064 B |
| 'double[D1, D2]' | 1500 | 12,417,733.7 ns | 243,802.76 ns | 260,866.22 ns |   156.2500 |  156.2500 |  156.2500 | 18000038 B |
| 'double[D1][D2]' | 3000 | 86,943,097.4 ns | 485,339.32 ns | 405,280.31 ns | 12833.3333 | 7000.0000 | 1333.3333 | 72096325 B |
| 'double[D1, D2]' | 3000 | 57,969,405.9 ns | 393,463.61 ns | 368,046.11 ns |   222.2222 |  222.2222 |  222.2222 | 72000100 B |

// * Hints *
Outliers
  MultidimensionalArrayBenchmark.'double[D1][D2]': .NET Core 3.1 -> 1 outlier  was  removed (449.71 ns)
  MultidimensionalArrayBenchmark.'double[D1][D2]': .NET Core 3.1 -> 2 outliers were removed, 3 outliers were detected (4.75 us, 5.10 us, 5.28 us)
  MultidimensionalArrayBenchmark.'double[D1][D2]': .NET Core 3.1 -> 13 outliers were removed (21.27 us..30.62 us)
  MultidimensionalArrayBenchmark.'double[D1, D2]': .NET Core 3.1 -> 1 outlier  was  removed (4.19 ms)
  MultidimensionalArrayBenchmark.'double[D1, D2]': .NET Core 3.1 -> 3 outliers were removed, 4 outliers were detected (11.41 ms, 12.94 ms..13.61 ms)
  MultidimensionalArrayBenchmark.'double[D1][D2]': .NET Core 3.1 -> 2 outliers were removed (88.68 ms, 89.27 ms)

// * Legends *
  D         : Value of the 'D' parameter
  Mean      : Arithmetic mean of all measurements
  Error     : Half of 99.9% confidence interval
  StdDev    : Standard deviation of all measurements
  Gen 0     : GC Generation 0 collects per 1000 operations
  Gen 1     : GC Generation 1 collects per 1000 operations
  Gen 2     : GC Generation 2 collects per 1000 operations
  Allocated : Allocated memory per single operation (managed only, inclusive, 1KB = 1024B)
  1 ns      : 1 Nanosecond (0.000000001 sec) 
```

### 基准代码：

```
[SimpleJob(BenchmarkDotNet.Jobs.RuntimeMoniker.NetCoreApp31)]
[MemoryDiagnoser]
public class MultidimensionalArrayBenchmark {
    [Params(10, 50, 100, 500, 1000, 1500, 3000)]
    public int D { get; set; }

    [Benchmark(Description = "double[D1][D2]")]
    public double[][] JaggedArray() {
        var array = new double[D][];
        for (int i = 0; i < array.Length; i++) {
            var subArray = new double[D];
            array[i] = subArray;

            for (int j = 0; j < subArray.Length; j++) {
                subArray[j] = j + i * 10;
            }
        }

        return array;
    }

    [Benchmark(Description = "double[D1, D2]")]
    public double[,] MultidimensionalArray() {
        var array = new double[D, D];
        for (int i = 0; i < D; i++) {
            for (int j = 0; j < D; j++) {
                array[i, j] = j + i * 10;
            }
        }

        return array;
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T11:55:42.840

锯齿状数组是类引用的数组（其他数组），直到叶数组，它可能是一个原始类型的数组。因此，为每个其他数组分配的内存可能无处不在。

而多维数组的内存分配在一个连续的块中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T11:54:33.137

我认为这是因为锯齿状数组实际上是数组的数组，因此有两个级别的间接来获取实际数据。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T12:02:39.050

我和这里的其他人在一起

我有一个包含三维数组的程序，让我告诉你，当我将数组移动到二维时，我看到了巨大的提升，然后我移动到了一维数组。

最后，我认为我在执行时间上看到了超过 500% 的性能提升。

唯一的缺点是增加了找出一维数组中的内容的复杂性，而不是三维数组。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T12:57:17.473

我认为多维速度较慢，运行时必须检查两个或更多（三维及以上）边界检查。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-22T11:55:26.147

边界检查。如果“i”小于 l1，您的“j”变量可能会超过 l2。这在第二个例子中是不合法的

# xslt - 从 Html 编码的字符串转换为“普通”网址

> ID：468843
> 
> 赞同：0
> 
> 时间：2009-01-22T11:53:16.370
> 
> 标签：xslt, url, encoding

我在编码的 xml 文档中有一个 url

```
<Link>http://www.sample.com/test.asp?goto=HOTWIZ%26eapid=857</Link> 
```

我想将其转换为输出 Html 中的 Url。

我可以输出链接，但我需要将 %26 转换为 &

我假设我可以在 XSLT 中使用某种替换功能，但我想有一个更优雅的解决方案

干杯

为了澄清意图，应该是两个单独的参数，url存储在xml文档中，因此需要对url进行编码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T11:57:20.980

`…?foo=bar&baz`和之间存在语义差异`…?foo=bar%26baz`。第一个是两个参数（`foo`带有值`bar`和`bar`空值），而第二个只是一个参数（`foo`带有值`bar&baz`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T12:16:55.417

The & has been urlencoded (%26) rather than entity encoded - for a more "pure" xml approach you would entity encode it as `&amp;`

```
<Link>http://www.sample.com/test.asp?goto=HOTWIZ&amp;eapid=857</Link> 
```

# .net - 是否有检查 CLS 合规性的工具？

> ID：468846
> 
> 赞同：6
> 
> 时间：2009-01-22T11:54:03.980
> 
> 标签：.net, cls-compliant

是否有工具可以分析我的 .NET 代码（C# 和[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)）并告诉我*为什么*不符合 CLS？

Visual Studio 很高兴告诉我一个参数不符合 CLS，但它并没有让我更接近解决问题，因为我不知道原因。

示例 Visual Studio 错误：

> 参数“xyz”不符合 CLS

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T13:27:30.643

我不能说我知道一个工具，我倾向于使用 MSDN 页面*[Language Independence and Language-Independent Components](http://msdn.microsoft.com/en-us/library/12a7a7h3.aspx)*来检查参数/变量的类型是否符合 CLS。请参阅表中名为“类型”的部分。

前段时间在博客文章*[FxCop 和 CLS 合规性](http://weblogs.asp.net/psteele/archive/2003/07/21/10358.aspx)*中也对此进行了相当多的讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T13:03:03.203

从记忆来看，这并不难。我不知道有什么工具，但是这里的这个[页面](http://www.devarticles.com/c/a/C-Sharp/Making-Your-Code-CLS-Compliant/)描述了你需要改变什么。

大的是使用特定类型的结构（想想 uint32 而不是 uint）并在您的公共成员中使用“_”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T12:00:51.800

先发制人的反驳：据我所知，FxCop 不支持 CLS 合规性检查。也许 VS 中的代码分析可以，但我无法在工作中检查。

你可以用谷歌搜索你收到的警告信息。

# asp.net-mvc - 我如何知道 ASP.Net MVC 中的 Ajaxtoolkit 控件需要哪些脚本

> ID：468857
> 
> 赞同：0
> 
> 时间：2009-01-22T12:00:16.200
> 
> 标签：asp.net-mvc

我想知道如何知道 Ajaxtoolkit 控件需要哪些脚本？例如，我知道对于 Datetime 控件，这些是按以下顺序要求的，如此[处所示](http://stephenwalther.com/blog/archive/2008/08/22/asp-net-mvc-tip-36-create-a-popup-calendar-helper.aspx)

BaseScripts.js
Common.js
DateTime.js
Animations.js
PopupBehavior.js
AnimationBehavior.js
Threading.js
Timer.js
CalendarBehavior.js

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T13:53:28.797

对于 ASP.NET MVC 应用程序，请遵循[这些说明](http://stephenwalther.com/blog/archive/2008/08/22/asp-net-mvc-tip-36-create-a-popup-calendar-helper.aspx "在本技巧中，Stephen Walther 演示了如何创建在 ASP.NET MVC 视图中工作的 JavaScript 弹出日历（日期选择器）。 日历是使用 AJAX 控件工具包创建的。")。

但是请注意，[jQuery 日期选择器](http://ui.jquery.com/demos/datepicker)更好。

# visual-studio - Visual Studio 2005 和 SQL Express 2008

> ID：468862
> 
> 赞同：0
> 
> 时间：2009-01-22T12:02:14.760
> 
> 标签：visual-studio

我们在应用 VS 2005 标准的补丁时遇到了一些问题：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=e1109aef-1aa2-408d-aa0f-9df094f993bf&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=e1109aef-1aa2-408d-aa0f-9df094f993bf&displaylang=en)

这在专业版中运行良好，但不是机器运行标准。我们已经检查过它有所有的先决条件，但一点运气都没有。

错误是说补丁无法应用，因为缺少另一个补丁，但是我们再次检查并检查了。

现在，知识库文章：

[http://support.microsoft.com/kb/954961](http://support.microsoft.com/kb/954961)

说专业版和团队版，没有提到标准版。从将这个补丁应用到 VS 05 pro 的简单程度和这篇知识库文章来看，我们开始得出结论，它就是这个版本。

有人有这个问题吗？尽我们所能，我们找不到任何解决办法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T22:51:43.443

我在 Windows 7 RC 上遇到了同样的问题。在为 SQL 2008 Express 安装 SP1 后，它终于完成了。

# php - Zend 身份验证和 ACL

> ID：468863
> 
> 赞同：11
> 
> 时间：2009-01-22T12:02:23.777
> 
> 标签：php, zend-framework, authentication, login

我希望有些人可以帮助我一点，我目前正在使用 PHP 框架开发我的第一个网站，该网站的一部分被溢出到会员区，这是我的困惑开始浮出水面的地方，我想要正常的会员区成员能够添加新评论并在那里编辑自己的评论，足够简单，我可以根据存储在会话中的用户名检查发布者名称，我的困惑来自于区分“普通”用户和更高级别的用户谁有能力删除和修改任何评论等，他们也应该能够访问网站的管理部分。

我的问题是所有用户都应该通过同一个 Zend_Auth 控制器登录，还是应该为每种类型的用户使用 Zend_Auth 的单独控制器，还是可以使用 Zend_Acl 处理所有这些？任何帮助、建议、文章或教程将不胜感激。就个人而言，我认为 Zend 文档在某些类上有点原始。

提前致谢

sico87

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-22T15:06:36.153

我推荐 Manning Publications 的“Zend Framework in Action”一书作为对此的最新介绍。它可作为 PDF 下载，因此您现在可以拥有它 :)

但是要回答这个特定的问题：

让我们从定义两个关键术语开始。Zend_Auth 中的“Auth”指的是身份验证，它证明某人就是他们所说的人（即登录）。Zend_Acl 中的“A”指的是授权，它证明某人有权做他们想做的事情（即访问控制）。

假设用户只有一个角色... 将用户的角色存储在您作为 Zend_Auth 的一部分获得的“身份”中。登录时：

```
$auth = Zend_Auth::getInstance();
$identity = new stdClass();
$identity->user_pk = $user->getPrimaryKey();
$identity->user_name = $user->getName();
$identity->role = $user->getRole(); // select * from user_role where user_pk=xxx
$auth->getStorage()->write($identity); 
```

在控制器中：

```
$acl->add(new Zend_Acl_Resource('news'))
->allow('defaultRole', 'news'); 
```

默认情况下一切都被拒绝，因此您实际上不需要指定：

```
->deny('defaultRole', 'news', 'add'); 
```

进一步在控制器的代码中：

```
$identity = Zend_Auth::getInstance()->getIdentity();
if(!$acl->isAllowed($identity->role, 'news', 'add'))
{
   header('Location: http://www.yoursite.com/error/unauthorized');
} 
```

如果用户的身份不允许做“news->add”，它会将他们重定向到未经授权的页面（假设你已经做了这样的页面）。

如果用户拥有 >1 个角色，您将在其身份中存储一系列角色。然后你的支票会是这样的：

```
$identity = Zend_Auth::getInstance()->getIdentity();
$isAllowed = false;
foreach($identity->role as $role)
{
   if($acl->isAllowed($role, 'news', 'add'))
   {
      $isAllowed = true;
   }
}
if(!$isAllowed)
{  // if NO ROLES have access, redirect to unauthorized page
   header('Location: http://www.yoursite.com/error/unauthorized');
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T14:15:20.750

是的，在大多数情况下，您的所有身份验证都应该通过同一个控制器。但是，Zend Auth 不是控制器类型。Zend Auth 是一个 API，用于利用数据库或 http 等常见的身份验证方法。它的工作实际上只是对编写身份验证代码的繁重工作进行封装。

Zend Acl 是您用来区分普通用户和特权用户的工具。只有在用户经过身份验证和登录后才涉及 Zend Acl。

您需要的大部分内容都在 ZF 文档中。在对我来说很有意义之前，我阅读了几乎所有关于 Auth 和 Acl 的文档。尽管 ZF 的 Auth、ACL、Storage_* 和其他类非常紧密地一起使用，但它们的用途都非常不同。稍等片刻，您就会发现它们很好地建立在彼此的基础上。

几个链接可以帮助您入门：

[Pádraic Brady 的 ZF 教程](http://blog.astrumfutura.com/archives/367-Example-Zend-Framework-Blog-Application-Tutorial-Parts-1-8-Revisited.html)

[Zend 关于 ACL 和 MVC 的 DevZone 文章](http://devzone.zend.com/article/3509-Zend_Acl-and-MVC-Integration-Part-I-Basic-Use)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-07T22:39:30.140

我能理解你为什么会感到困惑。我/我还是有点困惑。所以，很遗憾，我无法直接回答您的问题。但是，为了澄清我脑海中的所有这些东西，我正在做的一件事是考虑“域对象”而不是数据库记录。

我处理这个问题的策略是创建我自己的身份验证适配器，它与用户凭据一起传递一个“用户基础对象”。我的“用户群”有点像用户存储库。

因此，Zend Auth 成为其他 Zend 组件的“接口”，而我仍然可以对我的系统进行更多控制，以存储和访问“用户”。我的 User_Base 类可以是 Zend Db tbl 的包装器，甚至可以在其中包含一些可用于测试的硬代码。

所以总的来说——

*   设计自己的“用户”模型

*   设计您自己的身份验证适配器 - 从此处概述所需的最小接口开始：http: [//framework.zend.com/manual/en/zend.auth.html](http://framework.zend.com/manual/en/zend.auth.html)

*   并保持一切简单，并在您了解更多信息时慢慢进行。

好吧，这就是我要做的。

在我清楚 Auth 之前，我什至不会打扰 Zend ACL。

* * *

我正在改造旧网站并将其转换为 Zend MVC

这些是我必须掌握的一些事情（也许是非常规的），我的“模型”才能工作。：

*   来自多个“用户群”的用户可能会使用一个应用程序 - openID、旧用户表、新用户表、转瞬即逝的客人等
*   客人的身份可能只是他们第一次到达时创建的哈希值
*   然而，旧用户的身份可能由旧用户表中的 id 表示
*   users 和 user_accounts 是不同的东西。不要试图将它们混合成一个概念，因为它可能会变得复杂。
*   系统中可能有许多不同类型的帐户。即买家账户与卖家账户。Readers_Account 与 Writers_Account
*   帐户“拥有”用户 - “主要帐户持有人”、“管理员超级用户”等
*   用户和帐户之间的关系由“account_users”（所有用户群中所有用户的本地子集）表示
*   角色被附加到 account_users（该特定帐户的用户）。（与浮动的角色相反）
*   不要害怕在服务器上拥有多个 Zend 应用程序来代表一个网站——例如管理应用程序、会员应用程序、前端应用程序。
*   不要害怕让这些应用程序使用存储在“共享模型”文件夹中的模型对象，只有与单个应用程序直接相关的模型代码位于 /application/models/foomodel 文件夹中。
*   每个应用程序可能都有自己的自定义身份验证适配器
*   管理员身份验证适配器可能只允许来自“管理员用户表”的用户，而前端应用程序的身份验证适配器可能能够对来宾用户群、员工或成员用户群的用户进行身份验证。
*   可能是一个特殊情况，当成员登录时，前端应用程序会话在提升时被成员会话清除并替换。
*   任何时候每个 Web 客户端每个应用程序一个用户对象（而不是尝试用来宾用户和成员用户引用一个人 - 这太复杂了）
*   每个应用程序每个用户一个会话（命名空间以避免与他们可能在该域上登录的其他应用程序发生冲突） - （而不是尝试同时指代“使用它的人”与访客会话和成员会话。再次，太复杂了）

好的，我开始闲逛....但你明白了。不要让您看到的 Zend_Auth+Zend Db 教程影响您自己的模型。它们只是简化的示例。

nuff 说

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-26T15:25:41.153

我对这段代码有几个问题

```
 $auth = Zend_Auth::getInstance();
    $identity = new stdClass();
    $identity->user_pk = $user->getPrimaryKey();
    $identity->user_name = $user->getName();
    $identity->role = $user->getRole(); // select * from user_role where user_pk=xxx
    $auth->getStorage()->write($identity);

    $identity = Zend_Auth::getInstance()->getIdentity(); 
```

user_pk、user_name 和 role 是否存储为 cookie？制作具有角色名称的 cookie 的人是否能够访问网站的安全部分？密码（使用 md5 加密）不应该也是身份的一部分，所以什么时候可以验证每个请求的用户名和密码？

# visual-studio - 并行使用 Subversion 和 Visual SourceSafe？

> ID：468872
> 
> 赞同：4
> 
> 时间：2009-01-22T12:04:16.940
> 
> 标签：visual-studio, svn, version-control, visual-sourcesafe

在我的公司，我们使用 SourceSafe 和 Visual Studio。启动一个小项目，我渴望尝试更现代的源代码控制，我的目标是 Subversion。但我需要在 SourceSafe 中处理以前的项目，至少现在是这样。

问：在 Visual Studio IDE 中同时使用 SourceSafe 和 Subversion 会很好吗？用什么？如果我习惯了 SourceSafe，Subversion 中是否有一些事情我可能会感到痛苦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T12:07:43.347

关于你的第一个问题，我不知道有什么会阻止两者并肩工作。您可以尝试[Ankh](http://ankhsvn.open.collab.net/)以获得免费的 SVN VS 插件，或者[VisualSVN](http://www.visualsvn.com/)是一个商业选项。

关于你的第二个问题，SVN 的模型与 SourceSafe 不同。SourceSafe 需要签出（悲观），而 SVN 您只需更改文件并在准备好时提交（乐观）。任何冲突都需要合并。其他方面也有所不同，在开始使用之前，您绝对应该阅读基本的 SVN 文档。[TortoiseSVN](http://tortoisesvn.tigris.org/)提供了出色的 Windows shell 集成和良好的文档。

PS。一旦您认真尝试 SVN，您将永远不会回头看 SourceSafe。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T12:22:59.820

There shouldn't be a problem using Visual Source Safe and Subversion side by side. Visual Source Safe keys off .scc files within the folders. I also believe the source control is stored in the project files. In any event, Visual Studio automagically handles Visual Source Safe integration.

Subversion (TortiseSVN really) stores all it's metadata in .svn folders. When you install Ankh or VisualSVN, these programs target the .svn folders. If you load a project that has .svn folder anywhere in it's folder structure, Ankh or VisualSVN will kick in.

I agree with other posts, once you turn to Subversion you won't want to go back. It takes a little getting use to. Spend sometime, if don't know already, learning merging and branching. It will serve you will moving forward.

After you get subversion up and going, you might want to look into continuous integration. Cruise Control.Net would be a good tool to start.

Best of luck!

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T12:32:54.840

Using SVN technically, won't be an issue - especially with Tortoise +VisualSVN (latter not free but cheap).

The headspace change in going from the usual VSS way of working - pessimistic locking - to the SVN/rest of the world style - optimistic locking will be the harder hurdle.

To explain a little less concisely - if you are used to locking a file when you 'check it out' so noone else can change it, or at least everybody else knowing you are working on it *before* they try to make any modifications it is quite a leap to go over to not knowing until you try to commit - at which point you have to do merges.

Merging is the tricky bit sometimes, purely conceptually, but especially merges for Winforms with the designer auto-code and the resx files...

Think very carefully about your branching strategy. Best to start just working directly off of trunk to get used to the software before deciding to go for merging. You will find a lot of things quite repetitive and manual compared to VSS - we have a coupla guys here who admin the SVN servers and thay have been invaluable in writing scripts and add-ons for Tortoise to take some of the pain away...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T12:07:54.313

在 Visual Studio 工具中 | 您可以从那里选择源代码控制提供程序的选项。几年前，我们曾经在 VSS 和另一个提供商之间进行交换，而我们所要做的就是在加载到项目时进行更改。

如果您使用的是 SVN，我强烈建议您查看 VisualSVN 以在 Visual Studio 中集成。（虽然阅读下面的评论......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-07T22:02:58.470

我已经将 TortoiseSVN 和 SourceSafe 与 VC6/VB6 项目并行使用，以便与 Subversion 保持并行更改日志（出于各种原因，但主要是为了正确跟踪修订），直到我们能够/准备完全切换到 Subversion . 我没有任何问题，我只需要留意来自 SourceSafe 存储库的新文件。

如果您安装了 AkhSVN，那么使用 Visual Studio .NET 就完全不同了，我就是这样做的。我用它工作了几个月，当 AnkhSVN 在打开 SourceSafe 控制的项目时自动启动时遇到了问题。只需避免将 SVN/SourceSafe 项目与 VS.NET 混合使用，或者不要安装 AnkhSVN。

# ios - 将图像或视频添加到 iPhone 模拟器

> ID：468879
> 
> 赞同：296
> 
> 时间：2009-01-22T12:08:05.170
> 
> 标签：ios, iphone, ios-simulator, uiimagepickercontroller, photo

我正在尝试使用`UIImagePickerController`with `UIImagePickerControllerSourceTypePhotoLibrary`，但它显示“没有照片”。模拟器从哪里获取图像？我应该在哪里复制图像以便它们显示在模拟器中？

* * *

## 回答 #1

> 赞同：448
> 
> 时间：2010-01-11T04:06:21.280

逐步解释 Airsource Ltd 将图像添加到模拟器的答案：

1.  将其拖到模拟器，然后 Safari 打开（或使用 Safari 浏览到 Internet 中的图像）
2.  按住你的图片
3.  当弹出窗口出现时，选择保存图像并享受；）

更新：对于 iOS Simulator 4.2，请执行两次这些步骤以使其正常工作。谢谢`kevboh`！

更新：这也适用于 iOS 模拟器 6.1

* * *

## 回答 #2

> 赞同：269
> 
> 时间：2009-01-22T12:15:34.517

将图像、视频等放到模拟器上的最简单方法是将它们从您的计算机拖放到模拟器上。这将导致模拟器打开照片应用程序并开始填充库。

* * *

如果您想要一个可编写脚本的方法，请继续阅读。

注意 - 虽然这是有效的并且有效，但我认为[Koen 下面的解决方案](https://stackoverflow.com/a/35271607/18017)现在是一个更好的解决方案，因为它不需要重新启动模拟器。

通过转到 xCode->Devices，选择您的模拟器并检查 Identifier 值来识别您的模拟器。或者您可以确保模拟器正在运行并运行以下命令以获取设备 ID`xcrun simctl list | grep Booted`

去

~/Library/Developer/CoreSimulator/Devices/[模拟器标识符]/data/Media/DCIM/100APPLE

并添加 IMG_nnnn.THM 和 IMG_nnnn.JPG。然后，您需要重置您的模拟器（硬件->重新启动）以使其注意到新的更改。它们是否不是 JPEG 并不重要——它们都可以是 PNG，但似乎它们都必须存在才能正常工作。如果 DCIM 不存在，您可能需要创建它，在这种情况下，您应该从 0001 开始 nnnn。JPG 文件是全尺寸版本，而 THM 文件是缩略图，大小为 75x75 像素。[我编写了一个脚本来执行此操作，但这里](http://ofcodeandmen.poltras.com/2008/11/04/adding-pictures-to-the-simulator/)有一个更好的文档（-link 不再起作用）。

您还可以通过点击并按住图像在模拟器中添加来自 safari 的照片。如果您将图像（或任何其他文件，如 PDF）拖到模拟器中，它将立即打开 Safari 并显示图像，因此这是一种获取图像的非常简单的方法。

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2010-06-30T19:19:49.627

3 个简单的步骤

1.  将图像拖放到模拟器上
    - 这将打开一个带有您的图像的浏览器
2.  单击并按住图像
    - 这将打开选项
3.  保存图像
    - 这会将图像复制到模拟器上

[观看 YouTube 视频（将图像添加到 iphone 模拟器）](http://www.youtube.com/watch?v=1NqHnYGNAp8)

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2014-09-10T06:40:44.423

在 iOS 8.0 中，我们添加了将图像拖放到 iOS 模拟器中的功能。您可以将一堆图像拖到窗口中，它们应该被导入到该模拟设备的照片卷轴中。您也可以使用 simctl 命令行工具来执行此操作。'xcrun simctl addphoto'

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2016-02-08T14:07:06.440

从 Xcode 6 开始，您可以使用命令行工具`xcrun simctl`。

用法很简单；要将照片添加到当前正在运行的模拟器中，请使用`booted`占位符。

```
xcrun simctl addmedia booted ./MyFile.jpg 
```

要将其添加到任何其他模拟器，请使用其设备 ID，可以通过运行`xcrun simctl list`.

```
xcrun simctl addmedia E201E636-CE6C-11E5-AB30-625662870761 ./MyFile.jpg 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2013-04-16T11:32:21.720

这很简单。只需按照以下步骤操作：

1.  将图像拖放到模拟器上
2.  现在图像在 Safari 浏览器中打开 (file://.../ImageName)。点击并按住图像。
3.  这将显示带有保存、取消选项的 actionSheet（在 iOS 7 模拟器的情况下也复制）。

    ![操作表的屏幕截图](https://i.stack.imgur.com/cKLPe.png)

4.  保存图像。图像被添加到库中。

    ![照片库](https://i.stack.imgur.com/lnPRY.png)

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2013-05-30T23:57:38.197

我刚刚偶然发现如何在 iOS 模拟器上**批量**上传图片。（我只在 6.1 上确认过。）

1.  备份文件夹：

    ```
    ~/Library/Application Support/iPhone Simulator/6.1/Media 
    ```

2.  将所有图像复制到文件夹中：

    ```
    ~/Library/Application Support/iPhone Simulator/6.1/Media/DCIM/100APPLE 
    ```

3.  **移动或删除文件夹：**

    ```
    ~/Library/Application Support/iPhone Simulator/6.1/Media/PhotoData 
    ```

4.  重启 iOS 模拟器

5.  打开*照片*应用

模拟器将恢复 100APPLE 文件夹中的所有图像！

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2013-11-07T19:53:36.097

对于 iOS 7，我执行了以下操作：

将照片复制到这两个文件夹：

```
~/Library/Application Support/iPhone Simulator/6.1/Media/DCIM/100APPLE
~/Library/Application Support/iPhone Simulator/7.0/Media/DCIM/100APPLE 
```

仅删除这 4 个文件（以避免重新启动时重复）：

```
~/Library/Application Support/iPhone Simulator/6.1/Media/PhotoData/Photos.sqlite-shm
~/Library/Application Support/iPhone Simulator/6.1/Media/PhotoData/Photos.sqlite-wal
~/Library/Application Support/iPhone Simulator/7.0/Media/PhotoData/Photos.sqlite-shm
~/Library/Application Support/iPhone Simulator/7.0/Media/PhotoData/Photos.sqlite-wal 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2017-05-28T11:24:37.833

只需将图像拖到 iPhone 模拟器上。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-11-23T12:07:56.150

使用 Xcode 6+（iOS 模拟器 8.1 及更高版本）附带的新 iOS 模拟器，这要容易得多。现在您所要做的就是将*一张或多*张照片拖到 iOS 模拟器窗口上，而不是打开 Safari，而是打开照片应用程序打开，并立即将*所有*拖入的照片添加到设备中。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2017-11-19T05:17:03.740

**方法 1（最简单的方法）：如果您在 Mac 上有图像**

您可以将图像从 Mac 上的 Finder 拖到模拟器中，然后将其保存到“已保存的照片”相册中。

**方法 2：如果它在任何 URL 上**

将网页中的图像保存到“照片”应用程序

1.  将指针放在要保存的图像上，然后按住鼠标按钮或触控板。
2.  当菜单出现时，单击 Save Image 将图像保存到 iOS 模拟器中的 Photos 应用程序中。
3.  图像将保存到“照片”应用程序中的“已保存照片”相册中。

如果有人正在寻找有关在模拟器中复制和粘贴 的[Apple 文档。](https://developer.apple.com/library/content/documentation/IDEs/Conceptual/iOS_Simulator_Guide/InteractingwithiOSandwatchOS/InteractingwithiOSandwatchOS.html#//apple_ref/doc/uid/TP40012848-CH8-SW11)![从 Safari 保存图像](https://i.stack.imgur.com/esaLh.png)

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2013-02-05T14:42:51.760

没有一个答案有我需要的确切解决方案。

我发现自己在 iOS 5.0 及以上模拟器上工作的步骤如下：

1.  如果模拟器正在运行 xcode 项目，请关闭它。

2.  通过单击从 Dock 运行模拟器。

3.  将图像拖放到模拟器中。

4.  点击并按住图像（在 Safari 中打开）并选择保存选项。

你完成了。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-04-11T15:15:39.870

对于 iOS 5.1，这将进一步更改为新路径

> ~/Library/Application Support/iPhone Simulator/5.1/Media/DCIM/100APPLE

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2014-09-23T21:46:21.213

从 iOS 8 开始，您只需将所有照片拖到模拟器窗口上，它们就会自动保存到相机胶卷。你可以一次做尽可能多的事情。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2010-09-02T14:49:05.787

如果您需要导入的不仅仅是一张或两张照片，请查看我写的这篇[文章](http://aptogo.co.uk/?p=203)。它描述了一种用于批量导入照片的简单方法，并且适用于 iOS 4.x。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2020-09-23T13:03:50.173

如果您因为遇到错误而无法拖放文件：

**一项或多项媒体项目导入失败: : 操作无法完成。（PHPhotosErrorDomain 错误 -1。）**

将文件移动到`Documents`文件夹中，然后将它们拖到模拟器中。这将触发模拟器请求访问您的文件的权限。将它们放在`Downloads`文件夹中，不会。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2014-11-04T17:41:44.213

对于 iOS 8，如果不需要保留照片拍摄日期和位置，只需将照片文件拖放到模拟器中即可。

要保留照片元数据，请执行以下操作：

1.  将照片文件复制到：/Users/{USER}/Library/Developer/CoreSimulator/Devices/{UDID}/data/Media/DCIM/100Apple
2.  删除（或重命名）文件夹：/Users/{USER}/Library/Developer/CoreSimulator/Devices/{UDID}/data/Media/photoData
3.  重新启动模拟器

注意：您需要将 {USER} 替换为您的用户名，将 {UDID} 替换为模拟器的 UDID。要为您的模拟器查找 UDID，请从终端运行“xcrun simctl list”。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2014-08-06T06:04:24.343

```
quit the simulator.

Run simulator from the dock by clicking on it.

Drag & drop the image into simulator which you want to add.

it will open image in safari .

tap and hold the image and click the save option.

then open gallery and you will see the image which u had saved recently. 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-08-09T22:19:03.507

将图像添加到运行 IOS 8.0 的 Iphone Simulation 更加容易。

*   将您的图像拖到模拟器中
*   IOS 打开照片应用程序，您的图像现在是您收藏的一部分。

不再需要处理 Safari

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-10-05T02:05:58.923

对于 iOS 4.2，我必须去创建 100APPLE 文件夹并重新启动模拟器，然后它就可以工作了。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-08-20T13:40:39.893

试试我制作的这个应用程序。下载代码并在模拟器中运行[https://github.com/cristianbica/CBSimulatorSeed](https://github.com/cristianbica/CBSimulatorSeed)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-09-02T07:13:26.743

对于 iOS 8.0，答案已过时。我在以下路径中找到了媒体资源： **~/Library/Developer/CoreSimulator/Devices/[DeviceID]/data/Media/DCIM/100APPLE**

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2019-11-26T19:12:17.140

在带有 Xcode 11 的 OS X Catalina 中，您必须以不同的方式执行此操作。

首先你必须启动模拟器。如果要复制，请向多个模拟设备说一张照片。启动所有这些。然后右键单击一个（多个图像将失败。只做一个文件。）。

分享 -> 模拟器

将弹出一个“共享表”。您必须在组合框中选择一个活动模拟器并点击发送。

它将发送一对多但不是多对多的选定照片。

我希望这对人们有所帮助。Xcode 和 OS X 的最新版本支持拖放，但 OS X Catalina 和 Xcode 11 不支持。

虽然这是在方向上，但它目前不起作用。

对我有用的是首先将我的图像导入 OS X 上的 iPhoto，然后将它们从我的 OS X iPhoto 拖放到模拟器中。看起来将照片拖放到模拟器中目前仅适用于 OS X iPhoto。:-(

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2012-08-24T11:18:39.900

只需将图像拖放到 iphone 模拟器中。浏览器将打开以显示您的图像。按图像直到您没有收到保存图像的选项。然后保存图像。就是这样 ：）。您将在模拟器中的照片应用程序中看到您的图像....

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2013-03-19T10:00:12.410

我写了一个 bash 脚本来做到这一点。检查链接[1]

```
#!/bin/bash

# Imports pictures into all iOS simulators.

path_to_pic="src/ios/pictures/"

mkdir -p /Users/$(whoami)/Library/Application\ Support/iPhone\ Simulator/{5.0,5.1,6.0,6.1}/Media/DCIM/100APPLE/
find ~/Library/Application\ Support/iPhone\ Simulator/ -type d -name '100APPLE' -exec cp /Users/$(whoami)/$path_to_pic/* {} \; 
```

[1]：[https ://gist.github.com/firesofmay/5194901](https://gist.github.com/firesofmay/5194901)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-06-20T17:37:20.390

只是告诉你：KONG 的解决方案也适用于 iOS 7 beta。

他的解决方案是：

将图像拖到模拟器，然后 Safari 打开（或使用 Safari 浏览到 Internet 中的图像）按住图像当弹出窗口出现时，选择保存图像并享受；）

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-05-23T17:54:30.517

我只需要一些随机图像进行测试，所以我就是这样做的。

我有世界上最简单的解决方案。只需在模拟器中打开 Safari，转到 Google 图片（或您自己的 Web 或 Dropbox URL），查看图片，按住鼠标按钮 2 秒钟，您将看到“保存图片” - 它会直接保存到照片库。冲洗并重复。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2014-09-23T23:38:19.950

更简单的方法是：在模拟器上打开 safari > 点击 www.google.com 搜索随机照片“自然”打开每张图片，按下并保存。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2015-07-27T18:32:21.123

使用拖放功能，您将丢失照片的所有元数据。

我创建了一个项目，可以很容易地将资产导入模拟器：[MBAssetsImporter](http://github.com/matibot/MBAssetsImporter)。

它使您能够导入视频和照片，同时保留文件的所有原始元数据。

[![](https://raw.github.com/matibot/MBAssetsImporter/master/Readme/folder.gif)](https://raw.github.com/matibot/MBAssetsImporter/master/Readme/folder.gif)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2016-12-15T10:48:30.730

**1\. CD到这个路径：**

> /Users/[macOS 用户]/Library/Developer/CoreSimulator/Devices/[模拟器标识符]/data/Media/DCIM/100APPLE
> 
> [模拟器标识符] 或 UDID 可以在以下位置找到：硬件 => 设备 => 管理设备。
> 
> 例如。cd /Users/rnDeveloper/Library/Developer/CoreSimulator/Devices/7508171A-DC5D-47CF-9BE1-FF950326E3DB/data/Media/DCIM/100APPLE

**2\. 通过运行以下命令下载照片：**

> curl -o pic_001.jpg " [https://s-media-cache-ak0.pinimg.com/474x/49/25/7a/49257a4b3287b7841922ecdff855fd80.jpg](https://s-media-cache-ak0.pinimg.com/474x/49/25/7a/49257a4b3287b7841922ecdff855fd80.jpg) "

**3\. 重新启动您的模拟器以查看新文件。**

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2017-01-26T23:20:28.880

最简单的解决方案是在模拟器上登录 iCloud，然后使用它来传输驱动器中的任何文件，包括照片。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2017-09-28T14:01:24.970

使用 iOS 11 和 Xcode 9，只需将照片拖放到模拟器即可。它会自动将它们导入图书馆应用程序。好简单！

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2019-03-01T09:18:22.033

1.  使用您的电脑只需通过您的电子邮件发送图像
2.  打开 IOS-Simulator 然后打开电子邮件并下载图像

3.  只需在图像上单击并按住鼠标，然后从将显示的选项中[![在此处输入图像描述](https://i.stack.imgur.com/QvkRM.png)](https://i.stack.imgur.com/QvkRM.png)

4.  然后，它将自动保存到您的 iOS 模拟器的照片库中

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2021-11-02T15:03:08.120

以上答案都不适用于 iOS 15。

我只是打开文件应用程序并将图像拖放到那里。它会自动将图像导入照片应用程序，我可以通过我的模拟器在任何地方使用。

干杯!

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2020-12-30T10:27:25.513

1.  确保设备正在运行。

2.  在终端中执行以下命令：

`open ~/Library/Developer/CoreSimulator/Devices/$(xcrun simctl list | grep Booted | grep -Eo '[a-zA-Z0-9]*-[a-zA-Z0-9]*-[a-zA-Z0-9]*-[a-zA-Z0-9]*-[a-zA-Z0-9]*')/data/Media/DCIM`

进一步的正则表达式参考@ [https://regex101.com/r/tY951n/3](https://regex101.com/r/tY951n/3)

# javascript - 打印 只要？

> ID：468881
> 
> 赞同：509
> 
> 时间：2009-01-22T12:09:36.710
> 
> 标签：javascript, css, printing, dhtml

如何打印指定的 div（无需手动禁用页面上的所有其他内容）？

我想避免一个新的预览对话框，所以用这个内容创建一个新窗口是没有用的。

该页面包含几个表格，其中一个包含我要打印的 div - 该表格的样式是 Web 的视觉样式，不应在打印中显示。

* * *

## 回答 #1

> 赞同：929
> 
> 时间：2010-04-11T22:39:26.437

这是一个通用的解决方案，**仅使用 CSS**，我已经验证它可以工作。

```
@media print {
  body * {
    visibility: hidden;
  }
  #section-to-print, #section-to-print * {
    visibility: visible;
  }
  #section-to-print {
    position: absolute;
    left: 0;
    top: 0;
  }
} 
```

替代方法不是那么好。使用`display`很棘手，因为如果任何元素有，`display:none`那么它的后代都不会显示。要使用它，您必须更改页面的结构。

使用`visibility`效果更好，因为您可以打开后代的可见性。不可见的元素仍然会影响布局，所以我移动`section-to-print`到左上角以便正确打印。

* * *

## 回答 #2

> 赞同：279
> 
> 时间：2011-09-23T17:16:58.773

我有一个更好的解决方案，代码最少。

将您的可打印部分放在一个 div 中，其 id 如下：

```
<div id="printableArea">
      <h1>Print me</h1>
</div>

<input type="button" onclick="printDiv('printableArea')" value="print a div!" /> 
```

然后添加一个类似 onclick 的事件（如上所示），并像我上面所做的那样传递 div 的 id。

现在让我们创建一个非常简单的 javascript：

```
function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
} 
```

注意这有多简单？没有弹出窗口，没有新窗口，没有疯狂的样式，没有像 jquery 这样的 JS 库。真正复杂的解决方案的问题（答案并不复杂，也不是我所指的）是它永远不会在所有浏览器中翻译！如果您想使样式不同，请按照检查答案中所示的方式，将 media 属性添加到样式表链接（media="print"）。

没有绒毛，重量轻，它只是工作。

* * *

## 回答 #3

> 赞同：128
> 
> 时间：2009-01-22T12:28:28.750

到目前为止，所有答案都存在相当大的缺陷——它们要么涉及添加到所有内容，要么会在内部`class="noprint"`搞砸。`display``#printable`

我认为最好的解决方案是围绕不可打印的东西创建一个包装器：

```
<head>
    <style type="text/css">

    #printable { display: none; }

    @media print
    {
        #non-printable { display: none; }
        #printable { display: block; }
    }
    </style>
</head>
<body>
    <div id="non-printable">
        Your normal page contents
    </div>

    <div id="printable">
        Printer version
    </div>
</body> 
```

当然这并不完美，因为它涉及在 HTML 中移动一些东西......

* * *

## 回答 #4

> 赞同：116
> 
> 时间：2009-11-06T12:57:54.593

使用 jQuery 就这么简单：

```
w=window.open();
w.document.write($('.report_left_inner').html());
w.print();
w.close(); 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-01-22T12:12:20.840

您可以使用[打印样式表](http://css-discuss.incutio.com/?page=PrintStylesheets)，并使用 CSS 来安排您想要打印的内容吗？[阅读这篇文章](http://www.alistapart.com/stories/goingtoprint/)以获得更多指导。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2013-07-23T15:02:28.123

我真的不喜欢这些答案中的任何一个。如果您有一个类（例如 printableArea）并将其作为 body 的直接子级，那么您可以在打印 CSS 中执行以下操作：

```
body > *:not(.printableArea) {
    display: none;
}

//Not needed if already showing
body > .printableArea {
    display: block;
} 
```

对于那些在其他地方寻找 printableArea 的人，您需要确保显示 printableArea 的父母：

```
body > *:not(.parentDiv),
.parentDiv > *:not(.printableArea) {
    display: none;
}

//Not needed if already showing
body > .printableArea {
    display: block;
} 
```

使用可见性会导致很多间距问题和空白页。这是因为可见性保持元素空间，只是使其隐藏，而显示将其移除并允许其他元素占用其空间。

这个解决方案有效的原因是你没有抓住所有元素，只是身体的直接子元素并隐藏它们。下面使用显示 css 的其他解决方案，隐藏所有元素，这会影响 printableArea 内容中的所有内容。

我不建议使用 javascript，因为您需要一个用户单击的打印按钮，而标准浏览器打印按钮不会产生相同的效果。如果你真的需要这样做，我会做的是存储正文的 html，删除所有不需要的元素，打印，然后将 html 添加回来。如前所述，如果可以的话，我会避免这种情况，并使用上面的 CSS 选项。

注意：您可以使用内联样式将任何 CSS 添加到打印 CSS 中：

```
<style type="text/css">
@media print {
   //styles here
}
</style> 
```

或者像我通常使用的是链接标签：

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-05-08T23:37:08.703

1.  给出要打印 id 的任何元素`printMe`。

2.  在你的 head 标签中包含这个脚本：

    ```
    <script language="javascript">
        var gAutoPrint = true;

        function processPrint(){

        if (document.getElementById != null){
        var html = '<HTML>\n<HEAD>\n';
        if (document.getElementsByTagName != null){
        var headTags = document.getElementsByTagName("head");
        if (headTags.length > 0) html += headTags[0].innerHTML;
        }

        html += '\n</HE' + 'AD>\n<BODY>\n';
        var printReadyElem = document.getElementById("printMe");

        if (printReadyElem != null) html += printReadyElem.innerHTML;
        else{
        alert("Error, no contents.");
        return;
        }

        html += '\n</BO' + 'DY>\n</HT' + 'ML>';
        var printWin = window.open("","processPrint");
        printWin.document.open();
        printWin.document.write(html);
        printWin.document.close();

        if (gAutoPrint) printWin.print();
        } else alert("Browser not supported.");

        }
    </script> 
    ```

3.  调用函数

    ```
    <a href="javascript:void(processPrint());">Print</a> 
    ```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-04-09T11:38:46.890

第 1 步：在 head 标签内编写以下 javascript

```
<script language="javascript">
function PrintMe(DivID) {
var disp_setting="toolbar=yes,location=no,";
disp_setting+="directories=yes,menubar=yes,";
disp_setting+="scrollbars=yes,width=650, height=600, left=100, top=25";
   var content_vlue = document.getElementById(DivID).innerHTML;
   var docprint=window.open("","",disp_setting);
   docprint.document.open();
   docprint.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');
   docprint.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');
   docprint.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">');
   docprint.document.write('<head><title>My Title</title>');
   docprint.document.write('<style type="text/css">body{ margin:0px;');
   docprint.document.write('font-family:verdana,Arial;color:#000;');
   docprint.document.write('font-family:Verdana, Geneva, sans-serif; font-size:12px;}');
   docprint.document.write('a{color:#000;text-decoration:none;} </style>');
   docprint.document.write('</head><body onLoad="self.print()"><center>');
   docprint.document.write(content_vlue);
   docprint.document.write('</center></body></html>');
   docprint.document.close();
   docprint.focus();
}
</script> 
```

第 2 步：通过 onclick 事件调用 PrintMe('DivID') 函数。

```
<input type="button" name="btnprint" value="Print" onclick="PrintMe('divid')"/>
<div id="divid">
here is some text to print inside this div with an id 'divid'
</div> 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-10-10T09:22:35.447

```
<script type="text/javascript">
   function printDiv(divId) {
       var printContents = document.getElementById(divId).innerHTML;
       var originalContents = document.body.innerHTML;
       document.body.innerHTML = "<html><head><title></title></head><body>" + printContents + "</body>";
       window.print();
       document.body.innerHTML = originalContents;
   }
</script> 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2020-01-09T14:45:05.343

打印特定 Div 或任何元素的最佳方式

```
printDiv("myDiv");

function printDiv(id){
        var printContents = document.getElementById(id).innerHTML;
        var originalContents = document.body.innerHTML;
        document.body.innerHTML = printContents;
        window.print();
        document.body.innerHTML = originalContents;
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-01-22T12:13:15.300

嗯...使用样式表的类型进行打印...例如：

```
<link rel="stylesheet" type="text/css" href="print.css" media="print" /> 
```

打印.css：

```
div { display: none; }
#yourdiv { display: block; } 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-01-22T21:36:50.717

**printDiv(divId)**：在任何页面上打印任何 div 的通用解决方案。

我有一个类似的问题，但我希望 (a) 能够打印整个页面，或者 (b) 打印几个特定区域中的任何一个。我的解决方案，多亏了上面的大部分内容，允许您指定要打印的任何 div 对象。

此解决方案的关键是向打印媒体样式表添加适当的规则，以便打印请求的 div（及其内容）。

首先，创建所需的打印 css 来抑制所有内容（但没有特定规则来允许您要打印的元素）。

```
<style type="text/css" media="print">
   body {visibility:hidden; }
   .noprintarea {visibility:hidden; display:none}
   .noprintcontent { visibility:hidden; }
   .print { visibility:visible; display:block; }
</style> 
```

请注意，我添加了新的类规则：

*   *noprintarea*允许您禁止打印 div 中的元素 - 内容和块。
*   *noprintcontent*允许您禁止打印 div 中的元素 - 内容被禁止，但分配的区域为空。
*   *print*允许您拥有显示在打印版本中但不在屏幕页面上的项目。这些通常具有屏幕样式的“display:none”。

然后插入三个 JavaScript 函数。第一个只是打开和关闭打印媒体样式表。

```
function disableSheet(thisSheet,setDisabled)
{ document.styleSheets[thisSheet].disabled=setDisabled; } 
```

第二个做真正的工作，第三个之后清理。第二个 (printDiv) 激活打印媒体样式表，然后附加一个新规则以允许打印所需的 div，发出打印，然后在最终内务处理之前添加延迟（否则可以在打印实际之前重置样式完毕。）

```
function printDiv(divId)
{
  //  Enable the print CSS: (this temporarily disables being able to print the whole page)
  disableSheet(0,false);
  //  Get the print style sheet and add a new rule for this div
  var sheetObj=document.styleSheets[0];  
  var showDivCSS="visibility:visible;display:block;position:absolute;top:30px;left:30px;";
  if (sheetObj.rules) { sheetObj.addRule("#"+divId,showDivCSS); }
  else                { sheetObj.insertRule("#"+divId+"{"+showDivCSS+"}",sheetObj.cssRules.length); }
  print();
  //  need a brief delay or the whole page will print
  setTimeout("printDivRestore()",100);  
} 
```

最后的函数删除添加的规则并再次将打印样式设置为禁用，以便可以打印整个页面。

```
function printDivRestore()
{
  // remove the div-specific rule
  var sheetObj=document.styleSheets[0];  
  if (sheetObj.rules) { sheetObj.removeRule(sheetObj.rules.length-1); }
  else                { sheetObj.deleteRule(sheetObj.cssRules.length-1); }
  //  and re-enable whole page printing
  disableSheet(0,true);
} 
```

唯一要做的另一件事是在您的加载处理中添加一行，以便最初禁用打印样式，从而允许整页打印。

```
<body onLoad='disableSheet(0,true)'> 
```

然后，您可以从文档中的任何位置打印 div。只需从按钮或其他任何地方发出 printDiv("thedivid") 。

这种方法的一大优点是它提供了从页面中打印选定内容的通用解决方案。它还允许对打印的元素使用现有样式 - 包括包含 div。

注意：在我的实现中，这必须是第一个样式表。如果您需要稍后在图纸序列中进行，请将图纸参考 (0) 更改为适当的图纸编号。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-11-10T16:51:12.077

如果没有 CSS 小丑，带有 iframe 的 html 和纯 javascript 工作得最好。然后只需单击要打印的文本。带有文本内容的 id 元素的当前示例；

html正文：

```
<div id="monitor" onclick="idElementPrint()">text i want to print</div> 
```

纯JavaScript：

```
//or: monitor.textContent = "click me to print textual content";

const idElementPrint = () => {
    let ifram = document.createElement("iframe");
    ifram.style = "display:none";
    document.body.appendChild(ifram);
    pri = ifram.contentWindow;
    pri.document.open();
    pri.document.write(monitor.textContent);
    pri.document.close();
    pri.focus();
    pri.print();
    } 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-22T12:14:31.507

使用 CSS 3，您可以使用以下内容：

```
body *:not(#printarea) {
    display: none;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-03T13:06:46.637

我使用 JavaScript 获取内容并创建了一个可以打印的窗口...

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-06-19T19:58:57.177

Sandro 的方法效果很好。

我对其进行了调整以允许多个 printMe 链接，特别是用于标签页和扩展文本。

`function processPrint(printMe){` <-- 在这里调用一个变量

`var printReadyElem = document.getElementById(printMe);` <-- 删除 printMe 周围的引号以要求变量

`<a href="javascript:void(processPrint('divID'));">Print</a>`<-- 将要打印的 div ID 传递给函数以将 printMe 变量转换为 div ID。需要单引号

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-09-15T08:03:36.767

@Kevin Florida如果你有多个具有相同类的div，你可以像这样使用它：

```
 <div style="display:none">
   <div id="modal-2" class="printableArea">
     <input type="button" class="printdiv-btn" value="print a div!" />
   </div>
 </div> 
```

我正在使用 Colorbox 内部内容类型

```
$(document).on('click', '.printdiv-btn', function(e) {
    e.preventDefault();

    var $this = $(this);
    var originalContent = $('body').html();
    var printArea = $this.parents('.printableArea').html();

    $('body').html(printArea);
    window.print();
    $('body').html(originalContent);
}); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-06-17T14:18:10.987

就我而言，我必须在页面内打印图像。当我使用投票的解决方案时，我有 1 个空白页和另一个显示图像的页面。希望它会帮助某人。

这是我使用的css：

```
@media print {
  body * {
    visibility: hidden;
  }

  #not-print * {
    display: none;
  }

  #to-print, #to-print * {
    visibility: visible;
  }

  #to-print {
    display: block !important;
    position: absolute;
    left: 0;
    top: 0;
    width: auto;
    height: 99%;
  }
} 
```

我的html是：

```
<div id="not-print" >
  <header class="row wrapper page-heading">

  </header>

  <div class="wrapper wrapper-content">
    <%= image_tag @qrcode.image_url,  size: "250x250" , alt: "#{@qrcode.name}" %>
  </div>
</div>

<div id="to-print" style="display: none;">
  <%= image_tag @qrcode.image_url,  size: "300x300" , alt: "#{@qrcode.name}" %>
</div> 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-02-15T05:22:13.857

在不影响当前页面的情况下再增加一种方法，并且在打印时也会保留 css。这里的选择器必须是特定的 div 选择器，我们需要打印哪些内容。

```
printWindow(selector, title) {
   var divContents = $(selector).html();
   var $cssLink = $('link');
   var printWindow = window.open('', '', 'height=' + window.outerHeight * 0.6 + ', width=' + window.outerWidth  * 0.6);
   printWindow.document.write('<html><head><h2><b><title>' + title + '</title></b></h2>');
   for(var i = 0; i<$cssLink.length; i++) {
    printWindow.document.write($cssLink[i].outerHTML);
   }
   printWindow.document.write('</head><body >');
   printWindow.document.write(divContents);
   printWindow.document.write('</body></html>');
   printWindow.document.close();
   printWindow.onload = function () {
            printWindow.focus();
            setTimeout( function () {
                printWindow.print();
                printWindow.close();
            }, 100);  
        }
} 
```

这里提供了一些超时显示外部 css 被应用到它。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-04-19T08:20:53.550

适合空间空高度的最佳 css：

```
@media print {
  body * {
    visibility: hidden;
    height:0;
  }
  #section-to-print, #section-to-print * {
    visibility: visible;
    height:auto;
  }
  #section-to-print {
    position: absolute;
    left: 0;
    top: 0;
  }
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-22T12:14:16.827

您可以使用单独的 CSS 样式来禁用除 ID 为“printarea”的内容之外的所有其他内容。

参见[CSS Design: Going to Print](http://alistapart.com/article/goingtoprint/)以获得进一步的解释和示例。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-22T17:21:44.337

如果你只想打印这个 div，你必须使用指令：

```
@media print{
    *{display:none;}
    #mydiv{display:block;}
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-02-27T17:47:42.227

printDiv() 函数出现了几次，但在这种情况下，您失去了所有绑定元素和输入值。因此，我的解决方案是为名为“body_allin”的所有内容创建一个 div，并为第一个名为“body_print”的内容创建另一个。

然后你调用这个函数：

```
function printDiv(divName){

    var printContents = document.getElementById(divName).innerHTML;

    document.getElementById("body_print").innerHTML = printContents;

    document.getElementById("body_allin").style.display = "none";
    document.getElementById("body_print").style.display = "";

    window.print();

    document.getElementById("body_print").innerHTML = "";
    document.getElementById("body_allin").style.display = "";
    document.getElementById("body_print").style.display = "none";

} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-11-09T15:54:29.210

我尝试了许多提供的解决方案。没有一个能完美运行。他们要么失去 CSS 或 JavaScript 绑定。我找到了一个既不会丢失 CSS 也不会丢失 JavaScript 绑定的完美且简单的解决方案。

HTML：

```
<div id='printarea'>
    <p>This is a sample text for printing purpose.</p>
    <input type='button' id='btn' value='Print' onclick='printFunc();'>
</div>
<p>Do not print.</p> 
```

Javascript：

```
function printFunc() {
    var divToPrint = document.getElementById('printarea');
    var htmlToPrint = '' +
        '<style type="text/css">' +
        'table th, table td {' +
        'border:1px solid #000;' +
        'padding;0.5em;' +
        '}' +
        '</style>';
    htmlToPrint += divToPrint.outerHTML;
    newWin = window.open("");
    newWin.document.write("<h3 align='center'>Print Page</h3>");
    newWin.document.write(htmlToPrint);
    newWin.print();
    newWin.close();
    } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2019-03-10T19:07:36.327

我参加这个聚会很晚了，但我想用另一种方法加入。[我编写了一个名为PrintElements](https://github.com/szepeshazi/print-elements)的小型 JavaScript 模块，用于动态打印网页的各个部分。

它通过迭代选定的节点元素来工作，对于每个节点，它会向上遍历 DOM 树直到 BODY 元素。在每个级别，包括初始级别（即要打印的节点的级别），它都将标记类 ( `pe-preserve-print`) 附加到当前节点。然后将另一个标记类 ( `pe-no-print`) 附加到当前节点的所有兄弟节点，但前提是`pe-preserve-print`它们上没有类。作为第三幕，它还将另一个类附加到保留的祖先元素`pe-preserve-ancestor`。

一个非常简单的补充仅打印 css 将隐藏和显示相应的元素。这种方法的一些好处是保留了所有样式，它不会打开新窗口，不需要移动大量 DOM 元素，并且通常不会侵入您的原始文档。

请参阅[演示](https://szepeshazi.github.io/print-elements/example/)，或阅读相关文章[了解更多详细信息](https://medium.com/@aszepeshazi/printing-selected-elements-on-a-web-page-from-javascript-a878ac873828)。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-09-25T04:55:22.493

我找到了解决方案。

```
@media print {
    .print-area {
        background-color: white;
        height: 100%;
        width: auto;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        z-index:1500;
        visibility: visible;
    }
    @page{
        size: portrait;
        margin: 1cm;
    }
/*IF print-area parent element is position:absolute*/
    .ui-dialog,
    .ui-dialog .ui-dialog-content{
        position:unset !important;
        visibility: hidden;
    }
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-07-27T12:01:05.663

```
It's better solution. You can use it Angualr/React 
```

**html**

```
 <div class="row" id="printableId">
      Your html 
    </div> 
```

**Javascript**

```
 function printPage(){

        var printHtml = window.open('', 'PRINT', 'height=400,width=600');

        printHtml.document.write('<html><head>');
        printHtml.document.write(document.getElementById("printableId").innerHTML);
        printHtml.document.write('</body></html>');

        printHtml.document.close(); 
        printHtml.focus(); = 10*/

        printHtml.print();
        printHtml.close();

        return true;

      } 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2022-02-15T11:05:59.777

我尝试了许多提供的解决方案。没有一个能完美运行。它们要么丢失 CSS，要么不适用于所有浏览器。我找到了一个完美而简单的解决方案，既不会丢失 CSS，也可以完美地适用于所有浏览器。

**html**

```
<div class="row" id="print-div">
      Your html 
    </div> 
```

**打字稿**

```
let popupWin = window.open('', '_blank', 'width=1080,height=595');
let printContents = document.getElementById("print-div").innerHTML;
let printHead = document.head.innerHTML;
popupWin.document
    .write(`<html>
     ${printHead}
    <body onload="window.print();">${printContents}</body></html>`);
popupWin.document.close(); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-22T12:14:11.943

使用特殊的样式表进行打印

```
<link rel="stylesheet" href="print.css" type="text/css" media="print" /> 
```

然后为每个标签添加一个类，即“noprint”，这是您不想打印的内容。

在 CSS 中使用

```
.noprint {
  display: none;
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-04-05T13:21:42.400

你可以使用这个：http: [//vikku.info/codesnippets/javascript/print-div-content-print-only-the-content-of-an-html-element-and-not-the-whole-document/](http://vikku.info/codesnippets/javascript/print-div-content-print-only-the-content-of-an-html-element-and-not-the-whole-document/)

或者将`visibility:visible`和`visibility:hidden`css 属性一起使用`@media print{}`

'display:none' 将隐藏所有嵌套的 'display:block'。那不是解决方案。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2016-10-21T14:45:43.113

我有多个图像，每个图像都有一个按钮，需要单击一个按钮来打印每个带有图像的 div。如果我在浏览器中禁用了缓存，并且图像大小在 Chrome 中没有改变，则此解决方案有效：

```
 function printDiv(divName) {

        var printContents = document.getElementById(divName).innerHTML;
        w = window.open();

        w.document.write(printContents);
        w.document.write('<scr' + 'ipt type="text/javascript">' + 'window.onload = function() { window.print(); window.close(); };' + '</sc' + 'ript>');

        w.document.close(); // necessary for IE >= 10
        w.focus(); // necessary for IE >= 10

        return true;
    }

<div id="printableArea">
      <h1>Print me</h1>
</div>

<input type="button" onclick="printDiv('printableArea')" value="print a div!" /> 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-06-09T17:37:16.487

所有答案都有权衡，不能用于所有情况。它们分为 3 类：

1.  使用打印样式表。这需要构建整个网站以具有打印意识。

2.  隐藏所有元素`<body>`并仅显示可打印元素。这适用于简单的页面，但对于复杂的页面却很棘手。

3.  使用可打印元素的内容打开一个新窗口或将`<body>`内容替换为该元素的内容。第一个会失去所有样式，第二个是杂乱无章的，可以破坏事件。

没有一种解决方案可以适用于所有情况，因此拥有所有这些选择很好，我正在添加另一种在**某些**情况下效果更好的解决方案。这个解决方案是两个类别的混合：隐藏 的所有内容`<body>`，然后将可打印元素的内容复制到一个新的`<div>`并将其附加到`<body>`. 打印后去掉新添加`<div>`的，显示内容`<body>`背部。这样，您就不会丢失样式或事件，也不会因为打开新窗口而搞砸。但与所有其他解决方案一样，它不适用于所有情况。如果您的可打印元素的样式取决于其父元素，您将丢失这些样式。独立于其父元素来设置可打印元素的样式仍然比为打印整个网站设置样式要容易得多。

唯一的障碍是弄清楚如何选择`<body>`. 对于简单的页面，通用样式`body>*`就可以了。但是，复杂的页面通常在 `s`<script>`的末尾有标签，`body' and also some` 用于对话框等。隐藏所有这些很好，但你不想在打印后显示它们。

就我而言，我构建了所有可能的网站，其中包含三个部分`<body>`：`<header>`、、`<footer>`和它们之间`<div id="Content">`。根据您的情况调整以下函数的第一行：

```
function PrintArea(selector) {
    //First hide all content in body.
    var all = $("body > header, body > #Content, body > footer")
    all.hide();
    //Append a div for printing.
    $("body").append('<div id="PrintMe">');
    //Copy content of printing area to the printing div.
    var p = $("#PrintMe");
    p.html($(selector).html());
    //Call the print dialog.
    window.print();
    //Remove the printing div.
    p.remove();
    //Show all content in body.
    all.show();
} 
```

我使用 jQuery 是因为它更干净、更简单，但如果您愿意，您可以轻松地将其转换为 vanilla JavaScript。当然，您可以按照建议的方式更改`var`为`let`局部变量。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2020-01-16T01:39:50.847

基于@Kevin Florida 的回答，我设法避免由于覆盖内容而禁用当前页面上的脚本。我使用其他名为“printScreen.php”（或 .html）的文件。将要打印的所有内容包装在 div“printSource”中。使用 javascript，打开一个您之前创建的新窗口（“printScreen.php”），然后在顶部窗口的“printSource”中获取内容。

这是代码。

主窗口：

```
echo "<div id='printSource'>";
//everything you want to print here
echo "</div>";

//add button or link to print
echo "<button id='btnPrint'>Print</button>";

<script>
  $("#btnPrint").click(function(){
    printDiv("printSource");
  });

  function printDiv(divName) {
   var printContents = document.getElementById(divName).innerHTML;
   var originalContents = document.body.innerHTML;
   w=window.open("printScreen.php", "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,top=50,left=50,width=900,height=400");
   }
</script> 
```

这是“printScreen.php” - 获取要打印的内容的其他文件

```
<head>
// write everything about style/script here (.css, .js)

</head>
<body id='mainBody'></body>
</html>

<script>
    //get everything you want to print from top window
    src = window.opener.document.getElementById("printSource").innerHTML;

    //paste to "mainBody"
    $("#mainBody").html(src);
    window.print();
    window.close();
</script> 
```

# c# - 在ASP.NET2.0中提供动态文件下载

> ID：468893
> 
> 赞同：1
> 
> 时间：2009-01-22T12:13:32.227
> 
> 标签：c#, asp.net, dynamic, download

我想提供文件的动态下载。这些文件可以在服务器端即时生成，因此它们表示为 byte[] 并且不存在于磁盘上。我希望用户填写 ASP.NET 表单，点击下载按钮并返回他/她想要的文件。

这是我在 ASP.NET 表单后面的代码的样子：

```
public partial class DownloadService : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{

}

protected void submitButtonClick(object sender, EventArgs e)
{
    if (EverythingIsOK())
    {
        byte[] binary = GenerateZipFile(); 
        Response.Clear();
        Response.ContentType = "application/zip";
        Response.ContentEncoding = System.Text.Encoding.UTF8;
        Response.BinaryWrite(binary);
        Response.End();
    }
}
...
} 
```

我希望这段代码可以正常工作。我清除响应，放入我生成的 zip 文件和宾果游戏。然而，这种情况并非如此。我在浏览器中收到以下消息：

*无法显示 XML 页面 无法使用样式表查看 XML 输入。请更正错误，然后单击“刷新”按钮，或稍后重试。在文本内容中发现无效字符。错误处理资源' [http://localhost:15900/mywebsite/DownloadS](http://localhost:15900/mywebsite/DownloadS) ...*

**我究竟做错了什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T12:25:18.707

这是您需要进行的小修改：

```
Response.Clear();
Response.ContentType = "application/x-zip-compressed";
Response.BinaryWrite(binary);
Response.End(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T12:26:50.140

这是我的（工作）实现：

```
Response.Clear();
Response.ContentType = mimeType;
Response.AddHeader("Content-Disposition", String.Format("attachment; filename=\"{0} {1} Report for Week {2}.pdf\"", ddlClient.SelectedItem.Text, ddlCollectionsDirects.SelectedItem.Text, ddlWeek.SelectedValue));
Response.BinaryWrite(bytes);
Response.Flush();
Response.End(); 
```

mimeType 就像您的应用程序/zip（PDF 除外）。主要区别在于传递的额外标头信息，以及对 Response 对象的 Flush 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T12:19:31.310

[在此处](http://www.iana.org/assignments/media-types/application/zip)查找有关 application/zip 的信息。可能是 ContentEncoding 错误。这[是](http://aspnet.4guysfromrolla.com/articles/021804-1.aspx)发送其他类型的指南。另外[这里](http://dpinkerton.blogspot.com/2006/05/aspnet-20-responsebinarywrite_26.html)是关于如何为 pdf 执行此操作的指南。

# vb.net - Nunit results

> ID：468905
> 
> 赞同：2
> 
> 时间：2009-01-22T12:20:41.650
> 
> 标签：vb.net, nunit, watin

I am using Nunit results for managerial view of all the tests. After reading nunit doc it says it automatically update the results xml file after running the tests. But In my case it keep showing me the old results in index file where as updated reults in actual file. Any idea how can I update the index file according to the latest results.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T04:47:54.593

根据 NUnit-Console 2.4.8[命令行文档](http://nunit.com/index.php?p=consoleCommandLine&r=2.4.8)，xml 输出默认写入工作目录中的 TestResult.xml。您可以使用 /xml 命令行选项来指定不同的文件名。例如：

```
nunit-console /xml:console-test.xml nunit.tests.dll 
```

我的猜测是，要么您使用 /xml 标志指定文件名，但在 TestResult.xml 中寻找更新的结果是徒劳的，或者您*没有*使用 /xml 标志并徒劳地寻找具有其他名称的文件中的更新结果。大概是前者。

# macos - 如何为 MAC OS X 安装 libgluezilla

> ID：468906
> 
> 赞同：2
> 
> 时间：2009-01-22T12:20:50.760
> 
> 标签：macos, mono

我正在尝试在具有嵌入式 Web 浏览器控件的 Mac 上运行 Mono 应用程序。程序运行，但现在显示浏览器并输出一条消息：

未找到 libgluezilla。要获得 webbrowser 支持，您需要安装 libgluezilla

我已经搜索过，但不知道如何安装它。您的指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:35:23.870

您不能在 Mac 上使用嵌入式 Web 浏览器控件。因此，没有适用于 Mac 的 libgluezilla。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-13T03:03:28.673

它适用于 2.4.2 的单声道，但不适用于最新的补丁。(2.4.2.1)

我对 mac 平台上的单声道失去了耐心。过去工作正常，然后停止工作，创建 bugzilla 条目有时没有响应。

# c# - C#：标准 .Net 字符串应该存储在 varchar 还是 nvarchar 中？

> ID：468914
> 
> 赞同：4
> 
> 时间：2009-01-22T12:26:44.120
> 
> 标签：c#, sql-server, unicode, types

我们有一个用 C# 编写的应用程序，使用 .NET Framework 3.0 或 3.5 或类似的东西。作为存储，我们使用 SQL Server，并且我们使用 Linq 2 SQL 与之对话。

目前，数据库中的大多数（如果不是全部）文本列都设置为 varchar 类型（当然长度不同）。

但我开始思考......根据 MSDN “字符串类型表示零个或多个 Unicode 字符的序列。” 这是否意味着我们真的应该将这些列更改为 nvarchar 以便正确存储内容？或者它是如何工作的？他们最初将它们设置为 varchar 的原因是因为 nvarchar 需要两倍的空间（如果我理解正确的话）。就我目前所见，它适用于 varchar，但我们还没有对不常用的外来字符进行太多测试......

有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T12:32:47.413

除非您有保证可以在数据库的代码页中表示的文本（或者您明确指定排序规则），否则我会使用 nvarchar。

在某些情况下，您可以保证内容是 ASCII，在这种情况下，您确实可以使用 varchar - 但我不知道与*绝对*确定不仅会内容是 ASCII，但除了 ASCII（或在特定代码页中）之外，您*永远不会*想要任何东西。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T12:57:21.967

.net 方面有很多观点。这是数据库方面的一个想法：

varchar 是 nvarchar 大小的一半。虽然这对于许多用途而言并不重要，但对于索引而言却非常重要。一半宽的索引速度是原来的两倍。这是因为一个数据页（数据库 IO 的单位）上可以存储两倍的值。

您（从应用程序）控制构建并希望使用某些字符串来访问重要记录。字母数字标识符（例如客户编号）属于此类。由于您控制了构造，因此您可以强制它们安全地使用 varchar（并且经常这样做）。为什么不为您已经在做的这项工作获得一半大小的双快索引的好处呢？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T12:30:20.990

是的，`nvarchar`将字符存储为 unicode，如 .NET 字符串。如果您需要存储包含不同语言字符的字符串，您可能应该使用`nvarchar`.

如果您只有一种语言的字符，您可以使用另一种选择`varchar`并选择该语言的特定排序规则（这将节省空间但会使生活变得更加复杂）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T12:33:39.283

正如其他人所说，您的应用程序是否会存储 2 字节 Unicode (UTF-16/32)？如果不是，那么 varchar 对于普通的 ascii 就可以了（甚至可能是 Window 默认的 UTF8，不确定）。.NET 字符串虽然是 UTF16 的。

除非您在数据库中保存大量文本并且磁盘空间不足，否则差异将很小，因此您最好坚持使用 NVarchar。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T13:25:07.433

如果您使用的是 SQL2005，那么一定要使用 nvarchar。如果您使用的是 SQL2000，那么请注意 8000 字节的总行大小限制——使用 nvarchar 您将很快遇到这种情况，因为它们占用了两倍的空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T12:30:25.873

是的，您确实应该使用 NVARCHAR，否则您可能会因编码问题而丢失字符。

我认为你的帖子的操作部分是**我迄今为止所看到的**。

使用charmap中字符中心下方的一些字符尝试一些示例，例如阿拉伯字符，看看它们是如何存储的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T12:35:30.543

T-SQL 中的 NVARCHAR(X) 转换为“UTF-16 编码”：每个 X 字符都是 16 位宽。如果要存储人类可读的文本，最好使用 NVARCHAR 进行文本存储。VARCHAR(X) 意味着字符的 8 位存储。这意味着必须在 C# 应用程序（在其`string`类型内部使用 UTF-16）和数据库之间进行一些转码。

为自己省点麻烦，在存储人类可读字符串的地方始终如一地使用 Unicode。

# flash - 在 ActionScript3 中，如何获得对对象类的引用？

> ID：468925
> 
> 赞同：6
> 
> 时间：2009-01-22T12:29:13.257
> 
> 标签：flash, actionscript-3

在 ActionScript3 中，如何获得对对象类的引用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-23T08:58:49.653

值得注意的是，XML 对象（XML、XMLList）是一个例外（即（new XML() as Object).constructor as Class == null）。当构造函数无法解析时，我建议回退到 getDefinitionByName(getQualifiedClassName) ：

```
function getClass(obj : Object) : Class
{
    var cls : Class = (obj as Class) || (obj.constructor as Class);

    if (cls == null)
    {
        cls = getDefinitionByName(getQualifiedClassName(obj));
    }

    return cls;
} 
```

请注意，如果该类是在与调用代码不同的（包括子）应用程序域中定义的，则 getDefinitionByName 将引发错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T12:54:09.023

如果您的对象是从类创建的，则可以使用[该`constructor`属性（来自文档：](http://livedocs.adobe.com/flex/3/langref/Object.html#constructor) *“如果对象是类的实例，则构造函数属性包含对类对象的引用。如果使用构造函数创建对象，构造函数属性持有对构造函数的引用。”*）：

```
var classRef:Class = myObject.constructor as Class; 
```

或者您可以使用[`flash.utils.getQualifiedClassName()`](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#getQualifiedClassName())and [`flash.utils.getDefinitionByName()`](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#getDefinitionByName())（这不是一个很好的方法，因为这需要在这些库函数的实现中进行不必要的字符串操作）：

```
var classRef:Class = getDefinitionByName(getQualifiedClassName(myObject)) as Class; 
```

# .net - .NET 中用于个人项目的免费代码覆盖工具

> ID：468930
> 
> 赞同：16
> 
> 时间：2009-01-22T12:30:49.227
> 
> 标签：.net, code-coverage

我需要一个用于个人项目的 .NET 中的免费代码覆盖工具。NCover 对于个人使用来说有点贵。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T12:39:44.950

NCover 的停产版本仍然是免费的（在我看来，仍然可以很好地工作）。把它们[弄到这里](http://www.ncover.com/download/discontinued)。

更新（2012 年 11 月 20 日）：我相信[OpenCover](https://github.com/sawilde/opencover)现在是最好的选择。我在当前的 .NET 4 项目中使用它取得了巨大的成功。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-06T09:36:05.287

**OpenCover**是 PartCover 的继任者并积极开发（截至 2013 年 2 月）。[在GitHub 上](https://github.com/sawilde/opencover)
找到它或作为[NuGet](http://nuget.org/packages/opencover)安装。

来自这两种产品的创造者：

> 注意：PartCover 现在处于维护模式（仅修复）所有新开发都在 OpenCover 上完成，现在支持 32/64 位，还支持分支和序列覆盖。

您可能还希望使用**ReportGenerator**来获得人性化的报告。
可在[Codeplex](http://reportgenerator.codeplex.com/)上使用，也可作为[NuGet](http://nuget.org/packages/ReportGenerator)使用。

据我所知，报告部分落后于商业产品，缺乏自定义聚合/向下钻取能力，但它肯定是可用的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T12:41:03.200

试试 PartCover，但我不知道它是否适用于 .Net 3.x！ [在 sourceforge 上下载 PartCover](http://sourceforge.net/projects/partcover/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-11T22:28:51.377

我为 OpenCover 创建了一个简单的 Visual Studio 扩展，虽然它现在看起来和工作起来都比我找到的其他免费解决方案好得多。此外，我在 MIT 许可下免费使用它，因此您可以根据需要使用/修改它。它被称为 AxoCover，您可以从 Visual Studio 或[此处](https://marketplace.visualstudio.com/items?itemName=axodox1.AxoCover)下载它。源代码在[GitHub 上](https://github.com/axodox/AxoTools)。

# .net - .NET Framework 2.0 上的 CType 等效项

> ID：468936
> 
> 赞同：1
> 
> 时间：2009-01-22T12:33:07.880
> 
> 标签：.net, vb.net

在 .NET Framework 中的 VB.NET`CINT(VB.NET) is Integer.Parse`中，（VB.NET）CType 的 .NET 等效项是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T12:34:53.243

`CType`被翻译成演员表，这是一个语言级别的问题。例如，在发出的 IL 中，没有将 an 强制转换`object`为 a之类的东西`string`。（旁注：如果类型是值类型，它将转换为`unbox`指令，但这是另一回事；运行时根本不区分引用类型`Foo`和`Bar`引用类型，为了简单起见，我也忽略了抛出`InvalidCastException`这是由`castclass`指令完成的）。

`Integer.Parse`并且`CInt`基本上对源对象（字符串）进行一些处理并将其转换为等效整数。他们做某事。`CType`只是指示语言编译器进行类型转换。

为了完整起见，转换的 IL 等价物是：

1.  `castclass`如果类型是引用类型。
2.  `unbox`如果类型是值类型。

但是，Visual Basic 编译器将表达式转换为对其中一种`Microsoft.VisualBasic.CompilerServices.Conversions`方法的调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T13:06:25.910

对于转换对象，`CType()`可以在 VB 中使用，但不能在 c# 中使用（除非您引用 Microsoft.VisualBasic.dll）。您也可以使用`DirectCast()`, 或`TryCast()`.

如果您将转换为特定的本机类型，则可以使用 Convert 类中的方法来执行此操作。（与`Parse`/不同`TryParse`，它们是 和 的混合`IsNumeric()`体`CInt()`）

例如

```
Convert.ToInt32()
Convert.ToString()
Convert.ToBoolean() 
```

各种类型还有很多其他的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T13:52:16.647

你总是可以做这样的事情：

```
var thisInteger = (Int64)objectToconvert;

var thisComplicatedObject = (BAL.ComplicatedObject)objectToConvert; 
```

基本上将您需要转换为的类型放在前面的括号中。这种方法并没有恢复执行 ctype() 操作所带来的良好智能感知，但您可以在下一行得到它。

# keyboard-shortcuts - 如何通过单键退出 Vi 编辑器？

> ID：468939
> 
> 赞同：9
> 
> 时间：2009-01-22T12:33:58.707
> 
> 标签：keyboard-shortcuts, vi

因为老实说

```
:wq! 
```

打字太多了。

请注意，问题是关于原始 Vi（比如 FreeBSD 附带的 Vi）而不是 Vim。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-22T12:42:04.087

按住 shift 键并敲击 Z 两次。

`ZZ`（大部分）等价于`:wq!`。

如果你真的想要一个单键击键解决方案，FreeBSD 附带了源代码，所以在紧要关头，你可以修改它并重新编译。这有点矫枉过正，但它会解决你的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T12:45:45.250

“ZZ”呢？它与 ":wq!" 的语义稍有不同，但也稍短一些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T12:57:00.250

将您最喜欢的键映射到 :wq! 命令。

例如把它放在你的 .vimrc 中：

```
map <F8> :wq!<CR> 
```

等等瞧。

编辑： *对不起，只有vim，错过了。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T13:44:09.627

这似乎适用于 solaris 的旧版本 vi：

```
Version SVR4.0, Solaris 2.5.0

$ vi -c "map g ZZ" test 
```

**编辑**：另外，这似乎工作：

```
$ vi -c 'map g :q!^M' test 
```

其中 ^M 实际上是 ^V (ctl-v) 然后 ^M (ctl-m)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T12:37:49.680

`:x`对 Vi 有效吗？虽然对于你的情况，我猜它可能是`:x!`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T18:01:19.543

如果你使用 gvim，你可以用`ALT+F4`. 两个键，但一个键。

如果您在自己的 xterm 中使用 vi，`ALT+F4`则应关闭 xterm，同时终止 vi。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-08T03:52:35.077

久经考验的真实有什么问题？

```
:x 
```

这不是一键按下，但它比：wq 少得多！这就是您的问题似乎真正寻求的。

还是这是 ViM 独有的功能？如果是这样，我很抱歉。

# excel - Reporting Services Excel 呈现扩展插件？

> ID：468941
> 
> 赞同：3
> 
> 时间：2009-01-22T12:35:15.787
> 
> 标签：excel, reporting-services, ssrs-2008

我们公司有一个利用分析服务 + 报告服务的报告解决方案，优先考虑 Excel 报告。一切都很好，但有几件烦人的事情困扰着我们：

*   无法重命名工作表
*   嵌入的图像垂直拉伸包含的单元格，从而使滚动变得痛苦
*   ~~不支持跨表链接~~（原来可以使用书签来实现）

所以我的问题基本上是这样的——我们应该尝试以某种方式解决这些问题（即这是否可能），还是应该使用一些带有更多格式选项的 excel 渲染扩展？你能推荐任何扩展吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:31:25.963

您可能想看看[Apose.Cells](http://www.aspose.com/categories/ssrs-rendering-extensions/aspose.cells-for-reporting-services/default.aspx)。我从未使用过他们的产品，但您可以下载免费试用版，看看它是否适合您的需求。

或者，您可以创建自定义渲染器[(MSDN)](http://msdn.microsoft.com/en-us/magazine/cc163840.aspx)

# c - Strategy flushing file outputs at termination

> ID：468944
> 
> 赞同：2
> 
> 时间：2009-01-22T12:35:52.570
> 
> 标签：c, windows, buffer

I have an application that monitors a high-speed communication link and writes logs to a file (via standard C file IO). The response time to messages that arrive on the link is important, so I knowingly don't `fflush` the file at each message, because this slows down my response time.

However, in some circumstances my application is terminated "violently" (e.g. by killing the process), and in these cases the last few log messages are not written (even if the communication link has been quiet for some time).

What techniques/strategies can I use to make sure most of my data is flushed, but without giving up speed of response?

Edit: The application runs on Windows

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T12:47:52.360

Using a thread is the standard solution to this. Have your data collection code write data to a thread-safe queue and use a semaphore to signal the writing thread.

However, before you go there, double-check your assertion that fflush() would be slow. Most operating systems have a file system cache. It makes writes very fast, as simple memory-to-memory block copy. The data gets written to disk lazily, your crash won't affect it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T12:49:53.370

If you are on Unix or Linux, your process would receive some [termination signal](http://en.wikipedia.org/wiki/Signal_(computing)) which you can catch (except `SIGKILL`) and `fflush()` in your signal handler.

For signal catching see `man sigaction`.

EDIT: No idea about Windows.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T13:27:34.807

我会建议异步写入。这样你就不需要等待写 IOP 发生，操作系统也不会延迟 IOP。请参阅 CreateFile() 标志`FILE_FLAG_WRITE_THROUGH | FILE_FLAG_OVERLAPPED`。

你不需要`FILE_FLAG_NO_BUFFERING`。那只是为了跳过操作系统缓存。只有当您担心整个操作系统会剧烈死亡时，您才需要它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-22T13:07:42.570

If your program terminates by calling exit() or returning from main(), the C standard guarantees that open streams are flushed and closed, so no special handling is needed. It sounds from your description like this is what is happening: if your program died due to a signal, you wouldn't see the flush.

I'm having trouble understanding what the problem is exactly.

If it's just that you're trying to find a happy medium between flushing often and the default fully buffered output, then maybe line buffering is what you want:

```
setvbuf(stream, 0, _IOLBF, 0); 
```

# sql-server-2005 - 可以使用sql表生成哈希吗？[sqlserver2005]

> ID：468946
> 
> 赞同：0
> 
> 时间：2009-01-22T12:36:38.763
> 
> 标签：sql-server-2005, triggers, bulkinsert, last-modified

我想要一张表，生成它的哈希字符串，存储它，然后在以后的预定义时间比较它，看看它是否匹配，如果不匹配，请记下修改时间并将其与新的更改日期一起存储。

这是因为我相信如果提交了一批超过 5000 条插入语句，插入触发器会导致严重的减速。我每天移动大量数据，除了具有默认获取日期的 smalldatetime 列之外，我有某些表我无权更改其架构，因此我无法确定最后一次更改日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:57:14.667

您可以`CHECKSUM`在各个领域使用来执行此操作。

# c# - What is the best way to parse large XML (size of 1GB) in C#?

> ID：468948
> 
> 赞同：13
> 
> 时间：2009-01-22T12:38:35.203
> 
> 标签：c#, xml, parsing, .net-2.0

I have a 1GB XML file and want to parse it. If I use XML Textreader or XMLDocument, the result is very slow and some times it hangs...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T12:41:06.990

You'll have to implement custom logic using xmlreader. xmlreader does not load the full XML into memory before using it, which means you can read it from a stream and process it as such.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-22T12:44:06.127

XmlDocument is not feasible in this scenario as it will attempt to suck that gigabyte into main memory. I'm surprised that you're finding XmlTextReader to be too slow. Have you tried something like the following?

```
using (XmlTextReader rdr = new XmlTextReader("MyBigFile.txt"))
{
     // use rdr to advance through the document.
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T12:42:01.560

XMLTextreader isn't supposed to hang as it's stream based and just works on chunks of the data.

If it hangs, it may well be that you are doing something wrong when loading the file.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T12:45:20.493

I'm not very familiar with this topic, but afaik the XmlReader-classes ought to work fine for your specific problem. They are, after all, optimized for exactly this.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T13:36:12.513

我只想通过我发现的性能比较来支持所有推广 XmlReader 的人：

[http://www.nearinfinity.com/blogs/joe_ferner/performance_linq_to_sql_vs.html](http://www.nearinfinity.com/blogs/joe_ferner/performance_linq_to_sql_vs.html)

# linq - 使用 LinqToXml 生成 XSD

> ID：468954
> 
> 赞同：0
> 
> 时间：2009-01-22T12:39:59.037
> 
> 标签：linq, xsd, linq-to-xml

有谁知道如何使用 LinqToXml 生成 XSD？我在任何地方都找不到这样的例子。XSD 将具有以下相当低的复杂性：

```
<?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML Studio 6.1.18.0 - FREE Community Edition (http://www.liquid-technologies.com)-->
<xs:schema 
    elementFormDefault="qualified" 
    targetNamespace="http://schemas.xxx.yy/CRM/2009/01/DeadAnimalReport" 
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name="Name">
    <xs:simpleType>
        <xs:restriction base="xs:string">
            <xs:length value="35" />
        </xs:restriction>
    </xs:simpleType>
    </xs:element>

    <xs:element name="Email" type="xs:string" />

    <xs:element name="Selection">
        <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:length value="15" />
            </xs:restriction>
        </xs:simpleType>
    </xs:element>

    <xs:element name="DeliveryDate" type="xs:date" />
</xs:schema> 
```

工具的上下文构造，允许业务分析师生成消息模式以及一些超出问题范围的相关工件。工具 XSD 将从应用程序对象模型中的 CLR 对象生成。

这些对象非常简单——一个根对象包含足够的信息来构建命名空间以及代表元素（类型、名称等）的其他对象的集合。

谢谢

肖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:43:33.570

为什么要在这种情况下使用 LINQ？源数据如何？

提供的信息不多，但无论如何：

您可以使用类似的代码构建您的 XSD：

```
XNamespace nsXS = "http://www.w3.org/2001/XMLSchema";
XElement root = new XElement(nsXS + "schema",
    new XAttribute("elementFormDefault", "qualified"),
    new XAttribute("targetNamespace", "http://schemas.xxx.yy/CRM/2009/01/DeadAnimalReport"),
    new XElement(nsXS + "element",
        new XElement(nsXS + "simpleType",
            new XElement(nsXS + "restriction",
                new XAttribute("base", "xs:string")),
                new XElement(nsXS + "length", new XAttribute("value", 35))))); 
```

如果您有某种对象，则可以使用投影：

```
var q =
    new XElement(nsXS + "schema",
                 from s in someObjects
                 select GetXsdDefinition(s)
        ); 
```

在哪里

GetXsdDefinition 是一种将您的对象作为参数并返回其 XSD 定义的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T12:49:12.280

还有一个 LINQ to XSD，也许这就是你要找的东西！你可以在[这里找到](http://www.aspalliance.com/chapters/chapters/1847192548/LINQ%20-%20Sample%20Chapter.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T13:07:03.600

由于您想使用 LinqToXml，我假设您的情况是您已经有一些 Xml，并且您希望 Xsd 与它一起使用。

LinqToXml 与 Xsd 的关系不大......

您可能想查看[Xsd 推理](http://msdn.microsoft.com/en-us/library/aa302302.aspx)工具。

# c++ - 如何在运行时获取 C++ 对象名称？

> ID：468956
> 
> 赞同：16
> 
> 时间：2009-01-22T12:40:41.000
> 
> 标签：c++, runtime

我可以在运行时获取对象的名称（例如通过 RTTI 获取对象的类型）吗？我希望对象能够打印其名称。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-22T12:46:45.217

由于 C++ 中的对象没有任何名称，因此您无法获取它们。您唯一可以识别对象的是它的地址。

否则，您可以实现您的命名方案（这意味着对象将有一些`char*`或`std::string`带有其名称的成员）。您可以在 Qt 中使用他们的 QObject 层次结构来启发自己，它使用了类似的方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-22T12:47:45.357

这是不可能的。事实上，一个对象没有唯一的名称。

```
A a;
A& ar = a;  // both a and ar refer to the same object

new A;  // the object created doesn't have a name

A* ap = new A[100];  // either all 100 objects share the same name, or need to 
                     // know that they are part of an array. 
```

最好的办法是向对象构造函数添加一个字符串参数，并在创建时为其命名。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T13:23:07.920

这可能是 GCC 特定的：

```
#include <typeinfo>
#include <iostream>

template <typename T>
void foo(T t)
{
    std::cout << typeid(t).name() << std::endl;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T13:18:57.040

该语言不允许您访问该信息。
到编译代码时，所有命名对象都已转换为相对内存位置。甚至这些位置由于优化而重叠（即一旦一个变量不再使用，它​​的空间可以被另一个变量使用）。

您需要的信息存储在大多数编译器生成的调试符号中，但这些通常从可执行文件的发布版本中剥离，因此您不能保证它们存在。

即使存在调试符号，它们都是编译器/平台特定的，因此您的代码不能在操作系统之间移植，甚至不能在同一操作系统上的编译器之间移植。如果你真的想学习这门课程，你需要阅读并理解你平台的调试器是如何工作的（除非你已经编写了一个编译器，这是非常重要的）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T12:49:31.717

C++ 并不真正支持反射。然而，一些谷歌搜索产生了一些[替代方法](http://www.garret.ru/cppreflection/docs/reflect.html)，但我怀疑你会发现它们有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T12:43:44.380

如果您的意思是变量的名称，我认为这是不可能的。也许如果您使用 GNU Debugger 选项编译...但即使这样，我也不认为该语言具有执行此操作的构造。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T13:26:10.817

C++ 对象没有“名称”（除非我对问题的理解是错误的）您最好的希望是在创建它们时命名它们。

```
class NamedObject
{
  String name;
  NamedObject(String argname)
  { 
    name = argname;
  }
}

NamedObject phil("phil"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-06T01:02:44.357

所以，这基本上就是我所做的。这很hacky，但它可以解决问题。我创建了一个利用字符串化的可变参数宏。不幸的是，由于需要 _dummy 参数来提供伪默认 ctor，它变得笨拙，因为您不能省略将命名参数与变量参数分开的逗号（我什至尝试使用 gnu cpp，但没有成功——可能我不够努力）。

```
#include <string>

#define MyNamedClass( objname, ... ) MyClass objname(__VA_ARGS__, #objname )

class MyClass
{
public:
   MyClass( void* _dummy=nullptr, const std::string& _name="anonymous") : name( _name ) {}
   MyClass( int i, const std::string& _name="anonymous" ) : name( _name ) {}

private:
   std::string name;
};

int main()
{
   MyClass mc0;
   MyClass mc1(54321);
   MyNamedClass( mc2, nullptr);
   MyNamedClass( mc3, 12345 );

   return 0;
} 
```

# .net - 如何获取 System.Object 中的数据

> ID：468960
> 
> 赞同：0
> 
> 时间：2009-01-22T12:41:38.333
> 
> 标签：.net

我正在使用具有名为 GetImage 的函数的 COM 对象。

[http://www.pdf-tools.com/asp/products.asp?name=P2IA](http://www.pdf-tools.com/asp/products.asp?name=P2IA)

当我在 Visual Studio 2008 中使用它时，它返回 byte[]，但是当我在 RAD Studio 2007 中使用它时，它返回 System.Object。如何将 System.Object 中的数据转换为 byte[]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:44:39.137

Object 本身的实例中没有数据。但是，由于对象从 Object 继承，它们可能被 Object 引用引用。要从实例中获取数据（假设有），您必须将引用转换为适当的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T12:57:08.380

你可以试试这个功能，看看它是否有效：

```
public byte[] ToByteArray(object obj)
{
    int length = Marshal.SizeOf(obj);
    byte[] byteArray = new byte[length];
    IntPtr ptr = Marshal.AllocHGlobal(length);
    Marshal.StructureToPtr(obj, ptr, false);
    Marshal.Copy(ptr, byteArray, 0, length);
    Marshal.FreeHGlobal(ptr);
    return byteArray;
} 
```

# .net - 切换到 Release Build 会导致 Web Reference 中出现运行时错误

> ID：468964
> 
> 赞同：2
> 
> 时间：2009-01-22T12:42:06.613
> 
> 标签：.net, vb.net, web-services, serialization, visual-studio-2005

我有一个由 Visual Studio 2005 生成的 SOAP Web 引用的问题（.NET 框架是 v2.0.50727.42） - 它在 Debug 构建配置下工作正常（并且有几个月）但现在我想上线并使用 Release 配置进行编译，它已停止工作。

每当我调用 Web Reference 上的方法时，都会在运行时引发异常。最常见的例外是：

```
System.InvalidOperationException: There was an error generating the XML document. ---> System.ArgumentException: Item has already been added. Key in dictionary: 'MayriseWebServices.RefuseService.PremiseSummaryStructure'  Key being added: 'MayriseWebServices.RefuseService.PremiseSummaryStructure' 
```

项目和生成的 Web 参考的语言是 VB.NET 而不是 C#。由于生成的 Reference.vb 代码实际上并没有改变，只是构建类型，我在那里找不到任何东西，而且我显然无法调试 Release 构建。

我注意到 Release 版本从主版本中分离出 *.XmlSerializers.dll 程序集。是否存在已知问题？

出于明显的原因，我宁愿不使用 Debug 版本。也许我应该读一些关于 CodeDOM 的书，我一直想这样做！

我应该提一下，我找到[了一篇文章，其中说明了发布版本运行方式不同](https://stackoverflow.com/questions/312312/what-are-some-reasons-a-release-build-would-run-differently-than-a-debug-build)但似乎专注于 C++ 的原因。

谢谢你提供的所有帮助。

**更新：**关闭序列化程序集的第三个建议已经解决了这个问题。我在高级编译选项中将“生成序列化程序集”设置从“自动”更改为“关闭”，我的测试现在通过了。我不知道那个设置。

我不确定序列化程序集的根本问题是什么。如果我有机会使用您在第二个建议中的建议调试 Release 程序集，我将提供更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T22:33:15.013

尽管我对如何解决此问题有一些想法，但我没有给您答案。

1.  由于这是仅在 RELEASE 构建而不是 DEBUG 构建时发生的运行时错误，我想知道 VB 编译器是否发出相同的 IL。您可能想要做的是编译您的 DEBUG 版本的程序集，然后编译 RELEASE 版本的程序集。一旦您拥有程序集的 DEBUG 和 RELEASE 版本，请使用 ILDASM.exe 执行这两个程序集的反汇编。将文件另存为文本并使用 WinDiff.exe 进行比较。这可能会或可能不会为您提供一些线索。
2.  您可能希望更改 RELEASE 配置的项目设置以生成 PDB (/debug:pdbonly)。只要您从 Visual Studio 中启动该过程，这将允许您进行调试。
3.  生成的 *.XmlSerializers.dll 程序集旨在改进导致发生序列化的初始调用。作为故障排除步骤，您可以在项目属性的 RELEASE 配置中将其关闭，以查看您是否仍然遇到相同的问题。

我希望这有帮助。

# c# - 如何将 IPictureDisp 转换为 System.Drawing.Image

> ID：468972
> 
> 赞同：4
> 
> 时间：2009-01-22T12:44:14.427
> 
> 标签：c#, interop

从 COM 库（Microsoft Office Document Imaging aka MODI）我收到一个图像作为 IPictureDisp，我想将其转换为 System.Drawing.Image 对象。

最好的方法是什么？

目前我正在使用下面的代码，但是会引发 NotImplementedException。

```
internal sealed class IPictureDispHost : AxHost
{
    /// <summary>
    /// Default Constructor, required by the framework.
    /// </summary>
    private IPictureDispHost() : base(string.Empty) { }
    /// <summary>
    /// Convert the image to an ipicturedisp.
    /// </summary>
    /// <param name="image">The image instance</param>
    /// <returns>The picture dispatch object.</returns>
    public new static object GetIPictureDispFromPicture(Image image)
    {
        return AxHost.GetIPictureDispFromPicture(image);
    }
    /// <summary>
    /// Convert the dispatch interface into an image object.
    /// </summary>
    /// <param name="picture">The picture interface</param>
    /// <returns>An image instance.</returns>
    public new static Image GetPictureFromIPicture(object picture)
    {
        return AxHost.GetPictureFromIPicture(picture);
    }
}

...

// somewhere later the conversion gets called
Image image = IPictureDispHost.GetPictureFromIPicture(picture); 
```

这是异常堆栈跟踪：

```
System.NotImplementedException: The method or operation is not implemented.
   at System.Windows.Forms.UnsafeNativeMethods.IPicture.GetHandle()
   at System.Windows.Forms.AxHost.GetPictureFromIPicture(Object picture)
   at DocumentViewer.IPictureDispHost.GetPictureFromIPicture(Object picture) 
```

我的项目中有对 stdole、System.Windows.Forms 和 System.Drawing 的引用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T23:10:02.027

看看这篇[文章](http://blogs.msdn.com/andreww/archive/2007/07/30/converting-between-ipicturedisp-and-system-drawing-image.aspx)。

它描述了三种不同的选择，只需为您的目的选择您认为最简单或“最干净”的一个（包括您声称不适合您的那个）。

* * *

Olivier Jacot-Descombes：上面的链接坏了。我从 Internet Archive [WayBackMachine](https://web.archive.org)添加了相应的链接：

[在 IPictureDisp 和 System.Drawing.Image 之间转换](https://web.archive.org/web/20160114043055/http://blogs.msdn.com/b/andreww/archive/2007/07/30/converting-between-ipicturedisp-and-system-drawing-image.aspx)（MSDN 博客 > Andrew Whitechapel）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:19:12.483

从 Microsoft Office Document Imaging COM 组件获得的图片似乎不是有效的 IPictureDisp 对象，似乎没有办法对其进行转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-12T14:19:27.820

```
Function GetImage(MyIPicture As stdole.IPictureDisp) As Drawing.Image
    If CType(MyIPicture.Type, Integer) <> 1 then Throw New ArgumentException("Image not supported")
    Return Drawing.Image.FromHbitmap(MyIPicture.Handle, MyIPicture.hPal)
End Function 
```

灵感来自[MSDN 论坛中的这篇文章](https://social.msdn.microsoft.com/Forums/vstudio/en-US/db1100b7-faca-4361-822c-b05f08cfe3f5/use-of-icons-out-of-ribbons?forum=vsto)。不知道为什么`CType(MyIPicture.Type, Integer) = 1`需要，但它有效..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T12:46:58.353

你有没有尝试过：

```
picture1.image = Microsoft.VisualBasic.Compatibility.VB6.Support.IPictureDispToImage(pict) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T23:02:46.070

Microsoft.VisualBasic.Compatibility.VB6.Support.IPictureDispToImage 不保证始终包含在未来的更新中。所以......以[http://support.microsoft.com/kb/555417](http://support.microsoft.com/kb/555417)为例，我想出了以下内容

例子

**公共类 ImageToPictureDispConverter**

```
Inherits System.Windows.Forms.AxHost

Public Sub New()
    MyBase.New("{63109182-966B-4e3c-A8B2-8BC4A88D221C}")
End Sub

Public Function GetImageFromIPictureDisp(ByVal objImage As stdole.IPictureDisp) As System.Drawing.Image
    Dim objPicture As System.Drawing.Image
    objPicture = CType(MyBase.GetPictureFromIPicture(objImage), System.Drawing.Image)

    Return objPicture
End Function 
```

**结束类**

我在您的构造函数中看到您传递了一个空字符串。我最终不得不传递以下字符串“{63109182-966B-4e3c-A8B2-8BC4A88D221C}”。如果我传递了一个空字符串，我会收到一个 system.formatexception 错误。看起来你拥有我所拥有的一切，除了你对 base 的调用中的这个字符串。

希望这可以帮助。

# iphone - Problem in UITableView and UIScrollView

> ID：468978
> 
> 赞同：0
> 
> 时间：2009-01-22T12:47:12.080
> 
> 标签：iphone

My table has more than 10 rows with 50 row height....so i can't select my last row....so i have set UIScrollView and add this table into UIScrollView.

Table display perfectly but which rows are displayed in UIScrollView, these are not selectable.

How can i get this row selecablt in UIScrollView. If anyone body know then pls tell me wha to do?

Thanks, Haresh.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T13:07:21.620

Putting a UITableView inside a UIScrollView won't work, beause UITableView *is* a UIScrollView. You're going to have to work out why UITableView won't scroll properly for you on its own.

Check how you initialize it and look at some of Apple's example UITableView code to see what is different.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T18:56:36.313

可能是您的导航栏、工具栏或其他控件隐藏了最后一行。检查以确保 tableview 部分在另一个控件下。

# asp.net - ASP.NET: How to hide ListBox control vertical scrollbar?

> ID：468980
> 
> 赞同：0
> 
> 时间：2009-01-22T12:47:34.030
> 
> 标签：asp.net, listbox, scrollbar

I have tried CSS: overflow: auto. It doesn't work. Any way to achieve it?

Do I need to create my custom control as I have seen it on ASP.NET forum?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-04T14:08:25.427

这应该工作：

```
listBox1.Rows = listBox1.Items.Count; 
```

它导致所有项目都可见是 SELECT html 标记。如果需要，您可以将其放置到您自己的 div 集溢出并制作您自己的滚动条。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T13:56:58.790

我会像你提到的那样创建一个自定义控件。

你期望的目标是什么？创建自己的滚动条以放入列表框中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-04T20:48:23.777

这对我有用

```
listBox1.DataSource = ....
listBox1.DataBind();
listBox1.Rows = listBox1.Items.Count + 1; 
```

.

```
<div Class="divBorderCSS">
    <asp:listbox id="lbPCList" runat="server" DataTextField="Text" DataValueField="Value" selectionmode="Multiple" CssClass="lbCSS">
    </asp:listbox> 
```

.

```
.listboxCSS
{
    font-size: 8pt;
    font-family: Arial;
    border:0;
    overflow:auto;
}

.divBorderCSS
{
    border-left-width:thin;
    border-right-width: thin;
    border-top:thin;
    border-bottom: thin;
    border-color: #7F9DB9;
    border-style:solid;
    overflow:auto;
    width: 300px;
    height: 100px;
    POSITION: relative;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T15:36:51.740

试试 AJAX 控件工具包中的这个控件。

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/DropDown/DropDown.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/DropDown/DropDown.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-04T12:42:16.097

使用`jQuery`：

```
<asp:ListBox
    ClientSideEvents-Init="function(s,e){$(s.GetMainElement()).find('div:first').css('overflow','hidden');}"
    ... /> 
```

# django - 如何让 Django 输出错误字符而不是返回错误

> ID：468987
> 
> 赞同：2
> 
> 时间：2009-01-22T12:50:14.070
> 
> 标签：django

我的数据库中有一些奇怪的字符，在返回页面时似乎弄乱了 django。我得到这个错误：

```
TemplateSyntaxError at /search/legacy/

Caught an exception while rendering: Could not decode to UTF-8 column 'maker' with text 'i� G�r' 
```

（实际文字略有不同，但由于是公司名称，我已更改）

我怎样才能让 django 输出这个文本？我目前正在从 sqlite（快速开发）运行该站点，这是问题吗？

另外，在一个完全不相关的说明中，是否可以使用数据库视图？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T12:54:13.360

可能不是。

Django 在内部使用 UTF-8 字符串，您的数据库似乎返回了一些无效字符串。您应该修复数据库中的数据并在所有应用程序（数据导入、数据库、模板、源文件......）中专门使用 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T17:17:41.677

我与使用 Apple 的 iPages 进行文章创建的网站所有者有一个相关的问题，然后将复制粘贴到 Django 管理文本框中。这个过程创建了搞砸 Django 和/或 MySQL 的“有趣的字符”（你不会相信不同的双左/右引号字符的数量）。我无法“修复”客户，因此我有一个功能可以查找已知的陌生性并将其转换为以前有用的东西。一个完整的皮塔饼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T18:47:08.330

这有点令人困惑的错误消息，在不知道更多细节的情况下，我不清楚问题的根源是什么（错误消息措辞“解码为 UTF-8”似乎是错误的，因为通常你会*编码*为 UTF-8 ）。也许 Django 期望以其他编码方式查找数据，并尝试对其进行解码并重新编码为 UTF-8，但是对于某些对其期望的编码无效的字符感到窒息？

通常，您要确保将 UTF-8 存储在数据库中，并且在内部，您在代码中的任何地方都使用 unicode 对象（而不是 str 对象）。

其他一些可能有帮助的阅读材料：

*   [现实世界中的 Unicode](http://www.b-list.org/weblog/2007/nov/10/unicode/)
*   [每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)
*   [Django 提示：UTF-8、ASCII 编码错误、Urllib2 和 MySQL](http://blog.awarelabs.com/?p=70)

# logging - 如何为 log4net 指定通用应用程序数据文件夹？

> ID：468989
> 
> 赞同：35
> 
> 时间：2009-01-22T12:51:15.910
> 
> 标签：logging, log4net, environment-variables

我希望 log4net 将日志文件（使用 RollingFileAppender）写入公共应用程序数据文件夹的子文件夹（例如 C:\Documents and Settings\All Users\Application Data\Company\Product\Logs）。
但是，在 Win XP 上，没有指定此文件夹的环境变量。我们有`%ALLUSERSPROFILE%`，我们有`%APPDATA%`，但没有什么像`%ALLUSERSAPPDATA%`。
以编程方式，我可以使用`Environment.SpecialFolder.CommonApplicationData`，但我需要将它放在 log4net 配置中，如下所示：

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
   <file value="%ALLUSERSAPPDATA%\Company\Product\Logs\error.log" />
</appender> 
```

好的，我们可以在设置中定义它，但也许有人想出了更好的主意？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-12-11T17:27:40.697

我们只是使用这个：

```
<param name="File" value="${ALLUSERSPROFILE}/Company/Product/Logs/error.log"/> 
```

它工作得很好。

* * *

这一行可以简单地插入到你当前的 appender 配置中：

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
   <param name="File" value="${ALLUSERSPROFILE}/Company/Product/Logs/error.log"/>
</appender> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-22T13:00:59.963

[log4net 邮件列表上的这篇文章](http://marc.info/?l=log4net-user&m=110142086820117&w=2)解释了如何定义自己的路径替换变量。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-12-08T16:36:42.677

这是[pilif](https://stackoverflow.com/questions/468989/how-to-specifiy-common-application-data-folder-for-log4net/469017#469017)链接到的 log4net 邮件列表中的完整代码：

基本上，该方法是为 log4net 配置文件实现自定义模式转换器。

首先将此类添加到您的项目中：

```
public class SpecialFolderPatternConverter : log4net.Util.PatternConverter
{
    override protected void Convert(System.IO.TextWriter writer, object state)
    {
        Environment.SpecialFolder specialFolder = (Environment.SpecialFolder)Enum.Parse(typeof(Environment.SpecialFolder), base.Option, true);
        writer.Write(Environment.GetFolderPath(specialFolder));
    }
} 
```

然后设置 FileAppender 的 File 参数，如下所示：

```
<file type="log4net.Util.PatternString">
    <converter>
      <name value="folder" />
      <type value="MyAppName.SpecialFolderPatternConverter,MyAppName" />
    </converter>
    <conversionPattern value="%folder{CommonApplicationData}\\SomeOtherFolder\\log.txt" />
</file> 
```

基本上，`%folder`它告诉它查看调用的转换器，该转换器将`folder`其指向 SpecialFolderPatternConverter 类。然后它调用`Convert`该类，传入 CommonApplicationData（或其他）枚举值。

显然，在 log4net (1.2.11) 的下一个版本中，将有一个更简单的方法，如此[处](https://stackoverflow.com/questions/1535736/log4net-how-can-i-change-the-file-location-programmatically-c/1535998#1535998)所述。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-09-13T16:46:43.953

在当前的 log4net 版本（2.0.8.0）中，您可以简单地使用

`<file value="${ProgramData}\myFolder\LogFiles\" />`为了`C:\ProgramData`

`${LocalAppData}`为了`C:\Users\user\AppData\Local\`

并且`${AppData}`对于`C:\Users\user\AppData\Roaming\`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-12T18:09:31.217

完整且有效的解决方案 - 我的 Log4net.config 文件的内容。在 Log4Net 的实际版本中，不再需要编写自己的模式转换器

```
<?xml version="1.0"?>
<log4net>
  <root>
    <level value="INFO" />
    <appender-ref ref="LogFileAppender" />
  </root>
  <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender" >
    <file type="log4net.Util.PatternString" value="%envFolderPath{CommonApplicationData}\\MyProject\\Logs\\log.txt" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="10" />
    <maximumFileSize value="100MB" />
    <layout type="log4net.Layout.PatternLayout">
      <ConversionPattern type="log4net.Util.PatternString" value="%%-5p %%d{yyyy-MM-dd HH:mm:ss} - %%m%%n" />
    </layout>
  </appender>
</log4net> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-19T11:01:30.400

现在（2018 年 2 月）根据 log4net 版本 2.0.8.0。

您可以不使用任何转换器来获取环境变量，如下所示。

```
<file type="log4net.Util.PatternString" value="%envFolderPath{CommonApplicationData}\\mylogfile.txt" /> 
```

有关详细信息，请参阅：[log4net.Util.PatternString](http://logging.apache.org/log4net/release/sdk/?topic=html/T_log4net_Util_PatternString.htm)类文档。

# sql - 如何在 Oracle 中将多行组合成逗号分隔的列表？

> ID：468990
> 
> 赞同：116
> 
> 时间：2009-01-22T12:51:39.730
> 
> 标签：sql, oracle, concatenation, pivot, string-aggregation

我有一个简单的查询：

```
select * from countries 
```

结果如下：

```
country_name
------------
Albania
Andorra
Antigua
..... 
```

我想在一行中返回结果，所以像这样：

```
Albania, Andorra, Antigua, ... 
```

当然，我可以编写一个 PL/SQL 函数来完成这项工作（我已经在 Oracle 10g 中做过），但是对于这个任务有没有更好的，最好是非 Oracle 特定的解决方案（或者可能是一个内置函数） ?

我通常会使用它来避免子查询中的多行，因此如果一个人拥有多个公民身份，我不希望她/他在列表中重复。

我的问题基于[SQL server 2005](https://stackoverflow.com/questions/180032/how-can-i-combine-multiple-rows-into-a-comma-delimited-list-in-sql-server-2005)上的类似问题。

**更新**：我的函数如下所示：

```
CREATE OR REPLACE FUNCTION APPEND_FIELD (sqlstr in varchar2, sep in varchar2 ) return varchar2 is
ret varchar2(4000) := '';
TYPE cur_typ IS REF CURSOR;
rec cur_typ;
field varchar2(4000);
begin
     OPEN rec FOR sqlstr;
     LOOP
         FETCH rec INTO field;
         EXIT WHEN rec%NOTFOUND;
         ret := ret || field || sep;
     END LOOP;
     if length(ret) = 0 then
          RETURN '';
     else
          RETURN substr(ret,1,length(ret)-length(sep));
     end if;
end; 
```

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2011-07-27T17:12:51.633

该`WM_CONCAT`函数（如果包含在您的数据库中，Oracle 11.2 之前的版本）或`LISTAGG`（从 Oracle 11.2 开始）应该可以很好地解决问题。例如，这将获取架构中表名的逗号分隔列表：

```
select listagg(table_name, ', ') within group (order by table_name) 
  from user_tables; 
```

或者

```
select wm_concat(table_name) 
  from user_tables; 
```

[更多细节/选项](http://www.oracle-base.com/articles/misc/StringAggregationTechniques.php)

[链接到文档](http://docs.oracle.com/cd/E11882_01/server.112/e10592/functions089.htm)

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-01-22T20:24:40.910

这是一种无需散列或创建函数的简单方法。

```
create table countries ( country_name varchar2 (100));

insert into countries values ('Albania');

insert into countries values ('Andorra');

insert into countries values ('Antigua');

SELECT SUBSTR (SYS_CONNECT_BY_PATH (country_name , ','), 2) csv
      FROM (SELECT country_name , ROW_NUMBER () OVER (ORDER BY country_name ) rn,
                   COUNT (*) OVER () cnt
              FROM countries)
     WHERE rn = cnt
START WITH rn = 1
CONNECT BY rn = PRIOR rn + 1;

CSV                                                                             
--------------------------
Albania,Andorra,Antigua                                                         

1 row selected. 
```

正如其他人所提到的，如果您使用的是 11g R2 或更高版本，您现在可以使用更简单的 listagg。

```
select listagg(country_name,', ') within group(order by country_name) csv
  from countries;

CSV                                                                             
--------------------------
Albania, Andorra, Antigua

1 row selected. 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-08-23T17:21:22.643

对于 Oracle，您可以使用[LISTAGG](https://docs.oracle.com/cd/E11882_01/server.112/e41084/functions089.htm#SQLRF30030)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-10-26T19:02:42.923

您也可以使用它：

```
SELECT RTRIM (
          XMLAGG (XMLELEMENT (e, country_name || ',')).EXTRACT ('//text()'),
          ',')
          country_name
  FROM countries; 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-03-15T13:14:31.140

你可以试试这个查询。

```
select listagg(country_name,',') within group (order by country_name) cnt 
from countries; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-22T13:10:05.140

最快的方法是使用 Oracle 收集功能。

你也可以这样做：

```
select *
  2    from (
  3  select deptno,
  4         case when row_number() over (partition by deptno order by ename)=1
  5             then stragg(ename) over
  6                  (partition by deptno
  7                       order by ename
  8                         rows between unbounded preceding
  9                                  and unbounded following)
 10         end enames
 11    from emp
 12         )
 13   where enames is not null 
```

访问该站点询问 tom 并搜索 'stragg' 或 'string concatenation' 。很多例子。还有一个未记录的 oracle 函数可以满足您的需求。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-26T06:24:16.470

我需要类似的东西并找到以下解决方案。

```
select RTRIM(XMLAGG(XMLELEMENT(e,country_name || ',')).EXTRACT('//text()'),',') country_name from 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-11-16T22:09:05.787

在此示例中，我们正在创建一个函数，以将不同行级别 AP 发票保留原因的逗号分隔列表带入一个字段以进行抬头级别查询：

```
 FUNCTION getHoldReasonsByInvoiceId (p_InvoiceId IN NUMBER) RETURN VARCHAR2

  IS

  v_HoldReasons   VARCHAR2 (1000);

  v_Count         NUMBER := 0;

  CURSOR v_HoldsCusror (p2_InvoiceId IN NUMBER)
   IS
     SELECT DISTINCT hold_reason
       FROM ap.AP_HOLDS_ALL APH
      WHERE status_flag NOT IN ('R') AND invoice_id = p2_InvoiceId;
BEGIN

  v_HoldReasons := ' ';

  FOR rHR IN v_HoldsCusror (p_InvoiceId)
  LOOP
     v_Count := v_COunt + 1;

     IF (v_Count = 1)
     THEN
        v_HoldReasons := rHR.hold_reason;
     ELSE
        v_HoldReasons := v_HoldReasons || ', ' || rHR.hold_reason;
     END IF;
  END LOOP;

  RETURN v_HoldReasons;
END; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-22T13:13:56.300

我总是为此编写一些 PL/SQL，或者我只是将一个“，”连接到该字段并复制到编辑器中，然后从列表中删除 CR，给我一行。

那是，

```
select country_name||', ' country from countries 
```

双向有点冗长。

如果您查看 Ask Tom，您会看到大量可能的解决方案，但它们都恢复为类型声明和/或 PL/SQL

[问汤姆](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:2196162600402)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-27T06:10:43.653

```
SELECT REPLACE(REPLACE
((SELECT     TOP (100) PERCENT country_name + ', ' AS CountryName
FROM         country_name
ORDER BY country_name FOR XML PATH('')), 
'&<CountryName>', ''), '&<CountryName>', '') AS CountryNames 
```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2011-11-04T12:04:17.207

您可以使用此查询来完成上述任务

```
DECLARE @test NVARCHAR(max)
SELECT @test = COALESCE(@test + ',', '') + field2 FROM #test SELECT field2= @test 
```

有关详细信息和分步说明，请访问以下链接
[http://oops-solution.blogspot.com/2011/11/sql-server-convert-table-column-data.html](http://oops-solution.blogspot.com/2011/11/sql-server-convert-table-column-data.html)

# wcf - wcf System.ServiceModel.AddressAlreadyInUseException

> ID：468991
> 
> 赞同：2
> 
> 时间：2009-01-22T12:51:46.987
> 
> 标签：wcf, httpcfg.exe

如果此问题在 stackOverflow 上出现两次，我们深表歉意

我试图在 Windows Server 2003 机器上运行 wcf 服务。当服务主机调用 Open() 时，我得到一个**System.ServiceModel.AddressAlreadyInUseException**异常，它告诉我以下错误：

> HTTP 无法注册 URL [http://+:8080/LogoResizer/mex/](http://+:8080/LogoResizer/mex/)因为 TCP 端口 8080 正在被另一个应用程序使用

我读到我需要使用 httpcfg.exe 来注册我的命名空间，并且我使用了[这里](http://blogs.msdn.com/paulwh/archive/2007/05/04/addressaccessdeniedexception-http-could-not-register-url-http-8080.aspx)找到的 GUI 工具来完成它，但我仍然得到上述异常。运行“netstat -a”不会显示在端口 8080 上侦听的任何其他内容并运行“httpcfg.exe query urlacl”会返回以下已注册的命名空间。

> C:\Program Files\Support Tools>httpcfg 查询 urlacl URL：[http://+:80/Temporary_Listen_Addresses/](http://+:80/Temporary_Listen_Addresses/)
> 
> ## ACL : D:(A;;GX;;;WD)

```
URL : http://+:8080/LogoResizer/ 
```

## ACL : D:(A;;GX;;;WD)

```
URL : http://+:8080/LogoResizer/mex/ 
```

## ACL : D:(A;;GX;;;WD)

我的应用程序的配置如下：

```
<system.serviceModel>
    <bindings>
        <netTcpBinding>
            <binding name="NetTcpBinding_ImageResizerServiceContract" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
                hostNameComparisonMode="StrongWildcard" listenBacklog="10"
                maxBufferPoolSize="2147483647" maxBufferSize="2147483647" maxConnections="10"
                maxReceivedMessageSize="2147483647">
                <readerQuotas maxDepth="2147483647"
                              maxStringContentLength="2147483647"
                              maxArrayLength="2147483647"
                              maxBytesPerRead="2147483647"
                              maxNameTableCharCount="2147483647" />
                <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="false" />
                <security mode="Transport">
                    <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
                    <message clientCredentialType="Windows" />
                </security>
            </binding>

        </netTcpBinding>
    </bindings>
    <behaviors>
        <serviceBehaviors>
            <behavior name="ServiceBehavior">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <services>
        <service name="LogoResizer.WCF.ServiceTypes.ImageResizerService" behaviorConfiguration="ServiceBehavior">
            <host>
                <baseAddresses>
                    <add baseAddress="http://localhost:900/mex/"/>
                    <add baseAddress="net.tcp://localhost:9000/" />
                </baseAddresses>
            </host>
            <endpoint bindingConfiguration="NetTcpBinding_ImageResizerServiceContract" binding="netTcpBinding" contract="LogoResizer.WCF.ServiceContracts.IImageResizerService" />
            <endpoint  address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
        </service>
    </services>
</system.serviceModel> 
```

有谁知道我做错了什么或如何注册我的命名空间以便我可以为我的服务提供一个 http 端点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T15:34:29.887

解决了。

问题是我的两个端点都在同一个端口上运行。在 windows XP 下开发时这不是问题，但会给你我写的尝试在 Vista 或 windows server 2003 下运行服务时的例外情况。我只需要将我的服务器配置更新为以下

```
 <baseAddresses>
                                    <add baseAddress="http://localhost:9000/mex/"/>
                                    <add baseAddress="net.tcp://localhost:9001/" />
                            </baseAddresses> 
```

# javascript - 有没有办法在 Android 中为 Safari 启用 JavaScript 错误/调试控制台？

> ID：468993
> 
> 赞同：43
> 
> 时间：2009-01-22T12:52:33.457
> 
> 标签：javascript, android, safari

我正在开发一个需要在 Google Android Phone OS 上运行的 JavaScript 应用程序。有没有办法在 Android 模拟器或实际设备上的 Safari 中启用 JavaScript 错误/调试控制台？如果是这样，任何有关如何执行此操作的说明将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-01-06T17:35:31.160

看起来，使用 Android 2.0.1 SDK，您需要过滤“浏览器”而不是“WebCore”

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-28T13:31:30.170

一个快速的谷歌出现了这篇[博](https://web.archive.org/web/20120413212614/http://www.nanaze.com/2009/01/debugging-javascript-on-android.html)文（在你提出问题后发布），至少应该让你通过 Android Debug Bridge 使用以下命令查看任何 Javascript 错误：

```
adb logcat WebCore:V *:S 
```

不过，与完整的调试控制台不太一样。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-06-14T14:22:25.303

在 Android 上，当当前页面是您要调试的页面时，在地址行上写 about:debug。您将可以访问控制台。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-05-16T02:28:23.007

我知道您的问题是关于 Safari 的，但您可能想考虑改用 Chrome。您现在可以使用 Chrome 的桌面开发者工具在您的 Android 设备上调试和配置应用程序。

就是这样：

1.  在*Android* Chrome 上，转到设置 -> 开发人员工具并选中“**启用 USB Web 调试**”
2.  在桌面上，运行`adb forward tcp:9222 localabstract:chrome_devtools_remote`
3.  现在在*桌面*Chrome 上，导航到 localhost:9222。

您应该会看到您在手机上打开的页面列表。单击要调试/配置文件的那个。

详细说明在[这里](https://developers.google.com/chrome/mobile/docs/debugging)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-05-30T15:25:13.253

我发现你可以在手机上获得这个调试信息，不需要使用 adb 或将其插入计算机，只需下载一个日志查看器。

检查[链接](http://www.technomancy.org/android/javascript-debugging/)以获取更多信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-30T10:46:20.230

您可以使用 weinre 查看日志等等

来自[Weinre 文档](http://people.apache.org/~pmuellr/weinre/docs/latest/)

> *weinre 是一个网页调试器，例如 FireBug（用于 FireFox）和 Web Inspector（用于基于 WebKit 的浏览器），但它被设计为**远程**工作，特别是**允许您在手机等移动设备上调试网页**.*

# vim - vimgrep 和 make 的不同 quickfix 缓冲区

> ID：468997
> 
> 赞同：4
> 
> 时间：2009-01-22T12:54:06.683
> 
> 标签：vim, makefile, grep

在`make`Vim 下 -ing 时，通常需要`vimgrep`文件。在这种情况下，`vimgrep`接管了快速修复缓冲区，因此需要重新制作以浏览剩余的编译器错误。

有没有办法避免这种混乱？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T13:08:56.983

您应该看看`:cold[er]`（转到较旧的错误列表）和`:cnew[er]`（转到较新的错误列表）；见[`:h quickfix-error-lists`](http://vimdoc.sourceforge.net/cgi-bin/help?tag=quickfix-error-lists)。

这是一个如何集成它的想法：

```
nnoremap <expr> <F11> (&ft=='qf' ? ":colder" : ":bprev")."\<cr>" 
nnoremap <expr> <F12> (&ft=='qf' ? ":cnewer" : ":bnext")."\<cr>" 
```

`F11`(/ `F12`) 将转到大多数缓冲区的上一个 (/next) 缓冲区，或者转到 quickfix 缓冲区中较旧的 (/newer) 错误列表。********************