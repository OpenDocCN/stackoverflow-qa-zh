# StackOverflow 问答 000942000-000942999

# .net - 使用 Visual Studio 和 .NET 跟踪构建中的文件级版本控制？

> ID：942005
> 
> 赞同：1
> 
> 时间：2009-06-02T21:27:08.410
> 
> 标签：.net, version-control, assemblies, versioning, clearcase

我想要一个工具或技术能够回答“什么版本的文件 X 用于构建 Assembly abc.dll？”这个问题。我最近搬到了一个 .NET 开发小组，似乎这个问题一直以一种或另一种形式出现，我们还没有完全掌握它。有人会说“嘿，你的最新代码在测试服务器上吗？” 答案不可避免地是“我不知道”。

回到过去的 Unix 开发时代（我在这里约会自己），SCCS 源代码控制系统有[特殊的关键字](http://docs.sun.com/app/docs/doc/816-0210/6m6nb7mkd?a=view#USAGE)，例如 %I%（版本）和 %M%（模块名称），您可以将它们放在文件中，即只要文件被签出，就会被适当的 SCCS 版本信息替换。因此，您可以做的一个巧妙的技巧是在源文件中为“%I% %M%”分配一个常量字符串，编译，然后在生成的库上运行[Unix“strings”命令](http://linux.about.com/library/cmd/blcmdl1_strings.htm)以确定使用了哪些文件的版本构建该文件。

我做了一个快速测试，在 C# 类文件中滚动我自己，如下所示：

```
public const String VERSION_STRING = "*VERSION* = MyClass 1.0"; 
```

然后在我的 DLL 目录上运行这个命令行：

```
>for %f in (*.dll) do find "VERSION" %f 
```

但结果是：

```
---------- MYASSEMBLY.DLL
VERSION_STRING 
```

这不是我所追求的（它给了我常量的名称，但没有我试图手动嵌入到类中的版本信息）。

对于它的价值，我们目前正在使用 Clearcase 进行版本控制（目前是公司标准）。Clearcase 有一些工具可以帮助我们（例如[clearaudit](http://www.ipnom.com/ClearCase-Commands/clearaudit.html)），但这需要一些努力来完善和重新构建我们的构建过程。我还应该提到我们正在考虑试行颠覆。所以我猜想在任何各种版本控制系统或构建环境（MSBuild、NAnt、CruiseControl）中使用 .NET 的解决方案都是公平的游戏。

是否有任何其他解决方案，特别是以 .NET 为中心的解决方案，用于跟踪哪个文件的哪个版本进入了哪个程序集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:00:05.000

我对 SubVersion 和 CC.NET 持续集成服务器有积极的经验。

您已经设置了一个 NAnt 目标来获取最新的（它可以在此处锁定存储库），然后构建。构建完成后，它会在 SVN 中创建一个版本标签。

在构建时，可以很容易地从标签的版本中推断出文件的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:07:43.860

我们很快放弃了使用特殊关键字的想法，因为将元数据（如版本号）集成到数据（存储在 VCS 中的文件）中通常不是一个好主意（参见这个 SO 问题中的辩论：“[嵌入式版本号- 好还是坏？](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know/645424#645424) ”）

我们的方法是使用此类信息构建“发布说明”。然后将这个简单的文本文件与构建 dll 一起存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:34:13.140

对于我的“社区”工作，我使用了一个简单的方案；我使用 SVN 修订号作为程序集的`[AssemblyVersion]`/`[AssemblyFileVersion]`属性中的构建版本。在运行时和通过资源管理器查询这些都非常容易，更新它们的脚本也很容易——[这里](http://code.google.com/p/protobuf-net/source/browse/trunk/buildkit35.build)的前几个任务。

# ruby-on-rails - Rails 应用程序没有哪些宝石可以生存？

> ID：942006
> 
> 赞同：0
> 
> 时间：2009-06-02T21:27:10.937
> 
> 标签：ruby-on-rails, ruby, rubygems, minimize

*   动作邮件
*   动作包
*   主动资源
*   积极支持

我有一个基本的脚手架 CRUD 应用程序，它使用 ActiveRecord 连接到 SQLite 数据库，并且我已经冻结了我的 Rails gem。

**我可以删除哪些 gem 而不影响我的应用程序？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T21:41:20.380

如果你从不使用电子邮件，ActionMailer 可以使用，而 ActiveResource 只是一个比 ActiveRecord 更符合 REST 的 Rails API。你需要剩下的：

*   ActionPack 处理对控制器和视图的 Web 请求拆分
*   ActiveSupport 将大量来自 Ruby 的 mixin 和语法糖放入 Rails

但更重要的是，为什么需要删除宝石？这不像他们占用很多空间。

# javascript - 如何防止用户生成的 HTML 中的 Javascript 注入攻击

> ID：942011
> 
> 赞同：61
> 
> 时间：2009-06-02T21:29:05.647
> 
> 标签：javascript, html, regex, parsing, code-injection

我正在保存用户提交的 HTML（在数据库中）。我必须防止 JavaScript 注入攻击。我见过的最有害的是`style="expression(...)"`.

除此之外，相当数量的有效用户内容将包括特殊字符和 XML 结构，因此我希望尽可能避免使用白名单方法。（列出每个允许的 HTML 元素和属性）。

JavaScript 攻击字符串示例：

1.

```
"Hello, I have a
&lt;script&gt;alert("bad!")&lt;/script&gt;
problem with the &lt;dog&gt;
element..." 
```

```
"Hi, this &lt;b
style="width:expression(alert('bad!'))"&gt;dog&lt;/b&gt;
is black." 
```

有没有办法阻止这样的 JavaScript，并保持其余部分完好无损？

到目前为止，我唯一的解决方案是使用正则表达式来删除某些模式。它解决了案例 1，但没有解决案例 2。

该环境本质上是 Microsoft 堆栈：

*   SQL 服务器 2005
*   C# 3.5 (ASP.NET)
*   JavaScript 和 jQuery。

我希望阻塞点是 ASP.NET 层——任何人都可以制作一个糟糕的 HTTP 请求。

### 编辑

谢谢大家的链接。假设我可以定义我的列表（内容将包括许多数学和编程结构，所以白名单会很烦人），我还有一个问题：

什么样的解析器可以让我只删除“坏”部分？坏的部分可能是整个元素，但是那些驻留在属性中的脚本呢？我不能随意删除`< a hrefs >`。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-02T21:35:40.360

你认为是这样吗？[看看这个](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)。

无论您采用哪种方法，您都绝对需要使用白名单。这是甚至接近安全的唯一方法，您允许在您的网站上允许的内容。

**编辑**：

不幸的是，我不熟悉 .NET，但您可以查看 stackoverflow 自己与 XSS 的战斗（[https://blog.stackoverflow.com/2008/06/safe-html-and-xss/](https://blog.stackoverflow.com/2008/06/safe-html-and-xss/)）和代码编写用于解析此站点上发布的 HTML：[Archive.org 链接](https://web.archive.org/web/20120606051450/http://refactormycode.com/codes/333-sanitize-html)- 显然您可能需要更改此设置，因为您的白名单更大，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T21:41:10.003

在我看来，元素和属性的白名单是*唯一可以接受的选择。*任何不在您的白名单上的内容都应该被删除或编码（将 <>&" 更改为实体）。另外，请务必检查您允许的属性内的值。

少一点，你就会面临问题——已知的漏洞或将来会发现的漏洞。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T21:50:13.543

唯一真正安全的方法是使用白名单。对所有内容进行编码，然后将允许的代码转换回来。

我见过相当先进的尝试只禁止危险代码，但它仍然不能很好地工作。尝试安全地捕捉任何人能想到的*一切都是*一项壮举，而且很容易对一些根本不危险的东西进行烦人的替换。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-09-13T12:13:13.000

目前最好的选择是使用这样的**[内容安全策略](https://content-security-policy.com/)**标头：

```
Content-Security-Policy: default-src 'self'; 
```

这将阻止加载内联和外部脚本、样式、图像等，因此浏览器只会加载和执行来自同一来源的资源。

**但是，它不适用于旧浏览器。**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T21:45:11.650

基本上，正如 Paolo 所说，您应该尝试关注用户被允许做的事情，而不是试图过滤掉他们不应该做的事情。

保留允许的 HTML 标签列表（例如 b、i、u...）并过滤掉其他所有标签。您可能还想删除允许的 HTML 标记的所有属性（例如，因为您的第二个示例）。

另一个解决方案是引入所谓的 BB 代码，这是很多论坛使用的。它具有与 HTML 相似的语法，但从允许代码的白名单的想法开始，然后将其转换为 HTML。例如， [b]example[/b] 将导致**example**。确保在使用 BB 代码时仍然事先过滤掉 HTML 标签。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T21:41:52.467

您使用的是什么服务器端代码？取决于您可以过滤掉恶意脚本的数量或方法，但这是危险的领域。即使是经验丰富的专业人士也会被抓住： http: [//www.codinghorror.com/blog/archives/001167.html](http://www.codinghorror.com/blog/archives/001167.html)

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2015-01-28T06:42:58.280

您可以使用此限制功能。

```
function restrict(elem){
  var tf = _(elem);
  var rx = new RegExp;
  if(elem == "email"){
       rx = /[ '"]/gi;
  }else if(elem == "search" || elem == "comment"){
    rx = /[^a-z 0-9.,?]/gi;
  }else{
      rx =  /[^a-z0-9]/gi;
  }
  tf.value = tf.value.replace(rx , "" );
} 
```

# java - 用于 Java 和 .NET 的测试和模拟框架

> ID：942019
> 
> 赞同：4
> 
> 时间：2009-06-02T21:31:12.117
> 
> 标签：java, .net, tdd, mocking, testing

我想知道您对广泛使用并且在 Java 和 .NET 之间具有良好兼容性的测试/模拟框架的想法。我的意思是，我想学习那些在 .NET 项目中使用的工具，但我仍然希望能够将这些知识应用到 Java 项目中。

*   我知道有很多关于这些平台的测试/模拟框架的问题，特别是在 SO 中，但我没有找到一个问题来比较这些框架在这两个平台中的相似性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:33:52.670

N/J 系列框架（[**NUnit**](http://nunit.org) / **[JUnit](http://www.junit.org)**、[**NMock**](http://www.nmock.org) / [**JMock**](http://www.jmock.org/)等）通常是彼此的并行端口或基于相同的启动原理。这些肯定会让你在他们之间转移至少一些你的知识。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T12:19:40.603

我建议您查看[Moq](http://moq.me/)以在 .NET 中进行模拟。它在概念上与 Java 端的 Mockito 非常相似。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T07:38:01.310

这是我从 Java 方面的经验中看到的。

**单元测试框架**

至于 Java 中的单元测试，几乎每个人都在使用 JUnit，而在使用注释的 JUnit 4.0 中，我知道它现在更像 NUnit。

**模拟框架**

我们在我们的项目中使用[EasyMock](http://easymock.org/)大约有半年时间，我们确定它占用了我们很多时间来完成简单的任务。实际上，我们开了很多玩笑说 EasyMock 并不容易。

在参加了关于模拟框架的讲座后，我决定使用[Mockito](http://www.mockito.org)并且从未回头。它允许无痛地进行部分模拟——EasyMock 需要一个单独的库来实现这一点。此外，Mockito 有更好的错误消息。当你做错事时，它会给你详细的错误，说明你是如何违反 Mockito 的合同的。

不管怎样，试一试，我想你会同意 Mockito 是一个明显的赢家。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T21:33:35.900

我们将 RhinoMocks 和 NUnit 用于我们的 .NET 项目。JUnit 将成为 Java 的替代品

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-22T22:13:47.780

NMock 远不是 .NET 世界中最好的模拟框架。它是基于字符串的：

```
Expect.Once.On(mockView).GetProperty("FromAccount").Will(Return.Value("1234")); 
```

我强烈建议使用更新的东西，例如[Rhino.Mocks](http://www.ayende.com/projects/rhino-mocks.aspx)：

```
Expect.Call(mockView.FromAccount).Returns("1234"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-03T03:27:41.093

首先，区分*测试*和*模拟*的概念很重要。对于**单元测试**（驱动测试），**JUnit**（用于 Java）和**NUnit**（用于 .NET）是最流行的选择。模拟（或隔离）框架的情况更加复杂。

**模拟框架**分为两个阵营，我喜欢称之为“常规”和“替代”。

传统框架主要依赖于可测试性和依赖注入的设计。替代框架依赖于[Profiling API](http://msdn.microsoft.com/en-us/library/ms404386.aspx)或 Java 5 SE 工具特性（java.lang.instrument 包）在运行时修改 CIL 或字节码，这使得任何依赖项都可以模拟。

此类替代网络的示例是[Typemock Isolator](http://learn.typemock.com/Downloads.php)（用于 .NET）和[JMockit](https://jmockit.dev.java.net/)（用于 Java）（Typemock 不是免费的，除非您在开源项目中使用它。）

至于**.NET 的传统模拟框架**，目前最流行的两个是[RhinoMocks](http://www.ayende.com/projects/rhino-mocks.aspx)和[Moq](http://code.google.com/p/moq/)。两者都严重依赖 C# 3.0 特性，尤其是 lambda 语法，以允许模拟对象行为和期望的简明规范。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T22:05:46.960

我在一些 Java 项目中使用过[EasyMock](http://easymock.org/)，我非常喜欢它。似乎有一个[.net 端口](http://sourceforge.net/projects/easymocknet/)，但我个人还没有使用它。

关于单元测试，我使用[JUnit](http://www.junit.org/) 4.x，与 3.x 相比，它有一些不错的扩展。我猜[NUnit](http://nunit.org/)提供了类似的功能，但也没有使用过。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T07:45:02.763

我们使用 MbUnit 和 Rhino.Mocks 进行测试。我很喜欢。

我们使用 MbUnit 的原因是反射器。也许它也可以在 NUnit 中找到，但我首先在 MbUnit 中找到它；）

# c# - 如何将数据放入母版页？

> ID：942020
> 
> 赞同：8
> 
> 时间：2009-06-02T21:32:42.923
> 
> 标签：c#, asp.net-mvc, master-pages

如何将 ASP.NET MVC 中的强类型对象放入母版页？

您是否有一个`ViewModelBase`包含母版页信息并为每个视图模型从其继承的类，还是有更好的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T04:41:09.950

亚历克斯，

我想您要问的是，“我的母版页控制器在哪里？”

看看下面的链接。它解释了如何创建“应用程序控制器”，这是一个可以被其他控制器继承的抽象类，因此您只需编写一次将所需母版页数据推送到视图中的代码。

传递数据以查看母版页：
[http ://www.asp.net/learn/MVC/tutorial-13-cs.aspx](http://www.asp.net/learn/MVC/tutorial-13-cs.aspx)

另外，看看下面的链接，它解释了如何在 ASP.NET MVC 中实现部分视图和子控制器：

ASP.NET MVC 中的部分请求
[http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T13:53:06.407

这正是我使用的方法。有一个 MasterViewData 基类，其中包含所有页面可能共有的信息，并用于呈现母版页（在不使用内置身份验证、页面级消息时登录用户）。我所有的其他视图数据类都派生自它。

我也做了罗伯特提到的事情：我有一个重写 View 方法的基本控制器类，它实际上处理将一些母版页信息放入 viewdata 类。

我很好奇是否还有其他选择，但这种方法对我来说肯定效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-26T18:04:04.860

我们使用类似的基础 ViewData，特别是对于大型的面向内容的公共站点，在这些站点中您有很多常见的 UI 内容。

我们用来注入公共位的技巧是使用 ActionFilter 在我们的控制器返回周围注入 MasterPageViewModel。这比拥有一个带有重写视图方法的特殊控制器类要干净得多，因为肯定有你不想要/不需要它的地方。以及继承的整个组合。

# java - Hibernate/JPA - 注释 bean 方法与字段

> ID：942035
> 
> 赞同：37
> 
> 时间：2009-06-02T21:37:10.527
> 
> 标签：java, hibernate, orm, jpa

我有一个关于 Hibernate 使用的简单问题。我不断看到人们以两种方式之一使用 JPA 注释，即注释类的字段以及注释相应 bean 上的 get 方法。

我的问题如下：使用JPA注释（例如@Id）注释字段和bean方法之间是否有区别。

例子：

```
@Entity
public class User
{

**@ID**
private int id;

public int getId(){
return this.id;
}

public void setId(int id){
this.id=id;
}

} 
```

- - - - - -或者 - - - - - -

```
@Entity
public class User
{

private int id;

**@ID**
public int getId(){
return this.id;
}

public void setId(int id){
this.id=id;
}

} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-02T22:41:16.343

是的，如果您注释字段，Hibernate 将使用字段访问来设置和获取这些字段。如果您对方法进行注释，hibernate 将使用 getter 和 setter。Hibernate 将根据`@Id`注释的位置选择访问方法，据我所知，您不能混用和匹配。如果您使用 注释字段`@Id`，则方法上的注释将被忽略，反之亦然。您也可以使用类级别注释手动设置方法 `@AccessType`

[Hibernate Annotations 参考指南](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/)已被证明是解决此类问题的非常有用的资源，并详细说明了访问类型如何向下级联。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-02T22:42:47.697

是的，我相信您想搜索字段与属性访问：

[Hibernate Annotations - 哪个更好，字段访问还是属性访问？](https://stackoverflow.com/questions/594597/hibernate-annotations-which-is-better-field-or-property-access)

Spring 首选项是[field access](http://static.springframework.org/spring/docs/2.5.x/reference/orm.html)。这就是我所遵循的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-10T11:49:05.310

我的建议是注释方法。通过这样做，您可以获得一点灵活性。例如，假设您有几个类：

*   `AbstractEntity`
*   `StringIdEntity`
*   `AutoIdEntity`

`AbstractEntity`定义 id 字段/getter/setter。类`StringIdEntity`和`AutoIdEntity`继承自`AbstractEntity`，但使用不同的`@Id`策略。如果您注释该字段，则不能将其从类更改为另一个。

如果您注释方法，您标记`getId()`为`@Transient/abstract`in`AbstractEntity`然后在子类中，您只需覆盖该方法并应用您希望使用的策略。我曾经自己注释字段并遇到了这个问题，并决定我将始终注释前进的方法。

因此，即使您没有立即看到注释方法的好处，但当您拥有如此多的类时，切换将变得绝对令人头疼，这可能会变得很明显。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-12-06T06:32:33.557

为什么要注释访问器？它看起来很凌乱，维护起来很痛苦。现在我必须在全班范围内寻找 JPA 或 Hibernate 是如何应用的。当为 Eclipse 使用一些 Hibernate 代码生成插件时，这是默认设置，它让我发疯。

更不用说我们使用访问器的另一个原因是向属性访问或引用父对象或其他与所述注释不能很好融合的对象添加逻辑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-27T04:34:06.437

有几个讨论可以提供使用 FIELD 而非属性的优势（参见 - [http://java.dzone.com/tips/12-feb-jpa-20-why-accesstype](http://java.dzone.com/tips/12-feb-jpa-20-why-accesstype)）。甚至 spring 框架也建议使用 FIELD over property（参见 - [http://static.springsource.org/spring/docs/2.5.x/reference/orm.html](http://static.springsource.org/spring/docs/2.5.x/reference/orm.html)）。我发现 FIELD 的方法更简洁，不仅因为您不必强制实现 setter/getter，而且您可以在课堂上使用自定义类型的 setter/getter。所以更好的封装和更干净的类。性能方面 FIELD 比 PROPERTY 有一点优势，但可以忽略不计。

在一行中使用 FIELD over PROPERTY。如果你真的需要它，请使用 PROPERTY。

# asp.net - MasterPage 使用 Masterpages 和继承

> ID：942036
> 
> 赞同：7
> 
> 时间：2009-06-02T21:38:41.617
> 
> 标签：asp.net, master-pages

我有一个“主”母版页，还有两个“子”母版页。这 2 个子将其母版页属性设置为“母版”母版页。到目前为止一切都很好。

好吧，我今天被告知还要使 Sub1 和 Sub2 实际上从 Master Masterpage 中“继承”。我认为他们的语言不准确，但不，她希望我将 Class 定义更改为

```
public partial class Sub2 : TheMaster 
```

（那些不是名字）。

所以，现在我有 Sub1 和 Sub2 是母版页，并且有 TheMaster 的母版页，而且它们属于“TheMaster”类

我对此感到很困惑，不确定这会产生什么样的影响。它现在似乎编译和运行良好，但我们今天才开始这个为期 6 个月的项目，我不想到第 5 个月才发现我们有一个重大的设计缺陷。

谁能告诉我这完全没问题，或者我们完全搞砸了？

我害怕……抱紧我。

编辑：澄清——她希望我也从母版页继承的原因是我们在该页中设置了一些东西，我们希望它们可用于子母版页。诸如呈现页面所在的站点地图中的当前节点、一些用户帐户的内容等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:45:44.393

确实可以嵌套母版页 - 请参阅[http://msdn.microsoft.com/en-us/library/x2b3ktt7.aspx](http://msdn.microsoft.com/en-us/library/x2b3ktt7.aspx)以获取参考。

*根据评论编辑*

我不相信您的子母版页应该从后面代码中的主母版页继承。

每个母版页，包括子母版页都应该直接从 MasterPage 继承，即`public partial class Sub1 : System.Web.UI.MasterPage`.

只有子母版页的 ASP 标记应该引用主母版页，即`<%@ Master Language="C#" MasterPageFile="~/TheMaster.master" ... />`

如果您通过 VS UI 将子母版页添加到项目中，选择 TheMaster.master 作为母版页，那么您将看到这是如何设置的。母版页的使用被设计为仅通过内容（标记），而不是通过类继承。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-08T14:08:03.823

我刚刚遇到了这个问题，并想添加在从您也嵌套的母版页继承时会遇到的特定问题。例如 BaseMaster.master.cs 中的以下代码：

```
//BaseMaster.master.cs
public String FooLabelText
{
    get { return FooLabel.Text; }
    set { FooLabel.Text = value; }
} 
```

当从您继承的页面调用时，将抛出一个`NullReferenceException`. FooLabel（`BaseMaster.master`文件中的标签）在嵌套母版页 ( ) 中不存在，`SubMaster.master`因此如果您访问该属性，它将中断。

您可以通过覆盖子类中的属性并将其重定向到您嵌套的母版页来解决此问题，但这确实打破了 .NET 母版页的设计理念：

```
//SubMaster.master.cs inherits from BaseMaster
new public String FooLabelText
{
    get { return (Master as BaseMaster).FooLabel.Text; }
    set { (Master as BaseMaster).FooLabel.Text = value; }
} 
```

请注意，我没有使用`base.FooLabel`, but `Master.FooLabel`，它实际上指向不同的对象。充其量，这是一个 hack，在许多情况下，它会产生更多的工作和重复。

一种替代方法是创建一个具有所需应用程序功能的虚拟母版页基类，并让每个母版页都从该类继承。与使用虚拟页面基类相比，我只能看到使用它的非常有限的优势，以及许多缺点。最好将母版页用于他们最擅长的事情，减少标记中的复制，并将其余所需功能放在页面类中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T21:44:08.690

基本上你所做的是设置页面，以便类从指定的基础继承所有项目。“Masterpage”属性的连接，创建弱关联，并在特定结构内呈现内容。从基类继承的类将逻辑向前移动，以一种方式，而不仅仅是让它执行，您可以覆盖它。

现在，在考虑之后，您很可能不希望设置 MasterPage 属性....而只是类继承

# blackberry - 如何检测我的 Field 子类中的“删除”键？

> ID：942037
> 
> 赞同：3
> 
> 时间：2009-06-02T21:39:17.467
> 
> 标签：blackberry, keyboard-events, keydown, keylistener

我正在尝试检测并覆盖黑莓键盘上的 Delete 键。

出于某种原因，它从来没有在我的案例陈述中出现，因为它达到了这一点：

```
Keypad.key(keycode) == 8
Keypad.KEY_DELETE == 127 
```

我的错误是什么？

```
public class MyField extends ListField implements KeyListener {
// ...
/** Implementation of KeyListener.keyDown */
public boolean keyDown(int keycode, int time) {
    boolean retval = false;
    switch (Keypad.key(keycode)) {
    /* DELETE - Delete the timer */
    case Keypad.KEY_DELETE:
        if (Keypad.status(keycode) == KeyListener.STATUS_SHIFT) {
            _myDeleteCmd.run();
            retval = true;
        }
        break;

    default:
        retval = super.keyDown(keycode, time);
    }
    return retval;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T00:40:57.973

键事件很可能正在被另一个 KeyListener.keyDown 函数使用，然后才能到达此字段。您可以通过在 keyDown() 实现中设置断点来轻松测试这一点，以确保应用程序到达该点。

要使用键事件，KeyListener 函数只需要返回 true。确保默认情况下您没有为任何其他 keyDown 实现返回 true，以确保每个实现只使用它使用的键。

# c# - 自定义 Linq 订购

> ID：942039
> 
> 赞同：8
> 
> 时间：2009-06-02T21:39:50.320
> 
> 标签：c#, linq, c#-3.0

我有超过一千个文件夹，每个文件夹包含一个或多个具有以下名称的文件：

无序：

```
艾莉森.ext
希瑟.ext
莫莉.ext
保拉.ext
Sam.ext

```

订购：

```
莫莉.ext
Sam.ext
希瑟.ext
艾莉森.ext
保拉.ext

```

我想写一个表达式来对这个列表进行排序，如上所述。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T21:50:08.193

```
//Creating a dictionary with the custom order
var order = "MSHAP";
var orderDict = order.Select((c,i)=>new {Letter=c, Order=i})
                     .ToDictionary(o => o.Letter, o => o.Order);

var list = new List<string>{"A.ext", "H.ext", "M.ext", "P.ext", "S.ext"};

//Ordering by the custom criteria
var result = list.OrderBy(item => orderDict[item[0]]); 
```

除了调用 orderDict[item[0]] 之外，您还可以有一个很好的辅助方法来处理边缘情况（不存在的字母、null 等）。但这就是想法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T22:17:37.263

这是一种生成排序键的方法

```
public int OrderKey(string fileName)
{
  char first = fileName[0];
  int result =
     first  == 'M' ? 1 :
     first  == 'S' ? 2 :
     first  == 'H' ? 3 :
     first  == 'A' ? 4 :
     first  == 'P' ? 5 :
     6;
  return result;
} 
```

以下是如何调用它：

```
List<File> ordered = Files.OrderBy(f => OrderKey(f.FileName)).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T21:57:18.037

```
List<char> sortKeys = new List<char> { 'M', 'S', 'H', 'A', 'P' };
sortKeys.Reverse();
List<FileInfo> files = new List<FileInfo>(6);

foreach(char sortKey in sortKeys)
{
    var topFiles = files.Where(file => file.Name.StartsWith(sortKey.ToString()));
    var remainingFiles = files.Except(topFiles);
    files = topFiles.Concat(remainingFiles).ToList();
} 
```

未经测试，我相信有更快的方法，但至少它是你问的 linq 的东西:-)

**编辑：** 我刚刚看到你帖子上的编辑，现在我不知道你真正想做什么，所以我的代码可能对你没用..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:06:05.547

您可以将所需的订单列表存储在数组中

```
int[] iIndex = {3,2,0,4, 1}; 
```

说 str 持有你的无序列表

```
List<string> str = new List<string>();
str.Add("Alison.ext");
str.Add("Heather.ext");
.
.
. 
```

将您的列表和相应的订单添加到数据表中

```
DataTable dt = new DataTable();
                dt.Columns.Add("Order", typeof(Int32));
                dt.Columns.Add("Name");

                for (int iCount =0; iCount< str.Count ; iCount ++)
                { 
                    DataRow drow1 = dt.NewRow();
                    drow1[0] = iIndex[iCount];
                    drow1[1] = str[iCount];
                    dt.Rows.Add(drow1);

                }
                dt.AcceptChanges(); 
```

最后订购您的清单以获得您的预期清单

```
 var result = from ls in dt.AsEnumerable()
                         orderby ls.Field<int>("Order")
                         select ls; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T21:47:25.407

您没有确切提到列表中有哪些类型的对象，但假设它是一些通用的安排，如下所示：

```
public class File {
  public string FileName { ... }
  public long FileSize { ... }
  /* elided */
} 
```

然后，给定一个名为 的 IEnumerable `files`，你可以这样做：

```
var result = files.OrderBy(f => f.FileName); 
```

# scheme - 如何提取方案中符号的第一个字符？

> ID：942040
> 
> 赞同：2
> 
> 时间：2009-06-02T21:40:15.933
> 
> 标签：scheme, racket

我希望它提取所有包含字母 e 的单词。例如。

```
(ewords '(i e ee o oo)) -> '(e ee) 
```

Berkeley 的 61a 讲座使用 (first 'word) 来提取单词的第一个字符。然而，当我尝试这样做时，DrScheme 对我大喊大叫。如何取单词的第一个字符？喜欢

```
(first 'word)->'w. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T21:51:32.013

您需要将其显式转换为字符串：

```
(first (symbol->string 'word)) -> "w" 
```

（我不确定是否`first`对字符串进行操作。您可以使用`string->list`转换为列表，`first`如果没有，则使用。）

编辑：首先传递字符串而不是符号可能更容易 - 指定一个字符串，使用双引号（例如`(ewords '("i" "e" "ee" "o" "oo"))`。）我不知道这是否是你的意图，但既然你正在学习，我认为我应该提到区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:09:41.333

符号主要是指原子值，即它们通常不被拆开和检查。如果你真的想这样做，你必须先做一些类型转换：

```
    ; #\a -> 一个
    (定义 (char->symbol chr)
      (string->symbol (list->string (list chr))))

    ; abc -> (abc)
    （定义（符号->列表符号）
      （映射字符->符号
           (string->list (symbol->string sym))))

```

您现在可以使用`first`：

```
    > (first (symbol->list 'word))
    w

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T19:16:53.050

这取决于，“单词”的数据定义是什么？

它是一个字符序列（又名字符串）吗？它是一个字符列表吗？字符串列表？符号列表？

这是一个符合您标准的函数，但正如您所见，它很复杂，我想知道它是否是您真正想要的：

```
; symbol->list-of-symbols : symbol -> (ListOf symbol)
; To destructure a symbol into a list of its constituent parts
(define (symbol->list-of-symbols sym)
  (map (lambda (s) (string->symbol (string s))) 
       (string->list (symbol->string sym)))) 
```

# asp.net - 性能测试策略 Web 应用

> ID：942049
> 
> 赞同：1
> 
> 时间：2009-06-02T21:42:53.527
> 
> 标签：asp.net, ajax, unit-testing, testing

我们最近有一个 web 应用程序进行了站点验收测试，他们发现与请求大小相关的严重性能问题（massive viewstate ASP.net）。

我们需要修改我们的测试策略以包括性能测试，谁能给我们关于最佳实践的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T21:49:07.447

这是一个非常广泛的案例，但这里有一些我们经常做的事情的亮点。

1.  不要只在您的网络上进行测试，而是进行远程测试。LAN 连接速度非常快，大页面和大加载时间可能会被忽视。理想情况下，到达一个在硬件和与最终用户的接近/连接方面模仿生产位置的地方。

2.  使用 ANTS Profiler 或类似工具来分析昂贵的方法和高内存使用情况。

3.  与多个用户一起测试，以模拟负载。根据应用程序的性质，还可以使用多个物理测试仪或使用允许您模拟和编写负载场景脚本的测试工具进行负载测试。

4.  查看代码以查看对象是否在不需要时保留视图状态。

我不知道一套硬性和快速的“规则”，但我发现这些是很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:11:34.080

除了上述 Mitchel 的评论之外，我还建议将负载测试作为您的 Continuos 集成 (CI) 流程的一部分。Visual Studio Team Suite（测试版）包含一个很好的负载/压力测试工具。

# c# - 为什么没有树 .NET 中的类？

> ID：942053
> 
> 赞同：90
> 
> 时间：2009-06-02T21:44:25.863
> 
> 标签：c#, .net, data-structures

.NET 中的基类库具有一些出色的集合数据结构（列表、队列、堆栈、字典），但奇怪的是它不包含任何用于二叉树的数据结构。对于某些算法，例如那些利用不同遍历路径的算法，这是一个非常有用的结构。我正在寻找一个正确编写的免费实现。

我只是瞎了眼，没有找到它……它被埋在 BCL 的某个地方吗？如果没有，有人可以推荐一个用于二叉树的免费或开源 C#/.NET 库吗？最好是使用泛型的。

**编辑：**澄清我在找什么。我对内部使用树的有序字典集合不感兴趣。我实际上对二叉树感兴趣 - 一种公开其结构的二叉树，以便您可以执行提取子树或在节点上执行修复后遍历等操作。理想情况下，可以扩展这样的类以提供专门树的行为（即红/黑、AVL、平衡等）。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-02T21:52:24.583

您可以定义自己的：

```
public class MyTree<K, V> : Dictionary<K, MyTree<K, V>>
{
    public V Value { get; set; }
} 
```

或无键：

```
public class MyTree<V> : HashSet<MyTree<V>>
{
    public V Value { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-06-02T21:51:10.093

你想从这样的实现中得到什么？

二叉树？红黑？萝卜树？B树？R树？R*-树？

树与其说是数据结构，不如说是一种模式，它们往往被用在性能很重要的地方（因此实现细节可能也很重要）。如果 BCL 包含某种树类，那么无论如何你只需要滚动你自己的

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-06-02T21:54:25.517

你是对的，BCL 中没有任何内容。我怀疑这是因为选择是否使用树通常是实现细节，否则是访问数据的非常规方式。也就是说，您不会说“二分查找元素#37”；相反，你说，“给我元素#37”。

但是你看过[C5](http://www.itu.dk/research/c5/Release1.1/c5doc/frames.htm)吗？它非常方便，并且它们有几个树实现（[1](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.TreeBag_1.htm)、[2](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.TreeDictionary_2.htm)、[3](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.TreeSet_1.htm)）。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-06-02T21:49:13.357

我相信`SortedDictionary`作为 log(n) 插入，您期望从树数据结构中获得的检索特征。

[http://msdn.microsoft.com/en-us/library/f7fta44c(VS.80).aspx](http://msdn.microsoft.com/en-us/library/f7fta44c(VS.80).aspx)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-06-02T21:49:41.533

[`SortedSet<T>`](https://msdn.microsoft.com/en-us/library/dd412070(v=vs.110).aspx)实现为二叉搜索树^([ref](https://github.com/dotnet/corefx/blob/d0dc5fc099946adc1035b34a8b1f6042eddb0c75/src/System.Collections/src/System/Collections/Generic/SortedSet.cs#L19))。[`SortedDictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)内部使用`SortedSet<T>`所以它也是一个二叉搜索树^([ref](https://github.com/dotnet/corefx/blob/master/src/System.Collections/src/System/Collections/Generic/SortedDictionary.cs#L954))。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-06-02T21:47:15.873

不，BCL 中没有任何“ `Tree<T>`-like”类型（这也一直让我感到困惑）但是[这里有一篇很好的文章](http://dvanderboom.wordpress.com/2008/03/15/treet-implementing-a-non-binary-tree-in-c/)将引导您在 C# 中实现自己的。

我猜你可能会认为基于树的数据结构在 .NET 通常用于的应用程序（商业应用程序、数据移动应用程序等）中不太常用。不过，我同意你的看法，奇怪的是 BCL 根本没有实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T21:53:54.673

当我不得不写自己的文章时，这一系列文章对我很有帮助，尤其是第 3 部分和第 4 部分。

[数据结构的广泛检查](http://msdn.microsoft.com/en-us/library/aa287104(VS.71).aspx)

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2009-06-02T21:48:06.713

有一个可以使用的[TreeNode 。](http://msdn.microsoft.com/en-us/library/system.windows.forms.treenode.aspx)它不是通用的并且隐藏在 Windows 窗体中并与树视图控件一起使用，但您也可以在其他地方使用它。

# sql - SQL Server：将列提取到表中

> ID：942055
> 
> 赞同：0
> 
> 时间：2009-06-02T21:44:49.827
> 
> 标签：sql, sql-server, tsql, ddl, dml

我有一个表，其中有一列我想提取出来并放入一个单独的表中。

例如，假设我有一个名为 Contacts 的表。Contacts 有一个名为 Name 的列，其中存储了一个字符串。现在我想将名称提取到另一个名为 Name 的表中，并将 Contact.Name 列链接到 Name 表的 Id。

我只能使用 SQL 来执行此操作。关于解决此问题的最佳方法的任何想法？

如果我能澄清任何事情，请告诉我，谢谢！

[编辑] 一个问题是不同的联系人可以绑定到同一个名字。因此，当不同的联系人具有相同的名称并且它被导出时，名称表将只有该名称的一个唯一行，并且所有联系人都将指向该行。我想如果我实际上是在编写通讯录，这将没有意义，但我只是用它来说明我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:51:28.767

```
CREATE TABLE Name (NameID int IDENTITY(1, 1), [Name] varchar(50))

INSERT INTO Name ([Name])
SELECT DISTINCT [Name]
FROM Contact

ALTER TABLE Contact
    ADD COLUMN NameID int

UPDATE Contact
SET NameID = [Name].NameID
FROM Contact
INNER JOIN [Name]
    ON Contact.[Name] = [Name].[Name]

ALTER TABLE Contact
    DROP COLUMN [Name] 
```

然后添加外键约束等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T21:50:01.687

使用指向联系人表的外键创建新表。然后将联系人表中的姓名和联系人 ID 插入到这个新表中。之后，您可以从联系人表中删除“名称”列。

```
CREATE TABLE Name
(
   ContactId int,
   Name nvarchar(100)
);

INSERT Name(Name)
SELECT ContactId, Name From Contact;

ALTER TABLE Contact
DROP Column name; 
```

**编辑：**由于您已编辑问题以提及一个姓名可以与多个联系人相关联，因此这会以相反的方式改变事情。

```
CREATE TABLE Name
(
   NameId int IDENTITY,
   Name nvarchar(100)
);

INSERT Name(Name)
SELECT DISTINCT Name From Contact;

ALTER TABLE Contact
ADD NameId int;

UPDATE c
SET c.NameId = n.NameId
FROM Contact c
JOIN Name n on n.Name = c.Name;

ALTER Table Contact
Drop Column Name; 
```

**注意：**确保使用 Contact 表上的 NameId 在 Contact 和 Name 表之间创建适当的外键，并在 Name 表的“name”列上创建 UNIQUE 约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:47:20.197

```
insert into another_table( contact_id, name )
select id, name 
from contacts; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:02:24.313

`insert into new_table (contact_id, name)` `select min(id), name` `from contacts` `group by name;`

这是确保每个名称只有一行的一种方法 - 您可以用其他函数替换 min（例如 max）。

不过，我不太确定您为什么要这样做。无论如何，你最终会得到一些没有名字链接的联系人......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:08:30.807

```
ALTER TABLE `Contacts` ADD `name_id` INT( 12 ) NOT NULL 
ALTER TABLE `Name` ADD `Name` VARCHAR( 200 ) NOT NULL 
INSERT INTO Name (id, name) SELECT id, Name FROM Contacts
ALTER TABLE `Contacts` DROP `Name` 
```

问题是 name_id 字段，它用“0”填充，并且应该与联系人表中的 id 具有相同的值。在这里您可以使用[LOOP](http://dev.mysql.com/doc/refman/5.0/en/loop-statement.html)或 ITERATE 语句（如果您使用 MySQL）。

# java - 删除 Swing JDialog 中的“X”按钮

> ID：942056
> 
> 赞同：61
> 
> 时间：2009-06-02T21:45:08.607
> 
> 标签：java, swing

有没有办法从`JDialog`标题栏中删除关闭按钮（“X”）？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-06-02T22:39:07.767

您可以通过调用删除整个对话框标题，`dialog.setUndecorated(true)`但这意味着无法再移动对话框。

您还可以执行`dialog.setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE)`以防止按钮执行任何操作。

除此之外，我认为没有办法`X`完全删除。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-02T22:42:01.333

相信你可以打电话`dialog.setUndecorated(true)`去掉标题栏。不过，不确定只是“X”。

但是，删除“X”可能不是一个好主意，因为您希望您的用户能够轻松关闭对话框。

最好的办法是控制当用户通过使用`dialog.setDefaultCloseOperation`或 a单击“X”时会发生什么`WindowListener`。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-09-27T06:28:38.860

从 Java 1.7（AKA Dolphin 或 Java 7）开始，您不能禁用或删除窗口上的关闭按钮。您可以删除/禁用最大化按钮，`frame.setResizable(false)`您可以使用扩展它的类或类来删除最小化和最大化按钮`java.awt.Dialog`，例如`javax.swing.JDialog`. 您可以使用 删除标题栏、边框和按钮`frame.setUndecorated(true)`，并且可以完全控制标题栏中所有按钮的可见性（同时失去一些跨平台兼容性和操作系统集成）`frame.setDefaultLookAndFeelDecorated(true)`（假设它是 JFrame 或 JDialog） . 这就是我认为当前 JDK 所能实现的所有控制。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-21T13:57:57.927

这是我的经验：

*   尝试使用`setUndecorated(true)`：使整个`Dialog`不可见。
*   尝试过`setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE)`：这根本没有改变行为。我的对话框仍然关闭。将默认关闭操作设置为将关闭操作`DO_NOTHING_ON_CLOSE`委托给`windowClosing()`已注册的方法`WindowListener`。

对我有用的是：

```
setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);
//Remove any existing WindowListeners
for (WindowListener wl : this.getWindowListeners()) {
    this.removeWindowListener(wl);
}
this.addWindowListener(new WindowAdapter() {
    @Override
    public void windowClosing(WindowEvent e) {
        if ("Optional condition") {
            JOptionPane.showMessageDialog(null, "You cannot close this window");
        }
    }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T22:35:40.190

猜测一下，将其设置为 PL&F 装饰并按名称删除组件。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-06-19T21:30:31.487

```
static public void removeButtons(Component c){
    if (c instanceof AbstractButton){
        String accn = c.getAccessibleContext().getAccessibleName();
        Container p=c.getParent();
        //log.debug("remove button %s from %s",accn,p.getClass().getName());
        c.getParent().remove(c);
    }
    else if (c instanceof Container){
        //log.debug("processing components of %s",c.getClass().getName());
        Component[] comps = ((Container)c).getComponents();
        for(int i = 0; i<comps.length; ++i)
            removeButtons(comps[i]);
    }
} 
```

# excel - 如何在不使用标题的情况下通过 VBA 获取当前 Excel 实例的进程 ID？

> ID：942058
> 
> 赞同：11
> 
> 时间：2009-06-02T21:45:17.063
> 
> 标签：excel, vba, pid

如何获取运行 VBA 代码的当前 Excel 实例的进程 ID？我不想通过标题中的名称来询问它，当我有两个或多个具有相同标题的 Excel 实例时，这会导致问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-02T21:52:14.053

您可以使用此方法获取当前进程 ID。

```
Declare Function GetCurrentProcessId Lib "kernel32" () As Long 
```

[这个页面](http://www.informit.com/articles/article.aspx?p=366892&seqNum=3)很好地概述了如何在各种版本的 excel 中做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T14:58:23.847

作为一个vba n00b，还有一些我不知道的事情

1.  Declare 语句位于顶部。如果在子声明之后插入声明语句，VBA 会报错

    例如，这将起作用

    ```
    Declare Function GetCurrentProcessId Lib "kernel32" () As Long

    Sub Update
      ...
      ...
    End Sub 
    ```

    但这行不通

    ```
    Sub Update
      ...
      ...
    End Sub

    Declare Function GetCurrentProcessId Lib "kernel32" () As Long 
    ```

2.  这是我们如何在 vbscript 的消息框中显示 PID

    ```
    Set app = CreateObject("Excel.Application")
    MsgBox("Excel PID is " + CStr(app.Run("GetCurrentProcessId"))) 
    ```

希望这可以帮助某人

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-04T14:41:25.137

我在 Excel 2013 中的解决方案：在一个新模块中，我添加了以下代码：

```
Private Declare Function GetCurrentProcessId Lib "kernel32" () As Long

Public Sub Test()
    Debug.Print GetCurrentProcessId
End Sub 
```

# performance - 如何加快 Grails 测试执行

> ID：942066
> 
> 赞同：25
> 
> 时间：2009-06-02T21:47:32.677
> 
> 标签：performance, unit-testing, grails, junit

在开发 Grails 1.0.5 应用程序时，我对`grails test-app`命令的速度如此之慢感到震惊。尽管实际测试只需要大约 10 秒，但整个执行过程加起来

> 真实 1m26.953s 用户 0m53.955s 系统 0m1.860s

这包括 grails 引导、加载插件、编译所有代码等。

任何有关如何加快`grails test-app`执行速度的提示将不胜感激。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-07-10T04:15:36.710

您可以使用交互模式来加速测试运行。

赶紧跑

```
grails interactive 
```

然后输入

```
test-app 
```

第一次将与往常一样，但之后的每次都会大大加快。目前交互模式存在一些问题（比如运行几次后内存不足），但我仍然觉得值得。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-04T00:21:42.797

没有任何硬性规定可以加快速度，而且您看到的性能问题可能特定于您的应用程序。

如果你的引导需要大约 75 秒，那听起来很长。我会仔细查看您的 Bootstrap.groovy 文件中的任何内容，看看是否可以精简。

您是否有任何您可能不需要的额外插件（或者可能会严重影响性能）？

现在这对您来说可能不太可能，但是 grails 1.1.1/groovy 1.6.3 相对于 grails 1.0.5/groovy 1.5.7 的速度改进是相当显着的。

测试时真正对我有帮助的另一件事是，如果我正在处理其中一个或另一个，则仅指定集成测试或仅指定单元测试：

```
grails test-app -unit

grails test-app -integration 
```

您还可以指定一个特定的测试类（不带“Tests”前缀）来运行一个可以真正帮助 TDD 的测试（例如“MyServiceTests”集成）：

```
grails test-app -integration MyService 
```

在 grails 1.1.1 中，使用 5 个插件和约 40 个域类进行引导只需不到 20 秒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:34:27.180

如果您仍在使用 Groovy 1.5.x，您可能会通过升级到 Groovy 1.6 来节省几秒钟的时间

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-05T23:44:46.333

grails 现在安装了[http://grails.org/plugin/testing](http://grails.org/plugin/testing)。这模拟了域的东西，所以你可以对域类进行一些测试作为*单元*测试。他们跑得很快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-03T05:16:36.010

请在此处查看我的答案。依赖于定义不明确的 maven 工件的插件可能会导致 grails 每次都去寻找更新的版本。

[Grails 解决某些依赖项非常慢](https://stackoverflow.com/questions/7975762/grails-very-slow-to-resolve-certain-dependencies/7990573#7990573)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T09:35:39.697

您也可以选择并行运行单元测试和集成测试 - 请参阅[本文](http://naleid.com/blog/2010/08/26/running-grails-unit-and-integration-tests-in-parallel/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-03T16:50:39.030

增加 java 内存/JVM 选项绝对可以加快速度。您可以提供的内存量取决于您的设备。

如果您从命令行运行 grails，请设置`GRAILS_OPTS`环境变量。添加这样的东西`~/.bash_profile`

```
export GRAILS_OPTS="-Xms3000M -Xmx3000M -XX:PermSize=256m -XX:MaxPermSize=512m" 
```

如果您使用 GGTS(Eclipse)，则需要将其添加到运行配置的 VM 参数中。 ![GGTS 虚拟机参数](https://i.stack.imgur.com/TopOV.png)

还有一些 JVM 设置可以修改以提高速度：

```
-XX:+UseCodeCacheFlushing 
-XX:MaxInlineLevel=15  
-noverify  (turns off class validation) 
```

# php - 我可以设置 Eclipse 以显示代码更改吗

> ID：942082
> 
> 赞同：18
> 
> 时间：2009-06-02T21:51:25.727
> 
> 标签：php, linux, eclipse, svn

我之前在 Subversion (SVN) 中使用过 Netbeans，我喜欢它使用左边距中的颜色向我展示自上次提交以来我所做的更改。

Eclipse 可以做同样的事情吗？我已经安装了 Subclipse。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-02T22:03:18.773

访问 Window -> Preferences -> General -> Editors -> Text Editors -> Quick Diff，然后启用

*   启用快速差异
*   显示总览标尺的差异

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T22:32:59.900

SubVersive 和 Subclipse 都可以在项目浏览器中显示更改的文件以及历史记录中版本之间的差异。我目前使用 Subversive 并且对它很满意（尽管第一次安装它很痛苦。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:41:22.487

有类似的问题。事实证明，eclipse 中的 SVN 标签装饰没有启用。

```
 Preferences: General/Appearance/Label Decorators 
```

这篇文章帮助了我： [SVN-connected project not displayed version info in eclipse](https://stackoverflow.com/questions/6733492/svn-connected-project-not-showing-version-info-in-eclipse)

# sql - Reporting Services 图表 - 自定义轴标签

> ID：942086
> 
> 赞同：3
> 
> 时间：2009-06-02T21:52:13.383
> 
> 标签：sql, sql-server, reporting-services, ssrs-2008

我有一个 SQL Server Reporting Services (2008) 图表（错误图表）。X 轴的日期间隔为 2009 年 1 月 1 日、2009 年 2 月 1 日等。Y 轴的数字间隔为 50。Y 轴上的值为 0、50 和 100。但是，不是显示 0 , 50 和 100 我想分别显示“小”、“中”和“大”。有谁知道如何执行此文本替换？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T02:12:58.303

这有点骇人听闻，但这里有：

1.  首先，将您的值标准化为零左右，因此最小值为 -50，最大值为 50。您可以在图表控件本身中执行此操作，无需更改数据集。您的值介于 0 到 100 之间，因此只需减去 50。

2.  接下来，在值轴属性 -> 轴选项下，将最小值设置为 -50，最大值设置为 50，并将间隔设置为 50。

3.  最后，在 value axis properties -> Number 下，选择 Category 作为“Custom”，并将其作为自定义格式表达式输入：="Large;Small;Medium"

（这是一个 excel 格式代码：*pos* ; *neg* ; *zero*）

你应该得到这样的东西：

[替代文字 http://img44.imageshack.us/img44/9011/chartz.png](http://img44.imageshack.us/img44/9011/chartz.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T05:00:45.663

根据[SSRS Charts 中 Y 轴的任意标签](http://social.msdn.microsoft.com/forums/en-US/sqlreportingservices/thread/ba0b0f85-7244-4d74-b360-0be663667251/)，您可以通过使用带状线集合来达到类似的效果。请参阅[如何：通过添加带状线突出显示图表数据](http://msdn.microsoft.com/en-us/library/cc281363.aspx)。

# visual-studio - VS2008 中特定领域语言的语法高亮显示？

> ID：942091
> 
> 赞同：2
> 
> 时间：2009-06-02T21:53:02.383
> 
> 标签：visual-studio, editor, syntax-highlighting

我有一种具有特定语法的领域特定语言。是否可以让 Visual Studio 2008 在常用编辑器中识别自定义语言？也就是说，将给定的文件扩展名与某个语法着色方案相关联？如果是这样，您对如何执行此操作有任何指示吗？

如果这是重复的，我很抱歉。我搜索但找不到相关答案，但这听起来确实是一个简单的问题。

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T17:05:56.850

如果[Visual Studio 2008 中的实现颜色语法突出显示](http://msdn.microsoft.com/en-us/library/bb165041.aspx)看起来很深奥，您可以下载 Lua Lang Pack [http://luaforge.net/projects/lualangpack/](http://luaforge.net/projects/lualangpack/)并看看他们是如何做到的。

他们使用非常简洁[的 C# 编译器工具。](http://www.c-sharpcorner.com/UploadFile/malcolmcrowe/CsTools12062005231835PM/CsTools.aspx)

如果你不能下载我的原型[Erlang VS 插件](http://code.google.com/p/vs-erlang/)，目前只有简单的语法高亮，但基于以上所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T03:52:38.463

德文，

这应该可以帮助您：

在 Visual Studio 2008 中实现颜色语法突出显示：http:
[//msdn.microsoft.com/en-us/library/bb165041.aspx](http://msdn.microsoft.com/en-us/library/bb165041.aspx)

# javascript - 使用 jQuery 1.3+ 检测 IE8、IE7、Safari、FireFox？

> ID：942094
> 
> 赞同：1
> 
> 时间：2009-06-02T21:53:42.180
> 
> 标签：javascript, jquery, browser-detection, object-detection

我需要根据每个浏览器更改一个值，因为它们的呈现方式都不同。

```
if (navigator.appName == 'Netscape'){
        top = 17;
} 
```

这很有效，但不幸的是 Firefox 和 Safari 都显示为“Netscape”

我将如何使用 jQuery 1.3.2 来检测所有这些？`jquery.support`现在我找不到任何信息`jquery.browser`了。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:43:30.567

如果您必须进行浏览器检测（尽管有警告），[ppk 的例程](http://www.quirksmode.org/js/detect.html)是最新的（甚至通过 Chrome 和 iPhone）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T22:17:38.853

您是否或考虑过使用[样式`reset.css`表](http://meyerweb.com/eric/tools/css/reset/)将所有浏览器的默认值设置为零？如果不是，我建议您这样做，因为它可能会解决您当前的问题以及潜在的未来问题。

它可能会有所帮助，因为它将所有浏览器设置为基线零，因此当您应用填充或定位时，它应该在所有浏览器中具有相同的效果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T21:57:17.913

他们有什么不同的渲染？有没有办法可以使用[功能检测](http://www.quirksmode.org/js/support.html)而不是浏览器嗅探？当新的浏览器出现时，它更不容易损坏，并且更能容忍边缘。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T22:48:09.510

you can use the [`jQuery.browser`](http://docs.jquery.com/Utilities/jQuery.browser) object. It's deprecated in jQ 1.3 in favour of the [`jQuery.support`](http://docs.jquery.com/Utilities/jQuery.support), but there's no immediate plans to remove it altogether, so you should be safe.

That said, using browser sniffing, while very easy and tempting, isn't usually the best way to do things. Since it sounds like you're having problems with some browsers doing CSS differently, you might want to look at `jQuery.support.boxModel`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:03:42.987

它们都以不同的方式呈现工具提示的顶部 css 值。

```
var container = $('<div id="personPopupContainer">'
    + '<div id="personPopupContent">'
    + '</div>'
    + '</div>');

var pos = $(this).offset();
var width = $(this).width();
var reposition = { left: (pos.left - width) + 'px', top: pos.top + msg + 'px' };

container.css({
                    top: reposition.top
             }); 
```

# jquery - ASP.NET MVC 到 JavaScript 的相对路径

> ID：942099
> 
> 赞同：0
> 
> 时间：2009-06-02T21:54:28.403
> 
> 标签：jquery, asp.net-mvc

我试图在我的母版页中引用 jQuery 库，如下所示：

```
src="<%= ResolveUrl("~/Scripts/jquery-1.2.6.js")%>" type="text/javascript"> 
```

该页面的来源显示：

```
<script src="/DocumentManagement/Scripts/jquery-1.2.6.js"  type="text/javascript"></script> 
```

这似乎是正确的，因为我的网站的网址是[http://servername/documentmanagement](http://servername/documentmanagement)。

但是，我在 javascript 函数中遇到错误，表明找不到 jQuery 库，例如“预期对象”。

相同的代码在我的开发（XP - ASP.Net 开发服务器）机器上运行良好，但在 Win2003 机器（IIS）上运行良好。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T22:08:38.997

您是否检查了日志以查看是否正在发出请求以及它得到什么类型的响应？URL 看起来是正确的，所以我怀疑存在一些配置或权限问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:47:39.557

您可以加载[萤火虫](http://getfirebug.com)以获得一些帮助，看看它是否是客户端的问题。它还将通过获取任何服务器响应（404、403 等）来提供帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-06T19:15:53.933

为浪费您的时间而道歉！jquery 引用使用了错误的版本号！！！脑残！

# c# - 如何在 LINQ 中实现这一点？

> ID：942101
> 
> 赞同：0
> 
> 时间：2009-06-02T21:54:59.010
> 
> 标签：c#, linq

我想重写这个，可能使用谓词或 Lambda，我该怎么做？

```
 serviceResponse = client.Authorize(....);

        string authorizeResponse = string.Empty;

        foreach (CdcEntry element in serviceResponse.Cdc)
        {
            authorizeResponse += element.Name + Environment.NewLine;
            foreach (CdcEntryItem item in element.Items)
            {
                authorizeResponse += " (" + item.Key + ", " + item.Value + ") " 
                + Environment.NewLine;
            }
        } 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:05:56.897

我认为在这里使用 LINQ 没有任何实际意义，因为您正在尝试构建响应字符串，因此正在执行最适合命令式而不是函数式编程的任务。（您当然可以`Aggregate`在字符串上使用该方法，但这并没有任何帮助。）

此外，该`StringBuilder`类型更适合这种工作。（在我看来，它更有效，也更干净。当然，根据上下文，前者可能并不重要。）

在我看来，这是执行此操作的最佳方法：

```
serviceResponse = client.Authorize(....);

var sb = new StringBuilder();

foreach (CdcEntry element in serviceResponse.Cdc)
{
    sb.AppendLine(element.Name);
    foreach (CdcEntryItem item in element.Items)
    {
        sb.AppendFormat(" ({0}, {1}) ", item.Key, item.Value);
        sb.AppendLine();
    }
}

var authorizeResponse = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T22:01:48.513

您当然可以，但您将获得的只是几个`ForEach`方法调用和多语句 lambda，其中（在我看来）可读性会大大降低。

在不知道标识符的数据类型（特别是`serviceResponse.Cdc`and `element.Items`）的情况下，您甚至可能还必须滚动自己的`ForEach`扩展方法才能使其工作。

我认为你所拥有的比 LINQ 等价物更好，但如果你真的想对其进行 LINQify，请发布一些关于你发布的代码的更多信息，我们可能会提供更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:07:24.493

这应该大致做到：

```
x = x.Aggregate("",
    (cdc, s) => s + string.Format("{0}{1}",
                    cdc.Name, Environment.NewLine) +

        cdc.Aggregate("",
           (item, s) => s + string.Format(" ({0}, {1}) {2}",
                            item.Key, item.Value, Environment.NewLine))); 
```

坦率地说，我是一个功能强大的人，但是多个嵌套折叠让我对这样一个简单的问题想得太难了，尤其是对于 C# 的冗长语法。我什至不会使用这个。我会使用你的`foreach`版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:11:26.573

通过使用字符串生成器而不是字符串连接，您可以获得很多好处。在 LINQification 中看不到任何性能优势。

```
 StringBuilder sb = new StringBuilder()

 foreach (CdcEntry element in serviceResponse.Cdc)
 {
     sb.AppendLine(element.Name);
     foreach (CdcEntryItem item in element.Items)
     {
        sb.AppendLine(" ({0},{1}) ", item.Key, item.Value);
      }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:18:06.263

您当然可以使用 LINQ 来折叠列表。但是你应该记住，像 LINQ 这样的语言特性是为了让事情变得更简单、更清晰。我不确定下面的逻辑是不是：

```
StringBuilder sb = new StringBuilder();
string authorizeResponse = serviceResponse.Aggregate( sb, 
                              (q,x) => q.Append( string.Format( "{0}{1}{2}", x.Name, Environment.NewLine,
                              x.Aggregate( q, (y,z) => y.Append( string.Format("({0}){1}", z.Key, Environment.NewLine) ) ) );

string authorizeResponse = sb.ToString(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T22:52:55.227

```
 var result =
                elements.Select(
                        element =>
                        new[] {element.Name}.Concat(
                                element.Items.Select(item => "({0},{1})".With(item.Key, item.Value)))).SelectMany(
                        item => item).Join(Environment.NewLine); 
```

# math - 计算不重叠的矩形面积

> ID：942102
> 
> 赞同：1
> 
> 时间：2009-06-02T21:55:47.837
> 
> 标签：math, geometry, overlap

我有两个由包含 x1、y1、x2、y2 坐标的结构表示的矩形。一个矩形可以被认为是父母，另一个是孩子。

我已经知道如何检测子矩形是否在父矩形内；我现在要弄清楚的是最简单，最快的方法来确定父级中未被子矩形重叠的矩形区域。

例如，考虑一个 100x100 的父矩形和一个 50x50 的子矩形，正好位于父矩形的中心。这意味着将有四个矩形代表父矩形中未被子矩形重叠的四个区域。

当然，孩子可能在左上角、右上角、左下角、右下角，或者向左一点、向右一点等等……可能有一个、两个、三个或四个表示非重叠区域的矩形。

我有一些实现的想法来解决这个问题，但似乎都过于复杂。有没有一种简单、快速的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:19:57.150

所以最多可以有 4 个矩形的非重叠区域。让我们列出它们。

```
leftrect = rightrect = toprect = bottomrect = None
trimmedparent = duplicate(parent)

if parent.x1 < child.x1:
    leftrect = duplicate(parent)
    leftrect.x2 = child.x1
    trimmedparent.x1 = child.x1

if parent.x2 > child.x2:
    rightrect = duplicate(parent)
    rightrect.x1 = child.x2
    trimmedparent.x2 = child.x2

if parent.y1 < child.y1:
    toprect = duplicate(trimmedparent)
    toprect.y2 = child.y1

if parent.y2 > child.y2:
    bottomrect = duplicate(trimmedparent)
    bottomrect.y1 = child.y2 
```

唯一棘手的部分是消除leftrect 和toprect 可能相交的部分。我使用 'trimmedparent' 作为中间步骤从 toprect 修剪该部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T22:12:49.927

```
parent = Rectangle.new(x1,y1,mx1,my1)
child = Rectangle.new(x2,y2,mx2,my2)

rects = []
if (parent.contains(child))
  rects.push Rectangle.new(parent.x, parent.y, parent.mx, child.y) if child.y>parent.y
  rects.push Rectangle.new(parent.x, child.my, parent.mx, parent.my) if child.my<parent.my
  rects.push Rectangle.new(parent.x, parent.y, child.x, pareny.my) if child.x>parent.x
  rects.push Rectangle.new(child.mx, parent.y, parent.mx, parent.my) if child.mx<parent.mx
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:15:57.783

这是基本算法：

对于子节点中的每个点，如果它在父节点内部，则对应的子节点和父节点组成对角线一个矩形。现在，对于子节点的每一侧，如果两个点在父节点中，则这两个点和父节点边缘上的匹配点形成一个矩形。如果子节点边缘上只有一个点在父节点中，则该点与子节点边缘点对应的父节点不在父节点中，形成一个矩形的对角线。返回这些矩形。

您将获得最多八个矩形（每个角一个，每个边一个）。如果您想要尽可能少的矩形，请查看它们是否共享边缘，如果共享，则将它们组合起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T23:50:14.033

这是计算父项非重叠区域的另一种方法：

```
Function max(ByVal v1 As Double, ByVal v2 As Double) As Double
    If v1 > v2 Then
        Return v1
    Else
        Return v2
    End If
End Function

Function min(ByVal v1 As Double, ByVal v2 As Double) As Double
    If v1 > v2 Then
        Return v2
    Else
        Return v1
    End If
End Function

Function IntervalOverLap(ByVal p1 As Double, ByVal p2 As Double, ByVal c1 As Double, ByVal c2 As Double) As Double
    'determine how much of the parent(p1 to p2) segment '
    ' is overlapped by the child(c1 to c2) segment      '

    'sort to standard direction  '
    Dim ph As Double = max(p1, p2)
    Dim pl As Double = min(p1, p2)
    Dim ch As Double = max(c1, c2)
    Dim cl As Double = min(c1, c2)

    'restrict the child to within the parent '
    ch = min(ph, max(pl, ch))
    cl = max(pl, min(cl, ph))

    'return the overlapped length  '
    Return (ch - cl)
End Function

Function NonOverLappedArea(ByVal parent As Rectangle, ByVal child As Rectangle) As Double
    'return the area of the parent        '
    ' that is not overlapped by the child '
    Return IntervalOverLap(parent.X1, parent.X2, child.X1, child.X2) _
        * IntervalOverLap(parent.Y1, parent.Y2, child.Y1, child.Y2)
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T23:56:54.990

根据您的描述，孩子总是完全被父母所包含。所以非重叠区域总是一个矩形甜甜圈，尽管它可能在 4 个边中的任何一个上退化，因为子边可能与父边相邻，完全退化的情况是子边与父边相同.

甜甜圈可以分解成4个矩形。分解可能不是唯一的，这意味着您可以根据执行分解的方式获得不同的矩形。在 4 个矩形中，丢弃退化的（面积为 0 的），就完成了。

这是一个垂直偏向的分解

```
// assume the child is known to be in the parent bounds at this point
// assume parent and child are normalized
std::vector<CRect> rects;
CRect rect( parent.x1(), parent.y1(), child.x1(), parent.y2() ); // left
if ( rect.area() > 0.0 ) rects.push_back(rect);
rect.set( child.x1(), parent.y1(), child.x2(), child.y1() ); // bottom
if ( rect.area() > 0.0 ) rects.push_back(rect);
rect.set( child.x1(), child.y2(), child.x2(), parent.y2() ) ); // top
if ( rect.area() > 0.0 ) rects.push_back(rect);
rect.set( child.x2(), parent.y1(), parent.x2(), parent.y2() ) ); // right
if ( rect.area() > 0.0 ) rects.push_back(rect);

// yes, this could be written without all the code replication... :) 
```

# javascript - 来自输入元素的文件数据

> ID：942105
> 
> 赞同：6
> 
> 时间：2009-06-02T21:56:38.710
> 
> 标签：javascript, cross-browser

在 Firefox 3 中，可以访问`<input type="file">`元素的内容，如下所示。

假设一个包含以下元素的表单：

```
<input type="file" id="myinput"> 
```

现在可以通过以下方式访问所选文件的数据：

```
// Get the file's data as a data: URL
document.getElementById('myinput').files[0].getAsDataURL() 
```

**有没有跨浏览器的方法来完成同样的事情？**

此功能的 Firefox 文档：

*   [https://developer.mozilla.org/en/nsIDOMFileList](https://developer.mozilla.org/en/nsIDOMFileList)
*   [https://developer.mozilla.org/en/nsIDOMFile](https://developer.mozilla.org/en/nsIDOMFile)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-12-02T06:18:57.280

这至少在 Chrome、Firefox 和 Safari 中是可能的：[阅读文件](http://www.html5rocks.com/en/tutorials/file/dndfiles/#toc-reading-files)。查看相关[的 jsfiddle](http://jsfiddle.net/paulftw/htsDK/15/)

```
function readBlob(opt_startByte, opt_stopByte) {

    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }
    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
          document.getElementById('byte_content').textContent = _.reduce(evt.target.result, 
              function(sum, byte) {
                  return sum + ' 0x' + String(byte).charCodeAt(0).toString(16);
              }, '');
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob;
    if (file.slice) {
        blob = file.slice(start, stop + 1);
    }else if (file.webkitSlice) {
      blob = file.webkitSlice(start, stop + 1);
    } else if (file.mozSlice) {
      blob = file.mozSlice(start, stop + 1);
    }
    console.log('reader: ', reader);
    reader.readAsBinaryString(blob);
  }

  document.querySelector('.readBytesButtons').addEventListener('click', function(evt) {
    if (evt.target.tagName.toLowerCase() == 'button') {
      var startByte = evt.target.getAttribute('data-startbyte');
      var endByte = evt.target.getAttribute('data-endbyte');
      readBlob(startByte, endByte);
    }
  }, false); 
```

# .net - 为什么一个简单的 <% Eval() %> 可以在 IE 和 Chrome 中工作，而不是在 Firefox 中？

> ID：942109
> 
> 赞同：1
> 
> 时间：2009-06-02T21:58:40.063
> 
> 标签：.net, asp.net

下面的代码：

```
<asp:HyperLink ID="Image1_Link" runat="server" 
Text='<% "< img src=" + PhotoGalleryBaseUrl +  Eval("image_file_name") + ">" %>'>
</asp:HyperLink>
Image Size:
<asp:Label ID="image_sizeLabel" runat="server" Text='<%# Eval("image_size") %>'>
</asp:Label><br /> 
```

在 Chrome 和 IE 中呈现这样的效果： [Right Rendering http://cp.images.s3.amazonaws.com/ForumImages/cp-6-2-2009-4.53.28%20PM-03.png](http://cp.images.s3.amazonaws.com/ForumImages/cp-6-2-2009-4.53.28%20PM-03.png)

并在 Firefox 中这样渲染（这显然是错误的）： [错误渲染 http://cp.images.s3.amazonaws.com/ForumImages/cp-6-2-2009-4.55.10%20PM-04.png](http://cp.images.s3.amazonaws.com/ForumImages/cp-6-2-2009-4.55.10%20PM-04.png)

编辑 2：将 # 符号放在 <% 前面不起作用。使用 # 符号，它在所有浏览器中都无法正确呈现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T22:08:30.090

您是否查看过呈现的页面源代码。如果是这样，它会产生相同的来源吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:33:03.503

您正在将链接的文本设置为一些奇怪的字符串。如果名称中有空格，引号在构造的字符串中不起作用。

如果您确实想在链接中显示图像，请改用 ImageUrl。

<% ... %> 正在发送到浏览器。IE 和 Chrome 只是忽略它作为评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T22:47:31.400

另一个尝试的选择是：

```
<asp:HyperLink ID="HyperLink1" runat="server" 
Text='<%# GetImageString(PhotoGalleryBaseUrl + Eval("image_file_name").ToString() )%>'>
</asp:HyperLink> 
```

（不要忘记 Eval 上的字符串转换）

其中 GetImageString() 是页面上的公共方法：

```
public string GetImageString(string imageFilePath)
{
return "<img src='" + imageFilePath + "'>";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T22:01:20.683

我相信这是因为您在这里缺少“#”语句。试一试（这是未经测试的）。

```
 Text='<% "< img src=
    // should be
    Text='<%# "< img src= 
```

**[编辑]**

你能用这段代码重试一下，看看它是否有效？

```
<asp:HyperLink ID="Image1_Link" runat="server">
<%# "<img src='" + PhotoGalleryBaseUrl +  Eval("image_file_name") + "' />" %>
</asp:HyperLink>
Image Size:
<asp:Label ID="image_sizeLabel" runat="server" Text='<%# Eval("image_size") %>'>
</asp:Label><br /> 
```

# c++ - 将 32 位路径转换为其 WOW64 等效项

> ID：942110
> 
> 赞同：4
> 
> 时间：2009-06-02T21:58:48.567
> 
> 标签：c++, windows, mfc, wow64

我可以在 32 位应用程序中调用任何函数来将它认为正在使用的路径转换为实际使用的路径吗？（例如，调用它来将 Program Files 中的文件夹的路径转换为 ​​Program Files (x86) 中的路径，或者在 64 位系统上运行时反之亦然。）我需要这样做，以便当用户在 GUI 中显示一个目录（如浏览文件或目录时），他看到的是真实的目录，而不是应用程序本身认为它看到的目录。

我们需要同时支持 32 位和 64 位 Windows，因此这应该在两种环境中都可以工作。

**编辑**处理WOW64的需要在于我的应用程序是安装程序的引导应用程序。默认情况下，该产品安装在 32 位系统上的 Program Files 下，而在 64 位系统上，它安装在 Program Files (x86) 下。允许用户选择安装产品的位置的对话框（如果他想要或需要的话，包括完全不同的硬盘驱动器）；它必须在两种环境中都能正常工作。目前，它始终显示（和浏览）程序文件，即使在 64 位系统上也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:13:36.853

浏览 Program Files 和 Windows\System32 是您的应用程序的用例吗？我鼓励你放弃解决这个问题，因为它变得*非常*丑陋。要么全部留在 32 位世界，要么重新编译为 x64。生活在 WOW64 的“中间”世界中会使您的代码更加复杂。

如果你真的想这样做， http: [//msdn.microsoft.com/en-us/library/aa365743](http://msdn.microsoft.com/en-us/library/aa365743(VS.85).aspx) (VS.85).aspx可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T08:32:01.967

在这里，我有一个禁用 wow64 重定向的工作示例：

```
BOOL CCopyUtils::CopyServiceFiles(CAtlString szSourceDir, CAtlString szTargetDir)
{
    BOOL bResult = TRUE;
    TCHAR szSource[MAX_PATH];
    TCHAR szDest[MAX_PATH];
    TCHAR szSourceFile[MAX_PATH];
    TCHAR szDestFile[MAX_PATH];

    HINSTANCE hDll;
    PVOID OldValue;
    Wow64DisableWow64FsRedirection pfWow64DisableWow64FsRedirection=NULL;
    Wow64RevertWow64FsRedirection pfWow64RevertWow64FsRedirection=NULL;

    hDll=LoadLibrary("Kernel32.dll");
    ATLASSERT(hDll!=NULL);

    pfWow64DisableWow64FsRedirection=(Wow64DisableWow64FsRedirection)GetProcAddress(
        hDll, "Wow64DisableWow64FsRedirection");
    // http://msdn.microsoft.com/en-us/library/aa365745(VS.85).aspx
    pfWow64RevertWow64FsRedirection=(Wow64RevertWow64FsRedirection)GetProcAddress(
        hDll, "Wow64RevertWow64FsRedirection");

    if(pfWow64DisableWow64FsRedirection==NULL)
        ATLTRACE(_T("Function 'Wow64DisableWow64FsRedirection' not loaded."));
    else if((pfWow64DisableWow64FsRedirection)(&OldValue)==TRUE)
        ATLTRACE(_T("Wow64 filesystem redirecton disabled."));
    else 
        ATLTRACE(_T("Wow64 filesystem redirecton not disabled."));

    if (_taccess(szTargetDir, 0) != 0)
        _tmkdir(szTargetDir);

    DeleteOldFiles(szTargetDir);

    int  i = 0;
    _tcscpy(szSource, szSourceDir);
    if (szSource[_tcslen (szSource) -1] != '\\')
        _tcscat (szSource,"\\");    

    _tcscpy(szDest, szTargetDir);
    if (szDest[_tcslen (szDest) -1] != '\\')
        _tcscat (szDest,"\\");    

    while (m_ServiceFiles[i] != NULL)
    {
        _tcscpy(szSourceFile, szSource);
        _tcscat(szSourceFile, m_ServiceFiles[i]);

        _tcscpy(szDestFile, szDest);
        _tcscat(szDestFile, m_ServiceFiles[i]);

        if (!CopyFile(szSourceFile, szDestFile, FALSE))     
        {
            bResult = FALSE;
            ATLTRACE(_T("Error coping %s to %s\n"), szSourceFile, szDestFile);
            ATLASSERT(FALSE);                   
            break;
        }
        i++;
    }

    if(pfWow64RevertWow64FsRedirection==NULL)
        ATLTRACE(_T("Function 'pfWow64RevertWow64FsRedirection' not loaded."));
    else if((pfWow64RevertWow64FsRedirection)(OldValue)==TRUE)
        ATLTRACE(_T("Wow64 filesystem redirecton restored."));
    else 
        ATLTRACE(_T("Wow64 filesystem redirecton not restored."));
    FreeLibrary(hDll);

    return bResult;
} 
```

此致

# flash - Flash player 10 - 全屏模式和键盘

> ID：942111
> 
> 赞同：0
> 
> 时间：2009-06-02T21:58:50.313
> 
> 标签：flash, actionscript-3, internet-explorer, keyboard, fullscreen

我正在编写具有全屏功能的 Flash 应用程序（Flash Player 10、AS 3.0）。我对那部分进行了排序（`allowFullscreen=true`，`stage.displayState`）。

我想让用户能够通过标签浏览那里的项目并使用空格 ( `MouseEvent.CLICK`;-) 激活它们。我知道在全屏模式下会阻止任何键盘操作。[这个 Adob​​e 的 devnet 页面](http://www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes_03.html#head5)建议从 Flash Player 10 开始，某些键（制表符、空格、箭头）可以在全屏模式下使用。

这在 Chrome、Firefox、Opera、Safari 中检查出来......但不是 IE（至少是 IE6）。IE6 根本就没有键盘。没有任何作用：制表符，空格......当然除了 Esc ;-)

我错过了什么吗？
可能有什么问题？
我在 localhost 上的测试会影响这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:07:21.200

那是一个错误，来自浏览器......我已经看到了很多关于它的讨论，一个在 flashhilfe.de（可能不会帮助你们），在某些页面上嵌入了一个测试 swiff，每个人试过......在我的电脑上，甚至Firefox和Opera都完全失败了......

恐怕，你可能无能为力...

只是一点点说明：从用户的角度来看，让您的应用程序动态可扩展始终是最好的，因此用户可以决定他喜欢哪种大小......许多人对应用程序创建弹出窗口或调整浏览器大小感到不安窗户...

问候

back2dos

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-13T15:36:49.587

我一直在看这个视频播放器，FF3.6.6 中播放器 10、1、53、64（调​​试播放器）的键工作正常，不能在 IE7 中工作，tab 键在这个中不起作用任何一个。

如果您在舞台上有一个 KeyboardEvent 并监听按键，那么您将看到它们以全屏模式触发。

当`MouseEvent.CLICK`按钮有焦点时按空格键不会触发，所以我让按钮触发的方式是将 KEY_DOWN 侦听器添加到舞台，打开`stage.focus`并调用函数。IE

```
this.stage.addEventListener(KeyboardEvent.KEY_UP, _keyUp); 

private function _keyUp(e:KeyboardEvent):void 
{ 
   if(this.stage.displayState != StageDisplayState.FULL_SCREEN) return;
   switch(this.stage.focus) 
   { 
      case myButtonInstance: 
         //call function here 
      break; 
   } 
} 
```

希望这可以帮助。

# embedded - 如何从微控制器迁移到嵌入式 linux？

> ID：942112
> 
> 赞同：15
> 
> 时间：2009-06-02T21:59:00.047
> 
> 标签：embedded, embedded-linux

作为这个问题的对立面：[“对于软件开发人员来说，低级嵌入式系统编程难吗？”](https://stackoverflow.com/questions/231543/is-low-level-embedded-systems-programming-hard-for-software-developers)我想就从低级嵌入式系统转向使用操作系统的更高级系统编程，尤其是嵌入式 Linux 寻求建议。

我主要使用小型微控制器硬件和软件，但现在只做软件。我的教育也主要包括硬件和嵌入式的东西。我没有多少编程课程，对软件设计或OO编码了解不多。

现在我手头有一个大项目，将在嵌入式 Linux 中完成。我在设计事物和保持事物可管理方面遇到了重大问题，因为我以前真的不需要这样做。同样利用多任务和阻塞调用而不是从主函数运行“并行”任务就像另一个世界。

您在从低级编程转向使用 OS（Linux）的更大系统方面有哪些经验？什么是困难的，你是如何解决的？需要什么样的心态？

从零开始学习 C++ 还是继续使用纯 C 是否值得？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T22:09:01.383

使用 Linux 内核替换微控制器系统的主要问题是驱动您正在与之交互的设备。为此，您可能必须编写驱动程序。我会说**坚持使用 C**作为语言，因为您将希望保持用户空间尽可能干净。查看**uclibc**库以获得更精简的 C 标准库。

[http://www.uclibc.org/](http://www.uclibc.org/)

您可能还会发现**busybox**很有用。这提供了许多用户空间实用程序作为单个二进制文件。

[http://www.busybox.net/](http://www.busybox.net/)

然后，只需从某个存储启动到一个实时系统，并通过与您的硬件接口的 init 运行一些控制逻辑。如果需要，您可以访问实时系统并运行 busybox 实用程序。实际上，唯一的区别是用户空间比正态分布更精简，并且在目标方面您将“更接近”内核。

还可以查看实时 linux。

[http://www.realtimelinuxfoundation.org/](http://www.realtimelinuxfoundation.org/)

如果您需要一些正式的任务完成承诺。我怀疑最难的部分将是启动/持久存储以及与您的硬件接口（如果它是异国情调的）。如果您不熟悉 Linux 引导，那么

[http://www.cromwell-intl.com/unix/linux-boot.html](http://www.cromwell-intl.com/unix/linux-boot.html)

可能有帮助。

简而言之，如果您没有深入开发 Linux，没有构建自己的发行版，或者没有内核经验，那么**您可能会发现编程很难**。

[http://www.linuxdevices.com/](http://www.linuxdevices.com/)可能也有帮助

**祝你好运**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:11:38.577

为了使用 Unix/Linux，您应该了解 Unix 哲学： http: [//www.faqs.org/docs/artu/ch01s06.html](http://www.faqs.org/docs/artu/ch01s06.html)

我认为整本书读起来很有趣：http: [//www.faqs.org/docs/artu/index.html](http://www.faqs.org/docs/artu/index.html)

在这里，您可以找到用于嵌入式目标的免费 Linux 发行版以及引导加载程序以帮助您入门： http: [//www.denx.de/wiki/DULG/WebHome](http://www.denx.de/wiki/DULG/WebHome)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T11:56:45.203

不久前，我陷入了非常相似的困境。我购买并阅读了[Embedded Linux Primer](https://rads.stackoverflow.com/amzn/click/com/0131679848)，它是一种非常有帮助的方式，可以让你从心理上过渡到高级操作系统（从微控制器的角度来看）。

如果你有“时间‘慢慢来’”，你显然可以进行过渡。但是，如果您需要快速上手，您可能需要强烈考虑聘请技术导师来帮助指导您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-09T04:20:37.313

[您还可能会发现从ucLinux](http://www.uclinux.org/)开始进入 Linux 很有用。它基本上是微控制器上的 Linux。您可以在没有虚拟内存方面作为过渡的情况下对内核有所了解。查看 ucLinux 是否支持您已经熟悉的微控制器，并查看内核如何与该架构交互。

我同意 Embedded Linux Primer 这本书非常适合让您的大脑围绕嵌入式 Linux 进行学习。你现在最好还是坚持使用 C。C++ 可以等待，它对应用程序更有用，而不是驱动程序代码。

当您对 ucLinux 的运行方式感到满意时，您可以从具有 MMU 和虚拟内存的微处理器架构（例如 ARM）上的普通 Linux 内核开始。

只是我的两分钱！

# silverlight - 右侧的 Silverlight DataGrid 烦人的额外列

> ID：942117
> 
> 赞同：1
> 
> 时间：2009-06-02T21:59:40.343
> 
> 标签：silverlight

我在 silverlight 数据网格中添加动态列。我想为列分配宽度，使其覆盖整个网格宽度。

我尝试了提到的这个解决方案，但它仍然添加了一个额外的列，而不是将剩余的列拆分为相同的宽度。

[增加 Silverlight DataGrid 中的列宽以填充整个 DG 宽度](https://stackoverflow.com/questions/894991/increase-columns-width-in-silverlight-datagrid-to-fill-whole-dg-width)

对此的任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-07T10:20:59.720

在数据网格的最后一列中添加 Width="*"。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-17T18:58:28.043

在 silverlight 4 中：只需在 DataGrid 上设置 ColumnWidth="*"

```
<data:DataGrid ColumnWidth="*" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:04:59.207

我已经使用自定义附加属性完成了此操作。代码在[这里](http://code.msdn.microsoft.com/SLDataGridProperties)。

# winapi - 从程序集调用 Windows API，同时最小化程序大小

> ID：942125
> 
> 赞同：1
> 
> 时间：2009-06-02T22:03:06.920
> 
> 标签：winapi, assembly, linker, nasm

我正在尝试在汇编中编写一个程序并使生成的可执行文件尽可能**小**。我正在做的一些事情需要对WriteProcessMemory 等函数进行Windows API 调用。我在调用这些函数方面取得了一些成功，但是在编译和链接之后，我的程序出现在 14-15 KB 的范围内。（来自不到 1 KB 的来源）我希望的远比这要少得多。

我对做这样的低级事情很陌生，所以我真的不知道需要做什么才能使程序更小。我知道 exe 格式本身占用了相当多的空间。有什么办法可以减少这种情况吗？

我应该提到我正在使用 NASM 和 GCC，但如果有帮助，我可以轻松更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T22:30:46.910

请参阅[Tiny PE](http://www.phreedom.org/solar/code/tinype/)，了解可用于减小可执行文件最终大小的一系列提示和技巧。请注意，该文章中的一些后期技术非常脆弱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T22:22:11.950

大多数 PE 文件的默认节对齐方式是 4K，以与自然系统内存布局对齐。如果您有 .data、.text 和 .resource 部分 - 已经是 12K。大部分都是0，浪费空间。

您可以采取一些措施来尽量减少这种浪费。首先，将节对齐减少到 512 字节（不知道 nasm/gcc 所需的选项）。其次，合并这些部分，以便您只有一个 .text 部分。尽管对于打开 NX 位的现代机器来说，这可能是一个问题。此安全功能可防止对可执行代码部分的修改，例如病毒。

还有大量的 PE 压缩工具可以压缩你的 PE 并在执行时解压缩它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:12:27.850

我建议使用[DumpBin](http://msdn.microsoft.com/en-us/library/c1h23y6c(VS.71).aspx)实用程序（或 GNU 的 objdump）来确定占用最多空间的内容。它可能是资源文件、巨大的全局变量或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T06:52:57.797

FWIW，我可以使用 ML 或 ML64 组装的最小程序约为 3kb。（这只是说你好世界并退出。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-08T00:15:21.270

给我一个小 C 程序（不是 C++），我会告诉你如何用它制作一个 1 ko .exe。我推荐的最小可执行文件大小是 1K，因为如果它不是至少这个大小，它将无法在某些 Windows 上运行。

您只需使用链接器开关即可实现！polink 是一个很好的链接器。

如果您在 Assembly 中完成所有操作，那就更容易了。只要去 MASM32 论坛，你就会看到很多这样的程序。

# jquery - 控制浏览器滚动量，jQuery

> ID：942131
> 
> 赞同：0
> 
> 时间：2009-06-02T22:04:34.730
> 
> 标签：jquery

有没有办法控制浏览器在 jquery 中的滚动量？例如，如果我想将内容添加到页面底部并使其始终位于底部，而其他所有内容都向上滚动（如终端）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:14:23.260

**这个网站（StackOverflow）**有答案......**看看源代码**

```
$.scrollTo("#answers-table", 400); 
```

在

```
<script type="text/javascript">
$().ready(function() {
    $(".answer-pager a, .tabs-answer-user a").click(function() {
        var url = $(this).attr('href');

        $.post(url, function(result) {
            var domelement = $(result);
            $("#answers-table").html(domelement);
        });

        $.scrollTo("#answers-table", 400);

        return false;
    });

});
</script> 
```

包括

```
<script src="/content/js/third-party/jquery.scrollTo-1.3.3-min.js" type="text/javascript"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T22:07:46.690

```
$(window).scroll(function(e) {
    e.preventDefault();
    //check browser scroll here and do whatever you want...
    //$(window).scrollTop();
}); 
```

**更新**

哦，我刚刚发现这是可能的：

```
$(window).scrollTo(xxx); //xxx = '100px', '10%' or 44 or '+=10px' 
```

# database - 存储+评估性能数据

> ID：942136
> 
> 赞同：2
> 
> 时间：2009-06-02T22:06:25.960
> 
> 标签：database, performance, language-agnostic, storage, measurement

由于我们的 Web 应用程序正在遭受缓慢的退化，我们决定监控我们的应用程序性能并衡量个人操作。

例如，我们将测量每个请求的持续时间、单个操作（如编辑客户或创建约会、搜索合同）的持续时间。在大多数情况下，数据库是这些操作的瓶颈。

我预计最终数据会非常大，因为我们将针对每个请求收集 1-5 个单独的操作。

当然，将每个元素都插入数据库是无稽之谈，因为这会进一步减慢每个请求。

什么是存储和评估这些每个请求数据的好策略。我想过有一个附加的全局队列对象和一个单独的线程来清空队列并处理持久存储/文件。但是在哪里存储这些数据？有没有用于这种可视化的预建工具？

我们使用java、spring、混合hibernate+jdbc+pl/sql、oracle。

不过，这个问题应该与语言无关。

编辑：测量将在很长一段时间内在生产中进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:12:14.217

您的存档策略似乎至少部分取决于您的测试范围：

*   您打算在多长时间内收集性能数据？
*   你想证明什么？随着时间的推移性能改进？与特定更改相关的改进？（就像一组特定版本的性能问题）

至于可视化工具，我发现 excel 对于少量到中等数量的数据非常有用。

# c# - 要解密的数据长度无效

> ID：942139
> 
> 赞同：12
> 
> 时间：2009-06-02T22:07:56.083
> 
> 标签：c#, cryptography, rijndaelmanaged

我正在尝试使用 RijndaelManaged 通过套接字加密和解密文件流，但我一直遇到异常

```
CryptographicException：要解密的数据长度无效。
    在 System.Security.Cryptography.RijndaelManagedTransform.TransformFinalBlock（字节 [] inputBuffer，Int32 inputOffset，Int32 inputCount）
    在 System.Security.Cryptography.CryptoStream.FlushFinalBlock()
    在 System.Security.Cryptography.CryptoStream.Dispose（布尔处理）

```

当整个文件已被传输时，在 receiveFile 中的 using 语句结束时会引发异常。

我尝试在网上搜索，但只找到了在加密和解密单个字符串时使用 Encoding 时出现的问题的答案。我使用 FileStream，所以我没有指定要使用的任何编码，所以这不应该是问题。这些是我的方法：

```
private void transferFile(FileInfo file, long position, long readBytes)
{
    // transfer on socket stream
    Stream stream = new FileStream(file.FullName, FileMode.Open);
    if (position > 0)
    {
        stream.Seek(position, SeekOrigin.Begin);
    }
    // if this should be encrypted, wrap the encryptor stream
    if (UseCipher)
    {
        stream = new CryptoStream(stream, streamEncryptor, CryptoStreamMode.Read);
    }
    using (stream)
    {
        int read;
        byte[] array = new byte[8096];
        while ((read = stream.Read(array, 0, array.Length)) > 0)
        {
            streamSocket.Send(array, 0, read, SocketFlags.None);
            position += read;
        }
    }
}

private void receiveFile(FileInfo transferFile)
{
    byte[] array = new byte[8096];
    // receive file
    Stream stream = new FileStream(transferFile.FullName, FileMode.Append);
    if (UseCipher)
    {
        stream = new CryptoStream(stream, streamDecryptor, CryptoStreamMode.Write);
    }
    using (stream)
    {
        long position = new FileInfo(transferFile.Path).Length;
        while (position < transferFile.Length)
        {
            int maxRead = Math.Min(array.Length, (int)(transferFile.Length - position));
            int read = position < array.Length
                        ? streamSocket.Receive(array, maxRead, SocketFlags.None)
                        : streamSocket.Receive(array, SocketFlags.None);
            stream.Write(array, 0, read);
            position += read;
        }
    }
} 
```

这是我用来设置密码的方法。byte[] init 是一个生成的字节数组。

```
private void setupStreamCipher(byte[] init)
{
    RijndaelManaged cipher = new RijndaelManaged();
    cipher.KeySize = cipher.BlockSize = 256; // bit size
    cipher.Mode = CipherMode.ECB;
    cipher.Padding = PaddingMode.ISO10126;
    byte[] keyBytes = new byte[32];
    byte[] ivBytes = new byte[32];

    Array.Copy(init, keyBytes, 32);
    Array.Copy(init, 32, ivBytes, 0, 32);

    streamEncryptor = cipher.CreateEncryptor(keyBytes, ivBytes);
    streamDecryptor = cipher.CreateDecryptor(keyBytes, ivBytes);
} 
```

有人知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T22:21:08.490

在我看来，您没有正确发送最后一个块。您至少需要`FlushFinalBlock()`发送`CryptoStream`以确保发送最终块（接收流正在寻找）。

顺便说一句，就您正在做的事情的安全性而言，这[`CipherMode.ECB`很可能是一场史诗般的失败。](http://www.codinghorror.com/blog/archives/001267.html)至少使用`CipherMode.CBC`（密码块链接），它实际上使用 IV 并使每个块依赖于前一个块。

编辑：哎呀，加密流处于读取模式。在这种情况下，您需要确保读取到 EOF 以便 CryptoStream 可以处理最后一个块，而不是在`readBytes`. 如果您在写入模式下运行加密流，可能更容易控制。

还有一点注意：您不能假设字节输入等于字节输出。分组密码具有它们处理的固定块大小，除非您使用将分组密码转换为流密码的密码模式，否则将存在使密文比明文更长的填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T16:41:38.700

在 Jeffrey Hantin 发表评论后，我将 receiveFile 中的一些行更改为

```
using (stream) {
    FileInfo finfo = new FileInfo(transferFile.Path);
    long position = finfo.Length;
    while (position < transferFile.Length) {
        int maxRead = Math.Min(array.Length, (int)(transferFile.Length - position));
        int read = position < array.Length
                   ? streamSocket.Receive(array, maxRead, SocketFlags.None)
                   : streamSocket.Receive(array, SocketFlags.None);
        stream.Write(array, 0, read);
        position += read;
    }
} 
```

`->`

```
using (stream) {
    int read = array.Length;
    while ((read = streamSocket.Receive(array, read, SocketFlags.None)) > 0) {
        stream.Write(array, 0, read);
        if ((read = streamSocket.Available) == 0) {
            break;
        }
    }
} 
```

瞧，她工作了（因为我之前不想打扰的那种很好的填充物）。我不确定如果 Available 返回 0 会发生什么，即使所有数据都没有传输，但我会在这种情况下稍后处理。感谢您的帮助杰弗里！

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:40:59.077

```
cipher.Mode = CipherMode.ECB; 
```

啊！滚动自己的安全代码几乎总是一个坏主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-08T01:02:16.317

我的我刚刚删除了填充，它可以工作

对此进行了注释 - cipher.Padding = PaddingMode.ISO10126;

# javascript - 虚拟地球 VEShapeLayer 不会渲染

> ID：942143
> 
> 赞同：0
> 
> 时间：2009-06-02T22:08:30.510
> 
> 标签：javascript, web-applications, virtual-earth, bing

目标：允许用户打开和关闭不同层的数据；并在地图移动事件中从数据库中动态提取当前范围的数据。

[如果您按照此处](http://krkinnan.members.winisp.net/samples/v5/veshapes/veshapelayersample1.html)完成的方式对 VEShapeLayers 进行硬编码，这将非常有效。

我的图层列表来自数据库，我的一切都按照我想要的方式工作，除了当我将形状添加到我的 VEShapeLayer 时，我的地图上没有呈现任何形状。调用 VEShapeLayer.GetShapeCount() 返回预期的数字......所以图层有数据......

以下是代码的重要部分：

```
var assets = [];
if (WebServiceResult.length > 0) {
    for (var i = 0; i < WebServiceResult.length; i++) {
        var ix = FindLayerIndex(WebServiceResult[0].AssetMapLayer);
        var velatlong = new VELatLong();
        velatlong.Latitude = WebServiceResult[i].Latitude;
        velatlong.Longitude = WebServiceResult[i].Longitude;
        newShape = new VEShape(VEShapeType.Pushpin, velatlong);
        assets.push(newShape);
    }
    // ix is defined above and is vaild and correct
    map.GetShapeLayerByIndex(ix).AddShape(assets);
}
// a call here to map.GetShapeLayerByIndex(ix).GetShapeCount()     
// returns the expected number of shapes 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:09:27.210

我觉得很笨；我没有将样式表添加到我的页面标题中，并且由于样式表不可用，我的自定义图标呈现透明。

# python - Django 1.0，使用默认密码重置

> ID：942148
> 
> 赞同：6
> 
> 时间：2009-06-02T22:09:28.480
> 
> 标签：python, django

我正在尝试使用 Django 附带的密码重置设置，但文档对它不是很好。我正在使用 Django 1.0，但我不断收到此错误：

```
Caught an exception while rendering: Reverse for 'mysite.django.contrib.auth.views.password_reset_confirm' with arguments '()' and keyword arguments ... 
```

在我的 urlconf 我有这样的东西：

```
#django.contrib.auth.views
urlpatterns = patterns('django.contrib.auth.views',    
    (r'^password_reset/$', 'password_reset', {'template_name': 'accounts/registration/password_reset_form.html', 'email_template_name':'accounts/registration/password_reset_email.html', 'post_reset_redirect':'accounts/login/'}),
    (r'^password_reset/done/$', 'password_reset_done', {'template_name': 'accounts/registration/password_reset_done.html'}),
    (r'^reset/(?P<uidb36>[0-9A-Za-z]+)-(?P<token>.+)/$', 'password_reset_confirm', {'template_name': 'accounts/registration/password_reset_confirm.html', 'post_reset_redirect':'accounts/login/', 'post_reset_redirect':'accounts/reset/done/'}),
    (r'^reset/done/$', 'password_reset_complete', {'template_name': 'accounts/registration/password_reset_complete.html'}),
) 
```

问题似乎出在这个文件中：

```
password_reset_email.html 
```

在第 7 行

```
{% url django.contrib.auth.views.password_reset_confirm uidb36=uid, token=token %} 
```

我不知道发生了什么，所以任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T12:26:55.597

**编辑**：我使用了您的示例，并且不得不更改为不使用关键字参数。

```
{% url django.contrib.auth.views.password_reset_confirm uid, token %} 
```

只要定义了 uid 和 token ，命名参数就可以工作。如果未定义或空白，我会收到与您相同的错误：

```
{% url django.contrib.auth.views.password_reset_confirm uidb36=uid, token=token %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:38:23.273

只是想发布我想出的解决方案。问题出在这一行：

```
{% url django.contrib.auth.views.password_reset_confirm uidb36=uid, token=token %} 
```

我也不是 100% 为什么，所以我只是硬编码了这样的网址：

```
http://mysite.com/accounts/reset/{{uid}}-{{token}}/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-10T09:13:00.197

我已经为此苦苦挣扎了一个多小时，尝试了这个页面和互联网上所有其他页面上的所有内容。最后为了解决我的问题，我不得不删除

```
{% load url from future %} 
```

从我的 password_reset_email.html 模板的顶部。

另请注意，url 脚本中的“uidb36=uid”。这是我完整的 password_reset_email.html 模板，我希望它可以节省一些时间：

```
{% autoescape off %}
    You're receiving this e-mail because you requested a password reset for your user account at {{ site_name }}.

Please go to the following page and choose a new password:
{% block reset_link %}
{{ protocol }}://{{ domain }}{% url django.contrib.auth.views.password_reset_confirm uidb36=uid token=token %}
{% endblock %}

Your username, in case you've forgotten:" %} {{ user.username }}

Thanks for using our site!

The {{ site_name }} team

{% endautoescape %} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:15:04.303

这是我在 10 分钟前发现自己的问题。解决方案是将 post_change_redirect 值添加到您传递给 password_reset 视图的参数字典中。

所以这就是我现在的样子：

```
(r'^/password/$', password_change, {'template_name': 'testing/password.html', 'post_change_redirect': '/account/'}) 
```

我希望这对你有用！我同意这个特定功能的文档有些缺乏，但这解决了我的项目完全相同的问题。

编辑：我真的应该滚动浏览 - 你已经包含了。对此表示歉意，但我希望你能把它整理好:)

# c# - 如何使用 C#/WPF 在 MouseEnter 和 MouseLeave 事件上为 ListBox 项设置动画？

> ID：942149
> 
> 赞同：3
> 
> 时间：2009-06-02T22:09:47.483
> 
> 标签：c#, wpf, animation, listboxitem

我无法通过 C# 代码为列表项捕获/触发 OnMouseEnter 或 OnMouseLeave 事件。需要明确的是，我不需要 OnSelectedItem 事件。

我想要做的是能够处理 ListBoxItem 的 OnMouseEnter 和 OnMouseLeave 事件，这将启动该 ListBoxItem 的 DoubleAnimation - 我想在 MouseEnter 上放大其字体并在 MouseLeave 上恢复到原始大小。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T22:14:32.370

像这样的东西（作为 ListBox 的 DataTemplate 的一部分）：

```
<DataTemplate.Triggers>
    <EventTrigger
        SourceName="BorderControl"
        RoutedEvent="TextBlock.MouseEnter">
        <BeginStoryboard>
            <Storyboard>
                <ColorAnimation Storyboard.TargetName="BorderControl"
                    Storyboard.TargetProperty="Background.Color"
                    To="DarkRed" Duration="00:00:00.2" />
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
    <EventTrigger
        SourceName="BorderControl"
        RoutedEvent="TextBlock.MouseLeave">
        <BeginStoryboard>
            <Storyboard>
                <ColorAnimation Storyboard.TargetName="BorderControl"
                    Storyboard.TargetProperty="Background.Color"
                    To="WhiteSmoke" Duration="00:00:00.2" />
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</DataTemplate.Triggers> 
```

通过[http://www.dotnet-blog.com/index.php/2009/01/29/how-to-style-and-animate-a-wpf-listbox/](http://www.dotnet-blog.com/index.php/2009/01/29/how-to-style-and-animate-a-wpf-listbox/)

# sql - 从包含互惠关系的表中提取唯一对

> ID：942160
> 
> 赞同：0
> 
> 时间：2009-06-02T22:13:12.967
> 
> 标签：sql, sql-server-2005, tsql

考虑一个***SQL Server 2005***数据库，其中包含很多人的大量数据，其中很大一部分人*已婚*。为了跟踪人们之间的关系，存在一个**关系**表，用于将一个人的 ID 链接到另一个人的 ID。每个关系记录上的*关系类型*用于指示所讨论的两个人之间存在的关系类型（duh）：“结婚”、“是儿子”、“是女儿”等。

对于已婚人士，表中有两条关系记录——一条显示人 A 与人 B 结婚，另一条记录显示人 B 与人 A 结婚。对于婚姻，没有两条记录将被认为是错误的，尽管数据库中有一些未回报的记录。（这是一个继承的设计，我没有改变这种方法的自由。）

```
RelID  Person1  Person2  RelationshipType
-----------------------------------------
1      1001     1010     Married           //Reciprocated by RelID 4
2      1002     1011     Married           //Reciprocated by RelID 5
3      1003     1012     Married           //Reciprocated by RelID 6
4      1010     1001     Married           //Reciprocated by RelID 1
5      1011     1002     Married           //Reciprocated by RelID 2
6      1012     1003     Married           //Reciprocated by RelID 3
7      1004     1013     Married           //Not properly reciprocated 
```

我需要做的是从表中提取独特的已婚夫妇。

我创建了一个名为***GetOrderedPair(val1,val2)***的函数，它接受 2 个人员 ID，并按顺序返回两个值的逗号分隔字符串值。这样，无论我是否得到，它总是返回相同的字符串值，参考上面的示例数据，Person1 和 Person2 来自 RelID 为 1 或 RelID 为 4 的记录（一对往复记录）。

我不禁想到有一种更好的方法可以躲避我。使用这个功能是最好的方法吗？你还能推荐什么？

谢谢，当然，提前。:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T22:22:02.137

既然你已经封装了 GetOrderPair，我不知道它背后的逻辑，但我至少会给你我所做的：

```
select distinct
    case when Person1 > Person2 then Person2 else Person1 end as Person1,
    case when Person1 > Person2 then Person1 else Person2 end as Person2
from
    couples
where
    relationshiptype = 'Married' 
```

也许有人比我有更好的方法来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:20:48.210

老实说，我不完全明白你的问题是什么。通常，要获取已婚夫妇的列表，您可以执行如下简单查询：

```
SELECT p1.*, p2.*
FROM   Person AS p1
JOIN   Relationship r ON p1.PersonID = r.Person1 AND r.RelationshipType = 'Married'
JOIN   Person AS p2 ON r.Person2 = p2.PersonID
WHERE  p1.PersonID < p2.PersonID  --This would ensure that you only get each couple "once" 
```

这是你要找的那种东西吗？

# sql - 在每一行将数据从一个字段复制到另一个字段

> ID：942161
> 
> 赞同：5
> 
> 时间：2009-06-02T22:13:15.197
> 
> 标签：sql, mysql

所以我有：

```
id    number
 1      0
 2      0
 3      0 
```

是否有一个 sql 语句可以将所有内容从 id 复制到 number 中？

我即将编写一个 php 脚本来选择，然后更新每一行。我的 SQL 知识非常基础，但我确信有一个聪明人可以做到这一点：

背景：id 曾经是应用程序中显示的一个数字，并且是唯一的。这个数字不再是唯一的，因为我添加了一些新功能——所以我需要将它移动到一个不是唯一的字段，同时保持旧的完整性。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T22:15:33.103

您可以使用更新语句并引用列。只需执行以下操作：

```
update mytable set number = id 
```

这将每行上的数字设置为等于 id。享受！

# .net - 版本号是 1.13 > 1.2？

> ID：942162
> 
> 赞同：18
> 
> 时间：2009-06-02T22:13:19.083
> 
> 标签：.net, assemblies, versioning

我从 .NET 的角度知道，版本为 1.13 的程序集被认为是比版本 1.2 更新的版本，因为版本中的每个数字都是单独评估的。然而，从数值的角度来看，1.13 小于 1.2。

问题归结为为客户发布更新时的可读性。从 0.0 到 0.9 都是一样的，但在 0.10 时你必须区分。那么，您是否将点发布的数量限制为 9，然后在达到 0.9 时增加主要版本？

请不要假设最终用户了解典型的开发版本编号方案。

**更新：**

> 不要把它想象成一个十进制数。(.) 是不同字段之间的分隔符。每个字段的含义（例如）：
> 
> ```
>  MajorRelease.MinorRelease.BuildNumber 
> ```

绝对地！这表明当我查看版本号时我会看到它。但这不是您的普通乔阅读文本“1.13”的方式。我想作为程序员，很容易将我们的理解投射到我们的用户身上。这就是为什么我对数字混乱的经验反应感兴趣。这可能不是一个真正的问题，或者可能只是被忽略了。

**更新 2：**响应“提供文档”或“向用户解释”类型的解决方案：它们不起作用！:) 如果您必须向用户解释版本号，您已经使它变得比需要的更复杂。虽然一项技术的主要受众可能是许多公司的开发人员，但软件的实际采购和管理是由完全没有开发或技术背景的秘书和文员处理的。如果他们的经理问他们“1.9 是否有新版本可用”并且他们看到“1.11”，他们可能不会将其注册为较新的版本。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-02T22:19:43.157

如果版本编号*看起来*像一个数字小数，版本编号可能会令人困惑，但**(.)**实际上是独立字段之间的**分隔符**，应该像这样读取：

**MajorRelease.MinorRelease.BuildNumber**

每个数字都独立于其他数字，因此**版本 1.12.99 后面**可能跟着**版本 1.12.100**（例如）。所以你最终得到：

> 在版本 1 中，次要版本 12... 版本 100 位于版本99*之后。*

因此，在您的示例中（v1.13 > v1.2）：次要版本“13”会在版本“2”*之后的某个时间出现。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T22:16:27.313

这是标准做法，任何关注版本“数字”*的人都应该意识到这一点*。可能存在任何误解的唯一原因是，如果您的版本“编号”只有一个点，例如“1.13”，在这种情况下，它可能*会与十进制数字混淆*（由不知情的读者），这是不幸的，因为它们尽管使用相同的符号，但表示完全不同的事物。您使用修订号吗？如果是这样，这就更清楚地表明版本不是小数，例如“1.13.2”。从设计的角度来看，我倾向于推荐这种做法。

旁白：如果你想以编程方式比较程序集的版本，你可以只使用[`Version`](http://msdn.microsoft.com/en-us/library/system.version.aspx)类，它重载了比较运算符，这样你就可以通过评估轻松检查哪个是更新的`versionA > versionB`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T23:09:47.220

**1.13 > 1.2**

如果您认为这可能会使客户感到困惑，请避开这个问题 - 从 1.10 开始编号 :)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T22:42:48.180

我更喜欢始终将填充版本号归零以避免混淆，并允许它们在“不知道版本”的应用程序中正确排序。在这种情况下，我会编号 1.13 > 1.02

优点是它可以按数字和字母顺序正确排序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T00:29:13.723

例如：3.1、95、98、Me、XP、Vista、7

只是弥补一些新的东西，客户并不像你想象的那么担心。解释新功能，而不是版本号。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-02T23:28:53.843

这个问题也困扰了我一段时间。“合理”字符串排序的零填充似乎是一个好主意（我希望有更多的源代码 tarball 遵循这一点；否则很难在几十个版本中发现最新的版本）。

我最近注意到开发人员将“1.13”称为“一点十三”，而不是“一点一三”，我想我会采用这种做法。它清楚地表明版本号是一串数字，而不是小数。也许我们应该选择用破折号或斜线代替点作为分隔符，以减少书面形式的歧义。

如果您确实将它们视为小数，那么当您接近新的主要版本时，您最终可能会得到像“1.999999”这样的版本号！（我记得带有行号的 BASIC 方言也有类似的问题。）它也让我想起了 Knuth 的 TeX 和`METAFONT`（分别向 pi 和 e 收敛，我认为这很棒：它表明软件具有明确的用途应该向理想状态收敛，而不是不断扩大）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T22:15:28.860

我只根据版本的重要性及其作为主要/次要版本的资格来增加不同的版本号。我想我并不太关心版本号的可读性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T22:16:04.287

不。在我见过的每个软件版本控制中，1.13 > 1.2

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T22:16:37.250

> 然而，从数值的角度来看，1.13 小于 1.2。

我不这么认为。

> 那么，您是否将点发布的数量限制为 9，然后在达到 0.9 时增加主要版本？

不。我的数字进入十位数。较大的项目进入数百个，用于临时构建。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T22:18:55.903

我不认为版本号是一个数字，而是一组数字元素。因此，我一直觉得 1.13 > 1.2 很自然。我不会仅仅因为之前的次要版本是 9 而增加主要版本，并且有人可能会认为（尽管我觉得不太可能）1.9 晚于 1.10。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-02T22:25:55.750

版本号只是为了让您知道您正在使用的构建版本以及让用户查看他们拥有的版本。

你如何做到这一点取决于你。

你可以做 ABC 或 I.II.III 或任何你喜欢的。

我尽量让用户理解起来很简单。因为我个人不在乎它是怎样的。

我有三层。主要.次要.构建

构建是可选的，在经常更新的项目上，我会在上面附上修订号以查看我们所处的位置。

Major 和 Minor 上的数字是整数，因此 13 大于 2，但通常我们不会在 Minor 修订中达到如此高的水平，我们更倾向于将次要构建批处理在一起并将它们推入 1 个主要版本。

# javascript - JCSompress - 处理 JS 文件中的特殊字符？

> ID：942163
> 
> 赞同：0
> 
> 时间：2009-06-02T22:13:32.670
> 
> 标签：javascript, msbuild, minify, jscompress

我正处于调查 JSCompress for MSBUILD 的初始阶段：http: [//msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)

对于我的初始测试，我有一些运行此任务的 JS 文件，其中一些文件包括已经缩小的 JS 文件（JQuery 库等），一些文件包含特殊字符。

当任务每次运行时遇到 JS 文件中的特殊字符时，它都会在屏幕上引发错误。我应该如何克服这个错误，以便它忽略特殊字符。

我不想根据文件名上的通配符（例如 **\jquery*.js）排除任何文件，因为开发人员可以将该名称用作其他一些 JS 文件的一部分，然后这些文件将在不缩小的情况下被排除。

有没有办法实现这一点，或者我应该看看其他工具？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-19T05:31:08.667

Use the replace method to replace the special characters with a character entity of your own creation. Then after you have evaluated all the code use the replace method again to revert the special character conversion. I found I had to do this in my Pretty Diff tool because JavaScript cannot evaluate the difference between single and double quotes passed as string literals.

# asp.net - 提及 LINQ 时出错

> ID：942164
> 
> 赞同：1
> 
> 时间：2009-06-02T22:13:37.083
> 
> 标签：asp.net, linq

我将我的项目从我的计算机移动到另一台计算机，当我打开它时，我遇到了 LINQ 的这个问题：

![在此处输入图像描述](https://i.stack.imgur.com/m7pT3.gif)

> System.Data.Linq.Table(Of Homework) 类型的表达式不可查询。确保您没有丢失 LINQ 提供程序的程序集引用和/或命名空间导入。

请问，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:17:24.003

听起来你不见了

```
Import System.Linq 
```

或对`System.Core.dll`. 我不明白为什么仅仅从移动到另一台计算机就会发生这种情况......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T02:30:28.157

您提到您在另一台计算机上——那台计算机上是否安装了 .NET 3.0+？如果没有，那么在安装之前您将无法访问 System.Linq。

# c# - ASP.NET MVC 中的 <%# 和 <%= 有什么区别？

> ID：942166
> 
> 赞同：8
> 
> 时间：2009-06-02T22:14:10.767
> 
> 标签：c#, asp.net-mvc

ASPX 内联代码中的 <%# 和 <%= 有什么区别？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T22:21:21.203

<%= 是 Response.Write() 的简写

<%# 用于在数据绑定控件中呈现数据

# c++ - c++仿函数和函数模板

> ID：942170
> 
> 赞同：16
> 
> 时间：2009-06-02T22:15:14.740
> 
> 标签：c++, templates, functor

考虑一下这个简单而毫无意义的代码。

```
#include <iostream>

struct A {
    template<int N>
    void test() {
        std::cout << N << std::endl;
    }
};

int main() {
    A a;
    a.test<1>();
} 
```

这是一个非常简单的函数模板示例。但是，如果我想`A::test`用重载替换`operator()`它以使其成为仿函数怎么办？

```
#include <iostream>

struct A {
    template<int N>
    void operator()() {
        std::cout << N << std::endl;
    }
};

int main() {
    A a;
    a<1>(); // <-- error, how do I do this?
} 
```

当然如果`operator()`取了依赖于模板的参数，编译器就有可能推导出模板。但我只是想不出用无参数仿函数指定模板参数的正确语法。

**有没有合适的方法来做到这一点？**

显然，这段代码可以工作，因为它绕过了仿函数语法：

```
a.operator()<1>(); 
```

但这有点违背了它成为函子的目的：-P。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-02T22:21:55.430

你只能打电话

```
a.operator()<1>(); 
```

但这不会使用仿函数。Functors 需要一个非模板 operator()，因为它们必须能够被称为*varname()*并且不适用于您的代码。

要使其成为真正的仿函数，请将您的代码更改为模板类（仿函数是类）：

```
#include <iostream>

template<int N>
struct A {
    void operator()() {
        std::cout << N << std::endl;
    }
};

int main() {
    A<1> a;
    a();
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-02T22:17:25.750

除了以下之外，我没有其他“直接”方式：

```
 a.operator()<1>(); 
```

句法。如果您愿意更改代码，将模板参数移动到类中会起作用，或者使用 (boost|tr1)::bind 来创建 (boost|tr1)::function 对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T22:23:00.700

您正在尝试将模板参数传递给对象的实例，据我所知这是不允许的。您只能将模板参数传递给模板函数或模板对象。

a.test<1>(); 和 a.operator()<1>(); 工作，因为它们充当模板功能。

使用 boost::bind （查看 boost 库）来修复它。

```
struct A {
    void operator()(int n) {
        std::cout << n << std::endl;
    }
};

int main(int argc, char* argv[]) {
    A a;
    boost::function<void()> f = boost::bind<void>(a, 1);
    f(); // prints 1

    return 0;
} 
```

而且您甚至不必弄乱模板！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T22:26:58.023

你被困住了。你有没有考虑过类似的东西

```
struct A {
    template<int N>
    struct B
    {
        void operator()()
        { std::cout << N << std::endl; }
    };

    template<int N>
    B<N> functor() {return B<N>();}
};

int main()
{
    A a;
    a.functor<1>()();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:24:06.003

不，没有办法解决它。就像您说的那样，您必须显式调用运算符（这违背了目的），或者模板参数必须能够由编译器推导出来。

# java - Java 反射：类数组与参数类型数组

> ID：942174
> 
> 赞同：1
> 
> 时间：2009-06-02T22:15:45.443
> 
> 标签：java, reflection

我有一个类 Method 的对象 m。我调用`m.getParameterTypes()`以创建方法参数的数组参数。

我还有一个对象数组 arr。我想检查 arr 中的对象是否与 params 中的类型相同（并且顺序相同）。

我所做的是创建一个数组类，其中包含 arr 中每个对象的类。然后我尝试将类与参数进行比较。事实证明它们永远不可能相等，因为 classes 数组中的类的格式为`java.lang.String`，而 param 数组中的参数的格式为`String`。如何比较数组？如何更改其中之一的格式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T22:21:44.290

`getParameterTypes()`返回 a`Class<?>[]`而实际参数本身将是对象（因此您将拥有一个`Object[]`）。要检查参数是否有效，您可以使用：

```
if (parameterTypes.length != arr.length) {
  // Invalid: wrong number of arguments
}

for (int i=0; i < parameterTypes.length; i++) {
  if (arr[i] == null && parameterTypes[i].isPrimitive()) {
    // Invalid: can't pass null for a primitive parameter
  } else if (arr[i] != null && !parameterTypes[i].isInstance(arr[i])) {
     // Invalid: invalid argument type
  } else {
     // Valid
  }
} 
```

（当然，为有效/无效案例做任何你需要做的事情。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-05T09:26:19.143

与其检查方法的参数是否与您的 Object 数组兼容，不如让`Class.getMethod()`我们为您做这件事？我的意思是，为什么不这样做：

```
Class[] classes = new Class[myArr.length];
for (int i=0; i<myArr.length; i++) {
    classes[i] = myArr[i].getClass();
}

Method m = YouMethodsClass.class.getMethod("methodName", classes); 
```

那不适合你吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:20:18.617

如果您正在做这种比较，您应该使用完全限定名称（'java.lang.String' 类型）以确保匹配确实正确（因为两个类可以具有相同的“简单”名称并且来自不同的包） .

您能否提供您使用的代码，以便我们指导您需要更改哪些内容才能获得完全限定的名称？

方法 getParameterTypes() 返回一个 Class[]，因此每个元素都是一个 Class。您可以调用 getCanonicalName()（或在某些情况下 getName()，请参阅 javadoc for Class）来获取完全限定名称。

对于对象数组，您可以调用 object.getClass().getCanonicalName() 来获取等价物。

**编辑：** Jon Skeet 的回复是一种更好的方法，您根本不比较名称，而是使用 Class isInstance() 方法来检查 Class 是否兼容。

# session - 我可以从 NUnit 测试中访问 SessionState 吗？

> ID：942178
> 
> 赞同：2
> 
> 时间：2009-06-02T22:16:23.133
> 
> 标签：session, nunit, session-state

我在 NUnit 测试中的一种方法检查 Session-State 变量：

如果（会话[变量名称] == null）...

并且 NUnit 测试因错误而失败：

> System.Web.HttpException：会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \\ 部分中。

我尝试将测试方法从类库中取出，并将其放入在 aspx 页面指令中设置 EnableSessionState="True" 的 aspx 页面的代码隐藏 cs 中。在 web 配置中添加了一个带有 sessionState mode = "InProc" 的 web 配置，然后在 web.config 中尝试了 < pages enableSessionState ="true"/>。

Nunit 测试在会话状态操作上仍然失败。

我必须嘲笑这些吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T22:26:37.247

我不相信您可以在不模拟的情况下从单元测试中访问 Session 。

看看 Phil Haack 的 HttpSimulator [http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx](http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx)

# iphone - iphone NSdate的sqlite datetime数据类型？

> ID：942188
> 
> 赞同：4
> 
> 时间：2009-06-02T22:18:16.297
> 
> 标签：iphone, database-design, sqlite

有没有一种方法可以在创建记录时自动在表中保存时间戳，然后我可以在我的应用程序中抓取并保存为 NSDate？

或者我应该在我的 iphone 应用程序中创建具有当前时间的 NSdate 对象，然后将其插入数据库。如果是这样？数据类型应该是哪一列？日期时间？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-16T11:41:55.903

我所做的是使用 sqlite 的 current_timestamp（看起来像这样：2009-06-16 12:11:24）。为此，只需将 qslite 表的行类型设置为

```
Data type: "DATETIME"
Allow null: NO
Default value: CURRENT_TIMESTAMP 
```

然后使用这样的 SQL 查询：

```
@"INSERT INTO 'scores' ('one', 'two', 'three') VALUES ('%d', '%d', '%d')" 
```

忽略日期，使其自动获取当前时间值。

然后要将其转换为 NSDate，您可以像这样使用 NSDateFormatter：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"]; //this is the sqlite's format
NSDate *date = [formatter dateFromString:score.datetime]; 
```

现在您将该日期作为 NSDate 对象。只是不要忘记释放我们分配的 NSDateFormatter :)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T00:26:12.090

SQLite中没有`TIMESTAMP`可使用的数据类型，因此您必须在执行`INSERT`. 我使用`INTEGER`数据库中的数据类型，并将我的转换`NSDate`为：

```
sqlite3_bind_double(insert_statement, 1, [myDate timeIntervalSince1970]); 
```

并将其从数据库中取回：

```
myDate = [NSDate dateWithTimeIntervalSince1970:sqlite3_column_double(select_statement, 1)]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-16T07:59:04.973

我喜欢使用 sqlite julianday() 函数，例如：

```
insert into foo(currentDate) values (julianday('now')); 
```

这将在 foo.currentDate 中插入一个浮点值。

您可能还会发现此问题/答案的一些详细信息很有用。

[如何使用 Objective C 在 SQLite 中获取日期时间列](https://stackoverflow.com/questions/1711504/how-get-datetime-column-in-sqlite-objecite-c/1711591#1711591)

# regex - 如何在unix日志文件输出中拆分行

> ID：942189
> 
> 赞同：0
> 
> 时间：2009-06-02T22:18:49.117
> 
> 标签：regex, unix, sed, awk

我希望能够从日志文件中解析日期和时间。目前它们采用以下格式：

“02/Jun/2009:14:38:50”但我想使用 linux 命令行中可用的东西将它们分隔在不同的列中，以便生成的输出如下所示：

“2009 年 6 月 2 日” “14:38:50”

有人可以说明如何做到这一点吗？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T22:26:40.303

如果没有其他格式的行，克里斯的答案是最好的。如果您只需要影响具有该特定格式的行，请执行以下操作：

```
cat log | sed -e 's/"\([^:]*\):\([^"]*\)"/"\1" "\2"/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:24:48.013

如果这就是每一行的全部内容，也许：

```
cat file.txt | sed -e 's/:/" "/' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T14:52:05.990

纯重击：

```
while read line ; do echo ${line/:/\" \"}; done < logfile 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T14:29:19.453

awk 的 sub() 函数返回 1，如果替换成功，则：

```
cat file.txt | awk 'sub(/:/,"\" \"")' 
```

GNU awk 可以使用 gensub() 函数，所以这是下面的反向引用示例。

```
cat file.txt | gawk '$0=gensub(/("[^:]*):([^"]*")/,"\\1\" \"\\2",1)' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T17:10:41.333

用于查找正则表达式“&:&:&:&”并在第一个冒号之前和之后分隔的比特脚本。（& 表示任意数量的任意字符）。

```
var str log
cat "logfile" > $log
while ( { sen -r "^&:&:&:&^" $log } > 0 )
do
    var str datetime, date, time
    stex -r "^&:&:&:&^" $log > $datetime
    stex -p "]^:^" $datetime > $date    # String before the first : is date.
    stex -p "^:^[" $datetime > $time    # String after the first : is time.
    echo $date "\t" $time
done 
```

要尝试，您可以下载 biterscripting。谷歌一下，或者安装说明在[http://www.biterscripting.com](http://www.biterscripting.com)。

# javascript - 简单的正则表达式问题：用 '?'s 替换单词

> ID：942192
> 
> 赞同：0
> 
> 时间：2009-06-02T22:19:12.127
> 
> 标签：javascript, regex, replace

好的，这是我当前的测试功能：

```
function make_void( str )
{
    var str_arr = str.split( /[\W]+/ );
    var voidstr;
    var newstr = "";

    for ( var i = 0; i < str_arr.length; i++ )
    {
        voidstr = str_arr[i];
        // if ( Math.random() <= 0.9 )
        // {
            voidstr = voidstr.replace( /\w/gi, "?" );
        // }

        newstr += voidstr + " ";
    }

    document.writeln( newstr );
} 
```

问题？标点符号丢失。

有什么好方法可以修改它们而不是？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T22:41:41.443

在空格 ( `\s`) 上而不是在非单词 ( `\W`) 上拆分，您将保留标点符号。

```
function make_void( str )
{
        var str_arr = str.split( /\s+/ ); //  !!!THIS LINE CHANGED!!!
        var voidstr;
        var newstr = "";

        for ( var i = 0; i < str_arr.length; i++ )
        {
                voidstr = str_arr[i];
                // if ( Math.random() <= 0.9 )
                // {
                        voidstr = voidstr.replace( /\w/gi, "?" );
                // }

                newstr += voidstr + " ";
        }

        document.writeln( newstr );
} 
```

***更新：***使用 Array.join() 方法的示例片段：

```
for ( var i = 0; i < str_arr.length; i++ )
{
    // if ( Math.random() <= 0.9 )
    // {
        str_arr[i] = str_arr[i].replace( /\w/gi, "?" );
    // }
}

var newstr = str_arr.join(' '); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:24:50.540

您尝试匹配的一些示例文本可能会有所帮助。（你真正想*保留*什么？）

目前，以下正则表达式可能会有所帮助：

```
[\w\d,.?:;"'-()] 
```

这匹配单词、数字和一些标点符号（尽管绝不是全部）。

# python - 用于打印除数乘积的高效 python 代码

> ID：942198
> 
> 赞同：3
> 
> 时间：2009-06-02T22:20:03.560
> 
> 标签：python, math

我正在尝试解决一个涉及打印给定数字的所有除数的乘积的问题。测试用例的数量是一个数字 1 <= t <= 300000 ，数字本身的范围可以是 1 <= n <= 500000

我写了以下代码，但总是超过2秒的时间限制。有什么方法可以加快代码速度吗？

```
from math import sqrt

def divisorsProduct(n):
    ProductOfDivisors=1

    for i in range(2,int(round(sqrt(n)))+1):
        if n%i==0: 
            ProductOfDivisors*=i

            if n/i != i:
                ProductOfDivisors*=(n/i)    

    if ProductOfDivisors <= 9999:
        print ProductOfDivisors
    else:
        result = str(ProductOfDivisors)
        print result[len(result)-4:] 

T = int(raw_input())

for i in range(1,T+1):
    num = int(raw_input())
    divisorsProduct(num) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T02:19:42.517

您需要澄清“除数的​​乘积”是什么意思。问题中发布的代码尚不适用于任何定义。这听起来像是一个家庭作业问题。如果是这样，那么您的讲师可能希望您在代码之外思考以实现时间目标。

如果您的意思是唯一素数除数的乘积，例如，72 给出 2*3 = 6，那么有一个素数列表就是要走的路。只需遍历列表直到数字的平方根，将当前素数乘以结果。数量不多，因此您甚至可以将它们硬编码到您的程序中。

如果您的意思是所有除数的乘积，无论是否素数，那么考虑除数是什么是有帮助的。您可以通过其他答案和您的答案中建议的蛮力方法获得显着的速度提升。我怀疑这就是你的导师的意图。

如果除数在一个列表中排序，那么它们成对出现，乘以 n——1 和 n、2 和 n/2，等等——除了 n 是完美平方的情况，其中平方根是不与任何其他除数配对的除数。

所以结果将是除数一半的 n 次方（无论 n 是否为平方）。

要计算这一点，请使用您的素数列表找到素数分解。也就是说，求 2 的幂除以 n，然后是 3 的幂，等等。为此，取出所有的 2，然后是 3，以此类推。

您从中取出因子的数字会越来越小，因此您可以对较小的中间数字进行平方根检验，看看是否需要继续排列素数列表。为了获得一些速度，测试 p*p <= m，而不是 p <= sqrt(m)

一旦你有了素数分解，就很容易找到除数的数量。例如，假设分解为 2^i * 3^j * 7^k。那么，由于每个除数使用相同的素因数，并且指数小于或等于n中的指数，包括0的可能性，除数的数量为(i+1)(j+1)(k+1)。

例如，72 = 2^3 * 3^2，所以除数是 4*3 = 12，它们的乘积是 72^6 = 139,314,069,504。

通过使用数学，该算法可以变得比 O(n) 好得多。但是由于输入中 n 的大小相对较小，因此很难提前估计您的速度增益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T15:47:39.820

好的，我认为这接近于最佳算法。它为范围（500000）中的每个数字生成 product_of_divisors。

```
import math

def number_of_divisors(maxval=500001):
    """ Example: the number of divisors of 12 is 6:  1, 2, 3, 4, 6, 12.
        Given a prime factoring of n, the number of divisors of n is the
        product of each factor's multiplicity plus one (mpo in my variables).

        This function works like the Sieve of Eratosthenes, but marks each
        composite n with the multiplicity (plus one) of each prime factor. """
    numdivs = [1] * maxval   # multiplicative identity
    currmpo = [0] * maxval

    # standard logic for 2 < p < sqrt(maxval)
    for p in range(2, int(math.sqrt(maxval))):
        if numdivs[p] == 1:   # if p is prime
            for exp in range(2,50): # assume maxval < 2^50
                pexp = p ** exp
                if pexp > maxval:
                    break
                exppo = exp + 1
                for comp in range(pexp, maxval, pexp):
                    currmpo[comp] = exppo
            for comp in range(p, maxval, p):
                thismpo = currmpo[comp] or 2
                numdivs[comp] *= thismpo
                currmpo[comp] = 0  # reset currmpo array in place

    # abbreviated logic for p > sqrt(maxval)
    for p in range(int(math.sqrt(maxval)), maxval):
        if numdivs[p] == 1:   # if p is prime
            for comp in range(p, maxval, p):
                numdivs[comp] *= 2

    return numdivs

# this initialization times at 7s on my machine
NUMDIV = number_of_divisors()

def product_of_divisors(n):
    if NUMDIV[n] % 2 == 0:
        # each pair of divisors has product equal to n, for example
        # 1*12 * 2*6 * 3*4  =  12**3
        return n ** (NUMDIV[n] / 2)
    else:
        # perfect squares have their square root as an unmatched divisor
        return n ** (NUMDIV[n] / 2) * int(math.sqrt(n))

# this loop times at 13s on my machine
for n in range(500000):
    a = product_of_divisors(n) 
```

在我非常慢的机器上，计算每个数字的除数数量需要 7 秒，然后计算每个数字的除数乘积需要 13 秒。当然，它可以通过将其翻译成 C 来加速。（@someone with a fast machine: 你的机器需要多长时间？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T22:48:32.037

您可以通过仅循环到小于平方根来消除循环中的 if 语句，并在循环外检查平方根整数。

这是你提出的一个相当奇怪的问题。我很难想象它的用途，除了它可能是课程中的作业。我的第一个想法是预先计算一个素数列表并只对它们进行测试，但我假设你是在故意计算非素数？即，如果这个数字有因数 2 和 3，那么你也算 6。

如果您确实使用了预先计算的素数表，那么您随后还必须在结果中包含所有可能的素数组合，这会变得更加复杂。

对于这类事情，C 确实是一门很棒的语言，因为即使是次优的算法也运行得非常快。

# c# - 我认为 URL 类型不可用？

> ID：942203
> 
> 赞同：0
> 
> 时间：2009-06-02T22:20:53.140
> 
> 标签：c#, asp.net-mvc

为了动态生成 URL ，我看到了无数涉及“ **Url.Action ”的示例。**（请参见下面的示例代码。）

问题：我的视图中不存在类型/类“Url”！没有 IntelliSense，并且编译站点会导致“类型预期”异常。我怎么把它弄进去？

源代码片段（来自示例）：

```
<form id="register-form" action="<%= Url.Action(new(action="Register")) %>" method="post">
//inputs etc
</form> 
```

**我正在使用最新版本的 MVC。**

这是整个页面（通过“生成视图”生成）：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">Register</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

<h2>Register</h2>

<form id="register-form" action="<%= Url.Action(new(action="Register")) %>" method="post">
<fieldset>
    <label for="emailAddress"><%= Resources.Labels.EmailAddress %>: </label> <input id="emailAddress" type="text" />
    <label for="password"><%= Resources.Labels.Password %>: </label> <input id="password" type="password" />

    <input id="register-submit" value="<%= Resources.Labels.SubmitRegistration %>" type="submit" />
</fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:31:01.153

示例中的`Url`类实际上是[ViewPage](http://msdn.microsoft.com/en-us/library/system.web.mvc.viewpage_members.aspx)的[属性](http://msdn.microsoft.com/en-us/library/system.web.mvc.viewpage.url.aspx)，也是[ViewUserControl](http://msdn.microsoft.com/en-us/library/system.web.mvc.viewusercontrol.url.aspx)的[属性](http://msdn.microsoft.com/en-us/library/system.web.mvc.viewusercontrol_members.aspx)，因此如果您的应用程序构建并且您正确设置了继承，那么这应该是不可能的。

尝试重建您的解决方案几次，如果这没有帮助重新启动 Visual Studio。（我曾经在该`Html`物业上遇到过同样的问题，但我相信这是在其中一个预览版上，我可以通过升级到下一个预览版/测试版来解决它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:56:39.230

解决了。Url.Action( **new("Register"))** ) 是问题所在。Url.Action("Register") 有效。

不过感谢您的帮助。这很难解决，因为 VS 强调了错误的代码并给出了关于问题的混淆陈述。很高兴它解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:30:08.690

这可能是因为项目没有正确编译。尝试通过右键单击控制器方法生成视图页面，然后单击创建视图...并重新编译...

# c# - C# 简单倒计时 - 我做错了什么？

> ID：942207
> 
> 赞同：7
> 
> 时间：2009-06-02T22:21:29.737
> 
> 标签：c#, wpf, multithreading

我想用 C# 制作一个简单的 Countdown-Application 作为示例。

对于第一个基本版本，我使用 Label 显示当前剩余时间（以秒为单位），并使用 Button 开始倒计时。Button 的 Click-Event 实现如下：

```
private void ButtonStart_Click(object sender, RoutedEventArgs e)
    {
        _time = 60;
        while (_time > 0)
        {
            _time--;
            this.labelTime.Content = _time + "s";
            System.Threading.Thread.Sleep(1000);
        }
    } 
```

现在，当用户单击 Button 时，时间实际上会倒计时（因为应用程序冻结（由于 Sleep()））选择的时间量，但 Label 的上下文不会刷新。

我做错了什么（当涉及到线程时）还是只是 UI 的问题？

* * *

谢谢您的回答！我现在使用 System.Windows.Threading.DispatcherTimer 来做你告诉我的。一切正常，所以这个问题得到了正式的回答；）

对于那些感兴趣的人：这是我的代码（基本部分）

```
public partial class WindowCountdown : Window
{
    private int _time;
    private DispatcherTimer _countdownTimer;

    public WindowCountdown()
    {
        InitializeComponent();
        _countdownTimer = new DispatcherTimer();
        _countdownTimer.Interval = new TimeSpan(0,0,1);
        _countdownTimer.Tick += new EventHandler(CountdownTimerStep);

    }

    private void ButtonStart_Click(object sender, RoutedEventArgs e)
    {
        _time = 10;
        _countdownTimer.Start();

    }

    private void CountdownTimerStep(object sender, EventArgs e)
    {
        if (_time > 0)
        {
            _time--;
            this.labelTime.Content = _time + "s";
        }
        else
            _countdownTimer.Stop();
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T22:24:10.777

是的，事件处理程序不应该阻塞——它们应该立即返回。您应该通过 Timer、BackgroundWorker 或 Thread（按此优先顺序）来实现它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T22:32:11.977

您所看到的是长时间运行的消息阻塞 Windows 消息队列/泵的效果 - 您通常将其与白色应用程序屏幕相关联并且“无响应”。基本上，如果您的线程处于休眠状态，它不会响应“画自己”之类的消息。您需要对泵进行更改和**产量控制。**

有多种方法可以做到这一点（ripper234 很好地列出了它们）。您经常会看到的**坏方法是：**

```
{ // your count/sleep loop

    // bad code - don't do this:
    Application.DoEvents();
    System.Threading.Thread.Sleep(1000);
} 
```

我提到这一点**只是**为了强调**不**该做什么；这会导致“重入”和一般代码管理出现很多问题。更好的方法是简单地使用 a `Timer`，或者对于更复杂的代码，使用 a `BackgroundWorker`。就像是：

```
using System;
using System.Windows.Forms;
class MyForm : Form {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.Run(new MyForm());
    }

    Timer timer;
    MyForm() {
        timer = new Timer();
        count = 10;
        timer.Interval = 1000;
        timer.Tick += timer_Tick;
        timer.Start();
    }
    protected override void Dispose(bool disposing) {
        if (disposing) {
            timer.Dispose();
        }
        base.Dispose(disposing);
    }
    int count;
    void timer_Tick(object sender, EventArgs e) {
        Text = "Wait for " + count + " seconds...";
        count--;
        if (count == 0)
        {
            timer.Stop();
        }
    }
} 
```

# c# - 如何在不调整大小的情况下使控件居中？（.net Winforms）

> ID：942211
> 
> 赞同：4
> 
> 时间：2009-06-02T22:22:09.640
> 
> 标签：c#, .net, winforms, user-interface

我有一个相当简单的用户控件，它代表一个基本的登录控件。所以它有几个标签、文本框和一个按钮。我希望此用户控件填充其容器，因此我已将其停靠模式设置为填充。到目前为止很容易。

现在，我希望我的用户控件中的所有控件都基于我的用户控件在呈现时的大小而居中。我想不出一个可以解决问题的锚/码头组合。

用户控件有一个 ReSize 事件。所以我知道我可以在该事件期间根据我的用户控件的大小计算和移动控件。但我希望这个问题足够普遍，如果我愿意，可以通过设计师来处理。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-08T14:34:29.593

这实际上很简单。您只需关闭所有锚属性，并将停靠设置为无。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:26:18.337

查看 TableLayoutPanel 控件并将其与停靠和锚属性结合使用。您应该能够以这种方式相当精确地控制布局。

# linux - 通过 HTTP 运行更高权限命令的适当方法是什么

> ID：942224
> 
> 赞同：0
> 
> 时间：2009-06-02T22:25:25.203
> 
> 标签：linux, web-services, http, shell

我有一个 Web 项目，需要在请求特定 URL 时为其运行命令，但该命令需要 root 权限。

该项目使用 Python 进程 (Django)，当然不能以 root 权限运行它。

该命令的参数是硬编码的，因此无法注入任何内容，并且它是一个受权利保护的应用程序，因此我可以在安全性上稍微自由一些，因为有权访问它的用户将是值得信赖的（希望如此）。但理想情况下，我想安全地做到这一点。

.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:28:44.153

`sudo`使用该选项调用命令`NOPASSWD:`，这允许您进行细粒度的访问控制并免费在 syslog 中进行审计。避免使用 shell 并使用`exec`将参数直接作为数组的变体。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T22:28:37.583

使用 setuid：[http ://en.wikipedia.org/wiki/Setuid](http://en.wikipedia.org/wiki/Setuid)

“setuid 和 setgid（分别是执行时设置用户 ID 和执行时设置组 ID 的缩写）是 Unix 访问权限标志，允许用户以可执行文件的所有者或组的权限运行可执行文件。”

...并且要非常非常小心！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T04:35:13.327

一定要避免使用 setuid 和 setgid，您希望 HTTP 服务器的权限尽可能低。对于需要root权限的进程，使用http服务器创建一个全新的独立进程并调用sudo。但是，您不应在 sudoers 中包含 HTTP 服务器 uid 或 gid，而应包含其他一些用户，该用户是唯一可以访问该程序的用户，并且该程序是唯一可以以 root 身份运行的用户。然后 HTTP SERVER 启动一个新进程，它将 UID 更改为哑用户，然后以 sudo 作为 root 执行该进程。

# sharepoint - 使用具有特征的 XML 文件

> ID：942226
> 
> 赞同：1
> 
> 时间：2009-06-02T22:25:35.827
> 
> 标签：sharepoint

目前我有一个自定义 Web 部件，部署为功能，它访问 XML 文件，如下所示：

字符串 sUri = @"C:\inetpub\wwwroot\wss\VirtualDirectories\80" + @"\wpresources\links.xml";

ds = 新数据集（）；ds.ReadXml(sUri);

将 XML 文件作为 SharePoint 功能部署的一部分包含在内的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:57:48.010

将其加载到布局目录下的 12 hive 并通过链接到它

```
http://[currentsite]/[currentweb]/_layouts/links.xml 
```

. 或者添加一个子目录来将所有文件组合在一起。例如

```
http://[currentsite]/[currentweb]/[myFeature]/_layouts/links.xml 
```

> 我如何将它包含在功能项目中......？

我正在使用[STSDEV](http://codeplex.com/stsdev)，它会自动将一个条目放入 manifest.xml 下

```
<Templates> 
```

例如

```
<TemplateFile Location="LAYOUTS\[myFeature]\links.xml" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T10:07:13.007

在我看来，有几种正确的方法。但是，我不会选择您要部署 xml 文件的位置。

它必须是：

1.  使用解决方案文件直接部署在 12-hive 中（就像 Nat 建议的那样，我会使用[WSPBuilder](http://www.codeplex.com/wspbuilder)）
2.  使用功能部署到站点（请参阅：http: [//msdn.microsoft.com/en-us/library/ms441170.aspx](http://msdn.microsoft.com/en-us/library/ms441170.aspx)）这将使文件被推送到内容数据库中供您的代码读取。

据我所知，没有简单的方法可以将文件部署到您网站的 InetPub 文件夹。我曾经需要这个来部署一个 .browser 文件并最终创建了一个功能接收器，该接收器将文件从 12-hive 复制到 InetPub 文件夹中。

也许如果您解释 xml 文件的用途，答案可能会更好:)

# c# - #pragma 警告禁用代码列表及其含义

> ID：942238
> 
> 赞同：29
> 
> 时间：2009-06-02T22:28:13.047
> 
> 标签：c#, c-preprocessor, pragma

禁用警告的语法如下：

```
#pragma warning disable 414, 3021 
```

或者，更一般地表达：

```
#pragma warning disable [CSV list of numeric codes] 
```

是否有这些数字代码的列表以及它们正在抑制的警告的描述？令我懊恼的是，我似乎无法通过谷歌找到它。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-02T22:31:39.217

[MSDN 有一个](http://msdn.microsoft.com/en-us/library/ms228296.aspx)警告代码列表。不幸的是，您必须单击每个链接才能查看代码的实际含义。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-02T22:31:28.530

你不应该需要一份清单。编译器会告诉你。如果您收到显示“警告 CS0168”的编译器错误，则将 168 添加到列表中（或者，更好的是，修复代码）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-02T22:30:30.093

查看[C# 编译器错误和警告列表](http://msdn.microsoft.com/en-us/library/ms228296.aspx)以查找各个警告编号。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-30T17:59:40.640

供参考 -

如果您使用的是 Visual Studio 2008，则可以通过右键单击错误并从上下文菜单中选择**“显示错误帮助”来****直接从错误列表中获取代码。**应该会弹出帮助窗口，并显示您想知道的有关 MSDN 网站错误的所有信息。

 **可以为您节省一点时间。

# c# - 使用来自维基新闻的数据

> ID：942239
> 
> 赞同：1
> 
> 时间：2009-06-02T22:28:15.980
> 
> 标签：c#

我一直在网上搜索，但似乎找不到任何使用[WikiNews](http://en.wikinews.org/wiki/Main_Page)数据的示例。他们有一个 RSS 提要，其中包含指向单个故事的 HTML 链接，但我想以结构化格式（如 XML 等）获取数据。

我所说的结构化格式是指每个故事的 XML 文件，它具有定义的 XML 模式 (XSD) 文件。见：[ [http://www.w3schools.com/schema/schema_intro.asp][2]](http://www.w3schools.com/schema/schema_intro.asp][2])

有没有人写过一个程序来使用维基新闻的故事？他们有文档化的 API 吗？

我想使用 C# 收集选定的故事并将它们存储在 SQL Server 2008 中。

[2]：“结构化格式”是指类似于 XML 模式 (XSD) 文件的东西。见：[http ://www.w3schools.com/schema/schema_intro.asp](http://www.w3schools.com/schema/schema_intro.asp)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T22:30:13.010

他们使用的软件[有一个 API](http://www.mediawiki.org/wiki/API)，但我不确定 WikiNews 是否支持它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-22T04:10:46.090

他们的提要： http: [//feeds.feedburner.com/WikinewsLatestNews](http://feeds.feedburner.com/WikinewsLatestNews)

如果将它放在浏览器中并阅读源代码，您会发现它是 XML。XML 包含标题、描述、链接等。只有描述是 HTML。

这是响应的开头：

```
<rss xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule" xmlns:feedburner="http://rssnamespace.org/feedburner/ext/1.0" version="2.0"> 
         <channel> 
             <title>Wikinews</title> 
             <description>Wikinews RSS feed</description> 
             <language>en</language> 
             <link>http://en.wikinews.org</link> 
             <copyright>Creative Commons Attribution 2.5 (unless otherwise noted)</copyright> 
             <generator>Wikinews Fetch</generator> 
             <ttl>180</ttl> 
             <docs>http://none</docs> 
                 <atom10:link xmlns:atom10="http://www.w3.org/2005/Atom" rel="self" type="application/rss+xml" href="http://feeds.feedburner.com/WikinewsLatestNews" /><feedburner:info uri="wikinewslatestnews" /><atom10:link xmlns:atom10="http://www.w3.org/2005/Atom" rel="hub" href="http://pubsubhubbub.appspot.com/" /><creativeCommons:license>http://creativecommons.org/licenses/by/2.5/</creativeCommons:license><feedburner:browserFriendly>This is an XML content feed. It is intended to be viewed in a newsreader or syndicated to another site.</feedburner:browserFriendly><item> 
                     <title>Lufthansa pilots begin strike</title> 
                     <link>http://feedproxy.google.com/~r/WikinewsLatestNews/~3/1K2xloPGlmI/Lufthansa_pilots_begin_strike</link> 
                     <description>&lt;p&gt;&lt;a href="http://en.wikinews.org/w/index.php?title=File:LocationGermany.png&amp;filetimestamp=20060604120306" class="image" title="A map showing the location of Germany"&gt;&lt;img alt="A map showing the location of Germany" src="http://upload.wikimedia.org/wikipedia/commons/thumb/d/de/LocationGermany.png/196px-LocationGermany.png" width="196" height="90" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;b class="published"&gt;&lt;span id="publishDate" class="value-title" title="2010-02-22"&gt;&lt;/span&gt;Monday, February 22, 2010&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;The pilot's union of &lt;a href="http://en.wikinews.org/wiki/Germany" title="Germany" class="mw-redirect"&gt;German&lt;/a&gt; airline &lt;a href="http://en.wikipedia.org/wiki/Lufthansa" class="extiw" title="w:Lufthansa"&gt;Lufthansa&lt;/a&gt; have begun a four-day strike over pay and job security. Operations at subsidiary airlines &lt;a href="http://en.wikipedia.org/wiki/Lufthansa_Cargo" class="extiw" title="w:Lufthansa Cargo"&gt;Lufthansa Cargo&lt;/a&gt; and &lt;a href="http://en.wikipedia.org/wiki/Germanwings" class="extiw" title="w:Germanwings"&gt;Germanwings&lt;/a&gt; are also affected by the strike.&lt;/p&gt;
&lt;em&gt;&lt;a href='http://en.wikinews.org/wiki/Lufthansa_pilots_begin_strike'&gt;More...&lt;/a&gt;&lt;/em&gt;&lt;div class="feedflare"&gt;
&lt;a href="http://feeds.feedburner.com/~ff/WikinewsLatestNews?a=1K2xloPGlmI:9SJI0YV04-M:yIl2AUoC8zA"&gt;&lt;img src="http://feeds.feedburner.com/~ff/WikinewsLatestNews?d=yIl2AUoC8zA" border="0"&gt;&lt;/img&gt;&lt;/a&gt; &lt;a href="http://feeds.feedburner.com/~ff/WikinewsLatestNews?a=1K2xloPGlmI:9SJI0YV04-M:7Q72WNTAKBA"&gt;&lt;img src="http://feeds.feedburner.com/~ff/WikinewsLatestNews?d=7Q72WNTAKBA" border="0"&gt;&lt;/img&gt;&lt;/a&gt; &lt;a href="http://feeds.feedburner.com/~ff/WikinewsLatestNews?a=1K2xloPGlmI:9SJI0YV04-M:YwkR-u9nhCs"&gt;&lt;img src="http://feeds.feedburner.com/~ff/WikinewsLatestNews?d=YwkR-u9nhCs" border="0"&gt;&lt;/img&gt;&lt;/a&gt;
&lt;/div&gt;</description> 
<guid isPermaLink="false">http://en.wikinews.org/wiki/Lufthansa_pilots_begin_strike</guid> 

<feedburner:origLink>http://en.wikinews.org/wiki/Lufthansa_pilots_begin_strike</feedburner:origLink></item> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-25T23:09:33.827

你的问题真的不清楚！但我猜你想**格式化**WikiNews 的提要，以便以更友好的方式阅读（就像你在 WikiNews 本身中阅读它一样），我说的对吗？

如果是这样，那么您必须知道[RSS](http://en.wikipedia.org/wiki/Rss)是具有标准格式的 XML，并且与 WikiNews 无关，并且您可以使用[XSLT将](http://www.w3schools.com/xsl/default.asp)**任何**RSS 提要转换为以 HTML 格式显示。

如果您需要获取故事本身，您可以使用提要中的给定链接，并将其显示在网络浏览器控件中（如果您正在开发 Windows 应用程序）。

除了我说的，你还需要别的吗？

# asp.net - ASP.NET 缓存 - Remove("key") 不起作用的情况？

> ID：942243
> 
> 赞同：0
> 
> 时间：2009-06-02T22:29:34.977
> 
> 标签：asp.net, caching

我有一个缓存一些业务对象的 ASP.NET 应用程序。保存新对象时，我在键上调用 remove 以清除对象。下次用户请求数据时，应该延迟加载新列表。

除了不同客户端中缓存的不同视图存在问题。

*   两个用户正在浏览该站点
*   用户 1 保存了一个新对象并删除了缓存
*   用户 1 看到数据的最新视图
*   用户 2 也在使用该站点，但由于某种原因在用户 1 保存新对象后看不到新的缓存数据 - 他们继续看到旧列表

这是代码的缩短版本：

```
public static JobCollection JobList
{
    get
    {
        if (HttpRuntime.Cache["JobList"] == null)
        {
                GetAndCacheJobList();
        }
        return (JobCollection)HttpRuntime.Cache["JobList"];
    }
}

private static void GetAndCacheJobList()
    {
        using (DataContext context = new DataContext(ConnectionUtil.ConnectionString))
        {
            var query = from j in context.JobEntities
                        select j;
            JobCollection c = new JobCollection();
            foreach (JobEntity i in query)
            {
                Job newJob = new Job();
                ....
                c.Add(newJob);
            }
            HttpRuntime.Cache.Insert("JobList", c, null, Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration, CacheItemPriority.Default, null);
        }
    }

public static void SaveJob(Job job, IDbConnection connection)
    {
        using (DataContext context = new DataContext(connection))
        {

               JobEntity ent = new JobEntity();
               ...
               context.JobEntities.InsertOnSubmit(ent);                
               context.SubmitChanges();
               HttpRuntime.Cache.Remove("JobList");                                     

        }
    } 
```

有谁知道为什么会发生这种情况？

编辑：我正在使用 Linq2SQL 来检索对象，尽管我正在处理上下文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-08T20:24:59.437

我会要求您确保您没有多个生产服务器来实现负载平衡。在这种情况下，您将不得不使用一些外部依赖体系结构来使缓存项无效/删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T16:41:22.200

那是因为您不同步缓存操作。您应该锁定将您的列表写入缓存（甚至可能将列表放入锁中）并同时将其从缓存中删除。否则，即使读取和写入是同步的，也没有什么可以阻止在调用 Remove 之后立即存储旧 List。如果您需要一些代码示例，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T16:45:24.080

如果您还没有，我还会检查他们看到的旧数据是否没有以某种方式缓存在 ViewState 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-08T20:46:40.440

您必须确保用户 2 发送了新请求。也许它看到的内容来自浏览器的缓存，而不是来自服务器的缓存

# c++ - 在 C/C++ 中为什么 do while(expression); 需要半冒号吗？

> ID：942251
> 
> 赞同：35
> 
> 时间：2009-06-02T22:31:17.470
> 
> 标签：c++, c, language-design

我的猜测是它只是让解析更容易，但我不明白为什么。

那么这有什么...

```
do
{
  some stuff
}
while(test);

more stuff 
```

这比……好

```
do
{
  some stuff
}
while(test)

more stuff 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-06-02T22:33:46.497

因为你要结束陈述。语句以块（由花括号分隔）或分号结束。“do this while this”是一条语句，不能以块结尾（因为它以“while”结尾），所以它需要一个分号，就像任何其他语句一样。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-10-25T20:38:39.757

如果你看一下 C++ 语法，你会看到迭代语句被定义为

> **while (** *条件* **)** *语句*
> 
> **for (** *for-init-statement 条件*-opt **;** *表达式*-opt **)** *语句*
> 
> **do** *语句* **while (** *表达式* **) ;**

请注意，只有`do-while`语句`;`末尾有一个。所以，问题是为什么 与`do-while`其他的如此不同以至于它需要额外的`;`。

让我们仔细看看：两者都*以*`for`statement`while`结尾。但以包含在 中的控制*表达式*结束。该封闭的存在已经允许编译器明确地找到控制表达式的结尾：外部封闭指定表达式结束的位置，因此，整个语句结束的位置。换句话说，终止确实是多余的。*`do-while`*`()``()``)``do-while``;`**

 **但是，在实践中，这意味着，例如，以下代码

```
do
{
  /* whatever */
} while (i + 2) * j > 0; 
```

虽然从语法的角度来看是*有效的，但实际上会被解析为*

```
do
{
  /* whatever */
} while (i + 2)

*j > 0; 
```

这在形式上是合理的，但并不是很直观。我猜出于这样的原因，决定在`do-while`语句中添加一个更明确的终止符 - 一个分号。当然，根据@Joe White 的回答，还需要考虑简单明了的一致性：C 中的所有普通（非复合）语句都以 a 结尾`;`。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-06-02T22:46:05.320

这是因为 while 语句在 do-while 循环中是有效的。

如果不需要分号，请考虑不同的行为：

```
int x = 10;
int y = 10;

do 
  while(x > 0)
    x--;
while(x = y--); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-02T22:34:21.253

虽然我不知道答案，但一致性似乎是最好的论据。C/C++ 中的每个语句组都以

1.  一个分号
2.  一个大括号

为什么要创建一个两者都不做的构造？

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-04-13T03:16:23.160

## 流控语句一致性

考虑到一致性...

```
if (expr) statement;
do statement; while (expr);
for (expr; expr; expr) statement;
while (expr) statement; 
```

...所有这些流量控制结构都以分号结尾。

但是，反驳我们可以注意到块语句形式，只有`do while`分号分隔：

```
if (expr) { ... }
do { ... } while (expr);
for (expr; expr; expr) { }
while (expr) { } 
```

所以，我们有';' 或'}'，但绝不是“裸”的')'。

## 语句分隔符的一致性

我们至少可以说每个语句必须由`;`or分隔`}`，并且在视觉上有助于我们区分语句。

如果不需要分号，请考虑：

```
do statement1; while (expr1) statement2; do ; while (expr2) statement3; while (expr3) statement4; 
```

很难从视觉上将其解决为不同的语句：

```
do statement1; while (expr1)
statement2;
do ; while (expr2)
statement3;
while (expr3) statement4; 
```

相比之下，在条件告诉您向后寻找，并且下一条语句与该 无关`;`之后，以下情况更容易解决：`while``do``while`

```
do statement1; while (expr1); statement2; do ; while (expr2); statement3; while (expr3) statement4; 
```

考虑到人们缩进他们的代码以使流程易于理解，这有关系吗？是的，因为：

*   人们有时会犯错误（或者在修改代码时暂时出错），如果它在视觉上很突出，这意味着它会更容易修复，并且
*   宏替换可以将许多语句放在一行中，我们有时需要在排除故障或进行 QA 时直观地验证预处理器的输出。

## 对预处理器使用的影响

同样值得注意的是著名的预处理器 do-while 习语：

```
#define F(X) do { fn(X); } while (false) 
```

这可以替换如下：

```
if (expr)
    F(x);
else
    x = 10; 
```

...产量...

```
if (expr)
    do ( fn(x); } while (false);
else
    x = 10; 
```

如果分号*不是*语句的一部分`do while`，那么`if`语句将被解释为：

```
if (expr)
    do-while-statement
; // empty statement
else
    x = 10; 
```

...并且，因为在 之后有两个语句`if`，所以它被认为是完整的，这使得`else`语句不匹配。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-02T22:35:00.443

C 以分号结尾（而 Pascal 以分号分隔）。将分号放在那里是不一致的。

坦率地说，我讨厌在 do 循环中重用 while。我认为重复直到会不那么令人困惑。但是它就是这样啊。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T22:34:29.460

在 C/C++ 中，空格对结构没有贡献（例如在 python 中）。在 C/C++ 中，语句**必须**以分号结束。这是允许的：

```
do
{
  some stuff; more stuff; even more stuff;
}
while(test); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-24T15:19:35.400

我的回答是，当我们没有在`do.....while();`循环终止时包含分号时，编译器可能会感到困惑。没有这个就不清楚了：

1.  什么时候结束？
2.  如果while 可以在do 循环之后立即执行一个单独的循环。

这就是为什么我们在循环末尾包含分号`do......while`，以指示如果条件为假，循环将在此处终止。

# html - 使用内联框架引起的并发症

> ID：942256
> 
> 赞同：0
> 
> 时间：2009-06-02T22:31:44.990
> 
> 标签：html, inline, frames, iframe

构建网站可能会导致哪些并发症？

我希望构建一个基于 jspx 的相对复杂的网站。

到目前为止，我发现 Ajax 函数不起作用，我听说这是因为安全问题。

在构建网站时，这种性质的其他哪些事情可能会出错？

非常感谢您的帮助。

最好的，彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T22:55:48.577

我最近发生了一件相当烦人的事情，我的一个网站被陷害（不是我的决定），其中 IE 没有让人们登录。它只针对某些用户，所以我最好的猜测是，由于“安全设置”，IE 正在做一些奇怪的事情，并且（可能）对会话 cookie 有错误。不用说，我刚刚实施了一个破帧器来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:16:49.073

*   书签无法正常工作
*   将 URL 复制并粘贴到电子邮件/即时消息/任何给朋友的内容会将用户发送到不同的视图
*   搜索引擎将用户发送到孤立页面

# asp.net-mvc - 在 ASP.net MVC 中向 DropDownList 添加空值

> ID：942262
> 
> 赞同：49
> 
> 时间：2009-06-02T22:33:53.800
> 
> 标签：asp.net-mvc, vb.net, drop-down-menu

我正在构建一个数据输入界面，并已使用 DropDownList 成功绑定了具有数据引用表的列，以便用户从预配置的值中进行选择。

我现在的问题是我不希望默认选择第一个值，我需要强制用户从列表中选择一个值以避免他们没有选择该字段并且默认分配一个值的错误.

有没有比在我从数据库中获取它并在我将它传递给我的控制器类中的 SelectList 构造函数之前添加代码以在列表顶部包含一个空值更优雅的方法？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-06-02T22:45:19.237

Html 辅助函数将“第一个空值”参数作为第三个参数。

```
<%=Html.DropDownList("name",dataSource,"-please select item-")%> 
```

* * *

## 回答 #2

> 赞同：-9
> 
> 时间：2009-08-02T20:04:20.260

你也可以这样使用：

```
dropdownlist.DataTextField = ds.Tables[0].Columns[0].Caption;
dropdownlist.DataValueField = ds.Tables[0].Columns[1].Caption;
dropdownlist.DataSource = ds;
dropdownlist.DataBind();

dropdownlist.Items.Insert(0, new ListItem("Select ...", string.Empty)); 
```

# continuous-integration - TeamCity 在构建时删除文件

> ID：942267
> 
> 赞同：4
> 
> 时间：2009-06-02T22:34:44.157
> 
> 标签：continuous-integration, teamcity

我是 TeamCity 和持续集成的新手。我已经按照[这个](http://elegantcode.com/2009/05/04/implementing-teamcity-for-net-projects-part-1-just-build-it-a-simple-build-configuration/)非常好的指南进行了设置，一开始似乎一切正常。

TC 可以检查来自 SVN 的文件，并且可以毫无问题地构建它们。但是我发现“结帐目录”设置是错误的，它指向了一个文件夹上方应该在的位置，因此将所有来自 SVN 的新文件添加到错误的位置，但仍然建立在旧文件的基础上。纠正此问题后，问题开始了。

现在，每次 TC 进行构建时，它都会清除“签出目录”中的所有文件，问题在于并非所有需要的文件都由 SVN 管理，并且它们会被永久删除。由于并非所有必要的文件都在那里，因此构建失败。

我应该怎么做才能让 TC 保留我的文件？

来自 TC 的设置是否有帮助：

> 常规设置编辑 »
> 
> 名称： Mavia Build
> 
> 说明：无
> 
> 内部版本号格式：{0}，下一个内部版本号：#8
> 
> 工件路径：未指定
> 
> 如果出现以下情况，则构建失败：
> 
> 进程退出代码不为零：ON
> 
> 至少一项测试失败：开
> 
> 构建运行器记录了一条错误消息：OFF
> 
> 它的运行时间超过：没有限制
> 
> 检测到内存不足或崩溃：ON
> 
> 构建选项：
> 
> 悬挂构建检测：ON
> 
> 状态小部件：关闭
> 
> 同时运行构建的最大数量：无限制
> 
> 版本控制设置编辑 »
> 
> VCS 结帐模式：在服务器上自动
> 
> 结帐目录：C:\Inetpub\wwwroot\mavia_sip
> 
> 在构建之前清理所有文件：OFF
> 
> VCS 标签：禁用
> 
> 附加的 VCS 根：
> 
> 名称 结帐规则 设置标签
> 
> mavia_sip svn 未指定 NO
> 
> 亚军：sln2008 编辑 »
> 
> 运行器类型：sln2008（Microsoft Visual Studio 2008 解决方案文件的运行器）
> 
> 解决方案文件路径：mavia_sip\WebSite\mavia_sip.sln
> 
> 工作目录：与结帐目录相同
> 
> 目标：重建
> 
> 配置：调试
> 
> 解决方案平台：默认
> 
> NUnit 运行平台：auto(MSIL)
> 
> NUnit 跑步者：NUnit 2.2.10
> 
> 从以下位置运行测试：未指定
> 
> 不要从以下位置运行测试：未指定
> 
> NUnit 类别包括：未指定
> 
> NUnit 类别排除：未指定
> 
> 减少测试失败反馈时间：OFF
> 
> MSTest：禁用
> 
> XML 报告处理：禁用
> 
> 构建触发编辑 »
> 
> 构建配置已暂停（触发已禁用）。
> 
> 通过 vcs 签入触发构建：ON
> 
> 静默期：默认，60 秒
> 
> 如果上次构建失败，则开始新构建：关闭
> 
> 按时间触发：未配置
> 
> 此配置取决于：未配置
> 
> 依赖编辑 »
> 
> 快照依赖：
> 
> 没有快照依赖项。
> 
> 工件依赖项：
> 
> 没有工件依赖项。
> 
> 属性和环境变量编辑 »
> 
> 系统属性：未定义
> 
> 环境变量：未定义
> 
> 代理要求编辑 »
> 
> 系统属性要求：未定义
> 
> 环境变量要求：未定义

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-04T21:05:14.643

好的，这就是我的做法：

首先，我让 TC 检查并在站点上的单独文件夹中构建项目。所需的外部 dll 已从“bin”文件夹移动到单独的文件夹并添加到 subversion（也更新了 Visual Studio 中的引用）。

现在 TC 可以毫不费力地构建项目。

其次，我在 Visual Studio 中创建了一个 Post Build Script，如下所示：

```
xcopy "C:\TeamCityBuild\mavia_sip\WebSite\*" "C:\Inetpub\wwwroot\mavia_sip\WebSite\" /C /R /Y /E
if errorlevel 1 exit 0 
```

只有当有人在没有正确文件夹结构的环境中构建项目时，才需要进行错误处理以避免脚本错误。

到目前为止，一切都很好！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T22:42:49.367

结帐目录不应包含您关心的任何文件！

您绝对应该能够进行“干净构建”，并让 TeamCity 删除文件夹中的所有内容。

# visual-studio - 如何隐藏 Visual Studio 加载项禁用的命令

> ID：942268
> 
> 赞同：1
> 
> 时间：2009-06-02T22:34:57.837
> 
> 标签：visual-studio, add-in, visual-studio-addins

我创建了一个 Visual Studio 插件，它将附加命令（其中四个）添加到*代码窗口*上下文菜单的顶部。我正在使用永久 UI 方法。根据代码中的光标位置，只有一个命令是可见的，因此是可选择的。其他三个将被隐藏。

我在方法中设置了*支持*和*启用*状态，`QueryStatus`该方法可以为正确的命令提供技巧，而其他命令则*不受支持*和*不可见*。

**问题**
第一次安装插件一切正常。我只能在上下文菜单中看到一个命令**。**其余的总是隐藏的。
第二次加载 VS IDE 时，我检测到相同的命令和控件（所以我不会重新创建已经存在的东西），但现在所有命令（或更好的 `CommandBarControl/CommandBarButton`控件）都是可见的。而不是隐藏 3 只显示一个，我可以看到**所有四个**。正确的一个被启用，而包的其余部分被禁用/变灰。

**问题**
如何`CommandBarButton`在下一次加载 IDE 时隐藏现有命令（或控件）？我尝试将按钮的`Visible`属性设置为，`false`但即使正确的控件也没有显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T10:14:18.657

您是否尝试过使用单个命令并根据光标位置更改命令文本？我不确定这是否可能，只是一个建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T20:36:51.853

我最后使用的解决方案是：

1.  在 IDE 启动时删除控件（如果默认情况下在 IDE 启动时未启用，则在启动后删除插件）。删除命令也会删除任何控件
2.  重新创建命令和控件，它们的可见性将按预期工作。

# linux - 在内核和用户空间之间进行通信的理想和最快的方式是什么？

> ID：942273
> 
> 赞同：9
> 
> 时间：2009-06-02T22:36:05.073
> 
> 标签：linux, linux-kernel

我知道信息交换可以通过内核和用户空间程序之间的以下接口进行

*   系统调用

*   ioctl

*   /proc & /sys

*   网联

我想知道

*   如果我错过了任何其他界面？

*   其中哪一种是交换大量数据的最快方式？（如果有任何文件/邮件/解释支持我可以参考的这种主张）

*   哪一种是*推荐*的交流方式？（我认为它的网络链接，但仍然很想听听意见）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T07:43:26.200

交换大量数据的最快方法是内存映射。mmap 调用可以用于设备文件，然后相应的内核驱动程序可以决定将内核内存映射到用户地址空间。一个很好的例子是 Video For Linux 驱动程序，我想帧缓冲区驱动程序的工作方式相同。要很好地解释 V4L2 驱动程序的工作原理，您有：

*   [lwn.net 关于流式 I/O 的文章](http://lwn.net/Articles/240667/)
*   [V4L2 规范本身](http://v4l2spec.bytesex.org/spec/c5742.htm)

对于大量数据，您无法击败内存映射，因为不涉及类似 memcopy 的操作，物理底层内存在内核和用户空间之间有效共享。当然，就像在所有共享内存机制中一样，您必须提供一些同步，以便内核和用户空间不会认为它们同时拥有所有权。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T22:46:14.773

**内核和使用空间之间的共享内存**是可行的。

[http://kerneltrap.org/node/14326](http://kerneltrap.org/node/14326)

有关说明/示例。

您还可以使用非常快的**命名管道。**

**所有这一切实际上取决于**您共享的数据、是否同时访问以及数据的结构。对于简单的数据，调用可能就足够了。

[Linux 内核 /proc FIFO/管道](https://stackoverflow.com/questions/313342/linux-kernel-proc-fifo-pipe)

也可能有帮助

**祝你好运**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-07T05:49:10.713

您还可以考虑使用中继（以前称为 relayfs）：

“基本上，relayfs 只是一堆可以从内核代码有效写入的 per-cpu 内核缓冲区。这些缓冲区表示为可以在用户空间中映射并直接读取的文件。此设置的目的是提供最简单的机制，允许潜在的大量数据记录在内核中并“中继”到用户空间。”

[http://relayfs.sourceforge.net/](http://relayfs.sourceforge.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T04:29:07.133

您显然可以使用 copy_from_user 等进行共享内存，您可以轻松设置字符设备驱动程序，基本上您所要做的就是创建一个 file_operation 结构，但这不是最快的方法。我没有基准，但现代系统上的系统调用应该是最快的。我的理由是它是最优化的。过去从用户到内核必须创建一个中断，然后进入中断表（一个数组），然后找到中断句柄（0x80），然后进入内核模式。这真的很慢，然后是 .sysenter 指令，这基本上使这个过程非常快。不详述，.sysenter 立即从寄存器 CS:EIP 中读取，并且更改非常快。相反，共享内存需要写入和读取内存，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-22T01:45:09.750

这是所有可能接口的可能编译，尽管在某些方面它们相互重叠（例如，套接字和系统调用都有效地使用系统调用）：

```
Procfs
Sysfs
Configfs
Debugfs
Sysctl
devfs (eg, Character Devices) 
TCP/UDP Sockets
Netlink Sockets 
Ioctl
Kernel System Calls
Signals
Mmap 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-27T06:38:26.187

至于共享内存，我发现即使使用 NUMA，运行在两个不同内核上的两个线程通过共享内存进行通信仍然需要从 L3 缓存写入/读取，如果幸运的话（在一个套接字中）它比 syscall 慢大约 2 倍，如果（不是在一个套接字上），比系统调用慢 5X-UP，我认为系统调用的硬件机制有所帮助。

# c# - 覆盖 ASP.NET gridview 控件的标题输出

> ID：942275
> 
> 赞同：2
> 
> 时间：2009-06-02T22:36:12.873
> 
> 标签：c#, asp.net, gridview, header

是否有一种有效的方法来覆盖 ASP.NET`GridView`控件的页眉和页脚的 HTML 输出？

我想实现一种类似于`HeaderTemplate`ASP.NET 中标记的方法，`Repeater`或者不需要在后面的页面代码中动态构建 HTML 输出。如果这两种类型的选项可用于 ASP.NET`GridView`控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-15T15:44:16.750

在 Gridview 中，您可以使用 RowCreated 事件来完全“销毁”并重新创建页眉和/或页脚。在此活动期间，请查看：

```
if (e.Row.RowType = DataControlRowType.Header)
{
     // At this point you have access to e.Row.Cells
     // You can now empty the collection and recreate it.
     // If you create a singular cell in the collection
     // you can then make its ColumnSpan reach across
     // the length of the entire table. Then inside this 
     // cell you can add any set of controls you want.
     // I've used this method to combine column headers
     // and add specialty controls that simply wouldn't
     // working using the HeaderTemplate
} 
```

由于这是在 RowCreated 完成的，因此在 RowDataBound 期间，您可以访问这些控件，然后可以根据数据随意操作它们。这对于在页脚中进行复杂的计算、根据排序调整页眉中的图像等非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T01:20:51.777

您可能需要考虑使用[ASP.Net 控制适配器](http://weblogs.asp.net/scottgu/archive/2006/05/02/CSS-Control-Adapter-Toolkit-for-ASP.NET-2.0-.aspx)。我已经将它们用于非常基本的事情，但正如[Scott Guthrie](http://weblogs.asp.net/scottgu/default.aspx)所说：

> 控件适配器允许您插入任何 ASP.NET 服务器控件并覆盖、修改和/或调整该控件的呈现输出逻辑。

该[工具包](http://www.asp.net/cssadapters/Default.aspx)还包含几个“开箱即用”的适配器，您可以从中提取示例，包括 GridView。同样，我不是 100% 确定您将能够完全按照您的意愿行事，但值得一试。如果无非是把另一个 ASP.Net 技巧放在你的腰带之下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-15T15:58:12.693

更改 RowCreated 上的逐个单元格检查是一种方法，例如，如果您想向列添加下拉列表以允许过滤，您可以这样做。

```
if (e.Row.RowType = DataControlRowType.Header)
{
    e.Row.Cells[0].Controls.Clear();

    var ddlFilter = new DropDownList();
    //add options etc

    e.Row.Cells[0].Controls.Add(ddlFilter);
} 
```

如果您要转换为单个单元格并添加新控件，那么我只需设置`ShowHeader=false`并将我的标记/控件放在 gridview 上方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T17:18:45.587

您还可以继承控件并覆盖 Render 函数。我必须这样做来解决 ASP.NET 单选按钮的缺点。基本思想在这里，您可以根据需要对其进行修改：

[http://www.codeproject.com/KB/webforms/How_group_RButtons.aspx](http://www.codeproject.com/KB/webforms/How_group_RButtons.aspx)

# wpf - 布尔动画锁定属性

> ID：942276
> 
> 赞同：6
> 
> 时间：2009-06-02T22:37:06.240
> 
> 标签：wpf, silverlight, xaml

如果我有一个设置属性的 BooleanAnimation，则该属性将被锁定并且不能通过任何其他方式更改。

例子：

```
<EventTrigger
    SourceName="myButton"
    RoutedEvent="Button.Click">
    <EventTrigger.Actions>
        <BeginStoryboard>
            <Storyboard>
                <BooleanAnimationUsingKeyFrames
                    Storyboard.TargetName="myCheckBox"
                    Storyboard.TargetProperty="IsChecked"
                    FillBehavior="HoldEnd">
                    <DiscreteBooleanKeyFrame
                        KeyTime="00:00:00"
                        Value="False" />
                </BooleanAnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger.Actions>
</EventTrigger> 
```

在此示例中，如果单击按钮，则复选框设置为 false，但是，如果用户尝试再次选中复选框，则复选框无响应。IsChecked 属性也不能通过代码设置（在单击按钮后）。

我可以创建另一个动画来更新 CheckBox，但这不是我需要的行为。

我也尝试过 FillBehavior="Stop"，但这只会导致动画也不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T23:49:38.513

CheckBox 仍在设置中，但动画仍在运行，这就是它似乎取消选中它的原因。有几种方法可以解决此问题，以便动画不再控制复选框上的属性。[MSDN 动画](http://msdn.microsoft.com/en-us/library/ms752312.aspx)概述讨论了动画结束时会发生什么。以及[如何在使用 Storyboard 对其进行动画处理后设置属性](https://msdn.microsoft.com/en-us/library/aa970493(v=vs.100).aspx)会涉及其他一些选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-03T09:23:09.120

代替

> 填充行为 =“保持结束”

和

> 持续时间="00:00:01" FillBehavior="停止"

它会工作:-)

# c# - MySQL C# 文本编码问题

> ID：942277
> 
> 赞同：15
> 
> 时间：2009-06-02T22:37:29.003
> 
> 标签：c#, mysql, unicode, utf-8

我有一个编码设置为 UTF-8 的旧 MySQL 数据库。我正在使用 Ado.Net Entity 框架来连接它。

当预期 ë 类似字符时，我从中检索的字符串具有奇怪的字符。

例如：“ë”是“Ã«”。

我想我可以通过从 UTF8 转换为 UTF16 来解决这个问题。

```
 return Encoding.Unicode.GetString(                
            Encoding.Convert(
            Encoding.UTF8,
            Encoding.Unicode,
            Encoding.UTF8.GetBytes(utf8)));
    } 
```

然而，这并没有改变任何事情。

我怎样才能以正确的形式从这个数据库中获取数据？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-11-28T13:48:52.297

在 ADO.NET 实体框架中支持 UTF-8 需要做两件事（或者通常使用 MySQL .NET 连接器）：

1.  确保您的表数据库的排序规则是 UTF-8 排序规则（即`utf8_general_ci`或其关系之一）
2.  添加`Charset=utf8;`到您的连接字符串。

    ```
    "Server=localhost;Database=test;Uid=test;Pwd=test;Charset=utf8;" 
    ```

我不确定，但编码可能区分大小写；**我发现这`CharSet=UTF8;`对我不起作用。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T07:57:29.197

即使数据库设置为 UTF8，您也必须执行以下操作才能使 Unicode 字段正常工作：

1.  确保您使用的是 Unicode 字段类型，例如*NVARCHAR*或*TEXT CHARSET utf8*
2.  每当您在字段中插入任​​何内容时，都必须在其前面加上 N 字符以指示 Unicode 数据，如下例所示
3.  每当您基于 Unicode 数据进行选择时，请确保再次使用 N 前缀

* * *

```
MySqlCommand cmd = new MySqlCommand("INSERT INTO EXAMPLE (someField) VALUES (N'Unicode Data')");

MySqlCommand cmd2 = new MySqlCommand("SELECT * FROM EXAMPLE WHERE someField=N'Unicode Data'"); 
```

如果数据库配置不正确或插入数据时没有使用 N 前缀，则无法获取正确的数据，因为它将被向下转换为拉丁 1/ASCII 字符集

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T08:43:20.103

尝试通过“set names utf8”查询设置编码。您也可以在 mysql 配置中设置此参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T20:37:32.847

正如其他人所说，这可能是一个数据库问题，但也可能是由使用旧版本的 .net mysql 连接器引起的。

我真正想评论的是 utf8 到 utf16 的转换。您尝试转换的字符串实际上已经是 unicode 编码的，因此您的“Ã«”字符实际上占用 4 个字节（或更多），并且在转换时不再是“ë”字符的错误表示。这就是为什么你的转换没有做任何事情的原因。如果您想进行这样的转换，我认为您必须使用代码页将 utf8 字符串编码为每个字符串 1 个字节的旧样式，其中 Ã 和 « 的字节值实际上表示 ë 的 utf8 字节序列，然后将此新字符串的字节视为 utf8 字符串。好玩的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-03T21:34:21.683

谢谢牛嘴，您的解决方案有效，但我们仍然需要转换字符。我认为这是您的问题 :) 并且对于转换字符，您可以使用此代码

```
 System.Text.Encoding utf_8 = System.Text.Encoding.UTF8;

 string s = "unicode";

 //string to utf
 byte[] utf = System.Text.Encoding.UTF8.GetBytes(s);

 //utf to string
 string s2= System.Text.Encoding.UTF8.GetString(utf); 
```

# c# - 指定的演员表无效。ListView 和 Linq

> ID：942282
> 
> 赞同：1
> 
> 时间：2009-06-02T22:39:43.523
> 
> 标签：c#, linq

我使用 ListView 和 Linq 作为数据源时遇到问题。错误下来：

```
 Specified cast is not valid.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.InvalidCastException: Specified cast is not valid.

System.Data.SqlClient.SqlBuffer.get_Int64() +58
   System.Data.SqlClient.SqlDataReader.GetInt64(Int32 i) +38
   Read_ForumThreadPostDetail(ObjectMaterializer`1 ) +95
   System.Data.Linq.SqlClient.ObjectReader`2.MoveNext() +29
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +96
   System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) +7667556
   System.Linq.Enumerable.ToList(IEnumerable`1 source) +61 
```

源代码

```
Public IEnumerable<IForumThreadPost> GetForumPostByThreadAndPost()
{
    ScoutDataDataContext sd = new ScoutDataDataContext();
    long ThreadId = Convert.ToInt64(HttpContext.Current.Request.QueryString["id"]);
    long PostId = Convert.ToInt64(HttpContext.Current.Request.QueryString["postId"]);
    ///.Skip((pageIndex - 1)*pageSize).Take(pageSize) + int pageIndex, int pageSize
    return sd.ForumThreadPostDetails
          .AsEnumerable()
          .Where(f => f.ThreadId.Equals(ThreadId) && f.PostId.Equals(PostId))
          .Select(f => 
               new IForumThreadPost 
               { 
                  Id = f.Id, 
                  ThreadId = f.ThreadId, 
                  PostId = f.PostId, 
                  Title = f.Title, 
                  ThreadTitle = f.ThreadTitle, 
                  Content = f.Content, 
                  UserFullName = f.UserFullName, 
                  UserId = f.UserId 
              }).ToList(); // error here

} 
```

这个功能之前有工作，所以我不知道问题是什么。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T22:53:32.090

如果没有看到更多的代码或数据库结构，就很难找到一个好的解决方案。查看 ForumThreadPostDetails 表和生成的 LinqToSql 类将是理想的。

数据库中的 ThreadId 和 PostId 都是“BigInt”吗？

IForumThreadPost 和 ForumThreadPostDetails 中的属性之间的类型是否匹配（并且详细信息类是否从该接口继承，如果它甚至是一个接口）？

是否对数据库中的 ForumThreadPostDetails 表进行了任何更改（字段更改类型等）？

你为什么在你的桌子上调用 .AsEnumerable() ？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T23:00:01.250

问题是在数据库中 Id 是 int 并且在代码中它很长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:04:06.373

在这里可以看到一些东西。ichiban 是正确的，将 IForumThreadPost 更改为应有的值（ForumThreadPost ???）。

还有一个朋友告诉我，你应该尽可能使用最简单的对象。因为您使用的是 Listview，所以我会考虑将 IEnumerable 更改为数组。

例如：

```
Public ForumThreadPost[] GetForumPostByThreadAndPost()
{
    ScoutDataDataContext sd = new ScoutDataDataContext();
    var result = sd.ForumThreadPostDetails
          .Where(f => f.ThreadId.Equals(ThreadId) && f.PostId.Equals(PostId))
          .Select(f => 
                   new ForumThreadPost 
                   { 
                          Id = f.Id, 
                          ThreadId = f.ThreadId, 
                          PostId = f.PostId, 
                          Title = f.Title, 
                          ThreadTitle = f.ThreadTitle, 
                          Content = f.Content, 
                          UserFullName = f.UserFullName, 
                          UserId = f.UserId 
                  });

    return result.ToArray();

} 
```

# mysql - Mysql统计用户列数，并按修改日期分组

> ID：942288
> 
> 赞同：2
> 
> 时间：2009-06-02T22:42:44.077
> 
> 标签：mysql, select, count

有 2 列我想要从中获取数据。基本上我想每天看到新的注册。放轻松，我第一天使用 mysql（或任何数据库）

到目前为止我有这个

```
mysql> select created, count(id) from user group by created;
+---------------------+-----------+
| created             | count(id) |
+---------------------+-----------+
| 2009-05-27 00:58:56 |         1 | 
| 2009-05-27 01:27:30 |         1 | 
| 2009-05-27 02:35:37 |         1 | 
| 2009-05-27 02:58:56 |         1 | 
| 2009-05-27 03:36:03 |         1 | 
| 2009-05-27 03:38:03 |         1 | 
| 2009-05-27 03:48:16 |         1 | 
| 2009-05-27 03:51:37 |         1 | 
```

我想要的输出是

```
+---------------------+----------------------+
| created             | user                 |
+---------------------+----------------------+
| 2009-05-27          | 10                   |
| 2009-05-28          | 13                   | 
| 2009-05-29          | 19                   | 
```

任何帮助表示赞赏！

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T22:46:21.807

```
select DATE(created), count(id) from user group by DATE(created); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:48:22.320

```
SELECT DATE(created) as date, count(1) as nrRegistered
FROM user
GROUP BY date 
```

注意：通过计数 1 而不是 id 我们避免在表中查找并启用仅索引查询

# iphone - 改变导航栏的颜色

> ID：942296
> 
> 赞同：3
> 
> 时间：2009-06-02T22:45:59.343
> 
> 标签：iphone, cocoa-touch

如何更改导航栏的默认蓝色颜色？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T22:51:18.913

该类`UINavigationBar`具有`UIColor *tintColor`您可以在代码中更改的属性。

或者，该属性也在 InterfaceBuilder UI 设计工具中公开。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-03T06:32:28.367

假设您以编程方式而不是在 Interface Builder 中添加了导航栏，只需将其放在 viewDidLoad 方法中即可。

```
self.navigationController.navigationBar.tintColor = [UIColor grayColor]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T16:08:50.850

TintColor 属性不影响导航栏的默认子视图作为底部边框和阴影。有时完全覆盖导航栏的布局很有用。

尽管 navigationBar 是 UINavigationController 的只读属性，但您可以通过“setValue:forKey:”来避免此限制。该方法在成功提交到 AppStore 的 5 个应用程序上获得批准。

您可以继承 UINavigationBar 并根据需要更改 drawRect: 方法。例如，

```
@implementation CustomNavigationBar

- (void) drawRect:(CGRect)rect
{
    [super drawRect:rect];
    UIImage *backgroundImage = ImageFromColor(WANTED_COLOR);
    [backgroundImage drawInRect:rect];
} 
```

在您可以继承 UINavigationController 并更改 initWithRootViewController 之后：

```
- (id) initWithRootViewController:(UIViewController *)rootViewController
{
    self = [super initWithRootViewController:rootViewController]; 
    if (self) 
    {
        CustomNavigationBar *navBar = [CustomNavigationBar new];
        [self setValue:navBar forKey:@"navigationBar"];
    }
    return self;
} 
```

您也可以通过为 UINavigationController 制作 Category 并为 initWithRootViewController 实现方法 swizzling 来改变这种方法：

PS 昨天我的新应用程序出现在 AppStore 上，这种方法没有任何问题。

# svn - How to make SVN perform a command without making changes

> ID：942302
> 
> 赞同：13
> 
> 时间：2009-06-02T22:47:11.540
> 
> 标签：svn

In CVS I could do the following

```
cvs -n update 
```

And it would should me what would happen if I ran an update but without changing anything. I mainly use this to check if I am going to get a lot of conflicts.

In svn I would like to do the same but with the switch command

ie:

```
svn -n switch url1 url2 
```

My understanding is that there is a --dry-run switch which goes through the motions but doesn't actually give any output. So it is half of the way there :)

How can I get it to do a dry run **and** show what the results would be (which files will be Modified, which Updated, Deleted, Added and Conflicting).

Thanks

Update: Regarding those who have suggested I use --dry-run I have tried the following

> svn switch url --dry-run

and I get

```
Subcommand 'switch' doesn't accept option '--dry-run' 
```

In theory it sounds good but it doesn't seem to work, am I doing something wrong?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T23:08:35.897

Use `merge` and `--dry-run` with the same URLs you will use for the `switch`. It should give you the information you are looking for even though you'll be using `switch` instead of `merge` in the end.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-15T17:49:57.800

On svn update, you can use `svn status --show-updates` to show all items you will update.

For merges, you can use `--dry-run` any problems.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T22:52:53.840

Use *--dry-run*

> --dry-run
> Goes through all the motions of running a command, but makes no actual changes—either on disk or in the repository.

From: [Subversion Complete Reference](http://svnbook.red-bean.com/en/1.1/ch09.html)

Well your question was (and still is so far)

> How to make SVN perform a command without making changes

The answer is: **Use *--dry-run***

The fact the *--dry-run* does not work with the *switch* command is tough luck, but @Don gave you a nice workaround

> Use merge and --dry-run with the same URLs you will use for the switch. It should give you the information you are looking for even though you'll be using switch instead of merge in the end.

Of course you can also file a [bug/enhancement report with subversion](http://subversion.tigris.org/issue-tracker.html).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:50:28.227

As far as I was aware, `dry-run` will show you what it will do, including what will be conflicted, etc.

[http://svnbook.red-bean.com/en/1.4/svn.branchmerge.copychanges.html](http://svnbook.red-bean.com/en/1.4/svn.branchmerge.copychanges.html) (search for "dry-run" on that page)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-04T10:11:38.033

In addition to svn status -u, which will show what files will get updated. This oneliner will give you output about what contents will be changed :

`svn diff -r BASE:HEAD`

You might want to pipe this to more if it are many changes.

`svn diff -r BASE:HEAD | more`

# iphone - iPhone App › 添加语音识别？

> ID：942312
> 
> 赞同：15
> 
> 时间：2009-06-02T22:50:41.050
> 
> 标签：iphone, speech-recognition, voice-recording, speech-to-text

我想构建一个使用语音识别的应用程序。我见过像谷歌这样的大公司实现了这个功能，但我很好奇在初创阶段做这件事。有人调查过这个吗？我们有什么工具可以做到这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-12-28T18:48:22.473

OpenEars 看起来很有前途... [http://www.politepix.com/openears/](http://www.politepix.com/openears/)

基于袖珍狮身人面像。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-24T20:04:09.727

如果你从维基百科开始，你会得到一个很好的列表引擎（[http://en.wikipedia.org/wiki/Speech_recognition#Commercial_software.2Fmiddleware](http://en.wikipedia.org/wiki/Speech_recognition#Commercial_software.2Fmiddleware)）

在我写这篇文章时（2009 年 6 月 24 日），在我看来这是两个可行的开源解决方案

*   袖珍狮身人面像 ( [http://www.speech.cs.cmu.edu/pocketsphinx](http://www.speech.cs.cmu.edu/pocketsphinx/) )
*   朱利叶斯 ( [http://en.wikipedia.org/wiki/Julius_(software)](http://en.wikipedia.org/wiki/Julius_%28software%29) )

两者都已在 iphone 应用程序中使用，但对 iphone 友好的源并不容易获得。

在我编辑这篇文章时（2009 年 7 月 8 日），我最近了解到 Loquendo ( [http://www.loquendo.com/en/](http://www.loquendo.com/en/) ) 具有适用于 iphone 的语音识别和语音合成 (ASR & TTS)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T23:26:03.007

最好的方法可能是：

1.  录制电话里的声音
2.  将录音发送到运行语音识别软件的服务器
3.  然后向手机返回一些东西以指示它应该做什么

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T11:36:39.490

Nuance 的 Dragon Mobile SDK 可以满足您的要求。您需要互联网连接才能将音频发送到 Nuance 的服务器，并获得文本响应列表。然后，您可以决定如何处理文本响应（例如，要求您的用户选择他所指的那个或执行一些操作）。链接在这里：

[http://dragonmobile.nuancemobiledeveloper.com/](http://dragonmobile.nuancemobiledeveloper.com/)

# flash - 使用 Mootools Swiff 对象在 JS 和 Flash 电影之间进行对话的技巧？

> ID：942316
> 
> 赞同：1
> 
> 时间：2009-06-02T22:51:29.800
> 
> 标签：flash, mootools

我正在尝试使用 Mootool 的 Swiff 对象来加载 Flash 电影并开始与它交谈。我一直在关注这里的例子：

[http://mootools.net/blog/2008/02/12/whats-new-in-12-swiff/#more-63](http://mootools.net/blog/2008/02/12/whats-new-in-12-swiff/#more-63)

我知道这有点过时（事件选项显然应该是回调）但至少应该是一个开始。然而，我不能让事情工作一点。没有 JS 错误，萤火虫说它至少从我的服务器加载了 SWF，但没有警报！少了什么东西？

动作脚本：

```
//(ActionScript)
import flash.external.*;

function echoText(text) {
    ExternalInterface.call('alert', "This message is from Flash: "+text);   
}

ExternalInterface.addCallback( "echoText", this, echoText );

//Fires the 'onLoad' event within the Swiff object.
ExternalInterface.call(_root.onLoad); 
```

我的 JS：

```
<html>
    <head>
        <title>Terris test console</title>
    </head>
    <body>
        <script type="text/javascript" src="mootools.js"></script>
        <script type="text/javascript">

            var obj;

            window.addEvent( "domready", function() {
                //(JavaScript)
                obj = new Swiff('interface.swf', {
                    width:  1,
                    height: 1,
                    container: $('swiffContainer'),
                    callBacks: {
                        onLoad: function() {
                            alert("Flash is loaded!")
                        }
                    }
                });
            });

        </script>
    </body>
</html> 
```

我在这里使用 Mootools 1.2.2 [http://mootools.net/download](http://mootools.net/download)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T22:33:08.913

你不需要一个

```
<div id='swiffContainer'></div> 
```

在你身体的某个地方？

# .net - 按类名实例化 .Net 对象

> ID：942317
> 
> 赞同：4
> 
> 时间：2009-06-02T22:51:32.797
> 
> 标签：.net

我有一个抽象类 Step，以及我想基于 XML 文档实例化的许多后代 Step 类。

因此，我想根据 XML 文档中的类型创建特定步骤类的实例

Step type="GenerateReport" .... Step type="PrintReport" ....

如何通过指定类名（理想情况下是要传递给构造函数的参数）来实例化对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T22:52:13.607

我认为您只是想使用以下[`Activator.CreateInstance`](http://msdn.microsoft.com/en-us/library/d133hta4.aspx)方法：

```
var object = Activator.CreateInstance(null, "Classname"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T23:00:10.190

最简单的选择是`Activator.CreateInstance`接受 a`Type`和 a的重载`params object[]`。对于`Type`，您*有时*可以使用`Type.GetType(string)`，但这不会检查所有程序集（仅检查当前程序集和一些系统程序集）。如果名称是程序集限定的，你可能会没事 - 但如果它只是命名空间限定的（即 FullName），那么你可能想要使用`Assembly.GetType(string)`- 即

```
Type type = typeof(SomeKnownTypeInTheSameAssembly).GetType(fullName);
object obj = Activator.CreateInstance(type, args); 
```

# database - 数据库如何处理密集数据？

> ID：942323
> 
> 赞同：0
> 
> 时间：2009-06-02T22:52:27.350
> 
> 标签：database, performance

假设您有一个带有整数主键的密集表，您知道该表将包含从 0 到 1,000,000 的所有值的 99%。

实现这种表的一种超级有效的方法是数组（或磁盘上的平面文件），假设记录大小固定。

有没有办法使用数据库来实现类似的效率？

**澄清**- 当存储在一个简单的表/数组中时，对条目的访问是 O(1) - 只是一个内存读取（或从磁盘读取）。据我了解，所有数据库都将其节点存储在树中，因此它们无法实现相同的性能 - 访问普通节点需要几跳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T17:04:30.857

也许我不明白您的问题，但数据库旨在处理数据。我整天都在使用具有数百万行的数据库。他们的效率已经足够了。

我不知道您对“使用数据库实现类似效率”的定义是什么意思。在数据库中（根据我的经验），究竟要做什么与性能有关。

如果您只需要基于主键的单个记录，那么假设数据库结构正确（例如，3NF），数据库自然应该足够高效。

同样，您需要将数据库设计为高效地满足您的需求。此外，考虑如何在给定结构中针对数据库编写查询。

在我的工作中，我已经能够通过优化我的连接、where 子句和整体查询结构将查询执行时间从 >15 分钟缩短到 1 或 2 秒。显然，正确的索引也很重要。

另外，请考虑您将要使用的数据库引擎。我一直在*假设*SQL server 或 MySql，但那些可能不正确。我听说（但从未测试过这个想法）SQLite 非常快 - 比前面提到的任何一个都快。还有很多其他的选择，我敢肯定。

**更新**：**根据你在评论中的解释，我会说不**——你不能。您正在询问为两种完全不同的事物设计的机械装置。数据库在很长一段时间内持久保存数据，并且通常针对许多连接和数据读/写进行优化。在您的描述中，数组中的数据，内存中的数据是供单个程序访问的，并且该程序拥有内存。它不是（通常）共享的。我看不出你如何能达到同样的性能。

**另一个想法：**你可以得到的最接近的东西，特别是在 SQL 服务器中，是使用[表变量](http://www.odetocode.com/articles/365.aspx)。表变量（理论上）仅保存在内存中。我听说人们将表变量称为 SQL Server 的“数组”。任何常规的表写入或创建语句都会提示 RDMS 写入磁盘（我认为，首先是日志，然后是数据文件）。大数据读取还可能导致数据库写入私有临时表以存储数据以供以后使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T09:43:12.440

您无法指定如何将数据物理存储在数据库中。您可以做的大多数事情是指定数据和索引是分开存储还是存储在一个索引树中（如 Brian 所描述的聚集索引）。

但在你的情况下，这根本不重要，因为：

1.  所有数据库都大量使用缓存。1.000.000 条记录几乎不会超过 1GB 内存，因此您的完整数据库将很快被缓存在数据库缓存中。
2.  如果您一次读取一条记录，您将看到的主要开销是通过数据库协议访问数据。过程是这样的：
    *   连接到数据库 - 打开通信通道
    *   将 SQL 文本从应用程序发送到数据库
    *   数据库分析 SQL（解析 SQL，检查 SQL 命令是否以前编译过，如果它是第一次发出，则编译命令，...）
    *   数据库执行 SQL。执行几次后，示例中的数据将缓存在内存中，因此执行速度会非常快。
    *   数据库打包获取的记录以传输到应用程序
    *   数据通过通信通道发送
    *   应用程序中的数据库组件将接收到的数据解包为一些数据集表示（例如 ADO.Net 数据集）

在您的场景中，与将数据从数据库获取到应用程序所需的总时间相比，执行 SQL 和查找记录所需的时间非常少。即使您可以强制数据库将数据存储到数组中，也不会有明显的收获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T00:42:00.653

创建具有 ID 列和位列的 DB。对 ID 列使用聚集索引（ID 列是您的主键）。插入所有 1,000,000 个元素（按顺序插入，否则会很慢）。这在空间方面有点低效（您使用的是 nlgn 空间而不是 n 空间）。

我不认为这是有效的，但它将以与存储数组的方式类似的方式存储。

请注意，在大多数数据库系统中，ID 列可以标记为计数器，在这种情况下，您只需插入 1000000 个项目，它就会为您进行计数。我不确定这样的数据库是否避免显式存储计数器的值，但如果确实如此，那么您最终只会使用 n 空间）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T09:03:04.693

当您将主键作为整数序列时，最好使用[反向索引](http://en.wikipedia.org/wiki/Reverse_index)。这种确保连续值在索引树中分散开。但是，有一个问题 - 使用反向索引您将无法进行范围搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T16:51:22.417

最大的问题是：对什么有效？

对于 oracle 的想法可能包括：

*   按 id 读取访问：索引组织表（这可能是您要查找的内容）
*   仅插入，无更新：无索引，无备用空间
*   读访问全表扫描：压缩
*   id 来自序列时的高并发写入：反向索引
*   对于实际问题，正如所问的那样：将所有行写在一个 blob 中（表包含一列，一行。您可能可以像数组一样访问它，但我不确定，因为我不知道什么操作在 blob 上是可能的。即使它有效，我认为这种方法在任何现实场景中都不会有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T22:57:20.477

如果您在数据库中有相当数量的记录（并且 1MM 也不错，并不是那么大），那么[索引](http://en.wikipedia.org/wiki/Database_index)就是您的朋友。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T23:10:51.493

您说的是旧的固定记录长度平面文件。是的，与数据库相比，它们的效率非常高，但就像结构/值数组与类一样，它们只是没有我们今天通常期望的那种特性。

像：

*   搜索不同的列/组合
*   可变长度列
*   可为空的列
*   可编辑性
*   重组
*   并发控制
*   交易控制等

# java - 在类上调用静态方法？

> ID：942326
> 
> 赞同：18
> 
> 时间：2009-06-02T22:53:09.313
> 
> 标签：java, class, static-methods

说，我有一个类对象的引用，其中 SomeType 有一个静态方法。有没有办法在不先实例化 SomeType 的情况下调用该方法？最好不要逃避强类型。

编辑：好的，我搞砸了。

```
interface Int{
    void someMethod();
}

class ImplOne implements Int{
    public void someMethod() {
        // do something
    }
}

Class<? extends Int> getInt(){
    return ImplOne.class;
} 
```

在这种情况下 someMethod() 无论如何都不能是静态的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-02T22:54:57.250

我不确定具体是什么情况，但是如果您希望在不知道类类型的情况下对类执行静态方法（即您不知道它是 SomeType，您只有 Class 对象），如果您知道可以使用反射的方法的名称和参数并执行以下操作：

```
Class c = getThisClassObjectFromSomewhere();

//myStaticMethod takes a Double and String as an argument
Method m = c.getMethod("myStaticMethod", Double.class, String.class);
Object result = m.invoke(null, 1.5, "foo"); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-02T22:56:20.413

根据定义，静态方法在类上调用，而不是在该类的实例上调用。

因此，如果您使用：

```
SomeClass.someStaticMethod() 
```

您什么都没有实例化（撇开`SomeClass`类本身的类加载和实例化，JVM 处理这些并且超出了您的范围）。

这与在已经实例化的对象上调用的常规方法相反：

```
SomeObject o = someObject; // had to be instantiated *somewhere*
o.someMethod(); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-02T23:07:28.847

由于您谈论的是 Class 对象，我假设您对 Java 反射感兴趣。这是一个简短的片段，可以做你想做的事情：

```
Class someClass = SomeType.class;
Method staticMethod = someClass.getMethod( "methodName", ... );

// pass the first arg as null to invoke a static method
staticMethod.invoke( null, ... ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:57:45.093

是的。这就是静态方法的全部意义所在。就叫吧。SomeType.yourStaticMethodHere()。

# python - 如何将此 NetHack 函数移植到 Python？

> ID：942328
> 
> 赞同：11
> 
> 时间：2009-06-02T22:53:55.443
> 
> 标签：python, c, time, porting, nethack

我正在尝试编写一个 Python 函数，它返回与游戏 NetHack 中相同的月相值。这可以在[hacklib.c](http://nethack.wikia.com/wiki/Source:Hacklib.c#phase_of_the_moon)中找到。

我试图简单地从 NetHack 代码中复制相应的函数，但我不相信我得到了正确的结果。

我写的函数是`phase_of_the_moon()`.

我在网上找到的函数`position()`和`phase()`，我用它们作为我函数成功的标志。它们非常准确，并且给出的结果与 nethack.alt.org 服务器大致匹配（参见[http://alt.org/nethack/moon/pom.txt](http://alt.org/nethack/moon/pom.txt)）。然而，我所追求的是原始 NetHack 功能的精确复制，特性完好无损。

我希望我的功能和“控制”功能至少提供相同的月相，但目前他们没有，我不知道为什么！

这是 NetHack 代码：

```
/*
 * moon period = 29.53058 days ~= 30, year = 365.2422 days
 * days moon phase advances on first day of year compared to preceding year
 *  = 365.2422 - 12*29.53058 ~= 11
 * years in Metonic cycle (time until same phases fall on the same days of
 *  the month) = 18.6 ~= 19
 * moon phase on first day of year (epact) ~= (11*(year%19) + 29) % 30
 *  (29 as initial condition)
 * current phase in days = first day phase + days elapsed in year
 * 6 moons ~= 177 days
 * 177 ~= 8 reported phases * 22
 * + 11/22 for rounding
 */
int
phase_of_the_moon()     /* 0-7, with 0: new, 4: full */
{
    register struct tm *lt = getlt();
    register int epact, diy, goldn;

    diy = lt->tm_yday;
    goldn = (lt->tm_year % 19) + 1;
    epact = (11 * goldn + 18) % 30;
    if ((epact == 25 && goldn > 11) || epact == 24)
        epact++;

    return( (((((diy + epact) * 6) + 11) % 177) / 22) & 7 );
} 
```

这是`getlt()`函数（也在 hacklib.c 中）：

```
static struct tm *
getlt()
{
    time_t date;

#if defined(BSD) && !defined(POSIX_TYPES)
    (void) time((long *)(&date));
#else
    (void) time(&date);
#endif
#if (defined(ULTRIX) && !(defined(ULTRIX_PROTO) || defined(NHSTDC))) || (defined(BSD) && !defined(POSIX_TYPES))
    return(localtime((long *)(&date)));
#else
    return(localtime(&date));
#endif
} 
```

这是我的 Python 代码：

```
from datetime import date

def phase_of_the_moon():
   lt = date.today()

   diy = (lt - date(lt.year, 1, 1)).days
   goldn = ((lt.year - 1900) % 19) + 1
   epact = (11 * goldn + 18) % 30;
   if ((epact == 25 and goldn > 11) or epact == 24):
      epact += 1
   return ( (((((diy + epact) * 6) + 11) % 177) / 22) & 7 )

import math, decimal, datetime
dec = decimal.Decimal

def position(now=None): 
   if now is None: 
      now = datetime.datetime.now()

   diff = now - datetime.datetime(2001, 1, 1)
   days = dec(diff.days) + (dec(diff.seconds) / dec(86400))
   lunations = dec("0.20439731") + (days * dec("0.03386319269"))

   return lunations % dec(1)

def phase(pos): 
   index = (pos * dec(8)) + dec("0.5")
   index = math.floor(index)
   return {
      0: "New Moon", 
      1: "Waxing Crescent", 
      2: "First Quarter", 
      3: "Waxing Gibbous", 
      4: "Full Moon", 
      5: "Waning Gibbous", 
      6: "Last Quarter", 
      7: "Waning Crescent"
   }[int(index) & 7]

def phase2(pos): 
   return {
      0: "New Moon", 
      1: "Waxing Crescent", 
      2: "First Quarter", 
      3: "Waxing Gibbous", 
      4: "Full Moon", 
      5: "Waning Gibbous", 
      6: "Last Quarter", 
      7: "Waning Crescent"
   }[int(pos)]

def main():
   ## Correct output
   pos = position()
   phasename = phase(pos)
   roundedpos = round(float(pos), 3)
   print "%s (%s)" % (phasename, roundedpos)

   ## My output
   print "%s (%s)" % (phase2(phase_of_the_moon()), phase_of_the_moon())

if __name__=="__main__": 
   main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T00:54:48.757

编写的代码在很大程度上是不可测试的——您需要使其可测试。因此，您需要 C 代码为：

```
int
phase_of_the_moon()     /* 0-7, with 0: new, 4: full */
{
    register struct tm *lt = getlt();
    return testable_potm(lt);
}

static int
testable_potm(const struct tm *lt)
{
    register int epact, diy, goldn;

    diy = lt->tm_yday;
    goldn = (lt->tm_year % 19) + 1;
    epact = (11 * goldn + 18) % 30;
    if ((epact == 25 && goldn > 11) || epact == 24)
        epact++;

    return( (((((diy + epact) * 6) + 11) % 177) / 22) & 7 );
} 
```

现在您可以运行具有多个时间值的测试。另一种方法是伪造`getlt()`。

然后，您需要在 Python 代码中进行并行更改。然后创建一个`time_t`Python 和 C 都可以读取的值文件，然后转换为适当的结构（通过`localtime()`C 语言）。然后你可以看到事情在哪里偏离。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T23:44:57.557

**编辑：**原来我在这里发现的两个“问题”都是基于对`tm`结构的误解。为了评论中的讨论，我将保留完整的答案，但将您的投票留给可能真正正确的人。;-)

* * *

警告：我对 C 时间结构不是很熟悉；我主要是离开为`strftime`.

我在您的端口中看到两个“错误”。首先，我认为`tm_year`应该是没有世纪的年份，而不是减去 1900 的年份，所以`goldn`应该是`((lt.year % 100) % 19) + 1`. 其次，您的计算`diy`是从零开始的，而`tm_yday`（同样，来自文档）似乎是从一开始的。但是，我不确定后者，因为仅修复该`goldn`行会给出正确的结果（至少在今天），而修复两者都会给出错误的答案：

```
>>> def phase_of_the_moon():
    lt = date.today()

    diy = (lt - date(lt.year, 1, 1)).days
    goldn = ((lt.year % 100) % 19) + 1
    epact = (11 * goldn + 18) % 30
    if ((epact == 25 and goldn > 11) or epact == 24):
        epact += 1
    return ( (((((diy + epact) * 6) + 11) % 177) / 22) & 7 )

>>> phase_of_the_moon():
3 
```

同样，这主要是猜测。请善待。:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-01T22:58:43.530

我在这个线程上已经很晚了，但是 fwiw，alt.org 服务器通过 web 显示的 pom 每天只在 cron 上更新几次，所以如果你离它有点远，那可能就是原因。游戏本身从 nethack 代码本身的任何内容运行，因此不会遇到相同的缓存问题。-drew（alt.org 所有者）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T00:27:40.170

奇怪的是，当我编译并运行 nethack 示例时，我得到“2”作为答案（“第一季度”与您的端口相同）

```
#include <time.h>

static struct tm *
getlt()
{
        time_t date;
        (void) time(&date);
        return(localtime(&date));
}
/*
 * moon period = 29.53058 days ~= 30, year = 365.2422 days
 * days moon phase advances on first day of year compared to preceding year
 *  = 365.2422 - 12*29.53058 ~= 11
 * years in Metonic cycle (time until same phases fall on the same days of
 *  the month) = 18.6 ~= 19
 * moon phase on first day of year (epact) ~= (11*(year%19) + 29) % 30
 *  (29 as initial condition)
 * current phase in days = first day phase + days elapsed in year
 * 6 moons ~= 177 days
 * 177 ~= 8 reported phases * 22
 * + 11/22 for rounding
 */
int
phase_of_the_moon()     /* 0-7, with 0: new, 4: full */
{
    register struct tm *lt = getlt();
    register int epact, diy, goldn;

    diy = lt->tm_yday;
    goldn = (lt->tm_year % 19) + 1;
    epact = (11 * goldn + 18) % 30;
    if ((epact == 25 && goldn > 11) || epact == 24)
        epact++;

    return( (((((diy + epact) * 6) + 11) % 177) / 22) & 7 );
}

int main(int argc, char * argv[]) {
    printf ("phase of the moon %d\n\n", phase_of_the_moon());
} 
```

输出：

```
> a.out
phase of the moon 2 
```

但这似乎不是正确的答案，因为今天，weatherunderground.com 和 alt.org 将月相报告为“Waxing Gibbous”（又名 3）。

我尝试删除“-1900”，但这也没有得到正确的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-22T09:42:18.220

以下代码是[从该站点借用的](http://www.daniweb.com/code/post968407.html)，将其粘贴到此处以方便参考（以防其他站点出现故障）。似乎做你想做的事。

```
# Determine the moon phase of a date given
# Python code by HAB

def moon_phase(month, day, year):
    ages = [18, 0, 11, 22, 3, 14, 25, 6, 17, 28, 9, 20, 1, 12, 23, 4, 15, 26, 7]
    offsets = [-1, 1, 0, 1, 2, 3, 4, 5, 7, 7, 9, 9]
    description = ["new (totally dark)",
      "waxing crescent (increasing to full)",
      "in its first quarter (increasing to full)",
      "waxing gibbous (increasing to full)",
      "full (full light)",
      "waning gibbous (decreasing from full)",
      "in its last quarter (decreasing from full)",
      "waning crescent (decreasing from full)"]
    months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]

    if day == 31:
        day = 1
    days_into_phase = ((ages[(year + 1) % 19] + ((day + offsets[month-1]) % 30) + (year < 1900)) % 30)
    index = int((days_into_phase + 2) * 16/59.0)
    if index > 7:
        index = 7
    status = description[index]

    # light should be 100% 15 days into phase
    light = int(2 * days_into_phase * 100/29)
    if light > 100:
        light = abs(light - 200);
    date = "%d%s%d" % (day, months[month-1], year)

    return date, status, light

# put in a date you want ...
month = 5
day = 14
year = 2006  # use yyyy format

date, status, light = moon_phase(month, day, year)
print "moon phase on %s is %s, light = %d%s" % (date, status, light, '%') 
```

您可以使用该`time`模块获取**当前本地时间**。下面是我是如何做到的（将下面发布的代码粘贴到测试运行中）：

```
import time
tm = time.localtime()
month = tm.tm_mon
day = tm.tm_mday
year = tm.tm_year
date, status, light = moon_phase(month, day, year)
print "moon phase on %s is %s, light = %d%s" % (date, status, light, '%') 
```

输出：

```
moon phase on 22Dec2009 is waxing crescent (increasing to full), light = 34% 
```

月亮的东西很有趣。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-01T02:56:56.820

这是我对它的转换，我已经通过从 xrange(0, 1288578760, 3601) 中传入值对 C 代码进行了测试，它们都返回相同的值。请注意，我已对其进行了更改，以便您可以通过自纪元以来的秒数，以便我可以针对 C 版本对一百万个不同值的三分之一进行测试。“秒”值是可选的

```
def phase_of_the_moon(seconds = None):
   '0-7, with 0: new, 4: full'
   import time

   if seconds == None: seconds = time.time()
   lt = time.localtime(seconds)

   tm_year = lt.tm_year - 1900
   diy = lt.tm_yday - 1
   goldn = (tm_year % 19) + 1
   epact = (11 * goldn + 18) % 30

   if (epact == 25 and goldn > 11) or epact == 24: epact += 1

   return (((((diy + epact) * 6) + 11) % 177) / 22) & 7
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-22T09:30:24.207

我喜欢认为我对日历了解一两件事，所以让我们看看我是否可以弄清楚一些事情。

天主教会根据月相来定义复活节的日期（这就是日期每年跳跃的原因）。正因为如此，它需要能够计算近似月相，[这里](http://en.wikipedia.org/wiki/Computus)解释了它的算法。

我没有做非常详细的检查，但似乎 NetHack 算法很大程度上基于 Church 的算法。NetHack 算法似乎和 Church 的算法一样，只关注日历日期，忽略时区和一天中的时间。

NetHack 算法仅使用年份和年份中的日期。通过检查代码，我可以看出，为了兼容 Y2K，tm_year 必须是减去 1900 的年份。

# subsonic - 亚音速版

> ID：942333
> 
> 赞同：0
> 
> 时间：2009-06-02T22:55:54.690
> 
> 标签：subsonic

我有 2.2 版本的 Subsonic 但 SubSonic.dll 的版本为 2.1.1.0 可以吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T00:15:45.183

这是 zip 文件分发中的一个错误。它有几个 2.1.1.0 的副本。这不好。2.2.0 位于 zip 发行版的根目录中，请使用它。

# c# - 重命名字段然后在 C# 中反序列化

> ID：942343
> 
> 赞同：6
> 
> 时间：2009-06-02T22:58:23.483
> 
> 标签：c#, serialization

我将数据存储在已使用 .net BinaryFormatter 序列化的类的实例中。我现在想重命名类中的一个字段，但仍然能够反序列化旧数据。

一种选择是实现 ISerializable 并手动反序列化类的所有字段。但这似乎需要做很多工作，特别是如果我的班级有很多字段并且我只重命名了一个字段。

有没有更好的办法？

* * *

Craig 建议保留旧类的副本以进行反序列化，并将值复制到新类。我在其他地方也看到过这个建议——这比实现 ISerializable 有什么优势？据我所见，复制类给我留下了 2 个几乎相同的类副本，而且我仍然必须将所有值从旧类复制到新类——这似乎与使用 ISerializable 实现相同的工作量几乎重复的课程混在一起。

* * *

有两个答案提到了Binders。我已经成功地使用了 SerializationBinder 来反序列化一个被序列化为类 Foo 的类 Bar，但那是因为类的名称发生了变化。当您重命名字段时，SerializationBinder 是否也有帮助 - 比如当 int m_Left 已重命名为 int m_Right 时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T23:05:09.850

是的，这是基于字段的序列化程序的问题。您可以使用 custom`Binder`或“序列化代理”来避免实现`ISerializable`，但这只是逐案修复。

我在这里讨论过这个话题（在混淆器和自动道具的背景下[）](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)。我的建议是：不要`BinaryFormatter`用于版本之间的数据持久性......为此，请查看基于合同的序列化程序：

*   `XmlSerializer`
*   `DataContractSerializer`
*   或者对于二进制文件，比如[protobuf-net](http://code.google.com/p/protobuf-net/)

这些都不能帮助你*今天*，但它可能会帮助你在未来围绕它进行设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T23:02:34.023

您可以尝试让旧课程仅出于补液的目的而闲逛，然后将您需要的字段复制到新课程。仍然有点痛苦，但应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:07:12.187

我之前为此使用了 SerializationBinder 类

[http://msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder.aspx)

它可用于反序列化，因此您可以将旧类型重新映射到新类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T23:25:28.437

如果您只是将该属性上的访问修饰符更改为私有，然后拥有一个具有新名称的公共属性，该名称基本上包装了旧名称。这样，您仍然应该能够反序列化（我认为），但是使用此类的任何人都不知道旧名称。只是一个想法...

# jquery - 为 jQuery 的 $.data() 存储多个值的最佳方式是什么？

> ID：942348
> 
> 赞同：13
> 
> 时间：2009-06-02T23:00:50.360
> 
> 标签：jquery, dom, storage

如果在大量 div 上存储多个 (10+) 值，将它们全部存储在单个对象中还是作为单独的值更优化？

**单个对象：**

```
$("#div_id").data("data", {foo:1, bar:2}); 
```

**单独的值：**

```
$("#div_id")
  .data("foo", 1)
  .data("bar", 2); 
```

每种方法的权衡是什么？其中一些属性将被频繁访问（例如，在拖动等事件回调期间）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-09-14T16:52:01.570

在 1.4 中，您可以这样做：

```
$('#somediv').data({ one : 1, two : 2, three : 3 }); 
```

这是初始化数据对象的好方法。但是，在 1.4.2 中，请记住，使用此表格将替换此元素上的任何现有数据。所以，如果你试试这个：

```
$('#somediv').data( 'one', 1 );

$('#somediv').data({ two : 2, three : 3 }); 
```

你会吹走“一”的价值。

（就个人而言，我认为这是一种耻辱，因为 jQuery 已经广泛使用了 $.extend 合并对象。我不清楚为什么这里没有使用它。）

**更新**（用户建议：@ricka，谢谢）：

1.4.3 及更高版本，它合并数据（[http://api.jquery.com/data/#data-obj](http://api.jquery.com/data/#data-obj)）：

> 在 jQuery 1.4.3 中，使用 .data(obj) 设置元素的数据对象扩展了先前与该元素一起存储的数据。jQuery 本身使用 .data() 方法将信息保存在名称 'events' 和 'handle' 下，并且还保留任何以下划线 ('_') 开头的数据名称供内部使用。
> 
> 在 jQuery 1.4.3 之前（从 jQuery 1.4 开始），.data() 方法完全替换了所有数据，而不仅仅是扩展数据对象。如果您使用第三方插件，可能不建议完全替换元素的数据对象，因为插件可能也设置了数据。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T23:24:55.943

如果这两种方法在您的代码中都同样易于使用，请选择存储单个对象。`data()`它避免了每次需要值时调用方法的额外开销。这样，您可以通过一次调用来获取映射对象`data()`，然后根据需要多次从该对象中检索值，而无需`data()`再次调用。

该`data()`方法使用对象将元素映射到引擎盖下的键/值，因此与自己管理映射对象相比，它没有提供任何性能改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-10T00:58:08.130

我可能会做类似的事情：

```
var data = $("#div_id").data();   
data.foo=1;  
data.bar=2; 
```

# c# - 什么时候使用静态变量？

> ID：942353
> 
> 赞同：3
> 
> 时间：2009-06-02T23:03:17.280
> 
> 标签：c#, global-variables

我目前正在用 C# 做一个带有大量渲染的项目，并且在几乎所有的类中，都有一个整数类型的常量值用于缩放渲染。我知道我可以在一个地方将此常量定义为普通变量，然后将其传递出去，但这似乎很麻烦。什么时候可以在 C# 中使用静态变量？解决我的问题的最简单方法是创建一个包含所有其他类都可以引用的静态变量的类——这会是糟糕的设计吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T23:09:06.677

**值有多**恒定？`static`对于有 的事情很好，但如果*不是*`readonly`，你很快就会陷入混乱- 特别是如果你有多个线程。缩放因子对我来说听起来并不像一个硬常数 - 即它不是： *`readonly`*

 *```
public const double ScaleFactor = 1; 
```

我会毫不犹豫地为我加载一次的东西使用静态变量，然后不理会。除此之外，我可能会（在你的情况下）`RenderContext`用这个值和任何其他实用程序方法封装某种类型 - 并传递`RenderContext`方法之间的方法；如果您需要进行单元测试等，这也可以帮助您从底层实现中抽象出来。

当你发现你需要更多的属性（你不可避免地会）时，你只需扩展`RenderContext`类 - 没有其他改变。

* * *

（编辑）

另外——考虑一下未来：你会一次做多个渲染吗？因为我们现在都有很多内核，等等......如果所有线程共享一个值，静态是好的。有`[ThreadStatic]`，但相比之下有点混乱。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T23:07:30.720

一点也不差的设计。事实上，拥有一个公开静态方法和静态值的 Common 或 Utility 命名空间和类将这些值集中在一个地方，这样您就可以确保应用程序中的每个模块都使用适当的值。这是低凝聚力，但可以接受的好处。我看没有问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T23:07:10.487

不，这实际上是静态变量的完美候选者。您甚至可以更进一步，将类设为静态，使其无法实例化。然后，您可以将所有常量以及必要时的一些辅助方法添加到该类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T23:08:55.710

答案是，如果程序有效且可维护，那就去做。

静态变量不是罪，知道何时使用它们是件好事。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T23:11:32.320

如果你所有的类都必须理解这个值+做其他事情，那么（除非它像 pi）你可能应该检查你的类是否有一个问题。也许这个“价值”需要成为一个可以执行当前在整个代码库中执行的操作的对象？

# mysql - 为什么这个 mysql 事件无法运行？

> ID：942354
> 
> 赞同：15
> 
> 时间：2009-06-02T23:03:46.033
> 
> 标签：mysql, events

```
mysql> show create event online_event;
+--------------+-----------------------------------------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+
| Event        | sql_mode                                | time_zone | Create Event                                                                                                                                                                                        | character_set_client | collation_connection | Database Collation |
+--------------+-----------------------------------------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+
| online_event | STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER | SYSTEM    | CREATE EVENT `online_event` ON SCHEDULE EVERY 1 SECOND STARTS '2009-06-03 06:54:16' ON COMPLETION NOT PRESERVE ENABLE DO DELETE FROM online where webserver_id is null and jabber_server_id is null | utf8                 | utf8_general_ci      | utf8_general_ci    |
+--------------+-----------------------------------------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+
1 row in set (0.00 sec)

mysql> 
```

它是这样创建的：

```
CREATE EVENT online_event
    ON SCHEDULE EVERY 1 SECOND
    DO 
      DELETE FROM online where webserver_id is null and jabber_server_id is null; 
```

一段时间后，我发现：

```
mysql> select *from online;
+----+------------+---------------------+--------------+------------------+
| id | account_id | since               | webserver_id | jabber_server_id |
+----+------------+---------------------+--------------+------------------+
|  1 |         30 | 2009-06-03 06:24:38 |         NULL |             NULL |
+----+------------+---------------------+--------------+------------------+
1 row in set (0.00 sec) 
```

所以我发现该事件根本没有运行。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-02T23:26:15.377

您的事件调度程序是否正在运行？检查与`SHOW PROCESSLIST`。

如果用户“event_scheduler”没有进程“守护进程”，则它没有运行。

因此启动事件调度程序：

```
SET GLOBAL event_scheduler = ON; 
```

另请参阅[http://dev.mysql.com/doc/refman/5.1/en/events-configuration.html](http://dev.mysql.com/doc/refman/5.1/en/events-configuration.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-10-27T20:24:22.370

首先你必须检查使用：

```
SHOW VARIABLES LIKE 'event_scheduler'; 
```

如果它关闭，您必须使用以下命令运行事件调度程序：

```
SET GLOBAL event_scheduler = ON; 
```

我的你必须在你的配置（my.ini / my.conf）中保存这个变量，如果你不这样做，事件将不会在 mysql restart 时启动。

```
[mysql]
event_scheduler=ON 
```

# .net - 任何人都有对 CIM_DataFile 类进行 WMI 查询的示例代码？

> ID：942356
> 
> 赞同：1
> 
> 时间：2009-06-02T23:04:09.743
> 
> 标签：.net, wmi

SELECT 获取有关文件或目录的信息的东西？真正有效的东西？

语言无关紧要，我对查询语法最感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-14T17:12:28.130

这里有一些例子：

*   查询文件：

    ```
    SELECT * FROM CIM_DataFile WHERE Name='C:\\WINDOWS\\NOTEPAD.EXE'
    SELECT * FROM CIM_DataFile WHERE Drive='C:' AND Path='\\Windows\\' AND FileName='Notepad' AND Extension='EXE' 
    ```

*   查询文件夹：

    ```
    SELECT * FROM CIM_Directory WHERE Name='C:\\Windows'
    SELECT * FROM CIM_Directory WHERE Drive='C:' AND Path='\\Program Files\\' AND FileName='Internet Explorer' 
    ```

有关查询语法的详细信息，请参阅[WQL（用于 WMI 的 SQL）](http://msdn.microsoft.com/en-us/library/aa394606.aspx)。另请参阅[`CIM_DataFile`](http://msdn.microsoft.com/en-us/library/aa387236.aspx)and[`CIM_Directory`](http://msdn.microsoft.com/en-us/library/aa387248.aspx)以获取可在`SELECT`and`WHERE`子句中使用的文件和文件夹属性的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T18:23:39.257

[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)有一些帮助。
请参阅此代码：

```
strComputer = "." 
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\CIMV2") 
Set colItems = objWMIService.ExecQuery( _
    "SELECT * FROM CIM_DataFile",,48) 
For Each objItem in colItems 
    Wscript.Echo "-----------------------------------"
    Wscript.Echo "CIM_DataFile instance"
    Wscript.Echo "-----------------------------------"
    Wscript.Echo "AccessMask: " & objItem.AccessMask
    Wscript.Echo "Archive: " & objItem.Archive
    Wscript.Echo "LastAccessed: " & objItem.LastAccessed
    Wscript.Echo "LastModified: " & objItem.LastModified
    Wscript.Echo "Manufacturer: " & objItem.Manufacturer
    Wscript.Echo "Name: " & objItem.Name
    Wscript.Echo "Path: " & objItem.Path
    Wscript.Echo "Readable: " & objItem.Readable
    Wscript.Echo "Status: " & objItem.Status
    Wscript.Echo "System: " & objItem.System
    Wscript.Echo "Version: " & objItem.Version
    Wscript.Echo "Writeable: " & objItem.Writeable
Next 
```

**编辑**

此示例是您正在查找[Enumerating All the Files on a Computer](http://www.microsoft.com/technet/scriptcenter/guide/sas_fil_fjqz.mspx?mfr=true)。

尝试这种查询格式：

```
Select * From Win32_Directory Where FileName = 'Scripts' 
```

这里有更多关于[使用 LIKE 进行查询 WQL](http://www.microsoft.com/technet/scriptcenter/topics/win2003/like.mspx)的信息。
也试试这个：[Scriptomatic 2.0](http://www.microsoft.com/en-us/download/details.aspx?id=12028)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:39:37.603

我已经得到了答案，这一切都是由我的一个愚蠢的错误引起的：我没有在路径字符串中加倍反斜杠，并认为它正在完成。此外，您必须在 WHERE 子句中指定所有四个字段：驱动器、路径、文件名和扩展名。

# wpf - WPF中的“捕获鼠标”是什么意思？

> ID：942357
> 
> 赞同：76
> 
> 时间：2009-06-02T23:04:41.677
> 
> 标签：wpf, events, mouse

上面`System.Windows.UIElement`有一个`CaptureMouse()`和一个配对的`ReleaseMouseCapture()`方法。在这个[WPF DragDrop](http://msdn.microsoft.com/en-us/library/bb295243.aspx)示例中，他们在 MouseDown 上调用 CaptureMouse 并在 MouseUp 上释放它。[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.uielement.capturemouse.aspx)中的文档几乎毫无用处——“CaptureMouse -> Captures the mouse”。

在我尝试之前，我认为它以某种方式将鼠标锁定在 UIElement 范围内，但是当我尝试它时显​​然不是这种情况。从实验来看，当鼠标在 UIElement 之外时，它似乎与响应事件有关，但不想成为[货物崇拜程序员](http://en.wikipedia.org/wiki/Cargo_cult_programming)我不想只使用它，因为示例确实如此，我想对其含义的权威描述。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-06-02T23:18:17.920

从MSDN 上[的捕获和取消捕获鼠标：](http://msdn.microsoft.com/en-us/library/ms771301.aspx)

> 当一个对象捕获鼠标时，所有与鼠标相关的事件都被视为具有鼠标捕获的对象执行该事件，即使鼠标指针位于另一个对象上也是如此。

只有捕获控件接收鼠标事件，直到释放。

捕获鼠标对于拖动很有用，因为所有拖动代码都可以存在于一个控件中，而不是分布在多个控件中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-02T23:19:38.573

当它捕获鼠标时，即使鼠标指针不再位于其边界区域内，控件也会接收鼠标事件。

通常，它用于：

*   拖放
*   按钮（当您将鼠标放在按钮上并在释放按钮之前移动鼠标时处理 Mouse Up）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T23:18:48.793

[Silverlight 2 文档](http://msdn.microsoft.com/en-us/library/system.windows.uielement.capturemouse(VS.95).aspx)对它有更详细的描述，我不知道为什么它也不是 3.5 文档页面的一部分：

> 当一个对象捕捉到鼠标时，无论鼠标指针是否在其边界区域内，该对象都会接收鼠标输入。鼠标通常仅在模拟拖动操作期间被捕获。
> ...

它与 WPF 的工作方式相同，因此它与 DragDrop 一起使用的原因是，当鼠标可能位于该控件之外时，它知道如何报告回被拖动的控件。如果您注释掉 MyCanvas.Capture() 和 Capture(Null) （清除它），那么您将无法再删除。

# c# - 如何从路径中获取文件名？

> ID：942358
> 
> 赞同：3
> 
> 时间：2009-06-02T23:04:43.737
> 
> 标签：c#, regex

我需要一些正则表达式专家来帮忙。:)

我有不同的路径，不同的文件夹，不同数量的文件夹。

我的问题：我如何得到最后一件事 - 文件名？

例如在路径中：

C:\a\b\c\d\e\fgh.ddj

如何使用正则表达式获得“fgh.ddj”？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-02T23:05:34.077

你不需要正则表达式，你可以这样做，它是一个 system.io 辅助函数：

```
myfilename = Path.GetFileName(mypath); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T00:54:47.400

您也可以使用 FileInfo。使用 FileInfo 时，文件是否存在实际上并不重要。

```
var fileInfo = new FileInfo("C:\a\b\c\d\e\fgh.ddj");
var fileName = fileInfo.Name;
//this returns "fgh.ddj" 
```

如果文件存在，当然有很多关于文件大小、上次访问等的信息。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-06-02T23:32:04.307

如果你安装了 perl，那么你可以尝试这样的事情......

```
#!/usr/bin/perl

use strict;

my $fullname = 'C:\a\b\c\d\e\fgh.ddj';
my $file = (split /\\/, $fullname)[-1];
print $file; 
```

# language-agnostic - 什么是语言 X 的好的网络图库？

> ID：942361
> 
> 赞同：42
> 
> 时间：2009-06-02T23:05:44.123
> 
> 标签：language-agnostic, graph, graph-theory

我注意到一个反复出现的问题是：“对于语言 X，什么是好的网络图库”。我玩过很多图书馆，我可以和你分享我的经验。

**Python**： [NetworkX](https://networkx.org)是一个强大的库，它具有内置的可视化功能，但也有一个使用[pyGraphviz的](https://pygraphviz.github.io)[Graphviz](http://www.graphviz.org)接口。（pyGraphviz 和 NetworkX 由同一作者编写）。NetworkX 是开源的并且非常易于使用。

**Perl**： [Circos](http://mkweb.bcgsc.ca/circos/)被开发用于可视化基因组和其他高度复杂的数据集。它总是使用圆形布局，但如果您的网络非常大并且它的“模块化”分数很低，它通常是最合适的布局。Circos 是开源的。

. **Net**： [NodeXL](http://www.codeplex.com/NodeXL)由 Microsoft Research 开发，既是 Excel 的附加组件，又是 .Net 3.5 库。它非常开放（对于 Microsoft 的标准）并使用 Fruchterman-Reingold 算法进行可视化。

**Java** : [JUNG2](http://jung.sourceforge.net)最近发布，也是一个健壮的库。具有扩展的可视化和关键指标支持。JUNG2 是开源的。

**UbiGraph**： [UbiGraph](http://ubietylab.net/ubigraph/)具有与不同语言的接口，包括 Python（NetworkX 支持 UbiGraph）、Ruby、PHP、Java、C、C++、C#、Haskell 和 OCaml。它使用 XML-RPC 服务器对网络图进行了非常简洁的 3D 可视化。基础版免费，专业版付费。

**独立：** 您始终可以使用现成的软件包，例如：[Graphviz](http://www.graphviz.org)（Win、Linux、OSX） 、 [Pajek](http://vlado.fmf.uni-lj.si/pub/networks/pajek/) （Win ）、[UCINET](http://www.analytictech.com/downloaduc6.htm)（Win），甚至 Visio（Win）。

我相信还有更多的包，但这些是我自己用过的。还有哪些可用的库或包？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-03-24T16:15:12.060

您应该将[graph-tool](http://graph-tool.skewed.de)添加到 python 列表中。它非常完整，并且使用 C++ 实现，带有 Boost Graph Library，使其比仅 Python 的替代方案（例如 NetworkX）快几个数量级。

免责声明：我是图形工具的作者。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-06T22:18:15.320

[斯坦福网络分析项目](http://snap.stanford.edu/)(SNAP) 是用 C++ 编写的，并在设计时考虑到了分析大型数据集的性能。该项目已使用 Python 库进行了扩展，并且具有全面的文档。

另请注意，该项目是来自各种领域的[经验数据集的良好资源。](http://snap.stanford.edu/data/index.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-19T13:38:46.990

对于**Clojure**，有[loom](https://github.com/aysylu/loom)。它的 WIP 但看起来不错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T01:47:14.737

在 Java 中，prefuse 是迄今为止最好的图形绘制包。它具有非常快速的力导向布局算法，并且由于您可以实时调整参数并拖动节点以使图形看起来像您想要的那样，您将能够探索和排列比任何更大的图形非交互系统。

试试这个[演示小程序](http://prefuse.org/gallery/graphview/)，你也会爱上它……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T01:42:27.740

如果您喜欢[此页面](http://www.research.att.com/~yifanhu/GALLERY/GRAPHS/index.html)上的示例，请查看 Mathematica 的[绘图](http://reference.wolfram.com/mathematica/tutorial/GraphDrawing.html)功能。画廊页面的作者 Yifan Hu 曾在 Wolfram Research 工作，在那里他为巨大的图形开发了图形绘制算法。这些算法现在已集成到 Mathematica 中。根据您打算如何使用图表，您可以通过使用 Mathematica 分析图表而获得巨大的好处；例如看这篇[博文](http://blog.wolfram.com/2007/08/05/the-equations-of-the-bridge/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-05T07:47:05.523

[yFiles](http://www.yworks.com/yfiles)是一套布局算法，可提供最广泛的不同自动复杂布局样式。它是一种商业产品，可用于多种流行平台和语言：Javascript、Java、C# 等。

有一个[交互式在线演示展示了许多可用的算法](http://live.yworks.com/demobrowser/#Layout-Styles)，并且可以免费评估这些库。

^(免责声明：我为创建这些库的公司工作，但是我不代表我的雇主。这个建议是基于我自己的意见。在过去的 15 年中，我已经看到了上述语言的许多不同的布局套件实现，我不知道有任何其他可用的实现与这个一样完整和可扩展。)

# database-administration - 易于使用的数据库编辑工具。易于修改，如 django admin

> ID：942363
> 
> 赞同：0
> 
> 时间：2009-06-02T23:06:40.877
> 
> 标签：database-administration

有没有一种工具可以让少数人访问，以便他们可以快速修改我们数据库的内容？我正在寻找易于使用和通用的东西。

phppgadmin 对于某些将要使用它的人来说太复杂了。我真的很喜欢 django admin，但是 Django 带来的一些限制是不可接受的。功能相似的东西会很棒，我真的很喜欢它的工作原理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:55:27.253

你试过使用开放式办公室吗？您可以在此处获取 postgresql 驱动程序：http: [//dba.openoffice.org/drivers/postgresql/index.html](http://dba.openoffice.org/drivers/postgresql/index.html)

您可以为任何人创建一个快速表单来添加/删除查询数据库真的很容易。

它是免费启动的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T23:18:10.980

我真的很喜欢 EMS 的工具：[http ://www.sqlmanager.net/](http://www.sqlmanager.net/)

它们适用于各种 RDBMS，但对于您的预期用例而言，它们可能过于复杂。

您确实需要说明您的平台和实际预期用途（例如，为什么 Django admin 不可接受？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-23T16:13:07.130

你可以看看[squirrel-sql](http://squirrel-sql.sourceforge.net/)。

# ruby-on-rails - 如何更改 TinyMCE ruby 插件的格式下拉框？

> ID：942369
> 
> 赞同：3
> 
> 时间：2009-06-02T23:08:12.310
> 
> 标签：ruby-on-rails, tinymce, ruby-on-rails-plugins

我只想允许 h2 和 h3，但我不确定如何通过添加“格式选择”按钮来编辑下拉列表中的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T14:53:18.703

在你的小 mce 初始化文件中

```
tinyMCE.init({
    ...
    theme_advanced_blockformats : "h2,h3"
}); 
```

[文档](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration)

# nhibernate - Fluent Nhibernate 和 Nhibernate 2.1.0.1003

> ID：942376
> 
> 赞同：1
> 
> 时间：2009-06-02T23:10:30.463
> 
> 标签：nhibernate, fluent-nhibernate

我在尝试升级 Fluent NHibernate 使用的 nhibernate 库时遇到了一些挫折。

我也在使用 Nhibernate.Linq 并且我想使用 NHibernate.Validator，特别是 ValidationDef 类。

现在 Nhibernate.Validator 可以使用 Nhibernate 2.1.0.1003，当我尝试针对这个版本构建 FluentNhibernate 时，它​​会出现一些测试错误。

它与 SessionFactory 配置和新的 Nhibernate.ByteCode.Castle 库有关。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T00:11:13.540

我不认为 FNH“正式”支持 NHibernate 2.1，并且可能直到它实际发布之后才会支持。但是，我的理解是可以让它工作。看看这个关于 FNH 组的[帖子是否有帮助。](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/bbe26da6967cc247/41cb324f31ebc879?lnk=gst&q=nhibernate+2.1#41cb324f31ebc879)

# tapestry - 你会如何推荐我在 Tapestry 4 中扩展 Insert 类？

> ID：942388
> 
> 赞同：2
> 
> 时间：2009-06-02T23:16:33.777
> 
> 标签：tapestry

我没有太多 Tapestry 经验，所以我真的不知道从哪里开始。

我需要使用一个新组件来扩展 Insert 组件，比如 NewInsert，它将给定的 CSS 类应用于正在插入的内容。我该怎么做？

我基本上想以生成类似`<span class="myClass">The value</span>`.

为什么要通过扩展插入来做到这一点？因为应用程序已经完成了很多，但我们意识到在使用 Insert 的任何地方都需要这个 CSS 类。我们将在所有文件中使用 'type="NewInsert">' 对 'type="Insert">' 进行全局替换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T14:42:16.220

为了实现我想要的，我必须重写 Insert 的`renderComponent`方法。这只是因为 Tapestry 4.0.2 没有`setStyleClass`方法。它看起来基本上像

```
 if (!cycle.isRewinding()) {
      Object value = getValue();

      if (value != null) {
        String styleClass;
        String insert = null;
        Format format = getFormat();

        if (format == null) {
          insert = value.toString();
        }
        else {
          insert = format.format(value);
        }

        styleClass = getStyleClass();

        if (styleClass == null) {
          /* No classes specified */
          styleClass = MY_CLASS;
        }
        else {
          /* Append the preserveWhiteSpace class to the string listing the style classes. */
          styleClass += " " + MY_CLASS;
        }

        if (styleClass != null) {
          writer.begin("span");
          writer.attribute("class", styleClass);

          renderInformalParameters(writer, cycle);
        }

        writer.print(insert, getRaw());

        if (styleClass != null) {
          /* </span> */
          writer.end();
        }
      }
    }
  } 
```

如果我们有一个 setStyleClass 方法，我们就可以完成

```
setStyleClass(MY_CLASS);
super.renderComponent; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T18:00:14.400

为什么要覆盖插入？为什么不创建自己的 InsertSpan 组件？只需查看 Insert 的源代码，您就会发现它是多么简单……随意剪切和粘贴，它是开源的。

更好的是，考虑升级到 Tapestry 5；Tapestry 4 的东西在大约四年内没有得到积极开发。

# .net - OnValidate() 和 LINQ to Entity

> ID：942390
> 
> 赞同：1
> 
> 时间：2009-06-02T23:18:11.727
> 
> 标签：.net, linq-to-sql, linq-to-entities, partial-classes

我想实现一些业务规则验证，就像 Scott Guthrie 在他的 MVC Nerddinner 教程 ( [http://nerddinnerbook.s3.amazonaws.com/Part3.htm](http://nerddinnerbook.s3.amazonaws.com/Part3.htm) ) 中所做的那样，但我在尝试这样做时遇到了问题。

Scott 在他的教程中使用了 Linq to SQL。他为他的数据对象创建了部分类，然后他实现了一个名为 OnValidate() 的部分方法，据他说，这是一个挂钩，当数据被持久保存到给定数据对象的数据库时，就会运行该挂钩。

```
public partial class Dinner {

  partial void OnValidate(ChangeAction action) {

    if (!IsValid)
      throw new ApplicationException("Rule violations prevent saving");
    }

} 
```

我的问题是我正在使用 Linq to Entities 并且显然没有像上面那个可以使用的“钩子”方法，或者至少我找不到它，如果有的话。谁能告诉我如何使用 Linq to Entities 来做这件事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T21:57:40.620

您可以在 linq-to-entities 中进行数据验证，但正如您所发现的，它与 linq-to-sql 不同。请参阅以下链接：

[linq-to-entities 中的数据验证](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=46)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T23:27:52.737

查看：

*   [数据注释](http://www.asp.net/Learn/mvc/tutorial-39-vb.aspx)
*   [变化的事件](http://msdn.microsoft.com/en-us/library/bb629301.aspx)
*   自定义 T4 模板

# debugging - user.dmp 是否仅包含最近的崩溃

> ID：942396
> 
> 赞同：0
> 
> 时间：2009-06-02T23:19:43.457
> 
> 标签：debugging, visual-c++, windbg, drwatson, dr.watson

我想知道由 drwtsn32 创建的“user.dmp”是否只有最近的崩溃。我试图捕捉一些崩溃。但是当我试图分析它时，我只看到了一次崩溃。

感谢您的帮助，阿伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:27:43.800

是的。我建议将 WinDbg 设置为默认的事后调试器。你可以从那里保存你的转储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T23:31:56.363

只有一个故障转储，尽管日志文件可能包含有关先前崩溃的信息。运行 drwtsn32.exe（不带任何参数）以打开配置对话框。

# winforms - Winform App 中的控制台 UI

> ID：942397
> 
> 赞同：1
> 
> 时间：2009-06-02T23:20:44.610
> 
> 标签：winforms, command-line, user-interface

我们有一个在 UNIX 上运行的遗留应用程序。我们的 windows 用户通过终端应用程序或命令提示符登录到应用程序。该应用程序看起来像是在 dos 模式界面中运行的那些汽车经销商之类的应用程序之一。

我正在为应用程序创建一个新的 winform 界面，但仍希望将旧应用程序保持在线一段时间，但是我不希望用户打开命令提示符，而是从我的 winform 中访问应用程序。是否有一个用户控件可以放在 winform 上以进行命令提示符访问？

> 解决方案 ~ 最终使用 Rebex.net 的控件，快速集成且易于使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T23:52:21.223

[请参阅Jeffrey](http://www.rootsilver.com/2007/08/how-to-create-a-consolewindow)的这篇博文
使用他的代码，您甚至可以从 Windows 窗体应用程序写入控制台窗口。

注意
我不建议这样做。Windows 应用程序应该使用 Windows 作为 GUI 而不是控制台窗口...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T23:51:24.377

我一直在关注这个。看起来很有希望。

[http://www.codeproject.com/KB/IP/Terminal_Control_Project.aspx?fid=469468&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2857639](http://www.codeproject.com/KB/IP/Terminal_Control_Project.aspx?fid=469468&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2857639)

# c++ - 如何将 clog 的 rdbuf() 重新定义为 clog 的原始 rdbuf() 和日志文件的 tee？

> ID：942399
> 
> 赞同：1
> 
> 时间：2009-06-02T23:21:36.400
> 
> 标签：c++, stream, tee, clog

有没有人有一个如何重新定义 C++ 内置 clog 的例子，而不是有一个新的关联 rdbuf()，它被处理为原始 clog.rdbuf() 的 tee 和 ofstream 对象的 rdbuf() 到日志磁盘上的文件。

目的是让代码在整个过程中使用 std::clog，但让它同时进入默认的 clog 目标以及磁盘上的日志文件。

谢谢。

-威廉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-14T21:26:06.617

您将不得不编写一个自定义的 streambuf 派生类。让它向你的 ofstream 的 rdbuf 和你原来的阻塞 rdbuf 吐出数据。

编写自定义 streambuf 的一般示例：

[http://www.dreamincode.net/code/snippet2499.htm](http://www.dreamincode.net/code/snippet2499.htm)

可以按如下方式存储新的流缓冲区：

```
// grab buffer for clog
std::streambuf* oldClogBuf = std::clog.rdbuf();

// create custom buffer which feeds both clog and an ofstream
CustomBuffer* customBuf = new CustomBuffer( oldClogBuf );

// stash custom buffer
std::clog.rdbuf( customBuf );

...do stuff...

// restore original clog buffer
std::clog.rdbuf( oldClogBuf ); 
```

您可以通过使用 RAII 习惯用法来管理缓冲区切换，从而使整个事情变得更加健壮。

# sql - VBScript SQL 清理

> ID：942400
> 
> 赞同：2
> 
> 时间：2009-06-02T23:21:43.250
> 
> 标签：sql, vbscript, sanitization

警惕 Jeff Atwood 的“[代码浴室墙](http://www.codinghorror.com/blog/archives/001268.html)”帖子，我认为为 VBScript 提供一个值得信赖的 SQL 清理功能会很有用，类似于 PHP 的`mysql_real_escape_string()`功能。

那么，如何使用 VBScript 正确清理数据输入到 SQL 查询中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T23:35:43.953

不要这样做。请改用参数化查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T04:06:58.127

或者，使用 Escape 功能如下

```
wscript.echo Escape(chrw(1023) & vbtab & vbnewline & " ") 
```

这使

```
%u03FF%09%0D%0A%20 
```

. 反过来是 UnEscape()

# subsonic - 从 SubSonic 调用标量函数

> ID：942403
> 
> 赞同：3
> 
> 时间：2009-06-02T23:22:23.717
> 
> 标签：subsonic, user-defined-functions

我有一个 SQL Server 函数，它返回一个标量 BIT 值并采用一个参数。下面给你一个思路：

```
CREATE FUNCTION dbo.[fnTest] (@StringToTest VARCHAR(10)) 
RETURNS BIT 
AS
BEGIN 
    DECLARE @b BIT 
    IF @StringToTest = 'A' SET @b = 0 ELSE SET @b = 1
    RETURN (@b) 
END
GO 
```

对 SubSonic 来说非常新（几天！） - 我如何使用 SubSonic 来称呼它？

（我正在使用一个带有星号的基本“subsonic.abp”文件的网站）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:33:56.190

知道了！

这是VB中的方法：

```
Return New SubSonic.InlineQuery().ExecuteScalar(Of Boolean)("SELECT dbo.[fnTest](@StringToTest)", StringToTest) 
```

谢谢大家，希望这对其他人有帮助，

托马斯

# java - Java 相当于 Ruby 的 __FILE__？

> ID：942412
> 
> 赞同：0
> 
> 时间：2009-06-02T23:26:29.370
> 
> 标签：java, ruby

在 Ruby 中，我经常使用`File.dirname(__FILE__)`打开配置文件等。对于那些不了解 Ruby 的人，这将给出调用它的文件在文件系统上的位置。这允许我将库与数据和配置文件打包，并使用相对路径打开这些文件。

Java 相当于什么？如果有一个数据文件我想用 jar 打包，我将如何从 jar 中的 Java 代码打开数据文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T23:32:01.467

Java 中的等效 API 是[`getResourceAsStream`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String)). 这将打开一个流，指向存储在 JAR 中的文件，该文件相对于调用它的类。

有一些变体，例如[`getResource`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Class.html#getResource(java.lang.String))返回 URL 的变体，或者`ClassLoader`在 JAR 文件中使用绝对路径的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T23:29:08.430

请参阅[Java 应用程序和“当前目录”](http://www.devx.com/tips/Tip/13804)：

> 在 Java 中，您使用 File 对象来构造文件系统的相对视图。File 对象的两个构造函数采用“parent”参数，该参数指定一个父路径，该路径以文件本身的路径为前缀，以创建文件的完整抽象路径。您所做的是，使用代表当前目录的路径创建一个 File 对象，然后使用该 File 对象作为父对象创建所有文件对象。瞧，当前目录。

我还建议[阅读和编写属性文件](http://www.exampledepot.com/egs/java.util/Props.html)：

```
// Read properties file.
Properties properties = new Properties();
try {
    properties.load(new FileInputStream("filename.properties"));
} catch (IOException e) {
}

// Write properties file.
try {
    properties.store(new FileOutputStream("filename.properties"), null);
} catch (IOException e) {
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:33:47.577

我投票给@andrew，但我想指出的是，在Java 中，文件本身的目录几乎没有意义，除了一些高度反射（并且很可能是错误的）目的。

它将位于基于包结构的目录中，并且可以位于 jar 中或几乎任何地方。

Java 少了一些临时性，允许使用更少的捷径，但通常会提高部署时的一致性和可靠性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T23:39:15.883

如果您只指定文件名，JVM 将在您的应用程序启动的同一目录中查找该文件（不一定是您的应用程序所在的同一目录）。

# c++ - 无限循环是不是很糟糕？

> ID：942421
> 
> 赞同：7
> 
> 时间：2009-06-02T23:31:32.293
> 
> 标签：c++, language-agnostic, coding-style, infinite-loop

所以我有一些 C++ 代码用于 BFS 算法中的回溯节点。它看起来有点像这样：

```
typedef std::map<int> MapType;
bool IsValuePresent(const MapType& myMap, int beginVal, int searchVal)
{
    int current_val = beginVal;
    while (true)
    {
        if (current_val == searchVal)
            return true;

        MapType::iterator it = myMap.find(current_val);
        assert(current_val != myMap.end());
        if (current_val == it->second) // end of the line
            return false;
        current_val = it->second;
    }
} 
```

然而，这`while (true)`似乎……对我来说很可疑。我知道这段代码有效，从逻辑上讲我知道它应该有效。但是，我无法摆脱在 中应该有一些条件的感觉`while`，但实际上唯一可能的就是使用一个`bool`变量来说明它是否完成。我应该停止担心吗？还是这真的很糟糕。

**编辑**：感谢大家注意到有办法解决这个问题。但是，我仍然想知道是否还有其他有效案例。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-02T23:36:15.653

我相信在某些情况下，看似无限循环的存在是可以的。然而，这似乎不是其中之一。看起来你可以像下面这样轻松地编写代码

```
while (current_val != searchVal ) {
    MapType::iterator it = myMap.find(current_val);
    assert(current_val != myMap.end());
    if (current_val == it->second) // end of the line
        return false;
    current_val = it->second
}
return true; 
```

这似乎更好地表达了循环的真正意图

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-03T00:00:45.073

我的两分钱是：代码应该是[自我记录的](http://en.wikipedia.org/wiki/Self-documenting)。也就是说，当给定一段代码时，我宁愿能够查看并告诉程序员的意图，然后必须阅读注释或在周围的代码中跋涉。当我读到：

```
while(true) 
```

这告诉我程序员想要一个无限循环；无法指定结束条件。这是程序员在某些情况下的意图；例如，服务器循环，这就是应该使用它的时候。

在上面的代码中，循环并不意味着永远存在，它有一个明确的结束条件，并且为了在语义上清晰，正如其他人指出的那样：

```
while (currentVal != searchVal) 
```

有效，因此 while(true) 显然较差，在这种情况下应避免使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T23:36:50.800

有无限循环的时间和地点——我不相信这是其中之一。另一方面，这远不是一个严重的问题。

```
while (currentVal != searchVal)
{
    ...
}
return true; 
```

使用它们的一个地方是当进程真正不确定时 - 一个带有不会终止的监视器循环的守护进程。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T23:39:00.970

在某些情况下，这样的构造是有意义的：

1.  中断条件在循环内计算
2.  有更多的断裂条件，它们都同样重要
3.  你真的想要一个无限循环；）..

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-03T00:27:52.213

我同意其他答案，即在这种情况下不需要无限循环。

但是，另一点可能是，当您*确实*有无限循环时，`for(;;)`可能是一种更好的表达方式。一些编译器会为`while(true)`（条件总是评估为假）生成警告，并且您的意图不太清楚，因为它看起来像任何其他循环。也许它曾经说过`while (x == true)`，而你不小心删除了`x`而不是`true`。`for(;;)`非常清楚地表明这是一个无限循环。或者您可能打算编写类似的东西`while(t)`，但您的 IDE 中的 Intellisense 启动并决定自动完成到`true`.

`for(;;)`另一方面，这不是您偶然输入的内容。（而且更容易搜索。while(true) 也可以写成 while(1)）

两个版本都没有*错*，但`for(;;)`可能更直观，因为*没有*循环条件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-03T00:10:46.007

`while(true)`在游戏中用于主游戏循环 - 游戏不断读取玩家输入，处理对象之间的交互并绘制屏幕，​​然后重复。这个循环无限地继续，直到其他一些动作打破这个循环（退出游戏，完成关卡）。

我试图在 Quake 1 源代码中为您快速找到这个主循环，但至少出现了 50 次“ `while(1)`”，还有一些写为“ `for(;;)`”，我不确定哪个是主游戏环形。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T23:57:10.183

虽然我以前做过，但我会投票赞成总是尝试通过使用可读的东西来寻求更清晰的解决方案，这通常会在 while 循环中包含一个有效的表达式——否则你正在扫描代码以寻找中断.

我并不真的害怕他们或任何东西，但我知道有些人是。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T23:33:43.990

好吧，说它不是真正的无限循环的评论会有所帮助：

```
 while (true) // Not really an infinite loop! Guaranteed to return. 
```

我确实同意它应该有一个条件，但在某些情况下这是可以的（而且并不总是可能或容易做出条件）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T23:40:21.637

别担心了。如果它有助于简化代码的逻辑并提高可维护性和可读性，那么这种形式还不错。值得在评论中记录预期的退出条件以及算法为什么不会陷入无限循环。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T23:44:56.993

嗯，*是*的，但是如果你不希望你的主循环是这样的，你必须编写的两页代码`while(true)`是更*糟糕*的形式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-03T00:33:58.080

在嵌入式系统代码中发现无限循环并不少见——通常围绕有限状态机、检查外围芯片和设备等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-01T17:54:25.487

我喜欢无限循环作为有限状态机的外部控制结构。它实际上是一个结构化的 goto：

```
for (;;) {
    int c = ReadInput();
    if (c == EOF)
        return kEOF;

    switch (state) {
    case inNumber: state = HandleNumber(c); break;
    case inToken: state = HandleToken(c); break;
    case inWhiteSpace: state = HandleWhiteSpace(c);
    default:
       state = inError;
       break;
    }
    if (state == inError) ThrowError(); 
```

}

# php - 如何使 PHP 文件只能通过 CLI 模式运行？

> ID：942435
> 
> 赞同：15
> 
> 时间：2009-06-02T23:37:10.893
> 
> 标签：php, command-line-interface

它可用于浏览器，

但我不希望它在用户浏览时执行，

说，浏览时应该退出，

有没有办法检测它当前是否是命令行模式？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-02T23:39:54.773

看：

*   [确定 PHP 脚本的命令行与 http 执行的规范方法是什么？](https://stackoverflow.com/questions/173851/what-is-the-canonical-way-to-determine-commandline-vs-http-execution-of-a-php-s)
*   [有什么方法可以知道 php 脚本是否在 cli 模式下运行？](https://stackoverflow.com/questions/607373/is-there-any-way-to-know-if-a-php-script-is-running-in-cli-mode)
*   [PHP - 确定当前调用是来自 CLI 还是浏览器的最佳和简单方法是什么](https://stackoverflow.com/questions/933367/php-what-is-the-best-easy-way-to-determine-if-the-current-invocation-is-from-c)

短篇小说：[`php_sapi_name()`](http://www.php.net/manual/en/function.php-sapi-name.php)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-18T20:30:01.277

这是我正在使用的，很长一段时间以来......（从 php 4 iirc 开始）

```
(PHP_SAPI !== 'cli' || isset($_SERVER['HTTP_USER_AGENT'])) && die('cli only'); 
```

用作 php 脚本的第一行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T00:05:14.800

另一个技巧，`$_SERVER`只有在 CLI 模式下设置的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T23:51:34.750

这是一个技巧：

您可以检查在 CLI 模式下始终可用的 $argc/$argv 参数。

```
#!/usr/bin/php
<?php 

ini_set('register_argc_argv', 0);  

if (!isset($argc) || is_null($argc))
{ 
    echo 'Not CLI mode';
} else {
    echo 'CLI mode';
} 
```

[register_argc_argv](http://fr2.php.net/manual/en/ini.core.php#ini.register-argc-argv)

[$argc](http://fr2.php.net/manual/en/reserved.variables.argc.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-14T11:47:44.547

```
if (!defined('STDIN')) {
    // accessed through the web browser
    die();
} 
```

我在创建 PHP CLI 脚本时使用它。效果很好。

# linq - LINQ to SQL - 如何处理对数据库的更改

> ID：942436
> 
> 赞同：0
> 
> 时间：2009-06-02T23:37:34.310
> 
> 标签：linq, linq-to-sql

我对 LINQ to SQL 相当陌生，所以我可能会在这里遗漏一些基本的东西。

我创建了一个 LINQ to SQL 层，生成了所有 dbml 文件等，并创建了一个运行良好的 LINQ 查询。然后我对数据库进行了更改，并希望将该更改反映在 ORM 层中。为此，我删除了我的 ORM 层并创建了一个新层（可能不是最好的方法？）。

现在我的代码无法在智能感知中看到 datacontext 对象并且无法编译。我想这可能很简单，但我也想了解如何在数据库更改时更新 LINQ to SQL ORM 层的更大图景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T23:43:57.790

是的，您不想删除整个 DBML 文件。在设计器中打开它，然后删除更改的表。然后从“服务器资源管理器”（在视图菜单中）再次拖放它。这将加载数据库的更新副本...请注意，如果在更改 SQL 模式时服务器资源管理器已经打开，则需要刷新服务器资源管理器以使其具有最新版本。

这种方法的缺点是，如果您对 DBML 中的表进行自定义，则需要重做。这对我来说是罕见的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T23:40:57.953

我记得有很多这个问题。修复很简单，真的。重建您的解决方案！DataContext 和其他此类类是在构建期间生成的。

相当头疼 - 我希望 DBML 工具在您关闭它时为您执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T00:09:47.600

您还可以使用[SQLMetal](http://msdn.microsoft.com/en-us/library/bb386987.aspx)来更新您的 DBML 类。有些人甚至编写脚本或批处理文件来自动化该过程。

# perl - 更改地图返回的上下文？

> ID：942437
> 
> 赞同：2
> 
> 时间：2009-06-02T23:38:12.513
> 
> 标签：perl

我正在尝试将 JSON 字符串解析为数组引用：

```
my $str = '[[2],[1]]';
my $data = map { $_->[0] } @{decode_json( $str )}; 
```

但这使它成为一个标量。我可以：

```
my $str = '[[2],[1]]';
my @data = map { $_->[0] } @{decode_json( $str )};
my $data = \@data; 
```

但它没有我喜欢的那么短。有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T23:44:03.393

怎么样：

```
my $str = '[[2],[1]]';
my $data = [map {$_->[0]} @{decode_json($str)}]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T23:38:44.527

使用中间变量：

```
my $str = '[[2],[1]]';
my @data = map { $_->[0] } @{decode_json( $str )};
my $data = \@data; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:27:25.110

由于 OP 询问哪种方法的开销更大，这是我用来比较两者的快速配置文件。随意编辑条目以改进测量：

```
#!/usr/bin/perl -w
use strict;
use Benchmark qw(cmpthese);

sub count(\$$) {
    ${$_[0]} += @{$_[1]};
}

sub a() {
    count($a, [map {$_ + 1} 1..1000000]);
}

sub b() {
    my @d = map {$_ + 1} 1..1000000;
    count($b, \@d);
}

cmpthese(-10, {a => \&a, b => \&b}); 
```

# delphi - Delphi 2009：使用 TIdHttpWebBrokerBridge 时出现“XML 文档必须有顶级元素”错误

> ID：942448
> 
> 赞同：0
> 
> 时间：2009-06-02T23:41:17.453
> 
> 标签：delphi, delphi-2009

我们有一个使用 HttpWebBrokerBridge 的应用程序，它在 Delphi2006 中运行良好，但是当我使用 Delphi2009 重新编译时，我收到 EDOMParserError 异常，并显示消息“XML 文档必须具有顶级元素”。

对于导致此错误的原因，我没有任何线索。

关于我应该做什么的任何线索？

桑迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T02:36:37.917

请参阅[如何使用 Delphi 构建独立的 SOAP Web 服务？](https://stackoverflow.com/questions/846207/how-to-build-stand-alone-soap-web-services-using-delphi/846210)

尤其是，

> [Indy 10 和 IdHTTPWebBrokerBridge 中的人们使用 CBuilder 2009](https://forums.embarcadero.com/thread.jspa?messageID=63725)发布了修改版本。例如， [IdHTTPWebBrokerBridge.pas](https://forums.embarcadero.com/servlet/JiveServlet/download/2-9780-66171-751/IdHTTPWebBrokerBridge.pas)由 Jochanan van der Niet 编写。

根据[罗伯特·皮特克](http://threads.embarcadero.com/threads/threads.exe/view?commentid=41840)的说法，

> 我将 Delphi 2009 与 Indy 10 一起使用，并稍微修改了 IdHTTPWebBrokerBridge.pas。看起来问题出在 TIdHTTPAppRequest.GetStringVariable 函数中，其中 Content 属性填充了 FRequestInfo.UnparsedParams。当它收到一个 POST 命令时，它是空的。我已经调试了代码并看到内容在 FRequestInfo.PostStream 中。
> 
> 当 FRequestInfo.CommandType 为 hcPOST 时，尝试将 Content 属性的结果设置为 PostStream 内容。您还需要修复 ContentLength 属性的结果值。它对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:02:10.223

确保您使用的是来自 SVN 的 Tiburon 分支的 Indy 10 的最新 10.5.5 快照。不久前，对 TIdCustomHTTPServer 和 TIdHTTPWebBrokerBridge 的更改已合并到该代码库中。

# wordpress - 来自博客圈的相关帖子 - 在 wordpress 类别页面上动态集成 Google Blogsearch RSS

> ID：942450
> 
> 赞同：0
> 
> 时间：2009-06-02T23:41:50.323
> 
> 标签：wordpress, rss, categories

我正在寻找一种将来自 Google Blogsearch/Twitter 搜索提要的三个最新“新闻”放入类别页面底部的方法。也许像这样（假设我们在“体育”类别的存档页面上）：

其他人对“运动”的评价：

1.  Instapundit - 迈克尔乔丹复出！
2.  赫芬顿邮报——迈克尔乔丹复出！
3.  Crazyguy - 迈克尔乔丹复出！

所以我们都知道你可以把

```
<?php include_once(ABSPATH.WPINC.'/rss.php');
wp_rss('pathtofeed.com', 3); ?> 
```

在 a 中`template-file`，它将列出提要的最新三项。

我想将查询提要的路径放入 Google Blogsearch，例如 [ [http://blogsearch.google.com/blogsearch_feeds?hl=en&q=sport&ie=utf-8&num=10&output=rss][1]](http://blogsearch.google.com/blogsearch_feeds?hl=en&q=sport&ie=utf-8&num=10&output=rss][1])

工作正常。但我想`sport query`用类别标题的模板标签替换 —— 所以它会动态地向 Google 查询`sport searches`. 我试过这个：

```
<?php
include_once(ABSPATH.WPINC.'/rss.php');
wp_rss('www.blogsearch.google.com/blogsearch_feeds?hl=en&q=<?php single_cat_title() ?>&ie=utf-8&num=10&output=rss', 3); 
?> 
```

（省略“http”，因为我不能以新用户的身份在此处发布超链接）。

但我得到的只是：

> Feed 出现问题，请稍后重试。

（从丹麦错误信息翻译）。

是语法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:00:02.337

您在该代码中有几个问题。首先是你有`<?php`一个已经打开的`<?php`部分。串联是该问题的答案。

二是该功能默认`single_cat_title()` **显示**类别标题。意思是它“echo（）”出来了。因此，您需要告诉该函数返回值而不是显示它。

我的解决方案是在您的包含上方添加一行代码，以获取您正在寻找的类别：

```
$current_category = single_cat_title("", false); 
```

“false”告诉函数将其作为值返回而不是默认显示，第一个参数是前缀或要在类别标题之前显示的文本。

然后将 current_category 变量连接到您的包含语句中

您可以在 Wordpress Codex 的模板标签页面上查看该功能。

# mysql - JDBC prepareStatement 不起作用

> ID：942457
> 
> 赞同：0
> 
> 时间：2009-06-02T23:45:11.703
> 
> 标签：mysql, jdbc, prepared-statement

我正在尝试使用该`prepareStatement`功能。代码如下。执行后，它会返回一堆`vlicense`字符串而不是值。

当代码完成时`statement.setString()`，语句变为：

```
select 'vlicense' from Vehicle 
```

但是，它必须是：

```
select vlicense from Vehicle 
```

不带引号。谁能告诉我有什么问题？

```
statement = oConnection.prepareStatement("select ? from Vehicle");
String tempString = "vlicense";
statement.setString(1, tempString);
resultSet = statement.executeQuery(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T23:53:28.163

您不能将参数标记用于列名、表名、数据类型名或基本上不是数据的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T23:58:37.497

当您将绑定变量添加到这样的语句时，它会被转义，因此示例中的实际 SQL 字符串将作为“SELECT 'vlicense' FROM Vehicle' 进入数据库，选择文字字符串而不是您想要的列名。

在准备之前，您需要将该变量列名连接到您的 SQL 语句中：

```
statement = oConnection.prepareStatement("SELECT " + vlicense + " FROM Vehicle");
```

绑定变量实际上是用于查询参数而不是动态查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:58:02.413

这 ？不能用于指定字段，只是在查询中执行一些过滤器，例如：

```
statement = conn.prepareStatement("select field from Vehicle where name=?"); 
```

在您的情况下，您的查询构建为：

```
select 'vlicense' from Vehicle 
```

这意味着：为“车辆”的每条记录获取一个字符串“vlicense”。根据表中的记录数，您将获得*n 个重复的字符串*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T00:06:49.243

它与`jdbc`或无关。 这只是一个错误的说法。`prepared-statements``mysql`
`sql`

如果您键入：

```
Select 'justanexample' from Vehicle 
```

该表包含 4 行，您将获得 4 次

```
'justanexample'
'justanexample'
'justanexample'
'justanexample' 
```

结果。

你没有指定你的表结构，但我猜这个语句应该看起来像这样：

```
select * from Vehicle where license = ? 
```

# c# - 使用属性创建请求 IP 约束

> ID：942458
> 
> 赞同：3
> 
> 时间：2009-06-02T23:47:02.560
> 
> 标签：c#, asp.net-mvc

我想做以下（伪代码）：

```
[InternalOnly]
public ActionResult InternalMethod()
{ //magic } 
```

" `InternalOnly`" 属性用于`HttpContext`在执行任何其他操作之前应检查请求 IP 的已知值的方法。

我将如何去创建这个“ `InternalOnly`”属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T00:04:55.627

您可以创建自定义过滤器属性：

```
public class InternalOnly : FilterAttribute
{
    public void OnAuthorization (AuthorizationContext filterContext)
    {
        if (!IsIntranet (filterContext.HttpContext.Request.UserHostAddress))
        {
            throw new HttpException ((int)HttpStatusCode.Forbidden, "Access forbidden.");
        }
    }

    private bool IsIntranet (string userIP)
    {
        // match an internal IP (ex: 127.0.0.1)
        return !string.IsNullOrEmpty (userIP) && Regex.IsMatch (userIP, "^127");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T23:48:26.847

这是一个可以通过 AOP（面向方面​​编程）解决方案解决的问题的示例。对于这类事情，我通常推荐[PostSharp](http://www.postsharp.org/)。

基本上 PostSharp 允许您做的是创建属性，您可以将其用作代码中您希望插入样板代码的位置的标记。

# ruby-on-rails - 如何使 SWF 调用 Rails Ajax 请求？

> ID：942465
> 
> 赞同：0
> 
> 时间：2009-06-02T23:51:15.313
> 
> 标签：ruby-on-rails, ruby, flash, actionscript-2

我正在编写一个应用程序，该应用程序需要在向网站的下一部分显示继续按钮之前观看 flv 视频。

当前，当视频结束时，SWF 播放器向服务器发出 POST 请求，将视频标记为当前用户已观看。成功后，SWF 播放器调用 Javascript 函数... Alert('Ajax Request Here')

**选项 1：** 当视频播放完毕并成功 POST 时；SWF 播放器可以调用 javascript 方法（代替当前警报）向 RJS 文件发出 AJAX 请求，该文件将检查以确保该部分中的所有视频都已观看，如果是，则提供继续按钮。

*您能否将对 RJS 文件的 AJAX 调用封装到可以从 SWF 调用的单个 javascript 函数中？如果有怎么办？*

**选项 2：** 如果可以让 Controller 方法运行 RJS 文件，那么我可以让原始 POST 请求为当前用户运行 RJS 文件。（这似乎不太可能，因为我不确定服务器如何与浏览器通信）

*控制器方法可以调用 RJS 文件吗？如果有怎么办？*

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T14:50:49.720

嗯，只需将 Flash 帖子直接发送到 url。向 flash 传递某种带有参数的令牌，以便您可以在之后将其传递回来，以便识别谁观看了视频。

轨道在它后面的事实应该无关紧要。

# .net - 为什么不让 OnXXX 事件引发方法返回一个值？

> ID：942469
> 
> 赞同：2
> 
> 时间：2009-06-02T23:51:47.637
> 
> 标签：.net, vb.net, events

假设您有一个使用 CancelEventArgs 类引发事件的事件引发方法 (OnXXX)，让 OnXXX 方法返回 e.Cancel 的值有什么问题吗？

例如：

```
Public Sub ProcessFiles(folder as DirectoryInfo)

    For each file in folder.GetFiles()
        If OnProcessingFile(New FileEventArgs(file)) Then
            .....ProcessFileCode
        Else
            Exit For
        End If
    Next

End Sub

Protected Function OnProcessingFile(ByVal e As FileEventArgs) As Boolean

    RaiseEvent ProcessingFile(Me, e)
    Return Not e.Cancel

End Function 
```

在我看来，这是一个比这更清洁的解决方案：

```
Public Sub ProcessFiles(folder as DirectoryInfo)

    Dim e As FileEventArgs

    For each file in folder.GetFiles()

        e = New FileEventArgs(file)
        OnProcessingFile(e)

        If e.Cancel Then
            Exit For
        End If

        .....Process File Code

    Next

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T23:57:40.307

原因与.Net 中事件的实现有关。它们通常是 MulticastDelegate 类型，这意味着该事件可以有多个订阅者。因此 RaiseEvent 调用调用 N 个函数，其中 N 可以是 0、1 或 >1。让事件返回一个值仅在有 1 个订阅者的情况下按预期工作。

0的情况下，CLR应该返回什么？

在 >1 的情况下，哪个代表应该获胜？我相信当前的实施决定了最后一个代表将获胜。但是如果第一个说取消但最后一个说不取消怎么办。事件参数是当前解决这种差异的最佳方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T23:53:58.973

可能是因为事件分派器通常被实现为委托，并且处理 n 个函数的语义，每个函数都能够返回一个结果，至少可以说是 icky。

# jquery - jQuery - IE8 - fadeIn() / fadeOut() 像素移动

> ID：942474
> 
> 赞同：4
> 
> 时间：2009-06-02T23:53:58.863
> 
> 标签：jquery, fadeout

我将一个绝对定位的字典术语替换为另一个，如下所示：

jQuery('#replaceme').fadeOut(150, function() { jQuery('#withme').fadeIn(150); });

这是非常简单的代码，在除 IE8 之外的所有浏览器中看起来和运行都很好。在 IE8 中，当 fadeOut() 执行其操作时，整个文本块向上移动 2-3 个像素，然后在 fadeIn() 时向下移动 2-3 个像素。

关于可能导致这种情况的任何想法？有人知道防止这种情况发生的方法吗？

顺便说一句：我使用 jQuery 1.3.1 得到的结果与使用 1.3.2 得到的结果相同。我所有的严格 XHTML 和 CSS 都经过验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T00:05:57.390

它是否从内联元素变为内联块或块元素？

使用ie8开发者工具，尝试将元素的显示属性更改为`display:inline-block`，看看是否出现问题。

编辑：对评论的回应

可能发生的情况是元素被从预期的文档流中取出（附加到正文，或者新的父级是插入，并且附加到那个，等等）并且通常适用的 css 规则在这种情况下不适用.

使用 firebug 来识别应用于该元素的所有 css 规则，然后尝试将此元素 id #replaceme 添加到选择器列表中，以确保该元素按照您期望的方式设置样式。例如

```
dt > dd.def { } 
```

变成

```
dt > dd.def, #replaceme { } 
```

# vba - 在运行时更改 Access 表单上的字段宽度

> ID：942476
> 
> 赞同：0
> 
> 时间：2009-06-02T23:54:05.307
> 
> 标签：vba, forms, ms-access

我正在为我的 MS-Access 表单设计一个自定义布局系统。到目前为止一切顺利 - 我有这个想法！但现在出现了棘手的问题：调整各个字段的大小，使其宽度以一种有吸引力的方式匹配。

可悲的是，我有点卡在这里 - 肯定有一些函数，属性或方法调用可以让我为给定字段指定确切的宽度......但如果是这样，我一直无法找到它。

这里有人可以提供我迫切需要的信息吗？**或者更好**的是，建议一个合适的谷歌查询或参考网站，可以为我的查​​询提供答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T02:35:19.193

在代码中，在运行时，这就是你所做的：

我！MyControl.Width = 1.5 * 1440

1.5 是 1.5" 而 1440 是称为 TWIP 的东西，它们是根据屏幕分辨率和 Windows 基本字体大小确定大小的相对测量单位。

现在，你在哪里做这个？

如果您在同一个表中有不同的记录需要不同的布局，您可以在 OnCurrent 事件中进行。这样，当您从一条记录导航到另一条记录时，OnCurrent 事件将检查任何数据控制您使用的宽度并设置宽度。如果只有两种布局，最好使用 If/Then/Else。如果有两个以上，则 SELECT CASE 更好。

此外，如果您正在调整列的大小和对齐，分配模块级常量会很有帮助，就像这样（这是从我在 1997 年首次创建的应用程序中提取的，该应用程序有 15 种不同的记录类型和 3 种基本布局，其中 8 或9 个小变化）：

```
Const Height = 0.1583 * 1440
Const row1Top = 1.0208 * 1440 ' top of first row
Const row2Top = row1Top + 0.2083 * 1440
Const row3Top = row2Top + 0.2083 * 1440
Const row4Top = row3Top + 0.2083 * 1440
Const row5Top = row4Top + 0.2083 * 1440
Const row6Top = row5Top + 0.2083 * 1440
Const row7Top = row6Top + 0.2083 * 1440
Const Logic0Top = 1.6833 * 1440
Const logic1Top = Logic0Top + 0.1667 * 1440
Const logic2Top = logic1Top + 0.1667 * 1440
Const logic3Top = logic2Top + 0.1667 * 1440
Const logic4Top = logic3Top + 0.1667 * 1440
Const lblLogic0Top = Logic0Top - 0.0208 * 1440
Const lblLogic1Top = lblLogic0Top + 0.1667 * 1440
Const lblLogic2Top = lblLogic1Top + 0.1667 * 1440
Const lblLogic3Top = lblLogic2Top + 0.1667 * 1440
Const lblLogic4Top = lblLogic3Top + 0.1667 * 1440
Const DateWidth = 0.7833 * 1440
Const lWidth = 2.0167 * 1440
Const rWidth = 2.7771 * 1440
Const lMemoWidth = 4.8771 * 1440
Const commtWidth = (2.745 * 1440)
Const lCommt = 3.775 * 1440
Const CommtHeight = 1.5 * 1440
Const memoHeightOffset = 0.94 '0.8354
Const bksCommtHeight = ((memoHeightOffset + 0.5) * 1440) + 250
Const ConditionWidth = 4.2417 * 1440 - 15
Const memo3Tall = ((memoHeightOffset + 1.4146) * 1440) + 160
Const memo4Tall = ((memoHeightOffset + 1.2063) * 1440) + 160
Const memo5Tall = ((memoHeightOffset + 0.9979) * 1440) + 160
Const memo6Tall = ((memoHeightOffset + 0.7896) * 1440) + 160
Const memoShort = (1.5208 * 1440) + 160 ' Height of memo
Const lblOffset = -0.3291 ' adjusts memo label top for new layout
Const lblMemoTop3 = ((lblOffset + 1.9167) * 1440) - 480 - 100
Const lblMemoTop4 = ((lblOffset + 2.125) * 1440) - 480 - 55
Const lblMemoTop5 = ((lblOffset + 2.3333) * 1440) - 480 - 100
Const lblMemoTop6 = ((lblOffset + 2.5417) * 1440) - 480 - 100
Const lblMemoTop7 = ((lblOffset + 2.75) * 1440) - 480 - 100
Const lblBib0 = (2.5833 * 1440) - 480
Const Bib1 = 2.4674 * 1440
Const Bib2 = 2.6257 * 1440
Const Bib3 = 2.784 * 1440
Const Bib4 = 2.9424 * 1440 
```

非常复杂，因为表单非常复杂（OnCurrent 事件变得如此之大，以至于我不得不将它分成两个不同的子例程——我不记得子例程的确切最大大小，但它可能是 64K。是的，就是这样很糟糕，是的，我很遗憾以这种方式实施事情。如果我不得不重新来过，我会使用带有不可见选项卡的选项卡控件，并为每种记录类型分配一个选项卡。但我没有这样想那时。

如果您不需要垂直移动或调整大小，则可以使用一些常量：

```
Col1Left
Col2LeftA
Col2LeftB
Col1WidthA
Col1WidthB
Col2WidthA
Col2WidthB 
```

这将允许您拥有两列控件，第二列具有两个不同的水平位置，每列具有两个不同的宽度。我建议为这些常量使用非常透明的名称，以便您的代码或多或少不言自明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T02:35:36.727

通过使用 me.CtlName.PropertyName 或 Forms!CtlLName.PropertyName，可以在 VBA 代码中引用任何给定控件的所有属性。在您的情况下，这将是 me.CtlName.Width。

请注意，属性的大小以缇为单位。每英寸有 1440 缇。如果您使用的是公制，我不知道厘米有多少缇。

也就是说，除非客户另有要求，否则我会调整我的表单大小以匹配 1024x768。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T12:18:34.087

为什么要在运行时更改字段宽度？像这样的行为超出了典型的 Windows UI 约定，并且当表单显示后事情开始改变大小时，可能会通过您的用户进行循环。只需在表单显示后给字段留出较大的边距并保持大小不变​​。

对于这样的问题，想想[手套](http://thedailywtf.com/Articles/The_Complicator_0x27_s_Gloves.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T06:35:17.413

> 如何更改字段宽度[问题]

使用 SQL DDL：

```
ALTER TABLE MyTable ALTER MyField VARCHAR(20); 
```

这不会影响列的其他属性，例如，如果最初以这种方式创建，它将保持 NOT NULL 并且默认值（如果有）将相同。

PS我正在回答OP的问题，而不是有争议的编辑。

# c# - 设计师.cs的怪异

> ID：942478
> 
> 赞同：1
> 
> 时间：2009-06-02T23:54:38.567
> 
> 标签：c#, visual-studio-2008, designer

我最近检查了一个大型 C# 代码库，我将使用它进行一些工作，并将项目从 VS2005 转换为 VS2008。在构建解决方案时，我似乎生成了一堆不属于那里的 Designer.cs 文件。我现在收到类重新声明的错误。请注意，designer.cs（和相关的 resx 文件）是从纯旧的 C# 类生成的，根本不应该附加设计器。

我可以删除这些文件并解决问题，问题是我有 500 多个这些文件（来自大约 14000 个文件的代码库），所以这将是一个痛苦的过程来找出错误的文件并删除。更重要的是，我想知道为什么/如何发生这种情况。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-08T07:12:40.857

在文本编辑器中打开 .csproj 文件 - 它只是 XML，格式相对简单。应该有设计师的文件有一个额外的条目：

```
<Compile Include="MyForm.cs">
  <SubType>Form</SubType>
</Compile>
<Compile Include="MyForm.Designer.cs">
  <DependentUpon>MyForm.cs</DependentUpon>
</Compile> 
```

如果没有什么明显的创建一个新的 VS2008 项目并添加一些与您遇到问题的类型相同的虚拟类。您可以查看该新项目的 .csproj 文件作为文件应该如何显示的参考。

# c# - Refactoring advice for big switches in C#

> ID：942481
> 
> 赞同：2
> 
> 时间：2009-06-02T23:55:34.773
> 
> 标签：c#, switch-statement

I have an application in C#/Winforms that lets users place objects on a grid to create levels for a game. It has several tools for placing tiles/lights/doors/entities etc. Currently I just use an enum for storing the currently selected tool and have a switch statement to run each tools code. As I've been adding more tools to the application it's starting to get spaghetti like, with lots of duplicated code.

Here is a cutdown version of the mouse down function in my editor class:

```
 public void OnEditorViewMouseDown(Point mousePos)
    {
        // Check if the click is out of bounds.
        if (IsLocationOOB(mousePos)) return;

        if (CurrentTool == ToolType.GroundTile)
        {
            // Allow drags along whole tiles only.
            m_DragManager.DragType = DragManager.DragTypeEnum.Tile;
            m_DragManager.StartDrag(mousePos);
        }
        else if (CurrentTool == ToolType.WallTile)
        {
            // Allow drags along grid edges only.
            m_DragManager.DragType = DragManager.DragTypeEnum.Edge;
            m_DragManager.StartDrag(mousePos);
        }
        else if (CurrentTool == ToolType.PostTile)
        {
            // Allow drags along grid points only.
            m_DragManager.DragType = DragManager.DragTypeEnum.Point;
            m_DragManager.StartDrag(mousePos);
        }
        else if (CurrentTool == ToolType.AreaLight)
        {
            // Allow drags anywhere. ie. not snapped to the grid in some way.
            m_DragManager.DragType = DragManager.DragTypeEnum.FreeForm;
            m_DragManager.StartDrag(mousePos);
        }
        else if (CurrentTool == ToolType.PointLight)
        {
            m_CurrentWorld.AddLight(TranslateToWorldCoords(mousePos));
        }
        else if (CurrentTool == ToolType.PlaceEntity)
        {
            m_CurrentWorld.PlaceEntity(TranslateToWorldCoords(mousePos));
        }
    } 
```

The switch is used in several other functions (OnMouseMove, OnMouseUp) and it seems like bad design (big switch copied in several functions). Any advice for refactoring something like this in a cleaner and more extensible way? I'm currently thinking of having a base `Tool` class and having each tool it's own class that overrides the functions it uses (OnMouseDown() etc.). Does this sound sensible?

Thanks for reading.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T00:06:26.437

You have the good intuition.

Usually, in OOP, when you have rows of if's or humongous switches, it's a strong code smell. The best way to make this smell go away is to go with polymorphism.

You should go ahead with your idea, having a base abstract class BaseTool, with the different OnXXX methods implemented as nops (just returns, so you only have to specify the behavior if your tool knows how to act on the method), and have each tool inherit from BaseTool and implement its own behavior by overriding the relevant methods.

So your method ends up being

```
public void OnEditorViewMouseDown(Point mousePos)
{
  currentTool.OnEditorViewMouseDown(mousePos);
} 
```

Depending on your design, you should also consider passing the DragManager to the method, so as not to be tied to instance variables laying around. An EditorContext (containing the DragManager) fitted with everything the method needs without having to fetch "global" variables would make your method more self-contained and less brittle when refactoring. The design itself will depend on the responsability: who is in charge of what.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T00:16:56.087

Sounds like a good place to use the Strategy Pattern: [http://www.google.com/search?q=c%23+strategy+pattern](http://www.google.com/search?q=c%23+strategy+pattern)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T00:04:13.257

Yea, you should absolutley have a base class (or at the very least an interface) that defines all the common methods needed across all Tools. Try to make this code work, and it'll give you a good idea of how to design your classes:

```
m_DragManager.DragType = CurrentTool.DragType;
m_DragManager.StartDrag(mousePos); 
```

where "CurrentTool" is an instance of your base class or your interface.

So basically, when a "Tool" is selected, at that point you determine which derived Tool you're dealing with, but from that point on, you deal with the base class only, and forget about any enums or anything like that to determine the currently selected tool. Make sense?

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T00:09:27.367

Yes, [polymorphism](http://en.wikipedia.org/wiki/Polymorphism_(computer_science)) is what you want here. You should define either an [abstract](http://msdn.microsoft.com/en-us/library/sf985hc5(VS.80).aspx) base class Tool or an interface ITool depending on if you need to add implementation to the base or not (i.e. if there there common functionality among all tools, you might use an abstract base class).

Your manager should then take a Tool or ITool when something needs to be done. Your tool will implement a Drag function that takes the information it needs and either return what it needs to return or do what it needs to do. Or you could implement an [inversion of control](http://en.wikipedia.org/wiki/Inversion_of_Control) between your Manager and your Tool and inject the Manager into the Tool via property injection (Tool.Manager = dragManager) and let the tool do what it needs to do using the manager.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T00:06:07.483

[http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html](http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T00:03:49.950

I'm not terribly familiar with the syntax of C# but in general you could make the CurrentTool an object that has methods `StartDrag`, `EndDrag` which accept a `DragManager` as an argument. Then when the mouse is pressed down on the view you just invoke `CurrentTool.StartDrag(m_DragManager)`.

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-06-03T00:06:36.170

Try flag enums. Each bit would be a different feature and would allow for better stacking of features per cell.

Then you could just check for each bit even in different methods.

# asp.net-mvc - ASP.NET MVC 视图中的递归

> ID：942489
> 
> 赞同：27
> 
> 时间：2009-06-02T23:57:47.467
> 
> 标签：asp.net-mvc, recursion

我有一个嵌套数据对象，用于类别中的一组项目。每个类别都可以包含子类别，并且子类别的深度没有限制。（文件系统会有类似的结构。）它看起来像这样：

```
class category
{
    public int id;
    public string name;
    public IQueryable<category> categories;
    public IQueryable<item> items;
}
class item
{
    public int id;
    public string name;
} 
```

我将一个类别列表传递给我的视图作为`IQueryable<category>`. 我想将类别输出为一组嵌套的无序列表 ( `<ul>`) 块。我可以嵌套 foreach 循环，但是子类别的深度将受到嵌套 foreach 块的数量的限制。在 WinForms 中，我使用递归完成了类似的处理来填充 a `TreeView`，但我还没有看到任何在 ASPX MVC 视图中使用递归的示例。

可以在 ASPX 视图中进行递归吗？是否还有其他包含视图输出递归的视图引擎？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-03T00:49:55.833

创建您自己的 HtmlHelper 扩展方法，如下所示：

```
namespace System.Web.Mvc
{
    public static class HtmlHelperExtensions
    {
        public static string CategoryTree(this HtmlHelper html, IEnumerable<Category> categories)
        {
            string htmlOutput = string.Empty;

            if (categories.Count() > 0)
            {
                htmlOutput += "<ul>";
                foreach (Category category in Categories)
                {
                    htmlOutput += "<li>";
                    htmlOutput += category.Name;
                    htmlOutput += html.CategoryTree(category.Categories);
                    htmlOutput += "</li>";
                }
                htmlOutput += "</ul>";
            }

            return htmlOutput;
        }
    }
} 
```

有趣的是你应该问，因为我昨天才真正创建了其中一个。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-03T00:02:10.127

您可以通过将每个`<ul>`列表放入 a 中轻松做到这一点`PartialView`，并且对于您需要启动的每个新列表，您只需调用`Html.RenderPartial("myPartialName");`.

所以`Category`PartialView 可能看起来像这样：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<Category>>" %>
<% foreach(Category cat in ViewData.Model) { %>
     <li><p><%= cat.name %></p>
        <% if (cat.categories.Count > 0) {
                Html.RenderPartial("Category", cat.Categories);
           } %></li>
<% } %> 
```

在您的视图中，您只需发送“根”集合作为局部视图的模型：

```
<% Html.RenderPartial("Category", ViewData.Model) %> 
```

编辑：

*   我忘记了`Html.RenderPartial()`调用的第二个参数——当然类别必须作为模型传递。
*   当然，你对我犯的 DRY 错误是正确的——我已经相应地更新了我的代码。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-07-12T11:40:48.290

您可以使用辅助方法。

```
@model Models.CategoryModel

@helper TreeView(List<Models.CategoryModel> categoryTree)
{
    foreach (var item in categoryTree)
    {
    <li>
        @if (item.HasChild)
        {
            <span>@item.CategoryName</span>
            <ul>
                @TreeView(item.ChildCategories)
            </ul>
        }
        else
        {
            <span class="leaf @item.CategoryTreeNodeType.ToString()" id="@item._CategoryId">@item.CategoryName</span> 
        }
    </li>
    }
}

<ul id="categorytree">
    <li>@Model.CategoryName
    @TreeView(Model.ChildCategories)
    </li>
</ul> 
```

可以在此链接上找到更多信息： [http ://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx](http://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-05-29T09:05:33.600

您可以使用 lambdas 重用 html 部分

例子

```
 public class Category
    {
        public int id;
        public string name;
        public IEnumerable categories;
    } 
```

```
 <%
        Action<IEnumerable<Category>> categoriesMacros = null;
        categoriesMacros = categories => { %>
        <ul>
            <% foreach(var c in categories) { %>
                <li> <%= Html.Encode(c.name)%> </li>
                <% if (c.categories != null && c.categories.Count() > 0) categoriesMacros(c.categories);  %>
            <% } %>
        </ul>
        <% }; %>

    <% var categpries = (IEnumerable<Category>)ViewData["categories"]; %>
    <% categoriesMacros(categpries); %> 
```

# email - 电子邮件管理系统

> ID：942492
> 
> 赞同：0
> 
> 时间：2009-06-03T00:00:11.550
> 
> 标签：email, system

我想为我们的呼叫中心建立一个电子邮件管理系统。有我可以的开源吗？我的开发环境是 C# 和 SQL 2005。

谢谢

托尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T00:08:41.080

如果您正在谈论接收来自客户的电子邮件并将其变成门票。查看[此列表](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)并查看电子邮件集成字段。

# c# - 在 IIS 6.0 中使用 ProcessModelInfo

> ID：942498
> 
> 赞同：1
> 
> 时间：2009-06-03T00:03:03.993
> 
> 标签：c#, asp.net, iis-6

我想使用通过调用*System.Web.ProcessModelInfo.GetCurrentProcessInfo()*获得的信息。但是[MSDN](http://msdn.microsoft.com/en-us/library/system.web.processmodelinfo.aspx)说这种方法只能与 IIS 5 或 IIS 6 与 IIS 5.0 隔离模式一起使用。我不想使用 IIS 5 隔离模式。从性能计数器读取是唯一的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T03:55:16.047

不同版本的 IIS 体系结构发生了相当大的变化。就我个人而言，我不会依赖任何不属于基本 ISAPI 过滤器和扩展 API 的东西。使用性能计数器可能更适合未来。

要获得明确的答案，您应该尝试追踪 David Wang 当前的博客——我没有发布链接的代表：/自从我上次阅读他的博客以来已经有一段时间了，但如果他仍然活跃，那么您将从他那里得到更好的答案（他是 MS 的主要 IIS 开发人员之一）。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-08T04:07:20.897

您可以使用[Process.GetProcessByName](http://msdn.microsoft.com/en-us/library/z3w4xdc9.aspx)来获取有关您感兴趣的[IIS 工作进程的信息。](http://technet.microsoft.com/en-us/library/cc735084(WS.10).aspx)

# asp.net-mvc - Asp.net MVC 是否有助于创建 n 层解决方案？

> ID：942499
> 
> 赞同：1
> 
> 时间：2009-06-03T00:03:15.180
> 
> 标签：asp.net-mvc, n-tier-architecture

我的看法是有**，**也没有。

1.  它确实将逻辑和数据与 UI 分开，但仍将它们全部塞进一个单点应用程序中。
2.  这就是为什么我认为它不是真的，因为控制器是业务逻辑，视图是 UI，模型是 DAL。这些现在只是同一个应用程序中的层。

但是层应该是第一个或第二个变种，实际上被称为*层*吗？

有人想加自己的 2 美分吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T00:17:20.923

MVC 模板项目只是为了帮助您入门 -如果您愿意，并且如果它在您的应用程序中有意义，您可以*轻松地将控制器和/或模型移出到单独的项目中。*请记住，对于可能具有三个控制器、模型层中的几个额外类以及 EF 或 LINQ 数据模型的小型应用程序，您确实没有足够的文件来证明分离到不同项目的合理性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:59:31.770

我不认为控制器是业务逻辑。它们是应用程序逻辑，是将业务逻辑（模型）和表示逻辑（视图）联系在一起的粘合剂。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T00:15:39.210

好吧，我的生日蛋糕有几层，但它仍然是一个大蛋糕……是吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T08:46:08.053

当然可以！

我认为视图和控制器都包含用户界面逻辑......业务逻辑应该在模型中（不仅仅是 DAL）。

作为模型，您可以使用例如[CSLA 对象](http://www.lhotka.net/cslanet)并根据需要添加另外几个物理层（通过配置）。

您必须知道逻辑层和物理层（或层与层）之间存在差异......

lhotka 的网站上有很多关于这个主题的有趣文章！
例如[这个](http://www.lhotka.net/weblog/RepostFromAnMSDNForumDiscussion.aspx)和[这个](http://www.lhotka.net/weblog/ShouldAllAppsBeNtier.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T08:58:40.133

层和层是可互换的。在 n 层的上下文中，您将其称为表示层，但在分层应用程序的上下文中，您将其称为表示层。但实际上它们是同一回事。

对 n 层应用程序和松散耦合的试金石测试将是您是否可以将每一层构建为单独的项目并将它们部署在不同的机器上。

n 层应用的关键区别在于关注点分离 (SoC) 和低耦合。一个真正解耦的应用程序可能是一个只包含纯 HTML 的层。然后另一个包含纯 Javascript 并使用 AJAX 更新 DOM 并与 Web 服务通信。Web 服务包含它自己的一组层。

Web 服务有一个路由引擎，可以将请求路由到不同的控制器。控制器清理和解释请求，验证身份验证和不验证的内容，并调用适当的模型。反过来，模型必须返回 POCO 对象或 DTO 并将它们返回给将它们注入 DOM 的 Javascript。Javascript 可能会修改对象并将它们发送回以持久保存到数据库中。[Entity Framework 4.0 对这种n 层场景](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx)有很好的支持，尽管它在 SoC 部门中确实有点不足（例如强类型视图），但它对于更多目的来说是实用的。

我相信 MVC Futures 支持一些开箱即用的控制反转 (IoC) 容器，目前如果您想要松散耦合和真正的 n 层场景，您可能需要使用您选择的 IoC 容器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T21:07:41.750

“层”通常是指不同的物理服务器，而“层”是指将功能分离为松散耦合的区域。

也就是说，一个 3 层 Web 应用程序：第 1 层）数据库服务器第 2 层）Web 服务器第 3 层）客户端浏览器

3 层 Web 应用程序：第 1 层）UI 层 2）业务逻辑层 3）数据访问

# java - 如果只存在一个选项卡，有没有办法隐藏 JTabbedPane 的选项卡栏？

> ID：942500
> 
> 赞同：17
> 
> 时间：2009-06-03T00:03:28.547
> 
> 标签：java, user-interface, swing, jtabbedpane

我想要一种类似于 Firefox 的行为，其中可用选项卡列表仅在至少存在两个选项卡时才会显示。

我还没有找到类似的东西。

我最好的主意是手动更改布局：

*   如果是一个组件，只需将其添加到周围的面板
*   如果添加了一个组件，请从周围的面板中删除该组件，添加一个 JTabbedPane 并将之前的和新的组件都添加到该窗格中。
*   如果删除了一个组件并且窗格中只剩下一个组件，请删除窗格并添加包含的组件。

虽然这可能会奏效，但感觉就像是一种黑客攻击或解决方法......

有更好的主意吗？

理想情况下，解决方案应该在 Java 1.5 和 1.6 中都可以工作......但我也很高兴只有 1.6 的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-01-17T15:56:44.607

您可以覆盖计算选项卡按钮区域高度的 UI 方法，将高度强制为`0`只有一个选项卡时：

```
tabbed_pane.setUI(new BasicTabbedPaneUI() {  
    @Override  
    protected int calculateTabAreaHeight(int tab_placement, int run_count, int max_tab_height) {  
        if (tabbed_pane.getTabCount() > 1)
            return super.calculateTabAreaHeight(tab_placement, run_count, max_tab_height);  
        else  
            return 0;  
    }  
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T00:14:27.200

我相信你必须手动完成。显然[它以前已经做过](http://www-mipl.jpl.nasa.gov/vicar/vicar350/html/javadoc/jpl/mipl/mars/viewer/util/HideableTabbedPane.html)，但只是作为一个似乎不可用的系统的一小部分。

你的方法对我来说看起来不错。我会像你布置的那样做，并将所有逻辑包装在一个自定义中`JComponent`，这样它就不会那么老套了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T02:42:14.500

您最好只使用[`CardLayout`](http://java.sun.com/javase/6/docs/api/java/awt/CardLayout.html).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-11T17:15:38.860

是的，有办法。我花了四个小时在 oracle 网站上找到：http: [//docs.oracle.com/javase/7/docs/api/javax/swing/JTabbedPane.html#setTabLayoutPolicy()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTabbedPane.html#setTabLayoutPolicy%28%29)

只需使用这个：

```
//declare
private JTabbedPane editor = new JTabbedPane ();
//construct like this:
editor.setTabLayoutPolicy(JTabbedPane.SCROLL_TAB_LAYOUT);
//just add components and see how it goes.
editor.addTab("", newPanel); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-01T19:44:17.320

另一种选择是自定义 JTabbedPane 使用的 L&F 委托（BasicTabbedPaneUI 或 WindowsTabbedPaneUI，具体取决于您关心的平台）。这将允许您在仅显示单个选项卡的情况下自定义选项卡式窗格的行为。

这是另一种做事的方式，但我会说这是一项艰巨的任务，按照迈克尔所说的去做，你会以更少的努力到达你想去的地方。我只是想将此作为答案发布，以防您不知道此选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-03T18:35:01.367

我认为这可以使用标签栏和卡片布局来实现，

*   将标签栏和卡片布局添加到网格包布局，以便它们自动调整大小
*   标签栏的最大高度应该是标签的高度
*   向标签栏添加一个侦听器，以便在单击某些标签时它将切换卡片布局以显示适当的内容
*   如果标签栏只有一个标签，则隐藏它

这应该可以完成工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-15T07:33:57.810

`jTabbedPane1.removeTabAt(0);`似乎工作后`initComponents();`

# c# - 路径不是有效的虚拟路径

> ID：942514
> 
> 赞同：6
> 
> 时间：2009-06-03T00:08:53.060
> 
> 标签：c#, asp.net

以下方法采用指向 xml 文件的路径：

```
tree.LoadContentFile(path); 
```

我从本地文件系统（或使用`Server.MapPath()`）传递了一个完整路径，但每次我不断收到此错误：

[路径] 不是有效的虚拟路径。

编辑：我正在使用`Telerik RadTreeView`.

示例路径是：`"C:\inetpub\wwwroot\sitename\OutlookNavigation\tree.xml"`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-03T00:14:32.597

.NET 期待像这样的路径

```
~/folder/file.txt 
```

或者 `/folder/file.txt`

它将转化为物理路径。

# javascript - 如何确定要添加到 cookie 白名单的站点？

> ID：942518
> 
> 赞同：2
> 
> 时间：2009-06-03T00:10:45.163
> 
> 标签：javascript, cookies, safe-browsing

除非我允许接受所有 cookie，否则我无法登录一个银行网站。我使用的是 Firefox 3.0，并且我已将其设置为不接受除已定义列表（工具 - 选项 - 隐私 - Cookies - 例外）之外的 cookie。我已将 Live HTTP Headers 捕获的所有站点添加到白名单中，但登录仍然被禁用。我尝试启用所有 cookie 并登录，然后查看我得到的 cookie - 没有看到任何要添加到例外列表的新站点。显然，该网站以某种方式检查我是否接受任意 cookie。如何找出需要列入白名单的网站？还是我不了解 cookie，并且接受所有 cookie 与将所有正确的网站列入白名单不同？

该网站是[https://www.citizensbank.ca/](https://www.citizensbank.ca/)，只有在允许任何 cookie 时才会显示登录字段，否则会显示消息“要登录网上银行，您必须启用 JavaScript 和 cookie”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T01:11:03.170

我会给自己买另一台机器（或 VMWare 映像），删除所有 cookie，允许来自所有站点的所有 cookie，然后转到您的站点并登录（这听起来与您已经尝试过的相似）。

然后，在您的银行会话完成后（或者在此期间，如果他们创建一个短暂的 cookie 只是为了测试您启用了它们），请查看您的 cookie jar 以查看银行添加的内容。这应该告诉您需要添加到真实机器的域。

如果这不起作用，请联系银行并解释您的问题。他们要么告诉你哪些需要允许，要么他们会告诉你全部允许。如果是后者，您需要确定它们是否仍然值得作为您的银行保留。

或者，您可以：

*   如果您不希望所有 cookie 都出现在主框中，请使用您设置的虚拟机作为访问银行的沙盒。
*   设置脚本以在 FF 关闭后删除所有未列入白名单的 cookie。
*   完全停止担心 cookie 并允许它们（我认为我从未听说过 cookie 被用作攻击媒介）。

如果您愿意，请将您的帐户详细信息（用户/密码）发送给我，我会看看是否可以从这里调试它:-) 开个玩笑（以防它不是立即显而易见的）。

**更新：**

您的银行检查要求的方式特别邪恶。他们会检查您是否接受所有 cookie，这与他们根本没有业务往来。他们应该看看他们是否可以创建一个 cookie 并将其读回，这将使它们与 cookie 管理器兼容。

他们拥有的代码是：

```
function testCookie() {
    if (typeof navigator.cookieEnabled !== "undefined") {
        return !!navigator.cookieEnabled;
    } else{
        document.cookie="testcookie";
        return document.cookie.indexOf("testcookie")!=-1;
    }
}
if(!testCookie()){
    var browserWarningString = '';
    browserWarningString += '<div class="warning">';
    browserWarningString += '<p>To login to online banking, you must have
        JavaScript and cookies enabled.</p>';
    browserWarningString += '</div>\n';
    document.getElementById("loginAuth").innerHTML = browserWarningString;
} 
```

这是 的第一个位`testCookie()`，`return !!navigator.cookieEnabled`有问题的位。没有多少白名单 URL 可以在这里为您提供帮助，因为只有在 global 设置为 true 时才会检查`cookieEnabled`它（这不适合您，这是正确的）。

理想情况下，您只需能够`testCookie()`在出现的 HTML 中替换该函数。

我发现了一个类似的网站，该网站讨论了来自不同银行的相同问题（我猜银行是所有脑残的 Javascript 小子最终的归宿 :-) [，](http://forums.mozillazine.org/viewtopic.php?f=38&t=547857&start=0&st=0&sk=t&sd=a)以及两个建议的解决方案。

首先是安装 GreaseMonkey 并[在此处](http://userscripts.org/scripts/show/12163)使用此脚本。显然，这需要为您的银行进行更改（URL、函数名称等）。

上面第一个链接上的最后一篇文章（目前，查找“afternoonnap，2009 年 2 月 15 日，上午 10:10”的帖子）也展示了如何使用 NoScript 实现相同的结果。这涉及用更合理的脚本替换 cookieEnabled 脚本（针对该特定页面），尽管我可能只是选择替换它`"return true"`并挂起结果:-)。

希望能有所帮助。

为了完整起见（以防链接消失），我将在此处包含两个脚本。GreaseMonkey 归结为：

```
// ==UserScript==
// @name          TD Canada Trust EasyWeb Repair
// @namespace     tag:GossamerGremlin,2007-04-28:Repair
// @description   Repair TD Canada Trust EasyWeb website.
// @include       https://easyweb*.tdcanadatrust.com/*
// @exclude       
// ==/UserScript==

var scriptName = "TD Canada Trust EasyWeb Repair";

// The above @include pattern is overbroad because it exposes this
// user script to potential attacks from URLs such as this:
//   https://easyweb.evil.example.com/not.tdcanadatrust.com/bad.html
// The following check eliminates such possibilities:
if (location.href.match(/^https:\/\/easyweb\d\d[a-z].tdcanadatrust.com\//))
{
    // Visibly mark page to remind that this script is in use.
    if (document.body)
    {
        host = document.location.host;
        dummyDiv = document.createElement('div');
        dummyDiv.innerHTML = '<div><span style="color: red">Greased by: ' +
                             scriptName + ' (' + host + ')</span></div>';
        document.body.insertBefore(dummyDiv.firstChild,
            document.body.firstChild);
    }
    unsafeWindow.navigator.__defineGetter__("cookieEnabled",
        canStoreCookieFixed);
} 
```

```
// canStoreCookieFixed()
//   TD's version relies on navigator.cookieEnabled, which is not set
//   if customer has cookie manager, even when cookies are allowed for
//   EasyWeb. The only reliable check for enabled cookies is to actually
//   test if session cookie settings succeed, as done in this function
//   replacement.
function canStoreCookieFixed()
{
    var testSessionCookie ="testSessionCookie=Enabled";
    document.cookie = testSessionCookie;
    return (document.cookie.indexOf(testSessionCookie) != -1);
} 
```

NoScript 版本归结为“将以下内容添加到 about:config”：

```
noscript.surrogate.nce.sources=@easyweb*.tdcanadatrust.com

noscript.surrogate.nce.replacement=navigator.__defineGetter__(
    "cookieEnabled",function(){
        var ed=new Date;
        ed.setTime(0);
        var tc="__noscriptTestCookie_"+Math.round((Math.random()*99999))
            .toString(16)+"=1";
        document.cookie=tc;
        var ok=document.cookie.indexOf(tc)>-1;
        document.cookie=tc+";expires="+ed.toGMTString();
        return ok
    }
); 
```

**测试和更新：**

当我在 FF3 中安装 noscript 并完全关闭 cookie 时，然后添加以下`about:config`项目，登录提示会显示您的银行，所以我认为这可能是要走的路：

```
noscript.surrogate.nce.sources     = *.citizensbank.ca
noscript.surrogate.nce.replacement =
    navigator.__defineGetter__("cookieEnabled",function(){return true}); 
```

我建议您这样做并对其进行测试以确保您仍然拥有所有功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T00:20:23.193

您应该添加他们的注册基域，这样 www.citizensbank.ca 应该可以工作。您也可以尝试在登录时只允许 cookie，并在完成后点击 ctl+shift+del。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T01:44:41.870

另一种选择 - 使用不同的浏览器来启动该过程。例如，如果您通常使用 Firefox，请尝试使用 Safari、Opera、Chrome 或 MSIE。不要从您的普通浏览器导入任何 cookie。然后检查如何使网站正常工作。

# assembly - 实现 ARMv5TE 和 VFPv1 的 ARM 处理器？

> ID：942523
> 
> 赞同：4
> 
> 时间：2009-06-03T00:12:49.450
> 
> 标签：assembly, arm

是否存在任何实现架构版本 ARMv5TE（或 ARMv5TEJ）但也实现 VFPv1（相对于 VFPv2）的 ARM 处理器？

我正在为 ARMv5TE 编写一些汇编代码，我想假设如果存在 VFP，它就是 VFPv2。是否有任何处理器与这种组合一起发货？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-20T19:31:28.743

看起来没有这样的处理器。

> · **VFPv1**在 VFP10 版本 0 芯片中实现（由 ARM10200 提供）。对此的支持在 RVDS 2.1 中已弃用，并从 RVDS 2.2 开始删除。
> 
> · **VFPv2**已在 VFP10 第 1 版（由 ARM10200E 提供）、VFP9-S（作为 ARM926/946/966 的单独许可选项提供）和 VFP11（如 ARM1136JF-S 和 ARM1176JZF 中提供）中实现-S)。
> 
> · **VFPv3**向后兼容 VFPv2，除了 VFPv3 不能捕获浮点异常，因此不需要软件支持代码。VFPv3 在 ARM 架构 v7 及更高版本（例如 Cortex-A8）上实现。

因此，VFPv1 在 ARM10200 中实现，即 ARMv5T（[ARM10200 Datasheet](http://www.datasheetarchive.com/ARM10200-datasheet.html)，[ARM10200™ Reference Device Product Overview](http://infocenter.arm.com/help/topic/com.arm.doc.dvi0015a/index.html)）。只有下一个 VFP10 修订版 (VPFv2) 可用于 ARMv5TE 处理器。

[您可以在应用笔记 133](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dai0133c/index.html)中阅读有关 VPF 的更多信息。[**将 VFP 与 RVDS 结合使用**](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dai0133c/index.html)[](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dai0133c/index.html)

 **# .net - 如何从任意 HTTPS URL 获取 X509Certificate？

> ID：942524
> 
> 赞同：0
> 
> 时间：2009-06-03T00:14:03.847
> 
> 标签：.net, x509certificate2

我正在使用`HttpWebRequest`从任意 HTTPS URL 中提取页面。除了实际的页面结果之外，我还想为`X509Certificate2`我刚刚与之交谈的远程服务器获取一个实例。我确定公共证书在某处的计算机上，因为它的链必须作为请求的一部分进行验证。我怎样才能访问它？

另外，如何确保 SSL 通道中使用的密码套件不仅仅是空密码套件？我需要确保真正发生了体面的加密。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T00:17:59.937

哦！（呃）

```
HttpWebRequest.ServicePoint.Certificate 
```

但这并不能回答问题的密码套件部分，所以如果有人能回答它，它仍然是开放的。:)

# php - 如何检测 $result 是 mysql_fetch_array($result) 中的有效 MySQL 结果资源

> ID：942527
> 
> 赞同：2
> 
> 时间：2009-06-03T00:15:11.910
> 
> 标签：php, mysql

它是用 PHP 编写的，

有时当我重新启动mysql时，

将报告：

```
Debug Warning:line 24 - mysql_fetch_array(): supplied argument is not a valid MySQL result resource 
```

有什么方法可以检测 $result 是否是有效的 MySQL 结果资源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T00:17:15.230

如果有错误，它将是错误的。

```
if ($result) {
    $row = mysql_fetch_array($result);
} else {
    echo "MySQL error: " . mysql_error();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T04:19:30.037

或者你可以这样做：

```
if ($result) {
      $row = mysql_fetch_array($result);
      // Do everything you need to in here
 } 
```

# linq - LINQ 表达式帮助 - 查询我的对象模型

> ID：942536
> 
> 赞同：0
> 
> 时间：2009-06-03T00:18:18.580
> 
> 标签：linq

我是 LINQ 的新手，正在尝试查询我的业务层 (BLL)，即模型。我查看了一些示例，但似乎没有一个对我的场景有帮助。

假设我开始创建一个方法，我会认为：

```
public void GetLinqQuery()
{
EmployeeCollection employeeList = EmployeeController.GetAll();  // my usual way of getting employee list

// now I'll attempt using LINQ to get a subset of that collection
var query = from emp in employeeList
    select emp.FirstName,      // *** Intellisense breaks here, why?
} 
```

难道我做错了什么？鉴于我有对象，我如何查询我的集合/实体？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T00:30:38.430

`IEnumerable<Employee>`使用or可能会更容易`IQueryable<Employee>`。尝试以下操作：

```
public void GetLinqQuery()
{
IEnumerable<Employee> employeeList = EmployeeController.GetAll() as IEnumerable<Employee>;

var query = from Employee emp in employeeList
            select emp.FirstName      // Does intellisense break now?
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T09:23:38.433

如果我正确地解释了这一点，那么您似乎正在尝试这样做：

```
var query = from emp in employeeList
  select emp.FirstName, emp.LastName; 
```

那是行不通的。您需要选择它作为一个新对象，匿名或一些命名类型：

```
var query = from emp in employeeList
  select new { emp.FirstName, emp.LastName };
Console.WriteLine(query.First().FirstName); 
```

如果您打算将查询返回给调用函数，则需要使用命名类型，因为匿名类型不能离开它们所在的范围：

```
return from emp in employeeList
  select new EmployeeData(emp.FirstName, emp.LastName); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T03:01:56.223

当您编写以下代码时

```
Employee[] Employees= GetEmployee();
var query =
from c in Employees
select c.Name; 
```

编译器生成以下代码：

```
Employee[] Employees= GetEmployee();
IEnumerable<Employee> query =
Employees.Select( c => c.Name); 
```

所以你可以使用上述任何一种..

甚至你可以使用类型化的 List 集合

```
List<Employee> Employees = query.ToList(); 
```

# php - 如何按位比较字符串

> ID：942540
> 
> 赞同：4
> 
> 时间：2009-06-03T00:20:15.050
> 
> 标签：php, permissions, bit-manipulation

我正在开发一个函数，它接收一系列少于 255 个字符的权限字符串并将它们分配给一个实体。分配的每个字符串都是唯一的，但是有太多的字符串，以至于将它们放入数组中，将它们序列化并推送到数据库中，稍后将它们拉出并反序列化它们或在每次有负载时从查询中重新计算导致延迟问题。尤其是继承权限。

所以我正在考虑获取字符串，从中生成一个掩码，然后 OR'ing 进入权限全局。随着更多权限的添加，继续将它们 OR 到 glob。然后，当您需要针对 glob 验证权限和字符串时。

问题是如何生成掩码。起初我只是想对字符串进行哈希处理以获得一个唯一的掩码，但是这是可以想象的，但我不知道随着更多的哈希值被 OR'ed 到 glob 上，在这种情况下填充 glob 的可能性有多大以这种方式并使用他们没有的权限进行测试，但返回一个真值。

```
if($glob&&$test == $test) 
```

另一个选项只是自动编号权限字符串，并使其掩码为 2^auto-number。但这会将许可字符串的数量限制在 64ish 左右。

我真正想要的是某种类型的全局，我可以从数据库中提取一次并将其与用户相关联。然后针对代表权限集的字符串或关联值测试该 glob。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:54:47.147

我找到了一个有趣的解决方案，但我不确定它在逻辑上是否正确，因为我不太熟悉 PHP 如何处理字符串数据。我决定删除所有内容并尝试直接执行此操作，而不进行任何散列或分配或诸如此类的操作，并且只对字符串进行按位运算。它似乎有效，但我不确定我能否证明我的逻辑足够真实。

```
$key1 = "Access to Black Box";
$key2 = "Managing Black Box";
$key3 = "Nothing too see here";
$key3a = "Nothingg B";
$key3b = "too see";
$glob = "";

$glob = $glob | $key1;
if(($glob & $key1) == $key1){echo "<p>Key one exists in glob: " . $glob;}

$glob = $glob | $key2;
if(($glob & $key2) == $key2){echo "<p>Key one exists in glob: " . $glob;}

if(($glob & $key3) == $key3){echo "<p>Key three exists in glob: " . $glob;}
else{echo "<p>Key three does not exists in glob: " . $glob;}

$glob = $glob | $key3;
if(($glob & $key3) == $key3){echo "<p>Key three exists in glob: " . $glob;}

if(($glob & $key3a) == $key3a){echo "<p>Key three a exists in glob: " . $glob;}

if(($glob & $key3b) == $key3b){echo "<p>Key three b exists in glob: " . $glob;} 
else{echo "<p>Key three b does not exists in glob: " . $glob;} 
```

输出：

```
glob 中存在的关键一：访问黑盒
关键二存在于 glob：Mcoew{nwobnmckkbox
glob 中不存在键三：Mcoew{nwobnmckkbox
关键三存在于 glob：Oomowoomsooboze
关键三 a 存在于 glob 中：Oomowoomsooboze
glob 中不存在键三 b：Oomowoomsooboze

```

所以这行得通，但是我会如何看待碰撞？使用 key3a，我展示了一个字符串，其中包含与其他键中的字符匹配的位置的字符组合，我可以得到误报。但是我可以通过对权限字符串的严格规则来解决它吗？每种资源类型都被命名，并且每种资源类型具有有限数量的关联权限。所以像“博客....写帖子”、“博客...发布帖子”、“博客....适度帖子”、“播客....上传”、“播客.... ...Publish" 以补偿不断增加的冲突概率，因为字符串长度对 PHP 的速度几乎没有影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T00:50:47.283

这里的基本思想是：

> 另一个选项只是自动编号权限字符串，并使其掩码为 2^auto-number。但这会将许可字符串的数量限制在 64ish 左右。

如果您的权限字符串确实彼此独立，那么显然，无论您做什么，您都需要至少 1 位来存储权限是否存在。没有办法解决这个问题（它是 1 位实际的、独立的信息）。

您的问题的一个可能解决方案是以紧凑的方式对权限进行编码（例如为每个权限分配一个 Int16），并将用户权限列表存储为他所有权限的二进制数组。这很丑陋，但它会模糊地解决你的问题。根据数据库，您实际上可能有某种可用的数组/集合列类型可以为您执行此操作。

# python - 对列表中每一对元素的操作

> ID：942543
> 
> 赞同：119
> 
> 时间：2009-06-03T00:21:23.270
> 
> 标签：python

使用 Python，我想比较列表中每个可能的对。

假设我有

```
my_list = [1,2,3,4] 
```

我想对列表中 2 个元素的每个组合进行操作（我们称之为 foo）。

最终结果应该与

```
foo(1,1)
foo(1,2)
...
foo(4,3)
foo(4,4) 
```

我的第一个想法是手动遍历列表两次，但这似乎不是很pythonic。

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2009-06-03T00:24:43.373

[`product()`](http://docs.python.org/library/itertools.html#itertools.product)在`itertools`模块中签出。它完全符合您的描述。

```
import itertools

my_list = [1,2,3,4]
for pair in itertools.product(my_list, repeat=2):
    foo(*pair) 
```

这相当于：

```
my_list = [1,2,3,4]
for x in my_list:
    for y in my_list:
        foo(x, y) 
```

**编辑：**还有两个非常相似的功能，[`permutations()`](http://docs.python.org/library/itertools.html#itertools.permutations)和[`combinations()`](http://docs.python.org/library/itertools.html#itertools.combinations). 为了说明它们的不同之处：

`product()`生成所有可能的元素对，包括所有重复项：

```
1,1  1,2  1,3  1,4
2,1  2,2  2,3  2,4
3,1  3,2  3,3  3,4
4,1  4,2  4,3  4,4 
```

`permutations()`生成每个唯一元素对的所有唯一排序，消除`x,x`重复项：

```
 .   1,2  1,3  1,4
2,1   .   2,3  2,4
3,1  3,2   .   3,4
4,1  4,2  4,3   . 
```

Finally, `combinations()` only generates each unique pair of elements, in lexicographic order:

```
 .   1,2  1,3  1,4
 .    .   2,3  2,4
 .    .    .   3,4
 .    .    .    . 
```

All three of these functions were introduced in Python 2.6.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-06-19T13:15:38.030

I had a similar problem and found the solution [here](http://www.wellho.net/resources/ex.php4?item=y104/tessapy). It works without having to import any module.

Supposing a list like:

```
people = ["Lisa","Pam","Phil","John"] 
```

A simplified one-line solution would look like this.

**All possible pairs**, including duplicates:

```
result = [foo(p1, p2) for p1 in people for p2 in people] 
```

**All possible pairs, excluding duplicates**:

```
result = [foo(p1, p2) for p1 in people for p2 in people if p1 != p2] 
```

**Unique pairs**, where order is irrelevant:

```
result = [foo(people[p1], people[p2]) for p1 in range(len(people)) for p2 in range(p1+1,len(people))] 
```

* * *

In case you don't want to operate but just to get the pairs, removing the function `foo` and using just a tuple would be enough.

**All possible pairs**, including duplicates:

```
list_of_pairs = [(p1, p2) for p1 in people for p2 in people] 
```

Result:

```
('Lisa', 'Lisa')
('Lisa', 'Pam')
('Lisa', 'Phil')
('Lisa', 'John')
('Pam', 'Lisa')
('Pam', 'Pam')
('Pam', 'Phil')
('Pam', 'John')
('Phil', 'Lisa')
('Phil', 'Pam')
('Phil', 'Phil')
('Phil', 'John')
('John', 'Lisa')
('John', 'Pam')
('John', 'Phil')
('John', 'John') 
```

**All possible pairs, excluding duplicates**:

```
list_of_pairs = [(p1, p2) for p1 in people for p2 in people if p1 != p2] 
```

Result:

```
('Lisa', 'Pam')
('Lisa', 'Phil')
('Lisa', 'John')
('Pam', 'Lisa')
('Pam', 'Phil')
('Pam', 'John')
('Phil', 'Lisa')
('Phil', 'Pam')
('Phil', 'John')
('John', 'Lisa')
('John', 'Pam')
('John', 'Phil') 
```

**Unique pairs**, where order is irrelevant:

```
list_of_pairs = [(people[p1], people[p2]) for p1 in range(len(people)) for p2 in range(p1+1,len(people))] 
```

Result:

```
('Lisa', 'Pam')
('Lisa', 'Phil')
('Lisa', 'John')
('Pam', 'Phil')
('Pam', 'John')
('Phil', 'John') 
```

*Edit: After the rework to simplify this solution, I realised it is the same approach than Adam Rosenfield. I hope the larger explanation helps some to understand it better.*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T00:29:43.317

If you're just calling a function, you can't really do much better than:

```
for i in my_list:
    for j in my_list:
        foo(i, j) 
```

If you want to collect a list of the results of calling the function, you can do:

```
[foo(i, j) for i in my_list for j in my_list] 
```

which will return you a list of the result of applying `foo(i, j)` to each possible pair `(i, j)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-07T08:13:26.780

```
my_list = [1,2,3,4]

pairs=[[x,y] for x in my_list for y in my_list]
print (pairs) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-26T20:37:08.110

[Ben Bank's answer](https://stackoverflow.com/a/942551/10720618) works well if you want the combinations to be ordered lexicographically. However, if you want the combinations to be randomly ordered, here's a solution:

```
import random
from math import comb

def cgen(i,n,k):
    """
    returns the i-th combination of k numbers chosen from 0,1,...,n-1

    forked from: https://math.stackexchange.com/a/1227692
    changed from 1-indexed to 0-indexed.
    """
    # 1-index
    i += 1

    c = []
    r = i+0
    j = 0
    for s in range(1,k+1):
        cs = j+1
        while r-comb(n-cs,k-s)>0:
            r -= comb(n-cs,k-s)
            cs += 1
        c.append(cs-1)
        j = cs
    return c

def generate_random_combinations(n, k, shuffle=random.shuffle):
    """
    Generate combinations in random order of k numbers chosen from 0,1,...,n-1.

    :param shuffle: Function to in-place shuffle the indices of the combinations. Use for seeding.
    """
    total_combinations = comb(n, k)
    combination_indices = list(range(total_combinations))
    shuffle(combination_indices)

    for i in combination_indices:
        yield cgen(i, n, k) 
```

### Example Usage

For `N=100` and `k=4`:

```
gen_combos = generate_random_combinations(100, 4)

for i in range(3):
    print(next(gen_combos)) 
```

results in:

```
[4, 9, 55, 79]
[11, 49, 58, 64]
[75, 82, 83, 91] 
```

### Use Case

For my use case, I'm implementing an algorithm that's searching for a single (or a few) combination and halts when it finds a valid combination. On average, it traverses a very small subset of all possible combinations, so there's no need to build all possible combinations up front and then shuffle (the population size is too big to fit all combinations in memory, anyway).

The randomness is crucial to finding a solution quickly because lexicographic ordering results in a single value in the population being included in all combinations until it's exhausted. For example, if we have `n=100` and `k=4`, then the results will be like:

| index | combination |
| --- | --- |
| 0 | (0, 1, 2, 3) |
| 1 | (0, 1, 2, 4) |
| 2 | (0, 1, 2, 5) |
| ... |  |
| 156848 | (0, 97, 98, 99) |
| 156849 | (1, 2, 3, 4) |

If `0` is not part of a valid solution, then we will have searched 156849 combinations for no reason. Randomizing the order helps mitigate this issue (see example output above).

# php - SQLite 存储中的简单 id->json 对于廉价而肮脏的问答存储是否合理？

> ID：942544
> 
> 赞同：1
> 
> 时间：2009-06-03T00:21:31.727
> 
> 标签：php, jquery, security, json, sqlite

***情况***

我有一个非常紧凑的时间安排来编写一个简单的（基本上只写的网络应用程序）。该应用程序将是一个主要由 jQuery 驱动的问题树。问题和树可能需要在站点启动之前和之后更改。

答案将通过电子邮件发送...我可能什至不需要存储它们，但我会以防万一。

这需要在很短的时间内在共享主机上完成。

***我提出的策略***

**问题树本身**

主要在 jQuery 和 HTML 中实现问题树和验证。将问答状态存储为 javascript 对象，其中“问题文本”：“问题答案”作为每个问题的格式。

表单验证将仅基于 jQuery，除了（如后所述）确保仅插入有效的 JSON 之外，不会对单个字段进行服务器端验证。

**识别用户**

使用 PHP 处理会话状态，使用 PHP 会话 ID 作为每个用户的唯一键。

回答每个问题后，对一个非常简单的 PHP 脚本进行简单的 AJAX 调用，该脚本接受 PHP 会话 ID 和对象的 JSON 表示。（每次发送它的原因是如果用户退出回答问题，至少我们会得到一些数据。）

**贮存**

存储在（php 嵌入式）SQLite DB 中处理，如下所示：

```
CREATE TABLE q_and_a_storage (
  php_session_id text primary key,
  json_storage text
); 
```

**服务器端**

PHP AJAX 接收脚本非常愚蠢。它只是检查数据库以查看会话 ID 是否存在，然后根据需要进行插入或更新。它还确保在插入之前响应是有效的 JSON。

我只是想知道这是非常愚蠢还是合理。是否有一些我没有想到的大安全漏洞？

**人们想知道的事情：**

*   我估计在本次迭代中表格的填充量不足一百万
*   我们真正需要做的就是确保我们发送包含数据的初始电子邮件，但我将其存储以防万一
*   我很可能需要重新调整问题集，并且几乎无法知道哪些问题应该去，哪些应该留下。
*   如果我需要稍后对数据进行分析，我可以稍后将其发送到 CouchDB 并对其运行 map/reduce 查询，这就是该模型对我有吸引力的原因。
*   看起来像仅 javascript 表单提交阻止了大多数垃圾邮件，攻击的唯一回报是存储在数据库中的无用 JSON。
*   超快速的开发时间和问题集的灵活性是这里真正重要的因素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T01:58:12.170

非常详尽的解释，谢谢。所以我在这里看到的一个弱点（如果重要的话）是任何可以证明或猜测会话 ID 的人都可以“追溯更改”代表答案的 JSON ——我知道你说 JSON 是“无用的”，但是，如果是这样的话，那么你为什么要首先存储它？-) 也许我对 php 会话 ID 的安全性过于偏执（如果它本质上是安全的，那么我的反对意见就会崩溃），但是如果有任何价值潜在的垃圾邮件发送者执行此类追溯更改，然后我会添加一个验证级别（基于我自己控制的安全加密的 cookie...）。

# c# - 序列不包含元素错误，但我想检查 null

> ID：942545
> 
> 赞同：31
> 
> 时间：2009-06-03T00:21:40.633
> 
> 标签：c#, asp.net-mvc, linq

我有以下问题：

```
public Boolean Exists(String userName)
{
    IRepository<User> = new UserRepository();
    User user = userRepository.First(u => u.Name == userName);

    if (user == null) return false;

    // Exists!
    return true;
} 
```

现在的问题是，我无法检查用户对象是否为空。在我到达那里之前，我得到一个`InvalidOperationException`说法“**序列不包含任何元素**”。

这对我来说似乎很奇怪，特别是因为我不想建立带有异常的控制流（例如封装在 try..catch 中并在各自的部分中返回 true/false）。

这里发生了什么？这是正常的还是我的存储库有问题（提示？！）

**顺便说一句，当我要查找的元素存在（检索用户等）时，此代码可以*完美运行。*只有在没有匹配的情况下才有效。**

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-06-03T00:24:27.693

使用 FirstOrDefault 而不是 First。面对空集合，这将返回 null。

```
IRepository<User> = new UserRepository();
User user = userRepository.FirstOrDefault(u => u.Name == userName); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-03T00:24:30.050

尝试更改`.First()`为`.FirstOrDefault()`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-03T00:25:11.517

用于`.FirstOrDefault()`防止该错误

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-17T20:41:19.837

`FirstOrDefault`非常重要。但为了您的确切用途，您也可以说`Any`：

```
public bool Exists(string userName)
{
    IRepository<User> userRepository = new UserRepository();
    return userRepository.Any(u => u.Name == userName);
} 
```

# wpf - 使用 EventTrigger 设置属性

> ID：942548
> 
> 赞同：72
> 
> 时间：2009-06-03T00:23:45.480
> 
> 标签：wpf, xaml, triggers, eventtrigger

我希望能够使用 EventTrigger 设置属性，这有很多问题。

1）EventTriggers只支持Actions，所以我必须使用storyBoard来设置我的属性。

2）一旦我使用故事板，我有两个选择：

*   停止：一旦动画停止，值将恢复到动画开始之前
*   HoldEnd：这会锁定属性，因此代码和用户交互都不能更改动画所持有的属性。

在下面的示例中，我想在单击按钮时将 IsChecked 属性设置为 False，并且我希望用户能够更改 IsChecked 和/或我希望能够更改代码中的属性。

例子：

```
<EventTrigger
    SourceName="myButton"
    RoutedEvent="Button.Click">
    <EventTrigger.Actions>
        <BeginStoryboard>
            <Storyboard>
                <BooleanAnimationUsingKeyFrames
                    Storyboard.TargetName="myCheckBox"
                    Storyboard.TargetProperty="IsChecked"
                    FillBehavior="Stop">
                    <DiscreteBooleanKeyFrame
                        KeyTime="00:00:00"
                        Value="False" />
                </BooleanAnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger.Actions>
</EventTrigger> 
```

我意识到我可以在情节提要完成后使用“已完成”事件将值设置为 False。但是，在这种情况下，我希望将逻辑包含在 XAML 中，因为此逻辑将用于自定义控件并且仅特定于 UI。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-11-07T16:45:56.350

只需创建自己的操作。

```
namespace WpfUtil
{
    using System.Reflection;
    using System.Windows;
    using System.Windows.Interactivity;

    /// <summary>
    /// Sets the designated property to the supplied value. TargetObject
    /// optionally designates the object on which to set the property. If
    /// TargetObject is not supplied then the property is set on the object
    /// to which the trigger is attached.
    /// </summary>
    public class SetPropertyAction : TriggerAction<FrameworkElement>
    {
        // PropertyName DependencyProperty.

        /// <summary>
        /// The property to be executed in response to the trigger.
        /// </summary>
        public string PropertyName
        {
            get { return (string)GetValue(PropertyNameProperty); }
            set { SetValue(PropertyNameProperty, value); }
        }

        public static readonly DependencyProperty PropertyNameProperty
            = DependencyProperty.Register("PropertyName", typeof(string),
            typeof(SetPropertyAction));

        // PropertyValue DependencyProperty.

        /// <summary>
        /// The value to set the property to.
        /// </summary>
        public object PropertyValue
        {
            get { return GetValue(PropertyValueProperty); }
            set { SetValue(PropertyValueProperty, value); }
        }

        public static readonly DependencyProperty PropertyValueProperty
            = DependencyProperty.Register("PropertyValue", typeof(object),
            typeof(SetPropertyAction));

        // TargetObject DependencyProperty.

        /// <summary>
        /// Specifies the object upon which to set the property.
        /// </summary>
        public object TargetObject
        {
            get { return GetValue(TargetObjectProperty); }
            set { SetValue(TargetObjectProperty, value); }
        }

        public static readonly DependencyProperty TargetObjectProperty
            = DependencyProperty.Register("TargetObject", typeof(object),
            typeof(SetPropertyAction));

        // Private Implementation.

        protected override void Invoke(object parameter)
        {
            object target = TargetObject ?? AssociatedObject;
            PropertyInfo propertyInfo = target.GetType().GetProperty(
                PropertyName,
                BindingFlags.Instance|BindingFlags.Public
                |BindingFlags.NonPublic|BindingFlags.InvokeMethod);

            propertyInfo.SetValue(target, PropertyValue);
        }
    }
} 
```

在这种情况下，我将绑定到我的视图模型上名为 DialogResult 的属性。

```
<Grid>

    <Button>
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="Click">
                <wpf:SetPropertyAction PropertyName="DialogResult" TargetObject="{Binding}"
                                       PropertyValue="{x:Static mvvm:DialogResult.Cancel}"/>
            </i:EventTrigger>
        </i:Interaction.Triggers>
        Cancel
    </Button>

</Grid> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-03T02:18:29.570

尽管我很喜欢 XAML，但对于这类任务，我会切换到代码后面。[附加行为](http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx)是一个很好的模式。请记住，Expression Blend 3[提供了一种](http://sachabarber.net/?p=510)编程和使用行为的标准方法。Expression Community 网站上有[一些现有的。](http://gallery.expression.microsoft.com/en-us/site/items/behaviors)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-25T23:21:51.677

我修改了 Neutrino 的解决方案，使 xaml 在指定值时看起来不那么冗长：

抱歉没有渲染 xaml 的图片，想象一下您单击的 [=] 汉堡按钮，它变成 [<-] 后退按钮并切换网格的可见性。

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"

...

<Grid>
    <Button x:Name="optionsButton">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="Click">
                <local:SetterAction PropertyName="Visibility" Value="Collapsed" />
                <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsBackButton}" Value="Visible" />
                <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsPanel}" Value="Visible" />
            </i:EventTrigger>
        </i:Interaction.Triggers>

        <glyphs:Hamburger Width="10" Height="10" />
    </Button>

    <Button x:Name="optionsBackButton" Visibility="Collapsed">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="Click">
                <local:SetterAction PropertyName="Visibility" Value="Collapsed" />
                <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsButton}" Value="Visible" />
                <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsPanel}" Value="Collapsed" />
            </i:EventTrigger>
        </i:Interaction.Triggers>

        <glyphs:Back Width="12" Height="11" />
    </Button>
</Grid>

...

<Grid Grid.RowSpan="2" x:Name="optionsPanel" Visibility="Collapsed">

</Grid> 
```

您也可以像在 Neutrino 的解决方案中那样指定值：

```
<Button x:Name="optionsButton">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Click">
            <local:SetterAction PropertyName="Visibility" Value="{x:Static Visibility.Collapsed}" />
            <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsBackButton}" Value="{x:Static Visibility.Visible}" />
            <local:SetterAction PropertyName="Visibility" TargetObject="{Binding ElementName=optionsPanel}" Value="{x:Static Visibility.Visible}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>

    <glyphs:Hamburger Width="10" Height="10" />
</Button> 
```

这是代码。

```
using System;
using System.ComponentModel;
using System.Reflection;
using System.Windows;
using System.Windows.Interactivity;

namespace Mvvm.Actions
{
    /// <summary>
    /// Sets a specified property to a value when invoked.
    /// </summary>
    public class SetterAction : TargetedTriggerAction<FrameworkElement>
    {
        #region Properties

        #region PropertyName

        /// <summary>
        /// Property that is being set by this setter.
        /// </summary>
        public string PropertyName
        {
            get { return (string)GetValue(PropertyNameProperty); }
            set { SetValue(PropertyNameProperty, value); }
        }

        public static readonly DependencyProperty PropertyNameProperty =
            DependencyProperty.Register("PropertyName", typeof(string), typeof(SetterAction),
            new PropertyMetadata(String.Empty));

        #endregion

        #region Value

        /// <summary>
        /// Property value that is being set by this setter.
        /// </summary>
        public object Value
        {
            get { return (object)GetValue(ValueProperty); }
            set { SetValue(ValueProperty, value); }
        }

        public static readonly DependencyProperty ValueProperty =
            DependencyProperty.Register("Value", typeof(object), typeof(SetterAction),
            new PropertyMetadata(null));

        #endregion

        #endregion

        #region Overrides

        protected override void Invoke(object parameter)
        {
            var target = TargetObject ?? AssociatedObject;

            var targetType = target.GetType();

            var property = targetType.GetProperty(PropertyName, BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Static | BindingFlags.Instance);
            if (property == null)
                throw new ArgumentException(String.Format("Property not found: {0}", PropertyName));

            if (property.CanWrite == false)
                throw new ArgumentException(String.Format("Property is not settable: {0}", PropertyName));

            object convertedValue;

            if (Value == null)
                convertedValue = null;

            else
            {
                var valueType = Value.GetType();
                var propertyType = property.PropertyType;

                if (valueType == propertyType)
                    convertedValue = Value;

                else
                {
                    var propertyConverter = TypeDescriptor.GetConverter(propertyType);

                    if (propertyConverter.CanConvertFrom(valueType))
                        convertedValue = propertyConverter.ConvertFrom(Value);

                    else if (valueType.IsSubclassOf(propertyType))
                        convertedValue = Value;

                    else
                        throw new ArgumentException(String.Format("Cannot convert type '{0}' to '{1}'.", valueType, propertyType));
                }
            }

            property.SetValue(target, convertedValue);
        }

        #endregion
    }
} 
```

编辑：Interactivity dll 不再是 Blend 的一部分，现在是“Microsoft.Xaml.Behaviors.Wpf”NuGet 包。此处列出的代码：[https ://github.com/microsoft/XamlBehaviorsWpf](https://github.com/microsoft/XamlBehaviorsWpf)

请参阅：[https ://devblogs.microsoft.com/dotnet/open-sourcing-xaml-behaviors-for-wpf/](https://devblogs.microsoft.com/dotnet/open-sourcing-xaml-behaviors-for-wpf/)

从旧的 Blend Microsoft.Expression.Interactions.dll 迁移到新的开源交互 dll 的步骤（希望我的旧笔记是正确的；p）：

```
1\. Install the "Microsoft.Xaml.Behaviors.Wpf" NuGet package.

2\. Edit xaml files:
       Replace 'http://schemas.microsoft.com/expression/2010/interactivity' and
               'http://schemas.microsoft.com/expression/2010/interactions'

               with 'http://schemas.microsoft.com/xaml/behaviors'.

       Replace 'xmlns:ei="clr-namespace:Microsoft.Expression.Interactivity.Core;assembly=Microsoft.Expression.Interactions"' and
               'xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"'

               with 'xmlns:i="http://schemas.microsoft.com/xaml/behaviors"'.

3\. Edit C# files:
       Replace usings in c# files 'Microsoft.Xaml.Interactivity' and
                                  'Microsoft.Xaml.Interactions'

                                  with 'Microsoft.Xaml.Behaviors'.

       Remove references to 'Microsoft.Expression.Interactions' and
                            'System.Windows.Interactivity'. 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-03T02:37:00.283

停止情节提要可以在后面的代码或 xaml 中完成，具体取决于需要的来源。

如果 EventTrigger 被移到按钮之外，那么我们可以继续并使用另一个 EventTrigger 来定位它，这将告诉故事板停止。当故事板以这种方式停止时，它不会恢复到以前的值。

在这里，我将 Button.Click EventTrigger 移动到周围的 StackPanel 并在 CheckBox.Click 上添加了一个新的 EventTrigger，以在单击 CheckBox 时停止 Button 的情节提要。这使我们可以在单击 CheckBox 时选中和取消选中它，并为我们提供按钮所需的取消选中行为。

```
 <StackPanel x:Name="myStackPanel">

        <CheckBox x:Name="myCheckBox"
                  Content="My CheckBox" />

        <Button Content="Click to Uncheck"
                x:Name="myUncheckButton" />

        <Button Content="Click to check the box in code."
                Click="OnClick" />

        <StackPanel.Triggers>

            <EventTrigger RoutedEvent="Button.Click"
                          SourceName="myUncheckButton">
                <EventTrigger.Actions>
                    <BeginStoryboard x:Name="myBeginStoryboard">
                        <Storyboard x:Name="myStoryboard">
                            <BooleanAnimationUsingKeyFrames Storyboard.TargetName="myCheckBox"
                                                            Storyboard.TargetProperty="IsChecked">
                                <DiscreteBooleanKeyFrame KeyTime="00:00:00"
                                                         Value="False" />
                            </BooleanAnimationUsingKeyFrames>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger.Actions>
            </EventTrigger>

            <EventTrigger RoutedEvent="CheckBox.Click"
                          SourceName="myCheckBox">
                <EventTrigger.Actions>
                    <StopStoryboard BeginStoryboardName="myBeginStoryboard" />
                </EventTrigger.Actions>
            </EventTrigger>

        </StackPanel.Triggers>
    </StackPanel> 
```

为了在后面的代码中停止故事板，我们将不得不做一些稍微不同的事情。第三个按钮提供了我们将停止情节提要并通过代码将 IsChecked 属性设置回 true 的方法。

我们不能调用 myStoryboard.Stop()，因为我们没有通过设置 isControllable 参数的代码开始 Storyboard。相反，我们可以删除 Storyboard。为此，我们需要情节提要所在的 FrameworkElement，在本例中为 StackPanel。删除故事板后，我们可以再次设置 IsChecked 属性，并将其保留在 UI 中。

```
 private void OnClick(object sender, RoutedEventArgs e)
    {
        myStoryboard.Remove(myStackPanel);
        myCheckBox.IsChecked = true;
    } 
```

# vim - 像在 Firefox 中一样切换到 Vim 中的特定选项卡？

> ID：942558
> 
> 赞同：8
> 
> 时间：2009-06-03T00:27:25.473
> 
> 标签：vim

当我按下 Alt+# 时，如何让 Vim 切换到某个选项卡？例如，要进入第三个选项卡，我会按 Alt+3（类似于 Firefox 中的行为）。

编辑：另外，我怎样才能使 Control + tab == gt，Control + shift + tab == gT

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T00:37:45.467

```
:nmap <M-1> :tabnext 1<CR>
:nmap <M-2> :tabnext 2<CR>
etc. 
```

见`:h :tabnext`。请注意，默认情况下，您也可以`Ngt`在正常模式下执行，其中 N 是您想要的选项卡的编号（从 1 开始）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T19:15:36.830

这对我有用（从我的 rc 复制并粘贴）：

```
" Tab Control (others)
 map <A-1> 1gt
 map <A-2> 2gt
 map <A-3> 3gt
 map <A-4> 4gt
 map <A-5> 5gt
 map <A-6> 6gt
 map <A-7> 7gt
 map <A-8> 8gt
 map <A-9> 9gt 
```

还有进一步的好处：

```
map <C-Right> <ESC>:tabnext<CR>
map <C-Left> <ESC>:tabprev<CR>
map <C-t> <ESC>:tabnew<CR> 
```

您可能希望像上面的示例一样将其更改为 nmap 以更好地限制使用我在这方面有点懒惰。

使用 Ctl-t 错过了您的编辑下一个选项卡将是：

```
map <C-t> :tabnext<CR> 
```

我不认为 tabprevious 映射在 vim 中是可能的，因为它处理大写字符的方式见：

[http://www.nabble.com/Maping-Ctrl-Shift-s-problems-td22918941.html](http://www.nabble.com/Maping-Ctrl-Shift-s-problems-td22918941.html)

为了节省一些时间，当我想要这个时，我花了很多时间四处寻找

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-17T13:46:19.353

让这个在 urxvt 中工作被证明是困难的。最终我决定使用以下绑定：

```
:nnoremap <Esc>1 gt1
:nnoremap <Esc>2 gt2
:nnoremap <Esc>3 gt3
:nnoremap <Esc>4 gt4
:nnoremap <Esc>5 gt5
:nnoremap <Esc>6 gt6
:nnoremap <Esc>7 gt7
:nnoremap <Esc>8 gt8
:nnoremap <Esc>9 gt9
:nnoremap <Esc>0 gt0 
```

问题是在 rxvt 中默认情况下，Alt 数字组合必然会转义前缀数字。最初我通过在我的`~/.vimrc`文件中包含以下内容进行管理：

```
:nnoremap <M-1> gt1
:nnoremap <M-2> gt2
... 
```

这是通过使用以下“~/.Xdefaults”来实现的：

```
URxvt*meta8: true 
```

这会强制 rxvt 在按下 Alt 时使用第 8 个字符位，这是 Vim 用来检测 Alt 状态的方法。在您的`.Xdefaults`文件中设置它可以设置第 8 位。但是，这会导致其他程序出现问题，例如`irssi`run over `screen`，因此我建议的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-17T14:16:38.450

在 Mac 上，您可能需要使用 cmd + 数字来切换选项卡。以下效果很好。

```
map <D-1> 1gt 
map <D-2> 2gt 
map <D-3> 3gt
etc... 
```

# objective-c - 如何移动到 Xcode 中的下一个搜索结果

> ID：942561
> 
> 赞同：0
> 
> 时间：2009-06-03T00:27:56.253
> 
> 标签：objective-c, xcode

如果我在 Xcode 中 alt 双击一个方法名称，我会被带到方法文档。通常，有多个同名的方法（一个例子是 scrollEnabled，它给了我 9 个结果）。如果一个 Xcode 显示我不在我想要的类中，我怎样才能得到下一个结果？后退按钮对此不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:49:24.950

您必须隐藏文档窗口的列表视图。通常在文档窗格上方有一个与您的查询匹配的列表（类似于编辑器部分顶部的窗格 - 您可以在其中执行 Command-Shift-E 来切换它，但由于某种原因它不起作用在“文档”窗口中）。

无论如何，将窗格的顶部向下拖动以查看列表。

希望这已经足够清楚了。

# actionscript-3 - NetStream 从 FMS 中的流中加载 ID3 信息

> ID：942566
> 
> 赞同：0
> 
> 时间：2009-06-03T00:29:46.530
> 
> 标签：actionscript-3, flash-media-server, id3

我一直按照基本的 FMS 说明来加载和播放 mp3。这工作得很好。我还有第二个 NetStream 实例 (id3Stream)，它应该从同一个 mp3 加载 ID3 数据，但我得到的只是 StreamNotFound 错误。为什么 mp3 流和播放但 id3 数据“找不到”？任何帮助，将不胜感激。

```
var url:String = "name_of_mp3";
// -- yay, I'm listening to the song
stream.play("mp3:" + url, position);
// -- boo, it's not found even though it's the same url
id3Stream.play("id3:" + url); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-25T15:28:03.053

我不确定你的情况，但我听说某些版本的 FMS 存在 ID3v2 错误。显然 FMS 3.5.2 解决了这个问题......来自[3.5.2 发行说明](http://www.adobe.com/support/documentation/en/flashmediaserver/releasenotes.html)：

> 2285061 带有 ID3v2 标签的 MP3 文件无法播放。

# mysql - 在 MySQL 查询的 WHERE 子句中使用列别名会产生错误

> ID：942571
> 
> 赞同：233
> 
> 时间：2009-06-03T00:31:58.693
> 
> 标签：mysql, sql, mysql-error-1054

我正在运行的查询如下，但是我收到了这个错误：

> #1054 - 'IN/ALL/ANY 子查询'中的未知列 'guaranteed_postcode'

```
SELECT `users`.`first_name`, `users`.`last_name`, `users`.`email`,
SUBSTRING(`locations`.`raw`,-6,4) AS `guaranteed_postcode`
FROM `users` LEFT OUTER JOIN `locations`
ON `users`.`id` = `locations`.`user_id`
WHERE `guaranteed_postcode` NOT IN #this is where the fake col is being used
(
 SELECT `postcode` FROM `postcodes` WHERE `region` IN
 (
  'australia'
 )
) 
```

我的问题是：为什么我不能在同一个数据库查询的 where 子句中使用假列？

* * *

## 回答 #1

> 赞同：485
> 
> 时间：2009-06-03T00:38:20.100

您只能在 GROUP BY、ORDER BY 或 HAVING 子句中使用列别名。

> 标准 SQL 不允许您在 WHERE 子句中引用列别名。施加此限制是因为在执行 WHERE 代码时，可能尚未确定列值。

复制自[MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/problems-with-alias.html)

正如评论中所指出的，使用 HAVING 代替可能会完成这项工作。确保也阅读这个问题：[WHERE vs HAVING](https://stackoverflow.com/questions/2905292/where-vs-having/18710763#18710763)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-03T00:47:09.910

正如维克多所指出的，问题出在别名上。但是，可以通过将表达式直接放入 WHERE x IN y 子句来避免这种情况：

```
SELECT `users`.`first_name`,`users`.`last_name`,`users`.`email`,SUBSTRING(`locations`.`raw`,-6,4) AS `guaranteed_postcode`
FROM `users` LEFT OUTER JOIN `locations`
ON `users`.`id` = `locations`.`user_id`
WHERE SUBSTRING(`locations`.`raw`,-6,4) NOT IN #this is where the fake col is being used
(
 SELECT `postcode` FROM `postcodes` WHERE `region` IN
 (
  'australia'
 )
) 
```

但是，我想这是非常低效的，因为必须为外部查询的每一行执行子查询。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-07-27T10:14:13.480

标准 SQL（或 MySQL）不允许在 WHERE 子句中使用列别名，因为

> 评估 WHERE 子句时，可能尚未确定列值。

（来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.6/en/problems-with-alias.html)）。您可以做的是计算*WHERE*子句中的列值，将值保存在变量中，然后在字段列表中使用它。例如，您可以这样做：

```
SELECT `users`.`first_name`, `users`.`last_name`, `users`.`email`,
@postcode AS `guaranteed_postcode`
FROM `users` LEFT OUTER JOIN `locations`
ON `users`.`id` = `locations`.`user_id`
WHERE (@postcode := SUBSTRING(`locations`.`raw`,-6,4)) NOT IN
(
 SELECT `postcode` FROM `postcodes` WHERE `region` IN
 (
  'australia'
 )
) 
```

这样可以避免在表达式变得复杂时重复表达式，从而使代码更易于维护。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-08-29T13:03:31.077

也许我的回答为时已晚，但这可以帮助其他人。

您可以用另一个 select 语句将其括起来并使用 where 子句。

```
SELECT * FROM (Select col1, col2,...) as t WHERE t.calcAlias > 0 
```

calcAlias 是计算的别名列。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-04-14T09:40:48.647

您可以将 HAVING 子句用于在 SELECT 字段和别名中计算的过滤器

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-07T14:39:00.633

我正在使用 mysql 5.5.24，以下代码有效：

```
select * from (
SELECT `users`.`first_name`, `users`.`last_name`, `users`.`email`,
SUBSTRING(`locations`.`raw`,-6,4) AS `guaranteed_postcode`
FROM `users` LEFT OUTER JOIN `locations`
ON `users`.`id` = `locations`.`user_id`
) as a
WHERE guaranteed_postcode NOT IN --this is where the fake col is being used
(
 SELECT `postcode` FROM `postcodes` WHERE `region` IN
 (
  'australia'
 )
) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-21T10:02:21.927

您可以将 SUBSTRING( `locations`. `raw`,-6,4) 用于 where 条件

```
SELECT `users`.`first_name`, `users`.`last_name`, `users`.`email`,
SUBSTRING(`locations`.`raw`,-6,4) AS `guaranteed_postcode`
FROM `users` LEFT OUTER JOIN `locations`
ON `users`.`id` = `locations`.`user_id`
WHERE SUBSTRING(`locations`.`raw`,-6,4) NOT IN #this is where the fake col is being used
(
SELECT `postcode` FROM `postcodes` WHERE `region` IN
(
 'australia'
)
) 
```

# php - 如何在 PHP 中测试连接性？

> ID：942572
> 
> 赞同：3
> 
> 时间：2009-06-03T00:32:16.947
> 
> 标签：php, connection

假设你现在连接到一个 jabber 服务器，

那么如何检查与 jabber 服务器的连接是否丢失？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T04:16:08.540

试试 fsockopen ( [http://us3.php.net/fsockopen](http://us3.php.net/fsockopen) ):

```
$fp = fsockopen("www.example.com", 80, $errno, $errstr, 30);
//if the socket failed it's offline...
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:10:02.720

与任何其他协议相比，我不完全确定 Jabber 的工作原理，但我相信您需要与服务器建立套接字连接，例如：

```
$endpoint = "SERVER";
$fp = fopen( $endpoint, "r" ) or die();
while ( ! feof( $fp )){
    // Heavy duty work goes here.
    print fgets( $fp, 1024 );
} 
```

while() 循环将一直运行，直到套接字连接停止向 PHP 脚本返回数据。因此，只要您的逻辑在一个这样的 while() 循环中，它应该离开 while() 循环的唯一时间是在连接终止时。

# c# - 如何从 Web 应用程序中保存富文本并将其显示在富文本框中

> ID：942573
> 
> 赞同：1
> 
> 时间：2009-06-03T00:32:29.970
> 
> 标签：c#, winforms, formatting, webforms, richtextbox

我目前正在与一位同事一起开发一个应用程序 - 她正在编写一个 Web 表单，允许用户输入和管理将保存到数据库中然后显示在桌面应用程序中的文本。

我正在使用富文本框来显示数据库中的文本。我们希望允许用户在 Web 应用程序中使用基本格式（粗体、斜体、下划线），然后在桌面应用程序中显示该格式。

我想知道是否有可以在 Web 表单中输入的标签或其他内容（如或 [b] 等），它将自动在 RTB 中显示格式。

如果这不可能，实现此功能的最佳方法是什么？

我正在为桌面应用程序使用 C# windows 窗体。

更新：网络表单是 PHP 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T19:45:09.840

几年前我玩过这个 - 基本上我在数据库中有文本，我正在标记以强调某些单词。我在存储过程中对其进行了标记，然后在客户端将其转换为 RTF。

我尝试查看 RTF 规范，但仅阅读规范并知道该怎么做有点挑战性。

我建议打开写字板（开始 -> 运行... -> 写字板），并使用不同的字体样式等。然后将其另存为 RTF 文档。在您选择的纯文本编辑器中打开该文档（我使用[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)），这将帮助您更轻松地计算 RTF。

这是我创建的一个简单 RTF 文档的示例：

```
{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fswiss\fcharset0 Arial;}}
{\colortbl ;\red0\green0\blue255;}
{\*\generator Msftedit 5.41.15.1515;}\viewkind4\uc1\pard\f0\fs20 Hello World.\par
\b This text is bold.\b0\par
\i This text is italicized.\i0\par
\cf1 This text is blue.\cf0\par
} 
```

其中一些标签只是您可能不需要的额外标记。玩弄它看看。

最终，您应该能够按照以下方式做一些事情：

```
string rtf = GetMarkupTextFromServer();
rtf = rtf.Replace("[b]", @"\b");
rtf = rtf.Replace("[/b]", @"\b0");
rtf = rtf.Replace("[i]", @"\i");
rtf = rtf.Replace("[/i]", @"\i0");
    ...
mRichTextBox.Rtf  = rtf; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T00:37:59.803

如果用户无法在 Windows 端编辑数据而只能在 Web 端编辑数据，您可以将 HTML 源代码存储在 DB 中，并将其显示在 Windows 应用程序的 Webbrowser 控件中...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T01:04:06.460

正如[BFree 所](https://stackoverflow.com/users/15861/bfree)提到的，您在 Web 环境中要做的最好的事情就是富文本 HTML 编辑器。幸运的是，那里有[许多免费的编辑器](http://woork.blogspot.com/2009/02/best-rich-text-editors-ready-to-use-in.html)。如果您将信息作为 HTML 存储在数据库中并选择在 WebForm 中重新使用它，那么您将被 Web 浏览器控件困住。但是，您可以选择通过使用库在 HTML 和 RTF 之间来回转换该信息。

不幸的是，经过一番搜索，我找不到任何您不必支付的费用。您也许可以利用 MS Word 作为数据泵以编程方式进行转换，但这可能无法很好地扩展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T01:29:40.323

使用网络浏览器控件并使用您在网络表单中使用的相同编辑器，这样您以后就不会遇到复杂的问题。

您可以在两种环境中拥有相同的外观和感觉。如果您需要帮助以使用网络形式的编辑器，请回复此消息。

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-21T19:49:32.160

创建一个名为 temp 的文件夹，然后使用此代码

```
frmEditPro.RichTextBox1.SaveFile("C:\temp\Doc1.rtf", _RichTextBoxStreamType.RichText) 
```

# c++ - 使用 pthread_setspecific 和 pthread_getspecific 存储指向 std::map 实例的指针

> ID：942574
> 
> 赞同：1
> 
> 时间：2009-06-03T00:33:50.827
> 
> 标签：c++, pthreads

我使用映射作为特定于线程的缓存来跟踪失败的 LDAP 搜索。我使用 pthread_setspecific 动态分配映射并存储指针。在检查缓存或增加失败计数时，我使用 pthred_getspecific 来检索 void* 指针和 static_cast 将指针返回到我的映射类型。使用 [] 运算符调用地图似乎不会影响地图的状态，并且对 map->size() 的调用总是返回 0。感觉我可能错误地使用了 pthread_getspecific 但从我的示例中看着我的代码看起来不错。

### 代码：

```
typedef std::map<std::string, int>  FailedSearchCacheMap;

/**
 * Create the keyserver failed search cache key. Only called 
 * internally and may only be called once per thread.
 */
static void
sCreateKeyserverFailedSearchCache(void)
{
    // Create the key used in refrencing the cache.  
    // sFreeKeyserverFailedSearch called against the pointer when the thread exits
    pthread_key_create(&sFailedSearchCacheKey, sFreeFailedSearchCache);
}

/**
 * Get the keyserver failed search cache (also create one if it doesn't exist)
 */
static FailedSearchCacheMap *
sGetKeyserverFailedSearch(void)
{
    // Initializes the failed search cache key.  
    // pthread_once guarantees that the create key routine is only called once
    static pthread_once_t sKeyserverFailedSearchOnce = PTHREAD_ONCE_INIT;
    pthread_once(&sKeyserverFailedSearchOnce, sCreateKeyserverFailedSearchCache);

    FailedSearchCacheMap* cache = static_cast<FailedSearchCacheMap *>(pthread_getspecific(sFailedSearchCacheKey));
    if (IsNull(cache))
    {
        cache = new FailedSearchCacheMap();
        pthread_setspecific(sFailedSearchCacheKey, cache);
    }

    return cache;
} 
```

* * *

### 测试代码：

```
FailedSearchCacheMap* map_ptr1 = sGetKeyserverFailedSearch();
FailedSearchCacheMap* map_ptr2 = sGetKeyserverFailedSearch();

std::string ks("hostname");
FailedSearchCacheMap map1 = *map_ptr1;
FailedSearchCacheMap map2 = *map_ptr2;

int numFailedSearches = map1[ks] + 1;
map1[ks] = numFailedSearches;

std::cout << "numFailedSearches: "  << numFailedSearches << std::endl;

std::cout << "map_ptr1 address: "   << map_ptr1 << std::endl;
std::cout << "map_ptr2 address: "   << map_ptr2 << std::endl;

std::cout << "map_ptr1->size(): "   << map_ptr1->size() << std::endl;
std::cout << "map_ptr2->size(): "   << map_ptr2->size() << std::endl;

std::cout << "map1.size(): "        << map1.size() << std::endl;
std::cout << "map2.size(): "        << map2.size() << std::endl;

FailedSearchCacheMap::iterator i = map1.begin();
for(; i != map1.end(); i++)
    std::cout << (*i).first << ":" << (*i).second << std::endl; 
```

* * *

### 测试代码输出：

```
numFailedSearches: 1
map_ptr1 address: 0x909ce88
map_ptr2 address: 0x909ce88
map_ptr1->size(): 0
map_ptr2->size(): 0
map1.size(): 1
map2.size(): 0
hostname:1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T01:00:22.490

当您的测试代码调用 sGetKeyserverFailedSearch() 时，它会将指针分配给本地地图变量，从而制作地图内容的副本。您对这些变量所做的任何更改都不会反映在您使用 pthread_setspecific() 存储的原始映射中，正如您的日志记录所表明的那样（map1 的大小增加了但 map_ptr1 的大小没有增加）。您想要对原始地图进行的任何修改都必须使用 sGetKeyserverFailedSearch() 返回的指针来完成，例如：

```
FailedSearchCacheMap* map_ptr = sGetKeyserverFailedSearch();
std::string ks("hostname");

int numFailedSearches = (*map_ptr)[ks] + 1;
(*map_ptr)[ks] = numFailedSearches;

std::cout << "numFailedSearches: " << numFailedSearches << std::endl;
std::cout << "map_ptr address: " << map_ptr << std::endl;
std::cout << "map_ptr->size(): " << map_ptr->size() << std::endl;

FailedSearchCacheMap::iterator i = map_ptr->begin();
for(; i != map_ptr->end(); i++)
    std::cout << (*i).first << ":" << (*i).second << std::endl; 
```

# search - 如何在 Google 上搜索

> ID：942575
> 
> 赞同：5
> 
> 时间：2009-06-03T00:33:52.620
> 
> 标签：search, meta-tags, author

是否可以在 Google 中搜索由元作者标签声明的特定作者构建的所有网站？

例如[http://www.google.com.au/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=v6J&q=%3Cmeta+name%3D%22author%22+content%3D% 22Fred+Smith%22%3E&btnG=搜索&元=](http://www.google.com.au/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=v6J&q=%3Cmeta+name%3D%22author%22+content%3D%22Fred+Smith%22%3E&btnG=Search&meta=)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T00:35:41.853

看起来答案是否定的：“Google、Yahoo 和 MSN 不索引`<meta>`作者标签。” （[**来源**](http://www.webmarketingnow.com/tips/meta-tags-meta-author.html)）

# scheme - 如何从 Scheme 中的列表中应用匿名函数？

> ID：942580
> 
> 赞同：6
> 
> 时间：2009-06-03T00:34:48.250
> 
> 标签：scheme

我正在学习Scheme。下面的代码有什么问题？我想编写一个程序，从列表中获取第一个函数，然后将其应用于一个数字？

```
 (define num  3)

    ;;I want to do something like this which returns 3
    ((λ (x) x)num)

    ;;but my functions are in a list so this should return3
    ((first '((λ (x) x) (λ (x) (* x x)))) num) 
```

我收到上述代码的此错误：
*程序应用程序：预期程序，给定：（λ（x）x）；论据是：3*

当我得到这些类型的输出时，这意味着什么？

当我不应用任何东西时，我会得到一个不错的输出。

```
(first '((λ(x) x)(λ(x) (*x x)))) 
```

返回 (λ (x) x)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T00:54:26.980

您正在引用 ' lambda，所以它没有被评估。

如果您只是在提示符处输入 (λ (x) x)，DrScheme 会向您显示`#<procedure>`，这意味着它实际上已经评估了 lambda，并给您一个闭包。通过引用它，你只是给了 Scheme 一个符号列表。

如果要将函数放在列表中，可以执行以下操作：

```
((first (list (lambda (x) x) (lambda (x) (* x x)))) num) 
```

引用允许您生成一个列表，是的，但它的内容不被评估。list 函数在对其进行评估后，从其所有参数生成一个列表。

如果您愿意，也可以对列表进行 quasiquote：

```
((first `(,(lambda (x) x) ,(lambda (x) (* x x)))) num) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-07T15:36:12.140

(lambda (x) x) 不是一个过程。它是一种*评估*程序的形式。人们对术语有点松散，并且经常将 lambda 形式称为过程作为一种速记。“Ceci n'est pas une pipe。”</p>

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-11T19:20:44.663

这些表达有什么区别？

```
> (procedure? (lambda (n) n))
#t
> (procedure? (quote (lambda (n) n)))
#f
> (procedure? '(lambda (n) n))
#f 
```

杰伊为你回答了这个问题，但我还不能投票给他。

# authentication - youtube 如何使用您的 gmail 帐户登录？

> ID：942583
> 
> 赞同：1
> 
> 时间：2009-06-03T00:35:21.197
> 
> 标签：authentication, oauth, gmail, youtube

我对他们将如何做到这一点有一个想法，但这样做似乎很老套。

我从中看到的问题是 youtube 需要获取 gmail 或 google cookie。

我这样做的方法是从 gmail 域打开另一个框架，该框架读取 gmail cookie 并将此信息转发到 youtube url。然后，此 youtube url 将根据转发的信息进行身份验证。就像我之前说的那样，这样做似乎很老套，而且可能不是他们这样做的方式。

如果有人知道他们是如何做到的或有任何其他方法可以做到这一点，我想听听。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T00:39:33.357

Google 使用[**OAuth**](http://en.wikipedia.org/wiki/OAuth)（一种适用于各种应用程序的安全 API/授权协议）来让您登录各种服务。**[初学者指南的第二部分](http://www.hueniverse.com/hueniverse/2007/10/beginners-gui-1.html)**，协议工作流程，很好地概述了它是如何工作的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T00:43:06.503

如果您在 firebug 中观看网络活动，您会看到 google 的登录重定向到[http://www.youtube.com/signup?hl=en_US&warned=&nomobiletemp=1&next=/&auth=](http://www.youtube.com/signup?hl=en_US&warned=&nomobiletemp=1&next=/&auth=)。这个加密的字符串很可能带有来自谷歌身份验证服务器的签名身份证明。Youtube 然后验证这一点并设置适当的 cookie。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T00:43:32.867

另外，用一种技术含量较低的方式：YouTube 实际上并没有使用您的 gmail 帐户登录。gmail 和 youtube 都使用您的*Google 帐户登录*。

# asp.net-mvc - 尝试路由以“。”结尾的路径时出现问题。

> ID：942593
> 
> 赞同：0
> 
> 时间：2009-06-03T00:38:26.417
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我正在尝试路由这样的路径：

```
http://www.wikipediamaze.com/wiki/Washington,_D.C. 
```

路由框架没有将此作为有效路由并给我一个“找不到资源”错误。任何人都知道我该如何解决这个问题？它甚至没有到达我的控制器工厂，所以就好像它甚至没有将其识别为路线或可能正在寻找实际文件。

我对这样的类似路线没有任何问题：

```
http://www.wikipediamaze.com/wiki/United_States
http://www.wikipediamaze.com/wiki/Canadian_Bacon_(film) 
```

但是任何时候我都会以“。”结束一个网址。它不路由它。如果我这样做，它会起作用：

```
http://www.wikipediamaze.com/wiki/?topic=Washington,_D.C. 
```

我设置的路线如下所示：

```
routes.MapRoute(
    "wiki",
    "wiki/{topic}",
    new { controller = "game", action = "continue", topic = "" }
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T01:59:13.417

点被解释为文件扩展名的开头，如

```
mypage.mvc or index.aspx 
```

我不知道如何解决它的第一条线索，尽管表格

```
http://www.wikipediamaze.com/wiki/?topic=Washington,_D.C. 
```

对我来说看起来非常清晰简洁。这种形式有效，因为 MVC 自动知道问号后面将跟一个命名参数，而不是另一个部分路由。

# sql - 在 SQL 中安全地更新计数（字段）

> ID：942606
> 
> 赞同：5
> 
> 时间：2009-06-03T00:46:15.980
> 
> 标签：sql, concurrency

我想在 userpost 上实现 SO like 标签。我有一个名为 tag_data 的表，其中包含 tagId、title、count 列。我有一个单独的表格，将帖子与其可能使用的许多标签之间的关系联系起来。

这是问题所在，我如何获取当前计数，将其增加或减少一并安全存储。所以在我选择和更新之间没有其他连接/线程会更新它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-03T00:56:11.670

我假设你也想要新的计数，否则这很简单，只需更新 set count=count+1。

如果您的数据库在 UPDATE 上支持输出子句（例如 SQL Server 2K5 或 2K8）：

```
UPDATE table
   SET count = count + 1
   OUTPUT inserted.count
   WHERE id=@id; 
```

除此以外：

```
begin transaction
update table 
    set counter=counter+1
    where id=@id;
select counter
    from table
    where id=@id;
commit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:35:13.320

SET Count = Count + 1 是恕我直言最简单的解决方案..

更一般地说，如果您还需要一个可扩展的系统，那么能够获取数据、处理数据以及在处理数据时要求在编写处理结果之前没有任何潜在变化的概念通常是不合理的。

您当然可以这样做，并且在许多环境中都可以摆脱它。但是，在并发问题导致系统无法使用之前，这些方法将严重限制应用程序的可伸缩性和复杂性。

恕我直言，更好的方法是采取乐观的方法并检测/重试，如果在不寻常的情况下您关心的事情确实发生了变化。

SELECT Count AS old ... FROM ...

.. 加工 ...

UPDATE ... SET Count = oldplus1 WHERE Count = old AND ...

除非 UPDATE 为您提供您期望的行数，否则您假设数据已被修改并重试直到成功。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-03T00:56:19.610

伪代码：

```
begin transaction
A = select count from tag_data where tagId = TagId
update tag_data set count = A+1 where tagId = TagId
commit
end transaction 
```

我强烈建议制作一个名为的存储过程，例如，`increment_tag(TagId)`执行上述操作:)

# mysql - 错误“mysql 无法获取模式表状态”

> ID：942609
> 
> 赞同：0
> 
> 时间：2009-06-03T00:47:39.910
> 
> 标签：mysql, host

当我尝试使用 MySql Administrator 备份或列出数据库表时，会出现错误**mysql could not fetch schema table status 。**

[我对 MySql 错误（id=28140）和 MySql 论坛（ http://forums.mysql.com/read.php?34,169966,170024#msg-170024](http://forums.mysql.com/read.php?34,169966,170024#msg-170024) ）做了一些研究。他们的解决方案谈到了 McFee。

实际上我租了一个 Windows 2003 VPS 主机并且我没有安装任何防病毒软件。你知道它到底是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T01:56:31.270

实际上，mysql bug 28140 有两种解决方案；其中一个处理 McAffee，但另一个说如果您的 TEMP 或 TMP 环境变量指向不存在的目录，或者 mysql 无权写入的目录，则可能会发生这种情况。你试过吗？

# jsp-tags - 显示标签导出选项横幅 - 放置在表格顶部

> ID：942613
> 
> 赞同：0
> 
> 时间：2009-06-03T00:49:01.700
> 
> 标签：jsp-tags, displaytag

我正在使用 displaytag 标签库，到目前为止，它的效果非常好。但是，我没有看到将导出横幅放在表格顶部而不是底部的简单选项或方法。如何实现？

谢谢，罗伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T09:50:12.933

我和你有同样的问题。我使用 jquery 解决了这样的问题：

我的 displaytag.properties ：

```
export.banner=<div id="export" class="exportlinks">Exporter : {0}</div> 
```

我在 JSP 中使用 DisplayTag 创建的表：

```
<div id="datagrid">
    <div class="datagrid">
        <display:table name="sessionScope.resultats" sort="list" defaultsort="2" pagesize="<%=nombreLignes %>" export="true">
            <display:column property="code" title="<%=codeLabel %>" sortable="true" href="javascript:edition(document.forms[0], '#')" paramId="code" paramProperty="code" style="width:20%;" />
            <display:column property="nom" title="<%=nomLabel %>" sortable="true" href="javascript:edition(document.forms[0], '#')" paramId="code" paramProperty="code" style="width:80%;" />
            <display:setProperty name="export.pdf" value="true" />
            <display:setProperty name="export.csv.filename" value="${nomExport }.csv"/>
            <display:setProperty name="export.pdf.filename" value="${nomExport }.pdf"/>
        </display:table>
    </div>
</div> 
```

jquery 中的一个函数：

```
$(function()
{
    var export1 = document.getElementById('export');
    if(export1 != null)
    {
        // 2 duplications
        var export2 = export1.cloneNode(true);
        var export3 = export1.cloneNode(true);
        var datagrid = document.getElementById('datagrid');

        // Placement on top 
        datagrid.insertBefore(export2, datagrid.firstChild);

        // Placement on bottom
        datagrid.parentNode.insertBefore(export3, datagrid.nextSibling);

        // Delete node generated by DisplayTag
        export1.parentNode.removeChild(export1);
    }
}); 
```

结果：

![在此处输入图像描述](https://i.stack.imgur.com/hcsw8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-21T09:15:24.163

请添加以下代码：

```
$(function()
  {

  // Placement on top.#row is display tag id
  $( ".exportlinks" ).insertBefore( "#row" );

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-07T22:14:45.437

我们已经能够使用一些针对“exportTypes”id 的 css 将导出菜单放在顶部。我不是在我们团队中做这件事的前端人员，所以可能还有更多，但看起来你可以做类似的事情：

```
div.framed-outer.guttered #exportTypes {
    *top: -10px;
} 
```

frame-outer 和 guttered 只是我们使用的桌子周围的一些 div id。

在我们定义的 displaytag.properties 中：

```
export.banner=<div id="exportTypes"><span class="label">Export: </span>{0}</div> 
```

同样，这可能不是故事的全部，但这就是我可以看到在我们的项目中可以做到的。希望这个对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-25T20:23:02.100

我知道这已经 10 年了，但以防万一有人去寻找一个简单且有效的答案，以下对我有用。我注意到 displaytag 将所有内容都放在了 TBODY 中，所以我决定尝试将 Export 包装在 THEAD 中，果然它起作用了。

我在 displaytag.properties 文件中放置了以下内容：

```
export.banner=<thead><tr><td><div class="exportlinks">Download: {0}</div></td></tr></thead> 
```

# linq - 用于组合列表的 lambda 扩展

> ID：942615
> 
> 赞同：0
> 
> 时间：2009-06-03T00:49:42.853
> 
> 标签：linq, lambda

我如何使用第二个表达式从第一个表达式中仅选择具有 ID 的那些？

```
 var list1= from x in objects select x.id;

 results=results.Where(r=>r.id==  ????  ) 
```

我希望结果只有那些来自 listA 的 id

蒂亚

编辑：我已纠正，还有另一个问题导致问题，我将单独询问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T00:52:51.350

像这样...

```
results.Where(r=>list1.Contains(r.id)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T00:53:50.647

```
results = results.Where(r => list1.Contains(r.id)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T01:33:14.543

有点猜测（没有尝试过运行它），但是：

```
var filteredResults = from obj in objects 
                      join result in results on obj.id equals result.id
                      select result; 
```

请注意，这应该替换您问题中的两行代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T00:57:23.290

如果您想要一些性能（list.Contains() 具有 O(n) 复杂性），您可以使用

```
var ids = objects.ToDictionary(o => o.id);

results.Where(o => ids.ContainsKey(o.id)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T01:19:47.067

也许你想要这个？

results.Where(r=> objects.Any(o => o.id == r.id) )

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T02:37:33.510

如果您总是只需要第一个元素的 ID ，则可以将其存储到变量中并将其用于 lambda 表达式

```
var results= from x in objects select x.id;
int firstID = results.First().id ;
results=results.Where(r=>r.id==  firstID  ) 
```

或者，像这样直接使用：

```
var results= from x in objects select x.id;
results=results.Where(r=>r.id==  results.First().id  ) 
```

# delphi - TcxGrid 中的值更改后如何触发事件处理程序？

> ID：942619
> 
> 赞同：2
> 
> 时间：2009-06-03T00:51:17.517
> 
> 标签：delphi, event-handling, devexpress, tcxgrid

我有一个 DevExpress TcxGrid，它的 GridView 的 OnEditValueChanged 事件附加了一个事件处理程序，该事件应该汇总其中一列中的一些数据。问题是，在更新值写入基础数据集之前，此事件在验证期间被触发。我对 TcxGrid 不太熟悉。有谁知道在数据集更新*后*是否有办法触发事件处理程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T02:46:02.667

使用 DataSource.OnDataChange 事件怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T08:03:40.387

我不确定这是否正是您所需要的，但我发现网格的 ImmediatePost 选项对于我需要更新摘要的情况非常有用 - 它隐藏在 cxView 的数据控制器属性下。这使得网格就像电子表格一样——只要用户在单元格中按下回车键或制表符，记录就会被发布。然后我会从数据集的 AfterPost 事件中触发我的汇总事件，也许？

（您可能已经知道这一点，但 gridview 本身内置了许多非常有用的汇总选项 - 查看列的 Summary 属性，并确保在 ViewOptions 中将 ShowFooter 设置为 true - 所以如果您的摘要是一个相对简单的总数或平均值或类似的，让网格完成所有工作并为自己节省一些工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T07:26:49.743

你用cxGrid中的cxTableView还是cxDBTableView

如果您使用 cxDBTableView，那么您在 cxDBTableView 的属性中的链接数据源的 datasource.onchange 中设置您的事件。(cxDBTableView.datacontroller.datasource)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T07:29:39.317

我会选择 skamradt ：更仔细地寻找符合您期望的事件。

否则，您可以在确保数据已初始化后插入您的事件：

```
 procedure TMyGrid.MyProc_OnDataLoaded( Sender : TObject ); //I made up this event, I'm not sure it exists
 begin
   Self.OnEditValueChanged := MyProc_OnEditValueChanged;
 end; 
```

我强烈建议您不要将其用作常规的开发习惯（通过代码使事件设置另一个回调是调试地狱的可靠方法），但如果您真的找不到任何其他方法...

# python - Django 中缺少“中值”聚合函数？

> ID：942620
> 
> 赞同：12
> 
> 时间：2009-06-03T00:51:25.143
> 
> 标签：python, django, aggregate-functions

Django 的开发版本具有聚合函数，如 Avg、Count、Max、Min、StdDev、Sum 和 Variance（[链接文本](http://docs.djangoproject.com/en/dev/ref/models/querysets/#id8)）。列表中缺少中位数是否有原因？

实施一个似乎很容易。我错过了什么吗？聚合函数在幕后做了多少？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-02-29T16:56:05.703

这是您缺少的功能。将查询集和要为其查找中值的列的名称传递给它：

```
def median_value(queryset, term):
    count = queryset.count()
    return queryset.values_list(term, flat=True).order_by(term)[int(round(count/2))] 
```

这并不像其他一些回应似乎表明的那么难。重要的是让 db 排序完成所有工作，所以如果你已经为列建立索引，这是一个超级便宜的操作。

*（2016 年 1 月 28 日更新）* 如果您想对偶数个项目的中位数定义更严格，这将平均两个中间值的值。

```
def median_value(queryset, term):
    count = queryset.count()
    values = queryset.values_list(term, flat=True).order_by(term)
    if count % 2 == 1:
        return values[int(round(count/2))]
    else:
        return sum(values[count/2-1:count/2+1])/Decimal(2.0) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-03T03:27:26.280

因为中位数不是 SQL 聚合。例如，请参阅[PostgreSQL 聚合函数](http://www.postgresql.org/docs/8.3/static/functions-aggregate.html)列表和[MySQL 聚合函数列表](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T00:57:17.037

好吧，*原因*可能是您需要跟踪所有数字来计算中位数。Avg、Count、Max、Min、StDev、Sum 和 Variance 都可以根据恒定的存储需求进行计算。也就是说，一旦你“记录”了一个数字，你就再也不需要它了。

FWIW，您需要跟踪的变量是：最小值、最大值、计数、`<n>`= 平均值、`<n^2>`= 值平方的平均值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T03:56:12.847

我不知道您使用的是什么数据库后端，但是如果您的数据库支持另一个聚合，或者您可以找到一种巧妙的方法，您可以通过[Aggregate](http://code.djangoproject.com/browser/django/trunk/django/db/models/aggregates.py)轻松访问它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T00:59:05.863

一个很大的可能性是中位数不是标准 SQL 的一部分。

此外，它需要一种排序，因此计算起来非常昂贵。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-06T11:09:41.053

[FWIW，您可以使用这些代码片段](http://wiki.postgresql.org/wiki/Aggregate_Median)扩展 PostgreSQL 8.4 及更高版本以具有中值聚合函数。

[此处显示了](http://www.postgresonline.com/journal/archives/67-Build-Median-Aggregate-Function-in-SQL.html)其他代码片段（适用于旧版本的 PostgreSQL）。请务必阅读此资源的评论。

# c# - 如何在没有防病毒问题的情况下安装 .NET Windows 服务

> ID：942629
> 
> 赞同：1
> 
> 时间：2009-06-03T00:54:55.730
> 
> 标签：c#, .net, windows-services, installation, antivirus

我正在用 C# 制作我的第一个 Windows 服务，目前这是一个看起来很天真的东西，还没有做任何事情。

但是，我发现当我尝试安装它时，无论是使用 Visual Studio 中的标准安装项目，还是使用[此处](http://www.codeproject.com/KB/dotnet/WinSvcSelfInstaller.aspx)概述的简单“自安装程序” ，我们公司的防病毒软件都不允许安装，因为它是一个[“看起来很可疑的服务”（ HIPS/RegMod-013)](http://www.sophos.com/security/analyses/suspicious-behavior-and-files/hipsregmod013.html)。

现在，我安装的所有其他第三方服务中的服务都不会发生这种情况。我的服务有什么可能使它看起来可疑？我也尝试对程序集进行签名（仅使用 VS 生成的密钥文件），但没有运气。

还有其他人经历过吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:32:55.903

可能的第一个行动方案是将您的文件作为误报[提交并要求他们（我们）查看它。](https://secure.sophos.com/support/samples/)提及您正在开发文件，并想知道触发警报的原因，他们可能会告诉您。

否则，请查看您的服务正在执行哪些注册表更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T08:09:31.247

我自己的服务没有问题（我们在我们的组织中也使用 Sophos），但我在安装某些程序（例如 Folding@Home）时看到了它。

它似乎与对注册表所做的更改有关，因为 Folding@Home 将某些数据存储在注册表中，但我自己的 Windows 服务更改了注册表并且没有这个问题。我会接受 Douglas 的建议，将其提交给 Sophos，看看他们怎么说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T01:05:53.960

根据 SOPHOS 网站，是否继续安装由您决定。由于这是由 SOPHOS 行为引擎拾取的，我认为除了在安装期间停止 SOPHOS 之外，没有办法解决它。

您当然可以尝试不同的防病毒程序，或者如果这不是一个选项，那么只需在您的发布/安装说明中包含 SOPHOS 屏幕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T01:11:49.410

你的操作系统是什么？我猜是因为你的杀毒软件，可能是你可以改变设置。尝试。

# javascript - 在 Javascript 中加入多个事件处理程序

> ID：942644
> 
> 赞同：2
> 
> 时间：2009-06-03T01:01:17.777
> 
> 标签：javascript

如何在 Javascript 中加入多个事件处理程序，如下所示：

```
onClick="doSomething();" onKeyUp="doSomething();" onLoad="doSomething();" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T01:04:43.963

```
function doSomething(){ console.log("Done!"); }
var element = document.getElementById("my-element");
element.onClick = element.onKeyUp = element.onLoad = doSomething; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:37:46.437

我建议使用 javascript 库的代码来添加事件，以从您自己身上抽象出浏览器的差异。

我还建议将事件本身传递给函数（原型和 jquery 都这样做）。

```
<script>
function doSomething(event){
  /*your code here*/
  /*this refers to the dom node in both libraries*/
};
</script> 
```

[jQuery](http://docs.jquery.com/Events/bind#typedatafn)

```
<script src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.js"></script>
<script>
  $("my-element").bind("click keyup load", doSomething);
</script> 
```

[原型](http://www.prototypejs.org/api/event/observe)

```
<script src="http://www.prototypejs.org/assets/2008/9/29/prototype-1.6.0.3.js"></script>
<script>
  $('my-element').observe('click', doSomething);
  $('my-element').observe('keyup ', doSomething);
  $('my-element').observe('load', doSomething);
</script> 
```

# ruby-on-rails - 为什么我应该使用 Ruby on Rails？

> ID：942645
> 
> 赞同：14
> 
> 时间：2009-06-03T01:02:49.130
> 
> 标签：ruby-on-rails

我的一个朋友问我是否知道 Ruby on Rails……坦率地说，我听说过很多关于它的事，但实际上对它一无所知。任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T01:06:30.230

Ruby on Rails 是一个用于构建 Web 应用程序的框架。如果更倾向于约定而不是配置，这意味着很多选择都有合理的默认值，因此您可以毫不费力地运行某些东西。

更多信息在这里：[http ://rubyonrails.org/](http://rubyonrails.org/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T02:18:41.240

除了默认的脚本/生成器（为您制作脚手架、模型、控制器等）之外，Ruby on Rails 有许多方便的插件可以为您处理大部分工作，以及大量的工具跟踪代码中的错误、错误和瓶颈。我在下面概述了一些示例。

**方便的插件**

*   Subdomain-fu 允许您在几分钟内设置和使用子域
*   Active Scaffold 设置了与数据库交互的漂亮的默认“管理”页面
*   RestfulAuth 是一个基本的、易于使用的身份验证系统

**代码测试**

*   RSpec 可让您编写清晰、有意义的测试，并对输出进行颜色编码
*   Cucumber 让你编写更清晰的测试
*   Metric-fu 测试您的代码重复、复杂性等

还有很多关于 Ruby on Rails ( [Railscasts](http://www.railscasts.com) ) 的视频教程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T10:31:06.983

为什么要使用它？只是为了尝试新事物。Ruby 改变了我以前的许多编程方式，现在它是我最喜欢的语言。Rails 结合了所有好的实践，并向人们展示了现在友好的框架。

花两周时间学习 Ruby + RoR 是值得的，真的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T09:24:31.407

为什么要使用它？因为您要开发面向动态数据库的 Web 应用程序。

如果你想开发其他东西，Rails 可能会变得非常烦人，尽管它附带的一些组件（例如 ActiveRecord）本身就很有用。

如果问题真的应该是“为什么在其他 Web 应用程序框架上使用 Rails？” 那么在SO上已经有很多要阅读的内容了：

*   [为什么在 php 上使用 web 框架（如 rails）？](https://stackoverflow.com/questions/873195)
*   [Django 或 RoR](https://stackoverflow.com/questions/732476)
*   [特征区分 Rails/Django](https://stackoverflow.com/questions/453448)

例如...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-10T20:18:06.210

我最近写了一篇关于这个的博客文章，它涵盖了使用 Rails 构建 Web 应用程序的一些利弊（免责声明：我经营一家 Rails 咨询公司，但我尽量做到公正）：

[http://blog.bitzesty.com/what-is-ruby-on-rails-and-why-should-i-use-it](http://blog.bitzesty.com/what-is-ruby-on-rails-and-why-should-i-use-it)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T02:01:38.263

FWIW - 通过查看 Ruby 在流行度方面相对于其他常用语言的排名可以获得一个有趣的观点（充其量是一个主题衡量标准）：[TIOBE Programming Community Index](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)。我不会对此进行太多解读，但它确实提供了一些视角。

# documentation - 是否存在系统架构/设计提案的模板？

> ID：942647
> 
> 赞同：2
> 
> 时间：2009-06-03T01:03:43.480
> 
> 标签：documentation

我需要准备一个新项目开发中的技术规范提案，我之前所做的是包括以下内容：

*   **平台**系统将被编程的主要技术和次要技术
*   **OS Target**系统将在其中运行的目标
*   **Web 应用程序中的**应用程序服务器****
***   **应用程序模块**应用程序将组成的主要模块或层。*   **架构概述**一些关于模块如何在应用程序内部交互的简要说明*   **交互**系统如何与其他系统交互**

 **除此之外，有时值得指定一些内容，例如：

*   **SCM**如果我使用 CVS、SVN、git
*   **数据库**有时我觉得有必要列出使用特定 RDBMS 的原因

我知道我可能完全错了（这就是我在这里问这个的原因）所以我想知道。是否存在架构规范的模板？如果不是 - 这是最可能的 - 您建议在该文档中包含哪些内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T01:08:57.697

您可能希望将部分 Rational Unified Process (RUP) 用于文档模板。您可以参考这个问题来了解一些开源替代方案：[Rational Unified Process Alternative for Documentation and Templates？](https://stackoverflow.com/questions/337708/rational-unified-process-alternative-for-documentation-and-templates)

# haskell - Haskell 中的错误处理与 Either monad

> ID：942651
> 
> 赞同：6
> 
> 时间：2009-06-03T01:04:44.463
> 
> 标签：haskell, error-handling, type-inference, monads

我有一个函数可以检查一个类型是否是另一种类型的子类型：

```
st :: Monad m => Map String Type  -- ^type environment
   -> Set (Type, Type) -- ^assumed subtypes
   -> (Type, Type) -- ^we are checking if lhs <: rhs      
   -> m (Set (Type, Type)) 
```

我想做错误处理。我有以下定义：

```
instance Monad (Either String) where
  return v = Right v
  fail s = Left s
  (Left s) >>= _ = Left s
  (Right v) >>= f = f v 
```

有时我可以通过将 st 的结果视为 Either 来进行错误处理。例如，以下函数有效，并获取我在 st 中调用“失败”所产生的消息：

```
isSubType env cs t1 t2 = result where
  result = case st env (S.empty) (t1, t2) of
    Left msg -> Left msg
    Right rel -> Right () 
```

现在，我在 st 里面，我想递归地调用它。出于某种原因，以下代码嵌套在 st 深处：

```
 let do_t1 rel t1 = case st env rel (t1, t2) of
        Left msg -> fail $ printf "type %s in the union is not a subtype\
                           \ of the rhs, %s, because: %s" (renderType t1)
                           (renderType t2) (show msg)
        Right rel -> return rel 
```

不输入检查，但给我以下错误：

```
 No instance for (Monad (Either t))
      arising from a use of `st'
                   at src/TypedJavaScript/Types.hs:386:24-42
    Possible fix: add an instance declaration for (Monad (Either t)) 
```

为什么将 st 的结果视为 Either 在 'st' 之外工作而不在内部工作？如何更改我的代码以使其也可以在内部工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T01:55:31.193

我认为问题是你打电话给`show msg`你应该使用的地方`msg`。结果，编译器无法推断出您的意思`Either String`；它所知道的就是你有满足`Either t`约束的地方`Show t`。替换`show msg`为`msg`应该修复它。

# python - 学习 VTK 库工具包的推荐资源和教程有哪些？

> ID：942657
> 
> 赞同：8
> 
> 时间：2009-06-03T01:06:12.133
> 
> 标签：python, vtk

除了[Kitware](http://www.vtk.org/VTK/help/book.html)提供的书籍之外，我还在寻找一些可以帮助学习 VTK 库的资源的链接。最好带有示例代码和教程。谷歌搜索结果对我来说信息量不是很大。所以我在这里询问VTK资源的链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T02:13:47.037

我在上一个项目中使用了 vtk。不过，我将它与 C++ 一起使用，而不是 python。

我记得论坛、wiki 和邮件列表有很多有用的信息和乐于助人的人：

[http://www.vtk.org/VTK/project/getinvolved.html](http://www.vtk.org/VTK/project/getinvolved.html)

[http://www.vtk.org/VTK/resources/applications.html](http://www.vtk.org/VTK/resources/applications.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-10T17:41:54.403

*   可以购买[官方书籍](http://www.vtk.org/VTK/help/book.html)
*   你可以检查一些[免费的](http://www.bioimagesuite.org/vtkbook/index.html)
*   您一定要查看[WIKI上的示例](http://www.vtk.org/Wiki/VTK/Examples)
*   你可以看看[源码](http://vtk.org/gitweb?p=VTK.git;a=blob;f=Examples/Tutorial/Step1/Python/Cone.py;h=2d7c9a5712bdcf9d8e51fbd77cdc29be9cd921ad;hb=HEAD)
*   本[教程](http://tcltk.co.kr/files/simplescript.pdf)是一个很好的入门。它是关于 Tcl 的，但将这些示例翻译成其他语言应该是微不足道的。
*   [您可以按照建议在vtk-users](http://www.vtk.org/mailman/listinfo/vtkusers)邮件列表中询问`Maggie`。

# coldfusion - 模型-胶水和 Railo 应用程序.cfc

> ID：942664
> 
> 赞同：0
> 
> 时间：2009-06-03T01:08:09.807
> 
> 标签：coldfusion, railo, application.cfc, model-glue

我正在尝试在 Railo 上启动一个测试 MG 应用程序，但遇到了障碍。当我访问 MG 应用程序时，我得到：

```
Railo 3.1.0.012 Error (Java.lang.classformaterror)
Message         Invalid index 16 in LocalVariableTable in class file
application_cfc$cf
Java Stacktrace

Invalid index 16 in LocalVariableTable in class file application_cfc
$cf
        at java.lang.ClassLoader.defineClass1(Native Method):-2
        at java.lang.ClassLoader.defineClass(ClassLoader.java:621):621
        at java.lang.ClassLoader.defineClass(ClassLoader.java:401):401
        at railo.commons.lang.PhysicalClassLoader.loadClass
(PhysicalClassLoader.java:116):116
        at railo.runtime.PageSourceImpl.compile(PageSourceImpl.java:225):225
        at railo.runtime.PageSourceImpl.loadPhysical(PageSourceImpl.java:167):
167
        at railo.runtime.PageSourceImpl.loadPage(PageSourceImpl.java:102):102 
```

我做了一些测试，发现当 Application.cfc 中发生以下情况时：

```
<cfloop from="1" to="#arrayLen(mgInstances)#" index="i">
    <cfset mgInstances[i].executeEvent(arguments.eventName, values) />
</cfloop> 
```

我得到了错误。如果我删除这部分，我开始得到：

```
Message         Application context not loaded!
Error Code
org.coldspringframework.webApplicationContextProxy.cantLoadApplicationContext 
```

所以，我猜在 Application.cfc 中，这一行：

```
<cfset var mgInstances = createObject
    ("component","ModelGlue.Util.ModelGlueFrameworkLocator").findInScope
    (appScope) /> 
```

正在失败。

还有其他人有这个问题吗？有什么解决办法吗？谢谢！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-25T15:30:34.100

在 Railo 3.1 最终版（或以下补丁之一）中，我们将在 Railo 管理员中有一个兼容性选项卡，允许您将 passby 值设置为 Railo 中的默认行为。然后，您可以启用此设置，从而使 Transfer 和 ModelGlue III 运行良好。这里只是一个旁注是 passby 属性不会破坏现有的 CF 代码。它只是被视为 CFARGUMENT 元数据。

老实说，我们将此视为 Coldfusion 中的一个错误，但由于兼容性要求，我们将调整此行为并使其在 Railo Administrator 中成为可选。

Gert Franz Railo 开源

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-05T01:35:40.853

需要考虑的一件大事：在 CFML 语言的历史中，通过值而不是通过引用传递数组一直是标准行为。与许多其他编程语言的行为相反，这从语言的早期就已经存在，但是从什么时候开始 CF 有任何违反约定的问题？（例如，数组以 1 而不是 0 开始编号）。

另一方面，Railo 通过引用**而不是**值传递数组作为其默认行为。您可以看到这会如何导致其他框架出现问题。为了解决这个兼容性问题，Railo 允许您使用 cfargument 标记的“passby”属性将任何参数指定为值或引用。像这样：

```
<cfargument name="myArray" type="array" required="true" passby="value" /> 
```

当然，这意味着必须为 Railo 重写一些框架，因为这破坏了与 Adob​​e ColdFusion 的完全兼容性。

由于此特定问题以及 Railo 和 CF8 之间的其他行为故障，现在 Railo 上的 Transfer ORM 已完全损坏。Model Glue 和其他现有的 CF 框架不太可能出现类似的故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T12:10:14.117

我会将此记录为[railo bug tracker](https://jira.jboss.org/jira/browse/RAILO)中的错误。他们通常非常擅长解决这些错误，以便流行的冷融合框架在他们的平台上运行。

# macos - 在“git svn clone”之后看不到 repo “在 Mac Leopard 上

> ID：942665
> 
> 赞同：0
> 
> 时间：2009-06-03T01:08:11.943
> 
> 标签：macos, git-svn

我们在办公室使用 SVN，我正在尝试自己使用 git-svn。

我在 /usr/local/code/git 中创建了一个目录，并将我的结帐到 /testco。

我使用了手册页中给出的命令 git svn clone ，我的仓库在哪里。

它遍历了 SVN 主干中所有文件的几百行，但是当它完成时，目录只包含一个 .git 文件。其他文件都不存在。有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T10:12:07.193

您需要类似以下内容：

```
git svn init -t foo/tags -b foo/branches -T foo/trunk path_to_repo
git svn fetch 
```

对于一个真正好的介绍`git-svn`，检查[`git-svn`是网关药物](http://www.robbyonrails.com/articles/2008/04/10/git-svn-is-a-gateway-drug)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-30T12:03:22.567

看起来 git 忘记签出您的文件。做：

```
git checkout master 
```

# asp.net - 将 Hiddenfield 附加到 HTML 标记

> ID：942667
> 
> 赞同：0
> 
> 时间：2009-06-03T01:09:19.257
> 
> 标签：asp.net

我将一个对象附加到我的 aspx 页面。由于对象的类型是在运行时确定的，因此我希望能够将此对象的类型参数的值设置为我在运行 Web 应用程序时设置的隐藏字段值。

```
<asp:HiddenField ID="hiddenField1" runat="server" />

<object id="myObject"
        type="hiddenfield1.value???">
</object> 
```

正如您在上面的代码片段中看到的，我需要将类型设置为隐藏字段的值。我该怎么做。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T01:22:26.783

我不知道我是否理解正确，但是您想以隐藏值将对象的类型传递给客户端？

好吧，我会做这样的事情：

```
<asp:HiddenField ID="ObjectType" runat="server" value="<%= typeOf(MyObject).toString() %>" /> 
```

我最近卸载了visual web developer，所以我不能真正告诉你这是否有效，但它应该。

如果这不是您想要的或者不起作用，请给我留言。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T01:48:31.660

给你一些想法：

1.  使对象成为服务器控件 - runat="server" - 然后在代码隐藏中将 'type' 属性设置为 HiddenField1.Value（即 Object1.Attributes["type"] = HiddenField1.Value。我在快速测试中尝试了这个但是当我设置 runat="server" 时设置对象的 classid 属性有问题。可能需要一些摆弄。
2.  完全在字符串变量中的代码隐藏中生成 HTML Object 标记，然后将其注入到 Literal 控件中。在生成字符串变量时，请引用 HiddenField1.Value。（即`string myObject = "<object id="Object1" classid="..." type='" + HiddenField1.Value + "' ></object"`）。
3.  使用 JavaScript（或 JS 框架）将 'type' 值设置为呈现的隐藏字段的值。

# .htaccess - 如何使用 php 转换此 url？

> ID：942675
> 
> 赞同：0
> 
> 时间：2009-06-03T01:14:20.073
> 
> 标签：.htaccess, mod-rewrite

我有这样的页面：

```
page.php?id=1&name=whatever 
```

我怎么能把它变成...

```
page/1/whatever 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T01:18:28.880

这个问题以前[至少提出过一次](https://stackoverflow.com/questions/912217/can-i-do-use-a-direct-url-like-twitter-or-myspace-in-php/912231#912231)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T01:25:46.150

对不起，我是愚蠢的。我用这个...

```
RewriteRule ^page/([^/]+)/([^/]+)$ page.php?id=$1&name=$2 [L,QSA] 
```

# c - 递归释放 C 结构体

> ID：942676
> 
> 赞同：6
> 
> 时间：2009-06-03T01:14:56.657
> 
> 标签：c, struct, malloc

我有一个结构，它只包含指向我分配的内存的指针。有没有办法递归地释放作为指针的每个元素，而不是在每个元素上调用 free？

例如，假设我有这个布局：

```
typedef struct { ... } vertex;
typedef struct { ... } normal;
typedef struct { ... } texture_coord;

typedef struct
{
    vertex* vertices;
    normal* normals;
    texture_coord* uv_coords;
    int* quads;
    int* triangles;
} model; 
```

在我的代码中，我 malloc 每个结构来创建一个模型：

```
model* mdl = malloc (...);
mdl->vertices = malloc (...);
mdl->normals = malloc (...);
mdl->uv_coords = malloc (...);
mdl->quads = malloc (...);
mdl->triangles = malloc (...); 
```

像这样释放每个指针很简单：

```
free (mdl->vertices);
free (mdl->normals);
free (mdl->uv_coords);
free (mdl->quads);
free (mdl->triangles);
free (mdl); 
```

有没有一种方法可以递归地遍历 mdl 中的指针，而不是在每个元素上调用 free ？

（*在实践中，只为每个编写 free() 几乎没有任何工作，但它会减少代码重复并有助于学习*）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-03T01:17:54.247

不是真的——尽管你可以编写一个方法来完成所有六个释放，这样你就不会错过任何一个。

```
void freeModel( model* md1 ) {
    free (mdl->vertices);
    free (mdl->normals);
    free (mdl->uv_coords);
    free (mdl->quads);
    free (mdl->triangles);
    free (mdl);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T01:52:55.240

此类功能未内置于 C 中，但您可以通过滥用宏预处理器来作弊：

```
#define XX_MODEL_POINTERS do { \
  xx(vertices); xx(normals); xx(uv_coords); xx(quads); xx(triangles); \
} while(0) 
```

分配：

```
model *mdl = malloc(sizeof(*mdl));
assert(mdl);
#define xx(N) mdl->N = malloc(sizeof(*mdl->N)); assert(mdl->N)
XX_MODEL_POINTERS;
#undef xx 
```

免费：

```
assert(mdl);
#define xx(N) free(mdl->N); mdl->NULL
XX_MODEL_POINTERS;
#undef xx
free(mdl);
mdl = NULL; 
```

令人讨厌的是，定义`struct model`和定义`XX_MODEL_POINTERS`可能会变得相互不一致，并且无法捕捉到它。出于这个原因，通常最好通过在`XX_MODEL_POINTERS`某处解析 .h 文件来生成 的定义。

C 中的元编程绝非易事。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T01:20:48.783

C 语言没有办法做到这一点，也不可取 - C 不知道每个成员都是通过 malloc 分配的不同指针，并且 C 不包含执行此操作的运行时类型信息支持 - 在运行时访问结构的编译代码只是使用每个成员访问的基指针的偏移量。

最简单的方法是编写一个“FreeModel”函数：

```
void FreeModel(model* mdl)
{
   free(mdl->vertices);
   ... // Other frees
   free(mdl);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-17T20:26:49.003

如果您这样做，请查看talloc [http://talloc.samba.org/ ：](http://talloc.samba.org/)

```
model* mdl = talloc (NULL, ...);
mdl->vertices = talloc (mdl, ...);
mdl->normals = talloc (mdl, ...);
mdl->uv_coords = talloc (mdl, ...);
mdl->quads = talloc (mdl, ...);
mdl->triangles = talloc (mdl, ...); 
```

然后你可以：

```
talloc_free(mdl); 
```

and `talloc` will take care of `free`'ing all the other blocks you called `talloc` with `mdl` as the first argument at allocation time (and it will do this recursively you can do `talloc(mdl->vertices, ...)` and `talloc_free(mdl);` will get that too)

as an aside there is a slight overhead to using talloc because it needs to track what stuff recurse over, but it's not very much.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T01:21:45.783

您可以一起计算所有这些所需的大小并执行一个大 malloc

sizeof(model)+sizeof(vertex)*nVertices... 等等。

将结果分配给 mdl，result+sizeof(model) 分配给模型->顶点...

然后释放它只是一个免费的。

您可能不得不担心对齐问题（取决于您的平台），但这不应该太难弄清楚。另一个问题是它是一个更大的块，如果在内存受限的环境中可能会出现问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T01:18:27.523

把所有免费的都扔到一个函数中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T01:18:34.123

我*不相信*这在任何形式的 C 中都是可能的。

您可以为该特定结构编写一个单独的函数，您可以在其中传递指针并在那里释放它们。

编辑：起床，太晚了，从来没有看到那些答案......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T01:18:48.117

不是那些结构。您可以将另一个条目添加到包含要释放的指针列表的顶级“模型”结构中，然后迭代该列表。但我怀疑该解决方案增加的复杂性和降低的可理解性是否值得。（除非您在顶级“模型”结构中释放的条目集比您在此处显示的要大得多且嵌套更深。）

# iphone - iphone - 在电影播放器 上覆盖透明图像

> ID：942677
> 
> 赞同：0
> 
> 时间：2009-06-03T01:15:13.067
> 
> 标签：iphone

我已经能够成功地将图像覆盖在电影播放器​​的顶部（请参阅 Apple 的 MoviePlayer 示例）。

但是，我想要屏幕上没有控件的效果，当触摸屏幕时，我的叠加层就会出现。

我的想法是创建一个带有透明 png 文件图像的叠加层，并覆盖整个显示器。触摸此透明图像时，将出现叠加控件。

一切正常，除了在电影播放器​​上显示透明图像。即使使用透明的 png，图像也显示为全黑。如果我更改 UIView（覆盖）的 alpha，则无法识别触摸事件。

我显然是直接使用 drawrect() 的新手，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T02:25:10.743

真的不需要使用drawRect。如果您愿意，您可以在 IB 中设置您的视图。

您的问题是找到电影播放器​​视图。你可以尝试两件事。

首先尝试将您的视图添加为应用程序 UIWindow 实例的子视图：

```
[window addSubview:myCustomTransparentTouchView]; 
```

看看它是否有效。

如果没有，请尝试遍历 UIWindow 实例的子视图：

```
for(UIView* aView in [window subviews]){

    NSLog([[aView class] description]);

} 
```

看看我是否看到类似 MPPalerView 或任何可能被称为的东西。

然后，尝试添加您想要的任何视图作为其子视图：

```
[moviePlayerViewThatIFound addSubview:myCustomTransparentTouchView]; 
```

不能保证其中任何一个都会起作用，但它们是可能的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T02:33:00.773

科里，感谢您的评论。

我有一个可行的解决方案......如果我在 initWithFrame 中创建透明图像，而不是尝试在 drawRect 中绘制透明图像，一切都很好。

# javascript - slideDown 和 slideUp 错误

> ID：942678
> 
> 赞同：4
> 
> 时间：2009-06-03T01:16:37.823
> 
> 标签：javascript, jquery, css

我是 jQuery 新手，我已经看到内置的 slideDown()/slideUp() 动画存在问题。我正在使用一个灵活宽度的元素，当我使用该函数时，该元素不会返回到它的全宽。我认为这与 jQuery 查找元素宽度的方式有关。我在适用于 OS X 的 Safari 3 和 Firefox 3.1 中遇到错误。以下是该页面的 html：

```
<div id="archive">
    <h2 class="first open">May</h2>
    <table width="100%" cellspacing="0" cellpadding="0" border="0" class="list">
         <tr class="first">
              <td width="65%"><a href="#">This month</a></td>
              <td align="right">Sunday, May 31   <input type="button" value="Edit"/></td>
         </tr>
    </table>
</div> 
```

和 Javascript：

```
// Enable month names to re-open divs
$("#archive h2").not(":last").wrapInner("<a href='#'></a>").end().find
("a").click(function(event){

event.preventDefault();

var h2 = $(this).parent();

if (h2.hasClass("open")) { // Close

    h2.removeClass("open");
    h2.next().slideUp("fast");

} else { // Open

    h2.addClass("open");
    h2.next().slideDown("fast");

}

}); 
```

这个问题可以通过包装 in 来解决，但随后在 Firefox 中出现了一个新错误，其中 slideDown 动画在接近尾声时跳转。

任何帮助，将不胜感激。

谢谢，布伦丹

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T03:07:27.990

“跳跃”的发生是因为 H2 元素有边距，根据 CSS 垂直边距的规则会[折叠](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)。

在动画开始之前，您有 H2 标题与表格分隔。标题上方和下方有一些边距，表格没有：

```
+--------------------------+
|                          |
|H2: April                 |
|                          |
+--------------------------+
||||||||||||||||||||||||||||
|TABLE in the middle       |
||||||||||||||||||||||||||||
+--------------------------+
|                          |
|H2: May                   |
|                          |
+--------------------------+ 
```

然后表格会平滑地被动画化，只剩下两个标题：

```
+--------------------------+
|                          |
|H2: April                 |
|                          |
+--------------------------+
|                          |
|H2: May                   |
|                          |
+--------------------------+ 
```

然后突然之间没有表格了，这些标题和边距将折叠，给你这样的东西：

```
+--------------------------+
|                          |
|H2: April                 |
|                          |
|H2: May                   |
|                          |
+--------------------------+ 
```

而这种崩溃导致了“跳跃”。

一种可能的解决方案是用填充替换 H2 边距：

```
#archive h2 {
  margin: 0;
  padding: 0.5em 0;
} 
```

填充不会塌陷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T21:07:40.097

所以事实证明，解决方法是将每个表格嵌套在一个 div 中，然后将表格宽度设置为静态宽度。就我而言，“600px”。我做了一些实验，我记得，当 jQuery 找到一个元素的高度时，它会将其设置为 position: abolsute; 可见性：无；，在我的情况下，它留下了 100% 的宽度，没有什么可比较的，呈现为 100px 宽，并且比它应该的高。所以 jQuery 动画到那个高度，然后将一切恢复正常，导致浏览器快速回到实际高度。

# protocols - jabber协议问题

> ID：942684
> 
> 赞同：0
> 
> 时间：2009-06-03T01:18:37.180
> 
> 标签：protocols, xmpp

我的jabber机器人的联系人之一，

其 'subscription' 属性值为 'to'，

根据jabber协议意味着：

****机器人已经订阅了对方的在线状态，但是对方没有订阅我的机器人。****

但是当我登录对方账号时，

我可以看到机器人在线，

为什么会这样？

jabber协议现在乱了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T16:28:48.617

如果你说“我的机器人订阅了 TOshore”或“Shore 订阅了我的机器人”，“from”和“to”会更有意义。

所以，如果机器人的名单有：

```
<item jid='shore@example.com' subscription='to'/> 
```

然后机器人会看到shore的存在，但shore不会看到机器人的存在，假设shore的名册有：

```
<item jid='bot@example.com' subscription='from'/> 
```

由于网络问题等原因，这些状态可能会不同步。在这些情况下，解决问题的最简单方法是删除项目（最终应该有效地删除另一侧的项目），然后重新添加（有关详细信息，请参阅[RFC 3921bis，第 2.5.1 节](http://xmpp.org/internet-drafts/draft-saintandre-rfc3921bis-08.html#roster-delete-request)）：

```
<iq from='bot@example.com/background'
   id='delete_1'
   type='set'>
 <query xmlns='jabber:iq:roster'>
   <item jid='shore@example.com' subscription='remove'/>
 </query>
</iq>
<presence type='subscribe' 
          from='bot@example.com/background' 
          to='shore@example.com'/> 
```

要记住的是，即使订阅方向是所示的，机器人也可能会向岸发送定向存在，在这种情况下，即使他没有订阅机器人，岸也会看到两者的存在。检查 bot 的协议日志，您可能会看到如下内容：

```
<presence to='shore@example.com'/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:05:27.307

我已经有一段时间没有使用 XMPP 了，但是快速重新阅读规范让我认为您混淆了“to”的含义。如果用户在机器人的名单上被列为“to”，那么这意味着用户正在关注机器人的存在，而不是相反。“来自”意味着机器人正在关注——或将接收来自——用户帐户的出席信息节。

你知道用户名册是什么样的吗？如果事情已同步，则用户名册应将机器人列为“来自”。

# c# - C# 中的正则表达式

> ID：942687
> 
> 赞同：0
> 
> 时间：2009-06-03T01:19:22.450
> 
> 标签：c#, linq-to-sql

我正在尝试在 C# 中执行 datacontent.executeCommand("string") 。当我尝试进行插入时，我遇到了麻烦，因为每次条目中都有一个“单词”，我认为这是一个新列，并且我抛出了一个异常。

你怎么把它`'word'`变成`''word''`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T03:47:42.240

正如 Tomas 和 Jason 所建议的，最好使用 SQLParameters 来避免这些问题。

但是，如果它需要进行许多代码更改并且您需要快速修复，那么我会说：您**不需要正则表达式**。你只需要做一个 string.replace

```
string query;
...
query.Replace("'", "''"); 
```

如果我没有正确理解您的 Q 以及您需要更改的唯一“单词”实例，您可以执行以下操作：

```
query.Replace("'word'", "''word''"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T01:28:20.483

您可以使用 \ 转义 SQL 字符串中的字符。但是，我相信对您的问题（以及许多其他问题，如果您从一开始就不这样做，您稍后会遇到）的最佳解决方案是 SQL 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T02:21:57.520

我想欢迎您来到 SQL 注入的美妙世界，由于您执行任意字符串，用户可以通过执行恶意 SQL 来劫持您的数据库；-)

您确实应该使用参数（如 System.Data.SqlClient 中的参数）或使用为您生成的 LINQ 数据模型对象并在这些对象上设置值，然后提交您的更改。让数据访问层转义您的值并保护您免受可能输入包含 SQL 语句（如 DELETE * FROM IMPORT_TABLE）的文本的用户的侵害。

# java - 你建议什么 eclipse GUI builder 插件

> ID：942696
> 
> 赞同：22
> 
> 时间：2009-06-03T01:22:11.213
> 
> 标签：java, eclipse, user-interface, eclipse-plugin

> **可能重复：**
> [Eclipse 的最佳 GUI 设计器？](https://stackoverflow.com/questions/29426/best-gui-designer-for-eclipse)

我正在尝试在 java 中创建用户界面？你建议我使用什么 ui builder？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T02:20:13.513

MyEclipse IDE 带有一个不错的 GUI 构建器[Matisse4MyEclipse](http://www.myeclipseide.com/module-htmlpages-display-pid-5.html)（“借用”自 NetBeans IIRC）。您可能希望将 Java IDE 作为决策过程的一部分，因为这两个决策往往密切相关。

[实例化](http://www.instantiations.com/)也是我用过的另一个可靠的选择，虽然有点贵。CodeGear 显然也喜欢这个工具，因为它已被选入他们的[JBuilder](http://www.codegear.com/article/37695)产品阵容（现在基于 Eclipse）。

您不应忽视的另一个选项是[Eclipse Rich Client Platform](http://wiki.eclipse.org/index.php/Rich_Client_Platform) (RCP)。取决于你问的是谁，它是好是坏，因为它与 Swing 竞争并使用本机操作系统小部件 (SWT)。这是 Eclipse 本身背后的技术，如果您喜欢 Eclipse 的外观和感觉或正在构建工具平台，这可能是一个不错的选择。

FWIW 我从大约 2004 年开始广泛使用[MyEclipse](http://www.myeclipseide.com/)工具，并且对质量和非常合理的价格感到满意。请记住 YMMV，因为每个人都有不同的偏好和要求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T03:00:10.813

我试过很多。在我看来，最好的（对于 Eclipse）是**Google 的 WindowBuilder**。

更多信息请访问[http://www.eclipse.org/windowbuilder/](http://www.eclipse.org/windowbuilder/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T01:28:59.750

你试过[Jigloo](http://www.cloudgarden.com/jigloo/)吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T03:41:31.180

[http://code.google.com/p/visualswing4eclipse/](http://code.google.com/p/visualswing4eclipse/) 是一个非常好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-19T02:39:03.050

将光标放在要创建属性的字段中，然后按 Control+RE

# visual-studio - 使用另一个屏幕中的测试结果视图运行调试测试时，Visual Studio 崩溃

> ID：942711
> 
> 赞同：4
> 
> 时间：2009-06-03T01:30:51.617
> 
> 标签：visual-studio, visual-studio-2008, multiple-monitors

当我尝试在“Microsoft Visual Studio Team System 2008 SP1”上仅在调试模式下运行单元测试并且测试结果视图在主屏幕（我有 2 个监视器）以外的屏幕中打开时，devenv.exe 进程崩溃。你有没有遇到过类似的错误？您找到解决方法了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T01:52:23.570

我以前没有听说过这个问题。如果您可以就该问题向 Visual Studio Connect 提交错误，那就太好了。

*   [https://connect.microsoft.com/VisualStudio](https://connect.microsoft.com/VisualStudio)

客户错误，尤其是容易重现的错误，会被非常认真地对待，并且会被关注。

您还介意在评论中发回错误的 ID 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-05T07:19:10.183

解决了我的场景：这是一个参考问题。完全打开 Fusion 程序集绑定日志记录后，我发现（最近再次从 x86 移动到 x64）我在 web.config 中引用的库在为 x86 编译时是强命名的，但是当我为任何 CPU 重新编译它们时或 x64，我没有使用强命名，因此有一个 null PublicKeyToken。因此，实际上已部署的程序集在运行时不会被框架按名称找到。

错误的引用/程序集绑定问题/配置文件问题似乎是 .NET 的真正症结所在——在很少或没有直接反馈的情况下，有很大的崩溃和烧毁的可能性，在事件日志中很少或没有用处。

# bash - 如何对 ksh93 进行编程以使用 bash 自动完成功能？

> ID：942716
> 
> 赞同：3
> 
> 时间：2009-06-03T01:34:42.920
> 
> 标签：bash, autocomplete, ksh

在[回复 shell question 的评论中](https://stackoverflow.com/questions/933445/a-better-linux-shell/933489#933489)，用户[tinkertim](https://stackoverflow.com/users/50049/tinkertim)说`ksh`使用`bash`自动补全库很容易破解。我最想要的就是使用`bash`AT&T 的自动完成功能`ksh93`。如何才能做到这一点？

`ksh93`一年有几次新版本，所以我正在寻找不涉及修改源代码的解决方案。 `ksh93`可以动态链接新的 C 模块并且是高度可编程的（我在每次击键时运行一个 ksh 函数），所以修改源代码应该是没有必要的。

**注意：**我不是在谈论*文件名*自动完成，这在`ksh`. 我说的是 bash 所做的所有其他美味的自动完成功能，例如`nmh`命令的自动完成选项或 Mercurial 命令的自动完成。像这样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T05:25:37.337

有 Readline 包装器 rlwrap。也许您已经为您的系统准备了一个软件包。

它位于您启动的程序的标准输入之上，它是可配置的并且有点可编程，它保留了历史。

我通常将它用于 Oracle SQL*Plus 之类的东西。

它可能是也可能不是您正在搜索的工具，您必须检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-10T18:13:11.997

除此之外，`set -o emacs`它还`set -o vi`可以激活键盘组合 ESC-\ 以完成文件名。（ESC 进入命令模式，\ 使用自动完成功能来完成尽可能多的文件名。） `set -o vi`当然，它还可以使用命令模式和插入模式这两种模式让您的命令行进行 vi 风格的编辑。

我承认这并不能回答您最初在 ksh 中模拟 bash 式自动完成的问题，但至少您知道如果您之前不知道另一种方法可以让 ksh 构建自动完成。

我还注意到这里有另一个线程，其中包含一些相关的 ksh 自动完成信息，包括 ESC-= 以获取选择列表：[link text](https://stackoverflow.com/questions/1015631/tab-complete-with-ksh-in-emacs-mode-without-bindings)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-13T20:35:12.217

我认为我发现的最简单的方法之一（在我无法访问更改包等的客户端服务器上）是将行编辑器设置为 emacs，`set -o emacs`然后双击 ESC（ESC-ESC）。

这不是最有效的自动完成功能，但它就是我在这里所拥有的，而无需对我的 .profile 进行一些时髦的黑客攻击，并且可能违反使用规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-29T16:07:42.950

绑定 tab 键以调用使用`complete`内置的 bash 脚本，因此在 ksh93 中点击 tab 实际上会运行 bash 来完成文本。

请参阅 [http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html#Programmable-Completion-Builtins](http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html#Programmable-Completion-Builtins) 和 [http://www2.research.att.com/sw/download/man /man1/ksh.html](http://www2.research.att.com/sw/download/man/man1/ksh.html)（查找“键绑定”）了解详细信息

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-02-17T15:32:08.473

尝试按 ESC 然后按 '\' 键。它应该模仿 bash 的自动完成功能。

# c# - 允许用户编辑/添加/移动图像中的项目

> ID：942717
> 
> 赞同：1
> 
> 时间：2009-06-03T01:35:48.563
> 
> 标签：c#, asp.net, javascript, jquery

这就是我想要做的事情：
我有一个图像，假设是一个房间。这将是一个静态图像。

我希望用户能够执行以下操作：
1\. 添加一组图像，如椅子、桌子等。
2\. 移动图像上已有的项目。
3\. 编辑附加到图像的文本。

我还需要将此图像存储在服务器上，以便其他用户可以看到更新。

有任何想法吗？TIA。

*编辑*
我想基本上有一个谷歌地图类型的界面，用户可以添加/编辑/移动给定集合中的项目，而不是只读的。因此，例如，我想让他们拿起一张“椅子”图像并将其滑到房间的图像上，无论椅子实际在哪里。我已经看到在 JQuery 中完成的点点滴滴，但还没有找到一个很好的例子。希望这是有道理的。

*Edit2*
找到了一些与我正在寻找的东西相符的东西。如果其他人需要做这样的事情，我正在研究[OpenLayers](http://www.openlayers.org/)，它在 JS 框架中模仿 GoogleMaps。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:50:16.880

您可以通过使用 IE 上的透明 png hack 和`s by most modern browsers. Store positions in database. Store png`服务器上对 24 位 png 的本机支持来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T04:47:44.467

您可以使用 canvas 元素来实现这一点，但浏览器支持不一致。

正如凯恩在评论中指出的那样，您最好在 Flash 之类的东西中执行此操作（而不是 Silverlight，因为并非所有主要浏览器都支持它）

# asp.net - 在实时服务器上登录失败 - asp.net

> ID：942718
> 
> 赞同：0
> 
> 时间：2009-06-03T01:36:29.063
> 
> 标签：asp.net, forms-authentication

我是 asp.net 的新手，正在尝试在生产服务器上测试我的第一个站点。

我拥有的是一个登录控件“login.aspx”，成功登录后将用户重定向到站点的管理区域。当我在我的 Windows XP 机器上使用 VS2008 测试该站点时，一切正常，我可以登录和管理该站点。我正在使用表单身份验证来处理登录。

当我将站点上传到生产服务器时，情况就不同了。我可以访问 login.aspx 页面。当我输入我的登录详细信息并单击“登录”时，处理页面需要很长时间，最终页面失败。

这是我得到的错误：

```
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified) 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

SQLExpress database file auto-creation error: 

The connection string specifies a local Sql Server Express instance using a database location within the applications App_Data directory. The provider attempted to automatically create the application services database because the provider determined that the database does not exist. The following configuration requirements are necessary to successfully check for existence of the application services database and automatically create the application services database:

If the applications App_Data directory does not already exist, the web server account must have read and write access to the applications directory. This is necessary because the web server account will automatically create the App_Data directory if it does not already exist. 
If the applications App_Data directory already exists, the web server account only requires read and write access to the applications App_Data directory. This is necessary because the web server account will attempt to verify that the Sql Server Express database already exists within the applications App_Data directory. Revoking read access on the App_Data directory from the web server account will prevent the provider from correctly determining if the Sql Server Express database already exists. This will cause an error when the provider attempts to create a duplicate of an already existing database. Write access is required because the web server accounts credentials are used when creating the new database. 
Sql Server Express must be installed on the machine. 
The process identity for the web server account must have a local user profile. See the readme document for details on how to create a local user profile for both machine and domain accounts. 
```

任何人都可以在这个问题上帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T01:50:41.453

你真的*读过*错误信息吗？它准确地说明了问题所在，以及如何解决它:-)

它明确指出“连接字符串使用应用程序 App_Data 目录中的数据库位置指定本地 Sql Server Express 实例。提供者试图自动创建应用程序服务数据库，因为提供者确定该数据库不存在。”

因此，web.config 文件中引用的数据库未上传到生产站点。

将其上传到 App_Data，然后返回给我们。

-Oisin

ps 连接字符串在 Web.config 中。

# c# - 寻找建议：访问数据并填充 List/arraylist/list

> ID：942720
> 
> 赞同：2
> 
> 时间：2009-06-03T01:38:14.097
> 
> 标签：c#, arrays, list, sqldatareader

我想做这样的事情：

1.  使用数据读取器访问数据库中的记录。我不知道会返回多少条记录——大部分时间在 1 到 300 条之间。对于每条记录，数据将类似于“0023”、“Eric”、“Harvest Circle”、“Boston”。
2.  我想立即填充一些东西（数组，列表？）并关闭连接。
3.  将填充的对象传递回我的 web 服务，在发送到客户端之前，我会将其转换为 JSON。

我遇到的问题是使用数据读取器中的数据填充哪些对象/对象。我开始使用 ArrayList（现在已经阅读了有关使用 List 的信息），但是虽然我可以取回所有记录（在本例中只有 2 个项目），但我无法访问每个项目中的各个字段（埃里克，波士顿， ETC）。

进入Plan B：在datareader 中foreach 记录，将各个列的值添加到一个数组中，然后将每个数组添加到List 中。我认为这会起作用，但是当我不知道需要实例化多少个数组时，我不确定如何实例化一个数组。换句话说，我通常会这样做 string[] myarray = new string[]{"eric", "boston", "etc"};

但是如果我有多个记录，那会是什么样子？填充数组，添加到列表，清除原始数组然后重新填充，将其添加到列表等？

任何帮助将不胜感激！此外，我对这样做的其他方法持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T01:43:13.650

这里的标准答案是不使用像实体框架这样的持久层，而是使用您需要的字段创建“实体”类。就像是：

```
class Customer
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

...然后将这些收集到某种集合中。A`List<Customer>`没问题。

```
List<Customer> customers = new List<Customer>();

string connectionString = null;
using (SqlConnection connection = new SqlConnection(connectionString))
{
    connection.Open();
    SqlCommand command = new SqlCommand("GetData");
    using (IDataReader reader = command.ExecuteReader())
    {
        while (reader.Read())
        {
            Customer c = new Customer();
            c.Id = (int)reader["ID"];
            c.FirstName = (string)reader["FirstName"];
            c.LastName = (string)reader["LastName"];
            customers.Add(c);
        }
    }
} 
```

如果您有大量表或可变字段列表，则可能难以维护。但是，对于简单的任务，这很好用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T02:32:48.123

奇怪的是，您不需要像 a`List`或数组这样的具体类。一个`IEnumerable`可能已经足够好了。考虑到这一点，这是我最喜欢的模式：

```
public IEnumerable<IDataRecord> GetData()
{
    using (var cn = getOpenConnection(connectionString))
    using (var cmd = new SqlCommand("GetData", cn))   
    using (var rdr = cmd.ExecuteReader())
    {
        while (rdr.Read())
        {
            yield return (IDataRecord)rdr;
        }
    }
} 
```

您也可以对其进行修改以创建强类型业务对象，但我通常将其保存在单独的层/层中。迭代器块将进行延迟评估/延迟执行，因此额外的翻译层*不需要*对结果进行额外的迭代。

这段代码有一个技巧。您需要确保在某个时间点将每条记录中的数据复制到真实对象。你不能直接绑定到它，否则你会得到可能令人惊讶的结果。我更经常使用的一种变体是使该方法具有通用性，并且需要一个`Func<IDataRecord, T>`参数来在读取每条记录时对其进行翻译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T02:07:57.267

迈克尔的回答通常是你最好的选择。一旦事情开始变得复杂，您就可以添加抽象（您需要包含 sql 阅读器和其他各种有趣事物的对象工厂）并开始传递对象和工厂。我发现这种策略非常有用，并且可以在与数据库相关的项目中使用编写良好的数据层类。

一种替代方法是使用[`SqlDataAdapter`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter.aspx)and 将您的输出转换为`DataSet`. 以我的经验，这非常笨拙，通常是一个非常糟糕的主意。也就是说，如果您倾向于获取一大块数据并对其进行操作（更新片段、添加新片段、删除片段），这可能是使用 C# 代码在内存中执行此操作的好方法。在尝试这种技术之前三思而后行。这基本上等同于抓取数据并填充行列表，尽管 a`DataSet`比数组包含更多内容（例如，它包括列名）。

我觉得使用 an`SqlDataAdapter`来填充 a`DataSet`是最接近于给你在你的问题中要求的答案，但在给你真正需要的方面是最糟糕的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T01:43:47.580

创建一个对象，该对象的属性与将在数据读取器中返回的字段匹配：

```
public class MyClass
{
   public int Id{get;set;}
   public string Name{get;set;}
   ....
} 
```

然后，遍历数据读取器中的所有结果。然后，创建此类型的对象并使用该记录的列中的值设置所有属性。然后，将它们添加到 List<MyClass>。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T02:00:45.847

我建议研究 LINQ to SQL（如果您有一个非常简单的数据库）或 NHibernate（如果您有一个更复杂的数据库）。这些是 OR 映射器，可以极大地简化将 SQL 查询转换为可在您的域中使用、通过服务等传递的对象的过程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T02:15:47.953

我认为这里有一个简单的解决方案。我会创建一个 DataAdapter，然后用数据填充一个 DataTable。然后您可以关闭连接，数据表将保持填充状态，因为与 ADO 不同，ADO.NET 默认为断开连接的记录集。

然后，您可以通过字段名轻松访问数据，例如，

```
myDataTable["FirstName"].ToString() 
```

如果您要做的只是将数据转换为 JSON，那么创建一个将属性映射到数据库字段的对象似乎是不必要的，因为 ADO.NET 为您提供了开箱即用的功能。

# sql-server - 如何重构使用插入和删除表的触发器，将公共代码移动到存储过程

> ID：942723
> 
> 赞同：2
> 
> 时间：2009-06-03T01:40:28.557
> 
> 标签：sql-server, sql-server-2008, stored-procedures, refactoring, triggers

我有一个将动态创建的触发器，因为它将附加到一个也动态生成的视图。我不希望我的存储过程中包含整个触发器，因此我想将其中的大部分移动到存储过程中，但我不知道插入和删除表中的字段。

触发器大约有 90 行长，我真正需要在触发器之间有所不同的唯一部分是：

```
DECLARE @DEBUG bit = 1
DECLARE @EntityName nvarchar(128) = 'Lot'
    SELECT * INTO #MYINSERTED FROM INSERTED
    SELECT * INTO #MYDELETED FROM DELETED 
```

如果我可以将其余部分移动到存储过程中，那就太好了。

仅传入@DEBUG 和@EntityName 并在存储过程中使用#MYINSERTED 和#MYDELETED 的问题如果两个人同时插入或更新同一个视图，我会遇到问题。

最好的办法是传递一个表变量来消除任何并发问题，但我不确定最好的方法。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T02:21:11.110

这实际上是一个坏主意。SQL 不像普通的过程语言。SQL“编译”绑定到物理访问路径计划，这意味着语句被编译成计划，显示“打开 ID 为 1234 的行集，查找记录并检索其内容”，并且在*编译期间确定“1234”*优化器的批次。这意味着在您计划时将通用代码移动到过程中往往弊大于利。该过程不能绑定到“通用”访问路径，它需要知道它应该查看的实际表和对象以进行选择和更新等。您要么最终在过程中执行动态 SQL，要么仅移动过程的非数据绑定的通用部分（例如计算），这会创建非常复杂的代码并且仍然会损害性能，同时*降低*过程的可读性。

更可取的是拥有一个模板并通过各种代码生成技术（如 XML 和 XSLT）从这些模板生成触发器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T02:21:34.057

我怀疑元数据/模式是这里`inserted`的`deleted`核心问题（这就是你使用的原因`SELECT * INTO`）。

如果您是动态生成触发器和视图的代码，我会说它可能没有太大区别。毕竟，所有触发器和视图都是代码生成的，并且可以在您的系统获得新功能或改进核心 SP 时重新生成。

只有当触发器和视图是定制的并且从不重新生成时，共享一个可以修改和升级的核心 SP 而不是重新生成视图和触发器才会有好处。

生成的代码可能会超过重新生成的开销，生成的代码将具有可靠的执行计划和更好的绑定。

# php - 什么是好的 Ruby on Rails 和 PHP 托管？

> ID：942726
> 
> 赞同：0
> 
> 时间：2009-06-03T01:43:21.357
> 
> 标签：php, ruby-on-rails, hosting

我正在寻找 Ruby on Rails 和 PHP 托管服务（共享空间或专用服务器）。在购买其中一个之前，我想先看看两个选项：

1.  PHP 并且可以稍后升级到 Ruby on Rails，但需要额外付费
2.  Ruby on Rails 和 PHP

我看过[Dreamhost](http://dreamhost.com/)、[Bluehost](http://www.bluehost.com/)和[RailsPlayground](http://railsplayground.com/)，它们似乎都有优点和缺点。有没有人有经验？有没有人有不同的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:20:01.737

我有dreamhost，虽然它很便宜并且提供了很大的空间，但它的速度可能会有很大差异。他们有不错的 PHP 支持（file_get_contents() 被禁用，等等）。他们的 Rails 支持还不错，他们提供 Phusion Passenger( [http://www.modrails.com/](http://www.modrails.com/) ) 来托管您的 Rails 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:22:01.533

在这里查看我的评论： [https ://stackoverflow.com/questions/162144/what-is-a-good-ruby-on-rails-hosting-service/162213#162213](https://stackoverflow.com/questions/162144/what-is-a-good-ruby-on-rails-hosting-service/162213#162213)

Dreamhost 是一个不错的选择。您可以同时运行 PHP 和 Rails，并且使用 Private Server 选项可以将需要更多资源的站点移动到更专用的平台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T01:45:50.387

[Slicehost](http://www.slicehost.com)是一个不错的选择。自己管理“切片”（大量教程和脚本来构建您自己的切片以托管 PHP 和 Rails）。根据需要升级。也蛮便宜的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:26:36.433

查看[http://heroku.com](http://heroku.com)，它们旨在简化 Rails 部署

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T04:45:19.430

[Mediatemple](http://www.mediatemple.net)两者都提供。我从来没有和他们有任何问题

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T19:19:32.673

[在http://en.railscluster.nl](http://en.railscluster.nl)上免费查看我们共享的 Rails 集群 30 天。它也运行 PHP 5！

# python - 如何在 PythonCard 中更改鼠标光标

> ID：942730
> 
> 赞同：0
> 
> 时间：2009-06-03T01:46:13.363
> 
> 标签：python, user-interface, mouse, cursor, pythoncard

如何使用 Python 和 PythonCard 更改鼠标光标以指示等待状态？

我在文档中没有看到任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T02:42:28.447

PythonCard 建立在 wx 之上，因此如果您导入 wx，您应该能够构建一个合适的光标（例如 with ），在等待开始时`wx.CursorFromImage`设置它（例如 with ），并在等待结束时结束它（with ）。`wx.BeginBusyCursor``wx.EndBusyCursor`

# c# - 如何防止在 Asp.net 页面中添加相同的事件？

> ID：942734
> 
> 赞同：1
> 
> 时间：2009-06-03T01:49:27.197
> 
> 标签：c#, asp.net

我一直在这样的 Page_Load 函数中编写代码

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
        UserControl1.Button_Clicked += new EventHandler(UserControl1_Button_Clicked);
    }
} 
```

但是当页面从另一个页面指向这个页面时，会再次添加相同的功能。

有什么方法可以防止它发生吗？

我正在尝试使用会话来防止它，但我想知道是否有更好的方法可以做同样的工作。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T02:35:45.807

我也建议在您的 .aspx 页面中设置 autoeventwireup = false 。然后，在页面后面的代码（.cs 文件）中，在 page_init 中添加按钮处理程序的事件。

如果我将其保留为真，我已经看到有时会导致我的事件被触发两次。
按钮不需要 (!isPostBack) 条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T01:57:52.903

在 C# ASP.NET 中，每次加载页面时都必须添加控件的事件处理程序。这就是框架的工作原理。

因此，如果您要为控件声明自定义事件处理程序，那么在 Page 的 Page_Init 事件中这样做会更简洁。

最后，因为这需要每次都发生，所以不要将代码包装在“if(!IsPostBack)”条件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-04T08:14:20.353

愚蠢的方法是这样的：

声明一个变量 Private a As Boolean = True

Protected Sub cmd_Entry_Click(ByVal sender As Object, ByVal e As System.EventArgs) 处理 cmd_Entry.Click If a = IsPostBack Then saveData() clearData() a = False End If End Sub

那应该工作：D

# apache - Apache mod-proxy 负载均衡器维护

> ID：942735
> 
> 赞同：1
> 
> 时间：2009-06-03T01:49:37.587
> 
> 标签：apache, mod-proxy

我将 mod-proxy 和 mod-proxy-balancer 设置为负载平衡反向代理。像这样的东西：

```
<Proxy balancer://example>
    BalancerMember http://hostname:8000 keepalive=on
    BalancerMember http://hostname:8001 keepalive=on
</Proxy>

ProxyPass / balancer://example/
ProxyPassReverse / balancer://example/
ProxyPreserveHost on
ProxyRequests Off 
```

有没有一种简单的方法来设置它以在平衡器组的所有成员都关闭时显示静态维护页面？我以前用硬件负载平衡器做过这个，它非常有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T02:16:34.660

也许您可以使用热备用。下面的示例来自[ProxyPass 指令](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)部分，其中显示“设置热备用，仅在没有其他成员可用时使用”

```
ProxyPass / balancer://hotcluster/
<Proxy balancer://hotcluster>
BalancerMember http://1.2.3.4:8009 loadfactor=1
BalancerMember http://1.2.3.5:8009 loadfactor=2
# The below is the hot standby
BalancerMember http://1.2.3.6:8009 status=+H
ProxySet lbmethod=bytraffic </Proxy> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T21:44:31.853

作为 RewriteRule 的替代方法，您可以使用适当的 ErrorDocument 指令执行相同的操作。我们做了这样的事情，其中​​代理服务器本身托管静态错误页面，而“热备用”主机是[http://localhost/some-app/](http://localhost/some-app/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T08:31:35.130

由于您的代理似乎是唯一的页面（可能在 VirtualHost 中），您可以简单地覆盖错误页面。Apache 产生 503 错误，因此如下所示：

```
# Document root is required because error documents use relative paths 
DocumentRoot /var/www/html/
# Allow access to document root directory
<Directory /var/www/html/>
  Order allow,deny
  allow from all
</Directory>
# Actual change: If service is unavailable (no member available), show this page
ErrorDocument 503 /maintenance.html 
```

如果您想在维护 html 中使用图像，请不要使用绝对路径（例如 /image.jpg）将加载 /var/www/html/image.jpg。

# visualization - 用于可视化自定义逻辑的工具或编程库

> ID：942737
> 
> 赞同：4
> 
> 时间：2009-06-03T01:50:35.133
> 
> 标签：visualization, visio, graphing, flowchart

我正在寻找工具来帮助可视化用于执行文档生成的自定义业务逻辑。逻辑表示为一个面向对象的模型，由决策点和渲染动作组成。基本构建块相对简单，但整体决策树非常大且复杂，因此难以可视化。

我们正在寻找有关可用于直观表示决策树和渲染操作的工具和/或图形库的建议。编程语言的选择并不重要（Delphi、C#、Java 会很棒），我们能够根据需要轻松地将逻辑提取为 XML 或其他数据格式。首选是在 Windows 下运行并启用结果图部分的打印或 PDF 输出的东西。

**要求**

*   决策点可以是简单的是/否或多个输出，例如（是、不是、有时、总是等）。

*   决策点与运行时环境中其他地方存在的外部业务逻辑相关联。我们需要用决策点的类型（例如布尔值）和描述正在使用的业务规则的字符串来标记图形节点。

*   渲染动作通过可选的合并变量和内联渲染逻辑链接到命名的内容对象。至少我们需要能够用元素的名称来标记节点，理想情况下还需要关于用于呈现内容的变量的信息。

我们考虑过围绕 Visio 或[WinGraphViz](http://wingraphviz.sourceforge.net/wingraphviz)构建一些东西，或者可能使用第三方图形/流程图库。任何想法或指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T02:29:22.827

经过更多挖掘后，我发现 WinGraphViz 和[DotXML](http://www.martin-loetzsch.de/DOTML/)最符合我的要求。我以前不知道“记录”元素允许我以清晰易读的方式在逻辑流中呈现决策。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-14T00:34:18.910

你可以考虑使用 Elm 前端的[Morphir 。](https://github.com/finos/morphir)
它是用于业务逻辑建模和代码生成的可靠工具。
可视化也随之而来。

# firefox - Apache 2 身份验证错误

> ID：942742
> 
> 赞同：2
> 
> 时间：2009-06-03T01:56:01.910
> 
> 标签：firefox, ssl, apache2, passenger, client-certificates

尝试使用 SSL 证书实现客户端身份验证，根据[此 HOWTO](http://www.modssl.org/docs/2.8/ssl_howto.html#auth-selective)，我收到以下错误。

阿帕奇：

> 重新协商握手失败：不被客户接受！？

火狐：

> ssl_error_handshake_failure_alert

我认为这是一个配置错误，但无法找到它。

附加信息：
商业 CA 服务器证书服务器在 Apache 2.2 和Passenger 中安全工作没有问题。只有客户端身份验证相关指令不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T12:46:14.543

当您需要客户端证书授权时，您必须将 Apache 指向包含**颁发客户端证书的根 CA（以及中间证书）的文件**

还要发布您的客户端身份验证配置部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T04:39:57.220

您的证书是由 verizon 还是类似的人签署的？如果没有，您可能想在 Firefox 中添加一个例外。默认情况下它会阻止你。

PD。听起来不像是乘客的问题

# ruby-on-rails - 在 Rails 中设置当前 Time.zone？

> ID：942747
> 
> 赞同：14
> 
> 时间：2009-06-03T01:59:13.307
> 
> 标签：ruby-on-rails, timezone

我页面上的 Javascript 将客户端 UTC 偏移量保存到 cookie。如何使用此 cookie 创建 TimeZone 并将其分配给 Time.zone ？

我需要类似的东西：

```
before_filter :set_time_zone

def set_time_zone
  Time.zone = ActiveSupport::TimeZone.new('my timezone', cookies[:timezone])
end 
```

除了这个表达式的正确部分不起作用，我不确定我在这里是否走对了路。无法得到它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T02:56:28.247

这是谷歌搜索的有效答案：

```
min = cookies[:timezone].to_i
Time.zone = ActiveSupport::TimeZone[-min.minutes] 
```

为了清楚起见，javascript部分：

```
if(!($.cookie('timezone'))) {
  current_time = new Date();
  $.cookie('timezone', current_time.getTimezoneOffset(), { path: '/', expires: 10 } );
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-22T21:34:46.520

@snitko - 你的回答对我来说很长一段时间都很好。但是，正如@Giovanni 指出的那样，它在某些情况下没有考虑夏令时，因为它在给定分钟偏移量的情况下提取了第一个可用的时区。我找到了一个解释 DST 的简单有效答案。

前往这里 - [http://site.pageloom.com/automatic-timezone-detection-with-javascript](http://site.pageloom.com/automatic-timezone-detection-with-javascript)，它是一个 javascript 时区检测器。您只需将从网站（或[此处](http://cdn.bitbucket.org/pellepim/jstimezonedetect/downloads/jstz.min.js)）链接的 javascript 代码复制到您的应用程序的一个 javascript 文件中（application.js 工作正常）。它允许您通过名为`jstz`.

然后，在 application.html.erb 我有

```
<script type="text/javascript">

  var timezone = jstz.determine();
  document.cookie = 'time_zone='+timezone.name()+';';

</script> 
```

在 application_controller.rb 中，我有

```
before_filter :set_timezone 

private
def set_timezone
  Time.zone = cookies["time_zone"]
end 
```

这就是你所需要的！为您的 Rails 应用程序正确设置了时区。

`<\body>`编辑：由于加载 javascript 文件的方式和顺序不同，您可能需要在 application.html.erb 中的标记之后放置 javascript cookie 设置代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T02:04:14.763

当我将它存储在我的用户模型中时，它就像这样简单

```
def set_time_zone
  Time.zone = current_user.time_zone unless current_user.blank?
end 
```

所以也许你可以做

```
def set_time_zone
  Time.zone = cookies[:timezone]
end 
```

这是未经测试的，我从未尝试过从 cookie 中执行此操作，我认为将其存储在 User 模型中更有意义。

# perl - 如何从 Perl CGI 应用程序安排一次性任务？

> ID：942749
> 
> 赞同：6
> 
> 时间：2009-06-03T01:59:58.767
> 
> 标签：perl, cgi, scheduling, at-job

我正在编写一个应用程序，以允许用户从 Web 应用程序（Linux/Apache/CGI::Application）安排一次性长时间运行的任务。为此，我使用[Schedule::At](http://search.cpan.org/%7Ejoserodr/Schedule-At-1.08/At.pm "时间表::在")模块，它是“at”命令的 Perl 接口。由于计划任务不重复，我不考虑“cron”。我对“at”有两个问题：

1.  当我的 CGI 应用程序在 suexec 包装器下运行时，调度工作正常，但在由 Apache 进程的所有者调度时却不行。如何让调度在两种环境（suexec 和 no-suexec）中工作？
2.  似乎由“at”或Schedule::At 安排的进程没有失败报告，我有时会发现安排的任务会默默地失败。有没有办法记录计划任务（而不是计划程序本身）未能运行的事实？

我并不固定在“at”上，并且愿意使用其他更强大的调度方法（如果有的话）。

感谢您的关注。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T02:30:35.333

我听说过关于[The Schwartz 的](http://search.cpan.org/~bradfitz/TheSchwartz-1.07/lib/TheSchwartz.pm)好消息。它没有延迟——直到；您可以通过 at 提交作业，但这应该可以解决您上面列出的两个问题，只要您的 submit_job 脚本很简单。

（作为警告，我只使用过[Gearman](http://search.cpan.org/~bradfitz/Gearman/)，我认为您需要一个可靠的作业队列，一种“即发即弃”机制，这样您就可以保持您的 submit_job 愚蠢。）

# database - 从 URL 中删除尾部斜杠总是安全的吗？

> ID：942751
> 
> 赞同：7
> 
> 时间：2009-06-03T02:00:37.517
> 
> 标签：database, url

我将 URL 存储在数据库中，并且我希望能够知道两个 URL 是否相同。

通常，末尾的斜杠不会改变您从服务器获得的响应。（即[http://www.google.com/与](http://www.google.com/)[http://www.google.com](http://www.google.com)相同）

我可以总是盲目地从任何 URL 中删除尾部斜杠，而不看任何东西吗？
那安全吗？

我所说的“不看任何东西”的意思是我会从以下位置删除斜线：
[​​http://www.google.com/q?xxx=something&yyy=something/](http://www.google.com/q?xxx=something&yyy=something/)

我知道网络服务器*理论上*可以根据需要返回完全不同的东西，而且我知道有时去一个没有斜杠的 URL 会重定向到一个有斜杠的 URL。我在这里唯一的目的是确定两个 URL 是否相同。

这种方法安全吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T02:03:08.870

不，它并不总是安全的。Web 服务器可以随意解释 URL 的路径部分。如果不对 URL 使用 GET 或 HEAD，您将无法判断它会做什么（解析 URI）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T02:09:04.800

从某种意义上说，无论是否带有斜杠，您都会得到相同的响应，这可能是安全的（我不能保证这是真的），但它们肯定意味着不同的东西。考虑一个引用目录的 URL，或者站点作为目录呈现的东西。使用网址

```
http://www.somesite.com/directory/ 
```

...清楚地表明您要的是目录。如果你砍掉尾部的斜杠：

```
http://www.somesite.com/directory 
```

...该站点会将其视为对名为“目录”的文件的请求，并且会暂时感到困惑。它可能会将此解释为对目录的请求，但含义并不相同，并且您可能无法得到预期的结果。

有关更多详细信息，请参阅[本文](http://www.davidroessli.com/logs/2007/06/watch_that_trailing_slash/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T02:03:46.543

不，我遇到过这样的情况，根据 .htaccess 文件中的设置，某些目录或“干净的 URL”（例如由 CMS 生成的那些）如果没有尾部斜杠就无法访问。这种情况很少见，可能是网站管理员的错误，但它可能会发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T02:22:02.637

正如其他人所指出的，它并不总是安全的。如果它对您有用，我的建议是存储带有斜杠的 URL，并在您进行比较时将其去掉。您会受到性能影响，但我认为这比将某人发送到错误的网页要好。

# linux - nm 报告符号已定义，但 ldd 报告符号未定义

> ID：942754
> 
> 赞同：2
> 
> 时间：2009-06-03T02:01:47.623
> 
> 标签：linux, linker, shared-libraries

我有一个链接问题。我需要链接一个共享库`libfoo.so`，该库依赖于`read`我想在文件 read.c 中定义自己的函数。

我将所有内容编译并链接在一起，但在运行时出现错误

```
/home/bar/src/libfoo.so: undefined symbol: sread. 
```

nm 报告符号已定义

```
$nm baz | grep sread
  00000000000022f8 t sread 
```

但 ldd 报告符号未定义

```
$ldd -r baz | grep sread 
undefined symbol: sread (/home/bar/src/libfoo.so) 
```

是什么赋予了？libfoo.so 是一个共享库这一事实有什么问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-03T05:03:28.313

首先，定义一个名为“read”的函数是个坏主意(TM)，因为它是所有 UNIXen 上的标准 libc 函数。执行此操作时，程序的行为是未定义的。

其次，`read`您在其中定义的函数`libbaz.so`标有`'t'`in`nm`输出。这意味着这个函数是本地的（在外面不可见`libbaz.so`）。`'T'`全局函数用标记`nm`。

你`'static int read(...)'`在read.c中定义的时候用过吗？如果没有，您是否在编译和链接时使用了链接器脚本，或者`attribute((visibility(hidden)))`，或者可能`-fvisibility=hidden`在命令行上`libbaz.so`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-30T18:12:44.480

上面的错误也可能出现在C代码用G++编译，然后链接的时候。G++ 执行名称修改，因此实际符号可能类似于“_Zsds_[function_name]_”，导致链接器在搜索未修改名称时阻塞。

我今天遇到了同样的行为，除了我的问题在[Wikipedia](http://en.wikipedia.org/wiki/Name_mangling#Handling_of_C_symbols_when_linking_from_C.2B.2B)上概述的操作后得到解决。基本上，使用 C++ 编译器编译的 C 代码将在符号表中具有“损坏”的名称，从而导致 C 样式的符号解析失败。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-03T03:10:38.623

构建共享库时，您需要从同一个库或另一个（共享）库中解析**所有未定义的符号。**链接器**不会**使用应用程序中的符号解析库中的未定义符号。

# c# - SSLStream.BeginRead 和 IOCP

> ID：942760
> 
> 赞同：0
> 
> 时间：2009-06-03T02:04:59.130
> 
> 标签：c#, networking

就像套接字 Begin\End 方法使用 IOCP 一样，SSLStream Begin\End Read\Write 方法也是如此

如果不是，你如何在 SSL 上获得一个 tcp\ip 服务器来扩展谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T02:49:49.960

由于`SslStream`大概是围绕着一个常规的`SocketStream`，我会说这很有可能，因为在某些时候异步`SslStream`将不得不对底层流执行读取。它将通过对底层流的异步读取来实现这一点是合乎逻辑的。

话虽如此，我不能给你一个 100% 确定的答案，但除非你准备好使用 SSL 库或“实现你自己的”，即使它没有，这会阻止你使用`SslStream`?

# iphone - Xcode + GitHub。什么是正确的设置

> ID：942767
> 
> 赞同：4
> 
> 时间：2009-06-03T02:09:47.873
> 
> 标签：iphone, xcode, git

我正在从多年的 Eclipse + CDT + Subclipse 转向 Xcode，并使用 GitHub 作为 Subversion 的替代品。我是 GitHub 的新手，还没有找到一个很好的方法来设置一个知道如何与 Xcode 项目配合使用的存储库。

有人可以指导我完成设置吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T02:21:50.563

请看这个问题：[Git 可以与 Xcode 集成吗？](https://stackoverflow.com/questions/456403/can-git-be-integrated-with-xcode)

# javascript - 什么可能导致 XMLHttpRequest 在 Firefox 中永远不会改变状态？

> ID：942768
> 
> 赞同：5
> 
> 时间：2009-06-03T02:10:05.220
> 
> 标签：javascript, ajax

我正在编写一些旧的 AJAX 代码，这些代码是在 jQuery 之前的黑暗时期编写的。奇怪的是，它多年来一直运行良好，直到今天它突然停止触发回调。这是基本代码：

```
var xml = new XMLHttpRequest();  // only needs to support Firefox
xml.open("GET", myRequestURL, true);
xml.onreadystatechange = function() { alert ('test'); };
xml.send(null); 
```

检查 Firebug 控制台，请求正在发送，无需担心，并且从请求 URL 接收到正确的 XML，但该`onreadystatechange`功能根本不起作用。系统中没有 javascript 错误或其他任何奇怪的事情发生。

我希望我可以使用 jQuery 重写所有内容，但我现在没有时间。什么可能导致这个问题？

* * *

进一步的更新 - 我已经能够在不同的浏览器（FFx 3.0）中测试我的代码并且它在那里工作，所以它一定是我的浏览器有问题。我在 Vista 上运行 Firefox 3.5b4，我现在已经在禁用所有插件的情况下尝试了它，但没有运气。它仍然困扰着我，因为我昨天在这个网站上工作（使用相同的浏览器设置）并且根本没有问题......

实际上，我只是回顾了一下我的插件窗口，发现 Firebug 仍然处于启用状态。如果我禁用 Firebug，它会完美运行。如果我启用它，它就坏了。Firebug 版本 1.40.a31

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T02:40:13.537

网址格式错误吗？您是否尝试过将整个事情放在 try-catch 中并警告错误（如果有）

授权检查是否失败？有问题的网址是否需要http-auth？（虽然在这种情况下应该有状态变化，我承认）

编辑：

我在这里有一个非常有趣的想法。您使用的是 Firefox 3.5 beta4 吗？我为基于浏览器的游戏开发了一个 firefox 扩展，最近发现了一些奇怪的行为。通过我的扩展程序或萤火虫观察从页面发出的 ajax 请求，创建它们的脚本将永远不会被回调。firebug 和我的扩展程序都会正确地观察和处理该请求（我可以观察到发送和接收的内容）......但页面本身再也不会收到请求的消息——就像它消失在黑洞中一样。

尝试关闭萤火虫（或至少关闭对该域的“网络”收听）并再次测试

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T10:31:14.863

影响 Firebug 的已知 Firefox 错误；有关详细信息，请参阅[http://code.google.com/p/fbug/issues/detail?id=1569&q=xhr&colspec=ID%20Type%20Status%20Owner%20Test%20Summary](http://code.google.com/p/fbug/issues/detail?id=1569&q=xhr&colspec=ID%20Type%20Status%20Owner%20Test%20Summary) :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T02:24:39.013

onreadystatechange 似乎不太可能停止工作。“警报”功能是否有可能以某种方式被禁用或覆盖？您可以用一些代码替换警报以在页面中进行可见的更改，并以这种方式检查其功能吗？（我知道，这有点牵强，但它看起来很奇怪，以至于 onreadystatechange 不起作用！）

# javascript - 带有两个提交按钮和两个“目标”属性的 HTML 表单

> ID：942772
> 
> 赞同：76
> 
> 时间：2009-06-03T02:13:18.257
> 
> 标签：javascript, html, forms, submit

我有一个 HTML <form>。

表单只有一个`action=""`属性。

但是，我希望有两个不同的`target=""`属性，具体取决于您单击哪个按钮来提交表单。这可能是一些花哨的 JavaScript 代码，但我不知道从哪里开始。

如何创建两个按钮，每个按钮都提交相同的表单，但每个按钮都为表单提供不同的目标？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-03T03:03:27.467

我在服务器端执行此操作。也就是说，表单总是提交到同一个目标，但我有一个服务器端脚本，负责根据按下的按钮重定向到适当的位置。

如果您有多个按钮，例如

```
<form action="mypage" method="get">

  <input type="submit" name="retry" value="Retry" />
  <input type="submit" name="abort" value="Abort" />

</form> 
```

> **注意：**我使用了 GET，但它也适用于 POST

然后您可以轻松确定按下了哪个按钮 - 如果变量`retry`存在并且具有值，则按下重试，如果变量`abort`存在并且具有值，则按下中止。然后可以使用此知识重定向到适当的位置。

此方法不需要 Javascript。

> **注意：**一些浏览器能够在不按任何按钮（按回车键）的情况下提交表单。虽然这是非标准的，但您必须通过明确的`default`操作并在没有按下任何按钮时激活它来解决它。换句话说，当有人在不同的表单元素中输入而不是单击提交按钮时，请确保您的表单执行*一些明智的操作（无论是显示有用的错误消息还是假设默认值），而不是仅仅中断。*

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-06-03T02:37:26.333

处理这个问题更合适的是，表单将有一个绑定到一个提交按钮的默认操作，然后绑定到一个普通按钮的替代操作。此处的区别在于，无论提交下的哪一个都将是用户通过按 Enter 提交表单时使用的那个，而另一个只会在用户明确单击按钮时被触发。

无论如何，考虑到这一点，应该这样做：

```
<form id='myform' action='jquery.php' method='GET'>
    <input type='submit' id='btn1' value='Normal Submit'>
    <input type='button' id='btn2' value='New Window'>
</form> 
```

使用这个 javascript：

```
var form = document.getElementById('myform');
form.onsubmit = function() {
    form.target = '_self';
};

document.getElementById('btn2').onclick = function() {
    form.target = '_blank';
    form.submit();
} 
```

将代码绑定到提交按钮的单击事件的方法在 IE 上不起作用。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2012-03-27T17:18:06.683

如果您使用 HTML5，您可以只使用属性`formaction`。这使您可以`action`为每个按钮使用不同的形式。

```
<!DOCTYPE html>
<html>
  <body>
    <form>
      <input type="submit" formaction="firsttarget.php" value="Submit to first" />
      <input type="submit" formaction="secondtarget.php" value="Submit to second" />
    </form>
  </body>
</html> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-10-01T14:02:35.223

这对我有用：

```
<input type='submit' name='self' value='This window' onclick='this.form.target="_self";' />

<input type='submit' name='blank' value='New window' onclick='this.form.target="_blank";' /> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-03T02:22:15.507

在这个例子中，取自

[http://www.webdeveloper.com/forum/showthread.php?t=75170](http://www.webdeveloper.com/forum/showthread.php?t=75170)

您可以在按钮 OnClick 事件上看到更改目标的方式。

```
function subm(f,newtarget)
{
document.myform.target = newtarget ;
f.submit();
}

<FORM name="myform" method="post" action="" target="" >

<INPUT type="button" name="Submit" value="Submit" onclick="subm(this.form,'_self');">
<INPUT type="button" name="Submit" value="Submit" onclick="subm(this.form,'_blank');"> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-11-04T15:42:42.873

简单易懂，这将发送已单击按钮的名称，然后分支执行您想要的任何操作。这可以减少对两个目标的需求。少页...！

```
<form action="twosubmits.php" medthod ="post">
<input type = "text" name="text1">

<input type="submit"  name="scheduled" value="Schedule Emails">
<input type="submit"  name="single" value="Email Now">
</form> 
```

twosubmits.php

```
<?php
if (empty($_POST['scheduled'])) {
// do whatever or collect values needed
die("You pressed single");
}

if (empty($_POST['single'])) {
// do whatever or collect values needed
die("you pressed scheduled");
}
?> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-12T07:21:31.457

例子：

```
<input 
  type="submit" 
  onclick="this.form.action='new_target.php?do=alternative_submit'" 
  value="Alternative Save"
/> 
```

瞧。很“花哨”，三个字的JavaScript！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-03T02:34:12.923

这是一个显示更改目标类型的表单的快速示例脚本：

```
<script type="text/javascript">
    function myTarget(form) {
        for (i = 0; i < form.target_type.length; i++) {
            if (form.target_type[i].checked)
                val = form.target_type[i].value;
        }
        form.target = val;
        return true;
    }
</script>
<form action="" onSubmit="return myTarget(this);">
    <input type="radio" name="target_type" value="_self" checked /> Self <br/>
    <input type="radio" name="target_type" value="_blank" /> Blank <br/>
    <input type="submit">
</form> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-21T13:28:47.237

HTML：

```
<form method="get">
<input type="text" name="id" value="123"/>
<input type="submit" name="action" value="add"/>
<input type="submit" name="action" value="delete"/>
</form> 
```

JS：

```
$('form').submit(function(ev){ 
ev.preventDefault();
console.log('clicked',ev.originalEvent,ev.originalEvent.explicitOriginalTarget) 
}) 
```

[http://jsfiddle.net/arzo/unhc3/](http://jsfiddle.net/arzo/unhc3/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-15T02:18:13.563

```
<form id='myForm'>
    <input type="button" name="first_btn" id="first_btn">
    <input type="button" name="second_btn" id="second_btn">
</form>

<script>

$('#first_btn').click(function(){
    var form = document.getElementById("myForm")
    form.action = "https://foo.com";
    form.submit();
});

$('#second_btn').click(function(){
    var form = document.getElementById("myForm")
    form.action = "http://bar.com";
    form.submit();
});

</script> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-28T11:06:41.223

它在服务器端是可行的。

```
<button type="submit" name="signin" value="email_signin" action="/signin">Sign In</button>
<button type="submit" name="signin" value="facebook_signin"  action="/facebook_login">Facebook</button> 
```

在我的节点服务器端脚本中

```
app.post('/', function(req, res) {
if(req.body.signin == "email_signin"){
            function(email_login) {...} 
        }
if(req.body.signin == "fb_signin"){
            function(fb_login) {...}    

        }
    }); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-03T02:27:24.483

在您的每个按钮上，您都可以有以下内容；

```
<input type="button" name="newWin" onclick="frmSubmitSameWin();">
<input type="button" name="SameWin" onclick="frmSubmitNewWin();"> 
```

然后有几个小js函数；

```
<script type="text/javascript">
    function frmSubmitSameWin() {
        form.target = '';
        form.submit();
    }

    function frmSubmitNewWin() {
        form.target = '_blank';
        form.submit();
    }
</script> 
```

这应该够了吧。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-11T04:35:49.263

替代解决方案。不要搞乱点击、按钮、服务器端和所有内容。只需创建一个具有不同操作的新表单，就像这样。

```
<form method=post name=main onsubmit="return validate()" action="scale_test.html">
<input type=checkbox value="AC Hi-Side Pressure">AC Hi-Side Pressure<br>
<input type=checkbox value="Engine_Speed">Engine Speed<br>
<input type=submit value="Linear Scale" />
</form>
<form method=post name=main1 onsubmit="return v()" action=scale_log.html>
<input type=submit name=log id=log value="Log Scale">
</form> 
```

现在在 Javascript 中，您可以借助[getElementsByTagName()](http://www.w3schools.com/jsref/met_document_getelementsbytagname.asp)在 v() 中获取主表单的所有元素。知道复选框是否被选中

```
function v(){
var check = document.getElementsByTagName("input");

    for (var i=0; i < check.length; i++) {
        if (check[i].type == 'checkbox') {
            if (check[i].checked == true) {

        x[i]=check[i].value
            }
        }
    }
console.log(x);
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-11-24T17:46:29.103

让两个按钮都提交到当前页面，然后在顶部添加以下代码：

```
<?php
    if(isset($_GET['firstButtonName'])
        header("Location: first-target.php?var1={$_GET['var1']}&var2={$_GET['var2']}");
    if(isset($_GET['secondButtonName'])
        header("Location: second-target.php?var1={$_GET['var1']}&var2={$_GET['var2']}");
?> 
```

如果您不希望他们看到变量，也可以使用 $_SESSION 来完成。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-25T07:56:39.150

e.submitEvent.originalEvent.submitter.value

如果您使用表单事件

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-02-11T18:59:01.600

**这可能会帮助某人：**

使用 formtarget 属性

```
<html>
  <body>
    <form>
      <!--submit on a new window-->
      <input type="submit" formatarget="_blank" value="Submit to first" />
      <!--submit on the same window-->
      <input type="submit" formaction="_self" value="Submit to second" />
    </form>
  </body>
</html> 
```

# eclipse - 如何管理使用 Subversive 时显示的现有存储库？

> ID：942785
> 
> 赞同：5
> 
> 时间：2009-06-03T02:20:11.050
> 
> 标签：eclipse, svn, eclipse-plugin, subversive

当我从 SVN 创建一个新项目时，向导会弹出并指示我“创建新的存储库位置”或“使用现有的存储库位置”。我想删除大多数现有存储库或至少修改它们，但我在 Eclipse 中看不到任何编辑或删除它们的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T02:28:17.053

您可以切换到 SVN Repository Exploring，然后更改存储库的属性或丢弃它们

# django - 为什么我不能在 if 标记内嵌套块标记？

> ID：942797
> 
> 赞同：7
> 
> 时间：2009-06-03T02:25:49.743
> 
> 标签：django, templates, django-templates, tags

我有一个名为 的主模板文件`base.html`，其中包含以下代码：

```
{% ifequal environment "dev" %}
    {% block stylesheets %}{% endblock %}
{% endifequal %} 
```

我在其他模板中继承它并执行以下操作：

```
{% block stylesheets %}
    <link ... >
{% endblock %} 
```

问题是，我链接的样式表永远不会被应用，样式表块似乎被忽略是否在基础中满足 ifequal 条件。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-03T05:55:28.040

## 编辑（2010 年 10 月 14 日）：

*根据对 Django 票证的[评论](http://code.djangoproject.com/ticket/10975#comment:6)，原来的问题标题不再正确。*

### 原答案：

我不知道为什么不，但你可以这样做：

```
{% block stylesheets %}
    {% ifequal environment "dev" %}
        ... something ....
    {% else %}
        {{ block.super }}
    {% endifequal %}
{% endblock %} 
```

重新考虑了一下——我想这意味着在你的每个模板中重复这个逻辑，这是相当不令人满意的，但无论如何我都会把这个答案留在这里。我快速浏览了 Django 票证，但找不到任何相关内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T16:23:35.980

这个问题不再相关 - 从[r12655 开始](https://github.com/django/django/commit/755a0f6d96)，您**可以**在条件中嵌套块标记。

# php - php mysql全文搜索：lucene，sphinx，还是？

> ID：942810
> 
> 赞同：14
> 
> 时间：2009-06-03T02:31:03.773
> 
> 标签：php, mysql, search, lucene, sphinx

这无疑*类似于*（但不重复）[全文搜索引擎的比较 - Lucene、Sphinx、Postgresql、MySQL？](https://stackoverflow.com/questions/737275/pros-cons-of-full-text-search-engine-lucene-sphinx-postgresql-full-text-search)，但是我正在寻找的是具体的、受支持的、受益于多个可用系统的经验的建议（似乎有很多：“我使用过 lucene，但没有使用 sphinx”，反之亦然反之亦然）。

设置：标准 LAMP（Mysql 5.0，PHP 5）。

MySQL：表使用 InnoDB 引擎进行外键约束

我们正在查看索引数据，而不是页面。要索引的数据可以是多种语言（utf-8 字符集）

我遇到的一些比较（如[http://blog.evanweaver.com/articles/2008/03/17/rails-search-benchmarks/](http://blog.evanweaver.com/articles/2008/03/17/rails-search-benchmarks/)）要么不完全适用（ferret 是一个 lucene 端口，但不是与 Zend_Search_Lucene 相同）或者他们正在推动他们自己的系统/实现（并非完全无偏见）。

我遇到的其他一些（例如[http://whatstheplot.com/blog/tag/lucene/](http://whatstheplot.com/blog/tag/lucene/)和[http://pagetracer.com/2008/02/15/sphinx-and-lucene-search-engines-first -impressions/](http://pagetracer.com/2008/02/15/sphinx-and-lucene-search-engines-first-impressions/) ) 为两个系统的性能提供了非常不同的结果。

此外，在我读过的大部分内容中几乎被忽略的是[Xapian](http://xapian.org)。这也值得考虑吗？

所以......我希望你们中的一些人对这个问题有一些经验，可以帮助提出一些建议或为我指明正确的方向。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T05:02:14.417

Sphinx 的一个优点是您可以在您的客户端和 MySQL 服务器之间“插入”它，并且它只会“干扰”专门针对它的查询，透明地将其他查询从 MySQL 中反弹——参见例如[这篇文章](http://www.mysqlperformanceblog.com/2009/04/19/talking-mysql-to-sphinx/)。无论这是否是您的用例中的优势，您都可以说！

抱歉，没有使用 Xapian 或 Lucene 的实际经验——尽管如此，阅读有关如何部署它们的信息，听起来（对我来说！）好像只有在您确定了实质性优势时才值得。否则，Sphinx 的“简单易用”部署，作为您的客户端和 MySQL 服务器之间的“代理”，对我来说感觉就像一个巨大的、实质性的胜利！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T12:32:08.060

我在 Zend_Search_Lucene 和 Sphinx 中寻找了一个听起来相似的项目——搜索数据库内容（在我的例子中，是书籍信息）。我花了大约一天的时间看着每一个。对于它的价值，我发现 Sphinx 非常容易设置和使用。

# sql-server - 使用集成服务，如何复制一条记录，其中包含主记录具有外键关系的所有记录

> ID：942817
> 
> 赞同：0
> 
> 时间：2009-06-03T02:35:19.177
> 
> 标签：sql-server, sql-server-2008, ssis

我正在创建必要的视图、触发器和存储过程，以便人们更轻松地使用集成服务将数据复制到我们的数据库（这是一个实体-属性-值模式），因此外键关系是并不总是在模式中明确说明，但在我看来，我希望可以使其更加明确。

因此，如果我有一个车辆实体并且我想复制它，并且还复制了车辆的所有相关部分，那么我应该在服务中查看什么？

我对集成服务不太满意，因此我可能会在回复后要求澄清。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T14:07:02.260

SSIS 通常将数据流的单个分支加载到表中。一个分支可以拆分以加载多个表。

我会说最好加载到一个始终符合实体所需期望的临时表，让用户制作他们的数据流来填充临时表，然后`INSERT/UPDATE`在 SQL 命令任务中使用单个来更新您的视图（通过`INSTEAD OF`触发器，对吧？）。

另一个很好的可能性是创建一个自定义数据目标组件，它可以强制执行您的所有期望。

# c# - ISP 上的 ASP.NET MVC 路由出现 404 错误

> ID：942819
> 
> 赞同：1
> 
> 时间：2009-06-03T02:35:35.760
> 
> 标签：c#, asp.net, asp.net-mvc

我有一个简单的 ASP.NET MVC 1.0 站点，其中包含基于 ASP.NET MVC 项目的默认项目模板的主页、上传和关于链接。Global.asax.cs 有以下路线。

```
 routes.MapRoute(
      "Default",                                              // Route name
      "{controller}/{action}/{id}",                           // URL with parameters
      new { controller = "Home", action = "About", id = "" }  // Parameter defaults
  ); 
```

在我的本地计算机上，站点和链接正常工作。但是，当站点部署到我的 ISP（共享主机）时，站点加载时会显示默认的主页/关于，但单击任何链接都会导致 404 Page not found 错误。

我必须包括： System.Web.Abstractions System.Web.Mvc System.Web.Routing

在我的 /bin 文件夹中，因为 MVC 1.0 未安装在 ISP 的 GAC 中。

关于为什么这不是正确路由的想法？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T02:59:04.717

在部署 asp.net mvc 应用程序时需要注意一些路由问题。您的 ISP 使用的是什么版本的 IIS？

看这里：

[IIS6 上的 ASP.NET MVC](https://stackoverflow.com/questions/34194/asp-net-mvc-on-iis6)

基本上，如果您使用的是 IIS6，则需要稍微修改一下。

# c# - 在决定应该在哪里定义枚举和结构时，有什么好的做法？

> ID：942821
> 
> 赞同：3
> 
> 时间：2009-06-03T02:35:38.193
> 
> 标签：c#

假设`enum`or`struct`没有嵌套在一个特定的类中，即它属于项目命名空间，它应该定义在：

*   自己的文件
*   一个通用文件称为`Enums.cs`或`Structs.cs`其中所有属于项目名称空间的`enums`/将被定义`structs`
*   别的地方...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T03:14:07.260

就个人而言，我更喜欢一种类型，一种文件的理念。我什至甚至将嵌套类型放在单独的文件中，并使用部分类来允许分离。

我这样做主要是因为我已经看到了太多相反的情况。包含数十个类的单个文件。经历改变了我。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T05:32:20.480

对我来说，一种类型 = 一个文件，除非它是委托。`Func`由于and ，这些天我不需要经常声明自己的代表，但是当我这样做时，我发现拥有一个文件`Action`很有用。`Delegates.cs`

至于结构体——我只记得写过其中的两个，除了为了测试*可变*结构体可以做的坏事。但我也会坚持每个文件一个。你为什么不呢？仅仅因为它们是值类型并不意味着它们自然比类更短或更简单。（你能想象如果`decimal`并且`DateTime`两者都在同一个源文件中吗？哎呀！）

编辑：我刚刚想到了另一种可能适合使用多个结构的情况：互操作。在那种情况下，我可能有 Interop.cs 或 Win32.cs... 或者可能有一个命名空间，然后返回到每种类型的一个文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T02:40:39.353

[这篇关于枚举最佳实践的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms229058.aspx)没有就枚举定义的存储位置提出建议。

你会得到不同的建议。就个人而言，我倾向于将枚举存储在与它们相关的类相同的文件中。我喜欢尽可能地保持我的文件结构与我的命名空间结构相同，因此如果我的枚举自然地落入特定的命名空间，我会将定义存储在相应的文件中。

我的建议是，找到一个适合你的方案，并坚持下去。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T05:54:33.173

我把我所有的枚举放在他们自己的文件中。但是，我也完全 xml 文档注释我的所有类型，包括枚举......所以我的枚举文件中的代码行可能比大多数人的要多得多。

我已经很多年没有写过结构了，但我不认为它们不亚于一个类（同样，我完全用 xml 文档注释了我的所有类型，包括结构），所以它们在过去也总是有自己的档案。

当涉及到代表时，因为它们通常是一个衬里（减去文档注释），我倾向于将它们与它们支持的任何更突出的类型放在同一个文件中。这些天我不经常写代表，但有时我发现它们仍然有用。但是，我尝试将声明的任何委托保留在文件顶部，而不是嵌套在主类型下方或在主类型下方……让您在寻找它们时更容易发现它们。

我认为将每种类型保存在自己的文件中还有一个非常简单但实用的理由。他们很容易以这种方式发现。如果您将枚举和结构隐藏在其他类型中，或者将它们保存在另一个文件中，有时（并且不要假设您和阅读您的代码的人总是可以访问 Visual Studio 及其所有丰富的工具）它可以是很难找到您正在寻找的类型。

# linux - 如何在 Linux 中查找进程 ID 打开的端口？

> ID：942824
> 
> 赞同：52
> 
> 时间：2009-06-03T02:36:04.933
> 
> 标签：linux, bash, networking

假设进程的PID已知

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-06-03T04:30:15.450

```
netstat --all --program | grep '3265' 
```

*   `--all`显示监听和非监听套接字。

*   `--program`显示socket所属程序的PID和名称。

您还可以使用端口扫描器，例如 Nmap。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2016-02-24T08:32:09.463

您可以使用以下命令：

```
lsof -i -P |grep pid 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-03T04:20:31.270

附带说明一下，netstat -ao 将读取 /proc/ **PID** /tcp 等以查看进程打开的端口。这意味着它的读取信息由系统（linux KERNEL）提供，绝不是直接在网络接口或其他方式上查看。lsof 也是如此。

如果您将此作为安全措施，那么您失败了。即使您 100% 确定您实际上正在运行一个真正的 netstat 程序（而不是木马版本）或任何其他读取 /proc 文件系统的程序，您也不应该（永远）相信 netstat 的输出。有些人似乎认为 netstat、ls、ps 或任何其他标准的 unix 工具会发挥某种魔力并从源头轮询信息，事实是它们都依赖 /proc 文件系统来获取所有数据，它可以很容易地被 rootkit 或管理程序破坏。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-03T03:12:16.093

您可以使用带有命令行参数的[netstat](http://en.wikipedia.org/wiki/Netstat)命令行工具：`-p`

> ## **`-p`**（Linux）：
> 
> 进程：显示哪些进程正在使用哪些套接字（类似于`-b`Windows 下）。您必须是 root 才能执行此操作。

[示例部分](http://en.wikipedia.org/wiki/Netstat#Examples)给出了这个例子：

> 要显示由具有 id 的进程打开的所有端口`$PID`：
> 
> ```
> netstat -ao | grep '\b'$PID'\b' 
> ```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-24T00:20:22.503

在某些嵌入式设备或旧版本的 Linux 中，问题是`netstat`没有`--process`或没有可用的`-p`选项。

以下脚本显示了进程及其 IP 和端口，您必须是 root。

```
#!/bin/bash

for protocol in tcp udp ; 
do 
    #echo "protocol $protocol" ; 
    for ipportinode in `cat /proc/net/${protocol} | awk '/.*:.*:.*/{print $2"|"$3"|"$10 ;}'` ; 
    do 
        #echo "#ipportinode=$ipportinode"
        inode=`echo "$ipportinode" | cut -d"|" -f3` ;
        if [ "#$inode" = "#" ] ; then continue ; fi 
        lspid=`ls -l /proc/*/fd/* 2>/dev/null | grep "socket:\[$inode\]" 2>/dev/null` ; 
        pid=`echo "lspid=$lspid" | awk 'BEGIN{FS="/"} /socket/{print $3}'` ;
        if [ "#$pid" = "#" ] ; then continue ; fi
        exefile=`ls -l /proc/$pid/exe | awk 'BEGIN{FS=" -> "}/->/{print $2;}'`
        #echo "$protocol|$pid|$ipportinode" 
        echo "$protocol|$pid|$ipportinode|$exefile" | awk '
            BEGIN{FS="|"}
            function iphex2dec(ipport){ 
                ret=sprintf("%d.%d.%d.%d:    %d","0x"substr(ipport,1,2),"0x"substr(ipport,3,2),
                "0x"substr(ipport,5,2),"0x"substr(ipport,7,2),"0x"substr(ipport,10,4)) ;
                if( ret == "0.0.0.0:0" ) #compatibility others awk versions 
                {
                    ret=        strtonum("0x"substr(ipport,1,2)) ;
                    ret=ret "." strtonum("0x"substr(ipport,3,2)) ;
                    ret=ret "." strtonum("0x"substr(ipport,5,2)) ;
                    ret=ret "." strtonum("0x"substr(ipport,7,2)) ;
                    ret=ret ":" strtonum("0x"substr(ipport,10)) ;
                }
                return ret ;
            }
            { 
            print $1" pid:"$2" local="iphex2dec($3)" remote="iphex2dec($4)" inode:"$5" exe=" $6 ;  
            }
            ' ; 
        #ls -l /proc/$pid/exe ; 
    done ; 
done 
```

输出如下：

```
tcp pid:1454 local=1.0.0.127:5939 remote=0.0.0.0:0 inode:13955 exe=/opt/teamviewer/tv_bin/teamviewerd
tcp pid:1468 local=1.1.0.127:53 remote=0.0.0.0:0 inode:12757 exe=/usr/sbin/dnsmasq
tcp pid:1292 local=0.0.0.0:22 remote=0.0.0.0:0 inode:12599 exe=/usr/sbin/sshd
tcp pid:4361 local=1.0.0.127:631 remote=0.0.0.0:0 inode:30576 exe=/usr/sbin/cupsd
tcp pid:1375 local=1.0.0.127:5432 remote=0.0.0.0:0 inode:12650 exe=/usr/lib/postgresql/9.3/bin/postgres 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-24T08:11:49.663

使用 ls 可以知道流程路线。

例子：

```
fuser 25/tcp 
```

fuser 命令说进程是：2054

```
ls -l /proc/2054/exe 
```

出现进程路径

摘自：[https ://www.sysadmit.com/2018/06/linux-que-proceso-usa-un-puerto.html](https://www.sysadmit.com/2018/06/linux-que-proceso-usa-un-puerto.html)

[图片示例](https://i.stack.imgur.com/EFISQ.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-29T20:18:20.963

我添加了 IPv6 支持并进行了一些修复。此外，在我的系统上，IP 地址的八位字节是相反的。依赖项仅适用于 posix shell、awk 和 cut。

我的版本可以在 [Github上找到](https://github.com/wofwofwof/pentest_scripts/blob/master/linux-get-programm-to-port.sh)

```
#!/bin/sh

# prints all open ports from /proc/net/* 
#
# for pretty output (if available) start with 
# ./linux-get-programm-to-port.sh | column -t -s $'\t' 

#set -x

ip4hex2dec () {
    local ip4_1octet="0x${1%???????????}"

    local ip4_2octet="${1%?????????}"
    ip4_2octet="0x${ip4_2octet#??}"

    local ip4_3octet="${1%???????}"
    ip4_3octet="0x${ip4_3octet#????}"

    local ip4_4octet="${1%?????}"
    ip4_4octet="0x${ip4_4octet#??????}"

    local ip4_port="0x${1##*:}"

    # if not used inverse
    #printf "%d.%d.%d.%d:%d" "$ip4_1octet" "$ip4_2octet" "$ip4_3octet" "$ip4_4octet" "$ip4_port"
    printf "%d.%d.%d.%d:%d" "$ip4_4octet" "$ip4_3octet" "$ip4_2octet" "$ip4_1octet" "$ip4_port"
}

# reoder bytes, byte4 is byte1 byte2 is byte3 ...
reorderByte(){
    if [ ${#1} -ne 8 ]; then echo "missuse of function reorderByte"; exit; fi

    local byte1="${1%??????}"

    local byte2="${1%????}"
    byte2="${byte2#??}"

    local byte3="${1%??}"
    byte3="${byte3#????}"

    local byte4="${1#??????}"

    echo "$byte4$byte3:$byte2$byte1"
}

# on normal intel platform the byte order of the ipv6 address in /proc/net/*6 has to be reordered.
ip6hex2dec(){
    local ip_str="${1%%:*}"
    local ip6_port="0x${1##*:}"
    local ipv6="$(reorderByte ${ip_str%????????????????????????})"
    local shiftmask="${ip_str%????????????????}"
    ipv6="$ipv6:$(reorderByte ${shiftmask#????????})"
    shiftmask="${ip_str%????????}"
    ipv6="$ipv6:$(reorderByte ${shiftmask#????????????????})"
    ipv6="$ipv6:$(reorderByte ${ip_str#????????????????????????})"
    ipv6=$(echo $ipv6 | awk '{ gsub(/(:0{1,3}|^0{1,3})/, ":"); sub(/(:0)+:/, "::");print}')
    printf "%s:%d" "$ipv6" "$ip6_port"
}

for protocol in tcp tcp6 udp udp6 raw raw6; 
do 
    #echo "protocol $protocol" ; 
    for ipportinode in `cat /proc/net/$protocol | awk '/.*:.*:.*/{print $2"|"$3"|"$10 ;}'` ; 
    do 
        #echo "#ipportinode=$ipportinode"
        inode=${ipportinode##*|}
        if [ "#$inode" = "#" ] ; then continue ; fi 

        lspid=`ls -l /proc/*/fd/* 2>/dev/null | grep "socket:\[$inode\]" 2>/dev/null` ; 
        pids=`echo "$lspid" | awk 'BEGIN{FS="/"} /socket/{pids[$3]} END{for (pid in pids) {print pid;}}'` ;  # removes duplicats for this pid
        #echo "#lspid:$lspid  #pids:$pids"

        for pid in $pids; do
            if [ "#$pid" = "#" ] ; then continue ; fi
            exefile=`ls -l /proc/$pid/exe | awk 'BEGIN{FS=" -> "}/->/{print $2;}'`;
            cmdline=`cat /proc/$pid/cmdline`

            local_adr_hex=${ipportinode%%|*}
            remote_adr_hex=${ipportinode#*|}
            remote_adr_hex=${remote_adr_hex%%|*}

            if [ "#${protocol#???}" = "#6" ]; then
                local_adr=$(ip6hex2dec $local_adr_hex)
                remote_adr=$(ip6hex2dec $remote_adr_hex)
            else
        local_adr=$(ip4hex2dec $local_adr_hex)
        remote_adr=$(ip4hex2dec $remote_adr_hex)
            fi 

            echo "$protocol pid:$pid \t$local_adr \t$remote_adr \tinode:$inode \t$exefile $cmdline" 
    done
    done  
done 
```

# asp.net - 使用 RegularExpressionValidator 验证 ASP.NET FileUpload 控件中的文件类型时出现问题

> ID：942830
> 
> 赞同：2
> 
> 时间：2009-06-03T02:39:29.683
> 
> 标签：asp.net, regex, validation, file-upload

代码：

```
<span>Upload Adobe Acrobat file<img src="../../Images/UI/pdf.jpg" style="height: 25;
    width: 20" height="25" width="20" /></span>
<asp:FileUpload ID="uplPdf" runat="server" />
<asp:RegularExpressionValidator ID="valPdf" runat="server" ErrorMessage="Only PDF files are allowed!"
    ValidationExpression="^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))(.pdf)$" Display="Dynamic"
    ControlToValidate="uplPdf" ValidationGroup="upload" />
<br />
<asp:Button ID="btnUpload" runat="server" Text="Upload files" OnClick="btnUpload_Click"
    ValidationGroup="upload" /> 
```

后面的代码：

```
if (valPdf.IsValid && uplPdf.HasFile) 
```

IsValid 在输入有效的 pdf 文件名后返回 false。请注意，如果未指定文件，则返回 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:57:31.177

在你的 RegularExpressionValidator 中试试这个

```
<asp:RegularExpressionValidator ID="valPdf" runat="server" 
  ErrorMessage="Only PDF files are allowed!" 
  ValidationExpression=".+.(P|p)(D|d)(F|f)$" 
   Display="Dynamic" ControlToValidate="uplPdf" ValidationGroup="upload" /> 
```

然后在您的代码隐藏中，在继续之前调用[Page.Validate("upload") ：](http://msdn.microsoft.com/en-us/library/dwzxc386.aspx)

```
Page.Validate("upload");
if(valPdf.IsValid && uplPdf.HasFile)
{
   //Proceed with the upload
} 
```

**注意：**上面的 ValidationExpression 将以不区分大小写的方式匹配任何以 *.pdf 结尾的文件。因此`"c:\somepath\somefile.pdF"`,`"somefile.pDF"` 并且`"somefile.Pdf"`都将通过验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T02:56:10.493

嗯......我认为这个正则表达式在这种情况下永远不会起作用。试试这个：

ValidationExpression="^.+.pdf$"

它应该适用于以 .pdf 结尾的文件，这正是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:08:55.910

好吧，是的，通常你必须逃避这个点。

此外，在问题中使用了 POSIX 正则表达式函数，而通常我们在 .NET 中使用 Perl Styled Expressions

您是否尝试过类似的方法：

```
\.pdf$ 
```

当然，请确保它忽略字母的大小写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-28T05:06:46.253

我将文件列表添加到项目设置中的字符串集合中。

然后我以编程方式设置正则表达式：

```
public static string PrepareValidExtensionRegex(string[] allowedFileTypes)
{
    for (int i = 0; i < allowedFileTypes.Length; i++)
    {
        char[] chars = allowedFileTypes[i].ToCharArray();
        int length = chars.Length;
        string[] ret = new string[length];
        for (int j = 0; j < length; j++)
        {
            char ch = chars[j];
            char replacement = char.IsLower(ch)?
                               char.ToUpper(ch): 
                               char.ToLower(ch);
            ret[j] = "[" + ch + replacement + ']';
        }
        allowedFileTypes[i] = '(' + string.Join("", ret) + ')';
    }

    return @"^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))(" + 
        string.Join("|", allowedFileTypes) + ")$";
}

//Usage:
string[] allowedFiles = new string[] { "jpg", "gif" };
RegexValidator.ValidationExpression = PrepareValidationExpression(allowedFiles); 
```

# iphone - UITableView 部分标题全黑

> ID：942834
> 
> 赞同：5
> 
> 时间：2009-06-03T02:41:33.330
> 
> 标签：iphone, uitableview

对于 iPhone，我有一个 UITableView，它是分组的，有一个部分，我在其中设置了一个部分标题，它是来自笔尖的 UILabel 对象。当表格视图显示时，标题显示为纯黑色条纹——没有文本。

在 heightForHeaderInSection 中，我将高度设置为 UILabel 对象的 frame.size.height。当我在 IB 中更改高度时，黑色条纹的高度会发生变化。所以我知道 .m 文件已锁定到正确的 UILabel 对象。

在调试器中，viewForHeaderInSection中，好像UILabel对象的宽度为零，高度为1079574528，文字为null。

对我做错了什么有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-08-27T10:27:06.037

不确定你做错了什么，但这里有一些示例代码可能会有所帮助（来自我博客上的一篇文章）[：](http://undefinedvalue.com/2009/08/25/changing-background-color-and-section-header-text-color-grouped-style-uitableview)

```
#define SectionHeaderHeight 40

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    if ([self tableView:tableView titleForHeaderInSection:section] != nil) {
        return SectionHeaderHeight;
    }
    else {
        // If no section header title, no section header needed
        return 0;
    }
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    NSString *sectionTitle = [self tableView:tableView titleForHeaderInSection:section];
    if (sectionTitle == nil) {
        return nil;
    }

    // Create label with section title
    UILabel *label = [[[UILabel alloc] init] autorelease];
    label.frame = CGRectMake(20, 6, 300, 30);
    label.backgroundColor = [UIColor clearColor];
    label.textColor = [UIColor colorWithHue:(136.0/360.0)  // Slightly bluish green
                                 saturation:1.0
                                 brightness:0.60
                                      alpha:1.0];
    label.shadowColor = [UIColor whiteColor];
    label.shadowOffset = CGSizeMake(0.0, 1.0);
    label.font = [UIFont boldSystemFontOfSize:16];
    label.text = sectionTitle;

    // Create header view and add label as a subview
    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, SectionHeaderHeight)];
    [view autorelease];
    [view addSubview:label];

    return view;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-12T08:09:39.440

我有同样的问题，还没有完全弄清楚为什么黑条..

但是，如果我为`tableView.tableHeaderView`and设置值，而不是在委托方法中提供页眉和页脚视图`tableView.tableFooterView`，一切都很好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T05:31:05.033

加载数据源后刷新时，我观察到了相同的行为。我注意到这是由于我刷新表格视图的方式。

```
//[self loadView];   this caused the section header to go black.
[self.tableView reloadData]; // this works! 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:57:09.093

您可以发布**heightForHeaderInSection**和**viewForHeaderInSection**函数的代码吗？你所做的事情背后的理论听起来是正确的，但如果没有看到代码，几乎不可能找出问题所在......

听起来您在 IB 中的视图上放置了一个标签，并试图将其用作您的标题视图 - 这不是正确的做事方式。如果您不使用**viewForHeaderInSection**，请尝试一下.. 像这样：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UILabel *lbl;
    lbl.text = @"Header for The Only Section";
    //define other properties for the label - font, shadow, highlight, etc...

    return lbl;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-12T20:23:05.453

3.1.3 不喜欢[UIColor clearColor]；尝试使用与 tableview 相同的背景颜色

# iphone - 编译器优化掉的变量

> ID：942840
> 
> 赞同：2
> 
> 时间：2009-06-03T02:42:37.040
> 
> 标签：iphone, objective-c

我开始调试一些代码，试图找出我的错误。当我尝试`p tlEntries`从调试器中获取

`<variable optimized away by compiler>`

消息while停在`if`语句上。以下是我的代码：

```
NSArray *tlEntries = [[NSArray alloc] initWithArray:[self fetchJSONValueForURL:url]];
for (NSDictionary *info in tlEntries) 
{
    if ([info objectForKey:@"screen_name"] != nil)
         NSLog(@"Found %@ in the timeline", [info objectForKey:@"screen_name"]);
} 
```

早期的调试让我确信 URL 确实返回了一个有效的`NSArray`，但我不明白为什么`tlEntries`会被“优化掉”。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-03T06:41:21.050

正确的解决方案是以不同的方式声明变量，如下所示：

```
volatile NSArray *tlEntries; 
```

事实上， volatile 关键字正是用来告知编译器它不能尝试以任何方式优化与该变量相关的代码。亲切的问候。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T02:50:53.607

编译器可能注意到您在开始时只使用了两次 tlEntries，并且在循环中根本不使用它。如果我没记错的话，循环会创建一个枚举对象，而不是保留对容器对象的引用。所以 tlEntries 对第一行应该是有效的，但是对于其余的行应该是有效的。

想法：您可以通过在函数后面的某处使用 tlEntries 来强制编译器保留它。就像是

```
NSPrint(@"IGNORE THIS LINE %p", tlEntries); 
```

更好的主意：您可以将优化设置为 -O0。强烈建议将其用于调试代码。如果您使用“Debug”而不是“Release”构建，它应该自动设置为 -O0，但您可以更改它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T21:54:09.083

当启用编译器优化时，变量经常被“优化掉”，方法是将它们放在寄存器中或其他技巧，如语句重新排序。如果您使用除此之外的任何`-O`标志，`-O0`则可能会发生这种情况。

我认为在代码中添加对变量的额外引用不会阻止这种情况的发生。（如果有的话，编译器可能会更加努力，因为优化它的潜在收益更大。）

作为临时解决方法，您可以声明变量“volatile”。这通常不是一个好的长期解决方案，因为它会阻止编译器执行任何涉及该变量的优化。

另一种解决方法是使用良好的老式日志记录。就像是：

```
NSLog(@"Entries initialized as: %@", tlEntries); 
```

最后，您还可以使用`-O0`. 许多人建议将其用于*Debug*项目配置文件。尽管它阻止了优化，但它使调试更加容易。单步执行语句实际上是可预测的，并且可以查看变量。不幸的是，我认为它与 Apple 发布的 gcc 版本有一个相当讨厌的副作用：何时`-O0`生效，您无法在初始化之前收到有关使用变量的警告。（我个人觉得这个警告很有用，我愿意忍受调试不方便的痛苦。）

PS您在发布的片段中有内存泄漏；为清楚起见，应添加一行：

```
[tlEntries release]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:33:00.693

假设您以后从不使用此变量（如果编译器对其进行了优化，这似乎是合理的），您可以用来解决问题的一种非常重要的方法（类似于 Dietrich 的示例，尽管对您的程序更好）是执行以下操作：

```
[tlEntries release]; 
```

否则，您肯定会泄漏该内存。这将使编译器看到稍后使用的对象（就像 NSPrint 一样），因此它不会被优化。

# c# - ASP.Net 搜索子目录

> ID：942842
> 
> 赞同：0
> 
> 时间：2009-06-03T02:43:18.413
> 
> 标签：c#, asp.net

如何在我的 ASP.Net 网站中搜索子目录？

我知道如果这是一个常规的 Winform 项目，我可以通过以下方式轻松获得它：

```
Environment.CurrentDirectory 
```

或者

```
System.IO.Directory.GetCurrentDirectory() 
```

然后

```
string[] directories = System.IO.Path.Combine(Environment.CurrentDirectory, "Portfolio") 
```

如何在 ASP.Net 中构建名为 Portfolio 的子文件夹的路径？

我在从[http://??????????/Portfolio](http://??????????/Portfolio)构建所有内容时遇到问题。怎么找到？？？？？？部分？

我尝试了上面的代码，但得到了一个完全不同的目录......

我不想在最后一个子文件夹之前对所有内容进行硬编码，因为它在另一台服务器上会有所不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T02:48:36.373

`Directory.GetCurrentDirectory()`从 ASP.NET 应用程序调用时，调用可能会产生误导。解决此问题的最佳方法是[`Server.MapPath()`](http://msdn.microsoft.com/en-us/library/ms524632.aspx)改用它，这将允许您将 Web 文件夹映射到其在磁盘上的位置。

例如，运行以下代码：

```
string path = Server.MapPath("~/Portfolio"); 
```

将设置 ' `path`' 等于该文件夹在磁盘上的位置。

如果您从一个`Page`或控件类的上下文之外运行此代码，您将无法`Server`直接访问该对象。在这种情况下，您的代码将如下所示：

```
string path = HttpContext.Current.Server.MapPath("~/Portfolio"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T02:47:59.387

如果我理解正确，您可以通过以下方式访问它：

```
"/portfolio" 
```

系统会将“/portfolio”连接到 url，例如，如果它是“ [http://site.com](http://site.com) ”，您将得到“ [http://site.com/portfolio](http://site.com/portfolio) ”

如果你想要物理路径，你可以使用

```
server.mappath("/portfolio") 
```

它将返回关联的物理目录（例如 E:\websites\site\portfolio"）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T07:40:58.700

以下几行将您带到“bin”目录

```
Assembly asm = Assembly.GetExecutingAssembly();
String strAppHome = Path.GetDirectoryName(asm.CodeBase).Replace("file:\\", ""); 
```

# sql - 如何在 Oracle 10g 中每年自动将序列的值重置为 0？

> ID：942844
> 
> 赞同：6
> 
> 时间：2009-06-03T02:44:54.713
> 
> 标签：sql, oracle

如问题所示，如何在 Oracle 10g 中每年自动将 Oracle 序列的值重置为 0？

我正在使用序列生成格式中的标识符，`YYYY<sequence value>`并且序列值必须每年重置为 0。

`YYYY`从 java 获得并与来自 Oracle 的序列值连接。由于外部 3rd 方的要求，标识符的格式无法更改。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T02:58:59.660

序列并不是真正设计用于重置的。但是在某些情况下需要重置序列，例如，在设置测试数据或将生产数据合并回测试环境时。这种类型的活动通常*不会*在生产中进行。

如果这种类型的操作要投入生产，则需要进行彻底的测试。（最令人担忧的是重置过程可能会在错误的时间意外执行，例如在年中。

删除并重新创建序列是一种方法。作为一项操作，就 SEQUENCE 而言，它相当简单：

```
    删除序列 MY_SEQ;
    CREATE SEQUENCE MY_SEQ START WITH 1 INCREMENT BY 1 MINVALUE 0;

```

[编辑] 正如 Matthew Watson 正确指出的那样，每个 DDL 语句（例如 DROP、CREATE、ALTER）都会导致隐式提交。[/编辑]

但是，在 SEQUENCE 上授予的任何权限都将被删除，因此需要重新授予这些权限。任何引用该序列的对象都将失效。为了更通用，您需要保存权限（在删除序列之前），然后重新授予它们。

第二种方法是 ALTER 现有的 SEQUENCE，而不删除并重新创建它。重置序列可以通过将 INCREMENT 值更改为负值（当前值与 0 之间的差），然后恰好执行一次 .NEXTVAL 将当前值设置为 0，然后将 INCREMENT 更改回 1 来完成。我之前使用过同样的方法（手动，在测试环境中），也将序列设置为更大的值。

当然，要使其正常工作，您需要**确保**在执行此操作时没有其他会话引用该序列。在错误的时刻额外的 .NEXTVAL 会搞砸复位。（注意：如果应用程序作为序列的所有者而不是作为单独的用户连接，则在数据库端实现这一点将很困难。）

要让它每年都发生，你需要安排一份工作。序列重置必须与标识符的 YYYY 部分的重置相协调。

这是一个例子：

[http://www.jaredstill.com/content/reset-sequence.html](http://www.jaredstill.com/content/reset-sequence.html)

[编辑]

**用于重置序列的 PL/SQL 块的一种可能设计的**UNTESTED占位符****

 **```
    宣布
      编译指示自治事务；
      ln_increment 数；
      ln_curr_val 编号；
      ln_reset_increment 数；
      ln_reset_val 编号；
    开始

      -- 保存序列的当前 INCREMENT 值
      选择 increment_by
        进入 ln_increment
        来自用户序列
       其中 sequence_name = 'MY_SEQ';

      -- 确定重置序列所需的增量值
      -- 从下一个获取的值到 0
      从 dual 中选择 -1 - MY_SEQ.nextval 到 ln_reset_increment；

      -- 获取下一个值（使其成为当前值）
      从 dual 中选择 MY_SEQ.nextval 到 ln_curr；

      -- 将序列的增量值更改为
      EXECUTE IMMEDIATE '改变序列 MY_SEQ 递增 '
        || ln_reset_increment ||' 最小值 0';

      -- 推进序列以将其设置为 0
      从 dual 中选择 MY_SEQ.nextval 到 ln_reset_val；

      -- 将增量设置回之前（已保存）的值
      EXECUTE IMMEDIATE '改变序列 MY_SEQ 递增 '
        || ln_increment ;
    结尾;
    /

```

笔记：

*   如何在重置序列时最好地保护序列不被访问，重命名它？
*   这里有几个测试用例要完成。
*   第一遍，检查正、升、增1序列的规范案例。
*   更好的方法是创建新序列、添加权限、重命名现有序列和新序列，然后重新编译依赖项？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T07:03:15.220

只是把它作为一个想法扔出去：

如果您想要一个不需要持续 DDL（即不需要删除和创建或重置序列）甚至任何工作的解决方案，您可以考虑这样的事情（这只是原则上，我没有测试过这种方法，但我确定它会工作）：

1.  创建一个序列。

2.  创建一个参考表，每一年都有一行，例如

    YEARS（年份 NUMBER(4,0) PRIMARY KEY，starting_value NUMBER）

3.  当您从序列中获取时，您必须从当年的 YEARS 表中`NEXTVAL`减去查询时间。`starting_value`如果未找到年份，则应插入新行（即在任何给定年份运行的第一个进程将插入新值）。

例如一个函数，例如`get_year_starting_value (pn_year IN NUMBER) RETURN NUMBER`可以查询这个表并返回`starting_value`给定年份的；如果它得到`NO_DATA_FOUND`，它可以调用一个过程来使用`NEXTVAL`from 序列插入它（在自治事务中提交，以便新值立即可用于其他会话，并且函数不会因副作用而失败）

可能不是所有情况的解决方案，但我认为这种方法至少在某些情况下可能会有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T06:49:30.973

使用工作来解决问题。首先，创建一个存储过程来重置您的序列（我通常使用 DROP/CREATE 解决方案，但您可以使用[spencer7593](https://stackoverflow.com/questions/942844/how-do-i-automatically-reset-a-sequences-value-to-0-every-year-in-oracle-10g/942869#942869)的技巧）：

```
CREATE OR REPLACE PROCEDURE my_seq_reset AS
BEGIN
    EXECUTE IMMEDIATE 'DROP SEQUENCE my_seq';
    EXECUTE IMMEDIATE
      'CREATE SEQUENCE my_seq' ||
      '  MINVALUE 1 ' ||
      '  MAXVALUE 999999 ' ||
      '  START WITH 1 ' ||
      '  INCREMENT BY 1 ' ||
      '  NOCACHE';
END; 
```

然后创建作业（[请参阅此处](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_sched.htm#ARPLS138)以获取参考）：

```
BEGIN
  dbms_scheduler.create_job(
    job_name        => 'job$my_seq_reset',
    job_type        => 'STORED_PROCEDURE',
    job_action      => 'my_seq_reset',
    start_date      => TO_DATE('01-01-09', 'DD-MM-RR'),
    repeat_interval => 'FREQ=YEARLY;BYDATE=0101',
    enabled         => TRUE,
    auto_drop       => FALSE,
    comments        => 'My sequence yearly reset job.'
  );
END; 
```

你完成了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T02:58:11.847

我不确定有没有好的方法来做到这一点，这并不是序列设计的真正目的。它们只是纯粹增加唯一数字。

2个想法浮现在脑海。

1.  在第一个上午 12 点，重置序列，这很难，因为您需要确保您击败任何代码。
2.  为每年创建一个序列，甚至可以在您的代码中使用它以便能够创建序列，然后动态调用该年的正确序列。

我倾向于选择选项 2，因为它不会尝试做任何花哨的事情并且总是会成功地工作，任何试图操纵序列本身的选项都一定会咬你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T02:59:46.040

首先，这似乎不是一种让序列每年自动重启的方法。阅读此内容以供参考：

[http://www.psoug.org/reference/OLD/sequences.html?PHPSESSID=5949da378678fa6d24b6fcc6eaae9888](http://www.psoug.org/reference/OLD/sequences.html?PHPSESSID=5949da378678fa6d24b6fcc6eaae9888)

我的方法是：

1.  创建一个包含年份和起始顺序的表（让我们将此表称为 year_seed）

2.  创建一个接收年份的过程，检查 year_seed 表，如果它是该年份的第一次检查，则生成具有起始序列的寄存器。此过程还必须返回序列减去年份的起始序列。

也许它不是那么简单，但我认为这是最好的解决方案。祝你好运

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-27T15:03:45.820

我发现最好创建一个触发器和一个表。该表将包含年份和年份顺序。触发器获取当前年份，验证表，如果没有找到注册表，则从 1 开始插入一个新的。否则，选择最后一个并递增 1，更新相应的表。

**表**：_

```
create table GDRDOCUMENTOSEQ
(
  noano NUMBER(4),
  noseq NUMBER(6)
)
;
alter table GDRDOCUMENTOSEQ
  add unique (NOANO); 
```

**触发器**：_

```
CREATE OR REPLACE TRIGGER "GDRGUIARESSARCIMENTONODOC_BIR"
BEFORE INSERT ON GDR.GDRGUIARESSARCIMENTO
FOR EACH ROW

DECLARE
  lNoAno number;
  lNoSeq number;
  lQtd   number;
begin

  SELECT EXTRACT(YEAR FROM SYSDATE) into lNoAno FROM DUAL;

  SELECT COUNT(0)
    INTO lQtd
    FROM gdr.gdrdocumentoseq ds
   WHERE ds.noano = lNoAno;

  IF lQtd = 0 then
    lNoSeq := 1;
    INSERT INTO GDR.GDRDOCUMENTOSEQ (NOANO, NOSEQ) VALUES (lNoAno, lNoSeq);
  else
    SELECT nvl(max(ds.noseq), 0) + 1
      INTO lNoSeq
      FROM gdr.gdrdocumentoseq ds
     WHERE ds.noano = lNoAno;

    UPDATE GDR.GDRDOCUMENTOSEQ ds
       SET ds.noseq = lNoSeq
     WHERE ds.noano = lNoAno;
  end if;

  :new.nodocumento := SUBSTR(lNoAno, 3) || lpad(lNoSeq, 6, '0');

end; 
```

我从 2016 年开始在生产中运行此代码。表的当前状态是：

```
NOANO   NOSEQ   
2017    1411    
2016    237 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-22T21:40:00.837

```
create or replace procedure Reset_Sequence(pSeqName in varchar2) is
  vLastValue number;
begin
  execute immediate 'select ' || pSeqName || '.nextval from dual'
    INTO vLastValue;

  execute immediate 'alter sequence ' || pSeqName || ' increment by -' ||
                    vLastValue || ' minvalue 0';

  execute immediate 'select ' || pSeqName || '.nextval from dual'
    INTO vLastValue;

  execute immediate 'alter sequence ' || pSeqName ||
                    ' increment by 1 minvalue 0';

end; 
```

# iphone - iphone safari http地址分词

> ID：942846
> 
> 赞同：0
> 
> 时间：2009-06-03T02:46:43.507
> 
> 标签：iphone, url, safari, long-integer, break

有没有办法在 iphone safari 中“断字”一个长的 http 地址？

目前有长http地址：即 [http://long/website/address/to/be/displayed/on/iphone/safari](http://long/website/address/to/be/displayed/on/iphone/safari)

safari 会将其呈现在一行中，从而影响用户现在必须水平滚动的页面和其他内容。

有没有办法让 safari 显示：

```
http://long/website/address/to/
be/displayed/on/iphone/safari 
```

?

也许css关键字类似于IE中的分词？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:33:48.477

在每个 / 之后添加“Hair Spaces”。头发空间在屏幕上不可见，但可以并且将被 Safari 用作潜在的环绕点。净效果正是您所要求的。

为此：

1) 您的页面必须被解释为 UTF-8 字符集。

2) 将每个 / 更改为 /&x200A; -- 这样中断将在 / 之后。对所有 / 进行替换。Safari 会选择最好的包装。

有关换行符的更多信息，请参见[http://www.unicode.org/unicode/reports/tr14/tr14-17.html 。](http://www.unicode.org/unicode/reports/tr14/tr14-17.html)

拉里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T06:49:38.257

我使用 { word-break: break-word; } 所以浏览器可以把它分成新行。

# grails - 使用 extjs 和 grails 的经验？

> ID：942847
> 
> 赞同：8
> 
> 时间：2009-06-03T02:47:14.753
> 
> 标签：grails, extjs

有没有人使用 extjs 作为前端构建了一个 grails 应用程序？

您是否愿意分享任何陷阱或陷阱？

看起来`JSON`grails 默认输出的格式与 extjs 所期望的完全不同，但这只是侧面自定义的`JSON`问题吗？`grails`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T08:26:06.097

我经常使用 Grails + ExtJS 的组合，它很容易实现。通过在控制器中执行以下操作可以轻松实现网格的 JSON 输出：

```
def list = {
   def books = Book.list(params)    
   render( [ items: books, totalCount: Book.count() ] as JSON )
} 
```

这将产生“Ext-compatible” JSON，如：

```
{"items":[{"class":"Book","id":1,"title:"The Definitive Guide to Grails","author":"Graeme Rocher",... 
```

这是一个关于如何初始化 JsonStore 的示例：

```
var store = new Ext.data.JsonStore({
   url: '${createLink( action: 'list' )}',
   root: 'items',
   totalProperty: 'totalCount',
   fields: [ 'id','title','author','isdn', 'dateCreated' ],
   paramNames: { start : "offset", limit :"max", sort : "sort", dir : "order" }
}); 
```

在处理日期值时，IMO 的最佳做法是为 JSON 转换器启用 Javascript 日期格式（即，日期值将呈现为`new Date(123123123)`默认格式“2009-04-16T00:00:00Z”），所以你不必关心日期格式或时区的东西。您可以通过在 grails-app/conf/Config.groovy 中配置它来做到这一点：

```
grails.converters.json.date = 'javascript' 
```

我还实现了网格过滤器插件的服务器端功能、组合框实现的各种组合（带有远程自动完成）、树、表单等。如果您想查看更多示例代码，请告诉我。

ExtJS 3.0（目前为 RC）与 Grails 集成得更好，因为 DataStores 提供了将数据发送回后端以进行持久化的选项。Ext.Direct 方法也提供了新的可能性:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-06T20:28:17.377

看到这个

[http://ffzhuang.blogspot.com/2009/03/build-j2ee-application-with-extjs.html](http://ffzhuang.blogspot.com/2009/03/build-j2ee-application-with-extjs.html)

这是一个很好的例子，整个网站 www.feyasoft.com 在 extjs + grails 下运行。您可以试试我们的日历 - 开源。

# java - java链异常

> ID：942849
> 
> 赞同：2
> 
> 时间：2009-06-03T02:48:01.850
> 
> 标签：java

我对链异常有疑问

```
try{ } catch(Exception e) { throw new SomeException(); } 
```

如果我这样做，我的 Eclipse 将在 throw new SomeException(); 行提示错误 说明“未处理的异常”，我必须输入类似

```
try{ } catch(Exception e) {
                            try{ throw new SomeException(); } catch(Exception e){} 
                           } 
```

为什么必须这样做，因为我阅读的教程.example [http://java.sys-con.com/node/36579](http://java.sys-con.com/node/36579)，不必这样做

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T02:51:20.673

`throws`如果该异常是已[检查异常](http://java.sun.com/docs/books/jls/second_edition/html/exceptions.doc.html#44121)，则您需要将该方法声明为另一个异常。

（“未检查异常类是 RuntimeException 类及其子类，以及 Error 类及其子类。所有其他异常类都是已检查异常类。”—— [Java 语言规范，第二版，第 11.2 节](http://java.sun.com/docs/books/jls/second_edition/html/exceptions.doc.html#44121)）

例如，而不是：

```
void someMethod {
    try {
        // Do something that raises an Exception.
    } catch (Exception e) {
        throw new SomeException();    // Compile error.
    }
} 
```

A`throws`需要添加到方法声明中：

```
void someMethod throws SomeException {
    try {
        // Do something that raises an Exception.
    } catch (Exception e) {
        throw new SomeException();    // No problem.
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T02:50:05.390

这取决于 SomeException 是否是已检查的异常。如果是（它扩展了 Exception 但不是 RuntimeException），那么您必须在方法上声明它或者改为抛出 RuntimeException。

这就是你的代码应该是这样的：

```
...) throws SomeException {
....
try {
 ....
} catch (Exception e) {
   throw new SomeException(e);
} 
```

如果某些异常没有接受异常的构造函数，则执行以下操作：

```
throw (SomeException) new SomeException().initCause(e); 
```

这样，当最终捕获到异常时，您就知道问题的根本原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T02:50:04.717

您的方法必须声明它可能会抛出该异常。所以，你必须添加：

```
throws SomeException { 
```

在方法标题的末尾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T02:51:28.303

您需要在方法声明中添加“throws SomeException”。您需要指定您的方法抛出的任何异常类型，但源自 RuntimeException 的异常除外。

# asp.net - 如何在 JavaScript 中序列化具有 Int64 类型的变量而不损失准确性？

> ID：942854
> 
> 赞同：0
> 
> 时间：2009-06-03T02:50:36.387
> 
> 标签：asp.net, javascript, serialization, int64

如何在 JavaScript 中序列化具有 Int64 类型的变量而不损失准确性？我的开发平台是。网。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:17:54.083

Int64 来自哪里？为什么你需要它在 JavaScript 中是 Int64？你只需要它作为一个字符串吗？一些代码会有所帮助。

如果你需要一个 JavaScript bigint 库，这里有[一个](http://www.leemon.com/crypto/BigInt.js)。

# django - Django 开发是否遵循 Bazaar 开发模式？

> ID：942857
> 
> 赞同：0
> 
> 时间：2009-06-03T02:51:11.940
> 
> 标签：django, open-source, coding-style, bazaar

有人会争辩说，[Bazaar 开发模式会导致](http://en.wikipedia.org/wiki/The_Cathedral_and_the_Bazaar)[牛仔代码](http://en.wikipedia.org/wiki/Cowboy_coding)的混乱。

我想知道，Django 遵循哪种模式？乍一看，它似乎是一个高度组织化的集市模式，具有审查和分类阶段等。但是，源代码*始终*可用，但并非每个补丁或建议都会随机添加到代码库中。同样，主要版本（0.96、1.0、1.0.2、1.1 等）在其演示中有些大教堂。

它是什么，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T08:24:38.300

这是一个开源项目，因此可以描述为遵循 Bazaar 模式。但是，我认为这个问题的根源在于对那是什么的误解。

该模型中没有任何内容可以坚持将任何随机垃圾提交给代码。我从来没有听说过一个开源项目是这样的（也许是因为随后的任何事情都确实是一团糟，而且不太可能成功）。

同样，该模型中没有任何内容可以说明您不能拥有主要版本号。这些只是当时代码的快照。您可以下载和部署代码，因为它是版本 1.0.2 之前或之后的一次提交，没有什么可以阻止您。

# asp.net - 压缩过滤器 + MVC + Yahoo YSlow

> ID：942861
> 
> 赞同：5
> 
> 时间：2009-06-03T02:53:03.637
> 
> 标签：asp.net, asp.net-mvc, gzip

我一直在使用雅虎的 YSLOW 来尝试让我的页面在[AgentX上运行得更快](http://www.agentx.co.nz)

我正在使用下面的压缩过滤器。当我通过 Visual Studio 运行该站点时，YSLOW 说所有文件都已压缩，当我查看实时站点时，我得到一个 A，它得到一个 E，并说我的文件需要压缩。谁能解释一下？

```
 public class CompressFilter : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        HttpRequestBase request = filterContext.HttpContext.Request;

        string acceptEncoding = request.Headers["Accept-Encoding"];

        if (string.IsNullOrEmpty(acceptEncoding)) return;

        acceptEncoding = acceptEncoding.ToUpperInvariant();

        HttpResponseBase response = filterContext.HttpContext.Response;

        if (acceptEncoding.Contains("GZIP"))
        {
            response.AppendHeader("Content-encoding", "gzip");
            response.Filter = new GZipStream(response.Filter,
                CompressionMode.Compress);
        }
        else if (acceptEncoding.Contains("DEFLATE"))
        {
            response.AppendHeader("Content-encoding", "deflate");
            response.Filter = new DeflateStream(response.Filter, 
                CompressionMode.Compress);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-05T08:06:43.157

我在我的网站上使用相同的机制：

[http://www.avantprime.com/articles/view-article/7/compress-httpresponse-for-your-controller-actions-using-attributes](http://www.avantprime.com/articles/view-article/7/compress-httpresponse-for-your-controller-actions-using-attributes)

我建议使用 fiddler 来查看您来自实时站点的响应是否实际被压缩，然后您可以确定 YSlow 或您的代码是否有问题。

我建议您也运行 google pagespeed [http://code.google.com/speed/page-speed/](http://code.google.com/speed/page-speed/)。这与 YSlow 的工作相同，但由谷歌制作。某些事情的不同算法。

大部落

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:57:08.540

您是否在 IIS 6 上运行生产？也许这会有所帮助。 [IIS6 中的 ASP.NET MVC 压缩选项](https://stackoverflow.com/questions/649440/asp-net-mvc-compression-options-in-iis6)

# php - Zend Studio SVN——如何判断文件是否被其他用户锁定？

> ID：942867
> 
> 赞同：0
> 
> 时间：2009-06-03T02:58:04.453
> 
> 标签：php, svn, zend-studio

有谁知道如何使用 Zend Studio IDE 判断文件当前是否被 svn 中的另一个用户锁定？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T09:02:54.883

您可以在真正需要锁定的文件上添加 svn:needs-lock 属性。这样文件在磁盘上将是只读的。使它们可写的方法是锁定文件。当您锁定已被其他用户锁定的文件时，您会收到通知。

通常不需要知道哪些文件被锁定，直到您想锁定同一个文件

# c# - .NET 中的双队列生产者-消费者（强制成员变量刷新）

> ID：942880
> 
> 赞同：1
> 
> 时间：2009-06-03T03:02:31.447
> 
> 标签：c#, multithreading, concurrency

我有一个线程，它以简单对象（记录）的形式生成数据。线程可能会为每个成功通过过滤器并实际入队的记录生成一千条记录。一旦对象入队，它就是只读的。

我有一个锁，一旦记录通过过滤器，我就会获得它，并将项目添加到 producer_queue 的后面。

在消费者线程上，我获取锁，确认 producer_queue 不为空，将 consumer_queue 设置为等于 producer_queue，创建一个新（空）队列，并将其设置在 producer_queue 上。在没有任何进一步锁定的情况下，我处理 consumer_queue 直到它为空并重复。

一切在大多数机器上都运行良好，但在一个特定的双四服务器上，我在 ~1/500k 迭代中看到一个对象，当我从 consumer_queue 中读取它时，它没有完全初始化。条件是如此短暂，以至于当我在检测到条件后转储对象时，90% 的时间字段都是正确的。

所以我的问题是这样的：当队列被交换时，如何确保对对象的写入被刷新到主内存？

编辑：

在生产者线程上：（上面的producer_queue是m_fillingQueue；上面的consumer_queue是m_drainingQueue）

```
private void FillRecordQueue() {
  while (!m_done) {
    int count;
    lock (m_swapLock) {
      count = m_fillingQueue.Count;
    }
    if (count > 5000) {
      Thread.Sleep(60);
    } else {
      DataRecord rec = GetNextRecord();
      if (rec == null) break;
      lock (m_swapLock) {
        m_fillingQueue.AddLast(rec);
      }
    }
  }
} 
```

在消费者线程中：

```
private DataRecord Next(bool remove) {
  bool drained = false;
  while (!drained) {
    if (m_drainingQueue.Count > 0) {
      DataRecord rec = m_drainingQueue.First.Value;
      if (remove) m_drainingQueue.RemoveFirst();
      if (rec.Time < FIRST_VALID_TIME) {
        throw new InvalidOperationException("Detected invalid timestamp in Next(): " + rec.Time + " from record " + rec);
      }
      return rec;
    } else {
      lock (m_swapLock) {
        m_drainingQueue = m_fillingQueue;
        m_fillingQueue = new LinkedList<DataRecord>();
        if (m_drainingQueue.Count == 0) drained = true;
      }
    }
  }
  return null;
} 
```

消费者是限速的，所以它不能领先于消费者。

我看到的行为是有时 Time 字段读取为 DateTime.MinValue; 但是，当我构造字符串以引发异常时，一切都很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:39:06.907

您是否尝试过显而易见的事情：是否在花哨的 8 核机器上应用了微码更新（通过 BIOS 更新）？您是否运行 Windows 更新以获取最新的处理器驱动程序？

乍一看，您似乎正在锁定您的容器。所以我推荐系统方法，因为听起来你没有在一个好的双核盒子上看到这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:51:02.287

假设这些实际上是与`m_fillingQueue`变量交互的唯一方法，并且在创建它`DataRecord`之后无法更改`GetNextRecord()`（希望是只读属性？），那么代码至少从表面上看是正确的。

在这种情况下，我建议首先检查 GregC 的答案；确保故障机器已完全更新（操作系统/驱动程序/.NET Framework），因为该`lock`语句应涉及所有必需的内存屏障，以确保`rec`在将对象添加到列表之前将变量完全清除出任何缓存。

# c# - C# 和 .NET 中是否存在 Java URIResolver 概念？

> ID：942882
> 
> 赞同：3
> 
> 时间：2009-06-03T03:03:46.017
> 
> 标签：c#, .net, xslt

在 Java XML 转换包中，有一个称为[URIResolver](http://java.sun.com/webservices/docs/1.6/api/javax/xml/transform/URIResolver.html)的概念，它是“实现此接口的对象，处理器可以调用该对象来转换 document()、xsl:import 或 xsl:include 中使用的 URI到源对象中。”

所以，如果你的 XSL 有这样的导入

```
<xsl:import href="URI"/> 
```

这允许您获取 URI 并将其映射到您选择的[源](http://java.sun.com/webservices/docs/1.6/api/javax/xml/transform/Source.html)- 可能它来自数据库，或者您可能希望将 URI 映射到另一个 URI。这很有用，因为您不能`xsl:variable`在`xsl:import href`.

这是一些创建转换器并执行转换的示例 Java 代码。

```
URIResolver uriResolver = new MyURIResolver();  // sample
TransformerFactory transformerFactory = TransformerFactory.newInstance();
transformerFactory.setURIResolver(uriResolver);
Transformer transformer = transformerFactory.newTransformer();
transformer.setURIResolver(uriResolver);
transformer.transform(xml, result); 
```

注意，代码中有两个地方用到了 URIResolver：

*   TransformerFactory [setURIResolver](http://java.sun.com/webservices/docs/1.6/api/javax/xml/transform/TransformerFactory.html#setURIResolver(javax.xml.transform.URIResolver)) - “设置在转换期间默认使用的对象，以解析 document()、xsl:import 或 xsl:include 中使用的 URI。”
*   Transformer [setURIResolver](http://java.sun.com/webservices/docs/1.6/api/javax/xml/transform/Transformer.html#setURIResolver(javax.xml.transform.URIResolver)) - “设置一个对象，用于解析 document() 中使用的 URI。”

**问**：在 C# 和 .NET 中是否有与 Java URIResolver 类似的概念？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-08T04:31:23.703

是的，它叫[`XmlResolver`](http://msdn.microsoft.com/en-us/library/system.xml.xmlresolver.aspx).

`XmlResolver`是`System.Xml`抽象之一，这意味着您可以在各种 API 中使用它，例如[`XslCompiledTransform`](https://msdn.microsoft.com/en-us/library/0610k0w4%28v=vs.110%29.aspx), `XmlDocument`, `XmlReader`(via `XmlReaderSettings`) 等。

这里更深入地介绍了它的工作原理，以及如何[实现自己的解析器](http://msdn.microsoft.com/en-us/library/aa302284.aspx)。

默认情况下，这些不同的 API 使用，它可以解析以和[`XmlUrlResolver`](http://msdn.microsoft.com/en-us/library/system.xml.xmlurlresolver.aspx)开头的 URI 。`http://``file://`

此外，为了解析外部实体，您可以覆盖on的默认[`ResolveEntity`方法](https://msdn.microsoft.com/en-us/library/system.xml.xmlreader.resolveentity%28v=vs.110%29.aspx)`XmlReader`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:17:14.787

是的，模拟存在。
[IXmlNamespaceResolver](http://msdn.microsoft.com/en-us/library/system.xml.ixmlnamespaceresolver.aspx) 以及实现接口的[XmlNamespaceManager 。](http://msdn.microsoft.com/en-us/library/system.xml.xmlnamespacemanager.aspx)

@Lame Duck，我认为您误解了这个问题。

# java - (Java) Appearing/Disappearing JLabel in a JPanel only disappears on resize

> ID：942883
> 
> 赞同：0
> 
> 时间：2009-06-03T03:04:42.270
> 
> 标签：java, resize, jframe, jpanel, repaint

I'm working in Java, and I have a JPanel in a JFrame. In that JPanel, among other things, I have a JLabel that I want to make appear and disappear at will. I've tried setting visibility to true/false, adding and removing it from the JFrame and JPanel, and, having looked online, I tried validate()ing and revalidate()ing ad infinitum. What can be done here to solve this problem?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T03:08:36.397

In general, calling the `setVisible` method is sufficient to make a Swing component to be shown or hidden.

Just to be sure that it works, I tried the following:

```
public class Visibility {
  private void makeGUI() {
    JFrame f = new JFrame();
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    final JLabel l = new JLabel("Hello");
    final JButton b = new JButton("Hide Label");
    b.addActionListener(new ActionListener() {
      public void actionPerformed(ActionEvent e) {
        l.setVisible(false);
      }
    });

    f.getContentPane().setLayout(new BorderLayout());
    f.getContentPane().add(l, BorderLayout.CENTER);
    f.getContentPane().add(b, BorderLayout.SOUTH);
    f.setSize(200, 200);
    f.setLocation(200, 200);
    f.validate();
    f.setVisible(true);
  }

  public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
      public void run() {
        new Visibility().makeGUI();
      }
    }); 
  }
} 
```

The above program is able to affect the visibility by clicking on a `JButton`.

**Could it be a Threading Issue?**

My next suspicion was that perhaps a `Thread` that is not on the [event dispatch thread (EDT)](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html) may not be affecting the display immediately, so I added the following after initializing the `JLabel` and `JButton`.

```
Thread t = new Thread(new Runnable() {
  public void run() {
    while (true) {
      b.setVisible(!b.isVisible());

      try {
        Thread.sleep(100);
      } catch (InterruptedException e) { /* Handle exception /* }
    }
  }
});

t.start(); 
```

With the new `Thread` running, it changed the toggled the visibility of the `JLabel` every 100 ms, and this also worked without a problem.

Calling a Swing component off the [event dispatch thread (EDT)](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html) is a bad thing, as Swing is not thread-safe. I was a little surprised it worked, and *the fact that it works may just be a fluke*.

**Repaint the `JPanel`?**

If the `JLabel`'s visibility is only being affected on resizing, it probably means that the `JLabel` is being drawn only when the `JPanel` is being repainted.

One thing to try is to call the `JPanel`'s [`repaint`](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#repaint()) method to see if the visibility of the `JLabel` will change.

But this method seems to be just a band-aid to a situation, if the main cause is due to a thread off the EDT is attempting to make changes to the GUI. (Just as a note, the `repaint` method is thread-safe, so it can be called by off-EDT threads, but relying on `repaint` is a workaround than a solution.)

**Try using `SwingUtilities.invokeLater`**

Finally, probably the thing I would try is the [`SwingUtilities.invokeLater`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater(java.lang.Runnable)) method, which can be called (and should only be called) from a thread running separate from the EDT, if it wants to affect the GUI.

So, the earlier `Thread` example should be written as:

```
Thread t = new Thread(new Runnable() {
  public void run() {
    while (true) {
      try {
        SwingUtilities.invokeLater(new Runnable() {
          public void run() {
            b.setVisible(!b.isVisible());
          }
        });
      } catch (Exception e1) { /* Handle exception */ }

      try  {
        Thread.sleep(100);
      } catch (InterruptedException e) { /* Handle exception */ }
    }
  }
});

t.start(); 
```

If the change to the GUI is indeed occurring on a separate thread, then I would recommend reading [Lesson: Concurrency in Swing](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/) from [The Java Tutorials](http://java.sun.com/docs/books/tutorial/index.html) in order to find out more information on how to write well-behaving multi-threaded code using Swing.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T03:26:48.950

setVisible() or removing it should work fine, make sure you are doing it from the event dispatch thread though. There are utility methods in EventQueue for running blocks in that thread.

[http://helpdesk.objects.com.au/java/how-do-i-update-my-gui-from-any-thread](http://helpdesk.objects.com.au/java/how-do-i-update-my-gui-from-any-thread)

You would need to call revalidate() on the parent JPanel if you need its components to be re-laid out.

If you can post an example that demonstrates the problem I can have a look at it for you.

# c++ - 使用 Visual C++ 设计器控制主窗口？

> ID：942888
> 
> 赞同：3
> 
> 时间：2009-06-03T03:08:46.897
> 
> 标签：c++, winapi, form-designer

是否可以在主窗口上使用 Visual C++ 设计器绘制控件，就像设计对话框一样？我希望能够在不使用 MFC 的情况下以这种方式设计主窗口控件，而不是在 WM_CREATE 上创建它们。

编辑：我不想要基于对话框的应用程序，只是为了能够以图形方式设计主窗口，类似于在 .NET 中使用 Windows 窗体设计器可以完成的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:21:53.187

我不确定我是否理解您希望您的应用看起来像什么。如果您希望您的应用程序成为一个对话框，则将其设为一个对话框应用程序。

只需创建一个新的 MFC 应用程序，并将其设置为“基于对话框”。现在您的应用程序将从该对话框开始。

如果您想使用本机 win32 应用程序，只需使用 CreateDialog（而不是 CreateWindow）在您的 InitInstance 中创建对话框。

在这两种情况下，您都使用资源编辑器来创建对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:06:42.250

您的选择是：

*   使用 MFC 并创建一个具有对话框视图（基于`CFormView`类）的主窗口。
*   使用 WinForms/.NET
*   使用 Qt。

如果您正在开始一个新项目并且想坚持使用 C++，那么我强烈推荐 Qt。它不仅是一个出色的框架，而且是跨平台的，因此您的应用程序可以在 Linux 和 Mac 上构建。

[http://www.qtsoftware.com/products/](http://www.qtsoftware.com/products/)

提供了一个 Visual C++ 插件，您可以使用名为 Qt Designer 的工具直观地设计主窗口。

# linq - LINQ 拉回对象图

> ID：942894
> 
> 赞同：0
> 
> 时间：2009-06-03T03:11:46.717
> 
> 标签：linq, grouping

是否可以在 LINQ 中按多个组进行分组？

例如，我有这个查询（显然不完整）

```
from lxr in LOCATION_XREFs
    join l in LOCATIONs on lxr.LOCATION_SKEY equals l.LOCATION_SKEY
    join c in COMPANies on l.COMPANY_SKEY equals c.COMPANY_SKEY
    join prlx in PeopleRoleLocationXrefs on lxr.LOCATION_XREF_SKEY equals prlx.LOCATION_XREF_SKEY
    join p in PEOPLEs on prlx.PEOPLE_SKEY equals p.PEOPLE_SKEY
    join pr in PeopleRoles on prlx.PeopleRoleKey equals pr.PeopleRoleKey 
```

......我想找回一群拥有大量地点的公司，这些地点反过来又拥有一群人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T03:23:02.827

如果您希望按多个参数进行分组，这是可能的：

```
from lxr in LOCATION_XREFs
    join l in LOCATIONs on lxr.LOCATION_SKEY equals l.LOCATION_SKEY
    join c in COMPANies on l.COMPANY_SKEY equals c.COMPANY_SKEY
    join prlx in PeopleRoleLocationXrefs on lxr.LOCATION_XREF_SKEY equals prlx.LOCATION_XREF_SKEY
    join p in PEOPLEs on prlx.PEOPLE_SKEY equals p.PEOPLE_SKEY
    join pr in PeopleRoles on prlx.PeopleRoleKey equals pr.PeopleRoleKey
group c by new { c.COMPANY_SKEY, l.LOCATION_SKEY} into myGroup
select new
{
    myGroup.Key.COMPANY_SKEY,
    myGroup.Key.LOCATION_SKEY,
    myGroup.Count()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T14:14:19.080

我最终使用以下代码来实现我想要的。有趣的注释：请注意，我希望将角色展平并用逗号连接，因此我使用使用聚合运算符的包装访问器来完成此操作。显然，聚合运算符不支持在 LINQ 查询中，`"the query operator "Aggregate" is not supported"`否则我会像这样内联地完成它`Roles = new List<string>(g.Select(u => u.pr.RoleName)).Aggregate((a, b) => a + ", " + b)`

```
public class DAOPerson
{
    public string Name { get; set; }
    public int PeopleSkey { get; set; }
    public List<string> RolesCollection { get; set; }
    public string Roles
    {
        get { return RolesCollection.Aggregate((a, b) => a + ", " + b); }
    }
}

IQueryable<DAOLocation> gridData;
gridData = (from lxr in db.LOCATION_XREFs
            join l in db.LOCATIONs on lxr.LOCATION_SKEY equals l.LOCATION_SKEY
            join c in db.COMPANies on l.COMPANY_SKEY equals c.COMPANY_SKEY
            where lxr.DEPARTMENT_NUMBER == Department.BINDING_AUTHORITY_KEY
                  && lxr.BRANCH_NUMBER == Branch.ATLANTAKEY
            orderby c.NAME, l.INTERNAL_NAME ascending
            select new DAOLocation
                       {
                           CompanyName = c.NAME,
                           CompanySkey = c.COMPANY_SKEY,
                           LocationName = l.INTERNAL_NAME,
                           LocationSkey = l.LOCATION_SKEY,
                           Persons = (from prlx in db.PeopleRoleLocationXrefs
                                      join lxr2 in db.LOCATION_XREFs on prlx.LOCATION_XREF_SKEY equals lxr.LOCATION_XREF_SKEY
                                      join p in db.PEOPLEs on prlx.PEOPLE_SKEY equals p.PEOPLE_SKEY
                                      join pr in db.PeopleRoles on prlx.PeopleRoleKey equals pr.PeopleRoleKey
                                      where lxr2.LOCATION_SKEY == l.LOCATION_SKEY
                                      group new { p, pr } by p.PEOPLE_SKEY into g
                                      select new DAOPerson
                                                 {
                                                     Name = g.First().p.LAST_NAME,
                                                     PeopleSkey = g.First().p.PEOPLE_SKEY,
                                                     RolesCollection = new List<string>(g.Select(u => u.pr.RoleName))
                                                 }).ToList()
                       }); 
```

# python - Python中的列表或字典更快吗？

> ID：942902
> 
> 赞同：5
> 
> 时间：2009-06-03T03:14:39.690
> 
> 标签：python, data-structures

就性能而言，这两者有多大区别？

```
tmp = []
tmp.append(True)
print tmp[0] 
```

和

```
tmp = {}
tmp[0] = True
print tmp[0] 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-03T03:21:04.313

标准库中的`timeit`模块就是为了回答这些问题而设计的！忘记`print`（这会产生向您的终端吐出东西的讨厌的副作用；-）并比较：

```
$ python -mtimeit 'tmp=[]; tmp.append(True); x=tmp[0]'
1000000 loops, best of 3: 0.716 usec per loop
$ python -mtimeit 'tmp={}; tmp[0]=True; x=tmp[0]'
1000000 loops, best of 3: 0.515 usec per loop 
```

所以，dict 是赢家 - 0.2 微秒...！-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T04:22:49.960

不仅微优化通常通常毫无意义，而且我发现它尤其对 Python 来说尤其困难和神秘。实际上使您的代码同时变得更慢和更复杂是非常容易的。有关最简单、最清晰和最短的 Python 解决方案也被证明是最快的示例，请参阅[这个 Stack Overflow 问题。](https://stackoverflow.com/questions/900420/elegant-way-to-compare-sequences)

正如其他人在实际测试中所显示的那样，您的两种选择之间的速度差异非常小。较小的是语义差异。列表和字典不仅仅是同一概念的两种实现，而是用于不同的用途。选择一个更适合您使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-18T16:05:55.407

得出结论认为dict是赢家的答案是错误的。

列表比 dicts 快（但不多）。

将项目添加到 dicts 需要 1.5 倍于列表的时间。

从 dicts 中查找值所需的时间是从列表中查找的时间的 1.3 倍。

应该将增长列表/字典的性能与从列表/字典中查找项目的性能分开。

更重要的是，存在的元素数量可能会影响添加新元素的效率，尤其是对于 dicts。

因此，最好让 list/dict 增长到大量元素，然后测量所有这些元素的查找。

像这样

```
from timeit import timeit
tmpList = []
tmpDict = {} 
```

```
timeListAdd = timeit("""
for i in range(1000000):
    tmpList.append(True)
""", globals=locals(), number=1)
print(timeListAdd) 
```

0.08886219099999959

```
timeDictAdd = timeit("""
for i in range(1000000):
    tmpDict[i]= True
""", globals=locals(), number=1)
print(timeDictAdd) 
```

0.1336365199999996

```
timeListAccess = timeit("""
for i in range(1000000):
    tmpList[i]
""", globals=locals(), number=1)
print(timeListAccess) 
```

0.06501517400000001

```
timeDictAccess = timeit("""
for i in range(1000000):
    tmpDict[i]
""", globals=locals(), number=1)
print(timeDictAccess) 
```

0.08099801200000023

顺便说一句，如果您在创建时了解所有元素，则有更好的方法来创建这些结构：

```
timeListCreate = timeit("""tmpList = [True for i in range(1000000)]""", globals=locals(), number=1)
print(timeListCreate) 
```

0.03953780500000903

```
timeDictCreate = timeit("""tmpDict = {i: True for i in range(1000000)}""", globals=locals(), number=1)
print(timeDictCreate) 
```

0.0972781530000475

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-06-03T03:25:26.533

他们在我的测试中是公平的

# scrum - Scrum 和精益原则会毁掉专业人士的生活吗？

> ID：942904
> 
> 赞同：0
> 
> 时间：2009-06-03T03:14:48.193
> 
> 标签：scrum, methodology

我使用 scrum 大约 2 个月，并没有我想要的所有经验，所以我想听听一些关于它的意见。

我担心的是人们从不谈论双方的弊端；公司和工人。我知道跨职能团队的好处，但有哪些缺点？令人惊叹的伊甸园旁边隐藏着什么？

我很困惑，因为作为一家公司可以更换人员的好处，对于团队来说是好的，因为有机会获得知识和分享经验（除了所有团队合作的好处）。

再一次，我知道所有的好处，但我想探索它的缺点，因为中间有普通人。通常，这些人致力于获取知识。他们购买书籍、课程、参加研讨会等。

在每家公司中，当某人比其他人都了解更多时，员工和经理会绝望地希望甚至要求这些普通人分享他们所有的知识。

这很奇怪。因为这些是共产主义思想，我们生活在资本主义社会中，自从我出生以来，一切都如此竞争，现在人们谈论合作。

Scrum 和精益原则会毁掉（或使他们变得艰难）专业人士的生活吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T03:25:37.313

Scrum 和精益本身不能毁掉任何人的生活。他们也不能单独创造你的生活。

与特定的产品管理或开发管理方法相比，您组织的文化始终是一个更重要的因素。Scrum 可能会被滥用。精益确实可以让员工感到可替代，并有压力让他们整天都在工作。

另一方面，这两种工具（它们只是工具）都可以用来创建高绩效团队，其中所有成员都重视彼此和彼此的贡献。加入一个以高速提供始终如一的良好结果的团队感觉很棒。

您还会发现介于两者之间的所有结果。它更多地取决于文化而不是过程。

我相信文化是从高层流出的。因此，看看公司领导如何对待彼此、他们的下属、他们的供应商和他们的客户。这将告诉你更多关于你的生活会是什么样子，而不是公司遵循哪种方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T13:04:23.507

我只想解决您关于共享知识会降低您自身价值的评论。在理想的团队文化中，知识本身并不像某人获得新知识和解决他们以前从未见过的问题的能力那么重要。当我想到我认识的明星工程师时，并不是因为他们知道这个或那个，而是因为很明显他们几乎可以胜任任何任务，几乎任何团队，他们都会开始解决问题并提高水平整个团队。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T17:54:13.170

我会假设，正如一位评论员所建议的那样，您的意思是要问：“ *Scrum 的缺点是什么？* ”

我认为 Scrum 最大的问题是它易于理解——但很难***正确***实施。Scrum 和 XP 一样，大多数方法论**都不是**建立在单独的原子实践之上，每一个都能够改进现有的过程。Scrum 需要改变组织的思维方式。它需要从以自我为中心的行为转变为集体行为。整个组织应始终专注于带来最大的价值，并且超越感知到的自身利益。例如，跨职能团队成员可能需要在他的舒适区之外做事情（能够尝试新的有趣任务的另一面），因为它需要由某人来完成。当团队领导和项目经理被要求担任仆人式领导的角色时，以及当他们被要求*停止时，他们需要放弃权力*告诉团队成员选择哪些任务，而不是依靠团队来管理自己。利益相关者被迫面对这样一个现实，即他们不能吃蛋糕，也不能完整地拥有它，当他们被迫在拥有他们想要的所有范围**或在他们想要完成的日期之前拥有它之间做出****选择**时（这**总是**正确的） ，但 Scrum 确实是在面对它）。

 ****最重要的是，Scrum 的缺点是它倾向于让初学者失望。这来自于人们期望它无法提供的东西：**解决他们的问题**！

这是正确的！Scrum*不能解决*组织的问题。它突出了它们。组织有责任挺身而出并为他们做点什么。顺便说一句，这是在我认为是 Scrum 中最重要的一个仪式——回顾展上完成的！如果你在 Scrum 中什么都不做——做回顾：

*   找出你做得好的地方，然后继续做。
*   找出你需要改进的地方，并采取一些措施来改进它。
*   冲洗并重复！

在 Ken Schwaber 在 Scrum 上向 Google 发表的演讲中，他曾经说过 Scrum 不一定对组织有益。它可以很早就告诉你，你的项目注定要失败。如果你避免使用 Scrum，你可能会有几个月的无知幸福来为你失去工作的那一天做好准备。有趣，但真实。考虑一下。

希望它有所帮助，阿萨夫。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T03:23:55.693

我不是任何特定方法（敏捷、Scrum 等）的专家，但我理解你的感受。我见过的最大问题之一是，一个对这种方法几乎不完全感兴趣的团队往往会遇到问题。一些异常值不是问题，但如果 1/3 或更多的团队不感兴趣，那将成为一场噩梦。编写好的软件很重要，公司应该聘请专业人士来帮助他们实现这一目标，但如果团队被迫实现这一目标而没有找到奖励经验的质量很快就会下降。

不，我不认为这会毁掉你的职业生涯，但如果一家公司头脑发热，没有意识到他们需要一个让员工找到有回报的工作的环境，那就太痛苦了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T14:51:55.990

我从敏捷方法中看到了一些东西，当你权衡它时我会反对它。

从开发人员的角度来看，有两件事：

1) 短冲刺通常会导致短期决策——这是预期的，但可能会让一些开发人员感到沮丧。虽然交付“刚好够用”对项目来说很好，但要求开发人员做一些他们知道他们将不得不大量重构（如果不重写）的事情，两个冲刺可能会令人沮丧。

2）如果你有固执己见的开发人员（还有其他类型的），我见过优先级冲突。不仅增加了应该做什么，而且增加了它的重要性，因此什么时候应该做会带来另一个层面的分歧。理论上，开发人员在这里没有发言权，但硬划分永远不会奏效。

从管理层的角度来看，他们不喜欢不确定性。“什么时候准备好？” “不知道，当我们达到你说你快乐的地步时”。从本质上讲，对他们来说，这是一种信仰的飞跃——如果他们这样做一次，那么通常他们就会被卖掉，但让他们第一次这样做是很困难的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T03:19:29.633

我不完全确定这个问题，因为它有点难以理解。

基本上……不是吗？我看不出敏捷原则如何“毁掉专业人士的生活”……如果实施不当，可能会浪费他们的一些时间，这意味着缺乏经验。除此之外，如果方法适合业务并正确实施，那么它就是一个对每个人都有用的强大工具。

任何方法只有在人们有能力的情况下才有效。

愚蠢的问题imo。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T03:26:02.307

我当然看到打包为 Scrum 和 Lean 的东西使开发过程变得更加困难。通常是管理者挑选和选择支持其目标的方面的结果，而不是购买潜在的精神。如果应用得当，任何过程都可以工作，如果应用不当，过程可能会失败。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-12T16:51:00.630

跨功能并不是让人们可替代的手段。这是解决降低生产力的流动瓶颈问题的一种方法。

跨职能并不意味着每个人都可以做其他人的工作，它意味着人们能够在工作之前（立即）或工作之后（立即）协助完成工作步骤。

一个更好的术语是“局部泛化”或“特殊泛化”。再说一次，这个目标与让人们更远离组织无关。培养可以利用局部泛化来发挥自己优势的人的孩子在教学和指导方面需要花费大量资金。一旦组织对员工进行了这样的投资，他们就更没有动力将其移除。组织往往只对他们已经想留住的人进行此类投资。

# nhibernate - NHibernate：检索具有空计数子集合的所有实体的条件表达式

> ID：942905
> 
> 赞同：2
> 
> 时间：2009-06-03T03:14:52.967
> 
> 标签：nhibernate, criteria

在 nhibernate 中，我有两个与多对一映射关联的类：

```
<class name="Employee" table="Employee">
  ..
  <bag name="orgUnits">
    <key column="id" />
    <one-to-many name="OrgUnit" class="OrgUnit">
  </bag>
  ..
</class> 
```

我想使用标准表达式来仅获取集合为空（即没有组织）的员工，如下所示：

```
IList employeesWithNoOrgUnit = sess.CreateCriteria(typeof(Employee))
    .Add( Expression.IsNull("OrgUnits") )
    .List(); 
```

这不会像我预期的那样过滤集合。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T03:27:17.153

同事刚刚找到了一种可行的方法。

```
IList employeesWithNoOrgUnit = sess.CreateCriteria(typeof(Employee))
    .Add( Restrictions.IsEmpty("OrgUnits") )
    .List(); 
```

# applescript - 如何使用 AppleScript 从 iPhoto 相册中检查和删除照片

> ID：942910
> 
> 赞同：1
> 
> 时间：2009-06-03T03:16:21.763
> 
> 标签：applescript, iphoto

我想编写一个 AppleScript 将照片导入相册。如果给定相册中已经存在具有相同文件名的照片，我想先删除现有的照片，然后继续导入。我试过了：

```
if album "MyAlbum" contains "pic1.jpg" then
    remove "pic1.jpg" from album "MyAlbum"
end if 
```

但这不会编译。（我知道如何做实际的导入部分。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T04:49:10.673

事实证明，答案非常简单：

```
remove (every photo of album "MyAlbum" whose image filename is "pic1.jpg") 
```

# ms-access - Access 2003/2007 查询内容已擦除

> ID：942914
> 
> 赞同：2
> 
> 时间：2009-06-03T03:18:38.497
> 
> 标签：ms-access, corruption

有没有其他人遇到过 Access 2003 或 2007 的内容（SQL 语句）被完全擦除（Query 对象仍然存在，内部 SQL 不存在）的情况？

有谁知道这是什么原因？

我刚刚又发生了这种情况。2 个查询从宏的 OutputTo 操作运行以生成 2 个 Excel 文件。我运行了几次宏，然后突然在两个查询中都没有更多的 SQL 语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-11T16:45:46.450

I have accidently done this in VBA code in MS Access by creating QueryDef object whose name that matched an existing query.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T06:20:53.940

不，我从未见过这种情况发生。在过去十年或更长时间里，我几乎阅读了 Usenet 和 Microsoft 新闻组中提到腐败的所有帖子。

但我想知道。多个用户是否共享此 MDB？我们有一些关于 Access 2007 丢失 VBA 代码的奇怪帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-25T10:41:57.747

是的，我在 2003 年的数据库中发生过这种情况——我认为数据库可能已损坏，所以这次我使用 Access 2010 从头开始​​重建它，但它又发生在我身上。宏/按钮已经按预期工作了几个月，但是在我在应用程序的一个完全不相关的部分中更改了 1 行 VBA 代码（将字段设置为 null 而不是“”）之后，此查询擦除又开始了。

我运行一个从按钮触发的宏，该按钮将 SELECT 的结果输出到文件。我已经制定了触发查询被清除的具体步骤，但是如果我检查每个步骤之间仍然存在查询，那么查询不会被清除！显然，这不是应用程序用户的解决方案。

我在另一个stackoverflow问题中发现了[奇怪的错误：“DoCmd.OutputTo acOutputQuery”正在删除查询](https://stackoverflow.com/questions/545310/weird-bug-docmd-outputto-acoutputquery-is-deleting-the-query)，这是我要尝试的一种解决方法——更改内置宏 ExportWithFormatting 以运行代码，并在运行输出命令之前重述 SQL。

# json - 在 FBJS 中编码 JSON

> ID：942918
> 
> 赞同：0
> 
> 时间：2009-06-03T03:19:30.227
> 
> 标签：json, facebook, fbml

我正在尝试将 JS 对象编码为 JSON 字符串（以将 SWF 作为 FlashVar 读入），但由于 facebook 为所有 JS 对象的名称加上应用程序 ID 前缀，编码器似乎都出错了。我不是一个很好的 JS 调试器，但错误告诉我对象没有定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T04:18:59.803

你有想过 AMF 吗？不是通过 flashvar 发送，而是让 flash 调用数据。

如果失败，请尝试在 iframe 下工作。

如果我有更多详细信息，我可以提供更多帮助。

# javascript - 延迟加载 addthis 脚本？（或延迟加载依赖于已触发事件的外部 js 内容）

> ID：942921
> 
> 赞同：9
> 
> 时间：2009-06-03T03:20:10.633
> 
> 标签：javascript, optimization, widget, dom-events

我想让我的用户可以使用[addthis](http://www.addthis.com)小部件，但我想延迟加载它，以便我的页面尽快加载。但是，在通过脚本标记然后通过我的延迟加载方法尝试之后，它似乎只能通过脚本标记工作。在混淆的代码中，我看到一些东西看起来像是依赖于 DOMContentLoaded 事件（至少对于 Firefox 而言）。

由于 DOMContentLoaded 事件已触发，因此小部件无法正确呈现。该怎么办？

我可以只使用脚本标记（较慢）......或者我可以（以跨浏览器方式）触发 DOMContentLoaded （或等效）事件吗？我有一种感觉，这可能是不可能的，因为我相信（如 jQuery）对内容就绪事件有多个测试，因此必须发生多个模拟事件。

尽管如此，这是一个有趣的问题，因为我已经看到几个小部件现在假设您通过静态脚本标签包含他们的东西。如果他们编写的代码对关注速度的开发人员更有用，那就太好了，但在那之前，是否有解决方法？和/或我的任何假设是否错误？

**编辑：** 因为这个问题的第一个答案似乎错过了我的问题的重点，所以我想澄清一下情况。

这是关于一个特定的问题。我不是在寻找另一个延迟加载脚本或检查是否加载了某些依赖项脚本。**具体来说**，这个问题涉及

1.  您无法控制的外部小部件，可能会或可能不会被混淆
2.  延迟外部小部件的加载，直到需要它们为止，或者至少直到基本上在加载其他所有内容（包括其他延迟元素）之后
3.  b/c 小部件的编写方式，排除了现有的典型延迟加载范例

虽然它很深奥，但我已经看到它发生在几个小部件上 - 小部件开发人员假设您只是愿意在页面底部添加另一个脚本标签。我希望节省这 500-1000 毫秒**，尽管雅虎、谷歌和亚马逊的大量研究表明它对您的用户体验很重要。

**我对锤头和个人经验的测试表明，在这种情况下，这将是我的积蓄。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-06-15T04:11:24.883

最简单的解决方案是在将 addthis 脚本嵌入页面时将参数**domready设置为 1。**这是一个例子：

```
<script type="text/javascript" 
src="http://s7.addthis.com/js/250/addthis_widget.js#username=addthis&domready=1">
</script> 
```

我已经在 IE、Firefox、Chrome 和 Safari 上对其进行了测试，并且一切正常。有关 addthis 配置参数的更多信息，请参见[此处](http://www.addthis.com/help/menu-api)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T06:19:02.383

此代码解决了问题并节省了我正在寻找的加载时间。

在阅读了这篇关于大多数当前 js 库如何为 dom 加载事件实现测试的[文章之后。](http://www.zachleat.com/web/2008/12/04/domcontentloaded-inconsistencies/)我花了一些时间处理混淆代码，并且能够确定 addthis 使用了上述 doscroll 方法、计时器和各种浏览器的 DOMContentLoaded 事件的组合。因为只有那些依赖于 DOMContentloaded 事件的浏览器才需要以下代码：

```
if( document.createEvent ) {
 var evt = document.createEvent("MutationEvents"); 
 evt.initMutationEvent("DOMContentLoaded", true, true, document, "", "", "", 0); 
 document.dispatchEvent(evt);
} 
```

其余的取决于计时器测试某些属性的存在，我只需要适应这种情况就可以延迟加载这个外部 JS 内容而不是使用静态脚本标签，从而节省了我希望的时间。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T04:06:52.083

编辑：如果目标只是让您的其他内容首先加载，请尝试将`<script>`标签放在页面底部附近。它仍然能够捕获 DOMContentLoaded，并且之前的内容将在脚本之前加载。

原来的：

除了加载 DOMContentLoaded 之外，如果某个 var 设置为 true，您还可以加载它。例如

```
var isDOMContentLoaded = false;

document.addEventListener("DOMContentLoaded",function() { isDOMContentLoaded = true; }, false); 
```

然后添加到另一个脚本文件

```
if (isDOMContentLoaded) loadThisScript(); 
```

根据评论进行编辑：

加载脚本，并运行 DOMContentLoaded 侦听器触发的函数。（如果您不确定正在调用什么函数，请*阅读脚本）。*

例如

```
var timerID;
var iteration=0;

function checkAndLoad() {
    if (typeof loadThisScript != "undefined") {
        clearInterval(timerID);
        loadThisScript();
    }
    iteration++;
    if (iteration > 59) clearInterval(timerID);
}

var extScript = document.createElement("script");
extScript.setAttribute("src",scriptSrcHere);
document.head.appendChild(extScript);

timerID = setInterval(checkAndLoad,1000); 
```

以上将每秒尝试一次，持续 60 秒，以检查您需要的功能是否可用，如果可用，则运行它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-10T13:14:49.870

AddThis 有一节介绍[如何异步加载他们的工具](https://www.addthis.com/academy/using-addthis-asynchronously/)。

当前的“最佳”解决方案：

```
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=[YOUR PROFILE ID]" async="async"></script> 
```

# c - 我如何让子线程等待某个条件并被父线程的一次调用唤醒？

> ID：942925
> 
> 赞同：0
> 
> 时间：2009-06-03T03:21:19.180
> 
> 标签：c

子线程休眠等待状态，父线程可以调用一些例程唤醒所有子线程运行吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T03:26:04.333

如果您使用的是 POSIX 线程（pthreads），那么[`pthread_cond_wait`](http://www.opengroup.org/onlinepubs/009695399/functions/pthread_cond_wait.html)和（在您的情况下）[`pthread_cond_broadcast`](http://www.opengroup.org/onlinepubs/009695399/functions/pthread_cond_broadcast.html)是您的朋友。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T03:32:02.993

如果您使用的是 Win32，那么您可以使用手动重置[Event](http://msdn.microsoft.com/en-us/library/ms686915(VS.85).aspx)。您的父线程将调用[`SetEvent()`](http://msdn.microsoft.com/en-us/library/ms686211(VS.85).aspx)并可以唤醒所有等待该对象的子线程，其中包含[`WaitForSingleObject()`](http://msdn.microsoft.com/en-us/library/ms687032.aspx).

# asp.net-mvc - MVC ActionLink 将 VS 解决方案名称添加到 url

> ID：942930
> 
> 赞同：0
> 
> 时间：2009-06-03T03:25:24.693
> 
> 标签：asp.net-mvc

出于某种原因，当我在本地运行我的项目时，一切正常。当我将我的网站实时发布到我的共享托管服务器时，actionlink 会导致链接显示为

http// www.mydomain.com/MySolutionName/Account.aspx/LogOn

什么时候应该

http// www.mydomain.com/Account.aspx/LogOn

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:27:36.683

检查您是否发布到网站根目录下名为 MySolutionName 的虚拟目录。如果你这样做了，那么这是预期的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:38:46.270

（顺便说一句：我不知道为什么这个网站不让我重新登录。当我输入我的新用户信息时，我从来没有得到一个 OpenID，wtf？）

我发布到我桌面上的一个文件夹，然后通过 FTP 上传。在我的主机上，我将该文件夹设置为应用程序目录，因为它是我的根目录的子文件夹。

根 ./MySite ./MyOtherSite

每个文件夹都是它自己的应用程序目录，我在其中放置不同的站点。我知道没有虚拟目录。由于我看不到服务器配置，因此我无法确定该声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T03:29:27.260

我认为这是发布屏幕下的一个选项（或者可能在项目设置屏幕下）。我在我的 MacBook 上运行，所以我无法确认。你去那里查过吗？

您能否展示一些您正在谈论的 ActionLink 代码...？

# performance - 没有明确要求的情况下如何进行性能和可扩展性测试？

> ID：942941
> 
> 赞同：1
> 
> 时间：2009-06-03T03:28:34.907
> 
> 标签：performance, testing, scalability

如果没有定义明确的性能要求，知道如何进行性能和可扩展性测试吗？

有关我的应用程序的更多信息。

该应用程序有 3 个组件。一个组件只能在 Linux 上运行，另外两个组件是 Java 程序，所以它们可以在 Linux/Windows/Mac 上运行……这 3 个组件可以部署到一个机器上，也可以每个组件部署到一个机器上。部署非常灵活。仅限 Linux 的组件将通过网络捕获原始 TCP/IP 包，然后一个 Java 组件将从其中获取这些原始数据并将它们组装成最终用户需要的数据，并将它们作为数据文件输出到硬盘上。最后一个 Java 组件将数据文件中的数据批量上传到我的数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T03:32:55.177

在没有“必须能够在 Y 秒内执行 X 次迭代......”类型要求的情况下，这些事情怎么样：

*   两倍大小的数据集是否需要两倍的时间？（是=好）
*   两倍大小的数据集需要 10 倍的时间吗？（是=不好）
*   是否受 CPU 限制？
*   它是否受 RAM 限制（例如大量交换到虚拟内存）？
*   它是 IO / 磁盘绑定的吗？
*   是否存在一定的数据集大小，性能会突然跌落悬崖？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T03:52:10.727

令人惊讶的是，这就是大多数性能和可扩展性测试的开始方式。

您可以清楚地在没有标准的情况下进行测试，您只需定义测试并*测量*结果。我认为您的问题更多的是“如何在没有性能要求的情况下建立测试通过标准”。实际上，这并不少见。许多新项目没有建立明确的标准。非正式地，它类似于“如果它不能每秒执行 X 次，我们就失败了”。但是一旦你每秒通过 X （你最好这样做！）是 X 的“通过”标准吗？通常不会，发生的情况是你建立了一个新的基线并且你的性能测试防止回归：你将你当前的数字与你得到的最好的数字进行比较，并确定新的构建是否“可接受”作为构建验证通过（通常组织会解决在这里，70-80% 是可以接受的，打开性能错误，并确保到发货时间你回到 90-95% 或 100%+。

可扩展性有点复杂，因为没有限制。您的测试范围应该是找出产品在*哪里*损坏。对任何东西都施加足够的负载，最终它会破裂。您需要知道这个限制在哪里，并且非常重要的是，**找出您的产品是如何突破的**。它是否会给出一个很好的错误信息并恢复，或者它是否会将其内脏洒在地板上？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T03:32:54.677

定义你自己的。采取主动并自己描述绩效目标。

为了更好地回答，我们必须更多地了解您的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T03:56:40.490

如果“没有定义性能要求”，那你为什么还要测试呢？

如果定义了性能要求，但它“模糊”，您能否指出它以何种方式模糊，以便我们更好地帮助您？

除此之外，从“模糊”的要求开始，选择一个至少在你看来满足或超过模糊要求的合理目标，然后回到客户那里，让他们确认你的澄清符合他们的要求，理想情况下得到正式签字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T04:14:39.757

一些定义/假设：

性能 = 应用程序响应用户输入的速度，例如网页加载时间

可扩展性 = 应用程序可以处理多少峰值并发用户。

首先是性能。性能测试可以非常简单，例如在开发环境中测量和记录页面加载时间，并使用应用程序分析等技术来识别和修复瓶颈。

加载。要执行负载测试，有四个关键因素，您需要将所有这些因素都准备好才能成功。

**1\. 用户将如何使用您的网站和/或应用程序的良好使用模型。**这对于已经在使用的应用程序可能很容易，但如果您正在启动一个新的东西，例如 Facebook 应用程序，这可能会非常困难。

如果您无法将目标作为要求，请进行一些研究并做出一些有根据的假设，记录并分发它们以获取反馈。

**2\. 工具。**您需要有性能测试脚本和工具来执行第 1 步中定义的场景，以及第 1 步中的预期用户数量。（这可能非常昂贵）

**3.环境。**您将需要一个隔离的生产环境，以便您的测试可以产生可重复的结果。（这也可能非常昂贵。）

**4\. 技术专家。**一旦应用程序和环境开始崩溃，您将需要能够识别故障并重新配置环境，或在发现故障后重新编码应用程序。

通常，大多数项目都有一个“性能测试”框，由于过去的一些失败，他们需要勾选该框，但是他们从来没有计划或预算来正确地进行。我通常建议为适当的可扩展性测试做预算，或者省钱，根本不做。试图以便宜的方式完成一半是浪费时间。

然而，任何优秀的开发人员都应该能够在他们的本地机器上进行性能测试并获得一些好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T03:32:55.847

依赖工具（想到 fxcop） 依赖常识

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T03:45:22.973

如果您想在没有要求的情况下测试性能和可扩展性，那么您应该创建自己的要求/规范，这些要求/规范可以在给您的时间线/截止日期内完成。在确定上述要求后，如果他/她同意，您应该告诉您的主管。

测试可扩展性（假设您正在测试程序/网站）：创建大量用户和数据并检查您的系统和数据库是否可以处理它。MySQL 中的 MyISAM 表类型可以完成工作。

测试性能：优化代码，在网速慢的情况下检查，等等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T05:51:19.433

简短的回答：不要这样做！

为了获得（更好的）定义，编写性能测试概念，您可以与应该定义需求的专家讨论。

对你不知道的一切做出假设，并明确记录这些假设。假设包括可能与系统在负载下的行为相关的所有内容。正确的假设会得到专家的认可，错误的假设会引起反应。

对于所有读过 Tom DeMarcos 最新著作（Adrenaline Junkies ...）的人：这是稻草人模式。大多数不愿意从头开始编写规范的人会毫不犹豫地对您的文档提供反馈。因为你在写你的版本时需要多次猜测，所以你需要准备在被审查时被嘲笑。但至少你会得到更好的信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T11:45:08.863

我通常处理此类问题的方式只是为了获得真实或模拟的真实工作负载，并使程序在合理范围内尽可能快地运行。然后，如果它无法处理负载，我需要考虑更快的硬件，并行完成部分工作等。

性能调优分为两部分。

第 1 部分是同步部分，我在实际工作负载下调整每个“线程”，直到它[真的几乎没有改进的空间](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)。

第 2 部分是异步部分，这是一项艰苦的工作，但需要完成。对于每个“线程”，我提取了一个带有时间戳的日志文件，其中记录了每条消息的发送时间、每条消息的接收时间以及每条接收到的消息何时被执行。我将这些日志合并到一个共同的事件时间线上。然后我遍历所有这些，或者随机选择的部分，并跟踪进程之间的消息流。对于每个消息序列，我想确定它的目的是什么（即它是否真的有必要），以及接收时间和处理时间之间是否存在延迟，如果是，为什么。

我发现通过这种方式我可以“减脂”，并且异步进程可以运行得非常快。

然后，如果他们不满足要求，无论他们是什么，这都不像软件可以做得更好。它要么需要硬件，要么需要进行基本的重新设计。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-04T05:55:55.030

尽管没有定义明确的性能和可扩展性目标，但我们可以使用您提到的三个组件的高级描述来驱动一般性能/可扩展性目标。

1.  组件 1：它看起来像一个网络 I/O 绑定组件，因此您可以使用任何可用的网络负载模拟器来生成各种工作负载以使链路饱和。可扩展性可以通过改变工作负载（10MB、100MB、1000MB 链接）和响应时间来衡量，或者以更精确的方式，与接收原始数据相关的延迟来衡量。您还可以测量链接框的工作集，以推动关于您的服务器需求的现实想法（需要多少额外内存来接收 X 更多工作负载的数据包，..etc）

2.  组件2：这个组件有2个部分，一个I/O绑定部分（从组件1接收数据）和一个CPU绑定部分（组装数据包），你可以整体看问题，确保饱和你的链接当您想测量 CPU 绑定部分时，如果它是一个多线程组件，如果您没有获得 100% 的 CPU 利用率，您可以寻找改进外观的方法，并且您可以测量组装 X 消息所需的时间，从这里您可以计算处理消息的平均等待时间，这可以在以后用于驱动系统的一般性能特征并为您的用户提供 SLA（例如，您将保证 X 毫秒内的响应时间）。

3.  组件 3：完全受 I/O 限制，取决于您的硬盘带宽和您使用的后端数据库服务器，但是您可以测量磁盘 I/O 饱和程度以优化吞吐量，多少 I/O您是否需要读取 X MB 的数据，并围绕这些参数进行改进。

希望有帮助。谢谢

# web-services - REST API 错误返回良好做法

> ID：942951
> 
> 赞同：649
> 
> 时间：2009-06-03T03:39:17.280
> 
> 标签：web-services, http, rest

当涉及从 REST API 返回错误时，我正在寻找有关良好实践的指导。我正在开发一个新的 API，所以我现在可以采取任何方向。目前我的内容类型是 XML，但我计划将来支持 JSON。

我现在添加了一些错误案例，例如客户端尝试添加新资源但已超出其存储配额。我已经在处理某些带有 HTTP 状态代码的错误情况（401 用于身份验证，403 用于授权，404 用于普通错误请求 URI）。我查看了祝福的 HTTP 错误代码，但 400-417 范围似乎都不适合报告特定于应用程序的错误。所以起初我很想用 200 OK 和一个特定的 XML 有效负载返回我的应用程序错误（即。付给我们更多的钱，你会得到你需要的存储空间！）但我停下来想它，它似乎很肥皂（/吓得耸耸肩）。此外，感觉就像我将错误响应分成不同的情况，因为有些是 http 状态代码驱动的，而另一些是内容驱动的。

那么行业建议是什么？良好实践（请解释原因！）以及，从客户端 pov 来看，REST API 中的哪种错误处理使客户端代码的工作更轻松？

* * *

## 回答 #1

> 赞同：635
> 
> 时间：2015-12-16T23:34:09.520

为您的 API 选择正确的 HTTP 错误代码的绝佳资源：http: [//www.codetinkerer.com/2015/12/04/choosing-an-http-status-code.html](http://www.codetinkerer.com/2015/12/04/choosing-an-http-status-code.html)

文章摘录：

## 从哪儿开始：

[![在此处输入图像描述](https://i.stack.imgur.com/0pDZI.png)](https://i.stack.imgur.com/0pDZI.png)

## 2XX/3XX：

[![在此处输入图像描述](https://i.stack.imgur.com/LayiK.png)](https://i.stack.imgur.com/LayiK.png)

## 4XX：

[![在此处输入图像描述](https://i.stack.imgur.com/UTpnp.png)](https://i.stack.imgur.com/UTpnp.png)

## 5XX：

[![在此处输入图像描述](https://i.stack.imgur.com/Wy1rN.png)](https://i.stack.imgur.com/Wy1rN.png)

* * *

## 回答 #2

> 赞同：230
> 
> 时间：2009-06-03T04:08:13.720

> 所以起初我很想用 200 OK 和一个特定的 XML 有效负载返回我的应用程序错误（即。付给我们更多的钱，你会得到你需要的存储空间！）但我停下来想它，它似乎很肥皂（/吓得耸耸肩）。

除非请求确实没有任何问题，否则我不会返回 200。在[RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)中，200 表示“请求已成功”。

如果已超出客户端的存储配额（无论出于何种原因），我将返回 403（禁止）：

> 服务器理解请求，但拒绝执行。授权将无济于事，并且不应重复请求。如果请求方法不是 HEAD 并且服务器希望公开请求未完成的原因，它应该在实体中描述拒绝的原因。如果服务器不希望向客户端提供此信息，则可以使用状态代码 404（未找到）来代替。

这告诉客户端请求是好的，但它失败了（200 不会做的事情）。这也使您有机会在响应正文中解释问题（及其解决方案）。

您还想到了哪些其他特定的错误情况？

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2009-06-03T04:13:24.827

主要的选择是您是否要将 HTTP 状态代码视为 REST API 的一部分。

两种方式都可以正常工作。我同意，严格来说，REST 的一个想法是您应该使用 HTTP 状态代码作为 API 的一部分（成功操作返回 200 或 201，根据各种错误情况返回 4xx 或 5xx。）但是，没有 REST 警察。你可以做你想做的。我见过更多令人震惊的非 REST API 被称为“RESTful”。

**在这一点上**（2015 年 8 月），我建议您将 HTTP 状态代码用作 API 的一部分。与过去相比，现在使用框架时更容易查看返回码。特别是，现在比过去更容易看到非 200 的返回案例和非 200 响应的主体。

**HTTP 状态代码是您的 api 的一部分**

1.  您需要仔细选择适合您的错误条件的 4xx 代码。您可以包含一个 rest、xml 或纯文本消息作为包含子代码和描述性注释的有效负载。

2.  客户端将需要使用一个软件框架，使他们能够获得 HTTP 级别的状态代码。通常可行，但并不总是直截了当。

3.  客户端必须区分指示通信错误的 HTTP 状态代码和指示应用程序级问题的您自己的状态代码。

**HTTP 状态代码不是您的 api 的一部分**

1.  如果您的应用收到请求然后响应（成功和错误情况），HTTP 状态代码将始终为 200

2.  您的所有回复都应包含“信封”或“标题”信息。通常是这样的：

    ```
    信封版本：1.0
    status: # 使用你喜欢的任何代码。保留成功的代码。
    msg: "ok" # 反映代码的人工字符串。对调试很有用。
    data: ... # 响应的数据，如果有的话。
    ```

3.  这种方法对客户端来说更容易，因为响应的状态总是在同一个地方（不需要子代码），对代码没有限制，不需要获取 HTTP 级别的状态代码。

这是一个类似想法的帖子：http: [//yuiblog.com/blog/2008/10/15/datatable-260-part-one/](http://yuiblog.com/blog/2008/10/15/datatable-260-part-one/)

主要问题：

1.  请务必包含版本号，以便您以后可以根据需要更改 api 的语义。

2.  文档...

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-06-03T05:46:15.590

请记住，状态代码比 HTTP/1.1 RFC 中定义的代码更多，IANA 注册表位于[http://www.iana.org/assignments/http-status-codes](http://www.iana.org/assignments/http-status-codes)。对于您提到的状态代码 507 听起来不错的情况。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-06-04T13:54:39.867

正如其他人所指出的，在错误代码中包含响应实体是完全允许的。

请记住，5xx 错误是服务器端的，即客户端无法对其请求进行任何更改以使请求通过。如果超出了客户端的配额，那肯定不是服务器错误，所以应该避免 5xx。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2013-12-18T09:49:52.720

我知道这对聚会来说已经很晚了，但是现在，在 2013 年，我们有一些媒体类型来涵盖以通用分布式（RESTful）方式进行的错误处理。请参阅“vnd.error”、application/vnd.error+json ( [https://github.com/blongden/vnd.error](https://github.com/blongden/vnd.error) ) 和“HTTP API 的问题详细信息”、application/problem+json ( [https://datatracker. ietf.org/doc/html/draft-nottingham-http-problem-05](https://datatracker.ietf.org/doc/html/draft-nottingham-http-problem-05)）。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2009-06-03T09:21:14.737

有两种错误。应用程序错误和 HTTP 错误。HTTP 错误只是让您的 AJAX 处理程序知道一切正常，不应该用于其他任何事情。

## `5xx`服务器错误

```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Gateway Timeout
505 HTTP Version Not Supported
506 Variant Also Negotiates (RFC 2295 )
507 Insufficient Storage (WebDAV) (RFC 4918 )
509 Bandwidth Limit Exceeded (Apache bw/limited extension)
510 Not Extended (RFC 2774 ) 
```

## 2xx 成功

```
200 OK
201 Created
202 Accepted
203 Non-Authoritative Information (since HTTP/1.1)
204 No Content
205 Reset Content
206 Partial Content
207 Multi-Status (WebDAV) 
```

但是，如何设计应用程序错误完全取决于您。例如 Stack Overflow 发送一个带有`response`,`data`和`message`属性的对象。我认为响应包含`true`或`false`指示操作是否成功（通常用于写入操作）。数据包含有效负载（通常用于读取操作），消息包含任何额外的元数据或有用的消息（例如`response`is时的错误消息`false`）。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-11-21T17:38:01.410

同意。REST 的基本理念是使用 Web 基础设施。HTTP 状态代码是允许各方在不增加 HTTP 有效负载的情况下相互通信的消息传递框架。它们已经建立了传达响应状态的通用代码，因此，要真正实现 RESTful，应用程序必须使用此框架来传达响应状态。

在 HTTP 200 信封中发送错误响应具有误导性，并强制客户端（api 使用者）解析消息，很可能以非标准或专有方式。这也不是有效的——您将强制您的客户端每次解析 HTTP 有效负载以了解“真实”响应状态。这增加了处理，增加了延迟，并为客户创造了一个犯错的环境。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-10-23T05:39:46.590

在现有的“最佳实践”上建模你的 api 可能是要走的路。例如，这里是 Twitter 如何处理错误代码 [https://developer.twitter.com/en/docs/basics/response-codes](https://developer.twitter.com/en/docs/basics/response-codes)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-04-14T06:42:33.510

请坚持协议的语义。使用 2xx 表示成功响应，使用 4xx 、 5xx 表示错误响应 - 无论是您的业务异常还是其他。如果将 2xx 用于任何响应是协议中的预期用例，那么它们首先不会有其他状态代码。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-06-03T15:38:00.570

不要忘记 5xx 错误以及应用程序错误。

在这种情况下，409（冲突）呢？这假定用户可以通过删除存储的资源来解决问题。

否则507（不完全标准）也可以工作。我不会使用 200 ，除非您通常使用 200 来表示错误。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2010-05-06T00:02:45.620

如果超出客户端配额，则为服务器错误，在这种情况下避免 5xx。

# wcf - 在 WCF 中公开现有业务对象

> ID：942952
> 
> 赞同：2
> 
> 时间：2009-06-03T03:40:32.723
> 
> 标签：wcf

我知道关于这个主题有类似的问题，但我不完全确定他们是否解决了同样的问题。所以要清楚...

我有一个现有的类库，其中包含用于类型、业务逻辑和数据访问的命名空间。逻辑和数据访问命名空间中的类是静态的，并且具有基本的 crud 方法来用数据填充类型实例或获取已经满的类型实例并在数据库中进行插入或更新。

现在，除了直接引用这个库的现有应用程序之外，我还想创建一个 WCF 服务，以便其他应用程序可以通过这种方式使用对象和方法。

我看到的每个 WCF 教程都会在服务项目中创建域对象 - 但我不希望在两个地方定义我的对象。

所以我想我可以在我现有的类库中引用序列化并将类型类标记为 [DataContract] 并将属性标记为 [DataMember]。然后，在 WCF 项目中，使用 [OperationContract] 方法创建 [ServiceContract] 接口，以匹配我想要公开的现有库中的静态逻辑类和方法。然后，从 WCF 项目中，引用现有的类库并通过其中的方法来实现 WCF 接口，这些方法调用返回现有库类型的现有库逻辑方法。

这是一个好的模式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T04:13:03.377

听起来不错，但改造序列化往往比最初看起来更麻烦。我建议您将一些轻量级数据合约构建到服务层中，然后在服务层和业务层之间构建一个小层，以将数据合约转换为业务对象，反之亦然。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:53:28.453

假设您的业务对象可以序列化（具有 Serializable 属性），一种方法可能是创建 DataContainer 对象，这将是您的数据契约。该对象将在您的 CRUD 方法中使用。

例如，您的接口可能是 Update(DataContainer obj) Insert(DataContainer obj)

等等

然后，您将使用二进制序列化将您的对象打包成字节数组并以这种方式通过 WCF 传递。另一方面，您将再次使用 BinarySerialization 反序列化它们。您只需要确保双方（客户端和服务器）都具有您的业务对象类型的有效程序集版本。

# iphone - 如何在 MKPinAnnotationView 中显示标注？

> ID：942956
> 
> 赞同：0
> 
> 时间：2009-06-03T03:41:20.197
> 
> 标签：iphone

我需要在不点击 MKView 中的图钉的情况下显示标注。我尝试了 setSelected:animated 方法调用，但它似乎不起作用。

将图钉放到地图上后，标注应立即显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T06:53:24.160

使用`MKMapView:selectAnnotation:animated`.

# c# - 通过迭代包含日期和时间的可观察集合来显示消息

> ID：942958
> 
> 赞同：0
> 
> 时间：2009-06-03T03:41:39.823
> 
> 标签：c#, .net, wpf

我有一个绑定到包含日期和时间的列表视图的 Observable 集合。当集合中的某个时间发生时，应显示一个消息框。

我这样做

```
public class Reminder
{
    public string Name { get; set; }
    public string Date { get; set; }
    public string Time { get; set; }
}

ObservableCollection<Reminder> reminderList = new ObservableCollection<Reminder>();
Reminder newItem = new Reminder
                                    {
                                        Name = name,
                                        Date = date,
                                        Time = time
                                    };
reminderList.Add( newItem ); 
```

如何在收集时间发生时显示消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:44:39.197

如何创建一个 Timer 对象，并在其 Tick 事件处理程序中让它遍历列表以查看任何已过期的内容？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T03:45:05.483

简单的方法 - 启动一个计时器，设置为每分钟触发一次（或任何有意义的频率）。当计时器触发时，检查提醒列表中的所有项目（假设它的大小相当小）是否应该显示通知。

```
private void timer1_Tick(object sender, EventArgs e)
{
    var reminders =    from item in reminderList
                       where item.Date > DateTime.Now
                       select item;
    foreach (Reminder reminder in reminders)
    {
        reminderList.Remove(reminder);
        MessageBox.Show("Wake up, " + reminder.Name + "!");
    }
} 
```

您是否有理由将提醒时间存储为两个字符串字段，而不是更标准的单个 DateTime 字段？即使您要强制显示字符串的时间，也要确保将它们作为更合理的方式在内部存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T03:58:51.240

让您的提醒类实现 INotifyPropertyChanged，如下所示：

```
public class Reminder : INotifyPropertyChanged
{
    private string time;

    public string Name { get; set; }
    public string Date { get; set; }
    public string Time
    {
        get
        {
            return this.time;
        }
        set
        {
            if (this.time != value)
            {
                this.time = value;
                this.OnTimeChanged();
            }
        }
    }
    protected void OnTimeChanged()
    {
        var handler = this.PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs("Time"));
        }
    }
    public event PropertyChangedEventHandler PropertyChanged;

} 
```

然后，当您新建 Reminder 对象时，挂钩到 PropertyChanged 事件。如果更改的属性是“时间”并且时间是您想要的时间，请显示您的消息：

```
 var newItem = new Reminder
        {
            Name = name,
            Date = date,
            Time = time
        };
        newItem.PropertyChanged += (o, ex) =>
        {
            if (ex.PropertyName == "Time" && newItem.Time == specificTime)
            {
                //do what you need to do
            }
        };
        reminderList.Add( newItem ); 
```

# c# - 更新嵌套 Xml 中的元素

> ID：942972
> 
> 赞同：0
> 
> 时间：2009-06-03T03:48:59.027
> 
> 标签：c#, .net, xml, linq-to-xml

我有如下所示的 XML：

```
<DataMapper xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <SqlTable />
  <Level_01s>
    <DataParameter>
      <SqlTable>MY-Table-Name</SqlTable>
      <Children>
        <DataParameter>
          <SqlTable>MY-Table-Name</SqlTable>
          <Children>
            <DataParameter>
              <SqlTable>MY-Table-Name</SqlTable>
              <Children>
                <DataParameter>
                  <SqlTable>[All]</SqlTable>
                  <Children />
                </DataParameter>
                <DataParameter>
                  <SqlTable>MY-Table-Name</SqlTable>
                  <Children>
                    <DataParameter>
                      <SqlTable>[All]</SqlTable>
                      <Children />
                    </DataParameter>
                  </Children>
                </DataParameter>
              </Children>
            </DataParameter>
          </Children>
        </DataParameter>
      </Children>
    </DataParameter>
  </Level_01s>
</ DataMapper> 
```

我想做的是更新元素的所有实例。我遇到的问题是 DataParameters 可能会深入 n 级。

我怎样才能递归地确保我更新所有这些？

我正在使用此代码来更新根级元素：

```
XDocument xdoc = XDocument.Parse(myxmlstring);
var element = xdoc.Elements("SqlTable").Single();
element.Value = "foo";        
xdoc.Save("file.xml"); 
```

通过[在 C# 中更改元素值的最佳方法](https://stackoverflow.com/questions/544310/best-way-to-change-the-value-of-an-element-in-c)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T04:46:11.283

如果您使用 Descendants("SqlTable") 而不是 Elements("SqlTable").Single() 它将获得整个文档中的所有“SQLTable”元素。然后你就可以遍历它们并更新元素。

```
var elements = xdoc.Descendants("SqlTable");

foreach (var sqlTable in elements)
{
    sqlTable.Value = "foo";
} 
```

或者，如果您想要简洁，您可以使用 LINQ 语法完成所有操作

**根据评论更新**，添加 .Where 和谓词以构建列表作为使用条件的示例。

```
xdoc.Descendants("SqlTable").Where(s => s.Value != "All").ToList().ForEach(p => p.Value = "foo"); 
```

# php - 如何将 GET 和 POST 数据传递给 php 可执行文件？

> ID：942976
> 
> 赞同：5
> 
> 时间：2009-06-03T03:50:41.973
> 
> 标签：php, post, get, webserver

我正在用 C# 编写一个 Web 服务器，并且正在尝试添加对 PHP 的支持。我让它大部分工作，除了当我将文件传递给它时，我不知道如何将 GET 和 POST 数据传递给 PHP 可执行文件。我一直在使用 GET 进行测试，因为我还没有在服务器上处理 POST 请求，并且我将传递的参数字符串分开，但我不知道如何将信息提供给 php 解析器. 一些提示将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-17T08:32:16.837

对于 GET：简单的方法（我发现）：

```
php-cgi.exe <script-file-name> <parameter1>=<value1> <parameter2>=<value2> [...] <parameterN>=<valueN> 
```

更难的方式（通过 php-cgi 和 windows cli）将是：

```
SET "QUERY_STRING=<parameter1>=<value1>&<parameter2>=<value2>&[...]&<paramterN>=<valueN>"
SET SCRIPT_NAME=<script-file-name>
SET REQUEST_METHOD=GET
SET REDIRECT_STATUS=0
php-cgi.exe 
```

我假设有一种方法可以通过 C#/.Net 设置环境变量。php-cgi.exe 完成后必须取消设置环境变量。

[有关 CGI 环境变量的更多信息，您可以在http://www.ietf.org/rfc/rfc3875.txt](http://www.ietf.org/rfc/rfc3875.txt)设置（以及一般的 CGI）。PHP 的 $_SERVER 变量文档也可能有用。将 PHP 作为 CGI 运行的安全注意事项也在 php.net 的 PHP 文档中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T03:53:01.287

你熟悉[CGI](http://hoohoo.ncsa.illinois.edu/cgi/)吗？这通常是 Web 服务器执行任意外部程序的方式。

CGI 肯定有更现代的替代方案，但是（几乎）今天的每个 Web 服务器和外部程序都将支持 CGI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T03:59:43.987

如果您在`bash`或类似的外壳中，请尝试以下操作：`QUERY_STRING="fruitKind=apple&basketId=1000" php -q foo.php`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-17T07:05:07.390

这里有解释[http://stevedev.co.cc/php-curl-method-get-and-post/](http://stevedev.co.cc/php-curl-method-get-and-post/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T04:14:17.213

您是否考虑过将 GET/POST 数据作为 STDIN 传送到 PHP 可执行文件？IE

system("echo ".GETOrPOSTData." > foobar.php");

# linq - LINQ to Dataset Left Join，如何计算空值

> ID：942981
> 
> 赞同：0
> 
> 时间：2009-06-03T03:52:42.037
> 
> 标签：linq

首先，看看这个线程

[LINQ to Dataset DBNULL 问题/空引用异常](https://stackoverflow.com/questions/881225/linq-to-dataset-dbnull-problem-null-reference-exception)

上面的链接为您提供了如何 LEFT JOIN 然后选择其中具有 NULL 值的列而不会出现异常错误。

我的问题是我想在 WHERE 子句中计算该列是否为空（在我的 LEFT JOIN 之后，列中会弹出一些 NULL 值），如下所示：

```
int tmp1 = 
(
from n in dt_query
join m in dt_query2 
on n.Field<string>("VC_CLIENT_MAXID") equals m.Field<string>("VC_CHAT_MAXID") into nm
from m in nm.DefaultIfEmpty()
where 
    //string.IsNullorEmpty(m.Field<string>("VC_CHAT_STAFF"))
    //DBNull.Value.Equals(m.Field<string>("VC_CHAT_STAFF"))
    //m.IsNull("VC_CHAT_STAFF")
    //object.Equals(m.Field<string>("VC_CHAT_STAFF"), xxx) <<< String xxx = null on above
    select n.Field<string>("VC_CLIENT_MAXID")
    ).Count(); 
```

注释行是我尝试过的解决方案，但对我不起作用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:24:25.217

如果您要问的是如何计算联接表为空的记录数，请尝试一下。

```
int tmp1 = 
    (
    from n in dt_query
    join m in dt_query2 
    on n.Field<string>("VC_CLIENT_MAXID") 
        equals m.Field<string>("VC_CHAT_MAXID") into nm

    from LeftJoinM in nm.DefaultIfEmpty()
    where 

        LeftJoinM  == null

    select n.Field<string>("VC_CLIENT_MAXID")
    ).Count(); 
```

如果我误解了你，请在评论中告诉我，我很乐意更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T03:58:01.633

我没有测试以下代码..希望这应该工作

```
int tmp1 = 
        (
        from n in dt_query
        join m in dt_query2 
        on n.Field<string>("VC_CLIENT_MAXID") 
            equals m.Field<string>("VC_CHAT_MAXID") into nm

        from temp in nm.where(t => t.Field<string>("VC_CLIENT_MAXID") ==null).DefaultIfEmpty()

        select VC_CLIENT_MAXID=  (temp== null) ? "" :n.Field<string>("VC_CLIENT_MAXID");
        ).Count(); 
```

# spring - spring security 与 facebook connect 集成

> ID：942984
> 
> 赞同：5
> 
> 时间：2009-06-03T03:55:24.750
> 
> 标签：spring, spring-mvc, facebook, spring-security

我可以知道是否有任何关于 Spring Security 与 facebook connect 集成的教程/指南

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-12-06T02:47:50.173

Springsource 的人推出了“Spring Social”，在处理任何社交 API（包括 facebook）时都值得关注。见[http://www.springsource.org/spring-social](http://www.springsource.org/spring-social)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-11T19:16:56.043

Spring Social 很棒，但仅适用于 Spring Framework 3.0+。所以请注意您的春季版本，因为我尝试了两天来弄清楚如何使 Spring Social 与 Spring Framework 2.5 一起工作；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-30T07:12:59.653

也许你应该看看[OAuth for Spring Security](http://spring-security-oauth.codehaus.org/) and [Authentication - Facebook Developers](http://developers.facebook.com/docs/authentication/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-02T06:07:33.817

除了 Spring 安全性之外，您还需要[Spring social](http://www.springsource.org/spring-social)，请参阅[使用服务提供商帐户登录](http://static.springsource.org/spring-social/docs/1.0.x/reference/html/signin.html)。一篇很有前途的博客文章是[Integrating your Java Spring MVC webapp with Facebook – Part 1: Doing the OAuth Dance](http://faheemsohail.com/2012/03/integrating-java-spring-mvc-and-facebook-part-1/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-25T23:02:48.523

您可以使用 facbook graph api 来请求用户信息，然后像这样解析它：

```
 JSONObject resp = new JSONObject(content);
        String facebookid = resp.getString("id");
        String firstName = resp.getString("first_name");
        String lastName = resp.getString("last_name");
        String email = resp.getString("email");
        String phone = resp.getString("mobile_phone");

        JSONObject address = resp.getJSONObject("address");
        String street = address.getString("street");
        String city = address.getString("city");
        String zip = address.getString("zip");
        String state = address.getString("state");
        String country = address.getString("country"); 
```

在你有调用你的注册方法的字符串之后应该很容易。比你只需要自动验证它们。

我在此处发布了有关此内容的更多详细信息： [JSP (tomcat) 中的 Facebook Connect 示例](https://stackoverflow.com/questions/5184959/facebook-connect-example-in-jsp-tomcat/5265028#5265028)

# css - 是否可以更改内联文本高度，而不仅仅是行高？

> ID：942995
> 
> 赞同：29
> 
> 时间：2009-06-03T04:01:27.947
> 
> 标签：css

我想知道是否可以更改内联文本的高度，而无需拉伸字体，也无需更改 css 中的行高。

当我有带有悬停效果的多行链接时会出现一个问题：当鼠标悬停在线条上时，效果会因为行高增加而闪烁： [示例](http://ieatfood.com/files/css-line-height.html)

还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2014-10-05T08:51:11.327

您可以使用下面的 css 增加字体的高度

```
transform:scale(2,3); /* W3C */
-webkit-transform:scale(2,3); /* Safari and Chrome */
-moz-transform:scale(2,3); /* Firefox */
-ms-transform:scale(2,3); /* IE 9 */
-o-transform:scale(2,3); /* Opera */ 
```

**[JSFIDDLE](http://jsfiddle.net/7zbufjan/)**

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-03T04:06:44.220

您将无法单独更改字体的高度，但您可以调整[`font-size`](http://www.w3schools.com/cssref/pr_font_font-size.asp)以使用您设置的行高。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T07:55:58.107

您也可以尝试减小[letter-spacing](http://www.w3schools.com/css/pr_text_letter-spacing.asp)。使字体更紧一点可能会使它相对于其宽度看起来更高。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-09T17:44:25.803

[http://www.css3.com/css-font-stretch/](http://www.css3.com/css-font-stretch/)

该命令将帮助您解决问题

这将帮助你！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-08T17:42:31.840

您可以使用 transform 属性增加文本的高度、宽度。例如：transform: scale(0.7, 1.0);

1.  scale 属性中的第一个值会更改字母/文本的**宽度**。
2.  第二个值改变字母/文本的**高度**。

```
 **h1 {
    font-size: 60px;
    transform: scale(0.7, 1.0);
    margin-left: -90px 
}**
```

*我使用边距来对齐文本*

*注意：使用供应商前缀始终是最佳实践*

*   -webkit-（Chrome、Safari、较新版本的 Opera。）
*   -moz- (火狐)
*   -o-（旧版本的 Opera）
*   -ms- (Internet Explorer)

**示例**：-webkit-transform: scale(0.7, 1.0);

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-12T16:17:08.197

您不能使用 CSS 更改字体高度，但您可以做的是让它看起来更高

*   减少`letter-spacing`（**注意**`letter-spacing`：如果需要，您可以使用负数。）
*   减少`font-weight`
*   并通过增加`font-size`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-29T03:59:52.857

有一个尚未提及的属性可以帮助更改字体的高度……唯一的问题是它的支持非常糟糕。

我指的属性是`font-size-adjust`CSS 属性。

[MDN 有这样的说法](https://developer.mozilla.org/en-US/docs/Web/CSS/font-size-adjust)：

> CSS 属性指定应根据`font-size-adjust`小写字母的高度而不是大写字母的高度来选择字体大小。这很有用，因为字体的易读性，尤其是在小尺寸时，更多地取决于小写字母的大小而不是大写字母的大小。

正如我所提到[的，支持是可怕的](http://caniuse.com/#feat=font-size-adjust)。在这篇文章中，Firefox 是唯一支持它的浏览器。从 Chrome 的 v43 开始，它可以在实验性 Web 平台功能标志下启用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-07T08:28:14.250

您可以使用 transform:scale(3,5) 增加高度高度取决于 transform:scale 的第二个参数

```
<div>
<span>Text</span>  
</div>

div {
text-align:center;
 }

span
{    
display:inline-block;
transform:scale(3,5); 
-webkit-transform:scale(3,1); 
} 
```

[http://codepen.io/smarty_tech/pen/ZWvWav](http://codepen.io/smarty_tech/pen/ZWvWav)

# gis - ArcGIS：标签仅以 10,000,000 比例呈现

> ID：942996
> 
> 赞同：0
> 
> 时间：2009-06-03T04:01:40.133
> 
> 标签：gis, arcgis, esri, arcmap

我正在使用带有 Oracle 10.2g 数据库的 ArcGIS Server 9.3。我创建了一个包含我的要素类的 MXD，并将其配置为将其中一个属性显示为标签 - 要素类和标签都设置为在所有比例下都可见。

在 ArcMap 中，标签仅以 1:10,000,000 的比例显示 - 一旦我放大它们就会消失。

我正在以“非标准”方式做两件事：

1.  要素类是通过 ArcCatalog 的地理数据库设计器插件导入模式来创建的 - 导入后我注册为版本，并将编辑移动到基础

2.  我正在使用 sql 插入数据 - 如下所示：

```
    插入
   走进MYTABLE
  (
    对象ID，
    标签 ，
    形状
  )
  价值观
  (
    sde.version_user_ddl.next_row_id('MYSCHEMA',2712) ，
    '给我看看' ，
    sde.st_geometry('POINT (9689097.37142934 4423553.842365312)', 4)
  );

```

因此，当在 ArcMap 中可视化时，我看到的点没问题，但只有在我放大到全范围时才会渲染标签。图层和标签设置为以所有比例显示。

有没有人在做类似的事情，或者你能建议任何修复吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-16T23:52:54.963

我似乎已经能够通过设置层的范围来解决这个问题 - 我知道我的应用程序的全部范围，所以这很容易和合适：

sdelayer -o alter -l MYTABLE,SHAPE -E 8714580.0881,4024165.7422,9950152.555,5045059.3021 -s SERVERNAME -i 5151:MYSCHEMA_sde -u MYSCHEMA -p 密码

# .net - .NET Winform - 用户控件的缩略图

> ID：942997
> 
> 赞同：0
> 
> 时间：2009-06-03T04:02:18.010
> 
> 标签：.net, winforms, user-controls, thumbnails

我有一个使用一些用户控件的应用程序。我想在加载用户控件以供使用时拍摄用户控件的缩略图，并将它们添加到流程布局面板中。

我在哪里可以找到有关在加载用户控件时制作缩略图的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T05:11:16.370

在显示之前我不知道有什么方法可以做到，但是一旦它出现在屏幕上，你就可以使用这样的方法：

```
private Image GetControlThumb(Control control, int thumbSize)
{
    Bitmap imgLarge = new Bitmap(control.Bounds.Width, control.Bounds.Height);
    using (Graphics g = Graphics.FromImage(imgLarge))
    {
        g.CopyFromScreen(
            control.Parent.PointToScreen(new Point(control.Left, control.Top)),
            new Point(0, 0),
            new Size(control.Bounds.Width, control.Bounds.Height));
    }

    Size size;
    if (control.Width > control.Height)
    {
        size = new Size(thumbSize, (int)(thumbSize * (float)control.Height / (float)control.Width));
    }
    else
    {
        size = new Size((int)(thumbSize * (float)control.Width / (float)control.Height), thumbSize);
    }
    Image imgSmall = imgLarge.GetThumbnailImage(size.Width, size.Height, new Image.GetThumbnailImageAbort(delegate { return false; }), IntPtr.Zero);
    imgLarge.Dispose();
    return imgSmall;

} 
```

您可以使用它来获取任何控件的缩略图，如下所示：

```
myPictureBox.Image = GetControlThumb(someControl, 100); 
```***************