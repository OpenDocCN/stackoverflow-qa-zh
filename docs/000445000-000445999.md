# StackOverflow 问答 000445000-000445999

# php - 在 jQuery 中克隆或向表单添加输入不会提交到 Firefox 中的 PHP

> ID：445002
> 
> 赞同：1
> 
> 时间：2009-01-14T22:47:05.007
> 
> 标签：php, javascript, jquery

```
$('#images_upload_add').click(function(){
   $('.images_upload:last').after($('.images_upload:last').clone().find('input[type=file]').val('').end());        
}); 
```

使用此代码附加文件输入不会在 Firefox 中上传文件。

还

```
$('#image_server_add input[type=button]').click(function(){
    var select = $(this).siblings('select').find(':selected');
    if(select.val()){
        $('#image_server_add').before('<tr class="images_selection"><td><input type="button" value="Delete"></td><td class="main">'+select.html()+'<input type="hidden" value="'+select.html()+'" name="images_server[]"/></td></tr>');
    }
}) 
```

也不会将值上传到 $_POST

我找不到任何说明为什么这在文档中不起作用，这在 IE 中有效，但在 Firefox/WebKit 中无效

为什么这些示例不能正确上传表单值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T17:54:43.427

底线是页面上的标记被破坏了。

表单是基于表格的布局，而不是我的选择，并且表单声明在 tr 中。

我将表单声明移动到表单输入的父 td，现在它可以工作了。

这是一个有趣的结果，考虑到渲染引擎将正确提交放置不当的输入，但尝试使用 jQuery/javascript 添加这些输入？在 Firefox/WebKit 中不能进入同一个地方。

我想这与javascript所做的dom操作以及它对块级元素要求的严格程度有关。

任何关于我的发现的注释/猜想将不胜感激。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T00:20:34.833

如果您创建新输入而不是克隆现有输入，您是否遇到同样的问题？

您是要更改克隆输入的名称以避免名称冲突，还是使用数组样式名称（例如`file[]`）？

将所选选项的标记添加到隐藏输入的目的是什么？

为了好玩，你试过用`.clone(true)`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T22:56:47.387

哇！有时 jQuery 实际上可能过于密集而无法阅读。如果我们能看到您的标记，也会有所帮助。
在这里暗中刺伤，因为我猜你想做什么。

您不能以编程方式在文件字段中输入文件名并将其上传到服务器。那会很危险。

也许我在叫错树？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T00:33:29.503

也许不是在提交表单时添加元素，而是将元素放入，但使用默认值。

然后，当单击按钮时，使用正确的值填充该元素。

我只是说，因为当您单击提交时，添加的元素与表单一起提交可能为时已晚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T11:55:37.367

我从谷歌搜索到类似问题的这一部分。

对我来说，我能够通过退后一步来解决这个问题 -

以示例形式：

```
 <table>
<form method="post">
<tr>some content <input type="text" name="test"> </tr>
</form>
</table> 
```

由于某种原因，这将在 Internet Explorer 中工作，但它实际上是无效的 html。将表单标签移到表格外部，如下所示：

```
<form method="post">
    <table>
<tr>some content <input type="text" name="test"> </tr>
</table> 
</form> 
```

然后它将起作用。

输入会以这种方式正常工作（甚至是动态地），我在表单工作时遇到了很多麻烦，直到您插入更多输入或表单元素 - 只有原始元素会提交，这很难跟踪。

# c++ - 抑制 G++ 3.4.6 中的链接错误

> ID：445015
> 
> 赞同：0
> 
> 时间：2009-01-14T22:52:04.653
> 
> 标签：c++, gcc, g++, linker

不要问为什么，但是有什么方法可以抑制失败的链接错误？

如：

未定义对 BLANK 的引用

这是在 GCC 3.4.6 中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T22:55:28.170

不，因为它们是错误而不是警告。根据定义，这意味着该函数在某处被引用但未定义……这不是您可以忽略的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T23:08:29.907

抑制链接错误的唯一方法是不链接（或首先没有错误）。正如 SoapBox 所提到的，错误不能被忽略。

如果您发布一些代码，您可以获得比试图闭上眼睛等待问题消失更好的问题解决方案（他们通常不会）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T01:38:42.210

它不是编译器，而是链接器。“抑制”这种情况的最佳方法是使用 compile 命令传入库名称：

> gcc try.cc -lstdc++

或者

> g++ try.cc -lfltk

例如。

# asp.net-mvc - 防止 asp.net mvc 生成带有子文件夹的 URL

> ID：445022
> 
> 赞同：1
> 
> 时间：2009-01-14T22:53:55.040
> 
> 标签：asp.net-mvc

我的网站托管在一个子文件夹（ApplicationPath）上。我有 ISAPI Rewrite 从 www.domain.com/Subfolder 转换为 www.domain.com。问题是 asp.net MVC Html.ActionLink() （和类似的函数）生成带有 www.domain.com/Subfolder 的 URL。我希望能够从 URL 中删除“/子文件夹”，因为 ISAPI 重写将负责使链接工作。我该怎么做呢？拜托，我已经尝试了一百万次，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T18:02:03.247

在您的路由类中覆盖 GetVirtualPath 方法，使其将“../”添加到 base.GetVirtualPath 调用返回的 VirtualPathData 对象的 Url 属性的开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T23:05:41.130

我不相信有一种内置于框架中的方法来做到这一点。您必须编写自己的 Html 辅助扩展方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T00:02:18.443

我认为您应该编写自己的 Route 类，女巫会重写 URI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T00:45:55.077

覆盖 Route 类不起作用，它不处理 ApplicationPath。我想我必须覆盖 RouteCollection 类的 GetVirtualPath 但我不知道该怎么做。

# c# - 使用 linq 生成直接更新，无需选择

> ID：445033
> 
> 赞同：43
> 
> 时间：2009-01-14T22:56:52.723
> 
> 标签：c#, .net, sql, linq

大家好。

我仍在学习 LINQ，如果这很幼稚，请原谅我。当您直接处理 SQL 时，您可以生成带有条件的更新命令，而无需运行 select 语句。

当我使用 linq 时，我似乎遵循以下模式：

1.  选择实体
2.  修改实体
3.  提交更改

我想要做的是使用 linq 和延迟执行的直接更新。是否有可能实际执行直接发生在 SQL 上，而没有任何数据传输到客户端？

```
DataContext dc = new DataContext

var q = from product in dc.Products
        where product.Type = 1
        set product.Count = 0

dc.SubmitChanges 
```

所以本质上 LINQ 拥有它需要的所有信息，而无需使用 select 来生成更新命令。它将运行 SQL：

```
Update Products Set Count = 0 Where Type = 1 
```

LINQ 中是否存在像“set”这样的关键字？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2010-07-28T09:28:37.177

您实际上可以让 LINQ-to-SQL 生成更新语句：

```
Foo foo=new Foo { FooId=fooId }; // create obj and set keys
context.Foos.Attach(foo);
foo.Name="test";
context.SubmitChanges(); 
```

在您的 Dbml 中，为所有属性设置 UpdateCheck="Never"。

**这将生成一个更新语句**，而无需先进行选择。

一个警告：如果您希望能够将 Name 设置为 null ，则必须将 foo 对象初始化为不同的值，以便 Linq 可以检测到更改：

```
Foo foo=new Foo { FooId=fooId, Name="###" };
...
foo.Name=null; 
```

如果您想在更新时检查时间戳，您也可以这样做：

```
Foo foo=new Foo { FooId=fooId, Modified=... }; 
// Modified needs to be set to UpdateCheck="Always" in the dbml 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-14T23:33:46.317

不，LINQ 和 LINQ to SQL 都没有基于集合的更新功能。

在 LINQ to SQL 中，您必须查询要更新的对象，根据需要更新字段/属性，然后调用 SubmitChanges()。例如：

```
var qry = from product in dc.Products where Product.Name=='Foobar' select product;
var item = qry.Single();
item.Count = 0;
dc.SubmitChanges(); 
```

如果您想进行批处理：

```
var qry = from product in dc.Products where Product.Type==1 select product;
foreach(var item in qry)
{
  item.Count = 0;
}
dc.SubmitChanges(); 
```

或者，您可以自己编写查询：

```
dc.ExecuteCommand("update Product set Count=0 where Type=1", null); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T23:13:33.003

Linq 2 SQL 没有 SQL 的直接插入/更新/删除等效项。在 V1 中，您可以使用 linq 进行的唯一更新被认为是上下文中的 SubmmitChanges 或者如果您回退到 sql。

然而，有些人尝试使用自定义实现来克服 linq 的这种限制。

[Linq 批量更新。](https://terryaney.wordpress.com/2008/04/14/batch-updates-and-deletes-with-linq-to-sql/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-11T21:45:05.383

PLINQO ( [http://plinqo.com](http://plinqo.com) ) 框架使用 LINQ 批量更新来执行更新

`context.Task.Update(t => t.Id == 1, t2 => new Task {StatusId = 2});`

这将执行一个`Update Task Set StatusId = 2 Where Id = 1`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-23T02:03:26.963

使用此扩展方法：[EntityExtensionMethods.cs](https://gist.github.com/omidkrad/0d97ed153fb4d0cfe5d8a00cb5f29444)

```
public static void UpdateOnSubmit<TEntity>(this Table<TEntity> table, TEntity entity, TEntity original = null)
    where TEntity : class, new()
{
    if (original == null)
    {
        // Create original object with only primary keys set
        original = new TEntity();
        var entityType = typeof(TEntity);
        var dataMembers = table.Context.Mapping.GetMetaType(entityType).DataMembers;
        foreach (var member in dataMembers.Where(m => m.IsPrimaryKey))
        {
            var propValue = entityType.GetProperty(member.Name).GetValue(entity, null);
            entityType.InvokeMember(member.Name, BindingFlags.SetProperty, Type.DefaultBinder,
                original, new[] { propValue });
        }
    }

    // This will update all columns that are not set in 'original' object. For
    // this to work, entity has to have UpdateCheck=Never for all properties except
    // for primary keys. This will update the record without querying it first.
    table.Attach(entity, original);
} 
```

要使用它，请确保`entity`传递给`UpdateOnSubmit`方法的对象具有为要更新的记录设置的所有主键属性。然后，此方法将使用`entity`对象中的剩余属性更新记录，而无需先提取记录。

致电后`UpdateOnSubmit`，请务必致电`SubmitChanges()`申请更改。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-06-14T13:41:36.727

您可以使用[**实体框架扩展**](http://entityframework-extensions.net/bulk-update)库，它支持批量更新和批量合并，但是该库不是免费的：

> PM > 安装包 Z.EntityFramework.Extensions

```
using Z.EntityFramework.Plus;

...

dc.Products
    .Where(q => q.Type == 1)
    .Update(q => new Product { Count = 0 }); 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-04-29T12:39:45.143

试试这个 ：

```
dbEntities.tblSearchItems
     .Where(t => t.SearchItemId == SearchItemId)
     .ToList()
     .ForEach(t => t.isNew = false);
dbEntities.SaveChanges(); 
```

# c# - NHibernate 映射问题（我认为）

> ID：445034
> 
> 赞同：-1
> 
> 时间：2009-01-14T22:57:09.103
> 
> 标签：c#, .net, nhibernate, nhibernate-mapping

好的，所以我有一个名为“Business”的对象（我知道，我知道，“Business Business Object”）当它保存它的外键时不知何故丢失了。其他一切都在节省。我已经逐步完成了代码并跟踪了对象，直到

session.SaveOrUpdate(businessObject);

方法。那时的物体是完整的，外来的属性似乎在那里。但是，当它被保存时，外国 ID 不在业务表中。我只能想象这可能是因为我没有正确映射它们？

这是它们被映射的位置：

```
<many-to-one insert="false" update="false" name="_Township" column="TownshipId" class="HQData.Objects.Township, HQData" />

    <many-to-one insert="false" update="false" name="_User" column="UserId" class="HQData.Objects.User, HQData" />

    <many-to-one insert="false" update="false" name ="_SubCategory" column="SubCategoryId" class="HQData.Objects.SubCategory, HQData"/> 
```

这是加载和保存对象的位置：

```
HQData.Objects.Business business = null;
            if (BusinessId != 0)
                business = BusinessManager.GetBusiness(BusinessId);
            else
                business = new HQData.Objects.Business();
            business._SubCategory = CategoryManager.GetCategory(Convert.ToInt32(ddlCategory.SelectedValue.Trim()));
            business.Name = ControlHelper.Sanitize(txtName.Text.Trim());
            business.Address1 = ControlHelper.Sanitize(txtAddress.Text.Trim());
            business._Township = TownshipManager.GetTownshipByCityorZip(ControlHelper.Sanitize(txtTownship.Text));
            business.PhoneNumber = ControlHelper.Sanitize(txtPhone.Text.Trim());
            business.FaxNumber = ControlHelper.Sanitize(txtFax.Text.Trim());
            business.Email = ControlHelper.Sanitize(txtEmail.Text.Trim());
            business.Website = ControlHelper.Sanitize(txtWebsite.Text.Trim());
            business.AboutUs = ControlHelper.Sanitize(txtAboutUs.Text.Trim());
            business._User = UserManager.GetCurrentUser();

            BusinessManager.SaveBusiness(business); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T23:12:24.940

将插入更新属性设置为 true 或删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T23:08:47.160

你是说生意吗._SubCategory.SubCategoryId

并且不确定 GetCurrentUser 返回什么，但如果 Id 也是...

业务._User.UserId？

# perl - 如何在 Catalyst 的请求结束时进行清理？

> ID：445036
> 
> 赞同：2
> 
> 时间：2009-01-14T22:57:52.177
> 
> 标签：perl, catalyst

我试图在使用 Catalyst 完成每个请求后调用一些代码。基本上，我想运行一些代码作为`finalize`. 据说[Catalyst::Plugin::Observe](http://search.cpan.org/dist/Catalyst-Plugin-Observe/)会这样做，但它似乎完全坏了（只是加载插件会破坏 Catalyst）。

我正在尝试修复 Observe 插件，但事实证明这很顽固。

那么，有没有更好的方法来在每个请求结束时调用一些清理代码？

（注意：这是在模型中，而不是控制器中，所以我不能只使用`sub end { ... }`）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T02:20:34.623

实际上，您可以直接将代码添加到“MyApp”类中：

```
package MyApp;
use Catalyst ...;

...

sub finalize {
    my $c = shift;
    $c->NEXT::finalize(@_);
    # do your thing
} 
```

这就是所有插件的工作方式；它们只是成为您应用程序一部分的方法。

我确实同意让“finalize”生成一个要观察的事件更清晰......但这是我们现在必须使用的 :) 加入 irc.perl.org 上的#catalyst，我们可以进一步讨论。（我是 jrockway，你可能猜到了。）

编辑回复：

> （注意：这是在模型中，而不是控制器中，所以我不能只使用 sub end { ... }）

你知道你有`$c`，`end`对吧？

```
package Your::Model;

sub cleanup {
   my $self = shift;
   ...
}

package Your::Controller;

sub end :Private {
    my ($self, $c) = @_;
    $c->model('Your::Model')->cleanup( ... )
} 
```

或者你可以从 开始`MyApp::finalize`，正如我上面建议的那样。

真正的问题是，为什么你的模型需要知道请求周期？这听起来像非常紧密的耦合。

# python - 如何使 wx 工具栏按钮变大？

> ID：445037
> 
> 赞同：2
> 
> 时间：2009-01-14T22:57:53.610
> 
> 标签：python, user-interface, wxpython, wxwidgets, toolbar

我有一个 wx.Toolbar，我想让按钮变大。我已经搜索过，似乎找不到任何关于如何执行此操作的具体文档。

我也想知道这将如何跨平台翻译；OSX 上的按钮和图标会怎样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T15:17:29.540

这取决于您要更改的内容：是按钮的大小还是图标的大小？

要更改按钮的大小，请使用[SetToolBitmapSize](http://docs.wxwidgets.org/2.6/wx_wxtoolbar.html#wxtoolbarsettoolbitmapsize)（例如 24x24）：

```
toolbar.SetToolBitmapSize((24, 24)) 
```

不过，这只会改变按钮的大小。如果要更改图标的大小，只需使用更大的图标。最简单的方法是使用[wx.ArtProvider](http://docs.wxwidgets.org/2.6/wx_wxartprovider.html)：

```
wx.ArtProvider.GetBitmap(wx.ART_FILE_SAVE, wx.ART_TOOLBAR, (24, 24)) 
```

所以，总结一下：

```
# Define the size of the icons and buttons
iconSize = (24, 24)

# Set the size of the buttons
toolbar.SetToolBitmapSize(iconSize)

# Add some button
saveIcon = wx.ArtProvider.GetBitmap(wx.ART_FILE_SAVE, wx.ART_TOOLBAR, iconSize)
toolBar.AddSimpleTool(1, saveIcon, "Save", "Save current file") 
```

**备注：**由于 SetToolBitmapSize 改变的是按钮的大小，而不是图标的大小，您可以将按钮设置为大于图标。这应该在图标周围留下空白区域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T08:28:33.630

工具栏的大小不会自动适应位图图标的大小吗？我认为如果你想要一个更大的工具栏，你需要更大的位图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-19T16:08:56.523

在 Mac OS X Big Sur 上运行 python 3.9 和 wxpython 4.1.1。这个电话

```
toolbar.SetToolBitmapSize((24, 24)) 
```

不起作用。该算法似乎是与工具栏关联的图标的算法 wxPython 选择最大的一个并为所有其他图标设置该大小。

# tfs - 如何还原 TFS 中的文件

> ID：445041
> 
> 赞同：13
> 
> 时间：2009-01-14T22:59:44.497
> 
> 标签：tfs, version-control

有时，我最终会在我们的 TFS 数据库中签入一个我不打算签入的文件。用我目前的方法恢复到以前的版本是相当乏味的。

如果有一种快速的方法可以将文件恢复到 TFS 中的先前版本？我对命令行、powertool 或 UI 方法持开放态度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T23:05:37.323

您需要安装电动工具：

[http://msdn.microsoft.com/en-us/tfs2008/bb980963.aspx](http://msdn.microsoft.com/en-us/tfs2008/bb980963.aspx)

1.  对于 VS2013 - [Microsoft Visual Studio Team Foundation Server 2013 电动工具](https://visualstudiogallery.msdn.microsoft.com/f017b10c-02b4-4d6d-9845-58a06545627f)
2.  对于 VS2015 - [Microsoft Visual Studio Team Foundation Server 2015 电动工具](https://visualstudiogallery.msdn.microsoft.com/898a828a-af00-42c6-bbb2-530dc7b8f2e1)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-05T16:34:34.287

如果你不想使用命令行，或者安装工具，你也可以用老式的方式来做：

[http://msmvps.com/blogs/vstsblog/archive/2009/01/10/how-to-revert-changes-checked-into-tfs-version-control.aspx](http://msmvps.com/blogs/vstsblog/archive/2009/01/10/how-to-revert-changes-checked-into-tfs-version-control.aspx)

# java - java.awt.HeadlessException - Applet 未显示

> ID：445049
> 
> 赞同：2
> 
> 时间：2009-01-14T23:04:53.923
> 
> 标签：java, tomcat, applet

我在 HP Unix 上使用 Tomcat 5.5.23、JDK 1.5。我们有一个应用程序，当从 tomcat 调用时会启动一个小程序。在 JDK 1.4 之前它工作正常。但是现在我们已经迁移到 JDK 1.5 并且小程序无法启动。抛出的异常是 - java.awt.HeadlessException: No X11 DISPLAY variable was set，但是这个程序执行了一个需要它的操作。

然后我将 JAVA_OPTS="-Djava.awt.headless=true" 添加到 catalina.sh 文件中。但我仍然得到相同的无头异常，但这次没有 X11 显示消息。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T16:54:54.953

奇怪..您正在尝试在 tomcat 中运行一个小程序（我假设您正在谈论 java.awt.Applet 的子类）？通常这不起作用，因为没有显示小程序的显示器。

假设您不希望小程序显示在任何地方并且您只想以编程方式执行它的一部分，您可以通过使用虚拟 X 服务器（例如 Xvfb 或 Xvnc）来获得。一旦在运行 tomcat 的主机上运行了 Xvfb 或 Xvnc，您可能会尝试在 tomcat 启动脚本中设置 DISPLAY 以使用虚拟 X 服务器的显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T14:19:55.887

```
-Djava.awt.headless=false 
```

在您的 Tomcat 启动脚本中添加上述内容。它将工作 100%

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T21:57:51.130

You are maybe using something in your Java code that can not work on a headless system, such as graphics components (Swing objects, images, etc.). Some of these components, instead of being directly handled by Java, are handled by underlying platform (Windows kernel itself or X-Window server on Unix). This way the overall performance of application is boosted.

So the question now is, ok if it was working on Java 1.4, why doesn't it work on 1.5? My bet, given the peformance boost since Java 1.2 that Swing has received over time, is that Sun has moved the management of some graphic objets to OS level to increase performance. So if you can not stick to 1.4, then you should revise your code.

This [good article](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/index.html) will help you understand how to modify your application to make it headless-friendly.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T23:23:24.947

小程序将很难在服务器端运行。它们被设计为在容器内运行，例如 Web 浏览器。最有可能抛出异常是因为小程序试图绘制它的 GUI——而服务器对此不提供支持。我很惊讶它在 JDK 1.4 中工作——我不知道这两个版本之间发生了什么变化会影响到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T07:39:33.417

您可能还必须安装 x11 库，或者至少显式导出它们的路径。

/usr/X11R6/lib

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-25T06:40:05.873

1.  `$CATALINA_HOME/bin/startup.sh`使用您喜欢的文本浏览器打开文件
2.  将此行粘贴`export CATALINA_OPTS="$CATALINA_OPTS -Djava.awt.headless=false"`到文件的开头
3.  保存并关闭文件
4.  重启Tomcat

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-03T14:02:50.810

在具有数据库访问权限的 Spring Boot 中，当您指定星号：**** 作为用户名和密码时，它会尝试提示用户输入用户名和密码（您没看错），如果不是gui 应用程序。

# asp.net-mvc - 如何在 ASP.NET MVC 中缓存对象？

> ID：445050
> 
> 赞同：53
> 
> 时间：2009-01-14T23:04:59.370
> 
> 标签：asp.net-mvc, caching

我想在 ASP.NET MVC 中缓存对象。我有一个`BaseController`我希望所有控制器都继承的。在 BaseController 中有一个`User`属性，它可以简单地从数据库中获取用户数据，以便我可以在控制器中使用它，或者将它传递给视图。

我想缓存这些信息。我在每个页面上都使用此信息，因此无需在每个页面请求中都访问数据库。

我想要类似的东西：

```
if(_user is null)
  GrabFromDatabase
  StuffIntoCache
return CachedObject as User 
```

如何在 ASP.NET MVC 中实现简单的缓存？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-15T01:20:30.127

您仍然可以使用缓存（在所有响应之间共享）和会话（每个用户唯一）进行存储。

我喜欢以下“尝试从缓存/创建和存储中获取”模式（类似 c# 的伪代码）：

```
public static class CacheExtensions
{
  public static T GetOrStore<T>(this Cache cache, string key, Func<T> generator)
  {
    var result = cache[key];
    if(result == null)
    {
      result = generator();
      cache[key] = result;
    }
    return (T)result;
  }
} 
```

你会这样使用它：

```
var user = HttpRuntime
              .Cache
              .GetOrStore<User>(
                 $"User{_userId}", 
                 () => Repository.GetUser(_userId)); 
```

您可以将此模式调整为 Session、ViewState (ugh) 或任何其他缓存机制。您还可以扩展 ControllerContext.HttpContext（我认为它是 System.Web.Extensions 中的包装器之一），或者创建一个新类来完成它，并留出一些空间来模拟缓存。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-06-09T08:35:27.313

我接受了 Will 的回答并对其进行了修改，以使`CacheExtensions`课程成为静态并建议稍作改动以应对以下情况的`Func<T>`可能性`null`：

```
public static class CacheExtensions
{

    private static object sync = new object();
    public const int DefaultCacheExpiration = 20;

    /// <summary>
    /// Allows Caching of typed data
    /// </summary>
    /// <example><![CDATA[
    /// var user = HttpRuntime
    ///   .Cache
    ///   .GetOrStore<User>(
    ///      string.Format("User{0}", _userId), 
    ///      () => Repository.GetUser(_userId));
    ///
    /// ]]></example>
    /// <typeparam name="T"></typeparam>
    /// <param name="cache">calling object</param>
    /// <param name="key">Cache key</param>
    /// <param name="generator">Func that returns the object to store in cache</param>
    /// <returns></returns>
    /// <remarks>Uses a default cache expiration period as defined in <see cref="CacheExtensions.DefaultCacheExpiration"/></remarks>
    public static T GetOrStore<T>( this Cache cache, string key, Func<T> generator ) {
        return cache.GetOrStore( key, (cache[key] == null && generator != null) ? generator() : default( T ), DefaultCacheExpiration );
    }

    /// <summary>
    /// Allows Caching of typed data
    /// </summary>
    /// <example><![CDATA[
    /// var user = HttpRuntime
    ///   .Cache
    ///   .GetOrStore<User>(
    ///      string.Format("User{0}", _userId), 
    ///      () => Repository.GetUser(_userId));
    ///
    /// ]]></example>
    /// <typeparam name="T"></typeparam>
    /// <param name="cache">calling object</param>
    /// <param name="key">Cache key</param>
    /// <param name="generator">Func that returns the object to store in cache</param>
    /// <param name="expireInMinutes">Time to expire cache in minutes</param>
    /// <returns></returns>
    public static T GetOrStore<T>( this Cache cache, string key, Func<T> generator, double expireInMinutes ) {
        return cache.GetOrStore( key,  (cache[key] == null && generator != null) ? generator() : default( T ), expireInMinutes );
    }

    /// <summary>
    /// Allows Caching of typed data
    /// </summary>
    /// <example><![CDATA[
    /// var user = HttpRuntime
    ///   .Cache
    ///   .GetOrStore<User>(
    ///      string.Format("User{0}", _userId),_userId));
    ///
    /// ]]></example>
    /// <typeparam name="T"></typeparam>
    /// <param name="cache">calling object</param>
    /// <param name="key">Cache key</param>
    /// <param name="obj">Object to store in cache</param>
    /// <returns></returns>
    /// <remarks>Uses a default cache expiration period as defined in <see cref="CacheExtensions.DefaultCacheExpiration"/></remarks>
    public static T GetOrStore<T>( this Cache cache, string key, T obj ) {
        return cache.GetOrStore( key, obj, DefaultCacheExpiration );
    }

    /// <summary>
    /// Allows Caching of typed data
    /// </summary>
    /// <example><![CDATA[
    /// var user = HttpRuntime
    ///   .Cache
    ///   .GetOrStore<User>(
    ///      string.Format("User{0}", _userId), 
    ///      () => Repository.GetUser(_userId));
    ///
    /// ]]></example>
    /// <typeparam name="T"></typeparam>
    /// <param name="cache">calling object</param>
    /// <param name="key">Cache key</param>
    /// <param name="obj">Object to store in cache</param>
    /// <param name="expireInMinutes">Time to expire cache in minutes</param>
    /// <returns></returns>
    public static T GetOrStore<T>( this Cache cache, string key, T obj, double expireInMinutes ) {
        var result = cache[key];

        if ( result == null ) {

            lock ( sync ) {
                result = cache[key];
                if ( result == null ) {
                    result = obj != null ? obj : default( T );
                    cache.Insert( key, result, null, DateTime.Now.AddMinutes( expireInMinutes ), Cache.NoSlidingExpiration );
                }
            }
        }

        return (T)result;

    }

} 
```

我还会考虑更进一步来实现一个扩展 System.Web.HttpSessionStateBase 抽象类的可测试会话解决方案。

```
public static class SessionExtension
{
    /// <summary>
    /// 
    /// </summary>
    /// <example><![CDATA[
    /// var user = HttpContext
    ///   .Session
    ///   .GetOrStore<User>(
    ///      string.Format("User{0}", _userId), 
    ///      () => Repository.GetUser(_userId));
    ///
    /// ]]></example>
    /// <typeparam name="T"></typeparam>
    /// <param name="cache"></param>
    /// <param name="key"></param>
    /// <param name="generator"></param>
    /// <returns></returns>
    public static T GetOrStore<T>( this HttpSessionStateBase session, string name, Func<T> generator ) {

        var result = session[name];
        if ( result != null )
            return (T)result;

        result = generator != null ? generator() : default( T );
        session.Add( name, result );
        return (T)result;
    }

} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T23:11:24.800

如果您希望它在请求的长度内缓存，请将其放在您的控制器基类中：

```
public User User {
    get {
        User _user = ControllerContext.HttpContext.Items["user"] as User;

        if (_user == null) {
            _user = _repository.Get<User>(id);
            ControllerContext.HttpContext.Items["user"] = _user;
        }

        return _user;
    }
} 
```

如果您想缓存更长时间，请使用将 ControllerContext 调用替换为 1 到 Cache[]。如果您确实选择使用 Cache 对象来缓存更长时间，则需要使用唯一的缓存键，因为它将在请求/用户之间共享。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-02-24T16:19:56.963

这里的其他几个答案不涉及以下内容：

*   缓存踩踏事件
*   双重检查锁

这可能导致生成器（可能需要很长时间）在不同的线程中运行不止一次。

这是我*不应该*遇到这个问题的版本：

```
// using System;
// using System.Web.Caching;

// https://stackoverflow.com/a/42443437
// Usage: HttpRuntime.Cache.GetOrStore("myKey", () => GetSomethingToCache());

public static class CacheExtensions
{
    private static readonly object sync = new object();
    private static TimeSpan defaultExpire = TimeSpan.FromMinutes(20);

    public static T GetOrStore<T>(this Cache cache, string key, Func<T> generator) =>
        cache.GetOrStore(key, generator, defaultExpire);

    public static T GetOrStore<T>(this Cache cache, string key, Func<T> generator, TimeSpan expire)
    {
        var result = cache[key];
        if (result == null)
        {
            lock (sync)
            {
                result = cache[key];
                if (result == null)
                {
                    result = generator();
                    cache.Insert(key, result, null, DateTime.UtcNow.AddMinutes(expire.TotalMinutes), Cache.NoSlidingExpiration);
                }
            }
        }
        return (T)result;
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T02:58:16.730

我喜欢隐藏数据缓存在存储库中的事实。您可以通过 HttpContext.Current.Cache 属性访问缓存，并使用“User”+id.ToString() 作为键存储用户信息。

这意味着从存储库对用户数据的所有访问都将使用缓存数据（如果可用），并且不需要模型、控制器或视图中的代码更改。

我已经使用这种方法来纠正系统上的严重性能问题，该系统正在为每个用户属性查询数据库并将页面加载时间从几分钟减少到个位数秒。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-08-11T21:18:16.803

@njappboy：很好的实现。我只会将`Generator( )`调用推迟到最后一个负责任的时刻。因此您也可以缓存方法调用。

```
/// <summary>
/// Allows Caching of typed data
/// </summary>
/// <example><![CDATA[
/// var user = HttpRuntime
///   .Cache
///   .GetOrStore<User>(
///      string.Format("User{0}", _userId), 
///      () => Repository.GetUser(_userId));
///
/// ]]></example>
/// <typeparam name="T"></typeparam>
/// <param name="Cache">calling object</param>
/// <param name="Key">Cache key</param>
/// <param name="Generator">Func that returns the object to store in cache</param>
/// <returns></returns>
/// <remarks>Uses a default cache expiration period as defined in <see cref="CacheExtensions.DefaultCacheExpiration"/></remarks>
public static T GetOrStore<T>( this Cache Cache, string Key, Func<T> Generator )
{
    return Cache.GetOrStore( Key, Generator, DefaultCacheExpiration );
}

/// <summary>
/// Allows Caching of typed data
/// </summary>
/// <example><![CDATA[
/// var user = HttpRuntime
///   .Cache
///   .GetOrStore<User>(
///      string.Format("User{0}", _userId), 
///      () => Repository.GetUser(_userId));
///
/// ]]></example>
/// <typeparam name="T"></typeparam>
/// <param name="Cache">calling object</param>
/// <param name="Key">Cache key</param>
/// <param name="Generator">Func that returns the object to store in cache</param>
/// <param name="ExpireInMinutes">Time to expire cache in minutes</param>
/// <returns></returns>
public static T GetOrStore<T>( this Cache Cache, string Key, Func<T> Generator, double ExpireInMinutes )
{
    var Result = Cache [ Key ];

    if( Result == null )
    {
        lock( Sync )
        {
            if( Result == null )
            {
                Result = Generator( );
                Cache.Insert( Key, Result, null, DateTime.Now.AddMinutes( ExpireInMinutes ), Cache.NoSlidingExpiration );
            }
        }
    }

    return ( T ) Result;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-14T23:09:29.110

如果您不需要 ASP.NET 缓存的特定失效功能，静态字段非常好，轻量级且易于使用。但是，一旦您需要高级功能，您就可以切换到 ASP.NET 的`Cache`对象进行存储。

我使用的方法是创建一个属性和一个`private`字段。如果该字段是`null`，该属性将填充它并返回它。我还提供了`InvalidateCache`一种手动将字段设置为`null`. 这种方法的优点是缓存机制封装在属性中，如果需要，您可以切换到不同的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-28T15:50:34.867

以最小的缓存锁定实现。存储在缓存中的值被包装在一个容器中。如果值不在缓存中，则值容器被锁定。缓存仅在容器创建期间被锁定。

```
public static class CacheExtensions
{
    private static object sync = new object();

    private class Container<T>
    {
        public T Value;
    }

    public static TValue GetOrStore<TValue>(this Cache cache, string key, Func<TValue> create, TimeSpan slidingExpiration)
    {
        return cache.GetOrStore(key, create, Cache.NoAbsoluteExpiration, slidingExpiration);
    }

    public static TValue GetOrStore<TValue>(this Cache cache, string key, Func<TValue> create, DateTime absoluteExpiration)
    {
        return cache.GetOrStore(key, create, absoluteExpiration, Cache.NoSlidingExpiration);
    }

    public static TValue GetOrStore<TValue>(this Cache cache, string key, Func<TValue> create, DateTime absoluteExpiration, TimeSpan slidingExpiration)
    {
        return cache.GetOrCreate(key, x => create());
    }

    public static TValue GetOrStore<TValue>(this Cache cache, string key, Func<string, TValue> create, DateTime absoluteExpiration, TimeSpan slidingExpiration)
    {
        var instance = cache.GetOrStoreContainer<TValue>(key, absoluteExpiration, slidingExpiration);
        if (instance.Value == null)
            lock (instance)
                if (instance.Value == null)
                    instance.Value = create(key);

        return instance.Value;
    }

    private static Container<TValue> GetOrStoreContainer<TValue>(this Cache cache, string key, DateTime absoluteExpiration, TimeSpan slidingExpiration)
    {
        var instance = cache[key];
        if (instance == null)
            lock (cache)
            {
                instance = cache[key];
                if (instance == null)
                {
                    instance = new Container<TValue>();

                    cache.Add(key, instance, null, absoluteExpiration, slidingExpiration, CacheItemPriority.Default, null);
                }
            }

        return (Container<TValue>)instance;
    }
} 
```

# apache-flex - Adobe Flex 控件缺少垂直滚动条

> ID：445054
> 
> 赞同：0
> 
> 时间：2009-01-14T23:07:52.000
> 
> 标签：apache-flex, datagrid, adobe, scrollbar

我有一个包含数据网格的画布。我将画布的水平和垂直滚动设置为“关闭”，并将 DG 设置为“自动”。这一直有效，直到我在 DG 中有更多的列（> = 16），然后垂直滚动条不会出现。有人看过这个，更好的是，有答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T01:18:31.360

找到了一个简单的解决方案，如果不是答案。外部容器指定了固定的高度和宽度，内部 DG 设置为 100% 的高度和宽度。将 DG 高度和宽度设置为比外部容器小一点的固定值就可以了。不过，似乎“100%”应该有效。

# r - 向量化我的想法：R 中的向量运算

> ID：445059
> 
> 赞同：17
> 
> 时间：2009-01-14T23:09:02.823
> 
> 标签：r, vector

所以早些时候我回答了我自己关于在 R 中思考向量的问题。但现在我遇到了另一个我无法“向量化”的问题。我知道向量更快，循环更慢，但我不知道如何在向量方法中做到这一点：

我有一个数据框（出于情感原因，我喜欢将其称为 my.data），我想对其进行全面的边际分析。我需要一次删除某些元素并对数据框“赋值”，然后我需要通过仅删除下一个元素来再次进行迭代。然后再做一次……再一次……这个想法是对我的数据子集进行全面的边际分析。无论如何，我无法想象如何以矢量有效的方式做到这一点。

我已经缩短了代码的循环部分，它看起来像这样：

```
for (j in my.data$item[my.data$fixed==0]) { # <-- selects the items I want to loop 
                                            #     through
    my.data.it <- my.data[my.data$item!= j,] # <-- this kicks item j out of the list
    sum.data <-aggregate(my.data.it, by=list(year), FUN=sum, na.rm=TRUE) #<-- do an
                                                                         # aggregation

    do(a.little.dance) && make(a.little.love) -> get.down(tonight) # <-- a little
                                                                   #  song and dance

    delta <- (get.love)                                         # <-- get some love
    delta.list<-append(delta.list, delta, after=length(delta.list)) #<-- put my love
                                                                    #    in a vector 
} 
```

所以很明显我在中间砍掉了一堆东西，只是为了让它不那么笨拙。目标是使用更有效的向量来删除 j 循环。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-18T15:12:24.020

这似乎是另一种非常 R 型的生成总和的方法。生成一个与输入向量一样长的向量，只包含 n 个元素的重复总和。然后，从 sum 向量中减去原始向量。结果：一个向量（isums），其中每个条目都是您的原始向量减去第 i 个元素。

```
> (my.data$item[my.data$fixed==0])
[1] 1 1 3 5 7
> sums <- rep(sum(my.data$item[my.data$fixed==0]),length(my.data$item[my.data$fixed==0]))
> sums
[1] 17 17 17 17 17
> isums <- sums - (my.data$item[my.data$fixed==0])
> isums
[1] 16 16 14 12 10 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T09:54:05.627

奇怪的是，学习 R 中的向量化帮助我习惯了基本的函数式编程。一种基本技术是将循环内的操作定义为函数：

```
data = ...;
items = ...;

leave_one_out = function(i) {
   data1 = data[items != i];
   delta = ...;  # some operation on data1
   return delta;
}

for (j in items) {
   delta.list = cbind(delta.list, leave_one_out(j));
} 
```

要矢量化，您只需将`for`循环替换为`sapply`映射函数：

```
delta.list = sapply(items, leave_one_out); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:12:55.747

这不是答案，但我想知道这个方向是否有任何见解：

```
> tapply((my.data$item[my.data$fixed==0])[-1], my.data$year[my.data$fixed==0][-1], sum) 
```

tapply 生成按作为第二个参数给出的参数分组的统计信息表（在本例中为总和；第三个参数）。例如

```
2001 2003 2005 2007
1    3    5    7 
```

[-1] 表示法从选定的行中删除观察（行）之一。因此，您可以循环并在每个循环上使用 [-i]

```
for (i in 1:length(my.data$item)) {
  tapply((my.data$item[my.data$fixed==0])[-i], my.data$year[my.data$fixed==0][-i], sum)
} 
```

请记住，如果您有任何年份只有 1 次观察，那么连续的 tapply 调用返回的表将不会有相同的列数。（即，如果您放弃 2001 年的唯一观察，那么 2003、2005 和 2007 年将是仅返回的列）。

# c# - 如果与开关速度

> ID：445067
> 
> 赞同：114
> 
> 时间：2009-01-14T23:13:28.290
> 
> 标签：c#, performance, switch-statement, if-statement

由于编译器优化，switch 语句通常比等效的 if-else-if 语句（如[本文所述）更快。](http://www.blackwasp.co.uk/SpeedTestIfElseSwitch.aspx)

这种优化实际上是如何工作的？有人有很好的解释吗？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-01-14T23:16:04.977

编译器可以在适用的情况下构建跳转表。例如，当您使用反射器查看生成的代码时，您会看到对于字符串上的巨大开关，编译器实际上会生成使用哈希表来调度这些的代码。哈希表使用字符串作为键并将`case`代码作为值委托给代码。

与许多链式测试相比，这具有更好的运行时间，`if`并且即使对于相对较少的字符串实际上也更快。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-14T23:56:28.283

这是一个轻微的简化，因为通常任何现代编译器都会遇到一个`if..else if ..`可以被人轻松转换为 switch 语句的序列，编译器也会这样做。但只是为了增加额外的乐趣，编译器不受语法限制，因此可以在内部生成类似“switch”的语句，这些语句混合了范围、单个目标等——他们可以（并且可以）为 switch 和 if 执行此操作。 .else 语句。

Anyhoo，对 Konrad 答案的扩展是编译器可能会生成一个跳转表，但这不一定能保证（也不可取）。由于各种原因，跳转表对现代处理器上的分支预测器造成不良影响，而表本身对缓存行为也造成不良影响，例如。

```
switch(a) { case 0: ...; break; case 1: ...; break; } 
```

如果编译器实际上为此生成了一个跳转表，它可能会比替代`if..else if..`样式代码慢，因为跳转表会破坏分支预测。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T23:42:57.077

不匹配的统计数据可能不好。

如果您实际下载源代码，则在 if 和 switch 情况下，不匹配值已知为 21。编译器应该能够抽象出来，知道应该始终运行哪个语句，并且 CPU 应该能够正确地进行分支预测。

更有趣的情况是，在我看来，并非所有情况都破裂，但这可能不是实验的范围。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-27T02:54:56.923

switch/case 语句通常可能更快 1 级深度，但是当您开始进入 2 级或更多时，switch/case 语句开始花费的时间是嵌套 if/else 语句的 2-3 倍。

[本文有一些速度比较](http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement "http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement")，突出了嵌套此类语句时的速度差异。

例如，根据他们的测试，示例代码如下：

```
if (x % 3 == 0)
            if (y % 3 == 0)
                total += 3;
            else if (y % 3 == 1)
                total += 2;
            else if (y % 3 == 2)
                total += 1;
            else
                total += 0;
        else if (x % 3 == 1)
            if (y % 3 == 0)
                total += 3;
            else if (y % 3 == 1)
                total += 2;
            else if (y % 3 == 2)
                total += 1;
            else
                total += 0;
        else if (x % 3 == 2)
            if (y % 3 == 0)
                total += 3;
            else if (y % 3 == 1)
                total += 2;
            else if (y % 3 == 2)
                total += 1;
            else
                total += 0;
        else
            if (y % 3 == 0)
                total += 3;
            else if (y % 3 == 1)
                total += 2;
            else if (y % 3 == 2)
                total += 1;
            else
                total += 0; 
```

*在运行等效 switch/case 语句的一半*时间内完成：

```
switch (x % 3)
    {
        case 0:
            switch (y % 3)
            {
                case 0: total += 3;
                    break;
                case 1: total += 2;
                    break;
                case 2: total += 1;
                    break;
                default: total += 0;
                    break;
            }
            break;
        case 1:
            switch (y % 3)
            {
                case 0: total += 3;
                    break;
                case 1: total += 2;
                    break;
                case 2: total += 1;
                    break;
                default: total += 0;
                    break;
            }
            break;
    case 2:
            switch (y % 3)
            {
                case 0: total += 3;
                    break;
                case 1: total += 2;
                    break;
                case 2: total += 1;
                    break;
                default: total += 0;
                    break;
            }
            break;
    default:
        switch (y % 3)
        {
            case 0: total += 3;
                break;
            case 1: total += 2;
                break;
            case 2: total += 1;
                break;
            default: total += 0;
                break;
        }
        break;
    } 
```

是的，这是一个基本的例子，但它说明了这一点。

所以结论可能是对只有一层深的简单类型使用 switch/case，但对于更复杂的比较和多个嵌套级别，使用经典的 if/else 构造？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-06T16:31:05.747

if over case 的唯一优点是当第一个 case 的出现频率显着增加时。

不确定阈值的确切位置，但我使用 case 语法，除非第一个“几乎总是”通过第一个测试。

# java - Java 中的 Pacman 问题

> ID：445070
> 
> 赞同：5
> 
> 时间：2009-01-14T23:14:10.427
> 
> 标签：java, network-programming, pacman

对于我的大学作业，我必须制作一个可联网的 pacman 版本。我想我最好先制作一个 pacman 的本地副本来解决这个问题，然后将此功能扩展为网络游戏。

我不得不说我对 java GUI 开发和在 java 中利用这些特性还比较陌生。

*   [http://www.planetalia.com/cursos/Java-Invaders/](http://www.planetalia.com/cursos/Java-Invaders/)
*   [http://javaboutique.internet.com/PacMan/source.html](http://javaboutique.internet.com/PacMan/source.html)

我已经开始关注上面关于 java 中的游戏开发的链接和一个 pacman 游戏的例子。

我决定将迷宫表示为一个 int 数组，其中不同的值意味着不同的事物。然而，当主游戏循环中的绘制方法运行时，我正在用这种方法重新绘制整个迷宫。

```
 for (int i : theGame.getMaze())
    {
        if (i == 4)
        {
            g.setColor(mazeWallColour);
            g.fillRect(curX, curY, cellSize, cellSize);
            curX += 25;
        }
        else
        {
            curX += cellSize;
        }

        index++;

        // Move to new row
        if (index == 25)
        {
            index = 0;
            curX = 10;
            curY += cellSize;
        }
    } 
```

然而，这为我提供了不到 1fps 的速度。尽管我注意到上面链接的示例在每次调用paint方法时都使用类似的重绘方式，并且我相信在不可见的图像上会这样做（有点像双缓冲[我使用了像第一个链接一样的 BufferStrategy解释]) 重新绘制迷宫的更好方法是什么？

任何与此有关的指针/建议都会很有用。

感谢您的时间。

[http://pastebin.com/m25052d5a](http://pastebin.com/m25052d5a) - 用于主要游戏类。

编辑：我刚刚注意到在尝试查看哪些代码需要这么长时间才能执行之后发生了一些非常奇怪的事情。

在我添加的 paintClear(Graphics g) 方法中

```
ocean = sprites.getSprite("oceano.gif");
g.setPaint(new TexturePaint(ocean, new Rectangle(0,t,ocean.getWidth(),ocean.getHeight())));
g.fillRect(10, 10,getWidth() - 20,getHeight() - 110); 
```

这使整个事情顺利进行 - 但是当我删除这些行时，整个事情变慢了？是什么原因造成的？

[更新代码](http://pastebin.com/m15d0d70)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T00:07:04.767

首先，我建议您使用命名常量，而不是在代码中使用随机幻数，并考虑为您的单元格类型使用枚举。虽然它不会让你的代码运行得更快，但它肯定会让它更容易理解。此外，“i”通常用作计数器，而不是返回值。您可能应该调用它`cellType`或类似的名称。我还建议您为舞台地图使用 2D 数组，因为它使许多事情变得更容易，无论是逻辑上还是概念上。

也就是说，这里有一些事情可以尝试：

拉出`setColor()`循环并执行一次。编译器可能能够进行循环不变的提升，从而为您执行此操作（并且可能会），但从概念上讲，您可能无论如何都应该这样做，因为您似乎希望所有的墙壁都是一种颜色。

尝试调用`drawRect()`而不是，`fillRect()`看看是否会更快。我不认为它会，但它值得一试，即使它看起来更丑陋。同样，您可以尝试创建一个`Image`然后绘制它。这样做的好处是很容易告诉您的 Graphics 对象在您的图像上实现转换。此外，请考虑完全取消它，并确保它对性能造成重大影响。

此外，通常您不需要为其 Graphics 对象询问父级并直接在其上实现绘画。相反，您应该重写它的`paintComponent()`方法并只使用给您的 Graphics（可能像您一样调用辅助方法）。Swing 组件默认是双缓冲的，所以你不需要自己实现；只需让摆动对象完成其工作，并让您知道何时绘画。

此外，您最终会重新绘制整个屏幕，这有点矫枉过正。如果您调用`repaint(Rectangle)`，Swing 可以选择仅重绘板上明确标记为脏的部分。当您更新其中一个精灵时，仅在精灵的旧位置和新位置区域调用 repaint(r)。当你完成一个关卡并需要一个新的棋盘时，你可以调用 repaint()（不带参数）来重绘整个地图。

您还应该查看[Sun 的教程](http://java.sun.com/products/jfc/tsc/articles/painting/)以获取有关 Swing 效率的一些技巧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T01:05:01.153

我仍然认为自己是 Java 的初学者，但我最近使用您提到的一些技术开发了一个带有动态地图和编辑器的 Frogger 式游戏，我很乐意提供一些帮助。

如前所述，枚举是要走的路。我将我的地图设置为二维数组并为每种不同类型设置一个枚举，在我的地图类中编写一个方法来获取一个图像并将地图中的每个正方形划分为我的枚举中的每个值。

可以在[Coke and Code](http://www.cokeandcode.com/node/1087)上找到帮助我进行映射的教程。如果您需要任何源代码，所有源代码都在那里，尽管您似乎对自己正在做的事情有很好的掌握。如果您仍然需要帮助，我总是可以拖出一些源代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T00:00:26.260

您上面列出的代码不能成为 1fps 问题的根源......我的代码做得比这要快得多。

您能否对该代码进行基准测试并确保它是问题的根源？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T01:17:35.903

看起来您对 Thread.sleep 的调用没有达到您的预期，但我认为这不是您麻烦的根源。你有：

`Thread.sleep(Math.max(0, startTime - System.currentTimeMillis()));`

startTime 将始终小于 System.currentTimeMillis()，因此 startTime - System.currentTimeMillis() 将始终为负数，因此您的睡眠时间将始终为 0 毫秒。它与您展示的示例不同，因为该示例在进行计算之前将 startTime 增加了 40 毫秒。它正在计算睡眠时间以将绘图时间填充到 40 毫秒。

无论如何，回到你的问题。我建议通过测量来确定您的时间都花在了哪里。在你知道什么是慢之前，优化是没有意义的。您已经知道如何使用 System.currentTimeMillis()。尝试使用它来衡量所有时间都在哪里。都是花在画墙上吗？

* * *

编辑 - 我看到这被标记为已接受，所以我应该推断当你修复睡眠时间时问题就消失了吗？我没有很多 Java GUI 经验，但我可以推测您的代码可能正在耗尽其他重要线程。通过将您的线程设置为具有最高优先级并且只调用 sleep(0)，您几乎可以保证您的进程中没有其他线程可以做任何事情。这是[Raymond Chen 博客](http://blogs.msdn.com/oldnewthing/archive/2005/10/04/476847.aspx)中的一篇文章，解释了原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T23:58:53.910

我不是游戏开发者，但那个帧率似乎很慢。

我不太确定您的代码是如何工作的，但是提高渲染性能的一种可能性是找到那些变化不大的显示部分（例如迷宫的墙壁）并避免重新创建它们每一帧。

创建一个包含常量元素（迷宫？背景）的 BufferedImage，然后首先为每一帧重新绘制它。在这个缓冲图像的顶部，绘制可变元素（PacMan、ghosts、dots 等）。

[Romain Guy 的优秀著作Filthy Rich Clients](http://filthyrichclients.org/)中讨论了这种技术以及许多其他 Java2D 性能技巧。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T00:05:06.750

只是为了让您不必担心它是 Java，我在一个频谱分析器（就像一个 o-scope）上工作，其中整个 GUI 部分（跟踪、菜单、按钮和滚轮处理）都是用 Java 完成的。当我到达那里时它获得了 1fps，当我离开时它是 12-20。那有很多处理正在进行，并且在一个非常慢的处理器上运行。

只查看需要更新的 GUI 的更新部分。通常，您可以重绘整个屏幕，但只需将剪辑区域设置为真正更新的部分。

小心内部循环——它们是速度杀手。

尽量避免分配和释放大量对象。我不是说不要使用对象，我是说不要为每个像素创建一个 :)

祝你好运

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T23:23:09.910

哇，对于刚学习 Java 的人来说，这是一个相当棘手的问题。

我的建议？从对象的角度思考。你能在没有模仿游戏本身行为的用户界面的情况下编写一些东西吗？一旦你开始工作，你就可以专注于用户界面的特殊问题。是的，从网络版之前的本地版本开始。

我不是游戏玩家。我想知道 Java2D API 会提供什么让您的生活更美好？

你有多少时间来完成它？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T23:58:16.983

这听起来很明显，但您的性能问题是因为您正在重绘**整个**迷宫，这不需要完成，而是您只需要重绘迷宫的更改部分。

我之前处理这个问题的方法是将迷宫的更新与实际重绘分离到不同的线程中（有点像线程 MVC）。每次更改迷宫中的单元格时，您都会将其标记为“脏”，您的重绘线程将不时检查以仅重绘脏单元格。

对不起，非常笼统的建议

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T00:42:05.990

默认情况下，Java/Swing 双缓冲区。如果您使用的是 Swing，则不需要像其他答案所建议的那样单独进行双重缓冲。

我同意艾伦的观点，你列出的代码不能是 1fps 的原因。我编写了效率极低的 Java/Swing 动画代码，运行速度比您描述的要快得多。进行更多测试以缩小速度缓慢的原因。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-15T01:45:23.570

如果可能，您应该保留迷宫的图像，并在一次库调用中绘制它。它可能也不需要全分辨率——如果你想要块状的 8 位感觉，我希望图形库会非常乐意提供 8 ^)

此外，正如其他人所提到的，您可以通过仅重绘那些需要更新的屏幕部分来节省时间。这可能很烦人，但它*可以*让您显着提高帧速率。在进行所需的努力之前，请务必进行一些实验以确保是这种情况！

# c# - 一次移动两个 WPF 窗口？

> ID：445082
> 
> 赞同：7
> 
> 时间：2009-01-14T23:19:57.047
> 
> 标签：c#, .net, wpf

我的主窗口生成了一个位于顶部的子窗口，看起来像主窗口的一部分。我想移动子窗口与主窗口同步，但我不确定如何。

我的主窗口有我自己的标题栏，事件 MouseLeftButtonDown 调用此函数：

```
public void DragWindow(object sender, MouseButtonEventArgs args)
{
     DragMove();
     UpdateChildWindowPosition();
} 
```

这导致在主窗口上执行的 DragMove() 在我拖动标题栏时单独移动主窗口。UpdateChildWindowPosition() 直到我释放鼠标时才会执行它读取一些元素坐标并设置子窗口位置 - 您会看到子窗口捕捉到不需要的位置。

如何让子窗口与主窗口同步移动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T02:15:13.913

啊哈！

我的主窗口有一个事件 LocationChanged，我已将它绑定到我的 UpdateChildWindowPosition()。LocationChange 在（duh）位置更改时触发，因此当我在上面发布的 DragWindow 中执行 DragMove() 时移动窗口时，它会不断触发。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T00:57:35.397

您可以使用窗口的 Left 和 Top 属性来放置辅助窗口。这是一个粗略的代码作为示例：

在主窗口代码中：

```
 mDebugWindow.Left = this.Left + this.ActualWidth;
        mDebugWindow.Top = this.Top; 
```

在这种情况下，mDebugWindow 是我的子窗口。这段代码告诉它坐在主窗口的右侧，窗口的顶部对齐。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-17T22:44:42.193

这是我所做的：

我首先将 Parent 的一个 Instance 设置为 Child 窗口的所有者，（`public static MainWindow instance;`然后通过在 MainWindow 类中设置它来创建一个实例`instance = this;`）：

```
public ChildWindow()
{
    Owner = MainWindow.instance;
    InitializeComponent();
} 
```

然后我在父类中添加一个事件处理程序以在父类移动时触发：

```
public MainWindow()
{
    InitializeComponent();
    LocationChanged += new EventHandler(Window_LocationChanged);
} 
```

现在我遍历 MainWindow 拥有的所有窗口以重置它们的边距：

```
private void Window_LocationChanged(object sender, EventArgs e)
{
    foreach (Window win in this.OwnedWindows)
    {
        win.Top = this.Top + ((this.ActualHeight - win.ActualHeight) / 2);
        win.Left = this.Left + ((this.ActualWidth - win.ActualWidth) / 2);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:38:12.103

您可以为“子”表单公开 DragMove() 方法吗？然后只是从父母那里打电话？

```
public void DragWindow(object sender, MouseButtonEventArgs args)
{
     DragMove();
     UpdatePosition();

     childForm.DragMove();
     childForm.UpdatePosition();
} 
```

或者如果您只是使用鼠标位置来确定将表单移动到何处，请在当前的 DragMove() 方法中进行相同的计算并更改子表单的 Form.Location 属性？

# .net - .Net WFC/Web服务异常处理设计模式

> ID：445093
> 
> 赞同：5
> 
> 时间：2009-01-14T23:27:04.270
> 
> 标签：.net, wcf, web-services, exception

我正在尝试提出一种简单易用的设计模式，用于在 .net wcf 服务（特别是启用 silverlight 的 wcf 服务）中进行错误处理。如果在服务方法中抛出异常，silverlight 应用程序将看到一个 CommunicationException 说明“远程服务器返回错误：NotFound --->”，并且可能会根据您的设置显示堆栈跟踪，这完全没有用，因为它没有t 告诉你实际的错误，通常真正的错误不是“NotFound”。

阅读 Web 服务和 wcf 服务和异常，您需要抛出诸如 FaultException 或 SoapException 之类的 soap/wcf 标准异常。因此，对于 wcf 服务，您需要将每个方法包装在 try catch 中，捕获每个异常，将其包装在 FaultException 中并抛出它。至少这是我的理解，如果我错了，请纠正我。

所以我创建了我的设计模式：

```
[ServiceContract(Namespace = "http://MyTest")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class DataAccess
{
    /// <summary>
    /// Error class, handle converting an exception into a FaultException
    /// </summary>
    [DataContractAttribute]
    public class Error
    {
        private string strMessage_m;
        private string strStackTrace_m;

        public Error(Exception ex)
        {
            this.strMessage_m = ex.Message;
            this.strStackTrace_m = ex.StackTrace;
        }

        [DataMemberAttribute]
        public string Message
        {
            get { return this.strMessage_m; }
            set { this.strMessage_m = value; }
        }

        [DataMemberAttribute]
        public string StackTrace
        {
            get { return this.strStackTrace_m; }
            set { this.strStackTrace_m = value; }
        }

        //Convert an exception into a FaultException
        public static void Throw(Exception ex)
        {
            if (ex is FaultException)
            {
                throw ex;
            }
            else
            {
                throw new FaultException<Error>(new Error(ex));
            }
        }
    }

    [OperationContract]
    [FaultContract(typeof(Error))]
    public void TestException()
    {
        try
        {
            throw new Exception("test");
        }
        catch (Exception ex)
        {
            Error.Throw(ex);
        }
    }
} 
```

所以长话短说，我的silverlight应用程序仍然没有得到正确的错误。我检查了 AsyncCompletedEventArgs.Error 对象，它仍然包含具有一般错误的 CommunicationException 对象。帮助我想出一个很好的简单设计模式，让我可以轻松地从服务中抛出正确的异常，并轻松地在应用程序中捕获它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T10:15:52.027

我建议您集中 WCF 服务的错​​误处理，而不是在每个方法上都使用 try/catch。为此，您可以实现[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)接口：

```
public class ErrorHandler : IErrorHandler
{
    public bool HandleError(Exception error)
    {
        return true;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message msg)
    {
        DataAccessFaultContract dafc = new DataAccessFaultContract(error.Message);
        var fe = new FaultException<DataAccessFaultContract>(dafc);
        Message fault = fe.CreateMessageFault();
        string ns = "http://www.example.com/services/FaultContracts/DataAccessFault";
        msg = Message.CreateMessage(version, fault, ns);
    }
} 
```

每当您的一个抛出异常时，都会调用该`ProvideFault`方法。`OperationContract`它将异常转换为自定义定义`FaultContract`并将其发送给客户端。这样，您不再需要在每个方法中都添加 try/catch。`FaultContract`您还可以根据抛出的异常发送不同的。

`FaultException<DataAccessFaultContract>`在客户端，每次调用 Web 服务上的方法时都需要捕获。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T18:33:36.437

好的，我研究了 IErrorHandler 的想法。我不知道你可以这样做，而且它非常完美，因为它可以让你避免每种方法的尝试捕获。您也可以在标准 Web 服务中执行此操作吗？我通过以下方式实现它：

```
/// <summary>
/// Services can intercept errors, perform processing, and affect how errors are reported using the 
/// IErrorHandler interface. The interface has two methods that can be implemented: ProvideFault and
/// HandleError. The ProvideFault method allows you to add, modify, or suppress a fault message that 
/// is generated in response to an exception. The HandleError method allows error processing to take 
/// place in the event of an error and controls whether additional error handling can run.
/// 
/// To use this class, specify it as the type in the ErrorBehavior attribute constructor.
/// </summary>
public class ServiceErrorHandler : IErrorHandler
{
    /// <summary>
    /// Default constructor
    /// </summary>
    public ServiceErrorHandler()
    {
    }

    /// <summary>
    /// Specifies a url of the service
    /// </summary>
    /// <param name="strUrl"></param>
    public ServiceErrorHandler(string strUrl, bool bHandled)
    {
        this.strUrl_m = strUrl;
        this.bHandled_m = bHandled;
    }

    /// <summary>
    ///HandleError. Log an error, then allow the error to be handled as usual. 
    ///Return true if the error is considered as already handled
    /// </summary>
    /// <param name="error"></param>
    /// <returns></returns>
    public virtual bool HandleError(Exception exError)
    {
        System.Diagnostics.EventLog evt = new System.Diagnostics.EventLog("Application", ".", "My Application");
        evt.WriteEntry("Error at " + this.strUrl_m + ":\n" + exError.Message, System.Diagnostics.EventLogEntryType.Error);

        return this.bHandled_m;
    }

    /// <summary>
    ///Provide a fault. The Message fault parameter can be replaced, or set to
    ///null to suppress reporting a fault.
    /// </summary>
    /// <param name="error"></param>
    /// <param name="version"></param>
    /// <param name="msg"></param>
    public virtual void ProvideFault(Exception exError,
        System.ServiceModel.Channels.MessageVersion version,
        ref System.ServiceModel.Channels.Message msg)
    {
        //Any custom message here
        /*
        DataAccessFaultContract dafc = new DataAccessFaultContract(exError.Message);

        System.ServiceModel.FaultException fe = new System.ServiceModel.FaultException<DataAccessFaultContract>(dafc);
        System.ServiceModel.Channels.MessageFault fault = fe.CreateMessageFault();

        string ns = "http://www.example.com/services/FaultContracts/DataAccessFault";
        msg = System.ServiceModel.Channels.Message.CreateMessage(version, fault, ns);
        */
    }

    private string strUrl_m;
    /// <summary>
    /// Specifies a url of the service, displayed in the error log
    /// </summary>
    public string Url
    {
        get
        {
            return this.strUrl_m;
        }
    }

    private bool bHandled_m;
    /// <summary>
    /// Determines if the exception should be considered handled
    /// </summary>
    public bool Handled
    {
        get
        {
            return this.bHandled_m;
        }
    }
}

/// <summary>
/// The ErrorBehaviorAttribute exists as a mechanism to register an error handler with a service. 
/// This attribute takes a single type parameter. That type should implement the IErrorHandler 
/// interface and should have a public, empty constructor. The attribute then instantiates an 
/// instance of that error handler type and installs it into the service. It does this by 
/// implementing the IServiceBehavior interface and then using the ApplyDispatchBehavior 
/// method to add instances of the error handler to the service.
/// 
/// To use this class specify the attribute on your service class.
/// </summary>
public class ErrorBehaviorAttribute : Attribute, IServiceBehavior
{
    private Type typeErrorHandler_m;

    public ErrorBehaviorAttribute(Type typeErrorHandler)
    {
        this.typeErrorHandler_m = typeErrorHandler;
    }

    public ErrorBehaviorAttribute(Type typeErrorHandler, string strUrl, bool bHandled)
        : this(typeErrorHandler)
    {
        this.strUrl_m = strUrl;
        this.bHandled_m = bHandled;
    }

    public virtual void Validate(ServiceDescription description, ServiceHostBase serviceHostBase)
    {
        return;
    }

    public virtual void AddBindingParameters(ServiceDescription description, ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, BindingParameterCollection parameters)
    {
        return;
    }

    protected virtual IErrorHandler CreateTypeHandler()
    {
        IErrorHandler typeErrorHandler;

        try
        {
            typeErrorHandler = (IErrorHandler)Activator.CreateInstance(this.typeErrorHandler_m, this.strUrl_m, bHandled_m);
        }
        catch (MissingMethodException e)
        {
            throw new ArgumentException("The ErrorHandler type specified in the ErrorBehaviorAttribute constructor must have a public constructor with string parameter and bool parameter.", e);
        }
        catch (InvalidCastException e)
        {
            throw new ArgumentException("The ErrorHandler type specified in the ErrorBehaviorAttribute constructor must implement System.ServiceModel.Dispatcher.IErrorHandler.", e);
        }

        return typeErrorHandler;
    }

    public virtual void ApplyDispatchBehavior(ServiceDescription description, ServiceHostBase serviceHostBase)
    {
        IErrorHandler typeErrorHandler = this.CreateTypeHandler();            

        foreach (ChannelDispatcherBase channelDispatcherBase in serviceHostBase.ChannelDispatchers)
        {
            ChannelDispatcher channelDispatcher = channelDispatcherBase as ChannelDispatcher;
            channelDispatcher.ErrorHandlers.Add(typeErrorHandler);
        }
    }

    private string strUrl_m;
    /// <summary>
    /// Specifies a url of the service, displayed in the error log
    /// </summary>
    public string Url
    {
        get
        {
            return this.strUrl_m;
        }
    }

    private bool bHandled_m;
    /// <summary>
    /// Determines if the ServiceErrorHandler will consider the exception handled
    /// </summary>
    public bool Handled
    {
        get
        {
            return this.bHandled_m;
        }
    }
} 
```

服务：

```
[ServiceContract(Namespace = "http://example.come/test")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ErrorBehavior(typeof(ServiceErrorHandler),"ExceptonTest.svc",false)]
public class ExceptonTest
{
    [OperationContract]
    public void TestException()
    {   
        throw new Exception("this is a test!");
    }
} 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2010-08-17T18:44:22.777

对于懒惰的人（像我一样）：

```
using System.ServiceModel;  
using System.ServiceModel.Dispatcher;  
using System.ServiceModel.Description; 
```

# visual-studio - 带有用于 Web 项目的 DLL 的 Visual Studio XSD 文件

> ID：445097
> 
> 赞同：0
> 
> 时间：2009-01-14T23:28:15.373
> 
> 标签：visual-studio, dll, web, xsd

我正在尝试使用 Dataset.XSD 文件创建一个 DLL 来访问我网站的 VistaDB 数据库。DLL 开发和构建良好，但我需要构建 DLL 一次，然后更改最终引用 dll 的所有网站项目中数据库的“路径”（不同的数据库以及每个引用 dll 的网站的数据库路径）它是 bin 文件夹）。

我无法让 ConfigurationManager.ConnectionString("myconstr").ConnectionString 留在我的 DLL 项目中。一旦我保存它 - 它就会恢复为 Dataset.XSD 文件想要的任何内容（我开发它的数据库连接字符串）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T19:35:36.357

我发现如果我只是在记事本中打开它，进行更改，然后构建它就可以正常工作。每次我对 XSD 文件进行更改时都这样做有点痛苦，但我想总比没有好。

# geometry - 如何最好地在一组纬度/经度坐标上执行走廊范围搜索

> ID：445109
> 
> 赞同：4
> 
> 时间：2009-01-14T23:35:21.383
> 
> 标签：geometry, gis, geospatial, latitude-longitude, proximity

在给定指定宽度的情况下，从大约 5,00 个坐标中找到位于点路径内的坐标集的最佳方法是什么。例如，一架飞机跟随几个航路点。

有没有一种好方法可以按照与路线相同的顺序对它们进行排序。

计算速度比准确性更重要，因为我正在考虑生成建议列表。

从我所看到的来看，我认为这并不简单，而且问题有点宽泛，但欢迎任何建议/指针，例如：

1.  存储纬度/经度或使用球坐标的最佳方式
2.  在坐标集中有额外的聚类信息
3.  可以使用某种转换来简化范围检查
4.  订购积分的最佳方式是什么

这里是比对路径上的几个等距点进行圆形/方形检查更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:21:20.687

您可以进行许多优化：

*   将您的点分成固定大小的图块，这样您就不必检查每个点（首先确定您所在的图块，这样您就可以跳过其他图块中的所有点）。

*   在计算到每个点的距离时，您通常会使用毕达哥拉斯来获得距离。但是如果你只想知道哪个点最近，你可以省略平方根，这是一个昂贵的操作（见下面的示例代码）。

*   使用一些平面投影而不是使用纬度/经度，或者通过假设地球是平的来近似计算距离。对于小距离（直到几公里），这通常足够准确，并且比使用 WGS84 坐标更快、更容易。不过，您可能必须转换所有坐标，但这种预先计算将在运行时节省大量 cpu 周期。

-

```
 // delphi code that would iterate through a set of points to find the index
 // of the point that is the closest to the provided x/y
 function TMatcher.GetIndexOfClosest(X,Y:Double):Integer;
 var
  i : Integer;
  Closest:Double;
  Distance:Double;
begin
  Closest:= MaxInt;
  Result := -1;
  for i:=0 to high(Points) do
  begin
    // taking the square root is not needed here!
    Distance :=Sqr(X-Points[I].X)+Sqr(Y-Points[I].Y);

    if Distance < Closest then
    begin
      Closest := Distance;
      Result := i;
    end; 
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T04:02:11.140

遇到此类问题时，我会使用[PostGIS](http://postgis.refractions.net/)。将数据导入数据库，然后使用空间 SQL 函数在轨道上创建缓冲区并选择位于缓冲区内的点。比自己编码要快得多。

PostGIS（和[PostgreSQL](http://www.postgresql.org/)）很容易安装在 Windows/OSX/Linux 上。他们有很好的文档，并且在 Google 上的快速会话可以找到大多数问题的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T00:47:04.157

我假设您知道如何计算点和路径之间的距离。纬度/经度是简单的 (x,y) 数据，尽管使用小数数据而不仅仅是整数。

5,000 个数据点对于计算每个点到路径的距离确实还不错，但是如果您希望进行扩展，那么存储这些点的最佳选择是某种关系数据结构（例如四叉树）。这样，您可以立即丢弃不靠近您路径的点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:06:44.507

> ```
>  Best way to store lat / long, or use spherical coordinates 
> ```

你想存储什么？路径，还是您正在寻找的点？如果它是路径，那么它基本上是某种列表，因为点是有序的。根据您如何/是否要操作路径，这将决定您的数据结构。

> 在坐标集中有额外的聚类信息

您要存储什么信息？例如，如果您选择了一个链表作为数据结构，那么您可以拥有一个包含您需要的任何信息的类对象的链表。

> 可以使用某种转换来简化范围检查

您可以将 Lat/Long 转换为 UTM 或任何其他坐标系。两点之间的范围仍然相同。

> 订购积分的最佳方式是什么

如果您要存储路径，那么顺序很重要 - 如点 N-1 -> N -> N+1，依此类推...

# algorithm - “近似”最大公约数

> ID：445113
> 
> 赞同：46
> 
> 时间：2009-01-14T23:37:46.633
> 
> 标签：algorithm, language-agnostic, math, floating-point, greatest-common-divisor

假设您有一个浮点数列表，这些浮点数**大约**是一个公共数量的倍数，例如

2.468、3.700、6.1699

大约是 1.234 的所有倍数。你如何描述这个“近似 gcd”，你将如何计算或估计它？

与我对[这个问题](https://stackoverflow.com/questions/435533/detecting-the-fundamental-frequency)的回答密切相关。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-16T14:15:38.167

您可以运行 Euclid 的 gcd 算法，任何小于 0.01（或您选择的少量数字）的值都是伪 0。使用您的数字：

```
3.700 = 1 * 2.468 + 1.232,
2.468 = 2 * 1.232 + 0.004\. 
```

所以前两个数字的伪gcd是1.232。现在你用你的最后一个数字来获取这个 gcd：

```
6.1699 = 5 * 1.232 + 0.0099. 
```

所以1.232是伪gcd，复数是2,3,5。为了改善这个结果，您可以对数据点进行线性回归：

```
(2,2.468), (3,3.7), (5,6.1699). 
```

斜率是改进后的伪 gcd。

警告：第一部分是算法在数值上不稳定——如果你从非常脏的数据开始，你就有麻烦了。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-15T00:02:48.737

将您的测量值表示为最低值的倍数。因此，您的列表变为 1.00000、1.49919、2.49996。这些值的小数部分将非常接近 1/Nths，因为 N 的某个值取决于您的最低值与基频的接近程度。我建议循环增加 N 直到找到足够精细的匹配。在这种情况下，对于 N=1（即假设 X=2.468 是您的基频），您会发现标准偏差为 0.3333（三个值中的两个与 X * 1 相差 0.5），这是不可接受的高。对于 N=2（即假设 2.468/2 是您的基频），您会发现标准偏差几乎为零（所有三个值都在 X/2 的倍数的 0.001 以内），因此 2.468/2 是您的近似值GCD。

我计划中的主要缺陷是，当最低测量值最准确时，它的效果最好，但情况可能并非如此。这可以通过多次执行整个操作来缓解，每次丢弃测量列表中的最小值，然后使用每次通过的结果列表来确定更精确的结果。另一种改进结果的方法是调整 GCD 以最小化 GCD 的整数倍与测量值之间的标准偏差。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-26T07:19:14.447

这让我想起了寻找实数的良好有理数近似的问题。标准技术是连续分数展开：

```
def rationalizations(x):
    assert 0 <= x
    ix = int(x)
    yield ix, 1
    if x == ix: return
    for numer, denom in rationalizations(1.0/(x-ix)):
        yield denom + ix * numer, numer 
```

我们可以将其直接应用于 Jonathan Leffler 和 Sparr 的方法：

```
>>> a, b, c = 2.468, 3.700, 6.1699
>>> b/a, c/a
(1.4991896272285252, 2.4999594813614263)
>>> list(itertools.islice(rationalizations(b/a), 3))
[(1, 1), (3, 2), (925, 617)]
>>> list(itertools.islice(rationalizations(c/a), 3))
[(2, 1), (5, 2), (30847, 12339)] 
```

从每个序列中挑选出第一个足够好的近似值。（这里是 3/2 和 5/2。）或者不是直接比较 3.0/2.0 和 1.499189...，您可能会注意到 925/617 使用的整数比 3/2*大得多*，因此 3/2 是一个很好的停止位置.

您除以哪个数字并不重要。（例如，使用 a/b 和 c/b 可以得到 2/3 和 5/3。）一旦有了整数比率，就可以使用 shsmurfy 的线性回归来细化基本面的隐含估计。每个人都赢了！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T04:31:39.957

我假设你所有的数字都是**整**数值的倍数。对于我的其余解释，A 将表示您尝试查找的“根”频率，B 将是您必须开始的数字数组。

您正在尝试做的是表面上类似于[线性回归](http://en.wikipedia.org/wiki/Linear_regression)。您正在尝试找到一个线性模型 y=mx+b 来最小化线性模型和一组数据之间的平均距离。在您的情况下，b=0，m 是根频率，y 表示给定值。最大的问题是没有明确给出自变量 X。关于 X，我们唯一知道的是它的所有成员都必须是整数。

您的首要任务是尝试确定这些自变量。目前我能想到的最佳方法是假设给定频率具有几乎连续的索引 ( `x_1=x_0+n`)。所以`B_0/B_1=(x_0)/(x_0+n)`给定一个（希望是）小整数n。然后，您可以利用这一事实`x_0 = n/(B_1-B_0)`，从 n=1 开始，并不断提高它，直到 k-rnd(k) 在某个阈值内。在获得 x_0（初始索引）之后，您可以近似根频率 ( `A = B_0/x_0`)。然后您可以通过查找来近似其他索引`x_n = rnd(B_n/A)`。这种方法不是很健壮，如果数据中的错误很大，可能会失败。

如果您想要更好地逼近根频率 A，您可以使用线性回归来最小化线性模型的误差，因为您拥有相应的因变量。最简单的方法是使用最小二乘拟合。[Wolfram 的](http://mathworld.wolfram.com/LeastSquaresFitting.html)数学世界对这个问题进行了深入的数学处理，但通过谷歌搜索可以找到[相当简单的解释。](http://www.physics.csbsju.edu/stats/least_squares.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-15T00:08:50.970

有趣的问题...不容易。

我想我会看看样本值的比率：

*   3.700 / 2.468 = 1.499...
*   6.1699 / 2.468 = 2.4999...
*   6.1699 / 3.700 = 1.6675...

然后我会在这些结果中寻找一个简单的整数比率。

*   1.499 ~= 3/2
*   2.4999 ~= 5/2
*   1.6675 ~= 5/3

我没有追过它，但是沿着这条线的某个地方，你认为 1:1000 或其他东西的错误已经足够好，然后你回溯以找到基本的近似 GCD。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-30T22:53:08.080

我自己看到和使用的解决方案是选择一些常数，比如 1000，将所有数字乘以这个常数，将它们四舍五入，使用标准算法找到这些整数的 GCD，然后将结果除以所述常数(1000)。常数越大，精度越高。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-01T16:19:08.357

[我在 MathStackExchange（此处](https://math.stackexchange.com/questions/914288/how-to-find-the-approximate-basic-frequency-or-gcd-of-a-list-of-numbers)和[此处](https://math.stackexchange.com/questions/1834472/approximate-greatest-common-divisor/2523521#2523521)）中发现了这个问题，正在寻找我的答案。

我只设法（尚未）测量给定谐波频率列表（遵循声音/音乐命名法）的基频的*吸引力*，如果您的选项数量减少并且计算吸引力是可行的，这可能很有用每一个，然后选择最合适的。

我在 MSE 的问题中的 C&P（格式更漂亮）：

*   为 v 列表 {v_1, v_2, ..., v_n}，从低到高排序
*   mean_sin(v, x) = sum(sin(2*pi*v_i/x), for i in {1, ...,n})/n
*   mean_cos(v, x) = sum(cos(2*pi*v_i/x), for i in {1, ...,n})/n
*   **gcd_appeal** (v, x) = 1 - sqrt(mean_sin(v, x)^2 + (mean_cos(v, x) - 1)^2)/2，产生区间 [0,1] 中的数字。

**目标是找到使吸引力最大化的 x**。这是您的示例 [2.468, 3.700, 6.1699] 的 ( *gcd_appeal* ) 图，您发现最佳 GCD 位于**x = 1.2337899957639993** [![在此处输入图像描述](https://i.stack.imgur.com/Sa7Ut.png)](https://i.stack.imgur.com/Sa7Ut.png)

**编辑：** 您可能会发现这个 JAVA 代码很方便，可以计算除数相对于股息列表的（模糊）可除性（又名 gcd_appeal）**；**你可以用它来测试你的哪个候选人是最好的除数。代码看起来很丑，因为我试图优化它的性能。

```
 //returns the mean divisibility of dividend/divisor as a value in the range [0 and 1]
    // 0 means no divisibility at all
    // 1 means full divisibility
    public double divisibility(double divisor, double... dividends) {
        double n = dividends.length;
        double factor = 2.0 / divisor;
        double sum_x = -n;
        double sum_y = 0.0;
        double[] coord = new double[2];
        for (double v : dividends) {
            coordinates(v * factor, coord);
            sum_x += coord[0];
            sum_y += coord[1];
        }
        double err = 1.0 - Math.sqrt(sum_x * sum_x + sum_y * sum_y) / (2.0 * n);
        //Might happen due to approximation error
        return err >= 0.0 ? err : 0.0;
    }

    private void coordinates(double x, double[] out) {
        //Bhaskara performant approximation to
        //out[0] = Math.cos(Math.PI*x);
        //out[1] = Math.sin(Math.PI*x);
        long cos_int_part = (long) (x + 0.5);
        long sin_int_part = (long) x;
        double rem = x - cos_int_part;
        if (cos_int_part != sin_int_part) {
            double common_s = 4.0 * rem;
            double cos_rem_s = common_s * rem - 1.0;
            double sin_rem_s = cos_rem_s + common_s + 1.0;
            out[0] = (((cos_int_part & 1L) * 8L - 4L) * cos_rem_s) / (cos_rem_s + 5.0);
            out[1] = (((sin_int_part & 1L) * 8L - 4L) * sin_rem_s) / (sin_rem_s + 5.0);
        } else {
            double common_s = 4.0 * rem - 4.0;
            double sin_rem_s = common_s * rem;
            double cos_rem_s = sin_rem_s + common_s + 3.0;
            double common_2 = ((cos_int_part & 1L) * 8L - 4L);
            out[0] = (common_2 * cos_rem_s) / (cos_rem_s + 5.0);
            out[1] = (common_2 * sin_rem_s) / (sin_rem_s + 5.0);
        }
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-15T00:27:36.513

当您先验地选择 3 个正公差 (e1,e2,e3) 时，这是对 shsmurfy 解决方案的重新制定，
然后问题是搜索最小的正整数 (n1,n2,n3) 并因此搜索最大的根频率 f，使得：

```
f1 = n1*f +/- e1
f2 = n2*f +/- e2
f3 = n3*f +/- e3 
```

我们假设 0 <= f1 <= f2 <= f3
如果我们固定 n1，那么我们得到以下关系：

```
f  is in interval I1=[(f1-e1)/n1 , (f1+e1)/n1]
n2 is in interval I2=[n1*(f2-e2)/(f1+e1) , n1*(f2+e2)/(f1-e1)]
n3 is in interval I3=[n1*(f3-e3)/(f1+e1) , n1*(f3+e3)/(f1-e1)] 
```

我们从 n1 = 1 开始，然后递增 n1 直到区间 I2 和 I3 包含一个整数 - 这`floor(I2min) different from floor(I2max)`与 I3 相同
然后我们在区间 I2 中选择最小整数 n2，在区间 I3 中选择最小整数 n3。

假设浮点误差的正态分布，根频率 f 的最可能估计是最小化的

```
J = (f1/n1 - f)^2 + (f2/n2 - f)^2 + (f3/n3 - f)^2 
```

那是

```
f = (f1/n1 + f2/n2 + f3/n3)/3 
```

如果在区间 I2,I3 中有多个整数 n2,n3，我们也可以选择最小化残差的对

```
min(J)*3/2=(f1/n1)^2+(f2/n2)^2+(f3/n3)^2-(f1/n1)*(f2/n2)-(f1/n1)*(f3/n3)-(f2/n2)*(f3/n3) 
```

另一种变体可能是继续迭代并尝试最小化另一个标准，如 min(J(n1))*n1，直到 f 低于某个频率（n1 达到上限）......

# svg - 如何以不同的尺寸/坐标多次放置相同的路径？

> ID：445114
> 
> 赞同：1
> 
> 时间：2009-01-14T23:40:04.120
> 
> 标签：svg

我有一条在 Illustrator 中创建并保存为 SVG 的路径。

现在我想以编程方式将它以不同的大小和坐标放置在大画布上。

假设我有这张图片：

[![原始图像](https://i.stack.imgur.com/fXbIG.png)](https://i.stack.imgur.com/fXbIG.png)
[（来源：[omgtldr.com](http://omgtldr.com/img/original.png)）]

我如何在一个 SVG 文件中以不同的位置和大小重现相同的图像，如下所示：

[![替代文字](https://i.stack.imgur.com/Km0Qb.png)](https://i.stack.imgur.com/Km0Qb.png)
[（来源：[omgtldr.com](http://omgtldr.com/img/multiple.png)）]

例如，一个版本在坐标 x,y 处缩小了 20%；另一个在坐标 a、b 处放大 30%，依此类推。

请假设我对编程部分没问题，我对使用 XML 文件很满意。这是我不明白的SVG部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T13:38:09.827

您需要**[转换](http://www.w3.org/TR/SVG/coords.html)**属性。您可以使用**translate移动路径并使用****scale**调整它们的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-25T01:48:40.900

最好使用`<use>`元素（已转换）而不是为每个实例复制路径。

# svn - svn 转储失败并出现 WScript.Shell

> ID：445121
> 
> 赞同：1
> 
> 时间：2009-01-14T23:42:48.090
> 
> 标签：svn, wsh, svn-administraton

```
var WshShell = new ActiveXObject("WScript.Shell");
var commandLine = "svnadmin dump " + repoFullPath + " > " + repoName + ".dumpfile";
WshShell.Exec(commandLine) 
```

我试图在 Windows 上运行 cscript，但它似乎什么也没做。它不会创建转储文件。

我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T01:33:14.077

您尚未为 repoFullPath 或 repoName 分配值。在 Exec 行之前，将

```
WScript.Echo(commandLine); 
```

这样您就可以看到脚本试图运行的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T12:12:50.183

**使用cmd**为您的命令创建一个新的命令解释器，并在使用**/C**标志完成时终止它。

例如：

```
commandLine = "cmd /C svnadmin dump " + repoFullPath + " > " + repoName + ".dumpfile"; 
```

# c++ - 从构造函数中将“this”传递给函数？

> ID：445127
> 
> 赞同：32
> 
> 时间：2009-01-14T23:44:54.157
> 
> 标签：c++, constructor, this

我可以从类构造函数中将“this”作为指针传递给函数，并在构造函数返回之前使用它指向对象的成员吗？

只要在函数调用之前正确初始化访问的成员，这样做是否安全？

举个例子：

```
#include <iostream>

class Stuff
{
public:
    static void print_number(void *param)
    {
        std::cout << reinterpret_cast<Stuff*>(param)->number;
    }

    int number;

    Stuff(int number_)
        : number(number_)
    {
        print_number(this);
    }
};

void main() {
    Stuff stuff(12345);
}
```

我以为这行不通，但似乎行得通。这是标准行为，还是只是未定义的行为按照我的方式进行？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-14T23:49:46.813

当你在 C++ 中实例化一个对象时，构造函数中的代码是最后执行的。所有其他初始化，包括超类初始化、超类构造函数执行和内存分配都是预先发生的。构造函数中的代码实际上只是在构造对象后执行额外的初始化。因此，在类的构造函数中使用“this”指针并假设它指向一个完全构造的对象是完全有效的。

当然，如果您还没有在构造函数代码中初始化它们，您仍然需要注意未初始化的成员变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T23:52:49.087

[你可以在这里](https://isocpp.org/wiki/faq/ctors#using-this-in-ctors)找到一个很好的答案（C++ FAQ）。

调用类的所有继承成员和成员都保证在构造函数的代码执行开始时已构造，因此可以在其中安全地引用。

主要问题是你不应该在`this`. 大多数时候我都试过了，它最终只是调用了基类的函数，但我相信标准说结果是未定义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T09:32:14.063

作为所提供代码的旁注，我将模板化`void*`：

```
class Stuff
{
public:
    template <typename T>
    static void print_number(const T& t)
    {
        std::cout << t.number;
    }

    int number;

    Stuff(int number_)
    : number(number_)
    {
        print_number(*this);
    }
}; 
```

`t`如果类型没有成员，那么你会得到一个编译错误`number`。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-15T08:12:46.360

安迪，我认为你对标准的未定义部分是错误的。

当您在构造函数中时，“this”是指向一个对象的指针，该对象的类型是您正在创建的对象的**基类**，这意味着将调用在基类中部分实现的虚函数，并且虚拟表将不会被跟踪。

更多信息在[C++ Faq Lite](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.7) ...

# database - 图书馆数据库系统设计

> ID：445129
> 
> 赞同：4
> 
> 时间：2009-01-14T23:45:32.733
> 
> 标签：database, database-design, architecture

我有一个库，我想将它从旧系统迁移到新的优化系统。

旧图书馆是使用 MS Access（mdb 文件）构建的，其中每本书本身就是一个文件。每本书由两个表格组成，一个用于章节标题，第二个用于目录。还有一个 mdb 文件，其中包含所有书籍名称、每本书的页码、作者姓名和其他一般信息。

新的系统数据库引擎是 MySQL，所以我有三种（可能）存储书籍的可能性： 1- 将所有书籍章节标题存储在一个表中，并将所有书籍内容存储在另一个大表中。2-将所有书籍的章节标题存储在一个表格中，并将每本书的内容存储在本书的表格中。（所以如果我有 5 本书，我会得到 1 个章节标题表和 5 个内容表）。3-将它们存储为旧系统的设计，每本书有两个表格，一个是章节标题，第二个是内容。

我不喜欢使用多个数据库，一个数据库可以像 wordpress.com 托管的博客一样完美地完成工作（是的，他们有巨大的数据库，当然他们使用其他技术，但我说的是数据库系统架构） .

那个图书馆有500多本书，而且数量还在增加。

你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T00:05:11.323

以上都不是。没有理由将章节标题与章节内容分开。但是你需要一张桌子来存放书名本身。这是一个建议的表结构：

```
CREATE TABLE books (
  book_id     SERIAL PRIMARY KEY,
  title       VARCHAR(100) NOT NULL,
  published   DATE NOT NULL,
  isbn        VARCHAR(16) NOT NULL
  -- etc.
);

CREATE TABLE chapters (
  book_id     BIGINT UNSIGNED NOT NULL,
  chapter_id  SERIAL,
  chapter_num VARCHAR(10) NOT NULL,  -- varchar to allow chapter "VII."
  title       VARCHAR(100) NOT NULL,
  content     MEDIUMTEXT,
  PRIMARY KEY (book_id, chapter_id),
  FOREIGN KEY (book_id) REFERENCES books(book_id)
); 
```

章节表中的几千行对于 MySQL 这样的数据库来说是微不足道的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T00:06:10.087

这是我的建议：

带有主键、标题、ISBN、出版商等的 Books 表。带有 Books 的主键、名称和外键的 Authors 表。包含主键、章节编号、章节标题、目录路径和书籍外键的目录表。

我不会将章节内容作为 BLOB 或 CLOB 存储在数据库中。您无法在其中搜索。最好将它们保存在文件系统中，并在数据库中存储文件的相对或绝对路径。

您可以使用 Lucene 为内容编制索引，以允许对内容进行类似 Google 的搜索。这将是对您当前系统的改进。

# c# - .NET 指纹 SDK

> ID：445133
> 
> 赞同：4
> 
> 时间：2009-01-14T23:47:55.430
> 
> 标签：c#, .net, fingerprint, biometrics

我正在寻找可用于 .NET 的指纹读取器 SDK 的比较（我们使用的是 .Net 3.5）。我的要求是
1\. 将多个指纹与一个人关联。
2.自行存储指纹。（所以我不必为我的程序更改数据库。）
3\. 在事件和无事件模式下工作。（事件模式：如果有人在阅读器上滑动手指，则发出通知；无事件模式：我以同步模式激活阅读器）。4\. 应提供确认用户或识别用户的API。（确认API：我发送人的ID/唯一号码，它确认是同一个人；识别API：sdk使用指纹查找人后发送人的ID）

如果有人知道互联网上可用的指纹阅读器，我还想比较一下指纹阅读器。

希望我很清楚。

谢谢，
基肖尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-13T19:45:40.660

如果 QFinger 有点过多，请尝试 [ [http://www.grfinger.com/]](http://www.grfinger.com/])。

GrFinger 是一个非常简单的 SDK，不需要服务器等。您可以将它捕获的指纹存储为您选择的任何形式的 byte[]。我们将它们作为 VARBINARY(MAX) 存储在 SQL Server 中，但您可以根据需要执行任何操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-11T08:50:55.830

我已经使用过 Queaso 的 SDK。SDK 支持您要求的功能。但您最好联系他们以获取更多详细信息。

*** 该产品名为[QFinger](http://www.queaso.be/what-we-do/products/queaso-products/qfinger/)。您还可以在此处找到读者列表...

* * *

QFinger 不再只是为了更新而存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-06T08:37:21.677

由于您正在寻找指纹读取器 SDK 的比较，因此您可以从这里开始。您可以从 M2SYS 查找[BioPlugin SDK](http://www.m2sys.com/bioplugin/)。该 SDK 允许开发人员将多模式生物识别软件与任何 Windows 或 Web 软件快速集成。它支持任何符合 SQL 的数据库，包括 MS SQL Server、Access、MySQL、Oracle 9i、DB2、Informix 等。

由于您还想比较指纹扫描仪，因此我可以推荐两个：

1.  M2-EasyScan™ USB 指纹读取器。M2-EasyScan™ 指纹读取器是一款坚固耐用、符合人体工程学的指纹读取器，即使在高吞吐量环境中也能确保一致的图像质量和准确的结果。它可以捕获高质量的图像，并且不会因频繁使用而退化。

2.  M2-EasyScan Pro™。这一款最适合大规模或小规模指纹识别。它在扫描表面上的厚实防刮涂层可在任何恶劣环境下长期重载使用，没有任何困难。该扫描仪经 FBI 认证，符合 PIV-071006 单指纹读取器图像质量规范，旨在从干燥、潮湿、老化、伤痕累累和难以扫描的手指中捕获单指纹图像，以提高准确性和可靠性。

你也可以谷歌搜索指纹扫描仪，你会想出多种可供选择的选项。

# .net - 如何在我的 XSD 数据集中处理 DBNull 到布尔值的转换？

> ID：445136
> 
> 赞同：2
> 
> 时间：2009-01-14T23:50:12.163
> 
> 标签：.net, xsd, dataset, dbnull

在我的数据库中，我的一个表中有几列是位（布尔）值。它们被允许为 NULL，因为这些字段并不总是包含数据。

我已经完成了使用该表创建 XSD 数据集的过程，并确保将 AllowDBNull 字段设置为 True。

但是，当我使用配置的 GetData 方法将数据库中的一条记录拉到数据表中时，我遇到了以下错误：

```
[InvalidCastException: Conversion from type 'DBNull' to type 'Boolean' is not valid.] 
```

我是否需要在列的 DefaultValue 字段中指定其他内容，或者是否需要设置其他字段？

我仍处于这个项目的开发阶段，所以如果将字段更改为 char 并首选使用 Y/N/NULL 选项，我不会太反对这种方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:38:00.183

我不得不不同意伊恩。三值逻辑与二值逻辑一样可行。桌子上的人是生是死，或者你不知道他是生是死。如果迈克有他的方式，你不能在这里使用一点。您需要一个状态表的 FK，1 = 活着，2 = 死亡，3 = 未知。

该位的全部目的是节省空间，您始终可以将列设置为 CHAR(1)，并使用 Constraint 将值限制为 T 或 F、Y 或 N（或 U）。

但我认为伊恩误解了迈克所说的话。Mike 并不反对使用 Null，毕竟他认为 EndDate 列在处理完成之前应该为空。他只是说不要在列中注入具有神秘属性的空值......就像它是了解进程是否处于某种状态的关键。

事实上，数据库中的 Null 具有某些非常有用的副作用。Oracle（可能是其他数据库）不索引空值。所以，如果你有一列只有一个值很重要——比如你有一个永远不会清除的员工列表和一个索引的 Is_Active_Employee 位列。在这种情况下，对于已建立的企业，您拥有的员工数量比您现在拥有的员工数量要>>>。假设你有 1% 的 1 和 99% 的 0。

该索引比它需要的大 99 倍。它正在索引所有 1，这很好，因为它们是表的 1%，但它也为你永远无法使用该索引查找的行加载了 0。如果您想要所有不活跃的员工，则索引将被忽略并执行 FTS。所以从数据库的角度来看，1 和 NULL 会更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T23:58:43.957

恕我直言，您不应在位/布尔字段中允许空值。

Mike Hadlow 在这里有一篇很好的文章：

[http://mikehadlow.blogspot.com/2006/10/nullability-voodoo.html](http://mikehadlow.blogspot.com/2006/10/nullability-voodoo.html)

根据定义，布尔值是一种双态类型。通过使其可以为空，您正在添加第三种状态。它会在某个时候回来困扰你。

# windows - 您如何安排在 Windows XP 上运行的每日脚本？

> ID：445138
> 
> 赞同：5
> 
> 时间：2009-01-14T23:51:15.920
> 
> 标签：windows, ruby, windows-xp, cron, scheduled-tasks

我用 Ruby 写了一个脚本。我想每天在某个时间运行它。在 Windows XP 系统上如何做到这一点？

我在机器上四处寻找并发现了“计划任务”控制面板，但据我从“向导”提供的选项中可以看出，它似乎与运行脚本没有任何关系。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T23:54:37.443

计划任务。有时，您必须使批处理文件调用脚本，并安排批处理。

假设您要运行“script.vbs”，则必须创建此批处理：

```
cscript script.vbs 
```

cscript 是解释 vbs 脚本的 windows 脚本宿主。我敢肯定红宝石有类似的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T23:54:14.370

您可以使用计划任务执行此操作，只需浏览要运行的程序或脚本（如果未列出）（在这种情况下，我猜是 ruby​​ 解释器，并添加要运行的脚本名称作为参数）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T23:55:06.553

使用 Windows 任务计划程序。

在控制面板 > 计划任务下。

您可以将其设置为从命令行运行任何应用程序或可执行文件。

**更新：** *（1/15/09）*[Wouter van Nifterick](https://stackoverflow.com/users/38813/wouter-van-nifterick) 的一个好点，记住要注意该过程在下一个运行之前完成（在评论中）。

这可以通过进入高级选项并调整任务可能运行的允许时间量来完成。如果任务已配置，请打开它并单击“设置”选项卡。在此选项卡的顶部，您将看到一个复选框，后跟“如果任务运行时停止：”，然后有两个文本框可以输入小时和分钟。如果您的脚本每天运行一次，您将希望将此设置为 23 小时左右。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T19:30:49.440

'at' 命令是调度程序的一个很好的命令行版本。

# c++ - 如何从 32 位 WOW 进程中获取 Program Files 文件夹路径（不是 Program Files (x86)）？

> ID：445139
> 
> 赞同：16
> 
> 时间：2009-01-14T23:52:01.363
> 
> 标签：c++, windows, 64-bit

我需要从 32 位 WOW 进程中获取到本机（而不是 WOW）程序文件目录的路径。

当我将 CSIDL_PROGRAM_FILES（或 CSIDL_PROGRAM_FILESX86）传递到 SHGetSpecialFolderPath 时，它返回 WOW（程序文件（x86））文件夹路径。

如果可能的话，我宁愿避免使用环境变量。

我想比较我从注册表中读取的一些值，如果这些值指向我的应用程序的 WOW 或本机版本的路径，那么我的代码会执行某些操作，如果不是，它会执行其他操作。为了弄清楚我的应用程序的本机版本和 WOW 版本应该在哪里，我需要获取“程序文件（x86）”和“程序文件”的路径。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-17T01:08:56.663

我感谢所有帮助，尤其是此线程中的警告。但是，我确实需要这条路，这就是我最终得到它的方式：

（为清楚起见，删除了错误检查，使用风险自负等）

```
WCHAR szNativeProgramFilesFolder[MAX_PATH];
ExpandEnvironmentStrings(L"%ProgramW6432%", 
                       szNativeProgramFilesFolder, 
                       ARRAYSIZE(szNativeProgramFilesFolder); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-15T00:35:52.803

让我引用**Raymond Chen**关于这个问题的[优秀博文：](http://blogs.msdn.com/oldnewthing/archive/2008/12/22/9244582.aspx)

> 在 64 位 Windows 上，32 位程序在仿真层中运行。这个仿真层模拟 x86 架构，虚拟化 CPU、文件系统、注册表、环境变量、系统信息函数，所有这些东西。如果 32 位程序尝试查看系统，它将看到 32 位系统。例如，如果程序调用 GetSystemInfo 函数来查看正在运行的处理器，它将被告知它运行在一个 32 位处理器上，具有 32 位地址空间，在一个 32 位天空和 32 32 位树中的位鸟。
> 
> 这就是模拟的重点：通过模拟 32 位执行环境来保持 32 位程序的运行。
> 
> ...
> 
> 问题是“从 32 位应用程序中找到 x64 Program Files 目录的方法是什么？”
> 
> 答案是“**与系统一起工作比反对它更好。** ”如果你是一个 32 位程序，那么每次你尝试与外部世界交互时，你都将与模拟器作斗争。相反，只需将您的安装程序重新编译为 64 位程序。让 32 位安装程序检测到它在 64 位系统上运行，然后启动 64 位安装程序。64 位安装程序不会在 32 位仿真层中运行，因此当它尝试复制文件或更新注册表项时，它会看到真正的 64 位文件系统和真正的 64 位注册表。

如果您仍然想这样做，我建议您阅读这篇博文中的评论，因为它们包含一些很好的提示。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T00:36:27.593

您走在正确的道路上 - 使用[FOLDERID_ProgramFilesX64](http://msdn.microsoft.com/en-us/library/bb762584(VS.85).aspx)的 KNOWNFOLDERID

SHGetKnownFolderPath函数可用于检索给定 KnownFolder 的完整路径[。](http://msdn.microsoft.com/en-us/library/bb762188(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T00:37:02.333

根据臭名昭著的 Raymond Chen 最近的一篇帖子，这几乎可以肯定是一个坏主意。有关详细信息，请参见[此处](http://blogs.msdn.com/oldnewthing/archive/2008/12/22/9244582.aspx)。归根结底，我认为这是可以做到的，但这是一项艰巨的工作，而且几乎可以肯定有一种更简单的方法。

Microsoft 构建了 WOW 仿真层，让您的生活更轻松。不要浪费他们所有的时间和精力来对抗它:-)。

也许如果您告诉我们**为什么**需要非 WOW 程序文件目录，我们可以进一步提供帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-22T12:40:01.263

我需要它从 Logonscript 获取 x64 程序文件夹并使用：

```
Dim oWshShell : Set oWshShell = CreateObject("WScript.Shell")
Dim sProgramDirPath : sProgramDirPath = 
    oWshShell.ExpandEnvironmentStrings("%ProgramW6432%")

WScript.Echo sProgramDirPath 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-03-23T12:16:56.017

获取“程序文件”路径的最佳和通用方法是从注册表中查询它：

64-Bit-Process 可以查询： **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ProgramFilesDir** *得到“C:\Program Files”* **HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\ProgramFilesDir** *得到“C:\Program Files ( x86)"*

32-Bit-Process (Wow64) 可以查询： **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ProgramFilesDir** *以获取 "C:\Program Files (x86)"* **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ProgramFilesDir**与**KEY_WOW64_64KEY**选项！ *获取“C：\ Program Files”*

伪代码：

```
OpenKey(hKey, HKEY_LOCAL_MACHINE, L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion", KEY_READ | KEY_WOW64_64KEY);
QueryStringValue(hKey, L"ProgramFilesDir", sValue); 
```

# apache - Apache/Tomcat - 基于 AD 组成员身份的 LDAP 身份验证

> ID：445144
> 
> 赞同：2
> 
> 时间：2009-01-14T23:54:58.223
> 
> 标签：apache, tomcat, active-directory, ldap

我们目前正在运行一个 Apache/Tomcat (5.5) 应用程序，并且我们正在针对多域结构使用 LDAP 身份验证功能（通过配置领域），它运行良好。我们想做的一件事是根据用户在 AD 中特定组的成员身份限制对用户的访问。基本上，只有 GroupA 的用户才能访问该应用程序。我想知道这种配置是否可行。如果是这样，你能指出我正确的方向吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:57:42.830

实现你自己的领域

[http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html](http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T13:49:59.333

我相信您可以使用 apache 中的 mod_authnz_ldap 模块完成此操作：

[http://httpd.apache.org/docs/2.2/mod/mod_authnz_ldap.html#reqgroup](http://httpd.apache.org/docs/2.2/mod/mod_authnz_ldap.html#reqgroup)

# batch-file - 如何从批处理脚本中获取注册表项的值？

> ID：445167
> 
> 赞同：69
> 
> 时间：2009-01-15T00:05:40.120
> 
> 标签：batch-file, registry

我需要使用 REG QUERY 命令来查看键的值并使用以下命令将结果设置为变量：

```
FOR /F "tokens=2* delims=    " %%A IN ('REG QUERY "KeyName" /v ValueName') DO SET Variable=%%B 
```

但如果密钥不存在，我会在控制台中显示错误。我需要隐藏这个错误！我尝试在命令后放置一个 2>nul 来停止 stderr，但如果我只调用命令，这将有效：

```
REG QUERY "KeyName" /v ValueName 2>nul 
```

如果我像这样将它放入 FOR 命令中：

```
FOR /F "tokens=2* delims=    " %%A IN ('REG QUERY "KeyName" /v ValueName') DO SET Variable=%%B 2>nul 
```

显示错误。那么有人知道如何隐藏错误吗？或者也许另一个命令也可以查看密钥是否存在？

谢谢

PS：我用的是Windows XP

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-15T01:23:00.837

这对我有用：

```
@echo OFF

setlocal ENABLEEXTENSIONS
set KEY_NAME="HKEY_CURRENT_USER\Software\Microsoft\Command Processor"
set VALUE_NAME=DefaultColor

FOR /F "usebackq skip=4 tokens=1-3" %%A IN (`REG QUERY %KEY_NAME% /v %VALUE_NAME% 2^>nul`) DO (
    set ValueName=%%A
    set ValueType=%%B
    set ValueValue=%%C
)

if defined ValueName (
    @echo Value Name = %ValueName%
    @echo Value Type = %ValueType%
    @echo Value Value = %ValueValue%
) else (
    @echo %KEY_NAME%\%VALUE_NAME% not found.
) 
```

`usebackq`需要`REG QUERY`使用双引号的命令。

`skip=4`忽略除具有值名称、类型和值的行（如果存在）之外的所有输出。

`2^>nul`防止出现错误文本。`^`是转义字符，可让您将 放入`>`命令中`for`。

当我按照给定的方式运行上面的脚本时，我得到了这个输出：

```
Value Name = DefaultColor
Value Type = REG_DWORD
Value Value = 0x0 
```

如果我将值更改为`VALUE_NAME`，`BogusValue`那么我会得到：

```
"HKEY_CURRENT_USER\Software\Microsoft\Command Processor"\BogusValue not found. 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-12-02T22:29:33.280

这适用于我在 Windows 7 上包含空格的变量：

```
FOR /F "usebackq tokens=3*" %%A IN (`REG QUERY "HKEY_LOCAL_MACHINE\Software\SomeAPP" /v ValueName`) DO (
    set appdir=%%A %%B
    )
ECHO %appdir% 
```

变量`A`包含第一个空格之前的所有数据，`B`- ValueName 的其余部分（包括更多空格），所以`appdir = ValueName`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-04-27T20:51:13.277

这个单线与您最初的尝试几乎相同，只是添加了一些内容。它适用于包括空格的路径，并且即使未找到密钥（并隐藏错误）也适用于 XP 和 Windows 7。 `%fn%`如果密钥不存在，将为空。此示例获取当前桌面背景文件名：

```
for /f "tokens=2*" %%a in ('reg query "HKEY_CURRENT_USER\Control Panel\Desktop" /v Wallpaper 2^>^&1^|find "REG_"') do @set fn=%%b 
```

此命令使用`tokens=2*`with`%%a`作为循环变量，但消耗`%%b`以正确处理空格。使用`tokens=2*`时，循环变量`%%a`被赋予第二个标记（在本例中为`REG_SZ`）中的值，`%%b`并被赋予下一组分隔符之后的行的剩余部分，包括所有内部分隔符。这意味着`%%b`将正确复制分隔符 - 即使多个分隔符聚集在一起。例如，该值可能是`C:\A weird path\blah.png`。这种读取值的技术将正确保留 和 之间的两个`C:\A`空格`weird`。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-12-22T14:33:02.083

基于tryToBeClever解决方案（我碰巧也偶然发现并在找到它之前通过反复试验修复了自己），我还建议将结果输出传递给`reg query`通过`find`以过滤由于`! REG.EXE VERSION x.y`不一致而导致的不需要的行。`find`过滤和`tokens`调整还允许准确选择我们想要的（通常是值）。还添加了引号以避免键/值名称包含空格的意外结果。

当我们只对获取值感兴趣时提出的最终结果：

```
@echo off
setlocal ENABLEEXTENSIONS
set KEY_NAME=HKCU\Software\Microsoft\Command Processor
set VALUE_NAME=DefaultColor
for /F "usebackq tokens=1,2,*" %%A IN (`reg query "%KEY_NAME%" /v "%VALUE_NAME%" 2^>nul ^| find "%VALUE_NAME%"`) do (
  echo %%C
) 
```

使用的一个潜在警告`find`是，错误发生时设置的错误级别`reg`现在被混淆了，因此应该只对已知存在和/或在先前验证之后的密钥使用这种方法。

如果键名还包含值名（如and`skip=1`的情况），则可以进行微小的额外优化（添加以避免处理输出的第一行）但消除了大部分灵活性，因此仅应在特定用途中使用-案例。`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion``CurrentVersion`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-04T14:52:14.080

```
@echo off
setlocal ENABLEEXTENSIONS
set KEY_NAME=HKLM\SOFTWARE\Wow6432Node\Acme Software Inc\Common
set VALUE_NAME=InstallDir

FOR /F "tokens=2*" %%A IN ('REG.exe query "%KEY_NAME%" /v "%VALUE_NAME%"') DO (set pInstallDir=%%B)
echo %pInstallDir% 
```

这在 Win7 中对我有用，其中键有空格，值也有空格。所以将上面的内容保存在 c:\temp 中作为 test.bat，打开一个 cmd 窗口并运行它。

C：\临时>测试

C:\Program Files (x86)\acme Software Inc\APP\

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-10-31T23:23:51.053

出于某种原因，Patrick Cuff 的代码在我的系统（Windows 7）上不起作用可能是由于 tryToBeClever 的评论。稍微修改一下就可以了：

```
@echo OFF

setlocal ENABLEEXTENSIONS
set KEY_NAME=HKEY_CURRENT_USER\Software\Microsoft\Command Processor
set VALUE_NAME=DefaultColor

FOR /F "tokens=1-3" %%A IN ('REG QUERY %KEY_NAME% /v %VALUE_NAME% 2^>nul') DO (
    set ValueName=%%A
    set ValueType=%%B
    set ValueValue=%%C
)

if defined ValueName (
    @echo Value Name = %ValueName%
    @echo Value Type = %ValueType%
    @echo Value Value = %ValueValue%
) else (
    @echo %KEY_NAME%\%VALUE_NAME% not found.
) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-11-28T17:21:24.860

如果值包含空格，则此方法有效：

```
FOR /F "skip=2 tokens=1,2*" %%A IN ('REG QUERY "%KEY_NAME%" /v "%VALUE_NAME%" 2^>nul') DO (
    set ValueName=%%A
    set ValueType=%%B
    set ValueValue=%%C
)

if defined ValueName (
    echo Value Name = %ValueName%
    echo Value Type = %ValueType%
    echo Value Value = %ValueValue%
) else (
    @echo "%KEY_NAME%"\"%VALUE_NAME%" not found.
) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-02-17T13:19:05.193

对于 Windows 7（专业，64 位 - 不能代表其他人）我看到 REG 不再吐出

```
! REG.EXE VERSION 3.0 
```

就像在 XP 中一样。所以上面需要修改才能使用

```
skip=2 
```

而不是 4 - 如果您希望脚本可移植，这会使事情变得混乱。尽管它更加重量级和复杂，但基于[WMIC](http://www.robvanderwoude.com/wmic.php#Registry)的解决方案可能会更好。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-12-11T12:12:22.647

这里的解决方案水平很高。

我的小盐作为解决方案@Patrick Cuff 没有开箱即用；我有 2 个问题

*   我使用 Windows 7 => 更改为“skip=2”
*   注册表值的值中有一个空格`Value Value = C:\Program Files\...`

这是我找到的解决方案：取 4 个令牌并将 ValueValue 设置为 %%C 和 %%D。（感谢@Ivan！）

```
setlocal ENABLEEXTENSIONS
set KEY_NAME="HKEY_CURRENT_USER\Software\Microsoft\Command Processor"
set VALUE_NAME=DefaultColor

FOR /F "usebackq skip=2 tokens=1-4" %%A IN (`REG QUERY %KEY_NAME% /v %VALUE_NAME% 2^>nul`) DO (
    set ValueName=%%A
    set ValueType=%%B
    set ValueValue=%%C %%D
)

if defined ValueName (
    @echo Value Name = %ValueName%
    @echo Value Type = %ValueType%
    @echo Value Value = %ValueValue%
) else (
    @echo "%KEY_NAME:"=%\%VALUE_NAME%" not found.
) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-06-01T06:01:14.383

要获得注册表值的特定答案，您可以使用以下查询：

REG QUERY "Key_Name" /v "Value_Name" /s

例如： REG QUERY "HKEY_CURRENT_USER\Software\Microsoft\Command Processor" /v "EnableExtensions" /s

这里 /v ：查询特定的注册表项值。

/s ：递归查询所有子键和值（如 dir /s）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-02T14:09:30.043

```
@echo off
setlocal ENABLEEXTENSIONS
set KEY_NAME=HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\awhost32.exe
set VALUE_NAME=Path
for /F "usebackq tokens=3" %%A IN (`reg query "%KEY_NAME%" /v "%VALUE_NAME%" 2^>nul ^| find "%VALUE_NAME%"`) do (
  echo %%A
) 
```

你如何处理 %%A 变量中的空格？这导致 C:\Program。实际路径是 C:\Program Files\Symantec\pcAnywhere。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-01-19T15:13:00.180

I've come across many errors on Windows XP computers when using WMIC (eg due to corrupted files on machines). Hence imo best not to use WMIC for Win XP in code. No problems with WMIC on Win 7 though.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-06-27T11:41:00.200

```
echo Off
setlocal ENABLEEXTENSIONS

set KEY_NAME="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup"
set VALUE_NAME=release 

REG QUERY %KEY_NAME% /S /v %VALUE_NAME%
endlocal 
```

点将 \ 放在 KEY_NAME 的末尾

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-15T01:36:14.960

谢谢，我只需要使用：

```
SETLOCAL EnableExtensions 
```

并放一个：

```
2^>nul 
```

进入 FOR 命令中调用的 REG QUERY。再次非常感谢！:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-12-17T06:29:02.733

您可以按如下方式获取**注册表项**的**值**

 **```
@echo OFF
setlocal ENABLEEXTENSIONS
set REG_NAME="HKEY_CURRENT_USER\Software\Test"
set KEY_NAME=TestVal

FOR /F "usebackq skip=2 tokens=1-3" %%A IN (`REG QUERY %REG_NAME% /v %KEY_NAME% 2^>nul`) DO (
    @echo %%A : %%C
)
pause 
```

那些想知道如何添加 reg 键的人，这里有一种方法。

```
REGEDIT4

; @ECHO OFF
; CLS
; REGEDIT.EXE /S "%~f0"
; EXIT

[HKEY_CURRENT_USER\Software\Test]
"TestVal"="Succeeded" 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-28T13:38:43.343

您还可以将此解决方案与单个命令行一起使用：

`VARIABLE=$(reg query "HKLM\REGISTRYKEYPATH" /v "REGISTRY KEY" | grep -i "REGISTRY KEY" | awk '{print $NF;}')`

为了您的信息，$NF 检索最后一个字段（即注册表项值）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-11-09T04:29:45.937

使用注册表：

```
@echo off
setlocal
::if the scrit is not ran as administrator
::  and the key does not require admin permissions
set __COMPAT_LAYER=RunAsInvoker

set "key=%~1"
set "value=%~2"

regedit /e "#.reg" "%key%"

for /f "tokens=1,* delims==" %%a in ('find  """%value%""=" "#.reg"') do if "%%~b" neq "" echo %%~b
del /q #.reg

endlocal 
```

例子：

```
call regreader.bat "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.0\Setup\1033\" Version 
```

输出：

> 3.0.30729.4926

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2017-10-20T20:18:04.297

```
set regVar_LocalPrjPath="LocalPrjPath"
set regVar_Path="HKEY_CURRENT_USER\Software\xyz\KeyPath"

:: ### Retrieve VAR1 ###
FOR /F "skip=2 tokens=2,*" %%A IN ('reg.exe query %regVar_Path% /v %regVar_LocalPrjPath%') DO set "VAR1=%%B" 
```

# asp.net - 防止 XSS（跨站脚本）

> ID：445177
> 
> 赞同：10
> 
> 时间：2009-01-15T00:11:31.620
> 
> 标签：asp.net, asp.net-mvc, security, xss

假设我有一个简单的 ASP.NET MVC 博客应用程序，我希望允许读者向博客文章添加评论。如果我想防止任何类型的 XSS 恶作剧，我可以对所有评论进行 HTML 编码，以便它们在呈现时变得无害。但是，如果我想要*一些*基本功能，如超链接、粗体、斜体等，该怎么办？

我知道 StackOverflow 使用[WMD Markdown Editor ，如果不是因为它](http://wmd-editor.com/)*同时支持*HTML 和 Markdown 这[使其容易受到 XSS 攻击](https://blog.stackoverflow.com/2008/06/safe-html-and-xss/)，这对于我想要完成的工作来说似乎是一个不错的选择。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T15:21:22.860

如果您不想使用编辑器，您可以考虑[OWASP 的 AntiSamy](http://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project_.NET)。

你可以在这里运行一个例子： [http ://www.antisamy.net/](http://www.antisamy.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T00:15:10.913

你要支持多少 HTML？只是粗体/斜体/基本的东西？在这种情况下，您可以将它们转换为 markdown 语法，然后剥离 HTML 的其余部分。

剥离需要在服务器端完成，然后再存储。在检查 SQL 漏洞和其他不需要的东西时，您还需要验证服务器上的输入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T01:43:59.517

如果您需要在浏览器中执行此操作：[http ://code.google.com/p/google-caja/wiki/JsHtmlSanitizer](http://code.google.com/p/google-caja/wiki/JsHtmlSanitizer)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T00:20:53.100

我建议你只提交降价语法。在前端，客户端可以键入 markdown 并进行 HTML 预览（与 SO 相同），但只能在服务器端提交 markdown 语法。然后您可以验证它、生成 HTML、转义并存储它。

我相信这是我们大多数人的做法。无论哪种情况，markdown 都可以减轻任何人编写结构化 HTML 代码的负担，并为那些甚至不知道如何编写的人提供权力。

如果您想对 HTML 做一些特定的事情，那么您可以使用一些 CSS 继承来调整它 '.comment a { color: #F0F; }'，前端 JS 或者只是在存储之前遍历从解析 markdown 生成的 HTML。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T00:41:04.557

为什么不使用 Jeff 的代码？[http://refactormycode.com/codes/333-sanitize-html](http://refactormycode.com/codes/333-sanitize-html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T00:47:19.613

我会投票给[FCKEditor ，但你](http://www.fckeditor.net/)[也](http://htmlpurifier.org/)必须对返回的输出做一些[额外的步骤](https://stackoverflow.com/questions/65734/how-do-use-fckeditor-safely-without-risk-of-cross-site-scripting)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T00:47:07.243

您可以使用 HTML 白名单，以便某些标签仍然可以使用，但其他所有内容都会被阻止。

有一些工具可以为您做到这一点。SO 使用Slough[链接](https://stackoverflow.com/questions/445177/preventing-xss#445231)[的代码](http://refactormycode.com/codes/333-sanitize-html)。

# html - 多种形式

> ID：445178
> 
> 赞同：0
> 
> 时间：2009-01-15T00:12:20.497
> 
> 标签：html, forms

例如，希望 5 个复选框拥有自己的提交按钮，而其他 5 个复选框拥有自己的提交。应该彼此独立，但它们不会在 html 页面中组合在一起。
我嵌套其他形式吗？我是否将它们放在相同的名称下，如果是，我如何区分提交？提交似乎提交表单名称元素，而不是表单中的元素名称。（使用 HTML 和 JS）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T03:58:51.930

[从用户的角度来看，您的澄清](https://stackoverflow.com/questions/445178/multiple-forms/445208#445208)没有太大意义。也许你想要这样的东西：

```
<form action="/cgi-bin/Lib.exe" method="post" name="checks" id="Form1">
  <input type="checkbox" name="user" value="'$NAME'" id="Checkbox1" />
  <input type="checkbox" name="user" value="'$NAME'" id="Checkbox2" />

  <input type="submit" value="DELETE" id="Submit1" name="Submit1" />
</form>

<form action="/cgi-bin/Lib.exe" method="post" name="checks" id="Form2">
  <input type="checkbox" name="guest" value="'$NAME'" id="Checkbox1" />
  <input type="checkbox" name="guest" value="'$NAME'" id="Checkbox2" />

  <input type="submit" value="DELETE" id="Submit2" name="Submit2" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T00:19:45.380

我会使用按钮元素。试试这个链接： http: [//particletree.com/features/rediscovering-the-button-element/](http://particletree.com/features/rediscovering-the-button-element/)

基本上你用它们作为你的提交。Firefox 正确发送 value 属性，但 IE 发送 innerHTML。但它们都以 name=value/innerHTML 的形式出现。

因此，例如，使用 PHP，您可以使用

```
if (isset($_POST['nameOfButtonElement'])) {

echo 'user clicked this button';

} 
```

编辑： IE6（惊喜）根本不能正确处理这个问题。看到这个问题：[IE 6 and the multiple button elements all sent their name & values](https://stackoverflow.com/questions/567958/ie-6-and-the-multiple-button-elements-all-sending-their-name-values)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T07:49:07.487

也许是这样的（这样你可以控制它）：

```
function ava_aken_hp()
{
// I use blank form with hidden fields to populate it with values from POST.

  document.blank.action="https://www.mypage.com";
  document.blank.elements["CHECK"].value=....;
  ...
  document.blank.submit();
}

// In your form:
<input type="submit" value="Submit1" onclick="ava_aken_hp();"> 
```

# css - 使移动浏览器更容易混合数字和字母输入

> ID：445182
> 
> 赞同：0
> 
> 时间：2009-01-15T00:14:56.530
> 
> 标签：css, blackberry, wap

我正在翻新我们的现场技术人员使用的一个简单的网络应用程序。我的目标之一是让它对黑莓友好，因为所有技术人员现在都在使用它们。此应用程序接受有关工作的基本信息并将其存储。这些信息包括时间、电话号码和街道地址。

我使用以下 CSS 计算出时间字段和电话字段：

```
 input.time  { -wap-input-format: "NN\\:NN"; }
     input.phone { -wap-input-format: "\\(nnn\\)\\ nnn\\-nnnn" } 
```

我要做的是确定如何让电话默认为地址字段上的数字输入，然后在插入空格后使用 alpha。我假设这不能用`-wap-input-format`上面的属性来完成。

`--`即使只有黑莓浏览器`--`可以在不使用 JavaScript 的情况下执行此操作，还有其他方法吗？（并不是说这有什么问题:-)）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T00:42:11.763

您是否考虑过“街道编号”字段后跟单独的“街道名称”字段？如果不使用 JavaScript，就无法在此类 WAP 输入字段的开头设置可变位数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T00:50:40.623

我发现仅 javascript 是完成微妙的用户输入验证工作的唯一方法。标记带来的挑战比它解决的要多。使用 js，您可以根据任何上下文自定义任何按键。

# c# - 在 C# 中为抛出的异常自动生成 XML 文档

> ID：445185
> 
> 赞同：2
> 
> 时间：2009-01-15T00:16:18.210
> 
> 标签：c#, exception

在 C# 中，添加 XML 文档来描述方法可以抛出的任何异常是一种很好的做法。为自己抛出的异常添加这些并不难。但是，如果我正在调用另一种方法，并且我决定不处理第二种方法引发的异常，那么我重新编写现有文档是没有意义的。我需要找到第二种方法的文档并将其复制并粘贴到我的方法的文档中。更糟糕的是框架方法，我发现自己将 MSDN 中的一小段文本复制并粘贴到我的文档中。

是否有任何工具可以自动化此过程？我认为必须有一个 VS 插件，允许您右键单击被调用的方法并选择类似“*将异常文档添加到调用方法文档*”之类的内容。任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:21:26.583

[这听起来像是对ghostdoc](http://www.roland-weigelt.de/ghostdoc/)的功能请求。它不这样做，但它确实有助于在覆盖方法或实现接口时复制文档。

话虽如此，这样一个特性的用处有限，因为 C# 没有像 Java这样的[检查异常。](http://en.wikipedia.org/wiki/Exception_handling#Checked_exceptions)

# java - 签入或不签入整个 Eclipse 项目？

> ID：445187
> 
> 赞同：40
> 
> 时间：2009-01-15T00:17:08.460
> 
> 标签：java, eclipse, version-control, netbeans

我很快将检查一个新 Java 项目的第一次提交。我使用 Eclipse Ganymede 和一堆插件使事情变得更容易一些。

以前我参与过整个Eclipse项目签入的项目。签出后获取项目设置非常方便。然而，这种方法仍然不是没有问题：

*   我强烈怀疑某些 Eclipse 配置文件会在没有用户交互的情况下发生更改（从我使用 Eclipse Europa 时开始），当需要进行提交时，它们会显示为已更改（因为它们已更改，但不是交互的）。
*   每个开发机器都有独特的设置，以及项目中所有开发人员的全局设置。把这些分开很难。
*   有时，如果 Eclipse 版本与其他版本不同，Eclipse 会生气并弄乱项目配置。另一种情况是它更改格式以便更新，如果提交会破坏其他人的配置。

对于这个特定项目，我还有另一个理由不提交项目文件：

*   可能会有更喜欢 NetBeans 的开发人员，他们稍后会加入该项目。然而，他们不会在未来几个月内加入。

你如何组织这个？你在版本控制中检查了什么，你在外面保留了什么？在这种情况下，您认为最佳做法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-15T00:49:54.290

至少您应该签入`.project`和`.classpath`文件。如果您团队中的任何人在其中硬编码外部 JAR 位置，`.classpath`您应该将他们靠在墙上并射击他们。我使用 Maven 来管理我的依赖项，但如果您不使用 maven，您应该使用一致的命名约定为您的外部 JAR 创建用户库。

之后，您需要逐个插件地考虑事情。例如，我使用 Spring，所以我总是签入`.springBeans`，同样对于 CheckStyle，我总是签入`.checkstyle`项目。

当涉及到文件夹中的配置时，它会变得有点棘手，`.settings`但如果我更改项目的默认设置并希望它们与团队的其他成员共享，我通常会签入以下内容：

*   **.settings/org.eclipse.jdt.ui.prefs** - 它包含导入排序的设置
*   **.settings/org.eclipse.jdt.core.prefs** - 它包含编译器版本的设置

一般来说，我没有注意到 Ganymede 在我修改项目首选项的情况下修改文件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-15T12:10:49.220

我建议使用[maven](http://maven.apache.org)，这样整个生命周期就在任何 IDE 之外。您可以在命令行上轻松地使用它创建一个 eclipse 项目，如果它不是 eclipse，您可以使用任何您想要的东西。它有它的怪癖，但在依赖关系和构建管理方面消除了很多苦涩。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-15T23:11:07.920

在我们的世界中，我们签入整个 Eclipse 项目和整个并行但独立的 Netbeans 项目。我们这样做的动机完全集中在“当我进行结帐时，我希望之后**立即**进行功能配置”。这意味着我们必须做一些工作：

1.  为每个主要 IDE 创建可运行的配置（人们喜欢他们喜欢的东西）。这包括主类、工作目录、VM 参数等。
2.  为我们所有的相关场景创建有用的启动脚本。
3.  创建不会导致结帐时间过长的编辑数据集（这是一个大项目）。

*当我们的新员工能够检查从 Subversion 到 Eclipse 的项目并立即*运行具有（小）真实数据集的功能系统时，这种理念值得现金（或至少更有价值的劳动时间）或打扰他。

**跟进**：这种“让新人的生活更轻松”的理念在他更换 IDE 后再次得到了回报（他在使用 Eclipse 很长时间后决定尝试 Netbeans，并决定坚持一段时间）。根本不需要任何配置，他只是在 Eclipse 指向的同一目录中打开了 Netbeans 项目。经过的切换时间：大约 60 秒。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T00:23:51.207

我只检查过人类完成的事情，其他任何生成的东西（无论是否自动）都应该很容易再次生成并且容易改变（如你所说）。唯一的例外是生成的文件很难（需要大量人工干预；））才能正确处理。像这样的事情真的应该以某种方式自动化。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-05T16:48:44.253

尝试将您的项目移植到像 maven 这样的构建系统。它拥有在您使用的每台机器上获得相同项目体验所需的一切。

一切都有插件。就像 eclipse 插件一样。您只需键入“mvn eclipse:eclipse”，插件就会生成整个准备就绪的 eclipse 项目。

回答你的问题。在开发周期中的任何时候都不要签入项目未使用的文件。这意味着像 eclipse 属性等元数据文件永远不应该在 SCM 中签入。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-15T00:36:49.340

我喜欢签入 .project、.classpath 和类似文件，前提**是**它们在任何 Eclipse 用户的机器上都是相同的。（无论如何，使用其他 IDE 的人应该能够签出和构建您的项目，但这个问题与是否签入 Eclipse-only 文件是正交的。）

如果从事该项目的不同用户想要更改或调整他们的 .project 或 .classpath 或其他文件，我建议您**不要将**它们签入源代码控制。从长远来看，它只会引起头痛。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T00:21:17.623

我使用具有 XML 项目文件的 IntelliJ。我不检查这些，因为它们经常更改并且在需要时很容易重新创建。

我不签入 JAR 文件。我将它们保存在一个单独的存储库中，即 Maven 2。

我不检查 WAR 或 JAR 或 javadocs 或任何其他可以生成的东西。

我确实检查了 SQL 和脚本以及 Java 源代码和 XML 配置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T00:33:47.240

由于您提到的缺点，我建议版本控制系统忽略实际的项目文件。

如果项目设置中有足够一致的信息可以从可访问中受益，请将其复制到 Eclipse 不视为特殊的位置，并且您可以在结帐时使用它（然后复制回来到 Eclipse 会注意的地方）。将实际项目文件与受控制的文件分开很有可能会导致同步丢失，所以我只建议在设置可用时有明显的好处（或者你确信你会能够使它们保持同步）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T15:39:41.607

在我们的案例中，我们过去常常签入项目文件（.project 和 .classpath），以使所有开发人员都可以轻松创建他们的项目工作区。公共首选项文件和团队项目集也位于源代码控制中，因此创建工作区就像导入首选项和导入团队项目集一样简单。这工作得很好，但确实依赖于每个人都有一个一致的环境，任何自定义都必须在创建基本工作区之后应用。

大多数情况下，我们仍然这样做，但现在使用 Maven，因此依赖管理当然是通过 Maven 来处理的。为避免信息冲突，.project 和 .classpath 已从源代码管理中删除，现在在我们导入团队项目集之前通过 maven 目标生成。这很容易支持不同的环境，因为您只需要脚本来根据 Maven 配置生成 IDE 特定部分。

PS-不过，为了便于维护，我更喜欢让每个人都使用相同的环境。其他任何事情都不可避免地成为某人的全职维护工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-19T15:01:58.237

Netbeans 6.5 有一个改进的 Eclipse 项目导入，它应该将来自 Netbeans 的更改同步回 Eclipse：[http ://wiki.netbeans.org/NewAndNoteWorthyNB65#section-NewAndNoteWorthyNB65-EclipseProjectImportAndSynchronization](http://wiki.netbeans.org/NewAndNoteWorthyNB65#section-NewAndNoteWorthyNB65-EclipseProjectImportAndSynchronization)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T00:22:53.487

不。仅签入项目的源代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T10:45:06.867

作为回应：

“每台开发机器都有独特的设置，以及项目中所有开发人员的全局设置。将这些分开很难。”

Eclipse 提供了多种方法来保持本地设置的可管理性：Java 类路径变量（Java > 构建路径 > 类路径变量）是一种，“链接资源”（常规 > 工作区 > 链接资源）是另一种[http://help.eclipse.org /stable/index.jsp?topic=/org.eclipse.platform.doc.user/concepts/concepts-13.htm](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.user/concepts/concepts-13.htm)在我看来，创建一个说明在构建/运行项目之前要设置哪些设置的自述文件效果很好。

现在如何确保您的持续构建系统理解对 eclipse 设置所做的更改，这是另一个问题......（我有一个单独的 build.xml 用于 ant，我手动保持最新）

# naming-conventions - 我们应该将度量单位放在属性名称中吗？

> ID：445191
> 
> 赞同：31
> 
> 时间：2009-01-15T00:20:24.583
> 
> 标签：naming-conventions

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-15T00:25:44.150

如果您对事物有一致的 UOM，那么您的 DBA 的策略是可以的。

例如，如果时间跨度总是以分钟为单位，等等。

如果 UOM 可以更改，那么您应该将其存储在数量旁边的另一列中。

也就是说，我倾向于在这方面支持你。**清晰度胜过大多数事情，包括这一点。**我宁愿看到也不得不猜测 UOM 是什么`DurationMinutes`。`Duration`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-15T14:35:13.220

是的。你应该。

正如@[Charles Bretana] 指出的那样，关键是易读性，并且您的桌子的其他用户或跟随您的开发人员知道您在使用什么。

我绝对会在字段名称中涉及单位/度量 - 在我的业务中，您无法猜测您会从上下文或名称中找到什么：一个名为 MarketValue 的字段 - 是以百万、数千还是单位为单位？美元、欧元、英镑、$CURRENCY？该值是百分比还是比率？绝对的还是相对的？每日、每月、日历年、财政年度？那个时间戳，是哪个时区？

提供数据时，您的第一个、最后一个也是唯一的任务是确保它不会因为消费者无法找到足够的信息而被错误地使用。作为开发人员，将“Metre”、“USD”、“GMT”、“PerCent”或其他任何内容放入字段名称中一点都不难闻。

在字段命名的微小气味需要标准化之前，有大量的气味需要解决。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T00:40:39.567

这就是为什么[火星气候轨道器](https://en.wikipedia.org/wiki/Mars_Climate_Orbiter)以 350 米/秒的速度坠毁在表面，而它原本计划只能处理 350 英尺/秒（或类似的速度）。

虽然“从不说‘从不’或‘总是’”一般来说是一个很好的经验法则，但在这里我会改变我的规则，说我认为你应该“总是”明确数值的单位。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T00:54:33.377

以以下格式命名我的所有列的约定：

```
{name}_in_{unit} 
```

帮助了一个项目，因为我使用的是[si 单位](http://physics.nist.gov/cuu/Units/)，它实际上最终让我能够推断列数据类型并通常简化我的写作风格。

```
length_in_m
speed_in_ms-1
color_in_nm 
```

我使用 _at_time 或 number_of_ 处理了一些异常：

started_at_time updated_at_time number_of_rotations

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T00:27:16.440

我认为这在任何地方都是一个好主意，因为总是有模棱两可的余地。

例如，我们使用的高性能计时器类，我一直需要检查 GetElapsed() 方法是否返回秒或毫秒或其他值。如果它被称为 GetElapsedMilliseconds() 可以避免混乱。

唯一的缺点是如果你想改变主意……但在这种情况下，任何客户都需要知道改变。

F# 对此有一个有趣的转折，允许在类型系统中指定测量单位。请参阅此[博客文章，以及另一个讨论](http://blogs.msdn.com/andrewkennedy/archive/2008/08/20/units-of-measure-in-f-part-one-introducing-units.aspx)[测量单位是否为 F# 独有的](https://stackoverflow.com/questions/107243/are-units-of-measurement-unique-to-f)stackoverflow 问题？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T00:27:22.353

> 如果测量单位不是很明显，我认为你应该更进一步，在名称中包含测量单位。例如，Length_mm 应该有助于提醒开发人员，如果用户刚刚以英寸为单位输入长度，他们最好将长度转换为 mm。

您甚至可以更进一步（在您的代码中，而不是在数据库中）并拥有一个 Length 类型，它负责测量单位和可能的转换。这是 Martin Fowler 的“分析模式”一书中“数量”模式的方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T01:07:33.740

我做过很多数据库工作，我根本不会对此皱眉，我也没有听说过对此皱眉。

它比扩展属性更好，这对于临时开发人员来说并不明显。它比单独的文档要好，因为许多开发人员不会阅读它们，而且肯定不会很详细。如果设置了单位，那么在名称中包含它听起来是个好主意。如果情况发生变化，则在添加单位字段时，更改测量字段的名称。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T00:39:24.593

不要将度量单位（或列类型）放在数据库列名中。

许多数据库能够以某种方式记录/注释列（在 SQL Server 中它是 sp_addextendedproperty），我建议这是一个更合适的地方。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-24T16:48:21.447

对于 Python 日期时间，请考虑使用[`datetime`](https://docs.python.org/library/datetime.html#module-datetime)包中的对象。这样做会将单位隐含地捕获到微秒分辨率。那么在变量名中包含单位就没有依据了。

如果您必须使用`int`or`float`代替，强烈建议在变量名称后面加上单位名称缩写。例如，代替变量 name `diff`，使用`diff_secs`秒、`diff_ms`毫秒、`diff_µs`微秒或`diff_ns`纳秒。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T00:30:04.783

我们不会将度量单位放在数据库的列名中。但是，我们确实有一个数据字典文档，其中描述了所有列和关系。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T01:00:51.117

如果可能的话，理想的方法是使用一种对测量没有歧义的类型。例如在 .NET 中，而不是说`int periodInSeconds`你最好使用`TimeSpan period`.

F# 语言实际上将度量单位作为类型系统的一部分，因此您可以以单位声明类型，`10<m/s>`甚至`5<s>`可以对它们执行计算，这样`10<m/s> * 5<s>`会导致`50<m>`. [请参阅此处了解更多信息](http://blogs.msdn.com/andrewkennedy/archive/2008/08/20/units-of-measure-in-f-part-one-introducing-units.aspx)。

所以我会说，如果可能的话，使用一种能表达你意图的类型，但如果那不可能，那么你应该将测量值编码到名称中。它比评论更好，更明显。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T02:00:19.123

你肯定想要*某处*的测量单位。我不知道列名是一个好地方还是架构更好。询问您的数据库管理员

*   有关计量单位的信息存储在哪里？
*   如何以编程方式访问这些单元？

如果答案是“不是”或“你不能”，请痛心抱怨——他们无权否认你的命名约定。否则，如果您在系统内工作，一切可能会更快乐。

PS 我真的很喜欢他们在 F# 中加入的对度量单位的支持。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-01-15T01:04:41.017

我不得不说，我讨厌“描述性”变量名变成“非常冗长”的变量名。

我首选的替代方法是在短函数中只使用度量单位名称。例如。

```
function velocity(m, s) {
   return m/s;
} 
```

您不需要说“length_m”，因为在这种情况下，很明显只有长度才能以米为单位进行测量。

话说回来。如果我正在编写一个测量单位错误非常危险的系统，我可能会使用类型系统并定义一个 Length 类，该类总是将自身转换为任何计算的标准单位。甚至可能是英尺、米等不同的子类。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2009-01-15T00:28:40.603

不，属性的名称与其测量单位是分开的。

如果您调用一个变量 length_mm，那么您将与 mm 绑定。

如果您使用 32 位 int 来存储 length_mm，最终以 mm 为单位的长度可能会大于 62,000，或者 32 位 int 的限制是什么。您无法切换到 m，因为您将长度变量绑定到 length_mm。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2009-01-15T12:40:09.737

我认为将单位放入您的标识符中是一种*巨大*的设计气味。这几乎肯定意味着您选择了错误的语言：如果单元对项目如此重要，那么您最好使用其类型系统能够表示它们的语言。

# apache-flex - 我在哪里可以找到支持复选框的 Flex 树视图控件？

> ID：445200
> 
> 赞同：0
> 
> 时间：2009-01-15T00:24:16.697
> 
> 标签：apache-flex, treeview, checkbox

据我所知，开箱即用的 Flex 3 树视图控件不支持复选框。我在哪里可以找到一个支持任何和所有节点上的复选框的好树视图控件。我更喜欢开源软件，但商业组件并非不可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T08:39:24.030

查看以下 [http://www.sephiroth.it/test/components/flex2/treecheckbox/test.swf](http://www.sephiroth.it/test/components/flex2/treecheckbox/test.swf)

[http://www.sephiroth.it/index.php](http://www.sephiroth.it/index.php)

[http://www.sephiroth.it/weblog/archives/2006/09/flex2_again_checkbox_3state.php](http://www.sephiroth.it/weblog/archives/2006/09/flex2_again_checkbox_3state.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T08:29:10.760

[http://www.adobe.com/cfusion/exchange/index.cfm?event=extensionDetail&extid=1047969#](http://www.adobe.com/cfusion/exchange/index.cfm?event=extensionDetail&extid=1047969#)

享受

# hash - 关于散列及其用于数据压缩的说明

> ID：445202
> 
> 赞同：2
> 
> 时间：2009-01-15T00:25:36.273
> 
> 标签：hash, data-compression

我正面临一个使用散列的应用程序，但我仍然无法弄清楚它是如何工作的。这是我的问题，散列用于生成一些索引，并使用这些索引访问不同的表，并且在我添加使用索引获得的每个表的值之后，我得到了我的最终值。这样做是为了减少内存需求。散列函数的输入是在随机常数和应用程序的一些参数之间进行异或运算。

这是一个典型的哈希应用程序吗？我不明白的是如何使用散列来减少内存需求？任何人都可以澄清这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T00:31:56.853

单独的散列与内存没有任何关系。

它通常用于哈希表。哈希表通过计算您要键入的内容的*哈希值*来工作，然后将其用作数据结构的索引。

散列允许您将键（字符串等）减少为更紧凑的值，如整数或位集。

这可能是您所指的内存节省 - 将大键减少为简单整数。

但请注意，哈希不是唯一的！一个好的散列算法可以最大限度地减少冲突，但它们并不打算减少到一个唯一值——这样做是不可能的（例如，如果你的散列输出一个 32 位整数，你的散列将只有 2^32 个唯一值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T00:31:02.940

你说的是[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)吗？这使用哈希函数来获得一种空间有效的方法来测试集合的成员资格。如果是这样，请查看链接以获取说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T00:45:51.223

大多数好的散列实现都是内存效率低下的，否则会涉及更多的计算——而这正是散列的重点。

哈希实现用于提高处理效率，因为它们将为您提供插入、删除和检索等操作的恒定运行时间。

您可以考虑散列的质量，即所有数据，无论是什么类型或大小，始终以一个固定长度的形式表示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T00:51:48.700

如果进行散列不是为了构建真正的散列表，而只是在字符串/内存块表中创建索引，则可以解释这一点。如果您的数据中有 20 次相同的字符串（或内存序列），然后仅用其哈希/表索引替换该字符串的所有 20 个实例，则可以通过这种方式实现数据压缩。但是，如果该表中包含每个哈希值的实际冲突链，那么我刚才描述的不是正在发生的事情；在这种情况下，散列的原因很可能是为了加快执行速度（通过提供对存储值的快速访问），而不是压缩。

# visual-studio-2008 - VS2008 团队版代码度量 - 跳过生成的代码？

> ID：445212
> 
> 赞同：1
> 
> 时间：2009-01-15T00:31:06.013
> 
> 标签：visual-studio-2008, metrics

根据[这个](http://www.vitalygorn.com/blog/post/2007/11/Code-Metrics-in-Visual-Studio-2008.aspx)博客，VS2008 Team Edition 中的内置代码度量功能应该足够聪明，可以跳过生成的代码。它不是。我需要在某个地方设置一个选项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-04T09:23:55.493

有几个标签会影响这一点，具体取决于来源（MSDN/blogs/...）

*   `CompilerGenerated`
*   `ToolGenerated`
*   `GeneratedCode`
*   `DebuggerNonUserCode`

我不确定其中哪一个最适合您的情况，但是 iirc 我能够使用其中一个来使指标正常工作。让我知道你的情况如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-07T21:24:20.033

这个问题的真正答案是我放弃了。:-) 在稍微弄乱了它之后，我得到了一个明显的印象，即代码度量功能主要是 Team System 的营销噱头，没有人真正投资于使其运行良好。我希望 2010 年的变化——虽然指标可能被滥用，但它们也能提供有价值的见解。

# asp.net - 切换到 ASP.NET 3.5，DropDownList 不记得动态添加的项目

> ID：445222
> 
> 赞同：2
> 
> 时间：2009-01-15T00:37:01.493
> 
> 标签：asp.net, drop-down-menu, asp.net-3.5, viewstate

我有一个站点，它使用了几个数据绑定的 DropDownLists。我也在做传统的 if (!IsPostBack) {list.Databind();} 并依靠 viewstate 在回发期间保持列表的填充。我最近将该站点转换为 ASP.NET 3.5，并注意到在回发期间列表为空（好像 ViewState 已禁用）。我没有明确禁用任何东西，我想知道是否有人在他们的视图状态相关控件中看到了类似的变化或行为。

谢谢！

詹姆士

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T04:08:51.533

我肯定看到过类似的问题（尽管我的问题很明显）。尝试确保 ViewState 在整个控件层次结构中显式启用，直至下拉列表。

例如

```
‹asp:Page EnableViewState="True" ...›
     ...

     ‹asp:Panel EnableViewState="True"...›
         ...
         ‹asp:DropDownList EnableViewState="True" ...›
         ...
      ...
... 
```

R。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:53:23.203

粘贴到麻烦页面的这段代码是查看视图状态启用/禁用位置的快速方法。

```
<%
Control c = <YourMisbehavingControlNameHere>;

while ( c != null )
{
    Response.Write( c.GetType().Name + " = " + c.EnableViewState.ToString() + "<br/>" );

    c = c.Parent;
}

%> 
```

# .net - 我可以在不需要管理员权限的情况下将 .NET 框架放在机器上吗？

> ID：445224
> 
> 赞同：1
> 
> 时间：2009-01-15T00:37:04.440
> 
> 标签：.net, installation, privileges

我正在构建的应用程序需要 .NET 框架。不幸的是，我们的最终用户将没有管理员权限。我知道没有管理员权限就无法安装 .NET，但是是否可以将它的预打包版本构建到我们的系统中，这样用户就不需要管理员权限？如果有可能，我将如何去做？我听说过的一种方法是将必要的 .dll 文件放在与可执行文件相同的文件夹中，但这似乎不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T00:40:03.623

您可以使用 Xenocode 的 PostBuild 之类的工具：

[http://www.xenocode.com/Products/Postbuild-for-NET/](http://www.xenocode.com/Products/Postbuild-for-NET/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T00:48:15.137

在分发应用程序之前，要么使用 Xenocode（BobbyShaftoes 的答案），要么在目标机器上安装 .NET。如果您在 Active Directory 上，则可以通过组策略轻松完成。

*   .NET 1.1： http: [//support.microsoft.com/kb/323886](http://support.microsoft.com/kb/323886)
*   .NET 3.5：http: [//msdn.microsoft.com/en-us/library/cc160717.aspx](http://msdn.microsoft.com/en-us/library/cc160717.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T00:47:37.943

不，但假设安装您的应用程序的个人必须具有管理员权限才能在计算机上安装新应用程序，您可以让应用程序的 msi 安装程序也为您安装框架......

但是，如果您希望由没有管理员权限的人安装您的应用程序，那么我相信您不走运。

# emacs - Emacs 命令删除最多非空白字符

> ID：445225
> 
> 赞同：45
> 
> 时间：2009-01-15T00:37:15.080
> 
> 标签：emacs, whitespace

我经常想进行多行函数调用并将其减少到一行。例如，转换...

```
function_call(
     'first_arg',
     'second') 
```

到

```
function_call('first_arg', 'second') 
```

emacs 是否有一些命令可以帮助解决这个问题。具体来说，是否有一个命令会删除从该点到第一个非空白字符的所有空白？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-15T01:46:22.677

你可以试试`delete-indentation`，我最喜欢的将多行合并为一行的命令。在您的示例中，将光标放在“第二”行并点击`M-^`两次。以下是文档：

> `M-^`运行命令`delete-indentation`，这是一个交互式编译的 Lisp 函数`simple.el`。
> 
> 它是必然的`M-^`。
> 
> `(delete-indentation &optional arg)`
> 
> 将此行加入上一行并在加入时修复空白。如果有填充前缀，则从该行的开头将其删除。使用参数，将此行加入下一行。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-15T00:47:35.807

看一下`fixup-whitespace`功能。它带有 Emacs，在`simple.el`. 它的文档是：

> 修复点周围对象之间的空白。根据上下文，留一个空格或不留一个空格。

一个类似的函数，`just-one-space`，

> 删除点周围的所有空格和制表符，留下一个空格

通常绑定到`M-SPC`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-15T05:19:28.303

> 具体来说，是否有一个命令会删除从该点到第一个非空白字符的所有空白？

有一个命令几乎可以做到这一点：

> M-\ 运行命令 delete-horizo​​ntal-space，它是 `simple.el' 中的交互式编译 Lisp 函数。
> 
> 它绑定到 M-\。
> 
> (delete-horizo​​ntal-space & optional back-only)
> 
> 删除点周围的所有空格和制表符。如果向后仅是非零，则仅在点之前删除它们。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T03:13:25.373

您始终可以使用 Mz 删除最多一个字符。

例如，在您的情况下：

Mz ' 删除单引号（不幸的是，这也会删除单引号，但这是一个小不便）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-15T15:25:15.147

我使用以下宏将下一行“拉”到当前行的末尾，压缩空格。

```
(defun pull-next-line() 
  (interactive) 
  (move-end-of-line 1) 
  (kill-line)
  (just-one-space)) 
```

这与@jrockway 的`move-line-up`和 of完全相反`delete-indentation`，我觉得它更自然。宏中的`just-one-space`命令正是@Mike's `M-SPACE`。

我`pull-next-line`在`M-J`我`J`的`.emacs`.

```
(global-set-key (kbd "M-J") 'pull-next-line) 
```

**例子。**调用`pull-next-line`第一行

```
function_call(
     'first_arg',
     'second') 
```

产量

```
function_call( 'first_arg',
     'second') 
```

第二次调用它会产生

```
function_call( 'first_arg', 'second') 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-15T00:46:42.597

Alt-space 会将一串空白字符减少为单个空格字符，但不会删除换行符。不过，这应该会有所帮助。

要删除从点到第一个非空白字符（或换行符）的所有内容，请键入非空白字符、Alt-空格、退格（删除最终的空白字符），然后输入退格（删除您添加的字符。

要将多行函数声明转换为单行声明，请结合使用 Alt-space、backspace 和 Alt-E (goto-endofline) 命令。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-09-14T04:01:46.383

这样做的一个相当激烈的方式是[饥饿删除](http://www.emacswiki.org/emacs/hungry-delete)模式：

> Hungry-Delete 是一种次要模式，它会导致删除以删除您要删除的方向上的所有空白。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-28T18:13:19.373

稍微不同的方法是创建一个键盘宏来为您完成这项工作。因此，为了创建宏观阶段，一般情况如下：

```
foo

               bar 
```

[一行带有“foo”，然后是几行，并带有一些空格，写成“bar”]

然后站在 foo 和 bar 之间的任何位置，执行以下操作：

```
Cx ( ; 开始录制宏
兆；向后移动到 foo 的开头
结尾 ; 移动到 foo 的末尾
C-空间；地标
CMf ; 移动到小节的末尾
家 ; 移动到行首
连续波；拉出所有的空白
M-空间；只留一个空格
CX ) ; 结束录制宏
Mx name-last-kbd-macro ; 给它起个名字，叫它 jline 什么的

```

现在，您始终可以使用 Mx 单行删除两个单词之间的所有空格

确保您记得通过在 .emacs 文件中的某处发出 Mx insert-kbd-macro 来保存键盘宏 - 这就是它的外观：

```
(fset 'jline
   [?\M-b end ?\C-  ?\C-\M-f home ?\C-w escape ? ]) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T03:30:42.297

我这样做：

```
(defun move-line-up ()
  "Removes leading spaces from the current line, and then moves
the current line to the end of the previous line."
  (interactive)
  (let (start end)
    (save-excursion
      (beginning-of-line)
      ; get first non-space character, only look on this line
      (let ((search-end (save-excursion (end-of-line) (point))))
        (re-search-forward "[^[:space:]]" search-end))
      (setq end (1- (point)))
      (previous-line)
      (end-of-line)
      (setq start (point))
      (delete-region start end))
    (goto-char start)))

(defun move-next-line-up ()
  "Moves the next line to the end of the current line"
  (interactive)
  (next-line)
  (move-line-up)) 
```

并将这些绑定为：

```
(global-set-key (kbd "C-x ,") 'move-line-up)
(global-set-key (kbd "C-x .") 'move-next-line-up) 
```

因此，要解决您的问题，在“第二个）”的行上，只需运行`C-x , C-x ,`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-15T05:24:53.423

如果您希望所有删除都以这种方式进行，您可以查看 greedy-delete。

# php - 在 PHP 中按权重生成随机结果？

> ID：445235
> 
> 赞同：72
> 
> 时间：2009-01-15T00:44:38.433
> 
> 标签：php, random

我知道如何在 PHP 中生成一个随机数，但可以说我想要一个 1-10 之间的随机数，但我想要更多的 3、4、5，然后是 8、9、10。这怎么可能？我会发布我尝试过的内容，但老实说，我什至不知道从哪里开始。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-08-08T20:48:03.397

基于@Alllain 的[回答](https://stackoverflow.com/a/445265/362536)/[链接](http://www.perlmonks.org/?node_id=242751)，我在 PHP 中编写了这个快速函数。如果要使用非整数加权，则必须对其进行修改。

```
 /**
   * getRandomWeightedElement()
   * Utility function for getting random values with weighting.
   * Pass in an associative array, such as array('A'=>5, 'B'=>45, 'C'=>50)
   * An array like this means that "A" has a 5% chance of being selected, "B" 45%, and "C" 50%.
   * The return value is the array key, A, B, or C in this case.  Note that the values assigned
   * do not have to be percentages.  The values are simply relative to each other.  If one value
   * weight was 2, and the other weight of 1, the value with the weight of 2 has about a 66%
   * chance of being selected.  Also note that weights should be integers.
   * 
   * @param array $weightedValues
   */
  function getRandomWeightedElement(array $weightedValues) {
    $rand = mt_rand(1, (int) array_sum($weightedValues));

    foreach ($weightedValues as $key => $value) {
      $rand -= $value;
      if ($rand <= 0) {
        return $key;
      }
    }
  } 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-15T01:45:37.313

对于一个始终向标尺一端倾斜的有效随机数：

*   选择 0..1 之间的连续随机数
*   提高到幂 γ，以偏置它。1 是未加权的，较低的给出更多的较高的数字，反之亦然
*   缩放到所需范围并舍入为整数

例如。在 PHP 中（未经测试）：

```
function weightedrand($min, $max, $gamma) {
    $offset= $max-$min+1;
    return floor($min+pow(lcg_value(), $gamma)*$offset);
}
echo(weightedrand(1, 10, 1.5)); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-01-15T00:52:29.183

有一个[很好的教程给你](http://www.perlmonks.org/?node_id=242751)。

基本上：

1.  将所有数字的权重相加。
2.  选择一个小于那个的随机数
3.  按顺序减去权重，直到结果为负，如果是，则返回该数字。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-05-19T19:24:09.937

[本教程](http://w-shadow.com/blog/2008/12/10/fast-weighted-random-choice-in-php/)通过多种剪切和粘贴解决方案在 PHP 中引导您完成。请注意，由于下面的评论，此例程与您在该页面上找到的内容略有修改。

从帖子中获取的功能：

```
/**
 * weighted_random_simple()
 * Pick a random item based on weights.
 *
 * @param array $values Array of elements to choose from 
 * @param array $weights An array of weights. Weight must be a positive number.
 * @return mixed Selected element.
 */

function weighted_random_simple($values, $weights){ 
    $count = count($values); 
    $i = 0; 
    $n = 0; 
    $num = mt_rand(1, array_sum($weights)); 
    while($i < $count){
        $n += $weights[$i]; 
        if($n >= $num){
            break; 
        }
        $i++; 
    } 
    return $values[$i]; 
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-06-24T07:26:11.187

```
/**
 * @param array $weightedValues
 * @return string
 */
function getRandomWeightedElement(array $weightedValues)
{
    $array = array();

    foreach ($weightedValues as $key => $weight) {
        $array = array_merge(array_fill(0, $weight, $key), $array);
    }

    return $array[array_rand($array)];
} 
```

`getRandomWeightedElement(array('A'=>10, 'B'=>90));`

这是非常简单的方法。如何获得随机加权元素。我填充数组变量 $key。我得到 $key 到数组 $weight x。之后，使用 array_rand 进行数组。而且我有随机值;)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-01T02:48:14.497

平淡而公正。只需复制/粘贴并测试它。

```
/**
 * Return weighted probability
 * @param (array) prob=>item 
 * @return key
 */
function weightedRand($stream) {
    $pos = mt_rand(1,array_sum(array_keys($stream)));           
    $em = 0;
    foreach ($stream as $k => $v) {
        $em += $k;
        if ($em >= $pos)
            return $v;
    }

}

$item['30'] = 'I have more chances than everybody :]';
$item['10'] = 'I have good chances';
$item['1'] = 'I\'m difficult to appear...';

for ($i = 1; $i <= 10; $i++) {
    echo weightedRand($item).'<br />';
} 
```

编辑：在末尾添加了缺少的括号。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-12-25T16:36:16.080

您可以使用非标准[PHP 库中的](https://github.com/ihor/Nspl)[weightedChoice](https://github.com/ihor/Nspl#weightedchoiceweightpairs)。它接受对（项目，重量）的列表，以便有可能处理不能是数组键的项目。您可以使用[对](https://github.com/ihor/Nspl#pairssequence-valuekey--false)函数转换为所需的格式。`array(item => weight)`

```
use function \nspl\a\pairs;
use function \nspl\rnd\weightedChoice;

$weights = pairs(array(
    1 => 10,
    2 => 15,
    3 => 15,
    4 => 15,
    5 => 15,
    6 => 10,
    7 => 5,
    8 => 5,
    9 => 5,
    10 => 5
));

$number = weightedChoice($weights); 
```

在此示例中，2-5 的出现频率是 7-10 的 3 倍。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-20T21:19:33.673

由于我使用了 IainMH 的解决方案，我不妨分享一下我的 PHP 代码：

```
<pre><?php

// Set total number of iterations
$total = 1716;

// Set array of random number
$arr = array(1, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 5);
$arr2 = array(0, 0, 1, 1, 2, 2, 2, 3, 3, 4, 5);

// Print out random numbers
for ($i=0; $i<$total; $i++){

    // Pick random array index
    $rand = array_rand($arr);
    $rand2 = array_rand($arr2);

    // Print array values
    print $arr[$rand] . "\t" . $arr2[$rand2] . "\r\n";

}

?></pre> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-17T07:19:08.963

此页面上的许多答案似乎使用了数组膨胀、过度迭代、库或难以阅读的过程。当然，每个人都认为自己的宝宝是最可爱的，但老实说，我认为我的方法是精简、简单且易于阅读/修改......

根据 OP，我将创建一个从 1 到 10 的值数组（声明为键），其中 3、4 和 5 的权重是其他值（声明为值）的两倍。

```
$values_and_weights=array(
    1=>1,
    2=>1,
    3=>2,
    4=>2,
    5=>2,
    6=>1,
    7=>1,
    8=>1,
    9=>1,
    10=>1
); 
```

如果您只打算进行一次随机选择和/或您的数组相对较小*（确保自己进行基准测试），这可能是您最好的选择：

```
$pick=mt_rand(1,array_sum($values_and_weights));
$x=0;
foreach($values_and_weights as $val=>$wgt){
    if(($x+=$wgt)>=$pick){
        echo "$val";
        break;
    }
} 
```

这种方法不涉及数组修改，并且可能不需要迭代整个数组（但可能）。

* * *

另一方面，如果您要在阵列上进行多个随机选择和/或您的阵列足够大*（确保自己进行基准测试），重组阵列可能会更好。

生成新数组的内存成本将越来越合理：

1.  数组大小增加和
2.  随机选择的数量增加。

新数组需要通过将前一个元素的权重添加到当前元素的权重来将每个值的“权重”替换为“限制”。

然后翻转数组，使限制是数组键，值是数组值。逻辑是：所选值将具有 >= $pick 的最低限制。

```
// Declare new array using array_walk one-liner:
array_walk($values_and_weights,function($v,$k)use(&$limits_and_values,&$x){$limits_and_values[$x+=$v]=$k;});

//Alternative declaration method - 4-liner, foreach() loop:
/*$x=0;
foreach($values_and_weights as $val=>$wgt){
    $limits_and_values[$x+=$wgt]=$val;
}*/
var_export($limits_and_values); 
```

创建此数组：

```
array (
  1 => 1,
  2 => 2,
  4 => 3,
  6 => 4,
  8 => 5,
  9 => 6,
  10 => 7,
  11 => 8,
  12 => 9,
  13 => 10,
) 
```

现在生成随机数`$pick`并选择值：

```
// $x (from walk/loop) is the same as writing: end($limits_and_values); $x=key($limits_and_values);
$pick=mt_rand(1,$x);  // pull random integer between 1 and highest limit/key
while(!isset($limits_and_values[$pick])){++$pick;}  // smallest possible loop to find key
echo $limits_and_values[$pick];  // this is your random (weighted) value 
```

这种方法非常出色，因为`isset()`速度非常快，并且`isset()`while 循环中的最大调用次数只能与数组中的最大权重（不要与限制混淆）一样多。对于这种情况，最大迭代次数 = 2！

**这种方法永远不需要迭代整个数组**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-04-01T12:46:20.450

我刚刚发布了一个类来轻松[执行加权排序。](https://github.com/brick/brick/blob/master/src/Random/RandomPicker.php)

它基于[Brad](https://stackoverflow.com/a/11872928/759866)和[Alllain 的](https://stackoverflow.com/a/445265/759866)答案中提到的相同算法，并针对速度进行了优化，针对均匀分布进行了单元测试，并支持任何 PHP 类型的元素。

使用它很简单。实例化它：

```
$picker = new Brick\Random\RandomPicker(); 
```

然后将元素添加为加权值数组（仅当您的元素是字符串或整数时）：

```
$picker->addElements([
    'foo' => 25,
    'bar' => 50,
    'baz' => 100
]); 
```

或者使用单独的调用来`addElement()`. 此方法支持任何类型的 PHP 值作为元素（字符串、数字、对象...），而不是数组方法：

```
$picker->addElement($object1, $weight1);
$picker->addElement($object2, $weight2); 
```

然后得到一个随机元素：

```
$element = $picker->getRandomElement(); 
```

获得其中一个元素的概率取决于其相关的权重。唯一的限制是权重必须是整数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-08-24T07:10:25.733

我用这个：

```
mt_rand($min, mt_rand($min, $max)); 
```

它给出了更多的低值和更少的高值，因为值越高，mt_rand 之一就越多

概率在较低的值中线性增加，形成一个方形对角线（见下面的数学）

*PRO* : 简单明了

*CON*：可能太简单了，所以对于某些用例来说不够可加权或可平衡

**数学：**

让 i 从 min 到 max 的第 i 个值的索引，

设 P(i) 获得第 i 个值的概率，

让 N=max-min：

```
P(i)=(1+N-i)/sum(1,N) 
```

由于 N 对所有项都相等：

```
P(i) is proportional to N-i 
```

所以，事实上，概率在较低的值中线性增加，形成一个正方形对角线

**变体：**

您可以编写变体：

```
mt_rand($min, mt_rand(1, mt_rand(1, $max))); //value more given in low part

mt_rand(mt_rand($min, $max), $max); //mirrored, more upper values than lower

... 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-08T11:10:39.747

我使用了 Brad 的 answar 并对其进行了一些更改以适应我的情况并增加了灵活性

我有一个数组值的数组

```
$products = [
 ['id'=>1,'name'=> 'product1' , 'chance'=>2] ,
 ['id'=>2,'name'=> 'product2' , 'chance'=>7]
] 
```

首先我洗牌产品数组

```
shuffle($products ); 
```

然后你可以将它传递给函数

```
function getRandomWeightedElement(array $products) {

$chancesSum = 0;
foreach ($products as $product){
    $chancesSum += (int) $product['chance'];
}

$rand = mt_rand(1, $chancesSum);
$range = 0;

foreach ($products as $product) {
    $range += (int) $product['chance'];
    $compare = $rand - $range;
    if ($compare <= 0){
        return (int) $product['id'];
    }
}} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-31T14:04:04.070

函数 getBucketFromWeights($values) { $total = $currentTotal = $bucket = 0;

```
foreach ($values as $amount) {
    $total += $amount;
}

$rand = mt_rand(0, $total-1);

foreach ($values as $amount) {
    $currentTotal += $amount;

    if ($rand => $currentTotal) {
        $bucket++;
    }
    else {
        break;
    }
}

return $bucket; 
```

}

我从这里的答案修改了这个[用用户定义的权重选择随机元素](https://stackoverflow.com/questions/4726281/picking-random-element-by-user-defined-weights?noredirect=1&lq=1)

在我写完这篇文章后，我看到其他人的答案更加优雅。嘿嘿嘿嘿。

# programming-languages - 用什么语言进一步发展？

> ID：445239
> 
> 赞同：0
> 
> 时间：2009-01-15T00:46:33.283
> 
> 标签：programming-languages

好的，到目前为止，我一直在我的高中学习计算机科学课程，并在网络上做一些我自己的研究，我发现我真的很喜欢这个主题。然而，计算机科学课程给了我一些语言（C++、java 和 python）的少量经验，让我想知道自己去哪里进行开发。

我想创建桌面应用程序，甚至是 Web 应用程序，如果可以的话。您认为哪种语言最能促进这一点？

作为旁注，有哪些好书或在线文档可以解释一般的计算机科学主题？我找到了一些好的，但他们没有给我我真正想要的深度。什么是好的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T00:50:37.923

找到一个“痒”——一个你希望存在的程序，它对你有用，但你找不到（或花钱）。然后尝试编写它，使用在线资源（如 Stack Overflow）来帮助你。

在你职业生涯的这个阶段，语言并不重要。在某些任务上，某些语言比其他语言更好，但您自己对语言的舒适程度通常比其他问题更重要。因此，只需选择您感兴趣的语言和您感兴趣的项目，然后开始工作。

您可能会发现您需要从一个更简单的项目开始，或者您可能会为不同的语言或框架找到更多资源。但是开始做某事——不管那是什么——可能是最重要的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T00:51:23.117

如果您想从程序员升级为软件工程师，这是一本[经典但仍然非常相关的书。](http://mitpress.mit.edu/sicp/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T00:52:23.053

听起来您会喜欢跳入您想要定位的操作系统原生的高级现代语言；例如，Objective-C 或 C#。另一方面，如果您真的想为 Web 做点什么，构建 Web 应用程序并不难（您决定使用的后端和前端技术有更多选择）。

基本上，决定您要从事的项目并为其选择最佳语言。真正重要的是你正在做某事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T01:19:02.000

> 用什么语言进一步发展？

鉴于您已经了解 C++、Java 和 Python，我可能建议的下一种语言是 SQL 和 DDL：定义数据库，并从它们中获取数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T01:27:52.233

如果你的 CS 课程没有涉及到它，我强烈建议你花点时间学习更实用的语言风格，比如[erlang](http://erlang.org/)、[haskell](http://www.haskell.org/)甚至[lisp](http://www.lisp.org/)。

它们不会在一夜之间成为您的日常黑客语言，但可以真正帮助您掌握与所有语言相关的重要编程概念。....尤其是关于为手头的任务选择正确语言的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T03:13:33.407

既然你还在上高中，我会告诉你时间在你身边。你有足够的时间来发展成为一名计算机科学家。因此，从长远的眼光看待您的发展。因此，您最好了解作为软件技术基础的抽象。

在我看来，C++ 和 Java 将永远存在，您有足够的时间在该领域发展自己的技能。然而，像 Scheme 或 Python 这样的高级语言会带来很多好处。您可能会发现[此建议](http://www.trollope.org/scheme.html)很有启发性。

此外，每个应用程序都将处理一个数据库作为其记录系统。了解 SQL 和数据建模是双赢的。

此外，理解形式逻辑和/或[离散数学](https://rads.stackoverflow.com/amzn/click/com/0201558025)对于计算机科学来说是必不可少的。计算机语言只不过是用于执行过程的形式语言：即使用数学归纳法来定义它们的语法和语义。

# image - 我在哪里可以获得要在虚拟机中运行的映像或完整的 Windows 操作系统

> ID：445247
> 
> 赞同：11
> 
> 时间：2009-01-15T00:48:15.447
> 
> 标签：image, testing, virtualization, virtual-pc

我想在不同的 Windows 操作系统上测试我的软件。我计划使用虚拟机软件，VMWare 或 Microsoft Virtual PC 来完成。

我希望能够测试 32 位和 64 位版本的 Windows 7、Windows Vista、Windows XP 和 Windows 98，并且可能在不同的服务包级别。

我在哪里可以免费或购买在这些 VM 系统上运行的映像或完整操作系统？

* * *

2015 年 6 月更新：Microsoft 将停用 TechNet 订阅服务，并将其替换[为 TechNet 评估中心](http://www.microsoft.com/en-us/evalcenter/)。所以罗曼达斯的回答不再有效。我正在将接受的答案转移给 Michael Burr，他的链接仍然提供了大量的操作系统映像，而且也是免费的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-15T01:27:56.257

编辑：显然，如果您打算使用 Technet 提供的产品测试自定义代码，我对使用 Technet 的原始回答是不正确的。我不会评论这是否非法，因为我不是律师，我也不会在电视上播放，但这显然违反了 MS 的许可协议。因此，如果您想在 MS 产品上测试自定义代码，显然您需要获取 MSDN 订阅之一。对于这可能造成的任何混乱，我深表歉意。

比 MSDN（我相信超过 1000 美元）便宜的是 MS Technet Plus（仅下载 349 美元；续订 249 美元）。由于您只要求操作系统，而不是开发人员工具。Technet 包括 MS 除了 Visual Studio 和相关的所有东西。我用它在我的 VMWare 测试平台中构建系统。每个操作系统 10 个许可证。

他们所有的操作系​​统和服务器都有 32 位和 64 位版本，还有可以追溯到 MS-DOS 的旧版本。

此处的信息：[http ://technet.microsoft.com/en-us/subscriptions/default.aspx](http://technet.microsoft.com/en-us/subscriptions/default.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-15T01:35:54.057

对于选定数量的 OS/IE 配置，您可以免费从 Microsoft 获取已安装操作系统的 VPC 映像：

*   [http://www.microsoft.com/Downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef](http://www.microsoft.com/Downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef) ( [http://www.modern.ie/](http://www.modern.ie/) )

有几点需要注意——图像会在几个月后过期，然后他们会提供新的下载——所以这些真的是为了测试。除了到期日期之外，他们的许可也可能有限制（老实说，我不知道 - 我已经很长时间没有使用其中之一了）。

目前可用的图片有：

*   带有 IE6 的 WinXP SP3
*   带有 IE7 的 WinXP SP2
*   带有 IE8 Beta 的 WinXP SP3
*   带有IE7的Vista
*   WinXP 到 Windows 8.1，IE6 到 IE11

对于其他操作系统，最好的选择是其他地方提到的 MSDN 或 Technet 订阅。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T00:53:11.943

最简单的方法是使用某种 MSDN 订阅。您只需支付一年的费用即可获得所有操作系统的 ISO 用于测试目的。根据您的情况，费用会有所不同。

*   MSDN：http: [//msdn.microsoft.com/en-us/subscriptions/default.aspx](http://msdn.microsoft.com/en-us/subscriptions/default.aspx)
*   商务火花：http : [//www.microsoft.com/BizSpark/](http://www.microsoft.com/BizSpark/)
*   行动包：[http ://partner.microsoft.com/40016455](http://partner.microsoft.com/40016455)
*   授权 ISV：[http ://partner.microsoft.com/40011351](http://partner.microsoft.com/40011351)

奇怪的是，Google Chrome 的合作伙伴网站现在完全崩溃了。

编辑：如果您有资格获得 Action Pack、Empower 或 Bizspark，那么您所说的 5 个 MSDN 订阅、一堆办公室许可证、真正的 SQL Server 许可证等大约需要 300 美元/年。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T00:51:34.130

如果您在 DVD 上有这些操作系统的安装程序，您可以将您的虚拟 PC 路由到用户主机 PC 的磁盘驱动器，然后从磁盘启动虚拟机。然后您继续安装操作系统，就好像您在实际机器上进行安装一样。

确保提前为每台虚拟 PC 分配足够的资源。

这就是我为 Microsoft Virtual PC 所做的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T00:52:21.960

看看[VMWare 设备市场](http://www.vmware.com/appliances/)：

[Windows 7的](http://www.vmware.com/appliances/directory/61622)

[视窗 2008 服务器](http://www.vmware.com/appliances/directory/1361)

[视窗 2003 R2 服务器](http://www.vmware.com/appliances/directory/649)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T00:53:23.033

您可以从 MSDN 获取 ISO 并将它们安装为 VM。一旦你有一个全新的安装，拍摄一个快照，这样你就可以轻松地从一个干净的状态开始，或者在不同的点（例如没有.NET的操作系统和有.NET的操作系统）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T00:54:31.707

您需要的是 MSDN 订阅。不同版本（包括国际）的所有旧操作系统。虽然不是 VM 映像，但您需要自己安装它们。许可条款显然会禁止第三次分发操作系统映像文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T01:06:19.403

您应该考虑的另一个虚拟化工具是Sun的[VirtualBox 。](http://www.virtualbox.org/wiki/VirtualBox)它可以在任何平台上运行，并且可以运行大多数操作系统，甚至可以使用无缝窗口。它是免费的，易于安装并且使用最少的资源。这是已知[支持的操作系统的列表](http://www.virtualbox.org/wiki/Guest_OSes)

# mapi - 使用 Exchange Web 服务枚举邮件项上的所有属性（mapi 属性？）

> ID：445269
> 
> 赞同：1
> 
> 时间：2009-01-15T00:53:24.050
> 
> 标签：mapi, exchange-server-2007, exchangewebservices

我正在尝试解决 Exchange 2007 服务器上某些邮件项目的问题。我已经能够确定我认为接收者属性有问题，但我不确定，所以我想列举一个坏消息的所有属性，并将其与一个好消息进行比较.

我也会接受 MAPI 或 WebDAV 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:35:19.117

即使您找到了解决问题的方法，我仍然会回答您的原始问题。

不，没有办法枚举EWS 中消息的*所有*属性。它只能返回 AllProperties 标志提供的属性（不返回自定义和命名属性），或者您使用 ExtendedProperty 语法提供的特定属性。

[这](http://social.technet.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/bec6e124-31bd-47e1-a81e-f7c18cc48470/)是添加自定义扩展属性的简短示例。

所以你知道，MFCMAPI 仍在 CodePlex 积极开发和托管（[MFCMAPI at CodePlex）](http://www.codeplex.com/MFCMAPI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T04:20:50.420

我在 Microsoft 的网站上找到了一个实用程序，可以让您浏览 MAPI 商店，因此这比编写一些代码更适合我的目的。整洁的小实用程序指向 MS Exchange 存储。

[来自微软的 MFCMapi](http://www.microsoft.com/downloads/details.aspx?FamilyID=55FDFFD7-1878-4637-9808-1E21ABB3AE37&displaylang=en "来自微软的 MFCMapi")

# xml - SharePoint 列表、GetListItems、XML 和 VBA - 我只想交叉引用！

> ID：445274
> 
> 赞同：3
> 
> 时间：2009-01-15T00:55:03.547
> 
> 标签：xml, sharepoint, vba

我有一个 SharePoint 列表，其中包括我关心的两列；在 Excel-ese 中，我想匹配第 1 列中的值 X，并在第 2 列中返回相应的值。我可以使用[http://guruj.net/node/63](http://guruj.net/node/63)上的代码*变体*来检索信息（我认为），所以我认为我的问题集中在在没有下载 DLL 的情况下在 VBA 中导航 XML（我确实有一堆 MSXML?.DLL，2、2.6、3、4、5、6）。

我找到的最接近的 MSDN 文章参考了 .NET（我卡在 Office 2003 附带的 VBA/VB6 中？）或可下载的 DLL。

Nat 在下面的回复概述了我发现或需要的大部分内容，*但*就像我发现的语言错误一样，我的部分问题是查找搜索词。我拼凑了一些翻译，例如，XMLDocument 似乎是 DOMDocument，但 XML 部分是 IXMLDOMNode 或类似的。

我目前遇到的主要问题是执行查询的 SOAP 调用出现类型不匹配，或者当我尝试重铸播放器（listQuery、listViewFields、listQueryOptions）时对象不支持该方法。我将各个部分保留为变体，然后将它们转换为返回的类型（因为我没有“引用”特定于 SP 的库，所以我这样做有点盲目）并且得到了不匹配。

屏幕抓取文本似乎更容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T01:33:06.230

哇，你在兔子洞里这么远......

好的，您正在查看的代码是让您在 SharePoint 列表上查看，这可能不是最好的起点，但事实上这一切都是在 VBA 中完成的，这真的很难。我有 .NET C# 代码来查询列表并检索具有特定值的项目。我无法进行 VBA 转换。

```
public static string GetPageId(string listName, string webPath, string pageTitle)
    {
        string pageId = "";
        IntranetLists.Lists lists = new IntranetLists.Lists();
        lists.UseDefaultCredentials = true;
        lists.Url = webPath + "/_vti_bin/lists.asmx";
        XmlDocument doc = new XmlDocument();
        doc.LoadXml("<Document><Query><Where><Contains><FieldRef Name=\"Title\" /><Value Type=\"Text\">" + pageTitle + "</Value></Contains></Where></Query><ViewFields /><QueryOptions /></Document>");
        XmlNode listQuery = doc.SelectSingleNode("//Query");
        XmlNode listViewFields = doc.SelectSingleNode("//ViewFields");
        XmlNode listQueryOptions = doc.SelectSingleNode("//QueryOptions");

        Guid g = GetWebID(webPath);

        XmlNode items = lists.GetListItems(listName, string.Empty, listQuery, listViewFields, string.Empty, listQueryOptions, g.ToString());
        foreach (XmlNode listItem in SPCollection.XpathQuery(items, "//sp:listitems/rs:data/z:row"))
        {
            XmlAttribute id = listItem.Attributes["ows_Id"];
            if (id != null)
            {
                pageId = id.Value;                    
            }

        }
        return pageId;            
    } 
```

IntranetLists 是对 lists.asmx 文件的 .net Web 引用。

您必须研究如何在 VBA 中使用 lists.asmx Web 服务，然后您必须使用表示您要查找的列值的查询调用 GetListItems。

```
<Where><Contains><FieldRef Name="Title" /><Value Type="Text">MyValue</Value></Contains></Where> 
```

该查询的语法是[CAML](http://msdn.microsoft.com/en-us/library/ms467521.aspx)

那么您将不得不解析返回的 xml，以找到具有您需要的值的项目和项目字段。任何 xpath 查询都必须添加正确的命名空间，例如

```
 public static XmlNodeList XpathQuery(XmlNode xmlToQuery, string xPathQuery)
    {
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(xmlToQuery.OuterXml);
        XmlNamespaceManager mg = new XmlNamespaceManager(doc.NameTable);
        mg.AddNamespace("sp", "http://schemas.microsoft.com/sharepoint/soap/");
        mg.AddNamespace("z", "#RowsetSchema");                                   
        mg.AddNamespace("rs", "urn:schemas-microsoft-com:rowset");
        mg.AddNamespace("y", "http://schemas.microsoft.com/sharepoint/soap/ois");
        mg.AddNamespace("w", "http://schemas.microsoft.com/WebPart/v2");
        mg.AddNamespace("d", "http://schemas.microsoft.com/sharepoint/soap/directory");
        return doc.SelectNodes(xPathQuery, mg);
    } 
```

但是，我不确定您是否可以访问在您的 VBA 设置中解析 xml 的内容，因此您可能需要下载一些额外的 VBA 工具来执行此操作 - 甚至可能会被阻止。

希望这有所帮助。

# c# - 进入调试模式时跳过方法的属性

> ID：445276
> 
> 赞同：107
> 
> 时间：2009-01-15T00:57:04.447
> 
> 标签：c#, .net, debugging, attributes

是否有我可以在方法上使用的属性，以便在调试模式下单步执行某些代码时，调试器会停留在方法的外部？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-01-15T00:59:07.343

```
 [DebuggerStepThrough] 
```

（[文档](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.debuggerstepthroughattribute?view=netframework-4.7)）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-09-22T13:36:12.610

不要忘记添加：

```
using System.Diagnostics; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-05-21T12:41:52.030

它是用***VB.NET***`<DebuggerStepThrough>`编写的。

 *要使用它，只需将其放在方法之上，例如：

```
<DebuggerStepThrough>
Private Sub form_Paint(sender As Object, e As PaintEventArgs) Handles form.Paint
     ' Picasso
End Sub 
```

# xml - 如何使用 XQuery 在 xml 文档中查找重复数据？

> ID：445281
> 
> 赞同：2
> 
> 时间：2009-01-15T01:01:22.457
> 
> 标签：xml, xquery, duplicate-data, marklogic

我在 MarkLogic xml 数据库中有一堆文档。一份文件有：

```
<colors>
  <color>red</color>
  <color>red</color>
</colors> 
```

拥有多种颜色不是问题。有多种颜色都是红色是一个问题。如何查找具有重复数据的文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-11T22:13:29.937

MarkLogic 返回的所有内容都只是一个节点序列，因此我们可以计算整体的序列大小并将其与不同值序列的计数进行比较。如果它们不是不同的，它们就是重复的，并且你有你的子集。

```
for $c in doc()//colors
where fn:count($c/color) != fn:count(fn:distinct-values($c/color))
return $c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T10:04:49.100

这应该可以解决问题。我对 MarkLogic 不太熟悉，所以第一行获取文档集可能是错误的。这将返回具有相同字符串值的 2 个或更多颜色元素的所有文档。

```
for $doc in doc()
let $colors = $doc//color/string(.)
where some $color in $colors
      satisfies count($colors[. = $color] > 1)
return doc() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-30T01:18:55.117

或者你可以完全用索引来完成它:)

`for $c in doc()//colors`可能会在较大的数据集上 创建**EXPANDED TREE CACHE错误。**

当数据很大时，这是一种稍微复杂的攻击方法，确保*URI Lexicon 已打开*，然后在元素**颜色上添加****元素范围索引，并计算在***某处*有重复的不同颜色值。然后仅循环遍历具有此颜色的文档，并计算文档中感兴趣颜色的项目频率计数。如果您的频率超过 1，则该文档需要重复数据删除。

 ***```
let $qn := xs:QName("color")
let $colorsWithItemFreq := cts:element-values($qn, (), ("ascending", "item-order", "item-frequency"))
let $colorsOfInterest := 
    for $color at $i in cts:element-values($qn, (), ("ascending", "item-order", "fragment-frequency"))
    let $fragFrequency := cts:frequency($color)
    let $itemFrequency := cts:frequency($colorsWithItemFreq[$i])
    where $itemFrequency gt $fragFrequency
    return 
        $color

for $uri in cts:uris( (), ("document"), cts:element-value-query($qn, $colorsOfInterest)
let $colorsWithDuplicationInThisDoc :=
    for $color in cts:element-values($qn, (), ("item-frequency"), cts:document-query($uri) )
    where $color = $colorsOfInterest and cts:frequency($color) gt 1
    return
        $color
where fn:count( $colorsWithDuplicationInThisDoc ) gt 1
return
    $uri 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T19:10:15.010

对于这个 XML：

```
<?xml version="1.0"?>
<colors>
    <color>Red</color>
    <color>Red</color>
    <color>Blue</color>
</colors> 
```

使用此 XSD：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method = "text" />  
    <xsl:strip-space elements="*"/>

    <xsl:template match="colors">

        <xsl:for-each select="color">
            <xsl:variable name="node_color" select="text()"/>
            <xsl:variable name="numEntries" select="count(../color[text()=$node_color])"/>
            <xsl:if test="$numEntries &gt; 1">
                <xsl:text>Color value of </xsl:text><xsl:value-of select="."/><xsl:text> has multiple entries &#xa;</xsl:text>      
            </xsl:if>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

我得到了这个输出：

```
Color value of Red has multiple entries 
Color value of Red has multiple entries 
```

所以至少会找到它们，但它会报告每次出现的重复颜色，而不仅仅是每个重复的颜色。

# .net - 嵌套用户控件 - 如何最好地获取对祖先控件的引用

> ID：445282
> 
> 赞同：1
> 
> 时间：2009-01-15T01:01:48.307
> 
> 标签：.net, user-controls, nested

我意识到很多代码不适合这里，但我要求提供一般方向或指针。

我有 .NET 用户控件嵌套六个深度，用于交互式小工具（从外到内）：包装器、选项卡、面板、列表、行、项目。

我正在尝试从嵌套控件中获取对祖先控件的引用。

具体来说，我在嵌入式“曾曾孙”控件的代码后面有这段代码。它有效，但非常难看：

```
MyTab _myTab = this.Parent.Parent.Parent.Parent.FindControl(thisTab) as MyTab; 
```

这等于 `{ASP.controls_appname_widget_mywidget_mytab_ascx}`并且是正确的。

我意识到我可以做类似 Page.FindControl("MyWrapper:MyPanel:etc.....) 但也不推荐这样做，因为结构或 ID 可以改变......

有没有像样的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:14:22.227

请记住，组件最好是无知的。您永远不希望任何控件了解层次结构中自身之上的任何内容，并且只了解层次结构中自身之下的控件的界面知识。从长远来看，这种架构方法将为您节省很多痛苦和痛苦，并将避免像您现在这样的情况。

至于解决当前问题，最好的解决方法是`MyTab`在您的控件中创建一个可由父控件设置的成员。这不是一个完美的解决方案，因为您的控制并非完全不了解其他人，但至少您将不再需要知道如何获取`MyTab`参考 - 它会提供给您。

因此，我将创建一个名为 like 的属性`ParentTab`，并将此属性设置`MyTab`为页面中某处或控件内部的引用，该控件确实并且应该对两者`MyTab`和您的控件都具有可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:03:56.403

我认为这实际上取决于您对控件的使用。如果控件只服务于一种业务需求并且只是在一个页面上使用以满足用例，那么就没有必要为接口和属性而疯狂。我认为 parent.parent.parent.etc 的想法没有任何问题；我自己用过很多次。不过，我会将它包装在一个属性中，以便在需要时可以调用 this.MyGreatGreatGrandFatherProperty。它将更具可读性，如果您的层次结构深度发生变化，您只有一个地方需要修复。

现在，如果它是一个您无法控制其使用的通用组件，或者在许多用例中都需要它，那么您需要为父组件添加属性以告诉您它们要保持分离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:16:24.173

@Andrew，不是为了劫持我自己的线程，而是为了澄清和讨论一种设计方法。您说过“您永远不希望任何控件对层次结构中高于其自身的任何事物有任何了解……”出于显而易见的原因，这是一个很好的设计策略。但是对于内置了某种集中管理的包装容器的情况呢？例如，在 .NET 中，嵌套母版页中的 ScriptManager 控件。您可能希望只创建一次脚本管理器，并且希望它可用于应用程序中的各种控件。例如，应用程序中任何嵌入式控件中的任何 UpdatePanel 都想知道该 ScriptManager 的存在。这是一个错误的方法吗？

我的设计类似——最外层的包装容器管理对象持久性，每个控件都可以将其状态保存到该 Manager。我现在认为包装代表是最好的设计。因为我不喜欢 Parent.Parent。等等，也不是为了参考而遍历控件 ID。欢迎任何意见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-04T14:30:09.883

```
public static class Extension{
 public static Control FindControlRecursive(this Control control, string idToFind)
 {
     Control result;
     if(control != null){
        result = control.FindControl(idToFind);
     }
     if(result != null){ return result; }
     if(result == null && control.Parent != null){
         return control.Parent.FindRecursive(idToFind);
     }
     return null;
  }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-15T01:05:42.447

您好，您可以使用 WebControl 选择器，它实际上是一个独立项目（许可证 == LGPL），但仍然是主要[Ra-Ajax](http://ra-ajax.org)下载的一部分...

[在此处](http://ra-ajax.org/jquery-ish-selector-for-webcontrols.blog)查看代码和示例使用...

然后你可以只从 Page 对象中搜索，它会递归地在委托中查找与你的（无论什么）条件匹配的控件......

# build - 在构建 Web 服务器方面需要帮助

> ID：445283
> 
> 赞同：-4
> 
> 时间：2009-01-15T01:03:14.183
> 
> 标签：build

问候！

我想构建一个 apache web 服务器，在 debian lenny 上运行。

它将主要用于托管网上商店，因此它应该有一些轻量级的数据库 i/o 和大量的图像服务（项目预览/拇指/等等...）。

很难确定我会遇到的并发请求的确切数量，但我想说非专业设置应该足以处理它们。

非专业人士的意思是我不需要投资购买刀片、机架或类似的东西。只是针对 Web 服务器性能进行了调整的普通台式 PC。

这暴露了我当前的问题：我不知道我应该寻找什么样的机器。

如果我想建立一个游戏平台，没问题 - 至少有一百万个网站有性能测试台，从最前沿的显卡评论到平板 LCD 对比度/响应时间图表。但是，在尝试为基于 Web 服务器的构建寻找推荐时，我很难找到一个好的*最近*评论。

所以，至少到目前为止我已经设法收集到这些 - 这些是我应该关注的优先事项：

> ```
> 1) Lots of memory (preferably fast)
> 2) A pair of fast HDDs
> 3) As many cores as I can get
> 4) As fast processor as I can get
> 5) A MB with good I/O 
> ```

所以，内存和硬盘驱动器没什么大不了的，在这里你不会出错（我猜）。以现在的 RAM 价格，将 8+ Gb 注入机器是相当实惠的。

这里唯一的问题是，购买一个小型（<=32 Gb）SSD 并将我所有的网络内容和操作系统都放在上面是否值得。我的整个 Web 服务器只有几兆的大小 + 数据库将非常整齐地安装在它上面，并有启动空间。

至于显卡，我只要插上我能装的任何旧的 PCI Ex 卡，任何外围设备也是如此。我不需要任何形式的显示 - 我将在大部分时间远程登录。

好的 - 现在最重要的问题是：购买哪个 Proc 和 MB。据我所知——考虑到机器的性质，最好有 10 个内核以每个 100 Mhz 运行，而不是只有一个以 2 Ghz 运行。

所以我很可能必须得到一个四核，对吧？问题是哪个...：/

因为有几个负担得起的......我的预算是800美元左右。同样，这仅适用于 proc、MB 和内存。我有硬盘。如果我带一个小型 SSD，则在该预算中增加 100 美元。

AMD 飞鸿还是英特尔酷睿 2？与哪个MB一起去？我完全迷失在这里。

如果这将引发 AMD 与 Intel 的激烈战争，我真的很抱歉，因为这不是我的意图 - 但如果你至少可以指出我最近对 ​​Web 服务器构建的一个很好的评论，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T01:15:06.313

一方面您说您不需要那么多性能，但另一方面您正在谈论添加尽可能多的内核。AMD 或 Intel 的四核 CPU 将绰绰有余。它属于“宗教战争”的范畴，但我更喜欢英特尔芯片；我通常购买至强处理器。至于SSD，我不会打扰。使用 3Ware 控制器查看良好的 RAID 设置；RAID 1+0 或 RAID 5（显然，会有一群宗教的反 RAID5 人群，尽管我更喜欢它.. 至少在 RAID 6 更广泛之前）。尽可能多的内存是理想的，尽管任何超过 8 的内存都可能超出您所说的范围。可能与您已经列出的主要不同之处在于我什至不会打扰 SSD。根据您的使用模式，您实际上可能会损害它的性能，并且为您的用例带来的任何好处都不值得付出代价。等待研究赶上 SSD 在性能方面真正有益。:)

如果这是一台商业服务器，我建议从 IBM、Dell 或您喜欢的任何主要制造商（我更喜欢 IBM）购买一个预先配置的服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T01:24:45.903

对于SO的“正确”问题，这确实是一个延伸。仅以“实施”为单位。

* * *

预配置的“服务器”机器通常更具成本效益。但是，如果您仍然希望构建自己的...

仅考虑您在 MB、Proc 和内存方面的预算（800 美元）...

RAM - [DDR2 800](http://www.newegg.com/Product/ProductList.aspx?Submit=ENE&N=2010170541+1052416064&Configurator=&Subcategory=541&description=&Ntk=&SpeTabStoreType=&srchInDesc=)（$200/4GB，更便宜）

MB - [1333/1066MHz FSB](http://www.newegg.com/Product/ProductList.aspx?Submit=ENE&N=2010200302+1072616489+1071522019&Configurator=&Subcategory=302&description=&Ntk=&SpeTabStoreType=&srchInDesc=) ($250)

CPU -[双核](http://www.newegg.com/Product/ProductList.aspx?Submit=ENE&N=2010340343%201302820275%201051107412)（150 美元）

四核对于好处来说仍然可能太贵了——但是，这取决于你自己的判断。

但是，按照链接，并使用高级搜索删除不必要的功能，您应该能够相当容易地减少项目列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T01:20:41.683

您是否考虑过共享、专用或虚拟主机？如果我是你，我会使用 SliceHost 作为虚拟服务器，然后使用 Amazon S3 来提供图像和其他大型静态文件。过去，这种组合对我来说效果很好。我发现，尤其是在托管方面，不要承担比您绝对必须承担的更多的责任。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:28:53.087

如果您不打算运行下一个亚马逊，我会说您选择的 CPU/芯片组是无关紧要的。找到一个具有您所需功能（4 个以上 RAM 插槽、大量 SATA 接头等）且适合您预算的主板，然后购买适合您的中高端多核 CPU。获得一个 PCI Express RAID 卡和一个大容量的 UPS。

为操作系统获取一个普通硬盘驱动器，以及一对快速驱动器（WD Velociraptors 等），并将它们放入 RAID 1 中用于网络服务器以实现冗余。

然后，大约一年后或每隔一天重新启动服务器，将所有内容迁移到托管公司。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T06:36:49.457

我将 MediaTemple 用于我的网站。他们在那里的服务器上托管了许多专业组织。如果我是你，我可能会和他们一起去。

我父亲认为服务器路线很容易，但我们发现了不同的困难方式。如果您没有真正了解自己在做什么的朋友或员工，我会小心的。无论如何，祝你好运。

# com - 将 CComSafeArray 传递给期望 SAFEARRAY 的方法时，正确的语法是什么**

> ID：445286
> 
> 赞同：4
> 
> 时间：2009-01-15T01:05:37.487
> 
> 标签：com, safearray

这很可能有一个非常简单的答案，但我无法弄清楚。

我正在尝试重构一些看起来像这样的代码：

```
SAFEARRAY* psa;
long* count;
HRESULT hr = pSomeInterface->ListSomething(&psa, &count);
if (SUCCEEDED(hr))
{
    CComSafeArray<BSTR> sa;
    if (*count > 0)
    {
        sa.Attach(psa);
    }
}

// perform operations on sa
// allow CComSafeArray to destroy the object

return hr; 
```

我想将代码更改为：

```
CComSafeArray<BSTR> sa;
long* count;
hr = pSomeInterface->ListSomething(&(sa.m_psa), &count);

if (SUCCEEDED(hr))
{
    // perform operations on sa
} 
```

但是当我执行这个时， sa 包含垃圾。发生了什么，为什么？什么是正确的语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T06:53:08.550

我在您的代码中没有看到任何此类问题。如果您可以分享 ListSomething(..) 方法的代码，那么我们也许可以找到一些东西，但是像这样的类似代码非常适合我。

```
void MyMethod(SAFEARRAY** pArray)
{
    int i = (*pArray)->cbElements;
    return;
}

CComSafeArray&lt;BSTR&gt; myArray;
myArray.Add(CComBSTR(_T("Test")));
myArray.Add(CComBSTR(_T("Best")));
myArray.Add(CComBSTR(_T("Rest")));
MyMethod(&(myArray.m_psa)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-22T10:29:34.610

你应该使用`CComSafeArray<T>::`[`GetSafeArrayPtr()`](http://msdn.microsoft.com/en-us/library/1s10dhw5.aspx). 但是[Aamir](https://stackoverflow.com/questions/445286/what-is-the-correct-syntax-when-passing-ccomsafearray-to-a-method-expecting-safea/445876#445876)的使用方式也`&(sa.m_psa)`应该有效。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-15T10:16:40.463

You're defeating the whole point of using CComSafeArray by effectively bypassing it and accessing its internal SAFEARRAY directly. CComSafeArray has an explicit LPSAFEARRAY operator defined, so you should be able to do this instead:

```
CComSafeArray<BSTR> sa;
long* count;
HRESULT hr = pSomeInterface->ListSomething(&sa, &count);
if (SUCCEEDED(hr))
{    
    // perform operations on sa
} 
```

# latex - 如何在我的 LaTeX 文档中使用 ⨝ 和 ⊐？

> ID：445289
> 
> 赞同：5
> 
> 时间：2009-01-15T01:06:00.093
> 
> 标签：latex

我正在尝试将[LaTeX Math Symbols](http://web.ift.uib.no/Fysisk/Teori/KURS/WRK/TeX/symALL.html)中的一些符号插入到我的 LaTeX 文档中：在关系符号标题下，我想要加入 (⨝) 和方形 supset (⊐)。

它们后面都有一个小 b 符号。这意味着什么; 如何将它们插入到我的文档中？我尝试添加它们而忽略 b 但它似乎出错并且不起作用。

我正在使用 LaTeX 的小型 Mac 安装。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T01:45:16.737

我的 Helmut 和 Kopka 的*LaTeX 指南*副本说`\sqsupset`（其中包括）：

“注意：带下划线的符号名称 [...] 仅在其中一个包`latexsym`或`amsfonts`已加载时才在 LaTeX 2e 中可用。”

这本书根本没有`\Join`在其符号表中显示，但是它列出了`\bowtie`哪些似乎产生了相同的符号，并且根本没有与之相关的脚注或警告:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T01:09:13.813

他们在你身上使用 meta-LaTeX：这是一个上标“b”（$ 表示一个简短的数学表达式，插入符号是上标）。

他们的意思是有一个脚注。它显示在“二进制操作符号”部分。

> $^b$ 未以基于 {\tt basefont.tex} 的格式预定义。使用样式选项 {\tt oldlfont}、{\tt newlfont}、{\tt amsfonts} 或 {\tt amssymb} 之一。

因此，如果您看到错误，这将向我表明您正在使用基本字体格式。尝试脚注中列出的样式选项之一，看看你是否有更多的运气。如下所述，

> \usepackage{newlfont}

值得一试。这应该启用诸如`\Join`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T01:22:21.870

正如该页面上的脚注所解释的，您应该使用特殊设置来获取这些符号。因此，例如，如果您添加`\usepackage{newlfont}`到文件的顶部，您将能够获得符号，例如`$\sqsubset$`.

# ruby-on-rails - Ruby on Rails：ActiveRecord 对象创建的确认页面

> ID：445293
> 
> 赞同：7
> 
> 时间：2009-01-15T01:07:57.310
> 
> 标签：ruby-on-rails, ruby, activerecord

使用 Ruby on Rails 在创建 ActiveRecord 对象之前我想要一个确认页面。用户将在提交之前看到他们正在创建的项目的预览以及保存在数据库中的对象

一个共同的模式；

*   用户访问 /entry/new
*   用户输入详细信息并单击提交
*   用户被重定向到显示条目的 /entry/confirm 并单击提交或编辑以纠正错误
*   对象已保存

你将如何实施它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T10:13:07.990

Another option to solve this issue adding by a virtual confirmation attribute to your model. This way, there is no need to create a separate action for this:

```
 class MyRecord < ActiveRecord::Base
  attr_accessor :confirmation
  validates_acceptance_of :confirmation, :on => :create
end 
```

Now, your new object will not save correctly because the validation will fail on the confirmation field. You can detect this situation and present something like this:

```
 <% form_for(@my_record) do |form| %>
  ...
  <%= form.check_box :confirmation %> Really create this record.
  <%= submit_tag('Confirm') %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T17:12:22.273

我可能会在该模型的 routes.rb 文件中添加“预览”操作：

```
map.resource :objects, :new => { :preview => :post } 
```

您可以通过发布命名路由来执行此`preview`操作。`preview_object_url`您需要以与您在操作`Object`中相同的方式基本上创建`create`，如下所示：

```
def preview
  @object = Object.new(params[:object])
end 
```

然后该页面将 POST 到该`create`操作，然后该操作将创建对象。这很简单。

[http://api.rubyonrails.org/classes/ActionController/Resources.html](http://api.rubyonrails.org/classes/ActionController/Resources.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T03:14:01.970

几个选项

1-将您要创建的对象存储在会话中，直到您点击确认页面，然后保存它

2-通过新的每个帖子/提交的对象->详细信息->确认

我可能会选择 2，因为我不容易保存会话状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:43:49.330

我不确定如何执行此操作（RoR 对我来说是新的），但您可以将 /new 的操作指定为 /confirm，然后调用 create。

正确的？

# c++ - 为什么 OpenCV 拒绝 cvLoadImage("string.ext")，但接受 cvLoadImage(argv[1])？

> ID：445295
> 
> 赞同：0
> 
> 时间：2009-01-15T01:11:00.487
> 
> 标签：c++, c, visual-studio, opencv

```
#include "cv.h"
#include "highgui.h"
#include <stdio.h>

int main(int argc, char* argv[]){
    cvNamedWindow("Window1", CV_WINDOW_AUTOSIZE);
    IplImage* image = 0;
    ->->image = cvLoadImage(argv[1]);<-<-
    if(!image) printf("Unable to load image!");
    cvShowImage("Window1", image);
    char c = cvWaitKey(0);
    cvReleaseImage(&image);
    cvDestroyWindow("Window1");
    return 0;
} 
```

如果我将指示的行替换为`cvLoadImage("247.png")`我得到一个空白窗口并且图像保持为零

如果我运行 exe 并给它 247.png 作为参数，那只是花花公子。如果我将“247.png”直接放入代码中并构建并运行它 Visual Studio 2008，它会失败。如果我从命令提示符构建并运行，它可以工作。

为什么是这样？我有点厌倦了继续前进而不把它弄下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:26:37.117

当您对名称进行硬编码时，您确定“247.png”在当前工作目录中吗？

[在进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)之类的程序下运行程序，以查看真正打开的文件（或可能存在哪些文件 I/O 错误）。

在您编辑以向问题添加更多信息之后（从 VS2008 运行时会出现问题），这几乎肯定是您的问题。VS启动程序的当前目录不是“247.png”文件所在的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:54:09.220

你能检查一下你`cwd`是什么吗？

您可以`#include <direct.h>`使用该`_getcwd`功能来查看它是什么。这可能会指出你的罪魁祸首。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T03:02:25.710

在 Project->Properties->Configuration Properties->Debugging 下有一个“工作目录”字段。将其设置为您要在其中执行的目录，这应该可以解决问题。

# c# - 如何在 .NET 应用程序中松散耦合数据库列？

> ID：445297
> 
> 赞同：2
> 
> 时间：2009-01-15T01:11:36.867
> 
> 标签：c#, .net, nhibernate, unity-container, loose-coupling

我有一个几乎相同的数据库的两个版本。下面我创建了一个示例表来演示基本差异，即 ID 列已从 Integer Identity 更改为 GUID 并更新了各种属性，在示例中存档已替换为 readOnly 并隐藏：

旧版：

```
CREATE TABLE Example
(
    --Data Identity (maps to DbId in the example code)
    Id int IDENTITY PRIMARY KEY,

    --Example columns
    SomeValue varchar(50),
    AnotherValue int,

    --Data Properties
    Archived bit
) 
```

新版本：

```
CREATE TABLE Example
(
    --Data Identity (maps to DbId in the example code)
    Id uniqueidentifier PRIMARY KEY,

    --Example columns
    SomeValue varchar(50),
    AnotherValue int,

    --Data Properties
    ReadOnly bit,
    Hidden bit
) 
```

我需要能够使用诸如 NHibernate 之类的 O/R 映射器来连接到这些数据库版本中的一个或其他。我希望能够通过配置文件中的设置告诉应用程序使用哪个版本。

我最初的计划是为业务逻辑创建一个通用接口，并使用 Unity 等 IoC 容器在配置文件中的相关具体类之间进行交换。

以下是我为测试该理论而创建的代码示例：

```
public interface IDataIdentity
{
    object Id { get; }
}

public class LegacyDataIdentity : IDataIdentity
{
    public virtual long DbId { get; set; }

    public object Id
    {
        get { return DbId; }
    }
}

public class NewDataIdentity : IDataIdentity
{
    public virtual Guid DbId { get; set; }

    public object Id
    {
        get { return DbId; }
    }
}

public interface IDataProperties
{
    bool ReadOnly { get; set; }
    bool Hidden { get; set; }
}

public class LegacyDataProperties : IDataProperties
{
    public virtual bool Archived { get; set; }

    public bool ReadOnly
    {
        get { return Archived; }
        set { Archived = value; }
    }

    public bool Hidden
    {
        get { return Archived; }
        set { Archived = value; }
    }
}

public class NewDataProperties : IDataProperties
{
    public virtual bool ReadOnly { get; set; }
    public virtual bool Hidden { get; set; }
}

public class DataItem
{
    public DataItem(IDataIdentity dataIdentity, IDataProperties dataProperties)
    {
        DataIdentity = dataIdentity;
        DataProperties = dataProperties;
    }

    public IDataIdentity DataIdentity { get; set; }
    public IDataProperties DataProperties { get; set; }
}

public class Example : DataItem
{
    public Example(IDataIdentity dataIdentity, IDataProperties dataProperties)
        : base(dataIdentity, dataProperties)
    {
    }

    public virtual string SomeValue { get; set; }
    public virtual int AnotherValue { get; set; }
} 
```

谁能建议这是否可行（特别是使用 Unity 和 NHibernate），如果可以，如何创建相关的 NHibernate 映射文件？

或者，任何人都可以使用任何其他方法或其他 IoC 和 O/R 映射工具（商业或开源）提出任何解决问题的方法吗？

非常感谢，

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T11:35:10.650

为什么不抽象您的数据提供者，实现 2 个版本（一个用于旧数据项的休眠映射，一个用于新数据项）。

稍微解释一下您的代码（为清楚起见进行了简化）：

```
public abstract class AbstractData
{
    public abstract string SomeValue { get; set; }
    public abstract bool ReadOnly { get; set; }
    //etc.
}

public interface IDataProvider
{
    AbstractData Get(object id);
}

public class LegacyData : AbstractData
{
     // Implement AbstractData, and
     public virtual long Id { get { return m_Id; } set { m_Id = value; };
     private long m_Id;
}

public class LegacyDataNHibernateProvider : IDataProvider
{
     public LegacyDataProvider()
     {
         // Set up fluent nhibernate mapping 
     }

     public AbstractData Get(object id)
     {
           // Interpret id as legacy identifier, retrieve LegacyData item, and return
     }
};

// Same again for new data provider 
```

这样，您就不会被绑定到 nhibernate（或数据库，就此而言），并且您可以指定具有正确类型标识符的具体类（nhibernate 可以处理）。这是我正在采用的方法，我目前必须针对现有数据库的 SP 进行映射，但稍后将迁移到新的基于 ORM 的系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T04:40:23.577

也许我没有正确理解你的问题，但在我看来你需要实现类似“工厂模式”的东西。

当我工作的公司从 JDE 切换到 SAP 时，我最近使用工厂模式将 (c#) 编码到两个数据层。我能够翻转配置开关以在两个数据层之间切换，GUI 不会有任何不同。

这是我找到的几个链接：

[http://msdn.microsoft.com/en-us/library/ms954600.aspx](http://msdn.microsoft.com/en-us/library/ms954600.aspx) [http://www.allapplabs.com/java_design_patterns/factory_pattern.htm](http://www.allapplabs.com/java_design_patterns/factory_pattern.htm) [http://en.wikipedia.org/wiki/Abstract_factory_pattern](http://en.wikipedia.org/wiki/Abstract_factory_pattern)

就 NHibernate 而言，我不熟悉它......对不起。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T05:02:08.180

在不了解全貌的情况下很难推荐，但是....您可以通过让 SP 为两个表结构返回相同的数据集来在 SP 中创建一个抽象。

我正在考虑的另一个抽象是，您实际上可以指定不同的 hybernate 映射文件，并根据您连接的数据库使用不同的文件初始化 Hibernate。

# sql-server - 在 Sql Server Analysis Services 中计算消耗的运行总计的最有效方法是什么？

> ID：445299
> 
> 赞同：3
> 
> 时间：2009-01-15T01:12:23.137
> 
> 标签：sql-server, ssis, ssas

我在 SSAS 2005 中有一个多维数据集，可以计算数百万条记录的运行总和。当前的实现是在 MDX 中使用 PeriodsToDate 求和函数，它非常慢，在某些情况下需要 15 分钟或更长时间才能返回结果。这个问题有很多解决方案，所以我希望其他人已经测试了其中的一些，并且可以节省我实施和测试每个解决方案的时间。

使用游标在 T-SQL 中计算运行总和和滑动窗口类型计算是否更可取（请不要使用 Celko 的交叉连接解决方​​案，我知道它们在纸上看起来不错，但是随着数据的增长，交叉连接解决方​​案非常慢），使用SSIS 中的脚本任务（或者在集成服务中是否有更好的方法来执行此操作）或在 Analysis Services 中使用 MDX？

还有其他想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T22:57:26.647

我花了一点时间来弄清楚它在时间维度上有没有层次结构的情况下可以工作。根据我的数据和我的多维数据集结构，这是我放在一起的内容：

```
with member [Measures].[RunningTotal] as 
'sum({[Deferred Revenue Date].[Standard Calendar].CurrentMember.Level.Item(0):[Deferred Revenue Date].[Standard Calendar].CurrentMember}, [Measures].[Deferred Revenue Amount])'
select
    {[Measures].[Deferred Revenue Amount]
    ,[Measures].[RunningTotal]
    } on columns,
    nonempty([Deferred Revenue Date].[Standard Calendar].[Date], [Measures].[Deferred Revenue Amount]) on rows
from
DW; 
```

一个技巧是 nonempty() 子句，如果维度和度量有交集，它只会在计算的度量列中返回值。没有它，您将在度量列中得到一堆 NULL，在计算的度量列中得到一堆重复值。这实际上是一个非常方便的查询。

无论您在 SELECT 语句中指定的级别如何，无论是日期、月份还是年份，计算的成员都将起作用。就我而言，我尝试约会尽可能接近你想要做的事情。我为我的多维数据集编写了一个类似于您的查询，它在 43 秒内运行。这个新的运行大约 2 秒，我们有相当多的数据，所以它也应该运行得更快，假设你已经构建了聚合等。

MDX 的问题是有十八种方法可以做某事，但只有一两种可以运行良好。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T21:37:40.340

我现在用的MDX很慢，就是这样。

```
 Sum
(
PeriodsToDate([Date of Transaction].[Date].[(All)], [Date of Transaction].[Date].CurrentMember), [Measures].[Amount - Response]
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T17:36:13.563

我可以看到使用多维数据集聚合进行总计的最有效方法。这个想法是得到所有先前成员的总和 + sum(parent.firstsibling:parent.prev member,measure)+ sum(parent.parent.firstsibling:parent.parent.prevmember,measure)

# c# - 为什么我的 Button 在下载 zip 文件时会发送两次回传？

> ID：445300
> 
> 赞同：0
> 
> 时间：2009-01-15T01:12:34.133
> 
> 标签：c#, webforms, postback

我在*WebForms*应用程序上遇到问题，用户从页面上的下拉列表中选择一些标准并点击页面上调用此方法的按钮：

```
protected void btnSearch_Click(object sender, EventArgs e) 
```

然后他们单击按钮以根据调用此方法的标准下载 zip 文件：

```
protected void btnDownload_Click(object sender, EventArgs e) 
```

在 IE 中，浏览器顶部的栏会提示他们：

> “为了帮助保护您的安全，Internet Explorer 阻止了该站点将文件下载到您的计算机”。

当他们单击该栏以下载文件时，它会`btnSearch_Click`再次触发该事件。

`Response.ContentType`并`Response.AddHeader`已正确设置。

问题是，它`btnSearch`附加了标准，所以基本上它被附加了两次并导致问题。

我能做些什么来防止这种情况发生吗？

这是一个使用 C# 3.5 的 VS2008 Web 应用程序，物有所值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-18T01:33:59.067

当他们单击下载按钮时，执行重定向到 ZIP 文件处理程序（页面？）以下载文件。即使用 Post-Redirect-Get 模式：[http ://en.wikipedia.org/wiki/Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T01:17:40.317

您是否使用 Content-Disposition 标头？

```
Response.AddHeader("Content-Disposition", "attachment; filename=fileName.zip"); 
```

尝试更改内容类型以匹配文件类型？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T07:03:34.830

将布尔值保存到 Session 中，指示已附加条件。当用户从下拉列表中选择另一个值时，将此值设置为 false。

在您的 btn_Download 事件中，您可以检查 Session 变量的值并避免两次设置标准。

# c++ - 在 vista 中避免 UAC

> ID：445301
> 
> 赞同：2
> 
> 时间：2009-01-15T01:13:26.847
> 
> 标签：c++, windows-vista, uac

我正在编写一个应用程序，该应用程序为需要将数据保存到程序文件的程序下载和安装插件（对于有问题的程序）。现在这在禁用 uac 的 xp 和 vista 上工作正常，但是由于虚拟文件夹，它在普通 vista 上失败。

如果每次应用程序启动时都不需要请求管理员权限，如何解决这个问题？

Ps 程序是用 c++ 编写的，vis 2005

编辑：文件系统虚拟文件夹： http: [//www.codeproject.com/KB/vista-security/MakingAppsUACAware.aspx](http://www.codeproject.com/KB/vista-security/MakingAppsUACAware.aspx)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T01:18:01.893

仅在安装期间写入 Program Files。之后，写入用户文件夹。

您可以稍后提升应用程序权限，但您只会延迟提示。UAC 的全部意义在于防止随机应用程序写入需要管理员权限的文件夹。（好吧，不是全部，而是其中的很大一部分。）

您可以创建具有管理员权限的服务并向其发送命令以将下载的文件移动到所需的目标目录中，但是如果您没有非常仔细地设计它，这会使用户的系统被其他应用程序滥用。

[本文讨论](http://msdn.microsoft.com/en-us/magazine/cc163486.aspx)了如何让应用与 UAC 完美配合。另外，请在此处[查看这篇文章](http://technet.microsoft.com/en-us/magazine/2007.06.uac.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T02:21:09.643

当我与他们交谈时，Microsoft 向我建议必须编写第二个应用程序，这表明您需要管理权限。您使用此应用程序将文件从安全位置（例如用户程序数据目录）部署到程序文件目录（请注意，如果您的 DLL 未签名，那么这是一个巨大的安全漏洞，因为病毒/恶意用户可以操纵函数调用之前的文件）。

您的非管理应用程序可以调用将触发 UAC 的此应用程序。懂UAC的人不会在意，会高兴地点击你的申请。讨厌它的人会关掉它。如果用户取消 UAC 对话框，则启动新进程（需要管理员权限）的调用将引发 win32 异常，因此请注意捕捉它。

vista 中的问题是，如果您不是管理员，它会尝试通过虚拟化您的程序文件目录来帮助您。按照设计，除非您是管理员，否则您无法写入程序文件目录。

另一种选择是将所有“更新”创建为 MSI 更新。这样，Windows 安装程序将为您触发 UAC，您可以为您的软件等提供徽标。

选项 3 是使用 clickonce 部署，这将允许您在没有 UAC 的情况下自动更新程序，但您生活在用户系统上的沙箱中，这可能不适用于您的应用程序的当前设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T09:46:41.737

我通过创建一个可以完成我需要的工作并且仅在应用程序运行时运行的 Windows 服务来绕过 uac。

# deployment - 我有一个需要在客户端的 Intranet 中更新的 J2EE 应用程序

> ID：445302
> 
> 赞同：0
> 
> 时间：2009-01-15T01:13:52.167
> 
> 标签：deployment, jakarta-ee, updating

我有一个运行良好并且可以通过 Internet 访问的 J2EE 应用程序。我们的一些潜在客户想要使用它，但不愿意通过互联网发送他们的数据。

作为一种解决方法，我考虑为他们提供战争文件并让他们自己运行。

问题是：当我提供新版本时，如何让他们轻松更新应用程序？难度越大，他们买入的可能性就越小。

编写从在线获取最新战争文件并更新 Web 应用程序的更新程序涉及什么？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T01:56:07.743

至少他们需要重新部署战争文件。大多数应用程序服务器都有一个界面，您可以通过该界面上传新的战争文件。我赞成手动执行此过程，即您向他们发送战争文件，他们可以使用应用服务器的管理页面来部署新战争。这样他们就可以明确知道何时更新应用程序。他们还可以控制何时部署新版本的应用程序并轻松回滚到旧版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T02:02:48.357

我建议使用[Jetty](http://jetty.mortbay.com/jetty/)作为嵌入式解决方案。我使用了一些使用嵌入式功能的应用程序。它允许您创建应用程序的打包发行版，该发行版运行开箱即用的 servlet 容器。

# events - 拼写 DOM 事件名称时，大小写是否重要？

> ID：445312
> 
> 赞同：0
> 
> 时间：2009-01-15T01:18:07.633
> 
> 标签：events, dom

在 Javascript 中指定 DOM 事件名称时，大小写是否重要？例如，以下哪项将可靠地工作：

1.  鼠标悬停
2.  鼠标悬停
3.  两者都可以。外壳无所谓。
4.  它比这更复杂......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:20:14.463

这取决于。它在 XHTML 中区分大小写。另外，Javascript*总是*区分大小写的。

似乎是 [重复](https://stackoverflow.com/questions/87934/javascript-and-why-capital-letters-sometimes-work-and-sometimes-dont)的。

# apache-flex - 我可以将 Flex 组件属性绑定到函数吗？

> ID：445313
> 
> 赞同：7
> 
> 时间：2009-01-15T01:18:10.333
> 
> 标签：apache-flex, actionscript-3, mxml

我想根据具有一个或多个参数的函数的返回值在按钮上设置***启用属性。***我怎样才能做到这一点？

```
private function isUserAllowed (userName:Boolean):Boolean {
   if (userName == 'Tom')
      return true;
   if (userName == 'Bill')
      return false;
}

<mx:Button label="Create PO" id="createPOButton"
enabled="<I want to call isUserAllowed ('Bill') or isUserAllowed ('Tom') here>"
click="createPOButton_Click()" /> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-15T04:42:37.377

[根据 Flex docs](http://livedocs.adobe.com/flex/3/html/help.html?content=databinding_4.html)，只要属性是可绑定的，您就可以简单地执行此操作（我已经包含了两个额外的按钮来演示）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">

    <mx:Script>
        <![CDATA[

            [Bindable]
            private var currentUser:String = "Bill";

            private function isUserAllowed(user:String):Boolean
            {
                if (user == "Bill")
                {
                    return true;
                }

                return false;
            }

        ]]>
    </mx:Script>

    <mx:VBox>
        <mx:Button label="My Button" enabled="{isUserAllowed(currentUser)}" />
        <mx:HBox>
            <mx:Button label="Try Tom" click="{currentUser = 'Tom'}" />
            <mx:Button label="Try Bill" click="{currentUser = 'Bill'}" />
        </mx:HBox>
    </mx:VBox>

</mx:Application> 
```

但是，如果没有将 currentUser 标记为 [Bindable]，它将无法工作。

另一种方法是，如果您想更直接地绑定到函数（这也在文档中表达），则让函数响应您在当前用户更改时调度的事件，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" initialize="init()">

    <mx:Script>
        <![CDATA[

            private var _currentUser:String = "Bill";

            public function set currentUser(value:String):void
            {
                if (_currentUser != value)
                {
                    _currentUser = value;
                    dispatchEvent(new Event("userChanged"));
                }
            }           

            [Bindable(event="userChanged")]
            private function isUserEnabled():Boolean
            {
                if (_currentUser == "Bill")
                {
                    return true;
                }

                return false;
            }

        ]]>
    </mx:Script>

    <mx:VBox>
        <mx:Button label="My Button" enabled="{isUserEnabled()}" />
        <mx:HBox>
            <mx:Button label="Try Tom" click="{currentUser = 'Tom'}" />
            <mx:Button label="Try Bill" click="{currentUser = 'Bill'}" />
        </mx:HBox>
    </mx:VBox>

</mx:Application> 
```

所以有几种方法。IMO，第二个似乎更合适，但第一个绝对没有错。祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T15:17:28.203

```
<mx:Button
enabled = "{this.myFunction(this.myVariable)}"
> 
```

或内联：

```
<mx:Button
enabled = "{(function(arg:Object):Boolean{ ... })(this.myVariable)}"
> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T02:08:01.557

这是我在类似情况下所做的几次：

```
<mx:Script>
<![CDATA[

    [Bindable] var _username : String;

    private function isUserAllowed (userName:Boolean):Boolean {
        if (userName == 'Tom')
            return true;
        if (userName == 'Bill')
            return false;
    }

]]>
</mx:Script>

<mx:Button label="Create PO"
    id="createPOButton"
    enabled="{isUserAllowed(_username)}"
    click="createPOButton_Click()" /> 
```

这样，当 Bindable`_username`更改时，它将触发更改通知。由于标签正在监听`_username`变化（即使它只是另一个函数的参数），该`enabled`属性将被重新评估。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:46:28.060

```
<mx:Script>
    <![CDATA[
        [Bindable]
        private var userName : String = "Tom"; // or whatever ...
        [Bindable]
        private var userAllowed : Boolean;

        private function isUserAllowed ():Boolean {
           if (userName == 'Tom')
             return false;
           if (userName == 'Bill')
              return false;
           return false;
        }
    ]]>
</mx:Script>

    <mx:Button label="Create PO" id="createPOButton" enabled="{userAllowed}" addedToStage="isUserAllowed()"/> 
```

# c++ - 为什么 snprintf 比 ostringstream 快，还是这样？

> ID：445315
> 
> 赞同：24
> 
> 时间：2009-01-15T01:20:13.370
> 
> 标签：c++, c, performance

我在某处读到 snprintf 比 ostringstream 快。有没有人有任何经验？如果是，为什么它更快。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-15T01:36:25.070

`std::ostringstream`不一定**要**慢，但实现的时候一般比较慢。 [FastFormat 的网站有一些基准](http://www.fastformat.org/performance.html)。

流的标准库设计支持的远不止这些`snprintf`。该设计是可扩展的，并且包括`protected` `virtual`由公开公开的方法调用的方法。这允许您从流类之一派生，并确保如果您重载`protect`ed 方法，您将获得所需的行为。我相信编译器可以避免`virtual`函数调用的开销，但我不知道有任何编译器这样做。

此外，流操作通常在内部使用可增长的缓冲区。这意味着相对较慢的内存分配。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-15T09:39:47.013

我们用 sprintf（使用静态分配的缓冲区）替换了内部循环中的一些字符串流，这在 msvc 和 gcc 中都有很大的不同。我想象这段代码的动态内存管理：

```
{
  字符缓冲区[100]；
  诠释 i = 100;
  sprintf(buf, "%d", i);
  // 用 buf 做一些事情
}

```

比简单得多

```
{
  std::stringstream ss；
  诠释 i = 100;
  ss << 我;
  std::string s = ss.str();
  // 对 s 做一些事情
}

```

但我对 stringstreams 的整体表现非常满意。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-15T04:28:25.830

有些人可能会告诉你，这些函数不能比彼此更快，但它们的实现可以。没错，我想我会同意的。

除了基准之外，您不太可能注意到其他方面的差异。c++ 流通常更慢的原因*是*它们更加灵活。灵活性通常以时间或代码增长为代价。

在这种情况下，C++ 流基于流缓冲区。就其本身而言，流只是保持格式和错误标志到位的外壳，并调用`i/o`c++ 标准库的正确方面（例如，num_put 来打印数字），将格式正确的值打印到底层流中 -连接到 c++ 流的缓冲区。

所有这些机制——分面和缓冲区，都是由虚函数实现的。虽然确实没有标记*说明，但必须将这些函数实现为比 c stdio 挂件慢*，事实上这会使它们比通常使用 c stdio 函数慢一些（我前段时间用 gcc/libstdc++ 进行了基准测试，实际上注意到了减速 - 但您在日常使用中几乎没有注意到）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T01:37:49.887

绝对这是特定于实现的。

但是如果你真的想知道，写两个小程序，对比一下。您需要包含您所想的典型用法，这两个程序需要生成相同的字符串，并且您将使用分析器来查看时间信息。

那你就知道了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T09:26:59.083

一个问题可能是添加的类型安全会`ostringstream`带来额外的开销。不过，我没有做过任何测量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T01:36:10.593

很有可能，因为`sprintf`它是用汇编语言编写的 CRT 的一部分。这`ostringstream`是 STL 的一部分，可能写得更通用一些，并且有 OOP 代码/开销要处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T14:37:58.050

正如[litb 所说](https://stackoverflow.com/questions/445315/why-is-snprintf-faster-than-ostringstream-or-is-it#445637)，标准流支持许多我们并不总是需要的东西。一些流实现摆脱了这种从未使用过的灵活性，例如参见[FAStream](http://www.msobczak.com/prog/fastreams/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-12T01:56:16.713

是的，如果您使用 Visual C++ 5.0 对几百万个数字运行下面的函数，第一个版本所需的时间大约是第二个版本的两倍，并且产生相同的输出。

将紧密循环编译成 .exe 并运行 Windows`timethis something.exe' or the Linux`时间是我调查我的大部分性能好奇心的方式。（`timethis' 可以在网上某处获得）

```
void Hex32Bit(unsigned int n, string &result)
{
#if 0
    stringstream ss;
    ss
        << hex
        << setfill('0')
        << "0x" << setw(8) << n
    ;
    result = ss.str();
#else
    const size_t len = 11;
    char temp[len];
    _snprintf(temp, len, "0x%08x", n);
    temp[len - 1] = '\0';
    result = temp;
#endif
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-15T01:50:53.543

我知道 printf 系列函数比相应的 C++ 函数（cout、cin 和其他流）更快的一个原因是后者进行类型检查。由于这通常涉及对重载运算符的一些请求，因此可能需要一些时间。

事实上，在编程比赛中，正是出于这个原因，通常建议您使用 printf 等而不是 cout/cin。

# project-management - 您是否曾经必须提交“TPS 报告”？

> ID：445326
> 
> 赞同：2
> 
> 时间：2009-01-15T01:25:21.817
> 
> 标签：project-management, policy

不，不是[字面意思](http://en.wikipedia.org/wiki/TPS_report)。相反，您是否有任何繁文缛节的恐怖故事影响了您生产优质软件的能力？我不是在谈论像[这个问题](https://stackoverflow.com/questions/195285/what-stupid-policies-affecting-developers-has-your-company-introduced)这样的一般人力资源或系统管理政策，而是直接针对开发过程的政策，例如糟糕的源代码控制政策、测试程序或错误跟踪过程。

拜托，没有诸如缩进与空格或支撑样式之类的圣战，而是令人讨厌的官僚主义的例子，例如[传说](http://chrisglass.com/journal/downloads/TPSreport.pdf)中的 TPS 报告。

这与我有些相关，因为我一直在审查我的团队的开发过程，并且我希望看到（作为上下文）您必须处理的一些最糟糕的过程。结构化的政策或流程何时会走得太远？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T01:47:34.127

我确实为我工作的其中一个系统提交了 TPS 报告：http: [//tps.tmccom.com/](http://tps.tmccom.com/)

是的，我非常清楚该网站的过时和非标准化程度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T02:19:13.157

作为承包商，我经常不得不提交三份单独的时间和费用报告。

1.  我们用于开发票的官方报告。

2.  我们特定于项目的细粒度报告。它必须与总发票报告相匹配。而且，项目经理可以在发票数字前两周使用它。

3.  出客户的活动报告。这些也必须与总发票相匹配。客户的会计人员需要这个来确认我们的发票。等等，我不是也创建了发票吗？

我们不要忘记需要两个状态报告（我们的和客户的）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T02:28:19.223

不，但几年前我为阿拉巴马州编写了大部分 MLI（强制性责任保险）系统......

系统生成的每个报告都是 TPS 报告 :)

例如每月交易 TPS 报告、每日交易量 TPS 报告等。

最有趣的是，该州有人打电话给我们询问 TPS 报告 :) 我认为他们从来没有弄清楚为什么他们被称为 TPS 报告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T02:20:51.767

在过去的几年里，我们必须填写一张由一线主管签署的请假单，以便请病假或休假。

最近，我们获得了访问一个精美的 Web 应用程序的权限。它允许工人请求休假，并允许主管批准休假。它汇总到我们的时间表中，是我们工资系​​统的基础。

尽管在推出新的请假系统方面取得了巨大成功，但我们的办公室经理仍然要求我们提交纸质请假单，*除了在线*提交。

办公室经理花了几个月的时间才意识到新系统提供的监督与手动系统一样多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T02:37:11.157

在一家大型旧计算机公司的前一份工作中，我们有一个 CRT 流程。我不会说这是一个非常糟糕的想法，因为该软件产品涉及高可用性计算，因此非常规避风险。但这有时很烦人，并且肯定会减慢开发速度。

基本上，该系统是在让 3 个人对您的代码进行同行评审后，您填写了 CRT 表单（在某些时候我将其转换为 Web 应用程序）。

CRT（变更请求团队）每周会审查所有请求数次，并与管理层、团队负责人和相关编码人员讨论，以确保所有环节都已通过：所有编写的测试......适当的人已经审查它... QA 通知了新的测试...等。

值得庆幸的是，Web 应用程序版本得到了很好的接受，并且非常详细且超出顶部的旧手动表单已被删除。至少从我们的组织...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-31T06:38:10.573

我目前必须在三个独立的实用程序中概述我的时间：

*   我以高水平输入我的时间（咨询时间 vs. 假期 vs. 假期 vs. 生病等），为期一周，显示每天的工作时间。这是为客户计费的。

*   客户有一个他们刚刚推出的时间跟踪系统，我们必须在请求级别输入我们的时间。与客户相关的事情（会议、培训等）的管理时间有它自己的通用存储桶。不可计费的项目有另一个。这个为期一个月，显示每周的小时数。

*   我的公司还有一个时间跟踪工具，详细说明我们在一周内所做的一切。时间以一刻钟为单位进行跟踪，并且粒度非常细。即“对于请求 12345，我花了 0.25 小时编写估算，0.50 小时编写需求文档，0.50 小时编码文件 x。” 在我们将任何内容发送给客户以供批准之前（早在任何内容被编码之前），还必须将估算值输入系统并有效锁定（瀑布 FTL！）。

我们也有一个非常严格的同行评审过程。我们发送给客户的任何官方文件（需求文档、变更请求、代码等）都必须先经过同行评审。客户还有一个变更控制委员会，该委员会每周开会一次，以批准将安装到生产中的任何东西。

我曾经向一些大学朋友解释过我的工作有多少过程和偏执。到最后，我发现假设情况（在非紧急、非生产支持情况下），在考虑了所有过程之后，在现有报告中添加单个字段的估计值，在 ABSOLUTE MINIMUM 上花费了 3 个小时，这基本上是在现有的 select 语句中添加一个字段（或者类似的东西，因为我们使用了一个不使用 SQL 进行 DB 查询的工具）。此外，由于对此的估计是如此之小（因为三个小时仅代表每个所需项目所需的最少 0.25 小时，加上生产变更控制会议的半小时），我需要让我的团队领导先签字，因为我

**叹**

我想今天的吐槽就够了。

# silverlight - 在 Silverlight 中，如何通过坐标确定鼠标下方当前是什么对象？

> ID：445329
> 
> 赞同：1
> 
> 时间：2009-01-15T01:27:35.757
> 
> 标签：silverlight

我有 object1 作为 Canvas 的孩子。object1 具有捕获对象的 MouseLeftButtonDown 事件处理程序。

```
object1.CaptureMouse(); 
```

在仍然按住鼠标左键的同时，我将鼠标移到 object2 上。在代码中，我如何确定鼠标是否真的在 object2 上（或确定它当前在哪个对象上）？

据我所知，我不能使用 object2 的鼠标事件处理程序，因为在调用 object1 的 ReleaseMouseCapture() 方法之前，对 object1 的 CaptureMouse() 方法的调用会禁用其他鼠标事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T04:25:41.717

您将需要使用**System.Windows.VisualTreeHelper**：

**VisualTreeHelper.FindElementsInHostCoordinates**将“检索位于对象坐标空间的指定点内的一组对象。”

该函数有两种重载，一种采用 Point，另一种采用 Rect。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T01:42:53.420

您说得对，“CaptureMouse()”调用将阻止其他鼠标事件的发生。

如果您随后挂钩 object1 的 MouseMove 事件，您可以使用传递给该事件处理程序的事件参数来确定鼠标当前的位置，从而确定它相对于您关注的其他对象的坐标的位置。

本文并未完全涵盖您想要的内容，但有一些内容可能有助于您弄清楚您正在尝试做什么：

[http://jesseliberty.com/2009/01/13/drag-and-drop-with-managed-code/](http://jesseliberty.com/2009/01/13/drag-and-drop-with-managed-code/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T02:03:15.903

那篇文章有点帮助，所以谢谢你。然而，它是这样的：

“您可以使用传递给该事件处理程序的事件参数来确定鼠标当前的位置，从而确定它相对于您关注的其他对象坐标的位置。”

...我试图确定。

我可以得到鼠标的当前位置。我不知道该怎么做是获取新对象（object2）的坐标，然后确定当前鼠标位置是否在“内部”object2。

在 Shape 的情况下，通过查看 Shape 的剪辑几何图形可能会找到解决方案，但在我的情况下 object2 是 Canvas ，因此不太有效。

# .net - .NET 属性的历史前身是什么？

> ID：445332
> 
> 赞同：5
> 
> 时间：2009-01-15T01:28:19.517
> 
> 标签：.net, attributes, computer-science, history

哪些语言或平台影响了 .NET 1.0 团队从一开始就内置了属性的概念？这是面向方面的事情吗？序列化？或者是其他东西？当时我还在 VB6 领域，从未使用过任何 1.0 之前的 .NET 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:31:15.017

我不知道这是否是鼻祖，但他们在 COM 和 MIDL 中已经存在很长时间了。没有用户定义的，但您必须对方法、类型等进行属性化，才能对 MIDL 中的合同做出具体声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T04:41:17.007

信不信由你来自 VB 和 Microsoft Transaction Server/COM+ 开发团队的经验/反馈在 .NET、属性和元数据的一些设计原理中有所作为。

VB6 添加了对 COM+/MTS 可以读取并确定对象应如何表现的属性/元数据的支持。还记得类中的所有设置，例如“需要事务”、“需要新事务”等吗？它们实际上是面向方面的属性。有一个很棒的 Don Box 采访关于这一切的某个地方，当我再次找到它时，我会发布一个链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T01:32:21.753

德尔福/对象帕斯卡属性？如果我没记错的话，Delphi 的设计者之一也是.NET 的设计者之一。语法也类似。

# frameworks - 依赖项应该在命名空间树中向上还是向下？

> ID：445335
> 
> 赞同：2
> 
> 时间：2009-01-15T01:30:51.757
> 
> 标签：frameworks, namespaces

在一个框架中，类依赖关系应该顺着命名空间（根到叶）还是顺着命名空间（把它想象成一个根在顶部的倒树）？

我很难描述这一点，所以让我们看一个例子：

```
namespace foo
{
  class snafu : fubar {}
}

namespace foo.bar
{
  class tarfu : snafu {}

  class fubar {}
} 
```

在这种情况下，类`tarfu`有一个基类依赖于`snafu`. 依赖关系沿着命名空间树向上走。类`snafu`有一个基类依赖于`fubar`. 依赖关系沿着命名空间树向下走。

依赖项应该只沿着命名空间树走吗？还是应该反过来？为什么要重要？

我正在.NET 中开发，但如果它与其他平台不同，我也会有兴趣了解这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:36:12.760

由于您使用的是 .NET，我强烈建议您遵循 .NET 框架的约定。这将使您的代码与框架保持一致。

所以这意味着你应该这样做：

```
namespace First
{
    class Parent { }
}

namespace First.Second
{
    class Child : First.Parent { }
} 
```

澄清一下，你做什么并不重要，因为 C# 编译器只是将所有命名空间附加到类型名称以创建一个更长的类型，它更有可能是唯一的。这就是为什么我认为最好避免混淆并坚持惯例。

# jquery - 尝试使用 VB.Net 返回 asp.net mvc JSONResult

> ID：445381
> 
> 赞同：2
> 
> 时间：2009-01-15T01:56:28.307
> 
> 标签：jquery, asp.net-mvc, vb.net, json

我正在尝试从 LINQ2SQL 返回一条记录作为 JsonResult 以通过 jquery ajax 更新我的视图页面。我将在下面发布我的代码。当我通过调试器跟踪它时，控制器中的函数被调用并返回一条记录。我认为我的 Jquery 检索 JSONResult 可能有问题。有任何想法吗？

看法：

```
<a href="#" onclick="getProject(<%=project.ID%>)"><img src="<%=project.ThumbPath%>" alt="<%=project.Title%>" /></a> 
```

控制器：

```
 Function DisplayProjectAjax(ByVal id As Integer) As JsonResult
        Dim project = From p In db.Projects Where p.ID = id
        Return Json(project)
    End Function 
```

查询：

```
<script type="text/javascript">
    function getProject(id) {
        $(document).ready(function() {
            $.getJSON("/Portfolio/DisplayProjectAjax/" + id,
          {},
          function(data) {
              $("#Title").Text(data.Title);
          });
        }); 
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T02:13:11.783

尝试：

```
$("#Title").text(data.Title); 
```

或者

```
$("#Title").html(data.Title); 
```

注意外壳......此外，像[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)这样的东西会有所帮助。您可以查看网络和控制台选项卡并查看您的所有请求，以及非常轻松地调试您的 Javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T03:56:27.237

您的查询结果是一个 IEnumerable，即使只有一个，它也可能被序列化为一个 Project 对象数组。我的 VB 语法可能很糟糕，但选择了所选对象的 First()。

```
return JsonResult( person.First() ); 
```

我想你也需要@JD Conley 的修复。

# c++ - 如何从 Solaris 系统以 C/C++ 编程方式获取进程信息？

> ID：445382
> 
> 赞同：2
> 
> 时间：2009-01-15T01:56:34.607
> 
> 标签：c++, c, process, solaris, system

是否有 C/C++ 库以及有关如何在 Solaris 上收集系统和进程信息的文档？

虽然我可以解析命令行工具，但我宁愿使用一个使任务更容易完成的库。

谢谢

**编辑：**建议使用 /proc 虚拟目录来收集信息，但它并不比解析命令行工具好多少，因为我需要为我的每条数据实现某种自定义解析需要。

我正在寻找类似于 Windows 或 MacOS 的 c 库的东西，它通过基于 c 的系统 API 提供此信息，但是我对谷歌没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:11:21.513

You can get this kind of information with [kstat API](http://developers.sun.com/solaris/articles/kstatc.html).

```
man -s 3KSTAT  kstat 
```

You can see how it is used in OpenSolaris [vmstat](http://cvs.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/cmd/stat/vmstat/) and [iostat](http://cvs.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/cmd/stat/iostat/iostat.c) source.

For information about processus, I'd look at [ps](http://cvs.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/cmd/ps/ps.c).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T03:01:16.443

Solaris has the [/proc virtual directory](http://en.wikipedia.org/wiki/Procfs), which allows you to gather all sorts of information about processes using filesystem I/O functions.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T03:12:47.357

I would use the /proc virutal dir as CrashWorks has suggested. I've done this on both aux and linux. One thing to keep in mind is when I did use the /proc dir on linux the format of the files varied from one kernel to another.

I don't know what the situation is like on the Solaris side but this could mean that your solution will not be portable from one solaris platform to another.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T03:42:28.887

what about `getrusage()`?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T02:45:23.650

我绝对不是这方面的专家，但我在上学期的一项作业中做了非常相似的事情，当时我们需要对流程进行快照。不幸的是，这种方法需要深入研究内核，这可能不是您想要做的。

我发现这篇[文章](http://linuxgazette.net/112/krishnakumar.html)很有帮助。

无论如何，这里有一些片段。

```
 write_lock_irq(&tasklist_lock);
  for_each_process(task) {

    if (system_or_user == 0)
      print_mem_user(task);
    if (system_or_user == 1)
      print_mem_system(task);
  }
  write_unlock_irq(&tasklist_lock); 
```

您需要锁定某些数据结构或有时内核会挂起的想法。“for_each_process”是在某处定义的宏，但我不记得它是如何工作的 D：

```
static void print_mem_system(struct task_struct *task)
{
  struct mm_struct *mm;

  if (task -> mm == NULL){ // this is how you distinguish system processes from user processes
    myarraypid[totalnumberofprocesses] = task -> pid; // store process id's into myarraypid[], which you can later copy back to user space for printing/display. Additional information would be found in a "task_struct" which is Linux's implementation of a process. 

  }

} 
```

我的一些同学采取了不同的方法，并深入研究了“ps”实用程序的源代码。我相信我正在使用 Linux 2.6.18-92.1.13.e15。免责声明：这对我有用，但您的里程可能会有所不同。我很可能会走投无路，我不想把你引向错误的方向。

# ruby-on-rails - 分离演示/网络服务

> ID：445383
> 
> 赞同：2
> 
> 时间：2009-01-15T01:56:55.637
> 
> 标签：ruby-on-rails, architecture, glassfish, jax-ws, java-metro-framework

在两台不同的服务器上以两种不同的语言开发 Web 服务和网站是一种好习惯吗？例如，现在我创建了一个运行在 Glassfish 和 Ruby on Rails 表示层上的 Java Web 服务，这些表示层运行在同一台服务器上。

我想将 Web 服务留在同一台服务器上，但使用在 Passenger 中运行的 Ruby 1.9。

这是个好主意吗？我没有网络应用程序架构的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T02:06:34.573

如果您编写一个使用和生成 XML 的合同优先 Web 服务，您可以与任何可以以适当格式发出 HTTP GET 或 POST 请求的客户端通信。SOAP 或 REST，没关系。

我编写了以 XSD 开头的 Java/Spring Web 服务。一个 Yahoo UI RIA 客户端采用 WSDL，创建一个 HTTP POST 来发送请求文档，并在一个漂亮的数据网格中显示 XML 响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:33:16.187

从技术上讲，是的，您肯定可以做到这一点。这是使用 WS 的优势之一。它们是可互操作的。

但是，如果其他人要维护它并且仅在两个平台（RoR 或 Java）中的一个方面具有专业知识，我会考虑这个想法。最好总是问:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T13:36:38.923

就系统的架构而言，是的，这是一个“好的做法”。好的，我的意思是它实现了目标，没有伤害，并强制分离关注点。

我一直在开发具有类似结构的架构。用户界面是 .NET 并使用 Java Web 服务。然后，该 Web 服务负责与持久性媒体、第三方组件等的所有交互。

我想说在任何系统中，您都应该努力从业务逻辑中抽象出您的用户界面逻辑。这只是很好的关注点分离。使用 Web 服务来做到这一点只是实现该目标的*一种方式。*如果您将在系统的其他用例中重用这些业务服务，我建议您使用 Web 服务。

还有一件事; 在过去 8 年中在 UI 和 WS 上使用了两种不同的技术之后，我了解到大多数挑战是组织性的，而不是技术性的。例如，很难找到同时具备维护应用程序所需的两种技能的新开发人员。你最终不得不找到一位专家，然后对他们进行另一种技术的培训。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-06T13:51:44.607

这取决于它们的相似程度。

如果您的 Web 服务基本上在功能上反映了您的网站 - 那么重用现有代码并因此在同一台服务器上使它们成为相同的东西是很有意义的。

注意 - 这与纠缠层不同，因为您的视图仍然与您的业务逻辑分开。

从 Ruby-on-Rails 的角度来看，“Web 服务”和“网站”通常可以互换，因为它们是完全相同的代码，只是视图模板不同（网站的 html，Web 服务的 xml） . 如果您从一开始就考虑使用 RESTful 架构进行构建，那么您可以通过最少的重复和正确解耦所有应用程序层来实现这一点。

# c# - 使用 firebird RDBMS 在 .NET 应用程序中自动刷新数据

> ID：445394
> 
> 赞同：3
> 
> 时间：2009-01-15T02:04:27.243
> 
> 标签：c#, .net, database, firebird

我正在开发一个具有自动刷新功能的 .NET 应用程序。我数据库中的每个表都有一个 MODIFIED_DATE 列，在每次更新或插入后都会更新。目前，自动刷新功能仅适用于一张表，但将来可能会发生变化。我目前正在考虑以下可能的解决方案：

1.  客户端应用程序在计时器上运行一次查询，例如每 10 秒一次，并带回 MODIFIED_DATE 大于存储在我的应用程序中的上次修改日期的所有行。

2.  在每台侦听 firebird 事件的客户端计算机上保持一个专用的开放连接，然后在触发事件后运行查询。该事件显然会在每次使用 POST_EVENT 命令更新/插入后由数据库触发。

3.  开发一个服务，该服务将位于服务器上，侦听 firebird 数据库事件，然后使用 .NET 远程处理来通知客户端应用程序。

谁能告诉我上述哪种解决方案在性能和可扩展性方面更好？

我希望解决方案对数据库工作负载的影响最小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T04:08:07.353

实际上，Firebird 的一个不错的特性是能够编写用户定义函数 (UDF)，您可以直接从触发器调用 UDF，而 UDF 可以反过来通知您的应用程序（使用标准进程间通信）发生了更新，这个然后成为通知模型而不是轮询模型并且更具可扩展性。

警告：UDF 需要是本机 dll（我相信）C++ 或 Delphi，Delphi 中很可能会有相当多的示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:30:26.237

1.  该解决方案在可扩展性方面是最差的。大多数情况下，客户会查询更改而一无所获。大浪费。更不用说更改出现在客户端中的 10 秒延迟。
2.  我过去曾这样做过，并且也遇到了一些可伸缩性问题。问题是，当触发事件时，每个客户端都会立即查询服务器。不是很好。您可能需要创建一些方案来防止这种情况。
3.  基本上与2相同，只是涉及更多的工作。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T21:38:36.653

对答案 2 稍作修改：

1.  您可以使用任何可以创建共享库的语言创建 UDF（Java 除外）
2.  如果您正在运行 Netware，则无法从 Firebird 调用 UDF

# php - Zend Framework：与数据库交互的正确方法？

> ID：445399
> 
> 赞同：10
> 
> 时间：2009-01-15T02:07:35.817
> 
> 标签：php, mysql, database, zend-framework, zend-db-table

我对 Zend Framework 和 MVC 还很陌生，我对 Zend_DB 以及与数据库交互的正确方式有点困惑。

我正在使用 PDO MySQL 适配器并创建了一些类来扩展抽象类：

```
class Users extends Zend_Db_Table_Abstract {
    protected $_name = 'users';
    protected $_primary = 'user_id';
    protected $_rowClass = 'User';

    public function getUserbyID($id) { /* code */ }
    // More code here
}
class User extends Zend_Db_Table_Row_Abstract {
    // Code here
}
class Widgets extends Zend_Db_Table_Abstract {
    protected $_name = 'widgets';
    protected $_rowClass = 'Widget';

    public function getWidgetsfromUser($userid) { /* code */ }
    // More code here
}
class User extends Zend_Db_Table_Row_Abstract {
    public function doSomethingWithWidget() { /* code */ }
    // More code here
} 
```

似乎有很多方法可以访问数据库（fetchAll()、find()、fetchAll() 通过适配器、insert()、createRow() 和 save()、select() 对象），我总是发现自己要回去让文档弄清楚我应该做什么。

SO 教会了我准备好的语句是要走的路，我一直在尝试使用行集和行（我应该是吗？），但我仍然**对与数据库交互的最佳方式感到困惑？**

（为这个非常开放的问题道歉）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T02:37:26.257

一般来说，人们更喜欢通过 Table 和 Row 对象来访问数据库，以符合他们面向对象编程的习惯。

如果您需要编写代码来转换或验证查询输入或输出，OO 方法很有用。您还可以在 Table 或 Row 类中编写自定义方法来封装经常需要的查询。

但是面向对象的接口被简化了，无法执行您可能需要执行的所有类型的数据库操作。`query()`因此，`fetchAll()`当您需要更好地控制 SQL 时，您可以更深入地研究并针对 Zend_Db_Adapter 方法运行 SQL 查询。

这对于数据库的面向对象接口非常常见。*一个可以复制每个*SQL 特性的 OO 层会非常复杂。因此，为了妥协，OO 层通常会尝试提供简单的方法来完成最常见的任务，同时让您能够在必要时进行隐藏。

这是对您非常普遍的问题的非常普遍的回答。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-15T02:35:45.263

使用 Zend_Db，您可能不想了解准备好的语句等的细节。您只想使用模型对象来执行基本的 CRUD（创建、读取、更新和删除）。我知道[Programmer's Reference Guide](http://framework.zend.com/manual/en/zend.db.html)内容广泛，但它是对 Zend_Db 的一个很好的介绍。您可能需要仔细查看[Zend_Db_Table](http://framework.zend.com/manual/en/zend.db.table.html)文档。

但是要快速回答您的问题。除非您需要覆盖某些默认行为，否则您不需要扩展 Zend_Db_Table_Row_Abstract。您也可以将 Users 类简化为：

```
class Users extends Zend_Db_Table_Abstract {
  protected $_name = 'users';

  // Code here
} 
```

然后要使用它，您将使用以下方法执行您提到的一些事情：

```
//Create a Users Model Object
$usersDb = new Users();

//Find the record with user_id = 4 and print out their name
$row = $usersDb->find(4);
echo $row->first_name . ' ' . $row->last_name

//Change the first name of this user to Brian    
$row->first_name = 'Brian';
$row->update();

//Insert a user into the database
$data = array(
  'first_name' => 'Gilean',
  'last_name' => 'Smith');
$usersDb->insert($data);

//Retrieve all users with the last name smith and print out their full names
$rows = $usersDb->fetchAll($usersDb->select()->where('last_name = ?', 'smith'));    
foreach ($rows as $row) {
  echo $row->first_name . ' ' . $row->last_name
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T22:38:11.120

我建议使用保存方法。

```
//Create a Users Model Object
$usersDb = new Users();

//Find the record with user_id = 4 and print out their name
$row = $usersDb->find(4);
echo $row->first_name . ' ' . $row->last_name

//Change the first name of this user to Brian    
$row->first_name = 'Brian';
$row->save();

//Insert a user into the database
$newUser = $usersDb->fetchNew();
$newUser->first_name = 'Gilean';
$newuser->last_name  = 'Smith';
$newUser->save();

// OR if you get your data from post or any array
$newUser = $usersDb->fetchNew();
$newUser->setFromArray($data_from_post);
$newUser->save(); 
```

我更喜欢这种方法的原因是因为这就是为什么你总是有一个用户模型的实例并且你可以在其中拥有自定义方法（例如 isAdmin），还因为你可能想要覆盖 userRow 上的保存/插入/更新功能在插入/更新之前做一些事情。

# html - 不同的 div 2 列布局

> ID：445401
> 
> 赞同：2
> 
> 时间：2009-01-15T02:08:16.940
> 
> 标签：html, css, css-float

这与简单的 2 列布局不同。

我需要这个html：

```
<div class="menu">
    <div class="right">One</div>
    <div>Three</div>
    <div>Four</div>
    <div class="right">Two</div>
    <div class="right">Two</div>
    <div>Four</div>
    <div class="right">Two</div>
</div> 
```

div 类菜单具有静态宽度，我需要其中的 div 进入右列，而普通 div 保持原样。

这是我到目前为止得到的 CSS，但我似乎还无法弄清楚：

```
div.menu {
    width: 550px;
}
div.menu div {
    float: left;
    width: 200px;
}
div.menu div.right {
    float: right;
} 
```

里面的 div 有随机顺序，所以我不能将它们包含在一个 div 中并浮动它。

这是上面 HTML 代码的粗略草图：

[替代文字 http://img102.imageshack.us/img102/4494/flytc3.jpg](http://img102.imageshack.us/img102/4494/flytc3.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T03:14:14.310

尝试：

```
div.menu div {
    float: left;
    clear: left;
}
div.menu div.right {
    float: right;
    clear: right;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:19:53.157

我似乎无法弄清楚你想要达到什么目的。您能否在 MS Paint 或其他东西中创建一些基本草图，以便我们为您提供帮助？

**编辑**：也许我在这里不明白，但这正是它在我的 Chrome 窗口中的外观（嗯，除了填充物）。

# apache - 如何将请求重定向到站点根目录上方的特定文件？

> ID：445407
> 
> 赞同：2
> 
> 时间：2009-01-15T02:13:06.570
> 
> 标签：apache, .htaccess, mod-rewrite, virtual-hosts

我正在启动一个新网站，但在执行我想要的文件/文件夹组织时遇到了困难：

为了论证起见，假设我的网站将托管在： http: [//mywebsite.com/](http://mywebsite.com/)

我想（已设置）Apache 的虚拟主机将[http://mywebsite.com/](http://mywebsite.com/)映射到 /fileserver/mywebsite_com/www 文件夹。

当我决定将一些文件（favicon.ico 和 robots.txt）放入 Apache 正在将[http://mywebsite.com/](http://mywebsite.com/)挂载到/www 之上的文件夹中时，问题就出现了

```
robots.txt+favicon.ico go into => /fileserver/files/mywebsite_com/stuff 
```

因此，当人们访问[http://mywebsite.com/robots.txt](http://mywebsite.com/robots.txt)时，Apache 会为他们提供来自 /fileserver/mywebsite_com/stuff/robots.txt 的文件

我试图通过 mod_rewrite 设置重定向，但唉：

```
RewriteRule ^(robots\.txt|favicon\.ico)$ ../stuff/$1 [L] 
```

对我没有好处，因为基本上我是在告诉 apache 提供高于其已安装根​​目录的内容。

是否有可能通过以不同方式设置 Apache 的（2.2.9）虚拟主机或定义某种 RewriteMap 来实现所需的功能，而不是将相关 URL 重写为其他 URL，而是改写为系统文件路径？如果不是，那么所需组织（如果有的话）的首选行动方案是什么？

我知道我可以通过 PHP 访问前面提到的文件，然后将它们流式传输——比如使用 readfile(..)，但我想让 Apache 做尽可能多的工作——它肯定比做 I/O 更快通过 PHP。

非常感谢，这已经剥夺了我几个小时的建设性工作。更不用说可怜的 Apache 每隔几分钟就会重新启动一次。想想可怜的阿帕奇:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T15:53:26.193

看来您已设置为使用 RewriteRule。但是，我建议您使用别名：

```
Alias /robots.txt /fileserver/files/mywebsite_com/stuff/robots.txt 
```

此外，您必须告诉 Apache 该文件的限制。如果您有多个文件以这种方式处理，请对完整目录执行此操作：

```
<Directory /fileserver/files/mywebsite_com/stuff>
    Order allow,deny
    Allow from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T02:21:00.190

你可以使用符号链接吗？

```
ln -s /fileserver/files/mywebsite_com/stuff/robots.txt /fileserver/files/mywebsite_com/stuff/favicon.ico /fileserver/mywebsite_com/www/ 
```

（`ln`就像`cp`，但创建符号链接而不是副本`-s`。）

# c# - 如何通过没有 IP 地址的网卡发送 WOL 包（或任何东西）？

> ID：445411
> 
> 赞同：7
> 
> 时间：2009-01-15T02:15:28.453
> 
> 标签：c#, network-programming, network-protocols, ethernet, winpcap

我正在尝试在所有接口上发送 WOL 包以唤醒网关（这是 DHCP 服务器，因此机器还没有 IP）。

而且似乎我只能将套接字绑定到 IP 和端口对......

所以问题是：如何创建一个绑定到没有 IP 的 NIC 的套接字（或其他东西）？（任何语言都可以。首选c#）

@ctacke：我知道 WOL 是由 MAC 地址完成的......我的问题是 Windows 只在 Windows 认为是主 NIC 的 NIC 上发送 UDP 广播（它甚至不是我的 Vista 机器上具有默认路由的 NIC ）。而且我似乎找不到将套接字绑定到没有 IP 地址的接口的方法。（就像 DHCP 客户端一样）

@Arnout：为什么不呢？客户端知道网关的 MAC 地址。我只想像 DHCP 客户端最初那样发送一个 WOL 数据包......（DHCP 发现数据包声称来自 0.0.0.0）我不介意我是否必须逐字节构造整个数据包......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T16:24:51.437

看来我找到了解决办法。可以使用 winpcap 将数据包注入任何接口。.net 有很好的包装：[http ://www.tamirgal.com/home/dev.aspx?Item=SharpPcap](http://www.tamirgal.com/home/dev.aspx?Item=SharpPcap)

（我更喜欢不需要安装额外库的解决方案......）

**更新：**这是我在所有接口上发送 WOL 数据包的方法：

```
//You need SharpPcap for this to work

private void WakeFunction(string MAC_ADDRESS)
{
    /* Retrieve the device list */
    Tamir.IPLib.PcapDeviceList devices = Tamir.IPLib.SharpPcap.GetAllDevices();

    /*If no device exists, print error */
    if (devices.Count < 1)
    {
        Console.WriteLine("No device found on this machine");
        return;
    }

    foreach (NetworkDevice device in devices)
    {
        //Open the device
        device.PcapOpen();

        //A magic packet is a broadcast frame containing anywhere within its payload: 6 bytes of ones
        //(resulting in hexadecimal FF FF FF FF FF FF), followed by sixteen repetitions 

        byte[] bytes = new byte[120];
        int counter = 0;
        for (int y = 0; y < 6; y++)
            bytes[counter++] = 0xFF;
        //now repeat MAC 16 times
        for (int y = 0; y < 16; y++)
        {
            int i = 0;
            for (int z = 0; z < 6; z++)
            {
                bytes[counter++] =
                    byte.Parse(MAC_ADDRESS.Substring(i, 2),
                    NumberStyles.HexNumber);
                i += 2;
            }
        }

        byte[] etherheader = new byte[54];//If you say so...
        var myPacket = new Tamir.IPLib.Packets.UDPPacket(EthernetFields_Fields.ETH_HEADER_LEN, etherheader);

        //Ethernet
        myPacket.DestinationHwAddress = "FFFFFFFFFFFFF";//it's buggy if you don't have lots of "F"s... (I don't really understand it...)
        try { myPacket.SourceHwAddress = device.MacAddress; }
        catch { myPacket.SourceHwAddress = "0ABCDEF"; }//whatever
        myPacket.EthernetProtocol = EthernetProtocols_Fields.IP;

        //IP
        myPacket.DestinationAddress = "255.255.255.255";
        try { myPacket.SourceAddress = device.IpAddress; }
        catch { myPacket.SourceAddress = "0.0.0.0"; }
        myPacket.IPProtocol = IPProtocols_Fields.UDP;
        myPacket.TimeToLive = 50;
        myPacket.Id = 100;
        myPacket.Version = 4;
        myPacket.IPTotalLength = bytes.Length - EthernetFields_Fields.ETH_HEADER_LEN;           //Set the correct IP length
        myPacket.IPHeaderLength = IPFields_Fields.IP_HEADER_LEN;

        //UDP
        myPacket.SourcePort = 9;                
        myPacket.DestinationPort = 9;           
        myPacket.UDPLength = UDPFields_Fields.UDP_HEADER_LEN;

        myPacket.UDPData = bytes;
        myPacket.ComputeIPChecksum();
        myPacket.ComputeUDPChecksum();

        try
        {
            //Send the packet out the network device
            device.PcapSendPacket(myPacket);
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }

        device.PcapClose();
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-10T09:11:30.863

WOL 是一种非常灵活的协议，可以以多种不同的方式实现。

**最常见的是：**

*   发送 WOL 作为以太网数据包的有效负载。
*   发送 WOL 作为 UDP 数据包的有效负载（用于通过网络路由）。

一旦它登陆本地网络，它就会使用广播 MAC 地址传递给网络上的所有主机。

**对于以太网数据包，其结构为：**

*   目标 MAC：FF:FF:FF:FF:FF:FF（广播）
*   魔术包有效负载

**对于 UDP 数据包，结构为：**

*   目标 MAC：FF:FF:FF:FF:FF:FF（广播）
*   UDP 端口：9
*   魔术包有效负载

**魔术有效载荷包括：**

*   同步流：FFFFFFFFFFFF（即 6 对或 6 个字节的 FF）
*   您向 WOL 发送信号的计算机 MAC 的 16 个副本
*   0、4 或 6 个字节的可选密码。

**从互联网接收 WOL 数据包（通过防火墙/路由器）：**

*   配置路由器端口9转发到IP 255.255.255.255（广播IP）
*   设置目的IP：路由器的外网IP

*注意：这只能使用 UDP 示例来实现，因为以太网数据包缺少通过 Internet 路由数据包所需的 IP 层。IE，以太网数据包是本地网络唯一选项。通过 UDP 发送 WOL 数据包的问题是安全性，因为您必须将路由器设置为启用 IP 广播 (255.255.255.255)。启用 IP 广播通常被认为是一个坏主意，因为会增加网络内部攻击的风险（Ping 泛洪、缓存欺骗等）。*

有关协议的更多信息，包括样本捕获，请参阅[此站点](http://wiki.wireshark.org/WakeOnLAN)。

如果您想要一个生成 WOL 数据包的快速而简单的命令行工具（并且您在 debian、linux mint 或 Ubuntu 上运行），您可以安装一个已经执行此操作的工具。

只需使用命令行安装：

```
sudo apt-get install wakeonlan 
```

**更新：**

**这是一个使用当前版本的 SharpPcap 生成 WakeOnLan 数据包的工作示例。**

```
using System;
using System.Collections.Generic;
using System.Net.NetworkInformation;
using PacketDotNet;
using SharpPcap;

namespace SharpPcap.Test.Example9
{
    public class DumpTCP
    {
        public static void Main(string[] args)
        {
            // Print SharpPcap version
            string ver = SharpPcap.Version.VersionString;
            Console.WriteLine("SharpPcap {0}, Example9.SendPacket.cs\n", ver);

            // Retrieve the device list
            var devices = CaptureDeviceList.Instance;

            // If no devices were found print an error
            if(devices.Count < 1)
            {
                Console.WriteLine("No devices were found on this machine");
                return;
            }

            Console.WriteLine("The following devices are available on this machine:");
            Console.WriteLine("----------------------------------------------------");
            Console.WriteLine();

            int i = 0;

            // Print out the available devices
            foreach(var dev in devices)
            {
                Console.WriteLine("{0}) {1}",i,dev.Description);
                i++;
            }

            Console.WriteLine();
            Console.Write("-- Please choose a device to send a packet on: ");
            i = int.Parse( Console.ReadLine() );

            var device = devices[i];

            Console.Write("What MAC address are you sending the WOL packet to: ");
            string response = Console.ReadLine().ToLower().Replace(":", "-");

            //Open the device
            device.Open();

            EthernetPacket ethernet = new EthernetPacket(PhysicalAddress.Parse(
                "ff-ff-ff-ff-ff-ff"), PhysicalAddress.Parse("ff-ff-ff-ff-ff-ff"),
                EthernetPacketType.WakeOnLan);
            ethernet.PayloadPacket = new WakeOnLanPacket(
                PhysicalAddress.Parse(response));
            byte[] bytes = ethernet.BytesHighPerformance.Bytes;

            try
            {
                //Send the packet out the network device
                device.SendPacket(bytes);
                Console.WriteLine("-- Packet sent successfuly.");
            }
            catch(Exception e)
            {
                Console.WriteLine("-- "+ e.Message );
            }

            //Close the pcap device
            device.Close();
            Console.WriteLine("-- Device closed.");
            Console.Write("Hit 'Enter' to exit...");
            Console.ReadLine();
        }
    }
} 
```

注意：这是基于 Example09 构建的全功能 Wake-On-Lan 数据包发送控制台应用程序，可在 SharpPcap 源代码中找到。

此示例中使用的在 .NET 框架中找不到的库是：

```
using PacketDotNet; 
```

该库 (.dll) 与 SharpPcap 一起打包。它负责 SharpPcap 中的所有数据包构造和解析。这是 WakeOnLan 类所在的位置。

*注意：数据包构造/解析代码最初捆绑在 SharpPcap.dll 中。它被迁移到了自己的库，因为 SharpPcap 旨在成为 winpcap 的包装器。它的许多用户处理设计协议和/或处理原始网络数据包。*

```
using SharpPcap; 
```

SharpPcap 包含所有 winpcap(windows)/libpcap(*nix) 包装器代码。需要选择接口并通过线路发送实际数据包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T02:19:57.680

WOL 由 MAC 完成，而不是 IP。 [这是一个例子](http://blog.opennetcf.com/ctacke/2006/12/06/WakeonLANWOLFromC.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:22:57.153

.NET 作为虚拟机 (CLR) 运行，因此它抽象出大部分底层真实机器。例如，它只为 TCP 和 UDP 网络提供接口，这在网络协议栈中比您正在讨论的要高得多。您可能能够找到提供对较低级别接口的访问的第三方组件，但我不会指望它（我过去曾研究过 .NET 和 Java）。

为了访问网络协议栈的底层，您可能需要用 C 编写相关的 OS 系统调用。您可能会发现这在 Python 中最简单，并且您可能会发现此功能已经在 Python 或第三方库中实现。例如，我建议看一下 Twisted 网络库。这也是我在大部分工作中转向 Python 的原因之一。

最良好的祝愿。

# jquery - 如何通过 AJAX 调用 (jQuery) 发布大数据？

> ID：445428
> 
> 赞同：6
> 
> 时间：2009-01-15T02:28:58.333
> 
> 标签：jquery, ajax

我正在尝试使用 jQuery 的 ajax 功能从 Web 表单（ASP.NET MVC）更新数据。部分数据来自文本区域，虽然不是海量数据，但很容易超过 2 KB。

似乎 jQuery ajax 将所有数据放入查询字符串中，从而导致 IIS 拒绝 URL，从而中断调用。是否可以使用 jQuery 下的 ajax 模型向 POST 请求添加数据，而不是在查询字符串中包含所有内容？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T02:34:45.920

使用[$.post](http://docs.jquery.com/Ajax/jQuery.post)

例如

```
$.post(someUrl, { textData: $('#someInput').val() } ); 
```

$.post 只是 $.ajax 的一个简单包装器。

```
$.ajax({ type :"post", 
         data : { textData: $('#someInput').val() },
         url : someUrl
      }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T02:34:36.327

是的; 根据[jQuery 的文档](http://docs.jquery.com/Ajax)，您可以使用`jQuery.post`POST 数据。

如果要发布现有表单，请使用：

```
var form = $("#myform"); // or whatever
$.post(form.get()[0].action, form.serialize(), function(data) {
    // data received
}, "xml"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T09:51:31.290

您可以使用 FormData：

```
var formData = new FormData();
formData.append('filename', filename);
formData.append('data', data);
$.ajax({
    url: "FileUploadServlet",
    type: "POST",
    data: formData,
    cache: false,
    contentType: false,
    processData: false}); 
```

# asp.net - 在运行时确定asp.net 页面上gridview 的像素高度？

> ID：445431
> 
> 赞同：1
> 
> 时间：2009-01-15T02:29:42.607
> 
> 标签：asp.net

任何人都知道是否有可能在运行时知道 asp.net gridview 有多少像素高？

我的页面左侧有一个gridview。在右侧，我填充了高度不同的随机图像，并且我希望（尽可能接近）将 gridview 的总高度与右侧图片的总高度相匹配。（代码不断检查图片，直到找到具有正确高度的图片）。

我可以通过知道行数来近似高度（gridview.rows.count * 平均行高），但是由于行高可能会根据它们是否是长线换行而有所不同，所以我更愿意尝试获得更好的高度估计...

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T02:42:42.517

好吧，高度是一个属性，所以我猜：

```
int heightGV = GridView1.Height; 
```

不过我很可能是错的，因为我从来没有这样做过。试试看，让我们知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T03:00:52.183

您很可能需要使用客户端脚本来处理这个问题。javascript中有一些技术可以确定您可以使用的页面上元素的实际高度（以像素为单位）。

不利的一面是，当页面在服务器端加载时，您将无法访问此信息。

作为替代方案，您可以对网格应用一些样式以更好地控制每行的高度，然后实现分页，这样您就可以随时了解网格的高度。

过去，我使用“冻结”标题和围绕它的可滚动 div 实现了一个固定高度的网格视图，所以我总是至少知道网格的最大高度（显然，如果你没有达到那个最大值，那么高度仍然是可变的）。

有很多关于如何做到这一点的资源，这篇文章看起来很不错： [GridView with freeze header](http://mattberseth.com/blog/2007/09/freezing_gridview_column_heade.html)

# javascript - 带有可自定义导航的 Javascript 轮播/滑块

> ID：445432
> 
> 赞同：1
> 
> 时间：2009-01-15T02:30:21.827
> 
> 标签：javascript, slider

我目前正在开发一个网站，并且需要在主页上使用基于 javascript 的轮播/滑块混合，自动在 3 或 4 张不同的图像之间淡出，让用户有机会点击一个并转到网站上的另一个页面. 我还需要不同的幻灯片有某种导航，用每张幻灯片的名称（如 Coda 滑块效果）或符号（如每张幻灯片的点）表示，以允许用户在单击之前查看他们的选项幻灯片以访问特定突出显示的部分。

我已经看到使用 flash 以多种方式完成此操作，但我看到的唯一满足我需求的 javascript 方法是 Apple 在新 iLife 页面（[链接](http://www.apple.com/ilife/)）上使用的方法。有没有人知道他们正在使用什么，或者是否有一个与他们的实现类似的项目？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T03:59:09.510

除非我遗漏了什么，否则 iLife 上的导航看起来就像一个照片库，其中大照片链接到目的地。我将[jQuery Galleria](http://devkick.com/lab/galleria/)用于照片库，因为动画效果非常棒。该论坛还提供有用的基于社区的支持。

如果你想要一个带有左右滑动图像的轮播式动画，可以试试[jQuery Carousel](http://www.ajaxdaddy.com/demo-jquery-carousel.html)库。我自己没有使用过它，所以不能评论它的易用性或质量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T04:09:26.413

jQuery 动画或[jCarousel](http://sorgalla.com/projects/jcarousel/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T04:28:55.737

[YUI Carousel Control](http://developer.yahoo.com/yui/carousel)将是另一个值得一看的起点。（请注意，在撰写本文时，它目前处于测试阶段。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-15T01:39:41.353

嘿，我不确定这会有多大帮助，但请查看此滑块。它非常简单，并且具有我认为您正在寻找的导航缩略图

[http://codetutorial.caroshaw.com/jquery_image_slider.php](http://codetutorial.caroshaw.com/jquery_image_slider.php)

# bazaar - Bazaar：从单一开发人员转移到可访问的存储库

> ID：445439
> 
> 赞同：2
> 
> 时间：2009-01-15T02:33:58.057
> 
> 标签：bazaar

我已经开始在单用户模式下将 bazaar DVCS 用于项目，如他们的教程中所述。我想让另一个开发人员参与这个项目，但多用户、“可分支”存储库似乎与我的小临时目录具有不同的结构。我找不到有关如何从一个到另一个的文档。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T02:59:40.970

我不明白您如何设法获得不可分支的东西。这是集市中的基本内容。

假设你为你的代码做了这样的事情：

```
c:\dev> bzr init proj
c:\dev\proj> hackhackhack.bat
c:\dev\proj> bzr commit 
```

这应该是一个可分支的存储库。IE

```
c:\dev2> bzr init-repo .
c:\dev2> bzr branch c:\dev\proj proj 
```

你现在有一个分支。

如果您正在谈论运行内置服务器，则需要执行以下操作：

```
c:\dev2> bzr serve 
```

# iphone - 开发者从苹果那里获得了关于每个在应用商店购买应用的用户的哪些信息？

> ID：445444
> 
> 赞同：2
> 
> 时间：2009-01-15T02:35:38.100
> 
> 标签：iphone, app-store

有谁知道开发人员从 Apple 收到的有关在应用商店购买其应用程序的最终用户信息？

他们是否收到最终用户的全名、他们的 iPhone/iPod touch 的唯一标识符，或者可能是他们的电子邮件地址？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T03:52:38.697

以上都不是。你所得到的只是有多少人购买了你的应用程序，在哪一天，来自哪个国家。任何额外的数据都必须直接从应用程序中收集，也就是说，应用程序必须“打电话回家”。

# wpf - Morae 屏幕文本搜索未在 WPF 应用程序中捕获屏幕文本

> ID：445446
> 
> 赞同：0
> 
> 时间：2009-01-15T02:36:15.603
> 
> 标签：wpf, usability

当我尝试使用 Morae Manager 3.0 对我们的原型记录（使用 WPF 编码，.NET 版本 3.5 SP1）运行屏幕文本搜索时，唯一出现的就是窗口标题。我们使用的是 Windows XP。

即使我搜索可编辑的内容，例如在文本框中键入的文本，它也不会出现。

原型之外的东西（例如桌面图标）的屏幕文本仍然很完美。

我在两个不同的场合联系了 TechSmith 支持，两次我得到的答复都是这一定是我们的技术有问题，因为屏幕文本搜索确实适用于其他事情，而且支持人员不是开发人员，因此不知道是什么可能导致这种情况。

有人知道吗：

1.  究竟是什么导致了这种情况——例如 WPF 的渲染引擎是否绕过 Morae 查找文本的某种 Windows 层（请原谅我在术语中的任何错误）
2.  如果有什么我可以在原型中调整来修复它
3.  我怎样才能联系到 TechSmith 知道 1\. 和 2 答案的人。

PS Morae 是一款出色的产品，我们通常得到 TechSmith 的大力支持。我们只是在这件小事上遇到了问题，很难怪 Morae 不兼容 WPF 这样的新东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T09:51:52.777

我不知道 Morae 是什么或它是如何工作的，但是 WPF 和例如 WinForms 之间的一大区别如下，从[这里](http://msdn.microsoft.com/en-us/library/ms742522.aspx)复制：

> 当您创建 WPF Window 时，WPF 会创建一个顶级 HWND，并使用 HwndSource 将 Window 及其 WPF 内容放入 HWND。应用程序中的其余 WPF 内容共享单个 HWND。

如果 Morae 依靠 HWND 在屏幕上查找文本，这可以解释为什么它找不到文本框。相比之下，我相信 WinForms 中的每个控件（按钮、文本框）都有自己的 HWND。

# javascript - YUI 按钮按类名应用

> ID：445452
> 
> 赞同：0
> 
> 时间：2009-01-15T02:38:46.613
> 
> 标签：javascript, yui

是否可以使用元素的类名而不是 id 来应用/创建 YUI 按钮。我必须生成一个按钮列表，然后将其转换为 YUI 按钮。

[更新]

顺便说一句，我正在尝试在锚标记中应用按钮。所以它将是一个链接按钮。

[更新：代码]

好的，这是代码。我有一个生成这个锚标记的循环。

```
<a class="system-button" href="/system/edit/12">Edit</a> 
```

wrumsby 的回答完全有道理。但我不知道为什么它不起作用。我尝试调试它并成功获取元素。但似乎没有创建任何 YUI 按钮。

我什至尝试为元素生成唯一的 id，但仍然没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T03:30:22.530

看来我已经自己解决了。但我不确定这是否是最好的解决方案。我生成了唯一的 ID，然后创建了按钮。

```
 var i = 0;
$(".system-button").each(function(i,b){

    var button = new YAHOO.widget.Button($(b).attr('id','system-button'+i).attr('id'));
     i++;
}); 
```

哦，是的，我在这里使用 JQuery。这个框架太棒了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:46:31.387

您应该能够像这样使用[`srcelement`配置属性](http://developer.yahoo.com/yui/docs/YAHOO.widget.Button.html#config_srcelement)：

```
(function() {
    var Dom = YAHOO.util.Dom,
        Event = YAHOO.util.Event,
        Button = YAHOO.widget.Button;

    Event.onDOMReady(
        function() {
            var elements = Dom.getElementsByClassName('...');

            for (var i = 0; i < elements.length; i++) {
               var button = new Button({
                   srcelement: elements[i],
                   ...
               });
               ...
            }
        }
    );
})(); 
```

# java - 在没有 Oracle 依赖的 Java 中使用 Oracle 引用游标

> ID：445455
> 
> 赞同：11
> 
> 时间：2009-01-15T02:41:19.073
> 
> 标签：java, oracle

根据谷歌和其他一些来源（例如，[http](http://www.enterprisedt.com/publications/oracle/result_set.html) ://www.enterprisedt.com/publications/oracle/result_set.html ），如果我想调用一个返回引用光标的存储函数，我需要编写类似这是为了访问 ResultSet：

```
String query = "begin ? := sp_get_stocks(?); end;";
CallableStatement stmt = conn.prepareCall(query);
// register the type of the out param - an Oracle specific type
stmt.registerOutParameter(1, OracleTypes.CURSOR);
// set the in param
stmt.setFloat(2, price);
// execute and retrieve the result set
stmt.execute();
ResultSet rs = (ResultSet)stmt.getObject(1); 
```

无论如何要在不引入对 Oracle 的编译时依赖的情况下做到这一点。是否有 OracleTypes.CURSOR 的通用替代方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T07:27:09.043

常数`OracleTypes.CURSOR`为-10。相当丑陋的解决方案，但您可以在那里写 -10 或创建自己的值为 -10 的常量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T08:39:40.597

你试过`java.sql.Types.OTHER`吗？它可能会起作用。API 说，它适用于数据库特定类型。

# programming-languages - 计算机图形学：光线追踪和编程 3D 渲染

> ID：445456
> 
> 赞同：7
> 
> 时间：2009-01-15T02:42:41.597
> 
> 标签：programming-languages, 3d, raytracing, graphics

我注意到一些顶尖大学正在开设课程，让学生在其 CS 专业中学习与计算机图形相关的科目。可悲的是，这是我的大学没有提供的东西，我真的很想在未来几年的某个时候进入。

我从一些大学找到的一些项目很棒，尽管我最感兴趣的是两件事：

*   **光线追踪：**
    *   我想在未来两年内编写一个 Raytracer。我需要知道什么？我还不是一个出色的程序员（Java、C 和 Prolog 是我今天的主要语言），但我每天都在慢慢学习。此外，我的数学背景并不是那么好，所以任何关于阅读书籍的指针或关于编写这样一个程序的建议都会很棒。我倾向于很快拿起这些东西，所以请随意向我扔参考。
*   **编程 3D 渲染模型**
    *   我看过几个项目，学生们开发了模型并在游戏中使用它们。我用光栅图像制作了几个 2D 游戏，但从未使用 3D 模型。在编程这些模型方面我需要学习什么？如果它有帮助的话，我以前对 3D Studio Max 和 Cinema4D 没问题（尽管每门课程似乎都使用 Maya），但大约四年没有碰过它。

很抱歉发布了如此含糊的问题，说实话，愚蠢的问题。这只是我一段时间以来一直想做的事情，而且作为一个大型项目，我可以在自己的时间里进行开发。

### 相关问题

*   [编写光线追踪器的文献和教程](https://stackoverflow.com/questions/362140/literature-and-tutorials-for-writing-a-ray-tracer)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T18:44:36.857

我可以推荐[**pbrt**](http://www.pbrt.org/)，它是一本书和一个基于物理的渲染器，用于教授计算机科学专业的毕业生。所用数学的描述很好而且很清楚，因为它是用“文学编程”编写的，所以你也可以看到适当的代码（用 C++ 编写）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T16:55:47.180

[《计算机图形学：原理与实践》](https://rads.stackoverflow.com/amzn/click/com/0201848406)一书 （在计算机图形学界被称为“Foley-VanDam”）是大多数计算机图形学课程的基础，它详细介绍了实现光线追踪器的主题。它已经过时了，但它仍然是最好的，afaik，基本原则保持不变。

我还[赞同 Eric Lengyel 的 3D 游戏编程和计算机图形学数学](https://rads.stackoverflow.com/amzn/click/com/1584502770)的推荐。它没有那么透彻，但它是对 3D 编程所需数学基础知识的精彩回顾，每章末尾都有非常有用的总结，而且它以平易近人、不太吓人的方式编写。

此外，您可能还需要一些 OpenGL 或 DirectX 基础知识。开始使用 3D API，然后学习基础数学比相反（在我看来）更容易，但这两种选择都是可能的。只需在 SO 上查找 OpenGL，您也应该找到一些很好的参考资料。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T03:43:06.763

2000[年 ICFP 编程竞赛](http://www.cs.cornell.edu/icfp/)要求参与者在三天内构建一个光线追踪器。他们对简单的光线追踪器有很好的规范，您还可以获得获胜条目和其他一些条目的代码。有大量不同编程语言的条目。这可能是您入门的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T03:09:20.453

我能给出的最简短有用的答案是，大多数重要的算法都可以在Tomas Akenine-Möller、Eric Haines 和 Naty Hoffman 的[*Real-Time Rendering*](http://www.realtimerendering.com/)中找到，并且最后的参考书目引用了必要的数学。他们的网站也有推荐阅读清单。

我读过的关于该主题的最有用的数学书是 Eric Lengyel 的*《3D 游戏编程和计算机图形学数学》*。您最需要的数学是几何（显然）和线性代数（用于处理所有矩阵）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T16:47:21.783

去年我上过这样一门课，我相信这门课非常适合强迫学生学习计算机图形背后的数学——而不仅仅是让计算机做你想做的事情的命令。

我的教授在[这里](http://www.cs.umd.edu/~djacobs/CMSC427/CMSC427_07Fall.htm)有一个网站，里面有他的讲义和习题集，你可以浏览一下。

我们的最终项目确实是一个光线追踪器，但是一旦你了解了它背后的数学原理，编码（一个低效的）就变得微不足道了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T20:27:57.827

有关这些主题的数学介绍，请参阅

[http://graphics.idav.ucdavis.edu/education/GraphicsNotes/homepage.html](http://graphics.idav.ucdavis.edu/education/GraphicsNotes/homepage.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-25T23:39:06.003

检查[http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-1-writing-a-simple-raytracer/](http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-1-writing-a-simple-raytracer/)

这是一个学习光线追踪和渲染的好地方。

# html - 自动刷新网页

> ID：445458
> 
> 赞同：18
> 
> 时间：2009-01-15T02:42:47.463
> 
> 标签：html, database, refresh

我有一个网页，它允许用户执行各种操作，进而修改数据库。此外，此 Web 应用程序需要跟踪数据库中随时间变化的各个字段。每隔几秒钟刷新一次页面是实现这一点的最佳方法吗？例如，如果页面上有很长的列表需要滚动，则由于页面刷新而不断重置，因此很难查看该列表。我知道，有办法保留卷轴的位置。但是，我可以使用更有效的东西吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-12-28T12:46:37.857

把它放在头标签下

```
<meta http-equiv="refresh" content="5"> 
```

这将每 5 秒刷新一次页面。

对于其他选项，请参阅[链接文本](http://www.javascriptkit.com/script/script2/autofresh.shtml)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T02:57:50.163

使用带有计时器的 AJAX。使用它我们可以刷新页面中的特定部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-04T09:11:40.793

这个任务很容易在 html 标题部分中使用以下代码

```
<head> <meta http-equiv="refresh" content="30" /> </head> 
```

它将在 30 秒后刷新您的页面。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T02:45:59.080

简短的回答是否定的。您可以使用 ajax 来更新必要的组件。这减少了加载时间并防止您的页面重置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T04:03:24.133

我认为您需要类似于现在普遍称为 Comet 的反向 AJAX 的东西。它是服务器将数据推送到客户端，而不是浏览器从服务器/数据库轮询数据。[http://en.wikipedia.org/wiki/Comet_(programming)](http://en.wikipedia.org/wiki/Comet_(programming))有很好的介绍。已经有许多框架（例如 DWR、ICEFaces）支持这种模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T02:46:38.750

带定时器的 AJAX

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T02:48:13.210

无需过多介绍，通常您可能需要考虑使用 Javascript 以 Ajax 样式的方式动态生成 HTML。做正确的事情更具挑战性，但从用户体验的角度来看，这是正确的方法。

查看[Yahoo 用户界面库](http://developer.yahoo.com/yui/)以获取指导和帮助——它确实比尝试手动完成所有事情要容易得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-19T10:52:25.980

如果要自动刷新整个页面，请在页眉中使用meta html标签。但最好使用AJAX自动刷新页面的指定部分，以避免加载时间的弹性

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T02:47:01.200

这听起来像是更适合 Flash 或 Silverlight 应用程序的功能。使用精心设计的 AJAX 解决方案可能比您的更有效，但现实情况是网页为实时内容提供了糟糕的媒介。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-05T22:28:35.540

我认为以下是标题中刷新命令的一个很好的解决方案。

当您调用 httpSuccess 函数时，请尝试使用：

```
server.httpSuccess("text/html","Refresh: 30\r\n"); 
```

# c# - 令人费解的 Enumerable.Cast InvalidCastException

> ID：445471
> 
> 赞同：48
> 
> 时间：2009-01-15T02:47:14.037
> 
> 标签：c#, .net, exception

下面抛出一个`InvalidCastException`.

```
IEnumerable<int> list = new List<int>() { 1 };
IEnumerable<long> castedList = list.Cast<long>();
Console.WriteLine(castedList.First()); 
```

为什么？

我正在使用 Visual Studio 2008 SP1。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-15T03:01:46.473

这很奇怪！[这里](http://blogs.msdn.com/ed_maurer/archive/2008/02/16/breaking-change-in-linq-queries-using-explicitly-typed-range-variables.aspx)有一篇博客文章描述了`Cast<T>()`.NET 3.5 和 .NET 3.5 SP1 之间的行为是如何变化的，但它仍然没有解释 InvalidCastException，如果你这样重写代码，你甚至会得到：

```
var list = new[] { 1 };
var castedList = from long l in list select l;
Console.WriteLine(castedList.First()); 
```

显然你可以通过自己做演员来解决它

```
var castedList = list.Select(i => (long)i); 
```

这有效，但它并没有首先解释错误。我尝试将列表强制转换为短和浮动，并且抛出了相同的异常。

**编辑**

那篇博客文章确实解释了为什么它不起作用！

`Cast<T>()`是一种扩展方法`IEnumerable`而不是`IEnumerable<T>`. 这意味着当每个值到达它被强制转换的点时，它已经被装箱回 System.Object 中。从本质上讲，它正在尝试这样做：

```
int i = 1;
object o = i;
long l = (long)o; 
```

此代码抛出您得到的 InvalidCastException。如果您尝试将 int 直接转换为 long 就可以了，但是将装箱的 int 转换回 long 是行不通的。

果然是奇葩！

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-15T03:09:05.820

Enumerable.Cast 方法定义如下：

```
public static IEnumerable<TResult> Cast<TResult>(
    this IEnumerable source
) 
```

并且没有关于 IEnumerable 项目的初始类型的信息，所以我认为您的每个 int 最初都是通过装箱转换为 System.Object 的，然后尝试将其拆箱为长变量，这是不正确的。

重现此的类似代码：

```
int i = 1;
object o = i; // boxing
long l = (long)o; // unboxing, incorrect
// long l = (int)o; // this will work 
```

因此，您的问题的解决方案将是：

```
ints.Select(i => (long)i) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-08T23:17:57.520

我又来了！
这是您所有`List<T>`和`Enumerable<T>`转换问题的解决方案。约 150 行代码
只需确保为所涉及的输入/输出类型（如果不存在）定义至少一个显式或隐式转换运算符，无论如何您都应该这样做！

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reflection;

namespace System.Collections.Generic //purposely in same namespace as List<T>,IEnumerable<T>, so extension methods are available with them
{
    public static class Enumerable
    {
        public static List<TOutput> ConvertAll<TInput,TOutput>( this IEnumerable<TInput> input ) {
            return BuildConvertedList<TInput,TOutput>( input, GetConverterDelegate<TInput,TOutput>() );
        }

        public static IEnumerable<TOutput> ConvertAll<TInput,TOutput>( this IEnumerable<TInput> input, bool lazy ) {
            if (lazy) return new LazyConverter<TInput,TOutput>( input, GetConverterDelegate<TInput,TOutput>() );
            return BuildConvertedList<TInput,TOutput>( input, GetConverterDelegate<TInput,TOutput>() );
        }

        public static List<TOutput> ConvertAll<TInput,TOutput>( this IEnumerable<TInput> input, Converter<TInput, TOutput> converter ) {
            return BuildConvertedList<TInput,TOutput>( input, converter );
        }

        public static List<TOutput> ConvertAll<TInput, TOutput>( this List<TInput> input ) {
            Converter<TInput, TOutput> converter = GetConverterDelegate<TInput,TOutput>();
            return input.ConvertAll<TOutput>( converter );
        }

        public static IEnumerable<TOutput> ConvertAll<TInput, TOutput>( this List<TInput> input, Converter<TInput, TOutput> converter, bool lazy ) {
            if (lazy) return new LazyConverter<TInput, TOutput>( input, converter );
            return input.ConvertAll<TOutput>( converter );
        }

        public static List<TOutput> ConvertAll<TInput, TOutput>( this List<TInput> input, Converter<TInput, TOutput> converter ) {
            return input.ConvertAll<TOutput>( converter );
        }

        //Used to manually build converted list when input is IEnumerable, since it doesn't have the ConvertAll method like the List does
        private static List<TOutput> BuildConvertedList<TInput,TOutput>( IEnumerable<TInput> input, Converter<TInput, TOutput> converter ){
            List<TOutput> output = new List<TOutput>();
            foreach (TInput input_item in input)
                output.Add( converter( input_item ) );
            return output;
        }

        private sealed class LazyConverter<TInput, TOutput>: IEnumerable<TOutput>, IEnumerator<TOutput>
        {
            private readonly IEnumerable<TInput> input;
            private readonly Converter<TInput, TOutput> converter;
            private readonly IEnumerator<TInput> input_enumerator;

            public LazyConverter( IEnumerable<TInput> input, Converter<TInput, TOutput> converter )
            {
                this.input = input;
                this.converter = converter;
                this.input_enumerator = input.GetEnumerator();
            }

            public IEnumerator<TOutput> GetEnumerator() {return this;} //IEnumerable<TOutput> Member
            IEnumerator IEnumerable.GetEnumerator() {return this;} //IEnumerable Member
            public void Dispose() {input_enumerator.Dispose();} //IDisposable Member
            public TOutput Current {get {return converter.Invoke( input_enumerator.Current );}} //IEnumerator<TOutput> Member
            object IEnumerator.Current {get {return Current;}} //IEnumerator Member
            public bool MoveNext() {return input_enumerator.MoveNext();} //IEnumerator Member
            public void Reset() {input_enumerator.Reset();} //IEnumerator Member
        }

        private sealed class TypeConversionPair: IEquatable<TypeConversionPair>
        {
            public readonly Type source_type;
            public readonly Type target_type;
            private readonly int hashcode;

            public TypeConversionPair( Type source_type, Type target_type ) {
                this.source_type = source_type;
                this.target_type = target_type;
                //precalc/store hash, since object is immutable; add one to source hash so reversing the source and target still produces unique hash
                hashcode = (source_type.GetHashCode() + 1) ^ target_type.GetHashCode();
            }

            public static bool operator ==( TypeConversionPair x, TypeConversionPair y ) {
                if ((object)x != null) return x.Equals( y );
                if ((object)y != null) return y.Equals( x );
                return true; //x and y are both null, cast to object above ensures reference equality comparison
            }

            public static bool operator !=( TypeConversionPair x, TypeConversionPair y ) {
                if ((object)x != null) return !x.Equals( y );
                if ((object)y != null) return !y.Equals( x );
                return false; //x and y are both null, cast to object above ensures reference equality comparison
            }

            //TypeConversionPairs are equal when their source and target types are equal
            public bool Equals( TypeConversionPair other ) {
                if ((object)other == null) return false; //cast to object ensures reference equality comparison
                return source_type == other.source_type && target_type == other.target_type;
            }

            public override bool Equals( object obj ) {
                TypeConversionPair other = obj as TypeConversionPair;
                if ((object)other != null) return Equals( other ); //call IEqualityComparer<TypeConversionPair> implementation if obj type is TypeConversionPair
                return false; //obj is null or is not of type TypeConversionPair; Equals shall not throw errors!
            }

            public override int GetHashCode() {return hashcode;} //assigned in constructor; object is immutable
        }

        private static readonly Dictionary<TypeConversionPair,Delegate> conversion_op_cache = new Dictionary<TypeConversionPair,Delegate>();

        //Uses reflection to find and create a Converter<TInput, TOutput> delegate for the given types.
        //Once a delegate is obtained, it is cached, so further requests for the delegate do not use reflection*
        //(*the typeof operator is used twice to look up the type pairs in the cache)
        public static Converter<TInput, TOutput> GetConverterDelegate<TInput, TOutput>()
        {
            Delegate converter;
            TypeConversionPair type_pair = new TypeConversionPair( typeof(TInput), typeof(TOutput) );

            //Attempt to quickly find a cached conversion delegate.
            lock (conversion_op_cache) //synchronize with concurrent calls to Add
                if (conversion_op_cache.TryGetValue( type_pair, out converter ))
                    return (Converter<TInput, TOutput>)converter;

            //Get potential conversion operators (target-type methods are ordered first)
            MethodInfo[][] conversion_op_sets = new MethodInfo[2][] {
                type_pair.target_type.GetMethods( BindingFlags.Static | BindingFlags.Public | BindingFlags.FlattenHierarchy ),
                type_pair.source_type.GetMethods( BindingFlags.Static | BindingFlags.Public | BindingFlags.FlattenHierarchy )
            };

            //Find appropriate conversion operator,
            //favoring operators on target type in case functionally equivalent operators exist,
            //since the target type's conversion operator may have access to an appropriate constructor
            //or a common instance cache (i.e. immutable objects may be cached and reused).
            for (int s = 0; s < conversion_op_sets.Length; s++) {
                MethodInfo[] conversion_ops = conversion_op_sets[s];
                for (int m = 0; m < conversion_ops.Length; m++)
                {
                    MethodInfo mi = conversion_ops[m];
                    if ((mi.Name == "op_Explicit" || mi.Name == "op_Implicit") && 
                        mi.ReturnType == type_pair.target_type &&
                        mi.GetParameters()[0].ParameterType.IsAssignableFrom( type_pair.source_type )) //Assuming op_Explicit and op_Implicit always have exactly one parameter.
                    {
                        converter = Delegate.CreateDelegate( typeof(Converter<TInput, TOutput>), mi );
                        lock (conversion_op_cache) //synchronize with concurrent calls to TryGetValue
                            conversion_op_cache.Add( type_pair, converter ); //Cache the conversion operator reference for future use.
                        return (Converter<TInput, TOutput>)converter;
                    }
                }
            }
            return (TInput x) => ((TOutput)Convert.ChangeType( x, typeof(TOutput) )); //this works well in the absence of conversion operators for types that implement IConvertible
            //throw new InvalidCastException( "Could not find conversion operator to convert " + type_pair.source_type.FullName + " to " + type_pair.target_type.FullName + "." );
        }
    }
} 
```

**样品用途：**

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            List<string> list = new List<string>(new string[] { "abcde", "abcd", "abc"/*will break length constraint*/, "ab", "a" });
            //Uncomment line below to see non-lazy behavior.  All items converted before method returns, and will fail on third item, which breaks the length constraint.
            //List<ConstrainedString> constrained_list = list.ConvertAll<string,ConstrainedString>();
            IEnumerable<ConstrainedString> constrained_list = list.ConvertAll<string,ConstrainedString>( true ); //lazy conversion; conversion is not attempted until that item is read
            foreach (ConstrainedString constrained_string in constrained_list) //will not fail until the third list item is read/converted
                System.Console.WriteLine( constrained_string.ToString() );
        }   

        public class ConstrainedString
        {
            private readonly string value;
            public ConstrainedString( string value ){this.value = Constrain(value);}
            public string Constrain( string value ) {
                if (value.Length > 3) return value;
                throw new ArgumentException("String length must be > 3!");
            }
            public static explicit operator ConstrainedString( string value ){return new ConstrainedString( value );}
            public override string ToString() {return value;}
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T03:07:01.313

嗯……有趣的谜题。考虑到我只是在 Visual Studio 2008 中运行它并且它*根本没有*抛出，所以更有趣的是。

我没有使用 Service Pack 1，您可能会使用，所以这可能是问题所在。我知道在 SP1 版本中的 .Cast() 中有一些“性能增强”可能会导致问题。一些阅读：

[博客条目 1](http://blogs.msdn.com/ed_maurer/archive/2008/02/16/breaking-change-in-linq-queries-using-explicitly-typed-range-variables.aspx)

[博客条目 2](http://blogs.msdn.com/dinesh.kulkarni/archive/2008/08/10/net-fx-3-5-sp1-two-perf-improvements-linq-to-objects-and-linq-to-sql.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T03:41:26.803

我希望他们能做一些智能的事情，比如使用为该类型定义的任何隐式或显式转换运算符。当前的行为和不一致是不可接受的。在目前的情况下绝对没用。

在意识到这`Cast<Type>`是引发异常而不是使用我为该类型定义的强制转换运算符后，我变得恼火并找到了这个线程。如果它是为 定义的`IEnumerable`，他们为什么不直接实现它以使用反射来获取对象的类型，获取目标类型，发现任何可用的静态转换运算符，并找到合适的进行转换。它可以将异类`IEnumerable`转换为`IEnumerable<T>`.

以下实现是一个可行的想法......

```
public static class EnumerableMinusWTF
{
    public static IEnumerable<TResult> Cast<TResult,TSource>(this IEnumerable<TSource> source)
    {
        Type source_type = typeof(TSource);
        Type target_type = typeof(TResult);

        List<MethodInfo> methods = new List<MethodInfo>();
        methods.AddRange( target_type.GetMethods( BindingFlags.Static | BindingFlags.Public ) ); //target methods will be favored in the search
        methods.AddRange( source_type.GetMethods( BindingFlags.Static | BindingFlags.Public ) );
        MethodInfo op_Explicit = FindExplicitConverstion(source_type, target_type, methods );

        List<TResult> results = new List<TResult>();
        foreach (TSource source_item in source)
            results.Add((TResult)op_Explicit.Invoke(null, new object[] { source_item }));
        return results;
    }

    public static MethodInfo FindExplicitConverstion(Type source_type, Type target_type, List<MethodInfo> methods)
    {
        foreach (MethodInfo mi in methods)
        {
            if (mi.Name == "op_Explicit") //will return target and take one parameter
                if (mi.ReturnType == target_type)
                    if (mi.GetParameters()[0].ParameterType == source_type)
                        return mi;
        }
        throw new InvalidCastException( "Could not find conversion operator to convert " + source_type.FullName + " to " + target_type.FullName + "." );
    }
} 
```

然后我可以成功调用此代码：

```
 //LessonID inherits RegexConstrainedString, and has explicit conversion operator defined to convert string to LessonID
List<string> lessons = new List<String>(new string[] {"l001,l002"});
IEnumerable<LessonID> constrained_lessons = lessons.Cast<LessonID, string>(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-08T18:36:27.230

**这里有一些事情要考虑......**

1.  您要投射还是转换？

2.  你想要结果是 a`List<T>`还是`IEnumerable<T>`.

3.  如果结果是`IEnumerable<T>`，您是否希望延迟应用强制转换/转换（即在迭代器到达每个元素之前不会实际发生强制转换/转换）？

**转换/转换之间有用的区别，因为转换运算符通常涉及构造新对象，并且可以被视为转换：**
“转换”实现应自动应用为所涉及类型定义的转换运算符；*可能会或可能不会构造一个新对象*。
“转换”实现应该允许指定一个`System.Converter<TInput,TOutput>`委托。

**潜在的方法标头：**

```
List<TOutput> Cast<TInput,TOutput>(IEnumerable<TInput> input);
List<TOutput> Convert<TInput,TOutput>(IEnumerable<TInput> input, Converter<TInput,TOutput> converter);
IEnumerable<TOutput> Cast<TInput,TOutput>(IEnumerable<TInput> input);
IEnumerable<TOutput> Convert<TInput,TOutput>(IEnumerable<TInput> input, Converter<TInput,TOutput> converter); 
```

**使用现有框架的有问题的“Cast”实现；假设您将 a 作为输入传递`List<string>`，您希望使用之前的任何方法进行转换。**

```
//Select can return only a lazy read-only iterator; also fails to use existing explicit cast operator, because such a cast isn't possible in c# for a generic type parameter (so says VS2008)
list.Select<TInput,TOutput>( (TInput x) => (TOutput)x );
//Cast fails, unless TOutput has an explicit conversion operator defined for 'object' to 'TOutput'; this confusion is what lead to this topic in the first place
list.Cast<TOuput>(); 
```

**有问题的“转换”实现**

```
//Again, the cast to a generic type parameter not possible in c#; also, this requires a List<T> as input instead of just an IEnumerable<T>.
list.ConvertAll<TOutput>( new Converter<TInput,TOuput>( (TInput x) => (TOutput)x ) );
//This would be nice, except reflection is used, and must be used since c# hides the method name for explicit operators "op_Explicit", making it difficult to obtain a delegate any other way.
list.ConvertAll<TOutput>(
    (Converter<TInput,TOutput>)Delegate.CreateDelegate(
        typeof(Converter<TInput,TOutput>),
        typeof(TOutput).GetMethod( "op_Explicit", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.Public )
    )
); 
```

**总结：**
Cast/Convert 方法应该包含定义的显式转换操作符，或者允许指定一个转换委托。C# 的转换运算符的语言规范——特别是它们缺少方法名称——使得很难获得委托，除非通过反射。另一种方法是封装或复制转换代码，不必要地增加代码的（维护）复杂性，因为实际上，*可能/允许*的转换在转换运算符的存在或不存在时是隐含的，并且应该由编译器处理。我们不必在运行时手动搜索适当转换运算符的隐蔽命名定义（例如“op_Explicit”），并在**运行时进行反射**关于所涉及的类型。此外，使用显式转换运算符进行批量/列表转换的 Cast/Convert 方法实际上应该是一个框架功能，并且`List.ConvertAll<T>`它们是……除了语言规范使得很难有效地获得转换运算符的委托！！！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-21T13:07:32.550

当然，明智的做法是使用`Select(i => (long)i)`，这就是我建议的内置值类型之间的转换和用户定义的转换。

但就像一个**奇怪**的评论一样，从 .NET 4 开始，您可以创建自己的扩展方法，也适用于这些类型的转换。但这需要您愿意使用`dynamic`关键字。它就像这样：

```
public static IEnumerable<TResult> CastSuper<TResult>(this IEnumerable source)
{
    foreach (var s in source)
        yield return (TResult)(dynamic)s;
} 
```

正如我所说，适用于整数转换（缩小或扩大转换）、浮点类型之间的数值转换以及类型`implicit operator`和`explicit operator`.

当然，它仍然适用于良好的旧参考转换和拆箱转换，如原始`System.Enumerable.Cast<TResult>`.

# .net - VS 2003/2005 和 2008 是否存在已知问题？

> ID：445472
> 
> 赞同：4
> 
> 时间：2009-01-15T02:47:26.517
> 
> 标签：.net, visual-studio

有谁知道 VS 2003/2005 和 2008 在同一安装中共存的任何问题。

注册表配置单元都是分开的，.net 框架都有自己的位置。我能想到的唯一问题是 Web 支持（可以是 1.1 或 2.0，但不能同时是两者）

我错过了什么吗？我会遇到麻烦吗？

*编辑*

我遵循了 2003, 2008 , 2005 , 2005 SP1 的顺序，并且缺少 Web 应用程序项目。其他人可以确认这是否是一个问题？我已经通过手动安装 WAP 解决了这个问题，但它应该包含在 SP1 中。

请参阅：[此链接](http://geekswithblogs.net/ehammersley/archive/2005/11/08/59451.aspx)以讨论 2005 年丢失的项目

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T02:49:21.803

没有。这是 Microsoft 支持的配置。

你最好按时间顺序安装它们，但根据我的经验，如果你不按顺序安装它们，效果很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T03:12:31.273

我的工作计算机安装了 VS2003、VS2005 和 VS2008。他们都可以毫无问题地工作。在家里，我决定只需要 VS2008，因为我不再使用 .NET 1.1。VS2008 能够通过更改项目属性选项卡中的设置来面向 .NET 2.0 及更高版本。

Web 支持在 IDE 和 IIS 中完成。这是针对每个 Web 应用程序的设置。这意味着拥有所有三个 Visual Studio 版本不会妨碍使用 Web 开发功能的能力。请注意，每个版本使用 Web 项目的方式略有不同。

我要提醒您的唯一一件事是小心安装任何随 VS2005 和 VS2008 提供的 SQL Server Express 版本。SQL Server Express 2008 一直在破坏 SQL Server Express 2005 的安装，即使我将它们安装在不同的目录中也是如此。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T02:52:11.720

过去，我已经在我的系统上安装了所有三个，并且一切正常。

尽管我认为您会发现将所有 2005 年的项目更新到 2008 年并消除其中一个会更容易，因为没有太多更改会影响两者之间的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T03:20:32.537

我已经将其中至少两个安装在同一个盒子上并且没有问题。如果你不小心的话，项目类型可能会显得很时髦。

无论如何，您可能希望在虚拟映像中进行开发。我开始这样做是因为我有具有各种不同配置的不同客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T03:22:08.773

唯一的问题可能是您并不确定从何处执行命令行实用程序。当你试图用“make”编译一些东西时，这可能会花费你几十个脑细胞。

# c++ - auto_ptr 设计

> ID：445475
> 
> 赞同：1
> 
> 时间：2009-01-15T02:48:42.443
> 
> 标签：c++

在我看来，一个类应该提供一个定义良好的抽象，并且不应该在没有类知识的情况下修改私有成员。但是当我检查“auto_ptr”（或任何其他智能指针）时，违反了这条规则。请看以下代码

```
class Foo{
public:
   Foo(){}
};

int main(int argc, char* argv[])
{
   std::auto_ptr<Foo> fooPtr(new Foo);
   delete fooPtr.operator ->();
   return 0;
} 
```

运算符重载 (->) 给出了基础指针，并且可以在不知道“auto_ptr”的情况下对其进行修改。我不能认为这是一个糟糕的设计，因为智能指针是由 C++ 极客设计的，但我想知道他们为什么允许这样做。有没有办法写一个没有这个问题的智能指针。

欣赏你的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T13:18:40.627

智能指针应该具有两个理想的属性：

1.  可以检索原始指针（例如，用于传递给遗留库函数）
2.  无法检索原始指针（防止双重删除）

**显然，这些性质是矛盾的，不能同时实现！** 甚至 Boost`shared_ptr<Foo>`等人。有`get()`，所以他们有这个“问题”。在实践中，第一个更重要，所以第二个必须去。

`operator->()`顺便说一句，当普通的旧`get()`方法导致同样的问题时，我不确定你为什么要稍微晦涩难懂：

```
std::auto_ptr<Foo> fooPtr(new Foo);
delete fooPtr.get(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T03:05:23.940

为了提供对底层对象的快速、方便、“类似指针”的访问，不幸的是，operator-> 不得不稍微“泄露”它的抽象。否则，智能指针将不得不手动包装所有允许公开的成员。这些要么需要实例化智能指针的部分进行大量“配置”工作，要么需要 C++ 中不存在的元编程级别。此外，正如 pyrsta 所指出的，即使这个漏洞被堵住了，仍然有许多其他（可能是非标准的）方法可以颠覆 C++ 的访问控制机制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T02:58:50.520

不，没有办法完全禁止 C++ 中的这种不良用法。

作为一般规则，任何库代码的用户都不应在任何包装的指针上调用 delete，除非特别记录。在我看来，所有现代 C++ 代码的设计都应该使类的用户永远不会完全负责手动释放她获得的资源（即，改用[RAII](http://en.wikipedia.org/wiki/RAII)）。

旁注：`std::auto_ptr<T>`不再是最佳选择。它在复制时的不良行为可能导致严重的编码错误。通常更好的主意是使用`std::tr1::scoped_ptr<T>`or`std::tr1::shared_ptr<T>`或它们的[Boost](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/smart_ptr.htm)变体。

此外，在 C++0x 中，`std::unique_ptr<T>`将在功能上取代`std::auto_ptr<T>`一个使用更安全的类。可以在[此处](http://home.roadrunner.com/~hinnant/unique_ptr03.html)找到有关该主题的一些讨论以及最近用于 unique_ptr 仿真的 C++03 实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T03:07:59.940

> 有没有办法写一个没有这个问题的智能指针。

这并不容易，而且通常不会（即，您不能为每个通用的 Foo 类都这样做）。

我能想到的唯一方法是更改`Foo`​​类的声明：将`Foo`析构函数设为私有（或将私有`delete`运算符定义为类的成员`Foo`），并在`Foo`类的声明中指定`std::auto_ptr<Foo>`是一个`friend`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-21T22:10:10.277

我不认为这表明 auto_ptr 存在封装问题。每当处理拥有的指针时，人们了解谁拥有什么是至关重要的。在 auto_ptr 的情况下，它拥有它持有的指针[1]；这是 auto_ptr 抽象的一部分。因此，以任何其他方式删除该指针都违反了 auto_ptr 提供的合同。

我同意误用 auto_ptr[2] 相对容易，这非常不理想，但在 C++ 中，你永远无法避免“谁拥有这个指针？”的基本问题，因为无论好坏，C++不会为您管理内存。

[1] 来自 cplusplus.com 的引用：“auto_ptr 对象具有获取分配给它们的指针所有权的特性”：[http ://www.cplusplus.com/reference/std/memory/auto_ptr/](http://www.cplusplus.com/reference/std/memory/auto_ptr/)

[2] 例如，您可能错误地认为它具有值语义，并将其用作向量模板参数：[http ://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved =0CEEQFjAD&url=http%3A%2F%2Fwww.gamedev.net%2Ftopic%2F502150-c-why-is-stdvectorstdauto_ptrmytype--bad%2F&ei=XU1qT5i9GcnRiAKCiu20BQ&usg=AFQjCNHigbgumbMG3qMTmMPla2zo4LhaE1Q&2B2=WSyJF2eWDr](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved=0CEEQFjAD&url=http%3A%2F%2Fwww.gamedev.net%2Ftopic%2F502150-c-why-is-stdvectorstdauto_ptrmytype--bad%2F&ei=XU1qT5i9GcnRiAKCiu20BQ&usg=AFQjCNHigbgumbMG3MTmMPla2zo4LhaE1Q&sig2=WSyJF2eWrq2aB2qw8dF3Dw)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-27T12:36:05.750

我认为这个问题解决了一个非问题。智能指针用于管理指针的所有权，如果这样做会使指针不可访问，它们就达不到目的。

还要考虑这个。任何容器类型都会为您提供迭代器；if`it`是这样的迭代器 then`&*it`是指向容器中项目的指针；如果你说`delete &*it`那你就死定了。但是暴露其项目的地址并不是容器类型的缺陷。

# php - 在 MySQL 端或 PHP 中对 SQL 数据进行分组？

> ID：445481
> 
> 赞同：0
> 
> 时间：2009-01-15T02:52:50.610
> 
> 标签：php, mysql

我在 MySQL 中有以下表格：

```
team: id, name, [more stuff]
person: id, name, team, [more stuff]
entry: id, name, team, [more stuff]
registrations: id, event_id, team, status
registration_people: registration_id, person_id
registration_entries: registration_id, entry_id 
```

我想查询数据库，并返回有关每个人和条目的详细信息；按注册分组。多年来，我学会了尽可能多地使用 SQL。但是，我没有在 PHP 中做大量工作的情况下在单个查询中生成它的好方法。天真的方法是[伪代码]：

```
$registrations = $model->get_registrations($event_id);
foreach ($registrations as $registration)
{
    $registration['people'] = $model->get_people_in_registration($registration['id']);
    $registration['entries'] = $model->get_entries_in_registration($registration['id']);
}
return $registrations; 
```

此代码多次往返服务器，不应使用。我的另一个想法是做类似的事情：

```
$registrations = $model->get_registrations($event_id);
$registration_entries = $model->get_registration_entries($event_id);
$registration_people = $model->get_registration_people($event_id);
foreach ($registrations as $r)
    $reg[$r['id']] = $r;
foreach ($registrations_entries as $e)
    $reg[$e['registration_id']]['entries'][] = $e;
foreach ($registrations_people as $p)
    $reg[$p['registration_id']]['people'][] = $p;
return $reg; 
```

加入在哪里`get_registration_entries/get_registration_people`，并`registration_entries`获取与`$event_id`. 但是，这似乎是我在加入 PHP；当我可以让 SQL 为我做这件事的时候。我只是偏执，还是我在这里错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T03:20:27.857

“尽可能多地使用 SQL”概念仅在减少从数据库读取的数据量或到数据库的往返次数时才有效。如果您无论如何都需要获取数据，那么在数据库中对它进行分组有什么意义呢？用 PHP 做起来要容易得多。

你应该这样做：

```
select r.registration_id, p.*
from registration_people rp, registrations r, person p
where /* your filter conditions on the "registration" table */
and rp.registration_id = r.id
and p.id = rp.person_id 
```

（我想这与您的第二种方法几乎相同）

这样，您就可以从数据库中获取所有相关数据，仅此而已。现在您可以在 PHP 中对结果进行本地分组。这种方法非常有效，因为您只需要从数据库中获取尽可能多的数据，并且不会对数据库进行不必要的往返。

# javascript - 任何带有浮动工具提示的 Flot 示例？

> ID：445482
> 
> 赞同：21
> 
> 时间：2009-01-15T02:53:52.823
> 
> 标签：javascript, jquery, jquery-events, flot, graphing

我目前正在研究[Flot](http://code.google.com/p/flot/)图，该[API](http://flot.googlecode.com/svn/trunk/API.txt)总体上看起来非常强大，尽管高级使用的示例没有被广泛记录。

API 建议有一些方法可以在图表上设置悬停，而不是我确定这到底意味着我可以用它做什么。

我想知道是否有人可以提供一些他们遇到的示例，或与此相关的代码，这些示例演示了以下任何示例：

*   将鼠标悬停在 Flot 图表元素上的事件上触发的动态工具提示
*   勾选工具提示（悬停在 xaxis 上显示详细信息）
*   已使用 w Flot 的任何类型的悬停/动态事件绑定

我正在寻找的效果类似于[这个](http://teethgrinder.co.uk/open-flash-chart-2/tooltip.php)Open Flash Chart 示例

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-19T06:19:10.993

看看[这个 flot 示例](http://www.flotcharts.org/flot/examples/interacting/)，它演示了图表上绘图点的工具提示。（确保选中**启用工具提示**复选框。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-09T07:28:57.577

还有一个简单的工具提示插件，你可以在[这里找到](https://github.com/krzysu/flot.tooltip)

而且我还为插件添加了一些功能，你可以在 github 上找到它。 [https://github.com/skeleton9/flot.tooltip](https://github.com/skeleton9/flot.tooltip)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-06-24T16:20:54.723

[http://data.worldbank.org](http://data.worldbank.org)使用 Flot 构建并使用工具提示。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-02T17:51:15.067

西蒙的答案中的链接很好地提供了一个与浮动工具提示一起使用的钩子。但是，我发现我必须四处挖掘并削减代码才能实现悬停效果。这是结果（基本上来自[http://people.iola.dk/olau/flot/examples/interacting.html](http://people.iola.dk/olau/flot/examples/interacting.html)的逐字记录）。

在浮点初始化中唯一需要更改的设置是选项对象。它需要将此作为选项之一：

```
var options = {
 //... : {},
 grid: { hoverable: true }
}; 
```

此函数在调用时构造并显示工具提示元素。参数 x 和 y 是浮动内部的偏移量，因此工具提示位置正确。内容是工具提示中显示的内容

```
function showTooltip(x, y, contents) {
        $('<div id="tooltip">' + contents + '</div>').css({
            position: 'absolute',
            display: 'none',
            top: y + 5,
            left: x + 5,
            border: '1px solid #fdd',
            padding: '2px',
            'background-color': '#fee'
        }).appendTo("body").fadeIn(200);
    } 
```

这是绑定，它应该只在用作浮动占位符的元素可用时调用一次。它连接事件处理程序。previousPoint 用作显示工具提示的标志

```
 var previousPoint = null;
    $("#flotPlaceHolder").bind("plothover", function (event, pos, item) {
        if (item) {
            if (previousPoint != item.dataIndex) {
                previousPoint = item.dataIndex;

                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(0),
                    y = item.datapoint[1].toFixed(0);

                showTooltip(item.pageX, item.pageY, "(" + x + "," + y + ")");
            }
        }
        else {
            $("#tooltip").remove();
            previousPoint = null;
        }
    }); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-26T06:26:06.103

查看此库以获取工具提示和浮点集成

[https://github.com/krzysu/flot.tooltip](https://github.com/krzysu/flot.tooltip)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-11T21:21:04.387

[http://craigsworks.com/projects/qtip2/demos/#flot](http://craigsworks.com/projects/qtip2/demos/#flot)是我最喜欢的 JS 工具提示库。它非常糟糕并且具有浮动集成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-01T10:52:40.503

您可以将自定义数据添加到数据数组并使用它来显示工具提示。

在此处查看我的答案和完整示例： [display custom tooltip when hovering over a point in flot](https://stackoverflow.com/questions/4349823/displaying-custom-tooltip-when-hovering-over-a-point-in-flot/12671873#12671873)

# html - 将 SWF 文件链接到另一个 HTML

> ID：445487
> 
> 赞同：4
> 
> 时间：2009-01-15T02:58:24.733
> 
> 标签：html, flash, actionscript

我在使用 SWF 文件时遇到问题。我的 HTML 页面上有一个 SWF 文件，我需要将它链接到我使用的另一个 HTML，但锚点不起作用。任何人都可以帮助我。如何链接 SWF 文件。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-15T05:16:32.253

您可以使用 SWFObject 像这样添加*flashvar*：

```
<script type="text/javascript">
    var flashvars = {};
    flashvars.targetURL = "http://www.stackoverflow.com";
    var params = {};
    var attributes = {};
    swfobject.embedSWF("myflashmovie.swf", "myAlternativeContent", "800", "600", "9.0.0", false, flashvars, params, attributes);
</script> 
```

话虽这么说，这是假设在您的 Flash 电影中，它的编码使得 Flash 电影期待该*flashvar*并使用该链接到规定的 URL

在 AS 2.0 中，它将是：

```
getURL(_root.targetURL); 
```

在 AS 3.0 中，它将是：

```
var flashvars:Object = LoaderInfo(this.root.loaderInfo).parameters;
var linkURL = flashvars['targetURL']; 
var link:URLRequest = new URLRequest (linkURL);
navigateToURL(link); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-25T02:53:45.097

我想我修好了。这是我所做的：

1.  制作了一个与您希望 Flash 视频所在的区域大小相同的清晰 png 图形

2.  在 Flash 视频上创建一个新图层（div 标签） - 您必须在标准视图中编辑图层 - 图层就像表格：它们包含图像、文本等（注意：如果您使用表格，div 标签将浮动调整浏览器大小时在表格上方）

3.  将空白 png 添加到新图层中

4.  使用 Dreamweaver 中的属性窗口链接空白 png！

5.  在包含 flash 对象的对象标记中添加这行代码。这会将您的 Flash 电影的背景设置为透明，并允许将 png 图层放置在其上方。如果您仍然需要您的 Flash 电影有背景，只需在您的 Flash 电影中创建一个彩色框并将其用作背景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T04:09:33.933

这是一篇关于如何通过 Flash 导航到 url 的博客文章的链接：

[链接到动作脚本 3 中的 url](http://www.graphicmania.net/linking-to-url-in-action-script-3-writen-by-rafiq-elmansy/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-06T08:23:53.667

您也可以添加 javascript 命令，但 onclick 不起作用，因为它已经预设。通过使用 onmouseover 命令可以解决问题，但你想这样做吗？如果是这样的话

```
`<object type="application/x-shockwave-flash" onMouseOver="parent.location='http://www.mysite.com'"> <param name="wmode" value="transparent" /><param name="movie" value="101.swf" /></object> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-13T20:29:03.207

onmouseup 做的工作就像（不完全一样）点击，它对我有用。因为 onclick 在那里不起作用。

```
object type="application/x-shockwave-flash" **onmouseup="document.location='http://www.mysite.com';"**> 
<param name="wmode" value="transparent" />
<param name="movie" value="101.swf" />
</object> 
```

# xml - 使用免费在线工具验证/调试 Mathml 的最佳方法是什么？

> ID：445488
> 
> 赞同：1
> 
> 时间：2009-01-15T02:58:34.140
> 
> 标签：xml, editor, validation, mathml

我有一些里面有 math ml 的 xml，我想在网上找到一些免费的工具，我可以用来验证，如果可能的话，甚至可以编辑 math ml。

任何人都知道我可以用来执行此操作的任何好工具吗？谢谢。

## 编辑：

Firefox 3.03 是否原生支持 MathML？我根本无法显示一些方程式。我知道在[IE 中我使用 MathPlayer](http://www.dessci.com/en/products/mathplayer/download.htm)让它运行。

这是代码块，[仅供参考，我尝试将其复制并粘贴为 htm 并在 IE7 中运行，在 MathPlayer 的帮助下可以很好地转换它，而在 FF3 中它看起来很乱]：

```
<HTML XMLNS:m="http://www.w3.org/1998/Math/MathML">
<head>
</head>
<body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" onresize="javascript:hideNavigation()" onkeydown="onKeyDown()" style="background:#FFFFFF">
</b><font COLOR="#000000" FACE="Times New Roman" SIZE="3" >&#1581;&#1604;&#1604;&nbsp;&nbsp;&#1575;&#1604;&#1593;&#1576;&#1575;&#1585;&#1577;<font FACE="Times New Roman">&nbsp;<font FACE="Times New Roman">&#1578;&#1605;&#1575;&#1605;&#1575;&#1611;&nbsp;&nbsp;&#1573;&#1604;&#1609;&nbsp;&nbsp;&#1593;&#1608;&#1575;&#1605;&#1604;&#1607;&#1575;&nbsp;&nbsp;&#1575;&#1604;&#1571;&#1608;&#1604;&#1610;&#1577;<font FACE="Times New Roman">&nbsp;  </font> </font></font></font> 
<span style="font-family: Times new roman">
<object id="MathPlayer" classid="clsid:32F66A20-7614-11D4-BD11-00104BD3F987">
</object>
<?import namespace="m" implementation="#MathPlayer" ?>
<m:math xmlns:m="http://www.w3.org/1998/Math/MathML"><m:mn>3</m:mn>
<m:msup><m:mrow><m:mi>s</m:mi>
</m:mrow>
<m:mrow><m:mn>2</m:mn>
</m:mrow>
</m:msup>
<m:msup><m:mrow><m:mi>x</m:mi>
</m:mrow>
<m:mrow><m:mn>2</m:mn>
</m:mrow>
</m:msup>
<m:mo>&amp;plus;</m:mo>
<m:mn>42</m:mn>
<m:msup><m:mrow><m:mi>s</m:mi>
</m:mrow>
<m:mrow><m:mn>2</m:mn>
</m:mrow>
</m:msup>
<m:mi>hx</m:mi>
<m:mo>&amp;plus;</m:mo>
<m:mn>72</m:mn>
<m:msup><m:mrow><m:mi>s</m:mi>
</m:mrow>
<m:mrow><m:mn>2</m:mn>
</m:mrow>
</m:msup>
<m:msup><m:mrow><m:mi>h</m:mi>
</m:mrow>
<m:mrow><m:mn>2</m:mn>
</m:mrow>
</m:msup>
</m:math>&nbsp;</span>
</body>
</HTML> 
```

任何人都知道任何好的提示来检查这里可能出现的问题吗？截至目前，我只能怀疑浏览器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T03:23:16.383

试试这个： http: [//www.adrian.zentner.name/content/projects/xml/mathml/onlineEditor/index.html](http://www.adrian.zentner.name/content/projects/xml/mathml/onlineEditor/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-11T17:43:00.823

在他们的旧网站上有一个[Mozilla MathML Tester 。](https://www-archive.mozilla.org/projects/mathml/demo/tester.html)

还有一个[Wolfram Research MathML 重绘工具](http://www.mathmlcentral.com/Tools/FromMathML.jsp)。

还可以在[W3C 标记验证服务](https://validator.w3.org/#validate_by_input)中检查 MathML 代码是否有错误，无需渲染。

# c# - C Sharp 中的“朋友”关键字相当于什么？

> ID：445490
> 
> 赞同：21
> 
> 时间：2009-01-15T02:58:54.747
> 
> 标签：c#, friend, internal, friend-class

C Sharp 中的“朋友”关键字相当于什么？

如何使用“内部”关键字？

我读过'internal'关键字是C#中'friend'的替代品。

我在我的 C# 项目中使用了一个 DLL，我有它的源代码，但我不想修改现有代码。我继承了这个类，我可以以任何我想要的方式使用我继承的类。问题是父类中的大部分代码都有受保护的方法。使用朋友是否可以访问或调用这些受保护的方法？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-15T03:15:18.600

1.  您可以使用关键字访问修饰符[`internal`](http://msdn.microsoft.com/en-us/library/7c5ka91b.aspx)将类型或类型成员声明为只能由同一程序集中的代码访问。

2.  您可以使用 中[`InternalsVisibleToAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)定义的类将[`System.Rutime.CompilerServices`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.aspx)类型声明为同一程序集中的代码或仅指定程序集中的代码可访问。

您使用第一个，因为您使用任何其他[访问修饰符](http://msdn.microsoft.com/en-us/library/ms173121.aspx)，例如`private`. 以机智：

```
internal class MyClass {
    ...
} 
```

您使用第二个如下：

```
[assembly:InternalsVisibleTo("MyFriendAssembly", PublicKey="...")]
internal class MyVisibleClass {
    ...
} 
```

这两者都可以正确地视为`friend`C# 中的等价物。

[`protected`](http://msdn.microsoft.com/en-us/library/bcd5672a.aspx)派生类已经可以使用的方法。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-11-13T17:00:18.207

不，“内部”与“朋友”不同（至少是 C++ 的“朋友”）

朋友指定这个类只能由一个特定的类访问。
internal 指定该类可由程序集中的任何类访问。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T03:07:40.813

1.  [`internal`](http://msdn.microsoft.com/en-us/library/7c5ka91b(VS.80).aspx)正如您所猜测的那样，是 VB.NET 关键字的 C# 等效项`friend`（而不是替换）

2.  用法如下

    ```
    internal void Function() {}
    internal Class Classname() {}
    internal int myInt;
    internal int MyProperty { get; set; } 
    ```

3.  基本上，它是一个访问修饰符，它规定标记为内部的类/函数/变量/属性的可访问性就好像它对编译它的程序集是公共的，而对任何其他程序集都是私有的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T03:08:43.790

您的子类将能够访问您继承的类的受保护成员。

您是否希望将这些受保护成员的访问权限授予另一个类？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-25T11:30:07.957

这是我用来添加类似于 C++`friend`关键字的行为的奇怪技巧。**这仅适用于嵌套类 AFAIK。**

1.  使用您希望通过属性访问的变量创建嵌套`protected`或接口。`private`
2.  让嵌套类继承这个接口并*显式地*实现它。
3.  每当使用此嵌套类的对象时，将其强制转换为接口并调用相应的属性。

这是 Unity 的一个示例。

```
using System;
using UnityEngine;
using UnityEngine.Assertions;

namespace TL7.Stats
{
    [CreateAssetMenu(fileName = "Progression", menuName = "TL7/Stats/New Progression", order = 0)]
    public class Progression : ScriptableObject
    {
        // Provides access to private members only to outer class Progression
        protected interface IProgressionClassAccess
        {
            CharacterClass CharacterClass { get; set; }
        }

        [System.Serializable]
        public struct ProgressionClass : IProgressionClassAccess
        {
            [Header("DO NOT EDIT THIS VALUE.")]
            [SerializeField] private CharacterClass characterClass;
            [Tooltip("Levels are 0 indexed.")]
            [SerializeField] float[] healthOverLevels;

            public float[] HealthOverLevels => healthOverLevels;

            CharacterClass IProgressionClassAccess.CharacterClass
            {
                get => characterClass;
                set => characterClass = value;
            }
        }

        static readonly Array characterClasses = Enum.GetValues(typeof(CharacterClass));
        [SerializeField] ProgressionClass[] classes = new ProgressionClass[characterClasses.Length];

        public ProgressionClass this[in CharacterClass index] => classes[(int)index];

        void Awake()
        {
            for (int i = 0; i < classes.Length; ++i)
            {
                // Needs to be cast to obtain access
                (classes[i] as IProgressionClassAccess).CharacterClass = (CharacterClass)characterClasses.GetValue(i);
            }
        }

#if UNITY_EDITOR
        public void AssertCorrectSetup()
        {
            for (int i = 0; i < characterClasses.Length; ++i)
            {
                CharacterClass characterClass = (CharacterClass)characterClasses.GetValue(i);
                Assert.IsTrue(
                    (this[characterClass] as IProgressionClassAccess).CharacterClass == characterClass,
                    $"You messed with the class values in {GetType()} '{name}'. This won't do."
                );
            }
        }
#endif
    }
} 
```

我认为这只适用于嵌套类。如果您想对常规类执行此操作，则需要将它们嵌套在部分外部类中，这在理论上应该可以工作，并使用一个`protected`或`private`嵌套接口（或两个，如果您愿意）为它们提供访问权限对彼此的私人... 出来错了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T03:07:48.723

内部相当于朋友。受保护的方法仅在同一类中或从继承者中可用。如果您试图从继承者公开受保护的方法，您可以将它们包装在公共方法中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-02T11:39:10.707

将一个大类拆分为两个部分类文件可以实现所需的朋友效应。它不等效，但在某些情况下有效。

# git - 你能用 git svn 指定哪些 svn 分支吗？

> ID：445500
> 
> 赞同：3
> 
> 时间：2009-01-15T03:05:00.663
> 
> 标签：git, version-control, git-svn

[我认为我的问题与CaptainPicard 的](https://stackoverflow.com/questions/258590/how-do-i-import-svn-branches-rooted-in-different-directories-into-git-using-git-s "如何使用 git-svn 将不同目录中的 svn 分支导入 git？")问题有些相似，但又足够不同，以至于我不得不问，所以就这样吧。

我有一个旧的 SVN 存储库，其中包含大约 7500 个修订版，其中 7500 个修订版中的一部分是一些非常大的 .fla 文件。这些 .fla 文件存在于许多已创建的分支中。因此，导入后我的 .git 目录非常大，如果我得到整个主干、所有分支和所有标签，则大约为 3.5 GB。为了将其配对，我对我想要使用的主干中的目录进行了另一个 svn 克隆，但包括所有分支显然会拉下所有历史记录和对象。

所以我的问题是，有没有办法告诉 git 只获取某些分支。例如只获取以某个标识符开头的分支（例如 mybranch）？

***为清楚起见更新：***我知道我可以将 git svn init/clone 指向单个特定分支。我想要做的就是将它指向一组分支。例如，不匹配分支/*，只匹配 mybranchset* 的分支

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T20:55:44.137

在`git svn`命令中，您只能使用星号通配符来指定目录的所有成员 ( `directoryname/*`) 而不是文件名变体 ( `fileprefix*`)。如果`git svn`修改为使用 SVN 的新合并跟踪，将来可能会改变。

因为 Git 只为每个分支存储一个提交的指针（而不是相关文件的重复目录），所以一旦你重新打包它，你的 Git 存储库将大大减小，正如匿名答案所说。不幸的是，Git 不能像存储文本文件提交那样为 Flash 文件存储变更集，因此它们在更改时会被复制。

我建议你使用

```
$ git gc --aggressive 
```

重新打包你的回购。它修剪重复项并处理比`git repack`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T03:22:47.397

您可以使用您选择的 svn url 指定 git svn init，包括指向特定分支甚至分支的一部分。

您还应该考虑执行“git repack -f -a -d --window=250”以查看 git 是否可以找到某种方法来缩小 3.5 GB 存储库。

# linux - 具有 Linux 角色的 Web CRUD 应用程序的最佳语言/框架

> ID：445511
> 
> 赞同：0
> 
> 时间：2009-01-15T03:11:11.867
> 
> 标签：linux, crud, rad, security-roles

我有一个 Linux 网络服务器，我想在网络上为 CRUD 提供一些数据库表（当前在 Access 中）。需要基于角色的安全性。开发这个的最快途径是什么？

另外，哪个数据库最好？如果有什么不同的话，我已经在那个盒子上运行了 mySQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T03:20:47.433

这将变成 Ruby on Rails 阵营和 Python 阵营之间的一场宗教战争，只对 PHP 和 Perl 知之甚少。您应该自己评估语言并决定最适合您的语言。当然，还有其他选择，但列出这些只会引发宗教斗争。虽然，我会说我列出的所有这些都是合理的选择。尽管您选择的语言可能有任何缺点，但您通常可以创建一个好的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T07:29:57.040

我同意 Chuck 的观点，问题不应该是关于语言，而是关于你选择的框架。

不久前我做了一些与您类似的事情，最后使用 Ruby on Rails 和 activescaffold 插件 ( [http://www.activescaffold.com/](http://www.activescaffold.com/) ) 来提供漂亮的前端。我最终编写的实际代码非常少。Rails 的其他插件也提供基于角色的安全性（我没有打扰，我只是说“您要么已登录并具有写访问权限，要么您未登录并且没有”）这也意味着你不必自己写很多东西。

所以把我放在Rails的营地里，来一场宗教战争；）

编辑： MySQL 是一个完美的数据库，所以你不必担心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T03:48:23.617

我不认为语言是你应该问的问题。没有一种语言特别适合 CRUD Web 应用程序。但是，有许多为这类事情设计的*框架，有许多不同的语言，而这些可能是您想要查看的。*

我认为 Rails 总体上是最好的，这就是我在大多数项目中使用的。它非常适合 CRUD 应用程序（以至于它允许您创建一个简单的应用程序而无需编写任何代码）。但如果真的有一个无可争议的“最佳”选择，你可能已经知道了。相反，有些应用程序是用 Rails 制作的，有些是用 Django 制作的，有些是用 Cake 制作的，等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-06T01:59:46.723

如果您想要一个可以在未来几年维护和扩展的可靠、干净、稳定的 CRUD Web 应用程序，请坚持以下标准：PHP、Perl、JavaScript、CSS 和 HTML。好好学习这些根源语言。花点时间做正确的事，并专注于良好的编码习惯，如清晰、一致性和组织性。练习良好的代码重用、良好的命名、良好的注释和良好的数据库设计。测试、记录和重构。为您的 CRUD 应用程序的工艺感到自豪。内外兼修。设置舞台，以便您以后可以维护和扩展它。您的目标是打造能够运行良好、持续很长时间并从商业投资中获得丰厚回报的产品。有人曾经说过，成为一名优秀的程序员需要 10 年的时间。

至于框架、插件和外部库，这简直是锦上添花。但永远不要把糖衣和蛋糕混为一谈。如果您想学习编码，请花时间正确学习。如果您不习惯编写简单的 CRUD 应用程序，那么您在尝试浏览框架生成的代码时会更加不自在。编码是一场精彩的演出。但永远不要把嘶嘶声误认为是牛排。

# vba - 当工作表在 MS-Excel 中受到保护时，如何避免运行时错误？

> ID：445519
> 
> 赞同：10
> 
> 时间：2009-01-15T03:14:13.860
> 
> 标签：vba, excel

下面的代码片段会更改单元格的数据验证状态，并在 Excel-2003 工作表不受保护时运行。但是，当我保护工作表时，宏不会运行并引发运行时错误

> 运行时错误“-2147417848 (80010108)”：
> 
> 对象“验证”的方法“添加”失败

我试过用

```
Me.unprotect
...
Me.protect 
```

但这不能正常工作。那么，当工作表受到保护而没有上述运行时错误时，如何修改下面的代码以使其工作（即让代码修改解锁单元格的验证）？

**更新**

我的原始工作簿是 Excel 2003。我在 Excel 2007 中测试了 @ [eJames解决方案，Workbook_Open 的定义如下](https://stackoverflow.com/questions/445519/how-do-i-avoid-run-time-error-when-a-worksheet-is-protected-in-ms-excel#447247)

```
Sub WorkBook_Open()
    Me.Worksheets("MainTable").Protect  contents:=True, userinterfaceonly:=True 
End Sub 
```

当工作表受到保护时，代码仍然失败并出现以下运行时错误

> 运行时错误“1004”：应用程序定义的或对象定义的错误

谢谢， 阿齐姆

* * *

**代码片段**

```
'cell to add drop down validation list'
dim myNamedRange as String
dim modifyCell as Range 
modifyCell = ActiveCell.Offset(0,1) 

' set list values based on some conditions not defined for brevitity'
If myCondition then
   myNamedRange = "range1"
Else
   myNamedRange = "range2"
End If

With modifyCell.Validation
   .Delete

   'Run time error occurs on the next line'
   .Add Type:=xlValidateList, AlertStyle:=xlValidAltertStop, _
        Operator:=xlBetween, Formula1:="=" & myNamedRange

   ... 
   ' skipping more property setting code '
   ...
End With 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T15:44:54.047

如果我正确理解了这个问题，您将成为保护工作表的人。如果是这种情况，您可以使用以下 VBA：

```
myWorksheet.Protect contents:=True, userinterfaceonly:=True 
```

这里的关键部分是“userinterfaceonly:=true”。当使用此标志集保护工作表时，仍允许 VBA 宏进行更改。

将此代码放入`WorkBook_Activate`事件中以自动保护工作簿并在激活时设置标志。

**编辑：**感谢[Lance Roberts](https://stackoverflow.com/users/13295/lance-roberts)建议使用`Workbook_Activate`而不是`Workbook_Open`.

**编辑：**由于上述方法似乎不起作用，您可能必须使用 unprotect/protect 命令包装 VBA 代码的失败部分。如果您这样做，我还将使用错误处理程序包装整个宏，以便在发生错误后不会使工作表不受保护：

```
Sub MyMacro
    On Error Goto HandleError

    ...

    myWorksheet.unprotect
    With ModifyCell.Validation
        ...
    End With
    myWorksheet.protect contents:=True, userinterfaceonly:=True

    ...

Goto SkipErrorHandler
HandleError:
    myWorksheet.protect contents:=True, userinterfaceonly:=True
    ... some code to present the error message to the user
SkipErrorHandler:
End Sub 
```

**编辑：**在 PCreview看看[这个线程](http://www.pcreview.co.uk/forums/thread-977380.php)。他们经历了几乎相同的步骤，并得出了相同的结论。至少你不是一个人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-13T21:36:48.077

我不确定这是否是一个通用解决方案，但是当我最近遇到此错误时，我只需要在执行 Validation.Add 之前执行 MywkSheet.Activate。所以：

```
' set list values based on some conditions not defined for brevitity'
If myCondition then
   myNamedRange = "range1"
Else
   myNamedRange = "range2"
End If

''--------------------------------------------------
Sheets("mysheet").Activate
''--------------------------------------------------

With modifyCell.Validation
   .Delete

   'Run time error occurs on the next line'
   .Add Type:=xlValidateList, AlertStyle:=xlValidAltertStop, _
        Operator:=xlBetween, Formula1:="=" & myNamedRange

   ... 
   ' skipping more property setting code '
   ...
End With 
```

就我而言，ScreenUpdating 已经关闭，因此用户永远不会看到工作表来回切换。HTH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-26T21:13:51.323

问题在于，要使 VBA 能够编辑受保护的工作表，必须使用设置为 True 的“UserInterfaceOnly”参数来保护工作表。但是，保存工作簿时不会保存 UserInterfaceOnly 参数，因此如果关闭并重新打开工作簿，则会发生错误。

这是一个解决方案：

1.  创建一个保护所有工作表并将 UserInterfaceOnly 参数设置为 true 的子程序。我把它分成 ProtectSheet 和 ProtectAll 子：

_

```
Sub ProtectSheet(SheetName As String)
    Dim pswd As String
    pswd = "pass" ' YOU SHOULD GET THE PASSWORD FROM SOMEWHERE SECURE, NOT HARDCODE IT

    ThisWorkbook.Worksheets(SheetName).Protect Password:=pswd, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
        UserInterfaceOnly:=True, AllowFormattingCells:=False, AllowFormattingColumns:=False, _
        AllowFormattingRows:=False, AllowInsertingColumns:=False, AllowInsertingRows:=False, _
        AllowInsertingHyperlinks:=False, AllowDeletingColumns:=False, AllowDeletingRows:=False, _
        AllowSorting:=False, AllowFiltering:=False, AllowUsingPivotTables:=False

End Sub

Sub ProtectAll()
    Dim ws As Worksheet
    For Each ws In ThisWorkbook.Worksheets
        ProtectSheet (ws.Name)
    Next ws
End Sub 
```

2.  在 ThisWorkbook 中，在工作簿打开时保护所有工作表：

```
Private Sub Workbook_Open()
    Call ProtectAll ' Protect all with UserInterfaceOnly set to true so VBA can edit
End Sub 
```

# wpf - 如何自动设置数据绑定 ListView 的列宽

> ID：445524
> 
> 赞同：0
> 
> 时间：2009-01-15T03:15:44.370
> 
> 标签：wpf, listview

我有一个数据绑定列表视图，可以手动设置除最后一个之外的所有列宽。最后一个字段的数据长度变化很大。最后一列需要扩展以处理数据的宽度以及更大的滚动。我尝试将最后一列的宽度设置为一个非常大的数字，但这会将列标题从页面上移开。如何计算最后一列显示数据所需的最小宽度以及是否很大以将列标题保留在页面上？

```
<ListView x:Name="ListViewFlightPlans" Background="#FF000000" IsSynchronizedWithCurrentItem="True" Width="659.5" Height="Auto" 
                      Foreground="#FFFDF3F3"  BorderBrush="{x:Null}" VerticalAlignment="Bottom" Visibility="Hidden" >
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="CID" DisplayMemberBinding="{Binding Path=CID}" Width="50"/>
                        <GridViewColumn Header="Callsign" DisplayMemberBinding="{Binding Path=ACID}" Width="65"/>
                        <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Path=Type}" Width="65"/>
                        <GridViewColumn Header="Route" DisplayMemberBinding="{Binding Path=Route}" Width="900 e"/>
                    </GridView>
                </ListView.View>
            </ListView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T04:52:09.527

因为您的标题离开页面，我假设您的标题居中或右对齐。左对齐标题以使其保持不变（您可以在左侧添加填充以伪造居中或右对齐的标题）。

使用 Width="Auto" 使列的宽度根据列中最宽的项展开。

例子：

```
<GridViewColumn Header="Route" DisplayMemberBinding="{Binding Path=Route}" 
     Width="Auto"
     HeaderContainerStyle="{StaticResource WideColumnHeader}"
/>
...
‹!--Somewhere in your resources--›
...
‹Style x:Key="WideColumnHeader" TargetType="{x:Type GridViewColumnHeader}"›
   ‹Setter Property="HorizontalContentAlignment" Value="Left" /›
   ‹Setter Property="Padding" Value="40,0,0,0"
‹/Style›
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T03:18:11.260

您可以尝试使用 % 而不是像素，也许将 60% 分配给最后一列，而剩余的 40% 可以由前 3 列使用....（未经测试的猜测）。

# ruby - ZenTest 如何检测文件保存？

> ID：445545
> 
> 赞同：0
> 
> 时间：2009-01-15T03:25:02.090
> 
> 标签：ruby, zentest

我阅读了 ZenTest 的一些源代码，但没有找到它的实现位置。

你能给我一些线索吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T04:17:51.750

看起来它在`autotest.rb`方法中被调用`find_files_to_test`，该算法非常基本，它每秒检查所有影响测试的文件的日期，然后对更改的文件使用一些依赖性分析，它决定运行哪些测试。

在 Windows 中，如果它使用文件系统观察程序，这将明显更快。

睡眠时间定义为初始化`self.sleep = 1`并从`wait_for_changes`

```
Kernel.sleep self.sleep until find_files_to_test 
```

# nant - NAnt 和 Vault 文档

> ID：445549
> 
> 赞同：0
> 
> 时间：2009-01-15T03:26:59.840
> 
> 标签：nant, sourcegear-vault

因此，我正在寻找有关 NAnt for Vault 中可用标签的文档。我在 SourceGear 的网站上看到了一些示例，但我不认为它们是详尽的列表。有没有地方知道我在哪里可以找到所有符合条件的标签的文档？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T04:54:11.287

可以通过下载“NAnt 任务 (zip)”在[Vault 下载](http://www.sourcegear.com/vault/downloads.html)处找到此文档以及 Vault的 NAnt 任务。该文档作为 CHM 包含在 zip 中的 doc 文件夹中。它包含所有任务的文档，以及每个任务的所有属性。

要使 NAnt 任务正常工作，请将它们复制到您拥有 NAnt 的文件夹中的 bin 文件夹（nant.exe 所在的位置）。只需确保 Vault 任务与您的 NAnt 版本匹配（当前最新版本适用于 NAnt 0.85）。

在某个时候，我还在 SourceGear 网站的某个地方找到了这个的源代码，但我现在无法做到。

# asp.net - 如何编写用户定义函数？

> ID：445550
> 
> 赞同：1
> 
> 时间：2009-01-15T03:27:10.477
> 
> 标签：asp.net, linq-to-sql, user-defined-functions

我想把它写成用户定义的函数：

```
private double Score(Story s){            
               DateTime now = DateTime.Now;            
               TimeSpan elapsed = now.Subtract(s.PostedOn);            
               double daysAgo = elapsed.TotalDays;            
               return s.Votes.Count + s.Comments.Count - daysAgo;       
                              } 
```

这可能与UDF有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T03:28:45.357

[可以，但是如果您使用的是 SQL Server 2000，则必须传入“now”的值——UDF在 SQL Server 2000 中](http://wardyit.com/blog/blog/archive/2006/02/15/84.aspx)不能自己生成任何非确定性值。

这个未经测试的尝试可能很接近：

```
CREATE FUNCTION dbo.GetStoryScore (
    @Now DATETIME, @Posted DATETIME, @Votes INT, @Comments INT
) RETURNS FLOAT AS
BEGIN

  RETURN @Votes + @Comments - DATEDIFF(HOUR, @Posted, @Now)/24.0

END 
```

示例用法：

```
SELECT S.ID, dbo.GetStoryScore(GETDATE(), S.Posted, S.Votes, S.Comments) AS Score
FROM Stories AS S
WHERE ... 
```

笔记：

*   datediff 以小时（而不是天）为单位执行，因为当您使用更精细的单位时，整数结果会为您提供更高的精度。

*   我传递了所有值，因为我发现函数内的查找对性能来说是一件非常非常糟糕的事情。

*   在 SQL 中引用时，不要忘记`dbo.`函数名前面的。

*   如果您使用的是 SQL Server 2005，则可以删除 @Now 变量并改为使用 GETDATE() 内联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T03:37:33.953

我想像下面这样的东西：

```
CREATE FUNCTION [dbo].[Score]
(@storyid int)
RETURNS float
AS
BEGIN
    DECLARE @ret float;
    DECLARE @elapsed float;

    SELECT @elapsed = DATEDIFF(n, getdate(), postedon) / 1440
    FROM stories WHERE storyid = @storyid;

    SET @ret = ((SELECT count(voteid) FROM votes WHERE storyid = @storyid) +
                    (SELECT count(commentid) FROM comments WHERE storyid = @storyid) -
                    @elapsed);
    RETURN @ret;
END 
```

# php - PHP / MySql Verbosity VS over the wire

> ID：445551
> 
> 赞同：0
> 
> 时间：2009-01-15T03:28:14.750
> 
> 标签：php, sql, performance, mysql

我已经开始用 PHP 编写一些相当大或令人困惑的 MySQL 查询。我试图在冗长和性能之间找到平衡。我的问题是性能是否与它有关。

它是我的查询中的空白和 MySQL 注释。对我来说，PHP会在发送之前过滤查询中不必要的空白，甚至可能是查询中的mysql注释，但我不确定......

如果是这样的话，空格和注释是否会通过线路从 PHP 传输到 MySQL，这在性能方面真的很重要吗？

我不是在寻找硬性能基准或任何我想了解更多关于这一点的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T03:36:13.703

是的，尽管我对 mysql 的了解还不够，但无法告诉您它们是否会影响性能，但它们会越界。我猜想，如果您必须对具有不同注释的相同查询进行处理，它们会稍微影响查询解析时间，并且 mysql 应该能够针对重复查询进行优化。不过，我怀疑通常网络和数据库服务器之间的传输延迟和结果的大小会使查询和解析查询的任何性能问题相形见绌，而且如果没有你不会真正知道的真实数字。就个人而言，这不会是我太担心的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T03:45:53.687

我支持小冲突的评论。在性能优化方面，还有许多其他地方可以让您获得更大的收益。压缩 SQL 查询的大小在此列表中并不高。

# asp.net - 带有 99:99 时间掩码的 ASP.net Toolkit 掩码编辑控件

> ID：445553
> 
> 赞同：0
> 
> 时间：2009-01-15T03:28:57.230
> 
> 标签：asp.net, webforms, maskededitextender

我正在尝试使用 asp.net ajax 工具包掩码编辑控件来使用掩码 99:99 和 masktype="time" 属性集的小时/分钟输入。

但是它似乎没有做任何时间验证客户端或服务器端......它允许我输入任何数字，如 88:77 这不是有效时间。

这是控件中的错误还是有某种方法可以将其配置为需要一个小时/分钟的组合，如果不可能，您能否建议一个允许它的免费控件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T10:50:01.723

这可能是一个愚蠢的问题，但是您也向页面添加了一个 MaskedEditValidator 控件，并将其连接起来？

```
<ajaxToolkit:MaskedEditValidator
  ControlExtender="MaskedEditExtender2" /> 
```

它们是单独的控件，已添加到您的页面。

ETA：此外，如果您没有添加至少一个“InvalidValueBlurredMessage”（如果“IsValidEmpty”设置为false，则为“EmptyValueMessage”）或“OnInvalidCssClass”，验证器似乎不会在客户端执行任何操作。

# windows-mobile - 创建 Windows Mobile 模拟器映像

> ID：445561
> 
> 赞同：3
> 
> 时间：2009-01-15T03:32:56.130
> 
> 标签：windows-mobile, emulation

我想知道是否有办法创建我自己的 Windows Mobile 模拟器图像。我有一部索尼爱立信 XPERIA X1 手机，它有一个 480x800 的 3 英寸屏幕，大约 300 DPI。

我想创建一个具有正确屏幕属性的模拟器图像，并希望创建一个类似于正确按钮位置和手机内容的皮肤。

我确实拥有手机，因此如有必要，我可以从手机中创建图像。

这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T04:45:37.043

对于所描述的内容，您不需要自定义图像（如果需要，您也无法创建图像）。模拟器映像仅包含操作系统功能本身。皮肤、按钮和屏幕大小都在 XML 文件中配置。

例如，安装 WinMo 5.0 SDK，然后导航到此处：

```
C:\Program Files\Windows Mobile 5.0 SDK R2\PocketPC\Deviceemulation\Pocket_pc 
```

您将找到 Pocket_PC.xml。其中描述了诸如皮肤图像（以及按钮操作）之类的内容：

```
<view
    titleBar ="Pocket PC - WM 5.0"
    displayPosX="55"
    displayPosY="67"
    displayWidth="240"
    displayHeight="320"
    displayDepth="16"
    mappingImage="pocket_pc_emulator_mask.png"
    normalImage="pocket_pc_emulator_up.png"
    downImage= "pocket_pc_emulator_down.png"> 
```

您会看到皮肤位于与包含实际 CE 映像的 0409 文件夹处于同一级别的单独文件夹中。

浏览一下，您会看到 Smartphone 的布局相同，实际上 WinMo 6.0 SDK 也是如此（并非巧合）。

现在前往 Studio 并查看 Tools->Options->Device Tools->Devices。选择任何给定的模拟器，然后单击“属性”，然后单击“模拟器选项”。在这里，您将找到另一种调整显示设置和皮肤的方法。您可以通过单击“另存为”复制任何现有的模拟器配置，然后对其进行调整以匹配您所追求的。

# c++ - 什么时候不能将对象转换为引用？

> ID：445570
> 
> 赞同：7
> 
> 时间：2009-01-15T03:41:31.387
> 
> 标签：c++, gcc, reference

我想从[http://code.google.com/p/enhsim](http://code.google.com/p/enhsim)编译以下代码行：

```
enh::eout << enh::setw(26); 
```

gcc 给出以下错误：

```
error: no match for 'operator<<' in 'enh::eout << enh::setw(26)' 
```

但是这个`EnhSimOutput`类（它`enh::eout`是一个实例）确实声明了：

```
EnhSimOutput& operator<< (setw& p); 
```

如果我实现一个按值接受对象的操作版本，这个问题就会消失：

```
EnhSimOutput& operator<< (setw p); 
```

或者如果我将`enh::setw`对象创建为本地对象，即：

```
enh::setw wValue(26);
enh::eout << wValue; 
```

我的问题是：为什么 gcc 不选择运算符的“按引用”版本开始？

编写此代码的开发人员清楚地使其编译，但默认 gcc 拒绝这样做。为什么单独声明为局部变量的对象和局部创建的内联对象之间存在差异？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T03:57:49.667

该值`enh::setw(26);`是一个*右值*。实际上，像这样的临时变量是右值。右值具有特殊属性。其中之一是它们的地址不能被获取（`&enh::setw(26);`是非法的），并且它们通常不能绑定到对非 const 的引用（一些临时对象*可以*绑定到对非 const 的引用，但是这些有特殊的规则：调用成员临时对象上的函数并通过引用非常量捕获异常对象。在后一种情况下，临时偶数是*左值*）。

有两种表达式：**表示**对象（反过来可以存储值）或函数的左值，以及**表示**从对象中读取的值或由临时、数字文字和枚举常量表示的值的右值。在 C++03 中，为了能够将这些值传递给通过引用接受其值的函数，有一条规则是它们可以通过引用到常量来接受：`setw const& p`将接受它。也就是说，您必须像这样声明您的运营商：

```
EnhSimOutput& operator<< (setw const& p); 
```

这有点不幸，因为您无法区分常量左值（例如，您在堆栈上创建的对象`const enh::setw e(26);`）和非常量或常量右值（例如`enh::setw(26);`非常量临时值）。此外，如果您这样做，则参数不能在其上调用非常量成员函数，因为它是对 const 的引用。出于这个原因，下一个 C++ 版本 C++1x 引入了一种新的引用类型，即所谓的*右值引用*来解决这个问题。

* * *

*Microsoft Visual C++*编译器将右值绑定到对非 const的引用，但这样做时会发出警告（您必须至少使用警告级别 4 才能显示）。这是不幸的，因为在移植到其他标准合规性更严格的编译器时会出现问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T03:44:40.317

我的猜测是`EnhSimOutput& operator<< (setw& p);`通过非常量引用传递，但值 26 是“常量”，因为它不能被修改。尝试将其设置为`EnhSimOutput& operator<< (const setw& p);`

或尝试

```
int nNumber = 26;  
enh::eout << enh::setw(nNumber); 
```

# .net - .NET：锁定 ToolBarButton 而不专门化该类

> ID：445577
> 
> 赞同：1
> 
> 时间：2009-01-15T03:48:42.417
> 
> 标签：.net, winforms, components

我有兴趣在 .NET 1.1 中锁定 ToolBarButton，以便`.Enabled = True`有效地忽略该属性。我查看了班级成员，找不到任何适用的内容。

我在研究中发现了属性更改通知模式，它似乎只在 .NET 3.0 中可用。有没有人在.NET 的早期版本中实现过类似的东西？是否有解决方法来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T04:07:18.493

我想出了一个解决方法，但这不是锁定行为。

我基本上删除了 ToolBar.Buttons 集合中的 ToolBarButton。所以无论是否启用，用户都无法点击它。:-)

# iphone - 如何在不越狱的情况下读取 iPhone 文件？

> ID：445579
> 
> 赞同：24
> 
> 时间：2009-01-15T03:50:38.277
> 
> 标签：iphone, ssh

我想访问 iPhone 中的文件，例如通过 ssh 和 telnet 进行远程连接。但似乎不支持 iPhone 的 ssh 或 telnet。我可以 ping 它，但不能使用 telnet 或 ssh。

我阅读了一些互联网文章，似乎使用越狱或 Cydia 是可行的，但我想它会破坏我的 iPhone 的许可证。

是否有官方方式可以通过 ssh 或 telnet 登录到我的 iPhone？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T04:03:24.213

您不能只访问未越狱 iPhone 中的任何文件。

您可以在开发过程中使用 Xcode 的 Organizer 访问您自己的程序的数据文件，转到 Devices -> your iphone -> Summary -> Applications -> your app，单击三角形显示应用程序数据，您可以下载。

否则，使用 Airsharing 之类的东西（请参阅我写这篇文章时出现的 moogs 的回答）来上传和下载一堆文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T03:55:44.960

我以前喜欢 ssh-ing，但[Airsharing](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=289943355&mt=8&ign-mpt=uo%3D6)更好。您可以通过 wifi 连接将文件上传到您的 ipod（使用浏览器或通过 webDAV）。最初几周是免费的，但现在只需 4.99 美元。那还不错。
您可以查看办公室、图像、pdf 和 html 文件。

（我不隶属于airsharing，只是一个快乐的用户:)）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T03:54:42.793

不，你不能。你必须越狱才能做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-11T15:23:03.647

即使没有越狱，您也可以使用[iPhone Broswer访问文件系统的某些部分](http://code.google.com/p/iphonebrowser/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-06T05:03:01.063

尝试使用`iFile`我已经尝试了所有其他的，这是我的最爱。

希望这对您有所帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-27T05:14:47.917

[我对iPhone Explorer](http://www.macroplant.com/iphoneexplorer/)感到非常惊讶和高兴。它是那些可以正常工作并且不需要在 iPhone 上安装任何东西的软件之一，但如果您的 iPhone 越狱，它将提供完整的文件访问权限。

现在，当然，理想情况下，我们会在 iPhone 上安装一些东西，而不需要在计算机上安装任何东西，并像笔式驱动器一样访问 iPhone 上的文件（不像某些应用程序那样做，但只能通过 HTTP 和 wi-fi），但这是还算不错。而且它是免费的！因为他们用它来推广他们的其他应用程序，而在 iPhone 上浏览文件对大多数用户来说几乎毫无用处。

没有越狱就无法访问iPhone中的**所有**文件。时期。苹果从未允许过。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-17T20:10:22.850

您可以使用 iFunbox 进行操作，但您无权编辑、移动、删除系统文件，因此您没有完全访问权限来获得越狱 iDevice 所需的完全访问权限。

# c# - 数据建模题——数据与计算和访问器逻辑的分离

> ID：445581
> 
> 赞同：3
> 
> 时间：2009-01-15T03:51:02.317
> 
> 标签：c#, model-view-controller

好的，所以我想就这个话题发表意见。

我有一个愚蠢的数据对象 - CustomerOrder。

CustomerOrder 有价格和数量，但也有 TotalCash 属性（价格 * 数量）。所以我有一个 totalCash 属性，但我不想将计算直接放入对象中，因为这会破坏哑数据对象规则。我确实需要在整个应用程序中一遍又一遍地获取现金流，所以我需要集中计算。我可以创建一个 cashFlowCalculator 类并传入一个 customerOrder，但我不希望每个简单计算都使用另一个类。

有什么想法或最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T04:04:52.070

在同样的情况下，我会打破“哑数据对象规则”，因为我不希望特定的计算经常改变。我可能会将其实现为吸气剂。

对于更复杂的场景，创建一个 OrderCalculator 类是有意义的，该类接受与订单相关的类，并且可以执行各种计算，例如包含税、测量利润等。这样，您就可以将执行计算的职责委派给外部客户订单。这样，例如，CustomerOrder 不需要了解德克萨斯州的州税来确定是否需要销售税。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T04:04:36.567

我理解将数据对象与业务逻辑分开的理由。将 LINQ 与设计器生成的类一起使用，我很乐意使用包含业务逻辑的部分类实现来扩展生成的类。我觉得这足以满足我的需求。如果这对您不起作用，那么我将同时拥有数据对象和业务对象——也许是 1-1 对应，也许不是。工厂类或方法可用于在您的业务和数据对象之间进行转换。然后只需在您的业务对象中实现您的业务逻辑，而无需辅助对象进行计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T04:24:19.177

为什么不采用扩展方法？

```
public sealed class CustomerOrder
{
    public decimal Price;
    public decimal Quantity;
}

public static class CustomerOrderExtensions
{
    public static decimal GetTotalCash(this CustomerOrder data)
    {
        return data.Price*data.Quantity;
    }
} 
```

您甚至可以将扩展静态类移动到不同的命名空间中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T04:26:40.420

如果这是从数据表更新的数据传输对象 (DTO)，我建议将 TotalCash 数据列添加到表中，并将数据列[表达式](http://msdn.microsoft.com/es-es/library/system.data.datacolumn.expression.aspx)属性设置为“价格 * 数量”。在从数据表更新的哑 (DTO) 类中创建 TotalCash 只读属性。从 OO 的角度来看，这就是它应该完成的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T04:28:18.357

另一种选择[对于复杂的人来说可能太简单了;-)] 是让哑数据对象具有计算字段的属性，但让检索数据的 SQL 查询进行计算（一次）；当然将这些字段设为只读

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T05:00:27.733

我认为您应该考虑是否真的希望 TotalCash 成为计算/派生的属性...

考虑 - 如果计算的业务逻辑发生更改，则**可能不希望对现有记录追溯更改 TotalCash 属性**。

我会考虑将属性设置为 DTO 的非计算成员，并且可能还使用用于确定设定值的 TotalCostCalculation 服务类。

只是我的 2 美分。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T06:08:27.440

我会在你的 DTO 中计算 TotalCash（这将是 YAGNI）。如果将来您需要更改 TotalCash 的行为，那么可能会考虑提出一个 TotalCashCalculator 并通过 DI 将其传递给 Order。

# javascript - 动态加载 iframe 时是否存在“已发送请求 - 等待响应事件”？

> ID：445585
> 
> 赞同：0
> 
> 时间：2009-01-15T03:54:16.197
> 
> 标签：javascript, jquery, browser

在将 iframe 动态插入网页时，JQuery load 事件允许我在加载此 iframe 时触发回调函数（另请参阅[此 stackoverflow 文章](https://stackoverflow.com/questions/205087/jquery-ready-in-a-dynamically-inserted-iframe)）。

我正在努力解决的问题是，我想在 src 请求发送到服务器时但在从该服务器收到响应*之前做一些事情。*换句话说，我正在寻找像“请求触发”这样的事件。JQuery 加载事件在这里似乎没有帮助。

我一直在使用 JQuery setTimeout 方法的几个值，但这对我来说似乎不是一个非常强大的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T04:39:54.637

我不确定你为什么需要那个事件。当您调用 JQuery 方法时，您知道正在发出请求，因此您将在那里调用您的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T04:53:07.793

iframe 在添加到 document.body 后立即加载“src”url。

```
var iframe = document.createElement("iframe");
iframe.src = "http://somesite.com";

document.body.appendChild(iframe);
// request fired, your code would go here 
```

# c# - 使用滞后过滤器时如何防止 DirectShow 图形帧聚集在一起？

> ID：445588
> 
> 赞同：2
> 
> 时间：2009-01-15T03:55:53.010
> 
> 标签：c#, directshow

我有一个使用 SampleGrabber 过滤器进行一些处理的 DirectShow 图。处理时间长达 50 毫秒，因此播放速度通常较慢。可以打开和关闭处理。

我的问题是，如果处理已经打开了一段时间，当我关闭它时，视频会尽可能快地播放，直到达到某个点。大概这一点是帧时间与流时间匹配的地方，不再有任何滞后。

我怎样才能阻止这种情况发生，以便在我关闭处理时播放以正常速度？我可以在处理数据时关闭流时钟吗？或者也许再次为来自 SampleGrabber 过滤器的样本添加时间戳，并添加额外的滞后？

有谁知道这样做的正确方法？

编辑：

我使用了更改样本时间的方法，如下面的答案所示，但是在寻找和计算样本时间戳时遇到了一些问题。

我发现一个更好的方法是实现我自己的参考时钟并在处理时间过长时停止时钟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T09:47:45.873

只要您使用的是[ISampleGrabberCB::SampleCB](http://msdn.microsoft.com/en-us/library/ms786686(VS.85).aspx)而不是[ISampleGrabberCB::BufferCallback ，您就可以使用](http://msdn.microsoft.com/en-us/library/ms786684(VS.85).aspx)[IMediaSample](http://msdn.microsoft.com/en-us/library/ms786003(VS.85).aspx) ::SetTime简单地将 IMediaSample 演示时间戳更新为您想要的任何内容。您需要使用 SampleCB，因为它为您提供了指向实际样本的指针，而 BufferCB 在您获取样本之前复制样本，这意味着您只是在更新副本。

关闭时钟可能对您没有帮助，因为它只会使图表尽可能快地运行。[您可以尝试使用IMediaSeeking::SetRate](http://msdn.microsoft.com/en-us/library/ms786020(VS.85).aspx)更改播放速率，但请记住，许多过滤器不支持速率更改。您还可以实现根据您的确切要求而变化的自定义时钟。

# http - Lisp 奇怪的 HTTP 问题/错误

> ID：445594
> 
> 赞同：5
> 
> 时间：2009-01-15T04:01:12.827
> 
> 标签：http, lisp, sockets, sbcl

我正在尝试学习更多关于在 SBCL 中处理套接字和网络连接的知识；所以我为 HTTP 写了一个简单的包装器。到目前为止，它只是制作一个流并执行一个请求，以最终获取网站的标题数据和页面内容。

到目前为止，它的工作还算不错。没有什么可吹嘘的，但它至少奏效了。

但是，我遇到了一个奇怪的问题；我不断收到“400 Bad Request”错误。

起初，我对如何处理 HTTP 请求有些怀疑（或多或少将请求字符串作为函数参数传递），然后我创建了一个函数，用我需要的所有部分格式化查询字符串并将其返回以供使用后来......但我仍然得到错误。

更奇怪的是，错误并非每次都发生。如果我在像 Google 这样的页面上尝试该脚本，我会得到“200 Ok”的返回值......但在其他网站上的其他时间，我会得到“400 Bad Request”。

我确定这是我的代码的问题，但如果我确切知道是什么原因造成的，我会被诅咒的。

这是我正在使用的代码：

```
(use-package :sb-bsd-sockets)

(defun read-buf-nonblock (buffer stream)
  (let ((eof (gensym)))
    (do ((i 0 (1+ i))
         (c (read-char stream nil eof)
            (read-char-no-hang stream nil eof)))
        ((or (>= i (length buffer)) (not c) (eq c eof)) i)
      (setf (elt buffer i) c))))

(defun http-connect (host &optional (port 80))
"Create I/O stream to given host on a specified port"
  (let ((socket (make-instance 'inet-socket
                   :type :stream
                   :protocol :tcp)))
    (socket-connect
     socket (car (host-ent-addresses (get-host-by-name host))) port)
    (let ((stream (socket-make-stream socket
                    :input t
                    :output t
                    :buffering :none)))
      stream)))

(defun http-request (stream request &optional (buffer 1024))
"Perform HTTP request on a specified stream"
  (format stream "~a~%~%" request )
  (let ((data (make-string buffer)))
    (setf data (subseq data 0
               (read-buf-nonblock data
                      stream)))
    (princ data)
    (> (length data) 0)))

(defun request (host request)
"formated HTTP request"
  (format nil "~a HTTP/1.0 Host: ~a" request host))

(defun get-page (host &optional (request "GET /"))
"simple demo to get content of a page"
  (let ((stream (http-connect host)))
    (http-request stream (request host request))) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T05:54:52.177

一些东西。首先，对于您返回的 400 错误的担忧，我想到了一些可能性：

*   “主机：”实际上不是 HTTP/1.0 中的有效标头字段，并且根据您联系的 Web 服务器对标准的法西斯程度，它会根据您声称正在使用的协议将其视为错误请求而拒绝。
*   您需要在请求行和每个标题行之间添加一个 CRLF。
*   您的 (request) 函数可能会为 Request-URI 字段返回某些内容——您将 request 的值替换为 Request-line 的这一部分的内容——这是一种或另一种方式的虚假（严重转义字符等）。查看它输出的内容可能会有所帮助。

其他一些更通用的指针可以帮助您一路走好：

*   (read-buf-nonblock) 非常令人困惑。符号“c”在哪里定义？为什么 'eof' (gensym)ed 然后没有分配任何值？它看起来非常像直接从命令式程序中取出并放入 Lisp 的逐字节副本。看起来您在这里重新实现的是（读取序列）。去[这里](http://www.lispworks.com/documentation/HyperSpec/Body/f_rd_seq.htm)看看Common Lisp Hyperspec，看看这是否是你需要的。另一半是将您创建的套接字设置为非阻塞。这很容易，尽管 SBCL 文档几乎没有提及该主题。用这个：

    `(socket-make-stream socket :input t :output t :buffering :none :timeout 0)`

*   (http-connect) 的最后一种 (let) 形式不是必需的。只评价

    `(socket-make-stream socket :input t :output t :buffering :none)`

如果没有 let，http-connect 仍应返回正确的值。

*   在（http请求）...

代替：

```
 (format stream "~a~%~%" request )
 (let ((data (make-string buffer)))
 (setf data (subseq data 0
            (read-buf-nonblock data
                               stream)))
 (princ data)
 (> (length data) 0))) 
```

和

```
(format stream "~a~%~%" request )
(let ((data (read-buf-nonblock stream)))
    (princ data)
    (> (length data) 0))) 
```

并 make (read-buf-nonblock) 返回数据字符串，而不是让它在函数中分配。因此，在您`buffer`被分配的位置，在其中创建一个变量`buffer`，然后将其返回。您正在做的事情被称为依赖“副作用”，并且往往会产生更多错误并且更难发现错误。仅在必要时使用它，尤其是在一种易于不依赖它们的语言中。

*   我最喜欢定义 get-page 的方式。在函数式编程范式中感觉非常好。但是，您应该更改（请求）函数的名称或变量请求。两者都在那里令人困惑。

咳咳，手疼。但希望这会有所帮助。完成打字。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T05:02:51.190

这是一种可能性：

HTTP/1.0 将序列 CR LF 定义为行尾标记。

`~%`格式指令正在生成一个（在大多数平台上`#\Newline`都是 LF，尽管参见[CLHS](http://www.lispworks.com/documentation/HyperSpec/Body/13_ah.htm)）。

一些站点可能容忍丢失的 CR，而其他站点则不能容忍。

# python - 在 Windows 中运行/调试 python 程序的最简洁方法

> ID：445595
> 
> 赞同：24
> 
> 时间：2009-01-15T04:01:14.387
> 
> 标签：python, windows, python-idle

默认情况下，Windows 的 Python 带有 IDLE，这是我遇到过的最简单的 IDE。对于编辑文件，我会坚持使用emacs，非常感谢。

但是，我想在其他一些 shell 中运行程序，而不是糟糕的 windows 命令提示符，它不能扩展到超过 80 个字符。

*如果*我打开文件， IDLE 让我在其中运行程序，然后按 F5（进入运行-> 运行模块）。我宁愿只“运行”命令，而不是通过关闭 emacs 文件、加载 IDLE 文件等的繁琐程序。谷歌和 IDLE 文档的扫描似乎对使用 IDLE 没有太大帮助shell 但不是 IDE。

堆栈溢出家伙有什么建议吗？理想情况下，我要么喜欢

*   关于使用 IDLE 的 shell 运行程序的建议

*   关于在 IDLE 或“cmd”之外的 Windows 中运行 python 程序的其他方法的建议。

谢谢，

/YGA

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-15T04:49:05.803

对于交互式解释器，没有什么比[IPython 更好](http://ipython.scipy.org/)的了。太棒了。它也是免费和开源的。在 Windows 上，您需要安装 readline 库。IPython 安装文档中有相关说明。

[Winpdb](http://winpdb.org/)是我选择的 Python 调试器。它是免费的、开源的和跨平台的（使用 wxWidgets 作为 GUI）。我写了一篇[关于如何使用 Winpdb](http://code.google.com/p/winpdb/wiki/DebuggingTutorial)来帮助人们开始使用图形调试器的教程。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-15T04:14:05.190

您可以通过执行以下操作轻松扩展 Windows 控制台：

*   单击右上角的控制台窗口图标
*   从菜单中选择**属性**
*   单击**布局**选项卡
*   将**窗口大小**> 宽度更改为 140

这也可以通过更改菜单上的**默认值来普遍保存。**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-06-22T16:31:57.343

2017-2019 年 答案：

试试**Visual Studio Code**，它对**Python** **调试**、自动补全等有很好的支持！

有关详细信息，请参阅此链接： [https ://code.visualstudio.com/docs/languages/python#_debugging](https://code.visualstudio.com/docs/languages/python#_debugging)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T04:07:12.923

> 但是，我想在其他一些 shell 中运行程序，而不是糟糕的 windows 命令提示符，它不能扩展到超过 80 个字符。

单击命令提示符中的系统框（左上角），然后单击属性。在布局选项卡中，您可以设置窗口的宽度和高度以及屏幕缓冲区的宽度和高度。我建议将屏幕缓冲区高度设置为 9999，这样您就可以在较长的输出中向后滚动。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T05:56:23.983

我将 eclipse 与[pydev](http://pydev.sourceforge.net/)一起使用。Eclipse 可能很迟钝，但我已经依附于集成的 svn/cvs、块缩进/未缩进并作为单元测试功能运行。（也有F5运行）

如果您对 emacs 感到满意，尽管我认为没有任何理由做出如此重大的改变。

我建议您将“糟糕的命令提示符”替换为[powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)。它没有那么糟糕。

（正如 Soviut 和 The Dark 所提到的 - 即使在糟糕的 cmd 中，您也可以通过标题栏 > 右键单击​​ > 属性 > 缓冲区宽度/窗口大小编辑将缓冲区宽度/窗口大小增加到 80 以上）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T04:03:37.940

[Wing IDE](http://www.wingware.com/)很棒。他们也有免费版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T04:22:29.103

[我在EditPlus](http://www.editplus.com/)中编辑我的 Python 程序。我已经配置了一个用户工具，它允许我运行我的程序并将其输出显示在我的编辑器窗口下方的框架中。我的配置甚至可以让您双击输出中的异常行直接跳转到发生错误的文件和行。[您可以从 EditPlus wiki 上的此处](http://editplus.info/wiki/User_Tools#Python)获取我使用的用户工具配置。

也许您可以配置类似的功能，允许您运行程序并在 Emacs 编辑器中显示其输出！？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T05:31:37.340

如果你毕业到 vim，你可以运行以下命令来启动你当前在交互式 shell 中编辑的程序：

```
:!python -i my_script.py 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T01:03:49.470

我用 Cygwin 和 Poderosa 替换了 cmd。但是，如果您对 cmd 的唯一问题是调整大小很痛苦，那么可能有点矫枉过正。

尽管您使用 Emacs 而不是 Vim，所以我猜您有点矫枉过正...... ;-)

# javascript - 自 Flash 10 以来，是否有任何新的解决方案可以通过 JavaScript / Flash 将多组文本复制到剪贴板？

> ID：445604
> 
> 赞同：4
> 
> 时间：2009-01-15T04:06:01.163
> 
> 标签：javascript, jquery, flash, copy, copy-paste

自 Flash 10 推出以来，由于新的安全限制，许多流行的“复制到剪贴板”脚本已经停止工作。这里有一个仅限 Flash 的解决方案：

[http://cfruss.blogspot.com/2009/01/copy-to-clipboard-swf-button-cross.html](http://cfruss.blogspot.com/2009/01/copy-to-clipboard-swf-button-cross.html)

...虽然我正在寻找通过 JS 触发复制功能的能力，而不是依靠用户单击 Flash 对象来触发。

有关我们目前使用的示例，请参阅：

[http://snipt.net/public](http://snipt.net/public)

任何“复制”链接都在这里使用 jQuery 的复制插件：

[http://plugins.jquery.com/project/copy](http://plugins.jquery.com/project/copy)

更新：好的，所以我尝试了 ZeroClipboard。乍一看，它看起来很棒。但是，[启用多个剪贴板绑定所需的冗余代码](http://bowser.macminicolo.net/~jhuckaby/zeroclipboard/multiple.php)量是不可接受的。在某些情况下，会有 40 多个文本实例，每个实例都有自己的“复制”链接。仍在寻找更好的解决方案...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T04:10:18.473

这是一个可怕的消息，我什至没有注意到。我也广泛使用 Flash 技巧。据我所知，由于浏览器安全问题，这是无需安装其他插件（除了无处不在的 Flash）即可让副本正常工作的唯一方法。

更新：经过一番惊慌和一些谷歌搜索后，我偶然发现了[http://code.google.com/p/zeroclipboard/](http://code.google.com/p/zeroclipboard/)，它提供了一个与 Flash 10 兼容的技巧，可以让副本再次工作。现在去更新网站...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T22:41:08.930

此解决方案仅适用于会调用所需操作的击键。它的工作原理是在用户完成相关击键之前将用户的光标移动到 textarea 元素中。它仅适用于文本输入。我已经在 Firefox 和 chrome 中工作了。IE 可以使用 clipboardData 对象（这比这个 hack 更可取）。

在您的 html 某处，您应该创建一个 textarea 元素，该元素具有任意大的行和 cols 属性。“**剪贴板文本区域**”元素将是粘贴和复制数据的保存区域。我使用一些样式属性隐藏元素。

剧本：

```
var desiredClipboardContents = 'It works';

function onCopyKeyPressed() {
   // The trick here is to populate the textarea with
   // the text you want copied before the user releases
   // the copy keystroke.
   var textarea = document.getElementById('clipboard-textarea');
   textarea.value = desiredClipboardContents;
   textarea.focus();
   textarea.select();
}

function onPasteKeyPressed() {
   var textarea = document.getElementById('clipboard-textarea');
   textarea.value = '';
   textarea.focus();
   // The trick here is to delay slurping the content
   // that arrives in the textarea element until after
   // the paste keystroke is completed. The 750 ms timeout
   // provides the necessary delay.
   setTimeout("finishedPasting", 750);
}

function finishedPasting() {
   var textarea = document.getElementById('clipboard-textarea');
   alert("Received from clipboard-paste: " + textarea.value);
} 
```

# ruby-on-rails - 在嵌套资源关系中“查找”“父”对象？

> ID：445606
> 
> 赞同：1
> 
> 时间：2009-01-15T04:07:06.730
> 
> 标签：ruby-on-rails, rails-routing

假设我有两个资源，项目和任务。一个项目可以有很多任务；一个任务属于一个项目。还说我在 routes.rb 的 Project 下嵌套了 Task：

```
map.resources :projects do |project|
  project.resources :tasks
end 
```

可以以编程方式发现这种关系吗？基本上，我需要动态加载一个任意对象，然后确定它是否有一个“父级”，然后加载那个父级。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T09:48:53.297

路由不会帮助你，因为这只是为了反其道而行之。您可以做的是将与 :parent: 的关系别名化

```
 class Task
  belongs_to :project
  alias :project :parent
end 
```

然后使用这个关系来检测是否有父对象可用：

```
 if object.respond_to?(:parent)
  # do something
end 
```

此外，如果路由设置正确，您可以使用多态路由：

```
 polymorphic_url([object.parent, object]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T07:10:38.687

您上面的代码确定了路线的关系，并帮助生成正确的助手来创建路径等。

您需要确保在您的madels 中正确声明了这些关系。在项目模型中，您应该具有：

```
has_many :tasks 
```

在您的任务模型中，您应该具有：

```
belongs_to :project 
```

一旦你设置好了，你就可以得到你想要的了。

```
@task = Task.first

unless @task.project.blank?
  project_name = @task.project.name
end 
```

# rest - 查询 List.contains(element) 的 RESTful 高效方式？

> ID：445619
> 
> 赞同：1
> 
> 时间：2009-01-15T04:15:20.910
> 
> 标签：rest, list

鉴于：

```
/images: list of all images
/images/{imageId}: specific image
/feed/{feedId}: potentially huge list of some images (not all of them) 
```

如果不下载完整列表，您将如何查询特定提要是否包含特定图像？换句话说，如何在不下载整个状态的情况下检查资源状态是否包含组件？想到的第一个想法是：

```
Alias /images/{imageId} to /feed/{feedId}/images/{imageId} 
```

然后客户端会发出 HTTP GET`/feed/{feedId}/images/{id}`来检查它的存在。我看到这种方法的缺点是它迫使我将逻辑硬编码到客户端中，以将图像 URI 分解为其专有 id，这是 REST 不赞成的。理想情况下，我应该使用不透明的图像 URI。另一种选择是：

```
Issue HTTP GET against /feed/{feedId}?contains={imageURI} to check for existence 
```

但这感觉比我想要的更接近 RPC。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T05:00:47.577

这有什么问题？

```
HEAD /images/id 
```

目前还不清楚“提要”是什么意思，但假设它包含资源，它会是一样的：

```
HEAD /feed/id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T05:13:34.180

如果没有看到一些示例来提供上下文，就很难说。

但是您可以让客户端调用`HEAD /feed/images/{imageURI}`（假设您可能需要对 imageURI 进行编码）。服务器将使用通常的 HEAD 响应进行响应，如果资源不存在，则返回 404 错误。您需要在服务器上编写一些逻辑来理解 imageURI。

然后客户端要么使用头部的图像元信息，要么优雅地处理 404 错误并执行其他操作（取决于我猜的应用程序）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T05:39:18.450

如何设置 ImageQuery 资源：

```
# 从表单数据创建一个新查询，您可以在其中限制给定提要的结果。
# 可能会或可能不会重定向到 /image_queries/query_id。
发布 /image_queries/

# 可选 - 查看包含用于查询资源的 URI 的查询结果。
获取 /image_queries/query_id

```

[该视频](http://railscasts.com/episodes/111-advanced-search-form)演示了使用 Rails 的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-20T00:14:23.200

没有什么“非 RESTful”的：

```
/feed/{feedId}?contains={imageURI}[,{imageURI}] 
```

它返回指定的子集。资源 /feed/{feedid} 是一个包含图像列表的列表资源。包含查询返回的资源有何不同？

URI 是唯一的，并从应用程序返回适当的状态。不能说任何关于请求的缓存语义，但它们与原始 /feed/{feedid} 的任何缓存语义相同，它只是一个子集。

最后，没有任何内容表明甚至存在 /feed/{feedid}/image/{imageURL}。如果您想在该级别使用子资源，那很好，但您不需要这样做。返回的列表可能只是直接图像 URL 的列表，那么描述 /feed/{feedid}/image/{imageURL} 关系的链接在哪里？你要把它嵌入到有效载荷中，对吗？

# visual-studio-2008 - 如何组织800张表格？

> ID：445632
> 
> 赞同：1
> 
> 时间：2009-01-15T04:26:07.723
> 
> 标签：visual-studio-2008, projects-and-solutions

我的公司正在从经典的 asp（一场噩梦）转向 .Net（迅速成为同样的噩梦）。我们有 800 多张表格，它们的处理方式非常相似，但有 800 组不同的问题。

他们有共同的代码：添加到数据库，从数据库中获取，验证用户输入，验证信用卡信息等......

我们正在使用 Visual Studio 2008。您将如何组织这些解决方案/项目？

我们是否将它们全部放在一个解决方案中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T04:32:55.527

抓住机会 - 如果可能的话 - 将 800 种表格转换为软编码

警告：我做了一些与此非常相似的事情，其中​​表格都是法律协议，因州而异，并且发现它们有足够的对称性，可以从数据库中生成（和创建！）原始文档自动逆向工程成新的（数据库驱动的）格式。结果通过屏幕截图自动验证 - 像素完美再现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T05:41:22.097

您完全必须从数据库中生成它。实施可配置的调查/问卷/考试系统比实施 800 个表格要容易得多。

如果它只有 50 个表格，我可能会让它变得草率，但是 800 个表格 - 一直以编程方式生成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:32:30.080

在这一点上，我会根据自己的经验提出以下建议：

1）不要为了升级而升级项目；如果它有效，请离开它。

2) 如果您的公司有一些“必须升级”的愿景……好吧，将其转换为 .NET 项目，但不要更改任何功能。保持原状。这可能需要几天的小修复，具体取决于应用程序的复杂性，但应该是可行的。

3) 尝试说服你的老板/公司 a) 从头开始​​构建一个新应用程序，或者 b) 使用 3rd 方调查软件，如 Cade Roux 提到的。在新版本准备好之前，让现有版本一直运行。

将应用程序转换为 .NET*并同时*将其重写为 .NET 范例将成为一场噩梦，不要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T04:32:10.190

你可能设计了这个不同的。也许是动态生成的页面和多态性。但是，是的，您不会通过单独的解决方案获得任何收益。它可能会增加你的头痛。你实际遇到了什么问题？您是否将数据库逻辑与演示文稿分开？您基本上只是在 ASP.NET 中进行经典 ASP 样式编码吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T04:43:38.420

800张表格？就像在 800 个网页中一样？这很多，但应该是可以管理的。令我惊讶的是，您没有使用某种表单构建技术查看许多表单，例如表单的布局和您拥有的内容存储在某种数据库中。希望您可以使用一些用户控件来至少将代码最小化/标准化。

代码方面，您不妨按字母顺序对它们进行分组，免去尝试找出它们之间的一些共同功能的麻烦……如果一个表单在组之间重叠怎么办？无论您做什么，都不要让您的代码结构弄乱您希望它们如何排列和呈现给用户的方式。查看 .net 拥有的[站点地图](http://msdn.microsoft.com/en-us/library/yy2ykkab.aspx)。

我假设您正在使用网络表单？这没有错，并且有一些完全正当的理由坚持下去。但是，如果您还不太了解，请查看[MVC 框架](http://www.asp.net/mvc/)，看看它是如何吸引您的。

# sql - 修复数据库不一致 - ID 字段

> ID：445641
> 
> 赞同：3
> 
> 时间：2009-01-15T04:30:22.473
> 
> 标签：sql, sql-server, database, coldfusion

我继承了一个（Microsoft？）SQL 数据库，它在原始状态下并不是很原始。我正在尝试修复其中的一些非常奇怪的东西——其中之一是不一致的 ID 条目。

在accounts 表中，每个条目都有一个称为accountID 的编号，在其他几个表（注释、设备等）中都引用了该编号。问题是数字（出于某种随机原因） - 当只有大约 7000 个条目时，范围从大约 -100000 到 +2000000。

有没有什么好方法可以在更改其他表中的相应数字时重新编号它们？在我的支配下，我也有 ColdFusion，所以任何适用于 SQL 和/或我会接受的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T04:50:29.593

对于代理键，它们是没有意义的，所以除非你真的有一个数据库完整性问题（比如没有正确定义外键约束）或者你的身份接近其数据类型的最大值，我会不理会它们并继续其他一些会产生更大影响的低级成果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T19:36:39.540

在这种情况下，听起来“为什么”比“如何”更好。OP 指出有一个奇怪的问题需要解决，但没有说明为什么会出现问题。它会引起问题吗？改变这些数字会产生什么积极影响？除非您最初对系统进行了编程并准确理解数字为何处于当前状态，否则您进行这样的更改是非常冒险的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T14:15:54.973

如果这是一个财务应用程序，我会先与会计师（或至少您的财务人员）交谈，然后再弄乱帐户表中的数字。账目表对于如何报告财务状况非常重要。这些 ID 可能具有您不理解的含义。除非有理由，否则没有人会输入否定的身份。在任何情况下我都不会改变这一点，除非我明白为什么它一开始是消极的。您可以通过进行不必要的更改来真正搞砸您的税务报告或其他事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T04:46:26.200

您可能会禁用外键关系（如果您能够暂时使其脱机），然后使用脚本更新主键。我之前使用过这个更新脚本来改变值，你可以很容易地把这段代码包装在一个游标中，一个一个地遍历有问题的键值，并将任意值更新为你正在跟踪的递增值的。

在此处查看脚本：http: [//vyaskn.tripod.com/sql_server_search_and_replace.htm](http://vyaskn.tripod.com/sql_server_search_and_replace.htm)

如果您只有一个使用主键的表列表，您可以设置一系列在游标内运行的 UPDATE 语句，然后您就不需要使用这个脚本（这可能有点慢）。

不过，值得一问的是，为什么这些值显得格格不入。该数据库是否有不断添加和删除的值？主键值真的是任意的，还是它们只是看起来是，但它们真的有意义？虽然我完全赞成巩固，但你必须确保这些价值观没有任何意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T04:50:09.033

使用 ColdFusion，这不应该是一项艰巨的任务，但它会很混乱，您必须小心。您可以使用的一种方法是编写数据库脚本，然后生成一个全新的空白表模式。将 accountID 设置为新数据库中的标识字段。

然后，使用 ColdFusion，编写一个查询，该查询将提取所有旧帐户数据并将它们一一插入到新数据库中。对于每一行，让新数据库分配一个新 ID。每次插入后，提取新 ID（使用 @@IDENTITY 或 MAX(accountID)）并将新 ID 和旧 ID 一起存储在临时表中，以便您知道哪些旧 ID 属于哪些新 ID。

接下来，对每个子表重复该过程。对于每个旧 ID，提取其子条目并使用新 ID 将它们重新插入到新数据库中。如果子表上的主键没问题，您可以按原样插入它们，或者如果它们无关紧要，让服务器分配新的主键。

通过暂时禁用关系来分配新的 ID 可能会起作用，但如果为其中一个条目分配的 ID 已被旧数据使用，那么您也可能会遇到冲突，这可能会导致冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T13:37:37.937

在帐户表中为您的新 ID 创建一个新列，并在每个相关表中创建一个新列以引用新 ID 列。

```
ALTER TABLE accounts
ADD new_accountID int IDENTITY

ALTER TABLE notes
ADD new_accountID int

ALTER TABLE equipment
ADD new_accountID int 
```

然后，您可以将每个引用表上的 new_accountID 列映射到帐户表。

```
UPDATE notes
SET new_accountID = accounts.new_accountID
FROM accounts
INNER JOIN notes ON (notes.accountID = accounts.accountID)

UPDATE equipment
SET new_accountID = accounts.new_accountID
FROM accounts
INNER JOIN equipment ON (equipment.accountID = accounts.accountID) 
```

此时，每个表都有带有旧键的 accountID 和带有新键的 new_accountID。从这里开始应该很简单。

1.  打破 accountID 上的所有外键。
2.  在每个表上，UPDATE [table] SET accountID = new_accountID。
3.  重新添加 accountID 的外键。
4.  从所有表中删除 new_accountID，因为它不再需要。

# list - 当目录有超过 100,000 个文件时，如何通过 FTP 删除文件？

> ID：445643
> 
> 赞同：3
> 
> 时间：2009-01-15T04:31:07.307
> 
> 标签：list, file, ftp

我去上传一个新文件到我的网络服务器只是得到一条消息作为回报，说我的磁盘配额已满......我没有用完我分配的空间，而是我分配的文件数量。我的主机将我的文件总数限制在大约 260,000 个。

检查我的文件夹，我相信我找到了罪魁祸首......

我有一个小型 DVD 数据库应用程序（Video dB By split Brain），我已经安装并隐藏在我的网站上供我个人使用。它显然缓存了来自 IMDB 的数据，并且多年来已经秘密地积累了可能接近 IMDB 的 MIRROR 的数据。我不确定，但我确实在几年前创建的主机上有一个程序的第二个（非活动）副本，当我修改它的一部分时，我用它来测试它。*此非活动*副本中的缓存文件夹有 40,000 个文件，总大小为 2.3GB。我可以通过 FTP 删除这个文件夹，但花了一个多小时。值得庆幸的是，它也给了我一些急需的喘息空间。

...但是现在您可以想象，此 Web 应用程序的活动副本的缓存文件夹可能有接近 150000 个文件，总计约 7GB 的数据。

这就是我的问题所在......我将 Flash FXP 用于我的 FTP 客户端，每当我尝试删除缓存文件夹，甚至只是查看它会坐下的内容并尝试加载文件列表 5 分钟，然后然后失去与服务器的连接...

我的主机有一个基于 Web 的文件浏览器，尝试执行此操作时它会崩溃……就像 net2ftp.com 等免费在线 FTP 客户端一样。我在这台服务器上没有 SSH 功能，所以我也无法直接登录删除。

任何人都知道如何删除这些文件？有没有我可以下载的其他 FTP 程序，它会取得更好的成功......或者我可以运行一个可以处理它的小脚本？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T04:50:08.377

> 任何人都知道如何删除这些文件？

提交支持请求，要求他们为您删除它？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T04:37:29.150

听起来可能是时候使用命令行 FTP 实用程序了。一个附带几乎所有操作系统。有了这么多文件，我会为我的命令行 FTP 客户端编写一个脚本，该脚本会转到相关文件夹并执行目录列表，将输出重定向到文件。然后，使用魔法（或 perl 或其他）将该文件处理成一个新的 FTP 脚本，该脚本对所有文件运行删除命令。是的，运行需要很长时间。

如果服务器支持通配符，请改为删除*.* .

如果这一切看起来工作量太大，请向您的托管服务提供商开一张支持票，并要求他们直接在服务器上进行清理。

说了这么多，这不是一个真正的编程问题，可能应该关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T04:40:53.823

不久前我们有一个问题，我进行了一个实验，表明 Firefox 可以通过 FTP 毫无问题地浏览包含 10,000 个文件的目录。大概150,000也可以。Firefox 不会帮助您删除，但它可能有助于捕获您需要删除的文件的*名称。*

但首先我会尝试命令行客户端[`ncftp`](http://www.ncftp.com/)。它设计精良，过去我很幸运。您可以使用 shell 模式一次删除大量文件。它适用于 Windows、MacOS、Linux 和许多其他平台。

如果这不起作用，你听起来像是一个长期客户——你能不能向你的 ISP 请求一个 shell 帐户的特权一周，这样你就可以用 Putty 或 ssh 远程登录，然后用一个单一的方法吹走整个目录`rm -r`命令？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-17T07:21:00.787

如果您的 ISP 提供 ssh 访问，您可以使用一个 rm 命令删除文件。

如果没有命令行访问，您可以尝试使用一些功能强大的 FTP 客户端，例如[CrossFTP](http://www.crossftp.com/)。它适用于win、mac和linux。当您选择删除服务器上的大量文件时，它可以在删除操作中排队，这样您就不需要再次重新加载文件夹。当您重新启动 CrossFTP 时，队列也可以恢复并继续。

# database - 可以对主键使用字符值吗？

> ID：445649
> 
> 赞同：5
> 
> 时间：2009-01-15T04:33:52.183
> 
> 标签：database, database-design, optimization, schema, normalization

与使用基于字符的字段相比，在数据库表中使用唯一的数字 ID 字段是否有性能提升或最佳实践？

例如，如果我有两个表：

## **运动员**

**id** ... *17* ,**姓名**... *Rickey Henderson* , **teamid** ... *28*

## **团队**

**teamid** ... *28* , **teamname** ... *Oakland*

**如果teamid**是“OAK”或“SD”而不是“28”或“31” ，那么包含数千名玩家的运动员表将更易于阅读。让我们理所当然地认为**teamid**值将在角色形式上保持独特和一致。

我知道您可以使用字符，但是出于某种原因，索引、过滤等是否是个坏主意？

*请忽略规范化参数，因为这些表比示例更复杂。*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-15T04:38:54.547

我发现从长远来看，无意义数字的主键会减少头痛。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T04:39:34.607

由于您提到的所有原因，文字很好。

如果字符串只有几个字符，那么无论如何它几乎都是一个整数。使用字符串的最大潜在缺点是大小：数据库性能与需要多少磁盘访问有关。例如，将索引设置为两倍大，可能会产生磁盘缓存压力，并增加磁盘寻道次数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T04:39:44.433

我会远离使用文本作为您的密钥 - 将来当您想更改某个团队的团队 ID 时会发生什么？您必须在整个数据中级联该键更改，而这正是主键可以避免的事情。此外，虽然我没有任何经验证据，但我认为 INT 键会比文本键快得多。

也许您可以为您的数据创建更易于使用的视图，同时仍使用数字主键。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T05:03:27.587

I'm just going to roll with your example. Doug is correct when he says that text is fine. Even for a medium sized (~50gig) database having a 3 letter code be a primary key won't kill the database. If it makes development easier, reduces joins on the other table and it's a field that users would be typing in...I say go for it. Don't do it if it's just an abbreviation that you show on a page or because it makes the athletes table look pretty. I think the key is the question "Is this a code that the user will type in and not just pick from a list?"

Let me give you an example of when I used a text column for a key. I was making software for processing medical claims. After the claim got all digitized a human had to look at the claim and then pick a code for it that designated what kind of claim it was. There were hundreds of codes...and these guys had them all memorized or crib sheets to help them. They'd been using these same codes for years. Using a 3 letter key let them just fly through the claims processing.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T04:39:59.287

我建议使用 ints 或 bigints 作为主键。好处包括：

*   这允许更快的连接。
*   主键中没有语义含义允许您更改具有语义含义的字段，而不会影响与其他表的关系。

您总是可以有另一列来保存 team_code 或“OAK”和“SD”的东西。还

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T04:47:08.883

标准答案是使用数字，因为它们的索引速度更快；无需计算哈希或其他任何东西。

如果您使用有意义的值作为主键，则如果团队名称发生更改，则必须通过您的数据库对其进行全部更新。

满足以上，但仍使数据库直接可读，

*   使用数字字段作为主键

*   立即创建连接 Athlete 和 Team 表的 Athlete_And_Team 视图

Then you can use the view when you're going through the data by hand.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T04:48:18.833

Are you talking about your primary key or your clustered index? Your clustered index should be the column which you will use to uniquely identify that row by most often. It also defines the logical ordering of the rows in your table. The clustered index will almost always be your primary key, but there are circumstances where they can be differant.

# c# - 3路计算

> ID：445658
> 
> 赞同：7
> 
> 时间：2009-01-15T04:39:36.137
> 
> 标签：c#

我有一个包含三个字段 A、B 和 C 的数据对象。问题是用户可以设置其中的任何一个，因为：

A * B = C

因此，如果用户通过设置 A 和 B 开始，则将计算 C。但是如果用户设置 C，A 会被重新计算，因此基于用户设置的最后一个字段会发生隐式锚定。

我想避免使用大量标志成员变量的解决方案。关于我如何在没有像下面这样的很多东西的情况下编写这个类的任何最佳实践

```
public class Object
{
     private double _A;
     private double _B;
     private double _C;

     private bool _enteredA;
     private bool _enteredB;
     private bool _enteredC;

public double A
{
get
    {
     if (_enteredC)
     {
          return _C / _B;
     }
     else
     {
        return _A;
     }
  }
} 
```

设置 A、B 和 C 的逻辑应该始终在“get”或“set”上。

有没有更清洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T04:52:58.747

所以你的规则是：

```
A = C / B
B = C / A
C = A * B 
```

您需要做的是记住用户输入的最后**两个**字段，然后计算第三个字段。因此，如果他们输入 A，然后输入 B，那么您计算 C。如果他们随后更改 C，则重新计算 A，依此类推。

如果您想在不使用布尔标志的情况下对其进行编码，有几种不同的方法可以做到这一点。一个队列，或者只是一个简单的数组/映射都可以工作：

```
editOrder = {A : 0, B : 0, C : 0 }  // (or just use 0, 1, 2)
editCount = 0;

every time any field is edited :
    editCount = editCount + 1
    editOrder[field] = editCount
    if two fields have an editOrder > 0
        recalculate the field with the lowest editOrder 
```

示例用法：

```
Field changed    editOrder        recalculate field
    A            1,0,0            -
    A            2,0,0            -
    B            2,3,0            C
    C            2,3,4            A
    C            2,3,5            A
    B            2,6,5            A
    A            7,6,5            C 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T04:21:31.960

您声明您的属性具有“A * B = C”的关系。所以，你的班级应该表达这一点。A 和 B 是自变量，因此它们具有简单的 setter 和 getter，它们仅获取和设置一个字段。C 是一个因变量，因此它应该只有一个 getter 并根据 A 和 B 执行计算：

```
class Foo
{
    private double m_a;
    public double A
    {
        get { return m_a; }
        set { m_a = value; }
    }

    private double m_b;
    public double B
    {
        get { return m_b; }
        set { m_b = value; }
    }

    public double C
    {
        get { return A * B; }
    }
} 
```

可以编写一个编辑器，允许 A 和 B 进行简单的编辑。如果（且仅当）用户已经编辑了 A 或 B，它还可以允许用户编辑 C。视图将存储一些状态以指示上次编辑哪个（如果有）字段，因此可以在编辑概念 C 时对 A 或 B 应用适当的更改。

现在，如果 View 不知道 C 的计算，您可以将 Foo 类的方法添加到“SetAGivenC()”和“SetBGivenC()”：

```
class Foo
{
    ... as above ...

    public void SetAGivenC( double newC )
    {
        A = newC/B;
    }

    public void SetBGivenC( double newC )
    {
        B = newC/A;
    }
} 
```

现在，当编辑“C”时，您的 GUI 只会调用其中一种方法。

我对“用户设置的最后一个字段”的含义感到困惑。想象一下屏幕上有两个编辑器（都绑定到同一个 Foo 实例），用户在第一个编辑器中编辑 A，然后在第二个编辑器中编辑 B，然后在第一个编辑器中编辑 C。设置 C 时会调整什么？甲还是乙？如果你能回答这个问题，你就会知道哪个类应该跟踪“用户设置的最后一个字段”——它应该是模型还是视图？我希望在这种情况下会调整 A 并且视图会跟踪最后编辑的字段。但这是另一天的问题！

编辑：

吉普车——我什至把我自己的病态病例都塞进去了！

我将再次尝试最后一段：

我对“用户设置的最后一个字段”的含义感到困惑。想象一下屏幕上有两个编辑器（都绑定到同一个 Foo 实例），用户在第一个编辑器中编辑 A 然后 B ，然后用户在第二个编辑器中编辑 B 然后 A ，然后用户在第一个编辑器中编辑 C . 设置 C 时会调整什么？甲还是乙？如果你能回答这个问题，你就会知道哪个类应该跟踪“用户设置的最后一个字段”——它应该是模型还是视图？我希望在这种情况下会调整 A 并且视图会跟踪最后编辑的字段。但这是另一天的问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T04:56:44.197

创建一个私有方法来执行以下计算

```
private void calculateFields(){
  if (_b != INIT_VALUE && _c != INIT_VALUE)
     _a =  _c / _b;
  if (_a != INIT_VALUE && _c != INIT_VALUE)
     _b = _c / _a;
  if (_a != INIT_VALUE && _b != INIT_VALUE)
     _c = _a * _b;
}

public double A
{
get{
        return _a;
  }
set{
   _a = value;
   calculateFields();
}
} 
```

对属性 B 和 C 执行相同操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T05:27:19.330

简短的回答是否定的。

您可以创建一个适配器来处理您描述的逻辑。你会将复杂性从这个类移到另一个类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T05:34:06.150

您是否正在寻找这样的东西（感谢[nickf](https://stackoverflow.com/questions/445658/3-way-calculation#445690 "回答")不厌其烦地为每个值求解方程）：

```
class Foo
{
    // Mark these as obsolete so that
    // you don't use them by mistake
    // in the class.
    [Obsolete]
    private double _a;
    [Obsolete]
    private double _b;
    [Obsolete]
    private double _c;

    #pragma warning disable 0612
    public double A
    {
        get
        {
            return _a;
        }
        set
        {
            _a = value;
            // You may want to change
            // this to simply _a.
            _b = _c / (_a == 0 ? 1 : _a);
            _c = _a * _b;
        }
    }

    public double B
    {
        get
        {
            return _b;
        }
        set
        {
            _b = value;
            _a = _c / (_b == 0 ? 1 : _b);
            _c = _a * _b;
        }
    }

    public double C
    {
        get
        {
            return _c;
        }
        set
        {
            _c = value;
            _a = _c / (_b == 0 ? 1 : _b);
            _b = _c / (_a == 0 ? 1 : _a);
        }
    }
    #pragma warning restore 0612
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T05:29:22.963

@乔纳森

关于您的计算方法中的错误，我的观点如下：

在您编写的代码中，会发生以下事件序列。

```
given a valid state at some point of time.
[a = 1, b = 3, c = 3] 
```

用 b = 4 调用你的 setter，然后你的代码将计算 a 和 c：

```
1\. first sets b          b = 4
2\. first calculates a    a = c / b =  3  / 4  =  3/4
3\. then calculates  c    c = a * b = 3/4 * 4  =  3 
```

最后的元组是

```
[a = 3/4, b = 4, c = 3] 
```

本质上，对于您的班级（如当前所写）

```
setting b alters a  ->  leaves c unaffected.
setting c alters a  ->  leaves b unaffected.
setting a alters b  ->  leaves c unaffected 
```

计算 (3) 是无用的，因为 if`A`已经从 and 派生，从and重新`C`派生`B`不会改变, *ever*的值。`C``A``B``C`

 *设置`A`or`B`应该计算`C`，并且有一种特殊情况，设置`C`计算`A`或`B`不使用布尔值来知道哪个。（发布的问题）

# c# - 你把你的计算放在你的集合上还是你的得到。

> ID：445695
> 
> 赞同：9
> 
> 时间：2009-01-15T04:55:51.220
> 
> 标签：c#, language-agnostic, class, methods, oop

哪个更好 ？？？

```
public class Order
{
   private double _price;
   private double _quantity;

  public double TotalCash
  {      
   get
   {
    return _price * _quantity;
   }
} 
```

或者

```
public class Order
{

   private double _totalCash;
   private double _price;
   private double _quantity;

  private void CalcCashTotal()
 {
   _totalCash = _price * _quantity
 }

  public double Price
  {      
   set
   {
     _price = value;
     CalcCashTotal();
   }
  }

  public double Quantity
  {      
   set
   {
     _price = value;
     CalcCashTotal();
   }
  }

  public double TotalCash
  {      
   get
   {
    return _totalCash;
   }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-15T05:16:50.617

有权衡。如果计算简单并且不需要很长时间，那么就把它放在get中。它使您的生活更轻松，因为您不必担心在总价所依赖的每一组中都进行检查，这可能会导致错误。

如果计算需要很长时间，那么您也可以采用混合方法。您可以在所有依赖集中设置一个 IsDirtyTotalPrice 布尔值，然后在 get 中即时进行计算并将其缓存，以便 get 仅在需要时计算变量。您不会在集合中进行计算，因为它们可能很多，并且您希望尽可能少地进行计算。

```
 public class Order
  {
     private double _totalCash;
     private double _price;
     private double _quantity;
     private _IsDirtyTotalCash = true;

  private void CalcCashTotal()
  {
    _totalCash = _price * _quantity
  }

  public double Price
  {      
   set
   {
     _price = value;
     _IsDirtyTotalCash = true;
   }
  }

  public double Quantity
  {      
   set
   {
     _price = value;
     _IsDirtyTotalCash = true;
   }
  }

  public double TotalCash
  {      
   get
   {
        if(_IsDirtyTotalCash)
    {
      _totalCash = CalcTotalCost();
       _isDirtyTotalCash = false;
     }
     return _totalCash;
   }
  }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T04:59:58.187

通常我会尝试将它们放在场景中，因为它们生成的值将存储在内部并且只需要计算一次。只有在每次查询时值都可能发生变化时，才应该在 get 上进行计算。

在您的价格/数量示例中，您实际上可以有一个单独的方法，在设置价格或数量时重新计算数量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T05:02:04.733

第一个更好，因为：

*   它更短。
*   更容易理解。
*   每次设置价格或数量时重新计算 TotalCash 有点冒昧。它应该尽可能地懒惰，并且只在请求时计算。

话虽如此，将计算放在 setter 中有效地缓存了它，因此如果遇到性能问题，这可能是一个有用的更改（以清晰度为代价）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T05:59:32.120

我会接受查尔斯格雷厄姆的混合建议，但我想加上我的两分钱来解释为什么。

上面的很多建议都谈到了复杂性和优化，但是当你考虑到你的类的消费者时，忘了这一切都消失了。如果*您*是唯一的消费者，并且您使用了第一个实现，那么您很可能会记得：

```
double subTotal = myOrder.TotalCash;
double tax = subTotal * 0.05;
double shipping = subTotal > 100 ? 0 : 5.95;
double grandTotal = subTotal + tax + shipping;
OutputToUser(subTotal, tax, shipping, grandTotal); 
```

其他人可能不会。看到这`myOrder.TotalCash`是一个属性，而不是一个方法，至少我会假设它是一个缓存值。也就是说，`subTotal`上例中的访问在效率上与访问相当`myOrder.TotalCash`。他们没有意识到幕后正在进行计算，他们写道：

```
double tax = myOrder.TotalCash * 0.05;
double shipping = myOrder.TotalCash > 100 ? 0 : 5.95;
double grandTotal = myOrder.TotalCash + tax + shipping;
OutputToUser(myOrder.TotalCash, tax, shipping, grandTotal); 
```

离开`myOrder.TotalCash`代表小计。现在，它已经计算了 4 次而不是 1 次。

总而言之，我确信我不是唯一一个相信**属性表示变量或缓存值**并且**方法处理某些内容并返回值的**人。存储并且只调用一次是有意义的`CalculateTotalCash()`，因为您希望它会成为性能冲击。另一方面，您期望`TotalCash`成为一个缓存值并且可以随意访问它。因此，重要的是仅`TotalCash`在它发生变化时重新计算。

在读取之间有多个集合的情况下，混合建议获胜。这样，您就不会浪费时间计算要丢弃的值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T05:59:35.913

在确定是否应派生/计算属性时，重要的是要考虑计算时的值是否需要保留。

在 TotalCash 的这种情况下 - 如果计算的业务逻辑发生更改，则**可能不希望对现有记录追溯更改 TotalCash 属性。**

只是把它放在那里...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T05:09:11.507

第一个，因为：
1）代码越少越好；
2）复杂度低；
3）更少的变量有助于减少附带问题；
4) 属性会一直更新；
5）如果您更改“CalcCashTotal”程序名称，您将获得更多其他点来更改...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T05:10:23.750

放在get函数上不是很理想。您将无缘无故地重新计算它。它甚至没有任何意义。所以这里是 ::gasp:: 优化有意义并且是首选的情况。计算一次并获得收益。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T05:18:26.103

我一直被告知，如果有大量的工作或计算正在进行，你应该用一种方法来做。据我所知，没有主要的编译器/运行时优势，但它对代码的使用者来说更有意义。需要一段时间才能将值返回给我的属性会引发一个危险信号，表明可能有问题。

那是我的 2 美分……但如果课程真的那么简单，我可能也会选择你的第一个例子:-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T05:19:29.003

第一个选项更好。“优化”的差异是微乎其微的。更不用说，如果设置一遍又一遍，但您只需要获取一次 TotalCost 怎么办？一旦课程变得非常复杂，我会更担心失去开发人员尝试调试课程的时间。

但是有一个重要的时候需要第二个选项，特别是当计算值改变计算对象时。我很难想出一个例子，所以我将使用一个真实的例子，其中墙壁中的隔间数量由其宽度决定。

```
class Wall {
    public decimal Width {
       get {
           ...
       }
       set {
           ValidateChanges();
           width = value;
           CreateBays();
       }
    }

    public Bays[] Bays {
       get {
           ...
       }
       set {
           ValidateChanges();
           ...
       }
    }

    private void CreateBays() {
        // Delete all the old bays.
        ...
        // Create a new bay per spacing interval given the wall width.
        ...
    }
} 
```

在这里，每次宽度变化时，都会重新创建墙上的隔间。如果这发生在 Bay.getter 上，那么 Bay 对象的属性将是相当灾难性的。getter 必须弄清楚自上次 get 语句以来宽度是否发生了变化，**从而增加了复杂性**。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-24T03:51:50.223

这取决于。您的应用程序是读取繁重还是写入繁重？计算成本高吗？如果计算很昂贵并且您的应用程序读取量很大，请在片场进行，这样您只需支付几次计算惩罚（与读取相比）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T04:59:21.400

我将对只读 get 或 set 进行计算。

我认为一个属性应该表现得像它有一个支持变量。

我不喜欢需要很长时间读取的计算。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T05:03:04.933

我会采用在 TotalCash 的 getter 中进行计算的方法，因为更少的代码几乎总是更好。它还确保 TotalCash 的值始终正确。作为一个人为的示例，如果您有另一个方法 NewOrder(Price, Qty) 并且您忘记在此方法结束时调用 CalculateTotal，您很容易以错误的 TotalCash 值结束。

如果计算需要一些时间来处理并且只更改一个或两个属性的值需要重新计算，那么在 setter 中计算它可能会更好，但几乎总是最好选择留下更少错误空间的方法，即使它执行时间稍长。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-07-06T09:58:09.073

我的规则，我向任何人推荐这个：

方法 = 有副作用 Getters = 没有副作用（除了记忆 - 在 getter 中也是允许的）

# linux - 什么是“内存页出率”

> ID：445698
> 
> 赞同：5
> 
> 时间：2009-01-15T04:56:48.770
> 
> 标签：linux

有人可以告诉我什么是“内存页面输出率”。我在“HP Open View”服务器监控工具中看到了这一点，并尝试用谷歌搜索它。如果有专家能澄清一下，将不胜感激。

如果页面输出率太高，达到每秒 200+，它会导致服务器崩溃吗？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T05:24:03.737

此链接可能会有所帮助：

[http://publib.boulder.ibm.com/infocenter/tivihelp/v15r1/index.jsp?topic=/com.ibm.itm.doc/main_unix65.htm](http://publib.boulder.ibm.com/infocenter/tivihelp/v15r1/index.jsp?topic=/com.ibm.itm.doc/main_unix65.htm)

" **Page Out Rate** (KB per Second)*虚拟内存管理器在前 30 秒间隔内平均每秒页出的千字节数。注意：值 -1 表示不可用，-2 表示未收集，2147483648 表示 Value_Exceeds_Minimum , -2147483647 表示 Value_Exceeds_Maximum。* "

200kb/s 的页面输出速率在某些系统上可能很好，而服务会影响到其他系统。这完全取决于您的磁盘/san 可以跟上的速度。

老实说，您最好在这些更合适的站点之一中提出这个问题，所以是用于编程相关问题，而不是系统管理员查询：

[https://stackoverflow.com/questions/321618/where-can-i-ask-questions-that-arent-programming-questions](https://stackoverflow.com/questions/321618/where-can-i-ask-questions-that-arent-programming-questions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-15T16:09:07.177

您指的是 HP OVPM 的**GBL_MEM_PAGEOUT**变量。

据我了解，这意味着某些进程分配了内存并且从未取消分配它，并且该进程当前未处于活动状态。

所以基本上它应该尽可能低。

但是，根据 HP OVPM Metrics 文档，定义是这样的：

> **GBL_MEM_PAGEOUT** 平台：HP-UX AIX NCR Sinix DEC SunOS Win3X/95
> 
> **HP-UX AIX NCR Sinix DEC** 时间间隔内到磁盘的页面输出总数。这包括分页到分页空间和文件系统的页面。
> 
> **HP-UX** 该指标适用于 HP-UX 11.0 及更高版本。
> 
> **AIX** 这与“vmstat -s”命令中的“page out”值相同。请记住，“vmstat -s”报告累积计数。
> 
> 该指标无法与“vmstat”命令中的“po”值进行比较。“po”值仅报告分页到分页空间的页数。
> 
> 要确定当前间隔的计数（即 GBL_MEM_PAGEOUT），请从当前值中减去前一个值。要确定当前间隔的速率（即 GBL_MEM_PAGEOUT_RATE），请从当前值中减去前一个值，然后除以间隔的长度。请记住，无论何时与其他工具进行任何比较，这两个工具都必须彼此间隔同步才能有效。
> 
> **HP-UX SunOS** 时间间隔内到磁盘的页面输出总数。这包括分页到分页空间和文件系统的页面。
> 
> **Win3x/95** 时间间隔内到磁盘的页面输出总数（仅限 Windows 95）。

# c - 使用 while 块什么都不做是件坏事吗？

> ID：445700
> 
> 赞同：33
> 
> 时间：2009-01-15T04:58:16.097
> 
> 标签：c, while-loop

我目前正在完成“C 编程语言”中的练习。这是我的解决方案之一：

```
int c;

while ((c=getchar()) != EOF) {

if (c == ' ') {

    while ((c = getchar()) == ' ')

    {}  // do nothing?

    putchar(' ');

}

putchar(c);

} 
```

我在[这里](http://users.powernet.co.uk/eton/kandr2/krx109.html)找到了一些与我的完全不同的解决方案，并使用一个额外的变量来跟踪正在发生的事情，而我只是使用一个 while 循环来跳过所有的空格。我的解决方案感觉有点混乱，因为在大括号之间没有任何内容的 while 循环似乎有点骇人听闻。我想知道是否有充分的理由不这样做？感谢您的任何建议:-)

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-15T05:03:00.347

一点也不——我相信你会在 K&R 中找到像这样的无操作循环，所以这几乎是官方的。

这是个人喜好问题，但我更喜欢这样的无操作循环：

```
while(something()); 
```

其他人更喜欢将分号放在单独的行上，以强调它是一个循环的事实：

```
while(something())
  ; 
```

还有一些人喜欢使用里面没有任何内容的括号，就像您所做的那样：

```
while(something())
{
} 
```

这一切都是有效的——你只需要选择你喜欢的风格并坚持下去。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T05:06:00.887

我认为这是完全可以接受的。

我要么写它：

```
//skip all spaces
while ((c = getchar()) == ' ') {} 
```

很明显，这一行代码做了一件事。

或者我会这样写：

```
while ((c = getchar()) == ' ') {
    //no processing required for spaces
} 
```

以便它与您的代码格式的其余部分匹配。

就个人而言，我不是

```
while ((c = getchar()) == ' '); 
```

格式。我认为很容易忽略分号。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T06:10:08.183

您的问题“使用 while 块不做坏事吗？” 也可以用浪费 CPU 周期来回答。在这种情况下，答案是“否”，因为进程在等待用户输入字符时会休眠。

只有在输入字符后，该进程才会唤醒。然后将进行测试，如果测试通过，即 c == ' '，进程将再次进入休眠状态，直到输入下一个字符。这将重复，直到输入非空格字符。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T05:10:21.423

好吧，如果您真的不喜欢空括号，则可以将内部循环重构为

```
while (c == ' ') {c = getchar();} 
```

不过，这需要额外的比较，所以 do while 循环会更好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T06:20:40.300

`while`什么都不做可能*是*一件坏事：

```
while(!ready) {
   /* Wait for some other thread to set ready */
} 
```

... 是一种非常非常昂贵的等待方式——只要它`ready`是错误的，它就会使用操作系统提供的尽可能多的 CPU，从而窃取其他线程可以用来做有用工作的 CPU 时间。

但是你的循环**没有**做任何事情：

```
while ((c = getchar()) == ' ')
    {};  // skip 
```

...因为它`getchar()`在每次迭代中调用。因此，正如其他所有人都同意的那样，您所做的一切都很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T05:02:59.957

我不认为程序是，但你的格式很奇怪。没有任何问题：

```
/* Eat spaces */
while ((c = getchar()) == ' '); 
```

（即表示故意没有实体）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T05:19:34.183

我赞成：

```
while ((c = getchar()) == ' ') /* Eat spaces */; 
```

我还知道有一个名为 DoNothing 的过程，专门用于在这种情况下调用。这很清楚地表明你真的什么都不做。

虽然不存在的循环体是完全可以接受的，但应该*非常*清楚它是故意的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T06:12:15.917

规范的方式——自远古以来就使用，看看，例如，在里昂的书——是

```
while(condition)       // Here's the whole thing
    ;                  // empty body. 
```

事实上，一般来说，'semicolor on a separate line' 约定用于空语句。例如，你会偶尔看到

```
if( condition-1)
     ;
else if (condition-2)
     stmt;
else {
     // do stuff here
} 
```

它更不常见，但出现在*条件 1*非常复杂的地方，所以你不想否定它和机会混淆，或者代码在其生命的一英寸内被手动优化，所以你首先要最常见的情况。

这

```
while(condition) ; 
```

form 是要严格避免的，因为这是一个常见且令人讨厌的错字：您应该明确表示您是故意这样做的。空大括号

```
 while(condition){
 } 
```

或其变体也很麻烦，因为它们要么不够突出，要么更糟糕的是导致其他错别字。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T05:05:22.370

我用过这样的代码。如果情况允许，我认为没有任何理由不使用它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T05:11:41.907

我认为这没有问题。你可以使用它，在很多情况下我更喜欢它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T06:20:32.953

嗯，不是真的，但这取决于你的架构。

```
if (dosomething()) { ; } 
```

以上内容将不断地从您的本地堆栈中推送和弹出，这会产生内存开销。此外，您还将使用 noop 操作刷新处理器的管道。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-15T06:19:26.123

尚未提及的替代选项：

```
while(condition)
    (void)0; 
```

*我真的不喜欢这样写我的循环*，但我上学期有个助教。

# c++ - 带有“typename”的模板类

> ID：445702
> 
> 赞同：1
> 
> 时间：2009-01-15T04:59:19.823
> 
> 标签：c++

我有一个模板类，我想在地图中使用该类的对象（以及参数化类型）。到目前为止，这是我能够得出的解决方案：

```
class IStatMsg;

template <typename T>
class ITier
{
public:

    // Methods
    ITier(TierType oType) : o_Type(oType){};
    virtual ~ITier(){};

    typename ITier<T> ParamITier;  // line 60

    ITier* Get(T oKey)
    {
        std::map<T, ParamITier*>::iterator it = map_Tiers.find(oKey);   // line 64

        if (it != map_Tiers.end())
            return it->second;

        return NULL;
    }

    void Set(T oKey, ITier* pTier)
    {
        map_Tiers.insert(pair<T, ParamITier*>(oKey, pTier)); // line 74
    }

    TierType GetType() { return o_Type; }

protected:
    // Methods

    // Attributes
    std::map<T, ParamITier*> map_Tiers;  // line 83
    TierType o_Type;

private:
    // Methods

    // Attributes
}; 
```

但是当我尝试编译这段代码时，我得到了一长串错误：

> /home/gayanm/street/src/QueryServer_NEW/ITier.h:60：错误：预期的嵌套名称说明符 /home/gayanm/street/src/QueryServer_NEW/ITier.h:60：错误：`ITier<T>' specified as declarator-id /home/gayanm/street/src/QueryServer_NEW/ITier.h:60: error: perhaps you want`构造函数的 ITier'/ home/gayanm/street/src/QueryServer_NEW/ITier.h:60：错误：声明中的两个或多个数据类型`ITier<T>' /home/gayanm/street/src/QueryServer_NEW/ITier.h:60: error: expected`；' 在“ParamITier”/home/gayanm/street/src/QueryServer_NEW/ITier.h:83 之前：错误：`ParamITier' was not declared in this scope /home/gayanm/street/src/QueryServer_NEW/ITier.h:83: error: template argument 2 is invalid /home/gayanm/street/src/QueryServer_NEW/ITier.h:83: error: template argument 4 is invalid /home/gayanm/street/src/QueryServer_NEW/ITier.h:83: error: ISO C++ forbids declaration of` map_Tiers' 没有类型 /home/gayanm/street/src/QueryServer_NEW/ITier.h：在成员函数中`ITier<T>* ITier<T>::Get(T)': /home/gayanm/street/src/QueryServer_NEW/ITier.h:64: error:`ParamITier' 未声明（首先使用此函数）/home/gayanm/street/src/QueryServer_NEW/ITier.h:64: 错误：（每个未声明的标识符对于它出现的每个函数只报告一次。）/home/gayanm/street /src/QueryServer_NEW/ITier.h:64：错误：模板参数 2 无效 /home/gayanm/street/src/QueryServer_NEW/ITier.h:64：错误：模板参数 4 无效 /home/gayanm/street/src /QueryServer_NEW/ITier.h:64：错误：预期`;' before '::' token /home/gayanm/street/src/QueryServer_NEW/ITier.h:66: error:`它'未声明（首先使用此功能）/home/gayanm/street/src/QueryServer_NEW/ITier.h:66：错误：请求成员`end' in` （（ITier *）this）- >ITier::map_Tiers'，属于非类类型`int' /home/gayanm/street/src/QueryServer_NEW/ITier.h: In member function`void ITier::Set(T, ITier* )': /home/gayanm/street/src/QueryServer_NEW/ITier.h:74: 错误：请求成员`insert' in` ((ITier*)this)->ITier::map_Tiers'，它是非类类型`int' /home/gayanm/street/src/QueryServer_NEW/ITier.h:74: error:`对'未声明（首先使用此函数）/home/gayanm/street/src/QueryServer_NEW/ITier.h:74：错误： ',' 标记 /home/gayanm/street/src/QueryServer_NEW/ITier.h:74 之前的预期主表达式：错误：`ParamITier' undeclared (first use this function) /home/gayanm/street/src/QueryServer_NEW/ITier.h:74: error: expected primary-expression before '>' token /home/gayanm/street/src/QueryServer_NEW/ITier.h: At global scope: /home/gayanm/street/src/QueryServer_NEW/ITier.h:93: error: base`ITier' 在没有构造函数的类中只有非默认构造函数 /home/gayanm/street/src/ QueryServer_NEW/ITier.h:109：错误：“{”标记之前的预期类名

您能否指出如何解决这些问题？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T05:07:42.303

第 60 行不访问依赖名称。您使用`ITier<T>`的是编译器知道它是给定参数的模板。而不是`typename`你想使用`typedef`;）

第 64 行*确实*访问了`iterator`作为类型名称的依赖名称，因此您必须`typename`在`std::map`. 我在这个答案上放了两个消歧，*模板*和类型名： [Disambiguations ofdependent](https://stackoverflow.com/questions/389797/gcc-template-issue#390201) *names*。

据我所知，如果您修复了第 60 行中的错误，第 74 行是正确的。

据我所知，第 83 行本身还可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:19:34.637

另外，我建议您传递`const T&`给函数而不是`T`，因为您不能确定（它是一个模板参数！）它将是一个“便宜”的副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T05:22:02.557

非常感谢。我能够使用您提供的指南修复我的代码。

```
class IStatMsg;

template <typename T>
class ITier
{
public:

    // Methods
    ITier(){};
    ITier(TierType oType) : o_Type(oType){};
    virtual ~ITier(){};

    //typename ITier<T> ParamITier; 

    ITier<T>* Get(T oKey)
    {
        typename std::map<T, ITier<T>*>::iterator it = map_Tiers.find(oKey);    

        if (it != map_Tiers.end())
            return it->second;

        return NULL;
    }

    void Set(T oKey, ITier<T>* pTier)
    {
        map_Tiers.insert(std::pair<T, ITier<T>*>(oKey, pTier));
    }

    TierType GetType() { return o_Type; }

protected:
    // Methods

    // Attributes
    std::map<T, ITier<T>*> map_Tiers;
    TierType o_Type;

private:
    // Methods

    // Attributes
}; 
```

# iphone - iPhone SDK - 如何判断文本字段是否有文本？

> ID：445705
> 
> 赞同：2
> 
> 时间：2009-01-15T05:00:09.840
> 
> 标签：iphone

很抱歉这个简单的问题，但我觉得有一种更聪明的方法可以做到这一点：

```
if ([txtFldTo.text length]>0){ 
    //do something
}
else {
    //do something else
} 
```

其中 txtFldTo 是连接到界面上的文本字段的 IBOutlet UITextField。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T05:09:54.140

像这样的东西就足够了。

if([[文本字段文本]长度] > 0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T07:11:49.667

你做对了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T02:33:07.130

```
if (![[textfield text] isEqualToString:@""]) {

} 
```

或者

```
if ([[textfield text] length] != 0) {

} 
```

# php - 用于销售服务的电子商务工具

> ID：445711
> 
> 赞同：5
> 
> 时间：2009-01-15T05:02:24.547
> 
> 标签：php, mysql, e-commerce

我正在寻找一个好的电子商务 CMS。

我需要能够销售服务和产品，它必须是开源的，可以在任何需要的地方进行定制。

我对 PHP 和 Mysql 非常熟悉，对 python 和 ruby​​ 也比较熟悉，所以首选 PHP 解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T06:37:54.947

一些最好的 PHP 购物车：

[Magento](http://www.magentocommerce.com) - 全功能。优秀的代码质量。很难学。需要大量服务器资源。

[PrestaShop](http://www.prestashop.com/) - PrestaShop 目前被全球 250,000 家商店使用，并提供 60 种不同的语言。

[OpenCart](http://opencart.com) - OpenCart 带有一个内置的会员系统，会员可以在其中推广特定产品并获得报酬。

[InterSpire](http://www.interspire.com/shoppingcart/) - 不是免费的。

[FoxyCart](http://foxycart.com) - 不是免费的。使用您的模板的托管结帐。与 Modx 或 Expression Engine 等 CMS 配合使用效果很好。

[LemonStand](http://lemonstandapp.com/) - 不是免费的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-13T09:10:41.670

我有两个建议给你。

1.  不要使用 OSCommerce。
2.  不要使用基于 OSCommerce 的 XTCommerce

更具体地说，**永远不要将** **oscommerce**用于您想要扩展的**任何项目。**如果您 100% 开箱即用地运行项目并需要一些付款扩展，没有人会考虑它两秒钟，但最好不要。OSCommerce 具有 2001 年的代码。OSCommerce 只有一种编码模式，即 FIXHACKCOPYQUICKPASTEHERENOW。它否定了你认为从软件开发和项目管理中知道的一切。如果您使用 OSCommerce 并尝试扩展它，您的项目将需要两倍的时间，您将开始讨厌 web 开发。是的，我知道这听起来像，但我不是在开玩笑。去过也做过。如果有人告诉您使用 oscommerce - 例如对于所有现有的扩展程序 - 站起来离开房间。

### 额外提示：

Magento 很慢。

*   [http://www.prestashop.com/](http://www.prestashop.com/) - 在 OSS 世界 Prestashop 有一定的知名度。
*   [http://www.interspire.com/shoppingcart/](http://www.interspire.com/shoppingcart/)有一些声誉，但不是 OSS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-18T23:15:12.997

我知道你想坚持使用基于 Linux 但 nopCommerce 很棒： [http ://www.nopcommerce.com/](http://www.nopcommerce.com/)

[http://demo.nopcommerce.com/](http://demo.nopcommerce.com/)

免费你不能打败这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T05:22:10.653

试试[Magento](http://www.magentocommerce.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T06:23:10.233

你检查过 [http://www.oscommerce.com/](http://www.oscommerce.com/)

这里也讨论过： [https ://stackoverflow.com/questions/143656/whats-the-best-free-and-opensource-php-ecommerce-solution-and-why](https://stackoverflow.com/questions/143656/whats-the-best-free-and-opensource-php-ecommerce-solution-and-why)

问候

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-09-28T09:35:27.283

oscommerce-基本上您想要的许多功能，他们都有。唯一的问题是它是插件格式的，你需要去他们的论坛找到要安装的插件。

我建议如下：

interspire 购物车 - 最用户友好的购物车之一。不是免费的，但质量是有的。我个人非常喜欢这个。

Magento- 是开源软件。非常好的质量和功能。但是，但是，吃掉很多服务器内存。如果你想这样做，从半独立服务器开始是你的选择。

# ocr - Google 图书如何查找文本区域？

> ID：445733
> 
> 赞同：4
> 
> 时间：2009-01-15T05:11:52.047
> 
> 标签：ocr, google-books

计算机视觉中的一个具有挑战性的主题是处理文档扫描。通常这涉及到许多步骤，例如去噪、颜色分析、二值化、文本块识别、OCR，然后可能还有一些上下文分析和校正。

我很好奇是否有人理解、知道或可以向我指出关于 Google 如何在 OCR 阶段之前识别文本块的文献。有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T00:44:39.923

我相信 Google 将[Tesseract OCR](http://code.google.com/p/tesseract-ocr/)引擎与另一个名为[Ocropus](http://code.google.com/p/ocropus/)的工具结合使用，这两个工具都是开源的。我对它们的工作原理一无所知，但您可能有兴趣查看上面链接中提供的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T05:33:29.473

这是我图书馆的数字化专家提供的二手信息，但 Google 的方法似乎只是将所有内容都通过自动化流程进行处理，对任何看起来像文本的内容进行处理，并且不会对裁剪单个图像或做太多语义大惊小怪analasys 来寻找图像标题等。他们可能正在做一些不明显的微妙事情，但从表面上看，他们肯定是在追求数量而不是质量，这对他们来说是明智的，为了他们的目的，IMO。

# int - C# 3 字节整数

> ID：445749
> 
> 赞同：4
> 
> 时间：2009-01-15T05:20:26.567
> 
> 标签：int, byte

我正在做一个项目，我需要在字节级别处理整数。由于节省空间是首要考虑因素，我只需要非常小的（和可变长度的整数）。

有没有办法可以将 int '4096' 转换为 3 个字节？或 '1053' 成 2 个字节？

显然我可以手动执行 = (byte[0] * 256) + (byte[1])，但我想知道是否有更简单的选项可以将 int 转换为 x 字节并再次返回？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-15T05:30:23.460

你可以吗？当然。它会节省任何空间吗？也许，取决于你想做多少工作。您必须了解处理器是 32 位的，这意味着它有 4 个字节的寄存器，这就是它想要存储和访问事物的方式。要强制使用 3 字节“int”，您必须将其保存在字节数组中，并在使用前将其从数组中提取到对齐的地址。这意味着如果你把它存储得很短，编译器要么将它填充掉（你会失去你认为你已经创建的任何效率），要么它的读写速度会慢*很多。*

如果这是一个桌面应用程序，那么节省空间究竟是一个主要考虑因素，尤其是在每个元素 1 个字节时？元素访问的性能损失可能会改变您对一个字节的重要性的看法。

我会争辩说，如果那个 1 字节真的很重要，那也许，只是也许，你使用了错误的语言。首先，如果我不安装和使用 CLR，您将节省的字节数是*很多*字节。

旁注：你也会做一个转变，而不是一个乘法（尽管编译器可能会帮你）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T05:57:28.320

您可以进行可变长度整数编码。多年前的旧方法是使用每个字节的高位来表示整数继续到另一个字节。所以你每字节丢失一位，但获得小整数。这在每个最后一个字节都很重要的持久存储中非常有用。

示例：假设我们正在处理无符号整数，我们将有

```
int  binary
0                       00000000
1                       00000001
...  
127                     01111111
128            00000001 10000000
129            00000001 10000001
...
255            00000001 11111111
256            00000010 10000000
...
16383          01111111 11111111
16384 00000001 10000000 10000000 
```

所以 0-127 占用 1 个字节， 128-16383 占用 2 个字节，依此类推...

有关执行此操作的更复杂方法，请查看[此页面](http://www.dlugosz.com/ZIP2/VLI.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-15T06:15:16.130

只是为了增加精神错乱，让我们在 C# 中使用旧的 C 风格联合技巧：

```
[StructLayout(LayoutKind.Explicit)]
struct OddUnion
{
    /* The 32-bit integer value */
    [FieldOffset(0)]
    public int IntegerValue;

    /* The bytes that overlap with it */
    [FieldOffset(0)]
    public byte Byte1;
    [FieldOffset(1)]
    public byte Byte2;
    [FieldOffset(2)]
    public byte Byte3;
    [FieldOffset(3)]
    public byte Byte4;
 } 
```

然后，当您想“转换”时，请执行以下操作：

```
OddUnion myOddUnion;
myOddUnion.IntegerValue = 4096;
Byte secondByte = myOddUnion.Byte1; 
```

But that really only helps if you're looking to "save" the cost of bit-shifting out a single byte from a word. I haven't looked at the generated SMIL, so I don't know whether this is any cheaper in comparison to any other solution.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T05:31:26.610

`BitConverter.GetBytes`会给你字节。

和

`BitConverter.ToInt32`将从字节中为您提供 32 位 int 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T05:31:13.473

你必须做一些位移。如果你使用 HEX 就容易多了，因为每个数字（我的意思是每个数字，但数字是基数 10，hexgit）代表四位。

# linq - 如何在 LINQ 中设置自动增量值 = true

> ID：445754
> 
> 赞同：2
> 
> 时间：2009-01-15T05:23:49.697
> 
> 标签：linq

我有一个名称为“员工”的表，其中包含四个字段 EmployeeId、Name、Address、Age 我已将 EmployeeId 设置为主键。我希望 EmployeeId 字段在添加任何新记录时自动递增。

插入的代码隐藏是： { DataClassesDataContext db = new DataClassesDataContext();

```
 Employee emp = new Employee {Name = "James", Address = "India", Age = 24};
    db.Employees.InsertOnSubmit(emp);
    db.SubmitChanges();
    ShowEmployee();

} 
```

设计师.cs：

```
[Column(Storage = "_EmployeeId", DbType = "Int NOT NULL", IsPrimaryKey = true,IsDbGenerated=true,CanBeNull=false)] 
```

当我运行此应用程序时，出现以下错误：

无法将值 NULL 插入到列“EmployeeId”、表“Habib.dbo.Employee”中；列不允许空值。插入失败。该语句已终止。

非常感谢任何帮助。

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T05:31:39.853

EmployeeId 字段应该是数据库表中的一个标识列。如果你这样做，它会自动增加。LINQ 应该在这之后发现它是一个 Identity 列。

# math - 十六进制数？

> ID：445771
> 
> 赞同：4
> 
> 时间：2009-01-15T05:33:31.330
> 
> 标签：math, hex, nomenclature

如果 digit 是以 10 为底的数字的名称，那么以 16 为底的数字的名称是什么？海克斯吉特？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T05:36:53.337

它是一个“半字节”（即半个字节）。

[http://en.wikipedia.org/wiki/Nibble](http://en.wikipedia.org/wiki/Nibble)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T05:35:17.943

*数字*。只是一个十六进制的。

您是否正在寻找*二进制数字*的模拟*位*？*Hexgit*不会是我的选择。它并没有真正从舌头上滚下来。至于存储单位，一个十六进制数字代表一个*nibble*的价值（或*nybble*）。

 **** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T05:38:18.483

[定义：数字](http://www.google.com/search?q=define%3A+digit)

共同构成记数系统的要素之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T05:37:33.053

“数字”一词可用于任何数字系统。唯一的例外是'bit'，它实际上只是'binary digit'的缩写和'trit'，它是'ternary digit'的缩写。（但是，您仍然可以将位和三位称为“数字”。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T05:38:03.257

我认为没有真正达成共识，但请参阅[信息单位了解](http://en.wikipedia.org/wiki/Units_of_information)一些选项。

就个人而言，我只会说“十六进制数字”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T05:41:01.597

仍然是“数字”，只要你有 16 个手指 ;-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T06:11:59.770

“Hexdigit”和“hex digit”都在教科书中广泛使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T05:55:49.850

“Hexgit”将是一个糟糕的选择，因为“hex”正式建议基数为 6 而不是 16。

“十六进制”将保留 6+10 表示，但我会坚持使用“数字”。

# javascript - 触发文件下载的正确方法（在 PHP 中）？

> ID：445774
> 
> 赞同：7
> 
> 时间：2009-01-15T05:36:09.283
> 
> 标签：javascript, html, download

快速（希望是简单的）问题：我需要触发下载由 PHP 文件生成的 PDF 文件。我可以做这个：

```
<a href="download.php">Download</a> 
```

但我应该以另一种方式这样做吗？也许是Javascript？以上工作，但窗口显示“正在加载...”，直到下载开始。我想向用户提供一些正在发生的事情的反馈。

想法？

**注意：**我已经有了从服务器发送文件的代码。它完美地工作。这个问题只是关于如何最好地从客户端调用该脚本。

一些网站的下载会自动启动。他们是怎么做到的？

直接 URL 的问题在于，如果 PHP 脚本出错，它将替换现有页面的内容，这不是我想要的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T05:45:29.420

**编辑**

是的 javascript，类似于：

```
<a href="download.php" onclick="this.innerHTML='Downloading..'; downloadPdf(this);">Download</a> 
```

如果您需要真正了解何时开始下载，您可能需要调用 iframe，然后在其上使用“onload”事件。例如：

```
// javascript
function downloadPdf(el) {
    var iframe = document.createElement("iframe");
    iframe.src = "download.php";
    iframe.onload = function() {
        // iframe has finished loading, download has started
        el.innerHTML = "Download";
    }
    iframe.style.display = "none";
    document.body.appendChild(iframe);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T05:47:04.517

您下载的解决方案很好。您可能需要考虑向用户提供一些视觉反馈，也许通过使用 javascript 在通过 onclick 处理程序单击链接时在当前页面上显示“正在下载，请等待消息”。或者只是在链接旁边表明下载可能需要一些时间才能开始。由于 IE 将卸载页面，停止任何 GIF 动画，我更喜欢文件下载的文本指示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T05:42:05.853

通过使用 onclick 事件处理程序来伪造它以显示旋转的 gif

```
<a href="download.php" onclick="ShowDownloading();">Download</a> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T08:19:36.723

自动开始下载通常在普通页面中使用元标记：

```
<META HTTP-EQUIV="REFRESH" CONTENT="10.0;URL=download.php"> 
```

此示例将在 10 秒内将浏览器重定向到 download.php。

# language-agnostic - 在数字集合中找到最接近的匹配项

> ID：445782
> 
> 赞同：25
> 
> 时间：2009-01-15T05:38:36.423
> 
> 标签：language-agnostic, code-golf

所以我今天被问到在一个集合中找到接近匹配的最佳方法是什么。

例如，你有一个这样的数组：

```
1, 3, 8, 10, 13, ... 
```

最接近4的数是多少？

集合是数字的，无序的，可以是任何东西。与要匹配的数字相同。

让我们看看我们可以从选择的各种语言中得出什么。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-16T01:02:22.237

J 中的 11 个字节：

```
C=:0{]/:|@- 
```

例子：

```
>> a =: 1 3 8 10 13
>> 4 C a
3
>> 11 C a
10
>> 12 C a
13 
```

我对外行的细分：

```
0{         First element of
]          the right argument
/:         sorted by
|          absolute value 
@          of
-          subtraction 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-30T06:14:52.557

**较短的 Python：41 个字符**

```
f=lambda a,l:min(l,key=lambda x:abs(x-a)) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T06:03:07.903

我在 python 中的尝试：

```
def closest(target, collection) :
    return min((abs(target - i), i) for i in collection)[1] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T06:44:25.573

**时髦**的 28B

```
f={a,n->a.min{(it-n).abs()}} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T06:46:38.250

一些 C# Linq 的……太多的方法来做到这一点！

```
decimal[] nums = { 1, 3, 8, 12 };
decimal target = 4;

var close1 = (from n in nums orderby Math.Abs(n-target) select n).First();
var close2 = nums.OrderBy(n => Math.Abs(n - target)).First();

Console.WriteLine("{0} and {1}", close1, close2); 
```

如果您改用列表，则可以使用更多方法，因为普通的 ol 数组没有 .Sort()

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-15T05:53:27.453

假设值从名为 T 的表中开始，列名为 N，并且我们正在寻找值 4，那么在 Oracle SQL 中它需要 59 个字符：

```
select*from(select*from t order by abs(n-4))where rownum=1 
```

我使用 select * 来减少空格要求。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-15T06:30:15.413

PostgreSQL：

```
select n from tbl order by abs(4 - n) limit 1 
```

在两条记录共享相同值的“abs(4 - id)”的情况下，输出将是不确定的并且可能不是常数。为了解决这个问题，我建议像未经测试的猜测：

```
select n from tbl order by abs(4 - n) + 0.5 * 4 > n limit 1; 
```

此解决方案提供 O(N log N) 量级的性能，其中 O(log N) 是可能的，例如：[https ://stackoverflow.com/a/8900318/1153319](https://stackoverflow.com/a/8900318/1153319)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-10T07:12:26.173

因为我实际上需要这样做，所以这是我的 PHP

```
$match = 33;

$set = array(1,2,3,5,8,13,21,34,55,89,144,233,377,610);

foreach ($set as $fib)
    {
        $diff[$fib] = (int) abs($match - $fib);
    }
$fibs = array_flip($diff);
$closest = $fibs[min($diff)];

echo $closest; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-07-08T05:13:45.057

像 Python 这样的 Ruby 有一个用于 Enumerable 的 min 方法，因此您不需要进行排序。

```
def c(value, t_array)
  t_array.min{|a,b|  (value-a).abs <=> (value-b).abs }
end

ar = [1, 3, 8, 10, 13]
t = 4
c(t, ar) = 3 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-16T00:07:21.940

**语言：C，字符数：79**

```
c(int v,int*a,int A){int n=*a;for(;--A;++a)n=abs(v-*a)<abs(v-n)?*a:n;return n;} 
```

签名：

```
int closest(int value, int *array, int array_size); 
```

用法：

```
main()
{
    int a[5] = {1, 3, 8, 10, 13};
    printf("%d\n", c(4, a, 5));
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-16T10:46:23.273

Scala（62 个字符），基于 J 和 Ruby 解决方案的思想：

```
def c(l:List[Int],n:Int)=l.sort((a,b)=>(a-n).abs<(b-n).abs)(0) 
```

用法：

```
println(c(List(1,3,8,10,13),4)) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-01-22T07:17:30.043

上面的代码不适用于浮点数。
所以这是我修改后的 php 代码。

```
function find_closest($match, $set=array()) {
    foreach ($set as $fib) {  
        $diff[$fib] = abs($match - $fib);  
    }  
    return array_search(min($diff), $diff);  
}

$set = array('2.3', '3.4', '3.56', '4.05', '5.5', '5.67');  
echo find_closest(3.85, $set); //return 4.05 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-01-17T19:14:04.120

PostgreSQL：

这在 FreeNode 上由 RhodiumToad 指出，并且性能约为 O(log N)。，比此处的其他 PostgreSQL 答案要好得多。

```
select * from ((select * from tbl where id <= 4
order by id desc limit 1) union
(select * from tbl where id >= 4
order by id limit 1)) s order by abs(4 - id) limit 1; 
```

为了更好地处理 id 存在的情况，两个条件都应该是“或等于”。这也适用于两条记录共享相同值的“abs(4 - id)”然后其他 PostgreSQL 在这里回答的情况。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-06-07T01:31:13.850

Python by 我和[https://stackoverflow.com/users/29253/igorgue](https://stackoverflow.com/users/29253/igorgue)基于此处的其他一些答案。只有 34 个字符：

```
min([(abs(t-x), x) for x in a])[1] 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-15T05:51:34.040

**已编辑 = 在 for 循环中**

```
int Closest(int val, int[] arr)
{
    int index = 0;
    for (int i = 0; i < arr.Length; i++)
        if (Math.Abs(arr[i] - val) < Math.Abs(arr[index] - val))
            index = i;
    return arr[index];
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-15T06:09:46.530

Haskell 条目（已测试）：

```
import Data.List

near4 = head . sortBy (\n1 n2 -> abs (n1-4) `compare` abs (n2-4)) 
```

通过将接近 4 的数字放在前面附近来对列表进行排序。 `head`取第一个元素（最接近 4）。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-15T06:20:33.170

红宝石

```
def c(r,t)
r.sort{|a,b|(a-t).abs<=>(b-t).abs}[0]
end 
```

不是最有效的方法，但很短。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-15T06:25:17.967

只返回一个数字：

```
var arr = new int[] { 1, 3, 8, 10, 13 };
int numToMatch = 4;
Console.WriteLine("{0}", 
     arr.Select(n => new{n, diff = Math.Abs(numToMatch - n) }).OrderBy(x => x.diff).ElementAt(0).n); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-15T06:38:30.857

只返回一个数字：

```
var arr = new int[] { 1, 3, 8, 10, 13 };
int numToMatch = 4;

Console.WriteLine("{0}", 
   arr.OrderBy(n => Math.Abs(numToMatch - n)).ElementAt(0)); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-16T00:35:19.857

Perl -- 66 个字符：

```
perl -e 'for(qw/1 3 8 10 13/){$d=($_-4)**2; $c=$_ if not $x or $d<$x;$x=$d;}print $c;' 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-01-17T14:49:30.750

这是另一个 Haskell 答案：

```
import Control.Arrow
near4 = snd . minimum . map (abs . subtract 4 &&& id) 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-01-17T20:24:24.360

Haskell，60 个字符 -

```
f a=head.Data.List.sortBy(compare`Data.Function.on`abs.(a-)) 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2010-01-19T00:48:12.887

**Kdb+** , 23B:

```
C:{x first iasc abs x-} 
```

用法：

```
q)a:10?20
q)a
12 8 10 1 9 11 5 6 1 5

q)C[a]4
5 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-05-26T10:01:55.490

在 Java 中使用可导航的地图

```
NavigableMap <Integer, Integer>navMap = new ConcurrentSkipListMap<Integer, Integer>();  

navMap.put(15000, 3);  
navMap.put(8000, 1);  
navMap.put(12000, 2);  

System.out.println("Entry <= 12500:"+navMap.floorEntry(12500).getKey());  
System.out.println("Entry <= 12000:"+navMap.floorEntry(12000).getKey());  
System.out.println("Entry > 12000:"+navMap.higherEntry(12000).getKey()); 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-05-19T22:11:20.760

Python，不确定如何格式化代码，也不确定代码是否会按原样运行，但它的逻辑应该可以工作，而且无论如何可能有内置函数......

```
list = [1,4,10,20]
num = 7
for lower in list:
         if lower <= num:
           lowest = lower #closest lowest number

for higher in list:
     if higher >= num:
           highest = higher #closest highest number

if highest - num > num - lowest: # compares the differences
    closer_num = highest
else:
    closer_num = lowest 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-01-15T06:06:16.303

```
int numberToMatch = 4;

var closestMatches = new List<int>();
closestMatches.Add(arr[0]); // closest tentatively

int closestDifference = Math.Abs(numberToMatch - arr[0]);

for(int i = 1; i < arr.Length; i++)
{
    int difference = Math.Abs(numberToMatch - arr[i]);
    if (difference < closestDifference)
    {
        closestMatches.Clear();
        closestMatches.Add(arr[i]);
        closestDifference = difference;
    }
    else if (difference == closestDifference)
    {       
        closestMatches.Add(arr[i]);
    }
}

Console.WriteLine("Closest Matches");
foreach(int x in closestMatches) Console.WriteLine("{0}", x); 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-01-15T06:07:23.853

你们中的一些人似乎没有读到这个列表`unordered`（尽管我可以理解你的困惑）。在 Java 中：

```
public int closest(int needle, int haystack[]) { // yes i've been doing PHP lately
  assert haystack != null;
  assert haystack.length; > 0;
  int ret = haystack[0];
  int diff = Math.abs(ret - needle);
  for (int i=1; i<haystack.length; i++) {
    if (ret != haystack[i]) {
      int newdiff = Math.abs(haystack[i] - needle);
      if (newdiff < diff) {
        ret = haystack[i];
        diff = newdiff;
      }
    }
  }
  return ret;
} 
```

不完全简洁，但嘿它的Java。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-15T23:52:48.443

**Common Lisp**使用迭代库。

```
(defun closest-match (list n)
     (iter (for i in list)
            (finding i minimizing (abs (- i n))) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-20T08:51:01.840

****[F#](http://fsharp.net)**中的**41 个字符**：**

 **```
let C x = Seq.min_by (fun n -> abs(n-x)) 
```

如在

```
#light

let l = [1;3;8;10;13]

let C x = Seq.min_by (fun n -> abs(n-x))

printfn "%d" (C 4 l)   // 3 
printfn "%d" (C 11 l)  // 10
printfn "%d" (C 12 l)  // 13 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-07-08T05:42:52.347

**红宝石**。一通。很好地处理负数。也许不是很短，但肯定很漂亮。

```
class Array
  def closest int
    diff = int-self[0]; best = self[0]
    each {|i|
      if (int-i).abs < diff.abs
        best = i; diff = int-i
      end
    }
    best
  end
end

puts [1,3,8,10,13].closest 4 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-01-28T19:43:44.417

## Excel VBA - 查找 Excel 范围的索引或最接近目标值的值

给定一个现有的 Excel 范围，rangeOfValues：

1.  使用 Application.Match 查找 Range 中最接近匹配值的索引（注意 Match 方法返回一个 Double）

    ```
    Dim iMatch as Double 
    iMatch = Application.Match(valueToMatch, rangeOfValues) 
    ```

2.  使用 VLOOKUP/HLOOKUP 找到最接近目标值的范围值

    ```
    Dim closest as Variant
    closest = VLOOKUP(valueToMatch, rangeOfValues) 
    ```

如果需要完全匹配：

```
Dim exactM as Variant
exactM = VLOOKUP(valueToMatch, rangeOfValues, False) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2010-06-07T18:53:34.590

另一个 PHP 答案：

```
function closestMatch($int, $in) {
    $diffs = array();
    foreach ($in as $i)
        $diffs[abs($int - $i)] = $i;
    ksort($diffs);
    foreach ($diffs as $i) return $i;
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2012-06-06T08:37:31.337

**Python + 麻木**

```
import numpy as np
f = lambda lst, target: lst[np.argmin(np.abs(np.array(lst) - target))] 
```

例子：

```
>>> f([1,2,5,3,10],9)
10 
```

# database - 如何保持代码库和数据库模式同步？

> ID：445800
> 
> 赞同：5
> 
> 时间：2009-01-15T05:49:41.923
> 
> 标签：database, visual-studio, orm, tfs, schema

所以最近在我正在进行的一个项目中，我们一直在努力保持解决方案的代码库和相关的数据库模式同步（数据库 = SQL Server 2008）。

数据库更改相当频繁地发生（添加列、约束、关系等），因此人们从源代码管理中执行“获取最新”并发现他们也需要重建数据库并不少见（有时他们忘记做后者）。

我们没有使用 VSTS：数据库版 (DataDude)，而是使用带有脚本（批处理文件）的标准 Visual Studio 数据库项目，该脚本从 T-SQL 脚本中拆除并重新创建数据库。该解决方案是一个 .Net 和 ASP.net 解决方案，使用 LINQ to SQL 作为 ORM 底层。

任何人都对采取的方法（无论是否自动）有想法，这将使每个人都了解最新的数据库模式？

与 MSBuild 的持续集成是一种选择，但仅有助于获取任何已提交的重大更改，在我上面强调的场景中并没有真正的帮助。

如果有帮助，我们正在使用 Team Foundation Server。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T05:58:51.187

我们尝试从创建脚本开始。

也就是说，除非脚本已经过测试并检查到源代码管理中，否则对数据库的更改是不被授权的。

但这假设数据库团队与您的应用程序团队集成在一起，这在大型项目中通常不是这种情况......

（我很想“很难”回答这个问题）

编辑：如果您的流程不正确，工具将无济于事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T06:11:33.627

好的，虽然它不是整个解决方案，但您应该在应用程序代码中包含一个断言，该断言链接到数据库以断言正在使用正确的模式，这样至少它变得显而易见，并且您避免了无声的错误和人们抱怨这些东西突然疯了。

至于模式版本，如果可用，您可以使用一些特定于数据库的功能，但我个人更喜欢声明一个模式版本表并将版本号保留在那里，这样它就可以移植并且可以通过一个简单的选择语句进行检查

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T10:28:29.940

看看 DB Ghost - 您可以使用脚本在几秒钟内创建一个 dbp，然后使用更改管理器管理您的所有数据库代码。www.dbghost.com

这正是 DB Ghost 旨在处理的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T05:59:21.450

我们基本上按照您的方式做事，生成脚本也检查到源代码控制中。我是指定的数据库管理员，所以对脚本本身的所有更改都是通过我完成的。人们向我发送他们所做更改的脚本，我更新架构的主副本，运行生成脚本 (SSMS) 以生成新的数据库脚本，然后将其签入。我将我的代码副本与任何其他地方正在进行的更改。我们是一家小商店，所以这对我们来说效果很好。我意识到它可能无法扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T06:18:43.923

如果您不使用 Visual Studio 数据库专业版，那么您将需要另一个工具来将数据库分解为其基本部分，以便以更轻松的方式管理和更改它们。

如果您想保持对所有数据库更改和更新的理智，我建议您认真考虑[Redgate 的 SQL 工具。](http://www.red-gate.com/products/sql_tools_overview.htm)

*   [SQL 打包程序](http://www.red-gate.com/products/SQL_Packager/index.htm)
*   [SQL 多脚本](http://www.red-gate.com/products/SQL_Multi_Script/index.htm)
*   [SQL 重构](http://www.red-gate.com/products/SQL_Refactor/index.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T07:06:41.643

使用[RedGate SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm)之类的工具在任何给定版本的数据库之间生成更改模式。然后，您可以将该文件签入源代码控制

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T07:25:35.647

看看这个问题：[数据库的动态补丁](https://stackoverflow.com/questions/252972/dynamic-patching-of-databases)。我认为这与您的问题非常相似，可以提供帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T19:58:12.867

我对这个问题的解决方案很简单。将所有内容定义为 XML，并确保数据库、ORM 和 UI 都是从该 XML 生成的，没有例外。这样，您可以使用代码生成工具快速重新生成数据库创建脚本，这将改变您的架构，同时（希望）保留一些数据。这需要一些努力，但最终结果是值得的。

# c++ - 在 Xcode 中链接库

> ID：445815
> 
> 赞同：29
> 
> 时间：2009-01-15T05:58:10.207
> 
> 标签：c++, xcode, linker

我正在使用 powerbook (osx 10.5)，最近下载并安装了 FFTW 3.2 ([链接文本](http://www.fftw.org/fftw2_doc/fftw_2.html))。我已经能够使用终端根据在线教程编译和运行一些简单的程序：

```
g++ main.cpp -lfftw3 -lm 
```

但是，我无法在 Xcode 中编译相同的程序。我收到一个链接错误，“未找到符号”。在 /usr/local/lib 中有一个名为 libfftw3.a 的文件。这怎么可能联系起来？此外，显然这些库必须以特定顺序链接，即参见：[链接文本](http://www.fftw.org/faq/section3.html#linkfails)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-16T00:22:10.290

To link to a .a library like this in Xcode you need to:

*   Double-click on your target or application in Xcode to open the Info window

*   Switch to the "Build" tab

*   Add -lfftw3 to "Other Linker Flags" (under "Linking")

*   Add the path to your library to the "Library Search Paths" (under "Search Paths"). In your case this will be /usr/local/lib

We use FFTW (it's great by the way), this works for us!

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-15T06:21:10.533

您是否为目标设置了这些选项？

在“链接->其他链接器标志”下添加：“-L/path/to/library -lfftw3 -lm”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-25T16:39:09.523

> /Developer/SDKs/MacOSX10.5.sdk/usr/local/lib/libfftw3.a 中的警告，文件不是必需的架构

也许二进制格式不同，例如库可能是 32 位，而应用程序是 64 位。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-19T02:26:47.640

OK - I finally got this working. I also needed the the GNU Scientific Libraries and ran into similar issues with the architecture setting. For anyone interested, this tutorial goes through how to set up Xcode and link libraries:

[https://web.archive.org/web/20101006023300/http://www.boyfarrell.com/learning-curve/gnu-scientific-library-and-xcode-31](https://web.archive.org/web/20101006023300/http://www.boyfarrell.com/learning-curve/gnu-scientific-library-and-xcode-31)

# python - GAE - 如何在没有连接的情况下生活？

> ID：445827
> 
> 赞同：13
> 
> 时间：2009-01-15T06:07:25.070
> 
> 标签：python, google-app-engine, join, google-cloud-datastore

## 示例问题：

### 实体：

*   用户包含姓名和朋友列表（用户参考）
*   博客文章包含标题、内容、日期和作者（用户）

### 要求：

我想要一个显示用户朋友最近 10 篇文章的标题和博客链接的页面。我还希望能够继续翻阅旧条目。

## SQL解决方案：

所以在 sql 领域它会是这样的：

```
select * from blog_post where user_id in (selectfriend_id from user_friend where user_id = :userId) 按日期排序

```

## 我能想到的 GAE 解决方案是：

*   加载用户，循环浏览朋友列表并加载他们最新的博客文章。最后合并所有博文，找到最新的10篇博文
*   在博客文章中列出所有将作者作为朋友的用户。这意味着简单的阅读，但在添加拥有大量博客文章的朋友时会导致配额超载。

我不相信这些解决方案中的任何一个都会扩展。

我确定其他人已经遇到了这个问题，但我已经搜索过、观看过 google io 视频、阅读过其他人的代码……我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T11:58:10.587

如果您查看您提供的 SQL 解决方案将如何执行，它将基本上是这样的：

1.  获取当前用户的好友列表
2.  对于列表中的每个用户，开始对最近的帖子进行索引扫描
3.  合并第 2 步中的所有扫描，当您检索到足够的条目时停止

您可以在 App Engine 中自己执行完全相同的过程，方法是将 Query 实例用作迭代器并对它们进行合并连接。

你是对的，这不会很好地扩展到大量的朋友，但它遇到了与 SQL 实现完全相同的问题，它也没有掩饰它们：获取最新的 20 个（例如）条目的成本大约是O(n log n) 工作，其中 n 是朋友的数量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-25T11:06:54.863

Google io 演讲中涵盖了该主题： [http ://code.google.com/events/io/sessions/BuildingScalableComplexApps.html](http://code.google.com/events/io/sessions/BuildingScalableComplexApps.html)

基本上谷歌团队建议使用列表属性和他们所谓的关系索引实体，可以在这里找到一个示例应用程序：http: [//pubsub-test.appspot.com/](http://pubsub-test.appspot.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T11:59:10.710

“加载用户，循环浏览朋友列表并加载他们最新的博客文章。”

这就是一个连接——嵌套循环。某些类型的连接是带有查找的循环。大多数查找只是循环；有些是哈希。

“最后合并所有博文，找到最新的10篇博文”

这是一个有限制的 ORDER BY。这就是数据库正在为您做的事情。

我不确定这有什么不可扩展的；无论如何，这就是数据库的作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-23T22:54:57.357

[这是一个来自http://pubsub-test.appspot.com/](http://pubsub-test.appspot.com/)的 python 示例：

有人有java的吗？谢谢。

```
from google.appengine.ext import webapp

from google.appengine.ext import db

class Message(db.Model):
 body = db.TextProperty(required=True)
 sender = db.StringProperty(required=True)
 receiver_id = db.ListProperty(int)

class SlimMessage(db.Model):
 body = db.TextProperty(required=True)
 sender = db.StringProperty(required=True)

class MessageIndex(db.Model):  
 receiver_id = db.ListProperty(int)

class MainHandler(webapp.RequestHandler):

 def get(self):
  receiver_id = int(self.request.get('receiver_id', '1'))
  key_only = self.request.get('key_only').lower() == 'on'
  if receiver_id:
    if key_only:
      keys = db.GqlQuery(
          'SELECT __key__ FROM MessageIndex WHERE receiver_id = :1',
          receiver_id).fetch(10)
      messages.extend(db.get([k.parent() for k in keys]))
    else:
      messages.extend(Message.gql('WHERE receiver_id = :1',
                      receiver_id).fetch(10)) 
```

# php - 如何使用 HTML Tidy (PHP) 保持不间断的空格？

> ID：445836
> 
> 赞同：0
> 
> 时间：2009-01-15T06:13:00.613
> 
> 标签：php, html, htmltidy

我刚刚注意到`tidy_repair_string()`从空元素中删除我的不间断空格导致我的表格崩溃。基本上我已经投入：

> `<td>&nbsp;</td>`

HTML Tidy 将它们剥离为：

```
<td> </td> 
```

这可能是也可能不是一些 Unicode 中断，但无论哪种方式它都会崩溃。我见过的唯一`&nbsp;`相关选项是“quote-nbsp”，但似乎并非如此。我认为它默认为无论如何。

如何保持不间断的空间？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-15T07:37:06.730

应用此样式，则无需将内容放在“空”单元格中：

td {[空单元格](http://www.w3schools.com/Css/pr_tab_empty-cells.asp)：显示；}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T07:32:24.850

使用“裸”配置选项。

此处提供更多信息和解释：http: [//osdir.com/ml/web.html-tidy.user/2004-07/msg00005.html](http://osdir.com/ml/web.html-tidy.user/2004-07/msg00005.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T06:21:20.330

您可以尝试以下方法：

`$myString = str_replace(" ", "&nbsp;&nbsp;", $someText);`

# javascript - jQuery 表单 submit() 在 IE6 中不起作用？

> ID：445850
> 
> 赞同：30
> 
> 时间：2009-01-15T06:24:46.330
> 
> 标签：javascript, jquery, html, internet-explorer-6

我想使用 jquery 提交如下；

```
$("#formid").submit(); 
```

它在除 IE6 之外的所有浏览器中都能完美运行。

如何让它在 IE6 中工作？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-15T07:38:58.253

您的表单中可能有一个`<input name="submit" />`地方，它会覆盖 IE 中表单的“提交”功能。

**编辑：**

我已经在其他一些浏览器中进行了测试。所有主流浏览器的最新版本似乎都受到此问题的影响。

*   IE - 所有版本
*   火狐 4+
*   Chrome 至少从版本 12 开始
*   Opera 至少从版本 11 开始

底线：永远不要将您的输入命名为“提交”或表单元素的任何其他默认属性或方法（例如“动作”或“重置”）。有关完整概述，请参阅[MDC](https://developer.mozilla.org/en/DOM/HTMLFormElement)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-18T14:57:33.153

当我即将通过 A 元素提交表单时，我遇到了类似的问题。我已将 href 属性设置为“javascript:;” 让主 jQuery 脚本处理实际提交，但它在 IE6 中不起作用。

jQuery主脚本：

```
$(".submitLink").click(function(){
$(this).parent()[0].submit();
$(this).addClass("loading");
}); 
```

我的解决方案是将 href 属性从“javascript:;”更改为 到 ”＃”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T07:28:32.067

你可以试试`$("#formid").trigger("submit")`，虽然我怀疑它会给你一个不同的结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-14T13:34:10.917

我最近遇到了一个类似的问题，我在 ASP.NET 服务器表单中创建了一个“伪表单”（所以我不能使用另一个表单标签），我想将它发布到另一个域而无需编写执行远程发布的服务器端代码。简单的答案 - 即时创建表单并提交。在良好的浏览器中工作...

经过一些试验和磨难，我意识到除非正在提交的表单已添加到 DOM，否则 IE 将无法按预期工作（真是令人惊讶）。所以，这是我的解决方案。我希望它对你们中的一些人有所帮助。请注意，我所有的输入和我的提交都在同一个容器中。“.post-to”是带有 URL 的隐藏输入。

```
$(".post-form").click(function(ev) {

    var postto = $(this).siblings(".post-to").val();    
    var form = document.createElement("form")
    $(form).attr("id", "reg-form").attr("name", "reg-form").attr("action", postto).attr("method", "post").attr("enctype", "multipart/form-data");

    $(this).siblings("input:text").each(function() {
        $(form).append($(this).clone());
    });

    document.body.appendChild(form);
    form.submit();
    document.body.removeChild(form);

    return false;
}); 
```

最终，它是一种享受。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T02:19:00.107

不要忘记返回false；如果你在标签上

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-19T19:58:03.173

`button`在您的表单中添加一个`type="submit"`

[参考](http://api.jquery.com/submit/#comment-55074466)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-12-08T10:37:42.047

```
...

$('.bt_ok').bind('click', function() {
    $('#form_autosuggest').submit();
    return false;
});

... 
```

之后添加：`return false;`对于 IE6

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-12-13T15:53:17.323

只需添加一个

```
window.setTimeout(function(){
    $("#formid").submit();
}, 300); 
```

# spring - 在 ServletContext 中加载对象（应用程序范围）

> ID：445855
> 
> 赞同：4
> 
> 时间：2009-01-15T06:32:56.687
> 
> 标签：spring, tomcat, plugins, struts2, struts

我想在 Struts2 webapp（在 Tomcat 6 下运行）的某处放置两个小的常量对象（一个`TreeMap`和一个） ，以便可以通过 Application Scope 从任何 JSP 访问这些对象。`ArrayList``ServletContext`

在 Struts1 下，我会使用其中一个启动“ `plug-in`s”（定义在 中`struts-config.xml`）。是否有与 Struts2 实现相同结果的等效方法？

或者（甚至更好），因为我的 webapp 使用在 Tomcat 中配置的 Spring 和 Spring's `ContextLoaderListener`，我可以依赖 Spring 来代替吗？例如，通过创建一个声明一些适当的“ `ApplicationAware`”接口的 bean...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:00:04.343

采取 2：在您的一个 spring bean 上实现 ServletContextAware 接口，并对上下文进行必要的修改。如有必要，请在 @PostConstruct 注释方法中执行此操作，因为这样您的 bean 在您更新 servletcontext 时就已完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T14:36:35.270

采取 3：您可能想查看[Spring Servlet 上下文范围](http://www.springbyexample.org/examples/custom-servlet-context-scope-module.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T06:57:46.230

如果这是我的应用程序（并且我们使用的是相当相似的架构），我会在我的 struts2 控制器类的基类中注入一个单例 spring bean，但我所有的 jsp 都有控制器并且都共享一个公共基类。

# oracle - ORACLE 行号

> ID：445856
> 
> 赞同：1
> 
> 时间：2009-01-15T06:32:59.637
> 
> 标签：oracle

我有一个`ID_EMPLOYEE_MASTER`用字段调用的员工表

```
EMP_CODE,
EMP_NAME,
EMP_JOIN_DATE,
EMP_STATUS,
EMP_BASIC,
EMP_ACCOUNT,
EMP_BANK 
```

我想查询所有状态为“P”的员工，即..PRESENT，他们的银行账户，即.. EMP_ACCOUNT，他们的基本，即EMP_BASIC，他们的姓名，即..EMP_NAME，然后给出一个序列号，然后是他们的`EMP_CODE`

我尝试了以下查询：

```
SELECT'01'||TO_CHAR(SYSDATE,'MMYY')||RPAD(EMP_ACCOUNT,16,'0')||
LPAD(EMP_BASIC,18,'0')||RPAD(EMP_NAME,32,'0')||LPAD(ROWNUM,4,'0')||
LPAD(EMP_CODE,10,'0') AS " " 
FROM ID_EMPLOYEE_MASTER WHERE EMP_STATUS='P' 
                        AND EMP_BANK='BM_CB' ORDER BY EMP_JOIN_DATE,ROWNUM 
```

我希望显示的格式为：

```
0115090023194700084016000000000002112000DILIPKUMARAG00000000000000000000010000000029 
```

问题是结果无法正确显示。

如果 Dilip Kumar 是最年长的员工，他的名字会首先显示，但他的序列号不会显示为，`0001`而是显示为`0013`。

另一个问题是薪水，我希望它显示在 OMANI RIALS 和一些 BAISA 中，即小数点后 3 位，但我无法显示 DAISA，只显示 RIALS。我得到的输出如下：

```
0115090023194700084016000000000000002112DILIPKUMARAG0000000000000000000130000000029 
```

请帮我...：（

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T21:35:32.060

在应用 ORDER BY 之前，在检索行时分配 ROWNUM。所以它们不会按照你想要的顺序出现。您可以使用几种不同的技巧。

(1) 嵌套查询

```
SELECT <your long expression here> FROM (
  SELECT *
    FROM id_employee_master
  ORDER BY emp_join_date
  ) 
```

外部查询中的 ROWNUM 将被分配为从内部查询返回的行，因此它们将按照您想要的顺序出现。这是一种黑客行为。

(2) 解析函数

代替 ROWNUM，使用`ROW_NUMBER() OVER ( ORDER BY emp_join_date )`. 这将根据该明确的顺序分配数字。这是一种更清洁的方式。

关于另一个问题……我猜 EMP_BASIC 是薪水？如果它是 NUMBER 类型，那么您将其隐式转换为字符串，并且默认格式将删除无关紧要的数字。您想使用显式 TO_CHAR 调用来指定所需的确切格式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-08T20:48:14.467

rownum 是错误的.. 记住：

```
SELECT * 
FROM  
( SELECT mt.mydata
  FROM myTable mt
  WHERE mt.myId = xxx
  ORDER BY mt.myDate DESC
) 
WHERE ROWNUM <= 1; --for example if you want last row 
```

# php - 如何更正 Zend_Uri_Exception (YouTube API with PHP Zend Gdata)

> ID：445864
> 
> 赞同：1
> 
> 时间：2009-01-15T06:39:51.760
> 
> 标签：php, zend-framework, youtube-api, gdata-api, google-data-api

我正在使用 Zend Gdata 从 PHP 脚本与 YouTube API 交互。实际上我的工作正常，突然我收到一个关于“Zend_Uri_Exception”的致命错误，消息“提供的 URI 无效”。我该如何纠正异常？

代码：

```
require_once 'Zend/Loader.php';
Zend_Loader::loadClass('Zend_Gdata_YouTube');

$yt = new Zend_Gdata_YouTube();
$query = $yt->newVideoQuery();
$query->setOrderBy($this->data['ItemVideo']['sort']);
$query->setRacy('include');
$query->setCategory($this->data['ItemVideo']['q']);

try {
  $videoFeed = $yt->getVideoFeed($query);
} catch(Exception $e) {
  echo var_dump($query) . '<p></p>' . $e;
} 
```

输出：

```
object(Zend_Gdata_YouTube_VideoQuery)#79 (4) { ["_params:protected"]
=>  array(2) { ["orderby"]=>  string(9) "relevance" ["racy"]=>  string
(7) "include" } ["_defaultFeedUri:protected"]=>  NULL
["_url:protected"]=>  NULL ["_category:protected"]=>  string(14)
"charlie bit me" }

exception 'Zend_Uri_Exception' with message 'Invalid URI supplied' in /
web/php/balistik_list_app/app/vendors/ZendGdata/library/Zend/Uri/
Http.php:136 Stack trace: #0 /web/php/balistik_list_app/app/vendors/
ZendGdata/library/Zend/Uri.php(123): Zend_Uri_Http->__construct
('http', '//gdata.youtube...') #1 /web/php/balistik_list_app/app/
vendors/ZendGdata/library/Zend/Http/Client.php(257): Zend_Uri::factory
('http://gdata.yo...') #2 /web/php/balistik_list_app/app/vendors/
ZendGdata/library/Zend/Gdata/App.php(476): Zend_Http_Client->setUri
('http://gdata.yo...') #3 /web/php/balistik_list_app/app/vendors/
ZendGdata/library/Zend/Gdata.php(203): Zend_Gdata_App-
>performHttpRequest('GET', 'http://gdata.yo...', Array, NULL, NULL,

NULL) #4 /web/php/balistik_list_app/app/vendors/ZendGdata/library/Zend/
Gdata/App.php(610): Zend_Gdata->performHttpRequest('GET', 'http://
gdata.yo...') #5 /web/php/balistik_list_app/app/vendors/ZendGdata/
library/Zend/Gdata/App.php(541): Zend_Gdata_App->get('http://
gdata.yo...') #6 /web/php/balistik_list_app/app/vendors/ZendGdata/
library/Zend/Gdata/App.php(147): Zend_Gdata_App->importUrl('http://
gdata.yo...', 'Zend_Gdata_YouT...') #7 /web/php/balistik_list_app/app/
vendors/ZendGdata/library/Zend/Gdata.php(148): Zend_Gdata_App->getFeed
('http://gdata.yo...', 'Zend_Gdata_YouT...') #8 /web/php/
balistik_list_app/app/vendors/ZendGdata/library/Zend/Gdata/YouTube.php
(171): Zend_Gdata->getFeed('http://gdata.yo...', 'Zend_Gdata_YouT...')
#9 /web/php/balistik_list_app/app/controllers/
item_videos_controller.php(35): Zend_Gdata_YouTube->getVideoFeed(Object
(Zend_Gdata_YouTube_VideoQuery)) #10 /web/php/balistik_list_app/cake/
libs/object.php(114): ItemVideosController->search() #11 /web/php/
balistik_list_app/cake/dispatcher.php(259): Object->dispatchMethod
('search', Array) #12 /web/php/balistik_list_app/cake/dispatcher.php
(213): Dispatcher->_invoke(Object(ItemVideosController), Array) #13 /
web/php/balistik_list_app/app/webroot/index.php(90): Dispatcher-
>dispatch(NULL) #14 {main} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T09:56:52.500

我刚刚尝试了 [链接文本](http://gdata.youtube.com/demo/index.html)

而且似乎在版本 2 中没有授权 racy

```
<errors xmlns='http://schemas.google.com/g/2005'>
<error>
<domain>GData</domain>
<code>InvalidRequestUriException</code>
<internalReason>Parameter racy not available in version 2</internalReason>  
</error>
</errors> 
```

请求

```
GET /feeds/api/videos?q=Comedy%2Bdog&safeSearch=none&racy=include
GData-Version: 2

X-GData-Client: ytapi-google-jsdemo

Content-Type: application/atom+xml

Cache-Control: no-cache 
```

尝试删除 racy 控件或设置其他版本

```
GET /feeds/api/videos?q=Comedy%2Bdog&search=none&racy=include 
```

这个正在工作

# delphi - 如何获取 Delphi 编译包（.dcp 文件）中的单元列表

> ID：445866
> 
> 赞同：4
> 
> 时间：2009-01-15T06:43:37.493
> 
> 标签：delphi, packages, delphi-7

有没有办法列出 Delphi 编译包中的单元/类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T08:07:25.607

您看过 Delphi 7 附带的 TDUMP 实用程序吗？bpl 只是一个花哨的 DLL，因此您可以列出其导出的函数：

例如

"C:\Program Files\Borland\Delphi7\Bin\TDUMP.EXE" AFWRTL_RD7.bpl

Turbo Dump 版本 5.0.16.12 版权所有 (c) 1988, 2000 Inprise Corporation

```
 Display of File AFWRTL_RD7.BPL 
```

. . .

从 AFWRTL_RD7.bpl 导出

91 个导出名称，91 个导出地址。序数基数为 1。

...

```
000046B4   31 000A __fastcall Fgint::Base2StringToFGInt(System::AnsiString, Fgint::TFGInt&) 
```

...

如果查看导出的函数，函数的名称似乎以单元或依赖包名称为前缀，例如 Fgint::Base2StringToFGInt 是单元 Fgint.pas 中的函数 Base2StringToFGInt。

或者，查看 Windows 资源工具包附带的depends.exe 实用程序。这提供了一个 GUI 来查看 DLL（或 BPL）的内容。

看

[http://www.microsoft.com/downloads/details.aspx?FamilyID=49ae8576-9bb9-4126-9761-ba8011fabf38&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=49ae8576-9bb9-4126-9761-ba8011fabf38&displaylang=en)

更多细节。

文斯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T09:27:49.003

您可以创建一个新包，将 .dcp 添加到它的 requires 子句中，向其中添加一个新单元并在 uses 子句中使用代码完成 - 它会显示所有必需包中的所有可用单元。如果您的 .dcp 是唯一需要的包，并且您将其设置为按范围排序显示（在下拉列表中右键单击），那么 .dcp 中的单位应该位于顶部。

我不确定这是否已经在 Delphi 7 中有效。它适用于德尔福 2007。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T07:26:37.953

除了询问开发人员或阅读文档之外，答案是否定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T09:33:01.753

[JCL](http://sourceforge.net/projects/jcl/) “使用专家”可以在 IDE 中显示很多内容。

# delphi - 想要将文件读取到 TStringList

> ID：445871
> 
> 赞同：2
> 
> 时间：2009-01-15T06:46:56.817
> 
> 标签：delphi, file-io, tstringlist

是的，我想将一个简单的日志文件读入 TStringList，这很容易通过 LoadFromFile 完成。但问题是该文件可能已经被另一个程序同时打开，因此可能会出现异常。我曾尝试使用：

```
FileMode := fmShareCompat; 
```

但它不会起作用。

我也尝试过使用：

```
fFilePath := fPathList[PathIndex] + '\' + FileData.Name;
AssignFile(vFile, fFilePath);
Reset(vFile, 1);  // Recordsize = 1

SetLength(vFileString, FileData.Size);
BlockRead(vFile, vFileString, FileData.Size);   
vCurrentFile.Text := vFileString; 
```

它会引发一个 EInOutError，并带有消息 I/O 错误 998。

有什么建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T06:54:02.293

尝试*LoadFromStream*并执行以下操作：

```
fileStream := TFileStream.Create(aFileName, fmShareDenyNone);
myTStringList.LoadFromStream(fileStream);
fileStream.Free(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T09:50:40.453

fmShareCompat 可能应该被标记为已弃用。你想要**fmShareDenyNone**（[正如 Drejc 所说](https://stackoverflow.com/questions/445871/want-to-read-a-file-to-a-tstringlist#445877)）

我相信 fmShareCompat 来自 16 个 DOS 天。在 Windows 上，它的处理方式与 fmShareExclusive 相同。当支持 Linux 时，它被视为与 fmShareDenyNone 相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T07:05:25.233

此外，try..except 和 try..finally 在这些时候是好朋友。将您的文件读取代码封装在这些类型的块中，并告诉用户出现的问题。

# emacs - 如何让 Emacs 鼠标滚动更慢更流畅？

> ID：445873
> 
> 赞同：51
> 
> 时间：2009-01-15T06:49:51.333
> 
> 标签：emacs, scroll, mouse

当我使用鼠标滚轮在 Emacs 中滚动时，它一次滚动 5 行，我认为这太过分了 - 我在哪里设置新值？

此外，当我用鼠标（滚轮或滚动条）在 Emacs 中滚动时，光标会跳到可见屏幕区域内 - 有没有办法覆盖该行为，使其保持在它所在的行上，即使它走出屏幕？换句话说，我不希望新键入的符号出现的位置因滚动而改变。

任何关于如何查看远程代码部分然后快速返回之前位置的替代建议也是受欢迎的。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-15T06:55:57.140

您可以控制变量中的数量`mouse-wheel-scroll-amount`（在 mwheel.el 中）。

编辑：例如 `(setq mouse-wheel-scroll-amount '(1 ((shift) . 1) ((control) . nil)))` ，一次将 1 行添加到您的 .emacs 中。

我的 .emacs 中也有`(setq mouse-wheel-progressive-speed nil)`我认为更好的行为。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T13:19:34.667

我使用[面包屑](http://breadcrumbemacs.sourceforge.net/index.html)在缓冲区或所有缓冲区周围留下痕迹。

放下面包屑，去看看你想要/需要的任何东西，然后跳回面包屑。这是我要做的事情，FWIW：

```
(global-set-key [(f6)] 'bc-set)
(global-set-key [(shift f6)] 'bc-list)
(global-set-key [(control f6)] 'bc-previous)
(global-set-key [(meta f6)] 'bc-next)
(global-set-key [(shift control f6)] 'bc-local-previous)
(global-set-key [(shift meta f6)] 'bc-local-next) 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-26T06:28:03.660

这是我的设置：

```
(setq mouse-wheel-scroll-amount '(0.07))
(setq mouse-wheel-progressive-speed nil)
(setq ring-bell-function '忽略)

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T07:25:28.063

在当前视图之外的某个地方不可能存在“点”；所有的点移动命令也会移动显示。我认为这是 emacs 所做的一个基本假设。

我认为您在最后一点中想要的 - 查看远程部分并返回 - 可以通过寄存器来完成：

这将保存您在寄存器 A 中的位置：

Cxr A

这将从寄存器 A 中恢复位置：

Cx rj A

如果你经常这样做，我建议将它们绑定到稍微不那么冗长的东西:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T14:50:43.967

您可以使用一些书签解决方案或寄存器，还可以使用内置标记和标记环 -

```
(default binding) 

C-Space to set mark (push a mark in mark ring)
C-u C-Space to pop a mark off the ring; repeat this a few more time should 
            get you where you like to be 
```

或者如果您没有突出显示区域或者您不介意看到突出显示，

```
C-x C-x (exchange-point-and-mark) switch between you current point and your previous mark. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T20:53:51.660

> 任何关于如何查看远程代码部分然后快速返回之前位置的替代建议也是受欢迎的。

[Bob Glickstein 的“Writing GNU Emacs Extensions”的](http://oreilly.com/catalog/9781565922617/)第 3 章构建了一个 unscroll 函数（返回到滚动命令堆栈中的指定位置）作为编程示例。

该代码[在线显示，](http://www.eecs.ucf.edu/~leavens/emacs/unscroll.el)但如果您使用它[，则报告与欧洲央行发生冲突。](http://mlblog.osdir.com/emacs.code-browser/2005-11/msg00000.shtml)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-02T18:03:19.973

使用易来易去的自动命名[***书签***](http://www.emacswiki.org/emacs/BookmarkPlus)[——Bookmark](http://www.emacswiki.org/emacs/BookmarkPlus#AutonamedBookmarks) + 。只需按一个键即可创建或删除——就像设置标记一样简单。它们可以是持久的或暂时的。如果您愿意（边缘或线条），它们可以自动突出显示。[](http://www.emacswiki.org/emacs/BookmarkPlus)

 *# macos - 在 OSX 上使用 Ant 将 webapp 远程部署到 Tomcat

> ID：445879
> 
> 赞同：1
> 
> 时间：2009-01-15T06:54:46.440
> 
> 标签：macos, web-applications, tomcat, ant, manager-app

我希望使用 catalina-ant.jar 中的 Tomcat 安装/部署任务将 webapp 部署到远程应用服务器。

[使用此处找到](http://209.85.173.132/search?q=cache:zKE-ov3_l-kJ:www.asceticmonk.com/blog/%3Fp%3D388+installation+of+ant+on+osx&hl=en&ct=clnk&cd=1&gl=us)的说明安装 Ant 后，我​​的 ant 文件夹配置为：

```
/usr/local/ant 
```

我的“Ant Home”也已通过 Eclipse 设置为该目录。我将 catalina-ant.jar 复制到我的 ant/lib 文件夹中。

我的 build.xml 包含以下内容：

```
...
<path id="catalina-ant-classpath">
  <fileset dir="${ant.home}/lib">
    <include name="catalina-ant.jar"/>
  </fileset>
</path>
<taskdef name="install" classname="org.apache.catalina.ant.InstallTask">
  <classpath refid="catalina-ant-classpath"/>
</taskdef>
... 
```

然而我的构建失败并出现以下错误：

```
build.xml:83: taskdef class org.apache.catalina.ant.InstallTask cannot be found 
```

我的 /usr/local/ant 目录是否存在权限问题？有没有更好的地方放 catalina-ant.jar？

编辑：奇怪的是，如果我将 jar 放在其他地方（例如，在我的用户文件夹内的目录中）并在我的 build.xml 中更改它的路径，它就可以工作。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T07:11:18.780

Eclipse 看不到 catalina-ant.jar。如果它在您的 ANT_HOME/lib 目录中，请检查 Eclipse 使用的是什么 ANT_HOME。

转到您的 Eclipse Preferences > Ant > Runtime 并查看 classpath 选项卡以查看 eclipse 是否可以看到 jar。有时如果您的 ANT_HOME 指向正确的位置，您可能仍需要在添加 jar 后重新启动 Eclipse 以便 Eclipse 看到它。

另外，我会测试您是否也可以从命令行运行您的构建，这可能会帮助您缩小问题范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T07:19:12.850

使用 -debug 标志运行 ant 也有帮助。它会列出你需要的所有找到的 jars 和类路径信息。

# c# - 生成自定义对象的列表<>

> ID：445883
> 
> 赞同：2
> 
> 时间：2009-01-15T06:57:32.067
> 
> 标签：c#, .net

我有以下要求

我有一个员工类：

```
public class Employee
{
    public int ID{get; set;}
    public string EmpFName{get; set;}
    public string EmpLName { get; set; }
} 
```

我想在创造价值时做这样的事情

```
var Emp = new List<Employee>[]{

                new Employee{id=1, EmpFname="matt", EmpLName="Cook"},
                new Employee{id=2, EmpFname="mary", EmpLname="John"}

            }); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T07:00:37.973

你已经快到了。此代码应该可以工作：

```
var emp = new List<Employee>
{
    new Employee{ID=1, EmpFname="matt", EmpLName="Cook"},
    new Employee{ID=2, EmpFname="mary", EmpLname="John"}
}; 
```

这里涉及的特性是隐式类型、对象初始化器和集合初始化器。所有这些都包含在 C# in Depth 第 8 章中，可从[Manning C# in Depth 站点](http://manning.com/skeet)免费下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T07:01:49.390

嗯。我认为它与 linq 无关，但您可以这样做：

```
var emps = new List<Employee>() {
  new Employee() { ID = 1, EmpFname="matt", EmpLName="Cook" }
}; 
```

# c# - 在 .NET MVC 中，我们可以将 CSS 保存在 Views 文件夹中吗？

> ID：445891
> 
> 赞同：3
> 
> 时间：2009-01-15T07:02:34.710
> 
> 标签：c#, asp.net-mvc

我正在使用 ASP.Net MVC。当我将 CSS 保存在 Views 文件夹中时，它不会加载 CSS。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:22:57.007

我喜欢每个 View 文件夹都有一个 css 文件，仅用于组织。这样我就可以在同一个目录中使用 html 和相应的 css，而不是拥有一个大的 css 文件。

这是我的做法：

首先制作了一个“样式控制器”，它将所有文件合并为一个：

```
public class StyleController : Controller
{
    [OutputCache(Duration = 86400, VaryByParam = "none")]
    public ActionResult Index()
    {
        var cssFiles = Directory.GetFiles(Server.MapPath("~/Views"), "*.css", 
                                          SearchOption.AllDirectories);
        var sb = new StringBuilder();

        foreach (var cssFile in cssFiles)
        {
            sb.Append(System.IO.File.ReadAllText(cssFile));
            sb.Append(Environment.NewLine);
        }

        return Content(sb.ToString(), "text/css");
    }
} 
```

然后在布局文件中添加对样式文件的引用

```
@Styles.Render("~/Style") 
```

这非常适合开发，但在生产中，我宁愿将 StyleController 的输出提取到物理文件中并使用捆绑功能（更改“@Styles.Render”行）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T08:12:39.887

如果您检查 Views\Web.Config，您会注意到所有 HTTP 请求都将传递给 System.Web.HttpNotFoundHandler。

您当然可以通过修改它来“破解”它（当然强烈反对！），但您可能遇到的另一个问题是您的“CSS”请求**可能会**被映射到控制器操作（取决于您的路线和Web 服务器设置），因此您还必须修改 global.asax.cs 上的路由集合

总而言之：为了让你到达你想要的地方，你必须（大量）修改 ASP.NET MVC 的工作/结构化方式，这可能不是一个好主意......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-03T19:21:48.850

通过将静态文件处理程序添加到 Views 文件夹中的 web.config 来允许提供这些文件：

```
 <system.webServer>
    <handlers>
      <remove name="BlockViewHandler"/>
      <add name="JsHandler" path="*.js" verb="*" type="System.Web.StaticFileHandler" />
      <add name="MapHandler" path="*.js.map" verb="*" type="System.Web.StaticFileHandler" />
      <add name="TsHandler" path="*.ts" verb="*" type="System.Web.StaticFileHandler" />
      <add name="CssHandler" path="*.css" verb="*" type="System.Web.StaticFileHandler" />
      <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
    </handlers>
  </system.webServer> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T10:00:09.123

Thank you so much for the answers. The problem is the web.config inside the Views folder is blocking the CSS from loading. Now the issue has been solved.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T07:47:26.803

更新：不，它看起来像被阻止（404）；看来，你得把它们放在外面。这是有道理的，类似于 App_Code 阻塞等。

（原始答案）您如何在视图/母版页中引用 css？您使用的是“/views/foo.css”、“~/views/foo.css”、“foo.css”还是什么？回想一下，浏览器会认为它位于“Some/Invented/Path”中，因此您的 css 分辨率需要与之相关——“~/”（app-root）是最简单的。

我现在只是看看...

# windows - 创建大于桌面的窗口（显示分辨率）

> ID：445893
> 
> 赞同：9
> 
> 时间：2009-01-15T07:04:30.883
> 
> 标签：windows, resize, window, desktop

我需要以编程方式和最好手动调整大于屏幕分辨率或桌面大小的窗口大小。

由于 MS-Windows XP/Vista 不允许窗口大小大于屏幕，有没有人有任何想法来解决这个限制？

我试图在笔记本电脑上制作平移效果，以便给我更多的工作空间。具有较小 LCD 尺寸的旧笔记本电脑确实具有这样的功能。

看到这个： [http ://www.experts-exchange.com/OS/Microsoft_Operating_Systems/Windows/98/Q_21832063.html](http://www.experts-exchange.com/OS/Microsoft_Operating_Systems/Windows/98/Q_21832063.html)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-11-09T03:27:39.563

如果您想调整不属于您的窗口的大小（并且不使用任何类型的挂钩），您可以使用设置了 SWP_NOSENDCHANGING (0x0400) 标志的 Windows SetWindowPos API：

```
BOOL WINAPI SetWindowPos(
__in      HWND hWnd,
__in_opt  HWND hWndInsertAfter,
__in      int X,
__in      int Y,
__in      int cx,
__in      int cy,
__in      UINT uFlags // ** SWP_NOSENDCHANGING must be passed here **
); 
```

这将阻止发送 WM_WINDOWPOSCHANGING 消息，这是触发 WM_GETMINMAXINFO 限制的原因。窗口的任何其他大小都会导致限制将窗口捕捉回桌面限制大小，因为将发送消息并强制执行窗口大小。

## 窗口大小调整器 (C#)

以下是一个小示例程序，它将记事本的大小调整为 6000x6000（将字符串“Untitled - Notepad”更改为要调整大小的窗口的标题，或者从命令行参数中获取窗口名称和所需大小）

```
namespace Example
{
 class Program
 {
  [DllImport("USER32.DLL")]
  public static extern IntPtr FindWindow(String className, String windowName);

  [DllImport("USER32.DLL", SetLastError = true)]
  public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int left, int top, int width, int height, uint flags);

  static void Main(string[] args)
  {
   var TOP = new IntPtr(0);
   uint SHOWWINDOW = 0x0040, NOCOPYBITS = 0x0100, NOSENDCHANGING = 0x0400;
   var hwnd = FindWindow(null, "Untitled - Notepad");
   SetWindowPos(hwnd, TOP, 0, 0, 6000, 6000, NOCOPYBITS | NOSENDCHANGING | SHOWWINDOW);
  }
 }
} 
```

# 限制和警告

这种方法通常是有效的，但有许多限制可能会阻止窗口调整大小或以任何有用的方式调整大小。

## 安全

从 Windows Vista 开始，Microsoft 已针对窗口消息实施了越来越高的安全性。可执行文件只能与处于或低于其自身安全上下文的窗口进行交互。例如，要调整“计算机管理”窗口的大小（始终以提升的方式运行），该程序也必须以提升的方式运行。

## 固定窗口和布局逻辑

窗口大小可能由程序*被动*或*主动*强制执行。具有强制大小的窗口被动地设置初始大小，并且简单地不向用户展示调整窗口大小的能力（例如，没有大小控制控件）。这些窗口通常可以通过发送所描述的消息来调整大小，但是由于缺少布局逻辑，除了额外的空客户区之外，*不会*显示任何其他内容。

具有*主动*强制执行功能的 Windows 通过捕获诸如 WM_SIZE 之类的 Windows 消息或更复杂的布局逻辑来监视大小。这些窗口可能会*接受*消息，但会在它们自己的代码中限制或限制最终大小。

在任何一种情况下，具有固定大小的 Windows 通常都缺乏任何布局逻辑来利用更大的大小，因此，即使您*可以*强制这样做，调整它们的大小也不会带来任何好处。

## WPF

WPF 中的`Window`类有一个`HwndSource`处理发送到 WPF 窗口的窗口消息。私有方法`LayoutFilterMessage`捕获`WM_SYSCOMMAND`、`WM_SIZING`、`WM_WINDOWPOSCHANGING`和`WM_SIZE`消息。在这种情况下，`WM_SIZE`消息然后由私有处理`Process_WM_SIZE`，实际上，绕过`NOSENDCHANGING`标志并更改`RenderSize`WPF 客户区的标志。这是使旧版 Win32 消息适应 WPF 事件的整个过程的一部分。

最终结果是调整了 Win32*主机*窗口的大小（除非将 SizeToContent 设置为 SizeToContent.WidthAndHeight），但 WPF*呈现区域*被锁定到桌面区域，就好像没有设置 NOSENDCHANGING 标志一样。当上面的代码示例针对 WPF 应用程序运行时，您可以从任务栏中看到 Aero Peek 中的 6000x6000 窗口或 Windows-Tab 切换器中的窗口预览，但您也可以看到 WPF 内容和布局逻辑被剪辑到桌面区域。这样，WPF 窗口就像主动执行的窗口，但不是强制执行*特定的大小*，而是强制执行特定的*最大值*（对于 RenderArea）并且不考虑`WM_WINDOWPOSCHANGING`消息。

如果它是您*自己的应用程序并且您在**Windows 窗体*窗口中托管 WPF （通过`ElementHost`），您可以调整窗口大小，并且 WPF 内容将遵循大于桌面的 Windows 窗体窗口。

## 其他框架

其他框架（例如 GTK 和 Qt）可能会或可能不会强制执行大小行为和限制，并且可能有各种解决方法来克服这些限制。任何给定的程序都可以忽略、重写或绕过窗口消息，并且框架可以在整个应用程序类中强制执行它，例如上面的 WPF。

有关 SetWindowPos API 的更多信息：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/ms633545(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633545(v=vs.85).aspx)

`Process_WM_SIZE`方法的参考来源`HwndSource`：

[http://referencesource.microsoft.com/#PresentationCore/Core/CSharp/System/Windows/Interop/HwndSource.cs,da4aa32ad121c1b9,references](http://referencesource.microsoft.com/#PresentationCore/Core/CSharp/System/Windows/Interop/HwndSource.cs,da4aa32ad121c1b9,references)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-25T14:32:16.157

C# 中的这段代码可以满足您的要求。窗口比桌面宽得多。

```
 protected override void WndProc(ref Message m) {
        if (m.ToString().Contains("GETMINMAXINFO")) {
            //Hent data
            MINMAXINFO obj = (MINMAXINFO)Marshal.PtrToStructure(m.LParam, typeof(MINMAXINFO));
            //Endre
            if (obj.ptMaxSize.X > 0) {
                obj.ptMaxSize.X = 60000;
                obj.ptMaxSize.Y = 60000;
                obj.ptMaxTrackSize.X = 60000;
                obj.ptMaxTrackSize.Y = 60000;
                //Oppdater
                Marshal.StructureToPtr(obj, m.LParam, true);
            }
        }
        if (m.ToString().Contains("WINDOWPOSCHANGING")) {
            //Hent data
            WINDOWPOS obj = (WINDOWPOS)Marshal.PtrToStructure(m.LParam, typeof(WINDOWPOS));
            //Endre
            if (obj.cx > 0) {
                obj.cx = 8000;
                //Oppdater
                Marshal.StructureToPtr(obj, m.LParam, true);
            }
        }
        //Debug.WriteLine(m.ToString());
        base.WndProc(ref m);
    }

    [StructLayout(LayoutKind.Sequential)]
    internal struct WINDOWPOS {
        internal IntPtr hwnd;
        internal IntPtr hWndInsertAfter;
        internal int x;
        internal int y;
        internal int cx;
        internal int cy;
        internal uint flags;
    }

    [StructLayout(LayoutKind.Sequential)]
    internal struct MINMAXINFO {
        internal POINT ptReserverd;
        internal POINT ptMaxSize;
        internal POINT ptMaxPosition;
        internal POINT ptMinTrackSize;
        internal POINT ptMaxTrackSize;
    }
    [StructLayout(LayoutKind.Sequential)]
    internal struct POINT {
        internal int X;
        internal int Y;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-07T06:02:13.477

您可以在 WinProc(); 中执行类似以下代码的操作；

```
case WM_GETMINMAXINFO:
    {
        LPMINMAXINFO lpmmi = (LPMINMAXINFO)lParam; 
        GetWindowRect(GetDesktopWindow(), &actualDesktop);
        lpmmi->ptMaxTrackSize.x = 3000;// set the value that you really need.
        lpmmi->ptMaxTrackSize.y = 3000;// set the value that you really need.
    }
    break; 
```

应用程序可以使用此消息来覆盖窗口的默认最大化大小和位置，或者其默认的最小或最大跟踪大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-05T22:01:53.520

窗口大小似乎取决于桌面大小，而不是屏幕分辨率；但是桌面符合分辨率。诀窍可能是更改桌面大小或从那里开始。

不久前，一位名叫 Robert Bresner（[他的网站](http://www.nearestexit.com/)）的开发人员制作了一款名为 sDesk（[可从此处下载](http://web.archive.org/web/20080703132508/http://www.nearestexit.com/users/~wawb/rcal/download.php?sdesk.zip)）的产品，该产品将 Windows 扩展到了屏幕分辨率之外。

> **什么是 SDesk？**SDesk 不是多桌面程序。它是一个程序，可以创建一个超出显示器可见区域的巨大桌面。根据 Windows 桌面设置的定义，一次只能看到 SDesk 的一部分。

[SDesk 软件](http://web.archive.org/web/20080703132508/http://www.nearestexit.com/sdesk/)的原始主页存档在此处Internet 上没有当前页面（我可以找到），但此存档版本是通过缓存大量 Internet的*Way Back Machine访问的。*

SDesk 产品是免费软件。虽然没有包含源代码。您可以访问他的联系页面（也可以在存档版本中找到），询问是否有可用的资源或是否可以为您的研究获取资源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-28T13:46:23.353

如果您有一个可以连接多个屏幕的视频卡，另一种解决方法是设置您的系统，就好像它使用两个相邻的屏幕一样。然后，您可以将窗口大小调整为两个屏幕的大小。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-06T21:14:36.100

仅列出推荐的屏幕分辨率。对于其他设置，单击选项卡`Advanced`上的按钮`Settings`，单击`Adapter tab`，然后单击`List all Modes`。选择所需的分辨率、颜色级别和刷新率。

我刚刚做了，在这里你可以在最后一点找到答案。

[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/display_change_screen_resolution.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/display_change_screen_resolution.mspx?mfr=true)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T00:18:46.677

ok, I did try use keystrokes to move, resize windows. But system will automatically move windows back to visible region of desktop in my XP. I also tried SetWindowPos API, and no helps. The best chance will be to write a Video driver, but it may need more study. The 360 desktop claims you can expand desktop horizontally. But actually it just pan the current desktop in a virtual wider space. Any windows inside still have the size limitation of no larger than your screen resolution.

Video driver set the screen resolution(yes, have to compatibile to lcd/crt screen capability), and Windows did limit window-size by this thresholds. I just want to work around in user space API.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-12T11:09:06.527

我需要将窗口的一部分从屏幕顶部推开，我终于能够使用这个 AutoHotKey 脚本来做到这一点：

```
SetTitleMatchMode, 2
WinTitle := "Visual Studio Code"

; --- WinMove version

; WinMove, %WinTitle%, , 0, -64, 1280, 1504

; -- DLL version

WinGet, id, , %WinTitle%
Result := DllCall("SetWindowPos", "uint", id, "uint", HWND_TOP, "Int", 0, "Int", -64, "Int", 1280, "Int", 1504, "UInt", 0x400) 
```

（我想通过完全隐藏标题栏和选项卡部分来最大化 VSCode 的编辑器区域，这在程序本身中是不可配置的。）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-15T07:45:11.877

对于需要 MSDN 的屏幕更友好的视图的特定情况，或者在任何其他网站（如 StackOverflow）上对屏幕空间的利用不佳的情况下，我建议使用像 IE7Pro 这样的工具将自定义样式表应用于页面(IE)、Greasemonkey (Firefox)、Stylish (Fireox) 或 Opera 中内置的样式表选择器。

# iis - 动态加载 HTTP 模块，可能使用 Unity？

> ID：445895
> 
> 赞同：2
> 
> 时间：2009-01-15T07:06:01.723
> 
> 标签：iis, dynamic, dependency-injection, httpmodule

有没有人看过任何关于如何为 IIS 动态加载 HTTP 模块的方法、文档或其他内容？

基本上我要做的是加载 HTTP 模块，我将它们称为 HTTPModuleA、HTTPModuleB 和 HTTPModuleC。但是，可以随时使用 HTTPModuleD、HTTPModuleE 或 HTTPModuleF 更改模块。我基本上想把它们放在配置文件中，但不想有引用或任何东西。我希望能够仅将它们放入特定路径（即程序集的 dll），为文件/路径设置配置文件条目，并让 Unity 或其他框架将它们拾取并加载它们。可能每 2-3 分钟扫描一次更改。

任何关于如何完成这项工作的想法都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T07:25:19.170

Unity 不是动态加载模块的方法。您可以查看 Microsoft 可扩展性框架来动态加载模块，我听说这很棒。

我个人建立了一个类似的系统，并使用了 CodeProject 上的一篇文章作为指导，但我现在找不到它。我确实找到了这个（类似的）并展示了如何使用比每 2 或 3 分钟轮询一次更好的文件观察器：http: [//www.codeproject.com/KB/cs/dynamicpluginmanager.aspx](http://www.codeproject.com/KB/cs/dynamicpluginmanager.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T03:48:25.433

您可以将程序集放在 /bin 目录中，并让 ASP.NET 加载模块，而无需在 Web 应用程序中引用程序集。

# xslt - xsl:if中unicode字符的比较

> ID：445898
> 
> 赞同：1
> 
> 时间：2009-01-15T07:06:49.677
> 
> 标签：xslt, unicode, arabic

我有这块 xslt if-else 案例，想知道是否有办法让我直接与 unicode 字符进行比较？

类似于下面显示的代码行？或者 xslt 是否有一些我可以用于此目的的内置功能？即把unicode改成html实体并通过那个方法比较？

当然，如果有更好的方法，请开火。谢谢。

```
<xsl:choose>
                        <xsl:when test="status">
                            <xsl:if test="status='تم المحاولة'">
                                <font color="#00CC00"><xsl:value-of select="status" /></font><br/>
                <!--a href="/Elearning_Platform/xfiles/reports/view_reports.modcgi?asm_lid={@lom_id}&amp;did={@dispatch_id}&amp;rm_student_id={@person_id}&amp;report_type=2">[View Results]</a-->
                            </xsl:if>
</xsl:when>
                        <xsl:otherwise>
                            &nbsp;
                        </xsl:otherwise>
                    </xsl:choose> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T07:23:15.027

如果源 XML 和 XSLT 都被声明为 UTF-8 编码，我相信这应该不是问题。如果您的解析器支持 EXSLT，您可以直接调用 url-decode(status) [这个资源](http://www.dpawson.co.uk/xsl/sect2/N3353.html#d4848e330)有一些示例 + 可以很好地阅读 XSLT 中的编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T18:33:15.110

**答案是肯定的**。

**更准确地说**，**[可以在 XML 文档中使用的任何字符都可以用作](http://www.w3.org/TR/1998/REC-xml-19980210#charsets)****[XPath 相等比较运算符](http://www.w3.org/TR/xpath#NT-EqualityExpr)**的参数的一部分。

# c# - 是否有一个库可以根据这样的元数据声明生成 UI>>？

> ID：445899
> 
> 赞同：4
> 
> 时间：2009-01-15T07:06:56.697
> 
> 标签：c#, java, user-interface, annotations, metaprogramming

您是否知道一个库，它允许我们通过声明应该生成 UI 来生成 UI？

我认为一定有人实现了一种机制，允许我们像这样转换代码：

```
class Main {
    @Command
    int add(int a, int b) {
        return a+b;
    }
} 
```

比如说，一个带有 2 个文本字段和一个按钮的对话框？还是进入网络表单？你有这个想法，对吧？

UI 的类型和语言无关紧要，如果它允许我们简单地说“这应该是一个命令”，而不需要那些散布在应用程序中的大量 XML 文件。

而且，顺便说一句，您如何看待这种元编程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T07:55:52.090

你看过[裸体物体](http://www.nakedobjects.org/home/index.shtml)吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T07:15:54.540

我已经数不清这些年来我见过多少次实现这种变化了。共同的主题是使用元数据注释/补充您的核心对象，并尝试从那里即时生成 UI。我看到的所有尝试总是以用户界面结束，即使是创建者也有问题。似乎没有多少元数据可以让这些 UI 变得更好。

我记得看到工作得体的唯一例外是键值编辑器，它允许您编辑一组固定键的值（这也适用于树结构）。

# apache-flex - 远程对象请求图像更改

> ID：445903
> 
> 赞同：0
> 
> 时间：2009-01-15T07:11:42.973
> 
> 标签：apache-flex

我正在使用带有 BlazeDS 的 Flex 来连接 J2EE AppServer。我可以将任何全局图像放置在任何全局位置，只要调用任何远程对象就会自动更改，并且只要响应从服务器返回，图像就会被设置为默认值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T18:39:27.250

我假设您想实现某种加载屏幕或界面小部件。（您知道可以在远程对象实例上设置 showBusyCursor 吗？）

但是，无法全局拦截远程对象上的方法调用。您需要通过以下任一方式解决此问题：

1.  创建 RemoteObject 的子类，在结果和故障事件上设置一些全局标志。
2.  在每个设置全局标志的远程对象调用上编写相同的结果和故障事件处理代码。

选项 1 更高级一些，但会为您节省选项 2 的样板代码。

# c++ - XML Schema 到 C++ 类

> ID：445905
> 
> 赞同：30
> 
> 时间：2009-01-15T07:14:31.563
> 
> 标签：c++, xml, qt, xsd, code-generation

我必须编写一个 C++ 应用程序（使用 GUI 的 Qt 框架），它可以编辑存储在由 xsd 模式文件描述的 xml 文件中的数据。是否有将 xsd 模式转换为 C++ 类的工具？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-15T08:28:23.303

在我看来，[CodeSynthesis](http://www.codesynthesis.com/products/xsd/)正是您正在寻找的。它是开源和 C++ 的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-23T13:21:34.197

请参阅Google[的 XmlPlus-xsd2cpp](http://code.google.com/p/xplus-xsd2cpp/)：

> XmlPlus xsd2cpp 通过 W3C XML-Schema 提供“简单易用”的 C++ XML 数据绑定。

XmlPlus 的使用受[GNU 宽通用公共许可证的保护](http://www.gnu.org/licenses/lgpl.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-22T06:23:04.620

[gSOAP Toolkit](http://www.cs.fsu.edu/~engelen/soap.html)也可以做到这一点！它是轻量级的，并且支持 C/C++。我已经成功地在要求非常严格的项目中使用了它。此外，它在 GPL2 下获得许可。

可移植性：gSOAP 支持大多数平台，包括嵌入式系统和小型操作系统（例如 WinCE、Symbian 和 PalmOS）。可移植性针对 Windows（98、XP、Vista）、Linux、Unix、Mac OS X、Solaris、HP-UX、AIX、FreeBSD、TRU64、Irix、QNX 和 VxWorks 进行了测试。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T07:40:51.450

[Altova XML Spy](http://www.altova.com/)可以从 XSD 生成 C++，它是商业的，但如果您想试用，可以免费试用 30 天。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-30T14:28:36.627

Objective Systems, Inc. [XBinder XML Schema Compiler](http://www.obj-sys.com/xbinder.shtml)（不仅适用于 C++）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-10-25T19:21:06.513

[Codalogic LMX](http://codalogic.com/lmx)也是一种选择。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T13:02:49.787

我认为有一个 Microsoft 工具可以做到这一点，称为[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.80).aspx)（但我自己没有尝试过）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-12T18:56:18.433

所有的发电机都非常糟糕。

XSD 描述了一个类层次结构，其中类包含子类，子类可能包含其他子类，您要做的就是以相同的方式表示它。

例如，如果这是您的架构：

```
<xs:element name="shipto">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="name" type="xs:string"/>
      <xs:element name="address" type="xs:string"/>
      <xs:element name="city" type="xs:string"/>
      <xs:element name="country" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

你想产生类似的东西：

```
class shipTo
{
  private:
    string name;
    string address;
    string city;
    string country;

  public:
    set_Name();
    get_Name();
    ...
} 
```

你不会找到它。我找到的最接近的东西是 xjc，它是用于 Java 的。

您会期望存在与此功能一样 BASIC 的东西，但我还没有找到它，是的，我使用了 Altova XML-Spy。我很惊讶有人会建议它作为代码生成器。它生成的代码非常糟糕。

我正在为我的项目编写一个 lex/bison 解析器来执行此操作，因为到目前为止我能够找到的所有工具都会产生相当糟糕的代码。Altova 有 30 天的试用期，如果您不相信我，请尝试一下。为我的 XSD 编写 lex/bison 解析器比使用 500 美元的专业代码包生成糟糕的类表示更容易。

我不敢相信人们会在 C++ 中使用 XML，因为它的工具很糟糕。

# fluent-nhibernate - 在 Fluent NHibernate 中映射复合键

> ID：445909
> 
> 赞同：41
> 
> 时间：2009-01-15T07:16:03.107
> 
> 标签：fluent-nhibernate

我是 Fluent NHibernate 的新手，一直无法弄清楚如何映射复合键。

我怎样才能做到这一点？我需要采取什么方法？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-15T08:55:54.153

有一个`CompositeId`方法。

```
public class EntityMap : ClassMap<Entity>
{
  public EntityMap()
  {
      CompositeId()
      .KeyProperty(x => x.Something)
      .KeyReference(x => x.SomethingElse);
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T12:49:11.653

如果这是你的第一堂课

```
public class EntityMap : ClassMap<Entity>
{
  public EntityMap()
  {
    UseCompositeId()
      .WithKeyProperty(x => x.Something)
      .WithReferenceProperty(x => x.SomethingElse);
  }
} 
```

这是第二个参考实体

```
public class SecondEntityMap : ClassMap<SecondEntity>
    {
      public SecondEntityMap()
      {
        Id(x => x.Id);

        ....

        References<Entity>(x => x.EntityProperty)
          .WithColumns("Something", "SomethingElse")
          .LazyLoad()
          .Cascade.None()
          .NotFound.Ignore()
          .FetchType.Join();

      }
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-06-30T16:42:37.383

要注意的另一件事是，您必须使用 CompositeId 覆盖实体的 Equals 和 GetHashCode 方法。给定接受的答案映射文件，您的实体将如下所示。

```
public class Entity
{
   public virtual int Something {get; set;}
   public virtual AnotherEntity SomethingElse {get; set;}

   public override bool Equals(object obj)
    {
        var other = obj as Entity;

        if (ReferenceEquals(null, other)) return false;
        if (ReferenceEquals(this, other)) return true;
        return other.SomethingElse == SomethingElse && other.Something == Something;
    }

    public override int GetHashCode()
    {
        unchecked
        {
            return (SomethingElse.GetHashCode()*397) ^ Something;
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T09:01:21.830

可能需要具有复合标识符的实体，映射到具有复合主键的表的实体，由许多列组成。组成这个主键的列通常是另一个表的外键。

```
public class UserMap : ClassMap<User>
{      
   public UserMap()
   {
        Table("User");

        Id(x => x.Id).Column("ID");

        CompositeId()
          .KeyProperty(x => x.Id, "ID")
          .KeyReference(x => x.User, "USER_ID");

        Map(x => x.Name).Column("NAME");               

        References(x => x.Company).Column("COMPANY_ID").ForeignKey("ID");
    }
} 
```

更多参考： http: [//www.codeproject.com/Tips/419780/NHibernate-mappings-for-Composite-Keys-with-associ](http://www.codeproject.com/Tips/419780/NHibernate-mappings-for-Composite-Keys-with-associ)

# regex - 从 glob 表达式创建正则表达式

> ID：445910
> 
> 赞同：24
> 
> 时间：2009-01-15T07:16:36.083
> 
> 标签：regex, search, glob

我编写了用正则表达式解析文本的程序。正则表达式应从用户处获取。我打算对用户输入使用 glob 语法，并在内部将 glob 字符串转换为正则表达式。例如：

```
"foo.? bar*" 
```

应转换为

```
"^.*foo\.\w\bar\w+.*" 
```

不知何故，我需要从字符串中转义所有有意义的字符，然后我需要替换 glob * 和 ? 具有适当正则表达式语法的字符。最方便的方法是什么？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-10-12T17:07:01.437

不需要不完整或不可靠的黑客攻击。为此，python 包含一个函数

```
>>> import fnmatch
>>> fnmatch.translate( '*.foo' )
'.*\\.foo$'
>>> fnmatch.translate( '[a-z]*.txt' )
'[a-z].*\\.txt$' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T09:47:16.547

I'm not sure I fully understand the requirements. If I assume the users want to find text "entries" where their search matches then I think this brute way would work as a start.

First escape everything regex-meaningful. Then use non-regex replaces for replacing the (now escaped) glob characters and build the regular expression. Like so in Python:

```
regexp = re.escape(search_string).replace(r'\?', '.').replace(r'\*', '.*?') 
```

For the search string in the question, this builds a regexp that looks like so (raw):

```
foo\..\ bar.*? 
```

Used in a Python snippet:

```
search = "foo.? bar*"
text1 = 'foo bar'
text2 = 'gazonk foo.c bar.m m.bar'

searcher = re.compile(re.escape(s).replace(r'\?', '.').replace(r'\*', '.*?'))

for text in (text1, text2):
  if searcher.search(text):
    print 'Match: "%s"' % text 
```

Produces:

```
Match: "gazonk foo.c bar.m m.bar" 
```

Note that if you examine the match object you can find out more about the match and use for highlighting or whatever.

Of course, there might be more to it, but it should be a start.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-14T16:48:04.507

jPaq 的 RegExp.fromWildExp 函数做了类似的事情。以下内容来自网站首页上的示例：

```
// Find a first substring that starts with a capital "C" and ends with a
// lower case "n".
alert("Where in the world is Carmen Sandiego?".findPattern("C*n"));

// Finds two words (first name and last name), flips their order, and places
// a comma between them.
alert("Christopher West".replacePattern("(<*>) (<*>)", "p", "$2, $1"));

// Finds the first number that is at least three numbers long.
alert("2 to the 64th is 18446744073709551616.".findPattern("#{3,}", "ol")); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T07:44:46.713

[Jakarta ORO](http://jakarta.apache.org/oro/)有一个[Java 实现](http://jakarta.apache.org/oro/api/org/apache/oro/text/GlobCompiler.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T08:16:17.150

我编写自己的函数，使用 c++ 和 boost::regex

```
std::string glob_to_regex(std::string val)
{
    boost::trim(val);
    const char* expression = "(\\*)|(\\?)|([[:blank:]])|(\\.|\\+|\\^|\\$|\\[|\\]|\\(|\\)|\\{|\\}|\\\\)";
    const char* format = "(?1\\\\w+)(?2\\.)(?3\\\\s*)(?4\\\\$&)";
    std::stringstream final;
    final << "^.*";
    std::ostream_iterator<char, char> oi(final);
    boost::regex re;
    re.assign(expression);
    boost::regex_replace(oi, val.begin(), val.end(), re, format, boost::match_default | boost::format_all);
    final << ".*" << std::ends;
    return final.str();
} 
```

看起来一切正常

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-10T06:16:10.770

在 R`glob2rx`中，基本分布中包含以下函数：

[http://stat.ethz.ch/R-manual/R-devel/library/utils/html/glob2rx.html](http://stat.ethz.ch/R-manual/R-devel/library/utils/html/glob2rx.html)

# java - 使用基于 USB 的硬件解决方案的盗版保护

> ID：445911
> 
> 赞同：6
> 
> 时间：2009-01-15T07:18:08.063
> 
> 标签：java, authentication, hardware, protection, piracy-protection

我想通过使用一些基于 USB 的身份验证和密码管理解决方案来保护我的 Java 产品，如您可以在这里购买： [aladdin](http://www.aladdin.com) 这意味着您必须先连接一个带有特殊软件的 USB 记忆棒，然后才能启动您的应用程序。

我想在这里提供一些使用过此类硬件的用户的经验。

*   这和听起来一样安全吗？
*   将军：你会花多少钱来保护一个销售 100 倍的软件？

我将混淆我的 Java 代码并将一些用户特定的操作系统设置保存在位于硬盘某处的加密文件中。我不想限制用户进行在线注册，因为应用程序不需要互联网。

谢谢

**评论：** 我工作的公司现在使用[Wibu](http://www.wibu.com/uk.html)已经超过 5 年了。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-15T07:39:05.227

请不要。以代表其价值的价格出售您的软件，如果您必须**让诚实的人保持诚实**，请使用基本的关键方案，然后就这样吧。海盗总是会偷走它，而硬件加密狗只会让您的诚实客户感到悲伤。

此外，您构建的任何方案都将被逆向工程击败；如果你让使用你的软件变得痛苦，你会激励其他诚实的人打败它，或者在互联网上搜索破解。只需让保护比寻找裂缝更痛苦。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T08:26:47.893

尽管我对这个问题的看法是不要使用这样的盗版保护方案，但我可以给你一些建议，因为我们过去使用过这样的解决方案。特别是我们也使用了阿拉丁代币。

这个解决方案在安全性方面非常强大，因为它是您在系统上拥有或没有的东西。只要您的代码也是安全的，您就不能轻易地覆盖它。

不利的一面是，我们遇到了一个问题，导致我们放弃了硬件令牌解决方案。我们的应用程序是一个 Intranet Web 应用程序，（即在客户的本地 Intranet 中运行的 Web 应用程序，而不是托管解决方案）并且客户经常希望将我们的应用程序部署在刀片服务器甚至虚拟服务器上，而他们没有USB端口！

因此，在您选择这样的解决方案之前，请考虑这些因素。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-04T14:49:09.727

虽然我同意大多数其他答案，但在某些情况下硬件加密狗可以工作，并且适用于低容量、高价值的软件。流行的大容量软件总是会被破解，因此用昂贵的硬件系统惹恼您的客户毫无意义。

然而，任何人都不太可能费心去破解专门的小批量软件。然而，如果在另一台机器上安装很容易，许多客户可能会“忘记”购买另一个许可证，您就会失去宝贵的收入。加密狗保护在这里起作用，因为如果他们想同时运行两个副本，他们需要返回给您另一个加密狗。

我使用过 Aladdin 加密狗，但请注意有可用的软件模拟器，因此您还必须使用模拟器无法知道的东西对加密狗上的内存进行编程。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-08-04T14:46:15.233

只是为 SoftDeveloper 所说的添加证据。在低价值软件领域，保护适得其反。同样适用于高音量。

但是，我们的赚钱工具是每个用户许可售价为 10-25K 英镑的产品。我们绝大多数的消费者群体都非常谨慎地遵守规定——大公司——对于其中一些，我们已经销售了无限的不受保护的产品。

但是，我们过去有证据表明，当小型公司将其用于短期使用时，已经尝试破坏保护。当您每次事件损失 10 万英镑以上时，您至少必须阻止这种情况。

过去我们使用过 SuperPro，但该产品现在很弱且过时。

对于我们的最新产品，我们仍在评估中，但 Sentinel/Aladdin ( [http://www.safenet-inc.com/sentinelhasp/)、SecuTech](http://www.safenet-inc.com/sentinelhasp/) Unikey ( [http://www.esecutech.com/Software-Protection/UniKey-Family /UniKey-Drive/UniKey-Drive-Overview.html](http://www.esecutech.com/Software-Protection/UniKey-Family/UniKey-Drive/UniKey-Drive-Overview.html) ) 和 KeyLok Fortress ( [http://www.keylok.com](http://www.keylok.com) ) 是选定的子集。

我们正在做的一件事是允许模型具有极大的灵活性。这样，当营销人员提出下一个好主意时，我们就会做好准备。此外，确保极其稳健和信息丰富的许可证控制也至关重要。保护不应该意味着糟糕的客户体验（尽管通常可以！）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-15T08:43:14.990

我用过这样的产品，它们很痛苦。我个人根本不会在硬件方案或第 3 方保护方案上花钱。

不要被基于硬件的保护方案所诱惑。

唯一可以确定的是：

*   任何保护方案都会被破解。
*   你会惹恼合法客户
*   您将失去时间来支持与保护相关的问题
*   当合法客户由于保护而无法使用您的产品时，就会出现问题。
*   将您在保护方面花费的任何时间和资金用于改进产品或寻找更多客户是一项更好的投资。

保护的**黄金法则**是让您的客户无痛。硬件保护方案使您的客户的生活变得不方便，而让那些欺骗您的人更容易，这显然是不对的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T18:34:23.470

正如另一个略有不同的意见：

在一种情况下，我很乐意接受“加密狗”方法。MATLAB 有一个定价结构，如果你在一台固定机器上安装一些东西，它的成本是 X 美元。如果您想将它安装为一个并发许可证（网络上的许可证服务器）供一个人一次使用它，则成本为 4 倍。这对于很少使用的软件毫无意义。

购买超精密扭力扳手的商业模式应该不管有多少人想用，如果A人想用，B人已经在用，那么B人必须在A人之前用完。可以利用它。如果在多个用户共享的站点上使用物理令牌，我对遵循此模型的软件没有任何问题。这是一种比抬高并发许可证价格更公平的商业模式。实物代币方法对个人客户的吸引力可能较小，但如果你有一个价格可以控制的产品，那为什么不呢？

如果您没有这种程度的需求产品，我不会打扰。

你最好有一个处理丢失令牌的机制。（唉，我对此一无所知）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-13T23:04:32.957

正确使用的现代加密狗可以提供非常强大的保护，防止非法复制。来自 Wibu-Systems 的 CodeMeter 在数次公开破解竞赛中幸存下来（最近一次是在中国！），但没有获胜者。

原因是强加密：可执行文件完全使用 AES 128 位加密进行加密，用于解密的密钥生成只发生在加密狗中。由于密钥的半衰期很短，即使发现一个密钥（这将需要巨大的努力）也不能提供通用破解。

破解者是非常聪明的人，他们不会比破解软件更努力。如果软件保护不是您研发工作的主要重点，那么很容易在软件中留下漏洞。获得一个好的加密狗并仔细遵循制造商的保护建议是防止非法复制的最佳保险。

评估保护系统时的一些有用问题： 1\. 它是否支持您希望使用可执行文件定位的操作系统版本？2\. 加密狗和操作系统之间的通信是否加密？3\. 如果调试器正在运行，它可以检测到调试器并锁定许可证吗？4\. 是否使用智能卡芯片（用硬件工具比较难闻）？5\. 它使用单个密钥还是多个密钥？6\. 是否支持您想要的许可模式（按使用付费、按时间付费等）？7\. 是否有丰富的工具可让其易于使用？8\. 除了.exe文件之外，它还能保护其他类型的文件吗？9\. 他们的开发者支持有多好？是否已外包给其他国家？10\. 可以提供多少参考客户？

成本可以是每份 50 至 100 美元（或更少或更多；取决于一系列因素）。大多数信誉良好的供应商将通过一个简单的电话为您提供定价信息。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-04T15:04:59.430

首先，确保它不会适得其反。它在开发、测试、维护和客户支持方面的成本不可忽略。这种保护更合适的情况是当您的软件是软件时，几乎有一台专用于它的机器。

我知道最新的 wibu 产品具有相当好的鲁棒性，并且在实践中是防黑客的。（可能还存在其他类似的产品）。基本上，您的部分代码可以在密钥本身中加密，加密密钥一直在变化。他们举办了全球黑客竞赛，没有人能够使用未经授权的受保护软件版本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-27T10:27:17.797

对于盗版保护，我使用[OM-p](http://om-p.com "OM-p") 他们提供： - 免费盗版咨询 - 免费反盗版监控 - 和付费盗版删除

# windows - 如何清除 Perl 文件中的只读标志？

> ID：445912
> 
> 赞同：11
> 
> 时间：2009-01-15T07:18:15.817
> 
> 标签：windows, perl, readonly

我需要清除在 Windows 上运行的 Perl 程序中文件的只读标志。

我知道`system("attrib -r $filename")`会起作用，但我想知道 Perl 中是否没有内置选项可以做到这一点。`chmod 777, $filename`似乎不起作用。

谢谢，

分裂者

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-15T07:24:37.643

试试`chmod 0777, $filename`。您需要八进制表示法的权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T07:25:58.093

处理这类事情的最常见方法确实是使用`chmod`. 我能够使用以下方法成功删除只读标志：

```
chmod 0777, $filename; 
```

这是使用`chmod`八[进制表示法](http://en.wikipedia.org/wiki/Chmod#Octal_numbers)。

我在 Windows Vista 64 位上使用[Strawberry Perl 5.8.8 。](http://www.strawberryperl.com)

# c# - 深度 xml 序列化结构选项

> ID：445915
> 
> 赞同：5
> 
> 时间：2009-01-15T07:19:30.383
> 
> 标签：c#, xml-serialization

我有如下所示的类和结构。如果我像使用 xmlserializer 一样序列化类，我会得到：

<Test>
<TestNumber1>5</TestNumber1>
<InnerTest/>
</Test>

使 InnerTest 正确序列化（最好使用 xmlserializer）而不给 Number 属性设置器的最简单方法是什么？

谢谢，尼克

```
public class Test 
{ 
    private InnerTest innerTest; 
    private int testNumber; 

    public Test() 
    { 
        this.innerTest = new InnerTest(); 
        this.testNumber = 5; 
    } 

    public int TestNumber1 
    { 
        get { return this.testNumber; } 
        set { this.testNumber = value;} 
    } 

    public InnerTest InnerTest 
    { 
        get { return this.innerTest; } 
        set { this.innerTest = value;} 
    } 

} 

public struct InnerTest 
{ 
    private int number; 

    public InnerTest(int number) 
    { 
        this.number = number; 
    } 
    public int Number{get { return number; }} 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T07:40:08.923

正如 Jon Skeet 所说的那样，如果您不想对属性进行公共获取/设置，则需要`IXmlSerializable`与`XmlSerializer`无论如何您都无法访问（回答他的最后一部分-是的，某些结构`DateTime`确实在该序列化程序中具有明确的支持）。

根据您要实现的目标以及您使用的 .NET 版本，您可以考虑使用`DataContractSerializer`不需要公开的内容（例如，您可以将 a`DataMemberAttribute`放在私有字段或属性上带有公共 getter 和私有 setter）。这个序列化程序使您对 XML 格式的控制更少（实际上它非常严格——例如它甚至不支持属性！）但作为回报更快一些。

（长期以来，我一直渴望将两者结合起来的东西，即`XmlSerializer`具有序列化私人成员的能力的灵活性，`DataContractSerializer`但不幸的是，目前还没有。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T08:01:50.627

如果可能在这种情况下，我会使用`DataContractSerializer`（.NET 3.0），我会使用类似的东西：

```
[DataMember]
public int TestNumber1 
{ 
    get { return this.testNumber; } 
    set { this.testNumber = value;} 
} 

// note **not** a data-member
public InnerTest InnerTest 
{ 
    get { return this.innerTest; } 
    set { this.innerTest = value;} 
} 

[DataMember]
private int InnerTestValue
{
    get {return innerTest.Number;}
    set {innerTest = new InnerTest(value);}
} 
```

从而回避这个问题。你可以用 来做类似的事情`XmlSerializer`，但你需要`InnerTestValue`公开（虽然你可以用`[Browsable(false), EditorBrowsable(EditorBrowsableState.Never)]`- 来装饰它，但这并不理想）。

当然，如果你在结构上有多个值......更棘手。当然，您可以拥有多个 shim 属性，但这有点杂乱无章。基本上，[反]序列化和不可变对象（作为结构应该是）并不能很好地混合。

另一种选择是维护一个单独的 POCO 版本，该版本始终使用可变类，并在两者之间进行转换；再次，作为大对象模型的选择不是很有吸引力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:12:40.750

您绝对可以在您的对象上使用 XmlSerializer 并获得预期的结果：

```
Test test = new Test { TestNumber1 = 5 };

XmlSerializer xmlSer = new XmlSerializer(typeof(Test));
MemoryStream memStm = new MemoryStream();

xmlSer.Serialize(memStm, test); 
```

要验证结果，请再次将内存流读入字符串并在调试器中查看（或将其写入文件）：

```
StreamReader stmR = new StreamReader(memStm);
memStm.Position = 0;
string output = stmR.ReadToEnd(); 
```

如果您不做任何特别的事情，您正在序列化的类的所有公共属性都将呈现为 XML 元素......在您的结果 XML 中。

有很多属性，例如 [XmlIgnore] 以及更多可以根据需要进行调整的属性。

享受！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T07:29:31.580

我自己从来没有做过，但我怀疑你只需要实现[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)接口。

据我所知，这意味着你*必须*让你的结构可变——这很痛苦。理想情况下，XmlSerializer 应该识别您的类型是否具有具有特定签名的构造函数，但由于这似乎不是一个选项（据我所知），因此值得使用显式接口实现来实现接口，至少不鼓励用户自己直接使用它。

我想知道其他结构（例如 DateTime）是如何管理的……也许它们在 XmlSerializer 中有明确的支持。

# asp.net - 自定义收集器上的 GridView 分页

> ID：445916
> 
> 赞同：0
> 
> 时间：2009-01-15T07:22:59.193
> 
> 标签：asp.net, linq

我在与 a`GridView`绑定的 a上使用分页`List<Employee>`。但是这段代码不起作用。正确的方法是什么？我没有使用`ObjectDataSource`.

```
protected void myGV_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    List<Employee> p = ReturnEmplColl();
    GridView1.DataSource = p.Paging(1, e.NewPageIndex);
    GridView1.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T07:29:15.590

试试这个：

```
protected void myGV_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {

        List<Employee> p = ReturnEmplColl();
        GridView1.DataSource = p;
        GridView1.PageIndex = e.NewPageIndex;
        GridView1.DataBind();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T07:30:20.863

我通过这样的分页解决了它：

```
GridView1.PageIndex = e.NewPageIndex;
GridView1.DataSource = ReturnEmplColl(); 
```

# visual-studio-2008 - Visual Studio 2008 专业版

> ID：445938
> 
> 赞同：0
> 
> 时间：2009-01-15T07:37:28.163
> 
> 标签：visual-studio-2008

我目前使用带有 asp.net mvc 框架的 vs2008 进行 Web 开发。我缺少一个功能/配置：当我更改为另一个 .cs 文件时，我希望“类视图”自动向我显示活动 .cs 文件包含哪些方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T07:43:16.700

我不确定你是否可以这样设置，但我使用[Source Code Outliner Power Toy](http://www.codeplex.com/SourceCodeOutliner)。它使类视图可以自由探索，并添加一个带有可过滤、可搜索列表的窗口，向您显示活动的 .cs 文件包含的内容（不仅是方法，而且是所有内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T07:59:46.917

[这在 ReSharper 的文件结构](http://www.jetbrains.com/resharper/features/navigation_search.html#File_Structure)窗口中也可用。

# python - 在python中检索XMLHttpRequest参数

> ID：445942
> 
> 赞同：3
> 
> 时间：2009-01-15T07:38:42.500
> 
> 标签：python, ajax, cgi

客户端代码通过 ajax 请求向 python cgi 脚本提交对象（在 POST 请求正文中）或查询字符串（如果使用 GET 方法）。请注意，对象/查询字符串参数**不是**来自

```
<form> or <isindex>. 
```

如何使用标准库模块（例如 cgi）从服务器端 python 脚本中检索这些参数？

非常感谢

**编辑：**
*@codeape*：谢谢，但这不是只适用于提交的**表格**吗？就我而言，没有提交任何表单，只是一个异步请求。
使用您的脚本，如果未提交任何表单，则 len(f.keys()) 将返回 0！我可能可以将请求重新转换为表单提交，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T08:19:29.577

您使用 cgi.FieldStorage 类。示例 CGI 脚本：

```
#! /usr/bin/python

import cgi
from os import environ
import cgitb
cgitb.enable()

print "Content-type: text/plain"
print
print "REQUEST_METHOD:", environ["REQUEST_METHOD"]
print "Values:"
f = cgi.FieldStorage()
for k in f.keys():
    print "%s: %s" % (k, f.getfirst(k)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:40:54.580

codeape 已经回答了这个问题。仅作记录，请理解如何发出 HTTP 请求是完全正交的——服务器得到的是一个 HTTP 请求，句号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:59:49.847

*@codeape*，*@bruno desthuilliers*：

实际上， cgi.FieldStorage() 检索参数。我之前得到的输出显然是由于我在请求正文中将参数作为字符串（JSON.stringify() 对象）传递——而不是作为键值对。
谢谢

# sql - SQL 是数据库的程序集吗？

> ID：445950
> 
> 赞同：0
> 
> 时间：2009-01-15T07:41:26.317
> 
> 标签：sql, assembly

谈到 hibernate 和其他 ORM，ORM 的布道者谈论 SQL 就像数据库的汇编语言一样。

我认为很快就会断言这一点，但我想在不久的将来可能是真的，不确定。

**更新：**我所指的类比意味着SQL 是组装 ORM 是*C* / *Java* */* C *#*。当然，不可能有一个确切的类比。问题是在未来，如果使用更强大的计算机，开发人员将只使用*ORM*（或类似 ORM）而不是*SQL*。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T07:48:22.807

绝对不。

汇编语言是一种非常低级的语言，您可以在其中准确地指示处理器做什么，包括您要使用的寄存器等。

SQL 是一种非常高级的语言，您可以在其中描述所需内容的语义，然后查询优化器决定如何执行它，因此您甚至无法控制要执行的内容。它是一种极其强大和灵活的语言，任何 ORM 最多只能提供一个（相当小的）子集。

您会注意到 .NET 框架最近引入了 LINQ，这是一种将高级 SQL 类结构引入 C# 和 VB 等语言的方法。与其像汇编程序一样，很容易争论说 SQL 在比大多数主流编程语言更高的抽象级别上工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T08:37:44.923

多年来，我听到了很多关于关系和 OO 之间的阻抗不匹配的问题。

我的回答一直是，确实存在很大的阻抗不匹配——在天真的不灵活的“一切都是对象，只是一个对象”和极其灵活和复杂的“数据描述现实世界的事物；这些数据可以以不同的方式组合产生数学上可证明的结果的未知方法”。

OO 不是唯一的水果人。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T07:55:29.500

不，关系代数是数据库的“汇编代码”。

SQL 是“C 代码”，可读性强并且与“硬件”足够接近，只要您知道自己在做什么 :-) 就能够胜过所有其他高级语言。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T07:49:11.603

不，SQL 本身是一个高级抽象层，（大部分）与数据库无关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T21:23:05.797

SQL 与汇编语言有一些共同点：

*   直接用 SQL 编码使您有机会以非常紧凑的方式编写非常高效的代码。
*   有效地使用 SQL 是专业软件开发人员和大学课程都忽视的技能。
*   由于 SQL 非常紧凑，重构 SQL 往往令人厌烦且成本高昂。
*   有大量的软件开发人员“金字塔基础”，他们满怀热情地讨厌 SQL，更喜欢使用模仿他们首选的 OO 编程范式的抽象层，即使这些层限制了他们对 SQL 的有效使用并导致缓慢的重量级应用程序.

然而，与汇编不同的是，SQL 是一种高级的、独立于平台的语言。此外，汇编语言没有 ANSI/ISO 标准。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T07:44:34.920

不，不，不是。那些说从未编写过汇编代码的人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T08:45:20.507

如果您只进行在线事务处理，则只使用简单的 sql 语句。Hibernate 可以为您生成它们。

但是，如果您想做报告、数据分析或快速批量操作，您必须学习 SQL，并且您通常会使用供应商特定的 SQL 扩展。例如，当您使用供应商特定的 SQL 时，可以查询分层数据。

如果你想正确使用 SQL，你必须在集合中思考，而不是逐行的小语句。因此我说它与汇编程序完全相反。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-24T21:33:12.487

让我们比较一下编写并行化 SQL 和编写并行化汇编程序。

这是在 Oracle 中编写并行化 sql 语句的方式：

```
select /*+ parallel (e, 4)  */ deptno,count(*)
from employees e
group by deptno 
```

现在我希望我能告诉你如何编写并行汇编程序，但我强烈怀疑它是否像添加*/* + parallel (e,4) */*这样的东西那么容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T07:53:30.410

不要相信这种胡说八道。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-24T21:34:46.103

这永远不会发生。SQL 确实是一个 dsl，而汇编器绝对不是。将关系数据库映射到对象模型很有用，但不是 dbs 的唯一目的，即 orms 只是数据库用途的一小部分，因此 sql 将始终是处理 dbs 的首选方言！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-24T21:38:13.053

RPG是数据库的汇编语言。:-)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-15T07:47:39.703

不，但是您可能会说 SQL 是数据库的 C。它们既是~~过程性的又是命令性的，并且~~是面向数据的而不是面向对象的。和 C 一样，它更容易用高级语言对对象和功能进行建模，但最终 C 是性能测量的基准。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-01-24T21:11:31.563

在以下意义上，它是：ORM 提供了一个高级的、特定于域的 API，它发出 SQL 语句，就像高级语言创建特定于域的 API 并发出机器语言语句一样。

IE：

*   orm是SQL之上的一层
*   而 HLL 是组件之上的一层

但是，我并不是要暗示人们将停止使用 SQL 并更喜欢 ORM，就像人们停止使用汇编并更喜欢 HLL 一样。

# php - 模块化php应用程序开发

> ID：445951
> 
> 赞同：0
> 
> 时间：2009-01-15T07:41:43.537
> 
> 标签：php, web-applications

我们是一个计划开发 php 应用程序的开发人员小团队。（假设是 CRM 系统）

我们的主要目标是使其成为一个支持插件的应用程序，以便客户的开发人员可以编写插件来为系统添加新功能，而无需更改应用程序的核心代码。

这些变化可能包括： 1) 添加新功能：更有可能添加新页面并创建新的数据库表，并实施新的操作，例如添加/编辑/显示数据。

2）编辑现有功能（例如我们有一个用户列表，他们可能需要用户名作为超链接并打开一个带有用户信息的灯箱）

由于这是一个中型到大型的应用程序，我们需要仔细计划它。

目前我们的计划是编写核心应用程序结构并将需求实现为插件，这样每次客户端需要更改时，我们只需要升级特定的插件。

在我们开始之前，我只需要这里的大师给我们一些想法或链接。

最后一个问题是“如何构建一个支持插件的 PHP 应用程序？”</p>

谢谢大家...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T07:56:30.637

我想说尝试使用 OO 框架（zend 框架、cakephp、symphony）并创建一个配置（基于 xml）来告诉加载器应该加载哪个类），这意味着您可以在需要添加功能时重新定义类现有功能或加载新类。

例如，Magento 使用这种方法来允许插件。

但如果没有更多信息，这很难说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T08:00:51.470

编写结构良好、可重用的 OOP 代码 - 定义一个抽象插件类或接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T09:28:25.460

我赞同使用像 Symphony 这样的框架的观点。它为任何应用程序提供了更好的结构，为您提供更清洁和模块化的应用程序。我什至建议您使用另一种语言，但这超出了问题的范围:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T09:34:20.783

请检查以下网址
[http://ellislab.com/forums/viewthread/67697/](http://ellislab.com/forums/viewthread/67697/)

# json - Struts2 JSON 插件不能处理“惰性”数据

> ID：445956
> 
> 赞同：0
> 
> 时间：2009-01-15T07:47:13.370
> 
> 标签：json, jpa, struts2, lazy-loading, jsonplugin

我有一个延迟获取的具有 OneToOne 关系的实体：

```
@Entity
public class Person {
    @Id
    private Integer id;

    @Column(length=60)
    private String address;

    @OneToOne(fetch=FetchType.LAZY)
    @JoinColumn(name="idProvince")
    private Province province;
} 
```

这是我做的测试，尝试获取所有实体并将它们序列化为 JSON，使用 JSONPlugin 中的 JSONUtil 类[（](http://cwiki.apache.org/S2PLUGINS/json-plugin.html) Struts 2 的“官方”json 插件）：

```
 List<Person> people = personService.findAll();
    String result = JSONUtil.serialize(people);
    System.out.println(result); 
```

这是我得到的异常（当我将此插件与 Struts2 Action 和 @JSON 注释一起使用时，同样的异常）：

```
com.googlecode.jsonplugin.JSONException: java.lang.IllegalAccessException:
Class com.googlecode.jsonplugin.JSONWriter can not access a member of class 
org.postgresql.jdbc4.AbstractJdbc4Statement with modifiers "public"
    at com.googlecode.jsonplugin.JSONWriter.bean(JSONWriter.java:237)
    at com.googlecode.jsonplugin.JSONWriter.process(JSONWriter.java:159)
    at com.googlecode.jsonplugin.JSONWriter.value(JSONWriter.java:125)
    at com.googlecode.jsonplugin.JSONWriter.array(JSONWriter.java:407)
    at com.googlecode.jsonplugin.JSONWriter.process(JSONWriter.java:149)
    at com.googlecode.jsonplugin.JSONWriter.value(JSONWriter.java:125)
    at com.googlecode.jsonplugin.JSONWriter.write(JSONWriter.java:93)
    at com.googlecode.jsonplugin.JSONWriter.write(JSONWriter.java:76)
    at com.googlecode.jsonplugin.JSONUtil.serialize(JSONUtil.java:62)
    ... 
```

我正在使用 Hibernate，当我更改 fetch=FetchType.EAGER 时，上面的相同代码可以工作。我认为延迟加载会生成一个代理对象，这会导致它失败。

我的问题是：**是否可以序列化包含延迟加载属性的对象？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T18:27:16.550

我在使用 JSON-lib 时遇到了同样的问题，这确实是因为该对象是一个代理。

我发现[Google-Gson](http://code.google.com/p/google-gson/)更好地处理 Hibernate 对象的序列化，但当然它有自己的怪癖，所以你的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-21T08:52:12.533

从休眠中分离实体然后序列化它们。

# visual-studio - Visual Studio 插件：我应该在哪里存储工具窗口的最后大小和位置？

> ID：445965
> 
> 赞同：0
> 
> 时间：2009-01-15T07:52:57.180
> 
> 标签：visual-studio, visual-studio-2005, plugins, settings

我为 Visual Studio 2005 编写了一个小插件。它显示了您使用的最后一个命令的名称和快捷方式（非常适合学习很少使用的命令的快捷方式）。

我在一个窗口中显示此信息，我手动停靠在项目资源管理器和属性面板之间。

### 问题 ：

每次我启动 Visual Studio 时，这个窗口都会回到屏幕中间。它不记得它的最后位置。我将不得不以编程方式停靠它。

### 问题 ：

*   当用户关闭它时，我应该在哪里保存有关窗口大小和位置的信息？
*   在 Visual Studio 中是否已经存在用于此用途的某种商店，还是我必须自己找到一个（比如 - Windows 存储库）？

注意：我使用创建此窗口`Window2.CreateToolWindow2()`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T08:19:24.460

AFAIK 此信息存储在注册表中 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\ **Visual Studio 版本 - 8.0 或 9.0** \ToolWindows{YourToolWindowGuid}，不幸的是我不记得这个键的确切结构。

如果将窗口的 guid 添加到 ToolWindows 分支，MSVS 将自动保持窗口的状态。

# c# - 从代码更改 CSS 类

> ID：445967
> 
> 赞同：5
> 
> 时间：2009-01-15T07:54:42.217
> 
> 标签：c#, css, asp.net, webforms

在代码隐藏中设置很容易`CssClass`，但这会冒覆盖现有类的风险。

我需要设置某些元素，`ReadOnly = true;`并且我想应用一种样式作为无法更改该项目的视觉提示......足够简单：

```
.CssClass += " ReadOnlyStyle"; 
```

但有时我*还*需要更改相同的元素，`ReadOnly = false;`这意味着我需要删除我设置的 CSS 类，而不删除我可能分配的任何其他样式。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-16T12:43:14.343

我采用了 AnthonyWJones 的原始代码并对其进行了修改，以便它在任何情况下都能正常工作：

```
static class WebControlsExtensions
    {
        public static void AddCssClass(this WebControl control, string cssClass)
        {
            List<string> classes = control.CssClass.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).ToList();

            classes.Add(cssClass);

            control.CssClass = classes.ToDelimitedString(" ");
        }

        public static void RemoveCssClass(this WebControl control, string cssClass)
        {
            List<string> classes = control.CssClass.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).ToList();

            classes.Remove(cssClass);

            control.CssClass = classes.ToDelimitedString(" ");
        }
    }

    static class StringExtensions
    {
        public static string ToDelimitedString(this IEnumerable<string> list, string delimiter)
        {
            StringBuilder sb = new StringBuilder();
            foreach (string item in list)
            {
                if (sb.Length > 0)
                    sb.Append(delimiter);

                sb.Append(item);
            }

            return sb.ToString();
        }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-15T08:26:46.473

在 C# 3 中，您可以添加一些扩展方法。

```
 static class WebControlsExtensions
 {
     public static void AddCssClass (this WebControl control, string cssClass)
     {
         control.CssClass += " " + cssClass;
     }
     public static void RemoveCssClass (this WebControl control, string cssClass)
     {
         control.CssClass = control.CssClass.replace(" " + cssClass, "");
     }
 } 
```

用法：-

```
ctl.AddCssClass("ReadOnly");
ctl.RemoveCssClass("ReadOnly"); 
```

请注意，RemoveCssClass 旨在仅删除由 AddCssClass 添加的那些类，并且具有以下限制：添加 2 个附加类名称时，最短名称不应与最长名称的开头完全匹配。例如，如果您添加了“test”和“test2”，则无法在不破坏 CssClass 的情况下删除测试。这可以通过 RegEx 改进，因为我希望以上内容足以满足您的需求。

请注意，如果您没有 C#3，`this`则从第一个参数中删除关键字并以常规方式使用静态方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T20:35:03.637

相关...如果您只想根据条件切换类...

```
bool disable = true;      // this will vary (true/false) based on UI state

string newClass = disable ? "BtnGray" : "BtnPink";

string currentClass = disable ? "BtnPink" : "BtnGray";

myButton.CssClass = myButton.CssClass.Replace( currentClass, newClass ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T09:27:46.933

此版本会检查以确保在添加之前尚未添加给定的类。

```
public static void CssAddClass(this WebControl control, string className)
{
    var classNames = control.CssClass.Split
        (new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);

    if (classNames.Contains(className))
    {
        return;
    }

    control.CssClass = string.Concat
        (classNames.Select(name => name + " ").ToArray()) + className;
}

public static void CssRemoveClass(this WebControl control, string className)
{
    var classNames = from name in control.CssClass.
                         Split(new[] {' '}, StringSplitOptions.RemoveEmptyEntries)
                     where name != className
                     select name + " ";

    control.CssClass = string.Concat(classNames.ToArray()).TrimEnd();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-18T19:47:43.147

我为 pre-C#3 制作了一个版本：

```
 public static class WebControlsExtensions
        {
            public static void AddCssClass(WebControl control, string cssClass)
            {
                string[] cssClasses = control.CssClass.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                List<string> classes = new List<string>(cssClasses);

                if (!classes.Contains(cssClass)) {
                    classes.Add(cssClass);
                }

                control.CssClass = StringExtensions.ToDelimitedString(classes, " ");
            }

            public static void RemoveCssClass(WebControl control, string cssClass)
            {
                string[] cssClasses = control.CssClass.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                List<string> classes = new List<string>(cssClasses);

                bool removed = true;
                while (removed) {
                    removed = classes.Remove(cssClass);
                }

                control.CssClass = StringExtensions.ToDelimitedString(classes, " ");
            }
    }
    static class StringExtensions {
        public static string ToDelimitedString(List<string> list, string delimiter)
        {
            StringBuilder sb = new StringBuilder();
            foreach (string item in list) {
                if (sb.Length > 0)
                    sb.Append(delimiter);

                sb.Append(item);
            }

            return sb.ToString();
        }
    } 
```

像这样使用：

```
WebControlsExtensions.AddCssClass(ctl, "classname");
WebControlsExtensions.RemoveCssClass(ctl, "classname"); 
```

如果它还没有，这个只会添加一个类。它还将删除一个类的所有实例（如果由于某种原因，那里有多个）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T14:35:34.173

纯 .NET 2.0（没有扩展！没有 LINQ！没有 RegEx！没有不必要的 WebControl 类！）。这些方法非常普遍，不能仅用于 CSS 类。

```
public static string AddCssClass(string classContainer, string className)
    {
        if (string.IsNullOrEmpty(classContainer)) return className ?? string.Empty;
        if (string.IsNullOrEmpty(className)) return classContainer;

        var classNames = classContainer.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
        if (Array.Exists(classNames, delegate(string s) { return s.Equals(className); })) return classContainer;

        return classContainer + " " + className;
    }

    public static string RemoveCssClass(string classContainer, string className)
    {
        if (string.IsNullOrEmpty(classContainer)) return className ?? string.Empty;
        if (string.IsNullOrEmpty(className)) return classContainer;

        var classNames = classContainer.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
        int index = Array.FindIndex(classNames, delegate(string s) { return s.Equals(className); });
        if (index >= 0)
        {
            return string.Join(" ", classNames, 0, index) +
                (   index + 1 < classNames.Length ?
                    " " + string.Join(" ", classNames, index + 1, classNames.Length - index - 1)
                    :
                    string.Empty    );
        }

        return classContainer;
    }

    public static string ToggleCssClass(string classContainer, string className)
    {
        if (string.IsNullOrEmpty(classContainer)) return className ?? string.Empty;
        if (string.IsNullOrEmpty(className)) return classContainer;

        var classNames = classContainer.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);

        if (Array.Exists(classNames, delegate(string s) { return s.Equals(className); })) return RemoveCssClass(classContainer, className);

        return classContainer + " " + className;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T08:12:01.620

您可以制作自己的自定义类吗？从 ASP.NET 按钮派生并添加只读属性。某处......可能在 OnPreRender 中，您可以检查新属性并相应地设置（或不设置）CSSClass 属性。

# file - 外部文件中的 Log4Net 配置不起作用

> ID：445976
> 
> 赞同：94
> 
> 时间：2009-01-15T08:00:59.147
> 
> 标签：file, logging, configuration, log4net, external

我们正在使用 log4net 并希望在外部配置文件中指定它的配置（就像我们对其他部分所做的那样）。为此，我们将 App.config 中的 log4net 部分更改为：

```
...
<section name="log4net" 
     type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
...
<log4net configSource="Log.config" />
... 
```

在 Log.Config 文件（与 App.config 相同的目录）中，我们有：

```
<log4net>
  <appender name="General" type="log4net.Appender.FileAppender">
    <file value="myapp.log" />
    <layout type="log4net.Layout.SimpleLayout" />
  </appender>
  <root>
    <appender-ref ref="General" />
  </root>
</log4net> 
```

但是，当我们运行应用程序时，不会创建任何日志文件（也没有完成日志记录）。没有错误消息输出到控制台。

如果我们将 Log.config 文件的内容移回 App.config（替换上面的第一行代码），它会按预期工作。知道为什么它不能在外部文件中工作吗？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-01-15T08:11:00.203

您的`AssemblyInfo.cs`文件中是否具有以下属性：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "Log4Net.config", Watch = true)] 
```

并在每个需要日志记录功能的类的开头编写这样的代码：

```
private static readonly ILog log = 
LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); 
```

[我在这里](http://mitch-wheat.blogspot.com/2007/04/log4net-net-logging-tool.html)有一篇包含此信息和其他信息的博文。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-09-25T20:10:16.033

在这个问题上有一个[公开的缺陷。](https://issues.apache.org/jira/browse/LOG4NET-133)Log4Net 不支持配置元素的 configSource 属性。要使用纯粹的配置文件解决方案，您可以在 appSettings 中使用 log4net.Config 键。

第 1 步：包括正常的配置部分定义：

```
<configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
</configSections> 
```

第 2 步：在 appSettings 中使用神奇的 log4net.Config 键。

```
<appSettings>
      <add key="log4net.Config" value="log4net.simple.config" />
</appSettings> 
```

第 3 步：贡献一个补丁来修复 configSource 的处理。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-04-11T21:09:40.840

错过的步骤是

```
log4net.Config.XmlConfigurator.Configure(); 
```

这将导致使用 configSource。确保在调用 GetLogger() 之前调用它一次；

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2010-07-28T12:38:56.347

确保您的 log4net.config 文件设置有以下属性：

构建操作：内容

复制到输出目录：始终复制

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-02-25T13:46:18.370

无论是使用，

```
<configuration>
<configSections>
<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
</configSections>
<appSettings>
<add key="log4net.Config" value="Log4Net.config" />
</appSettings> 
```

要不就，

```
log4net.Config.XmlConfigurator.ConfigureAndWatch(new System.IO.FileInfo("Log4Net.config")); 
```

在这两种情况下，文件 Log4Net.config 都应该在输出目录中。您可以通过在解决方案资源管理器中设置 Log4Net.config 文件属性来执行此操作。构建操作 - 内容并复制到输出目录 - 始终复制

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-07T18:26:44.963

注意这个问题...

就我而言，一切都已正确配置。问题是我在 Visual Studio 2013 中使用 Web Deploy 将站点上传到[WinHost.com](http://winhost.com)并重置了服务器上的[ACL](http://www.iis.net/learn/get-started/planning-for-security/secure-content-in-iis-through-file-system-acls)。这反过来又撤销了对文件夹和文件的所有权限 - log4net 无法写入文件。

你可以在这里读更多关于它的内容：

[如何阻止 Web Deploy/MSBuild 弄乱服务器权限](http://blog.winhost.com/how-to-stop-web-deploymsbuild-from-skewing-server-permissions/)

我要求那里的支持团队重置 ACL，然后 log4net 开始吐出日志。:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-31T08:22:02.933

也可以为`log4net`. 将其插入 App.config 文件：

```
 <appSettings>
      <add key="log4net.Internal.Debug" value="true"/>
 </appSettings>
 <system.diagnostics>
      <trace autoflush="true">
      <listeners>
           <add
             name="textWriterTraceListener"
             type="System.Diagnostics.TextWriterTraceListener"
             initializeData="link\to\your\file.log" />
      </listeners>
      </trace>
 </system.diagnostics> 
```

并且您至少会收到错误消息，从中可以得出究竟出了什么问题。就我而言，我只是忘记设置`Copy to output directory`为`Copy Always`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-16T00:29:57.330

假设你有一个名为 log4net.config 的外部配置文件被复制到你的部署目录，你可以像这样配置它：

```
using System;
using System.Collections.Generic;
using System.Windows.Forms;
using System.Reflection;

using log4net;

namespace MyAppNamespace {
    static class Program {
        //declare it as static and public so all classes in the project can access it
        //like so: Program.log.Error("got an error");
        public static readonly log4net.ILog log = log4net.LogManager.GetLogger(typeof(Program));

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main() {
             //configure it to use external file
            log4net.Config.XmlConfigurator.Configure(new Uri(Application.StartupPath + "\\log4net.config"));
            //use it
            log.Debug("#############   STARING APPLICATION    #################");

            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new FormMain());
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-21T14:03:03.367

我有同样的问题，除了有

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net")] 
```

在正在运行的项目中，我在参考项目中也有以下行：

```
[assembly: log4net.Config.XmlConfigurator] 
```

当我在引用的项目中删除此行时，日志开始出现。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-10T13:16:39.057

1.  将以下内容添加到**AssemblyInfo.cs**

    [程序集：log4net.Config.XmlConfigurator(ConfigFile = "Log4Net.config")]

2.  确保 log4net.config 包含在项目中

3.  在**log4net.config的属性中**

将**CopyToOutputDirctory**标签更改为**CopyIfNewer**标签

4.  仔细检查日志级别级别`value="ALL"`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T08:21:07.313

@Mitch，原来有一个带有 [assembly:...] 声明的文件，但它没有 ConfigFile 属性。

一旦我添加它并将其指向 Log.config，它就开始工作了。我原以为它会像所有其他配置部分（即 AppSettings）一样工作，并且无需修改即可接受外部配置文件。

我们没有您提到的第二条语句，因为我们将其包装在全局静态日志提供程序中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-16T22:42:07.223

就我而言，我收到此错误消息：

```
log4net: config file [C:\........\bin\Debug\log4net.config] not found. 
```

**`log4net.config`**该文件位于 Visual Studio 2017 项目中，但是当我检查文件夹中的文件时，我**`bin\Debug`**找不到它。

我原来的装配设置是这样的：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.config", Watch = true)] 
```

经过一段时间的研究，我将其更改为以下内容并且可以正常工作：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = @"..\..\log4net.config", Watch = true)] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-27T07:05:22.680

还值得指出的是，在 Web 应用程序中，它查看的是根目录，而不是 bin 文件夹，因此请确保这是放置配置文件的位置。

# python - 有没有一种简单的方法可以使用本机 python 在 OSX 上发送 SCSI 直通

> ID：445980
> 
> 赞同：3
> 
> 时间：2009-01-15T08:06:12.257
> 
> 标签：python, macos

在 Windows 上，我可以使用 win32file.DeviceIOControl(..) 向设备发送 SCSI 直通，在 UN*XI 上可以使用 fnctl.ioctl(...) 来完成。

我一直在寻找 OSX 中的等价物，它允许我仅使用本机 python 发送 IOCTL 命令。

我会专门向硬盘驱动器发送命令，而不是 USB 设备。

有没有办法在不编写内核扩展或仅使用标准 python 库的任何其他代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T03:19:33.940

我最近看到[这篇博](http://wagerlabs.com/blog/2008/02/04/writing-a-mac-osx-usb-device-driver-that-implements-scsi-pass-through/)文谈到在 OS X 下使用 SCSI 直通。看起来它不像 Windows 或 Unix 那样简单

# c# - 将匿名类型转换为类

> ID：445984
> 
> 赞同：27
> 
> 时间：2009-01-15T08:10:03.183
> 
> 标签：c#, linq, anonymous-types

我在 List anBook 中有一个匿名类型：

```
var anBook=new []{

new {Code=10, Book ="Harry Potter"},
new {Code=11, Book="James Bond"}
}; 
```

是否可以将其转换为具有以下 clearBook 定义的列表：

```
public class ClearBook
{
  int Code;
  string Book; 
} 
```

通过使用直接转换，即不循环通过 anBook？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-15T08:27:11.807

好吧，你可以使用：

```
var list = anBook.Select(x => new ClearBook {
               Code = x.Code, Book = x.Book}).ToList(); 
```

但不，没有直接转换支持。显然，您需要添加访问器等（不要公开这些字段） - 我猜：

```
public int Code { get; set; }
public string Book { get; set; } 
```

当然，另一种选择是从您想要的数据开始：

```
var list = new List<ClearBook> {
    new ClearBook { Code=10, Book="Harry Potter" },
    new ClearBook { Code=11, Book="James Bond" }
}; 
```

您还可以做一些事情来使用反射映射数据（也许使用 an`Expression`来编译和缓存策略），但这可能不值得。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-15T08:41:42.560

正如 Marc 所说，它可以通过反射和表达式树来完成……幸运的是，[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中有一个类可以做到这一点。但是，更仔细地查看您的问题，听起来您想将此转换应用于集合（数组、列表或其他）*而不使用循环*。那是不可能的。您正在从一种类型转换为另一种类型 - 这不像您可以使用对匿名类型的引用，就好像它是对 ClearBook 的引用一样。

不过，要举例说明 PropertyCopy 类的工作原理，您只需要：

```
var books = anBook.Select(book => PropertyCopy<ClearBook>.CopyFrom(book))
                                 .ToList(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-12-31T13:39:07.340

这些扩展呢？简单地在你的匿名类型上调用 .ToNonAnonymousList ..

```
public static object ToNonAnonymousList<T>(this List<T> list, Type t)
    {
        //define system Type representing List of objects of T type:
        Type genericType = typeof (List<>).MakeGenericType(t);

        //create an object instance of defined type:
        object l = Activator.CreateInstance(genericType);

        //get method Add from from the list:
        MethodInfo addMethod = l.GetType().GetMethod("Add");

        //loop through the calling list:
        foreach (T item in list)
        {
            //convert each object of the list into T object by calling extension ToType<T>()
            //Add this object to newly created list:
            addMethod.Invoke(l, new[] {item.ToType(t)});
        }
        //return List of T objects:
        return l;
    }
    public static object ToType<T>(this object obj, T type)
    {
        //create instance of T type object:
        object tmp = Activator.CreateInstance(Type.GetType(type.ToString()));

        //loop through the properties of the object you want to covert:          
        foreach (PropertyInfo pi in obj.GetType().GetProperties())
        {
            try
            {
                //get the value of property and try to assign it to the property of T type object:
                tmp.GetType().GetProperty(pi.Name).SetValue(tmp, pi.GetValue(obj, null), null);
            }
            catch (Exception ex)
            {
                Logging.Log.Error(ex);
            }
        }
        //return the T type object:         
        return tmp;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-17T20:32:27.873

最简单的方法可能是使用某种类型的序列化方法。

像这样的东西

```
class ClearBook
{
   public int Code { get; set; }
   public string Book { get; set; }
}

ClearBook[] newList = JsonSerializer.Deserialize<ClearBook[]>(JsonSerializer.Serialize(anBook)); 
```

# .net - Linq to SQL：调用 SubmitChanges() 时的执行顺序

> ID：445985
> 
> 赞同：21
> 
> 时间：2009-01-15T08:10:21.217
> 
> 标签：.net, sql, linq, linq-to-sql

我有 2 个相关的数据库表，简化形式如下所示

```
Product(
  product_id,
  name
)

ProductSpecs(
  spec_id,
  product_id,
  name,
  value
) 
```

外键通过 product_id 字段设置，ProductSpecs 表对 (product_id, name) 对具有唯一约束。

现在在我的 ASP.NET MVC 应用程序中，当用户编辑产品规格并保存数据时，我会删除旧规格并将所有规格作为新规格插入。

为此，我首先调用 DataContext.DeleteAllOnSubmit() 并提供当前（旧）ProductSpecs 作为参数，然后将新规范添加到 Product.ProductSpecs 集合中。

然后我调用 DataContext.SubmitChanges() 并得到一个错误，表明我的唯一约束被违反了。

通过查看 DataContenxt.GetChangeText() 返回的 SQL 语句，我可以看到 INSERT 在 DELETE 之前执行（即使我在 Add 之前调用了 DeleteAllOnSubmit()）。

这种行为的原因是什么以及如何修复或解决它？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-31T01:00:58.507

是的，出于某种原因，Linq to SQL 将所有删除作为最后一件事执行。没有办法改变这一点。

或者也许有。我还没有查看代码生成 DataContext 以查看我们是否可以在那里覆盖某些内容。

您可以根据需要多次调用 SubmitChanges()。当我首先需要删除时，我的解决方法是标记我的删除，调用 SubmitChanges()，然后执行插入和更新，然后再次调用 SubmitChanges。

您可以将所有内容包装在 TransactionScope 中：

```
 var deletables =
        from toDelete in db.NamedValues
        where toDelete.Name == knownValue.Name
        select toDelete;

    using (var scope = new TransactionScope())
    {
        db.NamedValues.DeleteAllOnSubmit(deletables);
        db.SubmitChanges();

        db.NamedValues.InsertOnSubmit(knownValue);
        db.SubmitChanges();

        scope.Complete();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-18T11:45:34.417

不需要提前知道实体发生了哪些变化的更好的解决方案是使用 DataContext 的部分方法来拦截插入并首先推送删除。

```
public partial class YourDataContext
{
    List<EntityX> _deletedEntities = new List<EntityX>();

    partial void InsertEntityX(EntityX instance)
    {
        // Run deletes before inserts so that we don't run into any index violations
        var deletes =
            this.GetChangeSet().Deletes
            .Where(d => d.GetType().Equals(instance.GetType()))
            .Cast<EntityX>().ToList();

        var replaced = deletes.SingleOrDefault(d => d.UniqueKeyId == instance.UniqueKeyId);

        if (replaced != null)
        {
            DeleteEntityX(replaced);
            _deletedEntities.Add(replaced);
        }

        this.ExecuteDynamicInsert(instance);
    }

    partial void DeleteEntityX(EntityX instance)
    {
        if (_deletedEntities.Contains(instance))
        {
            _deletedEntities.Remove(instance);
            return;
        }

        this.ExecuteDynamicDelete(instance);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-29T10:12:02.477

我一直有同样的问题。我想出了一个技巧来解决它，这似乎对我有用：在调用 SubmitChanges() 之前，我为更改集中的每个可能有问题的删除手动执行一些 SQL：

```
foreach (object o in m_Db.GetChangeSet().Deletes)
{
    LibraryMember m = o as LibraryMember;

    if (m != null)
    {
        m_Db.ExecuteCommand("DELETE FROM LibraryMembers WHERE LibraryMemberId={0}", m.LibraryMemberId);
    }
}

m_Db.SubmitChanges() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-29T16:04:17.977

另一种解决方案是以正确的顺序将更改附加到另一个数据上下文。但是，此解决方案的缺点是，仍然从应用程序的其余部分引用的来自原始数据上下文的任何实体现在都将无效:(

我对此进行了尝试，为提交创建了第二个临时数据上下文。但我无法弄清楚如何让原始数据上下文进入干净状态。

这非常令人沮丧:(

```
public void Save()
{
    string connectionString = m_Db.Connection.ConnectionString;
    IList<object> deletes = m_Db.GetChangeSet().Deletes;
    IList<object> inserts = m_Db.GetChangeSet().Inserts;
    IList<object> updates = m_Db.GetChangeSet().Updates;

    m_Db.Dispose();
    m_Db = new MyDataContext(connectionString);

    Attach(m_Db, deletes);
    m_Db.SubmitChanges();
    Attach(m_Db, updates);
    m_Db.SubmitChanges();
    Attach(m_Db, inserts);
    m_Db.SubmitChanges();
}

void Attach(DataContext context, IList<object> items)
{
    foreach (object o in items)
    {
        context.GetTable(o.GetType()).Attach(Clone(o));
    }
}

object Clone(object o)
{
    object result = o.GetType().GetConstructor(Type.EmptyTypes).Invoke(null);
    foreach (PropertyInfo property in o.GetType().GetProperties())
    {
        if (property.PropertyType.IsValueType)
        {
            property.SetValue(result, property.GetValue(o, null), null);
        }
    }
    return result;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-31T15:59:09.290

与其只是扔掉所有的孩子并重新创建它们，不如考虑花更多的精力并分两步完成：添加尚未添加的项目并删除先前添加但不再需要的项目。例如，在 ThinqLinq.com 站点中，我有可以分配到类别的帖子。在编辑屏幕中，我提供了可以选择和取消选择的类别列表。当我收到包含所选类别列表的帖子时，我使用以下内容删除和更新相应的记录：

```
Dim selectedCats() As String = CType(ValueProvider("categories").RawValue, String())
For Each catId In selectedCats.Except(From cp In currentPost.CategoryPosts _
                                      Select id = cp.CategoryID.ToString())
   'Add new categories
   currentPost.CategoryPosts.Add(New CategoryPost With {.CategoryID = CInt(catId)})
Next

'Delete removed categories
dc.CategoryPosts.DeleteAllOnSubmit(From cp In currentPost.CategoryPosts _
                                   Where Not selectedCats.Contains(cp.CategoryID.ToString)) 
```

# gcc - 如何强制 gcc 预处理器保留空格？

> ID：445986
> 
> 赞同：6
> 
> 时间：2009-01-15T08:10:25.260
> 
> 标签：gcc, c-preprocessor, whitespace

对于代码：

```
int  i; 
```

gcc 预处理器输出：

```
int i; 
```

如何强制它保留空白？

我用： gcc -E somefile.c 命令调用预处理器。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T08:17:52.840

在传统模式下使用它，即[此处](http://gcc.gnu.org/onlinedocs/cpp/Traditional-Mode.html)所述的“-traditional-cpp” 。

# teamcity - 我需要包含来自 Gallio 的哪些 dll 才能让 TeamCity 运行测试

> ID：445987
> 
> 赞同：6
> 
> 时间：2009-01-15T08:10:52.997
> 
> 标签：teamcity, mbunit, gallio

我正在使用 Gallio 和 MbUnit 3，并且安装了 Team City 4。我只是将 Gallio 的整个 bin 目录放入 Subversion，因为我不知道我需要什么 dll。你知道我需要保留哪些，哪些不需要放入 SCM 中吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T06:58:52.627

大部分 bin 目录是必需的，但您可以删除不需要的插件和文件夹，例如 Visual Studio 支持、ReSharper 扩展、AutoCAD 集成等。

实现这一点的最简单方法是对您真正需要的几个 Gallio 组件（例如 MSBuild 和 TeamCity 位）执行基本的自定义安装。然后您可以将这些位复制到您的源代码树中。

OTOH，钻头很便宜，所以可能不值得担心太多......

# java - 为什么 Long.valueOf(0).equals(Integer.valueOf(0)) 为假？

> ID：445990
> 
> 赞同：17
> 
> 时间：2009-01-15T08:12:15.833
> 
> 标签：java, equals

这个问题是由[奇怪的 HashMap.put() 行为提示的](https://stackoverflow.com/questions/444638/strange-hashmap-put-behaviour#444757)

我想我理解为什么`Map<K,V>.put`需要 a`K`但`Map<K,V>.get`需要 a `Object`，似乎不这样做会破坏太多现有代码。

现在我们进入一个非常容易出错的场景：

```
java.util.HashMap<Long, String> m = new java.util.HashMap<Long, String>();
m.put(5L,"Five"); // compiler barfs on m.put(5, "Five")
m.contains(5); // no complains from compiler, but returns false 
```

`Long`如果值在`int`范围内并且值相等，则不能通过返回 true 来解决这个问题吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-15T08:28:23.710

这是 Long.java 的源代码

```
public boolean equals(Object obj) {
    if (obj instanceof Long) {
        return value == ((Long)obj).longValue();
    }
    return false;
} 
```

即它必须是 Long 类型才能相等。我认为主要区别在于：

```
long l = 42L
int i = 42;
l == i 
```

上面的示例是，对于原语，可能会隐式扩大 int 值，但是对于对象类型，没有从 Integer 隐式转换为 Long 的规则。

另请查看[Java Puzzlers](http://www.javapuzzlers.com/)，它有很多类似的示例。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T14:24:13.960

一般来说，虽然[equals()](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#equals(java.lang.Object))的约定中没有严格表示，但对象不应认为自己与不属于完全相同类的另一个对象相等（即使它是子类）。考虑对称属性 - 如果 a.equals(b) 为真，则 b.equals(a) 也必须为真。

让我们有两个对象，`foo`class`Super`和`bar`class `Sub`，它们 extends `Super`。现在考虑`equals()`Super 中的实现，特别是当它被称为`foo.equals(bar)`. Foo 只知道 bar 被强类型化为 an `Object`，因此为了获得准确的比较，它需要检查它是否是 Super 的实例，如果不是则返回 false。是的，所以这部分很好。它现在比较所有实例字段等（或任何实际的比较实现），并发现它们相等。到现在为止还挺好。

但是，根据合同，只有当它知道 bar.equals(foo) 也将返回 true 时，它​​才能返回 true。由于 bar 可以是 Super 的任何子类，因此尚不清楚 equals() 方法是否会被覆盖（如果可能会被覆盖）。因此，为了确保您的实现是正确的，您需要对称地编写它并确保两个对象是同一个类。

更根本的是，不同类的对象实际上不能被认为是相等的——因为在这种情况下，例如，只能将它们中的一个插入到 a`HashSet<Sub>`中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-15T08:24:08.727

是的，但这一切都取决于比较算法以及转换的距离。例如，当您尝试时，您希望发生什么`m.Contains("5")`？或者如果你传递一个以 5 作为第一个元素的数组？简单地说，它似乎是“如果类型不同，则键不同”。

然后取一个以 an`object`为 key 的集合。如果你`put`a `5L`，然后尝试得到`5`, `"5"`, ...，你想发生什么？如果你`put`a `5L`and a `5`and a `"5"`and 你想检查 a`5F`怎么办？

由于它是一个通用集合（或模板化，或任何您希望调用的集合），它必须检查并针对某些值类型进行一些特殊的比较。如果 K`int`则检查传递的对象是否为`long`, `short`, `float`, `double`, ..., 然后转换并比较。如果 K 是`float`然后检查传递的对象是否是...

你明白了。

但是，如果类型不匹配，另一种实现可能是抛出异常，我经常希望它这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T14:08:14.460

您的问题从表面上看似乎是合理的，但是如果不是它的合同，那么对于两种不同的类型返回 true 将违反 equals() 的一般约定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T14:22:20.203

Java 语言设计的一部分是对象永远不会隐式转换为其他类型，这与 C++ 不同。这是使 Java 成为一种小而简单的语言的一部分。C++ 复杂性的合理部分来自隐式转换及其与其他功能的交互。

此外，Java 在基元和对象之间有明显的二分法。这与其他语言不同，其他语言作为优化隐藏了这种差异。这意味着您不能期望 Long 和 Integer 的行为类似于 long 和 int。

可以编写库代码来隐藏这些差异，但这实际上会通过降低编程环境的一致性来造成伤害。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T04:53:23.113

所以你的代码应该是....

```
java.util.HashMap<Long, String> m = new java.util.HashMap<Long, String>();
m.put(5L, "Five"); // compiler barfs on m.put(5, "Five")
System.out.println(m.containsKey(5L)); // true 
```

您忘记了 java 正在自动装箱您的代码，因此上面的代码将等同于

```
java.util.HashMap<Long, String> m = new java.util.HashMap<Long, String>();
m.put(new Long(5L), "Five"); // compiler barfs on m.put(5, "Five")
System.out.println(m.containsKey(new Long(5))); // true
System.out.println(m.containsKey(new Long(5L))); // true 
```

所以你的问题的一部分是自动装箱。另一部分是您有其他海报所说的不同类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-29T17:55:26.530

其他答案充分解释了它失败的原因，但它们都没有解决如何编写围绕这个问题不太容易出错的代码。必须记住添加类型转换（没有编译器帮助），带 L 的后缀原语等等是不可接受的恕我直言。

当你有原语（以及在许多其他情况下）时，我强烈建议使用 GNU trove 集合库。例如，有一个 TLongLongHashMap 将事物内部存储为原始 long。结果，您永远不会以装箱/拆箱而告终，也永远不会以意外行为告终：

```
TLongLongHashMap map = new TLongLongHashMap();
map.put(1L, 45L);
map.containsKey(1); // returns true, 1 gets promoted to long from int by compiler
int x = map.get(1); // Helpful compiler error. x is not a long
int x = (int)map.get(1); // OK. cast reassures compiler that you know
long x = map.get(1); // Better. 
```

等等。无需正确输入类型，如果您做了一些愚蠢的事情（尝试将 long 存储在 int 中），编译器会给您一个错误（您可以更正或覆盖）。

自动转换的规则意味着比较也能正常工作：

```
if(map.get(1) == 45) // 1 promoted to long, 45 promoted to long...all is well 
```

作为奖励，内存开销和运行时性能要好得多。

# c# - 在查询中使用变量

> ID：445993
> 
> 赞同：2
> 
> 时间：2009-01-15T08:15:36.713
> 
> 标签：c#, database

我正在尝试使用过滤器的变量在 C# 中为我的数据集设置查询。例如，我试图只显示一个特定的帐号和他的余额，其中一个局部变量是用作该确切帐号的过滤器的帐号。我会以错误的方式解决这个问题吗？

我完全不是一个真正的程序员，我陷入了困境，并且已经使用 C# 编程指南和我有限的脑力（现在是空的）浏览了 :)

我还想使用带有事件处理程序的按钮来更改数据库信息，以向查询的单元格添加特定数量。我是因为缺乏硬编码知识而注定要失败，还是我真的可以做到这一点？

真诚地，试图编程的菜鸟工程师……或 Jev

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T08:48:41.983

当您设置数据集查询时，您可以执行以下操作；

```
SELECT Name FROM TableNames WHERE Name = @Variable 
```

查看[此链接以获取更多信息](http://www.codeproject.com/KB/database/sql_in_csharp.aspx)

可能也值得研究一下 SQL 注入攻击，[请单击此处](http://www.codeproject.com/KB/database/SqlInjectionAttacks.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T15:24:31.040

```
SqlCommand cmd = new sqlCommand("select * from table1 where column1 = @value", connection);
cmd.parameters.add(new SqlParameters("@value", "yourvalue"));
SqlDataReader dr = cmd.ExecuteReader();
while (dr.read())
{

   //code here!

} 
```

I Hope this will be usefull!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T15:32:32.927

曾几何时，我写过一篇关于为什么一定要在 SQL 语句中使用参数的小文章。（我写它是为了回应我看到许多人使用字符串连接来编写他们的查询的方式）。

你可以在这里找到它：http: [//fgheysels.blogspot.com/2005/12/avoiding-sql-injection-and-date.html](http://fgheysels.blogspot.com/2005/12/avoiding-sql-injection-and-date.html)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-15T08:44:36.127

您可以只使用该变量动态生成 SQL 查询，但要注意 SQL 注入 - 请务必确保您的变量可能不包含 SQL 语句。

您可以使用一个函数，像这样构建并返回您的 SQL 查询，并将过滤器的变量作为参数：

```
internal string BuildSQLQueryForAccount(int account)
{
    StringBuilder sb = new StringBuilder();
    sb.Append("SELECT * ");
    sb.Append("FROM Accounts ");
    sb.AppendFormat("WHERE AccountNumber = {0}", account);
    return sb.ToString();
} 
```

# iis - 在单独的域上托管网站子文件夹

> ID：445995
> 
> 赞同：2
> 
> 时间：2009-01-15T08:16:20.550
> 
> 标签：iis, networking, dns

我们有 2 个 Web 应用程序，我们希望将它们安装在不同的 IIS 服务器上。但是我们希望用户可以通过地址 www.test.com 访问一个，第二个通过 www.test.com/directory 访问

是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T08:34:38.517

不，这是不可能的，除非您有一个前端“反向代理”，它接收所有查询并将它们分派到相关服务器。

或者，您可以安排主服务器将所有对 www.example.com/directory 的查询重定向到（例如）www2.example.com/directory，尽管显然这会暴露该内容的第二个主机名和 URL。*************