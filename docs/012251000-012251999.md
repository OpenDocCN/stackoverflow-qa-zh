# StackOverflow 问答 12251000-12251999

# ruby-on-rails - Faye in jruby on rails

> ID：12251004
> 
> 赞同：2
> 
> 时间：2012-09-03T15:56:50.843
> 
> 标签：ruby-on-rails, ruby, jruby, real-time, faye

我搜索了很多，找不到任何资源说我可以将 Faye 与 jruby 一起使用。我发现[这个](https://groups.google.com/forum/?fromgroups=#!topic/faye-users/wvp_K38vTpo)说它不能很好地与 jruby 一起玩，但它真的很旧。我还发现[这](http://blog.jcoglan.com/2012/08/02/your-first-ruby-native-extension-java/)看起来他们已经实现了 Java 本机扩展以支持 jruby?? 有谁知道我是否可以在 Jruby on rails 项目中使用它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:23:15.133

来自 Faye 的创造者：

> 是的，服务器在 JRuby 上运行。客户端使用 WebSocket、EventSource、XMLHttpRequest、CORS 或 JSON-P，具体取决于用户浏览器、服务器和中间网络所支持的内容，并且与其他 Bayeux 服务器兼容。

# javascript - d3.js - 具有树形布局，如何更改 X 轴以在 D3 中使用时间刻度？

> ID：12251005
> 
> 赞同：5
> 
> 时间：2012-09-03T15:57:00.427
> 
> 标签：javascript, d3.js

我有这个树布局，需要它在 X 轴上使用时间刻度来将节点固定为日期。此外，我需要将根节点（它`is_root`在 JSON 数据中具有属性）保留在时间范围之外。 [这](http://codepen.io/anon/pen/kIJxo)是具有树形布局的 Codepen，我还将代码粘贴到此处：

```
var json = {
  "name": "Meet Treat",
  "is_root": true,
  "children": [
    {
      "name": "Meeting 1",
      "date": "Sun Jan 01 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 2",
          "date": "Tue Jan 10 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 5",
              "date": "Fri Feb 10 2012 00:00:00 GMT-0300 (ART)"
            }
          ]
        },
        {
          "name": "Meeting 4",
          "date": "Wed Feb 01 2012 00:00:00 GMT-0300 (ART)"
        }
      ]
    },
    {
      "name": "Meeting 3",
      "date": "Fri Jan 20 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 7",
          "date": "Thu Mar 01 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 8",
              "date": "Sat Mar 10 2012 00:00:00 GMT-0300 (ART)"
            }
          ]
        }
      ]
    },
    {
      "name": "Meeting 6",
      "date": "Mon Feb 20 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 9",
          "date": "Tue Mar 20 2012 00:00:00 GMT-0300 (ART)"
        },
        {
          "name": "Meeting 10",
          "date": "Sun Apr 01 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 13",
              "date": "Tue May 01 2012 00:00:00 GMT-0300 (ART)"
            }
          ]
        }
      ]
    },
    {
      "name": "Meeting 11",
      "date": "Tue Apr 10 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 14",
          "date": "Thu May 10 2012 00:00:00 GMT-0300 (ART)"
        },
        {
          "name": "Meeting 16",
          "date": "Fri Jun 01 2012 00:00:00 GMT-0300 (ART)"
        }
      ]
    },
    {
      "name": "Meeting 12",
      "date": "Fri Apr 20 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 15",
          "date": "Sun May 20 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 17",
              "date": "Sun Jun 10 2012 00:00:00 GMT-0300 (ART)"
            }
          ]
        },
        {
          "name": "Meeting 18",
          "date": "Wed Jun 20 2012 00:00:00 GMT-0300 (ART)"
        }
      ]
    },
    {
      "name": "Meeting 19",
      "date": "Sun Jul 01 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 21",
          "date": "Fri Jul 20 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 22",
              "date": "Wed Aug 01 2012 00:00:00 GMT-0300 (ART)",
              "children": [
                {
                  "name": "Meeting 23",
                  "date": "Fri Aug 10 2012 00:00:00 GMT-0300 (ART)"
                },
                {
                  "name": "Meeting 24",
                  "date": "Mon Aug 20 2012 00:00:00 GMT-0300 (ART)",
                  "children": [
                    {
                      "name": "Meeting 25",
                      "date": "Sat Sep 01 2012 00:00:00 GMT-0300 (ART)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Meeting 27",
          "date": "Thu Sep 20 2012 00:00:00 GMT-0300 (ART)"
        }
      ]
    },
    {
      "name": "Meeting 20",
      "date": "Tue Jul 10 2012 00:00:00 GMT-0300 (ART)",
      "children": [
        {
          "name": "Meeting 26",
          "date": "Mon Sep 10 2012 00:00:00 GMT-0300 (ART)",
          "children": [
            {
              "name": "Meeting 28",
              "date": "Mon Oct 01 2012 00:00:00 GMT-0300 (ART)"
            }
          ]
        },
        {
          "name": "Meeting 29",
          "date": "Wed Oct 10 2012 00:00:00 GMT-0300 (ART)"
        }
      ]
    }
  ]
};

var m = [20, 120, 20, 120],
    w = 1280 - m[1] - m[3],
    h = 1000 - m[0] - m[2],
    i = 0,
    root;

var tree = d3.layout.tree()
    .size([h, w]);

var diagonal = d3.svg.diagonal()
    .projection(function(d) { return [d.y, d.x]; });

var vis = d3.select("#graph").append("svg:svg")
    .attr("width", w + m[1] + m[3])
    .attr("height", h + m[0] + m[2])
    .append("svg:g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

root = json;
root.x0 = h / 2;
root.y0 = 0;
update(root);

function update(source) {
  var duration = d3.event && d3.event.altKey ? 5000 : 500;

  // Compute the new tree layout.
  var nodes = tree.nodes(root).reverse();

  // Normalize for fixed-depth.
  nodes.forEach(function(d) { d.y = d.depth * 180; });

  // Update the nodes…
  var node = vis.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent's previous position.
  var nodeEnter = node.enter().append("svg:g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      ;//.on("click", function(d) { toggle(d); update(d); });
  nodeEnter.append('image')
    .attr('xlink:href', 'http://www.uni-regensburg.de/Fakultaeten/phil_Fak_II/Psychologie/Psy_II/beautycheck/english/durchschnittsgesichter/m(01-32)_gr.jpg')
    .attr('width', 40)
    .attr('height', 40)
    .attr('x', -40)
    .attr('y', -20)
    .attr('clip-path', 'url(#clip1)');
  var clip1 = nodeEnter.append('clipPath')
    .attr('id', 'clip1')
    .attr('x', 0)
    .attr('y', 0);
  clip1.append('circle')
    .attr('r', 20)
    .attr('cx', -20);
  nodeEnter.append('image')
    .attr('xlink:href', 'http://0.tqn.com/d/hairremoval/1/0/e/-/-/-/eyebrow-classic.jpg')
    .attr('width', 40)
    .attr('height', 40)
    .attr('x', 0 )
    .attr('y', -20)
    .attr('clip-path', 'url(#clip2)');
  var clip2 = nodeEnter.append('clipPath')
    .attr('id', 'clip2')
    .attr('x', 0)
    .attr('y', 0);
  clip2.append('circle')
    .attr('r', 20)
    .attr('cx', 20);

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

  // Transition exiting nodes to the parent's new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  // Update the links…
  var link = vis.selectAll("path.link")
      .data(tree.links(nodes), function(d) { return d.target.id; });

  // Enter any new links at the parent's previous position.
  link.enter().insert("svg:path", "g")
      .attr("class", "link")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      })
    .transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent's new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });
} 
```

代码很乱，因为我正在玩一个例子。我尝试的是添加这样的时间尺度：

```
var timeScale = d3.time.scale().domain([new Date(2012, 0, 1), new Date(2012, 10, 1)]).range([100, w]); 
```

并替换这一行（#231）：

```
.attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; }); 
```

有了这个：

```
.attr("transform", function(d) { return "translate(" + timeScale(new Date(d.date)) + "," + d.x + ")"; }); 
```

或这个：

```
.attr("transform", function(d) { return "translate(" + d.y + "," + timeScale(new Date(d.date)) + ")"; }); 
```

但没有运气，他们松散了连贯的立场。另外，我不知道为什么在我所基于的示例中，它`translate`使用 Y 然后 X 值应用 CSS 转换，其中 CSS 规范`translate`规定值应该首先是 X，然后是 Y。有什么我失踪了`tree.nodes()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T15:54:46.350

我想出了怎么做。首先，我们需要创建一个时间尺度：

```
var timeScale = d3.time.scale().domain([new Date(2012, 0, 1), new Date(2012, 10, 1)]).range([100, w]); 
```

请注意，我已经设置了一个固定的日期范围。您可以构建一个逻辑来使用您的数据来获得它。

然后，更新节点的转换...

```
var nodeUpdate = node.transition()
  .duration(duration)
  .attr("transform", function(d) {
    var y = timeScale(new Date(d.date));
    if (d3.map(d).has('is_root')) {
      y = d.y;
    }
    return "translate(" + y + "," + d.x + ")";
  }); 
```

...以及链接的过渡：

```
link.transition()
  .duration(duration)
  .attr("d", function (d) {
    if (d3.map(d.source).has('is_root') && d.source.is_root) {
      return diagonal({ source: { x: d.source.x, y: d.source.y }, target: { x: d.target.x, y: timeScale(new Date(d.target.date)) } });
    }
    return diagonal({ source: { x: d.source.x, y: timeScale(new Date(d.source.date)) }, target: { x: d.target.x, y: timeScale(new Date(d.target.date)) } });
  }); 
```

最后，如果要在图表上显示日期刻度，可以添加以下代码，否则不需要。

```
var dates = [];
for (var i = 0; i < 12; i++) {
  for (var j = 1; j <= 20; j += 9) {
    (j == 19) && (j = 20);
    dates.push(new Date(2012, i, j));
  }
}

var axisGroup = vis.append('svg:g');
axisGroup.selectAll('.xTicks')
  .data(dates)
  .enter()
  .append('svg:line')
  .attr('x1', timeScale)
  .attr('y1', -5)
  .attr('x2', timeScale)
  .attr('y2', h + 5)
  .attr('stroke', 'lightgray')
  .attr('stroke-width', 1)
  .attr('class', 'xTicks');
axisGroup.selectAll('text.xAxisBottom')
  .data(dates)
  .enter()
  .append('svg:text')
  .text(function (datum) { return datum.getDate() + '/' + (datum.getMonth() + 1) + '/' + datum.getFullYear(); })
  .attr('x', timeScale)
  .attr('y', h + 20)
  .attr('text-anchor', 'middle')
  .attr('class', 'xAxisBottom'); 
```

它生成将被勾选的日期并添加相应的行和标签。

至于...

> 另外，我不知道为什么在我所基于的示例中，它使用 Y 然后 X 值应用 CSS 转换转换，其中转换的 CSS 规范规定值应该首先是 X，然后是 Y。有什么我从 tree.nodes() 中丢失了吗？

以这种方式为链接创建对角线：

```
var diagonal = d3.svg.diagonal().projection(function(d) { return [d.y, d.x]; }); 
```

使用投影方法反转 X 和 Y 轴，并为其提供一个返回反转轴的函数。这就是 Y 变为 X 的原因，反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:21:39.407

与其使用`Date`实例，不如从它们那里获取毫秒数，`getTime()`并使用这些数字来缩放轴。

`Date`使用毫秒，您可以轻松地在实例和轴 ( `new Date(millis)`<-> `d.getTime()`)之间来回映射

# node.js - 使用 node-neo4j 使用 neo4j db 实现站点范围的搜索

> ID：12251007
> 
> 赞同：0
> 
> 时间：2012-09-03T15:57:05.260
> 
> 标签：node.js, neo4j

我正在使用[node-neo4j](https://github.com/thingdom/node-neo4j)与我的 neo4j 进行[通信](http://www.neo4j.org)。以下`github.com/aseemk/node-neo4j-template`是开始的真正帮助。仍在学习完成工作的方法，我正在寻求解决一些问题，我会很感激你给我的任何提示。

### 实施站点范围的搜索。

我们让用户使用他们的电子邮件 ID 进行索引，并希望通过标签或关键字来索引故事/帖子。我们如何搜索所有节点，我们是否维护各种类型的所有节点的索引，什么是好的方法？我应该和谷歌一起去启用这个功能吗？如何用多个标签/关键字索引同一个节点？

### 为节点指定自定义 ID

我们对节点的整数索引很好，但由于这些 id 可以重复使用，我们想识别具有唯一 id 的节点，有没有办法让 neo4j 使用 uuid，添加一个 uid 属性可以但希望避免维护两个id。

### 遍历节点

我们如何使用 node-neo4j 遍历节点，`Cipher-lang`看起来像答案，我还没有习惯。node-neo4j 是否可以开箱即用地做到这一点？

### 交易

我可能听起来很傻，但是我可以使用 node-neo4j 进行事务操作吗？

太多的问题，我觉得一旦我更习惯于查询数据库，我的大部分疑问都会得到解决，但是你的任何输入都会给我一个先机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:56:37.733

您可能应该将其分解为单独的问题。我可以回答其中的几个，但不是全部。

是的，node-neo4j 可以开箱即用地处理 Cypher，`query`方法是：[https](https://github.com/thingdom/node-neo4j/blob/develop/lib/GraphDatabase._coffee#L179) ://github.com/thingdom/node-neo4j/blob/develop/lib/GraphDatabase._coffee#L179 。帮助使用 Cypher——你应该观看这个介绍视频：http: [//vimeopro.com/neo4j/webinars/video/48603403](http://vimeopro.com/neo4j/webinars/video/48603403)

对于您的 uuid，您可能应该向节点添加一个单独的属性，并在其上有一个索引——只需忽略常规 id，除非在更方便的临时查询期间。据我所知，没有办法覆盖递增的 ID——不过那肯定会很好。

希望有帮助。

# c# - ASMX Web 服务 Enum 未保留其值

> ID：12251011
> 
> 赞同：1
> 
> 时间：2012-09-03T15:57:21.520
> 
> 标签：c#, asp.net, enums, .net-2.0, asmx

我创建了一个包含枚举值的 Web 服务，其值如下

```
public enum DesignChoice
{            
    DesignerChoice = 1,
    CustomerChoice = 2,
    AdditionalDesign=3,
} 
```

当我添加对我的客户网站的引用时，枚举值会更改为以下代码：

`(int)DesignChoice.AdditionalDesign`返回 2，但我希望它是 3。

我突然尝试了序列化属性`[System.Xml.Serialization.XmlTypeAttribute()]`，但没有运气。

服务的 WSDL 对枚举的描述如下：

```
 <s:simpleType name="DesignChoice">
        <s:restriction base="s:string">
          <s:enumeration value="DesignerChoice" />
          <s:enumeration value="CustomerChoice" />
          <s:enumeration value="AdditionalDesign" />
        </s:restriction>
      </s:simpleType> 
```

当我在 VS 中的类名上按 F12 时，它会显示以下从元数据生成的代码：

```
public enum DesignChoice
    {
        DesignerChoice = 0,
        CustomerChoice = 1,
        AdditionalDesign = 2,
    } 
```

我正在使用 Visual Studio 2005 和 .NET 2.0。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T16:48:17.997

这是发生了什么的详细说明

[http://www.kerrywong.com/2006/11/09/be-careful-when-using-enums-in-web-services/](http://www.kerrywong.com/2006/11/09/be-careful-when-using-enums-in-web-services/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:17:38.843

发送到您的服务和从您的服务发送的值将是代表您的 Enum 的字符串，例如`<DesignChoice>CustomerChoice</DesignChoice>`.

您的服务中 this 的值应该是正确的，但由于任何客户端上的数字信息可能不同，因此客户端上的值可以是任何值。只要他们发回正确的字符串值，这无关紧要。如果客户端显式依赖编号，则客户端可能存在设计缺陷，或者您的服务在调用时需要整数，而它应该期望 Enum。

# android - Android：高级 ColorPickerDialog

> ID：12251019
> 
> 赞同：8
> 
> 时间：2012-09-03T15:58:02.997
> 
> 标签：android, android-canvas

我正在寻找一个高级的 Android 颜色选择器对话框。API Demos 中的标准颜色选择器和[这篇文章](https://stackoverflow.com/questions/2442407/android-color-picker)中的示例对我来说不太可接受。我希望它看起来像这样：[这个图像](http://cdn6.droidmill.com/media/market-media/com.siyusong.android.color.picker_0.png)。有没有像这样的开源颜色选择器？

更新：我的主要目标是使颜色选择器易于使用：如果用户只需单击一次即可选择任何颜色，并且表示所有可能的颜色，那就太好了。我提到的示例中的颜色选择器需要两次单击来选择颜色，对于普通用户来说太复杂了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T21:06:06.847

这个看起来很接近你想要的，并且是 FOSS： [https ://github.com/LarsWerkman/HoloColorPicker](https://github.com/LarsWerkman/HoloColorPicker)

![在此处输入图像描述](../Images/3d4d2e123375d90a1ad5fa6659c42fc1.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-05T18:24:34.027

[这个](http://www.androidviews.net/2012/11/colorpickerpreference/)解决方案怎么样？

看截图：

![在此处输入图像描述](../Images/e0ade479a89421bedd9b4104dfedfec0.png)

源代码[在这里](https://github.com/attenzione/android-ColorPickerPreference)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-05T17:49:25.317

您是否尝试过[Android 拾色器](http://code.google.com/p/android-color-picker/)？如果您需要显示当前选定颜色的 RGB 代码，只需通过添加 TextView 并在 ColorChangeListener （或其他任何名称）中添加更新来修改对话框

或者看看 CyanogenMod 的颜色选择器对话框 ![CyanogenMod 的颜色选择器对话框](../Images/e29972212a237cd0cd8869522864f3f5.png)

这里是源链接：[GitHub 上的 CyanogenMod 颜色选择器](https://github.com/CyanogenMod/android_packages_apps_Settings/blob/527f17f73f76feee76f50d022c7b7629d288e312/src/com/android/settings/notificationlight/ColorPickerView.java)

# c++ - 您如何获取特定日期某个位置的时区（偏移量）？

> ID：12251020
> 
> 赞同：5
> 
> 时间：2012-09-03T15:58:04.290
> 
> 标签：c++, datetime

我在 UTC 中存储消息。因此，如果有人回顾之前的消息，我需要能够将时间戳转换为相对于当时时区的时间。我如何获得当时的时区？

例如，2012 年 9 月 3 日的时区是 PDT。当前时间偏移量为 -0700。我在 9:06 发送了一条消息。UTC 时间是 16:06。

我在 2012 年 12 月 1 日返回此消息。当前时区是 PST。当前时间偏移量为 -0800。我查看了我在 2012 年 9 月 3 日发送的消息。如果我要使用当前时间偏移从 UTC 转换回来，我会得到 8:06，这不是发送消息的时间。它是在 9:06 发送的。

因此，我需要一种方法来找出 2012 年 9 月 3 日的时区是 PDT，而不是 PST。

没有库的 PS 将是最好的，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:27:19.010

Boost Date_time 就是这样做的，这是我一直闲逛的简单示例（下面的代码）：

```
edd@max:~/src/progs/C++$ g++ -o boost_posix_time_dst boost_posix_time_dst.cpp
edd@max:~/src/progs/C++$ ./boost_posix_time_dst 
DST ran from 2012-Mar-11 02:00:00 to 2012-Nov-04 02:00:00
DST shortcut PDT
DST name     Pacific Daylight Time
edd@max:~/src/progs/C++$ 
```

还有形成日期的功能（您的 2012 年 12 月 1 日）并查看它是否在给定间隔内（如此处由 DST 开始和结束形成的那样）。

我认为您也可以通过形成日期并检查 isDST() 布尔值来获得它。

我的短节目如下。您需要 csv 文件的本地副本，它是 a) 在 Boost 源中和 b) 在许多处理时区的网站上（例如 Google 的第一次或第二次点击在 CERN 找到它）：

```
#include <iostream>
#include <boost/date_time/posix_time/posix_time.hpp>
#include <boost/date_time/posix_time/posix_time_io.hpp>
#include <boost/date_time/gregorian/gregorian.hpp>  
#include <boost/date_time/local_time/local_time.hpp>     

using namespace boost::posix_time;
using namespace boost::gregorian;

int main(int argc, char **argv) {

  boost::local_time::tz_database tz;
  tz.load_from_file("/tmp/date_time_zonespec.csv");

  boost::local_time::time_zone_ptr tzp =
            tz.time_zone_from_region("America/Los_Angeles");    

  int year = 2012;
  boost::posix_time::ptime t1 = tzp->dst_local_start_time(year);
  boost::posix_time::ptime t2 = tzp->dst_local_end_time(year);
  std::cout << "DST ran from " << t1 << " to " << t2 << std::endl;
  std::cout << "DST shortcut " << tzp->dst_zone_abbrev() << std::endl;
  std::cout << "DST name     " << tzp->dst_zone_name() << std::endl;

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:04:40.873

如果它是一个简单的`C++`应用程序，在执行期间不需要使用单独的时区，那么您可以简单地使用[`localtime`](http://www.cplusplus.com/reference/clibrary/ctime/localtime/)来获取一个共享引用，其中包含调用它`struct tm *`的特定时区信息。`time_t`如果您的系统配置了 PST 时区，那么当您调用 时`localtime`，它将使用太平洋时区信息进行显示 - 使用 2012 年 1 月 1 日（格林威治标准时间）和 2012 年 6 月 1 日的示例：

```
time_t def_time = 1325376000;
struct tm *a_tim = localtime(&def_time);
printf("%s %ld %d\n", a_tim->tm_zone, a_tim->tm_gmtoff, a_tim->tm_isdst);
def_time = 1338505200;
a_tim = localtime(&def_time);
printf("%s %ld %d\n", a_tim->tm_zone, a_tim->tm_gmtoff, a_tim->tm_isdst); 
```

在我的系统（TZ=Europe/Dublin）上显示：

```
GMT 0 0
IST 3600 1 
```

通过用 America/Los_Angeles 覆盖 TZ 环境变量，我得到：

```
PST -28800 0
PDT -25200 1 
```

即系统能够很好地确定时区名称、与 GMT 的偏移量以及夏令时是否从 UTC 时间戳开始生效。

**编辑**：尝试使用 posix 提供的时区例程同时在 C/C++ 程序中使用多个时区是可怕的，如果您处于这种情况，我绝对建议您使用 boost，因为它是一个快速的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:25:16.610

仅知道当前偏移量并不足以告诉您一年中另一个时间同一位置的偏移量；有很多地点在一年中的部分时间共享一个时区（例如中欧和阿尔及利亚，或美国东部和哥伦比亚）。

最简单的解决方法是将时区与消息一起存储。

# c# - ASP.Net SQL 查询输入控件

> ID：12251027
> 
> 赞同：2
> 
> 时间：2012-09-03T15:58:45.790
> 
> 标签：c#, asp.net, tsql, sql-server-2012

架构

```
 CREATE TABLE "Rooms"(

    RoomNo int NOT NULL,
    RoomType nvarchar(20) NULL,
    PricePerNight money NULL,
    MaximumOccupancy int NULL,
    NoOfBeds int NULL,
    NoOfBathrooms int NULL,
    Entertainment bit NULL,
    RoomService bit NULL,
    Gym bit NULL,

    CONSTRAINT PK_Rooms PRIMARY KEY(RoomNo)
)

CREATE TABLE "Reservation"(

    ReservationID int IDENTITY (1,1) NOT NULL,
    CustomerID int NOT NULL,
    RoomNo int NOT NULL,
    CheckInDate date NOT NULL,
    CheckOutDate date NOT NULL,
    NoOfDays int NOT NULL,

    CONSTRAINT PK_Reservation PRIMARY KEY(ReservationID),

    CONSTRAINT FK_Reservation_Customers_CustID FOREIGN KEY(CustomerID)  
        REFERENCES dbo.Customers(CustomerID),

    CONSTRAINT FK_Reservation_Rooms_RoomNo FOREIGN KEY(RoomNo)
        REFERENCES dbo.Rooms(RoomNo)
) 
```

我想为 Sql Server 创建一个查询，当用户输入 2 个日期时，它将查询 Room 和 Reservation 表以带回所有当前可用的房间（可用：意味着没有预订条目有/或在用户输入的日期之间。

```
Sql-Server-Code

 SELECT dbo.Rooms.RoomNo
 FROM dbo.Rooms JOIN dbo.Reservation
 ON (dbo.Rooms.RoomNo = dbo.Reservation.RoomNo)
 WHERE '2012-02-01' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate
 AND '2012-02-05' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate; 
```

^ 我对此进行了测试，在我进行的测试中，它产生了我想要的结果。所以我现在需要在我的 ASP.Net 网站上进行测试。在我的页面上，我有一个搜索框，用户可以在其中输入 2 个日期、签入和签出。这将再次返回所有可用的房间，所以我想。

```
ASP.Net Code Search Box

<div id="searchContainer">
    <form id="searchForm">
    <ul id="searchBox">
        <li>Search</li>
        <hr />
        <li>Check In Date</li>
        <li class="CiMenu">
            <asp:TextBox ID="txtBoxCheckIn" runat="server" />
            <ajaxtoolkit:CalendarExtender ID="CalendarExtender2" runat="server" TargetControlID="txtBoxCheckIn"
                Format="yyyy-MM-dd" />
        </li>
        <li>Check Out Date</li>
        <li class="CoMenu">
            <asp:TextBox ID="txtBoxCheckOut" runat="server" />
            <ajaxtoolkit:CalendarExtender ID="CalendarExtender1" runat="server" TargetControlID="txtBoxCheckOut"
                Format="yyyy-MM-dd" />
        </li>
        <li>
            <asp:Button ID="searchButton" runat="server" Text="Search" 
                PostBackUrl="~/Rooms.aspx" />
        </li>
    </ul>
    </form>
</div>

ASP.Net Code For my query.

    <asp:SqlDataSource ID="RoomDataSource" runat="server" ConnectionString="<%$ ConnectionStrings:HotelProjectConnectionString %>"
        SelectCommand="SELECT * FROM Rooms JOIN Reservation
        ON (Rooms.RoomNo = Reservation.RoomNo)
        WHERE (@CheckIn NOT BETWEEN Reservation.CheckInDate AND Reservation.CheckOutDate)
        AND ( @CheckOut NOT BETWEEN Reservation.CheckInDate AND Reservation.CheckOutDate)">
        <SelectParameters>
            <asp:ControlParameter ControlID="txtBoxCheckIn" Name="CheckIn" PropertyName="Text"
                Type="DateTime" />
            <asp:ControlParameter ControlID="txtBoxCheckOut" Name="CheckOut" PropertyName="text"
                Type="DateTime" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

我创建了 9 个不同的房间 101-109 和 1 个预订条目。

```
INSERT Reservation(CustomerID,RoomNo,CheckInDate,CheckOutDate,NoOfDays)
    VALUES(1,101,'2012-01-01','2012-01-30', DATEDIFF(day,'2012-01-01','2012-01-30')) 
```

1.  So now if i do a search on my website where the "checkindate" is '2012-09-01' and "checkoutdate" is '2012-09-05'. It returns room101 row which it should do as theres no reservation entry with those dates for that room, however it doesn't return all the other 8 rooms.

2.  If i do a search where the checkindate is '2012-01-01' and checkoutdate is '2012-01-30' < there is already a reservation for this for room101\. Meaning it should bring back all the room rows except 101\. However it doesn't return anything.

Could someone please help me with this, can you see where i am going wrong.

UPDATE:

This new Query is what i'm looking for cept it has a minor problem

```
SELECT *
FROM dbo.Rooms
WHERE NOT EXISTS
  (select *
    from dbo.Reservation
    where dbo.rooms.RoomNo = dbo.Reservation.RoomNo
    AND '2012-01-01' BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate
    AND '2012-01-30' BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate
    ); 
```

This will show results between room102-109 which is correct however if we change the 2012-01-30 to 2012-01-32 it adds room101 to the result which it shouldn't. Any solution?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:45:21.283

Your date criteria is wrong. To test for [overlapping ranges](https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap) you should use

```
where '2012-01-01' <= dbo.Reservation.CheckOutDate
  and '2012-01-30' >= dbo.Reservation.CheckInDate 
```

It says that if beginning of range1 is before end of range two, and end of range1 is after beginning of range2, there is overlap.

Left join is not working for you because conditions put on right side table must be specified in join itself:

```
SELECT dbo.Rooms.RoomNo
  FROM dbo.Rooms 
  LEFT JOIN dbo.Reservation
    ON dbo.Rooms.RoomNo = dbo.Reservation.RoomNo
   AND '2012-01-01' <= dbo.Reservation.CheckOutDate
   AND '2012-01-30' >= dbo.Reservation.CheckInDate; 
```

Otherwise it is treated as inner join by following execution order - join is evaluated and includes null records from right side table only to eliminate those records in where clause.

**EDIT**: The final filter is missing. The query lists all rooms and for those reserved lists a reservation. If you need to select rooms without reservations add

```
 WHERE Reservation.RoomNo is null 
```

And if you want all rooms reserved in a period use inner join instead of left outer join.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:42:35.130

I think your problem is that you are using join instead of left outer join. There is only one item in th Reservations table with room 101 so if you do join on room and reservation it will only return 1 row with room 101 (try it..) instead you want all the rooms from the rooms table to join the rooms from reservations table, so your query needs to look like this:

Sql-Server-Code

 SELECT dbo.Rooms.RoomNo  FROM dbo.Rooms LEFT OUTER JOIN dbo.Reservation  ON (dbo.Rooms.RoomNo = dbo.Reservation.RoomNo)  WHERE '2012-02-01' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate  AND '2012-02-05' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate;

# ruby-on-rails - 无法重新安装设计

> ID：12251028
> 
> 赞同：2
> 
> 时间：2012-09-03T15:59:03.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我安装`devise 1.1.rc0`了它，但无法让它在我现有的应用程序中工作。

我将 gem 文件更改为`gem 'devise'`未指定版本。跑捆绑安装。然后运行`rail destroy devise_install`，因为这是我用来安装它的命令。

*然后，当我尝试重新安装时，`rails generate devise:install`它给了我这个错误：

> gems/activerecord-3.2.8/lib/active_record/dynamic_matchers.rb:50:in `method_missing': undefined method`devise' for # (NoMethodError)*

* * *

Ryan Bigg 帮助我弄清楚上述错误是由用户模型引用设计引起的，卸载后会导致错误。所以我删除了那个引用。

现在我有这个错误。

gems/activesupport-3.2.8/lib/active_support/inflector/methods.rb:230:in `block in constantize': 未初始化的常量用户（NameError）

这是指什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:52:16.440

您收到此错误是因为未配置 Devise，但您的模型引用了它。在引用它的任何模型中删除对该方法的调用`devise`（或将其注释掉）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T20:10:47.797

从 1.8.7 和 Rails 3.0.7 升级到 1.9.3 和 Rails 3.2.8 时，我发现了同样的问题。该解决方案涉及删除： gem 'active_reload'

# java - 使用 JAXB 在嵌套元素上添加命名空间

> ID：12251031
> 
> 赞同：1
> 
> 时间：2012-09-03T15:59:10.840
> 
> 标签：java, xml, namespaces, jaxb

> **可能重复：**
> [JAXB 编组 XMPP 节](https://stackoverflow.com/questions/5720501/jaxb-marshalling-xmpp-stanzas)

我在 stackoverflow 上做了一些搜索，并没有真正找到我需要的答案。

我在尝试使用 JAXB 操作命名空间时遇到了一些麻烦。让我们开始吧。

我需要以下格式的 XML

```
<root xmlns="http://namespace/root">

    <item xmlns="http://namespace/item">
        <id>1</id>
        <name>First</name>
    </item>

    <item xmlns="http://namespace/item">
        <id>2</id>
        <name>Second</name>
    </item>
</root> 
```

如您所见，我基本上需要在**每个**标签上复制名称空间。当我尝试使用 JAXB 创建它时，我得到以下 XML 输出：

```
<root xmlns="http://namespace/root"
      xmlns:ns2="http://namespace/item">

    <ns2:item>
        <ns2:id>1</ns:id>
        <ns2:name>First</ns2:name>
    </ns2:item>

    <ns2:item>
        <ns2:id>2</ns:id>
        <ns2:name>Second</ns2:name>
    </ns2:item>
</root> 
```

显然它是这样生成的，它使用前缀所以这里不应该有任何问题，

但是我发送这个 XML 的消费者要求它是那种格式，我必须为文件中的每个项目复制名称空间。

有人知道该怎么做吗？我想到了一个字符串模板，但由于这一切都已经用 JAXB 完成了，我想知道是否没有更简单的方法可以做到这一点。

谢谢大家！

# ios - 使用 CATransform3DMakeRotation 时的 uiview zorder

> ID：12251034
> 
> 赞同：0
> 
> 时间：2012-09-03T15:59:15.633
> 
> 标签：ios, uitableview, quartz-core

情况如下： self.view 包含：1，一个自定义栏，它实际上是一个带有一些按钮的 uiview，其高度为 44px 2，一个 uitable view y-pos 从第 44 px 开始。这些行有 150px 高和宽的按钮。在触摸按钮时，一个 tmp uiview 与添加在桌子上按钮所在位置的按钮相似。发生了一些动画块，uiview 覆盖了整个表格并显示了一些内容。

到目前为止一切都很好。

现在，如果向上滚动表格，使下半部分可见而上半部分不可见。tmp 视图在同一位置正确添加，但在使用 CATransform3DMakeRotation(M_PI_2, 0.0f, 1.0f, 0.0f) 时，即使使用 insertSubview belowSubview:customBar 添加的 tmp 视图，左半部分看起来在自定义栏的顶部。我试图将视图发送回去，但没有运气。所以知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:41:29.873

这很容易。在应用动画之前，即使在翻转期间也应该位于所有顶部的视图应该具有较大的正 zposition 值。

```
self.myview.layer.zPosition =200.0f; 
```

# autocomplete - clang的c-index-test也能找到符号的声明吗？

> ID：12251040
> 
> 赞同：0
> 
> 时间：2012-09-03T15:59:30.017
> 
> 标签：autocomplete, clang, ctags

我发现[了一个关于类似主题的旧](https://stackoverflow.com/questions/7889053/clang-symbolvariable-function-type-etc-definition-or-declaration-or-ref)问题，但我仍然想知道如何做到这一点：我想尝试使用 clang 进行代码导航，而不是 gtags / GNU global 或类似工具。我已经在 Emacs 中使用 autocomplete-clang，效果很好。但它只完成。现在我想问一下clang：“xyz.cc:42:23中符号的定义和/或声明在哪里”。这可能与 c-index-test 或 clang 一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:31:44.317

Clang 肯定知道符号的定义在哪里。我从 clang-autocomplete 切换到[clang-autocomplete-async](https://github.com/Golevka/emacs-clang-complete-async)，它使用`clang-complete`基于 clang 而不是 stock 构建的工具`clang`。虽然这个工具还不支持导航，但我相信它可以很容易地实现。

# c# - 检测圆 A 是否完全在圆 B 内

> ID：12251041
> 
> 赞同：4
> 
> 时间：2012-09-03T15:59:32.563
> 
> 标签：c#, math, collision-detection, geometry

下面是一个检测两个圆是否相交的函数。我想将其更改为仅检测圆圈的周边是否相交。因此，如果圆 A*完全*在圆 B 内，则没有碰撞！

如何？

```
private bool IsCircleCollision(
    int x1, int y1, int radius1,
    int x2, int y2, int radius2)
{
    int dx = x2 - x1;
    int dy = y2 - y1;

    int distance = (dx * dx) + (dy * dy);

    int radii = radius1 + radius2;
    if (distance < radii * radii)
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T16:02:50.517

你可以通过计算两个中心之间的距离来解决这个问题，D 说。如果有交叉点

```
abs(R1-R2) < D < R1+R2 
```

其中 R1 和 R2 是两个圆的半径。

第一个测试，`abs(R1-R2) < D`处理一个圆的中心在另一个圆的中心的情况。第二个测试`D < R1+R2`处理两个圆都不包含另一个圆心的情况。

因此，调整您的代码，我们有：

```
private bool IsCircleCollision(
    int x1, int y1, int radius1,
    int x2, int y2, int radius2)
{
    int dx = x2 - x1;
    int dy = y2 - y1;

    double D = Math.Sqrt(dx*dx + dy*dy);
    return Math.Abs(radius1-radius2)<D && D<radius1+radius2;
} 
```

如果性能在这里很重要，你可以不用这样的调用`Math.Sqrt`：

```
private bool IsCircleCollision(
    int x1, int y1, int radius1,
    int x2, int y2, int radius2)
{
    int dx = x2 - x1;
    int dy = y2 - y1;

    int Dsqr = dx*dx + dy*dy;
    int rdiff = Math.Abs(radius1-radius2);
    int rsum = radius1+radius2
    return rdiff*rdiff<Dsqr && D<rsum*rsum;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:03:29.207

当且仅当两个中心之间的距离小于或等于两个半径之和但大于或等于它们的绝对差时，周长才会相交。有了这个事实，重写函数应该不难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:06:03.617

```
else if (Math.Sqrt(dx * dx + dy * dy) < Math.Abs(radius1 - radius2)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T16:03:58.457

您可以添加一个检查来查看`distance + radius1`是小于`radius2`还是`distance + radius2`小于`radius1`，但是您需要`distance`是实际距离而不是它的平方。

# html - Outlook 未在表格行内显示背景图像

> ID：12251047
> 
> 赞同：1
> 
> 时间：2012-09-03T16:00:05.133
> 
> 标签：html, outlook

我是一个简单的 html 编码爱好者，我遇到了 Outlook 没有在表格行内显示背景图像的问题。

这是代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://
www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:v="urn:schemas-microsoft-com:vml">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>TEST #3</title>
</head>

<body link="#FFF" vlink="#b3c010" alink="#b3c010">
<table width="650" border="0" cellspacing="0" align="center">
<tr><td bgcolor="#ffffff" align="center"><p style="font-family:Arial, Helvetica, sans-serif;font-size:11px;color:#000000;">Não consegue visualizar este email correctamente? <a href="http://www.consulai.com/minuto_consulai/03_alterado/minuto_consulai.html" style="color:#999999;">Veja aqui a versão online</a></p></td></tr>
</table>
<table width="650" border="0" cellspacing="0" style="background-color: #b3c010; background-image:url(http://www.consulai.com/minuto_consulai/03_alterado/imagens/background.jpg); background-repeat:repeat-y;" align="center">
  <tbody>

  <tr><td width="650" height="452"><img src="http://www.consulai.com/minuto_consulai/03_alterado/imagens/img1.jpg" width="650" height="452" alt="Minuto Consulai"></td></tr>
  <tbody>
  <tr style="background:url(http://www.consulai.com/minuto_consulai/03_alterado/imagens/background.jpg) background-repeat:repeat-y;">
  <td>
  <table width="518" border="0" align="center" cellpadding="0" cellspacing="0">
  <tbody>  
  <tr>
    <td align="center" valign="top" bgcolor="#FFFFFF"><img src="http://www.consulai.com/minuto_consulai/03/imagens/foto.jpg" width="518" height="264" alt="Proder Programa de Desenvolvimento Rural"></td>
  </tr>
  <tr>
    <td align="left" valign="top" bgcolor="#FFFFFF"><table width="451" border="0" align="center" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td>
        <p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:15px; color:#b3c010; text-align:justify;">18-22 E 25-29 DE SETEMBRO DE 2012 > PÓS-LABORAL</p>
          <p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:15px; color:#54575A; text-align:justify;">A CONSULAI organiza, em parceria com a APAS Floresta e a Syngenta, o <span style="font-weight: bold;"><a href="http://www.consulai.com" target="_blank" style="text-decoration:none;color: #54575A;">Curso de Aplicação de Produtos Fitofarmacêuticos em Explorações Florestais</a></span>, homologado pela Direção Regional de Agricultura, o qual permitirá a obtenção do Cartão de Aplicador.</p>
      <p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:15px; color:#54575A; text-align:justify;">O curso decorrerá em regime pós-laboral, terá uma duração de 35 horas e terá início no dia <span style="font-weight: bold;">04 de setembro de 2012</span>. A  formação será ministrada nas instalações da APAS FLORESTA e em propriedades florestais, no Cadaval.</p>
      <p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:13px; font-weight: bold; color:#54575A; text-align:justify;"><a href="http://www.consulai.com/minuto_consulai/03/pdf/FOLHETO_CURSO_APLICADORES_SET 2012.pdf" target="_blank" style="text-decoration:none;color: #54575A;">Ficha de inscrição</a></p>
      <p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:13px; color:#54575A; text-align:justify;">Contactos:<br />Sónia Gonçalves (CONSULAI)<br /><span style="font-weight: bold;">TLM</span> 918 928 923&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;">T</span> 213 629 553&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;">F</span> 213 621 091<br /><span style="font-weight: bold;">E</span> <a href="mailto:sgoncalves@consulai.com" target="_blank" style="text-decoration:none;color: #54575A;">sgoncalves@consulai.com</a></p>
        </tr>
    </tbody></table></td>
  </tr>
  <tr><td width="518" height="82"><img src="http://www.consulai.com/minuto_consulai/03/imagens/certificacoes.jpg" width="518" height="82" alt="Certificações"></td></tr>
  </tbody></table>
<!-- END conteudos -->

<tr><td width="650" height="108"><img src="http://www.consulai.com/minuto_consulai/03_alterado/imagens/footer.jpg" width="650" height="108" alt="Contactos Consulai"></td></tr>
</table>
<!-- END main content -->

<!-- START top bar -->
<table width="650" border="0" cellspacing="0" align="center">
<tr><td bgcolor="#ffffff" align="center"><p style=" font-family:&#39;Trebuchet MS&#39;, Arial, Helvetica, sans-serif; font-size:11px; color:#54575A; text-align:justify;">PARA DEIXAR DE RECEBER O MINUTO CONSULAI ENVIE-NOS <a href="mailto:consulai@consulai.com" target="_blank" style="text-decoration:none;color: #54575A;">UM E-MAIL</a> COM O ASSUNTO REMOVER.</p></td></tr>
</table>
<!-- END top bar -->
  </td>
  </tr>
  <tr>

<tbody><tr>

        </tr>
</tbody></table></td>
  </tr>

</tbody>
</table>
</td>
</tr>
</body>
</html> 
```

它在其他电子邮件客户端中显示良好，我正在使用 mailchimp 将其发送出去。有问题的行是这样的：

```
<tr style="background:url(http://www.consulai.com/minuto_consulai/03_alterado/imagens/background.jpg) background-repeat:repeat-y;"> 
```

我也尝试过 VML hack，但我似乎无法让它与这一行一起工作。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:43:03.150

根据[http://blog.mailermailer.com/email-design/background-images-in-html-email-the-naked-truth](http://blog.mailermailer.com/email-design/background-images-in-html-email-the-naked-truth) Outlook 2007 - 2010 仅支持 body 标签的背景图片。

你可以使用

```
<body style="background:url(http://www.consulai.com/minuto_consulai/03_alterado/imagens/background.jpg) background-repeat:repeat-y;"…&gt; 
```

或将有问题的图像嵌入为 img 标签。

# linux - 用于检测系统是 32 位还是 64 位的 Shell 脚本

> ID：12251049
> 
> 赞同：1
> 
> 时间：2012-09-03T16:00:14.613
> 
> 标签：linux, shell

> **可能重复：**
> [如何确定给定的 Linux 是 32 位还是 64 位？](https://stackoverflow.com/questions/246007/how-to-determine-whether-a-given-linux-is-32-bit-or-64-bit)

有谁知道如何创建一个 shell 脚本 sh 文件，如果它是 64 位系统，它可以 shell 一个程序，如果它是 32 位系统，它可以 shell 另一个程序？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:30:33.503

```
if $(uname -m | grep '64'); then
  echo "ARCH: 64-bit"
else
  echo "ARCH: 32-bit"
fi 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:02:16.210

试试看`uname -m`：`x86_64`是64位内核，`i686`是32位内核。基于此，您可以调用一个程序或另一个程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:07:49.333

（回应 thkala 的评论。）

```
if echo __SIZEOF_POINTER__ | cpp -E - - | grep '^8$' >/dev/null; then
    do_stuff
fi 
```

不太可能在任何地方工作，但如果 cpp 来自 GCC，它就可以工作。具有检测任何 64 位架构的优势，而不仅仅是 x64（POWER、SPARC、IA64 等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:07:04.677

如果您想知道处理器是否是 64 位而不是内核，您可以在系统上搜索长模式 (-lm) 标志。它将出现在 64 位上，而不是 32 位上：

`cat /proc/cpuinfo | grep lm`

# php - MVC 框架内的持久对象

> ID：12251050
> 
> 赞同：0
> 
> 时间：2012-09-03T16:00:17.147
> 
> 标签：php, model-view-controller, frameworks, persistent

我正在编写自己的 PHP MVC 框架，我想知道哪个地方最适合编写像**User**这样的持久数据对象。如果没有像 $_SESSION、APC、memcached 之类的持久性存储...有人可以在每次 http 请求时从数据库中检索用户数据，这在性能方面是个坏主意。(M) 模型似乎是一个不错的选择。像这样的事情是一个好的开始：

```
class UserModel extends Model
{
  public function getEmail()
  {
    $user = Session::get('User');
    if(isset($user))
    {
      return $user->Email;
    }
    return null;
  }
} 
```

可能不会，因为它没有返回大多数模型所做的数据库数据。我应该创建一个独立的类吗？这有什么模式吗？我不想让它全球化，谁是这些对象的所有者/管理者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:09:12.860

您的模型应该只对业务逻辑进行建模。它们不应该与用户交互有任何关系。这是控制器（和视图）的工作。会话完全属于用户交互领域。所以不要在模型中使用它们。始终假设您将从命令行或其他不存在会话的上下文中使用模型。这应该会影响您的许多应用程序设计。

您可以在各个阶段实施缓存以减少主数据存储的负载。您应该有一个*模型层*或*服务层*，它表达了您的应用程序的核心逻辑。该层有一个定义的 API，您可以使用它在您的应用程序中执行操作。也许在幕后，该层使用 memcache 等在内部缓存一些数据以减少数据库的负载。
然后你应该有一个视图层，它从模型层获取数据并将其可视化。该视图层可能会缓存从模型层接收到的数据。

最大的收获：正确分离您的关注点。请参阅[N-Tier Architecture - An Introduction](http://blog.ircmaxell.com/2012/08/n-tier-architecture-introduction.html)，它可能会给您更多的想法。

# codeigniter - Codeigniter：控制器函数名称显示在 url 中，如何更改查看文件名？

> ID：12251051
> 
> 赞同：1
> 
> 时间：2012-09-03T16:00:33.480
> 
> 标签：codeigniter, url, controller, routes

想知道是否有人可以指导我做错了什么（或需要做什么）并认为问题出在我的路线文件中。当用户显示登录表单时，例如他们在提交 url 后输入错误的用户名，显示如下：`http://localhost:8888/codeigniter/login/login_validation`。当成功并登录到管理区域（从数据库中提取新闻文章）时，仍会显示此 URL。我想知道是否有办法让`http://localhost:8888/codeigniter/news.`我查看我的路线文件夹，我尝试使用“通配符”但没有成功。这是我的参考代码，需要的任何其他信息或文件让我知道！谢谢。

控制器：

```
 class Login extends CI_Controller {

    public function __construct() {
        parent::__construct();

    }

        public function index() {
            $this->load->view('login');
    }

    //Validate login area
    public function login_validation() {
        $this->load->library('form_validation');
        $this->form_validation->set_rules('username', 'Username', 'trim|required|xss_clean|callback_username_check');
        $this->form_validation->set_rules('password', 'Password', 'required|xss_clean|callback_password_check');

          if($this->form_validation->run() == FALSE) {
             //Field validation failed.  User redirected to login page
             $this->index();

             }else{
                 $this->load->model('user_model');
                 $query = $this->user_model->login_details();

                 // if the user's credentials validated...
                if($query) {
                    $data = array(
                        'username' => $this->input->post('username'),
                        'is_logged_in' => true
                    );

                    $this->session->set_userdata($data);
                    redirect('news');

                }else{
                 $data['error'] ="Invalid Username or Password";
                 $this->load->view('login',$data);  
                }

            }
    }

            function logout() {
       $this->session->sess_destroy();
       $this->index();
} 
```

}

user_model.php 中的 login_details 函数

```
 function login_details() {
        $this->db->where('username', $this->input->post('username'));
        $this->db->where('password', md5($this->input->post('password')));
        $query = $this->db->get('login');

        if($query->num_rows == 1){
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:06:15.370

如果您登录到任何类型的系统，您将需要使用 CodeIgniter 的[Session](http://codeigniter.com/user_guide/libraries/sessions.html)类来存储会话。如果`controllers/news.php`存在，您可以设置会话并立即使用`redirect('news');`. 不需要，`$this->load->view()`因为无论如何这个逻辑都会在`news.php`'s index 中，而且你会复制代码。

我不确定`$this->user_model->login_details()`返回的是什么，但我假设`false`或者`null`因为您说 CodeIgniter 正在将您送回`login`视图。进入`login_details()`功能并确保一切正常（您可能也想发布它）。此外，`routes.php`如果您进行了更改，请为我们发布您的文件以防万一。

附带说明：空格是有效的密码字符，不是`trim`这样，否则密码中带有前导或尾随空格的人将无法进入；）

# bash - rsync --exclude-from 选项不会忽略带空格的目录

> ID：12251052
> 
> 赞同：1
> 
> 时间：2012-09-03T16:00:35.410
> 
> 标签：bash, rsync

我很难使`--exclude-from=`文件正确排除带有 rsync 空格的目录（来自 macports 的 v3.0.9）。

试图忽略一个名为`Adele - 21 [2011] flac/`

试过：

```
- Adele - 21 [2011] flac/
- "Adele - 21 [2011] flac/"
- "Adele\ -\ 21\ [2011]\ flac/"
- 'Adele - 21 [2011] flac/'
- 'Adele\ -\ 21\ [2011]\ flac/' 
```

试过`-s`开关。

还是行不通...

* * *

编辑：什么鬼！这似乎有效：

```
- Adele - 21 \[2011\] flac/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:19:25.277

您的问题是参数 for`--exclude`是[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)。

这意味着`Adele - 21 [2011] flac`匹配`Adele - 21`后跟其中`[012]`之一`flac`

要解决此问题，您需要转义特殊字符`[`并`]`

# php - PHP显示当前服务器路径

> ID：12251054
> 
> 赞同：33
> 
> 时间：2012-09-03T16:00:47.957
> 
> 标签：php

我需要在我的 php 中设置一个路径，但我目前不知道该路径。

我需要配置上传目录的路径

应该如下所示：

```
/srv/www/uploads/ 
```

我的 uploads.php 文件位于根目录中......所以

```
www/uploads/ ??? 
```

无论如何，我可以让 php 告诉我我当前的路径吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-03T16:06:16.553

如果你调用[getcwd](http://php.net/manual/en/function.getcwd.php)它应该给你路径：

```
<?php
  echo getcwd();
?> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-12-15T00:06:38.910

```
echo $_SERVER["DOCUMENT_ROOT"]; 
```

'DOCUMENT_ROOT' 当前脚本在其下执行的文档根目录，如服务器的配置文件中所定义。

[http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-09-03T16:07:42.847

*   获取当前工作目录`getcwd()`：（[文档](http://php.net/manual/en/function.getcwd.php)）
*   获取文档根目录`$_SERVER['DOCUMENT_ROOT']`：（[文档](http://php.net/manual/en/reserved.variables.server.php)）
*   获取当前脚本的文件名：`$_SERVER['SCRIPT_FILENAME']`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-07-17T22:18:26.547

您还可以使用以下替代[realpath](https://www.php.net/manual/fr/function.realpath.php "真实路径")。

**创建一个**名为*path.php的文件*

**通过指定创建的文件的名称**将以下代码放入其中。****

 **```
<?php 
    echo realpath('path.php'); 
?> 
```

一个 php 文件，您可以将其移动到所有文件夹以始终具有执行文件所在位置的绝对路径。

;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-03T16:07:51.813

php可以调用命令行操作所以

```
echo exec("pwd"); 
```**

# ios - 释放单例

> ID：12251055
> 
> 赞同：0
> 
> 时间：2012-09-03T16:00:52.313
> 
> 标签：ios, iphone, objective-c, memory-management

我想知道你将如何释放一个单例

```
+ (DSActivityView *)activityViewForView:(UIView *)addToView withLabel:(NSString *)labelText width:(NSUInteger)labelWidth;
 {
    // Not autoreleased, as it is basically a singleton:
    return [[self alloc] initForView:addToView withLabel:labelText width:labelWidth];
 } 
```

使用分析工具对此进行分析时，我收到以下错误：第 90 行对象的潜在泄漏。这是返回的行。

我已经尝试过解决错误消息问题的自动释放，但我不相信它是正确的解决方案，因为我读到自动释放单例并不好。有人可以帮助我确定如何最好地释放这个对象吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:04:53.520

分析器向您发出警告的原因基本上是方法名称：

```
+ (DSActivityView *)activityViewForView:(UIView *)addToView withLabel:(NSString *)labelText width:(NSUInteger)labelWidth; 
```

根据 Objective-C 约定，所有以 "create"/"new"/... 开头的方法名称都返回一个保留对象；您的方法属于便利构造函数的类别，这些构造函数预计会返回自动释放的对象，因此会发出警告。

另一方面，你说这是一个单例，但实际上不是。因此，您最终可能会多次调用此方法，从而导致实际泄漏。使您的方法更安全（并且更像单例）的基本方法是：

```
+ (DSActivityView *)activityViewForView:(UIView *)addToView withLabel:(NSString *)labelText width:(NSUInteger)labelWidth;
{
    static DSActivityView* gDSActivityViewSingleton = nil;
    if (!gDSActivityViewSingleton)
          gDSActivityViewSingleton = [[self alloc] initForView:addToView withLabel:labelText width:labelWidth];
    return gDSActivityViewSingleton;
} 
```

这既可以使分析仪放松，又可以让您在方法误用的可能性面前更加安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:06:03.723

使用自动释放。没有理由不这样做。基本上，对象的所有权属于对象，因此您永远无法手动释放它。作为一个单例，如果您不拥有它并不重要，因为大概下次您调用它并在范围内需要它时，您将使用另一种方便的方法，它将再次被实例化。

如果您想拥有该对象的所有权，那么您需要照常实例化它，然后您将能够保留和释放它。

另外，请阅读 sergio 的编辑，了解它不是“正确的”单身人士。:p

此外，如果可以的话，转换为 ARC，您就不必担心这个了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:17:59.373

你做错了。考虑：

如果您多次调用activityViewForView，您将不会一遍又一遍地获得相同的对象。它只会初始化一个新对象并给你指向它的指针！！！

为了使这个东西成为单例，你必须将创建的对象存储在一个常量变量中，并确保在你的应用程序运行时始终引用这个对象（例如在 appDelegate 中声明指向这个对象的指针）。

然后每次调用`activityViewForView`时都必须检查常量变量是否指向有效对象。如果是，则返回有效对象，如果不是，则创建它并将其存储在常量静态变量中（仅创建一次）。

如果你确实使用了 ARC，那么一切就绪。如果没有，请释放您的对象（使用 dealloc 方法）

# aptana - 退格键在 aptana 中不起作用

> ID：12251058
> 
> 赞同：0
> 
> 时间：2012-09-03T16:01:08.050
> 
> 标签：aptana

我刚刚下载了 Aptana 3.2.2，但是在编辑时，我的退格键不起作用。我在很多论坛上搜索过，但我没有找到问题。我在 Ubuntu Precise 上，我没有按下鼠标中键。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T11:33:10.203

我有同样的问题。我通过创建一个新文件（我认为它适用于任何类型）解决了这个问题，当我必须为其设置名称时，我按下了退格键。

之后我取消了这个过程，退格键在代码编辑器中一如既往地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T22:27:36.773

不创建文件而是重置视角为我解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-23T10:55:12.603

我以这种方式解决了（Eclipse Mars）：

*窗口 > 首选项 > 常规 > 键*，

选择*命令删除上一个*，

在组合绑定中选择*Backspace*，

*申请*。

# c++ - 来自 AfxBeginThread 的无效句柄

> ID：12251060
> 
> 赞同：0
> 
> 时间：2012-09-03T16:01:22.433
> 
> 标签：c++, multithreading, winapi, privileges

我正在编写一个多线程网络应用程序，并且我正在使用一个带有阻塞套接字的单独线程来从服务器异步接收数据。

当我需要关闭套接字时，我使用一个函数来检查接收线程是否仍在运行以及是否调用`TerminateThread`它来结束它，如下所示：

```
DWORD dwExitCode = 0;
if( GetExitCodeThread( theApp.m_hRecvThread, &dwExitCode ) && dwExitCode == STILL_ACTIVE )
     TerminateThread( theApp.m_hRecvThread, 0 ); 
```

但是，`GetExitCodeThread`返回`FALSE`，并且在轮询`GetLastError()`时返回 6 ( `ERROR_INVALID_HANDLE`)。这表明我在句柄​​上没有`THREAD_QUERY_INFORMATION`或`THREAD_QUERY_LIMITED_INFORMATION`访问权限。`m_hRecvThread`

我的`m_hRecvThread`句柄是在创建线程时设置的，如下所示：

```
m_hRecvThread = AfxBeginThread( RecvThread, hWndMainFrame ); 
```

这成功地创建了线程，并且线程运行良好并展示了预期的功能。`TerminateThread`和`GetExitCodeThread`是从最初创建 Receive 线程的同一线程调用的。

> 我的理解是，使用时`AfxBeginThread`，`HANDLE`返回的有`THREAD_ALL_ACCESS`访问权限，是这样吗，如果是这样，为什么我仍然得到`ERROR_INVALID_HANDLE`？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-22T19:27:31.493

使用创建的线程：

```
m_hRecvThread = AfxBeginThread( RecvThread, hWndMainFrame ) 
```

将返回一个指向 winthread 的指针。但是`GetExitCodeThread()`需要线程的句柄，例如，你可以通过`RecvThread->m_hThread`，这将解决问题

# php - 没有地图的谷歌地图商店定位器

> ID：12251066
> 
> 赞同：0
> 
> 时间：2012-09-03T16:01:39.953
> 
> 标签：php, javascript, xml, google-maps, search

我本质上是在尝试使用谷歌地图地理编码器构建一种商店定位器，但我想找到一种方法来编写代码，将最近的商店作为页面上的超链接（可能在 div 内）返回，而不是将所有内容都放在地图上. 我不想使用地图，或标记和信息窗口等......至少不要开始。

我已经在线学习了很多 Google Maps API 教程，并且很容易构建一个基本的工作商店定位器，通过检查输入 latlng 与我的数据库中的值，返回给定半径内的一组结果，但是我不是那么熟练 js，并且想知道是否有人知道任何可能演示使用地理编码器以文本格式返回 latlng 搜索结果的教程，没有地图。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:33:38.003

如果不使用谷歌地图上的结果，则不允许使用[谷歌地理编码器。](https://developers.google.com/maps/documentation/geocoding/)

> 注意：Geocoding API 只能与谷歌地图一起使用；禁止在未在地图上显示的情况下对结果进行地理编码。有关允许使用的完整详细信息，请参阅 Maps API 服务许可限制条款。

# c++ - 具有递归类型别名的 G++-4.7.0 内部编译器错误分段错误

> ID：12251067
> 
> 赞同：2
> 
> 时间：2012-09-03T16:01:46.197
> 
> 标签：c++, c++11, g++

```
#include <memory>

template<typename T>
using CallbackPtr = const std::shared_ptr<const T>;

template<typename C, typename T>
using CallbackFunPtr = void (C::*)(CallbackPtr<T>);

int main () {
    return 0;
} 
```

结果是：

```
7 : internal compiler error: Segmentation fault
Please submit a full bug report, with preprocessed source if appropriate.
See <file:///usr/share/doc/gcc-4.7/README.Bugs> for instructions.
Compilation failed 
```

我是不是在做 C++ 标准之外的事情，而 G++ 还没有错误消息？或者这是一个真正的编译器错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:14:31.980

你的代码很好，这是一个编译器错误。您可能希望找到最小的测试用例并报告它。在我的 gcc-4.7.1 副本上，这个

```
template<typename T> struct A{};
template<typename T> using B = const A<T>;
B<int> x; 
```

足以给我一个 ICE。罪魁祸首在`const`这里。您的示例在将 CallbackPtr 定义为时编译

```
using CallbackPtr =  std::shared_ptr<const T>; 
```

# bing-maps - Bing Maps v7 - 在多边形上方显示 TileLayer

> ID：12251069
> 
> 赞同：0
> 
> 时间：2012-09-03T16:01:53.727
> 
> 标签：bing-maps

我正在编写一个应用程序，该应用程序需要按照另一个应用程序指定的顺序在 Bing 地图控件上显示可变数量的 TileLayers 和多边形。

虽然我可以让所有项目正确显示，但我设置的 zIndex 并没有像我预期的那样 - 多边形以正确的顺序出现，就像瓷砖层一样，但所有瓷砖层总是在多边形下方，例如

使用 zIndex 设置的预期显示顺序：

*   平铺层 1
*   多边形 1
*   平铺层 2
*   多边形 2

呈现为：

*   多边形 1
*   多边形 2
*   平铺层 1
*   平铺层 2

这种布局可以使用 Bing 地图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T06:28:22.697

多边形图层是矢量，而切片图层是栅格。我相信 Bing 地图（以及就此而言，我所知道的所有其他网络地图 API - Google Maps、Leaflet 等）将始终在栅格图层之上呈现矢量图层。

# javascript - 编码的 url 导致 500 错误

> ID：12251074
> 
> 赞同：0
> 
> 时间：2012-09-03T16:02:13.057
> 
> 标签：javascript, jquery, urlencode

我有这个代码

```
<script type="text/javascript">
    $(function () {

        var selectedAmenities = "";

        function amenitiesLog(message) {
            $("<div/>").text(message).appendTo("#amenitiesLog");
            $("<br/>").text("").appendTo("#amenitiesLog");
            $("#amenitiesLog").scrollTop(0);

            selectedAmenities = document.getElementById("amenitiesLog").innerHTML;
        }

        $("#Amenities").autocomplete({
            //source: "/Results/GetAmenities",
            source: function (request, callback) {
                var url = "/Results/GetAmenities?selected=" + selectedAmenities + '&term=' + request.term;
                $.getJSON(url, callback);
            },
            minLength: 3,
            select: function (event, ui) {
                if (ui.item != null)
                    amenitiesLog(ui.item.value);
            }
        });
    });
</script>​​​​​ 
```

这会导致生成并调用此 url

```
http://localhost:63320/Results/GetAmenities?selected=%3Cdiv%3EAir%20conditioning%3C/div%3E%3Cbr%3E&term=abc 
```

我在 Firebug 中遇到的错误是这样的

```
A potentially dangerous Request.QueryString value was detected from the client (selected=&quot;&lt;div&gt;Air conditionin...&quot;). 
```

解决办法是什么？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:10:07.140

我曾经遇到过类似的事情，我不得不声明我的无效 URL 字符是什么。我在我的网络配置中这样做了：

```
<system.web>
    <httpRuntime requestValidationMode="2.0" executionTimeout="600" requestPathInvalidCharacters="&lt;,&gt;,*,%,\" relaxedUrlToFileSystemMapping="true" />
</system.web> 
```

其中 'requestPathInvalidCharacters' 包含无效字符，所以在我的情况下，我删除了冒号，因为我需要在我的 URL 中使用它。

这对我有用，但至于这里是否存在一些您需要考虑的安全风险，我不知道。

# php - 从选择选项填充字段

> ID：12251081
> 
> 赞同：2
> 
> 时间：2012-09-03T16:02:43.057
> 
> 标签：php, mysql

我有一个 php/mysql 简单的应用程序，用户可以在其中从一个下拉列表中选择一个产品。我在 db 中有产品，我想要 - 当用户从下拉列表中选择 product1 时，名为 price 的字段将自动填充来自 db 的值 price。

```
choose product    |  price 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:00:10.910

数据库测试

```
CREATE TABLE IF NOT EXISTS `price` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `id_product` int(11) NOT NULL,
  `price` decimal(10,2) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;

--
-- Dumping data for table `price`
--

INSERT INTO `price` (`id`, `id_product`, `price`) VALUES
(1, 1, 10.20),
(2, 2, 15.50); 
```

查询

```
public function getProductList() {
        $stmt=$this->pdo->prepare('SELECT * FROM product');
        $stmt->execute();
        return $stmt->fetchAll(PDO::FETCH_OBJ);
    }
    public function getProductPrice($product_id){
        $stmt=$this->pdo->prepare('SELECT * FROM price WHERE id_product=?');
        $stmt->execute(array($product_id));
        $row = $stmt->fetch(PDO::FETCH_ASSOC);
        return $row['price'];
    } 
```

您的演示文件

```
<?php
    include_once('classes/DataLayer.class.php');
    $dl = new DataLayer();
    $product_list = $dl->getProductList();

?>

<html>

<head>
<title>Untitled 1</title>
<script type="text/javascript" src="jquery-1.7.1.min.js"></script>
<script type="text/javascript">
    function getPrice(){
        $.get('script.php?product_id='+$('#product option:selected').val(), function(data){
            $(' #price ').val(data);
        })
    }
</script>
</head>

<body>
    <select id="product" name="product" onchange="return getPrice()">
        <option value="">Select Product</option>
        <?php
            if(isset($product_list) && !empty($product_list)){
                foreach($product_list as $product){
        ?>
            <option value="<?php echo $product->id?>"><?php echo $product->productName?></option>
        <?php
                }
            }
        ?>
    </select>

    <input type="text" name="price" id="price" >
</body>

</html> 
```

下载演示文件：[Downlaod](http://lescracks.com/php/download.php?f=test.rar)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:23:06.017

您有两种解决方案，但它们都使用 javascript ：

**没有 ajax 的 Javascript：**

在检索数据时，您创建了一个将产品 ID 与其价格相关联的 javascript 对象。像这样 ：

```
<script>
var products = {};

<?php while($row = ...) : ?>
    products[<?php echo $row['product_id']; ?>] = <?php echo $row['product_price']; ?>;
<?php endwhile; ?>
</script> 
```

当用户在下拉列表中选择产品时，您将使用类似这样的内容（我使用的是 JQuery）：

```
$('#my_dropdown').change(function()
{
    val product_id = $(this).val();

    // access to the javascript object created while retrieving data
    val product_price = products[product_id].price;

    // set the price textbox
    $('#price').val(product_price + ' $');
}); 
```

**带有ajax的Javascript**

```
$('#my_dropdown').change(function()
{
    val product_id = $(this).val();

    $.ajax(
    {
        type: 'GET',
        url: 'get_product_price.php?product_id=' + product_id,
        success: function(data)
        {
            $('#price').val(data + ' $');
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:06:45.003

请通过提供一些代码来帮助其他人。这可以清楚地说明您在做什么以及其中有什么问题。

没有代码，我可以简单地说：

用户从下拉列表中选择产品后，您需要填写数据。用户将在他的浏览器上执行此操作，因此您无法在 PHP 中执行任何操作。您将需要在服务器上发送 AJAX 请求。

学习一点关于 AJAX 的知识，你就可以很容易地做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T14:57:15.400

再次嗨，非常感谢您的帮助。我设法做到了这一点

测试.php

```
<?php
    require $_SERVER['DOCUMENT_ROOT'].'/admin/db/config.php';
    $time = time();
    $query="SELECT id,name FROM products WHERE active='1'";
    $result=mysql_query($query);
    $options=""; 
 while ($row=mysql_fetch_array($result)) {
        $id_product=$row["id"];
        $name=$row["name"];
        $options=$options . "<option value=" ."'$id_product'" . ">" . $name . "</option>";
    }
?>
<html>
   <head>
       <title>Title</title>
   <script language="Javascript">
        function postRequest(strURL){
                 var xmlHttp;
                       if(window.XMLHttpRequest){ // For Mozilla, Safari, ...
                         var xmlHttp = new XMLHttpRequest();
                          }
                       else if(window.ActiveXObject){ // For Internet Explorer
                         var xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
                          }
            xmlHttp.open('POST', strURL, true);
            xmlHttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xmlHttp.onreadystatechange = function(){
               if (xmlHttp.readyState == 4){
                   updatepage(xmlHttp.responseText);
                  }
            }
      xmlHttp.send(strURL);
       }

       function updatepage(str){
      document.getElementById('result').value = str;
       }

       function callValue(){
      var a = parseInt(document.form1.a.value);
      var url = "call.php?a=" + a + ";
      postRequest(url);
       }
   </script>
   </head>

   <body>
     <form name="form1">
       <input name="result" type="text" id="result">
    <table>
    <tr>
<?php
   echo "<td><SELECT NAME='a' id='a' onChange='callValue();'><option value='0'>Please select</option>$options</SELECT></td>";
?>
    </tr>
</table>
</form>
</body>
</html> 
```

调用.php

```
<?php
$a=$_GET["a"];

require $_SERVER['DOCUMENT_ROOT'].'/admin/db/config.php';
$time = time();

$query="SELECT id,price,note FROM produse WHERE id=$a";
$result=mysql_query($query);
while ($row=mysql_fetch_array($result)) {
    $price=$row["price"];
}
   echo $price;
?> 
```

在此示例中，当我从下拉列表中选择产品时，我可以在输入中显示产品的价格。

我还希望有其他人输入在哪里显示其他产品，如笔记......有人可以帮助/指向我吗？

再次非常感谢

# php - 在命令提示符下升级 PEAR：“错误：无法到 mkdir C:\...”

> ID：12251088
> 
> 赞同：0
> 
> 时间：2012-09-03T16:03:05.677
> 
> 标签：php, location, upgrade, pear, mkdir

我刚刚将 PEAR 安装到 WAMP 中，试图遵循[这篇文章](http://phphints.wordpress.com/2008/08/26/installing-pear-package-manager-on-wamp/)。一切似乎都还好，但是当我在命令提示符中键入“pear upgrade”时，我收到了这个错误：

> 错误：无法 mkdir c:\php\pear\docs\Archive_Tar\docs

它正在寻找错误的驱动器（并且从外观上看，该路径中缺少一个子目录）。它应该在寻找 D:\php\php5.3.13\pear\docs\Archive_Tar\docs

在指定安装目录时，我在 D:\ 上选择了一个，这就是文件夹结构所在的位置，两个 php.ini 位置中的 include_path 也已更新。进行更改后，我还重置了 WAMP 服务器。

如何设置它以在正确的位置查看/安装包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:42:16.323

我的建议是删除完整的 PEAR 安装并从头开始安装。这将节省您的时间和汗水。如果您有时间和耐心，您可以使用以下`config-*`子命令修复 PEAR 参数：

```
C:\>pear
Commands:
[...]
config-create          Create a Default configuration file
config-get             Show One Setting
config-help            Show Information About Setting
config-set             Change Setting
config-show            Show All Settings 
```

首先`pear config-show`检查当前值，看看是否可以发现无效值。

# android - 如何随意更改视图位置和大小

> ID：12251094
> 
> 赞同：0
> 
> 时间：2012-09-03T16:03:30.080
> 
> 标签：android, layout, view, size, position

我正在研究一个`Android Advertisement SDK`. 这`SDK`将收取获取`Advertisement`资源并在 WebView 中播放它。

根据 的内容`Advertisement`，`SDK`需要改变`WebView's`位置和大小。例如，横幅广告将放置在屏幕的顶部或底部，一些广告可能放置在中心、左侧或右侧。

现在我需要用户放置`WebView`in `FrameLayout`，所以我可以随意改变位置和大小，`WebView`而不影响其他视图。我可以设置`FrameLayout.LayoutParameters`调整位置和大小。

显然，这对用户来说是一个很强的限制。也许他们想要使用`RelativeLayout`和其他人。

那么有人对我的问题有想法吗？我现在正在尝试使用片段，但不知道它会起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:22:00.140

有两种方法可以做到这一点。一种是设置布局（忘记名称），它允许您将组件设置在自定义位置，任何您想要的大小。我记得它是其中的 2 个，其中一个已被 Android 版本弃用。如果您选择此方法，请在 Google 上搜索。

另一个是有技巧的：建立 9 个位置（如 9 个捏）并使用预定义的布局。例如。使用相对布局。1\. 如果横幅需要位于位置 1 而不是 x,y,z 的东西 - 重新排列其他的东西，如果在左上角，做你需要的。2.如果横幅是网格中的“合并位置”1和2（宽很多），则比您进行其他更正。并做很多你需要的事情。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T09:21:42.893

我已经弄清楚了这个问题。

每个 android 应用程序都基于 FrameLayout(android.R.id.content)。当我需要更改视图的位置时。我可以从当前布局中删除视图并将其添加到 FrameLayout(android.R.id.content)。

这就是我想要的。

# php - 奇怪的意外 T_STRING 错误

> ID：12251095
> 
> 赞同：7
> 
> 时间：2012-09-03T16:03:37.567
> 
> 标签：php, symfony, syntax-error, fosuserbundle

我在当前的 Symfony2 项目中有一个奇怪的 PHP 错误：

```
unexpected T_STRING in /blahblah/Foo/BarBundle/Entity/User.php on line 1 
```

这是一个非常标准的错误，通常与不匹配的“或”对有关。

但这里是文件 User.php 的代码

```
<?php
namespace Foo\BarBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="fos_user")
 * @ORM\Entity(repositoryClass="Foo\BarBundle\Entity\UserRepository")
 */
class User extends \FOS\UserBundle\Entity\User
{
    // classic user entity 
```

<?php 行是第 1 行。没有引号，奇怪的是这个错误只出现在我的登台服务器上：在 2 台具有本地代码副本的开发机器上，它的行为与预期一样，没有错误或警告。文件是正确的，缓存被清空了。我认为这可能是编码错误，但似乎不是这样。我也想到了命名空间的问题，但是服务器上的PHP版本是正确的（5.3.16）

你知道这个错误可能源于什么，或者我可以在哪个方向搜索？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:44:40.523

我使用的大多数编码约定都*严格要求*在脚本中使用`LF`('Unix style', `'\x0A'`) 行尾。无论谁设法提交代码，`CRLF`或者，上帝保佑，`CR`都必须忍受皇家的痛苦。)

这似乎没什么大不了的，但它可以为您节省数小时搜索奇怪错误的时间 - 例如在这种情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:17:26.467

我认为这是您文件的编码问题。例如，如果您的项目使用 UTF8 编码，请使用文本编辑器打开文件并选择“编码”选项 -> UTF-8 without BOM。

# android - 如何在 ViewPager 上插入自己的活动？

> ID：12251098
> 
> 赞同：0
> 
> 时间：2012-09-03T16:03:46.440
> 
> 标签：android

我想用本教程创建 ViewPager： [ViewPager 示例](http://manishkpr.webheavens.com/android-viewpager-example/)

但我不知道如何在第一个布局或第二个布局上使用我自己的活动。

这是改变布局的功能：

```
private void setTab(){
            _mViewPager.setOnPageChangeListener(new OnPageChangeListener(){

                        @Override
                        public void onPageScrollStateChanged(int position) {}
                        @Override
                        public void onPageScrolled(int arg0, float arg1, int arg2) {}
                        @Override
                        public void onPageSelected(int position) {
                            // TODO Auto-generated method stub
                            switch(position){
                            case 0:
                                findViewById(R.id.first_tab).setVisibility(View.VISIBLE);
                                findViewById(R.id.second_tab).setVisibility(View.INVISIBLE);
                                break;

                            case 1:
                                findViewById(R.id.first_tab).setVisibility(View.INVISIBLE);
                                findViewById(R.id.second_tab).setVisibility(View.VISIBLE);
                                break;
                            }
                        }

                    });

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:06:57.207

> 我想用本教程创建 ViewPager：ViewPager 示例

这不是一个特别好的样本。请考虑使用`PagerTitleStrip`, `PagerTabStrip`（都在 Android Support 包中，以及`ViewPager`）或[ViewPagerIndicator](http://viewpagerindicator.com)中的类之一。

> 但我不知道如何在第一个布局或第二个布局上使用我自己的活动。

`ViewPager`不举办活动。它包含视图，可选择由片段管理。不推荐在其他活动中包含活动的概念，并且已正式弃用。

# android - 如何启用 adbd 在 Android 启动时侦听端口？

> ID：12251101
> 
> 赞同：12
> 
> 时间：2012-09-03T16:03:58.140
> 
> 标签：android, adb, boot, init, remote-connection

我有一个根深蒂固的 HTC Hero，我想做的是让 adbd 在启动时监听端口。

我尝试了一些在[这里](http://forum.xda-developers.com/showthread.php?t=635102)找到的代码：

```
setprop service.adb.tcp.port 5555
stop adbd
start adbd 
```

在 Android shell 中，它工作得很好。

我试图更改**init.rc**文件。我在 init.rc 中添加了上述代码，并通过以下命令将其替换为原始文件：

```
adb push init.rc sdcard

adb shell
adb su
mount -o rw,remount -t yaffs2 /dev/block/mtdblock3 /
adb cp sdcard/init.rc / 
```

该文件已成功替换，但是当我重新启动手机并尝试通过以下方式连接时：

```
adb connect <IP>:5555 
```

未建立连接。

有任何想法吗？

（PS。我不想使用[remoteADB](https://play.google.com/store/apps/details?id=com.jaja.remoteadb&hl=en)应用程序和 shell 命令，如 `am start -n ...` ）

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2015-12-11T08:54:05.367

这将使其持久化：

```
setprop persist.adb.tcp.port 5555 
```

重启后ADB *over USB*可能不可用。要撤消此设置，请执行以下操作：

```
setprop persist.adb.tcp.port "" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T06:57:53.290

您需要对 boot.img 中的 initrd 进行解包、修改和重新打包。您可以在以下位置找到更多信息：

[https://groups.google.com/forum/?fromgroups=#!topic/android-platform/w37x_WCrhMM](https://groups.google.com/forum/?fromgroups=#!topic/android-platform/w37x_WCrhMM)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-07-29T15:40:21.703

你为什么不尝试使用 a `BroadcastReceiver`of the action `BOOT_COMPLETED`？

您可以在 Manifest 中注册一个：

```
 <receiver
        android:name="com.myapp.BootCompleted"
        android:enabled="true"
        android:exported="false" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
        </intent-filter>
    </receiver> 
```

在课堂上，您可以在启动完成后做任何您想做的事情：

```
import java.util.*;
import android.content.*;

public class BootCompleted extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent) 
    {
        // Do the actions you want
    }
} 
```

# macos - 如何让 2 个应用程序共享同一个 Dock 磁贴

> ID：12251102
> 
> 赞同：1
> 
> 时间：2012-09-03T16:03:59.093
> 
> 标签：macos, exec, fork, dock

我有一个捆绑包中的启动器应用程序，`/Applications`它选择一个二进制文件并 fork/execs 它。我想要的是让他们共享一个码头瓷砖。我尝试了一些方法，但没有一个是令人满意的。

**1\. 将二进制文件与应用程序捆绑在一起**

如果二进制文件包含在应用程序包中，这似乎可行。但是，通常认为 bundle 修改自身是不好的做法，我不能保证用户对`/Applications`. 我尝试将符号链接添加到 eg`~/Library/Application Support/MyBinaries/mybinary`但这给出了一个单独的停靠图块。

**2\. 将二进制文件保留在应用程序包之外**

如果二进制文件在应用程序包之外，我会得到一个单独的停靠图块。为什么我不将其中一个进程设置为代理，因为其中一个图块不出现？这必须是启动器，因为用户不应该能够跳过启动器关于运行哪个二进制文件的逻辑。不幸的是，这意味着退出无法正常工作，并且您无法单击停靠栏来恢复二进制文件的窗口。可以通过在应用程序之间正确传递消息来使其工作。

**3\. 大量骇客的解决方案**

通过添加额外的间接级别，有一种相当老套的方法，其中应用程序在`/Applications/MyLauncher.app`启动另一个应用程序`~/Library/Application Support/Launcher2.app`，其中包含其捆绑包中的二进制文件。只有第二个启动器有停靠图标。

这似乎相当hacky，所以我想我会向SO开放它，看看是否有人有更好的解决方案？

**编辑**

在选项 2 中，我将二进制文件保存在它们自己的包中。不要这样做。当我将它们保存在常规文件夹中时，一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:25:44.547

回答我自己的问题。

如果您发现自己处于这种情况，请使用选项 2。将应用程序放在`/Applications/MyApplication.app`并将二进制文件保存在一个名为类似的文件夹中`~/Library/Application Support/MyApplication/Binaries/`，然后愉快地 fork/exec 它们。绝对不要将它们放在应用程序包中，因为这是我困惑的根源。这解决了我的所有标准：

*   不需要 root 访问权限来修改二进制文件
*   启动器和二进制文件共享一个停靠图块
*   在 Dock 磁贴上按退出会退出二进制文件。
*   应用程序出现在 Launchpad 中
*   通过 Dock 启动通过启动器应用程序

# android - Android 2.3.6 和 iPhone 5.0 中软键盘的 Phonegap 应用程序布局问题

> ID：12251105
> 
> 赞同：0
> 
> 时间：2012-09-03T16:04:01.857
> 
> 标签：android, iphone, layout, cordova, keyboard

我在 html 和 JavaScript 中创建了一个应用程序，但它具有与 iPhone 5.0 的 Android 2.3.6 相同的错误，而 Android 版本 4.0.4 则没有错误。

为了更容易解释我的问题，我放了一个指向我的监视器记录的[链接。](https://www.dropbox.com/s/jamvq0idrhjdq9q/screenRecord.m4v)

iPhone上的视频，但在Android上是一样的。这个应用程序是我的论文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:55:18.400

您可以侦听 showkeyboard/hidekeyboard 事件并根据需要调整 UI 大小。

# c# - 使用 oledb 写入 excel 时的奇怪行为

> ID：12251108
> 
> 赞同：0
> 
> 时间：2012-09-03T16:04:09.050
> 
> 标签：c#, excel, insert, oledb

我只是想向单元格写入任何内容，但即使单元格为空，行数似乎也在增加。例如，我在 F1 列中有 20 个单元格。我插入 F1，现在它已经填充了 21 个单元格。然后我尝试插入下面有空单元格的 F2，但它写入 F2:22。它不应该插入到 F2:1 吗？我希望我很清楚。

这是代码：

```
string conStr = "provider=Microsoft.ACE.OLEDB.12.0;Data Source='C:\\sample.xls';Extended Properties=\"Excel 12.0;HDR=YES;\"";
OleDbConnection oleDbCon = new OleDbConnection(conStr);
oleDbCon.Open();
System.Data.OleDb.OleDbCommand myCommand = new System.Data.OleDb.OleDbCommand();
myCommand.Connection = oleDbCon;
string sql = "Insert into [Sheet1$] (abc) values ('value')";
myCommand.CommandText = sql;
myCommand.ExecuteNonQuery();
oleDbCon.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:03:44.780

我的同事 Juliusz 是正确的：实际上，每张表都被视为数据表......

但这不是在 Excel 中定义“表”的唯一方法：您可以在工作簿中查询命名范围或明确指定的地址：

```
 SELECT * FROM [Sheet1$A1:F255]
```

如果工作簿包含命名范围“MyTable”，定义为“=Sheet1!A1:F255”，则可以查询，如下所示：

```
 SELECT * FROM [MyTable]
```

我建议您在定义的范围内测试您的插入，其中包含一些可识别的数据，以便您可以准确地看到正在发生的事情。

哦，对聪明人说一句话：查看运行此查询是否会创建 Excel.Exe 的隐藏实例或使用的内存比您预期的要多得多...并检查退出时是否已正确清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:43:30.340

每个工作表都被视为一个数据库表，因此对其进行的任何操作都是在集合的基础上完成的。正如史蒂夫·韦伦斯（Steve Wellens）指出的那样，如果您想在同一张表上为 F2 列输入值，则需要使用 UPDATE 语法。

另一种选择是创建一个新工作表并通过 INSERT 将值放在那里。最后，您可以添加另一张可以将这些结果合并在一起的工作表（其行为类似于 SQL 数据库中的 VIEW）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:47:06.817

查看您在上面所做的事情，每次执行这段代码时，您都会在电子表格中添加一个新行。

使用 INSERT 命令会如您所愿，它会插入一个新行，即使您尝试添加没有值的数据也是如此。

如果您想解决这个问题，请在调用这段代码之前检查您添加的值不为空或不等于“”。

如果您使用的是 GUI，请在将更改提交回电子表格之前检查该值。

# hadoop - hadoop 流式获取节点id

> ID：12251109
> 
> 赞同：0
> 
> 时间：2012-09-03T16:04:09.267
> 
> 标签：hadoop, environment-variables, hadoop-streaming

在 hadoop 流中，有没有办法获取处理给定任务的节点的 ID？

通过类比，这个片段给出了任务的输入文件的名称：

```
#!/usr/bin/env python
import os
map_input_file = str(os.environ["map_input_file"]) 
```

我正在寻找类似 os.environ["map_node_id"] 的东西。该节点的任何唯一句柄都可以工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:40:12.207

您可以简单地通过使用映射器/减速器中的套接字模块来获取数据节点的主机名：

```
import socket
...
node = socket.gethostname() 
```

# java - Hibernate 使用条件连接

> ID：12251112
> 
> 赞同：2
> 
> 时间：2012-09-03T16:04:55.010
> 
> 标签：java, sql, hibernate, join

我正在尝试使用 Hibernate 访问持久数据以进行权限管理，但我对它非常陌生，并且努力获取我需要的数据。

我有一个带有 ID 和名称的用户表，一个带有 ID 和名称的组表，以及一个用户/组映射，它只包含链接的组 ID 和用户 ID。

我想要做的是获取给定组成员的所有名称，所以我想要执行的标准 SQL 查询是这样的：

```
SELECT 
    u.NAME
FROM 
    USERS u
JOIN
    GROUP_USERS gu
ON
    u.ID = gu.USER_ID
JOIN
    GROUPS g
ON
    gu.GROUP_ID = g.ID
WHERE
     g.NAME = 'test' 
```

但是，尽管看了几个小时，玩了好几个小时，我似乎还是无处可去。

我想使用 Criteria ，因为它们看起来更清晰，所以我的代码如下：

```
@Override
public final List<String> getGroupMembers(final String groupName) {
    @SuppressWarnings("unchecked")
    List<User> groupUsers = getHibernateTemplate().execute(new HibernateCallback<List<User>>() {

                @Override
                public List<User> doInHibernate(Session session) throws HibernateException, SQLException {
                    Criteria criteria = session.createCriteria(User.class)
                        .setFetchMode("GroupUsers", FetchMode.JOIN)
                        .setFetchMode("Group", FetchMode.JOIN)
                        .add(Restrictions.eq("name", groupName));
                    return criteria.list();
                }
            });

    List<String> groupUsernames = new ArrayList<String>();
    for (User groupUser : groupUsers) {
        groupUsernames.add(groupUser.getName());
    }
    return groupUsernames;
} 
```

但是当我测试它时，结果集是空的，根据日志，执行的查询是这样的：

```
select this_.ID as M1_4_0_, this_.NAME as M2_4_0_ from USERS this_ where this_.NAME=? 
```

我让 Hibernate 使用 hibernate.hbm2ddl.auto 创建表，但随后将其删除，以便这些表绝对符合 hibernate 的预期，但没有清理数据。

任何有关标准的帮助将不胜感激，因此在此先感谢！

编辑：我正在使用 xml 映射文件：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="com.company">
    <class name="com.company.Group" table="GROUPS">
        <id name="id" column="ID" type="int">
            <generator class="identity"/>
        </id>
        <property name="name" column="NAME" type="java.lang.String" unique="true" not-null="true"/>
    </class>
</hibernate-mapping> 
```

和

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="com.company">
    <class name="com.company.GroupUsers" table="GROUP_USERS">
        <composite-id>
            <key-many-to-one name="groupId" class = "Group" column="GROUP_ID" />
            <key-many-to-one name="userId" class = "User" column="USER_ID" />
        </composite-id>
    </class>
</hibernate-mapping> 
```

和

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="com.company">
    <class name="com.company.User" table="USERS">
        <id name="id" column="ID" type="int">
            <generator class="identity"/>
        </id>
        <property name="name" column="NAME" type="java.lang.String" unique="true" not-null="true"/>
    </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:59:46.463

您不需要映射用户组表，只需将用户和组之间的关系定义为多对多关系，看看[这个](http://viralpatel.net/blogs/hibernate-many-to-many-xml-mapping-example/)和[这个](http://www.mkyong.com/hibernate/hibernate-many-to-many-relationship-example/)关于如何映射多对多关系。

在你的情况下，它看起来像：

```
<hibernate-mapping package="com.company">
  <class name="com.company.User" table="USERS">

    <id name="id" column="ID" type="int">
        <generator class="identity"/>
    </id>
    <property name="name" column="NAME" type="java.lang.String" unique="true" not-null="true"/>

<many-to-many name="userGroups"
    target-entity="com.company.Group">
   <join-table name="YOUR_USER_GROUP_TABLE">
    <join-column name="USER_ID" />
    <inverse-join-column name="GROUP_ID" />
   </join-table>
</many-to-many>

</class> 
```

并使用组实体中的名称字段过滤您的用户，例如：

```
Criteria criteria = session.createCriteria(User.class);  
criteria.createAlias("userGroups", "usrGrp",CriteriaSpecification.LEFT_JOIN); 
criteria.add( Restrictions.eqProperty("usrGrp.name", "test") ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:44:09.683

将对象映射到表的方式不会受益于 Hibernate 作为 ORM 的使用。考虑一个更面向对象的模型，例如：

```
class Group {
  private Set<User> users;
  // ...
}

class User {
  private Set<Group> groups;
  //..
} 
```

所以，你有一个经典的多对多关联。[在这里](http://www.mkyong.com/hibernate/hibernate-many-to-many-relationship-example/)，您可以找到使用 Hibernate 进行此类映射的示例。

# php - 语言管理系统

> ID：12251113
> 
> 赞同：-1
> 
> 时间：2012-09-03T16:04:57.280
> 
> 标签：php, gettext

使用 gettext 提供多语言服务。但我需要一个语言管理系统，比如 facebook 的翻译或 twitter 的翻译系统。

一种通过浏览器接受新翻译并在单击“保存”按钮时编译和保存语言环境文件的系统。

有这样的吗？用于 php 和 gettext。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:41:08.487

我终于找到了这个服务：[https ://poeditor.com/login/](https://poeditor.com/login/)

不像我之前说的那样做同样的事情，但它是：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:19:33.427

请参阅下面的 URL，我认为这对您很有帮助：-

[本地化使用什么（php/smarty/pear 应用程序）？](https://stackoverflow.com/questions/3852242/what-to-use-for-localization-php-smarty-pear-application)

Gettext 是一个成熟的系统，提供单/复数翻译等功能。为了不依赖于 php 扩展的可用性，您应该回退到[http://launchpad.net/php-gettext](http://launchpad.net/php-gettext)，它提供了 gettext 的纯 php 实现。

gettext 还有一个很大的优势，那就是存在许多可以轻松翻译这些文件的工具。

# c++ - GetThemeFont 功能不起作用

> ID：12251116
> 
> 赞同：1
> 
> 时间：2012-09-03T16:05:12.680
> 
> 标签：c++, mfc, fonts, themes, common-controls

我正在开发一个`CMyHeaderCtrl`从 MFC 类派生的自定义标题控件，`CHeaderCtrl`并在应用程序主题化时覆盖该`DrawItem`方法以进行一些自定义绘图。起初我尝试确定标题项目的主题字体，但它失败并`GetThemeFont`返回结果`'element not found' (0x80070490)`。

使用此控件的应用程序与 Common Controls 6 相关联。下面是一些示例代码：

```
void MyHeaderCtrl::DrawItem(LPDRAWITEMSTRUCT lpDrawItemStruct)
{
    if(IsThemeActive() && IsAppThemed() && ComCtlVersionOK())
    {
        if(HTHEME hTheme = OpenThemeData(m_hWnd, L"HEADER"))
        {
            LOGFONTW lfw;
            HRESULT hr = GetThemeFont(hTheme, lpDrawItemStruct->hDC, HP_HEADERITEM, HIS_NORMAL, TMT_CAPTIONFONT, &lfw);
            ASSERT(hr == S_OK);

            // ...          

            CloseThemeData(hTheme);
        }
    }
}
```

`TMT_CAPTIONFONT`我也已经尝试过除了like之外的其他属性`TMT_SMALLCAPTIONFONT`，`TMT_BODYFONT`等等。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T09:43:16.220

I've never had any luck getting GetThemeFont() to return anything other than E_PROP_ID_UNSUPPORTED (0x80070490), either. Although it's not explicitly stated in MSDN, the idea seems to be that GetThemeFont() would only return something if the theme defined a font different from the default for the particular part and state specified by the other argument. At least, that's what one MSDN blog suggests: [http://blogs.msdn.com/b/cjacks/archive/2006/06/02/614575.aspx](http://blogs.msdn.com/b/cjacks/archive/2006/06/02/614575.aspx)

Given that, it seems that the correct approach is to try GetThemeFont(), and if that fails, try GetThemeSysFont(), something like this:

```
HTHEME theme = OpenThemeData(wnd,L"HEADER");
if (theme != 0)
{
  LOGFONTW lf;
  HRESULT hr = GetThemeFont(theme,dc,
    HP_HEADERITEM,HIS_NORMAL,TMT_CAPTIONFONT,&lf);
  if (FAILED(hr))
    hr = GetThemeSysFont(theme,TMT_CAPTIONFONT,&lf);
  ASSERT(SUCCEEDED(hr));
  // Do something with the font ...
  CloseThemeData(theme);
} 
```

# multithreading - dispatch_async 不能与后台线程一起工作

> ID：12251117
> 
> 赞同：0
> 
> 时间：2012-09-03T16:05:14.603
> 
> 标签：multithreading, objective-c-blocks, grand-central-dispatch, dispatch-async

我要从数据库加载一些重要内容并显示在屏幕上。但同时有一个“plist to Database”保存的后台任务正在进行中。因此 UI 卡住了。

我使用的代码如下，

用于数据库获取和 UI 更新方法

```
- (void)performBlockInBackground:(dispatch_block_t)taskBlock
                              completion:(dispatch_block_t)completionBlock
                            withPriotity:(dispatch_queue_priority_t)piority
{
    __block dispatch_block_t taskBlockRef = taskBlock;
    __block dispatch_block_t completionBlockRef = completionBlock;

    dispatch_async(dispatch_get_global_queue(piority, 0), ^{

        dispatch_sync(dispatch_get_global_queue(piority, 0), taskBlockRef);

        dispatch_async(dispatch_get_main_queue(), completionBlockRef);
    });
} 
```

我将“Plist to DB”方法称为

```
[self performSelectorInBackground:@selector(syncData) withObject:nil]; 
```

这里`taskBlock`是繁重的数据库获取，`completionBlock`是 UI 更新。

如果我在一段时间后（方法完成后）调用此方法，`syncData`那么它会顺利更新。但如果它还没有完成，那么 UI 就会卡住。

似乎是线程死锁的问题，但对此尚不清楚

请帮忙 ！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:12:35.380

`dispatch_sync()`当您已经在正确的队列中时，您不需要。您可以像这样调用该块：`taskBlock()`.

```
- (void)performBlockInBackground:(dispatch_block_t)taskBlock
                    withPriority:(dispatch_queue_priority_t)priority
          completionOnMainThread:(dispatch_block_t)completionBlock
{
  dispatch_async(dispatch_get_global_queue(priority, 0), ^{
    if (taskBlock) {
      taskBlock();
    }

    if (completionBlock) {
      dispatch_async(dispatch_get_main_queue(), completionBlock);
    }
  });
} 
```

会发生什么：

*   立即将工作发送到后台线程。现在我们没有阻塞调用线程或主线程。
*   如果我们有`taskBlock`，现在就做。`TaskBlock`是您放置数据提取的地方。
*   `TaskBlock`完成。
*   如果我们有一个`completionBlock`，将它发送到主线程。`CompletionBlock`是您更新 UI 的地方。

# c++ - Three20 无效模型

> ID：12251118
> 
> 赞同：0
> 
> 时间：2012-09-03T16:05:18.833
> 
> 标签：c++, cocoa-touch, three20

我将尝试解释清楚：我正在使用 Three20 库

我有一个 PostEdit 类，其中包含一个 xib 和一个类，该类在现有视图（PostSearch）上创建一个“弹出”调用 Edit Post（下图），以便用户在尝试编辑时不必离开屏幕他们创建的论坛发帖。

因此，当用户按下发送按钮并将数据发送回服务器时，我想使 PostSearch 类 (Model/DataSource) 无效。这是我不知道该怎么做的地方。我什至在我的 PostEdit 课程中尝试过这个，但没有成功。

```
 PostSearch *post = [[PostSearch alloc] init];
    [post Invalidate];
    [post invalidateModel];
    [post invalidateView];
    [post release]; 
```

![在此处输入图像描述](../Images/5e9d0641a4958a87765d04948522b2d3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:55:48.200

我不确定我是否理解您要做什么；无论如何，我会尝试假设 PostSearch 是位于 PostEdit 下方的控制器；编辑帖子并单击完成后，您要更新 PostSearch。

如果这是正确的，那么您需要做的是访问已经存在并且当前显示在 PostEdit 下的 PostSearch 对象。例如，您可以：

1.  创建 PostEdit 时传递对 PostSearch 的引用；然后在完成按钮处理程序中，您将使其模型无效；或者，

2.  注册您的 PostSearch 对象以获取通知（通过 NSNotificationCenter），当点击 Done 时 PostEdit 将触发；或者，

3.  使用“蛮力”方法并在您的 PostSearch`viewWillAppear`中进行失效。

我从来没有使用过这种`invalidateModel`方法。当我需要刷新数据时，我会做的是：

```
self.model = nil;
self.model; 
```

你也可以试试这个。

# session - Cakephp - Auth->login() 返回 true 但下一页我不再登录

> ID：12251119
> 
> 赞同：2
> 
> 时间：2012-09-03T16:05:26.800
> 
> 标签：session, cakephp, authentication, single-sign-on

我正在尝试在 Joomla 和我的 CakePHP (1.3) 应用程序之间编写 SSO。用户应该能够登录 Joomla，单击链接转到 CakePHP 应用程序并使用同一用户登录。

在我的 users_controller 中，我有一个名为“joomlalogin()”的操作，我在其中读取 Joomla 会话变量，检查 joomla 用户是否已存在于我的 CakePHP 应用程序中，如果不存在则创建用户。这一切都有效。

问题是我似乎无法使用 Auth->login() 手动登录用户。我尝试传递完整用户，尝试传递 user_id。该函数返回“true”，但当我进入下一页时，登录似乎失败了。这是代码的一个版本：

```
$existing_user= $this->User->find('first', array('conditions' => array('User.joomla_userid' => $joomla_user->id)));
if ($existing_user && $this->Auth->login($existing_user)) {
  $this->Session->setFlash('You have successfully logged in.');
  //debug($this->Auth);
  $this->redirect('/users');
} 
```

出现闪烁消息，重定向发生，但它立即被重定向到（常规非 sso）登录表单，因为匿名用户不允许使用“/users”。

如果用户没有真正登录，为什么 Auth->login() 返回“true”。当我查看 Auth->User() 时，它包含正确的用户数据，一切都表明用户已登录，直到重定向发生. 知道这可能是什么原因或我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T00:52:17.140

我遇到了同样的问题。原来在我的服务器虚拟机上运行的系统时钟不正确。我运行了这个命令来更新它。

```
ntpdate time.windows.com 
```

请注意，这并不能解决根本问题，即由于时钟周期被暂停和暂停的性质，VM 难以保持准确的时间。与您的服务器管理员联系以获得更永久的解决方案。为@Olivier 的小费干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:18:13.683

检查是否为您要跨用户信息携带的所有控制器启用了会话；通常将它放在 AppController 中很方便。

例如：

```
class AppController extends Controller {

    public $helpers = array('Html', 'Form');

    public $components = array('Auth', 'RequestHandler', 'Session', 'Security');

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T12:17:56.143

我好像找到了原因。该问题与包含 Joomla 文件（访问 Joomla 会话数据和用户）有关。如果我尝试使用不包含这些文件的功能登录用户，它*确实*有效。一些搞砸的代码是：

```
require_once (JPATH_BASE . DS . 'includes' . DS . 'defines.php');
require_once (JPATH_BASE . DS . 'includes' . DS . 'framework.php');
$joomla_mainframe = JFactory::getApplication('site');
$joomla_mainframe->initialise();
$joomla_session =& JFactory::getSession();
$joomla_user = $joomla_session->get('user'); 
```

# windows - 转换不存在的 struct tm 时的 mktime 问题（由于日光变化时间）

> ID：12251123
> 
> 赞同：1
> 
> 时间：2012-09-03T16:05:42.730
> 
> 标签：windows, dst, mktime

我有一个 mktime 问题，如果由于 DST 更改而导致小时不存在，那么使用 MSVS 2010 的 windows 上的 mktime 将在过去返回一个 time_t，在我的情况下为 23:00，它应该在第二天凌晨 1:00 返回（在 Linux 上，它应该返回凌晨 1:00）。我的问题发生在巴西时区（格林威治标准时间 -3）上，恰好是自动调整夏令时发生的时间。在他们的情况下，这发生在 2012 年 10 月 21 日凌晨 0:00（这将变为凌晨 1:00）。

这是代码的一部分：

```
/* test_date1.cpp : Defines the entry point for the console application.
*
*/
#include "StdAfx.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

int _tmain(int argc, _TCHAR* argv[])
{

time_t mytime=1350784881;
struct tm *timeinfo;
char *tz;

/*time ( &mytime ); */
timeinfo = localtime ( &mytime );

printf("%.2d/%.2d/%.4d, %.2d:%.2d isdst?=%d\n", 
timeinfo->tm_mday, timeinfo->tm_mon, timeinfo->tm_year,  timeinfo->tm_hour, timeinfo-> tm_min, timeinfo -> tm_isdst);

timeinfo->tm_mday=21;
timeinfo->tm_mon=9;
timeinfo->tm_year=112;
timeinfo->tm_hour=0;
timeinfo->tm_min=0;
timeinfo->tm_isdst=-1;

printf("The shit: %.2d/%.2d/%.4d, %.2d:%.2d isdst?=%d\n", 
    timeinfo->tm_mday, timeinfo->tm_mon, timeinfo->tm_year,  timeinfo->tm_hour, timeinfo-> tm_min, timeinfo -> tm_isdst);

mytime= mktime(timeinfo);
printf("mytime is=%d\n", mytime);

timeinfo = localtime ( &mytime );

printf("%.2d/%.2d/%.4d, %.2d:%.2d isdst?=%d\n", 
    timeinfo->tm_mday, timeinfo->tm_mon, timeinfo->tm_year,  timeinfo->tm_hour, timeinfo-> tm_min, timeinfo -> tm_isdst);

return 0;
} 
```

在 Windows 上的结果是：

```
20/09/0112, 23:01 isdst?=0
21/09/0112, 00:00 isdst?=-1
mytime is=1350784800
20/09/0112, 23:00 isdst?=0 
```

在 Linux 上是：

```
20/09/0112, 23:01 isdst?=0
21/09/0112, 00:00 isdst?=-1
mytime is=1350788400
21/09/0112, 01:00 isdst?=1 
```

如您所见，在 time_t 从 Unix 返回 C 和从 Microsoft Visual Studio 2010 返回 C 之间，mytime 差异是 3600 秒。

这个程序应该在不同的平台（UNIX/WINDOWS/etc）和任何时区上运行，所以我不应该对时区进行硬编码。

如您所见，问题出在 Windows 上，时间返回错误。在这一刻，我不知道如何解决这个问题。有人遇到过这个特殊问题吗？你是怎么解决的？我特别需要地方日的开始。

非常感谢，

笑话

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:14:48.267

我不知道当你传递一个无效时间时是否定义了 mktime 的行为，所以这实际上可能不是一个错误。

无论如何，除了自己重新实现 mktime 之外，您还需要解决这个问题。我提出以下算法：

*   为当天上午 9 点构建一个 struct tm。
*   转换为 time_t。
*   从 time_t 中减去 24 小时。

如果没有夏令时变化，那么此时您正在查看前一天上午 9 点。如果夏令时开始了，你会看到早上 8 点；如果它完成了，你正在看上午 10 点。

*   转换回 struct tm。
*   将 struct tm 中的日期与原始日期进行比较。
*   如果还不是正确的日期，请在 time_t 上增加一个小时，然后重试。

由于您一次只添加一个小时，一旦您获得了您想要的日期，您就可以确定您已经获得了该日期的最早时间。

我做了一些我认为目前是安全的假设：夏令时永远不会在一个小时内开始或结束，它永远不会在上午 8 点到 10 点之间开始或结束，并且它永远不会改变超过一个小时。

我故意*不*假设夏令时永远不会在晚上开始或结束（例如，晚上 11 点变成午夜，反之亦然）或清晨（例如，凌晨 2 点变成凌晨 3 点，反之亦然，这正是发生在这里）。

# dll - Windows 64 位服务器与 x64 应用程序

> ID：12251124
> 
> 赞同：0
> 
> 时间：2012-09-03T16:05:49.890
> 
> 标签：dll, 64-bit, windows-server

我有一个 32 位 dll (Windows) 的源代码，我正在尝试将其重新编译为 64 位 dll。有人告诉我，该应用程序“可以在 VC++ 64 位模式下编译，以针对运行 Windows 64 位服务器的 AMD64 或安腾处理器。”

我试图破译这一点：如果它在 Windows 64 位服务器上运行，它是否也应该在 x64 位 Windows 上运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:11:46.313

[AMD64 和 x64](http://en.wikipedia.org/wiki/AMD64)和 x86-64，以及 Intel64 和 EM64T 本质上是一样的，只是名称不同。

# android - Android TableLayout 包装内容

> ID：12251126
> 
> 赞同：0
> 
> 时间：2012-09-03T16:05:51.393
> 
> 标签：android, text, cell, tablelayout, android-tablelayout

我有一个`LinearLayout`with`TableLayout`和`LinearLayout`inside。`TableLayout`由 5 `TableRow`s 组成。每个`TableRow`由两个`View`对象组成。

第一列有两个`TextView`s，我的问题是文本`TexView`被换行了：

单词`SomeValue`是换行的，字母`e`是换行符，我希望所有的都在一行中，在这种情况下和一般情况下，wath 的方式模式？

例如：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    android:padding="@dimen/padding_small" 
    android:id="@+id/layout1">
    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal|top"
        android:stretchColumns="0,true"
        android:shrinkColumns="*,true">
        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:gravity="center">
            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Value1"
                android:textAppearance="?android:attr/textAppearanceSmall" />
            <Spinner
                android:id="@+id/spinnerPrefix"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" />
        </TableRow>
        **<TableRow
            android:id="@+id/tableRow2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:gravity="center">
            <TextView
                android:id="@+id/textView2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="SomeValue"
                android:textAppearance="?android:attr/textAppearanceSmall" />
            <EditText
                android:id="@+id/valueU"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="phone" >
                <requestFocus />
            </EditText>
        </TableRow>**
        <TableRow
            android:id="@+id/tableRow3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:gravity="center">
            <TextView
                android:id="@+id/textView3"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:text="Mytext"
                android:textAppearance="?android:attr/textAppearanceSmall" 
               />
            <EditText
                android:id="@+id/valueN"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:ems="10" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:gravity="center">
            <TextView
                android:id="@+id/textView4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="AnyValue"
                android:textAppearance="?android:attr/textAppearanceSmall" />
            <DatePicker
                android:id="@+id/datePicker"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:gravity="center">
  <TextView
                android:id="@+id/textView5"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Some"
                android:textAppearance="?android:attr/textAppearanceSmall" />
            <RadioGroup
                android:id="@+id/radioGroup1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" 
                android:orientation="horizontal"
                android:gravity="center">
                <RadioButton
                    android:id="@+id/radioM"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="true"
                    android:text="M" />
                <RadioButton
                    android:id="@+id/radioF"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="F" />
            </RadioGroup>
        </TableRow>
    </TableLayout>
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="vertical"
        android:paddingTop="@dimen/padding_small" >
        <Button
            android:id="@+id/buttonRegistrazione"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Send Data" />
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:41:58.307

对于您可以添加的每个文本视图

```
android:singleLine = "true" 
```

这将使它成为一条线。如果文本太大，那么你可以使用[ellipsize](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aellipsize)

```
android:ellipsize 
```

控制您希望文本的显示方式

# c++ - std::fstream 和 Boost Iostreams 库之间的区别

> ID：12251128
> 
> 赞同：4
> 
> 时间：2012-09-03T16:05:59.647
> 
> 标签：c++, boost, stl

我是 BOOST 库的新手。今天看到一个小代码段，其中读取和写入 PGM 格式的图像是使用 Boost Iostreams 库实现的。由于我更熟悉 STL，我可以很容易地看出 std::fstream 可以做同样的工作。那么我的问题是，在这样一个简单的读写PGM图像应用程序中使用Boost库有什么意义呢？此外，我想知道在哪种情况下最需要 BOOST Iostreams Library。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T10:38:41.090

从`std::fstream` [参考](http://www.cplusplus.com/reference/iostream/fstream/)：

> fstream 提供了一个接口来从文件中读取和写入数据作为输入/输出流。

来自[Boost.Iostreams 参考](http://www.boost.org/doc/libs/1_51_0/libs/iostreams/doc/index.html)：

> Boost.Iostreams 有三个目标：
> 
> *   使创建标准 C++ 流和流缓冲区以访问新的源和接收器变得容易。
> *   提供定义过滤器并将它们附加到标准流和流缓冲区的框架。
> *   提供一组现成的过滤器、源和接收器。

# android - 是否有仅使用一个媒体播放器的音板的 Eclipse 项目示例

> ID：12251131
> 
> 赞同：1
> 
> 时间：2012-09-03T16:06:03.313
> 
> 标签：android, eclipse, android-mediaplayer

我一直在尝试开发一个简单的音板的 Andriod 应用程序，它将播放几个长声音，一次只能播放一个，而不是同时播放。我可以轻松地制作一个使用重复代码和许多媒体播放器的音板，但是由于分配了太多的 MediaPlayer 实例，这可能会使许多设备崩溃。我想使用地图，以便只使用一个媒体播放器，但几个小时后，我仍然遇到编译问题。我也可以在麻省理工学院使用 App Inventor，但如果没有大量的密钥/签名黑客，我认为我无法将其上传到市场，所以我认为这不是一个好的选择。

有谁知道是否有一个工作代码示例，其中只有几个声音，只使用 SDK 中包含的 1 个媒体播放器，或者在线提供？如果我可以从一个基本的工作设计开始，它会节省我很多时间。

我的代码如下所示：

```
public class newBoard extends Activity {

int selectedSoundId; 

@Override 

public void onCreate(Bundle savedInstanceState) { 

    super.onCreate(savedInstanceState); 

*//below line causes an error due to use of "newboard"*

    setContentView(R.layout.newboard); 

    final MediaPlayer player = new MediaPlayer(); 
    final Resources res = getResources(); 

    //just keep them in the same order, e.g. button01 is tied to backtoyou 
    final int[] buttonIds = { R.id.button01, R.id.button02, R.id.button03, 
                              R.id.button04, R.id.button05, R.id.button06, 
                              R.id.button07, R.id.button08, R.id.button09, 
                              R.id.button10, R.id.button11, R.id.button12, 
                              R.id.button13, R.id.button14, R.id.button15, 
                              R.id.button16, R.id.button16, R.id.button17, 
                              R.id.button18, R.id.button19, R.id.button20, 
                              R.id.button21, R.id.button22, R.id.button23, 
                              R.id.button24, R.id.button25 }; 
    final int[] soundIds = { R.raw.sound01, R.raw.sound02, R.raw.sound03, 
                              R.raw.sound04, R.raw.sound05, R.raw.sound06, 
                              R.raw.sound07, R.raw.sound08, R.raw.sound09, 
                              R.raw.sound10, R.raw.sound11, R.raw.sound12, 
                              R.raw.sound13, R.raw.sound14, R.raw.sound15, 
                              R.raw.sound16, R.raw.sound16, R.raw.sound17, 
                              R.raw.sound18, R.raw.sound19, R.raw.sound20, 
                              R.raw.sound21, R.raw.sound22, R.raw.sound23, 
                              R.raw.sound24, R.raw.sound25 }; 

    View.OnClickListener listener = new View.OnClickListener() { 
        public void onClick(View v) { 
            //find the index that matches the button's ID, and then reset 
            //the MediaPlayer instance, set the data source to the corresponding 
            //sound effect, prepare it, and start it playing. 
            for(int i = 0; i < buttonIds.length; i++) { 
                if(v.getId() == buttonIds[i]) { 
                    selectedSoundId = soundIds[i]; 
                    AssetFileDescriptor afd = res.openRawResourceFd(soundIds[i]); 
                    player.reset(); 
                    try { 
                        player.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength()); 
                    } catch (IllegalArgumentException e) { 
                        // TODO Auto-generated catch block 
                        e.printStackTrace(); 
                    } catch (IllegalStateException e) { 
                        // TODO Auto-generated catch block 
                        e.printStackTrace(); 
                    } catch (IOException e) { 
                        // TODO Auto-generated catch block 
                        e.printStackTrace(); 
                    } 
                    try { 
                        player.prepare(); 
                    } catch (IllegalStateException e) { 
                        // TODO Auto-generated catch block 
                        e.printStackTrace(); 
                    } catch (IOException e) { 
                        // TODO Auto-generated catch block 
                        e.printStackTrace(); 
                    } 
                    player.start(); 
                    break; 
                } 
            } 
        } 
    }; 

    //set the same listener for every button ID, no need 
    //to keep a reference to every button 
    for(int i = 0; i < buttonIds.length; i++) { 
        Button soundButton = (Button)findViewById(buttonIds[i]); 
        registerForContextMenu(soundButton); 
        soundButton.setOnClickListener(listener); 

    } 

} 

} 
```

我只有一个错误：

newboard 无法解析，或者不是字段类型：Java 问题

一个可以用作基础的不错的项目下载将是最佳的，如果存在的话！

提前感谢您的任何指导！

美泰87

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:09:48.403

该错误意味着它找不到您的布局 XML 文件。

**/res/layout/newboard.xml**文件是否存在于您的 Eclipse 项目中？也许布局被称为其他东西，例如**main.xml**，在这种情况下，您应该`R.layout.main`在调用时在 Java 代码中使用`setContentView()`.

# css - 从正常流中移除并将相对位置设置为自身

> ID：12251138
> 
> 赞同：5
> 
> 时间：2012-09-03T16:06:32.707
> 
> 标签：css

```
<div id="foo">
    <div></div>
    <div id="bar"></div>
    <div></div>
</div> 
```

你如何让“栏”的顶部相对于其原始位置定位 -5px 并从正常流程中移除？

## 尝试 1

```
#bar {
    position: relative;
    top: -5px;
} 
```

不起作用，因为“bar”没有从正常流程中删除

## 尝试 2

```
#foo {
    position: relative;
}
#bar {
    position: absolute;
    top: -5px;
} 
```

不起作用，因为“bar”的顶部相对于“foo”放置了 -5px

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T16:08:23.390

尝试

```
#bar {
    position: absolute;
    margin-top: -5px;
} 
```

看这个活生生的[例子](http://jsfiddle.net/mRTJK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:10:38.490

你可能需要做一些链接这个：

```
#foo {
    position: relative;
}
#bar {
    position: absolute;
    top: -5px;
} 
```

# html - 用底部三角形制作 div

> ID：12251149
> 
> 赞同：5
> 
> 时间：2012-09-03T16:07:50.003
> 
> 标签：html, css, geometry, css-shapes

我一直在尝试用 div做**白色形状：**

[http://sircat.net/joomla/sircat/mies/2.png](http://sircat.net/joomla/sircat/mies/2.png)

如何获得 div 底部的对角线形状？

我有这个 div: width: 620px; 高度：440px；背景颜色：白色；

谢谢你

编辑：忘记div后面的bg，我想用对角线边框制作div，而不是在bg的帮助下，因为它在顶层

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T16:25:17.307

您还可以使用边框和`:after`伪选择器：http: [//jsfiddle.net/qQySU/](http://jsfiddle.net/qQySU/)

```
#pointed {
    position: relative;
    margin: 0 auto;
    width: 200px;
    height: 200px;
    background-color: white;
}

#pointed:after,
#pointed::after {
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -50%;
    content: '';
    width: 0;
    height: 0;
    border-top: solid 150px red;
    border-left: solid 100px transparent;
    border-right: solid 100px transparent;
} 
```

我已经为笔尖上色以便于识别边界。围绕最后 3 行的边框宽度进行播放以获得所需的提示。

**编辑。：**

兼容性参考：[http ://caniuse.com/css-gencontent](http://caniuse.com/css-gencontent)

**编辑2：**

为了换取语义，您可以获得更多跨浏览器，您可以将 stle 放在内部元素上，而不是放在`:after`伪选择器上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-03T16:18:00.593

**最简单（代码量最少）的**方法：只需使用 CSS [http://dabblet.com/gist/3610406](http://dabblet.com/gist/3610406)[**`linear-gradient`**](https://developer.mozilla.org/en-US/docs/CSS/linear-gradient)

HTML：

```
<div class='box'>Text goes here...</div> 
```

CSS：

```
.box {
    width: 26em;
    min-height: 31em;
    padding: 1em;
    outline: solid 1px lightblue;
    margin: 0 auto;
    background: linear-gradient(45deg, dimgrey 47%, black 50%, transparent 50%) 
                    no-repeat 0 100%, 
                linear-gradient(-45deg, dimgrey 47%, black 50%, transparent 50%) 
                    no-repeat 100% 100%;;
    background-size: 50% 14em;
} 
```

* * *

**更好的兼容性和更好的外观**：您可以使用带有以下内容的伪[**元素**](https://developer.mozilla.org/en-US/docs/CSS/Pseudo-elements)[**`box-shadow`**](https://developer.mozilla.org/en-US/docs/CSS/box-shadow)： http: [//dabblet.com/gist/3610548](http://dabblet.com/gist/3610548)

HTML：

```
<div class='box'>text goes here... hover me ;)</div> 
```

CSS：

```
html { background: darkgrey; }
.box {
    box-sizing: border-box;
    position: relative;
    width: 20em;
    height: 20em;
    padding: 1em;
    margin: 3em auto 0;
    background: white;
}
.box:before {
    position: absolute;
    right: 14.65%; /* 50% - 35.35% */ bottom: -35.35%; /* half of 70.71% */
    width: 70.71%; /* 100%*sqrt(2)/2 */
    height: 70.71%;
    box-shadow: 2px 2px 1px dimgrey;
    transform: rotate(45deg);
    background: white;
    content: '';
}
.box:hover, .box:hover:before {
    background: plum;
} 
```

# facebook-c#-sdk - Facebook SDK 代理设置 C#

> ID：12251150
> 
> 赞同：6
> 
> 时间：2012-09-03T16:07:50.620
> 
> 标签：facebook-c#-sdk

我使用 Facebook SDK .net 但我使用带身份验证的代理连接到 Internet 我收到错误 (407) (407) proxy authentication required 如何在 Facebook SDK 上设置身份验证

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T21:23:11.673

FacebookClient 中有一个静态方法，可让您全局设置它。

```
[EditorBrowsable(EditorBrowsableState.Never)]
public static void SetDefaultHttpWebRequestFactory(Func<Uri, HttpWebRequestWrapper> httpWebRequestFactory) 
```

您可能在智能感知中看不到它，因为它默认是隐藏的。

如果您想要每个实例都可以使用该属性。

```
[EditorBrowsable(EditorBrowsableState.Never)]
public virtual Func<Uri, HttpWebRequestWrapper> HttpWebRequestFactory { get; set; } 
```

这是一个例子。

```
FacebookClient.SetDefaultHttpWebRequestFactory(uri => {
    var request = new HttpWebRequestWrapper((HttpWebRequest)WebRequest.Create(uri));
    request.Proxy = ......; // normal .net IWebProxy
    return request;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T21:51:07.143

我最近在使用`FacebookClient`发布到 Facebook 页面时遇到了这个问题。就我而言，我有一个负责 Facebook 交互的 WCF 服务，该服务位于公司代理后面。[这个 stackoverflow 答案](https://stackoverflow.com/a/8180854/132599)为我解决了这个问题，但需要将服务的 IIS 应用程序池用户身份设置为具有域凭据的用户，否则会返回 407 错误。因此，将应用程序池标识设置为域帐户并将以下内容添加到 web.config：

```
<system.net>
  <defaultProxy useDefaultCredentials="true" />
</system.net> 
```

# javascript - HTML onload 不调用 JavaScript 函数

> ID：12251152
> 
> 赞同：3
> 
> 时间：2012-09-03T16:07:55.333
> 
> 标签：javascript, html, onload

我已经查看了与此类似的其他问题，但我还没有找到答案。

我`<body onload="doStuff()">`已停止调用 doStuff() JavaScript 函数。我尝试替换`<body onload="doStuff()">`为`<body onload="alert('Test');">`并成功创建警报。

然后我尝试将相同的警报放在 doStuff() 函数中（并将 onload 恢复为调用 doStuff()），但警报没有出现。

有什么原因会发生这种情况吗？此外，可能需要注意的是，我几乎可以肯定我没有在这个工作和它不工作之间进行任何代码更改（你可能不相信，但这是真的）；但是，我确实从包含 Joomla 安装的服务器中删除了一个子文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-31T10:48:30.177

确保您的脚本标签是正确的。

`<script src="myscript.js" />`会导致`<body onload="...">...</body>`失败。

它应该是：

```
<script src="myscript.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:41:18.217

尝试远离内联调用并按照预期使用 jQuery。通过保持您的风格和脚本逻辑分开，它非常好的工作实践（更不用说更容易调试）。

对于负载的身体，使用这个。

```
$(document).ready(function () {
    doStuff();
}); 
```

或者它可以进一步缩短到

```
$(function () {
    doStuff();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-25T21:40:39.347

无论出于何种原因，在 Firefox 中，我在页面正文中声明的脚本阻止了内联调用的触发。我将我的脚本标签移动到标题，然后它工作了。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-05T11:11:22.590

未捕获的语法错误（参见原始帖子中的评论）的问题是，当我将 PHP 数组转换为 JavaScript 数组时，出现了问题，即附加了一个奇怪的字符。我通过用以下代码替换我的 DIY PHP-array-to-JS-array 代码解决了这个问题：

```
<?php
 $js_array = json_encode($resultsArray);
 echo "var jsResultsArray = ". $js_array . ";\n";
?> 
```

这与帖子的标题问题并没有真正的联系，但这是根本问题。

# c# - 使用 == 或等于运算符和外部参数轻松转换 C# 表达式

> ID：12251153
> 
> 赞同：2
> 
> 时间：2012-09-03T16:07:56.333
> 
> 标签：c#, entity-framework, expression

假设我有两个参数：

参数 1 一个表达式，它接受一个 T 并从中获取相关产品的 ID

```
Expression<Func<T,int>> prodIdProperty = x=>x.Product.Id 
```

参数 2 一个要与之比较的 productid ，比方说

```
int productid = 5; 
```

有什么方法可以在运行时将其（在代码中）转换为这样的新表达式：

```
Expression<Func<T,bool>> prodIdProperty = x=>x.Product.Id == 5 
```

我基本上需要这样的东西：

```
Expression<Func<T,bool>> TransformToPredicate(Expression<Func<T,int>> prodIdProperty,int productid){
//insert expression transform magic I don't seem to grasp...
} 
```

我需要这个，因为我想将它作为谓词传递给我的 EF Where 子句，这意味着我不能包含我的 prodIdProperty 的编译版本，因为它需要调用不支持的 Invoke()

（我已经尝试在[这个](https://stackoverflow.com/questions/12212721/generic-extension-method-on-queryable-crashes-on-invoke-when-converting-express)问题中以另一种方式提出我的问题，但我认为我在那里过于复杂了）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T16:11:03.760

听起来你想要这样的东西：

```
Expression<Func<T, bool>> TransformToPredicate(
    Expression<Func<T, int>> prodIdProperty,
    int productId)
{
    Expression equals = Expression.Equal(prodIdProperty.Body,
                                         Expression.Constant(productId));
    return Expression.Lambda<Func<T, bool>>(equals, prodIdProperty.Parameters);
} 
```

显示它的示例代码：

```
using System;
using System.Linq.Expressions;

class Test
{    
    static Expression<Func<T, bool>> TransformToPredicate<T>(
        Expression<Func<T, int>> prodIdProperty,
        int productId)
    {
        Expression equals = Expression.Equal(prodIdProperty.Body,
                                             Expression.Constant(productId));
        return Expression.Lambda<Func<T, bool>>(equals, prodIdProperty.Parameters);
    }

    static void Main()
    {
        Expression<Func<string, int>> length = x => x.Length;

        var predicate = TransformToPredicate(length, 5);
        var compiled = predicate.Compile();

        Console.WriteLine(compiled("Hello")); // True
        Console.WriteLine(compiled("Foo")); // False
    }
} 
```

# delphi - Delphi 2010 我可以有一个具有通用属性和方法的 TFrame 来传递事件吗？

> ID：12251155
> 
> 赞同：0
> 
> 时间：2012-09-03T16:08:01.670
> 
> 标签：delphi, generics, delphi-2010, tframe

我有一个 TFrame，用于在 Delphi 2010 VCL 项目中搜索实体，在 TFrame 中我有一个按钮编辑，允许用户打开特定表单以浏览该实体。（所有浏览表单都继承自一个通用的基本浏览表单）目前我通过从基本框架继承来实现这一点，然后实现触发特定表单的 Browse 事件。每次唯一的区别是单击事件上显示的形式（类型），有没有一种方法可以用泛型实现这一点。这样我就可以重用相同的基本框架，而不必为每个实体重写相同的代码（有超过 100 个），并且在主机表单的表单创建中传递类型约束以在浏览时打开适当的表单。我尝试向框架添加泛型类型：

```
type
  Browser<T: TfrmBrowser, constructor> = class
  class function BrowseForm(Owner: Tcomponent): T;
end;

class function Browser<T>.BrowseForm(Owner: Tcomponent): T;
var
_browseForm: T;
begin
  _browseForm := T.Create; // 1st problem T.Create(Owner); throws a comile error
  Result := _browseForm;
end; 
```

然后在选择器框架中，我公开了可以从主机表单的创建事件中调用的 Start ：

```
procedure TPickerFrame.Start<T>(const idProp, nameProp, anIniSection: string; aDto: IDto);
begin
    _browseForm:= Browser<T>.BrowseForm(self);
    _iniSectionName:= anIniSection;
    _idField:= idProp;
    _descriptionField:= nameProp;
    _dto := aDto;
end; 
```

事实是，我在 Delphi 中并没有真正获得泛型，而且这些都不起作用。以下是框架的摘录：

```
_browseForm: TfrmBrowser;

procedure TPickerFrame.Browse(var DS: TDataSet; var Txt: string; var mr: TModalResult);
begin
  // How do I achieve this with Generics
  // _browseForm := T.Create(nil); // <-- this line is what needs to know the form type at runtime
  // Everything else from here is the same
  _browseForm.ProductName := Application.Title;
  _browseForm.PageSize := 20;
  _browseForm.DatabaseType := bdbtADO;
  _browseForm.ADOConnection := dmdbWhereHouse.BaseADOConnection;
  _browseForm.INISectionName := _iniSectionName;
  _browseForm.DoSelBrowse(DS, Txt, mr, _descriptionField, _text);
  if mr = mrOk then
    begin
      DoSelect(DS);
    end;
end; 
```

有没有人有类似要求的经验？任何帮助，将不胜感激。谢谢

以下是机架主浏览器的示例：

```
type
  TfrmMbfRACK_MASTER = class(TMxfrmBrowseHoster)
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    //...
  private
    FWHID: Integer;
    procedure SetWHID(const Value: Integer);
    { Private declarations }
  public
    { Public declarations }
    procedure BuildADO(Sender: TObject; Q: TADOQuery); override;
  end;

implementation

{$R *.DFM}

{ TfrmMbfRACK_MASTER }

procedure TfrmMbfRACK_MASTER.FormCreate(Sender: TObject);
  begin
    inherited;
    fmeMxFrmBrowseHoster1.KeyField := 'RACK_ID';
    // FWHID := -2; // 22/06/04
    FWHID := 0; // 22/06/04
  end;

procedure TfrmMbfRACK_MASTER.BuildADO(Sender: TObject; Q: TADOQuery);
  begin
    Q.Close;
    Q.SQL.Clear;
    Q.SQL.Add(
      'SELECT R.RACK_DESC, R.RACK_BARCODE, W.ERP_WH, WC.CLASS_NAME, W.DESCRIPTION WAREHOUSE, R.RACK_PACKING_ORDER,  ');
    //...
  end; 
```

基类

```
type
  TMxfrmBrowseHoster = class(TfrmMxForm)
  protected
    // ...
    procedure FormCreate(Sender: TObject);
    procedure BuildADO(Sender: TObject; ADOQ: TADOQuery); virtual; abstract;
  public

  procedure TMxfrmBrowseHoster.FormCreate(Sender: TObject);
  begin
    TMxFormProductName := Application.Title;
    fmeMxFrmBrowseHoster1.Initialise;
    INISectionName := Name;
    AbortAction := False;
    fmeMxFrmBrowseHoster1.OnSelect := SelectNormaliser;
    fmeMxFrmBrowseHoster1.OnNeedADO := BuildADO;
    fmeMxFrmBrowseHoster1.INISectionName := self.Name;
    fmeMxFrmBrowseHoster1.MultiSelect := dxBarLargeButton10.Down;
    fmeMxFrmBrowseHoster1.AutoSaveGrid := True;
    dxBarEdit1.OnChange := ActPageSizeChangedExecute;
    FormStorage.RestoreFormPlacement;

    ActConfirmDelete.Execute;
  end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:34:00.340

我发现你的问题有点模糊，我不是 100% 确定我完全理解你在问什么。但是，我知道在调用构造函数时如何处理您的问题。也许这就是你需要帮助的全部。

您需要使用虚拟构造函数多态性和一些转换：

```
class function Browser<T>.BrowseForm(Owner: Tcomponent): T;
var
_browseForm: T;
begin
  _browseForm := TfrmBrowser(T).Create(Owner); 
  Result := _browseForm;
end; 
```

这依赖于虚拟构造函数多态性。因此，您必须确保每个派生类的每个构造函数都`TfrmBrowser`标有该`override`指令。

# javascript - 最大高度与原始文本高度之间的可折叠 div

> ID：12251156
> 
> 赞同：0
> 
> 时间：2012-09-03T16:08:13.540
> 
> 标签：javascript, css, html, height

有没有一种简单的方法（在纯 javascript 中）在设置的最大高度和文本高度之间折叠 div？

具体来说，我想加载一个具有预设高度（例如 40 像素）的 div，并显示一个“显示更多”按钮，因此当您单击它时，div 设置为其中文本的高度（例如 80 像素） ）。当您再次单击时，您将 div 的高度设置为其初始高度（40 像素）。

一个可视化的例子是这样的：

初始状态（40 像素）

*div 的文本
会是
这样的，所以当按钮*
***显示更多信息时......***

如果您单击“显示更多信息”，您将进入此状态（80 像素）

*div 的文本
会是
这样的，所以当
按下 te 按钮时..
它会显示剩余的文本
;)*
***显示较少的信息...***

如果您单击“显示较少信息”，您将进入 previos 状态（40 像素）

我尝试过使用*height* / *max-height*和*clientHeight*，但是当您设置*height*属性值时，您会覆盖*clientHeight*之一。

提前致谢。如果解决方案太复杂，请不要犹豫回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:15:41.340

You might want to take a look to this tutorial: [http://papermashup.com/simple-jquery-showhide-div/](http://papermashup.com/simple-jquery-showhide-div/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:19:15.547

一种可能过于复杂的解决方案：

```
$('p').each(

function() {
    var that = $(this);
    that.attr('data-fullheight', that.height());
    that.height(that.height() / 2);
    that.closest('div').append('<a src="#" class="readmore">Read more</a>');
});

$('div').on('click', 'a.readmore', function(e) {
    var p = $(this)
        .closest('div')
        .find('p[data-fullheight]'),
        full = p.attr('data-fullheight');
    p.animate({
        'height' : full == p.height() ? full/2 : full
        },200)
});​ 
```

它假定以下 HTML（尽管`div` `id`不是必需的）：

```
<div id="text">
    <p>...text...</p>
</div> 
```

​<a href="http://jsfiddle.net/davidThomas/TEGF7/" rel="nofollow">JS Fiddle 演示。

只是因为我认为最后一个还不够复杂，所以我想我也会发布这个（纯 JavaScript！）解决方案：

```
var readmores = [];

function heights(el) {
    if (!el) {
        return false;
    }
    else {
        var h = parseInt(window.getComputedStyle(el, null).height, 10),
            moreLess = document.createElement('a'),
            text = document.createTextNode('Read more'),
            parent = el.parentNode;

        readmores.push(moreLess);

        moreLess.src = '#';
        moreLess.className = 'readmore';
        moreLess.appendChild(text);

        parent.insertBefore(moreLess, el.nextSibling);

        el.setAttribute('data-fullheight', h);
        el.style.height = Math.floor(h / 2) + 'px';
    }
}

function toggleHeight(el) {
    if (!el) {
        return false;
    }
    else {
        var full = el.getAttribute('data-fullheight'),
            curHeight = parseInt(el.style.height, 10);

        el.style.height = full == curHeight ? Math.floor(full / 2) + 'px' : full + 'px';
    }
}

function toggleText(el) {
    if (!el) {
        return false;
    }
    else {
        var text = el.firstChild.nodeValue;
        el.firstChild.nodeValue = text == 'Read more' ? 'Read less' : 'Read more';
    }
}

var paras = document.getElementsByTagName('p');

for (var i = 0, len = paras.length; i < len; i++) {
    var cur = paras[i];
    heights(cur);
}

for (var i=0, len=readmores.length; i<len; i++){
    readmores[i].onclick = function(){
        toggleHeight(this.previousElementSibling);
        toggleText(this);
    }
} 
```

​<a href="http://jsfiddle.net/davidThomas/TEGF7/1/" rel="nofollow">JS Fiddle 演示。

这有效（在 Chrome 21 中），但绝对不允许 IE 需要对其进行一些修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:21:50.530

一个简单的解决方案就是使用 max-height 属性。

您可以设置：

```
div.style.maxHeight = 40; //initial state 
```

如果按下按钮：

```
div.style.maxHeight = 80; //final state (set a value bigger than the text is going to be) 
```

如果再次按下：

```
div.style.maxHeight = 40; //initial state again 
```

这个解决方案的问题是你并不真正知道真正的文本大小，所以如果你设置的最大高度小于文本大小，它就不能正常工作。但对我来说解决了这个问题。

谢谢，希望这对其他人有帮助。

# c++ - 循环中分支预测的性能

> ID：12251160
> 
> 赞同：3
> 
> 时间：2012-09-03T16:08:32.883
> 
> 标签：c++, performance, optimization, branch-prediction

这两个代码片段之间会有明显的速度差异吗？天真地，我认为第二个片段会更快，因为遇到的分支指令要少得多，但另一方面，分支预测器应该可以解决这个问题。还是尽管有可预测的模式，但它会产生明显的开销？假设没有使用条件移动指令。

*片段1：*

```
for (int i = 0; i < 100; i++) {
    if (a == 3)
        output[i] = 1;
    else
        output[i] = 0;
} 
```

*片段 2：*

```
if (a == 3) {
    for (int i = 0; i < 100; i++)
        output[i] = 1;
} else {
    for (int i = 0; i < 100; i++)
        output[i] = 0;
} 
```

我不打算自己优化这些案例，但我想更多地了解分支的开销，即使具有可预测的模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:17:35.190

由于进入循环后`a`保持*不变，因此两个代码片段之间应该没有太大区别。*

就个人而言，我更喜欢前者，除非分支预测器无法预测*真正不可能*的分支，因为它`a`在循环中保持不变。

此外，编译器可能会执行此优化：

*   [循环断开](http://en.wikipedia.org/wiki/Loop_unswitching)

从而使*两个*代码片段发出完全相同的机器指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:28:54.070

你问了一个性能问题，但没有指定硬件（尽管从这个问题我们可以推断它是具有分支预测的架构之一）、工具链或编译选项。

总的来说，这只是另一个空间与速度的权衡，空间本身通常会影响速度（CPU 指令和微码缓存）。

唯一合理的答案是“**性能会因处理器硬件和编译器优化而异。** ”

# java - JMenu 在 Windows7 LAF Java7 中使用 focuslost 事件

> ID：12251161
> 
> 赞同：2
> 
> 时间：2012-09-03T16:08:37.250
> 
> 标签：java, swing, java-7, jmenu, jpopupmenu

如果单击另一个组件时弹出菜单仍然打开，则该组件不会收到该事件，因为它可能已被弹出窗口消耗。一般来说，所有 JPopupmenus 都会发生这种情况。这只发生在带有 Windows LAF (Windows7) 的 Java 7 中。有解决方法吗？这是一个已知的错误吗？

```
import javax.swing.*;
import java.awt.event.*;

public class Test
{
    public static void main(String[] s)
    throws Exception
    {
           String lookAnfFeelClassName = UIManager.getSystemLookAndFeelClassName();
           UIManager.setLookAndFeel(lookAnfFeelClassName);

           JMenu menu = new JMenu("TEST Menu");
           JMenuItem menuItem = new JMenuItem("Menu Item 1");

           JMenuBar menuBar = new JMenuBar();
           menu.add(menuItem);
           menuBar.add(menu);

           final JButton b = new JButton("Test");
           b.setBounds(5, 50, 60, 20);
           b.addActionListener(new ActionListener()
           {
                  public void actionPerformed(ActionEvent e)
                  {
                        //If the Menu is open when I press the button, the putton is not pressed 
                        //so I have to press it again. 
                        JOptionPane.showMessageDialog(b, "Button Pressed");
                  }
           }
           );

           JFrame frame = new JFrame();
           frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
           frame.setSize(150, 150);
           frame.setJMenuBar(menuBar);
           frame.getContentPane().setLayout(null);
           frame.getContentPane().add(b);
           frame.setVisible(true);           
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-28T21:25:17.170

这是解决问题的神奇线：

```
UIManager.put("PopupMenu.consumeEventOnClose", Boolean.FALSE); 
```

我在查看 BasicPopupMenuUI 类的源代码后发现了这一点。显然，根据代码中的以下注释，这种行为是经过深思熟虑的设计选择，但对我来说确实感觉像是一个错误。

```
 // Ask UIManager about should we consume event that closes
            // popup. This made to match native apps behaviour. 
```

顺便说一句，它也发生在 Java 5 和 6 中。

# php - wordpress wp-admin 重定向到另一个域名

> ID：12251162
> 
> 赞同：1
> 
> 时间：2012-09-03T16:08:45.410
> 
> 标签：php, wordpress

我们的 wordpress 网站最近被黑了——不过还有一些东西，我不知道它是怎么发生的。

[http://www.whatgoesaroundstore.co.uk/wp-admin/](http://www.whatgoesaroundstore.co.uk/wp-admin/)没问题

[http://www.whatgoesaroundstore.co.uk/wp-admin](http://www.whatgoesaroundstore.co.uk/wp-admin)重定向到某个西班牙站点。

我错过了什么可能会改变？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:21:40.120

**见 blewo 网址**

[Wordpress wp-admin 将我重定向到另一个域](https://stackoverflow.com/questions/8456360/wordpress-wp-admin-redirects-me-to-a-different-domain)

**或者试试看：-**

转到您的数据库，找到名为 wp-option 的表，然后将 wordpress 地址和站点地址更改为 mysite.net。

您还可以将以下代码行添加到 wp-config.php-file

```
Define('WP_SITEURL','http://your-site-url.com');
Define('WP_HOME','http://your-site-url.com'); 
```

# hadoop - Apache Hadoop - 节点机器差异？

> ID：12251171
> 
> 赞同：-1
> 
> 时间：2012-09-03T16:09:12.480
> 
> 标签：hadoop, cluster-computing

我有一个带有 Intel 双核处理器（32 位）的旧台式机，并且我运行着 Ubuntu 12.04 桌面版（同样是 32 位）。我希望设置至少一个 4 节点的 Apache Hadoop 集群。为此，我打算购买一些价格便宜的二手台式机。但是，我对以下查询感到困惑：

1.  Apache Hadoop 能否与集群中的不同节点一起工作——一个 32 位 Ubuntu 12.04 而另一个是 64 位版本？
2.  我认为整个集群节点的操作系统版本必须相同 - 我正确吗？
3.  根据官方网站，1.0.3 是最新的**稳定**版本——它会在 32 位机器上工作还是需要所有节点都是 64 位？

以上问题的答案将帮助我确定我必须购买什么样的处理器等来构建集群（*欢迎提出建议！！！*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:52:42.857

> Apache Hadoop 能否与集群中的不同节点一起工作——一个 32 位 Ubuntu 12.04 而另一个是 64 位版本？
> 
> 根据官方网站，1.0.3 是最新的稳定版本——它会在 32 位机器上工作还是需要所有节点都是 64 位？

一切都运行在 Java 之上，所以如果你能安装 32 位 Java，你就可以运行 Java。然而，有一些原生部分，我相信它们是交叉编译的，适用于 x86 和 x64。

由于通信是通过 RPC（纯 java 代码）进行的，这应该可以工作，尽管我还没有尝试过。

> 我认为整个集群节点的操作系统版本必须相同 - 我正确吗？

不一定，但为了便于您在调试问题中使用并在更新的情况下保持集群同质，我不会这样做。

# android - 为什么光标指向其在匿名类中设置的最新位置

> ID：12251175
> 
> 赞同：0
> 
> 时间：2012-09-03T16:09:33.733
> 
> 标签：android

你们能解释一下为什么`cursor`每行都通过引用作为不同的实例最终`mDBHelper.updateFavorites()`指向它的最新位置吗？因为我期望`cursor`传递给`onClick()`方法实际上`Cursor c`是指向该对象传递时的位置，但事实并非如此。非常感谢你。

```
@Override
        public View newView(Context ctxt, Cursor c, ViewGroup parent) {
            View row;
            final Cursor cursor = c; // This is different for each row in list view
            LayoutInflater inflater = ((Activity) ctxt).getLayoutInflater();
            row = inflater.inflate(R.layout.row, parent, false);
            this.defaultDrawable = (Drawable) row.getBackground();
            final CheckBox mStar = (CheckBox) row.findViewById(R.id.star);
            mStar.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View view) {
                    if (mStar.isChecked()) {
                        mDbHelper.updateFavorite(cursor, 1); // Here I'm expecting to have the cursor pointing exactly where Cursor c (which is passed to newView() method) is pointing right now.
                    } else {
                        mDbHelper.updateFavorite(cursor, 0); // The same here
                    }
                }
            });

            ViewHolder holder = new ViewHolder(row);

            row.setTag(holder);

            return (row);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:13:33.733

如我所见，您没有制作光标的任何副本。所以实际上，这只是对唯一一个游标的引用。

因此，如果您在某个循环中分配它，则每次将初始参考移动到净位置 - 您的所有光标也将被移动。

你的情况是这样吗？

祝你好运

# c++ - 是否可以访问在另一个函数中定义的自动静态变量的 *type*？

> ID：12251181
> 
> 赞同：7
> 
> 时间：2012-09-03T16:09:53.640
> 
> 标签：c++, lambda, c++11

（这里的根本问题是我试图在涉及 lambdas 的复杂表达式上使用`decltype`，或基于 的其他类型推导`auto`。我试图找到某种解决方法。我一直在玩[http： //pfultz2.github.com/Pythy/](http://pfultz2.github.com/Pythy/%20Pythy)用于多态 lambda。如果不告诉大家一个长篇故事，我无法完全进入动机！）

我希望能够`decltype([](int){return 3.5L};`获取 lambda 的类型，或者至少是返回类型。是的，我知道 lambdas 被赋予了一个独特的类型，我不需要提醒`decltype([](int){return 3.5L};`如果在两条不同的行上使用它会给出两种不同的类型。

如果我`decltype`在 lambda 上使用，则会收到一条错误消息（“lambda used in unevaluate context”）。我知道这似乎是一个合理的错误信息，但我对 C++ 如此握着我的手感到惊讶！允许这样做会很有用，尤其是访问 lambda 的返回类型。这个错误仅仅是由于过分热心的错误信息造成的，还是真的有充分的理由不能做到这一点？

像这样的表达式在成员函数中起作用：

```
template<typename T>
struct X {
    void foo() {
        static auto l = [](int){return 3.5;};
    }
}; 
```

但我不允许这样做：

```
template<typename T>
struct X {
    static auto var = [](int){return 3.5;}; // will also fail if I use constexpr here
};

x.cpp:8:47: error: expression ‘#‘lambda_expr’ not supported by
    dump_expr#<expression error>’ is not a constant-expression
x.cpp:8:47: error: unable to deduce ‘const auto’ from ‘&lt;expression error>’ 
```

这激发了我尝试在函数中使用静态变量以对 lambda 进行类型推断的想法。

如果 X 不是模板，这似乎会更好一些。但我需要 X 是一个模板——特别是，lambda 的参数将采用模板参数的类型。

请记住，我只想要 lambda 的类型，并且只对返回类型感到满意。令人沮丧的是，编译器愿意并且能够在这两种情况下进行类型推断和静态初始化，但这似乎给我设置了一些任意障碍。

我可以从函数外部访问变量的*类型吗？*`var_in_func``dummy_func`

```
struct S {
    constexpr static auto member = a_complicated_expression...  // error
    void dummy_func() {
        static auto var_in_func = a_complicated_expression...    // OK
    }
    typedef dummy_func :: var_in_func the_type; // I'd like this to work
}; 
```

如果 中有 lambda `a_complicated_expression...`，则 的初始化程序通常会出现问题`member`。如果`S`实际上是一个结构模板，那么我会收到`member`没有初始化程序的错误消息。这就是为什么我试图找到其他方法来解决这个问题。

但是，`static auto`静态方法中的变量`dummy_func`可以正常工作。所以这让我想到它们应该是访问该静态变量类型的好方法？

我尝试了以下方法，但它不起作用，因为`dummy_func`它不是一种类型（足够公平）：

```
typedef dummy_fun :: var_in_func the_type_of_the_static_variable_in_the_method; 
```

我不能这样做`decltype( a_complicated_expression... )`，因为编译器抱怨在未评估的上下文（declspec）中使用 lambda。

我正在使用`g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3`. 我不介意我是否必须使用 g++ 特定的扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T11:42:24.177

非捕获 lambda 可以转换为函数指针，并具有`operator()`该函数指针的签名：

```
template<typename C, typename R, typename... Args>
auto remove_class(R (C::*)(Args...)) -> R(*)(Args...);
template<typename C, typename R, typename... Args>
auto remove_class(R (C::*)(Args...) const) -> R(*)(Args...);
template<typename C, typename R, typename... Args>
auto remove_class(R (C::*)(Args...) volatile) -> R(*)(Args...);
template<typename C, typename R, typename... Args>
auto remove_class(R (C::*)(Args...) const volatile) -> R(*)(Args...);

template<typename T>
auto to_f_ptr(T t) -> decltype(remove_class(&T::operator())) { return t; } 
```

您现在可以编写`auto var = to_f_ptr([](int){return 3.5;});`并且`var`将拥有 type `double (*)(int)`。

但是，您仍然不能将 lambda 用作类范围的`static`初始化程序；将[lambda 视为静态成员](https://stackoverflow.com/questions/11725881/lambda-as-a-static-member?rq=1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T11:32:47.550

*lambda 函数仅在其范围的上下文中定义*。这意味着静态成员函数中的 lambda 函数与其他地方定义的*类型不同。*在我看来，在其范围之外获取 lambda 函数的返回类型是不明智的，也不应该是可能的。

必须有另一种方法（不涉及 lambda）来获得您需要的类型，因为在任何潜在 lambda 函数的范围之外定义这种类型显然是有意义的。

# c# - 无法实现具有约束的基于多泛型参数的方法？

> ID：12251184
> 
> 赞同：3
> 
> 时间：2012-09-03T16:09:59.113
> 
> 标签：c#, generics, interface, constraints

我有以下接口声明：

```
public interface IBasePresenter
{
    void Run();
    void ShowDialog<T, M>(T t, M m ) where T : UserControl where M : Form,      ISomeInterface<SomeType>;
} 
```

ShowDialog() 基本上是一种向用户显示模式对话框的方法。其中“T”是父表单，M 是要显示的唯一对话框。M 其中有多种不同的类型！因此选择通用方法的原因！

我认为可以使用这种方法的几种方法：

```
Presenter.ShowDialog(this, typeof(Form1)); // FigA 
```

或者

```
Presenter.ShowDialog(this, new Form1()); // FigB 
```

根据图 A 或 B，样例 ShowDialog() 方法实现究竟是什么样的？

我的问题源于试图弄清楚通用参数“M”是如何在 ShowDialog() 方法实现中实例化的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T16:15:16.817

猜测：

```
m.Controls.Add(t);
m.ShowDialog(); 
```

但是，坦率地说，我不确定这个实用方法是否有用，它也可以是非泛型的（`void ShowDialog(Control t, Form m)`）。如果使用约束可能会更有用`: new()`，这也将避免在多个表单上使用相同的控件实例（非法）的风险。但正如我所说：坦率地说，在它展示出一些非平凡的有用性之前，我不会使用这种方法。如果我确实保留了它，我会重命名参数以更具启发性；M, m, T, t 都没有告诉我他们的意思。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T16:16:52.817

你不能使用这种`Fig A`方式，因为`typeof(Form1)`是 a `System.Type`，而不是 a `Form`; 除非有采用第二个类型参数的重载，否则代码不会编译`System.Type`。

> 如何在 ShowDialog() 方法实现中实例化泛型参数“M”？

它不是“实例化的”，而是“推断的：。您已经提供了实例；编译器从调用中*推断出类型。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T16:18:57.963

您可以按如下方式更改通用方法签名：

```
public void ShowDialog<T>() where T : Form, new() {
    using(var dialog = new T()){
        dialog.ShowDialog();
    }
} 
```

然后调用：

```
ShowDialog<MyCoolDialog>(); 
```

将导致 mtheod 创建（这次不推断；））表单的新实例并以模态方式显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T14:47:18.377

以下是接口方法的略微**更新版本：**

```
 void ShowDialog<TParentForm, TDialogForm, TModel, TEntity>(TParentForm t, TDialogForm m, Action callback)
        where TParentForm : UserControl
        where TModel : class, IModel<TEntity>, new()
        where TDialogForm : Form, IEditableItem<TEntity>, new(); 
```

我对以前的版本做了一些假设，所以在我的测试和改进阶段，方法签名发生了变化。对我来说，这或多或少还是一个教育练习，所以我仍然想知道如何完成它，而不是简单地选择简单的方法。

该方法的示例**实现**：

```
 public void ShowDialog<TParentForm, TDialogForm, TModel, TEntity>(TParentForm t, TDialogForm m, Action callback)
        where TParentForm : UserControl
        where TModel : class, IModel<TEntity>, new()
        where TDialogForm : Form, IEditableItem<TEntity>, new()
    {
        using (var dialogToShow = new TDialogForm())
        {
            dialogToShow.StartPosition = FormStartPosition.CenterScreen;
            dialogToShow.FormBorderStyle = FormBorderStyle.FixedSingle;
            dialogToShow.Model = new TModel();

            // 2\. show the new user control/form to the user.
            var result = dialogToShow.ShowDialog(t);

            // 3\. handle the dialog result returned and update the UI appropriately.
            if (result == DialogResult.OK)
            {
                // print status label.
                callback.Invoke();
            }
        }
    } 
```

我不完全确定为什么“TDialogForm m”参数仍然存在，因为它似乎没有在任何地方使用。

使用**方法**：

```
 private void BtnAddNewServiceClick(object sender, EventArgs e)
    {            
        Presenter.ShowDialog<ServerRolesControl, AddNewServiceForm, ServiceModel, Role>(this, new AddNewServiceForm(), SetAddedRolesLabel);
    }

    private void BtnViewAllServicesClick(object sender, EventArgs e)
    {
        Presenter.ShowDialog<ServerRolesControl, ViewRolesForm, ServiceModel, Role>(this, new ViewRolesForm(), SetDeletedRolesLabel);
    } 
```

我应该更新接口方法，但是让它工作太痛苦了，我宁愿现在不管它=)。

# git - 对于git log，--follow 和--find-renames 选项的区别

> ID：12251186
> 
> 赞同：1
> 
> 时间：2012-09-03T16:10:09.357
> 
> 标签：git, git-log

假设我只需要处理一个文件。从 git-log 手册页看来，我应该使用 --follow。让我困惑的是，对于--find-renames，我可以在相似度索引上指定阈值，而--follow 没有这样的阈值。

我的问题是为什么我不需要为 --follow 指定阈值来查找重命名？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:33:47.360

如果您使用 指定阈值`--find-renames`，则在使用 时将应用该阈值`--follow`。但是当您只指定`--follow`使用默认的相似度索引时（在大多数情况下应该没问题）。

Follow 需要重命名检测才能工作，但重命名检测本身对于例如`git show`、`git status`等也很有用。我建议默认使用以下命令启用它：

```
git config --global diff.renames true 
```

# matplotlib - 如何在底图上绘制矩形

> ID：12251189
> 
> 赞同：15
> 
> 时间：2012-09-03T16:10:35.600
> 
> 标签：matplotlib, matplotlib-basemap

我正在寻找一种在底图上绘制填充矩形的方法。我可以使用该方法轻松绘制矩形的边缘`drawgreatcircle`，但我找不到实际填充这些矩形的方法（指定颜色和 alpha）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-09T05:14:35.607

您可以将 matplotlib.patches.Polygon() 直接添加到您的轴上。问题是您是否希望矩形定义绘图坐标（绘图上的直线）或地图坐标（绘图上的大圆圈）。无论哪种方式，您都可以在地图坐标中指定顶点，然后通过调用 Basemap 实例（`m()`在下面的示例中）将它们转换为绘图坐标，自己构建一个多边形，然后手动将其添加到要渲染的轴上。

对于在绘图坐标中定义的矩形，这是一个示例：

```
from mpl_toolkits.basemap import Basemap
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon

def draw_screen_poly( lats, lons, m):
    x, y = m( lons, lats )
    xy = zip(x,y)
    poly = Polygon( xy, facecolor='red', alpha=0.4 )
    plt.gca().add_patch(poly)

lats = [ -30, 30, 30, -30 ]
lons = [ -50, -50, 50, 50 ]

m = Basemap(projection='sinu',lon_0=0)
m.drawcoastlines()
m.drawmapboundary()
draw_screen_poly( lats, lons, m )

plt.show() 
```

对于在地图坐标中定义的矩形，使用相同的方法，但在转换为绘图坐标之前在地图空间中插入线。对于每个线段，您必须执行以下操作：

```
lats = np.linspace( lat0, lat1, resolution )
lons = np.linspace( lon0, lon1, resolution ) 
```

然后将这些地图坐标转换为绘图坐标（如上，使用`m()`）并再次使用绘图坐标创建一个多边形。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-26T12:20:19.177

使用安德鲁的答案，我得到了错误

```
TypeError: len() of unsized object. 
```

但是，将 zip 转换为列表可以解决此问题。

完整代码：

```
from mpl_toolkits.basemap import Basemap
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon

def draw_screen_poly( lats, lons, m):
    x, y = m( lons, lats )
    xy = zip(x,y)
    poly = Polygon( list(xy), facecolor='red', alpha=0.4 )
    plt.gca().add_patch(poly)

lats = [ -30, 30, 30, -30 ]
lons = [ -50, -50, 50, 50 ]

m = Basemap(projection='sinu',lon_0=0)
m.drawcoastlines()
m.drawmapboundary()
draw_screen_poly( lats, lons, m )

plt.show() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-21T02:57:03.643

与上面类似的答案，但更基本的代码：

```
from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon

map = Basemap(projection='cyl')

map.drawmapboundary(fill_color='aqua')
map.fillcontinents(color='coral',lake_color='aqua')
map.drawcoastlines()

x1,y1 = map(-25,-25)
x2,y2 = map(-25,25)
x3,y3 = map(25,25)
x4,y4 = map(25,-25)
poly = Polygon([(x1,y1),(x2,y2),(x3,y3),(x4,y4)],facecolor='red',edgecolor='green',linewidth=3)
plt.gca().add_patch(poly)

plt.show() 
```

# javascript - 如何使用 .search() 方法搜索多个字符串？

> ID：12251197
> 
> 赞同：12
> 
> 时间：2012-09-03T16:11:22.937
> 
> 标签：javascript, search

.search 方法可以只搜索一个字符串吗？或者有没有办法让一个 .search 命令一次搜索多个字符串？（顺便说一句，我尝试了以下代码：`y.search("c", "b", "a")`，其中 y 是文本框输入。）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-03T16:13:09.307

您不能使用多个参数，但可以使用带有 or 运算符 ( `|`) 的正则表达式，如下所示：

```
y.search(/c|b|a/); 
```

此方法也适用于长度超过一个字符的字符：

```
y.search(/string1|string2|string3/); 
```

# redirect - HTTP 代理能够有选择地重定向请求

> ID：12251198
> 
> 赞同：2
> 
> 时间：2012-09-03T16:11:27.643
> 
> 标签：redirect, proxy

是否有具有选择性重定向功能的代理？例如，假设我们有一个服务器 S，有两个文件 A 和 B。当使用浏览器请求文件 A 时：`http://S/A.html`我想将此请求重定向到文件`http://localhost/A.html`（我想提供本地版本`A.html`而不是远程版本）。请求文件B时：`http://S/B.html`我要获取远程版本，所以重定向过滤器必须是选择性的。

是否有适用于 Windows 的工具，能够执行此类操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:35:29.267

Fiddler的[自动回复](http://fiddler2.com/Fiddler2/help/AutoResponder.asp)功能完全符合要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:22:48.607

Squid 可用于 Windows 并支持重写。

# position - 在子弹物理中重新定位刚体

> ID：12251199
> 
> 赞同：5
> 
> 时间：2012-09-03T16:11:36.540
> 
> 标签：position, set, physics, bullet, rigid-bodies

我正在编写一个使用 Bullet Physics 作为物理模拟引擎的角色动画渲染引擎。

一个序列将在屏幕上没有模型开始，然后将动画分配给该模型，模型将移动到动画的第 0 帧，引擎将开始使用动画渲染模型。

在第 0 帧初始化时，在角色模型上重新定位刚体的正确方法是什么？

目前我正在使用此代码，在将动画分配给模型并将骨骼移动到第 0 帧位置后立即调用该代码：

```
_world->removeRigidBody(_body);
bool k = (_type == Kinematics);
_body->setCollisionFlags(_body->getCollisionFlags() & ~btCollisionObject::CF_NO_CONTACT_RESPONSE);
btTransform tr = BulletPhysics::ConvertD3DXMatrix(&(_bone->getCombinedTrans()));
tr *= _trans;
_body->setCenterOfMassTransform(tr);
_body->clearForces();
_body->setLinearVelocity(btVector3(0,0,0));
_body->setAngularVelocity(btVector3(0,0,0));
_world->addRigidBody(_body, _groupID, _groupMask); 
```

问题是有时这有效，有时则无效。以模特的裙子为例。有时它会出现在自然位置，有时会稍微错位并落入到位，有时它会完全穿过身体，好像碰撞已关闭，并且有一些力将它推向那个方向。这在大多数情况下确实有意义，因为在测试动画中，我使用模型的初始位置在屏幕中央，但动画从屏幕左侧开始。有谁知道如何解决这个问题？

我知道裙子上的骨骼不是问题，因为我关闭了物理并强制它在每一帧手动更新骨骼位置，并且在整个动画中一切都在正确的位置。

编辑：我也有限制，这可能是造成这种情况的原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-24T10:49:05.817

这是我的重新定位方法，正是这样做的。

```
void LimbBt::reposition(btVector3 position,btVector3 orientation) {
    btTransform initialTransform;

    initialTransform.setOrigin(position);
    initialTransform.setRotation(orientation);

    mBody->setWorldTransform(initialTransform);
    mMotionState->setWorldTransform(initialTransform);
} 
```

运动状态 mMotionState 是您在开始时为 btRigidBody 创建的运动状态。只需将您的 clearForces() 和速度添加到它，以阻止身体从新位置继续移动，就好像它穿过一个门户一样。那应该这样做。它在这里很适合我。

编辑：如果您正确地重新定位所有刚体，约束将适应。为此，很容易计算相对位置并据此重新定位整个受约束的刚体结构。如果你做错了，你会得到严重的抽搐，因为约束会尝试以数字方式调整你的构造，如果约束间隙很大，则会产生很大的力。

编辑2：另一个问题是，如果您需要确定性行为（每次重置身体时，它们应该*完全相同*），那么您将不得不杀死旧的动态世界，重新创建它并再次添加所有身体。世界存储了一些暂时无法清除的有关尸体的信息。这可能会在未来发生变化，因为 bullet4 将支持确定性重置。但就目前而言，如果您使用确定性重置进行实验，您需要放弃世界并重新创建它。

资料来源：[与 Bullet Physics 的开发者 Erwin Coumans 的讨论](https://github.com/bulletphysics/bullet3/pull/849)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T02:41:09.467

我无法告诉您移动刚体时导致异常结果的原因，但我绝对可以同情！

为了解决这个问题，您需要做三件事：

1.  将刚体转换为运动学刚体
2.  调整身体运动状态而不是刚体的世界变换
3.  将运动学体转换回刚体

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-28T04:57:31.720

一个经过测试的简短代码片段通过将刚体的运动状态更新到其新的位置和方向，并消除作用在其上的所有速度和力，有效地传送刚体。

```
 void teleport(btVector3 position, btQuaternion& orientation) const {

        btTransform transform;
        transform.setIdentity();

        transform.setOrigin(position);
        transform.setRotation(orientation); 

        m_rigidBodyVehicle->setWorldTransform(transform);
        m_rigidBodyVehicle->getMotionState()->setWorldTransform(transform);

        m_rigidBodyVehicle->setLinearVelocity(btVector3(0.0f, 0.0f, 0.0f));
        m_rigidBodyVehicle->setAngularVelocity(btVector3(0.0f, 0.0f, 0.0f));
        m_rigidBodyVehicle->clearForces();
} 
```

# php - 如何在 php 电子邮件模板中包含简码

> ID：12251200
> 
> 赞同：0
> 
> 时间：2012-09-03T16:11:38.963
> 
> 标签：php

我有在用户注册后发送的确认电子邮件。现在，我希望管理员能够自定义此电子邮件，更改内容。等（不想硬编码）

但这里的问题是我将生成的激活链接。我想我可以将电子邮件内容保存在数据库中。问题在于我必须添加到电子邮件中的动态元素，例如激活链接、站点名称等。

最好的方法是什么，我想我会像 wordpress 那样添加所谓的“短代码”。这个蓝图是什么以及如何整合它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:22:09.483

您可以使用基于搜索和替换的简单模板系统来解决它；我在下面包含了一个非常基本的示例和一个简短的示例。希望它可以帮助你:)

```
class EmailTemplate
{
        private $body;

        public function __construct($template)
        {
                $this->body = $template;
        }

        public function render($context)
        {
                return preg_replace_callback('/%{(.*?)}%/', function($v) use ($context) {
                        return isset($context[$v[1]]) ? $context[$v[1]] : '';
                }, $this->body);
        }
}

$tpl = new EmailTemplate(<<<EOM
Hello %{user}%,

How are you doing. This is your link:

%{link}%

See ya!

EOM
);

echo $tpl->render(array(
        'user' => 'world',
        'link' => 'http://www.php.net/',
)); 
```

# python - 无法使用opencv使用霍夫变换定位线

> ID：12251214
> 
> 赞同：1
> 
> 时间：2012-09-03T16:13:15.507
> 
> 标签：python, opencv, image-processing, hough-transform

我想使用霍夫变换在下图中找到线条，但我失败了。有人可以告诉问题出在哪里吗？

我正在使用来自 opencv 的标准代码。

我正在使用 python 和 opencv 2.4.2

发现：

1.  这些矩形线非常锯齿
2.  边缘检测发现断边
3.  即使您指定要连接的参数以填补空白，也无济于事。

非常感谢。

![用于线检测的图像](../Images/7aae432afe63e067504bfc3faa0ed637.png)

**编辑** 正如“jpa”所建议的，图像被反转并且边缘检测步骤也被跳过

这是反转后的图像

![在此处输入图像描述](../Images/1f34c215cbd1f6a23e7c28ce4b041f03.png)

使用的参数如下

```
 HoughLinesP(image,10, math.pi/2 ,10       ,None ,1000,          1)
    HoughLinesP(image,rho, theta    ,threshold,lines,minLineLength, maxLineGap) 
```

输出如下，红色表示存在线条。

![在此处输入图像描述](../Images/537512b9e0773511c4125a4b29558741.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:45:19.187

将您的原始图像作为以下程序的输入会产生以下结果： ![在此处输入图像描述](../Images/9474a13d8683357604790f7cf79fd4b8.png)

绿线代表成功检测到的内容。该程序是对 OpenCV 附带的原始**正方形**示例的轻微修改。

我由你来编写忽略最大行（[识别纸张](https://stackoverflow.com/questions/8667818/opencv-c-obj-c-detecting-a-sheet-of-paper-square-detection/8863060#8863060)）的代码。

这些行存储在`vector<vector<Point> > squares`声明中`main()`：

```
#include "highgui.h"
#include "cv.h"

#include <iostream>
#include <math.h>
#include <string.h>

using namespace cv;
using namespace std;

void help()
{
        cout <<
        "\nA program using pyramid scaling, Canny, contours, contour simpification and\n"
        "memory storage (it's got it all folks) to find\n"
        "squares in a list of images pic1-6.png\n"
        "Returns sequence of squares detected on the image.\n"
        "the sequence is stored in the specified memory storage\n"
        "Call:\n"
        "./squares\n"
    "Using OpenCV version %s\n" << CV_VERSION << "\n" << endl;
}

int thresh = 70, N = 2; 
const char* wndname = "Square Detection Demo";

// helper function:
// finds a cosine of angle between vectors
// from pt0->pt1 and from pt0->pt2
double angle( Point pt1, Point pt2, Point pt0 )
{
    double dx1 = pt1.x - pt0.x;
    double dy1 = pt1.y - pt0.y;
    double dx2 = pt2.x - pt0.x;
    double dy2 = pt2.y - pt0.y;
    return (dx1*dx2 + dy1*dy2)/sqrt((dx1*dx1 + dy1*dy1)*(dx2*dx2 + dy2*dy2) + 1e-10);
}

// returns sequence of squares detected on the image.
// the sequence is stored in the specified memory storage
void findSquares( const Mat& image, vector<vector<Point> >& squares )
{
    squares.clear();

    Mat pyr, timg, gray0(image.size(), CV_8U), gray;

    // karlphillip: dilate the image so this technique can detect the white square,
    Mat out(image);
    dilate(out, out, Mat(), Point(-1,-1));
    // then blur it so that the ocean/sea become one big segment to avoid detecting them as 2 big squares.
    medianBlur(out, out, 3);

    // down-scale and upscale the image to filter out the noise
    pyrDown(out, pyr, Size(out.cols/2, out.rows/2));
    pyrUp(pyr, timg, out.size());
    vector<vector<Point> > contours;

    // find squares in every color plane of the image
    for( int c = 0; c < 1; c++ )
    {
        int ch[] = {c, 0};
        mixChannels(&timg, 1, &gray0, 1, ch, 1);

        // try several threshold levels
        for( int l = 0; l < N; l++ )
        {
            // hack: use Canny instead of zero threshold level.
            // Canny helps to catch squares with gradient shading
            if( l == 0 )
            {
                // apply Canny. Take the upper threshold from slider
                // and set the lower to 0 (which forces edges merging)
                Canny(gray0, gray, 0, thresh, 5);
                // dilate canny output to remove potential
                // holes between edge segments
                dilate(gray, gray, Mat(), Point(-1,-1));
            }
            else
            {
                // apply threshold if l!=0:
                //     tgray(x,y) = gray(x,y) < (l+1)*255/N ? 255 : 0
                gray = gray0 >= (l+1)*255/N;
            }

            // find contours and store them all as a list
            findContours(gray, contours, CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE);

            vector<Point> approx;

            // test each contour
            for( size_t i = 0; i < contours.size(); i++ )
            {
                // approximate contour with accuracy proportional
                // to the contour perimeter
                approxPolyDP(Mat(contours[i]), approx, arcLength(Mat(contours[i]), true)*0.02, true);

                // square contours should have 4 vertices after approximation
                // relatively large area (to filter out noisy contours)
                // and be convex.
                // Note: absolute value of an area is used because
                // area may be positive or negative - in accordance with the
                // contour orientation
                if( approx.size() == 4 &&
                    fabs(contourArea(Mat(approx))) > 1000 &&
                    isContourConvex(Mat(approx)) )
                {
                    double maxCosine = 0;

                    for( int j = 2; j < 5; j++ )
                    {
                        // find the maximum cosine of the angle between joint edges
                        double cosine = fabs(angle(approx[j%4], approx[j-2], approx[j-1]));
                        maxCosine = MAX(maxCosine, cosine);
                    }

                    // if cosines of all angles are small
                    // (all angles are ~90 degree) then write quandrange
                    // vertices to resultant sequence
                    if( maxCosine < 0.3 )
                        squares.push_back(approx);
                }
            }
        }
    }
}    

// the function draws all the squares in the image
void drawSquares( Mat& image, const vector<vector<Point> >& squares )
{
    for( size_t i = 1; i < squares.size(); i++ )
    {
        const Point* p = &squares[i][0];
        int n = (int)squares[i].size();
        polylines(image, &p, &n, 1, true, Scalar(0,255,0), 3, CV_AA);
    }

    imshow(wndname, image);
}    

int main(int argc, char** argv)
{
    if (argc < 2)
    {
        cout << "Usage: ./program <file>" << endl;
        return -1;
    }

    static const char* names[] = { argv[1], 0 };

    help();
    namedWindow( wndname, 1 );
    vector<vector<Point> > squares;

    for( int i = 0; names[i] != 0; i++ )
    {
        Mat image = imread(names[i], 1);
        if( image.empty() )
        {
            cout << "Couldn't load " << names[i] << endl;
            continue;
        }

        findSquares(image, squares);
        drawSquares(image, squares);
        imwrite("out.jpg", image);

        int c = waitKey();
        if( (char)c == 27 )
            break;
    }

    return 0;
} 
```

# web-crawler - An acceptable method to detect a trusted spider and not redirect them

> ID：12251219
> 
> 赞同：0
> 
> 时间：2012-09-03T16:13:43.433
> 
> 标签：web-crawler

i've implemented a Single Sign On feature which redirects the user to another domain and back again. Naturally, I don't want search engines (the ones we care about at least) to be redirected, so what's an acceptable solution?

Here's one I found in PHP

```
$agent = strtolower($_SERVER['HTTP_USER_AGENT']);
if (strpos($agent, "bot") ||
    strpos($agent, "slurp") ||
    strpos($agent, "crawl") ||
    strpos($agent, "google") ||
    strpos($agent, "teoma") ||
    strpos($agent, "spider") ||
    strpos($agent, "feed") ||
    strpos($agent, "index")) {
  return null;
} 
```

Maybe the best solution would actually be to detect and only redirect **real users** ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T06:09:10.563

最好检查用户代理字符串中是否存在渲染引擎，例如 Gecko/AppleWebKit/Opera/Trident/，因为大多数爬虫不包含此字符串。这样，您将只重定向浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:58:05.183

我得出的结论是，这仅是识别最受信任和主流的蜘蛛/爬虫的一种可接受的方式。如果用户在其用户代理字符串中有上述任何一项，那么他们要么是蜘蛛，要么是假装是蜘蛛的人。

当然会有蜘蛛/爬虫在他们的用户代理字符串中不包含上述内容，这不会检测到它们。如果这对您很重要，请不要使用此方法，而是寻求替代且定期更新的解决方案，该解决方案可能使用 IP 地址查找

# php - 小部件创建：Access-Control-Allow-Origin 和会话问题，我该如何解决？

> ID：12251225
> 
> 赞同：1
> 
> 时间：2012-09-03T16:14:24.180
> 
> 标签：php, session, widget

我正在创建一个要包含在托管网页中的小部件（使用 PHP 和 jQuery），实际上我有点卡住了，因为我在下面描述了这两个问题：

1.  在我的小部件中，有一些命令应该对 php 脚本执行 AJAX 调用以检索数据，但我总是遇到 access-Control-Allow-Origin 错误，最初我以为我解决了这个问题，将这一行放在 php 中： header("Access -Control-Allow-Origin: *"); 但它直到现在只在 Firefox 上工作，Chrome 仍然拒绝给我 php 输出

2.  总是在谈论 AJAX 调用：用户执行启动这些调用的选择，我想跟踪用户的选择。我想用 PHP 使用会话。这里的问题是任何呼叫似乎都有不同的 session_id ......有什么想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:40:28.250

1.  看看[JSONP](http://en.wikipedia.org/wiki/JSONP)
2.  您可以从 javascript 生成（可能得到？）用户 ID，然后将其与请求一起发送。

您的问题 #2 的解释：PHP 会话使用 cookie 和 GET 参数。PHP 生成会话 ID 并将其放入 cookie 或 GET 字符串。然后，当请求返回时，它会读取 cookie（GET 参数）并知道要获取哪些会话。在您的情况下，您从原始页面（不是您的域）获取 cookie，因此没有会​​话 id（属于您的服务器），并且您的服务器除了生成新页面外无事可做。

作为一个选项，您可以考虑嵌入您的小部件，`iframe`它将解决您的所有问题，包括同源和会话处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T15:17:38.160

为了将纯 AJAX 与 jQuery/JavaScript 一起使用，您可能需要考虑查看如何随请求生成 cookie。cookie 只是作为与您的请求一起发送的标头的一部分添加的，您需要做的就是将当前用户的会话 cookie 注入到任何 AJAX 请求中，以确保用户仍然被认为是相同的您的小部件将在后台向其他脚本发出的每个请求的用户。自从我对这些类型的请求使用 jQuery/JavaScript 以来已经有一段时间了，但我相信有一种方法可以在发送请求之前将标头添加到请求中。您可能需要为标题制作原始 cookie，但简单的 Google 搜索应该会显示您需要的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:59:30.447

我想回答我的问题，只是为了帮助遇到同样麻烦的人。

如果不是必须使用 Javascript/Jquery 来实现您的小部件，我发现将您的小部件实现为 Adob​​e Flash swf 应用程序将解决上述所有问题。

使用 AS3，您可以对 php 文件执行远程 Http 请求。并且所有请求都将作为单个会话进行跟踪。Access-Control-Allow-Origin 没有问题。

domainhost.com 可以加载到标签 domain1.com/widgetflash.php 然后页面内加载的 widget.swf 可以执行远程请求，如下所示：

```
urlRequest= new URLRequest("http://www.example.com/source/setChoice.php");
_urlLoader = new URLLoader(); 
_urlLoader.addEventListener(Event.COMPLETE, onXMLDataLoaded, false, 0, true);
_urlLoader.load(urlRequest); 
```

# xcode4.3 - (EDIT)add a sql resource

> ID：12251226
> 
> 赞同：1
> 
> 时间：2012-09-03T16:14:30.773
> 
> 标签：xcode4.3

how can I add my database file to my project?

I do as usual, "add files to projectName" and select the sql file, it is supposed added

![enter image description here](../Images/bd7f922af3c0fae11a55dca228f9527a.png)

but, I have the same response to my code if this is added or not, so, I suppose the resource is not properly added

How should I do it?

Thank you in advance

I did:

![enter image description here](../Images/c290ee427b21ceea363e4a69a55f0f5b.png)

Is that what I should do, isn't it?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:59:55.117

您是否尝试将 sql 文件的 Copy to output 属性设置为始终复制？

来自 msdn：

复制到输出目录属性 此属性指定将所选源文件复制到输出目录的条件。如果永远不要将文件复制到输出目录，请选择不复制。如果要始终将文件复制到输出目录，请选择始终复制。如果仅当文件比输出目录中同名的现有文件更新时才复制文件，请选择如果更新则复制。

# url - 我可以在没有 Google 索引的情况下创建一个实时网站吗？

> ID：12251230
> 
> 赞同：0
> 
> 时间：2012-09-03T16:14:37.283
> 
> 标签：url

如果你有一个开发者。网站并且不想让谷歌索引它，你会怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:22:38.237

`robots.txt`您应该在您的 webroot 中创建一个`index.html`包含此内容的位置。

```
User-agent: *
Disallow: / 
```

在你的`index.html`你应该把这行：

```
<head>
...
    <meta name="robots" content="noindex, nofollow">
...
</head> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-03T16:17:03.290

我使用那种你必须先登录才能看到任何东西的方法。你可以放一些元标签放它会没用谷歌发现它。

# performance - What is the overhead for thread creation in the .net micro framework?

> ID：12251232
> 
> 赞同：0
> 
> 时间：2012-09-03T16:15:13.393
> 
> 标签：performance, .net-micro-framework, netduino

I was curious as to what are the impacts of thread creation were on a netduino running the .net micro framework. It's commonly understood that threads have an [inherent overhead](http://msdn.microsoft.com/en-us/magazine/cc163552.aspx#S4) to them but I was wondering if anyone knew if there were optimizations or not for .net micro on an embedded environment and if anyone can give me some detail as to what happens under the hood with a thread here (how much memory is allocated, how many cycles it takes to generate, etc).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T23:41:09.463

根据我的经验，NETMF 下每个线程的内存成本大约为 1K。至于分配线程所需的时间，如果您正在考虑这样的问题，可能是时候阅读一下嵌入式系统最佳实践了。我不是在嘲笑你，有相当多的来之不易的传说可以为你省去心痛和麻烦。举个例子，线程的事情。如果你想要可靠性，你必须保证最大的资源需求。如果您要说“不超过 5 个线程”，那么您也可以在初始化过程中启动所有五个线程，并分配他们想要的所有资源。如果你不能这样做，那么你就不能保证你的系统在负载下的稳定性。

上下文切换存在开销。我不能给你量化的数字，因为我从来不需要对它进行基准测试。NETMF 直接在金属上实现；您很可能可以从 SoC 文档中获得一些见解，您可以从 ATMEL 下载该文档。或者，如果您在 netduino 论坛上提问，克里斯很有可能会立即告诉您。

如果这是一个家庭作业问题，那么请采纳 Hans 的建议并查看源代码。如果您正在寻找构建某些东西并评估应用程序的平台适用性，那么可能会感兴趣的是，我在不同线程上执行时间敏感的事情时从未遇到过切换延迟，但我从未使用超过三个或四个线程和其中一个以循环方式为许多逻辑进程（所有对时间不敏感的东西）提供服务。

再次强调，长期稳定的关键是避免动态分配*任何东西*。

显式编码循环的一个优点是您可以控制逻辑进程的顺序。

# html - 如何使用 HTML 和 CSS 设计全宽栏

> ID：12251234
> 
> 赞同：0
> 
> 时间：2012-09-03T16:15:24.087
> 
> 标签：html, css, width

我想创建一个适合页面宽度*100%*的全宽导航栏，就像这个网站的栏一样，它包含 *Inicio | 活动 | 通讯：

> [https://community.jivesoftware.com/welcome](https://community.jivesoftware.com/welcome)

我只想使用`HTML`and `CSS`。另一方面，栏不必在顶部。

我想做一些与图片非常相似的事情，但我不知道如何实现

请分享一个简单的例子！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:20:56.590

将您的栏包含在一个带有一些 id 的 div 中，例如

```
<div id="mybar">
    <!-- your HTML -->
</div> 
```

在 CSS 上，使用以下属性

```
#mybar{
    position:fixed;
    top:0;
    left:0;
    right:0;
    height:50px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:26:56.913

看看这是我为你做的...

[http://jsfiddle.net/x6PrR/](http://jsfiddle.net/x6PrR/)

它展示了如何做到这一点并添加另一个 DIV 以获得一些不错的填充/间距。

祝你好运！

**编辑：**

*HTML*

```
<div id="nav">
    <div id="nav-inner">
        <p>Some navigations stuff...</p>
    </div>
</div>

<!-- we set the first DIV to full width 100%. Because we do this, we can't add padding because that will make it larger than 100%...weird I know. A way around this is to then add another DIV inside to create the padding that has a width of AUTO. --> 
```

*CSS*

```
#nav { float: left; clear: both; width: 100%; margin: 0; padding: 0; background: #222; }
#nav-inner { float: left; clear: both; width: auto; margin: 0; padding: 10px 20px; background: transparent; }
p { color: #fff; font-family: arial; font-weight: bold; } 
```

# sql - SQL查询 - 将单元格变为列

> ID：12251242
> 
> 赞同：0
> 
> 时间：2012-09-03T16:15:45.180
> 
> 标签：sql, sql-server, pivot

我有一个返回这样的项目的查询

```
Item    --  Code   --  Thing
------------------------------
Item A  --  Code A --  Thing 1
Item A  --  Code A --  Thing 2
Item A  --  Code A --  Thing 3
Item A  --  Code A --  Thing 4
Item B  --  Code B --  Thing x
Item B  --  Code B --  Thing y
Item C  --  Code C --  Thing z
Item C  --  Code C --  Thing a
Item C  --  Code C --  Thing b
Item C  --  Code C --  Thing c 
```

我想把它变成这样的东西

```
Item    --  Code   --  Thing 1 -- Thing 2 -- Thing 3 -- Thing 4 -- Thing 5
---------------------------------------------------------------------------
Item A  --  Code A --  Thing 1 -- Thing 2 -- Thing 3 -- Thing 4 -- NULL
Item B  --  Code B --  Thing x -- Thing y -- NULL    -- NULL    -- NULL
Item C  --  Code C --  Thing a -- Thing b -- Thing c -- Thing d -- NULL 
```

任何超过 5 的项目都可以忽略。

* * *

更新：

通过添加“ROW_NUMBER() over (Partition by Table.Id order by Table2.Id)”在我的查询中，我现在得到：

```
Item    --  Code   --  Thing  -- Index
---------------------------------------
Item A  --  Code A --  Thing 1 -- 1
Item A  --  Code A --  Thing 2 -- 2
Item A  --  Code A --  Thing 3 -- 3
Item A  --  Code A --  Thing 4 -- 4
Item B  --  Code B --  Thing x -- 1
Item B  --  Code B --  Thing y -- 2
Item C  --  Code C --  Thing z -- 1
Item C  --  Code C --  Thing a -- 2
Item C  --  Code C --  Thing b -- 3
Item C  --  Code C --  Thing c -- 4 
```

这允许我使用 Pivot 函数并相应地更改数据。仍在努力，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:46:26.813

您可以使用 PIVOT 运算符

这是针对类似问题的示例查询

```
SELECT *
FROM
    (
    SELECT Contact_Id AS CT
          , [Age]
          , [Sex]
          , [State]
          , [Country]
          , [Keyword]
          , [Married]
          , [Kids]
          , [Car]
     FROM
         (SELECT c.PropertyName
               , c.ValueString
               , c.Contact_Id
          FROM
              ContactProfiles c) AS ctp
         PIVOT (max(ctp.ValueString) FOR PropertyName IN ([Age], [Sex], [State], [Country], [Keyword], [Married], [Kids], [Car])) AS PivotTable
         ) AS pvt

WHERE
    pvt.[Age] > 18 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:22:58.897

（第一次尝试不起作用）一种简洁的编码方法是：

```
 SELECT
        Item,
        Code,
        Thing1 = Case When Thing = 'Thing 1' Then 'Thing 1' Else Null End,
        Thing2 = Case When Thing = 'Thing 2' Then 'Thing 2' Else Null End,
        Thing3 = Case When Thing = 'Thing 3' Then 'Thing 3' Else Null End,
        Thing4 = Case When Thing = 'Thing 4' Then 'Thing 4' Else Null End,
        Thing5 = Case When Thing = 'Thing 5' Then 'Thing 5' Else Null End
   FROM [Items]
   WHERE Thing BETWEEN 'Thing 1' AND 'Thing 5' -- preselection should improve performance
   GROUP BY 
        Item,
        Code,
        Thing1 = Case When Thing = 'Thing 1' Then 'Thing 1' Else Null End,
        Thing2 = Case When Thing = 'Thing 2' Then 'Thing 2' Else Null End,
        Thing3 = Case When Thing = 'Thing 3' Then 'Thing 3' Else Null End,
        Thing4 = Case When Thing = 'Thing 4' Then 'Thing 4' Else Null End,
        Thing5 = Case When Thing = 'Thing 5' Then 'Thing 5' Else Null End 
```

之所以有效，是因为您有一个已知的、有限数量的要旋转的列。PIVOT 功能是另一种方式，但我不熟悉这种方式。

（第二次尝试）这行得通！

```
 DECLARE @Items TABLE
    (
        Item    char(1),
        Code    char(1),
        Thing   char(1)
    )
    INSERT INTO @Items
    SELECT 'A', 'A', '1'
    UNION
    SELECT 'A', 'A', '2'
    UNION
    SELECT 'A', 'A', '3'
    UNION
    SELECT 'A', 'A', '4'
    UNION
    SELECT 'B', 'B', 'x'
    UNION
    SELECT 'B', 'B', 'y'
    UNION
    SELECT 'C', 'C', 'f'
    UNION
    SELECT 'C', 'C', 'g'
    UNION
    SELECT 'C', 'C', 'h'
    UNION 
    SELECT 'C', 'C', 'j'

    SELECT
        Items.Item,
        Items.Code,
        Thing1 = Max(Case When OrderedItems.ThingPlace = 1 Then OrderedItems.Thing Else Null End),
        Thing2 = Max(Case When OrderedItems.ThingPlace = 2 Then OrderedItems.Thing Else Null End),
        Thing3 = Max(Case When OrderedItems.ThingPlace = 3 Then OrderedItems.Thing Else Null End),
        Thing4 = Max(Case When OrderedItems.ThingPlace = 4 Then OrderedItems.Thing Else Null End),
        Thing5 = Max(Case When OrderedItems.ThingPlace = 5 Then OrderedItems.Thing Else Null End)
    FROM @Items Items
        LEFT OUTER JOIN 
        (
            SELECT
                Code, Thing, 
                ThingPlace = Row_Number() OVER (PARTITION BY Code ORDER BY Thing)
            FROM @Items
            GROUP BY Code, Thing
        ) OrderedItems
            ON OrderedItems.Code = Items.Code
    WHERE OrderedItems.ThingPlace Is Null OR OrderedItems.ThingPlace <= 5
    GROUP BY
        Items.Item,
        Items.Code 
```

结果：

AA 1 2 3 4 空

BB xy NULL NULL NULL

抄送 fghj 空

诀窍是首先建立一个有序的列表。我只使用了代码进行查找，因为在这种情况下，给定的数据是关键（项目并不重要）。您可能必须扩展连接连接。然后使用有序列表，我按顺序排除第六位以上的所有事物。这仅在事物实际上是自然顺序时才有效 - 否则它会回到平方，首先找出事物是什么。

# java - How can i replace String "AXA || BXB && CXC || BXB" to "AXA OR BXB && CXC OR BXB"?

> ID：12251243
> 
> 赞同：2
> 
> 时间：2012-09-03T16:15:50.257
> 
> 标签：java, string, escaping, replace

How can i replace String `AXA || BXB && CXC || BXB` to `AXA OR BXB && CXC OR BXB` ?

i tried

```
expression = "AXA || BXB && CXC || BXB";
expression = expression.replaceAll("||", " OR "); 
```

But this doesnt provide desired result ie `AXA OR BXB && CXC OR BXB`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:19:00.697

不要使用正则表达式，`replace`而是尝试使用例程

```
expression = "AXA || BXB && CXC || BXB";
expression = expression.replace("||", " OR "); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:18:24.590

[`replaceAll`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)使用正则表达式，并且`|`是一个特殊字符，表示*交替*。因此，您需要*转义*它才能使用文字`|`：

```
String s = "AXA || BXB && CXC || BXB";
System.out.println(s.replaceAll("\\|\\|", "OR")); 
```

或者更好的是，只需使用[`replace()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)，它不使用正则表达式：

```
String s = "AXA || BXB && CXC || BXB";
System.out.println(s.replace("||", "OR")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:18:48.667

`replaceAll`将正则表达式作为第一个参数，请尝试使用`replace`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T16:28:50.277

It's easy to forget what all the special characters are in regular expressions. I'm now in the habit of using [`String Pattern.quote(String s)`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#quote%28java.lang.String%29) around any literal I want to include that has any non-alphanumeric characters in it.

(If this case is as simple as you describe, I agree that replace() is the better choice.)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T16:19:24.560

没有理由在[`String#replaceAll()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)这里使用，它将模式视为正则表达式。使用[`String#replace()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)并且您不必担心转义[模式中的特殊字符](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#logical)。

```
expression = "AXA || BXB && CXC || BXB";
expression = expression.replace("||", " OR "); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T16:19:27.387

你需要逃离`|`

```
String expression = "AXA || BXB && CXC || BXB";
expression = expression.replaceAll(" ?\\|\\| ?", " OR ");
System.out.println(expression); 
```

印刷

```
AXA OR BXB && CXC OR BXB 
```

# javascript - spying upon a global function using jasmine-node

> ID：12251245
> 
> 赞同：2
> 
> 时间：2012-09-03T16:16:10.910
> 
> 标签：javascript, node.js, jasmine

I am using jasmine-node to do unit testing on javascript code. I have a number of global functions which I would like to spyOn and allow the call to make it though to the original implementation. See the code below as an example.

For a reason I cannot explain, I am seeing an error "globalFunction() method does not exist".

Can someone tell me why jasmine is not able to find this globalFunction method which I understand to be in global scope.

I appreciate the help

```
var globalFunction = function() {
    console.log('globalFunction');
};

describe("A Global Function", function() {
    jasmine.getEnv().addReporter(new jasmine.ConsoleReporter(console.log));
    it("may be spied upon", function() {
        spyOn(global,'globalFunction').andCallThrough();
        globalFunction();
        expect(globalFunction).toHaveBeenCalled();
    });
}); 
```

Here is the output of jasmine-node

```
$ jasmine-node  --verbose test.spec.js 
Runner Started.
A Global Function : may be spied upon ... 
Failed.
A Global Function: 0 of 1 passed.

A Global Function
  may be spied upon

Failures:

  1) may be spied upon
   Message:
     globalFunction() method does not exist
   Stacktrace:
     undefined

Finished in 0.008 seconds
1 test, 1 assertion, 1 failure

Runner Finished.
1 spec, 1 failure in 0.008s. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:37:31.300

`globalFunction`实际上，您不是全球性的。删除`var`关键字以使其全局化。

```
globalFunction = function() {
    console.log('globalFunction');
}; 
```

> 在浏览器中，顶级作用域是全局作用域。这意味着在浏览器中，如果您在全局范围 var 中，某些东西将定义一个全局变量。在 Node 中，这是不同的。顶级范围不是全局范围；var 节点模块中的某些内容将是该模块的本地内容。

# c++ - How to reinsert string on the stringstream?

> ID：12251246
> 
> 赞同：1
> 
> 时间：2012-09-03T16:16:23.360
> 
> 标签：c++, stringstream

```
std::string szKeyWord;
...
std::stringstream szBuffer(szLine);
szBuffer>>szKeyWord;
...
szBuffer<<szKeyWord;
szBuffer>>myIntVar; // will NOT format keyword here, will act as the line above never happened. 
```

Pretty much self explanatory. I want to undo the last ">>" and use it as if it never happens.

Context: Im checking for keywords, but if its not a keyword, I should keep collecting it as data, because its an array data, and there can be comment between lines.

EDIT:

After a LOT of try and error, I get this to work:

```
szBuffer.seekg((int)szBuffer.tellg() - (int)szKeyWord.length()); 
```

Dont look elegant to me, but looks like its working fine.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T12:19:20.950

尝试这样的事情：

```
using namespace std;

string PeekString(stringstream& ss, int position = 0, char delim = '\n', int count = 0)
{
    string returnStr = "";
    int originalPos = (position > 0) ? position : ss.tellg();
    if (originalPos == position) ss.seekg(position);
    int pos = originalPos;
    int i = 0, end = (count < 1) ? ss.str().length() : count;
    char c = ss.peek();

    while (c != delim && !ss.eof() && i != end)
    {
        returnStr += c;
        pos++;
        i++;
        ss.seekg(pos);
        c = ss.peek();
    }
    ss.seekg(0);
    return returnStr;
} 
```

用法是这样的：

```
int main()
{
    string s = "Hello my name is Bob1234 68foo87p\n";
    stringstream ss;
    ss << s;
    cout << "Position 0, delim \'\\n\': " << PeekString(ss) << endl;
    cout << "Position 0, delim \' \': " << PeekString(ss,0,' ') << endl;
    cout << "Position 17, delim \' \': " << PeekString(ss,17,' ') << endl;
    cout << "Position 25, delim \'\\n\': " << PeekString(ss, 25) << endl;
    cout << "Position 27, count 3: " << PeekString(ss, 27, '\n', 3) << endl << endl;

    string newstring;
    char temp[100];
    ss.getline(temp, 100);
    newstring = temp;

    cout << "What's left in the stream: " << newstring;

    cin.get();
    return 0;
} 
```

输出如下所示：

*   位置 0，delim '\n'：你好，我的名字是 Bob1234 68foo87p
*   位置 0, delim ' ': 你好
*   位置 17，分隔符''：Bob1234
*   位置 25，分隔符 '\n': 68foo87p
*   位置 27，计数 3：foo

*   流中剩下的内容：您好，我的名字是 Bob1234 68foo87p

# tsql - Converting string with am/pm in date

> ID：12251247
> 
> 赞同：0
> 
> 时间：2012-09-03T16:16:29.507
> 
> 标签：tsql

I have a varchar field in where I have the following value: 03/09/2012 11:40:25 a.m.

I need to convert this string in datetime. When I try to apply CONVERT but I get error.

Thanks in advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:19:57.760

假设正确的`DATEFORMAT`顺序是导致问题的时期；

```
convert(datetime, replace('03/09/2012 11:40:25 a.m.', '.', '')) 
```

# android - Black screen with SGS1

> ID：12251249
> 
> 赞同：3
> 
> 时间：2012-09-03T16:16:32.823
> 
> 标签：android, opengl-es-2.0, galaxy

I'm working on a game which runs quite well on a lot of Android devices (Lexus 7, SG ACe, HTC Desire ...). But especially for SGS1, I can't get better than a black screen. After investigating a lot into the whole code, I think that the problem is located in my shader code. Compilation is ok, link too, but I hear about some incompatibility between different GPU (here [http://www.jpct.net/forum2/index.php/topic,2833.15.html](http://www.jpct.net/forum2/index.php/topic,2833.15.html) for example)

Here's the shader code :

[VERTEX]

```
uniform mat4 uMVPMatrix;    // Ortho matrix
attribute vec2 vPosition;   // Vertex position
void main(){
    gl_Position = uMVPMatrix * vec4(vPosition, 0.0, 1.0);
} 
```

[FRAGMENT]

```
precision mediump float;
uniform lowp vec4 CurColor;
void main(){
    gl_FragColor = CurColor;
} 
```

Maybe something is obviously wrong in this, even if it is very basic ? Thank you in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T07:19:30.000

我终于弄明白了。我有两个问题：

1) PowerVR 似乎不喜欢制服的“lowp”限定词

2) 在其他着色器中，我为 vPosition 设置了“vec4”，尽管我只通过顶点 (X,Y) 传递了 2 个组件。奇怪的是：为什么其他 GPU 可以处理这样的错误？像 mali (malideveloper.com/developer-resources/tools/...) 提供的那种检查器对于 PowerVR 来说会非常令人耳目一新！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:53:43.737

这里有一些建议：

*   尝试查看是否有任何 LogCat 错误
*   看看是否`glGetError()`返回不同于 0 的东西
*   更改清除颜色以查看屏幕是否保持黑色，如果更改，则您的对象是不可见的

在你尝试了其中一些之后给我评论。

# c - C: memcpy speed on dynamically allocated arrays

> ID：12251252
> 
> 赞同：13
> 
> 时间：2012-09-03T16:16:56.090
> 
> 标签：c, performance, malloc, memcpy

I need help with the performance of the following code. It does a memcpy on two dynamically allocated arrays of arbitrary size:

```
int main()
{
  double *a, *b;
  unsigned n = 10000000, i;
  a = malloc(n*sizeof(double));
  b = malloc(n*sizeof(double));
  for(i=0; i<n; i++) {
    a[i] = 1.0;
    /* b[i] = 0.0; */
  }

  tic();
  bzero(b, n*sizeof(double));
  toc("bzero1");

  tic();
  bzero(b, n*sizeof(double));
  toc("bzero2");

  tic();
  memcpy(b, a, n*sizeof(double));
  toc("memcpy");
} 
```

tic/toc measure the execution time.

On my computer it takes 0.035s to memcpy (Linux, gcc version 4.4.6). If I now uncomment the line which initializes the destination array b, the code is three times faster (!) - 0.011s.

I have observed similar behavior when using a loop instead of memcpy. Usually I do not care about this since it is enough to 'initialize' the memory before using it. However, I now need to perform a simple memory copy, and do it as fast as possible. Initializing the data requires writing e.g. 0 to the memory, which is not necessary and takes time. And I would like to perform a memory copy with all available memory bandwidth.

Is there a solution to this problem? Or is it connected to the way Linux handles dynamic memory (some sort of lazy page allocation?) and can not be worked around? How is it on other systems?

**Edit:** The same results are obtained with gcc 4.6\. I used -O3 to compile.

**Edit:** Thank you all for your comments. I do understand that memory mapping takes time. I guess I just have a hard time accepting that it takes so long, much longer than the actual memory access. The code has been modified to include a benchmark of the initialization of array b using two subsequent bzero calls. The timings now show

bzero1 0.273981
bzero2 0.056803
memcpy 0.117934

Clearly, the first bzero call does **much** more than just stream zeros to memory - that is memory mapping and memory zeroing. The second bzero call on the other hand takes half of the time required to do a memcpy, which is exactly as expected - write only time vs. read and write time. I understand that the overhead of the second bzero call must be there due to OS security reasons. What about the rest? Can I not decrease it somehow, e.g. use larger memory pages? Different kernel settings?

I should mention that I run this on Ubuntu wheeze.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-03T16:23:40.260

这可能是惰性页面分配，Linux 仅在首次访问时映射页面。IIRC Linux 中新块中的每一页都是空白页的写时复制，并且您的分配足够大以需要新块。

如果你想解决它，你可以以 4k 的间隔写入一个字节或一个字。这可能会使映射到 RAM 的虚拟地址比写入整个每个页面的速度稍快一些。

不过，我不希望（强制延迟内存映射发生的最有效的解决方法）加上（复制）比没有初始化的（复制）要快得多`b`。因此，除非有特定原因您只关心副本的性能，而不是整个操作，否则它是徒劳的。它是“现在付款或以后付款”，Linux 以后付款，您只是在衡量以后的时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T16:30:54.010

当然，如果您将初始化和复制的速度与仅复制的速度进行比较，那么初始化应该包含在定时部分中。在我看来，您实际上应该对此进行比较：

```
// Version 1
for(i=0; i<n; i++)
    a[i] = 1.0;

tic();

memcpy(b, a, n*sizeof(double));

toc(); 
```

对此：

```
// Version 2
for(i=0; i<n; i++)
    a[i] = 1.0;

tic();

for(i=0; i<n; i++)
    b[i] = 0.0;
memcpy(b, a, n*sizeof(double));

toc(); 
```

我预计这将使您的 3 倍速度提升急剧下降。

**编辑：**正如史蒂夫·杰索普（Steve Jessop）所建议的，您可能还想测试第三种策略，即每页只触摸一个条目：

```
// Version 3
for(i=0; i<n; i++)
    a[i] = 1.0;

tic();

for(i=0; i<n; i+=DOUBLES_PER_PAGE)
    b[i] = 0.0;
memcpy(b, a, n*sizeof(double));

toc(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-04T10:26:51.743

由于 (1) 惰性页面分配和 (2) 内核的惰性页面零初始化，第一个 bzero 运行时间更长。虽然第二个原因由于安全原因是不可避免的，但可以通过使用更大（“巨大”）页面来优化惰性页面分配。

在 Linux 上至少有两种使用大页面的方法。困难的方式是[hugetlbfs](http://lwn.net/Articles/374424/)。简单的方法是[透明大页面](http://lwn.net/Articles/423584/)。

在系统上的进程列表中搜索`khugepaged`。如果存在这样的过程，则支持透明大页面，如果您更改为以下内容，则可以在应用程序中使用它们`malloc`：

```
posix_memalign((void **)&b, 2*1024*1024, n*sizeof(double));
madvise((void *)b, n*sizeof(double), MADV_HUGEPAGE); 
```

# ruby-on-rails-3 - 如何修复 Heroku 上 Rails 3.4 activeadmin 中的布尔错误？

> ID：12251253
> 
> 赞同：0
> 
> 时间：2012-09-03T16:16:54.937
> 
> 标签：ruby-on-rails-3, postgresql, heroku

我在 heroku 上运行的 rails 项目中的 activeadmin 中使用了以下形式的 parsial。我在本地使用 sqlite，表单效果很好。

```
 <%= semantic_form_for [:admin, @instagram_tag_search] do |f| %>

       <%= f.inputs do %>
            <%= f.input :name %>
            <%= f.input :active, :as => :boolean  %>
       <% end %>

       <%= f.buttons %>
    <% end %> 
```

在heroku我收到以下错误

```
2012-09-03T16:01:23+00:00 app[web.1]: ActionView::Template::Error (undefined method `active' for #<InstagramTagSearch:0x000000068893b0>):
2012-09-03T16:01:23+00:00 app[web.1]:     2:    
2012-09-03T16:01:23+00:00 app[web.1]:     4:            <%= f.input :name %>
2012-09-03T16:01:23+00:00 app[web.1]:     3:    <%= f.inputs do %>
2012-09-03T16:01:23+00:00 app[web.1]:     6:    <% end %>
2012-09-03T16:01:23+00:00 app[web.1]:     5:            <%= f.input :active, :as => :boolean  %>
2012-09-03T16:01:23+00:00 app[web.1]:     7: 
2012-09-03T16:01:23+00:00 app[web.1]:     8:    <%= f.buttons %>
2012-09-03T16:01:23+00:00 app[web.1]:   app/views/admin/instagram_tag_searches/_form.html.erb:5:in `block (2 levels) in _app_views_admin_instagram_tag_searches__form_html_erb___2113834955800283278_53730580'
2012-09-03T16:01:23+00:00 app[web.1]:   app/views/admin/instagram_tag_searches/_form.html.erb:3:in `block in _app_views_admin_instagram_tag_searches__form_html_erb___2113834955800283278_53730580'
2012-09-03T16:01:23+00:00 app[web.1]:   app/views/admin/instagram_tag_searches/_form.html.erb:1:in `_app_views_admin_instagram_tag_searches__form_html_erb___2113834955800283278_53730580' 
```

在我看来，postgreSQL 和 sqlite 处理布尔/复选框的方式有所不同。在本地，我存储的值是 1 或 0。我想知道对此的简单修复是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:33:38.427

你应该确保你已经在 heroku 上运行了所有的迁移。它们通常不作为部署/推送的一部分运行。

```
heroku rake db:migrate 
```

# entity - Apache HttpClient 返回长度为 -1 的实体

> ID：12251255
> 
> 赞同：2
> 
> 时间：2012-09-03T16:17:11.200
> 
> 标签：entity, httpclient, response

我正在使用具有相同 URL 的基本 http 请求。有时它会返回一个长度为 -1 的实体。而响应状态为 OK 且实体不为空。

我运行该程序大约 10 次，它可以随机运行 2 次，而其他尝试因 "Content-type: text/html, lentgh: -1" 而失败。

还有什么我需要设置的吗？

```
HttpClient client = new DefaultHttpClient();
HttpGet httpGet = new HttpGet(textURL.toString());
HttpResponse response = client.execute(httpGet);
if (response.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
    HttpEntity entity = response.getEntity();
    System.out.println(entity.getContentType() + ", length: " + entity.getContentLength());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-04T09:08:04.763

我也遇到了同样的问题！我认为通过该方法获取的内容长度可能只是从标题中获取！但有时没有内容长度的标题；如果你真的想得到长度，你可以自己消费内容。然后你可以得到长度；

```
public String toString()
{
    InputStream instream=null;
    try{
        instream = this.getContent();
         Charset charset = null;
         if (instream == null) {
                return null;
         }
         int i = (int)this.getContentLength();
         if (i < 0) {
               i = 4096;
         }
         final ContentType contentType = ContentType.get(this);
         if (contentType != null) {
                charset = contentType.getCharset();
         }
         if (charset == null) {
                charset = HTTP.DEF_CONTENT_CHARSET;
         }
         final Reader reader = new InputStreamReader(instream, charset);
         final CharArrayBuffer buffer = new CharArrayBuffer(i);
         final char[] tmp = new char[1024];
         int l;
         int length=0;
         while((l = reader.read(tmp)) != -1) {
               buffer.append(tmp, 0, l);
               length+=l;
         }
         setContentLength(length*2);
         return buffer.toString();
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    finally{
        try {
            instream.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    return "";
} 
```

# visual-studio-2010 - 添加 Web 服务的身份验证问题

> ID：12251258
> 
> 赞同：1
> 
> 时间：2012-09-03T16:17:31.807
> 
> 标签：visual-studio-2010, silverlight, web-services

我目前在部署使用 Web 服务的 silverlight 应用程序时遇到错误。

我在我的笔记本电脑上开发了这个应用程序，它在本地运行，并且编译得很好。我现在在客户端位置，并且正在使用客户端 PC 来编译和部署应用程序。我以前做过这个，没有错误。

以前我必须部署 Web 服务，然后在 silverlight 应用程序中，删除服务引用并重新添加它，这次选择部署的服务而不是本地服务。

但是今天这不起作用，并要求输入用户名和密码来添加服务。但是，这仅在使用完全限定的域名时出现 - 例如 liveweb.company。如果我尝试使用机器的 IP，它会很好地添加引用，而无需密码。

添加基于 IP 的引用和域引用有什么区别？为什么一个需要身份验证而不是另一个？

IIS 配置为使用 Windows 身份验证，但为此输入有效凭据仍将不允许您在 Visual Studio 中添加服务引用。

非常感谢任何提示！

编辑：这篇文章与我的问题相同。是否有最近的补丁破坏了某些东西？[http://social.msdn.microsoft.com/Forums/da-DK/tfssetup/thread/31578cce-760f-44ed-86cc-d799e0239a4d](http://social.msdn.microsoft.com/Forums/da-DK/tfssetup/thread/31578cce-760f-44ed-86cc-d799e0239a4d)

# apache - htaccess：仅在满足规则时才允许访问

> ID：12251262
> 
> 赞同：1
> 
> 时间：2012-09-03T16:17:40.430
> 
> 标签：apache, .htaccess, url-rewriting

我已经用一些重写规则完成了这个 htaccess 文件，但问题是，我能够访问服务器上的单个 .php 文件以及直接访问诸如 domain.com/admin/change_profile.php 之类的部分

这是正常的吗？我认为这不应该发生。如何执行此 htaccess 文件，以便只有在满足规则时才会将我带到该文件夹​​？简而言之：禁止直接访问 domain.com/admin/change_profile.php 或 domain.com/admin/ 或其他任何内容。

```
RewriteEngine on
RewriteRule ^/?(us|uk|eu)/?$ test.php [NC,L] #Country
RewriteRule ^/?(us|uk|eu)/(profile)/([a-zA-z0-9]+)/?$ test.php [NC,L] #Country - Profile 
```

这里：

```
http://localhost/us -> Works
http://localhost/us/profile/companyname -> Works
http://localhost/admin -> Works too! But admin is not in the set of rules above. admin is a folder inside htdocs. 
```

不应该工作，因为它不是 (us|uk|eu) 规则的一部分。注意：它是一个在 htdocs 中包含 php 文件的文件夹。这是如何发生的以及如何克服它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T04:43:27.317

> 这是正常的吗？我认为这不应该发生。

是的，这很正常，这是网络服务器所做的。您拥有的所有规则都没有与 URI 匹配，`/admin/change_profile.php`因此没有任何规则适用，并且网络服务器会执行它应该做的事情：为请求的资源提供服务。如果您不想访问某些内容，可以执行以下操作之一：

*   从文档根目录中删除目录（或将它们移出文档根目录）
*   在您不想访问的目录中添加一个 htaccess 文件：

    ```
    Order allow,deny
    Deny from all 
    ```

*   添加其他规则以重写您不想在文档根目录的 htaccess 文件中访问的目录：

    ```
    RewriteRule ^/?admin test.php [NC,L] 
    ```

*   将所有内容直接路由到 test.php：

    ```
    RewriteRule ^ test.php [L] 
    ```

# javascript - 如果我将 .on('click' 事件附加到 $("body") 会影响性能吗？

> ID：12251266
> 
> 赞同：15
> 
> 时间：2012-09-03T16:18:14.210
> 
> 标签：javascript, jquery

我目前有以下代码：

```
$('#loginLink, #registerLink').click(function () {
        dialog(this);
        return false;
    });

$('#detailData')
    .on('click', '.modalDeleteLink, .modalEditLink', function () {
        dialog(this);
        return false;
    }) 
```

#loginLink 和 #registerLink 只有一个，但类 .modalDeleteLink 和 .modalEditLink 最多可以有一百个元素。

我正在考虑更改所有这些元素，使它们具有 .dialogLink 类，然后仅使用以下代码：

```
$("body").on("click", ".dialogLink", function(){
   dialog(this);
   return false;
}); 
```

这段代码更容易维护。但是，将它附加到身体上会有任何性能劣势吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T16:26:07.050

您无需担心性能，除非您有数百个处理程序或非常大的文档。

[从文档](http://api.jquery.com/on/)中提取：

在大多数情况下，**诸如点击之类的事件很少发生，性能并不是一个重要的问题**。但是，诸如 mousemove 或 scroll 之类的高频事件每秒会触发数十次，在这些情况下，明智地使用事件变得更加重要。可以通过减少处理程序本身完成的工作量、缓存处理程序所需的信息而不是重新计算它，或者通过使用 setTimeout 限制实际页面更新的数量来提高性能。

**在文档树顶部附近**附加许多委托事件处理程序会降低性能。每次事件发生时，jQuery 必须将该类型的所有附加事件的所有选择器与从事件目标到文档顶部的路径中的每个元素进行比较。为获得最佳性能，请将委托事件附加到尽可能靠近目标元素的文档位置。避免过度使用 document 或 document.body 来处理大型文档的委托事件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T16:32:45.567

在 jQuery 中，将 .on() 放在 DOM 中的位置越高，它就会越慢。这是因为 jQuery 必须比较从目标到文档级别的所选类型的所有附加事件的所有选择器。

请参阅[.on() 的 jQuery 文档页面](http://api.jquery.com/on/)：

> 在文档树顶部附近附加许多委托事件处理程序会降低性能。每次事件发生时，jQuery 必须将该类型的所有附加事件的所有选择器与从事件目标到文档顶部的路径中的每个元素进行比较。为了获得最佳性能，请将委托事件附加到尽可能靠近目标元素的文档位置。避免过度使用 document 或 document.body 来处理大型文档的委托事件。

话虽如此，单击事件的性能差异可能可以忽略不计，因为与滚动或鼠标移动事件不同，它们很少触发（仅在用户单击时）。

# sqlite - 打开 SQLite VSIX（VS 扩展）

> ID：12251271
> 
> 赞同：0
> 
> 时间：2012-09-03T16:18:26.597
> 
> 标签：sqlite, windows-8

今天我尝试打开 SQLite vsix（Visual Studio 扩展，[在此处找到](http://www.sqlite.org/download.html)），以便我可以将其功能添加到 Windows 8 商店应用程序中。

出于某种原因，尽管 Windows 8 没有将 VSIX 扩展与 Visual Studio 2012 正确关联，并且它一直将其作为压缩文件打开，这与我预期的结果并不完全一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:18:26.597

要解决此问题，我通过右键单击 VSIX 文件选择“打开方式”，然后选择 VS2012 附带的以下 VSIX 启动器：

C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\VSIXInstaller.exe

现在 VSIX 文件正确打开并安装到 VS2012 中。这种技术应该为遇到相同问题的任何人解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T17:23:43.380

将 .zip 文件重命名为 .vsix 并照常安装。

# linq - 在我的 LINQ 查询中检查 null

> ID：12251273
> 
> 赞同：2
> 
> 时间：2012-09-03T16:18:34.740
> 
> 标签：linq, linq-to-sql

下午，如果以下行为空，我似乎无法弄清楚如何忽略

```
where ((double)t.twePrice >= priceFrom && (double)t.twePrice <= (priceTo)) 
```

正如您在下面的代码中看到的那样，当它是一个字符串时，我可以做到这一点。但我对价格有疑问。有人可以为我解释一下吗？

```
from a in dc.aboProducts
join t in dc.tweProducts on a.sku equals t.sku
where (string.IsNullOrEmpty(productSku) || productSku == t.sku)
where (string.IsNullOrEmpty(productAsin) || productAsin == a.asin)
where (string.IsNullOrEmpty(productName) || t.title.Contains(productName))
where (string.IsNullOrEmpty(productBrand) || t.brand.Contains(productBrand))
where ((double)t.twePrice >= priceFrom && (double)t.twePrice <= (priceTo))
select new GetProducts 
```

**更新：**我基本上是在发送大量项目来搜索我的 MS SQL 数据库，根据字符串，其中一些可能为 NULL。价格也可能为空，因为并非一直都需要。所以如果价格为空，我不需要使用它们。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:20:59.777

检查 twePrice 是否不为空，例如：

```
where (t.twePrice != null && (double)t.twePrice >= priceFrom && (double)t.twePrice <= (priceTo)) 
```

@thatuxguy，我想你需要这样的东西。下面的代码忽略 twePrice 为空的情况。

```
where (t.twePrice == null ? true : (double)t.twePrice >= priceFrom && (double)t.twePrice <= (priceTo)) 
```

祝你好运 ！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:21:56.213

也许以下内容可能就足够了：

```
where ((priceFrom == null || (double)t.twePrice >= priceFrom) && (priceTo == null || (double)t.twePrice <= priceTo)) 
```

为了可读性，它可能分为两部分：

```
where (priceFrom == null || (double)t.twePrice >= priceFrom) 
where (priceTo == null || (double)t.twePrice <= priceTo) 
```

# python - 无法显示验证码

> ID：12251274
> 
> 赞同：5
> 
> 时间：2012-09-03T16:18:38.240
> 
> 标签：python, django, captcha, recaptcha

我已经安装了 django-recaptcha 并将验证码包含在已安装的应用程序中。我正在使用此页面中的私钥和公钥：[https](https://github.com/praekelt/django-recaptcha) ://github.com/praekelt/django-recaptcha 。

我包括了声明`captcha = ReCaptchaField()`。当我点击页面时，它看起来像这样：

> 验证码：输入错误：k：站点密钥格式无效

不确定错误在哪里。需要一些指导。

html 看起来像这样：

![在此处输入图像描述](../Images/501ed19fc01b1b79aa8e0fb5ce5f3d12.png)

这是我输入的：

```
RECAPTCHA_PRIVATE_KEY = '98dfg6df7g56df6gdfgdfg65JHJH656565GFGFGs'
RECAPTCHA_PUBLIC_KEY = '76wtgdfsjhsydt7r5FFGFhgsdfytd656sad75fgh'
RECAPTCHA_USE_SSL = True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:27:25.893

根据[以下线程](https://groups.google.com/forum/?fromgroups=#!topic/recaptcha/QLVq9-llnbI)，切换私钥和公钥可以修复此错误。也就是说，使用

```
RECAPTCHA_PUBLIC_KEY = '98dfg6df7g56df6gdfgdfg65JHJH656565GFGFGs'
RECAPTCHA_PRIVATE_KEY = '76wtgdfsjhsydt7r5FFGFhgsdfytd656sad75fgh' 
```

[而不是文档](https://github.com/praekelt/django-recaptcha)中给出的其他方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-25T08:46:39.993

您需要在[google 注册以](http://www.google.com/recaptcha/whyrecaptcha)获得您自己的 api 密钥

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T11:03:41.673

输入您的网站 URL，不带“http://”。没有“www”没有“/”（在网站名称的末尾）。我的意思是简单地添加网站名称，例如，您可以添加“xyz.com”。这将解决问题。

[https://www.google.com/recaptcha/admin#whyrecaptcha](https://www.google.com/recaptcha/admin#whyrecaptcha)

# php - Drupal，修改一个实体

> ID：12251279
> 
> 赞同：1
> 
> 时间：2012-09-03T16:19:00.690
> 
> 标签：php, drupal

我有这个实体：

```
 $schema['apiuser'] = array(
        'description' => 'The base table for api_user.',
        'fields' => array(
            'apiuser_id' => array(
                'description' => 'The primary identifier for an artwork.',
                'type' => 'serial',
                'unsigned' => TRUE,
                'not null' => TRUE,
            ),
            'public_key' => array(
                'type' => 'int',
                'not null' => TRUE,
                'default' => 0,
                'description' => "Foreign key: {file_managed}.fid of user's picture.",
            )           
        ),
        'unique keys' => array(
            'id' => array('apiuser_id')
        ),
        'primary key' => array('apiuser_id'),
        ); 
```

后来我添加了一个新字段：

```
,
            $schema['apiuser'] = array(
    'description' => 'The base table for api_user.',
    'fields' => array(
        'apiuser_id' => array(
            'description' => 'The primary identifier for an artwork.',
            'type' => 'serial',
            'unsigned' => TRUE,
            'not null' => TRUE,
        ),
        'public_key' => array(
            'type' => 'int',
            'not null' => TRUE,
            'default' => 0,
            'description' => "Foreign key: {file_managed}.fid of user's picture.",
        ),
        'user_id' => array(
            'description' => 'The primary identifier for an artwork.',
            'type' => 'int',
            'not null' => TRUE,
        )

    ),
    'unique keys' => array(
        'id' => array('apiuser_id')
    ),
    'primary key' => array('apiuser_id'),
    ); 
```

Drupal 不会将相应的表更改为 mysql，因此我手动对其进行了修改。但是现在当我尝试保存未填充新字段的实体时。我已经安装了开发模块并使用“drush cc all”清除缓存，停用并激活了模块，但仍然无法正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:45:38.170

这就是更新脚本的用途。您需要编写一个[update_N 函数](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_update_N/7)，您可以在其中使用[模式对象](http://api.drupal.org/api/drupal/includes!database!schema.inc/class/DatabaseSchema/7)添加[列](http://api.drupal.org/api/drupal/includes!database!schema.inc/function/DatabaseSchema%3a%3aaddField/7)：

```
function your_module_update_7001($sandbox) {
  // do some checking (i.e. if already exists, etc)
  // get $schema from wherever you defined it for hook_schema...
  $spec = $schema['fields']['user_id'];
  Database::getConnection()->schema()->addField('apiuser', 'user_id', $spec);
} 
```

然后运行`http://yoursite.com/update.php`，drupal 将相应地修改您的表。

# shopify - 向订单添加附件

> ID：12251282
> 
> 赞同：0
> 
> 时间：2012-09-03T16:19:11.943
> 
> 标签：shopify

我需要编写一个应用程序，允许买家将文件附加到他们的订单中。

我是shopify的新手，我不知道它应该如何运作。

我需要弄清楚如何将我的自定义功能添加到用户在访问商店时单击产品时显示的产品详细信息视图。然后我需要弄清楚如何将用户选择的文档附加到订单中。

如果有人至少能指出我正确的方向，我将不胜感激。

我知道这是一个广泛的问题，我什至不知道如何正确表达它，因为我对 shopify 基础设施的理解非常有限。是的，我已经阅读了开发示例和 API 文档，但对我来说，它们缺少我想要的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:24:13.283

Shopify 最近添加了将文件作为附件上传到购物车行项目的功能。看看这里：[http ://wiki.shopify.com/Line_Item_Properties#File_attachments](http://wiki.shopify.com/Line_Item_Properties#File_attachments)

上传的文件存储在 CDN 中，您可以通过购物车模板中的液体和电子邮件通知访问它：

```
{% for p in item.properties %}{% unless p.last == blank %}
    {{ p.first }}:
    {% if p.last contains '/uploads/' %}
        <a href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
    {% else %}
        {{ p.last }}
    {% endif %}
    <br />
{% endunless %}{% endfor %} 
```

另请注意，每个[http://wiki.shopify.com/Product_img_url#Image_sizes创建不同的文件大小](http://wiki.shopify.com/Product_img_url#Image_sizes)

# php - PHP查找关键字并删除具有匹配关键字的整行

> ID：12251285
> 
> 赞同：0
> 
> 时间：2012-09-03T16:19:22.657
> 
> 标签：php, function, csv

我正在为我的表单邮件脚本编写一个 php 脚本，以将所有发送到管道分隔的 csv 文件的电子邮件发布，然后通过 php 数组显示 csv 文件。我需要允许用户通过将列表的 ID/发票号（该列表中的最后一个或第 22 个字段）传递给删除函数来删除条目，如下所示，但它正在删除 csv 文件中的所有内容，不只是那条线。这是我的代码。我比较传递给 invoicenumber 的 id 如果它匹配它应该删除该行并将其余部分放回，但它正在删除所有条目。

我做了如下更正，但它仍在清除所有条目：

```
if ($_POST['action'] == "Delete")
{
    $id = $_GET['id'];
    $fptemp = fopen('data-temp.csv', "a+");
    if (($handle = fopen($dataFile, "r")) !== FALSE)
    {
        while (($data= fgetcsv($handle)) !== FALSE)
        {
            if ($id != $data[22])
            {
                fputcsv($data);
            }
        }
        fclose($handle);
        fclose($fptemp);
        unlink($dataFile);
        rename('data-temp.csv',$dataFile);
    }
} 
```

所以我的 csv 文件中有以下条目

```
1346785585|Martha|Stewart|karen@someplace.com|555-444-2222|578 dude rd|dude|TN|57660|usa|Do it Yourself Cooking Book||389|12|||360|12|Credit Card|www.something.com||98.143.4.228|6c67b98 
1346785588|Karen|b|karen@someplace.com|555-444-2222|578 dude rd|dude|TN|57660|usa|Do it Yourself WebSite||389|12|||360|12|Credit Card|www.something.com||98.143.4.228|464b4ec 
```

我想找到发票号码，这是该行的最后一个字段，所以假设我想找到“464b4ec”并删除整个条目

```
1346785588|Karen|b|karen@someplace.com|555-444-2222|578 dude rd|dude|TN|57660|usa|Do it Yourself WebSite||389|12|||360|12|Credit Card|www.something.com||98.143.4.228|464b4ec 
```

我想保留所有其他条目，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:44:12.073

两个修复。正如其他人指出的那样，您正在使用`$id`两件事。改变：

```
$id= fgetcsv($handle) 
```

至：

```
$data = fgetcsv($handle, 0, '|') 
```

此外，当您编写输出文件时，您将一个数组包装在另一个数组中，这不是必需的。改变：

```
$list = array($data);
fputcsv($fptemp, $list); 
```

至：

```
fputcsv($data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:27:08.080

一些东西

a) fgetcsv() 从刚读取的 csv 数据行返回一个字段数组。您将整个数组与（单个？）项目进行比较`$data[22]`。除非 data[22] 本身是一个数组，否则这不会像你期望的那样工作

如果 $data 不是数组，它将被视为字符串，并且您将 $id 与字符串中的第 22 个字符进行比较。

b） $data 已经是一个数组，然后您将其包装在另一个数组中 - `array($data)`。所以...我猜 $data 实际上是一个字符串。

c）由于您仅在您的 id 与数据比较不匹配时才执行 fputcsv，因此您不会只删除一个字段 - 您会跳过整行。要仅删除数组中的第 22 项，它必须是

```
if ($id == $data[22) {
   unset($data[22]);
}
fputcsv($fptemp, $data); 
```

d) 正如杰克在他的评论中指出的那样，您正在覆盖循环中的 $id ，因此您在其中的 $_POST 值在您读取第一行 csv 数据的那一刻就被破坏了。

# android - Phonegap / Pushwoosh / Android - 推送通知不起作用

> ID：12251292
> 
> 赞同：2
> 
> 时间：2012-09-03T16:19:59.420
> 
> 标签：android, cordova, push-notification

我正在努力让推送通知使用 PhoneGap 和 Android 工作。Pushwoosh 似乎比 Urban AirShip 领先了几步，但我似乎在最后的障碍之一上摔倒了，希望有人能提供帮助。我有几个问题：

1) 当我尝试注册设备令牌时，我的应用程序报告“状态代码 210 - 应用程序未知”。我猜这是由于这里的参数之一：

pushNotification.registerDevice({ projectid: "5976xxxx0902", appid : "Pxxxx9-Fxxx1" } ....

x 不是真正的价值——其余的是，但我相信：

*   appid 是 Pushwoods 为我的应用程序调用的“应用程序代码”（是同一件事吗？）
*   项目 id 是 google API 控制台在其 URL 中的内容

那么 - 为什么 Pushwoosh 服务器不能识别呢？

2) 你怎么知道在 Pushwoosh 上注册了多少设备令牌

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:43:57.750

请仔细检查pushwoosh appid。它的格式为 XXXXX-XXXXX（5 个字母数字符号，破折号，然后是 5 个字母数字符号）。看来您在 appid 的第一部分还有一个额外的字母。

# scala - Scala Worker Actor 的设计注意事项

> ID：12251293
> 
> 赞同：3
> 
> 时间：2012-09-03T16:20:10.290
> 
> 标签：scala, actor

今年秋天我将参加分布式系统课程，由于 Scala 演员在这个领域非常有用，所以我刚刚开始学习 Scala。从到目前为止我从文本“Scala 中的演员”中读到的有关演员的内容中，我有一个问题似乎在文本中没有得到非常清楚的解决。

我目前正在一台具有多核处理器的机器上对我的程序进行建模，并在 Master-Workers 模型中使用基于事件的参与者。现在，以下两种设计选择中的哪一种会导致所有处理器内核得到最佳使用？

1) 将演员的数量限制在一个固定的小数目，不管主演员有多少工作，分发给工人演员（顺便说一下，有时可能相当大）

2) 生成与 Master Actor 需要完成的作业数量一样多的 Actor

哪些因素会影响我对上述两种选择的决定？

更新：我打印出我正在运行的 100 个工人演员的线程 ID，这是输出 -

```
No. of Processors-2
MainActor is on thread:Thread[ForkJoinPool-1-worker-0,5,main]
AccumulatorActor is on thread:Thread[ForkJoinPool-1-worker-1,5,main]

Worker Actor-1 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-4 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-5 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-6 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-7 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-8 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-9 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-10 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-3 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-12 running on thread:Thread[ForkJoinPool-1-worker-0,5,main] 
Worker Actor-13 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-14 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-15 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-2 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-16 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-11 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-17 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-18 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-19 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-20 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-21 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-22 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-23 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-24 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-25 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-26 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-28 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-29 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-27 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-30 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-31 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-33 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-32 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-34 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-35 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-36 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-38 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-39 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-40 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-41 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-42 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-43 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-44 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-45 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-46 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-47 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-48 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-51 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-50 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-54 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-49 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-56 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-57 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-58 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-55 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-59 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-52 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-61 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-60 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-63 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-53 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-65 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-66 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-68 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-64 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-62 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-70 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-69 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-67 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-72 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-73 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-71 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-75 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-78 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-79 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-80 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-81 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-82 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-83 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-74 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-84 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-85 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-77 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-76 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-86 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-87 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-88 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-89 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-91 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-92 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-94 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-95 running on thread:Thread[ForkJoinPool-1-worker-3,5,main]
Worker Actor-96 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-90 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-98 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-99 running on thread:Thread[ForkJoinPool-1-worker-1,5,main]
Worker Actor-100 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-93 running on thread:Thread[ForkJoinPool-1-worker-2,5,main]
Worker Actor-37 running on thread:Thread[ForkJoinPool-1-worker-0,5,main]
Worker Actor-97 running on thread:Thread[ForkJoinPool-1-worker-3,5,main] 
```

如上所示，在 ForkJoinPool 中运行了四个工作线程，而我的机器上有 2 个 cpu 内核。我不确定为什么会这样，因为快速查看 ResizableThreadPoolScheduler 的来源让我相信最初池中的工作线程数等于 cpu 核心数，并且这些是动态增加的，以防任何演员在池中的一个工作线程上被阻塞。我使用的所有演员都是基于事件的（反应）并且不执行任何阻塞操作。一个理想的场景是在 ForkJoinPool 中只有 2 个线程，并让它们在执行每个参与者工作的两个核心上并行运行。我对此的理解是正确的还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T19:20:54.953

你听起来像是在考虑演员，就好像他们是线程一样。拥有演员系统的部分目的是将您遇到的问题与演员本身分离。演员的制作成本很低，所以有几千个演员就可以了。拥有数千名演员并不意味着他们每个人都会尝试同时运行。

[调度程序](http://www.scala-lang.org/api/current/scala/actors/Scheduler%24.html)管理如何执行参与者请求。默认情况下，您将获得[ForkJoinScheduler](https://github.com/scala/scala/blob/v2.9.2/src/actors/scala/actors/scheduler/ForkJoinScheduler.scala)或（在特殊 JVM 上） [ResizableThreadPoolScheduler](http://www.scala-lang.org/api/current/scala/actors/scheduler/ResizableThreadPoolScheduler.html)

在这两种情况下，并行任务的数量都由[ThreadPoolConfig](https://github.com/scala/scala/blob/v2.9.2/src/actors/scala/actors/scheduler/ThreadPoolConfig.scala)控制，默认为`max(2*cores,4)`. 在这个类中，您还可以看到如何通过系统属性覆盖这些默认值：

*   `actors.enableForkJoin`允许您控制调度程序的选择
*   `actors.corePoolSize`设置初始“线程”池大小
*   `actors.maxPoolSize`设置最大尺寸

请注意，研究 Akka Actor 可能是一个更好的主意，因为它们可能会在某些时候[取代原始的 Scala Actor 实现](http://www.scala-lang.org/node/10986)，提供更多功能并强制更清晰地遵守 Actor 模型（因为您只能得到一个`ActorRef`并且不能直接调用不再对你的演员使用方法）。在 Akka 中，调度程序的等价物是[调度](http://doc.akka.io/docs/akka/2.0.2/scala/dispatchers.html)程序。

# jquery - 双击时如何防止jquery ui确认对话框添加twise记录？

> ID：12251295
> 
> 赞同：1
> 
> 时间：2012-09-03T16:20:19.087
> 
> 标签：jquery, jquery-ui

我正在尝试使用 jQuery ui 对话框和确认框在带有以下代码的表中添加新记录。如果我双击确认按钮，记录将在数据库中添加两次。我怎样才能防止这种情况？

```
function AddNewClient(){    
            jQuery("#confirmdialog").html("are you sure");
            jQuery("#confirmdialog").dialog({
                  modal: true,  
                  buttons : {
                    "Confirm" : function() {                                                                                            
                        jQuery.ajax({
                              type: "POST",                           
                              url: "index.php?option=com_travelagencycrm&view=clients&task=AddNewClient&format=raw",
                              cache: false,     
                              data : {id:jQuery("#client_id").val(),
                                      fullname:jQuery("#fullname").val(),
                                      vat_id:jQuery("#vat_id").val(),                                     
                                      address:jQuery("#address").val(),
                                      state_id:jQuery("#state_name").val(),
                                      country_id:jQuery("#country_name").val(),
                                      email:jQuery("#email").val(),
                                      phone_1:jQuery("#phone_1").val(),
                                      phone_2:jQuery("#phone_2").val(),
                                      postalcode:jQuery("#postalcode").val()                                    
                                }
                            }).done(function(msg) {         

                                jQuery("#tablepanelclients").flexReload();
                                //alert(msg);
                                jQuery("#confirmdialog").dialog("close");
                                jQuery("#editclient").dialog("close");                              

                            }).error(function(msg){
                                alert(msg);
                                jQuery("#confirmdialog").dialog("close");
                                jQuery("#editclient").dialog("close");
                            });

                    },
                    "Cancel" : function() {
                        jQuery(this).dialog("close");
                    }
                  }
                });

              jQuery("#confirmdialog").dialog("open");

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T17:30:35.437

这就是为我做的：

```
$(":button:contains('OK')").attr("disabled", true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:23:00.893

一种客户端解决方案是添加一个 boolean ：

```
var sent = false; 
```

...

```
 buttons : {
                "Confirm" : function() { 
                    if (sent) return;
                    sent = true;                                                                                           
                    jQuery.ajax({ 
```

另一个更强大的解决方案是在服务器端检查您尚未插入这些数据。我通常更喜欢这个，因为任何类型的问题或攻击都可能发生在服务器之外（在浏览器或网络上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T09:24:05.663

你可以使用jquery ui函数isOpen()。

```
 if( $(this).dialog("isOpen") ){
        YOUR CODE           
    } else {
        return;
    }
    $(this).dialog("close");
} 
```

# ruby-on-rails - Rails 3.2：检查命名空间模型是否可加载

> ID：12251296
> 
> 赞同：0
> 
> 时间：2012-09-03T16:20:45.587
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem

我有一个 gemified 引擎，这个引擎有一个函数，它将使用文件名中的 const_get 来填充一些数据库基本内容。
请注意，我对 Rails 还是很陌生。
我想要的是引擎测试常量是否首先存在，如果不存在，则将下划线案例中的第一个对象转换为命名空间而不是常量名称的一部分。
现在`defined?`在这里不起作用，因为这些都是“加载路径中”的东西，所以如果它们还没有被加载，它们将不会被识别——在这一点上，我理解开发和生产环境的方式之间存在一些差异工作，我不完全理解差异，也找不到关于差异的详尽文档，所以如果我可以指出某些事情或简要解释发生的事情，那将是惊人的！所以基本上我想要的是以以下方式工作的东西：

```
def get_namespaced_class(underscored_name)
...
end

get_namespaced_call('mygem_some_class') #returns Mygem::SomeClass class 
```

在我看来，该方法将首先检查是否`MygemSomeClass`可访问，然后开始检查命名空间选项。
我真正想避免的一件事是抓住`NameError`我认为这只是肮脏和错误的，我想查找我可以到达的东西，应该有一种方法可以做到这一点，我相信因为 rails 似乎自己在做.

# java - 我的 JBoss 使用什么版本的 HornetQ？

> ID：12251300
> 
> 赞同：3
> 
> 时间：2012-09-03T16:21:01.210
> 
> 标签：java, jboss, jmx, hornetq

在较新版本的 JBoss 中部署我的一个应用程序时出现异常。

> NoSuchMethodError：org.hornetq.api.core.management.QueueControl.getMessageCount()I

我的假设是 JBoss 中较新版本的 HornetQ 不再提供这种方法。我想知道如何在我的 JBoss 中找出当前的 hornetQ 版本，以便我可以查看 API 文档以获取替代方法。

有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T16:26:11.897

导航到`modules\org\hornetq\main`您的 JBoss AS 安装目录。

在那里你会发现一些 jar 文件，例如：

```
hornetq-core-<version>.jar
hornetq-jms-<version>.jar 
```

其中 version 是 HornetQ 版本。

更新：

```
ls -al /opt/jboss-7.1.x/modules/org/hornetq/main
drwxr-xr-x    1 www-data www-data     4096 Jul 11 17:39 .
drwxr-xr-x    1 www-data www-data        0 Jul 11 17:39 ..
-rw-r--r--    1 www-data www-data  1462224 Mar  9 23:14 hornetq-core-2.2.13.Final.jar
-rw-r--r--    1 www-data www-data     2545 Mar  9 23:14 hornetq-core-2.2.13.Final.jar.index
-rw-r--r--    1 www-data www-data   229886 Mar  9 23:14 hornetq-jms-2.2.13.Final.jar
-rw-r--r--    1 www-data www-data      737 Mar  9 23:14 hornetq-jms-2.2.13.Final.jar.index
drwxr-xr-x    1 www-data www-data        0 Jul 11 17:39 lib
-rw-r--r--    1 www-data www-data       25 Mar  9 23:14 lib.index
-rw-r--r--    1 www-data www-data     1850 Mar  9 23:14 module.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-08T15:53:04.493

这是hornetQ jar文件的正确路径 `jboss/modules/system/layers/base/org/hornetq/main/`

# javascript - 用户评分后禁用jquery star插件

> ID：12251301
> 
> 赞同：1
> 
> 时间：2012-09-03T16:21:06.527
> 
> 标签：javascript, jquery-ui, jquery, jquery-plugins

我已经实现了 jquery 星级评分。当用户添加其评分时，我将其保存到数据库并禁用星级评分。
但是在禁用用户再次单击星号后，它会再次调用 js 函数并尝试将分数保存到数据库。

```
<input name="rating" type="radio" class="star" value="3" />
...
$('.star').click(function(event) {
        $.ajax({
                type: "POST",
                url: '@Url.Action("Rate", "Rating")',
                data: $("#rate").serialize(),
                success: function(response) {
                    alert('Your rating has been recorded');   
                    $('.star').rating('disable', true);
                },
                error: function(response) {
                alert('There was an error.');
              }
            });
        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:24:47.423

`off()`您可以在 ajax 调用之后取消绑定点击事件（使用）

```
 $('.star').click(function(event) {
     var $this = $(this);
     ...
     success: function(response) {
         alert('Your rating has been recorded');   
         $this.off('click');
     },

 }); 
```

我想你可能有几个`.star`元素，所以你应该只解除附加在点击链接上的处理程序。

另一种更简单的可能性是使用 绑定处理程序`.one()`，就像这样

```
 $('.star').one('click', function(event) {
     var $this = $(this);
     ...
     success: function(response) {
         alert('Your rating has been recorded');   

     },

 }); 
```

这将只允许每个不同`.star`元素的单击事件

无论如何，我强烈建议您在服务器端也进行这种检查。不要依赖客户端进行可能更改服务器上数据的操作

# node.js - 在jade中快速上传图片并查看

> ID：12251302
> 
> 赞同：2
> 
> 时间：2012-09-03T16:21:36.017
> 
> 标签：node.js, express, pug

我正在尝试上传图片并以快递方式显示。我将我的应用配置为在“公共/图像”中上传

```
 app.use(express.bodyParser({ keepExtensions: true, uploadDir: './public/images' })); 
```

上传很顺利，但我找不到如何在我的玉模板中显示上传的图像。我从 req.files 对象获得的图像路径类似于“public/images/imagename.jpg”，但我可以看到图像的唯一方法是在这样的 url 中：

```
http://localhost:3000/images/imagename.jpg 
```

有没有办法从 req.files 中删除“公共”参数，或者有其他解决方案吗？感谢大家！

编辑：

好的，谢谢。但我的问题是关于在玉模板中显示图像。我添加了这一行：

```
app.use('/public/images/', express.static(__dirname + '/public/images/')); 
```

现在我可以访问该目录中的文件。但我无法在我的玉模板中显示它们。当我尝试这个（使用 foto_path === req.files.image.path）：

```
img(src= #{material.foto_path}) 
```

我得到这个网址：

```
http://localhost:3000/undefinedpublic/images/b1ce29f40ac7692ac62637e42f0f9128.jpgundefined 
```

“未定义”有什么用？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:44:37.660

您需要知道 Express 配置您的公共目录与其他传统服务器（如 Apache）略有不同。我猜想为了显示静态资产，您的行如下所示：

```
app.use(express.static(__dirname + '/public')); 
```

这将是您的应用程序中唯一可公开查看的文件夹。这就是为什么 Express 认为将目录名称添加到 url 是多余的。**该网址不反映您的实际文件夹结构。**

但是 req.files 确实显示了实际路径，以便您可以在应用程序中对其进行操作，否则它将无法在其他地方使用。我的解决方案是直接`src = '/images/imageName.jpg'`在 Jade 中引用。您必须将实际图像名称作为参数传递。或者，您可以从 req 中删除“公共”部分并传递它。

# asp.net - 服务器错误：无法加载程序集

> ID：12251307
> 
> 赞同：1
> 
> 时间：2012-09-03T16:21:50.940
> 
> 标签：asp.net, .net, web-config, dynamics-crm

这是我第一次尝试在 aspx.net 中构建项目，但我不知道如何解决这个问题。我正在尝试创建一个与 Dynamics CRM Online 实例对话的网站。我尝试与我的托管服务提供商交谈，他们说我的 web.config 需要更正。错误页面是：

```
 Could not load file or assembly 'microsoft.crm.sdk.proxy' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.
 Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

 Exception Details: System.BadImageFormatException: Could not load file or assembly 'microsoft.crm.sdk.proxy' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.

 Source Error:

 An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

 Assembly Load Trace: The following information can be helpful to determine why the assembly 'microsoft.crm.sdk.proxy' could not be loaded.

 WRN: Assembly binding logging is turned OFF.
 To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
 Note: There is some performance penalty associated with assembly bind failure logging.
 To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

 Stack Trace:

 [BadImageFormatException: Could not load file or assembly 'microsoft.crm.sdk.proxy' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.]
    System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection) +0
    System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection) +43
    System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +127
    System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +142
    System.Reflection.Assembly.Load(String assemblyString) +28
    System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +46

 [ConfigurationErrorsException: Could not load file or assembly 'microsoft.crm.sdk.proxy' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.]
    System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +613
         System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +203
    System.Web.Configuration.CompilationSection.LoadAssembly(AssemblyInfo ai) +105
    System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +178
    System.Web.Compilation.WebDirectoryBatchCompiler..ctor(VirtualDirectory vdir) +163
         System.Web.Compilation.BuildManager.BatchCompileWebDirectoryInternal(VirtualDirectory vdir, Boolean ignoreErrors) +53
    System.Web.Compilation.BuildManager.BatchCompileWebDirectory(VirtualDirectory vdir, VirtualPath virtualDir, Boolean ignoreErrors) +175
    System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath) +83
    System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile) +261
    System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile) +101
    System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean noAssert) +126
    System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(VirtualPath virtualPath, Type requiredBaseType, HttpContext context, Boolean allowCrossApp, Boolean noAssert) +62
    System.Web.UI.PageHandlerFactory.GetHandlerHelper(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath) +33
    System.Web.UI.PageHandlerFactory.System.Web.IHttpHandlerFactory2.GetHandler(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath) +40
    System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig) +160
    System.Web.MapHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +93
    System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155

 Version Information: Microsoft .NET Framework Version:2.0.50727.3634; ASP.NET      Version:2.0.50727.3634 
```

随着我的 web.config 自动生成：

```
<?xml version="1.0"?>
<configuration>
<configSections>
    <section name="microsoft.xrm.client" type="Microsoft.Xrm.Client.Configuration.CrmSection, Microsoft.Xrm.Client"/>
    <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
            <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
                <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/></sectionGroup></sectionGroup></sectionGroup></configSections>
<connectionStrings>
    <add name="Xrm" connectionString="Server=https://expressware.api.crm4.dynamics.com//XRMServices/2011/Organization.svc; Domain=EXPRESSWARE; Username=chriscrawsh******; Password=*******"/>
</connectionStrings>
<microsoft.xrm.client>
    <contexts>
        <add name="Xrm" type="Xrm.XrmServiceContext, WebAppWalkthrough"/>
    </contexts>
</microsoft.xrm.client>
<system.web>
    <customErrors mode="Off"/>
    <pages>
        <controls>
            <add tagPrefix="crm" namespace="Microsoft.Xrm.Portal.Web.UI.WebControls" assembly="Microsoft.Xrm.Portal"/>
            <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></controls>
    </pages>
    <compilation>
        <assemblies>
            <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/></assemblies></compilation>
    <httpHandlers>
        <remove verb="*" path="*.asmx"/>
        <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="GET,HEAD" path="ScriptResource.axd" validate="false" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></httpHandlers>
    <httpModules>
        <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></httpModules></system.web>
<system.codedom>
        <compilers>
            <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" warningLevel="4">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="WarnAsError" value="false"/></compiler>
            <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" warningLevel="4">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="OptionInfer" value="true"/>
                <providerOption name="WarnAsError" value="false"/></compiler></compilers></system.codedom>
<system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
    <modules>
        <remove name="ScriptModule"/>
        <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></modules>
    <handlers>
        <remove name="WebServiceHandlerFactory-Integrated"/>
        <remove name="ScriptHandlerFactory"/>
        <remove name="ScriptHandlerFactoryAppServices"/>
        <remove name="ScriptResource"/>
        <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add name="ScriptResource" verb="GET,HEAD" path="ScriptResource.axd" preCondition="integratedMode" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></handlers></system.webServer>
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1" appliesTo="v2.0.50727">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/></dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/></dependentAssembly></assemblyBinding></runtime></configuration> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-25T19:58:25.250

我意识到这已经过时了，但它在 Google 上的排名很高，所以我将分享我的解决方案。确保在 CRM dll 或加载 CRM dll 的任何项目的应用程序池上将启用 32 位应用程序设置为 True。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-13T02:16:22.937

尝试删除目录`microsoft.crm.sdk.proxy.dll`中的`bin`文件并重建。它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:00:17.303

[这里](https://stackoverflow.com/questions/255669/how-to-enable-assembly-bind-failure-logging-fusion-in-net)描述了如何在 .Net 中启用 FUSION 登录。实际上，您在错误消息中有此建议。比您将在日志中详细说明无法加载哪些程序集。

# windows - 如何检查应用程序兼容性

> ID：12251310
> 
> 赞同：0
> 
> 时间：2012-09-03T16:22:03.763
> 
> 标签：windows, visual-studio-2010

我刚刚使用 Visual Studio 2010 完成了我的应用程序。我有 2 个文件夹，一个名为`debug`，第二个`release`. 这两个文件夹都有一个 exe 文件和一些奇怪的文件。现在，我刚刚将此 exe 文件放置到运行 Windows XP 的第二台 PC 上，并且该应用程序显示错误。

我的第二台 PC 运行的是 Windows 7，没有问题。我想在 Windows 7 上运行 VirtualBox，但我的 RAM 只有 2GB，而且很难做到。

我至少可以确定所有 Windows 7 PC 都可以运行它吗？正如我所说，我已经制作了一个 exe 文件作为发行版。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:32:50.073

我认为最好在同一个解决方案中创建安装项目，然后创建一个部署包。它的主要优点是它会自动找到你项目中的所有依赖项，我认为你可以克服这个问题

# wpf - 图像未显示在用户控件的列表框中

> ID：12251311
> 
> 赞同：0
> 
> 时间：2012-09-03T16:22:08.590
> 
> 标签：wpf, vb.net, user-controls, listbox

这是我第一次在 WPF 中使用 UserControl。以下是我的 Usercontrol Xaml 和后台 VB 代码：

```
<UserControl x:Class="AddNewGenre"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" d:DesignHeight="194" d:DesignWidth="405">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="130" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="72*" />
            <ColumnDefinition Width="333*" />
        </Grid.ColumnDefinitions>

        <ListBox Name="GenreListBox" ItemsSource="{Binding}"
                 Grid.Row="1" Grid.Column="1">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel IsItemsHost="True" />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Image Source="{Binding Value}" Width="128" Height="128" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</UserControl> 
```

代码文件：

```
Public Class AddNewGenre
    Dim Result As HODLib.Classes.GenreClass

    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        Me.DataContext = Result
    End Sub

    Private Sub UserControl_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded

        GenreListBox.ItemsSource = GlobalValues.ImageDictionary
    End Sub

End Class 
```

以下是获取 GlobalValues.ImageDictionary 的代码：

```
Namespace GlobalValues
    Module CurrentVariables
        Public ImageDictionary As Concurrent.ConcurrentDictionary(Of String, BitmapImage)

        Public Sub Initialize()
            ImageDictionary = New Concurrent.ConcurrentDictionary(Of String, BitmapImage)

            'try get resources
            GetAllBitmaps()

        End Sub

        Public Sub GetAllBitmaps()
            Try
                ImageDictionary.Clear()
                With ImageDictionary
                    .TryAdd("Box", New BitmapImage(New Uri("Resources\Box.png", UriKind.Relative)))
                    .TryAdd("Tri", New BitmapImage(New Uri("Resources\Tri.png", UriKind.Relative)))
                End With
            Catch ex As Exception

            End Try
        End Sub

    End Module
End Namespace 
```

问题是图像没有显示在图像列表框中，只显示了一个黑色项目。你能告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:27:26.517

`ItemsSource`从 xaml 的列表框中删除 ，因为您已经在您的代码隐藏文件中设置了它。

```
<ListBox Name="GenreListBox"
                 Grid.Row="1" Grid.Column="1"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:01:25.063

终于从这篇文章中找到了答案：[访问构建操作资源类型文件](https://stackoverflow.com/questions/9784710/load-image-at-runtime-from-resource-in-wpf)在我的情况下，我为格式字符串“/HOD;component/Resources/Box.png”而不是 BitmapImage

# php - 连接具有不同 ID 的多个表

> ID：12251313
> 
> 赞同：1
> 
> 时间：2012-09-03T16:22:12.647
> 
> 标签：php, mysql, sql, join

我有以下查询：

```
$cuttinglist_products_query = 
  tep_db_query("select op.orders_products_id, op.orders_id, op.products_id, ".
                      "op.products_model, op.products_name, op.products_quantity, ".
                      "p.products_id from " . TABLE_ORDERS_PRODUCTS . " op " .
                  " left join " . TABLE_PRODUCTS . " p " .
                  " on (op.products_id = p.products_id) where orders_id = '" . 
                  (int)$cuttinglist['orders_id'] . "'"); 
```

这将两个具有相同 ID 的表连接在一起。我将如何加入第三张桌子，名为：

```
"TABLE_ORDERS_PRODUCTS_ATTRIBUTES" 
```

具有与以下相同的 ID：

```
"TABLE_ORDERS_PRODUCTS" 
```

使用的ID是：

```
"orders_products_id" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T16:26:49.130

只需添加另一个连接子句：

```
SELECT ...
FROM TABLE_ORDERS_PRODUCTS op
LEFT JOIN TABLE_PRODUCTS p ON op.products_id = p.products_id
LEFT JOIN TABLE_ORDERS_PRODUCTS_ATTRIBUTES pa ON op.products_id = pa.orders_products_id
WHERE ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:44:41.143

```
$sql  = " select ";
$sql .= "   op.orders_products_id,  op.orders_id,          op.products_id,  op.products_model, ";
$sql .= "   op.products_name,       op.products_quantity,  p.products_id ";
$sql .= " from ". TABLE_ORDERS_PRODUCTS ." op ";   
$sql .= " left join ". TABLE_PRODUCTS ." p on (op.products_id = p.products_id) ";
$sql .= " left join ". TABLE_ORDERS_PRODUCTS_ATTRIBUTES ." pa on (pa.orders_products_id = op.orders_products_id) ";
$sql .= " where op.orders_id = ";
$sql .= "'". (int)$cuttinglist['orders_id'] ."'";

$cuttinglist_products_query = tep_db_query( $sql ); 
```

# ios - 如何在 UIpickerView 的特定行中插入图像和文本？

> ID：12251315
> 
> 赞同：1
> 
> 时间：2012-09-03T16:22:20.373
> 
> 标签：ios, cocoa-touch, uikit, uipickerview

我已经实现了以下功能：

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row
forComponent:(NSInteger)component reusingView:(UIView *)view
{
    UIImage *img = [UIImage imageNamed:@"persona.jpeg"];
    UIImageView *temp = [[UIImageView alloc] initWithImage:img]; 
    temp.frame = CGRectMake(-70, 10, 60, 40);

    UILabel *channelLabel = [[UILabel alloc] initWithFrame:CGRectMake(50, -5, 80, 60)];
    channelLabel.text = @"persona y";
    channelLabel.textAlignment = UITextAlignmentLeft;
    channelLabel.backgroundColor = [UIColor clearColor];

    UIView *tmpView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 110, 60)];
    [tmpView insertSubview:temp atIndex:0];
    [tmpView insertSubview:channelLabel atIndex:1];

    return tmpView; 
} 
```

结果如下：

![屏幕](../Images/6d1cd94d7bf5f1c84ac169cefacd02e2.png)

我需要在特定行中插入图像和文本，知道该怎么做吗？
非常感谢您的帮助。

我的想法是填充一组图片和一个描述来填充 UIPickerView

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T17:12:04.810

尝试将您的数据`Array`从`NSDictionary`.

字典结构：`{Image:<imageName>, LabelText:<labelText>}`

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row
forComponent:(NSInteger)component reusingView:(UIView *)view
{
    NSDictionary *dict =  [datasourceArray objectAtIndex:row];
    UIImage *img = [UIImage imageNamed:[dict valueForKey:@"Image"]]; // get image path from the dictionary
    UIImageView *temp = [[UIImageView alloc] initWithImage:img]; 
    temp.frame = CGRectMake(-70, 10, 60, 40);

    UILabel *channelLabel = [[UILabel alloc] initWithFrame:CGRectMake(50, -5, 80, 60)];
    channelLabel.text = [dict valueForKey:@"LabelText"];
    channelLabel.textAlignment = UITextAlignmentLeft;
    channelLabel.backgroundColor = [UIColor clearColor];

    UIView *tmpView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 110, 60)];
    [tmpView insertSubview:temp atIndex:0];
    [tmpView insertSubview:channelLabel atIndex:1];

    return tmpView;
} 
```

# c# - 将运算符视为对象

> ID：12251316
> 
> 赞同：2
> 
> 时间：2012-09-03T16:22:28.227
> 
> 标签：c#, oop, object, operators

我知道`C#`，作为混合语言，有运算符，它们不是对象，就像在 smalltalk 中一样。

有没有办法将它们视为对象（如 in `Smalltalk`）？我的意思是，向它们添加属性和方法，或者将它们包含在类层次结构中。

据我所知，（感谢谷歌），有可能[重载 operator](http://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx)，但我找不到其他任何东西。

例如，我想知道是否可以做类似的事情

```
if(+.PrecedenceLevel > *.PrecedenceLevel) 
{
//something
} 
```

只是我好奇的问题，而不是我的工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:41:04.367

重载运算符是静态方法，因此具有`MethodInfo`可以操作或调用的相应对象：

```
var eqStr = typeof(string).GetMethod("op_Equality");
Console.WriteLine(eqStr.Name);//op_Equality - the .NET name rather than the C# name
Console.WriteLine(eqStr.IsSpecialName);//True - languages may give it a different name
Console.WriteLine(eqStr.Invoke(null, new object[]{"abc", "abc"}));//True
Console.WriteLine(eqStr.Invoke(null, new object[]{"abc", "def"}));//False 
```

这实际上只是让我们了解该方法的语言中立特性，这可能很有用，但它并没有让我们了解给定语言使用的名称（`==`在 C#、`=`VB.NET 等中），可以说它的优先级或任何“操作性”。

而且它仅适用于重载，而不适用于内置插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T04:00:26.703

简短的回答是“不”，运算符不是 C# 中的对象，甚至通过静态方法的运算符重载机制似乎也是一种弱设计，因此您很少看到 C# 运算符重载的性感示例。

但是，如果您是好奇者，除了 Jon 已经提到的反射之外，.NET 中还有一些元编程机制，其中运算符由对象表示。您仍然无法为它们提供任何其他属性或检查优先级，但这可能是您在 .NET 中可以获得的最接近您所描述的内容。

一种方法是通过使用 Code DOM，有一个[`CodeBinaryOperationExpression`](http://msdn.microsoft.com/en-us/library/system.codedom.codebinaryoperatorexpression.aspx)类。当您读取或创建一个时，您使用[`CodeBinaryOperatorType`](http://msdn.microsoft.com/en-us/library/system.codedom.codebinaryoperatortype.aspx)枚举指定运算符。例如，您可以在 C# 中创建一个方法，该方法将在运行时使用动态选择的运算符创建表达式树，将其编译为 lambda 并返回给调用者以用作通用函数。

另一种方式，在某种意义上与以前相反，是使用新的[Roslyn API](http://msdn.microsoft.com/en-US/roslyn)，它提供了代码解析功能。您可以将一些源代码提供给 Roslyn，它会将其转换为表达式树，您可以编写[访问者或语法重写器](http://msdn.microsoft.com/en-us/hh543920)来修改该树。例如，您可以遍历树并将所有“加号”运算符替换为“减号”运算符（或您选择的任何代码）。

[您可以在此处](https://stackoverflow.com/questions/3271316/c-sharp-4-0-expression-trees-vs-codedom)和[此处](https://stackoverflow.com/questions/403088/practical-use-of-expression-trees)找到更多详细信息和示例。

HTH。

# javascript - iPad 显示不同的网页，直到添加到主屏幕

> ID：12251318
> 
> 赞同：0
> 
> 时间：2012-09-03T16:22:51.767
> 
> 标签：javascript, ipad

嗨，我疯狂地搜索，我找不到答案。在 www.asidemag.com 上使用 ipad 它会要求您添加到主屏幕（但是当您将其添加到主屏幕时，显示的页面不是同一个页面！）很难解释，但我会尝试更深入一点。

1.  在 ipad 上访问 sidemag.com，它会要求您将其添加到您的主屏幕，这就是它不会显示网站的其他部分，也无法导航。
2.  如果您将其添加到主屏幕并单击该杂志将加载的图标而不将其添加到主屏幕，您将永远看不到该杂志。

现在我得到了大量脚本，可以提示您添加到主屏幕，但不能提示您添加到其他部分。

在 ipad 上查看 html 我认为这可能与以下内容有关：-

```
var hasFlash = function(){
    for(i=0; i<navigator.plugins.length; i++){
        if (navigator.plugins[i].name == "Shockwave Flash") return true;
    }
}
return false; 
```

在它之前有一个看起来像的表单动作，`<input type="hidden" name="a" vale"" id="a"/>`在上面有`document.getElementById('a').value=navigator.userAgent;`

有 8 种不同的输入类型，还有 8 种元素类型，如果您需要整个脚本，我将不得不手动输入它，因为它仅在使用 ipad 时出现。我尝试使用不同的浏览器代理来欺骗网站，但我认为它查看了 8 个不同的变量。

非常感谢任何帮助

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:00:27.827

如果用户正在使用 webclip（即保存到主屏幕的网页，则为`window.navigator.standalone`true。

因此，您可以使用：

```
if (window.navigator.standalone) {
    // from webclip
} else {
    // normal
} 
```

此信息来自此处的 Safari 参考：[https ://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)

# apache - .htaccess 控制文件改写规则

> ID：12251319
> 
> 赞同：0
> 
> 时间：2012-09-03T16:22:52.123
> 
> 标签：apache, .htaccess

我有以下重写：

```
 RewriteRule ^api/(.*)?   api/api.php [QSA,L] 
```

因此，如果 url 是[http://www.test.com/api/](http://www.test.com/api/) ... ，它将被重新路由到 api 文件夹中的文件 api.php 。这行得通。

但是，我想添加另一条规则，如果 url 是[http://www.test.com/second_api/](http://www.test.com/second_api/) ... 将重新路由到 api 文件夹内的文件 second_api.php 。我不让它工作。

```
 RewriteRule ^second_api/(.*)?   api/second_api.php [QSA,L]  
      RewriteRule (.*)/second_api/(.*)?   api/second_api.php [QSA,L] 
      RewriteRule ^/second_api/(.*)?   api/second_api.php [QSA,L] 
```

要么是错误的 url，要么是重新路由到 api.php。我想使用新添加的规则重新路由到 second_api.php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T23:38:03.200

您需要添加检查，否则您的第一条规则将再次应用：

```
RewriteCond %{REQUEST_URI} !second_api\.php
RewriteRule ^api/(.*)?   api/api.php [QSA,L]  

RewriteRule ^second_api/(.*)? api/second_api.php [QSA,L] 
```

# javascript - Javascript Date() 按天、月、年计算年龄工作

> ID：12251325
> 
> 赞同：11
> 
> 时间：2012-09-03T16:23:06.677
> 
> 标签：javascript, jquery

我想从用户日期生日开始显示几天、几个月和几年。
这是我的代码，取自此处：[Calculate age in JavaScript](https://stackoverflow.com/questions/4060004/calculate-age-in-javascript)
How can it continue with the month and day, as：

> 用户生日是：**2010/04/29**
> 结果应该是这样的：**2 岁 4 个月 5 天。**

```
function getAge(dateString) {
    var today = new Date();
    var birthDate = new Date(dateString);
    var age = today.getFullYear() - birthDate.getFullYear();
    var m = today.getMonth() - birthDate.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
    }
    return age;
}

alert(getAge('2010/04/29')); 
```

**演示：http:** [//jsfiddle.net/jFxb5/](http://jsfiddle.net/jFxb5/)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-03T16:34:50.437

```
function getAge(dateString) {
  var now = new Date();
  var today = new Date(now.getYear(),now.getMonth(),now.getDate());

  var yearNow = now.getYear();
  var monthNow = now.getMonth();
  var dateNow = now.getDate();

  var dob = new Date(dateString.substring(6,10),
                     dateString.substring(0,2)-1,                   
                     dateString.substring(3,5)                  
                     );

  var yearDob = dob.getYear();
  var monthDob = dob.getMonth();
  var dateDob = dob.getDate();
  var age = {};
  var ageString = "";
  var yearString = "";
  var monthString = "";
  var dayString = "";

  yearAge = yearNow - yearDob;

  if (monthNow >= monthDob)
    var monthAge = monthNow - monthDob;
  else {
    yearAge--;
    var monthAge = 12 + monthNow -monthDob;
  }

  if (dateNow >= dateDob)
    var dateAge = dateNow - dateDob;
  else {
    monthAge--;
    var dateAge = 31 + dateNow - dateDob;

    if (monthAge < 0) {
      monthAge = 11;
      yearAge--;
    }
  }

  age = {
      years: yearAge,
      months: monthAge,
      days: dateAge
      };

  if ( age.years > 1 ) yearString = " years";
  else yearString = " year";
  if ( age.months> 1 ) monthString = " months";
  else monthString = " month";
  if ( age.days > 1 ) dayString = " days";
  else dayString = " day";

  if ( (age.years > 0) && (age.months > 0) && (age.days > 0) )
    ageString = age.years + yearString + ", " + age.months + monthString + ", and " + age.days + dayString + " old.";
  else if ( (age.years == 0) && (age.months == 0) && (age.days > 0) )
    ageString = "Only " + age.days + dayString + " old!";
  else if ( (age.years > 0) && (age.months == 0) && (age.days == 0) )
    ageString = age.years + yearString + " old. Happy Birthday!!";
  else if ( (age.years > 0) && (age.months > 0) && (age.days == 0) )
    ageString = age.years + yearString + " and " + age.months + monthString + " old.";
  else if ( (age.years == 0) && (age.months > 0) && (age.days > 0) )
    ageString = age.months + monthString + " and " + age.days + dayString + " old.";
  else if ( (age.years > 0) && (age.months == 0) && (age.days > 0) )
    ageString = age.years + yearString + " and " + age.days + dayString + " old.";
  else if ( (age.years == 0) && (age.months > 0) && (age.days == 0) )
    ageString = age.months + monthString + " old.";
  else ageString = "Oops! Could not calculate age!";

  return ageString;
}

alert(getAge('09/09/1989')); 
```

[**在这里演示**](http://jsfiddle.net/x9paT/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T19:29:28.460

不想被格式限制的`mm/dd/yyyy`可以替换：

```
var dob = new Date(dateString.substring(6,10),
                   dateString.substring(0,2)-1,                   
                   dateString.substring(3,5)                  
                  ); 
```

和：

```
var dob = new Date(dateString); 
```

这使我可以使用 2012/09/30 并且仍然得到正确的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-15T00:19:27.277

以年、月和日为单位计算年龄。以任何有效的日期字符串格式输入日期，例如“1952/09/28”、“Sep 29, 1952”、“09/28/1952”等。

接受 2 个参数 - 出生日期和计算年龄的日期。您可以将第二个参数留到今天的日期。返回具有年、月和日属性的对象年龄。

使用一年中 365.2425 天的太阳年值。

@parambirthDate 出生日期。@param ageAtDate 计算年龄的日期。今天的日期没有。@returns {{年：数字，月：数字，天：数字}}

```
function getAge(birthDate, ageAtDate) {
    var daysInMonth = 30.436875; // Days in a month on average.
    var dob = new Date(birthDate);
    var aad;
    if (!ageAtDate) aad = new Date();
    else aad = new Date(ageAtDate);
    var yearAad = aad.getFullYear();
    var yearDob = dob.getFullYear();
    var years = yearAad - yearDob; // Get age in years.
    dob.setFullYear(yearAad); // Set birthday for this year.
    var aadMillis = aad.getTime();
    var dobMillis = dob.getTime();
    if (aadMillis < dobMillis) {
        --years;
        dob.setFullYear(yearAad - 1); // Set to previous year's birthday
        dobMillis = dob.getTime();
    }
    var days = (aadMillis - dobMillis) / 86400000;  
    var monthsDec = days / daysInMonth; // Months with remainder.
    var months = Math.floor(monthsDec); // Remove fraction from month.
    days = Math.floor(daysInMonth * (monthsDec - months));
    return {years: years, months: months, days: days};
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-18T22:02:37.853

试试这个：

```
function getAge(dateString) {
    var today = new Date();
    var DOB = new Date(dateString);
    var totalMonths = (today.getFullYear() - DOB.getFullYear()) * 12 + today.getMonth() - DOB.getMonth();
    totalMonths += today.getDay() < DOB.getDay() ? -1 : 0;
    var years = today.getFullYear() - DOB.getFullYear();
    if (DOB.getMonth() > today.getMonth())
        years = years - 1;
    else if (DOB.getMonth() === today.getMonth())
        if (DOB.getDate() > today.getDate())
            years = years - 1;

    var days;
    var months;

    if (DOB.getDate() > today.getDate()) {
        months = (totalMonths % 12);
        if (months == 0)
            months = 11;
        var x = today.getMonth();
        switch (x) {
            case 1:
            case 3:
            case 5:
            case 7:
            case 8:
            case 10:
            case 12: {
                var a = DOB.getDate() - today.getDate();
                days = 31 - a;
                break;
            }
            default: {
                var a = DOB.getDate() - today.getDate();
                days = 30 - a;
                break;
            }
        }

    }
    else {
        days = today.getDate() - DOB.getDate();
        if (DOB.getMonth() === today.getMonth())
            months = (totalMonths % 12);
        else
            months = (totalMonths % 12) + 1;
    }
    var age = years + ' years ' + months + ' months ' + days + ' days';
    return age;
}

console.log(getAge("2010/02/28"));
console.log(getAge("2010/03/01"));
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-05T15:44:21.420

当我看到已接受的解决方案存在问题时（请参阅我的评论），我在这里展示了我自己的版本，它保证在仅将出生日期增加 1 时天数不会“跳跃”。

此代码定义了一个更通用的`DateInterval`类来表示两个日期之间的差异。然后该函数`getAge`成为基于该类的瘦实现。

```
class DateInterval {
    constructor(start, end) { // two Date instances
        if (start > end) [start, end] = [end, start]; // swap
        this.days = end.getDate() - start.getDate();
        this.months = end.getMonth() - start.getMonth();
        this.years = end.getFullYear() - start.getFullYear();
        if (this.days < 0) {
            // Add the number of days that are left in the month of the start date
            this.days += (new Date(start.getFullYear(), start.getMonth() + 1, 0)).getDate();
            this.months--;
        }
        if (this.months < 0) {
            this.months += 12;
            this.years--;
        }
    }
    toString() {
        const arr = ["years", "months", "days"].map(p => 
            this[p] && (this[p] + " " + p.slice(0, this[p] > 1 ? undefined : -1))
        ).filter(Boolean);
        if (!arr.length) return "0 days";    
        const last = arr.pop();
        return arr.length ? [arr.join(", "), last].join(" and ") : last;
    }
}

function getAge(dateString) {
    let today = new Date();
    today.setHours(0,0,0,0);
    let dob = new Date(dateString);
    dob.setHours(0,0,0,0);
    return new DateInterval(dob, today) + " old.";
}

// Demo: increment the date of birth by 1 at each test:
let d = new Date(2000, 1, 1);
setInterval(() => {
    const s = d.toJSON().slice(0,10);
    console.log("Someone born on " + s + " is now " + getAge(s));
    d = new Date(d.getFullYear(), d.getMonth(), d.getDate() + 1);
}, 300);
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-23T00:42:06.237

此函数将以年、月和日为单位给出年龄。它的工作原理是首先计算月份的差异，然后将该数字添加到出生日期，然后计算天数的差异。这样做的美妙之处在于，让 Date 对象来担心闰年和每个月的天数差异。

```
 var nowDate = new Date(new Date().setHours(0, 0, 0, 0));
    // Example date of birth.
    var dobDate = new Date["03/31/2001"];

    var years = nowDate.getFullYear() - dobDate.getFullYear();
    var months = nowDate.getMonth() - dobDate.getMonth();
    var days = nowDate.getDate() - dobDate.getDate();

    // Work out the difference in months.
    months += years * 12;
    if (days < 0) {
      months -= 1;
    }
    // Now add those months to the date of birth.
    dobDate.setMonth(dobDate.getMonth() + months);
    // Calculate the difference in milliseconds.
    var diff = nowDate - dobDate;
    // Divide that by 86400 to get the number of days.
    var days = Math.round(diff / 86400 / 1000);
    // Now convert months back to years and months.
    years = parseInt(months / 12);
    months -= (years * 12);
    // Format age as "xx years, yy months, zz days"
    var text = "";
    if (years) {
      text = years + (years > 1 ? " years" : " year");
    }
    if (months) {
      if (text.length) {
        text = text + ", ";
      }
      text = text + months + (months > 1 ? " months" : " month")
    }
    if (days) {
      if (text.length) {
        text = text + ", ";
      }
      text = text + days + (days > 1 ? " days" : " day")
    }
    if (nowDate == dobDate) {
      text = "Newborn"
    }
    return text; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-24T05:14:08.360

```
 function CalculateAge(DobString) {

        $("#age").val(getAge(DobString));
    }

     function getAge(dateString) {
            var now = new Date('2019/01/20');
            var today = new Date(now.getYear(), now.getMonth(), now.getDate());

            var yearNow = now.getYear();
            var monthNow = now.getMonth();
            var dateNow = now.getDate();

            var dob = new Date(dateString.substring(6, 10),
                               dateString.substring(3, 5) - 1,
                               dateString.substring(0, 2) 
                               );

            var yearDob = dob.getYear();
            var monthDob = dob.getMonth();
            var dateDob = dob.getDate();
            var age = {};
            var ageString = "";
            var yearString = "";
            var monthString = "";
            var dayString = "";

            yearAge = yearNow - yearDob;

            if (monthNow >= monthDob)
                var monthAge = monthNow - monthDob;
            else {
                yearAge--;
                var monthAge = 12 + monthNow - monthDob;
            }

            if (dateNow >= dateDob)
                var dateAge = dateNow - dateDob;
            else {
                monthAge--;
                var dateAge = 31 + dateNow - dateDob;

                if (monthAge < 0) {
                    monthAge = 11;
                    yearAge--;
                }
            }

            age = {
                years: yearAge,
                months: monthAge,
                days: dateAge
            };

            if (age.years > 1) yearString = " years";
            else yearString = " year";
            if (age.months > 1) monthString = " months";
            else monthString = " month";
            if (age.days > 1) dayString = " days";
            else dayString = " day";

            if ((age.years > 0) && (age.months > 0) && (age.days > 0))
                ageString = age.years + yearString + ", " + age.months + monthString + " " + age.days + dayString + " ";
            else if ((age.years == 0) && (age.months == 0) && (age.days > 0))
                ageString = " " + age.days + dayString + " ";
            else if ((age.years > 0) && (age.months == 0) && (age.days == 0))
                ageString = age.years + yearString + " ";
            else if ((age.years > 0) && (age.months > 0) && (age.days == 0))
                ageString = age.years + yearString + "  " + age.months + monthString + " ";
            else if ((age.years == 0) && (age.months > 0) && (age.days > 0))
                ageString = age.months + monthString + " " + age.days + dayString + " ";
            else if ((age.years > 0) && (age.months == 0) && (age.days > 0))
                ageString = age.years + yearString + " " + age.days + dayString + " ";
            else if ((age.years == 0) && (age.months > 0) && (age.days == 0))
                ageString = age.months + monthString + " ";
            else ageString = "Oops! Could not calculate age!";

            return ageString;
        } 
```

# objective-c - 如何枚举符合 NSFastEnumeration 的任意集合

> ID：12251327
> 
> 赞同：0
> 
> 时间：2012-09-03T16:23:12.287
> 
> 标签：objective-c, ios, nsenumerator, objective-c-protocol

我试图枚举一堆对象，根据情况，这些对象可能是 NSArray 或 NSOrderedSet。由于两者都符合 NSFastEnumeration，我希望这可以工作：

```
id<NSFastEnumeration> enumerableSet =
(test) ?
[NSArray arrayWithObjects:@"one", @"two", @"three", nil] :
[NSOrderedSet orderedSetWithObjects:@"one", @"two", @"three", nil];

NSEnumerator *e = [enumerableSet objectEnumerator]; 
```

但是，我收到以下编译器错误：

选择器“objectEnumerator”没有已知的实例方法。

我怀疑这里有一些语法错误，我之前没有使用 id 构造。我可以将一组或两组转换为一个通用类，但如果可能的话，我想更好地了解这里发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:32:43.697

`objectEnumerator`未在`NSFastEnumeration`协议中声明，因此 using`[enumerableSet objectEnumerator];`将不起作用，因为您正在使用未定义该方法的类型“id”。

由于`objectEnumerator`被声明为 NSArray 和 NSSet 的属性（没有公共超类），因此您需要从知道它是数组/集合的变量中设置枚举数。IE：

```
NSEnumerator *e = 
(test) ?
[[NSArray arrayWithObjects:@"one", @"two", @"three", nil] objectEnumerator]:
[[NSOrderedSet orderedSetWithObjects:@"one", @"two", @"three", nil] objectEnumerator]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:33:15.427

好吧，那算了。我刚刚找到了我的答案。objectEnumerator 不是协议的一部分 - 所以虽然 NSArray 和 NSOrderedSet*都有*objectEnumerator 消息，但我不能这样使用它。相反，这似乎有效：

```
NSEnumerator *e =
(test) ?
[[NSArray arrayWithObjects:@"one", @"two", @"three", nil] objectEnumerator]:
[[NSOrderedSet orderedSetWithObjects:@"one", @"two", @"three", nil] objectEnumerator]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-07T09:57:49.727

您有符合`NSFastEnumeration`协议的对象，但您正在尝试将“慢”枚举与`NSEnumerator`. 相反，使用快速枚举：

```
id<NSFastEnumeration> enumerableSet =
(test) ?
[NSArray arrayWithObjects:@"one", @"two", @"three", nil] :
[NSOrderedSet orderedSetWithObjects:@"one", @"two", @"three", nil];

for (id object in enumerableSet) {
    // ...
} 
```

请参阅快速枚举使在 Apple 的*Objective-C 编程*[*中枚举集合变得容易*](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/ProgrammingWithObjectiveC/FoundationTypesandCollections/FoundationTypesandCollections.html#//apple_ref/doc/uid/TP40011210-CH7-SW30)。

 *`NSEnumerator`我建议尽可能使用快速枚举；快速枚举更清晰、更简洁、更快。*

# sql - 如何禁用表被删除？

> ID：12251333
> 
> 赞同：0
> 
> 时间：2012-09-03T16:24:07.367
> 
> 标签：sql, sql-server, sql-server-2008

SQL-Server 2008 上是否有可能的方法来禁用某些表被删除或整个数据库表被删除甚至删除任何数据库/表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:31:44.517

简单的答案是：不要将删除表的权限授予不应该拥有它的人。如果您担心应该能够意外删除表的人这样做，您可以创建一个 DDL 触发器：

```
CREATE TRIGGER safety 
ON DATABASE 
FOR DROP_TABLE, ALTER_TABLE 
AS 
   PRINT 'You must disable Trigger "safety" to drop or alter tables!' 
   ROLLBACK
; 
```

[http://msdn.microsoft.com/en-us/library/ms186406(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms186406(v=sql.105).aspx)

# wso2 - wso2 api管理器数据库

> ID：12251336
> 
> 赞同：1
> 
> 时间：2012-09-03T16:24:34.207
> 
> 标签：wso2, wso2esb, wso2carbon, wso2-am

我不明白如何访问 API (api_id) USER (user_id)、订阅的数据（用户 'x' 是否订阅了 API 'y'？）...

**如何通过连接到某些数据库来执行此类控制？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T05:21:56.980

虽然你的问题不是很清楚，但希望你想知道 WSO2 API Manager 是如何实现数据库数据访问部分的。我将解释 WSO2 API Manager 是如何控制数据库数据的。

您可以从 [1] 中找到 WSO2 API Manager 使用的数据库脚本[它包含 h2/mysql/oracle dbscripts]，它用于创建它的数据库表结构。您会注意到有单独的数据库表来存储有关 API 的信息[AM_API] 、subscribers[AM_SUBSCRIBER] 和 subscriptions[AM_SUBSCRIPTION] 等。您会注意到如何使用外键来启用表之间的关系以执行对数据的控制，同时确保数据以一致的方式存储。

然后是为 WSO2 API Manager 相关的后端功能定义的内置 java API，您可以从 [2] 中找到它，并且可以从 [3] 中找到其实现的 java 代码。如果您查看 ApiMgtDAO.java 类实现org.wso2.carbon.apimgt.impl 捆绑包，您将更好地了解 API Manager 的数据库访问层是如何通过数据库数据查询实现的。

以上希望对你有所帮助。

谢谢;

/拉拉吉

[1] [https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/products/apimgt/1.0.0/modules/distribution/resources/sql/](https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/products/apimgt/1.0.0/modules/distribution/resources/sql/)

[2]https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/components/apimgt/org.wso2.carbon.apimgt.api/1.0.0/

[3]https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/components/apimgt/org.wso2.carbon.apimgt.impl/1.0.0/

# java - 关于我的基于联系人的应用程序在 Java 中的冲突处理的说明

> ID：12251337
> 
> 赞同：0
> 
> 时间：2012-09-03T16:24:40.577
> 
> 标签：java

我正在使用 java.util.HashMap 来关联联系人姓名和与联系人关联的电话号码列表，因此它的类型为`String, List<String>`. 但是，可以有多个键可以映射到同一个桶，就像在说 key1:<1234,5678> 存储在哈希映射的索引 2 中一样。我可以有另一个 key2 可以散列到同一个索引中。那么，key1:<1234,5678> 会被 key2:<7890,1456> 代替吗？？？或者它会被链接起来并且 key1 和 key2 都将存储在该索引中？

编辑：我试图理解这一点，下面的代码只返回新墨西哥州。现在在这种情况下，他们都得到相同的哈希码，所以这是正确的冲突吗？在那种情况下，不应该将两个值都链接起来吗？那么存储不应该像说哈希码是 2 那么在地图（或数组）中的索引 2 应该是 1-Mexico, 1-New mexico 正确吗？所以返回的值应该是 Mexico 和 New mexico ？为什么不在这里被锁住？

```
public static void main(String[] args)
    {
        Map<Integer,String> map = new HashMap<Integer,String>();
        map.put(1, "Mexico");
        map.put(1, "New Mexico");
        System.out.println(map.get(1));

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:28:27.023

I'm not totally sure I understand your question.

In a standard [HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html), if you put another value with the same key, it replaces the first one.

But you may use for example a [MultiMap](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/map/MultiValueMap.html) (from Apache commons) to store more than one value per key.

If your question is related to more than one key having the same index, this is handled by the implementation : the keys for are stored in linked lists (one for each bucket) and real comparisons (using `equals`) are done on get and put operations so that no collision can happen as long as `equals` returns false.

As with any collection related problem, the important thing to do if you intend to use your own class is to correctly implement the `equals` and `hashcode` methods (read [this](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)).

**Regarding your question in edit :**

This is a feature of HashMap that the first value with a given key is erased by the new one. So "Mexico" is removed from the HashMap when you add "New Mexico".

If you want to have more than one value for a given key, use a MultiMap (or simply use a `HashMap<Integer, List<String>>` but the `put` operation is a little more tedious).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:28:54.270

This is a design that you ought to think through more carefully. It seems to me that you're using a `Map` and primitives - `String` is a primitive when you use it this way - as a poor approximation to an abstraction that would be better served by a real abstract data type of your own design.

For example, contact name `String` doesn't feel like a good abstraction to me. How many repeated names are there in a phone book? Once your solution grows beyond a non-trivial size you'll have collisions.

So where's the `Contact` class? Let it encapsulate the name `String` and `List` of associated phone numbers in a single object, with a well-written equals and hashCode. Give it a unique id private member; no collisions that way. People who use that class will instantly get a better understanding of what you're trying to accomplish.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:38:17.970

不，当两个不同的键散列到相同的值时，键被链接起来，然后在操作期间，系统对实际键执行等于以定位正确的条目。

如果你创建了一个只为 hashCode() 返回 1 的退化类，HashMap 仍然可以按照规范工作，它只会执行得非常糟糕并变成一个简单的列表。

# c++ - std::u16string、std::u32string、std::string、length()、size()、码点和字符

> ID：12251340
> 
> 赞同：14
> 
> 时间：2012-09-03T16:25:04.290
> 
> 标签：c++, unicode

我很高兴在 C++11 中看到`std::u16string`and `std::u32string`，但我想知道为什么没有`std::u8string`处理 UTF-8 的情况。我的印象`std::string`是为 UTF-8 设计的，但它似乎做得不太好。我的意思是，`std::string.length()`仍然不返回字符串缓冲区的大小而不是字符串中的字符数？

那么，`length()`新的 C++11 类的标准字符串的方法是如何定义的呢？它们是否返回字符串缓冲区的大小、代码点数或字符数（假设代理对是 2 个代码点，但只有一个字符。如果我错了，请纠正我）？

那怎么样`size()`？不等于`length()`吗？请参阅[http://en.cppreference.com/w/cpp/string/basic_string/length](http://en.cppreference.com/w/cpp/string/basic_string/length)了解我的困惑的来源。

所以，我想，我的基本问题是如何使用`std::string`,`std::u16string`和`std::u32string`正确区分缓冲区大小、代码点数和字符数？如果您使用标准迭代器，您是在迭代字节、代码点还是字符？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-03T16:37:44.573

`u16string`并且`u32string`不是“新的 C++11 类”。它们只是`std::basic_string`for`char16_t`和`cha32_t`类型的 typedef。

`length`总是等于`size`任何`basic_string`。它是`T`字符串中 ' 的数量，其中`T`是 的模板类型`basic_string`。

`basic_string`不以任何方式、形状或形式识别 Unicode。它没有代码点、字素、Unicode 字符、Unicode 规范化或任何类似的概念。它只是`T`s 的有序序列。唯一能识别 Unicode 的`u16string`就是`u32string`它们使用由`u""`和`U""`字面量返回的类型。因此，它们可以存储 Unicode 编码的字符串，但它们不做任何需要知道所述编码的事情。

迭代器迭代 的元素`T`，而不是“字节、代码点或字符”。如果`T`是`char16_t`，那么它将迭代`char16_t`s。如果字符串是 UTF-16 编码的，那么它正在迭代 UTF-16 代码单元，而不是 Unicode 代码点或字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:29:09.783

All the string types do the same thing: they hold a sequence of elements, each of whose type is the character type for the string. `length()` and `size()` both return the number of elements. Iterators iterator over elements. Higher-level analysis, such as figuring out the number of characters, require much more complex calculations.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T07:32:09.133

目前，标准中没有内置任何内容来区分代码单元、代码点或单个字节。但是，似乎确实有一些东西正在处理[这类事情](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3398.html)。根据标准委员会的决定，它可能是 TR2 或下一个标准的一部分。

# facebook - 在多重选择器中指定 url 邀请朋友

> ID：12251344
> 
> 赞同：1
> 
> 时间：2012-09-03T16:25:13.837
> 
> 标签：facebook

我有一个带有多选器邀请朋友按钮的应用程序，但是，邀请消息将我的朋友重定向到画布 url 应用程序的主页，我可以将邀请重定向到我的应用程序的特定子 url？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:45:49.570

将此以下代码添加到您的网站主页..

```
<script type='text/javascript'>
if (top.location!= self.location)
{
top.location = self.location
}
</script> 
```

# php - 将像“11:00”或“14:00”这样的时间字符串转换为像1.75这样的十进制时间？

> ID：12251349
> 
> 赞同：0
> 
> 时间：2012-09-03T16:25:33.400
> 
> 标签：php, date, time, timestamp, icalendar

我在 php 手册“日期”上找到了这个函数。

```
<?php 
// Converts a unix timestamp to iCal format (UTC) - if no timezone is 
// specified then it presumes the uStamp is already in UTC format. 
// tzone must be in decimal such as 1hr 45mins would be 1.75, behind 
// times should be represented as negative decimals 10hours behind 
// would be -10 

    function unixToiCal($uStamp = 0, $tzone = 0.0) { 

        $uStampUTC = $uStamp + ($tzone * 3600);        
        $stamp  = date("Ymd\THis\Z", $uStampUTC); 

        return $stamp;        

    } 
?> 
```

我有一个像`$event_time[0]`这样的变量，它具有这样的时间格式`14:00`，即下午 2 点。我怎样才能转换这个时间格式，以便将它传递给`unixToiCal()`上面的函数？

感谢您的答复。

**更新：** 好吧，看来我完全糊涂了。谢谢你们清理事情。并没有真正了解该函数的第二个参数的用途。我来自奥地利，所以 UTC 偏移量应该是`+2`几个小时，对吧。

`strtotime()`我对该方法还有另一个问题。

我有两个变量...... <code>$time 和`$date`......我遇到的问题是它`$date`已经是一个时间戳，`1347667200`并且`$time`是一个“字符串”（我猜）`11:00`或`14:00`.

如何将这两个值组合为一个表示确切日期和时间的时间戳？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:33:38.047

很高兴看到[我的帖子对您​​有所帮助](https://stackoverflow.com/questions/12234925/php-writing-a-ics-ical-file-date-formatting/12234958#12234958)！

您正在使用的功能需要[Unix 时间](http://en.wikipedia.org/wiki/Unix_time)：

> Unix 时间或 POSIX 时间是用于描述时间实例的系统，定义为自 1970 年 1 月 1 日午夜协调世界时 (UTC) 以来经过的秒数，不包括闰秒。

因此，单独的时间值并不能进一步帮助您，您还需要一个日期组件，否则您无法计算 unix 时间。

这是一个如何在 php 中将某些内容转换为 unix 时间的示例：

```
$date_to_unixtime = strtotime('3rd September 2012 18:33:34 PM (UTC)'); 
```

**更新：**

您可以像这样在 php 中为 unix 时间添加时间值：

```
$your_new_timestamp = $your_current_timestamp 
    + ($hours * 3600) 
    + ($minutes * 60)
    + $seconds; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:32:24.227

你似乎有点困惑。你想做什么？

该函数`unixToiCal`需要一个 UNIX 时间戳。这是自 1970 年 1 月 1 日格林威治标准时间午夜以来的非闰秒数。有很多方法可以得到这样的东西，但你不能把一天中的时间“转换”成一个时间，比如“14:00”，因为下午 2 点对应于不同日子的不同时间戳。这是绝对的，与午夜无关。

评论中提到的十进制值是*时区偏移量*。无论如何，这几乎总是一个整数小时，但是如果您正在处理与 UTC 偏移非整数小时数的地方之一，那么您必须将其转换为小时数而不是小时数+分钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:33:19.903

您可以使用`strtotime`将日期和时间字符串转换为时间戳。

# java - Android中的序列化文件

> ID：12251350
> 
> 赞同：3
> 
> 时间：2012-09-03T16:25:37.757
> 
> 标签：java, android, serialization

我的文件管理有问题...

我在 java 应用程序中使用序列化但如此离线创建的这些文件。

在尝试从 android 应用程序反序列化时出现错误...

我猜这不会通过不使用相同的库来支持，在使用 Java 1.6 时使用 Java 1.6 进行序列化，而在 utilizao desserialización google api 4.0 ...

有任何解决这个问题的方法吗？

或者我必须写一个小的android应用程序并在那里序列化？

问候和感谢

克莱文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T07:09:43.933

Java 序列化非常脆弱并且容易中断 - 它适用于本地系统上的短期存储，并且数据通常无法在 clas 签名更改或 JVM 更改后存活（您可以解决这个问题，但这很困难）。更好的解决方案是 XML 或 JSON（不那么冗长）。有很多库可以 [un] 编组您的对象树（to|from）这些格式。只是一些选择：

*   杰克逊
*   谷歌 gson
*   流

安卓的一些经验法则

*   使用拉解析，而不是 DOM
*   注意库大小

我个人的选择是基于精简 GSON 的国产 JSON 序列化器：

[https://github.com/ko5tik/jsonserializer](https://github.com/ko5tik/jsonserializer)

（也可在 Maven 中心获得）

# c++ - C/C++中大数的所有因式

> ID：12251355
> 
> 赞同：2
> 
> 时间：2012-09-03T16:26:24.183
> 
> 标签：c++, c, algorithm, factors

我试图找出10 ^ 18数量级的所有数字因子......但是有时间限制会产生问题。我所做的是使用 Eratosthenes 的 Sieve 来查找因子，然后存储因子，但速度很慢......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:49:10.290

如果空间不是问题，您可以存储最多 10^9 的素数列表（列表可供[下载](http://primes.utm.edu/lists/small/millions/)）并使用它来分解最多 10^18 的任何数字。您还可以使用因式分解算法（如 pollard 的 rho 或[其他](http://www.frenchfries.net/paul/factoring/source.html)算法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:49:19.883

我真的建议阅读有关此整数分解的 Wiki 文章：[http ://en.wikipedia.org/wiki/Integer_factorization](http://en.wikipedia.org/wiki/Integer_factorization)

通用因式分解方法很慢。但是，可以尝试使用一些特殊用途的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T00:59:59.237

将素数列表 p<=10^9 存储到因数 N<=10^18 的想法的问题在于，对于任何特定的 N，您仍然需要遍历素数 p<=sqrt(N) 并检查是否 N%p==0。这不是做生意的最快方式。

从你的问题中不清楚你是想分解一堆 10^18 的数字，还是想分解**所有**数字 N<=10^18。第一种情况是可行的，具体取决于您要考虑多少 N 以及需要多快。第二种情况，**将所有**数字分解为 N<=10^18，是不可行的，因为这将需要超过 10^18 次操作（每个要分解的数字至少一个）。考虑到计算机每秒可以执行大约 10^9 次操作，而一年中大约有 10^7 秒，那么您会考虑很长时间。

如果您只想将一堆数字 N 分解为 10^18 的数量级，那么有很多方法可以做到这一点。“最佳”方式取决于特定数字的属性。例如，平均而言，10^18 左右的随机整数比 10^9 阶的两个素数乘积的整数更容易因式分解，因为在转向更复杂的算法之前，可以通过试除法消除小因素。这更像是一个计算数论问题而不是编程问题。如果这是您的问题，我向[mersenneforum.org 的 Factoring 部分推荐](http://www.mersenneforum.org/forumdisplay.php?f=19)。

如果您想要一个快速而肮脏的解决方案，而且速度不会慢得离谱，那么不要重新发明轮子。尝试例如 GMP-ECM 或查看 PARI/GP 是否可以解决您的问题。

# android - Spinner 内的 ListView：事件检测的适配器冲突

> ID：12251364
> 
> 赞同：2
> 
> 时间：2012-09-03T16:27:19.140
> 
> 标签：android, events, listview, spinner

我在 onCreate 方法中的[微调器](http://developer.android.com/guide/topics/ui/controls/spinner.html)中嵌入了一个[列表视图。](http://developer.android.com/guide/topics/ui/layout/listview.html)我想在单击事件的列表项上触发 [toast](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)消息，但无法在 ListView 项上设置 onClick 侦听器。我没有使用任何自定义适配器。我猜微调器和列表视图都使用了相同类型的简单适配器，因此它会产生一些编译挫折。

我一直关注为`"lv.setOnItemClickListener(new AdapterView.OnItemClickListener`" 获得的错误：

> new AdapterView.OnItemClickListener(){} 类型必须实现继承的抽象方法 AdapterView.OnItemClickListener.onItemClick(AdapterView, View, int, long)

如何设法在使用简单适配器的列表视图项目上设置单击事件？我应该以某种方式“重命名”列表视图适配器还是如何继续..？

伪代码

```
// ...
import android.widget.AdapterView;
/* manually added */
import android.widget.AdapterView.OnItemClickListener;

public class MyActivity extends Activity {

onCreate(Bundle savedInstanceState){

// ... some code
        // Set Spinner listener
        mySpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {

            @Override
            public void onItemSelected(AdapterView<?> spinner, View v, int position, long id) {

// ... some code

                    lv.setOnItemClickListener(new AdapterView.OnItemClickListener()) {
                        public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
                                // When clicked, show a toast with the TextView text
                                Toast.makeText(getApplicationContext(), "some msg" , Toast.LENGTH_SHORT).show();
                            }
                        });

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:21:48.090

所以我在同一个活动中有一个微调器和一个列表视图。根据微调器选择，我更新了一个列表视图。我还从其他事件（例如按钮事件）更新相同的列表视图。代码原理如问题中所述。

我确认这种方式非常有效，并且我解决了我的问题，该问题与微调器/ListView 交互有关，但与我获取数据以提供列表的方式有关。

为了说明结果，我的布局看起来与[此](http://blog.maxaller.name/2010/05/attaching-a-sticky-headerfooter-to-an-android-listview/)类似，但在微调器上添加了按钮，它们都驱动列表视图结果。

# c++ - std::vector 的类型要求

> ID：12251368
> 
> 赞同：2
> 
> 时间：2012-09-03T16:27:32.963
> 
> 标签：c++, constructor, c++11, allocation, stdvector

我仍然对`std::vector`在 C++11 中与 a 一起使用的类型的要求感到困惑，但这可能是由错误的编译器（gcc 4.7.0）引起的。这段代码：

```
struct A {
  A() : X(0) { std::cerr<<" A::A(); this="<<this<<'\n'; }
  int X;
};

int main()
{
  std::vector<A> a;
  a.resize(4);
} 
```

工作正常并产生预期的输出，表明调用了默认 ctor（显式给出）（而不是隐式复制 ctor）。但是，如果我向班级添加已删除的副本 ctor，即

```
struct A {
  A() : X(0) { std::cerr<<" A::A(); this="<<this<<'\n'; }
  A(A const&) = delete;
  int X;
}; 
```

gcc 4.7.0 不会编译，但会尝试使用已删除的 ctor。这是正确的行为还是错误？如果是前者，如何让代码工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-03T16:59:31.783

~~`CopyInsertable`正如其他人指出的那样，C++11 标准确实需要。然而，这是 C++11 标准中的一个错误。这已在[N3376](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3376.pdf)中更正为`MoveInsertable`和`DefaultInsertable`。~~

成员`vector<T, A>::resize(n)`函数需要`MoveInsertable`和。`DefaultInsertable`这些大致转换为`DefaultConstructible`分配器`MoveConstructible`使用`A`默认`construct`定义的时间。

以下程序使用 clang/libc++ 编译：

```
#include <vector>
#include <iostream>

struct A {
  A() : X(0) { std::cerr<<" A::A(); this="<<this<<'\n'; }
  A(A&&) = default;
  int X;
};

int main()
{
  std::vector<A> a;
  a.resize(4);
} 
```

对我来说打印出来：

```
 A::A(); this=0x7fcd634000e0
 A::A(); this=0x7fcd634000e4
 A::A(); this=0x7fcd634000e8
 A::A(); this=0x7fcd634000ec 
```

如果您删除上面的移动构造函数并将其替换为已删除的复制构造函数，`A`则不再`MoveInsertable`/`MoveConstructible`作为移动构造，然后尝试使用已删除的复制构造函数，如 OP 的问题中正确演示的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T16:36:52.983

在 C++11 中，要求取决于执行的操作。在 的情况下`std::vector<T>::resize()`，要求`T`是它[`CopyInsertable`](http://en.cppreference.com/w/cpp/concept/CopyInsertable)在向量中。

从§23.3.6.3

> `void resize(size_type sz);`
> 
> ……
> 
> 要求：`T`应`CopyInsertable`入*this。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T16:34:55.007

要在向量中使用一个类，它应该有一个复制构造函数/赋值运算符或一个 noexcept 移动构造函数/赋值运算符。GCC 不编译没有这些的示例是完全正确的。

除了向量之外，你将如何做任何事情而不能够复制或移动它包含的内容？

第一个示例有效的原因是，由于您没有定义任何复制或移动构造函数或赋值运算符，因此您获得了默认值。在第二个示例中，由于您显式删除了复制构造函数，因此您不会获得任何自动生成的构造函数或赋值运算符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-03T16:35:33.413

[在 ideone 上](http://ideone.com/akPp3)，我看到一个对默认构造函数的调用。但是正在创建四个对象，其他对象必须以某种方式构建。实际上，原型对象是默认构造的，然后被复制了四次。

C++11 标准（第 23.3.6.3 节）说将插入“值初始化”对象，但也要求类型是可复制的：

> `void resize(size_type sz);`
> 
> *   效果：如果`sz <= size()`，等价于`erase(begin() + sz, end());`。如果`size() < sz`, 将值初始化的元素附加`sz - size()`到序列中。
> *   要求：`T`应`CopyInsertable`入`*this`。

这里没有编译器错误；这是你的代码是错误的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-03T16:37:06.440

`void resize(size_type)`requires `CopyInsertable`，这意味着分配器应该能够构造-复制类型：

```
::new((void*)p)A(A()); 
```

这意味着需要一个复制构造函数。您应该能够使用自定义分配器绕过它：

```
struct Allocator: public std::allocator<A> {
  void construct(A *, const A &) { }
}; 
```

但是 libstdc++ 不尊重这一点；请参阅[（在 C++11 中）std::vector::resize(size_type) 是否适用于默认的可构造 value_type int[4]？](https://stackoverflow.com/questions/12192895/should-in-c11-stdvectorresizesize-type-work-for-the-default-constructi/12193149#12193149)

# jquery - jquery selector, chaining

> ID：12251373
> 
> 赞同：0
> 
> 时间：2012-09-03T16:28:00.993
> 
> 标签：jquery, jquery-selectors, css-selectors

> **Possible Duplicate:**
> [Merging jQuery objects](https://stackoverflow.com/questions/1881716/merging-jquery-objects)

** The goal is performance. The duplicate question addresses the function, but I don't believe adds performance value and doesn't address that aspect. **

I want to chain several jQuery elements, for the sake of performance, but for optimization sake they're already cached in variables.

so if I have

```
$elem1 = $('div#elem1');
$elem2 = $('div#elem2');
$elem3 = $('div#elem3'); 
```

This doesn't work so well:

```
$elem1,$elem2,$elem3.hide(); 
```

Is there any way to do that, chaining with already cached elements?

Thanks!

[Edits]
Ok, I really need to clarify. My goal for chaining is performance, with the bonus of concise yet clear code.
$('div#elem1, div#elem2, div#elem3').hide();
defeats the point as it's no longer using the cached vars, but accessing the dom again. Accessing the dom is expensive, so i'm pretty sure it's slower than the 3 lines.
.add() and .merge(), I'm assuming are more expensive than seperating the operation on three lines. For performance sake, until I have time to jPerf, I'll assume 3 different lines rather than extra operations has the best performance.

Thanks for the collaboration, brainstorming, and thoughts, I do appreciate it. I wasn't aware of the possibilities and wouldn't have known what to test on jPerf otherwise.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:45:33.983

不确定它有多干净，但您可以使用 jQuery`each()`来遍历它们的数组。它不完全是链接，但最终结果应该是相同的：

```
$.each([$elem1,$elem2,$elem3], function() {this.hide()}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:30:38.323

我唯一能想到的就是把它们放在一起[`.add()`](http://api.jquery.com/add)

```
$elem1.add($elem2).add($elem3).hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:35:11.597

不，我的朋友，这永远不会奏效。尝试这样做

> $('div#elem1, div#elem2, div#elem3').hide();

或者

> $elem1.hide(); $elem2.hide(); $elem3.hide()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T16:37:40.467

```
var elements = [];
elements.push($elem1);
elements.push($elem2);
elements.push($elem3);

$(elements).each(function(i){
    elements[i].hide();
}); 
```

# iphone - Releasing after pushing in iOS

> ID：12251374
> 
> 赞同：0
> 
> 时间：2012-09-03T16:28:13.130
> 
> 标签：iphone, objective-c, ios, memory-management, memory-leaks

So I have the following code where I am releasing an object after pushing it to another view. When I analyse it I get the error - Incorrect decrement of the reference count of an object that is not owned at this point by the caller. Would anyone know how to fix this? I've tried so many options each time getting a different memory leak

```
- (void)showCurrentArticle:(id)sender {
    if(animating) 
        return; //it is already there
    animating = YES;
    JsonViewController *newsController = [(JsonViewController *)[self.newsNavController.viewControllers objectAtIndex:0]retain];
    newsNavController.title = @"Parliament";
    Item *currentItem = (Item *)[self.fetchedObjectsArray objectAtIndex:currentItemIndex];
    NSString * urlString = [CONST_FEED_DISCRIPTION_URL stringByAppendingString:currentItem.guid];
    [newsController initWithURLString:urlString date:currentItem.date];
    [self.navigationController pushViewController:newsController animated:YES];
    [newsController release];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:34:27.470

此代码采用导航堆栈中已经存在的视图控制器，重新初始化它，然后再次将其推送到堆栈中。这似乎根本不对。您可能应该创建一个新的视图控制器。这有什么背景？你想达到什么目的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:51:16.807

您不需要保留和释放 newsController 对象。这就是您收到警告的原因。看起来 newsController 由 newsNavController 对象拥有，该对象将保留它。您需要在此代码中保留 newsController 的唯一原因是您需要在此方法范围之外使用它。由于您不需要保留它，因此您不需要释放它，因此会出现错误。您可能会假设该`-initWithURLString:date:`方法正在增加保留计数，但它只是 new、alloc 和 retain 这样做的。您可能应该重命名该方法以不使用术语 init 以避免混淆。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:41:33.073

您正在弹出，更改标题，而不是进行初始化...

决定您是对`JsonViewController`（alloc、init、复制字段值）进行深度克隆还是仅引用副本（保留）。如果您尝试混合，以后会很混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T18:35:47.090

你在做什么`-initWithURLString:date:`？？？你只是添加一个网址吗？然后你应该调用它`addURL...`......如果你真的再次初始化它，你将newsController变量的指针设置为一个新对象。它指向的第一个对象丢失 -> 泄漏。

我假设您将 init 方法命名错误，只是将 url 添加到控制器中，该控制器已经在堆栈中，然后以更高的保留计数再次添加它，但仍然是相同的对象。

不要这样做。复制对象或更好 - 创建 viewController 的新实例！！！

# java - 用 Java 截屏（机器人，代码工作，但不能使用外部全屏应用程序）

> ID：12251376
> 
> 赞同：3
> 
> 时间：2012-09-03T16:28:32.337
> 
> 标签：java, awt, fullscreen, screenshot, awtrobot

我正在使用以下代码截取屏幕截图：

```
 Robot robot = new Robot();
        BufferedImage image = robot.createScreenCapture(screenRectangle);
        ImageIO.write(image,"png", file); 
```

这段代码运行良好。当我运行程序等时，它会为我的桌面截屏。

但是，当我尝试先**全屏**运行一些游戏、应用程序时，它无法正常工作。它要么呈现黑屏，要么呈现相同的“初始”画面。

这个问题已知吗，请问如何解决？

**第二个问题：** 这是否可以模拟一些我们可以在键盘上使用的“打印屏幕”键来解决这个问题？因为当应用程序全屏启动时我可以使用*Print Screen 键*，当我粘贴时我得到了我的屏幕。
（像这样，但在 java 中：[复制屏幕或活动窗口的内容](http://www.devx.com/vb2themax/Tip/18341)？）

预先感谢您的帮助。

**编辑**：Andrew Thompson 很乐意向我推荐以下代码，这将是解决此问题的良好第一步：

```
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.event.KeyEvent;

public class ScreenshotUsingPrintScreen {

public static void main(String[] args) throws Exception {
    int i = KeyEvent.VK_PRINTSCREEN;
    Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
    DataFlavor[] flavors = cb.getAvailableDataFlavors();
    System.out.println("Before: ");
    for (DataFlavor flavor : flavors) {
        System.out.println(flavor);
    }

    // get the screenshot
    Robot robot = new Robot();
    robot.keyPress(KeyEvent.VK_PRINTSCREEN);
    robot.delay(40);
    robot.keyRelease(KeyEvent.VK_PRINTSCREEN);
    robot.delay(40);

    cb = Toolkit.getDefaultToolkit().getSystemClipboard();
    flavors = cb.getAvailableDataFlavors();
    System.out.println("After: ");
    for (DataFlavor flavor : flavors) {
        System.out.println(flavor);
    }
} 
```

}

它编译得很好，但是我在运行它时收到以下错误。

```
Before: 
java.awt.datatransfer.DataFlavor[mimetype=application/x-java-text-encoding;representationclass=[B]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.Reader]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.lang.String]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.CharBuffer]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[C]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.io.InputStream;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=java.nio.ByteBuffer;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/html;representationclass=[B;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=application/x-java-serialized-object;representationclass=java.lang.String]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.Reader]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.lang.String]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.CharBuffer]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[C]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=unicode]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=US-ASCII]
Exception in thread "main" java.lang.IllegalStateException: cannot open system clipboard
    at sun.awt.windows.WClipboard.openClipboard(Native Method)
    at sun.awt.datatransfer.SunClipboard.getClipboardFormatsOpenClose(SunClipboard.java:332)
    at sun.awt.datatransfer.SunClipboard.getAvailableDataFlavors(SunClipboard.java:172)
    at zipprotected.threadsTest.ScreenshotUsingPrintScreen.main(ScreenshotUsingPrintScreen.java:36)
Java Result: 1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:33:34.187

> 这个问题知道吗，..

是的。通常它是由将渲染下移到显卡本身的级别（主要是避开操作系统）引起的。

> ..以及如何解决这个问题？

AFAIU 它无法修复。甚至是原生截图应用。将无法获得此类渲染的屏幕截图。

> 这是否可以模拟一些“打印屏幕”键来解决这个问题？

```
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.event.KeyEvent;

public class ScreenshotUsingPrintScreen {

    public static void main(String[] args) throws Exception {
        int i = KeyEvent.VK_PRINTSCREEN;
        Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
        DataFlavor[] flavors = cb.getAvailableDataFlavors();
        System.out.println("Before: ");
        for (DataFlavor flavor : flavors) {
            System.out.println(flavor);
        }

        // get the screenshot
        Robot robot = new Robot();
        robot.keyPress(KeyEvent.VK_PRINTSCREEN);
        robot.delay(40);
        robot.keyRelease(KeyEvent.VK_PRINTSCREEN);
        robot.delay(40);

        cb = Toolkit.getDefaultToolkit().getSystemClipboard();
        flavors = cb.getAvailableDataFlavors();
        System.out.println("After: ");
        for (DataFlavor flavor : flavors) {
            System.out.println(flavor);
        }
    }
} 
```

### 输出

```
Before: 
java.awt.datatransfer.DataFlavor[mimetype=application/x-java-text-encoding;representationclass=[B]
java.awt.datatransfer.DataFlavor[mimetype=text/rtf;representationclass=java.io.InputStream]
java.awt.datatransfer.DataFlavor[mimetype=text/rtf;representationclass=java.nio.ByteBuffer]
java.awt.datatransfer.DataFlavor[mimetype=text/rtf;representationclass=[B]
java.awt.datatransfer.DataFlavor[mimetype=application/x-java-serialized-object;representationclass=java.lang.String]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.Reader]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.lang.String]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.CharBuffer]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[C]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=unicode]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-8]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16BE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=UTF-16LE]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=ISO-8859-1]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=windows-1252]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=windows-1252]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=windows-1252]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.io.InputStream;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=java.nio.ByteBuffer;charset=US-ASCII]
java.awt.datatransfer.DataFlavor[mimetype=text/plain;representationclass=[B;charset=US-ASCII]
After: 
java.awt.datatransfer.DataFlavor[mimetype=image/x-java-image;representationclass=java.awt.Image] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-06T07:16:29.157

你的问题的解决方案就在你面前，尝试不同的想法。您不需要使用`PrtScr`功能，因为几乎所有平台（游戏）都具有内置的屏幕截图功能。

以 Steam 为例，这包括所有通过 Steam 玩的游戏，`F12`用于截屏。而不是在您的代码中使用`PrtScr`, use ，而是`F12`自动存储该文件，使用该文件，随心所欲地使用它。

我知道这有点晚了，但我希望它对您的项目有所帮助。

编辑以添加确切的代码：

```
if (e.getKeyCode() == NativeKeyEvent.VC_0) {
    Robot robot = null;
    try {
        robot = new Robot();
        robot.keyPress(KeyEvent.VK_F12);
        robot.keyRelease(KeyEvent.VK_F12);
    } 
    catch (AWTException ex) {
        Logger.getLogger(JavaApplication6.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

这和steam有关，基本上当你按“0”时，你的程序会模拟输入`F12`，这会截图，保存在`"STEAM\userdata\137637106\760\remote\570\screenshots"`目录中。

希望这可以帮助。

# javascript - Share closure code (javascript)

> ID：12251378
> 
> 赞同：1
> 
> 时间：2012-09-03T16:28:40.670
> 
> 标签：javascript

Is there any way to share code between two closures?

Example:

```
// ANTIPATTERN

var cbDoThing = function cbDoThing(arg){
    return typeof closed1 +" " + arg;
}

function getClosure1(closed1) {
    return cbDoThing;
}

function getClosure2(closed1) {
    return function(arg) {
        // do other work
        return cbDoThing(arg);
    }
}

f1 = getClosure1();
f1("ARG1"); // returns "undefined ARG1"
f2 = getClosure2();
f2("ARG2"); // returns "undefined ARG2" 
```

Here `getClosure1()` and `getClosure2()` return a closure that does similar tasks. I.e. both of them need to execute the `cbDoThing()` within a closure environment, but `getClosure2()` runs some other code in addition.

The above example does not work as wanted. `cbDoThing()` is defined in the global context, so closed1 variable is undefined. The wanted behavior is a pattern to make the closed1 variable be read from the closure scope chain, but without redefining the `cbDoThing()`function in each closure.

PS: [JsFiddle playground](http://jsfiddle.net/9ZUpW/1/).

**EDIT**: Now that I asked, an answer came to me with minor modifications:

```
var cbDoThing = function cbDoThing(closed1, arg){
    return closed1 +" " + arg;
}

function getClosure1(closed1) {
    return function(arg) {
        return cbDoThing(closed1, arg);            
    }
}

function getClosure2(closed1) {
    return function(arg) {
        // do other work
        return cbDoThing(closed1, arg);
    }
} 
```

The cbDoThing does not access closed1 variable from the closure variable scope. Rather it is passed an extra argument. Then this function is called from each of the closures.

[JsFiddle](http://jsfiddle.net/9ZUpW/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:36:28.570

不错的作品。Javascript 只走原型链，这意味着 cbDoThing 没有引用或声明 closed1。在这种情况下，cbDoThing 只有一个原型——Object。如果没有显式地将参数传递给 cbDoThing，它将没有任何 closed1 的概念。

这是对 javascript 中闭包的彻底讨论：http: [//jibbering.com/faq/notes/closures/](http://jibbering.com/faq/notes/closures/)

# fonts - Twitter Bootstrap 和 Font-Awesome：一些字体显示为双字体（甚至更多）

> ID：12251380
> 
> 赞同：6
> 
> 时间：2012-09-03T16:28:49.793
> 
> 标签：fonts, twitter-bootstrap, font-awesome

具体来说...

```
<i class="icon-ok"></i> and <i class="icon-hand-up"></i> 
```

...显示为双倍或四倍。

![这就是我所看到的](../Images/153b0549ddf0505e483f4948df6fda4a.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T17:41:14.957

> [在此处](http://twitter.github.com/bootstrap/customize.html)自定义 Twitter Bootstrap 。确保取消选中“基本 CSS”下的默认“图标”。

因为您还没有这样做，所以 Glyphicons 和 Font Awesome 图标都是可见的。

# php - Need help redirecting and firing a pixel

> ID：12251385
> 
> 赞同：-1
> 
> 时间：2012-09-03T16:28:59.987
> 
> 标签：php, redirect

I'm an affiliate marketer with essentially no programming experience, but I need a little help and I'm hoping you guys can help me out.

Currently I use a simple PHP redirect so that my advertiser can't see the ref URL of the site I have my ads on. (I assume this accomplishes that?)

```
<?php
header("Location: DESINATION URL");
exit;
?> 
```

The ad server that I use allows me to target or exclude my ad campaigns to/from any user that has fired a particular pixel (iframe or script). The idea is that with this re-targeting capability, you can target your ad campaigns to people who visited a particular website in the past that you have a pixel on.

So, what I need to do is not only redirect users, but I want to figure out how to simultaneously fire either the iframe or script pixel. Here's the idea. Someone that clicks on one of my ads but doesn't end up making a purchase isn't someone that I want to serve ads to over and over again. Once they click, I want them to no longer be eligible to see one of my ads. The only way to do this is to fire a pixel for that user when they click, so that I can then use this retargeting feature of the ad server I use to exclude those users from my campaigns. Make sense?

User lands on the page pixel fires page redirects to destination URL

Is this possible?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:39:21.387

不，基于标头的重定向将始终向客户端显示 url。它本质上是在告诉浏览器“嘿，到这里来获取这个地址”。您的服务器没有获取该地址的内容，它只是告诉浏览器自己去哪里获取它。

您需要的是代理 - 您的服务器获取 URL 并将结果发送回客户端。

你是什​​么意思，“发射一个像素”？加载网络错误？

# javascript - 数据表从 API 获取 JSON 而不设置“aaData”

> ID：12251387
> 
> 赞同：0
> 
> 时间：2012-09-03T16:29:12.713
> 
> 标签：javascript, jquery, json, jquery-plugins, datatables

我正在使用数据表，我得到我的数据，如示例中所示

```
$('.data-table').dataTable({
        "bProcessing": true,
        "sAjaxSource": "/api/item/list",
        "aoColumns": [
            { "mData": "Title" },
            { "mData": "Price" }
        ]
}); 
```

但是有一个问题，我需要把我所有的对象都包起来，`aaData`这样才能像这样工作

```
[HttpGet]
public dynamic List()
{
    var items = _db.Items.OrderBy(x => x.ID);

    var a = new {
        aaData = items
    };

    return a;
} 
```

这很糟糕，因为我需要为此修改后端而不是返回普通的 JSON。我尝试设置`aaData`而不是`sAjaxSource`但出现错误，但没有奏效。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:38:42.373

代替 property `aaData`，您可以告诉 DataTables 使用带有[`sAjaxDataProp`](http://datatables.net/usage/options#sAjaxDataProp)参数的另一个属性名称。例如：

```
// Get data from { "data": { "inner": [...] } }
$(document).ready( function() {
  var oTable = $('#example').dataTable( {
    "sAjaxSource": "sources/data.txt",
    "sAjaxDataProp": "data.inner"
  } );
} ); 
```

# lambda - 排除 Lambda 表达式中的行

> ID：12251389
> 
> 赞同：1
> 
> 时间：2012-09-03T16:29:25.990
> 
> 标签：lambda, linq-to-entities

我有这个 Linq-to-Entities 表达式

```
return
                (from aa in DataContext.AccommodationAmenities
                 join a in DataContext.Amenities
                     on aa.AmenityId equals a.Id
                 where a.LowerCaseAmenity.Contains(lowerCaseSearchTerm)
                 select new AmenitySummary
                            {
                                AmenityId = a.Id,
                                Amenity = a.Amenity1,
                                LowerCaseAmenity = selected//a.LowerCaseAmenity
                            }).Distinct(); 
```

而且我还有一个字符串数组，其中包含我想从这个列表中排除的设施。最后有没有办法做这样的事情

```
.Exclude(a => a.Amentiy == stringArray) 
```

所以基本上，stringArray 包含一些设施，其中一些将等于 AmenitySummary 中的 Amenity。如果它们相等，我不想将其添加到结果中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:53:10.287

尝试以下操作：

```
return
                (from aa in DataContext.AccommodationAmenities
                 join a in DataContext.Amenities
                     on aa.AmenityId equals a.Id
                 where a.LowerCaseAmenity.Contains(lowerCaseSearchTerm)
                       && !stringArray.Contains(a.Amenity1)
                 select new AmenitySummary
                            {
                                AmenityId = a.Id,
                                Amenity = a.Amenity1,
                                LowerCaseAmenity = selected//a.LowerCaseAmenity
                            }).Distinct(); 
```

# mysql - Find out AVG column in SQL

> ID：12251394
> 
> 赞同：1
> 
> 时间：2012-09-03T16:29:54.023
> 
> 标签：mysql, sql

I have this php/sql Query:

```
$result = mysql_query("
            SELECT r.item_id, AVG(rating) AS avgrating, count(rating) AS count, i.item, c.category
            FROM ratings AS r
            LEFT JOIN items AS i
            ON r.item_id = i.items_id
            INNER JOIN master_cat c
            ON c.cat_id = i.cat_id
            GROUP BY item_id 
            ORDER BY avgrating DESC 
            LIMIT 25;"); 
```

When I output this, count is correct, it shows how much votes certain items have received.

I simply want to add a `WHERE count >= 10` clause but everything breaks. Obviously, when there are thousands of items, some will get one vote and have 100%. But that is not a good indicator. I want to print out items that have at least 10 votes (or `count >= 10`)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:31:24.547

你应该`having`改用`where`

```
SELECT 
    r.item_id, AVG(rating) AS avgrating, 
    count(rating) AS count, i.item, c.category
FROM 
    ratings AS r
    LEFT JOIN items AS i
        ON r.item_id = i.items_id
    INNER JOIN master_cat c
        ON c.cat_id = i.cat_id
GROUP BY 
    item_id 
HAVING
    count >= 10
ORDER BY 
    avgrating DESC 
LIMIT 25; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:32:15.663

你需要告诉它你想计算什么

```
having count(*) > 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T16:33:04.017

您不能`where`对聚合函数 ( `count()`) 的结果使用过滤器。`where`在行级别应用，因为数据库正在决定是否在结果集中包含该行 - 此时计数结果尚不可用。

您需要的是一个`having`子句，在计算完所有聚合结果之后，将其作为结果发送到客户端之前的最后步骤之一应用。

```
...
GROUP BY item_id
HAVING count > 10
ORDER BY ... 
```

# user-interface - mono: is there a gtk gui designer like visual studio 2010?

> ID：12251395
> 
> 赞同：1
> 
> 时间：2012-09-03T16:29:56.267
> 
> 标签：user-interface, mono, gtk, designer

My computer system consists of VirtualBox with Ubuntu 12.04 as the host and Windows7 as the guest. Ubuntu serves as my every day computer needs while Windows7 serves as my cross-platform testing needs. I am using MonoDevelop in Ubuntu 12.04 for all my C# needs. Is there is a GTK GUI designer for Ubuntu 12.04 that has the ability to help guide the alignment of the GTK Widgets like Visual Studio 2010 does for Controls? I've been really spoiled with Visual Studio GUI designer, I really like the auto snap(or is it called docking?) and alignment guidance features that VS Studio provides.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:37:31.697

根据我的研究，恐怕您拥有最好的 Linux 为单声道开发提供的功能。我能为您找到的最好的是[Stetic GUI Designer](http://monodevelop.com/documentation/stetic_gui_designer)。从来没有用过，但看起来很有希望。

我一直将 Eclipse 用于我的 C# 开发，并且在那个社区中绝对没有这样的东西。现在考虑换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:22:04.940

我认为你不能。GTK 使用表格概念进行设计。您可以使用垂直或水平容器，或表格...

但是你不能用一个简单的手势拖拽和对齐。

您应该首先想象您想要什么设计，然后再考虑哪些容器可以帮助您完成您的设计。

# c# - OAuth 2.0 access using javascript

> ID：12251400
> 
> 赞同：0
> 
> 时间：2012-09-03T16:30:11.477
> 
> 标签：c#, javascript, asp.net, google-fusion-tables, insert-update

I want to insert, update data from the fusion tables. While selecting from the fusion table all seems to work fine. But during row addition i need to used OAuth 2.0 but unable to find a suitable solution to get the access token and use it during the insert.

A code sample would help a lot.

```
 var fusiondata;
  function initialize() {

    // Initialize JSONP request
    var script = document.createElement('script');
    var url = ['https://www.googleapis.com/fusiontables/v1/query?'];
    url.push('sql=');
    var query = 'insert into 1bPbx7PVJU9NaxgAGKqN2da4g5EbXDybE_UVvlAE (name,luckynumber) values('abc',89)'; 
    var encodedQuery = encodeURIComponent(query);
    url.push(encodedQuery);
    url.push('&callback=viewData');
    url.push('&key=AIzaSyA0FVy-lEr_MPGk1p_lHSrxGZDcxy6wH4o');
    script.src = url.join('');
    var body = document.getElementsByTagName('body')[0];
    body.appendChild(script);
  }

  function viewData(data) {
  // code not required
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T16:55:34.217

我知道你们中的大多数人都在为 google auth 以及插入和更新融合表而受苦。我正在提供整个代码如何使用 gauth lib 以简单的方式插入

```
 <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Authorization Request</title>
    <script src="https://apis.google.com/js/client.js"></script>
        <script type="text/javascript">
          function auth() {
            var config = {
              'client_id': '365219651081-7onk7h52kas6cs5m17t1api72ur5tcrh.apps.googleusercontent.com',
              'scope': 'https://www.googleapis.com/auth/fusiontables'
            };
            gapi.auth.authorize(config, function() {
              console.log('login complete');
              console.log(gapi.auth.getToken());
            });
          }
          function insert_row(){
                alert("insert called");
                gapi.client.setApiKey('AIzaSyA0FVy-lEr_MPGk1p_lHSrxGZDcxy6wH4o');

                var query = "INSERT INTO 1T_qE-o-EtX24VZASFDn6p3mMoPcWQ_GyErJpPIc(Name, Age) VALUES ('Trial', 100)";

                gapi.client.load('fusiontables', 'v1', function(){
                    gapi.client.fusiontables.query.sql({sql:query}).execute(function(response){console.log(response);});
                });

            }
        </script>
    </head>

    <body>
    <button onclick="auth();">Authorize</button>
    <p>&nbsp;</p>
    <button onclick="insert_row();">Insert Data</button>
    </body>
    </html> 
```

# svn - SVN Merge issue .. is not the same repository as

> ID：12251403
> 
> 赞同：1
> 
> 时间：2012-09-03T16:30:27.577
> 
> 标签：svn, merge, tortoisesvn

I am working in a .net project and clients use SVN as source control. Currently we have a trunk version of the code which is in `svn://svnserver.com/Code/Trunk` and a branch is also present which is `svn://svnserver.com/Code/Branches/Myteam`. We are downloading the code from branch and working in our local machine and committing code changes in the branch

Now I wanted to merge the code changes from branch to trunk. When I started merging from BRANCH to TRUNK, I get the following error

> svn://svnserver.com/Code/Trunk is not the same error as svn://svnserver

I don't know what's going wrong. But I am new to using SVN so I am not sure how to get rid of this error.

For both TRUNK and BRANCH, I have mapped my local folder correctly and the code is downloaded without any issues.

But only merging is becoming a problem. Do I need to do any settings in SVN? Any help wpuld be appreciated?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-26T19:48:53.783

您必须确保始终使用完全相同的 URL 访问您的 SVN 服务器。即使您的 SVN 服务器可以使用其中任何一个访问，`svn://server/repos`或者`svn://server.company.com/repos`您必须确保对两个分支使用相同的 URL。

如果您有一个工作副本想要更改/更正服务器的 URL，那么您可以使用“TortoiseSVN->Relocate...”命令来执行此操作。

# java - Hibernate, MySQL - Data truncation: Data too long for column exception message

> ID：12251404
> 
> 赞同：1
> 
> 时间：2012-09-03T16:30:30.760
> 
> 标签：java, mysql, hibernate, jpa, truncation

I understand what this message means, but I do not understand why it is giving this message. I say this because I'm not trying to update this field.

**Column definition:**

```
@Column(name="company_name")
private String companyName; 
```

 **Then I create a Query using EntityManager.

**Query**

```
query = em.createQuery("update Client set companyName = :companyName" +
                " where id = :id");

query.setParameter("companyName", client.getCompanyName());
query.setParameter("id", client.getId());

query.executeUpdate(); 
```

And the exception reads: `Data truncation: Data too long for column 'company_cnpj' at row 1`

But I'm not changing the 'company_cnpj' row. Why is it giving me this error?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:10:53.767

数据库中的字符串总是有长度的；因为你没有指定一个，它默认为 255。这篇文章告诉你如何改变它：

[hibernate属性字符串长度问题](https://stackoverflow.com/questions/4809787/hibernate-property-string-length-question)**

# wpf - 如何绑定到 XAML 中 ContentPresenter 的可视内容？

> ID：12251407
> 
> 赞同：1
> 
> 时间：2012-09-03T16:30:35.160
> 
> 标签：wpf, xaml

我在 UserControl 中有一个 ContentPresenter。ContentPresenter 的内容是一个数据对象，数据类型的 DataTemplate 定义了 ContentPresenter 的 UI（其根是另一个 UserControl）。

外部 UserControl 中的按钮需要将其内容绑定到在 ContentPresenter 托管的内部 UserControl 上定义的附加属性的值。如何在 XAML 中执行此操作？

更广泛地说，在不同名称范围或跨模板边界定义的视觉对象交互的好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:40:35.807

我有一个类似的问题。最后，我从代码隐藏中对其进行了排序。XAML 不擅长某些事情。

我需要将我的 DataTemplate 的根 UserControl 的 Top 属性绑定到包含它的 ContentPresenter 的 Canvas.Top 附加属性。在我的情况下，ContentPresenter 是由 ItemsControl 生成的，它将 DataTemplate 应用于基础数据对象集合。ContentPresenter 的 Content 属性指向底层数据对象，而不是我需要引用的 Visual 对象。虽然这不是您所面临的问题，但我认为问题的关键是相同的——试图找到对 ContentPresenter 的可视内容的引用。

在最里面的 UserControl 后面的代码中，我通过重写 EndInit 方法来连接绑定。我只打算在一种情况下使用控件，所以这对我来说是可以接受的，但是代码可以根据您的情况移动到其他地方。

```
/// <summary>
/// Indicates that the initialization process for the element is complete
/// </summary>
public override void EndInit()
{
    this.BindToParentContentPresenter();
    base.EndInit();
}

/// <summary>
/// Binds the Canvas.Top attached property of the content presenter to the top property of this object
/// </summary>
private void BindToParentContentPresenter()
{
    ContentPresenter cp = this.VisualParent as ContentPresenter;
    if (cp != null)
    {
        Binding b = new Binding();
        b.Source = this;
        b.Path = new PropertyPath(TopProperty);
        cp.SetBinding(SelectableUniformCanvas.TopProperty, b);
    }
} 
```

# asp.net-mvc - 编辑器模板

> ID：12251411
> 
> 赞同：1
> 
> 时间：2012-09-03T16:30:43.570
> 
> 标签：asp.net-mvc, telerik, grid, mvc-editor-templates

我不明白为什么在“EditorTemplates”中数据不可查看。尽管对于编辑所有工作都很好。

```
 @model site_NorvuzIS.ref_IppSpecialist.vIppJournalDTO

    @Html.DisplayFor(model => model.PersFio)
    @Html.Display("PersFio")

    <br/>

    @Html.EditorFor(model => model.PersFio)
    @Html.Editor("PersFio") 
```

# php - 如何从推进对象集合中通过“id”获取对象？

> ID：12251412
> 
> 赞同：9
> 
> 时间：2012-09-03T16:30:43.770
> 
> 标签：php, propel

我正在使用 Propel 1.6，但我不确定如何从 propel 对象集合中获取对象（给定其“id”属性值）。我在 Propel 的文档中找不到直接的答案（[PropelCollection 方法](http://www.propelorm.org/reference/model-criteria.html#propelcollection_methods)似乎不适用？）。例如：假设我有一个具有以下架构的“Person”表：

```
<table name="person">
  <column name="id" type="INTEGER" primaryKey="true" autoIncrement="true" required="true"/>
  <column name="name" type="VARCHAR" size="100" required="true"/>
</table> 
```

我执行以下查询以获取“Person”对象的集合：

```
$persons = PersonQuery::create()->find(); 
```

然后，我想找到一个具有给定“id”的“Person”对象（例如“id=3”的“Person”），**而不**需要对数据库进行新的查询。我该怎么做？

```
$persons->get(...?)? 
```

换句话说，我不想这样做：

```
$personX = PersonQuery::create()->findOneById(3); 
```

**语境：**

我想阻止进行数据库查询以提高性能。该语句将插入到 foreach 语句中，否则会导致大量数据库连接，如下所示：

```
foreach ($books as $book) {
    $book['author_name'] = PersonQuery::create()->findOneById($book['author_id'])->getName();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-25T20:04:20.100

另一种选择，特别是如果您需要多次搜索，是使用 $collection->getArrayCopy('Id') 按 id 获取对象数组。

```
$persons = PersonQuery::create()->find();
$personsById = $persons->getArrayCopy('Id'); 
```

然后你可以做

```
$person = $personsById[3]; 
```

或者

```
if (isset($personsById[3])) {
  $person = $personsById[3];
  ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T16:34:12.107

好吧，这不会很有效，但是您可以通过集合找到它。

```
$persons = PersonQuery::create()->find();
foreach ($persons as $person)
{
  if (3 == $person->getId())
  {
    break;
  }
}

// now you have your person with id = 3
var_dump($person->getId()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T08:12:49.050

由于 Propel 没有正确缓存查询结果，因此您需要迭代集合（如**@j0k**所说）。`foreach`您可以调用`array_filter`传递闭包而不是使用循环（使用 PHP 5.3）。

```
// Request the persons
$persons = PersonQuery::create()->find();

// Filter the persons whose ID equals 3
$filteredPersons = array_filter($persons, function ($person) {
    return 3 === $person->getId();
});

// Get the first result
$person = empty($filteredPersons) ? null : $filteredPersons[0]; 
```

如果您确定会找到此人，您还可以编写（使用 PHP 5.4）以下行：

```
// Filter the person whose ID equals 3
$person = array_filter($persons, function ($person) {
    return 3 === $person->getId();
})[0]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-26T09:41:06.720

如果你设置 Propel::isInstancePoolingEnabled() 为真（默认为真），那么你可以

```
// Request the persons
$persons = PersonQuery::create()->find();
// get person from pool
$person = PersonPeer::getInstanceFromPool(3); 
```

对不起我的英语。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-11T12:42:41.853

对于 user2663223 的答案，Propel >=1.5 的替代方案是：

```
$persons = PersonQuery::create()->find()

$person = PersonQuery::create()->findPk(3); 
```

这利用了实例池。它在内部使用：getInstanceFromPool，如果之前完成了 sql 查询。

欲了解更多信息，请咨询：

[http://propelorm.org/documentation/03-basic-crud.html#propel-instance-pool](http://propelorm.org/documentation/03-basic-crud.html#propel-instance-pool)

# c# - 使用 GROUP 和 SUM 的 LINQ 查询

> ID：12251413
> 
> 赞同：12
> 
> 时间：2012-09-03T16:30:46.500
> 
> 标签：c#, asp.net, sql, linq

请帮助我了解使用带有 GROUP 和 SUM 的 LINQ 进行查询。

```
// Query the database
IEnumerable<BestSeller> best_sellers = from bs in (db.MYDATABASE).Take(25)
                                       where bs.COMPANY == "MY COMPANY"
                                       group bs by bs.PRODCODE into g
                                       orderby g.Sum(g.MQTY)
                                       select new BestSeller()
                                       {
                                           product_code = ,
                                           product_description = ,
                                           total_quantity =  
                                      }; 
```

我希望：

*   从 db.MYDATABASE 中获取前 25 项
*   按 bs.PRODCODE 对所有结果进行分组
*   按每个 bs.PRODCODE 的总和排序
*   公司在哪里是“MY COMPANY”
*   然后将数据通过管道传输到我的`BestSeller()`对象

我很困惑，因为一旦我加入我`group`的组合，我的`bs`变量就变得无用了。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-03T16:34:05.397

> 我很困惑，因为一旦我将我的组添加到组合中，我的 bs 变量就变得无用了。

是的，因为您不再拥有单个项目 - 您现在正在处理一系列项目*组*。您可以获得每个组的第一项，我认为这是获取描述的有效方式？

```
var query =  from bs in db.MYDATABASE.Take(25)
             where bs.COMPANY == "MY COMPANY"
             group bs by bs.PRODCODE into g
             orderby g.Sum(x => x.MQTY)
             select new BestSeller
             {
                 product_code = g.Key,
                 product_description = g.First().DESCRIPTION,
                 total_quantity = g.Sum(x => x.MQTY) 
             }; 
```

请注意，如果不指定排序，“db.MYDATABASE 中的前 25 个项目”是没有意义的。“顶”以什么方式？您可能想要：

```
from bs in db.MYDATABASE.OrderByDescending(x => x.Price).Take(25) 
```

或类似的东西。请注意，如果这些公司都没有“MY COMPANY”公司，那么您最终将没有结果......

或者，如果您想要前 25 名畅销书，您希望最后的“参与”部分：

```
var query =  from bs in db.MYDATABASE
             where bs.COMPANY == "MY COMPANY"
             group bs by bs.PRODCODE into g
             orderby g.Sum(x => x.MQTY) descending
             select new BestSeller
             {
                 product_code = g.Key,
                 product_description = g.First().DESCRIPTION,
                 total_quantity = g.Sum(x => x.MQTY) 
             };
var top25 = query.Take(25); 
```

# java - Java：替代全局变量将值从方法传递到另一个

> ID：12251414
> 
> 赞同：0
> 
> 时间：2012-09-03T16:30:46.227
> 
> 标签：java, methods, parameter-passing

只是出于好奇！如果我有一个接受用户输入并将其存储为 int 变量的方法。有没有办法可以将这些方法传递给另一种方法？我知道返回值，但这只是（据我所知）一个数字、对象等......

最简单的方法当然是在这个方法中计算结果，但是是否有可能以某种方式传递这些整数：a，b。要另一种方法，而不使用全局变量？我只是想知道。

```
private void takeInput(int valueA, int valueB){
    println("Enter a number: (a) and (b), to calculate the Phytagoeran Theorem: (c)\n");
    int a = readInt("a:");
    println("you set the value of a to: "+a +"\n\nNext! set the value of b");
    int b = readInt("b:");
    println("you set the value of b to:"+b);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:42:58.937

您可以创建一个包含 2 个值的类：

```
public class PairOfInt {
    private final int a, b;

    public PairOfInt(int a, int b) {
       this.a = a;
       this.b = b;
    }

    //getters
}

private PairOfInt takeInput(){
    println("Enter a number: (a) and (b), to calculate the Phytagoeran Theorem: (c)\n");
    int a = readInt("a:");
    println("you set the value of a to: "+a +"\n\nNext! set the value of b");
    int b = readInt("b:");
    println("you set the value of b to:"+b);
    return new PairOfInt(a, b);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:08:05.763

这个问题不清楚，但我想知道你是否发明了“依赖注入”？

难题的第一部分是，是的，一个方法可以返回多个值，方法是将它们包装在一个对象中。

```
public class ValuePair {
    public int a;
    public int b;
}

public ValuePair takeInput(){
  ValuePair pair = new ValuePair();
  println("Enter a number: (a) and (b)\n");
  pair.a = readInt("a:");
  pair.b = readInt("b:");
  return pair;
} 
```

你可以这样做：

```
ValuePair p = takeInput();
System.out.println("Hypotenuse is " + calculateHypotenuse(p.a, p.b) + "\n"; 
```

（请注意，公共字段通常不被认为是好的样式 - 我在这里使用它们是因为代码更短。在实际代码中使用 getter 和 setter）。

* * *

这可能就是您需要的全部答案。但你问：

> 有没有办法可以将这些方法传递给另一种方法？

好吧，是的，如果您将该方法包装在专用于该目的的类中，则可以。出于我希望显而易见的原因，我们将首先定义一个接口。

```
 public interface ValuePairSource {
    public ValuePair getPair();
} 
```

...以及实现它的类：

```
public class UserInputValuePairSource implements ValuePairSource {
    @Override
    public ValuePair getPair() {
         ValuePair pair = new ValuePair();
         println("Enter a number: (a) and (b)\n");
         pair.a = readInt("a:");
         pair.b = readInt("b:");
         return pair;
    }
} 
```

现在您可以创建一个 Pythagoras 类，该类可以被告知从何处获取其值。

```
public class Pythagoras {
     private ValuePairSource valuePairSource;

     public Pythagoras(ValuePairSource source) {
         this.valuePairSource = source;
     }

     public double hypotenuse() {
         ValuePair pair = valuePairSource.getPair();
         return Math.sqrt(pair.a ^ 2 + pair.b ^ 2)
     }
} 
```

在构造函数中，我们告诉我们创建的每个毕达哥拉斯对象，如何获取一对值。所以我们可以这样使用它：

```
Pythagoras p = new Pythagoras(new UserInputValuePairSource());
double hypotenuse = p.hypotenuse(); 
```

这有什么用？嗯，这意味着我们可以发明其他类型的 ValuePairSource。例如，一个 ShapeValuePairSource，它从我们设置的 Shape 对象中获取值。

（这些是出于问题目的的假设类）

所以你可以像这样使用它：

```
Triangle t = canvas.getLastTriangle(); // or whatever
ValuePairSource vps = new ShapeValuePairSource(triangle);
Pythagoras p = new Pythagoras(vps);
double hypotenuse = p.hypotenuse(); 
```

因此，在完全不改变 Pythagoras 类的情况下，我们现在让它从形状对象中读取值，而不是用户输入。

好的，这是一个人为的例子，但它确实回答了“我可以将这些方法传递给另一个方法”的问题——这是 Spring 之类的基础。

请注意，某些语言允许您将方法直接传递给其他方法，而无需像我们在这里那样将它们包装在一个类中。这称为“函数式编程”，通常将“方法”称为“函数”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T16:36:34.403

您可以像这样声明另一个方法：

```
private void doSomething(int a, int b) {
  ...
} 
```

然后，从您的方法`takeInput`中，您可以调用它：

```
doSomething(a, b); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T16:48:04.933

您应该创建一个包含所有要操作的成员的类，并在同一个类中创建方法，这样您就不需要跨方法传递变量并且不需要依赖全局变量。

```
class MyOperations {

    private int valueA;
    private int valueB;

    public MyOperations (int valueA, int valueB) {
      this.valueA = valueA;
      this.valueB = valueB;
    }

    public void doOperationA(){
    //
    }

    public void doOperationB(){
    //
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T17:29:22.690

避免使用全局变量通常是个好主意。

传递多个返回值有两种主要方式：

1.  返回复合对象中的值
2.  将值放入作为参数传递的对象中

**第一种方法**涉及返回一个包含您要返回的所有值的对象。您可以使用已经可用的类，例如 Map 或 List：

```
public List readIntegersFromInput() {
      List l = new ArrayList();
      l.add(readInt("a: "));
      l.add(readInt("b: "));
      return l;
} 
```

...或者您可以专门为您的需要创建一个类：

```
public class ValuesAandB {
    public int a;
    public int b;
} 
```

...像这样使用：

```
public ValuesAandB readIntegersFromInput() {
      ValuesAandB ab = new ValuesAandB;
      ab.a = readInt("a: ");
      ab.b = (readInt("b: ");
      return ab;
} 
```

（在实际代码中，使用 setter 和 getter 而不是公共字段）

**第二种方法**涉及将*可变*对象作为参数传递。可变对象是其值可以更改的对象——就像我们刚刚创建的 ValuesAandB 类。

```
public void readIntegersFromInput(ValuesAandB ab) {
    ab.a = readInt("a: ");
    ab.b = (readInt("b: ");
} 
```

...你会这样称呼它：

```
ValuesAandB values = new ValuesAandB();
readIntegersFromInput(values);
// use `values` 
```

**那么哪个最好呢？**您将在生产代码中看到这两种样式。现在普遍认为，在大多数情况下，第一种风格更可取。

*制作不可变*的类实际上是一个好主意，即 ValuesAandB ，您可以在其中设置构造函数中的值，然后永远不允许更改它们。如果您需要不同的值，则必须创建一个新对象。您可以看到，对于不可变对象，第二种方式无法完成。它导致更容易理解的更简洁的代码。

# c# - 在Datagridview中分页而不使用dataadapter c#

> ID：12251416
> 
> 赞同：0
> 
> 时间：2012-09-03T16:30:59.360
> 
> 标签：c#

我想为我的 datagridview 添加分页选项。我有一个从 xml 文件中获取记录并将其绑定到 datagridview 的数据表。Xml 包含如此多的记录，这就是为什么我想在 C#win 表单的 datagridview 中添加分页选项的原因。请帮助我如何在不使用数据适配器的情况下完成此任务。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:35:21.293

手动翻页。使用相同的方案创建另一个`DataTable`，并在需要时将一页行复制到其中。

当然，这是一种选择。

# java - 使用 PowerMockito 模拟 getClass 方法

> ID：12251424
> 
> 赞同：7
> 
> 时间：2012-09-03T16:31:58.823
> 
> 标签：java, junit, mockito, powermock

我想避免模拟一个类的 getClass() 方法，但似乎找不到任何解决方法。我正在尝试测试一个将 HashMap 中的对象类类型存储到稍后使用的特定方法的类。一个简单的例子是：

```
public class ClassToTest {
    /** Map that will be populated with objects during constructor */
    private Map<Class<?>, Method> map = new HashMap<Class<?>, Method>();

    ClassToTest() {
        /* Loop through methods in ClassToTest and if they return a boolean and 
           take in an InterfaceA parameter then add them to map */
    }

    public void testMethod(InterfaceA obj) {
        final Method method = map.get(obj.getClass());
        boolean ok;
        if (method != null) {
             ok = (Boolean) method.invoke(this, obj);
        }
        if (ok) {
            obj.run();
        }
    }

    public boolean isSafeClassA(final ClassA obj) {
        // Work out if safe to run and then return true/false
    }

    public boolean isSafeClassB(final ClassB obj) {
       // Work out if safe to run and then return true/fals 
    }

}

public interface InterfaceA {
   void run()
}

public class ClassA implements InterfaceA {
   public void run() {
      // implements method here
   }
}

public class ClassB implements InterfaceA {
    public void run() {
       // implements method here
    }
} 
```

然后我有一个看起来有点像这样的 JUnit 测试：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({ClassA.class})
public class ClassToTestTest {
    private final ClassToTest tester = new ClassToTest();

    @Test
    public void test() {
        MockGateway.MOCK_GET_CLASS_METHOD = true;
        final ClassA classA = spy(new ClassA());
        doReturn(ClassA.class).when(classA).getClass();
        MockGateway.MOCK_GET_CLASS_METHOD = false;

        tester.testMethod(classA);
        verify(classA).run();
    }
} 
```

我的问题是虽然在 test() 方法 classA.getClass(); 将返回 ClassA，一旦进入测试人员的 testMethod() 方法，它仍会返回 ClassA$EnhancerByMockitoWithCGLIB$... 类，因此我的有用对象将始终为空。

有什么方法可以让我绕过模拟课堂，或者我需要做些什么来解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:27:16.360

你的问题实际上`getClass`是`final`在`Object`，所以你不能用 Mockito 存根它。我想不出解决这个问题的好方法。您可能会考虑一种可能性。

编写一个具有单个方法的实用程序类

```
public Class getClass(Object o){
    return o.getClass();
} 
```

并重构您正在测试的类，以便它使用此实用程序类的对象，而不是`getClass()`直接调用。然后，可以使用特殊的包私有构造函数或 setter 方法注入实用程序对象。

```
public class ClassToTest{
    private UtilityWithGetClass utility;
    private Map<Class<?>, Object> map = new HashMap<Class<?>, Object>();

    public ClassToTest() {
        this(new UtilityWithGetClass());
    }

    ClassToTest(UtilityWithGetClass utility){
        this.utility = utility;
        // Populate map here
    }

    // more stuff here
} 
```

现在，在您的测试中，模拟 object 和 stub `getClass`。将模拟注入您正在测试的类中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T23:31:48.287

哇，让这段代码可测试真是令人头疼。主要问题是您不能`key`在调用中使用模拟对象作为对象`map.get(obj.getClass())`，并且您正试图`invoke()`模拟对象以进行测试。我必须重构您的测试类，以便我们可以模拟功能/行为并能够验证其行为。

所以这是你的新实现，要使用成员变量进行测试，将各种功能解耦并由测试类注入

```
public class ClassToTest {

    MethodStore methodStore;
    MethodInvoker methodInvoker;
    ClassToInvoke classToInvoke;
    ObjectRunner objectRunner;  

    public void testMethod(InterfaceA obj) throws Exception {

        Method method = methodStore.getMethod(obj);

        boolean ok = false;

        if (method != null) {
            ok = methodInvoker.invoke(method, classToInvoke, obj);
        }

        if (ok) {
            objectRunner.run(obj);
        }   
    }

    public void setMethodStore(MethodStore methodStore) {
        this.methodStore = methodStore;
    }

    public void setMethodInvoker(MethodInvoker methodInvoker) {
        this.methodInvoker = methodInvoker;
    }

    public void setObjectRunner(ObjectRunner objectRunner) {
        this.objectRunner = objectRunner;
    }

    public void setClassToInvoke(ClassToInvoke classToInvoke) {
        this.classToInvoke = classToInvoke;
    }
} 
```

这是您不再需要 PowerMock 的测试类，因为它[不能模拟 Method 类](https://stackoverflow.com/questions/9011129/mocking-reflection-based-calls/9011651#9011651)。它只是返回一个 NullPointerException。

```
public class MyTest {

    @Test
    public void test() throws Exception {

        ClassToTest classToTest = new ClassToTest();

        ClassA inputA = new ClassA();

        // trying to use powermock here just returns a NullPointerException
//      final Method mockMethod = PowerMockito.mock(Method.class);
        Method mockMethod = (new ClassToInvoke()).getClass().getMethod("someMethod");   // a real Method instance

        // regular mockito for mocking behaviour    
        ClassToInvoke mockClassToInvoke = mock(ClassToInvoke.class);
        classToTest.setClassToInvoke(mockClassToInvoke);

        MethodStore mockMethodStore = mock(MethodStore.class);
        classToTest.setMethodStore(mockMethodStore);

        when(mockMethodStore.getMethod(inputA)).thenReturn(mockMethod);

        MethodInvoker mockMethodInvoker = mock(MethodInvoker.class);
        classToTest.setMethodInvoker(mockMethodInvoker);

        when(mockMethodInvoker.invoke(mockMethod,mockClassToInvoke, inputA)).thenReturn(Boolean.TRUE);

        ObjectRunner mockObjectRunner = mock(ObjectRunner.class);
        classToTest.setObjectRunner(mockObjectRunner);

        // execute test method      
        classToTest.testMethod(inputA);

        verify(mockObjectRunner).run(inputA);   
    }
} 
```

您需要的附加课程如下

```
public class ClassToInvoke {
    public void someMethod() {};
}

public class ClassA implements InterfaceA {

    @Override
    public void run() {
        // do something
    }
}

public class ClassToInvoke {
    public void someMethod() {};
}

public class MethodInvoker {

    public Boolean invoke(Method method, Object obj, InterfaceA a) throws Exception {
         return (Boolean) method.invoke(obj, a);
    }
}

public class MethodStore {

    Map<Class<?>, Method> map = new HashMap<Class<?>, Method>();

    public Method getMethod(InterfaceA obj) {
        return map.get(obj);
    }
} 
```

将所有这些放入您的 IDE 中，它会通过一个绿色条...哇哦！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T03:40:42.210

I've faced with similar question, too. I think you should add ClassToTest.class to @PrepareForTest, because you want to mock the getClass() function in that class

# delphi - 为什么加载方法被忽略？

> ID：12251431
> 
> 赞同：2
> 
> 时间：2012-09-03T16:32:42.893
> 
> 标签：delphi

我想知道为什么，但我不能简单地调试我的简单程序。加载的方法被忽略，它永远不会被执行。不知道为什么。看：

```
 TGridObj = class (TComponent)
private
  FPen1:TPen;
  FBrush1:TBrush;
  FChange:TNotifyEvent;

protected
  procedure Loaded; override;

public
  constructor Create(AOwner: TComponent); override;
  destructor Destroy; override;
published
  property OnChange:TNotifyEvent read FChange write FChange;

  property Pen1:TPen read FPen1 write FPen1;
  property Brush1:TBrush read FBrush1 write FBrush1;
end; 
```

. . .

```
constructor TGridObj.Create(AOwner: TComponent);
  begin
  inherited Create(AOwner);
  FPen1:=TPen.Create;
  FPen1.OnChange:=FChange;

  FBrush1:=TBrush.Create;
  FBrush1.OnChange:=FChange;
  end;

destructor TGridObj.destroy;
  begin
  FPen1.Free;
  FBrush1.Free;
  inherited;
  end;

procedure TGridObj.Loaded();
begin
  inherited Loaded;
  ShowMessage('');   // this is never executed;
  FPen1.OnChange:=FChange;
  FBrush1.OnChange:=FChange;
end; 
```

. .

```
procedure TForm1.FormCreate(Sender: TObject);
begin
Grid:=TGridObj.Create(nil);
Grid.OnChange:=ev1.OnChange;
Form1.InsertComponent(Grid);
end; 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T16:37:26.893

`Loaded`仅当组件的属性从表单文件流式传输时才调用。由于您是在运行时创建它，因此`Loaded`不会被调用。这是设计使然。

无论如何，您的代码都需要一些工作以允许`OnChange`在运行时修改事件并将该更改过滤到笔和画笔。我会这样做：

```
TGridObj = class (TComponent)
private
  FPen1: TPen;
  FBrush1: TBrush;
  FChange: TNotifyEvent;
  procedure DoChange(Sender: TObject);
public
  constructor Create(AOwner: TComponent); override;
  destructor Destroy; override;
published
  property OnChange: TNotifyEvent read FChange write FChange;
  property Pen1: TPen read FPen1;
  property Brush1: TBrush read FBrush1;
end;

constructor TGridObj.Create(AOwner: TComponent);
begin
  inherited;
  FPen1 := TPen.Create;
  FPen1.OnChange := DoChange;
  FBrush1 := TBrush.Create;
  FBrush1.OnChange := DoChange;
end;

destructor TGridObj.Destroy;
begin
  FBrush1.Free;
  FPen1.Free;
  inherited;
end;

procedure TGridObj.DoChange(Sender: TObject);
begin
  if Assigned(FChange) then
    FChange(Sender);
end; 
```

现在没有必要`Loaded`或类似的东西。因为您要等到`OnChange`pen 和 Brush 的事件真正触发后才能访问`FChange`.

顺便说一句，在您的代码中添加属性设置器`Pen1`并`Brush1`修改基础字段是错误的。这会导致泄漏和各种混乱。另外，请注意，将笔和画笔公开为公共属性允许客户端`TGridObj`更改`OnChange`事件。而那颠覆`TGridObj.OnChange`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:36:58.703

只有从表单资源（dfm 文件）加载组件时才会执行 OnLoaded。

如果组件在运行时仅在代码中创建，则不会执行。

更新：

我建议设计组件，以便它们也可以在运行时创建和配置——这意味着我避免覆盖 OnLoaded。优点是不需要包安装/组件注册。

# php - 如何保留下拉列表的文本并根据选择的值选择数据？

> ID：12251436
> 
> 赞同：1
> 
> 时间：2012-09-03T16:32:53.117
> 
> 标签：php, javascript, html

有一个下拉列表如下：

```
 <script language="JavaScript" type="text/javascript">
 <!--
 function showSelected()
 {
var selObj = document.getElementById('city');
var cityTextObj = document.getElementById('cityText');

var selIndex = selObj.selectedIndex;
cityTextObj.value = selObj.options[selIndex].text;
 }
 //-->
 </script>

 <form method="get"><font class="text5">City</font>
    <select id="city" onchange="showSelected();this.form.submit();" style="width:350px">
    <option value="0">Please select</option>
        <option value="1">NewYork</option>
        <option value="2">Canada</option>
        <option value="3">Delhi</option>
        <option value="4">HongKong</option>
    </select>
    <input type="hidden" id="cityText" name="cityText"/>

 </form> 
```

并选择数据库：

```
 <?php
 $sql = "SELECT * FROM general WHERE (day2sql >= now())";
 if(isset($_GET['cityText'])){
$city1 = mysql_real_escape_string($_GET['cityText']);
$sql .= " AND (gcity = '$city1')";  
 } 
```

此功能运行良好。问题是如果有人选择香港，表格会根据香港提交并显示内容。但我无法在下拉列表中保留香港文本。它会变成默认文本“请选择”

并且有 5 个链接，如“ALL”、“Today”、“Tomorrow”等……如果有人选择 HongKong。并单击这 5 个链接中的任何一个 想要根据 HongKong ALL、HongKong TODAY、HongKong TOMORROW 获取数据......就像所有城市一样......这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:57:39.020

```
 <option value="1" <?= $_GET['cityText'] == "NewYork" ? 'selected' : '' ?> >NewYork</option>
    <option value="2" <?= $_GET['cityText'] == "Canada" ? 'selected' : '' ?> >Canada</option>
    <option value="3" <?= $_GET['cityText'] == "Delhi" ? 'selected' : '' ?> >Delhi</option>
    <option value="4" <?= $_GET['cityText'] == "HongKong" ? 'selected' : '' ?> >HongKong</option> 
```

编辑：

对于 ALL/TODAY/TOMORROW，如果您在表单中将它们设为菜单或单选按钮会更容易。然后当表单提交时，PHP 可以执行相应的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:10:28.360

您需要对代码进行一些修改

```
<script language="JavaScript" type="text/javascript">
<!--
function showSelected(show)  //add parameter 'show' to keep value from user click
{
 var selObj = document.getElementById('city');
 var cityTextObj = document.getElementById('cityText');

 var selIndex = selObj.selectedIndex;
 cityTextObj.value = selObj.options[selIndex].text+"&show="+show;   //add variable 'show' to send
}
//-->
</script>

<form id="frm" method="get"><font class="text5">City</font>
  <select id="city" style="width:350px">
    <option value="0">Please select</option>
    <option value="1" <?php if($_GET["cityText"] == "NewYork") echo "selected"; ?> >NewYork</option>
    <option value="2" <?php if($_GET["cityText"] == "Canada") echo "selected"; ?> >Canada</option>
    <option value="3" <?php if($_GET["cityText"] == "Delhi") echo "selected"; ?> >Delhi</option>
    <option value="4" <?php if($_GET["cityText"] == "HongKong") echo "selected"; ?> >HongKong</option>
  </select>
</form>

<a href="#" onclick='showSelected("ALL");document.getElementById("frm").submit();'>ALL</a>
<a href="#" onclick='showSelected("TODAY");document.getElementById("frm").submit();'>TODAY</a>
<a href="#" onclick='showSelected("YESTERDAY");document.getElementById("frm").submit();'>YESTERDAY</a>
<a href="#" onclick='showSelected("TOMORROW");document.getElementById("frm").submit();'>TOMORROW</a> 
```

和你的 php 代码：

```
<?php
 $show = $_GET["show"]; //using $show you can set the query to ALL,TODAY, or etc
 $sql = "SELECT * FROM general WHERE (day2sql >= now())";
 if(isset($_GET['cityText'])){
$city1 = mysql_real_escape_string($_GET['cityText']);
$sql .= " AND (gcity = '$city1')";  
 } 
```

# java - 在android中实现Parcelable时出错

> ID：12251437
> 
> 赞同：1
> 
> 时间：2012-09-03T16:32:54.943
> 
> 标签：java, android, serialization, parcelable

以下类实现 Parcelable 类

```
package mobile.bh.classes;

import java.util.ArrayList;
import java.util.List;

import mobile.bh.activities.MethodStep;
import android.content.Context;
import android.graphics.Bitmap;
import android.os.Parcel;
import android.os.Parcelable;

//simple class that just has one member property as an example
public class Recipe implements Parcelable {
    public int id;
    public String name;
    public List<Ingredient> ingredients;
    public List<MethodStep> method;
    public String comment;
    public String image;
    public Bitmap image2;
    Context mContext;

    public Recipe(Context c){
        mContext = c;
    }
    /* everything below here is for implementing Parcelable */
    public int describeContents() {
        return 0;
    }

    // write your object's data to the passed-in Parcel
    public void writeToParcel(Parcel out, int flags) {
        out.writeInt(id);
        out.writeString(name);
        out.writeList(ingredients);
        out.writeList(method);
        out.writeString(comment);
        out.writeString(image);
    }

    // this is used to regenerate your object. All Parcelables must have a CREATOR that implements these two methods
    public static final Parcelable.Creator<Recipe> CREATOR = new Parcelable.Creator<Recipe>() {
        public Recipe createFromParcel(Parcel in) {
            return new Recipe(in);
        }

        public Recipe[] newArray(int size) {
            return new Recipe[size];
        }
    };
    // example constructor that takes a Parcel and gives you an object populated with it's values
    private Recipe(Parcel in) {
        id = in.readInt();
        name =in.readString();
        ingredients = (ArrayList<Ingredient>)in.readSerializable();
        method = (ArrayList<MethodStep>)in.readSerializable();
        comment = in.readString();
        image = in.readString();
    }
} 
```

但是当它读取时出现以下错误`name`：

```
09-03 16:15:35.364: E/AndroidRuntime(330): Caused by: java.lang.RuntimeException: Parcelable encountered IOException reading a Serializable object (name = )
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readSerializable(Parcel.java:2022)
09-03 16:15:35.364: E/AndroidRuntime(330):  at mobile.bh.classes.Recipe.<init>(Recipe.java:61)
09-03 16:15:35.364: E/AndroidRuntime(330):  at mobile.bh.classes.Recipe.<init>(Recipe.java:56)
09-03 16:15:35.364: E/AndroidRuntime(330):  at mobile.bh.classes.Recipe$1.createFromParcel(Recipe.java:48)
09-03 16:15:35.364: E/AndroidRuntime(330):  at mobile.bh.classes.Recipe$1.createFromParcel(Recipe.java:1)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readParcelable(Parcel.java:1981)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readValue(Parcel.java:1846)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readListInternal(Parcel.java:2092)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readArrayList(Parcel.java:1536)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readValue(Parcel.java:1867)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Parcel.readMapInternal(Parcel.java:2083)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Bundle.unparcel(Bundle.java:208)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.os.Bundle.getParcelableArrayList(Bundle.java:1144)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.content.Intent.getParcelableArrayListExtra(Intent.java:3448)
09-03 16:15:35.364: E/AndroidRuntime(330):  at mobile.bh.activities.RecipeInfoActivity.onCreate(RecipeInfoActivity.java:56)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-03 16:15:35.364: E/AndroidRuntime(330):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:42:01.730

当你使用

```
 out.writeList(ingredients);
    out.writeList(method); 
```

要将数据写入 Parcel，您应该使用

```
 ingredients = in.readList();
    method = in.readList(); 
```

阅读它。并不是`readSerializable()`

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:42:45.237

您应该使用“兼容”方法进行读写，因此在您的实现中使用而不是写入数据或使用`writeSerializable()`而不是。你现在混合它们会导致问题。`writeList()``writeToParcel()``readList()``readSerializable()`

# string - 格式化java类

> ID：12251439
> 
> 赞同：0
> 
> 时间：2012-09-03T16:33:11.043
> 
> 标签：string, class, formatting

我有一个字符串，其中包含 Java 类作为字符串。

例如

```
String class = "class MyClass{\n private int myInt;\n}"; 
```

如何将其格式化为缩进良好的“类字符串”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:44:11.737

为每个“{\n”添加一个缩进，并为每个“}”删除一个缩进。保留一个从 0 开始的大括号计数器。在第一个“{”之后，大括号 =1。在“}”之后它变成0。这样你就会得到这个

```
class MyClass {\n
<indent>private int myInt;\n
} 
```

对所有新行保持相同的缩进。

# sql - 在另一个表中存储一组标准

> ID：12251446
> 
> 赞同：1
> 
> 时间：2012-09-03T16:33:26.303
> 
> 标签：sql, sql-server, sql-server-2008, tsql, join

我有一个包含销售数据的大表，有用的数据如下：

```
RowID   Date        Customer  Salesperson   Product_Type    Manufacturer   Quantity   Value
1       01-06-2004  James     Ian           Taps            Tap Ltd        200        £850
2       02-06-2004  Apple     Fran          Hats            Hats Inc       30         £350
3       04-06-2004  James     Lawrence      Pencils         ABC Ltd        2000       £980
...
Many rows later...
...
185352  03-09-2012  Apple     Ian           Washers         Tap Ltd        600        £80 
```

我需要从包含不同类型值的表中计算出一大组目标，目标表在我的控制之下，到目前为止就像：

```
TargetID  Year   Month    Salesperson    Target_Type   Quantity
1         2012   7        Ian            1             6000
2         2012   8        James          2             2000
3         2012   9        Ian            2             6500 
```

目前我正在使用第一个表的视图来计算目标类型，该表有很多额外的列：

```
 SELECT YEAR(Date)
         , MONTH(Date)
         , Salesperson
         , Quantity
         , CASE WHEN Manufacturer IN ('Tap Ltd','Hats Inc') AND Product_Type = 'Hats' THEN True ELSE False END AS IsType1
         , CASE WHEN Manufacturer = 'Hats Inc' AND Product_Type IN ('Hats','Coats') THEN True ELSE False END AS IsType2
    ...
    ...
         , CASE WHEN Manufacturer IN ('Tap Ltd','Hats Inc') AND Product_Type = 'Hats' THEN True ELSE False END AS IsType24
         , CASE WHEN Manufacturer IN ('Tap Ltd','Hats Inc') AND Product_Type = 'Hats' THEN True ELSE False END AS IsType25
FROM SalesTable
WHERE [some stuff here] 
```

这很难阅读/调试，**我讨厌它**！

我尝试了几种不同的方法来简化它，但无法让它发挥作用。我最接近的是有第三个表来保存类型的定义，其中包含每个字段的值和类型号，这可以连接到表中给我完整的值，但我想不出办法处理每个字段的多个值。

**最后的问题：**

有没有一种标准的方法可以做到这一点，或者除了每种目标类型的一列之外，还有一种更简单/更整洁的方法吗？

我知道这是一个复杂的问题，所以如果有任何不清楚的地方，请告诉我。

**编辑 - 我需要得到什么：**

在流程的最后，我需要显示实际销售额的目标：

```
Type    Year    Month   Salesperson   TargetQty   ActualQty
2       2012    8       James         2000        2809
2       2012    9       Ian           6500        6251 
```

sales 表的每一行都可能满足 8 种类型。

还有几点：

1.  我有 5 个不同的列需要针对目标定义（或设置为 NULL 以包含任何值）
2.  我有 30 到 40 种不同类型需要定义，其中几列可能包含多达 10 个不同的值

对于第 2 点，如果我为每个值的排列使用一行，则每列有 10 个值的 2 列将为每个月的每个销售人员提供 100 行，但如果这是定义多个值的唯一方法，我将不得不这样做。

对不起，如果这没有意义！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:25:59.960

如果我认为目标表中的“Target_Type”字段基于制造商和 Product_Type 是正确的，那么您可以创建一个如下所示的 TargetType 表以及`JOIN`制造商和 Product_Type 以获取您的 Target_Type_Value：

```
ID   Product_Type    Manufacturer   Target_Type_Value
1    Taps            Tap Ltd        1
2    Hats            Hats Inc       2
3    Coats           Hats Inc       2
4    Hats            Caps Inc       3
5    Pencils         ABC Ltd        6 
```

这应该通过为每种可能性设置一行来解决“每个字段的多个值”问题。

# ember.js - Emberjs从文件模板？

> ID：12251451
> 
> 赞同：2
> 
> 时间：2012-09-03T16:33:50.700
> 
> 标签：ember.js, handlebars.js

如何从文件中获取模板 Handlebars，如下所示：

> App.ApplicationView = Ember.View.extend({templateName: 'templates/myTemplate1.handlebars'});

不是来自脚本：

> < script type="text/x-handlebars" data-template-name="myTemplate1">

**更新**

我将实现[Ember-Brunch](https://github.com/icholy/ember-brunch)车把模板预编译

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:08:46.337

如果您打算组装完成的应用程序，您可以使用 rake-pipeline 之类的东西。当然，这意味着您还需要在开发过程中使用 rake-pipeline。

如果你不想组装你的模板，你可以在你的应用程序中调用 Ember.TEMPLATES['templateName'] = Ember.Handlebars.compile('template content goes here')。然后，您可以将这些模板分离到不同的文件中，这些文件将包含在您的 index.html 文件中。

除此之外，我认为没有其他选择。您可以通过 AJAX 调用获取您的模板并将它们提供给 Ember.Handlebars.compile，但是您的模板可能在应用程序的生命周期中为时已晚。另一种选择是在交付您的 Ember 应用程序的服务器上即时生成此文件，但您很可能必须构建自己的解决方案。

有关使用 Ember.TEMPLATES[''] 选项的应用程序，请参阅以下内容：[https ://github.com/joachimhs/haagen-software.no/tree/master/app/](https://github.com/joachimhs/haagen-software.no/tree/master/app/)

有点麻烦，不过习惯就好了。。。

对于这种功能，确实没有太多好的选择，而且恐怕 Ember.js 也没有多少可以做的事情。.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T00:53:16.417

我相信 requirejs + require-handlebars-plugin 完全可以满足您的需求。您将不得不将您的 js 应用程序转换为使用 requirejs，但这应该不难。

*   有关 requirejs 的更多信息：[http: //requirejs.org/](http://requirejs.org/)
*   需要-handlebars-plugin：[https ://github.com/SlexAxton/require-handlebars-plugin](https://github.com/SlexAxton/require-handlebars-plugin)

# android - phonegap facebook 连接集成问题

> ID：12251452
> 
> 赞同：0
> 
> 时间：2012-09-03T16:33:53.303
> 
> 标签：android, facebook, cordova

我正在尝试通过 facebook 连接插件将我的 phonegap 应用程序与 facebook 集成。我按照[这里](http://marguspala.com/add-facebook-login-to-phonegap-android-app-easiest-way/)的说明进行操作，因为 git 对我不起作用，但我认为无论哪种方式我最终都会得到完全相同的设置。

当我在使用我的应用程序 ID 执行 FB.init() 后运行以下代码时，我收到一条警报，提示“Cordova Facebook Connect Plugin 在 auth.status 上失败”

```
console.log('Debug 1');
var params = {
    method: 'feed',
    name: 'Facebook Dialogs',
    link: 'https://developers.facebook.com/docs/reference/dialogs/',
    picture: 'http://fbrell.com/f8.jpg',
    caption: 'Reference Documentation',
    description: 'Dialogs provide a simple, consistent interface for applications to interface with users.'
  };
console.log(params);
FB.ui(params, function(obj) { console.log(obj);}); 
```

虽然 logcat 输出显示了这一点：

```
09-03 21:29:00.230: D/CordovaLog(21824): Error: Status=2 Message=Class not found
09-03 21:29:00.230: D/CordovaLog(21824): file:///android_asset/www/cordova-2.0.0.js: Line 938 : Error: Status=2 Message=Class not found
09-03 21:29:00.230: I/Web Console(21824): Error: Status=2 Message=Class not found at file:///android_asset/www/cordova-2.0.0.js:938 
```

我不知道这是我的应用程序的 Facebook 身份验证问题还是某些代码问题。我使用 keytool 生成了一个 Android Hash Key 并将其提交到 facebook 开发者页面。当我使用相同的密钥库在 Eclipse 中将我的 android 项目导出为 android 应用程序时，它不会显示我与 keytool 一起使用的别名（相同的密钥库）。所以我创建了一个具有相同别名和密码的新别名，然后在我的手机上安装了 apk。这里似乎有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:19:30.233

那么有很多问题。首先，最令人困惑的是以下行不是放在 plugins.xml 中，而是放在 config.xml 中。

```
<plugin name="com.phonegap.facebook.Connect" value="com.phonegap.facebook.ConnectPlugin" /> 
```

之后，我没有在 facebook 开发者页面输入正确的哈希键。由于您不想每次需要测试应用程序时都通过密钥库导出 apk，因此您应该只运行 eclipse 生成的调试 apk（运行方式 > Android 应用程序）并尝试 FB.login()。Facebook 会给你一个错误，你的密钥是“xxxxxx”，它与你的应用页面上列出的密钥不匹配。记下“xxxxxxx”并在 facebook 应用页面上输入。

其他是我自己的错误，没有按正确的顺序包含脚本。我没有仔细遵循这个例子。在为自己的应用程序编写代码之前，请确保先让 example/Simple/index.html 正常工作。希望能帮助到你...

# c++ - 离散傅里叶变换的实现 - FFT

> ID：12251453
> 
> 赞同：2
> 
> 时间：2012-09-03T16:33:53.913
> 
> 标签：c++, signal-processing, dft

我正在尝试做一个声音处理项目，需要将频率放入另一个域。现在，我尝试实现 FFT，但效果并不好。我试图理解`z`-transform，但也不太顺利。我阅读并发现 DFT 更容易理解，尤其是算法。所以我使用示例对算法进行了编码，但我不知道或认为输出是否正确。（我这里没有 Matlab，也找不到任何资源来测试它），想知道你们是否知道我的方向是否正确。到目前为止，这是我的代码：

```
#include <iostream>
#include <complex>
#include <vector>

using namespace std;

const double PI = 3.141592;

vector< complex<double> > DFT(vector< complex<double> >& theData)
{
// Define the Size of the read in vector
const int S = theData.size();

// Initalise new vector with size of S
vector< complex<double> > out(S, 0);
for(unsigned i=0; (i < S); i++)
{
    out[i] = complex<double>(0.0, 0.0);
    for(unsigned j=0; (j < S); j++)
    {
        out[i] += theData[j] * polar<double>(1.0, - 2 * PI * i * j / S);
    }
}

return out;
}

int main(int argc, char *argv[]) {

vector< complex<double> > numbers;

numbers.push_back(102023);
numbers.push_back(102023);
numbers.push_back(102023);
numbers.push_back(102023);

vector< complex<double> > testing = DFT(numbers);

for(unsigned i=0; (i < testing.size()); i++)
{
    cout << testing[i] << endl;

}
} 
```

输入是：

```
102023               102023

102023               102023 
```

结果：

```
(408092,       0)

(-0.0666812,  -0.0666812)

(1.30764e-07, -0.133362)

(0.200044,    -0.200043) 
```

任何帮助或建议都会很棒，我并不期待很多，但是，任何事情都会很棒。谢谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T16:50:22.793

@Phorce 就在这里。我认为没有任何理由重新发明轮子。但是，如果您想这样做以便理解该方法*并*享受自己编写代码的乐趣，我可以提供我几年前开发的 FORTRAN FFT 代码。当然这不是 C++，需要翻译；这应该不会太难，应该能让你学到很多东西......

下面是一个基于基数 4 的算法；这个 radix-4 FFT 递归地将一个 DFT 划分为四个四分之一长度的 DFT，每四个时间样本的组。这些较短的 FFT 的输出被重用于计算许多输出，从而大大降低了总计算成本。radix-4 频率抽取 FFT 将每四个输出样本分组为较短长度的 DFT，以节省计算量。radix-4 FFT 只需要 radix-2 FFT 的 75% 的复数乘法。请参阅[此处](http://cnx.org/content/m12027/latest/)了解更多信息。

```
!+ FILE: RADIX4.FOR
! ===================================================================
! Discription: Radix 4 is a descreet complex Fourier transform algorithim. It 
! is to be supplied with two real arrays, one for real parts of function
! one for imaginary parts: It can also unscramble transformed arrays.
! Usage: calling FASTF(XREAL,XIMAG,ISIZE,ITYPE,IFAULT); we supply the 
! following: 
!
! XREAL - array containing real parts of transform sequence    
! XIMAG - array containing imagianry parts of transformation sequence
! ISIZE - size of transform (ISIZE = 4*2*M)
! ITYPE - +1 forward transform
!         -1 reverse transform
! IFAULT - 1 if error
!        - 0 otherwise
! ===================================================================
!
! Forward transform computes:
!     X(k) = sum_{j=0}^{isize-1} x(j)*exp(-2ijk*pi/isize)
! Backward computes:
!     x(j) = (1/isize) sum_{k=0}^{isize-1} X(k)*exp(ijk*pi/isize)
!
! Forward followed by backwards will result in the origonal sequence!
!
! ===================================================================

      SUBROUTINE FASTF(XREAL,XIMAG,ISIZE,ITYPE,IFAULT)

      REAL*8 XREAL(*),XIMAG(*)
      INTEGER MAX2,II,IPOW

      PARAMETER (MAX2 = 20)

! Check for valid transform size upto 2**(max2):
      IFAULT = 1
      IF(ISIZE.LT.4) THEN
         print*,'FFT: Error: Data array < 4 - Too small!'
         return
      ENDIF
      II = 4
      IPOW = 2 

! Prepare mod 2:
 1    IF((II-ISIZE).NE.0) THEN 
         II = II*2
         IPOW = IPOW + 1       
         IF(IPOW.GT.MAX2) THEN
            print*,'FFT: Error: FFT1!'
            return
         ENDIF
         GOTO 1
      ENDIF

! Check for correct type:
      IF(IABS(ITYPE).NE.1) THEN
         print*,'FFT: Error: Wrong type of transformation!'
         return
      ENDIF

! No entry errors - continue:
      IFAULT = 0

! call FASTG to preform transformation:
      CALL FASTG(XREAL,XIMAG,ISIZE,ITYPE)

! Due to Radix 4 factorisation results are not in the same order
! after transformation as they were when the data was submitted:
! We now call SCRAM, to unscramble the reults:

      CALL SCRAM(XREAL,XIMAG,ISIZE,IPOW)

      return

      END

!-END: RADIX4.FOR

! ===============================================================
! Discription: This is the radix 4 complex descreet fast Fourier
! transform with out unscrabling. Suitable for convolutions or other
! applications that do not require unscrambling. Designed for use 
! with FASTF.FOR.
!
      SUBROUTINE FASTG(XREAL,XIMAG,N,ITYPE)

      INTEGER N,IFACA,IFCAB,LITLA
      INTEGER I0,I1,I2,I3

      REAL*8 XREAL(*),XIMAG(*),BCOS,BSIN,CW1,CW2,PI
      REAL*8 SW1,SW2,SW3,TEMPR,X1,X2,X3,XS0,XS1,XS2,XS3
      REAL*8 Y1,Y2,Y3,YS0,YS1,YS2,YS3,Z,ZATAN,ZFLOAT,ZSIN

      ZATAN(Z) = ATAN(Z)
      ZFLOAT(K) = FLOAT(K) ! Real equivalent of K.
      ZSIN(Z) = SIN(Z)

      PI = (4.0)*ZATAN(1.0)
      IFACA = N/4

! Forward transform:
      IF(ITYPE.GT.0) THEN
         GOTO 5
      ENDIF

! If this is for an inverse transform - conjugate the data:
      DO 4, K = 1,N
         XIMAG(K) = -XIMAG(K)
 4    CONTINUE

 5    IFCAB = IFACA*4

! Proform appropriate transformations:
      Z = PI/ZFLOAT(IFCAB)
      BCOS = -2.0*ZSIN(Z)**2
      BSIN = ZSIN(2.0*Z)
      CW1 = 1.0
      SW1 = 0.0

! This is the main body of radix 4 calculations:
      DO 10, LITLA = 1,IFACA
         DO 8, I0 = LITLA,N,IFCAB

            I1 = I0 + IFACA
            I2 = I1 + IFACA
            I3 = I2 + IFACA
            XS0 = XREAL(I0) + XREAL(I2)
            XS1 = XREAL(I0) - XREAL(I2)
            YS0 = XIMAG(I0) + XIMAG(I2)
            YS1 = XIMAG(I0) - XIMAG(I2)
            XS2 = XREAL(I1) + XREAL(I3)
            XS3 = XREAL(I1) - XREAL(I3)
            YS2 = XIMAG(I1) + XIMAG(I3)
            YS3 = XIMAG(I1) - XIMAG(I3)

            XREAL(I0) = XS0 + XS2
            XIMAG(I0) = YS0 + YS2

            X1 = XS1 + YS3
            Y1 = YS1 - XS3
            X2 = XS0 - XS2
            Y2 = YS0 - YS2
            X3 = XS1 - YS3
            Y3 = YS1 + XS3

            IF(LITLA.GT.1) THEN
               GOTO 7
            ENDIF

            XREAL(I2) = X1
            XIMAG(I2) = Y1
            XREAL(I1) = X2
            XIMAG(I1) = Y2
            XREAL(I3) = X3
            XIMAG(I3) = Y3
            GOTO 8

! Now IF required - we multiply by twiddle factors:
 7          XREAL(I2) = X1*CW1 + Y1*SW1
            XIMAG(I2) = Y1*CW1 - X1*SW1
            XREAL(I1) = X2*CW2 + Y2*SW2
            XIMAG(I1) = Y2*CW2 - X2*SW2
            XREAL(I3) = X3*CW3 + Y3*SW3
            XIMAG(I3) = Y3*CW3 - X3*SW3
 8       CONTINUE
         IF(LITLA.EQ.IFACA) THEN
            GOTO 10
         ENDIF

! Calculate a new set of twiddle factors:
         Z = CW1*BCOS - SW1*BSIN + CW1
         SW1 = BCOS*SW1 + BSIN*CW1 + SW1
         TEMPR = 1.5 - 0.5*(Z*Z + SW1*SW1)
         CW1 = Z*TEMPR
         SW1 = SW1*TEMPR         
         CW2 = CW1*CW1 - SW1*SW1
         SW2 = 2.0*CW1*SW1
         CW3 = CW1*CW2 - SW1*SW2
         SW3 = CW1*SW2 + CW2*SW1
 10   CONTINUE
      IF(IFACA.LE.1) THEN 
         GOTO 14
      ENDIF

! Set up tranform split for next stage:
      IFACA = IFACA/4
      IF(IFACA.GT.0) THEN 
         GOTO 5
      ENDIF

! This is the calculation of a radix two-stage:
      DO 13, K = 1,N,2
         TEMPR = XREAL(K) + XREAL(K + 1)
         XREAL(K + 1) = XREAL(K) - XREAL(K + 1)
         XREAL(K) = TEMPR
         TEMPR = XIMAG(K) + XIMAG(K + 1)
         XIMAG(K + 1) = XIMAG(K) - XIMAG(K + 1)
         XIMAG(K) = TEMPR
 13   CONTINUE
 14   IF(ITYPE.GT.0) THEN
         GOTO 17
      ENDIF

! For the inverse case, cojugate and scale the transform:
      Z = 1.0/ZFLOAT(N)
      DO 16, K = 1,N
         XIMAG(K) = -XIMAG(K)*Z
         XREAL(K) = XREAL(K)*Z
 16   CONTINUE

 17   return

      END
! ----------------------------------------------------------
!-END of subroutine FASTG.FOR.
! ----------------------------------------------------------

!+ FILE: SCRAM.FOR
! ==========================================================
! Discription: Subroutine for unscrambiling FFT data:
! ==========================================================
      SUBROUTINE SCRAM(XREAL,XIMAG,N,IPOW)

      INTEGER L(19),II,J1,J2,J3,J4,J5,J6,J7,J8,J9,J10,J11,J12
      INTEGER J13,J14,J15,J16,J17,J18,J19,J20,ITOP,I
      REAL*8 XREAL(*),XIMAG(*),TEMPR

      EQUIVALENCE (L1,L(1)),(L2,L(2)),(L3,L(3)),(L4,L(4))
      EQUIVALENCE (L5,L(5)),(L6,L(6)),(L7,L(7)),(L8,L(8))
      EQUIVALENCE (L9,L(9)),(L10,L(10)),(L11,L(11)),(L12,L(12))
      EQUIVALENCE (L13,L(13)),(L14,L(14)),(L15,L(15)),(L16,L(16))
      EQUIVALENCE (L17,L(17)),(L18,L(18)),(L19,L(19))

      II = 1
      ITOP = 2**(IPOW - 1)
      I = 20 - IPOW
      DO 5, K = 1,I
         L(K) = II
 5    CONTINUE
      L0 = II 
      I = I + 1
      DO 6, K = I,19
         II = II*2
         L(K) = II
 6    CONTINUE
      II = 0
      DO 9, J1 = 1,L1,L0
        DO 9, J2 = J1,L2,L1
          DO 9, J3 = J2,L3,L2
            DO 9, J4 = J3,L4,L3
              DO 9, J5 = J4,L5,L4
                DO 9, J6 = J5,L6,L5
                  DO 9, J7 = J6,L7,L6
                    DO 9, J8 = J7,L8,L7
                      DO 9, J9 = J8,L9,L8
                        DO 9, J10 = J9,L10,L9
                          DO 9, J11 = J10,L11,L10
                            DO 9, J12 = J11,L12,L11
                              DO 9, J13 = J12,L13,L12
                                DO 9, J14 = J13,L14,L13
                                  DO 9, J15 = J14,L15,L14
                                    DO 9, J16 = J15,L16,L15
                                      DO 9, J17 = J16,L17,L16
                                        DO 9, J18 = J17,L18,L17
                                          DO 9, J19 = J18,L19,L18
                                             J20 = J19
                                             DO 9, I = 1,2
                                                II = II +1
                                                IF(II.GE.J20) THEN
                                                   GOTO 8
                                                ENDIF
! J20 is the bit reverse of II!
! Pairwise exchange:
                                                TEMPR = XREAL(II)
                                                XREAL(II) = XREAL(J20)
                                                XREAL(J20) = TEMPR
                                                TEMPR = XIMAG(II)
                                                XIMAG(II) = XIMAG(J20)
                                                XIMAG(J20) = TEMPR
 8                                              J20 = J20 + ITOP
 9    CONTINUE

      return

      END
! -------------------------------------------------------------------
!-END:
! ------------------------------------------------------------------- 
```

经历这些并理解它需要时间！我使用几年前发现的加州理工学院论文写了这篇文章，我恐怕不记得参考了。祝你好运。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T17:05:51.483

您的代码有效。我会为 PI 提供更多数字（ 3.1415926535898 ）。此外，您必须将 DFT 求和的输出除以 S，即 DFT 大小。

由于测试中的输入序列是恒定的，因此 DFT 输出应该只有一个非零系数。事实上，所有输出系数相对于第一个系数都非常小。

但是对于较大的输入长度，这不是实现 DFT 的有效方式。如果时间是一个问题，请查看[快速傅里叶变换](http://en.wikipedia.org/wiki/Fast_Fourier_transform)以获得更快的方法来计算 DFT。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T17:13:08.293

你的代码对我来说很合适。我不确定您对输出的期望是什么，但是，鉴于您的输入是一个常数值，常数的 DFT 是 bin 0 中的 DC 项，其余 bin 中为零（或您拥有的接近等价物） .

您可以尝试使用包含某种波形（如正弦波或方波）的较长序列来测试您的代码。但是，一般来说，您应该考虑在生产代码中使用类似 fftw 的东西。长期以来，它被许多人绞尽脑汁并高度优化。FFT 是针对特殊情况优化的 DFT（例如，长度为 2 的幂）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T17:02:45.133

您的代码看起来不错。`out[0]`应该代表输入波形的“DC”分量。在您的情况下，它是输入波形的 4 倍，因为您的归一化系数为 1。

其他系数应代表输入波形的幅度和相位。系数是镜像的，即 out[i] == out[Ni]。您可以使用以下代码对此进行测试：

```
double frequency = 1; /* use other values like 2, 3, 4 etc. */
for (int i = 0; i < 16; i++)
    numbers.push_back(sin((double)i / 16 * frequency * 2 * PI)); 
```

对于`frequency = 1`，这给出：

```
(6.53592e-07,0)
(6.53592e-07,-8)
(6.53592e-07,1.75661e-07)
(6.53591e-07,2.70728e-07)
(6.5359e-07,3.75466e-07)
(6.5359e-07,4.95006e-07)
(6.53588e-07,6.36767e-07)
(6.53587e-07,8.12183e-07)
(6.53584e-07,1.04006e-06)
(6.53581e-07,1.35364e-06)
(6.53576e-07,1.81691e-06)
(6.53568e-07,2.56792e-06)
(6.53553e-07,3.95615e-06)
(6.53519e-07,7.1238e-06)
(6.53402e-07,1.82855e-05)
(-8.30058e-05,7.99999) 
```

这对我来说似乎是正确的：直流可忽略不计，第一次谐波的幅度为 8，其他谐波的幅度可忽略不计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-18T07:44:24.693

MoonKnight 已经在 Fortran 中提供了*radix-4 Decimation In Frequency* Cooley-Tukey 方案。我在下面提供了Matlab 中 Cooley-Tukey*频率方案中的基数 2 抽取。*

代码是迭代的，考虑下图中的方案：

[![在此处输入图像描述](../Images/a212659f5a3aee7654a111eb87d6809b.png)](https://i.stack.imgur.com/ZJZJN.jpg)

递归方法也是可能的。

正如您将看到的，该实现还计算了执行的乘法和加法的数量，并将其与[FFT 的多少 FLOPS 中报告的理论计算进行比较？](https://stackoverflow.com/questions/40036629/how-many-flops-for-fft/42261160#42261160).

该代码显然比 Matlab 使用的高度优化的 FFTW 慢得多。

另请注意，旋转因子`omegaa^((2^(p - 1) * n))`可以离线计算，然后从查找表中恢复，但在下面的代码中跳过了这一点。

有关迭代*radix-2 时间抽取*Cooley-Tukey 方案的 Matlab 实现，请参阅[实现期权定价的快速傅里叶变换](https://stackoverflow.com/questions/10465079/implementing-a-fast-fourier-transform-for-option-pricing/42292490#42292490)。

```
% --- Radix-2 Decimation In Frequency - Iterative approach

clear all
close all
clc

N = 32;

x = randn(1, N);
xoriginal = x;
xhat = zeros(1, N);

numStages = log2(N);

omegaa = exp(-1i * 2 * pi / N);

mulCount = 0;
sumCount = 0;
tic
M = N / 2;
for p = 1 : numStages;
    for index = 0 : (N / (2^(p - 1))) : (N - 1);
        for n = 0 : M - 1;        
            a = x(n + index + 1) + x(n + index + M + 1);
            b = (x(n + index + 1) - x(n + index + M + 1)) .* omegaa^((2^(p - 1) * n));
            x(n + 1 + index) = a;
            x(n + M + 1 + index) = b;
            mulCount = mulCount + 4;
            sumCount = sumCount + 6;
        end;
    end;
    M = M / 2;
end
xhat = bitrevorder(x);
timeCooleyTukey = toc;

tic
xhatcheck = fft(xoriginal);
timeFFTW = toc;

rms = 100 * sqrt(sum(sum(abs(xhat - xhatcheck).^2)) / sum(sum(abs(xhat).^2)));

fprintf('Time Cooley-Tukey = %f; \t Time FFTW = %f\n\n', timeCooleyTukey, timeFFTW);
fprintf('Theoretical multiplications count \t = %i; \t Actual multiplications count \t = %i\n', ...
         2 * N * log2(N), mulCount);
fprintf('Theoretical additions count \t\t = %i; \t Actual additions count \t\t = %i\n\n', ...
         3 * N * log2(N), sumCount);
fprintf('Root mean square with FFTW implementation = %.10e\n', rms); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-13T09:05:10.297

您的代码对于获取 DFT 是正确的。

您正在测试的函数`(sin ((double) i / points * frequency * 2)`对应于幅度为 1、频率为 1 和采样频率 Fs = 所取点数的同步曲线。

使用获得的数据进行操作，我们有：

[![在此处输入图像描述](../Images/875a962d909d46eaf49f84a8c0359880.png)](https://i.stack.imgur.com/fHKna.png)

如您所见，DFT 系数关于位置系数 N / 2 是对称的，因此只有前 N / 2 提供信息。通过实部和虚部的模获得的幅度必须除以N并乘以2才能重建。系数的频率将是 Fs / N 乘以系数数的倍数。

如果我们引入两个正弦曲线，一个是频率 2 和幅度 1.3，另一个是频率 3 和幅度 1.7。

```
for (int i = 0; i < 16; i++)
{
    numbers.push_back(1.3 *sin((double)i / 16 * frequency1 * 2 * PI)+ 1.7 *
        sin((double)i / 16 * frequency2 * 2 * PI));
} 
```

得到的数据是：

[![在此处输入图像描述](../Images/875a962d909d46eaf49f84a8c0359880.png)](https://i.stack.imgur.com/fHKna.png)

祝你好运。

# facebook - 删除 Facebook 画布应用/页面中的广告

> ID：12251454
> 
> 赞同：0
> 
> 时间：2012-09-03T16:33:55.487
> 
> 标签：facebook, facebook-php-sdk, facebook-canvas

我正在创建一个 facebook 画布应用程序，我想知道是否可以管理显示在应用程序右侧的广告。

也许删除广告，或者选择可以显示的广告。

我正在使用 facebook php sdk 和 js sdk。我在文档中找不到任何有用的功能来做到这一点。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T10:03:39.530

**Facebook 不会通过应用程序直接或间接向任何人提供对其在任何区域的广告的控制权。**他们自己管理广告。

目前无法删除广告，也无法选择可以显示的广告。而且我认为将来他们不会为其他用户授予权限。画布页面已在 Facebook 上加载，因此我们无法将其删除。Facebook通过广告赚了很多钱。他们不允许任何人管理他们的广告。

# php - PHPExcel 内存问题 - 还有更多想法吗？

> ID：12251459
> 
> 赞同：2
> 
> 时间：2012-09-03T16:34:24.477
> 
> 标签：php, zend-framework

我正在尝试使用 Zend Framework 和 PHPExcel 编写 Excel2007 文件。我知道我可以增加 PHP 内存限制.. 但没有其他办法吗？

到目前为止，这是我的代码，它适用于 5000 行和 77 列，但我需要 12000 行 :-) 内存设置为 128MB

```
 $cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_sqlite;
    PHPExcel_Settings::setCacheStorageMethod($cacheMethod);

    $db = Zend_Db_Table_Abstract::getDefaultAdapter();
    $phpExcel = new PHPExcel();

    // set headers
    $select = $db->select();
    $select->from('IMPORT')->limit(1);
    $data = $select->query()->fetchAll();
    $columns = array_keys($data[0]);
    $phpExcel->setActiveSheetIndex(0);
    $colCNT = 1;

    foreach ($columns as $column) {
        $letter = Nc_Utils::getNameFromNumber($colCNT);
        $phpExcel->getActiveSheet()->SetCellValue($letter . '1', $column);
        $colCNT++;
    }

    unset($select);
    unset($data);

    $sql = 'SELECT * FROM IMPORT LIMIT 7000';
    $stmt = $db->query($sql);

    $rowCNT = 2;
    while($rows = $stmt->fetch()){
        $phpExcel->getActiveSheet()->fromArray($rows, null, 'A'.$rowCNT);
        $rowCNT++;
    }  

    unset($rowCNT);
    unset($select);
    unset($db);

    // MEMORY USAGE = 4 MB!

    $phpExcelWrite = new PHPExcel_Writer_Excel2007($phpExcel);
    $phpExcelWrite->setUseDiskCaching(true);
    $phpExcelWrite->save(str_replace('.php', '.xls', __FILE__)); 
```

> PHP 致命错误：第 102 行 /Applications/MAMP/htdocs/phpexcel/library/PHPExcel/Shared/XMLWriter.php 中允许的内存大小为 134217728 字节已用尽（尝试分配 13878925 字节）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:01:09.850

PHPExcel 网站[讨论](http://phpexcel.codeplex.com/discussions/242712?ProjectName=phpexcel)了减少内存消耗的可能方法：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-16T04:05:06.920

你试过[PHP_XLSXWriter](https://github.com/mk-j/PHP_XLSXWriter)吗？

它是 php 中一个简单、轻量级的 XLSX 编写器库。虽然不如 PHP_Excel 功能全面，但它旨在解决 PHP_Excel 数据导出经常面临的一些内存和 CPU 使用问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:11:05.967

我尝试使用`PhpExcel`但发现和你一样的问题。我已经尝试了所有减少内存消耗的建议（Klinky 在他的回答中发布的链接）但只得到了 25-30% 的改进。我什至考虑过创建 CSV 输出而不是 excel。

现在我正在使用 PEAR 的[Spreadsheet_Excel_Writer](http://pear.php.net/package/Spreadsheet_Excel_Writer/redirected)，它对我来说工作正常，数据量大致相同（11k 行 62 列），尽管生成文件需要相当长的时间。

它不如 强大`PhpExcel`，但是正如我在您的示例中看到的那样，您没有使用它来设置单元格样式和编写函数，对吗？

例子：

```
$workbook = new Spreadsheet_Excel_Writer();
$workbook->send($filename . '.xls');
$workbook->setVersion(8); // excel 8
// Create worksheet
$worksheet =& $workbook->addWorksheet('submissions');
$worksheet->setInputEncoding('UTF-8');
// Write some data on Sheet 1
$row = 0;
$worksheet->write($row, 0, 'Poster #ID');
$worksheet->write($row, 1, 'Surname');
$worksheet->write($row, 2, 'Firstname');
$worksheet->write($row, 3, 'Country');
$worksheet->write($row, 4, 'E-mail');
$worksheet->write($row, 5, 'All authors');
$worksheet->write($row, 6, 'Institutions');
$worksheet->write($row, 7, 'Abstract topic');
$worksheet->write($row, 8, 'Abstract title');
foreach ($records as $rec_id => $rec_data) {
    $row++;
    $worksheet->write($row, 0, 'P-' . $rec_data['id']);
    $worksheet->write($row, 1, $rec_data['submitter_surname']);
    $worksheet->write($row, 2, $rec_data['submitter_firstname']);
    $worksheet->write($row, 3, $rec_data['submitter_country']);
    $worksheet->write($row, 4, $rec_data['submitter_email']);
    $worksheet->write($row, 5, $rec_data['authors']);
    $worksheet->write($row, 6, $rec_data['institutions']);
    $worksheet->write($row, 7, $rec_data['abstract_topic']);
    $worksheet->write($row, 8, $rec_data['abstract_title']);
}
$workbook->close(); // output 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-20T16:58:17.473

我遇到了一些内存问题，更新到最新版本的 PHPExcel 提高了我的性能。

# excel - 在 Excel VBA 中将图表颜色设置为自动

> ID：12251465
> 
> 赞同：1
> 
> 时间：2012-09-03T16:35:10.690
> 
> 标签：excel, vba

我有一个宏，可以将堆叠条形图上的所有系列设置为具有相同的颜色，以及像这样的其他一些位：

```
Sub RefreshLabels()

    ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh

    Dim ch As Chart
    ActiveSheet.ChartObjects("ProjectChart").Activate
    Set ch = ActiveChart
    ch.SetElement (msoElementDataLabelCenter)

    Dim sc As SeriesCollection
    Set sc = ch.SeriesCollection

    Dim showLabel As Boolean
    If (Range("showLabels").Value = "Y") Then
        showLabel = True
    Else
        showLabel = False
    End If

    Dim sameColor As Boolean
    If (Range("sameColor").Value = "Y") Then
        sameColor = True
    Else
        sameColor = False

    End If

    Dim s As Series
    For Each s In sc

        If (sameColor = True) Then
            s.Border.Color = RGB(Range("rgb_r"), Range("rgb_g"), Range("rgb_b"))
            s.Interior.Color = RGB(Range("rgb_r"), Range("rgb_g"), Range("rgb_b"))
        Else
            'CODE HERE TO MAKE COLORS AUTOMATICALLY SELECTED FROM PALLETTE
        End If

        Set dl = s.DataLabels
        dl.ShowSeriesName = showLabel
        dl.ShowValue = False

    Next

End Sub 
```

但是，我需要将系列更改回默认堆叠条形图的选项，并自动将颜色选择为各种调色板。

如果您需要任何进一步的信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:24:23.537

好的，解决了这个问题。您可以在图表上调用一种方法来重置样式：

```
ActiveChart.ClearToMatchStyle 
```

希望对某人有所帮助！

# c# - 在服务器上上传文件时如何显示进度条？

> ID：12251467
> 
> 赞同：1
> 
> 时间：2012-09-03T16:35:14.180
> 
> 标签：c#, jquery, asp.net, progress-bar

我正在开发一个视频上传模块，它最终将所有用户上传的视频存储在 youtube 上（使用 youtube api）。

我想在用户单击上传按钮后立即显示进度条并继续显示直到视频上传。

我通常知道这是使用 .net 中的 ajax 工具包实现的，但由于我使用的是文件上传控件，因此它与 ajax 工具包不兼容。

请建议我如何实现这一目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:25:10.043

您无法显示文件上传的*实际*进度。但是您可以使用 javascript 显示隐藏的动画“加载”图像。它会在表单（连同文件）提交到服务器时显示。

html:

```
<img id="loading_img" style="Display: None" src="loading.gif" /> 
```

Javascript：

```
$('#Form1').submit(function() {
    $('#loading_img').show(); // Show image
    return true; // Proceed with postback
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:29:31.573

不久前，我需要准确地说，我首先搜索了一个 javascript 解决方案，但最终找到了一个 Flash 上传器。如果您通过`XMLHttpRequest`Javascript 中的 API 上传，某些浏览器（Chrome、Firefox）会报告上传状态，所以它肯定可以完成，但是这种方法（或者在我检查它的时候）不是跨浏览器。您可以查看[此示例](http://www.sitepoint.com/html5-javascript-file-upload-progress-bar/#fbid=bjshTEeV2HI)以及此[问答](https://stackoverflow.com/questions/76976/how-to-get-progress-from-xmlhttprequest)。

如果这不能跨浏览器工作，您可以使用现有的 Flash 文件上传器或使用 Flash 或 Silverlight 创建您自己的文件上传器。当然，这会使您的站点依赖于 Flash 或 Silverlight。 例如，[这是一个使用 Flash 的项目。](http://code.google.com/p/swfupload/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:49:57.883

最快的方法是购买 3rd 方控件，例如 Telerik Upload 控件可以做到这一点（无闪存）

[http://demos.telerik.com/aspnet-ajax/upload/examples/customizingraduploadui/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/upload/examples/customizingraduploadui/defaultcs.aspx)

# mongodb - MongoDB 总存储大小

> ID：12251474
> 
> 赞同：6
> 
> 时间：2012-09-03T16:35:59.763
> 
> 标签：mongodb

我有一个分片和复制的 MongoDB，有数千万条记录。我知道 Mongo 使用一些填充因子写入数据，以允许快速更新，而且我也知道要复制数据库 Mongo 应该存储需要一些（实际上是很多）空间的操作日志。即使有了这些知识，我也不知道如何在给定典型数据库记录大小的情况下估计 Mongo 所需的实际大小。到目前为止，每周维修之间的差异为 2 - 3 倍。

所以问题是：给定平均记录大小（以字节为单位），如何估计 MongoDB 所需的总存储大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:04:43.043

简短的回答是：你不能，而不是仅仅基于 avg。文档大小（至少不是以任何准确的方式）。

更详细地解释：

磁盘上所需的空间不仅仅是平均文档大小的函数。您创建的任何索引也需要空间。然后，如果您确实触发了这些移动，则需要空间（尽管有填充，这确实发生了） - 该空间被放置在一个列表中以供重复使用，但取决于您随后插入的数据，它可能会或可能不会重新使用该空间。

您还可以添加一个事实，即预分配意味着有时少数文档会在分配新数据文件时将您的磁盘空间利用率增加约 2GB。当然，如果有足够的数据，这本质上是一个舍入误差，但值得牢记。

假设使用模式一致，估计这种类型的数据与大小比率的唯一方法是随着时间的推移针对您的特定用例对其进行趋势分析，并跟踪磁盘空间使用情况与插入的数据（文档数量可能优于数据量）取决于文档大小的可变性）。

同样，如果您跟踪插入率、文档大小和从重新同步/修复中获得的空间。仅供参考 - 您可以从头开始重新同步辅助服务器以获得数据文件的“新”副本，而不是运行修复，这可以减少破坏性，并且根据您的设置使用更少的空间。

# java - ImageJ API：组合图像

> ID：12251475
> 
> 赞同：0
> 
> 时间：2012-09-03T16:36:01.977
> 
> 标签：java, imagej

使用 ImageJ api，我试图保存一个合成图像，由并排放置的几个图像组成。

我有加载 ImagePlus 对象并保存它们的代码。但我不知道如何将图像粘贴到另一个图像中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T12:41:48.750

我将问题解释为拍摄多张图像并将它们并排拼接在一起以形成一个大图像，其中图像可能具有不同的尺寸。以下不完整的代码是一种方法，应该可以帮助您入门。

```
public ImagePlus composeImages(ArrayList<ImagePlus> imageList){
    int sumWidth = 0;
    int maxHeight = 0;

    for(ImagePlus imp : imageList){
        sumWidth = sumWidth +imp.getWidth();
        if(imp.getHeight() > maxHeight)
            maxHeight = imp.getWidth();

    }

    ImagePlus impComposite = new ImagePlus();

    ImageProcessor ipComposite = new ShortProcessor(sumWidth, maxHeight);

    for(int i=0; i<sumWidth; i++){
        for(int j=0; j<sumWidth; j++){

            ipComposite.putPixelValue(i, j, figureOutThis);

        }
    }

    impComposite.setProcessor(ipComposite);
    return impComposite;

} 
```

您需要编写一个算法来找到`figureOutThis`要放入合成图像中`i`的像素值 ( ) `j`。如果所有图像都具有相同的宽度并且要多做一点工作，那将是非常微不足道的。快乐编码

编辑：我应该补充一点，我假设它们也是短图像（我使用医学灰度）。您可以为其他处理器修改它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-28T03:48:54.487

此代码组合/缝合图像网格：

它假设图像都是相同的尺寸。

```
 ImagePlus combine(List<List<ImagePlus>> imagesGrid) {
    checkArgument(
        !imagesGrid.isEmpty() && !imagesGrid.get(0).isEmpty(), "Expected grid to be non-empty");
    checkArgument(
        imagesGrid.stream().map(List::size).distinct().count() == 1,
        "Expected all rows in the grid to be of the same size");
    checkArgument(
        imagesGrid.stream().flatMap(List::stream).map(ImagePlus::getWidth).distinct().count() == 1,
        "Expected all images to have the same width");
    checkArgument(
        imagesGrid.stream().flatMap(List::stream).map(ImagePlus::getHeight).distinct().count() == 1,
        "Expected all images to have the same height");

    int rows = imagesGrid.size();
    int cols = imagesGrid.get(0).size();

    int singleWidth = imagesGrid.get(0).get(0).getWidth();
    int singleHeight = imagesGrid.get(0).get(0).getHeight();

    int combinedWidth = singleWidth * cols;
    int combinedHeight = singleHeight * rows;

    ImageProcessor processor = new ColorProcessor(combinedWidth, combinedHeight);

    for (int row = 0; row < rows; row++) {
      for (int col = 0; col < cols; col++) {
        ImagePlus image = imagesGrid.get(row).get(col);
        int offSetWidth = col * singleWidth;
        int offsetHeight = row * singleHeight;
        for (int w = 0; w < singleWidth; w++) {
          for (int h = 0; h < singleHeight; h++) {
            processor.putPixel(w + offSetWidth, h + offsetHeight, image.getPixel(w, h));
          }
        }
      }
    }

    ImagePlus combinedImage = new ImagePlus();
    combinedImage.setProcessor(processor);
    return combinedImage;
  } 
```

# python - 在 Pandas 中解析 POSIX 时间戳的惯用方法？

> ID：12251483
> 
> 赞同：7
> 
> 时间：2012-09-03T16:37:25.503
> 
> 标签：python, numpy, pandas

我有一个 csv 文件，其中的时间列以毫秒为单位表示 POSIX 时间戳。当我在 pandas 中读取它时，它正确地将其读取为 Int64，但我想将其转换为 DatetimeIndex。现在我首先将它转换为 datetime 对象，然后将其转换为 DatetimeIndex。

```
In [20]: df.time.head()

Out[20]: 
0    1283346000062
1    1283346000062
2    1283346000062
3    1283346000062
4    1283346000300
Name: time

In [21]: map(datetime.fromtimestamp, df.time.head()/1000.)
Out[21]: 
[datetime.datetime(2010, 9, 1, 9, 0, 0, 62000),
 datetime.datetime(2010, 9, 1, 9, 0, 0, 62000),
 datetime.datetime(2010, 9, 1, 9, 0, 0, 62000),
 datetime.datetime(2010, 9, 1, 9, 0, 0, 62000),
 datetime.datetime(2010, 9, 1, 9, 0, 0, 300000)]

In [22]: pandas.DatetimeIndex(map(datetime.fromtimestamp, df.time.head()/1000.))
Out[22]: 
<class 'pandas.tseries.index.DatetimeIndex'>
[2010-09-01 09:00:00.062000, ..., 2010-09-01 09:00:00.300000]
Length: 5, Freq: None, Timezone: None 
```

有没有一种惯用的方式来做到这一点？更重要的是，这是在 pandas 中存储非唯一时间图的推荐方式吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T19:13:02.733

您可以将转换器与 read_csv 结合使用。

```
In [423]: d = """\
timestamp data
1283346000062 a
1283346000062 b
1283346000062 c
1283346000062 d
1283346000300 e
"""

In [424]: fromtimestamp = lambda x:datetime.fromtimestamp(int(x) / 1000.)

In [425]: df = pandas.read_csv(StringIO(d), sep='\s+', converters={'timestamp': fromtimestamp}).set_index('timestamp')

In [426]: df.index
Out[426]:
<class 'pandas.tseries.index.DatetimeIndex'>
[2010-09-01 15:00:00.062000, ..., 2010-09-01 15:00:00.300000]
Length: 5, Freq: None, Timezone: None

In [427]: df
Out[427]:
                           data
timestamp
2010-09-01 15:00:00.062000    a
2010-09-01 15:00:00.062000    b
2010-09-01 15:00:00.062000    c
2010-09-01 15:00:00.062000    d
2010-09-01 15:00:00.300000    e 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T19:37:20.413

在内部，时间戳存储在表示纳秒的 int 中。他们使用 numpy [datetime/timedelta](http://docs.scipy.org/doc/numpy/reference/arrays.datetime.html)。您的时间戳的问题在于它们的精度为毫秒，因为您除以 1000 时您已经知道这一点。在这种情况下，更容易输入 astype('M8[ms]')。它本质上是说将这些整数视为具有毫秒精度的日期时间整数。

```
In [21]: int_arr
Out[21]: 
array([1283346000062, 1283346000062, 1283346000062, 1283346000062,
       1283346000300])

In [22]: int_arr.astype('M8[ms]')
Out[22]: 
array(['2010-09-01T09:00:00.062-0400', '2010-09-01T09:00:00.062-0400',
       '2010-09-01T09:00:00.062-0400', '2010-09-01T09:00:00.062-0400',
       '2010-09-01T09:00:00.300-0400'], dtype='datetime64[ms]') 
```

Pandas 会假设任何常规的 int 数组都在 M8[ns] 中。将正确解释具有 datetime64 dtype 的数组。您可以通过访问它的`asi8`属性来查看 DatetimeIndex 的 M8[ns] 表示。

[编辑] 我意识到这不会直接帮助您使用 read_csv。只是想我会抛出如何在时间戳数组之间快速转换。

# python - Python：while循环的语法无效

> ID：12251485
> 
> 赞同：-5
> 
> 时间：2012-09-03T16:37:28.420
> 
> 标签：python

我是在 mac 上使用 python 2.5.4 的初学者 python 用户。在过去的几天里，我一直在尝试在 python 中创建游戏股票代码（仅限文本），我几乎完成了，但我在 while 循环中收到“语法错误：无效语法”。这是给我带来问题的代码部分，错误发生在第 5 行，我得到一个 ^ 指向 while 的 e。（我会发布整个内容，但超过 300 行）

```
while (keep_going ==0):
            sell_var = int(raw_input('Please choose what you would like to sell, for grain enter 1, for technology enter 2, for ore enter 3, for construction enter 4, for bonds enter 5, and for trade enter 6, to skip enter any other key'))
            if sell_var == 1:
                temp_sell = int(raw_input('How many grain stock would you like to sell?')
                while (temp_sell > playgrain[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playgrain[x] = playgrain[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[1] * temp_sell
            if sell_var == 1:
                temp_sell = int(raw_input('How many technology stock would you like to sell?')
                while (temp_sell > playertech[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playtech[x] = playtech[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[2] * temp_sell
            if sell_var == 1:
                temp_sell = int(raw_input('How many ore stock would you like to sell?)
                while (temp_sell > playore[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playore[x] = playore[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[3] * temp_sell
            if sell_var == 1:
                temp_sell = int(raw_input('How many construction would you like to sell?)
                while (temp_sell > playconst[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playconst[x] = playconst[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[4] * temp_sell
            if sell_var == 1:
                temp_sell = int(raw_input('How many bonds stocks would you like to sell?)
                while (temp_sell > playbonds[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playbonds[x] = playbonds[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[5] * temp_sell
            if sell_var == 1:
                temp_sell = int(raw_input('How many trade stock would you like to sell?)
                while (temp_sell > playtrade[x]):
                    temp_sell = int(raw_input('Please choose a different amount to sell, you do not have that many stock')
                playtrade[x] = playtrade[x]-temp_sell
                playmoney[x] = playmoney[x] + stock[6] * temp_sell 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:39:45.783

你错过了结束`")"`

```
int(raw_input('How many grain stock would you like to sell?')
                                                             ^ 
```

在许多地方，您可能需要返回并查看您的代码。

这应该是：

```
int(raw_input('How many grain stock would you like to sell?'))
                                                             ^ 
```

从代码着色中可以看出，您的某些字符串不会终止。例如，

```
temp_sell = int(raw_input('How many ore stock would you like to sell?)
                                                                     ^^ 
```

需要一个终止单引号，*并*关闭`")"`：

```
temp_sell = int(raw_input('How many ore stock would you like to sell?'))
                                                                     ^^ 
```

最小化/避免此类问题的一种方法是使用为您**匹配的编辑器**，即它会匹配括号，有时还会匹配引号。显然，**语法高亮/着色**是一个非常有用的工具，因为它显示了引号未关闭时（并且在某些语言中，多行注释未终止）。也值得检查这些领域的代码。

*顺便*说一句，有很多`if sell_var == 1:`一个接一个..这是故意的吗？在这种情况下，其中一个似乎就足够了。

最后，您可能想看看**[PEP8 - The Style Guide for Python](http://www.python.org/dev/peps/pep-0008/)**，它会在编写 Python 代码时提供有关格式、命名约定等方面的建议。例如，循环的主体缩进太多（尽管这可能只是在此处粘贴代码的产物）。例如，[PEP8 建议缩进 4 个空格](http://www.python.org/dev/peps/pep-0008/#indentation)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:39:57.923

```
 if sell_var == 1:
            temp_sell = int(raw_input('How many ore stock would you like to sell?) 
```

你忘了一个`'`和一个`)`。

# python - 如何通过 CherryPy 摘要认证获取用户名

> ID：12251490
> 
> 赞同：2
> 
> 时间：2012-09-03T16:37:46.580
> 
> 标签：python, http, authentication, cherrypy

我有一个 CherryPy 应用程序使用内置的摘要身份验证工具成功运行，并且没有会话支持。现在，我想向某些用户公开附加功能。是否可以从授权系统中获取当前认证的用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-08T08:19:46.667

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T00:07:30.557

找到 HTTP 请求头 Authorization 中编码的用户名。我可以从那里解析它。如果有一个“更好”的地方来获取用户名，我愿意改进！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T22:10:47.540

这个怎么样...

```
params  = auth_header.split(" ", 1)
items = parse_http_list(params)
paramsd = parse_keqv_list(items)
username = paramsd.get('username') 
```

[http://www.gitorious.org/forban/forban/blobs/1f9aff12551675f7cd8395f8bd0733cfc4c40784/lib/ext/cherrypy/lib/auth_digest.py](http://www.gitorious.org/forban/forban/blobs/1f9aff12551675f7cd8395f8bd0733cfc4c40784/lib/ext/cherrypy/lib/auth_digest.py)

当我更多地查看它时，这种方法仍然使用 auth 标头...

安德鲁

# android - 是否有任何 ETC1 纹理压缩库？

> ID：12251498
> 
> 赞同：2
> 
> 时间：2012-09-03T16:38:54.930
> 
> 标签：android, opengl-es, textures

我正在尝试将纹理（RGBA32）转换为 ETC1 格式，我需要在运行时发生这种情况。是否有任何 C/C++ 库可以完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:01:56.893

有[rg-etc1](http://code.google.com/p/rg-etc1/)库。您也可以从 Google Android 项目获取源代码 - 克隆此 GIT存储库 frameworks / [base.git](https://android.googlesource.com/platform/frameworks/base.git)并获取文件。`opengl/include/ETC1/etc1.h``opengl/libs/ETC1/etc1.cpp`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-03T16:43:29.700

FFmpeg 是正确的库..[链接](http://ffmpeg.org/)

# objective-c - 动画选取器 + 完成按钮 + 文本字段更新

> ID：12251500
> 
> 赞同：0
> 
> 时间：2012-09-03T16:39:02.807
> 
> 标签：objective-c, ios, uitextfield, uipickerview, uipicker

嗨，任何人都可以帮我解决这个问题，我一直在研究关于这个主题的很多以前的问题，它们似乎有点复杂。我想设置一个选择器，该选择器在触摸具有称为 locationField 的 IBOutlet 的文本字段时进行动画处理。

我不想在我的故事板中添加选择器或工具栏和按钮，我宁愿以编程方式进行。

到目前为止，我有：

```
- (void)viewDidLoad
{
 //populate picker arrays
 locationPickerArray = [[NSArray alloc] initWithObjects:@"1",@"2",@"3",@"4",@"5", nil];

    actionSheet = [[UIActionSheet alloc] initWithTitle:@"" delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil];

    [actionSheet showInView:self.view];

    UIToolbar *pickerToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0,480,32)];
    [pickerToolbar sizeToFit];
    pickerToolbar.barStyle = UIBarStyleBlackTranslucent;

    NSMutableArray *barItems = [[NSMutableArray alloc] init];

    UIBarButtonItem *cancelBtn = [[UIBarButtonItem alloc] initWithTitle:@"Cancel" style:UIBarButtonSystemItemCancel target:self action:@selector(cancel_clicked:)];
    [barItems addObject:cancelBtn];

    UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
    [barItems addObject:flexSpace];

    UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithTitle:@"Done" style:UIBarButtonItemStyleDone target:self action:@selector(done_clicked:)];

    [barItems addObject:doneBtn];
    [pickerToolbar setItems:barItems animated:YES];
    [actionSheet addSubview:pickerToolbar];

    UIPickerView *picker = [[UIPickerView alloc] init];
    picker.frame = CGRectMake(0, 44, 320, 216);
    picker.delegate  = self;
    picker.dataSource = self;
    picker.showsSelectionIndicator = YES;
    [actionSheet addSubview:picker];
}

-(void)done_clicked:(id)sender
{
    [actionSheet dismissWithClickedButtonIndex:0 animated:YES];
}

-(void)cancel_clicked:(id)sender
{
    [actionSheet dismissWithClickedButtonIndex:0 animated:YES];
} 
```

我对此有几个问题，它崩溃了：

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[DetailsS​​creenViewController numberOfComponentsInPickerView:]：无法识别的选择器发送到实例 0xb505be0”

这是什么意思？

我的最后一个问题是，当单击我之前创建的 iboutlet（位置字段）时，如何填充此选择器并将其分配给弹出窗口。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:27:27.697

崩溃的原因是您已将 of 的实例分配`DetailsScreenViewController`为 the`dataSource`和`delegate`of a `UIPickerView`，而没有实际实现这些协议的方法。任务在这里进行：

```
picker.delegate  = self;
picker.dataSource = self; 
```

具体的崩溃告诉你你还没有实现协议`numberOfComponentsInPickerView:`的一部分。`UIPickerViewDataSource`实际上，您应该已经收到关于此的编译器警告。学习使用这些警告真的很有帮助！无论如何，要修复它，请为两种协议上的所有必需方法提供实现。实现的细节将取决于您的应用程序的需求。如果您仍然需要有关详细信息的帮助，请告诉我。

关于你的第二个问题，我想现在把 a`UIPickerView`放在里面`UIActionSheet`是一件事情。我以前从来没有需要这样做，但是这里有一个[SO 问题](https://stackoverflow.com/questions/1262574/add-uipickerview-a-button-in-action-sheet-how)，其中包含许多背景示例代码，不确定您是否已经阅读过该问题。但我认为你只想等待你真正想要让选择器打电话的时间

```
[actionSheet showInView:self.view]; 
```

~~我认为您可以通过一种`UITextFieldDelegate`方法来做到这一点，可能还有其他方法。稍后我将尝试对此进行一些实验并更新此帖子。~~

**编辑：** 如果您将视图控制器指定为您感兴趣的任何文本字段的代表，那么您可以实现此`UITextFieldDelegate`方法：

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    [actionSheet showInView:self.view];
    return NO;
} 
```

**结束编辑**

希望这会有所帮助，如果您有任何问题，请告诉我。

# forms - Struts 2 - 生成的表单动作

> ID：12251503
> 
> 赞同：1
> 
> 时间：2012-09-03T16:39:21.743
> 
> 标签：forms, jsp, struts2

我使用以下代码使用 Struts 2 创建了一个表单：

```
<s:form id="form" onSubmit="getParameters();"> 
```

我不明白为什么生成的是以下内容：

```
<form id="form" name="form" action="/Projet/ListAction.action" method="post" onSubmit="return getParameters();"> 
```

这是我的 struts.xml

```
 <action name="ListBrochures" class="fr.web.actions.ListAction" method="execute">
    <result name="success">listAction.jsp</result>
  </action> 
```

为什么我有一个名为 ListAction.action 的操作。我的目标不是提交表单，而是发送 Ajax 请求。因此，由于在我的 Ajax 调用之前调用了这个动作，这给我的项目带来了麻烦。我只是希望 Struts 不会在我的表单中生成动作。我没有指定任何操作。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:09:59.403

如果您查看文档（参数`action`），如果您没有在`<s:form>`标签中设置任何操作，则 struts2 执行的操作将是当前操作。

*   [表单标签](http://struts.apache.org/2.3.4/docs/form.html)文档。

# java - Play2 - 模板 -> 递增

> ID：12251504
> 
> 赞同：4
> 
> 时间：2012-09-03T16:39:31.463
> 
> 标签：java, scala, templates, playframework, playframework-2.0

如何在 play2 中声明和增加变量？（在**.scala.html 模板**中）

伪代码：

```
@counter
@for(l <- list){
<span class="data-@counter">

</span>
@(counter += 1)
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-03T17:32:42.263

你真的需要计数器和递增吗？你可以这样做：

```
@for((l, index) <- list.zipWithIndex){
    <span class="data-@index">@l</span>     
} 
```

方法`zipWithIndex`创建元组列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-19T12:06:11.447

在模板中声明

```
@import java.math.BigInteger; var i=1 
```

用于模板中的增量

```
@(i+=1) 
```

# javascript - 子类化 JavaScript 数组会破坏快速枚举

> ID：12251509
> 
> 赞同：0
> 
> 时间：2012-09-03T16:40:07.270
> 
> 标签：javascript, oop, fast-enumeration

我以这种方式使用原型对 Array 进行子类化：

```
MyArray = function()
{
   Array.apply(this, arguments);
};

MyArray.prototype = new Array(); 
```

一切正常，我可以用这种方式初始化一个“MyArray”实例：

```
var arr = new MyArray();
arr.push(1, 2, 3); 
```

问题是 MyArray 实例的快速枚举被破坏了，实际上是以下循环：

```
for (var i in arr)
{
   console.log(i);
} 
```

打印：0、1、2、长度

在实践中，类的每个方法/属性都包含在枚举中。在普通数组中，代码只会打印 0、1、2（这些数字是数组的索引）。

所以...我的问题是：如何通过保留快速枚举来扩展 Array？

ps：在Objective C中，为了实现快速枚举，你必须重写一个方法……在JavaScript中有一个特殊的方法可以重写吗？

注：显然我对“MyArray”的真实实现略有不同，但我贴出的代码足以产生异常的快速枚举循环。不要问我为什么要扩展 Array，我有我的正当理由；）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:49:42.917

永远不应该枚举数组元素，`for (var x in obj)`因为它会迭代对象的可枚举属性，而不仅仅是数组元素，如您所见，数组元素可以包含除数组元素之外的东西。此外，这种迭代方法不能保证以任何给定的顺序返回属性，因此您的数组元素可能不是正确的顺序。

在最新的浏览器中，您可以使用[`Object.defineProperties()`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperties)创建属性并指定属性是否可枚举，但这并不意味着使用 枚举数组的元素是正确的`for (var x in obj)`。应该始终使用这种类型的形式来迭代数组元素：`for (var i = 0, len = arr.length; i < len; i++)`或内置的迭代器，如[`array.forEach(callback [, thisArg])`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach).

# visual-studio-lightswitch - Lightswitch 主题扩展 TabControlTabTextActiveBrush 被忽略

> ID：12251513
> 
> 赞同：0
> 
> 时间：2012-09-03T16:40:34.193
> 
> 标签：visual-studio-lightswitch

我的 Lightswitch 主题扩展中的 TabControlTabTextActiveBrush 设置被忽略。无论我提供什么值，TabControlTabTextBrush 的设置都将应用于所有选项卡。这是 Lightswitch 中的错误还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T00:48:42.590

是的，这是一个错误。我假设你在谈论 LS V1？不知道V2有没有修复。

# magento - 添加范围内产品的价格

> ID：12251520
> 
> 赞同：-1
> 
> 时间：2012-09-03T16:41:09.483
> 
> 标签：magento

我已经在 magento 上开设了一家运行良好的商店，但我的问题是我希望能够根据 wight 向客户收费。例如

如果有人选择 6 公斤，则应配置价格范围为 4-7 公斤，则每公斤价格为 2，因此总价格为 12 美元，或者如果有人输入 110.28 公斤，则应定义一个价格范围，说明如果重量是100-120 公斤，那么每公斤是 1.8 美元，因此总价是 110.28*1.8 美元

如果有办法magento可以处理请帮助我，这就是我正在寻找的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T03:21:11.387

Assuming you are selling your product in 1kg units then you should be able to use tier pricing to create the above pricing structure. Your tier prices would look like: qty = 4, price is $2 qty = 8, price is $y ... qty = 100, price is $1.8

If you are selling in partial units (e.g. 110.28 kg) then you will need a customisation to work with per kg pricing. I'd look at commercial extensions, I'm sure there will be some available.

# php - 如何在成功输入时使`return TRUE`

> ID：12251524
> 
> 赞同：0
> 
> 时间：2012-09-03T16:41:36.083
> 
> 标签：php, javascript, json

我有一个注册表单，它使用 JS 和 PHP 验证用户电子邮件，然后检查数据库以查看电子邮件是否存在。一切都发生在一个带有 JSON 的页面上。

我需要成功的结果`RETURN TRUE`并将我带到注册序列中的下一页。我试过`window.location`了`case: success`，它把我带到了正确的页面，但是它没有继承我表单中的隐藏字段。

有人可以告诉我应该如何执行吗？

```
$(document).ready(function(){
$('#newsletter-signup').submit(function(){

    //check the form is not currently submitting
    if($(this).data('formstatus') !== 'submitting'){

        //setup variables
        var form = $(this),
            formData = form.serialize(),
            formUrl = form.attr('action'),
            formMethod = form.attr('method'), 
            responseMsg = $('#signup-response');

        //add status data to form
        form.data('formstatus','submitting');

        //show response message - waiting
        responseMsg.hide()
                   .addClass('response-waiting')
                   .text('Please Wait...')
                   .fadeIn(200);

        //send data to server for validation
        $.ajax({
            url: formUrl,
            type: formMethod,
            data: formData,
            success:function(data){

                //setup variables
                var responseData = jQuery.parseJSON(data), 
                    klass = '';

                //response conditional
                switch(responseData.status){
                    case 'error':
                        klass = 'response-error';
                    break;
                    case 'success':
                        klass = 'response-success';
                        //return true; I tried this but it fails.
                    break;  
                }

                //show reponse message
                responseMsg.fadeOut(200,function(){
                    $(this).removeClass('response-waiting')
                           .addClass(klass)
                           .text(responseData.message)
                           .fadeIn(200,function(){
                               //set timeout to hide response message
                               setTimeout(function(){
                                   responseMsg.fadeOut(200,function(){
                                       $(this).removeClass(klass);
                                       form.data('formstatus','idle');
                                   });
                               },3000)
                            });
                });
            }
        });
    }

    //prevent form from submitting
    return false;
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:14:27.903

您能否不只是在成功时删除提交处理程序并让表单“真实”提交？

代替

```
//return true; I tried this but it fails. 
```

和

```
$('#newsletter-signup').unbind('submit').submit(); 
```

旁注：从成功回调中返回任何内容不会使表单“做”任何其他事情。当ajax函数完成时，该`return false;`语句已经被执行。您需要再次重新提交表单，这次不使用 ajax。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:20:16.697

将 asyncronous 选项设置为 false 并将结果 var 设置为 ajax 函数：

```
var result = false;

$.ajax(
{
    ...
    async: false,
    ...
    success: function(response)
    {
        ...
        ...
        result = true;
    }
});

return result; 
```

# java - 使用番石榴的期货可迭代？

> ID：12251528
> 
> 赞同：4
> 
> 时间：2012-09-03T16:42:06.533
> 
> 标签：java, guava, future

最近，我一直在与 Google Guava 和 ListenableFutures 进行广泛的合作，而我一直发现缺少的东西是一种提供未来完成的乱序流处理程序的方法。我所设想的是一个可迭代的，它在*next()*上阻塞，直到另一个未来返回。

在我努力创建自己的之前，是否已经存在一个？

如果没有，我的想法是利用 ListenableFuture 的回调功能将结果推送到 BlockingQueue。目标是在返回值返回后立即处理它们。`Futures.successfulAsList()`很棒，但在返回之前等待所有值，而不是让我安排其他有用的工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T19:27:03.387

您可以使用`java.util.concurrent.CompletionService`. 如果它没有 throw ，它的方法`take`可以很容易地被包裹到。`Iterator.next()``InterruptedException`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:52:36.440

我*认为*您可以使用[与.NET 相同的技巧`Task<T>`](http://msmvps.com/blogs/jon_skeet/archive/2012/01/16/eduasync-part-19-ordering-by-completion-ahead-of-time.aspx)：

*   创建一个新`List<SettableFuture<T>>`值 - 与输入期货相同的数字
*   为“到目前为止完成了多少期货”保留一个计数器
*   对于每个输入的期货，添加一个侦听器，以便当期货完成时，它会增加计数器并为列表中的相应项目设置该值（或错误）
*   将列表返回给调用者

现在是与输入序列相对应的期货序列，但按输入完成的顺序排列。然后调用者可以遍历列表，等待每个列表依次完成。

# r - 导入同名函数的包时创建包的最佳实践

> ID：12251530
> 
> 赞同：1
> 
> 时间：2012-09-03T16:42:15.907
> 
> 标签：r, roxygen, roxygen2, oai

我在[这里](https://github.com/ropensci/rmetadata)创建一个名为 rmetadata 的包。该软件包的目的是向学术出版物/元数据的许多数据源的[OAI-PMH服务提出请求。](http://www.openarchives.org/OAI/openarchivesprotocol.html)我编写了其他包（rpmc、rdatacite 等），它们的函数名称相同，以保持一致，因为它们在每个包中执行相同的操作，但针对不同的数据源。

关于安装 rmetadata

```
install_github('rmetadata', 'ropensci')
library(rmetadata) 
```

我收到很多警告，例如

```
Warning: replacing previous import 'identify' when loading 'rdryad'
Warning: replacing previous import 'listidentifiers' when loading 'rdryad'
Warning: replacing previous import 'listmetadataformats' when loading 'rdryad' 
```

我应该怎么办？我应该重命名 rmetadata 调用的每个包中的函数吗？例如，identify 在rdryad 中变为dryad_identify，并且identify 在rdatacite 中变为datacite_identify。

或者是其他东西？

# cordova - 显示启动画面，直到使用 phonegap 在 android 中加载应用程序

> ID：12251533
> 
> 赞同：1
> 
> 时间：2012-09-03T16:42:27.267
> 
> 标签：cordova

我想在应用程序加载到 Android 之前显示背景图像，这是我第一次从 web 服务下载，所以大约需要 10 秒。但是我会将这些数据保存在数据库中，所以下次重新启动应用程序时，我只想显示图像 2 秒。我怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:50:22.710

我认为我的博文解释得很好：

[http://simonmacdonald.blogspot.com/2012/04/phonegap-android-splashscreen-just-got.html](http://simonmacdonald.blogspot.com/2012/04/phonegap-android-splashscreen-just-got.html)

基本上你将超时设置为一个长值，然后当你希望它消失时从 javascript 端调用 navigator.splashscreen.hide() 。

# php - 执行存储在数据库中的 PHP 代码

> ID：12251537
> 
> 赞同：1
> 
> 时间：2012-09-03T16:43:16.987
> 
> 标签：php, mysql

我有两种存储页面的方法。第一个很简单；将其存储在一个文件中。第二个是将它存储在我遇到问题的数据库中。
整个“系统”基于一个“引擎”，该引擎通过将页面注入 HTML 模板来输出页面。简单地说：代码必须在到达引擎之前执行。希望这会对一些代码更有意义。
page.class.php

```
...
// Page was found in the database
            $this->name = $pageVariables['name'];
            $this->requiredAuth = $pageVariables['requiredAuth'];
            if ($parsed) {
                ob_start();
                echo $pageVariables['content'];
                $this->contents = ob_get_clean();
                var_dump($this->contents);
            } else {
                $this->contents = $pageVariables['content'];
            }
...
// File exists on the system, load it
                $fileContents = file_get_contents($this->url);
                if ($parsed) {
                    ob_start();
                    include($this->url);
                    $this->contents = ob_get_clean();
var_dump($this-contents);
                    if (isset($pageName)) {
                        $this->name = $pageName;
                    }
                    if (isset($requiredAuth)) {
                        $this->requiredAuth = $requiredAuth;
                    }
                    if (isset($useEngine)) {
                        $this->useEngine = $useEngine;
                    }
                } else {
                    $this->contents = $fileContents;
                } 
```

在`if ($parsed) {...}`那里，因此可以出于编辑目的获取未解析的页面。
显然这是一个精简版，但我希望这足以说明问题。
如果我用代码加载页面

```
Hello World<br>
<?php echo 'Hello World'; ?> 
```

从数据库中我得到的输出是

```
Hello World<br>
<?php echo 'Hello World'; ?> 
```

但是，存储在文件中的相同代码输出

```
 Hello World
    Hello World 
```

我曾尝试使用 eval()，但这只会评估 PHP 代码，并且当我包含 HTML/PHP 混合时会失败。
也许有更好的方法来解决这个问题（存储、执行等），但这是我目前看到的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:44:30.433

您可以使用[PHP 的 eval](http://php.net/manual/en/function.eval.php)来运行存储在数据库中的代码。

```
$code = get_code_from_db();
eval($code); // will evaluate (run) code stored in $code variable 
```

不过要小心。`eval`是一个需要小心对待的函数。如果您不考虑存储代码的含义，它可能是错误、安全漏洞的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:47:58.667

小心 eval，[这是一篇关于为什么的好帖子](https://stackoverflow.com/a/951868/1202214)。

更好的解决方案是将页面模板存储在数据库中，然后在 PHP 中安全地解析它们。

# c++ - ifstream 在文件中获取错误的字符串

> ID：12251538
> 
> 赞同：1
> 
> 时间：2012-09-03T16:43:18.290
> 
> 标签：c++, fstream

代码如下：

### ****编码：****

```
`#include <iostream>
#include <fstream>

using namespace std;

int main(void)
{
    int id;
    char name[50];
    ifstream myfile("savingaccount.txt");  //open the file
    myfile >> id;

    myfile.getline(name , 255 , '\n');   //read name **second line of the file
    cout << id ;
    cout << "\n" << name << endl; //Error part : only print out partial name 
    return 0;
}` 
```

 **### **文件内容：**

1800567
Ho Rui Jang
21 马来西亚
女性 012-4998192 20 , Lorong 13 , Taman Patani Janam Melaka Sungai Dulong

### **问题 ：**

1.）我希望getline将名称读入char数组名称然后我可以打印出名称，事情不是得到全名，我只得到部分名称，为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:59:54.507

问题是`myfile >> id`不使用`\n`第一行末尾的换行符 ( )。因此，当您调用`getline`它时，它将从 ID 的末尾读取到该行的末尾，您将得到一个空字符串。如果您再次调用`getline`它实际上将返回名称。

```
std::string name; // By using std::getline() you can use std::string
                  // instead of a char array

myfile >> id;
std::getline(myfile, name); // this one will be empty
std::getline(myfile, name); // this one will contain the name 
```

我的建议是只使用`std::getline`所有行，如果一行包含一个数字，您可以使用[`std::stoi`](http://en.cppreference.com/w/cpp/string/basic_string/stol)（如果您的编译器支持 C++11）或[`boost::lexical_cast`](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_lexical_cast.html).**

# r - R ggplot2 世界地图。传说中的突破

> ID：12251542
> 
> 赞同：1
> 
> 时间：2012-09-03T16:43:38.353
> 
> 标签：r, map, ggplot2, legend

我正在尝试使用 R 中的 ggplot2 生成世界地图。它应该是基于国家/地区的热图。我正在处理的数据来自推特，我想显示推文的来源。有2个问题：

1.  综合数据

    ```
    map_data("world") 
    ```

    给我一张 20 年前的地图（苏联）。

    ```
    map_data("world2") 
    ```

    似乎损坏了。或者有一些订购问题，但我不知道如何解决。

[http://schloegl.net/supersambo/world2.pdf](http://schloegl.net/supersambo/world2.pdf)

1.  我想更改颜色中断，但不知道如何访问它。由于巴西是唯一一个易于阅读的国家，因此编辑休息时间并显示推文少于 1000 条的国家之间的差异非常重要。

[http://schloegl.net/supersambo/world.pdf](http://schloegl.net/supersambo/world.pdf)

这是我的代码

```
 WD <- getwd()
    if (!is.null(WD)) setwd(WD)

    library(maps)
    library(plyr)
    library(ggplot2)

    twitter=read.csv("/Users/stephanschloegl/Studium/Diplomarbeit/rawData/c_userInfo/c_userInfo.csv",header=TRUE,check.names=FALSE,sep=";")

    #read geodata
    cities=read.csv("GeoWorldMap/cities.txt",header=TRUE,check.names=FALSE,sep=",")
    countries=read.csv("GeoWorldMap/countries.txt",header=TRUE,check.names=FALSE,sep=",")

    #find countries for twitter$timezone
    lista <- twitter$time_zone
    country_ids <- cities$CountryID[match(lista,cities$City)]
    country <- countries$Country[match(country_ids,countries$CountryId)]

    #FREQENCIES
    frequencies <- as.data.frame(table(country))
    names(frequencies) <- c("region","freq")
    #change 0's to NA
    frequencies$freq[frequencies$freq==0] <- NA

    #load world data
    world <- map_data("world2")
    #Delete Antarctica
    world <- subset(world,region!="Antarctica")

    #merge twitterdata and geodata
    world$tweets <- frequencies$freq[match(world$region,frequencies$region,nomatch=NA)]

    map <- qplot(long, lat, data = world, group = group,fill=tweets,geom ="polygon",ylab="",xlab="")
    #this does'nt work
    map + scale_colour_hue(name="Number of\nTweets",breaks=levels(c(10,20,100,200,1000)))
    map 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:07:34.467

那是因为`scale_colour_hue()`是针对离散尺度的。您必须使用`scale_fill_gradient()`，因为您想更改填充而不是轮廓。

```
 map + scale_fill_gradient(name="Number of\nTweets", trans = "log",
                           breaks = c(10, 20, 100, 200, 1000)) 
```

你去吧。您还在没有意义的休息时间设置了级别，推文的数量是数字。

![在此处输入图像描述](../Images/3b93119303973399b9b61fe428022ffb.png)

[您可以在此处](https://groups.google.com/forum/?fromgroups=#!topic/ggplot2/vnzkTX3huF0 "新世界地图")获取新地图并按照该帖子中的说明进行操作。

# jquery - （不）重用 jQuery 插件实例

> ID：12251543
> 
> 赞同：1
> 
> 时间：2012-09-03T16:43:49.090
> 
> 标签：jquery, jquery-plugins, twitter-bootstrap

在尝试将[这个](https://github.com/jbutz/bootstrap-lightbox/blob/master/bootstrap-lightbox.js "这")jquery lightbox 插件用于 Bootstrap（点击查看源代码）时，我偶然发现了一个关于 jQuery 插件如何工作的奇怪问题。

我有一个`div`灯箱的容器：

```
<div class="lightbox fade" id="demoLightbox" style="display: none;">
    <div class='lightbox-content'>
        <img src="image.png">
    </div>
</div> 
```

如果我：

1.  打开灯箱`$("#demoLightbox").lightbox()`
2.  关闭它`$("#demoLightbox").lightbox('hide')`
3.  通过AJAX改变图像
4.  要求重新打开一个 nre 灯箱`$("#demoLightbox").lightbox()`

然后出现第二个灯箱，但尺寸与第一个灯箱相同；它们没有根据新图像重新计算！

大小计算是在 Lightbox 类的构造函数中完成的，所以我认为这`$("#demoLightbox").lightbox()`会给我一个*新*实例并再次进行计算。不过好像我也有同款！发生了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T22:14:27.400

如果大小计算仅在构造函数中进行，那么最简单的做法是创建一个新实例，正如您所尝试的那样。但是，您首先需要删除旧实例：

```
$('#demoLightbox').removeData('lightbox'); 
```

如果你想要一个新的实例，那么

```
$('#demoLightbox').removeData('lightbox').lightbox(); 
```

* * *

# 更新：破坏性较小的选择

这个插件似乎有一些未记录的特性，其中一个可能对你想要完成的事情有用。即，选项中有一个名为**resizetofit**的标志。默认情况下，它设置为`false`。此标志用于使灯箱大小本身适合窗口大小。在调整大小的过程中，它将重新计算内容的尺寸。

将属性添加`data-resizetofit="true"`到启动链接的标记或`<div class="lightbox" >`应该触发每次调用该`show()`方法时重新计算内容。

**注意：**只有在`<img>`替换为全新的`<img>`. 仅仅更改`src`属性将失败，因为维度计算在第一次计算后被缓存到元素上。

# regex - 鉴于我已经实现了基本的正则表达式匹配器，如何实现词法分析器？

> ID：12251545
> 
> 赞同：5
> 
> 时间：2012-09-03T16:43:55.567
> 
> 标签：regex, algorithm, lexer

我正在尝试实现一个词法分析器来取乐。我已经实现了一个基本的正则表达式匹配器（首先将模式转换为 NFA，然后再转换为 DFA）。现在我对如何继续一无所知。

我的词法分析器将获取令牌列表及其相应的正则表达式。用于创建词法分析器的一般算法是什么？

我考虑过（OR）所有正则表达式，但后来我无法确定匹配哪个特定令牌。即使我扩展我的正则表达式模块以在匹配成功时返回匹配的模式，我如何在匹配器中实现前瞻？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:08:14.863

假设您有一个有效的正则表达式，`regex_match`它返回一个布尔值（如果字符串满足正则表达式则为真）。首先，您需要有一个有序的标记列表（每个都带有正则表达式）`tokens_regex`，顺序很重要，因为**顺序将规定优先级**。

一种算法可能是*（这不一定是唯一的）*：

1.  编写一个程序`next_token`，它接受一个字符串，并返回第一个标记、它的值和剩余的字符串（或者 - 如果是非法/忽略字符 - 无，有问题的字符和剩余的字符串）。*注意：这必须尊重优先级，并且应该找到最长的标记。*
2.  编写一个`lex`递归调用的过程`next_token`。

.

像这样的东西（用 Python 编写）：

```
tokens_regex = [ (TOKEN_NAME, TOKEN_REGEX),...] #order describes precedence

def next_token( remaining_string ):
    for t_name, t_regex in tokens_regex: # check over in order of precedence
        for i in xrange( len(remaining_string), 0, -1 ): #check longest possibilities first (there may be a more efficient method).
            if regex_match( remaining_string[:i], t_regex ):
                return t_name, remaining_string[:i], remaining_string[i:]
    return None, remaining_string[0], remaining_string[1:] #either an ignore or illegal character

def lex( string ):
    tokens_so_far = []
    remaining_string = string
    while len(remaining_string) > 0:
        t_name, t_value, string_remaining = next_token(remaining_string)
        if t_name is not None:
            tokens_so_far.append(t_name, t_value)
        #elif not regex_match(t_value,ignore_regex):
            #check against ignore regex, if not in it add to an error list/illegal characters
   return tokens_so_far 
```

添加一些东西来改进你的词法分析器：忽略正则表达式、错误列表和位置/行号（对于这些错误或标记）。

*玩得开心！祝你制作解析器好运:)。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:10:22.897

我做了几乎同样的事情。我这样做的方法是将所有表达式组合在一个非常大的 NFA 中，并将相同的东西转换为一个 DFA。这样做时，请跟踪每个相应的原始 DFA 中先前接受状态的状态及其优先级。

生成的 DFA 将有许多接受状态的状态。您运行此 DFA，直到它接收到一个没有相应转换的角色。如果 DFA 处于接受状态，那么您将查看您的哪些原始 NFA 具有该接受状态。具有最高优先级的是您要返回的令牌。

这不处理正则表达式前瞻。无论如何，这些通常并不是词法分析器工作真正需要的。那将是解析器的工作。

这种词法分析器的运行速度与单个正则表达式几乎相同，因为它基本上只有一个 DFA 可以运行。您可以完全省略 NFA 的转换，以获得更快构建但运行更慢的算法。算法基本相同。

我写的词法分析器的源代码[可以在 github 上免费获得](https://github.com/Dervall/Piglet)，如果你想看看我是怎么做到的。

# php - 一段时间后PHP重置会话

> ID：12251550
> 
> 赞同：3
> 
> 时间：2012-09-03T16:44:17.493
> 
> 标签：php, session, session-cookies, lamp

我知道这个问题已在 SO 中提出，我已经尝试了解决方案，但仍未解决。

PHP 在一段时间不活动后删除会话（我假设 24 分钟，因为它是默认设置并且似乎适合测试）。

我在所有页面中设置了以下代码：

```
ini_set('display_errors', 0);
$sessionCookieExpireTime = 2880000;
session_set_cookie_params($sessionCookieExpireTime);
ini_set('session.gc_maxlifetime', $sessionCookieExpireTime);

session_start();
echo ini_get('session.gc_maxlifetime'); //echos 2880000 as expected 
```

但会话在 24 分钟（左右）不活动后仍会重置。

phpinfo() 为会话返回以下输出： ![在此处输入图像描述](../Images/b33558a5a54f150e4ec96081fac9281a.png)

知道为什么这不起作用吗？(PHP 5.3.10)

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T02:14:09.630

尽管 Marc B answer 分享了一些很棒的见解，但它对我不起作用。我很确定我的脚本一切都很好，而且我的代码中的会话没有任何问题。

经过一场史诗般的斗争，我发现我的问题实际上是由于共享托管环境造成的。来自 PHP 文档：

> “如果不同的脚本......共享相同的位置来存储会话数据，那么具有最小值的脚本将 [确定会话超时]”。

在这之后，问题就很明显了。一些脚本（托管在同一台服务器上）正在使用默认的 php.ini session.gc_maxlifetime 并且正在重置我的会话。

解决方案是在我的主机根目录下创建一个文件夹（确保它不能通过网络访问），为其设置正确的权限，然后使用 session.save_path 告诉 php 在哪里存储我的会话。就像是：

```
ini_set("session.gc_maxlifetime","21600"); // 6 hours
ini_set("session.save_path", "/your_home/your_sessions/");
session_start(); 
```

该网站提供了很好的见解：[共享主机上的 php 会话](http://www.supernifty.com.au/blog/2008/04/19/php-sessions-on-shared-hosting-hack-3/)

因此，如果您遇到此问题，请确保您遵循 Marc B 的建议，如果这不起作用，请尝试一下。

最良好的祝愿！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T16:49:20.767

您是否在每个使用会话的脚本中都执行此代码？ini_set 更改**仅**适用于执行它们的脚本，并且仅适用于该特定脚本的执行生命周期。

如果你想让它成为一个永久的全局更改，你必须修改 php.ini，或者将一些 php_values 指令放入 http.conf/.htaccess。

# arduino - 通过 Wi-Fi shield 将 Arduino 数据发送到 LAN 上的特定 IP 地址

> ID：12251551
> 
> 赞同：7
> 
> 时间：2012-09-03T16:44:18.547
> 
> 标签：arduino

我正在尝试通过[Copperhead Wi-Fi 屏蔽从](http://www.robotshop.com/cuhead-wifi-shield-v2-0-arduino-3.html)[Arduino Uno](http://arduino.cc/en/Main/ArduinoBoardUno)将传感器数据发送到 LAN 上的特定 IP 地址和端口。

我可以让 Copperhead Wi-Fi 服务器示例[草图](http://www.arduino.cc/en/Tutorial/Sketch)工作（粘贴在下面）。但是，我对通过 HTML 响应服务器请求不感兴趣。我感兴趣的只是建立一个类似套接字的连接并通过 TCP 或 UDP 将数据发送到 IP 地址 192.168.0.3，端口 1234。

我确信有一个简单的解决方案，但由于我是 Arduino 新手，我试图找到解决方案的尝试没有成功。

```
#include <WiServer.h>
#define WIRELESS_MODE_INFRA 1
#define WIRELESS_MODE_ADHOC 2

// Wireless configuration parameters ----------------------------------------
unsigned char local_ip[] = {192,168,0,2};   // IP address of WiShield
unsigned char gateway_ip[] = {192,168,0,1}; // router or gateway IP address
unsigned char subnet_mask[] = {255,255,255,0};  // subnet mask for the local network
const prog_char ssid[] PROGMEM = {"WiFi_AP"};       // max 32 bytes

unsigned char security_type = 0;    // 0 - open; 1 - WEP; 2 - WPA; 3 - WPA2

// WPA/WPA2 passphrase
const prog_char security_passphrase[] PROGMEM = {"12345678"};   // max 64 characters

// WEP 128-bit keys
// sample HEX keys
prog_uchar wep_keys[] PROGMEM = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,     0x0a, 0x0b, 0x0c, 0x0d, // Key 0
              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // Key 1
              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // Key 2
              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  // Key 3
            };

// Setup the wireless mode
// Infrastructure - connect to AP
// Adhoc - connect to another Wi-Fi device
unsigned char wireless_mode = WIRELESS_MODE_INFRA;

unsigned char ssid_len;
unsigned char security_passphrase_len;
// End of wireless configuration parameters ----------------------------------------

// This is our page serving function that generates web pages
boolean sendMyPage(char* URL) {

    // Check if the requested URL matches "/"
    if (strcmp(URL, "/") == 0) {
        // Use WiServer's print and println functions to write out the page content
        WiServer.print("<html>");
        WiServer.print("Hello World");
        WiServer.print("</html>");

        // URL was recognized
        return true;
    }
    // URL not found
    return false;
}

void setup() {
    // Initialize WiServer and have it use the sendMyPage function to serve pages
    WiServer.init(sendMyPage);

    // Enable Serial output and ask WiServer to generate log messages (optional)
    Serial.begin(57600);
    WiServer.enableVerboseMode(true);
}

void loop(){
    // Run WiServer
    WiServer.server_task();

    delay(10);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T18:33:06.477

看起来你正在使用`WiShield`图书馆。下载中应该有一个示例文件夹，其中`WiShield`包含一个`SocketApp`和`UDPApp`示例。这是一个很好的起点。

我在制作 UDP 应用程序时学到了一些东西。

1.  在重新编译您的应用程序之前，您可能需要编辑一些#defines（*例如`APP_UDPAPP`in `apps-conf.h`、`UIP_CONF_UDP`in ）。`uip-conf.h`*

2.  如果您正在做一个`UDP`应用程序，请记住您的接收缓冲区有限（*`UIP_CONF_BUFFER_SIZE`将`uip-conf.h`其设置为**400***）。我的路由器发送了一个**大约 700 字节**的 UDP 广播 XML 消息，这导致该缓冲区溢出并覆盖了其他数据。我认为 TCP 不会有这个问题，因为它会协商一个不会超出缓冲区的 MSS。

`handle_connection()`最后，我对示例中的函数进行了更改`UDPapp`。下面是一个片段（*设置`uip_ipaddr`为`255.255.255.255`*）。

```
void send_state(void) {
    sprintf((char*)uip_appdata, "state %ld %ld %ld %c %d", 
    clock_time(), 
    state.sensors.ping[0].cm,
    state.sensors.ping[1].cm,
    state.actuators.chassis.direction,
    state.actuators.chassis.speed);
    uip_send(uip_appdata, strlen((char*)uip_appdata));
}

void send_beacon(void) {
    if(timer_expired(&beacon_timer)) {
        timer_reset(&beacon_timer);
        sprintf((char*)uip_appdata, "beacon %ld", clock_time());
        uip_send(uip_appdata, strlen((char*)uip_appdata));
        uip_log("beacon sent");
    }
}

boolean data_or_poll(void) {
    return (uip_newdata() || uip_poll());
}

static PT_THREAD(handle_connection(void)) {
    PT_BEGIN(&s.pt);
    PT_WAIT_UNTIL(&s.pt, data_or_poll());
    if(uip_newdata()) {
        uip_flags &= (~UIP_NEWDATA);
        send_state();
    } else if (uip_poll()) {
        uip_flags &= (~UIP_POLL);
        send_beacon();
    }

    PT_END(&s.pt);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:54:03.670

您是否有机会查看[Arduino WiFiWebClient 教程](http://arduino.cc/en/Tutorial/WiFiWebClient)？此示例显示如何连接到 Web 服务器并发送 HTTP GET 请求。

您可以在 LAN 上的任何机器上创建一个简单的服务器，并使用客户端库连接到服务器并使用 write/print/println 函数集发送数据。我知道说起来容易做起来难，但这就是编程的乐趣不是吗？

# iphone - 设置 Assetlibrary.framwork 时出错

> ID：12251553
> 
> 赞同：0
> 
> 时间：2012-09-03T16:44:25.050
> 
> 标签：iphone, xcode, map, assets

这是我的大问题。添加“Assetlibrary.Framwork”时，我的 mapView 运行时出现错误。如果我删除库，我的 mapView 就可以了。为什么？这是我的地图视图代码：（ps我正在使用情节提要）

```
.h
@property (strong, nonatomic) IBOutlet MKMapView *MapView;

.m
viewdidload:
MapView.delegate = self;
[self setLocationManager:[[CLLocationManager alloc] init]];
[locationManager setDelegate:self];
[locationManager setDistanceFilter:kCLDistanceFilterNone];
[locationManager setDesiredAccuracy:kCLLocationAccuracyHundredMeters];
[locationManager startUpdatingLocation];

- (void)locationManager:(CLLocationManager *)manager
didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
if ((oldLocation.coordinate.longitude != newLocation.coordinate.longitude)
    || (oldLocation.coordinate.latitude != newLocation.coordinate.latitude)) {

    coord.latitude = newLocation.coordinate.latitude;
    coord.longitude = newLocation.coordinate.longitude;

    region.center = coord;

    span.latitudeDelta = 0.05;
    span.longitudeDelta = 0.05;
    region.span = span;
} 
```

这是我的错误：

> 'NSUnknownKeyException'，原因：'[setValue:forUndefinedKey:]：此类不符合键 MapView 的键值编码。

我是否设置了两次地图视图？还是我做错了什么？

# xpath - xquery/xpath-如何获取特定类型的后代节点数

> ID：12251555
> 
> 赞同：1
> 
> 时间：2012-09-03T16:44:29.957
> 
> 标签：xpath, xquery

看看下面的示例 XML——

```
<div id="main">
    <div id="1">
        Some random text
    </div>
    <div id="2">
        Some random text
    </div>
    <div id="3">
        Some random text
    </div>
    <p> Some more random text</p>
    <div id="4">
        Some random text
    </div>
</div> 
```

现在，我如何使用 Xquery 找出主 div 中的 div 数量？以及如何在 XPath 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:48:29.953

您可以使用以下 XPath：

```
count(div[@id="main"]/div) 
```

该函数`count`进行计数，主要`div`由其选择`id`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T17:46:10.657

下面的 XPath 表达式可以在 XPath 和 XQuery 中使用。之所以如此，是因为 XPath (2.0) 是 XQuery 的一个真子集。

**使用**：

```
count(/*//div) 
```

如果“主 div”不是 XML 文档的顶部元素，并且这是唯一具有字符串值的属性`div`，请使用：`id``"main"`

```
count((//div[@id='main'])[1]//div) 
```

如果保证`div`“主 div”的孩子没有`div`后代，请使用：

```
count((//div[@id='main'])[1]/div) 
```

**请注意**：XPath 伪运算符`//`可能非常低效——这就是为什么总是尽量避免使用它，只要 XML 文档的结构是静态已知的并且可以使用特定的路径。

# java - REST PUT 响应格式

> ID：12251560
> 
> 赞同：0
> 
> 时间：2012-09-03T16:44:47.440
> 
> 标签：java, android, http, rest

我有一个带有 MySQL 数据库的 android 应用程序。在 android 平板电脑上输入的行需要在服务器上同步，也需要与 MySql 同步。一旦写入服务器，服务器唯一整数需要返回到平板电脑以更新本地数据库。这样，它将客户端 x-ref 到服务器。它目前通过对每一行执行 PUT 并在响应中使用服务器 ID 的位置来工作。但是，如果有大量更新，则需要很长时间才能插入，因为每一行都会打开一个新的 HttpConnection。我希望能够将更新分组到一个 XML 字符串中，并获得一个 XML 文件，其中包含每个客户端 ID 的 serverID 的 xreference。但是我找不到在响应中发送 XML 的方法，只有一个 URI。我的连接代码是

```
HttpParams httpParameters = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(httpParameters, Const.HTTP_CONNECTION_TIMEOUT);
HttpConnectionParams.setSoTimeout(httpParameters, Const.HTTP_SOCKET_TIMEOUT);
DefaultHttpClient client = new DefaultHttpClient(httpParameters);
client.getCredentialsProvider().setCredentials(AuthScope.ANY,new UsernamePasswordCredentials("xxxxx","xxxxx"));  // TODO Change to logged user name
HttpPut put = new HttpPut(uri);
StringEntity entity = new StringEntity(xml);
entity.setContentType("application/xml");
put.setEntity(entity);
HttpClientParams.setRedirecting(put.getParams(), false);
HttpResponse response = client.execute(put);
switch (response.getStatusLine().getStatusCode()){
case 200:
case 201:
    location = response.getLastHeader("Location").getValue();
    key = location.substring(location.lastIndexOf("/")+1);
    break;
case 401:
    throw new RuntimeException("Authorisation Failed");
default:
    throw new RuntimeException("Failed to Create Data Record on Server");
            } 
```

在服务器上

```
if (flight.getClientFlightId()!=0){
if (insertFlight(userId)){
    xref += "<clientId>"+flight.getClientFlightId()+"</clientId><serverId>"+flight.getServerFlightId()+"</serverId>";
    }
}
xref +="</xref>";
response = Response.created(URI.create(xref)).build(); 
```

请问有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:55:05.550

```
ArrayList<NameValuePair> putParams = new ArrayList<NameValuePair>();
putParams.add(new BasicNameValuePair("myXML", "<xml> _PUT_YOUR_XML_HERE_ </xml>"));
UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(putParams);
put.setEntity(formEntity); 
```

# oop - 从 Cinder 中的另一个类绘制到画布

> ID：12251561
> 
> 赞同：1
> 
> 时间：2012-09-03T16:44:50.667
> 
> 标签：oop, opengl, cinder

有没有一种方法可以使用 libcinder 进行绘制，而无需将所有代码放在主类的 draw() 方法上。我正在开发一个大型应用程序，将所有内容塞入一个文件中无论如何都不方便。

这是这个想法的一个例子：

```
class MyApp : public AppBasic {
  public:
    void setup ();
    void update ();
    void draw ();
  private:
    vector<MyObject> myObjects;
};

MyApp::draw () {
  for (int i = 0; i < myObjects.size(); ++i) {
    myObjects[i].render ();
  }
}

CINDER_APP_BASIC (MyApp, RendererGL)

/* ------------------ */

class MyObject {

  public:
    void render ();

};

void MyObject::render () {
  Rectf rect (0, 0, 20, 20);
  gl::drawSolidRoundedRect(rect, 15.0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T16:01:30.440

是的，有办法。实际上有几种方法。

1.  使用至少以下方法创建一个类`void setup()`：`void update()`和`void draw()`。然后，您可以在主应用程序中创建此类的实例，将它们存储在成员变量或`std::vector`. 然后只需分别从主应用程序的`setup`,`update`和`draw`方法中调用方法。
2.  使用 Cinder 的事件系统连接到它的`update`和`draw`事件。请参阅 ListenerBasic 示例：[https](https://github.com/cinder/Cinder/tree/master/samples/ListenerBasic) ://github.com/cinder/Cinder/tree/master/samples/ListenerBasic 。有关所有可用事件的列表，请参阅：[https](https://github.com/cinder/Cinder/blob/master/include/cinder/app/Window.h) ://github.com/cinder/Cinder/blob/master/include/cinder/app/Window.h 。
3.  编写或使用处理绘制所有对象的场景图系统。它将`draw()`以正确的顺序调用每个对象的方法，可以将对象放在其他对象之上，可以检测光标下的对象等等。一个著名的场景图是[http://www.openscenegraph.org/](http://www.openscenegraph.org/)，但它与 Cinder 不兼容。在我的一个示例中可以找到一个非常基本的场景图：[https ://github.com/paulhoux/Cinder-Samples/tree/master/SimpleSceneGraph](https://github.com/paulhoux/Cinder-Samples/tree/master/SimpleSceneGraph)

-保罗

# javascript - For Loop 从错误的数字开始

> ID：12251565
> 
> 赞同：0
> 
> 时间：2012-09-03T16:45:35.357
> 
> 标签：javascript, for-loop

出于某种原因，第二个`for`循环从 1 开始。我确实意识到第一个`for`循环`i`从 1 开始。本来就是这样。然而，即使`j` `for`循环说从 0 开始，它仍然从 1 开始。

```
var findWinners = function (playersRay) {
    var players = playersRay;
    var results = new Array();

    //getdealers dealers hand and info
    var dealerHand = players[0]
    var dealerScore = dealerHand.getScore()
    var dealerBust = dealerScore > 21 ? true : false;

    //loops through all players; skips dealer (array position 0)
    var numPlayers = players.length;
    for (var i=1; i<numPlayers; i++) {
            //loops through all the players hands.
            //player might have more than 1 hand if he splits his cards
        var player = players[i];
        var numHands = player.length;
        results[i] = new Array();

        for (var j=0; j<numHands; j++)
            var handScore = player[j].getScore();

            if (handScore > 21) {
                results[i][j] = false;              
            }
            else if (dealerScore > 21) {
                results[i][j] = true;
            }
            else if (handScore > dealerScore) {
                results[i][j] = true;
            }
            else {
                results[i][j] = false;
            }
    }
    return results;
} 
```

它返回这个：`[undefined, [undefined, true]]`

它应该返回这个：`[undefined, [true]]`

以防万一你想知道。一个示例`playersRay`是： `[Object, [Object]]`
*该对象具有关于庄家或玩家的二十一点手的信息。*

完整代码链接：[https ://docs.google.com/open?id=0BxvwY0fUFc3aMTdTOXU0b0ttamM](https://docs.google.com/open?id=0BxvwY0fUFc3aMTdTOXU0b0ttamM)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:28:52.130

在 Javascript 中，当您省略语句周围的花括号时，它只运行第一行。当我怀疑只有两个时，这种行为似乎只省略了第一个索引。因此，如果您添加更多进行迭代，您应该注意到它实际上只是在运行*最后一个*索引。

例如：

```
for (var i = 0; i < 10; i++)
    console.log('First line: ', i);

    console.log('Second line: ', i); 
```

[http://jsfiddle.net/MMQD8/](http://jsfiddle.net/MMQD8/)

给出：

```
First line: 0
First line: 1
First line: 2
First line: 3
First line: 4
First line: 5
First line: 6
First line: 7
First line: 8
First line: 9
Second line: 10 
```

MDN[是这样解释的](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)：

> **陈述**
> 
> 只要条件评估为真，就会执行的语句。要在循环中执行多个语句，请使用块语句 ({ ... }) 对这些语句进行分组。

# android - 如何在android中将自定义过滤器应用于相机流？

> ID：12251569
> 
> 赞同：2
> 
> 时间：2012-09-03T16:45:54.757
> 
> 标签：android, ios, opengl-es, android-ndk, android-camera

尝试编写一个相机应用程序，我可以在运行时应用自定义过滤器，目前 sdk 提供灰度、sephia 等内容，它就像设置参数一样简单。

但是，我需要对静止图像和视频应用我们自己的自定义过滤器（我将在其中编辑一些像素值），这无关紧要，因为概念是相同的。我设法在 iOS 中使用 来做到这一点`opengles`，我希望在 android 上也能做到这一点。

到目前为止，我们尝试的方法是使用 sdk 并逐帧应用简单的灰度滤镜，但是相机预览要慢得多（fps 低得多），因为它可能应该在较低级别的 ndk 或 opengles 上完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T21:38:11.870

OpenGL 在 Android 上功能齐全且速度快。您可能可以重用大部分 iOS 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:34:12.043

您正在寻找适用于 Android 的 OpenCV :)

[http://opencv.org/platforms/android.html](http://opencv.org/platforms/android.html)

如果您想进一步提高性能，您可以使用 NDK 编译您的 C/C++ 代码，使其在 Android 设备上运行。有很多关于如何使用 openCv 摄像头或 Android 原生摄像头进行图像/视频处理的示例。

# javafx-2 - JavaFX 2.x：在同一张图上绘制两种不同类型的图表

> ID：12251570
> 
> 赞同：4
> 
> 时间：2012-09-03T16:45:56.807
> 
> 标签：javafx-2, linechart, candlestick-chart

我有一个财务数据系列，我绘制为烛台图：我想将其他系列添加为 LineChart。

[来自 javafx 示例 - 示例 - Adv 烛台图](http://download.oracle.com/otndocs/products/javafx/2.2/samples/Ensemble/index.html)的示例显示了作为数据数组中最后一列的平均值添加的 LineChart。

我想知道是否有其他方法可以添加 LineCharts，因为我需要将其他 LineChart 系列添加到已经绘制的烛台图表中。

谢谢

# android - 访问listView多选中每个复选框的错误方法？

> ID：12251571
> 
> 赞同：0
> 
> 时间：2012-09-03T16:46:04.020
> 
> 标签：android, listview, checkbox, android-listview, parent-child

我有一个 listView 多选，每行列表都有一个复选框。我有一个 arrayList ，其中包含我想要在复选框上选中的列表位置。但有些事情是错误的，因为不工作......

这是我的代码
listViewSocios->ListView
alPositionsOnList -> 数组列表

```
 CheckBox checkedBox;
    for(int i = 0 ; i<SessaoQuotaEdit.alPositionsOnList.size() ; i++){
        checkedBox = (CheckBox)((View)listViewSocios.getChildAt((Integer) SessaoQuotaEdit.alPositionsOnList.get(i))).findViewById(android.R.id.checkbox);
        checkedBox.setChecked(true);
    } 
```

任何的想法？

在这一行给出一个错误

```
 checkedBox = (CheckBox)((View)listViewSocios.getChildAt((Integer) SessaoQuotaEdit.alPositionsOnList.get(i))).findViewById(android.R.id.checkbox); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:00:56.197

来自[Android Docs](http://developer.android.com/reference/android/widget/AbsListView.html#setItemChecked%28int,%20boolean%29)：`ListView`有这个方法`setItemChecked(int position, boolean value)`。

# firefox - 带有 Mozilla SDK 的导航栏中的位置工具栏按钮

> ID：12251574
> 
> 赞同：1
> 
> 时间：2012-09-03T16:46:24.067
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我最近使用 mozilla 的 SDK 开发了一个插件。但是当我测试它时，我发现插件图标在插件栏中。

我想在安装时将它移动到导航栏上。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:57:55.990

如果您使用此[工具](https://github.com/voldsoftware/toolbarbutton-jplib)栏按钮模块，则可以通过设置工具栏ID 来移动[按钮](https://github.com/voldsoftware/toolbarbutton-jplib/blob/master/docs/toolbarbutton.md)。

我认为目前无法移动小部件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T07:31:33.830

解决问题。[我在toolbarbutton](https://github.com/voldsoftware/toolbarbutton-jplib)中使用了部分代码。您只需要在 toolbarbutton.js 中替换第 73 行 `($("navigator-toolbox") || $("mail-toolbox")).palette.appendChild(tbb);`

通过此代码`window.document.getElementById('nav-bar').appendChild(tbb)`。

现在工具栏按钮放置在导航栏的右侧。

[在这里](https://builder.addons.mozilla.org/package/150870/latest/)您可以找到使用的代码示例。

# c++ - std::stack::push 和 std::stack:pop 线程安全吗？

> ID：12251578
> 
> 赞同：2
> 
> 时间：2012-09-03T16:47:01.980
> 
> 标签：c++, stl, thread-safety

**我是否需要使用互斥锁来保护我的`push()`和`pop()`调用，或者它们是内部线程安全的？**

我想写的代码是这样的

```
parallel for (int i = 0; i < 100; i++) {
    ...
    s.push(...);
    ...
} 
```

我不确定在哪里查看我正在使用的 STL 容器的线程安全性。我检查了[这个参考](http://www.sgi.com/tech/stl/stack.html)，但它没有提到任何关于线程安全的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:49:59.133

它们不是内部线程安全的。标准不要求从多个线程对容器和容器适配器的写入操作在这方面是安全的，因此您必须应用一些同步机制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T16:50:08.940

您可以希望从标准库中获得的唯一线程安全保证是您可以从不同的线程读取它们，并且您可以从不同的线程修改*不同的实例*（即：没有非线程安全的全局状态）。

任何从不同线程修改同一个对象的尝试都会以泪水告终。

# c# - 使用 linq 从多个 excel 表中读取数据到 excel (http://code.google.com/p/linqtoexcel/)

> ID：12251579
> 
> 赞同：2
> 
> 时间：2012-09-03T16:47:02.937
> 
> 标签：c#, linq, excel

我正在尝试从多表 excel 文件中读取数据。第一张表有列标题。第二张纸没有。第三个没有。我可以成功地阅读第一张纸。

当我尝试从没有标题的工作表中读取时，程序会出现异常。

```
var sheet1_data = from c in excel.Worksheet<Species>("Sheet1") select c; // This works and the question is how do i retreive data from sheet2? 
```

我目前正在使用这个：

```
var Sheet2_data = from b in excel.WorksheetNoHeader("sheet2") select b; 
```

当我尝试从 sheet2_data 读取数据时，出现以下异常：

> “sheet2”不是有效的工作表名称。有效的工作表名称为：'sheet2,sheet3',

任何帮助将不胜感激。

B.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-15T20:34:18.607

可以使用 GetWorksheetNames() 方法抽象工作表名称。

```
 var sheets = excel.GetWorksheetNames();
    foreach(var sheet in sheets)
    {
      var sheetData = from x in excel.Worksheet(sheet) select x;
    } 
```

# objective-c - 向 NavigationViewController 的后退按钮添加一些操作

> ID：12251581
> 
> 赞同：0
> 
> 时间：2012-09-03T16:47:04.150
> 
> 标签：objective-c, ios, uinavigationcontroller

我想强制我的 navigationViewController 的后退按钮调用 dissmissmodalViewController 以防止用户点击后退按钮快速并且应用程序向释放的实例发送消息......我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:30:16.830

您的问题感觉有点奇怪，因为后退按钮通常会执行以下操作：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

我不确定这会如何影响任何模态视图控制器。如果你真的需要改变它的功能，那么你基本上会隐藏内置的后退按钮并用你自己的自定义一种替换它：（把它放在 viewDidLoad 中）

```
[self.navigationItem setHidesBackButton:YES]; //hide the built in button

//create your new button
UIBarButtonItem *b = [[UIBarButtonItem alloc]initWithTitle:@"new-back-button" style:UIBarButtonItemStyleDone target:self action:@selector(customBackButton:)];

//set the new button
self.navigationItem.leftBarButtonItem = b; 
```

然后设置你的新方法来处理按钮按下

```
- (IBAction)customBackButton:(id)sender {
    [self.navigationController popViewControllerAnimated:YES]; 
} 
```

祝你的项目好运。

# .htaccess - htaccess RewriteCond，它会影响它下面的所有规则吗？

> ID：12251585
> 
> 赞同：0
> 
> 时间：2012-09-03T16:47:48.317
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, rewrite

我有一个看起来像这样的 htaccess：

```
RewriteCond %{HTTP_USER_AGENT} !^irefox+
RewriteRule ^(.*)/index.html?(.*)$ /handler.php?a=%{QUERY_STRING}&b=$2

RewriteCond %{HTTP_USER_AGENT} ^irefox+
RewriteRule ^(.*)/index.html?(.*)$ /handler.php?a=%{QUERY_STRING}&b=$2&c=firefox

RewriteRule ^tag/(.*)/$ /index.php?tag=$1
RewriteRule ^action/(.*)$ /index.php?action=$1 [L] 
```

RewriteCond 会只影响它下面的第一条规则，还是会影响最后两条？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T22:29:22.027

> RewriteCond 会只影响它下面的第一条规则，还是会影响最后两条？

`RewriteCond`只影响紧随其后的`RewriteRule`，所以

```
RewriteCond %{HTTP_USER_AGENT} !^irefox+ 
```

不会有任何影响

```
RewriteRule ^tag/(.*)/$ /index.php?tag=$1 
```

或者

```
RewriteRule ^action/(.*)$ /index.php?action=$1 [L] 
```

如果您希望也应用这些条件，请在规则上方重复它们。

# socket.io - Socket.io Construct2 中的几个房间

> ID：12251587
> 
> 赞同：0
> 
> 时间：2012-09-03T16:47:59.510
> 
> 标签：socket.io, construct-2

我目前正在 Construct2 中开发一款游戏。它是一个 HTML5 Javascript 引擎。我可能在里面实现了clay.io。

然而，我的问题是关于“房间”的 Clay.io 也对房间有帮助。但是我不确定我是否会接受这个提议。 [https://clay.io/docs/rooms](https://clay.io/docs/rooms)

因此，例如，当我想将每个游戏的用户限制为 10 时。然后我需要运行两台服务器吗？

socket.io 服务器接收并返回数据.. 但是每 10 人运行两个游戏不会混淆服务器数据吗？当服务器 A 上的人 A 射击 some1 时，这些信息可能会以某种方式最终出现在服务器 B 上的人 B 上？还是分配的 ID 以某种方式阻止了这种情况？

这是我想升级以满足我的需要的示例服务器：

```
 var entities = [], count = 0;
    var io = require("socket.io").listen(8099);

    var INITIAL_X = 5;
    var INITIAL_Y = 5;
    var INITIAL_VEL_X = 0;
    var INITIAL_VEL_Y = 0;

    io.set('log level', 1);
    io.sockets.on("connection", function (socket) {
        var myNumber = count++;
        //assign number    
        var mySelf = entities[myNumber] = [myNumber, INITIAL_X, INITIAL_Y, INITIAL_VEL_X, INITIAL_VEL_Y];

        //Send the initial position and ID to connecting player
    console.log(myNumber + ' sent: ' + 'I,' + mySelf[0] + ',' + mySelf[1] + ',' + mySelf[2]);
        socket.send('I,' + mySelf[0] + ',' + mySelf[1] + ',' + mySelf[2]);
        //Send to conencting client the current state of all the other players
        for (var entity_idx = 0; entity_idx < entities.length; entity_idx++) { 
//send initial update  
            if (entity_idx != myNumber) {
                entity = entities[entity_idx];
                if (typeof (entity) != "undefined" && entity != null) {

                console.log(myNumber + ' sent: C for ' + entity_idx);
                socket.send('C,' + entity[0] + ',' + entity[1] + ',' + entity[2]); 
//send the client that just connected the position of all the other clients 
            }
        }
    }
    //create new entity in all clients    
    socket.broadcast.emit("message",
        'C,' + mySelf[0] + ',' + mySelf[1] + ',' + mySelf[2]);
    socket.on("message", function (data) {

        //if (myNumber == 0)
        //    console.log(myNumber + ' sent: ' +data);
        var new_data = data.split(',');
        if (new_data[0] == 'UM') {
            mySelf[1] = new_data[1];
            mySelf[2] = new_data[2];
            mySelf[3] = new_data[3];
            mySelf[4] = new_data[4];
            //Update all the other clients about my update
            socket.broadcast.emit("message",
            'UM,' + mySelf[0] + ',' + mySelf[1] + ',' + mySelf[2] + ',' + mySelf[3] + ',' + mySelf[4]);
        }
        else if (new_data[0] == 'S') { // a s message
            var shoot_info = [];
            shoot_info[0] = new_data[1]; //ini x
            shoot_info[1] = new_data[2]; //ini y

            shoot_info[2] = new_data[3]; //degrees

            //Update all the other clients about my update
            socket.broadcast.emit("message",
            'S,' + mySelf[0] + ',' + shoot_info[0] + ',' + shoot_info[1] + ',' + shoot_info[2]);
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T06:35:39.580

Socket.io 有可以限制广播的房间，参见：[https ://github.com/LearnBoost/socket.io/wiki/Rooms](https://github.com/LearnBoost/socket.io/wiki/Rooms)

然后，而不是使用`socket.broadcast.emit`你会使用`io.sockets.in('roomname').emit`

将其与 Clay.io 网格化的一个好方法是将房间名称设为 room.id（在 Construct 2 插件中是 RoomId 表达式）。当 Clay.io 房间被填满时（在 C2 中有一个条件），使用该唯一 ID 创建 Socket.io 房间，并将刚刚调用“房间已满”的玩家放入该房间。

我知道这有点不同，因为它是用 CoffeeScript 而不是 Construct 2 编写的游戏，但我们在 Slime Volley 游戏中使用了 Clay.io 房间 + Socket.io 房间。[这是代码。](https://github.com/claydotio/Slime-Volley/tree/master/src)

# css - 轮廓打破边界半径

> ID：12251590
> 
> 赞同：0
> 
> 时间：2012-09-03T16:48:15.647
> 
> 标签：css, google-chrome

我试图在谷歌上四处寻找答案，但不幸的是没有任何运气。由于某种原因，以下 CSS 不显示边框半径：

```
 .mainContent
      {
          margin-right: auto;
          margin-left: auto;

          background: white;
          outline-color: black;
          outline-width: thin;
          outline-style: solid;
          border-radius: 5px;
          height: 100px;
          width: 500px;
     } 
```

如果我删除大纲块它工作得很好。有了轮廓，我只有带有轮廓但没有圆角的 DIV。我正在 Chrome (webkit) 中对此进行测试。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:56:13.200

为什么不使用

```
.mainContent
{
     margin: 0 auto;
     background: white;
     border: 1px solid #000;
     border-radius: 5px;
     height: 100px;
     width: 500px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:58:18.530

`border-radius`适用于`border`，而不是大纲！

这意味着您需要使用边框。轮廓并不是真正用于装饰用途，更多的是用于`:focus`状态和类似的东西。

如果您担心添加边框时宽度会增加，请使用：

```
* {
    -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
    -moz-box-sizing: border-box;    /* Firefox, other Gecko */
    box-sizing: border-box;         /* Opera/IE 8+ */
} 
```

让事情变得更有意义。oldIE 有一个 polyfill 可以让它在那里工作。

（阅读[http://paulirish.com/2012/box-sizing-border-box-ftw/](http://paulirish.com/2012/box-sizing-border-box-ftw/)了解更多信息）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:00:46.767

那将是`outline-radius`，但 CSS 中还没有这样的属性。

`:before`如果您需要两个不同颜色的弯曲边框，您可以嵌套元素或使用伪元素做一些 CSS 技巧：

```
div {
    border: 4px solid #000; 
    border-radius: 12px; 
    width: 100px; 
    height: 100px;
    margin: 10px;
}
div:before {
    width:100px;
    height:100px;
    content:'';
    display:block;
    border: 4px solid #aaa;
    margin: -8px 0 0 -8px;
    padding: 4px;
    border-radius: 16px;
} 
```

瞧！

![在此处输入图像描述](../Images/38063e3bc7ef39c2c0dcd6c34959c700.png) ​</p>

[http://jsfiddle.net/35Tjn/](http://jsfiddle.net/35Tjn/)

# android - 更改 iframe src 会中断 Android Phonegap 应用程序中的滚动

> ID：12251591
> 
> 赞同：1
> 
> 时间：2012-09-03T16:48:15.853
> 
> 标签：android, iframe, cordova

对于 android 中的 Phonegap 应用程序，我有一个有趣的错误。我首先注意到滚动在模拟器或某些特定设备上不起作用（它在我的手机上工作，至于平台 2.3）并尝试了每一个建议来解决这个问题，包括 SO 建议中的多个；1、原生端修复 2、添加iScroll库。然而，没有一个解决方案奏效。此外，不可用的滚动仅影响特定页面，而不影响整个应用程序。

我已将问题缩小到这行代码，它替换了 iframe 的 src 属性。它旨在显示通过外部内容 api 获取 url 的 youtube 视频的缩略图。

```
$('#video').attr('src', newUrl); 
```

和 iFrame 标记

```
<iframe class="youtube-player" id="video" type="text/html" src="js/views/loading.html" frameborder="0"></iframe> 
```

我已经尝试在标记中对 url 进行硬编码，并且效果很好，这是关于替换 iframe 源的行为会破坏页面滚动。

我正在唱 Phonegap/Cordova 1.8.1，最低目标 android 平台是 2.2

预先感谢您的任何帮助。

*编辑：似乎与视口有关，因为删除标签会阻止任何破坏滚动的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-02T16:00:12.580

我使用 PhoneGap 创建的 Android 应用程序也有类似的问题。我遇到的问题是，随着 iframe 中的数据发生变化，可滚动空间的数量也发生了变化，因此有些页面会滚动得太远，而有些则不够。

为了解决这个问题，您必须使用一些 JavaScript 在加载内容时根据其内容调整 iframe 的高度。

我从这个问题中找到了答案：[Phonegap HTML5 / Android App - Iframe height issue](https://stackoverflow.com/questions/11258951/phonegap-html5-android-app-iframe-height-issue)

该问题的答案建议使用 iframe 上的 onload 属性来调用 javascript 函数，该函数调整 iframe 的高度以匹配内容。

javascript 本身看起来像这样：其中 obj 是传递给函数的 iframe 元素。

```
function resizeIFrame(obj){
     obj.style.height = obj.contentWindow.document.body.offsetHeight + "px";
} 
```

现在，只要 iframe 的来源发生变化，它就会根据该内容调整高度，并且应该可以解决您的滚动问题。

# monitoring - 识别应用程序中的不良性能

> ID：12251593
> 
> 赞同：1
> 
> 时间：2012-09-03T16:48:23.927
> 
> 标签：monitoring, performance-testing, performance

我们正在构建一个高性能的 Web 应用程序。

不幸的是，有时性能会意外下降，我们希望能够对此进行监控，以便在问题发生时主动解决问题，而不是等待用户报告问题。

到目前为止，我们正在为服务器内存使用、CPU 使用等指标设置系统监视器，并收集数据库的统计信息。

虽然这些显示了系统的整体健康状况，但当某个特定用户的会话速度很慢时，它们对我们没有帮助。我们在 C# 应用程序中实现了跟踪，这在识别数据是罪魁祸首的问题时特别有用，但出于性能原因，跟踪将默认关闭，仅在尝试修复问题时启用。

所以我的问题是我们应该考虑是否有其他最佳实践（例如 WMI）？我们是否应该考虑在我们的 Web 应用程序中构建其他任何东西，这将使我们受益，而本身不会成为性能负担？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:56:13.527

这在很大程度上取决于您的应用程序，但我总是建议将您的应用程序指标添加到您的监控中。例如最近上传图片的数量，并发用户的数量 - 我想你明白了。结合内存或 CPU 等服务器指标查看应用程序特定指标有时会提供有价值的见解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:01:42.513

除了负载、磁盘空间等参数的系统健康监控（使用 Nagios），我们

*   有一个内置的 REST 服务，从 Nagios 调用，它提供关于
    *   每秒事务数（这在我们的例子中是有意义的）
    *   活动会话数
    *   每分钟日志中的错误数
    *   ……
    *   简而言之，任何特定于应用程序的东西
*   监控（虚拟）往返交易所需的时间：就像用户或系统正在执行业务功能一样

所有这些数据都被发送回 Nagios，然后我们配置警报级别和通知。

我们发现监控日志中错误条目的数量可以为许多系统提供一些关于重大崩溃/问题的极好的短期警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T16:18:19.983

我们的许多客户使用处理健康监控的系统和应用程序监视器，以及运行连续合成事务的合成最终用户监视器，从最终用户的角度向您展示 Web 应用程序的性能。它适用于防火墙内外的应用程序。用户经常告诉我们，SEUM 会从特定位置或一天中的特定时间揭示可用性问题。您可以在以下位置下载免费试用版

SolarWinds.com。

# c# - 元数据包含无法解析的引用（错误的 wsdl url）

> ID：12251594
> 
> 赞同：2
> 
> 时间：2012-09-03T16:48:26.190
> 
> 标签：c#, asp.net, web-services, wsdl, service-reference

添加 Web 引用或服务引用时，Visual Studio 2010 显示以下错误消息。实际的 wsdl 网址是`http://x.x.x.x:9999/PersonCRUD.asmx?wsdl`. 我不知道为什么视觉工作室试图从`http://x.x.x.x/PersonCRUD.asmx?wsdl`

```
Metadata contains a reference that cannot be resolved: 'http://x.x.x.x/PersonCRUD.asmx?wsdl'.
There was an error downloading 'http://x.x.x.x/PersonCRUD.asmx?wsdl'.
The request failed with HTTP status 404: Not Found.
Metadata contains a reference that cannot be resolved: 'http://x.x.x.x:9999/PersonCRUD.asmx'.
Metadata contains a reference that cannot be resolved: 'http://x.x.x.x:9999/PersonCRUD.asmx'.
If the service is defined in the current solution, try building the solution and adding the service reference again. 
```

在 wsdl 的末尾有包含错误 url 的部分。我想这是问题的根源。（缺少端口：9999）

```
<wsdl:port name="PersonCRUDSoap" binding="tns:PersonCRUDSoap">
    <soap:address location="http://78.186.32.181/PersonCRUD.asmx"/>
</wsdl:port>
<wsdl:port name="PersonCRUDSoap12" binding="tns:PersonCRUDSoap12">
    <soap12:address location="http://78.186.32.181/PersonCRUD.asmx"/>
</wsdl:port> 
```

顺便说一句，我在一个全新的网站项目中尝试了这个。

有没有人知道为什么会发生这个错误？

谢谢。

# performance - 莱文斯坦转置距离

> ID：12251597
> 
> 赞同：1
> 
> 时间：2012-09-03T16:48:33.060
> 
> 标签：performance, algorithm, dynamic, dynamic-programming, levenshtein-distance

如何使用动态编程单独实现转置/交换/旋转/交换距离。我必须强调我不想检查其他操作（即复制、删除、插入、杀死等）只是转置/交换。

我希望仅将 Levenstein 的算法应用于交换距离。代码会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:39:46.263

动态规划的有效应用通常需要将任务分解为同一任务的多个实例以获得更短的输入。在 Levenstein 距离的情况下，这归结为两个字符串的前缀以及从一个字符串到另一个字符串所需的编辑次数。我看不出在您的情况下如何实现这种分解。至少我看不到会导致多项式时间算法的算法。

此外，目前还不清楚您在谈论什么操作。根据上下文，交换或交换可以表示与换位相同的意思，也可以表示用任意其他字母替换一个字母，例如`test->text`. 如果通过“transpose/swap/twiddle/exchange”你试图只说“transpose”，那么你应该看看[Counting the nearest swaps required to convert an permutation into another](https://stackoverflow.com/questions/7797540/counting-the-swaps-required-to-convert-one-permutation-into-another/7797838#7797838)。如果不是，请澄清问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:22:36.783

我不确定在这种情况下是否可以使用 Levenstein 的算法。如果没有插入或删除操作，只有在相同长度和相同字符的字符串之间才能很好地定义距离。仅通过换位无法转换为相同字符串的字符串示例：

```
AB, ABC
AAB, ABB 
```

有了这个，算法可以找到所有可能的字符位置排列，而不是在两个字符串中的相同位置，并寻找可以用最少数量的转置或交换来表示的排列。

# c# - 如何在 Windows 8 中接收电源恢复消息？

> ID：12251611
> 
> 赞同：1
> 
> 时间：2012-09-03T16:50:10.500
> 
> 标签：c#, windows-8

我编写了一个 C# 应用程序，它监视连接到运行 Windows 8 的 ARM 平板电脑的设备。该应用程序需要检测平板电脑何时从睡眠状态恢复，以便它可以向连接的设备发送命令。

根据[这个问题](https://stackoverflow.com/questions/228288/how-can-i-know-when-windows-is-going-into-out-of-sleep-or-hibernate-mode)，我已尝试监视 Microsoft.Win32.SystemEvents.PowerModeChanged 事件。

[根据此问题](https://stackoverflow.com/questions/727154/cant-catch-sleep-suspend-messages-winxp)，我已尝试查看 WM_POWERBROADCAST 消息。

在这两种情况下，该应用程序都可以在我的 Windows 7 桌面开发 PC 上正常运行。但是，当我在 Windows 8 ARM 平板电脑上运行应用程序时，这两种方法都不起作用。

在这种情况下，我需要注意不同的消息吗？还有什么我可以尝试解决这个问题的吗？

更新：我发现当我插入或拔出主电源时，我确实收到了 WM_POWERBROADCAST 消息（电源状态更改）。我还收到一个 SystemEvents.PowerModeChanged 事件。但是，在经历暂停/恢复周期时，我仍然没有收到任何暂停或恢复电源消息。

更新#2：我已经为我的特殊情况找到了一种不依赖电源消息的解决方法。但感谢那些花时间回答/评论的人。

# .htaccess - 除非以文件扩展名结尾，否则使用 htaccess 重写

> ID：12251614
> 
> 赞同：0
> 
> 时间：2012-09-03T16:50:32.717
> 
> 标签：.htaccess, rewrite, file-extension

我们将如何使用 htaccess 文件将所有 URL 重写为 index.php，除非它们以文件扩展名结尾。

以下：

```
RewriteEngine on
RewriteRule ^index.php$ - [L]
RewriteRule ^(.*)$ index.php [L,QSA] 
```

正在重写一切。如果文件以 .php / .jpg / .css / .js 等......等等......我希望它不要重定向，而是转到该文件。

这是怎么做的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:20:43.287

我认为就是这样，但希望得到一些反馈：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php [L]
</IfModule> 
```

# php - php strtotime 将月份显示为日期

> ID：12251615
> 
> 赞同：3
> 
> 时间：2012-09-03T16:50:34.967
> 
> 标签：php

我正在构建一个具有每周视图的日记，我认为我已经破解了这些视图，因为日期似乎看起来是正确的。直到我的 MySQL 查询不断返回看似随机的结果，我才意识到月份实际上被视为一天。

```
$week_number = date("W");
$year = date("Y");

for ($day=0; $day<=6; $day++) {
    $daily_date = date('d/m/Y', strtotime($year."W".$week_number.$day))."\n";
    $StartDate = date('d', strtotime($daily_date));
}

echo $starteDate; 
```

`$startDate`返回月份的数字而不是日期，并且确实`date('m', strtotime($daily_date))`返回日期而不是月份。

我不明白我在哪里犯了这个愚蠢的错误，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T16:56:48.573

这是因为日期的美国化 - strtotime 会将日期读取为 m/d/Y 而不是 d/m/Y。

日期的[ISO](http://en.wikipedia.org/wiki/ISO_8601)是 Ymd，为方便起见，我在进行任何类型的日期操作时都会使用这种格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:56:37.840

那个代码太可怕了。您正在多次将日期转换为字符串。绝对没有理由获取您的`$year . w. $week_number.etc...`值，将其转换为字符串，然后将该字符串转换回日期以提取日期值。

同样，d/m/Y 是一种用于日期传输的可怕格式，因为... 让我感到困惑，什么是 01/02/03。是 2001 年 2 月 3 日吗？2002 年 3 月 1 日？想不通，怎么能指望strtotime做的更好呢？它相当聪明，但它不是无所不知的，而且它绝对不是万无一失的。4 位数的年份确实让它更容易一些，但你仍然可能会遇到`d/m`混乱`m/d`。

为什么不简单

```
$StartDate = date('d', strtotime($year."W".$week_number.$day)); 
```

或者更好的是，使用[DateTime](http://php.net/datetime)类并选择适当的[DateInterval](http://php.net/dateinterval)

# c# - 短信文本编码

> ID：12251616
> 
> 赞同：2
> 
> 时间：2012-09-03T16:50:43.977
> 
> 标签：c#, windows-phone-7, character-encoding, sms

我要问的是 Windows Phone 7.x 上的 SMS 消息是否以 ASCII 或 UNICODE 格式编码，尤其是哪种类型。

实际上，我想将用户在文本框中键入的包含希腊字符的字符串转换为包含 - 在其他字符中 - 相应的大写希腊字符的字符串，这样短信将不限于只有 70 个字符！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:23:48.637

`SmsComposeTask`唯一允许您在字符串中设置消息。在 .NET 中，无论您做什么，String*始终以 UTF-16 编码。*它将`SmsComposeTask`在创建 SMS 时将字符串转换为另一种编码。所以不幸的是，除了让系统为您选择编码之外，您无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:22:12.120

SMS 编码由手机系统控制，不是 Windows Phone 操作系统的属性。SMS 数据的隐藏前缀指定以下数据是 ASCII 还是 Unicode。（这里是 GSM 版本的 SMS 编码规范：[3GPP TS 23.038](http://www.etsi.org/deliver/etsi_ts/123000_123099/123038/10.00.00_60/ts_123038v100000p.pdf)）。

不可能在逐个字符的基础上切换编码，因为手机数据编码标准不支持这一点。

# java - Java-如何通过单击按钮添加更多文本字段？

> ID：12251618
> 
> 赞同：1
> 
> 时间：2012-09-03T16:51:07.177
> 
> 标签：java, swing, jbutton, jtextfield

我`frame`在 Java 中创建了一个，其中有一些`textfields and buttons`。假设用户想要更多文本字段（例如添加更多数据），我想放一个`button`，当用户点击时，应该会出现`the button`一个新的。`textfield`然后用户可以通过单击应该出现的`button`另一个来填充数据。`textfield`我怎样才能做到这一点 ？我需要为按钮编写什么代码才能通过单击按钮显示越来越多的文本字段？谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T01:26:35.497

明智的做法是，不要`JFrame`直接将组件添加到您的，而是将它们添加到`JPanel`. 虽然与你的问题有关，但看看这个小例子，希望能给你一些提示，否则问我什么是越界的。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class JFrameExample
{   
    private JFrame frame;
    private JButton button;
    private JTextField tfield;
    private String nameTField;
    private int count;

    public JFrameExample()
    {
        nameTField = "tField";
        count = 0;
    }

    private void displayGUI()
    {
        frame = new JFrame("JFrame Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new GridLayout(0, 1, 2, 2));
        button = new JButton("Add JTextField");
        button.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent ae)
            {
                tfield = new JTextField();
                tfield.setName(nameTField + count);
                count++;
                frame.add(tfield);
                frame.revalidate();  // For JDK 1.7 or above.
                //frame.getContentPane().revalidate(); // For JDK 1.6 or below.
                frame.repaint();
            }
        });
        frame.add(button);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new JFrameExample().displayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:58:50.063

假设您有一个名为的主容器和一个已添加到`panel`的按钮变量，您可以执行以下操作：`button``panel`

```
// handle the button action event
button.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
    // create the new text field
    JTextField newTextField = new JTextField();
    // add it to the container
    panel.add(newTextField);
    panel.validate();
    panel.repaint();
  }
}); 
```

添加新文本字段时，您可能需要提及一些与布局相关的特征，具体取决于您使用的布局管理器（例如，如果您使用`GridBagLayout`，则需要指定约束）。

# python - 用语句包装多个函数的pythonic方法是什么

> ID：12251620
> 
> 赞同：6
> 
> 时间：2012-09-03T16:51:11.927
> 
> 标签：python, eval, fabric, with-statement, contextmanager

我正在使用 Python 库[Fabric](http://docs.fabfile.org/en/1.4.3/index.html)进行一些远程服务器维护。Fabric 自动输出对远程和本地命令的所有响应，除非您将命令包装在一对 with 语句中。像这样，在本地机器上，

```
with settings(warn_only='true'):
    with hide('running', 'stdout', 'stderr', 'warnings'):
        output = local("uname -a", True) 
```

或者在远程机器上这样：

```
with settings(warn_only='true'):
    with hide('running', 'stdout', 'stderr', 'warnings'):
        output = run("uname -a") 
```

我正在写一个漫长而复杂的任务，发现自己一遍又一遍地重复着这两个陈述。我想编写一个名为 _mute() 的函数来防止这种重复。它会让我做这样的事情：

```
def _mute(fabric_cmd, args):
    with settings(warn_only='true'):
        with hide('running', 'stdout', 'stderr', 'warnings'):
            output = fabric_cmd(args)
    return output

def some_remote_task():
    # Run a remote task silently
    _mute(remote, 'uname -a')

def some_local_task():
    # Run a local task silently
    _mute(local, 'uname -a', True) 
```

我研究了一些解决方案，并且知道“eval”可以为我做到这一点。但是我读到的关于 eval 的每一页都表明，由于安全问题，它几乎总是一个坏主意。我研究了部分，但我不知道如何在我的 _mute 函数中创建一个可调用的参数。我猜这里缺少一个更高级别的 Python 概念。这样做的pythonic方法是什么？感谢您提供的任何方向。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T16:54:54.463

更好的解决方案是让您构建自己的上下文管理器；到目前为止，最简单的方法是使用[`contextlib.contextmanager`装饰器](http://docs.python.org/library/contextlib.html#contextlib.contextmanager)：

```
from contextlib import contextmanager

@contextmanager
def _mute():
    with settings(warn_only='true'):
        with hide('running', 'stdout', 'stderr', 'warnings'):
            yield 
```

然后`_mute`用作上下文管理器：

```
def some_remote_task():
    # Run a remote task silently
    with _mute():
        output = remote("uname -a") 
```

这比必须重新键入两个较大的上下文管理器行更加紧凑和可读，并且具有*额外*的优势，现在您可以在同一上下文中运行多个命令。

至于你的问题；`*args`您可以使用以下语法轻松地将任意参数应用于给定函数：

```
def _mute(fabric_cmd, *args):
    with settings(warn_only='true'):
        with hide('running', 'stdout', 'stderr', 'warnings'):
            return fabric_cmd(*args)

def some_remote_task():
    # Run a remote task silently
    output = _mute(remote, 'uname -a') 
```

见[*args 和 **kwargs？](https://stackoverflow.com/questions/3394835/args-and-kwargs)有关`*args`任意参数列表技巧的更多信息。

# windows - 在 Windows 中，如何为不同的控制台进程获取标准设备句柄？

> ID：12251621
> 
> 赞同：0
> 
> 时间：2012-09-03T16:51:17.877
> 
> 标签：windows, winapi, console, io-redirection

我知道我可以调用`AttachConsole`和 `GetStdHandle`kernel32 函数来访问不同控制台进程的控制台屏幕缓冲区，但是如果此进程的输入/输出/错误重定向到文件或设备，我如何才能获得这些重定向位置的句柄呢？

说清楚：我无法控制我试图附加到的应用程序，这是由第三方提供的，所以我使用 IPC 的机会很小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T16:56:17.430

`GetStdHandle`将尊重任何重定向并返回[重定向的句柄](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683231%28v=vs.85%29.aspx)；

> 进程的标准句柄可以通过调用来重定向 `SetStdHandle`，在这种情况下`GetStdHandle` *返回重定向的句柄*。

该链接还描述了如何索取原件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:25:30.667

您可以使用`CreateRemoteThread`将代码插入其他进程并`GetStdHandle`从那里调用。然后，您需要使用`DuplicateHandle`在您自己的进程中制作句柄的副本。

请记住，您对该句柄所做的任何事情都会影响目标进程中的句柄，这可能会导致意外问题。例如，如果两个进程都尝试从标准输入流中读取，您将无法预测哪个进程会看到输入的哪一部分，并且如果两个进程都写入标准输出流，则输出可能会随机重叠方式或一组输出可能会覆盖另一组。

# html - @font-face 嵌入字体未显示在 Android 浏览器选择标签中

> ID：12251622
> 
> 赞同：0
> 
> 时间：2012-09-03T16:51:19.267
> 
> 标签：html, css, webkit, font-face, android-browser

我在我的网页中使用 @font-face 嵌入的 ttf 字体。

问题是，每当我使用它在选择标签中显示项目或选项时，除了当前选定的项目之外的所有内容在 Android 浏览器中都显示为乱码。当我在 Chrome 等桌面浏览器中尝试时，它会正确显示。

截图：

在桌面 Chrome 中正确显示：

[在桌面 Chrome 中正确显示 http://img339.imageshack.us/img339/8676/pro1n.jpg](http://img339.imageshack.us/img339/8676/pro1n.jpg)

非活动选择在 Android 浏览器中正确显示：

[非活动选择 android 浏览器 http://img59.imageshack.us/img59/4025/pro2d.jpg](http://img59.imageshack.us/img59/4025/pro2d.jpg)

当我在 Android 浏览器中单击选择时显示乱码：

[非活动选择 android 浏览器 http://img833.imageshack.us/img833/1461/pro3d.png](http://img833.imageshack.us/img833/1461/pro3d.png)

我正在使用以下 CSS 嵌入字体：

```
@font-face{
font-family: "MyFont";
src: url('../fonts/MyFont.ttf')  format('truetype');
} 
```

以及将字体应用于选择标签的以下 CSS 规则：

```
select{
font-family: MyFont !important;
font-size: 16px;
}

select option{
font-family: MyFont !important;
font-size: 16px;
} 
```

我在整个网页中都使用了相同的字体，除了选择标签外，它在任何地方都可以正常工作。我怎么解决这个问题 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:04:24.440

你不能。我猜浏览器正在尝试做正确的事情，但是本机控件不使用默认系统字体以外的其他字体。

也许这在较新版本的 Android 或 Android 上的其他浏览器（例如 Chrome）中已修复。

您需要在使用 HTML 的 JS 中制作自己的选择标签副本来制作控件。

像[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)这样的东西会做你需要的，虽然很遗憾，因为本机控件通常在很多方面都更好（除了这个问题！）

# firefox - 为所有用户安装 Firefox 扩展 [系统范围安装]

> ID：12251625
> 
> 赞同：3
> 
> 时间：2012-09-03T16:51:41.360
> 
> 标签：firefox, installation, firefox-addon, mozilla

我编写了一个打包为`.xpi`文件的 Firefox 扩展。我想为所有用户安装这个扩展。在某处我发现我们可以通过将文件放在文件`Mozilla\Extensions`夹中来实现这一点，然后扩展名将可供所有用户使用。

但问题是在安装扩展后，首次启动 Firefox

*   对于管理员，会出现一个弹出选项卡，询问是否启用或禁用扩展，但是
*   对于非管理员用户，将不会出现任何弹出窗口，并且最初将为他们禁用扩展程序。

安装后第一次启动浏览器时，是否可以通过启动弹出选项卡来通知每个用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-28T10:01:02.987

只是为了提供[旧答案](http://kb.mozillazine.org/Installing_extensions)，它不再完美无缺：

> 如果您想进行静默管理安装 [...]：
> 
> 自己将 .xpi 文件（作为 ZIP 文件）解压缩到适当命名的（扩展程序 ID）文件夹中。在 Linux/Unix 平台上，您可以使用帮助脚本以自动方式确定扩展 ID。

将此目录放入`browser/extension`文件夹中。

另请参阅[有关 Thunderbird 的答案](https://unix.stackexchange.com/a/220804/115933)（由我撰写）。在强制执行应用程序签名之前，相同的步骤适用于 Firefox。在 Firefox 43 中，签名检查[可以通过`about:config`.](https://stackoverflow.com/questions/31952727/how-can-i-disable-firefox-addons-signature-checking) 据称，该`about:config`解决方法将在 Firefox 44 中停止工作。

# xcode - Xcode：清除所有变量

> ID：12251626
> 
> 赞同：0
> 
> 时间：2012-09-03T16:51:44.587
> 
> 标签：xcode, reset

是否有将所有变量重置为 0 并清除所有文本字段的命令？

就像，如果你进入 iOS 模拟器，然后 iOS 模拟器在菜单中 - > 清除首选项和内容（或类似的东西......德语：Inhalte und Einstellungen zurücksetzen）。

这将更容易重置所有数据，而不是手动将所有变量设置为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:01:18.910

如果我正确理解了您的问题的上下文，**则**没有命令可以将模拟器中当前可见用户界面的所有变量重置为零和/或空白。

想一想——模拟器需要知道一些关于你的应用程序的内部细节，这些细节可能只在编译时才可用。

如果您想清除我们的变量或文本字段或其他任何内容，在您的界面中暂时提供一个 UIButton 会更聪明（如果您愿意，仅用于调试目的）它会在您测试时执行您想做的事情.

# python - 有没有办法从 hadoop 流中的 python 脚本中获取信息错误？

> ID：12251627
> 
> 赞同：3
> 
> 时间：2012-09-03T16:51:54.763
> 
> 标签：python, debugging, error-handling, hadoop, hadoop-streaming

我正在使用 python 和 hadoop 流。尽管进行了仔细的单元测试，错误还是不可避免地蔓延开来。当它们发生时，这个错误消息就是 hadoop 给出的全部：

```
java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1
    at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:362)
    at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:576)
... 
```

该消息对调试非常无益。

有没有办法从 hadoop 流中的 python 脚本中获取*信息错误？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T23:32:36.100

如果您有权访问正在运行的集群的作业跟踪器，则可以通过查找作业并查找失败的任务来访问脚本的 stderr/stdout。

# android - Android TTS 添加语言

> ID：12251628
> 
> 赞同：6
> 
> 时间：2012-09-03T16:51:56.413
> 
> 标签：android, text-to-speech

我想开发一个将 TTS 用于多种语言的应用程序。问题是只有少数语言带有特定的设备，这取决于我想的国家（我说的是 PICO）。有没有办法使用嵌入在我的 apk 中的 TTS 引擎，或者在网上某处找到丢失的 PICO 文件并将它们放在 apk 中......或任何其他支持语言但默认存在于设备中的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:07:45.063

阅读这篇文章：[http ://android-developers.blogspot.com/2009/09/introduction-to-text-to-speech-in.html](http://android-developers.blogspot.com/2009/09/introduction-to-text-to-speech-in.html)

有一个意图（动作 - ACTION_INSTALL_TTS_DATA）会自动下载所需的语言。

另外，我相信你可以做两件事：

a) 基于[http://developer.android.com/reference/android/speech/tts/TextToSpeechService.html](http://developer.android.com/reference/android/speech/tts/TextToSpeechService.html)实现自己的服务。

b) 您可以使用 API 加载一些自定义文件 - addEarcon(String earcon, String filename) ( [http://developer.android.com/reference/android/speech/tts/TextToSpeech.html](http://developer.android.com/reference/android/speech/tts/TextToSpeech.html) )

# javascript - 有什么比 document.execCommand 更好的吗？

> ID：12251629
> 
> 赞同：24
> 
> 时间：2012-09-03T16:52:05.310
> 
> 标签：javascript, ckeditor, richtext, dom, execcommand

在实现基于 Web 的富文本编辑器时，我读到这`document.execCommand`对于在 HTML 文档上执行操作很有用（比如使选择变为粗体）。但是，我需要一些更好的东西。具体来说，我需要确切地知道从 innerHTML 中添加或删除了哪些文本，以及在什么位置（作为整个文档的 HTML 表示的偏移量）。

我考虑使用内置的 document.execCommand 与 DOM4 的变异观察者一起使用，但 execCommand 似乎不能胜任这项任务：

*   我看不到“取消粗体”选择的方法
*   生成的 html 似乎因浏览器而异。（我想要 <span> 标签而不是 <b>，但一致性更重要）
*   并且没有关于它如何处理冗余嵌套/相邻 < span > 标签的信息。

此外，根据我的需要，使用突变观察者似乎有点矫枉过正。

我的动机：我试图定期将文档更改传输到服务器而不重新传输整个文档。我将数据作为 HTML 表示上的插入和删除集合发送。如果有人知道如何从 CKEditor 中获取此功能（所以我不必从头开始），那么我会永远爱你。

注意：执行文本比较不是一个选项，因为它在非常大的文档上性能很差。

否则，我并不完全害怕尝试写一些这样做的东西。DOM 的范围对象提供的方法将处理大量繁重的工作。我也很感激有关这种可能性的建议。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-16T21:17:18.790

使用 execCommand 有另一种选择 - 实现编辑器的整个交互，包括光标的闪烁。它已经完成了。谷歌在文档中这样做，但也有一些免费和开源的东西。Cloud9 IDE [http://c9.io](http://c9.io)有一个实现。AFAIK，github 使用该编辑器已有一段时间了。你当然可以在此基础上做任何事情，因为不涉及本机代码 - 就像在 execCommand

仓库在这里：[https](https://github.com/ajaxorg/cloud9) ://github.com/ajaxorg/cloud9 （它包含整个 IDE，您需要找到编辑器的代码。）

此外 - dom 突变事件已被弃用。如果您可以放弃对旧浏览器的支持，请尝试[突变观察者](https://developer.mozilla.org/en-US/docs/DOM/DOM_Mutation_Observers)。如果没有 - 尽量避免检测 DOM 更改并拦截编辑器实现中的更改。这也可能是新浏览器的必经之路。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-11-30T20:33:41.337

有[Trix](https://trix-editor.org/)富文本编辑器，从他们的描述看来，避免不一致的 execCommand 是项目的重点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-01-21T21:06:49.863

似乎新标准将是[Input Events Level 2](https://w3c.github.io/input-events/)。在我看来，它将是 execCommand 的修订改进版本。

# php - 如何使用 php 运行 abc.exe

> ID：12251634
> 
> 赞同：12
> 
> 时间：2012-09-03T16:52:24.857
> 
> 标签：php, file, exe

我希望 php 文件运行 exe 文件并在用户转到特定 url 时显示 exe 文件内容。我正在尝试使用 php 函数 exec('abc.exe'); 运行 exe 文件。但我只看到空白页。

任何人都知道如何解决它或如何正确运行 php 文件中的 exe 文件？提前谢谢了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T16:54:34.193

要使用 php 访问操作系统，请执行以下操作

```
$answer = shell_exec("abc.exe");
echo $answer."</br>"; 
```

$answer 字符串将包含 abc.exe 打印出或返回的信息。

您可能需要使用explode() 对其进行格式化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T16:55:56.500

如果您的 php 在 Windows 机器上运行，您只能运行 exe 文件。此外，如果您在共享主机上，您的主机可能已禁用 exec 命令。

如果您在 Windows 机器上，“abc.exe”必须在当前目录或 PATH 中。

要捕获输出，请使用：

```
exec( 'abc.exe', &$output);
echo $output; 
```

链接到[执行](http://www.php.net/manual/en/function.exec.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-05T09:40:04.907

您可以在 windows 中使用 VaccinalBowl 代码，但对于地址 .exe 文件，请参见以下示例：

```
$answer = shell_exec("D://Downloads/software/npp.6.7.9.2.Installer.exe");
echo $answer."</br>"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-24T08:33:20.363

我知道这个答案可能会迟到，但 php 中有一个“hack”，您可以在 Windows 中与 Task Scheduler 一起使用。以下代码适用于所有浏览器，而不仅仅是 IE。但是我应该警告您，有时您正在访问的程序可能不会在那个时刻运行，因为我有时注意到计划任务可能处于“排队”状态并且没有运行。但是代码确实可以 100% 工作......这只是任务在任务调度程序中处于什么状态的问题......它的“运行”或“排队”。

```
<?php
function ex($command)
{
    shell_exec('SCHTASKS /F /Create /TN _law /TR "' . $command . '"" /SC DAILY /RU 
INTERACTIVE');
    shell_exec('SCHTASKS /RUN /TN "_law');
    shell_exec('SCHTASKS /DELETE /TN "_law" /F');
}
ex("C:/Windows/System32/notepad.exe");
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-29T06:27:51.197

即使使用 2&>1（尽管 chmod 777）也遇到权限问题，但解决方法是通过保存到文件中读取输出

看例子，cs_crypto是要解密的东西

```
<?php
$str = $_GET['pswd'];
$output = shell_exec("echo $str");
echo "<pre><font color='white'>$output</font></pre>";
//$output = shell_exec("echo ./cs_crypto de aesbase $str");
//$output = shell_exec("./cs_crypto de aesbase $str 2>&1");
exec("./cs_crypto de aesbase $str > out");
$output = shell_exec("tail -1 out");
//exec('./cs_crypto de aesbase $str', $output, $return_var);
//echo "<pre><font color='white'>$return_var</font></pre>";
echo "<pre><font color='white'>$output</font></pre>";
?> 
```

所以最终的结果在 web

[![在此处输入图像描述](../Images/95976cd0e5731f85f440d5035deed075.png)](https://i.stack.imgur.com/R5oNz.jpg)

# html - 我是否需要根据 W3Schools 指定“默认”的 HTML 选项？

> ID：12251636
> 
> 赞同：3
> 
> 时间：2012-09-03T16:52:28.907
> 
> 标签：html, dir

我是否需要根据 W3Schools 指定“默认”的 HTML 选项？

我一直认为您可以省略“默认”HTML 选项，例如`dir="ltr"`in`<html>`或`media="all"`in`<link>`样式表。

但我经常看到大型网站（例如 YouTube）无论如何都会这样做。这样做有什么好处，还是只浪费了几个字节？

我一直在想这个问题，我在想可能会有不同的浏览器处理事情，例如默认以 RTL 显示网页。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T21:19:12.320

您不应该注意 W3schools 对默认值的说法。

HTML 中有很多默认属性值，在这些情况下，如果要获取默认值，则无需指定属性；这就是默认值的意义所在。您可以出于明确或其他原因（如样式或脚本）这样做。

但是该`dir`属性在 HTML 规范中没有设置默认值。实际上，浏览器大多默认为`dir=ltr`，但这不是必需的。（HTML 4.01 的散文只提到了这两个值。DTD 没有指定默认值。）然而，在 HTML5 草案中，似乎`dir`根元素上的默认值将设置为`ltr`.

在 HTML 4.01 中， `media`in的默认值`link`设置为。`screen`这里有一些不一致之处，浏览器实际上可能暗示`all`. 因此，人们希望明确说明样式表应仅应用于屏幕还是应用于所有媒体，这是完全可以理解的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T16:55:29.963

不，但是您可能会决定是否发现浏览器会弄乱事情。

YouTube 可能会这样做，因为他们有 ltr 和 rtl 的样式，所以他们可以`html[dir='ltr']`在他们的 CSS 中使用选择器。

此外，您可能会收到评论说 w3schools 是一个不可靠的资源，这通常是，所以要小心您从那里学到的信息。

# python - JPG 到 PDF Nautilus 脚本（使用 ImageMagick）

> ID：12251637
> 
> 赞同：3
> 
> 时间：2012-09-03T16:52:34.333
> 
> 标签：python, imagemagick, nautilus

在搜索了一个但没有成功后，我决定制作自己的脚本，将选定的 JPEG 文件转换为一个 PDF。

**这是代码（使用 Python 制作）：**

```
#!/usr/bin/env python
import os

n = " ".join(os.environ["NAUTILUS_SCRIPT_SELECTED_FILE_PATHS"].splitlines())

os.system("convert " + n + " out.pdf") 
```

此脚本的问题在于，如果您要转换的文件位于名称中有空格的目录中（比如说 ），它就不起作用`/home/myuser/My Photos/1/`。

有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:03:55.333

```
n = " ".join("'%s'" % f for f in os.environ["NAUTILUS_SCRIPT_SELECTED_FILE_PATHS"].splitlines()) 
```

请记住清理您的文件名，否则恶意制作的名称可以使脚本在我们的机器上执行代码。

更好的是，使用[`subprocess`](http://docs.python.org/library/subprocess.html)模块而不是`os.system()`.

```
subprocess.call ([ "convert" ] + os.environ["NAUTILUS_SCRIPT_SELECTED_FILE_PATHS"].splitlines() + [ "out.pdf" ]) 
```

# asp.net-mvc - ASP.NET MVC 将用户定向到来自不同控制器的视图

> ID：12251645
> 
> 赞同：1
> 
> 时间：2012-09-03T16:53:13.000
> 
> 标签：asp.net-mvc

我正在使用 ASp.NET MVC 3。

在视图中，如何将用户重定向到完全位于不同控制器中的视图？

我可以做到：`@Html.ActionLink("Go Here", "Index")`但我想将用户定向到不同控制器的索引视图。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:56:17.490

使用 ActionLink 的另一个重载

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    string controllerName
) 
```

[http://msdn.microsoft.com/en-us/library/dd505070%28v=vs.108%29](http://msdn.microsoft.com/en-us/library/dd505070%28v=vs.108%29)

用法

```
@Html.ActionLink("Go Here", "Index", "<YourOtherController>") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T16:57:30.320

@Html.ActionLink（字符串 LinkText，字符串 ActionName，字符串 ControllerName）

有很多参数可供选择。输入@HTML.ActionLink( 它们会显示出来。使用向上和向下按钮在它们之间导航。

# batch-file - 如何在没有文件夹的情况下将文件复制到目录中？

> ID：12251646
> 
> 赞同：0
> 
> 时间：2012-09-03T16:53:16.113
> 
> 标签：batch-file, copy

我想使用批处理从源文件复制文件而不使用目录。(SRC -> 文件) -> (文件) 当我这样做时

```
%WINRAR%\WinRAR.exe a -afzip %BASE%\MMORPG.zip %SRC% /E 
```

它将文件夹复制到一个 zip 文件中，我只想要文件，没有文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T19:24:46.250

使用`-ep`或`-ep1`：

```
"%WINRAR%\WinRAR.exe" a -afzip **-ep1** "%BASE%\MMORPG.zip" "%SRC%" 
```

该`-ep`选项完全去除路径，同时`-ep1`仅删除基本路径。如果您归档包含子目录的目录（并指定实际包含子目录的选项），则可以看到差异`-r`。由于您没有归档子目录，因此这两个选项中的任何一个都适合您。

# c++ - 在 boost::d_ary_heap_indirect 中更新优先级

> ID：12251655
> 
> 赞同：1
> 
> 时间：2012-09-03T16:54:14.700
> 
> 标签：c++, boost

我使用 d_ary_heap_indirect 作为优先级队列（首先处理具有最高优先级的项目），使用属性映射来存储优先级。但是，当我更改优先级属性映射中的值并将已经在队列中的顶点再次推送到队列中时，它会导致一种无效状态，即顶点在队列中的不同位置出现两次。

这是一个演示：

```
#include <iostream>
#include <iomanip>

#include <boost/graph/grid_graph.hpp>
#include <boost/graph/detail/d_ary_heap.hpp>
#include <boost/property_map/property_map.hpp>

#include <cstdlib>

template <typename TQueue>
static void OutputQueue(TQueue queue);

int main(int, char*[])
{
  srand((unsigned int)time(NULL));
  srand48((unsigned int)time(NULL));

  boost::array<std::size_t, 2> lengths = { { 2,2 } };
  typedef boost::grid_graph<2> GraphType;
  GraphType graph(lengths);
  typedef boost::graph_traits<GraphType>::vertex_descriptor Vertex;
  typedef boost::property_map<GraphType, boost::vertex_index_t>::const_type GridIndexMapType;
  GridIndexMapType gridIndexMap(get(boost::vertex_index, graph));

  typedef boost::vector_property_map<std::size_t, GridIndexMapType> IndexInHeapMap;
  IndexInHeapMap index_in_heap(gridIndexMap);

  typedef boost::graph_traits<GraphType>::vertex_iterator VertexIteratorType;

  typedef boost::vector_property_map<float, GridIndexMapType> PriorityMapType;
  PriorityMapType priorityMap(gridIndexMap);
  VertexIteratorType vertexIterator, vertexIteratorEnd;

  typedef std::greater<float> ComparisonFunctor;
  typedef boost::d_ary_heap_indirect<Vertex, 4, IndexInHeapMap, PriorityMapType, ComparisonFunctor > MutableQueueType;

  ComparisonFunctor comparisonFunctor;
  MutableQueueType mutableQueue(priorityMap, index_in_heap, comparisonFunctor);

  std::cout << "There are " << mutableQueue.size() << " items in the queue." << std::endl;

  // Add random values to the vertices and add them to the queue
  for( tie(vertexIterator, vertexIteratorEnd) = vertices(graph); vertexIterator != vertexIteratorEnd; ++vertexIterator)
  {
    put(priorityMap, *vertexIterator, rand() % 1000);
  }

  for( tie(vertexIterator, vertexIteratorEnd) = vertices(graph); vertexIterator != vertexIteratorEnd; ++vertexIterator)
  {
    mutableQueue.push(*vertexIterator);
  }

  std::cout << "There are " << mutableQueue.size() << " items in the queue." << std::endl;

  std::cout << "The priority queue is: " << std::endl;
  OutputQueue(mutableQueue);

  // Insert another set of random values for each vertex
  for( tie(vertexIterator, vertexIteratorEnd) = vertices(graph); vertexIterator != vertexIteratorEnd; ++vertexIterator)
  {
    float newPriority = rand() % 1000;
    std::cout << "New priority for " << vertexIterator->operator[](0) << ", " << vertexIterator->operator[](1) << " " << newPriority << std::endl;
    put(priorityMap, *vertexIterator, newPriority);
  }

  for( tie(vertexIterator, vertexIteratorEnd) = vertices(graph); vertexIterator != vertexIteratorEnd; ++vertexIterator)
  {
    //mutableQueue.push(*vertexIterator); // This makes sense that the queue would not end up sorted
    mutableQueue.push_or_update(*vertexIterator); // I thought this one should work
    //mutableQueue.update(*vertexIterator); // This one actually seems to UNsort the queue?
  }

  std::cout << "There are " << mutableQueue.size() << " items in the queue." << std::endl;

  std::cout << "The priority queue is: " << std::endl;
  OutputQueue(mutableQueue);

  std::cout << std::endl;

  return 0;
}

template <typename TQueue>
static void OutputQueue(TQueue queue)
{
  while( ! queue.empty() )
  {
    typename TQueue::value_type u = queue.top();

    // These two lines are equivalent
    std::cout << "vertex: " << u[0] << " " << u[1] << " priority: " << get(queue.keys(), u) << std::endl;

    queue.pop();
  }
} 
```

和一个演示输出：

```
There are 0 items in the queue.
There are 4 items in the queue.
The priority queue is: 
vertex: 1 1 priority: 445
vertex: 0 0 priority: 150
vertex: 0 1 priority: 84
vertex: 1 0 priority: 0
New priority for 0, 0 769
New priority for 1, 0 870
New priority for 0, 1 99
New priority for 1, 1 211
There are 8 items in the queue.
The priority queue is: 
vertex: 0 0 priority: 769
vertex: 1 0 priority: 870
vertex: 1 0 priority: 870
vertex: 0 0 priority: 769
vertex: 1 1 priority: 211
vertex: 1 1 priority: 211
vertex: 0 1 priority: 99
vertex: 0 1 priority: 99 
```

该演示只是为每个顶点设置随机优先级值，并将它们全部推入队列。然后它再次做同样的事情。您可以在输出中看到一些项目出现在队列中的不同位置（不是背靠背，正如我所期望的，因为它们在 PriorityMap 中引用相同的优先级值）。

问题是项目 (0,0)（新的优先级为 769）出现在顶点 (1,0) 上方，优先级为 870。这将导致项目以错误的顺序处理。

有没有办法在推送队列时替换队列中的项目而不是添加第二个项目？（像 std::set 而不是像 std::multiset 的当前行为）？

--------- 编辑 ------------ 在“//为每个顶点插入另一组随机值”循环中，我替换了 'mutableQueue.push(*vertexIterator) ' 和 ：

```
mutableQueue.push_or_update(*vertexIterator); 
```

不幸的是，它没有达到我的预期 - 现在的输出是：

```
There are 0 items in the queue.
New priority for 0, 0 150
New priority for 1, 0 522
New priority for 0, 1 27
New priority for 1, 1 883
There are 4 items in the queue.
The priority queue is: 
vertex: 1 1 priority: 883
vertex: 1 0 priority: 522
vertex: 0 0 priority: 150
vertex: 0 1 priority: 27
New priority for 0, 0 658
New priority for 1, 0 591
New priority for 0, 1 836
New priority for 1, 1 341
There are 7 items in the queue.
The priority queue is: 
vertex: 0 1 priority: 836
vertex: 0 1 priority: 836
vertex: 0 0 priority: 658
vertex: 0 0 priority: 658
vertex: 1 0 priority: 591
vertex: 1 0 priority: 591
vertex: 1 1 priority: 341 
```

此外，将 push() 替换为 update() 会产生：

```
There are 0 items in the queue.
New priority for 0, 0 806
New priority for 1, 0 413
New priority for 0, 1 592
New priority for 1, 1 861
There are 4 items in the queue.
The priority queue is: 
vertex: 1 1 priority: 861
vertex: 0 0 priority: 806
vertex: 0 1 priority: 592
vertex: 1 0 priority: 413
New priority for 0, 0 175
New priority for 1, 0 642
New priority for 0, 1 991
New priority for 1, 1 462
There are 4 items in the queue.
The priority queue is: 
vertex: 1 1 priority: 462
vertex: 0 1 priority: 991
vertex: 1 0 priority: 642
vertex: 0 0 priority: 175 
```

现在只有 4 个项目（如我所料），但它们没有排序！

------------ 编辑 - 更多信息 -------------- 我认为 index_in_heap 映射有问题。我补充说：

```
std::cout << "Index added: " << get(index_in_heap, v) << std::endl; 
```

在这一行之后：

放（index_in_heap，v，索引）；

在 d_ary_heap_indirect::push(Value) 中。

我还添加了

```
std::cout << "Index added caller: " << get(index_in_heap, v) << std::endl; 
```

在第一轮向队列添加值之后（在此行之后： mutableQueue.push(*vertexIterator);

输出是：

0、0 641 添加的索引的原始优先级：0 添加的索引调用者：0 1、0 40 添加的索引的原始优先级：1 添加的索引调用者：1 0、1 400 添加的索引的原始优先级：2 添加的索引调用者：2 原始优先级对于 1, 1 664 添加索引：3 添加索引调用者：0

我不明白为什么 push() 函数中的最后一个索引是 3，但是当我从调用者那里查询它时是 0？

当我在 update() 函数中查看相同的内容时，index_in_heap 似乎只是返回垃圾。也就是我看size_type index = get(index_in_heap, v);的值 在 update() 中，当使用顶点 (0,0) 调用它时，'index' 的值为 4294967295（当我希望它在 [0,3] 范围内时）。

谁能解释一下？也许我错误地设置了 index_in_heap 映射？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:46:51.967

当您仅更改节点的优先级时，优先级队列不会更新其结构。插入节点后，您需要考虑其优先级常数。如果您需要更新优先级，您需要告知优先级队列。为此，您需要告诉它哪个节点获得什么新的优先级。

不幸的是，跟踪某种节点标识和优先级会使优先级队列变慢：对于 d-heap，必须跟踪节点移动的位置，这使得更新相对昂贵。对于基于节点的堆，例如，斐波那契堆，节点保持不变，但维护成本往往更高（斐波那契堆具有有趣的理论复杂性，但仅对不切实际大小的问题很重要）。尽管我实现了所有可以在书中找到的优先级队列方法，但我还没有提出任何中间立场。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T17:18:30.090

d_ary_heap_indirect 旨在仅允许增加优先级。如果在 update() 和 push_or_update() 函数中你改变了：

preserve_heap_property_up（索引）；

至

preserve_heap_property_up（索引）；preserve_heap_property_down();

它似乎允许在保持队列排序的同时增加或减少优先级。

# ruby-on-rails - rails 3：如何将数字连接到符号？

> ID：12251660
> 
> 赞同：1
> 
> 时间：2012-09-03T16:54:56.783
> 
> 标签：ruby-on-rails, ruby, string, recursion

我想通过在 1..5 循环中使用`@comment1`来更改。我有以下非常重复的代码。我希望把它晒干。`@comment2``i`

嗨，我正在使用acts_as_commentable_with_threading。我基本上循环浏览所有评论并检查该评论是否有孩子。如果是这样，打印出孩子，同时检查这些孩子是否有孩子。所以我计划深入几个层次，因此@comment1、2、3 等......我怎样才能干燥这个？递归一些如何？如果没有，我可能会更深入一些级别，例如在@comment5 处结束评论缩进。

# 编辑！

谢谢你萨米伦！

这是更新的辅助函数...

```
 def show_comments_with_children(comments)

     comments.each do |comment|

         yield comment
         if comment.children.any?
           concat <<-EOF.html_safe
                <div class="span7 offset1-1 pcomment">
           EOF
            show_comments_with_children(comment.children) {                 |x| yield  x } #Dont worry, this will not run another query :)
               concat <<-EOF.html_safe
                    </div>
               EOF
         end   
     end
  end 
```

* * *

```
<div class="span7 offset1-1 pcomment">
<% @comment1 = comment.children%>
<% for comment in @comment1 %>
 <%= render "comment_replies", :comment => comment %>

<div class="span7 offset1-1 pcomment">
<% @comment2 = comment.children%>
<% for comment in @comment2 %>
<%= render "comment_replies", :comment => comment %>

<div class="span7 offset1-1 pcomment">
<% @comment3 = comment.children%>
<% for comment in @comment3 %>
<%= render "comment_replies", :comment => comment %>

                <% end %>
            </div> 
```

……

```
<%(1..5).each do |i| %>
  <% @comment1 = comment.children%>
  <% for comment in @comment1 %>
    <%= render "comment_replies", :comment => comment %>
  <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:24:41.583

可能您正在寻找`instance_variable_set`.

```
# Following snippet is not TESTED. It is here to just demonstrate "instance_variable_set"
<%(1..5).each do |i| %>
  <% instance_variable_set("@comment#{i}", comment.children) %>
  <% for comment in instance_variable_get("@comment#{i}") %>
    <%= render "comment_replies", :comment => comment %>
  <% end %>
<% end %> 
```

但这绝对**不是一个值得推荐的方法**。您可以共享您的控制器代码以及您想要在视图中实现的目标。必须有某种方法可以使其正确干燥。在您的帖子中，您总是得到`comment.children`. 真的吗？

* * *

## 实际解决方案：

您的视图代码将是这样的

```
#0th level is the top level
<% show_comments_with_children(@comments, 0) do |comment, level|%>
   <!-- #Use level to differ the design for different depth-->
   <%= render "comment_replies", :comment => comment %>
<%end%> 
```

并在您的辅助功能中添加此辅助`show_comments_with_children`功能。哪个会。

```
def show_comments_with_children(comments, level)
   comments.each do |comment|
       yield comment, level
       if comment.children.any?
           show_comments_with_children(comment.children, level+1) {|x, l| yield x, l} #Dont worry, this will not run another query :)
       end
   end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:29:00.217

您在其中定义此代码的庄园相当糟糕，您应该考虑将其定义`@comment`为数组而不是每个`@comment1, @comment2, etc.`.

也就是说，您正在寻找的是`instance_variable_get()`方法

```
<(1..5).each do |i| %>
  <% instance_variable_set("@comment#{i}", comment.children) %>
  <% for comment in instance_variable_get("@comment#{i}") %>
    <%= render "comment_replies", :comment => comment %>
  <% end %>
<% end %> 
```

这绝对是一件好事，但在这种情况下，我强烈建议您将注释实例变量转换为数组！

# sql-server-2008 - 快速包装 SQL Server 对象？

> ID：12251661
> 
> 赞同：2
> 
> 时间：2012-09-03T16:55:01.307
> 
> 标签：sql-server-2008, iis, slashdb

回到 MSSQL 2000 时间线，有一个 IIS 集成层允许 HTTP GET 命令生成选择语句，还有其他开箱即用的 SqlXml 细节（不是那么快或很好，但它们确实有效）。我有机会相当快地公开数据库内容。

MSSQL 2008/2012 的可比技术是什么？我看到了 slashDb ( [http://www.slashdb.com/](http://www.slashdb.com/) )，它似乎可以做到这一点，但我试图了解那里的其他选项。只是 SQL Server crud 和 sproc 访问。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-04-29T20:34:26.310

是的，SlashDB 正是这样做的，甚至更多。全面披露：我是创始人兼首席执行官。

安装 SlashDB 后，您将使用其 Web 界面将其与数据库连接。根据您用于该连接的数据库登录名和数据库架构，您会将来自该架构的表和视图转换为 URL 端点。

这些 URL 可以在浏览器中跟踪，但它们也是 JSON、XML 或 CSV 格式的 API 端点。它适用于读取和写入（您可以在用户配置中控制它）。

除此之外，您还可以定义一组参数化 SQL 查询。每个查询都有一个名称，并立即成为 API 端点。

为了帮助您轻松入门，SlashDB 在 AWS 和 Azure 市场上可用，作为 DockerHub 的 Docker 容器、预构建的虚拟机或作为 .rpm 和 .deb 包直接安装在 Linux 上。

更多技术信息请访问：[https ://docs.slashdb.com](https://docs.slashdb.com)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T08:46:44.040

最接近的等价物可能是 SOAP/HTTP 端点，但 Microsoft出于[各种原因已](http://social.msdn.microsoft.com/Forums/en-US/sqldenengine/thread/c5e75052-3a63-45c7-b234-f4d55dea8b67/)[弃用它们](http://msdn.microsoft.com/en-us/library/cc280436%28v=sql.105%29.aspx)，并推荐使用 WCF 或 ASP.NET。尽管获得快速 CRUD 设置的最简单方法可能是使用为您生成它的框架或 ORM，例如[LINQ to SQL](http://msdn.microsoft.com/en-us/library/bb386976.aspx)或任何其他适合您需要的东西。

# java - 如何将字符串更改为 ascii 值并返回字符串？

> ID：12251663
> 
> 赞同：0
> 
> 时间：2012-09-03T16:55:05.923
> 
> 标签：java, character-encoding

我正在尝试制作一个简单的加密程序，将字符串转换为等效的 ASCII 值，然后再次将其解密为字符串或字符。

```
import java.io.*; 
import javax.swing.*;

public class SimpleEncryption {
   public static void main (String [] args) throws Exception
  {
     BufferedReader inKb = new BufferedReader (new InputStreamReader (System.in));

     for(int i=0; i<10; i++)
     {
        String ans = JOptionPane.showInputDialog ("Hello User, would you like to encrypt or decrypt?");
        ans = ans.toUpperCase();        
        int a = 0;

        if (ans.contains("EN")||ans.contains("ENCRYPT"))
        {
           String pass = "";
           pass = JOptionPane.showInputDialog ("Please type your phrase into input:");          

           for (int j=0; j<pass.length(); j++)
           {
              char c = pass.charAt(j);
              a = (int) c;
              System.out.print(a);
           }
           break;
        }

        if (ans.contains("DE")||ans.contains("DECRYPT"))
        {
           String pass = "";
           pass = JOptionPane.showInputDialog ("Please type the encrypted code into input:");          

           for (int k=0; k<pass.length(); k++)
           {
              char c = pass.charAt(k);
              a = (int)(c);
              i = (char) a;
              System.out.print(a);
           }
           break;
        }

        System.out.println("Sorry I don't understand, please retry.");
     }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:01:50.593

如果你想要的实际上是任何 java 字符串（基于 UTF-16）的 ASCII 编码（在加密之前？），你可以用[base64](http://en.wikipedia.org/wiki/Base64)对其进行编码：这个编码方案就是为此而创建的。

在 java 中进行这种编码/解码真的[很容易](http://www.javatips.net/blog/2011/08/how-to-encode-and-decode-in-base64-using-java)（就像在其他语言中一样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T23:17:06.237

您似乎想要的是获取表示输入字符串的某种字符编码（不是加密）的字节数组。然后你似乎想显示编码字符的八进制值。如果您只需要 US ASCII，那么您将获得最多 177 个八进制的所有（可打印）字符。如果您需要特殊字符，则需要选择更具体的字符集（IBM OEM 或 Western-Latin 是常见的字符集）。也可以使用 UTF-8，但它可以将单个字符编码为多个字节。

```
public static String toOctalString(final byte[] encoding) {
    final StringBuilder sb = new StringBuilder(encoding.length * 4);
    for (int i = 0; i < encoding.length; i++) {
        if (i != 0) {
            sb.append("|");
        }
        sb.append(Integer.toOctalString(encoding[i] & 0xFF));
    }
    return sb.toString();
}

public static byte[] fromOctalString(final String octalString) {
    final ByteArrayOutputStream baos = new ByteArrayOutputStream(octalString.length() / 4 + 1);
    final Matcher m = Pattern.compile("[0-7]{1,3}").matcher(octalString);
    while (m.find()) {
        baos.write(Integer.parseInt(m.group(), 8));
    }
    return baos.toByteArray();
}

public static void main(String[] args) {
    final String userInput = "owlstæd";
    // use the common Latin-1 encoding, standardized in ISO 8859 as character set 1
    // you can replace with ASCII, but the ASCII characters will encode fine for both
    final byte[] userInputEncoded = userInput.getBytes(Charset.forName("ISO8859-1"));
    final String octalString = toOctalString(userInputEncoded); 
    System.out.println(octalString);

    final byte[] userInputEncoded2 = fromOctalString(octalString);
    final String userInput2 = new String(userInputEncoded2, Charset.forName("ISO8859-1"));
    System.out.println(userInput2);
} 
```

# java - Android 从 Facebook 个人资料中获取生日日期

> ID：12251664
> 
> 赞同：2
> 
> 时间：2012-09-03T16:55:06.220
> 
> 标签：java, android, facebook, facebook-graph-api

我想获取我朋友列表中的所有生日日期。我已经尝试了几天。我的代码如下。

```
Facebook facebook = new Facebook(<MY_FACEBOOK_ID>);

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    mContext = this;
    setContentView(R.layout.main);

    showNotification();

  final String[] PERMISSIONS = new String[] {"user_location", "user_birthday"};        

    facebook.authorize(this, PERMISSIONS, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {}

        @Override
        public void onCancel() {}

        @Override
        public void onFacebookError(FacebookError e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onError(DialogError e) {
            // TODO Auto-generated method stub

        }
    });

    try {

          String token = facebook.getAccessToken();

          Bundle bundle = new Bundle();
          bundle.putString("fields", "id,name");
          bundle.putString("access_token", token);

              String response = facebook.request( "me/friends", bundle ); 

              facebook.setAccessToken(facebook.getAccessToken());

              Toast.makeText(mContext, token , Toast.LENGTH_LONG).show();
              Toast.makeText(mContext, response, Toast.LENGTH_LONG).show();

              JSONObject json = Util.parseJson( response );

              JSONArray data = json.getJSONArray( "data" );

              for ( int i = 0; i < data.length(); i++ )
              {
                  JSONObject friend = data.getJSONObject( i );

                  String id = friend.getString( "id" );
                  String name = friend.getString( "name" );
                  Toast.makeText(mContext, "ID: "+ id , Toast.LENGTH_LONG).show();
                  Toast.makeText(mContext, "NAME: "+ name , Toast.LENGTH_LONG).show();
              } 
```

每次我使用此代码时都会出错。并且令牌都显示为空，响应显示问题“必须使用活动访问令牌来查询有关当前用户的信息”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T05:12:03.647

创建一个方法：

```
getProfileInformation() 
```

在方法主体中，您必须编写：

```
public void getProfileInformation() {
mAsyncRunner.request("me", new RequestListener() {
    @Override
    public void onComplete(String response, Object state) {
        Log.d("Profile", response);
        String json = response;
        try {
            JSONObject profile = new JSONObject(json);
            // getting name of the user
            String name = profile.getString("name");
            // getting email of the user
            String email = profile.getString("email");
            //getting user birthday
            String birth_day=profile.getString("birthday");

            runOnUiThread(new Runnable() {

                @Override
                public void run() {
                    Toast.makeText(getApplicationContext(), "Name: " + name + "\nEmail: " + email, Toast.LENGTH_LONG).show();
                }

            });

        } catch (JSONException e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onIOException(IOException e, Object state) {
    }

    @Override
    public void onFileNotFoundException(FileNotFoundException e,
            Object state) {
    }

    @Override
    public void onMalformedURLException(MalformedURLException e,
            Object state) {
    }

    @Override
    public void onFacebookError(FacebookError e, Object state) {
    }
}); 
```

}

上述函数将从 facebook 获取 json 数据。您需要解析 json 以获取个人资料数据。

来自 facebook 的示例配置文件 json 将如下所示：

```
 {
   "id": "1464730016",
   "name": "XYZ",
   "first_name": "XYZ",
   "last_name": "ABC",
   "link": "https://....",
   "username": "XYZ",
   "birthday": "22/10/89",
   "hometown": 
} 
```

更多详情您可以参考：

```
http://www.androidhive.info/2012/03/android-facebook-connect-tutorial/ 
```

# java - 更新 JComboBox 时发生 nullPointerException

> ID：12251673
> 
> 赞同：1
> 
> 时间：2012-09-03T16:56:05.150
> 
> 标签：java, jcombobox, resultset

我想更新 jcombobox。所以我先删除了所有项目，然后再执行查询。我在构造函数中调用这个方法，它工作正常。此外，我在一个按钮中调用此方法，当按下该 btn 时，它会给我一个空指针异常。组合框项目也被删除。所以问题出在第 5 行。如何解决这个问题？

```
private void loadDataToCombo(String query,JComboBox combo) {  
      ResultSet result1= null;
    //removing existing items before adding
     combo.removeAllItems();
     result1 = DBOptions.executeSQLQuery(query); //line 5   

    try {
        while(result1.next()){
            String data = result1.getString(1);
            combo.addItem(data);
        }

    } catch (SQLException ex) {
        Logger.getLogger(AddCustomer.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-14T03:35:49.980

我有同样的问题。我认为这是因为您在项目上有 actionlistner。我所做的是删除项目上的动作监听器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:05:57.593

如果它在单击按钮上，请查看**您是否初始化了按钮..？**

```
JButton butt = new JButton(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-28T15:43:29.847

我有同样的问题，我的解决方案是**替换****由事件 mouseclicked**执行的组合事件操作。这样，它不会捕获该项目或阻止您添加它们`addItem()`。

# c# - 在根 (UserControl) 定义 TextBox Validation.Error 事件

> ID：12251678
> 
> 赞同：-1
> 
> 时间：2012-09-03T16:56:30.627
> 
> 标签：c#, wpf, validation, data-binding

我创建了一个 UserControl `MyTextBox : System.Windows.Controls.TextBox`。我将自定义验证规则添加到数据绑定，并`Validation.Error`在 XAML 中定义了事件。

我想将`Validation.Error`事件移动到根（`MyTextBox`），以便我可以通用地处理它。我无法在 Usercontrol 实现这种方法。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T03:20:23.143

I got my question answer. Here is implementation at load event

```
//Check whether Designer mode is open. If not then set Custom binding
if ((bool)(DesignerProperties.IsInDesignModeProperty.GetMetadata(typeof(DependencyObject)).DefaultValue) == false)
        {
            SetBinding();
        } 
```

# asp.net - 如何在 ext.net 的组合框中动态显示错误消息

> ID：12251679
> 
> 赞同：1
> 
> 时间：2012-09-03T16:56:32.943
> 
> 标签：asp.net, error-handling, combobox, ext.net

我正在使用 Ext.Net1.0。我正在使用组合框..当我通过一些计算从组合框中选择值时，如果值已经使用，那么我想动态显示错误消息，那么我该如何显示消息..？？

```
<ext:ComboBox ID="cmbClient" runat="server" Width="200"
                                FieldLabel="Client Name"
                                DisplayField="client_firstName" ValueField="clientId"
                                AllowBlank="false" BlankText="Select Client"
                                MsgTarget="Title" EmptyText="Select Client">
                                <Store>
                                     <ext:Store runat="server" ID="clientStore">           
                                        <Reader>
                                            <ext:JsonReader IDProperty="clientId">
                                                <Fields>
                                                    <ext:RecordField Name="clientId" />
                                                    <ext:RecordField Name="client_firstName"/>
                                                </Fields>
                                            </ext:JsonReader>
                                        </Reader>         
                                        <SortInfo Field="client_firstName" Direction="ASC" />
                                    </ext:Store>
                                </Store>
                                 <DirectEvents>
                                        <Select OnEvent="cmbClient_Change"></Select>
                                 </DirectEvents>
                            </ext:ComboBox> 
```

**cs页面代码**

```
protected void cmbClient_Change(object sender, DirectEventArgs e)
        {

            int c = objapp.Count_SelectClient();
            if (c != 0)
            {
                statusbar.Show();
                this.statusbar.Text = cmbClient.SelectedItem.Text + " already having appoinment at selected time.";
                this.statusbar.Icon = Icon.Exclamation;
            }              
        } 
```

在这里**而不是在状态栏中显示错误消息我想在组合框中显示错误消息**..那我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T04:38:01.130

尝试使用此示例：

```
<%@ Page Language="C#" %>

<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
        this.Store1.DataSource = new object[]
        {
            new object[] { "AL", "Alabama", "The Heart of Dixie" },
            new object[] { "AK", "Alaska", "The Land of the Midnight Sun" },
            new object[] { "AZ", "Arizona", "The Grand Canyon State" },
            new object[] { "AR", "Arkansas", "The Natural State" },
            new object[] { "CA", "California", "The Golden State" },
            new object[] { "CO", "Colorado", "The Mountain State" },
            new object[] { "CT", "Connecticut", "The Constitution State" },
            new object[] { "DE", "Delaware", "The First State" },
            new object[] { "DC", "District of Columbia", "The Nation's Capital" },
            new object[] { "FL", "Florida", "The Sunshine State" },
            new object[] { "GA", "Georgia", "The Peach State" },
            new object[] { "HI", "Hawaii", "The Aloha State" },
            new object[] { "ID", "Idaho", "Famous Potatoes" }
        };

        this.Store1.DataBind();

    }
</script>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>Comboboxes - Ext.NET Examples</title>
    <script runat="server">

    protected void ComboxValueChanged(object sender, DirectEventArgs e)
    {
        var comboBox = (ComboBox)sender;
        if ((string)comboBox.Value != "ID")
        {    
            ResourceManager1.RegisterClientScriptBlock("showTooltip", string.Format("showTooltip('{0}');", comboBox.ClientID));
        }
    }

    </script>

    <script type="text/javascript">
        function showTooltip(elemId) {
            var cmp = Ext.getCmp(elemId);
            var t = new Ext.ToolTip({
                html: "It works...",
                closable: true,
                title: "Error value:",
                autoHide: false
            });

            var box = cmp.getBox();

            t.showAt([box.x + box.width, box.y]);
        }
    </script>
</head>
<body>
    <form id="Form1" runat="server">
        <ext:ResourceManager ID="ResourceManager1" runat="server" />

        <ext:Store ID="Store1" runat="server">
            <Reader>
                <ext:ArrayReader>
                    <Fields>
                        <ext:RecordField Name="abbr" />
                        <ext:RecordField Name="state" />
                        <ext:RecordField Name="nick" />
                    </Fields>
                </ext:ArrayReader>
            </Reader>            
        </ext:Store>

        <ext:Button ID="Button1" runat="server" Text="Set 'IDAHO' value">
            <Listeners>
                <Click Handler="#{ComboBox1}.setValue('ID');" />
            </Listeners>
        </ext:Button>

        <h2>Not Editable:</h2>

        <ext:ComboBox 
            ID="ComboBox1" 
            runat="server" 
            StoreID="Store1" 
            Editable="false"
            DisplayField="state"
            ValueField="abbr"
            TypeAhead="true" 
            Mode="Local"
            ForceSelection="true"
            EmptyText="Select a state..."
            Resizable="true"
            SelectOnFocus="true"
            >
            <DirectEvents>
                <Change OnEvent="ComboxValueChanged"></Change>
            </DirectEvents>
        </ext:ComboBox>
    </form>
</body>
</html> 
```

# node.js - Nodejs mongodb原生驱动，异步请求的执行顺序

> ID：12251680
> 
> 赞同：1
> 
> 时间：2012-09-03T16:56:34.893
> 
> 标签：node.js, mongodb

由于Nodejs是异步的，有没有人有一种很好的方式来排序mongodb请求。

假设我将 data1 插入数据库，并且我立即请求读取该数据，我的读取请求可能会在数据写入数据库之前执行。

有没有一种很好的方法来解决这个问题，而不是在请求上强制同步行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:09:44.050

您可以简单地使用只有在插入完成后才会调用的回调。

```
var
    mongodb = require('mongodb'),
    client = new mongodb.Db('test', new mongodb.Server('127.0.0.1', 27017, {})),
    test = function (err, collection) {
        collection.insert({ hello : 'world' }, {safe:true}, function(err, docs) {
            collection.count(function(err, count) {
                console.log(count);
            });

            collection.find({ hello : 'world' }).toArray(function(err, results) {
                console.log(results);
            });
        });
    };

client.open(function(err, client) {
    client.collection('test_collection', test);
}); 
```

如果您需要更复杂的功能，请查看[异步](https://github.com/caolan/async)模块。它应该可以帮助您组织许多回调。

# twitter-bootstrap - angularjs引导标签使用

> ID：12251684
> 
> 赞同：7
> 
> 时间：2012-09-03T16:56:59.573
> 
> 标签：twitter-bootstrap, angularjs

我想在[这个](http://jsfiddle.net/johnlindquist/QPbCS/)例子中实现引导选项卡，使用[angularjs bootstrap](https://github.com/angular/angular.js/blob/v1.0.x/src/bootstrap/bootstrap.js) - 它包含指令 tabbable 和 tabPane。它不起作用，我不知道如何让球滚动。

```
<tabbable>
    <tabPane title="first">
        <div ng-controller="FirstCtrl"></div>
    </tabPane>
    <tabPane title="tabbable">
        <div ng-controller="SecondCtrl"></div>
    </tabPane>
</tabbable> 
```

应用程序.js：

```
angular.module('orders_manage', ['orders_manage.services', 'bootstrap'])
.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {

$routeProvider
    .when('/first', { templateUrl:'/partials/first.html', controller:FirstCtrl})
    .when('/second', { templateUrl:'/partials/second.html', controller:SecondCtrl}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T00:55:36.047

如果您查看源代码，您会发现这些指令仅限于类名：[https ://github.com/angular/angular.js/blob/v1.0.x/src/bootstrap/bootstrap.js #L54](https://github.com/angular/angular.js/blob/v1.0.x/src/bootstrap/bootstrap.js#L54)

重写您的示例以使用`<div class="tabbable">`并将`<div class="tab-pane">`解决该问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:06:14.500

这个[plunk](http://plnkr.co/edit/PjuAWn?p=preview)显示了您正在寻找的示例。[在angularjs JsFiddle-Examples wiki](https://github.com/angular/angular.js/wiki/JsFiddle-Examples)上找到的原始链接。

> 使用 ng-view 和 url 作为当前选项卡深度链接的 Angular Bootstrap Tabbable (Andy Joslin)

此外，根据您的用例，您可能需要查看angularjs 主页[http://angularjs.org上的](http://angularjs.org)**Create Components**部分。该部分中的**“component.js”源代码显示了无需**[angularjs bootstrap](https://github.com/angular/angular.js/blob/v1.0.x/src/bootstrap/bootstrap.js)即可快速使选项卡工作的示例代码。如果您需要对功能进行更多控制，可以使用此示例构建自定义解决方案。

# php - Facebook like 按钮创建新页面但不显示正确的 og:title

> ID：12251685
> 
> 赞同：1
> 
> 时间：2012-09-03T16:57:11.047
> 
> 标签：php, facebook-graph-api, facebook-like, facebook-opengraph

我在我的网站上使用 facebook like 按钮，以便用户可以喜欢体育比赛的预测。

我有以下类似按钮的代码：

```
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
<fb:like href="http://www.sportannica.com/games/mlb/1880/predictions/113" show_faces="false" data-send="true" font="verdana" layout="button_count"></fb:like> 
```

在文件的开头，我有以下内容：

```
<meta property="og:title" content="Lance Newman's prediction for the Red Sox @ Yankees game on Friday, August 17" />
<meta property="og:description" content="Lance Newman predicted the Yankees to beat the Red Sox (6 to 4) on Friday, August 17 on Sportannica" />
<meta property="og:image" content="http://www.sportannica.com/img/team_icons/New York Yankees/1947.png" />
<meta property="og:site_name" content="Sportannica" />
<meta property="fb:app_id" content="123456789" />
<meta property="og:url" content='http://www.sportannica.com/games/mlb/1880/predictions/113' />
<meta property="og:restrictions:age" content="13+"/>
<meta property="og:determiner"  content="auto" /> 
```

有人告诉我，点赞按钮触发创建新页面的原因是由于头部有一个 og:type 元标记。我曾经在文档的开头也有以下内容

```
<meta property="og:type" content="sportannica:victory" /> 
```

因为我确实使用此页面来为我的应用程序进行自定义操作。当用户对任何游戏进行预测时，他们的预测会发布在他们的时间线上。

[如果我网站的用户对此处](http://www.sportannica.com/games/mlb/1880/predictions/0)找到的游戏进行了预测，那么在提交表单时，将执行以下代码：

```
$queries = array(
            array("method" => "POST", "relative_url" => "/me/sportannica:predict?victory=http://www.sportannica.com/games/".$league."/".$game."/predictions_post/".$_SESSION['id']."")
        );

        try 
        {
            $postResponseA = $facebook->api('?batch='.json_encode($queries), 'POST');
        } catch (FacebookApiException $e) 
        {
//              echo 'AF error: '.$e.'';
        } 
```

注意在上面的例子中，参数不是等于“predictions”，而是“predictions_post”。

文档的打开图形标签中的内容取决于 url 中的参数设置为“predictions_post”还是“predictions”。

在我的文档的开头，我有以下 php 代码：

```
<meta property="og:title" content="
<?php
if($tab == "predictions_post")
{
    echo "".$winner_short." victory";    
} elseif($tab == "predictions")
{
    if($gram == 1)
    {
        echo "".$first_name." ".$last_name."'s prediction for the ".$away_team_short." @ ".$home_team_short." game on ".$game_date."";
    } else
    {
        echo "Predictions for ".$away_team_short." @ ".$home_team_short." on ".$game_date."";
    }
}
?>
" />
<meta property="og:description" content="
<?php 
if($tab == "predictions_post")
{
    echo "".$first_name." ".$last_name." predicted the ".$winner_short." to beat the ".$loser_short." (".$win_score." to ".$lose_score.") on ".$game_date." on Sportannica"; 
} elseif($tab == "predictions")
{
    if($gram == 1)
    {
        echo "".$first_name." ".$last_name." predicted the ".$winner_short." to beat the ".$loser_short." (".$win_score." to ".$lose_score.") on ".$game_date." on Sportannica"; 
    } else
    {
        echo "Predictions for ".$away_team_short." @ ".$home_team_short." ".$game_date."";
    }
}
?>
 " />
<?php
if($tab == "predictions_post")
{
?> 
<meta property="og:type" content="sportannica:victory" />
<?php
}
?> 
```

但是，即使 URL 中的参数设置为“predictions”并显示正确的打开图形标签，在单击类似按钮时，也会创建一个新页面并显示错误的 og:title。

有什么想法/建议吗？

谢谢，

槊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:01:43.050

> ```
> <meta property="og:type" content="sportannica:victory" /> 
> ```
> 
> 您的 og:type 是否带有 namespace:action 批准的操作？就像facebook批准的胜利行动一样？
> 
> 类型应该是“网站”，或者对于开放图形操作帖子，它应该是 key:value / namespace:action 并且必须批准该操作，否则它将引发错误或被忽略。

* * *

尝试在调试器中运行错误的 URL [https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

# xpath - 为什么这个 xpath 选择器会失败？

> ID：12251686
> 
> 赞同：2
> 
> 时间：2012-09-03T16:57:11.297
> 
> 标签：xpath

给定以下html

```
<p>
    <div class="allpricing">
      <p class="priceadorn">
          <FONT CLASS="adornmentsText">NOW:&nbsp;</FONT>
          <font CLASS="adornmentsText">$1.00</font>
      </p>
    </div>
</p> 
```

为什么

`//div[@class="allpricing"]/p[@class="priceadorn"][last()]/font[@class="adornmentsText"][last()]`

返回 1.00 美元的期望值

但添加`p`元素

`//p/div[@class="allpricing"]/p[@class="priceadorn"][last()]/font[@class="adornmentsText"][last()]`

什么都不返回？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:59:24.453

您不能将 a`div`放在 a`p`中。开始自动`div`关闭。`p`请参阅 [在 <p> 标记内嵌套块级元素......对还是错？](https://stackoverflow.com/q/4291467/1030675)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:11:01.883

我经常发现修复案件是罪魁祸首。XPath 1.0 区分大小写，除非您明确处理混合大小写，否则它在很多情况下都会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:31:21.963

XPath 区分大小写。

**所提供的 XPath 表达式都没有选择任何 node**，因为在所提供的 XML 文档中没有`font`具有命名属性`class`的元素（该元素`font`具有`CLASS`属性，这与具有`class`属性不同，因为大小写不同）。

由于相同的原因，`font`并且`FONT`是具有不同名称的元素。

**这两个 XPath 表达式**在针对提供的 XML 文档进行评估时，会产生相同的预期结果：

```
 //div[@class="allpricing"]
       /p[@class="priceadorn"]
                       [last()]
          /font[@CLASS="adornmentsText"]
                               [last()] 
```

**和**

```
//p/div[@class="allpricing"]
      /p[@class="priceadorn"]
                        [last()]
         /font[@CLASS="adornmentsText"]
                                   [last()] 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  '//div[@class="allpricing"]
       /p[@class="priceadorn"]
                       [last()]
          /font[@CLASS="adornmentsText"]
                               [last()]'/>
=============
  <xsl:copy-of select=
   '//p/div[@class="allpricing"]
          /p[@class="priceadorn"]
                            [last()]
             /font[@CLASS="adornmentsText"]
                                       [last()]
   '/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<p>
    <div class="allpricing">
      <p class="priceadorn">
          <FONT CLASS="adornmentsText">NOW:&#xA0;</FONT>
          <font CLASS="adornmentsText">$1.00</font>
      </p>
    </div>
</p> 
```

**计算这两个表达式，并将此计算的结果复制到输出：**

```
<font CLASS="adornmentsText">$1.00</font>
=============
  <font CLASS="adornmentsText">$1.00</font> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T21:50:23.047

您将源描述为 HTML 而不是 XML 文档，但您没有解释如何解析它。如果您使用 HTML 解析器对其进行解析，解析器将“修复”它以将其转换为有效的 HTML，这意味着它构建的树不会直接反映您在源代码中编写的内容。XPath 看到的是这个“修复”的树，而不是原来的。

# python - 将 pouchdb 与 python 一起使用

> ID：12251687
> 
> 赞同：1
> 
> 时间：2012-09-03T16:57:11.530
> 
> 标签：python, django, couchdb, web2py, pouchdb

我正在研究使用 django 或 web2py 编写的 python 应用程序，并将其用作桌面应用程序。对于数据库，我将远程使用 couchdb 来实现它的复制能力。对于 dektop，我需要找到一种将 pouchdb 集成到应用程序中的方法，但是由于主页没有说要包含 pouchdb.js 文件，所以我找不到任何关于如何将它与 python 一起使用的文档。以及如何设置本地主机到远程服务器同步的一般设置。

我希望有人可以阐明如何完成这项工作。至于 django/web2py，我不确定我想使用哪一个，但已将其缩小到这 2 个。

该应用程序本身的想法是我拥有一个具有所有可用正常功能的网站。并且用户可以从安装程序将软件包本地安装到他们的桌面。该本地副本将具有来自网站的功能子集，并将本地 pouchdb 实例中的一些数据同步到远程服务器。足以在离线时与数据库完全交互。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-20T15:37:51.777

为此，我几天前创建了[Python-PouchDB 。](http://python-pouchdb.marten-de-vries.nl)它通过 PyQt4、PyQt5 或 PySide 在 QtWebKit 中运行 PouchDB（您需要在您的应用程序中附带其中一个），并提供了一个不错的（同步和异步）Python 接口。

您可以通过执行以下命令来安装它：

```
pip install python-pouchdb 
```

（或者只是从您可以在网站上找到链接的源代码中提取 pouchdb 目录。）

示例用法：

```
>>> import pouchdb
>>> environment = pouchdb.setup()
>>> db = environment.PouchDB("test")
>>> db.put({"_id": "mytest"})
{u'ok': True, u'rev': u'...', u'id': u'mytest'}
>>> db["mytest"] #shorthand for db.get()
{u'_rev': u'...', u'_id': u'mytest'}
>>> db.destroy() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T20:34:50.697

PouchDB 在浏览器中运行在 IndexedDB 上，未来计划支持 WebSQL，但总体而言，它建立在浏览器提供的本地数据库功能之上。

如果我理解正确，您希望能够从 Python 访问它吗？我认为这是不可能的，虽然找到一个围绕 JavaScript 引擎的 Python 包装器可能是可能的，但您将无法访问浏览器支持的数据库。

您还应该考虑制作一个[CouchApp](http://couchapp.org/)，尽管这仍然无法让您使用 Django 模板。

基本上，您应该构建应用程序的方式是它只使用基于 JavaScript 的模板（Mustache、Handlebars 等）并使用 REST 接口与您的 API 交互，因此您不必为客户端运行 Python 引擎离线应用。它可能仍然可行，但是如果您必须将大量技术与您的应用程序捆绑在一起，那么下载量将很大。

# regex - R：如何向外搜索向量中的正则表达式？

> ID：12251690
> 
> 赞同：8
> 
> 时间：2012-09-03T16:57:40.533
> 
> 标签：regex, r

是否可以在 R 中搜索向量中的正则表达式，就好像所有元素都是折叠的单个元素一样？如果我们将所有元素折叠成一个来做到这一点，那么在搜索之后就不可能将它们恢复为元素形式。

这是一个向量。

```
vector<-c("I", "met", "a", "cow") 
```

现在，搜索词是“meta”（元素 2 和 3 已折叠）。

假设我的任务是合并搜索字符串所在的两个元素。

所以我期望的是：

```
vector = "I", "meta", "cow" 
```

是否有可能做到这一点？请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T23:16:14.730

如果您想要匹配`"meta"`但不匹配的东西`"taco"`，这将起到作用：

```
myFun <- function(vector, word) {
    D <- "UnLiKeLyStRiNg" 

    ## Construct a string on which you'll perform regex-search
    xx <- paste0(paste0(D, vector, collapse=""), D)

    ## Construct the regex pattern
    start <- paste0("(?<=", D, ")")
    mid <- paste0(strsplit(word, "")[[1]], collapse=paste0("(", D, ")?"))
    end <- paste0("(?=", D, ")")
    pat <- paste0(start, mid, end)

    ## Use it
    strsplit(gsub(pat, word, xx, perl=TRUE), D)[[1]][-1]
}

vector <- c("I", "met", "a", "cow")

myFun(vector, "meta")
# [1] "I"    "meta" "cow" 
myFun(vector, "taco")
# [1] "I"   "met" "a"   "cow"
myFun(vector, "Imet")
# [1] "Imet" "a"    "cow" 
myFun(vector, "Ime")
# [1] "I"   "met" "a"   "cow" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:52:22.113

如果只合并完整的元素，您可以尝试这种方法：

```
mergeRegExpr <- function(x, pattern) {
    str <- paste(x, sep="", collapse="")

    ## find starting position of each word
    wordStart <- head(cumsum(c(1, nchar(x))), -1)

    ## look for pattern
    rx <- regexpr(pattern=pattern, text=str, fixed=TRUE)

    ## pos of matching pattern == rx+nchar(pattern)-1
    rxEnd <- rx+attr(rx, "match.length")-1

    ## which vector elements doesn't match pattern
    sel <- wordStart < rx | wordStart > rxEnd

    ## insert merged elements
    return(append(x[sel], paste(x[!sel], collapse=""), rx-1))
}

vector <- c("I", "met", "a", "cow")

mergeRegExpr(vector, "meta")
# "I"    "meta" "cow"
mergeRegExpr(vector, "acow")
# "I"    "met"  "acow"
mergeRegExpr(vector, "Imeta")
# "Imeta" "cow"

## partial matching doesn't work    
mergeRegExpr(vector, "taco")
# "I"       "metacow" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T17:27:30.477

基于 Carl Witthoft 的评论，我的解决方案不是使用正则表达式，而是使用基本匹配：

```
# A slightly longer vector
v = c("I", "met", "a", "cow", "today",
      "You", "met", "a", "cow", "today")

# Create the combinations of each pair
temp1 = sapply(1:(length(v)-1), 
               function(x) paste0(v[x], v[x+1]))

# Grab the index of the desired search term
temp2 = which(temp1 %in% "meta")
# The following also works.
# Don't know what's faster/better.
# temp2 = grep("meta", temp1)

# Do some manual substitution and deletion
v[temp2] <- "meta"
v <- v[-(temp2+1)] 
```

我认为这根本不是一个理想的情况。

# java - Android Facebook sdk，sharedPreferences 永远不会改变？

> ID：12251691
> 
> 赞同：1
> 
> 时间：2012-09-03T16:57:59.180
> 
> 标签：java, android, facebook, sharedpreferences

这是我的代码：

```
 mPrefs = getSharedPreferences("facebook_session",MODE_PRIVATE);
    String access_token = mPrefs.getString("access_token", null);
    long expires = mPrefs.getLong("access_expires", 0);

    if(access_token != null) {
        facebook.setAccessToken(access_token);
        Log.i("access_token","facebook.setAccessToken(access_token), and access_token=="+access_token);

    }
    if(expires != 0) {
        Log.i("expires","facebook.setAccessToken(access_token), and expires=="+expires);
        facebook.setAccessExpires(expires);
    }

    /*
     * Only call authorize if the access_token has expired.
     */

    if(!facebook.isSessionValid()) {
    Log.v("in !facebook.isSessionValid()", "no pref");

    facebook.authorize( this, new String[] { "email", "publish_checkins" }, new DialogListener(){
        @Override
        public void onComplete(Bundle values) {
            Log.v("facebook.authorize", "no pref");
            Log.v("postToWall","mFacebook.getAccessToken(): "+facebook.getAccessToken());
            Log.v("postToWall","mFacebook.getAccessExpires(): "+facebook.getAccessExpires());

            SharedPreferences.Editor editor = mPrefs.edit();
            editor.putString("access_token", facebook.getAccessToken());
            editor.putLong("access_expires", facebook.getAccessExpires());
            editor.commit();

        }
        @Override
        public void onFacebookError(FacebookError e) {
            Log.v("facebook.authorize","mFacebook.onFacebookError(): "+e);
        }
        @Override
        public void onError(DialogError e) {
            Log.v("facebook.authorize","mFacebook.onFacebookError(): "+e);
            Log.v("facebook.authorize","mFacebook.onError(): "+facebook.getAccessToken());
        }
        @Override
        public void onCancel() {
            Toast.makeText(getApplicationContext(),
                    "You must be registered and signed in to perform that action",
                    Toast.LENGTH_LONG).show();
            finish();
            // onCancel, leaving the app
        }
    });   
    }//end of pref check 
```

在注销功能中，我尝试从 facebook 注销并清除 sharedPreferences：public void Logout(View view){

```
 String access_token = mPrefs.getString("access_token", null);
      Log.i("access_token","mPrefs.getString(access_token, null), and access_token=="+access_token);

      SharedPreferences.Editor editor = mPrefs.edit();
      editor.remove("access_token");
      editor.remove("access_expires");
      editor.commit();
      Log.i("access_token","mPrefs.getString(access_token, null), and access_token=="+access_token);

      mAsyncRunner = new AsyncFacebookRunner(facebook); // initialize AsyncRunner, make sure it's not null
      mAsyncRunner.logout(Login.this, new RequestListener() {
          @Override
          public void onComplete(String response, Object state) {
              finish();
          }

          @Override
          public void onIOException(IOException e, Object state) {}

          @Override
          public void onFileNotFoundException(FileNotFoundException e,
                Object state) {}

          @Override
          public void onMalformedURLException(MalformedURLException e,
                Object state) {}

          @Override
          public void onFacebookError(FacebookError e, Object state) {}
        });
  } 
```

所以，问题来了：无论我多么努力，sharedPreferences 中存储的值都没有改变。我试过 clear()、remove()、commit()、apply() 等.....请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T22:04:30.817

```
 Log.i("access_token","mPrefs.getString(access_token, null), and access_token=="+access_token); 
```

如果您使用此`Log`语句来验证存储的值是否`SharedPreferences`被清除，则说明您没有正确执行。

您`access_token`的值在您删除它之前被分配了一个值，因此当您引用该变量时，它仍将保留该值。要正确测试该值是否已从 中删除`SharedPreferences`，您需要在删除该值后再次尝试访问该值，方法是在命令后执行以下*操作*`editor.commit()`：

```
String access_token_2 = mPrefs.getString("access_token", null);
Log.i("access_token", "access_token from SharedPreferences is now " + access_token_2); 
```

# mysql - 了解 MYSQL 联接

> ID：12251692
> 
> 赞同：0
> 
> 时间：2012-09-03T16:58:16.133
> 
> 标签：mysql, database, join, relational-database

我对了解 MYSQL JOINS 感到非常沮丧

我尝试了很多，但我无法理解连接是如何工作的，我什至在[W3SCHOOLS](http://www.w3schools.com)网站上研究过连接。我知道黑白内部连接、完全连接、左连接和右连接的区别。我注意到了那里的语法和以为我现在知道加入了。
但是，当我需要在实际中实现它们时，我不知道如何实现。我需要更详细地理解它，这只是我想出来的一点。

因此，如果有人可以帮助我理解 mySQL 连接，请。请帮帮我。我想很快看到自己成为一个完美的程序员。

提前接受我的感谢......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:04:47.807

这是一个很好的视觉解释： http: [//www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:03:56.470

试试这个[http://beginner-sql-tutorial.com/sql-joins.htm](http://beginner-sql-tutorial.com/sql-joins.htm)

**SQL 连接**

SQL 连接用于关联不同表中的信息。连接条件是从两个或多个表中检索行的 sql 查询的一部分。SQL Join 条件用于 select、update、delete 语句的 SQL WHERE 子句中。

连接两个表的语法是：

```
SELECT col1, col2, col3...
FROM table_name1, table_name2
WHERE table_name1.col2 = table_name2.col1; 
```

# android - Android 来电事件

> ID：12251694
> 
> 赞同：2
> 
> 时间：2012-09-03T16:58:21.343
> 
> 标签：android

我想做一个 onCall 事件，我已经知道没有这样的方法，但基本上我想做的是：

当接到来电时，弹出吐司（或其他任何东西）

任何类型的教程或示例代码都会有所帮助。

多谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T17:03:49.787

使用`PhoneStateListener`which has overrided 方法`onCallStateChanged`您可以在那里使用 3 个状态

[示例链接](http://mfarhan133.wordpress.com/2010/10/15/manipulating-incoming-ougoing-calls-tutorial-for-android/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:02:02.250

为此，您需要使用`PhoneStateListener`

看到这个[问题](https://stackoverflow.com/q/1853220/1289716)你会知道如何使用。

也试试这个[演示](http://marakana.com/forums/android/examples/62.html)

# javascript - Javascript/jQuery 重定向到页面

> ID：12251695
> 
> 赞同：0
> 
> 时间：2012-09-03T16:58:24.983
> 
> 标签：javascript

我正在使用 simplecart js。这是一个非常简单的商店，只有一种产品。当有人单击添加到购物车按钮时，我想自动重定向到购物车页面。

添加产品的代码：

```
<div class="simpleCart_shelfItem">
<h2 class="item_name"> Awesome T-shirt </h2>
<p>  <input type="text" value="1" class="item_Quantity"><br>
<span class="item_price">$35.99</span><br>
<a class="item_add" href="javascript:;"> Add to Cart </a></p>
</div> 
```

simpleCart.js 中的监听器：

```
/* here is our shelfItem add to cart button listener */
                , { selector: 'shelfItem .item_add'
                    , event: 'click'
                    , callback: function () {
                        var $button = simpleCart.$(this),
                            fields = {};

                        $button.closest("." + namespace + "_shelfItem").descendants().each(function (x,item) {
                            var $item = simpleCart.$(item);

                            // check to see if the class matches the item_[fieldname] pattern
                            if ($item.attr("class") &&
                                $item.attr("class").match(/item_.+/) &&
                                !$item.attr('class').match(/item_add/)) {

                                // find the class name
                                simpleCart.each($item.attr('class').split(' '), function (klass) {
                                    var attr,
                                        val,
                                        type;

                                    // get the value or text depending on the tagName
                                    if (klass.match(/item_.+/)) {
                                        attr = klass.split("_")[1];
                                        val = "";
                                        switch($item.tag().toLowerCase()) {
                                            case "input":
                                            case "textarea":
                                            case "select":
                                                type = $item.attr("type");
                                                if (!type || ((type.toLowerCase() === "checkbox" || type.toLowerCase() === "radio") && $item.attr("checked")) || type.toLowerCase() === "text") {
                                                    val = $item.val();
                                                }               
                                                break;
                                            case "img":
                                                val = $item.attr('src');
                                                break;
                                            default:
                                                val = $item.text();
                                                break;
                                        }

                                        if (val !== null && val !== "") {
                                            fields[attr.toLowerCase()] = fields[attr.toLowerCase()] ? fields[attr.toLowerCase()] + ", " +  val : val;
                                        }
                                    }
                                });
                            }
                        });

                        // add the item
                        simpleCart.add(fields);
                    }
                }
            ]);
        }); 
```

根据我的阅读，使用 href="javascript:;" 是不好的做法 将其更改为将项目添加到购物车然后转到购物车页面或仅添加重定向的点击功能是一个好主意吗？我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:08:20.570

我不确定 simplecart APi 是如何工作的，但您可以尝试以下操作：

```
// add the item
simpleCart.add(fields);
window.location='/cart/'; // change to your cart route 
```

如果购物车保存到服务器 cookie，您可能需要将其放入回调中。

# java - 传递集合 进入一个期待 Collection 的函数 在 Java 中失败

> ID：12251696
> 
> 赞同：0
> 
> 时间：2012-09-03T16:58:34.783
> 
> 标签：java, inheritance, collections

> **可能重复：**
> [将 List<SubClass> 转换为 List<BaseClass> 的最有效方法](https://stackoverflow.com/questions/5082044/most-efficient-way-to-cast-listsubclass-to-listbaseclass)
> [为什么多态性不会以相同的方式处理泛型集合和普通数组？](https://stackoverflow.com/questions/10770585/why-polymorphism-doesnt-treat-generic-collections-and-plain-arrays-the-same-way)

如果我有一个抽象基类`BaseClass`并且我编写了一个期望作为其参数的函数，那么使用类的 a`Collection<BaseClass>`调用该函数将无法编译。`Collection<SubClass>``SubClass extends BaseClass`

在基类中：

```
public void addLots(Collection<BaseClass> collection) {
    for(BaseClass yourbase : collection) {
        us.add(yourbase) //what you say!!
    }
} 
```

在子类中：

```
public void addMoreLots(Collection<SubClass> collection) {
    addLots(collection); //FAILS TO COMPILE
} 
```

现在我想我明白为什么会这样`Collection<SubClass>`了：不是`Collection<BaseClass>`. 进行此调用的*正确方法是什么？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:34:41.403

在紧要关头，`Collections.unmodifiableCollection(Collection<SubClass>)`可以返回一个`Collection<BaseClass>`. （当然，它使集合不可修改，但这就是将 a`Collection<SubClass>`视为 a 的安全原因`Collection<BaseClass>`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:00:08.993

`<? extends BaseClass>`应该替换`<BaseClass>`. 的正确语法`addLots`是：

```
public void addLots(Collection<? extends BaseClass> collection) {
    for(BaseClass yourbase : collection) {
        us.add(yourbase) //what you say!!
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:01:42.383

`Collections`**仅在编译时和运行时进行检查**`not`，因此**这样**做是为了**保护一个包含错误类型对象的集合。**

试试这个方法...

`public <T extends BaseClass> void addLots(Collection<T> collection){ }`

**或者**

`public void addLots(Collection<? extends BaseClass> collection) {}`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T17:04:37.907

您可以使用

```
public void addLots(Collection<? extends BaseClass> collection) {
} 
```

代替

```
public void addLots(Collection<BaseClass> collection) {
} 
```

这表示`Collection`扩展基类的类型可以是参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T18:02:26.013

```
public void addLots(Collection<? extends BaseClass> collection) {
} 
```

但是有了这个你不能调用添加到集合（即你不能这样做`collection.add()`），
但是在这个

```
public void addLots(Collection<? super SubClass> collection) {
} 
```

你可以调用 add （即你可以做`collection.add()`）。

# .net - 无法使用 EF5 和 VS 2010 加载文件或程序集“Microsoft.SqlServer.Types”

> ID：12251698
> 
> 赞同：4
> 
> 时间：2012-09-03T16:59:02.953
> 
> 标签：.net, entity-framework-4

我有一个使用 EF 4.3 和 Visual Studio 2010 运行的 .NET Framework 4 项目。我已将该项目升级到 EF 5 并在我的开发机器上安装了 .NET Framework 4.5。运行我的项目时，我现在收到“无法加载文件或程序集'Microsoft.SqlServer.Types，版本 = 11.0.0.0”

我没有使用 EF5 的任何新功能或 .NET Framework 4.5 的新功能。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T09:14:17.113

我找到了解决方案！只需安装 nuget 包 Microsoft.SqlServer.Types

```
PM> Install-Package Microsoft.SqlServer.Types 
```

接着

解决方案 > 参考 > System.Data.Entity > 属性 > 复制本地，并将其设置为 True。

注意： Microsoft.SqlServer.Types 的 Copy Local 已设置为 true，即使问题出在 System.Data.Entity 上，错误消息仍然与 Microsoft.SqlServer.Types 有关。

# jquery - 如何基于 img src 创建新属性并将原始 src 值用于另一个？

> ID：12251699
> 
> 赞同：0
> 
> 时间：2012-09-03T16:59:20.130
> 
> 标签：jquery

我想使用延迟加载，它需要一个名为“data-original”的属性，该属性指向原始图像 src 值。我可以像这样使用来自 src attr 的值创建新的“原始数据”，而不会出现问题：

```
 $('img.lazy').each(function() {
    a =  $(this).attr("src");
        $(this).attr("data-original", a);
   }); 
```

但是，如果我遵循这个（延迟加载需要 src 值）：

```
 $('img.lazy').each(function() {
    b =  "img/grey.gif";
        $(this).attr("src", b);
   }); 
```

data-original 和 src atrr 都变成“img/grey.gif”

来自新手的感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:10:43.930

您可以将两者放在同一个循环中。即使认为这在这里可能不是问题，如果您不使用名为 a 的全局变量，您通常应该使用“var a = ...”。

```
$('img.lazy').each(function() {
   $(this).attr("data-original", $(this).attr("src"));
   $(this).attr("src", "img/grey.gif");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:23:58.560

出于安全原因，某些（或可能全部？）浏览器不允许使用 jQuery`.attr()`方法更改 DOM 元素的某些属性。如果是这种情况，您可以使用以下方法。

```
$('img.lazy').each(function() {
    $(this).attr("data-original",$(this).attr("src"));
    $(this)[0].src = "img/grey.gif";
    // or $(this).get(0).src = "img/grey.gif";
}); 
```

**[编辑]**

换了顺序：

```
$('img.lazy').each(function() {
    var src = $(this).attr("src");
    // assign the initial src value to temp var
    $(this)[0].src = "img/grey.gif";
    // or $(this).get(0).src = "img/grey.gif";
    $(this).attr("data-original",src);
}); 
```

我不熟悉延迟加载。它有可能会替换元素而不是更改它们的属性值。如果是这种情况，那么您将需要采取不同的路径。

**[结束编辑]**

不过，我不确定这是否是您的问题。

# multithreading - 用于线程和进程同步的信号量和互斥量

> ID：12251701
> 
> 赞同：1
> 
> 时间：2012-09-03T16:59:25.073
> 
> 标签：multithreading, posix, mutex, semaphore

我对线程和进程级别的信号量和互斥锁的使用感到困惑。我们可以在线程和进程同步中使用信号量和互斥量，还是在线程和进程级别都有不同的信号量和互斥量？我的问题是关于 POSIX API 的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:17:21.473

这两个问题的答案都是肯定的。您可以将互斥锁和信号量创建为进程共享或不共享。因此，您可以将它们用作进程间或线程间同步对象，但您必须在创建它们时指定哪个。

当然，您必须在所有希望访问它的上下文共享的内存中创建同步对象。对于线程，这是微不足道的，因为它们共享内存视图。对于进程，您必须专门在共享内存中创建同步对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T22:58:29.887

当元素共享数据或必须对它们的任务进行排序时，同步可以保护元素。

进程和线程基本上是相同的（有区别）它们是使某些工作起作用的计算片段，您唯一需要注意的是当您使用进程时以及使用线程时，但使用的方法是相同的。

# java - 如何在 Eclipse 跨平台 Libgdx 项目中更改 android 活动

> ID：12251706
> 
> 赞同：1
> 
> 时间：2012-09-03T16:59:41.720
> 
> 标签：java, eclipse, libgdx

大家好，我有问题。

我想在我的 LibGDX 游戏中使用 Scoreloop 系统。所以我想将 Libgdx Android Activity 更改为 Scoreloop Activity。问题是 Libgdx 抽象层不在 Android Eclipse 项目中 - Libgdx 共享 Eclipse 桌面项目和 Android Eclipse 项目。主要的游戏逻辑来自 Android Eclipse 项目。

总结 - 如何在跨平台 Libgdx eclipse 项目中更改 android 活动的最简单方法。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T17:25:53.997

您必须将 android 特定代码放在 libgdx android 项目中。

查看[http://decisiontreegames.wordpress.com/2012/03/17/writing-android-specific-code-in-libgdx/](http://decisiontreegames.wordpress.com/2012/03/17/writing-android-specific-code-in-libgdx/)以获得更好的集成模型。

# c# - 声明空字节 - Nullable 对象必须有一个值？

> ID：12251711
> 
> 赞同：2
> 
> 时间：2012-09-03T17:00:00.873
> 
> 标签：c#, linq, byte

我对 C# 还是很陌生，如果对我的代码有任何帮助，我将不胜感激。

我正在创建一个用户个人资料页面，并且在“photo = (byte)user.Photo;”上收到错误“Nullable object must have a value” 在下面的代码中。我认为这是因为我声明了“photo = 0;” 如何为其添加价值？

更新：

这是整个方法

```
 public static bool UserProfile(string username, out string userID, out string email, out byte photo)
    {

        using (MyDBContainer db = new MyDBContainer())
        {

            userID = "";
            photo = 0;
            email = "";
            User user = (from u in db.Users
                         where u.UserID.Equals(username)
                         select u).FirstOrDefault();
            if (user != null)
            {
                photo = (byte)user.Photo;
                email = user.Email;
                userID = user.UserID;
                return true; // success!
            }
            else
            {
                return false;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T11:31:57.500

我假设你在这个错误...

```
 if (user != null)
        {
            photo = (byte)user.Photo;
            email = user.Email;
            userID = user.UserID;
            return true; // success!
        }
        else
        {
            return false;
        } 
```

如果是，那么只需将其替换为...

```
 if (user != null)
        {
            photo = user.Photo== null ? null : (byte)user.Photo;
            email = user.Email;
            userID = user.UserID;
            return true; // success!
        }
        else
        {
            return false;
        } 
```

# php - PHP：每隔一行应用CSS

> ID：12251712
> 
> 赞同：1
> 
> 时间：2012-09-03T17:00:02.797
> 
> 标签：php, html, html-table, row

> **可能重复：**
> [如何在 php 中为迭代表设置备用行颜色？](https://stackoverflow.com/questions/2570925/how-to-set-alternate-row-color-for-an-iterated-table-in-php)
> [对列表项使用 CSS :even 和 :odd 伪类](https://stackoverflow.com/questions/5080699/using-css-even-and-odd-pseudo-classes-with-list-items)

我有一个 html 表，其中填充了 mysql 表中的数据。我使用以下代码：

```
$result = mysql_query("SELECT * FROM {$table}");
if (!$result) {
die("Query to show fields from table failed");
}

$fields_num = mysql_num_fields($result);

echo "<h1>Table: {$table}</h1>";
echo "<tr>";

echo "</tr>\n";

while($row = mysql_fetch_row($result))
{
echo "<tr>";

foreach($row as $cell)
    echo "<td>$cell</td>";

echo "</tr>\n";
}
mysql_free_result($result); 
```

**注意：**我通常使用 PDO 语句，但在本例中我使用 mysql。

代码正确生成表。问题是：我想对每隔一行应用一个 CSS，如下`class=table_higlight`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:06:50.323

利用：

```
$i = 0;
while($row = mysql_fetch_row($result)) {
  if ($i % 2 == 0 )
    echo '<tr class="even">';
  else
    echo '<tr class="odd">';

  foreach($row as $cell)
    echo "<td>$cell</td>";

  echo "</tr>\n";
  $i++
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:01:37.523

```
while($row = mysql_fetch_row($result))
{
echo "<tr".(++$ctr%2 == 0 ? ' class="table_highlight"' : '').">";

foreach($row as $cell)
    echo "<td>$cell</td>";

echo "</tr>\n";
} 
```

# php - 从 Codeigniter 模板部分读取数据以及控制器重定向时出现问题

> ID：12251715
> 
> 赞同：1
> 
> 时间：2012-09-03T17:00:13.403
> 
> 标签：php, codeigniter, templates, redirect, partials

我有两个不相关的 Codeigniter 问题：

(a) 我试图在成功登录后将用户重定向到仪表板。即从控制器“auth”到控制器“dashboard”。出于某种奇怪的原因，它一直重定向到 auth/dashboard（404 错误，因为它不存在）。

这就是我所做的：

```
//Within the auth controller    
    if ($this->auth->login($username, $password)) //Auth->login returns boolean
    {
    redirect('/dashboard', 'refresh');
    # redirect('/dashboard', 'location');  // I tried this too
    # redirect('/dashboard/index', 'refresh');   // I also tried this!
    } 
```

请问我做错了什么？它只是不断重定向到 auth/dashboard

(b) 我正在使用 Phil Sturgeon 出色的 Codeigniter 模板库（没有解析器），我无法接收发送到部分文件中的数据。仅部分文件需要此数据。我已经浏览了（不幸的是稀疏的）库文档、关于该主题的 S/O 帖子以及 CI 论坛，但均无济于事，似乎没有明确的示例显示部分如何接收控制器分配给它的数据.

这就是我一直在做的事情。请告诉我我一定做错了什么。

```
// In the controller page
$this->data['user'] = array('info' => 'username', 'value' => 'Cogicero');
$this->data['prefs'] = array('foo' => 'bar');
$this->template
     ->set_partial('header', 'partials/header', $this->data)
     ->set_layout('blog')
     ->build('foobar_view'); 
```

和

```
 //In the header partials page
        <?php
        /* snip */
        print_r($data);
        print_r($prefs);
        print_r($user);
        echo $user["info"];
        echo $prefs["foo"];
        ?> 
```

以上都产生“数组不存在”或“未定义变量”错误！我打算如何在部分视图文件中接收数据？

谢谢

**编辑：在紧迫的期限内工作，因此没有解决方案，我不得不放弃 Phil Sturgeon 的模板库，转而选择 Jens Segers 的。[http://www.jenssegers.be/blog/25/Codeigniter-template-library](http://www.jenssegers.be/blog/25/Codeigniter-template-library) 它有点类似于菲尔的，但由于某种原因，部分正在正确接收和呈现我的数据。此外，Sergers 的模板库有很好的文档记录。现在一切都很好，所以我会接受我自己对问题 (a) 的回答。感谢大家。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:48:34.990

(a) 所以经过大量的摆弄，我已经解决了第一个问题，即重定向。

在配置文件中，我们有

```
| If this is not set then CodeIgniter will guess the protocol, domain and
| path to your installation.
|
*/
$config['base_url']= 
```

显然，我没有设置基本 URL，因为我仍在开发本地服务器上，我将在上传到测试服务器时将其设置为 www 地址。Codeigniter 一直在*猜测*，但猜测对我的身份验证重定向不起作用。我设置了基本网址，所有重定向都很好。

(b) 现在，看看为什么部分视图没有接收到数据。请问有什么帮助吗？:(

# ruby - 有没有办法让 ruby installer 与 cygwin 配合得很好？

> ID：12251718
> 
> 赞同：7
> 
> 时间：2012-09-03T17:00:23.127
> 
> 标签：ruby, windows, cygwin, rake

我无法让 jekyll 在 Windows 7 64 位上使用 cygwin 与 Ruby 一起工作。使用 ruby​​installer + devkit 我得到了更好的结果。如果我可以在 cygwin 中使用 ruby​​installer ruby​​，那就太好了。

但是，当我尝试执行 rake 时收到以下消息。

```
$ rake 页面名称="pages/about.md"
C:\Ruby193\bin\ruby.exe: 没有这样的文件或目录 -- /cygdrive/c/Ruby193/bin/rake (LoadError)

```

有什么方法可以让 ruby​​installer 与 cygwin 配合得很好？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-04T00:58:18.167

我只是将其中一些放在我的 .bash_profile 中：

```
alias gem=gem.bat
alias irb=irb.bat
alias rake=rake.bat 
```

我从来没有遇到过 Luis 提到的任何问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T18:14:26.920

问题是 cygwin 将所有脚本路径转换为 ​​cygwin 路径（`/cygdrive/...`）。

对此没有解决方案，因为脚本的调用是由 bash over`rake`调用本机 Ruby 的脚本制成的。

cygwin 会导致许多其他问题，其中一些在[RubyInstaller 故障排除页面中进行了介绍](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-cygwin)

一种替代方法是直接调用`rake.bat`，跳过 cygwin shebang 检测。

但是 cygwin 不喜欢批处理文件，这会迫使您这样做`cmd.exe /C rake.bat`，这是一个嘈杂的命令行。

另一种选择是安装[gem-exefy](https://github.com/bosko/gem-exefy) ( `gem install gem-exefy`) 之类的东西并为您安装的 gem ( ) 生成可执行文件`rake.exe`。

这样你调用`rake.exe`而不是让 cygwin 弄清楚。

另一种选择是使用 MSYS Bash（包含在 DevKit 中）而不是 cygwin，它比 cygwin 更好，但批处理文件仍然存在问题。

如您所见，将非本地 (cygwin) 与本地 (RubyInstaller) 混合会产生很多副作用。

# java - 如何检查 JSONArray 元素是否为空

> ID：12251729
> 
> 赞同：13
> 
> 时间：2012-09-03T17:01:13.723
> 
> 标签：java, json, arrays

我不知道如何确定 json 数组中的元素是否为空。要检查 jsonObject 本身是否为空，只需使用：

```
jsonObject.isNullObject(); 
```

但是当对象是一个数组并且我想检查该数组的元素之一是否为空时，这不起作用：

```
jsonArray.get(i).get("valueThatIsNull") == null; 
```

数组元素也没有可用的 isNull 方法。如何检查 jsonarray 中的值是否为空？知道我正在从 javascript 传递一个空对象可能会有所帮助。当从 javascript 以 json 格式传递 null 时，它在 java 中的含义可能并不相同，但我也尝试在 null 周围加上括号，但它仍然不起作用。

我发布了一些实际的源代码以帮助使这一点更清楚。jsonObject 是 jsonArray 的一部分，并且该对象具有多个值，因为它本身就是一个对象。

```
JSONObject mapItem = jsonArray.getJSONObject(i);
int id = mapItem.has("id") ? mapItem.getInt("id") : -1;
DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
java.util.Date date = null;
Date sqlDate = null;
if(mapItem.has("date")) {
    String dateStr = mapItem.getString("date");
    if(!dateStr.equals("null")) {
    date = dateFormat.parse(mapItem.getString("date").substring(0, 10)); //Convert javascript date string to java.
    sqlDate = new Date(date.getTime());
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-15T23:40:40.293

尝试`.isNull()`：

对于您的示例：

```
if(!mapItem.isNull("date")) {
    //Value is not null
} 
```

但是，要回答这个问题的标题“如何判断 JSONArray 元素是否为空”，请使用`.equals()`

因此，要检查索引 1 是否为空：

```
if (!jsonArray.get(1).equals(null)) {
    //jsonArray[1] is not null
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-04T01:44:57.643

我猜 json 将 null 值作为字符串传递，因此您不能将 null 作为 java 元素进行检查。而是将 null 值视为字符串，以这种方式进行检查：

```
if(!mapItem.getString("date").equals("null")) {
    //Value is not null
} 
```

我已将原始问题中的代码片段更新为工作版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-03T07:32:59.760

试试 JSONArray 的方法

```
public boolean isNull (int index) 
```

实际上，它使用“null”字符串与内容进行比较

```
JSONObject.NULL.equals(this.opt(index)); 
```

# mono - 放弃 Beagle 的原因是什么，CPU 使用率高还是 RAM 使用率高？

> ID：12251732
> 
> 赞同：1
> 
> 时间：2012-09-03T17:01:41.320
> 
> 标签：mono, lucene, lucene.net

我正在计划一个用于搜索本地文本文档（PDF、odt、txt、doc...）的新软件，并且我会使用被遗弃的 Beagle 中的一些代码。

但怕是因为不知道被抛弃的原因……

有谁记得或者可以给我建议吗？

我认为 beagle 是一个很好的 LUCENE.NET 实现。它有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:20:14.643

在推特上向 Miguel de Icaza 发布问题后，他回应道：

> 米格尔·德伊卡萨‏@migueldeicaza
> 
> @AlbertCSharpMan 由于反 Mono 的火焰战，让黑客失去了动力，留给了其他公司。Linux 桌面退资，政治。

所以，不是编码或程序问题......

# compiler-construction - 从类型表到符号表的引用

> ID：12251735
> 
> 赞同：-2
> 
> 时间：2012-09-03T17:01:42.650
> 
> 标签：compiler-construction, symbol-tables

我们都知道从符号表到类型表总是有一个引用，但也可能发生反例。意味着可以将类型表引用返回到符号表吗？如果是，请举例说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:17:06.653

如果你定义了一个新类型，你通常会给它一个名字，所以这个名字，作为一个符号，会从类型表中被引用。

# c# - 如何动态确定对象属性名

> ID：12251739
> 
> 赞同：2
> 
> 时间：2012-09-03T17:01:54.357
> 
> 标签：c#

我有一个对象用户：

```
 public class User
    {

        public String Name { get; set; }

        public String Name2 { get; set; }

        public String Name3 { get; set; }

    } 
```

此外，我还有一组键值字符串，我想在创建对象时将其分配给对象的属性：

```
'Name':'srgrgsdfsdf'
'Name3':'dsfdsfafafd'
'Name2':'dtewtwerwer'
'Name4':'546353452552' 
```

现在我像这样创建我的对象

```
 User user = new User();

  user.Name = "zzxasdas"; 
```

问题是我希望能够动态分配键/值数据。这意味着某些项目可能会丢失或顺序可能不同。

如何动态检查对象属性的名称并将其与 Key 进行比较，如下所示：？

```
foreach [key] in Key/Value 
if [user] has property named [key] 
add [value] to [user] property with the name [key] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:03:34.260

您需要使用[反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.100%29.aspx)来执行此操作。

特别是，[`Type.GetProperties`](http://msdn.microsoft.com/en-us/library/system.type.getproperties)或[`Type.GetProperty`](http://msdn.microsoft.com/en-us/library/system.type.getproperty.aspx)将允许您发现有关在类型上定义的属性的信息，并获取或设置它们的值。

这可能看起来像：

```
User user = new User();

Type t = user.GetType();
foreach(var kvp in propertyDictionary)
{
    var prop = t.GetProperty(kvp.Key);
    if (prop != null)
       prop.SetValue(user, kvp.Value);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:07:42.490

我想到了两件事。

一种显然是使用[反射](http://msdn.microsoft.com/en-us/library/f7ykdhsy.aspx)API。例如，如果 user.GetType().GetProperty() 等。

其次，[AutoMapper](https://github.com/AutoMapper/AutoMapper)可能是一种解决方案，它可以将属性从一个对象复制到另一个具有相同名称的对象

# spring - 当我扩展它时，弹簧控制器不起作用

> ID：12251743
> 
> 赞同：0
> 
> 时间：2012-09-03T17:02:19.657
> 
> 标签：spring, model-view-controller, controller

我尝试用一​​些方法制作一个通用控制器，所以我不需要重写通用代码，但不工作，为什么？？？

```
@Controller("/home/teste")
public class CtrlTeste extends ControladorGenericoSpring<Assistenciado>
{
public String path;

    public CtrlTeste()
    {
       super(Assistenciado.class);
       path = "/home/teste";
       setPacoteServico("servico.assistenciado");
       setPrefixo("Serv");
       setNomeEntidade("Assistênciado");        

    }

   @RequestMapping
   public String teste(@RequestParam(value = "id", required= true)Long id, Model model)
   {
      Assistenciado ass = getServico().buscarPorId(id);
      model.addAttribute("assistenciado", ass);
      return "/home";
   }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:05:21.683

您当前正在指定 bean 的名称。尝试：

```
@Controller
@RequestMapping("/home/teste")
public class CtrlTeste extends ControladorGenericoSpring<Assistenciado> {
    ...
} 
```

# java - 使用 IP 身份验证的 Java Bloomberg API

> ID：12251746
> 
> 赞同：0
> 
> 时间：2012-09-03T17:02:36.067
> 
> 标签：java, bloomberg

我正在尝试编写一些代码来远程从我的彭博终端远程获取一些基本参考数据。这可能吗？我有两台单独的 PC 的设置。PC-1 上运行 Bloomberg，PC-2 没有。在 PC-2 上不安装 Bloomberg 的情况下，有没有一种方法可以让 Java 应用程序提供 PC-1 的 IP+用户身份凭证并获取一些基本参考数据？示例代码非常感谢。我在 BB API 中看到了 AuthenticationByIp.java，但我无法让它工作。我不认为这是我要找的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:26:28.530

我不认为你可以通过直接从 PC2 调用 API 来做到这一点。

您可以在 PC1 上运行将查询从 PC2 中继到 API 的服务，但这将违反您的 Bloomberg 合同，因为您只能使用从安装了 Bloomberg 终端的 PC 上的 API 获得的数据.

# php - 更改返回帖子的顺序

> ID：12251748
> 
> 赞同：1
> 
> 时间：2012-09-03T17:02:46.697
> 
> 标签：php, wordpress, posts

我为我的 Wordpress 特色文章编写了一个简洁的响应式滑块（请随意使用）：

```
<?php 
    $responsive = 'on' != get_option('henrik_responsive_layout') ? false : true;
    $featured_auto_class = '';
    if ( 'on' == get_option('henrik_slider_auto') ) $featured_auto_class .= ' et_slider_auto et_slider_speed_' . get_option('henrik_slider_autospeed');
?>
<div id="featured" class="<?php if ( $responsive ) echo 'flexslider' . $featured_auto_class; else echo 'et_cycle'; ?>">
    <a id="left-arrow" href="#"><?php esc_html_e('Previous','henrik'); ?></a>
    <a id="right-arrow" href="#"><?php esc_html_e('Next','henrik'); ?></a>

<?php if ( $responsive ) { ?>
    <ul class="slides">
<?php } else { ?>
    <div id="slides">
<?php } ?>
        <?php global $ids;
        $ids = array();
        $arr = array();
        $i=0;

        $featured_cat = get_option('henrik_feat_cat'); 
        $featured_num = (int) get_option('henrik_featured_num'); 

        if (get_option('henrik_use_pages') == 'false') query_posts("showposts=$featured_num&cat=".get_cat_ID($featured_cat));
        else {
            global $pages_number;

            if (get_option('henrik_feat_pages') <> '') $featured_num = count(get_option('henrik_feat_pages'));
            else $featured_num = $pages_number;

            query_posts(array
                            ('post_type' => 'page',
                            'orderby' => 'menu_order',
                            'order' => 'ASC',
                            'post__in' => (array) get_option('henrik_feat_pages'),
                            'showposts' => (int) $featured_num
                        ));
        } ?>
        <?php if (have_posts()) : while (have_posts()) : the_post();
        global $post; ?>
        <?php if ( $responsive ) { ?>
            <li class="slide">
        <?php } else { ?>
            <div class="slide">
        <?php } ?>
                <?php
                $width = $responsive ? 960 : 958;
                $height = 340;
                $small_width = 95;
                $small_height = 54;
                $titletext = get_the_title();

                $thumbnail = get_thumbnail($width,$height,'',$titletext,$titletext,false,'Featured');

                $arr[$i]['thumbnail'] = get_thumbnail($small_width,$small_height,'',$titletext,$titletext,false,'Small');
                $arr[$i]['titletext'] = $titletext;

                $thumb = $thumbnail["thumb"];
                print_thumbnail($thumb, $thumbnail["use_timthumb"], $titletext, $width, $height, ''); ?>
                <div class="featured-top-shadow"></div>
                <div class="featured-bottom-shadow"></div>  
                <div class="featured-description">
                    <div class="feat_desc">
                        <p class="meta-info"><?php esc_html_e('Posted','henrik'); ?> <?php esc_html_e('by','henrik'); ?> <?php the_author_posts_link(); ?> <?php esc_html_e('on','henrik'); ?> <?php the_time(esc_attr(get_option('henrik_date_format'))) ?></p>
                        <h2 class="featured-title"><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
                        <p><?php truncate_post(410); ?></p>
                    </div>
                    <a href="<?php the_permalink(); ?>" class="readmore"><?php esc_html_e('Read More', 'henrik'); ?></a>
                </div> <!-- end .description -->
        <?php if ( $responsive ) { ?>
            </li> <!-- end .slide -->
        <?php } else { ?>
            </div> <!-- end .slide -->
        <?php } ?>
        <?php $ids[] = $post->ID; $i++; endwhile; endif; wp_reset_query(); ?>
<?php if ( $responsive ) { ?>
    </ul> <!-- end .slides -->
<?php } else { ?>
    </div> <!-- end #slides -->
<?php } ?>
</div> <!-- end #featured -->

<div id="controllers" class="clearfix">
    <ul>
        <?php for ($i = 0; $i < $featured_num; $i++) { ?>
            <li>
                <div class="controller">
                    <a href="#"<?php if ( $i == 0 ) echo ' class="active"'; ?>>
                        <?php print_thumbnail( $arr[$i]['thumbnail']['thumb'], $arr[$i]['thumbnail']["use_timthumb"], $arr[$i]['titletext'], $small_width, $small_height ); ?>
                        <span class="overlay"></span>
                    </a>
                </div>  
            </li>
        <?php } ?>
    </ul>
    <div id="active_item"></div>
</div> <!-- end #controllers --> 
```

它选择自定义类别并返回自定义数量的帖子。问题是它会按照帖子的创建顺序显示帖子。**我想选择我自己的顺序**，这样我就可以选择首先显示哪些帖子等等。

**那么，是否可以选择显示返回帖子的顺序？**也许通过定位特定的ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:31:07.673

看起来您已经在使用`'orderby' => 'menu_order'`. 您现在需要做的就是在 WordPress 界面中设置菜单顺序——所有新帖子默认为`0`. 或者您将`orderby`论点更改为[其他内容](http://codex.wordpress.org/Class_Reference/WP_Query#Order_.26_Orderby_Parameters)。

# html - ASP：参考表格数据来更新页面上的文本

> ID：12251749
> 
> 赞同：0
> 
> 时间：2012-09-03T17:02:51.530
> 
> 标签：html, asp-classic

我在网站编程方面的背景很少，所以如果这可能是一个明显的问题，我深表歉意。

我正在使用 ASP 更新网站上的一些页面。在特定页面上，我有一个人们可以下载的 pdf 文件列表。目前，文件的标题与指向它的链接一起直接写入页面

```
myPage.asp    
<tr>
<td>Title</td>
<td><a href="something.pdf">PDF</a></td>
</tr> 
```

我想将所有标题和文件名收集到一个表中，例如：

```
FileCode   Title    Filename
001        ABC      abcfile.pdf
002        XYZ      xyz.pdf 
```

这样当我填充页面时，我可以使用如下内容，

```
<tr>
<td>Table(code).Title</td>
<td><a href=Table(code).Filename>PDF</a></td>
</tr> 
```

代码不必看起来像那样（我不知道它会是什么样子）；这只是一个例子来说明我的意思：我希望能够将所有文件信息保存在一个位置，以便轻松更新和添加内容，并且我可以在需要显示一些信息时引用它.

我这样做的原因是因为我不希望用户能够直接单击 pdf 链接并获取文件；他们必须通过联系表格来获取文件，我认为只发送文件代码而不是实际的文件名可能更容易，

```
<a href="contactForm.asp?code=001">PDF</a> 
```

因此，contactForm.asp 也将访问此表。因此，我想要这样一张桌子的中心位置，但我不知道网站可接受的约定是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T23:02:18.633

最简单的解决方案是将文件存储在 ASP 包含文件中的数组中，如下所示：

文件.asp

```
<%
Dim files(2, 2)
files(0, 0) = "1"
files(1, 0) = "File title 1"
files(2, 0) = "file1.txt"
files(0, 1) = "2"
files(1, 1) = "File title 2"
files(2, 1) = "file2.txt"
files(0, 2) = "3"
files(1, 2) = "File title 3"
files(2, 2) = "file3.txt"
%> 
```

（如果文件在文件夹中，您将添加路径，例如“/folder/file1.txt”）

要显示文件列表，您可以使用以下代码：

显示文件.asp

```
<!--#include file="files.asp"-->
<table>
<tr>
<td>FileCode</td>
<td>Title</td>
<td>Filename</td>
</tr>
<% Dim i : For i = 0 To UBound(files, 2) %>
<tr>
<td><%= files(0, i) %></td>
<td><%= files(1, i) %></td>
<td><%= files(2, i) %></td>
</tr>
<% Next %>
</table> 
```

要将文件发送到浏览器，您可以使用以下方法之一。第一个只是简单的重定向到文件，第二个实际加载文件并将文件写入浏览器，使用户不知道文件的路径（更安全但不是很安全）：

联系人.asp

```
<!--#include file="files.asp"-->
<%
Dim code, file, i
code = Request.QueryString("code")
For i = 0 To UBound(files, 2)
    If files(0, i) = code Then
        file = files(2, i)
        Exit For
    End If
Next
If file <> "" Then
    Response.Redirect(file)
Else
    Response.Write("File not found")
End If
%> 
```

联系人2.asp

```
<!--#include file="files.asp"-->
<%
Dim code, file, i, stream
code = Request.QueryString("code")
For i = 0 To UBound(files, 2)
    If files(0, i) = code Then
        file = files(2, i)
        Exit For
    End If
Next
If file <> "" Then
    Set stream = Server.CreateObject("ADODB.Stream") 
    stream.Open 
    stream.Type = 1
    stream.LoadFromFile(Server.MapPath(file))
    Response.BinaryWrite(stream.Read) 
Else
    Response.Write("File not found")
End If
%> 
```

希望您可以使用其中的一些来满足您的需求？

# css - 媒体查询可以根据 div 元素而不是屏幕调整大小吗？

> ID：12251750
> 
> 赞同：412
> 
> 时间：2012-09-03T17:02:59.917
> 
> 标签：css, media-queries

我想使用媒体查询根据元素所在元素的大小调整元素的大小`div`。我不能使用屏幕大小，因为`div`它就像网页中的小部件一样使用，并且它的大小可能会有所不同。

# 更新

看起来现在正在做这方面的工作： [https ://github.com/ResponsiveImagesCG/cq-demos](https://github.com/ResponsiveImagesCG/cq-demos)

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2012-09-07T13:39:26.097

经过近*十年*的工作——通过提案、概念验证、讨论和更广泛的 Web 开发人员社区的其他贡献——CSS 工作组终于奠定了将**容器查询**写入[未来版本所需的一些基础工作。 CSS 遏制规范](https://github.com/w3c/csswg-drafts/issues/5796)！有关此类功能如何工作和使用的更多详细信息，请查看 Miriam Suzanne 的详尽*解释* [器](https://github.com/oddbird/css-sandbox/blob/main/src/rwd/query/explainer.md)。

希望不久之后我们就会看到这样一个系统的健壮的跨浏览器实现。这是一个艰苦的等待，但我很高兴，由于循环依赖或无限循环或你有什么，我们不再必须接受它作为 CSS 的不可克服的限制（这些仍然是某些方面的潜在问题）提议的设计，但我相信 CSSWG 会找到方法）。

* * *

媒体查询并非旨在基于页面中的元素工作。它们被设计为基于设备或[媒体类型](http://www.w3.org/TR/CSS21/media.html)工作（因此它们被称为*媒体*查询）。[`width`](http://www.w3.org/TR/css3-mediaqueries/#width), [`height`](http://www.w3.org/TR/css3-mediaqueries/#height), 和其他基于尺寸的媒体功能都指基于屏幕的媒体中视口或设备屏幕的尺寸。它们不能用于引用页面上的某个元素。

如果您需要根据页面上某个`div`元素的大小应用样式，则必须使用 JavaScript 来观察该`div`元素大小的变化，而不是使用媒体查询。

或者，自此答案的原始发布以来引入了更现代的布局技术，例如 flexbox 和自定义属性等标准，您可能根本不需要媒体或元素查询。[Djave 提供了一个示例。](https://stackoverflow.com/questions/12251750/can-media-queries-resize-based-on-a-div-element-instead-of-the-screen/58118316#58118316)

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2013-06-02T03:29:27.493

我刚刚创建了一个 javascript 垫片来实现这个目标。如果需要，请看一下，这是一个概念验证，但请注意：它是早期版本，仍需要一些工作。

[https://github.com/marcj/css-element-queries](https://github.com/marcj/css-element-queries)

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-07-16T19:25:53.797

iframe 内的媒体查询可以用作元素查询。我已经成功地实现了这一点。这个想法来自Zurb最近一篇关于[响应式广告的帖子。](http://zurb.com/playground/responsive-ads)没有Javascript！

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2019-09-26T13:49:20.013

从布局的角度来看，使用现代技术是可能的。

它由海顿皮克林（我相信）组成。他在这里详细介绍了这个过程：[http ://www.heydonworks.com/article/the-flexbox-holy-albatross](http://www.heydonworks.com/article/the-flexbox-holy-albatross)

Chris Coyier 拿起它并在此处进行演示：[https ://css-tricks.com/putting-the-flexbox-albatross-to-real-use/](https://css-tricks.com/putting-the-flexbox-albatross-to-real-use/)

为了重申这个问题，我们在下面看到了 3 个相同的组件，每个组件由三个标记为 和 的橙色`a`div`b`组成`c`。

后两个块垂直显示，因为它们受限于水平空间，而顶部组件 3 个块是水平布局的。

它使用`flex-basis`CSS 属性和 CSS 变量来创建这种效果。

[![最后一个例子](../Images/1810adfb18fb4eb94218a24b840a06f2.png)](https://i.stack.imgur.com/Hfi7i.png)

```
.panel{
  display: flex;
  flex-wrap: wrap;
  border: 1px solid #f00;
  $breakpoint: 600px;
  --multiplier: calc( #{$breakpoint} - 100%);
  .element{
    min-width: 33%;
    max-width: 100%;
    flex-grow: 1;
    flex-basis: calc( var(--multiplier) * 999 );
  }
} 
```

[演示](https://codepen.io/EightArmsHQ/pen/mvqJwg?editors=0100)

Heydon 的文章有 1000 字的详细解释，我强烈建议您阅读。

# 2021/22 更新

正如其他答案中提到的，容器查询即将到来。它有一个完整的规范，它的用法在 MDN 上有详细说明：

[https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Container_Queries](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Container_Queries)

并且有一个 polyfill 可以让还不支持它的浏览器加速：

[https://github.com/GoogleChromeLabs/container-query-polyfill](https://github.com/GoogleChromeLabs/container-query-polyfill)

这里有一个很好的概述视频：

[https://www.youtube.com/watch?v=gCNMyYr7F6w](https://www.youtube.com/watch?v=gCNMyYr7F6w)

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2015-10-05T13:35:06.390

正如@BoltClock 在接受的答案中所写，目前仅使用 CSS 是不可能的，但您可以使用 JavaScript 解决这个问题。

我创建了一个容器查询（又名元素查询）prolyfill 来解决这类问题。它的工作方式与其他脚本略有不同，因此您不必编辑元素的 HTML 代码。您所要做的就是包含脚本并在您的 CSS 中使用它，如下所示：

```
.element:container(width > 99px) {
    /* If its container is at least 100px wide */
} 
```

[https://github.com/ausi/cq-prolyfill](https://github.com/ausi/cq-prolyfill)

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-11-12T19:26:12.767

几年前我遇到了同样的问题，并资助了一个插件的开发来帮助我的工作。我已将插件作为开源发布，因此其他人也可以从中受益，您可以在 Github 上获取它：[https ://github.com/eqcss/eqcss](https://github.com/eqcss/eqcss)

根据我们对页面元素的了解，有几种方法可以应用不同的响应式样式。以下是 EQCSS 插件允许您用 CSS 编写的一些元素查询：

```
@element 'div' and (condition) {
  $this {
    /* Do something to the 'div' that meets the condition */
  }
  .other {
    /* Also apply this CSS to .other when 'div' meets this condition */
  }
} 
```

那么带有 EQCSS 的响应式样式支持哪些条件呢？

## 重量查询

*   最小宽度`px`
*   最小宽度`%`
*   最大宽度`px`
*   最大宽度`%`

## 高度查询

*   最小高度`px`
*   最小高度`%`
*   最大高度`px`
*   最大高度`%`

## 计数查询

*   最小字符
*   最大字符
*   最小线
*   最大线
*   最小的孩子
*   最大儿童

## 特殊选择器

在 EQCSS 元素查询中，您还可以使用三个特殊的选择器来更具体地应用您的样式：

*   `$this`（匹配查询的元素）
*   `$parent`（匹配查询的元素的父元素）
*   `$root`（文档的根元素，`<html>`）

元素查询允许您从单独的响应式设计模块组成布局，每个模块都对它们在页面上的显示方式有一点“自我意识”。

使用 EQCSS，您可以设计一个从 150 像素宽到 1000 像素宽的小部件看起来不错，然后您可以使用任何模板（在任何网站上）自信地将该小部件放入任何页面的任何侧边栏中，并且

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-09-07T17:49:13.783

这个问题非常模糊。正如 BoltClock 所说，媒体查询只知道设备的尺寸。但是，您可以将媒体查询与下降选择器结合使用来执行调整。

```
.wide_container { width: 50em }

.narrow_container { width: 20em }

.my_element { border: 1px solid }

@media (max-width: 30em) {
    .wide_container .my_element {
        color: blue;
    }

    .narrow_container .my_element {
        color: red;
    }
}

@media (max-width: 50em) {
    .wide_container .my_element {
        color: orange;
    }

    .narrow_container .my_element {
        color: green;
    }
} 
```

唯一的其他解决方案需要 JS。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-06-17T09:05:29.430

我认为您可以完全使用 css 完成您想要的唯一方法是为您的小部件使用流体容器。如果容器的宽度是屏幕的百分比，那么您可以使用媒体查询来根据容器的宽度设置样式，因为您现在将知道每个屏幕的尺寸是什么容器的尺寸。例如，假设您决定将容器的屏幕宽度设为 50%。然后对于 1200px 的屏幕宽度，您知道您的容器是 600px

```
.myContainer {
  width: 50%;
}

/* you know know that your container is 600px 
 * so you style accordingly
*/
@media (max-width: 1200px) { 
  /* your css for 600px container */
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-07-30T23:46:37.387

我也在考虑媒体查询，但后来我发现了这个：

*   [http://www.mademyday.de/css-height-equals-width-with-pure-css.html](http://www.mademyday.de/css-height-equals-width-with-pure-css.html)
*   [使用 CSS 保持 div 的纵横比](https://stackoverflow.com/questions/1495407/maintain-the-aspect-ratio-of-a-div-with-css)

`<div>`只需为 的百分比值创建一个包装器`padding-bottom`，如下所示：

```
div {
  width: 100%;
  padding-bottom: 75%;
  background:gold; /** <-- For the demo **/
}
```

```
<div></div>
```

它将导致`<div>`高度等于其容器宽度的 75%（纵横比为 4:3）。

这种技术也可以与媒体查询和一些关于页面布局的特殊知识相结合，以获得更细粒度的控制。

足以满足我的需要。这也可能足以满足您的需求。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-10-23T10:55:57.423

您可以使用[ResizeObserver](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver) API。它仍处于早期阶段，因此并非所有浏览器都支持它（但有几个 polyfill 可以帮助您）。

此 API 允许您在调整 DOM 元素大小时附加事件侦听器。

[演示 1](https://developers.google.com/web/updates/2016/10/resizeobserver) -[演示 2](https://alligator.io/js/resize-observer/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-24T08:28:14.637

对于我来说，我通过设置 div 的最大宽度来做到这一点，因此对于小部件不会受到影响，并且由于最大宽度样式而调整了大部件的大小。

```
 // assuming your widget class is "widget"
  .widget {
    max-width: 100%;
    height: auto;
  } 
```

# php - 使用 php 定义 PW_SALT 给出错误

> ID：12251751
> 
> 赞同：0
> 
> 时间：2012-09-03T17:03:24.177
> 
> 标签：php

我正在制作一个令牌，当我使用它`PW_SALT`时我正在使用`define(PW_SALT,'(+3%_');`它，然后当我发出警报时它给我错误`use of undefined constant PW_SALT`。不知道为什么会这样，我错过了什么？

```
define(PW_SALT,'(+3%_');
$row=mysql_fetch_array($sql);
$uid=$row['uid'];
$expFormat = mktime(date("H"), date("i"), date("s"), date("m")  , date("d")+3, date("Y"));  
$expDate = date("Y-m-d H:i:s",$expFormat);  
echo $key = md5($uid . '_' . $email . rand(0,10000) .$expDate . PW_SALT); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:13:53.833

正确的语法是：

```
define('PW_SALT','(+3%_'); 
```

在常量名称周围加上引号。检查[文档](http://php.net/define)。

# php - 编辑文件路径 PHP

> ID：12251752
> 
> 赞同：0
> 
> 时间：2012-09-03T17:03:27.297
> 
> 标签：php, filepath

我的页面上有一个删除按钮，该删除按钮必须删除我的数据库中的某个条目（不太难），它必须删除包含删除按钮的文件所在的整个文件夹（也是可行的），但是我还希望它删除另一个放置在其他地方的文件夹，但我不知道该怎么做。使用

```
dirname(__FILE__); 
```

我能够获取包含删除按钮的文件所在的文件路径。结果是：

```
mywebsite.nl/subdomains/dongen/httpdocs/s-gravenmoer/aandrijvingenenbesturingen/logo4life 
```

我也想删除的文件路径非常相似，但有点不同。最后 3 个文件夹是一个变量，因此它们的长度（以字符为单位）总是不同的。但是，必须从此文件路径中删除倒数第二个文件夹，以便保留：

```
 mywebsite.nl/subdomains/dongen/httpdocs/s-gravenmoer/logo4life 
```

有没有办法用 PHP 做到这一点？也许使用 substr 或类似的东西？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:11:19.083

我认为这应该可以解决问题：

```
$folderToRemove = preg_replace( '#^(.*)/(.*?)/(.*?)$#', "$1/$3", dirname(__FILE__) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:13:19.757

您可以尝试使用“glob”。[www.php.net/glob](http://www.php.net/glob)中的详细信息

你可以试试：

```
$files = glob('subdomains/dongen/httpdocs/*/logo4life');
foreach ($files as $file) {
    unlink($file); // note that this is very dangerous though, you may end up deleting a lot of files
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:13:39.010

正如您所猜测的，您不需要任何花哨的东西，一个简单的 str_replace 就可以做到：-

```
$file = 'mywebsite.nl/subdomains/dongen/httpdocs/s-gravenmoer/aandrijvingenenbesturingen/logo4life';
var_dump(str_replace('aandrijvingenenbesturingen/', '', $file)); 
```

输出：-

```
string 'mywebsite.nl/subdomains/dongen/httpdocs/s-gravenmoer/logo4life' (length=62) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T17:23:01.687

```
$path = "mywebsite.nl/subdomains/dongen/httpdocs/s-gravenmoer/aandrijvingenenbesturingen/logo4life";
$regex = "/(.*\/).*\/(.*)/";
$matches = array();
preg_match($regex,  $path, $matches);
// var_dump($matches);
$new_path = $matches[1].$matches[2];
echo $new_path; 
```

上面的代码`preg_match`用于匹配字符串中的正则表达式。

# unit-testing - 如何确定 Github 项目中有多少百分比包含单元测试？

> ID：12251754
> 
> 赞同：0
> 
> 时间：2012-09-03T17:03:46.330
> 
> 标签：unit-testing, github, github-api

我正在编写有关单元测试和 TDD 的演示文稿。我想分享的一个统计数据是包含单元测试的 Github 项目的百分比。这些数据在某处可用吗？

如果没有，是否可以通过 Github API 获取？我正在考虑一种基于项目类型的简单的基于文件的方法（查看 Java 项目是否有任何以`Test.java`或`spec.rb`Ruby 结尾的文件），但我从未使用过他们的 API，也不知道这有多可行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T01:00:55.767

从 Github API 获取 Java 存储库列表（使用`search`和`language`参数），然后克隆每个存储库，查找`Test.java`或收集您的结果。不过，我认为没有克隆每个项目的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T17:32:15.820

我认为没有任何 API 可以为您提供这些信息。或者至少在不浏览整个存储库的情况下不会这样做，无论如何这都不实用。您可能想建议 github 员工自己进行这样的调查，但这将取决于他们 :)

# c - 用C语言逐字反转字符串

> ID：12251756
> 
> 赞同：1
> 
> 时间：2012-09-03T17:03:53.157
> 
> 标签：c

我下面的代码有问题，我正在尝试反转一个字符串，但是我有运行时错误，谁能帮我检查一下？问题是：
例如：

输入： char *s = "这是我的字符串"

输出：“字符串我是这个”

```
#include <iostream>   
using namespace std;

void reverse(char *str, int start, int end){
    char tmp; 
    while(end > start){
        tmp = str[end];
        str[end] = str[start];
        str[start] = tmp;
        end--;
        start++;
    }
}

int main()
{
   char *s = "This is my string";
   int len = strlen(s);
   int start = 0;
   int end = len-1;
   reverse(s, start, end);   
   printf("%s", s); 
   end = 0;
   while( end < len){
        if(s[end] == ' '||s[end] =='\0'){
            while(s[start]==' ')
                start++;
            reverse(s,start,end-1);
            start = end;
        }   
        end++;
   }
   printf("%s", s); 
   cin.get();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:06:02.510

您不能修改此字符串：

```
char *s = "This is my string"; 
```

你声明不正确，应该是

```
const char* = "This is my string"; 
```

通常，这些字符串分配在您无法写入的内存区域中。您应该创建另一个缓冲区来将反转的字符串写入。

# ruby - Ruby 1.8.7 RegExp 不适用于元字符“\h”

> ID：12251762
> 
> 赞同：0
> 
> 时间：2012-09-03T17:04:19.097
> 
> 标签：ruby, ruby-1.8.7

如果我在 1.8.7 控制台中运行它：

```
$ irb-ruby-1.8.7-p330
1.8.7 :001 > "0a" =~ /\h\h/
 => nil 
```

如果我在 1.9.2 控制台中运行相同的：

```
$ irb-ruby-1.9.2-p290
1.9.2p290 :001 > "0a" =~ /\h\h/
 => 0 
```

：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:30:46.330

没错，`\h`标准 Ruby 1.8.7 正则表达式库似乎无法识别。这可以使用[Rubular](http://rubular.com/)来确认。如果您的代码需要 1.8 兼容性而不使用任何额外的 gem，我认为您唯一的选择是使用等效的字符类`[0-9a-fA-F]`。

# c++ - 多态性中的通用 STL 迭代器

> ID：12251772
> 
> 赞同：3
> 
> 时间：2012-09-03T17:05:33.153
> 
> 标签：c++, generics, stl

我对 C++ 有点陌生，我有一个抽象类（纯虚拟），它继承了 2 个类。每个派生类都保存类似的数据，只是在不同的 STL 容器（数组与映射）中，我重载了基类的运算符，以便执行例如添加 STL 元素。我希望能够迭代 STL 的元素，不管它是什么类型。

我已经在通用迭代器和类似的东西上搜索了几天，但找不到任何东西。

我没有太多代码可以分享，因为我无能为力。我想也许让我的基类持有一个代表 STL 容器的模板变量，然后在操作符中获取它的迭代器，但同样，不知道如何去做。

```
protected:
    template<class T>
    T gStlContainer; 
```

然后访问

```
gStlContainer::iterator<double> it; 
```

显然没有用。

有什么建议么？谢谢！

编辑：我正在编辑以尝试使用示例更好地解释。我在基础（抽象）类中重载了 + 运算符，我想要它做的是遍历 STL 容器的每个元素，并将其添加到另一个元素，例如，假设我有这个数组作为 STL

```
arr = [0,1,2,3] // Say it's stored in Derived2 class
arr = [4,5,6,7] // Say it's stored in Derived3 class 
```

这些数组都存储在派生类之一中。当我在做

```
Derived1 = Derived2 + Derived3; 
```

那么 Derived1 将保持

```
arr = [4,6,8,10] 
```

希望现在更清楚一点。问题是它并不总是一个数组，例如它可以结合数组和映射。这就是我需要通用迭代器或一些解决方案的原因。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:43:32.580

动态多态性对于对象来说是合理的，但对于算法来说却非常糟糕。对于算法，您最好使用静态多态性。如果你觉得你想要一个容器系统支持`operator+()`它们，只要确保它们以某种方式引用一个命名空间并`operator+()`在这个命名空间中定义一个合适的。例如，您可以使用从具有运算符的命名空间中的某些内容继承`std::vector<T, A>`的分配器。`A`下面是这种方法的一个例子。

这个想法基本上是让命名空间实现合适的运算符。例如，`addable`实现`operator+()`和`printable`实现`operator<<()`。除非类型以某种方式引用它们，否则不会查看这些名称空间，例如通过从该名称空间中的类型继承或通过使用继承这些类型之一的类型的模板参数。这种查找机制称为*参数相关查找*。因此，这两个命名空间都提供了一个空的`struct tag {};`，在继承时不会花费任何成本。

为了获取以某种方式引用这些命名空间的容器，下面的代码只是创建了一个派生自这两种类型的分配器类模板。然后将此分配器与`std::vector<T, A>`并`std::list<T, A>`用于创建类型别名以轻松创建相应的容器。为了展示一切都很好，`main()`只是演示了操作符的使用。

下面的代码在几个地方利用了 C++ 2011 来使符号更短一些。该原理也适用于 C++ 2003。主要是使用类型别名和初始化列表不起作用。

```
#include <algorithm>
#include <functional>
#include <iostream>
#include <iterator>
#include <list>
#include <vector>

namespace addable
{
    struct tag {};

    template <typename T0, typename T1>
    T0 operator+ (T0 const& c0, T1 const& c1)
    {
        T0 rc;
        std::transform(c0.begin(), c0.end(),
                       c1.begin(),
                       std::back_inserter(rc),
                       std::plus<typename T0::value_type>());
        return rc;
    }
}

namespace printable
{
    struct tag {};
    template <typename T, typename = typename T::value_type>
    std::ostream&
    operator<< (std::ostream& out, T const& value)
    {
        out << "[";
        if (!value.empty()) {
            std::copy(value.begin(), value.end() - 1,
                      std::ostream_iterator<typename T::value_type>(out, ", "));
            out << value.back();
        }
        return out << "]";
    }
}

template <typename T>
struct my_allocator
    : addable::tag
    , printable::tag
    , std::allocator<T>
{
};

template <typename T>
using my_vector = std::vector<T, my_allocator<T>>;
template <typename T>
using my_list   = std::vector<T, my_allocator<T>>;

int main()
{
    my_vector<int> v({ 1, 2, 3, 4 });
    my_list<int>   l({ 2, 3, 4, 5 });
    my_vector<int> rc = v + l;

    std::cout << v << " + " << l << " = " << (v + l) << "\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:09:28.767

C++ 没有通用迭代器，但它有模板函数，可以编写为对任何类型的迭代器进行操作。要在容器中添加所有元素，已经有适合您的算法。阅读有关`std::accumulate`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:09:30.493

你从错误的角度看待问题。你可以这样做，但你为什么要这样做？如果它的行为不同，您的基类不应实现该方法，而应将逻辑委托给派生类。

```
class Base
{
public:
    virtual ~Base() {}
    virtual void iterate() = 0;
};

class Derived : Base
{
public:
    virtual void iterate() { /*iterate through vector or map or whatever*/ }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T18:24:45.217

简单的答案是：你不能，至少不能使用 STL 的迭代器。

迭代器通常构建为模板，*编译器*为每个模板特化创建一个新类型。您可以将 vector::iterator 视为 VectorFloatIterator，而将 map::iterator 视为 MapFloatIterator。

它们是不相关的类型——甚至不是通过继承——只是碰巧有相似的接口，当然，C++ 不是鸭子类型的。当这两种类型完全不相关时，您不能将 VectorFloatIterator 传递给需要 MapFloatIterator 的函数。

这甚至适用于使用标准算法 - 例如 for_each 算法是模板化的，因此编译器将创建类似 for_each_vector_float_iterator 和 for_each_map_float_iterator 函数的东西，它们不能相互使用。

*考虑在编译时*生成的类型会很有帮助。您将不同类型传递给函数的操作发生在运行时，但为时已晚。您只能在编译时使用 C++ 中模板的“泛化”（是的，我编造了这个词）功能。

话虽如此，@Luchian Grigore 对这个问题有最公认的答案：专门`operator+`处理可能出现在附加语句中的任何各种类型。是不是很痛？是的，有点。

话虽如此，[boost::any](http://www.boost.org/doc/libs/1_51_0/doc/html/any.html)是您正在寻找的用例 - 它们是类似 STL 的容器，通过*不*使用模板来处理各种类型来处理任何类型。

# c# - 无限次添加嵌套代码

> ID：12251773
> 
> 赞同：2
> 
> 时间：2012-09-03T17:05:37.370
> 
> 标签：c#, json.net, nested-loops

我有一个独特的问题。我的程序正在从书签 JSON 文件中获取来自 chrome 的书签。我为此使用 JSON.net dll。我的问题是，我需要在其正确的文件夹层次结构中获取每个 URL，但是，您似乎可以创建无限数量的文件夹来保存书签。这是 JSON 层次结构的示例：

```
{
   "checksum": "c9e24e7fb3c6cb184fb776e32dd1004e",
   "roots": {
      "bookmark_bar": {
         "children": [ {
{
"children": [ {
   "children": [ {
      "children": [ {
         "children": [ {
            "date_added": "12985566069697953",
            "id": "225",
            "name": "EvasiveURL",
            "type": "url",
            "url": "evasiveurl.com"
         } ],
         "date_added": "12991165233108137",
         "date_modified": "12991165244676611",
         "id": "374",
         "name": "NestedFolder2",
         "type": "folder"
      } ],
      "date_added": "12991165215985934",
      "date_modified": "12991165215985934",
      "id": "373",
      "name": "NestedFolder",
      "type": "folder"
   } ],
   "date_added": "12985566069695953",
   "date_modified": "12991165219618934",
   "id": "204",
   "name": "Games",
   "type": "folder"
} 
```

这是我当前的代码：

```
for (int i = 0; o["roots"]["bookmark_bar"]["children"][i] != o["roots"]["bookmark_bar"]["children"].Last; i++)
{
    var property = o["roots"]["bookmark_bar"]["children"][i]["url"];
    var property2 = o["roots"]["bookmark_bar"]["children"][i]["children"];
    Console.WriteLine(o["roots"]["bookmark_bar"]["children"][i]["type"]);
    if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "url") {
        Console.WriteLine("URL");
    }

    else if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "folder")
    {
        Console.WriteLine("FOLDER");
        for (int ii = 0; o["roots"]["bookmark_bar"]["children"][i]["children"][ii] != o["roots"]["bookmark_bar"]["children"][i]["children"].Last; ii++)
        {
            property = o["roots"]["bookmark_bar"]["children"][i]["children"][ii];
          //  Console.WriteLine(property);
            if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "url")
            {
                Console.WriteLine("URL");
            }

            else if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "folder")
            {
                for (int iii = 0; o["roots"]["bookmark_bar"]["children"][i]["children"][ii]["children"][iii] != o["roots"]["bookmark_bar"]["children"][i]["children"][ii]["children"].Last; iii++)
                {
                    if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "url")
                    {
                        Console.WriteLine("URL");
                    }
                    else if (o["roots"]["bookmark_bar"]["children"][i]["type"].ToString() == "folder")
                    {
                        //etc. etc.
                    }
                }
            }
        }
    }
} 
```

那么，我怎样才能重写这段代码，而不将前面的 for 循环和 If-Else 语句复制/粘贴到我所说的“等等”中。ETC'？

谢谢！

编辑：这是o类：

```
JsonSerializer serializer = new JsonSerializer();
var o = (JToken)serializer.Deserialize(jsonReader); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:42:59.420

这将是您的问题的解决方案。正如我所说，你处理孩子递归。

```
private void processJsonInput()
{
  var reader = new StreamReader(new FileStream("d:\\jsonfile.txt", FileMode.Open));

  JsonSerializer serializer = new JsonSerializer();
  var o = (JToken)serializer.Deserialize(new JsonTextReader(reader));

  foreach (var child in o["roots"]["bookmark_bar"]["children"])
  {
    processChild(child);
  }
}

private void processChild(JToken child)
{
  if (child["type"].ToString() == "url")
  {
    Console.WriteLine("URL");
  } 
  else if (child["type"].ToString() == "folder")
  {
    Console.WriteLine("FOLDER");
    // process sub childrens in the folder
    foreach (var subChild in child["children"])
    {
      processChild(subChild);
    }
  }
} 
```

# html - 如何使用媒体打印，用于谷歌地图

> ID：12251775
> 
> 赞同：6
> 
> 时间：2012-09-03T17:05:39.247
> 
> 标签：html, google-maps, css

我有这个网页浏览器视图，带有谷歌地图。

![浏览器视图](../Images/875a49503b2ecc9308f80e282713233f.png)

然后我添加了一些@Media Print 样式

```
<style type="text/css">
        @media print
        {
        body{font-family:georgia,times,sans-serif;}
        img{max-width:500px;}
        #headerblock{display:none;}
        #navigationblock{display:none;}
        #thewaydiv{display:block;}
        #footerblock{display:none;}
        #contentmap{min-height:100px; position:relative; width:100%;}
        #map{border-bottom:0px; border-left:0px; border-top:0px; border-right:0px; height:250px; margin-top:0px; width:100%;}
        }
    </style> 
```

然后当我使用打印页面或打印视图时，我得到了这个：

![打印视图](../Images/43b51a32075b39e98e23c8e0433cb8ad.png)

正如您所看到的，Google 地图的页面大小还可以，但它太大/只是真实图像的一小部分。我该如何解决这个问题，以便在打印视图上获得类似浏览器视图的 Google 图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:03:31.163

这不能使用 CSS 完成。

您将需要一个特殊的页面，其中包含必须打印的地图大小，或者在打印之前缩小地图（这可以使用 javascript 完成）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-30T02:06:51.230

我也遇到了动态数据驱动地图的这个问题。然而，我确实找到了一种使用 css 使这项工作更顺畅的方法，而无需使用 API 或笨重的单独地图页面来操作地图。

我为地图提供了一个具有定义高度的容器 div，并将其 css 溢出设置为隐藏。我使用相同的设置在第一张地图下添加了第二张地图，但可打印尺寸为 700 像素宽 x 500 像素高。

最后，打印样式表简单地显示：第一个地图显示其容器中的第二个隐藏地图：无。

这是哈克吗？
也许吧，但它*立即*对我有用。

# c++ - 根据用户请求停止 tbb 线程

> ID：12251778
> 
> 赞同：2
> 
> 时间：2012-09-03T17:05:51.227
> 
> 标签：c++, multithreading, tbb

我的主线程正在进行更长的计算。在此期间，应该运行第二个线程（计算监视/统计类型）。一旦计算完成，它应该停止监视线程。使用了使用共享标志变量的经典方法（参见[如何根据用户请求安全地停止正在运行的线程？](https://stackoverflow.com/questions/1681429/how-to-stop-a-running-thread-safely-on-user-request)）。

```
#include <iostream>

#include "tbb/compat/thread"
#include "tbb/atomic.h"
#include "tbb/spin_mutex.h"

using namespace tbb;
using namespace std;

class Foo {
    bool _stop;
    spin_mutex _stopMutex;

public:
    Foo();
    void operator()();
    bool stop();
    void stop(bool);
};

Foo::Foo() {
    _stop = false;
}

bool Foo::stop() {
    spin_mutex::scoped_lock lock(_stopMutex);
    return _stop;
}

void Foo::stop(bool stop) {
    spin_mutex::scoped_lock lock(_stopMutex);
    _stop = stop;
    cout << "Foo::stop(bool) new value: " << _stop << endl;
}

void Foo::operator ()() {
    int i = 0;
    while (true) {
        cout << "   Foo::operator() still alive " << i << endl;
        {
            spin_mutex::scoped_lock lock(_stopMutex);
            if (_stop) {
                cout << "   Foo::operator() is asked to finish" << endl;
                break;
            }
        }
        if (i > 15) {
            spin_mutex::scoped_lock lock(_stopMutex);
            _stop = true;;
        }
        sleep(1);
        ++i;
    }
}

int main() {
    Foo foo;
    thread fooThread(foo);

    cout << "starting longer calculation" << endl;
    int sum;
    for (int i = 0; i < 3; ++i) {
        sum += i;
        sleep(1);
    }
    cout << "finished longer calculation" << endl;

    for (int i = 0; i < 5; ++i) {
        foo.stop(true);
        cout << "main() stop=" << foo.stop() << endl;
        sleep(1);
    }

    cout << "main() calling join()" << endl;
    fooThread.join();
    cout << "main() fooThread joined" << endl;

    return 0;
} 
```

但是，共享变量不在线程之间共享。看起来每个线程都有自己的实例！监视线程不会停止，直到它自己停止。看看输出：

```
starting longer calculation
   Foo::operator() still alive 0
   Foo::operator() still alive 1
   Foo::operator() still alive 2
finished longer calculation
Foo::stop(bool) new value: 1
main() stop=1
   Foo::operator() still alive 3
Foo::stop(bool) new value: 1
main() stop=1
   Foo::operator() still alive 4
   Foo::operator() still alive 5
Foo::stop(bool) new value: 1
main() stop=1
   Foo::operator() still alive 6
Foo::stop(bool) new value: 1
main() stop=1
   Foo::operator() still alive 7
Foo::stop(bool) new value: 1
main() stop=1
   Foo::operator() still alive 8
main() calling join()
   Foo::operator() still alive 9
   Foo::operator() still alive 10
   Foo::operator() still alive 11
   Foo::operator() still alive 12
   Foo::operator() still alive 13
   Foo::operator() still alive 14
   Foo::operator() still alive 15
   Foo::operator() still alive 16
   Foo::operator() still alive 17
   Foo::operator() is asked to finish
main() fooThread joined 
```

这里发生了什么？提前感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T09:30:48.540

大卫，感谢您提供的所有有用提示。如果您只需要坚持使用 tbb，则可以使用引用共享数据的 Foo 构造函数。我找到了一个使用 Boost 的更独立的解决方案。我真正的意图是这样的：

```
#include <iostream>

#include "boost/ref.hpp"
#include "boost/thread.hpp"

#include "tbb/atomic.h"

using namespace std;
using namespace tbb;

class Foo : public boost::thread {
    atomic<bool> _stop;

public:
    Foo();
    Foo(const Foo& rhs);
    void operator()();
    void stop();
};

Foo::Foo() : thread(ref(*this)) {
    cout << "Foo::Foo() called: " << this << endl;
    _stop = false;
}

Foo::Foo(const Foo& rhs) {
    cout << "Foo::Foo(const Foo&) called: " << this << endl;
    _stop = rhs._stop;
}

void Foo::stop() {
    _stop = true;
    cout << "Foo:stop() set _stop=" << _stop << endl;
    cout << "Foo:stop() calling interrupt()" << endl;
    interrupt();
    cout << "Foo:stop() calling join()" << endl;
    join();
    cout << "Foo:stop() joined" << endl;
}

void Foo::operator()() {
    int i = 0;
    while (!_stop) {
        cout << "   Foo::operator() still alive " << i << " (" << this << ")" << endl;
        if (_stop) {
            cout << "   Foo::operator() is asked to finish" << " (" << this << ")" << endl;
            break;
        }
        boost::this_thread::sleep( boost::posix_time::seconds(20) );
        ++i;
    }
}

int main() {
    Foo foo;

    cout << "starting longer calculation" << endl;
    int sum;
    for (int i = 0; i < 3; ++i) {
        sum += i;
        sleep(1);
    }
    cout << "finished longer calculation" << endl;

    foo.stop();

    return 0;
} 
```

这导致

```
Foo::Foo() called: 0x7fff6c7b9ff0
starting longer calculation
   Foo::operator() still alive 0 (0x7fff6c7b9ff0)
finished longer calculation
Foo:stop() set _stop=1
Foo:stop() calling interrupt()
Foo:stop() calling join()
Foo:stop() joined 
```

# javascript - 来自 coffescript/javascript 函数数组的真正奇怪的行为

> ID：12251783
> 
> 赞同：0
> 
> 时间：2012-09-03T17:06:16.813
> 
> 标签：javascript, arrays, coffeescript, anonymous-function

我的代码似乎在 chrome 中带来了某种量子决斗状态，调用了一个宇宙，在这个宇宙中，函数`undefined`在被推送到数组时会变成......

我正在使用以下代码构建一组函数，以便使用此函数将它们链接在一起[https://gist.github.com/3609831](https://gist.github.com/3609831)

```
console.log "creating stack"

ids = (id for id of @s3) # an array of integers

stack = [callback]
console.log stack

for ssid of @s3
  new_func =  ((cb) => @idb.load_s3(ssids.shift(),cb))
  console.log new_func
  stack.push new_func
  console.log stack

console.log "stack done" 
```

奇怪的是，尽管它实际上似乎有效；所有带有正确参数的函数调用似乎都在发生，它也在控制台中得到这个（使用我的格式和注释）

```
> creating stack

# callback added to array correctly
> [function () { return _this.start(true); }]

# function generated correctly
> function (cb) { return _this.idb.load_s3(ssids.shift(), cb); } 

# but the function doesn't get added to the array !!!!!!!
> [function () { return _this.start(true); }, undefined × 1]

> stack done

# and the undefined from the array can't be executed of course, verified my line number
> Uncaught TypeError: undefined is not a function 
```

这似乎意味着虽然它有效......它也没有工作......因为...... new_func 在被推送到数组时变成未定义......

怎么回事？？？

有人对这里可能发生的事情有任何线索吗？

我正在使用 chrome v21

...

编辑：仅供参考 @idb.load_s3 函数在范围内，我知道它正在工作，因为它从 indexedDB 加载数据，如果其中任何部分被破坏，则不会加载（并且因为回调确实触发）。

...

EDIT2：这是javascript，没什么不同或奇怪的，只是更难阅读

```
var id, ids, new_func, ssid, stack,
  _this = this;

console.log("creating stack");

ids = (function() {
  var _results;
  _results = [];
  for (id in this.s3) {
    _results.push(id);
  }
  return _results;
}).call(this);

stack = [callback];

console.log(stack);

for (ssid in this.s3) {
  new_func = (function(cb) {
    return _this.idb.load_s3(ssids.shift(), cb);
  });
  console.log(new_func);
  stack.push(new_func);
  console.log(stack);
}

console.log("stack done"); 
```

...

编辑 3：刚刚意识到问题的一部分是因为 Chrome 的控制台可能是异步的，所以似乎最后一项从堆栈中弹出（在此处未显示的代码中）在调用 console.log 之后但在 console.log 实际输出之前数组内容！！！因此，当我不调用函数（参见引用的要点）来执行堆栈时，其余部分似乎工作正常。

然而，这并不能解决抱怨 undefined 不是函数的异常的谜​​团（就像它试图从数组中弹出 undefined 并执行它）......仍然很奇怪！

...

编辑#4：load_s3 函数在这里：[https](https://github.com/gnatters/neuroanatomist/blob/master/app/assets/jax/models/asset_loader.js.coffee.erb#L118) ://github.com/gnatters/neuroanatomist/blob/master/app/assets/jax/models/asset_loader.js.coffee.erb#L118 代码的真实版本是这里质疑的是在 #L145 的 load_everything 的同一个文件中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T23:45:48.113

我解决了！这个问题有两个部分看起来是一样的。首先，在编辑 3 中，数组看起来在函数被推送的地方包含一个未定义的项目。然而，这似乎是 chrome 的异步控制台中的一个怪癖（错误？），在 console.log 调用和数组的实际日志记录之间的时间内，该函数被从数组中删除。

问题的第二部分在外观上也具有欺骗性，很抱歉我在提问时认为这不是那么重要。在链接的[要点](https://gist.github.com/3609831)（现已修订）中，该函数试图从数组中弹出并执行一个额外的函数，这当然等于尝试所有未定义的函数。不容易发现...

一切都很好。感谢参与 ;）

# visual-studio-2010 - Visual C++ 2010。如何包含驻留在另一个包含项目中的头文件

> ID：12251784
> 
> 赞同：1
> 
> 时间：2012-09-03T17:06:33.073
> 
> 标签：visual-studio-2010, visual-c++

我有 1 个项目。我在这个项目中导入了许多外部 VC++ 项目。我想在一个包含项目中的 .c 文件中导入一个 .h（头文件），该文件位于另一个包含的 VC++ 项目中。怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T17:23:57.650

在项目的属性中，将头文件的位置添加到

```
C/C++ | General | Additional Include Directories 
```

物品。

要获取链接的库项目，请在以下位置添加对它的引用：

```
Common Properties | Framework and References 
```

物品。

我希望添加项目引用会使 IDE 自动将引用的项目目录添加到包含文件路径中，但事实并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T20:14:23.187

您应该添加另一个项目的路径。最好使用宏`$(SolutionDir)`来引用解决方案中的其他项目。

# android - 安卓蓝牙读取rssi信号强度

> ID：12251785
> 
> 赞同：2
> 
> 时间：2012-09-03T17:06:34.263
> 
> 标签：android, bluetooth, rssi

我需要测量两部或多部手机之间的蓝牙信号并检测范围内最近的手机。经过大量研究后，我想到定期发现新的蓝牙设备并通过 ACTION_FOUND 返回的 EXTRA_RSSI 测量 rssi。所有设备必须始终处于发现模式，并且还必须定期扫描其他设备。

这种方法好还是有更好的解决方案？这种方法会出现什么问题？

此解决方案[Android 2.1：如何轮询现有蓝牙连接的 RSSI 值？](https://stackoverflow.com/questions/2149295/android-2-1-how-do-i-poll-the-rssi-value-of-an-existing-bluetooth-connection)对我不起作用，因为需要将手机植根。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T08:10:08.467

RSSI 在现实世界条件下是一个不好的距离指标。

它可以在理想条件下工作（自由空间传播），但实际上你总是有影响传播的障碍物，如墙壁、树木等。

有关传播模型的更多详细信息，请参阅[本文](http://people.seas.harvard.edu/~jones/es151/prop_models/propagation.html#fsl)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T07:48:59.457

RSSI 不指示哪部手机最近，只指示哪部手机信号最强。

# c# - 实体类内流畅的NHibernate映射类

> ID：12251791
> 
> 赞同：0
> 
> 时间：2012-09-03T17:07:10.197
> 
> 标签：c#, nhibernate, fluent-nhibernate, entity, fluent-nhibernate-mapping

我现在正在学习 Fluent NHibernate，并且有一个关于映射的问题。这不是问题，而是最佳实践问题。

我知道 Fluent NHibernate 有一个新的 fluent 映射，它需要一个新的类来映射实体类将使用的字段。我想知道，如果映射类直接链接到实体类（它将为实体类精确映射），最佳实践是否规定它们不能在同一个 .cs 文件中加入？请注意，这里不会有嵌套。

即：有 Product 和 ProductMap 类，它们都用于我的数据库中的 Product 表，所以我会将这两个类放在同一个 Product.cs 中，如下所示：

```
namespace Business.Entity
{
    public class Product
    {
        ...
    }

    public class ProductMap : ClassMap<Product>
    {
        ...
    }
} 
```

如果这些类不应该在同一个文件中，您是否愿意解释原因，也许还有真实的例子？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:13:48.670

创建`SessionFactory`实例时，您将传递一个类，该类告诉哪个程序集具有映射定义。然后，使用反射，它将遍历该程序集上所有继承自`ClassMap<T>`.

也就是说，为了更快的初始化，最好让这个程序集尽可能轻，这意味着最好有一个只包含映射而不是类定义的程序集。

*AFAIK*这是唯一的区别。任何反馈将不胜感激。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:14:23.393

你应该尽可能地设计你的实体持久无知。

这意味着你不应该`Product`派生自`ClassMap<Product>`. 但这也意味着`ProductMap`甚至不应该与您的实体在同一个**项目中。**

通常，您将拥有一个包含映射的 DAL 项目和一个包含实体的域/业务项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T17:34:15.100

您可以将这两个类保存在不同的文件中，甚至在不同的命名空间中。但是如果您是初学者，那么您可以将实体类保存在不同的文件中，并将类映射到同一命名空间内的不同文件中。

```
/* Product.cs */
namespace Business.Entity
{
    public class Product
   {
    ...
   }
}

/* ProductMap.cs */
namespace Business.Entity
{
    public class ProductMap : ClassMap<Product>
    {
    ...
    }
} 
```

# mysql - wordpress/codeigniter 传递sql数据库密码

> ID：12251798
> 
> 赞同：0
> 
> 时间：2012-09-03T17:08:03.673
> 
> 标签：mysql, wordpress, passwords

我遇到了一个需要快速解决的问题。我会试着解释一下。

我有表 wp_user（来自 WordPress），其中所有成员都使用 wordpress 加密功能加密了密码。我必须将此表转移到使用 Codeigniter 的新网站上的新 Mysql 数据库。

对于在 codeigniter 下工作的新站点上的新成员，我使用 MD5 函数来屏蔽密码。

但问题是这两个功能是不同的，所以当一个老用户尝试连接我的新网站时，这不起作用，因为密码不匹配......

那么，我该如何翻译普通 MD5 密码中的 wordpress 加密呢？

或者也许这是不可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:09:59.883

不幸的是，您必须执行这两项检查，或者只是更改 CI 以使用与 WP 相同的哈希方案。这可能是更简单的选择。如果你真的想开始使用默认的 CI 散列方案，你可以存储两个散列并在成功登录时更新新的散列（当你有明文密码时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:36:31.037

我不熟悉 Wordpress 对密码使用哪种散列方法，但我认为它是安全且不可逆的。由于散列是一种单向算法，因此散列密码*无法转换为其 MD5 等效密码。*

这是我给你的建议：

在您的新网站的用户表中添加一个`using_md5_flag`布尔列，并使用默认值`0`。将密码从 Wordpress 复制到一个列中`wppassword`，并创建一个名为`md5password`当用户登录系统时执行以下代码的列（假设 Datamapper ORM，如果需要，转换为 Active Record）：

```
$u = new User();
$u->where('username', $this->input->post('username'))->get();

$y = new User();
$y->where('username', $this->input->post('username'));
if($u->using_md5_flag){
    /*the flag is 1*/
    $y->where('md5password', md5($this->input->post('password')));
    $y->get();
    if($y->exists()) echo "setting cookie and redirecting to logged in area";
    else echo "Wrong credentials!";
}

else{
    /*the flag is 0, use wordpress's hashing algorithm (not sure what this is)*/
    $y->where('wppassword', wp_hashing_algo($this->input->post('password')));
    $y->get();
    if($y->exists()){
        /*set the using_md5_flag flag so next time they log in it will ignore wp's*/
        $y->using_md5_flag = 1;
        /*set the new md5 password.*/
        $y->md5password = md5($this->input->post('password'));
        $y->save();
        echo "setting cookie and redirecting to logged in area";
    }
    else{
        echo "Wrong credentials.";
    }
} 
```

此代码尚未经过测试，我是在 StackOverflow 的编辑器中编写的……但这是我将慢速转换为更安全的哈希所采用的方法。最后，如果您正在寻找一个真正安全的哈希，请查看 Bcrypt ( [phpass](http://www.openwall.com/phpass/) )，它更能抵抗彩虹表攻击。

* * *

**更新 1：**如果你需要在 CodeIgniter 中使用 Phpass 库，你可以在[这里](http://pastebin.com/R5aVDve6)找到我修改的副本（我添加了一个构造函数）。将其放入`libraries/Phpass.php`您可以使用以下方法在控制器中使用该库：

```
$this->load->library("phpass", array("iteration_count_log2" => 8, "portable_hashes" => FALSE));
$check = $this->phpass->CheckPassword($this->input->post('password'), $u->password);
if($check) /*logged in*/
else /*wrong credentials.*/ 
```

当您下载 Phpass 文件时，它会附带一个`test.php`演示函数如何工作的文件。我建议审查它。

# matlab - 快速图像扫描

> ID：12251800
> 
> 赞同：0
> 
> 时间：2012-09-03T17:08:08.917
> 
> 标签：matlab, image-processing, opencv, pattern-matching, pattern-recognition

我有一个非常大的图像，我想用一个小模板 (T) 扫描它并存储在数据库中，然后使用该数据库进行图像重建。但是，如果我想扫描所有图像，我的模式数据库的大小会非常大。是否有任何解决方案可以减少模式数据库的大小？或者，有没有什么方法可以扫描图像来制作一个更小但更丰富的图案数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T05:41:07.310

You could run PCA on your template database to generate an alternate orthogonal template basis. All of your original templates are linear combinations of these basis templates. Since convolution is a linear operation you can convolve the image with each of the basis templates and recombine the results using the appropriate weights the get the results you would have gotten with each of the original templates.

PCA is usually used for dimensionality reduction, and so, you can choose just the first N basis templates as your approximate alternate templates. These should give a good approximation for the original DB but with reduced computational time.

N should be determined by the magnitude of the eigen-value corresponding to the selected basis eigen-vector (template).

# db2 - DB2 时间戳选择语句

> ID：12251802
> 
> 赞同：8
> 
> 时间：2012-09-03T17:08:20.147
> 
> 标签：db2, timestamp

我正在尝试运行一个简单的查询，该查询根据时间戳获取数据，如下所示：

```
SELECT * 
FROM <table_name> 
WHERE id = 1 
AND usagetime = timestamp('2012-09-03 08:03:06') 
WITH UR; 
```

这似乎没有向我返回记录，而该记录存在于 id = 1 的数据库中。

我在这里做错了什么？

列使用时间的数据类型正确，设置为时间戳。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-03T23:17:47.360

@bhamby 是正确的。通过保留时间戳值的微秒，您的查询将仅匹配 2012-09-03 08:03:06.000000 的使用时间

如果您没有从先前的查询中捕获完整的时间戳值，您可以指定一个范围谓词，该谓词将匹配该时间的任何微秒值：

```
...WHERE id = 1 AND usagetime BETWEEN '2012-09-03 08:03:06' AND '2012-09-03 08:03:07' 
```

或者

```
...WHERE id = 1 AND usagetime >= '2012-09-03 08:03:06' 
   AND usagetime < '2012-09-03 08:03:07' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-19T21:02:34.323

在与字符串格式进行比较时，您可能希望在列上使用 TRUNC 函数，因此它只比较到秒，而不是毫秒。

```
SELECT * FROM <table_name> WHERE id = 1 
AND TRUNC(usagetime, 'SS') = '2012-09-03 08:03:06'; 
```

如果您想截断到分钟、小时等，这也是可能的，只需使用适当的符号而不是“SS”：

```
hour ('HH'), minute('MI'), year('YEAR' or 'YYYY'), month('MONTH' or 'MM'), Day ('DD') 
```

# html - @font-face 导致加载时间变慢

> ID：12251805
> 
> 赞同：16
> 
> 时间：2012-09-03T17:08:30.853
> 
> 标签：html, css, font-face, page-load-time

最近我开始注意到网站在某些时候加载速度很慢。

我用萤火虫对此进行了调查，当页面加载时间很长时，就会出现：

![Firebug 网络检查](../Images/313ac01d55869cd8ee4086e91cddb60c.png) 它似乎完全随机，但对 webfont.woff 的请求只是等待并永远等待。如果我尝试手动访问此资源，它可以正常工作并在 100 毫秒内响应。我正在谈论的页面是[http://wtf.maikelzweerink.nl](http://wtf.maikelzweerink.nl)，自定义字体来自主域 maikelzweerink.nl。

面部字体在 default.css 中声明，同样来自主域：

```
@font-face {
    font-family: 'Proximanova Regular';
    src: url('//maikelzweerink.nl/general/font/Proximanova-Regular/webfont.eot');
    src: url('//maikelzweerink.nl/general/font/Proximanova-Regular/webfont.eot?#iefix') format('embedded-opentype'),
         url('//maikelzweerink.nl/general/font/Proximanova-Regular/webfont.woff') format('woff'),
         url('//maikelzweerink.nl/general/font/Proximanova-Regular/webfont.ttf') format('truetype'),
         url('//maikelzweerink.nl/general/font/Proximanova-Regular/webfont.svg#ProximaNovaRgRegular') format('svg');
} 
```

**即使使用正确的 HTTP 标头**

在 chrome 中同样的交易[（点击查看大图）](https://dl.dropbox.com/u/3060487/font-face-chrome.png)： ![铬时间测试](../Images/4a986655fa34c31baaa038dacb650278.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-03T17:11:58.963

MIME 类型在字体上设置为 text/plain，而不是它们应该是什么。

在您的 .htaccess 文件（假设为 Apache）中，添加：

```
AddType application/vnd.ms-fontobject  eot
AddType application/x-font-ttf         ttf ttc
AddType font/opentype                  otf
AddType application/x-font-woff        woff 
```

这将解决问题，并确保字体在所有浏览器中都能正常工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-06-20T10:41:10.010

你需要像这样预加载或预取你的字体

```
<link rel="preload" as="font" href="/fonts/Pacifico-Regular.ttf" type="font/ttf" crossorigin="anonymous"> 
```

更多信息[如何加载 Web 字体以避免性能问题并加快页面加载](https://www.freecodecamp.org/news/web-fonts-in-2018-f191a48367e8/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-04T17:08:43.247

我使用 base64 编码将字体嵌入到 CSS 中以减少请求量。base64 的缺点是需要花费更多的初始带宽，但是嘿，它可以工作！这解决了它。

当然，我对 180KB 大小的 CSS 文件并不满意：/

**编辑：** 原来是 ISP 的问题。当我手动加载字体时，它会从缓存中检索它（该死的铬！）。不知何故，这些字体在 ISP 服务上不直接可用并且从硬盘请求/读取将需要一段时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T15:10:57.187

不仅仅是字体...

如果我在 Chrome 中一遍又一遍地重新加载页面，我也会看到图像卡住了

你可以在这里看到这个瀑布中的图像很慢 - [http://www.webpagetest.org/result/120904_JN_85ef2c2901df72a0b0ec4b3181eeec77/1/details/](http://www.webpagetest.org/result/120904_JN_85ef2c2901df72a0b0ec4b3181eeec77/1/details/)

# tesseract - 正方体和 Tess4J

> ID：12251811
> 
> 赞同：3
> 
> 时间：2012-09-03T17:09:35.023
> 
> 标签：tesseract

我有一个关于 tesseract 培训的问题。我目前正在使用 Tess4J 将 tesseract 集成到我的 java 程序中。阅读有关 tesseract 训练的 tesseract wiki 页面 (http://code.google.com/p/tesseract-ocr/wiki/TrainingTesseract3)，可以使用具有各种组合和字体的训练图像来训练 tesseract。

我是否可以只安装一个“普通”的 tesseract 3.02（windows 或 unix）安装来构建这些 lang.traineddata 文件，然后将其包含在我的 java 程序中的 Tess4J 包装器使用的 tessdata 文件夹中。或者 Tess4J 是否仅限于包含的英语语言数据以及与程序捆绑在一起的示例图像？

如果是这样，是否可以通过其他方式将这些包含到我的 Tess4J 构建中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-08T21:33:04.473

由于它只是 Tesseract OCR 引擎的包装器，因此它接受任何标准问题或自定义训练数据文件。[您可以在https://github.com/tesseract-ocr/tessdata](https://github.com/tesseract-ocr/tessdata)找到标准的训练数据。

# r - 组合 data.tables 列表

> ID：12251822
> 
> 赞同：25
> 
> 时间：2012-09-03T17:11:01.457
> 
> 标签：r, data.table

有没有一种特定的方法来组合 R 中的 data.tables 列表？

我有一个大约 20 个 data.table 的列表，每个都有大约 100 万行，并且想将它们组合成一个具有 2000 万行的 data.table。

我一直在做

```
Reduce('rbind', data.table) 
```

但这需要一段时间。

天呐！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-03T17:34:42.457

查看`?rbindlist`和这些相关问题（当您知道要搜索什么时更容易找到！）：

[data.table 问题和答案包含`rbindlist`](https://stackoverflow.com/search?tab=votes&q=%5Bdata.table%5D%20rbindlist)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-09-03T17:21:05.030

使用`do.call`这个组成的示例，使用速度似乎快了大约 10 倍：

```
library(data.table)

x1 <- data.table(x = runif(1e6), y = runif(1e6))
x2 <- data.table(x = runif(1e6), y = runif(1e6))

#20 data.tables all of length 1e6
yourList <- list(x1,x2,x1,x2,x1,x2,x1,x2,x1,x2,x1,x2,x1,x2,x1,x2,x1,x2,x1,x2)

system.time(out1 <- Reduce("rbind", yourList))
#-----
   user  system elapsed 
   3.37    3.03    6.43 
system.time(out2 <- do.call("rbind", yourList))
#-----
   user  system elapsed 
   0.33    0.36    0.68 
all.equal(out1,out2)
#-----
[1] TRUE 
```

## 编辑 - 合并马特的答案

我没有意识到`data.table`这个任务有一个特定的功能。课程标准杆，速度相当快。以下是相关时间：

```
system.time(out3 <- rbindlist(yourList))
#-----
   user  system elapsed 
   0.07    0.03    0.11 

all.equal(out1,out3)
#-----
[1] TRUE 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T03:43:17.970

为了我的钱， plyr 包`ldply`是做到这一点的方式。我的优点是列表元素的名称被添加为新的第一列，名为`.id`.

此外，数据帧列表通常是 的输出`tapply`，在这种情况下，将整个 shebang 替换为`ddply`。

替代品包括`do.call("rbind", mylist)`or lattice's `make.groups`（虽然最近没能找到这个）。

* * *

注意：我可能误解了这个问题——我读`data.frame`的是`data.table`. 这些技术仍然有效，但我不确定它们是否`data.table`始终有效。

# symfony - RoleInterface 抛出“调用非对象”错误

> ID：12251825
> 
> 赞同：11
> 
> 时间：2012-09-03T17:11:12.677
> 
> 标签：symfony

我正在使用 Symfony 2.0.16

我的 UserProvider 中有 getRoles 方法

```
public function getRoles()
{
    /**
     * @var \Doctrine\Common\Collections\ArrayCollection $rol
     */
    return $this->rol->toArray();
} 
```

我的角色实体有角色界面

```
class Rol implements \Symfony\Component\Security\Core\Role\RoleInterface
//...
public function getRole()
{
    return $this->getName();
} 
```

但是当我尝试登录时出现以下错误

> 致命错误：在第 57 行调用 C:\Users\julian\Code\parqueadero\vendor\symfony\src\Symfony\Bundle\SecurityBundle\DataCollector\SecurityDataCollector.php 中非对象的成员函数 getRole()

读取类SecurityDataCollector，错误是由一个闭包引发的

```
array_map(function ($role){ return $role->getRole();}, $token->getRoles() 
```

现在我把它改成

```
array_map(function ($role){ var_dump($role); return $role->getRole();}, $token->getRoles() 
```

令我惊讶的是，`$role`是一个对象 Rol 但**我不明白为什么会出现错误。**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-03T17:56:18.637

我发现解决方案问题是**PHP 5.4**（我正在使用的php）**序列化方法**中的一个错误github用户[yoannch](https://github.com/yoannch)提出了这个[解决方案](https://github.com/symfony/symfony/issues/3691#issuecomment-5041109)`serialize/unserialize`，是使用方法覆盖`json_encode/json_decode`方法

```
class User implements \Serializable

//...

/**
 * Serializes the content of the current User object
 * @return string
 */
public function serialize()
{
    return \json_encode(
            array($this->username, $this->password, $this->salt,
                    $this->rol, $this->id));
}

/**
 * Unserializes the given string in the current User object
 * @param serialized
 */
public function unserialize($serialized)
{
    list($this->username, $this->password, $this->salt,
                    $this->rol, $this->id) = \json_decode(
            $serialized);
} 
```

只需要更改正确的名称属性

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-26T15:54:14.660

我有同样的问题（Windows，PHP 5.4.5），更新到 5.4.7，但它仍然没有工作。尽管如此，我想出了一个需要较少维护的解决方法（当覆盖您提到的文章中描述的序列化函数时，您必须在添加/删除字段时使它们保持最新）。到目前为止它对我有用，我希望我可能忘记的解决方法不会导致其他问题。只需像这样更改用户的`getRoles()`功能：

```
/**
 * @inheritDoc
 */
public function getRoles()
{
    $roles = array();
    foreach ($this->userRoles as $role) {
        $roles[] = $role->getRole();
    }

    return $roles;
} 
```

请注意，`$role->getRole()`将角色名称作为字符串返回（例如`ROLE_ADMIN`）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-06T17:01:05.050

这个问题的解决方法很简单。`User`与您和`Role`对象的循环引用相关的所有问题。所以你不必序列化`User::$roles`和`Role::$users`字段。

看`Symfony\Component\Security\Core\Authentication\Token\AbstractToken::__construct()`和`Symfony\Component\Security\Core\Authentication\Token\AbstractToken::serialize()`。

你怎么看，Symfony 通过`UserInterface::getRoles()`在序列化之前调用来扮演你用户的角色。`User`并分别序列化`Roles`。

您必须在和实体中实现`\Serializable`接口。`User``Role`

## 例子：

```
/**
 * Acme\Bundle\UserBundle\Entity\User
 * 
 * @ORM\Table(name="`user`")
 * @ORM\Entity(repositoryClass="Acme\Bundle\UserBundle\Entity\UserRepository")
 */
class User implements AdvancedUserInterface, EquatableInterface, \Serializable
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string $username
     * 
     * @ORM\Column(type="string", length=30, unique=true)
     */
    private $username;

    /**
     * @var string $email
     * 
     * @ORM\Column(type="string", length=100, unique=true)
     */
    private $email;

    /**
     * @var string $salt
     *
     * @ORM\Column(type="string", length=40)
     */
    private $salt;

    /**
     * @var string $password
     *
     * @ORM\Column(type="string", length=128)
     */
    private $password;

    /**
     * @var boolean $isActive
     *
     * @ORM\Column(type="boolean")
     */
    private $isActive;

    /**
     * User's roles. (Owning Side)
     * 
     * @var ArrayCollection
     * 
     * @ORM\ManyToMany(targetEntity="Role", inversedBy="users")
     */
    private $roles;

    // .....

    /**
     * @see \Serializable::serialize()
     */
    public function serialize()
    {
        /*
         * ! Don't serialize $roles field !
         */
        return \serialize(array(
            $this->id,
            $this->username,
            $this->email,
            $this->salt,
            $this->password,
            $this->isActive
        ));
    }

    /**
     * @see \Serializable::unserialize()
     */
    public function unserialize($serialized)
    {
        list (
            $this->id,
            $this->username,
            $this->email,
            $this->salt,
            $this->password,
            $this->isActive
        ) = \unserialize($serialized);
    }

} 
```

```
/**
 * Acme\Bundle\UserBundle\Entity\Role
 *
 * @ORM\Table(name="role")
 * @ORM\Entity
 * 
 */
class Role implements RoleInterface, \Serializable
{
    /**
     * @var integer $id
     *
     * @ORM\Column(type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string $role
     *
     * @ORM\Column(name="role", type="string", length=20, unique=true)
     */
    private $role;

    /**
     * Users in group (Inverse Side)
     * 
     * @var ArrayCollection
     * 
     * @ORM\ManyToMany(targetEntity="User", mappedBy="roles")
     */
    private $users;

    // .....    

    /**
     * @see \Serializable::serialize()
     */
    public function serialize()
    {
        /*
         * ! Don't serialize $users field !
         */
        return \serialize(array(
            $this->id,
            $this->role
        ));
    }

    /**
     * @see \Serializable::unserialize()
     */
    public function unserialize($serialized)
    {
        list(
            $this->id,
            $this->role
        ) = \unserialize($serialized);
    }
} 
```

并且所有内容都将正确序列化/反序列化。

[请参阅https://github.com/symfony/symfony/issues/3691](https://github.com/symfony/symfony/issues/3691)上的铁饼

另见： [http ://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/entities-in-session.html#serializing-entity-into-the-session](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/entities-in-session.html#serializing-entity-into-the-session)

# http - 请求 IP 不在范围内时出错

> ID：12251829
> 
> 赞同：0
> 
> 时间：2012-09-03T17:11:50.590
> 
> 标签：http

我正在研究安全实施，我已经开发了`IP`过滤安全应用程序。所以我想知道如果用户不在预期范围内`HTTP`应该返回哪个错误代码？`IP`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:16:51.163

403 - 禁止

详情在这里：[http ://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:17:59.587

首先，如果您的应用程序在服务器上运行......以下将是合适的......

```
403 - Forbidden 
```

403 状态代码表示`client cannot access the requested resource`. 这可能意味着`wrong username`and`password`是在请求​​中发送的，或者`permissions on the server do not allow what was being asked`.

# c++ - C++ boost.regex 字符串中指定的重复次数

> ID：12251830
> 
> 赞同：0
> 
> 时间：2012-09-03T17:11:52.883
> 
> 标签：c++, regex, boost-regex

假设我想创建一个 boost.regex 表达式来匹配字符串，例如

“重复：5 aaaa” “重复：3 aaa”

有没有办法通过提升来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:26:25.697

我没有特别使用 boost::regex，但是您要求的正则表达式是直截了当的。浏览 boost::regex 文档，看起来你会做类似的事情：

```
boost::regex e("repetitions:\\s+\\d\\s+[a-zA-Z]+"); 
```

（双斜线是这样转义序列不会被编译器吞噬）

注意：如果您还尝试验证第一个数字是否与字母“a”的数量匹配，那么仅使用正则表达式将无法正常工作。正则表达式只匹配字符，对它们的含义没有任何线索，因此 '5' 和 '3' 不会以任何数字方式出现。查看他们关于[Captures](http://www.boost.org/doc/libs/1_51_0/libs/regex/doc/html/boost_regex/captures.html)的文档。您需要将数字作为字符串，`lexical_cast`将其转换为整数，然后使用它来验证该`aaaaa`部分。

# join - 教义 dql 自定义加入 on

> ID：12251831
> 
> 赞同：2
> 
> 时间：2012-09-03T17:11:53.647
> 
> 标签：join, doctrine, foreign-keys, dql

我的表**没有外键，也没有****教义**上的关系， 但从逻辑上讲，它们与某些领域相关。
我怎样才能加入他们的 DQL 和查询他们。
我可以`ON`在他们的领域之间使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T13:52:08.247

正如我在[这里](https://groups.google.com/forum/?fromgroups=#!topic/doctrine-user/6BZZQQwoi3w)发现的：

> 自定义左连接与不相关的模型：不幸的是，这在 Doctrine 1 ORM 中是不可能的。我认为在这种情况下，您最好直接使用数据库。

# asp.net - 无法在文本框中键入双精度

> ID：12251832
> 
> 赞同：5
> 
> 时间：2012-09-03T17:11:58.493
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, entity-framework

我正在开发一个 mvc .net Web 应用程序，并且正在使用实体框架来生成模型。我有包含双精度属性的类。我的问题是，当我使用`@HTML.EditorFor(model => model.Double_attribute)`和测试我的应用程序时，我无法在该编辑器中输入双精度，我只能输入整数。（我正在使用 Razor 引擎获取视图）如何解决这个问题？谢谢。

更新：我发现我可以输入具有这种格式的双精度 #,###（逗号后的 3 个数字，但我不想让用户输入特定格式，我想接受所有格式（1 个或多个数字后逗号）有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T11:01:52.693

You could use add notations :

```
[DisplayFormat(DataFormatString = "{0:#,##0.000#}", ApplyFormatInEditMode = true)]
public double? Double_attribute{ get; set; } 
```

And now... voila : you can use the double in your view :

```
@Html.EditorFor(x => x.Double_attribute) 
```

For other formats you could check [this](https://stackoverflow.com/questions/7375729/mvc3-3-decimal-places-on-type-double-with-leading-zero) or just google "DataFormatString double" your desired option for this field.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T05:43:35.047

try to use custom databinder:

```
public class DoubleModelBinder : IModelBinder
{
    public object BindModel( ControllerContext controllerContext,
        ModelBindingContext bindingContext )
    {
        var valueResult = bindingContext.ValueProvider.GetValue( bindingContext.ModelName );
        var modelState = new ModelState { Value = valueResult };
        object actualValue = null;

        try
        {
            actualValue = Convert.ToDouble( valueResult.AttemptedValue,
                CultureInfo.InvariantCulture );
        }
        catch ( FormatException e )
        {
            modelState.Errors.Add( e );
        }

        bindingContext.ModelState.Add( bindingContext.ModelName, modelState );
        return actualValue;
    }
} 
```

and register binder in global.asax:

```
protected void Application_Start ()
{
    ...
    ModelBinders.Binders.Add( typeof( double ), new DoubleModelBinder() );
} 
```

# javascript - 如何计算 3D 矩形的深度坐标？

> ID：12251835
> 
> 赞同：0
> 
> 时间：2012-09-03T17:12:08.663
> 
> 标签：javascript, actionscript-3, 3d

![长方形](../Images/45fe545da366d18506ce0b387944c97a.png)

如图所示，我有 3D 矩形。

在这里，我知道一端的深度距离和 x 和 y 坐标。基于这两个值，我想计算另一端的坐标。

为了清晰起见，我附上了一个屏幕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:15:27.190

如果您不知道 2D 和 3D 之间的关系（即使用的投影公式），那么您不能应用深度。

也就是说，如果您做出以下假设：

*   投影类型是正交的
*   深度线投影为 45 度线
*   45 度线的长度与法线相同

...然后你可以用毕达哥拉斯定理计算它，如下所示：

![三角形](../Images/bf6a7db2d4898ae04dd90276e5226ba4.png)

红线是相等的（如果是 45 度线），所以：

```
x1 = 100  +  50 * (1 / sqrt(2))
y1 = 50   -  50 * (1 / sqrt(2)) 
```

# c# - 带有“指定”标志的值对象

> ID：12251836
> 
> 赞同：3
> 
> 时间：2012-09-03T17:12:40.777
> 
> 标签：c#, .net, class-design, nullable

我需要将值传递给一个方法，以及每个值是指定还是未指定的指示，因为*null*本身就是一个有效值，因此不能解释为“未指定”。

我采用了通用方法并为这些值创建了一个简单的容器（见下文），但这是正确的方法吗？有没有更好的方法来解决这个问题 - 例如，框架中是否已经存在这样的类？

```
public struct Omissible<T>
{
  public readonly T Value;
  public readonly bool IsSpecified;
  public static readonly Omissible<T> Unspecified;

  public Omissible(T value)
  {
    this.Value = value;
    this.IsSpecified = true;
  }
} 
```

方法签名可能如下所示，允许调用者指示某些值不应更新（未指定），其他值应设置为 null/另一个值（指定）。

```
public void BulkUpdate(int[] itemIds, 
  Omissible<int?> value1, Omissible<string> value2) // etc. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:55:51.813

这是理论上可以做到的最好的。为了区分一般`T`和“`T`或`null`”，您需要一个可能的状态，而不是类型变量`T`可以容纳的状态。

例如，一个 32 位的 int 可以保存`2^32`状态。如果您还想保存一个`null`值，则需要`2^32 + 1`不适合 4 字节位置的可能状态。

因此，您还需要一个`bool`值。（从理论上讲，您只需要`log2(2^32 + 1) - 32`一些位`Omissible<int>`，但存储它的一种简单方法是 a `bool`）。

# ios - 在 NSUserDefaults 中存储 ON/OFF 开关？

> ID：12251839
> 
> 赞同：2
> 
> 时间：2012-09-03T17:12:52.343
> 
> 标签：ios, cocoa-touch, nsuserdefaults, uiswitch

我有一个应用程序，我使用 NSUserDefaults 来确定它是否是第一次有人打开该应用程序。如果是第一次，应用程序会显示一个教程页面。

现在，我想对此进行更改，以便如果用户将 ON/OFF 开关移动到“ON”，他们在启动应用程序时将看不到教程。如何在 NSUserDefaults 中存储用户对 ON/OFF 开关的选择？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T17:20:19.053

我用下面的代码做了这样的事情：

存储它：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
[userDefaults setBool:YES forKey:@"the_key"];
[[NSUserDefaults standardUserDefaults] synchronize]; //Thanks Henri Normak 
```

检索它：

```
[[NSUserDefaults standardUserDefaults] objectForKey:@"the_key"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:15:40.593

将其包裹在 NSNumber numberWithBool: 中。

```
[defaults setValue:[NSNumber numberWithBool:mySwitch.on] forKey:@"mySwitchValue"];

// and get it out
BOOL savedSwitch = [[defaults valueForKey:@"mySwitchValue"] boolValue]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:41:30.823

您需要将两个 bool 键保存在 NSUserDefaults 中才能获得您想要的。例如**firstTime**用于检查应用程序首次启动，**showTutorial**用于检查/保存开关更改

您可以使用以下方法设置布尔值：

```
[[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"firstTime"]; 
```

并使用以下代码阅读：

```
if([[NSUserDefaults standardUserDefaults] boolForKey:@"showTutorial"] || [[NSUserDefaults standardUserDefaults] boolForKey:@"firstTime"]) {
    [self displayTutorial];
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"firstTime"];
} 
else {
    [self displayMainScreen];
} 
```

将 UISwitch on View 从 InterfaceBuilder 链接到 valuechanged 上的此操作

```
-(IBAction)userSetOnOff:(id)sender
 {
      UISwitch *switchValue = sender;
      if (switchValue.on){
           [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"showTutorial"];
      }
      else{
           [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"showTutorial"];
      }

 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T21:47:44.230

在我的一个应用程序中，我检查是否使用了 NSUserDefaults，如果没有设置一个标准的用户默认变量。

-（id）初始化

{

```
standardUserDefaults = [NSUserDefaults standardUserDefaults];
NSString *testInitState = [standardUserDefaults stringForKey:kInstallInit];
if (testInitState == nil)
{

    #if(kStateModelDebug)
    NSLog(@" State Model: First time initialized");
    #endif
    [self.standardUserDefaults setObject:@"true"  forKey:kInstallInit];
    [self.standardUserDefaults synchronize];

    // Start the tutorials, init DB, etc

}
else 
{
    #if(kStateModelDebug)
    NSLog(@" State Model has ALREADY been initialized");
    #endif

    // Read other state variables and/or init the startup processes

}
return self; 
```

}

到目前为止，直到 ios 5.0 和新的 6.0，这一直是一个解决方案。寻找对此解决方案的评论。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-03T17:16:44.883

一种方法是简单地保留一个带有开关状态的字符串。如果用户更喜欢 on 位置，您将存储 string `@"on"`。否则存储字符串`@"off"`。

```
- (void) toggleUserPreference:(BOOL) preferOn {
    NSString *newPreference = preferOn ? @"on" : @"off";
    [[NSUserDefaults standardUserDefaults] setValue:newPreference
                                             forKey:ONOFF_PREFERENCE_KEY];
    [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

# c++ - 创建和链接各种 Cpps

> ID：12251842
> 
> 赞同：0
> 
> 时间：2012-09-03T17:13:09.620
> 
> 标签：c++, turbo-c++

我在想是否可以***单独***编写程序然后在单个程序中使用它
我的想法是制作一个用于存储配置文件的程序和另一个用于游戏逻辑的程序，
然后将它（或使用它）组合成程序

Profile.cpp --------- **bridge.cpp** -------------game.cpp

桥将用于访问（和显示）这两个 cpp

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:19:56.420

是的，C++ 支持**单独编译**，因此您可以在单独的源文件中分段编写程序。您编译这些文件并将它们链接在一起以创建可执行文件。命令行编译器可以为您完成：

```
bcc bridge.cpp profile.cpp game.cpp 
```

# android - 带有回调 URL 的 Twitter4j getOAuthRequestToken() 在 Android 上失败？

> ID：12251843
> 
> 赞同：3
> 
> 时间：2012-09-03T17:13:12.790
> 
> 标签：android, authentication, twitter, twitter4j

我正在尝试将 Twitter 集成到我的 Android 应用程序中，但似乎无法让 Twitter4j 注册我的应用程序。

我看到的关于 Android 问题的每个教程和问题都已有多年历史，从那时起事情似乎已经发生了变化。

我按照[本教程](http://blog.blundell-apps.com/sending-a-tweet/)中的步骤操作并使用提供的源代码来测试连接到 Twitter。知道源代码提供的 Twitter4j 版本已经过时，我稍后将其更新为最新版本和快照版本，但都无济于事。

```
private void loginNewUser() {
    try {
        Log.i(TAG, "Request App Authentication");

        // This line fails with error "Host is unresolved: api.twitter.com:80
        mReqToken = mTwitter.getOAuthRequestToken(); 

        Log.i(TAG, "Starting Webview to login to twitter");
        WebView twitterSite = new WebView(this);
        twitterSite.loadUrl(mReqToken.getAuthenticationURL());
        setContentView(twitterSite);

    } catch (TwitterException e) {
        Log.e("errors", e.getMessage());
        Toast.makeText(this, e.getMessage(), Toast.LENGTH_LONG).show();
    }
} 
```

任何人有任何使用 Twitter4j 的有效登录代码或知道问题的解决方案，我将不胜感激收到您的来信！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T09:18:02.887

好的，我想通了，我希望遇到同样问题的任何人都不必像我一样受苦。

1) 错误“Host is unresolved: api.twitter.com:80”来自设备没有 WiFi 信号或 3G 连接（我工作的办公室 WiFi 有点不稳定）。

2)`getOAuthRequestToken()`在任何高于 3.0 Honeycomb 的 Android 版本中崩溃，因为 HTTP 请求需要在与 UI 线程不同的线程上完成。我遇到了这个问题，因为我在我的 Android 清单中将目标版本设置为 4.0 Ice Cream Sandwich。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T10:16:19.770

我也遇到了这个问题，我无法登录 Twitter 的原因是我修改了设备的时间和日期以进行测试。

一旦我输入了正确的日期和时间，就可以登录 Twitter。

希望它可以帮助任何人。

# api - Twitter 搜索 API 是否受到最近 Twitter API 更改的影响？

> ID：12251854
> 
> 赞同：1
> 
> 时间：2012-09-03T17:14:09.727
> 
> 标签：api, search, twitter

[我一直在构建一个应用程序，它允许用户使用Twitter Search API](https://dev.twitter.com/docs/using-search)在 Twitter 上搜索最近（即 6-9 天）的公共推文。

目前，该网站是完全公开的——也就是说，用户无需登录 Twitter（甚至根本不需要成为 Twitter 用户）即可使用我的应用程序。

但是，[即将对 Twitter API](https://dev.twitter.com/blog/changes-coming-to-twitter-api)进行的更改让我感到困惑，尤其是对 Twitter API 的每个请求似乎都需要进行身份验证这一事实。

我对 Twitter API 工作原理的有限理解是，我需要使用 OAUTH 对我的应用程序进行身份验证，这反过来意味着，如果我想继续访问 Twitter Search API，用户需要先登录我的网站才能使用与搜索 API 相关的功能 - 因此，只有 Twitter 用户才能使用我的应用程序的该部分。

我是否正确理解这一点，或者 Twitter 搜索 API 是否免于更改？如果我对我的应用程序进行身份验证，这是否意味着用户通过我的应用程序搜索 Twitter 状态更新的速度会提高（或者与使用未经身份验证的应用程序相比的任何其他优势）？请注意，我目前正在实现一个缓存功能来缓存相关搜索。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T17:35:50.403

Twitter API 的更改会影响您的应用程序，具体取决于您的应用程序的工作方式。这些是您应该注意的更改：

1.  所有请求过去都是匿名的。现在，所有请求都必须通过 OAuth 进行身份验证。
2.  根据我的测试，使用旧的速率限制，您可以在每个 IP 地址每秒发出大约一个请求。现在，每个经过身份验证的用户每 15 分钟块可以发出 180 个请求（平均每 5 秒 1 个请求）。
3.  不相关，但仍然值得一提的是，新 API 返回的数据与 Streaming API 返回的数据更相似。它更完整。

因此，根据这些更改，如果您的应用程序使用某种机器人来轮询 Search API，将结果存储到数据库中，然后您的用户在这些存储的结果中进行搜索；您必须使用自己的访问令牌来实现 OAuth，您可以通过在 dev.twitter.com 上创建应用程序来获得该令牌。

但是，如果您的应用程序在每次用户与之交互时都连接到 Search API，并且您认为您必须平均每 5 秒发出一个以上的请求，那么您将不得不要求您的用户按顺序进行身份验证为您的请求获取他们的访问令牌。

# facebook - facebook代码在本地机器上不起作用

> ID：12251855
> 
> 赞同：0
> 
> 时间：2012-09-03T17:14:11.297
> 
> 标签：facebook, post, message, local

我正在使用下面的代码并尝试在我的本地机器上运行。我无法连接到 facebook。可能是什么问题？

```
<html>
    <head>
      <title>My Facebook Login Page</title>
    </head>
    <body>

      <div id="fb-root"></div>
      <script>
        window.fbAsyncInit = function() {
          FB.init({
            appId      : '', // App ID
            channelUrl : ' ', // Channel File
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true  // parse XFBML
          });
    function publish(){
          FB.ui({ method: 'feed', 
              message: 'Facebook for Websites is super-cool'});
        };
}
        // Load the SDK Asynchronously
        (function(d){
           var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
           if (d.getElementById(id)) {return;}
           js = d.createElement('script'); js.id = id; js.async = true;
           js.src = "http://connect.facebook.net/en_US/all.js";
           ref.parentNode.insertBefore(js, ref);
         }(document));
      </script>
    <button onclick="publish()">PUBLISH ON FACEBOOK</button>
    </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-29T00:59:18.687

To develop locally, first change the settings in the facebook app settings:

> Facebook-->Settings-->Basic, write *"localhost"* in the *"App Domains"* field, then click on *"+Add Platform"* choose *"Web Site"*.
> 
> Then in the *"Site Url"* field **write your localhost url** (e.g.: `http://localhost:1337/something`).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:21:45.737

您的代码看起来不错（假设您传递了正确的应用 ID） - 但您应该从在线环境进行测试。在本地机器上进行测试的同时，一种方法是编辑您的主机文件，以便当您访问`http://example.com`它时链接到您的`http://localhost/yourapp`

这是如何做到的：

窗户：-

*   [http://www.trailheadinteractive.com/creating_multiple_virtual_sites_a_single_apache_install_windows_xp](http://www.trailheadinteractive.com/creating_multiple_virtual_sites_a_single_apache_install_windows_xp)（您的本地主机 URL 应具有有效的网站格式：127.0.0.1 dummydomainname.tld）
*   MacOS：[http](http://danilo.ariadoss.com/how-to-setup-virtual-hosts-mamp-environment/) ://danilo.ariadoss.com/how-to-setup-virtual-hosts-mamp-environment/ （再次确保您的网站格式有效）

完成此操作后，返回您的应用程序设置并编辑“应用程序域”字段以指向您的虚拟主机。

老实说，您最好在实际服务器上尝试此操作。您可以考虑使用 phpfog.com 或 heroku.com（您可以直接从应用设置仪表板获得创建 Heroku 帐户的链接）。

# ios - 找到 mach_msg 的服务器端的好方法吗？

> ID：12251857
> 
> 赞同：0
> 
> 时间：2012-09-03T17:14:23.857
> 
> 标签：ios, macos, reverse-engineering, iphone-privateapi

我现在正在反汇编很多 iOS 操作系统代码（框架、系统守护进程）。进行系统调用的常用方法之一是使用 mach_msg。

所以，我可以在客户端看到 mach_msg 是如何构造的。我经常知道一个系统守护进程，它会处理这个调用。但是，我不确定如何在这个守护进程反汇编代码中找到调用处理程序。

有没有好的经验法则，如何找到处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T21:51:51.473

我发现以下（至少在一个守护进程中）

a) mach_msg_server_once 方法被调用，它的第一个参数是回调方法

b) 通常此回调方法检查 msgh_id 并在调度表中查找要调度调用的方法的地址。

# javascript - 在 jQuery 循环中触发 google swiffy 脚本

> ID：12251860
> 
> 赞同：0
> 
> 时间：2012-09-03T17:14:28.997
> 
> 标签：javascript, jquery, ajax, html, google-swiffy

我在单个页面上使用多个实例 Google 的 swiffy SWF 转换工具，并希望在按顺序命名的 div（content-1，content-2）的 jQuery 循环中一次激活它们。

我知道您可以通过以下方式控制每个实例的启动：

```
 stageName.start(true) 
```

如果它们按顺序命名（stageName1，stageName2），您是否可以在以下循环函数中触发每个动画：

```
$(document).ready(function(){

var divs = $('div[id^="content-"]').hide(),
    i = 0;

(function cycle() { 
    divs.eq(i).fadeIn(400)
              .delay(5000)
              .fadeOut(400, cycle);

    i = ++i % divs.length; // increment i, 
                           //   and reset to 0 when it equals divs.length
})();

});// JavaScript Document 
```

这就是它们现在在每个 'content-' div 中触发的方式：

```
<script>
var stage2 = new swiffy.Stage(document.getElementById('circle_lines'), circleobject);
stage2.start();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T23:18:47.710

希望这可以帮助其他使用 swiffy 的人。

即使没有某种 rewind(); 方法然而，有一个 destroy() 方法。

在我最初发布的一个 jQuery 循环中，我使用动态全局 JS 变量来不断启动和销毁一个新的 swiffy 对象。

这使我能够循环遍历不同的 div 并在每个循环中重新启动动画。

```
if (typeof window["Stage" + i] != 'undefined') {
    window["Stage" + i].destroy();
}

    i = ++i % divs.length; // increment i, 
                           //   and reset to 0 when it equals divs.length

    window["Stage" + i] = new swiffy.Stage(document.getElementById('graph_lines'), swiffyobject);
    window["Stage" + i].start(); 
```

# windows - 我的 NASM OpenGL 代码有什么问题？

> ID：12251861
> 
> 赞同：0
> 
> 时间：2012-09-03T17:14:30.597
> 
> 标签：windows, winapi, opengl, assembly, nasm

我正在尝试使用 NASMX 在 NASM 中使用 OpenGL 编写一个简单的程序。我在 C 中有此代码的工作版本，它可以工作。汇编版本并没有真正起作用。它编译并运行，但它只显示黑屏而不是带有白色像素的黑屏:)`ChangeDisplaySettingsA`似乎没有改变显示设置。

我宁愿不使用 NASMX，但我缺乏关于如何在没有 NASMX 的情况下执行此操作的知识。

我想我使用参数的方式有问题。所以你怎么看？这段代码有什么问题？一个工作代码示例的链接会很棒！

```
%include 'nasmx-1.0\inc\nasmx.inc'
%include 'nasmx-1.0\inc\win32\windows.inc'
%include 'nasmx-1.0\inc\win32\kernel32.inc'
%include 'nasmx-1.0\inc\win32\user32.inc'
%include 'nasmx-1.0\inc\win32\gdi32.inc'
%include 'nasmx-1.0\inc\win32\opengl32.inc'
%include 'nasmx-1.0\inc\win32\msvcrt.inc'

entry entrypoint

XRES    equ     1024
YRES    equ     786

[section .text]
proc    entrypoint, ptrdiff_t argcount, ptrdiff_t cmdline
locals none
    invoke  ChangeDisplaySettingsA, ptrdiff_t [dmScreenSettings], 0x00000004
    invoke  CreateWindowExA, 0, szEdit, 0, WS_POPUP + WS_VISIBLE, 0, 0, XRES, YRES, 0, 0, 0, 0
    invoke  GetDC, eax
    mov     ptrdiff_t [hDc], eax
    invoke  ChoosePixelFormat, ptrdiff_t [hDc], pfd
    invoke  SetPixelFormat, ptrdiff_t [hDc], eax, pfd
    invoke  wglCreateContext, ptrdiff_t [hDc]
    invoke  wglMakeCurrent, ptrdiff_t [hDc], eax
    invoke  ShowCursor, FALSE
    invoke  glViewport, 0, 0, XRES, YRES
    invoke  glMatrixMode, 0x1701
    invoke  glLoadIdentity
    invoke  glOrtho, 0, XRES, 0, YRES, -1, 1
    invoke  glMatrixMode, 0x1700
    invoke  glLoadIdentity
.intro_loop:
    invoke  glColor3ub, 255, 255, 255
    invoke  glBegin, 0x0000
    invoke  glVertex2i, 100, 100
    invoke  glEnd
    invoke  SwapBuffers, ptrdiff_t [hDc]
    invoke  PeekMessageA, 0, 0, 0, 0, PM_REMOVE
    invoke  GetAsyncKeyState, VK_ESCAPE
    cmp     eax, dword 0
    je      .intro_loop
    invoke  ExitProcess, 0
endproc

[section .bss]
    hDc:            reserve(ptrdiff_t) 1

[section .data]
    szEdit:         declare(NASMX_TCHAR) NASMX_TEXT("edit"), 0x0
    NASMX_ISTRUC pfd, PIXELFORMATDESCRIPTOR
        NASMX_AT nSize, 0
        NASMX_AT nVersion, 1
        NASMX_AT dwFlags, 33
        NASMX_AT iPixelType, 32
        NASMX_AT cColorBits, 0
        NASMX_AT cRedBits, 0
        NASMX_AT cRedShift, 0
        NASMX_AT cGreenBits, 0
        NASMX_AT cGreenShift, 0
        NASMX_AT cBlueBits, 0
        NASMX_AT cBlueShift, 0
        NASMX_AT cAlphaBits, 0
        NASMX_AT cAlphaShift, 0
        NASMX_AT cAccumBits, 0
        NASMX_AT cAccumRedBits, 0
        NASMX_AT cAccumGreenBits, 0
        NASMX_AT cAccumBlueBits, 0
        NASMX_AT cAccumAlphaBits, 32
        NASMX_AT cDepthBits, 0
        NASMX_AT cStencilBits, 0
        NASMX_AT cAuxBuffers, 0
        NASMX_AT iLayerType, 0
        NASMX_AT bReserved, 0
        NASMX_AT dwLayerMask, 0
        NASMX_AT dwVisibleMask, 0
        NASMX_AT dwDamageMask, 0
    NASMX_IENDSTRUC
    NASMX_ISTRUC dmScreenSettings, DEVMODE
        NASMX_AT dmDeviceName, ""
        NASMX_AT dmSpecVersion, 0
        NASMX_AT dmDriverVersion, 0
        NASMX_AT dmSize, 156
        NASMX_AT dmDriverExtra, 0
        NASMX_AT dmFields, 1572864
        NASMX_AT dmOrientation, 0
        NASMX_AT dmPaperSize, 0
        NASMX_AT dmPaperiLength, 0
        NASMX_AT dmPaperWidth, 0
        NASMX_AT dmScale, 0
        NASMX_AT dmCopies, 0
        NASMX_AT dmDefaultSource, 0
        NASMX_AT dmPrintQuality, 0
        NASMX_AT dmColor, 0
        NASMX_AT dmDuplex, 0
        NASMX_AT dmYResolution, 0
        NASMX_AT dmTTOption, 0
        NASMX_AT dmCollate, 0
        NASMX_AT dmFormName, ""
        NASMX_AT dmUnusedPadding, 0
        NASMX_AT dmBitsPerPel, 0
        NASMX_AT dmPelsWidth, XRES
        NASMX_AT dmPelsHeight, YRES
        NASMX_AT dmDisplayFlags, 0
        NASMX_AT dmDisplayFrequency, 0
        NASMX_AT dmICMMethod, 0
        NASMX_AT dmICMIntent, 0
        NASMX_AT dmMediaType, 0
        NASMX_AT dmDitherType, 0
        NASMX_AT dmReserved1, 0
        NASMX_AT dmReserved2, 0
        NASMX_AT dmPanningWidth, 0
        NASMX_AT dmPanningHeight, 0
    NASMX_IENDSTRUC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:46:58.897

你确定你在推动正确的论点吗？请记住，像这样的函数`glOrtho`需要双精度数，而不是浮点数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T12:15:49.197

请检查

[用于 NASMX 的 WIN32 的 OpenGL 演示](http://nasmx.svn.sourceforge.net/viewvc/nasmx/trunk/demos/win32/DEMO15/)

NASMX v1.2 具有此 OpenGL 演示以及 GL 和 GLUT 包括。

从[NASMX 下载 - Sourceforge.net](http://sourceforge.net/projects/nasmx/)

# php - 如何将 id 从“输入选择”传递给它的动作？

> ID：12251862
> 
> 赞同：1
> 
> 时间：2012-09-03T17:14:38.463
> 
> 标签：php, zend-framework, zend-form

大家好，让我解释一下：

```
$this->view->form = new Application_Form_Kursdaty();

     $url = $this->view->url(
        array(
            'action' => 'details',
            'controller' => $this->getRequest()->getControllerName(),
            'module' => $this->getRequest()->getModuleName(),
            'id' => @@@@@SELECTFIELD[selected]@@@@@@
        ),
        'default',
        true
    );
    $this->view->form->setAction($url); 
```

我基本上希望我的选择字段重定向到我选择的页面。我真的不知道该怎么办，请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:50:15.370

如果您的表单是发送数据的实例`Zend_Form`并填充了发送数据，那么您可以使用`$form->getValue($nameOfField)`或`$form->getElement($elementName)->getValue()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T02:17:10.407

这是你的问题！

直到按下提交按钮后才会设置选择元素的值。因此，在发布之前，您无法访问该值。

因此，在 PHP 中做你想做的事情的一种方法是使用 2 个动作。第一个操作获取帖子并执行验证，然后您可以获取数据并将其转发到您选择的操作，具体取决于该选择的值。

```
public function formAction() {
    $form = new Form();
    $form->setAction('/url');

    if ($this->_request->isPost()){
        if ($form->isValid($this->_request->getPost()){
            $select = $form->getValue('select');
            switch($select) {
                case ('value1') :
                    $this->_forward('action');
                    break;
                case ('value2') :
                     $this->_forward('action');
                     break;
                default :
                      $this->_forward('action');
            }
        }
    } else {
        $this->view->form = $form
} 
```

这可能是您在第一个操作时要查看的工作流程。您需要弄清楚细节，但`_forward`在这种情况下应该是可行的，因为它应该在不丢失当前请求对象的情况下执行重定向。

# javascript - addthis：addthis 实用程序框架的 JS 安全错误

> ID：12251863
> 
> 赞同：1
> 
> 时间：2012-09-03T17:15:11.617
> 
> 标签：javascript, google-chrome, addthis

我正在尝试在我的页面上使用 addthis。使用 Chrome 时，我收到 JavaScript 安全错误。

```
Unsafe JavaScript attempt to access frame with URL <AddThis url> from frame with URL <local url>. Domains, protocols and ports must match. 
```

我在此页面中获得的唯一框架是 AddThis 生成的框架，标题为“AddThis 实用程序框架”。

有什么办法可以克服这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T04:27:43.847

I've seen this in addthis's implementation of nucaptcha for their version 250\. Try upgrading to their 300 version, they went back to recaptcha.

# c# - 将具有多个重复节点的 xml 转换为字典

> ID：12251864
> 
> 赞同：0
> 
> 时间：2012-09-03T17:15:12.413
> 
> 标签：c#, xml, dictionary, xml-parsing

大家好，请帮助我..

这是我的xml

```
<ns1:UpdateReserves
 xmlns:ns1="http://XLCapital.XLI.WIS.ClaimService/1.0"
 xmlns:ns2="http://schemas.datacontract.org/2004/07/XLCapital.XLGS.Integration.Core.Foundation"
 xmlns:ns0="http://XLCapital.XLI.WIS.ClaimService/Schemas/1.0"
 xmlns:ns3="http://XLCapital.XLGS.Integration.Core.Foundation/3.0">
<ns1:oReserves> <ns0:IntegrationProcessInfo>
<ns3:GlobalTrackingID>C553BF2BE7DAA91B</ns3:GlobalTrackingID>
<ns3:SystemOfOrigin>GCS</ns3:SystemOfOrigin>
<ns3:ParentMessageID>55d242d8-547e-4088-ab68-3a19fca2d7fe</ns3:ParentMessageID>
<ns3:IOPCorrelationID>7DDC4C25B33D3DED</ns3:IOPCorrelationID>
<ns3:IOPSequenceNumber>6</ns3:IOPSequenceNumber>
</ns0:IntegrationProcessInfo> <ns0:GetClaimHeader>
<ns0:GCSClaimNumber>0001602579</ns0:GCSClaimNumber>
<ns0:PolicyNumber>DPR9406003</ns0:PolicyNumber>
<ns0:PolicySystem>WINUS</ns0:PolicySystem>
<ns0:EntitySourceType>GCS</ns0:EntitySourceType>
<ns0:SourceClaimNumber> <ns3:KeyType>CLAIMID</ns3:KeyType>
<ns3:CommonKey>C446A11E20613C0D                    </ns3:CommonKey>
<ns3:SystemKey>05101617</ns3:SystemKey> </ns0:SourceClaimNumber>
<ns0:TransactionDate>2011-07-22T18:21:25.687</ns0:TransactionDate>
<ns0:UserId>A014440</ns0:UserId>
<ns0:WinsProdCode>GLP</ns0:WinsProdCode> <ns0:ProvisionalIndicator
xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
</ns0:GetClaimHeader> <ns0:Reserves> <ns0:Reserve>
<ns0:FinancialTransactionId>3AAFF97D7D8DB7E9</ns0:FinancialTransactionId>
<ns0:ClaimantMappedKey> <ns3:KeyType>COVERAGEID</ns3:KeyType>
<ns3:CommonKey>AB0E091A59AC92DD                    </ns3:CommonKey>
<ns3:SystemKey>05101617-10</ns3:SystemKey> </ns0:ClaimantMappedKey>
<ns0:ReserveDetails> <ns0:ReserveDetail>
<ns0:FinancialTransactionDetailId>1B46392A1D5020F2</ns0:FinancialTransactionDetailId>
<ns0:TransactionType>I</ns0:TransactionType>
<ns0:ReserveAmount>0.000000</ns0:ReserveAmount> </ns0:ReserveDetail>
</ns0:ReserveDetails> </ns0:Reserve> <ns0:Reserve>
<ns0:FinancialTransactionId>F523CD61D5D61F29</ns0:FinancialTransactionId>
<ns0:ClaimantMappedKey> <ns3:KeyType>COVERAGEID</ns3:KeyType>
<ns3:CommonKey>AB0E091A59AC92DD                    </ns3:CommonKey>
<ns3:SystemKey>05101617-10</ns3:SystemKey> </ns0:ClaimantMappedKey>
<ns0:ReserveDetails> <ns0:ReserveDetail>
<ns0:FinancialTransactionDetailId>F7D6CB741A0115BC</ns0:FinancialTransactionDetailId>
<ns0:TransactionType>E</ns0:TransactionType>
<ns0:ReserveAmount>4741.000000</ns0:ReserveAmount>
</ns0:ReserveDetail> </ns0:ReserveDetails> </ns0:Reserve>
</ns0:Reserves> </ns1:oReserves> </ns1:UpdateReserves> 
```

xml 有多个重复节点。我需要将节点名称和值添加为字典中的键、值对，但字典不允许我添加重复的键。那么我该如何进行呢？

我不确定如何获取当前节点的计数，以便我可以将它们附加到节点名并将其添加为唯一键。

这是我的代码

```
public void BuildDataTable(XmlNode node)
{
    XmlNode nodWorking;

    if (node.NodeType == XmlNodeType.Element)
    {
        if (node.HasChildNodes)
        {
            nodWorking = node.FirstChild;
            while (nodWorking != null)
            {
                if (nodWorking.NodeType != XmlNodeType.Element)
                {
                    dictname.Add(node.ParentNode.Name.ToString() + node.Name.ToString(), node.InnerText);
                }

                BuildDataTable(nodWorking);
                nodWorking = nodWorking.NextSibling;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-13T08:02:24.227

如果我理解正确...您在设计字典时遇到问题...

如果要在字典中存储多个值，可以使用以下方法：
1）将列表作为字典的值

```
IDictionary<string,IList<string>> 
```

2) 使用唯一标记存储您的所有值，例如逗号分隔、制表符分隔等

```
IDictionary<string,string> 
```

只需进行最小的更改，您就可以使用以下代码......下面的代码将为每个重复键使用逗号分隔值

```
public static void BuildDataTable(XmlNode node)
{
    XmlNode nodWorking;

    if (node.NodeType == XmlNodeType.Element)
    {
        if (node.HasChildNodes)
        {
            nodWorking = node.FirstChild;
            while (nodWorking != null)
            {
                if (nodWorking.NodeType != XmlNodeType.Element)
                {

                    if(!dictname.ContainsKey(node.ParentNode.Name.ToString() + node.Name.ToString()))
                    dictname[node.ParentNode.Name.ToString() + node.Name.ToString()] = node.InnerText;
                    else
                        dictname[node.ParentNode.Name.ToString() + node.Name.ToString()] = dictname[node.ParentNode.Name.ToString() + node.Name.ToString()] +","+node.InnerText;

                }

                BuildDataTable(nodWorking);
                nodWorking = nodWorking.NextSibling;
            }
        }
    }
} 
```

# c - 在codechef上提交后计算排序C代码给出分段错误并且在我的计算机上工作正常

> ID：12251865
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:15:21.337
> 
> 标签：c, segmentation-fault

我正在做一个简单的计数排序。我已经测试了许多测试用例。在我的电脑上工作正常，但在提交代码后厨师给出运行时错误：分段错误。有人请帮助我。我在这里粘贴我的代码

```
#include <stdio.h>
#include <stdlib.h>
#define i64 long long

int main(){
int n,i,t;
i64 *max=(i64 *)malloc(sizeof(i64)),*diff=(i64 *)malloc(sizeof(i64));
scanf("%d",&t);
while(t--){
    *max=-9999999999;
    *diff=9999999999;
    scanf("%d",&n);
    i64 A[n],B[n];
    for(i=0;i<n;i++){
        scanf("%llu",&A[i]);
        if(*max<A[i])
            *max=A[i];
        B[i]=0;
    }
    i64 k=*max;
    i64 C[k+1];
    int i,j;
    for(i=0;i<=k;i++) {
        C[i]=0;
    }
    for(j=0;j<n;j++){
        C[A[j]]=C[A[j]]+1;
        B[j]=0;
    }

    for(i=1;i<=k;i++) {
        C[i]=C[i]+C[i-1];
    }
    for(j=n-1;j>=0;j--){
        B[C[A[j]]-1]=A[j];
        C[A[j]]=C[A[j]]-1;
    }
    for(i=1;i<n;i++){
        if(*diff>B[i]-B[i-1])
            *diff=B[i]-B[i-1];
    }
    printf("%llu\n",*diff);
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:21:31.847

明显的候选人是

```
i64 k=*max;
i64 C[k+1]; 
```

如果`*max`很大，则声明一个数组对于堆栈来说可能太大了，在这种情况下，分段错误是典型的结果。如果输入中的任何数字为负数，那将是导致段错误的另一个可能原因。

# c++ - 在运行时，需要跟踪类的实例数

> ID：12251866
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:15:21.537
> 
> 标签：c++, oop

> 在运行时，需要跟踪类的实例数。从面向对象的角度来看，您使用以下哪一种约定来实现这一点？

选择

1.  类级变量（静态成员变量）
2.  全局变量
3.  构造函数
4.  局部变量
5.  析构函数

* * *

选择1是我的选择

我对吗？

不是作业。

我是一名 JAVA 程序员。但我必须回答 C++ 问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:28:02.310

有点对。静态 WeakHashMap 和将自身放入地图的构造函数可以完成这项工作。每次调用 size() 时，它都会检查哪些对象已被 gc'ed。

更多oop（我想）方法是使用静态工厂方法，例如：

```
class Trackable {
    private static WeakHashMap<Trackable, Object> map = new WeakHashMap<>();
    private static final Object dummy = new Object();

    public static Trackable newInstance() {
        Trackable instance = new Trackable();
        map.put(instance, dummy);
        return instance;
    }

    public static int getTrackedObjectSize() {
        return map.size();
    }

    private Trackable() {}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:18:19.717

这可以通过`static`成员来实现因为只为类维护一个副本，并且您可以在构造函数中增加相同的副本**以跟踪创建的实例数，而不是当前可用的实例数**

# php - 我如何在 php 中使用多表来处理我的数据？

> ID：12251867
> 
> 赞同：-4
> 
> 时间：2012-09-03T17:15:25.067
> 
> 标签：php, mysql

我在 mysql (localhost) 中有三个表：

1.  `customer`, 包括列`(id,name,email,create_date,status)`;
2.  `sell`, 包括列`(id,s_code,email,dateOut,total_price)`; 和
3.  `control`，包括列`(id,timeIn,timeOut,email,ip)`。

使用 PHP`while`循环，如何在`<td>`元素中显示 3 个表的输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:32:32.233

这是一个查询，用于从表中获取所有行。

```
 //connect to database  
$dbhost = 'localhost';  
$dbuser = 'root';
$dbpass = '';  
$dbname = 'databasename';
$conn = mysql_connect($dbhost, $dbuser, $dbpass);
mysql_select_db($dbname, $conn) or die ('connection problem');

$html = '';
$sql = "" .
" SELECT * FROM customer, sell, control " .
"";

$data = mysql_query($sql);
if (mysql_num_rows($data) > 0) {
    $html .= '' .
        '<table>' .
        '';
    while($row = mysql_fetch_assoc($data)) {
        $html .= '' .
            '<tr>' .
                '<td>' .
                    '' . //data using tds in table.
                '</td>' .
            '</tr>' . 
        '';
    } //END WHILE
    $html .= '' .
        '</table>' .
        '';
}
echo $html; 
```

这将在单个查询中选择所有表中的所有数据，使用 while 循环查看它们（您应该更改表的外观和 td 的数量），完成后，它将全部回显。

祝你好运。=)

# c++ - (g++ 4.7.1) 用等效的类 typedef 替换显式类型名称无法编译

> ID：12251868
> 
> 赞同：6
> 
> 时间：2012-09-03T17:15:37.577
> 
> 标签：c++, templates, c++11, g++

我正在尝试创建一个接受可迭代和函数的模板化函数，这样传递的函数将被隐式转换为`std::function`适当类型的 a（从而允许它与完整函数和 lambdas 一起使用）。

这是代码：

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <typeinfo>

template<typename T>
void bar(const T & base, std::function<bool(int)> f) // works
//void bar(const T & base, std::function<bool(typename T::iterator::value_type)> f) // fails to compile
{
    std::cout << ((typeid(std::function<bool(int)>) == typeid(std::function<bool(typename T::iterator::value_type)>))?"identical":"distinct") << std::endl;
}

bool filter(int x) { return x%2==0; }

int main() { bar(std::vector<int> {0, 1}, filter); } 
```

用这个编译`g++-4.7 -std=c++11 -o itest itest.cpp`产生`identical`.

如果您取消注释第 10 行和注释第 9 行并按上述方式编译，则编译失败并显示

```
g++-4.7 -std=c++11 -Wall -Werror  -o itest itest.cpp
itest.cpp: In function 'int main()':
itest.cpp:16:53: error: no matching function for call to 'bar(std::vector<int>, bool (&)(int))'
itest.cpp:16:53: note: candidate is:
itest.cpp:9:10: note: template<class T> void bar(const T&, std::function<bool(typename T::iterator::value_type)>)
itest.cpp:9:10: note:   template argument deduction/substitution failed:
itest.cpp:16:53: note:   mismatched types 'std::function<bool(typename T::iterator::value_type)>' and 'bool (*)(int)' 
```

我应该注意到未修改的版本在 Xcode 上成功（设置了适当的选项），但如果可能的话，我更愿意坚持使用 g++ 而不是 clang。我做错了什么，或者这是g ++中的一个已知错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:35:01.370

抱歉，错误在您的代码中。它相当于：

```
template<typename T> struct S { template<typename U> S(const U &); };
template<typename T> void bar(T, S<T>);
int main() { bar(5, 6); } 
```

问题是在模板参数推导/替换中，如果一个模板参数（直接或在构造依赖类型中）出现在多个参数中，那么两个参数必须完全匹配；不考虑用户定义的转换，即使从一个参数中可以明显看出类型必须是什么。

这里的用户自定义转换是`std::function<...>`.

可能的解决方法是`bar`显式实例化（as `bar<int>`），或分派到辅助函数：

```
template<typename T>
void bar_impl(const T & base, std::function<bool(typename T::iterator::value_type)> f)
{
    std::cout << ((typeid(std::function<bool(int)>) == typeid(std::function<bool(typename T::iterator::value_type)>))?"identical":"distinct") << std::endl;
}

template<typename T, typename F>
void bar(const T & base, F &&f)
{
    bar_impl<T>(base, std::forward<F>(f));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:33:58.243

您需要指针函数的第二个重载 - 然后它将编译。隐式强制转换`std::function`不起作用：

```
void bar(const T & base, bool(*f)(typename T::value_type)){
    std::cout << "ptr func\n";
} 
```

解决 ecatmur 描述的问题（几个 T，函数signutre 中的类型不匹配）：您可以将其他 T 包装在`identity`struct 中，其定义如下：

```
template<class T> struct identity{ typedef T type; }; 
```

然后编译器将忽略这些 T 进行类型推导。

# objective-c - 什么会导致 CGDisplayCreateImageForRect 捕获或忽略光标？

> ID：12251871
> 
> 赞同：5
> 
> 时间：2012-09-03T17:15:48.373
> 
> 标签：objective-c, cocoa, screenshot, nscursor

我正在用 osx 捕获屏幕

```
capturedImage = CGDisplayCreateImageForRect(displayID, CGRectMake(point.x - 4, point.y - 4, 8, 8)); 
```

这将返回光标下的屏幕部分。稍后我将设置一个自定义图像光标：

```
[[[NSCursor alloc] initWithImage:img hotSpot:NSMakePoint(4, 4)] set]; 
```

在我设置光标并尝试再次捕获屏幕后出现问题。光标包含在帧缓冲区中。这使得捕获的图像与我作为光标放置的图像相同。我试图隐藏光标，然后捕获屏幕，然后将其显示回来，但它不起作用，它也会使光标闪烁。

更奇怪的是，在特定的笔记本电脑上不会捕获光标图像，但在运行相同操作系统（Mountain Lion、Snow Leopard）的其他笔记本电脑上会捕获光标图像。

什么会导致光标包含在帧缓冲区中？有没有办法保证没有自定义光标的屏幕截图？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T12:32:43.830

这取决于谁呈现光标，以及它是纯硬件加速的还是软件呈现的。这因硬件而异，也因操作系统而异……按照markk的建议做：将其设置为默认值

# c# - 如何将此 foreach 代码转换为 Parallel.ForEach？

> ID：12251874
> 
> 赞同：197
> 
> 时间：2012-09-03T17:16:44.430
> 
> 标签：c#, multithreading, .net-4.0, parallel.foreach

我有点困惑`Parallel.ForEach`。
它是什么`Parallel.ForEach`以及它到底做了什么？
请不要引用任何 MSDN 链接。

这是一个简单的例子：

```
string[] lines = File.ReadAllLines(txtProxyListPath.Text);
List<string> list_lines = new List<string>(lines);

foreach (string line in list_lines)
{
    //My Stuff
} 
```

我怎样才能用 重写这个例子`Parallel.ForEach`？

* * *

## 回答 #1

> 赞同：299
> 
> 时间：2013-07-05T09:54:51.200

**Foreach 循环：**

> *   迭代是按顺序进行的，一个接一个
> *   foreach 循环从单个线程运行。
> *   foreach 循环在 .NET 的每个框架中都有定义
> *   *慢速*进程的执行可能会*更慢*，因为它们是串行运行的
>     *   进程 2 在 1 完成之前无法启动。过程 3 无法启动，直到 2 和 1 完成...
> *   *快速*进程的执行可以*更快*，因为没有线程开销

**Parallel.ForEach：**

> *   执行以并行方式进行。
> *   Parallel.ForEach 使用多个线程。
> *   Parallel.ForEach 在 .Net 4.0 及以上框架中定义。
> *   *慢*进程的执行可以*更快*，因为它们可以并行运行。
>     *   进程 1、2 和 3*可以*同时运行（参见下面的示例中的重用线程）
> *   由于额外的线程开销，*快速*进程的执行可能会*更慢。*

下面的例子清楚地展示了传统 foreach 循环和

**Parallel.ForEach() 示例**

```
using System;
using System.Diagnostics;
using System.Threading;
using System.Threading.Tasks;
namespace ParallelForEachExample
{
    class Program
    {
        static void Main()
        {
            string[] colors = {
                                  "1\. Red",
                                  "2\. Green",
                                  "3\. Blue",
                                  "4\. Yellow",
                                  "5\. White",
                                  "6\. Black",
                                  "7\. Violet",
                                  "8\. Brown",
                                  "9\. Orange",
                                  "10\. Pink"
                              };
            Console.WriteLine("Traditional foreach loop\n");
            //start the stopwatch for "for" loop
            var sw = Stopwatch.StartNew();
            foreach (string color in colors)
            {
                Console.WriteLine("{0}, Thread Id= {1}", color, Thread.CurrentThread.ManagedThreadId);
                Thread.Sleep(10);
            }
            Console.WriteLine("foreach loop execution time = {0} seconds\n", sw.Elapsed.TotalSeconds);
            Console.WriteLine("Using Parallel.ForEach");
            //start the stopwatch for "Parallel.ForEach"
             sw = Stopwatch.StartNew();
            Parallel.ForEach(colors, color =>
            {
                Console.WriteLine("{0}, Thread Id= {1}", color, Thread.CurrentThread.ManagedThreadId);
                Thread.Sleep(10);
            }
            );
            Console.WriteLine("Parallel.ForEach() execution time = {0} seconds", sw.Elapsed.TotalSeconds);
            Console.Read();
        }
    }
} 
```

**输出**

```
Traditional foreach loop
1\. Red, Thread Id= 10
2\. Green, Thread Id= 10
3\. Blue, Thread Id= 10
4\. Yellow, Thread Id= 10
5\. White, Thread Id= 10
6\. Black, Thread Id= 10
7\. Violet, Thread Id= 10
8\. Brown, Thread Id= 10
9\. Orange, Thread Id= 10
10\. Pink, Thread Id= 10
foreach loop execution time = 0.1054376 seconds 
```

**使用 Parallel.ForEach 示例**

```
1\. Red, Thread Id= 10
3\. Blue, Thread Id= 11
4\. Yellow, Thread Id= 11
2\. Green, Thread Id= 10
5\. White, Thread Id= 12
7\. Violet, Thread Id= 14
9\. Orange, Thread Id= 13
6\. Black, Thread Id= 11
8\. Brown, Thread Id= 10
10\. Pink, Thread Id= 12
Parallel.ForEach() execution time = 0.055976 seconds 
```

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2012-09-03T17:18:11.257

```
string[] lines = File.ReadAllLines(txtProxyListPath.Text);
List<string> list_lines = new List<string>(lines);
Parallel.ForEach(list_lines, line =>
{
    //Your stuff
}); 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-09-03T17:17:53.113

```
string[] lines = File.ReadAllLines(txtProxyListPath.Text);

// No need for the list
// List<string> list_lines = new List<string>(lines); 

Parallel.ForEach(lines, line =>
{
    //My Stuff
}); 
```

这将导致在循环内并行解析行。如果您想要更详细、更少“面向参考”的 Parallel 类介绍，我写了一个关于 TPL 的系列文章，其中包括[关于 Parallel.ForEach 的部分](http://reedcopsey.com/2010/01/20/parallelism-in-net-part-2-simple-imperative-data-parallelism/)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-04-06T15:09:20.143

对于大文件，请使用以下代码（您的内存消耗较少）

```
Parallel.ForEach(File.ReadLines(txtProxyListPath.Text), line => {
    //Your stuff
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-08-01T08:07:59.627

这些线条对我有用。

```
string[] lines = File.ReadAllLines(txtProxyListPath.Text);
var options = new ParallelOptions { MaxDegreeOfParallelism = Environment.ProcessorCount * 10 };
Parallel.ForEach(lines , options, (item) =>
{
 //My Stuff
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-03T08:09:08.877

我想补充一下并行选项。如果您没有提到它，默认情况下所有 RAM 都将用于此，这可能会给您在生产中带来问题。所以最好在代码中添加最大并行度。

```
Parallel.ForEach(list_lines, new ParallelOptions { MaxDegreeOfParallelism = 2 }, line =>
{

}); 
```

# python - KVM api 启动虚拟机

> ID：12251881
> 
> 赞同：5
> 
> 时间：2012-09-03T17:17:10.030
> 
> 标签：python, kvm

我想知道是否有一个 KVM API，它允许您使用简单的命令从 python 脚本启动 KVM 虚拟机。

我的 Python 脚本执行一系列检查以查看我们是否需要启动特定 VM，如果需要，我想启动 VM。

我现在需要的只是找到 API 调用，但我无法在 libvirt 网站中找到一个简单的调用来启动它们。有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T08:26:30.640

您可以使用 libvirt 的 python API 绑定中的 create() 函数：

```
import libvirt

#connect to hypervisor running on localhost
conn = libvirt.open('qemu:///system')

dom0 = conn.lookupByName('my-vm-1')
dom0.create() 
```

基本上，python API 是 C API，由 libvirt.C_API_CALL 减去 virConnect 部分或 conn.C_API_CALL 减去 virDomain 部分调用。

请参阅[libvirt API 创建调用](http://www.libvirt.org/html/libvirt-libvirt.html#virDomainCreate)和[此处](http://www.redhat.com/archives/libvir-list/2008-July/msg00049.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T07:30:43.017

最简单的方法，虽然可能不是最好的推荐方法是使用 os.system 使用 python 来调用 qemu-kvm。这种方法的缺点是您必须手动管理 VM。

使用 libvirt，您首先必须通过调用 virt-install 来定义一个域。

```
virt-install \
         --connect qemu:///system \
         --virt-type kvm \
         --name MyNewVM \
         --ram 512 \
         --disk path=/var/lib/libvirt/images/MyNewVM.img,size=8 \
         --vnc \
         --cdrom /var/lib/libvirt/images/Fedora-14-x86_64-Live-KDE.iso \
         --network network=default,mac=52:54:00:9c:94:3b \
         --os-variant fedora14 
```

我直接从[http://wiki.libvirt.org/page/VM_lifecycle](http://wiki.libvirt.org/page/VM_lifecycle)

创建域后，您可以使用它`virsh start MyNewVM`来启动 VM。使用这种方法，管理虚拟机要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T04:28:12.787

如果需要管理 KVM，可以使用 virsh 命令。这是 virsh 命令的列表；

**列表已删除，因为它的格式不正确**

您可以使用 virsh 的帮助列出所有选项，其中 start 选项可能会对您有所帮助。

如果您使用 python 脚本来管理您的 KVM，我建议您也通过以下脚本。它会给你一个好主意。[http://russell.ballestrini.net/series/virt-back/](http://russell.ballestrini.net/series/virt-back/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T09:17:01.913

似乎使用 libvirt 或调用 [qemu-]kvm 命令是 pythonistas 的两种选择。您可能会在 kvmtools 项目代码中找到有趣的片段：[http](http://www.linux-kvm.org/page/Kvmtools) ://www.linux-kvm.org/page/Kvmtools （参见 ./kvmtools/kvm/build_command.py 和 ./kvmtools/kvm/action.py 中的 kvm_boot_action使用子进程模块而不是 os.system)

# jquery - HTMLTabs CSS 在 Firefox 和 chrome 中工作，但不在 Internet Explorer 中

> ID：12251883
> 
> 赞同：0
> 
> 时间：2012-09-03T17:17:29.890
> 
> 标签：jquery, html, css, web

我有一个 html 选项卡 CSS，它在 Chrome 和 Firefox 中正确显示，但在 Internet Explorer 中却没有。

这里的问题是与内容的联合点`li`是分开的，并且没有加入 Internet Explorer

**CSS：**

```
#header ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#header li {
    float: left;
    font: 10px arial,sans-serif;
    border: 1px solid #bbb;
    border-bottom-width: 0;
    margin: 0;
}

#header a {
    text-decoration: none;
    display: block;
    background: #eee;
    padding: 0.24em 1em;
    color: #00c;
    width: 8em;
    text-align: center;
}

#header a:hover {
    background: #ddf;
}

#header #selected {
    border-color: black;
}

#header #selected a {
    position: relative;
    top: 1px;
    background: white;
    color: black;
    font-weight: bold;
}

#content {
    border: 1px solid black;
    clear: both;
    padding: 0 1em;
} 
```

**html:**

```
<div id="tabs">
    <div id="header">
        <ul>
            <li name_id="tab1" id="selected">
            <a name="" type="hyperlink" href="#">tab1</a>
            </li>

            <li name_id="tab2">
            <a name="" type="hyperlink" href="#">tab2</a>
            </li>
        </ul>
    </div>
    <div id="content">
        <div id="table-wrapper">
            <div id="table-scroll">
                <table width="100%">
                    <tbody>
                        <tr>
                            <td>
                                <a href="#">Test Value 1</a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <a href="#">Test Value 2</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>​ 
```

[jsfiddle.net 演示](http://jsfiddle.net/BZAGG/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:35:03.260

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

`DOCTYPE`在您的 html 脚本中包含上述声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:02:25.653

我有同样的问题，如果在阅读后通过将我的字体大小设置为小来解决。奇怪的！

# ruby - 从文本编辑器运行 .rb 文件时无法加载 Nokogiri gem，但它在 Ruby 命令 shell 中运行良好

> ID：12251884
> 
> 赞同：0
> 
> 时间：2012-09-03T17:17:40.260
> 
> 标签：ruby, text, sublimetext2, scite

我使用 Scintilla 文本编辑器和 Sublime Text 2。

每当我使用它们运行包含以下内容的 Ruby 脚本时：

```
require 'nokogiri' 
```

...我收到此错误：

```
C:/Program Files (x86)/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': no such file to load -- nokogiri (LoadError)
from C:/Program Files (x86)/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from C:/Users/MY_RUBY_SCRIPT.rb:3:in `<main>' 
```

我正在使用 Ruby 1.9.3 并且我确保需要 ruby​​gems，但我仍然得到了错误。

但是，当我使用 Ruby 从命令提示符运行脚本时，脚本运行良好。

有谁知道为什么脚本在文本编辑器中失败，但在命令提示符中却没有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:56:02.813

也许您的编辑器运行不同版本的 Ruby。您可以通过运行检查

```
puts RUBY_VERSION 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T00:03:48.337

原来我同时安装了 Ruby 1.9.2 和 1.9.3，这导致了 SciTE 中的冲突，它试图在 Ruby 1.9.2 而不是 1.9.3 中找到 gem。我卸载了 1.9.2 并且脚本运行良好。如果我将来确实需要 1.9.2，我想我必须学习 RVM。

# sql-server-2008 - SSIS 使用带有变量而不是源数据库的 DataFlow 任务

> ID：12251885
> 
> 赞同：4
> 
> 时间：2012-09-03T17:17:45.203
> 
> 标签：sql-server-2008, sqlite, insert, ssis, dataflow

我有一个任务让我很困惑。希望你能帮助我。我正在使用一个数据流任务，它基本上是将一行插入到 sqlite 表中。我正在使用“SQL 任务”执行此操作，但不幸的是，将 guid 成功插入 sqlite 表的唯一方法是使用数据流任务将其转换为字节流。我不想使用源数据库，因为我的数据没有从一个表流向另一个表。我真的只想获取我填充的变量并将它们转换为字节流，然后我可以成功地将其插入到 sqlite 数据库中。问题是，我不能在没有源数据库的情况下使用数据流任务。

到目前为止，我的解决方法是声明一个源数据库/表和只有一列（但从不在数据流中使用它）。这工作正常，我无法使用我的预设变量将该行插入到 sqlite 中，但是每次我这样做时，我的输出日志中都会留下一条有点烦人的消息：

警告：0x80047076，SSIS.Pipeline：输出“OLE DB 源输出”(11) 和组件“OLE DB 源”(1) 上的输出列“”(117) 随后未在数据流任务中使用。删除这个未使用的输出列可以提高数据流任务的性能。

任何人都知道让这个警告不出现的好方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-06T16:47:44.477

在您的数据流中选择一个脚本组件。

当系统提示您选择 Source、Destination 或 Transformation 时，请选择 Source。

将预先填充的变量添加到脚本选项卡的 CustomProperties.ReadOnlyVariables 部分。

转到输入和输出部分。

在每个变量的默认输出中添加一列。

在您的脚本（如果使用 C#）中，在 CreateNewOutputRows() 部分中放置类似于以下内容的内容

```
 Output0Buffer.AddRow();
    Output0Buffer.ContainerName = Variables.ContainerName;
    Output0Buffer.TaskName = Variables.TaskName;
    Output0Buffer.TaskStartDate = Variables.ContainerStartTime; 
```

保存您的脚本。

将您的脚本组件连接到您的目标对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T07:32:53.853

如果这导致您的包执行失败，您可以选择忽略这些警告/错误。

只需双击数据流中的源块并导航到左侧窗格中的最后一个选项卡（“错误输出”），您需要选择忽略错误的选项。（我不知道该选项中的哪个短语会做到这一点）

# xml - 路径 xmlreader 中的连字符和下划线不移动到下一个

> ID：12251887
> 
> 赞同：0
> 
> 时间：2012-09-03T17:17:58.947
> 
> 标签：xml, xml-parsing, xmlreader

我有这个脚本的问题，问题是我假设它是节点名称中的连字符，它会抛出 xmlreader 我必须使用 xml 阅读器而不是 simplexml，因为文件是 1gb 而我们的服务器只有 1gb，无论如何这是 xml ：

```
 <dataroot>
   <Hotel_All_Active_x0020_08-29-12>
     ...................
   </Hotel_All_Active_x0020_08-29-12>
   <Hotel_All_Active_x0020_08-29-12>
     ...................
   </Hotel_All_Active_x0020_08-29-12>
 </dataroot> 
```

那么这是我试图解析的脚本，如果我运行脚本，我会得到一个结果，我知道我可以对 xml 执行转换，但因为我们可能必须每隔一周经历一次这个过程，所以我想保留它尽可能简单直接，我知道在简单的 xml 中你可以用大括号括起来，想知道是否存在同样的问题。

听到意味着循环遍历所有 Hotel_All_Active_x0020_08-29-12 的代码：

```
$reader = new XMLReader();

$reader->open("Hotel_All.xml");

$dom = new DomDocument();

  while ($reader->read() && $reader->name !== 'Hotel_All_Active_x0020_08-29-12');

  while ($reader->name === 'Hotel_All_Active_x0020_08-29-12')
  {
   $node = new SimpleXMLElement($reader->readOuterXml());

   $nodename = $node->name;

   $reader->next('Hotel_All_Active_x0020_08-29-12');
  } 
```

但它永远不会移动到下一个元素，**是否有一种简单的方法来处理 xmlreader 中的非法字符，或者是使用 xsl 更改名称的唯一选择**？

这不是完整的脚本，但我知道 $reader->next(); 一切都很好

# wordpress - WP 自定义分类描述（按术语）

> ID：12251889
> 
> 赞同：0
> 
> 时间：2012-09-03T17:18:01.757
> 
> 标签：wordpress, custom-post-type, term, custom-taxonomy

在其他地方看过很多帖子，但没有什么能达到目标。

我需要回应与自定义帖子类型相关的自定义分类的特定术语的描述。

现在，我正在成功地执行以下循环来为每个术语提取相关自定义帖子的内容（在这种情况下，我的自定义帖子类型是“rental_gear”，我的术语是“相机”：

```
<?  $args = array(
    'post_type'=> 'rental_gear',
    'type'    => 'cameras',
    'order'    => 'ASC'
    );              

    $the_query = new WP_Query( $args );
    if($the_query->have_posts() ) : while ( $the_query->have_posts() ) : $the_query->the_post(); 

?>
    <li><a href="<? the_permalink(); ?>">&rsaquo; <? the_title(); ?></a></li>   
<?php endwhile; endif; wp_reset_postdata(); ?> 
```

我可以在这个循环中提取术语的描述吗？我尝试了“get_term”功能并拉动“$term->description;” 但那些与帖子有关，这是在概述页面上列出许多帖子的信息（因此使用循环）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:28:27.080

您没有提及自定义分类的名称，因此请替换`your-taxonomy`. 这将查询所有`rental_gear`具有`camera`in 术语的帖子`your-taxonomy`。

```
<?php
$args = array(
    'post_type' => 'rental_gear',
    'tax_query' => array(
        array(
            'taxonomy' => 'your-taxonomy',
            'field' => 'slug',
            'terms' => 'camera'
        )
    )
);
$query = new WP_Query( $args ); 
```

# grails - 跟踪/BPT 陷阱：5 个运行 grails 2.1.0 应用程序 - 跟踪/BPT 陷阱：5

> ID：12251895
> 
> 赞同：1
> 
> 时间：2012-09-03T17:19:10.260
> 
> 标签：grails

我将一个应用程序从 2.0.0M2 升级到 2.1.0，但是当我尝试运行它时，我收到了这个错误：

```
Note: /Volumes/Info/proyectos-grails/vincoorbis/Member-2.1.0/member/src/groovy/com/vincoorbis/aeromexico/clubpremier/member/WSCredentialsException.j va uses or overrides a deprecated API. 
Note: Recompile with -Xlint:deprecation for details.

| Creating SSL Certificate...

Created SSL Certificate.

Configuring Spring Security Core ...
... finished configuring Spring Security Core
Trace/BPT trap: 5 
```

这是日志：

```
Process:         java [10418]
Path:            /usr/bin/java
Identifier:      com.apple.javajdk16.cmd
Version:         1.0 (1.0)
Code Type:       X86-64 (Native)
Parent Process:  bash [8980]
User ID:         501

Date/Time:       2012-09-03 12:16:47.579 -0500
OS Version:      Mac OS X 10.8 (12A269)
Report Version:  10

Interval Since Last Report:          1320567 sec
Crashes Since Last Report:           13
Per-App Interval Since Last Report:  111302 sec
Per-App Crashes Since Last Report:   12
Anonymous UUID:                      92ED5BE2-E51C-418A-A60B-388303A36546

Crashed Thread:  5  Java: GC task thread#1 (ParallelGC)

Exception Type:  EXC_BREAKPOINT (SIGTRAP)
Exception Codes: 0x0000000000000002, 0x0000000000000000

Application Specific Information:
Java information:
 Exception type: Internal Error (/SourceCache/JavaJDK16/JavaJDK16-424/hotspot/src/share/vm/runtime/javaCalls.cpp, line 62)

#  guarantee(thread->is_Java_thread()) failed: crucial check - the VM thread cannot and must not escape to Java code
 Java VM: Java HotSpot(TM) 64-Bit Server VM (20.8-b03-424 mixed mode macosx-amd64)

Current thread (7fd2fb801800):  GCTaskThread [stack: 10c32d000,10c42d000] [id=205705216]
Stack: [10c32d000,10c42d000]
JavaThread 7fd2fe8d5800 (nid = 4540796928) was being processed
Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  com.springsource.loaded.Utils.loadBytesFromStream(Ljava/io/InputStream;)[B+12
j  com.springsource.loaded.Utils.loadClassAsBytes2(Ljava/lang/ClassLoader;Ljava/lang/String;)[B+39
J  com.springsource.loaded.TypeRegistry.getDescriptorFor(Ljava/lang/String;)Lcom/springsource/loaded/TypeDescriptor;
J  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.computeFieldsRequiringAccessors()V
j  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.getTypeDescriptor()Lcom/springsource/loaded/TypeDescriptor;+12
J  com.springsource.loaded.TypeRegistry.getDescriptorFor(Ljava/lang/String;)Lcom/springsource/loaded/TypeDescriptor;
J  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.computeFieldsRequiringAccessors()V
j  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.getTypeDescriptor()Lcom/springsource/loaded/TypeDescriptor;+12
J  com.springsource.loaded.TypeRegistry.getDescriptorFor(Ljava/lang/String;)Lcom/springsource/loaded/TypeDescriptor;
J  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.computeFieldsRequiringAccessors()V
j  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.getTypeDescriptor()Lcom/springsource/loaded/TypeDescriptor;+12
J  com.springsource.loaded.TypeRegistry.getDescriptorFor(Ljava/lang/String;)Lcom/springsource/loaded/TypeDescriptor;
J  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.findTypeDescriptor(Lcom/springsource/loaded/TypeRegistry;Ljava/lang/String;)Lcom/springsource/loaded/TypeDescriptor;
J  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.computeCatchers()V
j  com.springsource.loaded.TypeDescriptorExtractor$ExtractionVisitor.getTypeDescriptor()Lcom/springsource/loaded/TypeDescriptor;+8
j  com.springsource.loaded.TypeDescriptorExtractor.extract([BZ)Lcom/springsource/loaded/TypeDescriptor;+29
j  com.springsource.loaded.TypeRegistry.addType(Ljava/lang/String;[B)Lcom/springsource/loaded/ReloadableType;+50
J  com.springsource.loaded.agent.SpringLoadedPreProcessor.preProcess(Ljava/lang/ClassLoader;Ljava/lang/String;Ljava/security/ProtectionDomain;[B)[B
J  sun.instrument.TransformerManager.transform(Ljava/lang/ClassLoader;Ljava/lang/String;Ljava/lang/Class;Ljava/security/ProtectionDomain;[B)[B
j  sun.instrument.InstrumentationImpl.transform(Ljava/lang/ClassLoader;Ljava/lang/String;Ljava/lang/Class;Ljava/security/ProtectionDomain;[BZ)[B+34
v  ~StubRoutines::call_stub
j  java.lang.ClassLoader.defineClass1(Ljava/lang/String;[BIILjava/security/ProtectionDomain;Ljava/lang/String;Z)Ljava/lang/Class;+0
j  java.lang.ClassLoader.defineClassCond(Ljava/lang/String;[BIILjava/security/ProtectionDomain;Z)Ljava/lang/Class;+32
j  java.lang.ClassLoader.defineClass(Ljava/lang/String;[BIILjava/security/ProtectionDomain;)Ljava/lang/Class;+9
j  org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts.define(Ljava/lang/String;[B)Ljava/lang/Class;+26
j  org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts$1.run()Ljava/lang/Class;+12
j  org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts$1.run()Ljava/lang/Object;+1
v  ~StubRoutines::call_stub
J  java.security.AccessController.doPrivileged(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
j  org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts.defineClassAndGetConstructor(Ljava/lang/String;[B)Ljava/lang/reflect/Constructor;+10
j  org.codehaus.groovy.runtime.callsite.CallSiteGenerator.compileStaticMethod(Lorg/codehaus/groovy/reflection/CachedMethod;)Ljava/lang/reflect/Constructor;+43
j  org.codehaus.groovy.reflection.CachedMethod.createStaticMetaMethodSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;Lgroovy/lang/MetaClassImpl;[Ljava/lang/Class;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+30
j  org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite.createStaticMetaMethodSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;Lgroovy/lang/MetaClassImpl;Lgroovy/lang/MetaMethod;[Ljava/lang/Class;[Ljava/lang/Object;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+56
j  groovy.lang.MetaClassImpl.createStaticSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;[Ljava/lang/Object;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+36
j  groovy.lang.ExpandoMetaClass.createStaticSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;[Ljava/lang/Object;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+20
j  org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallStaticSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;Ljava/lang/Class;[Ljava/lang/Object;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+18
j  org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallSite(Lorg/codehaus/groovy/runtime/callsite/CallSite;Ljava/lang/Object;[Ljava/lang/Object;)Lorg/codehaus/groovy/runtime/callsite/CallSite;+26
j  org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(Lorg/codehaus/groovy/runtime/callsite/CallSite;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+3
j  org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+3
j  org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(Ljava/lang/Object;)Ljava/lang/Object;+5
j  BootStrap$_closure1.doCall(Ljava/lang/Object;)Ljava/lang/Object;+6360
v  ~StubRoutines::call_stub
j  sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0
j  sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+87
J  java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
J  com.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
J  groovy.lang.MetaMethod.doMethodInvoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
J  groovy.lang.MetaClassImpl.invokeMethod(Ljava/lang/Class;Ljava/lang/Object;Ljava/lang/String;[Ljava/lang/Object;ZZ)Ljava/lang/Object;
J  groovy.lang.MetaClassImpl.invokeMethod(Ljava/lang/Class;Ljava/lang/Object;Ljava/lang/String;[Ljava/lang/Object;ZZ)Ljava/lang/Object;
J  groovy.lang.Closure.call([Ljava/lang/Object;)Ljava/lang/Object;
j  groovy.lang.Closure.call()Ljava/lang/Object;+6
j  grails.util.Environment.evaluateEnvironmentSpecificBlock(Lgrails/util/Environment;Lgroovy/lang/Closure;)Lgrails/util/Environment$EnvironmentBlockEvaluator;+16
j  grails.util.Environment.executeForEnvironment(Lgrails/util/Environment;Lgroovy/lang/Closure;)Ljava/lang/Object;+8
j  grails.util.Environment.executeForCurrentEnvironment(Lgroovy/lang/Closure;)Ljava/lang/Object;+6
j  org.codehaus.groovy.grails.commons.DefaultGrailsBootstrapClass.callInit(Ljavax/servlet/ServletContext;)V+23
j  org.codehaus.groovy.grails.web.context.GrailsConfigUtils.executeGrailsBootstraps(Lorg/codehaus/groovy/grails/commons/GrailsApplication;Lorg/springframework/web/context/WebApplicationContext;Ljavax/servlet/ServletContext;)V+113
j  org.codehaus.groovy.grails.web.context.GrailsContextLoader.initWebApplicationContext(Ljavax/servlet/ServletContext;)Lorg/springframework/web/context/WebApplicationContext;+131
j  org.springframework.web.context.ContextLoaderListener.contextInitialized(Ljavax/servlet/ServletContextEvent;)V+28
j  org.apache.catalina.core.StandardContext.listenerStart()Z+530
j  org.apache.catalina.core.StandardContext.startInternal()V+1187
j  org.apache.catalina.util.LifecycleBase.start()V+210
j  org.apache.catalina.core.ContainerBase$StartChild.call()Ljava/lang/Void;+4
j  org.apache.catalina.core.ContainerBase$StartChild.call()Ljava/lang/Object;+1
j  java.util.concurrent.FutureTask$Sync.innerRun()V+30
j  java.util.concurrent.FutureTask.run()V+4
j  java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Ljava/lang/Runnable;)V+59
j  java.util.concurrent.ThreadPoolExecutor$Worker.run()V+28
j  java.lang.Thread.run()V+11
v  ~StubRoutines::call_stub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T03:22:44.527

You can try replacing the springloaded java agent with a snapshot version from [http://maven.springframework.org/snapshot/com/springsource/springloaded/springloaded-core/](http://maven.springframework.org/snapshot/com/springsource/springloaded/springloaded-core/)

Download [http://maven.springframework.org/snapshot/com/springsource/springloaded/springloaded-core/1.1.1.BUILD-SNAPSHOT/springloaded-core-1.1.1.BUILD-20120821.173635-2.jar](http://maven.springframework.org/snapshot/com/springsource/springloaded/springloaded-core/1.1.1.BUILD-SNAPSHOT/springloaded-core-1.1.1.BUILD-20120821.173635-2.jar) and place it on top the springloaded version that comes with Grails 2.1.0 , thats grails-2.1.0/lib/com.springsource.springloaded/springloaded-core/jars/springloaded-core-1.0.6.jar

for example:

```
wget http://maven.springframework.org/snapshot/com/springsource/springloaded/springloaded-core/1.1.1.BUILD-SNAPSHOT/springloaded-core-1.1.1.BUILD-20120821.173635-2.jar
mv springloaded-core-1.1.1.BUILD-20120821.173635-2.jar $GRAILS_HOME/lib/com.springsource.springloaded/springloaded-core/jars/springloaded-core-1.0.6.jar 
```

There are a few users that reported the same problem on the mailing list: [http://grails.1312388.n4.nabble.com/template/NamlServlet.jtp?macro=search_page&node=1312388&query=%22crucial+check%22&days=0](http://grails.1312388.n4.nabble.com/template/NamlServlet.jtp?macro=search_page&node=1312388&query=%22crucial+check%22&days=0)

There are jira issues such as [http://jira.grails.org/browse/GRAILS-9019](http://jira.grails.org/browse/GRAILS-9019) / [https://issuetracker.springsource.com/browse/STS-2851](https://issuetracker.springsource.com/browse/STS-2851) (about java.lang.ClassCircularityError) that seem to be fixed in the Springloaded 1.1.1 snapshot.

Please re-test with the snapshot and report a jira issue with steps to reproduce the problem. Do you have a chance to test the same application on Linux or Windows?

You can also remove the ~/.grails/.slcache directory to make sure Springloaded agent has a clean start.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:32:29.800

我建议您删除`~/.grails`和`yourproject/target`目录，然后再试一次。

# python - 在使用 PIL 保持透明度的同时为图像着色？

> ID：12251896
> 
> 赞同：5
> 
> 时间：2012-09-03T17:19:10.387
> 
> 标签：python, image, transparency, python-imaging-library, colorize

好的，情况如下：

我想使用 Python 图像库来“主题化”这样的图像：

主题颜色：![显示色调颜色的样本](../Images/a34b05e0bb85eced13ee1fcd8813614e.png) `"#33B5E5"`

输入：![http://mupload.nl/img/olpiyj9is.png](../Images/c7af0acdfd0dddc3d20e566ca9380124.png) 输出：![http://mupload.nl/img/fiaoq6gk5.png](../Images/5b182cf39738b3f4743f048146b3e669.png)

我在 ImageMagick 中使用这个命令得到了结果：

```
convert image.png -colorspace gray image.png
mogrify -fill "#33b5e5" -tint 100 image.png 
```

解释：

图像首先转换为黑白，然后进行主题化。

我想用 Python Image Library 得到同样的结果。但似乎我在使用它时遇到了一些问题，因为：

1.  无法处理透明度
2.  背景（主图像中的透明度）也成为主题。

我正在尝试使用此脚本：

```
import Image
import ImageEnhance

def image_overlay(src, color="#FFFFFF", alpha=0.5):
    overlay = Image.new(src.mode, src.size, color)
    bw_src = ImageEnhance.Color(src).enhance(0.0)
    return Image.blend(bw_src, overlay, alpha)

img = Image.open("image.png")
image_overlay(img, "#33b5e5", 0.5) 
```

您可以看到我没有先将其转换为灰度，因为这也不适用于透明度。

很抱歉在一个问题中发布了这么多问题，但我无能为力：$

希望大家理解。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T02:10:22.387

**注意：**[这里](https://stackoverflow.com/a/29379704/355230)有这个答案的 PIL 版本的 Python 3/pillow 叉。

**更新 4**：猜猜我的答案的上一个更新毕竟不是最后一个。尽管将其转换为`PIL`专用是一项重大改进，但有几件事似乎应该有更好的、不那么尴尬的方法，只要`PIL`有能力。

好吧，在仔细阅读了文档以及一些源代码之后，我意识到我想做的事情*实际上*是可能的。权衡是现在它必须手动构建查找表，因此整体代码略长。然而结果是它只需要调用一个相对慢的`Image.point()`方法，而不是三个。

```
from PIL import Image
from PIL.ImageColor import getcolor, getrgb
from PIL.ImageOps import grayscale

def image_tint(src, tint='#ffffff'):
    if Image.isStringType(src):  # file path?
        src = Image.open(src)
    if src.mode not in ['RGB', 'RGBA']:
        raise TypeError('Unsupported source image mode: {}'.format(src.mode))
    src.load()

    tr, tg, tb = getrgb(tint)
    tl = getcolor(tint, "L")  # tint color's overall luminosity
    if not tl: tl = 1  # avoid division by zero
    tl = float(tl)  # compute luminosity preserving tint factors
    sr, sg, sb = map(lambda tv: tv/tl, (tr, tg, tb))  # per component adjustments

    # create look-up tables to map luminosity to adjusted tint
    # (using floating-point math only to compute table)
    luts = (map(lambda lr: int(lr*sr + 0.5), range(256)) +
            map(lambda lg: int(lg*sg + 0.5), range(256)) +
            map(lambda lb: int(lb*sb + 0.5), range(256)))
    l = grayscale(src)  # 8-bit luminosity version of whole image
    if Image.getmodebands(src.mode) < 4:
        merge_args = (src.mode, (l, l, l))  # for RGB verion of grayscale
    else:  # include copy of src image's alpha layer
        a = Image.new("L", src.size)
        a.putdata(src.getdata(3))
        merge_args = (src.mode, (l, l, l, a))  # for RGBA verion of grayscale
        luts += range(256)  # for 1:1 mapping of copied alpha values

    return Image.merge(*merge_args).point(luts)

if __name__ == '__main__':
    import os

    input_image_path = 'image1.png'
    print 'tinting "{}"'.format(input_image_path)

    root, ext = os.path.splitext(input_image_path)
    result_image_path = root+'_result'+ext

    print 'creating "{}"'.format(result_image_path)
    result = image_tint(input_image_path, '#33b5e5')
    if os.path.exists(result_image_path):  # delete any previous result file
        os.remove(result_image_path)
    result.save(result_image_path)  # file name's extension determines format

    print 'done' 
```

这是一个屏幕截图，左侧显示输入图像，右侧显示相应输出。上面一行是带有 alpha 层的，下面是类似的，没有一层。

![示例输入和输出图像，显示带和不带 alpha 的图像结果](../Images/54c8e2a9e698d476e7645897364af1df.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-06T10:13:08.607

您需要先转换为灰度。我做了什么：

1.  使用获取原始 alpha 层`Image.split()`
2.  转换为灰度
3.  着色使用`ImageOps.colorize`
4.  放回原来的alpha层

结果代码：

```
import Image
import ImageOps

def tint_image(src, color="#FFFFFF"):
    src.load()
    r, g, b, alpha = src.split()
    gray = ImageOps.grayscale(src)
    result = ImageOps.colorize(gray, (0, 0, 0, 0), color) 
    result.putalpha(alpha)
    return result

img = Image.open("image.png")
tinted = tint_image(img, "#33b5e5") 
```

# jquery - 无法在 jQuery 按钮中设置背景颜色

> ID：12251897
> 
> 赞同：0
> 
> 时间：2012-09-03T17:19:21.147
> 
> 标签：jquery, css, jquery-ui, togglebutton

我有一个 jQuery UI 切换按钮。单击按钮时，我想将内部正方形设置为任意颜色。这是显示问题的jsFiddle。

[http://jsfiddle.net/fvcdY/4/](http://jsfiddle.net/fvcdY/4/)

单击按钮时，我希望黑色矩形变为红色，但由于某些原因，它保持黑色。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:09:12.420

You can do this:

```
var legend = $("<span/>", {
    text: ' ',
    style: 'display: inline-block; width: 13px; height: 13px;background-color:black',
    id: 'legend'
}); 
```

So now you can use this id instead of the variable:

```
input.button().click(function() {
    $('#legend').css('background-color', 'red');
}); 
```

Check it here: [http://jsfiddle.net/JpECU/1/](http://jsfiddle.net/JpECU/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:36:18.773

lenged 是一个对象，当被调用时将实例化一个新的 span 元素

创建标签后，您需要使用另一个 var 来存储对适当 span 元素的引用。

毕竟， var legendInsideLabel = $("span").css(........)

这将起作用

# asp.net - Oracle 连接查询

> ID：12251898
> 
> 赞同：0
> 
> 时间：2012-09-03T17:19:21.693
> 
> 标签：asp.net, vb.net, oracle

我的 Oracle 连接似乎出现间歇性问题，表明信号量存在问题，这表明 Oracle 以某种方式保持连接，而不是在使用它们后将其删除。

这是我使用的代码和连接字符串：

连接字符串：`user id=user;password=password;data source=dataSource; Validate Connection=true;Min Pool Size=10;Connection Lifetime=5;Connection Timeout=60;Incr Pool Size=5;`

我使用的代码是这样的：

```
Dim OracleConn As New OracleConnection()
Dim DataTable As DataTable
Dim queryOracle As OracleCommand
Dim OracleDataAdapter As OracleDataAdapter
Dim connStr As String = "user id=user;password=password;data source=dataSource; Validate Connection=true;Min Pool Size=10;Connection Lifetime=5;Connection Timeout=60;Incr Pool Size=5;"
OracleConn.ConnectionString = connStr

Try

            OracleConn.Open()

            queryOracle = OracleConn.CreateCommand()

            queryOracle.CommandText = "select * from table1"

            DataTable = New DataTable()
            OracleDataAdapter = New OracleDataAdapter(queryOracle)
            OracleDataAdapter.Fill(DataTable)

            table1.DataSource = DataTable.DefaultView
            table1.DataBind()

        Catch OracleEx As OracleException
            Throw
        Catch ex As Exception
            Throw
        Finally

            If Not OracleConn Is Nothing And OracleConn.State = ConnectionState.Open Then
                OracleConn.Close()
            End If

        End Try 
```

现在我的问题是：

1.  这是最好的方法吗？
2.  我只“关闭”我的连接是否还需要“处理”它？

顺便说一句，我正在使用`Oracle.DataAccess.Client`。

任何帮助都感激不尽

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:29:26.863

我建议你使用 using 块（最后执行 Dispose）

```
 Using connection As New OracleConnection()

   ....

 End Using 
```

2 应用程序可以多次调用 Close。不会产生异常。

如果调用 Dispose 方法，SqlConnection 对象的状态将被重置。如果您尝试在已处置的 SqlConnection 对象上调用任何方法，您将收到异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:30:51.563

尝试将所有内容放在使用之间。

```
Using oracleConn as OracleConnection = new OracleConnection()
'Your stuff goes here
End Using 
```

命令也是如此。

PS如果再次抛出异常，则无需捕获异常。

# c# - Azure Worker 角色“请求输入之一超出范围”的内部异常。

> ID：12251900
> 
> 赞同：2
> 
> 时间：2012-09-03T17:19:35.563
> 
> 标签：c#, azure, azure-worker-roles, azure-table-storage

我在我的工作角色中调用 CloudTableClient.CreateTableIfNotExist 方法，我收到一个异常，内部异常为“请求输入之一超出范围”。

我做了一些研究，发现这是由于将表命名为非法表名引起的，但是，我尝试为我的表命名几个不同的名称，但都没有成功。我尝试过的一些表名是：

*   例外
*   异常信息
*   错误列表

他们都因相同的错误而失败。

**编辑**

这是我用来创建表的代码：

```
 public static void InitializeTableStorage()
    {
        var storageAccount = CloudStorageAccount.Parse(CloudConfigurationManager.GetSetting(Constants.StorageConnectionString));
        // Retrieve storage account from connection-string
        // Create the table client

        CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

        // Create the table if it doesn't exist
        string tableName = ExceptionsTableName;
        tableClient.CreateTableIfNotExist(tableName);
    } 
```

这是出错的 HTTP 请求：

要求：

```
GET https://<account>.table.core.windows.net/Tables('exceptioninfo') HTTP/1.1
User-Agent: Microsoft ADO.NET Data Services
DataServiceVersion: 1.0;NetFx
MaxDataServiceVersion: 2.0;NetFx
x-ms-version: 2011-08-18
x-ms-date: Mon, 03 Sep 2012 21:54:20 GMT
Authorization: SharedKeyLite <AccountName>:aBcDeFgAbCdEfGhIjKlMnOpQrStUba+jKlMn/DqrsTu=
Accept: application/atom+xml,application/xml
Accept-Charset: UTF-8
Host: <account>.table.core.windows.net
Connection: Keep-Alive 
```

`<account>`都是小写，`<AcountName>`是驼峰式（如果这意味着什么）这是响应：

```
HTTP/1.1 400 One of the request inputs is out of range.
Content-Length: 343
Content-Type: application/xml
Server: Microsoft-HTTPAPI/2.0
x-ms-request-id: abcdefgh-ijkl-44ed-9ff2-3d07df99c266
Date: Mon, 03 Sep 2012 21:54:03 GMT

<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
  <code>OutOfRangeInput</code>
  <message xml:lang="en-US">One of the request inputs is out of range.
RequestId:abcdefgh-ijkl-44ed-9ff2-3d07df99c266
Time:2012-09-03T21:54:03.6716225Z</message>
</error> 
```

我使用相同的 CloudStorageAccount 来创建队列和 Blob，并且成功了。

尝试在 azure 中创建表时，是否还有其他原因导致 OutOfRange 异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T23:48:12.407

我找到了。

查看我从成功的 Queue 请求和失败的 Table 请求中获得的 HTTP 请求和响应，似乎如果 Account Name 有任何大写字母，一切都会失败。

为了解决这个问题，我将帐户名称更改为全部小写，一切正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-19T12:05:45.320

`OutOfRangeInput`存储表出现 HTTP 400 错误的另一个原因是帐户参数不正确。当我忘记修复 cscfg 文件并使用

```
<Setting name="StorageConnectionString" value="DefaultEndpointsProtocol=https;AccountName=TODO;AccountKey=TODO" /> 
```

# javascript - 在鼠标悬停时替换图像源

> ID：12251902
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:19:42.290
> 
> 标签：javascript, jquery, html, image, src

试图在鼠标悬停事件上显示不同的图像。使用以下 JavaScript：

```
$('div.row-fluid').hover(function() {
    $(this).find('img').attr('src','http://leandrovieira.com/projects/jquery/lightbox/photos/image1.jpg');
 }, function() {
    $(this).find('img').attr('src','http://leandrovieira.com/projects/jquery/lightbox/photos/image2.jpg');
 });​ 
```

以及以下 HTML：

```
<div class="span27 offset1" style="margin-top: -3.2em">
      <div class="searchbutton"><img src='http://leandrovieira.com/projects/jquery/lightbox/photos/image2.jpg''></div>
</div> 
```

但没有运气。有什么问题？小提琴：http: [//jsfiddle.net/mpmqm/2/](http://jsfiddle.net/mpmqm/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:20:46.483

`row-fluid`作为类名添加到您的容器中。[http://jsfiddle.net/mpmqm/3/](http://jsfiddle.net/mpmqm/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:22:26.400

[http://jsfiddle.net/mpmqm/4/](http://jsfiddle.net/mpmqm/4/) - 您的选择器已关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:25:54.113

说真的，你**需要学习如何调试 JavaScript 和 jQuery**。

使用 Firefox 和 Chrome，您可以打开控制台并输入（注意：这与`$`您的代码不同！）

```
$('div.row-fluid')
> null 
```

此时您应该意识到选择器不起作用。

```
$('.row-fluid')
> null 
```

仍然`null`- 哦，是的，**没有`.row-fluid`元素**。

或者，您可以使用调试语句丰富您的代码：

```
console.log($('.row-fluid')) 
```

应该报告它的长度为`0`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T17:48:32.927

我在纯 JavaScript 的 stackoverflow 上为另一个人完成了这项工作。与您的情况的唯一区别是他希望在鼠标单击时更改图像 src。请。看看这是否有助于您更正代码：

[使用 Javascript 切换图像 src 属性](https://stackoverflow.com/questions/12225843/toggle-image-src-attribute-using-javascript/12225903#comment16381860_12225903)

# xml - 在 vb.net 中读取一个 RSS 提要，该 RSS 提要是 php

> ID：12251904
> 
> 赞同：1
> 
> 时间：2012-09-03T17:19:48.797
> 
> 标签：xml, vb.net, rss, xmlreader

对不起，标题我不知道如何表达它。我已经搜索了代码示例来阅读 RSS 提要，但是如果它是 XML，它们似乎只能阅读 RSS：mywebsite.com/myfeed.xml，我将如何阅读这样的提要：[http://www。 tvrage.com/myrss.php](http://www.tvrage.com/myrss.php) myrss 是 PHP，XML 阅读器不喜欢它。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:32:29.923

您确实意识到文件的实际内容是 XML 格式的吗？该文件的字面意思是：
`<?xml version="1.0"?>`

如果您自己编写 RSS 阅读器，那么只需将其作为流读取即可。

# c# - C#动态获取类中的变量名和值

> ID：12251910
> 
> 赞同：3
> 
> 时间：2012-09-03T17:20:20.303
> 
> 标签：c#, class, variables, dynamic, settings

我目前正在制作一个具有多个选项的程序（C# .Net 4），这些选项保存到一个文件中。

这些选项是它们自己的代码中的变量，我想知道是否有办法在代码中动态获取这些选项的变量和值。

就我而言，我在“设置”类中有这些选项，我使用 Settings.varSetting 从我的主表单类访问它们。

我在代码中的多个位置获取并设置这些变量；是否可以合并变量列表以便我可以更轻松/一致地访问和设置它们（例如，创建一个设置表单，它可以提取可用选项及其值并动态绘制表单）？

以下是我在设置类中的当前变量：

```
 public static Uri uriHomePage = new Uri("http://www.google.com");
    public static int intInitOpacity = 100;
    public static string strWindowTitle = "OpaciBrowser";
    public static bool boolSaveHistory = false;
    public static bool boolAutoRemoveTask = true; //Automatically remove window from task bar if under:
    public static int intRemoveTaskLevel = 50; //percent
    public static bool boolHideOnMinimized = true; 
```

谢谢你的帮助，

卡尔·塔托姆（TheMusiKid）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:23:13.173

您可能需要考虑使用框架中内置的[应用程序设置功能来加载和存储应用程序设置。](http://msdn.microsoft.com/en-us/library/k4s6c3a0.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T17:25:27.620

```
var dict = typeof(Settings)
    .GetFields(BindingFlags.Static | BindingFlags.Public)
    .ToDictionary(f=>f.Name, f=>f.GetValue(null)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:24:47.703

阅读有关反思：http: [//msdn.microsoft.com/en-us/library/ms173183%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.100%29.aspx)

# c++ - 对我的跟踪算法进行基准测试的框架

> ID：12251913
> 
> 赞同：14
> 
> 时间：2012-09-03T17:20:31.400
> 
> 标签：c++, video, opencv, tracking, simulation

我目前正在开发一个基于 OpenCV/C++ 的应用程序来跟踪小动物：这是它应该处理的视频类型的[示例](https://www.youtube.com/watch?v=q54ZKkoA_t0)。该程序仅输出动物的 x,y 位置和每个区域的时间。这是[结果](https://www.youtube.com/watch?v=k8KOy1xRsSI)在原件上的图形表示。

我的问题有点尴尬——而且可能离题了——因为我不是在问如何改进我的程序，而是**如何评估它**。我知道[Tracking dataset 上存在 Bonn Benchmark](http://www.iai.uni-bonn.de/~kleind/tracking/)，但这不适合我的情况。

该程序旨在处理非常长的视频，因此，我不能现实地要求独立的人类评估动物的位置并将人类与程序进行比较。我也考虑过使用机器人或在更大的动物身上安装转发器以获得精确的位置，但我真的没有资源。

我**产生了使用程序生成在 2d 环境中移动的 blob 视频**的想法。我的问题很简单：

**您是否知道我可以使用任何可编程的高级框架来以图形方式模拟在可参数化背景中随机移动的对象的运动？**

我的梦想是拥有一个可以像这样工作的命令行工具：

```
$ program [BACKGROUND_OPTIONS] [OBJECT_OPTIONS] -V VIDEO_OUTPUT -P POSITIONS_OUTPUT 
```

可以操纵背景纹理以及移动对象的形状、颜色和运动模式。

我知道我可能“很容易”自己制作（如果我找不到任何东西，我会这样做），但我希望程序评估和参考尽可能独立（例如，不是两者都由同一人制作）人）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T19:24:26.443

我见过几个运动检测/跟踪项目做的一件事是使用一些 3D 渲染软件（例如[Blender](http://www.blender.org/) ）创建测试视频。它没有您梦想中的测试创建者的简单界面，但它是一个很好的测试工具，原因有很多：

*   您可以设置您想要的任何场景（不同的视角、对象数量、测试长度、运动路径等）

*   您完全控制照明参数、形状、大小等。

*   您可以设计简单的测试来验证基本功能（带有纯色移动球体的纯色背景是一个很好的起点），然后分支到更复杂的场景（其他静态对象、遮挡其他对象的对象、背景图像等）。

# opengl - OpenGL Glew 和 FreeGlut 链接错误 - GLAPI 未命名类型

> ID：12251918
> 
> 赞同：1
> 
> 时间：2012-09-03T17:21:02.613
> 
> 标签：opengl, linker, codeblocks, freeglut, glew

我正在尝试在 OpenGL 中使用顶点缓冲区对象（在 Code::Blocks 中），但显然您需要执行额外的步骤才能实际使用这些对象，因为我一直有“glGenBuffers 未在此范围内声明”错误，所以经过一番搜索后我发现您可以通过安装加载库来使用这些“扩展”功能：GLEW，它可以为您处理这些问题。

这就是我所做的：我下载了 GLEW Windows 二进制文件。将 glew32.dll 放在我的 Windows/System32 文件夹中，并将 glew32 添加到我的 MinGW 的 lib 文件夹中，并将包含添加到 MinGW 的包含文件夹中。为了安全起见，我还手动添加了 lib 的搜索目录并包含在 Code::Blocks 中。还在我的链接器选项中添加了“-lglew32”。

我已将 Glew 和 Glut 包括在内，如下所示：

```
#ifndef INCLUDES_H_INCLUDED
#define INCLUDES_H_INCLUDED

/* Main Header file that contains all the HEADER */
#include <windows.h>

//Some Main constants
#define PI 3.14159265

//Standard includes
#include <stdio.h>
#include <string>
#include <algorithm>
#include <math.h>
#include <iostream>
#include <vector>
#include <ctime>
using namespace std;

// Open GL and GLUT
#include <gl/glew.h>
#include <gl/glut.h>

/* Game Headers */
#include "Game.h"
#include "Functions.h"

#endif // INCLUDES_H_INCLUDED 
```

就我而言，现在一切都应该正常工作，但是在编译时出现以下错误：
**'GLAPI' does not name a type**

我初始化 glut 和 glew 的主要功能

```
int main(int argc, char* args[])
{
    // #1: GLUT window initialization
    glutInit(&argc, args);
    glutInitDisplayMode(GLUT_RGB|GLUT_DOUBLE);
    glutInitWindowSize(width, height);
    glutInitWindowPosition(width/2, height/2);
    glutCreateWindow("OpenGL 3D Programming.");

    //glutFullScreen(); //optional

    // #2: Registering callbacks
    glutReshapeFunc(reshape);
    glutDisplayFunc(display);

    glewInit();

    // #3: GLUT main loop
    game.init(width, height);
    glutMainLoop();

    return 0;
} 
```

Code::Blocks 中构建选项的完整列表

```
-lglu32
-lfreeglut
-lglew32
-lwinmm -lgdi32
-lmingw32 -lopengl32
-static-libgcc -static-libstdc++ 
```

我现在完全被卡住了，OpenGL 让我现在很难开始使用顶点缓冲区学习 OpenGL。有什么我做错了我错过了吗？

* * *

**更新**
好的，我现在有一些工作。我也将所有包含和库添加到 Code::Blocks/mingw 文件夹中（而不是“仅”C:/MinGW 文件夹）并且丢失了我的 GLAPI 错误。

目前我不确定它是否是一个防故障构建，因为我不太确定我使用的所有步骤，但现在它似乎正在工作。

# bonjour - 如何在 bonjour dns-sd 中添加文本记录

> ID：12251920
> 
> 赞同：1
> 
> 时间：2012-09-03T17:21:44.730
> 
> 标签：bonjour, mdns, dns-sd

我可以在我的 linux 电脑上使用 bonjour dns-sd 注册服务。

```
$dns-sd -P SMARTCAM _ftp._tcp. .  80 AIR 14.99.8.77 
```

现在我无法通过注册添加文本记录。有人可以告诉我如何添加文本记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T23:27:04.820

怎么样：

```
$dns-sd -P SMARTCAM _ftp._tcp. . 80 air.local 14.99.8.77 "u=test" "path=/pub" 
```

`.local`与明显的非本地 IP 地址相比，我只是不确定名称的一部分。你到底想做什么？我通常希望看到这个注册本地 IP 地址，例如：

```
$dns-sd -P SMARTCAM _ftp._tcp. . 80 air.local 10.1.1.58 "u=test" "path=/pub" 
```

如果要注册子类型，例如打印机，则在主类型名称之后添加子类型名称，以逗号分隔（感谢[这篇文章](http://the.taoofmac.com/space/blog/2011/01/02/0017)展示了如何做到这一点）：

```
$dns-sd -P "Test Print" _http._tcp,_printer . 8080 air.local 10.1.1.58 "path=whatever" 
```

# java - 我认为内部类可以访问外部类变量/方法？

> ID：12251922
> 
> 赞同：17
> 
> 时间：2012-09-03T17:22:03.893
> 
> 标签：java

我确实阅读了一些讨论内部类的主题，并且我的印象是内部类可以访问封闭类的变量和方法。下面我有一个外部类和一​​个内部类，在测试类中我创建一个外部类的实例，然后我创建一个内部类的实例。但是我无法通过内部类引用访问字符串变量 a 。帮助？

```
public class OuterClass {

    String a = "A";
    String b = "B";
    String c = "C";

    class InnerClass {
        int x;

    }

    public static class StaticInnerClass {
        int x;
    }

    public String stringConCat() {
        return a + b + c;

    }
}

public class TestStatic {

    public static void main(String args[]) {

        OuterClass.StaticInnerClass staticClass = new OuterClass.StaticInnerClass();
        OuterClass outer = new OuterClass();
        OuterClass.InnerClass inner = outer.new InnerClass();

        System.out.println(inner.a);// error here, why can't i access the string
                                    // variable a here?

    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-03T17:31:38.320

内部类可以通过自己的方法访问外部类的方法和属性。看下面的代码：

```
class OuterClass {

    String a = "A";
    String b = "B";
    String c = "C";

    class InnerClass{
        int x;
        public String getA(){
            return a; // access the variable a from outer class
        }
    }

    public static class StaticInnerClass{
        int x;
    }

    public String stringConCat(){
        return a + b + c;    
    }
}

public class Test{

    public static void main(String args[]) {

        OuterClass.StaticInnerClass staticClass = new OuterClass.StaticInnerClass();
        OuterClass outer = new OuterClass();
        OuterClass.InnerClass inner = outer.new InnerClass();

        System.out.println(inner.getA()); // This will print "A"
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T17:32:00.790

您似乎混淆了范围和访问权限。引用只能访问它们所引用的对象的属性和方法。所以你`inner.a`不能工作。

另一方面，外部类变量在各自内部类的*方法范围内。*所以你可以通过定义一个读访问器来做你想做的事。

```
public class OuterClass {  

    String a = "A";  
    String b = "B";  
    String c = "C";  

    class InnerClass{  
        int x;  
        String getA() {
             return a;
        }
    }  
}  

public class TestStatic {  

    public static void main(String args[]) {  

        OuterClass.StaticInnerClass staticClass = new OuterClass.StaticInnerClass();  
        OuterClass outer = new OuterClass();  
        OuterClass.InnerClass inner = outer.new InnerClass();  

        System.out.println(inner.getA());  //error should be gone now.   

    }  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:24:45.823

`inner`是一个未定义的实例，因此无论如何它都`OuterClass.InnerClass`无法`a`访问它。

要以最简单的方式理解它...查看`a`创建的块和`OuterClass.InnerClass`定义的块。

```
public class OuterClass { // a is defined in this block

    String a = "A";

    class InnerClass{ // InnerClass starts here and an instance will access what is defined now
        int x;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T17:32:12.800

An`Non-static inner class`隐**式引用**了`OuterClass`...

像这样试试......

```
class OuterClass {

    String a = "A";
    String b = "B";
    String c = "C";

    class InnerClass {

            String x = a;    // Directly uses the instance variable a from Outer class

    }

    public static class StaticInnerClass {
        int x;
    }

    public String stringConCat() {
        return a + b + c;

    }
}

public class TestStatic {

    public static void main(String args[]) {

        OuterClass.StaticInnerClass staticClass = new OuterClass.StaticInnerClass();
        OuterClass outer = new OuterClass();
        OuterClass.InnerClass inner = outer.new InnerClass();

        System.out.println(inner.x);

    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T17:39:25.893

```
System.out.println(inner.a); 
```

您试图将其**视为** `a`您的内部类的属性，但事实并非如此。您应该定义一个方法来读取外部类的所需属性。因此，在您的内部课程中，您应该拥有：

```
 public String getA(){
     return a;
 } 
```

* * *

```
System.out.println(inner.getA()); 
```

这应该有效。

# php - 在 if 语句中使用大括号会增加内存使用量？

> ID：12251931
> 
> 赞同：-2
> 
> 时间：2012-09-03T17:23:07.933
> 
> 标签：php, if-statement

这是基本的编程问题。我是一名 PHP 开发人员，但这也对所有人开放。

如果我使用

```
if(something == something){ // do something } 
```

那会比运行慢吗

```
if(something == something) // do something 
```

因为当你有大括号时，编译器会检查其中是否有另一个 if 语句或循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:55:18.583

无关紧要。过早的微优化。当您注意到您的应用程序实际上很慢时，开始担心这些事情。然后进行基准测试或分析。

编写对自己和其他程序员来说最清晰易读的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:28:23.137

你说“慢一点”，但你不是很具体。编译速度较慢或运行速度较慢。

它的编译速度微不足道，运行速度可能微不足道（如果代码未编译为字节码，在这种情况下它们会同样快）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:40:37.140

```
<?php
 if(1==1)
   if(2==3)
      echo 'yes 2 equals 2';
   else
      echo'2 not equals 3';
 else
  echo '1 not equals 1';
?> 
```

O/P : '2 not equals 3'
看看上面的例子和它的输出，即使你不使用大括号，编译器仍然需要检查是否有另一个 if 语句。

# wikipedia-api - 如何使用 MediaWiki API 在页面标题和内容中搜索文本？

> ID：12251934
> 
> 赞同：3
> 
> 时间：2012-09-03T17:23:19.243
> 
> 标签：wikipedia-api, mediawiki-api

我不确定是否真的可以这样做，因为我只能找出如何搜索这样的标题：

```
/api.php?action=query&rvlimit=10&rvprop=content&format=xml&titles=searchterm 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T16:04:36.360

搜索包含单词 'wikipedia' 的 10 个页面

```
api.php ? action=query &amp; list=search &amp; srsearch=wikipedia &amp; srprop=timestamp 
```

结果是

```
<?xml version="1.0"?>
<api>
  <query>
    <searchinfo totalhits="40085" />
    <search>
      <p ns="0" title="Wikipedia" timestamp="2011-02-26T16:43:03Z" />
      <p ns="0" title="French Wikipedia" timestamp="2011-02-27T00:11:59Z" />
      <p ns="0" title="Main Page" timestamp="2011-01-19T19:49:11Z" />
      <p ns="0" title="Regent" timestamp="2011-02-24T03:45:02Z" />
      <p ns="0" title="Blocking of Wikipedia by the People&#039;s Republic of China" timestamp="2011-02-25T03:12:52Z" />
      <p ns="0" title="Nemzeti Bajnokság I" timestamp="2011-02-02T23:27:44Z" />
      <p ns="0" title="Teller–Ulam design" timestamp="2011-02-06T21:54:56Z" />
      <p ns="0" title="Norwegian Wikipedia" timestamp="2011-01-06T18:43:32Z" />
      <p ns="0" title="List of countries and outlying territories by total area" timestamp="2011-02-26T17:31:44Z" />
      <p ns="0" title="2009–2010 ISU Junior Grand Prix" timestamp="2011-02-19T04:24:52Z" />
    </search>
  </query>
  <query-continue>
    <search sroffset="10" />
  </query-continue>
</api> 
```

更多[在这里](https://www.mediawiki.org/wiki/API:Search)

# compilation - 内核编译进度

> ID：12251949
> 
> 赞同：13
> 
> 时间：2012-09-03T17:24:51.557
> 
> 标签：compilation, linux-kernel

有没有办法在编译过程中知道 linux 内核编译的进度。. ?

# spring - SimpleMailMessage 不工作

> ID：12251952
> 
> 赞同：0
> 
> 时间：2012-09-03T17:25:01.440
> 
> 标签：spring, sendmail

我使用spring SimpleMailMessage，每当我尝试发送邮件功能时，我都会得到这个异常：

```
java.lang.IllegalArgumentException: The 'original' message argument cannot be null 
```

我的 spring.xml

```
 <bean id="MailSender" class="com.util.MailSender">

    <property name="mailSender" ref="mailSender"/>
    <property name="templateMessage" ref="templateMessage"/>

</bean> 
```

邮件发件人类：

```
 private MailSender mailSender;
    private SimpleMailMessage templateMessage;

    //getter and setter
    public void sendMail(String content, List<String> listEmail){
        SimpleMailMessage[] mailMessageArray = new SimpleMailMessage[listEmail.size()];
        Iterator<String> iterator = listEmail.iterator();

        for (int index = 0; iterator.hasNext(); index ++){

    SimpleMailMessage message = new SimpleMailMessage(this.templateMessage);
    String toAddress = iterator.next(); 
         message.setTo(toAddress);
     message.setText(content);  
         mailMessageArray[index] = message;

    }
         this.mailSender.send(mailMessageArray);
     } 
```

动作豆类：

```
 private MailSender mailSender=new MailSender();

      public void ReSend(){
         mailSender.sendMail(listBEeans[i].getEmailContent(),listEmail);
          //able to pass the content and listEmails correctly

} 
```

我错过了动作 bean 中的任何配置吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T20:40:50.813

看起来您的 bean 正在创建对 MailSender 的本地引用，而不是使用注入的依赖项（假设您创建了一个）。你应该有的地方：

```
AnObject
{
...
MailSender mailsender = (MailSender)context.getBean("mailSender");
...
} 
```

然后你的 bean 应该说：

```
private MailSender = AnObject.getMailSender(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:31:32.103

问题是您在构造函数中使用的模板是`null`. 它不可能是。

从代码`SimpleMailMessage`：

```
public SimpleMailMessage(SimpleMailMessage original) {
    Assert.notNull(original, "The 'original' message argument cannot be null");
... 
```

检查您的 bean templateMessage 是否真的设置为某些内容或将其从 MailSender 中删除并使用无参数构造函数。

# python - numpy.correlate 是否有可能不遵循给定的公式？

> ID：12251953
> 
> 赞同：1
> 
> 时间：2012-09-03T17:25:07.057
> 
> 标签：python, numpy, correlation

numpy.correlate 命令的文档说，两个数组的互相关被计算为信号处理的一般定义：

> z[k] = sum_n a[n] * conj(v[n+k])

情况似乎并非如此。看起来相关性被翻转了。这意味着公式最后一项中的符号被切换

> z[k] = sum_n a[n] * conj(v[nk])

或者两个输入向量的顺序错误。给定公式的简单实现是：

```
x = [1.0, 2.0, 3.0]
y = [0.0, 0.5, 2.0]
y_padded = numpy.append( [0.0, 0.0] , y)
y_padded = numpy.append(y_padded, [0.0, 0.0] )

crosscorr_numpy = numpy.correlate(x, y, mode='full')

crosscorr_self = numpy.zeros(5)
for k in range(5):
    for i in range(3):
        crosscorr_self[k] += x[i] * y_padded[i+k]

print crosscorr_numpy
print crosscorr_self 
```

您可以很容易地看到结果向量的顺序错误。当它没有产生我预期的结果时我非常困惑，并且很确定（在与我的同事讨论之后）这是一个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:12:58.870

您使用的是哪个版本的 NumPy？在我的 Debian Squeeze 盒子上：

```
In [1]: import numpy as np

In [2]: np.__version__
Out[2]: '1.4.1' 
```

当我运行您的示例时，我得到：

```
/usr/lib/pymodules/python2.6/numpy/core/numeric.py:677: DeprecationWarning: 
The current behavior of correlate is deprecated for 1.4.0, and will be removed
for NumPy 1.5.0.

The new behavior fits the conventional definition of correlation: inputs are
never swapped, and the second argument is conjugated for complex arrays.
  DeprecationWarning)
[ 2\.   4.5  7\.   1.5  0\. ]
[ 0\.   1.5  7\.   4.5  2\. ] 
```

所以你可能对（不正确的）行为是正确的，但它可能已经在新版本中得到修复。

# java - 指向结构的 JNA 指针

> ID：12251958
> 
> 赞同：0
> 
> 时间：2012-09-03T17:25:49.500
> 
> 标签：java, pointers, dll, struct, jna

我需要使用 JNA 传递一个结构。

我拥有的文档包含以下信息：

```
int rdGetStatusHardware (struct StatusHardware *stat)

struct StatusHardware{
unsigned char   SerialNumber[12];   
unsigned long   HWVersion;
unsigned long   FWVersion;
unsigned long   MemorySize;
unsigned short  BootVersion;
unsigned short  FPGAVersion;
unsigned long   Devices;
unsigned char   Reserved[8];
}; 
```

我将结构映射为：

```
public class StatusHardware extends Structure {
    public byte SerialNumber[] = new byte[12];
    public byte HWVersion[] = new byte[4];
    public byte FWVersion[] = new byte[4];            
    public byte MemorySize[] = new byte[4];
    public byte BootVersion[] = new byte[2];
    public byte FPGAVersion[] = new byte[2];
    public byte Devices[] = new byte[4];
    public byte Reserved[] = new byte[8];
    public StatusHardware(Pointer p){
        super(p);
    }
} 
```

这是我界面中的方法：

```
int rdGetStatusHardware(Pointer p); 
```

调用库：

```
Pointer ptr = new Memory(40);
int result = CLibrary.INSTANCE.rdGetStatusHardware(ptr); 
```

使用这种方法，我收到以下错误：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x00000000, pid=3108, tid=5492
#
# JRE version: 6.0_24-b50
# Java VM: Java HotSpot(TM) Client VM (19.1-b02 mixed mode windows-x86 )
# Problematic frame:
# C  0x00000000 
```

尝试了我在互联网上找到的其他方法......结果和错误相同。

是结构问题还是接口问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:51:29.893

AFAIK，在这种情况下，JNA 可以为您传递对结构的引用，因此您的方法将如下所示：

```
int rdGetStatusHardware(StatusHardware p);
...
StatusHardware ptr = new StatusHardware();
int result = CLibrary.INSTANCE.rdGetStatusHardware(ptr); 
```

**编辑**

可能会导致访问冲突，因为您将 long 映射到固定大小的字节数组。Long 大小可能因平台而异，因此您应始终使用 NativeLong：

```
public class StatusHardware extends Structure {
    public byte SerialNumber[] = new byte[12];
    public NativeLong HWVersion;
    public NativeLong FWVersion;            
    public NativeLong MemorySize;
    public short BootVersion;
    public short FPGAVersion;
    public NativeLong Devices;
    public byte Reserved[] = new byte[8];
} 
```

# xml - 使用 xslt 替换 xml 中的标签时的命名空间问题

> ID：12251961
> 
> 赞同：1
> 
> 时间：2012-09-03T17:26:03.903
> 
> 标签：xml, xslt

我在使用 XSLT 重命名 xml 标记时遇到问题。下面是我的输入xml。

原始 XML：

```
<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
<soapenv:Body>
<ns:Response xmlns:ns="http://demo.test.classes.com">
   <ns:return>
      <ns:person>
         <ns:personName></ns:personName>
         <ns:personAge></ns:personAge>
         <ns:personAddress>
            <ns:addressType>official</ns:addressType>
            <ns:addressLine1>official address line 1</ns:addressLine1>
         </ns:personAddress>
         <ns:personAddress>
            <ns:addressType>residence</ns:addressType>
            <ns:addressLine1>residence address line 1</ns:addressLine1>
         </ns:personAddress>         
      </ns:person>
   </ns:return>
</ns:Response>
</soapenv:Body>
</soapenv:Envelope> 
```

转换后的预期 XML：这是我正在寻找的最终 xml！

```
<MyResponse>
      <person>
         <personName></personName>
         <personAge></personAge>
         <personAddress>
            <addressType>official</addressType>
            <addressLine1>official address line 1</addressLine1>
         </personAddress>
         <personAddress>
            <addressType>residence</addressType>
            <addressLine1>residence address line 1</addressLine1>
         </personAddress>         
      </person>
</MyResponse> 
```

这是 XSLT，我现在正在使用。但这不会生成我需要的 xml。问题是，如果我不包含模板 match="ns:Response"，则生成的 xml 类似于上面的 xml，除了根标签是“Response”并且它完全符合我的需要。但是当我引入 match="ns:Response" 时，我们的 xml 没有格式化为 xml，并且生成的 xml 在“MyResponse”旁边包含命名空间 xmlns:ns="http://demo.test.classes.com"标签。请让我知道在下面的 xslt 中应该修改什么？

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" />

    <xsl:template match="/|comment()|processing-instruction()">
        <xsl:copy>
            <xsl:apply-templates />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="*">
        <xsl:element name="{local-name()}">
            <xsl:apply-templates select="@*|node()" />
        </xsl:element>
    </xsl:template>

    <xsl:template match="@*">
        <xsl:attribute name="{local-name()}">
      <xsl:value-of select="." />
    </xsl:attribute>
    </xsl:template>

    <xsl:template xmlns:ns="http://demo.test.classes.com" match="ns:return">
    <xsl:apply-templates/>
    </xsl:template>

    <xsl:template xmlns:ns="http://demo.test.classes.com" match="ns:Response">
    <MyResponse><xsl:apply-templates select="node()|@*"/></MyResponse>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:21:35.567

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:x="http://demo.test.classes.com" exclude-result-prefixes="x">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="x:Response">
  <MyResponse>
   <xsl:apply-templates/>
  </MyResponse>
 </xsl:template>

 <xsl:template match="x:Response/*//*">
  <xsl:element name="{local-name()}">
   <xsl:apply-templates/>
  </xsl:element>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
<soapenv:Body>
<ns:Response xmlns:ns="http://demo.test.classes.com">
   <ns:return>
      <ns:person>
         <ns:personName></ns:personName>
         <ns:personAge></ns:personAge>
         <ns:personAddress>
            <ns:addressType>official</ns:addressType>
            <ns:addressLine1>official address line 1</ns:addressLine1>
         </ns:personAddress>
         <ns:personAddress>
            <ns:addressType>residence</ns:addressType>
            <ns:addressLine1>residence address line 1</ns:addressLine1>
         </ns:personAddress>
      </ns:person>
   </ns:return>
</ns:Response>
</soapenv:Body>
</soapenv:Envelope> 
```

**产生想要的正确结果：**

```
<MyResponse>
    <person>
        <personName/>
        <personAge/>
        <personAddress>
            <addressType>official</addressType>
            <addressLine1>official address line 1</addressLine1>
        </personAddress>
        <personAddress>
            <addressType>residence</addressType>
            <addressLine1>residence address line 1</addressLine1>
        </personAddress>
    </person>
</MyResponse> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T00:14:02.540

这是另一个。这是对我对您第一个问题的回答的调整。它比 Dimitre 的更冗长（3 个模板而不是 2 个），但作为补偿它可能更有效，因为匹配条件非常简单。

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope"
    xmlns:ns="http://demo.test.classes.com"
    exclude-result-prefixes="xsl soapenv ns">
<xsl:output method="xml" indent="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="*">
 <xsl:element name="{local-name()}">
  <xsl:apply-templates />
 </xsl:element>
</xsl:template>

<xsl:template match="ns:return">
  <MyResponse>
   <xsl:apply-templates/>
  </MyResponse>
</xsl:template>

<xsl:template match="soapenv:Envelope|soapenv:Body">
  <xsl:apply-templates/>
</xsl:template>

</xsl:stylesheet> 
```

# java - 大数的素数分解

> ID：12251962
> 
> 赞同：3
> 
> 时间：2012-09-03T17:26:09.523
> 
> 标签：java, algorithm, prime-factoring

我想找到小于 10^12 的大数的素数分解。我得到了这段代码（在java中）：

```
public static List<Long> primeFactors(long numbers) {
        long n = numbers;
        List<Long> factors = new ArrayList<Long>();
        for (long i = 2; i <= n / i; i++) {
            while (n % i == 0) {
                factors.add(i);
                n /= i;
            }
        }
        if (n > 1) {
            factors.add(n);
        }
        return factors;
    } 
```

首先，上述算法的复杂性是什么？？我很难找到它？？

对于素数的大数来说，它也太慢了。

有没有更好的算法，或者如何优化这个算法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-03T17:39:36.777

如果您想分解*许多*大数，那么您最好先找到质数`sqrt(n)`（例如使用[埃拉托色尼筛](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)）。然后你只需要检查这些素数是否是因数，而不是测试 all `i <= sqrt(n)`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-03T17:29:44.380

复杂度是`O(sqrt(n))`。之后检查数字是没有意义的`sqrt(n)`。

这意味着对于`10^12`，它最多需要`1 000 000`迭代，这并不慢。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-03T17:53:12.700

因式分解大数是一个难题，这也是加密算法使用大素数的因数来使加密难以破解的部分原因。

```
public static void main(String... args)  {
    int nums = 100;
    for (int i = 0; i < nums; i++) {
        long start = System.nanoTime();
        primeFactors(Long.MAX_VALUE - i);
        long time = System.nanoTime() - start;
        if (time > 100e6)
            System.out.println((Long.MAX_VALUE-i) + " took "+time/1000000+" ms.");
    }
}

public static List<Long> primeFactors(long n) {
    List<Long> factors = new ArrayList<Long>();
    while (n % 2 == 0 && n > 0) {
        factors.add(2L);
        n /= 2;
    }

    for (long i = 3; i * i <= n; i+=2) {
        while (n % i == 0) {
            factors.add(i);
            n /= i;
        }
    }
    if (n > 1)
        factors.add(n);

    return factors;
} 
```

印刷

```
9223372036854775806 took 3902 ms.
9223372036854775805 took 287 ms.
9223372036854775804 took 8356 ms.
9223372036854775797 took 9519 ms.
9223372036854775796 took 1507 ms.
9223372036854775794 took 111 ms.
9223372036854775788 took 184 ms. 
```

如果将 Long.MAX_VALUE 替换为 1000000000000L，它们都会在 20 毫秒内分解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T05:06:02.793

一个更好的算法可能是以下搜索素数（我的 java 生锈了，所以可能需要一些调整才能编译）。

```
if (number % 2)
   factors.append(2)
if (number % 3)
   factors.append(3)

for(int n = 0; n < sqrt(number)/6; n++)
{
   if (number % (6 * n + 1))
      factors.append(6 * n + 1);
   if (number % (6 * n - 1))
      factors.append(6 * n - 1);
} 
```

# .net - 使用 PowerShell 的 Rapidshare API

> ID：12251965
> 
> 赞同：0
> 
> 时间：2012-09-03T17:26:27.793
> 
> 标签：.net, powershell, rapidshare

```
$FreeUploadServer = Invoke-RestMethod -Uri "http://api.rapidshare.com/cgi-bin/rsapi.cgi?sub=nextuploadserver"
Invoke-RestMethod -Uri "http://rs$FreeUploadServer.rapidshare.com/cgi-bin/rsapi.cgi?sub=upload&login=43533592&password=password&filecontent=C:\libs\test.txt" 
```

我不知道为什么这不起作用，它与 filecontent 参数有关，但我已经阅读了有关 API 的整个文档，但我无法弄清楚。

[API 文档](http://images.rapidshare.com/apidoc.txt)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:45:16.380

确保`-Method Post`在第二个 Invoke-RestMethod 调用中使用参数/arg 组合。另外，请查看此[SO 对有关使用 CURL 的类似问题的回复](https://stackoverflow.com/questions/10987651/uploading-files-to-rapidshare-using-php-and-curl-via-their-api)。查看问题和答案后，RapidShare 似乎需要填写 POST 表单字段。在这种情况下，您需要指定`-Body`参数。我认为您将使用 PowerShell 哈希表，其中每个条目对应于一个表单字段名称/值对。看起来需要的一个字段是`filecontent`字段。大概该值是文件的内容。

此外，当您使用 POST 时，您必须将`GET`查询参数转换为`POST`表单字段，例如：

```
$url = "http://rs$FreeUploadServer.rapidshare.com/cgi-bin/rsapi.cgi"
$fields = @{sub='upload';login='43533592';password='password';filename='test.txt';
            filecontent=([IO.File]::ReadAllText('c:\libs\test.txt'))}

Invoke-RestMethod -Uri $url -Body $fields -Method Post 
```

如果`[IO.File]::ReadAlltext()`不削减它也许尝试`[IO.File]::ReadAllBytes()`代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:15:50.813

原来 API 文档中有一小部分说明如果您使用 POST 方法，所有参数都需要在正文中传递。我在 PowerShell 中编写了一个上传到 RapidShare 的函数，我希望这对未来的人们有所帮助，因为这非常烦人。

```
function Upload-RapidShare([string]$File,[string]$Name)
{
     $FreeUploadServer = Invoke-RestMethod -Uri "http://api.rapidshare.com/cgi-bin/rsapi.cgi?sub=nextuploadserver"
     Invoke-RestMethod "http://rs$FreeUploadServer.rapidshare.com/cgi-bin/rsapi.cgi" -Body  "sub=upload&login=USERNAME&password=PASSWORD&filename=$Name&filecontent=$File" -Method Post
} 
```

# gruntjs - 排除较少的目录

> ID：12251967
> 
> 赞同：1
> 
> 时间：2012-09-03T17:26:49.650
> 
> 标签：gruntjs, gruntjs

我正在使用[gruntjs](/questions/tagged/gruntjs "显示标记为“gruntjs”的问题")构建我的 src，并且我想`css/less/*.less`从我发布的文件夹中排除。

我应该使用*排除列表*还是复制任务有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T16:23:05.467

创建`.buildignore`文件并添加 css/less

# razor - 在 mvc razor 中使用 jquery 上传文件

> ID：12251969
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:01.163
> 
> 标签：razor

我是 MVC 3 Razor 的新手。如何使用 Jquery 上传文件。下面提到的我的代码

```
@using (Html.BeginForm())
    {
        <input type='file' name='file' id='file' />
        <input type="Button" value="upload" />
    } 
```

下面提到了一些限制

*   我无法在 html.BeginForm(...) 中定义我的操作和控制器
*   我不能使用上面上传按钮的 type="submit"。

现在我希望你清楚当我点击上传按钮时 jquery 函数将被调用，从那里我的动作应该被调用，并且在控制器中我想用上传的文件实现我的逻辑。

请让我知道如何实现这个。??????任何示例演示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T11:37:53.283

这很简单

```
@using (Html.BeginForm())
    {
        <input type='file' name='file' id='file' />
        <input type="Button" value="upload" onclick="upload()" />
    }

<script>
    function upload() {
        $.ajax({
            type: "POST",
            url: '@Url.Action("Upload")',
            dataType: "multipart/form-data",
            data: $('#file'),
            cache: false
        });
    }
</script> 
```

# python - 插值大数据 Python

> ID：12251972
> 
> 赞同：3
> 
> 时间：2012-09-03T17:27:21.770
> 
> 标签：python, numpy, scipy, interpolation

我正在开发一个使用`NumPy`and的 Python 项目`SciPy`。我有以下内容：

```
x = numpy.arange(-5,5,0.01)
y = numpy.arange(-5,5,0.01) 
```

`x`我也有这样的`y`功能

```
# fxy = function of x and y in a grid
# fxy.shape = (y.shape[0], x.shape[0]) 
```

我想进行插值`fxy`，使函数值位于`x`或分开的`y`点，`0.0001`即`0.001`我想评估函数`fxy`

```
finer_x = numpy.arange(-5,5,0.0001)
finer_y = numpy.arange(-5,5,0.0001)

# finer_fxy = function of finer_x and finer_y in a grid
# finer_fxy.shape = (finer_y.shape[0], finer_x.shape[0]) 
```

我一直在尝试使用`bisplrep`and`interp2d`函数，`scipy.interpolate`但我得到了

```
File "/usr/lib/python2.7/dist-packages/scipy/interpolate/fitpack.py", line 873, in bisplrep
tx,ty,nxest,nyest,wrk,lwrk1,lwrk2)
MemoryError 
```

和

```
OverflowError: Too many data points to interpolate 
```

分别使用这些功能。创建插值数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:03:56.827

显然，你在你的 NumPy 盘子上加了太多分，很抱歉听到这个消息。

我的建议是首先绘制你的数据，找到相对线性的区域，然后跳过它们。也就是说，尝试将您的数组分解为不同的区域，并执行分段插值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:00:39.430

您的数据位于常规网格上：尝试使用 RectBivariateSpline。

bisplrep/interp2d 用于分散数据。

# listview - 从 Set 获取对 BluetoothDevices 的访问权限

> ID：12251973
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:25.390
> 
> 标签：listview, bluetooth, set, onitemclick

我正在尝试在 Android 和蓝牙模块之间建立连接。在“发现”之后，我按照[http://developer.android.com/guide/topics/connectivity/bluetooth.html](http://developer.android.com/guide/topics/connectivity/bluetooth.html)的说明 将找到的设备放入 ListView 中，该 ListView 具有注册的`OnItemClickListener`.

我现在的问题是我需要`BluetoothDevice`单击条目中的 来在下一步中建立连接。我所拥有的只是 ListView 中的一个位置 ID 和一个`Set<BluetoothDevice>`. 但我不知道如何`BluetoothDevice`从集合中提取特定内容。

到目前为止，这是我的代码。谢谢！！

```
ProgressBar spinWheel;
ListView devList;
BluetoothAdapter btAdapter;
ArrayAdapter<String> lvAdapter;
BroadcastReceiver mReceiver;
Set<BluetoothDevice> pairedDevices;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.searchlist);
    spinWheel = (ProgressBar)findViewById(R.id.progressBar1);
    btAdapter = BluetoothAdapter.getDefaultAdapter();
    devList = (ListView)findViewById(R.id.devicelist);
    lvAdapter = new ArrayAdapter<String>(getApplicationContext(),
            R.layout.simplerow, R.id.simpleRow);
    devList.setAdapter(lvAdapter);
    devList.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parentView, View childView, int position,
                long id) {
            //establish Connection, need the clicked BluetoothDevice
        }
    });

    //gepaarte Geräte in die ListView
    pairedDevices = btAdapter.getBondedDevices();
    //If there are paired devices
    if (pairedDevices.size() > 0) {
        // Loop through paired devices
        for (BluetoothDevice device : pairedDevices) {
            // Add the name and address to an array adapter to show in a ListView
            lvAdapter.add(device.getName() + "\n"+ "#"+ device.getAddress());
        }
    }

    // Create a BroadcastReceiver for ACTION_FOUND
        mReceiver = new BroadcastReceiver() {
        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            // When discovery finds a device
            if (BluetoothDevice.ACTION_FOUND.equals(action)) {
                // Get the BluetoothDevice object from the Intent
                BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
                // Add the name and address to an array adapter to show in a ListView
                lvAdapter.add(device.getName() + "\n" + device.getAddress());
                pairedDevices.add(device);
            }
        }
    };
    // Register the BroadcastReceiver
    IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
    registerReceiver(mReceiver, filter); // Don't forget to unregister during onDestroy
    btAdapter.startDiscovery();
    }

@Override
public void onDestroy(){
    super.onDestroy();
    unregisterReceiver(mReceiver);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T12:30:56.717

我自己解决了这个问题，但我想发布它来帮助别人。我使用了函数 BluetoothAdapter.getRemoteDevice(String adress)。作为从 ListView 中插入字符串的地址，在“#”处拆分。

```
public void onItemClick(AdapterView<?> parentView, View childView, int position,
                long id) {
            String[] separated = lvAdapter.getItem(position).split("#");
            if(btAdapter.checkBluetoothAddress(separated[1])==true){
            devtoconnect = btAdapter.getRemoteDevice(separated[1]);
            }
        }
    }); 
```

不过，感谢您在其他问题上的帮助！

# javascript - Javascript/JQuery。本地缓存xml文件

> ID：12251975
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:28.753
> 
> 标签：javascript, jquery

使用`$.ajax({..})`我从服务器接收 XML 文件的内容。所以我不必每次页面加载时都请求这个文件，如果可能的话，我想在本地缓存这个内容，将它保存在磁盘上的文件中。但是以这样的方式缓存它，即使在第二天重新启动后它也可以使用。XML 文件内容每天更新，因此无需如此频繁地重新发送文件。

是否可以？如果是这样，我该如何实现？你能提供一个链接或一些示例代码吗？我一直在寻找我能理解的好东西，但我没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:29:55.670

你需要这个

[http://brian.io/lawnchair/](http://brian.io/lawnchair/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:39:14.843

默认情况下，浏览器通常会根据服务器设置文件头的方式为您缓存响应。如果您需要除此之外的持久性，您可以使用[本地存储](https://developer.mozilla.org/en-US/docs/DOM/Storage)和可能的 cookie 来支持旧版支持（尽管在存储方面存在非常实际的大小限制）。

使用本地存储很简单。您还可以使用过期时间戳让客户端知道何时更新缓存。

一个准系统示例：

```
var mydata = { foo: 'bar' };
var cache = {
    data: mydata,
    expires: new Date().getTime()
}

sessionStorage.setItem("cache", JSON.stringify(cache)); 
```

并获取数据：

```
var cache = JSON.parse( sessionStorage.getItem("cache") );
if ( cache.expires + day < new Date().getTime() ) {
    // get a fresh copy
} else {
    var mydata = cache.data;
} 
```

如果您更熟悉更高级别的 API，则可以使用许多本地缓存抽象。

# ruby - Rails 3 + Devise + Rspec - 控制器测试中的未定义方法错误

> ID：12251977
> 
> 赞同：2
> 
> 时间：2012-09-03T17:27:38.730
> 
> 标签：ruby, ruby-on-rails-3, rspec, devise, factory-bot

我有这样的**规范**（spec/controllers/stats_controller_spec.rb）来测试我的控制器：

```
require 'spec_helper'

describe StatsController do
  render_views

  before(:each){ @user = FactoryGirl.create( :user ) }

  describe "GET 'users_in_system'" do
    describe "for non-signed users" do
      it "should deny access" do
        get :users_in_system, :locale => :en
        #...
      end
    end
  end
end 
```

当我运行这个规范时，我得到这样的**错误**：

```
1) StatsController GET 'users_in_system' for non-signed users should deny access
     Failure/Error: get :users_in_system, :locale => :en
     ActionView::Template::Error:
       undefined method `authenticate' for nil:NilClass
     # ./app/views/layouts/_navbar_template.html.haml:16:in `_app_views_layouts__navbar_template_html_haml__2938837959272005060_70149962955560'
     # ./app/views/layouts/application.html.haml:12:in `_app_views_layouts_application_html_haml__243298846079092947_70149956982200'
     # ./spec/controllers/stats_controller_spec.rb:12:in `block (4 levels) in <top (required)>' 
```

我试图通过将此行添加到 (spec/spec_helper.rb) 来解决此错误：

```
#...

RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
  #...
end 
```

然后我开始收到这样的错误：

```
1) StatsController GET 'users_in_system' for non-signed users should deny access
     Failure/Error: Unable to find matching line from backtrace
     NoMethodError:
       undefined method `env' for nil:NilClass
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/devise-2.1.0/lib/devise/test_helpers.rb:33:in `warden'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-rails-2.10.0/lib/rspec/rails/adapters.rb:15:in `block (2 levels) in setup'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:178:in `instance_eval'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:178:in `instance_eval'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/hooks.rb:23:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/hooks.rb:63:in `block in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/hooks.rb:63:in `each'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/hooks.rb:63:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/hooks.rb:400:in `run_hook'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:298:in `run_before_each_hooks'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:239:in `run_before_each'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:86:in `block in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:195:in `with_around_each_hooks'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example.rb:84:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:353:in `block in run_examples'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:349:in `map'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:349:in `run_examples'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:335:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `block in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `map'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `block in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `map'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/example_group.rb:336:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:28:in `map'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:28:in `block in run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/reporter.rb:34:in `report'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:25:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:69:in `run'
     # /Users/serg/.rvm/gems/ruby-1.9.3-head/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun' 
```

我尝试添加（spec/controllers/stats_controller_spec.rb）：

```
describe StatsController do
  render_views
  include Devise::TestHelpers
  #...
end 
```

但这并没有改变。我该如何修复它？

**UPD**：我的统计控制器：

```
class StatsController < ApplicationController
  def users_in_system
    @users = User.all
  end
end 
```

我的导航栏：

```
%div{ :class => "navbar navbar-inverse navbar-fixed-top" }
  %div{ :class => "navbar-inner" }
    %a{:class => "btn btn-navbar", "data-toggle" => "collapse", "data-target" => ".nav-collapse"}
      %span{:class=>"icon-bar"}
      %span{:class=>"icon-bar"}
      %span{:class=>"icon-bar"}

    = link_to t(".brand_name"), root_path, { :class => "brand" }
    %div{ :class => "nav-collapse" }
      -# Left navigation.
      %ul{ :class => "nav" }
        %li=link_to "About", about_path

      -# Right navigation.
      %ul{ :class => "nav pull-right" }
        - if user_signed_in?
          %li=link_to t(".settings"), edit_user_registration_path
          %li{ :class => "divider-vertical" }
          %li=link_to t(".logout_link"), destroy_user_session_path, :method => :delete 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T19:46:16.323

您的回溯看起来像您使用的设置回调顺序`rspec-rails` `2.10.0`存在[此问题。](https://github.com/rspec/rspec-rails/issues/534)尝试将该特定 gem 的版本升级到`2.10.1`它应该修复的版本。

你在正确的道路上

```
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
  #...
end 
```

所以我认为你可以`include Devise::TestHelpers`从你的规范文件中删除显式。

# delegates - 在多个 CCLayer 上滑动

> ID：12251978
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:57.637
> 
> 标签：delegates, cocos2d-iphone, gestures, cclayer

`CCLayer`想象一个子类的三个实例`Block`彼此相邻。每个都是 100x100 像素，并有一些基本的方形背景艺术。这三个对象是封装`CCLayer`子类的一部分，称为`Container`.

**如何在三个块上滑动并检测容器中每个块的滑动/点击/触摸？**

如果问题仅限于处理对`Block`s 的点击，`Container`那么可以使用委托。类似于`BlockDelegate`所需方法的东西，每当点击 a 时`userTappedBlock:(Block *) b`都会通知。`Container``Block`

但是，这种方法还不适用于刷卡。我收到了回调，`Container`但只针对第一个`Block`被点击的回调。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:32:33.980

您可以在包含您的块的层中处理触摸。然后，在`touchEnded:WithEvent:`方法中检查哪个块包含触摸的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-26T09:45:32.413

在 CustomLayer.cpp 中编写这个方法来点击图层

void CustomLayer::ccTouchesBegan(CCSet *pTouches, CCEvent *pEvent)

{

```
 CCTouch *touch = (CCTouch *) pTouches->anyObject();
     CCPoint location = touch->getLocationInView();
     location = CCDirector::sharedDirector()->convertToGL(location);

         if(layer->boundingBox().containsPoint(location))
                CCLog("layer Hit Test");

} 
```

# java - 使用整数数组的冒泡排序

> ID：12251979
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:57.223
> 
> 标签：java, sorting, bubble-sort

我一直在尝试在 java 中使用简单的整数数组来实现冒泡排序。不过好像有点问题。现在我知道使用 ArrayList 将是最好的选择，我也会这样做。但是为什么不使用简单的整数数组对其进行排序。这是代码

```
package sort;

public class BubbleSort {

    int array[]={1,5,3,32,54,6,87,5,1};
    int temp=0;
public void enter(){
    for(int i=0;i<array.length;i++){
        for(int j=0;j<(array.length-i);j++){
            if(array[j]>=array[j+1]){

                temp=array[j];
                array[j]=array[j+1];
                array[j+1]=temp;
                }

        }
    }
}
public void show(){

    for(int i:array){
    System.out.println(i);
    }
}
public static void main(String str[]){

    new BubbleSort().Enter();
    new BubbleSort().Show();
}
} 
```

它产生与输入相同的数组。什么都没有改变。简单数组和 ArrayList 或 Vector 之间的区别，只是它们提供了数组大小的动态时间扩展。还有什么更多的吗？我的意思是简单数组每次操作时都会创建一个不同的实例，就像字符串一样？这里似乎确实如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:32:31.697

因为您正在**对一个实例进行排序并显示另一个。**

```
new BubbleSort().Enter();
new BubbleSort().Show(); 
```

采用

```
BubbleSort bubbleSort = new BubbleSort();
bubbleSort.Enter();
bubbleSort.Show(); 
```

此外**，您至少应该重命名`Enter()`为`enter()`和`Show()`to`show()`**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-03T17:33:39.643

问题是您没有为 BubbleSort 类的实例化指定名称。

```
new BubbleSort().Enter();
new BubbleSort().Show(); 
```

您的代码创建一个新的 BubbleSort 类，然后对其进行排序。然后它创建另一个新的（并且完全独立的） BubbleSort 类，并改为显示那个 - 它还没有被排序。

您想为变量命名，以便对其进行排序然后显示它，如下所示：

```
BubbleSort myBubbleSort = new BubbleSort();
myBubbleSort.Enter();
myBubbleSort.Show(); 
```

作为旁注（并在 SiB 的回答中指出），您可能还想查看[Java Naming Conventions](http://www.oracle.com/technetwork/java/javase/documentation/codeconvtoc-136057.html)。遵循这些约定可以使您的代码对其他 Java 程序员更易读，并包括使用`lowerCamelCase`方法名称和`UpperCamelCase`类名称等内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-03T17:36:45.887

因为您正在创建两个不同的 BubbleSort 对象，对第一个对象进行排序并显示不同的对象。

本来应该是......

```
public static void main(String str[]){

    BubbleSort sort = new BubbleSort();
    sort.Enter();
    sort.Show():

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-08T01:42:19.423

正确的 BubbleSort 代码是：

```
 int temp = 0;
    for (int i = 0; i < array.length; i++) {
        for (int j = 1; j < (array.length - i); j++) {
            if (array[j - 1] > array[j]) {
                temp = array[j - 1];
                array[j - 1] = array[j];
                array[j] = temp;
            }

        }
    } 
```

我希望它可以帮助其他人寻找它。

# sql - MS SQL：从 3 列中检索“Varchar”数据并将它们组合在一起

> ID：12251980
> 
> 赞同：0
> 
> 时间：2012-09-03T17:27:57.857
> 
> 标签：sql, sql-server, jdbc

我的 sql 表中有三列，“FirstName”、“MiddleName”、“LastName”。检索时，我需要将这3个一起显示，例如

FirstName = "John" MiddleName = "Ned" LastName = "Carter"。

检索时，这些应显示为“John Ned Carter”。

我尝试了以下

```
select FirstName+MiddleName+LastName from PhoneData 
```

有一个问题！！！有许多中间名为 NULL 的名称。有许多姓氏为 NULL 的名称，依此类推。这不是检索那些！！！它只是检索所有字段都不为空的名称！！！！如果特定名称的至少一列为空，则将整个名称显示为空！！！例如，

FirstName = "John" MiddleName = NULL LastName = NULL

在检索时，输出是 'NULL'，而不是 "John"

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:29:20.163

尝试[`ISNULL()`](http://msdn.microsoft.com/en-us/library/ms184325.aspx)围绕每个字段的功能。然后，您可以为所选值为 null 时设置一个值。

像这样;

```
select ISNULL(FirstName, '') + ISNULL(MiddleName, '') + ISNULL(LastName, '') from PhoneData 
```

# php - 如何缓存通过 PHP 提供的图像？

> ID：12251989
> 
> 赞同：1
> 
> 时间：2012-09-03T17:29:08.920
> 
> 标签：php, caching, header

我将我网站的背景图像设置为服务器上的一个 url，这是一个 php 脚本，它提供一个图像作为其输出。这是它的代码：

```
 //$mime is usually image/jpeg, etc
   header("Content-type: $mime");
   $image = readfile($image);
   imagejpeg($image); 
```

问题是，每次我加载我的页面时，图像似乎都被再次加载而不是被缓存。有什么我可以做的吗，例如发送一个标题来缓存图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:32:12.797

我总是使用 ETag（`md5`哈希）和 Last-Modified（过去的日期，通常是创建文件时）获得最佳结果。

对于您的代码，它将是这样的：

```
$etag = md5_file($image);
$lastModified = gmdate('D, d M Y H:i:s', filemtime($image)) . ' GMT';

header("Content-type: $mime");
header("ETag: \"{$etag}\"");
header("Last-Modified: $lastModified");
header('Expires: ' . gmdate("D, d M Y H:i:s", ((60*60*24*45)+strtotime($lastModified)))); // add 45 days expire

$image = readfile($image);
imagejpeg($image); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:34:25.920

使用 last-modified 标题字段并将其始终设置为过去的日期。

这样，浏览器将从您的服务器收到“未修改”回复，并将使用图像的缓存版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:34:33.627

我建议添加一个标头来告知图像文件上次修改的日期：

```
 header("Last-Modified: " . gmdate("D, d M Y H:i:s", filemtime($image)) . " GMT");
 header("Content-type: $mime");
 $image = readfile($image);
 imagejpeg($image); 
```

这样浏览器将能够缓存图像。

# database - 转储 sqlite3 数据库以在 Titanium 中使用

> ID：12251993
> 
> 赞同：0
> 
> 时间：2012-09-03T17:29:18.330
> 
> 标签：database, sqlite, titanium

所以，出于某种原因，我的 sqlite 数据库有点问题。我正在尝试将我的数据库转储到可以在 Titanium 中使用的文件中。我知道该`.dump`命令，但是当我尝试使用 sqlite 网站上的说明时：

> 制作数据库存档副本的一个好方法是：
> 
> `$ echo '.dump' | sqlite3 ex1 | gzip -c >ex1.dump.gz`

并将其更改`ex1.dump.gz`为`ex1.sqlite.gz`，它会提供一个非常混乱的文件，它是无用的。如何转储我的数据库，以便我可以在我的 Titanium Studios 移动应用程序中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:38:07.613

当您可以简单地复制数据库文件时，为什么要转储它，即按原样使用它？

正如[这里](http://www.sqlite.org/onefile.html)所解释的，sqlite 数据库是跨平台的：

> SQLite 中的数据库是单个磁盘文件。此外，文件格式是跨平台的。在一台机器上创建的数据库可以复制并在具有不同架构的不同机器上使用。SQLite 数据库可跨 32 位和 64 位机器以及在大端和小端架构之间移植。

另一方面，您应该能够像这样转储、压缩您的数据库：

```
echo '.dump' | sqlite3 foo.db | gzip -c > foo.dump.gz 
```

并将其还原到新的 SQLite 数据库中：

```
gunzip -c foo.dump.gz | sqlite3 foo.new.db 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:18:53.797

`.dump`将数据库的内容导出为一系列插入语句。如果你在没有`gzip`命令的情况下运行它，你会看到纯文本 sql：

```
$ echo '.dump' | sqlite3 ex1 
```

但是您不需要这样做就可以在 Titanium Studios 中使用 SQLite 数据库。它原生支持 SQLite。只需将数据库文件复制到您的项目目录，然后使用如下代码打开它：

```
var db = Ti.Database.install('../products.sqlite','products');  

var rows = db.execute('SELECT DISTINCT category FROM products'); 
```

更多细节在这里：

[http://mobile.tutsplus.com/tutorials/appcelerator/titanium-mobile-database-driven-tables-with-sqlite/](http://mobile.tutsplus.com/tutorials/appcelerator/titanium-mobile-database-driven-tables-with-sqlite/)

# c# - 检测桌面上的按键

> ID：12251999
> 
> 赞同：1
> 
> 时间：2012-09-03T17:29:38.280
> 
> 标签：c#, winforms

我想知道如何检测按下了哪个键（例如在桌面或我的计算机上）。当检测到按下的键时显示它`MessageBox`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:34:50.500

检测应用程序外部的按键需要安装[低级键盘挂钩](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632589%28v=vs.85%29.aspx)。这是[演示该过程的 CodeProject 文章](http://www.codeproject.com/Articles/19004/A-Simple-C-Global-Low-Level-Keyboard-Hook)。