# StackOverflow 问答 11905000-11905999

# extjs - 网格中的数据渲染

> ID：11905001
> 
> 赞同：0
> 
> 时间：2012-08-10T15:40:52.467
> 
> 标签：extjs

我正在使用 ExtJs 开发应用程序，但遇到了问题。我有一个网格，它有 2 列（日期 1，日期 2），但是当我插入数据时，日期 1 和日期 2 会正常自动出现在网格中，但是当我刷新页面时，所有日期都会出现：'31/ 12/1969'，时间戳正确返回（1346284800000），任何人都可以提供见解吗？

```
{
    header: 'Date 1',
    dataIndex: 'date1',
    flex : 0.3,
    renderer : function(value, cell, model, index) {
        data = new Date();
        data.setTime(value); 
        return Ext.util.Format.date(data, 'd/m/Y');
    }
}, {
    header: 'Date 2',
    dataIndex: 'date2',
    flex : 0.3,
    renderer : function(value, cell, model, index) {
        data = new Date();
        data.setTime(value);
        return Ext.util.Format.date(data, 'd/m/Y');
    }
}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:37:18.403

如果我正确理解了您的问题，那么您正在尝试在网格中显示 Unix 时间戳。试试这个渲染器：

```
renderer: function(value) {
    var date = Ext.Date.parse(value, 'U');

    return Ext.Date.format(date, 'd/m/Y');
} 
```

# android - 如何在 Eclipse 中克服 android 模拟器中的 Socket 异常？

> ID：11905002
> 
> 赞同：0
> 
> 时间：2012-08-10T15:40:59.457
> 
> 标签：android, eclipse, android-emulator

在eclipse中通过maven运行测试用例（使用Robotium）时，我经常遇到下面提到的错误。

```
05-24 19:03:39.112 D/dalvikvm(  441): GC_CONCURRENT freed 2038K, 50% free 8431K/16775K, external 18832K/20738K, paused 9ms+8ms
05-24 19:03:40.032 I/System.out(  441): successtrue
05-24 19:03:40.212 D/dalvikvm(  441): GC_CONCURRENT freed 2091K, 51% free 8387K/16775K, external 18832K/20738K, paused 7ms+8ms
05-24 19:06:07.962 D/SntpClient(   77): request time failed: java.net.SocketException: Address family not supported by protocol
05-24 19:11:07.972 D/SntpClient(   77): request time failed: java.net.SocketException: Address family not supported by protocol
05-24 19:16:07.982 D/SntpClient(   77): request time failed: java.net.SocketException: Address family not supported by protocol 
```

**我查看了不同的博客，人们提到了不同的原因。有人对错误有任何正当理由吗？**

代码以创建和关闭连接的方式设计。此外，即使我不执行网络操作，我也遇到了这个问题。

# ios - SKPaymentTransactionStateRestored 在恢复时未调用非定期订阅

> ID：11905006
> 
> 赞同：0
> 
> 时间：2012-08-10T15:41:16.913
> 
> 标签：ios, testing, in-app-purchase, storekit

我在沙盒中有一个问题，没有事务状态 SKPaymentTransactionStateRestored 的交易被传递到

```
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions 
```

在接到电话后

```
[[SKPaymentQueue defaultQueue] restoreCompletedTransactions]; 
```

事实上，它根本没有被调用。

只有正常恢复完整方法

```
- (void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue 
```

被调用并且 queue.transactions.count 也是 0（这很有意义，因为没有传递任何事务）。

我在itunes connect中创建了我们的测试用户和非我们的测试用户，但没有成功。

我的应用内购买是一个月的非经常性订阅。

我尝试了不同的设备，并在 iTunes Connect 中创建了新的应用内购买，但无济于事。

如果我重新购买应用内购买，我会收到一条警告，说我已经购买了预期且有意义的订阅。

Base SDK 设置为 5.1，IOS 部署目标设置为 5.0。

我认为它是一个沙盒问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:14:07.650

在进行更多研究时，我发现 Apple 不会恢复非经常性订阅应用内购买。你必须自己这样做。这可以通过创建您自己的订阅服务器来完成。

# linux - 执行命令（从变量）然后显示正确的 pid？

> ID：11905012
> 
> 赞同：0
> 
> 时间：2012-08-10T15:41:34.870
> 
> 标签：linux, bash, unix

我有一个 bash 脚本，我想做这样的事情：

```
_command="zcat database.sql.gz | mysql database"

eval "($_command) & echo $!" 
```

我想从 bash 脚本在后台运行命令（存储在变量中），然后`pid`为该应用程序返回正确的命令。

如上所述，它当前返回`pid`bash 脚本的...

有人知道如何进行这项工作吗？

编辑：

如果我这样说；如果你想这样做，你会怎么做？

我真正想做的就是写这个：

($_command) & 回显 $! - 但后来我得到一个错误，说明 gzip 不理解命令“-u”，不知何故 gzip 认为 mysql 命令属于它。奇怪的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:36:48.347

```
eval "($_command) & echo $!" 
```

`$!`*在运行之前* 正在扩展`eval`。尝试转义它，例如`"\$!"`or `'$!'`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T11:57:33.743

这就是我想出的实际可行的方法：

```
 _command="zcat dump.sql.gz | mysql database"

    function run {

            $1="($1)"

            `eval $_command` & echo $!
    }   

    run $_command 
```

感谢所有花时间尝试帮助我的好人！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:03:19.297

你试过这个吗？

```
eval "($_command) & echo $$" 
```

# c# - 如何从当前应用程序创建 DLL

> ID：11905013
> 
> 赞同：2
> 
> 时间：2012-08-10T15:41:36.167
> 
> 标签：c#, class, dll

我正在尝试为我的项目（这是一个应用程序）中的许多类文件之一创建一个 dll，以便其他编程语言可以使用它。我无法将其与项目的其余部分隔离开来，因为它依赖于它的某些部分。我的问题是如何将这个 cs 文件连同所有必要的命名空间一起编译成一个 DLL，包括我在顶部说的“使用”？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T15:44:50.813

如果您有一段代码在许多不同的应用程序中使用，您应该将它移到一个单独的程序集中。创建一个新项目（文件 -> 新项目 -> 类库）并将该代码放在那里。然后，您可以从您需要的任何其他解决方案中引用该 DLL。

您还可以将项目添加到正在进行的解决方案中并执行相同的操作（右键单击解决方案 -> 添加 -> 新建项目 -> 类库）。然后只需引用项目本身（右键单击引用 -> 解决方案 -> 选择项目）。确切的菜单选择在 VS2010 和 2012 之间略有不同，但我想你明白了。

[这种在不复制代码的情况下重用代码的行为是DRY 编码](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的基本做法之一——永远不要复制和粘贴代码。始终重构，以便您可以在两个完全不同的地方引用同一段代码。如果你不采用这种技术，你最终会得到两个不同版本的“相同”代码，这是维护的噩梦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:46:04.397

您可以创建一个[类库](http://msdn.microsoft.com/en-us/library/d11h6832(v=vs.71).aspx)，当您“调试”时会`.dll`为您创建文件。按照[这里](http://www.homeandlearn.co.uk/csharp/csharp_s16p1.html)的教程学习如何制作一个。如果它已经在您的项目中，请转到

> 您的解决方案 -> 添加项目 -> 新建 -> 并选择“类库”
> 
> 然后在您的项目中转到资源-> 添加-> 项目-> 您的类库名称
> 
> 或者
> 
> 资源 -> 添加 -> 浏览 -> 您的类库位置

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T15:51:51.700

如果你想使用 csc.exe，如果你可以按照这个例子进行操作，请确保用你自己的 .cs 文件名替换名称我还将在下面包含一个链接，供 MSDN 解释如何使用 csc.exe[使用 csc.exe 进行命令行构建](http://msdn.microsoft.com/en-us/library/78f4aasd.aspx)

```
csc /t:library source.cs  -> source.dll 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T16:16:16.027

**第1步** 右键单击解决方案->添加->新建项目->命名->添加。

**第 2 步** 在按住 shift 的同时将要移动的 cs 文件拖到新项目中。这将移动它而不在原始项目中留下副本

**步骤 3** 在原始程序集中右键单击引用 -> 添加引用 -> 从项目选项卡中选择新添加的项目。

**第 4 步** 当您要访问移动的程序集时，请转到页面顶部并编写 using，后跟通用程序集的命名空间。

尝试在多个应用程序中重用代码是一个好主意。按照这些步骤构建应用程序后，新添加的项目将编译为单独的 dll。但是，如果它依赖于原始项目中的代码，您仍然无法在其他应用程序中使用该 dll。如果您打算重用一段代码，最好提前计划并以尽可能通用的方式编写它。尝试将您的应用程序特定逻辑放在一个程序集 (project/dll) 中，将通用逻辑放在第二个程序集 (project/dll) 中，然后通过引用项目并在您想要的文件顶部添加 using 语句让它们进行通信从中访问 dll。

# datagrid - 如何重新填充 Dojo DataGrid？

> ID：11905016
> 
> 赞同：0
> 
> 时间：2012-08-10T15:41:50.983
> 
> 标签：datagrid, dojo, dojox.grid

我有一个显示搜索信息的 DataGrid，当我点击搜索按钮时，它会创建并附加到我的结果窗格 div 中。问题是，当我再次点击搜索时，第一个仍然存在，所以一个新的网格被附加并且它最终不会出现，因为第一个正在填充 div。有没有办法获取对原始窗格的引用、重置商店并刷新它？由于搜索功能结束并且变量超出范围，因此我失去了对该对象的引用。Dojo 是否使用全局变量，如果使用，我该如何设置这些变量，或者是否有不同的方法？

谢谢

代码：

```
function loadAdvancedSearchResultsTable( ) {
            console.debug("inside loadAdvancedSearchResultsTable()");
            // See: http://dojo-toolkit.33424.n3.nabble.com/Dojo-dijit-form-Form-form-submit-on-keyboard-enter-td3359280.html
            var name = dijit.byId('search_name').get("value");
            var callingNumber = dijit.byId("search_callingnumber").get("value");
            var calledNumber = dijit.byId('search_callednumber').get("value");
            var durationBetweenStart = dijit.byId('search_durationbetween_start').get("value");
            var durationBetweenEnd = dijit.byId('search_durationbetween_end').get("value");
            var dateStart = dijit.byId('search_datebetween_start').get("value");
            var dateEnd = dijit.byId('search_datebetween_end').get("value");

            //var executeSearchPhpLink = "modules/content_panes/searchresults.php?";
            var executeSearchPhpLink = "modules/data_store/search_results_datastore.php?";
            var executeSearchPhpLinkHasElement = false;

            if(name != "") {
                executeSearchPhpLink += "name=" + name;
                executeSearchPhpLinkHasElement = true;
            }

            if(callingNumber != "") {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "callingNumber=" + callingNumber;
                executeSearchPhpLinkHasElement = true;
            }

            if(calledNumber != "") {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "calledNumber=" + calledNumber;
                executeSearchPhpLinkHasElement = true;
            }

            if(durationBetweenStart != "") {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "durationBetweenStart=" + durationBetweenStart;
                executeSearchPhpLinkHasElement = true;
            }

            if(durationBetweenEnd != "") {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "durationBetweenEnd=" + durationBetweenEnd;
                executeSearchPhpLinkHasElement = true;
            }

            if(dateStart != null) {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "dateStart=" + dateStart;
                executeSearchPhpLinkHasElement = true;
            }

            if(dateEnd != null) {
                if(executeSearchPhpLinkHasElement == true) {
                    executeSearchPhpLink += "&";
                }
                executeSearchPhpLink += "dateEnd=" + dateEnd;
                executeSearchPhpLinkHasElement = true;
            } 

            console.debug("About to set the content pane href to " + executeSearchPhpLink);

            // Create the data store to be used
            var searchResultsStore = new dojo.data.ItemFileReadStore({url: executeSearchPhpLink});

            // Set the layout structure
            var gridStructure = [
                { field: 'user', name:'Name', width:'15%' },
                { field: 'dn', name:'Calling Number', width:'15%' },
                { field: 'origcalledparty', name:'Called Number', width:'15%' },
                { field: 'callstarttime', name:'Start Time', width:'10%' },
                { field: 'callendtime', name:'End Time', width:'10%' },
                { field: 'duration', name:'Duration', width:'10%' },
                { field: 'datetime', name:'Date', width:'25%' }
            ];

            // Construct the data grid
            var searchResultsDataGrid = new dojox.grid.DataGrid({
                store: searchResultsStore,
                clientSort: true,
                rowSelector: true,
                structure: gridStructure
            },document.createElement('div'));

            // Append the new grid to the search results content pane
            dojo.byId("searchResultsContentPane").appendChild(searchResultsDataGrid.domNode);

            // Call startup to render the grid
            searchResultsDataGrid.startup();

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T14:19:57.123

使用关键字 var 在函数外部定义 searchResultsStore 和 searchResultsDataGrid 变量，并在没有关键字的函数中全局使用它们：

```
var searchResultsDataGrid = null; 
function abc() {
   searchResultsDataGrid = new Abc(...); 
} 
```

如果这没有帮助，您可以使用 dojo.empty() 或 destroyDescendants() 显式清空 ResultDiv。

希望我能帮上忙。

# jquery - 跨 Rails 应用程序打破 jQuery 的高图表

> ID：11905020
> 
> 赞同：1
> 
> 时间：2012-08-10T15:42:05.617
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, highcharts

我的 static_pages.js.coffee 文件中有以下代码，它运行良好，除了在我的网站上加载任何其他页面时，此代码运行并查找 .orders-chart。如果页面上没有该 div，High Charts 会引发错误并破坏我所有的其他 jQuery。

```
jQuery ->
$ ->
  new Highcharts.Chart
    chart: 
      renderTo: "orders-chart"
    title:
      text: "Orders by Day"
    xAxis:
      type: "datetime"
    yAxis:
      title:
        text: "Some Measurable"
    series: [
      pointInterval: 24 * 3600 * 1000
      data: [1, 2, 3, 5, 7]
    ] 
```

有没有办法在运行此代码之前检查 .orders-chart ？还是更好的做事方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T15:46:11.297

我不知道如何为您的 Ruby 实现编写此代码，但在普通的 jQuery 代码中，要检查是否存在可以使用长度的元素：

```
if ($(".orders-chart").length) {
    // .orders-chart exists, do stuff...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T18:16:51.003

我认为 highChart 寻找`#orders-chart`而不是`.orders-chart` 所以你需要有

```
 <div id="orders-chart" ></div> 
```

并不是

```
 <div class="orders-chart" ></div> 
```

要检查它是否存在，您可以使用

```
if ($("#orders-chart").length>0) {
   // Call chart constructor here
} 
```

小提琴@ [http://jsfiddle.net/jugal/bD487/](http://jsfiddle.net/jugal/bD487/)

# c++ - 为什么我不能在 C++ 中初始化静态字段

> ID：11905022
> 
> 赞同：9
> 
> 时间：2012-08-10T15:42:10.503
> 
> 标签：c++, static

> **可能重复：**
> [在 C++ 中定义静态成员](https://stackoverflow.com/questions/3536372/defining-static-members-in-c)

我在 C++ 上工作了一点，但我不明白如何在 C++ 中使用静态字段，它们似乎没用。请纠正我。

我不能这样做：

```
class AClass{
    public:
        static int static_field = 0;
}; 
```

这也不起作用

```
class AClass{
    public:
        static int static_field;
};

int main(){
    int AClass::static_field = 0;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-10T15:44:18.123

事实上，你很接近。

你应该移动： 在 CPP 文件中它是全局的，最好是在`int AClass::static_field = 0;`外部`main()``AClass.cpp.`

这样，您可以在标头中声明它并在源文件中对其进行初始化。设置好此声明/初始化后，您可以`main()`在其他地方或任何地方使用它。`AClass::static_field`

**PS：它们绝对不是没用的。**

这是一个很好的用例......假设您有内存泄漏，您需要跟踪它们。您在类中放置了一个静态计数器，因此该类的所有实例都共享它。然后，您可以使任何构造函数/析构函数递增和递减该计数器。因此，您可以打印计数器以显示存在多少个类实例以帮助查找泄漏。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-10T15:46:50.017

您必须在主函数范围之外初始化 static_field 。

```
int AClass::static_field = 0;
int main(){
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-10T15:48:05.063

试试这个：

```
class AClass{
    public:
        static int static_field;
};

int AClass::static_field = 0;

int main(){
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-10T15:53:34.697

当你在这里声明一个静态变量时，你是在声明这个变量的一个实例将在类的所有实例之间共享。

像提供的其他一些答案一样，将声明移到主函数之外是正确的解决方案。

下面是一些来自 msdn 的关于 static 关键字的文档：

[http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx](http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx)

希望这可以帮助

# javascript - 在网站上列出 localhost 计算机目录

> ID：11905023
> 
> 赞同：0
> 
> 时间：2012-08-10T15:42:13.450
> 
> 标签：javascript, file-io, file-management

如果我打开一个网站，我如何在该网站上查看我自己电脑上的内容？我在想 Javascript，但我该怎么做呢？这就像一个文件管理器。

示例：打开 example.com 并为我的计算机文件提供一个导航器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:48:01.063

出于安全原因，您不能通过 Javascript 从浏览器访问计算机的文件系统。

但是，要从字面上回答您的问题，您可以这样做（在您的控制台中）：

```
var input = document.createElement('input');
input.type = 'file';
document.body.appendChild(input); 
```

滚动到页面底部，您将看到一个文件输入字段。

这将允许您从网页浏览计算机的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:51:02.233

您是否希望访问（可能）任何站点的客户端/访问者的文件系统？
这是不可能的，否则将是一个巨大的安全漏洞。
如果你能做到，其他人也能做到。想象一下，您自己在某个地方访问了某个不起眼的网站（甚至可能在弹出窗口中），然后几个月后发现您在计算机上拥有的所有个人信息都可以出售。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T16:57:39.947

这是我的理解

1.  您运行 example.com 并希望向公众展示您的文件系统

    *   简单的。使用一些奇怪的文档根运行 apache/nginx 并将所有文件放在那里。
    *   [检查] 不确定是否可以使用 / 作为文档根目录运行 apache/nginx。
2.  您运行 example.com 并想向自己展示访问者文件系统

    *   这将是一个重大的安全问题。JS不能以任何方式做到这一点。

# plugins - 如何创建执行来自 cms_plugin 的命令的 django-cms 页面？

> ID：11905027
> 
> 赞同：0
> 
> 时间：2012-08-10T15:42:27.233
> 
> 标签：plugins, content-management-system, backend, django-cms

这个想法是，您必须从插件中提供名称和链接，然后插件将创建一个以标题为名称的新页面，设置已发布 = true，选择默认模板并将其他字段留空。

我找到的最接近的信息在[https://gist.github.com/894776](https://gist.github.com/894776)但我没有得到这条线

> > from gamesradar.apps.cms_override.api import create_page, add_plugin 哪里来的？

另外，如果有最简单的方法可以做到这一点，我们也欢迎。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:59:06.780

从 django CMS 2.2 开始，有一个 Python API 可以创建 CMS 对象（页面、标题、插件）。

有关文档，请参阅[http://docs.django-cms.org/en/2.3/extending_cms/api_references.html#cms-api](http://docs.django-cms.org/en/2.3/extending_cms/api_references.html#cms-api)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-05T17:24:20.510

```
from cms.api import create_page

data = {
    'title': 'HOME', 'template': 'home.html', 
    'language': 'en','reverse_id': 'home', 'published': True,
    'created_by': 'db-initialization'
}
create_page(**data) 
```

# cocoa-touch - 格式化一组 NSDecimalNumber 值

> ID：11905028
> 
> 赞同：1
> 
> 时间：2012-08-10T15:42:33.153
> 
> 标签：cocoa-touch, math, formatting, nsdecimalnumber

我正在开发一个应用程序，我需要获取几组数值（当前存储为`NSDecimalNumber`），并将它们显示在列中。每组的量级大致相同，但每组的量级可能会发生变化，我不会提前知道它们是什么。所以一个可能是 (1.23, 2.3, 1.567) 和另一个 (1234.1, 2345, 1999.4) 之类的值。

为了使列对齐，并知道我需要多少空间，我想做的是为每组数字计算出我需要的格式宽度。换句话说，整数位的最大数量和小数位的最大数量。对于上面的示例：第一种情况下为 1 和 3，第二种情况下为 4 和 1。

现在，[`NSDecimal`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/doc/uid/20000018-BAJEJDDJ)表示将通过结合尾数的长度和指数的值来直接回答这个问题。问题是，该结构的字段是明确私有的，并且似乎没有任何 API 可以从中获取尾数和指数的值。

一种解决方法可能是将每个数字转换为 POSIX 语言环境中的字符串，然后测量其长度和小数点的位置。但这似乎是一个很长的路要走。

我对我的 C 数学很粗略，但我猜有一些方法可以通过将我的小数转换为 a 来获取这些信息`double`，然后检查它（标准库函数或戳位）并做一些日志。我不知道究竟如何，或者我是否应该担心转换为有损表示。

是否有更直接和/或更有效的方式来获取这些信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:24:19.700

无论您使用哪种特定技术，如果您希望它完全自动化，您必须对所有数字进行某种事先迭代。您还将显示所有数字。因此，提前将它们全部转换为字符串并将这些字符串保存在并行数组中，这似乎不是世界上最糟糕的事情，您可以直接测量总长度。要处理小数点排列，在转换迭代期间计算最大和最小数字。这两个数字将为您提供整数部分的最大宽度。如果最小值为负数，请记住为减号分配空间。

# tabs - CSS Valign不同的文本行跨度

> ID：11905029
> 
> 赞同：0
> 
> 时间：2012-08-10T15:42:34.607
> 
> 标签：tabs, vertical-alignment, css, valign

我目前正在为我的网站页面设计一个选项卡式布局，并且我在不同选项卡中垂直对齐文本时遇到问题，因为其中一些跨越一行，一些跨越两行。我需要将文本放置在每个选项卡的中间，而不是让文本与第一行对齐。

到目前为止，我已经尝试过 Valign 和 Line-height ，但它们并不是很有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T15:46:53.790

如果您需要垂直和水平居中的文本，请使用：

```
text-align: center;
vertical-align: middle; 
```

`valign`是`td`元素的 HTML 属性，因此它可能不适用于您的“选项卡”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:51:57.727

使用 line-height ex) line-height:20px

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T15:52:47.547

您应该使用`vertical-align: middle`，但要意识到要应用它，您需要使用`display: table-cell`.

例如，如果您使用类似于以下 HTML 结构的内容：

```
<div class="container">
    <span>Some Text</span>
</div> 
```

然后，您可以使用以下方法获得所需的居中：

```
.container {
    text-align: center;
    display:table-cell; 
    vertical-align:middle
} 
```

这是一个[JSFiddle](http://jsfiddle.net/RkC5Z/)示例。

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:56:54.100

对此非常有帮助的阅读是[理解垂直对齐](http://phrogz.net/css/vertical-align/index.html)。

我假设您在这里谈论每个选项卡选择器上的标签。您可以使用该页面中的一种技巧，并将标签文本放在内部容器中，使其居中。

在我的脑海中，你有没有试过：
`line-height:100%;`？这可能会将行高设置为父级的高度，或者它可能会填满屏幕；没有把握。

# ruby-on-rails - 如何在搜索/过滤器中保留输入值

> ID：11905031
> 
> 赞同：2
> 
> 时间：2012-08-10T15:42:40.223
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我刚刚设法使我的索引操作上的过滤器功能正常工作。所以现在你可以使用：

```
myurl.com/questions?status=approved&description=blahblah 
```

我正在使用添加了一个简单表单的索引视图

```
<%= form_tag questions_path, :method => :get do %>
    <%= text_field_tag :description %>
    <%= select_tag :status, options_for_select(question_statuses), :include_blank => true %>
    <%= submit_tag "Search" %>
<% end %> 
```

但是，当应用了输入字段的过滤器重新显示页面时，选择标记显然不包含上次请求的值。我如何设法保留这些价值观？

我想在控制器操作中创建实例变量并在视图中使用它们来访问参数 [:status] 和参数 [:description]，但我不知道这是否是一个“毛茸茸”的解决方案？或者你只是在视图中直接使用参数？

*当前的解决方案是视图中的 params[:attribute]。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:19:36.260

您应该设置值，例如这样：

```
text_field_tag :description, params[:description] 
```

# python - python循环不加1

> ID：11905043
> 
> 赞同：1
> 
> 时间：2012-08-10T15:43:24.780
> 
> 标签：python

无论我尝试什么，“i”始终保持为“1”。每次转到文件夹中包含“1Chr”的下一个文件时，我都在尝试将“1”添加到“i”。

Python

```
for name in glob.glob('*.html'):
  i = 1
  with open(name) as k:
    content = k.read()
    if '1Chr.'+str(i)+'.' in name:
      book = name.split('.')[0].upper().rstrip()
      x=open('final/'+book+'.SFM', 'a')
      x.write(content)
      i += 1
      x.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T15:45:33.363

将`i = 1`上面的 for 循环。
对于每个新文件，您都将重置`i`为一个，因此它不能超过 2。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T15:46:47.160

将`i=1`上面的 for 循环：

```
i = 1
for name in glob.glob('*.html'):
  with open(name) as k:
    content = k.read()
    if '1Chr.'+str(i)+'.' in name:
      book = name.split('.')[0].upper().rstrip()
      x=open('final/'+book+'.SFM', 'a')
      x.write(content)
      i += 1
      x.close() 
```

或者更好的使用`enumerate()`，`enumerate()`会自动递增`i`：

```
for i,name in enumerate(glob.glob('*.html'),1): 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T15:47:55.537

您将在循环的每次迭代中重置`i`为。移动声明/初始化，使其位于循环之前：`1``for``i`

```
i = 1
for name in glob.glob('*.html'):
  with open(name) as k:
    content = k.read()
    if '1Chr.'+str(i)+'.' in name:
      book = name.split('.')[0].upper().rstrip()
      x=open('final/'+book+'.SFM', 'a')
      x.write(content)
      i += 1
      x.close() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T15:46:12.380

放在循环`i=1`之外。`for`您正在将其重置为`1`每次循环。

# wpf - 从 DataTemplate 更新绑定

> ID：11905049
> 
> 赞同：1
> 
> 时间：2012-08-10T15:43:41.027
> 
> 标签：wpf, binding, datatemplate

我有一个带有 DataGrid 的 WPF，我对行进行分组（在示例中按“名称”）。我有每个组的摘要行（“名称”和我在转换器中计算的总“金额”）。问题是我需要强制对摘要行进行绑定更新，但我无法在 DataTemplate 中访问它。

```
<DataGrid ItemsSource="{Binding Source={StaticResource posCurrencyOpen}}">
    <DataGrid.Columns>
        <DataGridTextColumn Header="Amount"  Binding="{Binding Amount, Converter {StaticResource Amount_Converter}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
    </DataGrid.Columns>
    <DataGrid.GroupStyle>
        <GroupStyle>
            <GroupStyle.HeaderTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <DataGridCell Content="{Binding Path=Name}"/>
                        <DataGridCell Content="{Binding Path=Items, Converter={StaticResource AmountGroup_Converter}, Mode=OneWay}"/>
                    </StackPanel>
                </DataTemplate>
            </GroupStyle.HeaderTemplate>
        </GroupStyle>
    </DataGrid.GroupStyle>
</DataGrid> 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:51:28.290

以下是我的处理方法：我有一个 Parent 对象，其中包含按日期分组的 Child 对象。每个孩子也有一个分配百分比属性（Pct）。我想按日期分组并显示 Pct 字段的小计，以便用户可以确保它们总计为 100%。我在每个子对象上插入了一个 TotalPct 属性，然后强制子对象为具有相同日期的所有子对象触发 PropertyChanged 事件。

```
 public partial class Child: INotifyPropertyChanged
    {

    public double TotalPct
    {
        get
        {
            double ttl = 0;
            if (Parent != null)
            {
                var peers = from d in Parent.Children where d.StartDate == StartDate select d;
                foreach (Child dtl in peers)
                {
                    ttl += dtl.Pct;
                }
            }
            return ttl;
        }
    }

    partial void OnPctChanged()
    {
        if (Parent != null)
        {
            var peers = from d in Parent.Children where d.StartDate == StartDate select d;
            foreach (Child dtl in peers)
            {
                NotifyPropertyChanged("TotalPct");
            }
        }
    } 
```

然后我的 GroupStyle 将标题绑定到 itemcollection 中第一个 Child 的 TotalPct 属性：

```
 <Style x:Key="GroupHeaderStyle" TargetType="{x:Type GroupItem}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type GroupItem}">
                    <cust:DataGrouper>
                        <cust:DataGrouper.Header>
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="{Binding Path=Name, StringFormat='MM/dd//yyyy'}"    
                                           Width="{Binding ElementName=detailsDataGrid, Path=Columns[0].ActualWidth}"/>
                                <TextBlock Text="" Width="{Binding ElementName=detailsDataGrid, Path=Columns[1].ActualWidth}" Margin="-20,0,0,0"/>
                                <TextBlock Text="" Width="{Binding ElementName=detailsDataGrid, Path=Columns[2].ActualWidth}" />
                                <TextBlock Text="{Binding Path=Items[0].TotalPct, Converter={StaticResource percentStringToDouble}, ConverterParameter=2}" HorizontalAlignment="Right"
                                           Width="{Binding ElementName=detailsDataGrid, Path=Columns[3].ActualWidth}"/>
                            </StackPanel>
                        </cust:DataGrouper.Header>
                        <ItemsPresenter />
                    </cust:DataGrouper>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T13:23:42.220

我认为您需要在您的 ICollectionView 对象上调用 Refresh() 。

# javascript - 基于屏幕的jQuery中心元素，而不是页面大小

> ID：11905050
> 
> 赞同：1
> 
> 时间：2012-08-10T15:43:44.400
> 
> 标签：javascript, jquery, zurb-foundation

[我有一个使用 Zurb 的Reveal Plugin](http://www.zurb.com/playground/reveal-modal-plugin)显示的元素，我对它如何定位模态窗口有疑问。

它似乎将元素定位在页面的中心，在折叠上方。但是，如果模态窗口由折叠下方的链接激活，则用户无法看到该窗口。有没有办法根据当前滚动位置而不是整个页面来居中元素？

据我所知，这是插件的相关源代码：

**变量集（ln 41）：**

```
var modal    = $(this),
topMeasure = parseInt(modal.css('top'), 10),                                                                                                
topOffset  = modal.height() + topMeasure,                                                                                                   
locked     = false,                                                                                                                         
modalBg    = $('.reveal-modal-bg'),                                                                                                         
closeButton; 
```

**动画 div (ln 61)**

```
 function openAnimation() {                                                                                                                    
    if (!locked) {                                                                                                                              
      lockModal();                                                                                                                              
      if (options.animation === "fadeAndPop") {                                                                                                 
        modal.css({                                                                                                                             
            'top': $(document).scrollTop() - topOffset,                                                                                         
            'opacity': 0,                                                                                                                       
            'visibility': 'visible'                                                                                                             
        });                                                                                                                                     
        modalBg.fadeIn(options.animationSpeed / 2);                                                                                             
        modal.delay(options.animationSpeed / 2).animate({                                                                                       
          "top": $(document).scrollTop() + topMeasure + 'px',                                                                                   
          "opacity": 1                                                                                                                          
        }, options.animationSpeed, function () {                                                                                                
          modal.trigger('reveal:opened');                                                                                                       
        });                                                                                                                                     

      }   
      //etc... 
```

[来自 GitHub 的完整源代码](https://raw.github.com/zurb/reveal/master/jquery.reveal.js)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:54:56.527

我遇到了同样的问题，我意识到我正在使用 href 链接中带有“#”的标签调用显示函数。

调用此方法会在调用显示函数之前重新加载页面，因此当按下显示按钮时，显示模态的屏幕位置会跳转到屏幕的坐标，从而导致模态屏幕出现在屏幕的一半之外。

从链接中删除此“#”可以解决问题...

希望有帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-15T20:12:06.903

我尝试了其余的答案并最终得到：

```
 .reveal-modal{
    position: fixed; 
 } 
```

似乎工作得很好，仍然可以按照我的意愿进行动画和行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:09:31.123

确保您的模式在页面的主要部分之外，而不是在对它们来说是不正确的相对父级的行或列内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T20:53:58.280

模态框本身的 div 是否在行/列 div 块中？

例子：

```
<div class="row">
  <div class="twelve columns">
    <div id="featured"><a href="" data-reveal-id="viewModal">View My Modal</a></div>
    <div id="viewModal" class="reveal-modal large">My Modal</div>
  </div>
</div> 
```

如果是这种情况，您描述的行为可能会发生。

从[文档](http://foundation.zurb.com/docs/reveal.php)中：

> **请记住**：您的模式应该在页面的末尾，在您的任何行或列之后。

下面的代码可以正常工作：

```
<div class="row">
  <div class="twelve columns">
    <div id="featured"><a href="" data-reveal-id="viewModal">View My Modal</a></div>
  </div>
</div>

<div id="viewModal" class="reveal-modal large">My Modal</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-04T13:05:11.403

我编写了一个简单的脚本，在页面加载时触发并查找所有显示模式，然后将它们移动到标签之前的空目标 div。通过这种方式，我可以将所有模式保留在我希望它们出现的任何位置，以便标记分离或让其他人更容易遵循/工作。

# php - 如何从 MySQL 表中删除重复项？

> ID：11905054
> 
> 赞同：3
> 
> 时间：2012-08-10T15:43:58.770
> 
> 标签：php, mysql, sql, database

> **可能重复：**
> [仅使用 MySQL 查询删除重复项？](https://stackoverflow.com/questions/3383898/remove-duplicates-using-only-a-mysql-query)

我有一个包含不同页面的表格，但其中一些是重复的。确定重复的唯一方法是通过标题。我运行下面的代码，它运行良好：

```
<?php

mysql_connect("localhost", "root", "root") or die(mysql_error());
mysql_select_db("old") or die(mysql_error());
$result = mysql_query("SELECT pagetitle, COUNT( * ) c
FROM cms_site_content
GROUP BY pagetitle
HAVING c >1") or die(mysql_error());  
while($row = mysql_fetch_array($result)){
    echo $row['id'].'-'.$row['pagetitle'].'<br />';
}

?> 
```

我的问题是：如何删除重复项并只保留一个条目。例如，如果我有一篇名为“重复文章”的文章，结果是

> 重复文章：3

我只想保留一个。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T15:47:10.440

您需要`INNER JOIN`在表本身上删除`pagetitle`值相同但`primary key`（我使用 ID 作为标识符）不是的位置。

尝试：

```
DELETE c2 FROM `cms_site_content` c1 INNER JOIN
               `cms_site_content` c2
          ON c1.pagetitle = c2.pagetitle AND c1.ID <> c2.ID 
```

**参考**：[http ://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:47:19.440

选择所有单行，将它们插入临时表，删除所有记录，从临时表中插入它们

使用一些应用程序逻辑：从每个多行中只选择一个，从表中删除所有，然后插入单个的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:32:20.437

这条线醒了：

```
DELETE t2
FROM cms_site_content t1
JOIN cms_site_content t2 ON (t2.pagetitle = t1.pagetitle AND t2.id > t1.id); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:51:02.600

试试这个：SELECT DISTINCT pagetitle, id, FROM cms_site_content

使用上述 SQL 中的 PHP 将所有 id 保存到 idlist 中，然后执行：

从 cms_site_content 中删除 id 不在 ($idlist)

您需要将上述 SQL 语句转换为 PHP/MySQL 代码。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-08-10T15:49:32.530

尝试这个

```
DELETE t1 FROM table t1, table t2 WHERE t1.id > t2.id AND t1.name = t2.name 
```

# string - 计算字符串中字符的出现次数（Haskell）

> ID：11905057
> 
> 赞同：1
> 
> 时间：2012-08-10T15:44:12.003
> 
> 标签：string, haskell

> **可能重复：**
> [如何在 Haskell 中查找字符串中字符的频率？](https://stackoverflow.com/questions/7108559/how-to-find-the-frequency-of-characters-in-a-string-in-haskell)

给定一个输入字符串，我希望计算每个字符的出现次数。我有两种方法（在帝国伪代码中）：

```
For each character in the "alphabet"
  traverse the string and increment a counter when the character is found 
```

我相信我可以很容易地在 Haskell 中实现这一点。我的第二个想法有点棘手：

```
For each character in the string
  increment a counter and store it in a map (or similar data structure) 
```

我对 Haskell 中的数据结构几乎没有经验，所以第二个解决方案比第一个更令人生畏。但是，我当然想通过实现我自己的数据结构或使用内置库中的某些东西来了解更多信息。

有人对我应该如何进行有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T15:48:29.627

`Data.Map`是关联数组的标准。我认为它在`containers`包装中并且有很好的文档记录。该`insertWith`函数可能对这个问题特别感兴趣 - 它允许您插入一个新的键和值，但还提供一个函数（您可能想要使用`+`）将值与映射中已有的值（如果有）组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T18:36:56.543

在 Haskell 中，`=`符号就像在数学中一样用于定义*方程*。惯用的 Haskell 避免突变（例如“增加一个计数器”），而是鼓励使用纯函数的解决方案。但是，`ST`您可以使用变异来编写算法，就像使用任何其他语言一样。

考虑确定单个字符在字符串中出现多少次的任务。根据你的英文描述

> 遍历字符串并在找到字符时增加一个计数器

Python实现将是

```
def count(c, s):
  i = 0
  for c0 in s:
    if c == c0:
      i += 1
  return i 
```

使用 ST 我们可以编写完全相同的代码，尽管它稍微冗长一些，因为所有可变变量的创建、读取和写入都被显式命名：

```
import Control.Monad (when, forM_)
import Control.Monad.ST (runST)
import Data.STRef

count :: Char -> String -> Int
count c s = runST $ do     -- def count(c, s):
  i <- newSTRef 0          --   i = 0
  forM_ s $ \c' -> do      --   for c0 in s:
    when (c == c') $ do    --     if c == c0:
      modifySTRef i (+1)   --       i += 1
  readSTRef i              --   return i 
```

正如我之前所说，这不是惯用的 Haskell，但是当您已经考虑到使用突变的命令式算法时，我认为没有理由避开 ST。由于突变是针对函数的，并且从外部无法观察到，我们可以使用它`runST`来隐藏实现细节并呈现一个纯接口`Char -> String -> Int`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T15:51:33.217

我建议：

*   阅读[折叠](http://www.haskell.org/haskellwiki/Fold)。折叠是处理列表的函数式编程中非常常见的模式。

*   浏览一些[Haskell 库](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html)（警告：它们很广泛，需要一段时间才能理解——但绝对值得付出努力）。像您这样的问题的解决方案通常可以通过将一些预定义的函数（例如，排序/分组/映射/长度）粘合在一起来找到。本练习让您更熟悉库、Haskell 语法和编码风格、FP 以及通过组合解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:52:19.893

我认为 Haskell prelude 中可能有一个函数用于此（查找`(Eq a, Integral i) => [a] -> a -> i`），但这可以很容易地表示为折叠

```
count a = foldr (\x sum -> if x == a then sum+1 else sum) 0 
```

[http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:foldr](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:foldr)

至于地图，请查看 Data.Map 模块。（也很容易编写一个简单的基于列表的地图）

# asp.net-mvc - 如何将 //@sourceUrl 包含到 ASP.Net MVC Razor 页面中

> ID：11905059
> 
> 赞同：0
> 
> 时间：2012-08-10T15:44:16.133
> 
> 标签：asp.net-mvc, razor

我需要在我的页面中包含以下内容

```
//@@ sourceUrl=MoveReservation.js 
(which should be become //@ sourceUrl=MoveReservation.js) 
```

问题是这会被 Razor 引擎用引号括起来。我尝试使用 @: 但没有用，也没有`<text></text>`。

那么我如何将这样的内容放入页面中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T15:46:14.680

除非另有说明，否则 Razor 视图引擎将对它输出的任何文本进行 HTML 编码。

您可以使用@ [Html.Raw](http://msdn.microsoft.com/en-us/library/gg480740%28v=vs.98%29.aspx)来输出一个字符串，而无需对其进行 HTML 编码

> 返回非 HTML 编码的标记。

```
@Html.Raw("//@ sourceUrl=MoveReservation.js"); 
```

# ruby - 在 Rubygems gemspec 中标记为可执行的 Ocra 和脚本

> ID：11905065
> 
> 赞同：2
> 
> 时间：2012-08-10T15:44:47.103
> 
> 标签：ruby, windows, rubygems, load-path, ocra

我创建了一个 gem，它公开了一个在 Linux 下工作的可执行文件。在 Windows 中，如果我导航到安装 gem 的目录，我可以从命令行运行它，但我必须`-Ilib`在调用`ruby`.

我想使用 Ocra 将可执行文件 + 依赖项（gem 的其余部分）+ Ruby 转换为其他用户的 exe 文件，但文档似乎说手动弄乱加载路径对 Ocra 来说是个坏主意。

我如何告诉 Ocra 使用 gem 的可执行脚本而不自己弄乱 Ruby 的加载路径？我想这将取决于我可以通过某种方式运行可执行脚本，该脚本利用它们是已安装 gem 的一部分并为我找出依赖关系这一事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T08:25:35.447

我的问题被证明需要一个两部分的答案：

1.  关于 Rugbygems 如何在 Windows 中打包可执行文件的潜在无知：它将它们放在 ruby​​ 安装目录的 bin/ 目录中，该目录是在安装 Ruby 时添加到路径中的。脚本本身是不可执行的，但 Rubygems`.bat`为每个可执行文件创建了一个文件包装器，例如，用于从命令提示符的任何位置运行`mygem.rb`的随附文件。`mygem.rb.bat`

2.  因此，可以使用以下命令运行 ocra 脚本：`ocra path/to/Ruby/bin/mygem.rb`.

请注意，如果您将某种服务器作为可执行文件的一部分启动，它可能会在您运行 ocra 时运行，并且永远不要继续创建可执行文件。因此有必要在启动服务器之前检查 ocra 是否正在运行：

```
 if not defined? Ocra
  #do server startup stuff here
end 
```

事实上，我最终创建了一个包含`if not defined?`代码的“安装程序”脚本，以免弄乱我可能想要用于其他目的的可执行脚本。

# python - 如何在硒中全屏（ChromeDriver）

> ID：11905066
> 
> 赞同：3
> 
> 时间：2012-08-10T15:44:48.430
> 
> 标签：python, selenium, selenium-chromedriver

我试图让我的测试窗口全屏显示，但我尝试过的所有命令都失败了。这包括尝试输入 ASCII 键盘代码，而且我查看了所有 selenium 命令，发现没有任何相关但似乎无法让浏览器进入全屏状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:25:12.403

看起来它还没有在 ChromeDriver 中实现。这是该问题的链接。

[http://code.google.com/p/chromedriver/issues/detail?id=67](http://code.google.com/p/chromedriver/issues/detail?id=67)

# python - 如何在运行程序和请求数据时使用 Python 保持登录到网站？

> ID：11905071
> 
> 赞同：1
> 
> 时间：2012-08-10T15:45:26.163
> 
> 标签：python, cookies, urllib2

我找到了一种使用 Python 保持登录网站的方法。问题是每隔一段时间，我就会断开连接并注销。我猜会话正在超时，但我不知道如何解决它。

我使用了 Firefox 的 Live HTTP Headers 附加组件，并将登录请求中的标头复制到我的程序中。

```
import urllib
import urllib2
import cookielib

data = urllib.urlencode({"inUserName":"MY EMAIL", "inUserPass":"MY PASSWORD"})
jar = cookielib.FileCookieJar("cookies")
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(jar))
opener.addheaders.append(('User-agent', 'Mozilla/5.0'))
opener.addheaders.append(('Referer', 'http://www.locationary.com/'))
opener.addheaders.append(('Cookie','site_version=REGULAR; __utma=47547066.601656247.1344371114.1344602507.1344606239.16; __utmz=47547066.1344371114.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); nickname=jacob501; jforumUserId=1; locaCountry=1227; locaState=null; locaCity=Atlanta; PSESSIONID=533e2fb9fda008d5d16bfbdc9b9a6afed0e5ac54; Locacookie=enable; sortOrder=1; JSESSIONID=DE58AC8BC78D1DF20BF338E195336E58; __utmc=47547066; __utmb=47547066.6.10.1344606239'))
request = urllib2.Request("https://www.locationary.com/index.jsp?ACTION_TOKEN=tile_loginBar_jsp$JspView$LoginAction", data)
response = opener.open(request)
page = opener.open(url).read()
soup = BeautifulSoup(page) 
```

我用`cookielib`和`urrlib`/ `urllib2`。真正使它起作用的 cookie 是很长的，但我真的不知道这一切意味着什么，我只是从附加组件中复制了它。如果我的连接中断，我会转到我的浏览器并再次登录并从插件中获取一个新的 cookie。就像我之前说的，我猜它与 session 或 sessionid 或其他东西有关，但我不知道如何才能让我始终登录。

谢谢。

### 编辑

有人可以告诉我为什么这是一个坏问题还是我只是愚蠢？-1为了什么？

### 编辑 2

好的！如果我不**保持**登录状态，那么有没有办法让我的连接/cookie 不工作？

### 编辑 3

除了自己去 Firefox 插件外，我不知道如何**获得新的 cookie ……哈哈**

### 编辑 4

好的。我做了一个新的测试程序：

```
import urllib
import urllib2
import cookielib
import re

url = 'http://www.locationary.com/home/index2.jsp'

data = urllib.urlencode({"inUserName":"email", "inUserPass":"password"})
jar = cookielib.FileCookieJar("cookies")
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(jar))
opener.addheaders.append(('User-agent', 'Mozilla/5.0 (Windows NT 6.1; rv:13.0) Gecko/20100101 Firefox/13.0.1'))
opener.addheaders.append(('Referer', 'http://www.locationary.com/'))
opener.addheaders.append(('Cookie','site_version=REGULAR; __utma=47547066.601656247.1344371114.1344612897.1344615635.18; __utmz=47547066.1344371114.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); nickname=jacob501; jforumUserId=1; locaCountry=1227; locaState=null; locaCity=Atlanta; PSESSIONID=533e2fb9fda008d5d16bfbdc9b9a6afed0e5ac54; Locacookie=enable; sortOrder=1; JSESSIONID=781FD0C497FB596954BB78B1323215F6; __utmc=47547066; __utmb=47547066.9.10.1344615635'))
request = urllib2.Request("https://www.locationary.com/index.jsp?ACTION_TOKEN=tile_loginBar_jsp$JspView$LoginAction", data)
response = opener.open(request)
page = opener.open(url).read()
print re.findall(r'<title>(.*)</title>', page)
h = response.info().headers
print h 
```

输出：

```
['Home Page']
['Server: nginx/1.0.8\r\n', 'Date: Fri, 10 Aug 2012 16:50:47 GMT\r\n', 'Content-Type: text/html;charset=UTF-8\r\n', 'Transfer-Encoding: chunked\r\n', 'Connection: close\r\n', 'P3P: CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"\r\n'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:36:02.277

您为什么不尝试使用该[`requests`](https://github.com/kennethreitz/requests)模块并看看是否有所作为？

看看[这里](http://pydanny.blogspot.com/2011/05/python-http-requests-for-humans.html)的例子；它非常易于使用，内置的 cookie jar 可能会有所帮助，如果只是为了防止您在 Python 的其他可悲的 HTTP 库中意外出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:13:03.580

您可以使用 selenium，使用 Firefox 保持登录到此网页。 [硒](http://seleniumhq.org/docs/05_selenium_rc.html)

```
from selenium import selenium

localport = 12345

## you create a socket proxy here listening on localport
## connecting to www.locationary.com:80

selenium = selenium("localhost", 4444, 
                    "*firefox", "http://localhost:%i" % localport)

while 1:
    # open the selenium side every 5 minutes
    selenium.open("/home/index2.jsp")
    selenium.wait_for_page_to_load("30000")
    time.sleep(5 * 60) # seconds 
```

要安装 selenium，您需要 python 包和 selenium 服务器 .jar 文件来启动它。

因为 firefox 通过您的程序登录，您可以解析有效会话 ID 的流量。

问题？

# spring - 配置 Spring Web Flow 演示应用程序以使用 JBoss 7 托管数据源

> ID：11905073
> 
> 赞同：1
> 
> 时间：2012-08-10T15:45:35.523
> 
> 标签：spring, jboss, jboss7.x, spring-webflow

我在 Jboss 7 服务器中配置了一个容器管理的数据源（“myDataSource”）。数据源似乎已正确部署（我从管理控制台检查了它）。
我构建并部署了 Spring 示例 webflow-primefaces-showcase 应用程序到 jboss，演示部署并正常工作。我想在演示中使用 jboss 数据源，但我无法让它工作。此时我没有任何可以访问数据库的支持代码，我只想正确配置数据源。

我为 oracle 驱动程序添加了对 pom.xml 的依赖项

```
<dependency>
<groupId>com.oracle</groupId>
<artifactId>ojdbc6</artifactId>
<version>11.1.0.7.0</version>
</dependency> 
```

我创建了 META-INF/persistence.xml

```
<persistence-unit name="myDataSource-emf" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>java:/myDataSource</jta-data-source>
      <properties>
         <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect"/>
         <property name="hibernate.hbm2ddl.auto" value="validate"/>
         <property name="hibernate.show_sql" value="true"/>
         <property name="hibernate.format_sql" value="true"/> 
         <property name="hibernate.use_sql_comments" value="true"/>
         <property name="hibernate.default_schema" value="schemaUserName"/>
      </properties>
   </persistence-unit> 
```

将此添加到 web.xml：

```
 <persistence-unit-ref>
  <persistence-unit-ref-name>persistence/myDataSource-emf</persistence-unit-ref-name>
  <persistence-unit-name>myDataSource-emf</persistence-unit-name>
 </persistence-unit-ref> 
```

当我现在部署时，我得到：

```
 "JBAS014771: Services with missing/unavailable dependencies" => 
    "jboss.persistenceunit.\"webflow-primefaces-showcase-1.0.0-BUILD-SNAPSHOT.war#myDataSource-emf\
    "jboss.naming.context.java.myDataSourceMissing
[jboss.persistenceunit.\"webflow-primefaces-showcase-1.0.0-BUILD-SNAPSHOT.war#myDataSource-emf\
    "jboss.naming.context.java.myDataSource]"]} 
```

我必须在某处添加 jndi 参考：

```
<jee:jndi-lookup id="entityManager" jndi-name="java:comp/env/persistence/myDataSource-emf" 
            expected-type="javax.persistence.EntityManager"/> 
```

但我不确定在哪里。我需要创建一个 ApplicationContext.xml 吗？我可以把它放在 rootContext.xml 中吗？

如何让这两个一起玩得很好？

我的配置：

*   JBoss 7.1
*   春天 3.1.2
*   Spring Web Flow 2.3.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T22:00:33.610

问题出在persistence.xml中，我更改了这一行：

```
<jta-data-source>java:/myDataSource</jta-data-source> 
```

至：

```
<jta-data-source>java:jboss/datasources/myDataSource</jta-data-source> 
```

我将 jndi 查找放在 servlet-context.xml 中：

```
<jee:jndi-lookup id="entityManagerFactory" jndi-name="java:comp/env/persistence/myDataSource-emf" 
            expected-type="javax.persistence.EntityManagerFactory"/> 
```

并编辑架构引用以添加 jndi 标记：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:faces="http://www.springframework.org/schema/faces"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/faces http://www.springframework.org/schema/faces/spring-faces.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd"> 
```

# asp.net-mvc - Microsoft JScript 运行时错误：“jQuery”未定义

> ID：11905075
> 
> 赞同：3
> 
> 时间：2012-08-10T15:45:59.363
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我是一个 ASP MVC 3 noobie，通过音乐商店教程[http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-5工作](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-5)

我已经成功添加了一个带有添加/编辑/删除操作的 StoreManager 控制器。控制器工作——我能够执行这些操作。但在中途，Visual Studio 显示弹出窗口显示“Microsoft JScript 运行时错误：'jQuery' 未定义”。我只是忽略了这些错误，一切都运行良好。

SO post [Updated JQuery - get Microsoft JScript runtime error: 'jQuery' is undefined](https://stackoverflow.com/questions/8981351/updated-jquery-get-microsoft-jscript-runtime-error-jquery-is-undefined)似乎暗示我的 packages.config 文件可能存在问题。我需要在此文件中修复什么以使此错误消失吗？如何确定 jQuery 已安装并正确连接到 MVC3/Visual Studio？我假设在使用 MVC 3 组件安装 SP1 时包含 jQuery。

这是我的 packages.config 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="jQuery" version="1.5.1" />
  <package id="jQuery.vsdoc" version="1.5.1" />
  <package id="jQuery.Validation" version="1.8.0" />
  <package id="jQuery.UI.Combined" version="1.8.11" />
  <package id="EntityFramework" version="4.1.10331.0" />
  <package id="Modernizr" version="1.7" />
</packages> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T15:54:55.423

这意味着您对 jQuery*.js 的脚本引用已损坏，当另一个脚本疲于调用 jQuery 时，将引发此错误。

通常在 _Layout.cshtml 中查看您的标记并找到`<script>`参考。应该有一个类似于`<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>`

如果您使用包管理器更新了 jQuery，则需要更新参考中的版本号。`"~/Scripts/jquery-<version>.min.js"`

1.  确保路径有效。
2.  确保它是引用的第一个脚本。
3.  使用 Chrome/IE/FireFox 调试工具进行测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-29T06:22:00.567

如果您有母版页，您能否检查是否在内容页中添加了任何其他 jQuery 引用？不应重复相同的 JQuery 引用。

# objective-c - 如何更改 UIDatePicker 的颜色？

> ID：11905078
> 
> 赞同：3
> 
> 时间：2012-08-10T15:46:00.407
> 
> 标签：objective-c, ios, uidatepicker

如果有人想知道如何更改 UIDatePicker 的背景颜色（实际微调器周围的部分），请参阅下面的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:46:26.307

要设置您想要的颜色，只需更改设置为您想要的任何颜色的`createCover`方法。`cover`

```
//CustomizableDatePicker.m

#import "CustomizableDatePicker.h"
#import <QuartzCore/QuartzCore.h>

#define TOP_HEIGHT 9.7f
#define BOTTOM_HEIGHT TOP_HEIGHT
#define DATE_AND_TIME_MODE_ACTUAL_PICKER_WIDTH 302.5f
#define DATE_MODE_ACTUAL_PICKER_WIDTH 280.0f
#define TIME_MODE_ACTUAL_PICKER_WIDTH 176.0f

@interface CustomizableDatePicker()
@property (nonatomic, weak) UIView *myLeftCover;
@property (nonatomic, weak) UIView *myRightCover;
@property (nonatomic, weak) UIView *myTopCover;
@property (nonatomic, weak) UIView *myBottomCover;
@end

@implementation CustomizableDatePicker
@synthesize myLeftCover = _myLeftCover, myRightCover = _myRightCover, myTopCover = _myTopCover, myBottomCover = _myBottomCover;

- (void) setDatePickerMode:(UIDatePickerMode)datePickerMode
{
    [super setDatePickerMode:datePickerMode];

    [self setNeedsLayout];
}

- (void) awakeFromNib
{
    [self addCoverViews];
    self.layer.cornerRadius = 10;
    self.clipsToBounds = YES;
    [self setNeedsLayout];
    [self setNeedsDisplay];
}

- (id) init
{
    if(self = [super init])
    {
        [self addCoverViews];
        self.layer.cornerRadius = 10;
        self.clipsToBounds = YES;
        [self setNeedsLayout];
        [self setNeedsDisplay];
    }

    return self;
}

/*
 * Creates, but does NOT set the frames of, the 4 covers
 */
- (void) addCoverViews
{
    UIView *left = [self createCover];
    self.myLeftCover = left;
    [self addSubview:left];

    UIView *right = [self createCover];
    self.myRightCover = right;
    [self addSubview:right];

    UIView *top = [self createCover];
    self.myTopCover = top;
    [self addSubview:top];

    UIView *bottom = [self createCover];
    self.myBottomCover = bottom;
    [self addSubview:bottom];
}

/*
 * Helper function to create one cover
 */
- (UIView *) createCover;
{
    UIView *cover = [[UIView alloc] init];
    cover.backgroundColor = [UIColor whiteColor];
    cover.alpha = .55;
    return cover;
}

- (void) layoutSubviews
{
    float pickerWidth;
    if(self.datePickerMode == UIDatePickerModeDateAndTime)
    {
        pickerWidth = DATE_AND_TIME_MODE_ACTUAL_PICKER_WIDTH;
    }
    else if(self.datePickerMode == UIDatePickerModeDate)
    {
        pickerWidth = DATE_MODE_ACTUAL_PICKER_WIDTH;
    }
    else if(self.datePickerMode == UIDatePickerModeTime)
    {
        pickerWidth = TIME_MODE_ACTUAL_PICKER_WIDTH;
    }
    // Set left frame
    {
        float xOrigin = 0;
        float yOrigin = TOP_HEIGHT;
        float width = (self.frame.size.width - pickerWidth) / 2;
        float height = self.frame.size.height - TOP_HEIGHT - BOTTOM_HEIGHT ;
        self.myLeftCover.frame = CGRectMake(xOrigin, yOrigin, width, height);
    }
    // Set top frame
    {
        float xOrigin = 0;
        float yOrigin = 0;
        float width = self.frame.size.width;
        float height = TOP_HEIGHT;
        self.myTopCover.frame = CGRectMake(xOrigin, yOrigin, width, height);
    }
    // Set right frame
    {
        float xOrigin = (self.frame.size.width - pickerWidth) / 2 + pickerWidth;
        float yOrigin = TOP_HEIGHT;
        float width = (self.frame.size.width - pickerWidth) / 2;
        float height = self.frame.size.height - TOP_HEIGHT - BOTTOM_HEIGHT ;
        self.myRightCover.frame = CGRectMake(xOrigin, yOrigin, width, height);
    }
    // Set bottom frame
    {
        float xOrigin = 0;
        float yOrigin = self.frame.size.height - BOTTOM_HEIGHT;
        float width = self.frame.size.width;
        float height = BOTTOM_HEIGHT;
        self.myBottomCover.frame = CGRectMake(xOrigin, yOrigin, width, height);
    }
}

@end

//CustomizableDatePicker.h
#import <UIKit/UIKit.h>

/*
 * Allows for changing the color of UIDatePickers...Pretty useful, huh? :)
 */
@interface CustomizableDatePicker : UIDatePicker

@end 
```

# php - php多维数组 - 提取键

> ID：11905081
> 
> 赞同：2
> 
> 时间：2012-08-10T15:46:10.440
> 
> 标签：php, arrays

我有一个多维数组，前两个代码语句工作正常...请注意下面...

```
 echo $arrayObjects['name'].'<br>';
      echo $arrayObjects['ipv4']['10.14.2.22']['type'].'<br>'; 
```

但我希望能够返回 ipv4 数组中的密钥，而不是像我上面那样对它们进行硬编码。当我执行以下操作时：

```
 print_r( array_keys($arrayObjects['ipv4'])); 
```

我得到以下输出：

```
 Array ( [0] => 10.14.2.22 ) 
```

这很棒。但是我如何将 IP 地址作为变量返回给我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:49:36.823

尝试：

第一个元素：

```
$ip_address = array_shift(array_keys($arrayObjects['ipv4'])); 
```

每个元素：

```
foreach($arrayObjects['ipv4'] as $ip_address => $value){
    print_r($ip_address);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:48:53.327

您可以在 foreach 循环中执行此操作：

```
foreach ($arrayObjects['ipv4'] as $key => $value)
{
    // Echo out the key OR save it to another variable..
    echo $key;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T15:49:14.433

```
foreach( $arrayObjects['ipv4'] as $ip => $content )
{
 echo $ip;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:53:05.780

利用：

```
current(array_keys($arrayObjects['ipv4'])); 
```

当像这样使用时，这只是从任何数组中提取第一个元素。

从这里返回的值应该是 '10.14.2.22'

[http://php.net/manual/en/function.current.php](http://php.net/manual/en/function.current.php)

# knockout.js - 淘汰赛验证 - 自定义扩展器上的深度组验证

> ID：11905085
> 
> 赞同：2
> 
> 时间：2012-08-10T15:46:17.070
> 
> 标签：knockout.js, knockout-validation

我正在使用[淘汰赛验证](https://github.com/ericmbarnard/Knockout-Validation)插件来验证我的模型。

我创建了一个淘汰赛扩展器，它允许我在额外的 observable 上验证用户输入，而不是直接在模型上验证。这个概念是避免在输入有效之前更改模型。想象一下，用户正在填充货币字段 - 他们在键入时可能会出错，并且该值将在 NaN 中解析，这将触发对计算出的 observables 等的更新。所以我只采用经过验证的值。

我的问题是我不知道如何让我的扩展器在淘汰赛验证中与深度组验证一起工作。我知道验证会遍历树，并且不会进入我的其他可观察对象。

为了证明我的问题，我模拟了一个快速的 jsfiddle：http: [//jsfiddle.net/maciej/WtDRS/](http://jsfiddle.net/maciej/WtDRS/)

我的扩展器叫做 myNumber。该扩展器稍后将演变为货币、日期、百分比扩展器等。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T22:03:52.757

您是否需要启用深度组验证？

```
ko.validation.configure({
   grouping: {
       deep: true
   }
}); 
```

# image - CSS3 列数

> ID：11905086
> 
> 赞同：1
> 
> 时间：2012-08-10T15:46:21.890
> 
> 标签：image, css, responsive-design

我有一个宽度为 100% 的 div，在其中我有大约 10 张图像，所有这些图像的宽度和大小都不同。我希望能够无缝地将这些图像彼此浮动，我已经做到了，但它们不会在屏幕上伸展，它们都被调整为相同的列宽......无论如何我可以改变这个，所以他们保持它们各自的大小但彼此填充？

我有这个：

```
.images {
   line-height:0;
   -webkit-column-count:6;
   -webkit-column-gap:0px;
   -moz-column-count:6;
   -moz-column-gap:0px;
   column-count:6;
   column-gap:0px;
   background:#545454;
   width:100%;
   display:inline-block;
}

.images img {
  width:100% !important;
  height:auto !important;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:07:01.213

这些`column`属性用于在列中设置文本，以便文本流从一列的末尾继续到下一列的开头。将它们用于图像不是一个好主意。

根据隐含目标的含义，“这些图像无缝地围绕彼此浮动”和“在屏幕上伸展”和“它们保持各自的大小但彼此填充”，您可能会像放`img`一个接一个的元素，*或者*使用`float: left` *或*将它们放入 HTML 表格中，或者使用 CSS`table`属性模拟它。

# android - 打开uri时Android联系人意图仅包含文件名

> ID：11905089
> 
> 赞同：2
> 
> 时间：2012-08-10T15:46:27.673
> 
> 标签：android, android-intent, contacts, vcf-vcard

我尝试编写一个应用程序，作为我的联系人和短信应用程序之间的层。这样我就可以在通过 vcard 共享联系人时为我的应用程序提供一个额外的选项。我的应用程序可以接收到意图。我通过以下方式获取内容：// uri

```
Uri uri = (Uri) getIntent().getExtras().get(Intent.EXTRA_STREAM); 
```

我可以得到一个 AssetFileDescriptor ：

```
AssetFileDescriptor afd = getContentResolver().openAssetFileDescriptor(uri, "r"); 
```

没问题。同样打开文件：

```
InputStream is = afd.createInputStream();
byte[] buffer = new byte[(int)afd.getDeclaredLength()];
is.read(buffer); 
```

但是这个文件只包含“[”和一个十六进制字符串。我认为它应该考虑实际的 vcard 文件？因为我做到了

```
buffer.toString(); 
```

代替

```
new String(buffer); 
```

它不能正确转换 utf-8 编码字节，愚蠢愚蠢的 8 小时错误....

尝试使用 query() 打开 uri

```
Cursor c = getContentResolver().query(uri, null, null, null, null); 
```

给我一个包含一行的游标 ???, firstname lastname.vcf, null

在哪里 ？？？是三个数字。

也许其他人有用于阅读此内容。

# php - 自动完成有问题

> ID：11905090
> 
> 赞同：2
> 
> 时间：2012-08-10T15:46:33.820
> 
> 标签：php, javascript, jquery, mysql

我正在建立一个网站来学习编码，并且我有一个基于 Jquery ui 的自动完成功能，我正在填充三个 mysql 表。

这是我在 index.php 上的代码（我的搜索框所在的页面和自动完成功能应该打开）

```
 <script src="./public/js/jquery.js"></script>
    <script src="public/js/jquery-ui-1.8.22.custom.min.js" type="text/javascript" charset="utf-8"></script>
    <script>
    $(function() {

            $("#search").autocomplete({
            source: "suggest.php",
            minLength = 2,
            select: function( event, ui ) {
                    log( ui.item ?
                         "Selected: " + ui.item.value + aka " + ui.item.id :
                         "Nothing selected, input was " + this.value );
                    }
            });

    });
    </script> 
```

下面是 index.php 上的代码，即形式：

```
<form class="form-search span8 offset6">
    <input type="text" id='search' name='q' autocomplete="off" class="input-medium search-query">
    <button type="submit" class="btn btn-warning">GO!</button>
</form> 
```

这是Suggest.php上的代码：

```
<?php

require("./config.php");

$q = $_GET['q'];

$names = '';

$result = mysql_query("SELECT name FROM company WHERE name LIKE '$q%' UNION SELECT cat FROM cat WHERE cat LIKE '$q%' UNION SELECT subcat FROM subcat WHERE subcat LIKE '$q%' LIMIT 10");

$names = array();

while ($row = mysql_fetch_array($result)) { 
   $names[] = $row['name']; 
}

echo json_encode($names);
?> 
```

如果我直接访问Suggest.php?q= **SOMETHING**并回显$names，结果如下：

```
["City Market","Cafes","Cheesesteaks","Chicken Wings","Chinese","CSA","Coffee & Tea","Convenience Stores","Comedy Clubs"]Array 
```

当我在 Chrome 中打开开发人员面板时，jQUery 旁边有一个错误，自动提示说“Uncaught SyntaxError: Unexpected Token =”

我的自动建议没有出现。怎么了？

感谢大家的帮助！

* * *

我将 = 更改为 : 现在新错误是“Unexpected Token Illegal”并且自动完成仍然没有出现......有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T15:48:30.580

你在 minLength 中有一个等号，应该是冒号

```
$(function() {

        $("#search").autocomplete({
        source: "suggest.php",
        minLength: 2,
        select: function( event, ui ) {
                log( ui.item ?
                     "Selected: " + ui.item.value + aka " + ui.item.id :
                     "Nothing selected, input was " + this.value );
                }
        });

}); 
```

# url - Kentico 智能搜索结果 URL 未链接

> ID：11905091
> 
> 赞同：2
> 
> 时间：2012-08-10T15:46:36.960
> 
> 标签：url, search, hyperlink, kentico

我在一个框中有一个智能搜索框，结果按预期显示在结果页面上 - 但是每个结果的 URL 只是链接到结果页面而不是相关文档。

有人对我做错了什么有任何指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:38:00.480

您必须在转换中调用方法`SearchResultUrl(true)`来获取 URL。[在文档http://devnet.kentico.com/docs/devguide/index.html?smart_search_transformations.htm](http://devnet.kentico.com/docs/devguide/index.html?smart_search_transformations.htm)中查看更多信息

# node.js - 在 nodejitsu 上启动 redis 服务器

> ID：11905093
> 
> 赞同：3
> 
> 时间：2012-08-10T15:46:44.287
> 
> 标签：node.js, redis, nodejitsu

在本地开发中，您使用“redis-server”命令启动一个 redis 服务器。但是，当我将项目部署到 nodejitsu（使用`jitsu deploy`）时，没有运行此命令的界面，并且启动已部署的应用程序会出现以下错误：

```
错误：与 127.0.0.1:6379 的 Redis 连接失败 - 连接 ECONNREFUSED

```

如何在 nodejitsu 服务器上启动 redis？这是默认启用的，还是我必须更改一些配置才能使其正常工作？搜索了一下，但根本找不到任何线索，有什么明显的我遗漏了吗？将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T18:49:03.790

是的，你们是对的——irc 频道立即找到了合适的人。

所以@AvianFlu 的答案是nodejitsu 不托管数据库。但是，您可以使用以下命令创建 couch、redis 或 mongo 数据库实例：

```
jitsu databases create <database type> <database name> 
```

这将创建托管在例如的数据库。RedisToGo、CouchIris 或 MongoHQ，您可以将它们与您的 nodejitsu 应用程序一起使用。有关数据库连接的更多详细信息 - [https://github.com/nodejitsu/handbook/#databases](https://github.com/nodejitsu/handbook/#databases)

如果您使用的是试用服务器，您将无法创建数据库（分配的小内存使得在同一台服务器上运行数据库变得不可行），但是您仍然可以使用连接到现有的 Redis/Couch/Mongo DB以下代码：

```
// Given this Redis conection string: 
// "redis://myDb:1234c6607579e81ff116374dc0cc4321@abc.redistogo.com:10108/"
// you can connect to your redistogo instance like so:

var client = redis.createClient(10108, 'abc.redistogo.com');
client.auth("1234c6607579e81ff116374dc0cc4321", function(err) {
  if (err) {
    throw err;
  }
});
client.on('ready', function () { // without this part, redis connection will fail
  // do stuff with your redis
}); 
```

来自 nodejitsu 的 @blakmatrix 使用外部配置文件用一个出色的数据库连接模板回复了我的票。超级方便的多环境。[https://github.com/nodeapps/boilerplates/tree/databases/helloredis](https://github.com/nodeapps/boilerplates/tree/databases/helloredis)

我可以确认这是可行的，即使是试用 nodejitsu 服务器和 redistogo 实例。惊人的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:14:45.710

你试过`jitsu databases`命令吗？你有没有主动为redis设置任何配置？

仅供参考：Nodejitsu 平台*非常*新。[公开测试版公告](http://blog.nodejitsu.com/nodejitsu-is-now-in-public-beta)是一个月前。现在可能有几百人在使用 nodejitsu 产品。

您最好的选择是直接访问源。[他们在 freenode 上有一个 IRC 频道：#nodejitsu，他们还在他们的支持页面](http://nodejitsu.com/support.html)上发布他们的电子邮件。

如果你打算使用这个产品，我强烈建议你加入 IRC。这可能只是您必须克服的几个障碍中的第一个。

# security - 应该在域或 UI 层中检查角色吗？

> ID：11905104
> 
> 赞同：2
> 
> 时间：2012-08-10T15:47:21.920
> 
> 标签：security, domain-driven-design

在 DDD 的世界中，检查域中的用户角色是正确的，还是应该在 UI 中发生？我问的原因是因为看起来，如果安全和角色是业务需求的一部分，那么它们似乎应该存在于域中。然而，几乎所有角色检查的例子都表明它是在 UI 层完成的。是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T18:39:37.777

一般来说，在应用程序或 UI 级别处理身份验证和授权问题有几个原因：

从建模的角度来看，这些问题通常不是系统功能所固有的。例如，用户故事可能会声明：“*作为操作员，我可以打开机器……* ”。虽然确保只有操作员才能访问机器可能很重要，但机器本身并不关心谁可以打开它。

从实用的角度来看，这些类型的关注点通常与域分开，以避免将应用程序或域级服务注入实体的必要性。由于实体通常通过 ORM 框架进行序列化，因此将服务注入实体可能很麻烦（有关此主题的更多信息，请参见[http://lostechies.com/jimmybogard/2010/04/14/injecting-services-into-entities/](http://lostechies.com/jimmybogard/2010/04/14/injecting-services-into-entities/)）。

# ruby-on-rails - Rails 协会中的棘手表格

> ID：11905107
> 
> 赞同：1
> 
> 时间：2012-08-10T15:47:32.337
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我遇到批量分配错误。而且我不明白为什么它会给我错误这里是错误

```
ActiveModel::MassAssignmentSecurity::Error in CustomersController#edit

Can't mass-assign protected attributes: gender 
```

这是我的模型

```
Customer     GenderManager        Gender
ID           Id                   Id
First        isVisible            Description
Last         GroupID
Email
... 
```

这里是我的关系

```
class Customer < ActiveRecord::Base
# RELATIONSHIP
    #Gender
    has_many :gender_managers
    accepts_nested_attributes_for :gender_managers, allow_destroy: :true
end
class GenderManager < ActiveRecord::Base
# RELATIONSHIP
    belongs_to :customer
    has_one :gender
    attr_accessible :customer_id, :friendship_group_id, :isUsed,
    :isVisible, :genders_attributes
    accepts_nested_attributes_for :gender, allow_destroy: :true
end
class Gender < ActiveRecord::Base
    belongs_to :gender_manager
    attr_accessible :description, :gender_managers_id
end 
```

客户控制器

```
def edit
        @customer = Customer.find(params[:id])
        @customer.gender_managers.build(:gender => Gender.new)

        @bm = current_customer.book_managers.build
end 
```

形式

```
 <%= form_for @customer, :html => {:multipart => true} do |f| %>
    <div class="customer_edit_error_message">
            <%= render 'shared/error_messages' %>
    </div>
    <fieldset>
    <div class="customer_edit_name">
            <%= f.label :first_name %>
            <%= f.text_field :first_name %>
    </div>

    <div class="customer_edit_middle_name">
            <%= f.label :middle_name %>
            <%= f.text_field :middle_name %>
    </div>

    <div class="customer_edit_last_name">
            <%= f.label :last_name %>
            <%= f.text_field :last_name %>
    </div>
    <%= f.fields_for :gender_managers do |gendermanagers| %>
    <fieldset>
        <%= gendermanagers.fields_for :genders do |genders| %>
            <%= genders.label :description %>
            <%= genders.select :description %>
        <% end %>
        <div><%= gendermanagers.label :friendship_group_id, "Show To: " %>
        <%= gendermanagers.text_field :friendship_group_id %></div>
        <div><%= gendermanagers.check_box :isVisible %> 
        <%= gendermanagers.label :isVisible %></div>
    </fieldset>
    <% end %>
    <div class="customer_edit_button">
            <%= f.submit "Save changes", class: "button_accept" %>
    </div>
    <% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:04:00.193

您是否尝试过添加`:gender`到模型中的列表`attr_accessible`中`GenderManager`？

但我发现上面的答案更好，稍作修正：

```
gender_manager = @customer.gender_managers.build
gender_manager.build_gender 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T15:55:25.810

您可能需要使用该`build_gender`方法来建立关联。

```
gender_manager = @customer.gender_managers.build
gender_manager.build_gender 
```

此答案已被编辑以反映已接受答案中给出的更正代码。

# c# - 我可以在属性中包含一个属性吗？

> ID：11905112
> 
> 赞同：2
> 
> 时间：2012-08-10T15:48:24.007
> 
> 标签：c#, custom-attributes

我正在开发一个应用程序，它将从我的数据库中读取数据，进行一些处理，然后将结果导出到一个固定宽度的平面文件中。

我从[这个](https://stackoverflow.com/questions/6293884/custom-serialization-of-an-object-in-net)问题中的代码开始，并以此为基础。

现在，导出的文件有三种主要的数据类型，String、Num 和 Decimal(x,y)；其中x是小数点左边的数字，y是小数点右边的数字。

就我的自定义属性而言，我有这个：

```
public class FixedWidthColumn : Attribute
{
    public int Position { get; set; }
    public int Length { get; set; }

    public FixedWidthColumn(int position, int length)
    {
        Position = position;
        Length = length;
    }
} 
```

是否可以创建一个自定义属性（或其他一些结构），我可以使用它来构建这样的属性：

```
[FixedWidthColumn(3,2, String)]
public string CompanyId

[FixedWidthColumn(6, 20, Num)]
public int Sku { get; set; }

[FixedWidthColumn(5, 10, Decimal(6,4)]
public decimal Price { get; set; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T15:56:25.810

您可以扩展 FixedWidthColumnAttribute 以携带参数类型属性。

```
 public enum FixedWidthColumnType 
       {
            String,
            Num,
            Decimal 
       }

        [AttributeUsage(AttributeTargets.Property)]
        public class FixedWidthColumnAttribute : Attribute  
        {      
             public int Position { get; private set; }      
             public int Length { get; private set; }        
             public int Digits {get;set;}
             public int FractionalDigits {get;set}

             public FixedWidthColumnType Type {get; private set;}
             public FixedWidthColumn(int position, int length, 
                   FixedWidthColumnType type)

             {          this.Position = position;          
                        this.Length = length;      
                        this.Type = type;
             }

         } 
```

用法：

```
 [FixedWidthColumn(4, 10, FixedWidthColumnType.String)]

         [FixedWidthColumn(5, 6, FixedWidthColumnType.Decimal, Digits = 3, FractionalDigits = 4)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T15:58:28.893

首先，您应该将您的类名 FixedWithColumn 重命名为 FixedWithColumnAttribute。也许，这只是一个约定；但我认为这是应用 C# 语义所必需的。其次，您应该在调用属性声明中指明 typeof(Type) ：

```
[FixedWidthColumn(3,2,typeof(String))] 
```

第三，像这样声明构造函数：

```
public FixedWidthColumnAttribute(int position, int length, Type objType) 
```

我希望它可以帮助你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:02:38.853

回答具体问题：不，属性中不能有属性。

属性在其构造函数中只能采用有限范围的数据类型。有关示例，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms177221.aspx)。因此，您不能拥有将类公开为属性的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:55:24.303

我建议使用继承，例如：

```
public class FixedWidthDecimalAttribute : FixedWidthColumnAttribute
...
public FixedWidthDecimal(int position, int wholeDigits, int fractionalDigits)
...
[FixedWidthDecimal(5, 6, 4)] 
```

在您的检查代码中，您可以获取所有`FixedWidthColumnAttribute`对象，允许继承，然后检查类型（使用`GetType`）以确定它是什么类型的对象。

# php - :not(:first-child) 和 Jquery 1.8.0

> ID：11905117
> 
> 赞同：1
> 
> 时间：2012-08-10T15:48:39.017
> 
> 标签：php, jquery, css-selectors

使用 PHP 我在表格中显示数据行。每一行都是一个链接。`<a>`我决定使用 Jquery 来使每个标签都可点击，而不是在每个表格单元格中使用`<tr>`标签，除了第一个`<tr>`是表格标题，第一个`<td>`是因为它包含一个复选框。

查看我的 Fiddle 示例和代码：http: [//jsfiddle.net/Draven/eQznR/12/](http://jsfiddle.net/Draven/eQznR/12/)

它适用于 Jquery 1.7.2，但由于它们今天更新到 1.8.0，它不再适用。

我想要一个无需使用 Jquery 1.7.2 的解决方案，因为显然这不是正确的做法。

谢谢你。

编辑：感谢 Šime Vidas，这是因为我有一个班级编号（`class=1`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T15:53:07.347

这是`"1"`1.8 版的类名。如果你使用以字母开头的类名，它将在 1.8 中工作：

**现场演示：http:** [//jsfiddle.net/eQznR/14/](http://jsfiddle.net/eQznR/14/)

# javascript - 用于循环的 Jquery 插件

> ID：11905122
> 
> 赞同：0
> 
> 时间：2012-08-10T15:49:08.580
> 
> 标签：javascript, jquery

考虑到这段代码（我正在开发的 JQuery 插件的一部分）：

```
for (var counter = 1; counter <= 3; counter++) {
    var btn = $("<a></a>").addClass(class1)
                          .addClass(class2 + counter);
    btn.click(function() {
        $.fn.myPlugin.Click(counter);
    });
    myDiv.append(btn);
 } 
```

我有 CSS 类（使其看起来像一个按钮）和一个单击事件调用我的插件函数之一`btn`的标签在哪里，其中包含我的 3 个创建的按钮。`<a>``counter``myDiv``<div>`

问题是我`<a>`创建的所有标签都将调用该函数`4`作为参数，我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:55:40.490

可能有更好的方法来创建闭包，但是当我遇到这样的问题时，这就是我要做的。

```
for (var counter = 1; counter <= 3; counter++) {
    var btn = $("<a></a>").addClass(class1)
                          .addClass(class2 + counter);

    (function(b,c) {
        b.click(function() {
            $.fn.myPlugin.Click(c);
        });
    })(btn,counter);

    myDiv.append(btn);
 } 
```

`btn`传入可能不是必需的，因为无论如何它都会通过引用传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T15:59:20.467

这是一个如何处理循环中的闭包的示例。必须评估此工作的原因`i`，以便创建记录其当前值的函数。您可以以类似的方式在 for 循环中创建自己的 makeClickHandlerFunction。

```
var funcs = [];
for(var i = 0; i < 5; i++){
   var createFunc = function(x){
      return function(){console.log(x)};
   };
   funcs.push(createFunc(i));
}
funcs[0](); //logs 0
funcs[1](); //logs 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:07:20.470

我发现我可以用它来解决这个问题

```
btn.click({ arg: counter }, function(event) {
    $.fn.myPlugin.Click(event.data.arg);
}); 
```

# c# - 如何使用 CopyToOutputDirectory = Always 获取所有内容文件？

> ID：11905132
> 
> 赞同：1
> 
> 时间：2012-08-10T15:49:43.627
> 
> 标签：c#, build, msbuild, build-automation, tfsbuild

MSBuild 中是否有一种简单的方法来获取`Content`文件中定义的所有文件`*.csproj`并`CopyToOutputDirectory`设置为`Always`？出于某种原因，我的 MSBuild 脚本没有将这些文件复制到我的输出目录，所以我试图创建一个构建后目标来手动移动它们。

编辑：这是在带有 .NET 3.5 的 VS 2008 中

# matlab - 修复地块的地块比例（然后再次解除它们）

> ID：11905134
> 
> 赞同：2
> 
> 时间：2012-08-10T15:49:51.373
> 
> 标签：matlab, plot

我使用函数*daspect()*使 3 维绘图​​的 Y 轴和 Z 轴在 MATLAB 中以等效的比例大小出现。

我使用以下代码实现了这一点（在使用*plot3*绘制图形后应用）：

```
tmpAspect=daspect(); % get the aspect ratio of the axes scales
daspect(tmpAspect([1 2 2])); % make the Y and Z axes equal in scale 
```

这正是我正在寻找的行为，因为我需要在最初绘制图形时 Y 轴和 Z 轴相同。

但是 - 如果我尝试放大，我只能在保持 Y 轴和 Z 轴之间严格关系的同时进行缩放。这当然正是我要求程序做的事情，而且它的工作做得很好。但我只希望在生成绘图时应用 Y 轴和 Z 轴之间的这种关系 - 之后，它需要能够以我喜欢的任何方式进行缩放。

有没有一种方法可以设置具有等效比例的绘图（如上面的代码中所示），但如果他们愿意，允许用户打破这种关系？

编辑：下图显示了我的身材的三个视图。首先，在三个维度上，可以看出保持 Y 轴和 Z 轴（都以度为单位）之间的严格关系很有用。其次，这只是 X 和 Y 轴的视图。为了更详细地查看（第三张图片），只需要水平放大。此时，删除 Y 轴和 Z 轴之间的关系有助于更好地可视化。

nb Y 轴包含“X 位置”数据，Z 轴包含“Y 位置”数据。只是为了让事情变得更加混乱！

![在此处输入图像描述](../Images/2ca48f561af753e15033984d6743be05.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T14:31:54.880

好的，这是我第一次尝试解决您的问题。方法：

*   制作一个图形，并像以前一样冻结纵横比
*   如果您需要 XY 或 XZ 投影，只需按下轴下方的按钮之一

当您按下按钮时，水平缩放（例如，仅在 x 方向）将立即启用，因此滚动鼠标滚轮将水平缩放轴。

在深入研究之前，只需将所有内容复制并粘贴到一个名为`myPlot.m`并执行它的 m 文件中。看看这是否确实与您所追求的一致。如果您满意，我可以进一步调味。

```
function myPlot

    % init figure
    fig = figure;
    set(fig, 'units', 'normalized');

    % some sample data
    datat = 0:200*pi;
    dataz = sin(datat) + rand(size(datat));
    datay = cos(datat) + rand(size(datat));
    datax = datat;

    % sample plot
    plt3D   

    % your current method    
    function plt3D(varargin)
        cleanFig         
        plot3(datax, datay, dataz, 'b.')        
        view(-68, 30)
        tmpAspect = daspect();
        daspect(tmpAspect([1 2 2]));
    end

    % 2D plot, XY projection
    function pltXY(varargin)
        cleanFig
        plot(datax, datay, 'b.')  
        xlabel('Time [msec]')
        ylabel('X-position');
        zoom xon
    end

    % 2D plot, XZ projection
    function pltXZ(varargin)
        cleanFig
        plot(datax, dataz, 'b.')
        xlabel('Time [msec]')
        ylabel('Y-position (^{\circ})');
        zoom xon        
    end

    % draw the buttons
    function pltButtons        

        uicontrol(...
            'parent'  , fig,...
            'style'   , 'pushbutton', ...
            'units'   , 'normalized',...
            'position', [0, 0, 1/3, 1/15], ...
            'string'  , 'plot 3D',...
            'callback', @plt3D);

        uicontrol(...
            'style'   , 'pushbutton', ...
            'units'   , 'normalized',...
            'position', [1/3, 0, 1/3, 1/15], ...
            'string'  , 'plot XY',...
            'callback', @pltXY);

        uicontrol(...
            'style'   , 'pushbutton', ...
            'units'   , 'normalized',...
            'position', [2/3, 0, 1/3, 1/15], ...
            'string'  , 'plot XZ',...
            'callback', @pltXZ);        
    end

    % re-init the figure
    function cleanFig
        set(0, 'currentfigure', fig)
        clf, hold on
        pltButtons
    end 

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T10:01:59.757

我想知道是否有一种简单的方法可以做到。但是，如果一切都失败了，您可以创建自己的缩放回调。

见`doc zoom`一些例子。

# r - 给定多个输入的R ggplot直方图

> ID：11905136
> 
> 赞同：2
> 
> 时间：2012-08-10T15:50:05.410
> 
> 标签：r, histogram, ggplot2

我在 R 中偶然发现了一个问题，我希望有人能弄清楚它发生的原因以及如何解决它。我对 R 的使用没有很好的审查，有时我会感到困惑，因为一行代码通常可以比许多其他语言做更多的事情。问题似乎是程序在第一次之后没有正确地获取文件输入。如果我输入一个文件，直方图会以我期望的方式出现。但不幸的是，当输入多个文件时，它会将它们组合在一起并将它们放在第一个文件旁边。我宁愿每个输入文件都有自己独立的直方图。很抱歉这篇长文，但我试图提供尽可能多的信息以使我的代码可重现（我似乎不擅长重现代码）。

代码是这样的：

```
library("tcltk")
#choose any number of files
File.names<-(tk_choose.files(default="", caption="Choose your files", multi=TRUE, filters=NULL, index=1))
Num.Files<-NROW(File.names)
#read the tables
dat <- lapply(File.names,read.table,header = TRUE)
names(dat) <- paste("f", 1:length(Num.Files), sep="")
#use the 14th columns data
tmp <- stack(lapply(dat,function(x) x[,14]))
#this is where the histogram is made(with percent shown on the y axis)
require(ggplot2)
ggplot(tmp,aes(x = values)) + 
    facet_wrap(~ind) +
    geom_histogram(aes(y=..count../sum(..count..)))
dput(tmp)
dput(dat)
sessionInfo() 
```

以下是用户可以选择的文件示例：

```
Targ  cov  av_cov  87A_cvg  87Ag  87Agr  87Agr  87A_gra  87A%_1   87A%_3   87A%_5   87A%_10  87A%_20  87A%_30 87A%_40   87A%_50 87A%_75 87A%_100
1:028 400   0.42    400 0.42    1   1   2   41.8    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
1:296 400   0.42    400 0.42    1   1   2   41.8    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
1:453 1646  8.11    1646    8.11    7   8   13  100.0   100.0   87.2    32.0    0.0 0.0 0.0 0.0 0.0 0.0
1:427 1646  8.11    1646    8.11    7   8   13  100.0   100.0   87.2    32.0    0.0 0.0 0.0 0.0 0.0 0.0
1:736 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    0.0 0.0
1:514 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    0.0 0.0
1:296 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    0.0 0.0
1:534 400   0.42    400 0.42    1   1   2   41.8    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 
```

还有一个：

```
Targ  cov  av_cov  87A_cvg  87Ag  87Agr  87Agr  87A_gra  87A%_1   87A%_3   87A%_5   87A%_10  87A%_20  87A%_30 87A%_40   87A%_50 87A%_75 87A%_100
    1:028 400   0.42    400 0.42    1   1   2   41.8    0.0 1.0 0.0 20.0    0.0 0.0 0.0 0.0 0.0
    1:296 400   0.42    400 0.42    1   1   2   41.8    0.0 20.0    0.0 40.0    0.0 100.0   10.0    50.0    4.0
    1:453 1646  8.11    1646    8.11    7   8   13  100.0   100.0   87.2    32.0    0.0 100.0   4.0 60.0    30.0    20.0
    1:427 1646  8.11    1646    8.11    7   8   13  100.0   100.0   87.2    32.0    0.0 80.0    40.0    60.0    80.0    90.0
    1:736 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    30.0    20.0
    1:514 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    20.0    30.0
    1:296 5105  29.68   5105    29.68   14  29  48  100.0   100.0   100.0   86.0    65.7    49.4    35.5    16.9    20.0    30.0
    1:534 400   0.42    400 0.42    1   1   2   41.8    0.0 40.0    30.0    80.0    70.0    40.0    30.0    30.0    10.0 
```

该代码适用于一个文件（这些直方图是由不同的输入文件制作的，但你得到了图片）但不同意多个文件（无论数量如何）： 一： ![一](../Images/1533974f48be34207928909409773440.png)

这就是我希望所有直方图的外观，每个输入文件一个。但唉......多个文件： ![多](../Images/7f32755b210aae054f2a04bea30f4c07.png)

```
> dput(tmp)
structure(list(values = c(0, 0, 0, 0, 49.4, 49.4, 49.4, 0), ind = structure(c(1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = "f1", class = "factor")), .Names = c("values", 
"ind"), row.names = c(NA, -8L), class = "data.frame")
> dput(dat)
structure(list(f1 = structure(list(Targ = structure(c(1L, 2L, 
4L, 3L, 7L, 5L, 2L, 6L), .Label = c("1:028", "1:296", "1:427", 
"1:453", "1:514", "1:534", "1:736"), class = "factor"), cov = c(400L, 
400L, 1646L, 1646L, 5105L, 5105L, 5105L, 400L), av_cov = c(0.42, 
0.42, 8.11, 8.11, 29.68, 29.68, 29.68, 0.42), "X87A_cvg", "X87Ag", "X87Agr", "X87Agr.1", "X87A_gra", "X87A._1", "X87A._3", "X87A._5", "X87A._10", "X87A._20", "X87A._30", "X87A._40", 
"X87A._50", "X87A._75", "X87A._100"), class = "data.frame", row.names = c(NA, 
-8L))), .Names = "f1")
> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: x86_64-redhat-linux-gnu (64-bit)
    locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
    attached base packages:
[1] tcltk     stats     graphics  grDevices utils     datasets  methods  
[8] base     
    other attached packages:
[1] ggplot2_0.9.1
    loaded via a namespace (and not attached):
 [1] colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2       grid_2.14.1       
 [5] labeling_0.1       MASS_7.3-17        memoise_0.1        munsell_0.3       
 [9] plyr_1.7.1         proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.1    
[13] scales_0.2.1       stringr_0.6 
```

有没有办法让每个直方图分开，并且能够独立存在？在此先感谢斯蒂芬

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T18:42:31.033

鉴于您在我的系统上`dat`返回一个损坏的数据框`dat`，这是一种使用带有虚拟数据的基本 R 的更简单方法。

```
## fake a list of data frames, here, 4, each with two columns
dat <- list(file1 = data.frame(X = runif(20), Y = rnorm(20)),
            file2 = data.frame(X = runif(20), Y = runif(20)),
            file3 = data.frame(X = runif(20),
                               Y = rnorm(20) + rnorm(20, mean = 2, sd = 2)),
            file4 = data.frame(X = runif(20), Y = rnorm(20, mean = 4)))

## extract the second column from each
## (this is the same as your code extracting the 14 column)
tmp <- lapply(dat, `[[`, 2) 
```

现在看看我们有什么：

```
R> str(tmp)
List of 4
 $ file1: num [1:20] -1.0225 -0.0302 -0.0987 1.977 0.2579 ...
 $ file2: num [1:20] 0.84583 0.49525 0.12287 0.43929 0.00132 ...
 $ file3: num [1:20] 2.03 5.27 1.57 2.72 1.12 ...
 $ file4: num [1:20] 4.54 4.08 4.28 4.48 6.36 ... 
```

所以尝试绘制 的第一个组件`tmp`：

```
hist(tmp[[1]]) 
```

好的，这样就可以了。现在我们知道我们可以绘制所有组件。以下是几种方法：

```
layout(matrix(1:4, ncol = 2))
for(p in seq_along(tmp)) {
    hist(tmp[[p]])
}
layout(1) 
```

或使用`lapply()`为我们做循环

```
layout(matrix(1:4, ncol = 2))
lapply(tmp, function(x) {hist(x); invisible()})
layout(1) 
```

两者都生成如下内容：

![直方图矩阵](../Images/273877344344f88204f33feac9cafc0f.png)

显然，我们可以更好地定制情节轴标签和标题，但我将其留给读者作为练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:24:41.390

这是因为您正在使用`facet_wrap()`. 如果您希望每个输入有一个绘图，那么您必须创建一个循环

```
library("tcltk")
#choose any number of files
File.names<-(tk_choose.files(default="", caption="Choose your files", multi=TRUE, filters=NULL, index=1))
Num.Files<-NROW(File.names)
#read the tables
dat <- lapply(File.names,read.table,header = TRUE)
names(dat) <- paste("f", 1:length(Num.Files), sep="")
#use the 14th columns data
tmp <- stack(lapply(dat,function(x) x[,14]))
#this is where the histogram is made(with percent shown on the y axis)
gHist <- function(df){
   require(ggplot2)
   # New page so it doesn't overplot previous graphs
   grid.newpage()
   ggplot(df,aes(x = values)) + 
      geom_histogram(aes(y=..count../sum(..count..)))+
      # Add a tible
      opts(title = unique(df$ind))
}
# Split gives a list of the data.frame splited by ind
# Then lapply will cycle through the list and
# apply the function to each piece
lapply(split(tmp, tmp$ind), gHist) 
```

你只提供了一张地块的数据，所以我只做了一张。而 R 抱怨`dput(dat)`已损坏。

![在此处输入图像描述](../Images/d94d9544ef250e65c74d8946fef16ed4.png)

# tinymce - 如何在 tinyMCE 中设置列 表项项目符号和数字的字体大小？

> ID：11905139
> 
> 赞同：8
> 
> 时间：2012-08-10T15:50:07.390
> 
> 标签：tinymce

TinyMCE 是一个很棒的工具，它为我们解决了很多问题。然而，有一个问题一直难以解决。虽然 TinyMCE 将更改列表中项目的字体大小，但它不会更改执行这些项目的项目符号（无序列表）或数字（有序列表）的大小。

用户最终得到的结果如下所示：

![项目字体更改但项目符号字体不更改](../Images/a00f269716e792b6f2bf70c47d37fcec.png)

正如您在图像中看到的，两个列表中的字体大小不同，但项目符号的大小相同。

有谁知道如何让 TinyMCE 更改项目符号以匹配字体？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T15:58:00.720

[在这里](http://www.tinymce.com/forum/viewtopic.php?id=26100)和[这里](http://www.tinymce.com/forum/viewtopic.php?id=25676)搜索 TinyMCE 论坛后，我想出了这个解决方案。

```
tinyMCE.onAddEditor.add(function(manager, editor) { 
    // TinyMCE doesn't change the font of the li portions of the list,                                      
    // we have do that ourselves here.  See http://www.tinymce.com/forum/viewtopic.php?id=26100             
    editor.onExecCommand.add(function(editor, cmd, ui, val) {                                               
        if (cmd === "FontSize") {
            var node = editor.selection.getNode();                                                          
            if (node) {                                                                                     
                var children = $(node).children("li");
                if (children) {
                    // TinyMCE keeps an attribute that we want it to recompute,                             
                    // clear it. See http://www.tinymce.com/forum/viewtopic.php?id=25676                    
                    children.removeAttr('data-mce-style');                                                  
                    children.css("font-size", val);                                                         
                }
            }       
        }               
    });                     
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-07T09:36:03.920

我稍微编辑了史蒂夫的答案以使用 tinymce domutils 而不是 jquery。我还添加了对整个列表选择的检查：

```
ed.on('ExecCommand', function checkListNodes(evt) {  
   let cmd = evt.command;
   if (cmd === 'FontSize' || cmd === 'FontName') { 
      let val = evt.value;
      let node = evt.target.selection.getNode();
      let nodeParent = node.parentNode;
      if (node.nodeName === 'SPAN' && nodeParent.nodeName === 'LI') {
          if (cmd === 'FontSize') {
              ed.dom.setStyle(nodeParent, 'font-size', val);
          }
          if (cmd === 'FontName') {
             ed.dom.setStyle(nodeParent, 'font-family', val);
          }
       } else if (node.nodeName === 'UL' || node.nodeName === 'OL') {
          let li = ed.dom.select('li', node);
          if (cmd === 'FontSize') {
              ed.dom.setStyle(li, 'font-size', val);
          }
          if (cmd === 'FontName') {
              ed.dom.setStyle(li, 'font-family', val);
           }
      }
   }
}); 
```

请注意，不幸的是，这不适用于颜色更改。更多信息在这里[不能再捕捉 ForeColor 命令了，tinymce 4.1.4](https://stackoverflow.com/questions/27540258/cant-catch-the-forecolor-command-anymore-tinymce-4-1-4)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-22T15:40:22.477

Bernhard 的解决方案在 TinyMCE 4.1.7 中对我不起作用，但下面的代码可以。我包括了一些上下文，希望尽可能清楚。

这是来自网站建设者。用户通过右键单击要编辑的 DIV 并从上下文菜单中选择“文本”来打开编辑器。这将执行一个 tinymce.init，它将一个内联编辑面板附加到 DIV。添加编辑器后，控制就出现在这里。

第一个`editor.on`是回调以捕捉编辑器创建的结束，然后触发 focusin 以显示编辑器。第二个`editor.on`捕获对 li 内跨度的更改并对 li 进行更新。第三个`editor.on`捕捉编辑器关闭。

```
/************************************************************************************/
/*                               TinyMCE Events                                     */
/************************************************************************************/

tinymce.on('AddEditor', function(e) {
            // Once editor has been added show it by firing 'focusin' instead of waiting for a click
               e.editor.on('NodeChange',function(e) {
                   e.target.fire('focusin');            // show the editor
               });

            // Update parent <li> to match a font-size or font-family change in text
               e.editor.on('ExecCommand',function(e) {  
                   var cmd = e.command;
                   if (cmd === "FontSize" || cmd === "FontName") { 
                       var val = e.value;
                       var node = e.target.selection.getNode();  // editor in this event object is at target
                       var nodeParent = node.parentNode;
                       if (node.nodeName === "SPAN" && nodeParent.nodeName === "LI") {
                            // We're changing the  style of a <span> that's inside  an <li>.
                            // Change the <li> to match the new font-size or font-family.
                            // (B, U, and forecolor buttons don't come here so we can't update li here for those)
                            nodeParent$ = $(nodeParent);
                            nodeParent$.removeAttr('data-mce-style');
                            if(cmd === "FontSize") {
                               nodeParent$.css('font-size',val); 
                            }
                            if(cmd === "FontName") {
                               nodeParent$.css('font-family',val); 
                            }
                      }
                  }
             });

             // When editor is removed (by clicking in a blank area of the inline panel)    
             // restore draggability to the DIV (had to kill before tinymce.init because draggability
             // and contenteditable don't work together).       
               e.editor.on('RemoveEditor',function(e) {
                   g.currentElement$.attr('editor_state', "off")
                                    .draggable('enable')   // make DIV draggable again
                                    .removeClass('textCursor');  // give DIV back its pointer cursor
               });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-24T08:29:51.587

我已经解决了这些问题并添加了一些不错的功能。这现在对我有用：

```
ed.onExecCommand.add(function(editor, cmd, ui, val) {
  if (cmd === "FontSize" || cmd === "FontName" || cmd === "ForeColor" || cmd === "Bold" || cmd === "Italic") {
     var node = editor.selection.getNode();
     if (node) {
        var children = $(node).closest("li");
        if(children.length == 0)
           var children = $(node).find("li");

        if (children) {
           children.removeAttr('data-mce-style');
           if(cmd === "FontSize")
              children.css("font-size", val);
           if(cmd === "FontName")
              children.css("font-family", val);
           if(cmd === "ForeColor")
              children.css("color", val);
           if(cmd === "Bold") {
              if(children.find("strong").length > 0) {
                 children.removeAttr('data-mce-style');
                 children.css("font-weight", "bold");
              } else {
                 children.removeAttr('data-mce-style');
                 children.css("font-weight", "normal");
              }
           }
           if(cmd === "Italic") {
              if(children.find("em").length > 0) {
                 children.removeAttr('data-mce-style');
                 children.css("font-style", "italic");
              } else {
                 children.removeAttr('data-mce-style');
                 children.css("font-style", "normal");
              }
           }
        }
     }
  }
  if (cmd === "InsertOrderedList" || cmd === "InsertUnorderedList") {
     var node = editor.selection.getNode();
     if (node) {
        $(node).find("li").each(function() {
            var children = $(this).find("span:first");
            if (children.length > 0) {
               $(this).removeAttr('data-mce-style');

               if(children.css("font-size") != "undefined")
                  $(this).css("font-size", children.css("font-size"));
               if(children.css("font-family") != "undefined")
                  $(this).css("font-family", children.css("font-family"));
               if(children.css("color") != "undefined")
                  $(this).css("color", children.css("color"));
               if($(this).find("em").length > 0)
                  $(this).css("font-style", "italic");
               if($(this).find("strong").length > 0)
                  $(this).css("font-weight", "bold");
            }
        });
     }
  }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T13:49:24.837

这对我有用：

在 tinyMCE.init 上，我添加了设置回调：

```
setup: function(ed) {
      ed.onKeyDown.add(function(ed, e) {
        tinyMceKeyDownCallbacks(ed,tiny_id);
      });
    } 
```

然后是更新每个 li 的 jquery 函数，它们的 span 类和/或样式都有一个 span：

```
function tinyMceKeyDownCallbacks(inst,tiny_id){
  var spans = $(inst.getBody()).find("li span");
  console.log("S: "+spans.length);
  spans.each(function(){
    var span = $(this);
    span.parents('li').addClass(span.attr('class'));
    span.parentsUntil('li').attr('style',span.attr('style'));
  });
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-27T13:08:48.747

正如 SP 所提到的，TinyMCE使用包含编辑器中设置的样式的`<li>`a 包装内部内容。您可以以该跨度为目标，并以编程`<span>`方式将样式复制到匹配项：`<li>`

```
$('.content-custom li').each(function() {
    var spanStyle = $(this).find('span').attr('style');
    $(this).attr('style', spanStyle);
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-22T07:32:04.950

```
 tinymce.on('AddEditor', function(ea) {
                  ea.editor.on('ExecCommand',function(e) {                  
                      var cmd = e.command;
                       var val = e.value;
                      var node = e.target.selection.getNode(); 
                       var nodeParent = node.parentNode;                       
                       nodeParent$ = $(nodeParent);
                        node$=$(node);
                      if (cmd === "FontSize" || cmd === "FontName") {                         
                                while(nodeParent.nodeName !='LI' && nodeParent.nodeName!='BODY'){
                                nodeParent = nodeParent.parentNode;
                            }
                            nodeParent$ = $(nodeParent);                                
                                if(node.nodeName==='OL' || node.nodeName==='UL'){                               
                                    if(cmd === "FontSize") {
                                        $(node.children).each(function (){
                                        $(this).css('font-size',val);
                                    });

                                    }
                                    if(cmd === "FontName") {
                                        $(node.children).each(function (){
                                        $(this).css('font-family',val);
                                    });

                                    }
                                }

                          if (nodeParent.nodeName === "LI" ) {
                               nodeParent$.removeAttr('data-mce-style');                                
                               if(cmd === "FontSize") {
                                    nodeParent$.css('font-size',val);
                               }
                               if(cmd === "FontName") {                                  
                                 nodeParent$.css('font-family',val);
                               }                             
                         }

                     }
                      if(cmd==='mceToggleFormat' && e.value==='bold'){

                            while(nodeParent.nodeName !='LI' && nodeParent.nodeName!='BODY'){
                                nodeParent = nodeParent.parentNode;
                            }
                            nodeParent$ = $(nodeParent);
                            var strg=$(node).find('STRONG');
                            if(node.childNodes[0].nodeName==='LI' && $(node).find('STRONG').length >1)
                             {
                                $(node.children).each(function (){
                                        $(this).css("font-weight", "bold");
                                    });
                             }
                             else if(node.childNodes[0].nodeName==='LI' && $(node).find('STRONG').length ==0 ){                                 
                                    $(node.children).each(function (){
                                        $(this).css("font-weight", "normal");
                                    });
                             }
                             else if($(nodeParent).find('STRONG').length ==1)                            
                             {
                                    if(nodeParent.nodeName==='LI'){
                                    nodeParent$.css("font-weight", "bold"); 
                                    }
                             }
                             else if($(nodeParent).find('STRONG').length ==0)
                             {
                                nodeParent$.css("font-weight", "normal");

                             }

                      }

                });     

              }); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-10T15:57:20.247

由于 TinyMCE 将所有内容都包装在 span 中。为了避免像您遇到的问题，我这样做了：

```
<ol>
   <li style="font-size: <something you want>;">one</li>   
   <li style="font-size: <something you want>;">two</li>
</ol> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-26T11:00:34.883

以下是对我有用的，以上所有对我来说都失败了，因为需要测试而不是选择，但列表的开头应该基于选择的字体大小

```
editor.on('ExecCommand', function checkListNodes(evt) {
        var cmd = evt.command;
        var val = evt.value;
        var node = evt.target.selection.getNode();
        var nodeParent = node.parentNode;
        if (cmd === 'FontSize' || cmd === 'FontName') {
            if (node.nodeName === 'SPAN') {//(nodeParent.parentNode.nodeName === 'LI') 
{
                var whileNode = node;
                var count = 1;//dont want to be endless for with no list in editor
                while (whileNode.nodeName !== 'LI' && count<6) {
                    whileNode = whileNode.parentNode;
                    count++;
                }

                editor.dom.setStyle(nodeParent.parentNode, 'font-size', val);
            }
            else if (node.nodeName === 'UL' || node.nodeName === 'OL')
            {
                var li = editor.dom.select('li', node);
                if (cmd === 'FontSize') {
                    editor.dom.setStyle(li, 'font-size', val);
                }
                if (cmd === 'FontName') {
                    editor.dom.setStyle(li, 'font-family', val);
                }
            }
        }
        //if (cmd === 'InsertOrderedList' || cmd === 'InsertUnorderedList') {
        //    var fontSize = $("span.tox-tbtn__select-label:eq(1)").text().replace('pt', '');

        //}
    }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-01-19T10:01:58.283

我已经调整了史蒂夫的答案以在 Typescript 中使用，

```
editor.on('ExecCommand', function(lob) {
    contentBlockElement.text = editor.getContent({ format: 'raw' });
    var cmd = lob.command;
    if (cmd === "FontSize" || cmd === "FontName") {
        var val = lob.value;
        var node = lob.target.selection.getNode();
        var nodeChild = node.childNodes;
        if (node.nodeName === "UL" && nodeChild[0].nodeName === "LI") {
            this.nodeChild$ = $(nodeChild);
            this.nodeChild$.removeAttr('data-mce-style');
                if (cmd === "FontSize") {
                    this.nodeChild$.css('font-size', val);
                    }
                if (cmd === "FontName") {
                    this.nodeChild$.css('font-family', val);
            }
        }
    }
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-15T19:52:26.803

这对我有用

```
tinymce.init({
            init_instance_callback: function (editor) {
                editor.on('ExecCommand', function (e) {
                    var node = editor.selection.getNode();
                    if (node) {
                        var children = $(node).children("li");
                        if (children) {
                            children.removeAttr('data-mce-style');
                            children.css("font-size", e.value);
                        }
                    }
                });
            }
        }); 
```

# php - 要包含的 PHP 传递变量

> ID：11905140
> 
> 赞同：89
> 
> 时间：2012-08-10T15:50:10.720
> 
> 标签：php, variables, include, global-variables, global

我正在尝试将变量传递到*包含*文件中。我的主机更改了 PHP 版本，现在我尝试的任何解决方案都不起作用。

我想我已经尝试了我能找到的每一个选项。我相信这是最简单的事情！

该变量需要从调用的第一个文件中设置和评估（它实际上是`$_SERVER['PHP_SELF']`，并且需要返回该文件的路径，而不是包含的`second.php`）。

**选项一**

在第一个文件中：

```
global $variable;
$variable = "apple";
include('second.php'); 
```

在第二个文件中：

```
echo $variable; 
```

**选项二**

在第一个文件中：

```
function passvariable(){
    $variable = "apple";
    return $variable;
}
passvariable(); 
```

**选项三**

```
$variable = "apple";
include "myfile.php?var=$variable"; // and I tried with http: and full site address too.

$variable = $_GET["var"]
echo $variable 
```

这些都不适合我。PHP 版本是 5.2.16。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2017-08-08T08:48:26.293

您可以使用[extract() 函数](http://php.net/extract)
Drupal 在其 theme() 函数中使用它。

这是一个带有`$variables`参数的渲染函数。

```
function includeWithVariables($filePath, $variables = array(), $print = true)
{
    $output = NULL;
    if(file_exists($filePath)){
        // Extract the variables to a local namespace
        extract($variables);

        // Start output buffering
        ob_start();

        // Include the template file
        include $filePath;

        // End buffering and return its contents
        $output = ob_get_clean();
    }
    if ($print) {
        print $output;
    }
    return $output;

} 
```

**./index.php ：**

```
includeWithVariables('header.php', array('title' => 'Header Title')); 
```

**./header.php ：**

```
<h1><?php echo $title; ?></h1> 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-08-10T15:55:11.473

选项 3 是不可能的 - 您将获得 .php 文件的渲染输出，就像您在浏览器中点击该 url 一样。如果您得到原始 PHP 代码（如您所愿），那么您网站的所有源代码都将被公开，这通常不是一件好事。

选项 2 没有多大意义 - 您将变量隐藏在函数中，并受 PHP 变量范围的约束。您还必须在`$var = passvariable()`某个地方将“内部”变量传递到“外部”，然后您又回到了原点。

选项 1 是最实用的。`include()`基本上会在指定的文件中啜饮并在那里执行它，就好像文件中的代码实际上是父页面的一部分。它看起来确实像一个全局变量，这里的大多数人对此不以为然，但根据 PHP 的解析语义，这两者是相同的：

```
$x = 'foo';
include('bar.php'); 
```

和

```
$x = 'foo';
// contents of bar.php pasted here 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-10T15:59:13.370

考虑到最基本的 php 中的 include 语句从文件中获取代码并将其粘贴到您调用它的位置，并且 include 手册指出以下事实：

> 当一个文件被包含时，它包含的代码继承了包含发生的行的变量范围。从那时起，调用文件中该行的任何可用变量都将在被调用文件中可用。

这些事情让我觉得总有一个不同的问题。此外，选项 3 将永远不会起作用，因为您没有重定向到`second.php`您只是将其包含在内，而选项 2 只是一个奇怪的解决方法。php中include语句最基本的例子是：

```
vars.php
<?php

$color = 'green';
$fruit = 'apple';

?>

test.php
<?php

echo "A $color $fruit"; // A

include 'vars.php';

echo "A $color $fruit"; // A green apple

?> 
```

考虑到第一个选项最接近这个例子（即使它应该更复杂）并且它不起作用，它让我认为你在包含语句中犯了一个错误（相对于根或类似的错误路径问题）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-11-24T09:17:05.497

我这里有同样的问题，你可以使用 $GLOBALS 数组。

```
$GLOBALS["variable"] = "123";
include ("my.php"); 
```

它也应该这样做：

```
$myvar = "123";
include ("my.php");

....

echo $GLOBALS["myvar"]; 
```

祝你今天过得愉快。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-06-22T23:23:11.807

**选项 1**在 PHP 7 中对我有用，而且在 PHP 5 中肯定也有用。并且全局范围声明对于变量访问的包含文件不是必需的，包含 - 或“必需” - 文件是脚本的一部分，只需确保在变量声明之后进行“包含”。也许您的 PHP.ini 中的变量全局范围有一些错误配置？

在第一个文件中尝试：

```
 <?php 
  $myvariable="from first file";
  include ("./mysecondfile.php"); // in same folder as first file LOLL
  ?> 
```

我的第二个文件.php

```
 <?php 
  echo "this is my variable ". $myvariable;
  ?> 
```

它应该可以工作......如果它不只是尝试重新安装 PHP。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-08-10T15:57:51.577

关于OP的问题，特别是“需要从调用的第一个文件中设置和评估变量（它实际上是'$_SERVER ['PHP_SELF']'，并且需要返回该文件的路径，而不是包含的第二个文件。 php）。”

这将告诉您哪个文件包含该文件。将其放在包含的文件中。

```
$includer = debug_backtrace();
echo $includer[0]['file']; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-01-11T19:20:51.270

我遇到了这个问题，我有一个基于 GET 参数设置变量的文件。并且该文件无法更新，因为它在大型内容管理系统的另一部分上正常工作。然而，我想通过包含文件运行该代码，而参数实际上不在 URL 字符串中。简单的解决方案是您可以像设置任何其他变量一样在第一个文件中设置 GET 变量。

代替：

```
include "myfile.php?var=apple"; 
```

这将是：

```
$_GET['var'] = 'apple';
include "myfile.php"; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-08T18:06:22.210

根据 php 文档（参见[$_SERVER](http://www.php.net/manual/en/reserved.variables.server.php)） $_SERVER['PHP_SELF'] 是“当前执行脚本的文件名”。

INCLUDE 语句“包含并评估指定的”文件和“它包含的代码继承了包含发生的行的变量范围”（请参阅[​​ INCLUDE](http://www.php.net/manual/en/function.include.php)）。

我相信 $_SERVER['PHP_SELF'] 将返回第一个文件的文件名，即使在“second.php”中的代码使用时也是如此。

我使用以下代码对此进行了测试，它按预期工作（$phpSelf 是第一个文件的名称）。

```
// In the first.php file
// get the value of $_SERVER['PHP_SELF'] for the 1st file
$phpSelf = $_SERVER['PHP_SELF'];

// include the second file
// This slurps in the contents of second.php
include_once('second.php');

// execute $phpSelf = $_SERVER['PHP_SELF']; in the secod.php file
// echo the value of $_SERVER['PHP_SELF'] of fist file

echo $phpSelf;  // This echos the name of the First.php file. 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-11-14T13:00:59.450

我知道这是一个古老的问题，但现在偶然发现它并看到没有人提到这一点。所以写它。

如果像这样调整选项一，它也应该可以工作。

**原本的**

> **选项一**
> 
> 在第一个文件中：
> 
> ```
> global $variable; 
> $variable = "apple"; 
> include('second.php'); 
> ```
> 
> 在第二个文件中：
> 
> `echo $variable;`

**调整**

在第一个文件中：

```
$variable = "apple"; 
include('second.php'); 
```

在第二个文件中：

```
global $variable;
echo $variable; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-22T22:43:13.937

您可以在“second.php”中执行所有操作，使用 jQuery 添加变量

```
<div id="first"></div>

<script>
$("#first").load("second.php?a=<?php echo $var?>")
</scrpt> 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-07-21T19:23:31.750

我发现 include 参数需要是**整个**文件路径，而不是相对路径或部分路径才能正常工作。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2017-11-19T17:07:38.267

This worked for me: To wrap the contents of the second file into a function, as follows:

# firstFile.php

```
<?php
    include("secondFile.php");

    echoFunction("message"); 
```

# secondFile.php

```
<?php
    function echoFunction($variable)
    {
        echo $variable;
    } 
```

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2015-02-27T00:18:21.927

做这个：

```
$checksum = "my value"; 
header("Location: recordupdated.php?checksum=$checksum"); 
```

# java - 更改加密文件的 AES 密钥而不解密/重新加密它

> ID：11905142
> 
> 赞同：2
> 
> 时间：2012-08-10T15:50:13.413
> 
> 标签：java, encryption, cryptography, aes

我制作了一个在 JAVA 中加密和存储文件的应用程序。
我有很多使用 AES 加密的文件。
我有四个访问级别和四个密钥，我想用访问级别特定的密钥加密每个文件；我需要更改 KEY 以使用户能够更改文件的访问级别。
是否可以仅通过提供以前的密钥而不解密文件然后重新加密它们来更改此密钥？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T15:53:41.377

不，这是不可能的。您必须重新加密您的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T15:58:20.970

好吧，也许您可​​以拥有加密文件的常量密钥，该密钥将再次加密，您可以更改密钥？这样，只有必须再次解密和加密的东西才是您的密钥:)

这并不适用于每种情况，但有些地方应该可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T07:48:06.970

一种方法是*不*使用该“级别”的主密钥直接加密每个文件 - 相反，为每个文件生成一个不同的随机“文件密钥”并用它加密文件。然后，您使用级别密钥加密文件密钥，并将结果与​​文件一起存储。

当你想改变一个文件的级别时，你只需要对文件密钥进行解密和重新加密，而不是整个文件本身。

# javascript - addEventListener 在同步滚动 2 个 div 时无法在 Firefox 中工作

> ID：11905146
> 
> 赞同：2
> 
> 时间：2012-08-10T15:50:16.733
> 
> 标签：javascript, asp-classic, addeventlistener

我正在尝试同步屏幕上的 2 个 div，由于某种原因，它不适用于 Firefox。

我没有看到任何错误，它根本不起作用。我被难住了。它适用于所有其他浏览器。

如果有人可以提供帮助，我将不胜感激！

我已经包含了下面的*大部分*脚本......

CSS**样式表.css**：

```
#menuFrame
{
    BORDER-RIGHT: #cfcfcf 1px;
    BORDER-TOP: #cfcfcf 1px;
    FONT-SIZE: 8pt;
    LEFT: 164px;
    OVERFLOW: hidden;
    BORDER-LEFT: #cfcfcf 1px;
    WIDTH: 520px;
    BORDER-BOTTOM: #cfcfcf 1px;
    TOP: -50px;
    HEIGHT: 50px
}
#dataFrame
{
    BORDER-RIGHT: #cfcfcf 1px;
    BORDER-TOP: #cfcfcf 1px;
    LEFT: 164px;
    OVERFLOW: scroll;
    BORDER-LEFT: #cfcfcf 1px;
    WIDTH: 545px;
    BORDER-BOTTOM: #cfcfcf 1px;
    TOP: -318px;
    HEIGHT: 284px
} 
```

脚本**同步滚动.js**

```
// This is a function that returns a function that is used
// in the event listener
function getOnScrollFunction(oElement) 
{
try
{
    return function () 
    {
        if (oElement._scrollSyncDirection == "horizontal" || oElement._scrollSyncDirection == "both")
        oElement.scrollLeft = event.srcElement.scrollLeft;
        if (oElement._scrollSyncDirection == "vertical" || oElement._scrollSyncDirection == "both")
            oElement.scrollTop = event.srcElement.scrollTop;
};
}
catch(ex)
{
    alert ('Error getOnScrollFunction/n'+ ex.message)
}
}
// This function adds scroll syncronization for the fromElement to the toElement
// this means that the fromElement will be updated when the toElement is scrolled
function addScrollSynchronization(fromElement, toElement, direction) 
{
    try
    {
        removeScrollSynchronization(fromElement);
        fromElement._syncScroll = getOnScrollFunction(fromElement);
        fromElement._scrollSyncDirection = direction;
        fromElement._syncTo = toElement;
        //browser safe 
        if(toElement.attachEvent)
        {
            toElement.attachEvent("onscroll", fromElement._syncScroll);
        }
        else
        {
            toElement.addEventListener("scroll", fromElement._syncScroll,true);
        }
    }
    catch(ex)
    {
        alert ('Error addScrollSynchronization\n'+ ex.message)
    }
}

// removes the scroll synchronization for an element
function removeScrollSynchronization(fromElement) 
{
    try
    {
        if (fromElement._syncTo != null)
        {
            if(fromElement.detachEvent)
            {
                fromElement._syncTo.detachEvent("onscroll", fromElement._syncScroll);
            }
            else
            {
                fromElement._syncTo.removeEventListener("scroll", fromElement._syncScroll,true, false);
            }

            fromElement._syncTo = null;
            fromElement._syncScroll = null;
            fromElement._scrollSyncDirection = null;
        }
        catch(ex)
        {
            alert ('Error removeScrollSynchronization\n'+ ex.message)
        }
} 
```

HTML：

```
<html>
<head>
<META http-equiv="Content-Type" content="text/html">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1">
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=utf-8">
<link rel="stylesheet" href="Stylesheet.css" type="text/css">
<script type="text/javascript" src="syncscroll.js"/>
</HEAD>
<BODY bgcolor="#FFFFFF" onload="addScrollSynchronization(document.getElementById('menuFrame'), document.getElementById('dataFrame'), 'horizontal');">

<table class="PageLayout" align="center" border="0">
    <tr>
        <td class="DataCell">
            <div id="menuFrame">
                <table class="tblMenuframe">
                    <tr class="MenuFrameRow">
                        <td>Menu 1</td>
                        <td>Menu 2</td>
                        <td>Menu 3</td>
                    </tr>
                </table>
             </div>
         </td>
    </tr>
    <tr>
        <td class="DataCell">
            <div id="dataFrame">
                <table class="tblDataFrame">
                    <tr>
                        <td>Data 1</td>
                        <td>Data 2</td>
                        <td>Data 3</td>
                    </tr>
                </table
             </div>
         </td>
     </tr>
</table>
</body>
</html> 
```

[小提琴](http://jsfiddle.net/4h8T3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:32:22.390

这里：

```
return function ()  
{ 
    if (oElement._scrollSyncDirection == "horizontal" || oElement._scrollSyncDirection == "both") 
        oElement.scrollLeft = event.srcElement.scrollLeft; 
    if (oElement._scrollSyncDirection == "vertical" || oElement._scrollSyncDirection == "both") 
        oElement.scrollTop = event.srcElement.scrollTop; 
}; 
```

您正在使用`event`，但我认为 Firefox 没有这样的事件。考虑：

```
return function (ev)  
{
    var target =  ev && ev.target ? ev.target : event.srcElement;

    if (oElement._scrollSyncDirection == "horizontal" || oElement._scrollSyncDirection == "both") 
        oElement.scrollLeft = target.scrollLeft; 
    if (oElement._scrollSyncDirection == "vertical" || oElement._scrollSyncDirection == "both") 
        oElement.scrollTop = target.scrollTop; 
}; 
```

# python - TypeError: __init__() 只需要 1 个参数（给定 3 个）pyXML

> ID：11905148
> 
> 赞同：4
> 
> 时间：2012-08-10T15:50:35.610
> 
> 标签：python, xml, python-2.4, pyxml

我最近开始学习如何使用 python 来解析 xml 文件。我从[http://pyxml.sourceforge.net/topics/howto/node12.html获取了教程](http://pyxml.sourceforge.net/topics/howto/node12.html)

当我运行以下代码时，我收到错误：

```
Traceback (most recent call last):
  File "C:\Users\Name\Desktop\pythonxml\tutorials\pythonxml\pyxml sourceforge\5.1 Comic Colection\SearchForComic.py", line 30, in -toplevel-
    dh = FindIssue('sandman', '62')
TypeError: __init__() takes exactly 1 argument (3 given) 
```

**代码：**

```
from xml.sax import saxutils

class FindIssue(saxutils.DefaultHandler):
    def __init___(self, title, number):
        self.search_title, self.search_number = title, number

def startElement(self, name, attrs):
    #if it's not a comic element, ignore it
    if name!= 'comic': return

        # look for the title and number sttributes (see text)
        title = attrs.get('title', None)
        number = attrs.get('number', None)
        if (title == self.search_title and
            number == self.search_number):
                print title, '#' +str (number), 'found'

from xml.sax import make_parser
from xml.sax.handler import feature_namespaces

if __name__ == '__main__':
        #Create a parser
        parser = make_parser()

    #tell the parser that we are not interested in XML namespaces
        parser.setFeature(feature_namespaces, 0)

    #create the handler
    dh = FindIssue('sandman', '62')

    #tell the parse to use our handler
    parser.setContentHandler(dh)

    #parse the input
    parser.parse('collection.xml') 
```

同样在最后一行，我将文件传递到当前工作目录中，这是解决文件的正确方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T15:53:31.517

*_ init* _名下的 _ 太多了。你的构造函数的声明应该是：

```
def __init__(self, title, number): 
```

不是：

```
def __init___(self, title, number): 
```

注意额外的下划线符号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T15:54:15.000

你有一个错字 - 这里有 3 个下划线：

```
def __init___(self, title, number): 
```

应该：

```
def __init__(self, title, number): 
```

因为它与 name 不完全匹配`__init__`，Python 只知道默认构造函数`def __init__(self)`.

# eclipse - 用户安装我的 Eclipse 功能后，如何在首次启动时打开我的透视图

> ID：11905149
> 
> 赞同：4
> 
> 时间：2012-08-10T15:50:47.413
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我正在构建 Eclipse 插件并通过 p2 存储库将它们作为 Eclipse 功能提供。

我的一个插件通过 org.eclipse.ui.perspectives 扩展点贡献了自己的视角，并且工作正常。

一切都在顺利进行。

但我真正想要的是当用户在安装我的功能后首次启动他/她的 Eclipse 时打开我的视角。然后在第二次发布时，这种行为就消失了。我不想每次启动 Eclipse 时都打开我的视角来惹恼用户。

是否有捷径可寻？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:56:29.107

您可以在插件启动时以编程方式打开新透视图。[请参阅这篇Eclipse Corner 文章](http://www.eclipse.org/articles/using-perspectives/PerspectiveArticle.html)中的“打开一个新的透视图”部分。

# c# - 在图表控件中添加一个按钮

> ID：11905153
> 
> 赞同：3
> 
> 时间：2012-08-10T15:51:03.027
> 
> 标签：c#, asp.net

我想要一个放置在图表内的按钮，以将图表导出到 Excel 文件。我搞砸了 MapAreas，但我不知道如何将地图区域设置为图像或控件。有没有不同的方法来完成这个功能？该按钮需要以某种方式附加到图表上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:07:52.500

You need to understand that an ASP.NET chart control is just an image and when you create MapAreas you basically specify *clickable* spots on this image, therefore (as far as I know) a MapArea cannot have a custom background image or a custom control.

Instead use a custom legend:

**Source:**

```
 <asp:Chart ID="Chart1" runat="server" OnClick="Chart1_Click1">
        <Series>
            <asp:Series YValuesPerPoint="2" IsVisibleInLegend="false" Name="Series1" ChartType="Column">
                <Points>
                    <asp:DataPoint AxisLabel="Product 1" YValues="100" />
                    <asp:DataPoint AxisLabel="Product 2" YValues="300" />
                </Points>
            </asp:Series>
        </Series>
        <ChartAreas>
            <asp:ChartArea Name="ChartArea1">
            </asp:ChartArea>
        </ChartAreas>
        <Legends>
            <asp:Legend Title="Export options:">
                <CustomItems>
                    <asp:LegendItem
                    Name="Export To Excel" 
                    PostBackValue="Export From Legend"  
                    Color="Green">
                    </asp:LegendItem>
                </CustomItems>
            </asp:Legend>
        </Legends>
    </asp:Chart> 
```

**Code behind:**

```
protected void Chart1_Click1(object sender, ImageMapEventArgs e)
{
    if (e.PostBackValue == "Export From Legend")
    {
       //Handle the exporting to Excel
    }
} 
```

**End result:**

![enter image description here](../Images/d8d86917bd5b360716a998bccf23cf76.png)

# c# - 如何将 Json 数组设置为 Money？

> ID：11905154
> 
> 赞同：0
> 
> 时间：2012-08-10T15:51:03.343
> 
> 标签：c#, asp.net-mvc-3, money-format

我需要将此 197000.99996 更改为 $197,001

我知道我需要使用 {0:C}

但是当我使用数组时我不知道该怎么做，下面是代码

```
public ActionResult getAjaxSCs(string PA = null, float AmountList = 0)
        {

            if (PA != null)
            {

                var SCList = from x in db.NDE_Actuals_Web                             
                             where x.PA == PA                             
                             group x by new { x.SPEND_CATEGORY, x.ACCOUNTING_PERIOD} into scgroup                             
                             select new { spend_category = scgroup.Key.SPEND_CATEGORY, accounting_period = scgroup.Key.ACCOUNTING_PERIOD, amount = scgroup.Sum(x=> x.Amount)};

                SCList = SCList.OrderBy(x => x.spend_category);

                Dictionary<string, double[]> SCRow = new Dictionary<string, double[]>();
                double[] SCContent = new double[12];
                string lastSpendCategory = null;
                foreach (var item in SCList)
                {
                    if (lastSpendCategory != item.spend_category)
                    {
                        SCContent = new double[12];
                    }

                    int accounting_period = int.Parse(item.accounting_period) -1;
                    SCContent[accounting_period] = (double)item.amount;
                    SCRow[item.spend_category] = SCContent;
                    lastSpendCategory = item.spend_category;
                }

                return Json(SCRow, JsonRequestBehavior.AllowGet);

            }
            return View();
        } 
```

我需要转换 SCRow，以便它以货币格式发送值并舍入小数点。谢谢你的帮助！

# algorithm - 代码厨师解决方案

> ID：11905155
> 
> 赞同：0
> 
> 时间：2012-08-10T15:51:04.670
> 
> 标签：algorithm

我目前在 codechef做[这个问题。](http://www.codechef.com/AUG12/problems/HOMDEL/)

即使尝试了很多次，我也得到了“错误的答案”。由于它是一种竞争，我不想要任何直接的答案，但我只是想知道我的代码有什么问题。

```
#include <iostream>

using namespace std;
int T[260][260];
int num;
int main()
{
int i,j,I,ii,jj,o,c,b;
int S,G,D;
long long int M;
int dist[260][260];
int res1,res2,res3;
int tdis,mdis,dis;
cin>>num;
for(i=0;i<num;i++)
        {
                for(j=0;j<num;j++)
                {
                cin>>T[i][j];
                }
        }

 for (ii = 0; ii < num; ii++)
        for (jj = 0; jj < num; jj++)
            dist[ii][jj] = T[ii][jj];

  for (o = 0; o < num; o++)
    {

        for (b = 0; b < num; b++)
        {

            for (c = 0; c < num; c++)
            {

                if (dist[b][o] + dist[o][b] < dist[b][c])
                    dist[b][c] = dist[b][o] + dist[o][c];
            }
        }
    }          
cin>>M;
for(I=0;I<M;I++)
{
cin>>S;
cin>>G;
cin>>D;
res1=dist[S][G];
res2=dist[G][D];
tdis=res1+res2;
mdis=dist[S][D];
dis=tdis-mdis;
if(dis<0)
cout<<tdis<<" "<<0<<"\n";
else
cout<<tdis<<" "<<dis<<"\n";
}
return 0;
} 
```

实际上，我是新手，任何指导都会有所帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:12:22.020

实际上，在检查 dist[b][o]+dist[o][c] 时，您正在打错字（我想）

你写了 dist[b][o]+dist[o][b] ！！！

# jquery - 禁用 JStree JQUery 插件中的复选框

> ID：11905158
> 
> 赞同：1
> 
> 时间：2012-08-10T15:51:15.747
> 
> 标签：jquery, jstree

我有一个 jstree JQuery 插件，我使用它的“复选框”插件。我需要以编程方式选择复选框并以编程方式禁用复选框。

我怎么能这样做？

[https://groups.google.com/forum/?fromgroups#!topic/jstree/wLokkEg3eCY%5B1-25%5D](https://groups.google.com/forum/?fromgroups#!topic/jstree/wLokkEg3eCY%5B1-25%5D)这个我试过没有结果。

我的杰斯特里：

```
 var myTree = $(tree).jstree({
    "json_data": {
        "ajax": {
            type: "POST",
            async: true,
            "url": urlTree,
            // data: '{"longnames":"' + flag + '"}',

            data: function (n) {
                id = n.attr ? n.attr("id") : prefix + '0';
                reply = '{ id: "' + id + '"';
                //  if (dataJSON.length > 0) {
                //      reply = reply + ", " + dataJSON;
                //  }
                reply += ', longnames: "' + flag + '"';
                // reply += ", prefix: ";
                //  reply += (mutateIds != 1) ? '' : '"' + prefix + '"';
                reply += "}";

                return reply
            },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            cache: false,
            success: function (msg) {

                return msg.d.data;
            },
            error: function () {
                // process error of ajax
                return false;
            }
        },
        //  "xsl": "flat",

    },
    "search": {
        "show_only_matches": true,
        "search_method": "jstree_contains"
    },
    "types": {
        "max_children": -2,
        "max_depth": -2,
        "default": {
            "valid_children": ["default"],
            "select_node": function (e) {
                this.toggle_node(e);
                return false;
            } 
        },
        "disabled" : { 
                  "check_node" : false, 
                  "uncheck_node" : false 
                }  
    },
    "cookies": {
        "save_opened": false
    },
    "checkbox":{
         "override_ui": "true",
        "real_checkboxes": "true"
    },
    "plugins": pluginsToUse
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T04:09:01.073

要以编程方式检查节点，您需要做的就是：

```
$('#tree').jstree('check_node','#id'); 
```

这里#id 是节点的id。

# pointers - 是否可以在 fortran 的类型构造函数中使用指针？

> ID：11905169
> 
> 赞同：4
> 
> 时间：2012-08-10T15:52:00.323
> 
> 标签：pointers, constructor, fortran, fortran90, fortran95

在一些 Fortran 95 代码中，我有一个带有指针字段的类型。我想声明一个`type(foo)`在编译时初始化的模块变量。像这样的东西：

```
module foo_module
  implicit none
  type foo_type
     integer :: x
     logical, pointer :: x_flag => null()
  end type foo_type

  logical, target :: bar_flag
  ! this does not compile of course:
  type(foo_type) :: bar = foo_type(1, bar_flag)
end module foo_module 
```

上面的代码段无法编译。我知道我可以`bar`在运行时使用单独的子例程进行初始化，例如：

```
module foo_module
  implicit none
  type foo_type
     integer :: x
     logical, pointer :: x_flag => null()
  end type foo_type

  logical, target :: bar_flag
  type(foo_type) :: bar
contains
  subroutine init()
    bar%x = 1
    bar%x_flag => bar_flag
  end subroutine init
end module foo_module 
```

但是是否可以在没有初始化子程序的情况下做到这一点？或者是否可以声明一个由编译器显式调用的初始化子程序？注意：这必须在 Fortran 95 中完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T18:18:46.780

初始化器（在示例代码的第一个块中 bar 的声明中出现在等号之后的东西）必须是初始化（常量）表达式。Fortran 95 中的初始化表达式规则不允许在结构构造函数中使用 NULL() 以外的指针目标。

（此规则在 Fortran 2008 中被放宽，允许初始化表达式中结构构造函数中的指针目标是具有 save 属性的变量。）

请注意，您的 init 子例程可以使用结构构造函数，而不是分配给各个组件。使用该模块的客户端代码也可以使用结构构造函数直接执行对 bar 的赋值：`bar = foo_type(1, bar_flag)`. 问题不在于结构构造函数中指针目标的使用，而是指针目标在结构构造函数中出现*在必须是初始化表达式*的地方。

不能为派生类型声明初始化过程。（在 Fortran 2003 中可以有一个覆盖结构构造函数的函数，但这样的函数不能在初始化表达式中使用。）

# box-api - 使用强制参数删除文件夹不再起作用

> ID：11905172
> 
> 赞同：1
> 
> 时间：2012-08-10T15:52:15.933
> 
> 标签：box-api

我有一个利用 Box 的 API 的集成。我们实现的 API 调用之一是“删除文件夹”API。昨天我的电话工作正常，但发生了一些变化，并且 force 参数不再适用于删除包含内容的文件夹。

我的电话点击的 URL 是： [https ://www.box.com/api/2.0/folders/349215357?force=true](https://www.box.com/api/2.0/folders/349215357?force=true)

我收到的响应的 json 正文中的错误消息是：文件夹不为空

这是昨天工作的，所以从那时到现在发生了一些变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:52:40.177

该参数已更新为“递归”而不是“强制”以反映其实际功能。我们更新[了博客文章](http://developers.blog.box.com/2012/07/13/more-v2-updates/)和[文档](http://developers.box.com/docs/#folders-delete-a-folder)以反映这一点。

# c# - 如何克隆 ObservableCollection .CollectionChanged 事件？

> ID：11905173
> 
> 赞同：2
> 
> 时间：2012-08-10T15:52:15.720
> 
> 标签：c#, silverlight

我正在尝试将 ObservableCollection 复制到 ObservableCollection 派生类型中，并且我想保留 CollectionChanged 事件。

到目前为止，我有：

```
public class PartitionCollection : ObservableCollection<AislePartition>
{
    public PartitionCollection(ObservableCollection<AislePartition> other)
    : base(other)
    {

    }

    // ...

    protected override void InsertItem(int index, AislePartition item)
    {
         // Important custom logic runs here
         if (/* */)
             base.InsertItem(index, item);
         else
             Merge(item);
    }

    protected void Merge(AislePartition item)
    {
         // ...
    }
} 
```

它可以很好地复制集合，但我也需要获取 CollectionChanged 事件。

有什么办法吗？谢谢

编辑：

之前： ![在构造函数调用之前](../Images/d1c92e668424a3abcd2181db5830f0e3.png) 之后： ![在构造函数调用之后](../Images/295f0c6338c176c9d7430efaab3ed32b.png)

使用此特定构造函数的代码：

```
 private static void OnSourceChanged(DependencyObject obj, DependencyPropertyChangedEventArgs args)
    {
        AisleSelection aisleSelect = args.NewValue as AisleSelection;
        if (aisleSelect.Partitions == null)
            aisleSelect.Partitions = new PartitionCollection();
        else
            aisleSelect.Partitions = new PartitionCollection(aisleSelect.Partitions);
    ...
    } 
```

基本上我想要做的是用我的 PartitionCollection 替换 ObservableCollection ，它覆盖了一些关键成员。ObservableCollection 是从服务器以序列化形式传递给我的，所以我无法直接使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:03:19.087

如果我正确理解您的问题，您想用另一个替换可观察集合，但您仍然希望在新集合更改时通知旧集合上的事件的订阅者。

如果这是正确的，那么您想要的是将旧集合与新集合保持同步。新集合应保留对旧（源）集合的引用，并且每当修改新集合时，您对旧集合执行相同的修改。

在调用新集合中方法的基类实现后，`PartitionCollection`您可以覆盖`ClearItems`、和转发对旧集合的更改。这应该保持同步。`InsertItem``RemoveItem``SetItem`

如果您绝对只想要一个集合的单一副本，您可以从中派生`PartitionCollection`并`IObservableCollection<AislePartition>`为您提供自己的接口实现。这个集合的后备存储应该是旧集合。这个解决方案非常乏味，因为您必须实现许多方法，这些方法只是转发到包装集合上的相同方法，但您要确保不复制集合。

如果可以通过包装器以外的其他方式修改旧集合，您将必须订阅旧集合的更改并从包装器触发类似事件。

如果你真的想的话，有一些[“邪恶”的技巧](https://stackoverflow.com/a/1639769/98607)可以让你访问旧集合的调用列表。但是，在这样做之前我会三思而后行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:09:49.237

您不能只将事件处理程序从一个对象复制到另一个对象，因为事件仅提供两种方法来添加处理程序和删除处理程序......换句话说，您不能枚举处理程序并将它们添加到新对象事件.

我的建议是对旧对象进行弱（或强）处理，并提供一个内部事件处理程序，该处理程序首先调用事件的所有订阅者，然后在提供的对象上调用事件。

请记住，如果您使用强引用，只要当前对象处于活动状态，旧对象就会保持活动状态，因此可能会导致内存泄漏或内存使用过多。

# wpf - DataGrid 文本自动滚动

> ID：11905175
> 
> 赞同：1
> 
> 时间：2012-08-10T15:52:21.433
> 
> 标签：wpf, text, datagrid, autoscroll

在 DataGrid 中，有一个 CheckBoxColumn 和一个 TextColumn，它们显示文件路径：

```
|   |                              |
| x |C:\docs\etc\somefile.txt      |
|   |C:\programs\misc\files\2.0\oth|   <- cut off, too long
| x |                              | 
```

我希望长字符串滚动到末尾，以便用户可以看到文件名：

```
|   |                              |
| x |..misc\files\2.0\otherfile.zip|
|   |                              | 
```

有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:26:34.477

另一种解决方案可能是在列模板中使用文本块。将 texttrimming 设置为省略号，并将长文本放在 tooltip 属性中。[http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock.texttrimming.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock.texttrimming.aspx)

如果您真的希望像示例中那样将省略号放在左侧，则可能需要在测量后执行一些代码，请参阅[适合特定宽度的字符串长度](https://stackoverflow.com/questions/4542717/length-of-string-that-will-fit-in-a-specific-width)

# c# - 使用参数执行查询

> ID：11905185
> 
> 赞同：13
> 
> 时间：2012-08-10T15:53:07.757
> 
> 标签：c#, .net, sql

我想`.sql`从 C# 执行一个脚本。基本上，该脚本将一行插入到几个不同的表中。

关键是我在 C# 代码中有需要传递给`.sql`查询的值。这些值将在程序执行期间收集。

这是我想从 C# 代码执行的查询：

```
INSERT INTO [DB].[dbo].[User]
           ([Id]
           ,[AccountId]
           ,[FirstName]
           ,[LastName]
           ,[JobTitle]
           ,[PhoneNumber]
          )
     VALUES
           ('00A640BD-1A0D-499D-9155-BA2B626D7B68'
           ,'DCBA241B-2B06-48D7-9AC1-6E277FBB1C2A'
           ,'Mark'
           ,'Wahlberg'
           ,'Actor'
           ,'9889898989'])
GO 
```

这些值会不时变化，即它们是在 C# 代码中捕获的并且需要传递。

谁能帮我做到这一点..我正在学习 C# 和 SQL。非常感谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-10T15:57:31.093

您可以在这里打开自己的[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)，因此最佳做法是使用参数：

```
using (SqlConnection dbConn = new SqlConnection(connectionString))
{
    dbConn.Open();

    using (SqlTransaction dbTrans = dbConn.BeginTransaction())
    {
        try
        {
            using (SqlCommand dbCommand = new SqlCommand("insert into [DB].[dbo].[User] ( [Id], [AccountId], [FirstName], [LastName], [JobTitle], [PhoneNumber] ) values ( @id, @accountid, @firstname, @lastname, @jobtitle, @phonenumber );", dbConn))
            {
                dbCommand.Transaction = dbTrans;

                dbCommand.Parameters.Add("id", SqlType.VarChar).Value = id;
                dbCommand.Parameters.Add("accountid", SqlType.VarChar).Value = accountId;
                dbCommand.Parameters.Add("firstname", SqlType.VarChar).Value = firstName;
                dbCommand.Parameters.Add("lastname", SqlType.VarChar).Value = lastName;
                dbCommand.Parameters.Add("jobtitle", SqlType.VarChar).Value = jobTitle;
                dbCommand.Parameters.Add("phonenumber", SqlType.VarChar).Value = phoneNumber;

                dbCommand.ExecuteNonQuery();
            }

            dbTrans.Commit();
        }
        catch (SqlException)
        {
            dbTrans.Rollback();

            throw; // bubble up the exception and preserve the stack trace
        }
    }

    dbConn.Close();
} 
```

这是一篇适合[ADO.Net 初学者的好文章](http://www.codeproject.com/Articles/8477/Using-ADO-NET-for-beginners)

**编辑**- 作为一些额外的信息，我已经向它添加了一个[事务](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx)，所以如果 SQL 命令失败，它将回滚。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T16:01:01.800

```
 using SqlCommand cmd= conn.CreateCommand())
    {
                        cmd.CommandText = @"INSERT INTO TABLE (COLUMNS) VALUES (@Id, @account etc...

                        cmdUser.Parameters.Add(new SqlParameter("@User", SqlDbType.UniqueIdentifier) { Value = UserTypeID });
                        cmdUser.Parameters.Add(new SqlParameter("@Id", SqlDbType.UniqueIdentifier) { Value = ApprovalTypeID });
                        cmdUser.Parameters.Add(new SqlParameter("@AccountId", SqlDbType.UniqueIdentifier) { Value = UserID });
                        cmdUser.Parameters.Add(new SqlParameter("@FirstName", SqlDbType.NVarChar, 100) { Value = Name });
                        cmdUser.Parameters.Add(new SqlParameter("@JobTitle", SqlDbType.NVarChar, 100) { Value = Surname });
                        cmdUser.Parameters.Add(new SqlParameter("@PhoneNumber", SqlDbType.Bit) { Value = Active });
    cmdUser.ExecuteNonQuery();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T16:08:51.107

```
 try
        {
            using (SqlConnection cn = new SqlConnection(this.ConnectionString))
            {
                SqlCommand cmd = new SqlCommand("Insert_User", cn);
                cmd.CommandType = CommandType.StoredProcedure;
                if (cn.State != ConnectionState.Open)
                    cn.Open();
                cmd.Parameters.Add("Id", SqlDbType.NVarChar).Value = "00A640BD-1A0D-499D-9155-BA2B626D7B68";
                cmd.Parameters.Add("AccountId", SqlDbType.NVarChar).Value = "DCBA241B-2B06-48D7-9AC1-6E277FBB1C2A";
                cmd.Parameters.Add("FirstName", SqlDbType.NVarChar).Value = "Mark";
                cmd.Parameters.Add("LastName", SqlDbType.NVarChar).Value = "Wahlberg";
                cmd.Parameters.Add("JobTitle", SqlDbType.NVarChar).Value = "Actor";
                cmd.Parameters.Add("PhoneNumber", SqlDbType.NVarChar).Value = "9889898989";

                return cmd.ExecuteNonQuery();
            }
        }
        catch (Exception ex)
        {
            throw new Exception(ex.Message);
        } 
```

对于存储过程，在 sql 中：

```
 create procedure [Insert_User]
(
@id as nvarchar(100),
@accid as nvarchar(100),
@fname as nvarchar(100),
@lname as nvarchar(100),
@jobtitle as nvarchar(100),
@phone as nvarchar(100)
)
    INSERT INTO [DB].[dbo].[User]
               ([Id]
               ,[AccountId]
               ,[FirstName]
               ,[LastName]
               ,[JobTitle]
               ,[PhoneNumber]
              )
         VALUES
               (@id
               ,@accid
               ,@fname
               ,@lname
               ,@jobtitle
               ,@phone]) 
```

此外，您可以使用文本框或其他输入类型控件来设置值。您可以根据需要更改数据类型，例如`uniqueidentifier`,`int`等。如果一个或多个值设置为 identifire，例如。AccountID，从查询中删除它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-06T12:14:42.813

坦率地说，ADO.NET 很难正确地做这样的事情。存在像[Dapper这样的工具可以](https://www.nuget.org/packages/Dapper/)*使这更容易*：

```
dbConn.Execute(
     @"insert into [DB].[dbo].[User] ( [Id], [AccountId], [FirstName], [LastName],
                                       [JobTitle], [PhoneNumber] )
       values ( @id, @accountId, @firstName, @lastName, @jobTitle, @phoneNumber )",
       new { id, accountId, firstName, lastName, jobTitle, phoneNumber }); 
```

*这将为您*高效、有效和安全地处理所有参数化。

有类似的 API 用于执行查询和填充对象。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-10T16:00:42.513

你需要`System.Data.SqlCommand`上课。

将固定值更改为命名参数。例如：

INSERT INTO [TABLE] (Column1) values (@Value1) // @Value1 是命名参数

例子：

```
var connection = new SqlConnection("connectionstring");
var command = connection.CreateCommand();
command.CommandText = "insert...."; // sql command with named parameters

// set the named parameter values
command.Parameters["@Value1"] = "Mark wa...";

// execute 
command.ExecuteNonQuery(); 
```

SqlCommand 参考：http: [//msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)

# eclipse - 是否可以将 Mylyn 任务从本地存储库迁移到 Bugzilla？

> ID：11905187
> 
> 赞同：1
> 
> 时间：2012-08-10T15:53:13.297
> 
> 标签：eclipse, bug-tracking, bugzilla, mylyn, connector

[我刚刚在bugheaven.com](http://www.bugheaven.com)上设置了一个免费的 Bugzilla 帐户，并希望将我现有的本地 Mylyn 存储库任务迁移到 Bugzilla。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:42:23.113

没有可用的批量复制，但您可以从任务列表视图的弹出菜单中使用新建/克隆任务...。

# python - 从一个列表指向一个字典变量

> ID：11905188
> 
> 赞同：3
> 
> 时间：2012-08-10T15:53:19.007
> 
> 标签：python, python-2.7, python-2.6, python-2.x

假设你有一个列表

```
a = [3,4,1] 
```

我想用这些信息指向字典：

```
b[3][4][1] 
```

现在，我需要的是例行公事。在我看到值之后，在 b 的位置读取和写入一个值。

我不喜欢复制变量。我想直接更改变量 b 的内容。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-10T15:55:10.957

假设`b`是一个嵌套字典，你可以做

```
reduce(dict.get, a, b) 
```

访问`b[3][4][1]`.

对于更一般的对象类型，请使用

```
reduce(operator.getitem, a, b) 
```

写入值有点复杂：

```
reduce(dict.get, a[:-1], b)[a[-1]] = new_value 
```

所有这一切都假设您现在没有`a`提前知道元素的数量。如果你这样做，你可以选择[neves 的回答](https://stackoverflow.com/a/11905238/1590392)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:02:38.627

这将是基本算法：

要获取项目的值：

```
mylist = [3, 4, 1]
current = mydict
for item in mylist:
    current = current[item]
print(current) 
```

要设置项目的值：

```
mylist = [3, 4, 1]
newvalue = "foo"

current = mydict
for item in mylist[:-1]:
    current = current[item]
current[mylist[-1]] = newvalue 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T15:56:57.197

假设列表长度是固定的并且已知

```
a = [3, 4, 1]
x, y, z = a
print b[x][y][z] 
```

你可以把它放在一个函数中

# esri - Esri ArcObjects - Esri.ArcGIS.Version 程序集

> ID：11905189
> 
> 赞同：2
> 
> 时间：2012-08-10T15:53:27.970
> 
> 标签：esri, arcobjects, arcmap

这是一个长镜头，最近有人用过 Esri ArcObjects 吗？

根据文档：

一个新的要求是运行时绑定。运行时绑定是指在调用任何 ArcObjects 代码（包括许可初始化）之前定位独立 ArcGIS Desktop 或 Engine 应用程序的相应 ArcGIS 产品安装。用于建立运行时绑定的应用程序编程接口 (API) 位于 ESRI.ArcGIS.Version 程序集的 ESRI.ArcGIS.RuntimeManager 类中

但我在任何地方都找不到 ESRI.ArcGIS.Version.dll。我有 ArcMap 10.1 的试用版。有谁知道我怎样才能得到这个DLL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T07:44:17.337

ArcObjects 是 ArcGIS API，不是 ArcMap 的一部分。您可以使用它来使用 ArcMap 的引擎构建 GIS 应用程序，但您需要的不仅仅是 ArcMap。不幸的是，获得 ArcObjects 需要花钱——您正在寻找的是 ArcGIS Engine：

[http://www.esri.com/software/arcgis/edn/what-you-get](http://www.esri.com/software/arcgis/edn/what-you-get)

当然，这取决于您想要做什么——如果您想在 ArcMap 中进行一些自定义编码，您可以使用 ArcPy 来完成：

[http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//000v00000001000000](http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//000v00000001000000)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-25T04:25:24.753

你在使用 Visual Studio 吗？如果是这样，您需要在项目引用窗口中添加对 ESRI.ArcGIS.Version 的引用。单击“添加引用”时，它将位于“.Net”选项卡下。

# android - 在 Android Gallery 控件上监听动画结束

> ID：11905193
> 
> 赞同：1
> 
> 时间：2012-08-10T15:53:35.943
> 
> 标签：android, android-layout, android-animation

我有一个标准的 Android Gallery 控件：

```
<Gallery
    android:id="@+id/galArt"
    android:spacing="10dp"
    android:fadingEdgeLength="0dp"
    android:unselectedAlpha="1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" /> 
```

我从中使用以下代码收听事件：

```
galArt.setOnItemSelectedListener(new OnItemSelectedListener() {
        public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
            showMessageToast("Selected: " + pos);           
        }
        public void onNothingSelected(AdapterView<?> arg0) {}
    }); 
```

我猜它的目的是这样的：当我滑动图像时，我会得到一个祝酒词，告诉我现在选择了哪个图像。

但是，这个 toast 出现*在*图像停止滑动之前，而动画仍在运行。我想在它停止滑动*后采取行动，以避免中断动画。*

动画完成后，为了获得通知，我可以听什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T20:54:55.697

好吧，我找到了解决方案。请注意，这只是*一个*解决方案，不一定是*最佳*解决方案。

我的解决方案是忽略所有逻辑事件（如 onScroll 或 onAnimationEnd，因为我无法让它们中的任何一个工作），并监听子视图位置的变化。当子视图静止时，动画就结束了。

这样做的一个实际好处是它适用于拖动和投掷。

一个问题是 onItemSelected 函数将从您的 UI 线程之外的另一个线程调用。通过使用活动的 runOnUIThread 函数来解决这个问题，如示例中所示。

监听变化的方式（注意这不是常规的**onItemSelected**函数，而是我自己的**onItemReallySelected**）：

```
galArt.setOnItemReallySelectedListener(new OnItemSelectedListener() {
    public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
            _activity.runOnUiThread(new Runnable() {
                public void run() {
                    //Do your stuff here ...
                }
            });
    }
    public void onNothingSelected(AdapterView<?> arg0) {
        //... or here.
    }
}); 
```

我的 Android Gallery 的实现：

```
import java.util.Timer;
import java.util.TimerTask;

import android.content.Context;
import android.util.AttributeSet;
import android.util.Log;
import android.view.MotionEvent;
import android.widget.Gallery;

public class ArtGallery extends Gallery {

    OnItemSelectedListener _listener;
    Timer _timer = new Timer();

    public ArtGallery(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public ArtGallery(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public ArtGallery(Context context) {
        super(context);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if(event.getAction()==MotionEvent.ACTION_UP){
            setTimer();
        }
        return super.onTouchEvent(event);
    }

    private int _lastScrollX = Integer.MIN_VALUE;
    private void setTimer() {
        //Cancel existing tasks (if any), and create a new timer.
        _timer.cancel();
        _timer = new Timer();

        //Schedule our animation check.
        _timer.schedule(new TimerTask() {
            @Override
            public void run() {
                //Just some value that will change while the animation is running.
                int x = getSelectedView().getLeft(); 
                if(_lastScrollX != x){
                    //Value has changed; save current value, and reset the timer.
                    _lastScrollX = x;
                    setTimer();
                }else{
                    //The value hasn't changed during the last 50ms. That probably means that the animation has stopped.
                    fireOnSelected();
                }
            }
        }, 50); 
    }

    public void setOnItemReallySelectedListener(OnItemSelectedListener listener){
        _listener = listener;
    }

    //This function is copied from the Android Gallery source code, and works exactly like the original one.
    private void fireOnSelected() {
        if (_listener == null)
            return;

        int selection = this.getSelectedItemPosition();
        if (selection >= 0) {
            _listener.onItemSelected(this, getSelectedView(), selection, getAdapter().getItemId(selection));
        } else {
            _listener.onNothingSelected(this);
        }

    }
} 
```

# javascript - 在 Google Charts LineChart 中绘制多个数据表

> ID：11905197
> 
> 赞同：2
> 
> 时间：2012-08-10T15:53:57.013
> 
> 标签：javascript, google-visualization

我正在使用来自 Google Charts API 的 LineChart，我想绘制两组数据 - 一组是观察结果，一组是模型输出。问题是模型输出在时间上是有规律的（每小时），但观察结果可能是零星的，并且通常与模型时间不一致。

我不能将它们都作为列存储在一个 DataTable 中，因为它们不是临时并置的，所以我需要 2 个数据表，但我不能让 LineChart 接受多个数据表！

有没有解决的办法？

TIA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-28T16:13:35.887

最好的方法是组合 DataFrame 并在未定义值的地方留下 NULL。在您的情况下，每一行最终都会有一个定义的值和一个空值。

然后，当您绘图时，将 interpolateNulls 设置为 True，它将通过 NULL 连接点，这应该为您提供所需的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T14:52:32.823

首先，您必须将数据放入一个 DataTable。没有办法从多个 DataTable 或 DataView 创建图表，或从多个 DataTable 创建 DataView（尽管有这样的[请求](https://groups.google.com/forum/?fromgroups=#!topic/google-visualization-api/UqBrGAeuiT0)）。如何将数据放入一个 DataTable 取决于您。看起来任何[数据操作方法](https://developers.google.com/chart/interactive/docs/reference#google_visualization_data)都没有帮助。

好消息是，一旦将所有数据都放在一个 DataTable 中，即使数据集未在同一时间值对齐，您也可以绘制它。只需使用[数据角色](https://developers.google.com/chart/interactive/docs/roles)指定多个域列。在该页面上搜索“多域”以查找示例。

# ios - iOS SDK retine 图像与为较小的占位符使用更大的图像

> ID：11905198
> 
> 赞同：0
> 
> 时间：2012-08-10T15:54:02.193
> 
> 标签：ios, ios5, retina-display

如果我使用大图像（即 20x20 占位符中的 40x40 图像或视网膜的@2x 图像）是否相同？

我的意思是，我有两个选择： - 使用 20x20 image.png 和 40x40 image@2x.png - 使用 40x40 image.png

是一样的吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:10:52.583

仅使用视网膜图像并将非视网膜设备上的缩小留给系统是可能的，但在所有情况下都不推荐。

这实际上取决于图形的内容。例如，如果您使用基于矢量图的图形作为源（锐线等），那么仅提供视网膜图像将导致在非视网膜显示器上出现水洗、模糊的图像。

同样，如果您的内容看起来仍然足够好，这是可能的并且完全没问题。

# c++ - 在 C++ 中使用 NEW 和不使用它有什么区别

> ID：11905203
> 
> 赞同：2
> 
> 时间：2012-08-10T15:54:44.673
> 
> 标签：c++, allocation

和有什么区别

```
Kwadrat* k1 = new Kwadrat(1,2,3);
k1->field = 0;
Kwadrat k2(1,2,3);
k2.field = 0; 
```

第一个是指向分配内存的指针，第二个是对象（它在哪里，在系统堆栈上？）为什么第二个更糟？我们什么时候用第一个，什么时候用第二个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T15:56:36.723

堆上的动态分配（使用`new`）：
`Kwadrat* k1 = new Kwadrat(1,2,3);`
在堆栈上创建对象（不使用`new`）：
`Kwadrat k2(1,2,3);`

查看[这个 Stack Overflow 问题](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)，了解有关堆栈和堆的扩展讨论。[Brian R. Bondy 的回答](https://stackoverflow.com/a/79936/498705)很好地比较了两者，而[Jeff Hill 的回答](https://stackoverflow.com/a/80113/498705)为您提供了更多细节。

对于一个危险的小总结：

*   您必须`delete`使用您创建的对象`new`，否则您的代码将遭受内存泄漏
*   您不必担心手动删除在堆栈上创建的对象，因为 C++[资源分配是初始化 (RAII)](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)会为您处理这些
*   如果您尝试非常大的分配，堆栈可能会溢出。
*   至于你应该使用哪一个，这取决于你正在创建的对象的预期范围

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T15:57:39.410

使用 new在*堆上**动态创建*一个对象，这意味着即使指针 (k1*) 超出范围，它也会持续存在。

 *这可能很方便，但是如果它超出范围并且您没有在它周围保留指针的副本，则会永久丢失并导致**内存泄漏**。这意味着只要程序执行，您就会失去该资源使用的空间。这是使用 new 动态分配内存的缺点，您必须跟踪它并使用 delete 运算符手动释放它，这需要额外的工作。

以另一种方式执行此操作会创建一个堆栈对象，该对象一旦离开范围就会被销毁，这通常是可取的。

通常，当使用 new 动态创建内存时，人们通过将动态创建的对象包装在另一个对象中来获得这种类似堆栈的功能，当它超出范围时会销毁它。这种模式称为**资源获取即初始化 (RAII)**。这对于引用计数最有用，因此您的对象仍然可以在范围之外持久化，但是当不再引用它们时将被销毁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T15:57:03.360

new 在堆上分配一个对象。您的第二个示例在堆栈上分配内存。一旦分配 k2 的函数返回，内存将不再有效（当然首先调用 k2 的析构函数）。如果您希望对象比创建它的函数寿命更长，则需要使用 new。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T15:57:48.363

`new`允许您为请求的分配指定存储。分配 via`new/new[]`通常在堆上（例如 wrapping `malloc`），但最终由实现定义。同样，在某些情况下，编译器可能有足够的信息来绕过它。

> 它在哪里，在系统堆栈上？

从技术上讲，您通常会将 C++ 编写到抽象机器的规范中。

但通常，是的 - 对象是在线程的堆栈上分配的。

> 为什么第二个更糟糕？什么时候用第一个，什么时候用第二个？

第二个应该是您的默认值，因为它非常清楚，编译器会为您管理其生命周期和分配，而且速度也非常快。一些例外情况包括：

*   当您有大量分配时（堆栈大小相对较小）
*   有时当您想与另一个线程共享分配时
*   当您想将分配传递给另一个线程时
*   当您希望对象超出方法的范围时，您通常会使用智能指针或其他容器来正确删除对象。

简而言之，可能出错的情况要少得多（使用第二个），并且通过通用系统分配器创建分配所花费的时间要少得多。*

# python - 如何过滤相关对象中的字段？

> ID：11905206
> 
> 赞同：5
> 
> 时间：2012-08-10T15:55:04.597
> 
> 标签：python, django, django-models, tastypie

如果我尝试过滤相关对象中的字段，那么 Tastypie 会返回错误。例如，运行

```
curl -H "Accept: application/json" \
     "http://localhost:8080/wordgame/api/v1/rounds/?format=json&players__username=moe" 
```

返回“在 '玩家' 字段中的查找不允许超过一层。” 本质上，我正在尝试做我目前在 Django shell 中可以做的事情：

```
Round.objects.all().filter(players__username=moe.username) 
```

我正在使用以下代码，为简洁起见，我对其进行了简化：

```
# wordgame/api.py which has tastypie resources
class RoundResource(ModelResource):
    players = fields.ManyToManyField(UserResource, 'players',full=True)
    . . .

    class Meta:
        queryset = Round.objects.all()
        resource_name = 'rounds'
        filtering = {
            'players': ALL,
        }

class UserResource(ModelResource):
    class Meta:
        queryset = User.objects.all()
        resource_name = 'players'
        filtering = {
            'username': ALL,
        }

# wordgame/models.py which has Django models
class Round(models.Model):
    players = models.ManyToManyField(User)
    word = models.CharField(max_length=75)
    . . . 
```

我假设因为 UserResource 在“用户名”字段上定义了一个过滤器，所以这应该可以工作，但它没有。我什至尝试将“players__username”添加到 RoundResource 的过滤器中，但这也不起作用。

我在文档中阅读了有关[基本过滤的](http://django-tastypie.readthedocs.org/en/latest/resources.html#basic-filtering)信息，并查看了 GitHub 上的代码，但似乎没有任何内容。我还查看了[高级过滤文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#advanced-filtering)，它似乎不适合我的用例。我已经查看了 GitHub 上的 Tastypie 代码，但对它的理解还不够，无法确定是 1）我做错了，还是 2）要覆盖什么才能使其正常工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-10T19:04:51.937

显然，您需要专门将您的`filtering`行中的关系跨越查找列入白名单，如下所示：

```
class UserResource(ModelResource):
    class Meta:
        queryset = User.objects.all()
        resource_name = 'players'
        filtering = {
            'username': ALL_WITH_RELATIONS,
        } 
```

至少，我*认为*这是放置它的正确位置。[相关文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#basic-filtering)的示例相当少。不过，一张 Tastypie 票[表明这应该可行](http://django-tastypie.readthedocs.org/en/latest/resources.html#basic-filtering)。

# c# - 如何在 xaml 页面中为 wp7 的浏览器控件创建和存储历史列表

> ID：11905219
> 
> 赞同：0
> 
> 时间：2012-08-10T15:55:48.430
> 
> 标签：c#, windows-phone-7

我一直在为 wp7 开发浏览器应用程序。我想我会为我的应用程序添加一些额外的功能。所以，我想我会为我的应用程序创建一个历史页面。但是我是独立存储的新手，我不知道如何将历史记录保存在新的 page.xaml 中，而且我想查看和访问它，就像我点击任何历史记录一样，它应该重定向到该页面。任何人都可以帮助我，因为我对这些东西很陌生。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T11:58:40.333

`Stack`在 app.xaml.cs 中创建一个对象让我们说`WebHistory`。

`Stack<Uri> WebHistory = new Stack<Uri>();`

现在处理浏览器控件的 LoadCompleted 事件。

在加载完成事件处理程序调用`App.WebHistory.Push(e.Uri);`

您可以将其绑定到要显示链接的列表。并点击链接将浏览器导航到该特定链接。

我希望这有帮助

# java - 为什么 JMX 报告的 JVM Heap Usage Max 会随时间变化？

> ID：11905220
> 
> 赞同：10
> 
> 时间：2012-08-10T15:55:49.297
> 
> 标签：java, jvm, heap-memory

我的 JVM 堆最大值在我的一个 hadoop 集群的名称节点上配置为 8GB。当我使用 JMX 监控 JVM 时，报告的最大值不断波动，如附图所示。

[http://highlycaffeinated.com/assets/images/heapmax.png](http://highlycaffeinated.com/assets/images/heapmax.png)

我只在我的一个（最活跃的）hadoop 集群上看到这种行为。在其他集群上，报告的最大值固定在配置的值。任何想法为什么报告的最大值会改变？

**更新：**

java版本是“1.6.0_20”

堆最大值在 hadoop-env.sh 中使用以下行设置：

`export HADOOP_NAMENODE_OPTS="-Xmx8G -Dcom.sun.management.jmxremote.port=8004 $JMX_SHARED_PROPS"`

ps显示：

`hadoop 27605 1 99 Jul30 ? 11-07:23:13 /usr/lib/jvm/jre/bin/java -Xmx1000m -Xmx8G`

**更新 2：**

`-Xms8G`昨晚在启动命令行中添加了开关：

`export HADOOP_NAMENODE_OPTS="-Xms8G -Xmx8G -Dcom.sun.management.jmxremote.port=8004 $JMX_SHARED_PROPS"`

如下图所示，尽管模式似乎发生了变化，但最大值仍然不同。

[http://highlycaffeinated.com/assets/images/heapmax2.png](http://highlycaffeinated.com/assets/images/heapmax2.png)

**更新 3：**

这是一个新图表，它还显示了非堆最大值，它保持不变：

[http://highlycaffeinated.com/assets/images/heapmax3.png](http://highlycaffeinated.com/assets/images/heapmax3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:36:07.690

根据[MemoryMXBean](http://docs.oracle.com/javase/6/docs/api/java/lang/management/MemoryMXBean.html)文档，内存使用情况分为两类，“堆”和“非堆”内存。非堆类别的描述说：

> Java 虚拟机管理堆以外的内存（称为非堆内存）。Java 虚拟机有一个在所有线程之间共享的方法区。方法区属于非堆内存。它存储每个类的结构，例如运行时常量池、字段和方法数据，以及方法和构造函数的代码。它是在 Java 虚拟机启动时创建的。
> 
> 方法区在逻辑上是堆的一部分，但 Java 虚拟机实现可以选择不进行垃圾收集或压缩它。与堆类似，方法区可以是固定大小的，也可以是扩展和收缩的。方法区的内存不需要是连续的。

这个描述听起来很像永久代（PermGen），它确实是堆的一部分，并计入使用`-Xmx`标志分配的内存。我不确定他们为什么决定单独报告这个，因为它是堆的一部分。

我怀疑您看到的波动是 JVM 缩小和增长永久代的结果，这将导致报告的可用于非 PermGen 的最大堆空间相应地发生变化。如果您可以获得 JMX 报告的堆和非堆最大值的总和，并且该总和在 8G 限制下保持不变，那将验证这个假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T09:59:24.190

One possibility is that the JVM survivor space is fluctuating in max-size.

The JVM max-size reported by JMX via the HeapMemoryUsage.max attribute is not the actual max-size of the heap (i.e. the one set with -Xmx )

The reported value is the max heap size minus the max survivor space size

To get the total max heap size, add the two jmx attributes:

```
java.lang:type=Memory/HeapMemoryUsage.max + java.lang:type=MemoryPool,name=Survivor Space/Usage.max 
```

(tested on oracle jdk 1.7.0_45)

# zend-framework - Zend 框架和 APC 缓存 CLI 访问

> ID：11905221
> 
> 赞同：0
> 
> 时间：2012-08-10T15:55:50.677
> 
> 标签：zend-framework, caching, command-line-interface, apc

我有一个创建图像的背景工作。我最初的计划是在作业完成后让作业设置一个 apc 缓存键值。我的网络应用程序中有一个监听器，它会 ping 这个缓存，直到它得到一个值，

然而，即使我已将 enable.apc_cli 添加到我的 php.ini，获取和保存命令对我的工作没有任何作用。没有错误，但也没有返回值。APC 在我的实际网络应用程序中运行良好。

我也尝试过使用 zend 缓存工厂，但没有成功。我尝试了apc和file。我即将尝试为此使用redis，但想看看我是否可以先使用文件或APC缓存。

我使用 Zend 框架 1.11.11 和 Zend CE

知道如何从命令行使 apc 工作吗？此外，如果除了缓存值之外还有更好的跟踪作业进度的解决方案，我有兴趣听听。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T18:47:25.910

刚遇到同样的问题。这不是 zend 框架问题，我想 CLI 是从 web 服务器所在的线程自动沙箱化的。Memcached 按预期工作。

# android - Android：带有 ActivityGroup 的 TabActivity/TabHost：从自定义列表视图上的单击按钮创建 PreferenceActivity 对话框和对话框时发生错误

> ID：11905223
> 
> 赞同：0
> 
> 时间：2012-08-10T15:55:59.487
> 
> 标签：android, android-tabhost, android-preferences, activitygroup, android-tabactivity

我基于这个网站[http://ericharlow.blogspot.com/2010/09/experience-multiple-android-activities.html用 ActivityGroup 实现了一个 TabActivity (TabHost)](http://ericharlow.blogspot.com/2010/09/experience-multiple-android-activities.html)

我有两个关于实施这个的问题。

**第一个问题，**将 TabActivity 与 PreferenceActivity 一起使用，当我单击首选项以创建首选项对话框时发生错误。

> 08-10 21:55:35.919: E/AndroidRuntime(1415): android.view.WindowManager$BadTokenException: 无法添加窗口 -- 令牌 android.app.LocalActivityManager$LocalActivityRecord@405296f0 无效；您的活动正在运行吗？

我找到了一个解决方案，我应该在我的代码中使用“getParent()”而不是“getApplicationContext()”或“this”，但我不知道在哪里/如何做？我不知道如何用我的 PreferenceActivity 做类似“setContext(getParent())”的事情。

我有一个与此完全相同的问题：[TabActivity with ActivityGroup and PreferenceActivity child](https://stackoverflow.com/questions/7716227/tabactivity-with-activitygroup-and-preferenceactivity-child)

这是我的代码：

```
public class MoreUserProfile extends PreferenceActivity {

@Override
public void onCreate(Bundle savedInstanceState) {        
    super.onCreate(savedInstanceState);        
    addPreferencesFromResource(R.layout.more_userprofile); 
} 
```

在我看来，我认为我应该在对话类中实现一些东西，在 onCreateDialogView() 因为android在进行对话时调用这个方法。我尽力了，但我无法解决我的问题

```
public class MoreUserProfileDateOfBirthDialog extends DialogPreference {
LinearLayout layout;
SharedPreferences.Editor editor;
    public MoreUserProfileDateOfBirthDialog(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub
    setDialogLayoutResource(R.layout.more_userprofile_dialog_dateofbirth);
    }

@Override
    protected View onCreateDialogView() {
        // TODO Auto-generated method stub
            // I think I should implement some code here.
        //Activity parent = new Activity();
        //LayoutInflater inflater = (LayoutInflater) parent.getLayoutInflater();
        //layout = (LinearLayout) inflater.inflate(R.layout.more_userprofile_dialog_dateofbirth, null);
    }

protected void onBindDialogView(View view) {

layout = (LinearLayout) view.findViewById(R.id.more_userprofile_dialog_dateofbirth_linearlayout);

    SharedPreferences pref = getSharedPreferences();
    int day = pref.getInt("dayOfBirthday", 1);
    int month = pref.getInt("monthOfBirthday", 1);
    int year = pref.getInt("yearOfBirthday", 2000);

    DatePicker dp = (DatePicker) view.findViewById(R.id.more_userprofile_dialog_choosedateofbirth_datePicker);

     dp.init(year, month-1, day, onDateChangedListener);
    layout.removeAllViews();
  layout.addView(dp);     
    super.onBindDialogView(view);
}

DatePicker.OnDateChangedListener onDateChangedListener = new OnDateChangedListener() {
    public void onDateChanged(DatePicker view, int year, int monthOfYear,
            int dayOfMonth) {
        // TODO Auto-generated method stub
        editor = getEditor();
        editor.putInt("dayOfBirthday", view.getDayOfMonth());
        editor.putInt("monthOfBirthday", view.getMonth()+1);
        editor.putInt("yearOfBirthday", view.getYear());
    }
};
@Override
public void onClick(DialogInterface dialog, int which) {
    // TODO Auto-generated method stub
    super.onClick(dialog, which);
    if(which==DialogInterface.BUTTON_NEGATIVE){
        dialog.dismiss();
    }
    if(which==DialogInterface.BUTTON_POSITIVE){
        editor.commit();
    }

}

} 
```

**第二个问题**，和上面类似，但是这次是关于 TabActivity 和 ListView Adapter（用于自定义 Listview）。在每个自定义列表视图项目上都有 2 个按钮，“编辑”和“删除”。当我单击其中一个按钮时，会出现对话框。但是在我将 TabActivity 应用到我的应用程序后，按下这些按钮时出现错误。错误代码与上面类似：

> 08-10 22:13:56.643: E/AndroidRuntime(1427): android.view.WindowManager$BadTokenException: 无法添加窗口 -- 令牌 android.app.LocalActivityManager$LocalActivityRecord@40526c50 无效；您的活动正在运行吗？

这是我的代码：

```
public class ActivityListviewAdapter extends BaseAdapter {

    private LayoutInflater mInflater;
    private Context context;
    private ArrayList<Activities> listData = new ArrayList<Activities>(); 

    public ActivityListviewAdapter(Context context,ArrayList<Activities> listData,) {
        // TODO Auto-generated constructor stub
        super();
        this.context = context;
        this.mInflater = LayoutInflater.from(context);
        this.listData = listData;
    }

    public int getCount() {
        // TODO Auto-generated method stub
        return listData.size(); //ส่งขนาดของ List ที่เก็บข้อมุลอยู่
    }

    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    public View getView(final int position, View convertView, ViewGroup parent) {
    final ActivityRowList activitylist;

        if(convertView == null){
            convertView = mInflater.inflate(R.layout.more_customizedactivity_customlistview, null);
            activitylist = new ActivityRowList();

            activitylist.ActivityName = (TextView) convertView.findViewById(R.id.TextView_More_Customizedactivity_Customlistview_ActivityName);
            activitylist.ActivityDetail = (TextView) convertView.findViewById(R.id.TextView_More_Customizedactivity_Customlistview_ActivityDetail);
            activitylist.ActivityType = (ImageView) convertView.findViewById(R.id.ImageView_Activity_ShowallActivity_Customlistview);   
            activitylist.EditCustomizedButton = (Button) convertView.findViewById(R.id.Button_More_Customizedactivity_Customlistview_Edit);
            activitylist.DeleteCustomizedButton =(Button)convertView.findViewById(R.id.Button_More_Customizedactivity_Customlistview_Delete);

            convertView.setTag(activitylist);
        }else{
            activitylist = (ActivityRowList) convertView.getTag();
        }

        activitylist.ActivityName.setText(listData.get(position).getActivityName());
        activitylist.ActivityDetail.setText("MET: "+listData.get(position).getActivityMET().toString());    
        activitylist.ActivityType.setImageResource(R.drawable.activity_type_customized);

        activitylist.EditCustomizedButton.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    editNewActivityDialog(listData.get(position).getActivityName(), listData.get(position).getActivityMET(),position);
                }
            });
        activitylist.DeleteCustomizedButton.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                confirmDeleteCustomizedDialog(listData.get(position).getActivityName(),listData.get(position));
            }
            });

        return convertView;
    }

    private void confirmDeleteCustomizedDialog(final String ActivityNameInput,final Activities listDataposition){
        // TODO Auto-generated method stub
        AlertDialog alertDialog = new AlertDialog.Builder(mInflater.getContext()).create();
        alertDialog.setTitle("Confirm Delete");
        alertDialog.setMessage("Do you want to delete:\"" + ActivityNameInput +"\"" );
        alertDialog.setIcon(R.drawable.ic_launcher);

        alertDialog.setButton(DialogInterface.BUTTON_POSITIVE,"Confirm", new DialogInterface.OnClickListener() {    
            public void onClick(DialogInterface dialog, int which) {
                // Some codes here
        });
        alertDialog.setButton(DialogInterface.BUTTON_NEGATIVE,"Cancel",new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                dialog.dismiss();
            }
        });
        alertDialog.show();
    }

    private void editNewActivityDialog(final String ActivityNameBefore, float ActivityMETBefore,final int ListPosition) {
        // TODO Auto-generated method stub
        final Dialog dialog = new Dialog(mInflater.getContext());
        dialog.setContentView(R.layout.more_customizedactivity_dialog_addnew);
        final EditText EditText_Addnewactivity_Dialog_ActivityName=(EditText)dialog.findViewById(R.id.EditText_More_Customizedactivity_Addnewactivity_Dialog_ActivityName);
        final EditText EditText_Addnewactivity_Dialog_ActivityMET=(EditText)dialog.findViewById(R.id.EditText_More_Customizedactivity_Addnewactivity_Dialog_ActivityMET);
        final Button Button_More_Customizedactivity_Addnewactivity_Dialog_OK=(Button)dialog.findViewById(R.id.Button_More_Customizedactivity_Addnewactivity_Dialog_OK);
        final Button Button_More_Customizedactivity_Addnewactivity_Dialog_Cancel=(Button)dialog.findViewById(R.id.Button_More_Customizedactivity_Addnewactivity_Dialog_Cancel);
        dialog.setTitle("Edit Activity by User");

        EditText_Addnewactivity_Dialog_ActivityName.setText(ActivityNameBefore);
        EditText_Addnewactivity_Dialog_ActivityMET.setText(ActivityMETBefore+"");
        dialog.show();

        Button_More_Customizedactivity_Addnewactivity_Dialog_OK.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                // TODO Auto-generated method stub
                // Some codes here
        });

        Button_More_Customizedactivity_Addnewactivity_Dialog_Cancel.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                dialog.dismiss();
            }
        });
}
} 
```

**根据我的代码：**

当我在自定义列表视图上按“编辑”时，代码运行 editNewActivityDialog() 方法并使用以下方法构建 Dialog：

> 最终对话框 dialog = new Dialog(mInflater.getContext());

（我想我应该把“mInflater.getContext()”改成别的东西，但我不知道。）

当我在自定义列表视图上按“删除”按钮时，代码运行 confirmDeleteCustomizedDialog() 方法并使用以下方法构建 AlertDialog：

> AlertDialog alertDialog = new AlertDialog.Builder(mInflater.getContext()).create();

（我想我应该把“mInflater.getContext()”改成别的东西，但我不知道。）

***非常感谢提前:)***

# sql - SQL 变量在 Excel 查询中不起作用

> ID：11905226
> 
> 赞同：2
> 
> 时间：2012-08-10T15:56:10.827
> 
> 标签：sql, excel

您好我有一个无法在 Excel 外部 SQL Server 查询中以图形方式表示的查询，因为查询不简单我无法设置 Excel 变量。相反，我尝试使用 declare/set 在 SQL 中设置变量，但是这样做时，尝试导入数据时会失败。

有没有办法解决这个问题？我需要一定程度的灵活性来运行查询并将数据传输到 Excel 中。

好的，这是一个按要求提供的示例。

```
declare @enddate as datetime
set @enddate = (select max(rpt_week) from [results].dbo.t_Data)
Select * from results.dbo.t_Data
where rpt_week = @enddate 
```

这不会在 excel 中运行，显然我的查询更复杂，但变量的使用是必不可少的，我正在寻找一种方法来完成这项工作。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-06T19:53:55.227

在 Excel 中使用声明值时，您需要 SET NOCOUNT ON

您的样本如下：

```
SET NOCOUNT ON;
declare @enddate as datetime
set @enddate = (select max(rpt_week) from [results].dbo.t_Data)
Select * from results.dbo.t_Data
where rpt_week = @enddate 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-09T11:11:53.733

关于这个主题还有[另一个问题有正确](https://stackoverflow.com/q/21417922/22114)[答案](https://stackoverflow.com/a/25631073/22114)：

在查询中使用**SET NOCCOUNT ON**。

当我尝试从 Excel 运行 SP 时遇到了与 OP 相同的问题，该 SP 应该从嵌入的`SELECT`. 这是由服务器返回*的受 ... 行影响的*消息引起的。显然，Excel 无法正确处理此消息，并忽略返回的数据。一旦我`SET NOCOUNT ON`在我的 SP 中使用，数据就会在 Excel 中正确显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T19:10:52.133

我不太确定你想要什么，但这里有一些注意事项：

```
Dim cn As New ADODB.Connection
Dim rs As New ADODB.Recordset
Dim cmd As New ADODB.Command

cn.Open ServerCon ''Connection string

''Straight sql
sSQL = "SELECT * FROM table_1 WHERE adate = (SELECT Max(adate) FROM table_1)"
rs.Open sSQL, cn

''Not a good idea, see procedure parameter below for a better way
sSQL = "SELECT * FROM table_1 WHERE adate = '" _
     & Sheets("Sheet7").Range("B2") & "'"
rs.Open sSQL, cn

''Stored procedure
rs.Open "ExcelTest", cn

''Stored procedure with parameter
cmd.ActiveConnection = cn
cmd.CommandType = adCmdStoredProc
cmd.CommandText = "ExcelTest"
cmd.Parameters("@enddate") = Sheets("Sheet7").Range("B2")
Set rs = cmd.Execute

''Write to Excel
ActiveWorkbook.Sheets("Sheet12").Cells(1, 1).CopyFromRecordset rs 
```

您还可以使用查询表。

# linux - nmap 说端口已关闭，而 netat 说它正在侦听

> ID：11905230
> 
> 赞同：11
> 
> 时间：2012-08-10T15:56:34.557
> 
> 标签：linux, port, netcat, nmap

这是 Ubuntu 12.04 环境。我在盒子的 8020 端口上运行了一个 TCP 服务：

我的问题是：

为什么在 nmap 中没有发现端口 8020 作为开放端口，而 netat 说它正在侦听？

如果我跑

```
netstat -tuplen

Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       User           Inode       PID/Program name
tcp        0      0 127.0.0.1:9001          0.0.0.0:*               LISTEN      0          10564       1917/python    
tcp        0      0 127.0.0.1:8020          0.0.0.0:*               LISTEN      117        29259       4448/java 
```

但如果我跑

```
nmap -v -sT 127.0.0.1

Starting Nmap 5.21 ( http://nmap.org ) at 2012-08-10 08:51 PDT
Initiating Connect Scan at 08:51
Scanning localhost (127.0.0.1) [1000 ports]
Discovered open port 53/tcp on 127.0.0.1
Discovered open port 22/tcp on 127.0.0.1
Discovered open port 9000/tcp on 127.0.0.1
Discovered open port 631/tcp on 127.0.0.1
Discovered open port 9001/tcp on 127.0.0.1
Completed Connect Scan at 08:51, 0.04s elapsed (1000 total ports)
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00046s latency).
rDNS record for 127.0.0.1: hadoop-namenode-01
Not shown: 995 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
53/tcp   open  domain
631/tcp  open  ipp
9000/tcp open  cslistener
9001/tcp open  tor-orport

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds
       Raw packets sent: 0 (0B) | Rcvd: 0 (0B) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T16:10:39.400

默认情况下，nmap 不会扫描所有端口。试试这个。

```
nmap -sT -sU -p- 127.0.0.1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T23:06:13.513

@Satish，您不需要添加 -sU 也会扫描UDP端口，并且需要一段时间。

```
nmap -v -p 8020 127.0.0.1 
```

这应该是足够的和即时的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-23T05:27:25.247

默认情况下，nmap 只扫描众所周知的端口。您可以使用 -p 参数指定端口。

扫描所有端口：**nmap -v -p "*" 127.0.0.1**

仅扫描端口 8020：**nmap -v -p 8020 127.0.0.1**

# c++ - 编译器没有将指向字符串文字的指针解释为方法的参数

> ID：11905231
> 
> 赞同：2
> 
> 时间：2012-08-10T15:56:35.123
> 
> 标签：c++, string, pointers, methods, arguments

菜鸟在这里。从书本上做练习时有疑问。

疑问如下：为什么如果我使用*const std::string **作为方法的参数，编译器会向我发送以下错误：*no matching function for call to 'BankAccount::define(const char [11], const char [11], int)'*在客户端？

*如果我交换方法的原型和定义以接受const std::string &*作为参数（就像我在构造函数中所做的那样），编译器就没有问题。

客户：

```
// usebacnt.cpp --

#include "BankAccount.h"
#include <iostream>

int main()
{
    BankAccount john;
    BankAccount mary("Mary Wilkinson", "5000000000"); // balance set to 0 because of default argument
    john.display();
    mary.display();
    john.define("John Smith", "4000000000", 26); // error line
    mary.deposit(1000.50);
    john.withdraw(25);
    john.display();
    mary.display();
    std::cin.get();
    return 0;
} 
```

类声明：

```
// BankAccount.h -- Header file for project Exercise 10.1

#ifndef BANKACCOUNT_H_
#define BANKACCOUNT_H_

#include <string>

class BankAccount
{
private:
    std::string fullName;
    std::string accountNumber;
    double balance;
public:
    BankAccount(); // default constructor
    BankAccount(const std::string &fN, const std::string &aN, double b = 0.0); // constructor with a default argument
    void display() const;
    void deposit(double amount);
    void withdraw(double amount);
    void define(const std::string *pfN, const std::string *paN, double b);
};

#endif 
```

类实现：

```
// methods.cpp -- Compile alongside usebacnt.cpp

#include "BankAccount.h"
#include <iostream>

void BankAccount::display() const
{
    using std::cout;
    using std::ios_base;
    ios_base::fmtflags orig = cout.setf(ios_base::fixed, ios_base::floatfield); // formatting output and saving original
    cout.precision(2);
    cout << "Full Name: " << fullName << '\n';
    cout << "Account Number: " << accountNumber << '\n';
    cout << "Balance: " << balance << "\n\n";
    cout.setf(orig);
}

void BankAccount::deposit(double amount)
{
    if (amount < 0)
    {
        std::cout << "You can't deposit a negative number! Amount set to zero.";
        amount = 0;
    }
    balance += amount;
}

void BankAccount::withdraw(double amount)
{
    if (amount < 0)
    {
        std::cout << "You can't withdraw a negative number! Amount set to zero.";
        amount = 0;
    }
    if (balance < amount)
    {
        std::cout << "You can't withdraw more money than you have. Amount set to zero.";
        amount = 0;
    }
    balance -= amount;
}

void BankAccount::define(const std::string *pfN, const std::string *paN, double b)
{
    fullName = *fN;
    accountNumber = *aN;
    balance = b;
}

// constructors
BankAccount::BankAccount() // default constructor
{
    fullName = "empty";
    accountNumber = "empty";
    balance = 0.0;
}

BankAccount::BankAccount(const std::string &fN, const std::string &aN, double b) // constructor with default argument
{
    fullName = fN;
    accountNumber = aN;
    balance = b;
} 
```

编译器不应该将文字解释为字符串对象（就像它对引用所做的那样）？所以如果我说它是一个指针，它应该传递字符串的地址（它的第一个元素）。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T15:59:51.437

> 编译器不应该将文字解释为字符串对象（就像它对引用所做的那样）？

不，指针不是引用；打击任何告诉你他们是的人。

这一切都归结为：`std::string`不是字符串文字。因此，当您将字符串文字传递给接受 a 的函数时，必须创建一个保存文字内容的`std::string`临时`std::string`文件。这是通过 的转换构造函数完成的`std::string`。

A`const&`允许从临时初始化，这允许转换构造函数发挥它们的魔力。A`const*`必须是一个指针，并且您不应该获得指向临时对象的指针。因此，`const*`不能由转换构造函数创建的临时变量神奇地填充。

您应该使用 a`const std::string &`而不是指针。或者，`std::string`如果您有可用的 C++11 移动构造函数，则为一个值。

# python - Python和超级终端中RS232串行对话中的ASCII到十六进制转换

> ID：11905235
> 
> 赞同：0
> 
> 时间：2012-08-10T15:56:51.457
> 
> 标签：python, serial-port, hex, ascii, hyperterminal

我正在使用 Python 通过 RS232 串行对话从仪器传输数据。数据以 ASCII 格式输入。例如，这是我使用**Python**从仪器中得到的 ASCII 码：

```
'\x02S20390908127F010102F3004000900300000000000000000000000000000300A500000000000202020202020206070505050505050000000707070707070707020700000000000000000000000000000000000000008000800089237A0715047E000000000000000000000000000000000000000000000000000000000000000000000000005350374646303030\x1732' 
```

使用**超级终端（Docklight）**的相同数据传输给了我这个，以下是我在超级终端中得到的十六进制表示：

```
02 53 31 38 33 38 30 39 30 38 31 32 37 46 30 31 30 31 30 32 46 33 30 30 34 30 30 30 39 30 30 33 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 33 30 30 41 35 30 30 30 30 30 30 30 30 30 30 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 30 37 30 35 30 35 30 35 30 35 30 35 30 35 30 30 30 30 30 30 30 37 30 37 30 37 30 37 30 37 30 37 30 37 30 37 30 32 30 37 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 38 30 30 30 38 30 30 30 38 39 32 33 37 41 30 37 31 35 30 34 37 45 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 35 33 35 30 33 37 34 36 34 36 33 30 33 30 33 30 17 33 38 
```

我的问题是，我如何使用**Python**从我得到的 ascii 数据中获得相同的十六进制表示。说到这种东西，我是个菜鸟。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:11:58.183

说明：将每个字符转换为字节，`ord`然后将其格式化为两位十六进制数并将其输入列表。然后使用空格作为分隔符加入列表。

```
>>> ll = ["%02X" % (ord(x)) for x in '\x02S20390908127F010102F3004000900300000000000000000000000000000300A500000000000202020202020206070505050505050000000707070707070707020700000000000000000000000000000000000000008000800089237A0715047E000000000000000000000000000000000000000000000000000000000000000000000000005350374646303030\x1732']
>>> ll           #as a list
['02', '53', '32', '30', '33', '39', '30', '39', '30', '38', '31', '32', '37', '46', '30', '31', '30', '31', '30', '32', '46', '33', '30', '30', '34', '30', '30', '30', '39', '30', '30', '33', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '33', '30', '30', '41', '35', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '32', '30', '32', '30', '32', '30', '32', '30', '32', '30', '32', '30', '32', '30', '36', '30', '37', '30', '35', '30', '35', '30', '35', '30', '35', '30', '35', '30', '35', '30', '30', '30', '30', '30', '30', '30', '37', '30', '37', '30', '37', '30', '37', '30', '37', '30', '37', '30', '37', '30', '37', '30', '32', '30', '37', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '38', '30', '30', '30', '38', '30', '30', '30', '38', '39', '32', '33', '37', '41', '30', '37', '31', '35', '30', '34', '37', '45', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '30', '35', '33', '35', '30', '33', '37', '34', '36', '34', '36', '33', '30', '33', '30', '33', '30', '17', '33', '32']
>>> ' '.join(ll) # as a string
'02 53 32 30 33 39 30 39 30 38 31 32 37 46 30 31 30 31 30 32 46 33 30 30 34 30 30 30 39 30 30 33 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 33 30 30 41 35 30 30 30 30 30 30 30 30 30 30 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 30 37 30 35 30 35 30 35 30 35 30 35 30 35 30 30 30 30 30 30 30 37 30 37 30 37 30 37 30 37 30 37 30 37 30 37 30 32 30 37 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 38 30 30 30 38 30 30 30 38 39 32 33 37 41 30 37 31 35 30 34 37 45 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 35 33 35 30 33 37 34 36 34 36 33 30 33 30 33 30 17 33 32' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:16:07.690

这似乎是最简单的方法...

```
ascstr = 'x\02S20..."  #your string

#I think you need to get rid of the first 4 characters '\x02' looks like
#it is hex
ascstr = ascstr[4:] 
for c in mystring:
   hexstr = hexstr + hex(ord(c))[2:] + ' ' 
```

# php - 需要在表中的列中找到最高值并将其递增

> ID：11905239
> 
> 赞同：1
> 
> 时间：2012-08-10T15:56:58.383
> 
> 标签：php, mysql

我是 php 的初学者，所以请保持温柔.. :-) 我一直在寻找答案，但我一次又一次地遇到同样的错误。我找不到错误，这让我发疯了！

```
$query = "SELECT position FROM pages WHERE subject_id = '$subject_id' ORDER BY position DESC LIMIT 1";
$bla = mysql_query($query, $connection);
$position = $bla[0];
$position += 1; 
```

好的，上面的代码在我的页面顶部。据我了解，这应该执行以下操作：从“subject_id”与我传递的 subject_id 匹配的表“pages”中获取名为“position”的列，然后对其进行排序并选择 1 个值（这将是最高的）。所以我现在有 1 列有 1 个值。然后我抓住那个值，把它放在“位置”，然后加 1。

但是我得到的错误是：`"Column count doesn't match value count at row 1"` 再次，我是初学者（我已经习惯了另一种语言），所以这可能是我忘记/做错了的小而愚蠢的事情..有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T15:58:46.790

mysql_query() 返回一个语句句柄，而不是你想要的数据。您必须先获取一行：

```
$bla = mysql_query($query) or die(mysql_error());
$row = mysql_fetch_row($bla);
$position = $row[0] + 1; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-10T16:27:04.507

您可以将查询更改为：

```
$query = "UPDATE pages SET position=position+1 WHERE subject_id = '$subject_id' ORDER BY position DESC LIMIT 1"; 
```

然后简单地运行

```
mysql_query($query, $connection); 
```

显然，如果您有两个具有相同最高值的 subject_id，则只有一个会更新 - 但是您现在设置脚本的方式无论如何都会做同样的事情。

# gps - 强制启动 GPS windows mobile 6.5

> ID：11905241
> 
> 赞同：1
> 
> 时间：2012-08-10T15:57:00.890
> 
> 标签：gps, compact-framework

我建立了一个导航器，但 GPS 出现了问题，有时即使设备在外面没有任何阻碍，也需要很长时间才能获得 GPS 修复。如果我启动 TomTom，GPS 几乎可以立即在同一设备上得到修复。如果我重新启动设备，我也可以更快地得到修复。

它就像 GPS 处于睡眠模式，必须“戳”它才能开始发送坐标。任何人都知道这一点以及如何让它在 win CF c# 中更快地工作？

# google-chrome - 带有不附加“回调”参数的jQuery的JSONP请求？

> ID：11905243
> 
> 赞同：0
> 
> 时间：2012-08-10T15:57:02.877
> 
> 标签：google-chrome, jquery, jsonp, http-get, script-tag

我有一个 JSONP 响应的本地版本保存为文件，因此当我没有 Internet 连接时，我可以从本地文件系统测试我的单页 Web 应用程序。

当我直接从`<script>`标签加载它时它工作正常，但当我尝试使用 jQuery`$.ajax()`函数加载它时却不行。（是的，我也从本地文件系统成功加载了 jQuery。）

我认为可能是 jQuery*总是*向 URL添加一个`callback`参数，当 JSONP 来自静态命名的文件而不是来自 Internet 时，这没有意义。

我尝试将`jsonpCallback`set 传递给`null`或传递给空 string `''`，但这没有区别。

还有其他奇怪的地方：

*   当我将完整路径作为 URL 传递时，它在 jQuery 中运行良好，但在我使用相对 URL 时失败，即使在直接使用`<script>`标签时两者都同样有效。
*   当它失败时，谷歌浏览器的开发者工具网络标签告诉我方法是`OPTIONS`而不是`GET`！使用绝对 URL 或`<script>`带有相对或绝对 URL 的标记方法告诉我该方法`GET`符合预期。

这是已知的正确行为吗？已知的不正确行为？

jQuery 或 Google Chrome 有什么奇怪的地方吗？（我在 Windows 7 32 位 Chrome 版本 21 中运行。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T07:41:35.153

~~虽然这可能无法解决我的所有问题，但它回答了问题标题中提出的具体问题：~~

这似乎是我所缺少的：

**带有不附加“回调”参数的 jQuery 的 JSONP 请求？**

`jQuery.ajax()`接受一个`settings`对象参数。其中一项设置称为`jsonp`. [从文档中](http://api.jquery.com/jQuery.ajax/)：

> **从 jQuery 1.5**开始，设置`jsonp`选项以`false`防止 jQuery 将“?callback”字符串添加到 URL 或尝试使用“=?” 为转型。在这种情况下，您还应该明确设置`jsonpCallback`设置。例如，`{ jsonp: false, jsonpCallback: "callbackName" }`

我的代码现在可以在 Windows 7（32 位）下使用 Chrome (21)、Firefox (13)、Internet Explorer (9)、Opera (12) 和 Safari (5) 的当前版本。

# javascript - Web Worker 中的同步 XHR 请求是否仍会锁定浏览器？

> ID：11905244
> 
> 赞同：3
> 
> 时间：2012-08-10T15:57:06.053
> 
> 标签：javascript, asynchronous, synchronous, worker

我正在构建一个可以进行大量 XHR 调用的计算器，并且想知道是否将这些同步放在网络工作者中是否仍会锁定浏览器？我的理解是这些是在不同的线程中处理的，不应该。

（我之前已经异步构建了算法，它只是非常难以维护的代码，我只是在寻找这个选项来保持代码更易于维护。我理解为什么它不应该在 web worker 之外同步。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:11:59.070

如果没有另一个可用的处理器，它不会像没有 Web Worker 那样糟糕（因为操作系统可以循环调度两个线程以交错运行，即使一个在处理器上也是如此）。

如果有另一个处理器可用，操作系统会理想地安排它在该线程上运行，并且它们都将全速运行。

# javascript - 如何使这个测验回答脚本适应这个新的测验布局？

> ID：11905248
> 
> 赞同：0
> 
> 时间：2012-08-10T15:57:29.943
> 
> 标签：javascript, html, greasemonkey

我希望浏览器能够选择正确的问题答案。我找到了一个似乎是正确想法的答案（[如何使用 Greasemonkey 自动选择特定的单选按钮？](https://stackoverflow.com/q/11025270/331508)）但我不知道足够的 javascript 来使用它。

我的 HTML 代码显示在[**这个小提琴**](http://jsfiddle.net/t2AzN/)中。

**所需的输出示例应如下所示：（**
[单击以获得更大的图像）
![期望的脚本结果](../Images/8eb8cc632b4143d8e3631f9de005af89.png)](https://i.stack.imgur.com/4nOvd.jpg)

如何使该解决方案适应我的目标页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T03:48:07.940

在这种情况下，艺术在于：(1) 为问题和答案确定最佳的 jQuery 选择器，以及 (2) 调整`ansForThisQ.each()`循环。对于您的 HTML：

```
var questionTxt = $("span.sorumetin"); 
```

和

```
var ansForThisQ     = $(this).next ("ul.sorular").find ("a");
ansForThisQ.each ( function () {
    var zRegExp     = new RegExp (answerTxt, 'i');
    if (zRegExp.test (this.textContent) ) {
        bFoundAnswer    = true;
        $(this).css     ("background", "lime");
        return false;   // End loop
    }
} ); 
```

请参阅[更新的 Fiddle](http://jsfiddle.net/t2AzN/2/)。

参考和学习[jQuery 选择器](http://api.jquery.com/category/selectors/)和[jQuery 遍历](http://api.jquery.com/category/traversing/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:47:44.687

我没有太多时间来查看您的代码，但是您可能最容易根据正确答案的位置存储变量 1、2、3 或 4，然后单击时，只需嵌套 4 个 if语句 IE - if 1、highlight 1、if 2 等。

# html - 网站不同页面上的文件路径

> ID：11905252
> 
> 赞同：0
> 
> 时间：2012-08-10T15:57:39.880
> 
> 标签：html, file, path, directory, exists

如果我在我的网站的起始页上为 src="images/anotherFolder/picture.jpg" 之类的图像设置文件路径，效果会很好。但是，如果我随后访问 www.mywebsite.com/albums 并使用相同的 src，它根本不起作用。如果检查 Chrome 中给出的图像路径，我发现它正在寻找一个带有如下 URL 的图像：www.mywebsite.com/albums/images/anotherFolder/picture.jpg

而不是这个：

www.mywebsite.com/images/anotherFolder/picture.jpg

所以我想我会使用一个看起来像这样的源： src="http://www.mywebsite.com/images/anotherFolder/edit.jpg" 它适用于两个页面但然后是 PHP 函数，如 is_file、is_readable , file_exists 不能正常工作。

那么该怎么办？

**添加**

我使用 .htaccess 文件将 URL 从[http://www.mywebsite.com/albums?id=123](http://www.mywebsite.com/albums?id=123)重写为[http://www.mywebsite.com/albums/123](http://www.mywebsite.com/albums/123)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:06:48.990

您想要的称为相对路径。如果您想要站点根目录的相对路径，则应以斜杠开头：`/`

```
src="/images/anotherFolder/picture.jpg" 
```

如果你想要父文件夹的相对路径，你应该从两个点和一个斜杠开始：`../`

所以如果你在 www.mywebsite.com/albums，

```
src="../images/anotherFolder/picture.jpg" 
```

如果您在 www.mywebsite.com/albums/aaa，

```
src="../../images/anotherFolder/picture.jpg" 
```

**编辑：**

似乎这`is_file`不适用于来自根目录的相对路径，但它适用于`../`. 如果您更喜欢来自根目录的相对路径，您可以使用

```
$_SERVER['DOCUMENT_ROOT']."/images/anotherFolder/picture.jpg" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:00:20.333

使用 src="./images/anotherFolder/edit.jpg"

# c++ - 构造函数上的 C++ 向量释放

> ID：11905253
> 
> 赞同：1
> 
> 时间：2012-08-10T15:57:42.190
> 
> 标签：c++, vector, constructor, size

抱歉，我没有时间编写代码，希望我的解释足够彻底。我的一个类有一个向量作为私有成员变量，它的大小在其构造函数中声明。

现在，我从调试中发现，虽然向量确实在构造函数中分配了它的大小，但当构造函数返回时它会丢失所有大小（好像它的内存分配只在构造函数的范围内，即使向量是它的成员变量之一。它回到了一个空向量）我需要我的向量在构造函数执行之后保持它的大小，并且想知道我可以做些什么来解决这个问题，因为我用字符串初始化它的元素我的其他功能之一。

**从评论中附加内容**

```
std::vector< std::vector< std::string > > routeInfo(
    routeNum, std::vector< std::string >( 2 ) ); 
```

> 这是我的构造函数中向量的声明，routeNum 是一个变量，它在构造函数的早期初始化（正确初始化，这不是问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:26:20.530

我必须从您的代码中假设您不知道如何在 c++ 中初始化成员变量。这是正确的方法：

```
class Myclass
{
// the declaration of the variable:
std::vector< std::vector< std::string > > routeInfo;

// declaration of the constructor:
Myclass(int routeNum);
};

// definition of the constructor
Myclass::Myclass(int routeNum)
  : routeInfo(routeNum, std::vector< std::string >( 2 ))
{
  // some other code
} 
```

如果你简单地写：

```
Myclass::Myclass(int routeNum)
{
std::vector< std::vector< std::string > > routeInfo(
    routeNum, std::vector< std::string >( 2 ) );
} 
```

这将在构造函数中创建另一个 routeInfo 变量以隐藏原始变量。要到达成员变量，您必须编写`this->routeInfo`而不是，`routeInfo`它仍然是零长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:05:09.540

在我看来，您以某种方式在代码中的某处分配了向量（或者可能在整个对象上分配了另一个您没有指定向量大小的对象）。

如果您正确指定了大小，则矢量本身不应改变大小。虽然要检查一件事：

您是否指定了最大容量，或者您是否使用储备指定了当前容量？如果您调用reserve，向量应该扩展到您分配的空间并保持在那里，直到您超过它或明确请求更改大小。

# javascript - How to create method for an array as a property of an object in javascript?

> ID：11905254
> 
> 赞同：3
> 
> 时间：2012-08-10T15:57:42.903
> 
> 标签：javascript, oop, object, methods, prototype

Please consider this code in javascript:

```
function Selector() {
    this.Status = "";
    this.Groups = new Array();
    this.Errors = new Array();
} 
```

I want to add a method for Groups property of the Selector class and use it for any instance. How can i do this?

Please be aware that i write this code:

```
function Selector() {
    this.Status = "";
    this.Groups = []; 
    this.Groups.myFunction = function(){alert(this.length);  
    };
    this.Errors = [];
}

var selector = new Selector();
selector.Groups = [1,2,3];
selector.Groups.myFunction(); 
```

But when i set Group property i get error for calling method:

Error: selector.Groups.myFunction is not a function

I prefer to find a way using prototype object.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T08:59:08.677

当你说：

```
 selector.Groups = [1,2,3];
  selector.Groups.myFunction(); 
```

您实际上是在初始化一个新数组并将其存储在 selector.Groups 属性中，并且由于 Array 对象没有名为 myFunction 的方法，因此您会收到错误消息。

您可以扩展 Array 对象，以便每个数组都有一个 myFunction 方法，如下所示：

```
 Array.prototype.myFunction = function() { alert(this.length) }; 
```

这不是一个好主意 imo，但你没有很多选择，因为子类化数组不会在 IE 中保持长度属性:(

请参阅[此链接](http://dean.edwards.name/weblog/2006/11/hooray/)以了解对数组子类化的 iframe hack。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T08:52:47.710

您的代码不会以这种方式工作，因为在构造函数中，您将一个对象（数组）分配给类属性并扩展该特定实例。然后，当您分配新数组时，新创建的数组没有这样的方法。所以你的解决方案可以这样改变：

```
function Selector() {
    this.Status = "";
    this.setGroups([]);
    this.Errors = [];
}

Selector.prototype.myFunction = function() {
    alert(this.length);
};

Selector.prototype.setGroups = function(groups) {
    this.Groups = groups;
    this.Groups.myFunction = this.myFunction;
};

var selector = new Selector();
selector.Groups.myFunction();
selector.setGroups([1,2,3]);
selector.Groups.myFunction();
selector.setGroups(['foo', 'bar']);
selector.Groups.myFunction(); 
```

[**演示**](http://jsfiddle.net/f0t0n/6gRCH/)

但我不建议你使用这种做法。更好的是创建一个类 GroupCollection 并将一个数组封装为其属性：

```
function GroupCollection(items) {
    this.items = items || [];
}

GroupCollection.prototype.myFunction = function() {
    alert(this.items.length);
};

function Selector() {
    this.Status = "";
    this.Groups = new GroupCollection();
    this.Errors = [];
}

Selector.prototype.setGroups = function(groups) {
    this.Groups.items = groups;
};

var selector = new Selector();
selector.Groups.myFunction();
selector.setGroups([1,2,3]);
selector.Groups.myFunction();
selector.setGroups(['foo', 'bar']);
selector.Groups.myFunction(); 
```

​<a href="http://jsfiddle.net/f0t0n/6gRCH/2/" rel="nofollow">**演示**

# java - 将int转换为字符串时对齐小数

> ID：11905263
> 
> 赞同：2
> 
> 时间：2012-08-10T15:58:20.597
> 
> 标签：java, string, alignment, int, decimal

我知道在Java中你可以使用 printf 比如

```
System.out.printf("check1 =  " + "%11.5f  percent\n", 2.0564);
System.out.printf("cat =     " + "%11.5f  percent\n", 1232.05); 
```

但是如果说你有

```
int temp1 = 1.02
int temp2 = 12345.01234 
```

并且您想将其转换为具有小数对齐的字符串。所以你会有

```
a = "DMC       1.02    percent"
b = "POLY  12345.01234 percent" 
```

除了有一堆 if 语句来检查长度之外，还有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:05:45.383

利用：

```
String.format("%-15s%11.5f percent", "DMC", 1.02);
String.format("%-15s%11.5f percent", "POLY", 12345.01234); 
```

它产生：

```
DMC           1.02000 percent
POLY      12345.01234 percent 
```

您可能需要增加 的值`%-15s`才能正确拟合非常大的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:06:01.037

您可以使用字符串操作。

```
String text = "     " + value + "     ";
text = text.substring(text.indexOf('.') - 5, text.indexOf('.') + 5); 
```

# php - 在 Codeigniter 中的文件上传期间使用 sanitize_filename()

> ID：11905270
> 
> 赞同：1
> 
> 时间：2012-08-10T15:58:49.950
> 
> 标签：php, codeigniter

我一直在研究如何保护我上传到服务器的文件。

我在文档中遇到过`$this->security->sanitize_filename()`，但我不知道如何在文件上传期间将其用于文件名。我不希望有人将文件命名为恶意文件`Something<?php exit;?>.jpg`或带有可能与 url 路径混淆的斜线的东西。

Codeigniter中的文件上传类是否自动使用sanitize_filename？如果没有，我该如何使用它？

我是否需要先对 $_FILES 做一些事情，然后使用 sanitize_filename，然后将其传递给上传配置中的 file_name？如何从 $_FILES 访问文件名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:10:55.890

我刚刚将此添加到我的文件上传配置中。

```
$filename = $this->security->sanitize_filename($this->input->post('file'));

$config['file_name'] = $filename; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T14:55:24.650

您可以为此使用安全助手。

encode_php_tags() 为 html 实体制作 php 标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:27:49.483

只需将此配置添加到您的上传配置中

```
.
.
$config['encrypt_name'] = TRUE
.
.
 $this->load->library('upload', $config); // Or $this->upload->initialize($config); if you already loaded the upload library 
```

查看 codeigniter 用户指南：[http ://codeigniter.com/user_guide/libraries/file_uploading.html](http://codeigniter.com/user_guide/libraries/file_uploading.html)

此配置加密文件名。

# c++ - 为什么要在 C++ 中按值传递对象

> ID：11905275
> 
> 赞同：15
> 
> 时间：2012-08-10T15:59:24.967
> 
> 标签：c++, calling-convention

> **可能重复：**
> [在 C++ 中通过值传递还是通过常量引用传递更好？](https://stackoverflow.com/questions/270408/is-it-better-in-c-to-pass-by-value-or-pass-by-constant-reference)

我知道 C++ 中按值、指针和引用传递的区别，我认为在 C++ 中按值（而不是 const 引用）传递对象几乎总是一个编程错误。

```
void foo(Obj o); ... // Bad

void foo(const Obj &o); ... // Better 
```

我能想到的唯一可能适合按值传递而不是 const 引用的情况是对象小于引用的情况，因此按值传递更有效。

但是，这肯定是编译器旨在确定的那种事情吗？

为什么 C++ 实际上*需要*按值传递和按 const 引用传递，并且 - 如果合适，编译器是否允许自动将调用转换为（和来自）const 引用？

*（似乎有 100 多个 C++ 调用约定问题，询问（比如说）值和引用之间的区别——但我找不到一个问“为什么？”的问题。）*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T16:09:20.587

何时通过值传递可能比通过 const 引用更好的问题对于不同版本的标准有不同的答案。

在良好的旧 C++03 和几年前，建议是通过 const 引用传递任何不适合寄存器的内容。在这种情况下，答案将是：

*   因为`Obj`适合一个寄存器并且传值和传值会更高效

仍然在 C++03 中，在过去的几年里（似乎有些文章在近 10 年前推荐了这个，但没有真正的共识），

*   如果函数*需要*进行复制，那么如果复制的源是临时的，那么在接口中这样做允许编译器执行*复制省略*，因此它可以更有效。

随着新 C++11 标准的批准，以及增加编译器对*rvalue-references*的支持，在许多情况下，即使副本不能被删除，并且再次

*   如果函数*需要*进行复制，即使无法删除副本，并且对于支持它的类型，内容将被*移动*（在通用术语中，*对象*将被移动，但只有内容被移动），这再次将比内部复制更有效。

至于为什么这两种不同的调用约定的问题，它们有不同的目标。按值传递允许函数在不干扰源对象的情况下修改参数的状态。此外，源对象的状态也不会干扰函数（考虑多线程环境，以及在函数仍在执行时修改源的线程）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-10T16:10:08.853

当然，C++ 具有按值传递的一个原因是因为它从 C 继承了它，并且删除它可能会破坏代码而收效甚微。

其次，正如您所注意到的，对于小于按值传递的引用的类型，效率会降低。

然而，另一个不太明显的情况是，如果您有一个函数由于某种原因需要其参数的副本：

```
void foo(const Obj& obj)
{
    if(very_rare_check()) return;

    Obj obj_copy(obj);
    obj_copy.do_work();
} 
```

在这种情况下，请注意您正在强制复制。但是假设您使用另一个按值返回的函数的结果调用此函数：

```
Obj bar() { return Obj(parameters); } 
```

并这样称呼它：`foo(bar());`

现在，当您使用 const 引用版本时，编译器最终会生成两个对象：临时对象和`foo`. 但是，如果您按值传递，编译器可以将所有临时对象优化到`foo`.

在[http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/上有一篇关于这个和移动语义的很棒的文章](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)

最后，实现某些运算符的规范方法是使用按值传递来避免运算符内部的副本：

```
Obj operator+(Obj left, const Obj& right)
{
    return left += right;
} 
```

请注意，这如何让编译器在参数中生成副本，而不是在运算符代码本身中强制复制或临时对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-10T16:02:42.690

如果我想对函数内的对象做一些事情而不影响原来的，我会按值传递：

```
A minus(A b){
    b.val=-b.val;
    return b;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-10T16:09:58.480

复制交换习语使用按值传递来实现编译器生成的副本。

```
MyClass& operator=(MyClass value) // pass by value to generate copy
{
    value.swap(*this);            // Now do the swap part.
    return *this;
} 
```

基本上在您需要修改参数但不想触及原始参数的情况下。在这些情况下，如果您通过 const 引用传递，您需要在函数内手动创建一个副本。如果您让编译器处理副本，此手动步骤将阻止编译器可以执行的某些优化。

```
MyClass a;
// Some code
a = MyClass(); // reset the value of a
               // compiler can easily elide this copy. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T16:04:44.600

如果对象是可变的，则通过值传递给接收者自己的副本以供使用和合理的更改，而不影响调用者的副本——总是假设它是一个足够深的副本。

这可以简化一些多线程情况下的思考。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-10T16:09:30.430

> 为什么 C++ 实际上需要按值传递和按 const 引用传递，并且 - 如果合适，编译器是否允许自动将调用转换为（和来自）const 引用？

让我先回答第二个问题：有时。

允许编译器将副本省略到参数中，但前提是您临时传入右值。例如：

```
void foo(Obj o);

foo((Obj()))); //Extra set of parenthesis are needed to prevent Most Vexing Parse 
```

在编译器方便时，可以省略将临时值复制到实参参数中（即：不复制）。

但是，这个副本*永远不会*被忽略：

```
Obj a;
foo(a); 
```

现在，进入第一个。C++ 需要两者，因为您可能希望将两者用于不同的事物。传递价值有助于转移所有权；这在 C++11 中更为重要，我们可以移动而不是复制对象。

# jquery - 在 jquery 中使用变量代替 id 名称

> ID：11905276
> 
> 赞同：0
> 
> 时间：2012-08-10T15:59:28.850
> 
> 标签：jquery, variables, append, mako

我希望使用`i`在 for 循环中递增的变量在 mako 模板中的 div 中创建唯一 id。

```
var i=0;
    % for p in row.photos: 
    %if not p.PRIVATE:              
    /* setup div's for photo containers*/

    $('#photos').append("<div id='+i+' class='thumbnailimage'></div>"); 
    $('#+i+').append("<div id='+i+container' class='thumb_container'></div>");  
    $('#+i+container').append("<div id='+i+thumb' class='large_thumb'></div>");
    $('#+i+thumb').append("<div class='large_thumb_border'></div>");
    $('#+i+thumb').append("<div class='large_thumb_shine'></div>");

    /*insert the image*/
    $(document.createElement("img")).attr({ "src": "${tg.url('photo/%s/%s' % (p.PHOTOINDEX))}" }).appendTo('#+i+'thumb'');

    i++;

    %endif
% endfor 
```

运行 javascript 时希望在 html 中的结果：

```
<div id='photos'>
    <div id='1'class='thumbnailimage'>
        <div id='1container' class='thumb_container'> 
```

等等。相反，我得到：

```
<div id='photos'>
    <div id='+1+' class...>
    </div>
</div><!--end photos--> 
```

有什么建议么？

按照以下建议，我将代码更改为

```
$('#photos').append("<div id="'photo'+i+" class='thumbnailimage'></div>"); 
$("#'photo'+i+").append("<div id="'container'+i+" class='thumb_container'></div>");  
$("#'container'+i+").append("<div id="'thumb'+i+" class='large_thumb'></div>");
$("#'thumb'+i+").append("<div class='large_thumb_border'></div>");
$("#'thumb'+i+").append("<div class='large_thumb_shine'></div>"); 
```

现在我收到一条错误消息：SyntaxError: missing ) after argument list [Break On This Error]

```
$('#photos').append("<div id="photo+i+" class='thumbnailimage'></div>"); 
```

照片中的 p 上有箭头

最后！！我最终不得不在 jQuery 命令之外定义整个变量，因为它在 jquery href 中的 + 符号一直存在问题。我使用以下代码来获得所需的结果。

```
 var i=0;

    % for p in row.photos:
     var photo='photo'+i;
     var photoId="#"+photo;
     var container='container'+i;
     var containerId="#"+container;
     var thumb='thumb'+i;
     var thumbId="#"+thumb;
       $('#photos').append("<div id="+photo+" class='thumbnailimage'></div>"); 
       $(photoId).append("<div id="+container+" class='thumb_container'></div>");  
       $(containerId).append("<div id="+thumb+" class='large_thumb'></div>");
       $(thumbId).append("<div class='large_thumb_border'></div>");   
       $(thumbId).append("<div class='large_thumb_shine'></div>");
       $(document.createElement("img")).attr({ "src": "${tg.url('photo/%s/%s' % (row.GISNUM, p.PHOTOINDEX))}" }).prependTo(thumbId);
% endfor 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:01:26.413

改变这个：

```
$('#photos').append("<div id='+i+' class='thumbnailimage'></div>"); 
```

到：

```
$('#photos').append("<div id='"+i+"' class='thumbnailimage'></div>"); 
```

请注意，如果页面的文档类型不是 HTML5，则 ID 必须以字母开头。

* * *

```
$('#photos').append("<div id='"+i+"' class='thumbnailimage'></div>"); 
$('#'+i).append("<div id='"+i+"container' class='thumb_container'></div>");  
$('#'+i+'container').append("<div id='"+i+"thumb' class='large_thumb'></div>");
$('#'+i+'thumb').append("<div class='large_thumb_border'></div>");
$('#'+i+'thumb').append("<div class='large_thumb_shine'></div>"); 
```

# jquery - 向隐藏字段添加多个值

> ID：11905280
> 
> 赞同：0
> 
> 时间：2012-08-10T15:59:41.190
> 
> 标签：jquery, jquery-ui

我正在编写一个脚本，该脚本从自动完成表单中获取值并将它们添加到隐藏字段中，然后在 php 中对其进行处理并将值添加到数据库中。

```
var oldVal = $("#models").val();
$("#models").val(oldVal+","+ searchcode); 
```

而不是覆盖以前的值，我需要它来存储像这样分隔的逗号。说它应该是 4 次点击，`value="123,1234,12345,123456"` 但它只存储最后一个值两次这样有`value="123456,123456"` 什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:03:24.983

做了一点改进：

```
function appendWords()
{
    var resultObj = $("#result");
    var outputObj = $("#textbox");
    var stringToAppend = resultObj.val().length > 0 ? resultObj.val() + "," : "";
    resultObj .val( stringToAppend + outputObj.val() );
} 
```

看到这个工作：http: [//jsfiddle.net/95hzx/1/](http://jsfiddle.net/95hzx/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:03:22.237

用纯JS写

```
document.getElementById('models').value += "," + searchcode; 
```

请记住，jQuery 是一种“少写 - 多做”的工具 一旦遇到需要你多写的情况，它就不再是工作的有用工具。

# c# - 获取项目内文件夹中文件的内容？

> ID：11905285
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:00:01.077
> 
> 标签：c#, visual-studio

我正在尝试访问我的项目中的文件。

所以我会创建一个名为的新文件夹`Files`，该文件夹内包含各种 HTML 文件。

无论如何，我可以通过访问`"Program/Files/file.html"`或类似的方式访问这些文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:04:29.353

你的意思是这样的吗？

```
using System.IO;
...

string folderPath = AppDomain.CurrentDomain.BaseDirectory; // or whatever folder you want to load..

foreach (string file in Directory.EnumerateFiles(folderPath, "*.html"))
{
    string contents = File.ReadAllText(file);
} 
```

# javascript - 使一组对象与jquery一起拖动

> ID：11905288
> 
> 赞同：0
> 
> 时间：2012-08-10T16:00:11.970
> 
> 标签：javascript, jquery

我有一个 jquery 对象，里面有很多东西。

```
var $item = $();
$("div.t2").click(function(){
    $item = $item.add(this);
    $(this).css("background-color","red");
}); 
```

现在我想流畅地移动所有物品，保持它们之间的关系。

我打算使用可拖动的，并且正在考虑执行以下操作：解析 $items 并存储当前位置，然后最终应用于鼠标差异。我会怎么做呢？

我试图做类似的事情：

```
$item.each(function(){
   //content
}); 
```

但它似乎没有选择东西，同样，一些简单的东西，比如：

```
$item.each(function(){
    $(this).click(function(){
        $(this).css("background-color","green");
    });
}); 
```

在我什至开始拖动整个组之前，这也不适用于选择。

我应该把整个 jquery 对象克隆到一个新的 div 中，然后移动 div ......然后重新应用定位吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:10:14.217

为此，我创建了一个 jquery 对象数组来封装选定的对象。（或多或少地维护指向对象的指针等）。然后当你拖动时，你会做一些花哨的小魔术。

为每个 dom 元素的内容创建 2 个新属性 offx 和 offy。这样，您可以执行以下操作：

```
.draggable({
   start: function(){

      $array.each(function(){
         $(this).attr('offx', $(this).attr('left') - $(event.target).attr('left'));
         $(this).attr('offy', $(this).attr('top') - $(event.target).attr('top'));
      });
   },
   drag: function(){
      $array.each(function(){
         $(this).attr("left", $(event.target).attr("left") + $(this).attr("offx"));
         $(this).attr("top", $(event.target).attr("top") + $(this).attr("offy"));
      });
   }
}); 
```

这样，在拖动时，它将更新与所选对象相关的所有项目。

# sas - SAS中的组处理“无序”

> ID：11905290
> 
> 赞同：0
> 
> 时间：2012-08-10T16:00:16.460
> 
> 标签：sas

当数据分组在一起但无序时，是否有办法在 SAS 中按组处理？

```
data sample;
  input x;
  datalines;
3
3
1
1
2
2
;
run; 
```

尝试打印出每组的第一个：

```
data _null_;
  set sample;
  by x;
  if first.x then do;
    put _all_;
  end;
run; 
```

导致以下错误：

```
x=3 FIRST.x=1 LAST.x=0 _ERROR_=0 _N_=1
ERROR: BY variables are not properly sorted on data set WORK.SAMPLE.
x=3 FIRST.x=1 LAST.x=0 _ERROR_=1 _N_=2
NOTE: The SAS System stopped processing this step because of errors.
NOTE: There were 3 observations read from the data set WORK.SAMPLE.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds 
```

重申一下 -**我不想先对分组数据进行排序 - 我需要按此顺序处理它。** 我知道我可以创建一个代理变量来使用中间数据步和`retain`语句或`lag()`函数进行排序，但我真的在寻找避免此步骤的解决方案。另外，我想在分组处理中使用`first`and`last`关键字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T18:03:03.140

在 BY 语句中使用 NOTSORTED 选项：

```
data _null_;
   set sample;
     by x NOTSORTED;
   if first.x then do;
      put _all_;
      end;
run; 
```

# c# - 使用 Metro 和图像时引发 URI 异常

> ID：11905292
> 
> 赞同：1
> 
> 时间：2012-08-10T16:00:25.230
> 
> 标签：c#, uri, visual-studio-2012

我正在开发适用于 Windows 8 的 Metro UI 应用程序，并且正在尝试从项目文件夹中检索图像。

这是我的初始代码：

```
public static Image GetImage(string path, int width, int height, int margin)
    {
        Image img = new Image();
        img.Width = width;
        img.Height = height;
        img.Margin = new Windows.UI.Xaml.Thickness(margin);

        BitmapImage bi = new BitmapImage(new Uri(path, UriKind.Absolute));

        img.Source = bi;

        return img;
    } 
```

和方法调用：

```
Image = Extension.GetImage("Classe;component/Images/faq.png", 100, 100, 0); 
```

和错误：

```
Exception:Thrown: "Invalid URI: The format of the URI could not be determined." (System.UriFormatException)
A System.UriFormatException was thrown: "Invalid URI: The format of the URI could not be determined." 
```

如果我将 URI 类型更改为相对：

```
Exception:Thrown: "The given System.Uri cannot be converted into a Windows.Foundation.Uri. Please see http://go.microsoft.com/fwlink/?LinkID=215849 for details." (System.ArgumentException)
A System.ArgumentException was thrown: "The given System.Uri cannot be converted into a Windows.Foundation.Uri. Please see http://go.microsoft.com/fwlink/?LinkID=215849 for details." 
```

图片路径是图片/faq.png。设置为内容并始终复制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:16:07.763

查看 Windows.Foundation.Uri 的文档，看起来 WinRT 不支持相对 URI。MS 为 WinRT 资源发明了另一种 URI 格式。

尝试这样的事情，看看它是否有效：

```
new Uri("Classe://MyAssembly/component/Images/faq.png") 
```

注意：您不要添加您的实际程序集名称 - MyAssembly 部分是 LITERAL TEXT。

# javascript - 为年轻用户替代 Javascript 提示框

> ID：11905294
> 
> 赞同：5
> 
> 时间：2012-08-10T16:00:26.477
> 
> 标签：javascript, html, jquery-ui, jquery-plugins

谁能推荐一个更适合年轻用户的 Javascript 提示框替代方案？

```
prompt("Please enter your name:", "Harry Potter"); 
```

[一探究竟。](http://www.w3schools.com/js/tryit.asp?filename=tryjs_prompt)

由于输入框需要为儿童设计，所以我希望提示框更加丰富多彩和活泼。我可以使用任何建议的现有盒子吗？
要求是我必须让用户输入一个字符串，然后接收它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T06:07:27.103

你试过[BootBox](http://bootboxjs.com/)吗？

> Bootbox.js 是一个小型 JavaScript 库，它允许您使用 Twitter 的 Bootstrap 模式创建编程对话框，而无需担心创建、管理或删除任何必需的 DOM 元素或 JS 事件处理程序。

它有一个非常简洁的替代默认 JavaScript 提示框。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-10T16:05:12.550

你试过 jQuery UI 库吗？

在这里你可以看到一个[模态表单的例子](http://jqueryui.com/demos/dialog/#modal-form)

您可以修改样式或从不同的主题中进行选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-14T15:01:02.300

我发现浏览器的提示（确认和删除）框***非常***烦人。

部分为了解决这个问题，我编写了 iocream.js。它是一个围绕 DOM 的示例包装器，具有两种文本输入方法：（`jin`读起来像 C++ 的`cin`）和`jinarea`.

[您可以在此 bitbucket 存储库](https://bitbucket.org/sumukhbarve/iocream)中找到文档，并[在此处](http://iocream.blogspot.in/2013/12/bisection-method-solving-polynomial.html)找到示例。

希望我有所帮助。

**编辑：** 我在[这里发布了类似的答案。](https://stackoverflow.com/questions/17437147/javascript-prompt-alternative/20584996#20584996)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T16:05:33.117

Jquery UI 不错：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T16:11:39.417

一个名为[Impromptu](http://trentrichardson.com/Impromptu/index.php)的 jquery 插件为您提供了很多选项，不仅可以用于提示，还可以用于警报和确认框

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-10T16:20:16.947

qtip2 是另一个不错的免费 javascript 库[http://qtip2.com/](http://qtip2.com/)

# asp.net - Response.write to

> ID：11905296
> 
> 赞同：0
> 
> 时间：2012-08-10T16:00:47.067
> 
> 标签：asp.net, html, vb.net

希望这对某人来说不会是一个难以回答的问题，但是我在网上找到解决方案时遇到了很多麻烦。我正在尝试从后面的代码（它是 VB.net）向我的 asp.net 页面添加一些 HTML。我想将 HTML 添加到页面的头部，但目前只能添加到正文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:04:35.257

你可以把代码放在头部，就像身体一样。例如：

```
<%= CallAMethodThatReturnsAStringOfHtml() %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:07:22.340

您可以尝试在后面的代码中创建一个属性，并在 Page_Load 方法中添加您的 html：

```
Public MyHtml As String 
```

然后在 HTML 的 head 部分中使用文字符号：

```
<%= MyHtml %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:03:08.337

在你的 head 元素上有`runat`属性，你将能够访问它

```
<head id="someHead" runat="server">

</head> 
```

现在在您的代码隐藏中，您可以将其设置为

```
 someHead.InnerHtml="<script src='somelibrary.js' ></script>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-30T23:59:40.507

我这样做了，它奏效了：

在 .aspx 文件上：

... <% Response.Write(GetDisclosureText()); %> ...

在 aspx.cs 文件上：

```
 protected string GetDisclosureText()
    {
        string disclosure = ""; 
        // ...Apply  custom logic ...
        if (!string.IsNullOrEmpty(disclosure))
        {
            return disclosure;
        }
        return "Error getting Disclosure Text";
    } 
```

请注意，唯一的区别是我调用了 Response.Write，而不仅仅是函数。

# jaxb - 使用 MOXy 引发异常的继承映射

> ID：11905298
> 
> 赞同：1
> 
> 时间：2012-08-10T16:00:56.430
> 
> 标签：jaxb, eclipselink, jaxb2, moxy

[我按照MOXY](https://stackoverflow.com/questions/10874711/jaxb-inheritance-in-moxy)中的 JAXB 继承中提到的第二个选项来映射下面列出的父类和子类。MOXy 抛出以下异常，不确定是什么问题

**家长班**

```
public class UnitedStatesAddressData extends AbstractAddress implements UnitedStatesAddress, Serializable, Cloneable
{
    private String primaryAddress;

    public String getPrimaryAddress()
    {
        return primaryAddress;
    }

    public void setPrimaryAddress(final String primaryAddress)
    {
        this.primaryAddress = primaryAddress;
    }
} 
```

**儿童班**

```
public class TokenizedUnitedStatesAddressData extends UnitedStatesAddressData implements TokenizedUnitedStatesAddress,
        CloneableAddress
{
    private String houseNumber;

    private String preDirectional;

    private String streetName;

    private String streetType;

//getters and setters ignored
} 
```

**外部绑定文件**

```
<?xml version="1.0" encoding="UTF-8"?>
<xml-bindings xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.eclipse.org/eclipselink/xsds/persistence/oxm http://www.eclipse.org/eclipselink/xsds/eclipselink_oxm_2_4.xsd"
   version="2.4" package-name="com.abc.ic.domain.impl.country.us" xml-accessor-type="PROPERTY">
   <xml-schema element-form-default="QUALIFIED" namespace="http://xml.abc.com/XMLSchema/InterConnect">
      <!-- Do not specify 'prefix'. We doesn't want the namespace prefix in our instance documents as they increase the payload size. -->
      <xml-ns namespace-uri="http://xml.abc.com/XMLSchema/InterConnect" />
   </xml-schema>
   <java-types>
      <java-type name="TokenizedUnitedStatesAddressData">
         <xml-root-element name="USAddress" />
         <xml-type prop-order="preDirectional houseNumber streetName streetType postDirection unitDesignator apartmentNumber primaryAddress secondaryAddress cityName stateAbbreviation zipCode" />
         <java-attributes>
            <xml-element name="StreetPreDirection" java-attribute="preDirectional" />
            <xml-element name="StreetNumber" java-attribute="houseNumber" />
            <xml-element name="StreetName" java-attribute="streetName" />
            <xml-element name="StreetType" java-attribute="streetType" />
            <xml-element name="StreetPostDirection" java-attribute="postDirection" />
            <xml-element name="UnitDesignator" java-attribute="unitDesignator" />
            <xml-element name="UnitNumber" java-attribute="apartmentNumber" />
            <xml-element name="AddressLine1" java-attribute="primaryAddress" />
            <xml-element name="AddressLine2" java-attribute="secondaryAddress" />
            <xml-element name="City" java-attribute="cityName" />
            <xml-element name="State" java-attribute="stateAbbreviation" />
            <xml-element name="PostalCode" java-attribute="zipCode" />
         </java-attributes>
      </java-type>
      <java-type name="UnitedStatesAddressData" xml-transient="true">
         <xml-root-element />
      </java-type>
   </java-types>
</xml-bindings> 
```

**错误**

```
javax.xml.bind.JAXBException: 
Exception Description: The property or field primaryAddress is annotated to be transient so can not be included in the proporder annotation.
 - with linked exception:
[Exception [EclipseLink-50009] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.JAXBException
Exception Description: The property or field primaryAddress is annotated to be transient so can not be included in the proporder annotation.]
    at org.eclipse.persistence.jaxb.JAXBContext$TypeMappingInfoInput.createContextState(JAXBContext.java:908)
    at org.eclipse.persistence.jaxb.JAXBContext.<init>(JAXBContext.java:157)
    at org.eclipse.persistence.jaxb.JAXBContextFactory.createContext(JAXBContextFactory.java:170)
    at org.eclipse.persistence.jaxb.JAXBContextFactory.createContext(JAXBContextFactory.java:157)
    at org.eclipse.persistence.jaxb.JAXBContextFactory.createContext(JAXBContextFactory.java:117)
    at org.eclipse.persistence.jaxb.JAXBContextFactory.createContext(JAXBContextFactory.java:107)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:202)
    at javax.xml.bind.ContextFinder.find(ContextFinder.java:331)
    at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:574)
    at com.abc.ic.platform.sts.domain.transformation.response.JaxbTest.beforeClass(JaxbTest.java:31)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: Exception [EclipseLink-50009] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.JAXBException
Exception Description: The property or field primaryAddress is annotated to be transient so can not be included in the proporder annotation.
    at org.eclipse.persistence.exceptions.JAXBException.transientInProporder(JAXBException.java:225)
    at org.eclipse.persistence.jaxb.compiler.TypeInfo.setProperties(TypeInfo.java:342)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.buildTypeInfo(AnnotationsProcessor.java:755)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.postBuildTypeInfo(AnnotationsProcessor.java:669)
    at org.eclipse.persistence.jaxb.compiler.XMLProcessor.processXML(XMLProcessor.java:344)
    at org.eclipse.persistence.jaxb.compiler.Generator.<init>(Generator.java:145)
    at org.eclipse.persistence.jaxb.JAXBContext$TypeMappingInfoInput.createContextState(JAXBContext.java:904)
    ... 28 more 
```

**更新**

我已经通过删除“prop-order”对此进行了测试，**除了我无法再控制生成的 XML 中元素的顺序之外，**它工作正常。我相信这是代码中的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:47:17.410

造成这种情况的原因是子类覆盖了父类中的方法，如下所示，但由于父类已定义为 xml-transient="true"，因此来自 TypeInfo 的以下检查失败。

**覆盖 getPrimaryAddress 的子类**

```
public class TokenizedUnitedStatesAddressData extends UnitedStatesAddressData implements TokenizedUnitedStatesAddress,
        CloneableAddress
{
@override
public String getPrimaryAddress()
{
   return primaryAddress;
}
} 
```

**TypeInfo.java 违规代码**

```
if (p.isTransient() && propOrderList.contains(p.getPropertyName()))
{
throw org.eclipse.persistence.exceptions.JAXBException.transientInProporder(p.getPropertyName());
} 
```

* * *

**更新 2**

问题不在于 AbstractAddress。经过一些调试，问题似乎与以下逻辑有关`AnnotationProcessor.getPropertyPropertiesForClass(final JavaClass cls, final TypeInfo info, final boolean onlyPublic, final boolean onlyExplicit)`

```
if ((setMethod == null) && !(hasJAXBAnnotations(getMethod)))
{
    // if there's no corresponding setter, and not explicitly
    // annotated, don't process
    isPropertyTransient = true;
} 
```

此方法将**标记**任何没有*将*get/set 方法定义为“瞬态”的方法。就我而言，我只覆盖了类中的`getPrimaryAddress()`方法，`TokenizedUnitedStatesAddressData`而不是相应的设置器。因此，将`Annotationprocessor`其指定为**瞬态**属性，忽略了此方法被覆盖的事实。

**使固定**

在确保在瞬态检查中正确处理覆盖的方法后，该问题得到修复，如下所示

```
if ((setMethod == null) && !(hasJAXBAnnotations(getMethod)))
{
    if (!isMethodOverrriden(cls.getQualifiedName(), getMethod.getName()))
    {
        // if there's no corresponding setter, and not explicitly
        // annotated, don't process
        isPropertyTransient = true;
    }
}

public static boolean isMethodOverrriden(final String classQualifiedName, final String methodName)
    {
        Method myMethod;
        try
        {
            myMethod = Class.forName(classQualifiedName).getMethod(methodName, null);
        }
        catch (Exception e1)
        {
            return false;
        }

        Class<?> declaringClass = myMethod.getDeclaringClass();
        if (declaringClass.equals(Object.class))
        {
            return false;
        }

        Class<?> superclass = declaringClass.getSuperclass();
        if (superclass == null)
        {
            return false;
        }
        else
        {
            try
            {
                superclass.getMethod(myMethod.getName(), myMethod.getParameterTypes());
            }
            catch (NoSuchMethodException e)
            {
                // recursively check all super classes
                isMethodOverrriden(superclass.getName(), methodName);
            }
            return true;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:56:43.150

即使您已标记`UnitedStatesAddressData`为`@XmlTransient`（使用 MOXy 的外部映射文档），它的超类`AbstractAddress`仍然是映射类。`AbstractAddress`因此，无法在`propOrder`设置中指定from 的此类属性`TokenizedUnitedStatesAddressData`。解决方案也是制作`AbstractAddress` `@XmlTransient`。

**使固定**

我已经修改了您的映射文档以在下面执行此操作，假设`AbstractAddress`该类与您的域模型的其余部分位于同一个包中。

```
<?xml version="1.0" encoding="UTF-8"?>
<xml-bindings xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.eclipse.org/eclipselink/xsds/persistence/oxm http://www.eclipse.org/eclipselink/xsds/eclipselink_oxm_2_4.xsd"
   version="2.4" package-name="com.abc.ic.domain.impl.country.us" xml-accessor-type="PROPERTY">
   <xml-schema element-form-default="QUALIFIED" namespace="http://xml.abc.com/XMLSchema/InterConnect">
      <!-- Do not specify 'prefix'. We doesn't want the namespace prefix in our instance documents as they increase the payload size. -->
      <xml-ns namespace-uri="http://xml.abc.com/XMLSchema/InterConnect" />
   </xml-schema>
   <java-types>
      <java-type name="TokenizedUnitedStatesAddressData">
         <xml-root-element name="USAddress" />
         <xml-type prop-order="preDirectional houseNumber streetName streetType postDirection unitDesignator apartmentNumber primaryAddress secondaryAddress cityName stateAbbreviation zipCode" />
         <java-attributes>
            <xml-element name="StreetPreDirection" java-attribute="preDirectional" />
            <xml-element name="StreetNumber" java-attribute="houseNumber" />
            <xml-element name="StreetName" java-attribute="streetName" />
            <xml-element name="StreetType" java-attribute="streetType" />
            <xml-element name="StreetPostDirection" java-attribute="postDirection" />
            <xml-element name="UnitDesignator" java-attribute="unitDesignator" />
            <xml-element name="UnitNumber" java-attribute="apartmentNumber" />
            <xml-element name="AddressLine1" java-attribute="primaryAddress" />
            <xml-element name="AddressLine2" java-attribute="secondaryAddress" />
            <xml-element name="City" java-attribute="cityName" />
            <xml-element name="State" java-attribute="stateAbbreviation" />
            <xml-element name="PostalCode" java-attribute="zipCode" />
         </java-attributes>
      </java-type>
      <java-type name="UnitedStatesAddressData" xml-transient="true">
         <xml-root-element />
      </java-type>
      <java-type name="AbstractAddress" xml-transient="true">
         <xml-root-element />
      </java-type>
   </java-types>
</xml-bindings> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/08/jaxbs-xmltransient-and-property-order.html](http://blog.bdoughan.com/2012/08/jaxbs-xmltransient-and-property-order.html)

# eclipse - 我可以分享我的 Mylyn 本地存储库吗？

> ID：11905299
> 
> 赞同：1
> 
> 时间：2012-08-10T16:00:58.477
> 
> 标签：eclipse, bug-tracking, bugzilla, mylyn, connector

我是一名独立开发人员，但有时会在计算机之间切换。如果我可以维护一个 Mylyn 任务存储库，我会很高兴的。然而，据我所见，所提供的连接器每个都使用专有的任务格式，而且奇怪的是似乎没有提供分层组织任务的能力（嵌套的子任务在编辑器中很好地缩进显示）。

我知道我可以更改任务数据的存储位置，但我确信如果我尝试通过网络从两台计算机同时访问任务数据库，事情将无法正常工作。此外，如果远程计算机处于脱机状态，这将不起作用。

有没有办法在这样的环境中可靠地共享和保持同步本地任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:40:56.623

Mylyn 的创建者最感兴趣的是支持商业问题跟踪应用程序和 ALM 工具的连接器。

但是，您可以使用任务列表视图的弹出菜单中提供的导入/导出功能。或者只是使用从任务列表视图拖放到本地文件夹、Web 浏览器或电子邮件客户端中的下拉框。

或者，您可以安装独立的问题跟踪器，例如 Trac 或 JIRA（10 个用户只需 10 美元）。

# java - 增加 Java 小程序的堆大小

> ID：11905301
> 
> 赞同：2
> 
> 时间：2012-08-10T16:01:05.370
> 
> 标签：java, applet, 64-bit, jnlp, heap-size

我将我的一个程序从一个独立的 Java 应用程序移植到一个 Java 小程序。该应用程序处理大型图像文件，因此我需要更多堆空间，因此将它们加载到内存中。然后将图像用作我使用 JOGL 的 openGL 窗口中的纹理数据

该应用程序在 Eclipse 中运行良好（作为小程序以及独立），如果我将独立应用程序导出为可执行 jar。我在各种系统上进行了测试（带有 4 gig ram 的 Windows XP 32、带有 12 gig ram 的 Windows XP 64 和带有 4 和 8 gig ram 的 Windows 7 64 位）。

当我导出程序的小程序版本时出现问题。在我签署了 jar 并尝试在浏览器（经过测试的 Firefox 和 IE）中运行它之后，应用程序总是在上述 64 位机器上崩溃并出现 OutOfMemory 异常。

但是在 Windows XP 32 位机器上，经过一番摆弄后它可以工作，但我不知道为什么，因为我所做的只是尝试不同的解决方案，并且其中一个工作以某种方式工作，即使这种方式也会导致之前的尝试崩溃。

我尝试了四种增加堆空间的方法

在我尝试的html文件中：

```
<PARAM name="java_arguments" value="-Xmx1600m"> 
```

这没有用。

然后我尝试通过带有 -Xmx1600M 参数的 Java 菜单（开始 -> 控制面板 -> Java 选项卡 -> Java 运行时环境设置）直接增加堆。这顶帽子也没什么影响。

之后，我使用了 Jogamp 的人提供的 jnlp 文件。我在那里添加了

```
<j2se version="1.6+" java-vm-args="-Xmx1600m" 
    href="http://java.sun.com/products/autodl/j2se"/> 
```

在资源标签内。这最初也没有效果。

最后我添加了

```
<j2se version="1.6+" initial-heap-size="256M" max-heap-size="1600M" 
    href="http://java.sun.com/products/autodl/j2se"/> 
```

在资源标签内，不知何故，经过几次尝试，我绕过了四种不同的解决方案并清除了它工作的小程序缓存（但仅在 32 位 WinXP 机器上）。

但是我没有成功尝试在 64 位机器上运行小程序，而且我完全不知道现在该做什么，因为经过一些研究，这四种方法似乎是唯一的一种。

提前感谢您的帮助。

我将添加两个 jnlp 文件和启动 applet 的 html 文件。

html:

```
<html>
<head>
    <title>Some title</title>
</head>
<body>
<center>
    <applet code="guiconcepts/AppletTest.class" 
            width=1600 
            height=1010
            archive="SConfigTest.jar">
        <param name="codebase_lookup" value="false">
        <param name="subapplet.classname" value="SConfigTest">
        <param name="subapplet.displayname" value="SConfigTest">
        <param name="noddraw.check" value="true">
        <param name="progressbar" value="true">
        <param name="jnlpNumExtensions" value="1">
        <param name="jnlpExtension1"
                 value="http://download.java.net/media/jogl/jsr-231-2.x-
                           webstart/jogl-core.jnlp">
        <param name="java_arguments" value="-Dsun.java2d.noddraw=true">
        <param name="jnlp_href" value="AppletTest.jnlp">
    </applet>
</center>
</body>   
</html> 
```

AppletTest.jnlp：

```
<?xml version="1.0" encoding="utf-8"?>
<jnlp spec="1.5+" codebase="./"
      href="AppletTest.jnlp">

<information>
    <title>Some title</title>
    <vendor>Some vendor</vendor>
    <homepage href="http://www.somePage.com"/>
    <description>Java Applet Test</description>
    <description kind="short">Test of a Java Applet</description>
    <offline-allowed/>
</information>
<update check="background" policy="always"/>

<resources>
   <j2se version="1.6+" href="http://java.sun.com/products/autodl/j2se"/>
   <property name="sun.java2d.noddraw" value="true"/>
   <extension name="JOGL" href="JOGL.jnlp" />
   <jar href="jai_core.jar" />
   <jar href="jai_codec.jar" />
   <jar href="mlibwrapper_jai.jar" />
   <jar href="SConfigTest.jar" main="true"/>
</resources>

<applet-desc 
   name="AppletTest"
   main-class="guiconcepts.AppletTest"
   width="1600"
   height="1010">
</applet-desc>
</jnlp> 
```

JOGL.jnlp：

```
<?xml version="1.0" encoding="utf-8"?>
<jnlp spec="1.0+" codebase="./"
  href="JOGL.jnlp">

  <information>
    <title>JOGL libraries</title>
    <vendor>JogAmp Community</vendor>
    <homepage href="http://jogamp.org/"/>
    <description>JOGL libraries</description>
    <description kind="short">
                  All JARs and native libraries for JOGL.</description>
    <offline-allowed/>
  </information>
  <update check="background" policy="always"/>

  <security>
    <all-permissions/>
  </security>

  <resources>
    <jar href="gluegen-rt.jar" />
    <jar href="jogl.all.jar" />
  </resources>

  <resources os="Windows" arch="x86">
    <nativelib href = "gluegen-rt-natives-windows-i586.jar" />
    <nativelib href = "jogl-all-natives-windows-i586.jar" />
  </resources>
  <resources os="Windows" arch="amd64">
    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
    <nativelib href = "jogl-all-natives-windows-amd64.jar" />
  </resources>
  <resources os="Windows" arch="x86_64">
    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
    <nativelib href = "jogl-all-natives-windows-amd64.jar" />
  </resources>
  <resources os="Linux" arch="i386">
    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
    <nativelib href = "jogl-all-natives-linux-i586.jar" />
  </resources>
  <resources os="Linux" arch="x86">
    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
    <nativelib href = "jogl-all-natives-linux-i586.jar" />
  </resources>
  <resources os="Linux" arch="amd64">
    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
    <nativelib href = "jogl-all-natives-linux-amd64.jar" />
  </resources>
  <resources os="Linux" arch="x86_64">
    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
    <nativelib href = "jogl-all-natives-linux-amd64.jar" />
  </resources>
  <resources os="Mac OS X" arch="i386">
    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
    <nativelib href = "jogl-all-natives-macosx-universal.jar" />
  </resources>
  <resources os="Mac OS X" arch="x86_64">
    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
    <nativelib href = "jogl-all-natives-macosx-universal.jar" />
  </resources>

  <component-desc />
</jnlp> 
```

[编辑：]似乎我找到了导致问题的原因（但仍然没有解决方案）。如果我使用任何给定浏览器的 32 位版本启动小程序，浏览器将启动 32 位 jre，它无法处理 jnlp 文件中的 jvm 设置。

这真的很奇怪，因为在 32 位机器上调用 32 位 jvm 工作得很好。

如果我使用 64 位浏览器（如 IE 64 位版本或 Nightly Firefox 64 版本）启动小程序，则会调用“正确”的 jvm 并且它运行正常。

所以我想真正的问题是如何从 32 位浏览器启动 64 位 jvm（这甚至可能吗？）。

但是我写了一个小测试程序来重现错误。该程序将一个大图像存储在一个数组中。使用 32 位浏览器，您应该能够加载 2-3 张图像，直到出现 OutOfMemoryException。如果您想测试程序，您必须创建一个 jar 并在之后对其进行签名并将其命名为 SConfigTest.jar。

```
import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.util.Properties;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JApplet;
import javax.swing.JLabel;

public class AppletTest extends JApplet {

    private static final long serialVersionUID = 1L;

    public AppletTest() {

    }

    public void init() {

        /*
         * settings if using a proxy server
         */
        /*
        Properties p = System.getProperties();
        p.put("http.proxyHost", "proxy.address.com");
        p.put("http.proxyPort", "8080");
        System.setProperties(p);
        //*/
        System.out.println("Applet initialized");
    }
    public void start() {

        System.out.println("Applet starting");

        BufferedImage[] imgArray = new BufferedImage[20];

        /*
         * load 20 copies of the image into the memory
         */
        for(int i = 0; i < imgArray.length; i++) {

            try {

                URL imageUrl = new URL("http://www.raize.ch/Reisen/" +
                                       "velo-eurasien/karten-rollover/" +
                                       "western-tibet-highway_" +
                                       "satellitenbild_grossplus.jpg");

                InputStream in = imageUrl.openStream();
                imgArray[i] = ImageIO.read(in);
                in.close();
                System.out.println("Image no. " + (i + 1) + " loaded!");
            } 
            catch (IOException e) {

                e.printStackTrace();
            }
        }       

        System.out.println("All images loaded");

        /* 
         * display the image inside the browser window
         */
        this.setSize(imgArray[0].getWidth(), imgArray[0].getHeight());
        this.getContentPane().add(new JLabel(new ImageIcon(imgArray[0])));
    }

    public void stop() {

        System.out.println("Applet stopping");
    }

    public void destroy() {

        System.out.println("Applet destroyed");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T03:42:54.790

坚持`initial-heap-size="256M" max-heap-size="1600M"`如果只是因为拼写错误会更容易出现。

> 不知何故，经过几次尝试，我通过四种不同的解决方案盘旋并清除了它工作的小程序缓存（但仅在 32 位 WinXP 机器上）。

这里重要的不是小程序缓存，而是缓存的 JNLP 文件。转到 Java 控制面板，找到该应用程序。并在运行之间卸载它。

# android - SimpleCursorAdapter 错误：列不存在 - 仅在 Android 2.1 中发生

> ID：11905305
> 
> 赞同：0
> 
> 时间：2012-08-10T16:01:16.653
> 
> 标签：android, cursor, expandablelistview, simplecursoradapter, android-2.1-eclair

我有一个扩展的活动`ExpandableListActivity`。我在 Android 2.2+ 上运行应用程序时没有任何问题。但是，当我在 Android 2.1 模拟器上运行它时，此活动强制关闭（应用程序中的其他活动没有问题）。我完全被难住了。

我创建了一个自定义适配器来与`ExpandableListView`that extends一起使用`SimpleCursorTreeAdapter`。我正在使用以下代码设置列表适配器：

```
customExpandableListAdapter = new BeerFlightsExpandableListAdapter(
                                    this,                                           // context
                                    beerFlights,                                    // cursor
                                    R.layout.beer_flight_list_item,                 // group layout
                                    new String[]{"_id", "name"},                    // group FROM
                                    new int[] {R.id.flight_id, R.id.flight_name},   // group TO
                                    R.layout.beer_flight_beer_list_item,            // child layout
                                    new String[]{"_id", "name"},                    // child FROM
                                    new int[]{R.id.beer_id, R.id.beer_name});       // child TO
setListAdapter(customExpandableListAdapter); 
```

我正在使用以下代码来获取**组**光标：

```
String sql =
        "SELECT beer_flights._id, beer_flights.name, COUNT(beer_flight_beers.beer_id) AS beer_count"+
        " FROM beer_flight_beers"+
            " INNER JOIN beer_flights ON beer_flight_beers.beer_flight_id = beer_flights._id"+
            " INNER JOIN beer_locations ON beer_flights.location_id = beer_locations.location_id AND beer_locations.beer_id = beer_flight_beers.beer_id"+
        " WHERE beer_flights.location_id = ?"+
        " GROUP BY beer_flights._id"+
        " ORDER BY beer_flights.priority ASC";

Cursor cur = db.rawQuery(sql, new String[]{ locationId.toString() }); 
```

我正在使用以下代码来获取**子**光标：

```
String sql =
        "SELECT DISTINCT beers._id, beers.name, beers.brewery"+
        " FROM beer_flight_beers"+
            " INNER JOIN beers ON beer_flight_beers.beer_id = beers._id"+
            " INNER JOIN beer_flights ON beer_flight_beers.beer_flight_id = beer_flights._id"+
            " INNER JOIN beer_locations ON beer_flights.location_id = beer_locations.location_id AND beer_flight_beers.beer_id = beer_locations.beer_id"+
        " WHERE beer_flight_beers.beer_flight_id = ?"+
        " ORDER BY beers.name ASC";

Cursor cur = db.rawQuery(sql, new String[]{ flightId.toString() }); 
```

正如我所说，这在适用于 Android 2.2+ 的模拟器以及运行 2.3.3 的 Droid 2 和运行 2.3.6 的 Droid 4 上完美运行。但是，当我在 Android 2.1 模拟器中运行相同的代码时，我收到以下错误：

```
Uncaught handler: thread main exiting due to uncaught exception
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.absolutemg.jlbeers/com.absolutemg.jlbeers.BeerFlights}:
java.lang.IllegalArgumentException: column 'name' does not exist

[snip]

Caused by: java.lang.IllegalArgumentException: column 'name' does not exist
at android.database.AbstractCursor.getColumnIndexOrThrow(AbstractCursor.java:314)
at android.widget.SimpleCursorTreeAdapter.initFromColumns(SimpleCursorTreeAdapter.java:194)
at android.widget.SimpleCursorTreeAdapter.initGroupFromColumns(SimpleCursorTreeAdapter.java:200)
at android.widget.SimpleCursorTreeAdapter.init(SimpleCursorTreeAdapter.java:180)
at android.widget.SimpleCursorTreeAdapter.<init>(SimpleCursorTreeAdapter.java:169)
at com.absolutemg.jlbeers.BeerFlights$BeerFlightsExpandableListAdapter.<init>(BeerFlights.java:395)
at com.absolutemg.jlbeers.BeerFlights.onCreate(BeerFlights.java:100) 
```

两个游标都有**_id**和**name**列。所以我不确定为什么我会收到错误消息`column 'name' does not exist`。

我调整了一些东西以更改**父**光标以返回**flight_id**和**flight_name**列，并相应地更改了列表适配器。当我这样做时，活动不再崩溃。它显示了我的组名。但是，当我单击组以将其打开时，它会再次强制关闭。

这些相同的更改导致活动在 Android 2.2+ 中强制关闭（我假设是因为我的光标中没有名为**_id的列）。**所以这真的不是解决办法。

`rawQuery()`游标或 2.1 中的功能在 2.2 中是否有所不同？我完全不知道如何解决这个问题。

我很想放弃对这个应用程序对 Android 2.1 的支持，但我们确实有一些用户在运行 2.1（它仅占我们用户群的 1.26% 左右，但我不想将任何人排除在更新的应用程序之外）。

我在 SO 中找到的其他问题都与此完全相同，而且我在其他任何地方都没有找到任何东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:26:43.530

我设法解决了问题……发布后仅几分钟。这个解决方案让我觉得自己像个傻瓜。:(

我修改了游标的查询以显式设置列名，如下所示：

**组光标**

```
SELECT beer_flights._id AS _id, beer_flights.name AS name, COUNT(beer_flight_beers.beer_id) AS beer_count 
```

**子光标**

```
SELECT DISTINCT beers._id AS _id, beers.name AS name, beers.brewery AS brewery 
```

在我这样做之后，在我正在测试的所有 Android 版本中，一切都按预期工作。

有谁知道**为什么**我需要为 Android 2.1 而不是任何更高版本这样做？这对我来说似乎很愚蠢，但这就是解决问题的方法。

可能是因为查询的表名在列前面。这是我目前唯一的猜测。

# java - 在二叉搜索树中处理相同的数据

> ID：11905315
> 
> 赞同：0
> 
> 时间：2012-08-10T16:02:16.403
> 
> 标签：java, data-structures, binary-tree, binary-search-tree

我正在自学数据结构，目前正在研究二叉搜索树。我很好奇如果您有相同的数据，您将如何对树进行排序。例如说我的数据由`[4,6,2,8,4,5,7,3]`.

1.  我将 4 设置为根元素
2.  把 6 放在它的右边
3.  把 2 放在 4 的左边
4.  把 8 放在 6 的右边

然后我到了 4 我应该把它放在哪里`4=4`？向左还是向右？

选项1 ![选项1](../Images/b089b62efab2e0bad7f57b87270b5b2c.png)

选项#2 ![选项 2](../Images/58cf4427f50ad0af7eab01bf056f37ea.png)

其中一个是正确的还是两者都错了？如果他们都错了，你能告诉我他们应该如何排序。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:12:47.133

通常二叉树不允许数据重复。如果您进行自定义实现，则可以存储元素计数。Java 中的 TreeSet 就是一个例子——它只包含唯一的元素。

实际上，您列出的案例破坏了树的整个结构。搜索操作现在看起来很奇怪，并且无法使用*O(ln n)*执行。在最坏的情况下需要*O(n)*，所以你失去了这个数据结构的所有好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:05:08.507

如果这是一个排序树，那么无论哪种方式，您所拥有的都可以正常工作；最后，您将进行树遍历并转储数据。

如果这是一个搜索树，那么一旦遇到额外的（冗余）数据，我就会删除它；“它存在”。您确实说过这是一个搜索树，虽然并不理想，但它实际上并没有损坏 - 如果您搜索“4”，您将简单地捕获根节点（在这种情况下），并且永远不会低于该根节点以查看任何其他“4”。它不是最佳的，周围有所有额外的#。

无论您选择哪种方式，都会有最好的情况和最坏的情况；不要太担心左/右决定 - 通常没关系。如果您对已知数据流中的细节有扎实的掌握，您就可以针对该特定情况做出最佳决策。

# c++ - 如何在 C++ 中使用 STL 列表创建循环

> ID：11905316
> 
> 赞同：0
> 
> 时间：2012-08-10T16:02:16.077
> 
> 标签：c++, list, stl

这是一道面试题：如何使用 STL 列表容器创建循环？

我是新手。我搜索了这个问题并没有找到任何问题。如果这是一个老问题，请给我链接并删除此帖子。

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:08:16.080

> *如何使用 STL 列表容器创建循环？*

你不能。

`std::list`有开始也有结束。对数据结构的所有访问都受到严格控制，因此符合标准的程序根本无法生成非终止列表。

**Ps** 我假设面试官实际上是想说“ `std::list`”而不是“STL 列表”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:10:54.813

一个可能的答案是：当多个线程同时操作该`list`结构时，可能会发生这种情况。假设两个线程想要`push_back`进入一个已经形成的`list`. 如果列表已经有`b`and `a`，则循环列表可能如下所示：

```
 .--------------------------.
 (                            )
  `-> a <-> SENTINEL <-> b <-' 
```

一个螺纹`c`同时插入另一个螺纹`d`。他们每个人都想像这样附加到后面`SENTINEL`：

```
a <-> c <-> SENTINEL
a <-> d <-> SENTINEL 
```

但是，最终可能会形成一个循环：

```
 .------------.
a. `-.           )
  `-> c <-> d <-'
             <--> SENTINEL <-> b (<-> a) 
```

前向链接很好：`b -> a -> c -> d`
但反向链接会循环：`d -> c -> d`...

发生这种情况是因为 SENTINEL 的指针在没有互斥的情况下被读取、取消引用和修改。

# php - 如何每分钟运行 javascript 并重新加载 DIV 容器（计时器）？

> ID：11905317
> 
> 赞同：0
> 
> 时间：2012-08-10T16:02:26.180
> 
> 标签：php, javascript, html, timer

我需要每分钟运行一次函数**createChartControl 。**每次执行该函数时，都应该更新DIV 容器**GanttDiv的内容。**问题是函数**createChartControl**只执行一次。如何正确添加计时器？

```
<script type="text/javascript" language="JavaScript">
function createChartControl(htmlDiv1)
{
    // ...
}
(function(){
    createChartControl('GanttDiv');
})();
</script>

<script>
 $(document).ready(function() {
    $("#GanttDiv").(function(){ 
        createChartControl('GanttDiv');
    })();
    var refreshId = setInterval(function() {
        $('#GanttDiv').fadeOut("slow", function () {
            $(this).(function(){ 
                createChartControl('GanttDiv');
            })().fadeIn("slow");
        });
    }, 60000);
    $.ajaxSetup({ cache: false });
});
</script>

<div style="width:100%; height:350px; position:relative" id="GanttDiv" class="GanttDiv"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:10:16.777

您`setInterval`似乎是正确的，但您在第一次执行时出错。试试这个：

```
var refreshId = setInterval(function() {
    $('#GanttDiv').fadeOut("slow", function () {
        createChartControl('GanttDiv');
        $(this).fadeIn("slow");
    });
}, 60000); 
```

此外，如果您已经将 id 传递给`createChartControl`函数，则不需要这样做（即，使用未修改的 jQuery 也是无效的）：

```
$("#GanttDiv").(function(){ 
    createChartControl('GanttDiv');
})(); 
```

你可以做

```
createChartControl('GanttDiv'); 
```

# list - Sencha Touch 列表不会在浏览器中加载数据

> ID：11905325
> 
> 赞同：0
> 
> 时间：2012-08-10T16:02:52.200
> 
> 标签：list, sencha-touch, sencha-touch-2, sencha-architect

我有一个使用 Sencha Architect 2.0.0 制作的非常简单的 Sencha Touch 2.0.1 应用程序：从在线 json 文件加载的项目列表（[此处](http://listtest.webs.com/data.json)）。

如果我将它导出到 APK 并将其安装在我的机器人上，它会完美显示。但是，如果我在 Chrome 或 Safari 上尝试，他们会说“正在加载...”，然后在列表应显示的位置显示“空”字样。

我在 Firebug 中收到此错误：（`GET http://listtest.webs.com/data.json?_dc=1344620739517&page=1&start=0&limit=25 x 166ms`“x”用红色圈出，我猜这意味着请求失败）。响应字段是空白的，即使那是一个有效的 URL。

这是我的完整代码的链接。感谢您提供的任何帮助。

.xda 存档：[http](http://www.mediafire.com/?11ism2o13gkcz27)
://www.mediafire.com/?11ism2o13gkcz27 .zip 文件：[http ://www.mediafire.com/?f76by4d445vb6zu](http://www.mediafire.com/?f76by4d445vb6zu)

额外信息：我正在使用带有默认配置的 WAMPSERVER 2.2，我的大多数其他应用程序也遇到了这个问题。Sencha的[CityBars 教程](http://docs.sencha.com/architect/2-0/#!/guide/first_mobile_app)完全在 Chrome 中运行，并在 Safari 中加载标题栏，但不加载任何要单击的项目。

即使是说“该代码对我有效/不适合”的评论也会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:07:35.583

我使用了 PHP 文件 + JsonP 存储，基于[此处](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.proxy.JsonP)的源代码。

它完美地工作。不需要特殊配置，只需一个默认的 JsonP 存储，其 URL 设置为我的新 PHP 文件。出于某种原因，当我手动“加载数据”时没有任何显示，但它可以在浏览器中运行，这才是最重要的。

# javascript - jqueryui按钮不显示

> ID：11905327
> 
> 赞同：0
> 
> 时间：2012-08-10T16:02:55.280
> 
> 标签：javascript, jquery, user-interface

我刚刚使用 jquery ui 主题滚轮创建了一个主题。我刚刚下载了它，然后打开了它附带的 index.html 以显示所有内容。除了按钮和单选按钮外，所有内容都会显示。这是我真正关心的唯一部分。有趣的是，这是唯一不起作用的部分。我在 IE、Chrome 和 Firefox 中对其进行了测试，但它们都没有显示按钮。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T18:11:08.717

没关系。它们实际上并不包含按钮的代码，而是包含其他所有代码。

# php - 在PHP中将行从SQL插入数组

> ID：11905340
> 
> 赞同：0
> 
> 时间：2012-08-10T16:03:34.313
> 
> 标签：php, sql, database

谁能告诉我为什么有`row[0]`数据，但是`row[1]`是（空的）？`row[3]``undefined`

我的数据库中有 4 行具有`bookid = '35'`.

```
<?php
$mysqli = new mysqli('localhost', 'root', '', 'assignment3');
$query = "select image from images where BookId='35'";
$result = $mysqli->query($query);
$row = $result->fetch_array(MYSQLI_NUM);
echo $row[0];
echo $row[1];
echo $row[2];
echo $row[3];
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:05:03.017

`fetch_array`每次要扩展到下一行时都需要使用。使用数字索引 ( `0, 1, 2 ... n`) 仅按行中的数字检索列。

尝试这个：

```
$row = $result->fetch_array(MYSQLI_NUM);
print_r($row); // row 1
$row = $result->fetch_array(MYSQLI_NUM);
print_r($row); // row 2
$row = $result->fetch_array(MYSQLI_NUM);
print_r($row); // row 3
$row = $result->fetch_array(MYSQLI_NUM);
print_r($row); // row 4 
```

如果这对您有意义，您甚至可以将其抽象为一个`for`循环：

```
for ($i = 0; $i < 4; $i++) {
    $row = $result->fetch_array(MYSQLI_NUM);
    print_r($row);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:12:34.433

使用起来非常方便[`mysqli_fetch_all()`](http://php.net/manual/en/mysqli-result.fetch-all.php)，因为它在一个步骤中将所有行作为数组返回。但是如果结果集很大，它可能会消耗大量内存。

例如。

```
<?php
$mysqli = new mysqli('localhost', 'root', '', 'assignment3');
$query = "select image from images where BookId='35'";
$result = $mysqli->query($query);
//MYSQLI_NUM for numerical array,
//This will return both associative and numerical, if not specify any parameters.
$row = $result->mysqli_fetch_all(MYSQLI_NUM);
//this will print all rows
print_r($row);

//now it is valid to call
echo $row[0];
echo $row[1];
echo $row[2];
echo $row[3];
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T18:03:12.003

```
select image from images where BookId='35' 
```

这只返回一列，这就是为什么 $row[0] 有效而 $row[1]

你需要这个：

```
SELECT * FROM images WHERE BookId = '35' 
```

# android - 以编程方式从支持库创建 GridLayout

> ID：11905345
> 
> 赞同：8
> 
> 时间：2012-08-10T16:03:48.393
> 
> 标签：android, grid-layout

在android中，是否可以完全以编程方式从支持库创建一个GridLayout（即不编写相应的xml）？

我在一个片段（称为 PromotionLayoutFragment）中创建我的 GridLayout，如下所示：

```
ViewGroup fragmentView = (ViewGroup)getView(); 
GridLayout gridLayout = new GridLayout(fragmentView.getContext());
gridLayout.setColumnCount(2);
gridLayout.setRowCount(15);
// add views to grid ...
fragmentView.addView(gridLayout); 
```

当我使用 API 级别 14 中的 GridLayout 类时，这很好用，但是当我使用支持库（v7-r9）中的 GridLayout 时，我得到：

```
08-10 15:54:52.209: ERROR/AndroidRuntime(14687): FATAL EXCEPTION: main
    java.lang.NoClassDefFoundError: android.support.v7.gridlayout.R$dimen
    at android.support.v7.widget.GridLayout.<init>(GridLayout.java:255)
    at android.support.v7.widget.GridLayout.<init>(GridLayout.java:274)
    at android.support.v7.widget.GridLayout.<init>(GridLayout.java:282)
    at net.link.redbutton.fragment.PromotionLayoutFragment.showPromotions(PromotionLayoutFragment.java:168)
    at net.link.redbutton.fragment.PromotionLayoutFragment.onImageResult(PromotionLayoutFragment.java:222)
    at net.link.redbutton.fragment.SchedulerResponseFragment$1.onReceiveResult(SchedulerResponseFragment.java:37)
    at android.os.ResultReceiver$MyRunnable.run(ResultReceiver.java:43)
    at android.os.Handler.handleCallback(Handler.java:605)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4441)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T09:34:53.290

事实证明，您需要将 GridLayout 支持库作为 Android 库项目 (apklib)，而不是 jar。我使用的是 maven [Android SDK deployer](https://github.com/mosabua/maven-android-sdk-deployer)，但目前有一个关于此的[问题](https://github.com/mosabua/maven-android-sdk-deployer/issues/50)。

# asp.net-mvc - MVC 是否不对实现 IEnumerable 的模型上的其他属性进行 json 序列化 ?

> ID：11905346
> 
> 赞同：4
> 
> 时间：2012-08-10T16:03:49.750
> 
> 标签：asp.net-mvc, arrays, json, asp.net-mvc-3, ienumerable

我不知道为什么我现在才第一次注意到这种行为。希望确认这是否是设计行为，或者我是否遗漏了什么。

假设我有一个实现`IEnumerable<T>`并提供附加属性的视图模型。例如：

```
public class MyResultsViewModel : IEnumerable<MyResultViewModel>
{
    public IEnumerable<MyResultViewModel> Results { get; set; }
    public string SomeAdditionalProperty { get; set; }

    public IEnumerator<MyResultViewModel> GetEnumerator()
    {
        return Results.GetEnumerator();
    }
    IEnumerator IEnumerable.GetEnumerator() { return GetEnumerator; }
} 
```

假设我还有一个控制器，它将这个模型作为 json 返回。例如：

```
public ActionResult MyResults()
{
    var entities = PrivateMethodToGetEntities();
    var models = Mapper.Map<MyResultsViewModel>(entities);
    models.SomeAdditionalProperty = "I want this in the JSON too";
    return Json(models, JsonRequestBehavior.AllowGet);
    // models now contains a populated Results as well as the add'l string prop
} 
```

当我从客户端上的 JSON 请求返回结果时，它总是以数组的形式返回。例如：

```
$.get('/Path/To/MyResults')
.success(function (results) {
    alert(results.SomeAdditionalProperty); // this alerts 'undefined'
    alert(results.length); // this alerts the size / count of Results
    alert(results[0]); // this alerts object
    // inspecting results here shows that it is a pure array, with no add'l props
}); 
```

在我重构以使视图模型不实现之前`IEnumerable<T>`，我想确认这是设计使然，并且应该是可以预期的。我想这是有道理的，因为必须扩展 javascript 数组对象的原型以容纳其他属性。

**更新：**

我对视图模型进行了以下更改，以避免命名内部 enumerable `Results`：

```
public class MyResultsViewModel : IEnumerable<MyResultViewModel>
{
    public IEnumerable<MyResultViewModel> NotNamedResults { get; set; }
    public string SomeAdditionalProperty { get; set; }

    public IEnumerator<MyResultViewModel> GetEnumerator()
    {
        return NotNamedResults.GetEnumerator();
    }
    IEnumerator IEnumerable.GetEnumerator() { return GetEnumerator; }
} 
```

通过此更改，行为仍然存在。`alert(JSON.stringify(results))`为我的枚举集合生成正常的数组语法`MyResultViewModel`：

> [{"ResultProp1":"A","ResultProp2":"AA","ResultProp3":"AAA"},{"ResultProp1":"B","ResultProp2":"BB","ResultProp3":"BBB "},{"ResultProp1":"C","ResultProp2":"CC","ResultProp3":"CCC"},{"ResultProp1":"D","ResultProp2":"DD","ResultProp3": "DDD"},{"ResultProp1":"E","ResultProp2":"EE","ResultProp3":"EEE"}]

`JsonResult`在控制器操作返回和调用 jquery`success`函数之间，似乎仍然丢失了附加属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:35:22.860

对于实现 IEnumerable 的类，`JavascriptSerializer`唯一的序列化枚举项。它调用`GetEnumerator()`以获取要序列化的数据，忽略任何其他属性。这就是为什么`Count`a 的属性`List<T>`没有序列化，任何其他属性也不会序列化的原因。

原因是这种构造不能用json格式表示。要包含其他属性，序列化程序必须创建一个哈希对象而不是数组，但严格来说，哈希对象不是一个集合。（例外是键/值对类，如`Dictionary`，它们被序列化为哈希对象。但规则不变 - 只有枚举的字典条目被序列化）。

但是为什么要创建一个`IEnumerable`直接实现序列化为 json 的类而不是这样做呢？

```
 public class MyResultsViewModel {
     public IEnumerable<MyModel> Models{ get; set; }
     public String SomeAdditionalData { get; set; } 
 } 
```

# grails - 如何将带有私有插件的 Grails 应用程序部署到云端

> ID：11905350
> 
> 赞同：1
> 
> 时间：2012-08-10T16:04:10.817
> 
> 标签：grails

我为在两个 grails 应用程序之间共享的域对象创建了一个私有插件。我可以在本地环境中成功使用该插件，因为我已经通过 BuildConfig 文件设置了它的路径。例如，我有以下目录：

```
appOne/
myPlugin/grails-my-plugin-0.1.zip     (myPlugin is a grails plugin project dir) 
```

在：**appOne/grails-app/conf/BuildConfig.groovy：**

```
grails.plugin.location.compileMyPlugin = "../myPlugin" 
```

我的问题是，在我的应用程序版本中处理“打包”这个插件的正确/最佳方法是什么，以便我可以将它部署到无法下载的云服务？我想有一种方法可以让 grails 为你做这件事，但我不确定。（我对grails很陌生）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T07:41:27.437

当您为部署创建 .war 文件时，grails 只包含您的插件。所以你没有什么特别的事情要做。

如果您的项目是在云中构建的，您可能会尝试将文件路径指定为本地存储库：

```
repositories {
  grailsCentral()
  localRepo "../myPlugin"
} 
```

只需将您的压缩插件放到这个文件夹中，grails 就会找到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T16:16:11.713

我最终在 Grails 2.1.0 中执行了以下操作来解决此问题：

1) 在 Grails 插件项目中：
`grails package-plugin`     生成 grails-myplugin-0.1.zip 文件

2) 将插件复制到我的应用程序的 lib 目录 (appOne/lib/grails-myplugin-0.1.zip)

3) 在 BuildConfig.groovy

*   **删除：** grails.plugin.location.compilemyPlugin = "../myPlugin"
    在开发过程中使用它来防止
    更新插件中包含的文件时的重建-重新安装过程。

*   **添加：**

    插件 {
    .....
    编译 ':grails-myPlugin:0.1'
    }

4）通过清理appOne并重新运行进行测试，这将通过lib目录安装/重新安装插件

5) 提交所有更改并将插件 zip 文件添加到 appOne 并推送。云提供商，
在这种情况下是 Heroku，然后可以解决依赖关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:55:42.260

您的构建脚本应该首先打包插件，然后将插件安装到您的 Grails 应用程序中。至少，我必须这样做。如果您尝试在 BuildConfig 依赖项中指定您的插件并作为内联插件，Grails 往往会抱怨这一点。

# nuget - NuGet 包还原 - “默认情况下禁用包还原。要同意，请打开 Visual Studio 选项对话框”

> ID：11905352
> 
> 赞同：27
> 
> 时间：2012-08-10T16:04:15.827
> 
> 标签：nuget

我正在尝试从构建服务器上的命令行使用 NuGet 包还原。

```
nuget install myapp/packages.config 
```

但是，我收到以下错误消息：

*默认情况下禁用包还原。要给予同意，请打开 Visual Studio 选项对话框。*

如果不在构建服务器*上*安装 VS2010，我应该怎么做？（不，我不这样做）。有没有注册表设置之类的？NuGet 如何确定包还原已禁用。确实，为什么他们甚至会关心默认禁用此功能？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-05T05:53:48.467

另一种方法是添加

```
<packageRestore>
    <add key="enabled" value="True" />
    <add key="automatic" value="True" />
</packageRestore> 
```

到文件 %USERPROFILE%\AppData\Roaming\NuGet\nuget.config。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-10T16:57:43.260

目前正在发生这种情况，因为 NuGet 包还原需要在下载包之前获得同意，并且按照当前的工作方式，无法识别从包还原中调用“nuget.exe install packages.config”的用户。有关同意的更多详细信息：http: [//blog.nuget.org/20120518/package-restore-and-consent.html](http://blog.nuget.org/20120518/package-restore-and-consent.html)

注意：这个问题*应该*在下周修复。

作为一种解决方法，您可以通过将 EnableNuGetPackageRestore 环境变量设置为 true 来表示同意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-16T21:14:51.063

我今天有一个。

在 Visual Studio 2013 中检查了选项，但仍然收到错误消息。设置环境变量的解决方法有效，您应该在添加环境变量后重新启动 Visual Studio

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T14:56:33.987

如果您使用的是旧版本的 Visual Studio，请检查更新 NuGet。这对我有用。

# ios - 使用 Phonegap 在 iPad 上的 safari 中打开外部 url

> ID：11905353
> 
> 赞同：0
> 
> 时间：2012-08-10T16:04:15.817
> 
> 标签：ios, ipad, cordova

我正在尝试在 iPad 应用程序（使用 PhoneGap 和 Xcode 开发）上启动 Safari，但我遇到了问题，我相信，将 Cordova.plist 中的域列入白名单并添加 * 以启用所有（应用程序将不会在 App Store 上发布，所以我不担心 Apple 的规则，它只是外部的）但是在模拟应用程序时我收到以下错误......

```
2012-08-10 16:56:29.130 WG[17662:13403] OpenAllWhitelistURLsInWebView set: opening in webview
2012-08-10 16:56:30.689 WG[17662:13403] Failed to load webpage with error: The operation couldn’t be completed. (NSURLErrorDomain error -999.) 
```

有谁知道这意味着什么和/或这里出了什么问题？

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:55:11.387

你可以发布你的代码吗？要在 Safari 中打开东西，您需要调用它：

```
[[UIApplication sharedApplication] openURL:url] 
```

# android - 为什么我不能在我的 ListFragment 中使用 setListShown？或者如何在从异步任务加载列表时显示进度指示器？

> ID：11905354
> 
> 赞同：3
> 
> 时间：2012-08-10T16:04:19.173
> 
> 标签：android, android-listview

我有一个 ListFragment。在 onCreateView 中，我膨胀了一个具有 ID 为 android:List 的 ListView 和一个 ID 为 android:empty 的 TextView 的视图。

我想在我的 Fragment 视图上有一个进度指示器，直到列表加载了来自 asyncCall 的数据。为此，看起来我应该 setListShown(false) onActivityCreated （或在 AsyncTask onpreExec 或 onprogUpdate 之类的东西中）。

然后 onStart of Fragment 我会说 setListShown(true) 以显示列表并删除进度。

但是当我尝试使用 setListShown 我得到 IllegalStateException("Can't be used with a custom content view");

自定义列表视图到底是什么意思？它是简单地通过覆盖 onCreateView 的自定义列表视图吗？即使我在视图中有一个 ID 为 android:List 的 listView，这是 ListFragment 所期望的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:01:12.013

您可以尝试在每个片段中使用视图切换器。这里的概念是一个布局有两个视图，您可以循环或翻页。

切换器中的一个视图，第 1 页，如果您愿意，将具有加载进度，而另一个视图，第 2 页，将具有列表。您默认为第 1 页或进度加载器视图。

一旦您确定您的列表已加载并呈现，切换视图 switcher.showNext() 以显示列表。

switcher.showNext() 或 switcher.showPrevious() 将带您回到加载程序。

# php - PHP 读取 zip 中的所有文本文件并将其保存到字符串变量中

> ID：11905355
> 
> 赞同：0
> 
> 时间：2012-08-10T16:04:28.093
> 
> 标签：php, xml, text, zip

您好专业人士，我再次来到这里寻求 php 编程方面的帮助。我对这门语言真的很陌生，但学得很多。纳夫说。

无论如何，我现在遇到了困难，我想读取一个 zip 文件，其中包含许多包含文本文件的文件夹，并保存在字符串变量（不是文本文件的名称！）中，即文本文件本身的内容。这将为我提供完成任务的示例。

具体来说，我实际上是在尝试读取 zip 中的所有 xml 文件。但是文本文件的示例会很好。

这是我目前拥有的：

```
<?php

function comment(){

    $moodle = new Moodle();

    $zip = zip_open('qwerty.zip');

    if ($zip)
    {
        while ($zip_entry = zip_read($zip))
        {
            //echo "Name: " . zip_entry_name($zip_entry). "<br />";

            $data = zip_entry_read($zip_entry);

            $xml = new SimpleXMLElement($data);

            //echo $data;

        }
        zip_close($zip);
    }

}

comment();

?> 
```

感谢所有在场的人。格拉西亚斯。

更新

这实际上是精确的输出：

```
Warning: SimpleXMLElement::__construct(): Entity: line 28: parser error : expected '>' in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): <component>mod_resource</compon in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): ^ in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): Entity: line 28: parser error : Opening and ending tag mismatch: component line 28 and compon in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): <component>mod_resource</compon in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): ^ in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): Entity: line 28: parser error : Premature end of data in tag file line 25 in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): <component>mod_resource</compon in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): ^ in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): Entity: line 28: parser error : Premature end of data in tag files line 2 in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): <component>mod_resource</compon in D:\xampp\htdocs\project\index.php on line 47

Warning: SimpleXMLElement::__construct(): ^ in D:\xampp\htdocs\project\index.php on line 47

Fatal error: Uncaught exception 'Exception' with message 'String could not be parsed as XML' in D:\xampp\htdocs\project\index.php:47 Stack trace: #0 D:\xampp\htdocs\project\index.php(47): SimpleXMLElement->__construct('<?xml version="...') #1 D:\xampp\htdocs\project\index.php(85): comment() #2 {main} thrown in D:\xampp\htdocs\project\index.php on line 47 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:43:23.703

上面的代码工作正常。问题在于您的 xml 文件。所有这些错误都来自 xml 验证器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T11:33:55.777

我终于明白了。感谢您尝试帮助我。所以我就带着这个来了。

```
function moodlezip($zipfile) {
  echo "<h1>MOODLE</h1>"."<br />";
  $moodle = new Moodle();

  $zipfile = 'backup-moodle2-course-music_basic-20120806-1359b.mbz';
  $zip = zip_open($zipfile);
  $ziparc = new ZipArchive;

  if ($zip) {
    while ($zip_entry = zip_read($zip)) {
      $file = zip_entry_name($zip_entry);
      //echo "Name: " . $file . "<br />";

      if (strpos($file,'course.xml') !== false) {
        if ($ziparc->open($zipfile) === TRUE) {
          $coursexml =  new SimpleXMLElement($ziparc->getFromName($file));
          $moodle->getCourse($coursexml);
          $ziparc->close();
        } else {
          echo 'failed';
        }
      }
      else if (strpos($file,'forum.xml') !== false) {
        if ($ziparc->open($zipfile) === TRUE) {
          $topicxml =  new SimpleXMLElement($ziparc->getFromName($file));
          $moodle->getTopic($topicxml);
          $ziparc->close();
        } else {
          echo 'failed';
        }
      }
      else if (strpos($file,'questions.xml') !== false) {
        if ($ziparc->open($zipfile) === TRUE) {
          $questionsxml =  new SimpleXMLElement($ziparc->getFromName($file));
          $moodle->getQuestions($questionsxml);
          $ziparc->close();
        } else {
          echo 'failed';
        }
      }
    }
    zip_close($zip);
  }
} 
```

# c++ - 垃圾收集事件的 LuaPlus 和 c++ 回调

> ID：11905357
> 
> 赞同：4
> 
> 时间：2012-08-10T16:04:33.943
> 
> 标签：c++, lua

我一直在使用 LuaPlus 来使用脚本语言公开模块的功能。为此，LuaPlus 真的很棒，但我坚持清理我的暴露对象，因为我不知道如何处理删除代表我的 c++ 对象的 lua 对象，所以我可以正确释放 c++ 资源。

我正在使用 lua 表和元表来表示 cpp 对象，将指向 cpp 对象的指针作为表的 lightuserdata 参数“__object”传递，所以我可以做类似的事情

```
function foo() 
  local p = MyCppObject:new()   //Create a cpp object and bind it to a table+metatable
  p:do_something()        //Correctly calls the cpp member function do_something
  ....
  (exits scope)           //No more references to p, so p is deleted.
 end 
```

函数退出后（或一段时间后），我希望调用[元表方法 "__gc"](http://www.lua.org/manual/5.2/manual.html#2.5)，我在其中调用内部 cpp 对象的删除，但我没有看到我的 cpp 回调被调用全部。我尝试使用 lua 的函数[collectgarbage](http://www.lua.org/manual/5.2/manual.html#pdf-collectgarbage)强制垃圾收集，多次调用我的函数来强制 lua 收集我的对象，但我看不到我的回调正在执行。最重要的是，我看到调用 collectgarbage("count") 的结果有时会减少，因此某些内容会在某处被删除，但我不知道是什么。我检查了 lua 文档，但我看不出我做错了什么:(

任何评论表示赞赏！谢谢！

* * *

更新：添加了 c++ 代码端 + 添加了 Mud 指出的本地 + 我的测试示例

我创建了我的程序的这个小样本。LuaShell 对象只是状态的包装器 + 读取命令行并执行从 std::cin 读取的字符串的循环

```
#include <iostream>
#include "LuaPlus.h"
class Point
{
  private:
      int x_,y_;
  public:
  Point(): x_(0), y_(0){}
  Point(int a, int b): x_(a), y_(b){}

  ~Point() {std::cout << "Point "<< x_ << ","
                      << y_ << "being deleted" << std::endl;} 

  int x() const  { return x_;} 
  int y() const  { return y_;}     
};

LuaPlus::LuaObject metatable;

int new_point( LuaPlus::LuaState* state)
{
  LuaPlus::LuaStack args(state);
  //std::cout << "Creating point!!" << std::endl;
  float x = 0, y = 0;
  if ( args.Count() == 3)
  {
      if (args[2].IsNumber() && args[3].IsNumber())
      {
          x = args[2].GetFloat();
          y = args[3].GetFloat();
      }
  }

  Point* p = new Point(x,y);
  LuaPlus::LuaObject lua_obj = state->CreateTable();
  lua_obj.SetLightUserData("__object", p);
  lua_obj.SetMetaTable( metatable );

  return 1;
}

int my_gc_event( LuaPlus::LuaState* state) 
{
  std::cout << "Calling gc_event from lua" << std::endl;
  return 0;
}

int main()
{

  /* Creating the object that holds the Lua interpreter as well as 
   * the command line
   */ 
  LuaShell::Shell shell(true);
  LuaPlus::LuaObject globals = shell.get_state()->GetGlobals();

  metatable = globals.CreateTable("PointMetaTable");
  metatable.SetObject("__index", metatable);
  metatable.Register("new", new_point);
  metatable.Register("__gc",my_gc_event);
  metatable.RegisterObjectDirect("x", (Point*)0 ,&Point::x);
  metatable.RegisterObjectDirect("y", (Point*)0 ,&Point::y);
  globals.SetObject("Point", metatable);

  //Get into the read-command-line-until-quit loop.
  shell.run();
  return 0;
} 
```

在 lua 方面，我运行它来测试。

```
? k,b = collectgarbage("count") print (k*1024) 
> 33761
? for it=1,1000000 do foo() end   
? k,b = collectgarbage("count") print (k*1024) 
> 75315
? collectgarbage()  
? k,b = collectgarbage("count") print (k*1024)
> 32363 
```

如您所见，根据 lua 运行时有“一些”垃圾收集，但是当我看到我的进程的顶级报告时，内存只会上升，而不会下降。此外，我从来没有看到来自点析构函数的消息（预计因为我并没有真正调用它）或来自“my_gc_event”内部的消息（意外，因为我认为它在收集垃圾工作期间的某个时候被调用）。

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T15:55:42.323

考虑到正确的答案（Mud 的道具）被埋在评论中，我认为最好在此处添加最终代码和答案。

正如 Mud 所说，我的问题是尝试使用表格来公开对象。虽然这样可行，但 lua 5.1 运行时（由 luaplus 使用）不会为表调用垃圾收集器事件 (__gc)，因此我不得不使用 luaplus 中的 BoxPointer 辅助函数。还添加了一个映射来跟踪暴露对象的类型，因为它们作为 void* 传递，稍后您需要正确转换它们以进行适当的清理。使用一些模板技巧，我最终得到了一个非常简单的清理系统。这是代码（主要功能保持不变，以及Point类定义）。

```
#include <iostream>
#include <map>
#include <boost/bind.hpp>
#include <boost/function.hpp>
#include "LuaPlus.h"
#include "Shell.h"

//Function used to delete an object created and exposes to lua
template<typename type_to_delete>
void delete_wrapper(void* ptr)
{
    type_to_delete* typed_ptr = static_cast<type_to_delete*>(ptr);
    delete typed_ptr;
}

//My object metatable
LuaPlus::LuaObject metatable;
//Table to save function pointers for the correct deletion of exposed objects
std::map<void*,boost::function<void(void*)> > g_object_type_deleter;

int new_point( LuaPlus::LuaState* state)
{
    LuaPlus::LuaStack args(state);
    float x = 0, y = 0;
    if ( args.Count() == 3)
    {
        if (args[2].IsNumber() && args[3].IsNumber())
        {
            x = args[2].GetFloat();
            y = args[3].GetFloat();        
        }
    }

    Point* p = new Point(x,y);
    //This used to be a table, but given the shortcoming with the gc, now using this version
    LuaPlus::LuaObject lua_obj = state->BoxPointer(p);
    lua_obj.SetMetaTable( metatable );

    //Save the callback to delete the object we just created.
    g_object_type_deleter[static_cast<void*> (p)] = boost::bind( delete_wrapper<Point> , _1);
    return 1;
}

int my_gc_event( LuaPlus::LuaState* state) 
{
    //get the pointer lua is trying to delete.
    void *p = state->UnBoxPointer(1);

    //look for the delete callback with the type information
    std::map<void*,boost::function<void(void*)> >::iterator it = g_object_type_deleter.find(p);
    if (it == g_object_type_deleter.end() )
    {
        std::cout << "receiving callback to destroy object that was not indexed !" << std::endl;
        return 0;
    }
    //Actually call the delete function passing the pointer as parameter
    it->second(it->first);
    return 0;
} 
```

多谢你们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:31:32.450

```
function foo() 
  p = MyCppObject:new()   //Create a cpp object and bind it to a table+metatable
  p:do_something()        //Correctly calls the cpp member function do_something
  ....
  (exits scope)           //No more references to p, so p is deleted.
end 
```

`p`是全局的，所以它在返回时*不会*离开范围。如果您希望将其词法范围限定为该函数，则`foo`需要使用关键字。`local`

> lightuserdata 参数 [...] 我希望调用元表方法“__gc”

[Lightuserdata 不会被垃圾收集。](http://www.lua.org/pil/28.5.html)这可能与您的问题无关（我不知道 LuaBind 是如何工作的），但我认为值得一提。

* * *

回复评论：

我编写了以下测试，它创建了一个单字节、无操作的用户数据类型，其中只有一个`__gc`元表：

```
#include "lauxlib.h"

static int foo_gc (lua_State* L) { 
   puts("__gc called");
   return 0; 
}

static int foo_new (lua_State* L) { 
   lua_newuserdata(L, 1);
   luaL_getmetatable(L, "foo");
   lua_setmetatable(L, -2);
   return 1;
}

int __declspec(dllexport) __cdecl luaopen_luagc (lua_State* L) {
   // create foo type
   static const struct luaL_reg foo[] = {
      { "__gc",        foo_gc       },
      NULL, NULL
   };
   luaL_newmetatable(L, "foo");
   luaL_openlib(L, NULL, foo, 0);

   // create constructor
   lua_register(L, "foo", foo_new);
   return 0;
} 
```

如果我然后运行以下测试：

```
require 'luagc'

for i=1,5 do
   foo()
end

collectgarbage("collect") 
```

输出是：

```
__gc called
__gc called
__gc called
__gc called
__gc called 
```

# git - 如何最好地使用 git 管理 TYPO3 安装？

> ID：11905360
> 
> 赞同：10
> 
> 时间：2012-08-10T16:04:36.067
> 
> 标签：git, content-management-system, typo3, web-deployment

你好我一直想解决这个问题有一段时间了，但我想使用 git 来维护一些typo3开发站点。我做了一些挖掘，关于该主题的最丰富的信息（[铬翻译网站](http://www.chmuul.net/2010/02/saubere-git-repositories-fur-typo3-projekte/)）信息尚不清楚，但确实让我思考。我想知道如何设置一个 git 管理的 repo，如果有一些/其他文件夹在设置 repo 时我应该忽略，我应该注意什么，最佳实践等。我已经决定每个版本，数据库转储将单独完成，这与里程碑相对应，因为到目前为止我不确定如何处理 CMS 版本控制的这方面。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-10T16:35:40.410

有典型的`.gitignore`

```
/fileadmin/user_upload/
/fileadmin/_temp_/

/uploads/

/typo3conf/temp_CACHED*
/typo3conf/temp_fieldInfo.php
/typo3conf/localconf_local.php

/typo3/
/t3lib/
/typo3temp/ 
```

请记住，`TYPO3`与`git`您一起使用时，不应在遥控器上安装任何扩展`Extension Manager`！

而是在本地导入 ext，在本地安装它，然后提交并推送 ext 的文件并修改`localconf.php`到远程服务器。

在`localconf.php`包含的末尾`localconf_local.php`（忽略）

```
@include('localconf_local.php'); 
```

它将允许覆盖即。数据库的凭据，或自定义`ImageMagick`路径，而不更改原始`localconf.php`. 团队中的每个开发人员当然会将自己的值写入`localconf_local.php`.

`.gitignore`应在每个实例中手动创建典型的 TYPO3 文件夹，即。

`typo3temp`

`fileadmin/user_upload`

当然，您还需要下载 TYPO3 sorces ( `typo3`,`t3lib`文件夹) - 将它们置于版本控制之下没有更大的意义。

其他的东西，比如`uploads`应该从远程手动下载，所以最好写一个脚本来打包它，每个开发者都可以通过一些链接下载它。您不能将其添加到 git repo，因为这些文件只是在创建内容元素时创建的，所以如果您不忽略它们，您很快就会面临巨大的合并冲突的风险。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-10T17:27:55.407

我想在 biesiors 非常好的答案中添加一些方面：根据我的经验，最好的策略是将版本控制置于版本控制之下`fileadmin/`，`typo3conf/`一开始就没有别的了。如果您使用扩展，您将因此只使用来自 TER 存储库的最新版本。扩展配置（打字稿设置、locallang 值）将放置在 fileadmin/ 中的外部文件中。示例文件夹结构：

```
fileadmin/
- css/
- images/
- javascript/
- scripts/
- templates/
- - html/
- - templavoila/
- - typoscript/
- - xml/ 
```

不要在数据库中存储任何打字信息 - 它不能从那里进行版本控制。

`.gitignore`放在需要的地方。我们也忽略`typo3conf/ext/`和`typo3conf/l10n/`。为什么？如果我们编写自己的扩展（或修改现有的），我们会将其添加`typo3conf/ext/my_extensionname/`到另一个存储库。这样，扩展本身可以得到很好的维护，尤其是在多个项目中使用时。并且根本不需要对未更改的扩展进行版本控制。

遵循`@include('localconf_local.php');`建议 - 这是一个很好的做法。

这种设置增加了对编码纪律的更高要求，但你会得到回报！现在，我们已经成功地在两个人的团队中完成了 12 个以上的项目。

# java - java.library.path 中没有 jaybird [dll]

> ID：11905362
> 
> 赞同：2
> 
> 时间：2012-08-10T16:04:45.483
> 
> 标签：java, desktop-application, dll, firebird2.5

当使用嵌入式 firebird 导出我的 java 项目时，我在控制台中收到一条消息：“java.library.path 中没有 jaybird [22 [任何版本，我猜]]”。

但它实际上是在我的项目的库路径上，自引用到我的工作区。我尝试了很多解决方法，例如

```
System.LoadFile("jaybird22.dll") //full uri, just the name of the dll, nada
System.Load("jaybird22.dll") //full uri, just the name of the dll, nada 
```

或将 dll 插入用户库或将 dll 作为引用库放在另一个文件夹中。

这真的让我很紧张。如何解决此错误？杰尼？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:06:01.917

**解决方案**

好的，这是解决此问题的方法。问题是在 jar 中没有 dll 或任何包含文件的文件夹都被打包在 jar 中。因此，几乎每个 dll、带有图像的文件夹或任何必须在可运行 jar 所在的文件夹中的东西。包装在 jar 中的唯一东西是外部 jar 和用于运行软件的 .java 文件。

无论如何，使用 Firebird 嵌入式模式非常棘手。由于 jaybird(SOME_VERSION).dll 必须放在所有 .dll、.msg 文件旁边。但是 JVM 会要求 jaybird dll 在 java.library.path 中，当然它只是 system32 和一些与程序无关的 java 文件夹。

因此，为了让您的程序将您的可运行 jar 文件夹检测为 java.library.path （实际上应该称为路径），jaybird dll 文件和其他 firebird 文件和文件夹是您将这些 LOC 放在 main 方法中的：

```
String decodedPath =URLDecoder.decode(ClassLoader.getSystemClassLoader().getResource(".").getPath(), "UTF-8");
decodedPath=decodedPath.substring(1, decodedPath.length()-1).replaceAll("/", "\\\\");
System.setProperty("java.library.path",decodedPath+";"+System.getProperty("java.library.path"))); 
```

我为库路径添加了以前的目录，因为我只是将它添加到列表中。

请注意，这些 LOC 必须在 ANY CODE 之前，并且还包括调用构造函数。如果您正在使用全局静态模块或 JNI 调用，请注意。

我希望这可以节省一些时间，我已经失去了 12 个小时的工作来试图正确地解决这个问题。

如果管理员不删除我的编辑或自行回答此问题，我将不胜感激。

快乐编码 =D

# sql - 复杂 ActiveRecord 案例中大小、长度和计数之间的差异

> ID：11905364
> 
> 赞同：3
> 
> 时间：2012-08-10T16:04:54.953
> 
> 标签：sql, ruby-on-rails, activerecord

```
[10] pry(main)> r.respondents.select(:name).uniq.size

(1.1ms)  SELECT DISTINCT COUNT("respondents"."name") FROM "respondents" 
INNER JOIN "values" ON "respondents"."id" = "values"."respondent_id" WHERE 
"values"."round_id" = 37 => 495

[11] pry(main)> r.respondents.select(:name).uniq.length

Respondent Load (1.1ms)  SELECT DISTINCT name FROM "respondents" 
INNER JOIN "values" ON "respondents"."id" = "values"."respondent_id" WHERE
"values"."round_id" = 37 => 6 
```

为什么每个查询返回的内容不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:16:30.130

```
.count #=> this always triggers a SELECT COUNT(*) on the database

.size #=> if the collection has been loaded, defers to Enumerable#size, else does the SELECT COUNT(*)

.length #=> always loads the collection and then defers to Enumerable#size 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T18:34:59.317

`r.respondents.select(:name).uniq`返回一个 ActiveRecord::Relation 对象，该对象覆盖`size`.

请参阅：[http ://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-size](http://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-size)

调用`size`此类对象会检查该对象是否“已加载”。

```
# Returns size of the records.
def size
  loaded? ? @records.length : count
end 
```

如果是“已加载”，则返回`@records`数组的长度。否则，它调用`count`，不带参数，将“[返回模型所有行的计数](http://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-count)” 。

那么为什么会有这种行为呢？`to_a`一个 AR::Relation 只有在先调用或时才被“加载” `explain`：

[https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb)

方法上方的评论中解释了原因`load`：

```
# Causes the records to be loaded from the database if they have not
# been loaded already. You can use this if for some reason you need
# to explicitly load some records before actually using them. The
# return value is the relation itself, not the records.
#
#   Post.where(published: true).load # => #<ActiveRecord::Relation>
def load
  unless loaded?
    # We monitor here the entire execution rather than individual SELECTs
    # because from the point of view of the user fetching the records of a
    # relation is a single unit of work. You want to know if this call takes
    # too long, not if the individual queries take too long.
    #
    # It could be the case that none of the queries involved surpass the
    # threshold, and at the same time the sum of them all does. The user
    # should get a query plan logged in that case.
    logging_query_plan { exec_queries }
  end

  self
end 
```

因此，也许 using`AR::Relation#size`是对该关系的查询的潜在复杂性大小的度量，其中`length`回退到返回记录的计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-25T20:30:56.137

在将 Rails 3.2 转换为 4.1 时，似乎 AR::Relation#size 有所不同。以前它返回“行”的数量，而（在我的例子中）它现在返回一个哈希。更改为使用 #count 似乎与 3.2 中的 #size 给出相同的结果。我在这里有点含糊，因为在 4.1 上的“rails 控制台”中运行测试在 4.1 上通过“rails 服务器”运行时并没有给出相同的结果

# objective-c - 找不到“AudioUnit/AudioUnit.h”文件

> ID：11905366
> 
> 赞同：2
> 
> 时间：2012-08-10T16:05:00.193
> 
> 标签：objective-c, ios, xcode

我正在使用音频工具箱

.h 文件

```
#import <UIKit/UIKit.h>
#import <AudioToolbox/AudioToolbox.h>

@interface ViewController : UIViewController {

}

-(IBAction)buttonPressedWithSound:(id)sender;

@end 
```

并在 .m 文件中

```
-(IBAction)buttonPressedWithSound:(id)sender {

int randomSoundNumber = arc4random() % 4; //random number from 0 to 3

NSLog(@"random NR = %i", randomSoundNumber);

NSString *effectTitle;

switch (randomSoundNumber) {
    case 0:
        effectTitle = @"Come at me BRO!";
        break;

    default:
        break;
}

SystemSoundID soundID;

NSString *soundPath = [[NSBundle mainBundle] pathForResource:effectTitle ofType:@"mp3"];
NSSound *sound = [[[NSSound alloc] initWithContentsOfFile: soundPath byReference: NO]       autorelease];

[sound play];

AudioServicesCreateSystemSoundID ((CFURLRef)CFBridgingRetain(soundUrl), &soundID);
AudioServicesPlaySystemSound(soundID);
} 
```

但是当我在我的 iphone 上运行时，它出现在 AUGraph.h 中的日志中，其中 #include AudioUnit/AudioUnit.h 和“AudioUnit/AudioUnit.h”文件在它的右侧找不到。

我该如何解决这个问题才能在我的手机上运行它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:58:33.270

正如stackmonster所说，确保它在Build Phases>Link Binary with Library中你还需要#include它在你试图使用它的类中（也许也尝试包括audioUnit，但不明白你为什么会有）

您也可以尝试使用 AVAudioPlayer，这对您来说可能更容易（我知道它适合我）

```
AVAudioPlayer *theAudio=[[AVAudioPlayer alloc] initWithContentsOfURL:fileURL error:NULL];

theAudio.volume = 1.0;

theAudio.delegate = self;

[theAudio prepareToPlay];

[theAudio play]; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-10T16:11:40.383

在 Build Phases...链接库中将 audiotoolbox 框架添加到您的应用程序

# javascript - 无法读取未定义的属性“HTML5HISTORY”

> ID：11905367
> 
> 赞同：2
> 
> 时间：2012-08-10T16:05:00.443
> 
> 标签：javascript, browser-history, google-closure

我的 Google 关闭代码有问题。我正在尝试使用 HTML5 History 功能实现一个应用程序。

但不幸的是，这不起作用，因为我在 Chrome 上得到一个“无法读取属性 'HTML5HISTORY' OF UNDEFINED”，而在 Firefox 上得到一个“goog.history is undefined”。

基本上，“var h”永远不会用 History 实例创建，因为我从“try/catch”循环中得到错误，并显示 error.message。

我真的不知道是什么问题...

多谢你们

```
goog.require('goog.events');
goog.require('goog.events.EventTarget');
goog.require('goog.history.EventType');
goog.require('goog.history.Html5History');
goog.require('goog.Uri');

var h;

try {

 h = new goog.history.Html5History();

} catch (e) {

     document.write(e.message);
}

if (h) {

    var cur = 'kittens';

    goog.events.listen(h, goog.history.EventType.NAVIGATE, function(e) {
        var token = e.token || 'kittens';

        var next = document.getElementById(token);

        if (next) {

            document.getElementById(cur).className = 'section';
            next.className = 'section active';
            cur = token;
        }
    });

    h.setUseFragment(false);
    h.setPathPrefix(new goog.Uri(document.location.href).getPath() + '/');
    h.setEnabled(true);

    goog.events.listen(document.getElementById('links'), 'click', function(e) {

        if (e.target.tagName == 'A') {

            h.setToken(e.target.getAttribute('token'), e.target.title);
            e.preventDefault();
        }
    });
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:13:43.637

将所有导入（goog.require() 调用）包含在一个单独的 JavaScript 文件或标记中，然后再包含在您的脚本中。

[文档](https://developers.google.com/closure/library/docs/gettingstarted#wha)说：

> 注意：不要将 goog.require() 语句放在与使用 goog.required 函数或类的代码的入口点相同的脚本标记中。goog.require() 调用将代码添加到包含调用的脚本标记之后的文档中。例如，此代码有效：

```
<script src="closure-library/closure/goog/base.js"></script>
<script>
  goog.require('goog.dom');
</script>
<script>
  var newHeader = goog.dom.createDom('h1');
</script> 
```

> 相反，以下代码会产生错误：

```
<script src="closure-library/closure/goog/base.js"></script>
<script>
  // DON'T DO THIS.
  goog.require('goog.dom');
  var newHeader = goog.dom.createDom('h1');
</script> 
```

# xcode - Xcode 4.3-4.4 使用 LLDB 断点崩溃，断点对 GDB 无用

> ID：11905378
> 
> 赞同：2
> 
> 时间：2012-08-10T16:05:39.127
> 
> 标签：xcode, xcode4.3, breakpoints, lldb

每次我尝试在使用 LLDB 调试器的断点时运行我的目标时，Xcode 都会崩溃。我的同事使用 LLDB 没有问题，而且我们都在运行 4.4（我从 4.3 开始就遇到了问题）

此外，由于我必须使用 GDB，因此也存在问题。随机地，当我在 GDB 中遇到一些断点时，我会收到一条`Previous frame inner to this frame (gdb could not unwind past this frame)`消息，如果不盲目地输入`po iVar`类似的命令，我就看不到任何有用的东西。

总的来说，我的调试非常失败，如果有人可以提供帮助，我将不胜感激。

`-fobjc-arc`注意：我的项目正在使用 Apple LLVM 3.0 进行编译，并且由于使用了编译器标志，因此在不导致构建错误的情况下无法恢复

这是来自 Xcode 的崩溃报告

```
Process:         Xcode [344]
Path:            /Applications/Xcode.app/Contents/MacOS/Xcode
Identifier:      com.apple.dt.Xcode
Version:         4.4 (1484)
Build Info:      IDEApplication-1484000000000000~4
App Item ID:     497799835
App External ID: 9584584
Code Type:       X86-64 (Native)
Parent Process:  launchd [324]

Date/Time:       2012-08-10 11:45:01.067 -0400
OS Version:      Mac OS X 10.7.4 (11E53)
Report Version:  9

Interval Since Last Report:          83007 sec
Crashes Since Last Report:           1
Per-App Interval Since Last Report:  80976 sec
Per-App Crashes Since Last Report:   1
Anonymous UUID:                      50D9F896-324C-4624-8C00-C460577BD2AE

Crashed Thread:  16  <lldb session listener>

Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x0000000000000000

VM Regions Near 0:
--> 
    __TEXT                 000000010bacd000-000000010bad0000 [   12K] r-x/rwx SM=COW  /Applications/Xcode.app/Contents/MacOS/Xcode

Application Specific Information:
ProductBuildVersion: 4F250
objc[344]: garbage collection is ON

Thread 0:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff8e2d367a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff8e2d2d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff8687950c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff86881c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff86881486 CFRunLoopRunSpecific + 230
5   com.apple.HIToolbox             0x00007fff8b8a34d3 RunCurrentEventLoopInMode + 277
6   com.apple.HIToolbox             0x00007fff8b8aa781 ReceiveNextEventCommon + 355
7   com.apple.HIToolbox             0x00007fff8b8aa60e BlockUntilNextEventMatchingListInMode + 62
8   com.apple.AppKit                0x00007fff8d614e31 _DPSNextEvent + 659
9   com.apple.AppKit                0x00007fff8d614735 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 135
10  com.apple.AppKit                0x00007fff8d611071 -[NSApplication run] + 470
11  com.apple.AppKit                0x00007fff8d88d244 NSApplicationMain + 867
12  com.apple.dt.Xcode              0x000000010bacedc0 0x10bacd000 + 7616

Thread 1:: Dispatch queue: com.apple.libdispatch-manager
0   libsystem_kernel.dylib          0x00007fff8e2d57e6 kevent + 10
1   libdispatch.dylib               0x00007fff8e2aa78a _dispatch_mgr_invoke + 923
2   libdispatch.dylib               0x00007fff8e2a931a _dispatch_mgr_thread + 54

Thread 2:: com.apple.NSURLConnectionLoader
0   libsystem_kernel.dylib          0x00007fff8e2d367a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff8e2d2d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff8687950c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff86881c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff86881486 CFRunLoopRunSpecific + 230
5   com.apple.Foundation            0x00007fff82510fd7 +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 335
6   com.apple.Foundation            0x00007fff8250572a -[NSThread main] + 68
7   com.apple.Foundation            0x00007fff825056a2 __NSThread__main__ + 1575
8   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
9   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 3:
0   libsystem_kernel.dylib          0x00007fff8e2d367a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff8e2d2d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff8687950c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff86881c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff86881486 CFRunLoopRunSpecific + 230
5   com.apple.DTDeviceKit           0x00000001118c9eaf -[DTDKRemoteDeviceDataListener listenerThreadImplementation] + 298
6   com.apple.Foundation            0x00007fff8250572a -[NSThread main] + 68
7   com.apple.Foundation            0x00007fff825056a2 __NSThread__main__ + 1575
8   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
9   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 4:: com.apple.CFSocket.private
0   libsystem_kernel.dylib          0x00007fff8e2d4df2 __select + 10
1   com.apple.CoreFoundation        0x00007fff868cac8b __CFSocketManager + 1355
2   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
3   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 5:: DYMobileDeviceManager
0   libsystem_kernel.dylib          0x00007fff8e2d367a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff8e2d2d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff8687950c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff86881c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff86881486 CFRunLoopRunSpecific + 230
5   com.apple.Foundation            0x00007fff824b6f7b -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 267
6   com.apple.Foundation            0x00007fff824b6e67 -[NSRunLoop(NSRunLoop) run] + 62
7   com.apple.Foundation            0x00007fff8250572a -[NSThread main] + 68
8   com.apple.Foundation            0x00007fff825056a2 __NSThread__main__ + 1575
9   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
10  libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 6:
0   libsystem_kernel.dylib          0x00007fff8e2d4bca __psynch_cvwait + 10
1   libsystem_c.dylib               0x00007fff83a6f274 _pthread_cond_wait + 840
2   com.apple.Xcode.DevToolsCore    0x000000010f3b3d35 -[XCInvocationQueue _processInvocationsInThreadSlotNumber:] + 353
3   com.apple.Foundation            0x00007fff8250572a -[NSThread main] + 68
4   com.apple.Foundation            0x00007fff825056a2 __NSThread__main__ + 1575
5   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
6   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 7:: CVDisplayLink
0   libsystem_kernel.dylib          0x00007fff8e2d4bca __psynch_cvwait + 10
1   libsystem_c.dylib               0x00007fff83a6f274 _pthread_cond_wait + 840
2   com.apple.CoreVideo             0x00007fff8e7906c8 CVDisplayLink::runIOThread() + 710
3   com.apple.CoreVideo             0x00007fff8e7903e9 _ZL13startIOThreadPv + 148
4   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
5   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 8:
0   libsystem_kernel.dylib          0x00007fff8e2d5192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff83a6d594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff83a6eb85 start_wqthread + 13

Thread 9:: Dispatch queue: com.apple.root.low-priority
0   libsystem_kernel.dylib          0x00007fff8e2d4e42 __semwait_signal + 10
1   libsystem_c.dylib               0x00007fff83a2197e pthread_join + 795
2   libclang.dylib                  0x000000010d41c4ea 0x10cedf000 + 5493994
3   libclang.dylib                  0x000000010d41201a 0x10cedf000 + 5451802
4   libclang.dylib                  0x000000010cee93f7 0x10cedf000 + 41975
5   libclang.dylib                  0x000000010cf1f913 clang_indexSourceFile + 163
6   com.apple.dt.IDEFoundation      0x000000010c3152ff -[IDEIndexClangTranslationUnit indexUsingDataSource:] + 295
7   com.apple.dt.IDEFoundation      0x000000010c3146b2 -[IDEIndexClangDataSource generateDataForJob:] + 2182
8   com.apple.dt.IDEFoundation      0x000000010c313db7 -[IDEIndexDataSource processJob:] + 243
9   com.apple.dt.IDEFoundation      0x000000010c3139e9 +[IDEIndexingEngine runFileJob:] + 414
10  com.apple.dt.IDEFoundation      0x000000010c31345e -[IDEIndexingJob run] + 99
11  com.apple.dt.IDEFoundation      0x000000010c43434d __40-[IDEIndexingJobScheduler _scheduleJobs]_block_invoke_0 + 31
12  com.apple.dt.DVTFoundation      0x000000010bb7c260 __DVTDispatchAsync_block_invoke_0 + 16
13  libdispatch.dylib               0x00007fff8e2a8a86 _dispatch_call_block_and_release + 18
14  libdispatch.dylib               0x00007fff8e2a9965 _dispatch_worker_thread2 + 255
15  libsystem_c.dylib               0x00007fff83a6d3da _pthread_wqthread + 316
16  libsystem_c.dylib               0x00007fff83a6eb85 start_wqthread + 13

Thread 10:
0   libsystem_kernel.dylib          0x00007fff8e2d5192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff83a6d594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff83a6eb85 start_wqthread + 13

Thread 11:
0   libsystem_kernel.dylib          0x00007fff8e2d5192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff83a6d594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff83a6eb85 start_wqthread + 13

Thread 12:: <lldb.comm.debugger.input>
0   libsystem_kernel.dylib          0x00007fff8e2d4df2 __select + 10
1   com.apple.LLDB.framework        0x0000000121d3e5d6 lldb_private::ConnectionFileDescriptor::BytesAvailable(unsigned int, lldb_private::Error*) + 362
2   com.apple.LLDB.framework        0x0000000121d3e151 lldb_private::ConnectionFileDescriptor::Read(void*, unsigned long, unsigned int, lldb::ConnectionStatus&, lldb_private::Error*) + 141
3   com.apple.LLDB.framework        0x0000000121d3c9ac lldb_private::Communication::ReadFromConnection(void*, unsigned long, unsigned int, lldb::ConnectionStatus&, lldb_private::Error*) + 50
4   com.apple.LLDB.framework        0x0000000121d3c653 lldb_private::Communication::ReadThread(void*) + 225
5   com.apple.LLDB.framework        0x0000000121dafb38 _ZL22ThreadCreateTrampolinePv + 91
6   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
7   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 13:: <lldb.comm.xcode.lldb.comm>
0   libsystem_kernel.dylib          0x00007fff8e2d4df2 __select + 10
1   com.apple.LLDB.framework        0x0000000121d3e5d6 lldb_private::ConnectionFileDescriptor::BytesAvailable(unsigned int, lldb_private::Error*) + 362
2   com.apple.LLDB.framework        0x0000000121d3e151 lldb_private::ConnectionFileDescriptor::Read(void*, unsigned long, unsigned int, lldb::ConnectionStatus&, lldb_private::Error*) + 141
3   com.apple.LLDB.framework        0x0000000121d3c9ac lldb_private::Communication::ReadFromConnection(void*, unsigned long, unsigned int, lldb::ConnectionStatus&, lldb_private::Error*) + 50
4   com.apple.LLDB.framework        0x0000000121d3c653 lldb_private::Communication::ReadThread(void*) + 225
5   com.apple.LLDB.framework        0x0000000121dafb38 _ZL22ThreadCreateTrampolinePv + 91
6   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
7   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 14:: <lldb.process.gdb-remote.async>
0   libsystem_kernel.dylib          0x00007fff8e2d4bca __psynch_cvwait + 10
1   libsystem_c.dylib               0x00007fff83a6f274 _pthread_cond_wait + 840
2   com.apple.LLDB.framework        0x0000000121daf3d5 lldb_private::Condition::Wait(lldb_private::Mutex&, lldb_private::TimeValue const*, bool*) + 109
3   com.apple.LLDB.framework        0x0000000121d51ce0 lldb_private::Predicate<bool>::WaitForValueEqualTo(bool, lldb_private::TimeValue const*, bool*) + 100
4   com.apple.LLDB.framework        0x0000000121d52a46 lldb_private::Listener::WaitForEventsInternal(lldb_private::TimeValue const*, lldb_private::Broadcaster*, lldb_private::ConstString const*, unsigned int, unsigned int, std::tr1::shared_ptr<lldb_private::Event>&) + 156
5   com.apple.LLDB.framework        0x0000000121d52bed lldb_private::Listener::WaitForEvent(lldb_private::TimeValue const*, std::tr1::shared_ptr<lldb_private::Event>&) + 27
6   com.apple.LLDB.framework        0x0000000121df3457 ProcessGDBRemote::AsyncThread(void*) + 277
7   com.apple.LLDB.framework        0x0000000121dafb38 _ZL22ThreadCreateTrampolinePv + 91
8   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
9   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 15:: <lldb.process.internal-state(pid=6712)>
0   libsystem_kernel.dylib          0x00007fff8e2d4bca __psynch_cvwait + 10
1   libsystem_c.dylib               0x00007fff83a6f274 _pthread_cond_wait + 840
2   com.apple.LLDB.framework        0x0000000121daf3d5 lldb_private::Condition::Wait(lldb_private::Mutex&, lldb_private::TimeValue const*, bool*) + 109
3   com.apple.LLDB.framework        0x0000000121d51ce0 lldb_private::Predicate<bool>::WaitForValueEqualTo(bool, lldb_private::TimeValue const*, bool*) + 100
4   com.apple.LLDB.framework        0x0000000121d52a46 lldb_private::Listener::WaitForEventsInternal(lldb_private::TimeValue const*, lldb_private::Broadcaster*, lldb_private::ConstString const*, unsigned int, unsigned int, std::tr1::shared_ptr<lldb_private::Event>&) + 156
5   com.apple.LLDB.framework        0x0000000121d52bed lldb_private::Listener::WaitForEvent(lldb_private::TimeValue const*, std::tr1::shared_ptr<lldb_private::Event>&) + 27
6   com.apple.LLDB.framework        0x0000000121e54e1a lldb_private::Process::WaitForEventsPrivate(lldb_private::TimeValue const*, std::tr1::shared_ptr<lldb_private::Event>&, bool) + 148
7   com.apple.LLDB.framework        0x0000000121e59d3f lldb_private::Process::RunPrivateStateThread() + 149
8   com.apple.LLDB.framework        0x0000000121e59a09 lldb_private::Process::PrivateStateThread(void*) + 9
9   com.apple.LLDB.framework        0x0000000121dafb38 _ZL22ThreadCreateTrampolinePv + 91
10  libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
11  libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 16 Crashed:: <lldb session listener>
0   libc++abi.dylib                 0x00007fff8b6fabb3 d_type + 1274
1   libc++abi.dylib                 0x00007fff8b6fae48 d_type + 1935
2   libc++abi.dylib                 0x00007fff8b6fadf2 d_type + 1849
3   libc++abi.dylib                 0x00007fff8b6fec48 d_bare_function_type + 119
4   libc++abi.dylib                 0x00007fff8b6feb29 d_encoding + 1599
5   libc++abi.dylib                 0x00007fff8b6fa57c d_demangle + 498
6   libc++abi.dylib                 0x00007fff8b6fa305 __cxa_demangle + 81
7   com.apple.LLDB.framework        0x0000000121d546ef lldb_private::Mangled::GetDemangledName() const + 127
8   com.apple.LLDB.framework        0x0000000121e43251 lldb_private::Symtab::InitNameIndexes() + 209
9   com.apple.LLDB.framework        0x0000000121e4398f lldb_private::Symtab::AppendSymbolIndexesWithName(lldb_private::ConstString const&, std::vector<unsigned int, std::allocator<unsigned int> >&) + 103
10  com.apple.LLDB.framework        0x0000000121de20e1 ObjectFileMachO::ParseSymtab(bool) + 10381
11  com.apple.LLDB.framework        0x0000000121ddf7d0 ObjectFileMachO::GetSymtab() + 132
12  com.apple.LLDB.framework        0x0000000121d55f3f lldb_private::Module::ResolveSymbolContextForAddress(lldb_private::Address const&, unsigned int, lldb_private::SymbolContext&) + 273
13  com.apple.LLDB.framework        0x0000000121d37f2c lldb_private::Address::CalculateSymbolContext(lldb_private::SymbolContext*, unsigned int) const + 158
14  com.apple.LLDB.framework        0x0000000121e365e5 lldb_private::CompileUnit::ResolveSymbolContext(lldb_private::FileSpec const&, unsigned int, bool, bool, unsigned int, lldb_private::SymbolContextList&) + 733
15  com.apple.LLDB.framework        0x0000000121d0098e lldb_private::BreakpointResolverFileLine::SearchCallback(lldb_private::SearchFilter&, lldb_private::SymbolContext&, lldb_private::Address*, bool) + 384
16  com.apple.LLDB.framework        0x0000000121d665fc lldb_private::SearchFilter::DoModuleIteration(lldb_private::SymbolContext const&, lldb_private::Searcher&) + 346
17  com.apple.LLDB.framework        0x0000000121d6646d lldb_private::SearchFilter::Search(lldb_private::Searcher&) + 127
18  com.apple.LLDB.framework        0x0000000121e69396 lldb_private::Target::CreateBreakpoint(std::tr1::shared_ptr<lldb_private::SearchFilter>&, std::tr1::shared_ptr<lldb_private::BreakpointResolver>&, bool) + 318
19  com.apple.LLDB.framework        0x0000000121e694b5 lldb_private::Target::CreateBreakpoint(lldb_private::FileSpecList const*, lldb_private::FileSpec const&, unsigned int, bool, lldb_private::LazyBool, bool) + 147
20  com.apple.LLDB.framework        0x0000000120f8be95 lldb::SBTarget::BreakpointCreateByLocation(lldb::SBFileSpec const&, unsigned int) + 203
21  com.apple.LLDB.framework        0x0000000120f8bd98 lldb::SBTarget::BreakpointCreateByLocation(char const*, unsigned int) + 58
22  com.apple.dt.dbg.DebuggerLLDB   0x000000010fbad1d9 -[DBGLLDBSession _createBreakpointFromFileBreakpoint:] + 150
23  com.apple.dt.dbg.DebuggerLLDB   0x000000010fbacd9d -[DBGLLDBSession createBreakpoint:] + 243
24  com.apple.dt.dbg.DebuggerFoundation 0x000000010f9e245a -[DBGDebugSession _createBreakpointIfNeccessary:] + 77
25  com.apple.dt.dbg.DebuggerFoundation 0x000000010f9e2a61 -[DBGDebugSession _handleBreakpointActivationChanged] + 191
26  com.apple.dt.dbg.DebuggerLLDB   0x000000010fba9ed2 _ZL20DBGLLDBSessionThreadPv + 1753
27  com.apple.LLDB.framework        0x0000000121dafb38 _ZL22ThreadCreateTrampolinePv + 91
28  libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
29  libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 17:
0   libsystem_kernel.dylib          0x00007fff8e2d367a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff8e2d2d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff8687950c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff86881c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff86881486 CFRunLoopRunSpecific + 230
5   com.apple.DebugSymbols          0x00007fff873342f2 _ZL20SpotlightQueryThreadPv + 434
6   libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
7   libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 18:
0   libsystem_kernel.dylib          0x00007fff8e2d4ad2 __open + 10
1   libclang.dylib                  0x000000010d3d6614 0x10cedf000 + 5207572
2   libclang.dylib                  0x000000010d3d4d10 0x10cedf000 + 5201168
3   libclang.dylib                  0x000000010d3d4e9d 0x10cedf000 + 5201565
4   libclang.dylib                  0x000000010cfb3dec 0x10cedf000 + 871916
5   libclang.dylib                  0x000000010cfba3e4 0x10cedf000 + 898020
6   libclang.dylib                  0x000000010cfb983c 0x10cedf000 + 895036
7   libclang.dylib                  0x000000010cfbacb9 0x10cedf000 + 900281
8   libclang.dylib                  0x000000010cf3b357 0x10cedf000 + 377687
9   libclang.dylib                  0x000000010cf3b234 0x10cedf000 + 377396
10  libclang.dylib                  0x000000010cf530d9 0x10cedf000 + 475353
11  libclang.dylib                  0x000000010cf319b4 0x10cedf000 + 338356
12  libclang.dylib                  0x000000010cf2048f 0x10cedf000 + 267407
13  libclang.dylib                  0x000000010d411f9e 0x10cedf000 + 5451678
14  libclang.dylib                  0x000000010d412049 0x10cedf000 + 5451849
15  libclang.dylib                  0x000000010d41c50d 0x10cedf000 + 5494029
16  libsystem_c.dylib               0x00007fff83a6b8bf _pthread_start + 335
17  libsystem_c.dylib               0x00007fff83a6eb75 thread_start + 13

Thread 16 crashed with X86 Thread State (64-bit):
  rax: 0x0000000000000000  rbx: 0x0000000128cf0608  rcx: 0x0000000000000000  rdx: 0x00007fff8b6fac79
  rdi: 0x0000000128cf0608  rsi: 0x00007fff72ec4560  rbp: 0x0000000128cefab0  rsp: 0x0000000128cefa80
   r8: 0x00007fff72ec46e8   r9: 0x00007fff72ec46e8  r10: 0x000000012cd567f1  r11: 0x0000000000000052
  r12: 0x0000000128cefdf8  r13: 0x0000000128cf0770  r14: 0x0000000000000000  r15: 0x0000000128cefa88
  rip: 0x00007fff8b6fabb3  rfl: 0x0000000000000202  cr2: 0x000000010d4f92d0
Logical CPU: 0

Model: Macmini4,1, BootROM MM41.0042.B03, 2 processors, Intel Core 2 Duo, 2.66 GHz, 4 GB, SMC 1.65f2
Graphics: NVIDIA GeForce 320M, NVIDIA GeForce 320M, PCI, 256 MB
Memory Module: BANK 0/DIMM0, 2 GB, DDR3, 1067 MHz, 0x80CE, 0x4D34373142353637334648302D4346382020
Memory Module: BANK 1/DIMM0, 2 GB, DDR3, 1067 MHz, 0x80CE, 0x4D34373142353637334648302D4346382020
AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0x93), Broadcom BCM43xx 1.0 (5.106.198.4.20)
Bluetooth: Version 4.0.5f11, 2 service, 18 devices, 1 incoming serial ports
Network Service: AirPort, AirPort, en0
Serial ATA Device: Hitachi HTS725050A9A362, 500.11 GB
Serial ATA Device: Hitachi HTS725050A9A362, 500.11 GB
USB Device: Keyboard Hub, apple_vendor_id, 0x1006, 0x24100000 / 2
USB Device: Apple Keyboard, apple_vendor_id, 0x024f, 0x24120000 / 3
USB Device: iPhone, apple_vendor_id, 0x12a0, 0x26200000 / 2
USB Device: BRCM2070 Hub, 0x0a5c  (Broadcom Corp.), 0x4500, 0x06600000 / 3
USB Device: Bluetooth USB Host Controller, apple_vendor_id, 0x8218, 0x06630000 / 5
USB Device: IR Receiver, apple_vendor_id, 0x8242, 0x06500000 / 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T21:44:44.713

我们最近修复了一些名称拆解问题。名称 demangler 内置于操作系统的 libc++abi.dylib 中。您可以自己构建并安装它以解决您的问题：

```
% sudo cp /usr/lib/libc++abi.dylib /usr/lib/libc++abi.dylib.orig
% svn co http://llvm.org/svn/llvm-project/libcxxabi/trunk libcxxabi
% cd libcxxabi/lib
% TRIPLE=x86_64-apple-macosx ./buildit
% sudo cp libc++abi.dylib /usr/lib/libc++abi.dylib 
```

您也可以直接“试用”而不安装“libc++abi.dylib”，以确保它首先修复问题。其步骤是：

先退出 Xcode，然后：

```
% svn co http://llvm.org/svn/llvm-project/libcxxabi/trunk libcxxabi
% cd libcxxabi/lib
% TRIPLE=x86_64-apple-macosx ./buildit
% DYLD_LIBRARY_PATH=`pwd` /Applications/Xcode.app/Contents/MacOS/Xcode 
```

这将运行 Xcode 并允许它使用您刚刚构建的“libc++abi.dylib”的本地副本。

# java - 在 Java 中创建通用有序链表，使用 compareTo() 时遇到问题

> ID：11905380
> 
> 赞同：2
> 
> 时间：2012-08-10T16:05:44.620
> 
> 标签：java, inheritance, linked-list, operator-overloading

[解决了]

我是一个学习 Java 的 C++ 人（希望）是为了一份即将到来的工作。因此，我正在自己练习在 Java 中实现链接列表。我完成了一个标准的双向链表，它工作得很好。然而，我随后尝试创建一个有序链表，并意识到无法重载 '<' 运算符将是一个严重的问题。

我在这个网站上查看了其他人的问题，但它仍然没有让我明白，所以我想我会发布我的代码并得到更适合我正在做的事情的答案。

向前..

链表类：

```
public class MyList<T>  {

/*** ~Public Interface~ ***/
       //insert, delete, size, print, etc.
       ...

    /*** Private Data Members ***/
       //node begin, end, T data
   ....

/** Private node class **/
//Represents the nodes in the list
private class node implements Comparable<T>{ //Don't know if this is right
    node next;
    node prev;
    T    data;

    node(node p, node n, T d){
        next = n;
        prev = p;
        data = d;
    }

    @Override
    public int compareTo(T o) {
        return (data <= o ? 1 : 0); //Get an error still here
    }

          /** Iterator **/
               //iterator class
} 
```

有序链表类：

```
public class OrderedList<T> extends MyList<T> implements Comparable<T>{ //Pretty sure this is wrong

public void insert(T d){
    if(empty()){
        push_front(d);
    } else {
        MyList<T>.MyListIter it = begin();
        int i = 0;
             //This won't work obviously
        for(; i < size() || it.current().compareTo(it.next()) == -1; ++i, it.next()){
                    //find node to place the new node before it 
                        it.prev() //Need to go back one since we went forward in the loopcheck.

        }
    }
} 
```

在这里真是不知所措。如何实现类似于运算符重载的东西，以便我可以完成这个有序列表实现？

我也在尝试掌握 Java 中的继承，因此，如果您在这方面发现有问题，也请随时加入。

谢谢大家。

更新：

好的，我做了我认为必须做的改变，但我仍然遇到错误。这是新代码：

MyList 类中的节点类：

```
private static class node<T> implements Comparable<T>{
    node<T> next;
    node<T> prev;
    T    data;

    node(node<T> p, node<T> n, T d){
        next = n;
        prev = p;
        data = d;
    }

    public int compareTo(T o) {
        return ((Comparable<T>) this.data).compareTo(o);
    }

} 
```

有序列表：

公共类 OrderedList> 扩展 MyList{

compareTo 的用法：

```
if(((Comparable<T>) it).compareTo(it.next()) == -1) found = true; 
```

编译器强迫我做这些转换，现在错误是：

```
MyList$MyListIter cannot be cast to java.lang.Comparable 
```

列表迭代器类如下所示：

```
public class MyListIter{ 
```

它在 MyList 中。

编辑[已解决]

当我使用我的迭代器时，我没有使用 it.current() 来访问实际数据，而是使用 it.compareTo(..)，但是我的迭代器当然不是数据，因此对它一无所知相比于（）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:11:52.470

虽然这是一个很好的练习，但我不会雇用这样的人：a）更喜欢使用自己的 LinkedList 而不是内置的 b）当有排序集合时使用 LinkedList 作为排序集合，而 ArrayList 对于这种排序更有效这个的.. ;）

我建议您阅读 LinkedList、ArrayList 和 TreeSet 的源代码，以了解它们是如何在 JDK 中实现的。我还建议您阅读和中所有类和接口的源`java.lang.`代码`java.util.`

您想让 Node 与其他节点具有可比性，并且您的数据类型也需要具有可比性。您还应该使用 Java 代码约定。

```
public class MyList<T extends Comparable<T>> { 
```

* * *

```
static class Node {
    Node prev, next;
    T    data;

    Node(Node p, Node n, T d){
        next = n;
        prev = p;
        data = d;
    }
}

public void insert(T d){
    if(empty()){
        push_front(d);
        return;
    }
    for (Node<T> node = first;node.next != null; node = node.next) {
       // if less than we need to insert before.
       if (d.compareTo(node.data) < 0) {
          if (node == first) {
              first = new Node(null, first, d);
              node.prev = first;
          } else {
              node = new Node(node.prev, node, d);
              node.prev.next = node;
          }
          return;
       } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:26:49.953

正如您所说，您不能在 Java 中重载运算符。这意味着您的排序列表**永远不能使用 <= 来比较任何类型的对象**。相反，您需要依赖数据对象来拥有一个`compareTo()`方法或为您的列表的用户提供一种方法来提供一个`Comparator`对象。如果您希望将列表严格限制为第一种情况，您可以将其声明为

```
public class OrderedList<T implements Comparable<T>> extends MyList<T> 
```

这将保证插入到列表中的对象具有`compareTo()`方法。现在，您的`Node.compareTo()`函数只是将比较与此方法进行了比较：

```
public int compareTo(T o) {  
    return this.data.compareTo(o.data);
} 
```

允许 custom`Comparator`可能会有点棘手。我建议您在进行默认比较后将其保留。

ps 您希望能够相互比较列表吗？如果是这样，那么`OrderedList`实施`Comparable`是有意义的。但是，在您的列表类使用其基本操作之后，您可能希望将其留到以后的练习中。

# asp.net-mvc-3 - 使用 Unity Container 时没有为此对象异常定义无参数构造函数

> ID：11905381
> 
> 赞同：9
> 
> 时间：2012-08-10T16:05:51.013
> 
> 标签：asp.net-mvc-3, c#-4.0, unity-container, ioc-container

我在尝试加载视图时遇到上述异常。

我正在使用 Unity 来初始化我的控制器实例。仍然收到上述错误。

这是我的控制器。

```
public class SiteController : Controller
{

    private ISiteRepository _repository;

    public SiteController(ISiteRepository repository)
    {
        _repository = repository;
    }

    //
    // GET: /Site/

    public ActionResult Index()
    {
        return View();
    }

    //
    // GET: /Site/Details/5

    public ActionResult Details(int id)
    {
        return View();
    }} 
```

这是我的 Global.asax.cs

```
protected void Application_Start()
    {
        ConfigApi(GlobalConfiguration.Configuration);
        AreaRegistration.RegisterAllAreas();

        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
    }

    static void ConfigApi(HttpConfiguration config)
    {
        var unity = new UnityContainer();
        unity.RegisterType<SiteController>();
        unity.RegisterType<ISiteRepository, SiteRepository>(new HierarchicalLifetimeManager());

        config.DependencyResolver = new IocContainer(unity);
    } 
```

这是我的 SiteRepository 类。

```
public class SiteRepository:ISiteRepository
{
    private readonly SampleMVCEntities _dbContext;

    public SiteRepository()
    {
        _dbContext = new SampleMVCEntities();
    }

    private IQueryable<SiteConfig> MapSiteConfig()
    {
        return _dbContext.SiteConfigs.Select(a => new SiteConfig
        {
            Name = a.Name,
            LinkColour = a.LinkColour,
            SiteLogo = a.SiteLogo,
            SiteBrands = a.SiteBrands.Select(b => new Models.SiteBrand { SiteId = b.SiteId, BrandId = b.BrandId })
        });
    }

    public IEnumerable<SiteConfig> GetAll()
    {
        return MapSiteConfig().AsEnumerable();
    }} 
```

这是我的错误堆栈。

没有为此对象定义无参数构造函数。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

> 异常详细信息：System.MissingMethodException：没有为此对象定义无参数构造函数。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [MissingMethodException: 没有为此对象定义无参数构造函数。] System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck) +0
> System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark) +114
> System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark) +232 System.Activator.CreateInstance(Type type, Boolean nonPublic) +83 System.Activator.CreateInstance(Type type ) +6 System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +55
> 
> [InvalidOperationException：尝试创建类型为“Config.Controllers.SiteController”的控制器时发生错误。确保控制器有一个无参数的公共构造函数。]
> System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +179
> System.Web.Mvc.DefaultControllerFactory.GetControllerInstance(RequestContext requestContext, Type controllerType) +80
> System. Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName) +74
> System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory) +197 System.Web.Mvc.<> *c_DisplayClass6.b*_2() +49 System.Web.Mvc.<>c__DisplayClassb 1 func) +88 System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback 回调, 对象状态) +98 System.Web.Mvc.MvcHandler.BeginProcessRequest( HttpContext httpContext，AsyncCallback 回调，对象状态）+50 System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest（HttpContext context，AsyncCallback cb，Object extraData）+16 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication。 IExecutionStep.Execute() +268 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155`1.<ProcessInApplicationTrust>b__a() +13 System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7 System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
> System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Func`

* * *

有人可以帮助我吗？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-13T10:06:16.517

ASP.NET MVC 和 ASP.NET Web API**使用两个独立的依赖解析器**。

对于派生自您的“常规”MVC 控制器，`Controller`您需要使用`DependencyResolver.SetResolver`：

```
DependencyResolver.SetResolver(new UnityDependencyResolver(container)); 
```

对于派生形式的 Wep API 控制器，`ApiController`您需要`GlobalConfiguration.Configuration.DependencyResolver`在代码中使用 as。

因此，如果您打算同时使用这两种类型的控制器，您需要注册您的容器两次。

有一篇很好的文章如何为两个依赖解析器设置 Unity：

[使用 Unity 的 ASP.NET MVC 4 和 WebAPI 中的依赖注入](http://netmvc.blogspot.hu/2012/04/dependency-injection-in-aspnet-mvc-4.html)

# perl - 无法检查 CGI 会话是否已过期

> ID：11905383
> 
> 赞同：1
> 
> 时间：2012-08-10T16:06:05.413
> 
> 标签：perl, cgi, session-state

```
my $arr;
%cookies = CGI::Cookie->fetch;
for (keys %cookies) {
    $arr = ($cookies{$_});
}

@arr1 = split("=", $arr);
@arr2 = split(";", $arr1[1]);
$cgi_session = CGI::Session->load($arr2[0]);

print "Content-Type: text/html\n\n";

if ($cgi_session->is_expired) {
    print "session expire\n";
}
else {
    print "session valid\n";
} 
```

会话被初始化为在 1 分钟后过期，但在检查是否过期时它总是进入 else。虽然会话实际上会过期，因为代码在一分钟后不起作用。我想检查是否过期将用户重定向到登录页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T04:01:33.170

首先，您的代码中没有任何内容显示正在设置 cookie。目前尚不清楚这是如何发生的。

其次，当你使用 CGI::Session 时，你应该`$cgi_session->flush()`在脚本退出之前调用。

第三，您确定要手动解决所有这些问题，而不是使用 Perl 的 Web 框架之一作为起点吗？

# arrays - 初始化短字符串数组的正确方法？

> ID：11905384
> 
> 赞同：1
> 
> 时间：2012-08-10T16:06:05.593
> 
> 标签：arrays, delphi, initialization

在一些继承的遗留代码中，我发现了一个问题，即随机垃圾出现在输出中到未初始化的数据结构。它定义为：

```
MyArray: array of array of ShortString; 
```

当我们从这个结构中读取值时，我们有时会得到明显来自坏地方的垃圾，并且每次运行它都会改变。

我认为这将是初始化此数组的正确方法：

```
FillChar (MyArray, SizeOf (MyArray), 0) 
```

然而，当我开始阅读各种网站时，我开始怀疑自己。这是初始化这个数组的最佳/正确方法吗？0 是正确的 FillValue，还是应该是 #32？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:11:56.780

由于没有指定大小，这是一个动态数组。Fillchar 不是初始化它们的正确方法。由于它们是托管类型，因此它们会自动初始化。如果以后你想清空数组，你可以使用`SetLength(MyArray,0)`或者只是`MyArray := nil`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-10T17:23:41.313

Afaik 短字符串不会自动初始化。因此，将长度设置为正确的大小，例如

```
setlength(myarray,10,12); 
```

然后将所有字符串的长度设置为0：

```
for i:=0 to length(myarray)-1 do
  for j:=0 to length(myarray[i])-1
      setlength(myarray[i][j],0); 
```

# wpf - 不要从隐藏窗口调用 CanExecute 方法

> ID：11905387
> 
> 赞同：1
> 
> 时间：2012-08-10T16:06:20.053
> 
> 标签：wpf, mvvm

我在我的 WPF 应用程序中使用 MVVM 模式。我正在尝试缓存我的窗口以提高性能。为此，我从不关闭它们，只是隐藏而不是关闭。所有隐藏的窗口都存储在字典中，因此我可以重复使用它们。当窗口再次打开时，我创建一个新的视图模型并将其与缓存视图相关联。

但这有一个问题，因为隐藏窗口不断调用 ViewModels 中命令的 CanExecute 方法。当用户打开和关闭很多窗口时，这会导致性能问题。

当我将`Window.DataContext`属性设置为 null 或者`ClearValue(DataContextProperty)`我是否实现了我的目标时，但存在问题。如果我有任何两种方式绑定，它们都会在从数据上下文解除绑定期间触发。因此，我的视图模型中的某些值变为空。我不希望这样，因为在某些情况下，我会在隐藏视图后从 ViewModel 中读取属性。

你能帮我解决主要问题吗（不要从隐藏窗口调用 CanExecute 方法）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:39:00.330

我认为您无法控制`CommandManager`决定触发`RequerySuggested`事件的时间和地点。您可能能够减轻性能损失的一种方法是在您的 ViewModel 上拥有一个属性，该属性允许您抑制`CanExecute`. 每当 ViewModel 绑定的 View 隐藏时，您可以将此属性设置为**True**

**一个简单的例子**

```
// Called when a view goes into hiding
myViewModel.SuppressCommandRequery = True 
```

在您的 CanExecute 处理程序中，只需将此行放在方法的开头

```
public bool CanExecuteCommand(Object parameter) {

    if (this.SuppressCommandRequery) 
        return;

    // Continue processing the event...
} 
```

我会指出，当视图从隐藏状态中消失时，您需要特别注意禁用抑制。但是，在重新显示 View 导致 ViewModel 的新实例的情况下，这不是必需的。

或者，看看[这个](https://stackoverflow.com/questions/3506283/can-i-suppress-the-canexecute-call-within-the-mvvm-pattern?rq=1)关于使用`DeletegateCommand`Prism MVVM 框架中的实现的问题。我自己没有使用过这个，但看起来它可以解决你的一些问题。

# jquery - jQuery 中 jQuery 的转义字符

> ID：11905389
> 
> 赞同：0
> 
> 时间：2012-08-10T16:06:22.463
> 
> 标签：jquery, html, fancybox

这是我的代码：

```
$('div#fancy_notification').prepend('<a class="close" onclick="jQuery("#fancy_notification").css("display", "none"); return false;" href="#">test</a>'); 
```

这部分渲染不正确，我想我必须转义一些字符......：

```
onclick="jQuery("#fancy_notification").css("display", "none"); return false;" 
```

我怎样才能做到这一点？有没有更漂亮的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:51:44.617

您应该使用委托/开启功能。

```
 $('#fancy_notification').prepend('<a id="close1" class="close" href="#">test</a>');

  $(document).on('click', '#close1', function(){
        $(this).css("display", "none");
        return false;
  }); 
```

我通常会尽量避免使用内联脚本。

小提琴链接：http: [//jsfiddle.net/gqwUM/2/](http://jsfiddle.net/gqwUM/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:07:49.883

尝试

```
$('div#fancy_notification').prepend('<a class="close" onclick=\'jQuery("#fancy_notification").css("display", "none"); return false;\' href="#">test</a>'); 
```

# php - Node.JS 和 PHP AES-128-EBC 数据加密

> ID：11905392
> 
> 赞同：2
> 
> 时间：2012-08-10T16:06:35.643
> 
> 标签：php, javascript, node.js, encryption

我正在尝试在 javascript (node.js) 中生成一个加密的数据块，然后通过 HTTP 传递到另一个系统。我在 php 中获得了一个参考系统来比较我的结果。

由于我似乎无法理解的原因，我无法让我的 javascript 版本生成与 PHP 版本相同的加密数据。我已经检查过我使用的密钥是否相同。有没有人有任何线索或提示我做错了什么。

（是的，我知道欧洲央行很糟糕，但这不是我的选择）

### 参考 PHP 实现

```
<?php

function getEncrypt($str, $key)
{
    $realKey = substr($key, 0, 16);
    $padding = pkcs5_pad($str, 16);
    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $realKey, $padding, MCRYPT_MODE_ECB));
}

function pkcs5_pad ($text, $blocksize)
{
    $pad = $blocksize - (strlen($text) % $blocksize);
    return $text . str_repeat(chr($pad), $pad);
}

$key = "oi3sgkosQPIdFa0eVSjecIhkha2nAfpn3anAozln0e9rkIGPvzUBgToCtlXLsKyjBITGKozHmn1NArgQodawidiVnyxccsf8ZnUgof4kq0iBCS7wrG1raytauMusRjjb";
$string = '{"pol.start":"11-06-2012 09:00:00","pol.end.after":43200,"lic.cache":"yes","playback":2880,"out.digital":"use","out.analog":"use"}';

$encData = getEncrypt($string, $key);

var_dump($encData); 
```

### 我的 Javascript 尝试：

```
var crypto = require('crypto');
var cipherAlgo = 'AES-128-ECB';

var policy = '{"pol.start":"11-06-2012 09:00:00","pol.end.after":43200,"lic.cache":"yes","playback":2880,"out.digital":"use","out.analog":"use"}';
var sharedSecret = 'oi3sgkosQPIdFa0eVSjecIhkha2nAfpn3anAozln0e9rkIGPvzUBgToCtlXLsKyjBITGKozHmn1NArgQodawidiVnyxccsf8ZnUgof4kq0iBCS7wrG1raytauMusRjjb';

var util = require('util');

function encrypt(string, key)
{
    var realKey = key.substring(0,16);
    var cipher = crypto.createCipher(cipherAlgo, key.substring(0,16));
    //encrypt our string
    var encrypted = cipher.update(string, 'utf8', 'base64');
    encrypted += cipher.final('base64');
    return encrypted;
}

console.log(encrypt(policy, sharedSecret)); 
```

我已经尝试了很多事情，比如将输出重新调整为二进制文件、放入缓冲区和 base64ing 等等。
为了我的理智，有人可以帮忙解决这个问题。

# crystal-reports - Crystal Reports 2010 未显示复杂对象的所有字段

> ID：11905393
> 
> 赞同：1
> 
> 时间：2012-08-10T16:06:35.643
> 
> 标签：crystal-reports

我在使用复杂对象填充报表时遇到了一些问题。我只使用 .NET 对象，不涉及数据库。以下是我的班级结构：

```
public int Year { get; set; }
public List<Schedule> { get; set; } 
```

计划类本身有许多十进制属性，名称为字符串属性。

当我将这个类添加到我的报告中时，唯一可用的报告字段是年份。这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T18:27:36.630

你最好把这个类分成两个单独的类。在两个类上使用相同的属性并在 Crystal Reports 中链接它们就像在一个键上连接两个表。

# java - 为什么需要单击两次才能突出显示我的 JTree？

> ID：11905397
> 
> 赞同：1
> 
> 时间：2012-08-10T16:06:50.137
> 
> 标签：java, swing, jtree

我有一个附加了 SelectionListener 的 JTree。当我单击树中的节点时，侦听器运行正常并正确通知我。

*但是*，节点在选择时并不总是突出显示。事实上，它需要两次点击才能让节点上的可视“蓝框”出现。

为什么以下代码需要两次单击才能显示选择？

**JTree的创建**

```
JTree tree = new JTree();
tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
tree.setDragEnabled(true);
tree.setDropMode(DropMode.ON);
tree.expandRow(0);
tree.setModel(model.getActiveFilterModel()); 
```

**添加监听器**

```
tree.addTreeSelectionListener(new TreeSelectionListener() {
    @Override
        public void valueChanged(TreeSelectionEvent event) {
            JTree tree = (JTree) event.getSource();
            DefaultMutableTreeNode selectedNode = (DefaultMutableTreeNode) tree.getLastSelectedPathComponent();
            if (selectedNode != null) {
                model.setSelectedFilter((Filter) selectedNode.getUserObject());
            }
        }
}); 
```

编辑：

我想补充一点，它似乎只有在我第二次在树上调用 .setModel 时才会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:34:44.107

问题是我正在使用观察者模式并不断调用显示（例如，JTree，更新（））。这本身不是问题。

但是，在我的更新调用中，我一直在使用 tree.setModel(...) ，而实际上底层模型本身会处理这些更改。我将代码切换为仅调用 setModel() 一次，现在一切正常。

# c# - 如何在 WP7 按钮中绑定内容

> ID：11905398
> 
> 赞同：0
> 
> 时间：2012-08-10T16:06:57.667
> 
> 标签：c#, windows-phone-7, xaml, binding, ivalueconverter

我之前问过如何转换`TextBlocks`使用绑定的静态值，如此[处](https://stackoverflow.com/q/11796930/746968)`IValueConverter`所示。

现在我想做同样的事情，但是用按钮代替。但问题是，按钮没有`DataContext`属性，所以`IValueConverter`没有调用。

那么我该如何实现呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:13:09.390

怎么设置

```
Button.Content.DataContext 
```

?

编辑：XAML 示例已修复

```
<Button Name="mmmm" 
        DataContext="{Binding MovieContext}" 
        Content="{Binding Title}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T18:25:10.597

按钮确实有一个[DataContext 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.button%28v=VS.95%29.aspx)。所有 FrameworkElements 都可以。为什么不直接设置所有这些所在的 Page 的数据上下文？如果您将页面的 DataContext 设置为支持 ViewModel，那么每个控件都将继承该 DataContext。

# sql-server-2008 - ssrs color 空列的背景颜色

> ID：11905401
> 
> 赞同：1
> 
> 时间：2012-08-10T16:07:12.587
> 
> 标签：sql-server-2008, reporting-services

我有一张这样的桌子：

```
[Name] [Position]
a          0
b          1
c          2
d          3
e          4
f          5 
```

我创建了一个图表，其中 [Name] 作为行，[Position] 作为列，位置计数作为值。
像这样：

```
 0   1  2  3  4  5
a    1
b        1
c           1
d              1
e                 1
f                    1 
```

我想将 [Position] = 2 的所有列设为蓝色，将所有其他列设为白色。我无法弄清楚如何做到这一点，因为行在该位置没有值，例如 Position(e) = 4，并且在 2 处没有值。

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T17:47:13.287

对于任何有同样问题的人，您实际上可以像这样获得特定框的值： `ReportItems("Textbox600").Value`

只需将 600 替换为单元格名称即可。选择单元格时，名称显示在属性框工具栏的正上方。

在本例中，Textbox600 是 [Position]，因此此单元格背景颜色的表达式如下所示：

```
Iif(ReportItems("Textbox600").Value = 2, "Blue", "White") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T05:32:31.853

C2 是唯一填充的，因为它是“2”列中唯一存在数据的单元格。可能您可以交叉加入您的姓名和职位以生成所有单元格的值，例如

```
SELECT 
    a.name,
    b.position,
    CASE WHEN c.name IS NOT NULL THEN 1 ELSE 0 END AS position_count
FROM 
(
(SELECT [name] FROM #temp) a
CROSS JOIN 
(SELECT [position] FROM #temp)b
) 
LEFT JOIN #temp c ON a.name = c.name and b.position = c.position 
```

返回

```
name position position_count
---- -------- --------------
a    0        1
a    1        0
a    2        0
a    3        0
a    4        0
a    5        0
b    0        0
b    1        1
b    2        0
b    3        0
b    4        0 
```

等等

那应该让您使用表达式在列组上设置背景颜色。您可以在单元格上添加表达式以抑制“零”值。

# javascript - 如何在我的函数中使用 .bind()

> ID：11905403
> 
> 赞同：0
> 
> 时间：2012-08-10T16:07:15.867
> 
> 标签：javascript, jquery, bind

我有一个在网页上推进滚动图像的功能。可以在这里看到：

[http://leadgenixhosting.com/~intmed/](http://leadgenixhosting.com/~intmed/)

右箭头是您单击以推进图像的方向。我在使用 .unbind() 的地方遇到了这个问题，因此在图像使用 .animate() 完成之前，箭头是不可点击的，这样它们就不会不同步。但我不完全确定如何使用 .bind() 使箭头再次可点击。

这是函数当前的样子：

```
$('#in-right').click(
        function(){
            $('#in-right').unbind('click');
            imageSwitch();
            $('#in-right').bind('click');
        }
); 
```

我显然错误地实现了绑定。我怎样才能正确实施它？

这是我的 imageSwitch() 函数：

```
function imageSwitch(){

        current++;
        current_image++;
        previous_image++;
        next++;
        two_prev++

        if(two_prev >= divs.length){
            two_prev = 0;   
        }

        if(current >= gallery_images.length){
            current = 0;    
        }

        if(previous_image >= divs.length){
            previous_image = 0; 
        }

        if(current_image >= divs.length){
            current_image = 0;
        }

        if(next >= divs.length){
            next = 0;
        }   

        $('#'+divs[current_image]+'').animate({left:'-=1020px'},{queue:false,duration:1000})
        $('#'+divs[current_image]+'').css('background-image','url('+gallery_images[current]+')');

        $('#'+divs[previous_image]+'').animate({left:'-=1020px'},{queue:false,duration:1000});

        $('#'+divs[next]+'').animate({left: '+=1020px', top: '-=10000px'}, 1000);

        $('#'+divs[two_prev]+'').animate({left: '+=1020px', top: '+=10000px'}, 1000);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T16:09:48.590

`.bind`要求您将函数作为第二个参数传递给它。

```
function clickFunc(){  // Give the event function a name
    $('#in-right').unbind('click');
    imageSwitch();
    $('#in-right').click(clickFunc);  // .click is shorthand for `.bind('click',`
}
$('#in-right').click(clickFunc); 
```

**编辑**：你应该让你的`imageSwich`函数接受一个回调，这样它就可以在完成动画后重新绑定函数。

```
function imageSwitch(callback){
    // code...
}

function clickFunc(){  // Give the event function a name
    $('#in-right').unbind('click');
    imageSwitch(function(){
        $('#in-right').click(clickFunc);
    });
}
$('#in-right').click(clickFunc); 
```

至于确保所有动画完成后回调运行，我们可以使用 jQuery 的[deferreds](http://api.jquery.com/category/deferred-object/)。

基本上，您希望将返回的对象保存`.animate`到变量中。然后使用`$.when`, 和`.then`在正确的时间运行回调。

（这是未经测试的，顺便说一句）

```
function imageSwitch(callback) {
    var animations = [];

    current++;
    current_image++;
    previous_image++;
    next++;
    two_prev++

    if (two_prev >= divs.length) {
        two_prev = 0;
    }

    if (current >= gallery_images.length) {
        current = 0;
    }

    if (previous_image >= divs.length) {
        previous_image = 0;
    }

    if (current_image >= divs.length) {
        current_image = 0;
    }

    if (next >= divs.length) {
        next = 0;
    }

    animations.push($('#' + divs[current_image] + '').animate({
        left: '-=1020px'
    }, {
        queue: false,
        duration: 1000
    }));

    $('#' + divs[current_image] + '').css('background-image', 'url(' + gallery_images[current] + ')');

    animations.push($('#' + divs[previous_image] + '').animate({
        left: '-=1020px'
    }, {
        queue: false,
        duration: 1000
    }));

    animations.push($('#' + divs[next] + '').animate({
        left: '+=1020px',
        top: '-=10000px'
    }, 1000));

    animations.push($('#' + divs[two_prev] + '').animate({
        left: '+=1020px',
        top: '+=10000px'
    }, 1000));

    if (typeof callback === 'function') {
        // Apply is used here because `$.when` expects to passed multiple parameters
        $.when.apply($,animations).then(callback);
    }
} 
```

延迟和动画演示：http: [//jsfiddle.net/M58KK/](http://jsfiddle.net/M58KK/)

# javascript - 使用jQuery迭代变量不起作用

> ID：11905407
> 
> 赞同：1
> 
> 时间：2012-08-10T16:07:30.287
> 
> 标签：javascript, jquery

我在页面顶部设置了这个变量`setVars = {"n":"2","m":"1","degree":"3","p":"2"}`

我想遍历 setVars 中的每个元素，但 jquery 的 each() 函数不起作用。

这就是我所拥有的 -

```
$(setVars).each(function(key, value) {
  elementId = '#' + key+ '-wrapper';
} 
```

但是`key`在第一次迭代时这里设置为 0 并且`value`出于某种原因在这里设置为完整的 setVars 对象。它没有进入第二次迭代，当我逐步通过它并尝试进入第二次迭代时它会中断。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:10:50.930

[根据这个http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)应该是我相信的

```
$.each(setVars, function(key, value) {
  elementId = '#' + key+ '-wrapper';
}); 
```

setVars 不是 DOM 元素的集合，它是一个对象

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:11:00.147

您使用[`.each()`的是用于迭代 jQuery 对象](http://api.jquery.com/each/)，而不是[`$.each()`用于迭代对象和数组](http://api.jquery.com/jQuery.each/)。试试这个：

```
$.each( setVars, function(key, value) {
  elementId = '#' + key+ '-wrapper';
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:11:55.873

您不需要为此使用 JQuery。我也可能是错的，但您不希望在您从未见过的对象属性名称周围加上引号：

```
setVars = {n:"2",m:"1",degree:"3",p:"2"} 
```

和

```
for(i in setVars){
   console.log("key: ",i," value: ", setVars[i]); // demonstration of how to access key and value
   elementId = '#' + i + '-wrapper';
} 
```

# java - Java 包不导入

> ID：11905415
> 
> 赞同：1
> 
> 时间：2012-08-10T16:07:50.883
> 
> 标签：java, android

我正在尝试将一堆与 java 相关的 API 导入到我的 android 项目中，但是当我导入它们时它说它找不到包

这是我尝试导入的示例

```
import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JSpinner;
import javax.swing.SpinnerNumberModel;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener; 
```

所有`javax.swing`类都显示错误。当我进入 java JDK 的安装位置并查看`src.zip`文件时，我看到了所有这些类，那么我该怎么做才能让它们工作呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:13:55.153

这是我在互联网上快速搜索后发现的：

**摇摆**

[如何将 javax.swing.* 包添加到我的 android 项目的库中？](https://stackoverflow.com/questions/4230075/how-do-i-add-the-javax-swing-packages-to-my-libs-for-my-android-project)

Synapsis：你不能在你的android项目中使用swing

**AWT**

[将 awt 与 android 一起使用](https://stackoverflow.com/questions/3897775/using-awt-with-android)

Synapsis：你不能直接使用 awt 库，但是你可以自己实现它，或者使用链接到[这里](http://code.google.com/p/awt-android-compat/)的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:15:25.447

我不认为您可以在 Android 应用程序中包含 java.swing 包。我建议您查看 Android 提供的[用户界面构建块](http://developer.android.com/design/building-blocks/index.html)。这是一个[StackOverflow 线程](https://stackoverflow.com/questions/4230075/how-do-i-add-the-javax-swing-packages-to-my-libs-for-my-android-project)，其中有关于无法添加 java.swing 包的类似讨论。

# javascript - Phonegap 打开表单提交到 Web 浏览器上的外部域

> ID：11905420
> 
> 赞同：4
> 
> 时间：2012-08-10T16:08:35.700
> 
> 标签：javascript, forms, jquery-mobile, cordova, submit

我在使用 phonegap 在 Android 和 iPhone 的网络浏览器上打开表单提交时遇到问题。我想用这样的js提交一个表单：

```
<html>
  <body>
    <form target="_blank" action="https://externalDomain.com">
      <input value="123" />
      <input value="456" />
    </form>
    <script>
      form.submit();
      // do something else
    </script>
  </body>
</html> 
```

所以这个脚本的执行发生在存储在设备上的文件中，比如说“index.html”，我希望提交在浏览器上打开，因为我需要用户在“externalDomian.com”上填写支付处理器表单. 然后用户将再次进入应用程序，他可以检查付款是否正确处理。

我在 android 上使用 phonegap 2.0.0 我在 config.xml 上尝试了这个配置，但它没有帮助

```
<access origin="https://externalDomain.com" browserOnly="true" /> 
```

在 iPhone 上，我在 Cordava.plist 上将 OpenAllWhitelistURLsInWebView 标志设置为 NO，也没有帮助。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:15:41.063

执行表单的 AJAX 提交，这样用户实际上不会被重定向到外部网站，而是保留在您的应用程序中：

```
<html>
  <body>
    <form id="foo-form" target="_blank" action="https://externalDomain.com">
      <input value="123" />
      <input value="456" />
    </form>
    <script>
    $('#foo-form').on('submit', function () {

        //create AJAX request to submit form
        $.get(this.action, $(this).serialize(), function (response) {
            //the `response` variable now holds what the server returned after the form submission
        });

        //stop regular submission of form
        return false;
    });
    </script>
  </body>
</html> 
```

然后，您可以将响应添加到 DOM，允许用户填写外部表单。然后绑定到该表单并执行另一个 AJAX 提交。

# mysql - 如何加快这个 MySQL 查询

> ID：11905422
> 
> 赞同：0
> 
> 时间：2012-08-10T16:08:46.357
> 
> 标签：mysql, sql

有人可以帮我解决这个问题吗？它工作正常，但需要太多时间。我确定问题出在`tb_activities`. 有没有人有任何想法让这个查询更快？

```
SELECT tb_posts.*
FROM   tb_posts
WHERE  EXISTS (SELECT c_id
               FROM   tb_users
               WHERE  tb_posts.c_uid = tb_users.c_id
                      AND tb_users.c_tokens > 0)
       AND NOT EXISTS (SELECT c_id
                       FROM   tb_activities
                       WHERE  tb_posts.c_url = tb_activities.c_url
                              AND tb_activities.c_category = 'gplus'
                              AND ( tb_activities.c_uid LIKE '%,6x1,%'
                                     OR tb_activities.c_uid LIKE '%,6x1'
                                     OR tb_activities.c_uid LIKE '6x1,%'
                                     OR tb_activities.c_uid = '6x1' ))
       AND NOT EXISTS (SELECT c_id
                       FROM   tb_blacklist
                       WHERE  tb_posts.c_url LIKE Concat('%', tb_blacklist.c_url
                                                  , '%')
                              AND tb_blacklist.c_times > 2
                              AND tb_blacklist.c_category = 'gplus')
       AND tb_posts.c_category = 'classic'
       AND tb_posts.c_status = 'run'
       AND tb_posts.c_nogplus = 0
GROUP  BY tb_posts.c_url
ORDER  BY tb_posts.c_cost DESC,
          tb_posts.c_date DESC
LIMIT  30 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:35:53.553

我在这里所做的是重写第一个`WHERE EXISTS ...`. 为什么？[这](http://solutionfactor.net/blog/2011/11/06/mysql-inner-join-vs-exists-may-yield-better-performance/)是答案。另一个有趣的读物是[this](http://explainextended.com/2009/09/18/not-in-vs-not-exists-vs-left-join-is-null-mysql/)。因此，您可能会考虑进一步重写查询。不幸的是，我现在没有更多的时间了。但是**通过添加（复合）索引，**您无论如何都会获得**主要的性能提升**。将索引放在s 所基于的列或子句中经常使用的列上。**`JOIN``WHERE`**

 **```
SELECT tb_posts.*
FROM   tb_posts
INNER JOIN tb_users ON tb_posts.c_uid = tb_users.c_id
WHERE  tb_users.c_tokens > 0
       AND NOT EXISTS (SELECT c_id
                       FROM   tb_activities
                       WHERE  tb_posts.c_url = tb_activities.c_url
                              AND tb_activities.c_category = 'gplus'
                              AND ( tb_activities.c_uid LIKE '%,6x1,%'
                                     OR tb_activities.c_uid LIKE '%,6x1'
                                     OR tb_activities.c_uid LIKE '6x1,%'
                                     OR tb_activities.c_uid = '6x1' ))
       AND NOT EXISTS (SELECT c_id
                       FROM   tb_blacklist
                       WHERE  tb_posts.c_url LIKE Concat('%', tb_blacklist.c_url, '%')
                              AND tb_blacklist.c_times > 2
                              AND tb_blacklist.c_category = 'gplus')
       AND tb_posts.c_category = 'classic'
       AND tb_posts.c_status = 'run'
       AND tb_posts.c_nogplus = 0
GROUP  BY tb_posts.c_url
ORDER  BY tb_posts.c_cost DESC,
          tb_posts.c_date DESC
LIMIT  30 
```

此外，您可能想了解有关 的信息[`EXPLAIN`](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)，以便了解使用（或未使用）哪些索引。

作为旁注，Peter Kiss 关于改变`WHERE`子句顺序的提示是无稽之谈。无论如何，查询优化器都会处理这个问题。**

# vaadin - 试图建立我自己的 vaadin widgetset 库

> ID：11905423
> 
> 赞同：2
> 
> 时间：2012-08-10T16:08:48.060
> 
> 标签：vaadin

我有几个应用程序需要在 vaadin 中编写。我试图将我所有的自定义组件和小部件集放在一个库中，就像 vaadin 所做的那样，并将该库简单地包含在我的其他项目中。

我在它的库中有我的第一个小部件，maven 编译库和小部件设置正确，但是当我将它包含在我的实际应用程序中时，我得到了这个

```
Widgetset does not contain implementation for org.vaadin.jonatan.contexthelp.ContextHelp. 
Check its @ClientWidget mapping, widgetsets GWT module description file and re-compile your widgetset. 
In case you have downloaded a vaadin add-on package, you might want to refer to add-on instructions. Unrendered UIDL:
-Unrendered UIDL
-org.vaadin.jonatan.contexthelp.ContextHelp(NO CLIENT IMPLEMENTATION FOUND) id=PID178 followFocus=false helpKey=112 hideOnBlur=true
-variables
selectedComponentId=
hidden=true
Complex field 
```

为什么找不到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:22:53.500

看起来您没有从小部件集定义中的 Vaadin 默认小部件集继承：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE module PUBLIC "-//Google Inc.//DTD Google Web Toolkit 1.7.0//EN" "http://google-web-toolkit.googlecode.com/svn/tags/1.7.0/distro-source/core/src/gwt-module.dtd">
<module>
  <inherits name="com.vaadin.terminal.gwt.DefaultWidgetSet" />
   ... 
```

# git - 在 master 处将旧的 git commit 与 HEAD 合并

> ID：11905428
> 
> 赞同：8
> 
> 时间：2012-08-10T16:09:09.977
> 
> 标签：git, revision-history, git-cherry-pick

我在合并同事的提交时犯了一些错误。现在，我们发现了它，我们需要再次应用旧提交，以手动选择文件中的更改。情况如下所示：

```
A--\       /--F--\
    C--D--E       H--I
B--/^      \--G--/   ^
    |                |
WRONG MERGE       MASTER 
```

我需要 git 再次要求我将 B 与 I 合并，就像 B 从未出现在历史上一样。换句话说，我需要 git 要求我为 B 和我提交的所有不同文件选择合并。做这种事情的最佳方法是什么？我可以用樱桃采摘来做到这一点吗？如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T19:27:47.983

您可以使用提交重复技巧：

```
# make a branch named B started on the commit B
git checkout -b B <sha1 id of the commit B> 
# it creates a branch which starts at a commit
# right before B and has exact copy of commit as B,
# but with a different sha1 id.
git rebase --no-ff HEAD~1

# now we do simple merge
git checkout master
git merge B 
```

它还允许使用提交范围和保留日期、作者、提交消息等来制作技巧。

实际上，您的方案在[文档](https://git-scm.com/docs/git-rebase#git-rebase---no-ff)中进行了描述：

> `--no-ff`...使用新提交重新创建主题分支，以便可以成功地重新合并

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T09:59:29.617

好吧，我终于以这种方式解决了。`B`我从（在我的示例中针对 master ）创建了 diff`I`并手动应用了 meld difftool 中的所有更改：

```
[master]$ yes | git difftool <B hash> -t meld 
```

然后，添加所有更改的文件并提交。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:17:49.480

您可以恢复有问题的合并提交，`git revert -m 1 <commit>`然后`git merge <B_branch>`再次使用。这将为您的历史记录添加一个还原提交。否则，您可以使用`git rebase -i`从历史记录中删除 B 的提交。后者对协作工作更具破坏性，因为所有 WIP 和所有协作者现在都必须重置他们的`master`分支。

如果您不介意还原提交，我强烈推荐它。这是得到你想要的最简单的方法。但是，如果 D、E、F、G、H 或 I 基于 B 的更改集，则还原可能会变得复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T23:45:11.290

假设 master 已签出

```
git branch temp <sha1 of B> 
```

创建对旧提交的引用。

```
git rebase --preserve-merges -i <sha1 of A> 
```

然后取出应该是合并提交的第一行。

现在你只需要让你的 B 回来

```
git merge temp 
```

# javascript - 当函数取消隐藏 2 个元素时，如何在 javascript 中显示/隐藏？

> ID：11905429
> 
> 赞同：1
> 
> 时间：2012-08-10T16:09:09.080
> 
> 标签：javascript, html, show-hide

我有一个 javascript 可以同时隐藏/取消隐藏我的 html 中的 2 个元素。当它只有一个时它工作得很好，但现在由于某种原因，当我单击两次时，某些元素只会消失，我不知道错误在哪里，这是代码以防有人发现错误谢谢。该函数取消隐藏给定 div id 的两个元素（xdivID 和 divID）并保持父级和祖父级可见（idParent idUncle）

```
function doubleunhide(xdivID, divID, idParent, idUncle) {
 var xitem = document.getElementById(xdivID);
 if(xitem){
 xitem.className='unhidden';
}
var item = document.getElementById(divID);
 if(item) {
   item.className='unhidden';
   }
   var elements = getElementsByClassName(document, "unhidden");
      var n = elements.length;
   for (var i = 0; i < n; i++) {
     var e = elements[i];
if ((e.id != divID) && (e.id != xdivID) && (e.id != idParent) && (e.id != idUncle)){
     e.className='hidden';
     }
  }} 
```

以下是它在 html 中的实现方式：

```
<div id="prj" class="hidden" style="margin-left:1em">
    <a href="javascript:doubleunhide('prj011', 'prj01numbers', 'prj', 'nil');" style="text-decoration:none; color: rgb(0,0,0)" id="prj01link">Project 01</a> <br>
    <a href="javascript:doubleunhide('prj021', 'prj02numbers', 'prj', 'nil');" style="text-decoration:none; color: rgb(0,0,0)" id="prj02link">Project 02</a> <br>
    <a href="javascript:doubleunhide('prj031', 'prj03numbers', 'prj', 'nil');" style="text-decoration:none; color: rgb(0,0,0)" id="prj03link">Project 03</a> <br>
    Project 04<br>
    Project 05<br>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:29:50.957

问题是然后你使用原生`node.getElementsByClassName()`的结果数组是“活的”——它会动态变化然后你改变页面。在您的情况下-然后您执行`e.className='hidden';`数组`elements`更改并变得更小-当前元素被清除，因为它不符合您的搜索条件，您传入的内容`getElementsByClassName()`。但是您的代码仍然认为存在相同的元素并对其进行迭代。您最终尝试获取未定义的节点，出现错误并且脚本损坏。为避免这种情况，您可以以相反的顺序迭代：

```
 for (var i = n-1; i >=0 ; i--) {
     var e = elements[i];
     if ((e.id != divID) && (e.id != xdivID) && (e.id != idParent) && (e.id != idUncle)){
         e.className='hidden';
     } 
```

# android - 根据登录状态膨胀 Android OptionsMenu

> ID：11905432
> 
> 赞同：0
> 
> 时间：2012-08-10T16:09:19.837
> 
> 标签：android, android-menu, android-optionsmenu

这是我的代码：

```
 @Override
        public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, menu);
        SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
        SearchView searchView = (SearchView) menu.findItem(R.id.menu_search)
                .getActionView();
        searchView.setSearchableInfo(searchManager
                .getSearchableInfo(getComponentName()));
        searchView.setIconifiedByDefault(true);
        searchView.setSubmitButtonEnabled(true);
        return true;
    }

    @Override
    public boolean onMenuOpened(int featureId, Menu menu) {
        MenuItem Login = menu.findItem(R.id.Login);
        MenuItem Logout = menu.findItem(R.id.Logout);
        MenuItem About = menu.findItem(R.id.About);
        MenuItem Profile = menu.findItem(R.id.Profile);

        // set the menu options depending on login status
        if (LoggedStatus == true) {
            // show the log out option
            Logout.setVisible(true);
            Login.setVisible(false);

            Profile.setVisible(true);
            About.setVisible(true);
        } else {
            // show the log in option
            Logout.setVisible(false);
            Login.setVisible(true);

            Profile.setVisible(false); // hide
            About.setVisible(true);
        }

        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {

        case R.id.Login:
            Intent i = new Intent(this, Login.class);
            startActivity(i);

            return true;
        case R.id.Logout:

            return true;
        case R.id.Profile:

            return true;
        case R.id.About:

            return true;
        default:
            return super.onOptionsItemSelected(item);
        }
    } 
```

我正在`Null pointer exception`处理四个 MenuItem 中的每一个。我只想要一个用于登录的菜单和一个用于注销的菜单。

编辑：这是一个利用操作栏、溢出菜单和 Android 4.0+ 以及更多代码的应用程序。 **这是menu.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/menu_search"
        android:actionViewClass="android.widget.SearchView"
        android:icon="@android:drawable/ic_menu_search"
        android:showAsAction="always"
        android:title="search"/>
    <item
        android:id="@+id/Login"
        android:title="Login"/>
    <item
        android:id="@+id/Logout"
        android:title="Logout"/>
    <item
        android:id="@+id/Profile"
        android:title="My Profile"/>
    <item
        android:id="@+id/About"
        android:title="About"/>

</menu> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T01:36:22.500

您可以设置 in 的可见`MenuItem`性`onPrepareOptionsMenu`。试着搬到那里。

**关于奖金**：。在[DOC](http://developer.android.com/guide/topics/ui/menus.html)中，他们告诉您**每次**按 menu时`onPrepareOptionsMenu`都会调用它。我用一键更改参数进行测试以显示/隐藏，一切都很好**`boolean``onClick``MenuItem`**

# c# - DataGridView.Rows.Count 的问题

> ID：11905434
> 
> 赞同：0
> 
> 时间：2012-08-10T16:09:20.600
> 
> 标签：c#, ms-access, data-binding, datagridview, ado.net

我使用以下方法从 Access 表中填充了 Datagridview：

```
using (OleDbDataAdapter a = new OleDbDataAdapter(sqlQuery, conn))
{
    DataTable t = new DataTable();
    a.Fill(t);
    dataGridView1.DataSource = t;
} 
```

我确信我在 Ms Access 数据库中的原始表中有 100 行，但是当我尝试计算 DataGridView 中的行数并填充标签时，我得到了 101 行（NumofRows）

```
NumofRows.Text = dataGridView1.Rows.Count.ToString(); 
```

当我尝试将 dataGridView 值导出为任何其他格式时，这很重要！你能告诉我为什么要处理这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:13:50.507

没有看到源数据和SqlQuery，我们不能肯定。

我的怀疑是，您的数据或正在呈现的执行中有一个标题行。

最好的检查方法是查看渲染数据并将其与存储的数据进行比较，看看那里有什么。

它也可能是 0 索引错误传达。IE 在您的数据或循环中看到 101，其中 100 是。

如果我们获得更多信息，我们可以做出更好的猜测。

# php - 使用codeigniter将数组推入现有数组？

> ID：11905435
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:09:29.433
> 
> 标签：php, arrays

我正在尝试将新数据推送到现有数组中`$query`：

```
$query = $this->db->get('questions');
foreach ($query->result_array() as $row) {

    $get_answers = $this->db->get_where('answers', array('question_id' => $row['question_id']), 4);
}
//push all the get_answers data into $query array as a subarray
return $query; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:15:56.540

我不认为你的 $query 变量实际上是一个数组，而是一个结果集。你也应该把它放到一个数组中。也许是这样的：

```
$query = $this->db->get('questions');
$result_array = array();
$i = 0;
foreach($query->result_array() as $row){
    $result_array[$i] = $row;
    $result_array[$i]['answers'] = $this->db->get_where('answers', array('question_id'=>$row['question_id']), 4);
    $i++;
}

var_dump($result_array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:10:28.667

~~用于`array_merge()`合并两个数组。~~

只需将其添加到 $query：

```
$query[] = $get_answers; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:13:05.873

这是你想要做的吗？

```
$query = $this->db->get('questions');
$answers = array();

foreach($query->result_array() as $row){
    $get_answers = $this->db->get_where('answers', array('question_id'=>$row['question_id']), 4);

    $answers[] = $get_answers;
} 
```

然后，**您**`$answers[]`可以使用. `$query`_**`result``array_merge()`**

 **```
$returnArray = array_merge($answers, $query);

return $returnArray; 
```**

# jquery-plugins - struts2-jquery-plugin+struts2-json-plugin ：是否可以在同一个动作类中有许多 JSON getter 方法？

> ID：11905439
> 
> 赞同：0
> 
> 时间：2012-08-10T16:09:34.290
> 
> 标签：jquery-plugins, struts2, jsonplugin

我的问题是：如果使用 struts2-jquery-plugin+struts2-json-plugin，我可以定义许多函数，例如：

```
@Actions( {
        @Action(value = "/func1", results = {
          @Result(name = "str1", type = "json")
        })
      })
public String func1(){
  //instructions
  return "str1";
}

@Actions( {
        @Action(value = "/func2", results = {
          @Result(name = "str2", type = "json")
        })
      })
public String func2(){
  //instructions
  return "str2";
} 
```

和许多 JSON 方法获取器，例如：

```
public String getJSON1()
{
  func1();
}
public String getJSON2()
{
  return func2();
} 
```

在同一个动作课上？

非常感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T05:05:20.413

我过去曾尝试过，但没有成功。但我设计了一个解决方法，也许这对你有用。解决方法将参数传递给操作。例如

动作类

```
private String jsonMethod;
//getters and setters

public String getJSON()
{
     if(jsonMethod.equals("findEmp"))
     {

     }else if(jsonMethod.equals("findCust"))
     {

     }
     return SUCCESS;
} 
```

从你的jsp

```
<s:url id="findEmp" namespace="/" action="getJSON" >
    <s:param name="jsonMethod">findEmp</s:param>
</s:url> 
<s:url id="findCust" namespace="/" action="getJSON" >
    <s:param name="jsonMethod">findCust</s:param>
</s:url> 
```

# wordpress - Wordpress：奇怪的重写问题，/randomstring/categoryname 有效

> ID：11905440
> 
> 赞同：1
> 
> 时间：2012-08-10T16:09:45.140
> 
> 标签：wordpress

一点背景知识，我们管理着一个由 25 个不同的 WP 站点组成的网络，这些站点都运行相同的代码库。最近我们有一位 SEO 分析师加入，他注意到一些网站存在奇怪的 404 问题，如下所示：

```
**/category/featured-article/ryan-mcnamara-new-different/news/page/2/** 
```

所以我禁用了所有插件和钩子，尝试全新安装，但这些东西仍在发生。事实证明，只有网站的永久链接结构以 .html 结尾。所以我深入研究了重写代码，结果发现这就是 URL 发生的事情：`**/category/featured-article/ryan-mcnamara-new-different/news**`

*   如果永久链接结构是`**/%category%/%postname%/**`, 则可用的重写规则 ( `$wp_rewrite->rewrite_rules()`) 则匹配此规则： `**(.+?)/([^/]+)(/[0-9]+)?/?$**`，如预期的那样导致 404。
*   如果永久链接结构是`**/%category%/%postname%.html**`，则匹配此规则：`**(.+?)/?$**`，映射到 `**index.php?category_name=$matches[1]**`，因此呈现类别的原因 当用户/机器人找到这些类别页面并单击他们被带到的分页链接时 `**/category/featured-article/ryan-mcnamara-new-different/news/page/2/**`，会导致 404。

第一个问题是人们如何首先找到这些页面，这是我可以处理的问题。这个论坛的问题是这是 WP 默认重写的错误，或者 paginate_links 函数是否应该更聪明地创建分页 URL？有没有人见过这个问题？

警告：不，我不能强制所有网站删除 .html，不，我没有能力为这个问题更改核心 WP 代码

# c# - 如何从文本文件中获取 url？

> ID：11905447
> 
> 赞同：0
> 
> 时间：2012-08-10T16:10:02.807
> 
> 标签：c#, winforms, url, webbrowser-control, filestream

我在文本文件中插入了一些网页 URL。

像：

```
www.google.com
www.facebook.com
www.twitter.com
www.yahoo.com 
```

我想在 c# webBrowse1 控件中浏览网页 URL 表单文本文件。

请告诉我它是如何工作的。

这是我的代码，但它不起作用。

```
try
{
    FileStream fs = new FileStream("link.txt",FileMode.Open,FileAccess.Read);
    StreamReader sr = new StreamReader(fs);
    webBrowser1.Navigate(sr);
    webBrowser1.ScriptErrorsSuppressed = true;
    while (webBrowser1.ReadyState != WebBrowserReadyState.Complete)
    {
        Application.DoEvents();
    }
}
catch(Exception)
{
     MessageBox.Show("Internet Connection not found", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
     this.Close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:17:02.073

好吧，我看到的主要问题是您正在尝试导航到流：

```
StreamReader sr = new StreamReader(fs);
webBrowser1.Navigate(sr); //<-- This doesn't make any sense! 
```

您可能想要做的是遍历文本文件并读取每一行：

```
foreach(string url in File.ReadLines("link.txt"))
{
   webBrowser1.Navigate(url);

   // Do stuff here with your webBrowser1 control
} 
```

这将遍历 link.txt 中的每一行并调用每一行`Navigate()`。我不太确定这是否是你想要的，所以请澄清这个问题是否还有更多。

# android-activity - Android 使用 onBackPressed() 避免 onDestroy()

> ID：11905452
> 
> 赞同：2
> 
> 时间：2012-08-10T16:10:17.913
> 
> 标签：android-activity

我正在尝试做一些应该很简单的事情。

我有一个游戏，它启动一个带有提供各种选项的屏幕的 StartActivity，其中一个是“开始游戏”。

当用户选择此选项时，游戏会以类似于以下的代码启动：

```
Intent i = new Intent();
i.setClass(context, GameActivity.class);
context.startActivity(i); 
```

这一切都很好。当在游戏中按下“返回”按钮时，控制返回到此 StartActivity。再说一次，这很好。

但是，按下“返回”会导致调用“onDestroy()”（根据文档）——这意味着当再次按下“开始游戏”时，GameActivity 从头开始​​。

我想要的是当按下“返回”时将 GameActivity 保存在内存中，以便按下“开始游戏”返回到它停止的位置。

这是几乎每个游戏都会做的事情，所以必须非常简单，但我不知道该怎么做。我一直在尝试以返回 StartActivity 的方式重载 onBackPressed()，但没有成功；做类似的事情：

```
public void onBackPressed() {
    Intent i = new Intent(this, StartActivity.class);
    startActivity(i);
} 
```

意味着堆栈永远增长，即 A -> B -> A 离开 ABA 而不仅仅是 A。

我知道一般活动流程（http://developer.android.com/reference/android/app/Activity.html）。

我是否以错误的方式启动 GameActivity？

#

作为对僚机的回应，我知道各种活动状态，如果需要释放内存，可能会调用 onDestroy()。我确实在 onPause() 上保存游戏状态并在 onResume() 上加载，但不是当时内存的完整状态。

如果我按“主页”，则应用程序实际上是“最小化”，并返回到重新启动时的位置 - 不会调用 onDestroy()。我试图模仿这种行为，但将应用程序返回到 StartActivity 而不是“home”。

据我所知，后退按钮总是调用 onDestroy() （或者至少是 finish() ）。

发生这种情况时，所有游戏都会保存完整状态吗？我会感到惊讶，但也许他们会。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:35:34.200

按下后退按钮时，没有 Activity 被完全销毁。Android 维护着一堆正在运行的活动。当用户按下后退按钮时，当前活动从堆栈中弹出，并显示前一个活动。但是弹出的活动没有被破坏，它仍然在内存中。它只会在系统内存不足时被销毁，然后`onDestroy()` 才会被调用。

在您的 Activity 由于用户按下返回而离开屏幕之前，android 会调用您的 Activity 的许多方法，您可以在其中保存其状态，并在用户再次导航到您的 Activity 时恢复它。在此处浏览 Activity 生命周期文档和示例：http: [//developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

`onPause()`因此，在或方法之一上保存您的游戏活动状态`onStopped()`，在主菜单上，如果用户选择“*恢复*”，则从保存的状态开始您的游戏活动，否则如果用户选择“*新游戏*”，则从头开始您的游戏活动.

# html - 使文本留在列表项中

> ID：11905453
> 
> 赞同：0
> 
> 时间：2012-08-10T16:10:26.213
> 
> 标签：html, css, zooming

在我正在制作的网站中，我设置了 ul。对于每个列表项，每个列表项中都有文本，但是当我放大和缩小页面时，文本开始出现。他们是一种将文本保留在列表项中的方法吗？

**HTML**

```
<div id="navigation">
                  <ul>
          <font face="Verdana, Geneva, sans-serif">
          <li> <a href="../index.html"> ƏSAS SƏHİFƏ  </a> </li>
          <li id="active-li"> <a href="#"> BIOQRAFIYA </a> </li>
          <li> <a href="../News&Events/N&SAz.html"> XƏBƏRLƏR VƏ HADISƏLƏR </a></li>
          <li> <a href="../Books/booksAZ.html"> KİTABLAR </a></li>
          <li> <a> VİDEOLAR </a> </li>
          <li> <a href="../Picutres/picutresAZ.html" id="last-item"> FOTOLAR </a> </li>
          </font>
        </ul>
            </div>
    </div> 
```

**CSS**

```
#navigation {
        width: 900px;
        margin: 0 auto 0px;
    }
    div#navigation ul li {
        font-size:.5em;
        list-style:none;
        background-color:transparent;
        background-color:#FFF;
        float: left;
        width:150px;
        height:40px;
        text-align:center;

    }
    div#navigation ul li:hover {
        background-color:#9C1A35;
    }
    div#navigation ul li a {
        color:#333333;
        text-decoration:none;
        display: block;
        padding:6px 0px 18px;
    }
    #navigation ul li a:hover {
        color:#fff;
    }
    ul {
        padding:0;
    }
    #active-li {
        background:#9C1A35 !important;
    }
    #active-li a {
        color:#fff !important;
    }
    #last-item {
     !important;
    }
    div#navigation ul li #active {
        background:#9C1A35 !important;
    }
    div#navigation ul li #active a {
        color:#fff;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:20:44.177

样式列表时要知道的最重要的事情：**不要样式列表！设计内容。**

重置列表。采用：

```
ul, li {margin:0;padding:0} 
```

然后：

使用 .将所有样式放在列表中的锚点上`display:block`。`float:left`您可以在您的上使用定位，例如`LI`，但将所有其他内容放在`A`-tag 上。

# java - 如何在 Swing 中使用 Thread.sleep() 和 setBackground() 创建 flash 效果？

> ID：11905456
> 
> 赞同：1
> 
> 时间：2012-08-10T16:10:40.147
> 
> 标签：java, swing, concurrency, jtextarea, event-dispatch-thread

我想通过以下方式制作闪光效果：将（JTextArea的）背景更改为红色->然后等待1秒->返回白色。我喜欢这样：

```
JTextArea jTextArea = new JTextArea();
jTextArea.setBackGround(Color.RED);
Thread.currentThread().sleep(1000);
jTextArea.setBackGround(Color.WHITE) 
```

但它不起作用，我所拥有的只是白色背景，我没有看到红色背景。

我错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:52:30.650

`Thread.sleep(...)`您应该使用[javax.swing.Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)而不是 using ，这会冻结您的 GUI 。此外，正如@MinhCatVO 所说，必须在 EDT 上完成对 GUI 的任何更新。有关该主题的更多信息，请参阅[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)。看看下面的代码并询问你无法理解的内容。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ColouringTextArea
{
    private JTextArea tarea;
    private Timer timer;
    private Color[] colours = {
                                Color.RED,
                                Color.BLUE,
                                Color.GREEN.darker(),
                                Color.DARK_GRAY,
                                Color.MAGENTA,
                                Color.YELLOW
                              };
    private int counter = 0;                          
    private ActionListener timerAction = new ActionListener()
    {
        public void actionPerformed(ActionEvent ae)
        {
            if (counter < colours.length)
            {
                tarea.setBackground(colours[counter]);
                counter++;
            }
            else
            {
                tarea.setBackground(Color.PINK);
                counter = 0;
            }   
        }
    };

    private void displayGUI()
    {
        JFrame frame = new JFrame("Colouring JTextArea");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        tarea = new JTextArea(10, 10);
        contentPane.add(tarea);

        frame.setContentPane(contentPane);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);

        timer = new Timer(1000, timerAction);
        timer.start();
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new ColouringTextArea().displayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:57:22.867

由于线程问题，这不起作用。你需要一个[工作线程](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)。

这应该有效：

```
 SwingWorker<Object, Object> sw = new SwingWorker<Object, Object>() {
                @Override
                protected Object doInBackground() throws Exception {
                    SwingUtilities.invokeLater(new Runnable() {
                        @Override
                        public void run() {
                            jTextArea.setBackground(Color.RED);
                        }
                    });
                    Thread.sleep(1000);
                    SwingUtilities.invokeLater(new Runnable() {
                        @Override
                        public void run() {
                            jTextArea.setBackground(Color.WHITE);
                        }
                    });
                    return null;
                }
            };

            sw.execute(); 
```

请注意，必须从 Event Dispatch Thread 调用 Swing 对象上的所有方法。为此，请使用以下模式：

```
 SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            // Do gui things
        }
    }); 
```

了解事件调度线程。SO中有很多关于此的帖子。只需搜索单词。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:42:18.173

因为你想睡 1 秒的线程不是 GUI 线程。我认为 Swing.Utilities 有一个方法 SwingUtilities.invokeLater()。

```
public void class Flash extends Thread {
  JTextArea jtextArea = new JTextArera();
  public void run() {
   SwingUtilities.invokeLater(new Runnable()) {
      jTextArea.setBackground(Color.WHITE);
   }
  }
}

public void class Main {
   public void main() {
      ...
      Flash fl = new Flash();
      fl.start();
   }
} 
```

# matlab - 从标量场创建矢量场

> ID：11905463
> 
> 赞同：0
> 
> 时间：2012-08-10T16:10:59.343
> 
> 标签：matlab

嗨，我有一个 n x n 矩阵 z，它表示向量场的 z 维中的标量值。IE

```
z = 1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1 
```

x 和 y 维度中的标量场值为 0。我的问题是如何获取 z 并形成矢量场。我试过类似的东西：

```
x = zeros(size(z));
y = x;
vecfield = [x(:) y(:) z(:)] 
```

我期待的地方：

```
vecfield(:,:1) = 

    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0 

 vecfield(:,:2) = 

    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0
    0 0 0 0 0 0 0 0 0 

 vecfield(:,:3) = 

    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1
    1 2 3 4 5 4 3 2 1 
```

但是我得到：

```
vecfield = 

    0 0 1
    0 0 2
    0 0 3
    0 0 4
    . . .
    . . . 
```

等等。我在哪里错了？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:18:22.017

试试这个

> vecfield = cat(3, x,y,z)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:26:43.407

无需创建`x`和`y`明确：

```
z = [1 2 3 4 5 4 3 2 1;
    1 2 3 4 5 4 3 2 1;
    1 2 3 4 5 4 3 2 1;
    1 2 3 4 5 4 3 2 1;
    1 2 3 4 5 4 3 2 1];

vecfield = z; % vecfield 5 x 9 (x 1)
vecfield(:,:,2:3) = 0; 
```

最后一个命令将 vecfield 动态扩展到第三维，将所有值设置为零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:28:54.030

问题是您试图创建 3 个单独的 n × n 矩阵并强制它们进入错误的维度。反而，

```
vecfield = zeros(size(z),length(z),3) %because you want three arrays in the z direction 
```

那么，vecfield(:,:,3) = z;

或者您正在尝试获取 Z 的标量值并将它们用作 vecfield 的 z 维度大小的指标。这是不可能的，因为尺寸设置不统一。但是，您仍然可以通过对 vecfield 中的单元格编号并将其他所有内容设为零来*表示该信息。*那么它看起来像......

vecfield(:,:,1)

1 2 3 2 1

1 2 3 2 1

1 2 3 2 1

然后， vecfield(:,:,2)

0 1 2 1 0

0 1 2 1 0

0 1 2 1 0

然后， vecfield(:,:,3)

0 0 1 0 0

0 0 1 0 0

0 0 1 0 0

ETC

我们可以做到这一点（它的想法，显然是使用你的 n × n 维度）。可能是这样的，

```
vecfield = zeros(size(z),length(z),max(max(z)));
for n  = 1 : size(vecfield,3)
     vecfield(:,:,n) = z(:,:)- n;
     vecfield((vecfield(:,:,n) < 0)==1) = 0;
end 
```

希望有帮助！

# android - 从主要活动访问在片段中创建的视图

> ID：11905468
> 
> 赞同：3
> 
> 时间：2012-08-10T16:11:21.327
> 
> 标签：android

我在片段中创建了一个视图

```
public static class GraphSectionFragment extends Fragment 
{
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) 
    {
        GraphView view = new GraphView(getActivity());
        view.setGraphType(GraphView.GraphType.Oscillator);          
        return view;
    }
} 
```

现在我需要从主要活动中访问我的 GraphView 对象。我如何能？我以这种方式尝试过，但它不起作用。

```
GraphSectionFragment fr = (GraphSectionFragment) m_SectionsPagerAdapter.getItem(0);
View v = fr.getView();
GraphView graph = (GraphView)v;
graph.setData(0, m_DeviceThread.getRangeDataI()); 
```

m_SectionsPagerAdapter 是从 FragmentPagerAdapter 继承的类的对象。Fragment.getView 返回一些奇怪类的视图，而不是 GraphView。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T04:21:05.220

您将在[此链接](https://stackoverflow.com/a/8545206/968526)中得到答案。根据您的实现，您可以通过任何一种方式从活动中访问片段。

要在扩展 FragmentActivity 的类中获取片段实例：

```
MyclassFragment instanceFragment= (MyclassFragment)getSupportFragmentManager().findFragmentById(R.id.idFragment); 
```

或者

要在扩展 Fragment 的类中获取片段实例：

```
MyclassFragment instanceFragment =
(MyclassFragment)getFragmentManager().findFragmentById(R.id.idFragment); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-10T16:50:50.870

您可以通过执行以下操作来检索您的活动：

```
(MyActivity)getActivity(); 
```

因此，如果您`GraphView`在类中设置为公共变量，您可以执行以下操作：

```
GraphView graph = ((MyActivity)getActivity()).myGraph; 
```

或设置访问器功能：

```
GraphView graph = ((MyActivity)getActivity()).getGraphView(); 
```

# three.js - 在 Three.JS 中手动控制对象（网格）的透视

> ID：11905469
> 
> 赞同：2
> 
> 时间：2012-08-10T16:11:26.350
> 
> 标签：three.js

我正在构建一个宇宙飞船游戏，并且在控制飞船的移动方式时遇到了一些问题。

我想在控制 x 和 y 位置的屏幕周围移动船（网格）。但不是自动计算透视，我想自己控制旋转属性。基本上总是保持一个平面网格，无论它在世界中的 x 和 y 位置，并覆盖它的视角。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:35:16.883

我意识到 '.lookAt(vector)' 解决了我的问题。见[http://mrdoob.github.com/three.js/examples/misc_lookat.html](http://mrdoob.github.com/three.js/examples/misc_lookat.html)

# python - Web2py - 显示与 id 不同的参考字段

> ID：11905471
> 
> 赞同：1
> 
> 时间：2012-08-10T16:11:31.550
> 
> 标签：python, web2py

在模型中使用此示例：

```
db.define_table('person', 
    Field('name'), 
    format='%(name)s')

db.define_table('dog',
    Field('name'),
    Field('owner'), db.person) 
```

控制器：

```
def list():
    dog_list = db().select(db.dog.ALL)
    return dict(dog_list=dog_list) 
```

看法：

```
{{for item in dog_list:}}
 ...
{{=item.name}} {{=item.owner}}
...
{{pass}} 
```

结果样本：

```
Dogname1 1
Dogname2 2
Dogname3 1 
```

如何在我的视图中显示所有者的姓名而不是他们的 ID？

我需要自己的表，我不能为此使用 SQLTABLE 或其他网格表解决方案......

提前致谢。

基督教

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T17:29:56.243

您可以通过进行[递归选择](http://web2py.com/books/default/chapter/29/6#Recursive-selects)`{{=item.owner.name}}`，但这将对每条记录进行单独的查询。为了提高效率，您可能想要进行[join](http://web2py.com/books/default/chapter/29/6#Inner-joins)。

# java - 文档/视图架构

> ID：11905474
> 
> 赞同：0
> 
> 时间：2012-08-10T16:11:52.037
> 
> 标签：java, netbeans-platform

我想实现一个基于 Netbeans 平台的应用程序，它处理数据（收集在文档中）并以不同的方式（在视图中）显示它们。

到目前为止，我已经创建了一个具有文件类型（名为 Document）和一个窗口的模块。在窗口中，我放置了一个 JPanel 并自定义了代码以将标准 JPanel 类替换为“DocumentVisualElement”类。但是实例化一个“DocumentVisualElement”需要一个 Lookup 实例。我试图用“Lookup.getDefault()”得到一个，但这会在“DocumentVisualElement”构造函数中触发一个错误：在 Lookup 中找不到“Doc​​umentDataObject”。

我错过了什么吗？有没有更好的方法来做我想做的事？

提前感谢您花时间帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T17:07:49.427

听起来您正在寻找的是[MultiView Windows](http://bits.netbeans.org/dev/javadoc/org-netbeans-core-multiview/overview-summary.html) - 相同的功能用于在 NetBeans 中显示 GUI 表单的不同视图（代码和表单视图）。

[文件类型集成教程](http://platform.netbeans.org/tutorials/nbm-filetype.html)可能是一个完美的选择，如果不是，那么只需阅读添加[多个 MultiView 段的部分](http://platform.netbeans.org/tutorials/nbm-filetype.html#multiview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:01:48.003

可以使用支持文档创建 JTextArea。

Java Swing 组件层次结构如下：

```
JPanel
    JScrollPane
        JTextArea 
```

# google-apps-script - Google Apps 脚本库中的 OAuth

> ID：11905481
> 
> 赞同：1
> 
> 时间：2012-08-10T16:11:59.447
> 
> 标签：google-apps-script

我正在 GAS 中为一些域管理 API 构建一些包装库。我有一个通用库，可以处理 OAuth、UrlFetch、XML 到对象和对象到 XML 函数。我已将此作为库添加到我的 API 包装器中。我创建的第一个是用于 EmailAuditAPI。当我将 EmailAuditAPI 作为库加载时，这工作得很好。我创建的第二个 API 包装器用于 GmailSettingsAPI。这个包装器本身工作得很好，但是当我从另一个脚本调用它时，它已经被加载为一个库。让你更直观

GoogleAPITools -> EmailAuditAPI Wrapper -> 项目脚本：有效！

GoogleAPITools -> GmailSettingsAPI Wrapper -> 项目脚本：不起作用！

GoogleAPITools -> GmailSettingsAPI 包装器：有效！

我认为这是重要的代码：

```
GoogleAPITools
function callGApi(apiUrl,authScope,method,payloadIn)
{  
  //oAuth & Fetch Arguments
  var fetchArgs = googleOAuth_("google", authScope);
  fetchArgs.method = method ? method : "GET";

  if(payloadIn)
  {
    fetchArgs.contentType = "application/atom+xml";
    fetchArgs.payload = payloadIn;
  }

  var urlFetch = UrlFetchApp.fetch(apiUrl, fetchArgs); //This line fails w/ not working wrapper
  var returnObject = urlFetch.getContentText() != '' ? Xml.parse(urlFetch.getContentText()) : urlFetch.getResponseCode();
  return returnObject;
}

//Google oAuth
function googleOAuth_(name,scope)
{
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey("anonymous");
  oAuthConfig.setConsumerSecret("anonymous");
  return {oAuthServiceName:name, oAuthUseToken:"always"};
} 
```

此包装器在作为库加载到第三个脚本时起作用。

```
function getAccountInfoRequest(user,reqId)
{
  var properties = GoogleAPITools.callGApi(ACCOUNTINFOURL + user + "/" + reqId,AUDITSCOPE).entry.property;
  return GoolgeAPITools.returnXmlToObject(properties);
} 
```

当作为库加载到第三个脚本中时，此包装器不起作用，但它确实可以自己工作。GoogleAPITools 在两个包装脚本中作为库加载。

```
GmailSettingsAPI Wrapper
//Get Signature
function getSignatureForUser(user)
{
  var returnedInfo = GoogleAPITools.callGApi(EMAILSETTINGSURL + user + "/signature",EMAILSETTINGSSCOPE);
  return GoolgeAPITools.returnXmlToObject(new Array(returnedInfo.entry.property));
} 
```

将两个包装器都加载为库的第三个项目脚本：

```
function testApiWrappers() {
  var user = "john";
  var reqId = "123456789";
  Logger.log(AuditApi.getAccountInfoRequest(user,reqId));
  Logger.log(GmailSettingsApi.getSignatureForUser(user)); //Fails here
} 
```

在我的日志中，我看到了 AuditApi 调用的返回，但我收到了一个“意外错误：”，它引用了 GoogleAPITools 脚本中的 URLFetch。

这两个 API 的 Oauth 有什么不同吗？我错过了我的代码中有什么明显的东西吗？任何帮助都会很棒。

# android - 检索适配器管理的片段的建议方法

> ID：11905483
> 
> 赞同：0
> 
> 时间：2012-08-10T16:12:08.217
> 
> 标签：android, android-fragments, fragmentpageradapter

我在 FragmentActivity 中有片段，它有一个 ActionBar 和 Tab 导航。我的问题是我想在 Fragment 上调用一个方法。我不能使用 findFragmentBy[Id|Tag]，因为片段是由适配器启动和附加的，它分配了一个自定义标签。我看到了几个基于保留对片段的引用的解决方案，但我真的想避免保留对我的片段的任何引用，因为它们是由 FragmentPagerAdapter 处理的。现在我的 Fragment 中包含所有内容（在我看来这是一种解决方法），但这个问题仍然困扰着我。

从我的活动中访问片段实例的最佳方法是什么，不是由我添加到 FragmentManager，而是 FragmentPagerAdapter？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:04:47.607

我通过编写自己的适配器解决了这个问题。由于它们非常简单，因此很容易实现。

# c++ - 为什么 ccache 不经常与 gcc 一起使用？

> ID：11905485
> 
> 赞同：6
> 
> 时间：2012-08-10T16:12:30.617
> 
> 标签：c++, ccache

我一直在想...

ccache 有一些限制吗？

如果后期编译时间的差异如此之大，为什么没有更多的 Linux 开发人员更频繁地使用 ccache？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T16:33:59.507

我想简单的答案是，`ccache`当构建系统被破坏时（即没有正确跟踪依赖项，并且要正确构建您可能需要的所有内容`make clean; make`），这很好。另一方面，如果正确跟踪依赖关系，则`ccache`不会比 plain 产生任何优势`make`，并且实际上会产生维护和更新缓存的成本（缓存的大小可能*很大*，具体取决于项目的大小）

# android - 如何在 TextView 中获取 ClickableSpan 的坐标？

> ID：11905486
> 
> 赞同：16
> 
> 时间：2012-08-10T16:12:35.637
> 
> 标签：android, textview, position, clickable

我有`TextView`很多`ClickableSpan`.

单击 a`ClickableSpan`时，我必须在其屏幕上获取坐标（以`View`在他的位置显示自定义）。

问题是我不知道如何做到这一点。的`onClick()`方法`ClickableSpan`在参数 a 中给了我`View`，`TextView`其中包含`ClickableSpan`.

我已使用以下内容获取字符位置`TextView`，但我不知道如何将其转换为获取文本屏幕上的 x/y 位置。

```
@Override
public void onClick(View v){

    SpannableString completeText = (SpannableString)((TextView) v).getText();
    Log.v("characters position", completeText.getSpanStart(this) + " / " + completeText.getSpanEnd(this));

} 
```

在此先感谢您的帮助！

编辑：我想获取 ClickableSpan 的整个坐标及其大小，目的是在文本的底部中心显示我的自定义视图。onTouch 方法会给我手指位置，而不是整个文本坐标。所以，用这个方法，我就不会有中间的文字了。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-13T12:33:59.073

我找到了解决方案 :-) 就是这样，这可能会帮助像我一样遇到同样问题的其他人！

```
// Initialize global value
this.parentTextViewRect = new Rect();

// Initialize values for the computing of clickedText position
SpannableString completeText = (SpannableString)(parentTextView).getText();
Layout textViewLayout = parentTextView.getLayout();

double startOffsetOfClickedText = completeText.getSpanStart(clickedText);
double endOffsetOfClickedText = completeText.getSpanEnd(clickedText);
double startXCoordinatesOfClickedText = textViewLayout.getPrimaryHorizontal((int)startOffsetOfClickedText);
double endXCoordinatesOfClickedText = textViewLayout.getPrimaryHorizontal((int)endOffsetOfClickedText);

// Get the rectangle of the clicked text
int currentLineStartOffset = textViewLayout.getLineForOffset((int)startOffsetOfClickedText);
int currentLineEndOffset = textViewLayout.getLineForOffset((int)endOffsetOfClickedText);
boolean keywordIsInMultiLine = currentLineStartOffset != currentLineEndOffset;
textViewLayout.getLineBounds(currentLineStartOffset, this.parentTextViewRect);

// Update the rectangle position to his real position on screen
int[] parentTextViewLocation = {0,0};
parentTextView.getLocationOnScreen(parentTextViewLocation);

double parentTextViewTopAndBottomOffset = (
    parentTextViewLocation[1] - 
    parentTextView.getScrollY() + 
    this.parentTextView.getCompoundPaddingTop()
);
this.parentTextViewRect.top += parentTextViewTopAndBottomOffset;
this.parentTextViewRect.bottom += parentTextViewTopAndBottomOffset;

// In the case of multi line text, we have to choose what rectangle take
if (keywordIsInMultiLine){

    int screenHeight = this.mWindowManager.getDefaultDisplay().getHeight();
    int dyTop = this.parentTextViewRect.top;
    int dyBottom = screenHeight - this.parentTextViewRect.bottom;
    boolean onTop = dyTop > dyBottom;

    if (onTop){
        endXCoordinatesOfClickedText = textViewLayout.getLineRight(currentLineStartOffset);
    }
    else{
        this.parentTextViewRect = new Rect();
        textViewLayout.getLineBounds(currentLineEndOffset, this.parentTextViewRect);
        this.parentTextViewRect.top += parentTextViewTopAndBottomOffset;
        this.parentTextViewRect.bottom += parentTextViewTopAndBottomOffset;
        startXCoordinatesOfClickedText = textViewLayout.getLineLeft(currentLineEndOffset);
    }

}

this.parentTextViewRect.left += (
    parentTextViewLocation[0] +
    startXCoordinatesOfClickedText + 
    this.parentTextView.getCompoundPaddingLeft() - 
    parentTextView.getScrollX()
);
this.parentTextViewRect.right = (int) (
    this.parentTextViewRect.left + 
    endXCoordinatesOfClickedText - 
    startXCoordinatesOfClickedText
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-17T14:37:34.770

试试这个：

**在 CustomSpannableString 类 onClick 函数内部**

```
@Override
public void onClick(View v){
    val textView = v as TextView
    val s = textView.text as Spanned
    val startCoordinates = s.getSpanStart(this)
    val endCoordinates = s.getSpanEnd(this)
    return  arrayOf(startCoordinates, endCoordinates)
} 
```

**不在 spannableString 类中**

```
val textView = findView...   // txtView which text is set to SpannableString
val s = textView.text as Spanned 
// CustomSpannableStringObj of type CustomSpannableString 
val startCoordinates = s.getSpanStart(CustomSpannableStringObj)
val endCoordinates = s.getSpanEnd(CustomSpannableStringObj) 
```

# jquery - jQuery 语法顺序

> ID：11905487
> 
> 赞同：2
> 
> 时间：2012-08-10T16:12:39.260
> 
> 标签：jquery

请原谅我，因为我仍然是 jQuery 的新手，而且我更喜欢使用其他代码而不是自己编写代码。我的问题与这条线有关，特别是：

```
$('r1.lastrow td.cell.c0').html(page).each(function(index, content) { 
```

html(page) 的语法顺序是否正确？你怎么讲？

```
$.get('---------------/learn/mod/lesson/report.php?id='+lesson+'&action=reportdetail&userid='+userid+'&try='+lastAttempt, success: function(data) {
        var page = $(data);

        var lessonArray= new Array();
        //loop through each element and grab the text

        $('tr.r1.lastrow td.cell.c0').html(page).each(function(index, content) {
            score=parseInt(content.substr(content.length - 1));
            lessonArray[index]=score;
        }); 

    allLessonsArray[name]=lessonArray;
    }); 
```

编辑：我遇到了另一个问题，这一次主要是因为我对 jQuery 没有经验。

```
userid= 17320;
courseid=4745;
allLessonsArray=script(userid, courseid);
function script(userid, courseid){

var lessonInTopicSectionArray= new Array();
lessonInTopicSectionArray['Floods, external']=376;

var allLessonsArray= new Array();
$.each(lessonInTopicSectionArray, function(name, lesson){

    lastAttempt = 0;
    url='----/learn/mod/lesson/report.php?id='+lesson+'&action=reportdetail&userid='+userid+'&try='+lastAttempt;
    $.get(url, function(data) {
        var page = $(data);

        var lessonArray= new Array();
        //loop through each element and grab the text

        $('tr.r1.lastrow td.cell.c0').html(page).each(function(index, content) {
            score=parseInt(content.substr(content.length - 1));
            lessonArray[index]=score;
        }); 
        alert(name);
    allLessonsArray[name]=lessonArray;  
    });
});
return allLessonsArray;
} 
```

如何从上一个循环中返回 allLessonsArray，以便可以返回 allLessonsArray？我没有彻底理解 jQuery 的面向对象方面，所以解释一下就好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:21:13.370

换个说法

```
var page = data; 
```

“数据”只是响应字符串，它不是 jQuery 对象。按照您向我们展示的逻辑，我看不到任何其他问题。

PS 其他答案对于最后的引用也是正确的，如果 URL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:50:30.443

如果我猜对了，你正在寻找这个

```
$.get('http://example.com/learn/mod/lesson/report.php?id=' + lesson + ' & action = reportdetail & userid = ' + userid + ' & try = ' + lastAttempt, function(data) {
    var page = $(data);

    var lessonArray = new Array();

    //loop through each element and grab the text
    page.find('tr.r1.lastrow td.cell.c0 ').each(function(index, content) {
        score = parseInt(content.substr(content.length - 1));
        lessonArray[index] = score;
    });

    allLessonsArray[name] = lessonArray;
});​ 
```

附言

~~我很想知道，里面有`r1`标签`HTML`吗？~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:20:13.687

删除 $.get url 参数末尾的最后一个引号？

```
$.get('http://example.com/learn/mod/lesson/report.php?id='+lesson+'&action=reportdetail&userid='+userid+'&try='+lastAttempt, success: function(data) {
    var page = $(data);

    var lessonArray= new Array();
    //loop through each element and grab the text

    $('r1.lastrow td.cell.c0').html(page).each(function(index, content) {
        score=parseInt(content.substr(content.length - 1));
        lessonArray[index]=score;
    }); 

    allLessonsArray[name]=lessonArray;
}); 
```

# python - Python字典键错误仅在一种特定情况下

> ID：11905495
> 
> 赞同：1
> 
> 时间：2012-08-10T16:12:53.753
> 
> 标签：python, dictionary

我有一个以矩阵样式存储列表列表的类，它可以像 [x,y] 一样被索引。

现在我有这些设置：

```
test_dict = {1:"cow",2:"horse"}

randommap = mapArray(None, (20,20)) 
```

随机地图只是充满了 1 的列表。所以任何索引都会返回 1。但这是我迷路的地方，可能是因为对字典的工作方式有误解：

```
test_dict[1] 
```

这显然会回馈“牛”和

```
randommap[1,1] #or any two x,y values up to 20 for that matter 
```

给我一个值1。

但这怎么给我一个关键错误：

```
test_dict[randommap[1,1]] 
```

孤立地，索引 randommap 给了我一个值 1，所以不应该将 1 作为 test_dict 的索引提供，从而返回我“牛”吗？

更新：这是我认为导致问题的两种方法。看起来他们返回的是字符串而不是整数，但我不知道我是否完全理解两者之间的区别。

```
def __str__(self):
    return str(self.mapdata)

def __repr__(self):
    return str(self.mapdata) 
```

这是重载的`__getitem__`方法：

```
def __getitem__(self, (x,y)):
    #Just reverses it so it works intuitively and the array is 
    # indexed simply like map[x,y] instead of map[y][x]
    return mapArray(self.mapdata[y][x]) 
```

抱歉，格式似乎有点混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:16:34.117

`1`（和整数）、`"1"`（字符串）和其方法在调用时`__repr__()`返回字符串的任何自定义类之间存在差异。`"1"`它们都将像`1`在控制台中一样打印，但不等同于 dict 查找。

您需要检查这`type(randommap[1, 1])`确实是一个`int`.

更新：您的`__getitem__`方法不返回整数，它返回您的`mapArray`类的新实例。你的意思是只返回值本身吗？例如：

```
def __getitem__(self, (x,y)):
    #Just reverses it so it works intuitively and the array is 
    # indexed simply like map[x,y] instead of map[y][x]
    return self.mapdata[y][x] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:57:15.413

鉴于更新的问题，似乎`__getitem__`返回了一个新的 mapArray。

我认为你的重载`__getitem__`应该是这样的

```
def __getitem__(self, (x,y)):
    return self.mapdata[y][x] 
```

相反，（假设 [y][x] 顺序是故意的）。

# php - 与数据库连接的 PHP 表单的代码

> ID：11905499
> 
> 赞同：-3
> 
> 时间：2012-08-10T16:13:30.303
> 
> 标签：php, mysql, sql, forms, syntax

我在为填充 MySQL 数据库的网站创建 PHP 表单时遇到问题。

这是我在以下 URL 收到的错误消息：[http://www.laboro.biz/employer.php](http://www.laboro.biz/employer.php)：

> 解析错误：语法错误，第 228 行 /hermes/bosoraweb013/b1108/ywh.tsarge83/laboro/employer-FormToEmail.php 中的意外 $end

另一个作为操作文件的文件是[http://www.laboro.biz/employer-FormToEmail.php](http://www.laboro.biz/employer-FormToEmail.php)。

我需要脚本方面的帮助才能完成这项工作。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:15:24.530

您在脚本的某处缺少大括号。

你缺少一个`{`或有一个`}`比`;`需要的多。再看一遍。

# java - 是否存在像 SynchronousQueue 这样的具有容量的实现？

> ID：11905504
> 
> 赞同：0
> 
> 时间：2012-08-10T16:13:57.857
> 
> 标签：java, multithreading, queue

在从 Socket 连接读取项目的 Java 应用程序中，我需要（出于此处未进一步概述的原因）

1.  要由单个线程处理的输入项，以便保留它们的顺序。
2.  在处理之前要缓冲的输入项，以便可以从套接字读取新项，而其他项仍在处理中。
3.  只要缓冲区已满，读取线程就会被阻塞

所以实际上我想使用一个工作线程来处理从套接字接收到的缓冲项目。以及一个合适的队列作为工作线程和读取线程之间的缓冲区，这将是一种`SynchronousQueue`具有 FIFO 容量的公平。

所需的队列应该表现得像一个`ArrayBlockingQueue`or `LinkedBlockingQueue`with capacity while not full 并且类似于一个`SynchronousQueue`when full 意思是

1.  `put`on queue 只会在队列已满时阻塞线程
2.  `take`on queue 只会在队列为空时阻塞线程
3.  `take`在一个完整的队列上将给调用者下一个 FIFO 元素并解除阻塞并插入来自下一个线程等待`put`操作的元素
4.  `put`在空队列上，要么将元素交给线程等待`poll`操作，要么将其插入

有没有这样的已知实现，还是我必须推出自己的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:15:39.387

一个答案不仅仅是试图从那些建议 ArrayBlockingQueue 的海报中窃取积分：

两个 ArrayBlockingQueue。一个充当“池队列” - 在启动时填充缓冲区对象。另一个用于处理线程等待工作。

套接字线程必须先从池中获取缓冲区，然后才能将其加载数据并将其排队到处理线程。处理线程在处理完数据后，最终必须将“使用过的”对象返回到池中。如果池为空，则套接字线程在其上阻塞，直到返回一些缓冲区。

这提供了与有界处理队列相同的流控制，但还有一个额外的优点是避免了缓冲区上的 GC。

# iphone - AVCaptureSession - 停止运行 - 需要很长时间

> ID：11905505
> 
> 赞同：3
> 
> 时间：2012-08-10T16:13:58.403
> 
> 标签：iphone, ios, zxing, avcapturesession

我将 ZXing 用于应用程序，这与 ZXing 原始代码主要是相同的代码，只是我允许连续扫描几次（即，一旦检测到某些东西，ZXingWidgetController 就不必立即关闭）。

当我按下呼叫的关闭按钮时，我经历了长时间的冻结（有时它永远不会结束）

```
- (void)cancelled {
  //  if (!self.isStatusBarHidden) {
  //      [[UIApplication sharedApplication] setStatusBarHidden:NO];
  //  }

    [self stopCapture];

    wasCancelled = YES;
    if (delegate != nil) {
        [delegate zxingControllerDidCancel:self];
    }

} 
```

和

```
- (void)stopCapture {
    decoding = NO;
#if HAS_AVFF

    if([captureSession isRunning])[captureSession stopRunning];
    AVCaptureInput* input = [captureSession.inputs objectAtIndex:0];
    [captureSession removeInput:input];
    AVCaptureVideoDataOutput* output = (AVCaptureVideoDataOutput*)[captureSession.outputs objectAtIndex:0];
    [captureSession removeOutput:output];
    [self.prevLayer removeFromSuperlayer];

    /*
     // heebee jeebees here ... is iOS still writing into the layer?
     if (self.prevLayer) {
     layer.session = nil;
     AVCaptureVideoPreviewLayer* layer = prevLayer;
     [self.prevLayer retain];
     dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 12000000000), dispatch_get_main_queue(), ^{
     [layer release];
     });
     }
     */

    self.prevLayer = nil;
    self.captureSession = nil;
#endif
} 
```

（请注意删除视图的dismissModalViewController在委托方法中）

仅当我连续进行多次扫描且仅在 iPhone 4 上（4S 不会冻结）时，我才会在解散时遇到冻结

任何的想法 ？

干杯

只读存储器

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-22T20:24:16.257

根据[AV Cam View Controller Example](http://developer.apple.com/library/ios/#samplecode/AVCam/Listings/Classes_AVCamViewController_m.html)调用 startRunning 或 stopRunning 在会话完成请求的操作之前不会返回。由于您将这些消息发送到主线程上的会话，因此它会冻结所有 UI，直到请求的操作完成。我建议您将调用包装在异步调度中，以便视图不会锁定。

```
- (void)cancelled 
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        [self stopCapture];
    });

   //You might want to think about putting the following in another method
   //and calling it when the stop capture method finishes
   wasCancelled = YES;
   if (delegate != nil) {
        [delegate zxingControllerDidCancel:self];
   }
} 
```

# regex - 正则表达式与。字符串解析

> ID：11905506
> 
> 赞同：43
> 
> 时间：2012-08-10T16:14:02.253
> 
> 标签：regex, string, performance, parsing, language-agnostic

冒着打开一罐蠕虫并获得反对票的风险，我发现自己需要问，

> **什么时候应该使用正则表达式，什么时候更适合使用字符串解析？**

我需要关于你的立场的**例子**和**推理。**我希望您在回答中解决诸如**可读性**、**可维护性**、可**扩展**性以及可能最重要的**性能**之类的问题。

[我在这里](https://stackoverflow.com/questions/357814/when-is-it-best-to-use-regular-expressions-over-basic-string-spliting-substrin)找到了另一个问题，它只有 1 个答案，甚至不屑于举个例子。我需要更多地理解这一点。

我目前正在使用 C++，但正则表达式几乎在每一种高级语言中都有，我也想知道不同的语言如何使用/处理正则表达式，但这更多是事后的想法。

感谢您帮助理解它！

编辑：我仍在寻找更多示例并就此进行讨论，但到目前为止的反应非常好。:)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-10T16:51:51.067

这取决于您正在处理的语言有多复杂。

# 分裂

这在工作时很棒，但只有在**没有转义约定**时才有效。例如，它不适用于 CSV，因为引号字符串中的逗号不是正确的分割点。

> 富，酒吧，巴兹

可以拆分，但是

> 富，“酒吧，巴兹”

不能。

# 常规的

正则表达式非常适合具有[“正则语法”](http://en.wikipedia.org/wiki/Regular_grammar)的简单语言。由于反向引用，Perl 5 正则表达式更强大一些，但一般的经验法则是：

> 如果您需要匹配括号 ( `(...)`, `[...]`) 或其他嵌套（如 HTML 标记），那么仅靠正则表达式是不够的。

您可以使用正则表达式将字符串分成**已知数量的块**——例如，从日期中提取月/日/年。但是，对于解析复杂的算术表达式，它们是错误的工作。

很显然，如果你写了一个正则表达式，走开喝杯咖啡，回来，并且不能轻易理解你刚刚写的东西，那么你应该寻找一种更清晰的方式来表达你正在做的事情。 [电子邮件地址](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)可能是使用正则表达式可以正确且可读地处理的极限。

# 上下文无关

解析器生成器和手动编码的下推/PEG 解析器非常适合处理需要处理**嵌套**的更复杂的输入，因此您可以构建**树**或处理[**运算符优先级**](http://en.wikipedia.org/wiki/Order_of_operations)或关联性。

上下文无关解析器通常使用正则表达式首先将输入分解为块（空格、标识符、标点符号、带引号的字符串），然后使用语法将该块流转换为树形。

CF 语法的经验法则是

> 如果正则表达式不充分，但语言中的所有单词都具有相同的含义，而不管先前的声明如何，那么 CF 就可以工作。

# 非上下文无关

如果您的语言中的单词会根据上下文改变含义，那么您需要一个更复杂的解决方案。这些几乎总是手工编码的解决方案。

例如，在 C 中，

```
#ifdef X
  typedef int foo
#endif

foo * bar 
```

if`foo`是一个类型，then是一个名为 的指针`foo * bar`的声明。否则，它是由名为 的变量命名的变量的乘法。`foo``bar``foo``bar`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-10T16:44:47.763

它应该是**正则表达式和字符串解析**..

您可以同时使用它们来发挥自己的优势！很多时候，程序员试图制作一个单一的正则表达式来解析文本，然后发现它很难维护..您应该在需要时使用它们。

正则表达式引擎速度很快**。**一个简单的匹配不到一微秒。但不推荐用于解析 HTML。

# html - 可变宽度容器中的截断文本

> ID：11905509
> 
> 赞同：3
> 
> 时间：2012-08-10T16:14:09.357
> 
> 标签：html, css

我想要一个两列的项目列表，其中右列具有固定宽度，左列由窗口大小确定，其文本被截断：

```
+----------------------+-----------+
|Variable width text...|Fixed width|
+----------------------+-----------+ 
```

我发现的所有关于如何在 HTML/CSS 中截断文本的示例都对截断的文本使用固定宽度，因此它们不适用于我的可变宽度情况。我通常以没有被截断的左侧文本结束，导致元素比它应该的更宽。

我会包含示例代码，但我尝试了很多不同的东西，我不知道发布哪种错误方法:)

这适用于桌面应用程序中的 WebView，因此我只需要它与最新的 WebKit 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:23:01.307

如果您真的想将文本截断，您可以执行以下操作：http: [//jsfiddle.net/fju9q/2/](http://jsfiddle.net/fju9q/2/)

其中使用 2`div`秒。右边`div`是浮动的，左边`div`使用`overflow: hidden`and`white-space: nowrap;`来确保文本被截断。

# python - 使用 Ruby/Python 实现远程命令行界面

> ID：11905510
> 
> 赞同：2
> 
> 时间：2012-08-10T16:14:10.573
> 
> 标签：python, ruby, linux, gitolite

是否有任何现有的库用于实现远程命令行界面？

例如

考虑 的情况 `gitolite`，当您执行 a 时`git push origin`，它会 ssh 进入远程服务器并执行一些代码（即`hooks`，整个事务不需要服务器。

我要存档的是类似的东西，例如

```
./remote get_up_time 
```

它将调用 ssh 到远程机器并执行`get_up_time`已部署的脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:37:30.530

ruby 标准发行版提供 DRb aka Distributed Ruby：

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/drb/rdoc/DRb.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/drb/rdoc/DRb.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T03:28:51.063

实现自己的脚本会很容易。

```
#!/bin/bash

ssh root@example.com "$1" 
```

然后你可以像这样打电话：

```
./remote.sh get_up_time 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T17:37:30.327

假设`ssh`已安装并且您的公钥在远程服务器上（因此，您不需要提供密码），这将是一个粗略的实现：

```
#!/usr/bin/env ruby

host = ARGV.shift
command = ARGV.join(' ')
IO.popen("ssh #{host} \"#{command}\"") do |io|
  io.sync = true
  io.readlines.each { |line| puts line }
end 
```

可用如：

```
$ ./remote.rb www.example.com ls -l 
```

您可以根据需要扩展它以提供额外的功能，例如从标准输入读取以提供`ssh`密码或其他内容。

尽管看起来“没有服务器”，但`sshd`远程系统上肯定有一个（远程服务器）运行，允许它工作。

如果您不想使用`ssh`，则需要使用在远程机器上运行的另一台服务器或自己编写。

# visual-studio-2010 - ClickOnce 2010 和创建桌面图标和开始菜单组

> ID：11905511
> 
> 赞同：0
> 
> 时间：2012-08-10T16:14:11.487
> 
> 标签：visual-studio-2010, windows-xp, clickonce

我们有一个通过 ClickOnce 分发的应用程序。用户群曾经在他们的机器上拥有超级用户权限，并且每次都会创建桌面图标和开始菜单组。

由于运营团队取消了高级用户权限，因此没有创建桌面图标和开始菜单组。

需要哪些机器权限才能在 Windows XP 中创建桌面图标和开始菜单组？

先感谢您，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T07:18:35.117

用户只需要能够读取和写入自己的配置文件，就能够创建桌面快捷方式和开始菜单组。

请注意，ClickOnce 不会执行任何需要管理权限的操作。

# c - 将 char* 转换为 int

> ID：11905517
> 
> 赞同：1
> 
> 时间：2012-08-10T16:14:30.603
> 
> 标签：c, pointers, casting, dereference

我正在编写一些代码来获取 c 中堆栈的十六进制转储。当我在 ubuntu 中使用 gcc 编译它时，我在以下行中不断收到编译错误，但是它在 windows 中的 gcc 下编译得很好。

```
char buffer[10];
for (int i=0;i<20;i++)
    printf("0x%lx => 0x%lx\n", &(buffer[i]), ((long *)buffer)[i]); 
```

这是编译器给出的信息。

> 警告：格式“%lx”需要类型“long unsigned int”，但参数 2 的类型为“char *”</p>

如果我做错了什么，有人可以告诉我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:15:48.050

您应该使用`%p`打印指针，并记住转换为`void *`.

```
printf("%p => ??\n", (void *)&(buffer[i]), ...); 
```

我不确定您要做什么，但是如果您尝试将一部分解释`buffer`为 long 并打印出来，那么您可以使用`%ld`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:19:35.540

尝试：

```
char buffer[10];
for (int i=0;i<20;i++)
    printf("%p => 0x%lx\n", (void*)&(buffer[i]), ((long *)buffer)[i]); 
```

第二个参数`&(buffer[i])`是 type `char*`，所以它需要一个 cast 和一个`%p`.

第三个参数 ,`((long *)buffer)[i]`的类型是`long`，所以它需要一个`%lx`.

* * *

*旁白*：请注意，如果`buffer`未`long`对齐，您可能会得到正确答案、错误答案或核心转储，这一切都取决于您的 CPU、操作系统、操作系统设置和/或编译器。

如果是*我*，我会尝试：

```
long l;
for(int i = 0; i < 20; i++)
    printf("%p => 0x%lx\n", (void*)(&l+i), *(&l+i)); 
```

# r - 在 R 中以日期作为列类预分配数据框

> ID：11905518
> 
> 赞同：4
> 
> 时间：2012-08-10T16:14:31.183
> 
> 标签：r

我想为 R 数据框中的日期预分配空间。

为了预先为字符和数字分配空间，我会写

```
MyDataframe <- data.frame(Name = character(10), 
                          Tickets  = numeric(10)) 
```

我会在为日期预先分配空间旁边添加什么？这不起作用...

```
# DOES NOT WORK
MyDataframe <- data.frame(Name = character(10), 
                          Tickets  = numeric(10)
                          Date = Date(10)) 
```

目前，我将列定义为数字，然后强制转换为日期，但这似乎不太理想。
谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T16:18:45.337

如果您要查找的只是一个包含 10 个日期的占位符列，则此方法有效：

```
as.Date(1:10, origin=Sys.Date()) 
```

你的问题是`character()`and`numeric()`函数有一个长度参数，但是 `as.Date`（因为没有`Date()`函数）没有 ( `?as.Date`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T17:37:35.430

这是我的最终代码。它运作良好。

```
MyDF <- data.frame(Name = character(10),
                   Tickets = numeric(10),
                   Date = as.Date(rep(0,10), origin = "1900-01-01")) 
```

这是输出：

```
> MyDF

   Name Tickets       Date
1             0 1900-01-01
2             0 1900-01-01
3             0 1900-01-01
4             0 1900-01-01
5             0 1900-01-01
6             0 1900-01-01
7             0 1900-01-01
8             0 1900-01-01
9             0 1900-01-01
10            0 1900-01-01 
```

和总结

```
> summary(MyDF)

 Name     Tickets       Date           
 :10   Min.   :0   Min.   :1900-01-01  
       1st Qu.:0   1st Qu.:1900-01-01  
       Median :0   Median :1900-01-01  
       Mean   :0   Mean   :1900-01-01  
       3rd Qu.:0   3rd Qu.:1900-01-01  
       Max.   :0   Max.   :1900-01-01 
```

谢谢你的帮助

# javascript - ASP.NET 设置用户后，从 JavaScript JSON 请求中的 Web 服务 (asmx) 获取 Windows Authenticated User.Identity.Name

> ID：11905524
> 
> 赞同：2
> 
> 时间：2012-08-10T16:15:13.603
> 
> 标签：javascript, asp.net, extjs, asmx, windows-authentication

如何在 ASP.NET Web 服务 (asmx) 中检索经过 Windows 身份验证的用户？这是我认为可行的，但“System.Web.UI.Page”不存在。然而，这在 aspx 页面后面的代码中确实有效，因为“System.Web.UI.Page”有一个值。请注意，我是从 ExtJS 代理读取请求中调用此 Web 方法的。它在 JavaScript 代码中请求一个 JSON 对象。

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json, UseHttpGet = false, XmlSerializeString = false)]
public string GetCurrentUserWindowsLogin()
{
    string windowsLogin = Page.User.Identity.Name;
    int hasDomain = windowsLogin.IndexOf(@"\");
    if (hasDomain > 0)
    {
        windowsLogin = windowsLogin.Remove(0, hasDomain + 1);
    }
    return windowsLogin;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T16:20:37.133

你可以像这样访问

```
HttpContext.Current.User.Identity.Name 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-10T16:20:42.267

```
HttpContext.Current.User.Identity.Name 
```

# c# - 从另一个动作返回一个动作不起作用？

> ID：11905525
> 
> 赞同：1
> 
> 时间：2012-08-10T16:15:14.983
> 
> 标签：c#, .net, asp.net-mvc, c#-4.0, asp.net-mvc-4

我正在尝试重载 MVC 操作，但由于“重载”不适用于路由操作（错误 500 表示方法不明确，我猜是因为无法从浏览器强类型化参数），所以我想我只会将一个操作返回给另一个操作因为我也不能将 RedirectToAction 用于 HttpPost。问题是它试图找到一个具有新操作名称的视图，而不是我试图调用的 aciton。这是我正在尝试做的事情：

```
 [HttpPost]
    public ActionResult DetailForProductID(int productID)
    {
        return Detail(new[] { GetProductById(productID) });
    }

    [HttpPost]
    public ActionResult Detail(IEnumerable<Product> products)
    {
       ....
       return View(productViewModel);
    } 
```

这是我得到的错误：

```
The view 'DetailForProductID' or its master was not found or no view engine supports the searched locations. The following locations were searched:
~/Views/Products/DetailForProductID.aspx
~/Views/Products/DetailForProductID.ascx
~/Views/Shared/DetailForProductID.aspx
~/Views/Shared/DetailForProductID.ascx
~/Views/Products/DetailForProductID.cshtml
~/Views/Products/DetailForProductID.vbhtml
~/Views/Shared/DetailForProductID.cshtml
~/Views/Shared/DetailForProductID.vbhtml 
```

处理这个问题的最健壮和优雅的方法是什么？我不想将内容存储在临时会话中或执行 RedirectToAction，因为我应该能够在服务器端完成所有操作。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:18:13.857

对于这样的重定向，我会推荐以下内容：

```
return RedirectToAction("Detail", data); 
```

但我不确定你为什么需要这个。看看你的行为，为什么不这样做呢？

```
public ActionResult Detail(int productId)
{
   var data = GetProductById(productID);
   ....
   return View(productViewModel);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:27:09.250

您还可以在这种情况下使用 Tempdata，例如：

```
public ActionResult DetailForProductID(int productID)
{
    IEnumerable<Product> data =   GetProductById(productID);
    TempData["ProductData"]= data;
    return RedirectToAction("Detail",data);        
}

public ActionResult Detail(IEnumerable<Product> products)
{
   ....
    if(TempData["ProductData"]!=null){
       IEnumerable<Product> data =  (IEnumerable<Product>)TempData["ProductData"];
       return View(data);
    }else {
       return View(products);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:47:23.313

我认为保持控制器“瘦”和“哑”很重要。一旦您超越了一个简单的网站并需要构建更复杂的东西，您就不想多次重写相同的代码（由于很多原因不好）。将控制器用作通用功能也将变得不可能（这基本上是您现在尝试做的事情）。

处理这个问题的更优雅和健壮的方法是抽象出你的应用程序逻辑并在其他地方执行它。然后，您可以根据操作的要求调用逻辑片段。要开始朝这个方向发展，您可以在每个控制器中编写控制器特定的逻辑，然后确定它们之间共享的功能并将其放置在项目的其他位置。在更复杂的项目中，控制器中根本没有应用程序逻辑并不罕见。

您可能想尝试创建一个通用函数，该函数可能通过 Id 返回“产品”，并将该函数放在其他地方。然后使用控制器判断具体逻辑，调用共享函数通过Id获取产品。

# java - 为什么我的 Java 字符串连接不起作用？

> ID：11905531
> 
> 赞同：2
> 
> 时间：2012-08-10T16:15:38.423
> 
> 标签：java, string, concat

当此代码运行时，它会获取网页的内容。

我想连接整个字符串而不是将其打印到控制台，但是当我取消注释下面代码中的两行时，`System.out.println(inputLine);`什么也不打印（但它与下面注释的行一起使用）和 value `fileText = null`，

这个错误来自哪里？

```
import java.net.*;
import java.io.*;

public class URLReader {

    public static void main(String[] args) throws Exception {

        URL oracle = new URL("http://www.oracle.com");
        BufferedReader in = new BufferedReader(
        new InputStreamReader(oracle.openStream()));

        String fileText = "";
        String inputLine;
        while ((inputLine = in.readLine()) != null)
            //fileText.concat(inputLine);
            System.out.println(inputLine);
        in.close();
        //System.out.println(fileText);
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-10T16:17:32.327

`String`是*不可变*的，并且[concat()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#concat%28java.lang.String%29)将返回一个新的`String`（检查链接的文档），您没有收集它。

您应该使用[StringBuilder](http://docs.oracle.com/javase/tutorial/java/data/buffers.html)有效地构建字符串，然后`toString()`在完成后调用它以获取结果字符串。

例如

```
StringBuilder sb = new StringBuilder();
while (....) {
   sb.append("more string data");
}
String str = sb.toString(); 
```

您*可以*附加`Strings`例如

```
 str = str + "more string data"; 
```

但它不是很有效，因为`String`. 构建A`StringBuilder`是为了有效地执行连接。如果您知道要构建`StringBuilder`的大小，则可以通过其初始容量来调整 a 。`String`

您可能会看到一些来源指的是`StringBuffer`. 这非常相似，除了它更旧并且默认同步其方法。在一个浪费的非线程环境中，一般建议是更喜欢`StringBuilder`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-10T16:17:59.297

`String`是不可变对象。您需要将连接的值重新分配给字符串对象。简单地调用`fileText.concat(inputLine);`不会改变`fileText`.

`fileText = fileText.concat(inputLine);`

简单地说，`fileText += inputLine;`也应该工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-10T16:17:41.423

[`String`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)是不可变的，所以仅仅调用`concat`a`String` **并不会**改变它：它返回一个`String`带有结果的 new。

您可以改为重新分配结果：`fileText = fileText.concat(inputLine);`，但由于您处于循环中，可能会进行大量连接，因此最好使用[`StringBuilder`](http://docs.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)来进行连接，并`String`从`StringBuilder`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-10T16:17:53.233

您好，您必须将 fileText.concat(String) 的返回值分配给一个变量。在你的情况下再次 fileText 。适合您的解决方案是：

```
fileText = fileText.concat(inputLine); 
```

进一步查看 Java API -> [http://docs.oracle.com/javase/6/docs/api/index.html?java/lang/String.html](http://docs.oracle.com/javase/6/docs/api/index.html?java/lang/String.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-10T16:18:33.060

`String`s 是不可变的。这意味着`fileText.concat(inputLine);`不会更改`fileText`. 相反，该`concat()`方法返回一个`String`带有预期数据的新方法。你需要捕获这个返回值来得到你想要的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-10T16:20:09.887

更改`fileText.concat(inputLine)`为`fileText = fileText.concat(inputLine)`.

另外，初始化`String inputLine = null;`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-10T16:21:38.000

你应该更好地使用`StringBuilder`它。就像是

```
StringBuilder sb = new StringBuilder();
while (...)
    sb.append(line); 
```

它比 s 的重复连接要有效得多`String`。

更简单的解决方案是使用[Apache Commons IO library](https://commons.apache.org/io/)，特别是[IOUtils.toString(InputStream,String)](https://commons.apache.org/io/apidocs/org/apache/commons/io/IOUtils.html#toString%28java.io.InputStream,%20java.lang.String%29)。

# extjs - Extjs 组合框 setValue

> ID：11905534
> 
> 赞同：1
> 
> 时间：2012-08-10T16:15:46.097
> 
> 标签：extjs

我有一个组合框（例如更改所有者）。当用户选择组合框的值时，如果他确定要更改所有者，我会提示用户。如果他点击“是”，我会更新数据库中的记录。到目前为止一切正常。

现在，如果用户选择一个值并在提示时单击“否”（从组合中选择值之后）。组合保留新值，不会将其恢复为旧值。我尝试了 setValue/Load 等，但没有人在单击 No 时设置回旧值。

我的代码看起来像这样

```
 combo = new Ext.form.ComboBox({
                        store: storeJson,
                        xtype: 'combo',
                        displayField:'name',
                        valueField: 'id',
                        mode: 'local',
                        id: 'privateTo',
                        name: 'privateTo',
                        typeAhead: false,
                        triggerAction: 'all',
                        lazyRender: true,
                        editable:false,
                        listeners: {select: changeOwner}
                    }); 

var changeOwner = function(combo, record, index) {              

            Ext.MessageBox.confirm("Change Owner","Are you sure you want to change owner?",function(btn){
            if (btn == "yes") {
                Ext.Ajax.request({
                   url: 'somUrl',
                   method: 'PATCH',
                   success: function(result, request) { 
                        msg('Owner changed', 'Owner changed');
                   },
                   failure: function(result, request) { 
                        Ext.MessageBox.alert('Error', "Unable to change owner");
                        Ext.getCmp("customizationGrid").getStore().reload();
                   }
                });
            } else {
                var d = Ext.getCmp('customizationGrid').getSelectionModel().selection;
                var rec = combo.store.getById(d.record.json.privateTo);
                Ext.getCmp("privateTo").setValue(rec.data.name);

            }
            });
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-07T06:52:41.613

只需删除`else { ... }`块，它应该照顾NO。 `:-)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T01:46:07.250

您的组合的最后一个选定值已经存在于选择处理程序中。

你可以简单地做：

...

```
} else {   
    combo.setValue(combo.startValue);
} 
```

# multithreading - SQLite SharedCache 多线程读取

> ID：11905537
> 
> 赞同：6
> 
> 时间：2012-08-10T16:15:59.187
> 
> 标签：multithreading, sqlite, shared-cache

我正在分配有 4 个处理器的 Ubuntu 虚拟机上开发一个多线程 sqlite 数据库应用程序。我正在使用 sqlite 版本 3.7.13。我创建了一个测试来验证多个线程/连接可以同时从数据库中读取。

我有两个可执行文件。第一个可执行文件只是创建一个数据库，在该数据库中创建一个表，将 50 个项目插入该表，然后关闭该数据库。这根本不涉及任何多线程，只是为了提供一个包含条目的数据库。

第二个可执行文件创建多个线程以从数据库中读取并等待它们完成并记录所有线程完成所花费的时间。每个线程执行以下操作： - 使用 sqlite_open_v2() 创建一个数据库连接，以便每个线程都有自己的到从第一个可执行文件创建的数据库的单独连接 - 在一个数据库表上执行 100000 SELECTS（每个选择查询table) - 关闭数据库连接

当我在每个线程中将 SQLITE_OPEN_READWRITE 指定为 sqlite_open_v2 的标志运行此测试时，我得到以下执行所有查询的总时间结果：

1 线程 - 0.65 秒 2 线程 - 0.70 秒 3 线程 - 0.76 秒 4 线程 - 0.91 秒 5 线程 - 1.10 秒 6 线程 - 1.28 秒 7 线程 - 1.57 秒 8 线程 - 1.78 秒

这些结果与我预期的一样，因为当我添加线程时，时间稍微增加了一点（可能是由于线程之间的上下文切换和其他原因），这意味着读取基本上是并行完成的。

但是，当我使用 SQLITE_OPEN_READWRITE | 运行相同的测试时 标志的 SQLITE_OPEN_SHAREDCACHE，我得到以下结果：

1 线程 - 0.67 秒 2 线程 - 2.43 秒 3 线程 - 4.81 秒 4 线程 - 6.60 秒 5 线程 - 8.03 秒 6 线程 - 9.41 秒 7 线程 - 11.17 秒 8 线程 - 12.79 秒

从这些结果看来，共享缓存模式中的某些东西正在阻止数据库中同时发生多个读取。我已经验证了线程并行运行确实不同（线程 4 读取、线程 8 读取、线程 2 读取等，而不是线程 1 执行所有读取，线程 2 执行所有读取，线程 3 执行所有读取， ETC。）。但是，似乎每个单独事务的读取都是以串行方式完成的，或者其他事情正在减慢共享缓存中的数据库。

为什么当我在共享缓存模式下添加线程而不是没有它时，我会看到如此高的时间增加？有没有办法解决这个问题并仍然使用共享缓存模式？

谢谢你的帮助。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-15T14:27:50.207

目前，我只能说在`shared cache mode`每个线程中`read mutex lock()`对每个请求进行多次附加（锁定共享缓存、锁定主表、锁定请求表）。当然，它有一些开销。

为了避免这种情况，您可以使用`PRAGMA read_uncommitted = true;`，但是如果另一个数据库连接在读取表时修改了表，这可能会导致查询结果不一致，但这也意味着读取未提交模式下的连接打开的读取事务既不能阻塞也不能被任何其他连接阻止。

（你能提供你的代码吗？）

# c# - 有多个帐户时使用 PasswordRecovery 发送电子邮件

> ID：11905538
> 
> 赞同：2
> 
> 时间：2012-08-10T16:16:04.497
> 
> 标签：c#, asp.net-membership, password-recovery

我正在使用 PasswordRecovery Control，当有多个帐户使用同一个电子邮件时，我不能发送超过一封电子邮件。我通过 Membership.FindUsersByEmail 获得 MembershipUserCollection。然后我在 foreach 中循环遍历它。我的问题是，如果有多个用户，它只会发送最后一封电子邮件。当它循环通过时，我怎样才能让它为每个帐户发送一封电子邮件？delagate 被称为正确的次数。另外，我知道他们都去同一个电子邮件，但希望为每个帐户发送一个。

代码片段：

```
protected void PasswordRecovery1_SendingMail(object sender, MailMessageEventArgs e)
{

}

bool IsValidEmail(string strIn)
{
    // Return true if strIn is in valid e-mail format.
    return Regex.IsMatch(strIn, @"^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$");
}

protected void PasswordRecovery1_VerifyingUser(object sender, LoginCancelEventArgs e)
{
    if (IsValidEmail(PasswordRecovery1.UserName))
    {
        // string uName = Membership.GetUserNameByEmail(PasswordRecovery1.UserName) ?? PasswordRecovery1.UserName;
        MembershipUserCollection users = Membership.FindUsersByEmail(PasswordRecovery1.UserName);
        if (users.Count < 1)
        {
            PasswordRecovery1.UserName = " ";
            PasswordRecovery1.UserNameFailureText = "That user is not available"; }
        else
        {
            foreach (MembershipUser user in users)
            {

                PasswordRecovery1.UserName = user.UserName;
                PasswordRecovery1.SendingMail += PasswordRecovery1_SendingMail;
                PasswordRecovery1.SuccessTemplateContainer.Visible = true;

            }

        }
    }
    else
    { 
        PasswordRecovery1.UserName = " ";
        PasswordRecovery1.UserNameFailureText ="Please enter a valid e-mail";           
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:05:25.863

想通了......我最初的做法是行不通的，所以我选择了半定制。我在提交按钮上添加了一个事件处理程序并编辑了代码，如下所示。如您所见，我只是循环浏览了整个集合。我敢肯定，这不是最好的，但它有效且易于理解。

电子邮件的正文以 html 格式在 txt 文件中创建。使用**mailDefinition**类允许我有替换字符串，这简化了电子邮件正文的创建。

它将每个帐户的单独电子邮件发送到同一电子邮件。我本可以将它们全部放在一封电子邮件中，但这就是他们想要的......

```
protected void PasswordRecovery1_SendingMail(object sender, MailMessageEventArgs e)
{
    e.Cancel = true;
}

bool IsValidEmail(string strIn)
{
    // Return true if strIn is a valid e-mail
    return Regex.IsMatch(strIn, @"^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$");
}

protected void SubmitLinkButton_Click(object sender, EventArgs e)
{
    if (IsValidEmail(PasswordRecovery1.UserName))
    {
        // Get user collection by shared email
        MembershipUserCollection users = Membership.FindUsersByEmail(PasswordRecovery1.UserName);
        if (users.Count < 1)
        {
            PasswordRecovery1.UserName = " ";
            PasswordRecovery1.UserNameFailureText = "That user is not available";
        }
        else
        {
            // Loop and email each user in collection
            foreach (MembershipUser user in users)
            {
                MembershipUser ur = Membership.GetUser(user.UserName);

                DateTime now = DateTime.Now;

                // Using MailDefinition instead of MailMessage so we can substitue strings
                MailDefinition md = new MailDefinition();

                // list of strings in password.txt file to be replace
                ListDictionary replacements = new ListDictionary();
                replacements.Add("<%UserName%>", ur.UserName);
                replacements.Add("<%Password%>", ur.GetPassword());

                // Text file that is in html format
                md.BodyFileName = "absolute path to password.txt";
                md.IsBodyHtml = true;
                md.Priority = MailPriority.High;
                md.Subject = "Email Subject Line - " + now.ToString("MM/dd - h:mm tt");
                md.From = ConfigurationManager.AppSettings["FromEmailAddress"];

                // Add MailDefinition to the MailMessage
                MailMessage mailMessage = md.CreateMailMessage(ur.Email, replacements, this);
                mailMessage.From = new MailAddress(ConfigurationManager.AppSettings["FromEmailAddress"], "Friendly Name");
                SmtpClient m = new SmtpClient();
                m.Host = "127.0.0.1";
                m.Send(mailMessage);

                PasswordRecovery1.UserName = user.UserName;

                PasswordRecovery1.SendingMail += PasswordRecovery1_SendingMail;
            }

        }
    }
    else
    {
        PasswordRecovery1.UserName = " ";
        PasswordRecovery1.UserNameFailureText = "Please enter a valid e-mail";
    }
} 
```

# c# - 对可能未初始化的 Dictionary 元素执行加号等于操作的简洁方法

> ID：11905539
> 
> 赞同：6
> 
> 时间：2012-08-10T16:16:05.870
> 
> 标签：c#, .net-4.0, dictionary, extension-methods

我正在寻找一种扩展方法或任何其他可以帮助我使此代码尽可能简洁的建议。

```
foreach( Layer lyr in this.ProgramLayers )
  foreach( UWBCEvent evt in this.BcEvents.IncludedEvents )
    EventGroupLayerLosses[new EventGroupIDLayerTuple(evt.EventGroupID, lyr)] += 
       GetEL(evt.AsIfs, lyr.LimitInMillions, lyr.AttachmentInMillions); 
```

上面的代码有一个相当明确的目的，我用复合键将值分组。但是，此代码将失败，因为字典最初是空的，并且 += 运算符不知道从 0 开始存储桶。

我能想到的最好的是：

```
public V AddOrSet<K, V>(this Dictionary<K, V> dict, K key, V value)
{
    if( dict.ContainsKey(key) )
        dict[key] += value;
    else
        dict[key] = value;
} 
```

但是当然，即使这样也不会编译，因为没有办法限制 V 的类型以使运算符`+=`存在。

**规则**

*   只有一次迭代通过双 for 循环。之前不允许循环一次以使用 0 值初始化字典。
*   可以使用辅助方法或扩展方法，但我希望内循环是单线。
*   尽可能通用和可重用，这样我就不需要为具有不同类型（小数、整数等）的类似分桶创建一堆相同的函数。

* * *

供参考 - 在类的其他地方，键被定义为实际的元组（仅带有命名参数），这就是它可以用作字典键的原因：

```
private Dictionary<EventGroupIDLayerTuple, Decimal> _EventGroupLayerLosses;
public class EventGroupIDLayerTuple : Tuple<Int32, Layer>
{
    public EventGroupIDLayerTuple(Int32 EventGroupID, Layer Layer) : base(EventGroupID, Layer) { }
    public Int32 EventGroupID { get { return this.Item1; } }
    public Layer Layer { get { return this.Item2; } }
} 
```

* * *

**解决方案**

感谢 Jon Skeet 提出将 Lambda 函数作为第三个参数传递给我的扩展方法的想法。甚至不再需要将其限制为 += 操作。如果值已经存在，则可以传递任何操作来设置新值，这是足够通用的。

```
//Sets dictionary value using the provided value. If a value already exists, 
//uses the lambda function provided to compute the new value.
public static void UpdateOrSet<K, V>(this Dictionary<K, V> dict, K key, V value, Func<V, V, V> operation)
{
    V currentValue;
    if( dict.TryGetValue(key, out currentValue) )
        dict[key] = operation(currentValue, value);
    else
        dict[key] = value;
} 
```

例子：

```
mySums.UpdateOrSet("Bucket1", 12, (x, y) => x + y);
myStrs.UpdateOrSet("Animals", "Dog", (x, y) => x + ", " + y);
myLists.UpdateOrSet("Animals", (List<T>) Dogs, (x, y) => x.AddRange(y)); 
```

无尽的乐趣！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T16:21:58.913

首先，我建议不要尽一切可能以降低可读性为代价使内容尽可能短。例如，我会在`foreach`正文周围添加大括号，如果一个更具可读性的解决方案最终变成两行而不是一行，我会很高兴的。

其次，我将假设对于您感兴趣的任何类型，默认值都是自然零。

现在，您可以编写：

```
public static void AddOrSet<K, V>(this Dictionary<K, V> dict,
                                  K key, V value, Func<V, V, V> addition)
{
    V existing;
    dict.TryGetValue(key, out existing);
    dict[key] = addition(existing, value);
} 
```

然后你可以使用：

```
EventGroupLayerLosses.AddOrSet(new EventGroupIDLayerTuple(evt.EventGroupID, lyr),
    GetEL(evt.AsIfs, lyr.LimitInMillions, lyr.AttachmentInMillions),
    (x, y) => x + y); 
```

使用`ConcurrentDictionary`也会很好。

此外，如果可以的话，我会尝试将其重新设计为 LINQ 查询。`GroupBy`如果混合使用,`Sum`并`ToDictionary`允许您以声明方式表达整个事情，我不会感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:21:13.733

.NET 4 有一种新型的字典类，`ConcurrentDictionary<TKey, TValue>`. 这个类有一个非常有用的`AddOrUpdate`方法（有一些重载），它展示了你正在寻找的行为。

[ConcurrentDictionary 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/dd287191.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:23:14.507

我们可以在这里使用空合并吗？

```
foreach( Layer lyr in this.ProgramLayers )
   foreach( UWBCEvent evt in this.BcEvents.IncludedEvents )
    EventGroupLayerLosses[new EventGroupIDLayerTuple(evt.EventGroupID, lyr)] = (EventGroupLayerLosses[new EventGroupIDLayerTuple(evt.EventGroupID, lyr)] ?? 0) + 
   GetEL(evt.AsIfs, lyr.LimitInMillions, lyr.AttachmentInMillions); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T16:33:56.583

你可以尝试这样的事情。

```
private void AddOrUpdate<K, V>(this Dictionary<K, V> dict, K key, Func<V> newValue, Func<V, V> updateValue) 
{ 
    V value;

    if( !dict.TryGetValue(key, out value) ) 
        value = newValue();
    else 
        value = updateValue(value); 

    dict[key] = value; 
} 
```

# classification - 在 mallet 中训练分类器

> ID：11905551
> 
> 赞同：3
> 
> 时间：2012-08-10T16:17:13.697
> 
> 标签：classification, mallet

我有一个具有以下格式产品名称的 csv 文件，
产品评论

现在使用槌我必须训练分类器，以便如果将测试数据集作为包含产品评论的输入，它应该告诉我特定评论属于哪个产品

mallet java api帮助将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T14:41:23.500

这是一个适合您的情况的小示例：

```
 public static void main(String[] args) throws IOException {
        //prepare instance transformation pipeline
        ArrayList<Pipe> pipes = new ArrayList<Pipe>();
        pipes.add(new Target2Label());
        pipes.add(new CharSequence2TokenSequence());
        pipes.add(new TokenSequence2FeatureSequence());
        pipes.add(new FeatureSequence2FeatureVector());
        SerialPipes pipe = new SerialPipes(pipes);

        //prepare training instances
        InstanceList trainingInstanceList = new InstanceList(pipe);
        trainingInstanceList.addThruPipe(new CsvIterator(new FileReader("datasets/training.txt"), "(.*),(.*)", 2, 1, -1));

        //prepare test instances
        InstanceList testingInstanceList = new InstanceList(pipe);        
        testingInstanceList.addThruPipe(new CsvIterator(new FileReader("datasets/testing.txt"), "(.*),(.*)", 2, 1, -1));

        ClassifierTrainer trainer = new NaiveBayesTrainer();
        Classifier classifier = trainer.train(trainingInstanceList);
        System.out.println("Accuracy: " + classifier.getAccuracy(testingInstanceList));
   } 
```

# c# - 如何解决此 Kinect 错误：将 AssemblyVersion 属性添加到“Microsoft.Kinect.Toolkit.dll”

> ID：11905554
> 
> 赞同：2
> 
> 时间：2012-08-10T16:17:24.370
> 
> 标签：c#, kinect

我正在使用 Microsoft 的 Kinect SDK（1.5 版）开发应用程序，但代码会生成一条警告消息：

> CA1016：Microsoft.Design：将 AssemblyVersion 属性添加到“Microsoft.Kinect.Toolkit.dll”。

我如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:47:35.093

这不是一个重要的错误。[程序集版本](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374234(v=vs.85).aspx)就是您的软件的版本。您可以轻松解决此问题。

> 只需转到您的项目 -> 属性 -> 应用程序 -> 装配信息，您将看到一个像这样的框

![关联](../Images/ca36e2a7f9130e3f28001a06da826704.png)

![链接2](../Images/3a5195f2966240fe46c1f59ff928f7b1.png)

只需更改程序集版本，保存就可以了。希望这可以帮助！

*注意：您可能想了解[AssemblyVersion、AssemblyFileVersion 和 AssemblyInformationalVersion 之间有什么区别？](https://stackoverflow.com/questions/64602/what-are-differences-between-assemblyversion-assemblyfileversion-and-assemblyin)更多细节*

# sql-server - 在 SQL Server 上设计数据库

> ID：11905555
> 
> 赞同：0
> 
> 时间：2012-08-10T16:17:23.793
> 
> 标签：sql-server, database-design

我想问是否可以使用 SQL Server 设计数据库？是否有任何外部工具需要与 SQL Server 一起使用或者可以自己完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:19:30.203

除非我完全不明白你在问什么。您可以使用[SQL Server Management Studio](http://msdn.microsoft.com/en-us/library/ms174173.aspx)来设计数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:04:13.210

我会更加强调数据库设计的长期影响，必须随着时间的推移维护设计。我会寻找一种工具，可以将应该在实时系统上的模式与真正在实时系统上的模式进行比较（通常，在公司环境中，它们永远不会相同）。也许像[Altova DatabaseSpy](http://www.altova.com/databasespy.html)这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:13:13.290

你需要一个像 DBDesigner 这样的工具。看看 > [http://www.fabforce.net/dbdesigner4/screenshots.php](http://www.fabforce.net/dbdesigner4/screenshots.php)

# php - mongodb 的教义2 odm 没有保存克隆的嵌套对象

> ID：11905557
> 
> 赞同：0
> 
> 时间：2012-08-10T16:17:28.097
> 
> 标签：php, mongodb, doctrine-orm

所以我有一所学校，每所学校都有多个上课时间表，每个时间表都有详细信息：

```
school (document)
-- bell schedule (embedded document)
---- bell schedule details (embedded document) 
```

当我克隆学校对象并打印学校时，它会在克隆中返回正确的对象。但是，当我尝试坚持学校时，它没有正确保存详细信息。我需要做些什么才能使其正常工作吗？我需要设置一个标志吗？

我想做的是：

```
$school2 = clone $school1;
$dm->persist($school2);
$dm->flush();

---- classes ----

    /**
     * @MongoDB\Document(collection="schools")
     */
    class School
    {   
        /**
         * @MongoDB\EmbedMany
         */
        protected $bell_schedules = array();

        public function addBellSchedules(BellSchedule $bellSchedules)
        {
            $this->bell_schedules[] = $bellSchedules;
        }

        public function getBellSchedules()
        {
            return $this->bell_schedules;
        }

        public function setBellSchedules(\Doctrine\Common\Collections\ArrayCollection $bell_schedules)
        {
            $this->bell_schedules = $bell_schedules;
            return $this;
        }
    }

    /**
     * @MongoDB\EmbeddedDocument
     */
    class BellSchedule
    {
        /**
         * @MongoDB\EmbedMany
         */
        private $bell_schedule_details

        public function getBellScheduleDetails()
        {
            return $this->bell_schedule_details;
        }

        public function setBellScheduleDetails(\Doctrine\Common\Collections\ArrayCollection $bell_schedule_details)
        {
            $this->bell_schedule_details = $bell_schedule_details;
            return $this;
        }
    }

    /**
     * @MongoDB\EmbeddedDocument
     */
    class BellScheduleDetail
    {    
        private $period;
        private $label;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T14:48:01.267

您的`@EmbedMany`注释缺少`targetDocument`属性，该属性应对应于嵌入对象的类名。有关详细信息，请参阅[注释参考](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/annotations-reference.html#embedmany)。此外，您缺少 BellScheduleDetail 类的字段映射。您可能希望对这些字段使用[@String](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/annotations-reference.html#string)。

最后，我建议将您的 EmbedMany 和 ReferenceMany 字段初始化为 ArrayCollection 实例而不是空数组。这样，您始终可以期望该属性是 Collection 实现（ArrayCollection 或 PersistentCollection）。在您的情况下（使用运算符）可能没有太大区别`[]`，但如果您发现自己在属性上执行其他数组操作，它会派上用场。

# android - 如何从 hackbook for Android 创建对话框，如 apprequest 对话框

> ID：11905558
> 
> 赞同：0
> 
> 时间：2012-08-10T16:17:28.563
> 
> 标签：android, dialog, facebook-app-requests

我正在尝试创建一个包含大量资源的自定义对话框，例如来自 hackbook for android 的 apprequest 对话框。

没有类似的@ [http://developer.android.com/guide/topics/ui/dialogs.html](http://developer.android.com/guide/topics/ui/dialogs.html)。有人知道怎么做吗？

提前 Tnx

![在此处输入图像描述](../Images/f3aeb5ad434374f05dbdfa152eb86ae9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:47:04.200

要创建一个像我们在 SDK 中那样的自定义对话框，它只是一个自定义类扩展`Dialog`，您可以在[Android 文档](http://developer.android.com/reference/android/app/Dialog.html)中阅读。

Facebook 的 Android SDK 在 github 上开源，[该文件](https://github.com/facebook/facebook-android-sdk/blob/master/facebook/src/com/facebook/android/FbDialog.java)向您展示了我们如何为我们的目的生成自定义对话框。如果您仔细研究源代码，您会发现我们实际上是`WebView`在为对话框中的内容加载`setContentView()`. 让我知道这是否有帮助！

-杰西

# asp.net - 如何在 IIS 上限制/验证文件上传文件类型服务器端

> ID：11905561
> 
> 赞同：6
> 
> 时间：2012-08-10T16:17:34.227
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, iis, file-upload

我想要一个用户有权上传到我的 IIS 服务器的文件类型白名单（我使用 IIS v7.5）。

我有什么选择？例如，为了在我的控制器中将特定操作的文件大小限制为 5MB，我将此部分添加到我的 webconfig 中：

```
<location path="home/fileupload">
  <system.web>
    <!-- maxRequestLength is in kilobytes (KB) -->
    <httpRuntime maxRequestLength="5120" /> <!-- 5MB -->
  </system.web>
  <system.webServer>
    <security>
      <requestFiltering>
        <!-- maxAllowedContentLength is in bytes -->
        <requestLimits maxAllowedContentLength="5242880"/> <!-- 5MB -->
      </requestFiltering>
    </security>
  </system.webServer>
</location> 
```

webconfig 中是否有设置允许文件类型白名单的选项？还是唯一的选择是在文件完全上传时验证代码中的文件类型？推荐的技术是什么？我如何确定 .docx、.pdf、.jpg 等文件确实是它们的样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T05:55:50.853

由于您想要服务器端，您可以使用文件 mime 类型。

[这篇](https://stackoverflow.com/questions/58510/using-net-how-can-you-find-the-mime-type-of-a-file-based-on-the-file-signature)文章展示了如何根据文件内容（而不是扩展名）确定 MIME 类型。

如果您确实想将输入限制为特定文件扩展名，您可以简单地检查输入名称与您想要接受的名称。如果通过了，您可以在我链接的帖子中对库进行外部参照，以确保用户不只是更改您的文件扩展名。

这样做可以很好地确定该文件是您想要接受的文件！

编辑：根据到目前为止的评论....根据您所说的，您正在寻找这种方法应该非常适合您。如果您只是想将其限制为其中一个评论中列出的文件类型，我的建议是...对文件扩展名进行简单检查。如果这是有效的，则将文件传递给`urlmon.dll`链接中列出的文件。确保它不会作为无效类型返回....aka Executable/java/zip/etc。如果它不是无效类型，那么您将非常确定它是一个安全文件！

最后，通读那篇文章的评论，它看起来`urlmon.dll`可能支持你想要的所有文件类型，这将消除检查它是否不是可执行文件或类似性质的东西的需要，但你需要确认doc/docx/xsl/xslx 确实返回一个有效的 mime 类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T02:15:15.587

不，没有 web.config 设置来限制上传的内容。验证上传数据的唯一可能方法是在代码中实际验证该数据。

即使有一个设置，它也是无用的，因为它将基于从客户端接收到的 Content-Type 标头，这可能是非常错误的。

在代码中，您当然可以查看 Content-Type 标头，但如果您尝试验证上传的数据是否属于特定类型，则必须根据您的数据类型手动执行此操作期待。对于图像，这很容易。对于其他文件类型，这可能要困难得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T18:16:29.410

Data Annotations 是您正在寻找的东西，这里有一个可能对您有帮助的搜索，[google data anotaions](https://www.google.com/search?q=Data%20Annotations&sugexp=chrome,mod=5&sourceid=chrome&ie=UTF-8#hl=en&sclient=psy-ab&q=file%20type%20validation%20Data%20Annotations&oq=file%20type%20validation%20Data%20Annotations&gs_l=serp.3...13344.18702.0.18943.23.22.1.0.0.5.168.2918.0j22.22.0...0.0...1c.BwU-sMkJmNI&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&fp=3a6888fda550e1a0&biw=1156&bih=890)

**更新**

我认为它验证了文件扩展名。如果您不想依赖`file extensions`，我认为您最好的选择是验证[MIME 类型](http://www.webmaster-toolkit.com/mime-types.shtml)。这更复杂，并且因浏览器而异，并且可以伪造（尽管这比伪造扩展更复杂。）

一个简单但不是免费的选项是使用[Telerik RadAsyncUpload](http://demos.telerik.com/aspnet-ajax/asyncupload/examples/overview/defaultcs.aspx?product=asyncupload)。

你可以自己编写这段代码（虽然我从来没有搞砸过），[这](http://forums.asp.net/p/1230087/2217745.aspx)可能会让你开始。（这篇文章讨论了没有 IIS 就无法可靠地检测 mime 类型的事实，但它应该能让您顺利上路。）

希望这会让你继续前进。如您所知，您可以通过文件大小限制文件，通过扩展名进行验证，如果您通过 MIME 类型添加验证，我认为您已经尽了最大努力。我认为这是您可以做的所有事情，以确保安全并且不排除有效文件；虽然我听说过散列文件和其他一些选项；但这些将最挑衅地排除合法文件。

此外，正如我所提到的，MIME 类型可以是伪造的并发送到您的服务器，为了更加安全，您应该在客户端和服务器端都进行验证。

# sql - 对于该列中的每个值，如何在列中的值之前和之后插入文本？

> ID：11905562
> 
> 赞同：1
> 
> 时间：2012-08-10T16:17:36.807
> 
> 标签：sql, wordpress, append

**我有一个表，其中包含wordpress**中帖子的元值，该表称为`wp_postmeta`

`meta_key`该表有两个重要的列，称为`meta_value`

元密钥之一是`website`，相应的值是 url
*（例如 www.accentweb.ca）*

我想做的是获取该值并使用它自己的值作为链接创建一个指向它的链接：

那就是 `www.accentweb.ca` 进入

`<a href="http://www.accentweb.ca" target="_blank">www.accentweb.ca</a>`

对于**sql 命令**，我将使用什么，我一直在使用 set value 和其他一些命令来解决这个问题，但似乎无法让它工作，想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T18:30:17.820

这就是你所追求的吗？

```
UPDATE wp_postmeta
SET metavalue = '<a href="http://' + meta_value + '" target="_blank">'+meta_value+'</a>'
WHERE meta_key='website' 
```

# android - 如何从edittext中删除字符？

> ID：11905564
> 
> 赞同：7
> 
> 时间：2012-08-10T16:17:43.950
> 
> 标签：android

我想知道有什么方法可以从`EditText`. `EditText`我想通过在编辑文本中指定位置来删除章程，是否有类似`removeAt()`for 的内容`EditText`？

```
 public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        final Button b1=(Button)findViewById(R.id.button1);
        final EditText ed1=(EditText)findViewById(R.id.editText1);
        b1.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                // TODO Auto-generated method stub

             //i want something like this
                    ed1.removeAt(5);
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

* * *

**额外的信息**

主要问题是我想在edittext中使文本变为粗体，但不是所有文本。设置粗体按钮后输入的文本（粗体是我的切换按钮）。好的，这是代码

```
 ed1.setOnKeyListener(new OnKeyListener() {

        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // TODO Auto-generated method stub
            int i = 0;

            switch(event.getAction())
            {
            case KeyEvent.ACTION_UP:
                    if(bold.isChecked())
                    {
                         i=ed1.getSelectionStart();

                         ed1.append(Html.fromHtml("<b>"+ed1.getText().toString().charAt(i-1)+"</b>"));

                    }
                    return true;

            }
            return false;
        }
    }); 
```

问题是我得到双字符的一个是普通字符，然后是粗体，所以我想通过指定位置来删除那个普通字符

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-10T16:33:31.060

您必须先将其更改为字符串，因为 getText 返回可编辑，例如：

```
int charIndex;
String text = ed1.getText().toString();
text = text.substring(0, charIndex) + text.substring(charIndex+1);
ed1.setText(text); 
```

要删除一个字符并保持粗体字符相同：

```
ed1.setText((Spanned)ed1.getText().delete(indexStart , indexEnd)); 
```

这会将字符从索引“indexStart”删除到“indexEnd -1”。例如，如果您使用 delete(0,1); 它将删除第一个字符。

我希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-09T09:58:37.603

我的实现如下。我希望它会有所帮助

```
int cursorPosition = mDialerEditText.getSelectionStart();
    if (cursorPosition > 0) {
          mDialerEditText.setText(mDialerEditText.getText().delete(cursorPosition - 1, cursorPosition));
        mDialerEditText.setSelection(cursorPosition-1);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:23:05.263

`EditText`就像任何其他的一样`TextView`，但它也可以被编辑。因此，您可以使用该`getText()`方法，将其存储为`String`，删除所需的字符，然后在 上调用`setText(str)`方法`EditText`来更改文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T17:05:26.467

从 EditText 获取输入并存储在 String 中。

```
String temp = ed1.getText().toString(); 
```

现在操纵此字符串临时以删除所需位置的字符。（我建议你使用`String.substring(..)`函数来实现这一点。）

最后，在 EditText 中设置操作字符串 temp。

```
ed1.setText(temp); 
```

# asp.net - 从查询字符串获取参数问题 Sharepoint 2010

> ID：11905565
> 
> 赞同：1
> 
> 时间：2012-08-10T16:17:44.403
> 
> 标签：asp.net, sharepoint-2010, c#-3.0

我有以下查询字符串

```
http://mydomain/mysite/SitePages/DisplayTemplateList.aspx?CustomerID=7&IsDlg=1" 
```

我正在使用以下内容来获取 customerid 的值

```
HttpUtility.ParseQueryString(Request.Url.ToString()).Get("CustomerID") 
```

我回来了。

有任何想法吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:07:16.630

```
Request.QueryString.Get("CustomerID") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T17:35:47.393

[HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx)仅适用于`Query`a 的一部分`Uri`。使用`Query`Request.Url 的一部分而不是完整的 Url，你应该很高兴！

HttpUtility.ParseQueryString(Request.Url.Query).Get("CustomerID")

# optimization - 如何更好地进行优化？

> ID：11905567
> 
> 赞同：4
> 
> 时间：2012-08-10T16:17:47.407
> 
> 标签：optimization, memory-management, programming-languages, theory

如果问题看起来有点宽泛或奇怪，请提前道歉，我并不是要冒犯任何人，但也许有人实际上可以提出建议。我试着寻找类似的问题，但不冷。

哪些是可以教授优化代码的更好资源（书籍、博客等）？

有很多资源可以让代码更易于阅读（Code Complete 可能是第一选择）。但是如何让它运行得更快，内存效率更高呢？

当然，每种特定语言都有很多书籍，但我想知道是否有一些涉及内存/操作速度问题并且在某种程度上与语言无关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T16:38:35.880

以下是一些可能对内存优化主题有帮助的链接

[Ulrich Drepper 每个程序员都应该知道的关于内存的知识](http://www.akkadia.org/drepper/cpumemory.pdf)

[Herb Sutter：免费午餐结束：软件中向并发的根本转变](http://www.gotw.ca/publications/concurrency-ddj.htm)

[幻灯片：Herb Sutter：机器架构（您的编程语言从未告诉过您的事情）](http://nwcpp.org/talks/2007/Machine_Architecture_-_NWCPP.pdf)

[视频：Herb Sutter @ NWCPP：机器架构：您的编程语言从未告诉过您的事情](https://www.youtube.com/watch?v=L7zSU9HI-6I)

[英特尔、AMD 和威盛 CPU 的微架构 汇编程序员和编译器制造商的优化指南，作者：Agner Fog](http://www.agner.org/optimize/microarchitecture.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T16:33:43.233

[使用 go to Statements](http://pplab.snu.ac.kr/courses/adv_pl05/papers/p261-knuth.pdf)阅读结构化编程。虽然这是“过早的优化是万恶之源”这句话的来源，当有人想要让任何东西变得更快或更小时就会出现——无论它们多么重要或在过程中的后期——它实际上是关于尽可能让事情变得高效。

了解[时间复杂度](http://en.wikipedia.org/wiki/Time_complexity)、空间复杂度和[算法分析](http://en.wikipedia.org/wiki/Analysis_of_algorithms)。

想出一些例子，在这些例子中，你会为了更好的时间复杂度而牺牲更差的空间复杂度，反之亦然。

了解您选择的语言和框架提供的算法和数据结构的时间和空间复杂性，尤其是您最常使用的那些。

阅读本网站上有关创建良好哈希码的问题的答案。

研究[HTTP](http://www.ietf.org/rfc/rfc2616.txt)采用的方法，该方法具有缓存的优点，但没有不当使用陈旧数据的缺点。考虑应用于内存缓存的难易程度。考虑一下你何时会说“去死吧，我可以忍受它给我的速度提升而过时”。考虑一下您何时会说“去他妈的，我可以忍受缓慢以保证它给我的新鲜感”。

学习如何多线程。了解它何时可以提高性能。了解为什么它通常不会甚至使事情变得更糟。

查看很多[Joe Duffy 的博客](http://www.bluebytesoftware.com/blog/)，其中性能是他写作的一个常规关注点。

了解如何将项目作为流或迭代处理，而不是每次都构建和重建充满每个项目的数据结构。了解什么时候你最好不要这样做。

知道东西的成本。你不能合理地决定“我会工作，所以这是在 CPU 缓存而不是主内存/主内存而不是磁盘/磁盘而不是通过网络”，除非你很清楚是什么导致每个被击中，成本差异是多少。更糟糕的是，如果您不知道它们的成本，您不能将某些东西视为过早优化 - 不费心优化某些东西通常是最好的选择，但如果您甚至不考虑它，那么您就不是“避免过早优化”，你正在蒙混过关，希望它能奏效。

了解您使用的脚本引擎/抖动/编译器/等为您做了哪些优化。学习如何与他们合作而不是反对他们。学会不要重新做它无论如何都会为你做的工作。在一种或两种情况下，您也可以将相同的一般原则应用于您的工作。

在此站点上搜索某些被视为实施细节的案例 - 是的，所有这些案例都是相关细节在当时并不是最重要的事情，但所有这些实施细节都是出于某种原因而选择的。了解他们是什么。学习反论点。

编辑（我会继续添加更多内容）：

当然，不同的书对效率问题的重视程度不同，但我记得 Stroustrup 的*《C++ 编程语言*》中有好几次他会解释与效率有关的几个不同选项之间的选择，以及如何不为效率而做出决定对“从外部”类的可用性产生影响。

这让我想到了另一点。专注于您在不同项目中重用的库代码的效率。您永远不会想“也许我应该在这里手动滚动一个新的以提高效率”，除非这是一个非常专业的案例，否则您希望确信大量工作已投入使用以提高该类的效率在很多案例中，专注于识别热点。

至于特殊案例，一些比较晦涩的数据结构对于它们所服务的案例来说是值得了解的。例如，DAWG 是一种非常紧凑的结构，用于存储具有许多常见前缀和后缀的字符串（这将是大多数自然语言中的大多数单词），您只想在列表中找到与模式匹配的那些。如果您需要“有效负载”，那么每个字母都有一个节点列表用于每个后续字母的树（DAWG 的概括，但以该“有效负载”而不是终端节点结尾）具有一些但不是全部的优点。他们还`O(n)`及时找到结果，其中`n`是所寻找的字符串的长度。

多久会出现一次？不多。我曾经遇到过一次（确实有几次，但它们是同一案例的变体），因此在此之前了解所有关于 DAWG 的知识对我来说是不值得的。但我知道这是我以后需要研究的东西，它为我节省了千兆字节（真的，从对于 16GB RAM 的机器来说太多，到不到 1.5GB）。直接进行手动 DAWG 完全是过早的优化，而不是将字符串放入哈希集中，但浏览[NIST 数据结构站点](http://xlinux.nist.gov/dads/)意味着当它出现时我可以。

考虑一下：“在 DAWG 中查找字符串是 O(n)”“在 Hashset 中查找字符串是 O(1)”这两种说法都是正确的，但两者的速度往往相当。为什么？因为 DAWG 就字符串的长度而言是 O(n)，而就 DAWG 的大小而言实际上是 O(1)。就哈希集的大小而言，哈希集是 O(1)，但就字符串的长度而言，计算哈希通常是 O(n)，就该长度而言，相等性检查也是 O(n) . 两种说法都是正确的，但他们正在考虑不同的说法`n`！你总是需要知道`n`在任何关于时间和空间复杂性的讨论中意味着什么——通常是结构的大小，但并非总是如此。

不要忘记常数效应：对于足够低的 n 值，O(n²) 与 O(1) 相同！请记住，O(n²) 之类的转换为 n²*k + n * k₁ + k₂，假设 k₁ 和 k₂ 足够低，并且我们正在比较的另一个算法或结构的 k 和 k 足够接近，即它们并不重要，我们只关心 n²。这并不总是正确的，我们有时会发现 k、k₁ 或 k₂ 足够高，以至于我们最终会遇到麻烦。当 n 太小以至于不同方法的恒定成本的差异很重要时，这也是不正确的。当然，通常当 n 很小时，我们没有很大的效率问题，但是如果我们对平均大小为 n 的结构进行 m 操作，并且 m 很大，该怎么办。如果我们在 O(1) 和 O(n²) 方法之间进行选择，我们总体上在 O(m) 和 O(n²m) 方法之间进行选择。它似乎仍然支持前者，但在 n 较低的情况下，它基本上成为两种不同 O(m) 方法之间的选择，并且常数因素更为重要。

了解无锁多线程。或者也许不。就个人而言，我有两段我自己专业使用的代码，除了最简单的无锁技术之外，它们都使用了所有的代码。一个是基于众所周知的方法，我现在不会打扰（它是首先为 .NET2.0 编写的 .NET 代码，而 .NET4.0 库提供了一个做同样事情的类）。另一个我第一次写是为了好玩，只是在那个只是为了好玩的时期给了我一些可靠的东西之后才使用（而且在很多情况下它仍然被 4.0 库中的某些东西打败，但对于我关心的其他一些情况则不然关于）。我不想写类似的东西，但要考虑到最后期限和客户。

综上所述，如果您出于兴趣而编写代码，那么所涉及的挑战很有趣，并且当您可以自由地放弃一个失败的计划时，这是一件令人愉快的事情，而您在做的时候却没有得到对于付费客户来说，你肯定会学到很多关于效率问题的知识。（如果您想了解我对此所做的一些事情，请查看[https://github.com/hackcraft/Ariadne ）。](https://github.com/hackcraft/Ariadne)

**案例研究**

实际上，这包含了上述一些原则的一个相对较好的例子。看看目前在[https://github.com/hackcraft/Ariadne/blob/master/Collections/ThreadSafeDictionary.cs](https://github.com/hackcraft/Ariadne/blob/master/Collections/ThreadSafeDictionary.cs)的第 511 行的方法（我在评论中开玩笑说它是引述 Dijkstra 的人的诱饵. 让我们将其用作案例研究：

这个方法最初是为了使用递归而编写的，因为它是一个自然的递归问题——在对当前表执行操作之后，如果有一个“下一个”表，我们想要对其执行完全相同的操作，依此类推，直到没有进一步的操作桌子。

对于一些不同的方法，递归几乎总是比迭代慢。我们应该让所有递归调用迭代吗？不，这通常是不值得的，递归是编写代码的好方法，它清楚地知道它在做什么。在这里，虽然我应用了上面的原则，因为这是一个在性能至关重要的地方可能会被调用的库，因此应该在它上面付出特别的努力。

做出尝试提高速度的决定后，我做的下一件事就是进行测量。我不依赖于“我知道迭代比递归快，因此在更改以避免递归时它必须更快”。这不是真的——一个写得不好的迭代版本可能不如一个写得好的递归版本好。

下一个问题是，如何重写它。我有一个经过测试的方法，我知道它有效，我将用不同的版本替换它。显然，我不想用不起作用的版本替换它，那么如何在充分利用现有内容的同时重新编写？

好吧，我知道尾声消除；一种通常由编译器完成的优化，它改变了堆栈的管理方式，以便递归函数最终具有更接近于迭代的属性（从源代码的角度来看它仍然是递归的，但就编译代码的实际方式而言它是迭代的使用堆栈）。

这让我需要考虑两件事： 1\. 也许编译器已经在这样做了，在这种情况下，我的额外工作将无济于事。2\. 如果编译器还没有这样做，我可以手动采用相同的基本方法。

做出该决定后，我将方法调用自身的所有点替换为对下一次调用不同的一个参数的更改，然后返回开始。即而不是：

```
CurrentMethod(param0.next, param1, param2, /*...*/); 
```

我们有：

```
param0 = param0.next;
goto startOfMethod; 
```

完成后，我再次测量。运行该类的整个单元测试现在始终比以前快 13%。如果它更接近我会尝试更详细的测量，但在包含甚至不调用此​​方法的代码的运行中保持一致的 13% 是我非常满意的。（它还告诉我编译器没有进行相同的优化，否则我将一无所获）。

然后我清理该方法以进行更多对新代码有意义的更改。他们中的大多数让我删除了，`goto`因为`goto`确实很讨厌（还有其他地方进行了相同的优化，但由于`goto`完全重构了而不那么明显）。在某些情况下，我把它留在了，因为 13% 值得打破我心中的 no-goto 规则！

所以上面给出了一个例子：

1.  决定将优化工作集中在哪里（基于它可能被击中的频率以及我无法预测库的所有用途）
2.  使用一般成本的知识（在大多数情况下，递归成本高于迭代）。
3.  测量而不是依赖于假设以上总是适用的。
4.  从编译器的工作中学习。
5.  了解这一点，因此我可能一无所获——也许编译器已经为我做了。
6.  避免导致代码不可读的优化（重构`goto`第一遍引入的大部分内容）。

其中一些是观点和风格的问题（离开某些`goto`人的决定并非没有争议），当然可以不同意我的决定，但了解本文迄今为止提出的观点将使其成为知情的分歧，而不是下意识的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T17:42:03.703

除了其他答案中提到的资源之外，Michael Abrash 的[Graphics Programming Black Book](http://www.drdobbs.com/parallel/graphics-programming-black-book/184404919 "图形编程黑皮书")是学习优化的绝佳读物。虽然有些地方的细节有些过时，但它仍然是学习如何进行优化的重要资源。

任何时候你想优化代码，测量、测量、测量都是绝对必要的。了解优化的最佳方法之一是通过实践——获取一些您想要优化的代码，学习如何使用分析器来衡量其性能，然后进行更改并衡量结果。

# jquery - jquery 表单掩码 4 位数字 - 在选定的文本上 - 无法插入

> ID：11905569
> 
> 赞同：1
> 
> 时间：2012-08-10T16:17:51.203
> 
> 标签：jquery, regex, input, keypress

我正在尝试做的是一个用于输入邮政号码的简单表单字段，它允许输入最多 4 位数字。

看看我的jsfiddle。它工作正常，唯一的问题是，当里面有完整的 4 位数字并且选择了里面的文本时，我在输入数字时无法覆盖它，我必须先点击删除然后插入数字

[http://jsfiddle.net/vCceN/2/](http://jsfiddle.net/vCceN/2/)

另一个无关紧要的问题，如何防止用户输入 0（零）作为第一个数字？

* * *

我使用了 kundan 的解决方案并（在我看来）添加了一个更好的解决方案来解决零问题：

```
$(document).ready(function(){
    var IsSelect = false;
    $('#fld_1').select(function(){
        IsSelect = true;
    }).keypress(function (event){

        if( event.which==8 || event.which==0 || event.which == 27) return true;
        if($(this).val().length > 3 && !IsSelect) return false;
        if(IsSelect && event.which == 48) return false;
        if($(this).val().length == 0 && event.which == 48) return false;

        var regex = new RegExp("^[0-9]");

        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
        if (!regex.test(key)) {
            event.preventDefault();
            return false;
        }
        IsSelect = false;
    });

}); 
```

[工作演示](http://jsfiddle.net/NY3gP/1/)

它几乎完美地工作......唯一的问题是当用户在输入框中部分选择文本（例如最后两位数字......而不是他不能从零开始写，但它应该是可能的，因为他正在插入第三个字母而不是开头

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T17:36:14.693

它会解决你的两个问题

```
$(document).ready(function(){
  var IsSelect = false;
  $('#fld_1').select(function(){
     IsSelect = true;
  });
  $('#fld_1').keypress(function (event){

    if( event.which==8 || event.which==0 || event.which == 27) return true;
    if($(this).val().length > 3 && !IsSelect) return false;

    var regex = new RegExp("^[0-9]");

    var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
    if (!regex.test(key)) {
        event.preventDefault();
        return false;
    }
    IsSelect = false;
  });

  $('#fld_1').keyup(function (event){
    $(this).val(this.value.replace(/\b0+/g, ""));     
  });
}); 
```

[工作演示](http://jsfiddle.net/vCceN/74/)

# python - 在 Python dict 中获取键/值对的所有组合

> ID：11905573
> 
> 赞同：8
> 
> 时间：2012-08-10T16:17:59.063
> 
> 标签：python, list, dictionary, combinations

这可能是一个愚蠢的问题，但鉴于以下 dict：

```
combination_dict = {"one": [1, 2, 3], "two": [2, 3, 4], "three": [3, 4, 5]} 
```

我将如何实现此列表：

```
result_list = [{"one": [1, 2, 3], "two": [2, 3, 4]}, {"one": [1, 2, 3], "three": [3, 4, 5]}, {"two": [2, 3, 4], "three": [3, 4, 5]}] 
```

换句话说，我希望字典中两个键/值对的所有组合都没有替换，而不管顺序如何。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-10T16:21:28.877

一种解决方案是使用`itertools.combinations()`：

```
result_list = map(dict, itertools.combinations(
    combination_dict.iteritems(), 2)) 
```

**编辑**：由于[大众需求](https://stackoverflow.com/questions/11905573/getting-all-combinations-of-key-value-pairs-in-python-dict/11905613#comment15849570_11905613)，这里有一个 Python 3.x 版本：

```
result_list = list(map(dict, itertools.combinations(
    combination_dict.items(), 2))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:24:22.700

我更喜欢@JollyJumper 的解决方案以提高可读性，尽管这个解决方案执行得更快

```
>>> from itertools import combinations
>>> d = {"one": [1, 2, 3], "two": [2, 3, 4], "three": [3, 4, 5]}
>>> [{j: d[j] for j in i} for i in combinations(d, 2)]
[{'three': [3, 4, 5], 'two': [2, 3, 4]}, {'three': [3, 4, 5], 'one': [1, 2, 3]}, {'two': [2, 3, 4], 'one': [1, 2, 3]}] 
```

时间：

```
>python -m timeit -s "d = {'three': [3, 4, 5], 'two': [2, 3, 4], 'one': [1, 2, 3]}; from itertools import combinations" "map(dict, combinations(d.iteritems(), 2))"
100000 loops, best of 3: 3.27 usec per loop

>python -m timeit -s "d = {'three': [3, 4, 5], 'two': [2, 3, 4], 'one': [1, 2, 3]}; from itertools import combinations" "[{j: d[j] for j in i} for i in combinations(d, 2)]"
1000000 loops, best of 3: 1.92 usec per loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:27:09.107

```
from itertools import combinations
combination_dict = {"one": [1, 2, 3], "two": [2, 3, 4], "three": [3, 4, 5]}
lis=[]
for i in range(1,len(combination_dict)):
    for x in combinations(combination_dict,i):
        dic={z:combination_dict[z] for z in x}
        lis.append(dic)
print lis 
```

**输出：**

```
[{'three': [3, 4, 5]}, {'two': [2, 3, 4]}, {'one': [1, 2, 3]}, {'three': [3, 4, 5], 'two': [2, 3, 4]}, {'three': [3, 4, 5], 'one': [1, 2, 3]}, {'two': [2, 3, 4], 'one': [1, 2, 3]}] 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-10T16:29:38.010

我相信这会给你你所需要的。

```
result list = [{combination_dict['one','two'],combination_dict['one','three']}] 
```

我发现本教程非常有帮助：

[http://bdhacker.wordpress.com/2010/02/27/python-tutorial-dictionaries-key-value-pair-maps-basics/](http://bdhacker.wordpress.com/2010/02/27/python-tutorial-dictionaries-key-value-pair-maps-basics/)

# ruby-on-rails - Rails电话字段像日期字段？

> ID：11905577
> 
> 赞同：0
> 
> 时间：2012-08-10T16:18:28.273
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, forms

我使用设计允许用户在我的网站上注册。我有字段让他们在注册时输入他们的电话号码。

但是，我想将电话字段分成 3 个部分，以便您输入号码的不同部分，有点像日期。

是否有可能在 Rails 中像约会一样做类似的事情？当您在表单上选择日期时，它会给出字段名称：

```
model[date(1i)]
model[date(2i)]
model[date(3i)] 
```

这在其他领域可能吗？

干杯

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-10T17:33:04.487

我不相信可以诱使 date_select/select_date 家族做你想做的事。

您可以尝试为您的目的镜像 DateTimeSelector 类： [https ://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/date_helper.rb](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/date_helper.rb)

但是为什么不在控制器中处理这个呢？您可以根据需要对输入进行切片和切块。如果这是一次性的事情，我会那样做。否则，可能值得您花时间解决一般问题，在这种情况下，您可以制作一个宝石供世界使用......虽然我认为这些“i”后缀仅对 ActiveRecord 的日期和时间有用被关注到。

# xml - XSLT 条件 - 如果节点 A 中的详细信息为真，则在节点 B 中显示详细信息

> ID：11905579
> 
> 赞同：0
> 
> 时间：2012-08-10T16:18:35.023
> 
> 标签：xml, xslt, xpath

我需要帮助来设置一个有效的 XSLT 条件：在贯穿问题节点的 for-each 循环中；如果节点 A 的条件有效，则在节点 B 中显示详细信息。 XML 示例：

```
<Survey>
    <questions>
        <Number>1.0</Number>
        <Question>Was the show good?</Question>
        <Answer>Yes/No</Answer>
        <Details>N/A</Details>
    </questions>
    <questions>
        <Number>1.1</Number>
        <Question>Explain why</Question>
        <Answer>N/A</Answer>
        <Details>The actors were good</Details>
    </questions>
    <questions>
        <Number>2.0</Number>
        <Question>Was the food good?</Question>
        <Answer>Yes|No</Answer>
        <Details>N/A</Details>
    </questions>
    <questions>
        <Number>2.1</Number>
        <Question>Provide details</Question>
        <Answer>N/A</Answer>
        <Details>The pasta was too salty</Details>
    </questions>
</Survey> 
```

我需要的是仅使用for-each的循环如果问题编号= 1.0和答案='是'，仅在问题编号1.1中显示详细信息如果问题编号= 2.0并且答案='否'，则在问题编号2.1中显示详细信息

我已经尝试了所有方法，例如 if，for each，choose/when，但它没有奏效。我检查了你的其他帖子，但找不到类似的东西。谢谢你，图比。

我很抱歉，所以它应该是这样的：

```
 <Survey>     
        <questions>
            <Number>1.0</Number>
            <Question>Was the show good?</Question>
            <Answer>Yes</Answer>
            <Details>N/A</Details>     
    </questions>     
    <questions>
         <Number>1.1</Number>
         <Question>Explain why</Question>
         <Answer>N/A</Answer>         
         <Details>The actors were good</Details>
     </questions>     
     <questions>
         <Number>2.0</Number>
         <Question>Was the food good?</Question>         
         <Answer>Yes</Answer>
         <Details>N/A</Details>
     </questions>
     <questions>
         <Number>2.1</Number>
         <Question>Provide details</Question>
         <Answer>N/A</Answer>
         <Details>The pasta was too salty</Details>
     </questions>
 </Survey> 
```

这是我的一段代码：（对不起，它实际上是别人的代码。当上一个问题具体回答“是”或“否”时，我需要修改显示下一个问题的部分

```
<fo:table-body start-indent="0pt">
    <xsl:for-each select="../Survey">
        <xsl:for-each select="questions">
        <xsl:sort select="Number" data-type="number" order="ascending"/>
            <fo:table-row>
                <xsl:choose>
                    <xsl:when test="ends-with(Number,'0')">
                        <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center">
                       <fo:block text-align="right">
                                <xsl:for-each select="Number"> ...
                           </xsl:for-each>
                            </fo:block>
                        </fo:table-cell>
                        <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center">
                            <fo:block text-align="left">
                                <xsl:for-each select="Description"> ...
                                </xsl:for-each>
                            </fo:block>
                        </fo:table-cell>
                        <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center"> 
                            <fo:block text-align="left" color="blue">
                               <xsl:for-each select="Answer"> ...
                               </xsl:for-each>
                            </fo:block>
                        </fo:table-cell>                                   </xsl:when>  
                    <xsl:when test="Number='1.1'">
                        <xsl:if test="//questions/Number='1.0' and //questions/Answer='No'">
                           <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center">
                               <fo:block text-align="right">
                                    <xsl:for-each select="Number"> ...
                                    </xsl:for-each>
                               </fo:block>
                           </fo:table-cell>
                           <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center">
                               <fo:block text-align="left">
                                   <xsl:for-each select="Question">  .....
                                   </xsl:for-each>
                               </fo:block>
                           </fo:table-cell>
                           <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center"> 
                              <fo:block text-align="left" color="blue">  ....
                                   <xsl:for-each select="Details">
                                   </xsl:for-each>
                              </fo:block>
                           </fo:table-cell>                                      </xsl:if>  
                       </xsl:when>  
                       <xsl:otherwise>do something</xsl:otherwise>                        </xsl:choose>
               </fo:table-row>
            </xsl:if>
        </xsl:for-each>
    </xsl:for-each>
</fo:table-body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:19:32.610

根据经验。如果您的代码包含大量重复项，则说明您做错了。XSLT 也不例外。

```
<!-- index followup questions (no zero after the dot) -->
<xsl:key 
  name="kFollowupQuestions"
  match="questions[number(substring-after(Number, '.')) != 0]" 
  use="number(substring-before(Number, '.'))"
/>

<!-- the <Survey> becomes the <fo:table-body> -->
<xsl:template match="Survey">
  <fo:table-body start-indent="0pt">
    <!-- only select main questions (with a zero after the dot) -->
    <xsl:apply-templates select="questions[number(substring-after(Number, '.')) = 0]">
      <xsl:sort select="Number" data-type="number" order="ascending" />
    </xsl:apply-templates>
  </fo:table-body>
</xsl:template>

<!-- each <questions> becomes a <fo:table-row> -->
<xsl:template match="questions">
  <xsl:variable name="qNum"   select="number(substring-before(Number, '.'))" />
  <xsl:variable name="subNum" select="number(substring-after(Number, '.'))" />
  <fo:table-row>
    <xsl:apply-templates select="Number" />
    <xsl:apply-templates select="Question" />
    <xsl:apply-templates select="Answer" />
    <xsl:apply-templates select="Details" />
  </fo:table-row>
  <!-- for main question answered with 'Yes', display followup-questions --> 
  <xsl:if test="Answer = 'Yes' and $subNum = 0">
    <xsl:apply-templates select="key('kFollowupQuestions', $qNum)">
      <xsl:sort select="Number" data-type="number" order="ascending" />
    </xsl:apply-templates>
  </xsl:if>
</xsl:template>

<!-- the <questions> children become <fo:table-cell>s -->
<xsl:template match="questions/*">
  <fo:table-cell border="solid 1pt gray" padding="1pt" display-align="center">
    <fo:block text-align="right">
      <xsl:value-of select="." /><!-- or whatever -->
    </fo:block>
  </fo:table-cell>
</xsl:template> 
```

[http://www.xmlplayground.com/K4VHM2](http://www.xmlplayground.com/K4VHM2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:08:36.100

我会改变你的

```
<xsl:when test="Number='1.1'">
   <xsl:if test="//questions/Number='1.0' and //questions/Answer='No'"> 
```

到

```
<xsl:when test="Number='1.1'">
   <xsl:if test="../questions[Number = '1.0']/Answer = 'No'"> 
```

这是假设您没有一般的方法可以知道，对于任何问题，您是否应该在“是”答案或“否”答案上显示更多详细信息，因此`<xsl:when>`每个 *.0 问题都有一个单独的案例。

PS 奇怪的是，XSL`<xsl:for-each select="Number">`在每个内部都使用 etc.，因为在您的示例输入中`<fo:block>`只有一个`<Number>`孩子。`<questions>`所做的只是更改上下文节点。也许意图是使用`<xsl:apply-templates select="Number" />`？

# jquery - 使用切换时检查 div 是否隐藏

> ID：11905580
> 
> 赞同：1
> 
> 时间：2012-08-10T16:18:34.993
> 
> 标签：jquery

我正在使用切换功能，这样当我单击一个按钮时会显示一个 div，而当我再次单击该按钮时它会隐藏。但问题是我在 div 中还有一个关闭 div 的关闭按钮，这意味着当我单击按钮时，切换不完整，当我尝试通过该切换按钮再次打开 div 时，它首先完成切换意味着再次隐藏已经隐藏的 div 然后再次显示它，有什么解决方案吗？

```
$(".stngs").toggle(function() {
    $(".stngsubmenu").css({
        display: 'block'
    });
}, function() {    
    $(".stngsubmenu").css({
        display: 'none'
    });
});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T16:25:18.313

根据[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)您可以将布尔值传递给切换

```
$(".stngs").toggle($(".stngsubmenu").is(':visible')); 
```

或者

```
$(".stngs").toggle($(".stngsubmenu").is(':hidden')); 
```

true 将显示元素， false 将隐藏[.is()](http://api.jquery.com/is/)函数将返回布尔值的元素

`$(".stngsubmenu").is(':visible')`// <-- 如果可见则返回true

`$(".stngsubmenu").is(':hidden')`// <-- 如果隐藏则返回true

[http://jsfiddle.net/wirey00/KXPBq/](http://jsfiddle.net/wirey00/KXPBq/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:22:06.227

您可以使用以下内容检查是否隐藏了某些内容

```
if ( $('#mydiv').is(':hidden') ) {
    //do something
} 
```

# html - 在 Jade 模板内的目录中列出文件

> ID：11905581
> 
> 赞同：1
> 
> 时间：2012-08-10T16:18:37.117
> 
> 标签：html, node.js, directory, pug

我目前正在使用 Jade HMTL 模板语言（与 CodeKit 结合使用）来生成我的网站。我网站的其中一个页面需要是特定目录中所有页面的索引。与其手动保持更新，我更希望自动生成。

我的 Jade 模板中有没有办法创建 geven 目录中所有文件的列表？是否可以嵌入一些可以做到这一点的脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:31:59.320

不仅是 Jade，您还可以从 Node.js 传递 Jade 的信息。

此示例假设您将 Jade 与 ExpressJS 一起使用，但您可以根据需要对其进行调整：

节点.js：

```
app.get('/', function(req, res) {
  fs.readdir(path, function(err, data){
    res.render('index', {"files": data});
  });
}); 
```

翡翠（index.jade）：

```
ul
  for file in files
    li
      p= file 
```

# version-control - Windows 7 上的 TortoiseHg 通过 Windows Server 2008 R2 上的 KpyM 进行 SSH 克隆 - 远程 hg 没有合适的响应

> ID：11905583
> 
> 赞同：1
> 
> 时间：2012-08-10T16:18:54.543
> 
> 标签：version-control, mercurial, ssh, windows-server-2008, tortoisehg

背景...

在 Windows Server 2008 上：

*   安装 TortoiseHg 2.4.2
*   创建了一个存储库并添加了一些文件并提交等。
*   安装 KpyM 1.19c

在 Windows 7 上：

*   下载腻子
*   通过 SSH 连接到服务器 - 工作正常，可以浏览目录和执行命令等。
*   安装 TortoiseHg 2.4.2

通过 SSH 克隆存储库：

*   有源`ssh://user@myhost/path/to/my/repository`
*   提示输入密码一次
*   大约5分钟没有任何反应
*   我收到消息“远程 hg 没有合适的响应”

克隆输出：

```
% hg clone --verbose -- ssh://user@myhost/path/to/my/repository C:\Users\Chris\Documents\Visual Studio 2010\Projects\MyProject
running "TortoisePlink.exe" -ssh -2 user@myhost "hg -R path/to/my/repository serve --stdio"
no suitable response from remote hg
[command returned code 255 Fri Aug 10 17:10:42 2012] 
```

**我究竟做错了什么？**

**如何解决此问题？**

**PS我没有对公钥/私钥做任何事情，因为我认为这只是为了避免密码提示。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T07:53:43.900

KpyM 是一个很好的（免费的）SSH 服务器，但它不支持远程命令（在撰写本文时）。

试试 Copssh - 它是唯一一款可免费用于商业用途的软件。

# c - 如何序列化内存中的 SQLite 数据库？

> ID：11905586
> 
> 赞同：3
> 
> 时间：2012-08-10T16:19:08.677
> 
> 标签：c, sqlite

我有一个内存中的 SQLite 数据库，我想对其进行序列化并发送到另一台计算机。如果不将数据库写入磁盘并从那里读取文件，这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:10:35.797

您可以使用在线备份 API 将内存数据库传输到在共享内存中创建的基于文件的数据库（对于 Linux，例如在 /dev/shm 中），从而避免磁盘操作。然后这个伪文件被传输到远程主机（仍然放在 /dev/shm 中），并使用在线加载 API 从基于文件的数据库传输到您的目标内存数据库。

看：

[http://www.sqlite.org/backup.html](http://www.sqlite.org/backup.html)

[http://www.sqlite.org/c3ref/backup_finish.html](http://www.sqlite.org/c3ref/backup_finish.html)

AFAIK，没有中间数据库就没有 API 来执行在线/加​​载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T18:24:42.763

sqlite3 [shell 程序包含一个`.dump`](http://www.sqlite.org/sqlite.html)“以 SQL 文本格式转储数据库”的[命令。](http://www.sqlite.org/sqlite.html)您可以使用[源代码`.dump`](http://www.sqlite.org/src/artifact/076e1c90d594644f36027c8ecff9a392cf2d3a06)（它是公共领域）来创建自己的序列化程序。

# jquery - JQuery 验证无法与 MVC 3 一起正常工作

> ID：11905591
> 
> 赞同：0
> 
> 时间：2012-08-10T16:19:47.087
> 
> 标签：jquery, validation, asp.net-mvc-3, html-helper

我在使用 jquery 验证时遇到的问题是它不喜欢名称中的点表示法。我正在使用基于视图模型和字段名称自动创建名称的 Microsoft HTML 助手。因此，例如，MS Html 处理程序将从“AuditDoc”视图模型中具有变量“Title”的 html 文本框生成“AuditDoc.Title”。我的困境是 JQuery 验证不喜欢名称中间的那个点。因此，当我将“AuditDoc.Title”作为要验证的名称时，它给了我一个 javascript 错误。有什么办法吗？我会很感激帮助！

```
 $("#SaveCreateInProgress").click(function () {
        $("#AdvanceDirection").val("SAVE");
        $("#CreateInProgressMainForm").validate({
            rules: {
                AuditDoc.Title: "required",
                AuditDoc.ActivityId: "required"
            },
            messages: {
                AuditDoc.Title: "Please enter a Title (JQuery Validate)",
                AuditDoc.ActivityId: "Please select an Activity Id (JQuery Validate)"
            },
            submitHandler: function (form) {
                alert("Submitted!");
            }
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:03:14.427

试着把引号像

```
$("#SaveCreateInProgress").click(function () {
        $("#AdvanceDirection").val("SAVE");
        $("#CreateInProgressMainForm").validate({
            rules: {
                "AuditDoc.Title": "required",
                "AuditDoc.ActivityId": "required"
            },
            messages: {
                "AuditDoc.Title": "Please enter a Title (JQuery Validate)",
                "AuditDoc.ActivityId": "Please select an Activity Id (JQuery Validate)"
            },
            submitHandler: function (form) {
                alert("Submitted!");
            }
        }); 
```

PS 为什么不使用MVC 附带的[不显眼的验证](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html)

编辑

这是演示[http://jsfiddle.net/DWHjw/](http://jsfiddle.net/DWHjw/)

# javascript - 将每个页面放入 cookie 以加快“返回”过程

> ID：11905593
> 
> 赞同：1
> 
> 时间：2012-08-10T16:19:59.253
> 
> 标签：javascript, html, cookies, back

是否可以使用 cookie 让用户在具有大量 jquery 模块的站点中更快地浏览？我的意思是，每次当有人点击浏览器的后退按钮时，他都会返回到内存中的页面（每个页面模块都将完全位于用户从该页面退出时的位置）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:41:46.373

您可能会发现 pushState 和 history 对此很有用：[Manipulating the Browser History](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

使用这些技术，您可以更改使用浏览器的后退按钮时请求的信息。

# wcf - 没有内存分配的 wcf 反序列化

> ID：11905594
> 
> 赞同：4
> 
> 时间：2012-08-10T16:20:00.613
> 
> 标签：wcf, garbage-collection, datacontractserializer

我有一个 WCF 服务处理大量请求（每秒数千个）。每个请求都包含对象，因此它们在反序列化期间构建在 DataContractSerializer 中。我的服务处理这些消息，它们被 .net 垃圾收集器清理。

问题是垃圾收集给我的服务带来了问题（请求有时会比应有的时间长 100 多毫秒）。我需要尽量减少它们。所以我正在寻找一种使用对象池的方法。换句话说，我希望数据契约序列化程序从我的对象池中获取一个对象（而不是通过 GetUninitializedObject 获取一个），然后当我处理完消息后，我会将其释放回池中进行清理和重用，从而避免每秒数千次内存分配。

我已经看到使用 protobuf-net 是可能的（[使用 protobuf-net，是否可以在不分配内存的情况下反序列化消息？](https://stackoverflow.com/questions/8884346/using-protobuf-net-is-it-possible-to-deserialize-a-message-without-allocating-m)）实际上我在其他地方使用 protobuf，但对于这种特殊情况，这不是一个选项

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T05:04:33.830

已`DataContractSerializer`密封，无法更新。所以不幸的是，您将无法删除它对`FormatterServices.GetUninitializedObject`.

相反，您需要做的是创建您自己的从[XmlObjectSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.xmlobjectserializer%28v=vs.100%29.aspx)继承的序列化程序，以便您可以完全控制实例的创建。

下一步是创建[DataContractSerializerOperationBehavior](http://msdn.microsoft.com/en-us/library/ms599084%28v=vs.100%29)并重写`CreateSerializer`方法以返回您的自定义序列化程序。

最后要做的是从端点中删除默认的 DataContractSerializerOperationBehavior 并将其替换为实现自定义序列化程序的自定义项。[Carlos Figueira 在他的博客上有一篇文章准确地展示了如何做到这一点](http://blogs.msdn.com/b/carlosfigueira/archive/2011/03/29/wcf-extensibility-icontractbehavior.aspx)（转到名为“真实世界场景：使用新的序列化程序”的部分）。

# java - 顶部菜单（关闭、最小化、最大化）Java

> ID：11905598
> 
> 赞同：2
> 
> 时间：2012-08-10T16:20:22.370
> 
> 标签：java, swing, menu, toolbar, look-and-feel

如何更改工具栏的外观和感觉，顶部菜单（关闭、最小化、最大化按钮的位置）

有可能喜欢改变吗？（添加、删除按钮、分配背景）创建它需要什么导入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:52:06.650

您可以设置 a 的背景图像，`JButton`您可以看一下：[Swing 教程：JButton](http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-JButton.html)，它显示了使用 和来创建`new JButton(String text,ImageIcon imgIco)`a 。`JButton``ImageIcon``String`

要设置背景和文本的颜色，您可以使用`setBackground(Color c)`和`setForeground(Color c)`

或者

或者，只需通过设置适当的受支持[外观](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)来自定义外观配色方案，然后[更改其组件的配色方案/大小等，](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/color.html)您可以为每个组件更改数百项内容，请查看[所有](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/_nimbusDefaults.html#primary)内容。

要自*定义**Exit*、*Minimize*和*Maximize* Toolbar 按钮，也可以使用外观（[JFrame 上 Close/Minimize 按钮的自定义设计](https://stackoverflow.com/questions/10913058/custom-design-for-close-minimize-buttons-on-jframe)）：

![金属](../Images/90908ffdc1f5684067b9e1ed2bf99911.png) ![视窗](../Images/7658eaac131039911c40b75b5819849b.png)

```
import java.awt.BorderLayout;
import javax.swing.*;

public class FrameCloseButtonsByLookAndFeel {

    FrameCloseButtonsByLookAndFeel() {
        String[] names = {
                UIManager.getSystemLookAndFeelClassName(), 
                UIManager.getCrossPlatformLookAndFeelClassName()
        };
        for (String name : names) {
            try {
                UIManager.setLookAndFeel(name);
            } catch (Exception e) {
                e.printStackTrace();
            }
            // very important to get the window decorations.
            JFrame.setDefaultLookAndFeelDecorated(true);
            JFrame f = new JFrame(UIManager.getLookAndFeel().getName());
            f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

            JPanel gui = new JPanel(new BorderLayout());
            f.setContentPane(gui);

            JTree tree = new JTree();
            tree.setVisibleRowCount(4);
            gui.add(tree, BorderLayout.LINE_START);

            gui.add(new JScrollPane(new JTextArea(3,15)));

            JToolBar toolbar = new JToolBar();
            gui.add(toolbar, BorderLayout.PAGE_START);
            for (int ii=1; ii<5; ii++) {
                toolbar.add(new JButton("Button " + ii));
                if (ii%2==0) {
                    toolbar.addSeparator();
                }
            }

            f.pack();

            f.setLocationByPlatform(true);
            f.setVisible(true);
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new FrameCloseButtonsByLookAndFeel();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:54:06.150

改变框架标题栏外观的最简单方法是在创建框架之前设置 LookAndFeel。可能这就是您正在寻找的 - [http://www.jtattoo.net/ScreenShots.html](http://www.jtattoo.net/ScreenShots.html)

# asp.net - 在多个 Web 项目之间共享配置文件

> ID：11905599
> 
> 赞同：1
> 
> 时间：2012-08-10T16:20:31.920
> 
> 标签：asp.net, iis-7.5

我有多个 Web 项目，每个项目都有自己的 web.config 文件。
这些 Web 项目有一些常见的设置，我想将它们添加到单独的配置文件中，比如 CommonSettings.Config

我尝试按照本文中的建议添加配置文件（作为链接项）-
[如何在项目之间共享配置文件](http://devlicio.us/blogs/derik_whittaker/archive/2008/04/15/how-to-share-configuration-files-between-projects.aspx)

但是因为我的项目中已经有 web.config 文件，所以
运行时只查看 web.config 文件而不是 CommonSettings.config

是否有可能将 CommonSettings.Config 添加为所有项目之间的共享文件？

谢谢！

PS 我不想在 machine.config 文件中添加这些设置。

# python - 更改 for 循环中的迭代次数

> ID：11905606
> 
> 赞同：22
> 
> 时间：2012-08-10T16:21:01.763
> 
> 标签：python, loops, for-loop, range

我有这样的代码：

```
loopcount = 3
for i in range(1, loopcount)
   somestring = '7'
   newcount = int(somestring)
   loopcount = newcount 
```

所以我想要的是修改 for 'inside' 循环的范围。

我编写了这段代码，期望在第一个循环期间 for 循环的范围会更改为 (1,7)，但它没有发生。

相反，无论我输入什么数字，它都只运行 2 次。（我想要6次..在这种情况下）

我使用 print 像这样检查值：

```
 loopcount = 3
    for i in range(1, loopcount)
       print loopcount
       somestring = '7'
       newcount = int(somestring)
       loopcount = newcount
       print loopcount
#output:
3
7
7
7 
```

怎么了？号码已更改。

我的想法哪里错了？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-10T16:26:22.040

该范围是根据`loopcount`调用时的值创建的——之后发生的任何循环计数都无关紧要。您可能想要的是一个 while 语句：

```
loopcount = 3
i = 1
while i < loopcount:
    somestring = '7'
    loopcount = int(somestring)
    i += 1 
```

测试`while`条件`i < loopcount`是否为真，如果为真，则运行它包含的语句。在这种情况下，每次通过循环时，i 都会增加 1。由于第一次通过时 loopcount 设置为 7，因此循环将运行六次，因为 i = 1、2、3、4、5 和 6 .

一旦条件为假，当 时`i = 7`，while 循环停止运行。

（我不知道你的实际用例是什么，但你可能不需要分配 newcount，所以我删除了它）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-10T16:23:46.347

从`range()`文档字符串：

> range([start,] stop[, step]) -> 整数列表
> 
> 返回一个包含整数等差数列的列表。range(i, j) 返回 [i, i+1, i+2, ..., j-1]；start (!) 默认为 0。当给出 step 时，它指定增量（或减量）。例如，range(4) 返回 [0, 1, 2, 3]。终点省略！这些正是 4 个元素列表的有效索引。

所以，`range(1, 10)`例如，返回一个类似的列表：`[1,2,3,4,5,6,7,8,9]`，所以，你的代码基本上是在做：

```
loopcount = 3
for i in [1, 2]:
    somestring = '7'
    newcount = int(somestring)
    loopcount = newcount 
```

当您的`for`循环“初始化”时，列表由`range()`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-10T18:58:11.247

*user802500*给出的*while-loop*答案可能是您实际问题的最佳解决方案；但是，我认为所提出的问题**有**一个有趣且有启发性的答案。

 ****range()*调用的结果是一个连续值的列表。for 循环遍历该列表，直到用完为止。

这是关键点： **您可以在迭代期间改变列表**。

```
>>> loopcount = 3
>>> r = range(1, loopcount)
>>> for i in r:
        somestring = '7'
        newcount = int(somestring)
        del r[newcount:] 
```

此功能的实际用途是迭代待办事项列表中的任务并允许某些任务生成新的待办事项：

```
for task in tasklist:
    newtask = do(task)
    if newtask:
        tasklist.append(newtask) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-10T16:24:06.820

当[range()](http://docs.python.org/library/functions.html#range)函数在`for`-loop 中求值时，它会生成一个值序列（即一个列表），用于迭代。

`range()`为此使用 的值`loopcount`。但是，*一旦*生成了该序列，您*在*循环中所做的任何事情都不会更改该列表，即，即使您`loopcount`稍后更改，原始列表将保持不变 => 迭代次数将保持不变。

在你的情况下：

```
loopcount = 3
for i in range(1, loopcount): 
```

变成

```
for i in [1, 2]: 
```

所以你的循环迭代两次，因为你`print`在循环中有 2 个语句，你得到 4 行输出。请注意，您打印的值`loopcount`最初为 3，但随后被设置（并重置）为 7。

如果您希望能够动态更改迭代次数，请考虑改用`while`-loop。当然，您总是可以使用[break](http://docs.python.org/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops)语句提前停止/退出任何循环。

还，

```
 somestring = '7'
   newcount = int(somestring) 
```

可以简化为

```
 newcount = 7 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-10T16:35:21.377

要专门解决“如何更改范围界限”的问题，您可以利用[生成器的发送方法](http://docs.python.org/reference/expressions.html#generator.send)：

```
def adjustable_range(start, stop=None, step=None):
    if stop is None:
        start, stop = 0, start

    if step is None: step = 1

    i = start
    while i < stop:
        change_bound = (yield i)
        if change_bound is None:
            i += step
        else:
            stop = change_bound 
```

用法：

```
myrange = adjustable_range(10)

for i in myrange:
    if some_condition:
        myrange.send(20) #generator is now bounded at 20 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-10T16:27:11.753

看起来你的前提是你有一个默认的循环应该执行的次数，但是偶尔的情况是不同的。改用while循环可能会更好，但无论如何你都可以这样做：

```
if i == some_calculated_threshold:
    break 
```

而是退出循环。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-10T16:29:15.627

一旦设置了范围，您就无法*增加迭代次数，但您可以提前突破，从而减少迭代次数：*

```
for i in xrange(1, 7):
   if i == 2:
       break 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-10T17:13:49.393

`adjustable_range`这是Joel Cornett 提供的函数的更完整实现。

```
def adjustable_range(start, stop=None, step=None):
    if not isinstance(start, int):
        raise TypeError('start')
    if stop is None:
        start, stop = 0, start
    elif not isinstance(stop, int):
        raise TypeError('stop')
    direction = stop - start
    positive, negative = direction > 0, direction < 0
    if step is None:
        step = +1 if positive else -1
    else:
        if not isinstance(step, int):
            raise TypeError('step')
        if positive and step < 0 or negative and step > 0:
            raise ValueError('step')
    if direction:
        valid = (lambda a, b: a < b) if positive else (lambda a, b: a > b)
        while valid(start, stop):
            message = yield start
            if message is not None:
                if not isinstance(message, int):
                    raise ValueError('message')
                stop = message
            start += step 
```***

# c# - 你有一个简单而有用的例子来理解代表的目的吗？

> ID：11905617
> 
> 赞同：3
> 
> 时间：2012-08-10T16:21:57.190
> 
> 标签：c#, events, delegates

> **可能重复：**
> [何时以及为什么使用代表？](https://stackoverflow.com/questions/2019402/when-why-to-use-delegates)

我了解大部分 C# 语法，并且我部分了解委托，但我找不到任何需要使用它们的情况。

你能通过一些例子帮助我了解他们在软件开发中的地位吗？我会很高兴的。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:34:32.810

委托是表达代码提供者和代码消费者之间相互义务的另一种方式。

这就像“我需要一个可以添加两个整数并返回两个整数的人”和“嘿，我是一个方法，我可以添加两个整数并返回一个整数，你可以使用我”。

那么从遥远的角度来看，问“我为什么需要委托”就像问“我为什么需要接口”。只是表达“方法合同”而不是表达“类合同”。

有趣的是，大多数使用委托处理的情况都可以使用接口处理，反之亦然。只是 C# 为您在两种机制之间进行选择提供了更大的灵活性。例如，您在 Java 中没有这种灵活性，其中使用接口来表达义务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:48:47.720

委托的一个功能是充当函数指针。对于我必须编写的程序，我需要运行类似的函数并以数组样式调用它们。

例如，如果你有几个函数。

```
double play(int data1, int data2)
double work(int x, int y) 
```

这两个签名相同。他们都返回双打，并且都取 2 个整数。他们可以与代表一起打电话

```
delegate double myFunctions(int a, int b); 
```

所以假设我需要从同一个函数中运行“play”和“work”。我可以这样做：

```
public void do_something( myFunctions action, String information)
{
   int input1;
   int input2;
   /*
     Lets say the string was.... the dimensions of a rectangle expressed as 5x8
     here we parse the string so...

     information is "5x8:
     set input1 to 5
     set input2 to 8
   */

   //then run the function that was passed in.
   action(input1, input2);
} 
```

你会这样调用这个函数：

```
do_something(play, "5x8");
//or
do_something(work, "484x237"); 
```

我认为那里的评论区会让这不是一个微不足道的例子。基本上，至少在这种情况下，它可以帮助模块化程序。

# jquery - 如何使 JQuery UI 选项卡上的标签文本突出显示？

> ID：11905620
> 
> 赞同：0
> 
> 时间：2012-08-10T16:22:00.640
> 
> 标签：jquery, user-interface, hyperlink, tabs, selectable

在选项卡的 JQuery UI 实现中，当用户将鼠标悬停在任何给定选项卡中的标签文本上时，光标将显示为“I-bar”，但文本本身是不可选择的。也就是说，它不能被突出显示（为了复制）。

例如，这是一个包含 JQuery 选项卡的 JSFiddle：http: [//jsfiddle.net/KhwZS/567](http://jsfiddle.net/KhwZS/567)

请注意，您不能在选项卡本身中选择标签文本。我需要找到一种方法来使标签标签可选。

这可以通过 JQuery UI 选项卡来完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T18:27:37.617

选择文本似乎很困难，因为您必须在可点击选项卡区域*之外*单击，否则您的点击将被`preventDefault()`jquery.ui 编辑，尽管我不知道确切的原因（如果有的话）。

也许解决这个问题的一个好方法是查看`.tabs()`代码，并创建自己的版本。

我通常不喜欢 jquery.ui 小部件（尽管我使用效果和 -ables）并且倾向于根据我正在处理的应用程序的特定需求重写我自己的自定义小部件；从头开始创建标签行为应该不难，所以也许这是你最好的选择。

# c# - 在 Silverlight 中的服务器和客户端项目之间共享类

> ID：11905622
> 
> 赞同：2
> 
> 时间：2012-08-10T16:22:08.063
> 
> 标签：c#, visual-studio-2010, silverlight, shared-libraries

问题：B 类是 A 类的子类。RIA 服务返回对象 B 的列表。A 类和 B 类都必须在服务器端定义。它们可以很好地序列化，我可以在主客户端项目中使用它们。

我有另外两个库，组织为客户端库。一种用于自定义控件，另一种用于在自定义控件和实际客户端项目之间共享的类。

我需要可以从 Classes 库客户端访问 Class A（以便自定义控件可以访问它）。我怎样才能做到这一点？

我已经这样做了：

[http://msdn.microsoft.com/en-us/library/ee707369%28v=vs.91%29.aspx](http://msdn.microsoft.com/en-us/library/ee707369%28v=vs.91%29.aspx)

但是 *.shared.cs 约定除了在服务器中更新 ClassA.cs 之外，除了实际的客户端库访问 A 类之外，没有提供库访问权限。**第二种方法（添加为链接）确实做了我想要做的事情项目不会导致客户端版本更新**，因此每次更改两个类文件时都必须更新它们，*这是不可接受的*。

编辑：**多次尝试后添加为链接效果很好。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:29:29.187

在 Visual Studio 中（至少是 2010 年——不知道添加该功能的确切时间），您可以将现有项目作为“链接”添加到项目中，这意味着源文件在项目之间共享。只有一个版本的源文件存在。

1.  右键单击您的项目。
2.  单击“添加..现有项目”。
3.  找到选择的源文件并选择它。
4.  “添加”按钮是一个下拉菜单。单击按钮中的下拉图标。
5.  单击“添加为链接”。

简单的！

现在，对共享源文件的任何更改都会反映在这两个地方。当然，缺点是开发人员没有得到任何迹象表明对共享源文件的更改可能会产生比她可能意识到的更广泛的影响。

另一种选择是创建一个`hard link`两个文件名引用同一个文件（Unix 术语中的“inode”）。在命令行上，只需念出魔法咒语：

```
fsutil hardlink create <new-filename> <existing-filename> 
```

就像是：

```
fsutil hardlink create c:\foo\bar\some-project\bazbat.cs c:\foo\bar\another-project\bazbat.cs 
```

限制是两个名称必须在同一个卷上。

当然，这有可能混淆您的源代码控制系统。我敢打赌，TFS 没有考虑文件系统不一定是树结构并且同一个文件可能存在于多个目录中的可能性。

硬链接文件可以按任何顺序删除：当最后一个链接被删除时，文件将不复存在。

第三个选项，当然，可能是“最佳实践”——讨厌这个词！— 是将分片类分解为一个独立的程序集，该程序集部署到客户端和服务器。如果想限制浮动的程序集数量，构建后，您可以使用`ilmerge`来合并程序集：

*   [http://www.codeproject.com/Articles/9364/Merging-NET-assemblies-using-ILMerge](http://www.codeproject.com/Articles/9364/Merging-NET-assemblies-using-ILMerge)
*   [在运行时合并两个程序集 - C#](https://stackoverflow.com/questions/3704699/merge-two-assemblies-at-runtime-c-sharp)
*   [如何将多个程序集合并为一个？](https://stackoverflow.com/questions/8077570/how-to-merge-multiple-assemblies-into-one)

想一想，您也没有理由不能将共享程序集嵌入为按需加载（甚至在启动时）的嵌入式资源。这甚至可能比使用`ilmerge`. 以下是如何做到这一点：

[http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)

# variables - 批处理脚本帮助 - 将 DelayedExpansion Var 的子字符串替换为另一个 DelayedExpansion Var

> ID：11905625
> 
> 赞同：4
> 
> 时间：2012-08-10T16:22:30.130
> 
> 标签：variables, batch-file, substring, windows-scripting, delayedvariableexpansion

基本上我正在尝试做 !var1:SomeText=!var2!! 但这段代码不起作用。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T21:31:25.567

在执行使用变量进行搜索和/或替换的搜索和替换操作时，扩展顺序至关重要。内部变量必须在外部搜索和替换扩展发生之前扩展。尝试对两者都使用延迟扩展显然是行不通的，因为延迟扩展发生在一个时间点。

在另一个变量中扩展一个变量的经典方法对外部使用延迟扩展，对内部使用正常扩展：`echo !var1:SomeText=%var2%!"`

我将假设您出于某种原因想要使用延迟扩展。也许扩展发生在代码块中，并且其中一个变量设置在同一块中。正常扩展不起作用，因为直到块结束后它才能看到块内分配的值。

**解决方案 1**

解决问题的一种方法是使用 CALL：

```
call echo %%var1:SomeText=!var2!%% 
```

这工作如下：

1.  解析器的百分比阶段将双百分比转换为单百分比，导致
    `call echo %var1:SomeText=!var2!%`

2.  延迟扩展扩展 !var2!，导致
    `call echo %var1:SomeText=ReplacementText%`

3.  执行 CALL ECHO 并进行附加级别的百分比处理。执行搜索和替换扩展，导致`ResultOfSearchAndReplace`回显到屏幕上。

这有效，但速度相对较慢。如果扩展值具有特殊字符（如`>`,`&`或）也可能出现问题`|`。我很少使用这种技术。

**解决方案 2**

快速且更可靠的方法是分两步进行扩展。首先将 的值传递`!var2!`给 FOR 变量。然后，您可以使用 FOR 变量作为替换字符串，并在第二步中使用延迟扩展。这完全避免了更脆的膨胀百分比。

```
for /f "delims=" %%A in ("!var2!") do echo !var1:SomeText=%%A! 
```

上述工作是因为 FOR 变量扩展发生在延迟扩展之前。

到目前为止，这是我解决这个问题的首选方法。

有关批处理解析器各个阶段的更详细说明，请参阅 jeb[对 Windows 命令解释器 (CMD.EXE) 如何解析脚本的回答？](https://stackoverflow.com/a/4095133/1012053)

# java - JButton 文本和图像图标被省略号截断

> ID：11905626
> 
> 赞同：5
> 
> 时间：2012-08-10T16:22:30.593
> 
> 标签：java, swing, jscrollpane, jbutton, layout-manager

我是一名初级程序员，正在构建一个带有按钮和滚动条的简单窗口。当我编译我的代码时，我的按钮上的文本被省略号切断，并且图像图标不显示。我已经尝试在 eclipse 和 NetBeans 中编译它。为了解决我尝试过的问题

```
.setMargin(new Insets(0, 0, 0, 0));

.setPreferedSize

adding padding (I forgot the code for this)

.setBounds 
```

以及我在互联网上偶然发现的几乎所有其他内容。这些都没有解决我的问题，我无法查看按钮中的文本和图像。

我的代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*; 

public class FeedBar2 extends JFrame {

    public FeedBar2() {
        super("FeedBar 2");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        // create icons
        ImageIcon loadIcon = new ImageIcon("load.gif");
        ImageIcon saveIcon = new ImageIcon("save.gif");
        ImageIcon subscribeIcon = new ImageIcon("subscribe.gif");
        ImageIcon unsubscribeIcon = new ImageIcon("unsubscribe.gif");
        // create buttons
        JButton load = new JButton("Load", loadIcon);
        JButton save = new JButton("Save", saveIcon);
        JButton subscribe = new JButton("Subscribe", subscribeIcon);
        JButton unsubscribe = new JButton("Unsubscribe", unsubscribeIcon);
        // add buttons to toolbar
        JToolBar bar = new JToolBar();
        bar.add(load);
        bar.add(save);
        bar.add(subscribe);
        bar.add(unsubscribe);
        // create menu
        JMenuItem j1 = new JMenuItem("Load");
        JMenuItem j2 = new JMenuItem("Save");
        JMenuItem j3 = new JMenuItem("Subscribe");
        JMenuItem j4 = new JMenuItem("Unsubscribe");
        JMenuBar menubar = new JMenuBar();   
        JMenu menu = new JMenu("Feeds");
        menu.add(j1);
        menu.add(j2);
        menu.addSeparator();
        menu.add(j3);
        menu.add(j4);
        menubar.add(menu);
        // prepare user interface
        JTextArea edit = new JTextArea(8, 40);
        JScrollPane scroll = new JScrollPane(edit);
        BorderLayout bord = new BorderLayout();
        setLayout(bord);
        add("North", bar);
        add("Center", scroll);
        setJMenuBar(menubar);
        pack();
        setVisible(true);
    }

    public static void main(String[] arguments) {
        FeedBar2 frame = new FeedBar2();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:37:38.880

您的图像位置一定有问题，因为这很好用（使用 URL 图像）：

```
import java.awt.BorderLayout;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JToolBar;

public class FeedBar2 extends JFrame {

    public FeedBar2() {
        super("FeedBar 2");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        // create icons
        ImageIcon loadIcon = null;
        try {
            loadIcon = new ImageIcon(new URL("http://t0.gstatic.com/images?q=tbn:ANd9GcRQgmCgdCMtXO6db7pX4UwzdvJY9-r8kI2zwE5A6c3VqB9eOR2Pe8gpqQBdeg"));
        } catch (MalformedURLException ex) {
            Logger.getLogger(FeedBar.class.getName()).log(Level.SEVERE, null, ex);
        }
        // create buttons
        JButton load = new JButton("load", loadIcon);
        // add buttons to toolbar
        JToolBar bar = new JToolBar();
        bar.add(load);
        BorderLayout bord = new BorderLayout();
        setLayout(bord);
        add("North", bar);
        pack();
        setVisible(true);
    }

    public static void main(String[] arguments) {
        FeedBar2 frame = new FeedBar2();
    }
} 
```

那么图片是否与jar位于同一目录中（在netbeans中它们可以位于主项目目录中）？如果它们位于 jar 中，则需要使用以下方法提取它们：[`getResourceAsStream`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)使用正确的包路径，其中包含相对于当前包的图像。

我建议总是用你的罐子打包你的图像，更少的问题（在netbeans上这样做只需将图像拖放到你当前的类包中，然后简单地使用确切的名称（区分大小写）来检索它使用这`getResourceAsStream`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T16:53:18.713

*   你的意思是

![在此处输入图像描述](../Images/65dfabcb5b22f35a7d68339a3e5c0b85.png)

*   常见的问题是[Icon/ImageIcon](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)永远不会返回任何异常，在这种情况下`null value`，您必须测试`null value`，

*   有几个主题[如何加载编译成Java包的图像](http://docs.oracle.com/javase/tutorial/deployment/index.html)

从代码

```
import java.awt.*;
import javax.swing.*;

public class FeedBar2 extends JFrame {

    private static final long serialVersionUID = 1L;
    private Icon loadIcon = UIManager.getIcon("OptionPane.errorIcon");
    private Icon saveIcon = UIManager.getIcon("OptionPane.informationIcon");
    private Icon subscribeIcon = UIManager.getIcon("OptionPane.warningIcon");
    private Icon unsubscribeIcon = UIManager.getIcon("OptionPane.questionIcon");

    public FeedBar2() {
        super("FeedBar 2");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        // create icons
        /*ImageIcon loadIcon = new ImageIcon("load.gif");
        ImageIcon saveIcon = new ImageIcon("save.gif");
        ImageIcon subscribeIcon = new ImageIcon("subscribe.gif");
        ImageIcon unsubscribeIcon = new ImageIcon("unsubscribe.gif");*/
        // create buttons
        JButton load = new JButton("Load", loadIcon);
        JButton save = new JButton("Save", saveIcon);
        JButton subscribe = new JButton("Subscribe", subscribeIcon);
        JButton unsubscribe = new JButton("Unsubscribe", unsubscribeIcon);
        // add buttons to toolbar
        JToolBar bar = new JToolBar();
        bar.add(load);
        bar.add(save);
        bar.add(subscribe);
        bar.add(unsubscribe);
        // create menu
        JMenuItem j1 = new JMenuItem("Load");
        JMenuItem j2 = new JMenuItem("Save");
        JMenuItem j3 = new JMenuItem("Subscribe");
        JMenuItem j4 = new JMenuItem("Unsubscribe");
        JMenuBar menubar = new JMenuBar();
        JMenu menu = new JMenu("Feeds");
        menu.add(j1);
        menu.add(j2);
        menu.addSeparator();
        menu.add(j3);
        menu.add(j4);
        menubar.add(menu);
        // prepare user interface
        JTextArea edit = new JTextArea(8, 40);
        JScrollPane scroll = new JScrollPane(edit);
        BorderLayout bord = new BorderLayout();
        setLayout(bord);
        add("North", bar);
        add("Center", scroll);
        setJMenuBar(menubar);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setVisible(true);
    }

    public static void main(String[] arguments) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                FeedBar2 frame = new FeedBar2();
            }
        });
    }
} 
```

# web-services - Netbeans JAX-WS Generated Classes Collisons（同一个项目上的存根和服务器）

> ID：11905628
> 
> 赞同：0
> 
> 时间：2012-08-10T16:22:34.607
> 
> 标签：web-services, soap, netbeans, jax-ws, wsimport

我正在开发两个服务器端独立模块（A 和 B）。

B 作为客户端与 A 交互。到目前为止，一切都很好。

问题是当我在 B 上生成存根时，Netbeans 会在不同的包中生成类，从而使同一个类与其他类不兼容（尽管它们是同一个类）。

```
public RegistryResponseType documentRepositoryProvideAndRegisterDocumentSetB(ProvideAndRegisterDocumentSetRequestType body) 
{
    oasis.names.tc.ebxml_regrep.xsd.rim._3.SubmissionObjectRequest receivedObj body.getSubmitObjectsRequest();
    pt.ieeta.xadi.core.SubmitObjectsRequest stubObj = handleSubmissionObject(receivedObj);
} 
```

目前我正在使用以下方法翻译对象（尽管它们是同一个类但通过不同的进程生成）：

```
pt.ieeta.xadi.core.SubmitObjectsRequest stubObj = handleSubmissionObject(receivedObj); 
```

我敢打赌，有一种简单的方法可以做到这一点。

谁能帮我？

提前谢谢你，很抱歉成为 JAX-WS 菜鸟；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:06:52.850

假设您从 wsdl 开始并生成类...不要在两个单独的进程中生成类。设置第三个项目以包含生成的代码（仅此而已）。然后其他两个项目引用它的输出——或者作为项目依赖项，或者通过生成一个 jar 并共享一个公共工件。当然，这假设您的两个服务器端应用程序都将使用兼容的运行时（不一定是相同的容器，但至少两者都支持相同版本的 JAX-WS 规范，这也与您的开发环境中的工具相匹配）。

# java - Java：super.clone() 方法和继承

> ID：11905630
> 
> 赞同：15
> 
> 时间：2012-08-10T16:22:48.660
> 
> 标签：java, object, inheritance, clone, instance

`clone()`我有一个关于Java 中的方法的快速问题，用于`super.clone()`继承 - 我`clone()`从按钮一直调用父类中的方法。

该`clone()`方法应该返回该对象的副本，但是如果我在继承heirachy中有三个类并调用`super.clone()`了三次，为什么继承heirachy中的最高类在Object类下没有得到该类的副本回来？

假设我们有三个类：A、B 和 C，其中 A -> B -> C (inherit = ->)

然后`super.clone()`在类 C 中调用`clone()`，在调用 B 中调用`super.clone()`，`clone()`在调用 A 中调用`super.clone()`“这次 Object.clone() 被调用”。为什么它不是`this`从 A 类返回的对象的副本`Object.clone()`？这对我来说听起来很合乎逻辑。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-10T16:38:31.547

听起来这里至少有两个问题在起作用：

1.  听起来您对通常如何实现 clone() 感到困惑。

2.  听起来您认为克隆是一个好主意（与使用复制构造函数、工厂或它们的等效项相比）。

下面是一个克隆方法[的实现示例：](http://www.javapractices.com/topic/TopicAction.do?Id=71)

```
@Override 
public Object clone() throws CloneNotSupportedException {   
    //get initial bit-by-bit copy, which handles all immutable fields
    Fruit result = (Fruit)super.clone();

    //mutable fields need to be made independent of this object, for reasons
    //similar to those for defensive copies - to prevent unwanted access to
    //this object's internal state
    result.fBestBeforeDate = new Date( this.fBestBeforeDate.getTime() );

    return result;
} 
```

请注意， 的结果`super.clone()`会立即转换为`Fruit`. 这允许继承方法随后修改 Fruit 特定的成员数据（`fBestBeforeDate`在本例中）。

因此，对子`clone()`方法的调用虽然会调用父方法的克隆，但也会将其自己的特定修改添加到新制作的副本中。在这种情况下，结果将是 a `Fruit`，而不是`Object`。

现在，更重要的是，**克隆是个坏主意**。复制构造函数和工厂提供了更直观且易于维护的替代方案。尝试阅读我附加到示例的[Java 实践](http://www.javapractices.com/topic/TopicAction.do?Id=71)链接上的标题：它总结了一些问题。Josh Bloch 也有[更长的讨论](http://www.artima.com/intv/bloch13.html)：绝对应该避免克隆。以下是关于他为什么认为克隆是一个问题的精彩摘要段落：

> Object 的 clone 方法非常棘手。它基于现场副本，并且是“语言外的”。它创建一个对象而不调用构造函数。不能保证它保留了构造函数建立的不变量。多年来，无论在 Sun 内部还是外部，都出现了很多错误，这是因为如果您只是在链上反复调用 super.clone 直到您克隆了一个对象，您就会得到该对象的浅表副本。克隆通常与被克隆的对象共享状态。如果该状态是可变的，则您没有两个独立的对象。如果你修改一个，其他的也会改变。突然之间，你得到随机行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T16:32:10.257

它是一种特殊的本地方法。这样做是为了使克隆更容易。否则，您将不得不复制祖先类的整个代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-04T10:28:36.047

尽管接受了一个答案，但我认为它不能完全回答问题的第一部分（为什么子类中的向下转换总是有效的）。虽然我不能真正解释它，但我想我可以澄清一些与我相同的海报的困惑。我们有以下课程

```
class A implements Cloneable 
{
   @Override
   protected A clone() throws CloneNotSupportedException // could be public
   { 
      Object clone = super.clone();
      System.out.println("Class A: " + clone.getClass()); // will print 'C'
      return (A) clone;
   }
}

class B extends A
{
   @Override
   protected B clone() throws CloneNotSupportedException
   { 
      A clone = super.clone();
      System.out.println("Class B: " + clone.getClass()); // will print 'C'
      return (B) clone;
   }
}

class C extends B
{
   @Override
   protected C clone() throws CloneNotSupportedException
   { 
      B clone = super.clone();
      System.out.println("Class C: " + clone.getClass()); // will print 'C'
      return (C) clone;
   }
}

static main(char[] argv)
{
   C c = new C();
   C cloned_c = c.clone();
} 
```

这样做的结果是

`Class A: C`

`Class B: C`

`Class C: C`

打印在命令行上。因此，事实上，该`clone()`方法可以通过`Object`某种方式查看调用堆栈并查看调用*链开头的*对象类型*，*然后，如果调用冒泡，那么实际调用的是该类型的对象被建造。所以这已经发生在课堂上，这很奇怪，但它解释了为什么向下转换不会导致. 我已经检查过 OpenJDK，它似乎是由一些在本机代码中实现的 Java 黑魔法带来的。*`clone()``Object#clone()``C``ClassCastException`*

 ** * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-10T16:30:51.497

如果 B 中的 clone() 返回 A 中的 clone() 返回值，C 中的 clone() 返回 B 中的 clone() 返回值，那么 C 中的 clone() 将返回 A 中的 clone() 返回值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-14T09:12:28.877

这个类有关于这个类的信息以及它与另一个类相关联。因此，从概念上讲，这个类的对象也将具有关联类的信息。此对象是不完整的对象，没有关联的对象/父类。需要复制此类中的所有直接和间接字段，使其成为当前对象的值得新克隆。我们不能只访问仅表示子部分的参考部分。*

# python - (Z3Py) 函数声明有什么限制吗？

> ID：11905635
> 
> 赞同：3
> 
> 时间：2012-08-10T16:23:07.447
> 
> 标签：python, z3

函数声明有什么限制吗？

例如，这段代码返回 unsat。

```
from z3 import *

def one_op (op, arg1, arg2):
    if op==1:
        return arg1*arg2
    if op==2:
        return arg1-arg2
    if op==3:
        return arg1+arg2

    return arg1+arg2 # default

s=Solver()

arg1, arg2, result, unk_op=Ints ('arg1 arg2 result unk_op')

s.add (unk_op>=1, unk_op<=3)

s.add (arg1==1)
s.add (arg2==2)
s.add (result==3)
s.add (one_op(unk_op, arg1, arg2)==result)

print s.check() 
```

Z3Py 如何解释声明的函数？它只是偶尔调用它还是这里也有一些隐藏的机器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:36:34.027

在函数调用`one_op(unk_op, arg1, arg2)`中，`unk_op`是一个 Z3 表达式。那么，`op==1`和`op==2`（在 的定义中`one_op`）等表达式也是 Z3 符号表达式。因为`op==1`不是 Python 布尔表达式`False`。该函数`one_op`将始终返回 Z3 表达式`arg1*arg2`。我们可以通过执行来检查`print one_op(unk_op, arg1, arg2)`。请注意，`if`定义中的`one_op`语句是 Python 语句。

我相信您的真正意图是返回一个包含条件表达式的 Z3 表达式。您可以通过定义`one_op`为：

```
def one_op (op, arg1, arg2):
    return  If(op==1,
               arg1*arg2,
               If(op==2,
                  arg1-arg2,
                  If(op==3,
                     arg1+arg2,
                     arg1+arg2))) 
```

现在，该命令`If`构建了一个 Z3 条件表达式。通过使用这个定义，我们可以找到一个令人满意的解决方案。这是完整的示例：

```
from z3 import *

def one_op (op, arg1, arg2):
    return  If(op==1,
               arg1*arg2,
               If(op==2,
                  arg1-arg2,
                  If(op==3,
                     arg1+arg2,
                     arg1+arg2)))

s=Solver()

arg1, arg2, result, unk_op=Ints ('arg1 arg2 result unk_op')

s.add (unk_op>=1, unk_op<=3)
s.add (arg1==1)
s.add (arg2==2)
s.add (result==3)
s.add (one_op(unk_op, arg1, arg2)==result)

print s.check()
print s.model() 
```

结果是：

```
sat
[unk_op = 3, result = 3, arg2 = 2, arg1 = 1] 
```

# google-chrome - 谷歌图书馆（mootools）不能与谷歌脚本网络应用程序一起使用

> ID：11905637
> 
> 赞同：0
> 
> 时间：2012-08-10T16:23:14.397
> 
> 标签：google-chrome, mootools, google-apps-script, google-ajax-libraries

我有一个简单的 Google Script 项目。代码是：

```
function doGet() {
  return HtmlService.createHtmlOutputFromFile('main');
} 
```

还有 main.html （我遇到问题的地方）：

```
<html>
    <head>
       <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.5/mootools.js"/>
    </head>
</html> 
```

当我发布和测试脚本时，我在 JavaScript 控制台中收到以下错误：

> 无法读取未定义 3953020933-maestro_htmlapp_bin_maestro_htmlapp.js:54 的属性“prototype_v___”

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:50:12.977

目前唯一支持的库是 jQuery 和 jQuery UI。你不能使用mootools。

# mysql - 从 GROUP_BY 查询中优化 COUNT(*)

> ID：11905638
> 
> 赞同：2
> 
> 时间：2012-08-10T16:23:30.780
> 
> 标签：mysql, sql, count, sql-optimization

下面是一个有效的 SQL 查询，它返回按用户的多个帐户分组的未查看消息计数列表。但是，我们实际上并不需要计数，只需要一点点来表明存在未查看的消息。在不拆开相当复杂的 JOIN 逻辑的情况下，您能否看到一种通过将 COUNT 替换为 EXISTS/HAVING/DISCTINCT 1 或其他技术来优化查询的方法？

我最初以为我什至可以将 COUNT 替换为 FIRST 以进行一些简单的优化，但不能使用 MySQL ......

（我看过[这个问题](https://stackoverflow.com/q/2759756/165673)，但是 GROUP BY 很难应用我见过的任何替代方案）

```
SELECT messages_to_user.account_id, COUNT(*) FROM

(SELECT message.id as id, root_message.account_id as account_id
    FROM message
    JOIN message as root_message 
    on message.conversation_id = root_message.id
    AND (root_message.created_by = {user_id}
    OR root_message.to_user_id = {user_id}
    OR root_message.to_user_id IS NULL)
    AND message.created_by != {user_id}
) messages_to_user

LEFT JOIN

(SELECT 
    message_view.id as id, 
    message_view.message_id as message_id,
    message_view.user_id as user_id
    FROM message_view
    WHERE message_view.user_id = {user_id}) viewed_messages

ON messages_to_user.id = viewed_messages.message_id

WHERE viewed_messages.id IS NULL

GROUP BY messages_to_user.account_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:34:29.940

如果您不需要计数，只需在第一行的 SELECT 中省略 COUNT(*) 即可。

我不能保证这会让你的查询运行得更快，但我也不相信你有任何需要努力进行这种优化的问题（我认为“这种”是指“过早”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:34:03.030

在 SQL Server 中，我会这样做：

```
case when exists(select * from messages where IsUnread = 1) then 1 else 0 as HasUnreadMessage 
```

这显然是伪代码。也许你可以让它为 MySQL 工作。存在检查应该便宜得多，因为它可以在找到一行时停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:57:00.247

如何减少正在加入的子查询的大小：

```
SELECT DISTINCT messages_to_user.account_id FROM

(SELECT DISTINCT message.id as id, root_message.account_id as account_id
    FROM message
    JOIN message as root_message 
    on message.conversation_id = root_message.id
    AND (root_message.created_by = {user_id}
    OR root_message.to_user_id = {user_id}
    OR root_message.to_user_id IS NULL)
    AND message.created_by != {user_id}
) messages_to_user

LEFT JOIN

(SELECT DISTINCT message_id
    FROM message_view
    WHERE message_view.user_id = {user_id}) viewed_messages

ON messages_to_user.id = viewed_messages.message_id

WHERE viewed_messages.message_id IS NULL 
```

# jquery - div向后滑动不起作用

> ID：11905640
> 
> 赞同：0
> 
> 时间：2012-08-10T16:23:43.073
> 
> 标签：jquery, html, click, slide

当用户单击按钮时...一个 div 向下滑动...

```
$(document).ready(function(){
    $("#friend_requests_container").click(function(){
        $("#friend_requests").slideDown(500);
    });
}); 
```

但是，我想要做的是当用户单击页面上的其他任何位置时，div 会向后滑动，除非他们单击按钮以显示 div。

我尝试的是这个。

```
$(document).ready(function(){
    $("#friend_requests_container").click(function(){
        $("#friend_requests").slideDown(500);
    }, function(){
        $("#friend_requests").fadeOut(500);
    });
}); 
```

但这似乎不起作用......有什么想法吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:27:05.070

您需要`two`一个`friend_requests_container`单击事件和另一个`document`单击事件，当单击friend_requests_container 时，事件也是如此`propagated`，`document click`因此您需要使用`stopPropagation()`

**[现场演示](http://jsfiddle.net/rajaadil/mwasc/)**

```
$(document).ready(function(){
    $("#friend_requests_container").click(function(event){     
        $("#friend_requests").slideDown(500);
                 event.stopPropagation();             
    });

    $(document).click(function(event){
        $("#friend_requests").slideUp(500);
         event.stopPropagation();      
    });   
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:29:03.203

您可以在文档中附加一个事件并检查单击元素的 id

```
$(document).ready(function(){
    $("#friend_requests_container").click(function(){
        $("#friend_requests").slideDown(500);
    });

    $(document).click(function(e){
        if(e.target.id !== "friend_requests_container") {
           $("#friend_requests").slideUp(500);
        }
    });
}); 
```

# sql - Oracle CURRENT_DATE 在查询中不起作用

> ID：11905644
> 
> 赞同：0
> 
> 时间：2012-08-10T16:24:21.063
> 
> 标签：sql, oracle

我有一个简单的查询来过滤出`due_date`今天的值。

```
SELECT *
  FROM ORDER
  WHERE DUE_DATE = CURRENT_DATE AND
        ROWNUM <= 10
  ORDER BY DUE_DATE ASC 
```

但是，即使我有一堆订单的截止日期为今天，查询实际上返回 0 行。

怎么会？提前致谢。

对不起，我忘了提到 DUE_DATE 是类型`Date`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T16:28:53.233

您需要截断日期，如

```
SELECT *
  FROM ORDER
  WHERE TRUNC(DUE_DATE) = TRUNC(CURRENT_DATE) AND
        ROWNUM <= 10
  ORDER BY DUE_DATE ASC 
```

或使用范围比较，如

```
SELECT *
  FROM ORDER
  WHERE DUE_DATE BETWEEN TRUNC(CURRENT_DATE)
                     AND TRUNC(CURRENT_DATE) + INTERVAL '1' DAY - INTERVAL '1' SECOND AND
        ROWNUM <= 10
  ORDER BY DUE_DATE ASC 
```

后一个示例可能会执行得更好，因为可以使用索引（假设您在 DUE_DATE 有索引）。当然，您也可以在 TRUNC(DUE_DATE) 上添加基于函数的索引，在这种情况下，两者的性能都可能同样好。

分享和享受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:32:10.670

CURRENT_DATE 包含月、日和年。您的截止日期也可能包含小时、分钟、秒。如果是这样，您应该在进行比较时截断日期。

# c++ - 用继承和多态重载'<<'？

> ID：11905648
> 
> 赞同：7
> 
> 时间：2012-08-10T16:24:38.850
> 
> 标签：c++, inheritance, polymorphism, operator-overloading

以下是代码外观的粗略示例，问题是我如何让 DerivedOne 和 DerivedTwo 有一个重载的 << 运算符，但将这些对象存储在 Base* 的向量中。

至于我想达到什么；我希望能够遍历对象向量并在 DerivedOne 和 DerivedTwo 中输出我告诉它的信息。

```
vector<Base*> objects;

class Base
{
 private:
 object Data
 public:
 object getData() { return Data; }
};

class DerivedOne : public Base
{
}

class DerivedTwo : public Base
{
} 
```

现在我知道有这个，但它不适用于我的目的。

```
friend ostream &operator<<(ostream &stream, Object object)
{
    return stream << "Test" << endl;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-10T18:37:59.803

[将您的虚拟方法设为私有，以将对象的使用方式与派生类自定义其行为的方式分开。](http://www.gotw.ca/publications/mill18.htm)

这是类似于其他答案的解决方案，但虚拟方法是私有的：

```
#include <iostream>

namespace {
  class Base {
    // private (there is no need to call it in subclasses)
    virtual std::ostream& doprint(std::ostream&) const = 0;
  public:
    friend std::ostream& operator << (std::ostream& os, const Base& b) {
      return b.doprint(os); // polymorphic print via reference
    }

    virtual ~Base() {} // allow polymorphic delete
  };

  class DerivedOne : public Base {
    std::ostream& doprint(std::ostream& os) const {
      return os << "One";
    }
  public:
    DerivedOne() { std::cerr << "hi " << *this << "\n"; } // use << inside class
    ~DerivedOne() { std::cerr << "bye " << *this << "\n"; }
  };
} 
```

### 例子

```
#include <memory>
#include <vector>

int main () {
  using namespace std;
  // wrap Base* with shared_ptr<> to put it in a vector
  vector<shared_ptr<Base>> v{ make_shared<DerivedOne>() };
  for (auto i: v) cout << *i << " ";
  cout << endl;
} 
```

### 输出

```
hi One
One 
bye One 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-10T16:35:12.357

你可以这样做：

```
struct Base {
    virtual ~Base () {}
    virtual std::ostream & output (std::ostream &) const = 0;
};

std::ostream & operator << (std::ostream &os, const Base &b) {
    return b.output(os);
} 
```

然后，在应用`operator<<`on时`Base`，它会调用派生的输出方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T17:16:01.247

就您的问题描述而言，您有一组动态分配的多态对象。

解决方案可以根据这些对象如何遵循某些设计规则而改变：

1.  你反对“仅叶对象”吗？（不是指其他对象本身）？
2.  是否只有单个非循环引用（您的对象是否仅形成子对象树）？
3.  引用之间是否有多个路径（两个或多个引用的同一对象）
4.  有循环引用吗？
5.  是否有对其他对象*成员*的引用？

情况可能会变得非常复杂，具体取决于您是否可以容忍同一对象的多个输出以及如何打破最终循环。

您不能做的第一件事是`Base`用作值参数（例如在您的 , 因为这会创建一个副本（承认您的对象是可复制的：如果它们引用其他对象，副本会做什么？乘以路径？将引用的对象克隆为好？）

如果您处于情况 (1.)，您只需要一个虚函数`std::ostream&`，在所有叶子对象中被覆盖。然后你需要一个重载 for`operator<<(std::ostream&, Base*)`和另一个 for`(std::ostream&, const std::vector<Base*>&)`

像这样：

```
class Base
{
    ...
public:
    virtual ~Base() {} //must be polymorphic
protected:
    virtual void out(std::ostream& s) =0;

    friend std::ostream& operator<<(std::ostream& st, Base* pb)
    { pb->out(st); return st; }
};

class Derived1: public Base
{
    ...
protected:
    virtual void out(std::ostream& s)
    {
        s << "Derived1 at " << this << " address " << std::endl;
    }
};

class Derived2: public Base
{
    ...
protected:
    virtual void out(std::ostream& s)
    {
        s << "Derived2 at " << this << " address " << std::endl;
    }
};

std::ostream& operator<<(std::ostream& s, const std::vector<Base*>& v)
{
    s << "there are " << v.size() << " objects:" << std::endl;
    for(auto& i:v)
        s << i;
    return s;
} 
```

如果你在 sutuation (2.) yopu 可能会

```
class Derived3: public Base
{
    ...
    Base* ptrOwnedobject;
}; 
```

您可以简单地实现该`Derived3::out`功能以求助于拥有的孩子。

如果您处于情况 (3.) 中，并且您不能容忍相同的对象被打印更多时间，那么您有不同的父母共享同一个孩子。您应该以某种方式标记孩子，这样您就不会保存它两次或更多次，并在完成打印后取消标记所有孩子（您很可能会将该机制设置到 Base 类中）。

如果您处于情况（4.），那么关于（3.）的内容将成为强制性的，以避免无限递归。

如果您处于情况（5.）中，您还必须发现成员属于哪个对象（不是微不足道的）。如果你也有多重继承和虚拟基......事情就更复杂了。

# sql-server - PowerShell 中对 Invoke-Sqlcmd 的 Unicode 支持

> ID：11905649
> 
> 赞同：11
> 
> 时间：2012-08-10T16:24:38.953
> 
> 标签：sql-server, powershell, unicode, sqlcmd

PowerShell [sqlps 模块](http://msdn.microsoft.com/en-us/library/hh245198)为从 PowerShell 中访问 SQL Server 提供核心支持，其[Invoke-Sqlcmd](http://msdn.microsoft.com/en-us/library/cc281720) cmdlet 是其执行文字查询或 SQL 脚本文件（类似于非 PowerShell [sqlcmd](http://msdn.microsoft.com/en-us/library/ms162773.aspx)实用程序）的主要主力。我最近尝试了一些实验来确认 Invoke-Sqlcmd 处理 Unicode 并且有一些令人惊讶的结果。

我从这个简单的脚本文件（名为 unicode.sql）开始：

```
CREATE TABLE #customers

( [IdCust] int,
  [FirstName] nvarchar(25),
  [SurName] nvarchar(25)
);
INSERT INTO #customers VALUES (4, N'Hans', N'Grüßner')
SELECT * FROM #customers;
DROP TABLE #customers; 
```

请注意，姓氏具有一些典型的 Unicode 字符，例如，可能会在德语名称中找到。

* * *

## 结果

**SQL Server Management Studio：**输出到网格或文本时正确呈现，例如

```
IdCust      FirstName                 Surname
----------- ------------------------- -------------------------
4           Hans                      Grüßner 
```

**sqlcmd 实用程序：**无论是从 DOS shell 还是 PowerShell 运行，都可以正确呈现，例如

```
C:\> sqlcmd -S .\SQLEXPRESS -i unicode.sql

IdCust      FirstName                 Surname
----------- ------------------------- -------------------------
          4 Hans                      Grüßner 
```

**PowerShell Invoke-Sqlcmd：**呈现不正确（无论是输出为如下所示的文本还是通过管道传输到 Out-Gridview）：

```
PS> Invoke-Sqlcmd -Server .\sqlexpress -InputFile unicode.sql

IdCust FirstName           Surname
------ ---------           -------
     4 Hans                Gr??ner 
```

Invoke-Sqlcmd的[MSDN 文档](http://msdn.microsoft.com/en-us/library/cc281720)仅顺便提及 Unicode，将其命令行开关与 sqlcmd 的命令行开关进行比较，表明虽然后者有`-u`输出 Unicode 的选项（在我上面的实验中甚至不需要），但 Invoke-Sqlcmd没有*等效*参数。

通过广泛的网络搜索，我没有发现任何关于这一点的信息，但我仍然希望这在某种程度上是我的用户错误。在 PowerShell 中使用 Invoke-Sqlcmd 检索输入数据时，有没有办法保留输入数据？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-11T01:10:24.440

**更新**我在另一台机器上测试了 invoke-sqlcmd 并且它可以工作，所以其余的可能不适用......

**更新 2**通过 -Query 参数 invoke-sqlcmd 执行时，似乎只有 -inputfile 有问题。

据我所知，这与转换字符串时的 ADO.NET DataTable 有关。当您使用 ExecuteScaler 或 ExecuteReader 时，它可以正常工作。当然，这并不能修复 invoke-sqlcmd，但可以解释原因：

```
$server = "$env:computername\sql1"
$database = "tempdb"
$query = @"
CREATE TABLE #customers

(     [SurName] nvarchar(25)
);
INSERT INTO #customers VALUES (N'Grüßner')
SELECT * FROM #customers;
"@

$connection=new-object System.Data.SqlClient.SQLConnection
$connection.ConnectionString="Server={0};Database={1};Integrated Security=True" -f $server,$database
$command=new-object system.Data.SqlClient.SqlCommand($query,$connection)
$connection.Open()
$command.ExecuteScalar()
$connection.Close() 
```

**更新 3** 文件的编码似乎是关键。查看 [System.IO.File]::ReadAllText，MSDN 文档指出它只会检测 UTF-8 或 UTF-32 编码。[http://msdn.microsoft.com/en-us/library/ms143369(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms143369(v=vs.90).aspx)

如果我使用 UTF-8 保存 .sql 文件，则使用 -inputfile 参数有效。在 SSMS 中保存 .sql 文件时可以选择 UTF-8，但这里有一些 Powershell 代码也可以检查和更改编码。您需要从[http://poshcode.org/2075获取 Get-FileEncoding.ps1](http://poshcode.org/2075)

```
. .\Get-FileEncoding.ps1 
Get-FileEncoding -Path E:\bin\unicode.sql

$query = get-content E:\bin\unicode.sql
$query= $query -join "`n"
$query | Out-File -FilePath e:\bin\unicode.sql -Encoding UTF8 -force

Get-FileEncoding -Path E:\bin\unicode.sql 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-23T22:21:34.680

执行 SQLCMD 时，必须指定编码。

EXEC xp_cmdshell 'for %f in ("{Dir}*.sql") do sqlcmd -S {Server} -U {username} -P {password} -d {database} -i "%f" -b -f 65001 '

# c# - 我有一个错误 Object cannot be cast from DBNull to other types？

> ID：11905656
> 
> 赞同：0
> 
> 时间：2012-08-10T16:25:08.123
> 
> 标签：c#, c#-4.0, c#-3.0, c#-to-vb.net

我的代码是：当我执行断点时，我正在从数据库中检索数据，它显示列表中的数据，但它也给了我一个错误

```
 public static List<StudentScore> GetAllScore()
   {
       SqlConnection conn = MyDB.GetConnection();
       string selectStm = "SELECT en.CourseID,en.Score,s.StudentID FROM EnrollmentTable en,Student s WHERE en.StudentID = s.StudentID";
       SqlCommand command = new SqlCommand(selectStm, conn);
       List<StudentScore> aStudentScore = new List<StudentScore>();
       try
       {
           conn.Open();
           SqlDataReader reader = command.ExecuteReader();          
           Console.WriteLine(reader.HasRows.ToString());
           while (reader.Read())
           {
               StudentTable st = new StudentTable();
               CourseTable cr = new CourseTable();
               Enrollment enr = new Enrollment();
               StudentScore score = new StudentScore();
               enr.CourseData = cr;
               enr.StudentData = st;                                    
                   //score.EnrollmentData.StudentData.StudentID = reader["StudentID"].ToString();
                   //score.EnrollmentData.CourseData.CourseID = reader["CourseID"].ToString();                  
                   st.StudentID = reader["StudentID"].ToString();
               cr.CourseID = reader["CourseID"].ToString();
               score.Score = Convert.ToInt32(reader["Score"]);
               score.EnrollmentData = enr; 
               aStudentScore.Add(score);
           }
           reader.Close();
           return aStudentScore;
       }
       catch (SqlException ex)
       {
           throw ex;
       }
       finally
       {
           conn.Close();
       }

   }

} 
```

}

它从数据库中获取数据，但显示 mw 这个错误.....对象不能从 DBNull 转换为其他类型，所以这意味着什么，请告诉我如何解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T16:31:31.473

这意味着您`NULL`在数据库中有一个值。您必须在代码中检查它，或者将您的列模式更改为`NOT NULL`.

```
st.StudentID = reader["StudentID"] == DBNull.Value ? null : reader["StudentID"].ToString();
cr.CourseID = reader["CourseID"] == DBNull.Value ? null : reader["CourseID"].ToString();
score.Score = reader["Score"] == DBNull.Value ? 0 : Convert.ToInt32(reader["Score"]); 
```

您现在必须处理`null`C# 对象中的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T16:32:24.827

您需要检查阅读器是否为 DBNULL 类型

在尝试转换之前调用阅读器上的 IsDBNull() 以检查该列：

```
using (reader = server.ExecuteReader(CommandType.Text, TopIDQuery, paramet))
{
   while (reader.Read())
   {
       var column = reader.GetOrdinal("TopID");

       if (!reader.IsDBNull(column))
          topID = Convert.ToInt32(reader[column]);
       }
   }
} 
```

或者，与 DBNull.Value 进行比较：

```
var value = reader["TopID"];

if (value != DBNull.Value)
{
    topID = Convert.ToInt32(value);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T16:33:47.063

DBNull 用于表示数据库中的空值。

您应该在转换 ir 之前检查该值是否不是 DBNull。

```
object score = reader["Score"];

score.Score = score == DBNull.Value ? 0 : Convert.ToInt32(score); 
```

# php - 锁定 SQL 表，然后执行事务，用于根据选择值插入条件

> ID：11905661
> 
> 赞同：4
> 
> 时间：2012-08-10T16:25:26.830
> 
> 标签：php, mysql, pdo, innodb

我需要完成以下工作：

我需要在同一个表中插入两行，要么都插入，要么都不插入（原子插入两行）。

我使用 InnoDB 表上的事务来执行此操作，如下所示：

```
$db->beginTransaction();

# Using PDO prepared statments, execute the following queries:
INSERT INTO t1 set uid=42, foo=1
INSERT INTO t1 set uid=42, foo=2

$db->commit(); 
```

但是，如果表中没有列的值为“42”的行，我也只希望插入这些行。

所以我这样做：

```
$stmt = $db->prepare("SELECT id FROM t1 WHERE uid != ?");
$stmt->execute(array(42));
if($stmt->fetchColumn() < 0){
    # There is no row with uid=42, so
    # perform insertions here as per above.
    INSERT INTO t1 set uid=42, foo=1
    INSERT INTO t1 set uid=42, foo=2
} 
```

但是这里存在竞争条件，因为可以在检查该行之后和插入新行之前立即插入 uid=42 的行。

我应该如何解决这个问题？

我可以锁定表，然后在表锁内执行 InnoDB 事务吗？

我可以在事务内部进行选择以检查 uid=42 的现有行吗？那是没有比赛条件的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:42:32.193

您可以使用信号量类型的架构。例如，创建一个名为“信号量”的表或任何您想调用的表。假设表中只有一个字段，并且该字段是唯一的，称为“sem”。现在，运行“INSERT INTO semaphore SET sem = 42”；

好的，那个 INSERT 语句是原子的，并且意味着在那之后当其他人试图插入 42 时，他们会得到一个错误，说明重复键。

然后，在原始表中进行插入。在事务中完成所有这些。在 SQL 中，它看起来像这样：

```
BEGIN TRANSACTION;
INSERT INTO semaphore SET sem = 42;
INSERT INTO t1 set uid=42, foo=1;
INSERT INTO t1 set uid=42, foo=2;
COMMIT;
DELETE FROM semaphore WHERE sem = 42; 
```

之后进行删除的原因有两个：

1.  我想您不需要删除它，但是让我们去寻找干净的数据吧；）
2.  在 COMMIT 之后删除的原因是您希望在事务完成之前保持阻塞锁定。

旁注：信号量通常在自动增量字段不起作用时使用。然后，您使用一个只有一条记录的信号量表来序列化插入并阻止主键。

希望能帮助到你 ：）

# regex - 有人可以检查一下我的表达有什么问题吗？

> ID：11905664
> 
> 赞同：0
> 
> 时间：2012-08-10T16:25:49.803
> 
> 标签：regex, vi

我正在尝试更改这些：

[http://www.ltv.com/iloveu/health/contraceptionsurvey/](http://www.ltv.com/iloveu/health/contraceptionsurvey/)

[http://www.ltv.com/iloveu/health/contraception-special/](http://www.ltv.com/iloveu/health/contraception-special/)

```
 location ~* ^/iloveu/health/contraceptionsurvey/?$ {
        rewrite ^ /ilo`enter code here`veu/health/ permanent;
    }

    location ~* ^/iloveu/health/contraception-special/?$ {
        rewrite ^ /iloveu/health/ permanent;

} 
```

使用我创建的这个表达式：

```
%s/http:\/\/www\.ltv\.com\(.*\)/location ~\* \^\& \{ \r\t rewrite \^ \/iloveu\/health\/ permanent; \r }\r/g 
```

但似乎没有得到想要的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:45:33.710

```
%s#http://www\.ltv\.com\(.*\)#location \~* ^\1?$ \{ \r\t rewrite ^ /iloveu/health/ permanent; \r }\r#g 
```

`\&`获取匹配的整个字符串，而不仅仅是括号中的部分，您可以使用`\1`.

# c# - 如何将多个类作为代码隐藏附加到单个 ASP.Net 页面？

> ID：11905665
> 
> 赞同：0
> 
> 时间：2012-08-10T16:26:06.023
> 
> 标签：c#, asp.net

我继承了一个有趣的 ASP 页。该页面向用户呈现各种报告。报告类型由用户在加载报告页面之前从左侧菜单中选择。报告页面使用一组相对较小的屏幕元素来向用户查询报告参数，例如报告的开始和结束日期，但有大约 20 种不同的报告。每个报告决定显示哪些元素，然后在请求时在后端生成报告并在修改后的 GridView 中显示报告以显示特定报告。

其实它的结构还不错。问题是支持代码文件现在大约有 4000 行代码。其中大部分是 switch 或 if then else 语句询问它是哪种报告类型，然后处理特定报告的特殊情况。

我想做的是将每个报告推送到它自己的类文件中，从基础报告页面类继承并根据需要实现自己的特定更改。然后在页面加载期间选择适当的类（我们知道这一点，因为加载页面的菜单选择选择报告类型）作为支持代码。

关于如何实现这一点的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:36:17.033

部分类是最简单的方法，因为您可以移动代码但它仍然都在同一个类中，因此范围不受影响。

重构为单独的类可能是一个更好的主意，但现在听起来您的代码与 aspx 页面紧密耦合——这是您应该同时更改的内容。即使您所有的新类所做的只是返回一个`DataTable`绑定到 GridView 的。

我可能会尝试这样的结构：

aspx -- 收集用户输入的代码，然后实例化正确的报告类和数据绑定。

```
switch(this.ddlReportType.SelectedItem)
{
    case ReportType.UserActivity:
        var uar = new UserActivityReport(this.StartDate, this.EndDate, this.PageSize);
        this.GridView1.DataSource = uar.GetReport();
        break;
} 
```

至于重构您的报告代码，我建议您从简单开始，为每个报告创建一个类。然后随着时间的推移，开始削减公共元素并将它们重构为基类。如果有一些非常明显且易于组合的通用元素，请立即在基类中启动它们，但我会专注于将每个报告放入自己的类中，因为从您的描述来看，它们听起来足够复杂，可以保证.

# c - 在c中修剪字符串时遇到问题

> ID：11905671
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:26:48.267
> 
> 标签：c, string, trim

我使用[这个问题](https://stackoverflow.com/questions/122616/how-do-i-trim-leading-trailing-whitespace-in-a-standard-way)作为在 C 中修剪字符串的指南。它在完全由空格 ( `' '`) 界定的字符串上正常工作，但在特殊空格 ( `'\r'`、`'\n'`、 `'\t'`等) 上，它会失败。这是一个例子：

```
#include <stdio.h>
#include <string.h>

size_t trim(char *out, size_t len, const char *str)
{
  if(len == 0)
    return 0;

  const char *end;
  size_t out_size;

  // Trim leading space
  while(isspace(*str)) str++;

  if(*str == 0)  // All spaces?
  {
    *out = 0;
    return 1;
  }

  // Trim trailing space
  end = str + strlen(str) - 1;
  while(end > str && isspace(*end)) end--;
  end++;

  // Set output size to minimum of trimmed string length and buffer size minus 1
  out_size = (end - str) < len-1 ? (end - str) : len-1;

  // Copy trimmed string and add null terminator
  memcpy(out, str, out_size);
  out[out_size] = 0;

  return out_size;
}

int main(){

    char *str = " \n\n  hello  \t    \r  ";
    char trimmed[strlen(str)];

    trim (trimmed, strlen(trimmed), str);
    printf("~%s~\n~%s~\n", str, trimmed);

    return 0;
} 
```

产生输出：

```
~ 

  ~ello         
~~ 
```

任何人都可以修复代码以正确修剪所有空白字符吗？

第二个问题：引用答案中的第一个函数给了我一个段错误。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:37:27.053

您调用该函数的方式不正确。

```
char *str = " \n\n  hello  \t    \r  ";
char trimmed[strlen(str)+1]; // Note that you must +1 for the terminating \0.

// Use sizeof() instead of strlen() because trimmed is containing garbage.
// strlen() measures the length of the content while sizeof() measure the allocated size of the array.
trim (trimmed, sizeof(trimmed), str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:31:36.647

尝试 isgraph 而不是/除了 isspace

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-02-24T21:17:12.900

> 但在特殊空格（'\r'、'\n'、'\t' 等）上，它会失败。

在 C 中，字符是`unsigned integers`，所以如果你说`white-space`，就会明白`' '`，它的 ASCII 码是十进制的 32 或十六进制的 0x20。你提到的字符**不是**空格！

`' ' != '\r'`

下面是我对 、 和 函数的实现`trim`，`left-trim`分别`right-trim`从字符字符串中删除周围（即前导和尾随）、前导和尾随空格。函数不需要额外的标头，这是最可能的仅依赖整数和指针算术的准系统实现。

您可以根据需要修改代码（在您的情况下，您需要扩展逻辑案例以涵盖您在帖子中提到的`if`其他字符，例如`\r`, `\n`,等）。`\t`

我会将这些函数添加到[我的字符串库 zString](https://github.com/fnoyanisi/zString) :)

```
char *zstring_trim(char *str){
    char *src=str;  /* save the original pointer */
    char *dst=str;  /* result */
    int in_word=0;  /* logical check */
    int index=0;    /* index of the last non-space char*/

    while (*src)
        if(*src!=' '){
         /* Found a word */
            in_word = 1;
            *dst++ = *src++;  /* make the assignment first
                               * then increment
                               */
        } else if (*src==' ' && in_word==0) {
         /* Already going through a series of white-spaces */
            in_word=0;
            ++src;
        } else if (*src==' ' && in_word==1) {
         /* End of a word, dont mind copy white spaces here */
            in_word=0;
            *dst++ = *src++;
            index = (dst-str)-1; /* location of the last char */
        }

    /* terminate the string */
    *(str+index)='\0';

    return str;
}

char *zstring_ltrim(char *str){
    char *src=str;  /* save the original pointer */
    char *dst=str;  /* result */
    int index=0;    /* index of the first non-space char */

    /* skip leading white-spaces */
    for(; *src && *src==' '; ++src, ++index)
        ;

    /* copy rest of the string */
    while(*src)
        *dst++ = *src++;

    /* terminate the string */
    *(src-index)='\0';

    return str;
}

char *zstring_rtrim(char *str){
    char *src=str;  /* save the original pointer */
    char *dst=str;  /* result */
    int index=0;    /* index of the last non-space char*/

    /* copy the string */
    while(*src){
        *dst++ = *src++;
        if (*src!=' ' && *src)
            index = (src-str)+1;
    }

    /* terminate the string */
    *(str+index)='\0';

    return str;
} 
```

# c++ - 使用 Type-Erasure 创建运行时 type_traits 查询

> ID：11905674
> 
> 赞同：5
> 
> 时间：2012-08-10T16:27:03.350
> 
> 标签：c++, templates, type-erasure

是否有可能使用类型擦除来创建封装任意类型的对象（我们称之为`ErasedType`），并且可以在运行时查询以判断另一种任意类型`T`是否可以转换为`ErasedType`？

仔细考虑之后，我认为这是不可能的——尽管它似乎在理论上是可能的*。*编译器会知道`T`我们试图与哪些类型进行比较`ErasedType`，因此可以在运行前生成必要的代码。问题是，实际上，似乎没有*任何*方法可以将模板参数类型从基类实例传递到子类实例。

例如：

```
struct FooBase
{
    template <class TestType>
    bool is_convertible()
    {
        return call_derived();
    }

    protected:

    virtual bool call_derived() = 0;

    template <class ErasedType>
    void base_class_function() { }
};

template <class ErasedType>
struct Foo : public FooBase
{
    bool call_derived()
    {
        // Here we have access to the ErasedType but no access to TestType.
            //
        // We could pass ErasedType to a base class function by saying:
        //
        // this->base_class_function<ErasedType>();
        //
        // ...but that doesn't seem to help since we still don't have access to
        // TestType
    }
}; 
```

所以，我们的目标是能够说类似的话：

```
FooBase* f = new Foo<int>();
bool res1 = f->is_convertible<double>(); // returns true
bool res2 = f->is_convertible<long>(); // returns true
bool res3 = f->is_convertible<std::string>(); // returns false 
```

但是，我看不到该`FooBase::is_convertible`方法是如何实现的，因为我看不到在同一个函数中一起制作`TestType`和`ErasedType`访问的方法，因此编译器可以计算结果`std::is_convertible<TestType, ErasedType>::value`

那么，这有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:06:03.320

*一般来说*，这在 C++ 中确实是不可能的。在运行时对类型进行任意查询需要相当多的元数据，而 C++ 试图保持这种最小化（有时会有点烦人；一个功能可以在“使用时”自动选择加入，所以没有不必要的开销，但我离题了）。

正如 David 所暗示的那样，完全有可能在一定程度上复制编译器信息，但永远不会完全自动。这会将运行时类型信息限制为您手动添加的内容。

看看像[Qt](http://en.wikipedia.org/wiki/Qt_%28toolkit%29)这样的库，它们在 C++ 之上有一个完整的框架来提供这个元数据，看看涉及到什么样的工作。根据手头的问题，您可能可以在没有它的情况下度过难关。

# c# - 如何同时绑定到 ComboBox 中的两个不同的依赖属性？

> ID：11905675
> 
> 赞同：0
> 
> 时间：2012-08-10T16:27:03.447
> 
> 标签：c#, wpf, data-binding, combobox, dependency-properties

我有一个 ComboBox，我已经创建了一个与项目列表的绑定，但是当我尝试绑定所选项目属性时，它什么也没做。当我只绑定 SelectedValueProperty 时，它曾经工作过。该类已经实现了 INotifyPropertyChanged。

```
 public void ComboBoxBinding() {
      Dictionary<long, string> myDictionary = new Dictionary<long, string>
      Control control = new ComboBox();
      comboBoxControl = (ComboBox)control;
      comboBoxControl.SetBinding(ComboBox.ItemsSourceProperty, createFieldBinding("myDictionary"));
      comboBoxControl.DisplayMemberPath = "Value";
      comboBoxControl.SelectedValuePath = "Key";
      binding = createFieldBinding(fieldProperty);
      control.SetBinding(ComboBox.SelectedItemProperty, createFieldBinding("fieldProperty")); // <-- This doesn't seem to bind.
 }

 private Binding createFieldBinding(string propertyName) {
      Binding binding = new Binding(fieldName);
      binding.Source = this.DataContext;
      binding.UpdateSourceTrigger = System.Windows.Data.UpdateSourceTrigger.PropertyChanged;

 return binding;
 } 
```

我设置了一个可以更改字典变量的函数，并且 ComboBox 中的值会更改，但我无法更改 SelectedValueProperty。我怎么做？

编辑：如果我创建字典并手动设置 ItemsSource，它可以工作，但是当我设置绑定时，它不会。

```
 Dictionary<long, string> myDictionary = new Dictionary<long, string>();
 myDictionary.Add(1, "test1");
 myDictionary.Add(2, "test2");
 myDictionary.Add(3, "test3");
 myDictionary.Add(4, "test4");
 myDictionary.Add(5, "test5");
 myDictionary.Add(6, "test6");
 myDictionary.Add(7, "test7");
 myDictionary.Add(8, "test8");
 myDictionary.Add(9, "test9");
 myDictionary.Add(10, "test10");
 comboBoxControl.ItemsSource = myDictionary; //<-- This works, but if I use Binding instead of manually setting the ItemsSource, it does not work 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:44:44.250

```
 public partial class MainWindow : Window, INotifyPropertyChanged
{
    public long SelectedValue { get { return selectedValue; } set { selectedValue = value; Notify("SelectedValue"); } }
    private long selectedValue;
    private Dictionary<long, string> myDictionary;
    public Dictionary<long, string> MyDictionary { get { return myDictionary; } set { myDictionary = value; Notify("MyDictionary"); } }
    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
        ComboBoxBinding();
        MyDictionary = new Dictionary<long, string>() { { 1, "abc" }, { 2, "xyz" }, { 3, "pqr" } };
        SelectedValue = 2;

    }
    public void ComboBoxBinding()
    {
        Control control = new ComboBox();
        comboBoxControl = (ComboBox)control;
        comboBoxControl.SetBinding(ComboBox.ItemsSourceProperty, createFieldBinding("MyDictionary"));
        comboBoxControl.DisplayMemberPath = "Value";
        comboBoxControl.SelectedValuePath = "Key";
       comboBoxControl.SetBinding(ComboBox.SelectedValueProperty, createFieldBinding("SelectedValue"));
    }

    private Binding createFieldBinding(string fieldName)
    {
        Binding binding = new Binding(fieldName);
        binding.Source = this.DataContext;
        binding.UpdateSourceTrigger = System.Windows.Data.UpdateSourceTrigger.PropertyChanged;
        return binding;
    }
    private void Notify(string propName)
    {
        if(PropertyChanged!=null)
            PropertyChanged(this,new PropertyChangedEventArgs(propName));
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
} 
```

您只能绑定属性。字段不能绑定。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T11:51:02.060

它没有绑定的原因是因为我直接在 ViewModel 中定义字典，而不是创建临时字典并将其设置为实现 INotifyPropertyChanged 的​​属性，这会阻止绑定识别成员和属性之间的链接必然。

而不是这样做：

```
 private Dictionary<long, string> _myList = new Dictionary<long, string>();
 public Dictionary<long, string> MyList {
      get { return _myList; }
      set { _myList = value;
            PropertyChanged("MyList"); }
 }

 public void Init() {
      _myList.Add(1, "One");
 } 
```

我必须设置一个临时字典并将其应用于属性。

```
 private Dictionary<long, string> _myList = new Dictionary<long, string>();
 public Dictionary<long, string> MyList {
      get { return _myList; }
      set { _myList = value;
            PropertyChanged("MyList"); }
 }

 public void Init() {
      Dictionary<long, string> tempList = new Dictionary<long, string>();
      tempList.Add(1, "One");
      MyList = tempList;
 } 
```

# c# - 模拟（起订量）或覆盖密封类中的只读属性？

> ID：11905678
> 
> 赞同：4
> 
> 时间：2012-08-10T16:27:06.253
> 
> 标签：c#, unit-testing, mocking, tdd, moq

我有一种情况，在 MS Dynamics Crm 中，它使用密封类和只读属性返回一些对象（我只能假设使用内部构造函数或内部属性集）。而且这些人不会从我可以使用的界面继承。显然，如果我可以控制这段代码，我将拥有更多的控制权，但因为它位于底层的 MS Dynamics 框架中，所以我有点卡住了。

我想模拟/覆盖的类称为[AliasedValue](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.aliasedvalue.aspx)。我想模拟它的原因是我试图模拟对动态的调用并想假装我正在返回一些别名值。

所以这是场景，我想创建一个 Dynamics 将返回的示例实体......像这样：

```
var new_entity = new Entity("new_entity")
    {
        Attributes = new AttributeCollection
            {
                {"new_name", "BR"},
                {"createdon", DateTime.Now.AddDays(-1).Date},
                {"new_field", "My field"},
                {"new_contact", new AliasedValue {*****} }
            }
    }; 
```

所以我引用了一个“联系人”实体（实时返回为 AliasedValue）。在测试时，我想确保我的代码处理可能会在该字段中返回的某些值（例如，它知道如何处理别名值，并且如果没有返回链接的联系人，它就不会爆炸，等等）。

因此，如果您单击 AliasedValue 的链接，您会注意到属性是只读的……所以我无法设置测试数据……

接下来，我要创建自己的类并覆盖整个东西......但它是密封的......

最重要的是，正如您可能已经猜到的那样，Moq 不喜欢尝试模拟密封类。

我读过我需要购买一些“更好”的模拟框架来做到这一点，但我真的不想为了解决这件事而花一些额外的钱。

任何人都为我提供了一个很好的小解决方案来解决这个问题？

**更新澄清**

* * *

如何返回的示例如下。我有一项服务将被模拟以返回上述对象。或者它实际返回的是一个包含上述对象的集合。所以这就像这样：

```
var service = new Mock<IOrganizationService>();
service
    .Setup(s => s.RetrieveMultiple(null))
    .Returns(new EntityCollection (new List<Entity> {new_entity})); 
```

太好了，我可以返回上面的实体并用它做我想做的事。因此，在我创建了上述实体并通过我的模拟服务返回它之后，我在我的“EntityCollection”中得到了上述内容。一旦我有了我的实体，我就可以按如下方式访问该属性：

```
var aliasedContact = (AliasedValue)new_entity.Attributes["new_contact"]; 
```

也许我很傻，但我不太明白答案（由 Lunivore 提供）将如何解决这个问题......（添加评论以获得反馈......）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:35:00.043

通过添加一个非常简单的适配器类从第三方库中抽象出来，您可以通过检查对其进行测试。与其扩展你的目标类，不如在它之上编写你的新类。它可以具有相同的方法名称、相同的属性等（尽管不是必须的）——它只是委托给密封类。

如果您有一个返回密封类的类，请将它们都包装起来。所以它可能看起来像这样：

```
var crmWrapper = new MSDynamicsCrmWrapper(_myMsDynamicsCrm);
var entityWrapper = crmWrapper.AliasedValue(url); 
```

crmWrapper 将执行以下操作：

```
public EntityWrapper AliasedValue(Url url) 
{
    var entity = delegateCrm.AliasedValue(url);
    return new EntityWrapper(entity);
} 
```

简单的。您只需要委托您实际使用的那些方法。

这不仅可以让您模拟该类，还可以让您控制，例如，下一个版本的 MS Dynamics 是否会稍微更改 API，或者出现奇怪的行为或性能不佳。此外，您正在将 API 范围缩小到您实际使用的部分，因此代码甚至可能更易于维护。

计算中没有什么是另一层抽象无法解决的……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:31:12.800

为了模拟密封类，非虚拟方法或静态成员通常需要一个基于分析器的模拟框架，以便能够拦截所有调用。我所知道的唯一可以做到这一点并且它不是商业的框架是[Microsoft Moles](http://research.microsoft.com/en-us/projects/moles/)。

对于 Visual Studio 2012，Moles 已重命名为 Fakes，并将包含在安装中。对于 Visual Studio 2010，您需要单独下载。由于它是一个基于探查器的框架，您需要使用他们的运行器运行您的测试，`moles.runner.exe`以便它可以设置探查器。

不久前，我写了一篇博客文章，描述了在 Moles 下运行 NUnit 测试的过程，您可以在以下位置查看：

[使用 NUnit 和 Moles Redux 进行单元测试](http://exceptionalcode.wordpress.com/2011/10/15/unit-testing-with-nunit-and-moles-redux/)

另一种选择是遵循 Lunivore 答案的指示并添加一个抽象层。我自己更喜欢用工具来解决这个问题，但我必须提前告诉你，Moles 并不是那么容易使用。其他基于分析器的模拟框架，如[TypeMock Isolator](http://www.typemock.com/)或[JustMock](http://www.telerik.com/products/mocking.aspx/)可能更容易使用，但它们是商业解决方案。

# java - KeyManagerFactory 无法恢复密钥，但它在 keytool 中打开

> ID：11905682
> 
> 赞同：0
> 
> 时间：2012-08-10T16:27:21.163
> 
> 标签：java, ssl, keystore

```
String keyStorePath = "2keystore.jks";
String keyStoreType = "JKS";
String keyStorePassword = "mypass";

KeyStore keyStore = KeyStore.getInstance(keyStoreType);
InputStream ksis = ClassLoader.getSystemResourceAsStream(keyStorePath);
keyStore.load(ksis, keyStorePassword.toCharArray());
ksis.close();
// Above seems to work fine

KeyManagerFactory kmf =
      KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
  kmf.init(keyStore, keyStorePassword.toCharArray());

// Above throws exception:
// UnrecoverableKeyException: Cannot recover key 
```

然而，使用 keytool，我可以查看如下内容`2keystore.jks`：

```
keytool -list -v -keystore 2keystore.jks | more
Enter keystore password:  mypass
Keystore type: JKS
Keystore provider: SUN

Your keystore contains 3 entries

Alias name:
... 
```

知道尝试将此密钥库加载到 中时可能出现什么问题`KeyManagerFactory`吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:34:37.417

原来我不得不为.`KeyStore`而不是`KeyManagerFactory`.

这是我在创建 KeyStore 文件时犯的一个错误。我使用[Portecle](http://portecle.sourceforge.net/)将我的 PKCS#12 密钥转换为 JKS，它将 KeyStore 内的密钥对的密码重置为“密码”，但在第一次复飞时我错过了这个。

因此，使用 Portecle，我能够将整个 KeyStore 中包含的密钥对上的密码重置为我期望的值，然后一切正常。

谢谢布鲁诺

# objective-c - 我可以编写与 ruby 混合的 Objective-c 代码吗？

> ID：11905684
> 
> 赞同：0
> 
> 时间：2012-08-10T16:27:43.430
> 
> 标签：objective-c, ruby, xcode, cocoa

我正在开发一个 mac 程序，一些代码非常相似，所以我想使用 ruby​​ 的元编程功能来简化它。

我可以在我的原始 xcode 项目中混合 ruby​​ 代码吗？

我用谷歌搜索了一个名为 MacRuby 的项目，但它似乎不是我想要的。因为我只想在我的 Objective-C 项目中嵌入一些 ruby​​ 代码或一两个 ruby​​ 文件，而不是使用整个 ruby​​ 项目。

有人有什么想法吗？

顺便说一句，我正在使用 cocos2d 框架。

所以我希望解决方案不会影响我原来的项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:01:50.917

XCode 由 Apple 开发，仅识别 Objective-C。这不像 Eclipse，您可以混合不同的解释器和编译器。

您可以在 Ruby 上创建一个 HTML Web 应用程序，在 HTTP 服务器上运行它并从您的 iPhone/iPad 应用程序访问。

# android - Android 编程教程 - 教程 5

> ID：11905689
> 
> 赞同：0
> 
> 时间：2012-08-10T16:28:02.567
> 
> 标签：android, commonsware

您好，我正在做“Android 编程教程”一书中的教程，我在理解教程 5 时遇到问题。这是主要的 Java 类：

```
package tiago.tutorial;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.view.LayoutInflater;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.ListView;
import android.widget.RadioGroup;
import android.widget.TextView;
import java.util.ArrayList;
import java.util.List;

public class Now extends Activity {
  List<Restaurant> model = new ArrayList<Restaurant>();
  RestaurantAdapter adapter = null;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button save = (Button) findViewById(R.id.save);

    save.setOnClickListener(onSave);

    ListView list = (ListView) findViewById(R.id.restaurants);

    adapter = new RestaurantAdapter();
    list.setAdapter(adapter);
  }

  private View.OnClickListener onSave = new View.OnClickListener() {
    public void onClick(View v) {
      Restaurant r = new Restaurant();

      EditText name = (EditText) findViewById(R.id.name);
      EditText address = (EditText) findViewById(R.id.addr);

      r.setName(name.getText().toString());
      r.setAddress(address.getText().toString());

      RadioGroup types = (RadioGroup) findViewById(R.id.types);

      switch (types.getCheckedRadioButtonId()) {
        case R.id.sit_down:
          r.setType("sit_down");
          break;

        case R.id.take_out:
          r.setType("take_out");
          break;

        case R.id.delivery:
          r.setType("delivery");
          break;
      }

      adapter.add(r);
    }
  };

  class RestaurantAdapter extends ArrayAdapter<Restaurant> {
    RestaurantAdapter() {
      super(Now.this, R.layout.row, model);
    }

    public View getView(int position, View convertView, ViewGroup parent) {
      View row = convertView;
      RestaurantHolder holder = null;

      if (row==null) {                          
        LayoutInflater inflater = getLayoutInflater();

        row=inflater.inflate(R.layout.row, parent, false);
        holder = new RestaurantHolder(row);
        row.setTag(holder);
      }
      else {
        holder = (RestaurantHolder) row.getTag();
      }

      holder.populateFrom(model.get(position));

      return(row);
    }
  }

  static class RestaurantHolder {
    private TextView name = null;
    private TextView address = null;
    private ImageView icon = null;

    RestaurantHolder(View row) {
      name = (TextView) row.findViewById(R.id.title);
      address = (TextView) row.findViewById(R.id.address);
      icon = (ImageView) row.findViewById(R.id.icon);
    }

    void populateFrom(Restaurant r) {
      name.setText(r.getName());
      address.setText(r.getAddress());

      if (r.getType().equals("sit_down")) {
        icon.setImageResource(R.drawable.ball_red);
      }
      else if (r.getType().equals("take_out")) {
        icon.setImageResource(R.drawable.ball_yellow);
      }
      else {
        icon.setImageResource(R.drawable.ball_green);
      }
    }
  }
} 
```

我现在真正的疑问是 \getView()\ 方法在哪里被调用过？这是有效的，但在代码中我无法理解它何时被调用。如果有人熟悉这本书，请您快速解释一下这段代码中发生了什么？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:32:00.683

`getView()`当某些东西试图创建与`View`that 中的元素关联的 时，基本上会调用它`ArrayAdapter`。

它将返回`View`为`ArrayAdapter`.

* * *

之前有人问过类似的问题，看看这个[问题是否](https://stackoverflow.com/questions/10160475/when-getview-in-arrayadapter-is-called)对你有帮助。

关于这个主题的另一个很棒的[教程](http://www.vogella.com/articles/AndroidListView/article.html)可能有助于解释正在发生的事情`Adapaters`。

# regex - 我如何使用 formcheck ？正则表达式：日期

> ID：11905691
> 
> 赞同：1
> 
> 时间：2012-08-10T16:28:02.003
> 
> 标签：regex, mootools

如何使用 formcheck 检查 dd/mm/yyyy 格式的日期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:30:15.030

`(\d){2}/(\d){2}/(\d){4}`用于简单检查是否有 2 天数字等。

但是，要更全面地检查它实际上是一个有效日期，请使用：

```
((([012](\d))|(3)[01])/((0[1-9])|((1)[012]))/((\d){4})) 
```

# jquery - Fancybox 不适用于 Rhinoslider

> ID：11905693
> 
> 赞同：1
> 
> 时间：2012-08-10T16:28:15.630
> 
> 标签：jquery, fancybox

我的网站[http://www.belovedstreets.org/test.html](http://www.belovedstreets.org/test.html)有一个工作的 Rhinoslider，它首先显示链接图像，然后显示一些 DIV 内容。DIV 内容有几个 Fancybox 点击（星号和横幅中的文本） - 请参阅[http://www.belovedstreets.org/home.html](http://www.belovedstreets.org/home.html)了解它应该如何工作。

在 Rhinoslider 中，一切都正常显示，但 Fancybox 的东西根本不起作用。

我找到了这个（http://stackoverflow.com/questions/10813209/fancybox-and-nivo-slider-on-one-page-not-working）其他帮助页面并尝试了一些东西......但我仍然不能似乎让我的工作。

希望它是一个简单的修复？

# html - 如何在 div 中居中 img

> ID：11905694
> 
> 赞同：1
> 
> 时间：2012-08-10T16:28:28.850
> 
> 标签：html, css, margin

我正在尝试一些应该很容易的东西，但我不知道怎么做。

我有这样的html源：

```
<div class="product">
  <img src="product123.png" />
</div>` 
```

还有一些CSS：

```
.product {
    width: 460px;
    height: 460px;
}

.product img {
      margin: auto;
      display: block;
} 
```

我的图像水平对齐但不是垂直对齐。我尝试了一些`position: relative; / bottom: 0;`功能，但它没有改变任何东西......

有什么想法吗？

谢谢您的帮助 ！

PS：我在[带有 CSS 的 <DIV> 中找到了这个解决方案中心 <IMG/>，](https://stackoverflow.com/questions/4958385/center-img-inside-a-div-with-css)但我宁愿保持这样的 HTML，而且无法以“我的”方式做到这一点似乎令人难以置信。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T16:33:31.613

试试这个 - [http://jsfiddle.net/tG9UK/](http://jsfiddle.net/tG9UK/)

```
.product {
    width: 460px;
    height: 460px;

    display: table-cell;
    vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:37:49.003

```
.product {
    width: 460px;
    height: 460px;
    line-height:460px;
    text-align:center;
} 
```

[http://jsfiddle.net/EHTeL/1/](http://jsfiddle.net/EHTeL/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:38:50.343

如果图像尺寸是静态的，那么这样的东西对你有用

```
.product img {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 300px;
   height: 300px;
   margin-top: -150px; /* Half the height */
   margin-left: -150px; /* Half the width */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T16:37:14.603

如果你想垂直和水平居中，你应该能够应用 display: table-cell 到 div 并使用 vertical-align

```
.product {
    display: table-cell;
    vertical-align: middle;
    text-align: center;
    width: 460px;
    height: 460px;
}
.product img {
    margin: auto;
    display: block;
} 
```

# xml - 如何返回动态 XML 文件以在 VB.net 中使用

> ID：11905696
> 
> 赞同：3
> 
> 时间：2012-08-10T16:28:32.003
> 
> 标签：xml, vb.net

我有 10 台计算机（Windows 7）通过 LAN 相互连接。其中一个安装了 Apache 服务器。其他计算机将安装 VB.net 应用程序，该应用程序将从该服务器计算机请求数据。

我正在考虑使用 XML 在服务器和客户端计算机之间传输数据。我可以从 VB.net 客户端应用程序请求一个 php 文件，然后 php（来自服务器）每次都会创建动态 XML 文件吗？

这个返回的 XML 必须由 VB.net 解析。如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:12:54.853

请参阅有关在 VB 中使用 XElement 解析 XML 的类似问题的答案： [https ://stackoverflow.com/a/11906969/1539015](https://stackoverflow.com/a/11906969/1539015)

请注意，XElement.Load() 中 xml 的路径可以是类似“ [http://apacheserver/](http://apacheserver/) ...”的 URI。

# html - 如何从页面中心定位 div 'x' 像素？

> ID：11905699
> 
> 赞同：0
> 
> 时间：2012-08-10T16:28:45.990
> 
> 标签：html, position, center, pixel, pixels

我想`<div>`相对于页面中心定位给定数量的像素。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:34:24.047

您可以使用`$(window).width() / 2`来获得水平中心...例如：

```
$('.myDiv').css({left: ($(window).width() / 2) - 50}) 
```

你会得到`div` `50px`中心的左边

# python - 用于 python 片段的 vim 正确缩进

> ID：11905705
> 
> 赞同：2
> 
> 时间：2012-08-10T16:29:16.083
> 
> 标签：python, vim, insert

在编辑 Python 代码时，我很难使用 vim**智能**缩进 vim 功能。一般来说，我喜欢`:set nocompatible`vim 中的选项，以及`:set autoindent`(and/or `:set smartindent`)。一切都很好，除了一个非常烦人的行为。假设您编写了一些代码，然后想插入您从其他地方获取的 Python 代码片段。python 代码片段可能包含注释，例如

```
# comment1
a=1
# comment2
b=1 
```

在 vim 中，当您进入插入模式（例如键入`o`）并粘贴代码时，vim 会做**太多**缩进代码的工作，而不是您的代码片段

```
# comment1
# a=1
# # comment2
# b=1 
```

因此它会在第一条评论之后插入额外的评论（井号）并将其保留给代码片段的其余部分。现在想象一下你有很长的代码片段，不同的标识，你可以想象你的粘贴操作看起来有多丑*（代码将被不正确的缩进和注释）*。

有什么办法可以解决吗？

我解决问题的唯一方法是将 vim 兼容模式与`noautoindent`选项一起设置，然后粘贴代码片段。这样做会正确插入（原样）。`nocompatible`但是在模式（ vs ）之间切换`compatible`太多了（叫我懒惰，但它应该是一种在`nocompatible`模式中正确插入带有注释的片段的方法）。设置模式没有任何区别*（问题仍然存在）*`noautoindent`，所以它与兼容/不兼容模式有关。`nocompatilbe`

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:31:45.247

你想要的选项是

```
set paste 
```

这会将您想要的内容粘贴为原始内容。*

# jquery - jquery.event.drag TypeError: $event.fixHooks 未定义

> ID：11905709
> 
> 赞同：4
> 
> 时间：2012-08-10T16:29:36.823
> 
> 标签：jquery, drag-and-drop, carousel

我正在玩 jquery 的环形交叉路口插件。我想添加 3dubs 拖放插件来增强它，但我不断收到 $event.fixHooks 错误。有人可以解释那个错误是什么以及是否有修复？

这是我的代码：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
<script src="js/jquery.roundabout.min.js"></script>
<script src="js/jquery.event.drag-2.2.js"></script> 
<script src="js/jquery.event.drop-2.2.js"></script> 
<script type='text/javascript'>

    $(document).ready(function() {

      $('ul').roundabout();
   });
</script>

<style type="text/css">

* { 

    padding: 0;
    margin: 0;
    border: 0;
}

#carousel { 

    margin: 300px 0 0 100px;
    text-align: center;
}

.roundabout-holder {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  height: 200px;
  width: 800px;
}

.roundabout-moveable-item {
  height: 200px;
  width: 300px;
  cursor: pointer;
  background-color: #ccc;
  border: 1px solid #999;
}

.roundabout-in-focus {
  cursor: auto;
}
</style> 

<title>Round About Test</title>
</head>

<body>

<div id="carousel">

    <ul>
        <li>Carousel Item 1</li>
        <li>Carousel Item 2</li>
        <li>Carousel Item 3</li>
        <li>Carousel Item 4</li>
        <li>Carousel Item 5</li>
        <li>Carousel Item 6</li>
    </ul>
</div>

</body>
</html> 
```

这是完整的错误：

```
TypeError: $event.fixHooks is undefined

 filter: function( event, orig ) { 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T16:43:12.777

您需要使用 jQuery >= 1.7 和 < 3.*

jQuery 1.6.2中没有`fixHooks`。

在插件的主页上应该会提到所需的 jQuery 版本。

# c++ - ENet 如何管理其到达的数据包？

> ID：11905714
> 
> 赞同：4
> 
> 时间：2012-08-10T16:29:46.260
> 
> 标签：c++, c, networking, network-programming

ENet 是一个 UDP 网络库，这里有一个教程[http://enet.bespin.org/Tutorial.html](http://enet.bespin.org/Tutorial.html)

如果我在一段时间内没有调用 enet_host_service() 会发生什么，但是数据包在我没有“服务”时到达了机器上？他们是否在某处缓冲，等待调用 enet_host_service() ？

该教程还指出我可以用 0 超时调用这个函数，这意味着如果它不等待，它必须读取一个缓冲区......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T10:06:59.217

我很确定数据包会在*操作系统中*缓冲，直到您调用`enet_host_service()`，因为在您这样做之前，enet 根本无法做任何事情。它完全死了，只要你自己的代码在运行，它的状态就不会改变。

当您调用`enet_host_service()`时，它将使用套接字 API 从操作系统检索 UDP 数据包，然后，它们可能由 enet 本身缓冲（如果有多个“事件”或“数据包”），因为`enet_host_service()`允许您处理一次一个事件（虽然它很可能从操作系统的数据中接收多个事件）。

因此，您应该`enet_host_service()`尽可能频繁地调用，因为操作系统会在其缓冲区已满时简单地丢弃传入的数据包。

# java - 在特定日期和时间创建警报

> ID：11905715
> 
> 赞同：2
> 
> 时间：2012-08-10T16:29:47.083
> 
> 标签：java, android, events, notifications, alarm

我正在尝试在某个时间和日期发出警报或通知。我希望能够为数组中的特定日期设置多个警报。我不知道在哪里继续让我的按钮工作：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //Button button = (Button)findViewById(R.id.button1);
   // button.setOnClickListener(this);
    final CheckBox checkBox = (CheckBox) findViewById(R.id.checkBox1);
    final Button button = (Button) findViewById(R.id.button1);
    button.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v) {

             if (checkBox.isChecked()) {

             }

        } 
```

预先感谢您帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:32:24.647

您将要使用[警报管理器](http://developer.android.com/reference/android/app/AlarmManager.html)

本[教程](http://justcallmebrian.com/?p=129)是一个非常简单的示例，如何使用它。

另一个简单的[例子](http://n8tech44.blogspot.com/2012/06/using-android-alarmmanager-to-schedule.html)，将其分解为基本步骤

1.  创建事件
2.  创建一个 BroadcastReceiver 来处理事件

**编辑**
要发出通知，请修改广播接收器以在收到警报事件时创建通知。

[Android 状态通知文档](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)很好地展示了创建通知的基本步骤。

1.  获取对 NotificationManager 的引用
2.  创建通知实例。然后，您可以定义图像、文本和时间，这只是当前时间，因为警报事件已经定义了何时响起
3.  定义点击时启动的消息和意图等通知内容
4.  拨打通知

字符串 ns = Context.NOTIFICATION_SERVICE；
NotificationManager mNotificationManager = (NotificationManager) receiverContext.getSystemService(ns);

```
Notification notification = new Notification(R.drawable.notification_icon, "Hello", System.currentTimeMillis());

CharSequence contentTitle = "My notification";  
CharSequence contentText = "Hello World!";  
Intent notificationIntent = new Intent(receiverContext, TargetActivity.class);  
PendingIntent contentIntent = PendingIntent.getActivity(receiverContext, 0, notificationIntent, 0);  

notification.setLatestEventInfo(receiverContext, contentTitle, contentText, contentIntent);  

private static final int notificationID = 1;

mNotificationManager.notify(notificationID, notification); 
```

**编辑 2**
[使用警报管理器在指定时间创建通知](http://n8tech44.blogspot.com/2012/08/using-alarmmanager-to-schedule.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:30:17.757

你可以这样尝试：

```
ArrayList<Calendar> alarmTimes = getAlarmTimes(); //Make your own function which returns alarm times as an array of Calendar type

for(int i=0; i<alarmTimes.size(); i++)
{
    Intent intent = new Intent(this, YourClass.class);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this.getApplicationContext(), requestCode, intent, PendingIntent.FLAG_UPDATE_CURRENT | Intent.FILL_IN_DATA);
    AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
    alarmManager.set(AlarmManager.RTC_WAKEUP, alarmTimes[i].getTimeInMillis(), pendingIntent);
} 
```

如果您想独立处理每个警报，请为每个警报使用不同的**requestCode**。此外，您可能想查看在**alarmManager.set()**函数中使用的不同标志。根据您的应用程序需要修改它们。

[http://developer.android.com/reference/android/app/PendingIntent.html](http://developer.android.com/reference/android/app/PendingIntent.html)

您将必须创建一个 AlarmReceiver 类，该类将在警报响起时处理您想做的任何事情（确保在 AndroidManifest 中添加此类作为**接收器**）。如果您想发送额外的信息和警报，那么您可以使用这样的*意图附加功能*：

```
intent.putExtra("info1", value1);
intent.putExtra("info2", value2); 
```

其中**info1**是额外数据的名称，而 value1 是您发送的值。

希望这可以帮助！

编辑：

```
ArrayList<Calendar> alarmTimes = new ArrayList<Calendar>();

Calendar calendar = Calendar.getInstance();
calendar.set(CALENDAR.MONTH, 7);
calendar.set(CALENDAR.DAY_OF_MONTH, 17);
calendar.set(CALENDAR.HOUR_OF_DAY, 13);
calendar.set(CALENDAR.MINUTE, 0);

alarmTimes.add(calendar);

//Repeat the above code for all alarm times and then return array object
return alarmTimes; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-19T18:28:13.640

```
 Calendar cal = Calendar.getInstance(); //retrieves a calendar object w/ current time
        cal.add(cal.MINUTE, 1); //adds 1 minute to current time

    Intent alarmIntent = new Intent(this, CustomAlarmReceiver.class); 

    /* creates a new PendingIntent using the static variable eventID. 
     *  using eventID allows you to create multiple events with the same code
     *  without a unique id the intent would just be updated with new extras each time its created
     */
    PendingIntent pendingAlarm = PendingIntent.getBroadcast(this, eventID, alarmIntent, 
      PendingIntent.FLAG_UPDATE_CURRENT);
    eventID+=1; 

    /* get the Alarm service and set the alarm with the time to go off and what to do when the
     * alarm is received */
    AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
    am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingAlarm);
    Intent intent1=new Intent(getApplicationContext(),ListActivity.class);
    startActivity(intent1);
    intent1.putExtra("date", date);
    intent1.putExtra("task", message);
              } 
```

# java - ServerSocket.accept() 返回的 Java 客户端套接字

> ID：11905717
> 
> 赞同：4
> 
> 时间：2012-08-10T16:29:49.257
> 
> 标签：java, sockets, networking, tcp, port

这更像是一个一般的套接字问题。在 Java 中，如果我有一个绑定到特定端口的 ServerSocket，比如 4444，我知道它正在侦听连接请求。accept() 方法阻塞，直到收到连接请求并返回一个新的 Socket 与客户端通信。返回的 Socket 的远程端点是客户端的 IP 地址和端口。

但是，我感到困惑的是，返回的 Socket 的本地端口与正在侦听请求的 ServerSocket 的端口号相同（在本例中为 4444）。我以为两个套接字不能绑定到同一个端口？返回的 Socket 不会是服务器上的不同端口吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:37:09.497

两个 ServerSocket 不能监听相同的 IP 地址和端口。可能有两个 ServerSockets 监听不同的 IP 和相同的端口。

本地和远程的两个套接字不能具有相同的 IP 和端口。如果远程 IP 和端口不同，许多 Socket 的本地端口可以相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:38:32.497

您不能使用多个套接字来*侦听*给定的 IP：端口组合，但可以存在多个接受的到同一组合的连接。

连接由本地 IP 地址和端口以及远程 IP 地址和端口的组合来标识。

# java - Java - 基于一些代码创建接口

> ID：11905718
> 
> 赞同：1
> 
> 时间：2012-08-10T16:29:52.283
> 
> 标签：java, interface, constructor

![在此处输入图像描述](../Images/37338ba7cc23b80406330cf0e6c41622.png)

嗨，只是想看看我是否正确理解了这个问题。

（一世）

```
public interface Coordinate {

    public double getDegrees();

    public double getMinutes();

    public double getSeconds();

    public String getDirection();

} 
```

(ii) 我可以使用抽象类而不是接口并使用 Latitude 类来扩展抽象类吗？（不太确定为什么这是有利的？是因为我可以选择我想使用的方法，而不是被迫使用已实现的方法）

㈢`public class Latitude implements Coordinate {}`

(四)`public class Latitude extends Coordinate{}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:34:34.303

`-1`并且`0`不是`int`_`double`

`'S'`不是`char`一个`String`

> 我可以使用抽象类而不是接口吗

除了 a`class`和 an之外，`abstract class`您还可以使用不明显的咒语。

```
public @interface Coordinate {
    public int getDegrees();
    public int getMinutes();
    public double getSeconds();
    public char getDirection();
}

static class Location implements Coordinate {
    @Override
    public int getDegrees() {
        return 0;
    }

    @Override
    public int getMinutes() {
        return 0;
    }

    @Override
    public double getSeconds() {
        return 0;
    }

    @Override
    public char getDirection() {
        return 0;
    }

    @Override
    public Class<? extends Annotation> annotationType() {
        return Location.class;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:35:33.037

(i) 仔细检查您的方法的返回类型。请记住，`String`s 用双引号 ( `""`) 括起来。用单引号 ( `''`) 括起来的类型是什么？

(ii) 是的，这听起来不错。一个优点是您可以在抽象类中提供默认实现，但不能在接口中提供。通常在 Java 中，我们同时使用两者以从两者中获得优势。

# java - java.lang.NoClassDefFoundError: org/hibernate/cache/EntityRegion 配置 EHCache

> ID：11905722
> 
> 赞同：23
> 
> 时间：2012-08-10T16:30:32.770
> 
> 标签：java, hibernate, maven, configuration, ehcache

我正在尝试将`ehcache`（v2.6.0）添加到我的`Hibernate 4.1.5.SP1`项目中，但有一些配置问题。具体来说，当我尝试使用构建配置时出现`java.lang.NoClassDefFoundError`:错误`org/hibernate/cache/EntityRegion``Hibernate`

```
 <property name="hibernate.cache.use_second_level_cache">true</property>
<property name="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</property> 
```

这是我的*Maven*依赖项...

```
 <hibernate.version>4.1.5.SP1</hibernate.version>
    <hibernate.validator.version>4.3.0.Final</hibernate.validator.version>
    <ehcacheVersion>2.6.0</ehcacheVersion>
    ...
    <!-- Hibernate dependencies -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>${hibernate.validator.version}</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${hibernate.version}</version>
    </dependency>
    <dependency>
        <groupId>net.sf.ehcache</groupId>
        <artifactId>ehcache-core</artifactId>
        <version>${ehcacheVersion}</version>
    </dependency> 
```

这是我用来配置它的Java代码......

```
 Configuration config = new Configuration()
        .setProperty("hibernate.dialect", "org.hibernate.dialect.HSQLDialect")
        .setProperty("hibernate.connection.driver_class", "org.hsqldb.jdbcDriver")
        .setProperty("hibernate.connection.url", "jdbc:hsqldb:mem:myprojectTestDb")
        .setProperty("hibernate.connection.username", "sa")
        .setProperty("hibernate.connection.password", "")
        .setProperty("hibernate.connection.pool_size", "1")
        .setProperty("hibernate.connection.autocommit", "true")
        .setProperty("hibernate.cache.provider_class", "org.hibernate.cache.HashtableCacheProvider")
        .setProperty("hibernate.hbm2ddl.auto", "create-drop")
        .setProperty("hibernate.show_sql", "true")
        .setProperty("hibernate.current_session_context_class", "thread")
        .setProperty("hibernate.cache.use_second_level_cache", "true")
        .setProperty("hibernate.cache.region.factory_class", "net.sf.ehcache.hibernate.EhCacheRegionFactory")
        .addAnnotatedClass(Organization.class)
        .addAnnotatedClass(State.class) 
        .addAnnotatedClass(Country.class)
        .addAnnotatedClass(Domain.class)
        .addAnnotatedClass(Community.class);
    final ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(config.getProperties()).buildServiceRegistry();
    sessionFactory = config.buildSessionFactory(serviceRegistry); 
```

这是可怕的错误。我缺少什么配置？

```
java.lang.NoClassDefFoundError: org/hibernate/cache/EntityRegion
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Unknown Source)
    at java.lang.Class.getConstructor0(Unknown Source)
    at java.lang.Class.getConstructor(Unknown Source)
    at org.hibernate.cfg.SettingsFactory.createRegionFactory(SettingsFactory.java:386)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:251)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2270)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2266)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1735)
    at org.mainco.subco.orgsclient.service.OrganizationServiceTest.setupOrgServiceTest(OrganizationServiceTest.java:56)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.ClassNotFoundException: org.hibernate.cache.EntityRegion
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 32 more 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-11T06:50:24.043

ehcache-core 文件基本上适用于 Hibernate 3.x。Hibernate 4.x 带有自己的 ehcache 实现。您不需要在 hibernate 4.x 中显式使用 ehcache。这是您问题的最佳答案。

[http://web.archive.org/web/20130117102553/http://www.javacraft.org/2012/03/migrate-to-hibernate-4-ehcache.html](http://web.archive.org/web/20130117102553/http://www.javacraft.org/2012/03/migrate-to-hibernate-4-ehcache.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-19T08:50:48.807

我检查了maven的依赖关系。Maven 总是在加载 hibernate-ehcache 包时加载 ehcache-code。

依赖树：

```
+--- org.hibernate:hibernate-ehcache:4.3.0.Final
|    +--- org.jboss.logging:jboss-logging:3.1.3.GA
|    +--- org.jboss.logging:jboss-logging-annotations:1.2.0.Beta1
|    +--- org.hibernate:hibernate-core:4.3.0.Final (*)
|    \--- net.sf.ehcache:ehcache-core:2.4.3
|         \--- org.slf4j:slf4j-api:1.6.1 -> 1.6.6 
```

请检查您的持久性配置。它不应包含任何包名以“net.sf”开头的类

例如，您必须在代码中替换以下字符串：

```
.setProperty("hibernate.cache.region.factory_class", "net.sf.ehcache.hibernate.EhCacheRegionFactory") 
```

使用以下字符串：

```
.setProperty("hibernate.cache.region.factory_class", "org.hibernate.cache.ehcache.EhCacheRegionFactory") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-22T19:05:09.863

```
Configuration.setProperty("hibernate.cache.region.factory_class", 
                     "net.sf.ehcache.hibernate.EhCacheRegionFactory") 
```

对于休眠 4，使用

```
org.hibernate.cache.ehcache.EhCacheRegionFactory instead of net.sf.ehcache.hibernate.EhCacheRegionFactory 
```

[休眠配置文章](https://terracotta.org/generated/4.2.0/html/bmg-all/index.html#page/BigMemory_Go_Documentation_Set/co-hib_enable_second_level_cache_settings.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-11T11:50:14.663

从 Hibernate 4 开始，为缓存引入了新的 hibernate-cache。这需要`net.sf.ehcache`高达 2.6 的最新依赖项。以下文章将[点击链接](http://architects.dzone.com/articles/hibernate-4-and-ehcache-higher)。当我在我的 pom 中添加以下依赖项时，错误将删除：

```
 <dependency>
        <groupId>net.sf.ehcache</groupId>
        <artifactId>ehcache</artifactId>
        <version>2.8.3</version>
    </dependency> 
```

# common-lisp - Common Lisp：遍历列表中连续对的最佳方法是什么？

> ID：11905723
> 
> 赞同：6
> 
> 时间：2012-08-10T16:30:33.363
> 
> 标签：common-lisp

有时我需要遍历列表中的连续对。我现在的做法是

```
(loop for x on lst while (not (null (cdr x)))
       (do something on (car x) and (cadr x))) 
```

我想知道是否有更好/内置的方法来做到这一点。

我需要这个的原因有时是我想要的，例如一些添加连续对的函数

```
(1 2 3 4 5) ----> (3 5 7 9) 
```

有没有像 reduce 这样的内置函数可以让我得到这个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T17:04:23.363

AFAIK，没有内置功能可以做你想做的事。您可以尝试将某些东西与 放在一起`maplist`，但我的第一直觉也是伸手`loop`去拿。

不过，只是对您所拥有的内容进行了一些说明。首先，`(not (null foo))`等价`foo`于 CL，因为非`NIL`值被`t`布尔运算处理。其次，`loop`可以解构它的论点，这意味着你可以更优雅地把它写成

```
(loop for (a b) on lst while b
      collect (+ a b)) 
```

该`maplist`版本看起来像

```
(maplist 
   (lambda (rest) 
     (when (cdr rest) 
        (+ (first rest) (second rest)))
   lst) 
```

我认为它的可读性较差（这也会返回 NIL 作为其结果的最后一个元素，而不是在此之前结束）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T06:43:31.597

我相信 Paul Graham 在 OnLisp 中有一个名为 map-tuple 的函数来执行此操作。它可以按 cdr、cddr 或任何您喜欢的方式在列表中向下移动。这是它的注释版本。它使用他的照应 if 宏 **aif**。

```
(defun map-tuple (someList f &optional (by #'cdr))
 "(map-tuple someList f &optional (by #'cdr))
   f is a function that takes two args, returns one val (maybe)
   the map-tuple will collect all non-nil results in a list.
    example: 
(map-tuple '(1 2 3 4 5 6) (lambda (a b) (format T \"a: ~A b:~A~%\" a b)) #'cdr) 
a: 1 b:2
a: 2 b:3
a: 3 b:4
a: 4 b:5
a: 5 b:6
a: 6 b:NIL

(map-tuple '(1 2 3 4 5 6) (lambda (a b) (format T \"a: ~A b:~A~%\" a b)) #'cddr) 
a: 1 b:2
a: 3 b:4
a: 5 b:6
"
  (cond ((null someList)
        nil)
    (T
       (aif (funcall f (car someList) (cadr someList))
          (cons it (map-tuple (funcall by someList) f by))
           (map-tuple (funcall by someList) f by))))) 
```

# iphone - 排序 NSMutableArray 并对另一个 NSMutableArray 进行排序

> ID：11905724
> 
> 赞同：1
> 
> 时间：2012-08-10T16:30:40.240
> 
> 标签：iphone, objective-c, ios, xcode, arrays

可以像这样对数组进行排序：

```
MutableArray  = [NSMutableArray arrayWithObjects:@"5",@"1",@"7,@"9",@"4", nil]; 
```

到（从小到大开始）：

```
MutableArray  = [NSMutableArray arrayWithObjects:@"9",@"7",@"5,@"4",@"1", nil]; 
```

是否也可以对两个数组进行排序：

```
MutableArray  = [NSMutableArray arrayWithObjects:@"5",@"1",@"7",@"9",@"4", nil];
MutableArray  = [NSMutableArray arrayWithObjects:@"Andy",@"Mike",@"Bob",@"Amy",@"Alex", nil]; 
```

to（从大到小，但`Andy`得到`5`点，`Mike`得到`1`等等）：

```
MutableArray  = [NSMutableArray arrayWithObjects:@"9",@"7",@"5",@"4",@"1", nil];
MutableArray  = [NSMutableArray arrayWithObjects:@"Amy",@"Bob",@"Andy",@"Alex",@"Mike", nil]; 
```

可以作为情侣订购吗？
提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:47:14.940

示例如何`arrayOne`升序排序和`arrayTwo`沿排序：

```
NSMutableArray *arrayOne  = [NSMutableArray arrayWithObjects:@"5",@"1",@"7",@"9",@"4", nil];
NSMutableArray *arrayTwo = [NSMutableArray arrayWithObjects:@"Andy",@"Mike",@"Bob",@"Amy",@"Alex", nil];

NSDictionary *temp = [NSDictionary dictionaryWithObjects:arrayTwo forKeys:arrayOne];
NSArray *sortedArrayOne = [[temp allKeys] sortedArrayUsingSelector:@selector(compare:)];
NSArray *sortedArrayTwo = [temp objectsForKeys:sortedArrayOne notFoundMarker:[NSNull null]];

NSLog(@"%@",sortedArrayOne);
NSLog(@"%@",sortedArrayTwo); 
```

工作流程：
从数组`->`排序字典创建字典从字典`->`创建数组。

**编辑**

使用`NSSortDescriptor`with`ascending:NO`进行降序排序，快速示例：

```
NSDictionary *temp = [NSDictionary dictionaryWithObjects:arrayTwo forKeys:arrayOne];
NSSortDescriptor *theDescriptor = [NSSortDescriptor sortDescriptorWithKey:nil ascending:NO selector:@selector(compare:)];    
NSArray *sortedArrayOne = [[temp allKeys] sortedArrayUsingDescriptors:[NSArray arrayWithObject:theDescriptor]];
NSArray *sortedArrayTwo = [temp objectsForKeys:sortedArrayOne notFoundMarker:[NSNull null]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:01:39.497

你为什么不直接创建一些新对象，比如`Player`使用 ivars`name`并将`score`该类的实例存储在数组中。然后，您将能够根据需要对代码中的任何点对该数组进行排序，如下所示：

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES] ;
NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
NSArray *sortedByName = [players sortedArrayUsingDescriptors:sortDescriptors]; 
```

或按分数：

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"score" ascending:NO] ;
NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
NSArray *sortedByName = [players sortedArrayUsingDescriptors:sortDescriptors]; 
```

# character-encoding - 孟加拉语编码

> ID：11905727
> 
> 赞同：1
> 
> 时间：2012-08-10T16:31:10.840
> 
> 标签：character-encoding, converter, codepages

有谁知道这是什么编码（孟加拉语）： Bs‡iRx eY©gvjvi cO_g eY© ‡fovi WvK, QvM‡ji e?ve?v WvK ‡Nvovi Mvwo; fvov‡U†gvUiMvwo

作为一个例子，这个网站似乎使用它： [http://www.shipbreakbd.info](http://www.shipbreakingbd.info) 它使用它自己的字体来表示内容，这只是一个例子。我得到了这种编码的文本文件，我需要将其转换为 UTF-8。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T16:39:47.190

这是在达卡出版的 Mustafa Jabbar 的孟加拉字体系列中使用的基于字形的编码。但这似乎有点旧的编码。您在 ASCII 中引用的内容大致翻译为“英文字母的第一个字母，绵羊的咩咩，山羊的咩咩，马车，出租汽车。” M Jabbar 多次更改编码，可能这就是为什么第三个单词中的第二个字符应该是 'r' 而出现在第八和第九个单词中的第二个字符应该是 'y'作为一个问号出来。它肯定不是 UTF-8。

# mysql - 加入 2 个表（一对多）并在第二个表中获取最新条目

> ID：11905728
> 
> 赞同：3
> 
> 时间：2012-08-10T16:31:10.590
> 
> 标签：mysql, sql, database

假设我有两个表，“users”和“audit”，并且每次用户状态发生变化时，审计表都会由触发器填充。我正在尝试从两个表中进行选择，并获取具有关联的最新审计条目的用户条目（唯一）。假设这些表具有以下字段：

用户：

*   ID
*   用户名
*   电子邮件
*   地位

审计：

*   id（只是一个任意的自动增量）
*   user_id (fk)
*   新状态
*   created_at（发生这种情况的日期/时间）

**因此，对于每个用户条目，都有多个审计条目。**

所以，最终我需要说结果（斜体部分是审计结果，非斜体部分是 mysql 结果集中行的用户部分）：
**1** , john, john@gmail.com , 10, *5, **1** , 10, 2012-08-10-10:15:59*
等

现在，我能看到的唯一方法是进行复合选择，我在其中执行以下操作：SELECT U.*, (SELECT * FROM audit A2 where A2.id = max(A.id)) FROM users U left join audit A上（U.id = A.user_id）；

问题是，如果您在用户中有数千或数十万个结果，您将在数据库内部进行 n+1 查询 - 这确实效率低下。

关于如何在不使用复合 SELECTS 的情况下将其编写为一条 SQL 语句的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:34:13.180

我假设总是有一个相应的审计条目，因此使用了 INNER JOIN。还假设同一用户没有两个具有相同`created_at`日期的审计条目。

```
select u.id, u.username, u.email, u.status, 
    a.id, a.new_status, a.created_at
from users u
inner join (
    select user_id, max(created_at) as MaxCreated
    from audit
    group by user_id
) am on u.id = am.user_id
inner join audit a on am.user_id = a.user_id and am.MaxCreated = a.created_at 
```

# php - 可以帮助我在 PHP 中实现分面搜索吗

> ID：11905731
> 
> 赞同：0
> 
> 时间：2012-08-10T16:31:25.247
> 
> 标签：php, sphinx, faceted-search

我正在尝试为基于 PHP 的电子商务网站构建多面搜索。使用方法构建过滤器`GET`会使代码变得非常复杂，因为网站有很多过滤器。有人可以提供一些教程或更好的方法来构建多面搜索吗？

我想过使用 Sphinx 实现分面搜索，但我是 Sphinx 的新手。客户拒绝了 Sphinx（我不知道为什么）。我能够使用 Sphinx 构建基本搜索，但不知道如何进行分面搜索。如果有人可以提供一些关于 Sphinx 的教程，那将会很棒，因为我可能会在使用它之后尝试说服客户。时间是这里的一个主要因素，因为我必须在一天内实现分面搜索。

```
$urlstring = '';
$urlstring = rmParamQS('category');
$urlstring = rmParamQS('brand', $urlstring); 
```

将添加新的查询字符串（如类别或品牌）并将从上述函数中删除现有查询字符串的代码

```
$url = 'http://' . $_SERVER['SERVER_NAME'].'?page='.$page.$urlstring;

$categoryGet = (isset($_GET['category']))?$_GET['category']:NULL;
$categoryQS = '&category='.$categoryGet;

$brandGet = (isset($_GET['brand']))?$_GET['brand']:NULL;
$brandQS = '&brand='.$brandGet;

$categories = categories_list($brandGet);

echo '<ul id="categories">';
list all categories using foreach with link in following format
echo '<a href="'.$url.'&category='.$category["category_id"].'">'
echo '</ul>';

$brands = brands_list($categoryGet);
echo '<ul id="brands">';
list all brands using foreach with link in following format
echo '<a href="'.$url.'&brand='.$brand["brand_id"].'">'
echo '</ul>'; 
```

像类别和品牌一样，我还有五个过滤器。rmParamQS 函数将从 $url 中删除相应的查询字符串。categories_list 和brand_list 函数将根据其他过滤器的url中查询字符串中的ID过滤数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:13:24.377

我不知道为什么它是多面搜索，但这里有一个使用连接的 php 和 mysql 示例：[Faceted Search (solr) vs Good old filtering via PHP？](https://stackoverflow.com/questions/7256405/faceted-search-solr-vs-good-old-filtering-via-php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-07T02:52:42.587

这是关于 Sphinx / Manticore Search 中分面搜索的教程 - [https://play.manticoresearch.com/faceting/](https://play.manticoresearch.com/faceting/)

# asp.net - SignalR 和负载平衡与主动/主动粘性会话

> ID：11905733
> 
> 赞同：5
> 
> 时间：2012-08-10T16:31:30.373
> 
> 标签：asp.net, iis, load-balancing, signalr

我们有一个使用 SignalR 更新客户端 UI 的应用程序，目前该应用程序托管在我们维护的 IIS 上，我们的客户直接与我们连接。

然而，我们正在将其集成到一个企业范围的框架中，该框架将容纳我们的应用程序，我们将继续托管该应用程序，但是任何登陆我们页面的人都将经历我们被告知的负载平衡策略“每个区域的 2 个网关服务器设置为活动/活动并带有粘性会话”

我的问题是，当 SignalR 决定选择长轮询作为传输协议并且以某种方式断开连接时，我们会有什么问题吗？

抱歉，我对负载平衡的主题一无所知。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T17:13:15.867

好吧，假设您真的在使用“粘性”会话，那么断开连接应该无关紧要，因为由于粘性，下一个请求应该返回到同一个底层服务器。毕竟，粘性会话都是为了在多个请求的过程中保持 HTTP 的标准请求/响应模型返回到同一台服务器。因此，由于长轮询只不过是具有延长/流式响应的标准请求，因此它应该与标准粘性会话实现很好地集成。

您需要考虑的是：如果您因为故障或维护而丢失服务器 A，会发生什么？如果您未使用横向扩展的消息总线解决方案（Redis、Azure SB），则在从服务器 A 转换到服务器 B 时，您可能会丢失/错过消息。

# .htaccess - 如何在我的私人服务器中设置 htaccess 和 htpasswd？

> ID：11905751
> 
> 赞同：1
> 
> 时间：2012-08-10T16:32:12.027
> 
> 标签：.htaccess, authentication, basic-authentication, .htpasswd

目前我正在尝试在我的测试服务器上设置身份验证。

以下是我尝试为其设置身份验证的文件夹中的文件列表。

```
sftp://it@192.168.0.157/var/www/secret/.htpasswd
sftp://it@192.168.0.157/var/www/secret/.htaccess
sftp://it@192.168.0.157/var/www/secret/index.html 
```

这是 .htaccess 包含的内容：

```
AuthName "Restricted Area"
AuthType Basic 
AuthUserFile /secret/.htpasswd 
AuthGroupFile /dev/null 
<Files test.html>
require valid-user
</Files> 
```

我没有弹出登录信息。当我转到 192.168.0.157/secret 时，它只是显示 index.html

我做错了什么？

哦，顺便说一句，请忽略我没有将 htpasswd 文件放在更安全的位置这一事实。我只想让它工作一次并能够展示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:15:17.780

您已经声明了 FTP 服务器的 URL，而不是 Apache Web 服务器的 URL。
尝试访问网络服务器时，url 将是：`http://192.168.0.157/secret/index.html`

在`.htaccess`您已声明访问权限应仅为控制器`test.html`

使用此 .htaccess 控制对所有文件的访问：

```
AuthType Basic
AuthName "Restricted Area"
AuthUserFile /secret/.htpasswd
Require valid-user 
```

# jquery - 使用 jquery 动态显示图像

> ID：11905753
> 
> 赞同：0
> 
> 时间：2012-08-10T16:32:23.017
> 
> 标签：jquery

我目前正在使用 jquery 和 jstree 插件来显示图像。我正在基于具有节点的 xml 文件构建树。Saparately，我正在使用一些第三方工具创建图像。图像名称为 -model.png。当一个节点被选中时，根据树上的 node_id，我在 div 上显示图像。

它有效，但问题在于并非所有节点都具有相同数量的图像。例如 node_a 将有 10 个图像，node_b 将有 2 个图像等。而不是手动创建 div 并基于图像，隐藏或显示；我想动态显示图像。如果在树上单击 node_A，我应该能够使用 jquery 在右侧以 2 列格式查看所有图像。

我目前的代码是这样的：

```
 <div id="column_2">
        <div id="2_div1" ></div>
        <div id="2_div2" "></div>
        <div id="2_div3" ></div>
    </div> 
```

左边是我构建 jstree 的 div

```
$("#left").jstree("toggle_node", data.rslt.obj);

var node_id = data.rslt.obj.attr("id"); 
```

node_id 是所有图像都具有的唯一 ID。根据汽车品牌。例如，它将是 GM-Make、Ford-Make、Toyota-Make 等

```
 if (node_id.indexOf("Make")>=0)
    {
      var Img_year_2012 = "node_id+"-year_2012.png";
       $(function () { 
         $('#1_div1').html("").css({"border": "", "margin": "0"});
        var myImage1 = new Image(); 
        $(myImage1).load(function () 
        {  

        $("#1_div1").html(myImage1).css({"border":"2px solid #E0E0E0", "margin": "20px 20px 20px 0"});
         $( '#1_div1 img' ).css({ "width": "600px", "height" : "650px" });

        })         
        .attr('src', Img_year_2012).error(function(){
            $('#1_div1').html("").css({"border": "", "margin": "0"});
            })

        }); 
```

而不是这样做，我怎样才能显示每个图像都属于一个节点ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:58:39.777

也许我误解了这个问题，但是您是否尝试过使用 for 循环遍历每个节点？类似的东西：[http ://www.w3schools.com/dom/dom_nodes_traverse.asp](http://www.w3schools.com/dom/dom_nodes_traverse.asp)

# c++ - C++ 中具有用户可扩展类型参数的类型化类

> ID：11905757
> 
> 赞同：3
> 
> 时间：2012-08-10T16:32:26.693
> 
> 标签：c++, enums, shared-libraries

假设您正在编写一个库，为一个类提供某种“类型”参数。为此，可能会使用枚举：

```
namespace MyLib {
  class Event {
  public:
    enum EventType { TYPE1, TYPE2, ... };
    Event(EventType _type) : type(_type) { }
  private:
    EventType type;
  }
} 
```

然后实例化：

```
new MyLib::Event(Event::TYPE1); 
```

到目前为止还好。但是，如果您希望用户能够扩展事件类型列表怎么办？如果 type 属性是枚举，这是不可能的。

低质量的可能性包括要求他们`#define`自定义事件名称，或者简单地使用字符串，尽管这些似乎都不是最理想的。

有一个通用的解决方案吗？

一个建议是使用 a`struct EventType`返回枚举中指定范围内的值。然而，虽然这解决了编译器安全问题，但它并没有解决添加*命名*类型的问题——它需要用户将这些添加到全局范围。

解决后一个问题但不是前一个问题的一种可能性是将 EventType 类型定义为一个整体类型，并将其留给用户将自定义类型添加到库的名称空间或他们自己的名称空间。提供唯一值的工厂方法可以作为 Event 的一部分提供：

```
#include <iostream>
#include <vector>

namespace MyLib {

  namespace EventType {
    typedef int T;
    enum { TYPE1, TYPE2, Count};
  }

  class Event {
  public:
    Event(EventType::T _type) : type(_type) { }
    EventType::T type;
    static EventType::T registerType() { return _typeid++; }
  private:
    static int _typeid;
  };

}

MyLib::EventType::T MyLib::Event::_typeid = EventType::Count;

// The user can then add types, including to the library's namespace
// (which may or may not be a good idea)
namespace MyLib { namespace EventType {
  MyLib::EventType::T MYTYPE = MyLib::Event::registerType();
} }

int main() {
  MyLib::Event ev1(MyLib::EventType::TYPE2);
  MyLib::Event ev2(MyLib::EventType::MYTYPE);
  std::cout << ev1.type << std::endl;
  std::cout << ev2.type << std::endl;
  return 0;
} 
```

输出：

```
1
2 
```

虽然这在技术上并未将参数限制为一组已注册的类型，但 typedef 和命名空间在 IDE 中的构造函数定义和自动建议中提供了有用的语法提示，并且它可以防止用户类型不得不污染全局范围，从而也许是更大的担忧。

有没有更好的方法来指定有限的、经过编译器检查但用户可扩展的值集作为类的类型参数，或者通常是函数/方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:45:59.990

我认为你最好的选择是简单地将事件类型作为一个普通的整数类型，使用枚举来定义内置类型，并提供用户定义的最小值和最大值，用户在它们之间创建自己的整数值枚举器。然后，您只需使用断言来确保基本事件不会尝试处理未知事件类型。

编辑：请注意，具有某些类型的基事件类可以理解，而某些类型可能不脆弱，除非它只是为子类保存数据以供以后再次选择。即使在这种情况下，考虑替代设计可能会更好。您能否详细说明事件类型在设置后如何*使用*？

EDIT2：我想我现在理解得更好了，事件存储事件类型，事件使用者可以从事件中检索它。如果消费者理解扩展事件类型，它可以进行适当的处​​理，否则委托、断言或简单地无操作。鉴于此，我认为使用整数事件类型似乎很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:49:11.113

我会扩展我的枚举类型的空间，如下所示：

```
/* UNTESTED */
struct MyType {
 enum e { type1, type2, type3, max_type = type3, _big = max_type+256 };

 /** Acceptable values are 0-255 */
 static e UserType(int i) { return e(max_type + 1 + i); }
};

void f (MyType::e t) {}

int main () {
  f(MyType::type1);
  f(MyType::UserType(47));
  enum UserEnum { utype1, utype2, utype3 };
  f(MyType::UserType(utype3));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:07:53.973

你不能用枚举来做，但你可以定义一个新的类型。

c++ 枚举与类大致相同：

```
struct Enum
{
  int value;
  explicit Enum(int v) : value(v) {}
  operator int () {return value;}
};

static const Enum value_1 = Enum(1);
static const Enum value_2 = Enum(2);
... 
```

嗯，它不完全一样，有一些区别，比如你不能从枚举继承，而枚举是整数类型，所以你可以将 int 转换为枚举，但这些差异不大。

如果你这样做，那么你可以通过简单地添加新常量来向“枚举”添加新值。

```
static const Enum custom_value_1 = Enum(100);
static const Enum custom_value_2 = Enum(200); 
```

您需要制作它们`static`，因为 C++ 很愚蠢，并且即使它们可以用作编译时常量也会分配资源。的替代方法`static`是将它们放入匿名命名空间中：

```
namespace
{
  const Enum custom_value_1 = Enum(100);
  const Enum custom_value_2 = Enum(200);
} 
```

如果您不执行其中一项操作，您将收到链接器错误。此方法将为您提供与枚举获取相同类型的类型检查，并且您可以在单独的头文件中扩展值。

# php - 带有 CURL 的 CCPROXY

> ID：11905759
> 
> 赞同：2
> 
> 时间：2012-08-10T16:32:32.913
> 
> 标签：php, curl, http-status-code-302

我正在尝试编写一个脚本以使用 CURL 作为计费软件并修改 CCproxy 网络面板上的信息。

但我有一个问题：

这是我的代码：

```
$url="http://xxxxxxx:88/account";
$postfields["form"] = "1";
$postfields["adminpassword"] = "newpassword";
$postfields["changeadminpassword"] = "Modify";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_USERPWD, 'admin:password');

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, true);

curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $postfields);

$data = curl_exec($ch);
curl_close($ch);

echo $data; 
```

当我在没有 post 和 postfield 选项的情况下使用它时，我可以从 ccproxy Web 面板中回显所有用户列表，并且它只显示带有此 http 响应的页面源代码：

**HTTP/1.0 200 OK 服务器：CCProxy Pragma：无缓存，无存储缓存控制：无缓存，无存储连接：关闭内容长度：200107 内容类型：文本/html**

一开始它很好，但是当我尝试使用 postfields 和 post 方法时，我收到 http 302 错误并且没有任何工作，这是 http 响应：

**HTTP/1.1 302 找到服务器：CCProxy 6.6 Pragma：无缓存，无存储缓存控制：无缓存，无存储位置：/account**

请您告诉我如何将查询发布到 ccproxy 网络面板以修改用户或其他任何东西！

**当我检查 HTML 表单时，操作字段是“帐户”，方法是“发布”**

此外，当我使用此源代码创建 .html 文件时，它的工作！

```
<form action="http://xxxxxx:88/account" method="post" name="form">
<input type="text" value="newpassword" name="adminpassword">
<input type="submit" class="button" value="Modify" name="changeadminpassword">
</form> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:35:51.297

302 是重定向[http://en.wikipedia.org/wiki/HTTP_302](http://en.wikipedia.org/wiki/HTTP_302)

尝试添加此设置

```
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1); 
```

# coldfusion - 在 Application.cfm 中的邮件服务器之间切换

> ID：11905760
> 
> 赞同：2
> 
> 时间：2012-08-10T16:32:38.650
> 
> 标签：coldfusion, smtp, coldfusion-9, application.cfm

我们使用coldfusion 9，并且我们的站点用于发送电子邮件的个人SMTP 帐户具有发送限制。我想根据一天中的时间在两台服务器之间交替。

```
<cfif timeformat(now(),'HH:mm:ss') GT '12:00:00' >
  <cfset email.username="foo@bar.com" />
  <cfset email.password="s3cr3t" />
<cfelse>
  <cfset email.username="baz@bar.com" />
  <cfset email.password="s3cr3t2" />
</cfif> 
```

我想这样做`Application.cfm`（我们不使用cfc）并且不必修改任何`cfmail`标签......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:04:54.470

如果您想在每台服务器之间拆分电子邮件量，我建议保留一个值来告诉您接下来要使用哪个服务器：

这将进入您的应用程序文件。

```
 <cfscript>
        // get this hour
        ThisHour = hour(now());
        ServerOneHours = "1,3,5,7,9,11,13,15,17,19,21,23";
        if (listFind(ServerOneHours, ThisHour) gt 0) {
          application.email.username = "foo@bar.com";
          application.email.password = "s3cr3t";
        } else {
          application.email.username = "foo@ffooodoijdbar.com";
          application.email.password = "s3cr6516516513t";
        } 
    </cfscript>
</cffunction> 
```

每当使用 cfmail 时，它都会使用当前设置：

```
<cfmail username="#application.email.username#" 
    password="#application.email.password#"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T02:37:35.517

`ServiceFactory`如果您的所有 cfmail 标签都使用存储在您的 cf 管理员中的身份验证，您可以在运行时使用和更改应用程序中的设置`MailSpooler`。

```
var mss = createObject('java','coldfusion.server.ServiceFactory').getMailSpoolService();
mss.setServer('you-mail-server-host-or-ip');
mss.setUsername('you-mail-server-username');
mss.setPassword('you-mail-server-password'); 
```

您可以使用 get() 方法取回设置：

```
var mss = createObject('java','coldfusion.server.ServiceFactory').getMailSpoolService();
var host = mss.getServer();
var user = mss.getUsername();
var pass = mss.getPassword(); 
```

getPassword() 返回您的加密密码。每次设置密码时，都会使用新的盐。

如果您想在服务器之间自动切换，请创建一个计划任务来检查您的配额并在超出时或以预定义的时间间隔进行切换。

# mysql - 透视数据网格视图

> ID：11905762
> 
> 赞同：1
> 
> 时间：2012-08-10T16:32:46.597
> 
> 标签：mysql, winforms, c#-4.0

所以，想象一个电子表格，上面的单元格代表一个月中的几天，而线条代表一些计算的结果，同样代表一天。

我会将其应用于 dataGridView。每列由一个月中的一天表示，应该包含几行，其中包含当天通过查询数据库恢复的一些计算结果。

在实践中，当我运行 GridView 的填充时，我看到按顺序和垂直填充当天的单元格。

提前致谢 ....

# c# - 不返回来自 db 的数据，但正常列表是

> ID：11905763
> 
> 赞同：1
> 
> 时间：2012-08-10T16:32:47.207
> 
> 标签：c#, asp.net, entity-framework, asp.net-web-api, lazy-loading

我正在构建一个 webapi，但我遇到了奇怪的问题。

当我做这样的事情

```
List<Content> items = new List<Content>(); 
```

而不是我向它添加项目

```
items.Add(new Content()); 
```

而不是我调用 url localhost/api/Content/Get 我会用我的项目得到一个很好的 xml 但是当我做这样的事情时

```
public IEnumerable<Content> Get()
{
    List<Content> population = new List<Content>();
    Content[] test = new Content[5];

    var tmp = from c in db.Content select c;
    using (IEnumerator<Content> enumerator = tmp.GetEnumerator())
    {
        while (enumerator.MoveNext())
        {
            Content ctmp = (Content)enumerator.Current;
            population.Add(ctmp);
        }
    }
    return population;
} 
```

我调用相同的 url 我得到空白（白色）页面。当我返回 tmp 变量时，同样想。

**更新：**

感谢帮助。主要问题仍然存在。为什么正常的 List 会正确返回，而从 db 创建的 List 却不是。从 DataProxies.Content 复制到内容并不是我梦寐以求的解决方案，而且 Jon 注意到这有点奇怪。

没有任何样品有`db.Content.ToList()`帮助：/我很困惑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:35:19.253

大概您的 SQL 查询没有找到任何项目，因此该方法返回的列表为空。请注意，您的代码可以更简单地表示为：

```
public IEnumerable<Content> Get()
{
    return db.Content.ToList();
} 
```

或者可能：

```
public IEnumerable<Content> Get()
{
    return db.Content.Cast<Content>().ToList();
} 
```

您需要多解释一下，`db.Content`以便我们为您提供更多帮助。也许您应该创建一个新的数据库上下文？例如：

```
public IEnumerable<Content> Get()
{
    using (FooDataContext db = new FooDataContext())
    {
        return db.Content.ToList();
    }
} 
```

编辑：如果您*真的*想确保您只是返回`Content`对象，而不是动态代理，您可以编写如下内容：

```
public IEnumerable<Content> Get()
{
    using (FooDataContext db = new FooDataContext())
    {
        return db.Content
                 .ToList()
                 .Select(c => new Content { Name = c.Name,
                                            Foo =  c.Foo,
                                            // etc
                         });
    }
} 
```

...只是直接复制属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:36:35.363

```
var list = db.Content.ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:59:44.647

我找到了解决方案。至少我认为我做到了

我用

```
db.Configuration.ProxyCreationEnabled = false; 
```

比我得到普通对象而不是代理动态实体

关于你的问题乔恩。我如何公开该方法？没什么好说的。我已经从模板创建了 ApiController 并刚刚编辑了方法

```
 public class ContentController : ApiController
{
    private signsEntities db = new signsEntities();

    // GET api/content
    public IEnumerable<Content> Get()
    {
        db.Configuration.ProxyCreationEnabled = false;
        Content[] test = this.db.Content.ToArray<Content>();
        return test;
    }
} 
```

这是全班。没有你能看到的：）

# c# - 关闭按钮（右上方 X）的行为类似于控制？

> ID：11905768
> 
> 赞同：0
> 
> 时间：2012-08-10T16:33:30.777
> 
> 标签：c#, javascript, asp.net

C#、ASP.NET、JS

我打开了这个弹出窗口，员工在不同的客户上工作。完成后，他们单击一个按钮并在实际关闭弹出窗口之前运行一些进程。

当他们点击屏幕右上角的 X 按钮时，我想要实现的是同样的事情。

我试过这个：

.aspx。

```
window.onclose = closePage; 
```

.js。

```
function closePage() { 
__doPostBack('XXXX', '');
} 
```

。CS

```
//In Page_Load
if (Request["__EVENTTARGET"] == "XXXX")
       {
           //desired code.
       } 
```

绝对不会开火。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:43:33.207

ASP.net 在服务器级别运行，并且不固有地“知道”用户何时关闭站点。要实现您想要的，您需要使用 ASP.NET Ajax。

这里有一篇好文章；

[http://stephenwalther.com/archive/2008/03/07/asp-net-ajax-in-depth-application-events.aspx](http://stephenwalther.com/archive/2008/03/07/asp-net-ajax-in-depth-application-events.aspx)

# php - 如何在 Symfony2 中转换此过滤器链类

> ID：11905776
> 
> 赞同：1
> 
> 时间：2012-08-10T16:33:57.680
> 
> 标签：php, symfony

我正在将旧网站从 SF 1.x 转换为 S2。

旧代码中有一个类利用了 SF v1 过滤器链。这是该类的一个片段：

```
class myFilter extends sfFilter
{
    public function execute($filterChain)
    {
        // Execute this filter only once
        if ($this->isFirstCall())
        {
            // Filters don't have direct access to the request and user objects.
            // You will need to use the context object to get them
            $context = $this->getContext();
            $user = $context->getUser();

            if ($user->isAuthenticated())
            {                
                // Do something
            }
        }

        // Execute next filter
        $filterChain->execute();
    }

} 
```

我希望能够实现这个功能，即窥探请求，并根据用户会话采取行动。看起来 SF 已经取消了过滤器链，我查看了 Symfony 内部的文档，但我找不到可以帮助我入门的东西（即上面的一个小片段）。

有谁知道我如何监听请求（可以通过 v1 中的过滤器链完成），但使用 SF2 中提供的新机制？

一个片段来展示如何做到这一点将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:39:09.870

我没有使用过第一个 Symfony，但我猜你正在寻找[事件监听](http://symfony.com/doc/current/cookbook/service_container/event_listener.html)器。特别是`onKernelRequest`一个。您所要做的就是创建 Listener 类，将其注册为服务并注入您需要的任何内容，然后一切顺利。

例如：

```
use Symfony\Component\HttpKernel\Event\GetResponseEvent;
use Symfony\Component\HttpFoundation\RedirectResponse;

class RequestListener
{
    public function onKernelRequest(GetResponseEvent $event)
    {
        $response = new RedirectResponse('http://www.google.com');
        $event->setResponse($response);
    }
} 
```

此侦听器会将所有人重定向到谷歌。例如，如果您需要发送邮件，您可以将 SwiftMailer 注入到此侦听器的服务中，并像正常使用它一样使用它。Symfony2 中的监听器也有优先级，您可以通过这些优先级调整它们的执行顺序：

> 还有一个额外的标签选项priority是可选的，默认为0。这个值可以是-255到255，监听器会按照它们的优先级顺序执行。当您需要保证一个侦听器在另一个侦听器之前执行时，这很有用。

还有一种解决方案，但它不如使用侦听器那么优雅。您可以创建基本控制器并将所有逻辑放入其构造函数中。所有其他控制器都必须扩展此控制器（如果您想在所有页面上执行某些操作）。

# python - SUD 的 Python 要求

> ID：11905785
> 
> 赞同：2
> 
> 时间：2012-08-10T16:34:15.820
> 
> 标签：python, windows-7, suds

我是 SOAP 和 SUD 的菜鸟。我需要在装有 Python 3.2 的 Windows 7 机器上安装 SUD。

我还没有听说有人在 Python 3+ 中安装 SUD。

我应该安装 Python 2.7 吗？还是我需要早点去？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T16:38:50.637

如果您查看概述部分，您会看到**SUD**在 Windows 下的**Python 3.2**上进行了测试。在这个[网站上](https://bitbucket.org/jurko/suds)，您还可以找到有关如何使用、轻松安装或从源代码安装Python的**SUD的说明。**`pip`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:40:33.967

看起来 SUD 还没有移植到 python 3。2.7应该可以正常运行。

更新：我猜有一个适用于 3.2 的泡沫分叉：[suds-jurko](http://pypi.python.org/pypi/suds-jurko/0.4.1.jurko.4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-07T19:24:25.120

在 Windows 中设置 sudo ： - 像以前一样打开命令提示符。- cd \Python27\scripts\
- 现在你的位置是：C\Python27\scripts\ - 输入easy_install suds [![在此处输入图像描述](../Images/d41915e59bc9f1befd37f93f1899a168.png)](https://i.stack.imgur.com/2lkKA.png)

# unit-testing - Intersystems Caché 的单元测试框架

> ID：11905786
> 
> 赞同：0
> 
> 时间：2012-08-10T16:34:16.353
> 
> 标签：unit-testing, intersystems-cache

Intersystems Caché 是否有任何单元测试框架？如果有，请列举一些。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:52:03.147

Caché 有一个内置的 - 请参阅他们的[%UnitTest 包](http://docs.intersystems.com/cache20121/csp/documatic/%25CSP.Documatic.cls?PAGE=CLASS&LIBRARY=%25SYS&CLASSNAME=%25UnitTest)文档。此外，他们的文档中有相当不错的[教程](http://docs.intersystems.com/cache20121/csp/docbook/DocBook.UI.Page.cls?KEY=TUNT)供您参考。诚然，%UnitTest 有点古怪，并且没有更知名的 xUnit 测试框架那样功能齐全，但如果你没有别的东西那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:21:31.120

这不完全是您所要求的，但是我处于与您相同的情况并且我认为任何现有的单元测试框架都不是很好，因此我移植了 JUnit 的早期版本，如[JUnit A Cook's Tour](http://junit.sourceforge.net/doc/cookstour/cookstour.htm)中所述.

回到原始 *Unit 的早期版本（我忘记了确切的名称），作者不会分发源代码，但会指导人们编写自己的版本，因此他们有信心对其进行修改以满足他们的需要。在我写我的第一个单元测试之前，我每天最多花费 1/2 的时间。我建议也这样做。

我会给你源代码，但我不拥有它，我不想与我公司的所有者进行那种对话。

# android - 将位图的透明背景转换为白色

> ID：11905792
> 
> 赞同：0
> 
> 时间：2012-08-10T16:34:41.877
> 
> 标签：android, background, bitmap

我截取了一个视图（其中包含在白色背景上绘制的黑线）：

```
myView.setDrawingCacheEnabled(true);
Bitmap drawing = Bitmap.createBitmap(myView.getDrawingCache()); 
```

如果我像这样旋转这个位图：

```
Matrix matrix = new Matrix();
matrix.postRotate(45);
drawing = Bitmap.createBitmap(drawing, 0, 0, drawing.getWidth(), drawing.getHeight(), matrix, true); 
```

我会得到一个透明背景的图像。

我该怎么做才能用白色替换透明颜色而不留下任何伪影？这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:51:32.737

由于我的图像仅由黑色背景上的黑色线条组成，因此我能够以非常低效的方式解决此问题：迭代图像中的所有像素，如果它们不是黑色，则将其颜色替换为白色。似乎 Color.TRANSPARENT 和 Color.WHITE 之间有一个几个像素宽的分隔区域，这对于试图获得相同结果以获得更彩色图像的人来说真的很难。

# mysql - 如何在不影响自动增量的情况下将此行添加到此表

> ID：11905802
> 
> 赞同：0
> 
> 时间：2012-08-10T16:35:12.730
> 
> 标签：mysql, sql, auto-increment

对，我有一个包含以下字段的表格：id、title、description、keywords 和 link。在表中，我有数百个搜索引擎网站。我在本节中挣扎。id 设置为自动增量，我希望能够添加一行代码，将自身嵌入表中，在中间某处，id 标签（自动增量）在整个表中进行调整。因此，如果我将 'Google' 添加到 id '81'，81 将转到 82 以适应它。有没有办法用 SQL 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:04:14.597

`AUTO_INCREMENT`并不是真的要以您想要的方式使用它。它主要只是对表中任何一行的引用，主要目的是用作其他表中的外键。如果你想让你的行以某种方式排序，你应该有另一列可以影响。

编辑：

但是现在以防万一您真的想重新编号并且您的自动增量 ID 没有在任何其他表中用于参考并且当前没有人使用该表，您可以

*   删除 ID 列
*   添加不带 auto_increment 的 ID 列
*   将“Google”的 ID 更新为 81
*   再次修改 ID 列为 auto_increment

也许像这样

```
alter table mywebsitetable drop column id;

alter table mywebsitetable add column id bigint;

update mywebsitetable set id = 81 where websitename = 'Google';

... do more numbering as you like and this does give numbers to all the other rows:

alter table ify.test modify id bigint primary key auto_increment; 
```

如果您想保留所有 ID，那么您甚至可以添加另一列来保存 ID 列，并使用两个更新语句将它们复制过来。对 81 之前的 ID 进行一次更新，在 81 之后进行另一次更新，其中增加了 ID。然后添加 drop 并添加列，从 save 列复制 ID，删除 save 列，添加 google 并再次打开 auto_increment。但是，当您的表很大时，这将花费很长时间，我不建议这样做，因为正如我之前所说，自动增量并不意味着订购或正如那条评论中提到的那样，auto_increment 不应该被视为传播中的行床单。

# c# - c#中的文件传输问题

> ID：11905804
> 
> 赞同：1
> 
> 时间：2012-08-10T16:35:20.050
> 
> 标签：c#, sockets, tcp, file-transfer

我正在使用 c# 传输文件。我用过[这段](http://www.codeproject.com/Articles/24017/File-Transfer-using-Socket-Application-in-C-NET-2)代码。问题是像 .txt 文件这样的小文件可以正确传输，但不能正确传输像图像、文档、pdf、ppt 这样的大文件。有时代码可以正常工作，但大多数时候它传输的数据量较少。

**服务器代码：**

```
Socket clientSock = sock.Accept();

byte[] clientData = new byte[1024 * 50000];
int receivedBytesLen = clientSock.Receive(clientData);
int fileNameLen = BitConverter.ToInt32(clientData, 0);
string fileName = Encoding.ASCII.GetString(clientData, 4, fileNameLen);
BinaryWriter bWrite = new BinaryWriter(File.Open(receivedPath + "/" + fileName, FileMode.Append));
bWrite.Write(clientData, 4 + fileNameLen, receivedBytesLen - 4 - fileNameLen);
bWrite.Close();
clientSock.Close(); 
```

**客户代码：**

```
byte[] fileNameByte = Encoding.ASCII.GetBytes(fileName);
byte[] fileData = File.ReadAllBytes(filePath + fileName);
byte[] clientData = new byte[4 + fileNameByte.Length + fileData.Length];
byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length);
fileNameLen.CopyTo(clientData, 0);
fileNameByte.CopyTo(clientData, 4);
fileData.CopyTo(clientData, 4 + fileNameByte.Length);
clientSock.Connect(ipEnd);
clientSock.Send(clientData);
clientSock.Close(); 
```

完整的代码在上面的链接中给出。我也看过这篇[文章](https://stackoverflow.com/questions/9326649/c-sharp-mutlti-threading-file-transfer-using-tcp)，但这没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:46:12.227

> 有时代码可以正常工作，但大多数时候它传输的数据量较少。

这就是 的本质`Socket.Receive()`，它并不总是返回发送给它的所有数据。

您必须[`Receive(clientData, 4, 0)`](http://msdn.microsoft.com/en-us/library/26f591ax)首先接收指示 的字节`size`，然后`Receive(clientData)`在循环中调用，直到您收到`size`字节。但请注意，`Receive(buffer[], length, offset)`重载与任何其他重载一样容易返回*少于*预期的字节数。因此，您还必须循环调用它：

像这样的东西：

```
// First receive the size
int sizeSize = 4; // Size of Int32 in bytes
int sizeOffset = 0;
var sizeBytes = new byte[sizeSize];
while (sizeOffset < sizeSize)
{
    sizeOffset += clientSocket.Receive(sizeBytes, sizeSize - sizeOffset, sizeOffset);
}

var size = BitConverter.ToInt32(sizeBytes, 0);

// Then receive the data
byte[] fileData = new byte[size];
byte[] clientData = new byte[8192];
int totalBytes = 0;

while (totalBytes < size)
{
    // This may return anything between 0 and 8192, even if not all sent data has been received yet. It may be in a buffer somewhere, waiting to be picked up. Check for 0, since that's when the client disconnects.
    int bytesReceived = clientSocket.Receive(clientData);

    // You now have received a chunk of data of bytesReceived length. Append it into the fileData array.
    Buffer.BlockCopy(clientData, 0, fileData, totalBytes, bytesReceived);

    totalBytes += bytesReceived;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T18:20:18.660

正如**CodeCaster 的**回答，`Socket.Receive(), it doesn't always return all data that gets sent to it.`这是 100% 正确且经过测试，但发送文件大小的下一步不起作用，我找到了一个简单且正确的解决方案。

`Socket.Receive()`方法获取将复制接收到的数据的字节数组并返回接收到的字节数。所以我们可以很容易地循环它直到接收到的字节为 0。

```
byte[] tempData = new byte[1024 * 5000];

BinaryWriter bWrite = null;
int bytes_received;
int fileNamelength = 0;
bool isFirstPacket = true;

do
{
    bytes_received = clientSock.Receive(tempData);
    if(isFirstPacket)
    {
        isFirstPacket = false;
        int fileNameLen = BitConverter.ToInt32(tempData, 0);
        string fileName = Encoding.ASCII.GetString(clientData, 4, fileNameLen);

        bWrite = new BinaryWriter(File.Open(receivedPath + fileName, FileMode.Append))
        bWrite.Write(tempData, 4 + fileNameLength, bytes_received - 4 - fileNamelength);
    }
    else
        bWrite.Write(tempData, 0, bytes_received);
}
while (bytes_received != 0); 
```

# javascript - 向图像滑块添加“暂停”

> ID：11905815
> 
> 赞同：0
> 
> 时间：2012-08-10T16:36:15.463
> 
> 标签：javascript, jquery

在这个 jQuery 图像滑块中添加暂停按钮的最佳方法是什么？我想在单击橙色方形按钮时添加暂停，该按钮在我的图像滑块中用作计时器。

这是我尝试过的链接。

[http://jsfiddle.net/QNZDX/4/](http://jsfiddle.net/QNZDX/4/)

为了更好地理解，我添加了参考站点，在这里我们可以找到暂停功能，如单击橙色正方形。 [https://store.sap.com/sap/cpa/repository/store/sapstore/US/default.html](https://store.sap.com/sap/cpa/repository/store/sapstore/US/default.html)

此参考站点仅适用于 Mozilla Firefox。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:35:40.080

您的帖子不包含问题，但我猜您想更改 jsfiddle 中的代码以添加暂停。

**如果计时器**为 0（或 null），则基本机制将在 onclick 中进行检查。如果是这样，请启动计时器。否则清除计时器，并将其设置为空。

# c# - .ToList() 和 .Reverse() 之类的扩展方法如何隐藏？

> ID：11905816
> 
> 赞同：2
> 
> 时间：2012-08-10T16:36:15.477
> 
> 标签：c#, extension-methods

我使用了很多扩展方法，比如`.ToList()`等等`.Reverse()`，而没有真正考虑在我使用它们时到底发生了什么。我一直在谷歌上搜索以找出这些方法的确切作用，但我似乎无法在任何地方找到它们。当我`.toList()`在 Visual Studio 中使用 a 并单击“ `Go to definition`”时，我看到的只是

```
 // Summary:
        //     Creates a System.Collections.Generic.List<T> from an System.Collections.Generic.IEnumerable<T>.
        //
        // Parameters:
        //   source:
        //     The System.Collections.Generic.IEnumerable<T> to create a System.Collections.Generic.List<T>
        //     from.
        //
       ...etc 
```

我试图找出（例如）`.Reverse();`方法内部发生了什么。它是否使用堆栈，它是否只是做这样的事情......？

```
public static List<string> Reverse(List<string> oldList)
{
List<string> newList = new List<string>();    
for (int i = oldList.Count-1; i >= 0; i --)
    {
    newList.Add(oldList[i]);
    }
    return newList;
} 
```

注意：我无法想象它实际上是这样的，只是为了澄清我的问题。

**是否有任何网站/书籍/我可以查看的任何内容来显示这些方法的确切作用？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:43:20.310

当您单击“转到定义”时，您可以将 Visual Studio 配置为从 Microsoft 源服务器加载 .Net Framework 的源代码。以下是一些说明：[http ://referencesource.microsoft.com/downloadsetup.aspx](http://referencesource.microsoft.com/downloadsetup.aspx)

请注意，您不必下载大包，只需设置选项就足够了。

这里是源代码`ToList`：

```
 public static List<TSource> ToList<TSource>(this IEnumerable<TSource> source) { 
        if (source == null) throw Error.ArgumentNull("source");
        return new List<TSource>(source); 
    } 
```

这里是源代码`Reverse`：

```
 public static IEnumerable<TSource> Reverse<TSource>(this IEnumerable<TSource> source) {
        if (source == null) throw Error.ArgumentNull("source"); 
        return ReverseIterator<TSource>(source);
    }

    static IEnumerable<TSource> ReverseIterator<TSource>(IEnumerable<TSource> source) { 
        Buffer<TSource> buffer = new Buffer<TSource>(source);
        for (int i = buffer.count - 1; i >= 0; i--) yield return buffer.items[i]; 
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:40:52.510

`.ToList()`做：

```
public static List<TSource> ToList<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    return new List<TSource>(source);
} 
```

并在列表的基础数组上`.Reverse()`调用[Array.Reverse 。](http://msdn.microsoft.com/en-us/library/z78xtwts.aspx)

我是通过使用 Reflector 反编译发现的，但您也可以查看[.NET 源代码](http://referencesource.microsoft.com/netframework.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:39:09.947

Jon Skeet（如果他没有在这方面打败我的话）写了一系列精彩（而且很长）[的博客文章](https://codeblog.jonskeet.uk/2011/02/23/reimplementing-linq-to-objects-part-45-conclusion-and-list-of-posts/)，其中他（或多或少）重新实现了 Linq to Objects。您可以看到他的所有方法的实现（通常与库实现相同或相似），包括您在此处列出的方法。

在 的情况下`Reverse`，您的实现与库（和 Jon 的）实现之间的一个主要区别是执行不同。 `Reverse`直到它必须枚举传入的任何元素`IEnumerable`（在这种情况下，它是在请求第一项时）。我将对该差异的后果的更深入分析留给该博客系列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T16:41:32.977

您可以使用[dotPeek](http://www.jetbrains.com/decompiler/features/index.html)之类的工具来浏览代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T16:43:40.023

扩展方法只是一个普通的旧静态方法，但是您要扩展其类的对象作为参数传递给它。所以假设我们想扩展内置类 int 以包含一个`toString()`方法（是的，我知道，它已经有一个）。语法如下所示：

```
public static string toString(this int myInt)
{
     return (string)myInt;
} 
```

注意`this`参数的关键字。这告诉编译器这是一个扩展方法。

# c# - 我如何将此 C# 属性转换为 VB

> ID：11905823
> 
> 赞同：2
> 
> 时间：2012-08-10T16:36:54.183
> 
> 标签：c#, .net, vb.net, c#-to-vb.net

我是一个 ASP MVC 3 新手，通过音乐商店教程工作，但将所有内容都翻译成 VB（我在 VB 商店工作）。

该教程有一行：

```
public class Album
{
    [Required(ErrorMessage = "An Album Title is required")]
    [StringLength(160)]
    public string   Title      { get; set; }
} 
```

我如何将它翻译成VB？显而易见的选择是：

```
Public Class Album

    <Required(ErrorMessage = "Price is required")> //Compiler says:'ErrorMessage' is not declared. It may be inaccessible due to its protection level.
    <StringLength(160)>
    Property Title As String
    Property Price As Decimal

End Class 
```

但是编译器抛出错误（如上所示）。似乎认为错误消息是专辑的属性。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T16:39:49.983

这应该是：

```
<Required(ErrorMessage := "Price is required")> _
<StringLength(160)> _ 
```

查看[有关属性的 VB 文档以](http://msdn.microsoft.com/en-us/library/aa711863%28v=vs.71%29)获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:40:23.773

```
Public Class Album
    <Required(ErrorMessage := "An Album Title is required")> _
    <StringLength(160)> _
    Public Property Title() As String
        Get
            Return m_Title
        End Get
        Set
            m_Title = Value
        End Set
    End Property
    Private m_Title As String
End Class 
```

# iphone - 丢弃选择器 iOS

> ID：11905825
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:36:57.663
> 
> 标签：iphone, ios, uipickerview

最近我向 Apple 提交了一个应用程序，他们告诉我要在 iPad 中显示 UIPickerView，我必须将其嵌入到 Popover 中，因此丢弃就像在 Popover 之外触摸一样容易......

我应该如何用 iPhone 丢弃 UIPickerView？

我不想推送另一个视图然后返回初始视图进行选择，因为它会中断可用性流程。

在我当前的实现中，我在选择 UITextField 下方显示 UIPickerView 并用 UIButton 丢弃它......这种方法是否正确？

亲切的问候！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:52:36.603

不，正确的方法正是 Apple 向您解释的。您需要将 UIPickerView -INSIDE- 放入 UIPopover。以下是另一个问题/答案的链接，对您来说是一个很好的参考：

[UIPopoverController 太大而 UIPickerView 太小](https://stackoverflow.com/questions/8088902/uipopovercontroller-too-large-and-uipickerview-too-small)

# haskell - haskell Data.Binary 示例

> ID：11905826
> 
> 赞同：2
> 
> 时间：2012-08-10T16:37:04.253
> 
> 标签：haskell

我正在尝试序列化 Contacts 类型，但我一直在定义 put 和 get？

```
import Control.Monad
import Data.Binary

type Name = String
type Address = String

data Contacts = Contacts [(Name, Address)] deriving (Show)
instance Binary Contacts where
    put (Contacts [(n,a)]) = do ...
    get = do ...

main :: IO ()
main = do
    let c = Contacts [("gert","home")]
    let e = encode c
    let d = decode e
    print d 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:42:00.373

是的，你被困在定义`put`和`get`. 这是否回答你的问题？

```
type Name = String
type Address = String

data Contacts = Contacts [(Name, Address)] deriving (Show)
instance Binary Contacts
    put (Contacts [(n,a)]) = do ...
    get = do ... 
```

由于已经有实例：

```
instance (Binary a) => Binary [a]
instance (Binary a, Binary b) => Binary (a,b)
instance Binary Char 
```

您应该能够轻松地解除潜在的看跌期权并获得例程：

```
instance Binary Contacts where
    put (Contacts set) = put set
    get = fmap Contacts get 
```

因此，当您放置联系人时，您只需告诉它放置字符串对列表。当您想反序列化联系人时，您只需获取基础列表并使用`Contacts`构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T23:51:00.803

添加更简单的示例以防止其他菜鸟像我一样遭受痛苦:)

```
{-# LANGUAGE RecordWildCards #-}   
import Data.Binary

type Name = String
type Address = String
type Phone = String

data Contacts = Contacts [(Name, Address)] deriving (Show)
instance Binary Contacts where
    put (Contacts set) = put set
    get = fmap Contacts get

data Contact = Contact { name :: Name, address :: Address, phone :: Phone } deriving (Show)
instance Binary Contact where
    put Contact{..} = do put name; put address; put phone
    get = do name <- get; address <- get; phone <- get; return Contact{..}

main :: IO ()
main = do
    let c = Contacts [("gert","home"),("gert2","home2")]
    let e = encode c
    print e
    let d = decode e
    print (d:: Contacts)

    let c' = Contact{name="gert",address="home",phone="test"}
    let e' = encode c'
    print e'
    let d' = decode e'
    print (d':: Contact) 
```

# knockout.js - 淘汰赛：根据另一个选择下拉列表的值添加/删除选择下拉列表

> ID：11905827
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:37:07.770
> 
> 标签：knockout.js

我正在使用敲除为以下情况构建用户界面： - 我有一系列项目。每个项目都有一个项目详细信息数组。- 项目详细信息可以是以下两种类型之一：“A 型”或“B 型”。- 如果项目详细信息的类型为 A，则它可以具有以下两种子类型之一：“子类型 A-1”和“子类型 A-2”。- 如果项目详细信息的类型为 B，则它没有子类型。

[我的小提琴](http://jsfiddle.net/casudeo/XscRT/2/)

我有两个问题/问题：

1.  我想根据“详细信息类型”下拉菜单的值添加/删除“详细信息子类型”下拉菜单。例如，如果用户选择“Type B”，我想删除“Detail Subtype”下拉菜单。我还想将基础“子类型”属性的值设置为 null。我玩了 if 绑定但无济于事
2.  在视图模型的 addItemDetail 方法中，如何添加新的项目详细信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:21:04.377

1）你几乎拥有它。您的 if 表达式中缺少 () 。

2）您可以像这样添加项目详细信息...

```
addItemDetail = function(item) {
    // what should be here to add a new detail to an item?
    selectedItem().itemDetails.push(new pm.ItemDetail());
}; 
```

我还修改了通过新项目添加项目详细信息的方式。请注意下面小提琴中的 for 循环。

这个小提琴具有以上所有内容。

[http://jsfiddle.net/johnpapa/FWFPV/](http://jsfiddle.net/johnpapa/FWFPV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:27:11.130

项目详细信息是一个可观察数组，其中包含包含常规属性的常规对象，而不是可观察对象。您已经创建了一个“pm.itemDetail”构造函数，那么为什么不使用它呢？

```
pm.Item = function(name, itemDetails) {
    // ...    
    var details = [];
    for (var i = 0; i < itemDetails.length; i++) {
        details.push( new pm.ItemDetail(itemDetails[i]) );
    }
    self.itemDetails = ko.observableArray(details);
}; 
```

我稍微更新了 pm.ItemDetail 函数：

```
pm.ItemDetail = function(data) {
    var self = this;
    self.name = ko.observable(data.name);
    self.type = ko.observable(data.type);
    self.subtype = ko.observable(data.subtype);
}; 
```

现在您可以使用“可见”绑定（“if”绑定隐藏 DOM 节点的内容，而不是节点本身）：

```
data-bind="visible: type() == 1, ..." 
```

* * *

要添加新的项目详细信息，只需创建一个“pm.ItemDetail”实例并将其推送到当前选定项目的 itemDetails 数组：

```
addItemDetail = function(item) {
    selectedItem().itemDetails.push(new pm.ItemDetail({
        name: "Please enter a name",
        type: 1,
        subtype: 1
    }));
}; 
```

[http://jsfiddle.net/XscRT/6/](http://jsfiddle.net/XscRT/6/)

# linux - nmap 在针对 localhost 以外的 ip 运行时显示打开的端口较少

> ID：11905830
> 
> 赞同：2
> 
> 时间：2012-08-10T16:37:13.210
> 
> 标签：linux, port, nmap

我在 vmware 工作站中有一个 vm，它是桥接网络和 DHCP。DHCP 服务器分配的 IP 为 10.21.245.22。这是我的 /etc/hosts 的样子：

127.0.0.1 hadoop-namenode-01 本地主机

我在盒子本身上运行命令 A 和 B。

命令 A：

root@hadoop-namenode-01:~# nmap -sT -sU -p- localhost

```
Starting Nmap 5.21 ( http://nmap.org ) at 2012-08-10 09:32 PDT
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00029s latency).
rDNS record for 127.0.0.1: hadoop-namenode-01
Not shown: 131058 closed ports
PORT      STATE         SERVICE
22/tcp    open          ssh
53/tcp    open          domain
631/tcp   open          ipp
8020/tcp  open          unknown
9000/tcp  open          cslistener
9001/tcp  open          tor-orport
50070/tcp open          unknown
53/udp    open|filtered domain
68/udp    open|filtered dhcpc
123/udp   open          ntp
5353/udp  open|filtered zeroconf
47982/udp open|filtered unknown

Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds 
```

命令 B：

root@hadoop-namenode-01:~# nmap -sT -sU -p- 10.21.245.22

```
Starting Nmap 5.21 ( http://nmap.org ) at 2012-08-10 09:28 PDT
Nmap scan report for wn7x64-3jql0q1.dub.emea.dell.com (10.21.245.22)
Host is up (0.00029s latency).
Not shown: 131065 closed ports
PORT      STATE         SERVICE
22/tcp    open          ssh
68/udp    open|filtered dhcpc
123/udp   open          ntp
5353/udp  open|filtered zeroconf
47982/udp open|filtered unknown

Nmap done: 1 IP address (1 host up) scanned in 12.20 seconds 
```

我的问题是：

因为我没有防火墙或类似的阻塞端口，为什么 nmap 在针对 localhost 运行时显示更多端口打开，而在针对 ip 运行时显示更少端口。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T16:38:49.953

> 为什么 nmap 在针对 localhost 运行时显示更多端口打开，而在针对 ip 运行时显示更少端口

一些应用程序决定`bind`仅在 localhost 上显式侦听（实际上），即`127.0.0.1`. 你可以做一个`netstat`检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T18:01:57.247

Linux中大部分系统运行进程使用loopback（127.0.0.1）ip地址相互通信。它不需要在网络外发送数据包。

# informix - Informix 4GL 和触发器

> ID：11905834
> 
> 赞同：1
> 
> 时间：2012-08-10T16:37:28.380
> 
> 标签：informix, 4gl

我想要一个用于重复检查的简单 SQL（触发器）。我的表名`test1`有 2 列，`code`并且`sname`. 在插入新记录之前，检查记录是否已经存在：如果存在，则产生错误，不插入；如果没有，让插入继续。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T01:31:03.810

确保表中没有重复数据的最简单、最可靠的方法是根本不使用触发器，而是使用 UNIQUE 或 PRIMARY KEY 约束：

```
CREATE TABLE test1
(
    code    INTEGER NOT NULL PRIMARY KEY,
    sname   VARCHAR(32) NOT NULL UNIQUE
); 
```

四个约束（两个 NOT NULL、一个 PRIMARY KEY、一个 UNIQUE）自动确保没有重复记录插入到表中。

如果您选择添加触发器，它将复制由这些约束完成的工作。

至于如何做，您需要创建一个从触发器语句调用的存储过程。它将被赋予新代码和新名称，并执行 SELECT 以查看是否出现任何匹配的记录，如果出现则引发异常，否则不会引发异常。

```
CREATE PROCEDURE trig_insert_test1(ncode INTEGER, nname VARCHAR(32))
    DEFINE ocode INTEGER;
    FOREACH SELECT code INTO ocode
              FROM test1
             WHERE code = ncode OR sname = nname
        RAISE EXCEPTION -271, -100, "Value to be inserted already exists in table test1";
    END FOREACH;
END PROCEDURE 
```

然后你使用：

```
CREATE TRIGGER ins_test1 INSERT ON test1
    REFERENCING NEW AS NEW
    FOR EACH ROW (EXECUTE PROCEDURE ins_trig_test1(new.code, new.sname)) 
```

在 Informix 4GL 中，您可以创建包含这些语句的字符串，然后准备和执行（和免费）它们，或者您可以使用 SQL 块：

```
SQL
    CREATE TRIGGER ins_test1 INSERT ON test1
        REFERENCING NEW AS NEW
        FOR EACH ROW (EXECUTE PROCEDURE ins_trig_test1(new.code, new.sname))
END SQL 
```

但是，正如我一开始所说，为此使用触发器并不是最好的方法。鉴于表定义，它是多余的。

我没有通过服务器运行任何 SQL 或 SPL；您需要检查分号是否在 SPL 中的正确位置，因为 SPL 对此很挑剔。

[您可以在Informix 11.70 Information Center](http://publib.boulder.ibm.com/infocenter/idshelp/v117/index.jsp)中找到 SQL 和 SPL 语句的语法。

# javascript - 使用 javascript 阻止文件上传对话框

> ID：11905836
> 
> 赞同：2
> 
> 时间：2012-08-10T16:37:34.743
> 
> 标签：javascript, asp.net

我有以下问题。

我有一个 aspx 文件上传输入，如果某些文本字段有值，则必须只显示文件对话框，否则我必须简单地显示一个更改语句来填充该字段。

我不能使用 jquery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:59:36.483

事件对象有一个[preventDefault](https://developer.mozilla.org/en-US/docs/DOM/event.preventDefault)函数，您可以使用它来阻止默认值继续。使用它，您可以将点击事件附加到文件上传，该事件将在尝试选择文件时触发。从那里您可以检查文本输入的值并返回/停止文件元素的默认值。

```
(function() {
  var __file = document.getElementById('file');
  var __text = document.getElementById('required');

  __file.addEventListener('click', function (e) {
    e = e || window.event;

    if ( __text.value.length === 0 )
    {
      e.preventDefault();
      return alert('Please fill out the textbox!');
    }

  })
})() 
```

注意：仅在 Chrome 中进行了测试。

# cuda - 在 PyCUDA 中打印消息

> ID：11905841
> 
> 赞同：5
> 
> 时间：2012-08-10T16:38:22.683
> 
> 标签：cuda, pycuda

在简单的 CUDA 程序中，我们可以通过包含 cuPrintf.h 来按线程打印消息，但是在 PyCUDA 中这样做并没有在任何地方解释。如何在 PyCUDA 中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-08T00:07:22.193

在 Compute Capability 2.0 和更高版本的 GPU 上，`cuPrintf.h`不鼓励使用 CUDA 的内置 printf()。要使用它，只需像在主机上一样`#include <stdio.h>`调用。`printf()`

PyCUDA wiki 有一个[具体的例子](http://wiki.tiker.net/PyCuda/Examples/UsingPrintf)。

# jquery - 设置滑动div的高度

> ID：11905849
> 
> 赞同：0
> 
> 时间：2012-08-10T16:38:37.380
> 
> 标签：jquery

如何将高度设置为垂直滑动的 div？我用过 jQuery，下面是它的代码：

当我说设置高度时，我的意思是 div 只滑动说 1000px 它将停止滑动？我遇到的问题是，在较小的屏幕尺寸中，滑动 div 总是希望显示，因此在某些页面上它会将页脚向下推，因此用户永远看不到页脚！？

[http://dev.assessmentday.co.uk/psychometric-test.htm](http://dev.assessmentday.co.uk/psychometric-test.htm)

谢谢。

210895

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:23:23.697

嗨，一种可能的解决方案是添加自动滚动条：

CSS：

```
#sidebar {
    overflow-y: auto;
} 
```

JS：

```
$(document).ready(function() {
    var topPadding = 15;
    var sidebar = $("#sidebar");
    sidebar.css('max-height', $(window).height() - 2*topPadding); // initialize max-height
    $(window).resize(function() {
        sidebar.css('max-height', $(window).height() - 2*topPadding);
    });
    $(window).scroll(function() {
        sidebar.stop().animate({
            marginTop: $(window).scrollTop() + topPadding
        });
    });
}); 
```

[jsFiddle](http://jsfiddle.net/Prjw3/)

您页面的 Javascript：

```
$(document).ready(function() {
    $(window).scroll(function() {
        var topPadding = 15;
        var crfoffset = $("div.contentRightFull").offset().top;
        var winoffset = $(window).scrollTop();
        var stioffset = $("#stickymojo").height() - $('#sidebar').height();
        var mtop = Math.max(0, winoffset-crfoffset);
        if (mtop>stioffset) { mtop = stioffset; }
        $("#sidebar").stop().animate({
            marginTop: mtop + topPadding
        });
    });
  }); 
```

# .net - 是否也使用 MSBuild 编译一个 csproj 编译引用的项目？

> ID：11905851
> 
> 赞同：1
> 
> 时间：2012-08-10T16:38:49.160
> 
> 标签：.net, msbuild, continuous-integration

我的问题很简单。如果我有多个通过项目引用相互引用的项目，我是否必须使用 MSBuild 编译一个完整的解决方案，或者我可以简单地编译我的一个项目，比如我的 Web 部署项目，MSBuild 会找出引用，并且为我编译引用的项目？

我正在尝试简化我们的 CI 环境，但奇怪的是我目前正在构建整个解决方案，然后是单独的部署项目。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:41:31.910

如果您还希望更新引用，则需要使用 msbuild 编译解决方案。这还要求解决方案设置为具有适当的依赖关系，并且项目设置为构建（通常默认情况下发生）。

编译单个 .csproj 只会编译该项目。

# php - 来自php数组的inArray jQuery，找到项目索引

> ID：11905856
> 
> 赞同：3
> 
> 时间：2012-08-10T16:39:05.257
> 
> 标签：php, jquery, arrays

我在网上某处找到的这段代码运行良好，这正是我想要完成的：

```
$(document).ready(function(){
    var arrData = [ "j", "Q", "u", "e","r","y" ];   
    alert(jQuery.inArray("Q", arrData));
}); 
```

但是，我有一个来自 php/mysql 循环的数组，我输出并保存如下：

```
$query = mysql_query("SELECT * FROM geo_orter");
            while(($row = mysql_fetch_assoc($query))){
                $i = $row['ort_id'];
                $result[$i] = $row['ortnamn'];
            };
            $allaOrterjson=json_encode($result); 
```

然后我继续这样做，它有效：

```
var allaOrter=<?php echo $allaOrterjson ?>;

    document.write(allaOrter[0] + allaOrter[1] + allaOrter[2]); 
```

并给我

> undefinedAborremålaAbbjörnahall

这是问题：

我试过

```
$(document).ready(function(){
    alert(jQuery.inArray("Aborremåla", allaOrter));
}); 
```

但它导致“-1”（未找到）。

我试图找出数组中一个项目的索引 nr 。有任何想法吗？

日志结果： ![登录](../Images/c252d89c75b900bc8460a37ee306f858.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:54:26.763

这里的问题是`json_encode($result);`创建一个 JSON**对象**，而不是一个数组。因此`jQuery.inArray`不起作用。

改为构建一个 JavaScript 数组：`[ "value", "value", "value", etc... ];`

或者对对象做这样的事情：

```
var locations = {
    "Abårremöla" : 1,
    "Stuff" : 2,
    "Ludvika" : 1549
};

var query = "Ludvika";
if(query in locations) {
    var id = locations[query];
    alert(id); //displays 1549
} 
```

为此，您必须在 PHP 中以另一种方式构建对象 - 因此使用位置名称作为索引器和 id 作为值的 PHP 数组：

```
$query = mysql_query("SELECT ort_id, ortnamn FROM geo_orter");
while(($row = mysql_fetch_assoc($query))){
    $index = $row['ortnamn'];     //<- note!
    $result[$i] = $row['ort_id']; //<- note!
};
$allaOrterjson=json_encode($result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:39:59.327

试试这个

```
var my_cars= new Array()
my_cars[0]="Mustang";

my_cars["family"]="Station Wagon";

my_cars["big"]="SUV";

for( var i in my_cars ){
    console.log( my_cars[i] );
}

var n = {
    "0": "Mustang",
    "family": " Station Wagon",
    "big": "SUV"
};
for( var i in n ){
    console.log( n[i] );
} 
```

# html - jQuery IMG 滑块 - 幻影边距

> ID：11905860
> 
> 赞同：0
> 
> 时间：2012-08-10T16:39:17.827
> 
> 标签：html, css, border, margin, padding

```
<div class="pictures">
    <ul>
        <li>
            <img src="img1.jpg" />
        </li>
        <li>
            <img src="img2.jpg" />
        </li>
        <li>
            <img src="img3.jpg" />
        </li>
    </ul>
</div> 
```

我正在构建一个 jQuery IMG 滑块，基本的代码分解就是您在上面看到的。我遇到了很多不同的问题，但有一个问题尤其令人困惑。每张照片之间似乎有部分像素空间（我相信是 1.5 像素）......不确定它是边距、填充、边框还是其他东西。我必须将照片 331.5px 向上或向下设置动画，以便它们正确地放置在容器 div 内。我的一般 reset.css 不起作用。默认情况下，我将边框、边距、边距宽度和填充都设置为 0。

这很奇怪。任何想法为什么会发生？或者我怎样才能消除它？

链接到实际页面： [http ://www.ficreates.com/_SiteDemos/PBL/projects.html](http://www.ficreates.com/_SiteDemos/PBL/projects.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:06:21.630

这里发生了几件事。

首先是`body {line-height: 1;}`由你的`ul`. 摆脱它或覆盖它，例如`ul {lineheight: 0;}`黑色间距消失了。

这样做不会对齐您的动画，因此您将不得不修复您的脚本。

我注意到的一件事是，您正在为`img`标签的位置设置动画，而不是容器元素，例如`ul`. 好奇你为什么这样做。通常只需在容器元素上执行 += 或 -= 即可。如果需要，您可以设置为`ul`。`display: block;`

希望这可以帮助。如果您还有其他问题，请告诉我。也许稍后我可以得到一个完整的工作示例。

# html - 阻止对锚元素的悬停效果

> ID：11905862
> 
> 赞同：1
> 
> 时间：2012-08-10T16:39:48.347
> 
> 标签：html, css, anchor, effect

我想在我的菜单上添加块悬停效果。但是，我购买的模板有一个很大的样式表，看起来像是来自 Darth Vader 的后端——我的编码知识有限，这使得这项任务变得困难。

这是我网站菜单部分的一个小提琴（它也包含整个样式表）：http: [//jsfiddle.net/VjhJ4/](http://jsfiddle.net/VjhJ4/)

悬停时，我想要一个块悬停效果，每个菜单链接具有不同的块颜色，以这张图片为例（请注意，当鼠标不在它上面时，我希望块很小）：[http://i.imgur .com/1xbbl.png](http://i.imgur.com/1xbbl.png)

我遇到了一个执行此操作的脚本。HTML：

```
<div id="links">
    <ul>
      <li><a href="#" title="Text">Link Heading One
        <em>Description of link.</em>
        <span>Date posted</span></a></li>
      <li><a href="#" title="Text">Link Heading One
        <em>Description of link.</em>
        <span>Date posted</span></a></li>
    </ul>
</div> 
```

CSS：

```
#links li {
        border: 1px dotted #999;
        border-width: 1px 0;
        margin: 5px 0;
}

#links li a {
        color: #990000;
        display: block;
        font: bold 120% Arial, Helvetica, sans-serif;
        padding: 5px;
        text-decoration: none;
}

 * html #links li a {  /* make hover effect work in IE */
    width: 400px;
}

#links li a:hover {
        background: #ffffcc;
}

#links a em {
        color: #333;
        display: block;
        font: normal 85% Verdana, Helvetica, sans-serif;
        line-height: 125%;
}

#links a span {
        color: #125F15;
        font: normal 70% Verdana, Helvetica, sans-serif;
        line-height: 150%;
} 
```

我读到悬停只适用于锚元素的某些 IE 版本，所以我认为这种技术是最好的。

现在，我怎样才能将它添加到我自己的页面？随时更新小提琴： http: [//jsfiddle.net/VjhJ4/](http://jsfiddle.net/VjhJ4/) 如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:07:27.327

您需要在悬停时添加边框底部和背景颜色。

请参阅此演示 [http://jsfiddle.net/enve/VjhJ4/7/](http://jsfiddle.net/enve/VjhJ4/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:18:31.413

我知道你对CSS不太了解，而且你买了一个模板，所以你一定不太了解它。

没关系，所以在所有人向您发送您不理解的东西和解决方案之前，我用您所指的图片更新了您的小提琴：

[这是你的小提琴](http://jsfiddle.net/VjhJ4/11/)

```
ul#secondary-menu a { font-size: 13px; color: #48423f; text-decoration: none; text-transform: uppercase; font-weight: bold; padding: 22px 16px 0 16px; }

ul#secondary-menu #menu-item-33 a {border-bottom:5px solid #00f;}
ul#secondary-menu #menu-item-34 a {border-bottom:5px solid #0f0;}
ul#secondary-menu #menu-item-35 a {border-bottom:5px solid #f00;}

ul#secondary-menu a:hover { color: #fff;text-shadow: 0 0;}

ul#secondary-menu #menu-item-33 a:hover {background-color:#00f;}
ul#secondary-menu #menu-item-34 a:hover{background-color:#0f0;}
ul#secondary-menu #menu-item-35 a:hover{background-color:#f00;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:46:37.860

改变：

```
a:hover { text-decoration: underline; } 
```

到（将颜色更改为您真正想要的任何颜色）：

```
a:hover { text-decoration: underline; background-color:red; } 
```

并改变：

```
a { text-decoration: none; color: #00b7f3;} 
```

到（将颜色更改为您真正想要的任何颜色）：

```
a { text-decoration: none; color: #00b7f3; border-bottom-color: red; border-bottom-style: solid; border-bottom-width: 5px;} 
```

演示：http: [//jsfiddle.net/KqaC8/](http://jsfiddle.net/KqaC8/)

编辑：这只会做悬停颜色，不悬停时处理底部颜色，请按住。

编辑2：这应该做你现在想要的一切。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T16:48:34.313

[**看到这个演示**](http://jsfiddle.net/VjhJ4/1/)。您需要在悬停时设置背景颜色等

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T16:49:43.427

如果您不想修改您拥有的模板中的 CSS，您可以执行以下操作...

```
li.menu-item:hover{background:red !important;} 
```

!important 只会覆盖模板样式

这是一个为您提供一些基本 css 的小提琴。您仍然可以使用 !important 来确保它覆盖您的模板代码[http://jsfiddle.net/cX5bk/](http://jsfiddle.net/cX5bk/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-10T16:52:27.937

[http://codepen.io/anon/pen/wqpdI](http://codepen.io/anon/pen/wqpdI)

这是我用我认为你需要的东西制作的一个例子。其实很简单，有很多方法可以做到！基本上每个链接（或其父链接）都需要一个类，然后您可以更改每个类标签的颜色。

# postgresql - 检查 Postgres 中是否存在序列（plpgsql）

> ID：11905868
> 
> 赞同：30
> 
> 时间：2012-08-10T16:40:25.773
> 
> 标签：postgresql, stored-procedures, plpgsql

我正在尝试在存储过程中测试序列是否已经存在。

```
IF EXISTS SEQUENCE seq_name
    RAISE EXCEPTION 'sequence % already exists!', seq_name
END IF; 
```

我已经尝试了上面片段的几种变体，但没有运气。我一定是给 Google 提供了错误的术语，因为我似乎找不到任何关于该主题的内容。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-10T17:06:31.867

您应该能够查询 pg_class 表以查看 relname 是否存在。

```
IF EXISTS (SELECT 0 FROM pg_class where relname = '<my sequence name here>' )
THEN
  --stuff here
END IF; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-08-10T18:36:05.570

如果您确定名称只能对序列有效（即，您确信它不会用于普通表、索引、视图、复合类型、TOAST 表或外部表），并且您不关心多个模式。换句话说，它适用于最常见的情况，但并不完全严格。

如果您想测试该名称的*序列*是否存在于特定*模式*中，这应该有效：

```
-- Clear the search path so that the regclass of the sequence
-- will be schema-qualified.
SET search_path = '';
-- Do your conditional code.
IF EXISTS (SELECT * FROM pg_class
             WHERE relkind = 'S'
               AND oid::regclass::text = 'public.' || quote_ident(seq_name))
  THEN
    RAISE EXCEPTION 'sequence public.% already exists!', seq_name
END IF;
-- Restore the normal search path.
RESET search_path; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-08-12T03:54:57.747

[**`to_regclass()`**](http://www.postgresql.org/docs/current/interactive/functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE)更新：在 Postgres **9.4**中简单地测试存在变得更加简单：

```
SELECT to_regclass('schema_name.table_name'); 
```

但请阅读详细信息：

*   [如何检查给定模式中是否存在表](https://stackoverflow.com/questions/20582500/how-to-check-if-a-table-exists-in-a-given-schema/24089729#24089729)

## 功能齐全

您需要检查*任何*会与名称冲突的类似表的对象，而不仅仅是序列。

如果名称可用，此函数会创建一个新序列，并在其他情况下分别发出有意义的`NOTICE`// `WARNING`：`EXCEPTION`

```
CREATE OR REPLACE FUNCTION f_create_seq(_seq text, _schema text = NULL)
  RETURNS void AS
$func$
DECLARE
   _fullname text := format('%I.%I', COALESCE(_schema,current_schema),_seq);
   _relkind "char" := (SELECT c.relkind
                       FROM   pg_namespace n
                       JOIN   pg_class c ON c.relnamespace = n.oid
                       WHERE  n.nspname = COALESCE(_schema, current_schema)
                       AND    c.relname = _seq);
BEGIN
   IF _relkind IS NULL THEN   -- name is free
      EXECUTE 'CREATE SEQUENCE ' || _fullname;
      RAISE NOTICE 'New sequence % created.', _fullname;

   ELSIF _relkind = 'S' THEN  -- 'S' = sequence
      IF has_sequence_privilege(_fullname, 'USAGE') THEN
         RAISE WARNING 'Sequence % already exists.', _fullname;
      ELSE
         RAISE EXCEPTION
           'Sequence % already exists but you have no USAGE privilege.'
         , _fullname;
      END IF;

   ELSE
      RAISE EXCEPTION 'A(n) "%" named % already exists.'
      -- Table-like objects in pg 9.4:
      -- www.postgresql.org/docs/current/static/catalog-pg-class.html
         , CASE _relkind WHEN 'r' THEN 'ordinary table'
                         WHEN 'i' THEN 'index'
                      -- WHEN 'S' THEN 'sequence'  -- impossible here
                         WHEN 'v' THEN 'view'
                         WHEN 'm' THEN 'materialized view'
                         WHEN 'c' THEN 'composite type'
                         WHEN 't' THEN 'TOAST table'
                         WHEN 'f' THEN 'foreign table'
                         ELSE 'unknown object' END
         , _fullname;
   END IF;
END
$func$  LANGUAGE plpgsql;

COMMENT ON FUNCTION f_create_seq(text, text) IS
'Create sequence if name is free.
RAISE NOTICE on successful creation.
RAISE WARNING if it already exists.
RAISE EXCEPTION if it already exists and current user lacks USAGE privilege.
RAISE EXCEPTION if object of a different kind occupies the name.
$1 _seq    .. sequence name 
$2 _schema .. schema name (optional; default is CURRENT_SCHEMA)'; 
```

称呼：

```
SELECT f_create_seq('myseq', 'myschema'); 
```

或者：

```
SELECT f_create_seq('myseq1');  -- defaults to current schema 
```

### 解释

*   还要阅读代码末尾的函数注释。

*   在 Postgres **9.1+**中工作。对于旧版本，您只需要替换`format()`- 即可防御 SQL 注入。细节：

    *   [Postgres 函数中的 SQL 注入与准备好的查询](https://dba.stackexchange.com/a/49718/3684)
*   两个单独的参数允许任何模式中的序列独立于当前模式`search_path`，也允许`quote_ident()`完成其工作。`quote_ident()`使用模式限定名称失败 - 会模棱两可。

*   schema 参数有一个默认值，因此您可以在调用中省略它。如果没有给出模式，则函数默认为`current_schema`. [根据文档：](http://www.postgresql.org/docs/current/interactive/functions-info.html#FUNCTIONS-INFO-SESSION-TABLE)

    > `current_schema`返回搜索路径中第一个模式的名称（如果搜索路径为空，则返回 null 值）。这是将用于在未指定目标架构的情况下创建的任何表或其他命名对象的架构。

*   [`pgclass.relkind`手册](http://www.postgresql.org/docs/current/interactive/catalog-pg-class.html)中的类型列表。

*   [PostgreSQL 错误代码](http://www.postgresql.org/docs/current/interactive/errcodes-appendix.html)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-06-15T09:06:05.393

如何使用信息模式：

```
SELECT COUNT(*) 
FROM information_schema.sequences 
WHERE sequence_schema=? AND sequence_name=? 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-13T23:45:03.793

```
select relname, relnamespace
from pg_class join pg_catalog.pg_namespace n ON n.oid = pg_class.relnamespace
where n.nspname='metastore_1' and relname='updater_state_id_seq'; 
```

结果：

```
 relname        | relnamespace 
-------------------------------------
 updater_state_id_seq |        32898 
```

此查询可以检查模式内是否存在序列。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-11T14:43:59.443

我不确定为什么必须检查序列的存在的实际意图。如果目标是在创建序列之前检查序列是否存在，则`IF NOT EXISTS`可以使用 PostgreSQL 中的条件：

```
CREATE SEQUENCE IF NOT EXISTS 'name' 
```

见[https://www.postgresql.org/docs/9.5/static/sql-createsequence.html](https://www.postgresql.org/docs/9.5/static/sql-createsequence.html)

# ios - 有没有办法对生成的 GIF 进行无损压缩？

> ID：11905872
> 
> 赞同：1
> 
> 时间：2012-08-10T16:40:38.193
> 
> 标签：ios, gif, lossless-compression

我们正在使用以下代码从一组 JPEG 图像生成 GIF 文件，对于进行无损压缩的设置，它似乎根本不会生成更小的文件。我们在这里做正确的事吗？

```
CGImageDestinationRef imageDestination = CGImageDestinationCreateWithURL((CFURLRef)pathUrl, CFSTR("com.compuserve.gif"), images.count, NULL);

// image/frame level properties
NSDictionary *imageProperties = [NSDictionary dictionaryWithObjectsAndKeys:
                                 [NSNumber numberWithFloat:delayTime], (NSString *)kCGImagePropertyGIFDelayTime,
                                 nil];
NSDictionary *properties = [NSDictionary dictionaryWithObjectsAndKeys:
                            imageProperties, (NSString *)kCGImagePropertyGIFDictionary, 
                            nil];

for (UIImage *image in [images objectEnumerator]) {
    CGImageDestinationAddImage(imageDestination, image.CGImage, (CFDictionaryRef)properties);
}

// gif level properties
NSDictionary *gifProperties = [NSDictionary dictionaryWithObjectsAndKeys:
                               [NSNumber numberWithInt:0], (NSString *)kCGImagePropertyGIFLoopCount,
                               [NSNumber numberWithInt:1.0], kCGImageDestinationLossyCompressionQuality,
                               nil];
properties = [NSDictionary dictionaryWithObjectsAndKeys:
              gifProperties, (NSString *)kCGImagePropertyGIFDictionary,
              nil];
CGImageDestinationSetProperties(imageDestination, (CFDictionaryRef)properties);
CGImageDestinationFinalize(imageDestination);
CFRelease(imageDestination); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-03T18:38:55.293

GIF 不支持该`kCGImageDestinationLossyCompressionQuality`属性。据我所知，iOS 上没有内置对压缩 gif 的支持——我无法让颜色映射工作。

```
const CFStringRef kCGImagePropertyGIFLoopCount;
const CFStringRef kCGImagePropertyGIFDelayTime;
const CFStringRef kCGImagePropertyGIFImageColorMap;
const CFStringRef kCGImagePropertyGIFHasGlobalColorMap;
const CFStringRef kCGImagePropertyGIFUnclampedDelayTime; 
```

参考：[https ://developer.apple.com/library/ios/documentation/graphicsimaging/Reference/CGImageProperties_Reference/Reference/reference.html#//apple_ref/doc/constant_group/GIF_Dictionary_Keys](https://developer.apple.com/library/ios/documentation/graphicsimaging/Reference/CGImageProperties_Reference/Reference/reference.html#//apple_ref/doc/constant_group/GIF_Dictionary_Keys)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:45:10.970

GIF 图像格式是无损压缩。但是，您正在压缩（有损）压缩格式。文件大小可能会增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:49:39.117

Jpeg 图像包含许多非常相似但不相同的像素，无损压缩方案很难压缩这些像素。为了获得更好的压缩，您必须首先量化颜色。在您丢失信息以使图像可压缩后，Gif 图像将是无损的。

# android - 泄漏的窗口，android.view.WindowLeaked

> ID：11905876
> 
> 赞同：0
> 
> 时间：2012-08-10T16:40:55.257
> 
> 标签：android, memory-leaks

我收到一个泄漏的窗口错误，但不知道为什么。我认为这与我的绘图画布有关？我可能完全错了。我正在从现有活动开始新的意图，当我点击后退按钮退出绘图活动并返回上一个活动时，应用程序崩溃。以下是错误：

```
08-10 09:30:31.708: E/WindowManager(1286): Activity com.pocketbeta.mainscreenActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4131d998 that was originally added here
08-10 09:30:31.708: E/WindowManager(1286): android.view.WindowLeaked: Activity com.pocketbeta.mainscreenActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4131d998 that was originally added here
08-10 09:30:31.708: E/WindowManager(1286):  at android.view.ViewRootImpl.<init>(ViewRootImpl.java:344)
08-10 09:30:31.708: E/WindowManager(1286):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:267)
08-10 09:30:31.708: E/WindowManager(1286):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:215)
08-10 09:30:31.708: E/WindowManager(1286):  at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:140)
08-10 09:30:31.708: E/WindowManager(1286):  at android.view.Window$LocalWindowManager.addView(Window.java:537)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.Dialog.show(Dialog.java:278)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.AlertDialog$Builder.show(AlertDialog.java:932)
08-10 09:30:31.708: E/WindowManager(1286):  at com.pocketbeta.mainscreenActivity.onCreate(mainscreenActivity.java:78)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.Activity.performCreate(Activity.java:4465)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
08-10 09:30:31.708: E/WindowManager(1286):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-10 09:30:31.708: E/WindowManager(1286):  at android.os.Looper.loop(Looper.java:137)
08-10 09:30:31.708: E/WindowManager(1286):  at android.app.ActivityThread.main(ActivityThread.java:4424)
08-10 09:30:31.708: E/WindowManager(1286):  at java.lang.reflect.Method.invokeNative(Native Method)
08-10 09:30:31.708: E/WindowManager(1286):  at java.lang.reflect.Method.invoke(Method.java:511)
08-10 09:30:31.708: E/WindowManager(1286):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-10 09:30:31.708: E/WindowManager(1286):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-10 09:30:31.708: E/WindowManager(1286):  at dalvik.system.NativeStart.main(Native Method)
08-10 09:30:31.708: W/KeyboardEx(635): loadKeyboard - non-fatal parsing problem
08-10 09:30:31.718: I/ActivityManager(212): START {cmp=com.pocketbeta/.drawings.DrawingActivity} from pid 1286
08-10 09:30:32.118: W/dalvikvm(1286): threadid=11: thread exiting with uncaught exception (group=0x40a4a1f8)
08-10 09:30:32.118: E/AndroidRuntime(1286): FATAL EXCEPTION: Thread-7539
08-10 09:30:32.118: E/AndroidRuntime(1286): java.lang.IllegalArgumentException
08-10 09:30:32.118: E/AndroidRuntime(1286):     at android.view.Surface.unlockCanvasAndPost(Native Method)
08-10 09:30:32.118: E/AndroidRuntime(1286):     at android.view.SurfaceView$4.unlockCanvasAndPost(SurfaceView.java:775)
08-10 09:30:32.118: E/AndroidRuntime(1286):     at com.pocketbeta.drawings.DrawingSurface$DrawThread.run(DrawingSurface.java:86) 
```

# autofac - 如何在 Autofac 中实现引用计数的共享实例？

> ID：11905879
> 
> 赞同：3
> 
> 时间：2012-08-10T16:41:01.193
> 
> 标签：autofac, reference-counting

我有`IService`几个组件依赖的服务。组件根据用户操作来来去去。

碰巧 的实现`IService`很昂贵，我希望在所有组件之间共享 1 个实例。到目前为止一切顺利，我可以使用：

```
builder.RegisterType<ExpensiveStuff>().As<IService>().SingleInstance(); 
```

然而，我不想`ExpensiveStuff`一旦建成就永远活下去；我只希望它在一个或多个组件持有对它的引用时存在。

在 Autofac 中是否有内置的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:55:19.693

我认为您必须确保您对这些依赖项的使用发生在[实例范围内](http://code.google.com/p/autofac/wiki/InstanceScope "Autofac 文档维基页面")。

Orchard 项目可能是这里的灵感来源。他们为工作单元使用一组范围；[查看`ShellContainerFactory.cs`源文件](http://orchard.codeplex.com/SourceControl/changeset/view/95f0539354b2#src%2fOrchard%2fEnvironment%2fShellBuilders%2fShellContainerFactory.cs)。

# c - 实现用户定义的 malloc() 函数？

> ID：11905880
> 
> 赞同：3
> 
> 时间：2012-08-10T16:41:11.277
> 
> 标签：c, memory-management, operating-system, malloc

如何创建用`malloc()`C 语言定义的新函数？

我什至没有关于如何做到这一点的精灵提示，如何将虚拟空间地址与物理空间映射，遵循什么算法？我确实知道 malloc() 效率不高，因为它会导致碎片。所以可以创造一些有效的东西。即使效率不高，如何实现一个幼稚的 C malloc 函数？

最近在接受采访时被问到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T16:56:47.927

Wikipedia 实际上提供了各种 malloc 实现的很好的总结，包括针对特定条件优化的实现，以及了解更多有关实现的链接。

[http://en.wikipedia.org/wiki/C_dynamic_memory_allocation](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation)

[dlmalloc](ftp://g.oswego.edu/pub/misc/)

> 通用分配器。GNU C 库 (glibc) 使用基于 dlmalloc 的分配器。

[杰马洛克](http://www.canonware.com/jemalloc/)

> 为了避免锁争用，jemalloc 为每个 CPU 使用单独的“arenas”。在多线程应用程序中测量每秒分配数的实验表明，这使得它与线程数成线性关系，而对于 phkmalloc 和 dlmalloc 来说，性能与线程数成反比。

[囤积内存分配器](http://en.wikipedia.org/wiki/Hoard_memory_allocator)

> Hoard 专门使用 mmap，但以 64 KB 的块（称为超级块）管理内存。Hoard 的堆在逻辑上分为单个全局堆和多个每个处理器的堆。此外，还有一个线程本地缓存，可以容纳有限数量的超级块。通过仅从本地每个线程或每个处理器堆上的超级块分配，并将大部分为空的超级块移动到全局堆以便它们可以被其他处理器重用，Hoard 保持低碎片，同时实现与线程数接近的线性可伸缩性.

[tcmalloc](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation#cite_note-14)

> 每个线程都有用于小分配的本地存储。对于大型分配，可以使用 mmap 或 sbrk。TCMalloc 是 Google 开发的 malloc，具有用于本地存储死线程的垃圾收集。对于多线程程序，TCMalloc 被认为比 glibc 的 ptmalloc 快两倍以上。

[dmalloc](http://dmalloc.com/) （*维基百科未涵盖*）

> 调试内存分配或 dmalloc 库被设计为替代系统的 malloc、realloc、calloc、free 和其他内存管理例程，同时提供在运行时可配置的强大调试工具。这些工具包括内存泄漏跟踪、fence-post 写入检测、文件/行号报告和一般统计记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T16:52:20.567

我认为这是[C Programming Language 书 8.7 章中的一个例子中](https://rads.stackoverflow.com/amzn/click/com/0131103628)的 malloc 的一个很好的例子：

# maven - IntellijIDEA 中一个项目的多个开发环境

> ID：11905882
> 
> 赞同：0
> 
> 时间：2012-08-10T16:41:12.320
> 
> 标签：maven, web, intellij-idea, project

我正在使用**IntellijIDEA (11.1.3)**开发大型网络项目。

我想有一些环境，我将在 HTML 模板下工作。我不会在那里使用任何服务器端编程，只使用`HTML`标记、`CSS`样式表和`JavaScript`.

同样，我需要不同的环境，我将在其中创建动态应用程序，不仅使用标记、样式表和客户端编程，还使用`Maven`​​, `Spring MVC`, `Hibernate`,`PostgreSQL`可能还有其他技术。

我将使用**Tomcat**将我的模板和我的最终应用程序部署到容器中，以便在浏览器中查看它。

问题是如何构建我的项目？

如果有人可以向我展示创建示例项目的分步说明，那将是非常棒的，但任何建议都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:15:42.430

IntelliJ IDEA 11 为纯 HTML/JS 项目提供了一种特殊的**Web**模块类型，为其他技术创建一个这种类型的模块和另一个**Java**模块。

# asp.net - 在.net中迭代集合

> ID：11905889
> 
> 赞同：0
> 
> 时间：2012-08-10T16:41:53.377
> 
> 标签：asp.net, .net

我有一个有这个代码的类，

```
pCollection pub = RSSXmlDeserializer.GetPub(path, fReload); 
```

get pub 是返回 pub 集合的方法...

我怎样才能迭代它们。我试过，

```
for (var n = 0; n < pub.Count; n++ ){ 
```

}

这是 getPub 方法

```
 public static PCollection GetPub(string path, bool fReload)
    {
        HttpApplicationState session = HttpContext.Current.Application;

        PCollection pub = session["PUB"] as PCollection;

        if pub == null || fReload)
        {
            StreamReader reader = null;

            try
            {
                XmlSerializer serializer = new XmlSerializer(typeof(PCollection));
                reader = new StreamReader(path);
                pub = (PCollection)serializer.Deserialize(reader);
                session["PUB"] = pub;
            }
            catch (Exception ex)
            {
                //throw ex;
            }
            finally
            {
                reader.Close();
            }
        }
        return pub;
    }

}

[Serializable()]
public class Pub
{
    [System.Xml.Serialization.XmlElement("title")]
    public string Title { get; set; }

    [System.Xml.Serialization.XmlElement("description")]
    public string Description { get; set; }

    [System.Xml.Serialization.XmlElement("imageUrl")]
    public string ImageUrl { get; set; }

}

[Serializable()]
[System.Xml.Serialization.XmlRoot("RPublications")]
public class PCollection
{
    [XmlArray("Pub")]
    [XmlArrayItem("Pub", typeof(Pub))]
    public Pub[] Pub { get; set; }
} 
```

但“计数”不被识别。我收到此消息，pCollection 没有“计数”的定义...

我如何迭代集合 n 获取集合元素？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:48:41.363

你可以使用：

```
foreach(var p in pub.Pub)
{
     // Do work on p
} 
```

请注意，您的`PCollection`类没有遵循良好的 .NET 实践，因为它被命名为“集合”，但没有实现任何集合的标准接口。您可能需要考虑将其重新设计为更加“标准化”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:56:16.590

`PCollection`并不是真正的收藏。它是一个包含集合（更准确地说是数组）的类。所以要迭代你需要迭代数组：

```
for (Int32 i = 0; i < pub.Pub.Length; ++i) {
  Pub p = pub.Pub[i];
  ...
} 
```

或者，如果您不关心索引并且只想从头到尾浏览集合：

```
foreach (Pub p in pub.Pub) {
  ...
} 
```

（更一致的类型和成员命名可能会有所帮助。）

# facebook-like - django-facebook 登录

> ID：11905894
> 
> 赞同：1
> 
> 时间：2012-08-10T16:42:04.783
> 
> 标签：facebook-like, facebook-opengraph, django-facebook

我想在我的网站上实现 facebook 登录、点赞、分享、评论等。我想使用 django-facebook api 并为此打开图形。我没有从任何站点获得适当的文档。有人可以帮助我吗？

# mysql - MySQL远程连接[不像往常一样]

> ID：11905895
> 
> 赞同：6
> 
> 时间：2012-08-10T16:42:10.117
> 
> 标签：mysql, linux, connection, firewall

我无法从外部访问 mysql。我认为这是 mysql 或防火墙的东西或 mysql 中的某些特权。

我已经尝试过执行互联网上的步骤。我将逐步介绍该过程以举例说明我在做什么，并为遇到同样问题的其他人提供教程：

我正在使用：

```
-ubuntu server 12.04 
-mysql-server5.5
-there is NO hardware firewall just software one 
```

**1-首先我安装了mysql：**

```
sudo apt-get install mysql-server 
```

**2-我通过以下方式更改了root密码：**

```
sudo /etc/init.d/mysql stop
sudo mysqld --skip-grant-tables &
mysql -u root mysql
UPDATE user SET Password=PASSWORD('MYPASSWORD') WHERE User='root'; FLUSH PRIVILEGES; exit; 
```

**3-我将所有特权授予root到任何ip：**

```
mysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'password' WITH GRANT OPTION;
mysql> FLUSH PRIVILEGES; 
```

**4-在我编辑了 my.cnf 之后**

```
sudo nano /etc/mysql/my.cnf 
```

我评论了这些行，如下所示：

```
#skip-external-locking 
#bind-address           = 127.0.0.1 
```

**5-我编辑了 iptables 以允许 MySql 3306：**

```
iptables -A INPUT -i eth0 -p tcp -m tcp --dport 3306 -j ACCEPT 
```

现在输入 netstat -ant：

```
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:110             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:143             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:10000           0.0.0.0:*               LISTEN
tcp        0      0 66.123.173.170:53       0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:953           0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:993             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:995             0.0.0.0:*               LISTEN
tcp        0      0 66.123.173.170:22       189.32.2.232:49167      ESTABLISHED
tcp        0    336 66.123.173.170:22       189.32.2.232:49654      ESTABLISHED
tcp6       0      0 :::110                  :::*                    LISTEN
tcp6       0      0 :::143                  :::*                    LISTEN
tcp6       0      0 :::8080                 :::*                    LISTEN
tcp6       0      0 :::21                   :::*                    LISTEN
tcp6       0      0 :::53                   :::*                    LISTEN
tcp6       0      0 :::22                   :::*                    LISTEN
tcp6       0      0 ::1:953                 :::*                    LISTEN
tcp6       0      0 :::25                   :::*                    LISTEN
tcp6       0      0 :::993                  :::*                    LISTEN
tcp6       0      0 :::995                  :::*                    LISTEN
tcp6       0      0 127.0.0.1:8005          :::*                    LISTEN 
```

看到 3306 端口是打开的！我对吗？

**6-我重新启动了mysql：**

```
sudo service mysql start 
```

我输入：

```
service mysql status 
```

结果：

```
mysql start/running, process 20757 
```

**7-我尝试连接到服务器：**

```
mysql -h 66.123.173.170 -u root -p 
```

我收到了这个错误：

> 错误 2003 (HY000): 无法连接到“66.123.173.170”上的 MySQL 服务器 (111)

当我做：

```
mysql -h 127.0.0.1 -u root -p 
```

它可以打开 MySQL> 终端

**8- 疑问：你觉得这个过程有什么问题吗？**

OBS：在第4步，我也尝试将绑定地址设置为bid-address = 0.0.0.0，但没有解决问题。

**9- 疑问：如果我用以下命令关闭 MySQL：`service mysql stop`那么，我可以用 mysql -h 127.0.0.1 -u root -p 在本地访问防火墙吗？**

我做到了，即使 mysql 停止/等待，我也可以连接（这是停止和检索 MySQL 状态后给出的状态）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T03:38:48.177

**恢复解决方案：**

我杀死了持有 3306 端口的 mysqld 并重新启动它。

我认为这是一个错误或相关的检查一步一步我做了什么：

**1- 创建一个程序来连接 3306**

首先，我用 Java 创建了一个简单的程序，以确保我的防火墙没有任何问题。程序只是在3306上打开一个端口用TCP连接2分钟只是为了测试，程序：

```
import java.io.IOException;
import java.net.ServerSocket;

public class PortMysqlTest {
    public static void main(String[] args) {
        int port = 3306;

        ServerSocket ss = null;
        try
        {
            ss = new ServerSocket(port);
            ss.setReuseAddress(true);
        }
        catch (IOException e)
        {
            System.out.println(e.getMessage());
        }

        long futureTime = System.currentTimeMillis() + 1000 * 60 * 2;
        while (System.currentTimeMillis() < futureTime)
        {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        if (ss != null)
        {
            try
            {
                ss.close();
            }
            catch (IOException e)
            {
                System.out.println(e.getMessage());
            }
        }       
    } 
```

**2-停止mysql服务**

在执行程序之前，我停止了 mysql 服务：

```
sudo service mysql stop 
```

或者可以通过以下方式完成：

```
/etc/init.d/mysql stop 
```

**3- 使用 java PortMysqlTest 启动我的程序**

我的程序（PortMysqlTest）抛出一个异常，指出地址/端口已被 mysqld 使用！

惊喜？据我所知，与 mysql 服务停止的端口应该是免费的。我对吗？（我不确定是否有人可以回答这个问题......）

**4- 我搜索了使用地址/端口的应用程序 PID：**

```
sudo netstat -lpn | grep 3306 
```

答案：

```
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      6736/mysqld 
```

**5-我用以下方法杀死了这个过程：**

```
kill -9 6736 
```

OBS，如果你不知道 kill 做什么：6736 是持有端口的进程，我在第 4 步得到了这个数字，6736/mysqld

**6-现在我再次运行我的程序：**

java PortMysqlTest 并与 telnet (telnet 66.123.173.170 3306) 外部连接，***它工作***！

所以问题*不在于防火墙*，因为我可以从外部连接到机器 66.123.173.170。

**7-再次启动mysql服务：**

（我等了 2 分钟让我的程序停止并释放 3306 端口）并再次启动 mysql 服务进行测试，其中：

```
sudo service mysql start 
```

或者

```
sudo /etc/init.d/mysql start 
```

**8- 我确实通过 telnet 进行了外部连接：**

```
telnet 66.123.173.170 3306 
```

***并且工作！！！***

在我尝试通过以下方式连接到 mysql 之后：

```
mysql -h 66.123.173.170 -u root -p 
```

***并且工作！！！***

**结论：** 我认为我的 MySql 安装存在错误；或者什么，（我不知道是什么），重新启动mysql时，mysql没有得到以下配置：

```
bind-address = 0.0.0.0 
```

或者

```
bind-address = * 
```

我希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:50:11.463

您的 netstat 输出显示它未对外部连接开放，它应该显示`0.0.0.0`在那里而不是`127.0.0.1`（这是环回，不是本地的）。

您可能需要向`bind-address`您的 mysql 配置添加不同的内容（并且不要忘记重新启动服务）。

尝试

`bind-address = *`

或者你的实际 NIC ip ( `66.123.173.170`) 也许。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:05:57.153

您需要将 my.cnf 中的绑定地址设置为 0.0.0.0 而不仅仅是注释掉该行。

作为旁注，您可能不应该像您所说的那样允许从所有 IP 地址进行 root 访问。我只会将 root 限制为本地机器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T17:56:25.860

默认情况下，MySQL 在 localhost 上侦听。您需要将其配置为在您的实际界面上运行，或者您可以在绑定中使用 0.0.0.0 地址。

# php - PHP array_key_exists - 对某些类型宽松，对另一种严格

> ID：11905896
> 
> 赞同：1
> 
> 时间：2012-08-10T16:42:13.403
> 
> 标签：php, arrays

即使比较了解 PHP 的特性，以下[奇怪的行为](http://codepad.org/rIm3Ofrm)今天仍然让我感到困惑：

```
// loose
$a = array(true => 'foo');
var_dump(array_key_exists(1, $a));

// strict
$a = array('7.1' => 'foo');
var_dump(array_key_exists('7.10', $a)); 
```

我想知道这种效果的技术原因是什么，所以问题是，这个函数背后的过程是什么导致某些类型的值被松散地比较而其他类型的值被严格地比较？我不是在抱怨这种行为，而是试图理解这一点，所以“PHP 糟透了”的评论毫无意义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:45:21.743

在您的第一种情况下，布尔值不是有效的数组键，因此在初始化数组时它会立即变为 1，从而使您的搜索匹配。

在第二种情况下，数组键是一个字符串，并且 '7.1' 与 '7.10' 不是同一个字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:48:32.977

这[在此处](http://php.net/manual/en/language.types.array.php)记录。请注意，键是整数或字符串。文档中提到了特定的键转换，特别是（对于您的情况）将 bool 转换为整数（即*​​ true*为 1，*false*为 0）。如其他地方所述，您的其他示例是字符串（删除引号以使其浮动，然后根据文档将其截断为整数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:45:52.413

在您的第二个示例中，`'7.1'`并且`'7.10'`是字符串。它们作为字符串进行比较，因此它们不匹配。

现在为什么你在第一个例子中有一个匹配项？数组键可以是字符串或整数。So`true`被转换为整数，其计算结果为`1`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T16:47:41.277

也许你可以在那里添加脚本输出？乍一看：布尔值作为数组键？我认为那不会有任何帮助！第二：7.10 与 7.1 不同 - 在 '' 中声明它使其成为字符串....

如果您想将 true 作为键名，则需要将其封装在单引号或双引号中。如果您不了解 PHP 和单/双引号，它将导致内容被视为字符串值而不是布尔整数（真/假）

# routes - Expression Engine v1.6.8 在哪里处理路由

> ID：11905897
> 
> 赞同：0
> 
> 时间：2012-08-10T16:42:16.837
> 
> 标签：routes, expressionengine

我需要更新现有的 EE 1.6.8 站点，但我似乎找不到该版本的任何文档。我将实时站点复制到开发服务器上，但遇到了麻烦。主页工作正常，但所有其他页面都坏了。

mysite.org - 作品

mysite.org/about-us/ - 不起作用

URL是如何产生的？我找不到 .htaccess 。有没有创建路线的地方？

任何方向将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:40:30.557

Sean - EE 的路由基于模板组和模板。因此`/news`将`index`在`news`模板组中加载模板。`news/entry/my-great-news-entry`将`url_title` `my-great-news-entry`使用`entry`里面的模板加载条目`news`模板加载条目。

[这是 1.x 文档中的文档。](http://expressionengine.com/legacy_docs/general/urls.html)

如果您使用的是[Pages 模块](http://expressionengine.com/legacy_docs/modules/pages/index.html)（允许您为每个条目指定完整的 URL）或[Structure 模块](http://buildwithstructure.com/)，则例外情况。

请注意，开箱即用，EE 需要 /`index.php/`在路径中。您可以重命名它，或使用一些 .htaccess -[请参阅此 SO answer 以了解该语法](https://stackoverflow.com/questions/11142853/expression-engine-removing-index-php-completely/11143216#11143216)。

# python - 如何在 Python 中从文本文件中导入矩阵

> ID：11905899
> 
> 赞同：3
> 
> 时间：2012-08-10T16:42:21.760
> 
> 标签：python, import, matrix, numpy, load

嘿，这可能是一个简单的问题，但我以前从未将任何文件导入 Python。

所以我在一个名为 的文本文件中有一个 numpy 矩阵`dmatrix.txt`，那么如何将文件导入 Python 并使用该矩阵？

我正在尝试使用`numpy.load()`，但我不确定如何使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:46:21.993

试试[`numpy.loadtxt('dmatrix.txt')`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html)；`delimiter`如果文件以逗号分隔或其他内容，则可以添加参数。

[`numpy.load`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html)用于 numpy/python 二进制格式的文件 - 由[`numpy.save`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html)、[`numpy.savez`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html)或[`pickle`](http://docs.python.org/library/pickle.html).创建

# php - 同步本地和远程网站

> ID：11905921
> 
> 赞同：3
> 
> 时间：2012-08-10T16:43:41.400
> 
> 标签：php, mysql, algorithm, database-design, synchronization

我正在尝试开发一个网站，它有两个部分：本地部分和互联网上的远程部分。

用户每天更新本地网站，远程网站应由本地部分自行同步（也可以由用户手动完成）。

该网站包含一个`mysql`数据库，其中包含 4 或 5 个表格和一些图像作为文件。

现在我正在寻找最好的方法来理解这个图片或行是新的系统，所以你应该插入它或者它已经被修改了，所以更新它。

我正在考虑`timestamp`随机`md5`作为每个数据库和另一个数据库中的字段来保存文件名。因此，检查它们，如果一件事（时间戳或随机 md5）发生变化，请更新这些行。

这是一个好方法，还是有更简单的方法来做到这一点？我想用 Yii 或 CodeIgniter 和 Mysql 数据库开发这个网站。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T16:49:11.517

1.  设置 MySQL 复制。
2.  如果您的远程服务器无法连接到本地服务器，请打开通用日志并在远程服务器上定期重播。
3.  如果您不能执行其中任何一项，请使用“ON UPDATE CURRENT_TIMESTAMP”创建一个 TIMESTAMP 类型的“last_modified”列。您不需要直接更新此列，对行的任何更改都会自动更新它。有了这个，您可以选择/转储更改的行并创建一个脚本来更新远程主机上的这些行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T16:49:07.057

对于文件，我会使用[rsync](http://ss64.com/bash/rsync.html)。

```
rsync -avz /www/development USERNAME@REMOTE_HOST:/www/production/ 
```

对于 MySQL，我会创建一个更新 SQL 表的 cron 脚本。

```
mysqldump -al --password=LOCAL_PASS --add-drop-table DB_NAME TABLE_NAME | mysql -h REMOTE_HOST --password=REMOTE_PASS DB_NAME; 
```

如果您想一次获取单个记录，则时间戳的想法会起作用。然后你应该保留一个 last_sync 记录，并从 date > last_sync 的表中选择 *。

给这只猫剥皮的方法有很多。

# android - Android 第一个应用程序，所有活动都在菜单中可见

> ID：11905923
> 
> 赞同：-1
> 
> 时间：2012-08-10T16:44:19.560
> 
> 标签：android

我刚刚创建了我的第一个 Android 应用程序，一切正常，但所有活动都显示在我的 Android 菜单上。我做错什么了？

截图：imgur.com/9CmXU 我想要一个图标，指向 MainActivity，而不是所有活动

```
 <!-- language-all: lang-html -->
     <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.myApps.birthdaymeter"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/my_logo"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".BirthdayMeter"
            android:label="@string/title_activity_birthday_meter" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".AboutWindow"
            android:label="@string/title_activity_about_window" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".ShowResult"
            android:label="@string/title_activity_show_result" >
            <intent-filter>

  <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

这是我的清单，更改徽标没有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:54:20.420

该`<intent-filter>`标签用于描述每个 Activity 将响应的 Intent 类型。该`"android.intent.action.MAIN"`操作表示此 Activity 是您的应用程序的入口点（想想 java 程序所需的主要方法）。该`"android.intent.category.LAUNCHER"`类别告诉操作系统在您的应用程序列表中显示活动。添加`DEFAULT`类别是可以的，但实际上与完全省略`<intent-filter>`标签相同（我发现这可以使代码更清晰、更容易阅读）。您应该只在`<intent-filter>`用户打开您的应用程序时启动的 Activity 上使用带有这两个操作和类别的标签。如果希望您的应用程序中的 Activity 能够响应某些特殊意图，您将使用标签来定义它响应的内容。

这是 google 开发页面的链接，可帮助您了解有关 Intent 过滤器的更多信息。

[http://developer.android.com/guide/components/intents-filters.html](http://developer.android.com/guide/components/intents-filters.html)

这是`<intent-filter>`标签的文档。虽然这不是最容易理解的。

[http://developer.android.com/guide/topics/manifest/intent-filter-element.html](http://developer.android.com/guide/topics/manifest/intent-filter-element.html)

这是 Manifest 文件和 Intent 类的文档。如果您不确定要在 Manifest 中使用哪些标签，这两个都可以作为参考。祝你好运！

[http://developer.android.com/guide/topics/manifest/manifest-intro.html](http://developer.android.com/guide/topics/manifest/manifest-intro.html)

[http://developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:46:52.400

你的问题非常笼统，所以我不知道该回答什么。`nameOfActivity.this.finish()`当您启动另一个活动时，您似乎还没有打电话

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:13:36.663

如果您发布清单文件，我可以提供更多帮助，但在我看来，您没有正确声明您的活动。

它应该设置得有点像这样：

```
<application android:icon="@drawable/icon" android:label="@string/app_name">
    <activity android:name="Activity1"></activity>
    <activity android:name="Activity2"></activity>
    <activity android:name="Activity3"></activity>
</application> 
```

本质上，创建一个应用程序声明，然后在其中包含每个活动。

# ruby - Ruby on Rails regexp equals-tilde vs. array include 用于检查选项列表

> ID：11905925
> 
> 赞同：5
> 
> 时间：2012-08-10T16:44:29.180
> 
> 标签：ruby, regex, ruby-on-rails-3

我正在使用带有 Ruby 1.9.3p0 的 Rails 3.2.3。

我发现我经常必须确定字符串是否出现在选项列表中。看来我可以使用 Ruby 数组[`.include`方法](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-include-3F)：

```
<% if ['todo','pending','history'].include?(params[:category]) %> 
```

或正则表达式[equals-tilde 匹配](http://www.ruby-doc.org/core-1.9.3/Regexp.html#method-i-3D-7E)使用竖线分隔选项的简写：

```
<% if params[:category] =~ /todo|pending|history/ %> 
```

就性能而言，一个比另一个更好吗？

有更好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T18:20:30.843

**摘要**：*`Array#include?`对于`String`接受和拒绝的输入，元素都获胜，对于您的示例，只有三个可接受的值。`Set#include?`对于要检查的更大的集合，看起来`String`元素可能会获胜。*

* * *

**如何测试**

我们应该根据经验进行测试。

以下是您可能还需要考虑的几个替代方案：预编译的正则表达式、符号列表和`Set`带有`String`元素的 a。

我想性能也可能取决于您的大部分输入是否属于预期的集合并被接受，或者大多数输入是否在集合之外并被拒绝。

这是一个经验测试脚本：

```
require 'benchmark'
require 'set'

strings = ['todo','pending','history']
string_set = Set.new(strings)
symbols = strings.map(&:to_sym)
regex_compiled = Regexp.new(strings.join("|"))

strings_avg_size = (strings.map(&:size).inject {|sum, n| sum + n}.to_f / strings.size).to_i
num_inputs = 1_000_000

accepted_inputs = (0...num_inputs).map { strings[rand(strings.size)] } 
rejected_inputs = (0...num_inputs).map { (0..strings_avg_size).map { ('a'...'z').to_a[rand(26)] }.join }

Benchmark.bmbm(40) do |x|
  x.report("Array#include?, Strings, accepted:") { accepted_inputs.map {|s| strings.include?(s) } }
  x.report("Array#include?, Strings, rejected:") { rejected_inputs.map {|s| strings.include?(s) } }
  x.report("Array#include?, Symbols, accepted:") { accepted_inputs.map {|s| symbols.include?(s.to_sym) } }
  x.report("Array#include?, Symbols, rejected:") { rejected_inputs.map {|s| symbols.include?(s.to_sym) } }
  x.report("Set#include?, Strings, accepted:") { accepted_inputs.map {|s| string_set.include?(s) } }
  x.report("Set#include?, Strings, rejected:") { rejected_inputs.map {|s| string_set.include?(s) } }
  x.report("Regexp#match, interpreted, accepted:") { accepted_inputs.map {|s| s =~ /todo|pending|history/ } }
  x.report("Regexp#match, interpreted, rejected:") { rejected_inputs.map {|s| s =~ /todo|pending|history/ } }
  x.report("Regexp#match, compiled, accepted:") { accepted_inputs.map {|s| regex_compiled.match(s) } }
  x.report("Regexp#match, compiled, rejected:") { rejected_inputs.map {|s| regex_compiled.match(s) } }
end 
```

* * *

**结果**

```
Rehearsal ---------------------------------------------------------------------------
Array#include?, Strings, accepted:        0.210000   0.000000   0.210000 (  0.215099)
Array#include?, Strings, rejected:        0.530000   0.010000   0.540000 (  0.543898)
Array#include?, Symbols, accepted:        0.330000   0.000000   0.330000 (  0.337767)
Array#include?, Symbols, rejected:        1.870000   0.050000   1.920000 (  1.923155)
Set#include?, Strings, accepted:          0.270000   0.000000   0.270000 (  0.274774)
Set#include?, Strings, rejected:          0.460000   0.000000   0.460000 (  0.463925)
Regexp#match, interpreted, accepted:      0.380000   0.000000   0.380000 (  0.382060)
Regexp#match, interpreted, rejected:      0.650000   0.000000   0.650000 (  0.660775)
Regexp#match, compiled, accepted:         1.130000   0.080000   1.210000 (  1.220970)
Regexp#match, compiled, rejected:         0.630000   0.000000   0.630000 (  0.640721)
------------------------------------------------------------------ total: 6.600000sec

                                              user     system      total        real
Array#include?, Strings, accepted:        0.210000   0.000000   0.210000 (  0.219060)
Array#include?, Strings, rejected:        0.430000   0.000000   0.430000 (  0.444911)
Array#include?, Symbols, accepted:        0.340000   0.000000   0.340000 (  0.341970)
Array#include?, Symbols, rejected:        1.080000   0.000000   1.080000 (  1.089961)
Set#include?, Strings, accepted:          0.270000   0.000000   0.270000 (  0.281270)
Set#include?, Strings, rejected:          0.400000   0.000000   0.400000 (  0.406181)
Regexp#match, interpreted, accepted:      0.370000   0.000000   0.370000 (  0.366931)
Regexp#match, interpreted, rejected:      0.560000   0.000000   0.560000 (  0.558652)
Regexp#match, compiled, accepted:         0.920000   0.000000   0.920000 (  0.915914)
Regexp#match, compiled, rejected:         0.620000   0.000000   0.620000 (  0.627620) 
```

* * *

**结论**

（见上面的总结）

对我来说，经过反思，符号数组对于被拒绝的输入来说会非常慢，因为在进行检查之前，这些随机字符串中的每一个都必须被保存在符号表中。

即使经过深思熟虑，编译后的 Regexp 的性能也会如此糟糕，这对我来说意义不大，尤其是与在代码中解释为文字的 Regexp 相比。谁能解释为什么它做得这么糟糕？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T18:34:26.980

@ms-tg 的[答案](https://stackoverflow.com/a/11907146/624590)有很好的基准，就我而言，可以很好地回答您的问题。我只是想补充一点：注意这一点，因为这两个选项并不总是有相同的结果：

```
params = Hash.new
keyword_array = ['todo','pending','history']  
included = nil

params[:category] = "history plus other text" 

start_time = Time.now
1000.times do
   included = keyword_array.include?(params[:category])
end
puts "Array.include? returned #{included} in #{(Time.now - start_time)*1000}ms"    
start_time = Time.now
1000.times do
   included = (params[:category] =~ /todo|pending|history/).is_a?(Integer) 
end
puts "Regexp returned #{included} in #{(Time.now - start_time)*1000}ms" 
```

回报：

> 数组.include？在 0.477 毫秒内返回 false
> 
> 正则表达式在 0.953 毫秒内返回 true

请注意，在这种情况下，正则表达式返回**true**，但 array.include? 返回**false**。在构建逻辑时应该考虑这一点。

基本上，如果字符串不在数组中，array.include? 将为假，但如果其中一个关键字在字符串中的任何位置，则正则表达式将为真（无论是否有其他文本）。

# ruby-on-rails-3 - 在 Rails 3 中保存时增加整数？

> ID：11905930
> 
> 赞同：0
> 
> 时间：2012-08-10T16:44:51.347
> 
> 标签：ruby-on-rails-3, controller, save, increment

我的 Rails 3 应用程序中有以下代码：

```
 def like
    @suggestion = Suggestion.find(params[:id])
    Suggestion.update_all("votes = (votes + 1)")
    redirect_to suggestions_url
  end

  def dislike
    @suggestion = Suggestion.find(params[:id])
    Suggestion.update_all("votes = (votes - 1)")
    redirect_to suggestions_url
  end 
```

它正在工作，但不是更新当前建议，而是全部更新。所以我把它改成：

```
 def like
    @suggestion = Suggestion.find(params[:id])
    @suggestion.update_all("votes = (votes + 1)")
    redirect_to suggestions_url
  end

  def dislike
    @suggestion = Suggestion.find(params[:id])
    @suggestion.update_all("votes = (votes - 1)")
    redirect_to suggestions_url
  end 
```

但后来我得到：

```
undefined method `update_all' for #<Suggestion:0x007f87c2b918a0> 
```

所以然后我尝试`@suggestion.update_attribute(:votes, '1')`了但是将值重置为1而不是增加它。

实现这一目标的正确方法是什么？我只希望当前建议的整数（票数）在每次保存时增加/减少 1。

我也试过以下没有运气：

```
def like
 @suggestion = Suggestion.find(params[:id])
 @suggestion.increment(:votes)
 redirect_to suggestions_url
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T16:51:26.983

这似乎更适合模型。我建议在模型中创建一个`like`方法，如下所示：

```
def like
    self.increment!(:votes)
end 
```

现在您可以执行以下操作：

```
@suggestion = Suggestion.find(params[:id])
@suggestion.like 
```

注意：increment!，带感叹号的同时也执行保存动作

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-10T17:06:48.793

几件事。听起来您想要的是一个控制器动作，它将属性加一。您可能与代码最接近

```
@suggestion.update_attribute(:votes, '1') 
```

如果您查看该方法的[文档](http://apidock.com/rails/ActiveResource/Base/update_attribute)，它会将属性的值设置为第二个参数，即对象上`votes`的字符串，以及数据库中相应的行。您不想将其设置为，而是要将其设置为增量值：`'1'``@suggestion``'1'`

```
@suggestion.update_attribute(:votes, @suggestion.votes + 1) 
```

Ethan 建议使用方便的方法，[递增！](http://apidock.com/rails/ActiveRecord/Persistence/increment!)，它的工作原理是一样的。

现在，如果您想在每次保存对象时实际自动递增（如在其他有关对象被更改的情况下，您希望使用不[带 bang的](http://apidock.com/rails/ActiveRecord/Persistence/increment)`:before_save` [回调](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)。`increment`

# java - 如何通过配置屏幕自定义 android 模拟时钟小部件

> ID：11905932
> 
> 赞同：1
> 
> 时间：2012-08-10T16:44:54.690
> 
> 标签：java, android, view, configuration, clock

我正在尝试在主屏幕上开发自己的模拟时钟小部件。它基于库存的 ICS 模拟时钟小部件，但当添加到主屏幕时，我的小部件首先会打开一个配置屏幕。

![小部件配置屏幕截图](../Images/64da8c668425db9d58e4caf9c7faaf7b.png)

在此屏幕上，您可以选择时钟的颜色（通过颜色选择器对话框）。您还可以在此屏幕上看到所选颜色的时钟预览。（见图）。我的问题是将主屏幕上小部件的颜色更改为所选颜色（当您点击应用按钮时）。我有三个用于表盘、时针和分针的 .png 文件。我在我的 widgetconfig 类中使用此代码为它们着色：

```
 Drawable dial = getResources().getDrawable(R.drawable.clockbackground);
    dial.setColorFilter(color, PorterDuff.Mode.MULTIPLY);
    //hour
    Drawable hour = getResources().getDrawable(R.drawable.hourhand);
    hour.setColorFilter(color, PorterDuff.Mode.MULTIPLY);
    //minute
    Drawable min = getResources().getDrawable(R.drawable.minutehand);
    min.setColorFilter(color, PorterDuff.Mode.MULTIPLY);
    // clock
    AnalogClock clockpreview = (AnalogClock) findViewById(R.id.ACconfig);
    clockpreview.setBackgroundDrawable(dial); 
```

这很好用，因为我可以找到 AnalogClock，因为它位于配置屏幕的布局 xml 文件中，我通过 setContentView() 在 OnCreate() 中设置了该文件。问题是对于我屏幕上的时钟小部件，我必须使用 RemoteViews。所以我尝试通过 RemoteViews 设置时钟小部件的新背景。但是 RemoteViews 似乎太有限了，无法做到这一点。我需要 setTextViewText() 之类的东西，但是对于我的模拟时钟小部件的背景，例如：

```
 RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.clockwidget);
    views.setAnalogClockBackgroundDrawable(dial); 
```

时钟小部件背景似乎是不可改变的。如何在 widgetconfig 类的主屏幕上重新着色我的时钟小部件？一定有办法，因为一开始似乎很容易做到……

我的项目由小部件配置类和clockwidget 类、widgetconfig.xml、clockwidget.xml 和widget_info.xml（用于appwidgetprovider）组成。

# c# - 节目时间与音乐时间

> ID：11905933
> 
> 赞同：1
> 
> 时间：2012-08-10T16:44:57.493
> 
> 标签：c#, performance, time, microsoft-metro

我一直在尝试制作一个有音乐的游戏。我一直在使用计时器来跟踪程序的运行时间，但我无法将音乐的播放时间与我的程序的运行时间相匹配。即使我摆脱了几乎所有的代码，它仍然很慢。这是我的代码。

```
 int timeInterval;
    int runningTime;
    DispatcherTimer drawTimer;
    public Game()
    {
        timeInterval = 100;
        drawTimer = new DispatcherTimer();
        drawTimer.Interval = TimeSpan.FromMilliseconds(timeInterval);
        drawTimer.Tick += dispatcherTimer_Tick;

    }
    protected override async void OnNavigatedTo(NavigationEventArgs e)
    {
        runningTime = 0;

        StorageFile file;
        StorageFolder InstallationFolder = Windows.ApplicationModel.Package.Current.InstalledLocation;
        string filePath = @"soundtrack.m4a";
        musicPlayer = new MediaElement();
        file = await InstallationFolder.GetFileAsync(filePath);
        var stream = await file.OpenAsync(Windows.Storage.FileAccessMode.Read);
        musicPlayer.SetSource(stream, file.ContentType);
        musicPlayer.Play();
        drawTimer.Start();
    }

    void dispatcherTimer_Tick(object sender, object e)
    {
        runningTime += timeInterval;

        if ((runningTime / 1000) % 10 == 0)
        {
            System.Diagnostics.Debug.WriteLine("Music: " + musicPlayer.Position.Seconds + "Running time: " + (runningTime / 1000) % 60);
        }
    } 
```

谢谢您的帮助。

编辑：这是一些输出

```
 Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 0Running time: 0
    Music: 11Running time: 10
    Music: 11Running time: 10
    Music: 11Running time: 10
    Music: 11Running time: 10
    Music: 12Running time: 10
    Music: 12Running time: 10
    ...
    Music: 9Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0
    Music: 10Running time: 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:50:28.050

DispatcherTimer.Interval 是 Tick 事件之间经过的最短时间。通常它更多。您应该在开始时使用 _startTime = DateTime.Now 之类的东西，然后再使用 _runningTime = DateTime.Now - _startTime。在测量 _startTime 之前，您可能还希望等待 musicPlayer.CurrentStateChanged 直到 musicPlayer.CurrentState == MediaElementState.Playing。

再说一遍 - 为什么不把 musicPlayer.Position 作为你的 _runningTime 值呢？

# linux-kernel - 如何从用户模式切换到内核模式？

> ID：11905934
> 
> 赞同：14
> 
> 时间：2012-08-10T16:44:58.107
> 
> 标签：linux-kernel

我正在学习 Linux 内核，但我不明白如何在 Linux 中从用户模式切换到内核模式。它是如何工作的？你能给我一些建议或给我一些链接来参考或一些关于这方面的书吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-10T17:35:16.323

用户空间应用程序可以在正常操作期间显式启动切换到内核模式的唯一方法是进行系统调用，例如[open](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGcQFjAA&url=http://en.wikipedia.org/wiki/Open_%28system_call%29&ei=fkQlULnQHcXSrQfb64D4CQ&usg=AFQjCNG4H1W1RHx3KiBkj6amPPZn3hY5QA&sig2=YiwQnTIVFa2KMca_yeVSsA)、[read](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CGIQFjAC&url=http://en.wikipedia.org/wiki/Read_%28system_call%29&ei=pkQlUOCvNonzrQe0jIGwDA&usg=AFQjCNGM6uSeMkRuoLXPCkxEtqDBa9QMAw&sig2=7IDVcHDtqXeVf0yVu5qB0Q)、[write](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&sqi=2&ved=0CGAQFjAB&url=http://en.wikipedia.org/wiki/Write_%28system_call%29&ei=ukQlUJixDY3SrQew0ICgBw&usg=AFQjCNHyIixwpYMakFa5K4vtG1nwzosatA&sig2=gVS_WWqaOwJ5WzOA6MsfYQ)等。

每当用户应用程序使用适当的参数调用这些系统调用 API 时，就会触发软件中断/异常 (SWI)。

作为该 SWI 的结果，代码执行的控制从用户应用程序跳转到操作系统提供的中断向量表 [IVT] 中的预定义位置。

此 IVT 包含 SWI 异常处理程序例程的地址，该例程执行将用户应用程序切换到内核模式所需的所有必要步骤，并代表用户进程开始执行内核指令。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-08-18T06:40:16.783

要从用户模式切换到内核模式，您需要执行系统调用。

如果你只是想看看幕后发生了什么，去[TLDP 是你的新朋友](http://www.tldp.org/HOWTO/Assembly-HOWTO/hello.html)并查看代码（它有很好的文档记录，不需要额外的知识来理解汇编代码）。

你对。。。感兴趣：

```
 movl    $len,%edx           # third argument: message length
  movl    $msg,%ecx           # second argument: pointer to message to write
  movl    $1,%ebx             # first argument: file handle (stdout)
  movl    $4,%eax             # system call number (sys_write)
  int     $0x80               # call kernel 
```

如您所见，系统调用只是汇编代码的包装器，它执行中断（0x80），因此将调用此系统调用的处理程序。

让我们欺骗一下，在这里使用 C 预处理器来构建一个可执行文件（foo.S 是一个文件，您可以在其中放置来自下面链接的代码）：

```
gcc -o foo -nostdlib foo.S 
```

通过 strace 运行它以确保我们将得到我们所写的内容：

```
$ strace -t ./foo 
09:38:28 execve("./foo", ["./foo"], 0x7ffeb5b771d8 /* 57 vars */) = 0
09:38:28 stat(NULL, Hello, world!
 NULL)               = 14
09:38:28 write(0, NULL, 14) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-10T16:49:34.717

我刚刚通读了这个，这是一个很好的资源。它解释了用户模式和内核模式，为什么会发生变化，它们有多昂贵，并提供了一些有趣的相关阅读。

[http://www.codinghorror.com/blog/2008/01/understanding-user-and-kernel-mode.html](http://www.codinghorror.com/blog/2008/01/understanding-user-and-kernel-mode.html)

这是一个简短的摘录：

**内核模式**

在内核模式下，执行代码可以完全且不受限制地访问底层硬件。它可以执行任何 CPU 指令并引用任何内存地址。内核模式通常保留给操作系统的最低级别、最受信任的功能。内核模式下的崩溃是灾难性的；他们将停止整个 PC。

**用户模式**

在用户模式下，执行代码无法直接访问硬件或参考内存。在用户模式下运行的代码必须委托给系统 API 来访问硬件或内存。由于这种隔离提供的保护，用户模式下的崩溃总是可以恢复的。在您的计算机上运行的大部分代码都将在用户模式下执行。

# java - 如何从 Java 的 ResultSet 通过别名/标签获取列？

> ID：11905940
> 
> 赞同：2
> 
> 时间：2012-08-10T16:45:28.570
> 
> 标签：java, jdbc, resultset

假设我有一个最后会执行的 SP `SELECT a as b FROM example_table`。

当我做

```
// Some magical code goes here
ResultSet rs = callableStatement.executeQuery();
while(rs.next()) {
    System.out.printLn(rs.getString("b"));
}
// Some magical code goes here 
```

我收到一个错误，告诉我该列不存在，但是当我更改我的代码时`rs.getString("a")`，它将正确执行。这似乎是因为`getString(String)`按名称而不是别名/标签来获取列。

如何告诉 ResultSet 按标签/别名而不是名称来获取列。

PS：我在这里发现了一个类似的问题[。](https://stackoverflow.com/questions/11211514/jdbc-resultset-get-column-from-different-tables)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T18:47:03.430

@Alper 很赚钱。

他们更改了驱动程序并添加了一个连接属性 GET_COLUMN_LABEL_FOR_NAME，您需要将其设置为“true”。我以为它只适用于resultSetMetaData，但显然不是那么多......

这很奇怪，但试试看。

[Sybooks](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc39001.0605/html/prjdbc/prjdbc14.htm)中的参考资料

Sybase 新闻组[文章](http://sdn.doradus.de/conversation/380036/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T16:57:50.710

我不知道它是否相关，但在 MySQL 中有一个类似的问题，您可以通过添加`?useOldAliasMetadataBehavior=true`到连接字符串的末尾来避免。[检查此链接以获取详细信息](http://thinkinginsoftware.blogspot.com/2011/05/javasqlsqlexception-column-name-not.html)

[同一案例的官方解释链接](http://bugs.mysql.com/bug.php?id=31406)：这里说，在 5.0.x 版本之前，默认值被设置为，`true` 但在 5.1 版本之后，默认值被设置`false`。[您还可以在此处](http://dev.mysql.com/doc/refman/5.6/en/connector-j-reference-configuration-properties.html)检查配置字符串的其他参数

# ios - iOS：创建更高的 UIToolbar

> ID：11905942
> 
> 赞同：1
> 
> 时间：2012-08-10T16:45:35.723
> 
> 标签：ios, user-interface, uitoolbar

![在此处输入图像描述](../Images/13cbea61355a36a8bd0cd21518cafa12.png)

我想创建上面的 UI。具体来说，一个*更高*的工具栏。但我需要以相应的方式显示底层 UI（即内容视图）（即在工具栏下方）。

我熟悉 iOS 5 中的新 UIAppearance 选项。但是，这些似乎更多是关于皮肤，而不是调整大小。

我想可以制作 UI 元素并将它们添加到`window`? 但这不会导致内容视图的大小问题。看起来很老套……</p>

那么，实现这个 UI 的方法是什么。理想情况下支持回到 iOS 4.2。但欢迎使用 iOS 5 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:49:31.557

我不太确定您要复制/制作哪些功能，但您可以使用以下方法更改工具栏的高度：

```
[toolBar setFrame:CGRectMake(0, 50, 320, 60)]; 
```

这将为您创建一个高度为 60 像素的工具栏。让我知道这是否是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:49:26.777

由于[Apple](http://developer.apple.com/library/mac/#documentation/userexperience/conceptual/applehiguidelines/Controls/Controls.html)允许您自定义他们的控件，因此自定义的唯一方法是使用自定义控件。一种方法是使用从 UIView 派生的[Custom-UIToolbar 。](https://github.com/marichka/Custom-UIToolbar)

# jquery - jquery text()，解释 为换行

> ID：11905943
> 
> 赞同：17
> 
> 时间：2012-08-10T16:45:43.943
> 
> 标签：jquery

像这样获取 DOM 的元素

```
$('#id').content().text(); 
```

问题出现

如果它得到这个：

```
<p>Hello</p>
<p><br></p>
<p>World</p> 
```

自然地在 Html 中看起来像：

```
Hello 

World 
```

但是这个 jquery`.text()`方法返回：HelloWorld

如何解释`<br>`为新行？<-> 如何获得与我在 HTML 中看到的完全一样的文本？

`.html()`给出了我不想要的所有 HTML 标签。如果可能的话，我只需要带有空格的纯文本。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-10T16:48:07.543

`.text()`是没有格式的纯文本。它实际上是文本节点的连接，没有任何其他 HTML 代码（包括由`<br>`or`<p>`标记表示的新行，而不是由换行符）。

`.html()`是容器标签的准确 HTML。

如果你使用它，它会给你一个新行的近似文本：

```
var item = document.getElementById("id");
var text = item.innerText || item.textContent; 
```

由于浏览器兼容性问题`.textContent`，它正在考虑两者。`.innerText`

有关工作演示，请参阅[http://jsfiddle.net/jfriend00/Xs5P3/ 。](http://jsfiddle.net/jfriend00/Xs5P3/)

Google 搜索“HTML 到文本的转换”提供了很多可供调查的选项。

# sql - T-SQL 选择每日总计但每日截止时间不是午夜

> ID：11905950
> 
> 赞同：3
> 
> 时间：2012-08-10T16:45:59.443
> 
> 标签：sql, tsql, datetime

我需要计算销售数量，并按日期汇总销售总额，很容易。但是曲线间距是 - 我需要“截止”是下午 6 点而不是午夜。

> 前一天下午6点到当天下午6点。

让我失望的是“分组”。我的计数只提取真实日期而不是“下午 6 点”信息。

```
Sort30   Day30      Total                 Counter
-------- ---------- --------------------- -----------
20120810 08/10/2012 675.32                9
20120809 08/09/2012 1314.68               16 
```

询问：

```
SELECT top 30 CONVERT(VARCHAR(8), chickendate, 112) AS varSort30, 
CONVERT(VARCHAR(10), chickendate, 101) AS varDay30,
SUM(CAST(transAmount AS money)) AS varTotal, 
Count(chickendate) AS varCounter
FROM CHICKEN
WHERE 
    (chickendate >= dateadd(hour, 18, dateadd(day, datediff(day, 0, chickendate), -1))  AND 
    chickendate < dateadd(hour, 18, dateadd(day, datediff(day, 0, chickendate), 0))) 
GROUP BY CONVERT(VARCHAR(8), chickendate, 112), 
    CONVERT(VARCHAR(10), chickendate, 101)
ORDER BY CONVERT(VARCHAR(8), chickendate, 112) DESC 
```

转来转去，我觉得有什么东西盯着我的脸。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T17:02:43.570

如果我的逻辑是正确的，这应该会给你正确的结果：

```
SELECT TOP 30
    CONVERT(VARCHAR(8), modifiedChickenDate, 112) AS varSort30, 
    CONVERT(VARCHAR(10), modifiedChickenDate, 101) AS varDay30,
    SUM(CAST(transAmount AS money)) AS varTotal, 
    COUNT(modifiedChickenDate) AS varCounter
FROM (
    SELECT
        transAmount,
        DATEADD(HOUR, 6, chickendate) AS modifiedChickenDate
    FROM CHICKEN
) sub
GROUP BY
    CONVERT(VARCHAR(8), modifiedChickenDate, 112) AS varSort30, 
    CONVERT(VARCHAR(10), modifiedChickenDate, 101) AS varDay30,
ORDER BY
    CONVERT(VARCHAR(8), modifiedChickenDate, 112) AS varSort30 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:03:06.800

如果 chickendate 是 DATETIME 而不仅仅是 DATE，那么您可以使用

```
GROUP BY CONVERT(VARCHAR(10), DATEADD(hh, 6, chickendate), 101) 
```

将日期提前 6 小时（使您的截止日期比午夜提前 6 小时，或下午 6 点），然后在一年中的某一天分组。这仅在您存储时间信息时才有效，我不确定您是否如此。为必要的表发布一些架构。但我认为你正在寻找...

```
SELECT TOP 30 CONVERT(VARCHAR(10), DATEADD(hh, 6, chickendate), 101) as Date
        , SUM(CAST(transAmount as money)) AS Total
        , Count(*) as Counter
    FROM Chicken
    GROUP BY CONVERT(VARCHAR(10), DATEADD(hh, 6, chickendate), 101)
    ORDER BY CONVERT(VARCHAR(10), DATEADD(hh, 6, chickendate), 101) DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:02:40.120

怎么样：

```
GROUP BY CONVERT(VARCHAR(8), dateadd(hour, 6, chickendate), 112) 
```

所以`'2012-08-09 18:00:00'`被分组`20120810`，`'2012-08-09 17:59:59'`被分组`20120809`。

# wpf - 为什么这个 VisualStateManager 只触发一次动画？

> ID：11905951
> 
> 赞同：1
> 
> 时间：2012-08-10T16:46:04.703
> 
> 标签：wpf, c#-4.0, controltemplate, visualstatemanager, visualstategroup

我正在尝试为 WPF Expander 控件创建一个 ControlTemplate，但我在尝试为 Expanded 和 Collasped 状态设置动画时遇到了障碍。

当应用程序最初启动时，我的 Expanded 状态动画触发一次，但之后不再触发。

我不确定这里发生了什么，但这是我的 ControlTemplate 目前的样子：

```
 <ControlTemplate TargetType="Expander" x:Key="RightExpander">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Name="ContentColumn" Width="0" />
            </Grid.ColumnDefinitions>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ExpansionStates">
                    <VisualState x:Name="Expanded">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="Content" Storyboard.TargetProperty="(RenderTransform).(TranslateTransform.X)" To="-50" From="0"
                                 Duration="0:0:0.3" />
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Collasped">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="Content" 
Storyboard.TargetProperty="(RenderTransform).(TranslateTransform.X)" 
                                To="50" From="0" Duration="0:0:0.3" />
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Border Grid.Row="0" BorderThickness="1" Panel.ZIndex="1" >
                <Grid>
                    <ToggleButton IsChecked="{Binding IsExpanded, Mode=TwoWay,
                          RelativeSource={RelativeSource 
                          TemplatedParent}}"></ToggleButton>
                    <ContentPresenter ContentSource="Header" 
                          RecognizesAccessKey="True" 
                          IsHitTestVisible="False" />
                </Grid>
            </Border>
            <Border Name="Content" Grid.Column="1" BorderThickness="0,1,1,1" 
                CornerRadius="0,5,5,0" Background="Pink" RenderTransformOrigin="0,0">
                <Border.RenderTransform>
                    <TranslateTransform X="0" Y="0" />
                </Border.RenderTransform>
                <ContentPresenter Margin="4" />
            </Border>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded" Value="True">
                <Setter TargetName="ContentColumn" Property="Width" Value="{Binding
                    ElementName=Content, Path=DesiredSize.Width}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate> 
```

（我有一些虚假的 To 值只是为了测试。）我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:54:43.580

我的猜测是 Collapsed (Collasped) 的拼写错误

可能由于拼写错误，VSM 没有找到故事板

# svn - 谷歌代码上的 SVN 配置文件在哪里？

> ID：11905954
> 
> 赞同：0
> 
> 时间：2012-08-10T16:46:18.053
> 
> 标签：svn, location, config, google-code

我在我的谷歌代码页上将 html 文件显示为文档时遇到了一点问题。

我需要知道 SVN 配置文件在谷歌代码上的位置。

我试图将一个名为“config”的文件上传到 SVN 的根目录和 /.subversion/ 目录，但它没有被应用，或者至少 HTML 页面在单击“原始文件”时仅显示为纯文本。

我读到这个： http: [//manjeetdahiya.com/2010/09/29/serving-html-documentation-from-google-code-svn/](http://manjeetdahiya.com/2010/09/29/serving-html-documentation-from-google-code-svn/)

但真的不知道配置文件在哪里..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:15:49.353

您提供的**SVN 客户端配置**的链接是有意义的。您没有指定您的操作系统和 SVN 客户端，但我可以说，在 Linux 上，它位于您的主目录中，应该有一个名为 .subversion 的目录，其中包含客户端配置文件。在 Windows 上，检查客户端程序的安装目录。

# java - JPA：外键注释

> ID：11905956
> 
> 赞同：34
> 
> 时间：2012-08-10T16:46:21.900
> 
> 标签：java, database-design, jpa, orm, annotations

我有两个数据库实体：`Forum`和`Topic`.

`Topic`有`protected long forumId`数据成员，这当然表示`Topic`的论坛。

我的问题是该数据成员使用什么注释？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-10T16:51:10.247

由于论坛有很多主题，而一个主题属于一个且唯一的论坛，您可能希望使用带有注释的论坛类型属性[`@ManyToOne`](http://docs.oracle.com/javaee/6/api/javax/persistence/ManyToOne.html)：

```
@ManyToOne
@JoinColumn(name = "forumId")
private Forum forum; 
```

**看更多：**

[多对一](http://en.wikibooks.org/wiki/Java_Persistence/ManyToOne)和[JPA 映射](http://en.wikibooks.org/wiki/Java_Persistence/Mapping)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T16:57:01.577

正如其他人回答的那样 -
您应该使用`ManyToOne`, 和`JoinColumn`注释。
请记住，由于 JPA 是关于 ORM - 对象关系映射，
您应该引用另一个对象，就像您在 Java 中“自然地”所做的那样 - 即通过一个对象而不是通过它的标识符（在您的情况下是 forumId），
这是 JPA 和 Hibernate（以前是 JPA）的关系之间的设计考虑之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:52:35.650

`@ManyToOne` 正如注释所暗示的那样 - 每个论坛都有很多主题

# c++ - 如何使用宏在 C++ 中嵌入调试语句

> ID：11905962
> 
> 赞同：0
> 
> 时间：2012-08-10T16:46:39.213
> 
> 标签：c++, logging, macros

我正在编写一个程序，我想根据各种宏变量的值输出不同类型的调试信息（这样我就可以更改一个标志的值，然后导致不同级别的信息写入屏幕）。

例如，假设我有以下代码将有关我的程序的信息打印到屏幕上（称为**D1**）：

```
cout << "% Percentage complete: "
     << ceil((static_cast<double>(idx)/static_cast<double>(ITERATIONS))*(100.00))
     << "%" << endl;
cout << "x = [ x; ";
for(int i=0; i<space.getDimension(); i++)
    cout << visited.vec[visited.bestIndex].x[i] << "\t";
cout << "];" << endl; 
```

现在，还假设我有以下代码可以在屏幕上打印有关我的程序的不同信息（称为**D2**）：

```
cout << "best = [ best; "
     << visited.vec[visited.bestIndex].meanQALY() << "];\n" << endl;
space.displayConstraintsMATLAB(idx+1); 
```

我希望能够在我的代码中的某些位置插入诸如`#D1`和`#D2`之类的语句，并让宏处理器用上面的代码块替换这些语句。

我怎样才能做到这一点？

（如果宏不是理想的解决方案，我很高兴听到有关不同方法的建议。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:55:27.593

您可以制作一个为您进行调试的宏 - 例如：

```
#ifdef D1
#    define DEBUG(var) //Debug 1 print implementation here
#elif defined D2
#    define DEBUG(var) //Debug 2 print implementation here
#else
#    define DEBUG(var) //No-op
#endif 
```

否则，您可以创建一个调试函数，然后在该函数内部对语句进行类似的检查，`#if def`以查看您希望如何处理输入。该功能版本具有更早的类型检测，因此当您尝试打印不可处理的内容（某些自定义对象）时，它往往会以更好的方式告诉您错误。此外，如果函数是无操作（在发布模式下没有内部），那么当存在任何优化标志时，编译器将丢弃函数调用，因此您不会在发布模式下支付任何额外费用调试调用。

对于我自己的调试调用，我通常定义一个流运算符，很像 std::cout，将所有输入转换为字符串或 char*，然后如果定义了 DEBUG 或不打印任何内容，则将它们放入调试函数中。对于异常和日志记录，您可以执行具有不同严重性级别（信息、警告、错误等）的类似指标。这使得在 C++ 中抛出调试代码变得像在更现代的语言 imo 中一样容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:32:12.530

在我看来，您正在寻找的是一个日志记录工具。查看此线程以获取[一些建议](https://stackoverflow.com/questions/696321/best-logging-framework-for-native-c)。

**为什么使用整个框架而不是宏？**

问题是正确的日志记录比看起来更困难。有线程问题、会话、类和对象实例是您必须考虑的因素。日志文件缓冲、翻转和压缩日志文件也是您必须考虑的问题。您可能还想通过网络或系统日志（或两者）或数据库登录。自己正确地实现所有这些需要做很多工作。

**宏好用吗？**

当然！在我们的项目中，我们定义了一个名为 LOG 的宏，它包装了对我们的日志框架的调用（我们正在使用[log4cpp](http://log4cplus.sourceforge.net/)）。如果有一天我们打算迁移到另一个框架，我们只需要在一个地方重新定义我们的 LOG 宏，而不是梳理整个代码库。这是因为大多数日志框架共享一个类似的接口，通常由日志级别和消息字符串组成。

# django - 使用 Nginx 作为服务部署 Django

> ID：11905969
> 
> 赞同：1
> 
> 时间：2012-08-10T16:47:21.923
> 
> 标签：django, ubuntu, deployment, nginx, webserver

目前我有一个运行 nginx 的家庭服务器（Ubuntu），我使用代理传递来将请求传递给 django。我使用 gevent 作为我的 wsgi 服务器。

在服务器关闭之前一切正常，因为无论出于何种原因我重新启动服务器或崩溃（电力）。由于 nginx 是一个服务，所以当服务器重新启动时，nginx 也会启动。但是我的 django 应用程序没有。所以我必须手动转到我的每个 django 项目，激活它们的 virtualenvs，然后启动 gevent 进程。至少可以说这很烦人。

有自动处理所有这些的标准方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T17:10:12.860

[您需要为Upstart](http://upstart.ubuntu.com)或[Supervisor](http://supervisord.org/)等设置脚本。就个人而言，我更喜欢使用Supervisor。这是我用来运行 gunicorn 实例的脚本：

```
[program:gunicorn]
command=/path/to/virtualenv/bin/python manage.py run_gunicorn -c /path/to/gunicorn.conf.py
directory=/path/to/django/project
user=www-data
autostart=true
autorestart=true
redirect_stderr=True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:09:44.690

考虑使用流程管理器为您处理此问题。我喜欢[主管](http://supervisord.org/)

你告诉它如何启动你的各种进程，然后它在后台运行（就像 nginx 一样）并且会在重启时自动启动并启动你的各种 django 后端进程。

# vba - 可以创建适用于多个工作表的通用宏吗？

> ID：11905974
> 
> 赞同：1
> 
> 时间：2012-08-10T16:47:42.117
> 
> 标签：vba, excel, events, worksheet

我创建了一个简单的工作表宏，它在双击单元格时将单元格的内容发送到外部程序。起初，我拥有工作表模块中的所有代码，并且必须将其复制到我想要该功能的每个工作表上。现在，我设法将工作表模块中的代码简化为对标准模块中子例程的调用，并且它可以工作，但我仍然必须将代码复制到我需要该功能的每张工作表上。有没有办法只在一个地方（标准模块、工作簿模块或类模块）输入代码，并让它在工作簿中的任何工作表上运行，而工作表后面没有代码？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T17:04:19.433

`ThisWorkbook`代码模块有一个事件处理程序，您可以使用它而`Workbook_SheetBeforeDoubleClick`不是在每张纸上单独捕获事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:57:40.093

您需要工作表上的事件处理程序来处理双击。将其放在要运行双击代码的每张工作表后面的代码中。

```
Option Explicit

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim sWorksheet As String
    Dim sValue As String
    Dim sCell As String

    sWorksheet = ActiveSheet.Name
    sValue = Target.Text
    sCell = Target.Address
    Call DoubleClicked(sWorksheet, sValue, sCell)
End Sub 
```

将您的主程序放在一个模块中，而不是放在工作表上。

```
Option Explicit

Sub DoubleClicked(SheetName As String, CellText As String, CellAddress As String)
    ' your code goes here
    MsgBox "You double-clicked cell " & CellAddress & " on sheet " _
    & SheetName & ". The text in that cell is: " & CellText
End Sub 
```

您不希望在每张纸上重复逻辑。如果您进行更改，则必须为每张纸进行更改。通过简单地从每个工作表调用主程序，您只需编写和维护一次。

# ruby-on-rails - Phonegap App 使用身份验证与 Rails 3 App 通信

> ID：11905976
> 
> 赞同：1
> 
> 时间：2012-08-10T16:47:46.487
> 
> 标签：ruby-on-rails, cordova, devise

我正在尝试使用 Phonegap 编写一个 iOS 应用程序来与我的 Rails3 应用程序进行通信。我不知道如何处理身份验证。我在我的 Rails 应用程序中使用 Devise/Warden。

我能够通过 ajax 在我的 iOS 应用程序中成功登录，但随后的调用给了我“未经授权”。看来我的 iOS 应用程序中没有设置会话 cookie。

如何让我的 iOS 应用了解我的 Rails 身份验证会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:10:19.393

答案是双重的。

首先，我必须将其添加到 iOS 应用程序中的 ajax 请求中：

```
xhrFields: {
  withCredentials: true
} 
```

如...

```
$.ajax({
    url: ....,
    type: "GET",
    xhrFields: {
        withCredentials: true
    },
    complete: hideLoader,
    error: function(xhr,txt,err) {
        // you can't get back anyways
        window.location.hash = "";
    },
    success: function(data,status,res) {
        window.location.hash = "";
    }
}); 
```

其次，我必须将其添加到 Rails 应用程序中的应用程序控制器中：

```
def protect_against_forgery?
  unless request.format.json?
    super
  end
end 
```

# c++ - 创建 ATL COM 对象后如何填写 ProgID。ProgID 重要性

> ID：11905977
> 
> 赞同：1
> 
> 时间：2012-08-10T16:47:49.303
> 
> 标签：c++, visual-studio-2010, atl, rgs

我正在尝试使用 C++ ATL 创建 com 对象。在添加 ATL 简单对象向导中，我忘记填写 ProgID 字段。以后可以添加 ProgID 吗？我发现它位于 *.rgs 文件中。编辑此文件是否安全？如果是，在这种情况下如何处理定义语法中也需要的 UI？正如我所理解的，当您想要创建 COM 对象时，ProgID 很重要，例如在 VB 中使用命令 CreateObject。当 ProgId 丢失时，还有哪些其他方法可以创建具有后期绑定的 com 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T17:23:04.677

是的，编辑 .rgs 文件是安全的。它只是一个注册表脚本 - 定义 ProgID 将插入注册表的位置。（在 Visual Studio 中使用 C++ 时，在我看来，它们似乎没有那么多您不应该编辑的自动生成的文件。生成的文件通常带有标签。（就像是从 .idl 文件生成。））

向导所做的只是自动填写一些您通常需要手动完成的文件。知道什么放在哪里是非常有用的，所以，如果你已经找到了这一点，听起来你是在正确的轨道上。

# ruby - 用于逐像素读取图像的 RMagick/ImageMagick 的替代品

> ID：11905978
> 
> 赞同：3
> 
> 时间：2012-08-10T16:47:55.037
> 
> 标签：ruby

我目前在我正在从事的项目中使用 RMagick 和 ImageMagick，这是一个 ASCII 图像生成器：[https ://github.com/ehayon/Pixie](https://github.com/ehayon/Pixie)

但是，我不喜欢 ImageMagick 依赖项。我很难找到一个备用库。我需要做的就是获取图像每个像素的 RGB 值。我想至少支持 PNG 和 JPEG。

有人在没有 ImageMagick 依赖的情况下使用过类似的库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:02:38.597

仍在寻找 JPEG 文件，但有一个非常不错的 PNG 库，称为[Chunky PNG](https://github.com/seanevans/chunky_png)，它允许您遍历和读取图像中的像素。这是一个逐行的小例子：

```
require 'rubygems'
require 'chunky_png'

image = ChunkyPNG::Image.from_file('image.png')

(0..image.dimension.width).each do |x|
  (0..image.dimension.height).each do |y|
    r = ChunkyPNG::Color.r(image[x,y])
    g = ChunkyPNG::Color.g(image[x,y])
    b = ChunkyPNG::Color.b(image[x,y])
  end
end 
```

# javascript - 计时器重置关闭按钮一旦点击回到它的“之前”状态后 2 秒

> ID：11905979
> 
> 赞同：0
> 
> 时间：2012-08-10T16:47:58.147
> 
> 标签：javascript, timing

嘿，我一直在试图弄清楚如何在单击按钮后将其重置为之前的状态时遇到了一些困难。我知道这涉及到一个 javascript 时间，任何人都可以帮助我现在整个早上都在尝试。

```
 function clickMute()
    { if (document.Mute.src=='http://www.showandtell.com/TRUMusicControl/images/BeforeClickMute.png'){

    document.Mute.src='http://www.showandtell.com/TRUMusicControl/images/AfterClickMute.png';
    } 
    else if (document.Mute.src=='http://www.showandtell.com/TRUMusicControl/images/AfterClickMute.png'){

    document.Mute.src='http://www.showandtell.com/TRUMusicControl/images/BeforeClickMute.png';
    }
    }

    <div id= "Mute">
    <a href="#">
     <img id="Mutebutton" name="Mute" onclick="clickMute()" src="images/BeforeClickMute.png" width="140" height="126" />
    </a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T16:58:48.127

首先，删除`a`图像周围的（锚）标签（静音按钮）。然后只需使用以下代码（替换您的功能）：

```
function clickMute(){
    var strPath = "http://www.showandtell.com/TRUMusicControl/images/",
        arrSrc = ["BeforeClickMute.png","AfterClickMute.png"],
        button = document.getElementById("Mutebutton"),
        index = (/Before/i.test(button.src)) ? 1 : 0;
    button.src = strPath + arrSrc[index];

    /* If you need the button to reset itself after a certain time... */
    if (index) setTimeout(clickMute,2000);
} 
```

# java - Java - 如何将文件移动到 zip 文件中？

> ID：11905982
> 
> 赞同：4
> 
> 时间：2012-08-10T16:48:04.647
> 
> 标签：java, file, zip, move, unzip

就是这样。我有一个文本文件，我需要将它移动到给定目录中的（现有）Zip 文件。

```
 File file = new File("C:\\afolder\\test.txt");
    File dir = new File(directoryToGo+"existingzipfile.zip");
    boolean success = file.renameTo(new File(dir, file.getName())); 
```

但它不起作用。有没有办法将文件移动到现有的 Zip 文件中？谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T17:17:02.323

嗯，你可以使用类似的东西：

```
public static void addFilesToExistingZip(File zipFile, File[] files) throws IOException {
    // get a temp file
    File tempFile = File.createTempFile(zipFile.getName(), null);
    // delete it, otherwise you cannot rename your existing zip to it.
    tempFile.delete();
    boolean renameOk = zipFile.renameTo(tempFile);
    if (!renameOk) {
        throw new RuntimeException(
                "could not rename the file " + zipFile.getAbsolutePath() + " to " + tempFile.getAbsolutePath());
    }
    byte[] buf = new byte[1024];
    ZipInputStream zin = new ZipInputStream(new FileInputStream(tempFile));
    ZipOutputStream out = new ZipOutputStream(new FileOutputStream(zipFile));
    ZipEntry entry = zin.getNextEntry();
    while (entry != null) {
        String name = entry.getName();
        boolean notInFiles = true;
        for (File f : files) {
            if (f.getName().equals(name)) {
                notInFiles = false;
                break;
            }
        }
        if (notInFiles) { // Add ZIP entry to output stream.
            out.putNextEntry(new ZipEntry(name)); // Transfer bytes from the ZIP file to the output file
            int len;
            while ((len = zin.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
        }
        entry = zin.getNextEntry();
    } // Close the streams
    zin.close(); // Compress the files
    for (int i = 0; i < files.length; i++) {
        InputStream in = new FileInputStream(files[i]); // Add ZIP entry to output stream.
        out.putNextEntry(new ZipEntry(files[i].getName())); // Transfer bytes from the file to the ZIP file
        int len;
        while ((len = in.read(buf)) > 0) {
            out.write(buf, 0, len);
        } // Complete the entry
        out.closeEntry();
        in.close();
    } // Complete the ZIP file
    out.close();
    tempFile.delete();
} 
```

**参考：**

*   [http://www.dzone.com/snippets/adding-files-existing-jar-file](http://www.dzone.com/snippets/adding-files-existing-jar-file)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T16:51:36.657

您需要构建一个新的 zip 文件：

*   打开现有的 zip 文件进行阅读
*   打开一个新的 zip 文件进行写入
*   将旧 zip 文件中的所有条目复制到新文件中，忽略与您的额外文件对应的条目（如果有的话）
*   添加您的额外文件
*   关闭输入和输出文件
*   删除旧的 zip 文件
*   将新的 zip 文件重命名为旧的名称

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T10:49:38.490

你可以这样做，这`uploadPath+fileName`是文件名及其路径：

```
String FileName="Urzip file name. zip";

FileOutputStream outputStream = new FileOutputStream(uploadPath+fileName);
ZipOutputStream zipFile = new ZipOutputStream(outputStream);

byte[] buffer = new byte[1024];

// Then, here I have list of pdf files in a LIST:

// continuation ...
for (int i = 0; i < filename.size(); i++) {
    String file = filename.get(i);
    FileInputStream input = new FileInputStream(uploadPath+file);
    ZipEntry entry = new ZipEntry(file);
    zipFile.putNextEntry(entry);
    int len;

    while ((len = input.read(buffer)) > 0) {
        zipFile.write(buffer, 0, len);
    }

    zipFile.closeEntry();
    input.close();
}

// Next, here "downFile" is the other file which you have to add in your existing zip:

// continuation ...
FileInputStream input = new FileInputStream(uploadPath+downFile);

ZipEntry e = new ZipEntry(downFile);
zipFile.putNextEntry(e);
int len;
while ((len = input.read(buffer)) > 0) {
    zipFile.write(buffer, 0, len);
}
zipFile.closeEntry();
input.close();

zipFile.close(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-19T08:54:58.570

从 Java 7 开始，您有一个 zip 文件系统提供程序，它允许您编写以下代码：

```
final Path src = Paths.get("c:\\afolder\\test.txt");
final String filename = src.getFileName().toString();

final Path zip = Paths.get(directoryToGo, "existingzipfile.zip");
final URI uri = URI.create("jar:" + zip.toUri());
final Map<String, ?> env = Collections.emptyMap();

try (
    final FileSystem zipfs = FileSystems.newFileSystem(uri, env);
) {
    Files.move(src, zipfs.getPath("/" + filename),
        StandardCopyOption.REPLACE_EXISTING);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-11T17:30:08.733

根据接受的答案添加类以将文件移动到 jar/zip 文件夹内。接受的答案不包含完整的可执行代码，因此我添加了有助于将文件移动/复制到 jar/zip 包 ZipReader 的类；

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;
import java.util.zip.ZipOutputStream;

public class ZipWrite {
    public static void main(String args[]) throws IOException
    {
        File file=new File("F:/MyProjects/New folder/mysql-connector-java-5.1.18-bin.jar");
        File filetoPush=new File("F:/MyProjects/New folder/BestResponseTimeBalanceStrategy.class");
        File[] files=new File[1];
        files[0]=filetoPush;
        addFilesToExistingZip(file,files);
    }

    public static void addFilesToExistingZip(File zipFile, File[] files)
            throws IOException {
        // get a temp file
        File tempFile = File.createTempFile(zipFile.getName(), null);
        // delete it, otherwise you cannot rename your existing zip to it.
        tempFile.delete();
        boolean renameOk = zipFile.renameTo(tempFile);
        if (!renameOk) {
            throw new RuntimeException("could not rename the file "
                    + zipFile.getAbsolutePath() + " to "
                    + tempFile.getAbsolutePath());
        }
        byte[] buf = new byte[1024];
        ZipInputStream zin = new ZipInputStream(new FileInputStream(tempFile));
        ZipOutputStream out = new ZipOutputStream(new FileOutputStream(zipFile));
        ZipEntry entry = zin.getNextEntry();
        while (entry != null) {
            String name = entry.getName();

            boolean notInFiles = true;
            for (File f : files) {
                if (f.getName().equals(name)) {
                    System.out.println(name);
                    notInFiles = false;
                    break;
                }
            }

            if (notInFiles) {
                System.out.println("adding");
                // Add ZIP entry to output stream.
                out.putNextEntry(new ZipEntry(name)); // Transfer bytes from the
                                                        // ZIP file to the
                                                        // output file
                int len;
                while ((len = zin.read(buf)) > 0) {
                    out.write(buf, 0, len);
                }
            }
            entry = zin.getNextEntry();
        } // Close the streams
        zin.close(); // Compress the files
        for (int i = 0; i < files.length; i++) {
            FileInputStream in = new FileInputStream(files[i]);
            // Add ZIP entry to output stream.
            System.out.println("files[i].getName()-->"+files[i].getName());
            out.putNextEntry(new ZipEntry("com/mysql/jdbc/util/"+files[i].getName()));
            // Transfer bytes from the file to the ZIP file
            int len;
            while ((len = in.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
            // Complete the entry
            out.closeEntry();
            in.close();
        }
        // Complete the ZIP file
        out.close();
        tempFile.delete();
    }

} 
```

# php - 使用 PHP 的非对称加密

> ID：11905983
> 
> 赞同：7
> 
> 时间：2012-08-10T16:48:05.917
> 
> 标签：php, openssl, public-key-encryption

我有一个让我发疯的问题。

我创建了一对键：

```
$res = openssl_pkey_new(array('private_key_bits' => 2048));

/* Extract the private key from $res to $privKey */
openssl_pkey_export($res, $privKey);

/* Extract the public key from $res to $pubKey */
$pubKey = openssl_pkey_get_details($res);
$pubKey = $pubKey["key"]; 
```

使用此代码，我有`$pubKey`and `$privKey`。

**我可以正确加密/解密，但我对DECRYPTION**有很大的疑问。

目前我加密数据正在做：

```
openssl_public_encrypt($data, $encrypted, $pubKey); 
```

它正确加密了我的数据，但阅读 PHP Doc，我发现：

[http://php.net/manual/en/function.openssl-public-decrypt.php](http://php.net/manual/en/function.openssl-public-decrypt.php)

我可以使用**PUBLIC KEY**解密数据吗？为什么 ？？

我知道公钥对加密数据很有用，但只有私钥的所有者才能解密数据。

如果我可以使用公钥解密数据，让知道公钥的用户轻松解密消息。

有人可以向我解释一下吗？我正在寻找一种使用两个密钥的方法，第一个用于加密，第二个（仅第二个）用于解密。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-05-21T10:15:01.293

在非对称公钥/私钥加密中，通常：

1.  Bob 生成了他的**公钥/私钥对**
2.  Bob 分享了他的**公钥**
3.  爱丽丝用鲍勃的**公钥加密一些消息**
4.  她发信息
5.  只有 Bob 可以用他的**私钥**解密。

[![在此处输入图像描述](../Images/7d01465f707cbf9a05d59dcc02539ec1.png)](https://i.stack.imgur.com/QVXfk.png)

现在我们可以使用*openssl*库来学习基本的密码学了。请注意，以下代码不适用于生产软件，仅用于学习非对称加密的基础知识。

使用该方法和以下代码，Alice 可以成功地向 Bob 发送消息

```
/**  BOB CODE  **/
$key = openssl_pkey_new(array('private_key_bits' => 2048));

$bob_key = openssl_pkey_get_details($key);
$bob_public_key = $bob_key['key']; 
```

这是您在代码中拥有的基本基础设施，现在是 Bob 执行的代码。Bob 生成密钥对并发送给 Alice，在真实环境中必须有公钥共享机制。

当 Alice 得到 Bob 的公钥时，她用这个密钥加密她的消息：

```
/** ALICE CODE **/
$alice_msg = "Hi Bob, im sending you a private message";
openssl_public_encrypt($alice_msg, $pvt_msg, $bob_public_key); 
```

最后 Bob 收到消息并解密

```
/**  BOB CODE **/
openssl_private_decrypt( $pvt_msg, $bob_received_msg, $key);
print $bob_received_msg; 
```

**推荐用于生产的加密库**

如果您的目标是安全的生产系统，请使用 libsodium。有了它，您可以加密消息...

```
// Generating your encryption key
$key = \Sodium\randombytes_buf(\Sodium\CRYPTO_SECRETBOX_KEYBYTES);

// Using your key to encrypt information
$nonce = \Sodium\randombytes_buf(\Sodium\CRYPTO_SECRETBOX_NONCEBYTES);
$ciphertext = \Sodium\crypto_secretbox('test', $nonce, $key); 
```

...并解密消息...

```
$plaintext = \Sodium\crypto_secretbox_open($ciphertext, $nonce, $key);
if ($plaintext === false) {
    throw new Exception("Bad ciphertext");
} 
```

...除其他事项外。

[什么是随机数？](https://en.wikipedia.org/wiki/Cryptographic_nonce)

[查看完整手册以将其与 PHP 一起使用](https://paragonie.com/book/pecl-libsodium)

仔细阅读，加密不是一个星期就能学会的东西。有一些警告。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-10T17:51:43.080

公钥密码学的整个想法是每个“用户”都有一个“公钥”和一个“私钥”。这些密钥有 3 种主要实现方式：机密、认证和组合。在我的回答中，我将采用“机密”技术。

每个用户都有一个他们分发的“公钥”，其他用户将使用它来加密将发送回的消息，以及一个他们只为自己保留的“私钥”，用于解密发送回的消息他们会收到。您用于加密消息的密钥与用于解密的密钥不同。

**“机密密钥使用”示例：**

> *Bob 拥有*：Bob 私钥、Bob 公钥、**Alice 公钥**
> *Alice 拥有*：Alice 私钥、Alice 公钥、**Bob 公钥**

**Bob**想向Alice**发送****一条消息**： Bob 使用**“Alice 公钥”加密**消息，发送它 => Alice 使用**“Alice 私钥”解密**消息。

 ********Alice**想要回复**并向 Bob 发送一条消息**：
Alice 使用**“Bob 公钥”加密**消息，发送它 =>
Bob 使用**“Bob 私钥”解密**消息。

> 公钥仅用于加密消息
> 私钥仅用于解密使用公钥加密的消息

既然您知道“公钥”和“私钥”的基本概念是什么，[请看一下这张图片，解释典型的 SSL 通信和密钥的使用。](http://i.stack.imgur.com/t1KsY.gif)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-05T18:49:35.810

签名，一种证明私钥所有者创建加密消息的哈希。有利于 Alice 证明 Bob 给她写了一条消息（用 Alice 的公钥加密）——而不是 Joe。Bob 使用他的私钥创建一个唯一的签名，Alice 可以使用 Bob 的公钥来确认。

:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-02T11:32:59.750

## 简答

由公钥加密的消息只能由匹配的私钥解密。

## 长答案

**非对称加密双向工作。**

那么为什么还有一个`openssl_public_decrypt()`函数呢？你可能会问。正如[文档](https://www.php.net/manual/en/function.openssl-public-decrypt.php)所述，它可以解密已由私钥加密的消息。正如之前沃利提到的，这可以用于签名。

假设 Alice 等待来自 Bob 的消息，而不是来自其他任何人的消息。所以 Bob 使用他自己的**私钥**来加密消息（例如使用`openssl_private_encrypt()`）。当 Alice 收到任何消息时，她会尝试使用 Bob 的**公钥**对其进行解密。如果这成功了，她就知道消息来自 Bob。

请注意，使用私钥加密并不安全，因为任何人（有权访问公钥）都可以解密消息。在实践中，您可能会结合使用这两种方法（附加使用 Bob 的私钥加密的签名，然后使用 Alice 的公钥加密整个消息）。******

# ios - 在建立互联网连接之前检查可达性有什么意义？

> ID：11905986
> 
> 赞同：9
> 
> 时间：2012-08-10T16:48:21.550
> 
> 标签：ios

几周前，通读了 Apple 指南，它说应用程序应该在尝试建立连接之前检查可达性状态，我读过应用程序商店因为不这样做而被拒绝的应用程序。

然而，可达性 API 最多可能需要 30 秒（根据 Apple 文档，而且我自己有时也看到过这种情况）来确定可达性是否可用。在这种情况下，API 返回不可访问。

因此，您可能会遇到这样的情况，即您确实具有可达性，但 API 说您没有，并且您在 30 秒左右不会发现您做到了。

必须等待 30 秒的时间长得令人无法接受——尤其是在连接已由用户发起的情况下。考虑这种情况：

*   用户单击执行某些与 Internet 相关的活动的按钮
*   根据 Apple 指南，代码使用可达性 API 在尝试建立连接之前检查是否存在可达性。
*   Reachability API 表示不存在可达性（但实际上存在），因此代码告诉用户不存在连通性（在此过程中使他们感到困惑）
*   30 秒后，可达性 API 通知代码现在可达性
*   但为时已晚，因为用户已经厌倦了等待，因此退出了应用程序并去了其他地方。

通过遵循 Apple 的指南来首先检查可访问性，很有可能会导致绝对糟糕的用户体验，并且应用程序在本可以完成时没有联系服务器。

这看起来很荒谬，我肯定错过了什么吗？

如何在提供响应式应用程序的同时遵循 Apple 的指导方针？

我在 Reacability API 中遇到了这些延迟并想放弃它 - 因为我见过它说没有可达性但如果你尝试有的情况，因此我希望我的应用程序无论如何都尝试连接API说。但如果我这样做，那么应用程序有可能被拒绝吗？

有解决这个困境的办法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T17:04:20.417

我犹豫要不要回答这个问题，因为它变成了一场火焰战争。 **答案可达性不起作用**。在后台线程上花费多长时间的事实根本无关紧要。

更大的问题不是它说当你做的时候你没有可达性，它说你做的时候实际上你没有。这是重点。

**Apple 不会拒绝不使用可达性的应用程序**。他们拒绝无法处理从 3G 到 wifi 和返回的网络切换的应用程序以及无法正确处理失去连接的应用程序。

**考虑到超时和重试（无论可达性如何）并在连接丢失时通知用户而未正确 ping 可靠后端的应用程序将被拒绝。**

**在网络上拔下插头时锁定的应用程序将被拒绝。**

尽管苹果试图提供帮助和清晰，但他们提供的代码并不是他们自己使用的代码，而且还不够。

您将成为应用程序开发人员，以使其适用于上述拒绝场景。

而已。所以忘记 Apple 的可达性和 simplePing。

运行您的应用程序，在请求发生时终止网络。会挂吗？失败。当请求没有发生时拉网络（但可能很快），你通知用户吗？

由于网络问题，这就是应用程序拒绝的全部内容。

不要抱怨从未奏效的东西。虽然我希望这是 Apple 的问题，但它是我们的问题，而且我在代码上工作的时间太长，无法在 StackOverflow 上泄露它。

问问自己，我是否在 ping 一个可靠的后端？

我是在线程中做的吗？

我是否为该线程计时超时？

在反应过度之前我会重试吗？

它很容易，但话又说回来，它不是。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-10T17:04:34.433

我认为你对苹果的看法有点过分了......

HIG 实际上试图表达的是，即使应用程序需要连接，它也应该期望没有连接。

所以应该优雅地告诉用户连接需要处于活动状态。

我们通常做的是简单地尝试访问连接到应用程序的服务，如果失败，我们会告诉用户启用连接。

使用**可达性**API**不是强制性**的。