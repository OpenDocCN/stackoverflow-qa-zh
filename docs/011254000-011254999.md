# StackOverflow 问答 11254000-11254999

# tsql - TSQL 如何在字符串中找到模式？

> ID：11254001
> 
> 赞同：2
> 
> 时间：2012-06-28T22:50:31.967
> 
> 标签：tsql

我有一个字符串：

```
'This is some random text so you don't get upset [rethink]' 
```

或者这个字符串

```
'This is some random text so you don't get upset [me] and [123]' 
```

是否可以使用 TSQL 查找和替换 [text] 字符串？

结果：

```
'This is some random text so you don't get upset ' 
```

或者这个字符串

```
'This is some random text so you don't get upset  and ' 
```

**编辑：**

我已经修改了接受的答案，使函数更加动态：

```
CREATE FUNCTION [dbo].[StripTagWithChar]
(@TagLeft NVARCHAR(1),@TagText NVARCHAR(MAX),@TagRight NVARCHAR(1))
RETURNS NVARCHAR(MAX)
AS
BEGIN
    DECLARE @Start INT
    DECLARE @End INT
    DECLARE @Length INT
    SET @Start = CHARINDEX(@TagLeft,@TagText)
    SET @End = CHARINDEX(@TagRight,@TagText,@Start+1)
    SET @Length = (@End - @Start) + 1

    WHILE (@Start > 0
        AND @End > 0
        AND @Length > 0)
    BEGIN
        SET @TagText = STUFF(@TagText,@Start,@Length,'')
        SET @Start = CHARINDEX(@TagLeft,@TagText)
        SET @End = CHARINDEX(@TagRight,@TagText,@Start+1)
        SET @Length = (@End - @Start) + 1
    END

    RETURN Replace(LTRIM(RTRIM(@TagText)),'  ',' ')
END 
```

现在这个函数接受括号作为输入：

```
select [dbo].[StripTagWithChar]( '{' , 'this is {not} awesome' , '}' ) 
```

最酷的是，现在它将过滤带有相同括号的标签，如下所示：

```
select [dbo].[StripTagWithChar]( '=' , 'this is =not= awesome' , '=' ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:56:44.223

我建议对[先前创建的去掉 HTML 标记的 UDF](http://blog.sqlauthority.com/2007/06/16/sql-server-udf-user-defined-function-to-strip-html-parse-html-no-regular-expression/)进行一些细微的修改......只需将`<`and`>`替换为`[`and `]`：

```
CREATE FUNCTION [dbo].[udf_StripTag]
(@TagText VARCHAR(MAX))
RETURNS VARCHAR(MAX)
AS
BEGIN
    DECLARE @Start INT
    DECLARE @End INT
    DECLARE @Length INT
    SET @Start = CHARINDEX('[',@TagText)
    SET @End = CHARINDEX(']',@TagText,CHARINDEX('[',@TagText))
    SET @Length = (@End - @Start) + 1

    WHILE (@Start > 0
        AND @End > 0
        AND @Length > 0)
    BEGIN
        SET @TagText = STUFF(@TagText,@Start,@Length,'')
        SET @Start = CHARINDEX('[',@TagText)
        SET @End = CHARINDEX(']',@TagText,CHARINDEX('[',@TagText))
        SET @Length = (@End - @Start) + 1
    END

    RETURN LTRIM(RTRIM(@TagText))
END
GO 
```

# java - 用 Java 发送/接收电子邮件

> ID：11254003
> 
> 赞同：2
> 
> 时间：2012-06-28T22:50:43.963
> 
> 标签：java, email, sendmail, post-receive-email

我想通过 Java 发送电子邮件（来自 yahoo、gmail 或任何其他部分的任何电子邮件）。

我尝试了[这里](http://www.tutorialspoint.com/java/java_sending_email.htm)给出的代码，但是我得到了异常

```
javax.mail.MessagingException: Could not connect to SMTP host: localhost, port: 25;
  nested exception is:
    java.net.ConnectException: Connection refused
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1972)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:642)
    at javax.mail.Service.connect(Service.java:295)
    at javax.mail.Service.connect(Service.java:176)
    at javax.mail.Service.connect(Service.java:125)
    at javax.mail.Transport.send0(Transport.java:194)
    at javax.mail.Transport.send(Transport.java:124)
    at myemailtesting.MyEmailTesting.main(MyEmailTesting.java:72)
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:432)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:319)
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:233)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1938)
    ... 7 more 
```

我的代码是

```
/*
* To change this template, choose Tools | Templates
* and open the template in the editor.
*/
package myemailtesting;

/**
*
* @author xxxx
*/
import java.util.Properties;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class MyEmailTesting {

    public static void main(String[] args) {

        System.out.println("This is EMAIL testing!!!");
        // Recipient's email ID needs to be mentioned.
        String to = "xx@gmail.com";

        // Sender's email ID needs to be mentioned
        String from = "xx@gmail.com";

        // Assuming you are sending email from localhost
        String host = "localhost";

        // Get system properties
        System.out.println("test 001");
        Properties properties = System.getProperties();
        System.out.println("test 002");

        // Setup mail server
        System.out.println("test 003");
        properties.setProperty("mail.smtp.host", host);

        // Get the default Session object.
        System.out.println("test 004");
        Session session = Session.getDefaultInstance(properties);

        try {
            // Create a default MimeMessage object.
            System.out.println("test 005");

            MimeMessage message = new MimeMessage(session);

            System.out.println("test 006");

            // Set From: header field of the header.
            message.setFrom(new InternetAddress(from));

            System.out.println("test 007");
            // Set To: header field of the header.
            message.addRecipient(Message.RecipientType.TO,
                    new InternetAddress(to));

            System.out.println("test 008");
            // Set Subject: header field
            message.setSubject("This is the Subject Line!");

            System.out.println("test 009");
            // Now set the actual message
            message.setText("This is actual message");

            System.out.println("test 010");
            // Send message
            Transport.send(message);
            System.out.println("Sent message successfully....");
        } catch (MessagingException mex) {
            mex.printStackTrace();
        }
    }
} 
```

对于调试，我使用语句作为`System.out.println("test 00X");`

我的输出为

```
This is EMAIL testing!!!
test 001
test 002
test 003
test 004
test 005
test 006
test 007
test 008
test 009
test 010
javax.mail.MessagingException: Could not connect to SMTP host: localhost, port: 25; 
```

我尝试了很多代码，但没有得到任何输出。得到一些例外。

我在某个地方看到，我需要保持 SMTP 服务器正常运行。我不知道需要做什么。我相信 apache commons 将是一个不错的选择。

有人可以在以下步骤中帮助我吗

1.  需要的jar文件
2.  如何设置smptp
3.  发送电子邮件（来自任何站点，即来自 yahoo 或 gmail 或任何私人电子邮件 ID）

## 或者

在java中发送电子邮件的分步过程...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:00:48.143

这不是严格意义上的 Java 问题。您需要一个传出 SMTP 服务器，您可以将消息发送到该服务器，并且该服务器会注意将其传送到适当的 google、yahoo、aol 服务器。

作为“主机”，您必须设置该 SMTP 服务器，或者如果您愿意，可以在您的机器上安装 SMTP 服务器，但这是一项艰巨的任务。通常大公司和服务提供商都有 SMTP 服务器，可以接受来自其网络内部的任何邮件。

然而，大多数 SMTP 服务器是不开放的，并且不会让您随意发送电子邮件，至少不是免费的。您可以创建一个 gmail 帐户，并使用 gmail SMTP (smtp.gmail.com)，使用您的 Transport 的帐户用户名和密码向 Google 的 SMTP 服务器进行身份验证。

此外，您不能总是指定“发件人”标头，它可能会被 SMTP 服务器重写以反映发送邮件的实际帐户，或者如果不是来自正确的 SMTP 服务器，则可能在另一端被视为垃圾邮件。

我建议您阅读 SMTP 的工作原理，它是一种过于复杂且相当陈旧的协议，但值得了解它的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:26:57.923

试试这个......它的工作......

```
import org.apache.commons.mail.*;
public class EmailTest {
    public static void main(String[] args) {
        try {
            Email email = new SimpleEmail();
            email.setSmtpPort(587);
            email.setAuthenticator(new DefaultAuthenticator("emailid@gmail.com",
                    "yourPassword"));
            email.setDebug(true);
            email.setHostName("smtp.gmail.com");
            email.setFrom("emailid@gmail.com");
            email.setSubject("Hi");
            email.setMsg("This is a test mail ... :-)");
            email.addTo("senderId@yahoo.co.in");
            email.setTLS(true);
            email.send();
            System.out.println("Mail sent!");
        } catch (Exception e) {
            System.out.println("Exception :: " + e);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:00:26.703

您没有在 localhost:25 上运行的 SMTP 邮件服务器。要么您的邮件配置错误，您应该与其他邮件服务器通信，或者您确实打算与 localhost 中的一个通信，在这种情况下，您需要安装和/或运行它。

# c - 从 Linux 移植到 Windows 8：结构成员名称

> ID：11254006
> 
> 赞同：1
> 
> 时间：2012-06-28T22:51:09.013
> 
> 标签：c, struct, compiler-errors, wdk

我正在将一些（工作）代码从 Linux 移植到 Windows 8。我正在使用 DDK。

```
typedef struct {
    unsigned int test1;
    unsigned int test2;
} settings;

const settings vp_settings = {
    .test1 = 1,
    .test2 = 1
}; 
```

使此无效的 Windows DDK 编译器和 GCC 有何不同？我得到的错误，假设`typedef struct {`是第 1 行并且编号正常继续：

> (7)：错误：C2059：语法错误：'.'

我怎样才能以不会出现语法错误的方式编写它？我想保留相同的成员名称，所以我不需要更改代码库的其余部分。期间是多余的，可以删除吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:54:33.043

问：（香草）有什么问题：

```
const settings vp_settings = {
    1, /* test1 */
    1  /* test2 */
}; 
```

PS：

[如何将 C-struct 指定初始化程序重写为 C89（resp MSVC C 编译器）](https://stackoverflow.com/questions/5440611/how-to-rewrite-c-struct-designated-initializers-to-c89-resp-msvc-c-compiler)

这看起来像 C99 的东西......而且 AFAIK MSVS 不*完全*支持 C99......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:54:46.863

看起来您的编译器不支持[C99 指定的初始化程序](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8a.doc%2Flanguage%2Fref%2Fdesignators.htm)。

也许您的编译器需要命令行开关来启用 C99 功能？

# java - 如何更改 SimpleDateFormat 使用的月份名称的大写？

> ID：11254008
> 
> 赞同：3
> 
> 时间：2012-06-28T22:51:12.207
> 
> 标签：java, internationalization, simpledateformat, date-formatting, capitalization

这段代码：

```
Locale brazil = new Locale("pt","BR");
SimpleDateFormat format = new SimpleDateFormat("d 'de' MMMM", brazil);
Date date = new Date();
String result = format.format(date);
System.out.println(result); 
```

输出：

```
28 de Junho 
```

[问题是月份名称在巴西没有大写。](http://meta.wikimedia.org/wiki/Capitalization_of_Wiktionary_pages#Capitalization_of_month_names)

这是JDK中的错误吗？如果是这样，我应该报告吗？在哪里？

我该如何解决它？Java 在哪里存储它在不同语言环境中使用的月份名称？我可以覆盖或更改它们吗？还是我必须这样做：

```
format.format(date).toLowerCase(); 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:05:32.397

这可能是 JDK 中的错误。尝试最新的JDK，如果仍然有问题，请搜索[Bug parade](http://bugs.sun.com/)，如果您还没有找到任何内容，则提交新报告。

# jasper-reports - 使用 JasperReports 创建外部 URL 超链接

> ID：11254009
> 
> 赞同：17
> 
> 时间：2012-06-28T22:51:23.837
> 
> 标签：jasper-reports

如何在链接到外部站点的 PDF 中包含超链接 (URL)？

使用像“ [http://www.stackoverflow.com](http://www.stackoverflow.com) ”这样的简单字符串，会自动生成一个链接。但是，我怎样才能使用像这样的 URL `<a href="http://www.stackoverflow.com">Click here</a>`？

如果我使用这个 HTML 字符串，Jaspers 会创建一个链接，但也会显示代码。

使用 JasperReports 4.0.4 和 iReport 4.5.1。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-29T14:01:14.843

要使 textField 成为指向外部 URL 的超链接，您需要将属性添加`hyperlinkType="Reference"`到元素，并`<hyperlinkReferenceExpression>`在其中添加标签。引用表达式是放置 URL 的位置。

例如：

```
<textField hyperlinkType="Reference" hyperlinkTarget="Blank">
    <reportElement x="5" y="5" width="200" height="15"/>
    <textElement/>
    <textFieldExpression class="java.lang.String"><![CDATA["Click Here!"]]></textFieldExpression>
    <hyperlinkReferenceExpression><![CDATA["http://www.google.com"]]></hyperlinkReferenceExpression>
</textField> 
```

该`hyperlinkTarget`属性的行为方式与`target`HTML 中的属性相同。

请注意，只有文本字段、图像和图表可以通过这种方式进行超链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-06T13:56:32.040

由于某些原因，给出的示例不起作用。我使用了[Wayback 机器](http://web.archive.org/web/20120622105137/http://jasperforge.org/uploads/publish/jasperreportswebsite/trunk/sample.reference/hyperlink/index.html)，发现以下代码段有效：

```
<textField hyperlinkType="Reference">
  <reportElement x="5" y="95" width="300" height="15"/>
  <textFieldExpression class="java.lang.String">"  >> Click here to go to www.google.com"</textFieldExpression>
  <hyperlinkReferenceExpression>"http://www.google.com
</hyperlinkReferenceExpression>
    </textField> 
```

# c# - 轻松将 WCF 的托管从自托管更改为 Windows 服务托管

> ID：11254013
> 
> 赞同：3
> 
> 时间：2012-06-28T22:51:30.813
> 
> 标签：c#, .net, wcf, visual-studio-2010, wcf-hosting

我目前正在开发一个应该作为 WCF 服务实现的项目（当然还有一个客户端应用程序）。

该项目还需要使用实体框架（代码优先方法）作为服务和数据库之间的 ORM 层。

最终，此服务应作为 Windows 服务托管。一开始我想知道是否可以使用自托管然后切换到 Windows 服务托管。在不手动复制文件和代码的情况下切换 Visual Studio 是多么容易。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T23:08:04.250

创建一个包含服务但不包含托管逻辑的“XXXServiceLibrary”项目 (dll)。在此处实现您的服务及其所有逻辑。

虽然您只关注服务，而不关心托管它们，但您可以使用以下主机之一：

*   [WCFServiceHost](http://msdn.microsoft.com/en-us/library/bb552363.aspx) (http://msdn.microsoft.com/en-us/library/bb552363.aspx)
*   IIS/WAS（创建一个 Web 项目 XXXIISServiceHost，并在 web.config 中输入必要的配置以托管您的服务。为简单起见，您也可以使用 .svc 文件）
*   一个简单的控制台应用程序 XXXConsoleServieHost，并手动编写您的自托管逻辑。但是，如果您的服务不需要任何特殊的托管逻辑，请使用前两个选项之一。

完成服务的开发和单元测试后，创建 XXXWinSvcServiceHost 项目（Windows 服务），并在其中实现托管逻辑。

你说对了。将您的服务库与其托管项目分开。是的，从一台主机转移到另一台主机非常简单直接。大多数情况下，您不需要重复配置工作；把它复制过来。

# java - TimeHandler 使用受限的随机生成器每秒

> ID：11254014
> 
> 赞同：0
> 
> 时间：2012-06-28T22:51:35.463
> 
> 标签：java, android, andengine

所以

我有一个方法可以每秒调用一次以将精灵添加到场景中。

我想要做的是能够控制调用该方法时添加的精灵的百分比。

所以我尝试使用

```
Math.Random() > .3; 
```

基本上这将有 30% 的机会添加精灵……对吗？

所以这个问题是我只有四个精灵。因此，有时当调用方法时不会将精灵添加到场景中，而每次调用方法时都会添加精灵。

所以尝试使用

```
 Random rand = new Random();

int itemNumber = rand.nextInt(4) + 1;

if (itemNumber == 1) { 
```

问题在于这完全由随机生成器控制。当我希望能够控制或多或少添加哪个精灵的百分比时。

那么我这样做的方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:54:04.727

首先，这是：

```
if(Math.Random() > .3) 
```

将通过 70% 的时间，而不是 30%。如果您想要 30%，请将其更改为`<`

**编辑：**

好的，所以您想确保调用一个精灵，并希望能够控制调用每个特定精灵的频率？您需要的是每个精灵的变量，其中包含调用它的几率。例如，这将返回一个 int 来表示每个精灵：

```
final double[] mOdds = {0.10, 0.25, 0.30, 0.35};   
// note, mOdds totals 1.0

public int pickSprite()
{
    double rand = Math.Random();
    for(int i=0;i<mOdds.length;i++)
    {
        if(rand < mOdds[i])
            return i;
        rand -= mOdds[i];
    }
    return -1;                    // should never reach this
} 
```

您可以在其中使用`mOdds`不加到 1.0 的任意数字，但您必须对其进行一些修改。基本上，如果你每回合都想要一个精灵，你只需要确保它`rand`会给你一个介于 0 和所有总数之间的数字。`mOdds`

**更新 2：**

在您的绘图例程中，您可以调用上述函数来选择精灵并进行相应的绘制：

```
...
switch(pickSprite())
{
case 0:
    // draw sprite 0
    break;
case 1:
    // draw sprite 1
    break;
case 2:
    // draw sprite 2
    break;
case 3:
    // draw sprite 3
    break;
}
... 
```

或者，如果你有一个数组中的精灵，那就更容易了：

```
...
sprite[pickSprite()].draw(); // substitute however you draw
... 
```

这完全取决于您的程序流程，真的。您应该能够使这个概念适应您正在使用的任何例程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:10:33.310

如果我理解正确。您需要生成一个介于 1-4（包括 1 和 4）之间的随机数。

此代码必须为您提供 1-4 之间的随机数（包括 1 和 4）。

```
Math.ceil(Math.random()*4); 
```

# javascript - 做一个超链接也提交一些表单信息

> ID：11254020
> 
> 赞同：0
> 
> 时间：2012-06-28T22:51:56.287
> 
> 标签：javascript, python, html, forms, jinja2

关于这个有很多问题，但没有一个能完全描述我的情况。

为了便于使用并帮助 Google 对我的网站进行搜索索引，我想将一部分单选按钮更改为提交表单以及更改页面的超链接。

我的暂定代码是这样的，但还没有完全通过。这会向服务器提交表单吗？顺便说一句，我使用 google app engine 和 python 作为服务器语言和 jinja2 进行模板。

```
<ul>
  <form name="myForm">
    <li><a href="/air/skydiving"><input type="hidden1" name="foo1" value="bar1">Skydiving</a></li>

    <li><a href="/air/paragliding"><input type="hidden" name="foo2" value="bar2">Paragliding</a></li>

    <li><a href="/air/hanggliding"><input type="hidden" name="foo3" value="bar3">hang gliding</a></li>

    <li><a href="/air/basejumping"><input type="hidden" name="foo4" value="bar4">base jumping</a></li>
   </form>
</ul> 
```

更新：所以我意识到这是一个糟糕的问题，我忘记了我最初学到的关于 HTML 的知识之一。我需要使用 GET 请求将一些参数发送到我的 python 服务器脚本，以允许它处理其余部分。这是我正在使用的代码：

HTML：

```
<ul>
    <li><a href="/air?s=1">Skydiving</a></li>
    <li><a href="/air?s=2">Paragliding</a></li>
    <li><a href="/air?s=3">Hang Gliding</a></li>
    <li><a href="/air?s=4">Base Jumping</a></li>
    <li><a href="/air?s=5">Balloons</a></li>
</ul> 
```

Python

```
s = webapp2.request.get('s')
if s ==1:
    #do what I want with this one
elif s == 2:
    #same on down the line 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:00:16.887

你为什么坚持使用POST？如果您担心 SEO 发布表单实际上会降低目标页面的 SEO 质量。您可以使用 get 请求将参数作为查询字符串传递到服务器端。您不需要发布表单，您仍然可以在目标脚本中获取传递的变量并使用它们。例如，通过调用`http://stackoverflow.com/posts?foo=bar&baz=qux`您可以将 2 个变量传递到服务器端。在处理脚本中，您可以阅读：

```
foo = bar
baz = qux 
```

如果您仍然坚持发出 POST 请求，则应使用 javascript 处理此问题。尝试搜索“javascript form post”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:33:08.267

您将需要使用 JavaScript 来完成此操作。我也会重组一些东西。这是我认为您正在寻找的最终解决方案（使用 jQuery）：

# JavaScript

```
$(document).ready(function () {
    $("form > li > a").click(function () { $(this).parent().parent().submit(); });
}); 
```

# HTML

```
<form name="myForm" method="POST" action="/air/skydiving">
    <input type="hidden" name="foo" value="bar1" />
    <li><a href="javascript:;">Skydiving</a></li>
</form>

<form name="myForm2" method="POST" action="/air/paragliding">
    <input type="hidden" name="foo" value="bar2" />
    <li><a href="javascript:;">Paragliding</a></li>
</form>

<form name="myForm3" method="POST" action="/air/hanggliding">
    <input type="hidden" name="foo" value="bar3" />
    <li><a href="javascript:;">hang gliding</a></li>
</form>

<form name="myForm4" method="POST" action="/air/basejumping">
    <input type="hidden" name="foo" value="bar3" />
    <li><a href="javascript:;">base jumping</a></li>
</form> 
```

# caching - 如何为可缓存的 PCIe BAR 做 mmap

> ID：11254023
> 
> 赞同：8
> 
> 时间：2012-06-28T22:52:22.887
> 
> 标签：caching, mmap, pci, pci-e

我正在尝试`mmap()`为 PCIe BAR 编写具有自定义功能的驱动程序，目的是使此 BAR 可缓存在处理器缓存中。我知道这不是实现最高带宽的最佳方式，而且写入的顺序是不可预测的（在这种情况下也不是问题）。

这类似于[如何防止 MMAP 缓存值？](https://stackoverflow.com/questions/9890728/how-would-one-prevent-mmap-from-caching-values)

处理器是 Sandy Bridge i7，PCIe 设备是 Altera Stratix IV dev。木板。

首先，我尝试在 CentOS 5 (2.6.18) 上进行。我更改了 MTRR 设置以确保 BAR 不在不可缓存的 MTRR 范围内，并且与`io_remap_pfn_range()`清除位一起使用。读取按预期工作：读取返回正确的值，并且第二次读取到同一地址并不一定会导致读取转到 PCIe（在 FPGA 中检查了读取计数器）。但是，写入导致系统冻结，然后重新启动，而日志或屏幕上没有任何消息。`_PAGE_PCD``_PAGE_PWT`

其次，我尝试在支持 PAT 的 CentOS 6 (2.6.32) 上进行。结果是一样的：读取工作正常，写入导致系统冻结并重新启动。有趣的是，非临时/写入组合的完整高速缓存行写入（AVX/SSE）按预期工作，即它们总是转到 FPGA 并且 FPGA 观察到完整的高速缓存行写入，然后读取返回正确的值。但是，简单的 64 位写入仍然会导致系统冻结/重启。

我也试过`ioremap_cache()`再`iowrite32()`里面的驱动代码。结果是一样的。

我认为这是一个硬件问题，但如果有人可以分享任何关于正在发生的事情的想法，我将不胜感激。

编辑：我能够在 CentOS 6 上捕获 MCE 消息：机器检查异常：5 银行 5：be2000000003110a。

我还在 2-socket Sandy Bridge (Romley) 上尝试了相同的代码：读取和非临时写入行为是相同的，简单写入不会导致 MCE/崩溃但对系统状态没有影响，即内存中的值不会改变.

此外，我在较旧的 2-socket Nehalem 系统上尝试了相同的代码：简单写入也会导致 MCE，尽管代码不同。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-06T17:52:43.333

我不知道有任何 x86 硬件支持 MMIO 地址的 WriteBack (WB) 内存类型，您几乎肯定会看到这种不兼容的结果。[我已经在我的博客http://blogs.utexas.edu/jdm4372/2013/05/29/](http://blogs.utexas.edu/jdm4372/2013/05/29/)和[http://blogs.utexas.edu/jdm4372/2013/05/30/](http://blogs.utexas.edu/jdm4372/2013/05/30/)上发布了关于这个主题的讨论

在这些帖子中，我讨论了一种适用于某些处理器的方法——两次映射 MMIO 范围——一次用于使用写入组合 (WC) 内存类型从处理器到 FPGA 的存储操作，一次用于从处理器读取使用写保护 (WP) 或直写 (WT) 类型到 FPGA。当您在“只写”区域中写入该行的别名时，您将需要通过在“只读”区域中的缓存行上使用 CLFLUSH 手动保持一致性。您还需要手动维护 FPGA 内存中值变化的一致性，因为 IO 设备无法为 MMIO 地址生成缓存失效事务。

几年前，当我在 AMD 工作时，我的团队就这样做了，现在我正试图弄清楚如何使用更新的 Linux 内核和英特尔处理器来做到这一点。Linux 不直接支持具有预定义映射功能的 WP 或 WT 内存类型，因此需要进行一些黑客攻击....覆盖区域的 MTRR 相当容易，但我很难找到正确的位置（ s) 在我需要更改的 remap_pfn_range() 函数的后代中，以便在该范围的 PAT 条目中设置 WP 或 WT 属性。

这种方法可能比其他（预定义）类型的 IO 设备更适合 FPGA，因为 FPGA 的可编程性允许灵活地定义 PCI BAR 以在这种双映射模式下运行并与处理器协作 -维护缓存一致性的辅助驱动程序。

# java - 用 Jpa 编写 XML 文件

> ID：11254030
> 
> 赞同：0
> 
> 时间：2012-06-28T22:52:56.813
> 
> 标签：java, xml, jpa, jaxb

我使用 JAXB.marshal(list,file.xml) 编写 XML 文件。它运行良好，我可以将数据导入 excel 或访问。但所有列都作为字符串导入，尽管有些是双精度或日期。对于日期字段，我使用了 @Temporal(javax.persistence.TemporalType.DATE) 注释。如何将数据类型保存在 xml 文件中？还是我必须将其保存在 XML 架构中？如果是这样，我可以用jpa自动生成它吗？

编辑：我设法生成了一个 xml 和 xsd 文件：

XSD：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">

<xs:complexType name="eintragListe">
<xs:sequence>
<xs:element name="Eintrag" type="eintrag" minOccurs="0" maxOccurs="unbounded"/>
</xs:sequence>
</xs:complexType>

<xs:complexType name="eintrag">
  <xs:sequence>
  <xs:element name="art" type="xs:string" minOccurs="0"/>
  <xs:element name="betrag" type="xs:double"/>
  <xs:element name="datum" type="xs:dateTime" minOccurs="0"/>
  <xs:element name="id" type="xs:int"/>
  <xs:element name="pa" type="xs:int"/>
  <xs:element name="typ" type="xs:string" minOccurs="0"/>
  <xs:element name="verwendung" type="xs:string" minOccurs="0"/>
</xs:sequence>
   </xs:complexType>
</xs:schema> 
```

XML:

```
 <?xml version="1.0" encoding="UTF-8"?>
<ns2:eintragListe xmlns:ns2="www">
    <Eintrag>
        <art>Einmalig</art>
    <betrag>27.0</betrag>
    <datum>2012-06-01T00:00:00+02:00</datum>
    <id>601</id>
    <pa>-1</pa>
    <typ>Ausgabe</typ>
    <verwendung>Irgendswas</verwendung>
</Eintrag>
<Eintrag>
    <art>Einmalig</art>
    <betrag>17.0</betrag>
    <datum>2012-06-01T00:00:00+02:00</datum>
    <id>502</id>
    <pa>-1</pa>
    <typ>Ausgabe</typ>
    <verwendung>Irgendwasanderes</verwendung>
    </Eintrag>
</ns2:eintragListe> 
```

我现在想将这些文件导入到 excel 中，但我总是得到一个错误，即架构不适合 xml 文件。有解决办法吗？感谢四位您的帮助:)

# wpf - 如何使用 EventAggregator 和 Microsoft Prism 库从订阅的方法返回数据

> ID：11254032
> 
> 赞同：6
> 
> 时间：2012-06-28T22:53:22.153
> 
> 标签：wpf, events, mvvm, prism, eventaggregator

我正在使用 MVVM 和`Microsoft Prism libraries`. 因此，当我需要通过类进行通信时，我使用类`Microsoft.Practices.Prism.MefExtensions.Events.MefEventAggregator`并发布事件和订阅方法，如下所示：

要发布：

`myEventAggregator.GetEvent<MyEvent>().Publish(myParams)`

认购：

`myEventAggregator.GetEvent<MyEvent>().Subscribe(MySubscribedMethod)`

但我的问题是：**有没有办法在发布事件后从“订阅方法”返回一些数据？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T23:24:35.993

据我所知，如果所有事件订阅者都使用该`ThreadOption.PublisherThread`选项（这也是默认选项），则事件同步执行并且订阅者可以修改`EventArgs`对象，因此您可以在发布者中拥有

```
myEventAggregator.GetEvent<MyEvent>().Publish(myParams)
if (myParams.MyProperty)
{
   // Do something
} 
```

订阅者代码如下所示：

```
// Either of these is fine.
myEventAggregator.GetEvent<MyEvent>().Subscribe(MySubscribedMethod)
myEventAggregator.GetEvent<MyEvent>().Subscribe(MySubscribedMethod, ThreadOption.PublisherThread)

private void MySubscribedMethod(MyEventArgs e)
{
    // Modify event args
    e.MyProperty = true;
} 
```

如果您知道应该始终同步调用事件，则可以为`CompositePresentationEvent<T>`覆盖该`Subscribe`方法的事件（而不是 ）创建自己的基类，并且只允许订阅者使用该`ThreadOption.PublisherThread`选项。它看起来像这样：

```
public class SynchronousEvent<TPayload> : CompositePresentationEvent<TPayload>
{
    public override SubscriptionToken Subscribe(Action<TPayload> action, ThreadOption threadOption, bool keepSubscriberReferenceAlive, Predicate<TPayload> filter)
    {
        // Don't allow subscribers to use any option other than the PublisherThread option.
        if (threadOption != ThreadOption.PublisherThread)
        {
            throw new InvalidOperationException();
        }

        // Perform the subscription.
        return base.Subscribe(action, threadOption, keepSubscriberReferenceAlive, filter);
    }
} 
```

然后不是派生`MyEvent`自`CompositePresentationEvent`，而是派生自`SynchronousEvent`，这将保证您将同步调用该事件并且您将获得修改后的内容`EventArgs`。

# javascript - 验证间隔列表的算法

> ID：11254033
> 
> 赞同：1
> 
> 时间：2012-06-28T22:53:30.983
> 
> 标签：javascript, validation, intervals, timespan, interval-tree

给定开始/结束日期时间值的列表，我需要验证三件事：

1.  对于每个间隔，开始时间在结束时间之前
2.  列表元素之间不存在重叠，每个开始/结束跨度必须代表整个列表中的离散间隔
3.  系列中不能有间隔，从最早的开始到最晚的结束，必须有连续的覆盖。

所以，给定：

```
( (1970-01-01, 1970-12-31), (1971-01-01, 1971-12-31), (1972-01-01, 1972-12-31), (1973-01-01, 1973-12-31) ) 
```

给出一个成功的结果。

给定

```
( (1970-12-31, 1970-01-01), (1970-10-01, 1971-12-31), (1972-01-01, 1972-12-31), (1973-01-01, 1973-12-31) ) 
```

提供一条消息，指出开始日期晚于第一个元素中的结束日期。

给定

```
( (1970-01-01, 1970-12-31), (1970-10-01, 1971-12-31), (1972-01-01, 1972-12-31), (1973-01-01, 1973-12-31) ) 
```

提供说明第一和第二元素之间存在重叠的消息。

给定

```
( (1970-01-01, 1970-12-31), (1971-10-01, 1971-12-31), (1973-01-01, 1973-12-31), (1974-01-01, 1974-12-31) ) 
```

提供一条消息，说明第二个和第三个元素之间存在间隙。

第一个要求很简单，问题是如何最好地将其纳入更广泛的验证。

下面的文章在一定程度上满足了第二个要求，但由于它仅适用于一对间隔，我仍然会意识到 O(n^2) 因为每个元素都需要与其他元素进行比较，对吗？[确定两个日期范围是否重叠](https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap)

这篇文章 -[在区间列表中搜索区间重叠？](https://stackoverflow.com/questions/4446112/search-for-interval-overlap-in-list-of-intervals)- 似乎更好地解决了第二个要求，第一个可以滚动到区间树的种群中。

这样就剩下第三个要求了。是否可以使用区间树确定整个区间的间隙？

我会提到这是在 Javascript，node.js 中。然而，用 Haskell 或其他函数式语言解决这个问题会很有趣......

谢谢！

r/史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T02:29:31.843

这段代码提供了一个解决方案，尽管我假设如下：

*   您不介意对列表进行排序。它大大减少了要进行的比较次数。
*   给定您的示例，您在日期之间的比较是在日级别。如果没有，您可能需要更改`strToDate`函数以及`adjustment`变量。

这个想法来自@alfasin。

```
var data = [
    ['1970-01-01', '1970-12-31'], 
    ['1971-01-01', '1971-12-31'], 
    ['1972-01-01', '1972-12-31'], 
    ['1973-01-01', '1973-12-31']
];

// comparison is in day level, adjust otherwise.
var adjustment = 1000 * 60 * 60 * 24;

var parsedData = [];
for(var idx = 0; idx < data.length; idx++) {
    var thisItem = data[idx];

    var thisParsedItem = [
        Math.floor(strToDate(thisItem[0]).getTime() / adjustment), 
        Math.floor(strToDate(thisItem[1]).getTime() / adjustment),
        // adding original items here, since I plan to sort the list.
        thisItem[0],
        thisItem[1]
    ];

    parsedData.push(thisParsedItem);
}

parsedData = parsedData.sort(function (itemA, itemB) {
    return itemA[0] - itemB[0];
});

var errorLocation = -1, overlap = false, gap = false, endBeforeStart = false;
for(var idx = 0; idx < parsedData.length - 1; idx++) {
    // start before end.
    if (parsedData[idx][0] > parsedData[idx][1]) {
        errorLocation = idx;
        endBeforeStart = true;
        break;
    }

    var d = parsedData[idx + 1][0] - parsedData[idx][1];

    // gap.
    if (d > 1) {
        errorLocation = idx + 1;
        gap = true;
        break;
    }

    // overlap.
    if (d < 1) {
        errorLocation = idx + 1;
        overlap = true;
        break;
    }
}

if (errorLocation > -1) {
    if (gap) { console.log("You have a gap at: " + errorLocation); }
    if (overlap) { console.log("You have an overlap at: " + errorLocation); }
    if (endBeforeStart) { console.log("End before start at: " 
                                  + errorLocation); }
}

function strToDate(input) {
    var parts = input.split('-');
    return new Date(
            parseInt(parts[0]), 
            parseInt(parts[1]), 
            parseInt(parts[2]));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:25:52.197

首先使用 python 中的 datetime.datetime.strptime 之类的解析日期，然后将日期转换为毫秒并进行简单的检查。

[在 Python 中以毫秒为单位获取当前时间？](https://stackoverflow.com/questions/5998245/get-current-time-in-milliseconds-in-python)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:31:34.413

如果不提供完整的工作示例，您可以执行以下操作：

1.  按开始日期对列表进行排序（在排序功能中，您还可以验证 if `start < end`）
2.  遍历列表并确保：
    1.  item 是列表的第一项
    2.  开始日期比上一个停止日期多一个

我想这并没有真正降低函数的顺序（N x N log N），除非它已经排序并且您可以跳过第 1 步。

# c - 如何知道 HTTP 标头部分何时结束？

> ID：11254037
> 
> 赞同：4
> 
> 时间：2012-06-28T22:54:08.903
> 
> 标签：c, sockets, http-headers

服务器返回 HTTP 头和二进制文件；像这样的东西：

```
HTTP/1.1 200 OK
Date: Thu, 28 Jun 2012 22:11:14 GMT
Server: Apache/2.2.3 (Red Hat)
Set-Cookie: JSESSIONID=blabla; Path=/
Pragma: no-cache
Cache-Control: must-revalidate, no-store
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Content-disposition: inline; filename="foo.pdf"
Content-Length: 6231119
Connection: close
Content-Type: application/pdf

%PDF-1.6
%âãÏÓ
5989 0 obj
<</Linearized 1/L 6231119/O 5992/E 371504/N 1498/T 6111290/H [ 55176 6052]>>
endobj

xref
5989 2744
0000000016 00000 n
0000061228 00000 n
0000061378 00000 n 
```

我只想复制二进制文件。但是如何知道标题部分何时结束？我尝试检查该行是否包含 a`\r\n\r\n`但看起来该标准不适用于服务器响应，仅适用于客户端。这给出了：

```
Content-disposition: inline; filename="foo.pdf"
Content-Length: 6231119
Connection: close
Content-Type: application/pdf

%PDF-1.6
%âãÏÓ
5989 0 obj
<</Linearized 1/L 6231119/O 5992/E 371504/N 1498/T 6111290/H [ 55176 6052]>>
endobj

xref
5989 2744
0000000016 00000 n 
```

这是C代码：

```
while((readed = recv(sock, buffer, 128, 0)) > 0) {

    if(isnheader == 0 && strstr(buffer, "\r\n\r\n") != NULL)
        isnheader = 1;

        if(isnheader) 
          fwrite(buffer, 1, readed, fp);
} 
```

**更新：**

`continue`我在 if 语句中添加了一个控件：

```
if(isnheader == 0 && strstr(buffer, "\r\n\r\n") != NULL) {
    isnheader = 1;
    continue;
} 
```

嗯，它按预期工作。但正如@Alnitak 所提到的，这并不安全。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-28T22:56:17.970

标题和正文应该由`\r\n\r\n`（RFC 2616 的第 4.1 节）分隔

然而，一些服务器可能会省略`\r`and only send`\n`行，特别是如果它们无法清理任何 CGI 提供的标头以确保它们包含`\r`.

您还需要考虑如何对读取进行分块 - 分隔符很可能跨越您的 128 字节块，这将阻止`strstr`调用工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T05:05:40.117

您没有正确解析输入。以下是您做错的几件事：

*   您的代码似乎暗示您的缓冲区将最多包含一行标题数据。但是 recv() 不是对“行”数据进行操作，而是对二进制数据块进行操作。因此，如果您告诉它您的缓冲区长度为 128 字节，它会尝试用 128 字节的数据填充您的缓冲区（即使 128 字节的数据包含多个“行”）。
*   您的代码没有考虑到标头中断的“\r\n”可能会通过对 recv() 的两次不同调用被拉入您的缓冲区，这将阻止您的代码识别标头中断。
*   如果您确实找到了标头中断（如果标头的大小恰到好处，则可能会发生这种情况），您最终将推送带有终止“\r\n”和标头中断（“\r\n”）的最后一个标头到您的二进制数据副本中。

我编写了一个快速函数，它应该找到 HTTP 标头的结尾并将服务器的其余响应写入文件流：

```
void parse_http_headers(int s, FILE * fp)
{
   int       isnheader;
   ssize_t   readed;
   size_t    len;
   size_t    offset;
   size_t    pos;
   char      buffer[1024];
   char    * eol; // end of line
   char    * bol; // beginning of line

   isnheader = 0;
   len       = 0;

   // read next chunk from socket
   while((readed = read(s, &buffer[len], (1023-len))) > 0)
   {
      // write rest of data to FILE stream
      if (isnheader != 0)
         fwrite(buffer, 1, readed, fp);

      // process headers
      if (isnheader == 0)
      {
         // calculate combined length of unprocessed data and new data
         len += readed;

         // NULL terminate buffer for string functions
         buffer[len] = '\0';

         // checks if the header break happened to be the first line of the
         // buffer
         if (!(strncmp(buffer, "\r\n", 2)))
         {
            if (len > 2)
               fwrite(buffer, 1, (len-2), fp);
            continue;
         };
         if (!(strncmp(buffer, "\n", 1)))
         {
            if (len > 1)
               fwrite(buffer, 1, (len-1), fp);
            continue;
         };

         // process each line in buffer looking for header break
         bol = buffer;
         while((eol = index(bol, '\n')) != NULL)
         {
            // update bol based upon the value of eol
            bol = eol + 1; 

            // test if end of headers has been reached
            if ( (!(strncmp(bol, "\r\n", 2))) || (!(strncmp(bol, "\n", 1))) )
            {
               // note that end of headers has been reached
               isnheader = 1;

               // update the value of bol to reflect the beginning of the line
               // immediately after the headers
               if (bol[0] != '\n')
                  bol += 1;
               bol += 1;

               // calculate the amount of data remaining in the buffer
               len = len - (bol - buffer);

               // write remaining data to FILE stream
               if (len > 0)
                  fwrite(bol, 1, len, fp);

               // reset length of left over data to zero and continue processing
               // non-header information
               len = 0;
            };
         };

         if (isnheader == 0)
         { 
            // shift data remaining in buffer to beginning of buffer
            offset = (bol - buffer);
            for(pos = 0; pos < offset; pos++)
               buffer[pos] = buffer[offset + pos];

            // save amount of unprocessed data remaining in buffer
            len = offset;
         };
      };
   };

   return;
} 
```

我没有测试过代码，所以它可能有简单的错误，但是它应该为您指出正确的方向，以便从 C 中的缓冲区解析字符串数据。

# c# - 是否可以在 c# 中的 Powershell cmdlet 之间共享属性和注释？

> ID：11254044
> 
> 赞同：8
> 
> 时间：2012-06-28T22:54:48.667
> 
> 标签：c#, powershell, cmdlet

在 Powershell cmdlet 中公开一组相关函数时，是否可以共享属性名称和摘要帮助以在程序集中跨 cmdlet 规范这些函数？

我知道这可以通过派生类来完成，但是当有多个具有不同属性的 cmdlet 要共享时，这个解决方案充其量是尴尬的。

这是一个非常简单的例子。我想共享属性“名称”和所有相关注释，以便它们在我们生成的 N 个 cmdlet 中是相同的，但我想不出在 c# 中执行此操作的好方法。理想情况下，任何共享都将允许指定参数属性，例如强制或位置。

```
namespace FrozCmdlets
{
using System.Management.Automation;

/// <summary>
/// Adds a new froz to the system.
/// </summary>
[Cmdlet( VerbsCommon.Add, "Froz" )]
public class AddFroz : Cmdlet
{
    /// <summary>
    /// The name of the froz.
    /// For more information on the froz, see froz help manual.
    /// </summary>
    [Parameter]
    public string Name { get; set; }

    protected override void ProcessRecord()
    {
        base.ProcessRecord();
        // Add the froz here
    }
}

/// <summary>
/// Removes a froz from the system.
/// </summary>
[Cmdlet( VerbsCommon.Remove, "Froz" )]
public class RemoveFroz : Cmdlet
{
    /// <summary>
    /// The name of the froz.
    /// For more information on the froz, see froz help manual.
    /// </summary>
    [Parameter]
    public string Name { get; set; }

    protected override void ProcessRecord()
    {
        base.ProcessRecord();
        // Remove the froz here
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-15T03:50:54.620

是的，有一种方法可以做到这一点，而无需从参数的公共基类继承。它没有很好的记录，仅在[IDynamicParameters.GetDynamicParameters](http://msdn.microsoft.com/en-us/library/system.management.automation.idynamicparameters.getdynamicparameters(v=vs.85).aspx)方法的注释中有所暗示。这是对该主题的更详细处理。

首先，创建一个类，将您的公共参数声明为具有 [Parameter] 属性的属性：

```
internal class MyCommonParmeters
{
    [Parameter] 
    public string Foo { get; set; }
    [Parameter]
    public int Bar { get; set; }
    ...
} 
```

然后每个想要使用这些公共参数的 Cmdlet 都应该实现 IDynamicParameters 接口以返回 MyCommonParameters 类的成员实例：

```
[Cmdlet(VerbsCommon.Add, "Froz")]
public class AddFroz : PSCmdlet, IDynamicParameters
{
    private MyCommonParmeters MyCommonParameters 
        = new MyCommonParmeters();

    object IDynamicParameters.GetDynamicParameters()
    {
        return this.MyCommonParameters;
    }
    ... 
```

使用这种方法，PowerShell 命令参数绑定器将查找并填充 MyCommonParameters 实例上的参数，就像它们是 Cmdlet 类的成员一样。

# ruby-on-rails - 我可以向删除方法发送参数吗？

> ID：11254047
> 
> 赞同：0
> 
> 时间：2012-06-28T22:55:10.547
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

所以这是场景：

在我的合作伙伴模型的显示视图中，我需要一个链接到另一个模型的删除方法，即我的 RecommendPartner 模型。

但是我需要在销毁方法完成后返回我的合作伙伴节目。

给代码！！

我的合作伙伴展示视图（如果这非常难看，我接受建议）：

```
 <div>
    <%= link_to 'Destroy!', @partner.recommended?(current_user), confirm: 'Are your sure?', method: 'delete', :controller => "recommend_partners", :action => "destroy", :p_id => @partner.id  %>
  </div> 
```

如您所见，我正在尝试将 :p_id 发送到参数，但没有成功。

这是我的推荐？方法如果您需要知道，它只返回一个 RecommendPartner 对象。在我的 Partner.rb 中：

```
def recommended? (user)
  RecommendPartner.find_by_user_id_and_partner_id(user.id,self.id)
end 
```

是的，RecommendPartner 属于用户和合作伙伴模型。

最后是我的推荐伙伴控制器销毁方法：

```
def destroy
  @recommend_partner = RecommendPartner.find(params[:id])
  partner = Partner.find(params[:p_id])
  @recommend_partner.destroy

  respond_to do |format|
    format.html { redirect_to partner }
    format.json { head :no_content }
  end
end 
```

所以 params[:p_id] 是 nil 并且我不能重定向回伙伴显示我是... =/

有什么建议么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:42:52.887

所以感谢@hakunin 的评论，这是最好的解决方案

更改控制器，以便我不需要 p_id 参数：

```
 def destroy
    @recommend_partner = RecommendPartner.find(params[:id])
    @partner = @recommend_partner.partner
    @recommend_partner.destroy

    respond_to do |format|
      format.html { redirect_to @partner }
      format.json { head :no_content }
    end
  end 
```

然后将 link_to 方法修改为如下所示：

```
<%= link_to 'Destroy!', @partner.recommended?(current_user), confirm: 'Are you sure?', method: :delete %> 
```

效果很好！干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:20:27.800

你可以试试这个吗？：

```
<%= button_to 'Destroy!', partner_path(@partner.recommended?(current_user), 'p_id' => @partner.id), :method => 'delete', :confirm => 'Are your sure?' %> 
```

# linux - Bare Bones linux源代码

> ID：11254050
> 
> 赞同：-3
> 
> 时间：2012-06-28T22:55:26.947
> 
> 标签：linux

我正在寻找为我的家庭娱乐系统界面构建一个基于 linux 的操作系统，并且我正在寻找源代码作为基础。我希望从头开始设计自己的 UI 和帐户系统，但如果它具有网络、文件系统和 OpenGL 支持，那就太好了。

有没有我可以用作基础的 linux 版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:58:50.053

您可能低估了所涉及的复杂性。您可能会发现只安装[Fedora](https://getfedora.org/)之类的软件并安装自定义[窗口管理器](https://docs.fedoraproject.org/en-US/Fedora/13/html/Deployment_Guide/s2-x-clients-winmanagers.html)会更容易。如果你真的想要，你可以构建自己的 UI，但这需要*大量*的工作。您几乎可以肯定不需要建立自己的帐户系统；Linux 现有的用户管理功能强大且经过实战考验。只需围绕现有系统构建一些东西。

也就是说，你可能会发现[Linux From Scratch](http://www.linuxfromscratch.org/)是一个有用的资源——它引导你获取和编译启动和运行 Linux 所需的一切——当然你可以在此过程中自定义很多东西，尽管你偏离的越多他们的指示，你可能会遇到更多的麻烦:)

如果有人在这里偶然发现 Linux 内核本身的源代码，您可以在[kernel.org找到它 - 您可以从](http://www.kernel.org/)[Linux git 存储库](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git)浏览或克隆源代码本身。

# mysql - Mysql的索引工作

> ID：11254051
> 
> 赞同：1
> 
> 时间：2012-06-28T22:55:27.517
> 
> 标签：mysql, mysql-management

假设我有一张桌子`events {id, userid, create_time, country, type, page, browser}`

我对所有列都有索引。如果我做一个查询

```
select count(*) from events where id > ? and id < ? and userid>? and userid<? and create_time>? and create_time<? and browser=? and country=? and page=? 
```

我有以下问题：

1.  我的所有索引都会被使用吗？如果没有，如何实现。
2.  多列索引会更好吗？
3.  如果我在 (id,userid,page) 上有一个多列索引，它会被使用吗？如果是这样，是否还会使用其他索引？
4.  如果我有一个包含所有列的多列索引，但我的查询不包括所有列，那么是否会使用该索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:59:31.030

> 我的所有索引都会被使用吗？

不会。只会使用一个索引。您可以在 EXPLAIN 的输出中看到这一点。

> 多列索引会更好吗？

如果你有平等约束，是的。但在您的查询中似乎并非如此。拥有一个覆盖索引也很好——这是一个包含查询所需的所有值的索引。

> 如果我在 (id,userid,page) 上有一个多列索引，它会被使用吗？

可能，但我建议添加`create_time`，因为这会使它成为一个覆盖索引。您不需要`page`在索引中，因为它没有在您的查询中使用。

> 如果我有一个包含所有列的多列索引，但我的查询不包括所有列，那么是否会使用该索引？

这取决于列的顺序。如果查询想要使用索引，`create_time`那么它可以使用索引`(create_time, country)`。但是索引`(country, create_time)`无济于事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:54:42.573

**问：**我的所有索引都会被使用吗？

**答：**极不可能。MySQL 更有可能选择一个单一的索引，一个具有最高选择性（消除最多行）的索引，然后从索引引用中访问数据页。

MySQL 可能会执行索引合并操作，但这将是罕见的例外。你真的需要做一个`EXPLAIN`看看这是否正在发生，并做一些工作来开发一个 MySQL 将其视为最佳计划的案例。（可能有人已经完成了这项工作，并且有这样的测试用例。）

**问：**如果没有，如何实现。

**A：**你不想达到那个目的。您希望 MySQL 做的是生成一个最佳计划。索引合并计划很可能不是您查询的最佳计划。这样的操作需要 MySQL 将所有这些索引“匹配”在一起，这是一项繁重的工作。

**问：**多列索引会更好吗？

**答：**是的。您的特定查询的最佳索引是覆盖索引，它包括查询中引用的所有列。通常，您首先需要具有最高选择性和最高基数的列。您的查询似乎在进行范围扫描而不是相等性测试，您希望与列的整个值集相比，谓词中值范围最窄的列，首先在索引中。

**问：**如果我在 (id,userid,page) 上有一个多列索引，它会被使用吗？

**答：**可能。您在该索引的两个前导列上有范围扫描谓词，因此它绝对看起来像一个候选者。如果这些是您的查询中引用的唯一列，那么它更有可能使用索引。

您的查询文本中似乎对 create_time 的引用格式错误。看起来您打算在该列上有某种谓词。如果是这种情况，那么索引`(id, userid, create_time)`将是更好的候选者，因为这样可以从索引中满足查询，而无需引用数据页。

另一方面，对数据页进行全面扫描可能是更理想的计划。

**问：**如果是这样，是否还会使用其他索引？

**答：**极不可能。MySQL 将在表上使用“多个”索引的想法是关于 MySQL 如何使用索引的常见误解。这不是不可能的，但 INDEX MERGE 操作不太可能是最佳计划。

**问：**如果我有一个包含所有列的多列索引，但我的查询不包含所有列，那么是否会使用该索引？

**答：**有可能。如果 MySQL 确定使用该索引是最佳计划，则将使用它。更有可能使用的索引（如果可用）是一个覆盖索引，它只包含查询中引用的列。

# gcc - Cmake错误：即使升级到新版本，也引用旧版本

> ID：11254058
> 
> 赞同：0
> 
> 时间：2012-06-28T22:56:20.503
> 
> 标签：gcc, compiler-construction, cmake, cross-compiling

```
CMake Error: your C compiler: "/home/user/revision OLD/host/linux/x86/usr/bin/qcc" was not found.   
Please set CMAKE_C_COMPILER to a valid compiler path or name.

CMake Error: your CXX compiler: "/home/user/revision OLD/host/linux/x86/usr/bin/qcc" was not found.
Please set CMAKE_CXX_COMPILER to a valid compiler path or name.

-- Configuring incomplete, errors occurred!
make: *** [cmake_check_build_system] Error 1 
```

* * *

我将我的修订版更改为新版本，即使它指的是修订版 OLD 路径。我读过他们建议的wiki FAQ

```
$ cmake -G "Your Generator" -D CMAKE_C_COMPILER=gcc-4.2 -D CMAKE_CXX_COMPILER=g++-4.2 path/to/your/source 
```

但这是正确的方法吗？因为我听说有一些缺点，比如重置其他 FLAGS ？

我根本不知道cmake。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:01:46.653

是的，您可以`cmake -DCMAKE_C_COMPILER=/new/revision/cc -DCMAKE_CXX_COMPILER=/new/revision/c++ .`在构建目录中运行。但这将导致 CMake 进行完全重新配置，因此您将丢失对默认配置的更改。

AFAIK，没有办法阻止 CMake 这样做，因为它是故意的。CMake 根据选定的编译器设置了很多内部配置变量，因此当您更改编译器时它会重复它。

解决此问题的唯一方法 - 将符号链接到较新版本的编译器。

# playframework-2.0 - play 2.0 自动应用测试模式配置

> ID：11254059
> 
> 赞同：2
> 
> 时间：2012-06-28T22:56:23.300
> 
> 标签：playframework-2.0, typesafe-stack

我的应用程序会将文件上传到 S3，但我希望它在测试模式（播放测试）下运行时上传到另一个存储桶。有什么解决方法吗？我在 play 1.x 中看到了一个名为 application ids 的功能。但我在 2.0 文档下找不到它。

运行测试模式时，play 将使用 'test.s3.bucket' 而不是 's3.bucket'。

**应用程序.conf**

```
s3.bucket=prodbucket
test.s3.bucket=testbucket 
```

编辑：除了#kheraud 答案之外，Application 还提供 isProd()、isTest() 和 isDev()。

```
String bucketName = (Play.application().isProd())
                ? Play.application().configuration().getString("s3.bucket")
                : Play.application().configuration().getString("dev.s3.bucket"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T08:43:34.607

您可以使用（未​​测试）访问运行模式：

```
import play.api.Play.current

val targetBukkett = if(play.api.Play.application.mode == "Dev") {
    test.s3.bucket
} else {
    s3.bucket
} 
```

# ruby-on-rails - 工厂女孩参考父母

> ID：11254062
> 
> 赞同：2
> 
> 时间：2012-06-28T22:56:51.293
> 
> 标签：ruby-on-rails, factory-bot

我有一个这样的工厂：

```
FactoryGirl.define do
    factory :subject do
      name 'Calculus'
    end
end 
```

我想提到他的父母是“数学”，父母是空的。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:04:50.020

如果我正确理解了这个问题，您可以指定一个父级作为该`factory`方法的一个选项：

```
FactoryGirl.define do
  factory :subject do
    name 'Subject'
  end

  factory :maths, :parent => :subject do
    name 'Maths'
  end

  factory :calculus, :parent => :maths do
    name 'Calculus'
  end
end 
```

这是一个相当人为的例子，因为子工厂覆盖了继承的`name`属性，但这能回答你的问题吗？

# c++ - 无法使用 Code::Blocks 编译 wxWidgets

> ID：11254065
> 
> 赞同：1
> 
> 时间：2012-06-28T22:57:13.920
> 
> 标签：c++, mingw, wxwidgets, codeblocks, include-path

我无法在 Code::Blocks 中使用 gcc 编译 wxWidgets。我根据 wxWidgets 网站上的文档做了所有事情：

1.  我正确下载了wx
2.  我根据文档指南正确编译
3.  我根据指南在 Code::Blocks 中设置了所有内容

一切都很顺利，直到我在 Code::Blocks 中编写了一个程序并单击了编译按钮。显示大约 30 - 40 个错误，包括：

> wx/wx.h 未找到

和几十个未声明的错误

我从官方网站编译了 hello world 程序。我认为make文件或库中存在问题。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:22:38.857

您需要将下载并构建的 wxWidgets 添加到编译器包含路径。

例如我的 wxWidgets 位于：C:\wxWidgets-2.8.12\

在项目的构建选项中，转到**搜索目录**-选项卡，然后在**编译器**-子选项卡中，您可以在 wxWidgets 位置添加包含目录的搜索路径，在我的示例中为：**C:\wxWidgets-2.8.12 \包括**

# ruby - 对带有 RVM 的 git gem 使用 'bundle install' 时，'gem list' 找不到 Gem

> ID：11254066
> 
> 赞同：4
> 
> 时间：2012-06-28T22:57:32.723
> 
> 标签：ruby, git, gem, rvm, bundler

我目前正在尝试运行“捆绑安装”以使用 Gemfile 安装基于 git 的 gem，因此使用最新版本的 RVM（1.14.3）在没有捆绑器的情况下使用 ruby​​/其他 ruby​​ 命令。

我相信问题的原因是捆绑器正在将 git gem 安装到 .rvm/gems/ruby-1.9.3-p194@something/bundler/gems 中，而所有其他 gem 安装到 .rvm/gems/ruby-1.9 中。 3-p194@something/gems。结果，'bundle list' 会显示 gem 而 'gem list' 不会。

这里有什么想法吗？我真的不想使用 bundle 来执行一切。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T23:05:11.740

Bundler 用于将 gem 与应用程序捆绑在一起。将它用于系统 gem 是没有意义的。不幸的是，非捆绑器 gem 系统没有提供直接安装基于 git 的 gem 的方法（实际上我之前问过一个关于此的问题，请参阅[Is it possible to directly install a gem from a git repository?](https://stackoverflow.com/questions/7815436/is-it-possible-to-directly-install-a-gem-from-a-git-repository)）。相反，您必须分三个步骤手动完成：

1.  克隆 gem 存储库（这是假设一个 github 存储库，但它适用于托管在任何地方的存储库，只需替换正确的 git 存储库位置）。

    ```
    git clone git://github.com/user/gem.git 
    ```

2.  转到克隆的 gem 存储库目录并构建 gem（这还将检查依赖项并在安装因缺少依赖项而失败时发出警告——在这种情况下，只需安装依赖项并重试）。

    ```
    rake gem 
    ```

    或者，如果这不起作用：

    ```
    gem build gem.gemspec 
    ```

3.  这应该创建了一个名称如下的文件`pkg/gem-1.2.3.gem`（有时它会在这样的`pkg`目录中构建，有时它会在 gem repo 根目录中构建）。您现在可以安装它。

    ```
    gem install pkg/gem-1.2.3.gem 
    ```

# java - 如何克隆 libgdx 世界

> ID：11254074
> 
> 赞同：3
> 
> 时间：2012-06-28T22:58:55.440
> 
> 标签：java, libgdx

这似乎更像是一个一般的编程问题，而不是一个游戏开发问题，所以我在这里问它。我需要克隆 libgdx 世界以在特定时间将所有对象的状态存储为备份，然后从那里恢复。所以我的想法很简单，

```
backupWorld = world.clone(); 
```

但是，libgdx 中的 World 类并没有实现 Cloneable。该课程是最终课程，因此我无法扩展它，也无法编辑源代码。我还有什么选择？还有哪些可能的解决方案？

谢谢

# c - 使用指针数组

> ID：11254076
> 
> 赞同：3
> 
> 时间：2012-06-28T22:59:30.453
> 
> 标签：c, arrays

我在这里的第一个问题。我使用的是指针数组而不是二维数组。现在，要显示一个元素，我可以使用 *(arr[i]+j)，其中 arr 是数组 i 表示行，j 表示列。但是，当我尝试使用相同的符号为任何元素分配值时，代码停止工作。我没有收到编译错误，但是当我运行它时它就会停止工作。有人可以帮助我吗？

这是我的代码

```
#include <stdio.h>
#include <conio.h>
#include <string.h>
#include <stdlib.h>

int main(void)
{
    int i,j,k;
    char temp2, temp, *arr[] = {
        "Brinda Roy", 
        "Rakesh Bai", 
        "Neha Saxen", 
        "Ankit Jain"};

    printf("%c",*(arr[3]+8));

    for(i=0;i<4;i++){
        for(j=0, k=9; j<=4, k>=5; j++, k--){
            temp =*(arr[i]+j);
            *(arr[i]+j)=*(arr[i]+k);
            *(arr[i]+k)=temp;
        }

    }

    printf("\nThe array is ");

    for(i=0; i<4; i++){
        printf("\n%s",arr[i]);
    }

    getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T23:14:31.153

运行时崩溃是由于您在`arr`. 字符串文字`"Brinda Roy"`,`"Rakesh Bai"`和应该被视为`"Neha Saxen"`，因为它们可能存储在程序的只读部分中。尝试更改它们的值会导致未定义的行为，如下面的评论中所述。`"Ankit Jain"``const char[]`

如果要编辑这些只读字符串，则需要将它们复制到非`const`缓冲区中。

如果你这样做：

```
char *str = "message" 
```

您不应该修改指向的数据，`str`因为它指向只读内存。

如果你这样做：

```
char str[] = "message" 
```

您*可以*修改指向的数据，`str`因为只读字符串文字`"message"`正在被*复制*到数组`str`中。

您的代码属于上述第一种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T23:15:42.227

C 允许通过此样式在源中定义的字符串存储在只读数据部分中。检查此输出：

```
$ cat storage.c
int main(int argc, char* argv[]) {
    char *arr[] = {"hello", "world"};
    arr[1][1]='a';
    return 0;
}
$ make storage
cc     storage.c   -o storage
$ readelf -p.rodata storage

String dump of section '.rodata':
  [     4]  hello
  [     a]  world 
```

我的编译器已将字符串放入`.rodata`只读数据部分。当我尝试在程序中更新`o`到 an`a`时，程序死了：

```
$ ./storage 
Segmentation fault (core dumped) 
```

这通常适用于将字符串定义如下的任何代码：

```
char *foo = "string"; 
```

如果你想在程序源代码中创建一个可修改的字符串，你可以这样写：

```
char foo[] = "string"; 
```

我不完全确定创建可修改字符串数组的语法是什么；至少以下*丑陋*的方法有效，但我确信有更好的方法：

```
char a1[] = "hello";
char a2[] = "world";
char *arr[] = {a1, a2}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T23:14:31.030

您尝试修改字符串文字。这是禁止的。请注意，即使类型系统（`"abc"`is not `const char*`）不强制执行此操作，修改字符文字`"abc"[1]='c'`也会导致未定义的行为。

您必须将数据移动到可写位置。最简单但非标准的方法是使用以下`strdup`函数：

```
for(i=0; i<4; i++)
  arr[i]=strdup(arr[i]); 
```

这将为字符串在堆上分配内存并将字符串复制到其中。如果您没有该功能，则必须使用,和`strdup`来实现它。`malloc``strlen``memcpy`

请注意，与动态分配的内存一样，您必须释放它；否则，您会遇到内存泄漏。

顺便说一句，访问双指针数组和多维数组的正常方法是`arr[i][j]`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T23:17:17.233

您不能以这种方式修改保留的内存：

```
{"Brinda Roy", 
 "Rakesh Bai", 
 "Neha Saxen", 
 "Ankit Jain"}; 
```

当您以这种方式定义 char* 时，它只是读取内存。

# zend-framework - 如何发送到自定义错误页面 Zend Framework？

> ID：11254078
> 
> 赞同：5
> 
> 时间：2012-06-28T22:59:39.017
> 
> 标签：zend-framework, error-handling

我有可以被阻止的成员，当成员被阻止时，我想将他们发送到自定义错误页面，我将如何在 zend 框架中执行此操作？我试过

```
throw new Zend_Controller_Dispatcher_Exception('Your message here'); 
```

但是当我这样做时，它并没有说“您的消息”，而是说“找不到页面”。

这是我的错误控制器。

```
<?php

class ErrorController extends Zend_Controller_Action
{

public function errorAction()
{
    $errors = $this->_getParam('error_handler');

    switch ($errors->type) {
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ROUTE:
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_CONTROLLER:
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ACTION:

            // 404 error -- controller or action not found
            $this->getResponse()->setHttpResponseCode(404);
            $this->view->message = 'Page not found';
            break;

            // 666 error -- controller or action not found
            $this->getResponse()->setHttpResponseCode(666);
            $this->view->message = 'Blocked';
            break;
        default:
            // application error
            $this->getResponse()->setHttpResponseCode(500);
            $this->view->message = 'Application error';
            break;
    }

    // Log exception, if logger available
    if ($log = $this->getLog()) {
        $log->crit($this->view->message, $errors->exception);
    }

    // conditionally display exceptions
    if ($this->getInvokeArg('displayExceptions') == true) {
        $this->view->exception = $errors->exception;
    }

    $this->view->request   = $errors->request;
}

public function getLog()
{
    $bootstrap = $this->getInvokeArg('bootstrap');
    if (!$bootstrap->hasPluginResource('Log')) {
        return false;
    }
    $log = $bootstrap->getResource('Log');
    return $log;
}

} 
```

这是文档， http: [//framework.zend.com/manual/en/zend.exception.using.html](http://framework.zend.com/manual/en/zend.exception.using.html)我不明白:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T23:14:12.217

这里有一些关于使它工作的建议。

首先，您需要将您的错误与标准`no_route/no_controller/no_action`错误区分开来。为此，您可以抛出自己的自定义异常（您可以从 PHP 的`Exception`类扩展它。

```
throw new My_Exception_Blocked('You are blocked'); 
```

然后，将错误控制器修改为如下所示：

```
public function errorAction()
{
    $errors = $this->_getParam('error_handler');

    switch ($errors->type) {
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ROUTE:
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_CONTROLLER:
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ACTION:

            // 404 error -- controller or action not found
            $this->getResponse()->setHttpResponseCode(404);
            $this->view->message = 'Page not found';
            break;

        // check for any other exception
        case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_OTHER:
            if ($errors->exception instanceof My_Exception_Blocked) {
                $this->getResponse()->setHttpResponseCode(403);
                $this->view->message = $errors->exception->getMessage();
                break;
            }
            // fall through if not of type My_Exception_Blocked

        default:
            // application error
            $this->getResponse()->setHttpResponseCode(500);
            $this->view->message = 'Application error';
            break;
    }
} 
```

我还将响应代码从 更改`666`为 ，`403`因为没有`6xx`HTTP 错误代码，这可能会扰乱服务器和/或客户端。

希望有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-28T23:09:52.687

您不应该使用错误控制器插件来管理程序错误。我建议将用户重定向到一个控制器，他们将在其中看到所需的消息。Zend Framework 中的错误控制器实现过于复杂。您可以通过重定向轻松解决问题。

也不鼓励使用错误控制器来处理程序错误。文档中的详细信息如下。

> Zend_Controller_Plugin_ErrorHandler 提供了一个插件，用于处理应用程序抛出的异常，包括那些因缺少控制器或动作而导致的异常；它是 MVC 异常部分中列出的方法的替代方法。
> 
> 该插件的主要目标是：
> 
> *   没有路由匹配时引发拦截异常
>     
>     
> *   由于缺少控制器或操作方法而引发的拦截异常
>     
>     
> *   拦截动作控制器中引发的异常
>     
>     
> 
> 换句话说，ErrorHandler 插件旨在处理 HTTP 404 类型错误（页面丢失）和 500 类型错误（内部错误）。 **它不打算捕获其他插件中引发的异常。**

# backbone.js - 如何在主干文章中添加调整大小事件？

> ID：11254080
> 
> 赞同：5
> 
> 时间：2012-06-28T23:00:10.117
> 
> 标签：backbone.js, coffeescript, backbone-events

```
events:
    'click textarea': 'composeComment'
    'click .submit': 'submit'
    'blur textarea': 'textareaBlur'
    'resize article': 'repositionBoards'

repositionBoards: ->
    #this is my own function, i just need it to be called everytime an article's size changes
    board.align() 
```

如何`repositionBoards`在调整大小事件时调用我的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T23:32:56.413

事件[`resize`被](http://api.jquery.com/resize/)发送到`window`：

> 当浏览器窗口的大小发生变化时，该`resize`事件被发送到元素`window`

但是 Backbone 视图的事件绑定到视图的`el`using [`delegate`](http://api.jquery.com/delegate/)。视图`el`不会收到`resize`事件，因此放入`'resize articule': 'repositionBoards'`您的视图`events`不会有任何好处。

如果您需要`resize`在视图中获取事件，则必须将其绑定到`window`自己：

```
initialize: (options) ->
    $(window).on('resize', this.repositionBoards)
remove: ->
    $(window).off('resize', this.repositionBoards) # Clean up after yourself.
    @$el.remove() # The default implementation does this.
    @
repositionBoards: ->
    # Use => if you need to worry about what `@` is
    board.align() 
```

还要注意添加 a[`remove`](http://documentcloud.github.com/backbone/#View-remove)以便您可以取消绑定`resize`处理程序。当然，如果该视图是您的整个应用程序，您当然会想要`view.remove()`删除您的视图，或者只是不要担心它。

# java - 为什么我在这里收到未经检查的警告？

> ID：11254082
> 
> 赞同：1
> 
> 时间：2012-06-28T23:00:26.053
> 
> 标签：java, generics

数据集扩展了 ArrayList。

```
Dataset<Pair<SRGB>> data = new Dataset<Pair<SRGB>>();
Statement stmt = this.conn.createStatement();
ResultSet rs = stmt.executeQuery(sql);
while (rs.next()) {
    data.add(new Pair<SRGB>(SRGB.create(rs.getString(2)),
                            SRGB.create(rs.getString(3)),
                            rs.getDouble(1),
                            rs.getInt(4)));
}
warning: [unchecked] unchecked call to add(E) as a member of the raw type java.util.ArrayList 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T23:10:54.573

您可能已经声明您的类可以在没有任何泛型类型的情况下`Dataset`进行扩展。`ArrayList`

确保您的课程像这样`Dataset`扩展：`ArrayList`

```
class Dataset<T> extends ArrayList<T> {
    // ...
} 
```

而**不是**

```
class Dataset<T> extends ArrayList {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-28T23:04:11.377

也许[这个](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)文档会帮助你

我知道这不是您的问题，但您知道您可以使用注释来抑制这些警告：

```
@SuppressWarnings("unchecked") 
```

# android - Phonegap、Sencha Touch2 和 Pusher - Android 上的 Flash 后备失败

> ID：11254086
> 
> 赞同：0
> 
> 时间：2012-06-28T23:01:12.413
> 
> 标签：android, flash, cordova, sencha-touch-2, pusher

我有一个用户推送的小应用程序，它是用 Sencha Touch 2 构建的，包装在 phonegap (cordova 1.7.0) 中并为 android 打包。Pusher 具有非 websocket 支持的闪存后备。

根据[http://pusher.tenderapp.com/kb/faq/does-pusher-work-with-phonegap-yes](http://pusher.tenderapp.com/kb/faq/does-pusher-work-with-phonegap-yes) 我将此添加到我的 .java 文件中：

```
super.init();
this.appView.getSettings().setPluginsEnabled(true); 
```

它似乎正在尝试加载闪存，但在我的设备上运行时，我在 logcat 中看到了这一点：

06-28 16:41:53.559：D/CordovaLog(16269)：警告：web-socket-js 在 file:///... URL 中不起作用，除非您正确设置 Flash 安全设置。通过 Web 服务器打开页面，即 http://...

06-28 16:41:53.559：D/CordovaLog(16269)：[https](https://yadayada.cloudfront.net/1.11.2/flashfallback.min.js) ://yadayada.cloudfront.net/1.11.2/flashfallback.min.js：第 52 行：警告：web-socket-js 不起作用在 file:///... URL 中，除非您正确设置 Flash 安全设置。通过 Web 服务器打开页面，即 http://...

感觉就像我很接近，但我错过了最后一点来连接它。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T11:22:57.497

现在有一个启动项目可以帮助解决这个问题。这意味着不需要 Flash 回退，而是使用本机 Java WebSocket 库并将其公开给 WebView 中的 JavaScript 运行时。

这是一篇关于它的博客文章：http: [//blog.pusher.com/2012/7/5/pusher-on-phonegap-for-android](http://blog.pusher.com/2012/7/5/pusher-on-phonegap-for-android)

这是启动器 Pusher、PhoneGap 和 Android 项目： [https ://github.com/pusher/pusher-phonegap-android](https://github.com/pusher/pusher-phonegap-android)

# cakephp - 指定 HTML5 输入元素的起始偏移量

> ID：11254087
> 
> 赞同：0
> 
> 时间：2012-06-28T23:01:22.003
> 
> 标签：cakephp

```
<input name='data[User][images][]' id='images' type='file' multiple="" /> 
```

我知道上述方法有效并允许在 html5 中上传多个文件，但我想从非零的某个偏移量开始 data[User][images][] 数组。我已经尝试过：

```
<input name='data[User][images][2]' id='images' type='file' multiple="" /> 
```

但这只是使得只有 1 个文件的信息存储在要上传的偏移量 2 中。

我知道如何处理我的代码，所以我不需要这样做，但现在我只是好奇是否有办法保持多个文件上传，同时告诉它从非零偏移量开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:19:37.797

这实际上不是 HTML 的特性，而是服务器端语言或框架的特性。HTML 提供的唯一“支持”是元素名称可以包含方括号。

看起来 CakePHP 不支持表单提交数组的任何特殊行为（尽管我对它不是很熟悉）。您最好的选择可能是[PHP 手册页](http://us2.php.net/manual/en/faq.html.php#faq.html.arrays)，其中没有提到从零以外的偏移量开始的任何内容。

# jquery - KeyUp/KeyDown keyCode 不适用于 IE 中的密码字段？

> ID：11254092
> 
> 赞同：2
> 
> 时间：2012-06-28T23:02:18.200
> 
> 标签：jquery, asp.net, internet-explorer

我有一个简单的表格

```
<asp:TextBox ID="txtUsername" runat="server" CssClass="watermarkOn" TabIndex="1" />
<asp:TextBox ID="txtPassword" runat="server" TextMode="Password" CssClass="watermarkOn" TabIndex="2" />
<asp:LinkButton ID="btnLogin" runat="server" CssClass="imgbtn_login" TabIndex="3" Text="login" onclick="btnLogin_Click" CausesValidation="false" /> 
```

使用以下 jQuery

```
$(document).ready(function () {
    $("#<%=txtUsername.ClientID %>").keydown(function (event) {
        if (event.keyCode == 13) {
            eval($("#<%=btnLogin.ClientID %>").attr('href'));
        }
    });
    $("#<%=txtPassword.ClientID %>").keydown(function (event) {

        if (event.keyCode == 13)
        {
            eval($("#<%=btnLogin.ClientID %>").attr('href'));
        }
    });
}); 
```

这在 FF、IE7、IE 9、Chrome、Safari 中运行得非常好……除了一个例外。某些 IE8 安装它适用于用户名框，但不适用于密码框。有谁知道为什么会这样。我没有看到有关密码框行为差异的任何文档。

**更新**

我也尝试过 keyup 和 event.which，它们都不起作用。用户名框工作正常，但密码框不会像应有的那样触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T10:00:56.273

在 IE 中，直接在密码字段上附加按键处理程序对我也不起作用，但您可以将其附加到其父级：

```
<script type="text/javascript">
$("#loginForm").keypress(function(e) {
    if (e.keyCode == $.ui.keyCode.ENTER) {
        // do your thing :)
    }
});
</script>

<form id="loginForm" action="...">
  <input type="text" id="username" value="" />
  <input type="password" id="password" />
  ...
</form> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T23:04:39.427

如果您使用 jQuery（您是 :)）尝试（而不是 keyCode）使用`which`：

> jQuery 规范 event.which，具体取决于浏览器是否支持 event.which、event.keyCode 或 event.charCode：

```
if (event.which == 13) { 
```

在这里您可以找到更多信息：[http](http://unixpapa.com/js/key.html) ://unixpapa.com/js/key.html （查看：**3\. 识别密钥**）

# c# - ASP.NET 自定义验证器 + WebMethod + jQuery + .Net 4 + 不起作用

> ID：11254095
> 
> 赞同：0
> 
> 时间：2012-06-28T23:02:41.770
> 
> 标签：c#, jquery, asp.net, ajax, customvalidator

我的情况是这样的线程：
[ASP.NET 自定义验证器 + WebMethod + jQuery](https://stackoverflow.com/questions/3982420/asp-net-custom-validator-webmethod-jquery)
我的 aspx 代码：

```
<telerik:RadScriptManager ID="RadScriptManager1" runat="server" EnablePageMethods="True">
<asp:TextBox ID="TextBox" runat="server" Width="170px" ValidationGroup="A" CssClass="txt"
            TextMode="Password"></asp:TextBox>
 <asp:CustomValidator ID="cvPass" runat="server" Display="Dynamic" ControlToValidate="TextBox"
            ValidationGroup="A" ClientValidationFunction="CheckPass">
            invalid
</asp:CustomValidator> 
```

jQuery：

```
 function CheckPass(source, args) {
        alert('asd');
        $.ajax({
            type: "POST",
            async: false,
            timeout: 500,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            url: "Default.aspx/CheckPassword",
            data: '{"Value":"' + args.Value + '"}',
            success: function (result) {
                alert('a');
                args.IsValid = result.d;
            }
        });
    } 
```

后面的代码（c#）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Telerik.Web.UI;
using System.Web.Services;
using System.Web.Script.Services;
using System.Data;
using System.Text;
using System.Net.Mail;

namespace Nasim
{
    public partial class Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
        }

        [WebMethod]
        [ScriptMethod]
        public static bool CheckPassword(string pass)
        {
             return false;
        }
    }
} 
```

如您所见，我想在 ajax 模式下使用自定义验证器检查密码（使用 jquery）。
但我不知道为什么 $.ajax 根本不适合我。
没有错误，没有任何反应，并且总是有回发。
我应该添加除 jquery 之外的特定库吗？
我正在使用 Visual Studio 2010 + .Net 4。
有什么问题，我该如何解决？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T23:40:15.763

从您展示的代码来看，它应该可以工作，但您的代码的其他一些区域可能会导致您的问题。

我会调查的一些领域：

*   您正在为您的文本框和自定义验证器使用验证组。触发回发的控件是否还包含 ValidationGroup="A" 属性？
*   调用 Web 方法时，您将`'{"Value":"' + args.Value + '"}',`作为数据传递给方法调用。我认为您需要更改`"Value"`为`"pass"`以匹配 Web 方法参数名称。
*   我对 Telerik 控件的使用并不多。也许`RadScriptManager`正在以某种方式拦截事件？

我建议您创建一个页面版本，该版本只使用最少的代码来证明您尝试做的事情是否有效：一个简单的页面，带有文本框控件、自定义验证器、jQuery 代码和后面代码中的web方法。

希望这将帮助您发现任何问题。

# javascript - 如何使用 jasmine-node 配置 RequireJS (require.config())？

> ID：11254098
> 
> 赞同：3
> 
> 时间：2012-06-28T23:03:05.890
> 
> 标签：javascript, node.js, coffeescript, requirejs, jasmine

我有一个 init 文件，它提供了一个通过`require.config()`. 配置最终看起来（大部分）是这样的：

```
...

config =
    baseUrl: sysDir + 'lib/'
    paths:
        app: appDir + 'lib/'
        dep: sysDir + 'vendor/'
    deps: [
        'dep/underscore/underscore.min'
        'dep/jquery/jquery.min'
    ]

require.config config 
```

该文件在浏览器中使用，我也想在节点中使用它。我试图在助手中做同样的事情，但我没有太多运气。由于规范在新的 VM 上下文中运行的方式，我不太确定该怎么做，也没有明显的方法可以将 jasmine-node 传递给您的 RequireJS 配置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:44:07.657

我通过将 require 配置放入我的 specs 目录根目录下的 spec_helper.js 中来完成这项工作：

```
define = require('requirejs');

(function () {
    var baseUrl = __dirname + '/../smoke'
    console.log('Configuring requirejs with baseurl: ' + baseUrl)

    define.config({
        'nodeRequire': global.require,
        'baseUrl': baseUrl
    });
})(); 
```

不确定这是否真的能解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-21T09:46:53.670

jasmine-node 提供了 requirejs 的示例项目：[https ://github.com/mhevery/jasmine-node#requirejs](https://github.com/mhevery/jasmine-node#requirejs)

如果你调用你的测试`> jasmine-node --runWithRequireJs --requireJsSetup tests/requirejs-setup.js tests`，你可以在 requirejs-setup - 文件中添加你的配置设置。

不过，我对 baseUrl 设置有疑问。在 requirejs-wrapper-template.js 中，baseUrl 是相对于当前执行的测试文件进行操作和设置的，您可以在此处看到：

```
if(alteredConfig.baseUrl){
    var base = baseUrl.replace(/\\/g, '/'),
        splitUrl = alteredConfig.baseUrl.replace(/\\/g, '/').split('/'),
        index = 0;

    for(; index < splitUrl.length; index++){
        if(splitUrl[index] === '..') {
            base = path.dirname(base);
        } else {
            base += '/' + splitUrl[index];
        }
    }

    alteredConfig.baseUrl = base;
} 
```

这会导致我的 requirejs 配置中定义的路径出现问题。所以我只是注释掉了这个代码块。现在它对我来说效果很好。

# java - 在java中重用类型参数的值

> ID：11254103
> 
> 赞同：4
> 
> 时间：2012-06-28T23:04:11.380
> 
> 标签：java, generics, annotations

我刚刚看到有人在对丑陋代码的咆哮中发布了以下内容：

```
public static 
    Tuple<ArrayList<ArrayList<ArrayList<String>>>, 
          ArrayList<ArrayList<ArrayList<String>>>>     
    split(
          ArrayList<ArrayList<ArrayList<String>>> data, [..]); 
```

（我的布局，为了让这个半可读的可笑尝试）

我一直在寻找一种方法来使它看起来有点像这样（非功能性）代码：

```
TypeParam T = ArrayList<ArrayList<ArrayList<String>>>;
public static Tuple<T,T> split( T data, [..]); 
```

到目前为止，我找到的最佳解决方案是定义一个类（在这个例子中是一个类`Data`），它 extends `ArrayList<ArrayList<ArrayList<String>>>`，这将使代码看起来像这样：

```
public static Tuple<Data, Data> split( Data data, [..]); 
```

虽然这种方法非常令人满意，但我不想放弃使用我缺少的某种泛型的可能性，我想知道 Java 是否有一种更美观的方法来做到这一点令人愉快的方式。

我正在使用的另一个解决方案是使用注释处理器为我解决这个问题，但是我觉得这错过了一定程度的简单性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T23:12:27.150

怎么样

```
 public static <T extends ArrayList<ArrayList<String>>> Tuple<T,T> 
      split(T data); 
```

但我同意@esej 的观点，即您可能需要某个类来封装 list-of-lists-of-lists-of-strings 数据结构。

我也不确定您是否应该`ArrayList`在那里进行硬编码（而不是使用 interface `List`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:19:47.190

您可以执行以下操作：

```
public static <T extends List<List<List<String>>>>  Tuple<T, T> split(T data) {

} 
```

不会使它看起来更好IMO。

# javascript - Magento 1.7 下订单时出现 PayPal 错误“未定义 OrderReviewController”

> ID：11254105
> 
> 赞同：1
> 
> 时间：2012-06-28T23:04:12.453
> 
> 标签：javascript, magento, paypal

我收到此错误：

```
"OrderReviewController is not defined" 
```

尝试通过 Magento 1.7.0 使用贝宝结帐。

这是我在控制台中遇到的错误，如果您需要更多详细信息，请询问。

这是在 Magento 页面上：[https ://domain.com/magento-isntall/paypal/express/review/](https://domain.com/magento-isntall/paypal/express/review/)

感谢任何事情，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-26T07:22:45.707

*   Check if some Magento Extension adding JS through front-end layout xml.
*   Then Overwrite them by putting them in your theme folder (your_theme/layout).
*   Put those JS inside pages in which they are actually required.
*   If those JS are coming on checkout page then encapsulate them into there scope.

    Like for jQuery it could be:

    ```
     jQuery(function($){
                      //jQuery Code
                     }); 
    ```

    It will make a scope for prototype (Magento JS framework) and jQuery.

# yii - Yii - 如何覆盖/扩展核心文件

> ID：11254106
> 
> 赞同：1
> 
> 时间：2012-06-28T23:04:21.917
> 
> 标签：yii, overriding

我需要覆盖一些 yii 核心文件——特别是 CGridColumn.php 和 CController.php。我需要确保在我的应用程序中引用这些类，而不是它们覆盖或扩展的核心文件。我该怎么做呢？它必须非常简单，但我似乎找不到记录在案的“正确”方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T05:03:57.350

如果要扩展基本控制器：

1.  在受保护的/组件目录中创建 Controller.php：

    ```
    class Controller extends CController
        {
        public $newProperty;

        public function newMethod()
        {
        ...
        }
    } 
    ```

2.  确保在配置中导入 Controller.php：

    ```
    'import' => array(
        ...
        'application.components.Controller',
        ...
    ), 
    ```

3.  从 Controller 扩展您的控制器，而不是 CController：

    ```
    class ExampleController extends Controller {
        ...
    } 
    ```

如果你想扩展 CGridColumn，1 和 2 步骤是相同的​​，但是在你的自定义类中不要忘记导入原始类：

```
 Yii::import('zii.widgets.grid.CGridColumn');

    class TestColumn extends CGridColumn
    {
        ...
    } 
```

然后在 CGridView 的 columns 数组中使用它

```
 'columns' => array(
        array(
            'class' => 'TestColumn',
        ),  
    ), 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T09:33:33.943

**扩展通用类以允许更好的定制**

> [http://www.yiiframework.com/wiki/121/extending-common-classes-to-allow-better-customization/](http://www.yiiframework.com/wiki/121/extending-common-classes-to-allow-better-customization/)

# testflight - 使用 TestFlight 在现场添加 UDID

> ID：11254108
> 
> 赞同：4
> 
> 时间：2012-06-28T23:04:44.693
> 
> 标签：testflight

我使用**TestFlight** ([链接](http://testflightapp.com)) 来传递 .ipa 文件。我的问题是 - 如何将我的 UDID 添加到我的团队？目前，当我转到“**人员”**并打开“**用户详细信息**”时，UDID 字段为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:49:36.637

如果您需要添加设备，请使用以下链接：

[TestFlight 添加 UDID](http://help.testflightapp.com/customer/portal/articles/829600-how-do-i-connect-my-device-to-my-account-)

# ruby-on-rails - Capistrano 在尝试连接到远程数据库时失败，说：rvm-shell no such file or directory

> ID：11254112
> 
> 赞同：0
> 
> 时间：2012-06-28T23:05:14.627
> 
> 标签：ruby-on-rails, rvm, capistrano

我有一个在 Rails 3 应用程序中使用远程数据库的 capistrano 配方。这是食谱的一部分：

```
role :web, "ip1"
role :app, "ip1"
role :db,  "ip2"

set :rvm_type, :system
set :rvm_ruby_string, '1.9.3'

set :deploy_to, "/apps/gits/#{application}"
set :deploy_via, :remote_cache
set :deploy_env, 'production' 
```

Capistrano 给了我这个错误：`usr/local/rvm/bin/rvm-shell: No such file or directory`

但是，如果我注释掉数据库服务器（没有 rvm）并让 rails 认为 db 在 Web 服务器上（有 rvm），一切正常。

我假设因为 :rvm_type 设置为系统 capistrano 正在系统上寻找它，但它为什么要寻找它呢？有没有办法解决 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:04:18.737

rvm-capistrano 还不支持它，您必须`set :default_shell`按服务器。

已经有此功能的门票[https://github.com/wayneeseguin/rvm-capistrano/issues/11](https://github.com/wayneeseguin/rvm-capistrano/issues/11)

# flash - 有没有办法让 Flash 接受 RTMPS NetConnections 的自签名证书？

> ID：11254116
> 
> 赞同：4
> 
> 时间：2012-06-28T23:05:55.810
> 
> 标签：flash, flash-media-server

我有一个验证得很好的自签名证书。当我在客户端机器上安装根证书时，使用自签名证书服务的站点工作得很好。

但是，当我在 FMS 4.5 中安装它并尝试通过 Flash 连接到它时（在我的例子中，11.2 调试播放器在 Firefox 的 Windows 7 上运行），它返回一个`NetConnection.Connect.CertificateUntrustedSigner`错误。它还会弹出一个 Windows 提示，警告证书颁发者不受信任或未知，尽管似乎无论我如何响应提示，它都没有任何效果。

我的怀疑是 Flash 无视操作系统已安装的根证书并维护自己的列表。是这样吗？如果是这样，在这种情况下有没有办法使用自签名证书？

# c# - C#如何遍历表行并仅将某些字段名称和值添加到SortedList

> ID：11254118
> 
> 赞同：0
> 
> 时间：2012-06-28T23:06:01.063
> 
> 标签：c#

我有一张这样的桌子......

```
FACILTY_NAME    FACILITYID  FIELDID MUSYM   MUKEY   SlopeMidPoint   MLRA_ID Shape_Area  MLRASYM FIPS_C
JMB Feeders 3557    18894   1839    1698712 6   22  34578.52926120000   72  08 56 20 31
JMB Feeders 3557    18894   1815    1698708 0   22  315937.13060200000  72  9 56 20 31
JMB Feeders 3557    18894   1650    1698692 0   22  232183.66600100000  72  10 56 20 31
JMB Feeders 3557    18894   5101    1698651 2   22  530405.24224000000  72  11 56 20 31
JMB Feeders 3557    18894   1506    1698655 6   22  94914.03552020000   72  12 56 20 31
JMB Feeders 3557    18894   1816    1698709 2   22  1036.37023796000    72  13 56 20 31
JMB Feeders 3557    18894   5100    1698650 0   22  532206.08141000000  72  14 56 20 31
JMB Feeders 3557    18894   1736    1698707 6   22  7.45379122495   72  15 56 20 31 
```

我只需要从每一行（、、和）中获取某些字段`Shape_Area`/`SlopeMidPoint`值`MUKEY`。我的问题是：如何将这些字段值中的每一个添加到 a 中`SortedList`？我看过这个`SortedList`类，在我看来你只能有两个元素（键、值）。如何存储三个元素？或者，我应该看另一个像`List`or的类`ArrayList`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:22:35.270

你需要使用一个`SortedList`吗？正如您所提到的，这将为您提供一个键/值对。您可以只生成一个映射到您的数据结构的类。

```
class Facility
{
    public string Name { get; set; }
    public int Id { get; set; }
    public int FieldId { get; set; }
    //etc, etc
} 
```

然后，在读取数据时，无论是来自数据库还是平面文件，您都可以简单地创建一个`Facility`为数据集中的每一行创建一个对象，并将它们添加到常规`List<Facility>`.

```
List<Facility> facilities = new List<Facility>();

Facility facility = new Facility() { Name = "Foo", Id = 1 /* etc */ };
facilities.Add(facility); 
```

然后，您可以使用 LINQ 获取值：

```
var results = yourList.Where(s => s.Id == 3557); 
```

或数据结构上的任何其他属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:34:25.943

```
class SomeClass
{
  string shape_Area {get; set;} 
  string SlopeMidPoint {get; set;}
  string MUKEY  {get; set;}
} 
```

SortedList.Add 方法将键和值作为对象，所以现在您可以添加 SomeClass 作为值

像这样：

```
sortedList.Add(someClass.MUKEY, someClass); 
```

这样你会得到一个按 MUKEY 排序的列表

希望这可以帮助...

# sql - Oracle SQL：如何在没有数据的情况下显示空周/周？

> ID：11254121
> 
> 赞同：3
> 
> 时间：2012-06-28T23:06:25.900
> 
> 标签：sql, oracle, date, group-by

与[此问题](https://stackoverflow.com/questions/4805560/group-by-week-how-to-get-empty-weeks)类似，但我的数据集有一个包含许多 ID 的附加列。每个 ID 都有一个按固定时间范围追溯的数据集，并且某些周可能缺少数据 - 我想填写缺失周的值。

例如，我想要这个：

```
ID      WEEKEND_DAY     VALUE
A00     2012-01-01      1
A00     2012-01-08      7
B00     2012-01-08      4
B00     2012-01-15      3 
```

扩展至此：

```
ID      WEEKEND_DAY     VALUE
A00     2012-01-01      1
A00     2012-01-08      7
A00     2012-01-15      0
B00     2012-01-01      0
B00     2012-01-08      4
B00     2012-01-15      3 
```

我已经有一个已知的 WEEKEND_DAY 范围（在上述情况下，每周从 2012 年 1 月 1 日到 2012 年 1 月 15 日）我想填写。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T05:47:42.757

使用[分区外连接](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#i2196190)：

```
select data.id, weeks.weekend_day, nvl(value, 0) value
from
(
    select date '2012-01-01' weekend_day from dual union all
    select date '2012-01-08' weekend_day from dual union all
    select date '2012-01-15' weekend_day from dual
) weeks
left join
(
    select 'A00' id, date '2012-01-01' weekend_day, 1 value from dual union all
    select 'A00' id, date '2012-01-08' weekend_day, 7 value from dual union all
    select 'B00' id, date '2012-01-08' weekend_day, 4 value from dual union all
    select 'B00' id, date '2012-01-15' weekend_day, 3 value from dual
) data
    partition by (data.id)
    on weeks.weekend_day = data.weekend_day 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T03:53:19.993

假设您只需要每个`ID`可能的一周都在场，这非常简单。

首先，如果您还没有“日历表”，我建议您使用。这应该包括一周的“结束”列（或至少，您想要选择的星期几）。这当然可以使用递归 CTE 动态生成，但无论如何，永久的都是有用的。

鉴于您的原始表格：

```
WITH id_by_date (id, weekend) as (
                 SELECT a.id, b.actualDate
                 FROM (SELECT DISTINCT id
                       FROM original) a  -- or use a table that only has ids
                 CROSS JOIN (SELECT actualDate
                             FROM calendar
                             WHERE isWeekend = '1') b) -- or dayOfWeek = 7
SELECT a.id, a.weekend, COALESCE(b.value, 0)
FROM id_by_date a
LEFT JOIN original b
ON b.id = a.id
AND b.weekend_day = a.weekend
ORDER BY a.id, a.weekend 
```

# php - 通过表单和唯一代码重置密码

> ID：11254122
> 
> 赞同：2
> 
> 时间：2012-06-28T23:06:27.383
> 
> 标签：php, mysql, passwords

我有一个允许管理员重置密码的小型应用程序。我目前拥有它，以便管理员输入他们的电子邮件地址并生成一个随机密钥并将其通过电子邮件发送给他们。随机密钥也为用户存储在数据库中。该电子邮件还包含一个表单链接，用户可以在该表单中输入用户名和发送给他们的代码来重置密码。

以下是重置密码表格：

```
<h1>Reset Your Password</h1>

<form id="reset" name="reset" method="post" action="reset-admin-password-exec.php">
<table width="365" height="147" border="0" cellpadding="0" cellspacing="5">
  <tr>
    <td width="144">Username: </td>
    <td><input name="username" type="text" class="textfield" id="username" /></td>
  </tr>
  <tr>
    <td>Code: </td>
    <td><input name="code" type="text" class="textfield" id="code" /></td>
  </tr>
  <tr>
    <td>New Password: </td>
    <td><input name="password" type="password" class="textfield" id="code" /></td>
  </tr>
  <tr>
    <td>Confirm Password: </td>
    <td><input name="cpassword" type="password" class="textfield" id="cpassword" /></td>
  </tr>
  <tr>
    <td><input type="submit" name="Submit" value="Reset" /></td>    
  </tr>
</table>
</form> 
```

这是处理代码的 reset-admin-password-exec.php 文件：

```
<?
    //Array to store validation errors
    $errmsg_arr = array();

    //Validation error flag
    $errflag = false;

    //Function to sanitize values received from the form. Prevents SQL injection
    function clean($str) {
        $str = @trim($str);
        if(get_magic_quotes_gpc()) {
            $str = stripslashes($str);
        }
        return mysql_real_escape_string($str);
    }

    //check for validation errors
    if (isset ($_POST['username']) && !empty ($_POST['username'])) {
    $username = clean($_POST['username']);
    } else {
        $errmsg_arr[] = 'username do not match';
        $errflag = true;
    }

    if (isset ($_POST['code']) && !empty ($_POST['code'])) {
    $code = clean($_POST['code']);
    } else {
        $errmsg_arr[] = 'code do not match';
        $errflag = true;
    }

    if (isset ($_POST['password']) && !empty ($_POST['password'])) {
    $password = clean($_POST['password']);
    } else {
        $errmsg_arr[] = 'first do not match';
        $errflag = true;
    }

    if (isset ($_POST['cpassword']) && !empty ($_POST['cpassword'])) {
    $cpassword = clean($_POST['cpassword']);
    } else {
        $errmsg_arr[] = 'second do not match';
        $errflag = true;
    }

    //Check that both password match
    if( strcmp($password, $cpassword) != 0 ) {
        $errmsg_arr[] = 'Passwords do not match';
        $errflag = true;    
    }

    //encrypt the password
    $salt1 = md5($username);
    $salt2 = md5(DB_PASSWORD);
    $password = sha1($salt1.$password.$salt2);

    //if there are input validations redirect back to main page
    if($errflag) {
        $_SESSION['ERRMSG_ARR'] = $errmsg_arr;
        session_write_close();
        header("location: reset-admin-password-form.php");
        exit();
    }

    $qry = "        UPDATE  admins
                    SET password    =   '$password'
                    WHERE   randkey     =   '$code'
                                    AND     username        =       '$username'";

    $result = mysql_query($qry);

    if($result) {
        echo $result;
        //header("location: reset-admin-password-success.php");
        exit();
    }else {
        die(mysql_error());

    }

?> 
```

我的所有验证都有效，如果任何字段为空或密码不匹配，它将重定向。但是，如果该字段与我表中的`code`字段不匹配，查询仍然有效。`randkey`我已经尝试将`randkeys`作为字段放置以确保它失败，它确实如此。

当我回显时，`$qry`我得到了这个：`UPDATE admins SET password = 'b978ac7c458d65ca31c02eb4e7dabd9aa6a8e235' WHERE randkey = 'CHLVQ6vfq' AND username = 'user.name'`

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:16:11.470

您确定查询确实有效吗？它可能没有输出任何错误，但这并不意味着它实际上正在更新任何行。

利用[`mysql_affected_rows`](http://www.php.net/manual/en/function.mysql-affected-rows.php); 此函数将告诉您是否实际更新了任何行（即`WHERE`子句是否匹配）

您应该将代码的最后一部分更改为：

```
$rows = mysql_affected_rows();
if( $rows == 1 ) {
    header("location: reset-admin-password-success.php");
    exit();
}
else {
    if( $rows == 0 ) {
        $_SESSION['ERRMSG_ARR'] = array('Your username and code do not match');
    } else {
        $_SESSION['ERRMSG_ARR'] = array('Unknown error');
    }
    session_write_close();
    header("location: reset-admin-password-form.php");
    exit();
} 
```

# jquery - jQuery AJAX 发布收到 405 错误（HTTP 动词 POST 不允许）

> ID：11254123
> 
> 赞同：11
> 
> 时间：2012-06-28T23:06:35.760
> 
> 标签：jquery, asp.net, ajax, rsa

我在 ASP.NET webmethod 上有以下 jQuery 帖子：

```
$.ajax({
    type: "POST",
    url: "AjaxWebMethods.aspx/UpdNote",
    contentType: "application/json; charset=utf-8",
    data: "{'ID' : '" + id + "', 'note' : '" + note + "' }",
    dataType: "json",
    success: UpdNote_Success,
    error: AjaxError
}); 
```

并声明了 web 方法：

```
[System.Web.Services.WebMethod(enableSession: true)]
public static int UpdNote(int ID, string note) {
    // business logic that eventually returns a number, but simplifying
    // ... for the sake of brevity
    int retNum = 99;

    return retNum;
} 
```

jQuery post 和 web 方法都在 Windows Authenticated 环境中工作得很好（即 ​​- 用户通过 LDAP 进行身份验证）。但是，我最近不得不将网站移动到使用 RSA（双因素身份验证、pin 和令牌代码）对用户进行身份验证的服务器上，以便访问该网站。我现在看到的是我所有的 jQuery 帖子都返回“405 错误”。

显然，跨站点请求浮现在脑海，但这里没有发生。所有 jQuery AJAX 帖子都使用在 AjaxWebMethods.aspx 中声明的 Web 方法，该页面位于站点自己的域中。

提前感谢您的任何帮助或建议！

**编辑：**

在 IE8 中使用 Fiddler 为我提供了更多信息。它返回的错误代码仍然是 405，但服务器错误更具描述性。服务器错误是“不允许使用用于访问路径 '/AjaxWebMethods.aspx/UpdNote' 的 HTTP 动词 POST。”

我确实尝试将 ajax 请求的类型参数更改为 GET，但我得到了 404（找不到资源）。

另外，忘了提到这是通过 SSL 的（尽管我不希望这会有所作为）。

**编辑：**

经过广泛的测试（以及来自 stackoverflow 的精明成员的广泛帮助），我确定 405 错误与网站正在使用的应用程序池直接相关，更具体地说，与为应用程序池选择的托管管道模式有关。

如果我使用针对 v4.0（.NET 框架）和集成（托管管道模式）的应用程序池，那么我的 AJAX 帖子就可以正常工作。但是，如果我使用针对 v4.0 和 Classic（托管管道模式）的应用程序池，则会收到 405 错误。

所以在这一点上，我仍在寻找这个问题的解决方案，尽管我已经能够解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T22:09:42.770

基于此：

> jQuery post 和 web 方法都在 Windows Authenticated 环境中工作得很好（即 ​​- 用户通过 LDAP 进行身份验证）。但是，我最近不得不将网站移动到使用 RSA（双因素身份验证、pin 和令牌代码）对用户进行身份验证的服务器上，以便访问该网站。我现在看到的是我所有的 jQuery 帖子都返回“405 错误”。

很明显，该错误与服务器配置有关，但要完全确定，如果可以，请*在 RSA 服务器中*创建一个新站点并为此站点禁用 RSA 身份验证，请尝试浏览您的站点以绝对确定该错误仅与 RSA 身份验证有关，丢弃新服务器中缺少的与代码相关的组件/配置

一旦你放弃了与代码相关的配置问题，我会鼓励你仔细检查你的 RSA 配置（这可能很棘手）。曾经我在一个项目中使用 RSA 安全性来实现跨服务器的 SSO。（单点登录），我记得**在服务器级别安装了一个 RSA ISAPI 过滤器**，该过滤器负责读取/设置身份验证 cookie，以便针对 Active Directory 服务器对每个请求进行身份验证。

由于每个请求都由此过滤器管理，并且此 ISAPI 过滤器位于管道的顶部，因此每个请求都必须首先由 RSA ISAPI 过滤器处理才能进行身份验证

所以我的建议是仔细检查 RSA 配置，以检测是否有东西阻止了你的 AJAX 帖子

我记得 RSA 配置就像一个黑魔法盒，我们没有足够的文档，配置它是一个 PITA。我真诚地希望您的组织不是这种情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T20:09:53.403

405 HTTP 代码是“不允许的方法”代码。因此，您的新架构中有一些不正确的设置。这肯定是服务器配置错误。此错误可能源于许多地方，如果无法访问您的服务器，其他人将很难告诉您发生了什么。但也许我可以给你一些起点......

你有仔细检查过你的`web.config`吗？这将是此类错误的常见来源。

你检查过你的 IIS 日志吗？这也是一个非常好的起点。

如果您尝试 POST 而不设置请求的 contentType 会发生什么？也许您的页面未设置为接收 JSON 请求。

您是否尝试过使用[提琴手](http://fiddler2.com/fiddler2/)？尝试从外部客户端发送 POST 请求。

**更新**

还有一些建议：

您是否尝试过禁用 SSL？我会禁用它只是为了确保问题与 SSL 无关。

你在做任何 URL 重写吗？如果是这样，这肯定是相关的。

您可以成功发布到任何 URL 吗？也许 IIS 完全禁用了 POST。如果是这样，[这里有一篇文章](http://www.somacon.com/p126.php)可以帮助您启用它，[这里还有一个](https://stackoverflow.com/questions/3472429/how-do-i-configure-iis-to-accept-post-requests)可能有帮助的线程。

您是否尝试将 HttpPost 添加到您的`web.config`? 像这样的东西：

```
<webServices>
   <protocols>
      <add name="HttpPost" />
   </protocols>
</webServices> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:09:11.983

出于故障排除的目的，请尝试将 AJAX“POST”更改为 AJAX“GET”。在将具有 ajax post 方法的页面从我们的开发环境移动到我们的生产环境后，我遇到了稍微类似的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T20:01:57.467

HTTP`405`是服务器错误，而不是代码错误，表示资源（URL）被错误的方法访问。尝试使用 GET 而不是 POST。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T20:19:12.773

也许您的服务器没有安装 ajax 扩展。尝试标记对`CopyLoacal = true`bin 文件夹的引用并将其部署到 Web 服务器。

# php - 以编程方式发布到 facebook 页面流

> ID：11254125
> 
> 赞同：0
> 
> 时间：2012-06-28T23:06:56.357
> 
> 标签：php, facebook, api

我的 facebook 用户是几个 facebook 页面的管理员。我要做的是自动从外部 php 网站发布到这些页面之一的提要。例如，当网站上发生有趣的事情时，向页面的新闻流发布通知。

我在 facebook 中创建了一个应用程序，我正在使用 php fb api，如下所示：

```
//actual values redacted, obviously
$appId = 'my_app_id';
$pageId = 'my_page_id';
$secret = 'my_app_secret';

//First i'm getting the authtoken
$args = array(
    'grant_type' => 'client_credentials',
    'client_id' => $appid,
    'client_secret' => $secret
);

$ch = curl_init();
$url = 'https://graph.facebook.com/oauth/access_token';
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $args);
$data = curl_exec($ch);

//this comes back from facebook like auth_token=xxxxx
$token = str_replace("access_token=", "", $data); //remove 'auth_token='

$facebook = new Facebook(array(
        'appId' => $appId,
        'secret' => $secret,
        'cookie' => false,
        'domain' => 'mydomain.net'
    ));

$facebook->api("/$pageId/feed", 'post', array(           
    'access_token' => $token,
    'link' => 'http://www.example.com'
)); 
```

这会连接到 facebook 并尝试发布到提要，但没有说：

```
(#200) The user hasn't authorized the application to perform this action 
```

所以我的问题是，我应该如何授权应用程序发布到提要？我在应用程序上看不到任何设置，并且似乎无法向页面“添加”权限。在这一点上我完全迷失了，facebook文档没有多大帮助。

任何帮助将非常感激。我已经为此浪费了一整天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:27:10.217

尝试从此数组中删除 $token 参数

```
$facebook->api("/$pageId/feed", 'post', array(           
    **'access_token' => $token,**
    'link' => 'http://www.example.com'
)); 
```

并在 POST API 调用之前以这种方式设置令牌

```
$facebook->setAccessToken($token); 
```

让我知道它是怎么做的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T07:53:36.647

> 所以我的问题是，我应该如何授权应用程序发布到提要？我在应用程序上看不到任何设置，并且似乎无法向页面“添加”权限。

您必须首先获得一个**访问令牌**-*用户访问令牌*（长期存在的令牌在 60 天后过期，因此您必须定期返回您的应用程序进行更新），或者*页面访问令牌*（不t 默认过期）。并且您必须要求获得必要的**许可**才能发布（代表用户行事时）。

要获得它们，您必须通过身份验证流程。所有细节都在这里描述：[https ://developers.facebook.com/docs/authentication/](https://developers.facebook.com/docs/authentication/)

如果您还不太熟悉 API 的使用，可能还有帮助的可能是[Graph API Explorer——](https://developers.facebook.com/tools/explorer)在那里您可以“玩转”，发出不同类型的请求，查看结果或错误是什么。它允许您在那里生成用户访问令牌（让您了解自己在应用程序中必须做什么）。

# jquery - JQuery AJAX HTTP 连接

> ID：11254127
> 
> 赞同：3
> 
> 时间：2012-06-28T23:07:26.353
> 
> 标签：jquery, ajax, performance, http

如果我有一个看起来像这样的 jQuery POST 调用：

```
$.post(url : "myserver/1", data : params, success: function () { 
    $.post(url : "myserver/2", data : params2); 
}); 
```

这将打开多少个 HTTP 连接？我假设它打开2。

我正在尝试复制网页在 Python 脚本中的功能（作为性能测试类型脚本）。如果我这样做会快得多：（伪代码）

```
for i in 0 to 5000:
     Open HTTP Connection
     POST
     POST
     Close HTTP Connection 
```

对比

```
for i in 0 to 5000:
     Open HTTP Connection
     POST
     Close
     Open HTTP Connection
     POST
     Close 
```

我假设第二个测试是浏览器会做的事情。我本质上想复制 5000 次点击（背靠背）到页面的速度。显然我可以并行化这个任务——但这不是我在这里寻找的

现在，假设 jquery 正在建立 2 个 HTTP 连接，是否有一种简单的方法来维护持久连接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T23:22:44.753

jQuery 无法控制连接数 - 浏览器会打开任意数量的连接（通常为 2-8），然后通过它们推送您的请求。您的代码可能只会打开一个连接，因为您在启动第二个请求之前正在等待第一个请求完成。

当然，您不能在 javascript 中使用线程，但您可以一次发起任意数量的请求，这可以最大限度地增加浏览器允许的连接数。

你可能想要这样的东西：

```
var CONCURRENCY=4, qty = 5000, cnt = 0
function testOnce() {
  cnt = cnt + 1;
  if (cnt >= qty) { return; }
  $.post(url : "myserver/" + cnt, data : params, success: testOnce)
}
for (var i=0; i<CONCURRENCY; i++) {
  testOnce()
} 
```

即使这样，您也只会打开几个连接并通过这些连接发送所有请求。这不会真正为您的服务器应用程序提供您正在寻找的打击，包括 tcp 设置和拆卸。浏览器是专门设计用来避免敲打任何一台服务器的。如果您发出过多的请求，它们最终会在浏览器的网络管理器中等待可用的连接。

如果你在服务器上禁用 http keep-alive，你会更接近，但这可能是不可能的，或者可能会影响结果。禁用它后，每个请求都将被迫建立一个新的连接。但这是不切实际的悲观。这一切都取决于。现实的负载测试并不那么容易。但通常你不需要它那么现实——你真正想要测试的是什么？

[Wireshark](http://www.wireshark.org/)将向您展示真正发生的事情的细节。

# java - 查看特定方法的调用堆栈

> ID：11254130
> 
> 赞同：1
> 
> 时间：2012-06-28T23:07:45.120
> 
> 标签：java, callstack

是否可以使用任何工具在我的应用程序中查看给定方法的调用堆栈的完整列表？

我想看到在 JProfiler 中对于给定方法可以看到的类似结果。

但是，我正在寻找一些开源/免费的替代方案，而不必做太多的配置设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:38:03.517

我不确定，但也许你正在寻找类似这种方法的东西

```
class MyInfo{
    static void showStack(){
        try{
            throw new Exception();
        }catch(Exception e){
            StackTraceElement[] ste=e.getStackTrace();
            for(int i=1; i<ste.length;i++){
                System.out.println(ste[i].getClassName()+"."+ste[i].getMethodName());
            }
        }
    }
} 
```

让我们试试

```
class C1 {
    void methodA() {MyInfo.showStack();}
    void methodB() {methodA();}
}

class C2 {
    static void methodX() {
        C1 c1 = new C1();
        c1.methodB();
    };
    //TEST
    public static void main(String[] args) {
        C2.methodX();
    }
} 
```

出去

```
C1.methodA
C1.methodB
C2.methodX
C2.main 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:40:46.233

jdk 附带的 JConsole 有一个 Threads 选项卡，其中列出了所有正在运行的线程。当您选择一个时，它将显示跟踪。您无需任何设置即可连接到本地进程。如果您是远程用户，则必须启用远程连接器作为启动选项。屏幕截图来自 jdk 1.7。 ![控制台](../Images/673b75bf19678cc00c3c3e246ef06262.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:13:00.923

这会让你得到你想要的吗？

[`java.lang.Throwable.getStackTrace()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Throwable.html#getStackTrace)

# sql-server-2008 - 试图弄清楚如何在 SQL 中构建查询

> ID：11254135
> 
> 赞同：0
> 
> 时间：2012-06-28T23:08:37.213
> 
> 标签：sql-server-2008, tsql

我在构建查询时遇到了一些麻烦，我需要从 FamilyAccountDetails 表中返回 AccountID，其中家庭帐户至少有一个孩子（一个孩子是 AccountDetails.AccountID 等于 FamilyAccountDetails.AccountID），其 HoldFlag = 0。

```
AccountDetails
EntID  |HoldFlag|AccountID|StatusFlag

FamilyAccountDetails
EntID|FamilyAccountID|AccountID|StatusFlag 
```

SQL：

```
 Select FD.AccountID, FD.FamilyAccountId 
from Test2TMAdvisor5.dbo.FamilyAccountDetails FD
      where FD.EnterpriseId = 'TestDan'
      and AccountId in (Select AccountId from Test2TMAdvisor5.dbo.AccountDetails AD where Ad.AccountID = FD.AccountId and ad.HoldFlag =0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:11:03.637

```
SELECT
    FD.[AccountID]
    ,FD.[FamilyAccountId] 
FROM
    FamilyAccountDetails FD
WHERE
    FD.[EnterpriseId] = 'TestDan'
    AND EXISTS 
        (
        SELECT 
            * 
        FROM 
            AccountDetails AD
        WHERE 
            AD.[AccountID] = FD.[AccountId] 
            AND AD.[HoldFlag] = 0
        ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T02:30:30.327

此 SQL 查询应提取您想要的结果：

```
SELECT
    FD.[AccountID]
    ,FD.[FamilyAccountId] 
FROM
    FamilyAccountDetails FD
INNER JOIN AccountDetails AD on AD.[AccountID] = FD.[AccountId] 
WHERE
    FD.EntID = 'TestDan'
    AND AD.[HoldFlag] = 0 
```

# scala - Spring Integration DSL 消息驱动的 jms 监听器使用轮询器代替

> ID：11254136
> 
> 赞同：0
> 
> 时间：2012-06-28T23:08:51.987
> 
> 标签：scala, spring-integration

我使用以下代码创建了一个 int-jms:message-driven-channel-adapter，但是，它似乎是基于轮询的，因为它以 1 秒的间隔返回数据，而不是响应滴答声。

我定义的流程如下：

```
jms.listen(requestDestinationName = "myTopic", connectionFactory = connectionFactory).additionalAttributes(requestPubSubDomain = true) --> ... 
```

问题是，如何使它成为消息驱动的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:52:48.300

我检查了 scala dsl 中的底层实现，发现它默认创建一个`jms:inbound-gateway`（不是消息驱动通道适配器），它在内部使用 DefaultMessageListenerContainer。所以是的，它是一个内部消息驱动的容器，但因为它似乎使用网关组件，它具有请求/回复类型的流，这可能是您看到的 1 秒延迟，而不是轮询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T15:31:41.623

好的，作为一种解决方法，我手动创建 SubscribableJmsChannel：

```
lazy val subscribeChannel = {
  val c = new SubscribableJmsChannel(jmsContainer, jmsTemplate)
  c.afterPropertiesSet()
  c.subscribe(new MessageHandler {
    def handleMessage(message: Message[_]) {processMessage(message)}
  })
  c
}

subscribeChannel.start() 
```

其中 processMessage(message) 是我的处理函数，并且

```
lazy val jmsContainer= {
    val c = new DefaultMessageListenerContainer
    c.setConnectionFactory(connectionFactory)
    c.setDestination(dest)
    c.setPubSubDomain(true)
    c.afterPropertiesSet()
    c
 } 
```

请注意，SubscribableJmsChannel 不会将 JMS 属性映射到 SI 消息头！我不得不回退到使用 Spring Integration XML 流定义。

# asp.net-mvc-3 - MVC3 更强类型的模型类

> ID：11254138
> 
> 赞同：2
> 
> 时间：2012-06-28T23:09:12.670
> 
> 标签：asp.net-mvc-3

我是 MVC3 的新手。当我创建一个强类型视图时，它在视图代码文件的顶部使用此代码

```
@model MonoPoly.Models.LandDocument 
```

所以这意味着视图可以使用该模型类的所有属性（这里是这个 LandDocument 模型类）。但我的问题是如何将更多模型类作为这个单一视图文件的强类型？或者我应该如何在这个视图中调用其他模型类属性，它已经使用该 LandDocument 模型类进行了强类型化？

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T23:17:45.040

一种方法是创建一个`ViewModel`对象，其中包含您希望在视图中引用的所有对象。[在Steve Michelotti 的博客](http://geekswithblogs.net/michelotti/archive/2009/10/25/asp.net-mvc-view-model-patterns.aspx)上查看如何实现 ViewModel 模式的详细信息：模式 2 –[*包含*](http://geekswithblogs.net/michelotti/archive/2009/10/25/asp.net-mvc-view-model-patterns.aspx)[域模型对象的专用视图模型](http://geekswithblogs.net/michelotti/archive/2009/10/25/asp.net-mvc-view-model-patterns.aspx)[](http://geekswithblogs.net/michelotti/archive/2009/10/25/asp.net-mvc-view-model-patterns.aspx)

 *例如，如果你想要一个`LandDocument`类和一个`Player`类，你可以创建一个`ViewModel`这样的：

```
public class BoardViewModel
{
    public LandDocument LandDocument { get; set; }
    public Player LandOwner { get; set; }
} 
```

然后在您的视图顶部：

```
@model MonoPoly.ViewModels.BordViewModel 
```

您可以像这样访问视图中的数据，例如：

```
@Model.LandDocument.LandDocumentId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:17:34.027

创建一个复合视图模型类来封装您需要的所有对象。

例子：

```
public class InvoiceViewModel
{
    public InvoiceHeader Header { get; set; }
    public List<InvoiceDetail> Details { get; set; }
} 
```*

# android - 使用 Windows 7-64 位将 Android SDK Tools rev 19 更新到 rev 20 的问题

> ID：11254139
> 
> 赞同：18
> 
> 时间：2012-06-28T23:09:13.047
> 
> 标签：android, sdk

我在将 android SDK 工具 rev 19 更新到 rev 20 和 Android SDK Platform-tool rev 11 到 rev 12 时遇到问题。

我检查了 SDK 管理器日志，它显示以下错误：

> 找不到文件：C:\Program Files (x86)\Android\android-sdk\temp\platform-tools_r12-windows.zip（访问被拒绝）
> 
> 跳过“Android SDK 工具，修订版 20”；它取决于未安装的“Android SDK 平台工具，修订版 12”。
> 
> 完毕。什么都没有安装。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-28T23:26:05.080

您是否尝试过“以管理员身份”运行 SDK 管理器？

以下步骤在 Windows 7 上以管理员身份运行 SDK 管理器

*   右键单击 SDK 管理器
*   选择以管理员身份运行
*   单击“是”按钮（如果要求）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-14T19:22:48.513

此方法仅适用于 Windows 7 x64：

1.  右键单击`SDK.exe`
2.  单击属性
3.  选择兼容性
4.  检查`Run This Program in Compatibility mod`e 以获取 Windows XP SP3。
5.  `Run this Program as Administrator`.
6.  申请并确定

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-03T09:08:51.223

尝试这个：

*   [从此链接](http://dl.google.com/android/repository/platform-tools_r12-windows.zip)下载 zip 文件。
*   导航到`C:\Program Files (x86)\Android\android-sdk\temp\`下载的文件并将其解压缩到此文件夹
*   它将重写您的平台工具文件夹。
*   [从此处](http://dl.google.com/android/repository/tools_r20-windows.zip)下载 SDK 工具修订版 20并将其添加到`temp`文件夹中。

而已。这个对我有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T15:24:24.413

你所要做的就是：

1.  右键单击该`SDK.exe`文件。
2.  选择`trouble shoot compatibilty`。
3.  不要选择你没有的问题。
4.  你准备好了。

为我工作，希望它有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-09T01:14:14.133

不要以管理员身份运行您的 Eclipse 快捷方式 ..以管理员身份运行实际的 exe

# javascript - 使用jquery更改内部选定元素的功能？

> ID：11254140
> 
> 赞同：1
> 
> 时间：2012-06-28T23:09:18.260
> 
> 标签：javascript, jquery, html

jquery 是否可以说如果我单击列表元素会发生某些事情，但是如果我单击该列表中的元素（例如跨度），则无需更改

例子

`<li><span>hello</span></li>`如果我单击 li 元素 => alert("list")，如果我单击 li => alert("hello") 内的 span 元素，但它也不必向我显示 alert("list") .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:10:29.617

是的，检查`event.target`触发事件的节点。

```
$('li').click(function(event){
    if (event.target. == event.currentTarget)
        // li element triggered
    else
        // inner elements triggered
}); 
```

[**现场愚蠢的演示**](http://jsfiddle.net/hXV77/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:10:38.880

你需要使用`event.stopPropagation;`

[http://api.jquery.com/event.stopPropagation/](http://api.jquery.com/event.stopPropagation/)

## *[jsFiddle 演示](http://jsfiddle.net/roXon/b5Mun/1/)*

* * *

如果您使用该`.live()`方法（并且您有 jQuery 1.7+），我建议您使用如下`.on`方法：

```
$('ul').on('click','li',function(){
  alert('UAAAAAAA! FOOO BARRRRR');
});

$("li").on('click','span',function(event){
  event.stopPropagation();
  $(this).text('See? No alert dropped! ;)');
}); 
```

更多信息请访问：[http ://api.jquery.com/on](http://api.jquery.com/on)

> .on() 方法将事件处理程序附加到 jQuery 对象中当前选定的元素集。从 jQuery 1.7 开始，.on() 方法提供了附加事件处理程序所需的所有功能。有关从旧 jQuery 事件方法转换的帮助，请参阅 .bind()、.delegate() 和 .live()。要删除与 .on() 绑定的事件，请参阅 .off()。要附加仅运行一次然后自行删除的事件，请参阅 .one()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:40:39.443

参考**[现场演示](http://jsfiddle.net/SivaCharan/wB7N3/1/)**

1.  单击`Red`边框和内部 - 它的`LIST`
2.  单击`Bluw`边框和内部 - 它的`HELLO`

## HTML：

```
<ul>
    <li>
        <span>hello</span>
    </li> 
</ul>​ 
```

## JS：

```
$('*').click(function() {
    if (this.tagName == "LI")
        alert("List");
    else if (this.tagName == "SPAN")
        alert("hello");
    return false;
});​ 
```

# asp.net-mvc-3 - 找不到包含路径“~/Public/stylesheets/main.less”的资产包

> ID：11254141
> 
> 赞同：4
> 
> 时间：2012-06-28T23:09:21.093
> 
> 标签：asp.net-mvc-3, cassette

我尝试访问 Cassette 的调试页面以查看是什么，但我得到的只是一个空白页面（**Firebug 说我收到了 404 标头**）。真的不知道为什么：

```
www.foobar.com/_cassette
               ^-----------This is the debugger page for Cassette. 
```

我正在使用带有 Cassette 的 ASP.Net MVC3 进行资产捆绑和缩小。

在我的开发机器上一切正常，但是在部署到托管服务器时，这是我收到的消息：

> “/”应用程序中的服务器错误。
> 
> 找不到包含路径“~/Public/stylesheets/main.less”的资产包。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentException：找不到包含路径“~/Public/stylesheets/main.less”的资产包。

再次：在我的开发机器上一切正常。

这是我的 CassetteConfiguration 文件：

```
public void Configure(BundleCollection bundles, CassetteSettings settings)
{    
    bundles.Add<StylesheetBundle>("~/Public/stylesheets");
    bundles.Add<ScriptBundle>("~/Public/javascripts");
} 
```

在我的 _Layout.cshtml 文件中：

```
@{
    Bundles.Reference("~/Public/stylesheets/bootstrap.css");
    Bundles.Reference("~/Public/stylesheets/main.less");
} 
```

我正在使用来自 Vidahost 的共享“云”托管。

我可以采取哪些步骤来调试此问题？我整个下午都在研究它，到目前为止还没有开辟新天地。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-12T11:08:38.180

尝试在 BundleConfig 文件中添加以下内容

```
public static void RegisterBundles(BundleCollection bundles)
        {
            bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                        "~/Scripts/jquery-1.*"));

            bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                        "~/Scripts/jquery-ui*"));

            bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                        "~/Scripts/jquery.unobtrusive*",
                        "~/Scripts/jquery.validate*"));

            bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                        "~/Scripts/modernizr-*"));

            bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));

            bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
                        "~/Content/themes/base/jquery.ui.core.css",
                        "~/Content/themes/base/jquery.ui.resizable.css",
                        "~/Content/themes/base/jquery.ui.selectable.css",
                        "~/Content/themes/base/jquery.ui.accordion.css");
        } 
```

# ios - 如何将“file://localhost/var/mobile/...”的 URL 与“file:///var/mobile/...”进行比较

> ID：11254145
> 
> 赞同：2
> 
> 时间：2012-06-28T23:09:58.213
> 
> 标签：ios, uiwebview, nsurl, nsfilemanager

我正在使用 UIWebView:loadRequest 和一个 NSURLRequest 打开一个本地文件，而 NSURLRequest 又是从一个 URL 设置的。

使用以下方法获取 url 的基本位置：

```
 baseDirectory = [[NSFileManager defaultManager] URLForDirectory:NSApplicationSupportDirectory
                                                                        inDomain:NSUserDomainMask
                                                                appropriateForURL:nil   
                                                                            create: YES
                                                                            error:&err]; 
```

这将返回表单的 URL：

```
file://localhost/var/mobile/Applications/Library/ApplicationSupport/ABC/XYZ/page.html 
```

但是，当 UIWebViewDelegate shouldStartLoadForRequest:(NSURLRequest*) 方法被调用时，传递的 NSURLRequest 已更改为以下内容：

```
file:///var/mobile/Applications/Library/ApplicationSupport/ABC/XYZ/page.html 
```

因此，这两个都引用了同一个文件，但是我有一种情况需要在两者之间进行比较（我需要比较 /ABC/XYZ/page.html 部分）并且 NSURL:isEqual 在比较两者时返回 NO .

是否有：a) NSFileManager 的方法将返回 file:///var/mobile/... 而不是 file://localhost/var/mobile/...

或者

b）轻松提取 /ABC/XYZ/page.html 部分并对其进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:56:00.337

您可以尝试调用`URLByStandardizingPath`两个 URL 并比较这些结果而不是原始结果。

如果这不起作用，您可以通过调用`pathComponents`两个 URL 并比较两个返回数组中的最后一个对象和倒数第二个对象，只比较最后两个路径组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:22:25.213

如果您知道这两个文件将始终位于同一台机器上，那么`[[URL1 path] isEqualToString:[URL2 path]]`.

* * *

以下单元测试通过：

```
- (void)testURLPath
{
    NSURL *URL = [NSURL URLWithString:@"file://localhost/foo/bar/baz"];
    NSString *path = [URL path];
    STAssertEqualObjects(path, @"/foo/bar/baz", nil);
}

- (void)testURLPathCompare
{
    NSURL *URL1 = [NSURL URLWithString:@"file://localhost/foo/bar/baz"];
    NSURL *URL2 = [NSURL URLWithString:@"file:///foo/bar/baz"];
    NSString *path1 = [URL1 path];
    NSString *path2 = [URL2 path];
    STAssertTrue([path1 isEqualToString:path2], nil);
    STAssertTrue([[URL1 path] isEqualToString:[URL2 path]], nil);
} 
```

# wav - 使用 Nadio 将 wav 数据块读取到数组

> ID：11254148
> 
> 赞同：0
> 
> 时间：2012-06-28T23:10:11.640
> 
> 标签：wav, naudio

我想使用 Naudio 库读取 WAV 文件并将数据块信息保存到数组或字符串中。请让我知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:13:16.300

使用`WaveFileReader`类。该`Read`方法仅从数据块返回数据。如果您使用长度属性，您可以分配一个正确大小的数组并一键读取。

# javascript - 如何使用 Javascript 检测 SVG 动画和显示/隐藏 Flash/SVG 对象？

> ID：11254161
> 
> 赞同：0
> 
> 时间：2012-06-28T23:11:11.127
> 
> 标签：javascript, firefox, animation, svg, browser-feature-detection

我一直在尝试使用 SMIL 创建 SVG 动画。它在最新的 Firefox 中运行良好，但在 IE 中当然不能运行。我已经有一个类似的 Flash 动画。我的计划是在页面上同时包含 Flash 和 SVG 动画，并根据 javascript 检测显示/隐藏它们。但我对 javascript 很差劲，不知道该怎么做。我将使用链接的 .js 文件。我的计划是在页面加载时检测浏览器是否支持“http://www.w3.org/TR/SVG11/feature#AnimationEventsAttribute”功能，如果支持，就隐藏Flash对象（id="rotateFlash ") 并显示 SVG 对象 (id="rotateSVG")。

我不知道是否有更好的方法来实现我想要的，我还没有在网上找到任何类似于我想要实现的代码。我找到了显示/隐藏 javascripts，但不知道如何用它们实现检测该功能。

这段代码似乎至少做了一些事情，但它似乎遵循“else”命令，我猜这意味着 Firefox 没有将该功能检测为“True”（IE9 也不是，但这是意料之中的）。

```
function supportsSvg() {
  if(document.implementation.hasFeature ("http://www.w3.org/TR/SVG11/feature#AnimationEventsAttribute", "1.0") == "true" ) {
    document.getElementById("rotateSVG").style.display = "";
    document.getElementById("rotateFlash").style.display = "none";
  }
  else {
    document.getElementById("rotateSVG").style.display = "none";
    document.getElementById("rotateFlash").style.display = "";
  }
} 
```

我不知道还能做什么。我尝试了其他更简单的 SVG 功能，但得到了相同的结果。我一直在阅读有关 Modernizr 的文章，但这对我来说似乎太复杂了。我不明白如何，为什么，如果它会工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T07:19:34.590

我想我终于让它工作了。看了下代码，感觉`== "true"`没必要，就删了。现在它似乎可以在 Firefox 13 和 IE9 中运行。

```
function supportsSvg() {
  if(document.implementation.hasFeature ("http://www.w3.org/TR/SVG11/feature#AnimationEventsAttribute", "1.0")) {
    document.getElementById("rotateSVG").style.display = "";
    document.getElementById("rotateFlash").style.display = "none";
  }
  else {
    document.getElementById("rotateSVG").style.display = "none";
    document.getElementById("rotateFlash").style.display = "";
  }
} 
```

# javascript - 我是否正确地编写了 JS 面向对象的代码？

> ID：11254167
> 
> 赞同：1
> 
> 时间：2012-06-28T23:12:09.643
> 
> 标签：javascript, oop

一般来说，我是 Javascript 和面向对象编程的新手。我想知道我在编写 JS OOP 代码时是否遵循最佳实践。

在这里，我创建了一个名为 _name 的类，并为其赋予了一些属性以及一个对象 this.details。然后我使用原型来为类创建方法。

```
//define _name class (I use _ to easily recognize classes)
function _name () {
    this.firstName = '';
    this.lastName = '';
    this.middleName = '';
    this.details = {
        eyeColor: '',
        hairColor: ''
    }
}

//begin _name methods

_name.prototype.getFullName = function() {
    return this.firstName + ' ' + this.middleName + ' ' + this.lastName;
}
_name.prototype.setFirstName = function(firstName) {
    if ($.trim(firstName).length && typeof firstName != 'not_defined') {
        this.firstName = firstName;
    } else {
        alert('Please enter a valid first name.');
    }
}
_name.prototype.setLastName = function(lastName) {
    if ($.trim(lastName).length && typeof lastName != 'not_defined') {
        this.lastName = lastName;
    } else {
        alert('Please enter a valid last name.');
    }
}
_name.prototype.setMiddleName = function(middleName) {
    if ($.trim(middleName).length && typeof middleName != 'not_defined') {
        this.middleName = middleName;
    } else {
        alert('Please enter a valid middle name.');
    }
}
_name.prototype.setHairColor = function(hairColor) {
    this.details.hairColor = hairColor;
}
_name.prototype.setEyeColor = function(eyeColor) {
    this.details.eyeColor = eyeColor;
}

//end _name methods

var personOne = new _name();
personOne.setFirstName('John');
personOne.setLastName('Doe');
personOne.setMiddleName('Barry');
personOne.setEyeColor('Brown');
personOne.setHairColor('Black');
document.write(personOne.getFullName());
document.write(personOne.details.eyeColor);
document.write(personOne.details.hairColor); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:23:35.463

从大局来看，是的，你做得很好；好一个。:-) 考虑[有关 SO 的其他答案中](https://stackoverflow.com/a/11072626/157247)的示例以获取更多信息和观点。

一些指针，它们都不是 OOP 相关的，只是 JavaScript 相关的：

1.  JavaScript 中压倒性的约定是*构造函数*(your `_name`) 最初是有上限的，例如`Name`(like `Date`or `RegExp`)。

2.  您在表单`_name.prototype.setLastName = function() { ... }`中分配的各种函数是分配给具有名称的属性的*匿名函数。*给你的函数起正确的名字可以帮助你的工具帮助你。一些引擎足够聪明，即使你没有给你的函数命名，也能弄清楚，但其他引擎需要正确的名字。有关示例和/或[*Anonymouses anonymous*](http://blog.niftysnippets.org/2010/03/anonymouses-anonymous.html) ，请参见上面的链接。

3.  您依赖于在所有函数分配中[自动插入分号](http://ecma-international.org/ecma-262/5.1/#sec-7.9)`_name.prototype.setLastName = function() { ... }`的恐怖：应该在`}`. 建议学习规则并始终明确提供分号；当引擎必须猜测时，它可能会猜错，并且当您将它们排除在外时，它会使缩小/压缩/打包变得困难。

4.  与其到处写，不如`_name.prototype.xyz = ...`考虑使用范围函数并缓存`_name.prototype`到更简单的符号，例如：

    ```
    (function(p) {
        p.setLastName = function() {
            // ...
        };

        p.xyz = function() {
            // ...
        };
    })(_name.prototype); 
    ```

    ...或使用比这更进一步的辅助函数。只是为了减少击键和脚本大小。

但是，总的来说，是的，你走在正确的轨道上。

更多阅读：

*   [*神话方法*](http://blog.niftysnippets.org/2008/03/mythical-methods.html)
*   [*你必须记住`this`*](http://blog.niftysnippets.org/2008/04/you-must-remember-this.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:20:57.890

一些评论：

> 我使用 _ 来轻松识别类

标准是对构造函数使用大写的名称。下划线用于暗示变量或属性的隐私——即它们是公开的，但不应使用。

> `var personOne = new _name();`
> 
> `personOne.setFirstName('John');`
> 
> `personOne.set...`

通常你会使用构造函数的参数：

```
function Name (first, last, middle, eye, hair) {
    this.firstName = first;
    this.lastName = last;
    this.middleName = middle;
    this.details = {
        eyeColor: eye,
        hairColor: hair
    }
}

var personOne = new Name('John', 'Doe', 'Barry', 'Brown', 'Black'); 
```

setter 通常在初始化时只被调用一次，因此您可以将它们的代码移动到构造函数中。如果您打算使属性可变，您仍然可以使用构造函数中的验证逻辑调用 setter 函数。

> typeof middleName != 'not_defined'

`typeof`无值变量的运算符的结果是`"undefined"`. 您还应该在修剪之前检查一下。

您的一般代码设计中也可能存在一些缺陷。您对名字、中间名和姓氏使用相同的条件，您应该真正将它们移动到`validateString`可以从单个设置器（DRY 代码）调用的自己的函数中。同样，验证函数不应该给用户关于输入什么的反馈，它应该只返回`false`“无效”。用户交互应该由也处理您的输入的模块完成 - 而不是在数据结构模块中。

# c++ - 单元测试和 boost::asio

> ID：11254169
> 
> 赞同：12
> 
> 时间：2012-06-28T23:12:28.273
> 
> 标签：c++, unit-testing, boost, xmpp, boost-asio

我正在使用 boost::asio 编写小型 XMPP 服务器，并且我想对我的代码进行单元测试。问题：

1.  有一些现成的框架吗？据我了解，我需要为 boost::asio 类/模板提供模拟对象，我真的很想（半）自动地制作它。
2.  是否可以测试并发性（例如到服务器的多个连接和它们之间的消息路由）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T15:01:49.503

1）我写了一个小的socket类，可以用来代替boost::asio::ip::tcp::socket。如果您愿意，可以查看 robitzki.de/test_socket.h（test_socket.cpp、test_io_plan.h 和 test_io_plan.cpp）。根据使用的构造函数，套接字可以模拟不同大小的块的读/写。也可以模拟错误。如果您愿意，您可以免费使用它。

2) 通过更换插座，可以为被测软件建立压力测试。这永远不会保证代码不包含错误，但总比没有好;-)。我个人最喜欢代码审查，以确保多线程代码包含尽可能少的错误。

高温高压

托尔斯滕

# jquery - 带有嵌套 div 的可点击 div

> ID：11254172
> 
> 赞同：0
> 
> 时间：2012-06-28T23:12:35.243
> 
> 标签：jquery, css, html, anchor, block

我正在寻找一个可点击的 div，其中嵌套了更多的 div。据我了解，如果您设置锚标记 display:block 的样式，它将充当块 (div)，您可以在其中嵌套您想要可点击的 div。

但是，我不相信你可以继续嵌套更多的 div ......如果是这样的话，为什么会这样？

而且，解决这个问题的最佳/最简单的解决方案是什么。理想情况下是所有 CSS/HTML，但如果 CSS/HTML 真的不可能，jQuery 解决方案也可以。

无论如何...例如：

只要锚的样式为 display:block...，这将起作用（是吗？）

在这里输入代码

```
<a>
     <div id='first'>
     </div>
</a> 
```

这不会...

在这里输入代码

```
<a>
     <div id='first'>
          <div id='inside first'>
          </div>
          <div id='inside first 2'>
          </div>
     </div>
</a> 
```

任何和所有的帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:24:27.430

当然你的第二个变种会起作用 - [http://jsfiddle.net/W5jG8/](http://jsfiddle.net/W5jG8/) 你可以更深入。事实上，嵌套的深度是没有限制的。（或者也许有，但与现实生活中的案例无关）

但是在 HTML5 之前将块级元素嵌套到最初的内联元素中在语义上是不正确的。一种解决方案是将所有`<div>`-s替换为`<span>`-s 并使其阻塞。

或者您可以将`<div>`-s 与 jQuery 一起使用并将点击侦听器附加到包装器 - [http://jsfiddle.net/W5jG8/](http://jsfiddle.net/W5jG8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:25:18.453

如果你正在使用`HTML5 Doctype`它是有效的使用锚标签来包装 div 元素，假设你不使用`HTML5 Doctype`你也可以试试这个：

```
div#first {
  cursor: pointer;
}

$('#first').click(function() {
    window.location = 'http://www.example.com'
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:19:48.033

最简单的方法是使用 jquery，为要使其可点击的 div 指定一个 Id，如下所示：

```
$('#div_Id').click(function(){

blablabla...

}); 
```

[这是一些文档： http](http://api.jquery.com/click/) ://api.jquery.com/click/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T23:58:47.483

将 div 标签放在锚标签内不是有效的 html，因此您不应该这样做。在您的情况下，最简单的方法是使用一点 JavaScript 并在您的父 div 上定义一个简单的 onclick 事件，例如：

```
 <div id='first' onclick="javascript:MyRedirectFunction()">
      <div id='inside first'>
      </div>
      <div id='inside first 2'>
      </div>
 </div> 
```

那么如果你想让用户明白这个 div 是可点击的，你可以使用 CSS 给它一个类似锚点的行为，例如：

```
div#first{ cursor: pointer; }
div#first:hover{ background-color:#CCCCCC;} 
```

# ios - ios 模拟器可以在 Mac OS X Server 上运行吗？

> ID：11254177
> 
> 赞同：0
> 
> 时间：2012-06-28T23:13:08.053
> 
> 标签：ios, ios-simulator, osx-server

iOS 模拟器将在哪些版本的 Mac OS X Server 上运行（如果有）？我问的是 OS X Server，而不是普通的 OS X。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T20:26:44.197

是的，我有一台运行 Mac OS X Server Lion 10.7.4 的 mac mini，过去 2 个月我一直在 iOS 模拟器上进行测试，没问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T06:35:04.667

除了捆绑的应用程序和服务之外，OS X Server 与 OS X“客户端”没有任何不同。使用 Lion 和 Mountain Lion（您可能需要最新的 Xcode，因此您将需要其中一个），OS X Server 只是 AppStore 中的一个附加安装程序，安装它绝不会阻止您安装或运行任何开发人员工具。

# actionscript-3 - flash SecurityError: 错误 #2028: Local-with-filesystem SWF 文件

> ID：11254183
> 
> 赞同：2
> 
> 时间：2012-06-28T23:13:38.960
> 
> 标签：actionscript-3, flash

嗨，我的 Flash 应用程序在尝试与 Internet 通信时出现错误 2028，使用 Flash ide 工作正常。但是当我首先使用 Flash 播放器运行 swf 文件时，我收到有关不安全操作的警告，然后我继续并收到 SecurityError: Error #2028: Local-with-filesystem SWF file file:///C|/Users.... 错误

我知道如何在本地解决这个问题，但我需要它在任何地方工作，而不仅仅是在我的本地我不会将我的 swf 上传到任何服务器我只是希望它把它复制到闪存驱动器中并在我想要的任何地方工作

我将 crossdomain.xml 与 swf 放在相同的目录中，并添加了这两行：（也导入了）

```
Security.allowDomain("*");
Security.loadPolicyFile("crossdomain.xml"); 
```

但没有任何改变

我的 crossdomain.xml：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">    
<cross-domain-policy>  
<allow-access-from domain="*" />    
</cross-domain-policy> 
```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:34:22.420

如果您使用 Flash 进行编译，请尝试在**Flash(.swf) 发布设置中将****本地播放安全设置为仅访问本地文件**：

 **![访问本地文件](../Images/034fa2c72a41810af0e539976d3b4990.png)

如果您使用的是 FlexSDK（带或不带任何 IDE），则需要将`-use-network`编译器标志设置为`false`：

```
-use-network=false 
```

[您可以在此处](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e3f.html)阅读有关不同安全沙箱的更多信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T04:38:31.400

Have you considered wrapping your application as [air](http://www.adobe.com/products/air.html)**

# .net - 为 XMPP 创建自己的 HTTP Web 服务

> ID：11254187
> 
> 赞同：0
> 
> 时间：2012-06-28T23:14:12.420
> 
> 标签：.net, web-services, windows-phone-7, xmpp

鉴于 WP7（和 WP7.5）中的套接字和 XMPP 存在许多问题，我想过做一些事情来让这个世界变得更美好……但后来发现，我对 Web 服务器不太关心（实际上对一般网络）。

请注意，我不是在询问 Web 服务器、安全性、硬件或托管，而是实际代码。此外，我不打算将此服务作为全球使用的服务，而是一项免费使用，由您自己承担风险的服务。

问题是，我需要做什么来创建一个可以充当 wp7+ 推送通知和 XMPP 之间的层的 Web 服务？我打算在 .NET（C# 或 Visual Basic 中的任何一个）中执行此操作。这样做的主要目标是提供为 gTalk 客户端创建服务的方法，该服务可以通过推送工作，但它可以推广到支持任何其他 XMPP 服务（如果后者不会造成太大麻烦的话）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T06:26:37.467

我不知道套接字问题是什么，但如果您希望通过 HTTP 隧道 XMPP，请使用 BOSH ( [XEP-0124](http://xmpp.org/extensions/xep-0124.html) / [XEP-0206](http://xmpp.org/extensions/xep-0206.html) )。一种方法是使用像[Punjab](https://github.com/twonds/punjab)这样的 BOSH 代理。

# java - 动作监听器

> ID：11254188
> 
> 赞同：-4
> 
> 时间：2012-06-28T23:14:14.933
> 
> 标签：java, swing, jbutton, actionlistener

如何使用附加到按钮的动作侦听器。我如何让它从一个单独的类文件中工作？

编辑：这就是我所拥有的：

```
import java.awt.*; 
```

导入 java.awt.event.*；

公共类桂{

```
static boolean playerturn = true;

public static void main(String[] args) {

    Frame frame1 =new Frame("TickTacToe - By Fred");
    frame1.setLayout(null);
    frame1.setBounds(250,150,500,500);
    frame1.setVisible(true);
    frame1.addWindowListener(new WindowAdapter(){
        public void windowClosing(WindowEvent e){
            System.exit(0);
        }
    });

    final Button button11 = new Button("");
    button11.addActionListener(null);

    final Button button12 = new Button("");
    button11.addActionListener(null);

    final Button button13 = new Button("");
    button11.addActionListener(null);

    final Button button21 = new Button("");
    button11.addActionListener(null);

    final Button button22 = new Button("");
    button11.addActionListener(null);

    final Button button23 = new Button("");
    button11.addActionListener(null);

    final Button button31 = new Button("");
    button11.addActionListener(null);

    final Button button32 = new Button("");
    button11.addActionListener(null);

    final Button button33 = new Button("");
    button11.addActionListener(null);

    button11.setBounds(100, 100, 80, 70);
    button12.setBounds(100, 200, 80, 70);
    button13.setBounds(100, 300, 80, 70);
    button21.setBounds(200, 100, 80, 70);
    button22.setBounds(200, 200, 80, 70);
    button23.setBounds(200, 300, 80, 70);
    button31.setBounds(300, 100, 80, 70);
    button32.setBounds(300, 200, 80, 70);
    button33.setBounds(300, 300, 80, 70);

    frame1.add(button11); 
    frame1.add(button12); 
    frame1.add(button13); 
    frame1.add(button21); 
    frame1.add(button22); 
    frame1.add(button23); 
    frame1.add(button31); 
    frame1.add(button32);
    frame1.add(button33); 
}} 
```

我需要的是能够以某种方式利用听众。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:36:11.170

> 我将如何使它从不同的类文件中工作？

如果需要，请导入它，然后创建它的实例。

> 如何使用附加到按钮的动作监听器

将您希望执行的逻辑放在类（或子类）的`actionPerformed(ActionEvent e)`方法中。`ActionListener`

有关详细信息，请参阅[如何编写动作侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)。

# xcode - 将当前位置的距离添加到 NSMutableArray

> ID：11254189
> 
> 赞同：0
> 
> 时间：2012-06-28T23:14:15.570
> 
> 标签：xcode, ios5, cllocation

我正在尝试将我当前位置的距离加载到我的数组中，但我似乎遗漏了一些东西。我的 TableView 只显示“？”，它应该只显示我的 currentLoc 不工作，但我的 NSLog 显示正确的位置。请帮忙

更新：一定已经删除了我的重载 tableView，修复了“？”，但现在我只有 0.00 公里。仍然缺少一些东西。我的 currentLoc 在 LocationManager 中是正确的，但是当我尝试计算数组中的距离时我丢失了它。

```
#import "AuthorViewController.h"
#import "Author.h"
#import <sqlite3.h>

@implementation AuthorViewController
@synthesize theauthors;
@synthesize currentLoc;

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
currentLoc = newLocation;

if (newLocation.horizontalAccuracy <= 100.0f) {
    [locMgr stopUpdatingLocation];
}
NSLog(@"Lat: %f, Long: %f", currentLoc.coordinate.latitude, currentLoc.coordinate.longitude);

[self.tableView reloadData];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
NSString *msg = [[NSString alloc]initWithString:@"Error obtaining location"];
UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Error" message:msg delegate:nil cancelButtonTitle:@"Done" otherButtonTitles:nil];
[alert show];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
[self barList];
[super viewDidLoad];

NSLog(@"Lat2: %f, Long2: %f", currentLoc.coordinate.latitude, currentLoc.coordinate.longitude);
}

- (void)viewWillAppear:(BOOL)animated
{
[super viewWillAppear:animated];

locMgr = [[CLLocationManager alloc] init];
locMgr.delegate = self;
[locMgr startUpdatingLocation];
}

#pragma mark - Table view data source

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

// Return the number of rows in the section.
return [self.theauthors count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
int rowCount = indexPath.row;

Author *author = [self.theauthors objectAtIndex:rowCount];

cell.textLabel.text = author.barName;

if (currentLoc == nil) {
    cell.detailTextLabel.text = [NSString stringWithFormat:@"?"];
}else
{
    cell.detailTextLabel.text = [NSString stringWithFormat:@"%.02f km", author.cachedDist];
}

return cell;
}

-(NSMutableArray *) barList{
theauthors = [[NSMutableArray alloc] init];
@try {
    NSFileManager *fileMgr = [NSFileManager defaultManager];
    NSString *dbPath = [[[NSBundle mainBundle] resourcePath ]stringByAppendingPathComponent:@"TulsaBars.sqlite"];
    BOOL success = [fileMgr fileExistsAtPath:dbPath];
    if(!success)
    {
        NSLog(@"Cannot locate database file '%@'.", dbPath);
    }
    if(!(sqlite3_open([dbPath UTF8String], &db) == SQLITE_OK))
    {
        NSLog(@"An error has occured: %@", sqlite3_errmsg(db));

    }

    const char *sql = "SELECT * FROM  TulsaBars";
    sqlite3_stmt *sqlStatement;
    if(sqlite3_prepare(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK)
    {
        NSLog(@"Problem with prepare statement:  %@", sqlite3_errmsg(db));
    }else{

        while (sqlite3_step(sqlStatement)==SQLITE_ROW) {
            Author * author = [[Author alloc] init];
            author.barName = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,1)];
            author.barAddress = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,2)];
            author.barState = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 5)];
            author.barLat = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 8)];
            author.barLong = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 9)];
            author.cachedDist = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 10)];

            CLLocation *barLocation = [[CLLocation alloc] initWithLatitude:[author.barLat doubleValue] longitude:[author.barLong doubleValue]];
            CLLocationDistance distancekm = [currentLoc distanceFromLocation: barLocation]/1000;
            NSString *distanceString = [[NSString alloc] initWithFormat: @"%f", distancekm];
            author.cachedDist = distanceString;

            [theauthors addObject:author];
        }
    }
    sqlite3_finalize(sqlStatement);
}
@catch (NSException *exception) {
    NSLog(@"Problem with prepare statement:  %@", sqlite3_errmsg(db));
}
@finally {
    sqlite3_close(db);

    return theauthors;
}
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:23:08.483

一定要打电话`[tableView reloadData]`在需要重绘表格视图中的数据时调用。

您也可以尝试此答案中概述的扩展技术：[What's the best way to refresh a UITableView within a UINavigationController hierarchy](https://stackoverflow.com/questions/2661666/whats-the-best-way-to-refresh-a-uitableview-within-a-uinavigationcontroller-hie)

# c# - 动态创建和擦除对象

> ID：11254194
> 
> 赞同：2
> 
> 时间：2012-06-28T23:14:57.460
> 
> 标签：c#, wpf, object, collections

我正在编写一种图像处理程序，允许用户打开任意数量的图像。每次用户打开图像时，程序都必须为其创建一个对象，该对象由 MyClass 类定义。显然，当我在“打开图像”的方法中创建此对象时（例如单击菜单按钮文件-> 打开...），该对象仅在此方法中已知，对 UI 的其他方法无用。我可以在 UI 类中创建一个数组，然后将对象分配给 MyClass[i] 并继续计数 i，但这不是一个选项，因为我不知道用户想要打开多少张图像。此外，用户必须能够再次关闭图像，这意味着该索引 i 将无用。

有没有办法以某种方式拥有可以动态添加和删除对象的对象集合？对象必须能够通过文件名在此集合中识别自己。

我对 C# 很陌生，所以请尝试尽可能详细地解释所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:18:19.940

您可以将对象存储在`Dictionary<TKey,TValue>`. 在这种情况下，您可能需要`Dictionary<string, MyClass>`.

这将让您根据可能是文件名的*键*来查找和保留项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:19:10.020

您需要的是一个动态数据结构，如 List。

您可以使用通用（即列表）或非通用（即列表）版本。使用列表，您可以动态添加或插入项目，确定它们的索引并根据需要删除项目。

当您使用列表操作时，列表的大小会动态增长/缩小。

假设您的图像表示为 Image 类型的对象，那么您可以使用这样的 List ：

```
// instantiation of an empty list
List<Image> list = new List<Image>();

// create ten images and add them to the list (append at the end of the list at each iteration)
for (int i = 0; i <= 9; i++) {

    Image img = new Image();
    list.Add(img);
}

// remove every second image from the list starting at the beginning
for (int i = 0; i <= 9; i += 2) {

    list.RemoveAt(i);
}

// insert a new image at the first position in the list
Image img1 = new Image();
list.Insert(0, img1);

// insert a new image at the first position in the list
IMage img2 = new Image();
list.Insert(0, img2); 
```

使用字典的替代方法：

```
Dictionary<string, Image> dict = new Dictionary<string, Image>();

for (int i = 0; i <= 9; i++) {

    Image img = new Image();

    // suppose img.Name is an unique identifier then it is used as the images keys
    // in this dictionary. You create a direct unique mapping between the images name
    // and the image itself.
    dict.Add(img.Name, img);
}

// that's how you would use the unique image identifier to refer to an image
Image img1 = dict["Image1"];
Image img2 = dict["Image2"];
Image img3 = dict["Image3"]; 
```

# android - Android sdk 不允许下载 api 8 和 10

> ID：11254199
> 
> 赞同：1
> 
> 时间：2012-06-28T23:15:40.293
> 
> 标签：android, sdk

![在此处输入图像描述](../Images/5caf027b2ede2342a523690dff0b8df7.png)

android sdk 不允许我安装 api8 和 api10，因为没有下载 sdk 平台的选项。有没有办法解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T00:06:06.347

1.  试试你的 SDK 管理器 Packages->Reload
2.  从添加/删除程序中卸载 SDK。删除用户目录中的 .Android 目录。从头开始重新安装 SDK。

# android - 从android中的主题中删除图标？

> ID：11254201
> 
> 赞同：0
> 
> 时间：2012-06-28T23:15:57.390
> 
> 标签：android, icons, android-theme

我有一个带有图标和应用程序名称的全局主题。有一个要求，其中特定活动没有 icon 。我没有找到任何方法来单独删除该特定活动的操作栏顶部的图标。提前致谢

# c# - 使用 Mono 在 Windows 中构建 Mac .app 文件

> ID：11254203
> 
> 赞同：7
> 
> 时间：2012-06-28T23:17:08.840
> 
> 标签：c#, .net, macos, mono

我们有一个团队在 Mac 上使用 MonoDevelop 在 Mono 中构建了一个代理，我们希望在 Windows 中使用我们的本机和 C# 源代码的其余部分来构建它，但我似乎无法获得 msbuild 或 mono 在 Windows 上构建 .app 文件. 我收到不支持项目类型的错误。在 Mono 中创建的其他项目构建得很好，只是 .app 给我们带来了麻烦。

有没有人在 Windows 中成功构建 Mac/Mono .app 文件？或者是否有一个很好的替代 .app 文件在 Mac 上运行服务类型应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:18:33.907

尽管在 Windows 和 OSX 上都有 MonoDevelop，但您将无法在 Windows 中构建 .app - Windows 没有任何必需的库（您需要为 MonoDevelop 安装 XCode 才能在 OSX 中编译您的应用程序）

您可以在 Windows 中编译任何与 UI 无关的 DLL，然后将它们链接到 OSX 中的应用程序，但除非您需要从 Windows 或其他东西进行单元测试，否则这可能没有任何好处。Mono 项目专注于将 .NET 开发迁移到 OSX，而​​不是相反。

# selenium - 在 JUNIT 4 中运行 selenium 代码时出现 Null Ponter

> ID：11254205
> 
> 赞同：0
> 
> 时间：2012-06-28T23:17:28.987
> 
> 标签：selenium, webdriver

我正在尝试运行此代码，但我得到空指针异常。我正在使用 Junit 4.10 和 Selenium 2.24.1 JARS。

例外是在 @After " driver.quit(); "

当我在家中使用 Desktop 运行相同的代码时，它似乎工作正常。唯一的区别是我运行 Eclipse Indigo @ home 而我在这里运行 Eclipse Ganymede。但我不认为这应该是一个问题，除非我弄错了。

堆栈跟踪：在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect 的 framework.Ford.tearDown(Ford.java:36) 的 java.lang.NullPointerException。 DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at
org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)

谢谢。

```
public class Ford {

    static private WebDriver driver;
    static private String baseUrl;
    static private StringBuffer verificationErrors = new StringBuffer();

    @Before
    public void setUp() throws Exception {
        driver = new FirefoxDriver();
        baseUrl = "http://www.google.com/";
        driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
    }

    @Test
    public void testFord() throws Exception {
        driver.get(baseUrl + "/finance");
        driver.findElement(By.linkText("AA")).click();
        driver.findElement(By.id("gbqfq")).click();
        driver.findElement(By.id("gbqfq")).clear();
        driver.findElement(By.id("gbqfq")).sendKeys("f");
        driver.findElement(By.id(":1")).click();
    }

    @After
    public void tearDown() throws Exception {
        driver.quit();
        String verificationErrorString = verificationErrors.toString();
        if (!"".equals(verificationErrorString)) {
            fail(verificationErrorString);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:08:09.130

您可以在 tearDown() 方法中进行此更改后尝试吗？

```
@After
public void tearDown() throws Exception {
    if (driver != null)
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
        fail(verificationErrorString);
    }
} 
```

这可能会解决问题。

# wcf - WCF - 库命名约定

> ID：11254207
> 
> 赞同：0
> 
> 时间：2012-06-28T23:17:35.237
> 
> 标签：wcf

我有一些在 IIS 7 上的 Intranet 上运行的 WCF。

我想知道如何让它们保持整洁，一个选择是使用子域，例如

```
mailbox.wcf.myserver.com
location.wcf.myserver.com 
```

或者可能是每个 wcf 的特定服务器，

```
mailboxlibrary.myserver.com
locationlibrary.myserver2.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:43:47.260

您似乎在询问如何命名网络资源。这与 WCF 或任何其他可能托管您的 Web 资源的框架无关。

这是很有争议的，但在我看来，用于开发网络资源的技术不应该在该资源的 dns 名称中提及。

我宁愿根据它真正代表的内容命名网络资源。（mailboxservice.xxx.com 和 locationservice.xxx.com 听起来像是“好”的名字）

您是否还决定根据服务名称获取额外的服务器？这是错误的。（好像你有服务器要浪费。我会得到其中一台:)）

根据负载要求和网络限制来确定托管服务的位置。

如果您想使用单个主机，但希望每个服务的主机名看起来很花哨，您将需要一个 DNS 服务器（如果您的公司还没有）。只需设置正确的名称条目并将它们指向同一服务器。

[http://support.microsoft.com/kb/168322](http://support.microsoft.com/kb/168322)

# perl - if 语句中的相等未按预期工作

> ID：11254212
> 
> 赞同：-2
> 
> 时间：2012-06-28T23:18:09.143
> 
> 标签：perl

```
use Text::Diff;
my $count;
our $stats2 = 0;
for($count = 0; $count <= 1000; $count++){
    my $data_dir="archive/oswiostat/oracleapps.*dat";
    my $data_file= `ls -t $data_dir | head -1`;
    chomp($data_file);
    while(defined($data_file)){
        print $data_file;
        open (DAT,$data_file) || die("Could not open file! $!");
        my @stats1 = stat $data_file;
        my @raw_data=<DAT>;
        close(DAT);
        print "Stats1 is :$stats1[9]\n";
        sleep(5);
        print "Checking $stats1[9] equals $stats2\n";
        if(chomp($stats1[9]) != chomp($stats2)){
            print "I am here";
            my @diff = diff \@raw_data, $data_file, { STYLE => "Context" };
            print @diff || die ("Didn't see any updates $!");
        }
        $stats2 = $stats1[9];
        print "Stat2: $stats2\n";
    }
} 
```

输出

```
[oracle@oracleapps osw]$ perl client_socket1.pl
archive/oswiostat/oracleapps.localdomain_iostat_12.06.28.1900.datStats1 is :1340925244
Checking 1340925244 equals 0
Stat2: 1340925244
archive/oswiostat/oracleapps.localdomain_iostat_12.06.28.1900.datStats1 is :1340925298
Checking 1340925298 equals 1340925244
Stat2: 1340925298
archive/oswiostat/oracleapps.localdomain_iostat_12.06.28.1900.datStats1 is :1340925304
Checking 1340925304 equals 1340925298
Stat2: 1340925304
archive/oswiostat/oracleapps.localdomain_iostat_12.06.28.1900.datStats1 is :1340925304
Checking 1340925304 equals 1340925304
Stat2: 1340925304
archive/oswiostat/oracleapps.localdomain_iostat_12.06.28.1900.datStats1 is :1340925304 
```

如输出所示，当@stats1[9] 不等于 $stats2 时，它应该进入 if 循环并打印“我在这里”，但它不是那样工作的。你能找出问题所在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:20:54.867

这是你的问题：

```
if (chomp($stats1[9]) != chomp($stats2)) { 
```

应该

```
chomp($stats1[9]);
chomp($stats2);
if ($stats1[9] != $stats2) { 
```

并且

```
my @diff = diff \@raw_data, $data_file, { STYLE => "Context" }; 
print @diff || die ("Didn't see any updates $!"); 
```

应该

```
my $diff = diff \@raw_data, $data_file, { STYLE => "Context" }; 
print $diff || die ("Didn't see any updates $!"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:21:16.533

`chomp()`将字符串修改为副作用并返回它从字符串中删除的换行符，而不是修改后的字符串。你可能想写

```
chomp $stats1[9];
chomp $stats2;
if($stats1[9] != $stats2) { 
```

# java - php - 保存整个网页（HTML + CSS + Javascript）

> ID：11254214
> 
> 赞同：0
> 
> 时间：2012-06-28T23:18:14.370
> 
> 标签：java, php

假设我有这个网页网址

```
<html lang="en">
<head>
    <title>Newegg.com - HP ENVY 14-3010NR </title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script type="js/swfobject.v1.5.js"></script>
</head>
<body>
    <div id="message2OlderBrowser">
        <p>Newegg.com - A great place to buy computers</p>
        <p>If you are reading this message, </p>
        .
        .
        .
    </div>
    .
    .
    .
</body>
</html> 
```

我需要一个工具（用 PHP 或 java 编写）来调用函数

```
saveWebPage($url); 
```

结果我将拥有这些文件：

```
newegg.html
css/style.css
js/swfobject.v1.5.js 
```

有这样的工具或功能吗？

# r - R：在应用中使用示例函数的奇怪结果

> ID：11254225
> 
> 赞同：1
> 
> 时间：2012-06-28T23:19:52.107
> 
> 标签：r, simulation, sample, apply

我正在运行一个模拟，该模拟从一个以 1 列开始的矩阵中获取值样本。然后我将它们通过选择标准，然后从矩阵中的每一行中随机选择输出中的一个值并保存该随机选择。出于某种原因，当我`sample`在具有实数和 a 的行上应用矩阵时`NA`，它会返回一个甚至无法采样的数字。我可能对函数做错了`sample`，但我不明白这个未知值的来源。

示例代码：

```
theta <- c(30, 84, 159, 32, 60, 97)
omega <- 0.01
k <- 1
xn <- matrix(c(30, 84, 159, 32, 60, 97), ncol=1)

dup <- xn * 2 

set.seed(1)
z <- matrix(rbinom(n=rep(1,length(dup)),size = as.vector(dup),prob = 0.5),nrow = nrow(dup))            
z1 <- dup - z           
xn <- cbind(z, z1) # put both in a matrix
W <- exp( -(1/2)*( ( ( xn - theta ) / theta ) ^2 / omega ) )         

set.seed(1) 
Z <- matrix(rbinom(nrow(W) * ncol(W), 1, W), nrow=nrow(W), ncol=ncol(W) ) 
xn <- ifelse ( Z == 0, 0, xn )

xn
     [,1] [,2]
[1,]   32    0
[2,]   78    0
[3,]  144    0
[4,]    0   30
[5,]   60   60
[6,]   92  102 
```

我不想包含任何 0 值，所以我将它们更改为`NA`然后将`sample`函数应用于每一行以返回单个值。

```
xn[which(xn==0)] <- NA
set.seed(1)
xn2 <- matrix(apply(xn, 1, function(x){sample(x[!is.na(x)], size = k)}), ncol = k) 
```

我应该得到的是

```
xn
     [,1]
[1,]   32 
[2,]   78 
[3,]  144 
[4,]   30
[5,]   60
[6,]  102 
```

但我得到的是：

```
xn
     [,1]
[1,]   9
[2,]   30
[3,]   83
[4,]   24
[5,]   60
[6,]  102 
```

具体来说，在这个例子中，值 9、23、55 和 24 是从我所知道的无处出现的。

有谁知道我在拿这个样本时犯了什么错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:14:03.057

总结评论，

`?sample`说

> 如果 x 的长度为 1，是数字（在 is.numeric 的意义上）并且 x >= 1，则通过 sample 进行采样从 1:x 开始。

对于您的应用程序，当`x`长度为 1 时，您真的只想使用值`x`而不是`sample(x)`。您可以通过添加一个检查来调整您的代码，以查看长度`x`是否大于 1，然后再通过它`sample`

```
matrix(apply(xn, 1, function(x){
  if (length(x[!is.na(x)]) > 1) { 
    sample(x[!is.na(x)], size = k) 
  } else x[!is.na(x)] 
}), ncol=k)
     [,1]
[1,]   32
[2,]   78
[3,]  144
[4,]   30
[5,]   60
[6,]  102 
```

# c++ - C++11 正则表达式是否适用于 UTF-8 字符串？

> ID：11254232
> 
> 赞同：27
> 
> 时间：2012-06-28T23:20:54.017
> 
> 标签：c++, regex, unicode, utf-8, c++11

如果我想将 C++11 的正则表达式与 unicode 字符串一起使用，它们是否可以将 char* 作为 UTF-8 使用，还是必须将它们转换为 wchar_t* 字符串？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-29T03:32:20.150

您需要测试您的编译器和您正在使用的系统，但理论上，如果您的系统具有 UTF-8 语言环境，它将被支持。在 Clang/OS X 上，以下测试对我来说是正确的。

```
bool test_unicode()
{
    std::locale old;
    std::locale::global(std::locale("en_US.UTF-8"));

    std::regex pattern("[[:alpha:]]+", std::regex_constants::extended);
    bool result = std::regex_match(std::string("abcdéfg"), pattern);

    std::locale::global(old);

    return result;
} 
```

注意：这是在一个 UTF-8 编码的文件中编译的。

* * *

为了安全起见，我还使用了带有显式十六进制版本的字符串。它也起作用了。

```
bool test_unicode2()
{
    std::locale old;
    std::locale::global(std::locale("en_US.UTF-8"));

    std::regex pattern("[[:alpha:]]+", std::regex_constants::extended);
    bool result = std::regex_match(std::string("abcd\xC3\xA9""fg"), pattern);

    std::locale::global(old);

    return result;
} 
```

* * *

**更新** `test_unicode()`对我仍然有效

```
$ file regex-test.cpp 
regex-test.cpp: UTF-8 Unicode c program text

$ g++ --version
Configured with: --prefix=/Applications/Xcode-8.2.1.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.0.0 (clang-800.0.42.1)
Target: x86_64-apple-darwin15.6.0
Thread model: posix
InstalledDir: /Applications/Xcode-8.2.1.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T01:10:23.337

C++11 正则表达式将“与”UTF-8 “一起工作”，对于“工作”的最小定义。如果您想要对 UTF-8 字符串的“完整”Unicode 正则表达式支持，最好使用直接支持该功能的库，例如[http://www.pcre.org/](http://www.pcre.org/)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-29T20:46:32.880

是的，他们会的，这是 UTF-8 编码的设计。如果字符串被视为字节数组而不是代码点数组，则子字符串操作应该可以正常工作。

请参阅此处的常见问题解答 #18：[http](http://www.utf8everywhere.org/#faq.validation) ://www.utf8everywhere.org/#faq.validation ，了解如何在此编码设计中实现这一点。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-06-08T03:36:50.050

我有一个用例，在查找笛卡尔坐标时我需要处理*潜在*的 unicode 字符串，这个示例显示了我如何按照[建议](https://www.regular-expressions.info/stdregex.html)处理它， `std::wregex`并且`std::wstring`针对解析模块的*潜在unicode 字符。*

```
static bool isCoordinate(std::wstring token)
{   
    std::wregex re(L"^(-?[[:digit:]]+)$");
    std::wsmatch match;
    return std::regex_search(token, match, re);
}

int wmain(int argc, wchar_t * argv[])
{
    // Testing against not a number nor unicode designation
    bool coord = ::isCoordinate(L"أَبْجَدِيَّة عَرَبِيَّة‎中文"); 

    if (!coord)
        return 0;
    return 1;
} 
```

# servlets - 密钥库文件对 SSL 起什么作用？

> ID：11254235
> 
> 赞同：0
> 
> 时间：2012-06-28T23:21:00.107
> 
> 标签：servlets, security, keystore

完全是 SSL 的新手，我终于设法让我的应用程序使用 https 运行：

在我添加的tomcat服务器中

```
 <Connector port="8443"
    maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
enableLookups="true" disableUploadTimeout="true"
acceptCount="100" debug="0" scheme="https" secure="true"
    clientAuth="false" sslProtocol="TLS"
    keystoreFile="c:/keystore.key"
    keystorePass="mypassword" 
    SSLEnabled="true" /> 
```

在我的应用程序中我添加了

```
 <user-data-constraint>
          <transport-guarantee>CONFIDENTIAL</transport-guarantee> 
 </user-data-constraint> 
```

现在我的问题是，即使我从 c:\ 中删除了我使用以下命令生成的密钥库文件：

```
keytool -genkey -alias tomcat -keypass pass -keystore keystore.key -storepass pass 
```

我的应用程序仍然在 https 中运行？如果我有文件有什么区别？我真的说不出来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:40:29.300

私钥用于 SSL 握手的身份验证阶段，以签署您提供的证书。对等方通过证书的公钥验证签名。这证明您拥有该证书，因为只有您可以使用与其公钥对应的私钥对其进行签名，因为只有您拥有私钥，因为它是私有的。这是建立您的身份（即身份验证）的一部分。

如果服务器需要或想要客户端身份验证，SSL 客户端只需要私钥、证书、密钥库等。

服务器的私钥也用于生成共享密钥的初始阶段，而共享密钥又用于生成会话的会话密钥。数据由会话密钥加密。

# ios - 什么可能导致此代码不允许重新进入跳板？

> ID：11254236
> 
> 赞同：2
> 
> 时间：2012-06-28T23:21:13.573
> 
> 标签：ios, multithreading, asynchronous, nsurlconnection, nsoperation

我有一个应用程序可以一次将图像上传到一堆地方，有点像 Instagram 风格。

它设置有一个围绕一个异步`NSOperationQueue`运行一堆包装器。`NSOperation``NSURLConnection`

大多数以这种方式开始的问题都以“回调没有被调用，因为调用线程在它们返回之前加入。这**不是**那种问题。我*按*预期得到我的回调，但我也以某种方式阻止了应用程序当按下主页按钮时从后台开始。我一直认为由于沙盒，这根本无法被阻止，但不知何故我做到了。在操作运行时按下主页按钮将什么都不做，直到它们完成，在哪一点（20-30 秒后）应用程序正确背景。

**NB 这似乎只发生在单核处理器设备上。我只能在我的 iPhone 4 上重现，但不能在我的 4S 或 iPad 3 上重现。*

还是有兴趣？这是我的设置：

```
self.uploadQueue = [[NSOperationQueue alloc] init];
[self.uploadQueue setMaxConcurrentOperationCount:1];
[self.uploadQueue setSuspended:YES]; 
```

稍后，我将操作添加到队列中，然后将其取消挂起以启动。以下是这些`NSOperation`子类的一些代码：

```
- (BOOL)isConcurrent { return YES; }
- (BOOL)isExecuting { return self.executing; }
- (BOOL)isFinished { return self.finished; }

- (void)start {
    // Omitted: check for cancel...
    // Omitted: check if setup to run

    [self willChangeValueForKey:@"isExecuting"];
    self.executing = YES;
    [self didChangeValueForKey:@"isExecuting"];

    [self.sharer share];    
    CFRunLoopRun();
}

- (void)completeOperation {
    [self willChangeValueForKey:@"isFinished"];
    [self willChangeValueForKey:@"isExecuting"];
    self.executing = NO;
    self.finished = YES;
    [self didChangeValueForKey:@"isExecuting"];
    [self didChangeValueForKey:@"isFinished"];
    CFRunLoopStop(CFRunLoopGetCurrent());
} 
```

该`share`方法设置一个异步`NSURLConnection`并像这样触发它：

```
- (void)share {
    // Omitted: connection setup
    [NSURLConnection sendAsynchronousRequest:postRequest queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *responseData, NSError *error){
        // handle error or success, then call
        [self.currentOperation completeOperation];
    }]; 
```

除了我试图解决的副作用之外，代码的*工作原理*是它完成了它应该做的事情，回调被调用，线程只要需要就保持活动状态，并且操作队列只运行指定的一次操作数。

我尝试了什么？我试过了：

1.  在`[NSOperationQueue currentQueue]`. 这导致异步连接不回调该块。
2.  将每个 NSOperation 强制到`start`方法中的主线程上。这并没有解决问题，还导致代码有时无法工作并且 UI 有时会冻结。
3.  使用可变数组和 GCD 实现我自己的队列以进入正确的调度线程。无法让它工作。
4.  操作中的同步 NSURLConnections。我并没有真正尝试过，因为这不是我的选择。某些网络框架（例如 Facebook iOS SDK）没有同步选项。

在按下主页按钮之后，但在操作完成之前暂停执行不会产生任何有趣的结果。主线程上似乎没有任何东西在等待锁定或执行完成。

![主题 1](../Images/a0d003499513815495cb094df8c8e273.png)![线程 2](../Images/8719301e2c2c9fc4b47a629bc4f3e700.png)

我把它设置成一个完整的笨蛋吗？这里发生了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:26:33.873

编辑：

原来所有这些网络的东西都是一个红鲱鱼。这是一些循环的 CAAnimations 以某种方式阻止返回跳板。

原始猜测：

我的猜测：你不应该调用`CFRunLoopRun`你的 start 方法；并发操作的 start 方法预计在操作完成之前返回并稍后完成。您可能持有系统需要调度其他任务的一些 GCD 锁（线程？）。

如果你需要通过 独占一个线程`CFRunLoopRun`，你应该启动你自己的线程`start`然后返回。不过，我认为这会更容易，只是不使用 NSOperation 并从主线程启动您的（已经异步的）url 连接，在每个完成时保留一系列要共享的东西。

实际上，我认为问题在于`CFRunLoopStop(CFRunLoopGetCurrent())`：您正在*主线程*上运行它，所以您正在停止主运行循环！

# c - 套接字在 send() 上失去连接

> ID：11254238
> 
> 赞同：2
> 
> 时间：2012-06-28T23:21:18.100
> 
> 标签：c, sockets, winsock, minecraft, recv

**编辑：向下滚动以查看更新的代码。**

我想用 C 语言为 Minecraft 构建一个假播放器。

我的 Minecraft 服务器 (bukkit) 在我的本地 IP 192.168.1.141 上侦听端口 25565

当我启动我的应用程序时，（当它通过套接字发送数据时）bukkit 服务器说：“192.168.1.141:xxxxx 失去连接”，并且

我的申请告诉我：

```
socked created
socked connected
to send data = (smilie)kekos91;192.168.1.141:25565
to send length = 27
send !
response data = (a strange symbol)
response length = 1
socket disconnected 
```

也许这是因为 char-set ？有人知道为什么吗？这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <winsock2.h>

int main()
{
    char pseudo[] = "kekos91;192.168.1.141:25565";
    int pseudoLen = strlen(pseudo);

    char *packet = NULL;
    packet = (char*)malloc(3 + ((pseudoLen)*sizeof(char)*2));
    if(packet == NULL)
    {
        return -1;
    }
    memset(packet, '\0', sizeof(packet));
    packet[0] = (char)0x02;
    strcat(packet, pseudo);
    int pLenght = strlen(packet);

    char handshake[200];

    HANDLE hConsole;
    WSADATA wsaData;
    int iResult = 0;

    SOCKET serverSocket;
    sockaddr_in serverInfos;

    iResult = WSAStartup(MAKEWORD(2, 2), &wsaData);
    if (iResult != NO_ERROR) {
        printf("WSAStartup() failed with error: %d\n", iResult);
        return -1;
    }

    serverSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (serverSocket == INVALID_SOCKET) {
        printf("socket function failed with error: %i\n", WSAGetLastError());
        WSACleanup();
        return -1;
    }
    printf("socket created\n");

    serverInfos.sin_family = AF_INET;
    serverInfos.sin_addr.s_addr = inet_addr("192.168.1.141");
    serverInfos.sin_port = htons(25565);

    iResult = connect(serverSocket, (SOCKADDR *)&serverInfos, sizeof(serverInfos));
    if (iResult == SOCKET_ERROR)
    {
        printf("connect function failed with error: %i\n", WSAGetLastError());
        iResult = closesocket(serverSocket);
        if (iResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }
    printf("socket connected\n");

    printf("to send data = %s\n", packet);
    printf("to send length = %i\n", pseudoLen);
    Sleep(500); // after this point, the connection is loose :(
    if(send(serverSocket, (char*)packet , pLenght, 0) == SOCKET_ERROR)
    {
        printf("send function failed with error: %i\n", WSAGetLastError());
        iResult = closesocket(serverSocket);
        if (iResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }
    free(packet);

    printf("send !\n");

    if(recv(serverSocket, (char*)&handshake, 200, 0) == SOCKET_ERROR)
    {
        printf("recv function failed with error: %i\n", WSAGetLastError());
        iResult = closesocket(serverSocket);
        if (iResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }

    printf("response data = %s\n", handshake);      
    printf("response length = %i\n", strlen(handshake)); 

    iResult = closesocket(serverSocket);
    if (iResult == SOCKET_ERROR) {
        printf("closesocket function failed with error %i\n", WSAGetLastError());
        WSACleanup();
        return -1;
    }
    printf("socket disconnected.\n");

    WSACleanup();
    Sleep(5000);
    return 0;
} 
```

提前谢谢，请原谅我的英语不好:)

# 更新 ：

多亏了建设性的评论，现在一切正常。这是工作代码，您可以查看我的旧代码发生了什么。

```
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <winsock2.h>

int main()
{
    int iSocketResult = 0; // it will retrieve sockets return functions, like send / recv / errors

    wchar_t wcPseudo[] = L"kekos91;192.168.1.141:25565";
    int iPseudoLen = wcslen(wcPseudo);

    char *pPacket = NULL;
    pPacket = (char*)malloc(3 + ((iPseudoLen)*sizeof(char)*2));
    if(pPacket == NULL)
    {
        return -1;
    }
    pPacket[0] = 0x02;

    *(short*)( pPacket + 1 ) = htons( iPseudoLen );
    memcpy( pPacket + 3, wcPseudo, iPseudoLen * sizeof( wchar_t ));

    int iPacketLen = 3 + iPseudoLen*sizeof(wchar_t) ;    

    char *handshake  = NULL;
    handshake = (char*)malloc(sizeof(char)*200);
    if(handshake == NULL)
    {
        return -1;
    }

    HANDLE hConsole;
    WSADATA wsaData;        

    SOCKET serverSocket;
    sockaddr_in serverInfos;

    iSocketResult = WSAStartup(MAKEWORD(2, 2), &wsaData);
    if (iSocketResult != NO_ERROR) {
        printf("WSAStartup() failed with error: %d\n", iSocketResult);
        return -1;
    }

    serverSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (serverSocket == INVALID_SOCKET) {
        printf("socket function failed with error: %i\n", WSAGetLastError());
        WSACleanup();
        return -1;
    }

    printf("socket created\n");

    serverInfos.sin_family = AF_INET;
    serverInfos.sin_addr.s_addr = inet_addr("192.168.1.141");
    serverInfos.sin_port = htons(25565);

    iSocketResult = connect(serverSocket, (SOCKADDR *)&serverInfos, sizeof(serverInfos));
    if (iSocketResult == SOCKET_ERROR)
    {
        printf("connect function failed with error: %i\n", WSAGetLastError());
        iSocketResult = closesocket(serverSocket);
        if (iSocketResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }
    printf("socket connected\n\n");

    printf("to send protocol = %#1.2x \nlenght = %i\n", pPacket[0], iPseudoLen);

    iSocketResult = send(serverSocket, pPacket , iPacketLen, 0);
    if(iSocketResult == SOCKET_ERROR)
    {
        printf("send function failed with error: %i\n", WSAGetLastError());
        iSocketResult = closesocket(serverSocket);
        if (iSocketResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }
    free(pPacket);

    printf("send %i (bytes) !\n\n",iSocketResult);

    iSocketResult = recv(serverSocket, handshake, 50, 0);
    if( iSocketResult == SOCKET_ERROR)
    {
        printf("recv function failed with error: %i\n", WSAGetLastError());
        iSocketResult = closesocket(serverSocket);
        if (iSocketResult == SOCKET_ERROR)
        {
           printf("closesocket function failed with error: %i\n", WSAGetLastError());
        }
        WSACleanup();
        return -1;
    }

    printf("response protocol = %#1.2x\nresponse lenght = %i (bytes)\n\n", handshake[0], iSocketResult);
    free(handshake);    

    iSocketResult = closesocket(serverSocket);
    if (iSocketResult == SOCKET_ERROR)
    {
        printf("closesocket function failed with error %i\n", WSAGetLastError());
        WSACleanup();
        return -1;
    }
    printf("socket disconnected.\n");

    WSACleanup();
    Sleep(7000);
    return 0;
} 
```

输出控制台现在打印：

```
socket created
socket connected

to send protocol = 0x02 
lenght = 27
send 57 (bytes) !

response protocol = 0x02
response lenght = 37 (bytes)

socket disconnected. 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:59:59.543

一般来说，你所做的似乎是正确的。我想当您的测试代码关闭自己的套接字时，来自服务器的“连接丢失”消息会发生。但是，您似乎没有正确处理[字符串数据类型](http://www.wiki.vg/Data_Types)。该字符串需要以 Unicode 格式发送，并且您似乎将其作为单字节字符发送。此外，字符串前面需要以 2 字节整数表示的长度。

握手字符串应该改为使用 wchar_t （或您最喜欢的宽字符数据类型）指定如下。并在文字上使用 an`L`来指定一个宽字符串。以字节为单位的实际发送长度需要确保将字符串长度乘以 2。

wchar_t 伪 [] = L"kekos91;192.168.1.141:25565"; int pseudoLen = wcslen(伪);

然后，同样地，使用宽字符串函数来复制字符串（strcat 不起作用）。

要将字符串长度放在 0x02 协议代码之后的两个字节中，您可以这样做：

```
*((short*)( packet + 1 ) = htons( pseudolLen ); 
```

要将字符串复制到数据包中，也许是这个（我正在即时编写而不编译：

```
memcpy( packet + 3, pseudo, pseudoLen * sizeof( wchar_t )); 
```

以字节为单位的实际发送长度为： `3 + pseudoLen * sizeof( wchar_t )`

在打印结果响应时，您可能想要这样的东西：

```
printf( "Protocol response: %02x\n", handshake[0] ); 
```

然后提取字符串（协议字节后面的两个字节应该是连接哈希字符串的长度（按网络字节顺序）。所以你需要使用`ntohs`它来提取它。然后下面的N个宽字符将代表哈希.

写完所有这些，在我看来，您可能想要寻找一个库来处理所有协议。我没有看过，但似乎有一些与 Minecraft 相关的 C 套接字库可用。只是一个疯狂的猜测。 **编辑**再三考虑，这取决于您的目标。如果您只是想尽快构建客户端，那么寻找库绝对是有意义的。但是，如果您想了解协议、网络编程等的详细信息，那么在您开始的级别编写它是一个好主意，并且会很有趣，因为您可以逐步进行显示真实结果的步骤经常。

另一件事。`memset`分配内存后可能没有达到您的预期。假设是 32 位架构，则为`sizeof( packet )`4（它是一个 4 字节指针）。但是，由于您将使用数据填充数据包，因此 memset 并不是必需的。

# php - $_GET 在页面的某些区域不起作用

> ID：11254241
> 
> 赞同：2
> 
> 时间：2012-06-28T23:21:28.783
> 
> 标签：php, variables, get, constants

所以我的页面在页面的不同部分有很多包含调用。其中大多数包括具有某种获取任何 $_GET 变量的函数。所有这些都可以正常工作，除了我的导航文件在我尝试获取任何 GET 变量时不返回任何内容。

导航.php

```
<? require_once("config.php"); require_once("functions.php"); ?>

<div id="nav">

    <ul>

        <? initializeMainNav( $_GET['page'] ); ?>

    </ul>

</div> 
```

在function.php里面

```
function initializeMainNav( $curPage )
{

    // array ( slug, name ) of navigation items

    $nav = array(
        array( "", "Home" ),
        array( "case_studies", "Investment Case Studies" ),
        array( "current_inv", "Current Investments" ),
        array( "about", "About MDIG" ),
        array( "management", "Management" ),
        array( "news", "News" ),
        array( "services", "Services" ) );

    // Print out each nav item, and highlight the current page nav item

    for( $i = 0; $i < count( $nav ); $i++ ) {

        echo "  <li><a ";

        if( $nav[$i][0] == $curPage )
            echo "class=\"active\" ";

        echo "  href=\"?page=" . $nav[$i][0] . "\">" . $nav[$i][1] . "</a></li> ";

    }

} 
```

$_GET['page'] 总是返回空，即使它适用于页面的所有其他部分。你们看到我做错了什么吗？

编辑：

index.php 其中`HEADER`是定义路径的常量 var，位于`config.php`

```
<? require_once("config.php"); require_once("functions.php"); ?>

<? include(HEADER); ?>

<body>

    <div id="wrapper">

        <div id="logo"> 
            <a href="<? echo DOMAIN; ?>"><img src="<? echo IMAGES; ?>/logo.png" alt="<? echo COMPANY; ?>"></a>
        </div>

        <div class="clear"></div>

        <? include(NAV); ?>

        <div id="content_wrapper">

            <!-- Find and display appropriate page -->
            <? displayPage( $_GET['page'] ); ?>

        </div>

        <div class="clear"></div>

        <? include(FOOTER); ?>

    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:41:17.060

我知道这并不一定会给你关于它为什么不起作用的答案，但是像下面这样的东西怎么样：

函数.php

```
function echoMainNav($curPage)
{
   echo '<div id="nav"><ul>';
   echo initializeMainNav( $curPage );
   echo '</ul></div>';
} 
```

某页.php

```
<? require_once("config.php"); require_once("functions.php"); ?>

<? include(HEADER); ?>

<body>

    <div id="wrapper">

        <div id="logo"> 
            <a href="<? echo DOMAIN; ?>"><img src="<? echo IMAGES; ?>/logo.png" alt="<? echo COMPANY; ?>"></a>
        </div>

        <div class="clear"></div>

        <? echoMainNav( $_GET['page'] ); ?>

        <div id="content_wrapper">

            <!-- Find and display appropriate page -->
            <? displayPage( $_GET['page'] ); ?>

        </div>

        <div class="clear"></div>

        <? include(FOOTER); ?>

    </div>

</body>
</html> 
```

或者更好：

模板.php

```
define('TEMPLATES_MAIN_NAV', '<div id="nav"><ul>%s</ul></div>'); 
```

函数.php

```
function getMainNav($curPage)
{
   return sprintf(TEMPLATES_MAIN_NAV, initializeMainNav( $curPage ) );
} 
```

某页.php

```
<?= getMainNav($_GET['page']); ?> 
```

# ios - 调用和显示 NSString

> ID：11254244
> 
> 赞同：0
> 
> 时间：2012-06-28T23:22:02.937
> 
> 标签：ios, nsstring, nslog

你好，我相信你们都可以回答这个问题，但它让我很烦，因为我很愚蠢。

我有一个数组，可以存储`didSelectRowAtIndexPath`行，然后存储 NSLog formatSelected。然后我弹出视图控制器并将 formatSelected 显示为按钮标题。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    NSString *formatSelected = [[NSString alloc]init];
    formatSelected:[format objectAtIndex:indexPath.row];
    NSLog(@"this is the format selected %@",formatSelected);
    [button2 setTitle:[format objectAtIndex:indexPath.row] forState:UIControlStateNormal];
    [navigationControler popViewControllerAnimated:YES];
} 
```

这很好用。

我的问题是，在新标题按钮所在的上一个视图中，我有另一个按钮和一个标签。

我希望能够按下第二个按钮并在标签或 NSLog 中显示 formatSelected String

```
-(IBAction)printResults{
NSString *fmat = [[NSString alloc]initWithFormat:@"%@",formatSelected];
NSLog(@"%@",fmat);
    NSLog(@"nslong button pressed");} 
```

但是 NSLog 只显示（空）？

我有`@property (nonatomic, retain) NSString *formatSelected;`并合成了它。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:40:44.267

您`formatSelected`在方法中声明为局部变量`tableView:didSelectRowAtIndexPath:`。在方法退出后，您在此方法中分配的任何内容都`formatSelected`将不再可访问。您正在将所选格式分配给此局部变量，而不是您的属性（及其相应的实例变量）。

完全使用`[self setFormatSelected:[format objectAtIndex:indexPath.row]];`和删除`NSString *formatSelected...`线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:27:55.203

您几乎总是希望使用`copy`NSString *，而不是`retain`. 有关更多信息，请参阅此答案：[NSString 属性：复制还是保留？](https://stackoverflow.com/questions/387959/nsstring-property-copy-or-retain)

# python - 有效地累积稀疏 scipy 矩阵的集合

> ID：11254248
> 
> 赞同：8
> 
> 时间：2012-06-28T23:22:45.190
> 
> 标签：python, optimization, numpy, scipy, sparse-matrix

我有一个 O(N) NxN 的集合`scipy.sparse.csr_matrix`，每个稀疏矩阵都有 N 个元素集的顺序。我想将所有这些矩阵加在一起以获得常规的 NxN numpy 数组。（N 大约为 1000）。矩阵中非零元素的排列使得结果总和肯定不是稀疏的（实际上实际上没有零元素）。

目前我只是在做

```
reduce(lambda x,y: x+y,[m.toarray() for m in my_sparse_matrices]) 
```

这可行，但有点慢：当然，在那里进行的大量无意义的零处理绝对是可怕的。

有没有更好的办法 ？[文档](http://docs.scipy.org/doc/scipy/reference/sparse.html)中对我来说没有什么明显的。

**更新：**根据 user545424 的建议，我尝试了对稀疏矩阵求和的替代方案，并将稀疏矩阵求和到密集矩阵上。下面的代码显示了在可比时间内运行的所有方法（amd64 Debian 上的 Python 2.6.6/四核 i7 上的 Squeeze）

```
import numpy as np
import numpy.random
import scipy
import scipy.sparse
import time

N=768
S=768
D=3

def mkrandomsparse():
    m=np.zeros((S,S),dtype=np.float32)
    r=np.random.random_integers(0,S-1,D*S)
    c=np.random.random_integers(0,S-1,D*S)
    for e in zip(r,c):
        m[e[0],e[1]]=1.0
    return scipy.sparse.csr_matrix(m)

M=[mkrandomsparse() for i in xrange(N)]

def plus_dense():
    return reduce(lambda x,y: x+y,[m.toarray() for m in M])

def plus_sparse():
    return reduce(lambda x,y: x+y,M).toarray()

def sum_dense():
    return sum([m.toarray() for m in M])

def sum_sparse():
    return sum(M[1:],M[0]).toarray()

def sum_combo():  # Sum the sparse matrices 'onto' a dense matrix?
    return sum(M,np.zeros((S,S),dtype=np.float32))

def benchmark(fn):
    t0=time.time()
    fn()
    t1=time.time()
    print "{0:16}:  {1:.3f}s".format(fn.__name__,t1-t0)

for i in xrange(4):
    benchmark(plus_dense)
    benchmark(plus_sparse)
    benchmark(sum_dense)
    benchmark(sum_sparse)
    benchmark(sum_combo)
    print 
```

并注销

```
plus_dense      :  1.368s
plus_sparse     :  1.405s
sum_dense       :  1.368s
sum_sparse      :  1.406s
sum_combo       :  1.039s 
```

尽管您可以通过弄乱 N、S、D 参数来使一种或另一种方法领先 2 倍左右......但没有什么比您希望通过考虑数字看到的数量级改进零添加应该可以跳过。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:37:20.247

如果您的矩阵非常稀疏，我想我已经找到了一种将其加速约 10 倍的方法。

```
In [1]: from scipy.sparse import csr_matrix

In [2]: def sum_sparse(m):
   ...:     x = np.zeros(m[0].shape)
   ...:     for a in m:
   ...:         ri = np.repeat(np.arange(a.shape[0]),np.diff(a.indptr))
   ...:         x[ri,a.indices] += a.data
   ...:     return x
   ...: 

In [6]: m = [np.zeros((100,100)) for i in range(1000)]

In [7]: for x in m:
   ...:     x.ravel()[np.random.randint(0,x.size,10)] = 1.0
   ...:     

        m = [csr_matrix(x) for x in m]

In [17]: (sum(m[1:],m[0]).todense() == sum_sparse(m)).all()
Out[17]: True

In [18]: %timeit sum(m[1:],m[0]).todense()
10 loops, best of 3: 145 ms per loop

In [19]: %timeit sum_sparse(m)
100 loops, best of 3: 18.5 ms per loop 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T22:47:43.470

@user545424 已经发布了可能是最快的解决方案。具有相同精神的东西更具可读性和〜相同的速度...... **[nonzero()](http://docs.scipy.org/doc/numpy/reference/generated/numpy.nonzero.html)**具有各种有用的应用程序。

```
def sum_sparse(m):
        x = np.zeros(m[0].shape,m[0].dtype)
        for a in m:
            # old lines
            #ri = np.repeat(np.arange(a.shape[0]),np.diff(a.indptr))
            #x[ri,a.indices] += a.data
            # new line
            x[a.nonzero()] += a.data
        return x 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:22:09.337

您不能在转换为密集矩阵之前将它们加在一起吗？

```
>>> sum(my_sparse_matrices[1:],my_sparse_matrices[0]).todense() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T14:31:05.050

这不是一个完整的答案（我也希望看到更详细的回复），但您可以通过不创建中间结果来获得两个或更多改进的简单因素：

```
def sum_dense():
    return sum([m.toarray() for m in M])

def sum_dense2():
    return sum((m.toarray() for m in M)) 
```

在我的机器（YMMV）上，这是最快的计算。通过将求和放在 a`()`而不是 a`[]`中，我们在求和之前构造了一个生成器而不是整个列表。

# google-maps-api-3 - 是否可以在 Google 地图 API v3 中限制可编辑形状的尺寸/面积，以便无法将其绘制为大或小？

> ID：11254261
> 
> 赞同：4
> 
> 时间：2012-06-28T23:24:40.417
> 
> 标签：google-maps-api-3

我希望能够在 Google 地图上绘制形状（圆形、多边形和矩形），但我想限制可以绘制的形状的大小（面积）。因此，以圆圈为例，期望的行为是当用户开始从地图上的某个点拖动鼠标以形成圆圈时，圆圈会碰到一个不可见的边界并停止扩展。

我将定义*大小/面积*定义为它所覆盖的地理区域。理想情况下，我希望能够规定形状覆盖的地理区域的限制。因此，在圆形示例中，我可以指定圆形在其覆盖的地理区域达到（例如 10 平方公里）时停止扩展，而不管视口缩放级别如何。

我不知道这将如何用于绘制多边形，但我确信它有点复杂，因为多边形是分阶段绘制的（多次点击）......但一次一步。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-10T18:18:48.180

这是我可以为圆形场景提出的最佳解决方案。请注意，这不会在编辑圆时明确停止调整大小，但一旦用户释放调整大小，圆就会恢复到允许的最大大小。

根据上面的 chrismarx 和 zeusakm 注释，可能并不理想，但谷歌的 api 似乎没有任何本地方式可以在用户调整大小时设置严格的大小边界。

```
var shapeOptions = {
  fillColor: '#ff0000',
  fillOpacity: 0.50,
  map: map, // your map
  center: curLocation, // geo starting point
  draggable: true,
  editable: true,
  radius: 30 // initial circle radius in meters
};

// Add the circle to the map.
newCircle = new google.maps.Circle(shapeOptions);

var maxRadius = 100; // whatever max size you want to dictate

google.maps.event.addListener(newCircle,'radius_changed',function(){
    if (this.getRadius() > maxRadius) {
        this.setRadius(maxRadius);
    }
}); 
```

如果你想创建完全自定义的东西，这个解决方案也可能有用： [如何在谷歌地图上画圆时知道半径](https://stackoverflow.com/questions/30368231/how-to-know-radius-while-drawing-a-circle-on-google-maps)

# c++ - C ++记分牌困难时期

> ID：11254262
> 
> 赞同：0
> 
> 时间：2012-06-28T23:24:48.670
> 
> 标签：c++, sorting

大家好，stackoverflow 的人，这真的很难，它一直在折磨我的大脑。我必须做的是，一个多人服务器端的记分牌。基本上有 10 个客户端连接到我的服务器应用程序，在此事件期间，每次一个玩家杀死另一个玩家他的杀戮都会增加，每个连接到服务器的玩家都有一个类指针

```
class CUser
{
(...)
    public:
    unsigned m_uEventKills;
    unsigned m_uEventDeaths;
(...)
}; 
```

每次有人杀死某人时 m_uEvenKills 都会增加，而死亡玩家的 m_uEventDeaths 也会增加。想象玩家 a,b,c,d,e,f 他们每个人都有随机击杀（a,b,c,d... 是指向 CUser 的指针）所以：

```
a->m_uEventKills is 72
b->m_uEventKills is 13
c->m_uEventKills is 2
d->m_uEventKills is 44
e->m_uEventKills is 21
f->m_uEventKills is 33 
```

和死亡的随机值。

我有这个：

```
int nMax[10];

void OrganizeMax()
{
    memset( &nMax, 0, sizeof( nMax ));
    (...) 
```

组织max必须填充nMax，从0到9（10个顶级用户）从所有连接用户（他们都拥有指向CUser的指针）中读取->m_uEventKills，并将杀死最多的那个设置为nMax[0]，设置为nMax[ 1] 杀死最多的第二个，到 nMax[2] 杀死最多的第三个等等......关于如何做到这一点的任何绝妙想法？

-编辑

我会更简单，我有 10 个变量。

```
int a,b,c,d,e,f,g,h,i,j;
a = 3;
b = 61;
c = 29;
d = 44;
e = 12;
f = 8;
g = 27;
h = 11;
i = 0;
j = 4; 
```

我需要将这些变量插入

```
int nHold[10]; 
```

按降序排列，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:31:04.883

第一个绝妙的主意：避免使用原始的 C 样式数组，它们几乎不会为您进行错误检查...无法动态调整大小...即使您正确使用它们，在性能方面也不会真正帮助您。

（[std::vector](http://www.cplusplus.com/reference/stl/vector/)很好，如果你觉得必须的话， [std::array ）。](http://en.cppreference.com/w/cpp/container/array)

第二个绝妙的想法：使用已经编写好的排序算法，例如[std::sort](http://www.cplusplus.com/reference/algorithm/sort/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T23:33:17.780

我不使用`a`, `b`... `f`，而是使用`std::vector`of `CUser`（顺便说一句，我不喜欢`CUser`作为类名）：

```
std::vector<CUser> users; 
```

如果这是您关心的*唯一*`CUser`用户顺序，我会将顺序定义为类的一部分：

```
class CUser { 

    // ...
    bool operator<(CUser const &other) const { 
         return m_uEventKills < other.m_uEventKills;
    }
}; 
```

然后，当您需要将用户排序为正确的顺序时，您可以执行以下操作：

```
std::sort(users.begin(), users.end()); 
```

但是，您可能需要在类中添加一个 ID 号（或类似的东西）来`CUser`跟踪哪个用户是哪个用户，而不管他们目前的排列顺序如何。

编辑：

要按升序获取`int`a...j 中 s的值`nHold`，您可能只想按现有顺序插入它们，然后排序：

```
nHold[0] = a;
nHold[1] = b;
//...
nHold[9] = j;

std::sort(nHold, nHold+9); 
```

# c++ - 在 Visual Studio 项目中创建包含文件夹和 Lib 文件夹

> ID：11254264
> 
> 赞同：2
> 
> 时间：2012-06-28T23:24:58.933
> 
> 标签：c++, visual-studio-2010, visual-c++

当我从 Internet 下载 lib 或安装 sdk 时，它看起来是一种通用方法，它们包含一个包含包含和 lib / bin 文件夹的文件夹。

多年来，我创建了几个 Visual Studio 项目，c# 或 vc++，我想知道人们在做这些项目时是如何发布他们的库的。它发现将库放在 lib 文件夹中并将 exe 放在 bin 文件夹中非常简单。

是否有任何简单的方法可以让 Visual Studio 知道包含文件夹中应该包含哪些头文件，然后在构建时创建它，或者我应该手动维护这个文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T07:03:05.380

您可以在构建后制作自己的宏`Visual Studio`。检查项目设置[中的构建后事件宏框](http://msdn.microsoft.com/en-us/library/42x5kfw4%28v=vs.80%29.aspx)。您还可以使用脚本语言`PERL`来处理构建和构建后事件。我实际上更喜欢第二种方法，因为它提供了更大的灵活性。

# ios - 将 force_load 链接器标志与 RestKit (iOS) 一起使用

> ID：11254269
> 
> 赞同：14
> 
> 时间：2012-06-28T23:25:54.487
> 
> 标签：ios, xcode, facebook, amazon-web-services, restkit

我正在使用 Facebook iOS 开发工具包、AWS iOS 开发工具包和 RestKit。为了让 Facebook 和 AWS 玩得更好（有重复的符号），我不得不将我的*其他链接器标志*更改为`-force_load facebook-ios-sdk/lib/facebook-ios-sdk/libfacebook_ios_sdk.a`. 现在，当我运行我的应用程序时，我收到了这个与 RestKit 相关的错误：

> 2012-06-28 15:55:15.336 MyApp[1640:707]-[__NSCFString isIPAddress]：无法识别的选择器发送到实例 0x35f440
> 
> 2012-06-28 15:55:15.338 MyApp [1640:707] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFString isIPAddress]：无法识别的选择器发送到实例 0x35f440”

我不能使用`-ObjC`和`all-load`链接器标志，因为这会阻止我使用 Facebook 和 AWS 进行构建。

有谁知道我应该如何设置我的链接器标志，以便我可以一起使用所有 3 个（FB、AWS、RestKit）？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T00:49:02.903

切耶！我想到了。标志应设置为

```
-force_load facebook-ios-sdk/lib/facebook-ios-sdk/libfacebook_ios_sdk.a -force_load $(BUILT_PRODUCTS_DIR)/libRestKit.a 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T08:21:04.110

使用适用于 iOS 的新 Facebook SDK 3.0 时，链接器标志与之前回答的略有不同。我不得不说：

```
-force_load /path/to/FacebookSDK/FacebookSDK.framework/FacebookSDK -force_load $(BUILT_PRODUCTS_DIR)/libRestKit.a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-31T11:18:01.143

我过去一直在努力解决这个问题。可可豆荚似乎在这里简化了一些事情。我的路径看起来像这样，我可以成功构建：

```
-ObjC -l"Pods-AFNetworking" -l"Pods-AWSiOSSDKv2" -l"Pods-FMDB" -l"Pods-GZIP" -l"Pods-ISO8601DateFormatterValueTransformer" -l"Pods-Mantle" -l"Pods-RKValueTransformers" -l"Pods-Reachability" -l"Pods-RestKit" -l"Pods-SOCKit" -l"Pods-STTwitter" -l"Pods-SWRevealViewController" -l"Pods-TMCache" -l"Pods-TransitionKit" -l"Pods-UICKeyChainStore" -l"Pods-XMLDictionary" -l"sqlite3" -l"z" -framework "Accounts" -framework "CFNetwork" -framework "CoreData" -framework "CoreGraphics" -framework "Foundation" -framework "MobileCoreServices" -framework "QuartzCore" -framework "Security" -framework "SystemConfiguration" -framework "Twitter" -framework "UIKit" -weak_framework "Social" -weak_framework "UIKit" 
```

请注意，为了消除重复的符号，我必须删除对 Bolts 的链接引用的引用...

```
-l"Pods-Bolts" 
```

被取出。我猜是因为 Facebook 已经以某种方式包含了它……

# java - m4p读写

> ID：11254272
> 
> 赞同：0
> 
> 时间：2012-06-28T23:26:17.440
> 
> 标签：java, audio, file-io

我正在专门研究制作一个程序来查找歌曲的歌词并将其添加到其中。然而，我一直在寻找一种从文件中提取歌曲和艺术家姓名的方法，以及如何将歌词写入文件。我在想一定有某种方式来存储它我假设它是某种类型的数组但我没有遇到任何东西

谁能帮我指出正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:53:11.043

正如 qrtt1 所建议的，您想要的信息可能在文件的元标记中。幸运的是，有几个图书馆可以帮助解决这个问题。[不过， Jaudiotagger](http://www.jthink.net/jaudiotagger/)似乎相当受欢迎。

> Jaudiotagger 是 Jaikoz 使用的音频标记库，用于标记音频文件中的数据。它目前完全支持 Mp3、Mp4（Mp4 音频、M4a 和 M4p 音频）Ogg Vorbis、Flac 和 Wma，对 Wav 和 Real 格式的支持有限。

# spring.net - Spring.NET 在使用 ASP.NET MVC 4 时为每个命中创建新的 MvcApplicationContext

> ID：11254278
> 
> 赞同：0
> 
> 时间：2012-06-28T23:27:05.313
> 
> 标签：spring.net

我一直在玩 Spring.NET 2.0.0M1 对 ASP.NET MVC4 的支持。虽然很有希望，但我认为我遇到了一个关键问题：为每个命中创建一个新的 MvcApplicationContext（使用 MVC4 的 WebApi 时）。虽然我相信这样做的目的是支持额外的范围，但我到目前为止所做的调试表明，新的 MvcApplicationContext 是使用整个应用程序的 WebApplicationContext 作为父 ApplicationContext 创建的，并被赋予与父级相同的配置位置。因此，这个新的子 MvcApplicationContext 加载相同的配置位置并重新创建所有对象，包括所有单例，并且从不委托给父上下文。这有效地使单例无法使用，并有效地将所有内容绑定到请求范围（或更低）。

创建新 MvcApplicationContext 的相关代码现在是 master 中 Spring.Web.Mvc4/SpringWebApiDependencyResolver.cs 的第 43 到 52 行。

我没有足够的 Spring.NET 经验来知道正确的修复/解决方法是什么，但如果有人有想法，我愿意尝试。如果同意这是一个错误，我很乐意提出一个问题。

我可能最终犯了一个错误，但我已经将它与样本进行了比较，并没有发现明显的问题。

# objective-c - 用于本地实例化和作用域变量的 OCUnit 或 OCmock 测试方法。

> ID：11254279
> 
> 赞同：1
> 
> 时间：2012-06-28T23:27:10.227
> 
> 标签：objective-c, ocunit, ocmock

我是 OCUnit 和 OCMock 的新手，想了解更多关于这种测试方法的信息。

我知道 OCUnit 和 OCMock 创建存根生成模拟对象等的能力......

我有一个特殊的用例，我还不能破解。

```
-(bool) isGameCenterAvailable
{
    // Check for presence of GKLocalPlayer API.
    Class gcClass = (NSClassFromString(@"GKLocalPlayer"));

    // The device must be running running iOS 4.1 or later.
    bool isIPAD = [[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad;
    NSString *reqSysVer = (isIPAD) ? @"4.2" : @"4.1";
    NSString *currSysVer = [[UIDevice currentDevice] systemVersion];
    BOOL osVersionSupported = ([currSysVer compare:reqSysVer options:NSNumericSearch] != NSOrderedAscending);

return (gcClass && osVersionSupported);
} 
```

这是我对单元测试的问题：

1) NSClassFromString(@"GKLocalPlayer") 是对foundation.h 的调用，我知道它无法存根。

2) [[UIDevice currentDevice] systemVersion] 是函数作用域的本地调用。我的方法调用另一个类（UIDevice）中的方法我想用存根覆盖他们的函数调用，以返回一个固定的答案来练习这个函数的每个路径。

如果在被测函数的范围内实例化类，则不确定是否可以模拟类。

此外，如何测试 #1 之类的 Class 方法。

重构是这里唯一的答案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:53:27.860

对于 #1，您可以创建一个检查`GKLocalPlayer`API 的方法：

```
-(BOOL)isGKLocalPlayerSupported {
    return (NSClassFromString(@"GKLocalPlayer")) != nil;
} 
```

然后你可以模拟那个方法。如果您在被测类中创建方法，则可以使用部分模拟：

```
-(void)testIsGameCenterAvailable {
    // create gameCenterChecker instance to test...

    id mockChecker = [OCMockObject partialMockForObject:gameCenterChecker];
    BOOL supported = YES;
    [[[mockChecker stub] andReturnValue:OCMOCK_VALUE(supported)] isGKLocalPlayerSupported];

    expect([gameCenterChecker isGKLocalPlayerSupported]).toBeTruthy();
} 
```

根据您的项目，将其放在实用程序类中可能更有意义，在这种情况下，您将模拟该实用程序：

```
-(void)testIsGameCenterAvailable {
    id mockUtility = [OCMockObject mockForClass:[MyUtility class]];
    [MyUtility setSharedInstance:mockUtility];
    BOOL supported = YES;
    [[[mockUtility stub] andReturnValue:OCMOCK_VALUE(supported)] isGKLocalPlayerSupported];

    // create gameCenterChecker instance to test...

    expect([gameCenterChecker isGKLocalPlayerSupported]).toBeTruthy();
} 
```

您可以对系统版本和设备采取相同的方法：

```
-(NSString *)systemVersion;
-(BOOL)isIpad; 
```

# php - PHP 数组键与自身不匹配

> ID：11254282
> 
> 赞同：0
> 
> 时间：2012-06-28T23:27:17.137
> 
> 标签：php, arrays

我有一个相当复杂的 PHP 应用程序，但 XDebug 帮助我将问题追踪到了一个我不再了解 PHP 的地步。我试图详细说明问题的相关核心。

有一个类层次结构 ModelCore->Model->LMC->MC。在 LMC 中有一个 insert() 方法，它具有以下代码行：

```
if($this->createEntry($mKey)) return $this->getEntry($mKey); 
```

该`getEntry`方法也在 LMC 中定义：

```
function getEntry($mKey){
   if(array_key_exists($mKey, $this->aItemList) || $this->createEntry($mKey)) return $this->aItemList[$mKey];
   return false;
} 
```

`createEntry`在 LMC 中是抽象的，在 MC 中定义：

```
function createEntry($mKey){
   if(array_key_exists($mKey, $this->aItemList) && ($this->aItemList[$mKey] instanceof LCI))
      return false;
   $this->aItemList[$mKey] = new $this->sItemClass($this,$mKey,(!array_key_exists($mKey,$this->aData))? LCI::Appended : LCI::Unread);
   return ($this->aItemList[$mKey] instanceof LCI);
} 
```

LCI 是与上面显示的树无关的另一个类。`sItemClass`是 LCI 的适当子类。那么发生了什么？

`createEntry`应该返回`false`，如果`$this->aItemList`已经有相同键的条目，它是 LCI 类型的。否则它将创建这样一个条目。考虑到显示的第一行，`getEntry`只有在已创建此类条目且类型正确时才会调用。然而，其中的条件没有找到条目并且可以重新创建条目，这当然不会导致数组中的第二个条目。

测试中使用的键值是`16`通过`floatval`.

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T09:21:08.823

感谢 John Green，我将数据库的键更改为字符串，并且效果很好。事实上，我正在寻找另一个问题。MC 是一个模型，并作为对视图的引用传递。在一天结束时，对于最初构建的模型和视图中保存的引用，我在 MC->aItemList[16] 中有不同的 LCI 实例值。事实上，LCI 是在没有任何数据的情况下构建的，考虑到 CTOR，这应该是不可能的。但是这个问题也消失了。

得到教训：

*   在 PHP 中检查浮点数是否相等似乎比通常更麻烦（之前从未见过`$a != $a`，任何地方！）
*   使用浮点数时的结果`array_key_exists()`可能与索引访问不一致`[]`
*   使用浮点数作为数组索引可能会产生超出简单错误关联和超出想象的副作用

感谢您检查代码并排除不可能揭示真相的可能性，无论它看起来多么不可能。

# c++ - 使用 pugixml 使用 C++ 解析数据但无法获取所有节点属性

> ID：11254286
> 
> 赞同：0
> 
> 时间：2012-06-28T23:28:13.633
> 
> 标签：c++, xml, xml-parsing, pugixml

我制作了一个解析函数的代码，但它不会解析参数（名称，类型）我的代码：

```
xml_node GCC_XML = doc.child("GCC_XML");

{

for (xml_node Function = GCC_XML.child("Function");Function; Function= Function.next_sibling("Function"))
{    
    cout<<"Function\n"<<"id= "<<Function.attribute("id").value()<<" , name= "<<Function.attribute("name").value()<<" ,returns: "<<Function.attribute("returns").value()<<Function.child_value("Argument") <<endl;

}

} 
```

那是我要解析的 XML 文件

```
<?xml version="1.0"?>
<GCC_XML>
  <Namespace id="_1" name="::" members="_2 _3 _4 "/>
  <Function id="_2" name="main" returns="_5" context="_1" location="f0:8"/>
  <Function id="_3" name="a_function" returns="_5" context="_1" location="f0:4">
    <Argument name="f" type="_6"/>
    <Argument name="e" type="_4"/>
  </Function>
  <Struct id="_4" name="EmptyClass" context="_1" location="f0:1" members="_7 _8 " bases=""/>
  <FundamentalType id="_5" name="int"/>
  <FundamentalType id="_6" name="float"/>
  <Constructor id="_7" name="EmptyClass" context="_4" location="f0:1">
    <Argument name="_ctor_arg" type="_9"/>
  </Constructor>
  <Constructor id="_8" name="EmptyClass" context="_4" location="f0:1"/>
  <ReferenceType id="_9" type="_4c"/>
  <File id="f0" name="example1.cxx"/>
</GCC_XML> 
```

问题是它拒绝读取我的结果的函数参数：

```
 Load result: No error 
Function 
id= _2 , name= main ,returns: _5
 Function 
id= _3 , name= a_function ,returns: _5 
```

我也试过

```
cout<<"Function\n"<<"id= "<<Function.attribute("id").value()<<" , name= "<<Function.attribute("name").value()<<" ,returns: "<<Function.attribute("returns").value()<<Function.attribute("Argument") <<endl; 
```

把它给出了相同的结果，只是在参数输出中添加了 0 输出，这表明它没有读取它

把我上面的结果相同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:42:44.317

`Argument`不是一个*属性*。它是一个*元素*，是 的一个子元素`Function`。您访问子元素的方式与访问任何元素的方式相同。

`xml_node::child_value`查找具有给定名称的 XML 元素（`Argument`在本例中），并返回该元素的第一个子文本节点的文本。`Argument`，在您的 XML 文件中，为*空*；它没有子文本节点。它有*属性*节点，但这不是一回事。如果你想要 的属性`Argument`，你必须要求它们，就像你要求`Function`节点的属性一样。

# php - PHP 的资产管道/框架

> ID：11254287
> 
> 赞同：11
> 
> 时间：2012-06-28T23:28:25.983
> 
> 标签：php, pipeline, assets

## 背景

我正在致力于“现代化”一个预先存在的 PHP 驱动的网站。该网站最初是一个带有一些 php 方法的静态网站。它现在有一个移动网络应用程序、多个模型和大量动态内容。但是，随着时间的推移，应用程序本身的结构与主要是静态站点时并没有太大变化，所以现在到处都是包含文件，应用程序/呈现逻辑没有分离等等。从事于。因此，我正在重新组织一切并重新开发许多预先存在的功能，因为我们正在为即将到来的升级对不断增长的生态系统做准备。首先，我正在重新编码一切以适应 MVC 架构。虽然我确实使用 PHP，但我的大部分背景来自 Ruby 和 Node，因此我的问题是：

## 实际问题

我很喜欢 Rails 的 Asset Pipeline，并且看到我正在处理的当前站点（参见上面的背景）有大约 10 个不同的样式表和更多的 javascript 文件，我真的很想实现某种资产管理器当我将站点转换为 MVC 设置时。

我找到[了 Assetic](https://github.com/kriswallsmith/assetic/)，这似乎很有趣，但我不太了解将它实现到模板系统中的最佳方法（我没有使用任何预构建的模板，例如 Twig，我能找到的任何参考材料都可以使用它）或者让它动态地为资产服务。

我还发现了一个叫做 Pipe: [https://github.com/CHH/pipe](https://github.com/CHH/pipe)的东西，它看起来像是一个非常接近 Sprockets 的端口，但我无法让它正常运行。

是否有任何应用程序实现了 Assetic（或 Pipe），或者我可以查看的不依赖现有模板引擎（例如 Twig）的另一个 Asset 打包器？

真的，我正在寻找可以缩小/组合多个 JS 和 CSS 文件，然后缓存它们的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T10:53:14.143

Liek hakre 说，Assetic 开箱即用。你不需要任何模板系统（Twig、Smarty...）就可以工作。

使用模板系统，Twig 是最好的，因为就像 hakre 所说，它的实施非常强大。但是，将它集成到任何其他模板系统中并不难（我很快写了一个 Smarty 插件供个人使用，效果很好）。

Finaly Assetic 可以满足您的任何需求：

*   结合 JS/CSS：使用 AssetCollection 类完成（[已在此处显示](https://github.com/kriswallsmith/assetic#assetic-)）
*   缩小：在这里您将使用 Assetic 提供的[过滤器](https://github.com/kriswallsmith/assetic/tree/master/src/Assetic/Filter)：CssMin、JsMin、JsMin+、Google Closure Compiler，您可以选择。甚至还有用于图像优化的图像过滤器（主要是质量无损缩小尺寸）
*   缓存：Assetic 有一个[缓存系统](https://github.com/kriswallsmith/assetic#caching)，所以你不必自己创建一个。

Assetic 的最后一个优势是它是 Symfony2 中默认使用的，也就是 imo，最近最好的 PHP 框架之一，因此它证明了 Assetic 是一个不错的选择。

到目前为止，我在 Symfony 中使用 Assetic 时遇到的唯一问题是缺乏文档（在我的案例中使用了 CssRewriteFilter），但对源代码的良好理解通常有助于了解它应该如何工作。

# c++ - 指向对象的指针向量 - 内存泄漏

> ID：11254291
> 
> 赞同：0
> 
> 时间：2012-06-28T23:28:48.550
> 
> 标签：c++, vector

我有一个指向类对象的指针向量。这些类对象也调用“new”来创建一个数组。

我试图避免内存泄漏，所以我创建了一个析构函数，它将对象的数组返回给 freestore。

```
laboratory::~laboratory()
{
   delete Users;   // Users is an array from the heap
} 
```

但是，当我尝试删除指针向量的每个元素时，程序崩溃：

```
for(int i = 0; i < vectorSize; i++)
    delete labVector[i]; 
```

任何帮助深表感谢。

编辑：在此处粘贴代码：http: [//pastie.org/4168453](http://pastie.org/4168453)

类和函数定义在 main() 下面。很抱歉以这种方式粘贴它，我使用的是一个头文件和 2 个源文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T23:35:27.720

```
delete Users;   // Users is an array from the heap 
```

那么那是错误的。应该

```
delete [] Users; 
```

任何你`new`拥有的东西都会`[]`得到一个`delete`with `[]`。

On a side note; do you *really* need a vector of pointers here? It's pretty darn rare to actually need that (though you see it a lot) and it completely negates the container's ability to manage memory for you, requiring you to loop through and deallocate every element.

vectors use dynamic memory behind the scenes for each element. You could us a vector of smart pointers or even a `vector<vector<T>>` (though, if performance is of the utmost concern, a jagged array may be a better choice. Don't assume that though).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T23:38:45.280

Unless you absolutely *need* to do this on your own, consider using a Boost [`ptr_vector`](http://www.boost.org/libs/ptr_container/doc/ptr_vector.html) instead.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-28T23:43:36.197

You have a few choices:

1.  You can make it clear that the vector does not own the objects in it, only the pointers to them. It then becomes the responsibility of all code that uses this vector to allocate and delete the objects itself.

2.  You can use a boost `ptr_vector` for this. The vector will own the objects it contains pointers to. You'll need to write a helper function to duplicate the objects so that `x = y;` will work. (Since `x` will need to own its own copy of every object in `y`.)

3.  You can use smart pointers, such as `boost::shared_ptr`, for this. If you do `x = y;`, the two vectors will refer to the *same* objects, such that changing the value in one will change the value in the other. The vectors will share ownership of the objects and can return safe references to the objects in them. The objects will self-destruct when they are no longer needed.

4.  You can use a vector of `boost::any` objects. This performs poorly but is very flexible.

But it really comes down to the classic question: *What are you trying to do?* Are you trying to manage the lifetimes of objects? If you duplicate a vector, what should happen? Should that duplicate the underlying objects? Do you need polymorphism? Are you using pointers to avoid slicing? And so on. Explain your use case and you'll get better solution suggestions.

**Update**: Your use of a vector of pointers seems simple and safe (so long as you don't try to copy-construct a vector, assign it, or anything like that). That your `delete` loop is crashing suggests possibly a bug in your destructor.

**Update2**: Yep.

```
laboratory::~laboratory()
{
    delete stationUsers;
} 
```

This is wrong because `stationUsers` wasn't allocated with `new` but with `new[]`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T23:32:21.167

没有更多代码很难知道，但请考虑：

```
delete[] Users; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T23:37:37.267

Do not allocate an array from the heap yourself. Use `std::vector<User>`. In addition, you should *never, ever* use `delete` or `delete[]` yourself. Always use a class-based solution such as smart pointers or `std::vector` to manage your memory.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-28T23:43:13.010

In addition to the others comments, your code has an Off-by-One error. This code references one past the end of your array.

```
for(int i = 0; i `<` vectorSize; i++)
    delete labVector[i]; 
```

# c# - Simple Injector 是否支持 MVC 4 ASP.NET Web API？

> ID：11254292
> 
> 赞同：17
> 
> 时间：2012-06-28T23:28:56.360
> 
> 标签：c#, .net, ioc-container, simple-injector

我是 Simple Injector IOC 容器的新手。我将开始在一个需要使用 MVC 4 ASP.NET Web API 实现多租户 ASP.NET MVC 的项目中工作。

我的问题是：Simple 注入器是否支持 MVC 4 ASP.NET Web API？[阅读像这样](http://simpleinjector.codeplex.com/wikipage?title=MVC%20Integration)的简单注入器文档会引用 MVC 3，我想知道是否也支持 MVC 4。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-29T09:42:25.590

> Does Simple injector IOC support MVC 4 ASP.NET Web API?

It has currently no support for MVC4 Web API, but support will be added in the future. [The integration guide](https://simpleinjector.readthedocs.org/en/latest/integration.html) will be updated when this happens.

* * *

**UPDATE**: [Web API support](https://simpleinjector.readthedocs.org/en/latest/webapiintegration.html) has been added to Simple Injector 2.5.

* * *

In the meantime, you can create your own `System.Web.Http.Dependencies.IDependencyResolver` implementation for the Simple Injector. Below is the implementation for working with Web API in a IIS hosted environment:

```
public class SimpleInjectorHttpDependencyResolver : 
    System.Web.Http.Dependencies.IDependencyResolver
{
    private readonly Container container;

    public SimpleInjectorHttpDependencyResolver(
        Container container)
    {
        this.container = container;
    }

    public System.Web.Http.Dependencies.IDependencyScope
        BeginScope()
    {
        return this;
    }

    public object GetService(Type serviceType)
    {
        IServiceProvider provider = this.container;
        return provider.GetService(serviceType);
    }

    public IEnumerable<object> GetServices(Type serviceType)
    {
        IServiceProvider provider = this.container;
        Type collectionType = typeof(IEnumerable<>).MakeGenericType(serviceType);
        var services =(IEnumerable<object>)this.ServiceProvider.GetService(collectionType);
        return services ?? Enumerable.Empty<object>();
    }

    public void Dispose()
    {
    }
} 
```

This implementation implements no scoping, since you need to use the [Per Web Api Request](https://simpleinjector.readthedocs.org/en/latest/lifetimes.html#perwebapirequest) lifetime for implementing scoping inside a web hosted environment (where a request may end on a different thread than where it started).

[Because of the way Web API is designed](https://stackoverflow.com/questions/15908019/simple-injector-unable-to-inject-dependencies-in-web-api-controllers), it is very important to explicitly register all Web API Controllers. You can do this using the following code:

```
var services = GlobalConfiguration.Configuration.Services;
var controllerTypes = services.GetHttpControllerTypeResolver()
    .GetControllerTypes(services.GetAssembliesResolver());

foreach (var controllerType in controllerTypes)
{
    container.Register(controllerType);
} 
```

You can register the `SimpleInjectorHttpDependencyResolver` as follows:

```
// NOTE: Do this as last step, after registering the controllers.
GlobalConfiguration.Configuration.DependencyResolver = 
    new SimpleInjectorHttpDependencyResolver(container); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T18:41:22.453

简短的回答是：是的，它有效。下面是适用于我的项目的代码片段，它同时具有 Web API 和 MVC4 控制器（部分基于上面 Steven 的响应）：

```
var container = new Container();

//Register you types in container here

container.RegisterMvcControllers(Assembly.GetExecutingAssembly());
container.RegisterMvcAttributeFilterProvider();

var controllerTypes =
from type in Assembly.GetExecutingAssembly().GetExportedTypes()
where typeof(ApiController).IsAssignableFrom(type)
where !type.IsAbstract
where !type.IsGenericTypeDefinition
where type.Name.EndsWith("Controller", StringComparison.Ordinal)
select type;

foreach (var controllerType in controllerTypes)
{
    container.Register(controllerType);
}

container.Verify();
DependencyResolver.SetResolver(new SimpleInjectorDependencyResolver(container)); 
```

要在 API 控制器中访问您的类型，您可以使用以下代码片段：

```
DependencyResolver.Current.GetService<InterfaceName>() 
```

# android - Android浏览器上的页脚绿色边框

> ID：11254294
> 
> 赞同：0
> 
> 时间：2012-06-28T23:29:07.587
> 
> 标签：android, html, css

当我在 Defy（Android 2.1 更新 1 浏览器版本 7）上打开我的网站[http://www.gestaoeventos.com](http://www.gestaoeventos.com)时，我的页脚上有一个奇怪的绿色边框，左下角有一个矩形黄色框。你知道这意味着什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T06:50:07.330

在您的 HTML 头中，您已经为媒体查询定义了 Mobile.css `screen and (max-device-width: 480px)`。含义：在屏幕宽度小于 480 像素的设备上应用 Mobile.css 样式。

您可以解决从 Mobile.css中删除`border`和属性的问题：`background-color`

```
#rodape {
    border: 3px solid green;
}
#rodape2 {
    background-color: yellow;
} 
```

祝你好运，罗纳尔多！

# iphone - 使用文本以编程方式更改 UITextView 高度

> ID：11254301
> 
> 赞同：8
> 
> 时间：2012-06-28T23:31:09.070
> 
> 标签：iphone, ios, uitextview, cgrect

我想用我设置的文本量以编程方式更改 UITextView，我有一个问题，如果我用界面生成器添加 UITextView 并且我这样做：

```
CGRect frame = textViewA1.frame;
frame.size.height = textViewA1.contentSize.height;
textViewA1.frame = frame; 
```

一切正常，但如果我以编程方式创建 UITextView，高度不会改变，我这样做：

```
 UITextView *textViewA1 = [[UITextView alloc] initWithFrame:CGRectMake(5, 5, 320, 50)];
[textViewA1 setFont:[UIFont fontWithName:@"Enriqueta" size:15]];
[textViewA1 setScrollEnabled:NO];
[textViewA1 setUserInteractionEnabled:NO];
[textViewA1 setBackgroundColor:[UIColor clearColor]];
[textViewA1 setText:@"A lot of text"];
CGRect frame = textViewA1.frame;
frame.size.height = textViewA1.contentSize.height;
textViewA1.frame = frame; 
```

这样uitextview的高度大小不会改变，我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T00:39:32.427

只需将`sizeToFit`消息发送到`UITextView`. 它将调整自己的高度以适合其文本。它不会改变自己的宽度或原点。

```
[textViewA1 sizeToFit]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-03T07:09:43.857

我认为你需要做：

```
CGRect frame = textViewA1.frame;
frame.size.height = textViewA1.contentSize.height;
textViewA1.frame = frame; 
```

在添加子视图之后：

```
[self.view addSubview: self.textView]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:35:50.407

您需要计算您拥有的文本的帧大小，例如：

```
UIFont *font = [UIFont fontWithName:@"Enriqueta" size:15];
NSString *text = @"A lot of text";
CGSize frameSize = [text sizeWithFont:font];
CGRect originalFrame = textViewA1.frame;
textViewA1.frame = CGRectMake(CGRectGetMinX(originalFrame), CGRectGetMinY(originalFrame), frameSize.width, frameSize.height); 
```

为防止其超过特定高度，请使用：

```
CGFloat maxHeight = 100; // or something
CGSize frameSize = [text sizeWithFont:font constrainedToSize:maxHeight]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T00:14:31.853

试试这个代码

```
UIFont * font = [UIFont fontWithName:@"Enriqueta" size:15];
textViewA1.font = font;
NSString * theText = @"A lot of text";
CGSize theStringSize = [theText sizeWithFont:font constrainedToSize:CGSizeMake(190, 1000000) lineBreakMode:UILineBreakModeWordWrap];
CGRect frame = textViewA1.frame;
frame.size.height = theStringSize.height;
textViewA1.frame = frame; 
```

对于 textview，这当然具有 190 像素的静态宽度。你显然可以改变它！

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-20T04:19:23.383

`UITextView`在 textview 中添加多行时滚动

```
- (BOOL)textViewShouldBeginEditing:(UITextView *)textView
{
    CGRect frameTextView = textView.frame;
    frameTextView.height -= KEY_BOARD_HEIGHT;
    textView.frame = frameTextView;
}
- (BOOL)textViewShouldEndEditing:(UITextView *)textView;
{
    CGRect frameTextView = textView.frame;
    frameTextView.height += KEY_BOARD_HEIGHT;
    textView.frame = frameTextView;
} 
```

# ruby-on-rails - cancan 和 view 使用 capybara 进行测试

> ID：11254302
> 
> 赞同：0
> 
> 时间：2012-06-28T23:31:19.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3, testing, capybara, cancan

对不起我的英语，我在用 capybara 测试视图时遇到了问题。Capybara 无法查看使用 cancan 验证的元素，我的测试中有此功能，以模拟用户对所有人都具有权限。

```
before(:each) do
  permission = FactoryGirl.create(:permission)
  role = FactoryGirl.build(:role)
  role.permissions << permission
  role.save
  user = FactoryGirl.create(:user, :role_id => role.id)
  sign_in user
end 
```

在我看来，这...

```
= link_to t('actions.new'), new_user_path if can?(:create, User) 
```

但我的测试没有通过

```
 Failure/Error: click_link t('actions.new')
 Capybara::ElementNotFound:
   no link with title, id or text 'Crear nuev@' found
 # (eval):2:in `click_link'
 # ./spec/views/users_spec.rb:53:in `block (3 levels) in <top (required)>' 
```

我不明白，我的控制器没有问题。

一些帮助？

在此先感谢，问候...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:14:27.827

我从未尝试过使用具有国际化功能的 capybara，但我可以想象您可能会遇到一些问题。

我会听从@phoet 的建议，并在您的链接中使用 ID 而不是翻译后的链接文本。Capybara`click_link`将查找 ID 或链接文本。

```
# add ID to link in view
= link_to(t('actions.new'), new_user_path, :id => 'actions_new') if can?(:create, User) 
```

.

```
# in test file
click_link 'actions_new' 
```

# python - Python 分析请求

> ID：11254303
> 
> 赞同：0
> 
> 时间：2012-06-28T23:31:22.817
> 
> 标签：python, http

我有兴趣构建一个应用程序，让开发人员可以实时查看来自他们机器的 http/https 请求。类似于 firebug，但它不仅可以捕获来自浏览器的请求，还可以捕获来自 shell 的请求。我的问题是，是否有任何 python 包允许我利用发出每个请求的模块？我不太清楚这叫什么，但它基本上就像萤火虫或wireshark。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T02:51:15.553

此类活动通常称为[数据包嗅探](http://en.wikipedia.org/wiki/Packet_analyzer)。请参阅[Python 中的数据包嗅探 (Windows)](https://stackoverflow.com/questions/462439/packet-sniffing-in-python-windows)

# c++ - 奇怪的 lambda 问题（编译器错误？）

> ID：11254305
> 
> 赞同：2
> 
> 时间：2012-06-28T23:31:41.743
> 
> 标签：c++, lambda, c++11, g++, segmentation-fault

我有一段代码在运行时因各种奇怪的内存损坏而失败。我已将其缩小到这部分代码：

```
List<CollisionBlock> WorldClient::getCollisionBlocks(RectF const& boundBox, bool doSort, Vec2F sortCenter) const {
  auto res = m_collisionGenerator.getPolys(boundBox);

  if (doSort) {
    sort(res, [=](CollisionBlock const& block1, CollisionBlock const& block2) {
    return magSquared(sortCenter - block1.poly.center()) < magSquared(sortCenter - block2.poly.center());
      });
  }

  return res;
} 
```

如果我`const&`从 lambda 中删除，代码可以正常工作。我不知道为什么。我想知道我是否遇到了编译器错误，或者是否有一些明显的东西我忽略了。

这是 CollisionBlock 的定义：

```
struct CollisionBlock {
  PolyF poly;
  // Will never be None
  CollisionKind kind;
  // Normalzied vector encoding the slope of the block we collided with.
  // Always faces right, y component can be positive or negative.
  Vec2F slope;
}; 
```

我可以在 Linux 32 位（g++ 版本 4.7.0 和 4.6.3）、MacOSX（不确定字长和 g++ 版本）、Windows 7 64 位（g++ 版本 4.6.3）、Windows 7 32 位（g++版本 4.6.2 和 4.6.3），但不是 Linux 64 位（g++ 版本 4.6.1）。

我使用的是 C++11，而不是 boost。

`Poly::center()`

```
Coord center() const {
  return sum(m_vertexes) / (DataType)m_vertexes.size();
} 
```

`sum`

```
template<typename Container>
typename Container::value_type sum(Container const& cont) {
  return reduce(cont, std::plus<typename Container::value_type>());
} 
```

`reduce`

```
// Somewhat nicer form of std::accumulate
template<typename Container, typename Function>
typename Container::value_type reduce(Container const& l, Function f) {
  typename Container::const_iterator i = l.begin();
  typename Container::value_type res{};

  if (i == l.end())
    return res;

  res = *i++;
  while (i != l.end())
    res = f(res, *i++);
  return res;
} 
```

`sort`

```
template<typename Container, typename Compare>
void sort(Container& c, Compare comp) {
  std::sort(c.begin(), c.end(), comp);
} 
```

这个问题有很多事情要做。抱歉，我会尝试制定一个较小的测试用例。

更新：

替换对`sum`in`Poly::center`的调用`std::accumulate`没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:58:05.580

我相当确定错误不在您发布的代码范围内。您可以在下面使用我的虚拟代码并慢慢将其转变为您的真实代码，直到它开始出现问题。如果你找到了请告诉我们，我很好奇。

仅供参考，我必须在几个地方编写代码才能获得接近你正在做的事情。所有这一切实际上就是锻炼您发布的一小段代码。

```
#include <list>
#include <deque>
#include <vector>
#include <algorithm>

typedef double mocish;

typedef int CollisionKind; //is actually enum class
typedef mocish RectF;

class Vec2F {
public:
  Vec2F() {
    vertexes.push_back(0);
    vertexes.push_back(0);
  }
  Vec2F(float a, float b) {
    vertexes.push_back(a);
    vertexes.push_back(b);
  }

  float operator[](unsigned index) const {
    return vertexes[index];
  }

  float operator[](unsigned index) {
    return vertexes[index];
  }

  Vec2F operator+(Vec2F const& other) const {
    return Vec2F(vertexes[0]+other[0], vertexes[1]+other[1]);
  }

  Vec2F operator-(Vec2F const& other) const {
    return Vec2F(vertexes[0]-other[0], vertexes[1]-other[1]);
  }

  Vec2F operator*(float other) const {
    return Vec2F(vertexes[0]*other, vertexes[1]*other);
  }

  Vec2F operator/(float other) const {
    return Vec2F(vertexes[0]/other, vertexes[1]/other);
  }

  Vec2F operator=(Vec2F const& other) {
    vertexes[0] = other[0];
    vertexes[1] = other[1];
    return *this;
  }

private:
  std::deque<float> vertexes;
};

float magSquared(Vec2F const& a) {
  return a[0]*a[0]+a[1]*a[1];
}

typedef Vec2F Coord;

// Somewhat nicer form of std::accumulate
template<typename Container, typename Function>
typename Container::value_type reduce(Container const& l, Function f) {
  typename Container::const_iterator i = l.begin();
  typename Container::value_type res{};

  if (i == l.end())
    return res;

  res = *i++;
  while (i != l.end())
    res = f(res, *i++);
  return res;
}     

template<typename Container>
typename Container::value_type sum(Container const& cont) {
  return reduce(cont, std::plus<typename Container::value_type>());
}

struct PolyF
{
    PolyF()
    {
        m_vertexes.resize(4);
        std::generate( m_vertexes.begin(), m_vertexes.end(), [](){ return Vec2F(std::rand(), std::rand());} );
    }

    std::vector<Coord> m_vertexes;

    Coord center() const 
    {
      return sum(m_vertexes) / (float)m_vertexes.size();
    }
};

struct CollisionBlock 
{
  PolyF poly;
  // Will never be None
  CollisionKind kind;
  // Normalzied vector encoding the slope of the block we collided with.
  // Always faces right, y component can be positive or negative.
  Vec2F slope;
};

template<typename Container, typename Compare>
void sort(Container& c, Compare comp) {
  std::sort(c.begin(), c.end(), comp);
} 

struct CollisionGen
{
    std::deque<CollisionBlock> getPolys( RectF const& ) const
    {
        std::deque<CollisionBlock> collision_block_moc(50);
        return collision_block_moc;
    }
};

struct WorldClient
{
    CollisionGen m_collisionGenerator;

    std::deque<CollisionBlock> getCollisionBlocks(RectF const& boundBox, bool doSort, Vec2F sortCenter) const 
    {
      auto res = m_collisionGenerator.getPolys(boundBox);

    //auto test = magSquared(sortCenter - res.front().poly.center()) < magSquared(sortCenter - res.front().poly.center());

      if (doSort) {
        sort(res, [=](CollisionBlock const& block1, CollisionBlock const& block2) {
        return magSquared(sortCenter - block1.poly.center()) < magSquared(sortCenter - block2.poly.center());
          });
      }

      return res;
    }
};

    int main() 
    {
        WorldClient wc;
        while (true) {
          wc.getCollisionBlocks( 42.0, true, {0,0} );
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T06:10:30.983

我的猜测是模板 List<> 上的迭代器不是随机访问迭代器，这是 std::sort 需要的，请注意 std::list 仅提供双向迭代。

如果您已经实现了自己的列表，我建议您仔细检查您的迭代器实现，以确保它是正确的，并提供了随机访问迭代器概念的完整和正确的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T06:21:12.233

我注意到您通过说 [=] 但使用引用将值传递给 lambda。您应该更改它，或者通过使用 std::ref 传递值以真正使用对实例本身的预期引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T06:59:24.080

您的比较器是严格的弱顺序吗？它是否始终如一地对其输入进行排序？我怀疑您实际上并没有在 中进行零初始化`res`，`reduce`因此`center()`最终会返回垃圾。这应该很容易检查一般性：`assert(f(res,res) == res)`在 res 的声明之后添加一个权利。

如果比较器不一致，则使用 会遇到未定义的行为`std::sort`，这很容易导致崩溃。并对平台、优化等敏感。

# php - 将 PHP 文件的结果包含在另一个文件中而不弄乱对象引用？

> ID：11254307
> 
> 赞同：2
> 
> 时间：2012-06-28T23:31:51.367
> 
> 标签：php, oop

抱歉，如果我解释得不好并且没有意义，我有点困惑。

我希望能够将 PHP 文件的输出包含在给定位置的另一个文件中，为此，我使用了缓冲区并包含/要求：

```
 if (file_exists(CUSTOM_PHP_DIR."/".$filename)) {
   ob_start();
   include(CUSTOM_PHP_DIR."/".$filename);
   $html = ob_get_clean();
 }
 echo $html; //where I want the results to go. 
```

问题是，我已将上述内容包含在类的方法中；因此，当文件包含时 -`$this`包含执行包含的类的属性和方法，这完全破坏了包含中的内容，即：

```
myClass::getSomethingFromDatabase(); 
```

我知道它破坏了 myClass 是数据库类的扩展，它调用自身`$this`来做很多事情，而 $this 现在是对包含该文件的不同类的引用。

我通过实例化我想在包含中使用的对象暂时解决了这个问题，这需要数据库凭据：

```
$newObject = new myClass(DB_CREDENTIALS);
$newObject->getSomethingFromDatabase(); 
```

我不得不`define`将数据库凭据作为常量来快速轻松地获取它们，我想避免这样做。我是否错过了一种更好的方法来使静态呼叫正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T18:19:42.873

我似乎从评论中了解到您已经以另一种方式重构了代码，但是您最初问题的答案是在新的函数上下文中包含，以丢弃范围内的每个变量

正如您在以下示例中所看到的，anonymous_include() 似乎可以满足您的需求。

```
$ php test.php
Another class
bar
--
Direct include
$this exists
--
Anonymous include
$this does not exists 
```

测试.php：

```
<?php                                                                                  
class main                                                                             
{                                                                                      
  public function another_class()                                                      
  {                                                                                    
    $path = dirname(__FILE__).'/include.php';                                          

    if (!file_exists($path)) {                                                         
      die('The file does not exists :(');                                              
    }                                                                                  

    ob_start();                                                                        
    include($path);                                                                    
    $html = ob_get_clean();                                                            
    echo $html;                                                                        
  }                                                                                    

  public function direct_include()                                                     
  {                                                                                    
    $path = dirname(__FILE__).'/include_2.php';                                        

    if (!file_exists($path)) {                                                         
      die('The file does not exists :(');                                              
    }                                                                                  

    ob_start();                                                                        
    include($path);                                                                    
    $html = ob_get_clean();                                                            
    echo $html;                                                                        
  }                                                                                    

  public function anonymous_include()                                                  
  {                                                                                    
    $include = function() {                                                            
      $path = dirname(__FILE__).'/include_2.php';                                      

      if (!file_exists($path)) {                                                       
        die('The file does not exists :(');                                            
      }                                                                                

      ob_start();                                                                      
      include($path);                                                                  
      $html = ob_get_clean();                                                          
      return $html;                                                                    
    };                                                                                 
    echo $include();                                                                   
  }                                                                                    
}                                                                                      

$main = new main();                                                                    

echo "Another class\n";                                                                

$main->another_class(); // $this exists, but things seems to work fine                        

echo "--\nDirect include\n";                                                           

$main->direct_include(); // $this exists                                        

echo "--\nAnonymous include\n";             

$main->anonymous_include(); // $this exists 
```

包括.php：

```
<?php
class sub
{
  protected
    $foo = 'bar';

  public function foobar()
  {
    echo $this->foo."\n";
  }
}

$sub = new sub();
$sub->foobar(); 
```

包括_2.php：

```
<?php
if (isset($this)) {
  echo "\$this exists\n";
} else {
  echo "\$this does not exists\n";
} 
```

# regex - powershell replace中可能存在错误，还是我做错了？

> ID：11254309
> 
> 赞同：1
> 
> 时间：2012-06-28T23:32:05.197
> 
> 标签：regex, powershell, backreference

我正在对一些数据进行正则表达式，如果 $_ 在“替换”部分，我也会得到内容。我为 $replace 尝试了各种方法，但似乎无法阻止这种行为。我也尝试过 [regex]::escape() 但是最终做同样的事情，只是使用转义字符。

我需要能够在替换中容忍 $_ 。我可以把它做成别的东西，然后再做一个修复，但这很丑，我宁愿避免它。

最后，如果 $replace='$anythingelse' 它似乎按预期运行，则只有 $_ 似乎会导致此问题。如果可以禁用所有解析，那也可以。

剧本：

> ```
>  $contents = 'foo'
>  $replace = '$_ bar'
>  $final = $contents -replace 'oo', $replace
>  Write-Output "Contents: $contents"
>  Write-Output "Replace: $replace"
>  Write-Output "Final: $final" 
> ```

输出：

> ```
>  Contents: foo
>  Replace: $_ bar
>  Final: ffoo bar 
> ```

系统：Windows 7、PSH 2、64 位

那么我做错了什么还是这真的是一个错误？

**编辑 6/29：**

我做了一个替换，所以我可以做替换。这很愚蠢，应该有一种方法可以禁用解析（这也会让它运行得稍微快一些）。

> ```
>  $contents = 'foo'
>  $replace = '$_ bar'
>  **$rep = $replace -replace '\$','$$$'**
>  $final = $contents -replace 'oo', $rep
>  Write-Output "Contents: $contents"
>  Write-Output "Replace: $replace"
>  Write-Output "Final: $final" 
> ```

输出

> ```
>  Contents: foo
>  Replace: $_ bar
>  Final: f$_ bar 
> ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T02:10:25.660

您的问题是替换字符串中的“$_”代表整个输入字符串。如果你想要一个文字美元符号，你需要使用 $$ 转义它：

```
$replace = '$$_ bar' 
```

有关详细信息，请参阅 msdn 上的[替换](http://msdn.microsoft.com/en-us/library/ewy2t5e0.aspx)页面！

**编辑以解决问题编辑 29/6**

如果您想要的只是一个没有任何正则表达式的基本字符串替换，只需使用标准字符串替换而不是`-replace`：

```
$final = $contents.replace('oo', $replace) 
```

# php - URL 的 fopen() 会中断域名，而不是数字地址

> ID：11254310
> 
> 赞同：10
> 
> 时间：2012-06-28T23:32:06.720
> 
> 标签：php, linux, ipv6

经过数小时尝试调试遇到 fopen() 问题的第三方应用程序后，我终于发现

```
php -r 'echo(file_get_contents("http://www.google.com/robots.txt"));' 
```

失败，但是

```
php -r 'echo(file_get_contents("http://173.194.32.81/robots.txt"));' 
```

成功。请注意，作为网络服务器用户，我可以 ping www.google.com 并且解决得很好。

我跟踪了 PHP 的两个执行，它们的分歧是这样的：

对于数字 v4 URL：

```
socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 3
fcntl(3, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(3, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(3, {sa_family=AF_INET, sin_port=htons(80), sin_addr=inet_addr("173.194
poll([{fd=3, events=POLLOUT}], 1, 0)    = 0 (Timeout)
...[bunch of poll/select/recvfrom]...
close(3)                                = 0 
```

对于域名：

```
socket(PF_INET6, SOCK_DGRAM, IPPROTO_IP) = 3
close(3)                                 = 0 
```

似乎 PHP 甚至没有尝试对那个套接字做任何事情。或者甚至解决域，就此而言。怎么回事？

在有或没有 ipv6 支持的情况下重新编译 PHP 似乎并不重要。在这个系统上禁用 ipv6 是不可取的。

Gentoo Linux，PHP 5.3.14，目前正在尝试 PHP 5.4，看看是否有帮助。有人有想法吗？

编辑：

```
php -r 'echo gethostbyname("www.google.com");' 
```

工作并产生一个 ipv4，而

```
php -r 'echo(file_get_contents("http://[2a00:1450:4007:803::1011]/"));' 
```

似乎返回一个空白结果。

编辑2：

第一次我什至没有注意到，使用名称时打开的 v6 套接字是 SOCK_DGRAM。这是 PHP 试图解析域名吗？我尝试在 resolv.conf 中将解析器从 127.0.0.1 切换到 ::1，但没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T22:11:08.597

GDB 显示那个神秘的未使用的套接字调用实际上来自 libcurl。我在没有 libcurl 的情况下重新编译了 php，它可以工作。我会继续调查原因，但到目前为止，解决方法似乎有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T21:14:00.357

我认为这是操作系统偏好，而不是 php 偏好。我认为您需要编辑您的 /etc/gai.conf 文件以选择 IPv4 而不是 IPv6。一点点谷歌搜索出现了[这篇](https://askubuntu.com/questions/32298/prefer-a-ipv4-dns-lookups-before-aaaaipv6-lookups)描述如何做到这一点的文章。老实说，我对 gai.conf 不熟悉，所以你的里程可能会有所不同，但看起来在大多数系统上它只是简单地取消注释一行。

至于为什么你看到 SOCK_DGRAM，如果我不得不猜测，我猜这是因为 DNS 查找是 UDP，这可能是你在跟踪中看到的，而在你的第一个跟踪中，地址可能被缓存了所以它立即建立到远程服务器的 TCP 连接（DOCK_STREAM）。

# c# - 尝试将字符串解析为双精度，得到“输入字符串格式不正确”。

> ID：11254311
> 
> 赞同：0
> 
> 时间：2012-06-28T23:32:09.613
> 
> 标签：c#, string

我需要将数据表中的字符串解析为双精度。我有一个数据表（dt），它有不同的列，并且这些列中的每一列都使用该`.ToString()`方法转换为字符串。但是，当我尝试输出数据的纬度和经度时，出现错误“输入字符串的格式不正确”。所以我想我的主要问题是，如何从使用该`.ToString()`方法转换为字符串的对象中解析文本..

```
using System;
using System.IO;
using System.Collections;
using System.Data;

namespace SalesMap
{
    class SalesMap
    {
        private static DataTable InitData1()
        {
            //Datatable for entire list of zipcodes
            DataTable datat = new DataTable("DATA");
            DataColumn state = new DataColumn();
            DataColumn county = new DataColumn();
            DataColumn statecounty = new DataColumn();
            DataColumn latitude = new DataColumn();
            DataColumn longitude = new DataColumn();
            DataColumn salesperson = new DataColumn();

            //Add the columns to the datatable
            datat.Columns.Add(state);
            datat.Columns.Add(county);
            datat.Columns.Add(statecounty);
            datat.Columns.Add(latitude);
            datat.Columns.Add(longitude);
            datat.Columns.Add(salesperson);

            return datat;
        }       

        private static String InitPath()
        {
            string path = "C:/Documents and Settings/Andre/Desktop/salesmapdata/MapPointCountyLatLong.csv";
            return path;
        }

        public static void Main()
        {
            try
            {
                DataTable dt = InitData1();
                StreamReader sr = new StreamReader(InitPath());
                String csvData = string.Empty;

                while ((csvData = sr.ReadLine()) != null)
                {
                    String[] data = csvData.Split(',');
                    //dt.Rows.Add(data);
                    DataRow newRow1 = dt.NewRow();
                    newRow1[0] = data[0].ToString(); //state
                    newRow1[1] = data[1].ToString(); //county
                    newRow1[2] = data[2].ToString(); //state|county
                    newRow1[3] = data[3].ToString(); //latitude
                    newRow1[4] = data[4].ToString(); //longitude
                    newRow1[5] = data[5].ToString(); //salesperson
                    dt.Rows.Add(newRow1);

                    Console.WriteLine("Row added for: dt");
                }

                foreach (DataRow row1 in dt.Rows)
                {
                    double latitude1 = Double.Parse(row1[3].ToString());
                    double longitude1 = Double.Parse(row1[4].ToString());

                    if (row1[5].ToString() != "UNKNOWN" || row1[5].ToString() != "SALESMAN")
                    {
                        Console.WriteLine(latitude1);
                        Console.WriteLine(longitude1);
                    }
                }

                dt.WriteXml(@"c:\test\dt1.xml");
                sr.Close();
            }

            catch (Exception e)
            {
                StreamWriter sw = new StreamWriter(@"c:\test\error.txt");
                sw.WriteLine(e.Message.ToString());
                sw.Close();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:44:32.857

首先，当从 CSV 文件读取数据时，您不需要调用`data[x].ToString()`每个数组元素，因为它们已经是字符串。

Double.Parse 调用可能遇到的几个潜在问题：

1.  CSV 文件中的数据确实格式错误（可能是您放错了列号，或者数据可能包含无法解析的附加符号，就像 Tim 在他的评论中提到的那样）。
2.  您的列中有空字符串。那些不能被解析为加倍。你需要先检查一下，使用`string.IsNullOrWhitespace()`或类似的东西。
3.  你的文化是错误的。您的 CSV 文件中可能有使用小数点的纬度和经度值，但您当前的线程文化可能使用逗号作为小数分隔符。有一个接受 Culture 作为参数的[重载`Decimal.Parse()`](http://msdn.microsoft.com/en-us/library/t7xswkc6.aspx)[`CultureInfo.InvariantCulture`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx)（您可以提供或任何其他[`CultureInfo`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)）。

# java - 如何将 RelativeLayout（来自 XML）添加到我以编程方式定义的 LinearLayout？

> ID：11254312
> 
> 赞同：1
> 
> 时间：2012-06-28T23:32:10.093
> 
> 标签：java, android, xml, android-linearlayout, android-relativelayout

我环顾了其他问题，但没有发现任何与这种情况完全匹配的东西。我在 XML 中定义了一个 RelativeLayout。我想将整个 RelativeLayout 放在 GraphView 对象（来自我单独制作的类）下面。我认为将 RelativeLayout 放在 GraphView 下方的最佳方法是将它们都粘贴在我尝试以编程方式定义的 LinearLayout 中。

到目前为止，这就是我所拥有的-它有问题，但我不太确定是什么。

```
import android.app.Activity;
import android.os.Bundle;
import android.widget.LinearLayout;
import android.widget.RelativeLayout;

public class Grapher extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);        
        LinearLayout ll = new LinearLayout(this); 
        GraphView gv = new GraphView(this); 
        RelativeLayout rl = (RelativeLayout) findViewById(R.id.mainRelativeLayout);
        ll.addView(gv); 
        ll.addView(rl); 
        setContentView(ll); 
```

而xml....

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:id="@+id/mainRelativeLayout"
    android:orientation="vertical">
    <Button
        android:id="@+id/second"
        android:clickable="true"
        android:background="@drawable/button_chooser"
        android:layout_width="70dp"
        android:layout_height="40dp"
        android:text="@string/second" 
        android:textColor="@color/white"
        android:textSize="15sp"/>
    <Button
        android:id="@+id/alpha"
        android:clickable="true"
        android:background="@drawable/button_chooser"
        android:layout_width="70dp"
        android:layout_height="40dp"
        android:layout_below="@id/second"
        android:layout_alignParentLeft="true"
        android:text="@string/alpha"
        android:textColor="@color/white"
        android:textSize="15sp" />
    <Button
        android:id="@+id/mode"
        android:clickable="true"
        android:background="@drawable/button_chooser"
        android:layout_width="70dp"
        android:layout_height="40dp"
        android:layout_toRightOf="@id/second"
        android:text="@string/mode"
        android:textColor="@color/white"
        android:textSize="15sp" />
</RelativeLayout> 
```

谢谢你的帮助。我有一种预感，这只是我正在查看的非常简单的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:39:01.613

`Activity.findViewById`搜索绑定到活动的视图（通常作为调用的结果`setLayout(R.layout.yourlayout);`）。由于您没有调用它，因此当前没有活动视图，因此调用`findViewById`将返回 null。

看起来您正在尝试做的是从 xml 扩展布局，然后以编程方式将其添加到视图中。你应该做的是这样的：

```
Inflater inflater = LayoutInflater.from(context);
//this will inflate the mainRelativeLayout into the linear layout you called "ll"
inflater.inflate(R.id.mainRelativeLayout, ll); 
```

# ruby-on-rails - 使用 Rails 3 应用程序安装 scribd_fu

> ID：11254313
> 
> 赞同：0
> 
> 时间：2012-06-28T23:32:09.903
> 
> 标签：ruby-on-rails, scribd

Rails 菜鸟在这里。我希望我的应用程序的用户能够上传页面（pdf、.doc），然后将其上传到 Scribd 并在浏览器中查看。根据我的研究，在 Rails 中完成此任务的最佳方法似乎是 scribd_fu gem：[https ://github.com/shwoodard/scribd_fu](https://github.com/shwoodard/scribd_fu)

我一直在尝试安装 gem，但没有成功。自述文件说明有点过时，但它说要安装：

```
 sudo gem install scribd_fu --source 'http://gemcutter.com'
    config.gem 'scribd_fu', :source => 'http://gemcutter.com'
    ./script/generate scribd_fu 
```

由于我了解上述内容在 Rails 3.x 中大部分已被弃用，因此我将以下内容添加到我的 gem 文件中并运行“捆绑安装”

```
 gem 'rscribd'
    gem 'scribd_fu' 
```

这似乎安装了 gem，但我实际上无法运行 scribd_fu 生成器。我试过了：

```
 rails generate scribd_fu
    bundle exec rails generate scribd_fu 
```

当我运行上述程序时，我收到错误消息：“找不到生成器 scribd_fu”。当我运行 rails g --help 时，scribd_fu 没有被列为任何可用的生成器。任何帮助将不胜感激，因为这个宝石似乎完全符合我的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T16:25:09.690

查看 scribd_fu gem[源代码](https://github.com/shwoodard/scribd_fu/blob/master/generators/scribd_fu/templates/scribd_fu.yml)，所有 scribd_fu gem 生成器都会在您的配置目录中创建一个名为 scribd_fu.yml 的 YAML 文件（即 config/scribd_fu.yml）

scribd_fu.yml文件内容如下：

```
#Scribd Account Info

key: 
secret: 
user: 
password: 
access: 
```

在有人以更好的方式回答之前，只需手动创建文件，您就可以继续前进。

# c - 在单个整数上同步的最佳方法

> ID：11254315
> 
> 赞同：3
> 
> 时间：2012-06-28T23:32:18.920
> 
> 标签：c, multithreading

我有一个多线程程序，它使用 pthread 互斥锁在几个整数上进行同步。
当然，它不能很好地扩展。
我读到共享数据的最佳方法是消除所有共享数据 - 但是如果我需要总体“任务计数”（由共享整数确定）不应该大于这个值，我该怎么办？考虑在线程之间简单地划分这个整数是行不通的——一个线程可以比其他线程运行得更快，并且在其他线程继续工作时停止。
此外，对共享整数使用原子操作也不起作用 - 当线程数很大时，由于写入共享，性能会下降。
**更新**：挂起线程是非常不可取的，我不仅需要可伸缩性，还需要确定性的线程延迟时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:43:33.500

给每个线程一个自己的计数器。（在线程本地存储或专用于该线程的页面上，以确保您没有弹跳缓存行。）当您需要提供“总体任务计数”时，让控制线程从所有其他线程并将它们总结在一个地方。

如果你想要一个*完美*的计数，你可以告诉所有线程暂停工作。如果您不介意计数接近但不完美，请让它们继续运行。由于每个线程只写入自己的数据，因此它的运行速度应该*比*在共享计数器上使用互斥锁快得多。[整数写入在几乎所有平台](http://www.makelinux.net/books/lkd2/ch09lev1sec1)上都是原子的，除了 SPARC ；如果你不关心 SPARC，你不需要做任何事情来防止部分写入整数。

# scalability - 无冲突复制数据类型 (CRDT) 与 Paxos 或 Raft

> ID：11254318
> 
> 赞同：34
> 
> 时间：2012-06-28T23:32:31.780
> 
> 标签：scalability, distributed, paxos, raft, crdt

什么时候使用 CRDT 之类的东西而不是 paxos 或 raft 是个好主意？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-29T00:13:04.477

如果您可以使用 CRDT 之类的东西，请这样做。您应该获得更好的性能。它还支持有趣的用例，例如离线工作然后稍后合并。但是，并非总是可以设计出让 CRDT 为您工作的东西。在这种情况下，paxos 可以为您解决难题。

但即使你决定使用 paxos，通常你也应该限制直接通过 paxos 算法完成的工作量。相反，出于性能原因，您希望为必要的操作（例如主选举）保留 paxos，然后让复制的主设置处理大多数决策。（在高吞吐量环境中，master 可能会做一些事情，比如将特定分片的责任委托给特定的子节点，这些子节点相互复制。不要让 master 成为瓶颈......）

也就是说，声称你会挥动 paxos 的魔杖比在实践中实际做到这一点要容易得多。有鉴于此，您可能会发现[http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en/us/archive/chubby-osdi06.pdf](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en/us/archive/chubby-osdi06.pdf)是对现实世界的困难的有趣描述paxos 实现很可能会遇到。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-11-12T13:19:51.497

我想这个人知道他在说什么：

[博客](http://aphyr.com/tags/jepsen)

[视频](http://www.youtube.com/watch?v=mxdpqr-loyA)

[关于分布式系统的结论](http://aphyr.com/posts/286-call-me-maybe-final-thoughts)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-10-12T10:55:45.930

**CRDT 和 Paxos 有不同的目标，在不同的场景下使用。它们的共同点是帮助程序员处理并发/复制。CRDT 是假设将发生并发更新的数据类型。Paxos 是一种协议，通过对它们强制执行总命令来强制执行它们。** 让我们更详细地了解这一点。

假设我们有一个复制集，它在两个不同的地方复制。

**使用 Paxos**可以保证对集合的写入将由每个副本以相同的顺序执行。更一般地说，**它保证所有副本都同意集合的状态如何演变。**

例如，如果你让 user1 在 replica1 执行 update1，将元素 1 添加到复制集，同时 user2 执行 update2，在 replica2 添加 element2，Paxos 将使副本同意这些更新的给定顺序，或者可能同意选择一个两个更新并丢弃第二个更新，具体取决于您如何使用它以及您想要实现的目标。例如，如果 Paxos 的结果是 update1 在 update2 之前，则每个副本都将按该顺序更新集合。因此，与这些更新同时读取集合的用户可以观察到，无论他们在哪里（在哪个副本）读取，都只能观察到集合的以下状态（假设集合在开始时是空的）：

{}（空集）

{元素1}

{元素1，元素2}

此外，这些状态只能按该顺序查看，这意味着一旦集合的状态为 {element1, element2}（在每个副本中），后续读取将不会返回 {} 或 {element1}。

积极的一面：这个集合很容易推理，因为它相当于一个不被复制的集合。

不利的一面：不可用：如果副本无法相互通信（网络分区），则您的集合无法更新，因为无法达成一致。低性能、高延迟：协议要求副本在回复客户端之前同步。这会产生与副本之间的延迟成比例的延迟。

**CRDT 的保证较弱。CRDT 集不等同于顺序的单副本集。它假设对于如何更新副本没有协议或总顺序。**

**CRDT 保证如果集合的两个副本都看到相同的更新（无论它们看到它们的顺序如何），那么它们将呈现相同的状态；副本将收敛。**

在我们的两个用户同时执行更新的示例中，一个不运行 Paxos 来对集合进行排序操作的系统（例如，在最终或因果一致性下发生这种情况）将允许副本 1 添加元素 1 而副本 2 正在添加元素 2

因此，replica1 的状态将是：{element1}

副本 2 的状态为：{element2}

在这个时间点，副本出现分歧。稍后，当副本同步时，它们将交换它们的更新，最终呈现这种状态：

副本 1 的状态将是：{element1, element2}

副本 2 的状态将是：{element2, element1}

在这个时间点，副本已经收敛。

与这些更新同时读取集合的用户可以根据他们读取的位置（在哪个副本）观察集合的以下状态（假设集合在开始时为空）：

{}（空集）

{element1}（如果他们从副本 1 读取）

{element2}（如果他们从副本 2 中读取）

{元素1，元素2}

{元素2，元素1}

负面的一面：这个集合很难推理，因为它显示了在顺序集合中不可能出现的状态。在我们的示例中，我们只观察到两个并发添加到一个集合的情况，这很简单。并发添加和删除更复杂有许多具有不同问题的数据类型：

[收敛和交换复制数据类型的综合研究](http://hal.upmc.fr/inria-00555588/document "收敛和交换复制数据类型的综合研究")

积极的一面：高可用性：如果副本不能相互通信（网络分区），您的集合可以更新。副本将在它们重新连接时同步。高性能、低延迟：副本在回复客户端后立即回复客户端并在后台同步。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-12T13:13:51.147

CRDT Treedoc 示例存在缺陷。当两个系统使用相同的键同时插入时，每个节点都需要一个消歧器。

发生这种情况后，系统不再可能在具有相同键但消歧器不同的条目之间插入，因为这需要系统插入另一个相同的键但控制消歧器的顺序。消歧器并不密集，所以这并不总是可能的。如果消歧器是另一棵树，那么您解决了一个问题，但随后需要另一个更深层次的冲突解决机制......等等。

这个未提及的问题，加上您需要进行两阶段提交来整理元数据的事实让我认为 CRDT 仍在进行中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-19T09:35:39.233

我们有多个指标：

*   吞吐量（CRDT 和 Paxos 是相同的，因为无论 CRDT 还是 Paxos，所有请求最终都会复制到所有副本上）；
*   延迟（CRDT 比 Paxos 更好，因为它写入的副本数量较少）；
*   可靠性（CRDT 比 Paxos 弱，因为它写入的副本数量较少（小于多数），这可能导致状态丢失）；
*   一致性（CRDT 比 Paxos 弱，因为它允许没有同步点的并发写入（基本上没有重叠副本），而 Paxos 写入总是需要重叠副本来进行序列化）。

我的建议是，当副本彼此相距不远时（例如，在数据中心内），我们应该使用 Paxos，而当网络分区正常时（例如，断开连接的移动设备），我们应该使用 CRDT。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-18T08:20:53.957

评论@btilly 的回复：

该主题中的问题与不同的一致性模型以及设计模式有关：

*   CRDT 与[最终一致性](https://en.wikipedia.org/wiki/Eventual_consistency)算法家族有关，
*   PAXOS 系列算法涉及到[强一致性](https://en.wikipedia.org/wiki/Consistency_model)/[线性化](https://en.wikipedia.org/wiki/Linearizability)（客户端到服务器同步），
*   RAFT在算法和一致性方面[相当于](http://ellismichael.com/blog/2017/02/28/raft-equivalency/)PAXOS，但它被认为更容易实现。

CRDT 和 Paxos 是非常不同的东西，必须根据您的架构要求来决定其用法。我认为处理它的最佳方法是查看已成功应用这些算法的用例。

使用模式：

CRDT 可用于客户端（即移动设备）和服务器之间的数据同步、实时协作编辑、dist-db 实现中的值同步以及最终一致性很好的所有其他情况。

PAXOS 主要用于支持系统基础设施的专有系统（即 Chubby），或用于在 BigTable、Datastore、Spinnaker、Spanner 等分布式数据库系统中实现同步。

RAFT 在 ETCD、Consul 等 OSS 基础设施项目中更受欢迎...

（不记得 CockroachDB 和 TiDB 是基于什么的）

还有一个 BFT，但它用得较少。

ps PAXOS != ZooKeeper。ZooKeeper 使用称为 ZAB 的不同算法，它不是复制状态机，而是具有单一写入器和宽松读取模型的复制快照机。Google 的 Chubby 基于 Paxos，但它是专有的。

pss 有趣的是，PAXOS 这些年来是如何发展的。在过去的 20 年中，发明了许多变体来处理边缘情况、仲裁大小和集群重新配置的各种优化。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-02-24T03:40:30.383

什么时候合适。然而，PaxOS 并没有那么糟糕，因为它的吞吐量通常与 CRDT 相同，更不用说可靠性要高得多（CRDT 可能导致状态丢失），而且它的延迟也不是那么糟糕，因为它只需要多数副本回复而不是全部回复。

# python - Python - 如何在 Linux 中的特定 tty 中运行 python 脚本？

> ID：11254330
> 
> 赞同：1
> 
> 时间：2012-06-28T23:33:56.350
> 
> 标签：python, switch-statement, tty

在项目中，我将启动到 Linux 控制台模式（init 3），然后在特定的 tty 中使用 curses 库（带有控制台 UI）运行 python 脚本。

例如，操作系统启动到 tty 0，然后我键入：

> sudo chvt 2 && sudo python /root/aaa.py

这是 Ubuntu Live 桌面操作系统，因此 sudo 不会提示输入密码，而只会以提升的权限执行命令。

tty 确实切换到 2，但是 /root/aaa.py（带有 curses 库 UI）在 tty 0 中执行...

如果我希望脚本在 tty 2 中执行并且 UI 显示在 tty 2 中，该怎么做？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:40:40.503

我认为[openvt](http://man.cx/openvt)命令是您正在寻找的。请记住，您需要 root 权限才能执行它。

# python - 计算一组字符串的相似度（推文）

> ID：11254331
> 
> 赞同：3
> 
> 时间：2012-06-28T23:33:59.080
> 
> 标签：python, string, levenshtein-distance

我有一个应用程序可以显示大约 100 条热门话题的推文。问题是它们中的很多都非常相似（即相同的推文具有不同的 url），这就是为什么我想忽略非常相似的推文。

我正在尝试找到一种有效的方法来使用 python 做到这一点。我正在考虑使用：[http](http://code.google.com/p/pylevenshtein/) ://code.google.com/p/pylevenshtein/来解决这个问题，但我必须将很多推文相互比较，也许有更简单的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:42:32.040

尝试[difflib.get_close_matches](http://docs.python.org/library/difflib.html#difflib.get_close_matches)将每条推文与其他推文进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:16:26.720

你真的要试试`difflib`，它有一些很酷的东西。这是我的最爱之一：

```
>>>from difflib import SequenceMatcher as sm
>>> dif = sm(a='hello', b='maybe hello')
>>> dif.ratio()
0.625
>>> dif = sm(a='hello', b='Hello')
>>> dif.ratio()
0.8
>>> dif = sm(a=[1,2,3,4], b=[2,3,5,6])
>>> dif.ratio()
0.5 
```

# javascript - 什么正则表达式模式将从 containsg 的 outerHTML 文本中提取 innerHTML？

> ID：11254335
> 
> 赞同：0
> 
> 时间：2012-06-28T23:34:30.343
> 
> 标签：javascript, regex, innerhtml

我有一个字符串中的 html 标记的 outerHTML，并且想要提取内部 HTML 的 body 标记。该函数在 C# 中使用，因此我无法访问任何 HTML/JavaScript Dom 功能，类似于[如何使用 RegEx Asp.net C# 抓取 BODY html 标记（来自字符串）中的所有内容](https://stackoverflow.com/questions/2288614/how-do-i-grab-everything-inside-the-body-html-tag-from-a-string-using-regex-as)。

由于在进行 LoadHtml 转换时发生的 HTML 文档中的差异，HTML Agility 路由将不起作用。我捕获了原始 HTML 正文和 HTML 正文在实时站点上更新时的差异。我希望将这些差异与原始正文 innerHTML 进行比较。我想从 HTML outerHTML 中提取 body innerHTML 的原因是为了在数据传输上留出空间（一个传输 html、head 和 body，而不是每个传输。

理想情况下，这将处理任何边缘情况，例如 body 标签中的属性，无效的 html 是 body 标签等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:51:14.350

> 由于在进行 LoadHtml 转换时发生的 HTML 文档的差异，HTML Agility 路由将不起作用

因此，使用相同的过程加载原始版本和新版本，然后进行比较。

您会丢失标签大小写、引用和属性顺序等非信息集详细信息。但是无论如何，您已经失去了它，因为`innerHTML`(or `outerHTML`) 是在您读取属性时由浏览器从 DOM 信息集中重新生成的；它显然不是您输入的原始 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:27:07.377

和

```
var matches = outerHTML.match(
  /<body(?:\s+[a-z]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+)))*\s*>([\S\s]*)<\/body>/i); 
```

`matches[1]`将包含`body`元素的内容（这是[HTML5 WD](http://www.w3.org/TR/html5/)中解析规则的实现）。

但是`body`元素是一种特殊情况，因为在 HTML 文档中只能有一个，所以正则表达式是否贪心也没关系。通常，您最好[改用标记解析器](http://social.msdn.microsoft.com/Search/en-US?query=html%20parser%20asp.net&ac=1)。

# asp.net - 如何使用条带取消订阅

> ID：11254337
> 
> 赞同：1
> 
> 时间：2012-06-28T23:34:48.377
> 
> 标签：asp.net, stripe-payments

我正在使用 c# 开发 asp.net Web 应用程序。我正在尝试使用 Stripe api 进行信用卡交易和订阅。我遵循了条纹官方站点中的文档以及 github 上提供的示例项目 XamarinStripe。现在我正在尝试取消特定客户的订阅，但我无法使用 Xamarin dll 完成它。请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:51:57.093

[Stripe 的网站](https://stripe.com/docs/subscriptions)上有说明。

至于如何使用 XamarinStripe，组件的单元测试[有一个示例](https://github.com/xamarin/XamarinStripe/blob/master/PaymentTest/Program.cs)：

```
static StripeSubscription TestDeleteSubscription (StripeCustomer customer, StripePayment payment)
{
    StripeSubscription sub = payment.Unsubscribe (customer.ID, true);
    return sub;
} 
```

# android - Android 中 MultiAutoCompleteTextView 的拼写建议？

> ID：11254340
> 
> 赞同：1
> 
> 时间：2012-06-28T23:35:00.423
> 
> 标签：android, autosuggest, autocompletetextview

当用户在 MultiAutoCompleteTextView 小部件中键入时，我试图为单词提供拼写建议，例如当您在他们的消息传递应用程序中键入时，Android 将如何为您提供单词建议。我设置了 android:inputType="textAutoCorrect" 但仍然没有出现拼写建议。有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T18:02:54.907

我还没有尝试从这些最近的发现中实现解决方案，但是[http://developer.android.com/reference/android/widget/TextView.html#attr_android:inputType](http://developer.android.com/reference/android/widget/TextView.html#attr_android:inputType)下的常量 textAutoCorrect可能会很有用。此外，请在此处查看 Android 拼写检查器框架[http://developer.android.com/guide/topics/text/spell-checker-framework.html](http://developer.android.com/guide/topics/text/spell-checker-framework.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T06:23:07.007

这是我的解决方案

```
edit.setRawInputType(edit.getInputType() & ~EditorInfo.TYPE_TEXT_FLAG_AUTO_COMPLETE); 
```

当我键入时，这会在 [google] 键盘顶部显示单词，就像在普通的 EditText 中一样

我的自定义 Tokeniser 和 Adapter 仍然向我展示东西！

# ruby-on-rails - 在 Rspec 中的 before (:each) 中声明两个工厂时记录无效

> ID：11254341
> 
> 赞同：0
> 
> 时间：2012-06-28T23:35:09.903
> 
> 标签：ruby-on-rails, rspec, factory-bot

我有以下rspec：

```
require 'spec_helper'

describe KnowledgesController do

  before (:each) do
    @knowledge = FactoryGirl.create(:knowledge)
    @professor = FactoryGirl.create(:professor)
    sign_in @professor
  end

  describe "GET 'show'" do

    it "should be successful" do
      response.should be_success
    end

  end

end 
```

执行时给我以下错误：

```
Failure/Error: @professor = FactoryGirl.create(:professor)
     ActiveRecord::RecordInvalid:
       translation missing: es.activerecord.errors.messages.record_invalid
     # ./spec/controllers/knowledge_controller_spec.rb:7:in `block (2 levels) in <top (required)>' 
```

如果我改变这个：

```
before (:each) do
        @knowledge = FactoryGirl.create(:knowledge)
        @professor = FactoryGirl.create(:professor)
        sign_in @professor
      end 
```

为了：

```
 before (:each) do
    @professor = FactoryGirl.create(:professor)
    @knowledge = FactoryGirl.create(:knowledge)
    sign_in @professor
 end 
```

我收到此错误：

```
Failure/Error: @knowledge = FactoryGirl.create(:knowledge)
     ActiveRecord::RecordInvalid:
       translation missing: es.activerecord.errors.messages.record_invalid 
```

所以，我不认为记录是无效的，因为在一种情况下它取决于知识，在另一种情况下取​​决于教授。

你们有什么想法会发生什么吗？

这些工厂是：

```
#Knowledge

FactoryGirl.define do
  factory :knowledge do |knowledge|
    knowledge.association(:professor)
    knowledge.association(:subject)
    knowledge.association(:level)
  end
end

#Professor

FactoryGirl.define do
    factory :professor do
      first_name 'Mister'
      last_name 'Professor'
      ...
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:54:21.047

知识类有一个相关的教授记录。由于您没有将明确的教授记录传递给 create 方法，因此您在创建知识的同时创建了一个新教授。

一种或另一种方式，您正在创建两个具有相同属性的教授。必须验证唯一性或类似的东西。

尝试这个：

```
before (:each) do
  @professor = FactoryGirl.create(:professor)
  @knowledge = FactoryGirl.create(:knowledge, :professor => @professor)
  sign_in @professor
end 
```

它应该工作。

# javascript - 设置文档高度 - 100px

> ID：11254343
> 
> 赞同：0
> 
> 时间：2012-06-28T23:35:35.633
> 
> 标签：javascript, jquery, css, height

我有以下代码，而不是 height(300)，height() = document height-100

```
$(".bar").height(XXX); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:39:22.410

```
var DocHeight = $(document).height();
$(".bar").height(DocHeight-100); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:39:29.310

试试这个：

```
var h = $(window).height() - 100;
$(".bar").height(h); 
```

# java - 使用 httpclient 自动检查密码

> ID：11254345
> 
> 赞同：0
> 
> 时间：2012-06-28T23:35:43.537
> 
> 标签：java, httpclient

现在我在为工作安全项目编写一个简单的端口扫描器/密码检查器时遇到了一些重大问题。

我的基本目标是编写一个快速的小工具来打开一个文本文件，扫描端口 21、23、80、502 和 8080，然后简单地将返回的 http 状态写入文件（200、404 等）

到目前为止，我一直在尝试使用 httpclient 执行此操作，但结果非常糟糕。

我的代码是这样的

```
 public static void doHosts() throws Exception{
        String filename = "C:\\test.txt";
        String ip = "";
        String port[] = {"21", "23", "80", "502", "8080"};
        FileInputStream fstream = new FileInputStream("c:\\scan.txt");
        DataInputStream in = new DataInputStream(fstream);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        while ((ip = br.readLine()) != null) {
            HttpParams httpParameters = new BasicHttpParams();
            int timeoutConnection = 3000;
            int timeoutSocket = 5000;
            HttpConnectionParams.setConnectionTimeout(httpParameters, timeoutConnection);
            HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);

            HttpHost targetHost = new HttpHost(ip);
            DefaultHttpClient httpclient = new DefaultHttpClient(httpParameters);
            UsernamePasswordCredentials creds = new UsernamePasswordCredentials("blah", "blah");
            httpclient.getCredentialsProvider().setCredentials(new AuthScope(targetHost.getHostName(), targetHost.getPort()), creds);
            NegotiateSchemeFactory nsf = new NegotiateSchemeFactory();
            httpclient.getAuthSchemes().register(AuthPolicy.SPNEGO, nsf);
            // Create AuthCache instance
            AuthCache authCache = new BasicAuthCache();
            // Generate BASIC scheme object and add it to the local auth cache
            BasicScheme basicAuth = new BasicScheme();
            authCache.put(targetHost, basicAuth);
            // Add AuthCache to the execution context
            BasicHttpContext localcontext = new BasicHttpContext();
            localcontext.setAttribute(ClientContext.AUTH_CACHE, authCache);
            httpclient = wrapClient(httpclient);

            HttpGet get;
            for (int i = 0; i < port.length; i++) {

                    get = new HttpGet("http://" + ip + ":" + port[i] + "/");

                    HttpResponse response = httpclient.execute(get);
                    try {
                        BufferedWriter out = new BufferedWriter(new FileWriter("filename", true));
                        out.write("ip:  "+ ip + " : "+port+ " - " + response.getStatusLine().getStatusCode());  //HTTP status returned off request );
                    } catch (IOException e) {
            }
        }
        }
} 
```

到目前为止，我的问题是它打开了文本文件，遇到了一个错误的结果，没有对其进行序列化，然后就因异常而死了。

我不确定如何让它继续出现异常（我知道有些网站会说“未启动”，这就是它是端口扫描器的原因。

任何帮助都会很棒，并且可能会使一些可怜的实习生免于明天手动检查大约 6000 个 ip。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:29:26.603

“坏结果”是什么意思？nmap 表示端口已打开或已关闭但不是的情况？

如果您决定继续使用 nmap 路径并希望将 nmap 与一些 Java 代码集成，请查看 sourceforge.net 上的 Nmap4j。它是一个简单的围绕 Nmap 的 Java 包装器，允许您以 Java 对象的形式访问结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:42:58.937

当无法建立连接时，您没有处理 HttpClient 引发的异常。你不应该假设它`httpclient.execute(get)`总是会毫无例外地返回。

如果您希望您的程序忽略这些条件并继续进行卡车运输，您需要捕获这些异常。

或者，您似乎想试试[nmap 。](http://nmap.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:45:38.330

你没有在你的帖子中说，但我猜它是`ClientProtocolException`在第一次请求端口 21 时抛出的，这是可以预料的，因为端口 21 不支持 HTTP。你没有捕捉到这个异常，所以你的程序死了。

# facebook - FB.ui 谜题：不一致的错误代码 191...（好像 FB.init 经常不工作）

> ID：11254347
> 
> 赞同：1
> 
> 时间：2012-06-28T23:36:04.433
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我像这样使用 FB.ui() ：

```
<script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '##########', // App ID
          channelUrl : '//www.xxxxxxxxxx.com/channel.php', // Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });

        // Additional initialization code here
      };

      // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));
    </script> 
```

然后，这是发送消息的链接：

```
<a href='#' onClick="
        FB.ui({
          method: 'send',
          name: 'Bla bla bla',
          link: 'http://www.xxxxxxxxxxx.com',
          to: ###########,
          //redirect_uri: 'http://www.xxxxxxxxxxx.com/fb/'
          });
        ">Send a message</a> 
```

**问题：** 这对我和我测试过的每台计算机/浏览器来说都是一种魅力。但是我的客户经常收到以下错误消息：

```
API Error Code: 191
API Error Description: The specified URL is not owned by the application
Error Message: redirect_uri is not owned by the application 
```

![在此处输入图像描述](../Images/3adc9a133f557690df1da24dd34e7fcc.png)

这让我完全难住了！我的代码有什么问题吗？如果是这样，为什么我的客户端始终可以在多台计算机/浏览器上重现此错误？

PS：如果您想自己尝试，该页面在[这里](http://www.streetofwalls.com/fb/)住。您必须授权该应用程序，但我保证不会发生任何令人毛骨悚然的事情。

**编辑：**错误提到了`redirect_uri`，你会注意到在我的代码中被注释掉了。原因是当我包含该参数时，当我点击“关闭”时对话不会关闭。

**EDIT2：**我能够在朋友的电脑上重现这个错误，CBroe 也证实了这一点。所以，（抛开为什么我自己仍然无法制作它的奥秘不谈），最让我难过的是为什么这只会发生一半的时间？如果我的代码不正确，它永远不会起作用，对吗？

这是错误消息中的网址：

```
https://www.facebook.com/dialog/send?display=popup&link=http%3A%2F%2Fwww.streetofwalls.com&locale=en_US&name=Career%20Networking%20powered%20by%20Street%20of%20Walls&next=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D8%23cb%3Df2c657ef78%26origin%3Dhttp%253A%252F%252Fwww.streetofwalls.com%252Ff3575a615c%26domain%3Dwww.streetofwalls.com%26relation%3Dopener%26frame%3Df1ca46b43c%26result%3D%2522xxRESULTTOKENxx%2522&sdk=joey&show_error=true&to=573501273 
```

版本后`url_decode()`：

`https://www.facebook.com/dialog/send?display=popup&link=http://www.streetofwalls.com&locale=en_US&name=Career Networking powered by Street of Walls&next=http://static.ak.facebook.com/connect/xd_arbiter.php?version=8#cb=f2c657ef78&origin=http%3A%2F%2Fwww.streetofwalls.com%2Ff3575a615c&domain=www.streetofwalls.com&relation=opener&frame=f1ca46b43c&result=%22xxRESULTTOKENxx%22&sdk=joey&show_error=true&to=573501273`

**EDIT3：** 这个难题的一部分已经解决。发生错误的时间是`FB.init()`不工作的结果。我已经把它包裹起来了`FB.ui()`，`FB.getLoginStatus(function(response){ \\... }`所以现在你可以在控制台中看到一个更有用的错误。悬而未决的问题是……为什么 FB.init() 经常失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T19:42:58.633

首先，在页面头部加载以下脚本：

```
<script type="text/javascript" src="http://www.streetofwalls.com/wp-content/themes/streetofwalls/js/main.js"></script> 
```

在该脚本中，您尝试异步加载 FB JavaScript SDK。SDK 需要`fb-root`元素才能按照[文档](https://developers.facebook.com/docs/reference/javascript/)中的说明正确加载。但是你的`fb-root`元素可能还没有被渲染，所以这就是我猜的问题。

把`window.fbAsyncInit = ...`和异步加载SDK的代码放在里面`jQuery(document).ready(function($) { ... });`就可以了。

对于调试，您还可以尝试同步加载 Facebook SDK。

我注意到的另一件事：您的网站头部有两个脚本标签，它们加载了 FB JavaScript SDK。您应该删除两者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T23:33:14.577

这是由于您的 redirect_uri 和您为 Facebook 应用程序指定的设置之间存在配置错误。[请参阅此问题](https://stackoverflow.com/questions/4691782/facebook-api-error-191)的答案。

redirect_uri 应该与您在 Facebook 应用设置中设置的站点 URL 相同（或相对）。因此，请确保您的站点 URL 已设置，并且它指向的目录等于或低于您的 redirect_uri。此外，请确保您在 Facebook 的设置中正确设置了应用程序的域。

例如：

应用域名：streetofwalls.com

站点 URL：/安全画布 URL：/安全页面选项卡 URL： http: [//www.streetofwalls.com](http://www.streetofwalls.com)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-04T03:50:51.260

因此，Nitzan 的富有洞察力的评论值得称赞，但这是解决方案。

我收到的错误消息是由于`FB.init()`没有加载，或者至少没有以相对于页面其余部分的正确顺序加载。我从 Facebook 开发人员文档中复制了代码，它异步加载......结果证明这是一个很大的痛苦......

因此，我改用老式的方式加载它，而不是我所拥有的：

```
FB.init({
      appId      : '##########', // App ID
      channelUrl : '//www.xxxxxxxxxx.com/channel.php', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    }); 
```

这与对其他脚本的一些重新排序相结合，似乎解决了我的问题。

# javascript - Meteor 中的模板内的模板

> ID：11254349
> 
> 赞同：2
> 
> 时间：2012-06-28T23:36:17.053
> 
> 标签：javascript, html, meteor

这应该很简单，但我找不到答案。

我有两个简单的车把模板如下：

```
<template name="streams">
    <div class="container">
        <div class="row-fluid">
            {{#each streamItems}}
                {{> stream}}
            {{/each}}
        </div>
    </div>
</template>

<template name="stream">
    <div class="span4">
        <h1>{{title}}</h1>
    </div>
</template> 
```

还有一些 Meteor js 如下：

```
Template.streams.streamItems = function () {
  return [
    {title: "Stream One Title"},
    {title: "Stream Two Title"}
  ];
}; 
```

现在这个组合会引发错误，但是当我用该模板中的内容替换对“流”模板的调用时，它可以工作。

```
<template name="streams">
    <div class="container">
        <div class="row-fluid">
            {{#each streamItems}}
               <div class="span4">
                  <h1>{{title}}</h1>
               </div>
            {{/each}}
        </div>
    </div>
</template> 
```

有没有办法让它与单独的模板一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:55:25.183

原来是服务器错误 - 通过重新安装解决。

# ms-access - Drupal 7 - 通过 phpmyadmin 添加节点无法正常工作

> ID：11254351
> 
> 赞同：0
> 
> 时间：2012-06-28T23:36:25.230
> 
> 标签：ms-access, drupal-7, phpmyadmin

我收到了一个 Microsoft Access 数据库文件，我的任务是将内容转换为 mySQL 标准可读的内容，用于 Drupal 7 网站数据库。我成功地将它们上传到“节点”表中，具有正确的内容类型分类、唯一的主键和节点 ID 等。或者我是这么认为的。

当我查看 Drupal 站点时，我查看了内容类型 X 的列表，所有新的东西都在那里。但是，当我尝试单击它们时，并没有像我预期的那样打开新页面，而是收到了“找不到页面”消息。我尝试通过“查找内容”手动查找新内容，但都没有出现。我检查了引用内容类型 X 的实体引用列表，但它们也没有出现在这些列表中。

我检查了内容类型 X 需要哪些字段，发现“位置类别”和“地址”是必填字段。因此，为了进行测试，我只为这些表中的每一个添加了 1 个条目（必填字段的 field_data 和 field_revision 版本），代表了我尝试转移的众多表中的第一个。依然没有。我不知道我做错了什么。谁能提供一些见解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T04:53:46.803

通过数据库向 Drupal 添加内容绝对是创建内容的错误方法。我建议您尝试以下任何一种方法：

1.  使用 Drupal 的 API 函数以编程方式创建节点：http: [//fooninja.net/2011/04/13/guide-to-programmatic-node-creation-in-drupal-7/](http://fooninja.net/2011/04/13/guide-to-programmatic-node-creation-in-drupal-7/)
2.  使用 Feeds 模块通过 CSV 文件上传数据：http: [//drupal.org/project/feeds/](http://drupal.org/project/feeds/)

# c# - 如何从单个活动序列化工作流？

> ID：11254352
> 
> 赞同：0
> 
> 时间：2012-06-28T23:36:25.740
> 
> 标签：c#, workflow-foundation-4, workflow-foundation

我希望能够在以`XamlInjector`编程方式创建的单个自定义活动上使用它来动态模拟它。目前我有以下抛出`System.ArgumentException: Illegal characters in path`. 从注射器。任何想法如何使这项工作？

```
string serializedActivity = CreateXaml(new MyActivity()); //(Activator.CreateInstance(activityType));
var xamlInjector = new XamlInjector(serializedActivity);

private static string CreateXaml(object activity) {
    StringBuilder builder = new StringBuilder();
    StringWriter writer = new StringWriter(builder);
    XamlWriter xamlWriter = ActivityXamlServices.CreateBuilderWriter(new XamlXmlWriter(writer, new XamlSchemaContext()));
    XamlServices.Save(xamlWriter, activity);
    return builder.ToString();
} 
```

以下是创建的 xaml 示例：

`<?xml version="1.0" encoding="utf-16"?><Delay xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" />`

`<?xml version="1.0" encoding="utf-16"?><CreateTemplate AuthenticationHeader="{x:Null}" BaseTdeUri="{x:Null}" CreatedTemplateId="{x:Null}" Password="{x:Null}" TemplateContent="{x:Null}" UserName="{x:Null}" xmlns="clr-namespace:XYZ.Workflow.TdeRestApi;assembly=XYZ.Workflow.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" />`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T23:12:54.017

有趣的想法 - 我应该向执行此操作的 XamlInjector 添加一个重载。

您收到错误的原因是 XamlInjector ctor 需要一个文件名，而不是序列化的 xaml。

# sql - 如何将输入传递给 Oracle SQL 中的动态查询？

> ID：11254355
> 
> 赞同：1
> 
> 时间：2012-06-28T23:36:50.367
> 
> 标签：sql, oracle, plsql

我正在尝试创建一个基于输入动态运行查询的函数。函数的第一个输入 input_id 是动态查询的参数。第二个输入 IN_QUERY_ID 指定要使用的查询。

```
create or replace  
FUNCTION getResultID(  
INPUT_ID NUMBER,  
IN_QUERY_ID NUMBER  
)  
RETURN VARCHAR2  
AS  
 RESULT_ID VARCHAR2(256);  
 query_str VARCHAR2(256);  
 BEGIN  
  select CONSTRUCTOR INTO query_str from query_str_ref     
   where QUERY_ID=IN_QUERY_ID;  
  EXECUTE IMMEDIATE query_str INTO RESULT_ID  USING INPUT_ID;  
   RETURN Result_ID;  
END getResultID; 
```

我收到一个错误，提示我在“RESULT_ID=IN_QUERY_ID;”之后没有正确结束语句 我想知道我是否错过了其他步骤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:45:33.470

您尚未`Result_ID`在函数中声明为变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T19:27:19.707

好消息是，错的不是你的函数。根据`dbms_output`@sebas 鼓励您生成的内容，您尝试动态执行的字符串是：

```
select FIRST_NAME||LAST_NAME||to_char(BIRTH_DATE,'yyyy/mm/dd') as HOST_ID FROM INPUT_DATA_TABLE WHERE INPUT_ID=NEW:INPUT_ID; 
```

这有两点不对。`NEW:INPUT_ID`导致，`ORA-00933`因为`NEW`看起来很虚假；如果您删除它，它将识别`:INPUT_ID`为绑定变量。（`NEW`看起来它来自触发器，但可能是巧合）。而且你不应该`;`在字符串上有尾随，`execute`不需要它，它会因无效字符错误而中断。

因此，如果`query_str_ref`条目更改为：

```
select FIRST_NAME||LAST_NAME||to_char(BIRTH_DATE,'yyyy/mm/dd') as HOST_ID FROM INPUT_DATA_TABLE WHERE INPUT_ID=:INPUT_ID 
```

# java - 插件依赖的Maven依赖管理

> ID：11254356
> 
> 赞同：57
> 
> 时间：2012-06-28T23:37:10.540
> 
> 标签：java, maven

最近，我遇到了以下问题：

当我为我的项目设置依赖项管理时，我有使用带有依赖项的插件的子 pom，我希望与我的依赖项管理中声明的依赖项同步。

在根 pom 中，我在依赖项管理中声明：

```
<dependencyManagement>
    <dependencies>
      ...
        <dependency>
            <groupId>com.google.gwt</groupId>
            <artifactId>gwt-user</artifactId>
            <version>2.4.0</version>
        </dependency>
      ...
    <dependencies>
<dependencyManagement> 
```

在子 pom 中，我有一个需要 gwt-user 的插件：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>gwt-maven-plugin</artifactId>
    <version>2.4.0</version>
    <dependencies>
        <dependency>
            <groupId>com.google.gwt</groupId>
            <artifactId>gwt-user</artifactId>
            <version>2.4.0</version>
        </dependency>
            ...
        </dependencies>
  ...
</plugin> 
```

但是，如果我删除 gwt-maven-plugin 中使用的依赖版本，编译将失败。

还有其他方法可以实现吗？

PS：有一个相关的帖子[在 maven 和 maven 插件](https://stackoverflow.com/questions/6030110/choosing-dependency-version-in-maven-and-maven-plugin)中选择依赖版本没有回答我的问题

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-06-29T07:57:15.457

根据以下链接，似乎不可能：

*   [http://maven.40175.n5.nabble.com/dependency-management-within-plugin-dependencies-td78367.html](http://maven.40175.n5.nabble.com/dependency-management-within-plugin-dependencies-td78367.html)
*   [https://issues.apache.org/jira/browse/MNG-2496](https://issues.apache.org/jira/browse/MNG-2496)

这是我找到的一种解决方法，我想与大家分享，以防其他人遇到同样的问题：

在我的根 pom 中，我定义了一个属性、一个依赖管理和一个插件管理：

```
<properties>
    <gwtVersion>2.4.0</gwtVersion>
    <gwtMavenPluginVersion>2.4.0</gwtMavenPluginVersion>
</properties>

<dependencyManagement>
   <dependencies>
    ...
    <dependency>
        <groupId>com.google.gwt</groupId>
        <artifactId>gwt-user</artifactId>
        <version>${gwtVersion}</version>
    </dependency>
    ...
   </dependencies>
</dependencyManagement>

<build>    
  <pluginManagement>
        <plugins>
            <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>gwt-maven-plugin</artifactId>
            <version>${gwtMavenPluginVersion}</version>
            <dependencies>
                <dependency>
                    <groupId>com.google.gwt</groupId>
                    <artifactId>gwt-user</artifactId>
                    <version>${gwtVersion}</version>
                </dependency>
                ...
            </dependencies>
            ...
        </plugins>
  ...
  </pluginManagement>
</build> 
```

在我的子 pom 中，使用插件管理提供的关系（参见[Maven2 - pluginManagement 和父子关系的问题](https://stackoverflow.com/questions/1266226/maven2-problem-with-pluginmanagement-and-parent-child-relationship)），我只声明插件依赖项：

```
<plugin>
   <groupId>org.codehaus.mojo</groupId>
   <artifactId>gwt-maven-plugin</artifactId>
</plugin> 
```

现在，如果我更改属性中的版本，它会自动影响所有直接依赖项和插件依赖项。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T23:41:18.640

对于父 POM 来控制子使用的插件版本，您应该在父 POM`<plugin>`的一个`<pluginManagement>`部分中声明。

您在部分中定义`com.google.gwt:gwt-user`为 a 。`<dependency>``<dependencyManagement>`

我不确定您是打算`gwt-user`用作插件还是依赖项，但它应该在两者中列为相同的实体，以便继承工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-11T10:24:53.217

另一种可能性是导入父 POM 的所有依赖项：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>gwt-maven-plugin</artifactId>
    <version>2.4.0</version>
    <dependencies>
        <dependency>
             <groupId>${project.groupId}</groupId>
             <artifactId>${project.artifactId}</artifactId>
             <version>${project.version}</version>
        </dependency>
            ...
        </dependencies>
  ...
</plugin> 
```

不是最漂亮的解决方案，但工作:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-09T17:59:34.113

就我而言，我使用的是 jetty maven 插件，它依赖于 hsqldb。我从 sonatype 书中复制了一些示例行（我认为那是我从中获得这些行的地方）以使用 jetty 插件，该插件将 groupId 指定为 hsqldb。我正在使用 2.3.2 版的 hsqldb。在我的依赖管理部分的父 pom 和我的持久性模块中，groupId 是 org.hsqldb。groupIds 不匹配是导致我出错的原因，因为在那个旧的 groupId 下没有版本 2.3.2。一旦我将 groupId 从 hsqldb 更改为 org.hsqldb 一切都开始工作了。

# php - 删除/重命名锁定的文件

> ID：11254361
> 
> 赞同：1
> 
> 时间：2012-06-28T23:37:51.663
> 
> 标签：php, file, delete-file, file-rename

使用 PHP，有没有办法强制解锁被同一服务器上另一个正在运行的程序锁定的文件（用于重命名/删除）？

更多详细信息：我在服务器上运行了一个图像服务，它为网络缓存了非常大的病理图像，但是当我尝试通过 PHP 界面删除或重命名图像时，当图像文件被锁定并且仍然被访问时，我无法这样做网络图像服务。

我无法控制网络服务，所以我不能告诉它关闭图像。一种解决方法是简单地重新启动 Web 服务，然后删除/重命名文件，但这会导致其他用户尝试通过 Web 访问其他图像的服务中断。

操作系统：Windows Server 2003

# android - 将自定义标题与 FEATURE_PROGRESS 相结合

> ID：11254366
> 
> 赞同：5
> 
> 时间：2012-06-28T23:38:56.807
> 
> 标签：android, android-layout, android-titlebar

在我的 onCreate() 中，我设置了一个进度条，如下所示：

```
getWindow().requestFeature(Window.FEATURE_PROGRESS);
getWindow().setFeatureInt( Window.FEATURE_PROGRESS, Window.PROGRESS_VISIBILITY_ON); 
```

现在，希望稍微增强标题栏，我想改变它的[背景](https://stackoverflow.com/a/2285722/869501)颜色。第一步是检查是否`FEATURE_CUSTOM_TITLE`支持：

```
final boolean customTitleSupported = requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
if ( customTitleSupported ) {
    Log.i(TAG, "CUSTOM TITLE SUPPORTED!")
} 
```

但是，一旦我打电话给我，`requestWindowFeature(Window.FEATURE_CUSTOM_TITLE)`我就会得到：

```
AndroidRuntimeException: You cannot combine custom titles with other title features 
```

*（不管我是在设置之前`FEATURE_PROGRESS`还是之后调用这个函数）*

知道如何[解决](https://stackoverflow.com/a/2840407/869501)这个问题吗？

**或者**，如果我能找到非自定义标题栏的资源[ID](https://stackoverflow.com/a/10592561)，我会避免使用[自定义](https://stackoverflow.com/a/3438352)标题栏。[比危险的getParent()](https://stackoverflow.com/a/11146504)更好的东西。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T18:20:48.997

正如[文件所说](https://developer.android.com/reference/android/view/Window.html#FEATURE_CUSTOM_TITLE)：

> FEATURE_CUSTOM_TITLE
> 
> 自定义标题的标志。您不能将此功能与其他标题功能结合使用。

正如您所提到的，您可以使用带有 ProgressBar 的自定义标题栏，[这是一个如何实现的示例](http://kmansoft.com/2010/09/23/showing-progress-in-standard-window-title-bar/)。

另一方面，您为什么不使用操作栏？

# jquery - JqueryMobile 分辨率 工作大小

> ID：11254379
> 
> 赞同：1
> 
> 时间：2012-06-28T23:41:42.580
> 
> 标签：jquery, iphone, jquery-mobile

您好，我目前正在为一家企业创建一个移动网站。而且我想知道在编码标题和格式时是否需要使用特定的分辨率大小。我通过 Dreamweaver 获得了两种不同的分辨率（目前仅针对 iphone 或类似的智能手机开发，没有平板电脑）。我得到了 320x480 和 480x800，我应该使用特定的尺寸吗？或者有没有办法让我的标题横幅和其他图像在一个区域内自行缩放。我希望这在很大程度上是有意义的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:52:50.980

你可以使用 CSS3[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)：

```
/* Smartphones (portrait and landscape) */
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles */
}

/* Smartphones (landscape) */
@media only screen 
and (min-width : 321px) {
/* Styles */
}

/* Smartphones (portrait) */
@media only screen 
and (max-width : 320px) {
/* Styles */
}

/* iPads (portrait and landscape) */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) {
/* Styles */
}

/* iPads (landscape) */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
/* Styles */
} 
```

# python - 何时在 ZODB 中提交数据

> ID：11254384
> 
> 赞同：11
> 
> 时间：2012-06-28T23:42:16.290
> 
> 标签：python, zodb

我正在尝试处理由以下代码生成的数据：

```
for Gnodes in G.nodes()       # Gnodes iterates over 10000 values 
    Gvalue = someoperation(Gnodes)
    for Hnodes in H.nodes()   # Hnodes iterates over 10000 values 
        Hvalue =someoperation(Hnodes)
        score = SomeOperation on (Gvalue,Hvalue)
        dic_score.setdefault(Gnodes,[]).append([Hnodes, score, -1 ]) 
```

由于字典很大（10000 个键 X 10000 个列表，每个包含 3 个元素），因此很难将其保存在内存中。我一直在寻找一种解决方案，它在生成键：值（以列表的形式）对后立即存储它们。这里建议，[以特定格式（Python）编写和阅读字典](https://stackoverflow.com/questions/11233514/writing-and-reading-a-dictionary-in-specific-format-python)，将 ZODB 与 Btree 结合使用。

如果这太天真了，请容忍我，我的问题是，什么时候应该调用`transaction.commit()`提交数据？如果我在内循环结束时调用它，则生成的文件非常大（不知道为什么）。这是一个片段：

```
storage = FileStorage('Data.fs')
db = DB(store)
connection = db.open()
root = connection.root()
btree_container = IOBTree
root[0] = btree_container 
for nodes in G.nodes()
    btree_container[nodes] = PersistentList () ## I was loosing data prior to doing this 

for Gnodes in G.nodes()       # Gnodes iterates over 10000 values 
    Gvalue = someoperation(Gnodes)
    for Hnodes in H.nodes()   # Hnodes iterates over 10000 values 
        Hvalue =someoperation(Hnodes)
        score = SomeOperation on (Gvalue,Hvalue)
        btree_container.setdefault(Gnodes,[]).append([Hnodes, score, -1 ])
        transaction.commit() 
```

如果我在两个循环之外调用它怎么办？就像是：

```
 ......
       ......
          score = SomeOperation on (Gvalue,Hvalue)
          btree_container.setdefault(Gnodes,[]).append([Hnodes, score, -1 ])
    transaction.commit() 
```

**在我调用 transaction.commit() 之前，所有数据都会保存在内存中**吗？同样，我不知道为什么，但这会导致磁盘上的文件变小。

我想最小化内存中保存的数据。任何指导将不胜感激 ！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-29T11:00:30.700

您的目标是使您的流程在内存限制内可管理。为了能够将 ZODB 作为一种工具来执行此操作，您需要了解 ZODB 事务是如何工作的，以及如何使用它们。

## 为什么您的 ZODB 变得如此之大

首先，您需要了解事务提交在这里做了什么，这也解释了为什么您的 Data.fs 变得如此之大。

ZODB 将数据写入每个事务，其中任何已更改的持久对象都将写入磁盘。这里的重要细节是*已更改的持久对象*；ZODB 以*持久对象*为单位工作。

并非每个 python 值都是持久对象。如果我定义一个直接的 python 类，它不会是持久的，也不是任何内置的 python 类型，例如 int 或 list。另一方面，您定义的任何继承自的类`persistence.Persistent` *都是*持久对象。类`BTrees`集以及`PeristentList`您在代码中使用的类*确实*继承自`Persistent`.

现在，在事务提交时，任何*已更改*的持久对象都将作为该事务的一部分写入磁盘。因此，任何`PersistentList`已附加到*的对象都将完整*地写入磁盘。`BTrees`处理这个更有效率；它们存储存储桶，它们本身是持久的，而存储桶又保存实际存储的对象。因此，对于您创建的每几个新节点，都会将一个 Bucket 写入事务，而不是整个 BTree 结构。请注意，因为保存在树中的项目本身就是持久对象，所以只有对它们的引用存储在 Bucket 记录中。

现在，ZODB 通过将事务数据附加到`Data.fs`文件来写入事务数据，并且不会自动删除旧数据。它可以通过从存储中查找给定对象的最新版本来构造数据库的当前状态。这就是为什么你`Data.fs`的增长如此之快，`PersistentList`随着事务的提交，你正在编写越来越大的实例的新版本。

删除旧数据称为**打包**，类似于`VACUUM`PostgreSQL 和其他关系数据库中的命令。只需调用变量上[的`.pack()`方法](http://grok.zope.org/documentation/how-to/how-to-reduce-the-size-of-your-zodb-database)`db`以删除*所有*旧版本，或使用该方法的`t`and`days`参数来设置要保留多少历史记录的限制，第一个是`time.time()`时间戳（自纪元以来的秒数），您可以在此之前打包，并且`days`是从当前时间或`t`指定的过去保留的天数。随着旧事务中的部分列表被删除，打包应该会大大减少您的数据文件。请注意，打包是一项昂贵的操作，因此可能需要一段时间，具体取决于数据集的大小。

## 使用事务管理内存

您正在尝试构建一个非常大的数据集，通过使用持久性来解决内存限制，并使用事务来尝试将内容刷新到磁盘。但是，通常，使用事务提交信号，您已经完成了数据集的构建，您可以将其用作一个原子整体。

您需要在这里使用的是一个*保存点*。保存点本质上是子事务，在整个事务期间您可以请求将数据*临时*存储在磁盘上的一个点。当您提交事务时，它们将成为永久性的。要创建保存点，请在事务上调用[`.savepoint`方法](http://www.zodb.org/zodbbook/api.html#transaction.savepoint)：

```
for Gnodes in G.nodes():      # Gnodes iterates over 10000 values 
    Gvalue = someoperation(Gnodes)
    for Hnodes in H.nodes():  # Hnodes iterates over 10000 values 
        Hvalue =someoperation(Hnodes)
        score = SomeOperation on (Gvalue,Hvalue)
        btree_container.setdefault(Gnodes, PersistentList()).append(
            [Hnodes, score, -1 ])
    transaction.savepoint(True)
transaction.commit() 
```

在上面的示例中，我将`optimistic`标志设置为 True，这意味着：*我不打算回滚到此保存点*；某些存储不支持回滚，并且发出不需要回滚的信号会使您的代码在这种情况下工作。

另请注意，`transaction.commit()`当整个数据集已被处理时会发生这种情况，这是提交应该实现的。

保存点所做的一件事是调用 ZODB 缓存的垃圾收集，这意味着当前未使用的任何数据都将从内存中删除。

注意那里的“当前未使用”部分；如果您的任何代码在变量中保留较大的值，则无法从内存中清除数据。据我可以从您向我们展示的代码中确定，这看起来不错。但是我不知道您的操作是如何工作的，也不知道您是如何生成节点的；例如，当迭代器会这样做时，请注意避免在内存中构建完整的列表，或者构建引用所有列表列表的大型字典。

您可以对创建保存点的位置进行一些试验；您可以在每次处理完一个时创建一个`HNodes`，或者仅在完成`GNodes`我上面所做的循环时创建一个。您正在构建一个列表 per `GNodes`，因此它会保留在内存中，同时循环遍历所有内容`H.nodes()`，并且刷新到磁盘可能只有在您完成完整构建后才有意义。

但是，如果您发现需要更频繁地清除内存，则应考虑使用`BTrees.OOBTree.TreeSet`类或`BTrees.IOBTree.BTree`类而不是 a`PersistentList`将数据分解为更持久的对象。A`TreeSet`是有序的，但不是（容易）可索引的，而 a`BTree`可以通过使用简单的递增索引键用作列表：

```
for i, Hnodes in enumerate(H.nodes()):
    ...
    btree_container.setdefault(Gnodes, IOBTree())[i] = [Hnodes, score, -1]
    if i % 100 == 0:
        transaction.savepoint(True) 
```

上面的代码使用 BTree 而不是 PersistentList，并且每`HNodes`处理 100 个就创建一个保存点。因为 BTree 使用本身就是持久对象的存储桶，所以可以更轻松地将整个结构刷新到保存点，而不必留在内存中以供所有`H.nodes()`处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T06:53:43.500

什么构成事务取决于您的应用程序中需要“原子”的内容。如果事务失败，它将回滚到之前的状态（就在最后一次提交之后）。从您的应用程序代码中可以看出，您希望为每个 Gnode 计算一个值。因此，您的提交可以像这样在 Gnodes 循环结束时进入：

```
for Gnodes in G.nodes():       # Gnodes iterates over 10000 values 
    Gvalue = someoperation(Gnodes)
    for Hnodes in H.nodes():   # Hnodes iterates over 10000 values 
        Hvalue =someoperation(Hnodes)
        score = SomeOperation on (Gvalue,Hvalue)
        btree_container.setdefault(Gnodes,[]).append([Hnodes, score, -1 ])
    # once we calculate the value for a Gnodes, commit
    transaction.commit() 
```

从您的代码中可以看出，“Hvalue”组合不依赖于 Gvalue 或 Gnodes。如果它是一项昂贵的操作，即使它不影响其计算，您也要为每个 Gnode 计算 1000 次。所以，我会把它移出循环。

```
# Hnodes iterates over 10000 values
hvals = dict((Hnodes, someoperation(Hnodes)) for Hnodes in H.nodes())
# now you have mapping of Hnodes and Hvalues

for Gnodes in G.nodes():       # Gnodes iterates over 10000 values 
    Gvalue = someoperation(Gnodes)
    for Hnodes, Hvalue in hvals.iteritems(): 
        score = SomeOperation on (Gvalue,Hvalue)
        btree_container.setdefault(Gnodes,[]).append([Hnodes, score, -1 ])
    # once we calculate the value for a given Gnodes, commit
    transaction.commit() 
```

# linux - 如何连接到 xterm 进程并执行 IO？

> ID：11254388
> 
> 赞同：1
> 
> 时间：2012-06-28T23:42:51.503
> 
> 标签：linux, process, xterm

我有一个 xterm 在 Linux 机器上运行一个很长的任务。我想登录并连接到该 xterm 并查看发生了什么……（我尽我所能解释这一点）。

我想我要问的是 - 当我远程登录时，我可以监视和控制桌面上已经打开的 xterm 吗？有没有办法通过管道输入和输出 IO？

# language-agnostic - 不需要声明变量类型的语言的质量是否是弱类型或动态类型的示例

> ID：11254393
> 
> 赞同：4
> 
> 时间：2012-06-28T23:43:16.523
> 
> 标签：language-agnostic, strong-typing, static-typing, dynamic-typing, weak-typing

不需要声明变量类型（例如 PHP 和 Perl）的语言的质量是弱类型还是动态类型？我很难理解这两个术语。

动态/静态类型与类型转换有关，而弱/强类型与变量减速有关，我对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:54:46.210

根据：[http ://en.wikipedia.org/wiki/Type_system#Static_and_dynamic_type_checking_in_practice](http://en.wikipedia.org/wiki/Type_system#Static_and_dynamic_type_checking_in_practice)

> 弱类型化意味着一种语言在使用时会隐式转换（或强制转换）类型。

然而：

> 当在编译时而不是运行时执行类型检查时，据说编程语言使用静态类型。

因此，强/弱和静态/动态是两个不同的维度。一种语言将是强/弱的一种，也是静态动态的一种。例如，Ruby 和 Javascript 都是动态类型的，但 Ruby 是强类型，而 Javascript 是弱类型。也就是说，在 Ruby 中，以下代码会给出错误：

```
1.9.2p290 :001 > 'a'+1
TypeError: can't convert Fixnum into String 
```

而在 JavaScript 中，你会得到：

```
> 'a'+1
>> 'a1' 
```

因此，强类型语言要求您将两个变量转换为相同类型以便组合它们（例如，使用 1.to_s），而弱类型语言将尝试使用一些额外的内置变量将两个变量强制转换为相同类型- 在语言逻辑中 - 在 JavaScript 的情况下，将任何内容与 String 组合将其转换为 String 值。

请参阅：[http](http://www.artima.com/weblogs/viewpost.jsp?thread=7590) ://www.artima.com/weblogs/viewpost.jsp?thread=7590以获得进一步的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:01:49.373

简单来说，强类型更多地与对象的绑定方式（本质上是早期绑定与后期绑定）有关，而不是与对象的声明方式有关。

假设在 C# 中我有这个类：

```
public class Foo
{
    public int Bar;
    public double Baz;
} 
```

我声明了一个 foo 类型的变量：

```
var myFoo = new Foo(); 
```

当我引用 Foo 时，如下所示：

```
foo. 
```

当我键入 时， Visual Studio 将显示一个包含`Bar`和的列表，因为它已经知道包含这些成员；它是类型。这是强类型；这意味着如果我拼错 Bar 或 Baz，我的程序甚至无法编译。 `Baz``.``myFoo``Foo`

但是，假设我声明了一个类型为`dynamic` This 的变量，这会导致对象绑定延迟到程序执行为止：

```
dynamic myFoo = new Foo();
myFoo.Grapes = 6; 
```

这将编译。在程序运行之前我不会得到错误；将抛出运行时异常，因为 Grapes 不存在于`Foo`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-30T23:58:40.370

这是一个老问题，但对于未来的读者来说，这篇很棒的文章可能会让事情变得更清楚：http: [//blogs.perl.org/users/ovid/2010/08/what-to-know-before-debating-type-systems。 html](http://blogs.perl.org/users/ovid/2010/08/what-to-know-before-debating-type-systems.html)

它有点长，但绝对值得。

强类型和弱类型：

> 可能最常见的类型系统分类方式是“强”或“弱”。这是不幸的，因为这些词几乎没有任何意义。在有限的范围内，可以将两种语言与非常相似的类型系统进行比较，并指定一种语言具有这两种系统中更强的一种。除此之外，这些话根本没有任何意义。

静态和动态类型

> 这几乎是唯一具有实际意义的类型系统的常见分类。事实上，它的重要性经常被低估 [...] 动态和静态类型系统是两个完全不同的东西，它们的目标恰好部分重叠。
> 
> 静态类型系统是一种机制，编译器通过该机制检查源代码并将标签（称为“类型”）分配给语法片段，然后使用它们来推断程序的行为。动态类型系统是一种机制，编译器通过该机制生成代码以跟踪程序使用的数据类型（巧合的是，也称为“类型”）。当然，在这两个系统中使用同一个词“类型”并非完全巧合。但最好将其理解为具有某种微弱的历史意义。试图找到一种世界观，其中“类型”在两个系统中真正意味着相同的东西，导致了极大的混乱。它没有。

显式/隐式类型：

> 当使用这些术语时，它们指的是编译器对程序部分的静态类型进行推理的程度。所有编程语言都有某种形式的关于类型的推理。有些人比其他人拥有更多。ML 和 Haskell 具有隐式类型，因为不需要（或很少，取决于使用的语言和扩展）类型声明。Java 和 Ada 有非常明确的类型，并且不断地声明事物的类型。以上所有都具有（例如，相对于 C 和 C++）强静态类型系统。

# c++ - 内存占用分析

> ID：11254398
> 
> 赞同：1
> 
> 时间：2012-06-28T23:43:56.010
> 
> 标签：c++, c, memory-management, valgrind, memory-footprint

假设我有一个用 C/C++ 编写的程序，我想知道有多少内存用于数据（堆、堆栈）以及有多少内存用于代码（库、可执行文件等）。

我曾经测量过使用“valgrind”使用的动态内存空间，但我认为它没有分析数据和代码的内存占用的功能。

平台：Mac（可能是 Linux）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T00:41:31.493

您的开发环境应该有某种链接器选项。通常在这种情况下，您可以指示它创建链接映射。您要查找的信息很可能在链接图中，或者可以根据链接图中的信息计算得出。

# iphone - 创建将在会话之间保存的 sqlite 表

> ID：11254399
> 
> 赞同：0
> 
> 时间：2012-06-28T23:43:58.343
> 
> 标签：iphone, objective-c, database, sqlite, persistence

是否可以在目标 c 中动态创建将在 iPhone 会话之间保存的 sqlite 表？如果是这样，我该如何做到这一点？

# oop - VBA：如何测试对象是否相等（两个变量是否引用同一个对象）

> ID：11254401
> 
> 赞同：18
> 
> 时间：2012-06-28T23:44:02.220
> 
> 标签：oop, vba

测试同一自定义对象类型的两个变量是否引用同一对象的运算符或函数是什么？我试过了

```
If myObject = yourObject Then 
```

但是得到一个运行时错误 438 对象不支持这个属性或方法。我猜这告诉我重写'='运算符来测试两个对象的所有字段是否具有相同的值。但我想要的是测试它们是否是同一个对象。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-28T23:59:41.717

> 我猜这告诉我重写'='运算符来测试两个对象的所有字段是否具有相同的值。

不，它告诉您对象没有默认属性，否则会调用该属性，并比较返回的结果。

你用`Is`

```
If myObject Is yourObject Then 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-12-09T18:05:35.440

您需要以某种方式序列化对象，然后按属性值比较属性。"is" 操作符是愚蠢的，它只有在另一个对象是分配给比较变量的同一个实例时才匹配。我建议使用 jsonStringify 库。[我从在 Excel VBA 中解析 JSON](https://stackoverflow.com/questions/6627652/parsing-json-in-excel-vba)帖子开始为我的 DexTools.xlam 开源项目[https://github.com/dexterial/Dextools/tree/master/Main](https://github.com/dexterial/Dextools/tree/master/Main)改编了一个。由于我添加了许多其他 excel 对象序列化/散列选项，它具有更多附加功能，并且它是使用 DexTools 合并的 vba 测试驱动开发制作的。它仍在进行中，所以不要指望奇迹

# javascript - firefox 不适用于 event.target.id

> ID：11254405
> 
> 赞同：-2
> 
> 时间：2012-06-28T23:44:29.507
> 
> 标签：javascript, jquery, javascript-events

我的 JavaScript 中有这个

```
var identifier = event.target.id; 
```

它适用于chrome，但在Firefox中它给了我

```
event is not defined
(?)()gift_c...oval.js (line 16)
add(c=Object { originalEvent=Event click, type="click", timeStamp=897038643, more...})jquery.min.js (line 3)
add(a=click clientX=1023, clientY=158)jquery.min.js (line 3)
[Break On This Error]   

var identifier = event.target.id; 
```

我怎样才能让它跨浏览器兼容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:50:59.343

你通过`event`了`function()`吗？

就像是

```
$('#id').click(function(event) {
     var identifier = event.target.id;
}); 
```

# php - 通过 PHP 中的辅助方法访问包含文件中的变量

> ID：11254408
> 
> 赞同：1
> 
> 时间：2012-06-28T23:45:03.483
> 
> 标签：php, include, scope

我正在尝试构建一个 php 类，它可以让我包含其他要显示的 php“模板”文件。我希望调用它的范围内的所有变量都可以在包含的文件中使用。这是关键，我想将实际包含传递给辅助方法以保持代码干燥。这是我到目前为止所拥有的：

```
/* TemplateLoader.php */
class TemplateLoader {
  public function foo() {
    $var = "FOO!";
    //Works
    include 'template.php';
  }

  public function bar() {
    $var = "BAR!";
    //Doesn't work
    $this->render("template");
  }

  private function render( $name ) {
    include $name . '.php';
  }
}

/* template.php */
<?php echo $var; ?> 
```

我的问题是：**我如何才能完成将模板直接包含在原始方法中的行为，同时仍然使用辅助方法来实际执行“繁重的工作”？**我非常感谢您能提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:48:50.427

这是我首先想到的——我不确定我是否喜欢它，但我不确定是否有通用的替代方案。这使用 捕获所有当前变量[`get_defined_vars()`](http://php.net/get_defined_vars)，并将它们传递到它们`render()`所在的位置[`extract()`](http://php.net/extract)，因此可以被包含的文件访问。

您可能可以在将返回值[`get_defined_vars()`](http://php.net/get_defined_vars)传递给 之前对其进行过滤`render()`，但我应该工作。

```
public function bar() {
    $var = "BAR!";
    $this->render("template", get_defined_vars());
}

private function render( $name, &$vars) {
    extract( $vars);
    include $name . '.php';
} 
```

您可能可以在将返回值`get_defined_vars()`传递给 之前对其进行过滤`render()`，但它应该可以工作。

# ruby-on-rails - 测试没有导轨的导轨视图助手的最佳方法

> ID：11254412
> 
> 赞同：1
> 
> 时间：2012-06-28T23:45:18.290
> 
> 标签：ruby-on-rails, actionview

我正在制作一个 gem，它定义了一些与框架无关的帮助器来生成 html。Sinatra 下的测试是微不足道的。但是我需要什么来通过 rails erb 和 haml 渲染来测试 hepler 而不必需要完整的堆栈？

我想在某些时候我必须要求'action_view'和'action_view/renderer/renderer'

# sql - 我可以给多个列起别名吗？如何？

> ID：11254413
> 
> 赞同：2
> 
> 时间：2012-06-28T23:45:34.593
> 
> 标签：sql, postgresql, alias, pyodbc

我正在使用 pyodbc 和 postgres。

我可以给多个列起别名吗？

这是我的问题的描述：

数据结构：

```
data
id | c1  | c2
-------------
1  | 11  | 12
2  | 21  | 22 
```

符号：c 代表列

```
dictionary
id | key | value
----------------
1  | k1  | v11
1  | k2  | v12
2  | k1  | v21
2  | k2  | v22 
```

符号：k 代表键，v 代表值

您可以将 k1 和 k2 视为另外两列。数据结构是这样的，因为它在不断变化。我没有设计它，我只需要跟着它走。

我想不出一个 sql 查询来给我如下内容（最重要的是，对于某些行，我可以通过某个名称访问 k1 和 k2 列）：

```
data
id | c1  | c2  | k1  | k2
-------------------------
1  | 11  | 12  | v11 | v12
2  | 21  | 22  | v21 | v22 
```

我一直遇到的问题是，如果我给表起别名，那么 sql 结果将包含字典表中的两个“键”列，这意味着我无法控制我访问这两个列中的哪一列，但是如果我给行起别名，那么我无法控制在 sql 语句中引用了哪些表。

我正在考虑的修复是别名两列：

```
SELECT * FROM data
FULL JOIN dictionary AS a1,a2,a3
ON data.id = a1
FULL JOIN dictionary AS a4,a5,a6
ON data.id = a4
WHERE a2 = k1 and a5 = k2 
```

符号：a 代表别名

这个结果理论上看起来像

```
data
id | c1  | c2  | a3  | a6 
------------------------- 
1  | 11  | 12  | v11 | v12
2  | 21  | 22  | v21 | v22 
```

请注意，从技术上讲，所有 a 都在这里，但 3 和 6 是我感兴趣的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:49:24.650

您可以为整个表设置别名，例如`dictionary as d1`. 然后将该表中的列名称为`d1.col1`. 例如：

```
SELECT  d.id
,       d.c1
,       d.c2
,       d1.value as a3
,       d2.value as a6
FROM    data as d
LEFT JOIN
        dictionary as d1
ON      data.id = d1.id
        and d1.key = 'k1'
LEFT JOIN
        dictionary as d2
ON      data.id = d2.id
        and d2.key = 'k2' 
```

# routes - Ember.js：Router/Route 和 StateManager/State 有什么区别？

> ID：11254417
> 
> 赞同：9
> 
> 时间：2012-06-28T23:46:03.153
> 
> 标签：routes, ember.js, ember-old-router

似乎较旧的路由使用`StateManager`示例和较新的示例使用`Router`. 有什么区别以及为什么要使用其中一个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-29T00:16:09.507

Router 和 Route 只是 StateManager 和 State 的子类，最初将特定于路由的代码直接添加到 StateManager 代码中，但最近几周已经努力将其提取出来。

基本上将路由器用于处理 URL 等的应用程序的核心流程，但如果您需要在应用程序的其他位置使用额外的状态管理器，则可以使用 StateManager/State 而无需包含额外的路由代码没有必要。

# actionscript-3 - 为多语言 Flex 应用程序加载和卸载字体

> ID：11254418
> 
> 赞同：3
> 
> 时间：2012-06-28T23:46:07.083
> 
> 标签：actionscript-3, flash, apache-flex, fonts

我的 Flex 应用程序允许人们输入文本。有多种字体可供选择。因为它是一个多语言应用程序，其中一些字体（例如中文）确实非常大 - 太大而无法嵌入所有字体。

我知道我可以[在运行时通过样式表加载字体](http://livedocs.adobe.com/flex/3/html/help.html?content=styles_10.html)- 我计划在人们选择字体时执行此操作（在字体加载时稍等片刻不是问题）。我想要做的是再次*卸载*这些字体，这样如果人们选择一种字体然后另一种字体，应用程序就不会消耗大量内存。

不过，我看不出有什么办法。我可以在运行时加载字体，但不能卸载它们。有任何想法吗？

我确实在 SO 上看到[了这个问题](https://stackoverflow.com/questions/1812999/adobe-flex-loading-embedded-fonts-from-modules)，它提到将字体加载为模块的一部分——我猜每个模块一个字体。优点是可以卸载模块。但是，正如提问者指出的那样，在模块之外无法访问该字体。所以这似乎是一个死胡同。

如果不可能，我会 - 遗憾地 - 接受一个答案，告诉我这是不可能的，但更有用的是另一种策略！这一定是人们以前遇到过的一个很常见的场景......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T09:13:56.767

正如你的直觉所暗示的，这对于 flex 开发人员来说是一个相对常见的场景——必须有一个解决方案！

正如您所建议的，我会将样式表编译为模块，并在每个模块中嵌入字体（对于中文，我建议您尽可能考虑指定 unicode 范围以节省字体大小：[http ://renaun.com/blog/2011/ 10/flash-embed-font-unicode-range-generator/](http://renaun.com/blog/2011/10/flash-embed-font-unicode-range-generator/) )。

有 3 个应用程序域可以将模块加载到父应用程序中。看看这个：[http](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e07.html) ://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e07.html 。我相信 3 种方式中的 2 种可以让您使用模块中的资源。最简单的方法是使用相同的应用程序域加载它——这意味着您假设模块中的类与父类相同。

确保您的构建系统使用与父应用程序相同版本的 sdk 编译模块。否则，您将遇到编组类的 actionscript 运行时错误。

最后，您如何分析您的垃圾收集应用程序？你在使用 flash builder 的内置分析器吗？在 flex 应用程序上强制垃圾收集很烦人（据我记得，你必须调用`System.gc()`两次或类似的一些奇怪的巫毒魔法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T07:41:33.740

以下是一些有用的链接：

*   [http://livedocs.adobe.com/flex/3/html/help.html?content=fonts_04.html](http://livedocs.adobe.com/flex/3/html/help.html?content=fonts_04.html)（特别是参见“在 ActionScript 中嵌入字体”部分）
*   [http://divillysausages.com/blog/as3_font_embedding_masterclass](http://divillysausages.com/blog/as3_font_embedding_masterclass)
*   [http://bryanlangdon.com/blog/2007/03/22/loading-fonts-dynamically-in-actionscript-2-and-3/](http://bryanlangdon.com/blog/2007/03/22/loading-fonts-dynamically-in-actionscript-2-and-3/)

您可以将字体从外部嵌入 SWF 文件（每种字体一个），根据需要加载它们，并使用与 SWF Embed 的“fontName”相同的值作为 CSS 的“fontFamily”。

当用户完成操作并且您已清除对字体的所有引用时，您可以卸载 SWF (Loader.unloadAndStop()) 并将其设置为 null。我认为这会提示它进行垃圾收集并释放内存。

我认为这是你最好的选择，因为要使用一种字体，它必须注册，无论你是如何做到这一点的。并且没有 Font.unregisterFont() 方法。该解决方案至少可以让您释放到那时为止的所有内容。

虽然我很好奇 Font.enumerateFonts() 是否仍会列出字体，以及它是否真的被释放用于垃圾收集......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T09:17:27.550

我没有深入了解它，但我也认为不可能卸载已注册的字体。

我只能想到两个可能不可行的解决方法：

*   想出一种精心设计且可靠的方式来使用设备字体。我想这意味着对不同系统和国家/地区可用/需要的字体进行相当广泛的调查，但如果你没有将字体用于非常图形化的东西，我认为它可能会被取消。

*   更改字体时重新加载整部电影。这显然很大程度上取决于您的应用程序是什么样的，但也许您可以保存应用程序状态并通过 javascript 重新加载它，或者甚至可以有一个单独的覆盖 swf 供您按需加载（也许后者可以在单独的应用程序中加载 swf /security 域，但我不确定注册的字体是否会被正确沙盒化）。

无论如何，我猜它是一个 Flex 应用程序会使事情变得相当复杂，并使任何开箱即用的东西都变得毫无用处......

# javascript - 使用 Javascript SDK 在 Facebook 应用程序上进行无限登录循环

> ID：11254419
> 
> 赞同：0
> 
> 时间：2012-06-28T23:46:13.480
> 
> 标签：javascript, facebook, authentication, facebook-graph-api, oauth

我基于 Facebook Developer 示例应用程序之一构建了一个应用程序，但是几天前我的应用程序和 Facebook 示例应用程序都停止了对所有用户的工作 - 他们现在在您登录后进入无限循环：[http://myfbse。 com/社交电影/](http://myfbse.com/socialmovies/)

这是我一直在使用的示例代码的链接： [https ://developers.facebook.com/blog/post/2011/03/18/how-to--use-the-graph-api-to-pull-电影朋友喜欢/](https://developers.facebook.com/blog/post/2011/03/18/how-to--use-the-graph-api-to-pull-the-movies-friends-like/)

我已经在多台计算机、不同的浏览器上进行了测试，尝试在我的 Facebook 帐户中添加和删除应用程序并清除所有 cookie 等。

我想知道如何找出问题所在、迁移问题、错误或其他问题？我已经通过 Facebook 调试工具运行了该应用程序，它没有发现任何问题。是否有其他方法可以获取有关导致问题的原因的更详细信息？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T18:58:00.060

我通过将 Facebook Developer 示例应用程序中的身份验证代码替换为此处的身份验证代码来修复无限循环：[https ://developers.facebook.com/blog/post/525/](https://developers.facebook.com/blog/post/525/)

我猜示例身份验证代码已过时。

# android - LogCat 中的“表面”标签错误

> ID：11254424
> 
> 赞同：1
> 
> 时间：2012-06-28T23:47:55.800
> 
> 标签：android, surfaceview, logcat

在开发一个非常基本的相机应用程序时，我遇到了一组非常具体的错误。该代码几乎与android网站上的代码相同。

Galaxy SII 是唯一一款在我的 LogCat 控制台中显示如下错误的手机：

```
06-28 16:28:40.098: E/Surface(1650): Surface::init token -2 identity 18 
```

“身份”后面的数字发生了变化（42、38 等），但错误仍然存​​在。

我认为这可能与以下课程有关，但仍不确定其含义：

```
public class CameraPreview extends SurfaceView implements SurfaceHolder.Callback 
```

Galaxy SII 可能会导致此错误怎么办？我还在 HTC Vivid 和 Pantech Burst 上进行测试。我担心这可能会导致更大的问题。我只是想了解这个错误可能是什么。

这是来源：

```
package com.basicam.android;

import android.app.Activity;
import android.content.Context;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.hardware.Camera;
import android.os.Build;
import android.os.Bundle;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.widget.Toast;

public class CamActivity extends Activity {

    private SurfaceView preview=null;
    private SurfaceHolder previewHolder=null;
    private Camera camera=null;
    private boolean inPreview=false;
    private boolean cameraConfigured=false;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        Log.d("crap","oncreated");
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        preview=(SurfaceView)findViewById(R.id.preview);
        previewHolder=preview.getHolder();
        previewHolder.addCallback(surfaceCallback);
        previewHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    @Override
    public void onResume() {
        super.onResume();

        camera=Camera.open();
        startPreview();
    }

    @Override
    public void onPause() {
        if (inPreview) {
            camera.stopPreview();
        }

        camera.release();
        camera=null;
        inPreview=false;

        super.onPause();
    }

    private Camera.Size getBestPreviewSize(int width, int height,
            Camera cam) {
        Camera.Size result=null;
        Log.d("crap", "can haz preview sizes?");
        int i = 0;
        for (Camera.Size size : cam.getParameters().getSupportedPictureSizes()) {

            Log.d("sizew", ""+size.width);
            if (size.width<=width && size.height<=height) {
                Log.d("sizew", ""+size.width);
                Log.d("sizeh", ""+size.height);
                if (result==null) {
                    result=size;
                }
                else {
                    int resultArea=result.width*result.height;
                    int newArea=size.width*size.height;

                    if (newArea>resultArea) {
                        result=size;
                    }
                }
            }
        }

        return(result);
    }

    private void initPreview(int width, int height) {
        if (camera!=null && previewHolder.getSurface()!=null) {
            try {
                camera.setPreviewDisplay(previewHolder);
            }
            catch (Throwable t) {
                Log.e("PreviewDemo-surfaceCallback",
                        "Exception in setPreviewDisplay()", t);
            }

            if (!cameraConfigured) {
                Camera.Parameters parameters=camera.getParameters();
                Camera.Size size=getBestPreviewSize(width, height,
                        camera);

                if (size!=null) {
                    parameters.setPreviewSize(size.width, size.height);
                    camera.setParameters(parameters);
                    cameraConfigured=true;
                }
            }
        }
    }

    private void startPreview() {
        if (cameraConfigured && camera!=null) {
            camera.startPreview();
            inPreview=true;
        }
    }

    SurfaceHolder.Callback surfaceCallback=new SurfaceHolder.Callback() {
        public void surfaceCreated(SurfaceHolder holder) {
            // no-op -- wait until surfaceChanged()
        }

        public void surfaceChanged(SurfaceHolder holder,
                int format, int width,
                int height) {

            initPreview(width, height);
            startPreview();
        }

        public void surfaceDestroyed(SurfaceHolder holder) {
            // no-op
        }
    };

} 
```

# ruby - 用 -R 注释命令“没有这样的文件加载”

> ID：11254425
> 
> 赞同：0
> 
> 时间：2012-06-28T23:48:21.513
> 
> 标签：ruby, annotate

在使用版本 2.4.1.beta 加载模型之前使用选项加载其他文件时，该`annotate`命令会失败。`-R`似乎找到了文件，但仍然发生错误（如果我使用通配符路径，第一个文件将显示为错误）。此处出现类似的错误消息（[https://github.com/ctran/annotate_models/issues/78](https://github.com/ctran/annotate_models/issues/78)）解决方案可以使用：

`gem 'annotate', github: 'ctran/annotate_models'`

但是如果我用上面`annotate`的替换，`Gemfile`然后做：

```
gem uninstall annotate
bundle install 
```

然后`bundle`在第一行报告：
Updating git://github.com/ctran/annotate_models.git

及更高版本：
使用来自 git://github.com/ctran/annotate_models.git 的注释（2.5.0.pre1）（在master）

请注意，两条消息都没有显示“正在安装”。然后执行`annotate`以找不到注释可执行文件结束。有什么解决办法吗？（红宝石 1.9.2p280，Rails 3.2.2）

# ruby - 在 ActiveRecord 对象数组中查找值与从重复的 DB 调用中查找值

> ID：11254426
> 
> 赞同：1
> 
> 时间：2012-06-28T23:48:39.593
> 
> 标签：ruby, ruby-on-rails-3

如果我的联系人数组（模型）包含一个 id 等于某个值的联系人，我只想返回 true。例如：

```
@contacts = Contact.all

@someval = "alskjdf"

find_val(@contacts, @someval)

def find_val(contacts, val)
  @contact.each do |c|
    if c.id == val
      return true
    end
  end
  return false
end 
```

我必须在我的应用程序中重复执行此操作（对于此特定操作最多大约 100 次），以便从具有联系人列表的外部 API 中排除一些数据。这会不会太贵了？

我想我可以做一些更快的事情，类似于从数据库中拉下后在阵列上找到的 ActiveRecord，但无法弄清楚。像这样调用 ActiveRecord 会不会太贵？

```
Contacts.find_by_id(@someval) 
```

上面的行必须被调用数百次......我认为遍历数组会更便宜。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:01:05.740

最好的方法是在哈希中索引联系人，在从数据库中检索所有联系人后，使用联系人 ID 作为键：

```
contacts = Contact.all.inject({}) {|hash, contact| hash[contact.id] = contact; hash } 
```

然后，您可以轻松地以高效的`contact[id]`方式取得联系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:01:21.840

减少搜索数组所需编写的代码量的一种方法是打开数组类并创建一个自定义实例方法：

```
class Array
  def haz_value?(someval)
    if self.first.respond_to? :id
      self.select { |contact| contact.id == someval }.length > 0
    else
      false
    end
  end
end 
```

然后，您可以调用`@contacts.haz_value? @someval`. 效率方面，我没有做过比较，但是两种方式都使用了Array的内置迭代器。在您的数据库中创建存储过程并通过 ActiveRecord 调用它可能会更快，[这是您可以做到的](http://oldwiki.rubyonrails.org/rails/pages/StoredProcedures)。

# javascript - 隐藏具有相同类名的所有元素？

> ID：11254429
> 
> 赞同：34
> 
> 时间：2012-06-28T23:49:01.347
> 
> 标签：javascript

我试图隐藏具有相同类名（float_form）的元素，但我也试图使用下面的脚本来显示它们（所有 float_form 类 div 最初都是隐藏的）。我看过很多 jquery 解决方案，但我似乎无法让它们中的任何一个为此工作。

```
function show(a) {
    var e = document.getElementById(a);
    if (!e) 
        return true;

    if (e.style.display == "none") {
        e.style.display = "block"
    } else {
        e.style.display = "none"
    }
    return true;
}
​ 
```

**编辑：**抱歉，如果不清楚，我不打算使用 Jquery（而且我知道这不是 jquery）。我正在寻找一种使用 javascript 来识别不在 style= display:none; 中的重复类名的方法。不影响显示/隐藏 ID 元素，因为有一个以 div id 作为键的循环。div 的 html 如下所示，其中 {item.ID} 是一个 while 循环。

```
 <div class="float_form" id="{item.ID}" style="display: none;"> 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-06-28T23:52:11.577

**香草 javascript**

```
function toggle(className, displayState){
    var elements = document.getElementsByClassName(className)

    for (var i = 0; i < elements.length; i++){
        elements[i].style.display = displayState;
    }
}

toggle('float_form', 'block'); // Shows
toggle('float_form', 'none'); // hides 
```

**jQuery：**

```
$('.float_form').show(); // Shows
$('.float_form').hide(); // hides 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-28T23:51:31.730

如果您正在研究 jQuery，那么很高兴知道您可以在参数中使用类选择器`$`并调用方法`.hide()`。

```
$('.myClass').hide(); // all elements with the class myClass will hide. 
```

但如果它是您正在寻找的切换，请使用`.toggle();`

但这是我在**不**使用 jQuery 的情况下对一个很好的切换的看法：

```
function toggle( selector ) {
  var nodes = document.querySelectorAll( selector ),
      node,
      styleProperty = function(a, b) {
        return window.getComputedStyle ? window.getComputedStyle(a).getPropertyValue(b) : a.currentStyle[b];
      };

  [].forEach.call(nodes, function( a, b ) {
    node = a;

    node.style.display = styleProperty(node, 'display') === 'block' ? 'none' : 'block';
  });

}

toggle( '.myClass' ); 
```

演示在这里（点击“渲染”运行）：http: [//jsbin.com/ofusad/2/edit#javascript,html](http://jsbin.com/ofusad/2/edit#javascript,html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-01-29T10:12:31.550

使用 jQuery

```
$(".float_form").each(function(){
    if($(this).css("display") == "none"){
        $(this).show();
    }else{
        $(this).hide();
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-13T18:33:42.180

# 不需要 jQuery

```
const toggleNone = className => {
  let elements = document.getElementsByClassName(className)
  for (let i = 0; i < elements.length; i++){
    if (elements[i].style.display === "none") {
      elements[i].style.display = "";
    } else {
      elements[i].style.display = "none";
    }
  }
}

const toggleVisibility = className => {
  let elements = document.getElementsByClassName(className)
  for (let i = 0; i < elements.length; i++){
    let elements = document.getElementsByClassName(className);
    if (elements[i].style.visibility === "hidden") {
      elements[i].style.visibility = "";
    } else {
      elements[i].style.visibility = "hidden";
    }
  }
}

// run 
toggleNone('your-class-name-here'); // toggles remove
// or run 
toggleVisibility('your-class-name-here'); // toggles hide 
```

### 以 ES6 语法提供的答案，但如果您愿意，可以轻松转换为 ES5

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T23:51:12.713

尝试 ：

```
function showClass(a){
 var e = [];
 var e = getElementsByClassName(a);
 for(i in e ){
    if(!e[i])return true;

    if(e[i].style.display=="none"){
       e[i].style.display="block"
    } else {
       e[i].style.display="none"
    }
 }
 return true;
} 
```

**演示**：`showClass("float_form");`

# javascript - 如何在jquery中浮动模态窗口

> ID：11254432
> 
> 赞同：2
> 
> 时间：2012-06-28T23:49:24.647
> 
> 标签：javascript, jquery, jquery-ui

我正在使用 jquery UI 创建一个浮动窗口。我能够创建窗口。但我无法让它漂浮。我希望窗口应该在“body”的右上角。（现在你可以看到它在右边但在底部）我也想让它移动。当我滚动页面时，窗口也应该随之滚动。例如[http://manos.malihu.gr/tuts/jquery-floating-menu.html](http://manos.malihu.gr/tuts/jquery-floating-menu.html)

这是我到目前为止所做的代码。

[请在http://jsfiddle.net/z8rW6/1/](http://jsfiddle.net/z8rW6/1/)上找到代码

**Javascript代码：**

```
$(document).ready(function(){

$("#dialog").dialog();

var $parent = $('#body');
var windowHeight = $(window).height();
var parentAbsoluteTop = $parent.offset().top;
var parentAbsoluteBottom = parentAbsoluteTop + $parent.height();
var topStop = parentAbsoluteTop + $( ".selector" ).dialog( "option", "height" );
$('#dialog').dialog({ width: 300,height: 600 }).dialog('widget').position({
       my: 'right top',
       at: 'right top',
       of: $('#body')
    });

$(window).scroll(function(event) {
    var windowBottom = $(window).scrollTop() + windowHeight;

if (windowBottom < topStop)

    $('.selector').dialog({ dialogClass: 'myPosition1' });
else if (windowBottom >= topStop && windowBottom <= parentAbsoluteBottom)
    $('.selector').dialog({ dialogClass: 'myPosition2' });
else
    $('.selector').dialog({ dialogClass: 'myPosition3' });

}) 
```

**CSS 代码：**

```
#page{
    width:800px;
    margin:0 auto;
}
.myPosition1 {
position: 'absolute',
            top: '0px',
            bottom: 'auto',
            Right: '0'

}
.myPosition2 {
           position: 'fixed',
            top: 'auto',
            bottom: 'auto',
            Right: '0'
        }
 .myPosition3 {
         position: 'absolute',
        top: 'auto',
        bottom: '0px',
        Right: '0'
        }
#header{
    border:1px solid blue;
    height:15px;
    margin:8px;
}
#body{
    border:1px solid blue;
    height:5600px;
    margin:8px;
    position: relative;
}
#footer{
    border:1px solid blue;
    height:15px;
    margin:8px;
}
h1,h2{
    padding:16px;
}

#debug {
    position: fixed;
    bottom: 0;
    right: 0;
    height: 100px;
    width: 100px;
    color: red;
} 
```

**html代码：**

```
<html>
<head>
<LINK href="css/style.css" rel="stylesheet" type="text/css">

<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

<script language="javascript" type="text/javascript" src='javascript/behaviour.js'></script>

</head>
<body style="font-size:62.5%;">
<div id="page">
 <div id="header"><h1>header</h1></div> 
    <div id="body" >
        <h1>content top -> when scrolling up the box should STOP here (at the line right above this text)</h1>
        <div id="dialog" title="Detailed FeedBack">I'm in a dialog </div>

        <span style="position: absolute; bottom: 0; ">content bottom -> when scrolling down the box should STOP here (at the line right below this text)</span>

    </div>
    <div id="footer"><h1>footer</h1></div>
    <div id="debug"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T15:48:34.440

:) 所有这些答案都是处理您在技术上提出的问题的好方法......如何使用 jQuery 来解决。但是 - 使用非常简单的 CSS 更容易做到这一点。

例子：

```
<head>
 <style type="text/css">
     .myDialog {
         padding: 5px 10px;
         background: yellow;
         border: 1px solid #999;

         position: fixed;  /* This is the magic - stays during scroll. */
         top: 0; right: 0; /* These coordinates are now in 
                              relation to the first parent
                              with non-static positioning (body) */
     }
     .hidden {
         display: none;
     }
 </style>
</head>
<body>
 <!-- The rest of your page -->

 <!-- Put your dialog at the end of the body (or the beginning) 
      This way you don't have to worry about it getting hung up 
      within the positioning boxes of any other elements -->

 <div class="myDialog hidden">
  This is my dialog content!
 </div>
</body>

<script type="text/javascript" language="javascript">
    // Now you can just toggle on and off the "hidden"
    // class to make the dialog hide/show.

    $('#SomeButton').bind('click', function (ev) {
        $('.myDialog').toggleClass('hidden');
    });
</script> 
```

完全相同的原则可以应用于您的模态对话框，使其随着页面的滚动而移动，诸如此类。

对于上面的一个工作示例，看看这个 jsFiddle：http: [//jsfiddle.net/WSZXL/](http://jsfiddle.net/WSZXL/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T15:34:54.113

这应该适用于您的 HTML，但您应该增加`#footer`CSS 中的高度（例如 400 像素）才能确认它是否有效：

```
var $d;
$(document).ready(function(){    
    var dlg_width = 300;
    var dlg_height = 200;
    var dlg_offset_x = $("#page").width() - dlg_width + 100;
    var dlg_margin_top = $("#header").outerHeight(true); // includeMargins=true
    var dlg_margin_bottom = $("#footer").outerHeight(true); // includeMargins=true

    $d = $('#dialog').dialog({
        width: dlg_width,
        height: dlg_height,
        position: [dlg_offset_x, dlg_margin_top]
    });

    $(window).bind('scroll', function(evt){
        var scrollTop = $(window).scrollTop();
        var bottom = $(document).height() - scrollTop;
            $d.dialog("option", {"position": [
                dlg_offset_x,
                ((dlg_margin_top - scrollTop > 0) ?
                    dlg_margin_top - scrollTop :
                        ((bottom - dlg_height > dlg_margin_bottom) ?
                            0 :
                            bottom - dlg_height - dlg_margin_bottom
                        )
                )
            ]});
    });
}); 
```

​ 你可以在这里看到它：http: [//jsfiddle.net/5TFQy/10/](http://jsfiddle.net/5TFQy/10/)

请注意，虽然有一些怪癖：

*   对话框粘在视口的右侧，而它应该粘在`#body`. 我错过了什么，还是它的限制`dialog()`？
*   `dlg_margin_bottom = $("#footer").outerHeight(true)`不足以完全满足您的底线要求。`#body`的边距和边框大小当然应该添加。试图保留它~~简单的~~不要复杂。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:36:24.807

我希望这能帮到您：

[http://jsfiddle.net/lytican/UxZKH/2/](http://jsfiddle.net/lytican/UxZKH/2/)

# c - openmp中的不平衡嵌套for循环

> ID：11254434
> 
> 赞同：1
> 
> 时间：2012-06-28T23:49:33.230
> 
> 标签：c, multithreading, parallel-processing, multiprocessing, openmp

我一直在尝试使用 OpenMP 并行化具有不平衡嵌套 for 循环的算法。我不能发布原始代码，因为它是一个闻所未闻的政府的秘密项目，但这里有一个玩具示例：

```
for (i = 0; i < 100; i++) {
    #pragma omp parallel for private(j, k)
    for (j = 0; j < 1000000; j++) {
        for (k = 0; k < 2; k++) {
            temp = i * j * k;      /* dummy operation (don't mind the race) */
        }
        if (i % 2 == 0) temp = 0;  /* so I can't use openmp collapse */
    }
} 
```

目前，此示例在多线程中运行速度较慢（单线程**约 1 秒**，2线程**约 2.4 秒**等）。

注意事项：

*   外部 for 循环需要按顺序完成（取决于上一步）（据我所知，OpenMP 可以很好地处理内部循环，因此不会在每个步骤中创建/销毁线程，对吗？）

*   示例中给出了典型的索引号`(100, 1000000, 2)`

*   虚拟操作仅包含几个操作

*   在最里面的循环之外有一些条件操作，所以折叠不是一种选择（看起来它无论如何都不会提高性能）

看起来像一个令人尴尬的并行算法，但过去两天我似乎无法获得任何加速。这里最好的策略是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T09:28:51.857

不幸的是，这种令人尴尬的并行算法是如何实现高性能并行的一个令人尴尬的坏例子。而且由于我的水晶球告诉我，除此之外`i`,`temp`也是一个共享的*自动*变量，我将在本文的其余部分假设它。它还告诉我你有一个 pre-Nehalem CPU...

这里有两个减速源——代码转换和缓存一致性。

实现并行区域的方式是将它们的代码提取到单独的函数中。共享局部变量被提取到结构中，然后在执行并行区域的团队中的线程之间共享。在 OpenMP 转换下，您的代码示例将变得与此类似：

```
typedef struct {
    int i;
    int temp;
} main_omp_fn_0_shared_vars;

void main_omp_fn_0 (void *data) {
    main_omp_fn_0_shared_vars *vars = data;

    // compute values of j_min and j_max for this thread

    for (j = j_min; j < j_max; j++) {
        for (k = 0; k < 2; k++) {
            vars->temp = vars->i * j * k;
        if (vars->i % 2 == 0) vars->temp = 0;
    }
}

int main (void) {
    int i, temp;
    main_omp_fn_0_shared_vars vars;

    for (i = 0; i < 100; i++)
    {
        vars.i = i;
        vars.temp = temp;

        // This is how GCC implements parallel regions with libgomp

        // Start main_omp_fn_0 in the other threads
        GOMP_parallel_start(main_omp_fn_0, &vars, 0);

        // Start main_omp_fn_0 in the main thread
        main_omp_fn_0(&vars);

        // Wait for other threads to finish (implicit barrier)
        GOMP_parallel_end();

        i = vars.i;
        temp = vars.temp;
    }
} 
```

您需要为访问支付少量费用`temp`，`i`因为它们的中间值不能存储在寄存器中，而是每次都加载和存储。

另一个退化的来源是缓存一致性协议。从在多个 CPU 内核上执行的多个线程访问相同的内存位置会导致大量缓存失效事件。更糟糕的是，`vars.i`很`vars.temp`可能最终会出现在同一个缓存行中，虽然`vars.i`只是读取和`vars.temp`写入，但内部循环的每次迭代都可能发生完全缓存失效。

通常，对共享变量的访问受到显式同步结构（如原子语句和临界区）的保护，在这种情况下，性能下降是可以预料的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:28:26.507

想想开销：

由于您的外循环需要创建 x 线程来执行内循环中的工作，销毁它们，然后再次创建它们......等等 100 次。

您必须等到内部循环中最长的任务完成其工作，然后才能执行外部循环中的下一步，因此本质上这是一个同步开销。这些任务看起来并不规则，但是如果要执行的工作很小，那么您可以摆脱这种加速。

您需要在这里创建线程并分配私有变量。

如果内部循环内的工作量很小，则并行化该循环的好处可能不一定超过上述并行化开销的成本，因此您最终会减慢速度。

# google-app-engine - 云应用和 Google 云端硬盘

> ID：11254435
> 
> 赞同：2
> 
> 时间：2012-06-28T23:49:33.180
> 
> 标签：google-app-engine, cloud, google-drive-api

我有一个在 AppEngine 上运行的应用程序，所有数据都在云端。从用户的角度来看，它就像一个 Google 电子表格。用户可以“打开”代表他的数据、更新和共享的“文件”。所有数据都存储在数据存储中，而不是文件本身。更像是 google 电子表格或 google 文档，而不是 jpg 或 dwg 文件。是否可以与谷歌驱动器集成并从驱动器界面执行一些操作，例如删除、共享或重命名，使驱动器调用我的应用程序？如果没有，是否有计划进行这种整合？

干杯，

梅尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T00:09:18.900

检查 Google Drive SDK 以将您的应用程序与 Drive 集成：[https ://developers.google.com/drive/](https://developers.google.com/drive/)

Java 示例应用也在 App Engine 上运行：[https ://developers.google.com/drive/examples/java](https://developers.google.com/drive/examples/java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T02:55:19.040

这是您要查找的[http://code.google.com/p/gdata-python-client/吗？](http://code.google.com/p/gdata-python-client/)连接其他谷歌服务的gdata？“Google Documents List Data API”可能就是您所追求的。

# c# - 当可执行文件与数据文件不在同一文件夹中时附加到文件失败

> ID：11254437
> 
> 赞同：2
> 
> 时间：2012-06-28T23:50:35.557
> 
> 标签：c#, file-io

问题现在解决了。我以前从未见过的错误。

一般来说，我对编码很陌生，对 C# 也很陌生，所以我可能遗漏了一些简单的东西。我编写了一个程序来从登录网站提取数据并将该数据保存到本地硬盘上的文件中。数据是太阳能组件的功率和能源数据，每个组件都有自己的文件。在我的主工作站上，我运行的是 Windows Vista，程序运行良好。当我在运行 Server 2003 的机器上运行程序时，它不会将新数据附加到文件中，而是会覆盖文件中最初的数据。

我正在下载的数据是一次 7 天的 csv 格式文本。我每天运行一次程序以提取新一天的数据并将其附加到本地文件中。每次我运行程序时，本地文件都是新下载数据的副本，没有旧数据。由于网站上的数据每天只更新一次，我一直在通过删除本地文件中最后一天的数据和/或本地文件中第一天的数据进行测试。每当我更改文件并运行程序时，该文件都包含下载的数据，仅此而已。

我只是尝试了一些新的东西来测试它为什么不起作用，并认为我找到了错误的根源。当我在本地机器上运行时，“filePath”变量设置为“”。在服务器上，现在在我的本地机器上，我已将“filePath”更改为@“C:\Solar Yard Data\”，并且在两台机器上它都会捕获文件未找到异常并在同一目录中创建一个新文件，该文件会覆盖原来的。任何人都知道为什么会发生这种情况？

代码是下载每个数据集并将任何新数据附加到本地文件的部分。

```
int i = 0;
string filePath = "C:/Solar Yard Data/";

string[] filenamesPower = new string[]
{
    "inverter121201321745_power",
    "inverter121201325108_power",
    "inverter121201326383_power",
    "inverter121201326218_power",
    "inverter121201323111_power",
    "inverter121201324916_power",
    "inverter121201326328_power",
    "inverter121201326031_power",
    "inverter121201325003_power",
    "inverter121201326714_power",
    "inverter121201326351_power",
    "inverter121201323205_power",
    "inverter121201325349_power",
    "inverter121201324856_power",
    "inverter121201325047_power",
    "inverter121201324954_power",
};

// download and save every module's power data
foreach (string url in modulesPower)
{

    // create web request and download data
    HttpWebRequest req_csv = (HttpWebRequest)HttpWebRequest.Create(String.Format(url, auth_token));
    req_csv.CookieContainer = cookie_container;
    HttpWebResponse res_csv = (HttpWebResponse)req_csv.GetResponse();

    // save the data to files
    using (StreamReader sr = new StreamReader(res_csv.GetResponseStream()))
    {
        string response = sr.ReadToEnd();
        string fileName = filenamesPower[i] + ".csv";

        // save the new data to file
        try
        {
            int startIndex = 0;          // start index for substring to append to file
            int searchResultIndex = 0;   // index returned when searching downloaded data for last entry of data on file
            string lastEntry;            // will hold the last entry in the current data
            //open existing file and find last entry
            using (StreamReader sr2 = new StreamReader(fileName))
            {
                //get last line of existing data
                string fileContents = sr2.ReadToEnd();
                string nl = System.Environment.NewLine;  // newline string
                int nllen = nl.Length;                   // length of a newline
                if (fileContents.LastIndexOf(nl) == fileContents.Length - nllen)
                {
                    lastEntry = fileContents.Substring(0, fileContents.Length - nllen).Substring(fileContents.Substring(0, fileContents.Length - nllen).LastIndexOf(nl) + nllen);
                }
                else
                {
                    lastEntry = fileContents.Substring(fileContents.LastIndexOf(nl) + 2);
                }

                // search the new data for the last existing line
                searchResultIndex = response.LastIndexOf(lastEntry);
            }

            // if the downloaded data contains the last record on file, append the new data
            if (searchResultIndex != -1)
            {
                startIndex = searchResultIndex + lastEntry.Length;
                File.AppendAllText(filePath + fileName, response.Substring(startIndex+1));
            }
            // else append all the data
            else
            {
                Console.WriteLine("The last entry of the existing data was not found\nin the downloaded data. Appending all data.");
                File.AppendAllText(filePath + fileName, response.Substring(109));  // the 109 index removes the file header from the new data
            }
        }
        // if there is no file for this module, create the first one
        catch (FileNotFoundException e)
        {
            // write data to file
            Console.WriteLine("File does not exist, creating new data file.");
            File.WriteAllText(filePath + fileName, response);
            //Debug.WriteLine(response);
        }

    }

    Console.WriteLine("Power file " + (i + 1) + " finished.");
    //Debug.WriteLine("File " + (i + 1) + " finished.");
    i++;
}

Console.WriteLine("\nPower data finished!\n"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:34:56.200

我认为可能会解决问题的几个建议首先更改您的 filePath 字符串

> string filePath = @"C:\Solar Yard Data\";

创建一个完整路径的字符串

```
String fullFilePath = filePath + fileName; 
```

然后检查它是否存在，如果不存在则创建它

```
if (!File.Exists(fullFilePath ))
     File.Create(fullFilePath ); 
```

将文件的完整路径放入您的 streamReader

```
using (StreamReader sr2 = new StreamReader(fullFilePath)) 
```

# c - 使用套接字的文件传输服务器/客户端

> ID：11254447
> 
> 赞同：12
> 
> 时间：2012-06-28T23:52:19.123
> 
> 标签：c, linux, file, sockets

我正在尝试在服务器和客户端之间进行文件传输，但工作非常糟糕。基本上需要发生的是：
1）客户端向服务器发送一个txt文件（我称之为“quotidiani.txt”）
2）服务器将其保存在另一个txt文件中（“receive.txt”）
3）服务器运行上面的脚本修改它并用另一个名称（“output.txt”）保存它
4）服务器将文件发送回客户端，用名称（final.txt）保存它（在同一个套接字上）

问题是第一个文件 (quotidiani.txt) 只读取了一小部分，然后出现了一些错误。我希望有人帮助我理解和纠正我的错误。

这是我的代码：

客户端.c：

```
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/wait.h>
#include <sys/socket.h>
#include <signal.h>
#include <ctype.h>          
#include <arpa/inet.h>
#include <netdb.h>

#define PORT 20000
#define LENGTH 512 

void error(const char *msg)
{
    perror(msg);
    exit(1);
}

int main(int argc, char *argv[])
{
    /* Variable Definition */
    int sockfd; 
    int nsockfd;
    char revbuf[LENGTH]; 
    struct sockaddr_in remote_addr;

    /* Get the Socket file descriptor */
    if ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1)
    {
        fprintf(stderr, "ERROR: Failed to obtain Socket Descriptor! (errno = %d)\n",errno);
        exit(1);
    }

    /* Fill the socket address struct */
    remote_addr.sin_family = AF_INET; 
    remote_addr.sin_port = htons(PORT); 
    inet_pton(AF_INET, "127.0.0.1", &remote_addr.sin_addr); 
    bzero(&(remote_addr.sin_zero), 8);

    /* Try to connect the remote */
    if (connect(sockfd, (struct sockaddr *)&remote_addr, sizeof(struct sockaddr)) == -1)
    {
        fprintf(stderr, "ERROR: Failed to connect to the host! (errno = %d)\n",errno);
        exit(1);
    }
    else 
        printf("[Client] Connected to server at port %d...ok!\n", PORT);

    /* Send File to Server */
    //if(!fork())
    //{
        char* fs_name = "/home/aryan/Desktop/quotidiani.txt";
        char sdbuf[LENGTH]; 
        printf("[Client] Sending %s to the Server... ", fs_name);
        FILE *fs = fopen(fs_name, "r");
        if(fs == NULL)
        {
            printf("ERROR: File %s not found.\n", fs_name);
            exit(1);
        }

        bzero(sdbuf, LENGTH); 
        int fs_block_sz; 
        while((fs_block_sz = fread(sdbuf, sizeof(char), LENGTH, fs)) > 0)
        {
            if(send(sockfd, sdbuf, fs_block_sz, 0) < 0)
            {
                fprintf(stderr, "ERROR: Failed to send file %s. (errno = %d)\n", fs_name, errno);
                break;
            }
            bzero(sdbuf, LENGTH);
        }
        printf("Ok File %s from Client was Sent!\n", fs_name);
    //}

    /* Receive File from Server */
    printf("[Client] Receiveing file from Server and saving it as final.txt...");
    char* fr_name = "/home/aryan/Desktop/progetto/final.txt";
    FILE *fr = fopen(fr_name, "a");
    if(fr == NULL)
        printf("File %s Cannot be opened.\n", fr_name);
    else
    {
        bzero(revbuf, LENGTH); 
        int fr_block_sz = 0;
        while((fr_block_sz = recv(sockfd, revbuf, LENGTH, 0)) > 0)
        {
            int write_sz = fwrite(revbuf, sizeof(char), fr_block_sz, fr);
            if(write_sz < fr_block_sz)
            {
                error("File write failed.\n");
            }
            bzero(revbuf, LENGTH);
            if (fr_block_sz == 0 || fr_block_sz != 512) 
            {
                break;
            }
        }
        if(fr_block_sz < 0)
        {
            if (errno == EAGAIN)
            {
                printf("recv() timed out.\n");
            }
            else
            {
                fprintf(stderr, "recv() failed due to errno = %d\n", errno);
            }
        }
        printf("Ok received from server!\n");
        fclose(fr);
    }
    close (sockfd);
    printf("[Client] Connection lost.\n");
    return (0);
} 
```

服务器.c

```
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/wait.h>
#include <sys/socket.h>
#include <signal.h>
#include <ctype.h>          
#include <arpa/inet.h>
#include <netdb.h>

#define PORT 20000 
#define BACKLOG 5
#define LENGTH 512 

void error(const char *msg)
{
    perror(msg);
    exit(1);
}

int main ()
{
    /* Defining Variables */
    int sockfd; 
    int nsockfd; 
    int num;
    int sin_size; 
    struct sockaddr_in addr_local; /* client addr */
    struct sockaddr_in addr_remote; /* server addr */
    char revbuf[LENGTH]; // Receiver buffer

    /* Get the Socket file descriptor */
    if((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1 )
    {
        fprintf(stderr, "ERROR: Failed to obtain Socket Descriptor. (errno = %d)\n", errno);
        exit(1);
    }
    else 
        printf("[Server] Obtaining socket descriptor successfully.\n");

    /* Fill the client socket address struct */
    addr_local.sin_family = AF_INET; // Protocol Family
    addr_local.sin_port = htons(PORT); // Port number
    addr_local.sin_addr.s_addr = INADDR_ANY; // AutoFill local address
    bzero(&(addr_local.sin_zero), 8); // Flush the rest of struct

    /* Bind a special Port */
    if( bind(sockfd, (struct sockaddr*)&addr_local, sizeof(struct sockaddr)) == -1 )
    {
        fprintf(stderr, "ERROR: Failed to bind Port. (errno = %d)\n", errno);
        exit(1);
    }
    else 
        printf("[Server] Binded tcp port %d in addr 127.0.0.1 sucessfully.\n",PORT);

    /* Listen remote connect/calling */
    if(listen(sockfd,BACKLOG) == -1)
    {
        fprintf(stderr, "ERROR: Failed to listen Port. (errno = %d)\n", errno);
        exit(1);
    }
    else
        printf ("[Server] Listening the port %d successfully.\n", PORT);

    int success = 0;
    while(success == 0)
    {
        sin_size = sizeof(struct sockaddr_in);

        /* Wait a connection, and obtain a new socket file despriptor for single connection */
        if ((nsockfd = accept(sockfd, (struct sockaddr *)&addr_remote, &sin_size)) == -1) 
        {
            fprintf(stderr, "ERROR: Obtaining new Socket Despcritor. (errno = %d)\n", errno);
            exit(1);
        }
        else 
            printf("[Server] Server has got connected from %s.\n", inet_ntoa(addr_remote.sin_addr));

        /*Receive File from Client */
        char* fr_name = "/home/aryan/Desktop/receive.txt";
        FILE *fr = fopen(fr_name, "a");
        if(fr == NULL)
            printf("File %s Cannot be opened file on server.\n", fr_name);
        else
        {
            bzero(revbuf, LENGTH); 
            int fr_block_sz = 0;
            while((fr_block_sz = recv(nsockfd, revbuf, LENGTH, 0)) > 0) 
            {
                int write_sz = fwrite(revbuf, sizeof(char), fr_block_sz, fr);
                if(write_sz < fr_block_sz)
                {
                    error("File write failed on server.\n");
                }
                bzero(revbuf, LENGTH);
                if (fr_block_sz == 0 || fr_block_sz != 512) 
                {
                    break;
                }
            }
            if(fr_block_sz < 0)
            {
                if (errno == EAGAIN)
                {
                    printf("recv() timed out.\n");
                }
                else
                {
                    fprintf(stderr, "recv() failed due to errno = %d\n", errno);
                    exit(1);
                }
            }
            printf("Ok received from client!\n");
            fclose(fr); 
        }

        /* Call the Script */
        system("cd ; chmod +x script.sh ; ./script.sh");

        /* Send File to Client */
        //if(!fork())
        //{
            char* fs_name = "/home/aryan/Desktop/output.txt";
            char sdbuf[LENGTH]; // Send buffer
            printf("[Server] Sending %s to the Client...", fs_name);
            FILE *fs = fopen(fs_name, "r");
            if(fs == NULL)
            {
                fprintf(stderr, "ERROR: File %s not found on server. (errno = %d)\n", fs_name, errno);
                exit(1);
            }

            bzero(sdbuf, LENGTH); 
            int fs_block_sz; 
            while((fs_block_sz = fread(sdbuf, sizeof(char), LENGTH, fs))>0)
            {
                if(send(nsockfd, sdbuf, fs_block_sz, 0) < 0)
                {
                    fprintf(stderr, "ERROR: Failed to send file %s. (errno = %d)\n", fs_name, errno);
                    exit(1);
                }
                bzero(sdbuf, LENGTH);
            }
            printf("Ok sent to client!\n");
            success = 1;
            close(nsockfd);
            printf("[Server] Connection with Client closed. Server will wait now...\n");
            while(waitpid(-1, NULL, WNOHANG) > 0);
        //}
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T00:38:35.200

一些评论没有特别的顺序：

*   您经常错过了解确切错误的机会：

    ```
    if(listen(sockfd,BACKLOG) == -1)
    {
        printf("ERROR: Failed to listen Port %d.\n", PORT);
        return (0);
    } 
    ```

    这个块绝对应该包括一个`perror("listen")`或类似的东西。当`perror()`错误`strerror()`详细信息将通过`errno`. 有确切的失败原因将在编程时为您节省时间，并且在将来事情无法按预期工作时为您和您的用户节省时间。

*   您的错误处理需要进一步标准化：

    ```
    if((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1 )
    {
        printf("ERROR: Failed to obtain Socket Descriptor.\n");
        return (0);
    } 
    ```

    这不应该*，* `return 0`因为这将向 shell 发出信号，表明程序运行完成而没有错误。您应该`return 1`（或使用`EXIT_SUCCESS`and `EXIT_FAILURE`）表示异常退出。

    ```
     else 
        printf("[Server] Server has got connected from %s.\n", inet_ntoa(addr_remote.sin_addr));

     /*Receive File from Client */ 
    ```

    在前面的块中，您遇到了错误情况，但仍继续执行。这是获得非常不良行为的快速方法。这应该重新启动主服务器循环或退出子进程或类似的东西。（取决于您是否保留多进程服务器。）

    ```
    if(!fork())
    { 
    ```

    前面的块忘记了`fork()` *失败*的原因。`fork()`可以而且确实会失败——尤其是在大学常见的共享托管环境中——所以你应该准备好完整的、复杂的*三个*可能的返回值`fork()`：失败、孩子、父母。

*   看来您是在`fork()`乱用；您的客户端和服务器都非常简单，它们的设计运行方式意味着它们*不能*用于同时为多个客户端提供服务。您可能应该为每个进程都坚持一个进程，至少在算法被完美调试并且您找到同时运行多个客户端的方法之前。我希望这是您现在遇到的问题的根源。

*   你需要使用函数来封装细节；编写一个连接到服务器的函数、一个发送文件的函数、一个写入文件的函数等。编写一个函数来处理复杂的部分写入。[（我特别建议从Unix 环境中的高级编程](http://www.apuebook.com/)一书的源代码中窃取`writen`函数。文件。）如果您正确编写函数，您可以在客户端和服务器中重复使用它们。（就像将它们放入并编译程序一样。）`lib/writen.c``utils.c``gcc -o server server.c utils.c`

    拥有每个只做一件事的较小功能将使您可以一次专注于较少量的代码，*并*为每个代码编写少量测试，这将帮助您缩小哪些代码部分仍需要改进。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-03T08:21:42.367

这里似乎缺少一个讨论点，所以我想在这里提一下。

让我们快速了解 TCP 的数据传输。有三个步骤 a) 连接建立，b) 数据传输，c) 连接终止

现在，客户端通过 TCP 套接字向服务器发送文件。

服务器对文件进行一些处理并将其发送回客户端。

现在需要完成所有 3 个步骤。连接建立是通过调用 connect 来完成的。数据读取/写入由此处的接收/发送完成，连接终止由关闭完成。

这里的服务器使用recv循环读取数据。现在**循环什么时候结束**？当 recv 返回 0 或可能小于 0 时出错。 **什么时候recv返回0？-> 当对方关闭连接时。** （当 TCP FIN 段已被本方接收时）。

所以在这段代码中，当客户端完成发送文件时，我使用了一个关闭函数，它从客户端发送 FIN 段，服务器的 recv 现在可以返回 0 并且程序继续。（中途关闭，因为客户端后续还需要读取数据）。

（只是为了理解，请注意 TCP 的连接建立是 3 次握手，连接终止是 4 次握手。）

同样，如果您忘记关闭服务器端的连接套接字，客户端的 recv 也将永远阻塞。我认为这就是您提到的有时使用 ctrl c 停止客户端的原因。

你可以请。请参阅任何标准网络书籍或 rfc [http://www.ietf.org/rfc/rfc793.txt](http://www.ietf.org/rfc/rfc793.txt)了解更多关于 TCP

我已经粘贴了修改后的代码，也很少添加一些评论，

希望这个解释会有所帮助。

修改客户端代码：

```
 while((fs_block_sz = fread(sdbuf, sizeof(char), LENGTH, fs)) > 0)
    {
        if(send(sockfd, sdbuf, fs_block_sz, 0) < 0)
        {
            fprintf(stderr, "ERROR: Failed to send file %s. (errno = %d)\n", fs_name, errno);
            exit(1);
        }
        bzero(sdbuf, LENGTH);
    }

 /*Now we have sent the File's data, what about server's recv?
 Recv is blocked  and waiting for data to arrive or if the protocol
 stack receives a TCP FIN segment ..then the recv will return 0 and
 the server code can continue */
 /*Sending the TCP FIN segment by shutdown and this is half way
 close, since the client also needs to read data subsequently*/

 shutdown(sockfd, SHUT_WR);
 printf("Ok File %s from Client was Sent!\n", fs_name); 
```

# php - 使用 PHP 代码更新 HTML 标记

> ID：11254448
> 
> 赞同：0
> 
> 时间：2012-06-28T23:52:23.527
> 
> 标签：php, html

使用以下 php 代码更新 HTML 标记的最简单方法是什么？

```
<h1>
 <?php
    include "document.txt";
    ?>
    </h1> 
```

我的意思是定时更新……每 10 秒或每 2 秒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:04:39.767

看看[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)。jQuery 有一个非常易于使用的函数来发出 AJAX 请求，请参阅[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/).

这个例子（从 jQuery 页面修改）是你想要的：

```
function loadData() {
    $.ajax({
      url: "document.txt",
      cache: false
    }).done(function( html ) {
      $("#results").html(html);
    });
} 
```

它将获取`document.txt`文件的内容并将其添加到具有如下属性的元素中`id="results"`：

```
<h1 id="results"></h1> 
```

然后，您可以使用[`window.setInterval`](https://developer.mozilla.org/en/window.setInterval)以设定的时间间隔执行代码。

```
window.setInterval(loadData, 10000); 
```

# kml - 来自 url 的 kml 气球中的动态内容

> ID：11254449
> 
> 赞同：1
> 
> 时间：2012-06-28T23:52:26.050
> 
> 标签：kml, google-earth, google-earth-plugin, balloon

我有一个服务器正在提供一个 xhtml 页面，其中包含我想要在我的谷歌地球（或 worldwind）气球中显示的所有内容。我希望地标气球在地图上单击时获取 html 页面。为简单起见，当您从地图上单击它时，我希望我的气球是 www.yahoo.com。

任何在线搜索都会将我发送到可以连接到 google earth api 的 java 代码。我真的希望有一种客户端 kml 方式来做到这一点。我可以使用扩展数据标签或描述标签来使其工作吗？我什至尝试使用 embed 标签，该标签非常适合您的视频，但没有用于 html 页面的插件。任何帮助深表感谢。

这也有效，但 iframe 非常难看 -

```
<Placemark> 
  <name>Test Placemark</name> 
    <description> 
      <![CDATA[ 
        <iframe src="http://www.yahoo.com" frameborder="0" 
           scrolling="auto" height="500" width="600"></iframe> 
      ]]> 
    </description> 
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:44:33.123

你可以试试 getBalloonHtmlUnsafe() 和 HtmlDivBalloon 吗？ [https://developers.google.com/earth/documentation/balloons#getballoonhtmlunsafe](https://developers.google.com/earth/documentation/balloons#getballoonhtmlunsafe)

但是，您将 kml 添加到页面，然后您可以将点击功能绑定到这些地标。

```
google.earth.fetchKml(ge, url, function(kmlObject){
   if(kmlObject){
      ge.getFeatures().appendChild(kmlObject);

      if(kmlObject.getType() === 'KmlPlacemark'){
          google.earth.addEventListener(kmlObject, 'click', function(event){
               event.preventDefault();

               var balloon = ge.createHtmlDivBalloon('');
               var content = kmlObject.getBalloonHtmlUnsafe();
               balloon.setFeature(kmlObject);
               var div = document.createElement('div');
               div.innerHTML = content;
               balloon.setContentDiv(div);

               ge.setBalloon(balloon);
          });
      }
   }
}); 
```

如果这仍然不起作用，请记住谷歌地球会清除大量气球数据，因此您可以尝试使用 jquery 注入 html。

```
var balloon = ge.createHtmlDivBalloon('');
var content = kmlObject.getBalloonHtmlUnsafe();
balloon.setFeature(kmlObject);
var div = document.createElement('div');
balloon.setContentDiv(div);

ge.setBalloon(balloon);
$(div).html(content); 
```

# maven - Flash 播放器

> ID：11254451
> 
> 赞同：0
> 
> 时间：2012-06-28T23:52:35.320
> 
> 标签：maven, path, executable, flash, ubuntu-12.04

我正在尝试在 Ubuntu 12.04 上构建我的 maven 项目，它抱怨 java 无法找到 flashplayer。但是，我在 Adob​​e 网站上完成了安装 Flash Player 的所有步骤，但它仍然在抱怨。

它还提到了一些关于确保 flashplayer 在 PATH 上可用的内容。但是，我不知道该文件的路径在哪里。当我在终端中运行“locate flash”时，有几个文件看起来可能是可执行文件。

有人可以帮我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-29T12:13:47.863

从[http://www.adobe.com/support/flashplayer/downloads.html](http://www.adobe.com/support/flashplayer/downloads.html)下载*Flash Player 11.2 投影仪*。

将其解压到一个文件夹中，它应该包含可执行文件*flashplayer*。

添加到路径：`export PATH=$PATH:~/unpacked`.

现在maven应该可以使用它了。

# r - 尽可能平均分配金额

> ID：11254452
> 
> 赞同：3
> 
> 时间：2012-06-28T23:52:38.643
> 
> 标签：r, distribution, minimum, evenly

我们有一定数量，例如 300 个单位。这个数量应该尽可能均匀地分布在 40 个“插槽”上。如果每个插槽都相同，那将很容易-因此每个插槽将是 7,5。然而，插槽的大小各不相同，我们不能“填充”超过它的“大小”允许的范围，例如如果它只有 5 个。我们不能“填充”的内容我们必须在其他插槽上分配更多。

我有一些基本的想法，但我离成为专家还很遥远，希望有一种简单的方法来解决这个问题。例如，这可能是什么样子。在数组“a”中，值代表插槽可以采用的最大值。a[i] 是第 i 个时隙的最大值。“b”是我们必须分配的整体，例如 300。

```
 # developing slots and their "size"
 a <- rnorm(40,10,4)
 sum(a)

 # overall sum to distribute
 b <- 300 
```

也许可以按升序对值进行排序，然后可以通过双 for 循环使用它。a[,2] 成为“填充”金额的列。

```
 for i in 1:40
 {a[i,2] <- a[1,2]*40
 b <- a [1,2]*40}

 for i in 2:40
 {a[i,2] <- a[1,2]*39
 b <- a[1,2]*39}

etc. 
```

我不确定如何将两个 for 循环放在一起，以及这是否是一个足够的解决方案。很高兴听到你的想法。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:54:31.040

第一个版本，使用 while 循环：

```
optimal.fill <- function(a, b) {
  stopifnot(sum(a) >= b)

  d <- rep(0, length(a))
  while(b > 0) {
    has.room  <- a > 0
    num.slots <- sum(has.room)
    min.size  <- min(a[has.room])
    add.size  <- min(b / num.slots, min.size)
    d[has.room] <- d[has.room] + add.size
    a[has.room] <- a[has.room] - add.size
    b <- b - num.slots * add.size
  }
  return(d)
} 
```

这第二个版本有点难以理解，但我觉得更优雅：

```
optimal.fill <- function(a, b) {
  stopifnot(sum(a) >= b)

  slot.order   <- order(a)
  sorted.sizes <- a[slot.order]
  can.fill     <- sorted.sizes * rev(seq_along(a))
  full.slots   <- slot.order[which(cumsum(can.fill) <= b)]

  d <- rep(0, length(a))
  d[ full.slots] <- a[full.slots]
  d[!full.slots] <- (b - sum(a[full.slots])) /
                    (length(a) - length(full.slots))

  return(d)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T02:31:03.883

这是另一种选择：

```
optimal.fill2 <- function(a,b) {
  o <- rank(a)
  a <- sort(a)
  ca <- cumsum(a)
  foo <- (b-ca)/((length(a)-1):0)
  ok <- foo >= a
  a[!ok] <- foo[max(which(ok))]
  a[o]
} 
```

# json - 我有一个错误，它不工作，这是错误

> ID：11254454
> 
> 赞同：0
> 
> 时间：2012-06-28T23:52:50.293
> 
> 标签：json, actionscript-3, flash, phpmyadmin

```
package  {

import flash.display.Sprite;
import flash.events.MouseEvent;
import flash.net.*;
import com.adobe.serialization.json.*;

public class ScreenCategories extends Sprite {

    public var myLoader:URLLoader;
    public var filePath:String;
    public var myReq:URLRequest;

    public function ScreenCategories() {
        // constructor code
        reLoad();
    }

    // Constructor: Create an array of three categories
    public function reLoad()
    {

        lastButtonEndedY = 35;

        /* 
            In our real app, we would load in the categories from our database (via a JSON)
            Hint: Saving the Objects into the array at the index that equals the ID is advised
        */
        filePath = "getCategories.php"; //declare path and file name
        myReq = new URLRequest(filePath); //create URLRequest to access the file

        myLoader = new URLLoader(); //create URLLoader to load the file

        //add event listener to run fileLoaded function when loading is complete
        myLoader.removeEventListener(Event.COMPLETE, loadComplete);
        myLoader.addEventListener(Event.COMPLETE, loadComplete);

        //add event listener to listen for any error thrown during loading process
        myLoader.removeEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
        myLoader.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);

        myLoader.load(myReq); //start loading a file with our URLLoader instance
    }

    //loading complere so print content of a text file to our Text Field
    function loadComplete(e:Event):void
    {
        var jsonstring:String = myLoader.data; 
        var categories:Array = JSON.decode(jsonstring);

        for (var count:int = 0; count < categories.length; count++) {
            var aCategory:Object = category[count];
            trace(aCategory.categoryname);
            trace(aCategory.categoryid);
        }

        ///////////////
        // Consider that it would be more responsible to add these to an array and maintain 
        // which are being added/deleted, then we could create a print function!
        ///////////////
    }

    //if any error was thrown, event was also dispatched and now you can print
    //the error description to the text field.
    public function ioErrorHandler(e:IOErrorEvent):void
    {
         trace("There was a problem loading "+filePath+": "+e);
    }

} 
```

}

```
 // for each "category" in our list (Array)...
        for (var count in categories)
        {
            // Create a button for each of the categories that exist in our Array
            var aCategory:BtnCategory = new BtnCategory(categories[count].category);

            // Add the BtnCategory to the stage
            aCategory.x = 0;
            aCategory.y = lastButtonEndedY;
            aCategory.name = categories[count].id; // give it a unique name!
            addChild(aCategory);

            lastButtonEndedY += (aCategory.getHeight() + 1);
        }

        addEventListener(MouseEvent.CLICK, mouseClicked); 
```

这应该适用于移动应用程序的动作脚本 3，我需要一个类别列表，将我带到产品列表和产品....但我首先在读取值的类别列表上工作从 JSON，我已经有一个 getCategory.php 文档，其中我的 json 被正确返回......但是当我运行 swf 时它说错误......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:54:57.610

对我来说，这看起来像是`filePath = "getCategories.php";`你的问题。
当您在本地或在您的开发环境中运行时，它会在 SWF 所在的同一目录中查找该 php 页面，这可能对您来说可以正常工作。但是当您发布到不再是 php 页面位置的手机时。
因此，由于服务器不存在，您可能会收到 IO 错误。

[编辑] 现在你终于发布了错误，我可以看到你的问题是什么。

```
type was not found or was not a compile-time constant: Event 
```

说明它找不到 Event 类。
查看您的代码，您也没有导入它。
最接近它的是 MouseEvent。
因此，不要只导入 MouseEvent 试试这个。

```
import flash.events.*; 
```

# midi - CoreMidi midi 时间码

> ID：11254456
> 
> 赞同：1
> 
> 时间：2012-06-28T23:52:52.430
> 
> 标签：midi, coremidi

我在我的代码中设置了一个 midi 输入端口，并附加了一个回调来读取接收到的 midi 数据。这一切都很好。我正在阅读 Midi Timecode 并在我的回电中解析它。我注意到的是，根据我启动应用程序的时间，我可能会在传输 MTC 的设备后延迟 1 秒。有时它是一个框架。无论如何，它是不一致和令人沮丧的。我没有在我的 readProc 中进行任何阻塞或 Obj-C 调用。在运行我的应用程序后，我什至遇到了断开我的 USB MIDI 设备的麻烦，看看是否有任何奇怪的 IOKit 发生。我真的可以使用一些帮助，甚至是狂野的理论吗？我觉得 Midi TimeStamps 好像没用，因为没有客观的参考来比较它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T03:16:16.370

我假设你知道你在这里做什么，并且是指实际的 MIDI 时间码而不是 MIDI 时钟，这是两种同步方法中更常见的一种。无论如何，MIDI 很慢，您需要向客户端提供偏移量（可能以毫秒为单位），以便它可以做出相应的反应。例如，看看 Ableton Live 是如何做到的：

![在此处输入图像描述](../Images/1d8d6db05b780a7dbd3f45c623f009b9.png)

我意识到上面的截图是针对 MIDI 时钟的，但同样适用于 MTC。您可能需要提供某种类型的 UI 来确定偏移量，因为正如您所发现的，延迟会根据运行时条件而变化。

# jquery - 脚本仅适用于在 Ajax 之前加载的元素

> ID：11254457
> 
> 赞同：0
> 
> 时间：2012-06-28T23:52:53.977
> 
> 标签：jquery, ajax, show-hide

我有一个包含许多带有字母数字 id 的元素的页面，例如：

```
<li class="entry" id="sjDDulC8wt"> 
   <img src="sjDDulC8wt.jpg" />
   <div class="entry_actions">
      <ul class="entry_actions">
          <li class='share_it'><a href='javascript:' target='_self' 
          title='Share It' class='share_it'>o</a>
          </li>
      </ul>
      <div class="share_options_container"style="display:none;">
        <ul>
          <li><a href="#" class="facebook">F</a></li>
          <li><a href="#" class="twitter">T</a></li>
          <li><a href="#" class="pinterest">X</a></li>
        </ul>
      </div>
   </div>
</li> 
```

当我单击 entry_actions 列表下的锚标记时，它会显示 share_options div，当我将鼠标移开时，它会根据此脚本再次消失：

```
$(".share_it a").click(function(){
   $(this).closest(".entry").find(".share_options_container").show();                
})
$(".share_options_container").mouseleave(function(){
   $(this).hide();              
}) 
```

我还有一个无限滚动功能，当用户点击页面底部时，它会加载更多这些项目：

```
var vloaded = <?php echo $i; ?>; //number of items loaded so far
var vfilter = "<?php echo $filter; ?>"; //how I am filtering them

$(document).ready() 
{
  $(window).on('scroll', function () 
    {
      var height = $(window).height();
      var scrollTop = $(window).scrollTop();
      var dHeight = getDocHeight();

      if( height + scrollTop >= dHeight - 10) 
      {
          $.ajax
          (
            {
              type: "POST",
              url: "/organizer/getMore",
              data: { filter: vfilter, loaded: vloaded },
              dataType: "html",
              success: function( responseText, textStatus, XHR )
              {
                // select the element with the ID grid and insert the HTML
                $( "#grid" ).append( responseText );
              }
            }
          );
          // global variable
          vloaded +=30;
      } // if
    }
  ); // on
} // ready 
```

出于某种原因，显示/隐藏在最初加载的项目上工作得非常好，但是当我单击由 ajax 调用加载的项目时，它什么也不做。据我所知，点击事件没有被触发，但我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:56:09.453

试试这个

```
$(".share_it a").live("click",function(){
   $(this).closest(".entry").find(".share_options_container").show();                
})
$(".share_options_container").live("mouseleave",function(){
   $(this).hide();              
}) 
```

您可能需要`.live()`打电话上班。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:00:31.527

click 和 mouseleave 函数仅绑定到调用函数时存在于 DOM 中的元素。如果您通过 ajax 加载更多元素，则它们不会自动将事件绑定到它们。您可以使用“live”或“delegate”来执行此操作。我更喜欢代理。

```
$("ul#entryList").delegate(".share_it a", "click", function(){
   $(this).closest(".entry").find(".share_options_container").show();                
}).delegate(".share_options_container","mouseleave",function(){
   $(this).hide();              
}) 
```

# sql - 使用 IF/ELSE IF 语句的奇怪错误

> ID：11254462
> 
> 赞同：7
> 
> 时间：2012-06-28T23:53:17.953
> 
> 标签：sql, tsql, sql-server-2008-r2

我正在尝试根据场景参数的值创建一个临时表，并使用以下 IF 语句，但出现以下错误：

```
 IF @indexName = 'A'
        begin select top 400 * into #temp from #pretemp order by EMRev desc end
    ELSE IF @indexName = 'B'
        begin select top 75 * into #temp from #pretemp order by EMRev desc end
    ELSE IF @indexName = 'C'
        begin select top 300 * into #temp from #pretemp order by EMRev desc end
    ELSE 
        begin select top 100 * into #temp from #pretemp order by EMRev desc end 
```

> 消息 2714，级别 16，状态 1，第 179 行数据库中已经有一个名为“#temp”的对象。消息 2714，级别 16，状态 1，第 181 行数据库中已经有一个名为“#temp”的对象。消息 2714，级别 16，状态 1，第 183 行数据库中已经有一个名为“#temp”的对象。

我确定 IF 语句基于 @indexName 变量工作（用简单的东西（例如，'select @indexName'）替换块语句，程序运行良好）。

关于导致此错误的任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T23:58:39.797

SQL 解析器查找所有可能创建临时表的位置，并且只允许使用给定的临时表名称一次。解决方案是执行以下操作：

```
select * into #temp from #pretemp where 1=2

IF @indexName = 'A'
    begin insert into #temp select top 400 * from #pretemp order by EMRev desc end
ELSE IF @indexName = 'B'
    begin insert into #temp select top 75 * from #pretemp order by EMRev desc end
ELSE IF @indexName = 'C'
    begin insert into #temp select top 300 * from #pretemp order by EMRev desc end
ELSE 
    begin insert into #temp select top 100 * from #pretemp order by EMRev desc end 
```

创建具有零记录的`where 1=2`表结构......然后 if 语句填充临时表。

干杯!

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T13:13:24.357

因为只有最高数量的记录是不同的。你可以试试这个

```
declare @num int 

SET @num = CASE @indexName 
                    WHEN 'A' THEN 400
                    WHEN 'B' THEN 75
                    WHEN 'C' THEN 300
                    ELSE  100
            END

select top (@num) * into #temp from #pretemp order by EMRev desc 
```

# python - 使用 django-registration 保存用户配置文件

> ID：11254464
> 
> 赞同：1
> 
> 时间：2012-06-28T23:53:33.163
> 
> 标签：python, django

我正在使用 Django 注册，与其他人不同，我似乎遇到了相反的问题。我的 User 对象保存得很好，但我的 UserProfile 对象没有！

我关注了这个网站：

```
http://birdhouse.org/blog/2009/06/27/django-profiles/ 
```

这真的很好，所以现在我有：

```
class ProfileForm(forms.ModelForm):

    YESNO = [
        (True,mark_safe('<img src="/static_files/greenTick.png"/>')),
        (False,mark_safe('<img src="/static_files/redCross.png"/>'))]

    class Meta:
        model = UserProfile
        exclude = ('isTweeting','points','user')
        fields = ('display_name','first_name','last_name','email','gravatar')

    def __init__(self, *args, **kwargs):
        super(ProfileForm, self).__init__(*args, **kwargs)
        self.fields['email'].initial = self.instance.user.email
        self.fields['first_name'].initial = self.instance.user.first_name
        self.fields['last_name'].initial = self.instance.user.last_name
        self.fields['display_name'].initial = self.instance.user.username
        self.fields['gravatar'].initial = self.instance.usesGravatar

    #add in the input to size it juuuuust right.
    email = forms.EmailField(label="Primary email",help_text='',widget=forms.TextInput(attrs={'class': 'wideInput'}))
    first_name = forms.Field(label="First name",help_text='',required=False,widget=forms.TextInput(attrs={'class': 'wideInput'}))
    last_name = forms.Field(label="Last name",help_text='',required=False,widget=forms.TextInput(attrs={'class': 'wideInput'}))
    display_name = forms.Field(label="Display name",help_text='',widget=forms.TextInput(attrs={'class': 'wideInput'}))
    gravatar = ImgModelChoiceField(label='Gravatar', choices=YESNO, widget=forms.RadioSelect(renderer=ImgRadioFieldRenderer))

    def save(self, *args, **kwargs):
        """
        Update the primary email address on the related User object as well.
        """
        u = self.instance.user
        u.email = self.cleaned_data['email']
        u.username = self.cleaned_data['display_name']
        u.first_name = self.cleaned_data['first_name']
        u.last_name = self.cleaned_data['last_name']
        u.save()

        self.instance.gravatar = (self.cleaned_data['gravatar'] == 'True')
        profile = super(ProfileForm, self).save(*args,**kwargs)
        return profile 
```

该对象作为 form_class 传递到 Django-profile 中以供使用，如上面网站中所述。我遇到的问题是，当我提交表单时，虽然“用户”数据已正确更新 - 电子邮件中的任何更改或不会传播到数据库的东西 - 不会发送对“gravatar”值的更改。也不会抛出错误。

有什么想法我应该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T10:56:04.430

我将在这里冒险猜测

```
def save(self, *args, **kwargs):
    ...

    self.instance.gravatar = (self.cleaned_data['gravatar'] == 'True')
    profile = super(ProfileForm, self).save(*args,**kwargs)
    return profile 
```

看来您正在使用自定义小部件，并且从外观上看，您需要将字符串`'True'`（从表单传回）更改为布尔值`True`，然后再将其保存到数据库。但是，当您`save()`在下一行调用时，将直接使用表单中的数据`ModelForm`覆盖您给出的值：`self.instance.gravatar``cleaned_data`

[https://github.com/django/django/blob/master/django/forms/models.py#L351](https://github.com/django/django/blob/master/django/forms/models.py#L351)

* * *

此外，在 中`__init__`，您不需要包括

```
self.fields['gravatar'].initial = self.instance.usesGravatar 
```

因为此字段已经绑定到模型表单，并且`UserProfile`当您实例化表单以及视图中的实例时将自动填充（例如，如果正在编辑）。

* * *

最后，在您的 中`Meta`，您不需要同时包含`excludes`and `fields`，一个或另一个应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T05:30:03.437

首先考虑@Timmy 的建议。唯一应该注意的是这一行：

```
profile = super(ProfileForm, self).save(*args,**kwargs) 
```

默认情况下，该`save`方法具有`commit=True`. 验证调用此表单的函数可能正在`commit=False`发送`args`或`kwargs`。如果是，那么您必须`profile.save()`在返回之前手动保存配置文件，因为这`commit=False`意味着更改不会反映到数据库。

为什么您允许用户同时更新用户名和电子邮件？如果您允许更新这两个字段，您将如何跟踪注册过程？通常用户使用他们的电子邮件注册。定义您希望保持不变的字段（用户名或电子邮件）的标准。

**更新**

此外，您在保存功能中又做错了一件事。您正在更新来自 的用户中的电子邮件、用户名、名字和姓氏`instance.user`。但是当在此处调用配置文件表单默认保存时，该实例被覆盖`profile = super(ProfileForm, self).save(*args,**kwargs)`。您应该做的是使用由返回的`user = profile.user`The更新这些字段。您的函数应如下所示：`profile``super``save`

```
def save(self, *args, **kwargs):
    """
    Update the primary email address on the related User object as well.
    """
    profile = super(ProfileForm, self).save(*args,**kwargs)

    u = profile.user
    u.email = self.cleaned_data['email']
    u.username = self.cleaned_data['display_name']
    u.first_name = self.cleaned_data['first_name']
    u.last_name = self.cleaned_data['last_name']
    u.save()
    #profile.save() #if commit=False in kwargs
    return profile 
```

# arrays - Rails 3 => 当我尝试 rake db:migrate 时未定义的方法'array'

> ID：11254467
> 
> 赞同：7
> 
> 时间：2012-06-28T23:53:58.893
> 
> 标签：arrays, ruby-on-rails-3, scaffold, dbmigrate

这是我在这里的第一篇文章，所以请放轻松。我正在尝试在 Rails 3.2.1 中构建我的第一个应用程序。我正在尝试使用以下终端命令为 Paint 生成脚手架：

```
rails generate scaffold Paint paint_family:string paint_hex:array paint_available:boolean     paint_location:integer paint_quantity:integer paint_additional_info:text 
```

但是当我尝试迁移时，出现以下错误：

```
undefined method `array' for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x007fbd8bdb1c58> 
```

迁移记录如下：

```
 class CreatePaints < ActiveRecord::Migration
  def change
    create_table :paints do |t|
    t.string :paint_family
    t.array :paint_hex
    t.boolean :paint_available
    t.integer :paint_location
    t.integer :paint_quantity
    t.text :paint_additional_info

    t.timestamps
 end
 end 
```

结尾

我一生都无法弄清楚为什么会这样。但那是因为我不知道我在做什么。任何建议/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T23:58:05.270

问题是这样的：

```
t.array :paint_hex 
```

没有称为 的列类型`array`。如果你真的想保存一个数组，你可以使用`string`or`text`然后序列化这个值。

```
class Paint < ActiveRecord::Base
  serialize :paint_hex
end 
```

*顺便说一句*：为所有属性名称添加前缀`paint_`是 Rails 应用程序的一种非常不常见的命名方案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-24T16:04:01.403

在 Rails 4 和使用 PostgreSQL 中，您实际上可以在数据库中使用数组类型：

移民：

```
class CreateSomething < ActiveRecord::Migration
  def change
    create_table :something do |t|
      t.string :some_array, array: true, default: []
      t.timestamps
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T00:00:25.457

数组不是有效的数据库类型。您不能创建类型为数组的列。

有一些方法可以将数组存储在字段中。检查[**序列化**](http://apidock.com/rails/ActiveRecord/Base/serialize/class)方法。您必须声明**文本**类型的列，并且在类中指定列序列化为数组类型的对象

# jquery - html页面加载后文本消失

> ID：11254468
> 
> 赞同：2
> 
> 时间：2012-06-28T23:54:00.870
> 
> 标签：jquery, html, css

页面加载后，我的文本消失了，我无法确定原因。（我是事后来的，并没有写网站）

[http://www.woodgroupfs.com/index2.html](http://www.woodgroupfs.com/index2.html)标题图像顶部的白色文本显示出来，就像它应该显示的那样，然后它被删除。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:04:08.020

如果您禁用 JavaScript 并重新加载页面，则会出现文本...所以我建议您查看页面上运行的所有 JavaScript 并找出删除它的原因。

编辑：在浏览了你的 JavaScript 之后，我在你的 script.js 中看到了这一行：

```
$('#headerPhrase').remove(); 
```

那应该是罪魁祸首...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:05:00.820

script.js 第 156 行 =`$('#headerPhrase').remove();`

在 Firebug 中：如果我删除这条线一切正常！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:07:02.737

标题中消失的白色文本位于具有 id 的元素中`#headerPhrase`。在您的 scripts.js 的第 156 行：

```
$('#headerPhrase').remove(); 
```

将其从页面中完全删除。

我猜是因为有些图像中的白色文字被烧掉了，这就是它发生的原因，所以它可能不像删除这条线那么简单。

# c#-4.0 - XmlDocument SelectNodes：仅通过属性值查找元素

> ID：11254471
> 
> 赞同：2
> 
> 时间：2012-06-28T23:54:20.447
> 
> 标签：c#-4.0, xpath, xmldocument

我想将子节点添加到 XmlDocument 中的元素。对于我的生活，我似乎无法找到一种方法来找到所有元素的方法，其中存在具有已知值的属性**而不知道元素的名称**。

但是我无法让 xpath 工作。

```
doc.SelectNodes(/XXXXXX[@Name='the_value_I_want']) 
```

请问XXXX里有什么？

如果它更容易，我很乐意切换这个函数 Linq2Xml。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-29T00:00:15.020

```
doc.SelectNodes("//node()[@Name='the_value_I_want']") 
```

要不就

```
doc.SelectNodes("//[@Name='the_value_I_want']") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T23:57:19.747

只需使用`*`

```
doc.SelectNodes(/*[@Name='the_value_I_want']) 
```

或者

```
doc.SelectNodes(//*[@Name='the_value_I_want']) 
```

# r - 用 0 替换行最大值

> ID：11254473
> 
> 赞同：0
> 
> 时间：2012-06-28T23:54:27.127
> 
> 标签：r, plyr

我有一个带有数值的 data.frame。如何将每一行的最大值替换为 0 所以例如在一行中：

> 10、1、3、4

输出将是

> 0、1、3、4

我试过：

```
df1  <- data.frame(df)[apply(df,1,which.max=0)] 
```

但我有问题。

我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:13:29.770

怎么样

```
replace_max <- function(x){x[which.max(x)] <- 0;x}

t(apply(df, 1, replace_max)) 
```

或者

```
library(plyr)
adply(df, 1, replace_max) 
```

**编辑**做行

**编辑：2**以确保 data.frame

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:09:40.810

这是我的做法：

```
a <-matrix(round(runif(25)*100,0),ncol=5) #create matrix
my.max <-apply(a,1,which.max) #find max position by row

>     a
     [,1] [,2] [,3] [,4] [,5]
[1,]   62   14   19   64   40
[2,]   74   83   26   95   14
[3,]   32   69   24   12   67
[4,]  100   57   19    3   16
[5,]   41    6   93   85   67

z <-cbind(1:5,my.max) #create coordinates
a[z] <-0 #replace those entries
>     a
     [,1] [,2] [,3] [,4] [,5]
[1,]   62   14   19    0   40
[2,]   74   83   26    0   14
[3,]   32    0   24   12   67
[4,]    0   57   19    3   16
[5,]   41    6    0   85   67 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T01:51:13.733

试试这个：

```
#Generating a fake dataframe:
   df=data.frame(A=c(1:5), B=c(6,111,5,7,10), C=c(11,28,65,7,15) , D=c(21:25))
 > df
  A   B  C  D
1 1   6 11 21
2 2 111 28 22
3 3   5 65 23
4 4   7  7 24
5 5  10 15 25

n=length(rownames(df))
for(i in 1:n){
c1=as.numeric(which.max(df[i,]))
df[i,c1]=0

}

df    #output
   A  B  C  D
 1 1  6 11  0
 2 2  0 28 22
 3 3  5  0 23
 4 4  7  7  0
 5 5 10 15  0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T10:06:02.927

怎么样：

```
x <- matrix(sample(1:16),nrow=4)

x
     [,1] [,2] [,3] [,4]
[1,]    1   12    6    4
[2,]   16    2   13   15
[3,]   11    8   10    7
[4,]   14    9    5    3

x*as.logical(x-apply(x,1,max))
     [,1] [,2] [,3] [,4]
[1,]    1    0    6    4
[2,]    0    2   13   15
[3,]    0    8   10    7
[4,]    0    9    5    3 
```

# ios - 是否有一个开源 iOS 应用程序允许用户使用 Facebook 授权注册和登录？

> ID：11254481
> 
> 赞同：0
> 
> 时间：2012-06-28T23:55:30.997
> 
> 标签：ios

我有兴趣学习管理用户会话和组织 ViewController 以进行注册/登录的最佳实践。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:05:08.453

这是 Facebook [HackBook](https://github.com/facebook/facebook-ios-sdk/tree/master/sample/Hackbook) Sample iOS 应用程序，它应该与官方[文档一起提供帮助](https://developers.facebook.com/docs/mobile/ios/build/)

> ### 适用于 iOS 的 Hackbook
> 
> 演示如何使用 Facebook 平台集成您的 iOS 应用程序。该示例最初要求用户登录 Facebook，然后向用户提供一组 Facebook API 调用示例，例如注销、卸载应用程序、发布新闻提要、发出应用程序请求等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:58:25.173

你应该知道的一切都在这里，

[https://developers.facebook.com/docs/mobile/ios/build/](https://developers.facebook.com/docs/mobile/ios/build/)

*   第 3 步
*   第4步

与您的问题最相关

# php - 在发票 PDF 上打印客户订单备注

> ID：11254489
> 
> 赞同：0
> 
> 时间：2012-06-28T23:57:01.557
> 
> 标签：php, magento, pdf-generation, gomage

我在检索订单上的客户订单备注时遇到了困难。例如，在 Mage/Sales/Model/Order/Pdf/Abstract.php 中，有一段代码适用于 Sales/Order 模型。IE

```
($order instanceof Mage_Sales_Model_Order) is true in the PDF example 
```

或者

```
$order = Mage::getModel('sales/order')->load($orderID); in another example 
```

在我们的结帐过程中，客户可以对订单进行评论，但我不知道如何检索。有没有人怎么拉这个？我正在寻找沿线的某个地方`$order->getOrderComments()`......

版本：Magento Entreprise 1.11.2.0

允许订单评论的使用扩展：GoMage LightCheckout 3.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:18:13.637

看起来 GoMage LightCheckout 模块扩展`Mage_Sales_Model_Order`了一个`getGomageCheckoutCustomerComment()`应该*给*你想要的方法。

来源：[http ://wiki.gomage.com/pages/viewpage.action?pageId=590188](http://wiki.gomage.com/pages/viewpage.action?pageId=590188)

# django - 如何使用 pycharm 调试/断点我的 django 应用程序？

> ID：11254491
> 
> 赞同：45
> 
> 时间：2012-06-28T23:57:18.853
> 
> 标签：django, pycharm

我正在尝试解决如何运行 pycharm 似乎提供的调试功能（好吧，无论如何，它允许我设置断点，所以我假设它有一个不错的 gui）

我得出的结论是，我不能使用 ctrl-shift-r 和“runserver”命令，而是需要设置“运行配置”？我做了一个“django 服务器”，但我不知道要放什么值等等。当我运行它时，它告诉我某些设置是错误的 - 我很确定它不是，因为标准的“runserver " 命令工作正常。

这就是我得出的结论。如果有一个漂亮的教程或步骤来获得它，那么我可以

1.  设置一个断点
2.  转到触发该断点的页面并遵循代码在 pycharm 中的内部工作

我会很激动的！

干杯！

更新：如果您想知道，这是我得到的错误：

> 回溯（最近一次通话最后）：
> 
> 导入设置中的文件“manage.py”，第 11 行
> 
> 文件“C:\development\PycharmProjects\dumpstown\settings.py”，第 185 行，在 add_to_builtins('gravatar.templatetags.gravatar')
> 
> 文件“C:\development\python\lib\site-packages\django\template\base.py”，第 1017 行，在 add_to_builtins
> 
> builtins.append（import_library（模块））
> 
> 文件“C:\development\python\lib\site-packages\django\template\base.py”，第 963 行，在 import_library
> 
> raise InvalidTemplateLibrary("ImportError raise loading %s: %s" % (taglib_module, e))
> 
> django.template.base.InvalidTemplateLibrary：ImportError raise loading loading gravatar.templatetags.gravatar：无法导入设置，因为环境变量 DJANGO_SETTINGS_MODULE 未定义。

应用程序本身在“运行服务器”上从来没有任何问题。

更新：根据我在下面的回答，pycharm 对于 add_to_builtins 已损坏。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-29T06:49:01.830

1.  设置你的虚拟环境

    1.  在 PyCharm 中创建或打开您的项目
    2.  转到菜单中的文件 - 设置（或只需单击设置图标）
    3.  转到 Python 解释器
    4.  点击顶部的添加
    5.  转到您创建虚拟环境的 bin 文件夹并选择 python
2.  设置断点

    1.  在要设置断点的代码行旁边。左边通常有一条灰线。通常在行号旁边。只需点击那里，就会出现一个大红点。[看起来像这样](http://www.jetbrains.com/pycharm/webhelp/breakpoints-icons-and-statuses.html)
3.  点击以调试模式运行按钮。

    1.  在绿色播放按钮旁边有一个按钮，上面有一个错误。使用它以调试模式启动运行服务器。现在，当您使用 Web 应用程序并且代码到达断点时，它将停在那里，您将能够单步执行或继续执行 pycharm。

        *   如果您仍然无法调试，您可能需要编辑 pycharm 项目配置。你可以这样做[。](http://www.jetbrains.com/pycharm/webhelp/creating-and-editing-run-debug-configurations.html)

您也可以查看[http://garmoncheg.blogspot.it/2012/01/establishing-dev-environment-with.html](http://garmoncheg.blogspot.it/2012/01/establishing-dev-environment-with.html)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2019-09-17T09:28:44.050

这个问题与 DJANGO_SETTINGS_MODULE 关系不大。Pycharm 在创建项目时设置它。而是转到绿色的小“播放按钮”以运行脚本。您想将其配置为运行 manage.py，即您正在配置播放按钮以运行命令`python manage.py runserver`。分解：

`python`------> 使用 python 解释器运行

`manage.py`--------> 运行这个脚本

`runserver`---------> 论据

所以转到绿色播放按钮左侧的下拉菜单

[![绿色运行按钮](../Images/a67bf1064fd0f0849a167fdf2fd0ce2d.png)](https://i.stack.imgur.com/tymFs.png),

点击编辑配置。你会得到一个像这样的屏幕

[![这](../Images/60e214d6015eb4adf5989be9fda0c63f.png)](https://i.stack.imgur.com/ayjmN.png).

如图所示填写它，找到您的 manage.py 源脚本。确保在参数框中包含 runserver。现在您可以单击绿色**调试**按钮，您的程序将在遇到的第一个断点处停止，允许您在完全调试模式下查看变量和所有内容。现在您可以在终端上手动键入 python manage.py runserver 或使用您的 newley 配置的运行按钮。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-02T18:54:15.373

所以我在这里给所有答案一个+1的尝试-但它们不是问题。据我所知，答案是 pycharm 坏了。这很痛苦，但解决方案很简单 -

如果您*不想*使用 pycharm 顶部的绿色小按钮，或者使用 pycharm 调试功能？那么别担心，你不需要做任何事情。继续使用 ctrl-shift-r 和 runserver （或任何你的 manage.py 快捷方式）

如果你*确实*想使用绿色的小“运行”按钮，或者如果你想使用 pycharm 的调试工具包，那么你*绝对不能*使用“add_to_builtins”，至少在 settings.py 文件中（我自己从来没有把它放在其他任何地方，pycharm 可能在其他地方需要它？）。`add_to_builtins`在 pycharm 中不起作用 - 当您使用绿色小按钮或调试按钮时，它会陷入严重后果的循环中。奇怪的是，使用 ctrl-shift-r 和 runserver 并没有这个问题。

好消息是“add_to_builtins”不是必须的，只是一个不错的选择。只需将“{% load x %}”命令添加到您使用 x 的每个模板，您就会被设置。或者，节省一百美元并使用某种免费的日食工具。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-29T06:42:50.683

问题是`DJANGO_SETTINGS_MODULE`应该指向项目设置文件的变量没有在任何地方设置，因为据报道该变量未定义。

您可以参考的解决方案和解释可以在[以前的帖子中找到](https://stackoverflow.com/questions/5988597/pycharm-django-settings-module-is-undefined)

# java - 如何让 Java 应用程序在 Mac OS X 10.6.8 上读取“系统”环境变量（来自 Info.plist）？

> ID：11254493
> 
> 赞同：2
> 
> 时间：2012-06-28T23:57:28.420
> 
> 标签：java, macos, environment-variables

我们有一个当前在 Windows 上运行的 Java 应用程序，它需要配置信息才能在 Windows XP 和 Win 7 上正常工作。该配置信息是使用 Windows 系统变量定义的（适用于应用程序的所有用户），而不是用户变量（仅适用于当前运行应用程序的用户。）

我的工作是让它在 Mac (OS X 10.6.8) 上运行当我使用 JarBundler 为 Mac 构建应用程序时，我将这些变量的属性设置为正确的值，我看到它们按预期显示，在 app 文件夹的 Info.plist 文件中。从我对可用文档的阅读来看，Info.plist 属性似乎应该适用于应用程序的所有用户，类似于 Windows 系统环境变量。

但是，当我使用 PackageMaker 创建包、安装它然后运行应用程序时，会返回 null 作为这些变量的值。我正在使用 Java 的最新更新——更新 9。（null 的返回被视为控制台窗口中数据字段中的 null 错误......并且应用程序挂起。）

我已经验证正在安装 Info.plist 文件；它位于 app 文件夹中的预期位置，并且包含预期的数据。

如果我没有使用 info.plist，而是创建了文件 ~/.MacOSX/environment.plist，其中包含相同的变量（使用属性列表编辑器）并重新启动计算机，应用程序按预期运行，表明正在输入有效数据根据环境变量的请求返回。

因为目标是通过 PackageMaker 制作最终用户可安装的应用程序，而不需要用户为 environment.plist 创建隐藏文件夹，手动将文件移到那里，注销并重新登录，或重新启动计算机，然后才能安装运行应用程序，我更愿意使用 Info.plist 找到解决方案。

让 Java 应用程序正确读取 Info.plist 中的属性是否有一些技巧？是否需要在 JarBundler、PackageMaker 中或通过属性列表编辑器来完成这项工作？

或者这可能需要对 Java 代码进行一些修改？（我不知道具体用什么命令来读取环境变量数据。目前我没有访问源代码，虽然我可以访问它，如果需要回答这个问题。）

编辑：这是我的片段`Info.plist`：

```
<key>Properties</key> 
<dict> 
    ...
    <key>COMPENDIUM_DEVELOPER</key> 
    <string>true</string> 
    <key>CompendiumUserPath</key> 
    <string>/Applications/Compendium_CN</string> 
    <key>CompendiumSysPath</key> 
    <string>/Applications/Compendium_CN</string>
    ...
</dict> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:09:37.030

除了使用 之外`JavaApplicationStub`，您还可以将 shell 脚本的名称指定为捆绑包的可执行文件。您的程序应该可以通过`System.getenv()`. 例如，`<dict>`下面是 NetBeans`Info.plist`中引用 shell 脚本的条目`MacOS/netbeans`：

```
<key>CFBundleExecutable</key>
<string>netbeans</string> 
```

# clojure - Clojure 的惰性求值发生了什么

> ID：11254495
> 
> 赞同：4
> 
> 时间：2012-06-28T23:57:42.363
> 
> 标签：clojure, lazy-evaluation

我正在以 clojure 方式扭曲我的旧 java/python 头。请帮助我理解 clojure 的惰性特性。

```
=> (def myvar (lazy-seq [1 2 (prn "abc")]))
#'user/myvar 
```

以上很容易理解。由于它是一个惰性序列，因此 (prn "abc") 不会被评估，因此不会打印任何内容。

```
=> (def myvar (lazy-seq [1 2 (prn undefined-var)]))
CompilerException java.lang.RuntimeException: Unable to resolve symbol: undefined-var in this context, compiling:(NO_SOURCE_PATH:1) 
```

如您所见，上述内容将引发错误。为什么 ？

我的（错误）理解是，因为它是懒惰的，所以（prn undefined-var）可以合法地在这里，即使“undefined-var”尚未定义。

请任何人指出我对正确方法的理解。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T00:20:50.070

当 clojure 阅读器发现

```
 (def myvar (lazy-seq [1 2 (prn undefined-var)])) 
```

它需要编译它，这就是它抛出错误的原因，因为未定义 undefined-var。在第一种情况下，它可以编译，但直到您使用 seq 才会执行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-29T09:22:00.573

以上两个答案都为您提供了有关该主题的良好信息，但我将尝试在此处确定关键问题。当你在 REPL 上写一个[s 表达式](http://en.wikipedia.org/wiki/S-expression)`(+ x 2)`时，会发生两件事：

1.  [由读者](http://clojure.org/reader)解析产生*形式*的字符，例如符号，
2.  [表格的评估](http://clojure.org/evaluation)。

惰性求值推迟了第二步，但在第一步中，当读者遇到`undefined-var`它试图将其转换为符号时，发现没有定义这样的符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:16:42.573

您似乎有正确的理解，**这不是lazy-seq函数的工作方式** ，这里是一个典型的例子：

```
user> (lazy-seq (cons 4 (range 5)))
(4 0 1 2 3 4) 
```

`lazy-seq`几乎总是采用 cons 表达式，其中第一个参数是序列中的第一项，第二个参数是生成列表其余部分的代码。人们很少需要在日常 Clojure 中直接使用惰性序列，使用 , 等形式`map` `reduce`更为`filter`常见。

生成序列其余部分的函数中的代码也需要能够被编译，在您的情况下，您也可以通过使用延迟编译，`eval`尽管我建议不要在其他需要阅读的代码中使用 eval 来处理类似的事情；虽然可以很好地学习;-)

```
user> (def myvar (lazy-seq (cons 1 (eval '(prn undefined-var))))) ; don't do this at work
#'user/myvar
user> myvar
; Evaluation aborted.
user> 
```

# knockout.js - $.expandingTextarea 的自定义绑定与 knockout.js

> ID：11254501
> 
> 赞同：0
> 
> 时间：2012-06-28T23:58:40.197
> 
> 标签：knockout.js, knockout-2.0

我正在编写一个自定义绑定以将[$.expandingTextarea](https://github.com/bgrins/ExpandingTextareas)与[Knockout.js](http://knockoutjs.com/)一起使用。

继出色的文章[Another Look at Custom Bindings for KnockoutJS](http://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html)之后，我希望它会像下面这样简单：

```
ko.bindingHandlers.expandingTextarea = {
  init: function(element, valueAccessor) {
    $(element).expandingTextarea();
  },
   update: function(element, valueAccessor, aBA, vm) {
    ko.bindingHandlers.value.update(element, valueAccessor, aBA, vm);
    $(element).expandingTextarea("resize");
  }
} 
```

不幸的是，这并没有按预期工作 - 即当对 textarea 进行更改时，相应的视图模型不会更新。这是一个[说明](http://jsfiddle.net/bmh_ca/pxZmH/)问题的jsFiddle。

如何为扩展文本区域插件创建 KO 自定义绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:13:53.730

这是[jsFiddle 上的解决方案](http://jsfiddle.net/bmh_ca/pxZmH/1/)，即还添加值绑定`init`（其中包含捕获参数指定的事件的代码`valueUpdate`）：

```
ko.bindingHandlers.expandingTextarea = {
    init: function(element, valueAccessor, aBA, vm) {
        $(element).expandingTextarea();
        ko.bindingHandlers.value.init(element, valueAccessor, aBA, vm);
    },
    update: function(element, valueAccessor, aBA, vm) {
        ko.bindingHandlers.value.update(element, valueAccessor, aBA, vm);
        $(element).expandingTextarea("resize");
    }
}; 
```

我希望这对其他人有帮助！:)

# iphone - iPhone 上缓存的证书身份验证

> ID：11254504
> 
> 赞同：2
> 
> 时间：2012-06-28T23:59:20.087
> 
> 标签：iphone, objective-c, https, nsurlcredential

所以我有一个向服务器发出 https 请求的应用程序。它使用 .p12 证书和密码进行身份验证。现在，它当前在第一次身份验证质询后缓存此信息，随后的 HTTP 请求确实受到质询。我希望“注销”并删除缓存，以便它再次执行身份验证质询。我一直在查看 stackoverflow 和其他网站上的各种相关帖子，但还没有找到我的问题的简明答案。我宁愿不包含另一个 SDK（例如 ASIHTTPRequest）来执行此操作。谁能帮我？

干杯，

罗宾

更新：所以为了澄清，我试过了

```
NSURLCredential *identityCredential = [NSURLCredential credentialWithIdentity:identity certificates:nil persistence:NSURLCredentialPersistenceNON]; 
```

我也尝试过删除所有 cookie 并清除 sharedUrlCache

发现的问题：

好的，所以问题是 NSURLConnection 自动附加了“Connection”：“keep-alive”标头。因此，快速（在 10-15 秒内）连续多次发出相同的请求意味着连接仍然打开，因此不需要挑战。显然目前无法更改此设置，因为手动将此标头设置为“关闭”不会这样做。

# jquery - 即使悬停也让css3动画播放？

> ID：11254512
> 
> 赞同：0
> 
> 时间：2012-06-29T00:00:51.090
> 
> 标签：jquery, html, animation, css

当您将鼠标悬停在我的网站上时，我的网站上有一个小菜单徽标摆动。它看起来非常好，但理想情况下我喜欢先让动画一直播放。这就是我使用的：

[http://daneden.me/animate/](http://daneden.me/animate/)

这是我的代码：

js

```
$(function() {
    $('.logo').hover(function(){$(this).addClass('animated swing')},function(){$(this).removeClass('animated swing')});
}); 
```

css3

```
.animated {
    -webkit-animation-duration: 1s;
       -moz-animation-duration: 1s;
        -ms-animation-duration: 1s;
         -o-animation-duration: 1s;
            animation-duration: 1s;
    -webkit-animation-fill-mode: both;
       -moz-animation-fill-mode: both;
        -ms-animation-fill-mode: both;
         -o-animation-fill-mode: both;
            animation-fill-mode: both;
}

@-webkit-keyframes swing {
    20%, 40%, 60%, 80%, 100% { -webkit-transform-origin: top center; }
    20% { -webkit-transform: rotate(15deg); }   
    40% { -webkit-transform: rotate(-10deg); }
    60% { -webkit-transform: rotate(5deg); }    
    80% { -webkit-transform: rotate(-5deg); }   
    100% { -webkit-transform: rotate(0deg); }
}

@-moz-keyframes swing {
    20% { -moz-transform: rotate(15deg); }  
    40% { -moz-transform: rotate(-10deg); }
    60% { -moz-transform: rotate(5deg); }   
    80% { -moz-transform: rotate(-5deg); }  
    100% { -moz-transform: rotate(0deg); }
}

@-ms-keyframes swing {
    20% { -ms-transform: rotate(15deg); }   
    40% { -ms-transform: rotate(-10deg); }
    60% { -ms-transform: rotate(5deg); }    
    80% { -ms-transform: rotate(-5deg); }   
    100% { -ms-transform: rotate(0deg); }
}

@-o-keyframes swing {
    20% { -o-transform: rotate(15deg); }    
    40% { -o-transform: rotate(-10deg); }
    60% { -o-transform: rotate(5deg); } 
    80% { -o-transform: rotate(-5deg); }    
    100% { -o-transform: rotate(0deg); }
}

@keyframes swing {
    20% { transform: rotate(15deg); }   
    40% { transform: rotate(-10deg); }
    60% { transform: rotate(5deg); }    
    80% { transform: rotate(-5deg); }   
    100% { transform: rotate(0deg); }
}

.swing {
    -webkit-transform-origin: top center;
    -moz-transform-origin: top center;
    -ms-transform-origin: top center;
    -o-transform-origin: top center;
    transform-origin: top center;
    -webkit-animation-name: swing;
    -moz-animation-name: swing;
    -ms-animation-name: swing;
    -o-animation-name: swing;
    animation-name: swing;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:06:08.530

如果你知道动画需要多长时间，你可以这样做：

```
$(function() {
    $('.logo').hover(function(){
        $(this).addClass('animated swing');
        setTimeout(function() {
            $(this).removeClass('animated swing');
        }, ...);
    });
}); 
```

# tomcat - WEB-INF 和 /src/main/resources 文件夹有什么区别？

> ID：11254514
> 
> 赞同：5
> 
> 时间：2012-06-29T00:01:02.990
> 
> 标签：tomcat, web-applications, resources, spring-3, web-inf

在使用休眠的 Spring 3 应用程序中，哪些文件“特别”需要位于 WEB-INF 中？我也在使用 Maven。

在应用程序在生产环境中运行之前，是否需要将 /src/main/resources 中的某些文件复制到 WEB-INF？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T02:38:43.567

在您的情况下，`WEB-INF`应该包含一个 Web 描述符`web.xml`和 Spring 配置文件。而Hibernate的配置文件`hibernate.cfg.xml`和其他映射文件在开发的时候要放在里面`src/main/resources`。

> [http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch01.html#tutorial-firstapp](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch01.html#tutorial-firstapp)

这个来自 Hibernate 的官方教程告诉你一些关于包含什么的细节，`src/main/resources`这`WEB-INF`可能有助于你理解结构。

> [http://viralpatel.net/blogs/spring3-mvc-hibernate-maven-tutorial-eclipse-example/](http://viralpatel.net/blogs/spring3-mvc-hibernate-maven-tutorial-eclipse-example/)

此外，我发现本教程与您的案例非常相似，您可能对此有参考。

*免责声明：我不拥有任何网络教程资源。*

# javascript - 撤消或删除上滑

> ID：11254519
> 
> 赞同：1
> 
> 时间：2012-06-29T00:01:26.067
> 
> 标签：javascript, jquery

我有以下代码：

```
 $("#content-listing").slideUp(800, function(){
            $("#loading").hide();
        }); 
```

哪个工作正常。但是有没有一种方法可以“撤消”slideUp 或删除它的功能？

我`matchMedia`用来根据用户的屏幕尺寸应用某些功能。如果调整浏览器窗口的大小，`slideUp`会干扰新转换的布局，所以我想找到一种方法来删除它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:11:17.747

```
if ($(window).width() <= 400 ) {
     $("#content-listing").slideUp(800, function(){
     $("#loading").hide();
} 
```

您也可以尝试`resize`事件：

```
$(window).resize(function() {
  var w = $(this).width();

  if (w <= '400') {
      $("#content-listing").slideUp(800, function(){
          $("#loading").hide();
      });
  }       
}) 
```

*更新：*

尝试[`dequeue()`](http://api.jquery.com/dequeue/)方法：

```
 $("#content-listing").queue('slide', function(){
           $(this).slideUp(800, function(){
                $("#loading").hide();
           });
      })

      if (w <= '400') {
          $("#content-listing").dequeue('slide')
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:04:14.207

我认为您正在寻找 $("#...").stop();

[http://api.jquery.com/stop/](http://api.jquery.com/stop/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:23:53.197

我最终做的是对`body`标签应用一个类，`onclick`以便我可以专门参考移动 div 来投射 jQuery voodoo：

```
$("body").addClass("mobile"); 
```

到哪：

```
 $("body.mobile #content-listing").slideUp(function(){
        $("#loading").hide();
    }); 
```

然后一旦`window.resize`发生，我`mobile`从`body`：

```
$("body").removeClass("mobile"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T00:09:10.150

我会在 slideUp 代码周围放置一个条件语句。

就像是

```
var isMobile = //whatever you're using to decide what your toggle threshold is

if(isMobile)
{

    $("#content-listing").show();
    //Or whatever you want to do in the case of a small screen
} else {
    $("#content-listing").slideUp(800, function(){
        $("#loading").hide();
    });
} 
```

# java - Java 集合排序 BigDecimal

> ID：11254521
> 
> 赞同：1
> 
> 时间：2012-06-29T00:01:45.600
> 
> 标签：java, android, collections, arraylist, bigdecimal

我正在尝试按 BigDecimal 对 ArrayList 进行排序并遇到砖墙。我有一个看起来有点像这样的类：

```
public class deal implements Comparable<deal>{

protected BigDecimal bdPrice;
protected int iQuantity;
protected String sDealType;
protected UUID dealUniqueID;
protected int dealID;
protected BigDecimal bdUnitPrice;

public deal(){
    bdPrice         = new BigDecimal("0");
    bdUnitPrice     = new BigDecimal("0");
    iQuantity       = 1;
    sDealType       = "Single item";
    dealUniqueID    = UUID.randomUUID();
    dealID          = 0;
}

private void setUnitPrice(){
    this.bdUnitPrice = this.bdPrice.divide(new BigDecimal(this.iQuantity));
}

public BigDecimal compareTo(deal oDeal) {
    // TODO Auto-generated method stub
    return bdUnitPrice.compareTo(oDeal.getUnitPrice());
}

public boolean equals(deal oDeal) {
    if (!(oDeal instanceof deal))
        return false;
    deal oD = (deal) oDeal;

    return this.bdUnitPrice.equals(oD.bdUnitPrice);
}
} 
```

我的主要 Android Activity 如下所示：

```
public class SupermarketDealsActivity extends Activity {
private ArrayAdapter<deal> itemAdapter;
private ListView lvDeals;
private ArrayList<deal> itemArray;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    SetUpView();
}

private void SetUpView(){
lvDeals                     = (ListView)this.findViewById(R.id.listDeals);

    itemArray                   = new ArrayList<deal>();
    itemArray.clear();

    itemAdapter                 = new ArrayAdapter<deal>(this, android.R.layout.simple_list_item_1,itemArray);
    lvDeals.setAdapter(itemAdapter);
}

private void CreateADeal(int iQuantity, BigDecimal bdPrice) {
    deal oDeal                  = new deal();

    oDeal.setQuantity(iQuantity);
    oDeal.setPrice(bdPrice);

    CreateListDeals(oDeal);
}

private void CreateListDeals(deal oDeal){
    itemArray.add(oDeal);
    Collections.sort(itemArray,Collections.reverseOrder());
    itemAdapter.notifyDataSetChanged();
}
} 
```

在我的 java 类中，我的 compareTo 方法出现错误：

> 类型不匹配：无法从 int 转换为 BigDecimal

我一定是在路上错过了什么，那是什么？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T00:11:32.300

```
public BigDecimal compareTo(deal oDeal) {
    // TODO Auto-generated method stub
    return bdUnitPrice.compareTo(oDeal.getUnitPrice());
} 
```

既不匹配接口的签名，也不匹配的返回类型`bdUnitPrice.compareTo`。将其更改为：

```
public int compareTo(deal oDeal) {
    // TODO Auto-generated method stub
    return bdUnitPrice.compareTo(oDeal.getUnitPrice());
} 
```

我应该提到的其他几件事（来自评论）：

1.  类的名称应以大写字母开头。有一个“[代码约定](http://www.oracle.com/technetwork/java/codeconv-138413.html)”文档说明了你应该做的其他事情。
2.  你重写`equals`——你永远不应该重写`equals`，除非你也重写`hashCode`——否则如果你把这个类的对象放入一个 HashSet、HashMap 或其他使用哈希的集合中，你会遇到很多问题。

# android - Android runOnUiThread 解释

> ID：11254523
> 
> 赞同：27
> 
> 时间：2012-06-29T00:01:56.120
> 
> 标签：android

我试图在我的一项活动的 onCreate() 方法期间显示进度对话框，完成在线程中填充屏幕的工作，然后关闭进度对话框。

这是我的 onCreateMethod()

```
dialog = new ProgressDialog(HeadlineBoard.this);
        dialog.setMessage("Populating Headlines.....");
        dialog.show();
        populateTable(); 
```

populateTable 方法包含我的线程和关闭对话框的代码，但出于某种原因。活动出现空白大约 10 秒（执行 populateTable() 工作），然后我看到屏幕。我从来没有看到显示的对话框，有什么想法吗？

这是 populateTable() 代码：

```
//Adds a row to the table for each headline passed in
private void populateTable() {
    new Thread() {
        @Override
        public void run() {
            //If there are stories, add them to the table
            for (Parcelable currentHeadline : allHeadlines) {
                addHeadlineToTable(currentHeadline);
            }
               try {
                     // code runs in a thread
                     runOnUiThread(new Runnable() {
                            @Override
                            public void run() {
                                dialog.dismiss();
                            }
                     });
               } catch (final Exception ex) {
                   Log.i("---","Exception in thread");
               }
        }
 }.start();

} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-29T00:20:59.847

如果您已经拥有“for (Parcelable currentHeadline : allHeadlines)”的数据，那么为什么要在单独的线程中执行此操作？

您应该在一个单独的线程中轮询数据，并在完成收集数据后，然后在 UI 线程上调用您的 populateTables 方法：

```
private void populateTable() {
    runOnUiThread(new Runnable(){
        public void run() {
            //If there are stories, add them to the table
            for (Parcelable currentHeadline : allHeadlines) {
                addHeadlineToTable(currentHeadline);
            }
            try {
                dialog.dismiss();
            } catch (final Exception ex) {
                Log.i("---","Exception in thread");
            }
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-29T00:27:18.317

这应该适合你

```
 public class MyActivity extends Activity {

    protected ProgressDialog mProgressDialog;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        populateTable();
    }

    private void populateTable() {
        mProgressDialog = ProgressDialog.show(this, "Please wait","Long operation starts...", true);
        new Thread() {
            @Override
            public void run() {

                doLongOperation();
                try {

                    // code runs in a thread
                    runOnUiThread(new Runnable() {
                        @Override
                        public void run() {
                            mProgressDialog.dismiss();
                        }
                    });
                } catch (final Exception ex) {
                    Log.i("---","Exception in thread");
                }
            }
        }.start();

    }

    /** fake operation for testing purpose */
    protected void doLongOperation() {
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-07T17:20:33.900

这不是创建线程和使用，而是[ASyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)`runOnUIThread`的完美工作：

*   在`onPreExecute`中，创建并显示对话框。

*   在`doInBackground` **准备**数据，但不要触摸 UI - 将每个准备好的数据存储在一个字段中，然后调用`publishProgress`.

*   在`onProgressUpdate`读取数据字段并对 UI 进行适当的更改/添加。

*   在`onPostExecute`关闭对话框中。

* * *

如果您有其他原因需要线程，或者正在向现有线程添加 UI 触摸逻辑，则执行与我描述的类似的技术，仅在 UI 线程上运行很短的时间，`runOnUIThread`用于每个 UI 步骤。在这种情况下，您会将每个数据存储在局部`final`变量（或类的字段）中，然后在`runOnUIThread`块中使用它。

# r - 省略包含特定列的行 NA

> ID：11254524
> 
> 赞同：155
> 
> 时间：2012-06-29T00:02:02.450
> 
> 标签：r, dataframe, na

我想知道如何省略`NA`数据框中的值，但仅限于我感兴趣的某些列。

例如，

```
DF <- data.frame(x = c(1, 2, 3), y = c(0, 10, NA), z=c(NA, 33, 22)) 
```

但我只想省略数据 where `y`is `NA`，因此结果应该是

```
 x  y  z
1 1  0 NA
2 2 10 33 
```

`na.omit`似乎删除所有行包含任何`NA`。

有人可以帮我解决这个简单的问题吗？

但是，如果现在我将问题更改为：

```
DF <- data.frame(x = c(1, 2, 3,NA), y = c(1,0, 10, NA), z=c(43,NA, 33, NA)) 
```

如果我只想省略`x=na`or `z=na`，我可以把`|`in 函数放在哪里？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2012-06-29T00:06:10.070

利用`is.na`

```
DF <- data.frame(x = c(1, 2, 3), y = c(0, 10, NA), z=c(NA, 33, 22))
DF[!is.na(DF$y),] 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2016-08-16T18:37:12.930

哈德利`tidyr`刚刚得到了这个惊人的功能`drop_na`

```
library(tidyr)
DF %>% drop_na(y)
  x  y  z
1 1  0 NA
2 2 10 33 
```

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2012-06-29T08:08:52.327

您可以使用该`complete.cases`函数并将其放入函数中：

```
DF <- data.frame(x = c(1, 2, 3), y = c(0, 10, NA), z=c(NA, 33, 22))

completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}

completeFun(DF, "y")
#   x  y  z
# 1 1  0 NA
# 2 2 10 33

completeFun(DF, c("y", "z"))
#   x  y  z
# 2 2 10 33 
```

**编辑：** *只返回没有`NA`s 的行*

如果要消除`NA`任何列中至少有一个的所有行，只需直接使用该`complete.cases`函数：

```
DF[complete.cases(DF), ]
#   x  y  z
# 2 2 10 33 
```

或者如果`completeFun`已经在您的工作流程中根深蒂固；）

```
completeFun(DF, names(DF)) 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2013-06-12T19:00:24.693

使用“子集”

```
DF <- data.frame(x = c(1, 2, 3), y = c(0, 10, NA), z=c(NA, 33, 22))
subset(DF, !is.na(y)) 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2019-02-28T11:48:15.117

可以`na.omit`用于`data.table`：

```
na.omit(data, cols = c("x", "z")) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-08-21T18:44:58.613

如果两个特定列中的任何一个包含 ，则省略行`<NA>`。

```
DF[!is.na(DF$x)&!is.na(DF$z),] 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-29T01:33:56.987

尝试这个：

```
cc=is.na(DF$y)
m=which(cc==c("TRUE"))
DF=DF[-m,] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-22T19:59:40.077

试试这个：

```
DF %>% t %>% na.omit %>% t 
```

它转置数据帧并省略转置之前为“列”的空行，然后将其转回。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-20T02:56:21.623

要更新，一种`tidyverse`方法`dplyr`：

```
library(dplyr)

your_data_frame %>% 
  filter(!is.na(region_column)) 
```

# iphone - 如何倾斜 iphone 应用程序屏幕截图以适合在 photoshop/pixelmator 中倾斜的 iphone？

> ID：11254525
> 
> 赞同：-2
> 
> 时间：2012-06-29T00:02:04.970
> 
> 标签：iphone, photoshop

我正在尝试将应用程序屏幕截图放在 iPhone 的倾斜图片上。如何倾斜我的屏幕截图以适合 iPhone 屏幕？

如果您还可以解释如何添加反射，则可以加分:)

谢谢你！

![在此处输入图像描述](../Images/e1d133797e1a652bcbb279bca54ec2b2.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T00:36:23.023

在 Photoshop 中，按 Command-T。这将使您进入自由变换模式。然后右键单击要倾斜的图像，然后单击的位置会出现一个菜单。在该菜单上，您将拥有“自由变换”、“缩放”、“旋转”、“倾斜”等选项。您想要的选项是“倾斜”。单击倾斜后，单击图像边缘的手柄并向左或向右移动光标。这将对您的图像应用倾斜变换。继续使用手柄调整倾斜变换，直到您的照片适合 iPhone 图像。有关倾斜变换的更多信息，请查看这个很好的教程：[http ://www.youtube.com/watch?v=E4HSShiuKNg](http://www.youtube.com/watch?v=E4HSShiuKNg)

PS 对于反射，您可以创建一个带有白色填充和不透明度渐变的新图层，从顶部的大约 60% 不透明度变为 0%。然后，您可以使用选框工具将其切割成您想要的光泽形状。

# actionscript-3 - 在 AS3 中使用 4x4 3DMatrix 倾斜图像

> ID：11254526
> 
> 赞同：6
> 
> 时间：2012-06-29T00:02:21.273
> 
> 标签：actionscript-3, flash, flash-cs5

我有一个 AS3 位图图像，我想像这样倾斜：

![](../Images/eb7646a02703d36e1af8ea3f73fc372f.png)

我只想歪斜图像的底部，而让顶部保持不变。根据我到目前为止所做的研究，看起来我想使用 Matrix3D 类，但我不太确定如何有效地实现它。

感谢下面的回答，这篇文章是了解具有 3x3 矩阵的 Matrix3D 类的绝佳资源： [http](http://www.senocular.com/flash/tutorials/transformmatrix/) ://www.senocular.com/flash/tutorials/transformmatrix/ 然而，尽管该教程很棒，但它没有提供扭曲上述图像的能力。我正在寻找的是关于如何使用 4x4 矩阵的类似教程。我只想知道将数字放在矩阵中的哪个位置，我应该能够弄清楚其他所有内容。

下面是一些关于我所拥有的示例代码：

```
var tempLoader:Loader=new Loader();
var tempBitmap:Bitmap;
var fattenTheBottom:Number;
tempLoader.load(new URLRequest("image.png"));
tempLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,castBitmap);
function castBitmap(e:Event):void
{
    tempLoader.contentLoaderInfo.removeEventListener(Event.COMPLETE,castBitmap);
    tempBitmap = Bitmap(tempLoader.content);
    // Make the image into a trapezoid here using fattenTheBottom
    addChild(tempBitmap);
} 
```

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T12:14:05.777

如果您想快速使用 Matrix3D，以下是您应该使用的值类型的示例：

```
var m3d:Matrix3D = new Matrix3D(Vector.<Number>([
    1, 0,    0,    0, 
    0, 1.15, 0.25, 0.00005,
    0, 0,    1,    0,
    0, 0,    0,    1
]));
tempBitmap.transform.matrix3D = m3d; 
```

但是很快你就会注意到这种方法会以你不想要的方式扭曲图像。例如，它会在一侧**水平挤压您的图像（如您所愿），但图像的内容也会****垂直**拉伸。很难解释，但是一旦你尝试了上面的方法，你就会注意到图像是如何被垂直拉伸的。

与、 和`rotationX`结合使用可以获得相同的效果。`PerspectiveProjection``scaleY`

如果您想要一个更优雅的解决方案，无论是代码还是图像结果，请尝试[DistortImage](http://www.rubenswieringa.com/blog/distortimage)。那里的方法不是直截了当的（使用子图像的网格），但效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T02:23:29.647

我只能建议您阅读我发现的关于此的最佳信息：
[了解转换矩阵](http://www.senocular.com/flash/tutorials/transformmatrix/)

读到这里，我想，你可以真正理解变换矩阵的一切。它来自 Flash 8(AS2)，但它的理论信息也适用于 AS3。

# cuda - 连续 CUDA 内核

> ID：11254527
> 
> 赞同：1
> 
> 时间：2012-06-29T00:02:33.050
> 
> 标签：cuda, gpu

我正在编写一个 CUDA 内核，它从设备内存中获取输入，并使用共享内存中的数据（在内核启动时从设备内存中填充）来产生输出。输出被放置在主机读取的设备中。

我希望这个内核能够连续运行，这样我就不必反复将设备内存中的数据加载到共享内存中。我想到的解决方案是，一旦内核启动，它就会不断检查设备内存的输入。如果输入为 0，则表示没有输入。如果输入为 1，则意味着内核应该停止。对于所有其他输入，内核应该执行计算并返回输出。

我的问题是我从来没有见过一个连续运行并轮询设备内存以获取输入的内核。一个明显的担忧是，如果 GPU 连续运行，这种方法可能会消耗过多的电量。请提供有关此方法的评论/建议。

# wordpress - 如何将名称属性添加到 wordpress 菜单项

> ID：11254528
> 
> 赞同：-1
> 
> 时间：2012-06-29T00:02:42.833
> 
> 标签：wordpress

[http://goo.gl/yB6ST](http://goo.gl/yB6ST)

在此页面上，我列出了左侧的所有画廊。我想在每个链接中添加“名称”属性，因此如果您单击菜单中的任何项目，我可以强制它位于新页面的顶部。例如，假设您在下一页打开时单击了“芝加哥历史博物馆”，“芝加哥历史博物馆”应该在顶部，这就是我想要完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:08:31.937

它可以使用 WordPress 菜单。首先，我相信您添加了 WordPress 菜单（不仅仅是 html 菜单。）

执行以下步骤。

1.  登录到管理仪表板。
2.  从左侧转到外观 -> 菜单。
3.  打开菜单并在导航标签旁边添加“标题属性”。 ![WordPress 菜单](../Images/cf17630ae85622bfac74d1ae6b0a52e0.png)
4.  保存您的菜单。就这样。

希望这会帮助你。干杯！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-24T17:27:15.510

你需要使用`walker_nav_menu_start_el`钩子。尝试这样的事情：

```
function my_add_name_attr($link)
{
   // you can get the url and link text. 
   preg_match("/.*?href=\"?'?(.*?)\"?'?>(.*?)</",$link,$m);
   $url=$m[1]; 
   $link_text=$m[2];

   //can be created from the url and link text;
   $name_attribute="my_name_attribute";

    return strstr($link,"href",true)." name=$name_attribute ".strstr($link,"href");
}
add_filter("walker_nav_menu_start_el","my_add_name_attr"); 
```

看看这是否有帮助：

*   [wp nav menu：为菜单项添加属性](https://wordpress.stackexchange.com/q/103345)

*   [在没有插件的情况下向菜单项添加自定义属性](https://wordpress.stackexchange.com/q/100726)

[WordPress Answers](http://wordpress.stackexchange.com)是询问 WordPress 相关问题的更好地方，您将获得更快更好的回复。

# embed - Google Docs 集成为网站文档管理系统

> ID：11254530
> 
> 赞同：2
> 
> 时间：2012-06-29T00:02:59.930
> 
> 标签：embed, google-docs, google-drive-api, document-management

这是我在 stackoverlfow 上的第一个问题，但多年来我一直很感激并在这里找到了很多答案......感谢所有提供答案的人！当我找到一个我可以回答的问题时，我会付钱。如果我的问题笼统或含糊，我深表歉意。

基本上，我正在寻找某种方式将 Google Docs 用作文档存储和管理解决方案，用于不使用 CMS 且不需要 Google 帐户访问的公共网站。这可用于新闻稿、产品手册、支持文档等……；企业可能希望在其网站上提供的任何文件或文件列表。主要思想是为网站所有者提供一个创建和管理文档的地方，而不需要 FTP 将它们添加到站点。

这就是我设想的方式：

1.  网站所有者拥有 Google Drive/Gmail 帐户并为其网站文档创建一个集合。通常这些是 PDF，但有些可能是 Word Docs 或 Excel 文件。

2.  所有者将他们想要在其网站上显示的 PDF 文件放入特定的集合中。所有文件都是共享和公开的，不需要 Google 帐户即可访问，因为某些访问者可能没有 Google 帐户。

3.  我对网页进行编程和配置，最好使用 PHP 或 Javascript，以查询和检索集合，列出集合中的所有文件，并在网站上显示它们并带有打开文件的链接。子文件夹/集合也很有用。类似于文件树的东西。

4.  当所有者更改 Google Docs 集合中的文件时，它会在网站上显示的集合文件列表中自动更新。

我查看了 Google Docs API、Drive SDK 以及与 Google Docs 集成的搜索，但我找不到简单的答案或示例代码。Google API/SDK 似乎需要注册应用程序和/或让用户使用他们可能没有的 Google 帐户进行身份验证。对于我想要实现的目标，它似乎也过于复杂。也许我误读了这些要求......我不清楚是否可以做我想做的事，或者如果可以，为一个简单的网站开发可能会很复杂或成本很高。

我使用 iframe 嵌入式 Gdocs 开发了与上述类似的东西，但您显然无法嵌入的一件事是 GDoc 文件或集合的列表。为了克服这个限制，我创建了一个 TOC（目录）文档，其中列出并包含指向在 Google 文档中共享的文件的链接。然后，我将此文档嵌入到网页 iframe 中，并在同一框架中打开其他 Gdocs 的链接。它还包括返回 TOC 的简单导航选项。这可行，但对网站所有者来说是一件痛苦的事，因为他们必须获取共享/公共文档的嵌入代码，删除 iframe 标签/html，调整字符编码，然后将共享文档的链接传递到嵌入式 TOC博士。

能够共享和嵌入集合会容易得多。我认为这很容易通过 Google 站点实现，但对于外部站点可能不行。我还相信，当文件在 GDocs 中更新时，单独嵌入的 PDF 文件会中断，因为 PDF 的嵌入链接会发生变化。

我还设置了使用谷歌日历作为后端的定制嵌入式日历，看起来效果很好。

有没有一种简单的方法可以为此目的使用 Google Docs？有谁知道一个可供参考的例子？关于如何轻松列出和链接到集合中的文件的任何想法？我应该考虑提供此功能的其他服务吗？

任何帮助和建议表示赞赏！

干杯!

D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T12:36:05.853

对我来说似乎可行。

您可以使用[http://shadowfax.org.uk/wiki/Google_Docs_Listing_in_Google_Sites](http://shadowfax.org.uk/wiki/Google_Docs_Listing_in_Google_Sites)上的脚本在 google 站点页面中显示给定 google docs 集合的文件。该脚本需要改进布局，但通过将参数“&col=CollectionPath”传递给其服务 url 可以正常工作。

由您来配置文档和/或集合的共享权限，以确保您的（未连接的）访问者将被授予访问 google 文档集合材料的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T10:32:43.263

[https://developers.google.com/apps-script/articles/embedding_docslist_in_sites](https://developers.google.com/apps-script/articles/embedding_docslist_in_sites)中描述了另一个（看似）更高级的解决方案

即 1) 在文件柜中嵌入一个 Google Docs 文件夹和 2) 使用列表页显示文件夹，并带有脚本“刷新”。

积极的一面是：与您的布局更好的视觉整合。不利的一面是：实施可能更耗时。

# c# - 从 PeekCompleted 方法中的 messageQueue 出列

> ID：11254531
> 
> 赞同：3
> 
> 时间：2012-06-29T00:03:09.467
> 
> 标签：c#, message-queue, deque

我正在使用 PeekCompleted 从 MessageQueue 读取消息，我在这里执行我的过程，如果一切顺利，我需要将其从队列中删除！目前我正在使用 MyMessageQueue.Receive() 并且它可以工作，但这是确保每条消息都得到正确处理的可靠方法吗？

```
 MessageQueue MyMessageQueue;
    public Form1()
    {
        InitializeComponent();

        MyMessageQueue = new MessageQueue(@".\private$\Dms");
        MyMessageQueue.PeekCompleted += new PeekCompletedEventHandler(MessageQueue_PeekCompleted);
        MyMessageQueue.Formatter = new XmlMessageFormatter(new Type[] { typeof(string) });
        MyMessageQueue.BeginPeek();
    }

    void MessageQueue_PeekCompleted(object sender, PeekCompletedEventArgs e)
    {
        try
        {
            Debug.WriteLine("ToProcess:" + e.Message.Body);
            //Long process that maybe fail
            MyMessageQueue.Receive();
        }
        finally
        {
            MyMessageQueue.BeginPeek();
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T01:22:09.863

Receive() 接收队列中的第一条消息，将其从队列中删除。你需要的是[MessageQueue.ReceiveById 方法](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.receivebyid.aspx)

```
MyMessageQueue.ReceiveById(e.Message.Id); 
```

其次，我认为，你总是需要调用[MessageQueue.EndPeek 方法](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.endpeek.aspx)

```
Message m = MyMessageQueue.EndPeek(e.AsyncResult); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T15:36:08.513

如果您总是只有一个队列的接收者，这将起作用 - 另一个进程可以在 BeginPeek 和 Receive 方法之间窥视并接收该消息。上面的 ReceiveById 建议也是如此。

如果您只想要一个接收者，您可以使用 DenySharedReceive 标志打开队列来强制执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:27:22.020

我总是尝试使用相同的 BeginPeek() 方法，因为这样，即使消息到达延迟并且完成后 peek 返回时，我也可以让其他作业可以处理，您可以选择消息。我认为上面您只是将代码片段作为示例显示，因为您可能需要编写自己的类/方法来完成新消息检查，以及客户端应用程序中的完整 try 和 catch 块。

# jquery - jQuery - 阿贾克斯。表单提交后相同页面并刷新

> ID：11254534
> 
> 赞同：0
> 
> 时间：2012-06-29T00:03:42.343
> 
> 标签：jquery

我有以下代码，它在提交表单时有效（它保持在同一页面上）但我也希望在提交后刷新当前页面。

```
<script>
$('form').live('submit', function(){
  $.post($(this).attr('action'), $(this).serialize(), function(response){
  // Here I need a code to refresh the page. I tried with window.location.reload(); no      success...
  },'json');
  $('form').hide();
  return false;
}); 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:07:53.780

“返回错误；” 在 jQuery 中的工作方式与在纯 jane javascript 中的工作方式不同。使用[preventDefault](http://api.jquery.com/event.preventDefault/)：

```
$('form').live('submit', function(e){
    $('form').hide();
    e.preventDefault();
}); 
```

另外，如果你能提供帮助，我不建议使用“live” ...如果你可以使用 $(document).ready 和 $('form').submit(function(e){... });

----编辑1：

我在您的页面上注意到（在您的评论中注明）您收到错误消息：“XMLHttpRequest cannot load [http://emails.loquierocomprar.com.co/wp-content/plugins/mailpress/mp-includes/action.php](http://emails.loquierocomprar.com.co/wp-content/plugins/mailpress/mp-includes/action.php)。来源Access-Control-Allow-Origin 不允许[http://www.loquierocomprar.com.co 。”](http://www.loquierocomprar.com.co)

$.post 调用失败并且*从不*发送 ajax 发布请求。因此，成功处理程序永远不会被触发，并且最终不会调用 window.location.refresh 方法。

其次，您使用的是数据类型“json”——如果服务没有返回格式正确的 json，那么成功处理程序也不会正确触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:21:46.680

您想要自然的 HTML 表单提交以及隐藏表单。

您不能在提交之前隐藏表单，否则浏览器将无法获取/发布其隐藏字段，因此您必须在提交后将其隐藏。最简单的方法是使用 setTimeout。

```
$(document).on('submit', 'form', function() {
  var $form = $(this);//remember $form in the closure
  setTimeout(function(){ $form.hide(); }, 0);//hide $form *after* submission
  return true;//allow natural html form submission to happen
}); 
```

即使将 setTimeout 延迟设置为零，`$form.hide()`在表单提交发生后（在原始提交线程中）也会从不同的事件线程执行。

# vb6 - Visual Basic 调试环境

> ID：11254543
> 
> 赞同：1
> 
> 时间：2012-06-29T00:04:39.907
> 
> 标签：vb6

我继承了 Visual Basic 中的一个项目，并被分配修复该项目中的错误。用户报告说项目的全新安装存在问题，我能够重现这些错误。还有与在 Windows 7 上以非兼容模式运行此项目相关的问题。我尝试在 Visual Basic 6 中运行此项目，但无法重现其中一些错误。

我想知道是否有任何方法可以将 Visual Basic 6 中的调试环境与安装环境匹配（在使用安装包解压项目后）。

欢迎和赞赏所有答案。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T05:22:27.307

我将为您的问题提供一些猜测答案，最后回答您的具体问题。

*   安装包是否安装了所有必要的依赖项？COM 组件、数据文件、配置设置等。
*   [将应用程序数据存储在程序文件下](https://stackoverflow.com/questions/4273424/where-should-i-store-application-specific-settings)会导致 Windows 7 出现问题吗？

找出问题的一些策略：

1.  阅读代码。可以是最快的方法。
2.  向应用程序添加日志记录，以便您可以研究已安装系统（虚拟机？）上的行为
3.  尝试在未安装 VB6 IDE 的已安装系统上进行调试。[可能](https://stackoverflow.com/questions/1019071/how-to-use-vb6-debugger-on-outlook-property-page-ocx)但不容易 - 首先尝试步骤 1 和 2。

# ruby - 如何设置 watir-chrome 以使用特定的配置文件，以便我可以使用存储的 cookie

> ID：11254545
> 
> 赞同：0
> 
> 时间：2012-06-29T00:04:54.410
> 
> 标签：ruby, watir-webdriver, selenium-chromedriver

这是我的代码，我需要使用存储的 cookie，这样我就可以避免回答随机的安全问题。我究竟做错了什么？提前感谢您的建议。

```
pdate = `/Users/XXXX/lab2/cpb/CBTprevDate.pl`
download_directory = "/Users/XXXX/lab2/cpb"
puts download_directory
profile = Selenium::WebDriver::Chrome::Profile.new
profile['download.prompt_for_download'] = false
profile['download.default_directory'] = download_directory

client = Selenium::WebDriver::Remote::Http::Default.new
client.timeout = 600 # seconds ?~@~S default is 60
b = Watir::Browser.new :chrome, :profile => profile, :http_client => client, :switches => %w[--user-data-dir=/Users/XXXX/lab2/cwm/Default] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T08:38:31.847

尝试使用 watir-webdriver Cookies API

```
b.goto 'http://yourwebsite.com'
b.cookies.clear
b.cookies.add 'SESSION', 'value' 
```

# javascript - 我正在尝试使用 Javascript 显示图像

> ID：11254550
> 
> 赞同：1
> 
> 时间：2012-06-29T00:05:31.733
> 
> 标签：javascript, image, html-table

我正在尝试制作井字游戏。我使用的是图像而不是 Xs 和 Os，因此在单击 td 时需要用图像填充它。我试过这个：

```
function makeDuck(place){
    //this is just so I know the other methods work
    alert("duck");            
    //This is the line I need help with 
    window.location.write('<img src="smallDuck.jpg" width="70" height="70"/>'); 
    squares[place] = 1;
}

function makeBeaver(place){
    //this is just so I know the other methods work
    alert("beaver"); 
    //This is the line I need help with           
    document.zero.write('<img src="smallBeaver.jpg" width="80" height="80"/>');
    squares[place] = 2;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:23:36.333

```
function makeDuck(place){
    // first, we must create a new element in the DOM
    var img = document.createElement("IMG");
    // second, we must assign the right attributes
    img.src = "smallDuck.jpg";
    img.width = "70";
    img.height = "70";

    // finally, we append it to the document
    document.body.appendChild(img);

    squares[place] = 1;
}

function makeBeaver(place){
    // first, we must create a new element in the DOM
    var img = document.createElement("IMG");
    // second, we must assign the right attributes
    img.src = "smallBeaver.jpg";
    img.width = "80";
    img.height = "80";

    // finally, we append it to the document
    document.body.appendChild(img);

    squares[place] = 2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:49:18.683

一种方法是使用 javascript 替换`IMG`. 所以假设你有一个 3 x 3 的网格，每个单元格都包含一个`<img />`标签。他们都需要 unique `id`s。

您将拥有 3 张图片：blank.jpg、X.jpg 和 Y.jpg。所有单元格都以
`<img src='blank.jpg' ... />`

使用 Javascript 定位元素 (getDocumentById(id)) 并将其属性设置为设置为X 或 Y 图像`src`的 URI 。`src`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T02:16:27.397

以下应该让你开始，首先是样式：

```
<style type="text/css">
table.game {
  border: none;
  border-collapse: collapse;
}
table.game td {
  height: 50px;
  width: 50px;
  margin: 0;
  padding: 0;
}
td.topLeft, td.topCenter, td.midLeft, td.midCenter {
  border-right: 1px solid black;
  border-bottom: 1px solid black;
}

td.topRight, td.midRight {
  border-bottom: 1px solid black;
}

td.botLeft, td.botCenter {
  border-right: 1px solid black;
}

td.botRight { }

.naught {
  background-image: url('naught.jpg');
}
.cross {
  background-image: url('cross.png');
}

</style> 
```

然后是游戏的 HTML

```
<table class="game" onclick="handleClick(event);">
  <tr>
    <td class="topLeft">
    <td class="topCenter">
    <td class="topRight">
  <tr>
    <td class="midLeft">
    <td class="midCenter">
    <td class="midRight">
  <tr>
    <td class="botLeft">
    <td class="botCenter">
    <td class="botRight">
</table> 
```

然后是一个交换图像的简单脚本：

```
<script>
var handleClick = (function() {
    var count = 0;

    return function(evt) {
      var el = evt.target || evt.srcElement;
      el.className += ' ' + (count++%2? 'naught' : 'cross');
    }
}());
</script> 
```

请注意，您应该处理对同一个单元格的多次点击（检查该类是否已经具有“naught”或“cross”的值，如果有，请告诉用户单击其他地方）并给出轮到它的提示是。

# java - Java如何使用GridBagLayout创建布局？

> ID：11254552
> 
> 赞同：1
> 
> 时间：2012-06-29T00:05:35.753
> 
> 标签：java, swing, layout, jframe, layout-manager

我正在尝试创建一个布局，其中有一个包含徽标和/或文本字符串的标题，后跟一个 3x3 网格。我正在查看他们网站上的 Java API，但找不到任何关于如何创建带有标题的 3x3 网格的信息。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T00:29:29.357

使用[BorderLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/border.html)和[GridLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/grid.html)，然后在 java 网站上阅读[有关布局管理器的教程。](http://docs.oracle.com/javase/tutorial/uiswing/layout/layoutlist.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T07:13:12.730

我只是写了关于你的问题的示例代码 3x3 按钮 gridlayout 一个标签在 gridlayout 开始

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingConstants;

public class GridBag extends JFrame
{
private JPanel pan;
public GridBag()
{

    GridLayout g=new GridLayout(3,3);
    pan=new JPanel(g);
    pan.add(new JButton("1"));
    pan.add(new JButton("2"));
    pan.add(new JButton("3"));
    pan.add(new JButton("4"));
    pan.add(new JButton("5"));
    pan.add(new JButton("6"));
    pan.add(new JButton("7"));
    pan.add(new JButton("8"));
    pan.add(new JButton("9"));
    JLabel l=new JLabel("grid layout");
    l.setHorizontalAlignment(SwingConstants.CENTER);

    setLayout(new BorderLayout());
    add(l,BorderLayout.NORTH);
    add(pan,BorderLayout.CENTER);
    setSize(1000,500);
    setVisible(true);

}
public static void main(String args[])
{
    new GridBag();
}

} 
```

# python - 双重继承导致元类冲突

> ID：11254553
> 
> 赞同：7
> 
> 时间：2012-06-29T00:05:45.920
> 
> 标签：python, django, database-design

我使用了两个 django 包 - django-mptt（用于实现修改的预序树遍历的实用程序）和 django-hvad（模型翻译）。

我有一个模型类**MenuItem**，我希望它扩展 TranslatableModel 和 MPTTModel，如下所示：

```
class MenuItem(TranslatableModel, MPTTModel): 
```

但它会导致元类冲突：

```
(TypeError: Error when calling the metaclass bases 
metaclass conflict: the metaclass of a derived class 
must be a (non-strict) subclass of the metaclasses of all its bases) 
```

这个问题的解决方案是什么？我希望我可以使用双重继承。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:43:05.283

您可能想要执行以下操作：

```
class CombinedMeta(TranslatableModel.__metaclass__, MPTTModel.__metaclass__):
    pass
class MenuItem(TranslatableModel, MPTTModel):
    __metaclass__=CombinedMeta 
```

这应该给你你想要的，没有任何错误消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T08:20:14.630

很抱歉回答迟了，但我认为它会对有同样问题的人有所帮助。当您子类`MPTTModel`和另一个类时，请确保将`MPTTModel`其放在第一位，如下所示：

```
class MenuItem(MPTTModel, TranslatableModel): 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-11T08:06:25.170

通常@shacki 的答案会起作用。但是，django-hvad 在后台覆盖了许多其他管理器/查询集类，这使得目前无法与 django-mptt/django-polymorphic 和朋友集成。

看看[django-parler](https://github.com/edoburu/django-parler)，它具有与 django-hvad 类似的 API 和管理集成，但也可以与其他包配合使用。表格布局相同，因此您应该能够轻松切换包。

# vb.net - 如何使用 VB.NET 创建时间控件

> ID：11254554
> 
> 赞同：1
> 
> 时间：2012-06-29T00:05:54.830
> 
> 标签：vb.net, timer

我想创建一个时间控件，因为它存在于使用 VB.NET 的 Windows 上的“日期和时间设置”中。

我的意思是这个控制：

![在此处输入图像描述](../Images/b331ecdb42101dc5738d37c29be0b087.png)

但我不想让“πμ”出现。如何删除“πμ”（在我的语言中表示“pm”）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:48:03.187

正如 GSerg 在[评论](https://stackoverflow.com/questions/11254554/how-can-i-create-a-time-control-using-vb-net/11264940#comment14792927_11254554)中所说：

使用[DateTimePicker](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.aspx)控件。将[Format](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.format.aspx)属性设置为“Custom”，将[CustomFormat](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.customformat%28v=vs.71%29.aspx)属性设置为“HH:mm:ss”，将 ShowUpDown 设置为 true。

您不能直接将 TimeSpan 传递给 DateTimePicker，但您可以将其值设置为 `someDateAtMidnight.Add(myTimeSpan)`

# javascript - 使用匹配的正则表达式字符，我怎样才能获得它的大写等效项？

> ID：11254561
> 
> 赞同：2
> 
> 时间：2012-06-29T00:06:15.663
> 
> 标签：javascript

基本前提是我想在另一个字符之后找到一个字符，然后用它的大写等效替换它。我正在寻找比`indexOf`for 循环更优雅的解决方案。我已经做到了这一点：

```
'this-is-my-string'.replace(/\-(\w)/,'$1') 
```

这给了我`thisismystring`，但我想要`thisIsMyString`。我能做些什么来改变`$1`它的大写等效项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:11:36.763

您可以使用给替换函数作为第二个参数，并且将使用它返回的任何内容：

```
'this-is-my-string'.replace(/\-(\w)/g, function(_, letter){
    return letter.toUpperCase();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T00:12:32.797

我建议使用[James Robert 的 toCamel 字符串方法](http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/)。

```
String.prototype.toCamel = function(){
    return this.replace(/(\-[a-z])/g, function($1){return $1.toUpperCase().replace('-','');});
}; 
```

然后这样称呼它：

```
'this-is-my-string'.replace(/\-(\w)/,'$1').toCamel(); 
```

# ruby - MongoDB - 问题删除文档

> ID：11254565
> 
> 赞同：0
> 
> 时间：2012-06-29T00:07:00.873
> 
> 标签：ruby, mongodb

抱歉 - 我是 Mongo 的新手....

我将它用作 Web 应用程序中日志的存储。我想定期运行 rake 任务以删除我的脚本自动站点检查。

我可以使用感兴趣的参数成功提取文档：

```
coll.find("params.from" => "sitecheck").to_a.count
   => 5 
```

但是，它们不会掉落！

```
coll.remove("params.from" => "sitecheck")
   => true 
coll.find("params.from" => "sitecheck").to_a.count
   => 5 
```

我确定我在做一些非常愚蠢的事情....尽管会得到帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T04:15:43.590

想通了....我正在使用一个有上限的集合。无法从中删除...

# perl - 数组返回不起作用

> ID：11254568
> 
> 赞同：-8
> 
> 时间：2012-06-29T00:07:29.743
> 
> 标签：perl

```
use Text::Diff;
my $count;
our $stats2 = 0;
for($count = 0; $count <= 1000; $count++){
    my $data_dir="archive/oswiostat/oracleapps.*dat";
    my $data_file= `ls -t $data_dir | head -1`;
    chomp($data_file);
    while(defined($data_file)){
        print $data_file;
        open (DAT,$data_file) || die("Could not open file! $!");
        my @stats1 = stat $data_file;
        @raw_data=<DAT>;
        close(DAT);
        print "Stats1 is :$stats1[9]\n";
        sleep(5);
        print "Checking $stats1[9] equals $stats2\n";
        chomp $stats[9];
        chomp $stats2;
        if($stats1[9] != $stats2){
            print "I am here";
            my @diff = diff \@raw_data, \@raw_data2, { STYLE => "Context" };
            @trim_diff = removedash(@diff);
            print "@trim_diff";
        }
        @raw_data2=@raw_data;
        $stats2 = $stats1[9];
        print "Stat2: $stats2\n";
    }
}

sub removedash {
    print "Its in sub";
    my $cnt=0;
    foreach (@_) {
        chomp;
        if (/^- /){
            s#^- ##g;
            $ar[$cnt] = "$_\n";
            $cnt++;
        }
    }
    return (@ar);
} 
```

我正在使用 sub 从数组中删除破折号并将其发回。@trim_diff 应该有返回 @ar，但它什么也没显示。我不确定我在哪里做错了。你们能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:39:44.500

我怀疑它不起作用。它可能返回一个空列表。

你的功能

`removedash`

会更贴切地命名

`remove_elements_without_dashes_and_remove_dashes_from_those_ones`.

# android - Android Tools r20 不会使用 ant 构建带有库项目的项目，说我在库中缺少 project.properties 但我没有

> ID：11254569
> 
> 赞同：3
> 
> 时间：2012-06-29T00:07:30.733
> 
> 标签：android, ant, android-build

几个月来我一直在使用 ant 构建我的项目，直到昨天刚刚发布的 r20 之前没有任何问题。我基本上只是使用默认构建文件提供的钩子来做一些小改动。我的项目正在使用 2 个库项目，并且在 eclipse 中构建工作正常。但是我使用 ant 进行官方签名构建（我的目标是创建构建，我的应用程序将连接到生产、登台或 qa 环境）。这是我收到的错误消息：

> 构建失败/Users/mwolfe/workspace/android-flex/app/build.xml:99：执行此行时发生以下错误：/Users/mwolfe/lib/android-sdk/tools/ant/build.xml:476 : ../shared/SomeSdk/sdk 解析为项目/Users/mwolfe/workspace/android-flex/shared/SomeSdk/sdk 没有project.properties 文件的路径

但是我确信这个文件夹中有一个 project.properties 文件，并且之前工作正常。查看 android 的 build.xml 中的第 476 行，它有：

```
 <!-- clean target -->
<target name="clean" depends="-setup, -pre-clean"
        description="Removes output files created by other targets.">
    <delete dir="${out.absolute.dir}" verbose="${verbose}" />
    <delete dir="${gen.absolute.dir}" verbose="${verbose}" />

    <!-- if we know about a tested project or libraries, we clean them too. -->
    <if condition="${project.is.test}">
        <then>
            <property name="tested.project.absolute.dir" location="${tested.project.dir}" />
            <subant failonerror="true">
                <fileset dir="${tested.project.absolute.dir}" includes="build.xml" />
                <target name="clean" />
            </subant>
        </then>
    </if>

    <!-- get all the libraries -->
    <if>
        <condition><not><isset property="dont.do.deps" /></not></condition>
        <then>
 <!-- LINE 476 HERE: -->    <getlibpath libraryFolderPathOut="project.library.folder.path" />
            <if>
                <condition>
                    <isreference refid="project.library.folder.path" />
                </condition>
                <then>
                    <!-- clean the libraries with nodeps since we already
                         know about all the libraries even the indirect one -->
                    <subant
                            buildpathref="project.library.folder.path"
                            antfile="build.xml"
                            failonerror="true">
                        <target name="nodeps" />
                        <target name="clean" />
                    </subant>
                </then>
            </if>
        </then>
    </if>
</target> 
```

任何想法是什么导致了这个以及如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:41:12.020

好吧，所以我想出了如何解决它。发生的事情是，无论出于何种原因，当我最初编写自己的 ant 脚本时，我有自己的干净目标，我将其称为所有子项目的干净目标，如下所示：

```
<target name="clean" depends="androidbuild.clean">

    <exec executable="sh" failonerror="true">
        <arg value="${ndk.dir}/ndk-build" />
        <arg value="clean" />
    </exec>
             <!-- remove the next 2 lines to fix the problem -->
    <ant target="clean" dir="${android.library.reference.1}" />
    <ant target="clean" dir="${android.library.reference.2}" />
</target> 
```

不过，由于某种原因，这不再起作用，而且似乎新的 ant 构建脚本 android r20 为我提供了处理这个问题，因此删除上面的 2 个干净调用解决了问题。

请注意，androidbuild.clean 依赖调用父 build.xml 的 clean 目标，该目标在 $ANDROID_SDK/tools/ant/build.xml 中定义。当您导入该脚本时，请执行以下操作：

```
<import file="${sdk.dir}/tools/ant/build.xml" as="androidbuild" /> 
```

这样您就可以在该构建文件中引用目标（ps，这也修复了 eclipse 认为您的 build.xml 文件有错误，这样您就不需要像其他在线人那样将 android build.xml 复制并粘贴到您自己的文件中建议）。

# ruby-on-rails - 在 Rails 中更新包括急切加载的关联

> ID：11254570
> 
> 赞同：0
> 
> 时间：2012-06-29T00:07:35.713
> 
> 标签：ruby-on-rails, xml, associations

我正在查询我的 Rails 应用程序以获取一些具有急切加载关联的查找的 XML 编码返回。有没有一种简单的方法来批量更新所有内容？一个更可取的解决方案是发回具有相同结构的修改后的 XML 并使用它调用 update()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:25:41.640

这[已经实施](http://archives.ryandaigle.com/articles/2008/7/19/what-s-new-in-edge-rails-nested-models)了！

根据官方[发布说明](http://guides.rubyonrails.org/2_3_release_notes.html#nested-attributes)，Rails 2.3 中应该可以使用不同的语法。

这是官方[文档](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)。

# c# - 任务在不应该被取消时被取消

> ID：11254572
> 
> 赞同：0
> 
> 时间：2012-06-29T00:07:47.170
> 
> 标签：c#, .net, exception-handling, task-parallel-library

我正在使用 c# TaskScheduler 来启动一些任务，它以某种方式抛出了 TaskCanceledException。我一步一步完成了任务调用的函数，它完成得很好，根本没有抛出异常。我正在使用 IEnumerable 和 yield 来处理主任务功能中的部分内容，不确定这是否会导致任务出现问题，我认为不会。我现在很迷茫，我没有看到我的代码有任何问题，而且我在任务线程中看不到任何失败。

我将代码简化为以下内容，但这是结构。

```
Action[] Jobs = new Action[] { Job1(), Job2(), etc };
Task[] Tasks = new Task[Jobs.Length];

try
{
    int I = 0;

    foreach (Action Act in Jobs)
    {
        Tasks[I] = Task.Factory.StartNew(() => Act());
        I++;
    }
    Task.WaitAll(Tasks, 300000);
}
catch (AggregateException AgEx) { throw AgEx.Flatten(); } 
```

我也试过了，效果很好

```
Thread NewJob = new Thread(() => DoJob());
NewJob.IsBackground = true;
NewJob.Start();
NewJob.Join(300000); 
```

# c++ - 如何让一个函数只运行一分钟

> ID：11254581
> 
> 赞同：-1
> 
> 时间：2012-06-29T00:10:16.073
> 
> 标签：c++, time

你如何让函数 foo() 只运行一段时间？我认为线程是最常见的实现方式。

如何使用 bind 和 timed_join ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:13:46.407

代码不会与其他代码发生冲突。代码合作完成工作。如果您只想`foo`运行一分钟，请将其编码为仅运行一分钟。不要以其他方式对其进行编码，然后尝试强制它以不同于其编码方式的方式工作。

如果您想使用线程，您可以编写代码`foo`来检查同步的“中止”标志。如果`foo`注意到标志被设置，它会中止。然后，一分钟后，从另一个线程设置该标志。然后`foo`会注意到标志已设置并自行中止。

如果您需要中止诸如阻塞 I/O 操作之类的事情，则解决方案是特定于平台的。或者，您可以使用提供此类功能的可移植库，例如[Boost](http://www.boost.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:15:58.103

我不确定你在问什么。如果你只需要一个函数来做一分钟的事情，你能把它包装在一个while循环中吗？

```
void foo(void)
{
    time_t end = time(NULL) + 60;
    while (time(NULL) <= end)
    {
        … // do something
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T06:34:22.527

> 你如何让函数 foo() 只运行一段时间？

POSIX `pthread`API 支持取消，但标准不保证立即取消。但下面是一个示例，说明它如何用于`foo`在 1 秒后取消功能，而它通常会运行 5 秒。

```
void foo ()
{
    sleep(5);
}

void * start_foo (void *)
{
    int x;
    pthread_setcancelstate(PTHREAD_CANCEL_ENABLE, &x);
    foo();
    return 0;
}

    pthread_t t;
    pthread_create(&t, 0, start_foo, 0);
    sleep(1);
    pthread_cancel(t);
    pthread_join(t, 0); 
```

该`start_foo`函数启用取消状态。该`x`参数接收旧的取消状态。

> 如何使用 bind 和 timed_join ？

我相信你指的是`boost::bind`和`boost::thread::timed_join`。`boost::bind`提供了一种机制来定义一个不接受任何参数的仿函数，但调用一个传递参数的函数。`boost::thread`需要一个不带参数的函子，所以这就是它在那里使用的原因。

```
boost::thread t(boost::bind(puts, "hello, world")); 
```

`boost::thread::timed_join``boost::thread`如果线程在传递给它的时间参数内未完成，则可能返回 false 的连接。

```
boost::thread t(foo);
t.timed_join(boost::posix_time::seconds(1)); 
```

# c# - Maya、Blend 或 XNA 中的水动画

> ID：11254586
> 
> 赞同：1
> 
> 时间：2012-06-29T00:11:15.160
> 
> 标签：c#, wpf, xna, blender, maya

我需要制作一个喷泉动画。但我不是设计师，我是开发人员。起初我否认了这样的任务。但是很有趣，我很想开放和扩展我的技能。请避免回答“你应该说不”。

所以我开始研究来完成这个任务。

主要目标是渲染一个喷泉，我可以在上面改变水的颜色和溪流的高度。. 我的第一个想法是WPF。所以我找到了一些例子，其中一些使用了着色器。还有一个有趣的，[简单的水动画](http://stuff.seans.com/2008/08/21/simple-water-animation-in-wpf/)。我喜欢这个，因为它运行流畅。但它没有达到我需要的质量。于是，研究继续进行。

然后，通过 youtube 搜索，（是的，google 是 google，但 youtube 也可以使用；））我找到了 3 个很好的资源。玛雅、搅拌机和 XNA。

Maya 和 Blender：这对我来说是一个全新的世界。我知道我可以学习这些套件。但我担心的是我目前需要的功能。实际上，我的公司拥有 Maya 许可证，这就是它在列表中的原因。

过去，我尝试做类似的事情，将参数从 C# 发送到嵌入在 winform 中的 SWF 电影。结果..失败。在 actionscript 中使用外部接口类，好吧，它可以工作，但不是我想要的，所以我转向 WPF。

对于 Maya 或 Blender，我真的不希望这种情况再次发生。

我需要的功能是将参数发送到动画。这可能与 Maya 或 Blender 一起使用吗？而且，动画会在窗口中运行还是可以嵌入到 WinForm 中？或者，另一种方法，我放置参数的文本文件，动画在启动时加载它。

XNA：这个也很有趣，而且是 NET！在查看了一些示例的代码之后。啊！我不明白！我见过一些渲染水的，很棒。但是我还没有找到带有喷泉或水流的图片示例或视频。因此，可能更容易学习，它也需要时间，但比其他选项要少。

毕竟，我仍然感到困惑并寻找更多信息。选项包括：

1)玛雅

2）搅拌机

3)XNA

以前有没有人做过这样的事情？你会接受我的位置吗？哪条路径是完成我的任务的最佳方式？

我并没有像这个站点中的许多问题那样要求一段带有解决方案的代码。我正在根据经验或知识寻找方向。

我想要这样的东西：-“使用'this'技术，它有一个功能/组件可以用来做'那个'，这是一个示例/文档的链接”。

但并不总是那么容易。所以任何建议都会非常非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T05:51:04.880

好吧，这就是我采取的解决方案。

Maya 和 Blender 是非常好的套件，非常强大。但是，据我所知，一旦渲染动画，就没有任何变化。如果我需要进行更改，我必须再次渲染它。所以 Maya 和 Blender 被丢弃。

然后，XNA。这个框架很神奇。但是很复杂。我已经阅读了很多，但仍然无法创建地形。也许只是需要更多的时间，但时间已经不多了。但是，我仍在阅读有关此框架的替代方案，并且感谢@SuperPrograman，DPSF 是一项很好的资产。

那么，解决方案是什么：Unity3D。

是不错的工具。它有一个粒子发射器，通过[这个视频](http://www.youtube.com/watch?v=F6fdhFoUXNI)，我制作了一个喷泉。此外，您可以使用 Mono 使用 javascript 或 c# 创建脚本。所以现在我正在创建一个脚本来编辑粒子发射器的属性来控制我的喷泉。还有很多文档和支持论坛。

希望这对某人也有帮助。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T02:44:00.433

我用过一点Blender，我认为你不能将参数发送到喷泉动画，*除非*你结合了python代码（blender是用python编码的）。我用搅拌机所做的只是制作动画，将其渲染为电影文件，动画就是这样，除非重新渲染，否则不会改变。所以我认为Blender不会工作。玛雅可能会遇到类似的问题。

我个人认为 XNA（或类似的东西）可能是最好的选择。我发现我认为可能有用的一个 XNA 链接在[这里](http://www.xnaparticles.com/)。基本上，它是某种 API；它在网站上说的第一件事，描述得很好，

> DPSF（动态粒子系统框架）是一个久经考验的免费程序员工具，用于在 XNA 中快速轻松地创建自定义粒子系统。

在 youtube 上可以找到一个用于喷泉的[示例](http://www.youtube.com/watch?v=BWP0zDkt-BM)。是的，那个视频很俗气，但它可能会变得更好。

或者您可以尝试使用[此链接](http://www.codeproject.com/Articles/10003/A-basic-Particles-System)创建一个仅限 C# 的喷泉。

再次，您可以使用您最初想到的带有 3d 的 WPF。哈哈。我想出的只是[一个](http://www.mperfect.net/wpf3dPart/)喷泉。如果我想出更好的东西，我会继续寻找和编辑。我承认，我的链接并不是那么好。

+1 提问！

# java - 如何以方便的方式从我的 Groovy 脚本访问 Java 代码？

> ID：11254589
> 
> 赞同：0
> 
> 时间：2012-06-29T00:11:19.677
> 
> 标签：java, groovy, classpath, integration

我在一个体面的 Java 项目上工作，该项目使用 Perl 脚本编写一些胶水代码。我试图弄清楚如何用 Groovy 脚本替换这些脚本，以便我们可以方便地编写脚本，但可以更好地访问多年来构建的所有 Java 代码。这是我们的项目结构的示例。

```
.
|____core
| |____classes
| | |____com
| |   |____project
| |     |____core
| |       |____CoreClass.class
| |____src
|   |____com
|     |____project
|       |____core
|         |____CoreClass.java
|____scripts
| |____someScript.groovy
|____util
  |____classes
  | |____com
  |   |____project
  |     |____util
  |       |____UtilClass.class
  |____src
    |____com
      |____project
        |____util
          |____UtilClass.java 
```

（注意：`util`并且`core`只是项目中大约十几个类似文件夹中的两个）

我想从命令行运行`someScript.groovy`，它需要能够实例化`UtilClass`和`CoreClass`. 我已经阅读了各种使用 Groovy 脚本设置类路径的方法，但我发现没有一种方法是合适的。

这里的重点是找到一种使用 Groovy 的方法，它比我们当前使用 Perl 的系统更容易使用。为了做到这一点，我认为我需要满足三个标准。

*   不污染系统或环境

我想让项目尽可能地独立。开发人员应该能够从源代码控制中检查项目，运行`someScript.groovy`并让它知道在哪里可以找到项目中的其他类。我不想要求开发人员将 CLASSPATH 环境变量设置为指向所有项目类目录。

*   没有长命令行参数

脚本应该很容易从命令行运行。如果`-cp`需要该标志，则开发人员必须键入小说才能指定我们项目中的所有各种类目录。

*   没有样板`someScript.groovy`

我见过一些解决方案，包括获取类加载器的实例并指定`.java`文件的路径`.class`。这将使脚本编写起来过于困难和乏味。

这些标准不是绝对的。如果我不得不对其中一个稍作让步，该解决方案可能仍然有效。我们在这里使用 Eclipse，因此涉及通过 Eclipse 进行某种类型的项目配置的解决方案可能是合适的。如果需要样板代码，也许有一个 Groovy 源文件，该文件由 Eclipse 自动编译为包含必要样板代码的版本。

通过`groovy someScript.groovy`或调用脚本`someScript.groovy`可能是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T04:27:23.187

这是另一种选择：

1.  下载最新的 groovy 版本
2.  将`bin/, conf/ and lib/`目录从 groovy 复制到项目根目录
3.  编辑`conf/groovy-starter.conf`

添加以下条目

```
load !{groovy.home}/core/classes
load !{groovy.home}/util/classes
....and all your other directories 
```

要运行`someScript.groovy`，您将从项目根目录运行以下命令：

```
bin/groovy scripts/someScript.groovy 
```

这是完全独立的，开发人员不需要安装 groovy。所需的一切都已`JAVA_HOME`设置。每当您想升级 groovy 时，只需下载最新版本并替换`bin/`和`lib/`目录即可。

如果`lib/`您的项目中已经是一个目录，您可以将 groovy 库重命名为`groovy-lib/`并调整其中的条目`conf/groovy-starter.conf`（您可能还需要调整`bin/startGroovy`脚本中的一两行）。

`bin/groovy scripts/someScript.grooy`如果你想进一步简化事情，你总是可以在你的项目根目录中创建一个包装脚本来调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T04:37:27.470

您可以使用以下方法将内容动态添加到 Groovy 脚本的根类加载器：

```
this.class.classLoader.rootLoader.addURL(new URL('file:///path/to/jar')) 
```

所以剩下的就是让脚本确定脚本本身的位置：

```
scriptDir = new File(getClass().protectionDomain.codeSource.location.path).parent 
```

然后找到那棵树上的所有罐子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:59:52.793

一种选择是编写一个接受要运行的 Groovy 脚本名称的 shell 脚本。然后，shell 脚本调用该`groovy`命令，传递 Groovy 脚本和正确的（相对）类路径。

由于 Groovy Eclipse 插件可以运行 Groovy 脚本，另一个选项可能是修改运行配置并在那里设置正确的类路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T02:00:14.163

为什么不在“lib/”目录中包含 groovy-all.jar 和其他依赖项。然后编写将类路径设置为“lib/*”的包装器 .bat 和 .sh 脚本。有一个主类“groovy.lang.GroovyShell”，您可以将脚本作为参数传递给它运行。

## 一些脚本.sh

```
#!/bin/bash
java -cp 'lib/*' groovy.lang.GroovyShell somescript.groovy 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-02T21:26:24.057

有时我使用派生加载器，当我只能接受来自正常/禁止包的类时（即没有来自 io 包等的文件）

```
package script;

import org.codehaus.groovy.control.CompilationFailedException;

import groovy.lang.GroovyClassLoader;

public class MyGroovyClassLoader extends GroovyClassLoader {

@Override
public Class loadClass(String name, boolean lookupScriptFiles, boolean preferClassOverScript) throws ClassNotFoundException,
        CompilationFailedException {
    if( ... ! requiredPackaIsOk ... ) 
        throw Exception("class cannot be loaded"); 
    return super.loadClass(name, lookupScriptFiles, preferClassOverScript);
}

@Override
public Class loadClass(String name, boolean lookupScriptFiles, boolean preferClassOverScript, boolean resolve)
        throws ClassNotFoundException, CompilationFailedException {
    if( ... ! requiredPackaIsOk ... ) 
        throw Exception("class cannot be loaded"); 
        return super.loadClass(name, lookupScriptFiles, preferClassOverScript, resolve);
}

@Override
protected Class loadClass(String name, boolean resolve) throws ClassNotFoundException {
    if( ... ! requiredPackaIsOk ... ) 
        throw Exception("class cannot be loaded"); 
        return super.loadClass(name, resolve);
} 
```

}

# php - 在 Ajax 请求之间是否丢失了 PHP 对象？

> ID：11254598
> 
> 赞同：0
> 
> 时间：2012-06-29T00:12:35.150
> 
> 标签：php, ajax

在过去的几个月里，我一直将 Ajax 用于纯粹的 UX 目的，即允许用户提交表单、访问内容等，而无需重新加载或离开页面。但是，在阅读了一篇关于使用[Node.js](http://radar.oreilly.com/2011/07/what-is-node.html)的好处的文章之后，我开始更多地思考我的应用程序是否可以从向服务器提交微请求而不是例如一次从巨大的表单中提交数据中受益.

现在，我的应用程序的工作方式是我的 DomainObjects 直接映射到我的数据库表和视图层中的表单。所以，例如，

```
class Demographics extends DomainObject {

    protected $first;
    protected $last;
    protected $middle;
    protected $ssn;

    // getter, setter methods

} 
```

将有一个表单，其中包含所有可设置属性的输入，供用户更新。因此，到目前为止，我们有一个 Demographics 对象，它在我的数据库中保存了一个人的信息。**好吧，目前，当用户更新此人的信息时，会使用页面中的数据重新创建**Demographics 对象（我将 customerID 隐藏在 HTML 中并使用它重新实例化该对象），但现在我想知道如果这是 1\. 必要的和 2\. 好的做法。

所以，我的主要问题是：如果我决定通过 Ajax 提交微请求，我是否真的需要重新实例化对象，或者是否有某种“线程”让我的 PHP 在请求之间保持活动状态？（即，以前实例化的对象是否可访问？）。

此外，这种重新创建 DomainObject 并在 HTML 常见做法中隐藏行 ID 的做法，还是应该避免这种做法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:17:41.977

每个请求周期都是它自己的线程，这是它应该的。您不希望多个不同的用户共享相同的数据。这看起来是应该存储在数据库中并在每次请求时检索的数据的完美示例。但是，否则您的微 Ajax 请求方法听起来是个好主意；每个请求都可以与数据库中的不同表以及可能完全不同的 URL 进行通信，并且每次都会在数据库中存储和重新创建进度。

至于您的第二个问题，我需要查看一些代码才能知道您要完成的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:26:36.037

数据必须以某种方式手动保存。*不应*依赖处理后续请求的*同一线程/进程，除非特定框架是围绕此类保证**专门*设计的，并且可以确保它们不被违反。

 **究竟如何持久化/恢复数据……取决于你和你的要求；-)

1.  **查看状态；**通过回发数据维护状态。这本身并没有什么问题（它是 ASP.NET 中 ViewState 的基础），但是维护的状态越大，必须来回传输的数据就越多（几 KB 不算什么，几 MB 是……未调用为了）。*如果使用，请考虑防篡改解决方案。*当*页面*驱动数据处理时效果很好。
2.  **数据库;** 例如 MySQL。持久化数据的好方法。然而，并非所有数据都需要这种持久性。它通常易于设置和维护。
3.  **缓存；**例如。内存缓存。不是 RDMB。但是一种存储数据的好方法“它会很高兴”。通常位于数据库支持的数据“前面”。
4.  **饼干;** 通常与上述一种或多种结合使用以“关联”不同的连接。有时，存储/传递额外的瞬态数据是一种可行的方法。
5.  **会话状态；**通常使用#2 或#3（并利用#4）。与 View State 的区别在于它“仅在服务器上”。
6.  **序列化；**可用于脱水/再水化对象而无需手动构建。使用上述方法之一，让生活更简单。

快乐编码。**

# macos - Mac CoreLocation Services 不请求权限

> ID：11254602
> 
> 赞同：8
> 
> 时间：2012-06-29T00:13:35.130
> 
> 标签：macos, cocoa, core-location

我正在编写一个需要使用 CoreLocation 服务的 Mac 应用程序。只要我在安全首选项窗格中手动验证服务，代码和位置就可以正常工作。但是，该框架不会自动弹出权限对话框。该文档指出：

> 重要 用户可以选择拒绝应用程序访问定位服务数据。在应用程序的初始使用期间，Core Location 框架会提示用户确认使用位置服务是可以接受的。如果用户拒绝该请求，则 CLLocationManager 对象在以后的请求中向其委托报告一个适当的错误。

我的委托确实收到了一个错误，并且 +locationServicesEnabled 的值在 CLLocationManager 上是正确的。唯一缺少的部分是向用户提示有关权限的提示。这发生在我的开发 MPB 和一个朋友的 MBP 上。我们俩都搞不清出了什么问题。

有没有人遇到过这个？

相关代码：

```
_locationManager = [CLLocationManager new];    
[_locationManager setDelegate:self];
[_locationManager setDesiredAccuracy:kCLLocationAccuracyKilometer];
...
[_locationManager startUpdatingLocation]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-26T10:38:27.167

我发现在 Mac 上，当您通过调用启动定位服务时

```
[locationManager startUpdatingLocation]; 
```

它触发

```
- (void)locationManager:(CLLocationManager *)manager didChangeAuthorizationStatus:(CLAuthorizationStatus)status 
```

状态为

```
kCLAuthorizationStatusNotDetermined 
```

如果您注意此状态，然后再次开始更新位置，则会触发权限对话框：例如

```
- (void)locationManager:(CLLocationManager *)manager didChangeAuthorizationStatus:(CLAuthorizationStatus)status
{
    switch (status) {
        case kCLAuthorizationStatusAuthorized:
            NSLog(@"Location Services are now Authorised");
            [_locationManager startUpdatingLocation];

            break;

        case kCLAuthorizationStatusDenied:
            NSLog(@"Location Services are now Denied");
            break;

        case kCLAuthorizationStatusNotDetermined:
            NSLog(@"Location Services are now Not Determined");

            //  We need to triger the OS to ask the user for permission.
            [_locationManager startUpdatingLocation];
            [_locationManager stopUpdatingLocation];

            break;

        case kCLAuthorizationStatusRestricted:
            NSLog(@"Location Services are now Restricted");
            break;

        default:
            break;
    }
} 
```

# c# - 设置器中的图像集成

> ID：11254603
> 
> 赞同：2
> 
> 时间：2012-06-29T00:13:41.957
> 
> 标签：c#, wpf, xaml

我使用路径来创建自定义对象：

```
 <Path Style="{StaticResource ABC_Style}" ToolTip="object ABC"  HorizontalAlignment="Center"  VerticalAlignment="Center"></Path> 
```

ABC_Style 定义为：

```
<Style x:Key="ABC_Style" TargetType="Path">
    <Setter ..../>
    <Setter Property="Fill" Value .../>
</Style> 
```

现在，我必须将网格图像分配给对象（作为内容）。

问题：

1.  有没有办法将图像集成到其中？
2.  如果是这样，是否可以避免图片被拉伸？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:17:30.997

我能想到的是，你可以创建一个像这样的绘图画笔

```
 <ImageBrush ImageSource="image.jpg" x:Key="imageBrush" />
    <DrawingBrush x:Key="ThatchBackground" Viewport="0,0,50,50" ViewportUnits="Absolute" Stretch="None" TileMode="Tile">
        <DrawingBrush.Drawing>
            <GeometryDrawing Brush="{StaticResource imageBrush}">
                    <GeometryDrawing.Geometry>
                        <GeometryGroup>
                            <RectangleGeometry Rect="0,0,50,50"/>
                        </GeometryGroup>
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
        </DrawingBrush.Drawing>
    </DrawingBrush> 
```

并设置路径填充，如下所示

```
<Path Fill="{StaticResource ThatchBackground}"> 
```

我从本教程[http://wpfplayground.blogspot.com/2011/09/texture-background-in-wpf.html得到这个](http://wpfplayground.blogspot.com/2011/09/texture-background-in-wpf.html)

# c# - 试图获取一个代表类继承的字符串

> ID：11254609
> 
> 赞同：1
> 
> 时间：2012-06-29T00:14:07.160
> 
> 标签：c#

```
class Base
{
}
class A: Base
{
}
class B:A
{
} 
```

我希望能够为 B 的实例获取字符串“Base.AB”

当然我可以简单地做

```
class B:A
{
   const string NAME = "Base.A.B";
} 
```

但这有点脆弱，如果我改变一些东西，我必须在很多地方改变它

我从

```
class Base
{
protected string Name {get{return typeof(Base).Name;}};
} 
```

每个类层次结构级别的 dea 调用其 base.Name 方法。但是我现在不得不再次命名 Base 两次（诚然，如果我忘记了它会在编译时失败），但它仍然看起来很脆弱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:28:48.280

这种方法：

```
public static string GetHierarchy(Type t)
{
    if (t == null)
    {
        return "";
    }

    string rec = GetHierarchy(t.BaseType);

    return rec + "." + t.Name.ToString();
} 
```

当这样调用时：

```
string str = GetHierarchy(typeof(B)); 
```

将产生以下结果：

```
".Object.Base.A.B" 
```

*编辑以防止 NullReferenceException*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:22:04.387

这个怎么样：

```
class Base {
   public virtual string GetName() { return "Base"; }
}

class A : Base {
   public override string GetName() { return base.GetName() + ".A"; }
}

class B : A  {
   public override string GetName() { return base.GetName() + ".B"; }
} 
```

只是一个想法:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T00:29:28.250

您可以考虑使用反射。

你可以注释你的类，比如

```
[Name("Base")]
public class Base { }

[Name("A:Base")]
public class A : Base { }

[Name("B:A:Base")]
public class B : A { } 
```

然后你可以使用例如：

```
System.Attribute[] attrs = System.Attribute.GetCustomAttributes(typeof(B)); 
```

这给了你 attr[0] == "B:A:Base"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T00:32:14.583

与其他代码相同，但我努力了，所以我会很好地发布它（唯一的区别是我不希望“.object”卡在最后）。

```
 public class Class1 { }
    public class Class2 : Class1 { }
    public class Class3 : Class2 { }

    private void button1_Click(object sender, EventArgs e)
    {
        Class3 c3 = new Class3();
        Console.WriteLine(TypeToString(c3.GetType()));
    }

    private string TypeToString(Type t)
    {
        if (t == null)
            return "";
        if ((t.BaseType == null) || (t.BaseType == typeof(object)))
            return t.Name;
        return TypeToString(t.BaseType) + "." + t.Name;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T00:50:32.630

这是基于@Jaime 的回答，所以我会给他大部分功劳，但我对其进行了修改，这样您就不必在其中添加需要您记住更新它们的自定义属性。

*您需要添加对 System.Reflection 的引用

```
class Base
{
    public virtual string GetName()
    {
        return MethodBase.GetCurrentMethod().DeclaringType.ToString();
    }
}

class A : Base
{
    public override string GetName()
    {
        return base.GetName() + "." + MethodBase.GetCurrentMethod().DeclaringType.ToString();

    }
}

class B : A
{
    public override string GetName()
    {
        return base.GetName() + "." + MethodBase.GetCurrentMethod().DeclaringType.ToString();
    }
}

class C : B
{
    public override string GetName()
    {
        return base.GetName() + "." + MethodBase.GetCurrentMethod().DeclaringType.ToString();
    }
}

C test = new C();
test.GetName(); // Yields "Base.A.B.C" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T00:56:23.497

我编写了以下扩展方法和递归方法。我相信它为这个问题提供了一个很好的解决方案。

看看吧，任何反馈都会很好=）

```
public static class FamilyTreeExtension
    {
        public static string GetFamilyTree(this Type t)
        {
            return GetFamilyTreeRecursive(t, t.Name);
        }

        public static string GetFamilyTreeRecursive(Type t, string leaf)
        {
            Type baseType = t.BaseType;

            string currentTree;

            if (baseType != null)
            {
                currentTree = string.Format("{0}.{1}", baseType.Name, leaf);
                return GetFamilyTreeRecursive(baseType, currentTree);
            }
            else
            {
                return leaf;
            }
        }
    } 
```

用法：

```
...
private void reflectionTryOut()
        {
            string validate = typeof(C).GetFamilyTree();
        }
    }

    public class A
    {}

    public class B : A
    {}

    public class C : B
    {} 
```

结果：**Object.ABC**

# ssl - 使用 IIS7 的 BAT 文件注册 SSL 绑定

> ID：11254612
> 
> 赞同：0
> 
> 时间：2012-06-29T00:14:15.797
> 
> 标签：ssl, iis-7, command-line, batch-file

使用以下几行运行 bat 文件的正确方法是什么？我一个一个地执行它们`cmd.exe`并且工作得很好。我还需要以管理员身份运行它。我只想双击我的 BAT 文件让它运行。

```
appcmd set site /site.name:"assets.test.com" /+bindings.[protocol='https',bindingInformation='*:443:assets.test.com']
appcmd set site /site.name:"api.test.com" /+bindings.[protocol='https',bindingInformation='*:443:api.test.com'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T10:43:14.357

```
@echo on
runas /env /user:<username> <path to appcmd>
appcmd set site /site.name:"assets.test.com" /+bindings.[protocol='https',bindingInformation='*:443:assets.test.com']
appcmd set site /site.name:"api.test.com" /+bindings.[protocol='https',bindingInformation='*:443:api.test.com']
pause 
```

在您插入正确的信息后，这应该可以工作。

# javascript - 找到子 DIV 并设置他们的样式

> ID：11254615
> 
> 赞同：0
> 
> 时间：2012-06-29T00:14:47.367
> 
> 标签：javascript, jquery, jquery-ui, jquery-selectors

```
<div class="pm-dialog">
   <div class="pm-dialog-close">
      <div class="colors-main-content"><span>&times;</span></div>
   </div>
   <div class="pm-dialog-inner colors-main-content" style="margin: 12px 15px 0px 15px;">
      <div>
         <div class="pm-dialog-content">
            <div id="selectLocationProfilePopup">
            </div>
         </div>
         <div class="pm-dialog-footer">
            <div>
               <div class="pm-dialog-footer-background"></div>
               <div class="pm-dialog-buttonpane"></div>
            </div>
         </div>
      </div>
   </div>
</div> 
```

我有一个定义为 pm-dialog-inner 的类，它有一个 display:table-row。
我可以用一行来做到这一点：`$(".pm-dialog-inner > div").css("display", "block")`但这不是我想要的。
我想根据它在选择器中的 ID 设置 div 的样式，（因为我需要覆盖样式内联）上面提到的一个语句如下：

我在 javascript 中使用 Jquery 的代码是以下语句：

```
$('#selectLocationProfilePopup').parent().parent().parent().find(".pm-dialog-inner > div").css("display", "block"); 
```

你能告诉我我做错了什么吗？你能重构上面的代码行吗？
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:18:06.503

尝试：

```
$('#selectLocationProfilePopup').closest(".pm-dialog-inner").find("div:eq(0)").css("display", "block"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:23:18.467

我已经识别了您的 HTML，它非常混乱，请验证它是否正确。

```
<div class="pm-dialog">          
    <div class="pm-dialog-close">        
        <div class="colors-main-content"><span>&times;</span></div>         
    </div>           
    <div class="pm-dialog-inner colors-main-content" style="margin: 12px 15px 0px 15px;">        
        <div>
            <div class="pm-dialog-content">
                <div id="selectLocationProfilePopup">
                    <div></div>
                </div>              
                <div class="pm-dialog-footer">
                    <div>                             
                        <div class="pm-dialog-footer-background"></div>                    
                        <div class="pm-dialog-buttonpane"></div>                     
                    </div>                   
                </div>                
            </div>              
        </div>
    </div>   
</div> 
```

使用这个结构，我使用了下面的代码，它工作正常，请测试并告诉你是否想要这个结果。

```
$("#selectLocationProfilePopup").parents(":eq(1)").css("display", "block"); 

$("#selectLocationProfilePopup").parent().find(".pm-dialog-footer").children("div").css("display", "block"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:44:25.900

你可以这样做

```
<div class="pm-dialog" />
   <div class="pm-dialog-close">
      <div class="colors-main-content"><span>&times;</span></div>
   </div>
<div class="pm-dialog-inner colors-main-content" style="margin: 12px 15px 0px 15px;">
<div class="pm-dialog-inner colors-main-content pre_content">
  ';        
   <div>
     -> I want to set this style div                 
     <div class="pm-dialog-content ">
        <div id="selectLocationProfilePopup"> content text goes here </div>
     </div>
  </div>
     <div class="pm-dialog-footer">
     <div class="pre_content">
        <div class="pm-dialog-footer-background"></div>
        <div class="pm-dialog-buttonpane"> -> I want to set this div style.
        </div>
     </div>
  </div>
  </div>
</div>​​​ 
```

将一个类添加到您以前的 div.. 然后选择除该类中包含“footer”的那些之外的所有 div。

```
 $('div.pre_content div').not('div[class*=footer]').css('background-color','red');​​​​​​​​​​​​​​​​​​ 
```

然后，一旦您正确过滤了它们，请将您的 css 设置为任何值。

[http://jsfiddle.net/aZpGU/](http://jsfiddle.net/aZpGU/)

# javascript - 如何确保所有异步调用都返回 javascript

> ID：11254617
> 
> 赞同：0
> 
> 时间：2012-06-29T00:14:58.957
> 
> 标签：javascript

我有一段 javascript 代码在做

```
function asyncs(){
    var backCount = 0;
    function done(){
        if(backCount === 2){
            alert("All done");
            doSomthingUseful();
        }else{
            backCount ++;
        }
    }
    function asyncCall(callBack){
        myRemoteCall(callBack);
    }
    asyncCall(done);
    asyncCall(done);
    asyncCall(done);
}

function doSomethingUseful(){
    alert("Travel to the moon.")
} 
```

这是有效的。但我想知道是否有更好的方法，这样我就不必编写这个丑陋的计数器函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:17:11.050

我建议使用像[async](https://github.com/caolan/async)或[Nimble](http://caolan.github.com/nimble/)这样的流控制库来处理这类事情。在内部它做几乎相同的事情，但它以可重用的模式为您提供它们。

# android - “没有 XML 内容。请为您的文档添加根视图或布局。”

> ID：11254618
> 
> 赞同：1
> 
> 时间：2012-06-29T00:15:10.660
> 
> 标签：android

我正在尝试遵循本教程： http: [//developer.android.com/training/basics/firstapp/building-ui.html](http://developer.android.com/training/basics/firstapp/building-ui.html)，因为我是 android 开发新手，这就是我的“activity_main.xml”文件的样子：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal">

<EditText android:id="@+id/edit_message"
    android:layout_weight="1"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:hint="@string/edit_message" />

<Button
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/button_send" /> 
```

当我单击运行时，我收到一条错误消息，显示“没有 XML 内容。请向您的文档添加根视图或布局。” 我注意到生成了一个名为“activity_main.out.xml”的新文件。我可能做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T13:40:41.680

Eclipse is running the XML not your activity. If previous solution doesn't work then delete `actvity_main_out.xml` and run the app not XML.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T18:11:47.220

除了 Torgis 的回复（如果您使用的是 Macbook Retina 并且很可能在 ADT Preview 21 中出现此错误） - 解决方法是切换到 XML 视图并右键单击，转到 Source > Cleanup Document > Check the Fix XML声明并进行更改。

回到图形布局视图后，它应该可以按预期工作。

如果未启用清理文档，只需格式化代码并检查更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-30T20:31:47.607

当您在编辑器中打开布局 (activity_main.xml) 并单击工具栏中的“运行”按钮时，您可能会看到这一点。有两种方法可以解决此问题：

1.  单击运行按钮旁边的下拉菜单并从列表中选择您的项目，或者
2.  将编辑器切换到代码文件，然后单击运行按钮。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-30T16:06:52.680

只需删除 activity_main.out.xml 并再次运行项目。确保您打开了 .java 透视图，而不是 .xml

[更新] 已在 Eclipse Juno 中修复

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-24T14:29:21.677

我想指出 ADT Preview 21 中有一个错误 - 我在这里安装了预览工具来修复 MacBook Retina 模拟器错误：[Android Emulator do not scale to 100% for Mac Book Pro with Retina Display](https://stackoverflow.com/questions/11213037/android-emulator-do-not-scale-to-100-for-mac-book-pro-with-retina-display/12064580#12064580)。

但是，我现在无法打开任何布局，因为它们都给了我这个错误。我发现有一种解决方法：切换到 XML 视图并进行任何编辑——即使它是一个空格。保存，然后切换回图形布局，错误就消失了。

# php - 获取不带 DOCTYPE、HTML、HEAD 和 BODY 标记的 BODY 内容

> ID：11254619
> 
> 赞同：19
> 
> 时间：2012-06-29T00:15:21.443
> 
> 标签：php

我想要做的是在 PHP 系统中包含一个 HTML 文件（不是问题），但由于各种原因，该 HTML 文件也需要单独使用，所以我需要知道如何去除 doctype，html , 如果可能的话，PHP 上下文中的 head 和 body 标记包括。

我不是特别擅长 PHP（doh！），所以我在 php 手册和网络上的搜索并没有让我明白这一点。这意味着非常感谢任何帮助或阅读提示，或两者兼而有之。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-29T01:07:18.563

由于该`substr()`方法对于某些人来说似乎太多了，所以这里有一个 DOM 解析器方法：

```
$d = new DOMDocument;
$mock = new DOMDocument;
$d->loadHTML(file_get_contents('/path/to/my.html'));
$body = $d->getElementsByTagName('body')->item(0);
foreach ($body->childNodes as $child){
    $mock->appendChild($mock->importNode($child, true));
}

echo $mock->saveHTML(); 
```

[http://codepad.org/MQVQ3XQP](http://codepad.org/MQVQ3XQP)

任何人都希望看到“另一个”，请参阅修订版。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-01-08T18:45:50.120

```
$site = file_get_contents("http://www.google.com/");

preg_match("/<body[^>]*>(.*?)<\/body>/is", $site, $matches);

echo($matches[1]); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-29T01:21:26.893

使用 DOMDocument 保留你需要的东西，而不是剥离你不需要的东西 (PHP >= 5.3.6)

```
$d = new DOMDocument;
$d->loadHTMLFile($fileLocation);
$body = $d->getElementsByTagName('body')->item(0);
// perform innerhtml on $body by enumerating child nodes 
// and saving them individually
foreach ($body->childNodes as $childNode) {
  echo $d->saveHTML($childNode);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-04T13:49:20.917

您可能希望使用 PHP tidy 扩展来修复无效的 XHTML 结构（在这种情况下 DOMDocument 加载崩溃），并且只提取正文：

```
$tidy = new tidy();
$htmlBody = $tidy->repairString($html, array(
    'output-xhtml' => true,
    'show-body-only' => true,
), 'utf8'); 
```

然后将提取的正文加载到 DOMDocument 中：

```
$xml = new DOMDocument();
$xml->loadHTML($htmlBody); 
```

然后遍历、提取、移动 XML 节点等 .. 并保存：

```
$output = $xml->saveXML(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-29T01:23:39.893

使用 DOM 解析器。这未经测试，但应该做你想做的

```
$domDoc = new DOMDocument();
$domDoc.loadHTMLFile('/path/to/file');
$body = $domDoc->GetElementsByTagName('body')->item(0);
foreach ($body->childNodes as $child){
    echo $child->C14N(); //Note this cannonicalizes the representation of the node, but that's not necessarily a bad thing
} 
```

如果你想避免规范化，你可以使用[这个版本](http://codepad.org/MQVQ3XQP)（感谢@Jared Farrish）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-02T05:24:57.973

正如[miken32](https://stackoverflow.com/users/1255289/miken32) [所说](https://stackoverflow.com/a/53111754/530197)：

> 嘿，为什么不回答一个 9 岁的问题？PHP 5.4 版（在提出这个问题 3 年后发布）将`options`参数添加到 `DomDocument::loadHTML()`. 有了它，你可以这样做：

```
$dom = new DomDocument();
$dom->loadHTML($string, LIBXML_HTML_NODEFDTD | LIBXML_HTML_NOIMPLIED);

// do stuff

echo $dom->saveHTML(); 
```

我们传递了两个常量：`LIBXML_HTML_NODEFDTD`表示不添加文档类型定义，并`LIBXML_HTML_NOIMPLIED`表示不添加隐含元素，如`<html>`and `<body>`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-17T09:43:52.990

只有一个 DOMDocument 实例且没有循环的解决方案

```
$d = new DOMDocument();
$d->loadHTML(file_get_contents('/path/to/my.html'));
$body = $d->getElementsByTagName('body')->item(0);
echo $d->saveHTML($body); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-03-14T10:27:07.087

这可能是一个解决方案。我试过了，效果很好。

```
function parseHTML(string) {
      var   parser = new DOMParser
     , result = parser.parseFromString(string, "text/html");
      return result.firstChild.lastChild.firstChild;
    }
```

# javascript - 如何禁用悬停突出显示？

> ID：11254623
> 
> 赞同：0
> 
> 时间：2012-06-29T00:15:58.973
> 
> 标签：javascript, html, css, drop-down-menu

我必须禁用`<select>`html的突出显示效果。当您下拉下拉列表中的项目并将鼠标移到项目上时，蓝色条带会随鼠标移动。我必须禁用此效果。
这是示例代码

```
<select>
    <option>April</option>
    <option>May</option>
    <option>June</option>
</select> 
```

这是演示[http://jsfiddle.net/Jams/5ZC3m/](http://jsfiddle.net/Jams/5ZC3m/)
欢迎任何 CSS 或 Javascript 解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:20:38.337

它只是被浏览器突出显示，因为它处于活动状态。我相信禁用此功能的唯一方法是从字面上禁用选择框

```
<select disabled="disabled"> 
```

这显然会删除所有功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:08:22.817

在使用默认样式表应用默认样式的浏览器中，您应该能够通过识别适当的样式属性并将其设置为您想要的来覆盖默认值。但可能是某些浏览器不使用默认样式表，或者不允许您覆盖设置。

使用脚本驱动的替代方案通常是一个糟糕的选择。大多数人没有正确遵循默认浏览器行为，他们只是做了开发人员认为是个好主意的事情，破坏了一些用户的 UI。例如，在 Safari 中使用键盘导航时，空格键用于选择选项。脚本驱动的替换选择元素似乎被编程为只接受用于选择选项的 tab 键，因此一些用户会得到一个损坏的 UI。

为什么不直接使用浏览器默认值？为什么**必须**删除突出显示？用户习惯了他们的浏览器及其工作方式，弄乱 UI 是开发人员的事情，只会让用户的生活变得困难。顺便说一句，我不喜欢这样的突出显示（我讨厌光标触及的所有东西都必须做某事的现代趋势），但它就在那里，所以我不理会它。

# objective-c - 从静态函数中如何将信息放入 iVars？

> ID：11254629
> 
> 赞同：0
> 
> 时间：2012-06-29T00:16:42.633
> 
> 标签：objective-c, cocoa-touch

请注意，由于此函数被传递给另一个函数，因此我无法传递 ViewController 指针。

```
static int callback(void *NotUsed, int argc, char **argv, char **azColName)
{
    NSString *str = @""; 

    int i;

    for(i=0; i<argc; i++)
    {
        printf("%s = %s\n", azColName[i], argv[i] ? argv[i] : "NULL");
        str = [NSString stringWithFormat:@"%@\n%s = %s\n", str, azColName[i], argv[i] ? argv[i] : "NULL"];
    }
    printf("\n");

    //tvDisplay is a UITextView
    [tvDisplay setText:str]; // <---- ??? how to get to an iVar
    return 0;
} 
```

* * *

电话：

```
rc = sqlite3_exec(db, pSQL[i], callback, 0, &zErrMsg); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:31:27.067

回调函数通常有一个参数，允许您传递任意数据（通常是`void *`被调用的上下文或类似的东西）。您可以在设置回调函数时传入需要访问的对象，然后在回调函数中检索它：

```
static void myCallback(int someResult, void *context) {
   SomeClass *someObject = (SomeClass *)context;
   [someObject doStuff];
} 
```

在您的特定情况下，“您要在回调函数中访问的任意数据”的位置是`void *`您当前设置为 0 的回调函数本身之后的参数：

```
int sqlite3_exec(
  sqlite3*,                                  /* An open database */
  const char *sql,                           /* SQL to be evaluated */
  int (*callback)(void*,int,char**,char**),  /* Callback function */
  void *,                                    /* 1st argument to callback */
  char **errmsg                              /* Error msg written here */
); 
```

Keep in mind that you're responsible for ensuring that any data you stick in there remains valid while the callback has not yet returned, and, if necessary, free it in the callback.

# jquery - 如何在 jQuery 中使用 YUI 节点？

> ID：11254633
> 
> 赞同：0
> 
> 时间：2012-06-29T00:17:26.553
> 
> 标签：jquery, yui

我正在使用将 YUI 库用作其本机 JS 框架的门户软件，并且我想在各种 YUI 节点上使用 jQuery。

有人可以告诉我这是怎么做的吗？我尝试了以下但没有成功...

```
YUI().use('node', function (Y) {
    var oneElementById     = Y.one('#foo');
    $(oneElementById).css('color','red');

}); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:38:35.403

对于您在示例中所做的事情，您可以执行以下操作：

```
var nativeDomElementById = Y.one('#foo').getDOMNode();
$(nativeDomElementById).css('color','red'); 
```

一般来说，关于 YUI 和 jQuery 之间的流畅性，请参阅Kevin 提到的[http://jsrosettastone.com站点。](http://jsrosettastone.com)在 YUI 和 jQuery 之间“跨越流”时必须小心，因为它们在节点和事件周围使用不同的抽象。

如果您在 YUI 沙箱中同时使用 jQuery 和 YUI——比如说，您想在 YUI 旁边加载一个 jQuery 插件，那么 YUI 3 Cookbook 中的这个配方可能会有所帮助：[https ://github.com/evangoer/yui3 -cookbook/blob/master/examples/loading/use_jquery.html](https://github.com/evangoer/yui3-cookbook/blob/master/examples/loading/use_jquery.html)

如果您遇到困难，请进入 freenode.net 上的#yui IRC 频道。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:51:50.797

你为什么想这么做？做你想做的事，你只需使用 setStyle 而不是 css，api 非常相似[JS Rosetta Stone jquery 和 yui api 比较](http://www.jsrosettastone.com/#css)

# macos - 尝试执行 cc1 时出错，gcc 只想为 avr 编译？

> ID：11254639
> 
> 赞同：3
> 
> 时间：2012-06-29T00:18:48.257
> 
> 标签：macos, gcc, compiler-errors

我已经在我的 Mac (Snow Leopard) 上安装了 gcc，所以我可以为 AVR 微控制器编译。但是，它似乎阻止了我为其他任何东西进行编译。我想从 astrometry.net 构建软件包，当我运行 ./configure 时，我得到以下信息：

```
make -C ./qfits-an stage CFLAGS=" -g -Wall -ffinite-math-only -fno-signaling-nans  -march=native -O3 -fomit-frame-pointer -DNDEBUG -fPIC -Winline -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_GNU_SOURCE" LDFLAGS=" -g -Wall -ffinite-math-only -fno-signaling-nans  -march=native -O3 -fomit-frame-pointer -DNDEBUG -fPIC -Winline" CC="gcc"
make -C src stage
gcc -g -Wall -ffinite-math-only -fno-signaling-nans  -march=native -O3 -fomit-frame-pointer -DNDEBUG -fPIC -Winline -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_GNU_SOURCE   -c -o anqfits.o anqfits.c
gcc: error trying to exec 'cc1': execvp: No such file or directory 
```

gcc -v 给出：

```
Using built-in specs.
Target: avr
Configured with: ./configure --target=avr --enable-languages=c,c++ --disable-nls --disable-libssp --prefix=/usr/local/staging.avr-gcc
Thread model: single
gcc version 4.1.1 
```

我不知道如何进行！似乎目前一切都设置为只为 AVR 平台构建，但我安装了 Xcode，所以在某个地方有更多版本的 gcc 潜伏着。此安装是通过[http://www.micahcarrick.com/installing-gnu-tools-avr-gcc.html](http://www.micahcarrick.com/installing-gnu-tools-avr-gcc.html)进行的，如果这有助于了解它是如何设置的（我在此之前安装了 Xcode）。

我希望解决方案很简单。我只是想避免弄乱我的设置，然后无法为任何一个平台编译。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T09:50:26.023

您可能希望删除已安装的 AVR 工具的非交叉编译器命名版本（即`gcc`、`ld`等），因此交叉编译器和相关工具只能使用特定于目标的名称。

为此，请找到它们的安装目录（`/usr/local/bin`？）并找到同时安装的所有工具。例如，这就是在我的 Linux 机器上发生的事情（给你一个想法）：

```
$ which gcc
/usr/bin/gcc
$ cd /usr/bin
$ ls -li *gcc*
189389 -rwxr-xr-x 2 root root 268088 Dec  6  2011 gcc
195145 -rwxr-xr-x 1 root root   2018 Aug 16  2010 gccmakedep
189389 -rwxr-xr-x 2 root root 268088 Dec  6  2011 x86_64-redhat-linux-gcc 
```

然后我将删除`gcc`，`x86_64-redhat-linux-gcc`作为启动该编译器的唯一方法（它们是硬链接的，因为它们共享相同的 inode）。还有其他工具，您可以在同一目录中按日期识别。

另一种方法是将交叉编译器安装到不在您的`$PATH`.

# c - NDK中char和wchar_t之间的转换

> ID：11254640
> 
> 赞同：1
> 
> 时间：2012-06-29T00:18:53.907
> 
> 标签：c, android-ndk, chat, wchar-t

认为：

```
char from[10]="abcd";
wchar_t to[10]=L""; 
```

在 Linux 和 MSVC 下的 gcc 中，我可以`sscanf(from, "%S", to);`使用`wchar_t`:`L"abcd"`在`to`. 但这在 NDK 中不起作用。

我想知道NDK是否支持这个？有其他选择吗？

我知道我可以使用复制循环来完成此操作：

```
for (int i = 0; i <= strlen(from); ++i)
    to[i] = from[i]; 
```

我正在使用 android-ndk-r7-crystax-5.beta2-linux-x86.tar.bz2 。我的字符串只包含 ASCII 字符，所以我不想使用`iconv`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:30:25.157

google android ndk 说：支持wchar函数。但是有些wchar函数只是提供了空的。如：`wsclen()`，总是返回1。可以使用[http://www.crystax.net/ndk](http://www.crystax.net/)，

# c# - 实体框架从上下文中删除对象，但不从数据库中删除

> ID：11254642
> 
> 赞同：9
> 
> 时间：2012-06-29T00:19:09.853
> 
> 标签：c#, entity-framework, memory-management, out-of-memory, objectcontext

我正在研究一个批处理过程，该过程将大约 800,000 条记录从一个缓慢的旧数据库（每个记录获取时间 1.4-2 毫秒......它加起来）转储到 MySQL 中，它可以执行得更快一些。为了优化这一点，我一直将所有 MySQL 记录加载到内存中，这使使用量达到约 200MB。然后，我开始从遗留数据库中转储并更新记录。

最初，当这完成更新记录时，我会调用 SaveContext，这将使我的内存从 ~500MB-800MB 跃升至 1.5GB。很快，我就会出现内存不足的异常（运行它的虚拟机有 2GB 的 RAM），即使我要给它更多的 RAM，1.5-2GB 仍然有点过多，那只是放了一个乐队- 帮助解决问题。为了解决这个问题，我开始每 10,000 条记录调用一次 SaveContext，这对事情有所帮助，并且由于我使用委托从遗留数据库中获取数据并在 MySQL 中更新它，因此在在保存时等待大约 5 秒，然后它会在内存中更新已备份的 3000 条左右的记录。但是，内存使用量仍在不断上升。

以下是我的潜在问题：

*   数据以任何顺序从遗留数据库中出来，所以我不能分块更新并定期释放 ObjectContext。
*   如果我没有事先从 MySQL 中获取所有数据，而是在更新过程中逐条查找，那么它的速度非常慢。相反，我事先将其全部抓取，将其转换为由主键索引的字典，并在更新数据时从字典中删除记录。

我想到的一种可能的解决方案是以某种方式释放实体使用的内存，我知道我永远不会再碰它们，因为它们已经被更新（比如清除缓存，但仅限于特定项目），但我不知道如果实体框架甚至可以做到这一点。

有人有想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T01:15:04.803

您可以在上下文中调用 Detach 方法，将不再需要的对象传递给它：http: [//msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.detach%28v=vs.90% 29.aspx](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.detach%28v=vs.90%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T02:08:55.803

我想知道您最好的选择是不是之前建议的另一个工具，或者只是放弃使用实体框架。如果您在没有 ORM 的情况下执行代码，您可以：

1.  调整 SQL 语句以提高性能
2.  轻松控制和更改事务范围以获得最佳性能。
3.  您可以批量更新，这样您就不会调用服务器来完成多个更新，而是一次执行一个更新。

# c# - 如何计算这种奇数方法的时间复杂度

> ID：11254647
> 
> 赞同：1
> 
> 时间：2012-06-29T00:20:45.837
> 
> 标签：c#, algorithm

方法是：

```
List<Book> books = new List<Book>();

public List<Book> Shoot()
{
   foreach(var b in books)
   {
       bool find = true;
       foreach(var otherb in books)
       {
           if(otherb != b && otherb.Author == b.Author)
           {
               find = false;
           }
       }

       if(find)
       {
           yield return b;
       } 
   }
} 
```

通常，时间复杂度为 O(books.Count^2)，但在外循环中有一个 if(find) 语句，它可能会改变循环次数。

所以我的问题是：

1.  这种方法的时间复杂度是多少？
2.  你是怎么计算的？

我在网上等你的答复。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:26:43.853

您将在外循环（n）中浏览每本书，对于每本外书，您将在内循环（n 次）中相互浏览，因此时间复杂度为 O（n^2）。

yield return 不会改变算法的复杂性，它会创建一个迭代器模式，但是如果你从调用函数遍历整个列表，你会经历算法中的所有迭代。

[C# 中使用的 yield 关键字是什么？](https://stackoverflow.com/questions/39476/what-is-the-yield-keyword-used-for-in-c)

为了优化算法，正如 btilly 提到的，您可以对集合进行两次遍历，在第一次遍历时，您将每个作者的书籍数量存储在哈希表中，在第二次遍历时，您检查作者是否有不止一本书使用哈希表（假设查找的时间是恒定的），如果确实如此，则产生这本书：

```
public List<Book> Shoot()
{
    var authors = new Dictionary<string, int>();
    foreach(var b in books) 
    {
        if(authors.ContainsKey(b.Author))
            authors[b.Author] ++;
        else
            authors.Add(b.Author, 1);
    }

    foreach(var b in books) 
    {
        if(authors[b.Author] == 1)
            yield return b;
    }
} 
```

这样你就有了 O(n) 的线性时间复杂度，注意在这种情况下你需要 O(n) 额外的空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:38:15.067

您的单产最差表现是`O(n * n)`. 你最好的情况是`O(n)`. 如果假设作者是随机排序的，固定部分只写一本书，那么收益率之间的平均情况是`O(n)`因为到达`m`外循环迭代的概率随着`m`增加而呈指数下降。（在此处插入标准几何级数参数。）

通常（但并非总是如此！）人们对平均情况最感兴趣。

顺便说一句，处理这个问题的标准方法是预先创建一个包含所有作者的字典，以及他们写了多少本书。那需要时间`O(n)`。然后您的收益将只搜索该字典的键，以查找只有 1 个条目的下一个。随后收益率的平均时间将是`O(1)`，最坏情况下`O(n)`，所有收益率的摊销平均时间（假设固定比例只写一本书）将是`O(1)`每个收益率。与当前`O(n)`按产量执行的实现相反。

# mercurial - 为什么 mercurial 的 log --follow 选项会错过变更集？

> ID：11254653
> 
> 赞同：2
> 
> 时间：2012-06-29T00:21:47.457
> 
> 标签：mercurial

如果我使用 log -k 它会拉出两个变更集，但是当我添加 --follow 或 -f 时它会错过其中一个。为什么会这样？

（我认为 --follow 只能*将*变更集添加到返回的集合中，即在名称更改为当前名称之前修改了所选文件的那些。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:17:57.113

该`-f`选项仅遵循起始修订的祖先/后代的历史。

我的猜测是`-k`（关键字搜索）正在从您的存储库中的两个分支返回结果。因此，通过添加`-f`/ `--follow`，您将结果限制为与起始修订直接相关的变更集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-31T22:52:06.850

我回到这里是因为我终于（大部分）得到了 --follow 保留的内容和丢弃的内容。尽管爱德华基本上是对的，但在测试了他的答案后我感到很困惑，因为我误解了“开始修订”的含义，而且它遵循祖先/后代的方式存在一些细微差别，导致结果没有符合我的预期。

这是一个带有简单分支的存储库：

```
% hg glog --template {rev}   
@  2
|
| o  1
|/
o  0

% hg glog --template {rev} -r '0+1+2'
@  2
|
| o  1
|/
o  0

% hg glog --template {rev} -r '1+2+0'
@  2
|
| o  1
|/
o  0 
```

下一个示例使用`--follow`说明了与规范相关的“起始修订”`--follow`是规范中的第一个（不是存储库中最早的或类似的），甚至随后的排序也很重要。

如果我们从共享祖先开始，一切都包括在内。

```
% hg glog --template {rev} -r '0+1+2' --follow
@  2
|
| o  1
|/
o  0 
```

如果我们不这样做，那么结果甚至取决于后面的顺序。看起来它可以遍历图，但只能在一个方向（祖先或后代，但不能在同一个调用中）。

```
% hg glog --template {rev} -r '1+2+0' --follow
o  1
|

% hg glog --template {rev} -r '1+0+2' --follow
o  1
|
o  0 
```

如果您手动订购，这不仅仅是一个问题。使用基本原语，您可能会以不同的顺序进行修订，从而导致混乱的行为。

```
% hg log --template {rev} -r 'all()'
012
% hg log --template {rev} -r 'all()' --follow         
012
% hg log --template {rev} -r 'reverse(all())'
210
% hg log --template {rev} -r 'reverse(all())' --follow
20 
```

对于它的作用，我仍然没有一个清晰简洁的规范，而且我认为生成“安全”的修订集是很棘手的。（由于这个原因，当从结果中删除变更集时，hg 是否会发出警告消息？）所以当我进行依赖于 --follow 的棘手处理时，我也运行没有 --follow，比较以确保我不是失去任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-03T17:47:13.523

我认为您的期望是有效`--follow`的，当与其他选项结合使用时，我发现它有点错误。

查看这些已确认的（并且有些旧的）错误：

*   [https://bz.mercurial-scm.org/show_bug.cgi?id=4959](https://bz.mercurial-scm.org/show_bug.cgi?id=4959) [标记为 FIXED 于 2018 年 1 月]
*   [https://bz.mercurial-scm.org/show_bug.cgi?id=5053](https://bz.mercurial-scm.org/show_bug.cgi?id=5053)

对我来说，一种解决方法是使用`--rev "follow('my/filename')"`revset 语法，而不是有问题的`--follow`标志。

也许试一试？

# extjs - Extjs 3.2 网格分页无法正常工作的问题

> ID：11254657
> 
> 赞同：0
> 
> 时间：2012-06-29T00:22:06.740
> 
> 标签：extjs, extjs3

我的页面上有多个商店来加载 extjs 网格中的数据。我正在使用 js 函数来加载这些商店。基于搜索按钮单击事件，我将相应的商店附加到网格。它工作正常。在加载函数中，我有很多参数需要发送到后端以获取结果并显示在网格中。现在分页到位。无论如何，我可以在分页中添加那个 js 函数调用，这样我就可以传递这些参数。因为现在如果我在分页中单击下一步按钮，则不会返回任何内容。因为缺少获取结果所需的参数。我在互联网上尝试了所有给定的样本，但没有任何效果。

如果有人可以实际发布一个关于分页传递参数或在下一个按钮事件上调用 js 函数的示例，那就太好了。

任何帮助将不胜感激。谢谢你。

下面是我想在下一个分页事件上调用的加载存储函数。

```
function loadStore(prodId, productsName, doctype, criteria, filename, titlename) {
    store.removeAll();
    store.load({
        params: {
            // specify params for the first page load if using paging
            start: 0,
            limit: g_perPage,
            ajax: "true",
            productId: prodId,
            ProductsNameArr: productsName,
            assetsname: doctype,
            criterianame: criteria,
            newfilename: filename,
            newtitlename: titlename
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:23:45.450

[http://docs.sencha.com/ext-js/3-4/#!/api/Ext.data.Store-property-baseParams](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.data.Store-property-baseParams)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T18:27:46.597

正如 Nigel 上面所说的 beforeload 事件是您所追求的，请参见下面的示例：

```
store.on('beforeload',function(store,opts) {
   store.baseParams = { param1: 'foo', param2: 'bar', ... }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-07T20:58:06.643

baseParams 似乎不是特别有用，因为它发送静态值，而不是最新的搜索条件。获取动态搜索条件也很棘手，因为网格（即表单字段）可能还不存在。

Ext JS 开发人员似乎一直将文档字符串片段误认为是真正的文档，这使得他们的产品学习曲线非常糟糕。这里有几个真实的例子会有很长的路要走。

# jsf - 托管 Bean 的 JSF 2.0 ArrayList 属性

> ID：11254661
> 
> 赞同：2
> 
> 时间：2012-06-29T00:23:04.690
> 
> 标签：jsf, inversion-of-control, javabeans, managed-bean, faces-config

我正在使用 JSF 2.0 Mojarra。

我需要创建一个包含 List 类型属性的托管 Bean。我需要用 Faces-Config.xml 中的一些值来初始化这个列表。我的问题是，我的班级的结构需要是什么样子才能完成这项工作。

例如，

```
public class Items{
     private List<Item> itemList = new ArrayList<>();

     public List<Item> getItemList(){
     return itemList;
}

public void setItemList (List<Item> itemList){
     this.itemList = itemList;
}

//Methods needed for adding and removing type Item elements to/from itemList.
//What is the convention, so that JSF can initialize these values?

public class Item{
     //This is a nested class
     private String itemProperty1;
     private String itemProperty2;

     //Getters and Setters for itemProperty1 and itemProperty2 have been omitted
     //for brevity.
   }
} 
```

此外，一旦我的班级设置正确。Faces-Config.xml 的正确结构是什么。例如，我应该这样做：

```
 <managed-bean>
   <managed-bean-name>items</managed-bean-name>
   <managed-bean-class>com.bricks.model.Items</managed-bean-class>
   <managed-bean-scope>Application</managed-bean-scope>
   <managed-property>
     <property-name>itemList</property-name>
     <value-class>com.brick.model.Items.Item</value-class>
     <list-entries>
       <value>item1</value>
       <value>item2</value>
     </list-entries>
  </managed-property>
</managed-bean>

<managed-bean>
  <managed-bean-name>item1</managed-bean-name>
  <managed-bean-class>com.bricks.model.Item</managed-bean-class>
  <managed-bean-scope>None</managed-bean-scope>
  <managed-property>
    <property-name>itemProperty1</property-name>
    <value>value1</value>
  </managed-property>
  <managed-property>
    <property-name>itemProperty2</property-name>
    <value>value2</value>
  </managed-property>
</managed-bean>

 <!--Repeat for item2 --> 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:55:04.010

您将列表项引用为普通的香草字符串。

```
<value>item1</value>
<value>item2</value> 
```

您需要通过 EL 引用它们，以便它解析为托管`Item`实例。

```
<value>#{item1}</value>
<value>#{item2}</value> 
```

# html - .htaccess 这个网页有一个重定向循环 htaccess

> ID：11254664
> 
> 赞同：2
> 
> 时间：2012-06-29T00:23:48.640
> 
> 标签：html, security, .htaccess

我想将我所有的 http 流量重定向到我网站中的 https。

我的 .htaccess 文件中有以下代码

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI}
</IfModule> 
```

一旦我将此文件放在目录中，我就会收到一条错误消息“此网页具有重定向循环 htaccess”

我看不到导致任何重定向的任何其他文件。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:17:23.993

这会将端口 80（标准 http）上的所有流量重定向到 https：

```
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L] 
```

或者，相反 - 重定向不在端口 443 (https) 上的任何流量：

```
RewriteCond %{SERVER_PORT} !^443$
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

你也可以试试：

```
RewriteCond %{HTTPS} !=on
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

# c - getchar 返回意外字符

> ID：11254666
> 
> 赞同：1
> 
> 时间：2012-06-28T15:18:48.647
> 
> 标签：c, gcc

我尝试编译这段代码：

```
#include <stdio.h>

void print(FILE *a)
{
int main();
int count=20;
int c;
int stop=0;
char answer;

while(!stop){
    while((c=getc(a))!=EOF){
            fprintf(stdout,"%c",c);
            if(c=='\n'){
                    count--;
                    if(!count){
                        printf("do you want continue:y=for continue/q=for quit");
                        fflush(stdin);
                            answer=getchar();
                        if(answer=='y' || answer=='Y')
                            count=20;
                        else if(answer=='Q' || answer=='q'){
                            printf("you quit this program,press any key and hit the enter to close");
                            stop=1;
                            break;
                            }
                        else{
                            printf("argument is unacceptable,rolling back action");
                            main();
                            }
                        }
                }
        }
    if(c==EOF)
        stop=1;
    }
}
void halt()/*do nothing just for halt and waiting for input*/
{
int a;

scanf("%d",&a);
}
int main()
{
FILE *in,*fopen();
char name1[25];
int a;

printf("enter the name of the file you want to show:");
scanf("%24s",name1);
in=fopen(name1,"r");
if(in==NULL){
    printf("the files doesnt exist or it is in another directory, try to enter again\n");
    main();
        }
else
    print(in);

fclose(in);
halt();

return 0;
} 
```

真正重要的是这部分：

```
if(!count){
    printf("do you want continue:y=for continue/q=for quit");
    fflush(stdin);
    answer=getchar();
    if(answer=='y' || answer=='Y')
         count=20;
    else if(answer=='Q' || answer=='q'){
         printf("you quit this program,press any key and hit the enter to close");
         stop=1;
         break;
    }
    else{
         printf("argument is unacceptable,rolling back action");
         main();
    }
} 
```

该程序预计将显示一个文件的 20 行内容，但是当我在终端中运行它时，当涉及到`if-else`部分时，它往往会执行 else，无论我放在`answer`变量中。我做错了什么

注意：我已经用不同的编译器（如 lcc-win32）尝试过这段代码，它工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T15:57:44.360

不确定问题出在哪里，这是基于您的代码的配对 q&d 示例，并且可以按预期工作。

```
#include <stdio.h>

int main(int argc, char * argv[])
{
  char  answer;

  while(1) {
    printf("\ndo you want continue:y=for continue/q=for quit: ");
    fflush(stdin);
    answer=getchar();

    if(answer=='y' || answer=='Y')
      puts("y/Y entered");
    else if(answer=='Q' || answer=='q'){
      puts("q/Q entered");
      break;
    }
    else
      puts("Something other than q/y entered.");
  }
} 
```

不幸的是，我现在时间紧迫，所以我无法检查您的版本和我的版本之间是否有任何实质性差异.. 我不记得任何东西。

这是在 Ubuntu 下使用 gcc 4.4.3 测试的。

看看这是否适合你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T17:38:04.957

问题在于它`fflush(stdin)`没有标准化并且在不同的系统上表现不同。有关更多信息，请查看[http://c-faq.com/stdio/stdinflush.html](http://c-faq.com/stdio/stdinflush.html)和[http://c-faq.com/stdio/stdinflush2.html](http://c-faq.com/stdio/stdinflush2.html)

那么这里发生了什么：您正在使用`scanf("%24s",name1);`从标准输入读取数据，例如，用户输入文件名（例如`test.c`，按下`Return`.`stdin`现在包含`test.c\n`.`scanf`现在从标准输入读取多达 24 个字符，在我们的例子中`test.c`并离开`\n`，`stdin`这意味着`stdin`包含 now `\n`。该`fflush(stdin)`调用不会从中删除`\n`，`stdin`这意味着您的`getchar()`调用将从标准输入读取`\n`，它解释了所描述的行为。

### 标准输入内容随时间变化

1.  之前`scanf`：`t``e``s``t``.``c``\n`
2.  之后`scanf`：`\n`-使用scanf`test.c`并将其分配给`name1`
3.  之后`fflush(stdin)`：`\n`
4.  之后`getchar()`：空`getchar`读并返回`\n`

有关此确切问题的更多信息以及更好的描述，请查看[有关 fflush vs.gets 的 c-faq 条目](http://c-faq.com/stdio/gets_flush2.html)

# sql - sql用子选择更新多行

> ID：11254669
> 
> 赞同：8
> 
> 时间：2012-06-29T00:24:13.550
> 
> 标签：sql, sql-update, subquery

我正在尝试将毕业期限表中相应的毕业日期值复制到 user_education_mba_school 表中具有匹配毕业期限的行中。这是我的非工作查询

```
TABLE DEFS
**user_education_mba_school
  school_id
  graduation_date
  graduation_term_id

**graduation_term
  graduation_term_id
  graduation_year_id
  graduation_date

**graduation_class
  graduation_class_id
  graduation_year_id  

**user
  user_id
  graduation_class_id 
```

-- 多连接不起作用...

```
UPDATE  u
SET     graduation_class_id = gc.graduation_class_id
FROM    [user] u
JOIN    user_education_mba_school mba
ON      mba.user_id = u.user_id
JOIN    graduation_term gt
ON      mba.graduation_term_id = gt.graduation_term_id
JOIN    graduation_class gc
ON      gt.graduation_year_id = gc.graduation_year_id 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T00:29:02.793

几个数据库支持`update ... from`语法，这是相当清楚的：

```
UPDATE  mba
SET     graduation_date = gt.graduation_date
FROM    user_education_mba_school mba
JOIN    graduation_term gt
ON      gt.graduation_term_id = mba.graduation_term_id 
```

如果您的数据库没有，请说明您使用的是哪个数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T00:29:36.593

这不起作用，因为您正在设置子查询的整个结果集

```
UPDATE user_education_mba_school SET graduation_date = (
  SELECT gt.graduation_date
  FROM user_education_mba_school mba, graduation_term gt
  WHERE gt.graduation_term_id = mba.graduation_term_id
) 
```

这应该有效（未经测试）

```
UPDATE user_education_mba_school mba SET graduation_date = (
  SELECT gt.graduation_date
  FROM graduation_term gt
  WHERE gt.graduation_term_id = mba.graduation_term_id
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:50:00.983

```
UPDATE  mba
SET     graduation_date = gt.graduation_date, mba_graduation_year_id = gt.graduation_year_id
FROM    user_education_mba_school mba
JOIN    [sueldovista].dbo.graduation_term gt
ON      gt.graduation_term_id = mba.graduation_term_id

UPDATE  u
SET     graduation_class_id = gc.graduation_class_id
FROM    [user] u
JOIN    user_education_mba_school mba
ON      mba.user_id = u.user_id
JOIN    [sueldovista].dbo.graduation_term gt
ON      mba.graduation_term_id = gt.graduation_term_id
JOIN    [sueldovista].dbo.graduation_class gc
ON      gt.graduation_year_id = gc.graduation_year_id
WHERE   gc.site_instance_id = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-21T19:27:13.250

甲骨文：

```
UPDATE PRODUCTION a
SET (name, count) = (
  SELECT name, count
  FROM STAGING b
  WHERE a.ID = b.ID); 
```

# jquery - jQuery .remove 不适用于嵌套元素

> ID：11254670
> 
> 赞同：3
> 
> 时间：2012-06-29T00:24:14.340
> 
> 标签：jquery

我试图简单地删除 中的所有嵌套`li`元素`ul`，但它不起作用。为什么这个片段不起作用？我错过了什么？

html

```
<ul id="myul">
</ul>
<br/>
<button onclick="add();">add</button><br/>
<button onclick="remAll();">remove all</button> 
```

js

```
function add()
{
    $('#myul').append('<li>hello world</li>');
}

function remAll()
{
    $('#myul').remove('li');
} 
```

[http://jsfiddle.net/gPnxY/](http://jsfiddle.net/gPnxY/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T00:25:00.890

而是这样做，选择器参数 for`remove()`是相关对象的过滤器。在这种情况下，所讨论的对象只是具有 id 的单个元素`myUl`，因此不包含任何`<li>`元素。

[jsFiddle](http://jsfiddle.net/Xq4q8/)

```
$('#myul').find('li').remove(); 
```

或者

```
$('#myul li').remove(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T00:27:55.970

[jsFiddle在这里](http://jsfiddle.net/roXon/gPnxY/1/)

这很好：

```
$('#myul').empty(); 
```

阅读更多很酷的东西：[http ://api.jquery.com/empty/](http://api.jquery.com/empty/)

还：

```
$('#myul').find('li').remove();
$('#myul li').remove();
$('#myul').contents().remove();
$('#myul').html(''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T00:27:53.040

或者做：

```
function remAll()
{
    $('#myul').html("");
} 
```

**演示**：http: [//jsfiddle.net/Xq4q8/1/](http://jsfiddle.net/Xq4q8/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T23:05:52.657

在我的情况下，我有从内容对象生成的 ID 值，并且这些值有“。” 在他们.. 例如：

```
{ id : 'abc1.ec' } 
```

这使我的 .remove() 调用在无效的 id 字符串上失败。一旦我弄清楚了这一点并生成了有效的 ID 字符串，一切正常。

# php - 在 CMS 中处理图像的最佳实践

> ID：11254672
> 
> 赞同：0
> 
> 时间：2012-06-29T00:24:37.143
> 
> 标签：php, mysql

关于在 PHP/MySQL CMS 中处理图像的最佳实践的快速问题。每个项目将有不同数量的关联图像，这些图像将存储在项目 ID 引用的文件夹中。验证在上传时完成，因此所有文件都应该是有效的。我的问题是我是否还应该将 ID 和文件名存储在数据库表中并从数据库中提取源数据，或者是否可以简单地遍历文件夹并直接插入源文件名？

我希望这是有道理的。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:44:07.570

这在很大程度上取决于您想要多少故障点以及响应时间的速度。

如果将其存储在文件系统上：

1.  传入的 HTTP 请求
2.  PHP查询数据库
3.  数据库找到行
4.  PHP破译查询响应
5.  PHP 读取文件
6.  PHP 发送文件的二进制内容作为对 HTTP 请求的响应

但是，如果将其作为二进制 blob 存储在数据库中：

1.  传入的 HTTP 请求
2.  PHP查询数据库
3.  数据库找到行
4.  PHP破译查询响应
5.  PHP 将二进制内容作为对 HTTP 请求的响应发送

在这两种情况下，只要设置了正确的索引/键，第 3 步（数据库找到行）就可以与我们的 WITHOUT blob 列一样快。MySQL 会在内部将指针移动到精确的索引位置——它实际上不会遍历每个字节，直到找到正确的字节（这是索引的全部点）。这与 PHP 手动读取文件一样耗时。但是，我目前*没有*支持性能数据来支持这一点。

现在让我谈谈失败点：

*   假设您迁移数据。如果您的二进制图像数据存储在数据库中，您只需移动数据库。但是，如果您的二进制图像数据存储在文件系统上，则必须记住移动两者。另请注意，迁移的 SIZE 将相同（或至少略有不同）。
*   考虑重命名资产 - 您不仅要在数据库中重命名它，还要在文件系统中重命名它。这是 2 个总步骤，而不是在 DB 中重命名它只有 1 个。
*   考虑删除资产 - 您必须在两个位置都将其删除。

出于可移植性、灵活性和最大程度地减少故障或损坏的目的，我一直将二进制数据作为 blob 存储在数据库中。

如果您选择将文件作为 blob 存储在数据库中，请考虑不同的 blob 存储要求：[http ://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html#id656744](http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html#id656744)

*   TINYBLOB - 256 字节
*   MEDIUMBLOB - 64 KB
*   LONGBLOB - 4 GB

最后，值得深思的是：我有使用 Adob​​e's Day CQ 的经验，这是一个新兴的企业级内容管理系统。它主要是用 Java 编写的，但需要注意的是数据架构。它使用 JCR（Java 内容存储库），或多或少类似于多维 MySQL 数据库（有点酷？）。其 DAM（数字资产管理器）中的所有图像数据都存储为 JCR 中的一个节点。

# mysql - Mysql：重复键更新所有值？

> ID：11254674
> 
> 赞同：7
> 
> 时间：2012-06-29T00:24:54.177
> 
> 标签：mysql

有没有什么简单的方法可以在重复键后更新所有值？例如：

```
INSERT INTO published_books
           SELECT * FROM books
           WHERE book_id = book_id
           ON DUPLICATE KEY UPDATE ?everything? 
```

该表有大约 50 列，更新每一列都会很痛苦。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T13:53:18.287

您可以`REPLACE INTO`为此目的使用：

```
REPLACE INTO published_books SELECT * from books; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T10:14:47.877

如果你可以生成查询，你可以使用这样的东西（PHP）：

```
$fields = array(
    'field_1',
    'field_2',
    'field_3'
);
$query = '
    INSERT INTO table (
    ' . implode(', ', $fields) . '
    ) SELECT
        -- ...
    ON DUPLICATE KEY UPDATE ';
foreach ($fields as $i => $field) {
    $query .= ($i > 0 ? ', ' : '') . $field . '=VALUES(' . $field . ')';
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-29T00:31:14.037

```
INSERT INTO published_books(col1, col2) 
VALUES (’xxx’, ‘yyy’) ON DUPLICATE KEY UPDATE col1 = VALUES(col1) 
```

# c# - 从 Mono 访问 Ubuntu 终端

> ID：11254676
> 
> 赞同：2
> 
> 时间：2012-06-29T00:25:18.597
> 
> 标签：c#, ubuntu, mono

**背景**
我正在编写一个 Web 应用程序，这样我就可以从一个网站控制一个*Ubuntu 服务器。*

我的一个想法是从单声道运行“屏幕”应用程序并从那里重定向我的输入和输出。

**从单声道运行“屏幕”：**

```
ProcessStartInfo info = new ProcessStartInfo("screen", "-m");
info.UseShellExecute = false;
info.RedirectStandardOutput = true;
info.RedirectStandardInput = true;

var p = new Process();

p.StartInfo = info;

p.Start();

var output =  p.StandardOutput;
var input = p.StandardInput; 
```

但是使用 RedirectStandardInput 运行“屏幕”会出现错误：

```
Must be connected to a terminal 
```

我尝试了许多不同的参数，但似乎没有一个适用于“重定向标准输入”

**控制服务器的其他想法将不胜感激**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T16:00:26.570

我认为这是一个典型的问题，您在问如何实施解决问题的方法，而不是问如何解决问题。我认为你不应该做一些骇人听闻的事情，比如制作一个通过终端将用户操作传送到服务器的网络应用程序。

我认为您可以绕过所有这些，并且无需编写任何代码，就可以利用平台（在本例中为 Gtk+）已经为您提供的功能：

[您可以使用Broadway GDK backend](http://blogs.gnome.org/alexl/2011/03/15/gtk-html-backend-update/)在服务器中运行 gnome-terminal 。这样 gnome-terminal 应用程序将不会在服务器中运行，而是在您指定的端口上打开一个 Web 服务器。稍后，您可以使用任何支持 WebSockets 的浏览器来控制它。

与迄今为止提供的其他解决方案相比，这是最简单且不那么 hacky 的解决方案。如果您仍然对使用 Mono 进行 Web 开发感到兴奋，您仍然可以，您可以将此访问嵌入到 iFrame 或其他东西中。

（PS：如果您不想依赖安装在服务器中的 GTK；您可以在网页的客户端部分使用 WebSockets 来将事件从服务器发送到客户端，并使用库[SSHNET](http://sshnet.codeplex.com/)发送用户直接通过电线输入。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:35:06.347

解决同一问题的另一种方法是[shellinabox](http://code.google.com/p/shellinabox/)。同样有趣的是[来自 anyterm 网站的这个页面，](http://anyterm.org/compared.html)它比较了实现这种功能的不同产品。

使用 shellinabox 非常简单：

```
# ./shellinaboxd -s /:LOGIN 
```

（这是他们网站上给出的示例）将启动一个网络服务器（在您的情况下是 Ubuntu 服务器）。当您将浏览器指向`http://yourserver:4200`您将看到一个登录屏幕，就像您在使用 ssh/putty/telnet/... 打开会话时看到的一样，但在您的浏览器中。

您可以通过在应用程序的网页中包含指向该服务的 iframe 来为服务器的 shell 提供所需的远程访问功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:58:44.260

`screen`将需要某种终端。这也太夸张了。

您可能希望研究[Unix 环境中的高级编程一书](http://www.apuebook.com/)`pty`（在源代码中）中的程序，以提供可以以编程方式驱动的伪终端。（如果你愿意的话，你可能会按照提供的方式运行程序并用 Mono 编写驱动程序。）（如果结合[本书](http://www.powells.com/biblio/72-9780321525949-0)学习，这个程序会更有意义。）`pty/``pty``pty`

使用该`pty`程序或类似功能的好处是您可以正确处理诸如`passwd`提示`open("/dev/tty")`用户输入密码的程序。如果您只是通过系统调用重定向标准 IO 流`pipe()`，`dup2()`您将没有控制终端来控制需要的程序。（这仍然是很多有用的程序，但不足以成为远程管理工具。）

系统可能有 Mono 接口`pty(7)`；如果是这样，使用它可能比使用 C API 更自然，但实际工作的是 C API，因此直接用本机语言编写可能更容易。

# actionscript - 实例上的 addFrameScript 问题

> ID：11254677
> 
> 赞同：0
> 
> 时间：2012-06-29T00:25:24.757
> 
> 标签：actionscript, label, frame

我正在尝试通过以下方式添加框架脚本：

```
private function addFrameScript(mc:MovieClip, label:String, func:Function, arg:*):void {
    var labels:Array = mc.currentLabels;
    var i:int = labels.length;

    while (--i > -1) {
        if (FrameLabel(labels[i]).name == label) {
            mc.addFrameScript(FrameLabel(labels[i]).frame-1, func(arg));
            return;
        }
    }

    trace("WARNING: The label '" + label + "' does not exist in the MovieClip '" + mc.name + "'");
}

private function dispatchFrameEvent(labelName:String):void {
    dispatchEvent(new Event(labelName, true));
}

addFrameScript(instanceName, "end", dispatchFrameEvent, "end"); 
```

但它似乎没有添加，我不知道为什么。通常我会将 Frame 脚本添加到主时间轴，但不会添加到时间轴上的实例（如上例所示）。

显然我缺少一些东西......有没有办法追踪我的框架脚本以查看它是否被添加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:08:49.710

这里的问题是添加的 addFrameScript 函数没有参数。所以无论你传入什么 func 必须返回一个没有参数的函数

所以你的 dispatchFrameEvent 应该是这样的

```
private function dispatchFrameEvent(labelName:String):Function {
   return function func():void{
     dispatchEvent(new Event(labelName, true));
   }
} 
```

# asp.net-mvc - 使用带有使用 JSON.net 组成的动态模型的 RazorEngine 问题

> ID：11254680
> 
> 赞同：2
> 
> 时间：2012-06-29T00:26:01.620
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我正在使用 Json.net 将 json 字符串转换为动态字符串。当我将此动态用作 Razor 模板的模型时，出现错误...

> 无法编译模板。'Newtonsoft.Json.Linq.JObject' 不包含'Name' 的定义，并且找不到接受'Newtonsoft.Json.Linq.JObject' 类型的第一个参数的扩展方法'Name'（您是否缺少 using 指令还是汇编参考？）

如果我只使用一个简单的匿名对象作为模型，它就可以正常工作。

这是一个简单的控制台应用程序中显示的问题，我使用 NuGet 拉入两个库...Newtonsoft JSON 和 RazorEngine。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            // template used for generation
            var template = "<div>Hello @Model.Name</div>";

            // create model
            dynamic model = new System.Dynamic.ExpandoObject();
            model.Name = "Foo";

            // this works just fine
            RazorEngine.Razor.Parse(template, model);

            // convert model to string
            var json = Newtonsoft.Json.JsonConvert.SerializeObject(model);

            // regenerate model
            model = Newtonsoft.Json.Linq.JObject.Parse(json);

            // this prints 'Foo' to the console just fine so the model is valid!
            string name = model.Name;
            System.Diagnostics.Debug.WriteLine(name);

            // this throws the error above!
            RazorEngine.Razor.Parse(template, model);
        }
    }
} 
```

有人可以帮我解决这里的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T10:52:55.850

您不能直接将 传递给`JObjects`，`RazorEngine`因为每当您将值分配给 时，`JObject`它们都存储为 type `JValue`。当您尝试检索分配的值时，您也会得到一个`JValue`不是分配的值。

前任。

```
dynamic person = new JObject();
person.Name = "Vijay";

Console.WriteLine(person.Name.GetType());

==> NewtonSoft.Json.Linq.JValue 
```

# android - android robolectric：模拟 HTTP 请求 - 找不到类 Http

> ID：11254682
> 
> 赞同：0
> 
> 时间：2012-06-29T00:26:27.383
> 
> 标签：android, maven, robolectric

这可能是一个愚蠢的问题；但是，我没有选择，希望能得到帮助。我正在尝试使用 Robolectric 模拟文件下载。我指的是[HttpTest.java](https://github.com/pivotal/RobolectricSample/blob/master/src/test/java/com/pivotallabs/api/HttpTest.java)类和 Robolectric[博客文章](http://robolectric.blogspot.com/2011/01/how-to-test-http-requests.html)。

我的问题：Maven 找不到 HttpTest.java 代码中引用的 Http 类。我可以手动将它作为一个类放在同一个包中，但我最终在 Http 类的方法之一中得到了 NullPtrException。

我在网上搜索了解决方案。我还验证了 pom 文件中的模块配置。我那里确实有 com.pivotlabs。

有没有人得到这个工作？请让我知道我在这里缺少什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T21:47:54.393

我得到了这个工作。

1.  Http 是 Robolectric 示例代码的内部类。可在室外使用；但如果您的代码将在非本地构建，您可能不想这样做。
2.  文档中对我有很大帮助的澄清/提及是：“Robolectric 将为您提供使用 addPendingHttpResponse() 为您的 HTTP 请求创建的响应，无论您如何执行请求。Robolectric 不会执行实际的 HTTP要求。” 明白了这一点，休息就容易了。
3.  我为我的请求使用了 Apache 的 DefaultHttpClient，并根据已创建的响应验证了收到的响应。

希望这可以帮助; 我很乐意进一步澄清。

感谢我在这里得到的帮助。

[我也在 Robolectric 的谷歌小组上问过这个问题。]

# maven - 如何在 Maven 多模块项目中共享依赖项？

> ID：11254690
> 
> 赞同：0
> 
> 时间：2012-06-29T00:27:41.490
> 
> 标签：maven, jar, multi-module

我有点好奇这是如何工作的——如果我在一个 Maven 多模块项目中有 5 个模块项目，你可以在不将该项目添加为依赖项的情况下将内容和包导入其他模块吗？或者您实际上是否需要 .jar（或快照 jar）才能使用其他模块的结构/功能？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T04:04:19.327

模块间依赖关系（在另一个模块的 pom.xml 中添加一个模块作为依赖项）在 Maven 世界中是有意义的（作为构建工具，而不是 IDE）。当您从命令行构建多模块项目时，您不需要自己关心每个模块之间的依赖关系，Maven 将对模块进行拓扑排序，使得依赖关系总是在依赖模块之前构建（因此生成 jar 文件）（所以它可以引用生成的 jar 文件作为依赖项）。

如果您使用像 Eclipse 这样的 IDE，这不是必需的（理论上），因为您可以通过 Eclipse 中的一些手动设置来实现相同的结果（添加一个项目作为另一个项目的依赖项）`Right click project and choose Properties -> Java Build Path -> Projects -> Add`，这在 Eclipse 导入您的多模块时会自动处理项目，如果您在 pom.xml 中定义模块间依赖项。

问题是为什么您想做一些不寻常的事情（不将该项目添加为依赖项）而您无法从中获得任何好处。

# java - 在 Hadoop 0.20.2 中解析日志目录

> ID：11254693
> 
> 赞同：1
> 
> 时间：2012-06-29T00:27:59.637
> 
> 标签：java, hadoop

我有一个基于文本的压缩日志文件目录，每个文件都包含许多记录。在旧版本的 Hadoop 中，我将扩展`MultiFileInputFormat`以返回`RecordReader`解压缩日志文件并从那里继续的自定义。但我正在尝试使用 Hadoop 0.20.2。

在 Hadoop 0.20.2 文档中，我注意到`MultiFileInputFormat`不推荐使用`CombineFileInputFormat`. 但要扩展`CombineFileInputFormat`，我必须使用已弃用的类`JobConf`和`InputSplit`. 什么是现代的等价物`MultiFileInputFormat`，或者从文件目录中获取记录的现代方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T04:48:02.623

> MultiFileInputFormat 的现代等价物或从文件目录获取记录的现代方式是什么？

oahmapred.* 具有旧 API，而 oahmapreduce.* 是新 API。某些输入/输出格式尚未迁移到新 API。MultiFileInputFormat/CombineFileInputFormat 尚未迁移到 20.2 中的新 API。我记得打开了一个 JIRA 来迁移丢失的格式，但我不记得 Jira #.

> 但要扩展 CombineFileInputFormat，我必须使用已弃用的类 JobConf 和 InputSplit。

现在应该可以使用旧的 API。在 Apache 论坛中查看此[响应。](http://mail-archives.apache.org/mod_mbox/hadoop-common-user/201203.mbox/%3CCAOcnVr0osRAwytaU7LT+agf0BmMCWFhRGpj8_Ga4U6MaC2YkpA@mail.gmail.com%3E)我不确定停止支持旧 API 的确切计划。我不认为很多人已经开始使用新的 API，所以我认为它会在可预见的未来得到支持。

# javascript - JavaScript 代码错误：图像不显示

> ID：11254694
> 
> 赞同：1
> 
> 时间：2012-06-29T00:28:04.270
> 
> 标签：javascript, jquery, wordpress

我正在开发一个 WordPress 网站，并且在我的 JavaScript 文件中放置了以下代码：

```
function blockAdblockUser() {
    if ($('.sideAd').height() == 0) {
        "<a href='http://google.com' target='_blank'><img src='image.png' /></a>";
    }
}

$(document).ready(function(){
    blockAdblockUser();
}); 
```

...我将以下代码放在我的 html 中...

```
<section class="sideAd">
    <!-- google ad script here -->
</section> 
```

基本上，如果用户使用 AdBlock 阻止广告，我会尝试显示备用图像。但是，打开 AdBlock 后，图像不会显示。我在想我写这行的方式有问题，`"<a href='http://google.com' target='_blank'><img src='image.png' /></a>";`当谈到 JavaScript 时，我还是个新手。

谁能看出问题出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:30:28.953

您需要获取您制作的字符串并将其实际设置为内部 html。您可以通过将内线更改为：

```
$('.sideAd').html("<a href='http://google.com' target='_blank'><img src='image.png' /></a>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:30:42.180

尝试：

```
function blockAdblockUser() {
    if ($('.sideAd').html() == "") {
        $('.sideAd').append("<a href='http://google.com' target='_blank'><img src='image.png' /></a>");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T06:30:34.390

```
function blockAdblockUser() {
    if ($('.sideAd').contents().length) {
        $('.sideAd').append("<a href='http://google.com' target='_blank'><img src='image.png' /></a>");
    }
} 
```

# python-3.x - Pygame Sprite 移动，无法更新

> ID：11254695
> 
> 赞同：1
> 
> 时间：2012-06-29T00:28:18.593
> 
> 标签：python-3.x, pygame, sprite

我将尝试将我的问题重新定义为一个更简洁和具体的问题。下面是 Hero 类，还有几个打印命令到终端，我试图用这些命令来找出问题所在：

代码：

```
class Hero(pygame.sprite.Sprite):
    """Moves the hero around the screen, following the mouse"""
    #male = load_image("malehero-64.png", -1)
    #female = load_image("girlhero-64.png", -1)
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.image, self.rect = load_image("girlhero-64.png", -1)
        self.rect = self.image.get_rect()
        self.rect.topleft = (384,0)
        self.target = self.movetarget()

    #def setgender(self, gender):
        #if gender == "male":
            #self.image, self.rect = self.male
        #if gender == "female":
            #self.image, self.rect = self.female
        #self.startingpos = (480, 640)
        #self.rect.topleft = (480,640)
        #self.target = self.rect.topleft

    def movetarget(self):
        self.pos = pygame.mouse.get_pos()
        self.rect = self.image.get_rect()
        self.target = self.rect.topleft
        self.targetx,self.targety = self.target
        self.oldx, self.oldy = self.rect.topleft
        if self.oldx + tilesize < self.pos[0]:
            self.targetx = self.oldx + tilesize
        if self.oldx > self.pos[0]:
            self.targetx = self.oldx - tilesize
        if self.oldx + tilesize >= self.pos[0] and self.oldx < self.pos[0]:
            self.targetx = self.oldx
        if self.oldy + tilesize < self.pos[1]:
            self.targety = self.oldy + tilesize
        if self.oldy > self.pos[1]:
            self.targety = self.oldy - tilesize
        if self.oldy + tilesize >= self.pos[1] and self.oldy < self.pos[1]:
            self.targety = self.oldy
        self.target = (self.targetx,self.targety)
        print("NOW THE TARGET IS SET!!!!!!!!")
        print(self.targetx,self.targety)
        return self.target

    def update(self):
        "Move the hero closer to the last mouse position clicked self.target"
        self.rect = self.image.get_rect()
        print("topleft before")
        print(self.rect.topleft)
        self.xmove = 0
        self.ymove = 0
        print("update target is")
        print(self.target)
        if self.rect.topleft[0] > 960:
            self.rect.topleft = (960, self.rect.topleft[1])
        if self.rect.topleft[0] < 0:
            self.rect.topleft = (0, self.rect.topleft[1])
        if self.rect.topleft[0] >= 0 and self.rect.topleft[0] <= 960:
            if self.rect.topleft[0] < self.target[0]:
                self.xmove = 4
            if self.rect.topleft[1] < self.target[1]:
                self.ymove = 4
            if self.rect.topleft[0] > self.target[0]:
                self.xmove = -4
            if self.rect.topleft[1] > self.target[1]:
                self.ymove = -4
        self.newx=self.rect.topleft[0]+self.xmove
        self.newy=self.rect.topleft[1]+self.ymove
        print("newx and newy")
        print (self.newx,self.newy)
        self.rect.topleft = (self.newx,self.newy)
        print("topleft after")
        print(self.rect.topleft) 
```

运行时，终端的片段如下：

代码：

```
NOW THE TARGET IS SET!!!!!!!!
64 64
NOW THE TARGET IS SET!!!!!!!!
64 64
NOW THE TARGET IS SET!!!!!!!!
64 64
NOW THE TARGET IS SET!!!!!!!!
64 64
topleft before
(0, 0)
update target is
(0, 0)
newx and newy
0 0
topleft after
(0, 0)
topleft before
(0, 0)
update target is
(0, 0)
newx and newy
0 0
topleft after
(0, 0)
topleft before
(0, 0)
update target is
(0, 0)
newx and newy
0 0
topleft after
(0, 0) 
```

我试图完成的事情：当鼠标在游戏地图上单击时，Hero.movetarget 会被调用，并设置一个距离当前矩形一格的移动目标。然后，当字符精灵组对组中的所有精灵调用更新方法（这是正确的术语吗？）时，它们应该向目标图块移动几个像素。

当更新方法只是将所有精灵快速移动一个图块时，我让精灵毫无问题地执行此操作。我正在尝试更改它，以便精灵滑过几帧到新的目标图块，而不是简单地跳到那里。

当我阅读上面的终端打印输出时，在 Hero.movetarget 中设置的 self.target 变量与在 Hero.update 开始时打印到终端的 self.target 不同。

我不明白为什么更改 Hero.movetarget 中的 self.target 不会更改 Hero.update 中的 self.target。

请原谅我对问题的措辞的任何无知，并提前感谢您提供的任何见解。

load_image 类取自 Pygame chimp 教程： 代码：

```
def load_image(name, colorkey=None):
    fullname = os.path.join('data', name)
    try:
        image = pygame.image.load(fullname)
    except pygame.error as message:
        print ('Cannot load image:', name)
        raise SystemExit(message)
    image = image.convert()
    if colorkey is not None:
        if colorkey is -1:
            colorkey = image.get_at((0,0))
        image.set_colorkey(colorkey, RLEACCEL)
    return image, image.get_rect() 
```

调用 Hero 类的程序主体，编辑为我认为的相关部分： 代码：

```
hero = Hero()

charactersprites = pygame.sprite.Group((hero))

mathsterGroup = pygame.sprite.Group()
mathster = Mathster((0, 0))
mathsterGroup.add((mathster))
charactersprites.add((mathster))
mathster = Mathster((128, 256))
mathsterGroup.add((mathster))
charactersprites.add((mathster))
mathster = Mathster((512, 320))
mathsterGroup.add((mathster))
charactersprites.add((mathster))

inventory = TextObject("Hit a mathster!", Font, (0,0,0), (1024,50))
charactersprites.add((inventory))
nextproblem = Input(x=825, color=(255,25,25), 

heroGroup = pygame.sprite.Group()
heroGroup.add(hero)

clock = pygame.time.Clock() 

while 1:
    events1 = pygame.event.get()

    for event in events1:
        if event.type == pygame.QUIT: sys.exit()

    if not menu:
        for events in events1:
            if event.type == MOUSEBUTTONDOWN:
                mouseclick = 1

        if not collisiontest and mouseclick:
            for heros in charactersprites:
                hero.movetarget()
            for mathsters in mathsterGroup:
                mathster.movetarget()
            mouseclick = 0
        screen.fill((50,100,200))
        gamebackground = GameMap()
        if not mapdrawn:
            levelmap = gamebackground.drawmap()
            mapdrawn = 1
        screen.blit(levelmap, (0,0))
        wallGroup.draw(screen)
        nextproblem.update()
        nextproblem.draw(screen)
        charactersprites.update()
        charactersprites.draw(screen)
        screen.fill((50,100,200))
        screen.blit(menubackground, (0,0))
        menusprites.update()
        menusprites.draw(screen)

    pygame.display.flip()
    clock.tick(120) 
```

预先感谢任何愿意看一看并愿意伸出援手的人。我一直在阅读很多教程来尝试自我教育，但我一直无法找到我哪里出错了。

欢迎任何改进我的代码的提示，尽管修复我一动不动的英雄是我的首要任务。

编辑以制定更具体的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:02:36.717

# tile id's

I suggest you use a tuple `(x,y)` for each monster/player's location. Saved as **tile-offset** rather than pixels.

When you draw, convert tile-id to pixels. It'll be ok if its offscreen.

```
def id_to_screen( tile_id width=32, height=32):
    """convert tile-coordinate to screen-coordinate (Pixels)"""
    x,y = tile_id
    x *= width
    y *= height
    return (x, y)         # unless you need: return pygame.Rect(x, y, width, height) 
```

You need the reverse too, which converts mouse location to tile-ids.

```
def screen_to_id( pos, width=32, height=32):
    # converts screen pixel coordinate to world map tile offsets.
    x = pos[0] / width
    y = pos[1] / height
    return (x, y) 
```

# rect

`rect.topleft` is the topleft of where the sprite is blit to. Set this to move the sprite. (Right now you are setting targetx, and reading from `self.rect`.

```
 self.rect.topleft = (384,0)

    # or
    self.rect.move_ip(384,0) 
```

Remove `self.targetx` . Unless you are using it as tile-id locations on the map, instead of pixels. (If you draw a sprite, when it's Rect is offscreen, that's fine.)

Some tips:

```
 self.targetx = self.rect.topleft[0]
    self.targety = self.rect.topleft[1]

    # becomes
    self.target = self.rect.topleft
    # or
    x,y = self.rect.topleft
    # or
    self.tilex, self.tiley = self.rect.topleft 
```

rect virtual attributes are useful. See : [http://www.pygame.org/docs/ref/rect.html#pygame.Rect](http://www.pygame.org/docs/ref/rect.html#pygame.Rect) . They simplify logic / remove some math.

```
 r.bottomleft = (20,30)
    r.left = 500 
```

# numpy + example project

Numpy is useful for multi-dimensional arrays (roguelike 2d tile maps). example uses a numpy array for the map. [http://code.google.com/p/ninmonkey/source/browse/#hg%2Fexamples%2Fmaptiles_numpy%253Fstate%253Dclosed](http://code.google.com/p/ninmonkey/source/browse/#hg%2Fexamples%2Fmaptiles_numpy%253Fstate%253Dclosed)

Run `main.py` , press `s` to toggle scrolling tiles.

# ios - viewDidLoad 和 viewDidAppear 的区别

> ID：11254697
> 
> 赞同：92
> 
> 时间：2012-06-29T00:28:37.240
> 
> 标签：ios

`viewDidLoad`和 和有什么不一样`viewDidAppear`？什么样的初始化或自定义代码进入这些函数？

例如`presentModalViewController`，仅在出现在`viewDidAppear`而不是在 上时才有效`viewDidLoad`。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-06-29T00:37:52.613

`viewDidLoad`当视图控制器第一次加载到内存中时，只调用一次。这是您想要实例化任何实例变量并构建在此视图控制器的整个生命周期中存在的任何视图的地方。但是，此时视图通常还不可见。

`viewDidAppear`当视图实际可见时调用，并且可以在视图控制器的生命周期内多次调用（例如，当模态视图控制器被关闭并且视图再次可见时）。这是您想要在 UI 中执行任何布局操作或进行任何绘图的地方 - 例如，呈现模态视图控制器。但是，您在这里所做的任何事情都应该是可重复的。最好不要在此处保留东西，否则当视图消失时不释放它们会导致内存泄漏。

请参阅：[https ://developer.apple.com/documentation/uikit/uiviewcontroller](https://developer.apple.com/documentation/uikit/uiviewcontroller)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-29T00:30:43.767

简而言之，您会想要在 中创建任何控件或数组`viewDidLoad`，`viewDidAppear`其中您想要刷新这些控件或数组的位置是 in。

**`viewDidLoad`**在创建控制器时调用一次，并**`viewDidAppear`**在每次出现视图时调用，好吧，DID 出现。因此，假设您有一个模态视图，当该视图被关闭时，**`viewDidAppear`**将被调用，并且**`viewDidLoad`**不会被调用。

# .net - 是否有生成流程图的编程方式？

> ID：11254698
> 
> 赞同：-1
> 
> 时间：2012-06-29T00:28:39.997
> 
> 标签：.net, flowchart

最好在 .NET 中，但我对任何事情都持开放态度。我正在考虑您将声明节点和节点路径并将其呈现为图形的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:32:10.960

也许您会对[FlowChart.NET感兴趣。](http://www.mindfusion.eu/flowchart-net.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:40:05.423

我使用了 SyncFusion 的图表工具。他们有一个用于 Winforms、WPF、Silverlight 和 ASP。

我目前正在使用 Nevron 的。他们的适用于 Winforms 和 ASP。

根据您的需要，Codeplex 有一个名为 NShape 的开源软件。

CodeProject 也有一个开源项目。我还没有玩过这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T15:48:20.237

完成这项任务的大多数出色工具都是商业工具，其中一些已经被提及。另一个选项是[yFiles](http://www.yworks.com/en/products_yfiles_dotnetplatform_about.html)，它目前可用于 Windows 窗体、WPF 和 Silverlight。该网站有许多不错的 Silverlight 在线演示（以及 WPF 和 Forms 的截屏视频），当然，您也可以评估该软件。

我非常喜欢 Silverlight BPMN 演示： [http ://www.yworks.com/products/yfilessilverlight/Demo.yFiles.Graph.BusinessProcessDiagram.html](http://www.yworks.com/products/yfilessilverlight/Demo.yFiles.Graph.BusinessProcessDiagram.html)

# android - ViewPager + 回收视图？

> ID：11254701
> 
> 赞同：5
> 
> 时间：2012-06-29T00:29:02.507
> 
> 标签：android, android-viewpager, android-gallery

我想创建一个左右滑动的照片库。起初我看了一下`Gallery`，但它被标记为已弃用。

[http://developer.android.com/reference/android/widget/Gallery.html](http://developer.android.com/reference/android/widget/Gallery.html)

我们被告知要尝试`ViewPager`。但是`PagerAdapter`该类不为我们处理视图的回收（如标准`ListView`），是吗？

[http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html](http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html)

是否由我们来建立回收机制？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T04:13:13.230

> 但是 PagerAdapter 类不为我们处理视图的回收（就像标准的 ListView），是吗？

不，我认为这是因为它是假设您为每个页面使用不同的布局而构建的。

此外，由于它的滚动速度不如 a `ListView`（你不能“扔” a`ViewPager`来跳过多个页面），我认为它不需要回收。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T00:39:02.383

这个[Horizo​​ntalListView](https://github.com/dinocore1/DevsmartLib-Android "水平列表视图")很棒，我用它来做你想做的事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T03:13:37.963

请参阅[此问题](https://stackoverflow.com/questions/7729853/gallery-imageadapter-convertview-is-always-null)的编辑中的链接编辑中的链接以及答案为您提供了一些可能的解决方法。

`HorizontalListView`如果您搜索它，也有一个在线的地方可以很好地替代`Gallery`并回收它的视图。

# sql - Sql：如何使用公式计算表值

> ID：11254710
> 
> 赞同：0
> 
> 时间：2012-06-29T00:30:28.710
> 
> 标签：sql, mysqli

这是原始查询：，它生成带有两列名称（标签，计数）的o / p：

```
label      count 
Fails      1
Pass       3 
```

这是我写的生成上述数据的查询

```
select r.pname as resolution
,lb.label
,count(r.pname) as occurences
from issuelink
inner join jiraissue p on issuelink.source = p.id
inner join jiraissue c on issuelink.destination = c.id
inner join issuelinktype t on issuelink.linktype = t.id
inner join resolution r on c.resolution = r.id
inner join issuestatus istat on p.issuestatus = istat.sequence
inner join label lb on c.id = lb.issue
where t.linkname = 'jira_subtask_link'
and p.pkey in (@pkey)
and c.issuetype in ('13')
and r.pname not in ('Fails Smoke Test - General Failure', 'Fails Smoke Test - New Firmware Available')
and label in ('SmokeTest', 'fullcert', 'bfv', 'papercert')
group by r.pname; 
```

根据您的建议，我尝试使用交叉函数，但是它引发了“请检查语法”的错误：

```
select  100.0 * fail.cnt / (fail.cnt + pass.cnt) as c
from    (
        select  r.pname as label
        ,       count(r.pname) as cnt
        from issuelink
        inner join jiraissue p on issuelink.source = p.id
        inner join jiraissue c on issuelink.destination = c.id
        inner join issuelinktype t on issuelink.linktype = t.id
        inner join resolution r on c.resolution = r.id
        inner join issuestatus istat on p.issuestatus = istat.sequence
        inner join label lb on c.id = lb.issue
        where t.linkname = 'jira_subtask_link'
        and p.pkey in ('SRPDTVTPV-3')
        and c.issuetype in ('13')
        and r.pname not in ('Fails Smoke Test - General Failure', 'Fails Smoke Test - New Firmware Available')
        and label in ('SmokeTest', 'fullcert', 'bfv', 'papercert')
        group by r.pname
        ) as fail
cross join    
        (
        select  r.pname as label
        ,       count(r.pname) as cnt
        from issuelink
        inner join jiraissue p on issuelink.source = p.id
        inner join jiraissue c on issuelink.destination = c.id
        inner join issuelinktype t on issuelink.linktype = t.id
        inner join resolution r on c.resolution = r.id
        inner join issuestatus istat on p.issuestatus = istat.sequence
        inner join label lb on c.id = lb.issue
        where t.linkname = 'jira_subtask_link'
        and p.pkey in ('SRPDTVTPV-3')
        and c.issuetype in ('13')
        and r.pname not in ('Fails Smoke Test - General Failure', 'Fails Smoke Test - New Firmware Available')
        and label in ('SmokeTest', 'fullcert', 'bfv', 'papercert')

        group by r.pname
        ) as pass
where   fail.label = 'Fails Certification'
        and pass.label = 'Passes Certification' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:32:50.667

这是使用 a 的一种方法`cross join`：

```
select  100.0 * a.count / (a.count + b.count) as c
from    YourQuery a
cross join    
        YourQuery b
where   a.label = 'a'
        and b.label = 'b' 
```

这是另一种使用聚合的方法，有点棘手，但只使用一次 YourQuery：

```
select  100.0 * cnt_a / (cnt_a + cnt_b) as c
from    (
        select  max(case when label = 'a' then count end) as cnt_a
        ,       max(case when label = 'b' then count end) as cnt_b
        from    YourQuery
        ) as SubQueryAlias 
```

# wordpress - 在单个页面上显示 WordPress 博客的所有评论？

> ID：11254719
> 
> 赞同：1
> 
> 时间：2012-06-29T00:31:37.530
> 
> 标签：wordpress

我需要什么 - 执行以下操作的代码：

我正在尝试设置一个 WordPress 模板，该模板将显示已发布到我的博客的所有评论。如何提取所有评论并具有应用于单个帖子下评论的所有相同格式？例如使用 comments.php 模板显示评论时发生的格式。

注意我想把我博客中的所有评论都拉到一个页面上。我仍然想要评论分页，但不是在帖子 #1 下有 20 条评论，在帖子 #2 下有 20 条评论，等等。我想让所有 40 条评论同时出现在一个页面上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T03:36:55.153

您想使用[get_comments()](http://codex.wordpress.org/Function_Reference/get_comments)函数。

```
<?php foreach (get_comments() as $comment): ?>
<div><?php echo $comment->comment_author; ?> said: "<?php echo $comment->comment_content; ?>".</div>
<?php endforeach; ?> 
```

另请参阅[apply_filters()](http://codex.wordpress.org/Function_Reference/apply_filters)函数以将[评论输出过滤器](http://codex.wordpress.org/Plugin_API/Filter_Reference#Comment.2C_Trackback.2C_and_Ping_Filters)应用于特定字段。

```
<?php echo apply_filters('comment_text', $comment->comment_content); ?> 
```

**编辑：**

对于分页，您可以使用 get_comments() 参数的偏移量和数字参数：

```
<?php 
    $args = array(
        'number'=>20,
        'offset'=>0,
        'status'=>'approve',
    );
    foreach (get_comments($args) as $comment) {
        // ...
    }
?> 
```

# jquery - Jquery Formatting - 在另一个完成后运行函数

> ID：11254720
> 
> 赞同：1
> 
> 时间：2012-06-29T00:31:41.030
> 
> 标签：jquery

我有两个 jQuery 函数。我想先运行下面的第一个，然后在该函数完成后运行另一个。通常我会在第一段代码中添加一个函数，但不确定如何使用这个块或者它是否是正确的方法。

所以简而言之，我希望这段代码运行......

```
$('#setupPanel').modal({
        backdrop: "static",
        keyboard: false
}); 
```

在此函数完成执行后...

```
$('html, body').animate({
        scrollTop: $("#header_wrap").offset().top
}, 600); 
```

**编辑：** 这是整个功能...

```
$(setUp).click(function () {
    $('html, body').animate({
        scrollTop: $("#header_wrap").offset().top
    }, 600);
    $('#setupPanel').modal({
        backdrop: "static",
        keyboard: false
    });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T00:34:24.180

你可以试试[`promise()`](http://api.jquery.com/promise/)方法：

```
$(setUp).click(function () {
    $('#setupPanel').modal({
        backdrop: "static",
        keyboard: false
    }).promise().done(function() {
        $('html, body').animate({
            scrollTop: $("#header_wrap").offset().top
        }, 600);    
      });
}); 
```

**更新：**

您还可以使用`.animate()`方法的回调函数：

```
$(setUp).click(function () {
        $('html, body').animate({
            scrollTop: $("#header_wrap").offset().top
        }, 600, function() {
          $('#setupPanel').modal({
              backdrop: "static",
              keyboard: false
          })
      }});
}); 
```

# php - PHP 5.3 lambda 匿名函数不起作用

> ID：11254721
> 
> 赞同：3
> 
> 时间：2012-06-29T00:31:42.917
> 
> 标签：php, function, lambda

我无法弄清楚这里出了什么问题。这是我的 test.php 文件：

```
<?php
error_reporting(E_ALL);
echo phpversion();
$arr = array ();

$attrs = array_filter((array)$arr, function($v) {
    return ($v || $v === 0 || $v === '0');
}); 
```

这个脚本的输出是：

5.3.3 警告：array_filter() 期望参数 2 是一个有效的回调，在第 8 行的 /path/test.php 中没有给出数组或字符串

这个怎么可能？我认为 PHP 5.3 支持 lambdas。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T15:49:04.143

这与 eAccelerator 中的一个错误有关，该错误在缓存使用 lambda 的操作码时存在问题。更新到最新版本的 eAccelerator 并已修复。

# selenium - 加载网页时硒不运行

> ID：11254730
> 
> 赞同：0
> 
> 时间：2012-06-29T00:33:10.183
> 
> 标签：selenium, selenium-rc, selenium-grid

我正在运行一些测试，我必须通过单击“重新启动”按钮来重新启动服务器。在它附近显示一个小文本，它将显示服务器的状态。

在点击“restart”按钮之前，文字显示“running”，点击后，整个网页一直在加载，文字显示“restarting”。页面停止加载后，服务器再次成功开始运行，文字显示“正在运行”。

我必须编写一个测试用例，检查单击“重新启动”按钮时文本是否显示“重新启动”。但不幸的是，我无法找到一种方法让 selenium 检查文本是否显示“正在重新启动”，因为当时网页正在加载，它无法执行任何操作。

任何人都可以通过向我展示如何在网页加载时让 selenium 运行来帮助我吗？我在谷歌搜索中没有得到很好的回复。如果有人可以帮助我，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T01:00:49.103

通常，即使网页仍在加载，您也可以驱动浏览器。我建议找到“重新启动”的元素并一直检查它直到 60 秒

在红宝石中，你会做类似的事情

等待 = Selenium::WebDriver::Wait.new(:timeout => X) wait.until {driver.find_element(:id => 'restart_word')}

其中 X 是等待的秒数。

X 秒后，它将超时。

# php - 使用 php 将类添加到 li 然后每第三项后交替？

> ID：11254731
> 
> 赞同：3
> 
> 时间：2012-06-29T00:33:22.713
> 
> 标签：php, css, addclass

这可能非常简单，但我正在尝试找出一种方法将一个类添加到无序列表中，然后在每第三个项目之后交替该类..

我只设法在每三个项目上添加一个类（这不是我想要的），但这是我的代码：

```
<?php $i=1; foreach($this->items as $item) : ?>
      <li class="<?php if ($i % 3 == 0) : ?>odd<?php endif; ?>"><a href="<?php echo $linky; ?>">xxx</a></li>
<?php $i++; endforeach; ?> 
```

吐出：

```
<li class="">xxx</li>
<li class="">xxx</li>
<li class="odd">xxx</li>
<li class="">xxx</li>
<li class="">xxx</li>
<li class="odd">xxx</li> 
```

但我希望得到的是：

```
<li class="odd">xxx</li>
<li class="odd">xxx</li>
<li class="odd">xxx</li>
<li class="even">xxx</li>
<li class="even">xxx</li>
<li class="even">xxx</li> 
```

等等.. 通常我会使用 jquery 来做这样的事情，但在这种情况下我必须使用 php.. 任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T00:39:52.757

使用每次翻转（否定）的布尔标志`$i % 3 == 0`：

```
// Start with 0 instead of 1
$i=0;
// Flag starts TRUE
$state = TRUE;
foreach ($this->items as $item) {
  if ($i % 3 === 0) {
    // Flip to opposite state
    $state = !$state;
  }
  ?>
  <li class="<?php if ($state) : ?>odd<?php else: ?>even<?php endif; ?>"><a href="<?php echo $linky; ?>">xxx</a></li> 
  <?php
  $i++;
} 
```

[这是一个演示](http://codepad.viper-7.com/HvxDm3)。尽管您需要检查输出以查看类的变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T00:39:51.457

您使用了错误的运算符。

```
if ($i % 3 == 0) 
```

表示“如果 $i 除以 3 的余数为 0”。

你想要的是

```
if (floor($i/3) == 0). 
```

试一试，看看效果如何。

编辑：您似乎也缺少“其他”代码。如果你没有那个，它不会为非“奇数”类写“偶数”。

编辑编辑：如果您希望模式继续，请使用：

```
if ((floor($i/3) % 2) == 0). 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T00:42:23.167

我假设您希望第 7 项是“奇数”？我写了 JavaScript，但应该很容易转换为 PHP

[**演示**](http://jsfiddle.net/LNx39/)

```
for (var i = 0; ​i < 15; i++) {
    if(i%6 < 3) {
document.write("odd<br>");
    }
    else {
document.write("even<br>")     
    }        
}​ 
```

将您的代码更改为：

```
<?php $i=0; foreach($this->items as $item) : ?>
      <li class="<?php if ($i % 6 < 3) : ?>odd<?php else: ?>even<?php endif; ?>"><a href="<?php echo $linky; ?>">xxx</a></li>
<?php $i++; endforeach; ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T01:30:15.160

另一种方法是使用新的 CSS3 选择器，它允许您定位奇数和偶数子元素。

这是一个带有示例的链接。基本上，你会像往常一样拥有你的清单。

```
<ul>
<li></li>
<li></li>
</ul> 
```

然后，您可以使用像这样的新选择器，而不是拥有一个名为奇数甚至不同样式的类...

```
li:nth-child(even) { background: #fff; }
li:nth-child(odd) { background:#000; } 
```

这将使所有偶数列表项的背景为#fff，所有奇数列表项的背景为#000。

**编辑：您可以使用其他几个 CSS3 选择器仅在前两个使用 1st-child 和 2nd-child 之后定位偶数和赔率。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T00:40:08.413

尝试在 for 循环中嵌套 for each 循环。外部循环告诉迭代多少次，内部循环告诉放置奇数和偶数多少次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T00:44:46.823

您只打印循环的每三次迭代的原因是您正在使用模数运算符`"%"`来测试 i 是否可被三整除`($i % 3 == 0)`。这导致仅当 $i 可被 3 整除时才打印。

要解决您的问题：

```
<?php
$odd = "<li class='odd'>";
$even = "<li class='even'>";
$i = 0;

foreach($this->items as $item)
{
  if($i < 3)
    echo $odd . $item . "</li>";
  else if($i >= 3)
    echo $even . $item . "</li>";
  $i++;
  if($i > 5)
    $i = 0;
}
?> 
```

请注意，由于 $i 从 0 开始，前 3 个项目将被索引为 0 - 2，随后的 3 个项目将被索引为 3 - 5。

# git - Git可以差异存储GZip文件吗？

> ID：11254733
> 
> 赞同：6
> 
> 时间：2012-06-29T00:33:56.843
> 
> 标签：git, gzip

Git 是否将使用 Gzip 压缩的文本存储为二进制文件，或者它可以判断它是文本并存储文件更新之间的更改？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T00:39:25.480

Git 不会尝试查看任何二进制文件。事实上，它甚至不尝试查看文本文件。它根本不存储更新。它所做的是存储每个文件的全部内容，但它在整个对象存储中进行[增量压缩。](http://en.wikipedia.org/wiki/Delta_encoding)所以存储在磁盘上的数据实际上只是更新（因此是“增量压缩”），但 Git 本身会看到完整的文件。

也就是说，不，Git 不会尝试解压缩 gzip 压缩的文件以重新压缩自身。这意味着使用 gzip 压缩的文本将具有与任何其他压缩格式（例如图像）大致相同的性能，也就是说，不会有太多的节省。

# makefile - 当 makefile 规则的目标是 foreach 函数时停止错误

> ID：11254743
> 
> 赞同：10
> 
> 时间：2012-06-29T00:37:06.947
> 
> 标签：makefile, gnu-make

我有一个makefile，它定义了几个目标是foreach 函数的规则。

```
$(foreach var,$(list), $($(var)_stuff) $($(var)_more_stuff)):
    @echo Building $@ from $^...
    $(CC) $(FLAGS) ... 
```

有没有办法让 make 在遇到错误而不遍历整个列表时退出。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-06T03:43:43.070

`exit`一种解决方法是在失败时“手动”调用。

例如，假设我们有一个目录，其中包含我们要执行`scripts`的许多 shell 脚本（文件名以 结尾）。`.sh`

然后是这样的变量声明：

```
LIST_OF_SCRIPTS ?= $(wildcard scripts/*.sh) 
```

将为我们提供这些脚本的列表，以及这样的目标：

```
run-all-scripts
  @$(foreach scriptfile,$(LIST_OF_SCRIPTS),$(scriptfile);) 
```

将运行所有这些脚本，但正如您所注意到的，无论其中一个脚本是否返回错误代码，foreach 循环都将继续进行。在命令中添加 a`|| exit`将强制子命令在出错时退出，然后 Make 会将其视为失败。

例如，

```
run-all-scripts
  @$(foreach scriptfile,$(LIST_OF_SCRIPTS),$(scriptfile) || exit;) 
```

会做你想做的（我相信）。

具体来说，使用您的伪代码示例，我认为您想要这样的东西：

```
$(foreach var,$(list), $($(var)_stuff) $($(var)_more_stuff)):
    @echo Building $@ from $^...
    ($(CC) $(FLAGS) ...) || exit 
```

（我所做的只是将`(CC) $(FLAGS) ...`位包装在括号中并附`|| exit`加以使其因错误而失败）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-29T09:07:09.253

*在执行任何*规则之前，它`foreach`会被完全评估和替换。因此，这种行为应该与您在不使用. 换句话说，它与问题没有直接关系。*`foreach`*

 *对于您所看到的内容，只有几种可能的解释，主要在[此处](http://www.gnu.org/software/make/manual/make.html#Errors)的手册中进行了描述：

*   您正在运行 Make`-k`或`--keep-going`
*   您正在运行 Make`-i`或`--ignore-errors`
*   您的目标被定义为特殊`.IGNORE`目标的先决条件
*   你的食谱以`-`
*   您的食谱实际上并未返回非零退出状态

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-23T10:11:54.267

不确定您的示例，但可能问题出在`;`- 查看[Makefile ：显示并执行](https://stackoverflow.com/questions/6498727/makefile-show-and-execute)：

```
dirs = $(shell ls)
clean:
    $(foreach dir,$(dirs),echo $(dir);) 
```

生产：

```
$ make clean
echo bin; echo install.sh; echo Makefile; echo README.md; echo utils; 
```

所以只检查最后一个命令的退出代码：`echo utils`。*

# java - java.sql.SQLException: [Microsoft][ODBC Microsoft Access > Driver] 参数太少。预计 1

> ID：11254745
> 
> 赞同：0
> 
> 时间：2012-06-29T00:38:07.280
> 
> 标签：java, jsp

我正在 从要在数据库中插入数据的位置调用`InserStudent.jsp`表单中的文件。`AddStudent.jsp`

我的数据库表结构如下：

```
ID|Name|RollNumber|PhoneNumber|StudyProgram|Status 
```

下面是代码`InserStudent.jsp`

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@ page import="java.sql.*" %>
<!DOCTYPE html>
<html>   
<body>

    <%
     String nam=request.getParameter("stuname");  
     String roll=request.getParameter("sturoll");  
     String phone=request.getParameter("stuphone");  
     String prog=request.getParameter("stuprogram");  
     String stats=request.getParameter("stustatus");
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
String url =  "jdbc:odbc:stdProjectDataDSN";
Connection c = DriverManager.getConnection(url);
Statement statement = c.createStatement() ;
String sql = "insert into students (ID, NAME, RollNumber, PhoneNumber, StudyProgram, Status )";
sql += "values ( '"+ nam +"','"+ nam +"','"+ roll +"','"+ phone +"','"+ prog +"',"+ stats +" )";
statement.execute ( sql );
c.close();
response.sendRedirect("ManageAllStudent.jsp");
    %>
 </body>
</html> 
```

这会导致以下异常：

> **HTTP 状态 500**
> 
> 类型异常报告
> 
> 信息
> 
> 描述 服务器遇到一个内部错误 () 阻止它完成这个请求。
> 
> 例外
> 
> org.apache.jasper.JasperException：在第 27 行处理 JSP 页面 /web/InserStudent.jsp 时发生异常
> 
> 24: 语句语句 = c.createStatement() ;
> 25: String sql = "插入学生(ID, NAME, RollNumber, PhoneNumber, StudyProgram, Status)";
> 26: sql += "values ('"+ nam +"','"+ nam +"','"+ roll +"','"+ phone +"','"+ prog +"',"+统计数据 +" )";
> 
> 27：statement.execute（sql）；
> 28: c.close(); 29:30：response.sendRedirect("ManageAllStudent.jsp");
> 
> 堆栈跟踪：org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:521) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:412) org.apache.jasper.servlet.JspServlet.serviceJspFile( JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
> 
> 根本原因
> 
> javax.servlet.ServletException: java.sql.SQLException: [Microsoft][ODBC Microsoft Access > Driver] 参数太少。预期 1\. 注意 Apache Tomcat/6.0.35 logs.javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 中提供了根本原因的完整堆栈跟踪

我错过了什么或我做错了什么？在`ShowAllStudent.jsp`页面中，它显示了我使用相同脚本的数据库中的所有数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:56:36.283

您不应该在`JSP`（阅读 SO FAQ -[如何避免 JSP 中的 Java 代码](https://stackoverflow.com/a/3180202/142822)）中编写 Java 代码。您必须添加`Servlet`才能执行数据库操作。

除此之外，您还必须了解 JDBC API 的工作原理，并且正如 @BalusC 所说，您的代码是 sql 注入漏洞的受害者。为避免 SQL 注入，请使用 PrepreadStatement（参数化查询）。

```
Connection cn=null;
PreparedStatement ps=null;

Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
String url =  "jdbc:odbc:stdProjectDataDSN";
Connection c = DriverManager.getConnection(url);

try{
  String sql="insert into students (ID,NAME,RollNumber,PhoneNumber,StudyProgram,Status) 
               Values (?,?,?,?,?,?)";
  ps=cn.prepareStatement(sql);
  ps.setInt(1,10);
  ps.setString(2,nam);
  ...
  ps.executeUpdate()
}catch(SQLException ex){

}finally{
  if(ps!=null){
     try { ps.close(); } catch(Exception ex) {}
  }
  if(cn!=null){
     try { cn.close(); } catch(Exception ex) {}
  }
} 
```

PS：如果该列`ID`是自动生成的数字，则不要包含在您的列集中。

```
 String sql="insert into students (NAME,RollNumber,PhoneNumber,StudyProgram,Status) 
                   Values (?,?,?,?,?)"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T00:12:36.857

我得到了我所缺少的我没有在控制面板->管理工具中配置我的数据库...

所以当我设置它时它就可以工作:)

# c++ - 为什么单链表的 Next() 操作应该用临界区来保护？

> ID：11254749
> 
> 赞同：2
> 
> 时间：2012-06-29T00:38:38.277
> 
> 标签：c++, multithreading, winapi

我正在阅读*Win32 中的多线程应用程序一书*

书中说`return node->next`将被编译成单独的机器指令，不会作为原子操作执行，因此`Next()`也应该受到临界区的保护。

我的问题是，它可以被翻译成什么指令来导致竞争条件？

```
typedef struct _Node
{
    struct Node *next;
    int data;
} Node;

typedef struct _List
{
    Node *head;
    CRITICAL SECTION critical_sec;
} List;

List *CreateList()
{
    List *pList = malloc(sizeof(List));
    pList->head = NULL;
    InitializeCriticalSection(&pList->critical_sec);
    return pList;
}

void DeleteList(List *pList)
{
    DeleteCriticalSection(&pList->critical_sec);
    free(pList);
}

void AddHead(List *pList, Node *node)
{
    EnterCriticalSection(&pList->critical_sec);
    node->next = pList->head;
    pList->head = node;
    LeaveCriticalSection(&pList->critical_sec);
}

void Insert(List *pList, Node *afterNode, Node *newNode)
{
    EnterCriticalSection(&pList->critical_sec);
    if (afterNode == NULL)
    {
        AddHead(pList, newNode);
    }
    else
    {
        newNode->next = afterNode->next;
        afterNode->next = newNode;
    }
    LeaveCriticalSection(&pList->critical_sec);
}

Node *Next(List *pList, Node *node)
{
    Node* next;
    EnterCriticalSection(&pList->critical_sec);
    next = node->next;
    LeaveCriticalSection(&pList->critical_sec);
    return next;
} 
```

**编辑：**

好的，尽管在这种特殊情况下它不会破坏单链表而不会保护`Next()`操作，但通常应该对共享结构进行整体保护或不保护。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T00:42:46.317

`return node->next` performs two operations; it first loads the `struct` pointed to by `node` into memory, then looks at the `node+offsetof(next)` to find the pointer `next`, load that into a register, and then return to the calling program. The contents of `node` may be manipulated by another thread of execution in the meantime.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:51:50.343

1.  Yes, you absolutely need to protect your "next" with a lock in a multithreaded application.

... HOWEVER ...

1.  "Writers" (like add or remove node) *MUST* be mutually exclusive. Critical section is a good choice.

2.  "Readers" (like "next") can run concurrently with each other.

SUGGESTION:

If you can target Windows Vista or higher, consider using an SRW lock instead:

*   [http://msdn.microsoft.com/en-us/library/aa904937%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa904937%28VS.85%29.aspx)

*   [http://msdn.microsoft.com/en-us/magazine/cc163405.aspx](http://msdn.microsoft.com/en-us/magazine/cc163405.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T00:53:28.223

While I think the answer by sarnold is correct, I just wanted to point out that the sizeof() call in your malloc() call in CreateList appears to have a bug. I believe it should be:

```
List *pList = malloc(sizeof(List)); 
```

The way you had it, you will create enough memory to hold a *pointer* to a List and not the List structure. (You may also want to cast the return type to (List*) and compare it to NULL before using it..)

# ios - 旋转到横向时拉伸 UIToolbar 背景图像

> ID：11254751
> 
> 赞同：2
> 
> 时间：2012-06-29T00:38:51.807
> 
> 标签：ios, xcode, ipad

我正在使用以下代码将图像添加到 App Delegate 中的 UIToolbar 的背景中：

```
[[UIToolbar appearance] setBackgroundImage:
[UIImage imageNamed:@"toolbarbackground.png"] 
                             forToolbarPosition:0 barMetrics:UIBarMetricsDefault]; 
```

图像宽度为 768 像素（纵向时 iPad 屏幕宽度的大小）。当我旋转到横向时，图像不会拉伸以填充新的屏幕宽度（1024 像素）。如何在旋转时拉伸以适应屏幕的 UIToolbar 上的自定义背景图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T23:26:22.620

工具栏是否自动调整大小？如果不是，请设置它的自动调整大小掩码：

`[myToolbar setAutoresizingMask: UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleRightMargin]`

如果工具栏自动调整大小而图像仍然没有，则将`contentMode`图像视图的 设置为`UIViewContentModeScaleToFill`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T06:18:07.917

```
UIImage *navBarImagePortrait = [UIImage imageNamed:@"navbar-portrait"];
navBarImagePortrait = [navBarImagePortrait resizableImageWithCapInsets:UIEdgeInsetsMake(1, 0, 0, 2)];
UIImage *navBarImageLandscape = [UIImage imageNamed:@"navbar-landscape"];
navBarImageLandscape = [navBarImageLandscape resizableImageWithCapInsets:UIEdgeInsetsMake(1, 0, 0, 2)];

// custom NaviagionBar
[self.toobar setBackgroundImage:navBarImagePortrait forToolbarPosition:UIToolbarPositionAny barMetrics:UIBarMetricsDefault];
[self.toobar setBackgroundImage:navBarImageLandscape forToolbarPosition:UIToolbarPositionAny barMetrics:UIBarMetricsLandscapePhone]; 
```

# matlab - 常微分方程表示中的错误

> ID：11254753
> 
> 赞同：0
> 
> 时间：2012-06-29T00:39:08.543
> 
> 标签：matlab, ode, differential-equations

**更新** 我试图找到链接[LE](http://www.mathworks.com/matlabcentral/fileexchange/4628-calculation-lyapunov-exponents-for-ode)中给出的 Lyapunov 指数。我试图通过为我的案例采用以下 eqs 来弄清楚并理解它。这些是一组常微分方程（这些仅用于测试如何使用 cos 和 sin 作为 ODE）

```
f(1)=ALPHA*(y-x);
f(2)=x*(R-z)-y;
f(3) = 10*cos(x); 
```

和`x=X(1); y=X(2); cos(y)=X(3);`

f1 表示`dx/dt`;f2`dy/dt`和 f3 在这种情况下是`-10sinx`. 但是，当表示为 x=X(1);y=X(2);时，我不确定如何表示 cos。这只是一个试验示例，我这样做是为了了解如何处理我们有cos，sin 等术语作为另一个变量的函数。

使用 ode45 求解这些方程时

```
[T,Res]=sol(3,@test_eq,@ode45,0,0.01,20,[7 2 100 ],10); 
```

它引发以下错误

？？？尝试访问 (2)；index 必须是正整数或逻辑整数。

```
Error in ==> Eq at 19
x=X(1); y=X(2); cos(x)=X(3); 
```

1.  我的代表`x=X(1); y=X(2); cos(y)=X(3);`还好吗？
2.  如何解决错误？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T08:33:30.177

不，您的陈述是完全错误的。您不可能以这种方式设置值！`X(3)`首先，您尝试为*函数*赋值。

首先，我不确定您是否理解两者之间的区别

```
x=4 
```

和

```
4=x 
```

这是完全不同的含义。如果你理解这一点，你会发现你不可能使用`cos(x)=X(3)`.

`sol()`第二：你调用的函数是什么？你定义了吗？

第三，要求解或评估 ODE，您应该在 matlab中使用`deval`或函数。`solve`他们的帮助文件应该给你例子。

# visual-c++ - 有没有办法覆盖当用户单击 CListCtrl 中的复选框时调用的处理程序？(MFC)

> ID：11254754
> 
> 赞同：1
> 
> 时间：2012-06-29T00:39:13.013
> 
> 标签：visual-c++, mfc, clistctrl

我试图禁用用户更改列表控件中复选框状态的能力。我目前正在务实地改变状态。我已经处理了该`LVN_ITEMCHANGED`消息，并且由于程序其余部分的布局，尝试更改状态没有选项。我还尝试在用户单击列表控件并简单地重置那里的复选框时进行 HitTest，但这并没有给我我正在寻找的确切结果。

当用户单击复选框本身时，是否发送了特定消息或我可以覆盖的功能？我只想覆盖处理程序或捕获消息，以便它不会去任何地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:45:07.197

**解决方案：**

我最终删除了`LVS_EX_CHECKBOXES`标志并创建了自己的实现。这样，只有一种方法可以更改图标。阅读上一个问题的链接给了我一个设置“忙碌”标志的想法，否则我会收到堆栈溢出错误。

```
// In my dialog class
m_CListCtrl.SetImageList(&m_ImgList, LVSIL_SMALL);    // Custom checkboxes (only two images)

// ...
void CMyDialog::OnLvnItemchangedList(NMHDR *pNMHDR, LRESULT *pResult)
{
   if(busy) { return; }
   // ....
} 

// When calling the SetCheck function:
busy = TRUE;   // Avoid stack overflow errors
m_CListCtrl.SetCheck(index, fCheck);
busy = FALSE;

// I derived a class from CListCtrl and did an override on the get/set check:
class CCustomListCtrl : public CListCtrl
{
    BOOL CCustomListCtrl::SetCheck(int nItem, BOOL fCheck)
    {
        TCHAR szBuf[1024];
        DWORD ccBuf(1024);
        LVITEM lvi;
        lvi.iItem = nItem;
        lvi.iSubItem = 0;
        lvi.mask = LVIF_TEXT | LVIF_IMAGE;
        lvi.pszText = szBuf;
        lvi.cchTextMax = ccBuf;
        GetItem(&lvi);
        lvi.iImage = (int)fCheck;
        SetItem(&lvi);
        return TRUE;
    }
    // Just need to determine which image is set in the list control for the item
    BOOL CCustomListCtrl::GetCheck(int nItem)
    {
        LVITEM lvi;
        lvi.iItem = nItem;
        lvi.iSubItem = 0;
        lvi.mask = LVIF_IMAGE;
        GetItem(&lvi);
        return (BOOL)(lvi.iImage);
    }
} 
```

这并不像我希望的那样优雅，但它完美无瑕。

# jquery - 页眉、主页、页脚拉伸以填充页面

> ID：11254755
> 
> 赞同：2
> 
> 时间：2012-06-29T00:39:15.747
> 
> 标签：jquery, css, html, positioning

我想要以下类型的 HTML：

```
<header></header>
<div id='main'></div>
<footer></footer> 
```

其中所有都优选地相对定位。页眉和页脚将具有已知的高度。我希望主 div 默认填满整个页面，页眉位于页面的最顶部，页脚位于页面的最底部。

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T01:35:42.743

使用jQuery：

```
$(function() {
     var height = $(window).height() - ($("header").outerHeight() + $("footer").outerHeight());
     $("#main").css("min-height",height+"px");
}); 
```

我们所做的基本上是将主 div 高度设置为浏览器视口高度并减去页眉和页脚的高度。

我希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T00:46:37.867

编辑：与其将你的主要内容拉伸到 90%，不如设置它可能更容易

```
style='height:100%; margin-top=[header height]; margin-bottom=[footer height]' 
```

因为这将使您的主页面保持一整页的长度，并且页眉和页脚不会重叠内容。试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T02:09:44.080

如果我正确理解您的问题，则该解决方案似乎正在实施

```
header {position: fixed;}

#main {min-height: 100%;}

footer {position: fixed;} 
```

在此处查看完整示例：http: [//jsfiddle.net/J4jDu/1/](http://jsfiddle.net/J4jDu/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T03:52:41.023

这是我一直以来最喜欢的解决方案之一。

[http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)

基本上你有一个 100% 最小高度的包装器，然后你在底部构建页脚，在顶部构建页眉，中间的内容将填充其余部分。

# xml - 如何使用插件打包我的 joomla 2.5 组件？

> ID：11254758
> 
> 赞同：3
> 
> 时间：2012-06-29T00:39:32.923
> 
> 标签：xml, plugins, joomla, components, package

[我还在学习 joomla，我想知道如何在 pkg_youcomponent.xml 安装文件](https://docs.joomla.org/Package)中安装带有组件的插件。我注意到 Joomla![Joomla 1.6](../Images/2386078a8f024bd0461c73e12ee67162.png)或更高版本可以`folder="packages"`在`files`.

我正在尝试将[Rocket Theme RokBox 插件](https://rockettheme.com/joomla/extensions/rokbox)与我的组件打包在一起。但我运气不太好。

这是**pkg_autobase**的 zip 预览。

[![pkg_autobase 的 Zip 预览](../Images/bc8c491f29482af3aacc0de7fbf10f7a.png)](https://i.stack.imgur.com/8KW6v.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/df43tkzb.2ib.png)）]

这里是基于此的包[脚本](https://docs.joomla.org/Package)。

```
<?xml version="1.0" encoding="UTF-8" ?>
<extension type="package" version="1.6">
<name>Autobase</name>
<author>Michael Jones</author>
<creationDate>May 2012</creationDate>
<packagename>autobase</packagename>
<version>1.0.0</version>
<url>http://www.triotech.co.nz/</url>
<packager>Michael Jones</packager>
<packagerurl>http://www.triotech.co.nz/</packagerurl>
<description>Package installer for AutoBase and RokBox Gallery Manager</description>
<update>http://www.triotech.co.nz/update</update>
<files folder="packages">
   <file type="component" id="autobase" >com_autobase.zip</file>
   <file type="plugin" id="rokbox" group="system">plg_sys_rokbox.zip</file>
</files>
</extension> 
```

现在我不确定的是.. joomla 2.5 扩展管理器报告错误

```
 Install path does not exist
    Package Install: There was an error installing an extension: com_autobase.zip 
```

但据我所知，我已经正确打包了所有东西（两者都`component`可以`plugin`单独安装）。因此，我想知道您如何正确打包组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:59:49.263

1.  包 xml 中引用的每个 zip 文件都必须是有效的安装文件。
2.  该错误实际上是指您的 XML 指定 zip 位于名为的目录中，`packages`但您的屏幕截图显示它们与包清单 xml 处于同一级别。

您可以通过将它们放在名为`packages`（推荐的方式）的目录中或`folder="packages"`从`<files>`元素中删除来解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T06:29:50.243

应该有包含所有插件和组件的 packages 文件夹，因为您在 xml 中提到过`<files folder="packages">`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-28T06:35:26.417

您可以使用第三方组件，例如[http://joomlatoys.com/index.php/toys/jtbuilder](http://joomlatoys.com/index.php/toys/jtbuilder)，它可以打包选定的扩展并为您生成可安装的存档。

# windows - windows中有没有办法根据python的要求抛出蓝屏？

> ID：11254763
> 
> 赞同：4
> 
> 时间：2012-06-29T00:39:55.477
> 
> 标签：windows, automated-tests, bsod

我正在制作一个脚本来测试一些一直在运行的软件，我想测试它从 BSOD 中恢复。有没有办法在不调用外部脚本或可执行文件（如 OSR 的 BANG！

# powershell - 防止在 powershell 脚本中显示其他窗口

> ID：11254764
> 
> 赞同：0
> 
> 时间：2012-06-29T00:39:56.777
> 
> 标签：powershell, powershell-2.0

这里的想法是静默卸载程序。不幸的是，该程序的 msi 是自定义的，并且在卸载过程中会执行一个批处理文件。我想要做的是防止在 powershell 卸载脚本期间显示此窗口。我正在使用 wmi 卸载方法，因为程序使用的 msi 不会完全响应或卸载标志（/q、/x、/uninstall）。我试图将它作为后台作业运行，但窗口仍然出现。该脚本如下所示：

```
start-job -scriptblock `
    {(Get-WmiObject -class Win32_Product |? {$_Name -eq "Annoying1"}).uninstall()} `
    -Name Uninstall1
$job = get-job -name Uninstall1
wait-job $job
receive-job $job 
```

这将在很大程度上隐藏运行，直到卸载作业到达执行批处理文件的位置，此时将出现并运行一个 cmd 窗口。关于如何在不显示额外窗口的情况下运行此脚本的任何想法？

该脚本也运行`-windowstyle hidden`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T03:42:28.427

放纵一下，我对此并不感到自豪，但我很确定如果您尝试使用远程处理在本地运行您的脚本，用户将不会看到该窗口：

我只是尝试：

```
$sess = New-PSSession -ComputerName localhost
Invoke-Command -Session $sess -ScriptBlock {calc.exe}
get-process "calc" 
```

在你的情况下尝试：

```
$sess = New-PSSession -ComputerName localhost
$job = Invoke-Command -Session $sess -ScriptBlock {(Get-WmiObject -class Win32_Product |? {$_Name -eq "Annoying1"}).uninstall()} -asjob -Name Uninstall1
wait-job $job
receive-job $job 
```

# python - 将 psql 类型 oid 映射到 python 类型 - 使用 psycopg2

> ID：11254769
> 
> 赞同：8
> 
> 时间：2012-06-29T00:40:37.130
> 
> 标签：python, postgresql, psycopg2

这是故事。

我有一堆存储过程，并且都有自己的参数类型。
我要做的是在 python 中创建一个类型安全层，这样我就可以在访问数据库之前确保所有值的类型都是正确的。

当然，我不想在 python 中再次编写整个模式，所以我想我可以通过从数据库中获取参数名称和类型在启动时自动生成这些信息。

所以我继续破解这个查询只是为了测试

```
SELECT proname, proargnames, proargtypes 
FROM pg_catalog.pg_namespace n
JOIN pg_catalog.pg_proc p
ON pronamespace = n.oid
WHERE nspname = 'public'; 
```

然后我从 python 运行它，对于'proargtypes'，我为每个结果得到一个这样的字符串

```
'1043 23 1043' 
```

我敏锐的眼睛告诉我这些是 postgresql 类型的 oid，用空格分隔，这个特殊的字符串意味着函数接受 varchar、integer、varchar。所以用python说话，这应该是

```
(unicode, int, unicode) 
```

现在如何从这些数字中获取 python 类型？

理想的最终结果是这样的

```
In [129]: get_python_type(23)
Out[129]: int 
```

我查看了 psycopg2 的所有内容，发现最接近的是“extensions.string_types”，但这只是将 oids 映射到 sql 类型名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-11-15T20:49:26.627

如果您想要 Python 类型类，就像您可能从`SQLALchemy`列对象中获得的那样，您将需要构建和维护自己的映射。`psycopg2`没有之一，即使在内部。

但是，如果您想要的是一种`oid`将原始值转换为 Python 实例的函数的方法，`psycopg2.extensions.string_types`那么实际上已经是您所需要的了。它可能看起来只是从`oid`名称到名称的映射，但事实并非如此：它的值不是字符串，它们是`psycopg2._psycopg.type`. 是时候深入研究一些代码了。

`psycopg2`公开一个用于注册新类型转换器的 API，我们可以使用它来追溯涉及类型转换的 C 代码；这以`typecastObject`in [typecast.c](https://github.com/psycopg/psycopg2/blob/6becf0ef550e8eb0c241c3835b1466eef37b1784/psycopg/typecast.c)为中心，不出所料，它映射到`psycopg2._psycopg.type`我们在 oldfriend 中找到的`string_types`。这个对象包含指向两个函数的指针，`pcast`（对于 Python 转换函数）和`ccast`（对于 C 转换函数），这似乎是我们想要的——只要选择存在的一个并调用它，问题就解决了。除了它们不在暴露的属性中（`name`，它只是一个标签，并且`values`，它是一个 oid 列表）。类型确实暴露给 Python 的是`__call__`，事实证明，它只是在 和 之间进行`pcast`选择`ccast`为我们。此方法的文档非常无用，但查看 C 代码进一步[表明](https://github.com/psycopg/psycopg2/blob/6becf0ef550e8eb0c241c3835b1466eef37b1784/psycopg/typecast.c#L471)它需要两个参数：一个包含原始值的字符串和一个游标对象。

```
>>> import psycopg2.extensions
>>> cur = something_that_gets_a_cursor_object()
>>> psycopg2.extensions.string_types[23]
<psycopg2._psycopg.type 'INTEGER' at 0xDEADBEEF>
>>> psycopg2.extensions.string_types[23]('100', cur)
100
>>> psycopg2.extensions.string_types[23]('10.0', cur)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: '10.0'
>>> string_types[1114]
<psycopg2._psycopg.type 'DATETIME' at 0xDEADBEEF>
>>> string_types[1114]('2018-11-15 21:35:21', cur)
datetime.datetime(2018, 11, 15, 21, 35, 21) 
```

不幸的是，需要一个游标，事实上，并不总是需要一个游标：

```
>>> string_types[23]('100', None)
100 
```

但是任何必须转换实际字符串（`varchar`例如）类型的事情都依赖于 PostgreSQL 服务器的语言环境，至少在 Python 3 编译中，并且传递`None`给这些施法者不仅会失败 - 它还会出现段错误。您提到的方法`cursor.cast(oid, raw)`本质上是对脚轮的包装，`psycopg2.extensions.string_types`在某些情况下可能更方便。

我能想到的需要光标和连接的唯一解决方法是构建一个模拟连接对象。如果它在未连接到实际数据库的情况下公开了所有相关的环境信息，则可以将其附加到游标对象并使用 with`string_types[oid](raw, cur)`或 with `cur.cast(oid, raw)`，但该模拟将使用 C 语言构建，并留给读者作为练习。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T07:04:02.460

postgres 类型和 python 类型的映射在[这里](http://packages.python.org/psycopg2/usage.html)给出。这有帮助吗？

编辑：当您从表中读取记录时，postgres（或任何数据库）驱动程序将自动将记录列类型映射到 Python 类型。

```
cur = con.cursor()
cur.execute("SELECT * FROM Writers")

row = cur.fetchone()

for index, val in enumerate(row):
    print "column {0} value {1} of type {2}".format(index, val, type(val)) 
```

现在，您只需在编写 MySQL 接口代码时将 Python 类型映射到 MySQL 类型。但是，坦率地说，这是将类型从 PostgreSQL 类型映射到 MySQL 类型的一种迂回方式。我只想参考这两个数据库之间的众多类型映射[之一](http://en.wikibooks.org/wiki/Converting_MySQL_to_PostgreSQL#Data_Types)

# ruby-on-rails - Rails：以简单形式选择集合

> ID：11254775
> 
> 赞同：1
> 
> 时间：2012-06-29T00:41:29.533
> 
> 标签：ruby-on-rails, simple-form

我正在使用简单的表单 gem，我想知道你如何做一个 collection_select ？我知道您可以进行选择，但是如何从集合中获取值？

因此，例如，您将如何以简单的形式执行此操作：

```
collection_select(:post, :author_id, Author.all, :id, :name_with_initial, :prompt => true) 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T00:45:54.863

你会这样做：

```
collection_select(:post, :author, Author.all, :id, :name_with_initial) 
```

看看[SimpleForm - 集合选择输入](https://github.com/plataformatec/simple_form/blob/master/lib/simple_form/inputs/collection_select_input.rb)

# json - Appcelerator 请求和使用 Json 文件

> ID：11254777
> 
> 赞同：0
> 
> 时间：2012-06-29T00:41:40.220
> 
> 标签：json, titanium, appcelerator

我正在学习如何使用名为 Wunderground 的第三方 API，但我不知道如何请求、接收和使用 Json 格式的结果。如果您看到他们的网站，开发人员可以免费注册并获得 API KEY。然后，您可以请求以下 URL 格式的天气数据.. http://api.wunderground.com/api/KEY/FEATURE/[FEATURE...]/[SETTING...]/q/QUERY.FORMAT 所以我已经尝试过了我的网络浏览器通过输入一些参数，我收到了一个很长的 Json 文件，其中包含正确的信息（我检查过）。问题是我对如何创建一个可以发出此请求的变量一无所知，即使我能够做到这一点，我也不知道我应该在哪里接收文件以及如何只获得我的结果想要（在这种情况下是当前天气）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T05:23:31.407

您必须使用[Titanium.Network.HTTPClient](http://docs.appcelerator.com/titanium/2.0/index.html#!/api/Titanium.Network.HTTPClient)来发出请求。对于与 Json 解析相关的代码示例，您可以使用：

*   [Appcelerator：使用 JSON 构建 Twitter 客户端](http://mobile.tutsplus.com/tutorials/appcelerator/appcelerator-using-json-to-build-a-twitter-client/)
*   [HTTP客户端（）](http://screencasts.org/episodes/iphone-app-javascript-using-titanium)

# javascript - Spotify 应用程序中的 PHP 后端无法正常工作

> ID：11254778
> 
> 赞同：0
> 
> 时间：2012-06-29T00:42:20.220
> 
> 标签：javascript, jquery, html, spotify

我正在尝试制作一个接收用户信息并将其发送到 SQL 数据库的 spotify 应用程序。但是，我不希望使用 ajax 来完成此操作，因为我希望提交信息以将用户移动到新页面，同时将信息发布到后台的数据库中。

到目前为止，这是我的代码：

```
function complete2() {
var name = document.getElementById("inputname").value;
var form = '<form action="http://site.net/dbconnect.php" method="post" style="display:none">' + '<input type="text" name="name" value="' + name + '">' + '</form>';
$('body').append(form);
$(form).submit();
}

 </script>
 </head>
 <body>
<form id = "submitform" name = "submitform" action = "index.html" method = "POST" onsubmit = "complete2();" >
Name: <input type = "text" id = "inputname"> <br>
<input type = "submit" value = "Create">
</form>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T03:50:41.663

所以我知道您不想使用 AJAX，但如果您想在本地应用程序中加载不同的 html 文件，并且 Spotify 不尊重内部资源的位置标头，那么您将被 ajax 卡住。但是，您可以使其类似于标准帖子会发生的情况，例如：

```
$(function(){
  $('#submitform').submit(function(e){
     e.preventDefault();
     $.post(
         $(this).attr('action'), 
         {'inputname': $(this).find('#inputname').val()}, 
         function(){ window.location.href = 'sp://yourapp/nextpage.html'; }
     );
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T15:53:50.503

这是获取数据的示例

```
$.getJSON("http://www.exx.com/getjsondata.php", function (data) {
parsetheresponse(data) ; 
} 
```

这是发布数据的示例（仍为 JSON）

```
$.post("http://www.exx.com/postdataspotify.php", { albumname: "test", username: "test2" }); 
```

希望它会有所帮助。

不要忘记将[http://www.exx.com](http://www.exx.com)放在清单文件中。

# jquery - jQuery animate 无法在 Safari 上运行

> ID：11254782
> 
> 赞同：4
> 
> 时间：2012-06-29T00:42:47.930
> 
> 标签：jquery, safari, jquery-animate

我有这个为 div 设置动画的 jQuery 代码。它在 Firefox 和 Chrome 上完美运行，但在 safari 中它不会移动，它只是在旋转，而在 Internet Explorer 中它会移动而不旋转！任何解决这个问题的想法都值得赞赏。

jQuery：

```
$(document).ready(function()
{   
  $(".plane").animate({
    'top':'-=0px',
    'left':'+=0px',
    rotate:-50
    }, 500, 'swing');

  $(".plane").animate({
    'top':'-=35px',
    'left':'+=590px',
    rotate:-60
    }, 7000, 'easeOutQuart');

  $(".plane").animate({
    'top':'-=0px',
    'left':'+=0px',
    rotate:25
    }, 2000, 'swing');

  $(".plane").animate({
    'top':'+=30px',
    'left':'+=10px',
    rotate:20
    }, 2000, 'easeInOutCubic');

  $(".plane").animate({
    'top':'-=0px',
    'left':'+=0px',
    rotate:10
    }, 1000, 'swing');

  $(".plane").animate({
    'top':'+=270px',
    'left':'+=180px',
    rotate:0
    }, 5000, 'easeInOutCubic');

  $(".plane").animate({
    'top':'-=0px',
    'left':'+=0px',
    rotate:-130
    }, 1000, 'swing');

  $(".plane").animate({
    'top':'-=490px',
    'left':'+=60px',
    rotate:-120
    }, 5000, 'easeInOutCubic');

  $(".plane").animate({
    'top':'-=0px',
    'left':'+=0px',
    rotate:-250
    }, 1000, 'swing');

  $(".plane").animate({
    'top':'+=150px',
    'left':'-=200px',
    rotate:-270
    }, 5000, 'easeInOutCubic');

 }); 
```

CSS：

```
.plane {
background-image:url('ab.png');
position:absolute;
width:48px;
height:48px;
top:400px;
left:0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T14:37:30.357

（由 OP 在对问题的编辑中回答。在此处转录为社区 wiki 答案 - 尽管它有点简洁。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 好吧，经过200多次浏览而没有答案，我找到了解决方案，我会把它放在这里给那些面临同样问题的人。您需要将元素的位置更改为“相对”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-10T10:22:57.367

就我而言，我删除了overflow-x:hidden..

```
 html, body {
  height: 100%;
  width: 100%;
  overflow-x: hidden;
} 
```

到

```
 html, body {
   height: 100%;
   width: 100%;
 } 
```

# c# - 搜索 DataGridView，然后突出显示找到值的单元格？

> ID：11254784
> 
> 赞同：2
> 
> 时间：2012-06-29T00:43:04.260
> 
> 标签：c#, winforms, search, datagridview, full-text-search

我有一个 DataGridView 我正在提供一个 List

DataGridView 填充完美，但我现在希望能够在网格（任何列）中搜索用户输入的值。

我一直在试图潜入解决方案，但我找不到 DataGridView.Cells[X,Y] 类型的属性。

我试过这个：

```
String searchVal = textBoxValueToFindInGrid.Text.Trim();
for (int i = 0; i < dataGridViewPlatypusElements.RowCount; i++)
{
    for (int j = 0; j < dataGridViewPlatypusElements.ColumnCount; j++) {
        if (dataGridViewPlatypusElements.Text.Contains(searchVal))
        {
            dataGridViewPlatypusElements.GoTo*(Cells[j,i]);
        }
    }
} 
```

...但是，当然， DataGridView.Text 不包含任何有用的东西。这是我需要 Cells[X,Y] 属性的地方。

*   在这种情况下，我不会认为它有害。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T01:36:53.120

可能对有类似问题的其他人有用：

```
if(dataGridView.Rows[i].Cells[j].Value.ToString().Contains(searchText)
{
    dataGridView.Rows[i].Cells[j].Selected = true;
} 
```

如果您需要有关单元格的更多信息，可以遍历选定的单元格：

```
foreach(DataGridViewCell selectedCell in dataGridView.SelectedCells)
{
    ..........
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T02:26:15.030

怎么样

```
dataGridView.Rows[X].Cells[Y].Value 
```

# php - 如何在不破坏单词的情况下拆分长字符串？

> ID：11254787
> 
> 赞同：22
> 
> 时间：2012-06-29T00:44:08.613
> 
> 标签：php, arrays, regex, string, split

我正在寻找类似的东西

```
str_split_whole_word($longString, $x) 
```

where`$longString`是句子的集合，`$x`是每行的字符长度。它可能相当长，我想基本上以数组的形式将它分成多行。

例如：

```
$longString = 'I like apple. You like oranges. We like fruit. I like meat, also.';
$lines = str_split_whole_word($longString, $x); 
```

期望的输出：

```
$lines = Array(
    [0] = 'I like apple. You'
    [1] = 'like oranges. We'
    [2] = and so on...
) 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-29T00:46:24.623

最简单的解决方案是使用[`wordwrap()`](http://php.net/wordwrap), 并[`explode()`](http://php.net/explode)在新行上，如下所示：

```
$array = explode( "\n", wordwrap( $str, $x)); 
```

`$x`包裹字符串的字符数在哪里。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-29T04:39:09.573

This code avoid breaking words, you won't get it using wordwrap().

The maximum length is defined using `$maxLineLength`. I've done some tests and it works fine.

```
$longString = 'I like apple. You like oranges. We like fruit. I like meat, also.';

$words = explode(' ', $longString);

$maxLineLength = 18;

$currentLength = 0;
$index = 0;

foreach ($words as $word) {
    // +1 because the word will receive back the space in the end that it loses in explode()
    $wordLength = strlen($word) + 1;

    if (($currentLength + $wordLength) <= $maxLineLength) {
        $output[$index] .= $word . ' ';
        $currentLength += $wordLength;
    } else {
        $index += 1;
        $currentLength = $wordLength;
        $output[$index] = $word;
    }
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-29T00:46:49.850

用于[`wordwrap()`](http://us3.php.net/manual/en/function.wordwrap.php)插入换行符，然后`explode()`在这些换行符上：

```
// Wrap at 15 characters
$x = 15;
$longString = 'I like apple. You like oranges. We like fruit. I like meat, also.';
$lines = explode("\n", wordwrap($longString, $x));

var_dump($lines);
array(6) {
  [0]=>
  string(13) "I like apple."
  [1]=>
  string(8) "You like"
  [2]=>
  string(11) "oranges. We"
  [3]=>
  string(13) "like fruit. I"
  [4]=>
  string(10) "like meat,"
  [5]=>
  string(5) "also."
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-09-30T07:54:38.003

我的要求是在每 20 个字符后拆分文本字符串，而不用断词。使用[wordwrap()](https://www.php.net/wordwrap)在每 20 个字符后插入换行符 所以这就是我的做法。希望这对找到这种解决方案的其他人有所帮助。

```
$charactersLimit = 20;
$yourTextString = 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit.';
$output = explode("\n", wordwrap($yourTextString, $charactersLimit)); 
```

输出如下：

```
Array
(
    [0] => Lorem ipsum dolor
    [1] => sit amet,
    [2] => consectetuer
    [3] => adipiscing elit.
) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-25T07:00:22.690

只需一个`preg_`函数调用即可完成整个任务。

1.  匹配零到`$maxLength`时间之间的任何字符。
2.  使用 .忘记/释放 #1 中的匹配字符`\K`。
3.  匹配下一个或多个空格字符或字符串的结尾。这里匹配的字符/位置会在拆分过程中被消耗，不会出现在输出数组中。
4.  设置`preg_`函数以排除通过在字符串位置的末尾用 分割产生的空元素`PREG_SPLIT_NO_EMPTY`。

代码：（[演示](https://3v4l.org/oovpq)）

```
$longString = 'I like apple. You like oranges. We like fruit. I like meat, also.';
$maxLength = 18;

var_export(
    preg_split("/.{0,{$maxLength}}\K(?:\s+|$)/", $longString, 0, PREG_SPLIT_NO_EMPTY)
); 
```

输出：

```
array (
  0 => 'I like apple. You',
  1 => 'like oranges. We',
  2 => 'like fruit. I like',
  3 => 'meat, also.',
) 
```

如果您的输入字符串可能包含换行符，则只需添加`s`模式修饰符。
`/.{0,{$maxLength}}\K(?:\s+|$)/s` （[演示](https://3v4l.org/5SgOt)）

# asp.net-mvc-3 - 不会从 HttpContext.Current.User.IsInRole 注入存储库

> ID：11254792
> 
> 赞同：0
> 
> 时间：2012-06-29T00:44:47.420
> 
> 标签：asp.net-mvc-3, nhibernate, fluent-nhibernate, ninject, roleprovider

我有一个具有自定义成员资格和角色提供者的 MVC 应用程序。我正在检查用户是否具有这样的角色：

```
public static bool CustomersVisible
{
    get
    {
        return
            HttpContext.Current.User != null &&
            HttpContext.Current.User.Identity.IsAuthenticated &&
            HttpContext.Current.User.IsInRole("Admin");
    }
} 
```

自定义角色提供程序如下所示：

```
public class DRRoleProvider : RoleProvider
{
    private IUserProfileRepository _userProfileRepository;
    private IRoleRepository _roleRepository;

    public DRRoleProvider() {}

    public DRRoleProvider(IUserProfileRepository userProfileRepository, IRoleRepository roleRepository)
    {
        _userProfileRepository = userProfileRepository;
        _roleRepository = roleRepository;
    }

. . .

public override bool IsUserInRole(string username, string roleName)
{
    var user = _userProfileRepository.GetByUserName(username);
    var role = _roleRepository.GetByName(roleName);

    if (user != null)
    {
        return user.Roles != null && user.Roles.Contains(role);
    }

    return false;
} 
```

编辑添加：这是我的 NinjectControllerFactory：

```
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninjectKernel;

    public NinjectControllerFactory()
    {
        ninjectKernel = new StandardKernel();
        AddBindings();
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        return controllerType == null
                   ? null
                   : (IController) ninjectKernel.Get(controllerType);
    }

    private void AddBindings()
    {
        ninjectKernel.Bind<ICustomerRepository>().To<CustomerRepository>();
        ninjectKernel.Bind<IUserProfileRepository>().To<UserProfileRepository>();
        ninjectKernel.Bind<IRoleRepository>().To<RoleRepository>();
        ninjectKernel.Bind<ISessionFactory>().ToProvider<SessionFactoryBuilder>().InSingletonScope();
        ninjectKernel.Bind<ISession>().ToMethod(CreateSession).InSingletonScope();

        ninjectKernel.Inject(Membership.Provider);
        ninjectKernel.Inject(Roles.Provider);
    }

    private ISession CreateSession(IContext context)
    {
        var session = context.Kernel.Get<ISessionFactory>().OpenSession();
        return session;
    }
} 
```

当调用 IsUserInRole 方法时，我在 _userProfileRepository 上得到一个空引用异常。如何确保从 HttpContext.Current.User.IsInRole 调用存储库时被注入？从我自己的代码调用时它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:52:33.397

RoleProvider 并不是真正的依赖注入友好。它要求您具有默认构造函数。尝试改用属性注入。

由于您使用的是 Ninject，也许这些问题/答案可能会有所帮助：
[Ninject with MembershipProvider | RoleProvider](https://stackoverflow.com/questions/4650155/ninject-with-membershipprovider-roleprovider)
[自定义角色提供程序使用 DI ninject 抛出错误](https://stackoverflow.com/questions/8248545/custom-role-provider-using-di-ninject-throwing-error)

# mongodb - Mongo 的 convertToCapped 每次运行时都会分配更多空间吗？

> ID：11254795
> 
> 赞同：1
> 
> 时间：2012-06-29T00:45:54.210
> 
> 标签：mongodb, database

我跑了

`db.runCommand({"convertToCapped": "all", size: 268435456000})`

将当前集合限制为 250GB。SSH 会话超时，但我看到磁盘使用量增加了 250GB。我检查了日志并看到：

```
Thu Jun 28 23:41:18 [conn312] command logs.$cmd command: { convertToCapped: "all", size: 268435456000.0 } ntoreturn:1 reslen:37 4399826ms
Thu Jun 28 23:41:20 [conn313] end connection 127.0.0.1:53704 
```

什么是 ntoreturn:1？

我再次运行命令。我想它只会看到它已经是 250GB 并且有上限，但它正在填满另外 250GB。我到底在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T05:19:03.187

运行时`convertToCapped`，MongoDB 会克隆原始集合以创建具有请求大小的新上限集合，然后再删除原始集合。您应该会在 mongod 日志中看到这一点，其序列大致如下：

```
Fri Jun 29 15:14:49 [FileAllocator] allocating new datafile ./capped.2, filling with zeroes...
Fri Jun 29 15:14:54 [FileAllocator] done allocating datafile ./capped.2, size: 2047MB,  took 4.984 secs
Fri Jun 29 15:14:54 [conn1] command capped.$cmd command: { cloneCollectionAsCapped: "all", toCollection: ".tmp.convertToCapped.all", size: 1536870912.0 } ntoreturn:1 reslen:37 5134ms
Fri Jun 29 15:14:54 [conn1] CMD: drop capped.all
Fri Jun 29 15:14:54 [conn1] command capped.$cmd command: { convertToCapped: "all", size: 1536870912.0 } ntoreturn:1 reslen:37 5135ms 
```

*   为上限集合预先分配了新数据文件（称为“全部”以匹配您的示例）
*   现有集合被克隆到临时上限集合
*   原始集合被丢弃
*   临时集合重命名为原始集合

因此，如果您有一个 250Gb 的封顶集合并以 250GB 重新运行 convertToCapped，您将暂时使使用的空间增加一倍（原始封顶集合为 250Gb，新封顶集合为 250Gb）。

[您可以使用db.repairDatabase()](http://www.mongodb.org/display/DOCS/Excessive+Disk+Space#ExcessiveDiskSpace-RecoveringDeletedSpace)回收额外的空间。

# c# - WebClient 上的 InvalidComObjectException

> ID：11254803
> 
> 赞同：1
> 
> 时间：2012-06-29T00:47:07.047
> 
> 标签：c#, wpf, multithreading, c#-4.0, webclient

我有以下代码；

```
System.Threading.Thread thread = new System.Threading.Thread(
    new System.Threading.ThreadStart(
        delegate()
        {
            WebClient wc = new WebClient();
            wc.Credentials = System.Net.CredentialCache.DefaultCredentials;
            var data = wc.DownloadData(address); // exception (sometimes) here
        }
    ));
thread.SetApartmentState(System.Threading.ApartmentState.STA);
thread.Start(); 
```

调用是在一个线程中，因为为了简单起见，我已经删除了其他事情。

在我的开发机器上，这段代码大约有 1% 的时间会抛出异常，在另一台机器上，代码在第一次调用时工作，然后在任何后续调用时抛出异常。

例外情况如下；

```
System.Net.WebException: The request was aborted: The request was canceled. ---> System.Runtime.InteropServices.InvalidComObjectException: COM object that has been separated from its underlying RCW cannot be used.
   at System.StubHelpers.StubHelpers.GetCOMIPFromRCW(Object objSrc, IntPtr pCPCMD, Boolean& pfNeedsRelease)
   at MS.Win32.UnsafeNativeMethods.IInternetSecurityManager.MapUrlToZone(String pwszUrl, Int32& pdwZone, Int32 dwFlags)
   at MS.Internal.AppModel.CustomCredentialPolicy.MapUrlToZone(Uri uri)
   at MS.Internal.AppModel.CustomCredentialPolicy.ShouldSendCredential(Uri challengeUri, WebRequest request, NetworkCredential credential, IAuthenticationModule authenticationModule)
   at System.Net.NtlmClient.DoAuthenticate(String challenge, WebRequest webRequest, ICredentials credentials, Boolean preAuthenticate)
   at System.Net.NtlmClient.Authenticate(String challenge, WebRequest webRequest, ICredentials credentials)
   at System.Net.AuthenticationManager.Authenticate(String challenge, WebRequest request, ICredentials credentials)
   at System.Net.AuthenticationState.AttemptAuthenticate(HttpWebRequest httpWebRequest, ICredentials authInfo)
   at System.Net.HttpWebRequest.CheckResubmitForAuth()
   at System.Net.HttpWebRequest.CheckResubmit(Exception& e)
   at System.Net.HttpWebRequest.DoSubmitRequestProcessing(Exception& exception)
   at System.Net.HttpWebRequest.ProcessResponse()
   at System.Net.HttpWebRequest.SetResponse(CoreResponseData coreResponseData)
   --- End of inner exception stack trace ---
   at System.Net.WebClient.DownloadDataInternal(Uri address, WebRequest& request)
   at System.Net.WebClient.DownloadData(Uri address)
   at System.Net.WebClient.DownloadData(String address) 
```

我已经看到有关此异常的其他关于 SO 的问题，但是它们似乎特定于实际使用互操作（excel 或其他）并及早处理它，这只是对 WebClient 的调用（以及正在实例化的调用）每次通话）

WebClient 是否实际上访问了一些内部（静态？）互操作，并且这里存在某种垃圾收集问题？

有趣的是，此代码从应用程序的各个部分调用（它从报告服务返回报告），但仅（有时）在特定报告上失败。但是，我检查了报告服务器日志，当抛出此异常时，不会尝试 http 连接，因此调用在`wc.DownloadData()`.

关于为什么抛出此异常的任何想法？

***== 编辑 ==***

尝试使用`wc.Displose()`但异常仍然发生（仍然偶尔发生）。该代码由 WPF 应用程序调用，如果发生异常，则在每次连续调用时都会发生异常，直到重新启动应用程序。

# javascript - 如何存储浏览器范围的 localStorage 值？

> ID：11254804
> 
> 赞同：3
> 
> 时间：2012-06-29T00:47:41.290
> 
> 标签：javascript, google-chrome, local-storage, tracking

假设我打开 Chrome 并跳入 javascript 控制台。如果我跑

```
localStorage.setItem('test', 'THIS IS A VALUE'); 
```

然后关闭浏览器，重新打开，然后运行

```
localStorage.getItem('test'); 
```

结果将是可以预见的“这是一个价值”。但是，如果我要导航到打开浏览器时所在的另一个页面，即不在 about:blank; 或任何主页，运行 .getItem 将导致 null。

似乎 localStorage 特定于某个页面。有没有办法在一个页面上存储一个可以在任何页面上使用的值？

假设我想在一个页面上生成一个 ID，然后在一个完全不相关的站点上检查相同的 ID，这可能吗？现在我已经把它打出来了，听起来有点安全风险。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T00:54:25.720

每个域都有一个单独的 LocalStorage 存储，很像 cookie。考虑替代方案：如果 LocalStorage 是全局的，不同的网站可以读取和写入彼此的存储值。

存储跨多个站点“跟踪”用户的持久数据在某种程度上是有意识的，是困难的。您将需要明确采取跨域的操作（例如，从另一个站点加载内容或将数据发布到另一个站点）来实现此目的。

# jquery-mobile - 如何将 Google Analytics 与 jQuery Mobile 应用程序集成？

> ID：11254805
> 
> 赞同：1
> 
> 时间：2012-06-29T00:47:53.900
> 
> 标签：jquery-mobile, google-analytics, tracking

我尝试使用多页模板开发 jQuery Mobile 应用程序。我想将 Google Analytics 添加到应用程序中。

我参考了这份文档，[将 Google Analytics 与 jQuery Mobile 结合使用](http://www.jongales.com/blog/2011/01/10/google-analytics-and-jquery-mobile/)。它似乎不适用于我的应用程序。

我的应用程序中的代码如下：

```
<script type="text/javascript">
    var _gaq = _gaq || [];

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();

    $('[data-role=page]').on('pageshow', function (event, ui) {
        try {
            _gaq.push(['_setAccount', 'UA-30119852-1']);
            hash = location.hash;

            if (hash) {
                _gaq.push(['_trackPageview', hash.substr(1)]);
            } else {
                _gaq.push(['_trackPageview']);
            }
        } catch(err) {      
        }
    });
</script> 
```

如何将 Google Analytics 与 jQuery Mobile 应用程序集成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:18:43.097

```
$(document).delegate('[data-role=page]', 'pageshow', function (event, ui) {
console.log('pageshow event handler called for ');
var url = location.href;
console.log('pageshow event url = '+url);

try  
{
    //_gaq.push(['_trackPageview', url]);
    _gaq.push( ['_trackPageview', event.target.id] );
    console.log('done pushing page '+url);
} 
catch(error) {
    // error catch
    console.log('got error '+error);
}
}); 
```

# svg - 插值线以在 d3 中制作半圆/圆弧

> ID：11254806
> 
> 赞同：3
> 
> 时间：2012-06-29T00:48:03.443
> 
> 标签：svg, d3.js

我正在尝试在 d3 中创建一个半圆。使用[基数插值](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-line_interpolate)会产生一条接近我想要的路径，但还不够“圆”。我如何编写自己的插值器来更好地绕过这条路径，或者有更好的方法吗？

这是我到目前为止所拥有的：http: [//jsfiddle.net/Wexcode/jEfsh/](http://jsfiddle.net/Wexcode/jEfsh/)

```
<svg width="300" height="500">
    <g id="g-1"></g>
    <g id="g-2"></g>
</svg>​ 
```

JS：

```
var curved = d3.svg.line()
    .x(function(d) { return d.x; })
    .y(function(d) { return d.y; })
    .interpolate("cardinal")
    .tension(0);
var straight = d3.svg.line()
    .x(function(d) { return d.x; })
    .y(function(d) { return d.y; })
    .interpolate("linear")
    .tension(0);

var points = [{x: 70, y: 52.5}, {x: 250, y: 250}, {x: 70, y: 447.5}];

d3.select("#g-1").append("path").attr("d", curved(points));

d3.select("#g-2").append("path").attr("d", straight(points)); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T17:18:31.960

请参阅：[如何计算（圆的）弧的 SVG 路径](https://stackoverflow.com/questions/5736398/how-to-calculate-the-svg-path-for-an-arc-of-a-circle)

* * *

使用 d3.arc() 创建曲线的问题在于它将两条线叠加在一起。请参阅：[https ://stackoverflow.com/a/11595157/522877](https://stackoverflow.com/a/11595157/522877)

[`d3.svg.line.radial()`](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-line_radial)在创建圆弧和圆方面有更多的控制权。

这是一个如何创建圆圈的示例：http: [//jsfiddle.net/Wexcode/CrDUy/](http://jsfiddle.net/Wexcode/CrDUy/)

```
var radius = 100,
    padding = 10,
    radians = 2 * Math.PI;

var dimension = (2 * radius) + (2 * padding),
    points = 50;

var angle = d3.scale.linear()
    .domain([0, points-1])
    .range([0, radians]);

var line = d3.svg.line.radial()
    .interpolate("basis")
    .tension(0)
    .radius(radius)
    .angle(function(d, i) { return angle(i); });

var svg = d3.select("body").append("svg")
    .attr("width", dimension)
    .attr("height", dimension)
.append("g");

svg.append("path").datum(d3.range(points))
    .attr("class", "line")
    .attr("d", line)
    .attr("transform", "translate(" + (radius + padding) + ", " + (radius + padding) + ")"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T01:02:08.847

你看过[圆弧部分](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-arc)吗？

# iphone - 为什么 MapKit 中的蓝点（用户位置）会移动？

> ID：11254807
> 
> 赞同：1
> 
> 时间：2012-06-29T00:48:28.883
> 
> 标签：iphone, ios, mapkit

在使用 MapKit 时，我有几个关于蓝点（用户位置）指示器的问题。

1) 蓝点没有放在正确的位置。它不仅略微偏离，而且处于不同的状态。如何让它显示在我当前的位置？在另一个应用程序中，我发现这个点离我当前的位置更近了，但相距几英里。

2）当我在模拟器中启动我的应用程序时，地图视图上的蓝点（用户位置）指示器会移动！放大地图时最容易看到这一点。当显示在街道水平时，您可以看到蓝点在地图上拉开。为什么会这样？我怎样才能让点留在一个地方？

3) 我之前看到你可以在 Xcode 中更改你的默认位置。我不记得这是怎么做到的。有人可以建议这是在哪里完成的吗？

这是头文件：

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface ViewController : UIViewController 
@property (weak, nonatomic) IBOutlet MKMapView *mapView;

@end 
```

这是实现文件：

```
- (void)viewDidLoad
{
   [super viewDidLoad];
   [self.mapView setShowsUserLocation:YES];
} 
```

没有比这更简单的了，但我遇到了奇怪的问题。这是我的配置：

*   Xcode 4.2.1
*   iOS 5
*   Mac 10.7 狮子

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T04:18:37.740

在模拟器中，当前位置默认设置为无。如果您想专注于一个位置，请转到方案 -> 编辑方案 -> 选项 -> 设置位置

# mongodb - MongoDB中的JSV模式验证？

> ID：11254810
> 
> 赞同：0
> 
> 时间：2012-06-29T00:48:54.937
> 
> 标签：mongodb, schema

是否可以将 JSV 存储在 MongoDB 中，并为每个集合提供模式，然后运行 ​​MapReduce 来验证文档？将无效文档插入我可以手动修复的集合中？

我希望尽可能少的外部应用程序干预，最好是每天 MapReduces 对脏文档的 cron，然后我将手动调查为什么这些文档无效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:59:10.537

Map/Reduce 可能不是检查模式合规性的正确方法，因为它不会修改原始集合中的文档。因此，您不能在文档中设置一个标志，表明它已经过验证，并且可能最终在每次 cron 运行时重新验证。

建议的方法：

*   `validated`为您的文档添加索引字段；如果您想对模式进行版本控制，这可能是一个数值。
*   如果可能，所有文件都应在插入时进行验证
*   编写一个脚本，该脚本将查找所有未经过验证以匹配当前模式的文档，并`validated`根据 JSV 结果更新该字段
*   将特定的验证错误保存到另一个集合或可能的子文档中（如果添加错误报告最终会触发过多的文档移动，您可能需要考虑一些[手动填充）。](http://www.mongodb.org/display/DOCS/Padding+Factor#PaddingFactor-ManualPadding)

# asp.net-mvc - 如何在一个视图中呈现强类型的局部视图？

> ID：11254813
> 
> 赞同：5
> 
> 时间：2012-06-29T00:49:46.247
> 
> 标签：asp.net-mvc, razor, partial-views

我是这个 asp net mvc 的新手，但在 web 表单方面有很强的背景。

我想实现一个具有左侧资产菜单的页面，当您单击其中一个资产时，可以在同一页面的右侧编辑该资产的详细信息。

现在我想我需要使用 2 个强类型的局部视图。1 代表资产列表类型的左侧菜单，1 代表资产类型的右侧面板。

到目前为止，我有左侧菜单工作

控制器

```
public class AssetsController : Controller
{
    //
    // GET: /Assets/
    public ActionResult Index()
    {
        var assets =Repo.getAssetList();

        return View(assets);
    }

} 
```

布局视图

```
 @model IList<CasWebSite.Models.Asset>

<!DOCTYPE html>
<html>
<head>
    <title>title</title>
</head>
<body>
    <h1>
        Assets</h1>

    @RenderBody()

</body>
</html> 
```

索引视图

```
 @model IList<CasWebSite.Models.Asset>
@{
    Layout = "_Layout.cshtml";
}
<ul>
    @foreach (var asset in Model)
    {
        <li>@asset.Name </li>
    }
</ul> 
```

那么如何在另一个视图中添加我是否创建一个新的资产类型的局部视图，控制器会是什么样子我仍然可以通过转到 url /assets 进入页面，以及如何在 2 个部分之间传递值视图，因为我需要知道在左侧选择了哪个资产进行编辑？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T04:17:27.360

如果我理解正确，您有一个视图，您希望在一个局部视图和另一个局部视图中显示资产列表以在选择时编辑资产。

首先，您应该创建两个局部视图。

**Assets.cshtml（部分视图）**

```
@model IList<Models.Asset>

.. iterate the model and display the menu of assets 
```

**EditAsset.cshtml（部分视图）**

```
@model Models.Asset

.. create the form and render the fields for editing 
```

现在在主视图中`Index.cshtml`，您必须调用`Assets.cshtml`using`Html.Partial/Html.RenderPartial`而另一个将在单击资产链接时调用。

**索引.cshtml**

```
@Html.Partial("Assets", Model.Assets) @*rendering the partial view*@

... other html

<div id="editAssetContainer">  @*edit form placeholder*@
</div> 
```

请注意，您还应该有一个占位符，称为`editAssetContainer`您要显示编辑表单的位置。

现在悬而未决的事情是如何在单击资产链接时在占位符中呈现编辑表单。您可以通过两种方式做到这一点：直接使用 jquery 或使用[Ajax.ActionLink](http://code-inside.de/blog-in/2011/04/26/howto-ajax-actionlink-asp-net-mvc-3/)。您可以将部分视图中的所有资产链接创建`Asset.cshtml`为 ajax 链接。）如果您使用的是 Ajax.ActionLink，请不要忘记包含不显眼的 ajax 库）

**前任。Ajax.ActionLink**

```
@Ajax.ActionLink(linkText, 
"EditAsset", // the action that returns the partial view
new {assetId = @asset.Id }, // the assetId that to be passed to the action
new AjaxOptions // you can specify the targetid and others here..
   { UpdateTargetId = "editAssetContainer", 
      InsertionMode = InsertionMode.Replace 
   }
) 
```

在这两种情况下，您都需要在控制器中执行一个操作来返回`EditAsset.cshtml`.

```
public PartialViewResult EditAsset(int assetId)
{
   var asset = .. get asset using assetId from db.
   return PartialView(asset);
} 
```

**更新：**

有两种方法可以将模型加载到`Assets.cshtml`局部视图中。第一种方法是您可以创建一个包含资产列表作为属性的视图模型，并`index`使用此视图模型强烈键入视图。然后你可以调用`Html.Partial`将资产传递给它。

前任。

```
public class IndexViewModel
{
   public IList<Asset> Assets;
   .. other properties if there any
} 
```

**索引.cshtml**

```
@model IndexViewModel

@Html.Partial("Assets", Model.Assets). 
```

第二种方法是您可以有一个从数据库获取资产列表并返回部分视图的子操作。在这种情况下，您不需要强输入`Index`视图。

```
[ChildActionOnly]
public PartialViewResult Assets()
{
   var assets = .. get from db
   return View(assets);
} 
```

`Index`您可以从as调用子操作

```
@Html.Action("Assets") 
```

您可以使用最适合您的一种。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T04:04:20.557

您走在正确的轨道上，您需要创建两个局部视图并将它们放在父视图中。您还可以考虑在视图中调用 AJAX 来更新局部。在这里，您的帖子解释了步骤以及视图模型的外观 -[带有 Razor 视图引擎的 ASP.NET MVC 3 中的部分视图](http://rachelappel.com/razor/partial-views-in-asp-net-mvc-3-w-the-razor-view-engine/)

*   [了解 RenderPartials](http://www.highoncoding.com/Articles/638_Understanding_Partial_Views_in_ASP_NET_MVC_Application.aspx)
*   [部分视图和强类型自定义视图模型](http://www.mikesdotnetting.com/Article/105/ASP.NET-MVC-Partial-Views-and-Strongly-Typed-Custom-ViewModels)
*   [ASP.NET MVC 中局部视图、JQuery 和 AJAX 的强大功能](http://paululvinius.wordpress.com/2009/06/16/the-power-of-partial-views-jquery-and-ajax-in-asp-net-mvc/)

# shopify - 更新库存数量

> ID：11254820
> 
> 赞同：0
> 
> 时间：2012-06-29T00:50:56.353
> 
> 标签：shopify

如果我使用以下选项设置一些产品/变体：

*   库存： Shopify 跟踪此变体的库存水平
*   有多少库存：9（例如）
*   并选择“我允许用户购买此商品，即使它不再有库存”

当我收到订单时，Shopify 会减少我的库存（我没有发货，我没有接受付款）。

当我履行商品时，是否可以减少我的库存？还是手动管理库存？

提前致谢

贝林斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T13:27:00.863

如果需要，您可以将库存设置为 0 并在外部管理该值。Shopify 将始终在创建订单后立即减少库存，如果稍后取消订单，则将退回库存。无法更改它，因此只有在完成项目时才会减少库存。

# apache - mod_jk 平衡树

> ID：11254822
> 
> 赞同：0
> 
> 时间：2012-06-29T00:51:38.350
> 
> 标签：apache, tomcat, load-balancing, mod-jk, session-replication

是否可以在 mod_jk 配置中构建具有多个级别的平衡器树？

例如有以下配置

```
worker.list=b, b1, b2

worker.t1.port=8001
worker.t1.host=localhost
worker.t1.type=ajp13
worker.t1.lbfactor=1

worker.t2.port=8002
worker.t2.host=localhost
worker.t2.type=ajp13
worker.t2.lbfactor=1

worker.t3.port=8003
worker.t3.host=localhost
worker.t3.type=ajp13
worker.t3.lbfactor=1

worker.t4.port=8004
worker.t4.host=localhost
worker.t4.type=ajp13
worker.t4.lbfactor=1

worker.b1.type=lb
worker.b1.balance_workers=t1,t2

worker.b2.type=lb
worker.b2.balance_workers=t3, t4

worker.b.type=lb
worker.b.balance_workers=b2, b1 
```

并且有以下两个多播tomcat集群（t1，t2）和（t3，t4）。因此会话仅在 t1 和 t2 之间以及 t3 和 t4 之间复制。

如果 t1 失败，mod_jk 会将请求转发到 t2 吗？我的意思是它尊重平衡器还是会向*任何*离开的tomcat工人发送请求？这很重要，因为会话不会在集群之间复制，并且当集群中有一个工作人员死亡的存活工作人员时，将请求重定向到另一个集群将使用户会话信息无法访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:43:12.180

我不确定，但似乎不需要平衡树。有一个`domain`属性就像逻辑域。因此平衡器将尝试将请求重定向到来自同一域的工作人员。

我测试了一下，它似乎工作。

# c# - 使用不同签名、调用前后的包装方法

> ID：11254826
> 
> 赞同：1
> 
> 时间：2012-06-29T00:51:55.450
> 
> 标签：c#, wpf, c#-4.0, aop

**在下面的示例中，如何避免在调用前后出现一对重复的行？** 详细信息：这是真正更大代码的可编译模拟。通常它是一层代理类，包含具有各种 API 的服务客户端。重复部分是每个客户端的每个方法的调用前和调用后。不幸的是，所有可能的方法都没有单一的签名，前后部分需要一个指向客户端通道和上下文的指针。是否可以应用高级的东西，如 AOP、泛型、委托、属性等？谢谢

```
using System;

namespace ConsoleApplication
{
class ClassServiceClient: IDisposable
{ 
    public Object channel()
    {
        return "something";
    }

    public Object context()
    {
        return "something other";
    }
}

class ClassA : ClassServiceClient
{
    public Object methodA()
    {
        return "something other";
    }
}

class ClassB : ClassServiceClient
{
    public void methodB(string param)
    {
        return;
    }
}

class ClassAProxy 
{
    public Object methodA()
    {
        using (ClassA client = new ClassA())         
        {
            Program.preparation(client.channel());   //<---- repetitive part
            Object result = client.methodA();
            Program.postinvocation(client.context());//<---- repetitive part
            return result;
        }
    }
}

class ClassBProxy
{
    public void methodB(string param)
    {
        using (ClassB client = new ClassB())
        {
            Program.preparation(client.channel());   //<---- repetitive part
            client.methodB(param);
            Program.postinvocation(client.context());//<---- repetitive part
            return;
        }
    }
}

class Program
{
    public static void preparation(Object channel)
    {
        // Do something with channel
    }

    public static void postinvocation(Object context)
    {
        // Do something with context
    }

    static void Main(string[] args)
    {

    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T02:22:20.350

如果您可以使用公共基类，则可以轻松使用执行调用的公共密封方法和执行逻辑的受保护抽象方法，例如

```
class ProxyBase{
    public void Method(params object[] args){
        PreConditions();
        Invoke(args);               
        PostConditions();
    }

    protected abstract void Invoke(object[] args);
}

class ClassAProxy{
    protected override void Invoke(object[] args){
        client.Method(args[0]);
    }
} 
```

您可以通过在您的 Program 类中声明一个执行操作的 InvocationHandler 在功能上实现类似的结果：

```
class Program{
    public static void Invoke(object[] args, Action action){
        PreConditions();
        action();
        PostConditions();
    }
}

class ClassAProxy{
    public void MethodA(int i){
        Program.Invoke(() => client.Something(i));
    }
} 
```

# java - 如何使用 Exchange Web 服务 (EWS) 修复客户端协议异常

> ID：11254827
> 
> 赞同：0
> 
> 时间：2012-06-29T00:51:59.897
> 
> 标签：java, android, http-post, exchangewebservices

我在使用以下方法访问 Exchange Web 服务 (EWS) 时遇到问题：

```
HttpResponse response = httpClient.execute(httpPost) 
```

大多数情况下这有效，但有时我会收到 ClientProtocolException。

在我所做的研究中，我可以看到我们需要为 提供异常处理`ClientProtocolException`，但我无法找出为什么会出现此异常以及如何修复它。

有谁知道这个异常是什么以及为它编码的最佳方法？或者这只是我正在访问的 EWS 网站的问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:21:57.190

检查是否使用 http 或 https 发送请求。当请求无法与 iis 证书通信时会发生此错误。

# objective-c - 什么时候应该使用 IBOutlet 而不是 IBAction？

> ID：11254829
> 
> 赞同：0
> 
> 时间：2012-06-29T00:52:27.597
> 
> 标签：objective-c, interface-builder

我知道 IBAction 和 IBOutlet 之间的区别，但我不知道什么时候应该使用其中一个。

例如，我正在尝试制作一个计算器。我有十个按钮和一个标签来显示结果。我必须在我的界面中创建十个 IBOutlets 吗？如果不是，为什么不呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T00:58:34.053

An`IBOutlet`是与对象的连接，而 an`IBAction`是与要作为回调调用的方法的连接。例如，您可能有十个按钮和一个标签，但您可能使用 IBOutlet 连接到标签（因此您可以更新其值），以及`- (IBAction)buttonPressed:(id)sender;`连接到`onTouchUpInside`十个按钮中每一个的事件的单个函数。然后，该`buttonPressed:`方法的实现将需要检查`sender`以找出它的值是什么。

`IBOutlet`如果您只需要这样做，则不需要为每个按钮设置一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T01:02:53.100

好的，IBOutlets 和 IBActions 有两个不同的目的。

IBActions 基本上是可以通过 IB 连接到 UI 元素的方法。它们提供了在 UI 发生某些事情时通知您的对象的方法。它们还在被调用时提供 sender 参数，以便您可以访问从方法内发送消息的 UI 元素。

另一方面，IBOutlet 提供了一种在代码中随时获取对 UI 元素的引用的方法，当您需要更改 UI 的各个方面时使用它。

对于您的情况，您实际上不需要为按钮设置 IBOutlets，因为您不需要更改它们的任何内容，只需在按下它们时通知您。

请注意，如果您有这么多按钮，并且由于某种原因需要一种从代码中访问它们的方法来更改它们的某些内容，我不建议您使用 10 个 IBOutlets。相反，我会使用该`viewWithTag:`方法，并相应地设置每个按钮标签，这样您就不必费心为每个按钮创建 IBOutlets。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:06:16.347

在您的情况下，我将为标签创建一个 IBOutlet，为按钮创建一个 IBAction。标签的 IBOutlet 将在用户按下按钮时更新文本。您的 IBAction 看起来像这样：

```
-(IBAction)digitPressed:(UIButton *)sender{

    //First you have to check if there is currently any text in the label
    //If there is not, the below line of code is performed
    NSString *textWithDigit = [[yourLabel.text] stringByAppendingString: sender.titleLabel];

    //This line updates the label's text
    label.text = textWithDigit;
} 
```

我只输入了与 IBActions 和 IBOutlets 相关的代码（标签需要一个 IBOutlet 才能更新文本，并且需要 IBAction 将标签的文本更改为按下的数字）；需要更多代码（检查用户当前是否正在输入数字所需的代码，用于 +、-、*、/ 等操作的代码），但这只是一个开始。

希望这可以帮助！

# javascript - 以未知宽度居中固定菜单

> ID：11254839
> 
> 赞同：1
> 
> 时间：2012-06-29T00:54:25.717
> 
> 标签：javascript, css

我需要在页面顶部居中并固定一个菜单。菜单的内容是动态的，所以事先不知道它的宽度。我在网上找到的解决方案假设宽度是已知的，或者位置不固定。

有没有办法做到这一点？

欢迎使用 CSS 和 JavaScript 解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:57:42.370

读[这个](http://css-tricks.com/centering-in-the-unknown/)。用图表和演示回答大多数中心问题。

在您的情况下，最简单的方法可能只是使用两个元素。在最外层的 div 上使用`position: fixed`和。`text-align: center`然后将居中的元素设置为`display: inline`。（当你这样做时，你必须小心字符空间。）

看这里：

[http://codepen.io/pen/7169/1](http://codepen.io/pen/7169/1)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T03:47:39.137

只需创建一个包装器 div，并将其设置为固定并将对齐设置为居中。那应该给你你正在寻找的东西。

```
​&lt;div style="position: fixed; top: 0; width: 100%;" align="center">
    <ul>
        <li>Menuitem</li>
        <li>Menuitem2</li>
    </ul>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

# jquery - Spring Web Flow 什么都不做

> ID：11254841
> 
> 赞同：0
> 
> 时间：2012-06-29T00:54:30.203
> 
> 标签：jquery, jsp, spring-webflow

我正在使用 Spring Web Flow，但是当我单击提交按钮时，它什么也没做；没有错误，没有例外，只是重定向到同一页面。这是我的代码：

顾问ControlOrdenAcunacionFlow.xml：

```
<view-state id="ConsultarControlOrdenAcunacion" model="ordenesAcunacionParaAutorizar">
    <binder>
        <binding property="ordenIds" required="true"></binding>            
        <binding property="comentario" required="true"></binding>            
    </binder>        
    <transition on="firmarOrdenes" to="GetDatosParaFirma" validate="false"/>
</view-state> 
```

顾问ControlOrdenAcunacion.jsp：

```
 <form:form id="formaAplicaAccion" modelAttribute="ordenesAcunacionParaAutorizar" action="${flowExecutionUrl}" method="POST" >
        <form:input path="ordenIds" id="ordenIds" type="hidden" name="ordenIds" value=""/>
        <form:input path="comentario" id="comentario" type="hidden" name="comentario" value="xxxxxxxxxxxxxxx"/>
        <table cellpadding="0" cellspacing="0" border="1" class="display" id="ordenes1" style="font-size: 12px;" >
        </table>
        <input style="display:none;" id="botonAutorizar" type="submit" name="_eventId_firmarOrdenes" value="Firmar Datos"/>
    </form:form> 
```

jQuery代码：

$("#formaAplicaAccion").submit();

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T21:45:31.883

我有同样的问题。我通过添加一个名称与按钮名称相同的隐藏元素来修复它。这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T03:18:34.840

我会先使用像 Firebug 这样的插件来查看提交的请求。我[敢打赌 JQuery form.submit() 不会提交](http://forum.jquery.com/topic/jquery-form-with-multiple-submit-buttons) `_eventId_firmarOrdenes`告诉 Web Flow 要进行哪个转换的按钮名称。

一些额外的提示：首先，标签`action=`中不需要。`form:form`我现在找不到权威来源，但如果您`action=`完全省略，WebFlow 会自动提供正确的操作值。

其次，`name` [不是 的有效](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#spring-form.tld.input)`form:input`属性。此外，通常您希望使用`form:hidden`代替`form:input`（有关有效属性，请参见相同的链接）。

# php - 这可以用作 PHP 中的 UUID 生成器吗？

> ID：11254848
> 
> 赞同：0
> 
> 时间：2012-06-29T00:56:01.493
> 
> 标签：php, uuid

在阅读了 PHP 中的“ [uniqid](http://php.net/manual/en/function.uniqid.php) ”函数之后，我继续编写了以下脚本：

```
<?php
echo implode(
    array_map(
        function(){ return dechex(rand(0, 255)); }
        , range(0, 15)
    )
); 
```

我在这里错过了什么吗？许多其他解决方案似乎过于复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:01:16.453

这就是为什么：

```
<?php
srand(1);
echo implode(
    array_map(
        function(){ return dechex(rand(0, 255)); }
        , range(0, 15)
    )
); 
```

在我的机器上，`d764c8cce93255c4478d7aa05d83f3ea`每次运行它都会返回（注意`srand`我添加的）。如果两个单独的应用程序使用相同的种子运行它，则保证该值*不是*唯一的。由于 PHP 自动确定种子（自 PHP 4.2.0 起），这可能会发生（不太可能，但可能会发生）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-25T23:30:36.337

我知道它已经快 8 年了，但如果你使用 linux，你可以

```
`uuidgen` 
```

# sql - 我无法使用在 sql azure 中创建的用户登录

> ID：11254849
> 
> 赞同：2
> 
> 时间：2012-06-29T00:56:05.237
> 
> 标签：sql, login, azure

我在 sql azure 中创建了一个登录名和一个用户，但我无法登录...我只能使用管理员帐户连接...

如何使用我创建的用户登录？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T15:40:48.173

我也一直在为此苦苦挣扎，经过一些研究，似乎只有 LOGINS 才能登录。用户（在特定数据库中通过登录创建）只是登录在访问该特定数据库时所假定的“角色”。

因此，同样，您不能以用户身份登录，只能使用登录名。如果您的意图是以某种方式创建对特定数据库的受限访问，那么您需要做一些工作：我目前正在查看以下文章：

[http://blogs.msdn.com/b/benjguin/archive/2012/01/21/sql-azure-create-a-login-that-has-only-access-to-one-database-sql-azure- cr-233-er-un-login-qui-na-acc-232-s-qu-224-une-base-de-donn-233-es.aspx](http://blogs.msdn.com/b/benjguin/archive/2012/01/21/sql-azure-create-a-login-that-has-only-access-to-one-database-sql-azure-cr-233-er-un-login-qui-n-a-acc-232-s-qu-224-une-base-de-donn-233-es.aspx)

HTH。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T21:23:45.790

如果您尝试使用 SQL Server Management Studio，则需要指定要连接到的数据库（登录屏幕 -> 选项 -> 连接属性），因为默认情况下，新登录名无权访问 SSMS 将访问的主数据库如果未指定数据库，请尝试打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:55:26.480

Windows Azure SQL 数据库安全性与标准 SQL Server 的工作方式大体相似，因为您必须确保为该用户创建了服务器登录名，以及在与登录名链接的数据库中创建的用户。查看文档以获取更多信息，以确保您没有遗漏任何步骤：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee336235.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee336235.aspx)

# java - 我应该如何记录不是由某个方法/构造函数引发但可能由另一个被调用的异常引发的异常？

> ID：11254851
> 
> 赞同：1
> 
> 时间：2012-06-29T00:56:23.933
> 
> 标签：java, documentation, javadoc

假设我有一个包含三个构造函数的类，如下所示：

```
public class ExampleClass {
    // constructor #1
    public ExampleClass(int a) {
        this(a, "aaa"); // "aaa" is just an arbitrary default for b
    }

    // constructor #2
    public ExampleClass(String b) {
        this(2, b); // 2 is just an arbitrary default for a
    }

    // constructor #3
    public ExampleClass(int a, String b) {
        // a has an arbitrary minimum value of 3
        // b has an arbitrary minimum length of 3
        if (a < 2 || b.length() < 2) {
            throw new IllegalArgumentException("a and b cannot be less than 2");
        }

        // ...
    }
} 
```

在这种情况下，我有三个构造函数。其中第三个是主构造函数，其他的只是提供默认值，因此可以只使用一个值而不是两个值来构造类。我正在尝试通过 JavaDoc 为此类类编写文档。如果我要为第一个或第二个构造函数编写文档，我会使用`@throws`标签来记录潜力`IllegalArgumentException`吗？或者我应该`IllegalArgumentException`只为第三个构造函数的文档保存文档吗？`a`在这种情况下，必须大于 2 或`b`必须长于 2 个字符的最佳、最合适的表达方式是什么？我如何声明`IllegalArgumentException`可以在没有记录的情况下抛出an `@throws`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:09:16.827

您的所有三个构造函数*都会*抛出异常（您可以凭经验验证这一点） - 您不能期望代码的使用者知道幕后发生的事情（即参数是否在构造函数中或通过某种方法进行检查由构造函数调用）。因此，您应该记录所有三个构造函数。

不重复自己总是好的，但并不总是实用的——Javadoc 无法表达你想要的关系，所以你需要长篇大论地表达它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:07:20.477

对所有 3 个使用已检查的异常并记录 - 或将 1 个设为私有并为其他 2 个记录。

# sql - 如何修复我的 Oracle 11G SQL 查询？

> ID：11254852
> 
> 赞同：1
> 
> 时间：2012-06-29T00:56:42.823
> 
> 标签：sql, oracle

我无法弄清楚我在这里的查询做错了什么。

```
SELECT ORDER#, SUM(PAIDEACH * QUANTITY) AS TOTAL 
    FROM ORDERITEMS 
    WHERE TOTAL > 39.9 
    GROUP BY ORDER# 
    ORDER BY TOTAL DESC; 
```

这是我不断收到的错误：

```
"TOTAL": invalid identifier 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T02:39:06.147

由于您希望在聚合函数上有一个谓词，因此可以使用`HAVING`子句

```
SELECT ORDER#, SUM(PAIDEACH * QUANTITY) AS TOTAL 
  FROM ORDERITEMS 
 GROUP BY ORDER# 
HAVING SUM(PAIDEACH * QUANTITY) > 39.9
 ORDER BY TOTAL DESC; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T01:13:39.707

如果要在`WHERE`子句中使用别名，则可以将查询放在另一个中`SELECT`：

```
SELECT *
FROM
(
    SELECT ORDER#, SUM(PAIDEACH * QUANTITY) AS TOTAL 
    FROM ORDERITEMS 
    GROUP BY ORDER# 
) x
WHERE x.TOTAL > 39.9 
ORDER BY x.TOTAL DESC; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T05:50:26.090

`order by 2 desc`（对列的数字引用以 1 开头）

无需编写嵌套查询，甚至无需为查询`having`添加子句。只需用数字引用列，但不要忘记在更改查询时更改它;-)

# python - Python 字符串操作。在第五位添加一个字符

> ID：11254853
> 
> 赞同：1
> 
> 时间：2012-06-29T00:57:10.513
> 
> 标签：python, string, list, hex

我认为表达我的问题的最佳方式是举一个例子：

我有一个十六进制数字，比如说`2f`。我想把这个十六进制数放在第五位，然后是零。所以在这种情况下我想要 `9002f`. 从这里我将把它转换回十进制。

我在想最好的方法是使用列表并拥有一个列表`['9','0','0','0','0']`和一个列表，`['2','f']`并以某种方式覆盖到 9000 列表。

你们有什么感想？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T00:58:49.137

为什么要进行字符串操作？听起来你想用十六进制数字做数学：

```
h = '2f'
h_int = int(h, 16)
h_int += 0x90000 
```

如果您确实需要获取字符串，则可以将其转回字符串：

```
"%x" % h_int 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:02:56.437

做你想做的事

```
def fillhex(h, n, pos):
    return n+h.zfill(pos-len(n)) 
```

.

```
fillhex('2f', '9', 5)
9002f

fillhex('4A', '9', 5)
9004A

fillhex('F', '9', 5)
9000F 
```

尽管正如@NedBatchelder 在他的回答中显示的那样，有更简单的方法可以在数字基数之间进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:06:37.983

有趣的要求，但这适用于可变位置：

```
>>> def place_n(a, b, pos):
    return '{0}{1:0>{2}}'.format(a, b, pos - len(a))

>>> place_n('9', '2f', 5)
'9002f' 
```

# eclipse - 如何让 Eclipse CDT 了解 MSPGCC (MSP430) 包含的内容？

> ID：11254854
> 
> 赞同：0
> 
> 时间：2012-06-29T00:57:16.773
> 
> 标签：eclipse, eclipse-cdt, msp430

我正在使用 Eclipse 和 CDT 与 mspgcc 编译器一起工作，它编译得很好，但是代码视图将我所有的特殊函数寄存器突出显示为未解析。

我创建了一个 C 项目，其中编译器是“msp430-gcc -mmcu=msp430x2012”，它设置为在 /usr/msp430/include/ 中查找包含。我已将链接器设置为“msp430-gcc -mmcu=msp430x2012”，并且设置为在 /usr/msp430/lib/ 中查找库。我已将汇编器设置为“msp430-as”。我告诉 eclipse 它正在制作一个精灵，并且我禁用了自动包含发现以在我的 linux 机器上找不到 i686 库（愚蠢的 eclipse！）。

这是代码：

```
#include <msp430.h>
#include <signal.h> //for interrupts

#define RED 1
#define GREEN   64
#define S2VAL   8

void init(void);

int main(void) {
  init();       //Setup Device

  P1OUT = GREEN;    //start with a green LED

  _BIS_SR(LPM4_bits);   //Go into Low power mode 4, main stops here

  return(1);        //never reached, surpresses compiler warning
}

interrupt (PORT1_VECTOR) S1ServiceRoutine(void) {
  //we wake the MCU here

  if (RED & P1IN) {
    P1OUT = GREEN;
  } else {
    P1OUT = RED;
  }

  P1IFG = 0;    //clear the interrupt flag or we immidiately go again

  //we resume LPM4 here thanks to the RETI instruction
}

void init(void) {
  WDTCTL = WDTPW + WDTHOLD;     // Stop WDT
  /*Halt the watchdog timer

  P1DIR = ~S2VAL;       //Set LED pins as outputs and S2 as input

  P1IES = S2VAL;        //interrupt on High to Low
  P1IE = S2VAL;         //enable interrupt for S1 only
  WRITE_SR(GIE);        //enable maskable interrupts
} 
```

mspgcc 中定义的所有变量包括 P1OUT 和 WDTCTL 在问题框中显示为“未解决”，但请记住它构建得很好。我什至尝试过明确地包含我的芯片的头文件（通常 msp430-gcc 通过 msp430.h 和 -mmcu 选项执行此操作）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T19:18:24.063

我通过明确包含 msp430g2553.h 文件解决了这个问题

```
#include <msp430g2553.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-30T13:37:57.150

[我按照这里](http://www.43oh.com/wp-content/uploads/2010/11/MSP430_MSPGCC_Eclipse_gdb.pdf)的说明解决了这个问题

# asp.net-mvc-3 - 我可以将 PartialViewResult 与 PagedList 一起使用并在 PartialView 中显示吗

> ID：11254855
> 
> 赞同：4
> 
> 时间：2012-06-29T00:57:22.010
> 
> 标签：asp.net-mvc-3, partial-views

大家好，我有一个问题，我可以在 PartialViewResult 操作中使用 PagedList 并在 PartialView 中显示结果吗？

这是一些代码

**控制器代码：**

```
public PartialViewResult CargosPorProyecto(string id, int? page)
    {
        var cargos = db.Cargo.Include(i => i.Proyectos).Where(i => i.NumProyecto.Equals(id)).OrderByDescending(i => i.Fecha);

        if (Request.HttpMethod != "GET")
        {
            page = 1;
        }

        var pageSize = 10;
        var pageNumber = (page ?? 1);
        var onePage = cargos.ToPagedList(pageNumber, pageSize);

        return PartialView("ListaCargosParcial", ViewBag.OnePage = onePage);
    } 
```

在我的 PartialView 中，我输入了这段代码来显示分页

```
<div class="pagination-right">
    <div class="span12">
       <%: Html.PagedListPager((IPagedList)ViewBag.OnePage, page => Url.Action("CargosPorProyecto", new { page = page }), new PagedListRenderOptions { LinkToFirstPageFormat = "<< Primera", LinkToPreviousPageFormat = "< Anterior", LinkToNextPageFormat = "Siguiente >", LinkToLastPageFormat = "&Uacute;ltima >>" })%> 
    </div>                    
    </div> 
```

当我加载包含部分视图的页面时，一切看起来都很好，但是当我单击下一步（“Siguiente”）时，我的部分视图中没有加载。

我希望我解释清楚并感谢您的时间。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:45:23.460

如果您想留在同一页面上，可以使用 AJAX。例如，如果您使用 jQuery，您可以订阅分页链接的点击事件，然后触发对相应控制器操作的 AJAX 请求，并使用返回的结果刷新部分：

```
$(function() {
    $('.pagination-right a').click(function() {
        $.ajax({
            url: this.href,
            type: 'GET',
            cache: false,
            success: function(result) {
                // refresh the contents of some container div for the partial
                // make sure you use the correct selector here
                $('#some_container_for_the_partial').html(result);
            }
        });

        // cancel the default action which is a redirect
        return false;
    });
}); 
```

# quartz-scheduler - 配置 Quartz.net 任务

> ID：11254856
> 
> 赞同：1
> 
> 时间：2012-06-29T00:57:33.463
> 
> 标签：quartz-scheduler, quartz.net

我希望能够在我的应用程序运行时设置一个或多个作业/触发器。作业和触发器列表将来自 db 表。我不关心将作业持久化到数据库以重新启动或跟踪目的。基本上我只想将 DB 表用作 INIt 设备。显然我可以通过自己编写代码来做到这一点，但我想知道是否有某种方法可以使用 SQLJobStore 来获得此功能，而无需使用调度程序在应用程序的整个生命周期内保持数据库更新的开销。

谢谢你的帮助！埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:18:59.250

作业存储的主要目的是存储调度程序的状态，因此没有内置的方法来做你想做的事。如果需要，您始终可以直接写入表格，这将为您提供所需的结果，但这并不是最好的方法。

推荐的方法是编写一些代码，从表中读取数据，然后使用远程连接到调度程序来调度作业。

# asp.net - 如果在 VisualStudio 中重新启动 VisualBasic Web 应用程序，ASP.NET cookie 不会持续存在

> ID：11254857
> 
> 赞同：1
> 
> 时间：2012-06-29T00:57:33.667
> 
> 标签：asp.net, vb.net, visual-studio-2010

如果我在 VisualStudio 中运行我的 Web 应用程序并设置 cookie，如果我结束 Web 应用程序并再次运行它，它们就不存在。

这是我的 cookie 设置和获取功能：

（“userInfo”是特殊的还是任意的？）

```
' Sets cookie cookie_name to cookie_value.
sub set_cookie( cookie_value , cookie_name  )
    response.Cookies( "userInfo" )( cookie_name ) = cookie_value 
    response.Cookies( SOFTWARE_PROGRAM_NAME).Expires = datetime.now.adddays(365*10)
end sub

' Returns cookie named cookie_name.
function get_cookie( byval cookie_name as string ) 
    If  Request.Cookies("userInfo") Is Nothing Then
        return ""
    else
        cookie_value =  Server.HtmlEncode(Request.Cookies( "userInfo" )( cookie_name ))
        return   cookie_value
    end if
end function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:01:34.760

这是因为您正在有效地杀死 Web 服务器。这将从内存中清除所有变量，包括 cookie。

尝试将其部署到 IIS。

# html - 表格行作为锚点

> ID：11254860
> 
> 赞同：4
> 
> 时间：2012-06-29T00:58:23.057
> 
> 标签：html, css

我正在尝试将我的整个表格行设置为锚点。我在这里读到将所有表格行内容放在锚标记内不是一个好习惯，因为 html 标准不允许这样做。

实现这一目标的最佳策略是什么？

我正在分析在每个表格单元格中放置一个锚标记的可能性，就像我在这个例子的 .day div 上所做的那样：http: [//jsfiddle.net/XdfCp/4/](http://jsfiddle.net/XdfCp/4/)这是一个好的解决方案吗？

这个解决方案的问题是锚没有覆盖所有的表格单元格空间。我已经以这种方式配置了锚点，但它并没有占用所有单元格空间：

```
 #ListaEventosPorMes a{
        display: block;
        width: 100%;
        height: 100%;
        color: White;
    } 
```

我需要的另一个行为是在所有行中而不是在特定的表格单元格锚点上获得悬停效果。你有什么想法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:02:40.963

自 IE7 以来的所有主流浏览器都支持`:hover`所有元素上的 CSS 伪类，包括`tr`，因此您不需要使用锚来设置悬停状态的样式。

至于你的其他问题，看看这个答案：[Make link in table cell fill the entire row height](https://stackoverflow.com/questions/3966027/make-link-in-table-cell-fill-the-entire-row-height)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T06:08:04.407

我不确定你想用锚做什么。我有一个用于显示 SQL 表行的表。当 PHP 创建表时，它会在`onclick`每个行标题中插入一个，并将行的索引作为参数。没有使用锚。

```
while ($row = mysql_fetch_array($result)) {
    $id = $row['resv_id'];
    $funct_call="Edit_Row($id)";
    echo "<tr " . "onclick=$funct_call" .  " >";
} 
```

`onclick`函数体是：

```
var target="./entry_form.php?submit=Edit&resv_id=index_num";
window.open( target.replace("index_num",id),'_self' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T11:54:11.700

在行的每个 td 内放置一个锚标签，并在锚标签内放置一个 div 但是你需要给它一个高度（最好给它一个最小高度，好像内容需要扩展一样）

* * *

```
.link {
width:100%;
min-height:100px; /**For example**/

}
<tr>
  <td><a><div class="link"></div></a></td>
  <td><a><div class="link"></div></a></td>
  <td><a><div class="link"></div></a></td>
</tr> 
```

# ruby-on-rails - 在 Rails 的多租户 Web 应用程序中确定和持久化当前租户

> ID：11254864
> 
> 赞同：1
> 
> 时间：2012-06-29T00:59:18.830
> 
> 标签：ruby-on-rails, multi-tenant

我正在考虑一个多租户应用程序 - 共享数据库，共享模式。租户标识符（租户键）将每一行与正确的租户相关联。

我不确定如何将tenant_id 加载到某种全局范围内。这应该怎么发生？我假设我会解析域，然后根据域查找tenant_id。

我的问题：

1.  在 rails 应用程序中查找会发生在哪里？在初始化程序中？这样做有更好的点吗？
2.  一旦我确定了tenant_id，保存它的最佳方法是什么 - 一个简单的 session_id？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T02:44:02.900

我为这个功能的控制器使用了一个前置过滤器。

您还可以对控制器类进行子类化以干燥控制器中的重复代码。

请注意，对给定租户信息的访问需要在每个用户的基础上进行身份验证。您需要确定给定用户是否可以访问多个租户。例如，用户“joe”是否应该有权访问租户 1 和 2？或者，Joe 是否需要按租户登录？

登录的授权应该控制对租户信息的访问。不要依赖域名来授予授权。

**回复：在哪里保存tenant_id？**存储在会话中。如果对会话的访问成本很高（存储在 DBMS 中），则在控制器启动期间将内存中的副本作为实例变量。谷歌了解 user_ids 的存储方式。

如果/何时用户想要访问不同的租户，您还应该确定用户体验。

**添加**要在用户登录之前查看要加载的欢迎屏幕，查看子域名是一个不错的选择。要查看传入请求使用的子域，请解析`request.fullpath()` [Docs。](http://api.rubyonrails.org/classes/ActionDispatch/Request.html#method-i-fullpath)在控制器过滤器中执行此操作。

由于授权来自user_id，记得测试joe在tenant1.app.com登录但只能访问tenant2.app.com的情况

**奖励答案**正在寻找一个模板系统，使您的客户能够完全控制其租户的用户界面？查看[Liquid 模板](http://liquidmarkup.org/)。我非常成功地使用它们使我的客户能够以安全的方式完全控制他们的外观和感觉。

**重新评论中的其他问题**

*   有关配置 Web 服务器的信息，请参见超级用户。该配置是特定于 Web 服务器的。
*   如果您希望欢迎屏幕不是通用的，那么您必须从请求 url 中知道如何自定义它。特定于租户的子域是最好的。如果没有子域，则显示通用欢迎 - 当此人登录时，您可以确定租户以及如何自定义。

**Re helper** -- 如果您的意思是视图助手，那么我不建议将其作为确定租户的主要位置。制作`@user`并`@tenant`成为您查找一次的轻量级模型，然后在同一会话的其他请求期间从会话中检索。模型将由控制器使用，并且可能会传递给模型。视图层也将能够看到它们并在必要时使用它们。

If the UI may look/will look completely different for the different tenants, then add a "tenant-display" layer in addition to the view. Eg have the view gather the instance variables, find the right Liquid template, then express the view via the template.

You don't want the view to be computing "if tenant_a then x else y"

# ruby - 如何让 Ruby 中的 Selenium WebDriver 记住 Firefox 中的 SSL 证书异常？

> ID：11254866
> 
> 赞同：1
> 
> 时间：2012-06-29T00:59:56.067
> 
> 标签：ruby, selenium, webdriver, ssl-certificate

因此，我正在尝试使用 Ruby 中的 Selenium WebDriver 为我们的 Web 应用程序编写一套测试，但由于 Firefox 中的 SSL 证书问题，我什至无法进入该应用程序。我们的应用程序部署在本地服务器上，并使用自签名 SSL 证书进行测试/开发。当您只是手动使用浏览器时，您可以告诉 Firefox 设置一个安全例外，并将其永久存储，这样可以正常工作。使用 Selenium 是不可能的。首先，在我能够设置永久异常之前测试失败。其次，在我设置异常的那一刻，Selenium 忘记了它并再次显示屏幕。

我已经尝试创建一个自定义配置文件`firefox -p`并在该配置文件中添加异常并通过 Selenium 加载它，但 Selenium 似乎不尊重该异常。我还尝试设置各种配置文件参数以使其忽略或接受证书，但 Selenium 似乎也忽略了这些配置文件参数。最后，我让 Selenium 添加了一个跳过无效证书屏幕的扩展，但它仍然不起作用。这是我的代码：

```
require 'rubygems'
require 'selenium-webdriver'

profile = Selenium::WebDriver::Firefox::Profile.from_name "Selenium"

profile.add_extension("./skip_cert_error-0.3.2-fx.xpi")
profile["browser.xul.error_pages"] = "false"
profile["browser.ssl_override_behavior"] = "1"

driver = Selenium::WebDriver.for(:firefox, :profile => profile) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T23:54:24.290

我想到了。诀窍是将证书下载到站点，并将其保存在某处，然后返回 Firefox 设置（加载了 Selenium 配置文件），手动上传证书，然后“编辑信任”以信任证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:11:45.747

给这只猫剥皮还有另一种方法。我正在使用 Cucumber\Ruby\Selenium 框架，而用于跳过不良证书的传统配置文件调整对我也不起作用。我最终做的是在 Ruby 代码中创建/更新一个 FF 配置文件，并为 FF 配置文件 ( `assume_untrusted_certificate_issuer`) 设置一个成员变量。然后我只是将配置文件传递给浏览器\驱动程序实例。看看这个：

```
profile = Selenium::WebDriver::Firefox::Profile.new   
profile.assume_untrusted_certificate_issuer=false
browser = Selenium::WebDriver.for :firefox, :profile => profile 
```

这一切都存在于我的`env.rb`档案中。

此处播放的版本：

```
Windows7 Pro
Ruby 1.9.3,
Selenium Webdriver Gem 2.19, and
Firefox 14.0.1 
```

很甜吧？

# django - Django 1.4 配置设置

> ID：11254868
> 
> 赞同：1
> 
> 时间：2012-06-29T01:00:38.877
> 
> 标签：django, heroku, django-settings

我一直在使用 Django，但我最近升级到了 1.4。

当我创建一个新项目时，它是这样制作的：

```
-my_proj
    -my_app
    -settings.py
    -urls.py
    -wsgi.py
-venv
-manage.py
-requirements.txt 
```

我正在我的本地机器和 Heroku 上工作。问题是我应该如何引用模块。

当我在本地机器上时，一切似乎都应该被称为`my_proj.my_app`. 但是，当我在 Heroku 上时，所有内容都必须称为`my_app`.

有谁知道我应该查看可能导致此问题的某些区域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T06:31:08.037

将您的`my_app`dir 移动到项目的根目录（所在`manage.py`位置），正如在[Django 1.4 的 Django 教程](https://docs.djangoproject.com/en/dev/intro/tutorial01/)中所做的那样，它将使其成为顶级模块，并允许您像`my_app`在本地计算机上一样导入它们。我建议尝试这个并检查 Heroku 的行为是否相同。

`__init__.py`或者，在您的`my_proj`目录中添加一个空`my_proj`的`my_proj.my_app`.

我希望我的建议是有见地和有帮助的。

祝你好运！

# android - 在Android中使按钮出现然后在几秒钟后消失

> ID：11254876
> 
> 赞同：0
> 
> 时间：2012-06-29T01:02:50.590
> 
> 标签：android

我有几个按钮，我想随机出现，然后在几秒钟后消失。我还希望它们在可见时可以点击，如果这有任何改变的话。

这是我所拥有的：

```
public void fight() throws InterruptedException
{
    Random g = new Random();
    int move;
    for(int i = 0; i <= 3; i++)
    {
        move = g.nextInt(8);
        buttons[move].setVisibility(View.VISIBLE);
        buttons[move].setClickable(true);

        try{ Thread.sleep(5000); }catch(InterruptedException e){ }

        buttons[move].setVisibility(View.GONE);
        buttons[move].setClickable(false);
    }

} 
```

但是，当我尝试这样做时，整个事情只会冻结 20 秒（大概每次循环 5 秒，但没有任何反应。有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T05:51:57.573

你试过这种方式吗？

```
private int move;
public void fight() throws InterruptedException
{
    final Random g = new Random();
    runOnUiThread(new Runnable() 
    {
        public void run() {
            while(makeACondition) {
            move = g.nextInt(8);

            toggleButtonState(buttons[move]);
          } 
       }
   });
}

private void toggleButtonState(final Button button)
{
    new Handler().postDelayed(new Runnable() {

        @Override
        public void run() {
            if(button.isEnabled())
                button.setVisibility(View.GONE);
            else 
                button.setVisibility(View.VISIBLE);

        }
    }, 5000);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:07:44.300

尝试这个

```
public void fight() throws InterruptedException
{
    Random g = new Random();
    int move;
    runOnUiThread(new Runnable() 
    {
        public void run() {
            while(makeACondition) {
            move = g.nextInt(8);
            buttons[move].setVisibility(View.VISIBLE);
            buttons[move].setClickable(true);

            if (System.currentTimeMillis() % 5000 == 0) {

                buttons[move].setVisibility(View.GONE);
                buttons[move].setClickable(false);
            }
          } 
       }
   }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T01:31:40.543

```
private Handler mMessageHandler = new Handler();
Random g = new Random();
int move;

private Runnable mUpdaterRunnable = new Runnable() {
    public void run() {
        // hide current button
        buttons[move].setVisibility(View.INVISIBLE);
        // set next button
        move = g.nextInt(8);
        // show next button
        buttons[move].setVisibility(View.VISIBLE);

        // repeat after 5 seconds
        mMessageHandler.postDelayed(mUpdaterRunnable, 5000);
    }
}; 
```

首先，使用`move = g.nextInt(8);`（避免空值）和`mMessageHandler.post(mUpdaterRunnable);`.

要停下来，`mMessageHandler.removeCallbacks(mUpdaterRunnable);`。

正如 xbonez 所说，您也可以使用 s 来实现这一点`Timer`。`TimerTask`

# facebook - facebook like box - 照片拉伸 - 但只有在未登录 facebook 的情况下？

> ID：11254879
> 
> 赞同：2
> 
> 时间：2012-06-29T01:02:59.963
> 
> 标签：facebook, plugins, social, facebook-likebox

我在我的客户的网站主页上嵌入了一个类似 facebook 的框。它工作得很好，但照片看起来是垂直拉伸的。奇怪的是，如果我登录 facebook 并查看主页，照片是完美的。这真的让我很困惑！它可以修复吗？谢谢！

主页在这里： [http ://harwu13.wix.com/redhentrialiste#!home/mainPage](http://harwu13.wix.com/redhentrialiste#!home/mainPage)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T17:02:29.997

根据以下链接：

> “我们 [Facebook] 已经确认并分配了这个漏洞。”

但是对于所有发帖的人来说，它仍然非常令人沮丧！

[http://developers.facebook.com/bugs/173741066089584/](http://developers.facebook.com/bugs/173741066089584/)

# android - 谷歌阅读器 api 标记为已读返回 411 错误（在 android 上使用 java）

> ID：11254883
> 
> 赞同：0
> 
> 时间：2012-06-29T01:04:39.280
> 
> 标签：android, google-reader

我正在android平台上做一些关于谷歌阅读器的开发。

使用[google reader api](http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI)，我可以成功获取 RSS 列表。但是当我想将 RSS 项目标记为已读时，出现“需要 411 长度”错误。这是我的代码：

```
 HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(
            "http://www.google.com/reader/api/0/edit-tag");
    httppost.addHeader("Authorization", auth);

    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("i", itemId));
    nameValuePairs.add(new BasicNameValuePair("a",
            "user/-/state/com.google/read"));
    nameValuePairs.add(new BasicNameValuePair("async", "true"));
    nameValuePairs.add(new BasicNameValuePair("T", token));
    nameValuePairs.add(new BasicNameValuePair("s", feedUrl));
    try {
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        Toast.makeText(getApplicationContext(),
                EntityUtils.toString(response.getEntity()),
                Toast.LENGTH_LONG).show();
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

有什么不对的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T01:16:43.717

我自己已经解决了这个问题。

我收到此错误是因为该部分末尾`auth`有一个额外的换行符。`'\n'`所以我使用该`trim()`方法将其删除。

现在可以了。我希望这可以帮助某人。

# javascript - 通过ajax请求提交html表单？

> ID：11254884
> 
> 赞同：6
> 
> 时间：2012-06-29T01:04:43.837
> 
> 标签：javascript, jquery, html, ajax, forms

> **可能重复：**
> [jQuery AJAX 提交表单](https://stackoverflow.com/questions/1960240/jquery-ajax-submit-form)

我在页面 A 上有一个表单，而不是我发布到一个新页面，有没有办法我可以做 onSubmit ajax 请求呢？我想让页面能够将结果加载到 div 中。

我知道如何为调用类编写脚本，但我不确定我是否必须手写它，或者是否可以获取所有表单信息并将其发送而无需将其全部编码到属性中。我在想我可以做一些类似的事情：onClick，发布表单但将结果返回到一个 div。

想法？想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T01:10:36.473

尝试使用 JQuery `serialize`(API ref [here](http://api.jquery.com/serialize/) )

编辑：是这样的：

```
 $("input.submit").click( function() {
    $.ajax( {
      type: "POST",
      url: $("form").attr( 'action' ),
      data: $("form").serialize(),
      success: function( response ) {
        //Code to process the response
      }
    });
    return false;
  } ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T01:10:49.140

```
$.ajax({
 url: 'mypage.html',
 success: function(data){
    $('.result').html(data);
 },
 error: function(){
   alert('failure');
 }
}); 
```

然后你有一个div：

```
<div class="result"> </div> 
```

这将自动填充您的 ajax 帖子的结果。

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

另请参阅大量相关问题：[Jquery checks success of ajax post](https://stackoverflow.com/questions/555315/jquery-checking-success-of-ajax-post)

# vba - VBA：是否可以在单行“Nothing”中声明和实例化对象？

> ID：11254885
> 
> 赞同：2
> 
> 时间：2012-06-29T01:04:59.217
> 
> 标签：vba

以下代码在一行中声明并实例化一个对象，然后尝试将其设置为 Nothing

```
Dim myObject As New MyClass
Set myObject = Nothing
MsgBox (myObject Is Nothing) 'FALSE 
```

第三行的消息是“False”。但是，如果我将声明和实例化分成两行，如下所示：

```
Dim myObject As MyClass
Set myObject = New MyClass
Set myObject = Nothing
MsgBox (myObject Is Nothing) 'TRUE 
```

突然消息是“真实的”。我已经在一行中声明并实例化了很多对象，可能需要将其设为 Nothing。有没有办法在不更改所有声明的情况下做到这一点？

另外，如果有人能解释为什么会这样，我将不胜感激。我是 VBA 自学成才，并不太懂这种语言……与我常用的语言相比，这很奇怪……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T05:36:12.223

尝试检查**Locals 窗口**中的引用变量，这应该向您解释。如前所述，问题是由于`Dim ... As New ...` **myObject**引用变量被分配给 msgbox 语句中的对象。如果您之后将其设置为空，它将再次变为空。

# c - 正在运行的 C 程序可以访问自己的符号表吗？

> ID：11254891
> 
> 赞同：13
> 
> 时间：2012-06-29T01:06:18.433
> 
> 标签：c, linux, gcc, elf, symbol-tables

我有一个 linux C 程序来处理发送到 TCP 套接字（绑定到特定端口）的请求。我希望能够通过对该端口的请求来查询 C 程序的内部状态，但我不想硬编码可以查询哪些全局变量。因此，我希望查询包含全局的字符串名称和 C 代码以在符号表中查找该字符串以找到其地址，然后通过 TCP 套接字将其值发送回。当然，符号表一定不能被剥离。那么 C 程序甚至可以找到自己的符号表，并且是否有一个库接口用于查找给定名称的符号？这是一个使用 gcc 构建的 ELF 可执行 C 程序。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T01:41:02.787

这实际上相当容易。您使用`dlopen`/`dlsym`来访问符号。为了使其工作，符号必须存在于动态符号表中。有多个符号表！

```
#include <dlfcn.h>
#include <stdio.h>

__attribute__((visibility("default")))
const char A[] = "Value of A";

__attribute__((visibility("hidden")))
const char B[] = "Value of B";

const char C[] = "Value of C";

int main(int argc, char *argv[])
{
    void *hdl;
    const char *ptr;
    int i;

    hdl = dlopen(NULL, 0);
    for (i = 1; i < argc; ++i) {
        ptr = dlsym(hdl, argv[i]);
        printf("%s = %s\n", argv[i], ptr);
    }
    return 0;
} 
```

要将所有符号添加到动态符号表中，请使用`-Wl,--export-dynamic`. 如果要从符号表中删除大多数符号（推荐），请使用或其他方法之一设置`-fvisibility=hidden`然后显式添加所需的符号。`__attribute__((visibility("default")))`

```
~ $ gcc dlopentest.c -Wall -Wextra -ldl
~ $ ./a.out ABC
A =（空）
B =（空）
C =（空）
~ $ gcc dlopentest.c -Wall -Wextra -ldl -Wl,--export-dynamic
~ $ ./a.out ABC
A = A 的值
B =（空）
C = C 的值
~ $ gcc dlopentest.c -Wall -Wextra -ldl -Wl,--export-dynamic -fvisibility=hidden
~ $ ./a.out ABC
A = A 的值
B =（空）
C =（空）

```

# 安全

请注意，不良行为的空间很大。

```
$ ./a.out printf
printf = ▯▯▯▯ *（垃圾）*

```

如果您希望这样做是安全的，您应该创建一个允许符号的白名单。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-29T03:01:05.800

文件：反射.c

```
#include <stdio.h>
#include "reflect.h"

struct sym_table_t gbl_sym_table[1] __attribute__((weak)) = {{NULL, NULL}};

void * reflect_query_symbol(const char *name)
{
    struct sym_table_t *p = &gbl_sym_table[0];

    for(; p->name; p++) {
        if(strcmp(p->name, name) == 0) {
            return p->addr;
        }
    }
    return NULL;
} 
```

文件：反射.h

```
#include <stdio.h>

struct sym_table_t {
    char *name;
    void *addr;
};

void * reflect_query_symbol(const char *name); 
```

文件：main.c

只需#include "reflect.h" 并调用 reflect_query_symbol

例子：

```
#include <stdio.h>
#include "reflect.h"

void foo(void)
{
    printf("bar test\n");
}

int uninited_data;

int inited_data = 3;

int main(int argc, char *argv[])
{
    int i;
    void *addr;

    for(i=1; i<argc; i++) {
        addr = reflect_query_symbol(argv[i]);
        if(addr) {
            printf("%s lay at: %p\n", argv[i], addr);
        } else {
            printf("%s NOT found\n", argv[i], addr);
        }
    }

    return 0;
} 
```

文件：生成文件

```
objs = main.o reflect.o

main: $(objs)
        gcc -o $@ $^
        nm $@ | awk 'BEGIN{ print "#include <stdio.h>"; print "#include \"reflect.h\""; print "struct sym_table_t gbl_sym_table[]={" } { if(NF==3){print "{\"" $$3 "\", (void*)0x" $$1 "},"}} END{print "{NULL,NULL} };"}' > .reflect.real.c
        gcc -c .reflect.real.c -o .reflect.real.o
        gcc -o $@ $^ .reflect.real.o
        nm $@ | awk 'BEGIN{ print "#include <stdio.h>"; print "#include \"reflect.h\""; print "struct sym_table_t gbl_sym_table[]={" } { if(NF==3){print "{\"" $$3 "\", (void*)0x" $$1 "},"}} END{print "{NULL,NULL} };"}' > .reflect.real.c
        gcc -c .reflect.real.c -o .reflect.real.o
        gcc -o $@ $^ .reflect.real.o 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T01:21:10.513

这种特性的总称是“[反射](http://en.wikipedia.org/wiki/Reflection_%28computer_programming%29)”，它不是 C 的一部分。

如果这是出于调试目的，并且您希望能够远程检查 C 程序的整个状态、检查任何变量、启动和停止其执行等等，您可以考虑[GDB](http://davis.lbl.gov/Manuals/GDB/gdb_17.html) [远程调试](http://en.wikipedia.org/wiki/GNU_Debugger#Remote_debugging)：

> GDB 提供了调试嵌入式系统时经常使用的“远程”模式。远程操作是指 GDB 在一台机器上运行而被调试的程序在另一台机器上运行。GDB 可以通过串行或 TCP/IP 与理解 GDB 协议的远程“存根”通信。可以通过链接到 GDB 提供的适当存根文件来创建存根程序，这些存根文件实现了通信协议的目标端。或者，可以使用 gdbserver 远程调试程序，而无需以任何方式对其进行更改。

# scala - Scala 2.10 反射 API 中的类型相等

> ID：11254893
> 
> 赞同：5
> 
> 时间：2012-06-29T01:06:44.570
> 
> 标签：scala, reflection, types, scala-2.10

我在[Scala 2.10.0 Milestone 4](http://www.scala-lang.org/node/12702)中遇到了一个奇怪的问题，我无法解决这个问题。首先是按我期望的方式工作的东西：

```
scala> import scala.reflect.runtime.universe._
import scala.reflect.runtime.universe._

scala> trait A[X]; trait B[Y] extends A[Y]
defined trait A
defined trait B

scala> typeOf[B[String]].parents
res0: List[reflect.runtime.universe.Type] = List(java.lang.Object, A[String])

scala> typeOf[B[String]].parents contains typeOf[A[String]]
res1: Boolean = true 
```

同样（在同一会话中）：

```
scala> trait D; trait E extends A[D]
defined trait D
defined trait E

scala> typeOf[E].parents
res2: List[reflect.runtime.universe.Type] = List(java.lang.Object, A[D])

scala> typeOf[E].parents contains typeOf[A[D]]
res3: Boolean = true 
```

这并不奇怪：我可以要求一个类型的父母并得到我所期望的。现在我基本上结合了上面的两个例子：

```
scala> trait F extends A[String]
defined trait F

scala> typeOf[F].parents
res4: List[reflect.runtime.universe.Type] = List(java.lang.Object, A[String])

scala> typeOf[F].parents contains typeOf[A[String]]
res5: Boolean = false 
```

我不明白这怎么可能是假的。`F`如果我有extend `A[Seq[D]]`,等，也会发生同样的事情`A[Int]`。我缺少什么可以使这种行为有意义的概括？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T08:56:22.597

那是一个错误。就在今天早上，我打算调查并修复它。

**编辑**. 这似乎是泄漏到用户空间的 Scala 反射 API 的实现细节。它不容易修复，所以现在我们保持原样，但会研究改进的可能性。

同时，要获得正确的结果，应该始终使用`=:=`比较类型，而不是`==`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T02:55:51.470

另一个奇怪的例子：

```
scala> val atype = typeOf[A[String]]
atype: reflect.runtime.universe.Type = A[String]

scala> val atype2 = typeOf[F].parents(1)
atype2: reflect.runtime.universe.Type = A[String]

scala> typeOf[F].parents contains atype
res39: Boolean = false

scala> typeOf[F].parents contains atype2
res40: Boolean = true 
```

我认为您看到了与此类似的错误： [https](https://issues.scala-lang.org/browse/SI-5959) ://issues.scala-lang.org/browse/SI-5959 （尽管我已经确认这种奇怪现象也发生在 REPL 之外）。

# ruby-on-rails - 设计注册控制器获取零资源的自定义操作

> ID：11254895
> 
> 赞同：6
> 
> 时间：2012-06-29T01:06:50.493
> 
> 标签：ruby-on-rails, devise

基本上，我希望有两个单独的操作来更改密码和更改电子邮件，而不仅仅是一个。

我已经更新了我的路由以指向我的新控制器，该控制器继承自 Devise::RegistrationsController。

我的路线.rb：

```
devise_for :users, :controllers => { :registrations => "registrations" }

devise_scope :user do
  get "/users/password" => "registrations#change_password", :as => :change_password
end 
```

我的registrations_controller.rb

```
class RegistrationsController < Devise::RegistrationsController

  def change_password
  end

end 
```

我的 app/views/devise/registrations/change_password.html.erb

```
<%=debug resource%> 
```

这给了我零。

我在这里想念什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-08T23:47:31.950

在 Devise 的内置[registrations_controller.rb](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb)中，有一个`authenticate_scope!`方法可以创建`resource`您要查找的对象。它由 a 执行`prepend_before_filter`，但仅适用于某些方法：

```
class Devise::RegistrationsController < DeviseController
  ...
  prepend_before_filter :authenticate_scope!, :only => [:edit, :update, :destroy]` 
```

所以你只需要告诉你的自定义控制器在你的`change_password`方法上运行那个过滤器：

```
class RegistrationsController < Devise::RegistrationsController

  prepend_before_filter :authenticate_scope!, :only => [:change_password]

  def change_password
  end

end 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-01T09:16:49.663

```
class RegistrationsController < Devise::RegistrationsController

  def change_password
    super
    @resource = resource
  end
end 
```

app/views/devise/registrations/change_password.html.erb

```
<%=debug @resource%> 
```

# boost - ./configure 看不到/找不到 boost 头文件

> ID：11254898
> 
> 赞同：7
> 
> 时间：2012-06-29T01:07:32.710
> 
> 标签：boost, compiler-construction, fedora, gearman

尝试在 Fedora 64 系统上使用 bzr 从 Launchpad 的 gearmand-0.33.tar.gz 构建 gearman。

自己执行 ./configure 以及使用“-with-boost=/usr/include”参数会生成警告和错误，因为配置过程似乎无法找到/定位 boost 头文件。

我们还通过“yum install boost*”删除/重新安装了 boost 头文件

将尝试任何指针！

谢谢

```
./configure
.
.
.
checking if more special flags are required for pthreads... no
checking for PTHREAD_PRIO_INHERIT... yes
checking for Boost headers version >= 1.39.0... yes
checking for Boost's header version... 1_41
checking for the toolset name used by Boost for g++... gcc44 -gcc
checking boost/program_options.hpp usability... no
checking boost/program_options.hpp presence... yes
configure: WARNING: boost/program_options.hpp: present but cannot be compiled
configure: WARNING: boost/program_options.hpp:     check for missing prerequisite headers?
configure: WARNING: boost/program_options.hpp: see the Autoconf documentation
configure: WARNING: boost/program_options.hpp:     section "Present But Cannot Be Compiled"
configure: WARNING: boost/program_options.hpp: proceeding with the compiler's result
configure: WARNING:     ## -------------------------------------------------- ##
configure: WARNING:     ## Report this to https://bugs.launchpad.net/gearmand ##
configure: WARNING:     ## -------------------------------------------------- ##
checking for boost/program_options.hpp... no
configure: error: cannot find boost/program_options.hpp 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-11T20:20:54.667

刚刚处理了这个问题，安装了 gcc-c++ 并解决了它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T05:24:42.737

正确的选项可能是`--with-boost`，您应该使用`./configure -h`.

另外，检查目录是否`/usr/include/boost`存在，因为这似乎是它正在寻找的东西。

此外，请确保您不应该使用`--with-boost-include=/usr/include`（也可能是`--with-boost-libs`（或`-lib`））。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-11T00:05:11.403

在我的情况下，使用`--with-boost=/path/to/root`工作，其中`/path/to/root`包含`include/boost`。

换句话说，`--with-boost=/path/to/root/include`或者`--with-boost=/path/to/root/include/boost`两者都是错误的。

我也设置`--with-boost-libdir=/path/to/root/lib64`

# iphone - 根据用户输入更改多个视图中的内容 [xCode/iOS]

> ID：11254899
> 
> 赞同：0
> 
> 时间：2012-06-29T01:07:37.307
> 
> 标签：iphone, ios, xcode, storyboard, automatic-ref-counting

这可能相当简单，但我很难理解它。我正在创建的应用程序的基本前提是拥有一个列出一堆主题的 TableView。用户选择其中之一，一个 TabBarController 被推送，我打算让这些子视图中的内容根据原始选择进行更改。

我已经四处寻找一种正确执行此操作的方法，但似乎找不到任何可以解决我如何将内容推送到这些视图的方法。最初，我使用的是带有 SegmentedSelection 元素的 ViewController。基本上，我会使用控制器的标题，它会自动从 TableView 选择继承，格式化它，并使此表单成为相关内容链接的基础，即我将有一个可以加载文件 .png 的图像视图. 显然，这远不如使用本机 UITabBarController 那样用户友好。

任何帮助是极大的赞赏。

PS：我正在使用 StoryBoards 和 ARC。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:31:35.017

好的，所以您在调用时将要访问的视图控制器中`pushViewController`，您需要创建一个自定义`init`方法。类似的东西`initWithId:(NSUInteger *)rowID`。确保在头文件中声明它。然后在您的第一个带有表格的视图控制器中，当您初始化您将要使用的 viewController（并设置委托）时，您将调用您的自定义`init`方法，而不是仅仅调用`init`并传递`[myArray objectAtIndex:selectedRowThatsAnNSUinteger]`. 如果需要，您也可以只传递整个数组，而不是传递行#。如果您这样做，请确保更改自定义 init 方法以匹配更改。现在，在您的视图控制器的新`init`方法中，您可以获取方法中提供给它的内容，并对传递的数字进行某种检查（因为您知道行号）。希望这会有所帮助。

# lockless - 无锁多读、单写链表

> ID：11254903
> 
> 赞同：2
> 
> 时间：2012-06-29T01:08:20.113
> 
> 标签：lockless

我一直在网上探索各种无锁/无锁链表的解决方案。我遇到了诸如 RCU、危险指针和辅助节点/“标记”节点上的出版物等技术来解决这个问题。它们都解决了多个作者和读者的并发问题。
在寻求任何这些解决方案之前，我想检查是否有任何更简单的标准技术来开发无锁算法，用于单写 - 多读链表。（支持的操作是添加、删除、查找和更新）

谢谢你的时间。斯里兰卡

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-06-02T05:52:05.870

在我的想法中，如果您只有 1 个作家，您可以使用客户端/服务器设计进行读写。

# sql - 选择不同的。请解释？

> ID：11254906
> 
> 赞同：0
> 
> 时间：2012-06-29T01:08:49.790
> 
> 标签：sql, distinct

想知道是否有人可以解释这两个查询之间的区别，并告知为什么一个有效而另一个无效。

这个有效。给我两条不同的 GantryRtn 值及其对应的 SSD 值的记录。

```
SELECT DISTINCT GantryRtn as Gantry, ROUND(Field.SSD,1) as SSD
            FROM Field, PlanSetup, Course, Patient, Radiation
                    WHERE Field.RadiationSer=Radiation.RadiationSer
                        AND Radiation.PlanSetupSer=PlanSetup.PlanSetupSer
                        AND PlanSetup.CourseSer=Course.CourseSer
                        AND Course.PatientSer=Patient.PatientSer
                        AND Patient.PatientId='ZZZ456'
                        AND PlanSetup.PlanSetupId='F T1 R CHEST' 
```

但是，*字段*表中有一个外键链接到另一个表的主键，该表包含每个字段的纯文本名称。我还想通过提取此外键*RadiationSer*来提取该名称（如果必须，在单独的查询中） 。但是，一旦我将*RadiationSer*放入查询中，我就会丢失 DISTINCT 结果。

```
SELECT DISTINCT GantryRtn as Gantry, ROUND(Field.SSD,1) as SSD, Field.RadiationSer
            FROM Field, PlanSetup, Course, Patient, Radiation
                    WHERE Field.RadiationSer=Radiation.RadiationSer
                        AND Radiation.PlanSetupSer=PlanSetup.PlanSetupSer
                        AND PlanSetup.CourseSer=Course.CourseSer
                        AND Course.PatientSer=Patient.PatientSer
                        AND Patient.PatientId='ZZZ456'
                        AND PlanSetup.PlanSetupId='F T1 R CHEST' 
```

第二个查询为我提供了 7 条具有非不同*GantryRtn*值的记录。

为什么会这样？？

我已经使用 GROUP BY 进行了调查，但这会减慢查询速度，并且似乎会将所有 GantryRtn 从数据库中拉出（100 条记录）。

谢谢格雷格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T01:14:24.513

DISTINCT 关键字适用于结果集（所有字段），而不仅仅是第一个字段。

在你的情况下：

```
SELECT DISTINCT GantryRtn as Gantry, ROUND(Field.SSD,1) as SSD, Field.RadiationSer 
```

将返回任何不同（不相同）的记录与`Gantry, SSD, and RadiationSer`

因此，您可能有 7 条相同`Gantry`且具有不同 RadiationSer 值的记录。

如果您想首先按不同的`Gantry`值进行过滤，您可以使用子查询和内部连接来完成此操作，但您必须以某种方式确定`RadiationSer`要使用的值。

# amazon-web-services - 如何在 Elastic Beanstalk 上设置 Loggly？

> ID：11254908
> 
> 赞同：16
> 
> 时间：2012-06-29T01:09:10.757
> 
> 标签：amazon-web-services, amazon-elastic-beanstalk, loggly

我想将 Loggly 设置为在 AWS Elastic Beanstalk 上运行，但找不到有关如何执行此操作的任何信息。是否有任何指南，或有关如何开始的一般指南？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T09:09:02.030

对于 papertrailapp.com（我更喜欢它而不是 loggly），我就是这样做的。在您创建的`/ebextensions`文件夹（[查看更多信息](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/customize-containers.html)）`logs.config`中，指定：

```
container_commands:
  01-set-correct-hostname:
    command: hostname www.example.com
  02-forward-rsyslog-to-papertrail:
    # https://papertrailapp.com/systems/setup
    command: echo "*.* @logs.papertrailapp.com:55555" >> /etc/rsyslog.conf
  03-enable-remote-logging:
    command: echo -e "\$ModLoad imudp\n\$UDPServerRun 514\n\$ModLoad imtcp\n\$InputTCPServerRun 514\n\$EscapeControlCharactersOnReceive off" >> /etc/rsyslog.conf
  04-restart-syslog:
    command: service rsyslog restart 
```

`55555`应替换为 papertrailapp.com 提供的 UDP 端口号。每次新实例引导后，都会应用此配置。然后，在你的`log4j.properties`：

```
log4j.rootLogger=WARN, SYSLOG
log4j.appender.SYSLOG=org.apache.log4j.net.SyslogAppender
log4j.appender.SYSLOG.facility=local1
log4j.appender.SYSLOG.header=true
log4j.appender.SYSLOG.syslogHost=localhost
log4j.appender.SYSLOG.layout=org.apache.log4j.PatternLayout
log4j.appender.SYSLOG.layout.ConversionPattern=[%p] %t %c: %m%n 
```

我不确定这是否是最佳解决方案。[在jcabi-beanstalk-maven-plugin](http://beanstalk.jcabi.com/example-syslog.html)中阅读有关此机制的更多信息

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-26T02:38:09.320

您还可以使用 loggly 本身的安装脚本。[下面的设置遵循https://www.loggly.com/docs/configure-syslog-script/](https://www.loggly.com/docs/configure-syslog-script/)上的旧版设置说明，并进行了细微更改（没有确认提示，sudo 命令被替换，因为没有 tty 可用）

（编辑：更新的链接，现在在 loggly 文档中似乎是一个过时的解决方案）

将以下脚本放入 .ebextensions/loggly.config

将 TOKEN 和 ACCOUNT 替换为您自己的。

```
#
# Install loggly.com on AWS Elastic Beanstalk
# Tested with node.js environment
# Save this file as .ebextensions/loggly.config
# Deploy per normal scripts or aws.push. To help debug the push, ssh & tail /var/log/cfn-init.log
# See Also /var/log/eb-tools.log
#

commands:
  01_loggly_dl:
    command: wget -q -O /tmp/loggly.py https://www.loggly.com/install/configure-syslog.py
  02_loggly_config:
    command: su --session-command="python /tmp/loggly.py setup --auth TOKEN --account ACCOUNT --yes" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-22T15:42:05.187

以下是 loggly 支持站点的链接，用于将 syslogd 与 loggly 一起使用： [http ://wiki.loggly.com/loggingconfiguration](http://wiki.loggly.com/loggingconfiguration)

或将 loggly api 与您自己的应用程序一起使用： [http ://wiki.loggly.com/apidocumention](http://wiki.loggly.com/apidocumention)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-25T23:20:34.747

这是我刚刚开始使用的 Loggly 的 elasticbeanstalk 配置，这要归功于来自该线程的指针和日志记录 SaaS 供应商设置说明。[[Loggly 配置管理](http://loggly.com/support/advanced/configuration-management/)，[Papertrail rsyslog](http://help.papertrailapp.com/kb/configuration/advanced-unix-logging-tips#rsyslog_aggregate_log_files) ]

将文件另存为 .ebextensions 目录中的 loggly.config 并确保检查 YAML 格式约定（无制表符等）。根据需要将您的 Loggly TCP 端口号、用户名、密码和域名替换到尖括号中。

请注意，对于 AWS ruby​​ 版本的 elasticbeanstalk，EC2 /etc/rsyslog 设置可能存在差异。例如，如果 /etc/rsyslog.d 已经存在，并且已经有“$IncludeConfig /etc/rsyslog.d/*.conf”指令，那么命令“01-forward-rsyslog-to-loggly:”可以是删除。

按照普通脚本或 aws.push 进行部署。为了帮助调试推送，ssh & tail /var/log/cfn-init.log

```
files:
  "/etc/rsyslog.d/90-loggly.conf" :
    mode: "000664"
    owner: root
    group: root
    content: |
      # ### begin forwarding rule ###
      # The statement between the begin ... end define a SINGLE forwarding
      # rule. They belong together, do NOT split them. If you create multiple
      # forwarding rules, duplicate the whole block!
      # Remote Logging (we use TCP for reliable delivery)
      #
      # An on-disk queue is created for this action. If the remote host is
      # down, messages are spooled to disk and sent when it is up again.
      $WorkDirectory /var/lib/rsyslog # where to place spool files
      $ActionQueueFileName fwdRule1 # unique name prefix for spool files
      $ActionQueueMaxDiskSpace 1g   # 1gb space limit (use as much as possible)
      $ActionQueueSaveOnShutdown on # save messages to disk on shutdown
      $ActionQueueType LinkedList   # run asynchronously
      $ActionResumeRetryCount -1    # infinite retries if host is down
      *.* @@logs.loggly.com:<yourportnum>   # !!!Loggly supplied port number for each app!!!
      # ### end of the forwarding rule ###
    encoding: plain
  "/tmp/loggly.py" :
    mode: "000755"
    owner: root
    group: root
    content: |
      import json
      import sys
      import urllib2
      '''
      Auto-authenticate Syslog TCP inputs.
      Usage: python inputs.py -u user -p pass -s subdomain
      '''
      state = None
      params = {}
      for i in range(len(sys.argv)):
         arg = sys.argv[i]
         if state:
             params[state] = arg
             state = None

         if arg == '--username' or arg == '-u':
             state = 'username'

         if arg == '--password' or arg == '-p':
             state = 'password'

         if arg == '--subdomain' or arg == '-s':
             state = 'subdomain'
      url = 'https://%s.loggly.com/api/inputs' % params['subdomain']
      password_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
      password_mgr.add_password(None, url, params['username'], params['password'])
      handler = urllib2.HTTPBasicAuthHandler(password_mgr)
      opener = urllib2.build_opener(handler)
      opener.open(url)
      urllib2.install_opener(opener)
      inputs = json.loads(urllib2.urlopen(url).read())
      for input in inputs:
         if input['service']['name'] == 'syslogtcp':
             url = 'https://%s.loggly.com/api/inputs/%d/adddevice' % \
                 (params['subdomain'], input['id'])
             response = urllib2.urlopen(url, {}).read()
             print response
    encoding: plain

commands:
  01-forward-rsyslog-to-loggly:
    # http://loggly.com/support/sending-data/logging-from/syslog/rsyslog/cd
    command: test "$(grep -s '90-loggly.conf' /etc/rsyslog.conf)" == "" && echo -e "\n# Include the loggly.conf file\n\$IncludeConfig /etc/rsyslog.d/90-loggly.conf" >> /etc/rsyslog.conf
  02-restart-syslog:
    command: service rsyslog restart
  03-inform_loggly:
    command: "python /tmp/loggly.py -u <Yourloginname> -p <Yourpassword> -s <Yourdomainname>" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-24T19:51:46.280

通常，/etc/rsyslog.config 最后会有一个“$IncludeConfig /etc/rsyslog.d/*.conf” - 因此您可以使用 .ebextensions 文件的“files:”部分简单地引入您*自己的*配置文件. 无论您是否部署到新服务器，这都有效。

对于 ruby​​ production.log，您可能在 .ebextensions/01loggly.config 文件中有类似的内容。请注意，这也会将您的 beanstalk 环境名称作为 loggly 标记。

```
# For docs on eb configs, see http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html
# This set of commands sets up loggly forwarding
files:
   "/etc/rsyslog.d/myapp-loggly.conf" :
      mode: "000664"
      owner: root
      group: root
      content: |
         $template LogglyFormat,"<%pri%>%protocol-version% %timestamp:::date-rfc3339% %HOSTNAME% %app-name% %procid% %msgid% [yourlogglyid@41058 tag=`{ "Ref" : "AWSEBEnvironmentName" }`] %msg%\n"
         *.* @@logs-01.loggly.com:514;LogglyFormat

         # One time config
         $ModLoad imfile
         $InputFilePollInterval 10 
         $PrivDropToGroup adm
         $WorkDirectory /var/spool/rsyslog

         # Add a tag for file events

         # For production.log
         $InputFileName /var/app/support/logs/production.log
         $InputFileTag production-log
         $InputFileStateFile stat-production-log #this must be unique for each file being polled
         $InputFileSeverity info
         $InputFilePersistStateInterval 20000
         $InputRunFileMonitor
         # Send to Loggly then discard
         if $programname == 'myapp-production-log' then @@logs-01.loggly.com:514;LogglyFormat
         if $programname == 'myapp-production-log' then ~

      encoding: plain
commands:
   00-make-work-directory:
      command: mkdir -p /var/spool/rsyslog
   01-restart-syslog:
      command: service rsyslog restart 
```

对于 Tomcat，您可以在 .ebextesions/01logglyg.config 文件中执行以下操作：

```
# For docs on eb configs, see http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html
# This set of commands sets up loggly forwarding
files:
    "/etc/rsyslog.d/mytomcatapp-loggly.conf" :
        mode: "000664"
        owner: root
        group: root
        content: |
            $template LogglyFormat,"<%pri%>%protocol-version% %timestamp:::date-rfc3339% %HOSTNAME% %app-name% %procid% %msgid% [yourlogglygidhere@41058 tag=`{ "Ref" : "AWSEBEnvironmentName" }`] %msg%\n"
            *.* @@logs-01.loggly.com:514;LogglyFormat

            # One time config
            $ModLoad imfile
            $InputFilePollInterval 10 
            $PrivDropToGroup adm
            $WorkDirectory /var/spool/rsyslog

            # catalina.log
            $InputFileName /var/log/tomcat7/catalina.log
            $InputFileTag catalina-log
            $InputFileStateFile stat-catalina-log
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'catalina-log' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'catalina-log' then ~

            # catalina.out
            $InputFileName /var/log/tomcat7/catalina.out
            $InputFileTag catalina-out
            $InputFileStateFile stat-catalina-out
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'catalina-out' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'catalina-out' then ~

            # host-manager.log
            $InputFileName /var/log/tomcat7/host-manager.log
            $InputFileTag host-manager
            $InputFileStateFile stat-host-manager
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'host-manager' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'host-manager' then ~

            # initd.log
            $InputFileName /var/log/tomcat7/initd.log
            $InputFileTag initd
            $InputFileStateFile stat-initd
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'initd' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'initd' then ~

            # localhost.log
            $InputFileName /var/log/tomcat7/localhost.log
            $InputFileTag localhost-log
            $InputFileStateFile stat-localhost-log
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'localhost-log' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'localhost-log' then ~

            # manager.log
            $InputFileName /var/log/tomcat7/manager.log
            $InputFileTag manager
            $InputFileStateFile stat-manager
            $InputFileSeverity info
            $InputFilePersistStateInterval 20000
            $InputRunFileMonitor
            if $programname == 'manager' then @@logs-01.loggly.com:514;LogglyFormat
            if $programname == 'manager' then ~

        encoding: plain
commands:
    00-make-work-directory:
        command: mkdir -p /var/spool/rsyslog
    01-restart-syslog:
        command: service rsyslog restart 
```

这个配置对我有用——虽然我还没有确定如何让多行条目进入 Loggly 中的单个条目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-22T13:16:17.987

我知道这是一个相当老的问题，但我发现答案真的没有回答这个问题，或者只是在实施时没有正常工作。我发现这可行（文件.ebextenstions/02loggly.config）：

```
container_commands:
  01-transform-rsyslog.conf:
    command: sed "s/NODE_ENV/$NODE_ENV/g" scripts/22-loggly.conf.temp > scripts/22-loggly.conf
  02-setup-rsyslog.conf:
    command: cp scripts/22-loggly.conf /etc/rsyslog.d/22-loggly.conf
  03-restart:
    command: /sbin/service rsyslog restart 
```

“01-transform-rsyslog.conf”步骤是可选的；我用它在文件中通过 NODE_ENV 设置标签。“22-loggly.conf.temp”是“22-loggly.conf”文件的修改版本，当您运行 linux 源设置脚本 ( [https://www .loggly.com/install/configure-syslog.py](https://www.loggly.com/install/configure-syslog.py)）。我刚刚将它安装在 ec2 实例上并复制了文件。

注意我必须在我的服务命令前面加上'/sbin'，因为没有它对我来说是失败的。此外，这会在每次部署时重新启动系统日志，这应该没问题。

现在您只需要确保您的应用程序记录到 syslog。对于 Java，它将是 log4j 或类似的。对于 Node.js（这是我正在使用的）， rconsole 有效（[https://github.com/tblobaum/rconsole](https://github.com/tblobaum/rconsole)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-23T16:14:32.587

我尝试过的所有事情似乎都不起作用，而且 loggly 文档非常混乱！我希望这会对某人有所帮助，这就是我让它工作的方式。

将以下内容粘贴到 .ebextensions/loggly.config

```
files:
  "/etc/rsyslog.conf" :
    mode: "000644"
    owner: root
    group: root
    content: |
      $ModLoad imfile
      $InputFilePollInterval 10
      $PrivDropToGroup adm

      # Input for FILE.LOG
      $InputFileName /var/app/current/PATH_TO_YOUR_LOG_FILE
      $InputFileTag social_php:
      $InputFileStateFile stat-social_php #this must be unique for each file being polled
      $InputFileSeverity info
      $InputRunFileMonitor

      #Add a tag for events from this file
      $template LogglyFormatsocial_php,"<%pri%>%protocol-version% %timestamp:::date-rfc3339% %HOSTNAME% %app-name% %procid% %msgid% [TOKEN@41058 tag=\"php_log\"] %msg%\n"

      if $programname == 'social_php' then @@logs.loggly.com:37146;LogglyFormatsocial_php
      if $programname == 'social_php' then ~
      *.*    @@logs.loggly.com:37146

commands:
  01-restart-syslog:
    command: service rsyslog restart 
```

*   将所有 social_php 实例替换为对您的应用程序有意义的标记。
*   将 /var/app/current/PATH_TO_YOUR_LOG_FILE 替换为您的日志文件位置

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-24T01:43:41.483

按照我在 elasticbeanstalk 中的 loggly 配置。对于 Linux + log4j

关于 .ebextensions 文件配置

```
container_commands:
  01_configure_sudo_access:
    command: sed -i -- 's/ requiretty/ \!requiretty/g' /etc/sudoers
  02_loggy_configure:
    command: sudo python .ebextensions/scripts/loggly_config.py
  03_restore_sudo_access:
    command: sed -i -- 's/ \!requiretty/ requiretty/g' /etc/sudoers 
```

用于默认 AMI 的 python 中的 Loggly 脚本：

```
import os

rsyslog_path = '/etc/rsyslog.conf'
loggly_file_path = '/etc/rsyslog.d/22-loggly.conf'

class LogglyConfig:

    def __init__(self):
        self.__linux_log()
        self.__config_loggly_for_log4j()

    def __linux_log(self):
        #not installed on this machine
        if not os.path.exists(loggly_file_path):
            os.system('rm -f configure-linux.sh')
            os.system('wget https://www.loggly.com/install/configure-linux.sh')
            os.system('sudo bash configure-linux.sh -a DOMAIN -t TOKEN -u USER -p PASSWORD -s')

    def __config_loggly_for_log4j(self):
        f = open(rsyslog_path,'r')
        file_text = f.read()
        f.close()
        file_text = file_text.replace('#$ModLoad imudp', '$ModLoad imudp')
        file_text = file_text.replace('#$UDPServerRun 514', '$UDPServerRun 514')
        f = open(rsyslog_path,'w')
        f.write(file_text)
        f.close()

        os.system('service rsyslog restart')

LogglyConfig() 
```

在您的 java 项目的 log4j.properties 中

```
log4j.rootLogger=INFO, SYSLOG

log4j.appender.SYSLOG=org.apache.log4j.net.SyslogAppender
log4j.appender.SYSLOG.SyslogHost=localhost
log4j.appender.SYSLOG.Facility=Local3
log4j.appender.SYSLOG.Header=true
log4j.appender.SYSLOG.layout=org.apache.log4j.PatternLayout
log4j.appender.SYSLOG.layout.ConversionPattern=java %d{ISO8601} %p %t %c{1}.%M - %m%n 
```

# android - 如何在 Android 上打开所有 fomat 文件

> ID：11254912
> 
> 赞同：0
> 
> 时间：2012-06-29T01:09:46.467
> 
> 标签：android, android-intent

我尝试实现一个类似浏览器的应用程序。
我想让它可以打开设备支持的任何格式文件。
我知道下面的代码可以打开特定的格式：

```
String mimetype = mime_type(FileName);
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(File), mimetype);
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent);

public String mime_type(String name) {
String type = null;
String[] mime = {".htm\ttext/html", ".html\ttext/html", ".doc\tapplication/msword", ".ppt\tapplication/vnd.ms-powerpoint", ".xls\tapplication/vnd.ms-excel", 
                ".txt\ttext/plain", ".pdf\tapplication/pdf", ".xlsx\tapplication/vnd.openxmlformats-officedocument.spreadsheetml.sheet", 
                ".pptx\tapplication/vnd.openxmlformats-officedocument.presentationml.presentation", ".docx\tapplication/vnd.openxmlformats-officedocument.wordprocessingml.document"};
int i;
for(i = 0; i < mime.length; i++) {
if(name.toLowerCase().endsWith(mime[i].split("\t")[0])) {
return mime[i].split("\t")[1];
}
}
return type;
} 
```

但是文件格式比我能列出的要多。
如果有任何方法可以为所有格式做到这一点？
或者列出所有让用户选择的应用程序的任何方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T06:46:48.507

我发现 set mimetype`*/*`可以到达它。
它将显示所有已安装的应用程序以供选择。

# graphics - 3D 图形中的纹理过滤模式

> ID：11254913
> 
> 赞同：0
> 
> 时间：2012-06-29T01:09:47.543
> 
> 标签：graphics, 3d, textures, texture-mapping, texture2d

不同类型的纹理过滤模式的工作量/开销之间是否有任何特定关系？即比较“无过滤模式”、双线性过滤和三线性过滤？它们是 3D 特有的，还是我们也有 2D 的？

谢谢 :) --Mohammad H.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:36:16.753

过滤模式和工作量之间存在一定的相关性。每种模式执行的工作如下：

*   **Nearest** (aka unfiltered)：找到最近的mip级别，然后选择坐标最接近请求坐标的纹素。

*   **双线性**：找到最近的 mip 级别，然后从它周围的四个纹素中线性插值请求的纹素值（假设是 2D 纹理）。

*   **Trilinear**：找到夹在深度值之间的两个 mip 级别，然后在每个级别上执行双线性插值。最后，在这两个值之间进行插值。

正如您所看到的，随着过滤器复杂性的增加，工作量（同样重要的是内存访问次数）也会显着增加。

最后，回答你的另一个问题，这适用于任何纹理维度，但你在更高维度上付出更多。

# javascript - Apple 会允许在 iOS 上使用 V8 驱动的 Javascript 应用程序吗？

> ID：11254915
> 
> 赞同：3
> 
> 时间：2012-06-29T01:10:11.867
> 
> 标签：javascript, ios

有很多关于谷歌被迫使用 UIWebView for Chrome for iOS，以及 Facebook 完全放弃 HTML5 来支持他们的 iOS 应用程序的讨论，因为 UIWebView 太慢了。我很快将需要移植一个 HTML5 应用程序，该应用程序需要大量密集的 Javascript 计算（考虑到我的时间限制，本地重写的代码太多）但没有浏览器提供的显示功能（即它在 Node.js 上无头运行良好）。我从未听说有人试图将 Google 的 V8 嵌入到 iOS 应用程序中，但考虑到[MobiRuby](http://mobiruby.org/)实际上做同样的事情（在mruby解释器中链接），是否可以做类似的事情，在同一进程中链接谷歌的V8解释器？只要不下载代码，不分叉进程，这似乎并不违反规则，但有人试过吗？

编辑：我知道 PhoneGap/Cordova 和类似技术，但它们都与完整的 UIWebView 一起使用，并且由于 Apple 的偏执狂，UIWebView 无法 JIT 编译 Javascript 代码（正如我所说，这对我的应用程序至关重要）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T15:31:36.977

根据 v8-dev 邮件列表上这个[线程](http://code.google.com/p/v8/issues/detail?id=1312)中提到的内容，现在可能是可能的。您可能对此问题的工作状态感兴趣。

# java - JPA 的问题，当我调用时：em.persist(obj); `参照完整性约束违反异常`

> ID：11254918
> 
> 赞同：1
> 
> 时间：2012-06-29T01:10:31.150
> 
> 标签：java, jpa-2.0, eclipselink, h2

3天以来，我一直在这个问题上，我试图尽可能清楚地解释：我正在从事软件库存管理，我使用EclipseLink（JPA2.0）来管理数据库。问题是，当我使用相关文章创建新发票并尝试保留它们时，我会得到一个 `Referential integrity constraint violation Exception`...

真正的问题是我用netbeans生成了所有实体（因为我不熟悉注释）并且我无法确认它们是否正确生成（但我仍然怀疑）......

表 SQL：

![在此处输入图像描述](../Images/f92ac80e1642b287c84a76ea5ab7d18a.png)

```
CREATE TABLE fact_proforma (
  idfact_proforma INT UNSIGNED NOT NULL AUTO_INCREMENT,
  utilisateur_login VARCHAR(25) NOT NULL,
  client_idclient INT UNSIGNED NOT NULL,
  date DATE NOT NULL,
  PRIMARY KEY(idfact_proforma),
  FOREIGN KEY(client_idclient)
    REFERENCES client(idclient)
      ON DELETE NO ACTION
      ON UPDATE CASCADE,
  FOREIGN KEY(utilisateur_login)
    REFERENCES utilisateur(login)
      ON DELETE NO ACTION
      ON UPDATE CASCADE
);

CREATE TABLE fact_proforma_has_article (
  fact_proforma_idfact_proforma INT UNSIGNED NOT NULL,
  article_idarticle VARCHAR(40) NOT NULL,
  prix_ht DOUBLE NOT NULL,
  qte DOUBLE  NOT NULL,
  remise DOUBLE NOT NULL,
  marge_benef DOUBLE NOT NULL,
  PRIMARY KEY(fact_proforma_idfact_proforma, article_idarticle),
  FOREIGN KEY(fact_proforma_idfact_proforma)
    REFERENCES fact_proforma(idfact_proforma)
      ON DELETE CASCADE
      ON UPDATE CASCADE,
  FOREIGN KEY(article_idarticle)
    REFERENCES article(idarticle)
      ON DELETE NO ACTION
      ON UPDATE CASCADE
);

CREATE TABLE article (
  idarticle VARCHAR(40) NOT NULL,
  libel VARCHAR(100) NOT NULL,
  prix_ht DOUBLE NOT NULL,
  tva_idtva DOUBLE NOT NULL,
  qte DOUBLE NOT NULL,
  min_qte DOUBLE  NOT NULL,
  marge_benef DOUBLE NOT NULL,
  remise DOUBLE NOT NULL,
  unite_idunite VARCHAR(10) NOT NULL,
  famille_idfamille VARCHAR(50) NOT NULL,
  etat CHAR(1) NOT NULL,
  PRIMARY KEY(idarticle),
  FOREIGN KEY(tva_idtva)
    REFERENCES tva(idtva)
      ON DELETE NO ACTION
      ON UPDATE CASCADE,
  FOREIGN KEY(famille_idfamille)
    REFERENCES famille(idfamille)
      ON DELETE NO ACTION
      ON UPDATE CASCADE,
  FOREIGN KEY(unite_idunite)
    REFERENCES unite(idunite)
      ON DELETE NO ACTION
      ON UPDATE CASCADE
);

CREATE TABLE utilisateur (
  login VARCHAR(25) NOT NULL,
  pass VARCHAR(15) NOT NULL,
  class CHAR(1) NOT NULL,
  etat CHAR(1) NOT NULL,
  PRIMARY KEY(login)
); 
```

FactProforma.java: // “Facture Proforma”是“形式发票”

```
public class FactProforma implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @Column(name = "IDFACT_PROFORMA", nullable = false)
    private Integer idfactProforma;
    @Basic(optional = false)
    @Column(name = "DATE", nullable = false)
    @Temporal(TemporalType.DATE)
    private Date date;
    @OneToMany(cascade=CascadeType.ALL , mappedBy = "factProforma")
    private List<FactProformaHasArticle> factProformaHasArticleList;
    @JoinColumn(name = "UTILISATEUR_LOGIN", referencedColumnName = "LOGIN", nullable = false)
    @ManyToOne(optional = false)
    private Utilisateur utilisateurLogin;
    @JoinColumn(name = "CLIENT_IDCLIENT", referencedColumnName = "IDCLIENT", nullable = false)
    @ManyToOne(optional = false)
    private Client clientIdclient; 
```

FactProformaHasArticle.java

```
public class FactProformaHasArticle implements Serializable {
    private static final long serialVersionUID = 1L;
    @EmbeddedId
    protected FactProformaHasArticlePK factProformaHasArticlePK;
    @Basic(optional = false)
    @Column(name = "PRIX_HT", nullable = false)
    private double prixHt;
    @Basic(optional = false)
    @Column(name = "QTE", nullable = false)
    private double qte;
    @Basic(optional = false)
    @Column(name = "REMISE", nullable = false)
    private double remise;
    @Basic(optional = false)
    @Column(name = "MARGE_BENEF", nullable = false)
    private double margeBenef;
    @JoinColumn(name = "FACT_PROFORMA_IDFACT_PROFORMA", referencedColumnName = "IDFACT_PROFORMA", nullable = false, insertable = false, updatable = false)
    @ManyToOne(optional = false)
    private FactProforma factProforma;
    @JoinColumn(name = "ARTICLE_IDARTICLE", referencedColumnName = "IDARTICLE", nullable = false, insertable = false, updatable = false)
    @ManyToOne(optional = false)
    private Article article; 
```

FactProformaHasArticlePK.java

```
@Embeddable
public class FactProformaHasArticlePK implements Serializable {
    @Basic(optional = false)
    @Column(name = "FACT_PROFORMA_IDFACT_PROFORMA", nullable = false)
    private int factProformaIdfactProforma;
    @Basic(optional = false)
    @Column(name = "ARTICLE_IDARTICLE", nullable = false, length = 40)
    private String articleIdarticle; 
```

我的代码：

```
FactProforma factpro=new FactProforma(null, new Date());
 Utilisateur user=new Utilisateur(loginActuel);
 Client client=new Client(Integer.parseInt(codeClient.getText()));

java.util.List<FactProformaHasArticle> ListOfArticles =this.c.GetPanier(dtm,factpro);

factpro.setClientIdclient(client);
factpro.setFactProformaHasArticleList(ListOfArticles);
factpro.setUtilisateurLogin(user);

 EntityManager em= emf.createEntityManager();
    em.getTransaction().begin();

    em.persist(factpro);

    em.getTransaction().commit(); 
```

堆栈跟踪：

```
Exception in thread "AWT-EventQueue-0" javax.persistence.RollbackException: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.h2.jdbc.JdbcSQLException: Referential integrity constraint violation: "CONSTRAINT_9A: PUBLIC.FACT_PROFORMA_HAS_ARTICLE FOREIGN KEY(FACT_PROFORMA_IDFACT_PROFORMA) REFERENCES PUBLIC.FACT_PROFORMA(IDFACT_PROFORMA)"; SQL statement:
Internal Exception: org.h2.jdbc.JdbcSQLException: Referential integrity constraint violation: "CONSTRAINT_9A: PUBLIC.FACT_PROFORMA_HAS_ARTICLE FOREIGN KEY(FACT_PROFORMA_IDFACT_PROFORMA) REFERENCES PUBLIC.FACT_PROFORMA(IDFACT_PROFORMA)"; SQL statement:
INSERT INTO TEST.PUBLIC.FACT_PROFORMA_HAS_ARTICLE (MARGE_BENEF, PRIX_HT, QTE, REMISE, ARTICLE_IDARTICLE, FACT_PROFORMA_IDFACT_PROFORMA) VALUES (?, ?, ?, ?, ?, ?) [23506-164]
INSERT INTO TEST.PUBLIC.FACT_PROFORMA_HAS_ARTICLE (MARGE_BENEF, PRIX_HT, QTE, REMISE, ARTICLE_IDARTICLE, FACT_PROFORMA_IDFACT_PROFORMA) VALUES (?, ?, ?, ?, ?, ?) [23506-164]
    at org.h2.message.DbException.getJdbcSQLException(DbException.java:329)
    at org.h2.message.DbException.getJdbcSQLException(DbException.java:329)
    at org.h2.message.DbException.get(DbException.java:169)
    at org.h2.message.DbException.get(DbException.java:169)
    at org.h2.message.DbException.get(DbException.java:146)
    at org.h2.message.DbException.get(DbException.java:146)
    at org.h2.constraint.ConstraintReferential.checkRowOwnTable(ConstraintReferential.java:345)
    at org.h2.constraint.ConstraintReferential.checkRowOwnTable(ConstraintReferential.java:345)
    at org.h2.constraint.ConstraintReferential.checkRow(ConstraintReferential.java:287)
    at org.h2.constraint.ConstraintReferential.checkRow(ConstraintReferential.java:287)
    at org.h2.table.Table.fireConstraints(Table.java:862)
    at org.h2.table.Table.fireConstraints(Table.java:862)
    at org.h2.table.Table.fireAfterRow(Table.java:879)
    at org.h2.table.Table.fireAfterRow(Table.java:879)
    at org.h2.command.dml.Insert.insertRows(Insert.java:126)
    at org.h2.command.dml.Insert.update(Insert.java:84)
    at org.h2.command.dml.Insert.insertRows(Insert.java:126)
    at org.h2.command.CommandContainer.update(CommandContainer.java:73)
    at org.h2.command.dml.Insert.update(Insert.java:84)
    at org.h2.command.Command.executeUpdate(Command.java:226)
    at org.h2.command.CommandContainer.update(CommandContainer.java:73)
    at org.h2.server.TcpServerThread.process(TcpServerThread.java:325)
    at org.h2.command.Command.executeUpdate(Command.java:226)
    at org.h2.server.TcpServerThread.run(TcpServerThread.java:146)
    at java.lang.Thread.run(Thread.java:722 at org.h2.server.TcpServerThread.process(TcpServerThread.java:325)
)

Error Code: 23506
Call: INSERT INTO TEST.PUBLIC.FACT_PROFORMA_HAS_ARTICLE (MARGE_BENEF, PRIX_HT, QTE, REMISE, ARTICLE_IDARTICLE, FACT_PROFORMA_IDFACT_PROFORMA) VALUES (?, ?, ?, ?, ?, ?)
    at org.h2.server.TcpServerThread.run(TcpServerThread.java:146)
    bind => [6 parameters bound]
    at java.lang.Thread.run(Thread.java:722) 
```

明天我将尝试使用另一个 DBMS，以避免冲突......

PS：对不起法语..我别无选择。

**更新**：它的工作：

```
EntityManager em= emf.createEntityManager();
    em.getTransaction().begin();

    em.persist(fact);
    em.flush();

    for(FactProformaHasArticle couple: estComposeFacture)
    {
        couple.getFactProformaHasArticlePK().setFactProformaIdfactProforma(fact.getIdfactProforma());
        em.persist(couple);
    }

    em.getTransaction().commit(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:23:38.797

编辑后的帖子：您需要确保 FactProformaHasArticle 和 FactProforma 之间的关系被完全引用。我怀疑你需要有这样的东西才能坚持：

```
List<FactProformaHasArticle> ListOfArticles =this.c.GetPanier(dtm,factpro)
for(FactProformaHasArticle fpha: ListOfArticles) {
  fpha.setFactProforma(factpro);
} 
```

（注意：成员变量的第一个字母小写会更好，即 `listOfArticles`代替 `ListOfArticles`etc）

INITIAL POST（如果它也适用于您的情况）：您是否尝试从主键的注释中删除`optional=false`and ？`nullable=false`我曾经对此有过疑问：因此，JPA 不允许这样做`MyEntity me=new MyEntity(null);`。尝试类似：

```
public class FactProforma implements Serializable {

  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  // removed:@Basic(optional = false)
  @Column(name = "IDFACT_PROFORMA") // removed: , nullable = false)
  private Integer idfactProforma;
  // rest should be ok
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T15:14:48.677

你已经有了一个解决方案，但我想我会提到它起作用的原因是因为你有通过 EmbeddedId 的基本映射控制的主键字段 - 所以即使你可能在持久化之前设置了关系，pk 字段将为 null直到 EmbeddedId 的 articleIdarticle 手动设置了一个值。这是两次映射“ARTICLE_IDARTICLE”的问题——这两个映射都应该由应用程序维护，并且在你坚持 FactProformaHasArticle 之前 pk 值需要可用。

JPA 2.0 使此设置更容易一些，因为您可以在关系上使用 @MapsId 注释来显示它控制 EmbeddedId 的基本映射 - 因此您只需要设置关系并让 JPA 为您设置字段。或者您可以删除 embeddedId，将该对象用作 PKclass 并直接使用@Id 标记关系，如下所述：

[http://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#JPA_2.0](http://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#JPA_2.0) 使用这将允许您删除刷新调用，因为 JPA 将为您设置 pk 值。

# validation - ORM/Extra Validate iby 两个字段

> ID：11254920
> 
> 赞同：0
> 
> 时间：2012-06-29T01:10:47.747
> 
> 标签：validation, orm, kohana, extra

小花 3.2

我想检查我的 parent_id，但我需要 type_id 的第二个值。代码：

```
public function rules()
{ 
return array(
'type_id' => array(
array('not_empty'),
array('digit'),
),

'parent_id' => array(
array('digit'),
array(array($this,'check_category'),array(':value', ':field','type_id'))
),

);

}

public function check_category($parent_id,$field,$type_id)
{
die($type_id);
} 
```

## 如何将我的字段的两个值发送到我的函数？

在我的控制器中完成之后：

```
if(isset($_POST['submit']))
        {
            $data = Arr::extract($_POST, array('type_id', 'parent_id', 'name', 'comment'));
            $category = ORM::factory('kindle_category');
            $category->values($data);

            try {
                $extra_rules = Validation::factory($_POST)
                ->rule('parent_id','Kindle::check_category',array($data['type_id'],$data['parent_id'],'parent_id',':validation'));
                $category->save($extra_rules);

                $this->request->redirect('kindle/category');
            }
            catch (ORM_Validation_Exception $e) {

                $errors = $e->errors('validation');

            }
        }

if($parent->type_id!=$type_id) 
            {
                $validation->error($field, 'Dog name, not cat!');
                return false;
            } 
```

如何查看我的错误“狗名，而不是猫！” 在我的视图中？数组错误没有这个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:10:58.327

```
public function rules()
{
    return array(
        'type_id' => array(
            array('not_empty'),
            array('digit'),
        ),

        'parent_id' => array(
            array('digit'),
            array(array($this,'check_category'),array(':validation'))
    ),
);

}

public function check_category($validation)
{
    $type_id = $validation['type_id'];
    ...
} 
```

[http://kohanaframework.org/3.2/guide/orm/examples/validation](http://kohanaframework.org/3.2/guide/orm/examples/validation)

# java - 如何使用参考 RGB 值标准化 RGB 值

> ID：11254923
> 
> 赞同：6
> 
> 时间：2012-06-29T01:12:09.693
> 
> 标签：java, image, image-processing, graphics, normalization

我想在许多照明条件下获取图像的 RGB 值。为了获得某种中性的场景，我想用一些预定义图像的 RGB 值来规范化 RGB 值。

让我解释。我有 6 个预定义的图像，并且我知道它们的确切平均 RGB 值。现在我将在不同的照明条件下拍摄未知图像的照片。我还将在相同条件下拍摄预定义的 6 张图像。现在我的目标是通过将预定义图像的已知参考 rgb 值与从相机图片计算的值进行比较来定义归一化公式。使用这个归一化参数，我将校准未知图片的 RGB 值。这样我就可以以中立的方式从未知图片中获得平均 RGB 值，而不管照明条件如何。

我怎样才能在 Java 中轻松实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T02:17:27.413

您这样做是为了真正标准化 RGB，还是您试图将图像标准化以具有相似的亮度。因为如果您的目标只是亮度，那么我将转换为具有亮度分量的颜色标准，并仅对亮度分量进行归一化。

您可以从那里获取不同颜色分量标准的新图像，并根据需要转换回 RGB。

步骤（但不是在java中）：

```
1) Convert - RGBImage --> YUVImage
2) Normalize RGBImage using the Y component
3) Convert - Normalized(YUVImage) --> Normalized(RGBImage) 
```

[通过这种方式，您可以使用此处描述的算法](http://en.wikipedia.org/wiki/Normalization_(image_processing))对亮度进行归一化。

否则，您可以平均每个通道的平均值，并将其用作新图像的归一化因子的分子，分别计算每个通道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T04:15:10.720

对于不同的照明情况，只需要线性 RGB 校正即可。只需将每个 R、G、B 值乘以为每个通道导出的常数。

如果只有一种参考颜色，那将很容易 - 乘以参考颜色，然后除以捕获的颜色。例如，如果您的参考颜色是 (240,200,120)，但您的图像是 (250,190,150) - 您将红色乘以 240/250，绿色乘以 200/190，蓝色乘以 120/150。对图像中的每个像素使用相同的常量。

如果要匹配多种颜色，您必须平均校正因子才能得出一组常数。需要对较亮的颜色赋予更大的权重，例如，如果您有 (200,150,20) 的参考并且它测量 (190,140,​​10) 您将尝试将蓝色的量加倍，这可能非常遥远。最简单的方法是将所有参考值相加，然后除以测量值的总和。

# android - 为什么我的应用程序不会移动到下一个类（意图）？

> ID：11254924
> 
> 赞同：1
> 
> 时间：2012-06-29T01:12:18.197
> 
> 标签：android, android-intent

我一直在尝试让我的应用程序移动到下一个类“GameOver.class”。有人可以指出我做错了什么吗？根据我的日志， OnAnimationEnd 方法甚至没有被击中。如果我将其用作主类，则 GameOver 类确实可以工作。

```
public class Rocky extends Activity implements AnimationListener {

TextView m_dog, m_spoon, m_ice_cream, m_car, m_giraffe ;
ImageView rocky_pic, dog, spoon,ice_cream, car, giraffe;
Animation animationFadeOut, animationFadeIn,viewObjFades;
int count = 0;
MediaPlayer mp;
private static final String TAG = "MyActivity";
AlertDialog.Builder builder;
AlertDialog alertDialog;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.rocky);

    rocky_pic = (ImageView)findViewById(R.id.rocky_pic);

    Animation animationFadeIn = AnimationUtils.loadAnimation(this, R.anim.fadein);
    rocky_pic.startAnimation(animationFadeIn);

    m_car=(TextView) findViewById(R.id.m_car);
    m_dog=(TextView) findViewById(R.id.m_dog);
    m_spoon=(TextView) findViewById(R.id.m_spoon);
    m_ice_cream=(TextView) findViewById(R.id.m_ice_cream);
    m_giraffe=(TextView) findViewById(R.id.m_giraffe);

    dog = (ImageView) findViewById(R.id.dog);
    spoon = (ImageView) findViewById(R.id.spoon);
    ice_cream = (ImageView) findViewById(R.id.ice_cream);
    car = (ImageView) findViewById(R.id.car);
    giraffe  = (ImageView) findViewById(R.id.giraffe);

    mp = MediaPlayer.create(Rocky.this, R.raw.ding); 
    dog.setAlpha(0);
    spoon.setAlpha(0);
    ice_cream.setAlpha(0);
    car.setAlpha(0);
    giraffe.setAlpha(0);

}

@Override
public void onStart() {
    super.onStart();

    LayoutInflater inflater = (LayoutInflater) this.getSystemService(LAYOUT_INFLATER_SERVICE);
    View layout = inflater.inflate(R.layout.custom_dialog,
                                   (ViewGroup) findViewById(R.id.layout_root));

    TextView text = (TextView) layout.findViewById(R.id.text);

    text.setText("Text.text.text");

    builder = new AlertDialog.Builder(this);
    builder.setView(layout);
    alertDialog = builder.create();
    alertDialog.show();

    text.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            alertDialog.dismiss();

        }
    });

    alertDialog.setCanceledOnTouchOutside(true);

    ice_cream.setOnClickListener(new View.OnClickListener(){
        @Override
        public void onClick(View v)
        {
            ice_cream.setAlpha(200);  
            count ++;
            mp.start();     
            ice_cream.setClickable(false);
            if (count==5){

                fadeout();
            }
        }
    });

    dog.setOnClickListener(new View.OnClickListener(){
        @Override
        public void onClick(View v)
        {
            dog.setAlpha(200);  
            count ++;
            mp.start();     
            dog.setClickable(false);
            if (count==5){

                fadeout();
            }
        }
    });

    giraffe.setOnClickListener(new View.OnClickListener(){
        @Override
        public void onClick(View v)
        {
            giraffe.setAlpha(200);  
            count ++;
            mp.start();     
            giraffe.setClickable(false);
            if (count==5){

                fadeout();
            }
        }
    });

    spoon.setOnClickListener(new View.OnClickListener(){
        @Override
        public void onClick(View v)
        {
            spoon.setAlpha(200);
            count ++;
            mp.start();
            spoon.setClickable(false);
            if (count==5){

                fadeout();
            }
        }
    });     

    car.setOnClickListener(new View.OnClickListener(){
        @Override
        public void onClick(View v)
        {
            car.setAlpha(200);
            count ++;
            mp.start(); 
            car.setClickable(false);
            if (count==5){

                fadeout();
            }
        }
    });

}

public void fadeout(){

    animationFadeOut = AnimationUtils.loadAnimation(this, R.anim.fadeout);
    animationFadeOut.setAnimationListener(this);

    viewObjFades= AnimationUtils.loadAnimation(this, R.anim.trns4view_fadeout);

    car.startAnimation(viewObjFades);
    giraffe.setAnimation(viewObjFades);
    spoon.setAnimation(viewObjFades);
    dog.setAnimation(viewObjFades);
    ice_cream.setAnimation(viewObjFades);

    rocky_pic.startAnimation(animationFadeOut);

    car.setVisibility(View.GONE);
    giraffe.setVisibility(View.GONE);
    spoon.setVisibility(View.GONE);
    dog.setVisibility(View.GONE);
    ice_cream.setVisibility(View.GONE);
    rocky_pic.setVisibility(View.GONE);

}

@Override
public void onAnimationEnd(Animation animation) {
    mp.release();
    Log.v(TAG, "player released");

    Intent end = new Intent(this, GameOver.class);
    Log.v(TAG, "end object created");
    end.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
    Log.v(TAG, "no anim");
    end.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    Log.v(TAG, "sing t");
    this.startActivity(end);    
    Log.v(TAG, "begin game over");
}

@Override
public void onAnimationRepeat(Animation animation) {

}

@Override
public void onAnimationStart(Animation animation) {

}

@Override
public boolean onCreateOptionsMenu(Menu menu){
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.rcky_menu, menu);
    return true;
}
@Override
public boolean onPrepareOptionsMenu(Menu menu){

    if(!dog.isClickable()){
        menu.removeItem(R.id.m_dog);
    }
    if(!spoon.isClickable()){
        menu.removeItem(R.id.m_spoon);  
    }

    if(!ice_cream.isClickable()){
        menu.removeItem(R.id.m_ice_cream);
    }

    if(!car.isClickable()){
        menu.removeItem(R.id.m_car);
    }

    if(!giraffe.isClickable()){
        menu.removeItem(R.id.m_giraffe);
    }

    return true;
}
@Override
public void onBackPressed(){

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:02:09.000

我写了一个方法调用，“next()”并取出“fadeout()”。它现在有效，但我不知道为什么。有人可以解释一下吗？

```
public void next(){
    mp.release();
    Intent done = new Intent(this, GameOver.class);
    done.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
    done.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    this.startActivity(done);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T02:16:45.203

只要您在其上启动动画，就将 rocky_pic 的可见性设置为 Gone。既然它是一个淡出动画，你不应该简单地将动画设置为 fill_after 以便在动画结束时它保持消失吗？我认为将其设置为消失，可能会完全停止动画，因此动画被有效地取消，这就是为什么 onAnimationEnd 永远不会被调用的原因，因为您通过更改视图的可见性来有效地使视图无效。

# django - Django1.4与Python3.2不兼容？

> ID：11254927
> 
> 赞同：1
> 
> 时间：2012-06-29T01:12:41.550
> 
> 标签：django, python-3.x, syntax-error

我用python3.2在Win 7上安装了Django1.4。但是当我`django-admin.py startproject mysite`在命令提示符下运行时，我会收到语法错误：无效语法之类的错误。它表明在 处有错误`print ''.join ......`。我看到 print 不见了`()`。我已经修复了一个语法错误。

是不可比性的问题吗？

你建议我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:13:16.590

Django 还没有正式支持 Python 3.x。在 Python 2.7 中使用它。

这是有关 Python 3 上 Django 的官方最新消息：[https ://www.djangoproject.com/weblog/2012/mar/13/py3k/](https://www.djangoproject.com/weblog/2012/mar/13/py3k/)

有一个使用通用代码库支持 Python 3 的非官方实验： [https ://bitbucket.org/vinay.sajip/django/](https://bitbucket.org/vinay.sajip/django/)

# ruby-on-rails-3 - 如何将嵌套资源路由到别名？

> ID：11254930
> 
> 赞同：0
> 
> 时间：2012-06-29T01:13:06.307
> 
> 标签：ruby-on-rails-3, routes, custom-routes, nested-routes

我知道不建议在嵌套路由中深入超过 1 级，但这就是我所拥有的：

```
 resources :partners do
    resources :recommend_partners do
      resources :rec_partner_comments
    end
  end 
```

有没有办法可以调用别名来使用 name_route

所以而不是使用

```
new_partner_recommend_partner_rec_partner_comments 
```

我会使用类似的东西

```
new_comment_on_pr 
```

只是一个想法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:24:26.883

你总是可以创建一个辅助函数

```
def new_comment_on_pr(*args)
  new_partner_recommend_partner_rec_partner_comments(*args)
end 
```

您还知道 Rails 中更清晰的路由路径语法吗？代替

```
partner_recommend_partner_rec_partner_comments(partner, recommend_partner) 
```

你可以写

```
[partner, recomment_partner, :comments] 
```

# python - Web scraper 为某些文章返回 NoneType 对象

> ID：11254938
> 
> 赞同：0
> 
> 时间：2012-06-29T01:15:25.827
> 
> 标签：python, beautifulsoup

抓取器的逻辑流程：从 XML 提要中提取的文章链接被放入名为 self.raw_html 的列表中。然后调用以下 [simplified] 方法来过滤掉文章所在的容器并从给定文章中删除文本：

```
def fetch_article_contents(self):
    for article in self.raw_html:
        self.css_selector_type == 'class':
        soup = article.find(self.html_element,
                            self.css_selector)
        soup = soup.get_text()
        self.article_html.append(soup)
    return self.article_html 
```

这适用于大多数提要，但在两个值得注意的例外情况（福布斯和 Google 官方博客）上，在调用 get_text() 时会失败并显示以下消息：

```
AttributeError: 'NoneType' object has no attribute 'get_text' 
```

我在调试中的第一个合乎逻辑的步骤是查看返回 NoneType 对象的内容，所以我`print type(soup)`在`soup = soup.get_text()`. 我发现：

```
<class 'bs4.element.Tag'> (25 times, condensed to save space)
<type 'NoneType'> 
```

`self.raw_html`这也让我感到奇怪，因为当类初始化时，通过 len(self.raw_html) 验证获取福布斯 XML 提要时当前有 29 篇文章。

谷歌官方博客返回：

```
<class 'bs4.element.Tag'> (just once this time)
<type 'NoneType'> 
```

实际上有 25 篇文章。

我遇到什么问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:18:08.073

您没有显示什么`self.html_element`和`self.css_selector`是，但该方法似乎很清楚该`article.find`方法没有找到它们并返回`None`.

# jquery - 使用 statusCode 时，jQuery $.ajax 在 ie9/FF 中失败，修复？

> ID：11254941
> 
> 赞同：0
> 
> 时间：2012-06-29T01:15:56.497
> 
> 标签：jquery

提交以下 $.ajax，它确实正在执行，但无提示地失败，没有任何错误。IE9 开发工具不会弹出错误，提琴手显示没有流量。

我可以确认代码确实执行了，因为屏幕上确实出现了“处理”位。然而，其余的似乎只是失败了。我*不是*在做 x 域。

```
$('.signupMsg').html("<img src='/assets/img/load-black.gif' /> Processing...");
var data = $('#emailForm').serialize();
$.ajax({
    url: 'https://example.com/proxy/emaillist',
    type: 'POST',
    data: data,
    statusCode: {
        200: function(msg) {
            $('.signupBlock').html("&nbsp;<br><strong>Thank you!</strong><br>You will be hearing from us soon.");
            $('#emailForm').remove();
        },
        500: function(msg) {
            $('.signupBlock').html("&nbsp;<br><strong>Something went wrong.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
            $('#emailForm').remove();
        },
            404: function(msg) {
                    $('.signupBlock').html("&nbsp;<br><strong>Something went wrong.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
                    $('#emailForm').remove();
            },
        503: function(msg) {
            $('.signupBlock').html("&nbsp;<br><strong>Server temporarily down.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
            $('#emailForm').remove();
        },
        400: function(msg) {
            $('.signupMsg').html("<span style='color:red'>Email validation failed, please try again.</span>");
        }
    } 
```

});

使用 jQ 1.7.2。该代码在 Google Chrome 中执行良好，但在 IE7-9 和 FF 中失败。旧浏览器不支持 statusCode 吗？

或者我应该切换到 SuperAgent 以获得代码响应支持？[http://visionmedia.github.com/superagent/](http://visionmedia.github.com/superagent/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:33:28.320

好吧，它不是针对 jQuery 的修复，而是针对 AJAX 调用的修复。

我刚刚切换到 SuperAgent 并得到了同样的工作：

```
request
.post('url/to/example')
.send(data)
.end(function(res){
    if(res.status==200) {
        $('.signupBlock').html("&nbsp;<br><strong>Thank you!</strong><br>You will be hearing from us soon.");
        $('#emailForm').remove();                           
    }
    if(res.status==500) {
        $('.signupBlock').html("&nbsp;<br><strong>Something went wrong.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
        $('#emailForm').remove();
    }
    if(res.status==404) {
        $('.signupBlock').html("&nbsp;<br><strong>Something went wrong.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
        $('#emailForm').remove();
    }
    if(res.status==503) {
        $('.signupBlock').html("&nbsp;<br><strong>Server temporarily down.</strong><br>Sorry about that, please <a href='/'>refresh</a> and try again.");
        $('#emailForm').remove();
    }
    if(res.status==400) {
        $('.signupMsg').html("<span style='color:red'>Email validation failed, please try again.</span>");
    }
}); 
```

# c - 在 C 中使用互斥锁和屏障进行线程同步

> ID：11254942
> 
> 赞同：1
> 
> 时间：2012-06-29T01:16:05.553
> 
> 标签：c, synchronization, pthreads, mutex, barrier

我正在尝试使用 pthread 互斥变量和屏障来同步我的程序的输出，但它没有按照我想要的方式工作。每个线程每 20 个值（来自 for 循环）看到它的最终值，这没关系，但我试图让它们都达到相同的最终值（如果使用 5 个线程，它们都应该看到 100 作为最终值, 4 线程, 80 等)

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h> 

pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;

int SharedVariable =0;
void *SimpleThread(void *args)
{
    int num,val,rc;
    int which =(int)args;
    rc = pthread_mutex_lock(&mutex1);
    for(num=0; num<20; num++){
#ifdef PTHREAD_SYNC
        if(random() > RAND_MAX / 2)
            usleep(10);
#endif
        //pthread_mutex_lock(&mutex1);
        val = SharedVariable;
        printf("*** thread %d sees value %d\n", which, val);
        //pthread_mutex_lock(&mutex1);
        SharedVariable = val+1;
        pthread_mutex_unlock(&mutex1);
    }   
    val=SharedVariable;

    printf("Thread %d sees final value %d\n", which, val);
    //pthread_mutex_destroy(&mutex1);
    //pthread_exit((void*) 0);
    //pthread_mutex_unlock(&mutex1);

}

int main (int argc, char *argv[])
{
   if(atoi(argv[1]) > 0){        
   int num_threads = atoi(argv[1]);  
   //pthread_mutex_init(&mutex1, NULL);
   pthread_t threads[num_threads];
   int rc;
   long t;
   rc = pthread_mutex_lock(&mutex1);
   for(t=0; t< num_threads; t++){
      printf("In main: creating thread %ld\n", t);
      rc = pthread_create(&threads[t], NULL, SimpleThread, (void* )t);
      if (rc){
         printf("ERROR; return code from pthread_create() is %d\n", rc);
         exit(-1);
      }

    //pthread_join(thread1);

   }
    rc= pthread_mutex_unlock(&mutex1);
}
   else{
      printf("ERROR: The parameter should be a valid positive number.");
      exit(-1);
  }

   pthread_mutex_destroy(&mutex1);
   pthread_exit(NULL);
} 
```

非常感谢任何建议或帮助！提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T03:47:41.227

在检查最终值之前，您需要使用屏障 ( `pthread_barrier_wait()`) - 这可以确保在所有线程都到达屏障之前不会继续执行任何线程。

此外，您应该调用`pthread_join()`以等待线程完成，并且您只需要在增量周围保持互斥锁：

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;
pthread_barrier_t barrier1;

int SharedVariable = 0;

void *SimpleThread(void *args)
{
    int num,val;
    int which = (int)args;

    for(num = 0; num < 20; num++) {
#ifdef PTHREAD_SYNC
        if(random() > RAND_MAX / 2)
            usleep(10);
#endif
        pthread_mutex_lock(&mutex1);
        val = SharedVariable;
        printf("*** thread %d sees value %d\n", which, val);
        SharedVariable = val + 1;
        pthread_mutex_unlock(&mutex1);
    }

    pthread_barrier_wait(&barrier1);

    val = SharedVariable;
    printf("Thread %d sees final value %d\n", which, val);
    return 0;
}

int main (int argc, char *argv[])
{
    int num_threads = argc > 1 ? atoi(argv[1]) : 0;

    if (num_threads > 0) {
        pthread_t threads[num_threads];
        int rc;
        long t;

        rc = pthread_barrier_init(&barrier1, NULL, num_threads);

        if (rc) {
            fprintf(stderr, "pthread_barrier_init: %s\n", strerror(rc));
            exit(1);
        }

        for (t = 0; t < num_threads; t++) {
            printf("In main: creating thread %ld\n", t);
            rc = pthread_create(&threads[t], NULL, SimpleThread, (void* )t);
            if (rc) {
                printf("ERROR; return code from pthread_create() is %d\n", rc);
                exit(-1);
            }
        }

        for (t = 0; t < num_threads; t++) {
            pthread_join(threads[t], NULL);
        }
    }
    else {
        printf("ERROR: The parameter should be a valid positive number.\n");
        exit(-1);
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T03:45:31.587

尝试将`pthread_mutext_unlock(&mutext1)`for 循环移出`SimpleThread`. 您在原始代码中锁定一次并解锁多次（20）次。

或者，您可以`pthread_mutex_lock(&mutext1)`在阅读和修改`SharedVariable`. 在这种情况下，每个线程的`add-by-one`操作可能不是连续的，但每个线程都会得到正确的最终值。

在你读取 的最终值之前`SharedVariable`，使用屏障等待所有线程完成它们的工作。

# javascript - 在 html/javascript 中旋转徽标

> ID：11254944
> 
> 赞同：-2
> 
> 时间：2012-06-29T01:16:44.870
> 
> 标签：javascript, jquery, html

我正在尝试使用 html 和 javascript 在我的网站上创建一个旋转徽标。

我希望它在页面加载时旋转，并随机加载它们。

我试过很多东西！我在谷歌上找到的，我似乎无法让它工作。我试图避免使用 php 来做到这一点。

我希望能够在如下标签中包含随机图像，（如果可能的话）

```
<img src="" /> 
```

所以，简单总结一下。

我想使用“html”和“javascript”来创建一个脚本，每次刷新页面时，它都会从我服务器上的目录中加载一个新徽标。

编辑：我尝试过的

```
<script type="javascript>
    Array.prototype.random = function () { 
        return this[ parseInt( Math.random() * this.length )  ];
    }

    var myImage=[ 
        "logo1.png",
        "logo1.png",
        "logo1.png",
        "logo1.png"
    ].random()

    document.wite(myImage)
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T01:24:09.883

您应该避免使用 document.write。而是`id`在标签上放置一个属性`img`，并使用 document.getElementById 检索它。您可以使用 setInterval 方法使其每隔一段时间刷新：

```
<img id="logo" />
<script type="text/javascript">
var logos = ["logo1.png", "logo2.png", "logo3.png"];
var currentLogoIndex = 0;
function updateLogo() {
    document.getElementById('logo').src = logos[currentLogoIndex];
    currentLogoIndex++;
    currentLogoIndex %= logos.length;
}
window.setInterval(updateLogo, 1000);
updateLogo();
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T01:26:01.853

您可以将 存储`pathes`在数组中并使用 random 选择它们`index`。

```
$(document).ready(function() {

var src = ['path1.jpg', 'path2.jpg', 'path3.jpg', 'path4.jpg', 'path5.jpg', 'path6.jpg', 'path7.jpg', 'path8.jpg', 'path9.jpg'];

$('img').attr('src', src[Math.floor(Math.random()*10)]) // it returns a number between 0 and 10

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T01:41:52.690

你知道，有一个使用 CSS 转换的 jQuery 插件。

[http://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html](http://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T02:03:21.690

```
<html>
<body>
<h1>Random logo From List</h1>
<script type="javascript>
    Array.prototype.random = function () { 
        return this[ parseInt( Math.random() * this.length )  ];
    }

    var myImage=[ 
        "logo1.png",
        "logo1.png",
        "logo1.png",
        "logo1.png"
    ].random()

    document.wite("<img src='" + myImage + "' />)
</script>

<h2>Hoo just got a random logo</h2>
</body>
</html> 
```

看起来这是你尝试的：

对于使用 document.write 和 document.getElement 的一些解释：

当您编写像上面这样的内联代码时，您可以使用 document.write，它只会在`</h1>`正常的“打印”操作之后添加文本。

一旦您在加载文档后使用它，它就会清除所有内容并覆盖整个内容。

如果要在加载后更改文档，则必须编辑 DOM，文档在加载后表示为 DOM。在这种情况下，您应该使用不同的 DOM 操作函数，例如

```
document.getElementById('logo-image').src = myImage; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T01:53:55.210

我正在求助于 php 家伙。

```
<img src="/images/logo/<?php $random = rand(1,3); echo $random; ?>.png" alt="LOGO!!!!" /> 
```

完美运行:)

# python - ctypes netsnmp 与多处理

> ID：11254949
> 
> 赞同：0
> 
> 时间：2012-06-29T01:17:48.753
> 
> 标签：python, multiprocessing, net-snmp

我希望有人可以帮助...

所以......我正在编写一个`multiprocessing`基于python的`netsnmp`轮询器（我在收集数据后做了很多数据结构操作，所以开销比正常情况下值得`threading`）。我找不到完整的 python 接口（具有不错的 OID 操作、bulkwalk 等），所以我决定纠正我自己的`ctypes`绑定。我`snmp_sess_synch_response()`用来实际执行查询。

当我运行单个线程时，一切正常（我可以查询并获取结果）。但是当我从继承的`Process`实例中调用我的（python）netsnmp 类时；当它到达时`snmp_sess_synch_response()`，线程停止，然后返回返回码“2”并`snmp_errstring()`返回“未知错误”。

我能找到的唯一信息是我应该使用来自[http://net-snmp.sourceforge.net/docs/README.thread.html](http://net-snmp.sourceforge.net/docs/README.thread.html)的单一 API，并且初始 MIB 构建应该在线程之前。我正在使用单一 API，并且在生成我的工人之前我正在构建 MIB。

有谁知道我应该如何进行调试？ctypes如何处理多线程？为什么使用`multiprocessing`会导致我工作的单线程轮询器像这样停止？

我在 redhat 6 64 位和 python 2.6.6 上使用 net-snmp 5.5-41.el6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T07:43:15.440

事实证明这是一个没有关闭我的文件句柄的问题，所以过了一会儿，线程耗尽了它的所有句柄并提示抛出了一堆错误的错误。

# xslt - XSLT 复制 XML 的全部内容，但有 2 个（或更多）例外

> ID：11254950
> 
> 赞同：1
> 
> 时间：2012-06-29T01:17:53.627
> 
> 标签：xslt, xslt-1.0

我有一个很大的输入 XML，我想为特定的客户端缩小它。客户应该只看到与他相关的信息。这是示例输入。

```
<?xml version='1.0' encoding='UTF-8' ?>
<reg>
<global>stuff</global>
<profile>
<profile_data>profile stuff 1</profile_data>
<users>
<u><usr_data>usr options 1</usr_data><n>user-1</n></u>
<u><usr_data>usr options 2</usr_data><n>user-2</n></u>
</users>
</profile>
<profile>
<profile_data>profile stuff 2</profile_data>
<users>
<u><usr_data>usr options 3</usr_data><n>user-3</n></u>
<u><usr_data>usr options 4</usr_data><n>user-4</n></u>
</users>
</profile>
</reg> 
```

这需要转换成一个更小的 XML，如下所示：

```
<?xml version="1.0"?>
<reg>
<global>stuff</global>
<profile>
<profile_data>profile stuff 1</profile_data>
<users>
<u><usr_data>usr options 1</usr_data><n>user-1</n></u>
</users>
</profile>
</reg> 
```

我已经成功地使用 2 个串联应用的 XSLT 转换（trans1.xml）来实现这一点：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:param name="name"/>
<xsl:output method="xml"/>
<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
<xsl:template match="/reg/profile">
    <xsl:if test="./users/*/n=$name">
        <xsl:copy-of select="." />
    </xsl:if>
</xsl:template>
</xsl:stylesheet> 
```

和（trans2.xml）：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:param name="name"/>
<xsl:output method="xml"/>
<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
<xsl:template match="/reg/profile/users/*">
    <xsl:if test="./n=$name">
        <xsl:copy-of select="." />
    </xsl:if>
</xsl:template>
</xsl:stylesheet> 
```

然后：

```
xsltproc -param name "'user-1'" trans1.xml input.xml > out1.xml
xsltproc -param name "'user-1'" trans2.xml out1.xml > result.xml 
```

如何将我的 2 个 XSl 样式表转换为 1 个，以便在 1 个步骤中执行这 2 个操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:15:46.367

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pName" select="'user-1'"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="profile">
  <xsl:if test="users/u/n = $pName">
    <xsl:call-template name="identity"/>
  </xsl:if>
 </xsl:template>

 <xsl:template match="u">
  <xsl:if test="n = $pName">
   <xsl:call-template name="identity"/>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<reg>
    <global>stuff</global>
    <profile>
        <profile_data>profile stuff 1</profile_data>
        <users>
            <u>
                <usr_data>usr options 1</usr_data>
                <n>user-1</n>
            </u>
            <u>
                <usr_data>usr options 2</usr_data>
                <n>user-2</n>
            </u>
        </users>
    </profile>
    <profile>
        <profile_data>profile stuff 2</profile_data>
        <users>
            <u>
                <usr_data>usr options 3</usr_data>
                <n>user-3</n>
            </u>
            <u>
                <usr_data>usr options 4</usr_data>
                <n>user-4</n>
            </u>
        </users>
    </profile>
</reg> 
```

**产生想要的正确结果：**

```
<reg>
   <global>stuff</global>
   <profile>
      <profile_data>profile stuff 1</profile_data>
      <users>
         <u>
            <usr_data>usr options 1</usr_data>
            <n>user-1</n>
         </u>
      </users>
   </profile>
</reg> 
```

**说明**：

正确使用和覆盖**[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**。

# javascript - 仅 Javascript 没有 JQUERY 幻灯片 一个 DIV .Active 类

> ID：11254952
> 
> 赞同：0
> 
> 时间：2012-06-29T01:18:11.973
> 
> 标签：javascript, image, slideshow

使用下面的 HTML，我需要创建一个 Javascript ONLY 脚本，以便在单击按钮后无限期地循环 4 个图像。我通过 jQuery 解决了问题，但想在 Javascript 中弄清楚它以真正学习基础知识，但除了摆脱起始图片并留在空白 div 上之外，我似乎无法让它做任何事情。

```
<div id='challengeTwoImageJavascript' class='sectionChallengeCarouselImage'>
    <img id='imgj1' imgn='1' class='carouselImage carouselImageJavascriptActive' src='img/image1.jpg'/>
    <img id='imgj2' imgn='2' class='carouselImage' src='img/image2.jpg'/>
    <img id='imgj3' imgn='3' class='carouselImage' src='img/image3.jpg'/>
    <img  id='imgj4' imgn='4'class='carouselImage' src='img/image4.jpg'/>
</div> 
```

JS

```
var img = document.getElementByClassName('carouselImageJavascriptActive');
document['#challengeTwoImageJavascript'].src = searchPic.src; = myImage[x];
x++;
var myImage = new Array();
var x=0;

myImage[0]='img/image1.jpg';
myImage[1]='img/image2.jpg';
myImage[2]='img/image3.jpg';
myImage[3]='img/image4.jpg'; 
```

这就是我目前正在使用的。无法弄清楚如何仅使用 javascript 让活动类正确移动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:02:24.190

这里。我做了一个幻灯片。我不知道这是否正是你想要的。当您单击“开始”时，它会按顺序浏览图像：

```
(function() {

  var images = [
    'http://bit.ly/sbK2Ub',
    'http://bit.ly/yYi5oQ',
    'http://bit.ly/4GjHJn',
    'http://bit.ly/xgpWlQ',
    'http://bit.ly/pFjGed'
  ];
  var i = 0,
      img = document.createElement('img');
  function foward() {
    if (images[i] && images[i + 1]) {
      img.src = images[i];
      document.body.appendChild(img);
      i++;
    }
  }
  document.getElementById('myButton')[0].onclick = foward;
})(); 
```

Demo here（点击“Render”运行）：http: [//jsbin.com/urixax/edit#javascript,html](http://jsbin.com/urixax/edit#javascript,html)

这是我最近做的一个。我可以通过图像来回前进：

```
(function( window, document, undefined ) {
    var Main = {
        images: [],
        idx: -1,

        fillArray: function( arr ) {
            var img = new Image(),
                load = function( a ) {
                    for (var i = 0; i < a.length; i++) {
                        img.src = a[i];
                    }
                };

            if ( typeof arr === "object" ) {
                if ( arr.length ) {
                    load( arr );
                    Main.images = Main.images.concat( arr );
                } else Main.images.push( arr );
            } else {
                if ( arguments.length ) {
                    load( arguments );
                    for (var i = 0; i < arguments.length; i++) {
                        Main.images.push( arguments[i] );
                    }
                } else return;
            }
        },
        changeImage: function( el, n ) {
            if (n < 0) {
                if ( Main.images[Main.idx - 1] ) {
                    Main.idx -= -n;
                    el.src = Main.images[Main.idx];
                }
            } else {
                if ( Main.images[Main.idx + 1] ) {
                    Main.idx += n;
                    el.src = Main.images[Main.idx];
                }
            }
        }
    };

    var a = [
        'http://bit.ly/sbK2Ub',
        'http://bit.ly/yYi5oQ',
        'http://bit.ly/4GjHJn',
        'http://bit.ly/xgpWlQ',
        'http://bit.ly/pFjGed'
    ];

    var b = document.getElementById('back'),
        n = document.getElementById('next'),
        c = document.getElementById('image');

    Main.fillArray(a);

    n.onclick = b.onclick = function() {
      Main.changeImage( c, this.id === "next" ? 1 : -1 );
    };
})( this, this.document ); 
```

Demo here（点击“Render”运行）：http: [//jsbin.com/ohivex/edit#javascript,html](http://jsbin.com/ohivex/edit#javascript,html)

# c - char* 和 char[] 与 strcpy() 的区别

> ID：11254953
> 
> 赞同：5
> 
> 时间：2012-06-29T01:18:19.980
> 
> 标签：c, string, char

在过去的几个小时里，我在一个我理解的问题上遇到了麻烦。这是我的麻烦：

```
void cut_str(char* entry, int offset) {
    strcpy(entry, entry + offset);
}

char  works[128] = "example1\0";
char* doesnt = "example2\0";

printf("output:\n");

cut_str(works, 2);
printf("%s\n", works);

cut_str(doesnt, 2);
printf("%s\n", doesnt);

// output:
// ample1
// Segmentation: fault 
```

我觉得关于 char*/char[] 有一些重要的东西我没有说到这里。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T01:20:02.230

不同之处在于`doesnt`指向属于字符串常量的内存，因此不可写。

当你这样做时

```
char  works[128] = "example1\0"; 
```

编译器将不可写字符串的内容*复制到可写数组中。*`\0`顺便说一句，这不是必需的。

然而，当你这样做时，

```
char* doesnt = "example2\0"; 
```

编译器使指针指向不可写的内存区域。同样，`\0`将由编译器插入。

如果您正在使用`gcc`，则可以让它警告您有关`char *`使用字符串文字初始化可写的内容。选项是`-Wwrite-strings`。您将收到如下所示的警告：

```
 warning: initialization discards qualifiers from pointer target type 
```

声明指针的正确方法`doesnt`如下：

```
const char* doesnt = "example2\0"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T01:25:24.333

类型`char[]`和`char *`非常相似，所以你是对的。不同之处在于初始化类型的对象时会发生什么。您的 object`works`类型`char[]`，在堆栈上为其分配了 128 字节的变量存储空间。您的 object `doesnt`， type `char *`，*在堆栈上没有存储空间。*

C 标准没有指定字符串的确切`doesnt`存储位置，但很可能它存储在加载程序以执行时加载的不可修改数据段中。这不是变量存储。因此，当您尝试改变它时会出现段错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T01:23:43.563

这会在堆栈上分配 128 个字节，并使用名称`works`来引用其地址：

```
char works[128]; 
```

`works`指向可写内存的指针也是如此。

这将创建一个字符串文字，它位于只读内存中，并使用名称`doesnt`来引用其地址：

```
char * doesnt = "example2\0"; 
```

您可以将数据写入`works`，因为它指向可写内存。您不能将数据写入`doesnt`，因为它指向只读内存。

另外，请注意，您不必以 结束字符串文字`"\0"`，因为所有字符串文字都会在字符串末尾隐式添加一个零字节。

# azure - Azure 数据库备份丢失评论

> ID：11254954
> 
> 赞同：0
> 
> 时间：2012-06-29T01:18:50.147
> 
> 标签：azure, azure-sql-database, database-backups, bacpac

我正在使用 DAC 框架的[Import Export Service Client 工具](http://sqldacexamples.codeplex.com/releases/view/87880)从 Azure 上的 SQL 数据库中导出 BACPAC 文件。但是当我将 BACPAC 文件还​​原到 Azure 数据库时，它会丢失最初**在 Create statement 上方输入的 Store Procedure 或 View****的注释**。这是因为导出工具忽略了创建视图或存储过程之外的注释吗？

 **```
/*  
 XXXX Procedure    
 Version 1.0,   */
 CREATE Procedure [dbo].XXXX 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T10:22:34.120

我对DAC不熟悉。但我认为这是一种预期的行为。运行时不使用注释。如果它们被删除，性能会略有提高，因为引擎不需要解析评论。

此致，

明旭。**

# sql - sql使用多连接子选择更新多行

> ID：11254955
> 
> 赞同：-2
> 
> 时间：2012-06-29T01:18:55.113
> 
> 标签：sql, sql-server, sql-subselect

这是我之前提出的问题的更新第 2 部分。我正在尝试进行以下更新，但此查询实际上似乎没有做任何事情。

```
UPDATE  u
SET     graduation_class_id = gc.graduation_class_id
FROM    [user] u
JOIN    graduation_class gc
ON      u.graduation_class_id = gc.graduation_class_id
JOIN    graduation_term gt
ON      gt.graduation_year_id = gc.graduation_year_id

TABLE SCHEMA
**user
user_id
graduation_class_id

**graduation_class
graduation_class_id
graduation_year_id

**graduation_term
graduation_term_id
graduation_year_id 
```

目标是将匹配的毕业类别 ID 值放入用户表中。我被告知这行不通，因为除非用户已经拥有匹配的毕业类别 ID，否则不会找到匹配项。这是一个问题，因为我正试图在其中找到合适的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:28:00.687

这个想法从根本上注定要失败。尽管 SQL 服务器没有关于应将哪个毕业课程链接到用户的信息，但您正试图让 SQL 服务器自行将毕业课程链接到用户。除非您有一些数据（在用户、毕业班、其他表中）将 user_id 链接到毕业学期、班级或年份（或者有人手动告诉 SQL 哪些数据匹配），否则 SQL 不能神奇地做到这一点为你工作。

# javascript - MVC4 移动模板脚本加载

> ID：11254956
> 
> 赞同：0
> 
> 时间：2012-06-29T01:19:04.587
> 
> 标签：javascript, jquery-mobile, asp.net-mvc-4

我目前正在使用 MVC4 Mobile 模板，并且在获取特定视图以呈现其 javascript 时压力很大。

在我的 MediaView.chtml 视图中，我有以下标签：

```
<script src="@Url.Content("~/Scripts/pyg/pyg-player.js")" type="text/javascript"></script> 
```

**当我直接**导航到视图时，此标记效果很好，但是当使用模板上的默认索引页面并单击我的操作链接时，页面执行其小的过渡效果并且脚本无法正确加载。

![丁目网络输出](../Images/a8bbca8cf8a9d3f35b70a224dab745ed.png) 看起来 jquery 在加载过程中正在执行脚本的加载，有没有办法阻止 jquery 负责加载？

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:25:04.083

看起来我刚刚遇到了从桌面 Web 开发过渡到移动开发的问题。由于 MVC4 模板使用的是 Jquery Mobile，因此仅呈现第一页。所有后续请求都是由 ajax 发出的，因此脚本永远不会正确加载。您需要做的不是绑定在 $(document).ready() 上，而是需要绑定到**pageinit**

```
$( document ).delegate("#aboutPage", "pageinit", function() {
  alert('A page with an ID of "aboutPage" was just created by jQuery Mobile!');
}); 
```

更多信息可以在 jQuery Mobile 网站上找到。

[http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html)

# ruby-on-rails - 当外键被它所属的表覆盖时怎么办？

> ID：11254962
> 
> 赞同：0
> 
> 时间：2012-06-29T01:21:09.450
> 
> 标签：ruby-on-rails, ruby, model, foreign-keys

对于措辞混乱的问题和可能令人困惑的解释，我深表歉意，但坦率地说，我很困惑。

我有一个**contact_link**模型`:belongs_to`，除其他模型外，还有一个**人**模型。**人物**模型`:has_many :events through => :contact_link`。_

问题是**人**模型有它的`:id`字段（primary_key）和一个`:person_id`字段（那种作为“公共”键的功能）。

问题是，当我尝试构造一个**contact_link**时，rails 按照惯例，会在名为 的列中查找**与**person 表**关联**`:id`的链接表。它最终使用不用于关联的 ，认为它是**person**表的字段。**`person_id``:person_id``:id`**

 ****这有意义吗？如果是这样，我该怎么做才能绕过它。这是工作代码，所以我无法更改架构。这是我的代码：

```
class RecordOfContactImporter

  def self.import_data(contact_record_file)
    Rails.application.csv_impl.parse(contact_record_file, :headers => true, :header_converters => :symbol) do |row|
      next if row.header_row?

      if participant = Participant.where(:p_id => row[:participant_id]).first
        person = get_person_record(row)
        person.save!

        event = get_event_record(row, participant)
        event.save!

        contact = get_contact_record(row, event, person)
        contact.save!

        contact_link = get_contact_link_record(row, event, person, contact)

        p contact_link.valid?
        if contact_link.valid?
          contact_link.save!
        else
        #  File.open(contact_link_import_error_log, 'a') {|f| f.write("[#{Time.now.to_s(:db)}] contact_link record invalid for - #{row} - #{contact_link.errors.map(&:to_s)}\n") }
        end
      else
        # TODO: log row in missig participants file
     end
    end
  end

  def self.contact_link_import_error_log
    dir = "#{Rails.root}/log/contact_link_import_error_logs"
    FileUtils.makedirs(dir) unless File.exists?(dir)
    log_path = "#{dir}/#{Date.today.strftime('%Y%m%d')}_import_errors.log"
    File.open(log_path, 'w') {|f| f.write("[#{Time.now.to_s(:db)}] \n\n") } unless File.exists?(log_path)
    log_path
  end

  def self.get_person_record(row)
    person = Person.where(:person_id => row[:person_id]).first
    person = Person.new(:person_id => row[:person_id]) if person.blank?
    person.first_name = row[:person_first_name] unless row[:person_first_name].blank?
    person.last_name = row[:person_last_name] unless row[:person_last_name].blank?
    person
  end

  def self.get_event_record(row, participant)
    start_date = Date.strptime(row[:event_start_date], '%m/%d/%y')

    event = Event.where(:participant_id => participant.id,
                        :event_type_code => row[:event_type],
                        :event_start_date => start_date).first

    event = Event.new(:participant_id => participant.id,
                      :event_type_code => row[:event_type],
                      :event_start_date => start_date) if event.blank?

    event.participant                     = participant
    event.event_type_other                = row[:event_type_other] unless row[:event_type_other].blank?
    event.disposition                     = row[:disposition] unless row[:disposition].blank?
    event.event_disposition_category_code = row[:event_disposition_category] unless row[:event_disposition_category].blank?
    event.event_start_time                = row[:event_start_time] unless row[:event_start_time].blank?
    event.event_breakoff_code             = row[:event_breakoff] unless row[:event_breakoff].blank?
    event.event_comment                   = row[:event_comment] unless row[:event_comment].blank?
    event
  end

  def self.get_contact_record(row, event, person)
    contact_date = Date.strptime(row[:contact_date], '%m/%d/%y')
    pre_existing_contact = nil

    ContactLink.where(:event_id => event.id, :person_id => person.id).all.each do |cl|
      contact = Contact.where(:id => cl.contact_id).first
      pre_existing_contact = contact if contact.contact_date_date == contact_date &&  contact.contact_start_time == row[:contact_start_time]
      pre_existing_contact
    end

    contact = pre_existing_contact unless pre_existing_contact.nil?
    contact = Contact.new() if contact.blank?

    contact.psu_code                = row[:psu_code] unless row[:psu_code].blank?
    contact.contact_disposition     = row[:contact_disposition] unless row[:contact_disposition].blank?
    contact.contact_type_code       = row[:contact_type] unless row[:contact_type].blank?
    contact.contact_type_other      = row[:contact_type_pther] unless row[:contact_type_pther].blank?
    contact.contact_date            = row[:contact_date] unless row[:contact_date].blank?
    contact.contact_start_time      = row[:contact_start_time] unless row[:contact_start_time].blank?
    contact.contact_end_time        = row[:contact_end_time] unless row[:contact_end_time].blank?
    contact.language_code           = row[:language] unless row[:language].blank?
    contact.language_other          = row[:language_other] unless row[:language_other].blank?
    contact.interpret_code          = row[:interpret] unless row[:interpret].blank?
    contact.interpret_other         = row[:interpret_other] unless row[:interpret_other].blank?
    contact.location_code           = row[:location] unless row[:location].blank?
    contact.location_other          = row[:location_other] unless row[:location_other].blank?
    contact.contact_private_code    = row[:contact_private] unless row[:contact_private].blank?
    contact.who_contacted_code      = row[:who_contacted] unless row[:who_contacted].blank?
    contact.contact_comment         = row[:contact_comment] unless row[:contact_comment].blank?
    contact
  end

  def self.get_contact_link_record(row, event, person, contact)
    contact_link = ContactLink.where(:person_id => person.id, :event_id => event.id, :contact_id => contact.id).first
    contact_link = ContactLink.new(:person_id => person.id, :event_id => event.id, :contact_id => contact.id) #if contact_link.blank?

    populate_contact_link_attributes(contact_link, row)
    populate_contact_link_ncs_coded_attributes(contact_link, row)
    contact_link
  end

  def self.populate_contact_link_attributes(contact_link, row)
    [ :id,
      :psu_code,
      :contact_link_id,
      :contact_id,
      :event_id,
      :instrument_id,
      :staff_id,
      :person_id,
      :provider_id,
      :transaction_type
    ].each do |attribute|
      contact_link.send("#{attribute}=", row[attribute]) unless row[attribute].blank?
    end
  end

  def self.populate_contact_link_ncs_coded_attributes(pbs_list, row)
    [ :psu
    ].each do |attribute|
      contact_link.send("#{attribute}_code=", row[attribute]) unless row[attribute].blank?
    end
  end

end 
```

这是测试代码：

```
# -*- coding: utf-8 -*-

require 'spec_helper'

module NcsNavigator::Core

  describe RecordOfContactImporter do

    context "uploading csv data" do

      describe ".import_data" do

        before(:each) do
          # create Participants and a particular participant for an exisiting record
          [11111111, 22222222, 11112222, 22221111].each { |id| Participant.create :p_id => id }
          participant = Participant.where(:p_id => '11111111').first
          # create a Person
          person = Person.create! :person_id => 11111111

          # create an event associated with a the particular participant
          event = Event.new :event_type_code => 15, :event_start_date => '2012-04-10'
          event.participant = participant
          event.save!

          # create a contact with a colliding date and time
          contact = Contact.create!(:contact_date_date => Date.parse('2012-04-10'), :contact_start_time => '15:00')

          # create a contact link to bring the contact together with the person and event
          ContactLink.create!(:person => person, :event => event, :contact => contact, :staff_id => 1)
        end

        it "finds a person if one exists or creates one if it doesn't" do
          Person.count.should == 1
          RecordOfContactImporter.import_data(File.open("#{Rails.root}/spec/fixtures/data/ROC_Code_lists_and_Dispositions.csv"))
          Person.count.should == 4
        end

        it "finds an event if one exists or creates one if it doesn't" do
          Event.count.should == 1
          RecordOfContactImporter.import_data(File.open("#{Rails.root}/spec/fixtures/data/ROC_Code_lists_and_Dispositions.csv"))
          Event.count.should == 4
        end

        it "finds a contact if one exists or creates one if it doesn't" do
          Contact.count.should == 1
          RecordOfContactImporter.import_data(File.open("#{Rails.root}/spec/fixtures/data/ROC_Code_lists_and_Dispositions.csv"))
          Contact.count.should == 4
        end

        it "creates a ContactLink from the data" do
          ContactLink.count.should == 1
          RecordOfContactImporter.import_data(File.open("#{Rails.root}/spec/fixtures/data/ROC_Code_lists_and_Dispositions.csv"))
          ContactLink.count.should == 4
        end

        it "associates a ContactLink with a Person, Event, and Contact" do
          person = Person.first
          contact = Contact.first
          event = Event.first
          ContactLink.first.person.should == person
        end

      end
    end

    context ".get_person_record" do

      context "with an existing person record" do

        let(:person) { Factory(:person, :person_id => "bob") }

        it "finds the record by person_id" do
          row = get_first_data_row_from_csv("existing_person")
          person.person_id.should == row[:person_id]
          RecordOfContactImporter.get_person_record(row).should == person
        end

        it "sets the first name if given in row" do
          row = get_first_data_row_from_csv("existing_person")
          person.first_name.should == "Fred"
          person = RecordOfContactImporter.get_person_record(row)
          person.first_name.should == "Bobby"
        end

        it "does not update first name if the data in the row first name is blank" do
          row = get_first_data_row_from_csv("existing_person_with_blank_name")
          person.first_name.should == "Fred"
          person = RecordOfContactImporter.get_person_record(row)
          person.first_name.should == "Fred"
        end

      end

      context "without an existing person record" do

        before(:each) do
          @row = get_first_data_row_from_csv("existing_person_with_blank_name")
        end

        it "builds a new person record if no person exists" do
          person = RecordOfContactImporter.get_person_record(@row)
          person.class.should == Person
        end

      end
    end
  end

end 
```

这是其余的代码：

人

```
# == Schema Information
# Schema version: 20120607203203
#
# Table name: people
#
#  id                             :integer         not null, primary key
#  psu_code                       :integer         not null
#  person_id                      :string(36)      not null
#  prefix_code                    :integer         not null
#  first_name                     :string(30)
#  last_name                      :string(30)
#  middle_name                    :string(30)
#  maiden_name                    :string(30)
#  suffix_code                    :integer         not null
#  title                          :string(5)
#  sex_code                       :integer         not null
#  age                            :integer
#  age_range_code                 :integer         not null
#  person_dob                     :string(10)
#  person_dob_date                :date
#  deceased_code                  :integer         not null
#  ethnic_group_code              :integer         not null
#  language_code                  :integer         not null
#  language_other                 :string(255)
#  marital_status_code            :integer         not null
#  marital_status_other           :string(255)
#  preferred_contact_method_code  :integer         not null
#  preferred_contact_method_other :string(255)
#  planned_move_code              :integer         not null
#  move_info_code                 :integer         not null
#  when_move_code                 :integer         not null
#  date_move_date                 :date
#  date_move                      :string(7)
#  p_tracing_code                 :integer         not null
#  p_info_source_code             :integer         not null
#  p_info_source_other            :string(255)
#  p_info_date                    :date
#  p_info_update                  :date
#  person_comment                 :text
#  transaction_type               :string(36)
#  created_at                     :datetime
#  updated_at                     :datetime
#  being_processed                :boolean
#  response_set_id                :integer
#

# -*- coding: utf-8 -*-

# A Person is an individual who may provide information on a participant.
# All individuals contacted are Persons, including those who may also be Participants.
require 'ncs_navigator/configuration'
class Person < ActiveRecord::Base
  include MdesRecord
  acts_as_mdes_record :public_id_field => :person_id, :date_fields => [:date_move, :person_dob]

  ncs_coded_attribute :psu,                      'PSU_CL1'
  ncs_coded_attribute :prefix,                   'NAME_PREFIX_CL1'
  ncs_coded_attribute :suffix,                   'NAME_SUFFIX_CL1'
  ncs_coded_attribute :sex,                      'GENDER_CL1'
  ncs_coded_attribute :age_range,                'AGE_RANGE_CL1'
  ncs_coded_attribute :deceased,                 'CONFIRM_TYPE_CL2'
  ncs_coded_attribute :ethnic_group,             'ETHNICITY_CL1'
  ncs_coded_attribute :language,                 'LANGUAGE_CL2'
  ncs_coded_attribute :marital_status,           'MARITAL_STATUS_CL1'
  ncs_coded_attribute :preferred_contact_method, 'CONTACT_TYPE_CL1'
  ncs_coded_attribute :planned_move,             'CONFIRM_TYPE_CL1'
  ncs_coded_attribute :move_info,                'MOVING_PLAN_CL1'
  ncs_coded_attribute :when_move,                'CONFIRM_TYPE_CL4'
  ncs_coded_attribute :p_tracing,                'CONFIRM_TYPE_CL2'
  ncs_coded_attribute :p_info_source,            'INFORMATION_SOURCE_CL4'

  belongs_to :response_set
  # surveyor
  has_many :response_sets, :class_name => "ResponseSet", :foreign_key => "user_id"
  has_many :contact_links, :order => "created_at DESC"
  has_many :instruments, :through => :contact_links
  has_many :events, :through => :contact_links
  has_many :addresses
  has_many :telephones
  has_many :emails

  has_many :household_person_links
  has_many :household_units, :through => :household_person_links

  has_many :participant_person_links
  has_many :participants, :through => :participant_person_links
  # validates_presence_of :first_name
  # validates_presence_of :last_name

  validates_length_of :title, :maximum => 5, :allow_blank => true

  accepts_nested_attributes_for :addresses, :allow_destroy => true
  accepts_nested_attributes_for :telephones, :allow_destroy => true
  accepts_nested_attributes_for :emails, :allow_destroy => true

  before_save do
    self.age = self.computed_age if self.age.blank?
  end

  ##
  # How to format the date_move attribute
  # cf. MdesRecord
  # @return [String]
  def date_move_formatter
    '%Y-%m'
  end

  ##
  # Determine the age of the Person based on the date of birth
  # @return [Integer]
  def computed_age
    return nil if dob.blank?
    now = Time.now.utc.to_date
    offset = ((now.month > dob.month || (now.month == dob.month && now.day >= dob.day)) ? 0 : 1)
    now.year - dob.year - offset
  end

  ##
  # Display text from the NcsCode list GENDER_CL1
  # cf. sex belongs_to association
  # @return [String]
  def gender
    sex.to_s
  end

  ##
  # Override to_s to return the full name of the Person
  # aliased as :name and :full_name
  # @return [String]
  def to_s
    "#{first_name} #{last_name}".strip
  end
  alias :name :to_s
  alias :full_name :to_s

  ##
  # Helper method to set first and last name from full name
  # Sets first name if there is no space in the name
  # @param [String]
  def full_name=(full_name)
    full_name = full_name.split
    if full_name.size >= 2
      self.last_name = full_name.last
      self.first_name = full_name[0, (full_name.size - 1) ].join(" ")
    else
      self.first_name = full_name
    end
  end

  ##
  # Override default setter to also set Date value for use in calculations
  def person_dob=(dob)
    self[:person_dob] = dob
    begin
      self.person_dob_date = Date.parse(dob)
    rescue
      # Date entered is unparseable
    end
  end

  def self_link
    participant_person_links.detect { |ppl| ppl.relationship_code == 1 }
  end
  private :self_link

  ##
  # The participant record associated with this person if any whose
  # relationship is self
  def participant
    self_link.try(:participant)
  end

  ##
  # Create or update the participant record associated with this person whose
  # relationship is self
  def participant=(participant)
    ppl = self_link
    if ppl
      ppl.participant = participant
    else
      participant_person_links.build(:relationship_code => 1, :person => self, :participant => participant, :psu => self.psu)
    end
  end

  ##
  # A Person is a Participant if there is an association on the participant table
  # @return [Boolean]
  def participant?
    !participant.nil?
  end

  ##
  # The Participant ppg_status local_code (cf. NcsCode) if applicable
  # @return [Integer]
  def ppg_status
    participant.ppg_status.local_code if participant && participant.ppg_status
  end

  ##
  # Based on the current state, pregnancy probability group, and
  # the intensity group (hi/lo) determine the next event
  # cf. Participant.upcoming_events
  # @return [String]
  def upcoming_events
    events = []
    if participant?
      participant.upcoming_events.each { |e| events << e }
    else
      events << "Pregnancy Screener"
    end
    events
  end

  ##
  # Builds a new ResponseSet for the Person associated with the given Survey
  # and pre-populates questions to which we have previous data.
  #
  # @param [Survey]
  # @return [ResponseSet]
  def start_instrument(survey)
    # TODO: raise Exception if survey is nil
    return if survey.nil?

    build_instrument(survey).tap do |instr|
      instr.build_response_set(:survey => survey, :user_id => self.id)

      prepopulate_response_set(instr.response_set, survey)
    end
  end

  def prepopulate_response_set(response_set, survey)
    # TODO: determine way to know about initializing data for each survey
    reference_identifiers = ["prepopulated_name", "prepopulated_date_of_birth", "prepopulated_ppg_status", "prepopulated_local_sc", "prepopulated_sc_phone_number", "prepopulated_baby_name", "prepopulated_childs_birth_date"]

    response_type = "string_value"

    reference_identifiers.each do |reference_identifier|
      question = nil
      survey.sections_with_questions.each do |section|
        section.questions.each do |q|
          question = q if q.reference_identifier == reference_identifier
          break unless question.nil?
        end
        break unless question.nil?
      end
      if question
        answer = question.answers.first
        value = case reference_identifier
                when "prepopulated_name"
                  response_type = "string_value"
                  name
                when "prepopulated_date_of_birth"
                  response_type = "string_value"
                  dob.to_s
                when "prepopulated_ppg_status"
                  response_type = "integer_value"
                  ppg_status
                when "prepopulated_local_sc"
                  response_type = "string_value"
                  NcsNavigatorCore.study_center_name
                when "prepopulated_sc_phone_number"
                  response_type = "string_value"
                  NcsNavigatorCore.study_center_phone_number
                else
                  # TODO: handle other prepopulated fields
                  nil
                end

        response_set.responses.build(:question => question, :answer => answer, response_type.to_sym => value)
      end
    end
    response_set
  end

  ##
  # Returns the number of times (0 based) this instrument has been taken for the given survey
  # @param [Survey]
  # @return [Fixnum]
  def instrument_repeat_key(survey)
    response_sets_for_survey = response_sets.select { |rs| rs.survey.title == survey.title }
    response_sets_for_survey.blank? ? 0 : response_sets_for_survey.size - 1
  end

  ##
  # Return the currently active ContactLink, if a person is associated with a Contact through
  # a ContactLink and that ContactLink has not been closed (cf. Event#closed? and Contact#closed?)
  #
  # @return [ContactLink]
  def current_contact_link
    open_contact_links = contact_links.select { |link| !link.complete? }
    return nil if open_contact_links.blank?
    return open_contact_links.first if open_contact_links.size == 1
    # TODO: what to do if there is more than one open contact?
  end

  ##
  # Create a new Instrument for the Person associated with the given Survey.
  #
  # @param [Survey]
  # @return [ResponseSet]
  def build_instrument(survey)
    Instrument.new(:psu_code => NcsNavigatorCore.psu,
      :instrument_version => Instrument.determine_version(survey.title),
      :instrument_type => InstrumentEventMap.instrument_type(survey.title),
      :person => self,
      :survey => survey)
  end

  ##
  # Determine if this Person has started this Survey
  # @param [Survey]
  # @return [true, false]
  def started_survey(survey)
    ResponseSet.where(:survey_id => survey.id).where(:user_id => self.id).count > 0
  end

  ##
  # Get the most recent instrument for this survey
  # @param [Survey]
  # @return [Instrument]
  def instrument_for(survey)
    ins = Instrument.where(:survey_id => survey.id).where(:person_id => self.id).order("created_at DESC")
    ins.first
  end

  ##
  # Convenience method to get the last incomplete response set
  # @return [ResponseSet]
  def last_incomplete_response_set
    rs = response_sets.last
    rs.blank? ? nil : (rs.complete? ? nil : rs)
  end

  ##
  # Convenience method to get the last completed survey
  # @return [ResponseSet]
  def last_completed_survey
    rs = response_sets.last
    rs.complete? ? rs.survey : nil
  end

  ##
  # Given a data export identifier, return the responses this person made for that question
  # @return [Array<Response>]
  def responses_for(data_export_identifier)
    Response.includes([:answer, :question, :response_set]).where(
      "response_sets.user_id = ? AND questions.data_export_identifier = ?", self.id, data_export_identifier).all
  end

  ##
  # Returns all DwellingUnits associated with the person's household units
  # @return[Array<DwellingUnit]
  def dwelling_units
    household_units.collect(&:dwelling_units).flatten
  end

  ##
  # Returns true if a dwelling_unit has a tsu_is and this person has an association to the
  # tsu dwelling unit through their household
  # @return [true,false]
  def in_tsu?
    dwelling_units.map(&:tsu_id).compact.size > 0
  end

  ##
  # Returns the primary cell phone number for this person, or nil if no such
  # phone record exists.
  def primary_cell_phone
    cell_code = Telephone.cell_phone_type.to_i

    primary_contacts(telephones, :phone_rank_code) do |ts|
      ts.detect { |t| t.phone_type_code == cell_code }
    end
  end

  ##
  # Returns the primary cell phone number for this person, or nil if no such
  # phone record exists.
  def primary_home_phone
    home_code = Telephone.home_phone_type.to_i

    primary_contacts(telephones, :phone_rank_code) do |ts|
      ts.detect { |t| t.phone_type_code == home_code }
    end
  end

  ##
  # Returns the primary address for this person, or nil if no such address
  # record exists.
  def primary_address
    primary_contacts(addresses, :address_rank_code, &:first)
  end

  ##
  # Returns the primary email for this person, or nil if no such email record
  # exists.
  def primary_email
    primary_contacts(emails, :email_rank_code, &:first)
  end

  ##
  # @private
  def primary_contacts(collection, code_key)
    yield collection.select { |c| c.send(code_key) == 1 }
  end

  private

    def dob
      return person_dob_date unless person_dob_date.blank?
      return Date.parse(person_dob) if person_dob.to_i > 0 && !person_dob.blank? && (person_dob !~ /^9/ && person_dob !~ /-9/)
      return nil
    end

end

class PersonResponse
  attr_accessor :response_class, :text, :short_text, :reference_identifier
  attr_accessor :datetime_value, :integer_value, :float_value, :text_value, :string_value
end 
```

联系链接

```
# -*- coding: utf-8 -*-
# == Schema Information
# Schema version: 20120607203203
#
# Table name: contact_links
#
#  id               :integer         not null, primary key
#  psu_code         :integer         not null
#  contact_link_id  :string(36)      not null
#  contact_id       :integer         not null
#  event_id         :integer
#  instrument_id    :integer
#  staff_id         :string(36)      not null
#  person_id        :integer
#  provider_id      :integer
#  transaction_type :string(255)
#  created_at       :datetime
#  updated_at       :datetime
#

# -*- coding: utf-8 -*-

# Each Contact Link record associates a unique combination
# of Staff Member, Person, Event, and/or Instrument that occurs during a Contact. 
# There should be at least 1 contact link record for every contact.
class ContactLink < ActiveRecord::Base
  include MdesRecord
  acts_as_mdes_record :public_id_field => :contact_link_id

  ncs_coded_attribute :psu, 'PSU_CL1'

  belongs_to :contact
  belongs_to :person
  belongs_to :event
  belongs_to :instrument, :inverse_of => :contact_link
  belongs_to :provider
  # belongs_to :staff       # references public_id of staff in ncs_staff_portal

  delegate :participant, :to => :event

  # Validating :contact_id instead of :contact prevents a reload of
  # the associated contact object when creating a contact link
  # alone. This provides a huge speedup in the importer; if validating
  # :contact is necessary, we should provide a scoped validation so it
  # can be 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:33:22.063

您可以为模型中的关联指定外键：

```
class ContactLink < ActiveRecord::Base
  belongs_to :person, :foreign_key => "id"
end 
```****

# linux - 编译 DotGnu

> ID：11254964
> 
> 赞同：1
> 
> 时间：2012-06-29T01:21:25.660
> 
> 标签：linux, compilation

我在编译 DotGNU 时遇到问题，嗯....当我编译 PNET 时，我收到以下 autoconfig 错误：

```
configure.ac: 25: error: m4_copy: will not overwrite defined macro: _AC_ARG_VAR_PRECIOUS 
```

正因为如此（我相信）我无法编译项目的其余部分，然后我想知道，我该如何解决这个问题？

感谢您的帮助（：

# .net - 用于简单数据库应用程序的 .NET 工具箱

> ID：11254968
> 
> 赞同：1
> 
> 时间：2012-06-29T01:22:08.603
> 
> 标签：.net, database, user-interface, crud

在过去的几年里，我有很多关于小型应用程序的想法，这些应用程序可以让我的生活更轻松。白天，我使用的大型企业 .NET 应用程序当然完全不同。我想将一小部分技术放在一起，这些技术可用于编写简单的数据库 CRUD 应用程序以及前端，并且想知道人们使用什么。例如...

*   数据库：SQLite、SQL CE、XML 文件；）
*   数据访问：Linq2SQL、Massive、Dapper
*   前端：WPF、Winforms
*   模式：存储库、IoC 等

有兴趣看看人们使用什么。

干杯，约翰

# api - Foursquare：在场地/照片上的照片，但不在场地/探索上？

> ID：11254972
> 
> 赞同：9
> 
> 时间：2012-06-29T01:22:47.107
> 
> 标签：api, foursquare, photos

如果您使用 Foursquare 的 API 场地/探索来获取某个区域的场地，您会在响应中获得照片的数量。例如，在 API 文档中按下“Try It”按钮时生成的默认查询：

[https://api.foursquare.com/v2/venues/explore?ll=40.7,-74](https://api.foursquare.com/v2/venues/explore?ll=40.7,-74)

给出类似的东西：

```
 <...>
    venue: {
        id: "4de1b34ec65b7a3e2109e46f",
        name: "Beekman Beer Garden",
    <...>
    photos: {
        count: 371,
        groups: [ ],
    } 
```

但没有场地的照片网址。

如果您尝试使用场地/照片来检索该场地的照片，您将获得完整的照片列表：

[https://api.foursquare.com/v2/venues/4de1b34ec65b7a3e2109e46f/photos?group=venue](https://api.foursquare.com/v2/venues/4de1b34ec65b7a3e2109e46f/photos?group=venue)

回复：

```
 <...>
    id: "4fecf72ae4b0f9f20ef5f4ae",
    <...>
    prefix: "https://irs0.4sqi.net/img/general/",
    suffix: "/Ch8l3fTBYzszVoOiDcWoklClo9wbWseLr2ZXBbde4es.jpg",
    <...>

    id: "4fecd642e4b0f3117eb4d2e3",
    <...>
    prefix: "https://irs1.4sqi.net/img/general/",
    suffix: "/kWzECY2VMssTWex1GNZITP-YlWzWDHZYsV5p2k4tsEk.jpg",
    <...> 
```

如您所见，场地有很多公开照片。

在极少数情况下，场所/探索 API 似乎包含照片的 url。这是为什么？有没有办法使用 /explore 而不是 /photos 为每个场地拍摄照片？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-24T22:24:40.743

有一种方法可以通过探索端点获取（单张）照片。您必须将值 1 的场地照片参数添加到您的呼叫中。示例：

```
https://api.foursquare.com/v2/venues/explore/?near=austin&venuePhotos=1&client_id=CLIENTID&client_secret=CLIENTSECRET&v=20131124 
```

照片作为场地 JSON 对象的一部分返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T21:29:50.787

没有单一的调用来检索一组搜索过的场地+照片。

/venues/search 仅返回照片计数。

/venues/explore 通常会返回一张照片（作为场地的一部分或作为与场地相关的提示的一部分）。

对于没有来自 /venues/explore 的相关照片的场所，您需要致电 /venues/VENUE_ID/photos 以获取照片信息。

# entity-framework - Entlib 自我验证和 EF Pocos

> ID：11254973
> 
> 赞同：2
> 
> 时间：2012-06-29T01:23:10.680
> 
> 标签：entity-framework, ef-code-first, enterprise-library

我使用 Enterprise Library 验证块已经有一段时间了，并且取得了巨大的成功。但是，我在尝试将 SelfValidation 与 Entity Framework Code First 结合使用时遇到了障碍。这是一些示例代码：

**实体**

```
namespace Data.Model
{
    using System.ComponentModel.DataAnnotations;
    using MetaData;
    using Microsoft.Practices.EnterpriseLibrary.Validation;
    using Microsoft.Practices.EnterpriseLibrary.Validation.Validators;

    [HasSelfValidation]
    [MetadataType(typeof(PersonMetaData))]
    public class Person
    {
        public int Id { get; set; }

        public string Forename { get; set; }

        public string Surname { get; set; }

        [SelfValidation]
        public void Validate(ValidationResults validationResults)
        {
            if (validationResults != null)
            {
                validationResults.AddAllResults(
                    ValidationFactory
                        .CreateValidator<PersonMetaData>()
                        .Validate(this));
            }
        }
    }
} 
```

**验证注释**（不，我不想讨论最佳实践伙伴课程；）

```
namespace Data.MetaData
{
    using System.ComponentModel.DataAnnotations;
    using Microsoft.Practices.EnterpriseLibrary.Validation.Validators;

    public class PersonMetaData
    {
        [Required(ErrorMessage = "Forename is required.")]
        public string Forename { get; set; }

        [Required(ErrorMessage = "Surname is required.")]
        public string Surname { get; set; }
    }
} 
```

除了调用验证之外，所有简单的东西，SelfValidation 方法 Validate 都不会触发 - 检查注释，但我可能想要放置在 SelfVALidation 方法中的任何自定义验证都将被绕过。

是什么赋予了？首先在模型/数据库中完美运行。

理查德

# view - 无法获取视图参数以在 couchdb 中工作

> ID：11254974
> 
> 赞同：2
> 
> 时间：2012-06-29T01:23:13.893
> 
> 标签：view, parameters, couchdb

我需要学习 couchbd 并且一直在阅读有关视图的教程。我从概念上理解它们，但实际上我在查询视图时无法有效地提供视图参数。我正在尽我所能遵循示例中的语法。所以我有以下简单的设计文档：

```
{"_id":"_design/simple","_rev":"1-0391fe242d8b6045da1984283287f91c","views":{"foo":{"map":"function(doc) { if(doc.date && doc.title) {emit(doc.date, doc.title);}}"}}} 
```

我可以在没有任何视图参数的情况下查询视图 foo 并得到以下结果：

```
curl http://127.0.0.1:5984/viewtester/_design/simple/_view/foo 
```

生产

```
{"total_rows":3,"offset":0,"rows":[
{"id":"hello-world","key":"2009/01/15 15:52:20","value":"Hello World"},
{"id":"biking","key":"2009/01/30 18:04:11","value":"Biking"},
{"id":"bought-a-cat","key":"2009/02/17 21:13:39","value":"Bought a Cat"}
]} 
```

但是添加视图参数似乎不起作用：

```
curl http://127.0.0.1:5984/viewtester/_design/simple/_view/foo?key="2009/01/15 15:52:20" 
```

不产生任何输出，只是将我发送到下一个命令提示符。我用不同类型的键尝试了各种示例，并遇到了同样的问题。

任何洞察我做错了什么都将不胜感激。

谢谢，诺威尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:58:11.757

Cheeso 是对的，你必须对你的值进行 URL 编码，不仅仅是`"`s，还有其他字符。事实上，替换`curl`为`echo`查看你的 shell 在完成处理后真正传递给 curl 的内容。

FWIW，我认为我们大多数人都在浏览器中点击了我们的阅读查询，比如点击视图——所以所有的 url 编码都为我们处理好了。

# mysql - 涉及 DECLARE 和临时变量的 SQL 查询

> ID：11254975
> 
> 赞同：1
> 
> 时间：2012-06-29T01:23:14.343
> 
> 标签：mysql

我对 SQL 很陌生，但试图编写一个相当复杂的查询，但它在第一部分失败了。我需要为自动递增 ID 的表创建一个新行，并立即提取 ID 以进一步使用查询。已经搜索了几个小时试图理解这一点，但似乎无法让它发挥作用。这是开场白（它似乎失败了）：

```
DECLARE @point1ID;
INSERT INTO points SET
pointName = "$pointName1",
street = "$street1",
town = "$town1",
city = "$city1",
zip = "XXX",
country = "$country1",
pointDescription = "$pointDescription1";
SELECT @point1ID = scope_identity(); 
```

我希望这会将刚刚插入的行的 ID 放入变量 @point1ID 中，以便稍后在同一个 TRANSACTION / COMMIT 块中使用它。我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:34:26.970

鉴于您在 PHP 中使用查询，请执行 INSERT，然后使用

```
$insert_id = mysql_insert_id(); 
```

获取自动递增的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:58:28.323

在 MySQL 控制台中，您可以使用以下命令访问最后插入的 AUTO_INCREMENT ID：

```
SELECT LAST_INSERT_ID(); 
```

如果您想将此信息存储在变量中以供将来使用：

```
SET @lastid = LAST_INSERT_ID(); 
```

正如我已经说过的，这仅适用于具有 AUTO_INCREMENT 列的表。此值也在服务器端维护，并且仅用于此连接。如果将 AUTO_INCREMENT 列设置为特定的非特殊值，则不会更新此值。

# google-apps-script - 解决下拉列表的 importRange 问题的脚本解决方法

> ID：11254977
> 
> 赞同：1
> 
> 时间：2012-06-29T01:23:35.757
> 
> 标签：google-apps-script, google-sheets, google-sheets-formula, importrange

我正在分享这个，希望我能解决我面临的这个问题。我正在使用数据验证来获取下拉菜单的值。这些值来自我称为“计算”的工作表中的 Range(“A1:A40”)</p>

由于我有大约 50 个使用相同下拉值和相同模式的电子表格，我只是决定使用 importRange 函数来填充 Sheet(“Calculation”).Range(“A1:A50”) 中的信息。importRange 从我专门用于此目的的单独电子表格中获取列表。

这样做的目的仅仅是因为这是我想要更新和更改的类别列表，并且我希望下拉菜单考虑这些更改，而不必手动更改 50 多个电子表格中的值。

现在理论上这不会有任何问题，但是 importRange 函数是如此的喜怒无常，它会显示随机电子表格发生的 #REF 错误。我看到帖子抱怨同样的问题，所以我放弃了 importRange 将是一个可行的解决方案的希望。

我希望您能提出一个好的解决方法来避免此类问题。

我想到的一种解决方案是让一个脚本将值从一张表复制到所有这些表，并让这个脚本每天工作，但我不知道如何将整个范围从一个电子表格复制到另一个，坦率地说，我不确定这是否解决方案是最好的。

我使用跨电子表格脚本的经验是，从 50 多张表格中的几个单元格获取数据的脚本可能需要 5 分钟以上，并且最终会因超过允许的时间而停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T22:10:16.000

尝试添加会导致刷新功能运行的菜单项。我发现这个功能会导致`importRange`工作。

```
function onOpen() {
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var menuEntries = [];
    menuEntries.push({name: "Refresh", functionName: "SheetFlush"});
    ss.addMenu("Menu", menuEntries);
}

function SheetFlush(worksheet) {
    worksheet = worksheet || SpreadsheetApp.getActive();
    var sheets = worksheet.getSheets();
    SpreadsheetApp.flush();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T17:06:08.700

我们也遇到了导入功能的可靠性问题。在我们的例子中，我们需要自动更新信息，但对于我们的应用程序来说，每天一次就可以了。

我们的解决方案是一个脚本，每晚复制和粘贴一次值。我们还包括一个菜单项，用户可以在其中强制按需更新。

我们没有 50 张纸要维护，所以编写脚本很简单。根据您的情况，您可以将 id 保存在一个地方并让脚本循环遍历每个电子表格，或者您可以让每个电子表格运行自己的脚本。

*注意 - 我们正在根据私人表格上的信息汇总公开报告。该报告正在使用嵌入图表的网站上显示。图表通常会显示错误，通过返回公共表并让导入功能刷新来解决此错误。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T05:19:08.827

您的 50 个电子表格中有多少个出现此错误？此外，用户是否有权访问原始电子表格以便它可以运行 importRange() ？

脚本可能不适合您的情况，最好继续使用 importRange 并使其正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-30T19:35:37.170

## Force recalculation of importrange by reinstating the cell formula

***Required:***

Imported Data - Your target where everything will be copied to.

Imported Data Config - Has the following fields:

```
+---------------------------------------------+--------------------------------+
|                      A                      |               B                |
+---------------------------------------------+--------------------------------+
| Import Data from Spreadsheet with the key:  | key                            |
| Import Data from Spreadsheet between range: | A:AA                           |
| Imported Data select columns:               | SELECT *                       |
| Imported Data criteria:                     | WHERE Col15 contains 'Offered' |
| Imported Data should by ordered by column:  | ORDER BY Col1                  |
+---------------------------------------------+--------------------------------+

```

***Script:***

```
function onOpen() {
try {
var ss = SpreadsheetApp.getActiveSpreadsheet();
}
catch(err)
{
Browser.msgBox(err);
}

var configsheet = ss.getSheetByName("Imported Data Config");

var configkey = configsheet.getRange("B1").getValue();
var configrange = configsheet.getRange("B2").getValue();
var configselect = configsheet.getRange("B3").getValue();
var configwhere = configsheet.getRange("B4").getValue();
var configorderby = configsheet.getRange("B5").getValue();

var importedsheet = ss.getSheetByName("Imported Data");
importedsheet.getRange("A1").setValue('=QUERY(IMPORTRANGE("' + configkey + '","' + configrange + '"),"' + configselect + ' ' + configwhere + ' ' + configorderby + '")');

SpreadsheetApp.flush();

// Solution of sourcecode is: http://stackoverflow.com/questions/13631584/how-can-i-force-a-recalculation-of-cell-using-importrange-function-in-a-google-s
// OnOpen Trigger: https://developers.google.com/apps-script/understanding_triggers
// Active Spreadsheet solution: https://productforums.google.com/forum/#!topic/docs/XIY0WNX0uL8

Browser.msgBox("Sync Complete!");
} 
```

This allows you to change your formula without editing the script, and make it easier to transfer the script across various sheets.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T04:58:53.317

您能否指定如何尝试访问您的电子表格？我不认为有*气质函数*这样的东西......它通常是没有充分定义的东西，会导致随机错误。

# jquery - 在 WordPress 中使用 ColorBox onComplete

> ID：11254983
> 
> 赞同：1
> 
> 时间：2012-06-29T01:23:51.183
> 
> 标签：jquery, wordpress, colorbox

我确定我缺少一些基本的东西，但是我编写了很少的 jQuery 代码并且无法弄清楚。我正在为我的 WordPress 网站使用 ColorBox 插件，并希望在显示图像后运行一些代码。我已将以下代码添加到我的 header.php 文件中，但从未调用过警报：

```
<script type="text/javascript">
    jQuery('.screenshot-image a').colorbox({
        onComplete:function(){
            alert('test');
        });
    });
</script> 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T16:03:44.370

下次您应该检查您的 javascript 控制台是否有错误。您不能在这样的对象值之后放置分号，并且您已经包含了一个额外的 ')'。尝试以下操作：

```
jQuery('.screenshot-image a').colorbox({
    onComplete:function(){
        alert('test');
    }
}); 
```

此外，请务必等到 DOM 加载完成后再执行任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T01:34:08.047

你可以尝试`promise()`和`done()`方法

```
$('.screenshot-image a').colorbox().promise().done(function(){
   alert('test')
}) 
```

# android - 使用线程每隔间隔使用一个方法

> ID：11254989
> 
> 赞同：0
> 
> 时间：2012-06-29T01:25:56.827
> 
> 标签：android, loops, webpage, alarm

我正在制作一个应用程序，它每隔一段时间从网站读取数据并将值发布到屏幕上。我很难让它开始和停止它。

我可以让循环开始没有问题，我也可以停止它。但是如果我尝试重新启动它，程序就会崩溃。

代码在这里：

```
 final Timer myTimer = new Timer(); 

    loop.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            MyTimerTask mytimertask = new MyTimerTask();
            myTimer.scheduleAtFixedRate(mytimertask, 0, 5000);
        }
    });

    stoploop.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            textView.setText("STOPPED");
            myTimer.cancel();

        }
    });

}

private class MyTimerTask extends TimerTask {
    @Override
    public void run() {
        // TODO Auto-generated method stub
        runOnUiThread(new Runnable(){

            public void run() {
                // TODO Auto-generated method stub
                //textView.setText("changed");
                readWebpage(text);
            }

        });

    }

} 
```

我对线程很陌生，这就是为什么我可能在这里遗漏了一些基本的东西。任何帮助将不胜感激。

谢谢

[编辑]我应该补充一下，我从这里的一个解决方案中改编了这个： [如何在按下按钮后每 10 分钟重复一次方法并在另一个按钮按下时结束它](https://stackoverflow.com/questions/10221996/how-do-i-repeat-a-method-every-10-minutes-after-a-button-press-and-end-it-on-ano)

```
 06-29 01:38:02.958: D/AndroidRuntime(1119): Shutting down VM
   06-29 01:38:02.958: W/dalvikvm(1119): threadid=1: thread exiting with uncaught exception    (group=0x40a13300)
   06-29 01:38:02.968: E/AndroidRuntime(1119): FATAL EXCEPTION: main
   06-29 01:38:02.968: E/AndroidRuntime(1119): java.lang.IllegalStateException: Timer was canceled
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at    java.util.Timer.scheduleImpl(Timer.java:561)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at    java.util.Timer.scheduleAtFixedRate(Timer.java:528)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at com.example.beam.MainActivity$1.onClick(MainActivity.java:67)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.view.View.performClick(View.java:4084)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.view.View$PerformClick.run(View.java:16966)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.os.Handler.handleCallback(Handler.java:615)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.os.Handler.dispatchMessage(Handler.java:92)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.os.Looper.loop(Looper.java:137)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at android.app.ActivityThread.main(ActivityThread.java:4745)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at java.lang.reflect.Method.invokeNative(Native Method)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at java.lang.reflect.Method.invoke(Method.java:511)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
   06-29 01:38:02.968: E/AndroidRuntime(1119):  at dalvik.system.NativeStart.main(Native Method)
   06-29 01:38:03.028: W/ActivityManager(156):   Force finishing activity com.example.beam/.MainActivity
   06-29 01:38:03.039: W/WindowManager(156): Failure taking screenshot for (246x410) to layer 21010
   06-29 01:38:03.552: W/ActivityManager(156): Activity pause timeout for ActivityRecord{41366318 com.example.beam/.MainActivity} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T02:10:34.503

仅供参考 - 您可能需要考虑 AlarmManager。即使您的应用程序未处于活动状态，它也允许您控制时间间隔。（我假设您正在创建小部件）。它允许您控制 WAKE 选项，这样您的应用程序就不会耗尽电池电量。

[http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:55:00.970

```
private class MyTimerTask extends TimerTask {
    @Override
    public void run() {

                mDialogHandler.sendEmptyMessage(DIALOG_OK);

    }

}

 private Handler mDialogHandler = new Handler(){
            public void handleMessage(android.os.Message msg) {
                    switch (msg.what) {
                    case DIALOG_OK:
                            // We are now back in the UI thread
                            //textView.setText("changed");
                            readWebpage(text);
                    }

            };
    }; 
```

你试图从一个非法的线程内部启动一个线程。我还为您的 UI 线程问题添加了一些代码。

# c - C：thread_mutex 同步

> ID：11254991
> 
> 赞同：0
> 
> 时间：2012-06-29T01:26:10.387
> 
> 标签：c, pthreads, thread-synchronization

我遇到了多线程同步的问题，我将只发布一个我正在做的“尝试”同步的示例，因为原始代码更大。基本上我有一个附加了 3 个线程的繁重进程，为了锁定/解锁线程，我使用修改每个线程中互斥状态的函数。像这样的东西：

```
## thread.c ##
    #include "thread.h"

extern int socks;

pthread_mutex_t sem = PTHREAD_MUTEX_INITIALIZER;

void lock()
{
    pthread_mutex_lock(&sem);
}

void unlock()
{
    pthread_mutex_unlock(&sem);
}

void* thread(void* arg)
{
    printf("Socks: %d\n",socks);
    lock();
    lock();

    printf("Unlocked\n");
    return;
}

## main.c ##
#include "defines.h"
#include "thread.h"

int socks;

int main()
{
    pthread_t tid;
    socks= 9;

    pthread_create(&tid, NULL, thread, NULL);

    //sleep(2);
    unlock();
    pthread_join(tid,NULL);
} 
```

执行代码后我得到的是：

> 。/测试
> 
> 袜子：9

显然我有一些概念错误，但我找不到问题。线程不应该用 unlock() 解锁？为什么我在解锁调用之前使用 sleep(2) 时程序可以工作？我应该使用哪种方式来避免问题？每个代码都在单独的文件中。

提前致谢！PS：对不起我蹩脚的英语！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T01:38:57.003

Since the thread runs asynchronously, it might happen that the main thread joins before the thread has hit the lock. In this case I would suspect that the unlock() just happens too early, and the behaviour you get isn't well defined. If you let the main thread sleep for a while before you unlock, the other thread seems to have time to hit the lock and can be unlocked, resulting in the behaviour you seem to expect.

# qt - 如何限制动画小部件对其布局几何的可见性？

> ID：11254992
> 
> 赞同：0
> 
> 时间：2012-06-29T01:26:13.440
> 
> 标签：qt, pyqt, pyqt4, pyside

我有一个自定义小部件，它采用其他小部件并以滑动方式为它们设置动画。它的目的是像 QStackedWidget 一样工作，但请求的小部件从顶部下拉，并将以前可见的小部件“推”出视线。这或多或少有效，但我看到了奇怪的行为（例如包含的小部件的偏移以及取决于添加的小部件的行为差异），这让我在我的主代码中感到悲伤。

喝了几杯咖啡后，我意识到这个“PageAnimator”实际上应该是一个布局管理器而不是一个小部件，因为它只负责放置（和动画）其他小部件。

下面是我的（仍然有点狡猾的）PageAnimator 小部件的代码，我想把它变成一个合适的布局管理器，因为这对我来说似乎更合乎逻辑。

小部件下方是迄今为止我设法提出的新布局管理器代码。这实际上似乎工作正常，除了小部件是在布局的几何图形之外绘制的，我想确保它们只在其中可见。换句话说，布局的几何图形需要成为小部件的“视口”。

有谁知道如何做到这一点？

干杯，坦率

```
import sys
from PySide.QtGui import *
from PySide.QtCore import *

class PageAnimator( QWidget ):
    '''A widget that takes other widgets and animates them with a sliding motion'''
    def __init__( self, parent=None ):
        super( PageAnimator, self ).__init__( parent )
        self.pages = []
        self.visibleWidget = None
        self.end = 0

    def sizeHint( self ):
        return QSize( 400, 400 )

    def minimumSizeHint( self ):
        return QSize( 400, 400 )

    def addPage( self, widget, startPage=False ):
        '''Add this widget to the animator. If startPage is notTrue hide the widget'''
        widget.setParent( self )

        if not startPage:
            # POSITION TOOL PAGES OFF SCREEN
            widget.setGeometry(0,
                               -widget.sizeHint().height(), 
                               widget.sizeHint().width(),
                               widget.sizeHint().height())
            self.pages.append( widget )
            widget.hide()
        else:
            widget.move( (self.sizeHint().width()-widget.sizeHint().width())/2, (self.sizeHint().height()-widget.sizeHint().height())/2 )            
            self.visibleWidget = widget

    def resizeEvent( self, event ):
        '''keep visible widget centred when resizing parent'''
        widget = self.visibleWidget
        widget.move( (event.size().width()-widget.sizeHint().width())/2, (event.size().height()-widget.sizeHint().height())/5 )

    def change( self, newWidget ):
        '''Slide in the new widget and slide out the old one'''

        if newWidget == self.visibleWidget:
            return
        # Slide in
        newSize = QSize( newWidget.sizeHint().width(), self.height() )
        self.resize( newSize ) # SET VIEWPORT
        newWidget.show()

        self.animGroup = QParallelAnimationGroup()       
        slideInAnimation = self.getMoveAnimation( newWidget, -newWidget.sizeHint().height(), 0 )
        self.animGroup.addAnimation( slideInAnimation )

        # Slide out
        oldWidget = self.visibleWidget
        if oldWidget:
            #slideOutAnimation = self.getMoveAnimation( oldWidget, 0, newWidget.sizeHint().height() )
            slideOutAnimation = self.getMoveAnimation( oldWidget, oldWidget.pos().y(), newWidget.sizeHint().height() )
            self.animGroup.addAnimation( slideOutAnimation )
            slideOutAnimation.finished.connect( oldWidget.hide )

        self.animGroup.start()
        self.visibleWidget = newWidget

    def getMoveAnimation(self, widget, start, end):
        '''
        Horizontal animation, moves the widget 
        from "start" y-position to "end" y-position.
        '''
        moveAnimation = QPropertyAnimation(widget, 'pos')
        moveAnimation.setDuration( 700 )
        frameWidth = self.style().pixelMetric( QStyle.PM_DefaultFrameWidth )
        xpos = widget.pos().x()+5 # NEED TO NOT HARDCODE THE OFFSET HERE BUT CREATE IT DYNAMICALLY
        moveAnimation.setStartValue( QPoint( xpos, start ) )
        moveAnimation.setEndValue( QPoint( xpos, end ) )
        moveAnimation.setEasingCurve( QEasingCurve.OutCubic )
        return moveAnimation 
```

这是我模仿 QStackedLayout 的第一段代码，我想将其转换为动画版本以替换上面的小部件代码。它有动画位，但小部件由于某种原因没有移动。

```
class AnimStackLayout( QLayout ):
    '''Like QStackLayout but with sliding animation'''

    def __init__( self, parent=None, duration=700 ):
        super( AnimStackLayout, self).__init__( parent )
        self.duration = duration
        self.itemList = []
        self.__currentIndex = 0

    def addItem( self, item ):
        '''add item to layout'''
        if self.count() > 0:
            item.widget().hide()
        self.itemList.append( item )

    def count( self ):
        '''return the amount of items currently held by the layout'''
        return len( self.itemList )

    def currentIndex( self ):
        '''return the current item index'''
        return self.__currentIndex

    def currentWidget( self ):
        '''return the current widget'''
        return self.itemList[ self.__currentIndex ].widget()

    def doLayout( self, rect ):
        '''do the layout work'''
        print 'doing layout work'
        x = rect.x()
        y = rect.y()
        width = rect.width()
        height = rect.height()
        for item in self.itemList:
            itemRect = QRect( x, y, width, height )
            item.setGeometry( itemRect )
            widget = item.widget()
            #widget.setVisible( widget is self.currentWidget() )

    def getMoveAnimation( self, widget, direction ):
        '''Animation, moves the widget from "start" position to "end" position.'''
        assert direction in ( 'enter', 'leave' )
        if direction == 'enter':
            start = self.geometry().y() - self.geometry().height()
            end = self.geometry().y()

        elif direction == 'leave':
            start = self.geometry().y()
            end = self.geometry().y() + self.geometry().height()

        moveAnimation = QPropertyAnimation( widget, 'pos' )
        moveAnimation.setDuration( self.duration )
        xpos = self.geometry().x()

        moveAnimation.setStartValue( QPoint( xpos, start ) )
        moveAnimation.setEndValue( QPoint( xpos, end ) )
        moveAnimation.setEasingCurve( QEasingCurve.OutCubic )
        return moveAnimation

    def itemAt( self, index ):
        '''return the item for the given index'''
        if -1 < index < self.count():
            return self.itemList[index]

    def minimumSize( self ):
        return QSize(115,18)

    def takeAt( self, index ):
        '''remove the item at the given index'''
        if -1 < index < self.count():
            return self.itemList.pop(index)
        return None

    def setCurrentIndex( self, index ):
        '''
        Set the current index to index.
        Slides the requested item's widget into view and pushes the previous one out of sight
        '''
        oldWidget = self.currentWidget()
        newWidget = self.itemList[index].widget()
        self.__currentIndex = index
        if oldWidget is newWidget:
            return

        self.animGroup = QParallelAnimationGroup()
        slideInAnimation = self.getMoveAnimation( newWidget, direction='enter'  )
        slideOutAnimation = self.getMoveAnimation( oldWidget, direction='leave' )

        slideOutAnimation.finished.connect( oldWidget.hide )
        self.animGroup.addAnimation( slideInAnimation )
        self.animGroup.addAnimation( slideOutAnimation )

        newWidget.show()
        self.animGroup.start()

    def setCurrentWidget( self, widget ):
        '''set the current widget to widget'''
        assert widget in [ item.widget() for item in self.itemList ]
        self.setCurrentIndex( self.itemList.index(widget) )

    def setGeometry( self, rect ):
        super( AnimStackLayout, self ).setGeometry( rect )
        self.doLayout( rect )

    def sizeHint( self ):
        return self.minimumSize()

if __name__ == '__main__':
    from copy import copy
    app = QApplication( sys.argv )
    # WIDGETS
    mainWidget = QWidget()
    btn1 = QPushButton( 'page A' )
    btn2 = QPushButton( 'page B' )
    frame1 = QLabel( 'A (custom layout)' )
    frame1.setFrameStyle( QFrame.Box )
    frame2 = QLabel( 'B (custom layout)' )
    frame2.setFrameStyle( QFrame.Box )
    frame3 = QLabel( 'A (default layout)' )
    frame3.setFrameStyle( QFrame.Box )
    frame4 = QLabel( 'B (default layout)' )
    frame4.setFrameStyle( QFrame.Box )

    # LAYOUTS
    mainLayout = QVBoxLayout()
    stackLayout = AnimStackLayout( duration=1000 ) # MAKE THIS WORK LIKE QStackedLayout
    stackLayoutDef = QStackedLayout() # FOR COMPARISON
    mainWidget.setLayout( mainLayout )

    # PLACE WIDGETS
    stackLayout.addWidget( frame1 )
    stackLayout.addWidget( frame2 )
    stackLayoutDef.addWidget( frame3 )
    stackLayoutDef.addWidget( frame4 )

    mainLayout.addWidget( btn1 )
    mainLayout.addWidget( btn2 )
    mainLayout.addLayout( stackLayoutDef )
    mainLayout.addLayout( stackLayout )

    # CONNECT
    def changeToPage( index ):
        stackLayout.setCurrentIndex( index )
        stackLayoutDef.setCurrentIndex( index )
    btn1.clicked.connect( lambda: changeToPage(0) )
    btn2.clicked.connect( lambda: changeToPage(1) )

    # GO
    mainWidget.show()
    sys.exit( app.exec_() ) 
```

# ios - IOS 应用程序在 didFinishWithLaunchingWithOptions 后冻结

> ID：11254996
> 
> 赞同：-1
> 
> 时间：2012-06-29T01:27:19.937
> 
> 标签：ios, xcode

我正在制作一个IOS应用程序，从didFinishWIthLaunchingWithOptions返回后应用程序冻结。

```
-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

{

self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
// Override point for customization after application launch.

self.viewController = [[FooPlatformViewController alloc] init];

self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible];

 //Set to interactive mode
[self.viewController.motionController setInteractiveMode:TRUE];
[self.viewController.motionController recoverSML];
[self.viewController.motionController startRecording];

return YES; 
```

}

检查那里的所有变量让我相信一切都很好。我在输出中看不到任何错误或消息。但是，在函数返回后，应用程序会冻结。

我注意到这次冻结有几件奇怪的事情。首先，当我在冻结期间暂停执行时，应用程序有一个调用堆栈，如下所示：

mach_msg_trap

mach_msg

ETC

ETC

主要的

我的代码都不在那里，一直回到我的单行主代码。

接下来，这种冻结只发生在为 iphone 运行模拟器时。ipad模拟器工作正常，将应用程序放在手机上并运行它

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T05:43:22.380

您的代码对我来说看起来不错，也许问题出在此处

```
//Set to interactive mode
[self.viewController.motionController setInteractiveMode:TRUE];
[self.viewController.motionController recoverSML];
[self.viewController.motionController startRecording]; 
```

我认为 xcode 中的默认模拟器不支持加速度计、麦克风和摄像头。可能访问其中任何一个都可能导致冻结。我记得在模拟器上访问相机时崩溃了。

虽然很奇怪你没有在 iPad 模拟器上崩溃。这只是我的一个疯狂的猜测。