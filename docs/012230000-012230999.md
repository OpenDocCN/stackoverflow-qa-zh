# StackOverflow 问答 12230000-12230999

# java - 多个通配符边界

> ID：12230002
> 
> 赞同：8
> 
> 时间：2012-09-01T17:49:34.630
> 
> 标签：java, generics, bounded-wildcard

假设我有以下课程：

```
public class Either<A, B> {
    public Object get();
} 
```

`Either`是一种存储类型 A 或 B 的一个对象的类型。 `get()`检索该对象。

问题是是否可以使用泛型来改变 的方法签名，`get()`以便返回的类型不仅仅是`Object`，而是 A 和 B 的任何常见超类型。例如，an`Either<Integer, Long>`可以有`get()`return `Number`，an`Either<Deque<T>, Set<T>>`可以有`get()`return`Iterable<T>`或`Collection<T>`，等等。（显然， an`Either<Foo,Foo>`应该有`get()`return `Foo`）。

如果这是可能的，如果我有，可以返回`Either<List<A>, List<B>>`的最具体的类型是什么？`get()`它是 raw `List`， wildcard`List<?>`还是完全其他的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:28:51.497

Java推理确实有类似的东西，我们可以做

```
public static <C, A extends C, B extends C> C get(Either<A,B> e)
{   return (C)e.get();    }

inference:

    A=Integer, B=Long    ==>    C=Number

    A=List<Integer>, B=List<Long>      ==>   C=List<? extends Number>

usage:

    Either<Integer, Long> x = ...;
    get(x); // the return type is Number 
```

但是，可能没有办法将其转换为实例方法。我们需要写

```
public class Either<A,B>

    public <C super A|B> C get() { ... }

or simply

    public A|B get(){ ... } 
```

Java不支持

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:46:04.080

您需要确保 A 和 B 具有共同的祖先。

```
public class Either<A extends CommonAncestor, B extends CommonAncestor> {
    public CommonAncestor get() {....}
} 
```

或者

```
public class Either<C, A extends C, B extends C> {
    public C get() {....}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:44:26.247

据我所知，这是不可能的：您的`Either<A,B>`类对通用的第三种类型（让我们称之为`C`）做出假设，A 和 B 都会扩展它：虽然可以编写类似的东西`public class Either<A extends MyNonFinalClass, B extends MyNonFinalClass> {}`，但 Java 不允许转发- 引用泛型类型，因此您甚至不能编写类似`Either<A extends C, B extends C, C>`. 显然很遗憾，因为你的`Either`课真的很方便:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T18:20:34.413

为什么不定义一个抽象类 C，其中包含您认为必要的 A 和 B 共有的逻辑，并在您的 Either 类中引用它：

```
public class Either<C> {
    public C get();
} 
```

这似乎不是一个很好的答案，但是由于 Java 在编译时无论如何都会删除您的类型信息（也就是说，您的编译代码只能看到`Object`而不是 an`A`或 a `B`），那么您最适合定义应该保留在显式公共类中。

# javascript - 基本对象/原型语法问题

> ID：12230004
> 
> 赞同：1
> 
> 时间：2012-09-01T17:50:17.967
> 
> 标签：javascript

有人可以清除我的代码做错了什么吗？我是一个完全的新手，只是尝试尝试如何创建对象、原型以及 this 命令在原型上下文中所指的内容。但是，我的代码都没有在 jFiddle 上运行。我知道这段代码完全没有意义，但我只是想找出文档在各种情况下打印的内容，以更具体地了解对象、原型、构造函数和“this”关键字的工作原理。但是什么都没有出现！

```
function Person(identity) {
    this.identity = "fellow";
    this.logYou = function() {
        document.write('hi');
    };
};
Person.prototype.logMe = function() {
    document.write(this.identity);
};

var Dude = new Person("stud");

Person.logYou();  
Person.logMe();
Dude.logMe(); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:09:32.820

```
function Person() {
  this.identity = "fellow";
  this.logYou = function() {
    document.write('hi');
  };
}; 
```

当您调用关键字时，它指的`this.identity = "fellow";`是函数运行的**上下文。** 所以如果你在全局范围内调用函数，指的是对象：`this` **`this``window`**

 **```
Person();
alert(window.identity); // fellow 
```

如果你实例化函数，`this`关键字指的是新对象：

```
var Dude = new Person();
alert(Dude.identity); // fellow 
```

所以函数`Person`没有属性`identity`。
如果您想为您的功能提供一些属性：

```
Person.identity = "fellow";
alert(Person.identity); //  fellow 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T17:53:49.093

`logYou`并且`logMe`是存储在原型上的方法，`Person`以便继承对象可以调用该函数。你不能调用`logYou`，`Person`但你*可以*做的是调用它的孩子，`Dude`：

```
Dude.logYou(); // hi
Dude.logMe(); // fellow 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T17:54:12.103

这两行

```
Person.logYou();   
Person.logMe(); 
```

抛出错误并导致代码停止执行，因为`logYou`并且`logMe`不作为`Person`.

`Dude.logMe()`并且`Dude.logYou()`将分别工作、打印`fellow`和`hi`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T17:54:20.123

你不能打电话

```
Person.logYou();  
Person.logMe(); 
```

由于 Person 没有方法，`logYou`或者`logMe`，当您删除这两行时，您的代码将开始工作**

# linq - “..无法从用法中推断出来。” 如何在这个 sqlite 查询中插入 where 和 orderby 表达式？

> ID：12230006
> 
> 赞同：1
> 
> 时间：2012-09-01T17:50:32.560
> 
> 标签：linq, sqlite, mono, xamarin.android

我一直在关注MonoDroid 网站上的[Tasky 案例研究](http://docs.xamarin.com/android/tutorials/cross_platform/Case_Studies/Case_Study%3a_Tasky)，但在创建过滤和排序查询时遇到了困难。我想知道是否有人可以解释我可能会出错的地方吗？我可能正在做一些完全倒退的事情！

我得到错误：

> 无法从用法中推断出方法“ICanTalk.BusinessLayer.Services.WordServices.Find(System.Func, System.Func, bool, int, int)”的类型参数。尝试明确指定类型参数。

我的一个存储库中有以下代码，希望我想要做的事情很清楚。我还没有能够构建它来测试它是否有效：

```
 public static IEnumerable<Word> Find<T,U>(Func<Word, bool> whereClause, Func<Word,U> orderBy, bool ascending, int show, int page)
  {
      int currentPage = page;
      int resultsPerPage = show;
      int skip = currentPage*show;

      var result = ascending
                       ? me.db.Find<Word>().Where(whereClause).OrderBy(orderBy).Take(resultsPerPage).Skip(skip)
                       : me.db.Find<Word>().Where(whereClause).OrderByDescending(orderBy).Take(resultsPerPage).Skip(skip);

      return result;

  } 
```

从我的服务中，我从这里调用此方法：

```
 public static IList<Word> Find<T>(Func<Word, bool> whereClause, Func<Word,DateTime> orderBy, bool ascending, int show, int page)
  {
      return WordRepository.Find<Word, DateTime>(whereClause, orderBy, ascending, show, page).ToList();
  } 
```

我想要实现的是来自 MonoDroid 中的事件处理程序的调用，例如：

```
 var wordTest = WordServices.Find(x => x.ChildId == 3, x => x.AddedAt, true, 5, 1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:51:26.920

我*几乎*做对了，我将其简化为基础知识，然后按照自己的方式重新设计并提出了以下内容（如果您有兴趣，请与原始内容进行比较）。

**SQLiteDatabase.cs**

（不在原始帖子中 - 我将查询子句缩小为通用处理程序中的可重用方法）：

```
 public IEnumerable<T> Find<T>(Func<T, bool> whereClause, int resultsToSkip, int resultsToShow)
          where T : BusinessLayer.Contracts.IBusinessEntity, new()
    {
        lock (locker)
        {
            return Table<T>().Where(whereClause).Skip(resultsToSkip).Take(resultsToShow).ToList();
        }
    } 
```

**WordRepository.cs**

```
 public static IEnumerable<Word> Find<T>(Func<Word, bool> whereClause, int resultsToSkip, int resultsToShow)
        where T : BusinessLayer.Contracts.IBusinessEntity, new()
    {
        var result = me.db.Find<Word>(whereClause, resultsToSkip, resultsToShow);

        return result;
    } 
```

**WordServices.cs**

至此，我想知道为什么需要这么多层——definitley 会在早上进行重构。

```
 public static IList<Word> Find<T, U>(Func<Word, bool> whereClause, Func<Word, U> orderBy, bool ascending,  int show, int page)
    {
        int resultsToShow = show;
        int resultsToSkip = show * (page - 1);

        var result = ascending ? WordRepository.Find<Word>(whereClause, resultsToSkip, resultsToShow).OrderBy(orderBy)
                               : WordRepository.Find<Word>(whereClause, resultsToSkip, resultsToShow).OrderByDescending(orderBy);

        return result.ToList();
    } 
```

**始发呼叫**

```
 var wordTest1 = WordServices.Find<Word, DateTime>(x => x.ChildId == 1, x => x.AddedAt, true, 5, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:03:09.853

您的两种方法都是通用的`Find<T,U>`，并且`Find<T>`- 但您似乎没有`T`在方法定义中的任何地方使用该类型。`T`预计是类型`Word`？
`U`在您使用的其他地方按顺序使用一次`bool`- 这些用法中的哪一个是错误的？

您可以尝试在定义中替换`Word`with和with （如果这是您的意思），然后在调用该方法时实际使用正确的类型调用它吗？`T``bool``U`

```
var wordTest = WordServices.Find<Word>(x => x.ChildId == 3,
                                       x => x.AddedAt, 
                                       true, 5, 1); 
```

# php - WordPress安装问题

> ID：12230015
> 
> 赞同：0
> 
> 时间：2012-09-01T17:51:26.193
> 
> 标签：php, appserver

下载 WordPress 后。当我复制整个文件夹并将其粘贴到 appserv -> www

当我试图访问。从 localhost -> www/wordpress/wp-admin/install.php

我收到 404 not found 消息。

请帮我解决这个问题

提前致谢。

问候卡西克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:06:56.223

请使用**localhost** /wordpress/wp-admin/install.php 而不是**www** /wordpress/wp-admin/install.php。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-27T14:29:18.823

@Anoop 提供了解决方案。
当您手动配置端口时。
有时有必要在您的 localhost 中包含端口。
例如：`localhost:8080/wordpress/wp-admin/install.php`
（8080 是我的端口号，你可以不一样）

# ios - UISegmentedControl 索引

> ID：12230016
> 
> 赞同：0
> 
> 时间：2012-09-01T17:51:30.830
> 
> 标签：ios, xcode

我试图列出许多 UISegmentControls 的选定索引。我分别在1、2、3、4、5上设置了5个，使用这段代码后的结果（在数组中）是：2、2、0、0、0...

```
for (UISegmentedControl *seg in segmentArray)
{
    NSString* xWrapped = [NSString stringWithFormat:@"%d", seg.selectedSegmentIndex+1];
    [difficultyH addObject: xWrapped];
} 
```

为什么？？

编辑：

这是创建细分的方式：

```
//segment controll

            NSArray *itemArray2 = [NSArray arrayWithObjects: @"very easy", @"easy", @"ok", @"hard", @"challenging", nil];
            UISegmentedControl *segmentedControl2 = [[UISegmentedControl alloc] initWithItems:itemArray2];
            segmentedControl2.frame = CGRectMake(480, -60, 130, 350);
            segmentedControl2.segmentedControlStyle = UISegmentedControlStyleBar;
            segmentedControl2.selectedSegmentIndex = val - 1;
            [segmentedControl2 addTarget:self action:@selector(segmentedControlHomework:) forControlEvents:UIControlEventValueChanged];

            segmentedControl2.transform =
            CGAffineTransformRotate(segmentedControl2.transform, degreesToRadians(90));

            NSArray *arr = [segmentedControl2 subviews];
            for (int i = 0; i < [arr count]; i++) {
                UIView *v = (UIView*) [arr objectAtIndex:i];
                NSArray *subarr = [v subviews];
                for (int j = 0; j < [subarr count]; j++) {
                    if ([[subarr objectAtIndex:j] isKindOfClass:[UILabel class]]) {
                        UILabel *l = (UILabel*) [subarr objectAtIndex:j];
                        l.transform = CGAffineTransformMakeRotation(- M_PI / 2.0); //do the reverse of what Ben did
                    }
                }
            }

            [image1 addSubview:segmentedControl2];

            segmentedControl2.tag = i;

            [segmentArray addObject: segmentedControl2];

            //segment controll 
```

# c++ - 如何在 linux 中查找 c++ 静态库函数的源库？

> ID：12230017
> 
> 赞同：2
> 
> 时间：2012-09-01T17:51:55.087
> 
> 标签：c++, gdb, static-libraries

我有一个使用多个静态库构建的 C++ linux 可执行文件，全部带有调试信息 如何找到在可执行文件中调用的静态库函数的源库？

# java - Java：根据用户定义的 XSD 编写 XML

> ID：12230019
> 
> 赞同：1
> 
> 时间：2012-09-01T17:52:40.067
> 
> 标签：java, xml, parsing, csv, xsd

我正在编写一个将 CSV 格式的数据转换为 XML 的工具。用户将指定解析方法，即：输出的 XSD，CSV 中的哪个字段进入生成的 XML 的哪个字段。

（非常简化的用例）示例：

CSV

```
Ciccio;Pippo;Pappo
1;2;3 
```

XSD

```
(more stuff...)
<xs:element name="onetwo">
<xs:element name="three">
<xs:element name="four"> 
```

用户制定规则

```
 Ciccio -> onetwo
   Pippo -> three
   Pappo -> four 
```

我已经使用 Dataset 在 C# 中实现了这个，我怎么能在 Java 中做到这一点？我知道有 DOM、JAXB 等，但似乎 XSD 仅用于验证以其他方式创建的 XML。我错了吗？

编辑：一切都需要在运行时。我不知道我会收到什么样的 XSD，所以我不能实例化不存在的对象，也不能用数据填充它们。所以我猜xjc不是一个选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:04:49.110

由于您有`XSD`输出`XML`文件，因此创建此文件的最佳方法`XML`是使用 Java Architecture for XML Binding (JAXB)。您可能需要参考：[“使用 JAXB”](http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.6/tutorial/doc/JAXBUsing.html)教程，以概述如何使用它来满足您的需求。

基本思路如下：

*   从 XML 模式生成 JAXB Java 类，即`XSD`您拥有的
*   使用模式派生的 JAXB 类在 Java 应用程序中解组和编组 XML 内容
*   使用模式派生的 JAXB 类从头开始创建 Java 内容树
*   将数据解组到输出`XML`文件。

这是另一个您可能会发现信息丰富[的教程。](http://blog.sanaulla.info/2010/08/29/using-jaxb-to-generate-xml-from-the-java-xsd/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:03:20.710

这仍在进行中，但您可以在 XSD 上递归，在您找到新的文档树时将它们写出。

```
public void run() throws Exception {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document document = builder.parse(new InputSource(new FileReader(
            "schema.xsd")));

    Document outputDoc = builder.newDocument();

    recurse(document.getDocumentElement(), outputDoc, outputDoc);

    TransformerFactory transFactory = TransformerFactory.newInstance();
    Transformer transformer = transFactory.newTransformer();
    StringWriter buffer = new StringWriter();
    transformer.transform(new DOMSource(outputDoc),
            new StreamResult(buffer));
    System.out.println(buffer.toString());
}

public void recurse(Node node, Node outputNode, Document outputDoc) {

    if (node.getNodeType() == Node.ELEMENT_NODE) {
        Element element = (Element) node;
        if ("xs:element".equals(node.getNodeName())) {
            Element newElement = outputDoc.createElement(element
                    .getAttribute("name"));
            outputNode = outputNode.appendChild(newElement);

           // map elements from CSV values here?
        }
        if ("xs:attribute".equals(node.getNodeName())) {
           //TODO required attributes
        }
    }
    NodeList list = node.getChildNodes();
    for (int i = 0; i < list.getLength(); i++) {
        recurse(list.item(i), outputNode, outputDoc);
    }

} 
```

# python - 使用 auto_now_add 更新 mongoengine 中的 DateTime 字段

> ID：12230022
> 
> 赞同：5
> 
> 时间：2012-09-01T17:52:53.060
> 
> 标签：python, fork, mongoengine

我正在尝试制作[MongoEngine](https://github.com/hmarr/mongoengine)[的一个分支](https://github.com/asfaltboy/mongoengine)，它将允许基于将 True 传递给一个或（[a la Django](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.DateField.auto_now_add)）来自动更新 a 。`DateTimeField``auto_now``auto_now_add`

到目前为止，我已经将属性添加到这样的`__init__`方法中`DateTimeField`：

```
def __init__(self, auto_now=None, auto_now_add=None, **kwargs):
    self.auto_now, self.auto_now_add = auto_now, auto_now_add
    super(DateTimeField, self).__init__(**kwargs) 
```

不幸的是，我无法弄清楚在创建/保存文档时如何干净地填充此值。到目前为止，我看到的唯一解决方案是在 BaseDocument 的保存或验证方法中添加特定于字段的行为......但我不喜欢它。

有谁知道更好的方法？

顺便说一句：在阅读[了这个问题](https://stackoverflow.com/q/8098122/484127)和[@equinoxel](https://stackoverflow.com/users/515948/equinoxel)关于扩展 mongo 并在 django 中习惯于这个属性的评论之后，我想尝试一下。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-03T12:55:05.937

您可以添加预保存信号并在保存前更新文档日期。

```
class MyDoc(Document):
    name = StringField()
    updated_at = DateTimeField(default=datetime.datetime.now)

    @classmethod
    def pre_save(cls, sender, document, **kwargs):
        document.updated_at = datetime.datetime.now()

signals.pre_save.connect(MyDoc.pre_save, sender=MyDoc) 
```

`update`这样做的主要问题是，如果您致电或进行批量更新，它们将不会更新，例如：`MyDocs.objects.update(set__name=X)`

添加票证：[https ://github.com/MongoEngine/mongoengine/issues/110](https://github.com/MongoEngine/mongoengine/issues/110)

# c# - WPF 命令绑定到祖先属性

> ID：12230027
> 
> 赞同：1
> 
> 时间：2012-09-01T17:53:12.433
> 
> 标签：c#, wpf, xaml, mvvm

我对绑定到 WPF 中的祖先属性有疑问。我的情况是：我的窗口有一个视图模型作为数据上下文，所有命令都作为 ICommand 属性。我有一个复选框列表，如下所示：

```
<ItemsControl ItemsSource="{Binding CurrentCustomer.SuppiersSelection}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox FontSize="16" Content="{Binding Path=Supplier.Company}" 
                      IsChecked="{Binding Path=Selected}"></CheckBox>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

问题是：我希望每个复选框都绑定一个命令，以便在选中或取消选中供应商时自动保存客户和供应商之间的关系。我的问题是命令属性位于窗口数据上下文中，并且此复选框将 ItemControl 的 ItemsSource 用作数据上下文。如何绑定到 Window Data Context 上的属性？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:53:51.407

```
{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext} 
```

但目前尚不清楚任务是什么。为什么不使用双向绑定来处理 Selected 属性的变化呢？

# c# - 在 WPF4 DataGrid 中水平滚动时性能不佳

> ID：12230028
> 
> 赞同：2
> 
> 时间：2012-09-01T17:53:18.423
> 
> 标签：c#, .net, wpf, wpfdatagrid

我有一个应用程序需要显示主要由布尔值组成的数据网格，并且复选框列符合要求。大约有 40-60 个复选框列，大约 200 行。我认为在 WPF 中做类似的事情是微不足道的。

我什至无法使用 WPF 获得体面的水平滚动体验。要查看我在说什么，请创建 a`Window`并在其上放置 a ，然后`DataGrid`设置`AutoGenerateColumns="True"`，然后在构造函数之后添加以下内容`InitializeComponent();`：

```
dataGrid1.ItemsSource = Create(200, i => new { b1 = true, b2 = false, b3 = true, b4 = false, b5 = true, b6 = false, b7 = true, b8 = false, b9 = true,
                                               b10 = false, b11 = true, b12 = false, b13 = true, b14 = false, b15 = true, b16 = false, b17 = true, b18 = false, b19 = true, b20 = false, b21 = true,
                                               b22 = false, b23 = true, b24 = false, b25 = true, b26 = false, b27 = true, b28 = false, b29 = true, b30 = false, b31 = true, b32 = false }); 
```

它需要这个方法，也添加它：

```
ObservableCollection<T> Create<T>(int count, Func<int, T> creator)
{
    return new ObservableCollection<T>(Enumerable.Range(0, count).Select(creator));
} 
```

运行应用程序，并尝试水平滚动。可怕，不是吗？垂直滚动也不太热。

我对 WinForms 应用程序做了同样的事情，并且在所有方向上滚动都非常流畅，并且在将`DataGridView`'`DoubleBuffered`属性强制为`true`. 为了比较，创建一个 new `Form`， plop a`DataGridView`并将以下内容添加到构造函数 after `InitializeComponent();`：

```
typeof(DataGridView).GetProperty("DoubleBuffered", BindingFlags.Instance | BindingFlags.NonPublic).SetValue(dataGridView1, true, null);
for (int i = 0; i < 64; i++)
    dataGridView1.Columns.Add(new DataGridViewCheckBoxColumn {HeaderText = "C" + i, Width = 30});
for (int i = 0; i < 400; i++)
    dataGridView1.Rows.Add(); 
```

它有两倍的列数，两倍的行数，并且它在水平和垂直方向上都像新生儿的底部一样平滑。

但不幸的是，我不能用 WinForms 做我需要的事情。我需要模板列。我需要可组合性。

为了解决 WPF 中的滚动问题，我尝试了以下所有组合：

*   EnableColumnVirtualization（真/假）
*   EnableRowVirtualization（真/假）
*   ScrollViewer.CanContentScroll (true/false) -`false`仅改进垂直滚动
*   固定大小的列
*   固定大小的数据网格
*   VirtualizingStackPanel.VirtualizationMode (Recycling/Standard) -[`Recycling`有一个错误，它会回收`CheckBox`选中的控件并将其放置在应该取消选中的新行中，从而导致动画淡出。这使得复选框看起来具有“重影”效果。]
*   ScrollViewer.IsDeferredScrollingEnabled - 很抱歉，但我不能接受降级到 Windows 3.1 样式的滚动，因为这太微不足道了。

我愿意接受低于标准的表现。我不期望像 WinForms 的流畅性（WPF 毕竟给了我这么多，尽管这应该被 WPF 的 GPU 加速所抵消）。我只想要一些可用的东西，即使只是勉强可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:53:28.293

这主要是因为 CheckBox 可视化树相当复杂。如果您重新设计视觉树的样式，您可以获得更好的性能。

虽然 ControlTemplate（单边框）中只有单个元素，但没有滞后或延迟。您可以从这里获得特定样式：http: [//msdn.microsoft.com/en-us/library/ms752319%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms752319%28v=vs.85%29.aspx)

肯定会花一些时间在数据绑定上。看到这个： [数据绑定优化](http://msdn.microsoft.com/en-us/library/bb613546.aspx)，它解释了绑定到通常的属性需要更长的时间。通常是因为它涉及反射。使用依赖属性时，不涉及反射。据我所知。

你的班级肯定不大，但你肯定能考上。如果一切都是依赖属性，它会表现得更好吗？

如果您遇到任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:02:26.180

正如我在评论中所说，我不确定这个问题。如果您正在 WPF 中寻找网格的性能，请转到 ListView / GridView。除非您必须拥有 DataGrid 的某些功能。这是更多的代码，但值得。我有一个 GridView，它有 40 列和 1000 行，性能很好（DataGrid 性能很差）。

# java - 是否可以使用 icu4j UnicodeSet 类进行模式匹配而不是正则表达式？

> ID：12230029
> 
> 赞同：1
> 
> 时间：2012-09-01T17:53:23.357
> 
> 标签：java, regex, pattern-matching, icu

我在[Java 正则表达式库基准测试](http://www.tusker.org/regex/regex_benchmark.html)（*基准测试源代码：**[regtest.java](http://www.tusker.org/regex/regtest.java)*）中找到了[icu4j](http://userguide.icu-project.org/strings/unicodeset)库的 UnicodeSet 类。我正在尝试使用以下代码对其进行测试。似乎 UnicodeSet 有自己的模式语法，与 PCRE 不完全兼容。

```
String exp = "^[abc]x?c$";

com.ibm.icu.text.UnicodeSet uniset = new com.ibm.icu.text.UnicodeSet("[" + exp + "]");
java.util.regex.Pattern regex = java.util.regex.Pattern.compile(exp);
System.out.println(uniset.containsAll("ac")); //Returns false
System.out.println(regex.matcher("ac").matches()); //Returns true 
```

如何重写上面的表达式，它可以与 UnicodeSet 一起正常工作？

我正在使用 ICU4J (49.1) 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:07:28.547

`UnicodeSet`不是正则表达式。您的表达式`[^[abc]x?c$]`匹配很多代码点，但`a`并不`c`在其中。

[http://unicode.org/cldr/utility/list-unicodeset.jsp](http://unicode.org/cldr/utility/list-unicodeset.jsp)是一种在线玩 UnicodeSets 的方法。

您提到的基准页面应该考虑这一点。

# c# - C# Expression.Lambda 无法在运行时编译

> ID：12230033
> 
> 赞同：1
> 
> 时间：2012-09-01T17:53:52.807
> 
> 标签：c#, expression-trees

我已经构建了表达式解析器`CreateExpression()`，它返回构造的表达式树

```
Expression rule = CreateExpression(_BuyRuleString);
LambdaExpression lambda = Expression.Lambda(rule, _ParameterExpressions);
var func = lambda.Compile(); 
```

但是当我调用`lambda.Compile()`错误时它失败了

`variable 't1' of type 'System.Int32' referenced from scope '', but it is not defined`

所以我打印出表达式`lambda`

```
.Lambda #Lambda1<System.Func`9[System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Double,System.Double,System.Boolean[]]>(
System.Int32 $t1,
System.Int32 $t2,
System.Int32 $t3,
System.Int32 $t4,
System.Int32 $t5,
System.Int32 $t6,
System.Double $r1,
System.Double $r2) {
.Call SwarmTrader.ExpressionParser.SeriesOperatorFunc.GTZ(.Call SwarmTrader.Indicator.RSI(
        $t1,
        "p"))
} 
```

相当于

```
Expression<Func<int, int, int, int, int, int, double, double, bool[]>> test = (t1, t2, t3, t4, t5, t6, r1, r2) => SwarmTrader.ExpressionParser.SeriesOperatorFunc.GTZ(SwarmTrader.Indicator.RSI(t1, "p")); 
```

但`var func = test.Compile();`有效。所以我尝试结合解决它......

```
lambda = Expression.Lambda(rule, _ParameterExpressions); // lambda.Compile() failed
lambda = Expression.Lambda(test.Body, _ParameterExpressions); // lambda.Compile() failed
lambda = Expression.Lambda(rule, test.Parameters); // lambda.Compile() failed
lambda = Expression.Lambda(test.Body, test.Parameters); // lambda.Compile() works 
```

谁能指出为什么`lambda.Compile()`只能从 工作`test`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T18:03:43.883

很可能您`CreateExpression()`没有引用 中的参数`_ParameterExpressions`，而是定义了自己的参数。您必须在您正在编译的表达式树和 lambda 参数中使用*相同的内容。* `ParameterExpression`

# php - 当应该有两个值时，“While”循环返回一个值

> ID：12230038
> 
> 赞同：0
> 
> 时间：2012-09-01T17:54:29.220
> 
> 标签：php, mysql

啊。我不知道为什么这不起作用：

我有一个只有 2 行的数据库。其中一个 db 列存储时间 + 1 小时。我想查询数据库，并且对于存储时间早于当前时间的每一行，给我发送一条消息。基本上，它只是将消息从存储之时起延迟发送 1 小时。

发生的事情是它只发送一封电子邮件。'storedtime' 中的两个值都比当前时间更早（更小）。但只有一条消息发出。我到底错过了什么？

```
$query = "SELECT * FROM db";
$result=@mysql_query($query);
$num=@mysql_numrows($result);
$row=mysql_fetch_array($result);

$i = 0;
$time = time();
while($i < $num)
    {
        if(($row['storedtime']) <= $time)
        {           
        mail("myemailaccount","Subject","Message here, etc.", $headers);
        }

    $i++;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T17:58:48.827

我建议`mysql_fetch_array($result)`在 while 循环中使用

然后，它应该是这样的：

```
$query = "SELECT * FROM db";
$result = mysql_query($query);

$time = time();
while($row = mysql_fetch_array($result))
{
        if(($row['storedtime']) <= $time)
        {
              mail("myemailaccount","Subject","Message here, etc.", $headers);
        }
} 
```

希望能帮助到你。

您可以从文档站点查看以下示例。此外，阅读**建议的替代方案**部分（**MySQLi**或**PDO_MySQL**）也很重要。[http://php.net/manual/es/function.mysql-fetch-array.php](http://php.net/manual/es/function.mysql-fetch-array.php)

# php - 使用 GeSHi 使用 Markdown

> ID：12230049
> 
> 赞同：1
> 
> 时间：2012-09-01T17:55:53.317
> 
> 标签：php, markdown, geshi, smartypants

我曾经使用 Markdown 来格式化丰富的内容。然后我需要一些额外的东西，就像我们的 StackOverflow 所做的那样。所以，我想到让 GeSHi 与 Markdown 一起工作。

我试过了`markdown_extra_geshi`，但我无法处理它。那一刻，我看到了一个[**Beautify**](http://www.bitstorm.org/weblog/2012-8/Beautify_Markdown_SmartyPants_GeSHi_and_Dot_combined.html)项目（[GitHub](https://github.com/edwinm/Beautify)）。

Markdown 工作正常，但有一些问题。语法突出显示不起作用。SmartyPants 也在转换代码中的引号。

我作为输入提供的 Markdown Snippet 是：

```
#Checking Codes!
The `inline code` and **big code**:

    {{lang:php}}
    echo "string";

###Same way!

    #!php
    echo "string"; 
```

我得到的 HTML 输出为：

```
<h1>Checking Codes!</h1>

<p>The <code>inline code</code> and <strong>big code</strong>:</p>

<pre><code>{{lang:php}}
echo &amp;#8220;string&amp;#8221;;
</code></pre>

<h3>Same way!</h3>

<pre><code>#!php
echo &amp;#8220;string&amp;#8221;;
</code></pre> 
```

实际上它不应该将引号转换为智能引号，并且我找不到语法突出显示。我做错了吗？这个测试文件的源代码是：

PHP代码：

```
<?php
    include("beautify.php");
    echo beautify('#Checking Codes!
The `inline code` and **big code**:

    {{lang:php}}
    echo "string";

###Same way!

    #!php
    echo "string";
');
?> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T06:33:58.317

终于从作者本人那里得到了答案。

你应该把你的代码放在`~~~`.

像这样：

```
~~~ php
echo "here's PHP code";
~~~
Here's normal text. 
```

未来的访客可能会从中获得帮助。:)

# mysql - 来自三个不同表的 MySQL 查询

> ID：12230056
> 
> 赞同：0
> 
> 时间：2012-09-01T17:57:26.907
> 
> 标签：mysql, sql

我构建了工作 MySQL 查询：

```
 SELECT 
    v.*, u.username 
  FROM 
    video AS v, users AS u
  WHERE
    v.type = 'public' 
  AND 
    v.user_ID = u.user_ID 
```

现在我想添加第三个表和表中`count()`的结果，该表`comments`中`video_ID`的结果与表中的结果相同`video`。

我试过了，但没有成功：

```
 SELECT 
    v.*, u.username, count(c.video_ID)
  FROM 
    video AS v, users AS u, comments AS c
  WHERE
    v.type = 'public' 
  AND 
    v.user_ID = u.user_ID
  AND
    v.video_ID = c.video_ID 
```

作为回报，我想获得与某些评论相关的评论数量`video_ID`。

我不明白如何使它在一个查询中正常工作。

你能帮帮我吗？

提前谢谢你，
伊利亚

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T18:01:23.320

如果您在查询中使用像 a 这样的聚合函数`COUNT`，则需要使用`GROUP BY`子句指定分组。

试试这个

```
SELECT  
    v.*, 
    u.username, 
    count(c.video_ID) AS comment_count
FROM  
video AS v
     INNER JOIN users AS u ON     v.user_ID = u.user_ID 
     INNER JOIN comments AS c ON    v.video_ID = c.video_ID
WHERE 
 v.type = 'public'  
GROUP BY
    v.id, 
    u.username,
    v.v.add_time
ORDER BY
    v.add_time 
```

虽然 MySQL 允许您省略`GROUP BY`子句的某些元素，但最好指定它们。

连接两个表时，最好使用`INNER JOIN`语法而不是`WHERE`过滤器。

# javascript - jQuery中的事件委托，怎么做？

> ID：12230057
> 
> 赞同：0
> 
> 时间：2012-09-01T17:57:46.163
> 
> 标签：javascript, jquery, events, event-delegation

在 JavaScript 中，我曾经像这样使用事件委托：

```
someDiv.addEventListener('click', function(evt){
    if(evt.target.id == "#someChild"){
       // Do something..
    } else if(evt.target.id == "#anotherChild"){
       // Do something else..
    }
}, false); 
```

jQuery 中的 this 等价于什么？我知道`.on()`但如何在事件委托中使用它？我的意思是这是怎么做到的：

```
someDiv.on('click, '#someChild, #anotherChild", function(evt){
      if($(this).is("#someChild")){ 
           // Do something..
      } else if($(this).is("#anotherChild")){
           // Do something else ..
      }      
}); 
```

但它不会和原版 JavaScript 中的一样吗？我想知道是否有更好的方法来实现它。如果这是唯一的方法，那么 jQuery 方法比 JS 方法有什么好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:00:57.327

使用 jQuery，您可以这样做：

```
function onButtonClick(e) {
  //this = the button that was clicked

}

$(document.body).on('click','button',onButtonClick) 
```

[你可以在这里](http://api.jquery.com/on/)阅读文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:02:34.387

你可以从这里开始，如果这个元素是动态创建的，而不是在页面加载时

```
$(document).on('click', '#someChild', function(evt) {
   // Do something..      
}); 
```

如果在呈现页面之前创建元素，那么这将起作用

```
 <input type="button" onclick="fnClickfn();" id="xxx" /> 
```

编辑：

哦，也`.on`只适用于 jQuery 的更高版本（我认为是 1.6 及更高版本），所以请确保您没有使用需要`.live`和`.die`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T18:04:24.023

你可以做：

```
$(someDiv).on('click', '#someChild, #anotherChild', function(){
    if(this.id ==='someChild'){ 
       // Do something..
    } else if(this.id === 'anotherChild'){
       // Do something else ..
    }      
}); 
```

或者，如果您对两个元素执行不同的操作，则创建两个事件处理程序：

```
$(someDiv).on('click', '#someChild', function(){
     // Do something..    
}).on('click', '#anotherChild', function() {
     // Do something else ..
}); 
```

> 但它不会和原版 JavaScript 中的一样吗？我想知道是否有更好的方法来实现它。如果这是唯一的方法，那么 jQuery 方法比 JS 方法有什么好处？

当然它基本上是一样的，jQuery 只是通过提供 DOM API 的包装器让你的生活更轻松一些，但它不会改变 DOM 的工作方式。

但是有一个区别，即`this`它将引用选择器匹配的元素，而不是处理程序绑定到的元素。

一般来说，优点是 jQuery 代码比使用`addEventListener`.

# jsf - 从 Servlet 访问 JSF ViewScoped 托管 bean

> ID：12230065
> 
> 赞同：2
> 
> 时间：2012-09-01T17:59:10.423
> 
> 标签：jsf, servlets

如何从 Servlet 访问 JSF ViewScoped 托管 bean？

（假设有问题的托管 bean 已经创建，但仍未被销毁）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T10:38:47.417

视图范围的变量存储在组件树的[视图映射中。](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIViewRoot.html#getViewMap%28%29)要在视图上下文之外访问这些数据，您必须[创建一个 JSF 上下文](http://docs.oracle.com/javaee/6/api/javax/faces/context/FacesContextFactory.html#getFacesContext%28java.lang.Object,%20java.lang.Object,%20java.lang.Object,%20javax.faces.lifecycle.Lifecycle%29)并为请求[恢复视图。](http://docs.oracle.com/javaee/6/api/javax/faces/application/StateManager.html#restoreView%28javax.faces.context.FacesContext,%20java.lang.String,%20java.lang.String%29)[这涉及重写JSF 容器](http://docs.oracle.com/javaee/6/api/javax/faces/webapp/FacesServlet.html)提供的大部分功能。

JSF 2 提供了无需刷新页面即可与服务器端状态交互的机制：[AJAX 标记](http://www.ibm.com/developerworks/java/library/j-jsf2fu-0610/index.html)和[JSF JavaScript API](http://docs.oracle.com/cd/E17802_01/j2ee/javaee/javaserverfaces/2.0/docs/js-api/index.html)。如果可能的话，我会考虑利用这些。

或者，将数据放入可通过 servlet（会话）轻松访问的范围内。

*由于视图状态通常保存在会话中，因此在技术上很可能从这里访问视图状态。但这将涉及特定于实现的黑客行为，这些黑客行为可能无法在底层框架升级后幸免于难。我什至不会将此视为解决方案。*

# git - 用本地机器上的文件替换 git repo 中的所有文件

> ID：12230066
> 
> 赞同：2
> 
> 时间：2012-09-01T17:59:38.767
> 
> 标签：git, heroku, github

我希望我的 git 存储库看起来与我在本地拥有的完全一样。

就像我在我的 git 存储库和本地计算机上有 A、B、C、D 和 E 文件一样，我已经删除了 A、B 和 C，留下了 D 和 E。当我推送时，我只想看到 D 和 E存储库。请问我该怎么做。我也可以对 heroku 做同样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:13:05.000

暂存所有更改，提交并推送。

```
git add -A
git status
git commit -m "Deleted A, B, C"
git push 
```

# webrtc - 如何在我自己的服务器（Windows Server）中安装 WebRTC

> ID：12230067
> 
> 赞同：1
> 
> 时间：2012-09-01T17:59:50.800
> 
> 标签：webrtc

我刚听说 WebRTC，想用这种潜在的技术做一些测试。你们能否指导我如何在我的服务器中下载和安装 WebRTC（使用 win 32）。以及我应该考虑的编解码器......等等......

预先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T20:21:33.917

官方参考文档中的入门指南呢？ https://webrtc.org/getting-started/overview

# android - android content provider - 首先运行Activity Splash screen，同时从原始数据填充数据库到content provider

> ID：12230069
> 
> 赞同：0
> 
> 时间：2012-09-01T18:00:18.000
> 
> 标签：android

在我的应用程序中，我有一个内容提供者，它使用数据库来提供所提供的内容。第一次创建数据库时，需要从 Json 文件的原始内容中填充。我的想法是在我的 SQLiteOpenHelper 子类的 onCreate 处触发数据库的填充。这工作正常，但我不确定在应用程序第一次运行时如何处理应用程序和内容提供者之间的通信。基本上我想在数据库被填满时显示某种闪屏。然而，应用程序如何获得通知

1.  第一次运行时，内容提供者正忙于填充数据库
2.  内容提供商已准备就绪

当然，我可以通过使用每个数据集调用内容提供者来从应用程序中填充数据库，但我更愿意在内容提供者的范围内进行，这样应用程序就不必处理 json 文件的读取等。除了设计偏好它还将使内容提供者能够更有效地填充数据库，因为它会同时拥有整个数据集。我有一种感觉，这是不可能的，但我希望我错过了一些简单的观点。

任何如何实现这一目标的建议将不胜感激。

谢谢

马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:15:46.377

当使用内容提供者时，我会假设您使用 DBHelper 类来管理数据库的创建。下面是来自 android notes 示例项目的代码。

这显示了 DBHelper 构造函数如何足够智能地确定数据库之前是否已创建。在 createDatabase 方法中，我随后会调用一个方法来预填充数据库，如您所说的 json 文件。

问题是这实际上不允许您与 Activity 进行通信，即您的数据库尚未初始化。

一种想法可能是您使用 SharedPreferences 来存储您已填充数据库的事实。然后，您可以在启动时检查活动中的 sharedPreference，调用内容提供者来填充数据库，然后存储您已经完成此任务的共享首选项。

请注意，如果您例如从 android 设置菜单中删除数据，我不确定 sharedPreferences 是否保持与数据库相同的状态。你需要检查一下。

> [http://code.google.com/p/android-notes/source/browse/trunk/src/com/bitsetters/android/notes/DBHelper.java?r=10](http://code.google.com/p/android-notes/source/browse/trunk/src/com/bitsetters/android/notes/DBHelper.java?r=10)

```
public class DBHelper {

private static final String DATABASE_NAME = "notes";
private static final String TABLE_DBVERSION = "dbversion";
private static final String TABLE_NOTES = "notes";
private static final int DATABASE_VERSION = 1;
private static String TAG = "DBHelper";
Context myCtx;

private static final String DBVERSION_CREATE = 
    "create table " + TABLE_DBVERSION + " ("
            + "version integer not null);";

private static final String NOTES_CREATE =
    "create table " + TABLE_NOTES + " ("
        + "id integer primary key autoincrement, "
        + "note text, "
        + "lastedit text);";

private static final String NOTES_DROP =
    "drop table " + TABLE_NOTES + ";";

private SQLiteDatabase db;
/**
 * 
 * @param ctx
 */
public DBHelper(Context ctx) {
    myCtx = ctx;
            try {
                    db = myCtx.openOrCreateDatabase(DATABASE_NAME, 0,null);

                    // Check for the existence of the DBVERSION table
                    // If it doesn't exist than create the overall data,
                    // otherwise double check the version
                    Cursor c =
                            db.query("sqlite_master", new String[] { "name" },
                                            "type='table' and name='"+TABLE_DBVERSION+"'", null, null, null, null);
                    int numRows = c.getCount();
                    if (numRows < 1) {
                            CreateDatabase(db);
                    } else {
                            int version=0;
                            Cursor vc = db.query(true, TABLE_DBVERSION, new String[] {"version"},
                                            null, null, null, null, null,null);
                            if(vc.getCount() > 0) {
                                vc.moveToFirst();
                                version=vc.getInt(0);
                            }
                            vc.close();
                            if (version!=DATABASE_VERSION) {
                                    Log.e(TAG,"database version mismatch");
                            }
                    }
                    c.close();

            } catch (SQLException e) {
                    Log.d(TAG,"SQLite exception: " + e.getLocalizedMessage());
            } finally {
                    db.close();
            }
}

private void CreateDatabase(SQLiteDatabase db)
{
            try {
                    db.execSQL(DBVERSION_CREATE);
                    ContentValues args = new ContentValues();
                    args.put("version", DATABASE_VERSION);
                    db.insert(TABLE_DBVERSION, null, args);

                    db.execSQL(NOTES_CREATE);
                    // Populate with data
                    populateDataBaseFromFile();// There are probably better ways to do this.
                    setSharedPreferenceYouPopulatedDB();
            } catch (SQLException e) {
                    Log.d(TAG,"SQLite exception: " + e.getLocalizedMessage());
            } 
} 
```

就我个人而言，除非你真的需要，否则我不会打扰启动画面。

另一个想法可能是：

1.  在 db helper 中编写一个方法来确定您的表是否存在。如果不是，则返回 false。
2.  在启动活动中，使用调用 DBHelper 测试方法的请求调用 ContentProvider。
3.  如果为 false，则显示启动屏幕，然后调用 Content Provider 来填充 DB。
4.  如果属实，则照常进行。

# design-patterns - 数据访问层中的多态性

> ID：12230080
> 
> 赞同：1
> 
> 时间：2012-09-01T18:01:16.690
> 
> 标签：design-patterns

我继承了一个大型 ASP.NET 应用程序，其中包含同时包含业务逻辑和数据逻辑的类。我正在尝试重构它。

我正在考虑创建一个数据访问层。令我困惑的一件事是 DAL 中的多态性。例如，如果您有一个学生班，然后是一个从他们继承的研究生班和本科班，那么您可以在业务逻辑层执行此操作：

```
Dim s1 As Student = New PostGraduate() 
```

数据访问层中是否使用过多态性？我在其他地方看到过这个问题，回答者说不要打扰，只需调用 DAL 函数，但我只是想确定一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:12:23.440

这将取决于数据在何处被持久化的表示方式。

例如，如果您有一个包含所有基本学生数据的表（假设您使用的是关系数据库），以及针对研究生和本科生的其他表，那么您可能需要考虑它。

# haskell - 如何恢复 GADT 中的共享？

> ID：12230088
> 
> 赞同：20
> 
> 时间：2012-09-01T18:01:52.370
> 
> 标签：haskell, dsl, gadt

在[Haskell 中的 Type-Safe Observable Sharing 中，](https://encrypted.google.com/url?sa=t&rct=j&q=type-safe%20observable%20sharing%20in%20haskell&source=web&cd=1&cad=rja&ved=0CB8QFjAA&url=http%3A%2F%2Fittc.ku.edu%2F~andygill%2Fpapers%2FreifyGraph.pdf&ei=yEpCUJCiCuaYiALV-4HwAQ&usg=AFQjCNFdaGlZedhgmRDqxJIPYHu526q4pg&sig2=KXLJ91EzuGdCXaBcOnbKMg) Andy Gill 展示了如何在 DSL 中恢复存在于 Haskell 级别的共享。他的解决方案是在[data-reify 包](http://hackage.haskell.org/package/data-reify)中实现的。可以修改此方法以与 GADT 一起使用吗？例如，给定这个 GADT：

```
data Ast e where
  IntLit :: Int -> Ast Int
  Add :: Ast Int -> Ast Int -> Ast Int
  BoolLit :: Bool -> Ast Bool
  IfThenElse :: Ast Bool -> Ast e -> Ast e -> Ast e 
```

我想通过将上述 AST 转换为

```
type Name = Unique

data Ast2 e where
  IntLit2 :: Int -> Ast2 Int
  Add2 :: Ast2 Int -> Ast2 Int -> Ast2 Int
  BoolLit2 :: Bool -> Ast2 Bool
  IfThenElse2 :: Ast2 Bool -> Ast2 e -> Ast2 e -> Ast2 e
  Var :: Name -> Ast2 e 
```

通过函数

```
recoverSharing :: Ast -> (Map Name, Ast2 e1, Ast2 e2) 
```

（我不确定 的类型`recoverSharing`。）

请注意，我不关心通过 let 构造引入新绑定，而只关心恢复存在于 Haskell 级别上的共享。这就是为什么我`recoverSharing`返回一个`Map`.

如果它不能作为可重复使用的包完成，至少可以为特定的 GADT 完成吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T23:03:22.237

有趣的谜题！事实证明，您可以将 data-reify 与 GADT 一起使用。您需要的是一个将类型隐藏在存在主义中的包装器。稍后可以通过对`Type`数据类型进行模式匹配来检索该类型。

```
data Type a where
  Bool :: Type Bool
  Int :: Type Int

data WrappedAst s where
  Wrap :: Type e -> Ast2 e s -> WrappedAst s

instance MuRef (Ast e) where
  type DeRef (Ast e) = WrappedAst
  mapDeRef f e = Wrap (getType e) <$> mapDeRef' f e
    where
      mapDeRef' :: Applicative f => (forall b. (MuRef b, WrappedAst ~ DeRef b) => b -> f u) -> Ast e -> f (Ast2 e u)
      mapDeRef' f (IntLit i) = pure $ IntLit2 i
      mapDeRef' f (Add a b) = Add2 <$> (Var Int <$> f a) <*> (Var Int <$> f b)
      mapDeRef' f (BoolLit b) = pure $ BoolLit2 b
      mapDeRef' f (IfThenElse b t e) = IfThenElse2 <$> (Var Bool <$> f b) <*> (Var (getType t) <$> f t) <*> (Var (getType e) <$> f e)

getVar :: Map Name (WrappedAst Name) -> Type e -> Name -> Maybe (Ast2 e Name)
getVar m t n = case m ! n of Wrap t' e -> (\Refl -> e) <$> typeEq t t' 
```

这是整个代码：[https ://gist.github.com/3590197](https://gist.github.com/3590197)

*编辑：*我喜欢`Typeable`在另一个答案中使用。所以我也做了一个我的代码版本`Typeable`：[https](https://gist.github.com/3593585) ://gist.github.com/3593585 。代码明显更短。`Type e ->`替换为`Typeable e =>`，这也有一个缺点：我们不再知道可能的类型仅限于`Int`and `Bool`，这意味着 . 中必须有一个`Typeable e`约束`IfThenElse`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T23:07:47.607

我将尝试以您的 GADT 为例，证明这可以针对特定的 GADT 完成。

我将使用**Data.Reify**包。这需要我定义一个新的数据结构，其中递归位置被一个参数替换。

```
data AstNode s where
  IntLitN :: Int -> AstNode s
  AddN :: s -> s -> AstNode s
  BoolLitN :: Bool -> AstNode s
  IfThenElseN :: TypeRep -> s -> s -> s -> AstNode s 
```

请注意，我删除了许多原始 GADT 中可用的类型信息。对于前三个构造函数，关联类型是什么（Int、Int 和 Bool）很清楚。对于最后一个，我会记住使用**TypeRep**的类型（在**Data.Typeable**中可用）。**reify**包所需的 MuRef实例如下所示。

```
instance Typeable e => MuRef (Ast e) where
  type DeRef (Ast e)     = AstNode
  mapDeRef f (IntLit a)  = pure $ IntLitN a
  mapDeRef f (Add a b)   = AddN <$> f a <*> f b
  mapDeRef f (BoolLit a) = pure $ BoolLitN a
  mapDeRef f (IfThenElse a b c :: Ast e) = 
    IfThenElseN (typeOf (undefined::e)) <$> f a <*> f b <*> f c 
```

现在我们可以使用**reifyGraph**来恢复共享。但是，丢失了很多类型信息。让我们尝试恢复它。我稍微改变了你对**Ast2**的定义：

```
data Ast2 e where
  IntLit2 :: Int -> Ast2 Int
  Add2 :: Unique -> Unique -> Ast2 Int
  BoolLit2 :: Bool -> Ast2 Bool
  IfThenElse2 :: Unique -> Unique -> Unique -> Ast2 e 
```

reify 包中的图表如下所示（其中**e = AstNode**）：

```
data Graph e = Graph [(Unique, e Unique)] Unique 
```

让我们创建一个新的图形数据结构，我们可以在其中分别存储**Ast2 Int**和**Ast2 Bool**（因此，类型信息已恢复）：

```
data Graph2 = Graph2 [(Unique, Ast2 Int)] [(Unique, Ast2 Bool)] Unique 
            deriving Show 
```

现在我们只需要从**Graph AstNode**（reifyGraph 的结果**）**到**Graph2**中找到一个函数：

```
recoverTypes :: Graph AstNode -> Graph2
recoverTypes (Graph xs x) = Graph2 (catMaybes $ map (f toAst2Int) xs) 
                                   (catMaybes $ map (f toAst2Bool) xs) x where
  f g (u,an) = do a2 <- g an
                  return (u,a2)

  toAst2Int (IntLitN a) = Just $ IntLit2 a
  toAst2Int (AddN a b)  = Just $ Add2 a b
  toAst2Int (IfThenElseN t a b c) | t == typeOf (undefined :: Int) 
                        = Just $ IfThenElse2 a b c
  toAst2Int _           = Nothing

  toAst2Bool (BoolLitN a) = Just $ BoolLit2 a
  toAst2Bool (IfThenElseN t a b c) | t == typeOf (undefined :: Bool) 
                          = Just $ IfThenElse2 a b c
  toAst2Bool _            = Nothing 
```

让我们做一个例子：

```
expr = Add (IntLit 42) expr  

test = do
  graph <- reifyGraph expr
  print graph
  print $ recoverTypes graph 
```

印刷：

```
let [(1,AddN 2 1),(2,IntLitN 42)] in 1
Graph2 [(1,Add2 2 1),(2,IntLit2 42)] [] 1 
```

第一行显示**reifyGraph**已正确恢复共享。第二行告诉我们只找到了**Ast2 Int**类型（这也是正确的）。

这种方法很容易适用于其他特定的 GADT，但我看不出它是如何完全通用的。

The complete code can be found at [http://pastebin.com/FwQNMDbs](http://pastebin.com/FwQNMDbs) .

# php - CakePHP 网站的 CPU 使用率

> ID：12230089
> 
> 赞同：0
> 
> 时间：2012-09-01T18:02:11.233
> 
> 标签：php, performance, cakephp, cakephp-2.0, cpu-usage

我在 PHP 5.3.8 和 Litespeed 5.5 上使用 CakePHP 2.2。

由于服务器负载有时我的站点无法访问，因此我需要检查平均和最大 CPU 利用率。在我的旧托管数据包中，我从 cPanel 检查它，但我的新服务器有 Plesk，它是共享的，我无权检查 CPU 日志。

我知道最好的统计数据将是服务器的统计数据，但我很好奇是否有办法、库等来检查和记录服务器负载？或者您能建议另一种检查服务器负载水平的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:30:16.293

这是一个快速的命令，可以帮助您：

```
<?php echo exec('uname -a') . "<br>";
    echo exec('ps aux'); ?> 
```

这就是我要开始的地方。您可能必须根据 uname 命令返回的底层操作系统修改参数。通常托管公司会允许您请求访问外壳，以便您可以进一步挖掘。

这是一个名为 phpsysinfo 的功能齐全的库，它显示了一切非常好的东西。[http://phpsysinfo.sourceforge.net/phpsysinfo/index.php?disp=dynamic](http://phpsysinfo.sourceforge.net/phpsysinfo/index.php?disp=dynamic)

# python - 中止执行，如果文件名被更改

> ID：12230093
> 
> 赞同：1
> 
> 时间：2012-09-01T18:02:27.840
> 
> 标签：python

这是我的老师问的一个问题。“如果 Filenamed 被用户重命名，您将如何阻止脚本执行。”

我心里有这个想法。

```
#consider the name of the script to be myscript.py
import os
signal = 0
while 1:
    if "myscript.py" not in os.listdir("."):
        signal = 1
    else:
        if signal:
            break
        else:
            #do the requirements 
```

但是他说，whatif，用户在目录中已经有一个名为“myscript.py”的文件，并且他更改了脚本的名称，脚本将运行良好。我被卡住了。

我正在使用 python2.7，操作系统：Windows，如果需要，允许使用任何外部库，有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:04:01.557

modules的`__file__`属性包含包含它的 Python 脚本的完整路径名。

# silverlight - 将矩形的填充颜色绑定到前景色

> ID：12230095
> 
> 赞同：0
> 
> 时间：2012-09-01T18:02:40.363
> 
> 标签：silverlight, windows-phone-7, dependency-properties, visualstatemanager

我在按钮中有一个自定义控件。在控件的模板中，我有一个矩形和一个文本块。按下按钮时，VSM 会为按钮的“(Button.Foreground).(SolidColorBrush.Color)”属性设置动画，该属性会传播到文本块，因此文本的颜色会发生变化。

如何将矩形的填充属性设置为相同的画笔？

我尝试了“{TemplateBinding Foreground}”、“{Binding Path=Foreground,RelativeSource={RelativeSource Self}}”，甚至在代码中创建了绑定（在 OnApplyTemplate 中）——要么根本不起作用，要么最初设置的颜色不是动画。我还尝试了元素到元素的绑定，将矩形的 Fill 属性绑定到 TextBlock 的 Foreground 属性，结果相同（初始颜色正常，而动画颜色不同）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T00:14:09.873

我认为这可能是 WP 7.1 中的一个错误。

找到了解决方法。为了使这一切正常工作：

*   在自定义控件模板中，指定`Fill="{TemplateBinding Foreground}"`
*   在按钮模板里面`<VisualState x:Name="Normal">`，设置正常状态的前景色。

当初始前景值来自`<Setter Property="Foreground" ...`按钮的样式时，当视觉状态管理器为前景值设置动画时，TextBlock 对象接收新值，但`<Rectangle Fill="{TemplateBinding Foreground}"`仍使用旧颜色绘制。

当初始值来自可视状态管理器时，自定义控件模板内的矩形正确地接收新的属性值，因为 VSM 动画颜色变化。

# php - php 短代码 html 输出

> ID：12230100
> 
> 赞同：0
> 
> 时间：2012-09-01T18:03:00.143
> 
> 标签：php, javascript, html, wordpress, shortcode

我有一个使用这个简码的插件：`[daisy]`

这个简码的 html 输出是：`<a class="clickable">Click Here</a>` 如果我使用简码触发插件，插件工作完美。它也适用于此：

`<?php echo do_shortcode('[daisy]'); ?>`

通常它也应该与

`<a class="clickable">Click Here</a>`直接但它不工作，链接出现，但如果我点击它没有任何反应。此简码触发一些 javascript 加载：

```
<script type="text/javascript">
    $(document).ready(function(){
        // Init Plugin
        $(".clickable").contactpopup({
            'style' : '<?php echo $wp_cpup_theme; ?>',
            'bgcolor' : '<?php echo $wp_cpup_color; ?>',
            'formelement' : '#Form_PopContactUs',
            'effect' : '<?php echo $wp_cpup_effect; ?>',
            'header' : '<?php echo $wp_cpup_popup_title; ?>'
        });
    });
</script> 
```

因此，它也应该适用于 html。

任何想法为什么如果我单击该`<a>`元素正在工作并且如果我使用
`<?php echo do_shortcode('[daisy]'); ?>`它会触发插件（联系表单弹出窗口）。

如果您想看一下，[这里是带有联系表格的演示。](http://themes.thevda.com/wordpress/contact-popup/)

有什么建议么 ？

短代码处理程序：

```
/*--------------------------------
               Shortcode
    ----------------------------------*/
    add_shortcode("daisy", "wp_contact_popup_short_code_handler");

    function wp_contact_popup_short_code_handler() {
      $demolph_output = wp_contact_popup_short_code_posts_function();
      return $demolph_output;
    }

    function wp_contact_popup_short_code_posts_function( $content = null ) {
        // Grab Globals
        global $wp_cpup_popup_link;
        global $wp_cpup_popup_email;
        global $wp_cpup_popup_thanks;
        global $wp_cpup_form_html;
        global $wp_cpup_email_message;

        ?> 
```

# jquery - 如果从另一个插件调用公共函数，如何使用公共函数插件的选项？

> ID：12230101
> 
> 赞同：0
> 
> 时间：2012-09-01T18:03:01.147
> 
> 标签：jquery, jquery-plugins

我想允许我的插件（插件 A）中的一个功能被另一个插件（插件 B、插件 C 等）使用。

插件 A 自然有用户可定义的选项。当插件 B 调用 A 中的函数时，我希望 B 能够引用 B 想要使用的选项对象/数组。

如果我在 A 内，那么获取选项并将它们传递给函数就足够简单了。但B不会有那么奢侈。B 唯一知道的是指定要使用的选项。它不会知道那里的值。

我应该使用 .data() 将选项存储在某个地方以便我可以随时访问它们吗？如果是这样，一个或两个示例的链接可能会有所帮助。

我希望我问的是正确的问题吗？再一次，请慢慢打字，我还在学习。谢谢。

-- 增加：以 50,000 英尺为例 --

我有一个用于 Google Analytics 的插件，它在链接的（“点击”，...）上执行 _gaq.push()。如果您不熟悉 GA 和事件跟踪，请参阅此处了解详细信息：

[https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#Anatomy](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#Anatomy)

该插件所做的一件事是定义 GA ET 参数的默认值。例如，不必像谷歌内联方法那样一遍又一遍地重复相同的设置，插件可以定义一个设置对象，然后在链接上使用数据属性来指定哪个对象（设置）插入 _gaq.push()。

到目前为止，我很好。

但是，自从我的插件的第一次迭代以来，我开始意识到还有其他插件可以在我的插件中使用 Google 通知功能。例如：

[http://imakewebthings.com/jquery-waypoints/](http://imakewebthings.com/jquery-waypoints/)

我可以定义一个航点，然后在滚动到达该航点时说“好的，触发 GA 事件并发送 GA 设置”。如果 Way Points 只询问一个功能，我怎样才能让该功能获得默认/选项？

再次，请原谅我没有使用正确的词典。我只是想传达我正在尝试做的事情。

# java - Java 不安全操作

> ID：12230111
> 
> 赞同：3
> 
> 时间：2012-09-01T18:04:59.833
> 
> 标签：java, vector, maps, unsafe

在编译一小段 Java 代码时，我会收到一条关于不安全操作的编译说明。我基本上只是希望了解如何更改数据结构以使其安全的概念。

概念：我需要根据长度将输入的字符串组织到存储桶中，长度可以是任意的（尽管少于 80 个字符）。

编码：

```
Map<Integer, List> buckets = new HashMap<Integer, List>();
            if(!buckets.containsKey(length))
            {
                buckets.put(length,new Vector<wordValues>());
            }
            //Now add the temp to the bucket
            buckets.get(length).add(new wordValues(temp)); 
```

然后我将字符串添加到与其大小相对应的列表中。

有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T18:07:00.847

你混合原始和泛型列表，尝试：

```
Map<Integer, List<wordValues>> buckets = new HashMap<Integer, List<wordValues>>(); 
```

此外，通常类名以大写开头，例如`WordValues`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T18:59:04.783

问题是您使用的是[*原始类型*](http://docs.oracle.com/javase/tutorial/java/generics/rawTypes.html) `List`而不是参数化[*泛型类型*](http://docs.oracle.com/javase/tutorial/java/generics/types.html) `List<WordValues>`。[Oracle Java 教程](http://docs.oracle.com/javase/tutorial/java/generics/index.html)中广泛介绍了泛型。

```
Map<Integer, List<WordValues>> buckets = new HashMap<>();
...
List<WordValues> values = buckets.get(length);
if (values == null) {
  values = buckets.put(length, new ArrayList<WordValues>());
}
values.add(new WordValues(temp)); 
```

一些花絮：

*   `containsKey`并且`get`两者都进行相同的查找。做两次似乎有点奇怪：-p
*   避免使用`Vector`有利于`ArrayList`. 如果需要同步，请考虑通过[`Collections.synchronizedList`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29).

    ```
    Collections.synchronizedList(new ArrayList<WordValues>()) 
    ```

*   Java 7 支持类型参数推断，可以显着减轻您的负担。注意上面我不必输入`HashMap<Integer, List<WordValues>>`；相反，我只是键入`HashMap<>`，利用新的*菱形运算符*。
*   避免使用以小写字符开头的类名；这通常很难阅读（并且违反了[Oracle 代码约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconvtoc-136057.html)）。考虑命名你的类`WordValues`而不是`wordValues`.

# php - PHP strftime 返回 false

> ID：12230112
> 
> 赞同：2
> 
> 时间：2012-09-01T18:05:03.367
> 
> 标签：php, strftime

我是签名`strftime("%e %B %Y", 1344557429)`

它返回`false`但它应该`"10 August 2012"`根据[http://php.net/manual/en/function.strftime.php以这种格式返回一个日期](http://php.net/manual/en/function.strftime.php)

问题可能出在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T18:07:48.257

先看说明书：

*   [http://php.net/manual/en/function.strftime.php](http://php.net/manual/en/function.strftime.php)

找到巨大的红框：

> 仅限 Windows：**此函数的 Windows 实现不支持 %e 修饰符。**为了达到这个值，可以使用 %#d 修饰符。下面的例子说明了如何编写一个跨平台兼容的函数。

虽然编写新代码是一种常见的做法，但将 error_reporting 设置为 E_ALL 以便您可以轻松找到错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-29T03:30:04.080

对于单个日期使用：

```
$format = '%B '.((strtoupper(substr(PHP_OS, 0, 3)) == 'WIN') ? '%#d' : '%e').', %Y';
$date = strftime($format, $unix_timestamp); 
```

PHP docs 解决方案作为一个功能很好：

```
function fixed_strftime($format, $unix_timestamp) {
    if (strtoupper(substr(PHP_OS, 0, 3)) == 'WIN') {
        $format = preg_replace('#(?<!%)((?:%%)*)%e#', '\1%#d', $format);
    }
    return strftime($format, $unix_timestamp);
} 
```

来源：[http ://codeitdown.com/php-strftime-e-on-windows/](http://codeitdown.com/php-strftime-e-on-windows/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:08:59.747

啊，找到了解决方案，感谢@Peter Szymkowski。我瞎了

```
<?php

// Jan 1: results in: '%e%1%' (%%, e, %%, %e, %%)
$format = '%%e%%%e%%';

// Check for Windows to find and replace the %e 
// modifier correctly
if (strtoupper(substr(PHP_OS, 0, 3)) == 'WIN') {
    $format = preg_replace('#(?<!%)((?:%%)*)%e#', '\1%#d', $format);
}

echo strftime($format);
?> 
```

# c++ - 对象已经定义，但我不确定在哪里

> ID：12230124
> 
> 赞同：3
> 
> 时间：2012-09-01T18:07:13.203
> 
> 标签：c++, visual-studio, fatal-error

我是 C++ 新手，错误代码对我来说并不是很有吸引力。

我正在尝试构建一个简单的 C++ OOP 程序作为家庭作业，但它将收集然后显示有关书籍等的信息。

我收到一个错误：

```
1>Book.obj : error LNK2005: "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall Author::getFullName(void)" (?getFullName@Author@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ) already defined in Author.obj
1>Book.obj : error LNK2005: "public: void __thiscall Author::setFirstName(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setFirstName@Author@@QAEXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Author.obj
1>Book.obj : error LNK2005: "public: void __thiscall Author::setLastName(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setLastName@Author@@QAEXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Author.obj
1>Publisher.obj : error LNK2005: "public: __thiscall Publisher::Publisher(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0Publisher@@QAE@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@00@Z) already defined in Book.obj
1>Publisher.obj : error LNK2005: "public: __thiscall Publisher::Publisher(void)" (??0Publisher@@QAE@XZ) already defined in Book.obj
1>Publisher.obj : error LNK2005: "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall Publisher::getPublisherInfo(void)" (?getPublisherInfo@Publisher@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ) already defined in Book.obj
1>Publisher.obj : error LNK2005: "public: void __thiscall Publisher::setAddress(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setAddress@Publisher@@QAEXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>Publisher.obj : error LNK2005: "public: void __thiscall Publisher::setCity(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setCity@Publisher@@QAEXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>Publisher.obj : error LNK2005: "public: void __thiscall Publisher::setName(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?setName@Publisher@@QAEXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) already defined in Book.obj
1>C:\Users\pc\Desktop\School\ITS 340\Labs\Lab 1\Lab 1\Debug\Lab 1.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

我在这里错过了什么吗？

**书本.cpp**

```
#include <iostream>
using namespace std;

#include "Author.cpp"
#include "Publisher.cpp"

class Book
{
    public:
        Book();
        Book(string title, Author *pAuthor, Publisher *pPublisher, double price);
        ~Book();
        void setTitle(string title);
        void setAuthorName(string first, string last);
        void setPublisher(string name, string address, string city);
        void setPrice(double price);
        string convertDoubleToString(double number);
        string getBookInfo();

    private:
        string title;
        double price;
        Author *pAuthor;
        Publisher *pPublisher;
};

Book::Book()
{
}

Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    title = title;
    price = price;
}

Book::~Book()
{
}

void Book::setTitle(string  title)
{
}

void Book::setAuthorName(string first, string last)
{
}

void Book::setPublisher(string name, string address, string city)
{
}

void Book::setPrice(double price)
{
}

string Book::convertDoubleToString(double number)
{
    return 0;
}

string Book::getBookInfo()
{
    return 0;
} 
```

**发布者.cpp**

```
#include <iostream>
using namespace std;

class Publisher
{
    public: 
        Publisher();
        Publisher(string name, string address, string city);
        string getPublisherInfo();
        void setName(string name);
        void setAddress(string address);
        void setCity(string city);

    private:
        string name;
        string address;
        string city;
};

Publisher::Publisher()
{
}

Publisher::Publisher(string name, string address, string city)
{
    name = name;
    address = address;
    city = city;
}

string Publisher::getPublisherInfo()
{
    return "0";
}

void Publisher::setName(string name)
{
    name = name;
}

void Publisher::setAddress(string address)
{
    address = address;
}

void Publisher::setCity(string city)
{
    city = city;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T18:09:15.747

你永远不应该`cpp`在另一个`cpp`文件或标题中包含一个文件。这几乎不可避免地会导致重复的对象定义。

将*声明*放入头文件，将*定义*放入 cpp 文件。在 cpp 文件中包含头文件，您需要访问其他 cpp 文件中定义的对象的方法。

举`Publisher.cpp`个例子：顶部到包括该`};`行的部分需要进入`Publisher.h`文件。其他所有内容都必须保留在`Publisher.cpp`. 此外，您需要添加`#include Publisher.h`到顶部`Publisher.cpp`，以及您需要包含的其他标题。

您还需要`using namespace std;`从标题中删除，并`std::string`在您的声明中使用。不过，可以放入`using`您的`cpp`文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T18:15:49.510

`#IFNDEF`如果您确实需要将一些 cpp 添加到另一个 cpp，请使用它来避免重复的对象定义。

像

```
#include <iostream>
using namespace std;
#ifndef CPPADDED
#define CPPADDED

class Publisher
{...}

#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T18:14:31.567

除了Dasblinkenlight所说的，

你的问题是你没有使用`ifndef`警卫。您应该使用它来避免此错误。快速搜索将为您提供如何添加标题的提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T18:24:09.663

创建头文件示例：resource.h 并将函数原型也放入类中。所以它看起来像：

```
#include <iostream>
#include <string>
using namespace std;
class Book
{
public:
    Book();
    Book(string title, Author *pAuthor, Publisher *pPublisher, double price);
    ~Book();
    void setTitle(string title);
    void setAuthorName(string first, string last);
    void setPublisher(string name, string address, string city);
    void setPrice(double price);
    string convertDoubleToString(double number);
    string getBookInfo();

private:
    string title;
    double price;
    Author *pAuthor;
    Publisher *pPublisher;
};
class Publisher
{
public: 
    Publisher();
    Publisher(string name, string address, string city);
    string getPublisherInfo();
    void setName(string name);
    void setAddress(string address);
    void setCity(string city);

private:
    string name;
    string address;
    string city;
};
class Author{
    //... prototypes
}; 
```

将 Book.cpp 编辑为此：

```
#include "resource.h"
Book::Book()
{
}

Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
title = title;
price = price;
}

Book::~Book()
{
}

void Book::setTitle(string  title)
{
}

void Book::setAuthorName(string first, string last)
{
}

void Book::setPublisher(string name, string address, string city)
{
}

void Book::setPrice(double price)
{
}

string Book::convertDoubleToString(double number)
{
    return 0;
}

string Book::getBookInfo()
{
    return 0;
} 
```

和 Publisher.cpp 到这个：

```
#include "resource.h"
Publisher::Publisher()
{
}

Publisher::Publisher(string name, string address, string city)
{
    name = name;
    address = address;
    city = city;
}

string Publisher::getPublisherInfo()
{
    return "0";
}

void Publisher::setName(string name)
{
    name = name;
}

void Publisher::setAddress(string address)
{
    address = address;
}

void Publisher::setCity(string city)
{
    city = city;
} 
```

并尝试对 Author.cpp 执行相同操作，因此将函数的原型（类）放入“resource.h”并将“resource.h”包含到 Author.cpp。

# html - 特定网站的 HTML Iframe 空白

> ID：12230127
> 
> 赞同：0
> 
> 时间：2012-09-01T18:07:21.400
> 
> 标签：html, iframe

我正在尝试制作这样的 iframe，`<iframe src="http://www.fonefinder.net"></iframe>`出现的只是一个空白区域。如果我用另一个链接替换链接，它工作正常。老实说，我不知道为什么会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:10:19.887

如果您检查控制台，您将看到一个错误

`Refused to display document because display forbidden by X-Frame-Options.`

作者不想让你陷害他/她的网站，你可以阅读更多关于它的信息

[克服“X-Frame-Options 禁止显示”](https://stackoverflow.com/questions/6666423/overcoming-display-forbidden-by-x-frame-options)

# c# - 使用 C# 或 Java 创建 32 位 DLL

> ID：12230135
> 
> 赞同：3
> 
> 时间：2012-09-01T18:08:09.223
> 
> 标签：c#, java, .net, dll, 32-bit

> **可能重复：**
> [将 .NET 应用程序转换为 x86 本机代码](https://stackoverflow.com/questions/1778878/converting-net-app-to-x86-native-code)

有没有办法使用 C# 或 Java 为 Windows 创建标准（不是 .NET 程序集类型）32 位 DLL？而对于WinCE ?? 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T22:49:43.427

这在其中一条评论中被引用，但我想将其发布为答案：

对于 C#： [https ://stackoverflow.com/a/1779505/490561](https://stackoverflow.com/a/1779505/490561)

基本上，这个想法是使用 Mono，然后使用 Ahead Of Time Compilation。我认为这可以解决问题。

对于 Java，这个想法是相似的： [https ://stackoverflow.com/a/2011727/490561](https://stackoverflow.com/a/2011727/490561)

# jquery - 如何将所有 td 包装成一个 tr 到我的 JQuery 代码？

> ID：12230136
> 
> 赞同：0
> 
> 时间：2012-09-01T18:08:08.543
> 
> 标签：jquery, html

```
var url = 'json/result.json';
$(document).ready(function() {
    $.getJSON(url, function(data) {
        $.each(data.video, function(index, video) {
            var row = $("<tr></tr>");                   
            $('#userDataGrid').append('<td>' + video.id + '</td>');
            $('#userDataGrid').append('<td>' + video.name + '</td>');
            $('#userDataGrid').append('<td>' + video.url + '</td>');
            $.each(video.author.data, function(index, author) {
                $('#userDataGrid').append('<td> Author: ' + author.name_author + '</td>');
            });
            $('#userDataGrid').append('<br/>');
        });
    });
    $("#userDataGrid p").addClass("selected highlight");
    console.log("========================");
    //console.log(data);
    console.log("========================");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:12:23.540

```
var row = $("<tr></tr>");                   
row.append('<td>Foo</td>');
row.append('<td>Bar</td>');
..
$('#userDataGrid').append(row); 
```

但这是正确使用附加的方法：

```
var row = '<tr>';
row += '<td>Foo</td>';
row += '<td>Bar</td>';
..
row += '</tr>';
$('#userDataGrid').append(row); 
```

资源：

*   [http://www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly](http://www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:15:52.367

```
 $.getJSON(url, function(data) {
    $.each(data.video, function(index, video) {
      var row_str= '<tr>';                   
      row_str += '<td>' + video.id + '</td>';
      row_str += '<td>' + video.name + '</td>';
      row_str += '<td>' + video.url + '</td>';

          $.each(video.author.data, function(index, author) {
              row_str += '<td> Author: ' + author.name_author + '</td>';
          });
      row_str += '<br/>';
      row_str += '</tr>';
      $('#userDataGrid').append(row_str);
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:14:23.393

你可以使用`wrapAll`方法。

```
$.each(data.video, function(index, video) {
    // ...
    $('#userDataGrid > td').wrapAll('<tr></tr>')
}); 
```

# c# - 在 PC 中使用网络摄像头作为环境光传感器

> ID：12230137
> 
> 赞同：3
> 
> 时间：2012-09-01T18:08:10.033
> 
> 标签：c#, windows, windows-8, webcam, .net-4.5

是否可以将 PC 的网络摄像头用作环境光传感器？我在 Windows 8 pro 中使用 .Net 4.5 框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:22:46.233

菲利普对这个问题的回答：[如何计算位图的平均 rgb 颜色值的](https://stackoverflow.com/questions/1068373/how-to-calculate-the-average-rgb-color-values-of-a-bitmap)代码将计算位图图像的平均 RGB 值（他的代码中的 bm）：

```
BitmapData srcData = bm.LockBits(
        new Rectangle(0, 0, bm.Width, bm.Height), 
        ImageLockMode.ReadOnly, 
        PixelFormat.Format32bppArgb);

int stride = srcData.Stride;

IntPtr Scan0 = dstData.Scan0;

long[] totals = new long[] {0,0,0};

int width = bm.Width;
int height = bm.Height;

unsafe
{
  byte* p = (byte*) (void*) Scan0;

  for (int y = 0; y < height; y++)
  {
    for (int x = 0; x < width; x++)
    {
      for (int color = 0; color < 3; color++)
      {
        int idx = (y*stride) + x*4 + color;

        totals[color] += p[idx];
      }
    }
  }
}

int avgR = totals[0] / (width*height);
int avgG = totals[1] / (width*height);
int avgB = totals[2] / (width*height); 
```

获得平均 RGB 值后，您可以使用 Color.GetBrightness 来确定它的亮度或暗度。GetBrightness 将返回一个介于 0 和 1 之间的数字，0 是黑色，1 是白色。你可以使用这样的东西：

```
Color imageColor = Color.FromARGB(avgR, avgG, avgB);
double brightness = imageColor.GetBrightness(); 
```

您还可以将 RGB 值转换为 HSL 并查看“L”，这可能更准确，我不知道。

# iphone - iOS - 编辑文本字段时禁用滚动

> ID：12230139
> 
> 赞同：-2
> 
> 时间：2012-09-01T18:08:50.503
> 
> 标签：iphone, ios, ipad, uiscrollview, uitextfield

我试图在编辑 uitextfiled 时禁用滚动（最好是所有背景触摸）。

这是场景：

我有一个带有几个文本字段的 ScrollView 设置。在编辑文本字段时，我向上/向下动画视图，以便文本字段将位于键盘/小键盘出现的正上方。在我将键盘样式更改为电话/数字键盘的情况下，我有一个带有完成按钮的子视图设置，可在编辑完成时关闭键盘。所有动画都按预期工作。但是，用户可以滚动背景并选择其他字段。我想禁用此功能，以便他们所能做的就是查看屏幕上显示的内容并编辑一个字段。

我尝试执行 [scrollView setUserInteractionEnabled:NO] 将滚动视图锁定到位，但是键盘无法在文本字段中输入信息。再次在键盘设置为电话/数字键盘的情况下，我的子视图出现，只是没有键盘。

我还尝试将正在编辑的文本字段设置为第一响应者，但这似乎完全弄乱了视图，可能是由于我的视图子视图的动画。

有没有办法让我仍然以我想要的方式为视图设置动画并禁用滚动视图的滚动，或者完全禁用该视图中的所有背景触摸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:13:58.360

使您的 viewController 成为 textField 的代表，并在`- (void)textFieldDidBeginEditing:(UITextField *)textField`禁用滚动中..`self.scrollView.scrollEnabled = NO;`并在 - (void)textFieldDidEndEditing:(UITextField *)textField 中再次设置滚动启用...

您还可以根据您的要求禁用所有其他文本字段。

```
self.otherTextField.userInteractionEnabled = NO; 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-25T09:17:18.773

尝试这个

```
- (void)textFieldDidBeginEditing:(UITextField *)textField{
    scrollView.scrollEnabled = NO;
}

- (void)textFieldDidEndEditing:(UITextField *)textField{
    scrollView.scrollEnabled = YES;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:11:39.277

你试过了吗：

```
scrollView.scrollEnabled = NO 
```

?

# iphone - 从网页加载图像，验证码，填充文本字段

> ID：12230141
> 
> 赞同：0
> 
> 时间：2012-09-01T18:09:05.310
> 
> 标签：iphone, objective-c, uiwebview, uitextfield, asihttprequest

晚上好。在我的应用程序中，我需要向需要验证码的网页发送请求。图片链接是一个 .php 文件，每次刷新页面时验证码都会发生变化。所以，如果我尝试“通过链接”下载图像，我有不同的验证码。解决办法是什么？任何的想法？先感谢您。

编辑：现在我必须填写输入并发送提交请求。这是我必须填写的文本字段的 html 源代码：

```
<label class="ins" for="targ">Targa del veicolo:</label>
<input id="targ" name="targa" value="" type="text" size="20" maxlength="8" tabindex="2" />

<label for="inCaptchaChars">Codice di sicurezza:</label>  <input type="text" id="inCaptchaChars" name="inCaptchaChars" tabindex="1004" onblur="ShutMeDown()"> 
```

这是关于提交按钮：

```
<input type="submit" name="procedi"  value="Calcola importo" /> 
```

我必须做什么才能继续？我必须使用 ASIHTTP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:32:48.093

这可能有点令人费解，但它应该可以正常工作：

使用 webView，加载页面，当加载的页面调用`stringByEvaluatingJavascript`获取图像大小和偏移量的 webview () 上的一些 javascript。将 WebView 框架调整为该大小，并将内容滚动到该偏移量。禁用用户交互并显示 webview。要获得元素偏移量，您可以使用[此答案](https://stackoverflow.com/questions/442404/dynamically-retrieve-html-element-x-y-position-with-javascript)

只需调用：

```
[[webView stringByEvaluatingJavascript:@"function getOffset(el) {  .....  }  getOffset( document.getElementById('yourElId') ).left;"] floatValue]; 
```

并不是说您必须将整个代码传递给此方法

提交验证码：和以前一样，调用

```
[webView stringByEvaluatingJavascript :@"document.getElementsByName('procedi')[0].value = 'your captcha';"]; 
```

然后做同样的事情来调用`.click()`提交按钮或`.submit()`表单

# wpf - 标签角半径

> ID：12230146
> 
> 赞同：1
> 
> 时间：2012-09-01T18:09:38.077
> 
> 标签：wpf, xaml, rounded-corners, cornerradius

我有一个停靠面板，其中包含从 Border 类继承的标签（矩形）数组，其中包含 CornerRadius 属性。所以，一切都很好，但是当我开始调整窗口大小或将标签添加到停靠面板时，它们的尺寸变窄了，并且角落保持与较大标签尺寸相同！例如，我有一个带有 CornerRadius 30 的大尺寸标签 300*300。它看起来不错，但是当我调整窗口大小（使其更小）时，它变成了圆形。

我试图实现特殊系数，但没有任何帮助。也许我犯了错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:50:07.097

`Border`是“保持”它的圆角半径，而不管它的实际大小。这通常是一件好事。

在您的情况下，我会使用 a `Path`（*注意：不是 a`Rectangle`*）。

使用 Expression Blend，您可以绘制`Rectangle`一定大小的 a，设置它的`RadiusX`和`RadiusY`属性，然后从中创建一条路径（菜单中有一个选项，位于 IIRC 的“工具”下）。路径将缩放（和扭曲）它的拐角半径。

话虽如此，您需要此功能做什么？也许 ViewBox 会在没有继承的情况下完成这项工作？

# ios - kGANPageScope 不显示自定义变量？

> ID：12230149
> 
> 赞同：0
> 
> 时间：2012-09-01T18:10:14.007
> 
> 标签：ios, google-analytics-api

我正在使用三个不同的范围跟踪我的应用程序中的自定义变量，如下面的代码所示。但是，当我在 Analytics 中查看我的报告时，只显示“访问者”和“会话”范围变量。页面变量似乎没有被记录（即“myCustomVariable1”和“myCustomVariable2”从未出现过。这是我第一次实现这个API，所以我一定遗漏了一些东西。

```
NSString *deviceModel = [[UIDevice currentDevice]model];
NSString *systemVersion = [[UIDevice currentDevice]systemVersion];

if (![[GANTracker sharedTracker] setCustomVariableAtIndex:1
                                                         name:@"DeviceModel"
                                                        value:deviceModel
                                                        scope:kGANVisitorScope 
                                                    withError:&error]) {
        NSLog(@"error in setCustomVariableAtIndex");
    }

if (![[GANTracker sharedTracker] setCustomVariableAtIndex:1
                                                         name:@"SystemVersion"
                                                        value:systemVersion
                                                        scope:kGANSessionScope 
                                                    withError:&error]) {
        NSLog(@"error in setCustomVariableAtIndex");
    }

NSString *myCustomVariable1 = @"myCustomVariable1";

if (![[GANTracker sharedTracker] setCustomVariableAtIndex:1
                                                         name:@"myCustomVariable1"
                                                        value:myCustomVariable1
                                                        scope:kGANPageScope
                                                    withError:&error]) {
        NSLog(@"error in setCustomVariableAtIndex");
    }

NSString *myCustomVariable2 = @"myCustomVariable2";

    if (![[GANTracker sharedTracker] setCustomVariableAtIndex:2
                                                         name:@"myCustomVariable2"
                                                        value:myCustomVariable2 
                                                        scope:kGANPageScope
                                                    withError:&error]) {
        NSLog(@"error in setCustomVariableAtIndex");
    } 
```

# ios - 禁用 iphone 键盘按钮

> ID：12230151
> 
> 赞同：0
> 
> 时间：2012-09-01T18:10:16.640
> 
> 标签：ios

有没有办法禁用 iPhone 键盘上的“，”按钮，或者至少阻止用户在我的 UITextField 中输入“，”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:14:05.433

是的。设置文本字段的委托，然后实现以下方法：

```
- (BOOL)textField:(UITextField *)tf shouldChangeCharactersInRange:(NSRange)r replacementString:(NSString *)str
{
    if (tf == theTextFieldYouWannaBehaveLikeThis) {
        if ([str isEqualToString:@","]) {
            return NO;
        }
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:16:28.633

a 有一个`keyboardType`属性`UITextField`：

```
typedef enum {
    UIKeyboardTypeDefault,                // Default type for the current input method.
    UIKeyboardTypeASCIICapable,           // Displays a keyboard which can enter ASCII characters, non-ASCII keyboards remain active
    UIKeyboardTypeNumbersAndPunctuation,  // Numbers and assorted punctuation.
    UIKeyboardTypeURL,                    // A type optimized for URL entry (shows . / .com prominently).
    UIKeyboardTypeNumberPad,              // A number pad (0-9). Suitable for PIN entry.
    UIKeyboardTypePhonePad,               // A phone pad (1-9, *, 0, #, with letters under the numbers).
    UIKeyboardTypeNamePhonePad,           // A type optimized for entering a person's name or phone number.
    UIKeyboardTypeEmailAddress,           // A type optimized for multiple email address entry (shows space @ . prominently).

    UIKeyboardTypeAlphabet = UIKeyboardTypeASCIICapable, // Deprecated

} UIKeyboardType; 
```

# android - 语音识别不工作

> ID：12230153
> 
> 赞同：0
> 
> 时间：2012-09-01T18:10:36.227
> 
> 标签：android, voice-recognition, android-logcat

我使用了现有的语音识别示例代码。但这段代码在我的 eclipse 中不起作用。我在我的 logcat 中出现以下错误。但这段代码在其他人中完美运行。我参考了很多教程，但我不清楚我把错误放在哪里?

我的代码：

```
public class MainActivity extends Activity {
     private static final int REQUEST_CODE = 1234;
        private ListView wordsList;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button speakButton = (Button) findViewById(R.id.speakButton);

        wordsList = (ListView) findViewById(R.id.list);

        // Disable button if no recognition service is present
        PackageManager pm = getPackageManager();
        List<ResolveInfo> activities = pm.queryIntentActivities(
                new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH), 0);
        if (activities.size() == 0)
        {
            speakButton.setEnabled(false);
            speakButton.setText("Recognizer not present");
        }
    }

    /**
     * Handle the action of the button being clicked
     */
    public void speakButtonClicked(View v)
    {
        startVoiceRecognitionActivity();
    }

    /**
     * Fire an intent to start the voice recognition activity.
     */
    private void startVoiceRecognitionActivity()
    {
        Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
                RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "Voice recognition Demo...");
        startActivityForResult(intent, REQUEST_CODE);
    }

    /**
     * Handle the results from the voice recognition activity.
     */
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        if (requestCode == REQUEST_CODE && resultCode == RESULT_OK)
        {
            // Populate the wordsList with the String values the recognition engine thought it heard
            ArrayList<String> matches = data.getStringArrayListExtra(
                    RecognizerIntent.EXTRA_RESULTS);
            wordsList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,
                    matches));
        }
        super.onActivityResult(requestCode, resultCode, data);
    } 
```

日志猫：

```
09-01 23:29:39.441: E/AndroidRuntime(225): Uncaught handler: thread main exiting due to uncaught exception
09-01 23:29:39.580: E/AndroidRuntime(225): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.voicerecog/com.example.voicerecog.MainActivity}: java.lang.NullPointerException
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2401)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2417)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread.access$2100(ActivityThread.java:116)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1794)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.os.Looper.loop(Looper.java:123)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread.main(ActivityThread.java:4203)
09-01 23:29:39.580: E/AndroidRuntime(225):  at java.lang.reflect.Method.invokeNative(Native Method)
09-01 23:29:39.580: E/AndroidRuntime(225):  at java.lang.reflect.Method.invoke(Method.java:521)
09-01 23:29:39.580: E/AndroidRuntime(225):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
09-01 23:29:39.580: E/AndroidRuntime(225):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:549)
09-01 23:29:39.580: E/AndroidRuntime(225):  at dalvik.system.NativeStart.main(Native Method)
09-01 23:29:39.580: E/AndroidRuntime(225): Caused by: java.lang.NullPointerException
09-01 23:29:39.580: E/AndroidRuntime(225):  at com.example.voicerecog.MainActivity.onCreate(MainActivity.java:38)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1123)
09-01 23:29:39.580: E/AndroidRuntime(225):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2364)
09-01 23:29:39.580: E/AndroidRuntime(225):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T00:27:03.123

请检查`R.id.speakButton`布局中是否存在`activity_main.xml`。如果不存在 findviewbyid 则返回 null。

# c++ - 为什么没有在范围内声明字符串

> ID：12230156
> 
> 赞同：32
> 
> 时间：2012-09-01T18:11:01.663
> 
> 标签：c++, boost-thread

我有以下代码：

```
#include <string>
#include <boost/thread/tss.hpp>

static boost::thread_specific_ptr<string> _tssThreadNameSptr; 
```

我收到以下错误

> g++ -c -I$BOOST_PATH tssNaming.h
> 
> tssNaming.h:7：错误：未在此范围内声明“字符串”

但我在我的`#include`.

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-01T18:12:14.920

您必须使用`std::string`它，因为它在`std`命名空间中。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-01T18:30:07.323

`string`位于`std`命名空间中。您有以下选择：

*   在包含后写入`using namespace std;`并启用所有`std`名称：然后您只能`string`在您的程序上写入。
*   在 include 之后写入`using std::string`以启用`std::string`：然后您只能`string`在您的程序上写入。
*   使用`std::string`代替`string`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-04-17T01:11:39.857

我发现包括：

```
using namespace std; 
```

您的 C++ 代码可以节省大量调试时间，尤其是在像您这样需要 std:: 字符串的情况下，它还有助于保持代码清洁。

考虑到这一点，您的代码应该是：

```
#include <string>
using namespace std;
#include <boost/thread/tss.hpp>

static boost::thread_specific_ptr<string> _tssThreadNameSptr; 
```

# c# - DbProviderFactory 代码与在 ADO.Net 中创建 SqlConnection 的代码关系

> ID：12230159
> 
> 赞同：1
> 
> 时间：2012-09-01T18:11:34.283
> 
> 标签：c#, ado.net, sqlconnection

当我在 ADO.Net 中实例化一个 SqlConnection 对象时，此代码是否会导致相应 DbProviderFactory 代码的执行？因此，当块 2 中的代码被执行时，我们实际上最终会执行块 1 中的代码。**但我不确定这是否属实。**

**代码块 1 - 使用 DbProviderFactory 方法实例化 SqlConnection**

```
DbProviderFactory factory =
DbProviderFactories.GetFactory(providerName);

connection = factory.CreateConnection();
connection.ConnectionString = connectionString; 
```

**代码块 2 - 使用标准 ADO.Net 代码实例化 SqlConnection**

```
SqlConnection con = new SqlConnection(connectionString); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:57:00.787

我查看了一些*.net Framework 程序集*，发现以下内容

`DbProviderFactories.GetFactory(providerName)`将根据给*定的 providerName*返回一个 Factory 对象。假设*providerName 表示一个 SQL Provider*，所以我们将得到一个`SqlClientFactory`.

之后`factory.CreateConnection()`会被调用。在这种情况下`SqlClientFactory.CreateConnection()`，将调用其实现为

```
public override DbConnection CreateConnection()
{
    return new SqlConnection();
} 
```

我认为**您的问题的答案**是调用**工厂方法将调用提供者特定类的方法，**而不是相反！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-06T22:39:51.620

要确定发生了什么，请考虑删除代码块 2 - 它不是必需的，并且会增加复杂性。只需使用工厂功能来使用连接。例如，您有：

```
DbProviderFactory factory =
DbProviderFactories.GetFactory(providerName);

connection = factory.CreateConnection();
connection.ConnectionString = connectionString; 
```

添加以下内容：

```
try
{
  connection.Open();
  var command = connection.CreateCommand();
  command.CommandText = "SELECT * FROM mytable";
  (..etc...) 
```

我们必须连接到 MS SQL 或 Oracle，这取决于用户的偏好，这对我们来说非常有效，唯一独特的是提供程序、连接字符串和命令文本。[Microsoft在此处](http://msdn.microsoft.com/en-us/library/dd0w4a2z%28v=vs.110%29.aspx)展示了如何从 machine.config 中提取提供程序的示例。

希望这会有所帮助，如果我不正确，请告诉我！

# objective-c - NSWindow orderOut - 有没有办法等待窗口关闭？

> ID：12230163
> 
> 赞同：2
> 
> 时间：2012-09-01T18:11:50.710
> 
> 标签：objective-c, macos, nswindow

在我的程序中，我有一个窗口，用户将其放置在屏幕上他想要拍照的部分上。

然后，当他单击按钮拍照时，我的程序`orderOut`是窗口，截取屏幕截图，然后再次显示窗口，现在里面有屏幕截图。

问题是，`orderOut`似乎没有立即关闭窗口。所以当我截屏时，它通常会截取窗口本身的截图（应该已经关闭），这显然不是我想要的。

我已经能够通过在调用`sleep(1)`后调用来回避问题`orderOut`，但肯定有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:12:32.460

根据[此处](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/doc/uid/20000013-BCIBHEIE)的文档。当您调用 orderOut 时，窗口会播放动画。因此，您可以通过将动画行为设置为 none 来删除 orderOut 动画：

```
[myWindow setAnimationBehavior:NSWindowAnimationBehaviorNone] 
```

或使用 NSObject 方法**performSelector:withObject:afterDelay:**在一定时间 x 后执行屏幕截图操作。假设 NSWindow orderOut 动画使用默认持续时间，则延迟将为 0.2f。否则，您可以进行一些测试以检查适合您情况的值。

# properties - VB6 错误中的属性使用无效。如何解决这个问题？

> ID：12230164
> 
> 赞同：0
> 
> 时间：2012-09-01T18:11:53.043
> 
> 标签：properties, vb6

```
Private Sub aTbBar_Change()
    Set con = New ADODB.Connection
    With con
        .CursorLocation = adUseClient
        .ConnectionString = "Provider=Microsoft.jet.oledb.4.0;persist security info=false;data source=" & App.Path & "\Event_Participants.accde"
        .Open
    End With

    Set rs = New ADODB.Recordset
    With rs
        Set .ActiveConnection = con
        .CursorType = adOpenDynamic
        .Source = "select * from Participants"
        .Open

        'check from table if user and pwd matches
        If rs.RecordCount <> 0 Then
            rs.MoveFirst
            While Not rs.EOF
                If rs!Bar_Code_No = Val(Me.aTbBar) Then
                    Me.aTbName = rs!Full_Name
                    Me.aTbSection = rs!Section
                    Me.aTbArrtime = Time()
                End If
                rs.MoveNext
            Wend
        End If

        .Close
        Set rs = Nothing

    End With

    'save to the database
    'check from table if user and pwd matches

    Set rs = New ADODB.Recordset
    With rs
        Set .ActiveConnection = con
        .CursorType = adOpenDynamic
        .LockType = adLockOptimistic
        .Source = "select * from Participants"
        .Open

        If rs.RecordCount <> 0 Then
            rs.MoveFirst
            While Not rs.EOF
                If rs!Bar_Code_No = Val(Me.aTbBar) Then
                    .Update
                    rs!Arr_Time = Me.aTbArrtime
                End If
                rs.MoveNext
            Wend
        End If

    End With

    rs.Close
    Set rs = Nothing

End Sub 
```

当我输入到该文本框名称 aTbBar 时，总是发生 Invalid Use of Proper 错误。错误发生在 Me.aTbName = rs!Full_Name。你能帮我解决这个问题吗？对不起，我是这个论坛和 VB 的新手。我真的需要帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T05:31:03.103

为 TextBox 触发的默认属性是该`Text`属性。因此，如果有一个名称为 的 TextBox `Text1`，则此语句：`Text1 = "Hello"`将等效于`Text1.Text = "Hello"`. 但我总是更喜欢在访问它时使用属性名称和控件名称（即，`Text1.Text = "Hello"`）。

无论如何，请使用以下行进行测试：`Me.aTbArrtime.text = rs!Full_Name`

我想到的另一件事是，如果您使用了其他组件，例如自定义的 TextBox 控件（而不是默认控件），并且在加载失败的情况下，VB 将替换控件（自定义的文本框）在您的表单中使用 PictureBox。要检查这一点，请单击表单中的 TextBox 并查看它的属性。并查看控件类型是否为TextBox。如果是 PictureBox，请仔细检查项目中是否存在自定义文本框的 OCX 或 DLL。

关于您的 SQL 代码的一个小建议是，您可以在查询本身中包含比较，而不是遍历所有记录。例如：

```
.Source = "select * from Participants WHERE Bar_Code_No = " & Val(Me.aTbBar.Text) & " LIMIT 1" 
```

如果它与`Bar_Code_No`. 执行此查询后，您只需要检查它是否返回任何记录。如果是，则找到匹配项。否则，找不到匹配项。通过这种方式，您可以避免循环，如果表中的记录数量`Participants`非常大，这可能会使您的程序无响应！

希望这会对你有所帮助。祝你好运 ：）

# php - 填写错误后如何让表单保存用户数据

> ID：12230173
> 
> 赞同：0
> 
> 时间：2012-09-01T18:13:21.597
> 
> 标签：php, forms

我试图让我的表单在哪里，如果用户输入数据并且它不正确，它会将它们发送回表单以修复那里的错误。我的问题是它总是会清除所有其他内容。有没有办法让我自动保存并重置需要修复的内容？

我知道我可能可以使用 $_POST 但我想知道是否有更快的方法。

感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:16:44.647

您可以制作一个 Javascript 验证器，它会提醒您，如果未填写所有必需的输入，但禁用 JS，您仍然必须使用 $_POST 重新填充输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:15:28.903

在将用户送回之前，将 $_POST 数据保存到会话变量中。从表单页面上的该变量加载数据并使用它来填写字段（当然`unset`，当您不再需要数据时该变量）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T18:19:12.770

首先，您应该使用[html5 输入类型](http://www.w3schools.com/html5/html5_form_input_types.asp)s，这样您就不需要使用 javascript 验证输入字段。

其次，对必填字段使用 required 属性。

我希望这有帮助。

# qt - QProcess 限制协助

> ID：12230174
> 
> 赞同：0
> 
> 时间：2012-09-01T18:13:29.437
> 
> 标签：qt, batch-file, qt4

大家好，我已经解决了 QProcess 的限制。如果我使用“|” 然后它跳过这个过程，但我需要那个'|' 我的过程中的角色

假设我有一个 exe，我需要 '|' 在它的参数列表中然后它不起作用，因为命令提示符需要'|' 作为或。因此它跳过了前面的部分。

```
e.g: myfile.exe arguments1 | arguments2 
```

现在在上面的代码中你可以看到'|' 分隔两个参数的参数，myfile.exe 需要它来执行操作，但由于 '|' 字符它跳过之前的部分，它给我输出为

```
'arguments2' is not recognized as internal or external, operable program or  batch file 
```

我该如何克服这种奇怪的情况？我需要'|' 在我的参数列表中，但进程将其识别为 OR。

给大家说一下实际情况吧。我正在尝试使用提取 .cpio.gz 存档

```
gzip -d -c myarchive.cpio.gz | cpio -i 
```

但由于| 在参数中我得到输出为

```
'cpio' is not recognized as internal or external, operable program or  batch file 
```

但是如果我在 ubuntu 中运行 gzip 的移植 linux 二进制文件，那么它会完全按照我的意愿工作，因为 linux 终端无法识别 | 作为或

请问我需要帮助 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:39:25.587

QProcess 正在做你想做的事：将整行命令传递给 shell。问题是您要么没有`cpio`安装第二个程序，要么它不在 Qt 可执行文件的 PATH 环境中。

当您在（我假设）Windows 命令提示符中输入该命令时，该命令行是否有效？

顺便提一句。竖线字符是[管道](http://en.wikipedia.org/wiki/Pipeline_%28Unix%29)，而不是 .exe 的参数。这行命令实际上调​​用了 2 个单独的程序。

# model-view-controller - 使用 Expressjs、Mongoose 和 Backbonejs 在 MVC 应用程序中进行层分离

> ID：12230175
> 
> 赞同：1
> 
> 时间：2012-09-01T18:13:48.070
> 
> 标签：model-view-controller, node.js, mongodb, mongoose, express

我想创建一个可以将功能分离到模块中的应用程序，有点像 WordPress。

（到目前为止）决定使用的技术是 Expressjs、Mongoose 和 Backbonejs。第一个问题是，我是否遗漏了为此类应用程序推荐的任何技术？（我知道这是主观的，但我正在寻找意见）

至于我的非主观问题。我对这些技术还很陌生，看起来 Mongoose 的模型实际上充当了我可以在我的应用程序中实例化和使用的对象。我觉得这并没有在模型层和其他层之间提供任何级别的分离。IE。如果我要删除 Mongoose，它将紧密地编织在应用程序中。

有一个单独的定义来定义每个实体是什么，然后在模型层连接到 Mongoose 以保存到数据库，或者这会破坏 Mongoose 的目的，这会是一个更好的主意吗？

我正在努力解决的部分问题是每个框架在系统中扮演的角色......如果我在这里误解，请原谅我。

# ruby-on-rails - 第二次统一化常量，但不是第一次访问生产中的变量

> ID：12230176
> 
> 赞同：2
> 
> 时间：2012-09-01T18:13:48.523
> 
> 标签：ruby-on-rails, ruby, will-paginate

我为 will_paginate 制作了一个自定义链接渲染器，并将代码放在 lib/my_link_renderer.rb

```
require 'will_paginate/view_helpers/link_renderer'
require 'will_paginate/view_helpers/action_view'

class MyLinkRenderer < WillPaginate::ActionView::LinkRenderer
  include ListsHelper
  def to_html
    html = pagination.map do |item|
      item.is_a?(Fixnum) ?
        page_number(item) :
        send(item)
    end.join(@options[:link_separator])
    html << @options[:extra_html] if @options[:extra_html]

    @options[:container] ? html_container(html) : html
  end
end 
```

然后我像这样使用它：

```
 <%= will_paginate @stuff, 
        :previous_label=>'<input class="btn" type="button" value="Previous"/>',
        :next_label=>'<input class="btn" type="button" value="Next" />',
        :extra_html=>a_helper,
        :renderer => 'WillPaginate::ActionView::MyLinkRenderer'
  %> 
```

它第一次工作，但第二次我得到一个未初始化的常量 WillPaginate::ActionView::MyLinkRenderer 错误。我相信我在我的 config/application.rb 中正确地将文件从 lib 加载到我的应用程序中：

```
# Custom directories with classes and modules you want to be autoloadable.
# config.autoload_paths += %W(#{config.root}/extras)
config.autoload_paths += %W(#{config.root}/lib)
config.autoload_paths += Dir["#{config.root}/lib/**/"] 
```

我在控制台中遇到了同样的问题。

```
system :001 > WillPaginate::ActionView::MyLinkRenderer
 => MyLinkRenderer 
system :002 > WillPaginate::ActionView::MyLinkRenderer
NameError: uninitialized constant WillPaginate::ActionView::MyLinkRenderer 
```

怀疑这与rails如何自动加载事物有关。我不应该使用自动加载吗？我应该明确要求'./lib/my_link_renderer'吗？

我应该注意到这只发生在我的生产服务器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:31:15.617

您的`MyLinkRenderer`课程不在`WillPaginate::ActionView`模块中，因此将其称为`WillPaginate::ActionView::MyLinkRenderer`永远不会起作用。

您应该将其称为`MyLinkRenderer`（不带模块名称）或将其定义为该模块中，并将其移至`lib/will_paginate/action_view/my_link_renderer.rb`：

```
module WillPaginate::ActionView
  class MyLinkRenderer < LinkRenderer
    …
  end
end 
```

它第一次工作的事实是 Rails`const_missing`用来实现自动加载的方式的一个怪癖。如果您好奇，请参阅此答案：[https ://stackoverflow.com/a/10633531/5168](https://stackoverflow.com/a/10633531/5168)

# sql - SQL for balance due without grouping all select

> ID：12230180
> 
> 赞同：2
> 
> 时间：2012-09-01T18:14:08.603
> 
> 标签：sql, postgresql, group-by

我已经提供了我的表的摘要，并且我在 SQL 方面有了一个良好的开端，但我一直在弄清楚如何限制返回的项目数量。我应该能够选择一个或多个条款，并从这些条款中取回应得的余额。

一个学生应该有 1 条记录，他们可以在多个学期进行多次预订，但付款不是针对预订的，而是针对学生的。那是让我失望的部分。

下面是表结构、日期和我的 SQL 的开始。有人可以帮我吗？此结果不应显示 Sue Smith 从第 3 学期开始支付的 500 美元。

我正在使用 PostgreSQL，但我认为这是一个非常基本的问题，不需要任何特定于 Postgres 的东西。

## 当前结果集：

```
Student ID  Last        First   Total Fees  Reservation Count   Amount Paid Amount Due
123456      Jones       Amy     50          1                   50          0
412365      Smith       Sue     100         3                   545         -445
741258      Anderson    Jon     50          1                   0.00        50.00
963258      Holmes      Fred    100         2                   30          70 
```

## 架构：

```
SET search_path TO temp, public;
CREATE TABLE term
(term_id                SERIAL PRIMARY KEY,
term_title              VARCHAR(100));

CREATE TABLE student
(student_id                 SERIAL PRIMARY KEY,
student_sis_id              VARCHAR(15),   
student_first_name              VARCHAR(30),
student_last_name               VARCHAR(100)); 

CREATE TABLE reservation
(reservation_id                      SERIAL PRIMARY KEY,
student_id                          INTEGER REFERENCES student ON UPDATE CASCADE,
term_id                             INTEGER REFERENCES term ON UPDATE CASCADE,   
reservation_fee_amount              NUMERIC DEFAULT 0.00);

CREATE TABLE payment
(payment_id                  SERIAL PRIMARY KEY,
student_id                  INTEGER REFERENCES student ON UPDATE CASCADE,
term_id                     INTEGER REFERENCES term ON UPDATE CASCADE,
payment_cash_amount         NUMERIC,
payment_credit_card_amount  NUMERIC,
payment_check_amount        NUMERIC);

INSERT INTO term VALUES (DEFAULT, 'SESSION 1');
INSERT INTO term VALUES (DEFAULT, 'SESSION 2');
INSERT INTO term VALUES (DEFAULT, 'SESSION 3'); 

INSERT INTO student VALUES (DEFAULT, 412365, 'Sue', 'Smith');
INSERT INTO student VALUES (DEFAULT, 123456, 'Amy', 'Jones');
INSERT INTO student VALUES (DEFAULT, 741258, 'Jon', 'Anderson');
INSERT INTO student VALUES (DEFAULT, 963258, 'Fred', 'Holmes');

INSERT INTO reservation VALUES (DEFAULT, 1, 1, 50);
INSERT INTO reservation VALUES (DEFAULT, 1, 2, 50);
INSERT INTO reservation VALUES (DEFAULT, 2, 1, 50);
INSERT INTO reservation VALUES (DEFAULT, 3, 2, 50);
INSERT INTO reservation VALUES (DEFAULT, 4, 1, 50);
INSERT INTO reservation VALUES (DEFAULT, 4, 2, 50);
INSERT INTO reservation VALUES (DEFAULT, 1, 3, 50);

INSERT INTO payment VALUES (DEFAULT, 1, 1, 25, 0, 0);
INSERT INTO payment VALUES (DEFAULT, 1, 1, 0, 20, 0);
INSERT INTO payment VALUES (DEFAULT, 2, 1, 25, 25, 0);
INSERT INTO payment VALUES (DEFAULT, 4, 1, 10, 10, 10);
INSERT INTO payment VALUES (DEFAULT, 1, 3, 500, 0, 0); 
```

## 查询：

```
SELECT      
    student.student_sis_id AS "Student ID",        
    student.student_last_name AS Last,
    student.student_first_name AS First,
    SUM(reservation.reservation_fee_amount) AS "Total Fees",
    (
        SELECT COUNT(reservation.reservation_id)
        FROM reservation
        WHERE student.student_id = reservation.student_id
    ) AS "Reservation Count",
    (
        SELECT 
            COALESCE(SUM(
                payment.payment_check_amount
                + payment.payment_cash_amount
                + payment.payment_credit_card_amount
            ), 0.00)  
        FROM payment 
        WHERE payment.student_id = student.student_id
    ) AS "Amount Paid",
    SUM(reservation.reservation_fee_amount) - (
        SELECT 
            COALESCE(SUM(
                payment.payment_check_amount
                + payment.payment_cash_amount
                + payment.payment_credit_card_amount
            ), 0.00)  
        FROM payment WHERE payment.student_id = student.student_id
    ) AS "Amount Due" 
FROM 
    student
    INNER JOIN reservation ON student.student_id = reservation.student_id  
WHERE reservation.term_id IN (1,2)
GROUP BY
    student.student_id, 
    student.student_sis_id,        
    student.student_last_name,
    student.student_first_name
ORDER BY 
    student.student_sis_id
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:50:00.357

这是我的查询的更新版本：

```
SELECT      
    s.student_sis_id AS "Student ID",        
    s.student_last_name AS Last,
    s.student_first_name AS First,
    SUM(r.reservation_fee_amount) AS "Total Fees",
    COUNT(r.reservation_id) AS "Reservation Count",
    COALESCE(
        SUM(
            p.payment_check_amount
            + p.payment_cash_amount
            + p.payment_credit_card_amount
        ), 0.00
    ) AS "Amount Paid",
    SUM(r.reservation_fee_amount) - (
        COALESCE(
            SUM(
                p.payment_check_amount
                + p.payment_cash_amount
                + p.payment_credit_card_amount
            ), 0.00
        )  
    ) AS "Amount Due" 
FROM 
    student s
    INNER JOIN reservation r ON s.student_id = r.student_id  
    LEFT JOIN payment p ON p.student_id = r.student_id AND p.term_id = r.term_id
WHERE r.term_id IN (1,2)
GROUP BY
    s.student_id, 
    s.student_sis_id,        
    s.student_last_name,
    s.student_first_name
ORDER BY 
    s.student_sis_id
; 
```

看点：

*   我包含`payments`在主（外部）查询中以避免子查询

*   连接类型是`LEFT [OUTER] JOIN`，因此缺少任何`payment`行不会阻止其他数据出现在结果集中

*   加入条件包括`term_id`（基本上这是你迷路的地方，我想）

*   最后我使用短表别名来提高可读性。

我希望这就是你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:27:27.870

找到了 2 付款输入问题的解决方案（我在最初的问题中没有认识到）。这是答案：

```
set search_path to temp, public;
SELECT      
s.student_sis_id AS "Student ID",        
s.student_last_name AS "Last Name",
s.student_first_name AS "First Name",
SUM(r.reservation_fee_amount) AS "Total Fees",
COALESCE(p.paid, 0.00) AS "Amount Paid",
COALESCE(SUM(r.reservation_fee_amount) - p.paid, 0.00) AS "Amount Due"    
FROM 
    student s       
    INNER JOIN reservation r ON s.student_id = r.student_id
    left outer join 
    (
      select student_id, term_id,
        SUM(
            p.payment_check_amount
            + p.payment_cash_amount
            + p.payment_credit_card_amount
        ) AS "paid" 
      from payment p
      group by student_id, term_id
    ) as p 
    ON p.student_id = r.student_id AND p.term_id = r.term_id
        WHERE r.reservation_completed  AND  r.term_id IN (1,2)                      
GROUP BY
    s.student_sis_id,        
    s.student_last_name,
    s.student_first_name,
    p.paid
ORDER BY 
    s.student_sis_id 
```

谢谢 dezso 和 davek

# linux - *nix 中命令和系统调用名称后面的数字是什么意思？

> ID：12230181
> 
> 赞同：4
> 
> 时间：2012-09-01T18:14:10.610
> 
> 标签：linux, posix, system-calls, freebsd, manpage

我经常在手册页或其他文档中看到带有数字后缀的命令或系统调用名称，例如[`splice(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/splice.2.html). 虽然，一些出版物不包括数字，例如，[维基百科上的拼接](http://en.wikipedia.org/wiki/Splice_(system_call))。

我从来没有找到关于数字代表什么的解释，甚至不知道从哪里/如何开始搜索。

1.  这些数字是什么意思？
2.  这些数字的范围是多少？
3.  为什么它们以函数和命令名称为后缀？
4.  哪些社区使用这些数字？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-01T18:15:25.077

这些数字指的是 Unix 手册部分。

```
1   Commands available to users
2   Unix and C system calls
3   C library routines for C programs
4   Special file names
5   File formats and conventions for files used by Unix
6   Games
7   Word processing packages
8   System administration commands and procedures 
```

您可以`man`通过仅列出节号来使用命令指定节号：

```
man 1 somecommand 
```

将`somecommand`在手册页的第 1 节中查找。

Wikipedia 对此有一些[附加信息](http://en.wikipedia.org/wiki/Man_page#Manual_sections)，本页也有关于[如何使用手册页](http://www.cyberciti.biz/faq/howto-use-linux-unix-man-pages/)的信息。

# python - Python- Selenium Webdriver 打开 Firefox 窗口但不打开 url

> ID：12230183
> 
> 赞同：1
> 
> 时间：2012-09-01T18:14:13.857
> 
> 标签：python, firefox, selenium, selenium-webdriver

我在代理网络后面。我有我的python脚本的一部分：

```
PROXY_HOST = "10.3.100.212"

PROXY_PORT = 8080

fp = webdriver.FirefoxProfile()

fp.set_preference("network.proxy.type", 1)

fp.set_preference("network.proxy.http", PROXY_HOST)

fp.set_preference("network.proxy.http_port", PROXY_PORT)

fp.set_preference("network.proxy.ftp", PROXY_HOST)

fp.set_preference("network.proxy.ftp_port", PROXY_PORT)

fp.set_preference("network.proxy.ssl", PROXY_HOST)

fp.set_preference("network.proxy.ssl_port", PROXY_PORT)

fp.set_preference("network.proxy.no_proxies_on", "localhost,127.0.0.1") 

br = webdriver.Firefox(firefox_profile=fp)

br.get("http://google.com") 
```

脚本运行后，Firefox 窗口打开，但没有加载 url。我检查了设置，它是正确的，当我在该窗口中手动输入 google.com 时，它会打开。请告诉我如何直接打开任何网址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:46:51.177

我在 Ubuntu 上遇到了同样的问题。我通过使用代理设置删除这一行来解决它

fp.set_preference("network.proxy.http", PROXY_HOST)

# javascript - 将文件从 Windows Explorer 拖放到 Internet Explorer

> ID：12230184
> 
> 赞同：3
> 
> 时间：2012-09-01T18:14:18.763
> 
> 标签：javascript, internet-explorer, drag-and-drop

我正在做一些老式的 IE，并试图从 Windows 资源管理器拖放到 IE 工作。我收到了放置事件，但该`dataTransfer`对象不包含文件名。`getData("Text")`也是`null`。我错过了什么？

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>DnD</title>
  <script src="scripts/jquery-1.7.2.min.js"></script>
</head>
<body>
  <div id="dropstuff">drop stuff here</div>
  <script>
    $(function () {
      var dropTarget = $("#dropstuff");

      dropTarget.bind("dragenter dragover", function () {
        window.event.returnValue = false;
        return false;
      });

      dropTarget.bind("drop", function (e) {
        window.event.returnValue = false;
        var file = e.originalEvent.dataTransfer.getData("Url");
        // file is null!
        return false;
      });
    });
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T17:48:39.100

IE真的不擅长支持东西。

您应该使用特殊的插件，即[https://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)或[http://www.plupload.com/](http://www.plupload.com/)或者您可能想在 Flash 上找到解决方案。但这可能需要一些时间。

我建议您以组织方式解决此问题：通过在 IE 中显示部分功能兼容性的警告来建议用户使用现代浏览器。

# php - 如果未选择任何内容，请从 php 的下拉列表中选择所有值

> ID：12230185
> 
> 赞同：0
> 
> 时间：2012-09-01T18:14:19.133
> 
> 标签：php, sql-server-2005

我有一个类似于下面的 sql 存储过程：

```
create procedure procedurename
declare @startdate datetime, @enddate endtime, @field1 varchar(15) = null

select * from table1
where field1 = @field1 or @field1 is null
and date between @startdate and @enddate 
```

而当我想显示来自 field1 的所有值时，我只是忽略在执行时提供参数@field1，如下所示

```
execute procedurename @startdate = '01/07/2012', @enddate = '31/07/2012' 
```

现在我想在浏览器中访问存储过程，我尝试了下面的代码，但是如果我选择“全选”选项，它会显示空白结果。

```
<?php
$attr = 'selected="selected"';  ?>
<?php
$field1= isset($_REQUEST['field1']) ? $_REQUEST['field1'] : null; ?>
<select name="field1" style="margin-bottom:3px;"> 
<option> select all </option>
<option value="xyz" <?php echo $field1 == 'xyz' ? $attr : ''; ?>>xyz</option>
<option value="abc" <?php echo $field1 == 'abc' ? $attr : ''; ?>>abc</option>
 <option value="def" <?php echo $field1 == 'def' ? $attr : ''; ?>>abc</option>
</select> 
```

所以基本上，如果我从下拉框中选择“全选”，我希望它选择 field1 的所有值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T14:30:11.417

好吧，我直接在sql中自己整理了这个。

我更改了类似于以下的 where 子句：

```
 case when @field1 is '5' then field1 else @field1 end 
```

然后我在php的列表框中添加了值'5'，如下所示

```
<select name="field1" style="margin-bottom:3px;"> 
<option value="5" <?php echo $field1 == '5' ? $attr : ''; ?>>Select All</option>
<option value="xyz" <?php echo $field1 == 'xyz' ? $attr : ''; ?>>xyz</option>
<option value="abc" <?php echo $field1 == 'abc' ? $attr : ''; ?>>abc</option>
<option value="def" <?php echo $field1 == 'def' ? $attr : ''; ?>>abc</option>
</select> 
```

# php - 无法访问常量 - define() - 在 Wordpress 的 functions.php 中。访问给出了错误的结果

> ID：12230187
> 
> 赞同：1
> 
> 时间：2012-09-01T18:14:24.223
> 
> 标签：php, wordpress, constants, qtranslate

在 wp-config.php 中，我通过以下方式定义了 WPLANG：

```
if(isset($_GET['lang']) && $_GET['lang'] == 'pl') {
  define('WPLANG', 'pl_PL');
} else {
  define('WPLANG', 'en_US');
} 
```

每当我访问 WPLANG 时，它都能正常工作，但是当我尝试从 mailpress 小部件添加元数据时，它无法识别 WPLANG。将语言插入 wpdb 的函数位于主题的 functions.php 中：

```
add_action( 'MailPress_insert_user', 'MailPress_insert_set_lang');
    function MailPress_insert_set_lang($mp_user_id) {
        global $wpdb;
        $q = $wpdb->prepare( "INSERT INTO $wpdb->mp_usermeta 
        (mp_user_id, meta_key, meta_value) 
        VALUES (%s, 'lang', %s)", $mp_user_id, WPLANG );
        $wpdb->query( $q );
    } 
```

Mailpress 小部件使用 ajax。每当我将 echo WPLANG 放在函数定义之前，它都会回显正确的语言，但是在该函数的范围内无法识别 WPLANG。

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T13:42:54.010

可能尝试用 constant() 包装 WPLANG

```
add_action( 'MailPress_insert_user', 'MailPress_insert_set_lang');
function MailPress_insert_set_lang($mp_user_id) {
    global $wpdb;
    $q = $wpdb->prepare( "INSERT INTO $wpdb->mp_usermeta 
    (mp_user_id, meta_key, meta_value) 
    VALUES (%s, 'lang', %s)", $mp_user_id, constant(WPLANG) );
    $wpdb->query( $q );
} 
```

# facebook - Facebook 如何处理平板电脑？

> ID：12230189
> 
> 赞同：3
> 
> 时间：2012-09-01T18:14:37.153
> 
> 标签：facebook, tablet

我正在开发一个具有响应式布局的 Facebook 应用程序。有时我的应用程序必须为用户生成一个链接。只要有可能，链接就会将用户发送到*页面选项卡*（当用户在桌面上时），而在其他时候它会直接链接到应用程序（当用户在手机上时）。

Facebook 在平板电脑上的默认行为是什么？它显示的是移动网站还是桌面网站？

我应该在平板电脑上使用我的应用程序的*移动*版还是*桌面版？*

* * *

**更新**：*针对评论中 BBog 的问题：* 我的应用更喜欢桌面版本，因为它包含一个 Like-gate。如果平板电脑在页面选项卡中查看应用程序的用户体验良好（仅在 www.facebook.com 即非移动设备上可用），那么这是首选，因为点赞按钮将显示在顶部页面，位于应用的 iframe 上方。相比之下，该应用程序的移动版本要求用户单击一个链接，该链接将他们带到他们必须喜欢的（移动）Facebook 页面才能取消该应用程序。它为用户增加了一个额外的步骤，并要求他们暂时离开应用程序。用户可能会因为这个额外的步骤而气馁，并决定不进入大门。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T20:07:54.997

由于找不到具体的答案，我最终在第一页访问时检测到了用户的推荐。然后，如果`www.facebook.com`在 url 中，我会转到桌面。不然我去手机..

```
 if ($detect->isTablet()) {
  session_start();

  if (!isset($_SESSION["tabletAsMobile"]))
    $_SESSION["tabletAsMobile"] = (stripos($_SERVER["HTTP_REFERER"], 'www.facebook.com')===true):'0':'1';
  }

  $useMobileLinks = ($detect->isMobile() || ($detect->isTablet() && $_SESSION["tabletAsMobile"]));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T22:46:55.250

对于 Android 平板电脑 - 老实说，这取决于您希望 Facebook 如何处理它。如果您查看 android 原生应用程序链接 wiki - [https://developers.facebook.com/docs/mobile/android/deep_linking/，Facebook](https://developers.facebook.com/docs/mobile/android/deep_linking/)为您提供选择用户体验的选项。facebook 原生 android 应用程序本身将平板电脑视为手机。如果您的应用程序与平板电脑兼容，那将是理想的选择，然后您可以启用深度链接，让用户查看应用程序内部的内容。
对于 iOS，它是在 iOS 捆绑包 ID 中处理的。

# windows - 非客户区的右边缘边框未上漆和主题绘图

> ID：12230190
> 
> 赞同：1
> 
> 时间：2012-09-01T18:14:44.567
> 
> 标签：windows, resize, themes, border

基本上，问题涉及在 Windows 上调整窗口大小期间的边框闪烁。
我的第一个目标是在调整对话框大小时重新定位对话框上的控件。
我认为我在此操作期间获得了良好的动态重新定位，几乎没有任何闪烁，但这里我说的是主窗口边框闪烁。
但是，我根本无法消除它。
为了简化示例，请尝试使用提供的默认代码 VS 创建一个简单的 win32 应用程序。
我正在使用默认主题（Windows 7 basic，无透明度）和 VS2008 在 Window 7（64 位）上对其进行测试。
1) 不要向应用程序添加代码。
2）在调试模式下运行它。
3) 将窗口的左边缘慢慢向屏幕左侧拖动，同时注意窗口的右边缘边框。您应该会看到正在执行的重绘。
4) 重复步骤 3 快速移动鼠标，您应该可以更清楚地看到右侧边缘的闪烁。

如果反转边缘，即移动窗口的右边缘，那么左边缘会牢牢地固定在那里，没有未绘制的区域。顶部边缘与底部边缘发生相同的过程。

现在，启用经典主题（类似于 Win2000）并再次重复上述步骤。右边缘完全没有闪烁！如果您在调试模式下运行时密切关注 Visual Studio 的输出窗口，您应该会看到与您的 exe 一起加载的 dll 列表。如果您使用默认主题在调试模式下运行，您将看到加载了 uxtheme.dll。相反，启用经典主题后，不会加载 uxtheme.dll（始终加载 dwmapi.dll）。可能 uxtheme.dll 是在运行时根据桌面设置加载的，它会在重绘 Windows 非客户区时采取行动。

您可以用来查看这种闪烁效果的另一个技巧是为 WM_NCPAINT 添加一个 case 并返回 0 来调用 DefWindowProc()。重复上述步骤并快速移动，您应该会看到窗口右边缘的很大一部分被背景窗口完全擦除。顶部和底部不会发生这种情况。

任何想法来解决这个闪烁？

谢谢！

更新 2012\09\04：
- 使用 Windows 经典主题：
uxtheme.dll 在启动时加载，但 dwmapi.dll 不加载。然而，Uxtheme.dll 似乎
没有参与任何窗口渲染过程。调整窗口大小是完美的。
- 使用 Windos 7 主题（边框透明）：
uxtheme.dll 和 dwmapi.dll 在启动时加载。Uxtheme.dll 似乎不涉及
非客户区的任何部分，除了一些来自窗口顶部和主菜单的部分。
但我不确定最后一个。调整窗口大小是完美的。
- 使用Window 7 Basic 主题：
uxtheme.dll 和 dwmapi.dll 在启动时加载。Uxtheme.dll 大量用于
非客户区的渲染。窗口大小调整很糟糕。

# css - 如果样式可以使它们看起来相同，那么 h4 和 div 有什么区别？

> ID：12230194
> 
> 赞同：2
> 
> 时间：2012-09-01T18:15:30.217
> 
> 标签：css

我不是网页设计师，但我面临这样一种情况，即我必须`div`完全按照`h4`我们当前的设计来查看元素的外观，因为我无法控制生成`div`元素的代码。`h4`我做到了，但后来我想知道如果样式可以使它们看起来相同，那么and`div`或任何其他几个标签之间有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T18:16:18.020

[语义](http://en.wikipedia.org/wiki/Semantics)。想想屏幕阅读器或网络爬虫（例如搜索引擎）。

[偶尔添加新的 HTML 元素](http://www.w3.org/TR/html5-diff/#new-elements)也是同样的原因（除其他外）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T18:16:38.467

从语义上讲，an`h4`代表第 4 级标题，而 a`div`只是 a `div`。

这是关于您的数据的*含义*，而不是它的外观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T18:16:11.647

不要这样做，

seo 确实有所作为，HTML h4 标记用于指定第 4 级标题。这将由浏览器跟踪/检测，但 css 的标题不会被搜索引擎识别为标题，因此它不会对 seo 友好。

# javascript - 设置子窗口的 onload 属性

> ID：12230201
> 
> 赞同：1
> 
> 时间：2012-09-01T18:15:57.867
> 
> 标签：javascript, google-chrome

我有一个父母打开一个新窗口，并试图检测子窗口何时加载。在 Chrome 中，我尝试过

```
open('http://www.google.com').onload = function() { alert(location.href); }; 
```

但这似乎不起作用。

为什么上述方法不起作用？有替代品吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:04:40.063

该方法应该有效（并且对我有效），但在打开包含来自不同域的文档的窗口时无效。

出于安全原因，新窗口不会将加载事件分派到另一个域的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:28:40.200

如果您想绝对确定页面已加载，您可以使用消息传递。

如果您能够使用 HTML5，则有一个名为[web-messaging](http://www.w3.org/TR/webmessaging/#web-messaging)的新功能。这对跨域源非常有效。

如果 HTML5 不是一个选项，请改用 JS。[我使用了一个名为windowmsg](http://www.sfpeter.com/2008/03/communication-between-browser-windows-with-jquery-my-new-plugin/)的简单 jQuery 插件。它对我来说非常有效。我真的不确定这是否适用于跨站点环境，但我认为它应该。

请注意此类解决方案提供的安全问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-01T18:27:13.910

从技术上讲，子窗口和父窗口是浏览器的两个不同实例。我们称它们为子窗口和父窗口。它们无法相互访问。因此，在第二个窗口中单击 HTML 元素时，不可能在一个窗口中执行任何操作。

因此，我建议您在需要访问权限时不要打开新窗口。您可以使用花式框或灯箱，它们实际上是同一窗口的一部分，并且您可以控制。

# actionscript-3 - 文件类 AS3 / AIR：让用户只选择保存位置，而不是文件名或扩展名

> ID：12230202
> 
> 赞同：2
> 
> 时间：2012-09-01T18:15:59.623
> 
> 标签：actionscript-3, flash, air

使用 browseForSave 方法时，是否可以让用户只选择文件的位置，而不选择文件名或扩展名？

我正在创建一个加密文件，我需要用户不要更改它的名称和扩展名。

谢谢！

* * *

编辑（解决后）

我只是在寻找 browseForDirectory 方法。真丢人。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:57:47.167

有关如何打开浏览对话框以选择文件夹的参考，请参见此处的示例：

[如何在 Adob​​e FLEX 中创建“浏览文件夹”对话框？](https://stackoverflow.com/questions/5001457/how-to-create-browse-for-folder-dialog-in-adobe-flex)

一旦你有了你的目录，你可以把它和这里的代码拼凑在一起，使用 FileStream 对象保存一个文件：

[http://blog.everythingflex.com/2008/02/25/file-and-filestream-within-air/](http://blog.everythingflex.com/2008/02/25/file-and-filestream-within-air/)

复制到这里，因为它是一个外部链接

```
 private function saveFile():void{
        var myPattern:RegExp = / /g;
        var newFileName:String = fileName.text.replace('.txt','');
        if(newFileName.length > 1){
            var file:File = File.desktopDirectory.resolvePath("Files/" + newFileName.replace(myPattern,'_') + ".txt");
            var stream:FileStream = new FileStream()
            stream.open(file, FileMode.WRITE);
            var str:String = contents.text;
            str = str.replace(/\r/g, File.lineEnding);
            stream.writeUTFBytes(str);
            stream.close();
            fdg.directory = File.desktopDirectory.resolvePath("Files/");
            fileName.text = "";
            contents.text = "";
          } else {
              mx.controls.Alert.show("File name is required", "Error Saving File");
          }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-10T14:26:55.630

One solution would be to set the file object like this:

```
var f:File = File.desktopDirectory.resolvePath("*.txt");
f.addEventListener(Event.SELECT, onSelected);
f.browseForSave("save txt file"); 
```

Although user can still override that in the opened dialog, but at least the dialog shows the file extension. And later in the `Event.SELECT` you can check and confirm what user has selected.

# mysql - MySQL - 对于列表中的每个 ID，选择 2 最后一个元素

> ID：12230204
> 
> 赞同：6
> 
> 时间：2012-09-01T18:16:07.190
> 
> 标签：mysql, sql

我有一个具有以下架构的表：

```
id, field, time
3, 'test0', 2012-08-29
3, 'test1', 2012-08-30
3, 'test2', 2012-08-31
2, 'test0', 2012-08-19
2, 'test1', 2012-08-20
2, 'test2', 2012-08-26
... 
```

我需要为列表中的每个 id 找到它的最后一个和最后一个值。例如，如果 ids = [2,3] 结果应该返回

```
3, 'test1', 2012-08-30
3, 'test2', 2012-08-31 
2, 'test1', 2012-08-20
2, 'test2', 2012-08-26 
```

如果我只需要最后一个值，我会使用

```
SELECT *
FROM table
WHERE id IN (2, 3)
GROUP BY id 
```

有什么想法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:35:17.220

如果每个 ID 号的时间都是唯一的，这将起作用。

```
SELECT d.id, d.field,d.time
  FROM d d
  JOIN (
    SELECT max(d.time)m, d.id
      FROM d
      JOIN (
         SELECT max(time) m, id
           FROM d
       GROUP BY id
      )e ON d.id=e.id AND e.m>d.time
      GROUP BY d.id
   )e ON d.time >= e.m AND d.id = e.id 
```

这是它的工作原理。这个嵌套查询获取每个 id 的最新时间。

```
 SELECT max(time) m, id
           FROM d
       GROUP BY id 
```

然后，依次嵌套到这个查询中，它为您提供每个 id 的倒数第二个时间（不包括最新时间的行子集的最新时间）。

```
 SELECT max(d.time)m, d.id
      FROM d
      JOIN (
         SELECT max(time) m, id
           FROM d
       GROUP BY id
      )e ON d.id=e.id AND e.m > d.time 
```

最后，完整查询（如上图所示）获取时间大于或等于第二个最晚时间的所有行。

如果您的时间不是唯一的——也就是说，您有一些行出现相同的 ID 和时间，则每个 ID 可能会获得多于两行。但你总是会得到最近的两个时间。

如果一个特定的 ID 只有一行，你不会得到它。

只有您知道这些限制是否可以接受。

去拉小提琴！ [http://sqlfiddle.com/#!2/82719/5/0](http://sqlfiddle.com/#!2/82719/5/0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:25:36.900

试试这个

```
SELECT *
    FROM table
    WHERE id = '1'
    ORDER BY `id` desc
    LIMIT 0,2
UNION
    SELECT *
    FROM table
    WHERE id = '2'
    ORDER BY `id` desc
    LIMIT 0,2 
```

***更新：***

如果也可以尝试这样的事情：

```
SELECT t1.*
FROM `tablename` t1
LEFT OUTER JOIN `tablename` t2
  ON (t1.id = t2.id AND t1.time > t2.time)
GROUP BY t1.id, t1.field, c1.time
HAVING COUNT(*) < 2; 
```

[参考](https://stackoverflow.com/a/1923970/295264)

# python - 使用 Python.h 时，“AttributeError：‘模块’对象没有属性‘argv’”

> ID：12230210
> 
> 赞同：12
> 
> 时间：2012-09-01T18:16:29.973
> 
> 标签：python, c++, python-c-api, python-embedding

当弄乱 Python.h 时，我收到了这个错误：

```
AttributeError: 'module' object has no attribute 'argv' 
```

C++ 代码：

```
#include "stdafx.h"  
#include "C:/Python27/include/Python.h"  
#include <iostream>  

using namespace std;  

int main()  
{
    Py_Initialize();
    PyRun_SimpleString("import sys\nprint sys.argv[0]");
} 
```

在 Python 中是：

```
import sys
print sys.argv[0] 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-01T18:26:00.977

从概念上讲，`sys.argv`应该包含调用 Python 的参数（以及调用它的参数）。但是，如果它被这样称呼，它应该有什么？

如果需要，您可以将调用程序加载`argv`到`sys`中：

```
int main(int argc, char **argv)
{
    Py_Initialize();
    PySys_SetArgv(argc, argv);
    PyRun_SimpleString("import sys\nprint sys.argv");
} 
```

给

```
localhost-2:argv $ ./a.out
['./a.out']
localhost-2:argv $ ./a.out arg0 17
['./a.out', 'arg0', '17'] 
```

另请参阅`Py_SetProgramName`。

# linux - 如何使用输入子系统在 Linux 上处理键盘事件

> ID：12230213
> 
> 赞同：9
> 
> 时间：2012-09-01T18:16:51.387
> 
> 标签：linux, input, keyboard, hook

我正在用 C 编写一个 Linux 程序，我需要截取某些键盘敲击。

使用输入子系统（读/写/dev/input/eventX），我可以接收键盘敲击（使用“读取”功能）或模拟键盘敲击（使用“写入”功能）。

使用“读取”功能时，我可以捕获用户的键盘敲击，但此事件被传播，我不知道如何使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:31:45.183

默认情况下，输入事件会传输到所有正在侦听的应用程序和驱动程序。但是，可以让应用程序通过`evdev`接口抓取设备 - 查看`EVIOCGRAB` `ioctl()`. 这只允许该特定应用程序从该特定设备接收事件。

这种方法的问题在于，您实际上无法阻止特定事件在收到后被传播*——*您只能事先抓取设备，然后捕获*所有*事件。因此，如果要*过滤*输入事件，则必须使用解决方法。

我在自己的[`evmapd`](http://users.softlab.ntua.gr/~thkala/projects/evmapd/evmapd.html)守护程序中使用的解决方法包括获取原始设备并使用`uinput`子系统为另一台设备提供我需要的所有修改，包括重新映射的密钥和各种其他更改......

# sql - 如何将一列从一个表移动到一个新表？

> ID：12230214
> 
> 赞同：0
> 
> 时间：2012-09-01T18:17:20.263
> 
> 标签：sql, sqlite, refactoring

我想通过将一个表分成两个来重构我的数据库。我想将一些现有的列移动到一个新表中。例如，假设我想将`address`下表中的字段移动`Employee`到新`Address`表中。

如何**使用 sqlite**（或 SQL，如果等效）完成此操作？

**前：**

```
Employee Table
   employee_id (Primary)
   name
   address
   city 
```

**后：**

```
Employee Table
   employee_id (Primary)
   name
   address_id

Address Table
   address_id (Primary)
   address
   city 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:53:15.793

```
create table employee_new(employee_id,name,address_id);
insert into employee_new select employee_id,name,employee_id from employee;
create table address(address_id,address,city);
insert into address select employee_id,address,city from employee; 
alter table employee rename to employee_old;
alter table employee_new rename to employee; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T18:56:45.577

试试这个：

```
 CREATE TABLE Employee(
  emp_id int,
  name nvarchar(50),
  address nvarchar(50),
  city nvarchar(50),
  PRIMARY KEY (emp_Id));

ALTER TABLE Employee
ADD address_id int NOT NULL IDENTITY;

INSERT INTO EMPLOYEE(emp_id,name,address,city) VALUES (111,'JOHN','XXX STREET','XYZ');

CREATE TABLE Address(
   address_id int NOT NULL,
   address nvarchar(100),
   city nvarchar(100),
   PRIMARY KEY (address_id)
  );

INSERT INTO Address (address_id, address, city)
SELECT address_id, address, city
FROM Employee;

ALTER TABLE Employee
DROP COLUMN address;

ALTER TABLE Employee
DROP COLUMN city; 
```

[在这里](http://sqlfiddle.com/#!3/23055)检查

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:29:00.190

1：在您的第一个表中创建 AddressID 列并分配一个数字。
2：新建空表。
3：传输数据（类似这样）
INSERT INTO ADDRESS (ADDRESS_ID, ADDRESS, CITY)
SELECT ADDRESS_ID, ADDRESS, CITY FROM EMPLOYEE
4：从第一个表中删除旧列并创建外键

# objective-c - 将 NSData 转换为默认 MIME 类型

> ID：12230215
> 
> 赞同：0
> 
> 时间：2012-09-01T18:17:53.393
> 
> 标签：objective-c, xcode, mime-types, nsdata, open-with

我从不知道类型`NSData`的服务器收到。`MIME`

现在我想在不知道该文件的 MIME/扩展名的情况下将 NSData 转换为像 Image/Pdf 这样的任何文件，并且我想在 iPad 中打开该文件。

所以我想将我`NSData`的文件转换为默认`MIME`类型的文件并打开它。

那么有没有像打开...

任何建议或样品将不胜感激。

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:01:47.103

`NSData`只是原始数据。

因此，您有两个主要选择：

*   1) 转移类型
*   或 2) 使用您识别的一小组类型，并根据您作为输入接收的文件格式以编程方式确定类型。例如，pdf 的前 4 个字节可能是`%PDF`.

如果您使用一小组格式，您可能会根据数据的内容来确定数据的类型。因此，您可能会看到一些 API 能够在数据具有一些可以识别的受支持格式时确定数据所代表的类型……但是确定任何数据都需要很长时间来处理和实现。由于所有可用的数据类型/格式（已发布和未发布）以及不一定具有唯一标识它们的数据序列的数据格式，它也会有相当高的故障率。

# spring - 如何从 Spring MVC 中的一个 jsp 更新两个实体/模型元素？

> ID：12230216
> 
> 赞同：3
> 
> 时间：2012-09-01T18:18:12.410
> 
> 标签：spring, spring-mvc, controller, crud

我的要求是通过在 JSP 中为用户提供一个表单来执行 CREATE 操作，该表单具有来自两个实体的输入字段（例如**UserDetails**和**EmploymentDetails**）

使用单个提交在单个 jsp 中更新两个表单的最有效方法是什么？

我知道的一种方法是将两个实体组合成一个包装类，然后将该对象作为模型发送。那是唯一的解决方案吗？

请指导。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T08:39:16.440

将任意数量的对象放在一个包装类中并使用这个类通过单个表单提交数据是一种常见的做法。此外，您可以在任何对象中使用 JSR-303 验证：

```
public class MyForm {

    @Valid
    private UserDetails userDetails;

    @Valid
    private EmploymentDetails employmentDetails;

    ...

} 
```

你的表格：

```
<form:form modelAttribute="myForm" method="post">
    <form:input path="userDetails.property1"/>
    <form:input path="userDetails.property2"/>
    <form:input path="employmentDetails.property1"/>
    <input type="submit" value="create"/>
</form:form> 
```

和你的控制器：

```
@RequestMapping(value = "/", method = RequestMethod.POST)
public ModelAndView create (@Valid MyForm myForm, BindingResult bindingResult) {

    if (bindingResult.hasErrors()) {
        // here you can retrieve form errors of both objects
    }

    UserDetails userDetails = myForm.getUserDetails();
    EmploymentDetails employmentDetails = myForm.getEmploymentDetails();

    ...

} 
```

另一种方法是通过 JSON 保存对象，但我认为在这种情况下过于矫枉过正且过于复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T03:07:00.923

可以尝试将每个对象映射到不同的模型属性：

```
public String create(@Valid @ModelAttribute(value="UserDetails") UserDetails userDetails,
   @Valid @ModelAttribute(value="EmploymentDetails") EmploymentDetails employmentDetails, 
   BindingResult bindingResult, Model uiModel, HttpServletRequest httpServletRequest)  
{ 
```

在表单中，这些应该绑定到不同的前缀，例如：

```
<form:input path="UserDetails.name" /> 
```

# xslt - XSLT 1.0 在输出逗号分隔列表时处理空元素

> ID：12230217
> 
> 赞同：2
> 
> 时间：2012-09-01T18:18:18.270
> 
> 标签：xslt, comma, separator

我是stackoverflow的新手，希望有任何帮助。这是我遇到的 XSLT 1.0 问题，我确信有一个简单的解决方案，我只是找不到它。

我有`book`包含许多章节的顶部元素，每个章节都有一个标题：

```
<?xml version="1.0" encoding="utf-8"?>
<Book>
  <Chapter>
    <Title>ONE</Title>
  </Chapter>
  <Chapter>
    <Title>TWO</Title>
  </Chapter>
  <Chapter>
    <Title></Title>
  </Chapter>
  <Chapter>
    <Title>FOUR</Title>
  </Chapter>
</Book> 
```

我想将上述内容转换为一个名为 CSV-Title-List 的元素。在出现空标题的情况之前，这似乎很容易。我使用以下样式表得到一个意外的逗号：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="Book">
      <CSV-Title-List>
      <xsl:for-each select="Chapter/Title">
        <xsl:value-of select="."/>
        <xsl:if test="position() &lt; last()">
          <xsl:text>, </xsl:text>
        </xsl:if>
      </xsl:for-each>
      </CSV-Title-List>
    </xsl:template>   
</xsl:stylesheet> 
```

我的问题是，如何在使用上述样式表输出逗号之前干净地检查下一章/标题是否有空字符串。一定会有更好的办法？任何建议，将不胜感激。感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:26:38.233

**这种转变：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
  <xsl:apply-templates select="Chapter[normalize-space(Title)]"/>
 </xsl:template>

 <xsl:template match="Chapter">
  <xsl:if test="not(position()=1)">,</xsl:if>
  <xsl:value-of select="Title"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Book>
  <Chapter>
    <Title>ONE</Title>
  </Chapter>
  <Chapter>
    <Title>TWO</Title>
  </Chapter>
  <Chapter>
    <Title></Title>
  </Chapter>
  <Chapter>
    <Title>FOUR</Title>
  </Chapter>
</Book> 
```

**产生想要的正确结果：**

```
ONE,TWO,FOUR 
```

**当对不同的 XML 文档应用相同的转换时——其中第一个`/*/Chapter/Title`具有纯空格字符串值**：

```
<Book>
  <Chapter>
    <Title>     </Title>
  </Chapter>
  <Chapter>
    <Title>TWO</Title>
  </Chapter>
  <Chapter>
    <Title></Title>
  </Chapter>
  <Chapter>
    <Title>FOUR</Title>
  </Chapter>
</Book> 
```

**再次产生正确的，想要的结果**：

```
TWO,FOUR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:40:17.040

即使您的第一个`Title`元素是空白的，这也是一个有效的解决方案。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:strip-space elements="*" />

 <xsl:template match="Book">
  <xsl:variable name="booklist">
   <xsl:apply-templates />
  </xsl:variable>
  <xsl:value-of select="substring($booklist,2)" />
 </xsl:template>

 <xsl:template match="Title/text()">
  <xsl:text>,</xsl:text>
  <xsl:copy />
 </xsl:template>
</xsl:stylesheet> 
```

它也不使用显式条件，只是在每个值前面加上一个逗号，将结果存储在一个变量中，然后从第二个字符开始输出该变量（跳过第一个逗号）。

# repository - 在 ATG 'RQLQueryForEach' 液滴中排序

> ID：12230219
> 
> 赞同：0
> 
> 时间：2012-09-01T18:18:37.627
> 
> 标签：repository, atg

我只想知道在下面的“RQLQueryForEach”液滴中排序的依据是什么，

```
 <dsp:droplet name="RQLQueryForEach">
    <dsp:param name="OfferId" value="<%= offId %>"/>
    <dsp:param name="repository"   value="/com/tgt/coa/repository/COARepository"/>
    <dsp:param name="itemDescriptor" value="offer_catg_assoc"/>
    <dsp:param name="queryRQL" value="ofr_i=:OfferId"/>
    <dsp:setvalue param="offerItem" paramvalue="element"/>
    <dsp:oparam name="outputStart">
    <dsp:getvalueof id="repId" param="offerItem.repositoryId">
    <dsp:input type="checkbox" value="<%= repId %>" name="unAssocMe" checked="<%=false%>" />&nbsp;
    <dsp:getvalueof id="catgId" param="offerItem.prod_catg_seq_i"> 
```

对应的项目描述符：

```
<item-descriptor name="offer_catg_assoc" query-cache-size="1000" item-cache-size="10000" item-expire-timeout="3600000"
    query-expire-timeout="3600000" cache-mode="simple">
    <table name="COA_OFR_PROD_CATG" type="primary" id-column-names="OFR_PROD_C_SEQ_I">
        <attribute name="metaDataSchemaPattern" value="CMP_ADW"/>
        <attribute name="tablePrefix" value="CMP_ADW."/>
        <property name="ofr_prod_c_seq_i" data-type="int" sql-type="integer" column-name="OFR_PROD_C_SEQ_I" required="true" group="offrcatgassoc"/>
        <property name="coa_run_seq_i" data-type="int" sql-type="integer" column-name="COA_RUN_SEQ_I" group="offrcatgassoc"/>
        <property name="prod_catg_seq_i" data-type="int" sql-type="integer" column-name="PROD_CATG_SEQ_I" required="true" group="offrcatgassoc"/>
        <property name="coa_asct_type_c" data-type="string" sql-type="char" column-name="COA_ASCT_TYPE_C" required="true" group="offrcatgassoc"/>
        <property name="ofr_i" data-type="int" sql-type="bigint" column-name="OFR_I" required="true" group="offrcatgassoc"/>
        <property name="crte_user_i" data-type="string" sql-type="char" column-name="CRTE_USER_I" required="true" group="offrcatgassoc"/>
        <property name="crte_d" data-type="date" sql-type="date" column-name="CRTE_D" required="true" group="offrcatgassoc">
        </property>
    </table>
</item-descriptor> 
```

上面的查询随机从数据库中获取数据。我无法找到记录是如何排序的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T13:31:48.850

我认为在您的情况下默认顺序是按主键排序：“OFR_PROD_C_SEQ_I”。但是 RQLQueryForEach 具有属性 - “ *sortProperties* ”，您可以在其中指定自定义顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T00:51:15.423

您应该将 sortProperties 参数与排序属性一起使用。以下输入参数按 coa_asct_type_c 的字母顺序对存储库项**进行****排序**，然后按**ofr_prod_c_seq_i的****降序**排列：例如

 ******```
<dsp:param name="sortProperties" value="+coa_asct_type_c,ofr_prod_c_seq_i"/> 
```

此页面应为您提供有关[RQLQueryForEach的更多详细信息](http://docs.oracle.com/cd/E24152_01/Platform.10-1/ATGPageDevGuide/html/s1449rqlqueryforeach01.html)******

# asp.net-mvc - 如何将三个 ASP MVC 路由合二为一？

> ID：12230223
> 
> 赞同：1
> 
> 时间：2012-09-01T18:18:57.393
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-routing

我设置了以下路线：

```
 context.MapRoute(
            "content_article",
            "A{rk}/{title}",
            new { controller = "Server", action = "Article" },
            new { rk = @"^[\dA-Z]{3}$" }
        );

        context.MapRoute(
            "content_contentBlock",
            "C{rk}/{title}",
            new { controller = "Server", action = "ContentBlock" },
            new { rk = @"^[\dA-Z]{3}$" }
        );

        context.MapRoute(
            "content_favoritesList",
            "F{rk}/{title}",
            new { controller = "Server", action = "FavoritesList" },
            new { rk = @"^[\dA-Z]{3}$" }
        ); 
```

有没有办法可以结合：

```
"A{rk}/{title}",
"C{rk}/{title}",
"F{rk}/{title}", 
```

如果 URL 以 A、C 或 F 开头，则进入一个带有 Index 操作的单个路由？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:15:39.723

因此，如果我理解正确，您只需要一条路线来涵盖所有三项并指向`Index`行动？如果这是问题而不是答案

## 你当然可以

您只需将正则表达式更改为以下路由定义：

```
context.MapRoute(
    "content",
    "{lrk}/{title}",
    new { controller = "Server", action = "Index" },
    new { lrk = @"^[ACF][0-9A-Z]{3}$" }
); 
```

就是这样。然后通过可能（并希望）执行适当的单独方法的索引操作完成第一个字母的解析。

```
public ActionResult Index(string lrk)
{
    if (string.IsNullOrEmpty(lrk))
    {
        throw new ArgumentException("lrk")
    }
    char first = lrk[0];
    switch(first)
    {
        case 'A':
            return GetArticle(lrk.Substring(1));
        case 'C':
            return GetContent(lrk.Substring(1));
        case 'F':
            return GetFavorites(lrk.Substring(1));
        default:
            return View();
    }
}

private ActionResult GetArticle(string rk)
{
    ...
}

// and other couple 
```

如您所见，这三个方法具有相同的签名，就好像它们是控制器操作一样，但它们不是，因为它们是`private`. 您可以将它们设置为`private`或装饰它们，`NonActionAttribute`这样它们就不会被您的默认路线拾取，您可能也有...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:31:54.887

您仍然可以拥有三个路由，但通过为 RouteCollection 添加扩展方法来简化它们的定义：

```
public class ActionMap : Dictionary<string, string>
    {}

    public static class RouteCollectionExtensions
    {
        public static void MapRoute(this RouteCollection routes, string name, string url, object defaults, object constraints, ActionMap map)
        {
            if(!url.Contains("{action}")) throw new ArgumentException("{action} segment is required", url);

            foreach (var actionKey in map.Keys)
            {
                string routeName = string.Format("{0}_{1}", name, map[actionKey]);
                string routeUrl = url.Replace("{action}", actionKey);
                var routeDefaults = new RouteValueDictionary(defaults);
                routeDefaults["action"] = map[actionKey];

                Route route = new Route(routeUrl, new MvcRouteHandler())
                {
                    Defaults = routeDefaults,
                    Constraints = new RouteValueDictionary(constraints),
                    DataTokens = new RouteValueDictionary()
                };

                routes.Add(routeName, route);
            }
        }
    } 
```

现在这些路线的定义如下：

```
 routes.MapRoute(
                    "content",
                   "{action}{rk}/{title}",
                   new { controller = "Server" },
                   new { rk = @"^[\dA-Z]{3}$" },
                    new ActionMap { { "a", "Article" }, { "c", "ContentBlock" }, { "f", "FavoritesList" } }
            ); 
```

您也可以在其他类似情况下重复使用它。希望这可以帮助

# powershell - 我可以在文件中包含没有扩展名的 powershell 脚本吗？

> ID：12230228
> 
> 赞同：4
> 
> 时间：2012-09-01T18:19:41.870
> 
> 标签：powershell

通常 powershell 脚本文件以 .ps1 结尾，模块以 .psm1 结尾。

可以在没有扩展名的文件中包含 powershell 脚本/模块吗？只是“构建”或“开始”等等？这会在任何特定环境中引起问题吗？

如果是，是否可以在具有其他“文本”扩展名（如 .sh、.ps 等）的文件中包含 powershell 脚本/模块？

* * *

有没有更简单的方法来调用 powershell 脚本而不是键入 .\script.ps1 arg1, arg2 ，例如：go arg1, arg2？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T18:28:14.993

不，你不能。的错误消息`Import-Module`非常清楚：

```
Import-Module : The extension '.xyz' is not a valid module extension. The supported module extensions are '.dll',
'.ps1', '.psm1', '.psd1', '.cdxml' and '.xaml'. Correct the extension then try adding the file 
```

如果您尝试调用具有非标准扩展名的脚本，Windows 将简单地弹出“您想用什么程序打开它？” 对话。如果您选择使用 Powershell 打开，则会生成一个新的 Powershell 进程，该进程将执行相同的操作。

如果您尝试分配一个新的扩展名，例如`.xyz`始终使用 Powershell 打开，您最终将产生一系列永无止境的 Powershell 进程，每个进程都徒劳地尝试使用新的 Powershell 实例打开文件。我刚试过:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T14:39:04.703

这就是`alias`Powershell 中的功能的用途。您可以创建脚本，正确地以 结尾`.ps1`，然后创建一个别名，以便您可以将其调用为`build`，`start`或其他。

请参阅文档：`get-help about_aliases`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-17T04:09:27.300

超级迟到的答案，但我想对我的 bin 文件夹中的所有脚本执行此操作，我花了一段时间才弄清楚。我结束了这个：

```
Get-ChildItem -path <bin where your ps1 files live> -Filter *.ps1 |
Foreach-Object{
    $name = $_.Name
    $scptName = $_.Name -split ".ps1",0,"simplematch"
    $scptName = $scptName[0]
    new-alias $name $scptName
} 
```

而且我还希望它用于我的 python bin 中的所有 python 脚本，这更复杂但仍然可行：

```
Get-ChildItem -path <pybin path> -Filter *.py |
Foreach-Object{
    $name = $_.Name
    $scptName =  $_.Name -split '.py',0,'simplematch'
    $scptName = $scptName[0]
    $eName = $scptName -split '-',0,'simplematch'
    $eName = $eName[1]
    invoke-expression('
    $val' + $eName + ' = $name
    function doRun' + $eName + '{
        python "<pybin path>/$val' + $eName + '" $args
    }
    $alias = "doRun$ename"
    set-alias $scptName $alias
    ')
} 
```

请注意，您正在对包含系统上文件名的表达式进行调用表达式，因此如果其他人可能会写入该目录，这是一个安全问题。因为这是我的 bin 目录，而且我一直在执行这些东西，所以我认为这并不重要，但它可以牢记这一点。

当然还有一种更优雅的方法可以实现这一点，但我不确定它是什么。

# version - 什么 GNU makefile 规则可以确保 make 的版本至少是 v3.82？

> ID：12230230
> 
> 赞同：5
> 
> 时间：2012-09-01T18:19:57.127
> 
> 标签：version, gnu-make

当使用旧版本的 gmake 时，我有一个 makefile 会出现不明显的故障。我想要一个规则来检查版本至少是 3.82 版或更高版本。我已经达到了以下规则，但是比较很脆弱，我真的想要一个允许更高版本的比较：

```
GMAKE_VERSION :=  $(shell gmake --version | head -n 1 | sed 's/GNU Make //')

.PHONY: testMake
testMake:
    @if [ "$(GMAKE_VERSION)" != "3.82" ];               \
    then                                \
        echo >&2 "Unexpected gmakefile version "        \
            "$(GMAKE_VERSION), expecting 3.82 or later.";   \
        false;                          \
    fi 
```

什么 GNU makefile 规则可以确保 make 的版本至少是 v3.82？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T20:53:56.173

这是我将如何实现它：

```
# Check Make version (we need at least GNU Make 3.82). Fortunately,
# 'undefine' directive has been introduced exactly in GNU Make 3.82.
ifeq ($(filter undefine,$(value .FEATURES)),)
$(error Unsupported Make version. \
    The build system does not work properly with GNU Make $(MAKE_VERSION), \
    please use GNU Make 3.82 or above.)
endif 
```

检查基于测试`.FEATURES`内置变量。来自 GNU Make 3.82 [NEWS 文件](http://cvs.savannah.gnu.org/viewvc/make/NEWS?revision=2.109&root=make&view=markup)：

> 新的 make 指令：`undefine`允许您取消定义变量，使其看起来好像从未设置过。`$(flavor)`和函数都`$(origin)`将为此类变量返回“未定义”。**要检测此功能，请`undefine`在`.FEATURES`特殊变量中搜索。**

# python - 如何在金字塔（线程）中使用python和windows com？

> ID：12230240
> 
> 赞同：1
> 
> 时间：2012-09-01T18:21:13.473
> 
> 标签：python, multithreading, com, pyramid

我正在通过 win32com.client.Distpatch 函数连接到 MS Word，在第二个请求中我收到错误：“尚未调用 CoInitialize。” 我发现了这个话题：

[http://www.velocityreviews.com/forums/t328097-coinitialize-error-when-using-adodbapi.html](http://www.velocityreviews.com/forums/t328097-coinitialize-error-when-using-adodbapi.html)

并且知道我必须在新线程中调用 CoInitialize。所以问题是在金字塔的哪里调用 CoInitialize 函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T07:51:59.047

所以我在函数中添加了 CoInitialize 的调用：

```
@subscriber(NewRequest)
def new_request_subscriber(event):
    import pythoncom
    pythoncom.CoInitialize() 
```

并且毫无例外地工作。

# javascript - D3js如何在.enter上下文中附加2个相同级别的孩子

> ID：12230241
> 
> 赞同：20
> 
> 时间：2012-09-01T18:21:19.173
> 
> 标签：javascript, d3.js

我在尝试在 .enter() 上下文中将一个圆圈和一个文本放在一个组内（同一级别，而不是彼此内）时遇到问题

```
var categorized = g1.selectAll("g.node").data(dataset, function(d){return d.id})

categorized
.enter()
    .append("g")
    .attr("id", function(d,i){return d.id;});

categorized
.enter().append("circle")
    .style("fill", "#ddd");
// throws an error

categorized
.append('text')
    .text(function(d,i){return d.count});
// this is working but is an update so I have to remove the text on exit 
```

有没有办法回到父母身边，像这样的sg：

```
categorized
.enter()
.append("g")
.append("circle")
.getBackToParent // the g
.append("text"); 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-01T18:23:45.737

只需将父 d3 包装器分配给一个变量：

```
var g = categorized.enter().append("g");
g.append("circle").style("fill", "#ddd");
g.append("text").text(function(d,i){return d.count}); 
```

# azure - Azure 缓存（预览版）OutputCache - 高 CPU - 慢

> ID：12230246
> 
> 赞同：4
> 
> 时间：2012-09-01T18:22:23.100
> 
> 标签：azure

我有一个 MVC 4 (Razor) 网站，并且为会话和 outputCache 提供程序启用了 Azure 缓存（预览版）（共存）。由于我启用了它，每个 Web 请求都会导致大量 CPU 峰值，并在调试时导致 3-5 秒的页面响应时间。

我已将问题缩小到 outputCache 提供程序。如果我在 web.config 中禁用它，该站点运行良好。没有 CPU 峰值。我还没有使用页面输出缓存......所以不应该发生读/写。会话提供程序通过 Azure 缓存（预览版）运行良好。下面是我的 outputCache 配置。如果我禁用它，该站点将在没有 CPU 峰值的情况下运行。有什么想法吗？

```
<caching>
  <outputCache defaultProvider="DistributedCache">
    <providers>
      <add name="DistributedCache" type="Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider, Microsoft.Web.DistributedCache" cacheName="default" dataCacheClientName="default" />
    </providers>
  </outputCache>
</caching> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:59:15.463

看来问题是由于 Web 优化框架造成的。它没有为非默认缓存提供程序（例如 Azure 缓存预览）启用服务器缓存。因此，每次发出请求时，Web 服务器都必须重新捆绑，这会导致 CPU 峰值。Microsoft.AspNet.Web.Optimization 的未来版本应该再次启用服务器缓存。

这是CodePlex 上的[问题。](http://aspnetoptimization.codeplex.com/workitem/46)

# ruby-on-rails - 模型中的单引号处理

> ID：12230247
> 
> 赞同：0
> 
> 时间：2012-09-01T18:22:27.560
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个带有旧数据库的系统，我必须使用手动 SQL 插入/更新。现在，我有这样的事情：

```
class Legacy  < ActiveRecord::Base
  establish_connection("legacy#{Rails.env}")
end

class Book < Legacy
end

book = Book.find(params[:isbn])
# CLEAN UP BELOW
Legacy.connection.exec_query("
          UPDATE dbo.Book Set Title = #{Legacy.connection.quote(book.Title)}
          WHERE dbo.Book.ISBN = '#{book.ISNB}')") 
```

任何想法如何清理它？这是一个简化的示例，在许多情况下，旧表中的多个属性使用一条 SQL 语句进行更新。

我可以添加一个新的访问器

```
Set Title = #{book.Title!) 
```

或者简单地说：

```
Set Title = #{book.Title.send('quoted')} 
```

还有其他想法吗？

更新：这是一个实际的例子：

```
result = Aim.connection.exec_query("
DECLARE @InsuredKey_PK int;
DECLARE @ResultVal varchar(125);
EXEC dbo.spAIMImportInsured #{tmpname}
, @InsuredKey_PK OUTPUT, @ResultVal OUTPUT, NULL, 'B', '#{submission.dba}', 
#{tmpaddr1}, #{tmpaddr2}, #{tmpcity}, '#{submission.state}', '#{submission.zip}' ,
#{tmpaddr1}, #{tmpaddr2}, #{tmpcity}, '#{submission.state}', '#{submission.zip}' 
, NULL, NULL, NULL, '#{submission.ProducerID}', 
'#{Employee.find(submission.acct_exec).first_name.downcase}',
'#{aim_name.Name}','#{aim_name.NameKeyPK}';
SELECT @InsuredKey_PK as insured_aim_key, @ResultVal as result;") 
```

我是这样消毒的：

```
class Insured < Legacy
  def self.update_attributes(id,update_hash)
    set_sql = ActiveRecord::Sanitization::ClassMethods.send(
      :sanitize_sql_for_assignment,update_hash
    )
    connection.exec_query("UPDATE dbo.Insured Set " + set_sql + 
      "WHERE dbo.Insured.InsuredID = #{id}"
    )
  end
end 
```

像这样调用：

```
Insured.update_attributes(id,
  {:Address1 => params[:submission][:address1],
  :Address2 => params[:submission][:address2],
  :City => params[:submission][:city],
  :State => params[:submission][:state],
  :Zip =>params[:submission][:zip]
  }) 
```

我第一次发帖时并没有意识到这一点，但我了解到我的问题是当我从存储在常规 Rails (MySQL) 数据库中的数据中插入/更新旧数据库中的数据时出现的。我最终做的是把这个方法放在我所有的常规模型中：

```
def quoted_for_legacy(attribute)
  Legacy.connection.quote(self[attribute])
end 
```

所以现在，当我从存储在常规 Rails MySQL 模型中的数据更新 Legacy 时：

```
"Set Foo = #{regmodel.quoted_for_legacy(:Foo)}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:51:56.680

我使用 Rails 内置方法来执行此操作。这让您可以在 Rails 中使用所有方便的替换快捷方式来处理其他 SQL。只需围绕[ActiveRecord 方法](http://apidock.com/rails/ActiveRecord/Base/sanitize_sql_array/class)编写一个包装器：

```
def sanitize(*array)
    return ActiveRecord::Base.send(:sanitize_sql_array, array)
end 
```

**注意：** 看起来此方法已在最新版本中移动。如果您正在使用它，您将需要[ActiveRecord::Sanitization::ClassMethods#sanitize_sql_array](http://apidock.com/rails/ActiveRecord/Sanitization/ClassMethods/sanitize_sql_array)。

然后，您可以`sanitize`像往常一样在需要将变量子变量放入 SQL 时使用该函数。希望有帮助！

# xml - XML 解析错误：文档末尾的额外内容

> ID：12230248
> 
> 赞同：7
> 
> 时间：2012-09-01T18:22:46.200
> 
> 标签：xml, parsing, extra

首先，祝大家有美好的一天。我有这个脚本来处理我的数据库的登录：http: [//pastebin.com/ctUEczRf](http://pastebin.com/ctUEczRf) 我使用了 pastebin，因为它太长而无法使用代码标签。当我运行它时，它返回给我：

```
This page contains the following errors:

error on line 2 at column 1: Extra content at the end of the document
Below is a rendering of the page up to the first error. 
```

我不知道如何解决它，我以前从未使用过 XML。这是与 CMS 一起给我的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T01:09:42.797

粘贴生成的 XML 可能是您需要做的。我的猜测是您正在生成具有多个顶级元素的 XML；XML 要求您在顶层有一个包装器元素，并在其中包含所有其他元素：它是一棵树，而不是森林。

我的第二个猜测是您在 Web 浏览器中看到了错误，而且它根本不是由 php 生成的；检查您的 Web 服务器错误日志以确保。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-01T10:55:25.353

查看 XML。它应该如下所示：

```
<block>
    <item>Here's an item</item>
    <item>Here's another item</item>
    <item>Here's an item with some sub-items
        <subitem>one</subitem>
        <subitem>two</subitem>
    </item>
</block> 
```

XML 文档的根是`block`项目；它是包围和包围所有其他项目的项目。

如果您没有根 - 即，如果代码看起来像这样：

```
<item>Here's a list of items</item>
<item>But there's no root element</item> 
```

然后你会得到你描述的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-25T05:39:30.070

两种可能的选择。这可能是因为呈现的 XML 无效。有时，可能是因为您没有足够的权限来访问 XML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-24T15:35:51.973

我收到此错误消息“文档末尾有额外内容”。原来问题出在其中一个标签中，两个属性之间没有空格。

# php - 从变量创建类名

> ID：12230252
> 
> 赞同：0
> 
> 时间：2012-09-01T18:23:24.153
> 
> 标签：php, codeigniter, variables, model

我想使用 PHP 中的变量来定义类名。这可能吗？

让我解释。

我是一个小型自定义 CMS，它允许最终用户为表名配置前缀。因此用户可以定义前缀，例如“rc_”。问题是，我有很多使用表名作为类的模型。因此，例如，如果我的一张表是`rc_posts`，则模型将被调用

```
class MyModel_Rc_posts extends MyModelController {
         // code here
} 
```

有没有办法使用 PHP 中的变量来定义一个类，而不使用`eval()`例如：

```
class MyModel_{$PREFIX}posts extends MyModelController {
// code here
} 
```

我想避免 eval 的原因是因为其中一些类可能会变得很长。建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:26:46.157

看看[class_alias](http://at2.php.net/manual/en/function.class-alias.php) - 它应该可以帮助您使它更具可读性！

只是为了说明这一点：您使用“正常”名称创建您的类，然后根据需要添加别名。别名可以是任何字符串，这包括存储在变量中的字符串。

**编辑**

虽然我认为，这`class_alias()`是要走的路，但这里有一个例子，说明如何在没有它的情况下做到这一点。

来自您的 OQ：

```
class MyModel_Rc_posts extends MyModelController {
         // code here
} 
```

现在

```
eval("class MyModel_{$PREFIX}posts extends MyModel_Rc_posts {};"); 
```

应该做一些非常相似的事情`class_alias()`。

如果您以后需要，可能需要进行此操作`get_class()`-在别名类上，它将为您提供原始（静态）类名，而不是别名。使用丑陋`eval()`/`extends`技巧，您可以获得动态名称。

# opengl - 建模转换究竟是什么意思？

> ID：12230258
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:24:35.270
> 
> 标签：opengl, graphics, transformation

我实在想不通。好的，它从模型坐标转换为世界坐标，但它是由什么组成的？旋转或平移或缩放？我怎样才能得到建模转换矩阵？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:29:38.497

> 好的，它从模型坐标转换为世界坐标，但它是由什么组成的？

模型视图变换是一个映射 W(v)：R^4 → R^4。可以使用顶点着色器自由定义精确的映射。在通常情况下，它遵循固定函数管道，它使用线性映射 v' ⟼ M v，其中 M 是一个 4×4 矩阵。

> 旋转或平移或缩放？

这是一个映射 R^4 → R^4。属于该组的任何映射都可以用作模型视图转换。旋转、缩放和平移以及它们的任何组合都属于该组，但还有更多。

> 我怎样才能得到建模转换矩阵？

来自OpenGL？最好不要，因为 OpenGL 不是数学库。事实上，整个矩阵堆栈已从更高版本的 OpenGL 中剥离。您自己构建这些矩阵（因此您已经拥有它们），然后将它们加载到 OpenGL 统一状态变量中。

# android - Android 新布局要替换旧布局

> ID：12230259
> 
> 赞同：0
> 
> 时间：2012-09-01T18:24:40.410
> 
> 标签：android

我是安卓新手。当我尝试在 中创建新的（横向）布局时`layout-land folder`，它说：

> 你想覆盖文件 res/layout/main.xml

为什么要替换另一个布局？在 Eclipse 中，我右键单击 layout-land 文件夹并选择 New -> Others -> XML layout file。但它想用我原来的布局文件替换它。怎么来的？虽然我在横向布局中使用了与 main.xml 相同的名称，但我知道这不应该冲突。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T10:31:49.970

您是否将文件夹放置为 res/layout-normal-land？

阅读此链接以供参考 - [http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:23:36.323

what eclipse writes contradicts what you claim you try to do .

it talks about "layout" folder , and you talk about "layout-land" folder.

are you sure you put the file in the correct place?

anyway , your assumption is correct : you can put the same name in multiple places , adn it's a very common solution to handle multiple configurations (using what is called "qualifiers" ) .

more info [here](http://developer.android.com/guide/topics/resources/providing-resources.html) and [here](http://developer.android.com/guide/practices/screens_support.html) .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:44:52.030

要添加一个新布局，您应该给 main.xml 以外的其他名称，因为它已经存在。

# c - exit() 调用 pthread_mutex_lock()

> ID：12230262
> 
> 赞同：1
> 
> 时间：2012-09-01T18:25:04.073
> 
> 标签：c, pthreads, libc

我对线程有一个奇怪的问题。如果我在没有参数或`--help`选项的情况下启动程序，它将立即退出。

该程序在启动时加载一个网络检查器线程。当需要退出或禁用某些在线功能时，它只是终止网络检查器线程。这似乎是正确完成的......直到我打电话给`exit()`.

在 gdb 上，我可以看到网络检查器已成功关闭 - 但由于一些模糊的原因，当主程序调用`exit()`then时`pthread_mutex_lock()`也会被调用。

这是回溯：

```
(gdb) bt
#0  0x00007ffff711e804 in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007ffff711a0e0 in _L_lock_533 () from /lib64/libpthread.so.0
#2  0x00007ffff7119f79 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x00007ffff7dea3cd in _dl_fini () from /lib64/ld-linux-x86-64.so.2
#4  0x00007ffff6dbe6a1 in __run_exit_handlers () from /lib64/libc.so.6
#5  0x00007ffff6dbe725 in exit () from /lib64/libc.so.6
#6  0x0000000000413ec4 in option_handler (argc=1, argv=0x7fffffffdcb8) at autocrack.c:302
#7  0x00000000004135a7 in main (argc=1, argv=0x7fffffffdcb8) at autocrack.c:34 
```

当我从我的函数内部调用时，这*不会*发生。这只发生在我[从选项处理程序内部](https://github.com/tux-mind/autocrack/blob/3cb167b1d0732ce38e50db77d403f3ba4aa22fbf/autocrack.c#L302)调用时。`exit()``main``exit()`

我曾经`grep -rin pthread_mutex_ .`看到在我的程序中还有哪些地方使用了锁：程序永远不应该达到这些点。

完整的源代码可以在[https://github.com/tux-mind/autocrack找到](https://github.com/tux-mind/autocrack)

这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T22:51:27.553

锁是从`_dl_fini`动态链接器/加载器中的一个内部函数获取的，该函数负责在共享库文件中运行全局析构函数。它必须获得一个锁以确保`dlopen`在它运行析构函数的同时没有新的库被加载（通过）。

如果此时您遇到崩溃或挂起，您可能在程序中的某处调用了未定义的行为，可能是通过无效指针写入。Valgrind 可能能够帮助您确定程序中的错误在哪里。

# javascript - 滚动时将 div 居中在另一个 div 中

> ID：12230265
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:25:33.413
> 
> 标签：javascript, jquery

我试图将导航集中在主要内容 div 中，并在滚动时将其卡在那里。我无法解决的问题是，由于页眉和页脚，它需要有视差。我有一个暂存环境[http://stage.golishlaw.com/portfolio/](http://stage.golishlaw.com/portfolio/)

我无法写下我尝试过的所有内容，但最近的一些内容是：

```
var _mainHeight = (($(window).height()/2) - ($("#portfolio_nav").height()/2)) + (($("#main").offset().top - $(window).scrollTop()))
$("#portfolio_nav").css({
    top: _mainHeight
});
```

这个在某些显示器尺寸上效果很好，但在其他尺寸上效果不佳。

```
var mainScrollTop = (($(window).scrollTop() - $("#main").offset().top));
mainScrollTop = mainScrollTop > 0 ? 0 : mainScrollTop;
var _mainHeight =  ((($(window).height() )/2 - $("#portfolio_nav").height()/2) + $("#main").offset().top) + mainScrollTop
$("#portfolio_nav").css({
    top: _mainHeight
});
```

这个工作得很好，但导航卡在某个位置（我知道为什么我不知道如何让它卡在屏幕中央）

我真的一直在把头发拉出来，我已经尝试了我能想到的一切。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:28:34.167

我建议使用溢出创建自己的身体 DIV：滚动。将其附加到正文中。然后，您可以将第二个 div 添加到作为您的中心 div 的主体中。这个 div 有一个绝对位置并且在屏幕上居中。然后你把页面的全部内容放到你自己的body DIV中。所以当你滚动的时候，感觉就像是在滚动 body，但实际上你是在滚动 body DIV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:50:52.890

在您的页面上更改这 2 个

```
 #portfolio_nav {
 width: 200px;
 top: 300px;
 left: 50%;
 margin-left: -401px;
 position: fixed;                 /*this line*/
 }

 .page-template-portfolio-php #contentblock_tile, .contentcontainer_tile {
  padding-bottom: 9px;
  position: absolute;             /* this line */
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:50:57.960

您已经使用 CSS 定义了左侧位置：`absolute; left: 50%; margin-left: -401px;`因此将此 CSS 添加到您的`#portfolio_nav`规则中以使其垂直居中：

```
top: 50%;
margin-top: -80px; 
```

确保注释掉设置顶部 CSS 属性的 jQuery 代码，否则它将覆盖 CSS 规则。

**margin-top calc**：每个列表项都有`40px`( `height + padding-bottom`) 所以 4 `li`* 40 = 160 / 2 = -80px `margin-top`。或者每次添加列表项时只需减去 20px。当然，`marginTop`如果您需要动态添加列表项，可以通过 jQuery 设置来完成此计算。

如果您想要一个更准确的垂直中心，您可以在不考虑`padding-bottom`最后一个列表项的情况下进行数学运算，因为它的填充底部不可见。`margin-top:-70px`稍微居中一些。

* * *

**更新**以在浏览器窗口中垂直居中，同时尊重容器限制：

```
$(function() {
    var $pnav = $('#portfolio_nav'),
        $w = $(window);
    $pnav.css('top', 0);
    $w.scroll(function() {
        var $p = $pnav.parent(),
            pptop = parseInt($p.css('paddingTop'), 10),
            ppbottom = parseInt($p.css('paddingBottom'), 10),
            pheight = $p.height(),
            pnavheight = $pnav.height();
        $pnav.css('top', $w.height()/2 - ($p.offset().top + pptop) - pnavheight/2 + $w.scrollTop());

        var pnavpostop = $pnav.position().top;
        if (pnavpostop < pptop) $pnav.css('top', pptop);
        else if (pnavpostop + pnavheight > pptop + pheight + ppbottom) $pnav.css('top', pheight - pnavheight);
    }).scroll();
}); 
```

[**小提琴**](http://jsfiddle.net/ult_combo/GdQvw/4/)

# ios - 随机请求超时

> ID：12230269
> 
> 赞同：0
> 
> 时间：2012-09-01T18:25:57.000
> 
> 标签：ios, google-app-engine, afnetworking, testflight

我正在编写一个使用 AFNetworking 和 Google App Engine 作为后端服务的 iOS 应用程序。我遇到的问题是，在极少数情况下，我对服务器的请求会超时。我不知道如何重现它。我不知道问题出在客户端还是服务器端。

如果我终止该应用程序或从该应用程序的另一个实例发出新请求，它工作正常。我认为默认超时设置为两分钟左右，因此与接收不良或超时时间不够长无关。一个正常的请求在一秒钟内完成。

所以我要问的是，调试它的最佳方法是什么？

**编辑：所以我终于找到[了这个](https://github.com/AFNetworking/AFNetworking/issues/307)链接。似乎是试飞的问题（我也在使用）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:38:35.890

如果您正在寻找与 Internet 问题相关的调试，您可以使用一些 Web 调试工具。有一个名为 Charles 代理的工具，它易于使用且功能多样。您可以控制您的互联网带宽/速度等以产生不同的场景以获得更好的调试。这是链接： http: [//www.charlesproxy.com/](http://www.charlesproxy.com/)

# php - cURL + 通过浏览器下载文件

> ID：12230271
> 
> 赞同：3
> 
> 时间：2012-09-01T18:26:02.717
> 
> 标签：php, curl, download, save

当我使用 cURL 下载一些文件时，cURL 会将文件打印到浏览器。但我想打开“保存到”浏览器下载窗口。我怎样才能做到这一点？

```
$c = curl_init();
curl_setopt($c, CURLOPT_URL, $url);
curl_setopt($c, CURLOPT_POSTFIELDS, "file_name=test.rar");
curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
curl_setopt($c, CURLOPT_FOLLOWLOCATION, true);
curl_exec($c);
curl_close($c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:31:18.487

```
ini_set('memory_limit','128M');
$content = curl_exec($c);
curl_close($c);

header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename=your_file.txt');
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
header('Content-Length: ' . strlen($content));
ob_clean();
flush();
echo $content;
flush(); 
```

# objective-c - 在自定义单元格中维护来自 UITextViews 的值

> ID：12230272
> 
> 赞同：0
> 
> 时间：2012-09-01T18:26:06.367
> 
> 标签：objective-c, ios, uitableview, uitextview, custom-cell

我有一个填充了可变数组的表。单元格是自定义的，带有 UITextView，委托给 customcellclass，我想保留该值。每个表 reloadData 后它都会被删除。

关于如何保持它的任何想法？我有但无法实现的想法：

*   将 textView 值存储在填充表的同一数组中。从哪里？TextViewDidEnd 编辑？如何传递值，以及如何知道它是哪一行？
*   保持一个 textViews 数组彼此分开。与单元格表通信的同样问题，然后我也必须维护这个数组。此外，我应该将 textView 远离 .nib。...我没有想出更多的知道。

任何方法或帮助将不胜感激。谢谢！

PS：我做了很多搜索，大部分是针对表格的，但这是一个可变数组，我的表格上会有未定义的行。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Cell";

GuiCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"GuiCustomCell" owner:nil options:nil];

    for (UIView *view in views) {
        if([view isKindOfClass:[UITableViewCell class]])
        {
            cell = (GuiCustomCell*)view;
        }
    }   
}

if (timesArray || [timesArray count]) {        

    TakenTime *time = [[TakenTime alloc] init];
    time = [timesArray objectAtIndex:indexPath.row];

    if ([timeFormat isEqualToString:@"seconds"]) {
        cell.detailTextLabel.text = [time stringTimeFormat2];
    } else {
        cell.detailTextLabel.text = [time stringTimeFormat1];
    }

    cell.detailTextLabel.font = [UIFont systemFontOfSize:25];
    cell.textLabel.font = [UIFont systemFontOfSize:18];
    cell.textLabel.textAlignment = UITextAlignmentLeft;
    cell.detailTextLabel.textAlignment = UITextAlignmentCenter;
    cell.textLabel.text = [NSString stringWithFormat:@"%i.",indexPath.row+1];        

}else{

    cell.textLabel.text = @" ";

}

[cell setDefaultText:TRUE];

return cell; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:55:39.260

设置`cell.textLabel.delegate`为`self`(your `UIViewController`)，然后在`textFieldDidEndEditing:`方法中，可以这样检索 所在单元格对应的 indexPath `UITextField`：

```
-(void)textFieldDidEndEditing:(UITextField*)aTextField
{
    UITableViewCell* containerCell = (UITableViewCell*)aTextField.superview;
    NSIndexPath* indexPath = [self.tableView indexPathForCell:containerCell];
    // Store the text, for example in an NSMutableDictionary using the indexPath as a key
    [self.mutableDictionaryOfTextValues setValue:aTextField.text forKey:indexPath];
} 
```

当然，在您的`tableView:cellForRowAtIndexPath:`方法中，您将检索存储在其中的文本值`[self.mutableDictionaryOfTextValues objectAtIndex:indexPath]`并影响它`cell.textLabel.text`以恢复先前键入的文本。

*不要忘记在您的或类似的地方的方法中实例化您的`NSMutableDictionary`( `self.mutableDictionaryOfTextValues = [NSMutableDictionary dictionary];`) 。`init``UIViewController`*

* * *

请注意，这仅在您结束`UITextField`滚动前的版本时才有效，即当您的 UITextField 接收时`resignFirstResponder`（例如，如果您关闭键盘，或者用户单击另一个`UITextField`将成为新的 firstResponder），因为那是`textFieldDidEndEditing:`委托方法叫做。如果您想在用户每次输入字符或修改文本时存储文本，而不是等待用户进入另一个文本字段并被`textFieldDidEndEditing:`触发，则可以使用`textField:shouldChangeCharactersInRange:replacementString:`委托方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    // Compute the new text that we will obtain once the new character has been validated
    NSString* newText = [textField.text replaceCharactersInRange:range withString:string];
    // Store it in our dictionary. Same as before, but use newText instead of textField.text
    UITableViewCell* containerCell = (UITableViewCell*)aTextField.superview;
    NSIndexPath* indexPath = [self.tableView indexPathForCell:containerCell];
    // Store the text, for example in an NSMutableDictionary using the indexPath as a key
    [self.mutableDictionaryOfTextValues setValue:newText forKey:indexPath];
    // Accept the new character
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T22:01:55.923

此解决方案假设您为文本字段分配了标签，您可以在 cellForRowAtIndexPath 方法中声明标签：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:         (NSIndexPath *)indexPath {
//Code
// Configure the cell...
cell.myTextbox.tag = indexPath.row;
 } 
```

您可以在 textFieldDidEndEditing 方法中获取您的值：

```
-(void)textFieldDidEndEditing:(UITextField *)textField{

if ([textField.text isEqualToString:@""]) {
    textFieldContent[textField.tag] =@"";

}
textFieldContent[textField.tag] = textField.text;
} 
```

然后在 cellForRowAtIndexPath 方法中设置文本：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:      (NSIndexPath *)indexPath {
 MyTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Mycell" forIndexPath:indexPath];

// Configure the cell...
cell.myLabel.text = [nombres objectAtIndex:indexPath.row];
cell.myTextField.tag = indexPath.row;
if([textFieldContent count] < indexPath.row){
    cell.myTextField.text = @"";

}
else{
if ([textFieldContent count] == 0) {
    cell.myTextbox.text = @"";

}
else{
    cell.myTextbox.text = [textFieldContent objectAtIndex:indexPath.row];
}

}

return cell;
} 
```

# iphone - 如何使用 NSUserDefaults 保存两个文本字段的数据？

> ID：12230274
> 
> 赞同：0
> 
> 时间：2012-09-01T18:26:16.790
> 
> 标签：iphone, ios, nsuserdefaults

如何在 iOS 上使用 NSUserDefaults 保存两个文本字段的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:28:03.450

为了节省：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSDate date] forKey:FirstTextView];
[[NSUserDefaults standardUserDefaults] setObject:[NSDate date] forKey:SecondTextView];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

对于负载：

```
NSDate *textfield1Date = [[NSUserDefaults standardUserDefaults] objectForKey:FirstTextView];
NSDate *textfield2Date = [[NSUserDefaults standardUserDefaults] objectForKey:SecondTextView]; 
```

# c# - 在 azure 中托管共享 dll

> ID：12230275
> 
> 赞同：1
> 
> 时间：2012-09-01T18:26:16.943
> 
> 标签：c#, asp.net, winforms, dll, azure

我有一个 C# 类库，它正在编译到多个应用程序中，所有这些应用程序都托管为 Azure 上的 ASP.NET 4.0 WebForm 和/或 MVC 云服务。我想集中这个库，以便对包的任何更新都不需要在每个更新周期编译和部署每个项目。

显然，我可以选择创建 WCF 服务，但这需要我重构类库以及使用它的每个项目成为服务的消费者，并且由于系统的复杂性，这可能需要几个月的时间并且不是短期的选择。

由于我的所有项目都在 Azure 上的同一个 Affinity Group 中，是否有替代集中此 DLL 以及所有项目共享的方法的替代方法？我在网上找不到任何东西，所以我希望从社区中获得一些好的选择和想法。如果我遗漏了任何细节，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T20:47:07.963

David 在解释如何管理库的部署方面做得很好。但除此之外，您还需要对架构进行更改以支持这种相当动态的场景。

首先，您的应用程序不应使用实现，而应使用接口。假设您的库允许您计算税款，并且此税款计算器的实现每隔几周就会更改一次。您不想每次都为此更改您的应用程序，而且很明显，WCF 服务不适合您。

现在您可以按如下方式实现它：

*   类库：**TaxCalculator.Contracts**包含 ItaxCalculator 接口。
*   类库：**TaxCalculator.ImplementationABC**包含实现 ItaxCalculator 接口的 ABCTaxCalculator 类。
*   类库：**TaxCalculator.ImplementationDEF**包含实现 ItaxCalculator 接口的 DEFTaxCalculator 类（几周后）。
*   ETC...

您的 ASP.NET MVC 网站只能使用 ItaxCalculator 接口。使用[MEF](http://msdn.microsoft.com/en-us/library/dd460648.aspx)，您可以扫描文件夹 (LocalResource) 以查找包含实现 ItaxCalculator 接口的类的任何程序集。因此，您将 Web 应用程序与税收计算器库分离。

就像 David 已经解释的那样，您可以将最新版本的库存储在 blob 存储中，并在使用 MEF 加载程序集之前将其下载到本地（在 LocalResource 中）。这样，原始应用程序保持不变，您仍然可以对库进行必要的更改。

为了通知每个实例新版本已经发布，您有几个选项。您可以运行一个计时器来检查容器中的更改，您可以使用服务总线主题（每个实例都会订阅该主题），......但是就像大卫已经解释的那样，您需要管理滚动升级自己申请。

另一种方法是重新部署您的应用程序，而不是让计时器不断轮询 blob 容器中的更改，您可以简单地执行一个下载最新版本库的启动任务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T20:08:29.573

将共享 DLL 存储在同一数据中心的 blob 存储中怎么样？在角色启动时，每个实例都会将最新的 DLL 下载到其本地存储（在应用程序的根目录或其他需要的文件夹中）。

在同一个数据中心内，blob 存储和您的角色实例之间的带宽是免费的，并且 100Mbps x # 的核心，因此非常快。而且，要更新 DLL，您只需要将其上传到一个地方（blob 容器）。

在更新其中一个 DLL 时，您需要向您的角色实例发出信号以进行回收（最安全的方法），或者使用最新的 DLL 更新自己。您不能像拥有文件监视程序那样拥有“blob 监视程序”（因此建议发送信号）。或者，您可以让某种类型的后台线程每隔几分钟检查一次“dll”容器，并在发现一个已更改的容器时，在本地触发更新。

提醒一句：如果您更新 DLL，并且每个角色实例都在轮询更改（或收到信号以回收），请注意不要同时回收所有实例。否则，您将获得暂时不可用的服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T03:42:47.987

我也有同样的问题。我的方案是根据某些条件保留几个在运行时加载的插件，这些插件应该能够在不干扰主应用程序的情况下进行更新。

我所做的是将 dll 存储在 SQL 表中并在需要时检索它们，并在运行时使用反射加载它们。这是在内存中完成的，我不必将 dll 存储在应用程序根目录或其他地方。我认为在 Azure 中引用本地路径不是一个好习惯。

# wordpress - WordPress 网站中的拼贴画

> ID：12230276
> 
> 赞同：0
> 
> 时间：2012-09-01T18:26:25.440
> 
> 标签：wordpress, wordpress-theming

我正在为我们的一个客户开发一个 Wordpress 主题，他们的“关于我们”页面包含一个页面，里面全是人员/员工的照片，有两种不同的大小，董事会在大照片中，其他人在较小的图像中。我如何为此设计一个页面，以使照片适合屏幕。是否有任何免费插件可以提供帮助或无需插件即可实现的方法？需要帮忙。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:30:13.620

就在这里。看看实现 jQuery Masonry - 以最节省空间的方式拟合可变大小的图像/html 就是它的全部意义所在。

[http://masonry.desandro.com](http://masonry.desandro.com)

# list - Prolog - 计算所有患者的症状

> ID：12230277
> 
> 赞同：2
> 
> 时间：2012-09-01T18:26:25.190
> 
> 标签：list, count, prolog, member

我试图计算所有患者的症状来计算疾病的确定性因素，但我只是得到每种疾病的一种症状。
结果还显示了一些重复项。
确定性因素是患者症状的数量/疾病症状的总数：

```
start:- 
  write('Enter the name of the patient: '), read(Patient),
  write('Enter the symptoms: '), read(Symptoms), write('\n'),
  countSint(Diseases, Symptoms , Patient).

countSint(Diseases, Symptoms , Patient) :-
  findall(Sint , member(Sint, Symptoms),   L1), length(L1 , Size),
  (  Size < 2
  -> writeln('Enter with at least 3 symptoms...\n'), start
  ;  Size > 1
  -> write('\n Enter semicolon...:\n\n'), write('Patient: '), write(Patient),
     diagnose(Symptoms,Diseases, L)
  ).

diagnose(Symptoms,Diseases,L) :- search(Symptoms, Diseases, L).

% disease(Disease, Symptoms, Num).
disease(meningitis,[fever, stiff_neck],2).
disease(dengue,[fever, vomiting, red_spots], 3).

% search(Symptoms, Diseases, L).
search([H|T] , Diseases, L) :-
  disease(Disease, Symptoms, Num),
  Disease0 = [Disease,Diseases],
  member(H, Symptoms),
  search(T , Diseases0, L),
  write('has '), write(Disease), writeln(': '),
  setof(H, (disease(Disease, Symptoms, Num),
            member(H, Symptoms)), L),
  length(L, Size),
  calc_cf(Num, Size, R).

calc_cf(Num, Size, R):- % Calculate the certainty factor
  R is Size / Num * 100,
  write('The certainty factor is '),
  write(R),
  writeln('%'). 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:30:51.533

这似乎没用：

```
findall(Sint , member(Sint, Symptoms),   L1) 
```

只需将症状重写为 L1。为什么？

在这个片段中

```
 (  Size < 2
  -> writeln('Enter with at least 3 symptoms...\n'), start
  ;  Size > 1
  -> write('\n Enter semicolon...:\n\n'), write('Patient: '), write(Patient),
     diagnose(Symptoms,Diseases, L)
  ) 
```

应该有另一种选择。

这个事实`disease(Disease, Symptoms, Num).`应该是无用的，但它会引入未绑定的变量，使任何进一步的处理变得更加困难。

您可以考虑查看库（[聚合](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.1%27,swi%28%27/doc/Manual/aggregate.html%27%29%29)），在那里您可以找到精心设计的用于计数解决方案的谓词，例如

```
countSint(Diseases, Symptoms, Patient) :-
  aggregate(count, diagnose(Symptoms, Diseases, _), Count),
  format('diagnosed:~d for:~w~n', [Count, Patient]). 
```

**编辑**

最好将逻辑与演示分开，并在此处获得一些好的反馈，我认为您应该从代码中删除写入/读取，并显示一些您关心的示例。现在我展示你需要的*基本*公式，我可以从你的评论中猜到：

```
disease(meningitis, [fever, stiff_neck]).
disease(dengue, [fever, vomiting, red_spots]).

% find diseases from symptoms, sort by certainty factor
diagnose(Symptoms, Diseases) :-
     setof(CF-Disease, common_symptoms(Symptoms, Disease, CF), Diseases).

common_symptoms(Symptoms_Patient, Disease, CF) :-
    disease(Disease, Symptoms_Disease),
    intersection(Symptoms_Patient, Symptoms_Disease, Common_Symptoms),
    length(Common_Symptoms, NCS),
    length(Symptoms_Disease, NSD),
    CF is NCS / NSD * 100. 
```

测试：

```
?- diagnose([fever, stiff_neck],L).
L = [33.33333333333333-dengue, 100-meningitis]. 
```

# jsf - 如何从 JSF 页面获取 JAX-RS 绝对路径？

> ID：12230284
> 
> 赞同：1
> 
> 时间：2012-09-01T18:27:04.067
> 
> 标签：jsf, rest, javabeans, jax-rs, cdi

抱歉，我只是从所有这些 EJB、JSF 和 JAX-RS 的东西开始，现在需要你的帮助。我创建了一个 JAX-RS Resource 类，它工作得很好并且实现了@GET、@PUT 等方法。

在同一个项目中，我现在使用相应的 BackBean 创建了一个 JSF 页面。这个 Backbean 应该与 REST 接口对话。在测试时，我将 REST 接口的 URI 硬编码到 bean 中，但我当然希望以编程方式获取 URI。我尝试使用 @Produces 方法和注入，但总是得到 IllegalStateException。我认为这与上下文有关，但我实际上没有解决它的理解。

我的 REST 资源：

```
@Path("task")
@ManagedBean
@RequestScoped
public class TaskResource {

@Context
private UriInfo context;

@Inject TaskLifecycle lc;

public TaskResource() {
}

@GET
@Path("{id}")
public Response getTask(@PathParam("id") String id)  { ... etc. 
```

我的豆豆：

```
@ApplicationScoped
@LocalBean
@Named("tmmlWrapper")
public class TmmlTaskWrapperBean implements Serializable {

// Here another ManagedBean is injected, which works fine!
@Inject TaskLifecycle       lc; 
```

最后是我的 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org
/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>Tasklist</title>
</h:head>
<h:body>
    <h:form>
        <h:outputLabel ><h3>Tasklist:</h3></h:outputLabel>

        <h:dataTable value="#{tmmlWrapper.taskList}" var="tl">

        <h:column>

            <f:facet name="header">ID</f:facet>
            #{tl.id}

        </h:column> ... and so on ... etc. 
```

我的问题：我的 BackBean 如何获取 REST 资源的 URI（例如“http://exampledomain:8080/as”）？欢迎任何帮助！

干杯，乔恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:04:41.250

您首先需要访问生成的 HttpServletRequest 对象的底层 servlet 容器（假设是一个，而不是 portlet 容器）。使用该[`FacesContext`](http://download.oracle.com/docs/cd/E17802_01/j2ee/javaee/javaserverfaces/2.0/docs/api/javax/faces/context/FacesContext.html)对象以下列方式访问 HttpServletRequest 对象：

```
HttpServletRequest origRequest = (HttpServletRequest)FacesContext.getExternalContext().getRequest(); 
```

该类[`HttpServletRequest`](http://download.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)提供了几种实用方法来获得原始请求的近似表示：

*   [`getRequestURL()`](http://download.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRequestURL%28%29)，它提供了没有查询字符串的原始请求
*   `getScheme`, `getServerName`, `getServerPort`, `getContextPath`, `getServletPath`, `getPathInfo`，`getQueryString`所有的输出可以依次组合得到原始请求。如果您想要 URL 的较小片段，您可能必须省略后面的调用。

# jquery - 服务器验证后如何关闭jquery弹出窗口

> ID：12230286
> 
> 赞同：0
> 
> 时间：2012-09-01T18:27:26.017
> 
> 标签：jquery, asp.net, ajax

我正在使用 ASP.net 制作一个网站，我想用 JQuery ModalDialog 制作一个漂亮的登录弹出窗口（或 ajax ......我对 ajax 不太了解）。我有一个包含每个允许用户的数据库，如果用户成功登录，我想关闭弹出窗口（如果没有，我希望弹出窗口保留，并显示错误消息）。问题是我的验证是在服务器端完成的，而 JQuery 在客户端运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:30:46.377

最简单的方法是从你的对话框中调用一个jQuery ajax，然后在后面的代码中使用一个webmethod来监听这个ajax，这个webmethod将返回成功的登录，或者不成功并且你处理删除对话框客户端

我会给你一些示例代码

```
 function fnValidateLogIn() {         
        $('#<%= lblLoginMessage.ClientID %>').text("");
        var email = $('#<%= txtEmail.ClientID %>').val();
        var pass = $('#<%= txtPass.ClientID %>').val();
        if (pass == "") {
            $('#<%= lblLoginMessage.ClientID %>').text("Please Enter A Password");
            return false;
        }
        else {
            $.ajax({
                type: "POST",
                url: "Login.aspx/LoginUser",
                data: "{'email':'" + email + "', 'pass' : '" + pass + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var obj = $.parseJSON(msg.d);
                    if (obj.login == "failed") $('#<%= lblLoginMessage.ClientID %>').text("Login Failed");
                    if (obj.login == "success") {
                        location.reload(true);   //you can hide popup instead of refreshing
                        window.location = $('.hidden_url').text();  //you can hid popup instead of redirect 
                    }
                }
           });
            return false;
        }
    } 
```

代码背后：

```
 <System.Web.Services.WebMethod(EnableSession:=True)> _
       Public Shared Function LoginUser(email As String, pass As String) As String

        'code to validate user

       return "{ ""login "" : ""success"" }"  'example 
```

那是在 VB.Net 中，但你可以明白

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:40:02.523

这取决于您用于弹出窗口的 jquery 插件。

基本上你需要得到弹出的句柄。该插件应具有关闭功能，您需要在从服务器获得成功响应后调用它。他的大多数插件通常都有类似的东西`$("#pop_up_id").close();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:43:06.907

在服务器端创建一个返回字符串的 Web 方法

```
If successful login it will return 'success'
or if invalid login it willl return 'fail' 
```

现在在客户端使用 jQuery ajax 函数像这样对你的方法进行 ajax 调用

```
$.ajax(
url:your.asmx/webmethod
data:{username:$('#usernametextboxid').val(),password:$('#passwordtextbox').val()
type:'POST'
dataType:'json'
success:function(data){
//logic to hide popup

if(data.d=='success'){$('#modalpopupid').close()}
else if(data.d=='fail'){$('#modalpopupid').html('Invalid login')}
else{alert('some error occured.Please try again')}

}
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T18:43:13.007

Scott Selby，在您的代码中，您正在刷新页面，这正在扼杀 ajax 的含义。模态窗口只需调用插件的close()函数即可关闭，无需刷新页面。

# php - Swiftmailer 没有设置标题？

> ID：12230287
> 
> 赞同：0
> 
> 时间：2012-09-01T18:27:35.830
> 
> 标签：php, swiftmailer

我正在尝试使用 Swiftmailer 发送电子邮件，但它似乎没有设置标题？它发送正常，但电子邮件永远不会到达目的地。当我在 CPanel 中查看我的邮件递送报告时，收件人是未知的。所以我尝试回显标题，但每件事都是空白的......

这是我的代码...

```
 echo "submitting email...";
    $transport = Swift_SmtpTransport::newInstance('mail.example.com', 25)
    ->setUsername'username'
    ->setPassword('password');

    $mailer = Swift_Mailer::newInstance($transport);

    $attachment = Swift_Attachment::fromPath($_FILES['attachedfile']['tmp_name'])
    ->setFilename($name.'_'.$email);

    $message = Swift_Message::newInstance()
    ->setSubject('Submission')
    ->setFrom(array('myemail@email.com' => 'my name'))
    ->setTo(array('youremail@gmail.com' => 'your name'))
    ->setBody('Name: ' . $name . '\nEmail: ' . $email . '\nDescription: ' . $descr)
    ->attach($attachment);

    $headers =  $message->getHeaders();
foreach ($headers->getAll() as $header) {
  printf("%s<br />\n", $header->getFieldName());
}

    $failedRecipients = array();
    $result = $mailer->send($message, $failedRecipients);
if($result == 0) {
    echo "Failed sending email. Please try again later.<br/>";
} else {
    echo "Thanks for your submission!<br/>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:51:43.567

问题出在附件上……我做错了。我指向一个不存在的文件...哎呀。

# wcf - 通过配置设置访问 BehaviorExtensionElement

> ID：12230288
> 
> 赞同：1
> 
> 时间：2012-09-01T18:27:42.150
> 
> 标签：wcf, configuration, workflow-foundation

我有一个带有扩展的工作流服务，我通过自定义 BehaviorExtensionElement 进行配置。由于我还需要在我的应用程序的其他部分中重用一些配置属性，我想知道如何通过 ConfigurationManager 读取配置元素。

```
public class ServiceConfigurationElement : BehaviorExtensionElement
{
    public const string RetryDelayKey = "retryDelay";

    /// <summary>
    /// Creates a behavior extension based on the current configuration settings.
    /// </summary>
    /// <returns>
    /// The behavior extension.
    /// </returns>
    protected override object CreateBehavior()
    {
        var behavior = new ServiceConfigurationBehavior
            {
                RetryDelay = this.CommsRetryDelay
            };
        return behavior;
    }

    /// <summary>
    /// Gets the type of behavior.
    /// </summary>
    /// <returns>
    /// A <see cref="T:System.Type"/>.
    /// </returns>
    public override Type BehaviorType
    {
        get
        {
            return typeof(ServiceConfigurationBehavior);
        }
    }

    [ConfigurationProperty(RetryDelayKey, IsKey = false, DefaultValue = true)]
    public TimeSpan RetryDelay
    {
        get

        {
            return (TimeSpan)this[RetryDelayKey];
        }

        set
        {
            this[RetryDelayKey] = value;
        }
    }
} 
```

和配置：

```
<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior>
                <serviceConfiguration retryDelay="00:01:00" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <extensions>
        <behaviorExtensions>
            <add name="serviceConfiguration" type="MyNamespace.ConfigurationElement, MyAssembly"/>
        </behaviorExtensions>
    </extensions>
</system.serviceModel> 
```

如何通过 ConfigurationManager 读取 RetryDelay 属性（当然还有其他属性）？

谢谢

弗朗切斯科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T12:55:03.083

ConfigurationManager 没有明确的 ServiceModel 部分的属性。相反，Microsoft 提供了 ServiceModelSectionGroup ( [MSDN](http://msdn.microsoft.com/en-us/library/system.servicemodel.configuration.servicemodelsectiongroup.aspx) )，它允许您检索该部分以读取值。

首先，您需要使用各种方式加载配置文件，以便在 ConfigurationManager ( [MSDN](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager%28v=vs.100%29.aspx) ) 上打开它。下面我使用 OpenMappedExeConfiguration 方法。

```
ExeConfigurationFileMap exeConfigurationFileMap = new ExeConfigurationFileMap
{
    ExeConfigFilename = Assembly.GetEntryAssembly().Location + ".config"
};
Configuration configuration = ConfigurationManager.OpenMappedExeConfiguration( exeConfigurationFileMap, ConfigurationUserLevel.None ); 
```

之后，您将需要通过执行以下操作来检索该部分：

```
ServiceModelSectionGroup serviceModelGroup = ServiceModelSectionGroup.GetSectionGroup( configuration ); 
```

从那里您可以访问任何服务模型配置值。我会将您的行为修改为以下示例。注意命名的行为。

```
<behavior name="Configuration">
    <serviceConfiguration retryDelay="00:01:00" />
</behavior> 
```

一旦你有了部分组，就只需要获取行为扩展并遍历它们，就像这样。

```
ServiceBehaviorElementCollection serviceBehaviors = serviceModelGroup.Behaviors.ServiceBehaviors;

foreach ( ServiceBehaviorElement behavior in serviceBehaviors )
{
    if ( behavior.Name == "Configuration" )
    {
        ServiceConfigurationElement serviceConfiguration = behavior[ typeof( ServiceConfigurationElement ) ] as ServiceConfigurationElement;
        Console.WriteLine( serviceConfiguration.RetryDelay.ToString() );
        // do whatever you like here
    }
} 
```

您会看到我使用了 ServiceBehaviors，但 EndpointBehaviors 还有另一个属性。扩展它的一种方法是将服务模型部分组缓存在一个静态变量中（更少的磁盘 I/O），并编写一些方法来查询您将来可能编写的任何扩展的各种属性。

希望这可以帮助！

# shell - 在fish shell中运行时vim启动时出现vim错误

> ID：12230290
> 
> 赞同：14
> 
> 时间：2012-09-01T18:27:49.190
> 
> 标签：shell, vim, tmux, fish

这是我的错误：

```
~> vim .tmux.conf 
Error detected while processing /Users/###/.spf13-vim-3/.vim/bundle/syntastic/plugin/syntastic.vim:
line   23:
E484: Can't open file /var/folders/c4/4nb5t7cs3wb17_g1w5030xc40000gn/T/vmIMCqB/0
Error detected while processing /Users/###/.spf13-vim-3/.vim/bundle/vim-preview/plugin/preview.vim:
line   94:
E484: Can't open file /var/folders/c4/4nb5t7cs3wb17_g1w5030xc40000gn/T/vmIMCqB/1
Press ENTER or type command to continue 
```

我检查了每个文件中的这些行，它们都调用了我不熟悉的 system('uname')。我认为这个错误可能与 TERM （即 xterm-256color 外部 tmux 和 screen-256color 内部）有关，但在 .tmux.conf 中更改它没有效果。

任何文件都会发生这种情况。

我在 Mac OS X 10.8.1、vim 7.3、tmux 1.6 上并且正在使用 fish shell。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-01T21:07:00.443

该问题是由于使用 fish shell 作为默认 shell（在 my 中设置`.tmux.conf`）引起的。要解决此问题，请将其添加到`.vimrc`文件顶部：

```
set shell=/bin/sh 
```

这篇文章帮助我解决了问题：
[Debian Bug 报告日志 - #609599 vim-runtime: Error detected while processing ruby​​.vim](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=609599)。
还要感谢评论者@MichaelSchuller 和@romainl。

# c# - 如何在 MonoDroid 中使用 WCF 上传大文件

> ID：12230300
> 
> 赞同：0
> 
> 时间：2012-09-01T18:28:50.087
> 
> 标签：c#, wcf, xamarin.ios, xamarin.android, basichttpbinding

我正在尝试将 WCF 实现到 MonoDroid 中。我认为在这个问题上它和 MonoTouch 没有太大区别。而且经过研究，除了BasicHttpBinding之外，我找不到任何其他WCF绑定模式的支持。

老实说，我一点也不擅长 WCF，所以我只是随机尝试了一些方法。我可以使用字符串和字节 [] 等从服务器获取消息，但是当我想上传大数据时，例如。图片或音频，上传的包含大字节[]的消息必须限制在8192字节以下。这导致我的上传失败。

现在我能做的就是把big byte[]转换成Base64String，分割成8000bytes的片段，然后执行UploadAsyn(orderNumber,uploadStringBlock)之类的一堆命令，然后在服务器中用orderNumber重新重组。并从 Base64string 转换回字节。很忙很傻！

否则我必须想其他方法来解决从手机上传大文件的问题。

没有让所有的动作完全在 WCF 编码中实现真的是一个很大的遗憾和问题。

希望 Mono 改进它。如果有任何帮助，欢迎和赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:13:47.860

最好的办法是不使用 WCF 上传数据，而是使用普通的 HTTP 传输。使用 WCF 安全地获取上传令牌，该令牌可能只是一个 url，它对您可以执行 HTTP POST 的地址和将 POST 与您正在上传的用户/状态相关联的参数进行编码。

例如，您的 WCF 请求可以这样做：

```
string GetTokenForUpload ()
{
    var uuid = new UUID ();
    db.Insert (key: uuid, for: "upload", login: user.Credentials);
    return base_url + "?id=" + uuid; 
} 
```

然后在常规 ASHX 处理程序的 POST 处理程序上，您可以执行以下操作：

```
PostRequest (HttpRequest req, QueryString qstring)
{
    id = qstring ["id"];
    if (!db.Lookup (id, out userCredentials))
        error ();
    // accept post for the user.
} 
```

# wolfram-mathematica - 将 Prolog[] 与 LevelScheme 库一起使用时出现问题

> ID：12230305
> 
> 赞同：0
> 
> 时间：2012-09-01T18:30:04.753
> 
> 标签：wolfram-mathematica, levelscheme

我正在尝试使用`Prolog[]`LevelScheme`ListLinePlot[]`库。这是我正在尝试做的一个示例。

```
Figure[
 {
  Multipanel[
   {2, 1},
   XPlotRanges -> {0, 10},
   YPlotRanges -> {{-1, 1}, {-1, 1}},
   Margin -> 40,
   XFrameTicks -> LinTicks[0, 10, 1, 1],
   ExtendRange -> 0.03,
   XFrameLabels -> "Time (sec)", BufferB -> 3.5,
   YFrameLabels -> {"Out 1", "Out 2"}, BufferL -> 4.5,
   PanelLetterCorner -> {-1, -1},
   YGapSizes -> {0.1},
   Background -> White
   ],

  SetOptions[DataSymbol, SymbolSize -> 0.1],

  FigurePanel[{1, 1}],
  RawGraphics[
   ListLinePlot[Transpose[{Range[0, 10, 0.1], 
      RandomReal[{-1, 1}, 101]}], PlotRange -> All]],
  FigurePanel[{2, 1}],
  RawGraphics[
   ListLinePlot[Transpose[{Range[0, 10, 0.1], 
      RandomReal[{-1, 1}, 101]}], 
    PlotStyle -> {Black, Thick}, 
    Prolog -> {Opacity[0.1], Red, Rectangle[{0, -1}, {2.5, 1}], Green,
       Rectangle[{2.5, -1}, {7.5, 1}], Red, 
      Rectangle[{7.5, -1}, {10, 1}]}]]
  },
 ImageSize -> {600, 350}
 ] 
```

如果得到，这是输出，

![在此处输入图像描述](../Images/5417c96a19ba414a501f7d5201702791.png)

我不知道如何获得我想要的阴影——我在 Prolog 中提供的阴影。

如果有人能告诉我代码中的问题是什么，以及如何解决它，那将会很有帮助。

# c++ - glm::ortho() 实际上是错误的吗？

> ID：12230312
> 
> 赞同：25
> 
> 时间：2012-09-01T18:30:50.840
> 
> 标签：c++, opengl, orthogonal, glm-math

我最近认为从 OpenGL 提供的旧（已弃用）功能（例如矩阵运算和固定函数管道）切换是一个好主意。

我使用 GLM 作为我的矩阵库来简化一些事情。问题是它可能导致的问题比它简化的要多……

透视投影在我的着色器和设置中运行良好，但是当我尝试切换到正交时，一切都崩溃了。我的点和简单的四边形不会显示。当我使用旧的 OpenGL 矩阵时，事情又开始起作用了。

我把它缩小到投影矩阵。我是这样称呼它的：

```
glm::mat4 projMat = glm::ortho( 0, 400, 0, 400, -1, 1 ); 
```

我将其与 opengl 提供的那个进行了比较，一旦被调用“

```
glOrtho( 0, 400, 0, 400, -1, 1 ); 
```

唯一的区别是 [0][0] 元素和 [1][1] 元素（据我所知，它们分别等于“2/width”和“2/height”）。从 OpenGL 矩阵中，值就是这样！但是，在 glm 矩阵上，值是 0。

一旦我在调用 glm::ortho 后手动切换了 glm 矩阵中的值，一切都恢复正常了！

所以我的问题是： glm::ortho() 函数真的坏了，还是我用错了？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-01T18:40:55.143

似乎不应该从源代码中破坏它（v 0.9.3.4）

```
template <typename valType> 
GLM_FUNC_QUALIFIER detail::tmat4x4<valType> ortho
(
    valType const & left, 
    valType const & right, 
    valType const & bottom, 
    valType const & top, 
    valType const & zNear, 
    valType const & zFar
)
{
    detail::tmat4x4<valType> Result(1);
    Result[0][0] = valType(2) / (right - left);
    Result[1][1] = valType(2) / (top - bottom);
    Result[2][2] = - valType(2) / (zFar - zNear);
    Result[3][0] = - (right + left) / (right - left);
    Result[3][1] = - (top + bottom) / (top - bottom);
    Result[3][2] = - (zFar + zNear) / (zFar - zNear);
    return Result;
} 
```

我唯一的想法是这个模板可能正在创建一个整数矩阵（因为你已经将所有整数传递给函数），因此进行整数除法而不是浮点数。您可以尝试附加`.f`到所有参数吗？

`glm::mat4 projMat = glm::ortho( 0.f, 400.f, 0.f, 400.f, -1.f, 1.f );`

# sockets - 其他操作系统是否实现了Linux系统调用splice？

> ID：12230316
> 
> 赞同：5
> 
> 时间：2012-09-01T18:31:27.277
> 
> 标签：sockets, operating-system, implementation, system-calls, splice

在我正在开发的应用程序中，我[`splice`](http://en.wikipedia.org/wiki/Splice_%28system_call%29)在 Linux 上用于套接字到套接字的数据传输。

1.  其他操作系统（特别是 Windows、OS X 和 FreeBSD）是否实施`splice`或等效的解决方案？
2.  是否可以使用¹ + ¹`splice`在 Windows 上模拟套接字到套接字的数据？`sendfile``memmap`

* * *

¹ 两者都以不同的名称存在于 Windows 上，我不记得了。

* * *

**更新**

您可以看到`splice`Linux 上 vs 用户空间缓冲区的性能改进。

[![去](../Images/4f3d3b3e5e5a89c212544926f43dcc47.png)](//portfusion.sourceforge.net/i/plot/1.svg)

*   `DF`, `DR`, `F`, `MF`,`MR`是我在不同隧道模式下的应用程序，`NX`是 NGINX Web 服务器
*   `-p+t`使用 Linux 系统调用`splice`
*   `+p-t`使用带有用户空间缓冲区的可移植实现
*   `+p+t`使用具有用户空间缓冲区和多个操作系统线程的可移植实现
*   条形图表示每秒**千兆字节的吞吐量**
*   一个 1 GB（1048576000 字节）的文件被 4 个并发客户端请求了 4 次

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T03:51:08.917

OpenBSD 有`sosplice`和`somove`：[http ://www.openbsd.org/cgi-bin/man.cgi?query=sosplice](http://www.openbsd.org/cgi-bin/man.cgi?query=sosplice)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T01:34:37.540

[想到TransmitFile](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740565%28v=vs.85%29.aspx)是winsock中从一个文件句柄流式传输到套接字的一种方式，但我不确定这是否会对您有所帮助，因为它用于从文件->磁盘流式传输。您可能可以将它与[内存映射文件](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684212%28v=vs.85%29.aspx)句柄一起使用。

过去我听过一些人将“内核模式”作为加快某些回显和简单服务器操作的方式，但我从未这样做过。

内核模式winsock的一些链接：

[http://blogs.msdn.com/b/wndp/archive/2006/02/24/introduction-to-winsock-kernel-wsk.aspx](http://blogs.msdn.com/b/wndp/archive/2006/02/24/introduction-to-winsock-kernel-wsk.aspx)

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff571084(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff571084(v=vs.85).aspx)

# excel - Excel：匹配两张表中的产品ID和列并插入数据

> ID：12230321
> 
> 赞同：1
> 
> 时间：2012-09-01T18:32:41.020
> 
> 标签：excel, vba

我有一个大约 30 列和数千行的大文件

```
ID           Price         Code          Description  .......
b13          5             1txt          asd          ..
k54          3             2txt1         sad          .. 
m3           2             4asd          asd          ..
a26          6             5add          dsd          .. 
```

另一个有 2 或 3 列和数百行的小文件，它有相同的 id 和一些额外的 id。一些 id 重复。

```
ID           Price         Code         
b13          5             1txt    
m3           2             4asd    
b13          5             1sdx 
```

我想要的只是将小文件中的数据复制（替换/更新）到同一列中的大文件中。如果某些产品在小文件中重复（如上例），则应为此添加新行。

每次我这样做时，小文件都会有不同的列。应该有一些通用的方法。

首先我使用 VLOOKUP ，然后使用 INDEX 和 MATCH ，但我只能使用这些文件手动复制这些文件中的特定信息。例如，只有一个特定的列。我怎样才能使它通用？适用于不同的小文件，**匹配列名并在更大的文件中更新**。

任何人都可以请给它的代码吗？

我试过索引匹配`=IF(ISERROR(INDEX(Sheet2!C:C,MATCH(A2,Sheet2!A:A,0))),E2,INDEX(Sheet2!C:C,MATCH(‌​A2,Sheet2!A:A,0)))`
问题是我必须在单独的列中输入它。`C:C`我还必须手动指定要查看 ( ) 的列

# html - URL 不能作为 HTML 框架 src

> ID：12230323
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:32:47.047
> 
> 标签：html, frames

我有以下 HTML 代码，它在 Mozilla 和 IE 上都没有提供任何输出。状态栏显示已连接到 www.Facebook.com 和 www.yahoo.com，但页面未显示。我在 Mozilla 和 IE 中测试过。

```
<HTML>   
  <head>
      <script src="scripts.js"></script>
  </head>
  <frameset cols="50%,50%">
      <frame src="http://search.yahoo.com/search?p=gmail" />
      <frame src="http://www.facebook.com/login.php" />
  </frameset>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:40:29.190

`frameset`tag 总是需要一个`DOCTYPE`标签。

**注意：**如果要验证包含框架的页面，请确保将其设置为“HTML Frameset DTD”或“XHTML Frameset DTD”。

PS：不确定HTML5是否存在此要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:39:44.600

这一行：

```
<frame src=<frame src="http://search.yahoo.com/search?p=gmail" /> 
```

带走第一个`'<frame src='`

# .net - 在 FIPS 模式下使用 OpenSSL 与 .NET

> ID：12230324
> 
> 赞同：4
> 
> 时间：2012-09-01T18:33:00.827
> 
> 标签：.net, c, build, openssl, fips

我已经构建了 OpenSSL FIPS 容器版本 2.0.1，然后使用该容器构建了 OpenSSL 1.0.1c（根据*OpenSSL FIPS 对象模块 v2.0 的用户指南中*的说明）：

```
SET FIPSDIR=C:\OpenSSL\FIPS

cd C:\OpenSSL\openssl-fips-2.0.1
ms\do_fips

cd C:\OpenSSL\openssl-1.0.1c
ms\do_nasm
nmake -f ms\ntdll.mak 
```

我在我的 .NET 应用程序中有这些导入（显然是使用上面的 libeay32.dll）：

```
[DllImport("libeay32", CallingConvention = CallingConvention.Cdecl)]
public extern static void ERR_load_crypto_strings();

[DllImport("libeay32", CallingConvention = CallingConvention.Cdecl)]
public extern static int ERR_print_errors_fp(SafeHandle file);

[DllImport("libeay32", CallingConvention = CallingConvention.Cdecl)]
public extern static int FIPS_mode_set(int onoff); 
```

问题是，当我打电话时`FIPS_mode_set(1)`，它正在返回`0`，这表明 FIPS 模式无法启用。

为了尝试找出问题的原因，我正在这样做：

```
ERR_load_crypto_strings();

using (FileStream fs = new FileStream...)
{
  ERR_print_errors_fp(fs.SafeFileHandle);
} 
```

这给了我这个错误信息：

`OPENSSL_Uplink(0FAF1000,08): no OPENSSL_Applink`

我试过寻找答案，但结果空洞 - 任何建议都将不胜感激！

## ****更新****

我尝试使用 Visual Studio 2008 命令行中的相同步骤而不是 Visual Studio 2010 命令行（我以前使用过）来构建它——它成功了！

但我不知道为什么它不能与 Visual Studio 2010 一起使用，而且我不想让 Visual Studio 2008 永远存在——知道如何让它与 Visual Studio 2010 一起构建吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-09T19:16:11.697

我徒劳地搜索了有关如何构建具有 OpenSSL FIPS 能力的可执行文件的完整说明，但只发现了挫折和死胡同。我终于通过多次试验和错误运行，发现以下工作没有任何构建错误。我在这里发布我的发现，希望它可以帮助一个可怜的灵魂寻找解决这个构建问题的方法（并希望为他们节省他们仍然留在头上的几根头发！）。

如何生成 FIPS 140-2 OpenSSL 可执行文件和库的摘要：（使用的构建机器是 Windows 7 Ultimate）。

以“管理员”身份执行以下步骤！！！

1- 安装 ActiveState Perl 并确保环境路径包括安装 Perl 的 bin 文件夹。（见[http://www.activestate.com/activeperl/downloads](http://www.activestate.com/activeperl/downloads)）

2- 安装 Nasm 并将路径添加到 %PATH% 环境变量。（见[http://sourceforge.net/projects/nasm](http://sourceforge.net/projects/nasm)）

3- 如果尚未安装，请安装 Visual Studio 2008 Pro（VS2010/2012/2013似乎无法正确构建！！）*。*

4- 将 OpenSSL-FIPS-2.0.9 src 分发解压到一个新文件夹（*不要*重复使用以前的相同文件夹！）。

5- 将 OpenSSL-1.0.2 src 分发版解压到一个新文件夹中（同样：*不要*重复使用以前的相同文件夹！）。

6- 启动 Visual Studio 2008 DOS 命令窗口（开始->程序->MS Visual Studio 2008->Visual Studio DOS 命令窗口）。

7- 在那个 DOS 窗口中：“Set FIPSDIR=C:\OpenSSL-FIPS-2.0.9”（或托管 OpenSSL-FIPS-2.0.9 src 分发的任何文件夹名称，刚刚在上面的步骤 4 中解压缩。另外：应该指定绝对FIPSDIR 的路径！！！）。

8- 如果为 x86 目标构建，请确保：从该 DOS 命令窗口中设置 PROCESSOR_ARCHITECTURE=x86。（否则链接失败！）。

9- CD C:\OpenSSL-FIPS-2.0.9（或等效）并输入：'ms\ms_fips'。在构建结束时应该看到“构建成功”。

10- CD C:\OpenSSL-1.0.2 并在 DOS 提示符下依次键入以下内容：

```
 -Perl Configure VC-WIN32 fips --prefix=C:\Build-OpenSSL-FIPS209
        (C:\Build-OpenSSL-FIPS209 will contain the build results when invoking 'INSTALL'. See below.)

    -ms\do_nasm  (ms\do_ms is NOT acceptable for FIPS-140-2 certification! Will use MASM instead of NASM)
        (For DEBUG versions then use flag debug-VC-WIN32 instead, then open ms\nt.mak after executing ms\do_nasm and replace all occurrences of /Zi with /Z7\. There should be three replacements. For 64-bit, use VC-WIN64A and ms\do_win64a. If ECP source distros were used in generating the FIPS library in the first step, then    corresponding "FIPS capable" OpenSSL must be built with the no­ec2m option.)

    -nmake -f ms\nt.mak  (for static libs. To build shared libs use: ntdll.mak)

    -nmake -f ms\nt.mak install 
```

11-完成。验证 (--prefix) 文件夹“C:\Build-OpenSSL-FIPS209”现在是否包含库、可执行文件和头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:11:45.530

在 openssl 文档中[提到](http://www.openssl.org/support/faq.html#PROG2)了此错误，表明您尚未创建和编译/链接适当的[applink](http://www.openssl.org/docs/crypto/OPENSSL_Applink.html)。

或者，我认为如果您没有将 openssl 库与具有正确运行时的代码链接起来（例如 /MD 如果您正在编译 c/c++ 包装器代码），则可能会发生此错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-03T20:33:08.803

更好地使用这个： http: [//sourceforge.net/projects/openssl-net/](http://sourceforge.net/projects/openssl-net/) - 它会为你节省很多问题。

OpenSSL 很复杂，因此 C# 包装器库非常有用。要使用 OpenSSL，您需要使用 pinvoke，这个库肯定会这样做。

或者，您可以使用外部实用程序 stunnel [http://www.stunnel.org/index.html](http://www.stunnel.org/index.html)，或通过 exec() 使用 openssl direclty，这样您可以在每次操作时获得更高的稳定性，以防 .NET 库表现不佳.

真的建议使用 WIndows Crypto API - [http://msdn.microsoft.com/en-us/library/windows/desktop/aa388162(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa388162(v=vs.85).aspx)因为它是基于标准的，它的工作原理相同方式，通过 C# 甚至 MSIE，使用系统证书存储库，它也可以导入和导出。

# c++ - Logger::getInstance 在 log4cplus 中导致 bad_alloc 异常

> ID：12230326
> 
> 赞同：1
> 
> 时间：2012-09-01T18:33:11.197
> 
> 标签：c++, windows, runtime-error, log4cplus

我正在尝试使用 log4cplus 在 C++ 应用程序中实现日志记录。我能够成功构建/链接（我将 log4cplus.lib 添加到我的附加库并将 log4cplus.dll 复制到构建/outdir）

当我运行我的应用程序时，当它执行我的 Logger::getInstance 调用时出现以下异常：

LogTesterConsole.exe 中 0x75cad36f 处的未处理异常：Microsoft C++ 异常：内存位置 0x0013ed8c 处的 std::bad_alloc..

我尝试将调用放在我的 main() 例程之外以及内部，并得到相同的结果。

有任何想法吗？

代码：-

```
 #include "stdafx.h"
 #include <log4cplus/logger.h>
 #include <log4cplus/loggingmacros.h>
 #include <log4cplus/configurator.h>
 using namespace log4cplus;
 int _tmain(int argc, _TCHAR* argv[])
 { 
   BasicConfigurator config;
   config.configure();
   Logger logger = Logger::getInstance(LOG4CPLUS_TEXT("main"));
   LOG4CPLUS_WARN(logger, LOG4CPLUS_TEXT("Hello, World!"));
   return 0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:41:11.773

如果您在调试中构建应用程序，请务必链接到 lib4CplusD.lib 和 lib4CplusD.dll。同样，发布应用程序应该链接 aginst lib4cplus.lib 和 lib4cplus.dll 我有相同的运行时错误，当我将调试应用程序与调试库链接时，问题得到了解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:51:49.847

尝试：-

```
int _tmain(int argc, _TCHAR* argv[])
 { 
   PropertyConfigurator::doConfigure(LOG4CPLUS_TEXT("log4cplus.properties"));
   Logger root = Logger::getRoot();
   try{
   Logger logger = Logger::getInstance(LOG4CPLUS_TEXT("main"));
    }
   catch(...) {
        cout << "Exception..." << endl;
        LOG4CPLUS_FATAL(root, "Exception occured...");
    }
   LOG4CPLUS_WARN(logger, LOG4CPLUS_TEXT("Hello, World!"));
   return 0;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-15T18:09:32.500

我知道这篇文章有点老了，但是当我昨天开始尝试 log4cplus v2.0.0 时遇到了完全相同的问题。

简短的回答：这是一个调试/发布构建问题。

现在为任何人拒绝更长的答案：

*   [我在这里](https://sourceforge.net/projects/log4cplus/)下载了 log4cplus (v2.0.0) 的最新稳定版本
*   我在 VS2017 中打开了 Visual Studio Soultuin，`./log4cplus-2.0.0/msvc14`并制作了`log4cplus`-Project（Windows SDK v10.0.16299.0；Platform Toolset v141）的发布版本（unicode）。一切都很顺利。
*   我制作了一个新的示例 C++-Solution 来尝试以前构建的 log4cplus。
*   使用 log4cplus 的设置：
    *   `log4cplusU.lib`作为附加依赖项添加到链接器
    *   添加`log4cplusU.dll`到输出目录
    *   将所有内容添加`./log4cplus-2.0.0/include`到附加包含中
*   对示例解决方案进行调试构建 (x86)。一切正常。
*   构建解决方案后，我点击“运行”以查看是否一切正常。

现在这就是我遇到@Josh 在他最初的帖子中描述的完全相同的问题的关键。现在实际的问题是，我制作了 log4cplus 的发布版本，但在我自己的应用程序的调试版本中使用了这个发布版本。

考虑到这一点，我制作了我自己的应用程序的发布版本，一切都像魅力一样！

我将完整的 VS2017 解决方案推送到了我的[GitHub-repo](https://github.com/VeMike/cpp-logging)，因此您可以“动手”重现问题。只需将此解决方案的配置更改为“调试”（x86）并观察它在运行时产生异常。将其更改为“Release”（x86）并观看它按预期工作！

# nhibernate - NHibernate 如何将此 SQL 查询转换为 QueryOver 或 Linq

> ID：12230327
> 
> 赞同：5
> 
> 时间：2012-09-01T18:33:41.550
> 
> 标签：nhibernate, queryover

我真的可以使用一些关于如何将此 sql 查询带到 NHibernate QueryOver 的指导。我的尝试是使用 Linq，因为我对 Linq 更熟悉一些。我们正在进行的项目正在使用 QueryOver，所以现在最好还是保持这条路线。

**工作 SQL 查询：将 DateTime 舍入到 1 分钟并正确分组/排序/计数...**

```
select dateadd(minute,(datediff(minute,0,dateTimeColumn)/1)*1,0), COUNT(*)
from PartData
group by dateadd(minute,(datediff(minute,0,dateTimeColumn)/1)*1,0)
order by dateadd(minute,(datediff(minute,0,dateTimeColumn)/1)*1,0) 
```

**返回预期结果：**

```
2012-08-31 00:00:00.000, 3
2012-08-31 00:01:00.000, 4
2012-08-31 00:02:00.000, 3
2012-08-31 00:03:00.000, 3
2012-08-31 00:04:00.000, 4
2012-08-31 00:05:00.000, 3
2012-08-31 00:06:00.000, 3
2012-08-31 00:07:00.000, 4
2012-08-31 00:08:00.000, 3 
```

**编辑**

我越来越近了……

```
private IQueryOver<entities.PartData, entities.PartData> PartPerHourQuery(ISession session)
{
    return session.QueryOver<entities.PartData>()
        .Select(
            Projections.Alias(
                Projections.GroupProperty(
                    Projections.SqlFunction(
                        new SQLFunctionTemplate(NHibernateUtil.DateTime, "DateAdd(mm,1,Date)"),
                        NHibernateUtil.DateTime, _partsDate))
                , "Date"),
            Projections.Alias(Projections.RowCount(), "Count"))
                .TransformUsing(Transformers.AliasToBean<entities.PartsPerHour>());
} 
```

产生以下 SQL：

```
SELECT DateAdd(mm,1,dateTimeColumn), count(*)
FROM [PartData] 
GROUP BY DateAdd(mm,1,dateTimeColumn) 
```

只需要弄清楚如何在那里获取 datediff :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T19:39:36.450

凭借毅力的力量，我成功地赢得了这场战斗。这是我对上述 SQL 查询的 QueryOver ......我相信我已经在这个 NHibernate 事情上转了个弯 :)

非常感谢任何有关改进或替代方法以重现预期结果的建议。

```
private IQueryOver<entities.PartData, entities.PartData> PartPerHourQuery(ISession session)
{
    return session.QueryOver<entities.PartData>()
        .Select(
            Projections.Alias(
                Projections.GroupProperty(
                    Projections.SqlFunction(
                        new SQLFunctionTemplate(NHibernateUtil.DateTime, "DateAdd(minute," +
                                                                         new SQLFunctionTemplate(
                                                                             NHibernateUtil.DateTime,
                                                                             "(DateDiff(minute, 0, Date)/1)*1") +
                                                                         ",0)"),
                        NHibernateUtil.DateTime, _partsDate))
                , "Date"),
            Projections.Alias(Projections.RowCount(), "Count"))
        .TransformUsing(Transformers.AliasToBean<entities.PartsPerHour>());
} 
```

# csv - scrapy 如何将项目导出为每个项目单独的 csv 文件

> ID：12230332
> 
> 赞同：21
> 
> 时间：2012-09-01T18:34:37.733
> 
> 标签：csv, scrapy, exporter

我正在抓取一个足球网站，蜘蛛（单个蜘蛛）从该网站的页面中获取多种项目：团队、比赛、俱乐部等。我正在尝试使用 CSVItemExporter 将这些项目存储在单独的 csv 文件中，teams.csv 、matches.csv、clubs.csv 等。

我不确定这样做的正确方法是什么。到目前为止我想到的唯一方法是创建我自己的自定义管道，如示例 [http://doc.scrapy.org/en/0.14/topics/exporters.html](http://doc.scrapy.org/en/0.14/topics/exporters.html) 并在 spider_opened 方法中打开所有需要的 csv 文件，即为每个 csv 文件创建一个 csv 导出器，并在 process_item 中放置代码以确定“item”参数是什么类型的项目，然后将其发送到相应的导出器对象。

无论如何，我还没有找到任何在scrapy中处理多个csv文件（每个项目类型）的例子，所以我担心我正在以一种不应该使用的方式使用它。（这是我第一次使用 Scrapy）。

迪奥梅德斯

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-03T16:38:53.560

我在这里发布了我用来`MultiCSVItemPipeline`根据上面 drcolossos 的答案生成的代码。

此管道假定所有 Item 类都遵循约定 *Item（例如 TeamItem、EventItem）并创建 team.csv、event.csv 文件并将所有记录发送到适当的 csv 文件。

```
from scrapy.exporters import CsvItemExporter
from scrapy import signals
from scrapy.xlib.pydispatch import dispatcher

def item_type(item):
    return type(item).__name__.replace('Item','').lower()  # TeamItem => team

class MultiCSVItemPipeline(object):
    SaveTypes = ['team','club','event', 'match']
    def __init__(self):
        dispatcher.connect(self.spider_opened, signal=signals.spider_opened)
        dispatcher.connect(self.spider_closed, signal=signals.spider_closed)

    def spider_opened(self, spider):
        self.files = dict([ (name, open(CSVDir+name+'.csv','w+b')) for name in self.SaveTypes ])
        self.exporters = dict([ (name,CsvItemExporter(self.files[name])) for name in self.SaveTypes])
        [e.start_exporting() for e in self.exporters.values()]

    def spider_closed(self, spider):
        [e.finish_exporting() for e in self.exporters.values()]
        [f.close() for f in self.files.values()]

    def process_item(self, item, spider):
        what = item_type(item)
        if what in set(self.SaveTypes):
            self.exporters[what].export_item(item)
        return item 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-03T07:31:26.233

你的方法对我来说似乎很好。Piplines 是 Scrapy 的一个很棒的功能，并且是 IMO 为类似您的方法而构建的。

您可以创建多个项目（例如 SoccerItem、MatchItem），并`MultiCSVItemPipeline`通过检查项目类将每个项目委托给其自己的 CSV 类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-08-13T00:11:12.220

我已经尝试了答案。它似乎在最新版本（2.21）中不起作用。

我已包含我的代码供您参考：

```
class MultiCSVItemPipeline(object):
    SaveTypes = ['CentalineTransactionsItem','CentalineTransactionsDetailItem','CentalineBuildingInfo']

    def open_spider(self, spider):
        self.files = dict([ (name, open(name+'.csv','w+b')) for name in self.SaveTypes ])
        self.exporters = dict([ (name,CsvItemExporter(self.files[name])) for name in self.SaveTypes])
        [e.start_exporting() for e in self.exporters.values()]

    def close_spider(self, spider):
        [e.finish_exporting() for e in self.exporters.values()]
        [f.close() for f in self.files.values()]

    def process_item(self, item, spider):
        what = type(item).__name__
        if what in set(self.SaveTypes):
            self.exporters[what].export_item(item)
        return item 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-15T01:06:45.233

我正在使用 Scrapy = "^2.5.0" 并且必须进行一些修改才能正常工作。我还为项目文件中的所有项目设置了`SaveTypes`（现在）动态。`defined_items`

```
from scrapy.exporters import CsvItemExporter
from YOUR_PROJECT import items

def item_type(item):
    return type(item).__name__

class MultiCSVItemPipeline(object):
    defined_items = [name for name, _ in items.__dict__.items() if "Item" in name]

    def open_spider(self, spider):
        self.files = dict(
            [
                (name, open("FOLDER_TO_SAVE/" + name + ".csv", "w+b"))
                for name in self.defined_items
            ]
        )
        self.exporters = dict(
            [(name, CsvItemExporter(self.files[name])) for name in self.defined_items]
        )
        [e.start_exporting() for e in self.exporters.values()]

    def close_spider(self, spider):
        [e.finish_exporting() for e in self.exporters.values()]
        [f.close() for f in self.files.values()]

    def process_item(self, item, spider):
        item_name = item_type(item)
        if item_name in set(self.defined_items):
            self.exporters[item_name].export_item(item)
        return item 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-28T19:04:12.927

这是我用来利用 scrapy 的[Item Pipline](https://docs.scrapy.org/en/latest/topics/item-pipeline.html)和 Exporters 来为每个被抓取的 Item 类类型输出一个单独的 csv 的代码。逻辑与[此示例](https://docs.scrapy.org/en/latest/topics/exporters.html#using-item-exporters)非常相似。

```
from scrapy.exporters import CsvItemExporter

class cvs_per_itemtype_Pipeline:

    def open_spider(self, spider):
        self.itemType_to_exporterAndCsvFile = {}     

    def process_item(self, item, spider):
        itemType = type(item).__name__ #item class name as str
        if itemType not in self.itemType_to_exporterAndCsvFile:
            csvFile = open(f'{itemType}.csv', 'wb')
            exporter = CsvItemExporter(csvFile)
            exporter.start_exporting()
            self.itemType_to_exporterAndCsvFile[itemType] = (exporter, csvFile)
        exporter = self.itemType_to_exporterAndCsvFile[itemType][0]
        exporter.export_item(item)
        return item

    def close_spider(self, spider):
        for exporter, csvFile in self.itemType_to_exporterAndCsvFile.values():
            exporter.finish_exporting()
            csvFile.close() 
```

# php - MySQL where NOT IN 名称数组？

> ID：12230338
> 
> 赞同：49
> 
> 时间：2012-09-01T18:35:35.830
> 
> 标签：php, mysql, sql

我想排除这些具有以下名称的专辑：

```
$ban_album_names = array('Wall', 'Profile', 'Cover', 'Instagram'); 
```

如何正确书写，

```
SELECT * FROM albums WHERE name NOT IN ??? 
```

我怎样才能让它在数组中查找，如果名称匹配它应该！= 行

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-09-01T18:45:05.847

试试这个：

```
$sql = "SELECT *
    FROM albums
    WHERE name NOT IN ( '" . implode( "', '" , $ban_album_names ) . "' )"; 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-09-01T18:42:57.530

MySQL代码是

```
SELECT * FROM albums WHERE name NOT IN ('Wall', 'Profile', 'Cover', 'Instagram') 
```

# php - ZendStudio 是否包含 apache？

> ID：12230339
> 
> 赞同：1
> 
> 时间：2012-09-01T18:35:36.497
> 
> 标签：php, apache, zend-studio

我已经安装了 ZendStudio 来开发 PHP，我想知道我需要安装 apache 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:49:34.843

是的，因为 Zend Studio 只是一个[IDE](http://en.wikipedia.org/wiki/Integrated_development_environment)，而 apache 是一个[Web 服务器](http://en.wikipedia.org/wiki/Web_server)。两者是完全不同的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:13:50.360

Zend Studio 没有捆绑网络服务器，但您可以在 Zend Studio 中使用任何您喜欢的网络服务器，包括但不限于 Apache、nginx、lighttpd 甚至 PHP 5.4 自己的内置网络服务器。但是，除非您将[Zend Server](http://www.zend.com/en/products/studio/features#serverint)用作 Web 服务器，否则集成将受到限制。

请注意，当您想从本地计算机提供网页时，您只需要本地安装的网络服务器。Zend Studio 具有各种系统连接器，因此您还可以使用远程服务器或虚拟机。通常最好让网络服务器在类似于生产站点的开发环境中运行，以防止系统设置冲突。

# c# - 在方法中本地创建的中止线程

> ID：12230340
> 
> 赞同：0
> 
> 时间：2012-09-01T18:35:43.787
> 
> 标签：c#, multithreading

下面的方法为每个连接到 TCP 侦听器的客户端创建并启动一个新线程。

```
void StartClientCommuncationThread(TcpClient Client)
{
    Thread TcpClientThread = new Thread(new ParameterizedThreadStart(HandleClientCommTask));
    TcpClientThread.Start(Client);
} 
```

我想在按下按钮时中止所有线程，但我不知道创建了多少线程并且我无法到达方法之外的线程。

按下按钮时如何中止线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:38:23.053

假设您实际上想要中止而不只是结束线程，是否有任何理由不能将线程引用存储在集合中，然后对每个人调用 abort()？

下面的评论是对的。如果你听一个取消令牌来结束一个线程会更好。但是，有时您无法控制某些线程，可以说由于第 3 方库，线程代码中的某些内容无响应。这是调用中止的好时机。请记住，不会正确清理任何内容，您的 finally 块可能无法执行，需要处理的句柄不会被处理，等等。调用 abort 是一项非常肮脏的工作。

如果您有权访问线程中运行的代码，您应该侦听取消标记，或者甚至只是一个共享（易失）布尔值，表明它是时候退出了。如果线程中有一个长`Thread.Sleep()`的，那么你应该用一个互斥体替换它，你可以用脉冲来唤醒线程并告诉它优雅地退出。

参考`IsBackground`线程上的属性。MSDN 说

> 后台线程与前台线程相同，只是后台线程不会阻止进程终止。

因此，如果您需要在应用程序运行时终止线程，则设置此属性不会做任何事情。

这是一个说明这一点的例子

```
public class DisposeTest : IDisposable
{
    public void Run()
    {
        while (true)
        {
            Thread.Sleep(TimeSpan.FromDays(1));
        }

        Dispose();

    }
    public void Dispose()
    {
        Console.WriteLine("disposing");
    }
}

public class TestDriver
{
    static void Main(string[] args)
    {
        var diposeTest = new DisposeTest();

        var thread = new Thread(diposeTest.Run)
                            {
                                IsBackground = true
                            };
        thread.Start();

        Thread.Sleep(TimeSpan.FromSeconds(1));
    }
} 
```

在这个应用程序中 dispose 永远不会受到打击，即使应用程序没有挂起并且没有错误地退出。这是一个坏主意，因为您可以让套接字保持打开状态，文件未关闭，sql 查询未完成，等等。

有很多方法可以结束线程，请注意如何结束它，因为如果不小心，使用 abort 这样做可能会导致副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:51:06.930

您可以做的是确保在开始之前使用**IsBackground = true**设置所有线程，然后单击按钮，您可以关闭生成所有线程的表单。[http://msdn.microsoft.com/en-us/library/aa457093.aspx](http://msdn.microsoft.com/en-us/library/aa457093.aspx)[在此处输入链接描述](http://msdn.microsoft.com/en-us/library/aa457093.aspx)

# javascript - 使用 Javascript 禁用 div 标签

> ID：12230341
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:35:47.407
> 
> 标签：javascript, html

我想使用 Javascript 禁用 div 标签。**我不想隐藏它**。我正在使用火狐浏览器。

我的菜单在 div 标签内。

我正在单击菜单中的 1 个并打开一个页面。在页面上，我有一个按钮。单击该按钮时，我想禁用所有菜单但不是整个页面。用户不能点击任何菜单。

我的代码是，

```
<div id="div1">
    <ul id="abc">
        Menu1 Menu2 Menu3 
    </ul>
</div> 
```

我试过`document.getElementById("div1").disabled=true;` 但没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:52:13.347

Div 元素没有标准`disabled`属性。您必须使用自定义 JS 来执行您认为“禁用” div 的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-12T13:15:41.927

您可能会喜欢这个示例：（取消注释 'Visibility:hidden' 行以完全禁用该元素。）

```
function disable(elementId, enabling) {

  el = document.getElementById(elementId);

  if (enabling) {
    el.classList.remove("masked");
  } else

  {
    el.classList.add("masked");
  }
}
```

```
.masked {
  position: relative;
  pointer-events: none;
  display: inline-block;
  //visibility:hidden; /* Uncomment this for complete disabling  */
}
.masked::before {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0px;
  left: 0px;
  visibility: visible;
  opacity: 0.2;
  background-color: black;
  content: "";
}
```

```
<button onclick="alert('Now, click \'OK\' then \'Tab\' key to focus next button.\nThen click \'Enter\' to activate it.');">Test</button>
<div id="div1" style="display:inline-block" class="masked">
  <button onclick="alert('Sample button was clicked.')">Maskakable</button>
  <button onclick="alert('Sample button was clicked.')">Maskakable</button><br/>
  <br/>
  <button onclick="alert('Sample button was clicked.')">Maskakable</button>
  <button onclick="alert('Sample button was clicked.')">Maskakable</button>
</div>
<button>Dummy</button>

<br/>
<br/>
<br/>
<button id="enableBtn" onclick="disable('div1',true);disable('enableBtn',false);disable('disableBtn',true);">Enable</button>
<button id="disableBtn" onclick="disable('div1',false);disable('enableBtn',true);disable('disableBtn',false);"  class="masked">Disable</button>
```

# python - 在 Python 中查找不同长度列表的每个组合

> ID：12230342
> 
> 赞同：0
> 
> 时间：2012-09-01T18:35:58.713
> 
> 标签：python, list, loops, permutation, combinations

> **可能重复：**
> [Python 中一组列表的所有可能排列](https://stackoverflow.com/questions/2853212/all-possible-permutations-of-a-set-of-lists-in-python)

我想在 Python 中找到不同长度字符列表的每种组合。例如，我有以下列表，它们定义了字符串中可能的字符：

```
list1=['a','d','e','f','b']
list2=['h','s','c','v','e', 'u', '?', "^", "k"]
list3=['a','d]
list4=[',','4','u','t','R','x', ' ']
list5=['%','e','u','y'] 
```

我想在字符串中找到列表的每个组合，即“aha,%”、“dha,%”、“eha,%”。

可以简单地使用不同的嵌套循环，但是对于更多列表，这是不切实际的。

这似乎应该是一个简单的问题。

# javascript - 如何用前导零显示时间？

> ID：12230343
> 
> 赞同：8
> 
> 时间：2012-09-01T18:36:14.163
> 
> 标签：javascript, datetime, time

我创建了一个时间函数来计算媒体播放的时间。它不显示任何前导零。我怎样才能让它显示任何前导零？

```
function converttoTime(timeInSeconds)
   {
    var minutes = Math.round(Math.floor(timeInSeconds / 60));
    var seconds = Math.round(timeInSeconds - minutes * 60);
    //var hours = Math.round(Math.floor(timeInSeconds / 3600));
    //time = time - hours * 3600;
    var time=minutes+':'+seconds;
    return time;
   } 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-09-01T18:39:57.373

这应该工作：

```
var time=('0'  + minutes).slice(-2)+':'+('0' + seconds).slice(-2); 
```

# variables - 循环中的可变活跃度

> ID：12230347
> 
> 赞同：1
> 
> 时间：2012-09-01T18:36:54.550
> 
> 标签：variables, compiler-construction, for-loop

我参加了编译器课程，现在我正在为考试练习。涵盖的主题之一是[可变活跃](http://en.wikipedia.org/wiki/Live_variable_analysis)度。

现在，在循环之外，如果我们有

```
1\. int a = 1;
2\. a++;
3\. int b = 2;
4\. a = b; 
```

那么变量“a”存在于 1-2 和 4 中，对吗？

在循环内部，如果我们有

```
1\. for (int i = 1; i < 3; i++) 
```

然后在循环内没有使用“i”值的其他操作，例如检查它的值等等，那么“i”只存在于赋值/增量点，对吗？

基本上问题是，对于上述循环，控制变量是存在于循环内还是仅在递增时存在？当然，除非该变量在循环内使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:06:02.590

> 变量“a”存在于 1-2 和 4 中，对吗？

对，那是正确的。或者，由于我们通常谈论一个变量在给定步骤之后或之前（而不是期间）是有效的，我应该说：`a`在步骤 1 之后、步骤 2 之前和步骤 4 之后是有效的（假设`a`将在这些说明之后的一段时间内使用） .

> 对于上面提到的循环，控制变量是在循环内还是在递增时存在？

您必须考虑循环的每一步何时发生。循环的执行将如下所示：

1.  我被初始化
2.  身体执行
3.  检查循环条件（读取在步骤 1 中设置的 i 的值）
4.  i 递增（假设循环条件为真）
5.  身体执行
6.  检查循环条件（读取在步骤 4 中设置的 i 的值）
7.  ...依此类推，直到条件为假

因此，每次主体执行后，都会通过读取执行主体之前设置的 i 的值来检查条件。这意味着我必须在身体的整个执行过程中活着。

# asp.net-mvc-3 - Membership.ValidateUser 总是返回 false

> ID：12230351
> 
> 赞同：1
> 
> 时间：2012-09-01T18:37:14.580
> 
> 标签：asp.net-mvc-3

我的 asp .net mvc3 应用程序有问题

当我创建一个新帐户时，我有一个登录操作方法和一个视图，例如“用户”，一切正常，用户已添加到 sql server DB，如您所见，它显示在“欢迎用户”上方：

但是当我使用这个用户登录时，它没有登录：用户永远不会被验证！

这是我的**创建操作**：

```
if (ModelState.IsValid)
            {
                // Attempt to register the user
                MembershipCreateStatus createStatus;
                Membership.CreateUser(newRegisteration.Username, newRegisteration.Password, null, null, null, true, null, out createStatus);

                if (createStatus == MembershipCreateStatus.Success)
                {
                    FormsAuthentication.SetAuthCookie(newRegisteration.Username, false /* createPersistentCookie */);
                }
                else
                {
                    ModelState.AddModelError("", ErrorCodeToString(createStatus));
                }

                db.RegisterObj.Add(newRegisteration);
                db.SaveChanges();
                return RedirectToAction("Index", "Home");
               //return RedirectToAction("Index");
                }
            else
            {
                return View(newRegisteration);
            } 
```

............. **登录操作**如下：

```
public ActionResult LogOn(string returnUrl, RegisterationModel model)
    {
        Membership.CreateUser(model.Username, model.Password);

         if (ModelState.IsValid)
        {

          if (Membership.ValidateUser(model.Username, model.Password))
         {
             FormsAuthentication.SetAuthCookie(model.Username, true);

           if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
              && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
             {
               return Redirect(returnUrl);
             }
          else
             {
               return RedirectToAction("Index", "Home");
             }
         }
       else
         {
           ModelState.AddModelError("", "The user name or password provided is incorrect.");
         }
      } 
```

我想添加打印屏幕，但我不能 bcz 我是新用户，任何人都可以帮助我,,,,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T07:59:23.940

您尝试使用现有名称创建用户。从 LogOn 中删除此字符串：

```
Membership.CreateUser(model.Username, model.Password); 
```

# model-view-controller - 在 MVC 中使用与视图相关的 For 循环

> ID：12230359
> 
> 赞同：1
> 
> 时间：2012-09-01T18:39:01.073
> 
> 标签：model-view-controller, design-patterns

这两条经常被提及的 MVC 建议似乎相互矛盾：

1.  视图中没有 for 循环或条件逻辑
2.  除了视图，其他地方都没有 HTML

假设我有 $items 必须作为无序列表输出。迭代逻辑不是必须有html吗？在这种情况下，我应该把它放在哪里？

在我看来，可重用性主张把它放在视图以外的地方，同时为模板作者提供标签、类等参数。

你怎么看？你为什么这么认为的实际原因是非常受欢迎的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:16:54.913

**在处理视图模板**上的列表和表格时，您总是会遇到某种循环。您听到人们争论在模板中添加视图逻辑是一个坏主意的原因与**ViewModel 范例**有关。

有时仅循环遍历数据是不够的，例如：

```
<?php foreach( $users as $user ): ?>
    <?php if ( in_array( $user->getId(), $members ) ): ?>
    <!-- Users is member --> 
```

在这种特定情况下，`user entity`没有方法`isMember()`来检查用户是否是成员。假设您使用的是用户实体附带的第 3 方模块，并且您不想扩展它以添加新的依赖项（例如组）。**您必须在域模型之外**检查这一点，以便如上例所示正确显示视图模板。

但是，在这种情况下，我们正在**向视图添加逻辑**：`if ( in_array( $user->getId(), $members ) )`。您应该将它放在您的**业务逻辑**或**视图逻辑**中。后者是使用**ViewModels**实现的。因此，不是让您的视图与域模型对象交互，而是**与 ViewModel 交互**，后者将实现`isMember()`方法并封装上述逻辑。

这种范式的主要思想是您的视图无法访问域模型，而是仅与 ViewModel 交互，**从而保持视图独立于域模型。**

**更新**

例如，如果您有设计/前端团队，您将不允许他们调用`$user->setName()`，但仅`$user->getName()`使用**ViewModel**您不会将此方法作为选项包含在内。

还有另一个例子：假设您的应用程序有皮肤/主题。如果您保留视图逻辑，就像在视图模板上的第一个示例中一样，您需要为具有类似模板的所有主题**复制此逻辑。**与您的模板分离后，您将避免重复的视图逻辑分布在您的视图模板中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:51:43.710

当然，您可以在视图中放置循环 - 您还打算如何渲染`<ul>`s？:))

您也可以放置*一些*条件逻辑，例如根据授权状态在右上角打印“注销”与“登录”，主要在模板的共享部分中。

重点是视图层必须完全不知道它呈现的数据：他是一堆数组/对象和浏览器中呈现的实际 HTML 之间的一个造物主。提供这样的数据是**控制器**的事情，即做出所有的决定，过滤的东西，等等。

想想 web 服务：您可以以不同的格式渲染*相同*的资源 [xml、json、纯 html] - 它是从任何地方获取数据的控制器，然后视图获取它并渲染正确的文档。

# ruby - 如何每小时执行一个函数并将结果添加到 Rails 的数据库中？

> ID：12230360
> 
> 赞同：1
> 
> 时间：2012-09-01T18:39:14.250
> 
> 标签：ruby, database, ruby-on-rails-3, automatic-storage

也许这是一个非常简单的问题，但我不知道如何解决。:-) Rails 应用程序是否有可能每小时执行一个功能，即在网络中查找客户端并将这些数据添加到日志数据库中？

我必须使用 cronjob 或类似的东西吗？或者在rails或其他东西中有一个很好的宝石？我在 google 中寻找解决方案，但没有找到适合这种情况的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:42:17.197

我喜欢[无论何时](https://github.com/javan/whenever)和[rufus-scheduler](https://github.com/jmettraux/rufus-scheduler)。两者都工作得很好。

# android - StoreData 连手机都重启了

> ID：12230361
> 
> 赞同：1
> 
> 时间：2012-09-01T18:39:42.093
> 
> 标签：android, sql, string, store

我的应用程序有这个外观

![](../Images/889dadd6fa3c7ab68ab922bdd860e2ad.png)

它似乎是一个带有几个 TableRows 的 TableLayout。在我的活动中，每个 TableRow 都有 3 个视图：ImageView、TextView 和一个 Button。

用户是通过输入他想要的文本并按下按钮来设置 ImageView 和 TestView 内容的人。

我将此数据存储在 stringArray 变量中，如果手机未重新启动或应用程序未关闭（强制关闭），则可以正常工作

如果发生这两种情况之一，我将丢失所有数据。

我一直在尝试通过 SharedPreferences 存储我的 StringArrays，但我不知道何时应该加载首选项，无论是在 OnCreate() 还是 OnResume() 或 OnStart 方法 () 中。

另一个问题是如何定义数组。我用这个：

字符串 [] 名称 = 新字符串 [500];

我不知道每次我开始活动时是否都会创建这个字符串。因为我想要的是加载以前的字符串（来自 SharedPreferences）并添加更多条目，而不是在每次重启手机时创建新条目，例如。

你认为我需要一个 SQL 数据库还是这个 StringArrays 没问题。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:16:50.800

您可能应该切换到使用数据库，因为您有一个大小为 500 的数组，将来可能会增加。

但是，如果您想继续使用 SharedPreferences，您应该在 onPause() 和 onStop() 方法中写入数据，并在对其运行操作之前使用 if else 语句查看您的数据是否为空。如果数据为空，则在继续之前从 SharedPreferences 中读取它。

# php - 访问主题文件夹中的 php 文件

> ID：12230367
> 
> 赞同：0
> 
> 时间：2012-09-01T18:40:50.803
> 
> 标签：php, wordpress, web

我正在尝试访问 wordpress 主题文件夹中的 php 文件。

我创建了一个页面调用download.php。从贝宝成功付款后，用户将被重定向到此文件。

如何在不使用[http://website.com/wp-content/themes/test/download.php](http://website.com/wp-content/themes/test/download.php)的情况下访问该文件。我想通过[http://website.com/download.php](http://website.com/download.php)访问该文件，并且还想知道如何使用在此文件中的 functions.php 中找到的函数。

请帮忙

我是个迷路者。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:20:30.487

可能是答案可以帮助某人。

为了解决这个问题，我创建了一个名为“下载”的页面，在我的 page.php 中，我检查了标题是否为“下载”，然后我在其中包含了文件 download.php。

感谢您的帮助乌梅尔伊克巴尔

# jsf-2 - 默认选项卡是第一个选项卡，当用户选择新选项卡时，选项卡永远不会重新呈现以反映更改

> ID：12230369
> 
> 赞同：0
> 
> 时间：2012-09-01T18:40:54.163
> 
> 标签：jsf-2, composite-component

这是我的复合组件名称文件是 tab.xhtml

```
 <composite:interface>   
    <composite:attribute name="totalTabs"/>     
     <composite:attribute name="tabNameList" required="true"/>        
     </composite:interface>  

 <composite:implementation>
  <div id="#{cc.id}" columns="#{cc.attrs.totalTabs}"styleClass="adjustTabsTableColumnMargin">
        <ui:repeat id="repeat" var="tabItem" value="#{cc.attrs.tabNameList}" varStatus="status">
            <h:commandLink  id="dynamicTabs" tabindex = "#{status.index + 1}" title="#{tabItem.title}" value="#{tabItem.name}" styleClass = "#{tabItem.isSelected?'tabSelected':'tabPane'}" >
                <f:setPropertyActionListener name="tabs.tabIndex" value="#{status.index + 1}"/>
                <f:ajax execute="#{@this}" listener="#{tabs.handleTabChange(tabItem, cc.attrs.tabNameList)}" render="@form"/>
            </h:commandLink>
        </ui:repeat>
    </div>
</composite:implementation> 
```

在支持 bean 名称中是选项卡，在会话范围内。

```
 public void handleTabChange(TabBean tabItem, List<TabBean> tabBeanList){

       for(TabBean tab: tabBeanList){

            if(tabItem.tabName.equal(tab.tabName){
              tab.setIsSelected(true);
            }else{
              tab.setIsSelected(false);
        }
    } 
```

tabBean 只是会话范围内的常规 bean，包含 setter、getter

```
 TabBean(String tabname, String title, String id, boolean select){
           this.tabname = tabname;
           this.title = title;
           this.id = id;
           this.select = select;
       }
       public void setIsSelected(boolean value){this.selected = value;}
       public boolean getIsSelected(){ return this.selected;}

@PostContruct
public List<TabBean> getTabPaneList(){

    List<TabBean> tabList = new ArrayList<TabBean>();
    TabBean tab = new TabBean("name1", "title1", "tab1", true);
    tabList.add(tab);
    tab = new TabBean("name2", "title2", "tab2", false);
    tabList.add(tab);

    return tabList;

} 
```

在我的主要 display.xhtml 文件标签中是：

```
 <ui:composition xmlns="http://www.w3.org/1999/xhtml"
            xmlns:ui="http://java.sun.com/jsf/facelets"
            xmlns:h="http://java.sun.com/jsf/html"
            xmlns:f="http://java.sun.com/jsf/core"
            xmlns:c="http://java.sun.com/jsp/jstl/core"
            xmlns:tp="http://ui.pax"
            template="/WEB-INF/layouts/standard_layout.xhtml"
            xmlns:uitags="http://java.sun.com/jsf/composite/uitags">

            <h:form id="formId" prePendid="false">
               <uitag:tab id ="tabTags" tabNameList="#{tab.getTabNameList}" />
            </h:form>

    </ui:composition> 
```

我希望选项卡在用户选择新选项卡时更改颜色，当用户选择新选项卡时 f:ajax 不会重新呈现一组选项卡，它保持默认选项卡是第一个选项卡我使用了 id :tabTags:tabTags渲染属性，但有一个异常包含未知 id ':tabTags:tabTags - 无法在组件 dynamicTabs 的上下文中找到它，f:ajax 只接受 @form 属性值，任何人都有任何想法，Baulse 你有任何想法？谢谢，这个问题已经花了我几天的时间，我现在很热。

# java - 在Android中更改自定义视图的宽度和高度

> ID：12230371
> 
> 赞同：8
> 
> 时间：2012-09-01T18:41:16.800
> 
> 标签：java, android, android-layout, crop, android-view

在我的 android 应用程序中，我有一个裁剪图像。因此，我将自定义视图编程为我的裁剪框。我可以移动裁剪框。但我的问题是如何拖动裁剪框的边框并更改它的宽度和高度。我该怎么做？

属性类：

```
public class Attr {

    public static final float CROP_BOX_START_X = 5;
    public static final float CROP_BOX_START_Y = 5;
    public static final float CROP_BOX_END_X = 305;
    public static final float CROP_BOX_END_Y = 105;

} 
```

裁剪框类：

```
public class CropBox extends View {

    private Paint paint = new Paint();

    public CropBox(Context context) {
        super(context);
    }

    public CropBox(Context context, AttributeSet attributeSet) {
        super(context, attributeSet);
    }

    @Override
    public void onDraw(Canvas canvas) {
        float[][] circleXY = {
            {Attr.CROP_BOX_START_X, Attr.CROP_BOX_START_Y},
            {(Attr.CROP_BOX_START_X + Attr.CROP_BOX_END_X) / 2, Attr.CROP_BOX_START_Y},
            {Attr.CROP_BOX_END_X, Attr.CROP_BOX_START_Y},
            {Attr.CROP_BOX_START_X, Attr.CROP_BOX_END_Y},
            {(Attr.CROP_BOX_START_X + Attr.CROP_BOX_END_X) / 2, Attr.CROP_BOX_END_Y},
            {Attr.CROP_BOX_END_X, Attr.CROP_BOX_END_Y},
            {Attr.CROP_BOX_START_X, (Attr.CROP_BOX_START_Y + Attr.CROP_BOX_END_Y) / 2},
            {Attr.CROP_BOX_END_X, (Attr.CROP_BOX_START_Y + Attr.CROP_BOX_END_Y) / 2}
        };
        float[][] lineXY = {
            {Attr.CROP_BOX_START_X, Attr.CROP_BOX_START_Y, Attr.CROP_BOX_END_X, Attr.CROP_BOX_START_Y},
            {Attr.CROP_BOX_START_X, Attr.CROP_BOX_END_Y, Attr.CROP_BOX_END_X, Attr.CROP_BOX_END_Y},
            {Attr.CROP_BOX_START_X, Attr.CROP_BOX_START_Y, Attr.CROP_BOX_START_X, Attr.CROP_BOX_END_Y},
            {Attr.CROP_BOX_END_X, Attr.CROP_BOX_START_Y, Attr.CROP_BOX_END_X, Attr.CROP_BOX_END_Y}
        };

        paint.setColor(Color.CYAN);
        paint.setStrokeWidth(1);

        for(int i = 0 ; i < circleXY.length ; i++)
            canvas.drawCircle(circleXY[i][0], circleXY[i][1], 5, paint);

        paint.setStrokeWidth(2);

        for(int i = 0 ; i < lineXY.length ; i++)
            canvas.drawLine(lineXY[i][0], lineXY[i][2], lineXY[i][2], lineXY[i][3], paint);
    }

} 
```

CropTestActivity 类：

```
public class CropTestActivity extends Activity {

    private ImageView imageView;
    private CropBox cropBox;
    private RelativeLayout relativeLayout;
    private RelativeLayout.LayoutParams layoutParams;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.crop_test_layout);
        imageView = (ImageView)findViewById(R.id.android_image);
        cropBox = new CropBox(this);
        relativeLayout = (RelativeLayout)findViewById(R.id.crop_test_layout);
        layoutParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT);
        imageView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
            public void onGlobalLayout() {
                imageView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                layoutParams.leftMargin = imageView.getWidth() / 2 - (int)((Attr.CROP_BOX_START_X + Attr.CROP_BOX_END_X) / 2) + imageView.getLeft();
                layoutParams.topMargin = imageView.getHeight() / 2 - (int)((Attr.CROP_BOX_START_Y + Attr.CROP_BOX_END_Y) / 2) + imageView.getTop();
            }
        });
        relativeLayout.addView(cropBox, layoutParams);
        cropBox.setOnTouchListener(new Crop(imageView));
    }

} 
```

作物类别：

```
public class Crop implements OnTouchListener {

    private static final int NONE = 0;
    private static final int BOX_DRAG = 1;
    private static final int BORDER_DRAG = 2;

    private int mode = NONE;

    private float cropBoxStartX = Attr.CROP_BOX_START_X;
    private float cropBoxStartY = Attr.CROP_BOX_START_Y;
    private float cropBoxEndX = Attr.CROP_BOX_END_X;
    private float cropBoxEndY = Attr.CROP_BOX_END_Y;

    private ImageView imageView;

    private PointF start = new PointF();

    public Crop(ImageView imageView) {
        this.imageView = imageView;
    }

    public boolean onTouch(View view, MotionEvent event) {
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams)view.getLayoutParams();

        switch(event.getAction() & MotionEvent.ACTION_MASK) {

            case MotionEvent.ACTION_DOWN:
                start.set(event.getX(), event.getY());
                if(event.getX() > cropBoxStartX && event.getX() < cropBoxEndX && event.getY() > cropBoxStartY && event.getY() < cropBoxEndY)
                    mode = BOX_DRAG;
                else if(event.getX() == cropBoxStartX || event.getX() == cropBoxEndX || event.getY() == cropBoxStartY || event.getY() == cropBoxEndY)
                    mode = BORDER_DRAG;
                else
                    mode = NONE;
                break;

            case MotionEvent.ACTION_UP:
                mode = NONE;
                break;

            case MotionEvent.ACTION_MOVE:
                if(mode == BOX_DRAG) {
                    layoutParams.leftMargin = (int)event.getX() - (int)start.x + view.getLeft();
                    layoutParams.topMargin = (int)event.getY() - (int)start.y + view.getTop();
                    while(layoutParams.topMargin + 5 < imageView.getTop())
                        layoutParams.topMargin++;
                    while(layoutParams.leftMargin + (cropBoxEndX - cropBoxStartX + 5) > imageView.getRight())
                        layoutParams.leftMargin--;
                    while(layoutParams.topMargin + (cropBoxEndY - cropBoxStartY + 5) > imageView.getBottom())
                        layoutParams.topMargin--;
                    while(layoutParams.leftMargin + 5 < imageView.getLeft())
                        layoutParams.leftMargin++;
                }
                else if(mode == BORDER_DRAG) {
                }
                break;
        }
        view.setLayoutParams(layoutParams);
        return true;
    }

} 
```

布局 XML：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/crop_test_layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/android_image"
        android:src="@drawable/android"
        android:layout_width="fill_parent"
        android:layout_height="300dp"
        android:layout_marginTop="10dp"
        android:layout_marginRight="10dp"
        android:layout_marginBottom="10dp"
        android:layout_marginLeft="10dp"
        android:layout_gravity="center"
        android:scaleType="fitXY"
        android:contentDescription="@string/android_image_description" >
    </ImageView>

</RelativeLayout> 
```

调整大小之前：

![在此处输入图像描述](../Images/04fed27a6ae32ec707c9610250e1af99.png)

调整大小后：

![在此处输入图像描述](../Images/24395819864e4f1118948f14687f38e4.png)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T10:06:00.680

以下是解决方案，

从Activity修改onCreate

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.crop_test_layout);
    imageView = (ImageView)findViewById(R.id.android_image);
    cropBox = new CropBox(this, imageView);
    relativeLayout = (RelativeLayout)findViewById(R.id.crop_test_layout);
    relativeLayout.addView(cropBox);
} 
```

修改后的 CropBox 类：

```
public class CropBox extends View {

    private static final int CROP_BOX_START_X = 5;
    private static final int CROP_BOX_START_Y = 5;
    private static final int CROP_BOX_END_X = 305;
    private static final int CROP_BOX_END_Y = 105;

    private static final int DRAG_SQUARE = 75;

    public ImageView mImageView;
    boolean mIsFirstClick = false;

    private Paint paint = new Paint();
    private Rect mRect;

    public CropBox(Context context, ImageView aBaseView) {
        super(context);
        mImageView = aBaseView;
        mRect = new Rect(CROP_BOX_START_X, CROP_BOX_START_Y, CROP_BOX_END_X, CROP_BOX_END_Y);
        setOnTouchListener(new Crop());
    }

    public CropBox(Context context, AttributeSet attributeSet) {
        super(context, attributeSet);
    }

    @Override
    public void onDraw(Canvas canvas) {

        paint.setStrokeWidth(2);

        paint.setColor(Color.CYAN);
        paint.setStyle(Paint.Style.STROKE);

        canvas.drawRect(mRect, paint);

        canvas.drawLine(mRect.right-DRAG_SQUARE, mRect.bottom-DRAG_SQUARE, 
                mRect.right, mRect.bottom-DRAG_SQUARE, paint);

        canvas.drawLine(mRect.right-DRAG_SQUARE, mRect.bottom-DRAG_SQUARE, 
                mRect.right-DRAG_SQUARE, mRect.bottom, paint);
    }

    class Crop implements OnTouchListener {

        private static final int NONE = 0;
        private static final int BOX_DRAG = 1;
        private static final int BORDER_DRAG = 2;

        private int mode = NONE;

        private PointF start = new PointF();

        public boolean onTouch(View view, MotionEvent event) {
            RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams)view.getLayoutParams();

            switch(event.getAction() & MotionEvent.ACTION_MASK) {

                case MotionEvent.ACTION_DOWN:
                    start.set(event.getX(), event.getY());

                    if((event.getX() <= mRect.right && event.getX() >=(mRect.right - DRAG_SQUARE)) 
                            && (event.getY() >= mRect.top && event.getY() >=(mRect.bottom - DRAG_SQUARE))){
                        mode = BORDER_DRAG;
                        mIsFirstClick = false;
                    }
                    else if(mRect.contains((int)event.getX(), (int)event.getY())) {
                        mode = BOX_DRAG;
                        if (mIsFirstClick){
                            mRect = new Rect(CROP_BOX_START_X, CROP_BOX_START_Y, 
                                    CROP_BOX_END_X, CROP_BOX_END_Y);
                            mIsFirstClick = false;  
                        } else {
                            mIsFirstClick = true;   
                        }
                    }
                    else{
                        mode = NONE;
                        mIsFirstClick = true;
                    }
                    break;

                case MotionEvent.ACTION_UP:
                    mode = NONE;
                    break;

                case MotionEvent.ACTION_MOVE:
                    mIsFirstClick = false;
                    if(mode == BOX_DRAG) {
                        layoutParams.leftMargin = (int)event.getX() - (int)start.x + view.getLeft();
                        layoutParams.topMargin = (int)event.getY() - (int)start.y + view.getTop();
                    }
                    else if(mode == BORDER_DRAG) {
                        if (event.getX() > view.getLeft() && event.getY() > view.getTop()){
                            mRect.right = (int) event.getX();
                            mRect.bottom = (int) event.getY();
                        }
                    }
                    while(layoutParams.topMargin + 5 < mImageView.getTop())
                        layoutParams.topMargin++;
                    while(layoutParams.leftMargin + mRect.right > mImageView.getRight())
                        layoutParams.leftMargin--;
                    while(layoutParams.topMargin + mRect.bottom > mImageView.getBottom())
                        layoutParams.topMargin--;
                    while(layoutParams.leftMargin + 5 < mImageView.getLeft())
                        layoutParams.leftMargin++;
                    break;
            }
            view.setLayoutParams(layoutParams);
            invalidate();
            return true;
        }
    }
} 
```

我想提几点。

*   在 CropBox 中合并 Attr 和 Crop
*   无需从线条创建矩形。您可以使用**Rect**。
*   切勿在 Draw 方法中初始化数组/对象
*   添加了一个功能：如果在矩形上双击它会返回到原始位置
*   关于在 imageview 中限制 rect 可能存在一些问题。我相信您可以解决这些问题... :)

除此之外，还有另一种有趣的方式使用[触摸事件在 Canvas 中缩放画布图像](https://stackoverflow.com/questions/5743328/android-image-in-canvas-with-touch-events/5747233#5747233) 使用该类而不是 Cropbox 并尝试它。

希望能帮助到你..

# jquery - Jquery 自定义复选框和单选没有使用 .val() 正确传递值

> ID：12230375
> 
> 赞同：0
> 
> 时间：2012-09-01T18:42:04.600
> 
> 标签：jquery, ajax, plugins

我正在使用位于此处的插件：http: [//www.maratz.com/blog/archives/2006/06/11/fancy-checkboxes-and-radio-buttons/](http://www.maratz.com/blog/archives/2006/06/11/fancy-checkboxes-and-radio-buttons/)

设置我的单选按钮和复选框的样式。当我在不使用 jQuery.get 的情况下提交表单时，所有值都被很好地传递了。但是当我尝试使用以下方法提取值时：

```
 var sort = $('input[name=sort]:checked').val(); 
```

它不起作用。无论检查“新”电台还是“过期”电台，它都会一直说“新”。我试图弄清楚我到底做错了什么。我还尝试提取在选择“广播”按钮时使用类别.r_on的标签的值，但我也无法做到这一点。

```
$(document).ready(function(){

var sort = $('input[name=sort]:checked').val();
var location = $('#location').val();

$('.filter_submit').click(function(){
    $.get("../bin/open_tasks.php", "sort=" + sort + "&location=" + location , function(data){
        alert("Data Loaded: " + data);
        });//end get request
    return false;
    });//end click 

});

<fieldset class="radios">
            <label class="label_radio" for="new">Newest<input id="new" checked="checked" class="" type="radio" name="sort" value="new"></label><br>
            <label class="label_radio" for="expire">Expiring First<input id="expire" class="" type="radio" name="sort" value="expire"></label>
        </fieldset> 
```

这是我写的只是为了测试它的php：

```
<?php 

    echo "loaded kinda";

    echo " ".$_GET['sort']." ";
    echo $_GET['location'];

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:33:12.177

您将获得页面加载 ( `.ready`) 的值。这太早了——这将是当时的价值，总是一样的。

您可能希望在提交时获取该值，以便更新单选按钮为您获取更新后的值。只需将`.val()`线移动到`.click`处理程序中。线路也是如此`#location`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:44:39.470

你可以试试这个

```
 if ($('input[name=sort]').is(':checked')) { 
```

而不是这个

```
 var sort = $('input[name=sort]:checked').val(); 
```

编辑：

那这个呢

```
 $('input[name=sort]').change(function () {
             //this will fire when radio button is clicked
             //store this information somewhere
           } 
```

# linqpad - 我可以为我的自定义 LINQPad 数据上下文驱动程序提供自定义图标吗？

> ID：12230377
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:42:22.583
> 
> 标签：linqpad

我最近开始编写[LINQPad 数据上下文驱动程序](http://www.linqpad.net/extensibility.aspx)来访问各种类型的系统。不幸的是，我编写的每个驱动程序都使用相同的“齿轮”图标。这使得辨别他们的类型比如果他们有一个特定类型的图标更难。

有没有办法为驱动程序提供自定义图标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:24:19.750

乔的评论不是在开玩笑。LINQPad Beta 版本 4.42.10 的发行说明包含以下内容：

> 您现在可以在编写数据上下文驱动程序时指定自定义图标。只需在 .lpx 包中包含两个文件：Connection.png 和 FailedConnection.png（如果数据上下文无法加载，则应用后者）。

发行说明没有提到（但一旦您检查现有图标就很明显）是图标需要为 16x16 像素。

# php - 表单上的 image_x image_y 提交而不是“图像”中的“值”？

> ID：12230379
> 
> 赞同：0
> 
> 时间：2012-09-01T18:42:50.340
> 
> 标签：php, html, image, post

我尝试创建一个语言选择页面，但是在提交 id="image" name="image" 的“值”参数时没有通过，而是在 $_POST 中获得了 image_x 和 image_y 值。

这是我的代码：

```
session_start();

include("languages.php");
function lng($which)
{
    global $ARRXKS;
    return $ARRXKS[$_SESSION['lang']]["$which"];
}

function LangChoose()
{
    echo('
        <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Meet-Helmond.nl SMS Service - Select your Language</title>
        <link href="css.css" rel="stylesheet" type="text/css" />
        </head>

            <div class="information">
            <div class="boxinfo">Cookies MUST be enabled to use this website!</div>
            <p>

            <form id="loginForm" name="loginForm" method="post" action="index.php">');
            echo('<BR />');
            print_r($_POST);
            echo('<BR />');
            global $ARRXKS;
            $LANG_keys = array_keys($ARRXKS);
            $count = 1;
            for ($i = 0; $i <= count($ARRXKS) - 1; $i++)
            {
                echo('<input type="image" src="images/flags/'.$LANG_keys[$i].'.png" name="image" id="image" value="'.$LANG_keys[$i].'">');
                if((($count) % 5) == 0)
                {
                    echo('<BR />');
                }
                $count = $count + 1;
            }

            echo('
            </form>

            </div>

        <body>

        </body>

        </html>

    ');
}
//print_r($_POST);
if(!isset($_SESSION['lang']))
{
    if ($_SERVER['REQUEST_METHOD'] == 'POST')
    {
        if(isset($_POST['image']))
        {
            if (array_key_exists($_POST['image'], $ARRXKS))
            {
                $_SESSION['lang'] = $_POST['image'];
            }
            else
            {
                LangChoose();
                exit();
            }
        }
        else
        {
            LangChoose();
            exit();
        }
    }
    else
    {
        LangChoose();
        exit();
    }
} 
```

所以当我检索它时，它没有检测到我选择了哪种语言，我怎样才能正确提交点击图像的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:59:48.277

提交时的图像没有任何价值。相反，以像素为单位的 x 和 y 坐标由浏览器提交。这是完全正常的，也是图像输入元素的工作方式。

相反，您可能希望通过其 CSS 样式或更现代的按钮输入元素使用具有图形的提交按钮。

使用您选择的 HTML 参考来阐明您对输入图像标记的理解，并了解提交输入和按钮输入。

# html - 网站的 Div 限制

> ID：12230386
> 
> 赞同：-2
> 
> 时间：2012-09-01T18:43:24.383
> 
> 标签：html

一个网页一次可以有多少个 div？什么会控制这个限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:44:27.687

网站上的 div 数量没有任何限制（除了您机器上的内存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:52:54.513

任何现代浏览器都没有硬性限制。我之前确实在页面上迭代并打印了数千个 div。您真正的限制因素将是您希望页面有多大，当然，最终您的页面将需要很长时间才能加载。

我刚刚运行了一个测试用例，我在一个页面中插入了 2,097,152 个 div，虽然响应速度很慢，但最终它确实出现了，没有阻塞 IE 或 Chrome。

如果您需要更多信息，或者可能需要帮助找出一种不需要太多 div 以至于需要这个问题的方法，请告诉我们。

# php - 如何实现{script}文件夹/文件{/script}

> ID：12230387
> 
> 赞同：0
> 
> 时间：2012-09-01T18:43:43.067
> 
> 标签：php, javascript, joomla

我正在寻找为 Joomla 构建一个插件，它允许我在使用 Flash 之前先使用 HTML5 播放视频。为了使这个插件更加动态，我希望有一种嵌入视频的简单方法。在类似的插件中，我看到用户可以在其中放入用括号括起来的特定短语。类似于以下内容：

```
{html5video}media/video{/html5video} 
```

这个方法叫什么，我在哪里可以找到更多关于如何将它实现到插件中的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:49:44.090

据我所知，Joomla 中没有为此方法定义特定术语，但那些非常熟悉 Wordpress 的人将其称为 SHORTCODE 方法

您将需要创建一个内容插件 - 使用 regex 、 php`preg_match_all`并提取此字符串并替换为您想要的代码。

Joomla 中提供了一个这样的插件。您可以在 plugins\content\loadmodule 中检查它

您可能需要修改此插件中使用的正则表达式模式

# android - Android ICS 控制静音模式关闭、振动或静音

> ID：12230388
> 
> 赞同：3
> 
> 时间：2012-09-01T18:43:45.273
> 
> 标签：android

我到处寻找我能想到的答案，并且有很多关于 Android 中的音频的问题，但我找不到任何关于 ICS 中的新设置的讨论。

我的应用程序有一个功能，用户可以按下一个按钮，手机的铃声会静音，没有振动。这是我的代码，到目前为止它运行良好：

```
 mAudioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_OFF);
        mAudioManager.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
        mAudioManager.setStreamVolume(AudioManager.STREAM_RING, 0, 0); 
```

现在发生的情况是，当用户按下按钮时，音量仍然为 0，但手机，特别是 Galaxy S3，有短暂的振动。然后在设置->声音中，静音模式已从关闭更改为振动。因此，每当发生某些事情时，它仍然会有简短的振动通知。我无法进行足够彻底的测试以了解具体发生了什么以便它像那样振动，但这不是问题的重点。

我的问题是我们如何控制关闭、振动和静音的 ICS 静音模式设置？我希望能够在他们按下该按钮时将其设置为静音，然后在他们再次按下该按钮时返回关闭，或者他们设置的任何设置。我尝试使用 mAudioManager.setStreamMute 方法，但这不是预期的效果，它也不会更改静音模式的设置。

在此先感谢您的帮助，非常感谢！！

保罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:25:24.497

好的，我想通了！！！！+1 向 iturki 寻求帮助，谢谢！！我已经尝试过 RINGER_MODE_SILENT，但认为它不起作用。它没有用，但那是因为它只是解决方案的一半。虽然是需要的！

这是它每次都为我工作的方式：

我发现通过设置 AudioManager.RINGER_MODE_NORMAL 或 AudioManager.RINGER_MODE_SILENT，我仍然收到通知的振动。这就是为什么我评论说它不起作用。经过进一步测试，我发现不是 RINGER_MODE 设置造成的，实际上是这行代码：

```
mAudioManager.setStreamVolume(AudioManager.STREAM_RING, 0, 0); 
```

出于某种我不知道的原因，RINGER_MODE 设置为 NORMAL 或 SILENT，当 STREAM_RING 音量以这种方式设置为 0 时，它会更改 Settings-> Sound to Vibrate 中的静音模式设置。

解决方案：

```
 mAudioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_OFF);
    mAudioManager.setRingerMode(AudioManager.RINGER_MODE_SILENT); 
```

我不得不删除 STREAM_RING 设置，然后别管它。现在，当我将其设置为 RINGER_MODE_SILENT 并单独留下 STREAM_RING 时，不再有烦人的半秒振动！！！还有一点需要注意的是，我在没有将 VibrateSetting 设置为 OFF 的情况下进行了测试，它仍然有效，但由于其他原因，我将它留在了我的应用程序中。

重要提示：我不知道从 RINGER_MODE_NORMAL 到 RINGER_MODE_SILENT 的这种更改会如何影响以前的 Android 版本，所以要小心。如果有人确定此更改会对以前的版本产生什么影响，请随时告诉我们！

再次感谢 iturki 的帮助！

# sql - 连接到远程 sql server express 2008。这正常吗？

> ID：12230389
> 
> 赞同：1
> 
> 时间：2012-09-01T18:43:48.053
> 
> 标签：sql, sql-server-2008, database-connection

我在互联网上看到的关于如何使用管理工作室连接到远程 sql 服务器的每个教程都会说我输入 ip-adress\sqlexpress 作为服务器名称。当我这样做时，我得到了最著名的与网络相关/特定于实例的错误，但是当我只输入 IP 地址时，一切都很顺利。这是正常的吗？这样好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:21:55.547

安装 SQL Server 时，您为实例命名（正如您在评论中提到的[那样](https://stackoverflow.com/questions/12230389/connecting-to-remote-sql-server-express-2008-is-this-normal#comment16389374_12230389) [）](https://stackoverflow.com/questions/12230389/connecting-to-remote-sql-server-express-2008-is-this-normal#comment16389581_12230389)。

因为它是一个命名实例，并且可能是机器上唯一的 SQL Server，所以它也是默认实例（这就是为什么只有 IP 起作用的原因）。

由于您为实例命名，因此不会调用它`sqlexpress`（除非您选择了该名称，并且从错误中我假设您没有） - 这就是您使用该名称出现错误的原因。

# android - 阅读与装载机经理的联系方式

> ID：12230390
> 
> 赞同：4
> 
> 时间：2012-09-01T18:43:48.903
> 
> 标签：android

我试图利用 LoaderManager 和 CursorLoader 来读取联系人的电话号码。我能够读取联系人的显示名称，但我不确定如何读取电话号码。任何指导将不胜感激。

```
// These are the Contacts rows that we will retrieve.
static final String[] CONTACTS_SUMMARY_PROJECTION = new String[] {
        Contacts._ID, Contacts.DISPLAY_NAME,
        ContactsContract.CommonDataKinds.Phone.NUMBER };

// This is the Adapter being used to display the list's data.
SimpleCursorAdapter mAdapter;

// If non-null, this is the current filter the user has provided.
String mCurFilter;

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    // Give some text to display if there is no data. In a real
    // application this would come from a resource.
    setEmptyText("No phone numbers");

    // Create an empty adapter we will use to display the loaded data.
    mAdapter = new SimpleCursorAdapter(getActivity(),
            android.R.layout.simple_list_item_2, null, new String[] {
                    Contacts.DISPLAY_NAME, ContactsContract.CommonDataKinds.Phone.NUMBER },
            new int[] { android.R.id.text1, android.R.id.text2 }, 0);

    setListAdapter(mAdapter);

    // Start out with a progress indicator.
    setListShown(false);

    // Prepare the loader. Either re-connect with an existing one,
    // or start a new one.
    getLoaderManager().initLoader(0, null, this);
}

@Override
public void onListItemClick(ListView l, View v, int position, long id) {

    Log.i("FragmentComplexList", "Item clicked: " + id);
}

public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    // This is called when a new Loader needs to be created. This
    // sample only has one Loader, so we don't care about the ID.
    // First, pick the base URI to use depending on whether we are
    // currently filtering.
    Uri baseUri;
    if (mCurFilter != null) {
        baseUri = Uri.withAppendedPath(Contacts.CONTENT_FILTER_URI,
                Uri.encode(mCurFilter));
    } else {
        baseUri = Contacts.CONTENT_URI;
    }

    // Now create and return a CursorLoader that will take care of
    // creating a Cursor for the data being displayed.
    String select = "((" + Contacts.DISPLAY_NAME + " NOTNULL) AND ("
            + Contacts.HAS_PHONE_NUMBER + "=1) AND ("
            + Contacts.DISPLAY_NAME + " != '' ))";
    return new CursorLoader(getActivity(), baseUri,
            CONTACTS_SUMMARY_PROJECTION, select, null,
            Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC");
}

public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    // Swap the new cursor in. (The framework will take care of closing the
    // old cursor once we return.)
    mAdapter.swapCursor(data);

    // The list should now be shown.
    if (isResumed()) {
        setListShown(true);
    } else {
        setListShownNoAnimation(true);
    }
}

public void onLoaderReset(Loader<Cursor> loader) {
    // This is called when the last Cursor provided to onLoadFinished()
    // above is about to be closed. We need to make sure we are no
    // longer using it.
    mAdapter.swapCursor(null);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T07:55:54.127

试试这个..这对我有用！

```
// This is the Adapter being used to display the list's data.
    SimpleCursorAdapter mAdapter;

    // If non-null, this is the current filter the user has provided.
    String mCurFilter;

    @Override public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        // Give some text to display if there is no data.  In a real
        // application this would come from a resource.
        setEmptyText("No phone numbers");

        // We have a menu item to show in action bar.
        setHasOptionsMenu(true);

        // Create an empty adapter we will use to display the loaded data.
        mAdapter = new SimpleCursorAdapter(getActivity(),
                android.R.layout.simple_list_item_1, null,
                new String[] { ContactsContract.CommonDataKinds.Phone.NUMBER, },
                new int[] { android.R.id.text1}, 0);
        setListAdapter(mAdapter);

        // Start out with a progress indicator.
        setListShown(false);

        // Prepare the loader.  Either re-connect with an existing one,
        // or start a new one.
        getLoaderManager().initLoader(0, null, this);
    }

    @Override public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        // Place an action bar item for searching.
        MenuItem item = menu.add("Search");
        item.setIcon(android.R.drawable.ic_menu_search);
        item.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
        View searchView = SearchViewCompat.newSearchView(getActivity());
        if (searchView != null) {
            SearchViewCompat.setOnQueryTextListener(searchView,
                    new OnQueryTextListenerCompat() {
                @Override
                public boolean onQueryTextChange(String newText) {
                    // Called when the action bar search text has changed.  Update
                    // the search filter, and restart the loader to do a new query
                    // with this filter.
                    mCurFilter = !TextUtils.isEmpty(newText) ? newText : null;
                    getLoaderManager().restartLoader(0, null, CursorLoaderListFragment.this);
                    return true;
                }
            });
            item.setActionView(searchView);
        }
    }

    @Override public void onListItemClick(ListView l, View v, int position, long id) {
        // Insert desired behavior here.
        Log.i("FragmentComplexList", "Item clicked: " + id);
    }

    // These are the Contacts rows that we will retrieve.
    static final String[] CONTACTS_SUMMARY_PROJECTION = new String[] {
        ContactsContract.CommonDataKinds.Phone._ID,
        ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
        ContactsContract.CommonDataKinds.Phone.NUMBER,
    };

    public Loader<Cursor> onCreateLoader(int id, Bundle args) {
        // This is called when a new Loader needs to be created.  This
        // sample only has one Loader, so we don't care about the ID.
        // First, pick the base URI to use depending on whether we are
        // currently filtering.
        Uri baseUri;
        if (mCurFilter != null) {
            baseUri = Uri.withAppendedPath(ContactsContract.CommonDataKinds.Phone.CONTENT_FILTER_URI, Uri.encode(mCurFilter));
        } else {
            baseUri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
        }

        // Now create and return a CursorLoader that will take care of
        // creating a Cursor for the data being displayed.
        String select = "((" + ContactsContract.Contacts.DISPLAY_NAME + " NOTNULL) AND ("
                + ContactsContract.Contacts.DISPLAY_NAME + " != '' )" + "AND ("+ContactsContract.Contacts.HAS_PHONE_NUMBER +" != '0'"+"))";

        return new CursorLoader(getActivity(), baseUri,
                CONTACTS_SUMMARY_PROJECTION, null, null,
                null + " COLLATE LOCALIZED ASC");
    }

    public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
        // Swap the new cursor in.  (The framework will take care of closing the
        // old cursor once we return.)
        mAdapter.swapCursor(data);

        // The list should now be shown.
        if (isResumed()) {
            setListShown(true);
        } else {
            setListShownNoAnimation(true);
        }
    }

    public void onLoaderReset(Loader<Cursor> loader) {
        // This is called when the last Cursor provided to onLoadFinished()
        // above is about to be closed.  We need to make sure we are no
        // longer using it.
        mAdapter.swapCursor(null);
    }
} 
```

# database - 从哪里开始创建数据库？

> ID：12230391
> 
> 赞同：1
> 
> 时间：2012-09-01T18:43:54.337
> 
> 标签：database

我的一个朋友是物业经理，出租大楼内的单位。目前一切都在文件夹中，他希望将它们放在计算机（数据库）中。

我想帮助他，因为我认为我在编程方面做得很好并且我有很好的 Mysql 知识（CRUD）。但是，我不确定起点，所以我有两个问题：

1-在硬件方面，我只是在他的电脑上安装mysql服务器吗？或者我让他买另一台电脑并在上面安装mysql（所以它是独立服务器）？还是我需要一些专门的数据库服务器？

2-我需要遵循某些步骤（高级要点会像我从那里得到的那样）吗？或者即使你可以推荐一个我可以阅读的链接？

我熟悉 Mysql、Java、C++ 和 PHP

谢谢艾哈迈德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:08:36.140

我会尝试像[site5](http://www.site5.com/)这样的人，[hostgator](http://www.hostgator.com/shared.shtml)用于便宜/优质的托管，但不是 godaddy，因为他们的界面通常是为不编码的人准备的。此外，如果您在 Mac 上使用[mamp](http://www.mamp.info/en/index.html)或[xampp](http://www.apachefriends.org/en/xampp.html) for windows 在本地安装站点，然后将数据库导出到实时服务器，其费用可能在每月 5 美元到 15 美元之间。

# visual-studio-2010 - 如何使用opencv获取视频的第一帧？

> ID：12230394
> 
> 赞同：0
> 
> 时间：2012-09-01T18:44:09.933
> 
> 标签：visual-studio-2010, opencv

我必须找到视频的所有帧与该视频的第一帧的互相关....

```
double crossCorrelation( IplImage* img1, IplImage* img2 ) {
double corr;
int M = img1->width;
int N = img1->height;

BwImage img_1( img1 );
BwImage img_2( img2 );

CvScalar img1_avg = cvAvg( img1, NULL );
CvScalar img2_avg = cvAvg( img2, NULL );

double sum_img1_img2 = 0;
double sum_img1_2 = 0;
double sum_img2_2 = 0;

for( int m=0; m<M; ++m ) {
    for( int n=0; n<N; ++n ) {
        sum_img1_img2   = sum_img1_img2 + (img_1[m][n]-img1_avg.val[0])*(img_2[m][n]-img2_avg.val[0]);  
        sum_img1_2      = sum_img1_2 + (img_1[m][n]-img1_avg.val[0])*(img_1[m][n]-img1_avg.val[0]);
        sum_img2_2      = sum_img2_2 + (img_2[m][n]-img2_avg.val[0])*(img_2[m][n]-img2_avg.val[0]);
    }
}

corr = sum_img1_img2/sqrt(sum_img1_2*sum_img2_2);
return corr;
} 
```

这是查找相关性的代码。对于 img1 我需要帧 1，其余帧将是 img 2 循环！

我该怎么做？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T01:35:50.337

试试这个代码......它的工作原理..

```
CvCapture *video = cvCaptureFromFile("C:\\path_to_video.avi");

IplImage *firstFrame = cvQueryFrame(video);//this is the first frame
IplImage *nextFrame;

while(nextFrame!=NULL)
{
   nextFrame = cvQueryFrame(video);

   if(nextFrame!=NULL)
     double CrossCorrValue = crossCorrelation(firstFrame,nextFrame); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T01:50:38.650

您可能应该使用更现代的 VideoCapture::retrieve 函数和 cv::Mat - 但基本上`rotating_image`是正确的。

只需将第一帧抓取到单独的图像中，然后继续为后续帧重用新图像

# ios - 将 indexPath.row 发送到另一个 UIViewController

> ID：12230402
> 
> 赞同：2
> 
> 时间：2012-09-01T18:44:38.840
> 
> 标签：ios, xcode, uitableview, navigationcontroller

所以我将**didSelectRowAtIndexPath**方法放入**UITableViewController**。

TableView 转到由**NavigationController控制的****UIViewController**。

 **我想**将 indexPath.row 发送**到 NavigationController 调用的类，有没有办法**将参数发送到另一个类**？

我的应用方案是：

TabBarController ---> NavigationController ---> TableViewController ---> UIViewController

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:51:36.230

如果您使用情节提要：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    UITableViewCell *cell = sender;
    // Make sure your segue name in storyboard is the same as this line
    if ([[segue identifier] isEqualToString:@"YOUR_SEGUE_NAME_HERE"])
    {
        // Get reference to the destination view controller
        YourViewController *vc = [segue destinationViewController];
        NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];

        // Pass any objects to the view controller here, like...
        [vc setIndexPath:indexPath];
    }
} 
```

别的

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.row == 0) {
        YourViewController *vc = [[YourViewController alloc] initWithNibName:@"YourViewController" bundle:nil];
        [vc setIndexPath:indexPath];
    }

} 
```**

# basic-authentication - 有没有一种简单的方法来为 Meteor 应用程序设置 HTTP 基本身份验证？

> ID：12230404
> 
> 赞同：5
> 
> 时间：2012-09-01T18:44:42.200
> 
> 标签：basic-authentication, meteor

我有一个简单的 Meteor 应用程序演示，我想部署它，但我希望它有密码保护。不需要个人用户帐户——现在一个登录名/密码就足够了。

有什么建议吗？我意识到 Meteor 有一个正在积极开发中的 auth 分支，因此不久将提供一个功能齐全的解决方案。但如果有人能建议短期内阻力最小的路径，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T23:06:58.190

是的，如果您编写一小段连接中间件，然后将其滑入堆栈的开头，这是可能的。尝试使用这个： -

```
if (Meteor.is_server) {
  Meteor.startup(function () {
    var require = __meteor_bootstrap__.require;
    var connect = require('connect');

    __meteor_bootstrap__.app.stack.splice(0, 0, {
      route: '',
      handle: connect.basicAuth(function(user, pass){
        return 'guest' == user & 'password' == pass;
      })
    });
  });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-22T13:48:51.990

我不得不稍微调整@Jabbslad 代码以使其适用于 0.6.5 ：

```
if (Meteor.is_server) {
  Meteor.startup(function () {
    WebApp.connectHandlers.stack.splice(0, 0, {
      route: '',
      handle: WebApp.__basicAuth__(function(user, pass){
        return 'guest' == user & 'password' == pass;
      })
    });
  });
} 
```

我不喜欢用 替换`connect.basicAuth`，`WebApp.__basicAuth__`但`Npm.require("connect")`在 Meteor 0.6.5 中抛出错误，我找不到原因。

# jquery - JQuery：检测哪个 span id 具有 class="active"，如果按下按钮，则转到另一个 span id

> ID：12230409
> 
> 赞同：-1
> 
> 时间：2012-09-01T18:45:22.850
> 
> 标签：jquery, html, detect

我已经有一个脚本可以在下面列出的每个跨度 id 之间切换，添加活动类并将其删除，因此只有 1 个跨度 id 元素可见。

```
<div id="b_pager">
<span id="p1" class="active"></span>
<span id="p2"></span>
<span id="p3"></span>
<span id="p4"></span>
<span id="p5"></span>
</div> 
```

现在我想做的是制作两个按钮（某种箭头），它们将允许浏览跨度 ID。

示例：如果 span id p3 可见并且向右箭头 -> 自动按下，则转到 span id p4。如果按下向左箭头 <- 返回 p3，依此类推。

任何人都可以帮忙吗？提前致谢。

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T18:59:45.953

与模运算结合使用[`.eq()`](http://api.jquery.com/eq/)以循环值：

```
$("#next,#prev").click(function () {
  var $pager = $("#b_pager"),
      $spans = $pager.find("span"),
      activeIdx = $spans.filter(".active").removeClass("active").index();
  if (this.id == "next") {
    $spans.eq((activeIdx + 1) % $spans.length).addClass("active");
  } else {
    $spans.eq(activeIdx - 1).addClass("active");
  }
}); 
```

**[演示](http://jsfiddle.net/g8Rsd/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:02:21.427

工作演示 [http://jsfiddle.net/HhUBR/](http://jsfiddle.net/HhUBR/)

**代码**

```
$('#next').click(function() {
    if ($('span:last').hasClass('active')) {
        $('#next').attr('disabled', true)
    }
    else {
        $('.active').removeClass().next().addClass('active');
    }
})

$('#prev').click(function() {
    if ($('span').eq(0).hasClass('active')) {
        $('#prev').attr('disabled', true)
    }
    else {
        $('.active').removeClass().prev().addClass('active')
    }
})​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:15:54.803

我的尝试，

JS

```
 $(document).ready(function() {
        var counter = 0;
        $('#right_btn').click(function () {
           var spans  = $('#b_pager').find('span');
           var index = ++counter % spans.length;   // TO CYCLE 
           spans.eq(index - 1 ).removeClass('active').end()
             .eq(index).addClass('active');
        });
    });​ 
```

HTML

```
<div id="b_pager">
<span id="p1" class="active">first</span>
<span id="p2">second</span>
<span id="p3">third</span>
<span id="p4">forth</span>
<span id="p5">fifth</span>
</div>
<button id='right_btn'>Right</button>
​ 
```

CSS：

```
 #b_pager span {
     display:none;
    }

    #b_pager span.active {
     display:block;
    } 
```

[http://jsfiddle.net/sqBQ9/](http://jsfiddle.net/sqBQ9/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T18:48:18.637

您可以使用`jQuery.next(".active")`来选择下一个对象，以获得以前的使用`jQuery.prev(".active")`

这是工作演示

[http://jsfiddle.net/LGBY8/](http://jsfiddle.net/LGBY8/)

```
$("#next").click(function() {
    var or = $(".active");
    if($(".active").next().length!=0)
     $(".active").next().addClass("active");
    else
        $($(".active").parent().children().get(0)).addClass("active");
    $(or).removeClass("active");
})
$("#previous").click(function() {
    var or = $(".active");
    if($(".active").prev().length!=0)
     $(".active").prev().addClass("active");
    else
        $($(".active").parent().children().get(-1)).addClass("active");
    $(or).removeClass("active");
}) 
```

​</p>

# java - 将数据戳转换为纪元（包括 GMT 或 UTC）

> ID：12230412
> 
> 赞同：0
> 
> 时间：2012-09-01T18:46:02.403
> 
> 标签：java, parsing, timestamp

我希望将时间戳转换为纪元（自 1970 年以来的毫秒数）- java.util.

我想要一个广泛的解析器 - 既支持 GMT/UTC 又支持其他格式。例如：

```
new DateStamp("yyyy-MM-DD HH:mm:ss,ccc o").parse("2012-09-01 13:44:21222 GMT+2") 
```

也就是说，我不想输入我自己的实际格式（GMT/UTC），而是把它留给解析器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:33:29.777

你可以使用[`SimpleDateFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)：

```
DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss,S Z");
Date date = df.parse("2012-09-01 13:44:21,222 GMT+2:00");
long time = date.getTime(); // milliseconds since epoch 
```

对于 ISO 8601 时区：

```
DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss,S Z");
Date date = df.parse("2012-09-01 13:44:21,222 +02"); 
```

# javascript - 调用循环中创建的方法总是执行对象的最后一个方法

> ID：12230415
> 
> 赞同：0
> 
> 时间：2012-09-01T18:46:38.697
> 
> 标签：javascript, node.js, express

我正在使用节点 0.8.8 和 express 3.0。

有一个`checks`带有几个方法的对象和一个`middleware`现在应该用方法填充的空对象，其中每个方法一个方法`checks`，基本上执行它的`check`- 等效项并带有几个附加参数。

代码如下所示：

```
var checks = {

  baz: function(req, callback) {
    console.log('baz');
    callback(true);
  },

  foo: function(req, callback) {
    console.log('foo');
    callback(true);
  },

  bar: function(req, callback) {
    console.log('bar');
    callback(true);
  }

};

var middleware = {};

for (var check in checks) {

  middleware[check] = function(req, res, next) {
    checks[check](req, function(result) {
      // ...
    });
  };

} 
```

但是，无论`middleware`我调用什么方法，`checks`都会执行包装了最后一个方法的方法。这意味着`middleware`，尽管键是正确的，但填充了相同的方法，或者每个方法调用都`middleware`执行最后一个方法。

```
middleware.baz({}, function(){}); // => 'bar'
middleware.foo({}, function(){}); // => 'bar'
middleware.bar({}, function(){}); // => 'bar' 
```

当我执行分配给 的新创建的函数时`middleware[check]`，该函数是正确的并包装了我期望的函数。即使我调用`middleware[check]`从最后一个循环分配给的函数，结果也符合预期。

```
for (var check in checks) {
  // ...
  middleware[check]({}, function(){});
}

// => baz
// => foo
// => bar 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:49:28.880

问题是一旦你的`for`循环完成，值`check`就是最后一个属性`checks`。您需要`check`在每次迭代时捕获 的值，并且可以使用闭包来执行此操作：

```
for (var check in checks) {
  (function (check) {
    middleware[check] = function(req, res, next) {
      checks[check](req, function(result) {
        // ...
      });
    };
  }(check));
} 
```

另请注意，您可能应该`hasOwnProperty`对该循环添加一个检查，因为它当前将枚举在`checks`.

As a simple demonstration, have a look at [this fiddle](http://jsfiddle.net/37KCz/). Check the console, then uncomment the anonymous function expression and run the code again.

# ruby-on-rails - 回形针不允许上传多个图像

> ID：12230417
> 
> 赞同：0
> 
> 时间：2012-09-01T18:46:52.483
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, paperclip, simple-form

这是成功上传 1 张图片的日志：

```
Started POST "/kampagners" for 127.0.0.1 at 2012-09-01 20:18:01 +0000
Processing by KampagnersController#create as HTML
  Parameters: {"utf8"=>"V", "authenticity_token"=>"84w29N5okGI8BcL1cMc53fQzcVRAb
UTN/jssk6MI3qM=", "kampagner"=>{"titel"=>"lp", "landing_page"=>"lp", "kampagne_b
eskriv"=>"lp", "kampagne_maal"=>"l", "t1"=>"pl", "t2"=>"pll", "t3"=>"pl", "t4"=>
"p", "t5"=>"lp", "photos_attributes"=>{"photo"=>{"image"=>#<ActionDispatch::Http
::UploadedFile:0x38b5408 @original_filename="Skemaweb.PNG", @content_type="image
/png", @headers="Content-Disposition: form-data; name=\"kampagner[photos_attribu
tes][photo][image]\"; filename=\"Skemaweb.PNG\"\r\nContent-Type: image/png\r\n",
 @tempfile=#<File:C:/Users/AppData/Local/Temp/RackMultipart20120901-455
6-1d2qq7z>>}}, "ppc"=>"1", "soc"=>"1", "email"=>"1", "cashback"=>"0", "budget"=>
"12", "prisklik"=>"12"}, "commit"=>"Opret konkurrence"}
  ←[1m←[36m (18.0ms)←[0m  ←[1mBEGIN←[0m
  ←[1m←[35mSQL (0.0ms)←[0m  INSERT INTO `kampagners` (`budget`, `cashback`, `cli
cks`, `email`, `kampagne_beskriv`, `kampagne_maal`, `landing_page`, `ppc`, `pris
klik`, `soc`, `t1`, `t2`, `t3`, `t4`, `t5`, `titel`) VALUES (12, 0, 0, 1, 'lp',
'l', 'lp', 1, 12, 1, 'pl', 'pll', 'pl', 'p', 'lp', 'lp')
  ←[1m←[36mSQL (0.0ms)←[0m  ←[1mINSERT INTO `photos` (`image_content_type`, `ima
ge_file_name`, `image_file_size`, `image_remote_url`, `image_updated_at`, `kampa
gner_id`, `str`) VALUES ('image/png', 'Skemaweb.PNG', 114875, NULL, '2012-09-01
20:18:03', 39, NULL)←[0m
[paperclip] Saving attachments.
  ←[1m←[35m (2.0ms)←[0m  COMMIT 
```

这是我上传 2 张图片，但没有成功：

```
Started POST "/kampagners" for 127.0.0.1 at 2012-09-01 20:19:03 +0000
Processing by KampagnersController#create as HTML
  Parameters: {"utf8"=>"V", "authenticity_token"=>"84w29N5okGI8BcL1cMc53fQzcVRAb
UTN/jssk6MI3qM=", "kampagner"=>{"titel"=>"lpl", "landing_page"=>"lp", "kampagne_
beskriv"=>"lp", "kampagne_maal"=>"lp", "t1"=>"llp", "t2"=>"lp", "t3"=>"l", "t4"=
>"pl", "t5"=>"lp", "photos_attributes"=>{"0"=>{"photo"=>{"image"=>#<ActionDispat
ch::Http::UploadedFile:0x690480 @original_filename="Skemaweb.PNG", @content_type
="image/png", @headers="Content-Disposition: form-data; name=\"kampagner[photos_
attributes][0][photo][image]\"; filename=\"Skemaweb.PNG\"\r\nContent-Type: image
/png\r\n", @tempfile=#<File:C:/Users/AppData/Local/Temp/RackMultipart20
120901-4556-1dcutiv>>}}, "1"=>{"photo"=>{"image"=>#<ActionDispatch::Http::Upload
edFile:0x694ba8 @original_filename="Skemaweb.PNG", @content_type="image/png", @h
eaders="Content-Disposition: form-data; name=\"kampagner[photos_attributes][1][p
hoto][image]\"; filename=\"Skemaweb.PNG\"\r\nContent-Type: image/png\r\n", @temp
file=#<File:C:/Users/Niceberg/AppData/Local/Temp/RackMultipart20120901-4556-t0dd
md>>}}}, "ppc"=>"1", "soc"=>"1", "email"=>"1", "cashback"=>"0", "budget"=>"21",
"prisklik"=>"23"}, "commit"=>"Opret konkurrence"}
  ←[1m←[35m (0.0ms)←[0m  BEGIN
  ←[1m←[36mSQL (1.0ms)←[0m  ←[1mINSERT INTO `kampagners` (`budget`, `cashback`,
`clicks`, `email`, `kampagne_beskriv`, `kampagne_maal`, `landing_page`, `ppc`, `
prisklik`, `soc`, `t1`, `t2`, `t3`, `t4`, `t5`, `titel`) VALUES (21, 0, 0, 1, 'l
p', 'lp', 'lp', 1, 23, 1, 'llp', 'lp', 'l', 'pl', 'lp', 'lpl')←[0m
  ←[1m←[35mSQL (0.0ms)←[0m  INSERT INTO `photos` (`image_content_type`, `image_f
ile_name`, `image_file_size`, `image_remote_url`, `image_updated_at`, `kampagner
_id`, `str`) VALUES (NULL, NULL, NULL, NULL, NULL, 40, NULL)
[paperclip] Saving attachments.
  ←[1m←[36mSQL (0.0ms)←[0m  ←[1mINSERT INTO `photos` (`image_content_type`, `ima
ge_file_name`, `image_file_size`, `image_remote_url`, `image_updated_at`, `kampa
gner_id`, `str`) VALUES (NULL, NULL, NULL, NULL, NULL, 40, NULL)←[0m
[paperclip] Saving attachments.
  ←[1m←[35m (1.0ms)←[0m  COMMIT
Redirected to 
```

我的嵌套形式：

```
 <%= f.simple_fields_for :photos do |build| %>
   <%= render "billeder", :build => build %>
<% end %> 
```

和_billeder：

```
<%= build.simple_fields_for :photo do |d| %>
    <%= d.file_field :image, :label => 'Image', :style => 'margin-bottom:2px;float:left;width:250px;'  %>
<% end %> 
```

图片未上传的原因是什么？它们是使用 NULL NULL 和 NULL 值创建的。

更新：

控制器代码 kampagners：

```
def new
    @kampagner = Kampagner.new
    2.times {@kampagner.photos.build }
    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @kampagner }
    end
  end

  def create
    @kampagner = Kampagner.new(params[:kampagner])
    respond_to do |format|
      if @kampagner.save
        format.html { redirect_to(:kampagners, :notice => 'Kampagner was successfully created.') }
      else
        format.html { render :action => "new" }
      end
    end
  end 
```

坎帕格纳模型：

```
 class Kampagner < ActiveRecord::Base
    has_many :photos
    accepts_nested_attributes_for :photos
    attr_accessible :titel, :budget, :photos_attributes, :ppc, :sem, :soc, :cashback,
                    :landing_page, :budget, :prisklik, :t1, :t2, :t3, :t4, :t5,
                    :kampagne_beskriv, :kampagne_maal, :email, :image_url, :billed_navn, :photos, :image, :photo
    end 
```

照片模型：

```
 require 'open-uri'
    class Photo < ActiveRecord::Base
      belongs_to :kampagner
      attr_accessor :image_url, :billed_navn, :photo
      #sadasdasas
      Paperclip.options[:command_path] = "/usr/local/bin"
      has_attached_file :image,
              :path => ':rails_root/public/images/ads/:id/:basename.:extension',
              :url  => "images/ads/:id/:basename.:extension"
     attr_accessible :photos_attributes, :image_url, :billed_navn, :photo, :image, :kampagner_id, :image_remote_url, :image_file_name, :image_content_type, :image_file_size, :image_updated_at, :str
    end 
```

表格：

```
<%= simple_form_for @kampagner, :html => { :multipart => true, :class => 'newform', :style => 'width:100%;' } do |f| %>
<h1 style="margin-top:10px;padding-top:0px;font-size:12px;">Tilføj billeder</h1>
 <%= f.simple_fields_for :photos do |build| %>
   <%= render "billeder", :build => build %>
<% end %>
<%= f.submit "Opret kampagne", :style => "margin-bottom:20px;" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:52:05.833

看起来所需的参数应该没有额外的照片层出现，例如：

```
"photos_attributes"=>{"0"=>{"image"=>#<ActionDispat
ch::Http::UploadedFile:0x690480 @original_filename="Skemaweb.PNG", @content_type
="image/png", @headers="Content-Disposition: form-data; name=\"kampagner[photos_
attributes][0][image]\"; 
```

它适用于单个附件情况，因为参数已经采用所需的格式——输入的`photo`键`photos_attributes"=>{"photo"=>{"image"` 可能是其他标识符，如 0，但重要的是它的值（从 开始`{"image"}`）。

**编辑：（纠正错误）**

因此，将您的部分`<%= f.simple_fields_for :photo ...`中的块替换`_billeder`为以下内容：

```
 <%= build.file_field :image, :label => 'Image', :style => 'margin-bottom:2px;float:left;width:250px;'  %> 
```

# asp.net-mvc-3 - MVC3 为什么我发布的模型为 NULL？

> ID：12230422
> 
> 赞同：1
> 
> 时间：2012-09-01T18:47:55.577
> 
> 标签：asp.net-mvc-3

MVC3 的奇怪问题，EF Code First。

我正在传递一个将两个模型包装到视图的模型。

```
 public class UserInfoModel
{
    [Key]
    [Required]
    public int Id { get; set; }

    /// <summary>
    /// <para>Corresponds to ProviderUserKey in ASP Membership</para>
    /// <para>Used in Membership.GetUser(ProviderUserKey) to retrieve email and username.</para>
    /// </summary>
    public Guid MembershipId { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "First name")]
    public string FirstName { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Last name")]
    public string LastName { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Address 1")]
    public string Address1 { get; set; }

    [DataType(DataType.Text)]
    [Display(Name = "Address 2")]
    public string Address2 { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "State")]
    public string State { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Country")]
    public string Country { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Zip code")]
    public string ZipCode { get; set; }

    [Required]
    [DataType(DataType.PhoneNumber)]
    [Display(Name = "Phone number")]
    public string PhoneNumber { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [Display(Name = "Sign up date")]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @"{0:MM/dd\/yyyy}")]
    public DateTime SignUpDate { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [Display(Name = "Birthday")]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @"{0:MM\/dd\/yyyy}")]
    public DateTime BirthDate { get; set; }

    [DataType(DataType.Date)]
    [Display(Name = "Enrollment date")]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @"{0:MM\/dd\/yyyy}")]
    public DateTime EnrollmentDate { get; set; }

    [DataType(DataType.ImageUrl)]
    [Display(Name = "Avatar")]
    public string AvatarImage { get; set; }

    [Display(Name = "Rank")]
    public int RankId { get; set; }

    [ForeignKey("RankId")]
    public UserRankModel Rank { get; set; }

    [Display(Name = "IsActive")]
    public bool IsActive { get; set; }

}

public class RegisterModel
{
    [Required]
    [Display(Name = "User name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [Display(Name = "Email")]
    public string Email { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [DataType(DataType.Password)]
    [Display(Name = "Confirm password")]
    [Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
    public string ConfirmPassword { get; set; }
}

public class UserInfoAndRegisterModel
{
    public UserInfoModel UserInfoModel { get; set; }
    public RegisterModel RegisterModel { get; set; }
} 
```

看法：

```
@model K2Calendar.Models.UserInfoAndRegisterModel
@{
ViewBag.Title = "Update User";
}
<div class="container">
    <h2>
        Update Account Details</h2>
    <p>
        Use the form below to update the account.
    </p>
    <p>
        @Html.ValidationSummary(true, "Account update was unsuccessful. Please correct the errors and try again.")
    </p>
    <script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript">    </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"></script>
@using (Html.BeginForm())
{
    @Html.HiddenFor(m => m.UserInfoModel.Id)
    @Html.HiddenFor(m => m.UserInfoModel.MembershipId)
    @Html.HiddenFor(m => m.UserInfoModel.SignUpDate) 
    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.RegisterModel.UserName)
            @Html.TextBoxFor(m => m.RegisterModel.UserName, new { tabindex = "1" , disabled = "disabled" } )
            @Html.ValidationMessageFor(m => m.RegisterModel.UserName)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.State)
            @Html.TextBoxFor(m => m.UserInfoModel.State, new { tabindex = "8" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.State)
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.RegisterModel.Email)
            @Html.TextBoxFor(m => m.RegisterModel.Email, new { tabindex = "2" , disabled = "disabled" })
            @Html.ValidationMessageFor(m => m.RegisterModel.Email)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.ZipCode)
            @Html.TextBoxFor(m => m.UserInfoModel.ZipCode, new { tabindex = "9" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.ZipCode)
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6"> 
            @Html.LabelFor(m => m.UserInfoModel.FirstName)
            @Html.TextBoxFor(m => m.UserInfoModel.FirstName, new { tabindex = "3" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.FirstName)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.Country)
            @Html.TextBoxFor(m => m.UserInfoModel.Country, new { tabindex = "10" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.Country)
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.LastName)
            @Html.TextBoxFor(m => m.UserInfoModel.LastName, new { tabindex = "4" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.LastName)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.BirthDate)
            @Html.TextBoxFor(m => m.UserInfoModel.BirthDate, new { tabindex = "11", placeholder = "mm/dd/yyyy" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.BirthDate)
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.Address1)
            @Html.TextBoxFor(m => m.UserInfoModel.Address1, new { tabindex = "5" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.Address1)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.EnrollmentDate)
            @Html.TextBoxFor(m => m.UserInfoModel.EnrollmentDate, new { tabindex = "12", placeholder = "mm/dd/yyyy" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.EnrollmentDate)
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.Address2)
            @Html.TextBoxFor(m => m.UserInfoModel.Address2, new { tabindex = "6" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.Address2)
        </div>
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.RankId)
            @Html.DropDownListFor(m => m.UserInfoModel.RankId, (SelectList)ViewBag.RankList, new { tabindex = "13" })
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            @Html.LabelFor(m => m.UserInfoModel.PhoneNumber)
            @Html.TextBoxFor(m => m.UserInfoModel.PhoneNumber, new { tabindex = "7" })
            @Html.ValidationMessageFor(m => m.UserInfoModel.PhoneNumber)
        </div>
        <div class="span6">

        </div>
    </div>

    <br />
    <p>
        <button type="submit" class="btn btn-primary btn-large" tabindex = "14">Update &raquo;</button>
    </p>
} 
```

我的控制器类采用发布的模型并进行一些数据库更新。

其中一个包装模型为空：

```
[Authorize]
    [HttpPost]
    public ActionResult Edit(UserInfoAndRegisterModel model)
    {
        //WHY IS model.RegisterModel == null ??//
        if (ModelState.IsValid)
        {
            try
            {
                dbContext.Entry(model.UserInfoModel).State = System.Data.EntityState.Modified;
                dbContext.SaveChanges();
                return RedirectToAction("Index", "Home");
            }
            catch (Exception ex)
            {
                throw new InvalidOperationException("Failed to update UserInfoModel", ex.InnerException);
            }
        }
        GenerateRanksList();
        return View(model);
    } 
```

我为帐户创建做同样的事情，但我没有收到具有几乎相同视图代码的 RegisterModel 的空值。

目前这不是问题，因为我目前只更新 UserInfoModel，但将来我可能希望允许用户更改他们的电子邮件地址或用户名。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T18:57:45.487

你`RegisterModel`是空的，因为你没有发布任何属于`RegisterModel`

`RegisterModel`尽管您在视图中有属于此类的输入

```
@Html.TextBoxFor(m => m.RegisterModel.UserName, 
                 new { tabindex = "1" , disabled = "disabled" } ) 
```

它们都是`disabled`并且未发布禁用的输入：

[表单提交 - 成功控制](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2)

> 一个成功的控件对于提交是“有效的”
> 
> 然而：
> 
> 禁用的控件不能成功。

因此，您需要删除`disable`或将属性添加为隐藏字段：

```
@Html.HiddenFor(m => m.RegisterModel.UserName) 
```

# html - 缩放大的居中图像以适应 html 表格高度

> ID：12230432
> 
> 赞同：1
> 
> 时间：2012-09-01T18:49:39.807
> 
> 标签：html, css, css-tables, fluid-layout, image-scaling

我正在尝试限制表格中图像的高度。表格的原因是允许这些图像垂直和水平对齐到页面中心。我遇到的问题是大于浏览器高度的图像在放大表格的页面底部消失，我希望图像具有`max-height:100;`并缩放以适应。它适用于宽度，但不适用于高度。

这是我到目前为止所拥有的...

```
<div id="table">
<div id="cell">
<img src="image.jpg"/>
</div>
</div> 
```

和

```
html, body{
height:100%;
margin:0;
padding:0;
}

#table{
display:table;
height:100%;
width:100%;
}

#cell{
display:table-cell;
vertical-align:middle;
text-align:center;
background-color:#ccc;
}

img{
max-width:100%;
max-height:100%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:29:21.593

您可以在不使用`table`. 这是基本大纲，HTML：

```
<body>
    <img src = "image.jpg"/>
</body> 
```

CSS：

```
html, body {
    height: 100%;
    width: 100%;
}
body {
    position: relative;
}
img {
    position: absolute;
    margin: auto; /*make sure it's centered both vertically and horizontally*/
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    max-width: 100%;
    max-height: 100%;
} 
```

还有一点 jsFiddle 演示：[little link](http://jsfiddle.net/glee/M44qU/)。请注意，`body`必须具有`position: relative;`此功能。

我希望这有帮助！

# c# - 如何编写代码片段以在 C# 中生成方法？

> ID：12230448
> 
> 赞同：6
> 
> 时间：2012-09-01T18:51:59.253
> 
> 标签：c#, code-snippets

我想编写一个执行以下操作的代码片段，比如如果我有一个类，比如说 MyClass：

```
 class MyClass
    {
        public int Age { get; set; }
        public string Name { get; set; }
    } 
```

所以片段应该创建以下方法：

```
 public bool DoUpdate(MyClass myClass)
  {
        bool isUpdated = false;
        if (Age != myClass.Age)
        {
            isUpdated = true;
            Age = myClass.Age;
        }
        if (Name != myClass.Name)
        {
            isUpdated = true;
            Name = myClass.Name;
        }
        return isUpdated;
    } 
```

所以我的想法是，如果我为任何类调用代码片段，它应该创建`DoUpdate`方法，并且应该按照我在上面示例中所做的方式编写所有属性。

所以我想知道：

1.  是否可以做到以上几点？
2.  如果是，我应该如何开始，有什么指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:00:13.623

你的片段应该在

> C:\Users\CooLMinE\Documents\Visual Studio（版本）\代码片段\Visual C#\我的代码片段

获取现有片段并对其进行修改以避免重构文件布局的最简单方法。

这是您可以使用的模板：

```
<?xml version="1.0" encoding="utf-8" ?>
<CodeSnippets  xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
    <CodeSnippet Format="1.0.0">
        <Header>
            <Title>snippetTitle</Title>
            <Shortcut>snippetShortcutWhichYouWillUseInVS</Shortcut>
            <Description>descriptionOfTheSnippet</Description>
            <Author>yourname</Author>
            <SnippetTypes>
                <SnippetType>Expansion</SnippetType>
            </SnippetTypes>
        </Header>
        <Snippet>
            <Declarations>
                <Literal>
                </Literal>
                <Literal Editable="false">
                </Literal>
            </Declarations>
            <Code Language="csharp"><![CDATA[yourcodegoeshere]]>
            </Code>
        </Snippet>
    </CodeSnippet>
</CodeSnippets> 
```

当您希望它根据类名等生成名称时，这应该会派上用场：http: [//msdn.microsoft.com/en-us/library/ms242312.aspx](http://msdn.microsoft.com/en-us/library/ms242312.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:06:28.643

一个实用方法怎么样：

```
public static class MyUtilities
{
    public static bool DoUpdate<T>(
        this T target, T source) where T: class
    {
        if(target == null) throw new ArgumentNullException("target");
        if(source == null) throw new ArgumentNullException("source");

        if(ReferenceEquals(target, source)) return false;
        var props = typeof(T).GetProperties(
            BindingFlags.Public | BindingFlags.Instance);
        bool result = false;
        foreach (var prop in props)
        {
            if (!prop.CanRead || !prop.CanWrite) continue;
            if (prop.GetIndexParameters().Length != 0) continue;

            object oldValue = prop.GetValue(target, null),
                   newValue = prop.GetValue(source, null);
            if (!object.Equals(oldValue, newValue))
            {
                prop.SetValue(target, newValue, null);
                result = true;
            }
        }
        return result;
    }
} 
```

示例用法：

```
var a = new MyClass { Name = "abc", Age = 21 };
var b = new MyClass { Name = "abc", Age = 21 };
var c = new MyClass { Name = "def", Age = 21 };

Console.WriteLine(a.DoUpdate(b)); // false - the same
Console.WriteLine(a.DoUpdate(c)); // true - different

Console.WriteLine(a.Name); // "def" - updated
Console.WriteLine(a.Age); 
```

请注意，如果要在紧密循环（等）中使用，则可以对其进行极大优化，但这样做需要元编程知识。

# ruby - 这是将 Ruby 块传递给自身吗？

> ID：12230451
> 
> 赞同：0
> 
> 时间：2012-09-01T18:52:14.793
> 
> 标签：ruby

学习 Ruby 并在教程中遇到了这个示例

```
x = 10  
5.times do |x|  
  puts "x inside the block: #{x}"  
end  

puts "x outside the block: #{x}" 
```

它输出以下内容

```
x inside the block: 0
x inside the block: 1
x inside the block: 2
x inside the block: 3
x inside the block: 4
x outside the block: 10 
```

x 如何在块内递增？这一定是一个非常简单的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:24:25.987

`5.times`迭代块 5 次，取值从 0 到 4。在循环中使用 x 是块本地的。循环执行后，x 具有其原始值，即 10。

# java - c++ 中 Java 的 String.getBytes("UTF-8") 的等价物？

> ID：12230453
> 
> 赞同：1
> 
> 时间：2012-09-01T18:52:32.597
> 
> 标签：java, c++, string

我需要在（非托管）C++ 中实现这个 Java 代码：

```
byte[] b = string.getBytes("UTF8"); 
```

我是 C++ 新手，找不到任何东西可以做到这一点。如果可能，它必须独立于平台。使用 c++11 编译器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:53:47.133

Java大致`String`相当于. 我建议你尝试类似...`std::u16string`[`std::basic_string`](http://en.cppreference.com/w/cpp/string/basic_string)

```
std::wstring_convert<std::codecvt_utf8_utf16<char16_t>, char16_t> convert;
std::string converted = convert.to_bytes(u"HELLO, WORLD!");
const char *bytes = converted.data(); 
```

**请注意**，这依赖于 C++11；您的编译器供应商可能需要一段时间才能完全支持这些功能。

在这里，我们利用新引入[`std::wstring_convert`](http://en.cppreference.com/w/cpp/locale/wstring_convert)的将宽字符 UTF-16 字符串转换为 UTF-8 多字节字符串 via [`to_bytes`](http://en.cppreference.com/w/cpp/locale/wstring_convert/to_bytes)（它也支持另一个方向的转换）。

这是通过（也是新引入的）[`std::codecvt_utf8_utf16`](http://en.cppreference.com/w/cpp/locale/codecvt_utf8_utf16)转换方面实现的。它很好地为我们处理了实际的转换。

除此之外，它还利用了 C++11 中添加的新字符文字前缀——特别是 ,`u`用于`char16_t`UTF-16 字符串 :-) 还有`u8`和分别`U`用于 UTF-8 和 UTF-32。

* * *

PS `data`（从 C++11 开始）保证等于`c_str`，因此可以依赖它是 NUL 终止的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:12:11.400

解决方案1：-

```
 char bytecpp[]= u8"You don't need strings.getbytes :P"; 
```

解决方案2：-

```
std::wstring_convert<std::codecvt_utf8_utf16<char16_t>> myconv;
std::string mbstring = myconv.to_bytes(u"Hello\n");
std::cout << mbstring; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T18:55:35.867

假设字符串已经是 UTF-8，您可以使用：

```
char const *c = myString.c_str(); 
```

对于读/写访问，您可以使用：

```
std::vector<char> bytes(myString.begin(), myString.end());
bytes.push_back('\0');
char *c = &bytes[0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T19:13:35.283

C++ 中的字符串通常是 ASCII 每个字符 1 个字节。因此，如果您使用典型的 std::string，则必须在将其编组为 C++ 之前对其进行处理。然而，不幸的是，C++ 确实定义了一个宽字符串 std::wstring（来自关于宽字符的维基百科文章）：

> wchar_t 的宽度是特定于编译器的，可以小到 8 位。因此，需要在任何 C 或 C++ 编译器之间移植的程序不应使用 wchar_t 来存储 Unicode 文本。wchar_t 类型用于存储编译器定义的宽字符，在某些编译器中可能是 Unicode 字符。

所以我们必须知道你将使用什么 C++ 编译器来完全回答这个问题。对于 std::wstring 类，没有 to bytes 类型函数，因此您要做的是使用其他答案中提到的 c_str() 然后使用 &(bit wise and) 和字节掩码来拆分宽字符为字节。

在 Visual C++ 中，宽字符是 16 位，因此您需要类似以下内容将每个字符处理为字节：

```
high_byte = wcharacter & 0xFF00;
low_byte = wcharacter & 0xFF; 
```

# javascript - 单击鼠标时，Javascript会在网页上获取最近的超链接

> ID：12230456
> 
> 赞同：3
> 
> 时间：2012-09-01T18:52:39.677
> 
> 标签：javascript, algorithm, closest-points

我想知道什么是最好的解决方案。单击鼠标时返回并显示网页上最近的超链接。

本例中有 3`DIV`秒。它们每个都带有一个超链接。还有另一个超链接（超链接 D）本身没有`DIV`. 假设红点是鼠标点击。

**例如**

![](../Images/5aa8113eea78075f7d232556bb6b61d0.png)

我能想到的解决方案就是遍历所有链接

```
 var a_list = document.getElementsByTagName("a"); 
```

然后使用距离方程计算距离`c^2 = a^2 + b^2`，所以很简单

```
 var a_list = Array.prototype.slice.call(document.getElementsByTagName("a"))
    for( var i = 0 ; i < a_list.length; i++){
          Math.sqrt(Math.pow(mouseX - a_list[i].getBoundingClientRect().left,2) + 
                    Math.pow(mouseY - a_list[i].getBoundingClientRect().top,2))

    } 
```

这种方法当然需要 O(N) 时间复杂度，其中 N 是我们拥有的链接数。我们能做得更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:26:23.540

不可能比 O(N) 更快地做到这一点，因为您确实需要检查每个链接。

如果您多次执行此检查，我可以想到更快的算法（例如，如果您每次鼠标移动时都突出显示最近的链接）；但那些一次性的启动成本比简单的检查更糟糕。

它是一个 O(N) 算法真的很重要吗？速度还不够快吗？

关于您的算法的一些注释：

*   您可以消除昂贵的平方根计算 - 您可以比较“距离平方”值，它仍然会告诉您更接近的值。如果您确实需要某物的距离，请在找到最近的链接后，在最后取一次平方根
*   您需要检查链接的哪个角离鼠标最近，不要盲目使用左角。即X方向：
    *   如果 mouseX < link.left 然后使用 (mouseX - link.left)^2
    *   如果 mouseX > link.right 然后使用 (mouseX - link.right)^2
    *   否则使用 0
    *   ...对于 Y 方向也是如此。
*   您可以先计算 delta_y^2 并将其与“迄今为止的最佳距离^2”值进行比较；如果它更大，则无需计算 delta_x^2。根据浏览器、CPU 和您的其余代码，这可能会或可能不会使其更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T16:09:46.407

这看起来像一个`nearest neighbor`问题，比如你有一个二维的 n 个点的集合 S，以及一个查询点 q。S中的哪个点最接近q。

我认为，如果您要处理的链接不多（少于一百个链接），那么简单的方法是最好的（您刚刚拥有的方法。扫描每个链接并计算距离，然后取最小的一个），但是如果有数千或数百万个链接（几乎没有发生），那么您肯定需要缓存它以供以后查询，这肯定会加快查询时间。

*   一种方法（您的方法）是获取所有链接，然后按 X 坐标对它们进行排序，您现在不关心 Y 坐标，然后对 X 进行二进制搜索，您最终会得到其中一个链接，但这可能不是最近的，您仍然需要按距离与上一个和下一个进行比较（现在使用Y坐标）。例如，从您的示例中，当您对 X 进行二进制搜索时，因为那个红色虚线（鼠标单击位置）的 X 坐标大于超链接 D，所以它将搜索之后的所有内容，但超链接 D 可能是最接近的，所以你需要考虑。这种方法需要 O(N log N) 进行排序，O(N) 空间和 O(log N) 进行查询。

*   您也可以使用[Kd 树](http://en.wikipedia.org/wiki/K-d_tree)。它适用于少量维度（在您的情况下它只有两个维度 x 和 y），并且它可以有效地搜索包含查询点 p 的单元格（您的鼠标单击位置）。
    **构建时间 O(N log N)，空间 O(N) 和查询时间：O(n^1/2 + k)**

*   我能想到的另一种方法是构建[Voronoi 图](http://en.wikipedia.org/wiki/Voronoi_diagram)，它为最近邻查询提供了一种有效的数据结构，并且最适合二维。
    **构建时间 O(N log N)，空间 O(N) 和查询时间：O(log n)**

所以几乎所有的方法都是一样的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:13:45.180

如果您可以事先构建您的链接列表（即滚动时不滚动或重建），您可能想看看平铺。

例如，对于 0.5 的平铺因子，您会将链接分类为

*   在屏幕左侧 0.25
*   在屏幕左侧 0.5
*   在屏幕左侧 0.25-0.75
*   在屏幕左侧 0.5-1.0（=0.5 右侧）
*   在屏幕左侧 0.75-1.0（=0.25 右侧）

垂直也是如此。

单击时，您只需检查那些与单击位置重叠的图块中的链接。如果您离最近的链接很远，这显然会给您“一无所获”，但这可能是您想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T19:18:27.530

所以，我猜你有那一页并为很多不同的鼠标位置进行计算？

在这种情况下，您可以在第一个设置中创建 2 个列表，分别保存`a`按 x 排序的 s，分别。y方向由它向左，分别。最高值。然后用你的鼠标事件的 x resp。y 坐标，您可以像这样开始在这些列表中搜索 - 解释 x 坐标：

从 s 的完整列表开始，`a`并将 mouse-x 与列表中间元素的左值进行比较。如果 x 较小，则重复但从开始到中间元素的列表，如果 x == 左值，则完成，如果 x 较大，则从中间到结尾重复列表。如果 x == left-value 或要搜索的列表只有 1 个或两个元素长，则这样做，在这种情况下，您取两者中较近的一个。

对 y 坐标也必须这样做（类似于平行）。

这还没有完全考虑清楚，但我很确定这样的事情，你可以避免`a`每次都与所有标签进行比较。

# python - 什么是显示缩略图的模板标签

> ID：12230459
> 
> 赞同：0
> 
> 时间：2012-09-01T18:53:06.620
> 
> 标签：python, django, django-models, django-templates, django-views

我在我的模型中创建了缩略图，这个函数返回缩略图的动态路径 url。现在我将如何在我的模板中使用它？我必须编写一些视图函数吗？这是我的models.py

```
def img_file_upload_path(instance, filename):
""" creates unique-Path & filename for upload """

ext = filename.split('.')[-1]
filename = "%s.%s" % (uuid.uuid4(), ext)  

return os.path.join(
    'images','eventpic','original', instance.album_id.event_id.channel_id.publisher.user.username, instance.album_id.event_id.channel_id.channel_title, instance.album_id.event_id.event_title,instance.album_id.name,filename
    #images/     john/                johnchannel/       birthday/          img1.jpg
)   

def formatted_img_file_upload_path(instance, filename):
""" creates unique-Path & filename for upload """
ext = filename.split('.')[-1]
filename = "%s.%s" % (uuid.uuid4(), ext)

PATH = django_settings.MEDIA_ROOT+ os.path.join(
    'images','eventpic','formatted', instance.album_id.event_id.channel_id.publisher.user.username, instance.album_id.event_id.channel_id.channel_title, instance.album_id.event_id.event_title,instance.album_id.name
    #images/     john/                johnchannel/       birthday/          img1.jpg
)
#print PATH
#print filename
if not os.path.exists(PATH) :  
    os.makedirs(django_settings.MEDIA_ROOT + os.path.join(
                'images','eventpic','formatted', instance.album_id.event_id.channel_id.publisher.user.username, instance.album_id.event_id.channel_id.channel_title, instance.album_id.event_id.event_title,instance.album_id.name
    #images/     john/                johnchannel/       birthday/          img1.jpg
        ))    

return PATH +"/" +filename

def thumb_img_file_upload_path(instance, filename):
""" creates unique-Path & filename for upload """
ext = filename.split('.')[-1]
filename = "%s.%s" % (uuid.uuid4(), ext)

PATH = django_settings.MEDIA_ROOT+ os.path.join(
    'images','eventpic','thumb', instance.album_id.event_id.channel_id.publisher.user.username, instance.album_id.event_id.channel_id.channel_title, instance.album_id.event_id.event_title,instance.album_id.name
    #images/     john/                johnchannel/       birthday/          img1.jpg
)
#print PATH
#print filename
if not os.path.exists(PATH) :  
    os.makedirs(django_settings.MEDIA_ROOT + os.path.join(
                'images','eventpic','thumb', instance.album_id.event_id.channel_id.publisher.user.username, instance.album_id.event_id.channel_id.channel_title, instance.album_id.event_id.event_title,instance.album_id.name
    #images/     john/                johnchannel/       birthday/          img1.jpg
        ))    

return PATH +"/" +filename

class Photo(models.Model):  

image_id            = models.AutoField(primary_key=True)
uuid                = UUIDField(auto=True)
album_id            = models.ForeignKey(Album,db_column='album_id')
title               = models.CharField(max_length=255)
summary             = models.TextField(blank=True, null=True)
date_created        = models.DateTimeField(auto_now_add=True)
date_modified       = models.DateTimeField(auto_now=True)
is_cover_photo      = models.BooleanField()
photo               = models.ImageField(upload_to=img_file_upload_path,max_length=500)

 def get_model_fields(self):
    return model._meta.fields

 def thumb_image(self,img):

    #Image thumbnail code starts here
    img.thumbnail((140,100), Image.ANTIALIAS)
    thumb = img.save(thumb_img_file_upload_path(self, self.photo.path),quality=90)
    #Image resizing code ends here

    return thumb  

 def formatted_image(self,img):       
    # Image resizing code starts here
    size=(1200, 840)
    pw = self.photo.width
    ph = self.photo.height
    nw = size[0]
    nh = size[1]

    if pw > nw or ph > nh:
        # photo aspect is wider than destination ratio
        image = ImageOps.fit(img,(nw, nh), Image.ANTIALIAS,(0.5, 0.5))

    else:
        # photo aspect matches the destination ratio
        image = ImageOps.fit(img, (pw, ph), Image.ANTIALIAS, (0.5, 0.5))

        formatted = image.save(formatted_img_file_upload_path(self, self.photo.path),quality=90)
    return formatted 

 def save(self):

    super(Photo,self).save()
    if self.photo:
        filename = img_file_upload_path(self, self.photo.path)
    if self.is_cover_photo:
        other_cover_photo = Photo.objects.filter(album_id=self.album_id).filter(is_cover_photo = True)
        for photo in other_cover_photo:
            photo.is_cover_photo = False
            #photo.save()

    if not filename == '':

        img = Image.open(self.photo.path)
        if img.mode not in ("L", "RGB"):
            img = img.convert("RGB")

        self.formatted_image(img)
        self.thumb_image(img)

 def get_formatted_image(self,filename):
    """ creates unique-Path & filename for upload """

    ext = filename.split('.')[-1]
    filename = "%s.%s" % (uuid.uuid4(), ext)

    return os.path.join(
            'images','eventpic','formatted', self.album_id.event_id.channel_id.publisher.user.username, self.album_id.event_id.channel_id.channel_title, self.album_id.event_id.event_title,self.album_id.name,filename
        #images/     john/                johnchannel/       birthday/          img1.jpg
        )   

 def get_thumb_image(self, filename):
    """ creates unique-Path & filename for upload """

    ext = filename.split('.')[-1]
    filename = "%s.%s" % (uuid.uuid4(), ext)  

    return os.path.join(
        'images','eventpic','thumb', self.album_id.event_id.channel_id.publisher.user.username, self.album_id.event_id.channel_id.channel_title, self.album_id.event_id.event_title,self.album_id.name,filename
#images/     john/                johnchannel/       birthday/          img1.jpg
    ) 
```

这是我的views.py

```
def imageview(request,album_id):
e_piclist  =  Photo.objects.filter(album_id = album_id).only('photo')
formatted_photo = Photo.get_formatted_image(???????)
thumb_photo = Photo.get_thumb_image(????????)

return render_to_response('gallery/image.html', 
{  
    'e_piclist' : e_piclist,
    'formatted_photo' : formatted_photo,
    'thumb_photo' : thumb_photo,

},context_instance=RequestContext(request)) 
```

我卡在这里..我需要显示一个相册下的所有图像..我得到了原始图像，但无法调用 thumb 和格式化大小，因为它们在 Photo 类的函数中返回图像路径并接收 2 个参数。我现在应该怎么做才能在模板上显示拇指图像？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T15:34:13.483

费萨尔，

您可以尝试通过执行以下操作获取格式化的图像：

```
formatted_photo = [p.get_formatted_image(p.photo) for p in e_piclist] 
```

但更好的方法是重构您的 get_formatted_image 方法以使用 self.photo 并直接在模板中使用它。

如果你使用 django-imagekit 会更好。

我最好在询问时更好地格式化您的代码，特别是在粘贴缩进就是一切的python时。对不起，如果我误解了你的问题。

# java - Android - 为什么 onItemLongClick(...) 返回一个布尔值？

> ID：12230469
> 
> 赞同：27
> 
> 时间：2012-09-01T18:54:36.140
> 
> 标签：java, android, onlongclicklistener, long-click

来自 Java 背景，我习惯于处理操作，尽管我不太确定为什么该方法需要返回布尔值并且不完全理解网站上给出的解释：如果回调消耗了长按，则为 true，false除此以外。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-01T19:01:35.550

您可能知道，`View`Android 中的层次结构由树表示。当您`true`从`onItemLongClick()`- 返回时，这意味着`View`当前接收到的事件是真正的事件接收者，并且该事件不应传播到`Views`树中的另一个；当您返回时`false`-您让事件传递给`Views`可能消耗它的另一个。希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-09-10T19:35:50.067

我将通过一个例子为你进一步澄清这一点。

```
@Override
public boolean onLongClick(View view) {

//Do all you stuff here    

return true; // or you can return false;
} 
```

*   return true 表示：事件已被处理。在此之后不会触发任何事件。
*   return false 表示：事件尚未处理。与此单击有关的任何其他事件仍将触发。

因此，在**onLongClick()**触发后，如果您不希望常规**onClick()**触发，则只需从 onLongClick() 事件**返回 true 。**

# jquery - jquery上/下滑块与ajax冲突

> ID：12230473
> 
> 赞同：2
> 
> 时间：2012-09-01T18:55:20.243
> 
> 标签：jquery, ajax

我正在使用带有视图的drupal 7，并且我正在使用我找到的向上/向下文本幻灯片的jquery脚本。它有效，但是当我尝试将它与带有 ajax 的视图暴露过滤器一起使用时，它似乎不起作用。

我在网上发现 jquery 脚本必须使用 live 或 bind 或委托，但我无法弄清楚。下面是我使用的脚本：

```
jQuery(function() {
    jQuery('.feature_box').showFeatureText();
});

jQuery.fn.showFeatureText = function() {
    return this.each(function() {
        var box = jQuery(this);
        var text = jQuery('p', this);
        text.css({
            position: 'absolute',
            bottom: '0%'
        }).hide();
        box.hover(function() {
            text.slideDown("fast");
        }, function() {
            text.slideUp("fast");
        });
    });
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T02:40:41.117

我建议将您的插件附加到不会通过 ajax 替换的元素。并且，使用 on() 允许您在附加的事件处理程序中指定一个目标。

```
jQuery(function() {
    jQuery('.element_containing_feature_box').showFeatureText();
});

jQuery.fn.showFeatureText = function() {

    return this.on('mouseenter', '.feature_box', function(e){
        $(this).find('p').css({
            position: 'absolute',
            bottom: '0%'
        }).hide();
    }).on('mouseleave', '.feature_box', function(e){
        $(this).find('p').slideUp("fast");
    });
}​ 
```

或者，在 ajax 成功时重新调用您的插件。

```
jQuery.ajax(options).done(function() {
    jQuery('.feature_box').showFeatureText();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:09:19.740

转换`box.hover`成`.live`函数，如果可能的话，直接使用带有类/ID名称的实时函数，

```
jQuery(".class").hover(/* hover js code */); 
```

或者

```
box.live("mouseover", function(){
    // mouseover js code
});

box.live("mouseout", function(){
    // mouseout js code
}); 
```

# java - 函数调用多少会导致栈溢出

> ID：12230474
> 
> 赞同：6
> 
> 时间：2012-09-01T18:55:20.393
> 
> 标签：java, android, exception-handling, error-handling

您好 android/Java 开发人员，

当一个函数调用一个函数并且该函数调用另一个函数等等时，有多少调用（堆栈长度）会让我进入堆栈溢出？有一般的经验法则吗？

我问的原因是因为我现在对我的 5 人纸牌游戏更有效（设计明智）

解决方案1：

```
for(int i=0;i<100;i++){
         p1.play();
         p2.play();
         p3.play();
         p4.play();
} 
```

解决方案2：

```
 p1.play();    //where p1.play() calls p2.play() and so on until p4 calls p1 again.   
                 // this will go on for 100 times 
```

我更喜欢解决方案 2，所以如果发生崩溃，我可以看到从 i=0 处的 p1 到 i=100 处的 p4 的所有函数调用

但是对于解决方案 1，堆栈要短得多，但是当发生崩溃时，我会在循环的开头看到一个调用函数 play() 发生崩溃的地方

你有什么建议？我知道这是 1 中的 2 个问题，但它们非常相关

谢谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:12:18.170

根据我的经验，Java 中的堆栈溢出几乎总是由于编程错误。[在此处](https://stackoverflow.com/questions/860550/stack-overflows-from-deep-recursion-in-java)查看典型尺寸。

现在，您的第二个解决方案是，IMO，非常丑陋......几乎是一个编程错误。假设 N=100 是（某种程度上）游戏的持续时间，那么内存消耗（堆栈大小）随之增加听起来是错误的。我根本不喜欢那个解决方案。

> 当发生崩溃时，我会在循环的开头看到一个调用函数 play() 发生崩溃的地方

我没有看到真正的优势。为什么不放置一个`try catch`块，以便在发生崩溃时可以打印出迭代号？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:05:29.750

对于创建堆栈溢出的递归或嵌套函数，没有一般的经验法则。相反，它取决于堆栈上可用的内存，这可能会因底层硬件和操作系统分配而异。

如果不查看更多代码，很难确定哪种函数调用方法更适合您的情况。我会支持前一个（第一个）选项，因为它对正在发生的事情更加明确，并且它避免将可能不一定相互依赖的方法和对象实例链接在一起。如果您主要关心错误报告，您可以尝试将日志添加到您的代码中，以便更详细地了解正在发生的事情，同时查看堆栈跟踪的转储。希望这个链接也可以帮助你：http: [//developer.android.com/tools/debugging/index.html](http://developer.android.com/tools/debugging/index.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T19:08:13.737

我认为 Shivan Dragon 是对的，没有固定数量的调用，这会导致溢出。但是，您可以使用非常简单的递归函数对其进行测试：

```
public void stackTest(int iteration)
{
    System.out.println("Iteration: "+iteration); // or Log
    stackTest(iteration+1);
} 
```

并称它为：

```
stackTest(1); 
```

然后看看能走多远。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T19:01:11.160

我认为您不能说一般数量的 x 函数调用会触发堆栈内存溢出。这取决于函数、它们的参数、它们的返回类型等，都保存在堆栈内存中，因此不同的函数可能占用不同数量的（堆栈）内存。

无论如何，您永远不应该依赖那些通过尝试考虑使用了多少堆栈而接近崩溃堆栈的代码。您的代码应该始终避免溢出堆栈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T19:10:07.917

Java中每个方法的[框架](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.6)都有：局部变量表和操作数栈。这个堆栈大小是恒定的，每个方法可能有不同的大小。由于 JVM 规范，操作数堆栈大小存储`Code`在字段的方法属性中`max_stack`：

```
Code_attribute {
    u2 attribute_name_index;
    u4 attribute_length;
    u2 max_stack;
    u2 max_locals;
    u4 code_length;
    u1 code[code_length];
    u2 exception_table_length;
    {   u2 start_pc;
        u2 end_pc;
        u2 handler_pc;
        u2 catch_type;
    } exception_table[exception_table_length];
    u2 attributes_count;
    attribute_info attributes[attributes_count];
} 
```

这个大小是在编译过程中计算出来的，当你点击`StackOverflowException`. JVM规范：

> 以下异常情况与 Java 虚拟机堆栈相关： 如果线程中的计算需要的 Java 虚拟机堆栈超出允许范围，则 Java 虚拟机将引发 StackOverflowError。如果 Java 虚拟机堆栈可以动态扩展，并且尝试进行扩展，但没有足够的内存来实现扩展，或者如果没有足够的内存来为新线程创建初始 Java 虚拟机堆栈，则 Java 虚拟机器抛出 OutOfMemoryError。

总结一下：这取决于你的 JVM 被允许获得多少内存。在不同的工作站/智能手机上，您可能有不同的可用内存值。这就是为什么你不应该编写依赖于这些东西的代码。如果您认为`OutOfMemoryException`可能会发生这种情况，请尝试迭代而不是递归地解决您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-01T19:26:48.943

这归结为递归与迭代的原理。

递归允许您以简单的方式编写算法；更容易理解和更快地实施。递归算法可以转换为迭代算法，这将更节省内存和 CPU 效率。

所以决定是性能与简单性/编码工作之一。

这是关于此主题的主题： [递归还是迭代？](https://stackoverflow.com/questions/72209/recursion-or-iteration)

# zope - zope 2.11 通过构建脚本上传页面模板

> ID：12230475
> 
> 赞同：1
> 
> 时间：2012-09-01T18:55:27.383
> 
> 标签：zope, zpt, zenoss

我想将 zope 页面模板作为 svn 中的文件维护，并在它更改时将其上传到 zope。我当然可以通过 zope 管理界面上传它，但我需要自动化该过程。有办法吗？我的系统是 zope 2.11 上的 zenoss-2.5.2。

# jquery - 使这种布局高度增长的最佳方法是什么

> ID：12230477
> 
> 赞同：0
> 
> 时间：2012-09-01T18:55:35.537
> 
> 标签：jquery, html, css

请检查此网站布局图片：

[![布局](../Images/44bcbd354179d8b94b78b5534cd3e075.png)](https://i.stack.imgur.com/Tn7mg.jpg)

我想让高度随着内容的高度而增长。我想到的唯一方法是通过 jquery 更改 div 的高度来完成设计。我正在寻找这种布局的最佳解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T13:25:37.277

![家](../Images/5efe37e0380f24e161f2c919655ced6e.png)

不知道黑色“盒子”和蓝丝带是什么，所以我认为它们是某种标题。但无论如何，我希望您能明白这一点，并且您将能够根据您的需要修改我的代码。

```
<div id="header" class="green">
    <!-- Green section, header of the page -->
</div>
<div id="content" class="red">
    <!-- This #content div should have the red zone as a background -->
    <div class="content-header yellow">
        <!-- Yellow section, header of the content -->
    </div>
    <div class="content-body">
        <p>Your content</p>
    </div>
</div>
<div id="footer" class="purple">

</div> 
```

`#content`div 应该有红色部分作为背景，一个可以垂直重复的细图案。

`.content-header`div 是我认为的标题，它应该有黄色部分作为背景。

但基本上，这个想法是有一个标题（绿色），一个可以垂直重复的背景内容区域（红色）和一个页脚（紫色）。

# php - MySQL 字段大于 bigint

> ID：12230479
> 
> 赞同：0
> 
> 时间：2012-09-01T18:56:24.623
> 
> 标签：php, mysql, sql, database, architecture

让我们这样说吧，我有一个有两种成分的披萨。这些成分存储在我的 PHP 中的一个数组中，在我的 MySQL 中，我将这些数组位置总和的 Int 存储在二进制文件中。

我是说：

```
$ingredients = ["cheese","pepperoni","bacon","onion"]; 
```

如果我的披萨有奶酪和培根，我会存储值 2^0 + 2^2 = **5**。

我所取得的成就是在我的数据库中搜索所有值为**5**的比萨饼并获得快速而酷的搜索。

我的问题是：如果我有大量的配料怎么办？即使我只使用其中的 2 个，如果它们位于阵列的较大位置（比如说 100 个），我就完蛋了。

你会在那个特定的问题中使用什么样的解决方案？

PD-显然我不是在谈论披萨公司，我确实关心毫秒速度

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T19:05:39.003

您最好制作常规的相关表格（`pizza`, `pizza_ingredients`, `ingredients`）

这对你甚至 MySQL 来说都会简单得多：

```
# simple query to find pizza's with specified ingredients
SELECT 
  *
FROM
  pizza_ingredients tpzi
LEFT JOIN
  pizza tp ON
  tp.pizza_ID = tpzi.pizza_ID
WHERE
  tpzi.ingredient_ID IN (1,2,3,45) 
```

表格示例：

表`pizza`：

*   比萨ID，比萨名称

表`pizza_ingredients`'：

*   Pizza_ingredient_ID、pizza_ID、成分 ID

桌子`ingredients`

*   成分 ID，成分名称

* * *

有趣的是..如果您尝试找到带有奶酪的比萨饼：

标准：

```
SELECT 
  *
FROM
  pizza_ingredients tpzi
LEFT JOIN
  pizza tp ON
  tp.pizza_ID = tpzi.pizza_ID
WHERE
  tpzi.ingredient_ID = 1 
```

你的想法：

```
SELECT 
  *
FROM
  pizza
WHERE
  pizza_ingerdients MOD = 0 
```

会更慢:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:00:05.707

在这种情况下，应该在比萨饼和浇头之间实现多对多的关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:38:20.640

听起来您在谈论 SET 数据类型。SET 被输入并显示为以逗号分隔的名称列表，但它们在内部存储为整数位图，因此搜索速度很快。

但是，它们仅限于 64 个元素。如果您需要超过 64 列，则可以有多个列：成分 1、成分 2。

# c# - TPL 数据流被切断了吗？

> ID：12230480
> 
> 赞同：4
> 
> 时间：2012-09-01T18:56:35.797
> 
> 标签：c#, task-parallel-library, tpl-dataflow

我打算使用 TPL 数据流，但我似乎在 VS 2012 的任何地方都找不到它（包括扩展和更新/nuget 对话框的内部）。是他们剪的，还是我找错地方了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T21:03:02.657

[TPL 数据流已从框架本身移至 NuGet。](http://blogs.msdn.com/b/bclteam/archive/2012/05/30/mef-and-tpl-dataflow-nuget-packages-for-net-framework-4-5-rc.aspx)因此，现在，要从您的项目中使用它，您需要从 NuGet 获取它（右键单击引用 → 管理 NuGet 包）。

进行此更改的原因是 TPL 数据流可以更频繁地更新，而不仅仅是在整个框架更新时。

# android - 每次我扩展组时动画组扩展

> ID：12230481
> 
> 赞同：2
> 
> 时间：2012-09-01T18:56:40.897
> 
> 标签：android, android-widget, expandablelistview, expandablelistadapter

**每次展开**一组`ExpandableListView`. 到目前为止，我对自定义适配器的 getChildView 进行了以下操作（基于`BaseExpandableListAdapter`）：

```
public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View view,
        ViewGroup parent) {
    // Auto-generated method stub
    ExpandListChild child = (ExpandListChild) getChild(groupPosition,childPosition);
    if (view == null)
    {
        LayoutInflater inflater = 
                (LayoutInflater) m_context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        view=inflater.inflate(R.layout.expandlist_child_item, null);

        AnimatorSet anim = (AnimatorSet) AnimatorInflater.loadAnimator(m_context, 
                R.animator.expand_list_animation);

        anim.setInterpolator(new OvershootInterpolator());
        anim.start();
    }

    TextView tv = (TextView) view.findViewById(R.id.tvChild);
    tv.setText(child.getName());
    tv.setTag(child.getTag());

    CheckBox cb = (CheckBox) view.findViewById(R.id.checkBox1);
    cb.setChecked(child.getState());
    return view;
} 
```

问题是因为我只在创建新视图时应用动画，所以这只在第一次扩展组时有效。我还尝试在任何情况下应用它（不仅是 when `view==null`），但问题是动画是为所有扩展的孩子播放的（即使是已经扩展的其他组的孩子）。

我一直在努力让它发挥作用，但我不知道怎么做。感谢您的帮助。

# javascript - 使用 javascript 和 mvc 使表格行可单击以获取控制器操作

> ID：12230483
> 
> 赞同：1
> 
> 时间：2012-09-01T18:56:54.830
> 
> 标签：javascript, ajax, asp.net-mvc

我试图使用 javascript 使表格行可点击。我有一个客户表，当单击该行时，它应该转发到详细信息视图。但现在我坚持使用 javascript。首先，我似乎无法获得该行的 id .. 其次，它似乎调用了 Customer 控制器中的 Details 方法......我的 javascript：

```
<script type="text/javascript">
$(document).ready(function(){
    $('#customers tr').click(function () {
        var id = $(this).id;
        $.ajax({
            url: '@Url.Action("Details","Customer")',
            type: 'GET',
            data: { id: id }
        });
    })
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:23:45.077

要获得您需要做的 id：

```
var id = $(this).attr( 'id' ); 
```

不确定其他部分，您可以在浏览器中查看源代码并验证 url 吗？

# twitter - 带有 twitter 休息的空数组获取 user_timeline

> ID：12230486
> 
> 赞同：0
> 
> 时间：2012-09-01T18:57:02.250
> 
> 标签：twitter

我正在尝试使用 twitter API。我做了 oauth 过程，但是在尝试获取 user_timeline 时，我得到一个空数组（但没有身份验证错误，http 响应为 200）。为什么会发生这种情况？

这是我得到的 http 响应（我删除了所有 oauth 数据......）

```
{'status': '200', 'x-ratelimit-remaining': '337', 'content-location': u'http://api.twitter.com/1/statuses/user_timeline.json?oauth_body_hash=....', 'x-transaction': '346e76fdbb36e2d8', 'set-cookie': 'guest_id="v1:134652550000237401"; Expires=Mon, 1-Sep-2014 18:51:40 GMT; Path=/; Domain=.twitter.com, lang=en', 'expires': 'Tue, 31 Mar 1981 05:00:00 GMT', 'x-access-level': 'read-write', 'content-length': '2', 'server': 'tfe', 'last-modified': 'Sat, 01 Sep 2012 18:51:40 GMT', 'x-ratelimit-limit': '350', 'pragma': 'no-cache', 'cache-control': 'no-cache, no-store, must-revalidate, pre-check=0, post-check=0', 'date': 'Sat, 01 Sep 2012 18:51:40 GMT', 'x-frame-options': 'SAMEORIGIN', 'content-type': 'application/json;charset=utf-8', '-content-encoding': 'gzip', 'x-ratelimit-class': 'api_identified', 'x-ratelimit-reset': '1346526376'} 
```

但内容只是一个空数组（json格式）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:40:02.667

这是个愚蠢的问题。问题是用户没有推文，所以这是空的。希望没有人花时间在这上面。

# php - 直接用 PHP 编写元素的样式是否被认为是不好的做法？

> ID：12230490
> 
> 赞同：3
> 
> 时间：2012-09-01T18:57:42.340
> 
> 标签：php, html, css

我知道将 CSS 与 HTML 混合通常被认为是不好的做法，并且 CSS 选择器（id、类等）通常应该用于设置外部样式表中的元素样式。但这在用 PHP 编写动态页面时可能非常不方便。通过写入元素的 style 属性，直接使用 PHP 输出元素的样式要容易得多。这是否会被认为是不好的做法，即使使用类会使开发人员的管理变得更加困难？

例如，我有一个元素的颜色样式存储在数据库中，并且该元素具有不同的颜色，具体取决于动态 PHP 页面中提供的参数。在这种情况下，我可以使用从数据库中获取的颜色变量，使用 php 一些类写入 css 样式表

```
echo '.custom-color {';
echo   'color: ' . $colorFromDatabase . ';';
echo '}'; 
```

然后将类附加到元素：

```
<div class="custom-color"></div> 
```

或者我可以直接将样式回显到元素。

```
echo '<div style="color:' . $colorFromDatabase . ';" >'; 
```

哪个是更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:14:36.657

编写内联样式通常被认为是不好的，无论是使用 PHP 还是手动编写。它更简单但更难维护，并且您不会缓存 CSS 内容。如果你想让 CSS 更加动态，你应该尝试[http://sass-lang.com/](http://sass-lang.com/)

请注意，这`custom-color`不是一个很好的类名，它应该类似于`main-header`, `blog-post`，`last-modified`因为它们告诉您的是内容而不是样式。

SASS 将允许您为颜色定义一个变量并在您的 CSS 文件中重用该变量，然后您只需更改变量名称并重新生成您的 CSS 文件

你正在做的事情的好处是你不必学习新事物。PHP 将完成它。如果您想将 SASS 与数据库中的内容一起使用并提出要使用 CSS 的方案，则需要在构建中写入一些内容。

请注意，在某些情况下，直接编写属性是有意义的，但很难解释确切的时间。通常是只使用一次的时候。

他们页面中的示例

```
// Variable Definitions

$page-width:    800px;
$sidebar-width: 200px;
$primary-color: #eeeeee;

// Global Attributes

body {
  font: {
    family: sans-serif;
    size: 30em;
    weight: bold;
  }
}

// Scoped Styles

#contents {
  width: $page-width;
  #sidebar {
    float: right;
    width: $sidebar-width;
  }
  #main {
    width: $page-width - $sidebar-width;
    background: $primary-color;
    h2 { color: blue; }
  }
}

#footer {
  height: 200px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:05:44.220

为什么不兼得？在 CSS 文件中将 CSS 从 HTML 和 PHP 中分离出来？

您还可以查看 CSS 预处理器。[LESS](http://lesscss.org)是最常见的一种，但也有 SASS、Stylus 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:17:42.743

为了最好的语义使用，我会使用这个：

```
div.colored {
    color: attr(data-color)
} 
```

然后像这样使用PHP：

```
<div class="colored" data-color="<?= $color ?>"></div> 
```

你总是可以用一些简单的 Javascript 来支持它。

# jqgrid - UI 和 info_dialog Jqgrid

> ID：12230497
> 
> 赞同：3
> 
> 时间：2012-09-01T18:58:16.390
> 
> 标签：jqgrid

使用 UI 对话框时，如何设置 info_dialog 的 z-index？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:38:02.703

[$.jgrid.info_dialog 在](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.common.js#L184-263)内部使用[$.jgrid.createModal](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.common.js#L229-237)，它使用了`$.jgrid.jqModal`（请参阅[该行](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.common.js#L49)），该行介绍了不久之后（请参阅我的建议[here](http://www.trirand.com/blog/?page_id=393/feature-request/support-default-values-for-jgrid-createmodal/#p26863)）。所以你可以做类似的事情

```
$.jgrid.jqModal = $.extend($.jgrid.jqModal || {}, {
    zIndex: 1234
}); 
```

因为`navGrid`你必须另外添加另一个参数

```
$.extend($.jgrid.nav, {
    alertzIndex: 1234
}); 
```

使`$.jgrid.jqModal.zIndex`设置工作。

**更新**：以任何方式，您都可以使用“子类化” `$.jgrid.info_dialog`（例如在[答案](https://stackoverflow.com/a/9181899/315935)中）。相应的代码可能如下所示：

```
var oldInfoDialog = $.jgrid.info_dialog;
$.extend($.jgrid,{
    info_dialog: function (caption, content, c_b, modalopt) {
        if (modalopt && (modalopt.zIndex === null || modalopt.zIndex === undefined ||
            (typeof modalopt.zIndex === "number" && modalopt.zIndex < 1234))) {

            modalopt.zIndex = 1234;
        }
        return oldInfoDialog.call (this, caption, content, c_b, modalopt);
    }
}); 
```

# memory-management - common lisp 中对象的内存使用情况

> ID：12230499
> 
> 赞同：8
> 
> 时间：2012-09-01T18:58:34.147
> 
> 标签：memory-management, common-lisp, clos

有没有办法找出一个类或基本数据类型的实例使用了多少内存？

我在 cl 中有一个玩具网络框架，它使用代表 html 标签及其属性的类实例创建和管理网页，并且由于它们应该创建一个 html 页面，因此它们在一个名为 children 的插槽中有子节点。所以我在想如果我采用这种方法，用户的会话将花费多少服务器。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:27:04.673

据我所知，标准中的任意对象都没有这样的东西，但是有依赖于实现的解决方案，比如`ccl:object-direct-size`在 CCL 中：

```
CL-USER> (object-direct-size "foo")
16 
```

但是，请注意，这些是否符合您的要求取决于您所说的“大小”，因为这些函数通常不包括对象引用的组件的大小。您还可以运行 GC，初始化一些对象并[比较](http://rosettacode.org/wiki/Variable_size/Get#Common_Lisp) 前后[`room`](http://clhs.lisp.se/Body/f_room.htm)的[输出。](http://rosettacode.org/wiki/Variable_size/Get#Common_Lisp)

另外，请注意[`time`](http://www.lispworks.com/documentation/HyperSpec/Body/m_time.htm)通常包括分配信息：

```
CL-USER> (time (length (make-array 100000)))
(LENGTH (MAKE-ARRAY 100000))
took 0 milliseconds (0.000 seconds) to run.
During that period, and with 2 available CPU cores,
     0 milliseconds (0.000 seconds) were spent in user mode
     0 milliseconds (0.000 seconds) were spent in system mode
 400,040 bytes of memory allocated.
100000 
```

* * *

也许您可以尝试这样的事情（未经测试，实际上只是一个快速破解）：

```
(defmethod size ((object standard-object))
  (let ((size (ccl:object-direct-size object)))
    (dolist (slot (mapcar #'ccl:slot-definition-name
                          (ccl:class-slots (class-of object))))
      (when (slot-boundp object slot)
        (incf size (size (slot-value object slot)))))
    size))

(defmethod size ((list list))
  (reduce (lambda (acc object) (+ acc (size object)))
          list
          :initial-value (ccl:object-direct-size list)))

(defmethod size (object)
  (ccl:object-direct-size object)) 
```

例如：

```
CL-USER> (defclass foo ()
           ((child :accessor child :initarg :child)))
#<STANDARD-CLASS FOO>
CL-USER> (defclass bar (foo)
           ((child2 :accessor child2 :initarg :child2)))
#<STANDARD-CLASS BAR>
CL-USER> (size '())
0
CL-USER> (size "foo")
16
CL-USER> (size '("foo" "bar"))
40
CL-USER> (size (make-instance 'foo))
16
CL-USER> (size (make-instance 'foo :child '("foo" "bar" "baz")))
72
CL-USER> (size (make-instance
                'bar
                :child "foo"
                :child2 (make-instance 'foo :child (make-array 100))))
456 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T09:34:17.407

在 Common Lisp 中，CLOS 对象通常是插槽的集合。通常，这些插槽可能会在内部存储在某种向量中。CLOS 槽通常包含指向某个数据对象的指针，或者对于一些原始数据类型，可能包含数据本身。这些原始数据类型必须适合一个内存字：例如 fixnums 和 characters。Common Lisp 实现通常不会将更复杂的数据结构内联到插槽中。例如，可以声明一个插槽以包含一个固定数字向量。实现不会在 CLOS 对象内分配这个向量。CLOS 对象将指向一个矢量对象。

那么 CLOS 对象本身应该占用：槽数 * 字长 + 开销。

假设一个字长 4 个字节，32 位。

这可能是具有十个插槽的 CLOS 对象的大小：

```
10 slots * 4 bytes + 8 bytes = 48 bytes 
```

现在想象一下，CLOS 对象的每个槽都指向一个不同的字符串，每个字符串的长度为 100 字节。

上面的例子：

```
1 CLOS object + 10 strings each 100 bytes.

48 bytes + 10 * 100 = 1048 bytes 
```

现在想象每个插槽都指向同一个字符串：

```
1 CLOS object + 1 string of 100 bytes.

48 bytes + 100 bytes = 148 bytes 
```

要计算 CLOS 对象的大小，您可以：

*   只需计算 CLOS 对象本身的大小。这很容易。

*   以某种方式计算可以从对象访问的对象图，确定唯一的内存对象（减去直接分配的原始对象）并将这些对象的所有内存大小相加。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-07T03:28:08.783

我在 cl 中也有 Web 框架，也在为相同的会话问题而苦苦挣扎，这是宇宙发送给我的内容[https://people.gnome.org/~xan/memory.lisp](https://people.gnome.org/~xan/memory.lisp) 它似乎在 sbcl 中工作

```
(memory::dump-memory (weblocks::active-sessions))
Total memory used: 99.785706 MB 
```

# php - 错误“open_basedir 限制生效”

> ID：12230500
> 
> 赞同：0
> 
> 时间：2012-09-01T18:58:46.810
> 
> 标签：php

我正在建立一个可以上传图片的网站。

这是负责图片上传的部分：

```
$ip=rand();
$filename1 = "/public_html/friendscave/temporary/".$ip;
$filename2 = "/public_html/friendscave/temporary/".rand();
$filename3 = "/public_html/friendscave/temporary/".rand();
$filename4 = "/public_html/friendscave/temporary/".rand();
copy($pictures1, $filename1);
copy($pictures2, $filename2);
copy($pictures3, $filename3);
copy($pictures4, $filename4);
$fp1 = fopen($filename1, 'r');
$contents1 = fread($fp1, filesize($filename1)); 
$fp2 = fopen($filename2, "r");
$fp3 = fopen($filename3, "r");
$fp4 = fopen($filename4, "r");
$contents2 = fread($fp2, filesize($filename2)); 
$contents3 = fread($fp3, filesize($filename3)); 
$contents4 = fread($fp4, filesize($filename4));
fclose($fp1); 
fclose($fp2); 
fclose($fp3); 
fclose($fp4);  
$encoded1 = chunk_split(base64_encode($contents1));  
$encoded2 = chunk_split(base64_encode($contents2));  
$encoded3 = chunk_split(base64_encode($contents3));  
$encoded4 = chunk_split(base64_encode($contents4)); 
```

这是我得到的错误

```
Warning: copy() [function.copy]: open_basedir restriction in effect. File() is not within the allowed path(s): (/home/:/usr/lib/php:/tmp) in /PostAD.php on line 130 
```

我不明白这个错误。有人能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:16:59.897

您只能打开`/home`,`/usr/lib/php`和下的文件`/tmp`，但您正试图打开 . 下的文件`/public_html`。

您确定您的意思是直接在根目录中的目录，而不是在用户的主目录 ( `/home/someuser/public_html`) 中吗？

# c# - 如何构造这个 XML 的类？

> ID：12230503
> 
> 赞同：0
> 
> 时间：2012-09-01T18:59:00.967
> 
> 标签：c#, xml, deserialization

我将如何将这个 XML 反序列化为 C# 中的一个类？

```
<?xml version="1.0" encoding="UTF-8"?>  
<root>  
  <infos>  
  </infos>  
  <users>  
    <user userID="1" userRole="1" channelID="0"><![CDATA[Test_User]]></user> 
    <user userID="2" userRole="0" channelID="0"><![CDATA[Test_User_2]]></user> 
  </users>  
  <messages>   
    <message id="349992" dateTime="Sat, 01 Sep 2012 18:29:48 +0000" userID="1" userRole="1" channelID="0">  
      <username><![CDATA[Test_User]]></username>  
      <text><![CDATA[Test Message]]></text>  
    </message>  
    <message id="349993" dateTime="Sat, 01 Sep 2012 18:29:50 +0000" userID="2" userRole="0" channelID="0">  
      <username><![CDATA[Test_User_2]]></username>  
      <text><![CDATA[Test Message 2]]></text>  
    </message>  
  </messages>  
</root> 
```

我之前使用 XML 进行了一些序列化和反序列化，但由于某种原因，我无法为使用此 XML 的类找到正确的结构。

到目前为止，这就是我所拥有的一切，但它不起作用。任何人都可以构建这些类以使用上述 XML 吗？

```
[Serializable]
public class User
{
    [XmlAttribute("userID")]
    public object UserId;
    [XmlAttribute("userRole")]
    public object UserRole;
    [XmlAttribute("channelID")]
    public object ChannelId;
}

[Serializable]
public class Message
{
    [XmlAttribute("id")]
    public object Id;
    [XmlAttribute("dateTime")]
    public object DateTime;
    [XmlAttribute("userID")]
    public object UserId;
    [XmlAttribute("userRole")]
    public object UserRole;
    [XmlAttribute("channelID")]
    public object ChannelId;
    [XmlElement("username")] 
    public object Username;
    [XmlElement("text")]
    public object Text;
}

[Serializable, XmlRoot("root")]
public class Root
{
    [XmlElement("infos")]
    public object Infos;

    [XmlElement("users")]
    public List<User> Users;

    [XmlElement("messages")]
    public List<Message> Messages;
} 
```

它抛出这个错误。

```
System.InvalidOperationException was unhandled by user code
Message=There was an error reflecting type 'ConsoleApplication.Client.Root'.

Message=There was an error reflecting field 'Users'.

Message=There was an error reflecting type 'ConsoleApplication.Client.User'.

Message=There was an error reflecting field 'UserId'.

Message=Cannot serialize member 'UserId' of type System.Object. XmlAttribute/XmlText cannot be used to encode complex types. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:57:40.830

通过这些课程得到它。*请非常小心，因为有些更改是**区分大小写**的！*

```
// only one xml root element is allowed!
[Serializable]
public class User
{
    public User()
    {       }
    [XmlAttribute("userID")]
    public string UserId;
    [XmlAttribute("userRole")]
    public string UserRole;
    [XmlAttribute("channelID")]
    public string ChannelId;
}

[Serializable]
public class Message
{
    public Message()
    {     }
    [XmlAttribute("id")]
    public string Id;
    [XmlAttribute("dateTime")]
    public string DateTime;
    [XmlAttribute("userID")]
    public string UserId;
    [XmlAttribute("userRole")]
    public string UserRole;
    [XmlAttribute("channelID")]
    public string ChannelId;
    [XmlElement("username")]
    public string Username;
    [XmlElement("text")]
    public string Text;
}

[Serializable, XmlRoot("root")]
public class Root
{
    public Root()
    { }

    [XmlElement("infos")]
    public object Infos;

    [XmlArray]
    [XmlArrayItem(ElementName = "user", Type=typeof(User))]
    public User[] users;

    // define what type message is - XmlArray
    // each item within is of c# type Message but within xml file it's message
    [XmlArray]
    [XmlArrayItem(ElementName = "message", Type = typeof(Message))]
    public Message[] messages;
} 
```

加载数据

```
private void frmXmlDeserialize_Load(object sender, EventArgs e)
{
    try
    {
        XmlSerializer xs = new XmlSerializer(typeof(Root));
        StreamReader sr = new StreamReader("import.xml");
        Root r = (Root)xs.Deserialize(sr);
        sr.Close();
    }
    catch (Exception ex)
    {
        Debug.WriteLine(ex.Message);
    }           
} 
```

# sql-server-2008 - 返回 0 的日期部分

> ID：12230506
> 
> 赞同：0
> 
> 时间：2012-09-01T18:59:11.473
> 
> 标签：sql-server-2008

我有以下 sql 将小时转换为分钟，但它返回 0。为什么我会得到这个？

选择（日期部分（分钟，'05:00:00.0000000'））

返回 300

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:01:20.680

因为早上 5 点的分钟部分是 0 : 即 05: **00** :00

你想要类似的东西

```
select (datepart(minute, '05:00:00.0000000')) 
   + (datepart(hour, '05:00:00.0000000')*60) 
```

或者

```
select datediff(minute,  0, convert(time,'05:00:00.0000000')) 
```

# c# - 如何限制用户在表中输入重复值？

> ID：12230507
> 
> 赞同：1
> 
> 时间：2012-09-01T18:59:17.047
> 
> 标签：c#, asp.net, sql, sql-server-2008, tsql

我有一个带有项目名称的表。在 asp.net 中，我有一个文本框，用户可以在其中输入要添加到表中的新项目。我需要限制用户在表中输入重复的项目名称。当用户在表格中已经存在的文本框中输入文本（项目名称）并单击保存按钮时，我需要显示该项目已经存在的消息/验证。我该怎么做呢？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:16:00.337

在 Name 列上向表中添加[唯一约束。](http://msdn.microsoft.com/en-us/library/ms191166%28v=sql.105%29.aspx)然后，当有人尝试添加重复名称时，SQL Server 将引发 execption。您必须处理客户端代码中的异常，向用户显示合理的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:12:13.503

您可以执行以下查询：

```
SELECT checking_col_name
FROM your_table
WHERE checking_col_name = your_textbox_value
GROUP BY checking_col_name
HAVING ( COUNT(checking_col_name) > 0 ) 
```

如果上面的查询返回该行，那么您可以推断该值已经存在于给定表的列中，因此您可以相应地在代码中应用条件.....

正如 Wiktor Zychla 所建议的，上述查询在处理多用户环境时可能会出现问题，我建议您检查`Constraint`.....您可以拥有[UNIQUE 约束](http://msdn.microsoft.com/en-us/library/ms187550.aspx)，以确保不会有重复的行（只有唯一的值） ....如果执行查询以插入重复值，则会引发错误，您可以在代码中跟踪该错误并因此适用于您的条件......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T11:19:45.857

您可以在表的列上使用[唯一约束和唯一索引](http://msdn.microsoft.com/en-us/library/aa224827%28v=sql.80%29.aspx)`Name`。SQL Server 将在输入重复名称时引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T19:10:51.220

您没有编写任何代码，因此：

假设您使用的是 Ajax，一旦文本框的文本属性发生更改，您可以检查数据库是否不存在该项目。

如果您使用的是普通的 asp.net，那么您可以尝试将项目添加到数据库并捕获异常。如果您的插入逻辑中存在异常并且它与重复键（错误号 2601）相关，那么您会使文本框视觉对象无效。

希望它服务。

# arrays - 在 D 语言中，如何对结构数组执行二分查找？

> ID：12230509
> 
> 赞同：1
> 
> 时间：2012-09-01T18:59:32.923
> 
> 标签：arrays, binary-search, d

例如，如果你有一个结构的排序数组：

```
struct Item
{
    int val;
    string property;
} 
```

您将如何使用这些，`assumeSorted`以便您可以搜索`Item.val`？

我可以在网上找到的所有范围示例都使用整数数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T00:08:35.730

您需要定义一个比较运算符：[http ://dlang.org/operatoroverloading.html#compare](http://dlang.org/operatoroverloading.html#compare)

```
struct Item
{
    int val;
    string property;

    int opCmp(ref const Item other) const
    {
        return val - other.val;
    }
} 
```

定义比较运算符后，所有与排序相关的函数都应该像处理整数一样工作。

# spring - 使用 Maven 配置 Spring Batch

> ID：12230521
> 
> 赞同：0
> 
> 时间：2012-09-01T19:01:08.957
> 
> 标签：spring, spring-batch

使用 Maven 配置 Spring Batch。使用的JDK：1.6，Spring Batch 2.1.8.RELEASE；春季版本 3.0.5.RELEASE。获取运行时异常如下：

```
D:\SpringProject\SpringTry\target>java -jar SpringTry-1.0-SNAPSHOT.jar jobs/helloWorld.xml helloWorldJob
2012-09-02 00:23:51,650 INFO [org.springframework.context.support.ClassPathXmlApplicationContext] - <Refreshing org.springframework.context.
support.ClassPathXmlApplicationContext@b29c9d: startup date [Sun Sep 02 00:23:51 IST 2012]; root of context hierarchy>
2012-09-02 00:23:51,769 INFO [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] - <Loading XML bean definitions from class path
 resource [jobs/helloWorld.xml]>
2012-09-02 00:23:53,854 INFO [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] - <Loading XML bean definitions from class path
 resource [launch-context.xml]>
2012-09-02 00:23:53,929 ERROR [org.springframework.batch.core.launch.support.CommandLineJobRunner] - <Job Terminated in error: Configuration
 problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://www.springframework.org/schema/batch]
Offending resource: class path resource [jobs/helloWorld.xml]
>
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler fo
r XML schema namespace [http://www.springframework.org/schema/batch]
Offending resource: class path resource [jobs/helloWorld.xml]

        at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
        at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85) 
```

有关如何解决此问题的任何建议。还注意到每次都会下载 Spring 2.5.6，以及提到的版本 3.0.5

我的清单看起来像：

```
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Build-Jdk: 1.6.0
Main-Class: org.springframework.batch.core.launch.support.CommandLineJobRunner
Class-Path: lib/spring-batch-core-2.1.9.RELEASE.jar lib/xstream-1.3.jar lib/xpp3_min-1.1.4c.jar lib/jettison-1.1.jar lib/spring-aop-2.5.6.jar lib/aopalliance-1.0.jar lib/spring-tx-2.5.6.jar lib/spring-batch-infrastructure-2.1.9.RELEASE.jar lib/spring-beans-3.0.5.RELEASE.jar lib/spring-context-3.0.5.RELEASE.jar lib/spring-expression-3.0.5.RELEASE.jar lib/spring-asm-3.0.5.RELEASE.jar lib/spring-core-3.0.5.RELEASE.jar lib/commons-logging-1.1.1.jar lib/spring-jdbc-3.0.5.RELEASE.jar lib/log4j-1.2.16.jar lib/maven-resources-plugin-2.4.3.jar lib/maven-plugin-api-2.0.6.jar lib/maven-project-2.0.6.jar lib/maven-profile-2.0.6.jar lib/maven-artifact-manager-2.0.6.jar lib/maven-plugin-registry-2.0.6.jar lib/maven-core-2.0.6.jar lib/wagon-file-1.0-beta-2.jar lib/maven-plugin-parameter-documenter-2.0.6.jar lib/wagon-http-lightweight-1.0-beta-2.jar lib/wagon-http-shared-1.0-beta-2.jar lib/jtidy-4aug2000r7-dev.jar lib/xml-apis-1.0.b2.jar lib/maven-reporting-api-2.0.6.jar lib/doxia-sink-api-1.0-alpha-7.jar lib/wagon-provider-api-1.0-beta-2.jar lib/maven-repository-metadata-2.0.6.jar lib/maven-error-diagnostics-2.0.6.jar lib/commons-cli-1.0.jar lib/wagon-ssh-external-1.0-beta-2.jar lib/wagon-ssh-common-1.0-beta-2.jar lib/maven-plugin-descriptor-2.0.6.jar lib/plexus-interactivity-api-1.0-alpha-4.jar lib/wagon-ssh-1.0-beta-2.jar lib/jsch-0.1.27.jar lib/classworlds-1.1.jar lib/maven-artifact-2.0.6.jar lib/maven-settings-2.0.6.jar lib/maven-model-2.0.6.jar lib/maven-monitor-2.0.6.jar lib/plexus-container-default-1.0-alpha-9-stable-1.jar lib/junit-3.8.1.jar lib/plexus-utils-2.0.5.jar lib/maven-filtering-1.0-beta-4.jar lib/plexus-build-api-0.0.4.jar lib/plexus-interpolation-1.13.jar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:13:25.500

您很可能是：

*   只需使用版本低于 2.0 的 spring-batch-core jar 版本（Maven 依赖项）。Schema 命名适用于 2.0 及更高版本。如果是这种情况，请更新您的依赖项

或者

*   您在项目的 pom.xml 中有正确（高于 2.0）版本的 spring-batch-core，但您也有一个传递依赖项，它将早期版本的 spring-batch-core 带入您的项目。如果是这种情况，请尝试以下操作：

    > mvn 依赖：tree -Dverbose -Dincludes=org.springframework.batch

这将列出所有引入他们自己版本的 spring-batch 依赖项的依赖项。在 spring-batch-core 上为这些依赖项添加一个排除条目，如下所示：

```
<dependency>
          <groupId>whatever.group</groupId>
          <artifactId>whateverArtifact</artifactId>
          <version>1.0</version>
          <exclusions>
            <exclusion>
                <groupId>org.springframework.batch</groupId>
                <artifactId>spring-batch-core</artifactId>
            </exclusion>
          </exclusions>
        </dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:48:57.223

我的问题通过添加 maven-shade-plugin 得到解决，详见： [https ://stackoverflow.com/a/8574629/1419116](https://stackoverflow.com/a/8574629/1419116)

# python - 在python中随机打乱一个稀疏矩阵

> ID：12230527
> 
> 赞同：9
> 
> 时间：2012-09-01T19:01:36.073
> 
> 标签：python, numpy, sparse-matrix, shuffle

有没有一种简单的方法可以在 python 中对稀疏矩阵进行洗牌？

这就是我洗牌非稀疏矩阵的方式：

```
 index = np.arange(np.shape(matrix)[0])
    np.random.shuffle(index)
    return matrix[index] 
```

我怎么能用 numpy sparse 做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-01T19:27:13.813

好的，找到了。稀疏格式在打印输出中看起来有点混乱。

```
 index = np.arange(np.shape(matrix)[0])
    print index
    np.random.shuffle(index)
    return matrix[index, :] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-18T14:11:32.423

如果有人希望从稀疏矩阵中随机获取行的子样本，这篇相关文章也可能很有用：[我应该如何从 scipy.sparse.csr.csr_matrix 和列表中进行子采样](https://stackoverflow.com/questions/22899681/how-should-i-go-about-subsampling-from-a-scipy-sparse-csr-csr-matrix-and-a-list)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-22T22:46:03.317

更好的方法可以是改组 CSR 矩阵的索引并获取矩阵的行，如下所示：

```
from random import shuffle
indices = np.arange(matrix.shape[0]) #gets the number of rows 
shuffle(indices)
shuffled_matrix = matrix[list(indices)] 
```

# android - Android：无法对从 sd 卡上传的图像进行画布绘画

> ID：12230528
> 
> 赞同：2
> 
> 时间：2012-09-01T19:01:37.637
> 
> 标签：android, android-canvas, touch-event

我正在尝试构建一个绘画应用程序。申请分为3个部分：

1.  最初，应用程序具有白色背景，用户可以使用不同的画笔大小和不同的颜色在画布上绘画
2.  用户可以将画布图像保存到 sd 卡
3.  用户可以从 sd 卡上传图像并再次在图像上绘画

第 1 点和第 2 点工作正常，我可以在白色背景上绘画。但是第 3 点，当我从画廊上传任何图像并尝试在图像上绘画时，之前绘制的路径会消失，只显示新路径。

代码 ：

```
onDraw(Canvas canvas){
  mBitmap = Bitmap.createBitmap(320, 480, Bitmap.Config.ARGB_8888);
  mCanvas = new Canvas(mBitmap);
  mPath = new Path();
  mBitmapPaint = new Paint(Paint.DITHER_FLAG);
  canvas.drawColor(Color.WHITE);
  canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
  canvas.drawPath(mPath, mPaint);
}

onTouch - >

case MotionEvent.ACTION_DOWN:

                mPath.reset();
                mPath.moveTo(x, y);
                mX = x;
                mY = y;
                invalidate();
                break;
            case MotionEvent.ACTION_MOVE:
                float dx = Math.abs(x - mX);
                float dy = Math.abs(y - mY);
                if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
                    mPath.quadTo(mX, mY, (x + mX) / 2, (y + mY) / 2);
                    mX = x;
                    mY = y;
                }
                invalidate();
                break;
            case MotionEvent.ACTION_UP:
                mPath.lineTo(mX, mY);
                mCanvas.drawPath(mPath, mPaint);
                mPath.reset();
                break;

mBitmap = BitmapFactory.decodeFile(filePath); -----this is from sd card 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:00:10.277

我不确定您的应用程序是否保留了先前绘制的路径并绘制了新路径。**这样做的原因是每次调用 onDraw() 方法时，您都在创建一个新的位图并在其上绘制路径，并且在调用mpath.reset()**时也没有保存以前的路径。
还有一点非常重要：Never Never！在迭代中调用 createBitmap() 方法。它会消耗大量内存，并会导致**outOfMemory**异常。您的问题的解决方案是：

*   在自定义视图的构造函数中从任何流（SD 卡、可绘制等）或空位图创建位图（应该是可变的），然后创建画布并使用相同的位图进行绘制。在您的 touch_up() 方法中，在此画布上绘制路径。在 onDraw() 中，您应该将此位图用作画布的指定位图（作为参数传递，此处无需创建新的画布）进行绘制。

在这里，您可以按照此[链接](http://pastebin.com/fCv0P10y)访问 android api 演示代码。

# c# - 检查计算是否超过 MaxValue

> ID：12230534
> 
> 赞同：0
> 
> 时间：2012-09-01T19:02:26.867
> 
> 标签：c#, overflow, decimal

我目前有以下方法，它返回我的百分比值。例如，对于 350,000 美元的商品价格和 7% 的百分比，它返回​​ 24,500。

```
 public static decimal GetPercentValue(decimal? percentage, decimal baseValue)
    {
        decimal result = 0m;

        if (percentage != null)
        {
            try
            {
                result = Convert.ToDecimal(baseValue * percentage / 100m);
            }
            catch (OverflowException)
            {
                result = 0;
                Logger.Warn("OverflowException caught in GetPercentValue() - should better be handled UI-Sided!");
            }
        }

        return result;
    } 
```

我认为这不是正确的处理方式，那么在这种情况下有什么方法可以避免异常吗？

当用户输入一个疯狂的数字`999,999,999,999,999,999`并计算`9999999999%`它时，会引发 OverflowException。这样我就无法检查`percentage`或仅仅`baseValue`因为`<= decimal.MaxValue`它们不是……计算结果本身就超出了小数范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-31T16:28:34.130

这是一个老问题，但我遇到了类似的问题，并想提供一个可能的替代解决方案。当两个数字的某些计算产生一个大于 MaxValue 的数字时，就会出现问题。这会导致异常，并且很难以通常的方式进行测试：

```
decimal existingValue = decimal.MaxValue;
decimal newValue = (decimal)100;

//doesn't work -- exception thrown here
if(existingValue + newValue <= decimal.MaxValue)
{

} 
```

似乎对我有用的解决方案（不使用 Try-Catch 块）是重写方程，在这种情况下作为减法：

```
if(decimal.MaxValue - existingValue >= newValue)
{
    //DoSomething
} 
```

由于减法，没有超过 MaxValue。我还没有尝试过乘法/除法示例，但我猜它也会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:45:38.920

错误处理应该（很可能）在方法之外完成。现在您正在隐藏异常并返回错误结果（发生错误时返回 0）。您的方法的调用者无法判断结果是正确的还是由于 OverflowException。

我会这样重写方法：

```
public static decimal GetPercentValue(decimal? percentage, decimal baseValue)
{
    if (percentage == null)
        return 0;

    return baseValue*(percentage.Value/100);
} 
```

并且可以选择添加一个验证方法，用户可以调用该验证方法在调用实际方法之前检查参数。验证错误可能会显示在 UI 中：

```
public static string ValidatePercentValue(decimal? percentage, decimal baseValue)
{
    try
    {
        GetPercentValue(percentage, baseValue);
        return null;
    }
    catch (Exception ex)
    {
        return ex.Message;
    }
} 
```

除了那个注意...

```
baseValue*(percentage.Value/100) 
```

……比……好

```
baseValue*percentage.Value/100 
```

尝试计算 100% 的 decimal.MaxValue。第一个有效，而第二个则引发 OverflowException。

# gmail - 错误：在 Google Apps 脚本中调用 GmailApp 对象时“无法访问库 BloggerApp”

> ID：12230538
> 
> 赞同：0
> 
> 时间：2012-09-01T19:02:55.953
> 
> 标签：gmail, google-apps-script

“您无权访问您的脚本使用的库 BloggerApp，或者它已被删除。”</p>

当我运行以下代码时，Google Apps 脚本会引发上述错误：

```
var thread = GmailApp.getInboxThreads(0,1)[0]; // get first thread in inbox
var message = thread.getMessages()[0]; // get first message
Logger.log(message.getBody()); // log contents of the body 
```

通过测试上述代码的以下子集（产生相同的错误），我已将问题隔离到 GmailApp 对象调用：

```
var thread = GmailApp; 
```

解决方案尝试尝试并失败：

1.  我注册了一个 Blogger 帐户。（没有影响。）
2.  我在“管理库...”菜单下搜索“BloggerApp”（未返回任何结果。）
3.  我试图将我的脚本作为服务发布并将我的脚本添加到我的库中。（当时这个解决方案对我来说没有逻辑意义，但我还是尝试了它，因为我的想法已经用完了。）
4.  我进行了谷歌搜索和 Stack Overflow 搜索，并在互联网上的任何地方都没有发现类似的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:46:24.503

这个问题已经解决了。该问题是由于尝试将第 3 方脚本库添加到我的脚本中失败而引起的。

# android - 将现有应用程序转换为使用选项卡

> ID：12230541
> 
> 赞同：2
> 
> 时间：2012-09-01T19:03:15.577
> 
> 标签：android, tabs, android-fragments, android-tabs

我有一个使用仪表板样式模式的现有应用程序，其中有一个主菜单，单击主菜单驱动器上的图标启动不同的活动......为了导航到不同的功能，您需要返回仪表板菜单并选择另一个图标。

我想将我的应用程序更改为类似于下面带有图标的选项卡格式： ![在此处输入图像描述](../Images/606e48589e197fc23a2bde9354515e16.png)

下面使用的是什么类型的视图？这是一个片段活动吗？另外，进行转换的最佳方法是什么？我在线性/相对布局中有一堆带有列表视图的布局......我可以重用任何现有代码吗？如果可能的话，我还希望能够在 Android 2.1 及更高版本中使用该解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:18:48.523

在您提供的图像中，它看起来是一个已使用的 TabHost（可以在普通 Activity 或 Fragment Activity 中），并且在使用 Android Support 库时可用于 Android 2.1 及更高版本。根据您的描述，您很可能每个项目都有一个活动，您可能希望将其转换为不同的片段。这可能需要一点时间，但 Fragment 在很多方面都与正常活动非常相似，因此一旦您开始习惯它，转换旧的活动应该是轻而易举的事。

如果您计划使用这些选项卡并遵循 Android 设计 UI 指南，您可能希望将 TabHost 与 ViewPager 结合使用。网上有一个很棒的教程，它还允许向后兼容（至少低至 2.1）：http: [//thepseudocoder.wordpress.com/2011/10/13/android-tabs-viewpager-swipe-able-标签-ftw/](http://thepseudocoder.wordpress.com/2011/10/13/android-tabs-viewpager-swipe-able-tabs-ftw/)

片段/viewpager 的支持库：http: [//developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)

有关 TabHost 和使用带有片段的选项卡的更多信息，请参见此处：

[http://developer.android.com/reference/android/widget/TabHost.html](http://developer.android.com/reference/android/widget/TabHost.html)

[http://thepseudocoder.wordpress.com/2011/10/04/android-tabs-the-fragment-way/](http://thepseudocoder.wordpress.com/2011/10/04/android-tabs-the-fragment-way/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:09:00.053

您可以使用 TabLayout 和 TabActivity 来实现图片中的布局。坏消息是这些在 Android 3.0 中已被弃用。谷歌建议使用片段而不是这些。

# php - Jenkins - 将图表添加到工作界面

> ID：12230542
> 
> 赞同：7
> 
> 时间：2012-09-01T19:03:22.220
> 
> 标签：php, jenkins

如何将 pdepend 图表添加到 Jenkins 工作界面（在项目标题下）？真的可以这样做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T23:27:49.987

是的。Jenkins 描述允许添加图像。

前段时间您可以使用`embed`，但在添加 XSS 保护时已将其删除，但是：

假设您的图表在`build/pdepend/*`说明中粘贴以下两行：

```
<img type="image/svg+xml" height="300" src="ws/build/pdepend/overview-pyramid.svg" width="500"></img>
<img type="image/svg+xml" height="300" src="ws/build/pdepend/dependencies.svg" width="500"></img> 
```

通过使用相对路径，如果重命名项目或移动服务器，则无需更改路径。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-07-21T12:16:50.263

即使使用了[edorian](https://stackoverflow.com/users/285578/edorian)给出的解决方案，它对我也不起作用。

在做了一些研发之后，我发现这是 Jenkins 中的一个错误

[https://issues.jenkins-ci.org/browse/JENKINS-22028](https://issues.jenkins-ci.org/browse/JENKINS-22028)

并在 1.564 或更高版本中解决。

要解决这个问题，您所要做的就是.. 转到 Manage Jenkins> Configure Global Security > 并选择标记格式化程序作为 RAW HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-14T14:23:20.060

我知道这是一个老问题，但这可能对那些正在寻找方法的人有所帮助。首先，我的项目是一个测试项目，其中我的一个测试步骤写入了一个文件，其中包含我想要随时间测量的结果，所以我有一个 csv 文件。然后我在项目描述中集成了一个[highchart.js](http://www.highcharts.com/docs/getting-started/your-first-chart)脚本和 csv 值。所以，这样我就有了一个图表，其中包含一个地方的所有工作的价值，看起来像这样：

[![詹金斯图表截图](../Images/ea101cac3a5a4bdac8525e5a58214f45.png)](https://i.stack.imgur.com/OcFEH.png)

注意：要做到这一点，你必须安装“anything-goes-formatter”插件，我认为这有安全风险。我希望这对某人有帮助。

# python - 在python中以行格式显示整数

> ID：12230543
> 
> 赞同：0
> 
> 时间：2012-09-01T19:03:42.630
> 
> 标签：python

我试图找出一种方法让这些整数在保持顺序的同时显示在行中。

但是当我运行代码时，这是我得到的显示。

```
Enter numbers 1... 22,34,35,40,55
Enter numbers 2... 12,14,34,47,49
Enter numbers 3... 1,4,10,19,30

Section 1             #
The number seqeuce is 0 between 0 and 9
The number seqeuce is 0 between 10 and 19
The number seqeuce is 1 between 20 and 29
The number seqeuce is 2 between 30 and 39
The number seqeuce is 1 between 40 and 49
The number seqeuce is 1 between 50 and 59
Section 2
The number seqeuce is 0 between 0 and 9
The number seqeuce is 2 between 10 and 19
The number seqeuce is 0 between 20 and 29
The number seqeuce is 1 between 30 and 39
The number seqeuce is 2 between 40 and 49
The number seqeuce is 0 between 50 and 59
Section 3
The number seqeuce is 2 between 0 and 9
The number seqeuce is 2 between 10 and 19
The number seqeuce is 0 between 20 and 29
The number seqeuce is 1 between 30 and 39
The number seqeuce is 0 between 40 and 49
The number seqeuce is 0 between 50 and 59
                      # 
```

这是我希望看到的与范围整数相对应的顺序。

```
Enter numbers 1... 22,34,35,40,55
Enter numbers 2... 12,14,34,47,49
Enter numbers 3... 1,4,10,19,30
Section 1
The number seqeuce is 0 0 1 2 1 1 #
Section 2                         #
The number seqeuce is 0 2 0 1 2 0 # <-- Here is the sequennce from above
Section 3                         #
The number seqeuce is 2 2 0 1 0 0 # 
```

这是我到目前为止所拥有的。

```
import collections  

the_inputs = [] 

for i in range(3): 
    the_inputs.append(raw_input("Enter numbers {}... ".format(i+1))) 

the_lists = [] 

for the_input in the_inputs: 
    the_lists.append([int(x)//10 for x in the_input.strip("[]").split(",")]) 

for i, the_list in enumerate(the_lists): 
    print "Section {}".format(i+1) 
    group_counter = collections.Counter(the_list) 
    bin_range = range (6)  
    for bin_tens in bin_range:
        print "The number seqeuce is {} between {} and {}".format(group_counter[bin_tens], bin_tens*10, bin_tens*10+9) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:12:33.503

一个简单的重新排列：

```
print "The number sequence is",
for bin_tens in bin_range:
    print group_counter[bin_tens],
print 
```

# php - cURL 在处理带有冒号的 URL 源时遇到问题

> ID：12230551
> 
> 赞同：0
> 
> 时间：2012-09-01T19:05:04.930
> 
> 标签：php, curl

使用 cURL 获取一个 php 脚本，该脚本获取源名称中带有冒号的 url 的内容：

```
$url = 'http://www.awebsite.com/anxml:file:thatoddly:hascolons:allovertheplace:';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
$data = curl_exec($ch);

if(curl_errno($ch)) {
   echo 'Curl error: ' . curl_error($ch);
}

curl_close($ch); 
```

我收到错误消息。

```
Could not resolve host: http; nodename nor servname provided, or not known <url here> 
```

我已经仔细检查了 url 是否正常工作，但我怀疑 cURL 在文件名中的冒号上阻塞。来源不是我的，所以我不能删除冒号。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T04:59:58.777

提供者修复了他们的文件，所以我不必再处理冒号了。事实证明，我毕竟不正确地使用了 cURL，并且很可能带有下面代码的 urlencode() 会起作用。

这不起作用：

```
 $url = urlencode($url);
    $url = str_replace("http%3A","http:",$url);

    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    $data = curl_exec($ch); 
```

这确实有效：

```
 $url = urlencode($url);
    $url = str_replace("http%3A","http:",$url);

    $c = curl_init($url);
    curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
    $data = iconv("UTF-8","ISO-8859-1",curl_exec($c)); 
```

希望能帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:30:12.093

查看[手册页](http://curl.haxx.se/docs/manpage.html#--data-urlencode)，**cURL**有一个*--data-urlencode*标志。

如果只是一个 URL 不是通过 CLI 而是 PHP 完成的，您可以使用 PHP 的**urlencode()**。

# android - Android 如何在运行时更改应用程序语言

> ID：12230553
> 
> 赞同：22
> 
> 时间：2012-09-01T19:05:21.707
> 
> 标签：android, runtime

我想让用户使用微调器（或任何方式）更改我的应用程序的语言。我尝试了很多方法，但他们改变了这个活动的语言，而不是所有活动，我想保存它，这样当用户重新启动应用程序时，他会找到最后选择的语言。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-01T19:38:04.040

您可以在微调器或任何您想要的方式中使用此代码

```
String languageToLoad  = "en"; // your language 
Locale locale = new Locale(languageToLoad);  
Locale.setDefault(locale); 
Configuration config = new Configuration(); 
config.locale = locale; 
getBaseContext().getResources().updateConfiguration(config,  
getBaseContext().getResources().getDisplayMetrics()); 
```

那么你应该像这样保存语言

```
SharedPreferences languagepref = getSharedPreferences("language",MODE_PRIVATE);
SharedPreferences.Editor editor = languagepref.edit();
editor.putString("languageToLoad",languageToLoad );
editor.commit(); 
```

并在每个活动中使用相同的代码从 SharedPreferences`onCreate()`加载`languageToLoad`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-13T11:27:21.657

这是一个老问题，但无论如何我都会回答：-) 您可以扩展 Application 类以将 Abol3z 的解决方案应用于每个 Activity。创建类：

```
public class MyApplication extends Application {

   @Override
   public void onCreate() {
       super.onCreate();
       SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
       String lang = preferences.getString("lang", "en");
       Locale locale = new Locale(lang);
       Locale.setDefault(locale);
       Configuration config = new Configuration();
       config.locale = locale;
       getBaseContext().getResources().updateConfiguration(config,
               getBaseContext().getResources().getDisplayMetrics());    
   }  
} 
```

并将 MyApplication 设置为清单中的应用程序类：

```
 <application
        android:name=".MyApplication"
        ...
 /> 
```

您可以设置 lang 值（在您的微调器中）：

```
SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(getContext());
preferences.edit().putString("lang", "en").commit(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-01T19:12:07.153

使用 SharedPreferences 来跟踪用户选择的语言，然后在 onCreate() 和 onResume() 方法中设置活动以使用该语言。这样，它将在应用程序重新启动等过程中持续存在。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-09T09:08:20.320

```
btnChange.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(mContext);
            //preferences.edit().putString("lang", "bn").commit();

            String lang = preferences.getString("lang", "en");
            //Log.e("lang", "lang in Main Activity:"+lang);
            if (lang.equalsIgnoreCase("en")){
                setLocale("bn");
                preferences.edit().putString("lang", "bn").commit();
                btnChange.setText("Eng");
            }else if(lang.equalsIgnoreCase("bn")){
                setLocale("en");
                preferences.edit().putString("lang", "en").commit();
                btnChange.setText("বাংলা");
            }
        }
    });

public void setLocale(String lang) {

    myLocale = new Locale(lang);
    Resources res = getResources();
    DisplayMetrics dm = res.getDisplayMetrics();
    Configuration conf = res.getConfiguration();
    conf.locale = myLocale;
    res.updateConfiguration(conf, dm);
    Intent refresh = new Intent(this, MainActivity.class);
    startActivity(refresh);
    finish();
} 
```

我们使用两种语言进行测试。将所有字符串保存在名为 values 和 values-bn 的不同文件夹中。

# c# - 通过句柄操作窗口/进程（即使没有标题或窗口）

> ID：12230561
> 
> 赞同：-2
> 
> 时间：2012-09-01T19:05:59.633
> 
> 标签：c#, winapi, enumeration, window-handles

我想检查一下这段代码，看看你能不能帮我实现它

如果是这样，有没有一种方法可以更快地查询以“a”开头的进程和以“b”开头的进程

（是不是通过使用`filter`参数）

是否可以通过其他方法使用所需的参数来完成

```
EnumDesktopWindows(IntPtr.Zero, filter, IntPtr.Zero) 
```

我如何才能`EnumDesktopWindows()`与另一个人通话，也许不仅使用本机方法 - 如上所述的过滤......有点“帮助”方法

```
 private const string USER32 = "user32.dll";

    internal delegate bool EnumDelegate(IntPtr hWnd, int lParam);

    [DllImport(WindowsFunctions.USER32, EntryPoint = "GetWindowText", ExactSpelling = false, CharSet = CharSet.Auto, SetLastError = true)]
    internal static extern int GetWindowText(IntPtr hWnd, StringBuilder lpWindowText, int nMaxCount);

    [DllImport(WindowsFunctions.USER32)]
    [return: MarshalAs(UnmanagedType.Bool)]
    internal static extern bool IsWindowVisible(IntPtr hWnd);

    [DllImport(WindowsFunctions.USER32)]
    internal static extern int GetWindowThreadProcessId(IntPtr hWnd, out int processId);

    [DllImport(WindowsFunctions.USER32)]
    internal static extern bool EnumDesktopWindows(IntPtr hDesktop, EnumDelegate lpfn, IntPtr lParam);

public class WindowData
{
    public string Title { get; set; }
    public long ProcessId { get; set; }
    public long ThreadId { get; set; }
    public IntPtr HWindow { get; set; }
}

        var collection = new List<WindowData>();

        EnumDelegate filter = delegate(IntPtr hWnd, int lParam)
        {
            StringBuilder strbTitle = new StringBuilder(255);
            int nLength = WindowsFunctions.GetWindowText(hWnd, strbTitle, strbTitle.Capacity + 1);
            string strTitle = strbTitle.ToString();

            if (IsWindowVisible(hWnd) && !string.IsNullOrEmpty(strTitle))
            {
                int pid;
                int threadId = WindowsFunctions.GetWindowThreadProcessId(hWnd, out pid);

                collection.Add(new WindowData()
                {
                    Title = strbTitle.ToString(),
                    ProcessId = pid,
                    ThreadId = threadId,
                    HWindow = hWnd
                });
            }

            return true;
        };

        if (EnumDesktopWindows(IntPtr.Zero, filter, IntPtr.Zero))
        {
            return collection.ToArray();
        }

        return null;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T03:23:50.490

这就是我想出的临时解决方案

```
public static class MyProc
    {
        public static IntPtr WoWhWnd;
        public static string WoWProcName;
        public static string WowMainWinTitle;
        public static int WowID;
        public static IntPtr MyApphWnd;
        public static string MyAppProcName;
        public static string MyAppMainWinTitle;
        public static int MyAppID;
    }

    public void bring(string handletoFront)
    {
        switch (handletoFront)
        {
            default:

                SetForegroundWindow(MyProc.WoWhWnd);

                break;
            case "MyApp":

                SetForegroundWindow(MyProc.MyApphWnd);
                                    break;
        }

    }

           #region <<=========== Enumerating Processes   ============>>

        void  ShowP1(){

            IEnumerable<Process> processes = from p in Process.GetProcesses() where p.ProcessName.StartsWith(TBXSearchWindowTerm.Text) || p.ProcessName.StartsWith("WindowsF") orderby p.ProcessName select p;
            MyProc.MyApphWnd = processes.ElementAt(1).MainWindowHandle;
            MyProc.MyAppMainWinTitle = processes.ElementAt(1).MainWindowTitle;
            MyProc.MyAppID = processes.ElementAt(1).Id;
            MyProc.WoWhWnd = processes.ElementAt(0).MainWindowHandle;
            MyProc.WowMainWinTitle = processes.ElementAt(0).MainWindowTitle;
            MyProc.WowID = processes.ElementAt(0).Id;
            pause(350);
            SetForegroundWindow(MyProc.WoWhWnd);
            pause(850);
            SetForegroundWindow(MyProc.MyApphWnd);
        } 
```

在其中一个查询中，我使用了一个文本框值，因此它可以是一个恒定搜索和一个动态可选搜索，如果您发现我做错了或者我可以做得更好，请发表评论。谢谢你 。

# php - MySQL看似随机返回空集

> ID：12230566
> 
> 赞同：0
> 
> 时间：2012-09-01T19:06:46.700
> 
> 标签：php, mysql

我不明白为什么 MySQL 在以下查询中只为某些用户返回一个空集。我在每个个人资料中都输入了相同的信息，并且只有几个用户 ID 会返回结果。

```
SELECT userinfo.userid, userinfo.location, locations.locationsName, locations.locationsID FROM userinfo
INNER JOIN locations ON locations.locationsID = userinfo.userid
WHERE userinfo.userid = '$userid' 
```

这是我的表格（有更多列，但与此搜索无关）

```
userinfo
userid | location 

locations
locationsID | locationsName 
```

例如，我可以打开 PHPMyAdmin 并输入该查询（更改 $userid）。我确保每个用户名都输入了相同的信息（除了用户名不同）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:08:08.557

因为您将 LocationID 加入到 UserID。

根据您给定的架构，您可能想要加入`userinfo.userid = location.userid`

# javascript - javascript JQuery 类似选择器

> ID：12230568
> 
> 赞同：0
> 
> 时间：2012-09-01T19:07:24.953
> 
> 标签：javascript, jquery, class, methods, selector

大家好，我想要 JQuery 选择器之类的东西。我的意思是：

JQuery 有一个这样的选择器：

```
$("#exampleID").JQexampleMethod(); 
```

我想为我的班级提供类似的东西。例如

```
selector("#exampleID").MYexampleMethod(); 
```

但我不知道如何做到这一点。我知道如何创建类并定义它们。但无法满足我的需求。到目前为止，我所做的是：

```
var class = new TestClass();
class.selector("#exampleID").MyExampleMethod(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:11:37.687

jQuery 使用[Sizzle 库](http://sizzlejs.com/)来评估选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:16:03.127

复制 jQuery 并不是那么容易，因为它包含针对跨浏览器问题的各种修复，甚至是整个选择器库。

也就是说，如果你忽略这些问题，一个简单的原型可以如下所示：

```
var selector = function(selector) {
  var res = document.querySelectorAll(selector);  // fetch elements
  res.myExampleMethod = function() {  // add a method
    return res.length;
  };
  return res;
}; 
```

您可以按如下方式使用它：

```
selector("p").myExampleMethod();  // e.g. 12 
```

# http - 将大量数据存储为 cookie

> ID：12230569
> 
> 赞同：0
> 
> 时间：2012-09-01T19:07:28.743
> 
> 标签：http, cookies, http-headers, storage

我正在尝试在从我的服务器传输的用户机器上存储大量数据（这是最安全的方法）。数据约为 4K - 我尝试将其存储为 cookie，但我收到 500 错误，因为它太大了。我尝试对它进行分块，但它在标题中使用的空间量太大。目前，我发回一个标识符并将数据存储在我的服务器上，以便使用该 ID 进行检索，但这比我希望的安全性低。有没有人对我如何做到这一点有任何其他想法？我的意思是，如果我现在正在做的事情真的是最好的方式，那么我就会这样做——但不必将这些数据存储在我的服务器上会很好。

# php - 使用价值形式下拉菜单？

> ID：12230570
> 
> 赞同：0
> 
> 时间：2012-09-01T19:07:33.597
> 
> 标签：php, jquery, html, css

我有一个这样的菜单：

```
<select>
<option value="21">option a</option>
<option value="13">option b</option>
<option value="21">option c</option>
</select> 
```

根据选择的选项，我需要获取相应的值以在链接和图像的其他地方使用。（它还需要在点击之前从默认选项中拉出）

```
<img src="mysite.com/images/[valuegoeshere].jpg">
<a href="mysite.com/pages/[valuegoeshere].jpg"> 
```

页面上有这些下拉菜单的几个独特版本。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:23:40.977

在 上使用以下内容[`$(document).ready()`](http://api.jquery.com/ready/)：

```
function update(val) {
  $("img").attr("src", "mysite.com/images/" + val + ".jpg");
  $("a").attr("href", "mysite.com/pages/" + val + ".jpg");
}

var defaultVal = $("select").change(function () {
  update(this.value); // update <img> and <a> with the newly selected value
}).val();

update(defaultVal); // update <img> and <a> with the default value 
```

**[演示](http://jsfiddle.net/mVG2M/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:19:47.370

您可以通过像这样处理选择下拉列表的更改事件来获取选定的值

```
$('#yourselectid').change(function(){
currentSelectedValue=$(this).val();
alert(currentSelectedValue);
}) 
```

工作小提琴

[http://jsfiddle.net/yeZ3j/](http://jsfiddle.net/yeZ3j/)

更新的小提琴

[http://jsfiddle.net/yeZ3j/1/](http://jsfiddle.net/yeZ3j/1/)

**更新代码：**

```
$('select').change(function() {
    currentSelectedValue = $(this).val();
    $('img').attr('src', 'mysite.com/images/' + currentSelectedValue + '.jpg');
    $('a').attr('href', 'mysite.com/images/' + currentSelectedValue + '.jpg');

    $('body').append('<br>currentSource of img is :' + $('img').attr('src') + ' and anchor is: ' + $('a').attr('href'))
});
$(function() {
    $('select').trigger('change')
})​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:19:46.877

如果表单作为 GET 请求提交，那么这很容易。还记得给`name`选择一个属性。如果你想在服务器端进行并且`name`属性是“my_name”，那么 PHP 更改链接的值将如下所示：

```
$option = $_GET["my_name"];
$link_text = "<a href='mysite.com/pages/" . $option . ".jpg'>link</a>";
$img_text = "<img src='mysite.com/images/" . $option . ".jpg' />";
echo $img_text . "\n" . $link_text; 
```

# php - 从 SSH2 命令返回 PID

> ID：12230572
> 
> 赞同：0
> 
> 时间：2012-09-01T19:07:44.937
> 
> 标签：php, ssh, exec

我正在运行通过 SSH 启动游戏服务器的命令；

```
$stream = ssh2_exec($connection, 'java -Xmx256M -Xms32M -jar minecraft_server.jar nogui'); 
```

我想要做的是获取刚刚开始的那个进程的 PID。服务器是远程的，因此是 SSH2。

我需要 PID，以便我可以将其分配给停止按钮，因此当单击该按钮时，PID 将被终止。

我似乎找不到解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:16:46.633

正如一个[老问题](https://stackoverflow.com/a/4087436/1190388)所见：

> 不幸的是，此扩展自 2008 年以来未维护，仍处于 Beta 状态（0.11.0）。您可能想查看一些 SSH2 3rd 方库（其中一些是 LGPL 或 GPL）。

# c# - 带有简单 DLL 的 SEHException

> ID：12230573
> 
> 赞同：0
> 
> 时间：2012-09-01T19:07:57.767
> 
> 标签：c#, c++

我目前正在尝试在 C# 程序中为学校项目使用简单的 C++ DLL，但我无法使 DLL 和程序相互链接。当我尝试在主程序中调用 DLL 的函数时，我得到了一个从 DLL 抛出的 SEHExcpetion。

这是DLL代码

```
#include <stdio.h>
#include <string>

using namespace std;

extern "C"
{
    __declspec(dllexport) string Crypter(string sIn)
    {
        return sIn+ " from DLL";
    }
} 
```

这是C#代码

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        [DllImport("CryptoDLL2.dll")]
        public static extern string Crypter(string sIn);

        public Form1()
        {
            InitializeComponent();
        }

        private void BTN_Crypter_Click(object sender, EventArgs e)
        {
            TB_OUT.Text = ("");
            TB_OUT.Text = Crypter(TB_IN.Text); //exception thrown here
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:14:52.597

C# 和 C++ 中的字符串 - 它们是完全不同的类型、布局等。您希望它们能够工作。

使用编组检查 char*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:14:13.520

您不能使用 C# 中的 std::string，它是一个 c++ 类，.NET 不知道如何处理它。

尝试使用 wchar_t* 或 BSTR。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:22:28.820

我进行了测试以确保链接正常，这是一个示例应用程序，显示它确实有效。

```
#include <stdio.h>
#include <string>

using namespace std;

extern "C"
{
    __declspec(dllexport) string Crypter(string sIn)
    {
        printf("test");
        return "from DLL";
    }
} 
```

和

```
public class Test
{
    [DllImport("TestDll.dll")]
    public static extern string Crypter(string sIn);

    static void Main(string[] args)
    {
        Console.WriteLine(Crypter("a"));
    }
} 
```

这让我打印出来

```
test 
```

后跟一个换行符。

您可能需要将数据从 c++ 编组到 .net，或者使用 c++/clr 托管 dll，这会使您的工作更轻松。

# php - 使用连接的mysql不同查询

> ID：12230582
> 
> 赞同：3
> 
> 时间：2012-09-01T19:09:26.917
> 
> 标签：php, mysql, join, mapping

我有一个复杂的数据库关系（对我来说很复杂）。理论上，我认为这是一个很好的设计，但我现在的障碍是通过尽可能少的查询从中获取数据。这是我拥有的数据库结构：

**学生表：** *一些字段，如姓名、电话、电子邮件等。*

**student_requirements表（映射表）：** student_id、requirements_id、日期

**需求表（属于一个需求类型）：** id、requirement_type_id、name

**requirements_type 表（有很多要求）：** id、type、name、

好的，这是一个如何使用它的示例。我可以构建需求类型。一个例子就像一个任务。每个作业都有多个要求。学生可以传递特定作业的要求，但不一定传递所有作业的要求。所以我想按学生查询所有作业。假设系统中输入了 50 个作业，而 jon smith 输入了其中 4 个作业的要求。我想通过 jon smith id 查询以查找他已输入任何要求的所有作业。

我希望这是有道理的。我唯一的猜测是使用连接，但说实话，我真的不太了解它们。

任何帮助都是极好的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:16:39.290

尝试这个：

```
SELECT * FROM student_table, students_requirements_table,
requirements_table, requirement_type_table
WHERE student_table.name = "Jon Smith"
AND students_requirements_table.id = student_table.id
AND requirements_table.id = students_requirements_table.requirement_id
AND requirement_type_table.id = requirements_table.requirement_type_id; 
```

检查表名是否准确，因为我不得不假设几件事（例如您的某些表名中有下划线），并注意以上所有内容实际上应该是一条长线（但这使得它在此页面上不可读，因此我将其拆分为多行）。

目前我没有 LAMP 装备设置，所以我无法模拟它来测试它，而且我已经有一段时间没有编写 MySQL 连接了，但我认为这是在正确的轨道上。

如果您需要使用 LEFT JOIN，请查看此页面：[Left joins to link three or more tables](http://www.wellho.net/solutions/mysql-left-joins-to-link-three-or-more-tables.html)。

# perl - Perl 的 Encode::Detect::Detector 有多“昂贵”

> ID：12230583
> 
> 赞同：1
> 
> 时间：2012-09-01T19:09:32.557
> 
> 标签：perl, utf-8, decode, utf8-decode

我一直遇到来自不同编码的“gremlins”混入表单输入和来自 Perl 程序中的数据库的数据的问题。起初，我没有解码，智能引号和类似的东西会产生多个乱码；但是，盲目地将所有内容解码为 UTF-8 会导致较旧的 Windows-1252 内容充满问号。

因此，我使用 Encode::Detect::Detector 和 decode() 函数来检测和解码所有 POST 和 GET 输入，以及来自 SQL 数据库的数据（解码过程可能发生在每个文本字符串的 10-20 个字符串上）现在生成页面的时间）。这似乎清理了一切，因此 UTF-8、ASCII 和 Windows-1252 内容都正确显示为 UTF-8 输出（正如我在 HTML 标题中指定的那样）：

```
 my $encoding_name = Encode::Detect::Detector::detect($value);   
    eval { $value = decode($encoding_name, $value) }; 
```

我的问题是：这个过程的资源量有多大？我没有注意到减速，所以我认为我对它的工作方式感到满意，但如果有更有效的方法来做到这一点，我会很高兴听到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:30:15.880

答案是高度依赖于应用程序的，因此应计的“费用”的可接受性是您的电话。

量化开销的最佳方法是分析您的代码。你可能想[`Devel::NYTProf`](https://metacpan.org/module/Devel%3a%3aNYTProf)试一试。

[Tim Bunce 的`YAPC::EU`演示文稿](http://www.slideshare.net/Tim.Bunce/develnytprof-v4-at-yapceu-201008-4906467)提供了有关该模块的更多详细信息。

# php - 在 WordPress 小部件中集成图像上传框

> ID：12230586
> 
> 赞同：3
> 
> 时间：2012-09-01T19:10:49.903
> 
> 标签：php, jquery, wordpress

我正在开发一个小型 WordPress 小部件，我正在尝试将其设置在用户可以上传图像的位置。到目前为止，正在加载必要的脚本，但是当我单击“媒体库图像”按钮时，图像上传器不会弹出。

这是我的 javascript 文件：

```
jQuery(document).ready(function($) {

var formfield = null;

$('#upload_image_button').click(function() {
    $('html').addClass('Image');
    formfield = $('#wp-ss-image').attr('name');
    tb_show('', 'media-upload.php?type=image&TB_iframe=true');
    return false;
});

// user inserts file into post. only run custom if user started process using the above process
// window.send_to_editor(html) is how wp would normally handle the received data

window.original_send_to_editor = window.send_to_editor;
window.send_to_editor = function(html){
    var fileurl;

    if (formfield != null) {
        fileurl = $('img',html).attr('src');

        $('#wp-ss-image').val(fileurl);

        tb_remove();

        $('html').removeClass('Image');
        formfield = null;
    } else {
        window.original_send_to_editor(html);
    }
};

}); 
```

这是我调用脚本的函数：

```
add_action('admin_print_scripts-widgets.php', 'wp_ss_image_admin_scripts');

function wp_ss_image_admin_scripts() {
    wp_enqueue_script( 'wp-ss-image-upload', plugins_url( '/WP-Simple-Social/wp-simple-social-image.js' ), array( 'jquery','media-upload','thickbox' ) );
}

add_action('admin_print_styles-widgets.php', 'wp_ss_admin_styles');

function wp_ss_admin_styles() {
    wp_enqueue_style( 'thickbox' );
} 
```

这是显示输入框和图片上传按钮的html：

```
<p>Upload Photo: <input id="wp-ss-image" class="widefat" type="text" size="75" name="<?php echo $this->get_field_name( 'image' ); ?>" value="<?php echo esc_url( $image ); ?>" />
        <input id="upload_image_button" type="button" value="Media Library Image" class="button-secondary" /> 
```

由于所有必要的文件/脚本都在加载，这可能是一个 jQuery 问题吗？

如果有任何其他有助于帮助的其他信息，请告诉我。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T17:38:24.210

我发现最好的方法是使用 live() 方法，即使它不推荐使用 on() 利润。

### 工作过

```
jQuery(document).ready(function($) {
   $("#testage").live("click", function() {
       alert("CLICK!");
      });
}); 
```

### 没用

```
jQuery(document).ready(function($) {
      $("#testage").on("click", function() {
       alert("CLICK!");
      });
}); 
```

如果有人有解释，我将不胜感激。

# javascript - JQuery .load 和 html 问题

> ID：12230590
> 
> 赞同：0
> 
> 时间：2012-09-01T19:11:19.247
> 
> 标签：javascript

当您按下链接时，我正在尝试使用 Javascript 加载不同的页面。这是我用来更改页面的功能。

```
function loadPage(url){
    $(".body").fadeOut(400, function(){
        $(".body").load(url, function(){
            $(".body").fadeIn(400);
        });
    });
}; 
```

问题是，它会将内容淡入页面，但一旦淡入完成，它就会消失。文件中的代码 html 仍在主文件 html 中，只是没有显示出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:14:10.317

我有一个问题，我使用了这个。在您的情况下，文件将是 url：

```
var loader = function(file) {

   $('.body').fadeOut(500);

 $.ajax({ 
     url: file

     success: function(data) {

        $('.body').html(data);

$('.body').fadeIn(500);

  }

 });

  } 
```

更改了代码以尝试匹配您要执行的操作，仅使用带有背景的 div 对其进行了测试，并且似乎可以正常工作。

这和你有的一样吗？

安德鲁

# css - 将元素保留在窗口的可见部分内

> ID：12230591
> 
> 赞同：4
> 
> 时间：2012-09-01T19:11:19.383
> 
> 标签：css, css-float

我在屏幕可见部分的右侧放置了一个侧边栏元素（这部分已经工作了！）。侧边栏由几个 DIV 组成。其中一些我不关心，但是当用户向下滚动页面时，最后一个（最低的）不应该“消失”。这就是我卡住的地方。在某种程度上，顶部位置不应**小于**浏览器窗口可见顶部的 0。使用 CSS 和更好的浏览器是否也能做到这一点？

这是我对侧边栏的定义：

```
div#sidebar{font-size:95%; float: right;width: 150px; margin-top:20px;}
div#sidebar div{padding: 5px 0;margin-bottom: 5px} 
```

这是我想保留在屏幕可见部分内的元素：

```
div#navtop{background:#B3B3E3 url(/css/blue.jpg); margin-bottom:0px;}
div#navsoc{background:#B3B3E3 url(/css/blue.jpg); margin-bottom:0px; top:!important 0px;} 
```

第二个元素“navsoc”应保留在可见部分。但它的移动方式与“navtop”和我在那里定义的其他内容完全一样。

```
<div id="sidebar">
<div id="navsoc">
keep me inside the window!
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T19:59:16.847

我想你需要

```
position:fixed; 
```

所以元素将相对于窗口定位，所以如果你滚动它总是可见的。

演示：http: [//jsfiddle.net/mJubt/](http://jsfiddle.net/mJubt/)

此外，如果您想设置`!important`一个值，请使用`top:0!important`而不是`top:!important 0`.

当你有`0px`你不必写单位时，你可以使用 just `0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:50:45.980

如果你`top`在 CSS 中使用，你应该确保元素`position`不是`static`（默认）而是`absolute`，`relative`或者`fixed`. 所以，`top:0`在这种情况下是行不通的。如果您确实将位置更改为其中任何一个，它将以不同的方式表现：

如果它是固定的，则元素将是相对于窗口的位置，如果它是相对的或绝对的，它将是`zero pixels`从最近元素的顶部开始的`DOM`位置，位置不同于`static`.

如果上面元素的内容`#navsoc`有一个灵活的高度，你不能让它尊重它的位置，同时不能在滚动时移动。你需要 Javascript 来实现这一点。

第一部分有点跑题了，我觉得很高兴知道它！

在这里你有[小提琴](http://jsfiddle.net/dEXkK/1/)。

# php - 不能对我的一个实体使用 Doctrine PersistentCollection，另一个我可以

> ID：12230592
> 
> 赞同：19
> 
> 时间：2012-09-01T19:11:18.480
> 
> 标签：php, doctrine-orm

我有一对关联。它们是多对多的，我使用显式创建的实体来加入它们，这样我就可以获得有关关系的元数据。虽然它们是相同的，但一个有效，另一个无效。更糟糕的是，上周，它们都起作用了，从那以后我就再也没有碰过它们。在 MuSQL Workbench 中，我可以选择正确的数据。

当我将数据提取到一个数组中时，生活是美好的。当我尝试另一个时，我得到：

> 调用`setValue()`非对象的成员函数

当我尝试`count()`访问它、访问它（`$blah[0]`）或迭代它（`foreach`）时，我也会得到它。

当我执行时：

```
echo get_class($inData)."<BR>";
echo get_class($inData->accountPurchaseNodes)."<BR>";
echo get_class($inData->accountPurchaseNodes[0])."<BR>";
echo "<HR>";

echo get_class($inData)." x<BR>";
echo get_class($inData->purchaseOrderNodes)."<BR>";
echo get_class($inData->purchaseOrderNodes[0])."<BR>";
echo "<HR>";
exit; 
```

我得到：

```
GE\Entity\Purchase
Doctrine\ORM\PersistentCollection
GE\Entity\AccountPurchaseNode

GE\Entity\Purchase
Doctrine\ORM\PersistentCollection

( ! ) Fatal error: Call to a member function setValue() on a non-object in 
/Users/tqwhite/Documents/webdev/goodEarth/goodearth.com/library/
Doctrine/ORM/PersistentCollection.php on line 168 
```

下面，我包括实体定义的相关部分。我已经花了几个小时尝试这个和那个。我将非常感谢您的建议。

这个工作：

```
//==Purchase  Entity=====================================

 /**
 * @param \Doctrine\Common\Collections\Collection $property
 * @OneToMany(targetEntity="AccountPurchaseNode", mappedBy="account", cascade={"persist", "remove"});
 */
private $accountPurchaseNodes;

//in __construct()
$this->accountPurchaseNodes = new \Doctrine\Common\Collections\ArrayCollection();

//==AccountPurchaseNode  Entity=====================================

/**
 *
 * @ManyToOne(targetEntity="Purchase", cascade={"all"}, fetch="EAGER")
 * @JoinColumn(name="purchaseRefId", referencedColumnName="refId")
 *
 **/
private $purchase;

/**
 *
 * @ManyToOne(targetEntity="Account", cascade={"all"}, fetch="EAGER")
 * @JoinColumn(name="accountRefId", referencedColumnName="refId")
 *
 **/
private $account;

//==Account Entity=====================================

/**
 * @param \Doctrine\Common\Collections\Collection $property
 * @OneToMany(targetEntity="AccountPurchaseNode", mappedBy="purchase", cascade={"persist", "remove"});
 */
private $accountPurchaseNodes;

//in __construct()
$this->accountPurchaseNodes = new \Doctrine\Common\Collections\ArrayCollection(); 
```

这个不

```
//==Purchase =====================================

 /**
 * @param \Doctrine\Common\Collections\Collection $property
 * @OneToMany(targetEntity="PurchaseOrderNode", mappedBy="purchases", cascade={"persist", "remove"});
 */
private $purchaseOrderNodes;

//in __construct()
$this->purchaseOrderNodes = new \Doctrine\Common\Collections\ArrayCollection();

//==PurchaseOrderNode =====================================

/**
 *
 * @ManyToOne(targetEntity="Purchase", cascade={"all"}, fetch="EAGER")
 * @JoinColumn(name="purchaseRefId", referencedColumnName="refId")
 *
 **/
private $purchase;

/**
 *
 * @ManyToOne(targetEntity="Order", cascade={"all"}, fetch="EAGER")
 * @JoinColumn(name="orderRefId", referencedColumnName="refId")
 *
 **/
private $order;

//==Order =====================================

/**
 * @param \Doctrine\Common\Collections\Collection $property
 * @OneToMany(targetEntity="PurchaseOrderNode", mappedBy="order", cascade={"persist", "remove"});
 */
private $purchaseOrderNodes;

//in __construct()
$this->purchaseOrderNodes = new \Doctrine\Common\Collections\ArrayCollection(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-12-19T11:19:56.813

这是引用实体中的错误`purchases`。它说`mappedBy="purchases"`。应该是`purchase`。

请注意，这个错误的后果是不可能的。它产生了一个巨大的数据结构，几乎无法以任何有用的方式列出。触摸时会产生奇怪的结果。

这个问题的解决方法是mappedBy字段名不正确。它与目标实体中的实际名称不匹配（在这种情况下，`Purchase`实体中的错误将目标关联名称拼写错误`PurchaseOrderNodes`）。

由于复数表名的命名约定，它变得更加难以看到。当心那个拐点！

# php - 在sql中对搜索结果进行排序

> ID：12230601
> 
> 赞同：0
> 
> 时间：2012-09-01T19:12:49.877
> 
> 标签：php, sql

我想按相关性对搜索结果进行排序。我们有一个包含标题列和内容列的表格。当用户尝试搜索时，我们使用 Like 和 OR Like 在两个列中进行搜索。但是生成的搜索结果不是按相关性顺序排列的，因为我们希望优先考虑与标题匹配的结果。所以请如果有人能给出任何想法或提示在 php 和 sql 中做这件事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:16:33.813

你最好寻找 MySQL 的`FULLTEXT`搜索功能，它们比`LIKE`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T19:21:18.103

您可以使用自己的功能对结果进行排序。您必须为此创建一个函数。例；

```
function sortResults(results){
  .
  .
  .
} 
```

然后对其中的结果进行排序。

# c++ - 单击按钮后如何防止关闭QMessageBox

> ID：12230602
> 
> 赞同：6
> 
> 时间：2012-09-01T19:13:01.333
> 
> 标签：c++, qt

QMessageBox::addButton() 方法在 QMessageBox 上添加了 3 个按钮。如果单击按钮，是否可以防止关闭消息框？默认情况下，每个按钮都会关闭窗口，但我不想为一个按钮执行此操作。

编辑：为什么这被否决了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-04-10T04:57:43.433

一种对我有用的有趣方法是完全断开创建的目标按钮的信号，然后重新添加预期的功能。这不适用于所有人，特别是如果按钮不是以这种方式创建的和/或您仍想正确关闭对话框。（可能有一种方法可以将其添加回来和/或使用`QDialog::accept`,模拟`QDialog::reject`行为`QDialog::done`- 尚未尝试。）

例子：

```
QMessageBox *msgBox = new QMessageBox(this);
QAbstractButton *doNotCloseButton = msgBox->addButton(tr("This button will not close anything"), QMessageBox::ActionRole);
// Disconnect all events - this will prevent the button from closing the dialog
doNotCloseButton->disconnect();
connect(doNotCloseButton, &QAbstractButton::clicked, this, [=](){ doNotCloseButton->setText("See? Still open!"); }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T22:34:07.530

如果您可以获得指向`QMessageBox`小部件的指针，则可以尝试`QObject::eventFilter`在其上安装一个过滤`QEvent::Close`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T21:47:30.690

只是遇到了同样的问题，但我想添加一个复选框，即使`ButtonRole`设置为`QMessageBox::ActionRole`（也尝试过其他人），它也会在单击时关闭对话框。对于这种情况，我只是调用`blockSignals(true)`了`QCheckBox`它，现在它允许在不关闭对话框的情况下进行检查/取消检查行为。幸运的是`QCheckBox`，没有信号也能正常工作，但假设您希望按钮发出信号。

他们可能应该添加一个不会关闭对话框的新角色，因为为简单的自定义派生一个类很痛苦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T23:25:12.543

我查看了`addButton()`函数重载，但您使用此方法添加的按钮没有自定义行为。它们的行为类似于消息框上的标准按钮。

但是，如果您想创建一个完全可自定义的对话框，那么您最好的选择是扩展`QDialog`该类并在其上使用您喜欢的任何控件。

# c# - 表单关闭后定时器不触发

> ID：12230605
> 
> 赞同：0
> 
> 时间：2012-09-01T19:13:29.823
> 
> 标签：c#, .net, timer

我有一个`System.Windows.Forms.Timer`使用 VS 设计器声明的 .NET 表单。计时器工作正常。关闭表单后，即使我重新创建 Timer 对象，计时器也不会触发事件。我已将表单配置为永不关闭：

```
 void MainFormFormClosing(object sender, FormClosingEventArgs e)
    {
        // never close
        e.Cancel = true;

        // only hide
        this.Visible = false;

    } 
```

如何使计时器触发事件​​？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:21:38.410

我刚试过这个。在窗体上**添加**了**WinForms Timer 组件，****在加载时启动计时器**，在*调试窗口中***调试当前时间**。对我来说很好...

 *```
public frmTimer()
{
    InitializeComponent();
}
private void Form1_Load(object sender, EventArgs e)
{
    timer1.Start();
}
private void timer1_Tick(object sender, EventArgs e)
{
    Debug.WriteLine(DateTime.Now.ToLongTimeString());
}
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = true;
    this.Visible = false;
} 
```*

# android - 我如何让 git 推送我一个月前“repo sync”的存储库，该存储库已被删除到 github 上的新存储库以共享？

> ID：12230609
> 
> 赞同：0
> 
> 时间：2012-09-01T19:13:50.350
> 
> 标签：android, git, repository, android-manifest, push

我没有克隆这个存储库，我在`repo init -u http:// repository_name/manifest.git`3 个月前做过。作为初学者，我仍在学习不同的东西。我使用的存储库的用户已将其删除。我现在有一些东西要分享，但我不知道如何将它推送到 github。最肯定是我自己的新存储库，因此我不必担心再次丢失它以进行同步。我该怎么做呢？使用 git 似乎不会推送所有文件并将一些文件夹留空。之后，如果我这样做`$ git status`，我将在某些文件夹中收到 .git 的错误，这些文件夹我不再拥有存储库。我该如何做这一切？我想要一个可以完全提交并共享的新存储库。谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:22:01.127

在 github 上，创建一个新的 repo：见[https://github.com/new](https://github.com/new)

添加新的遥控器：`git remote add github git@github.com:<username>/<repo>`

然后：`git push github`

# ruby-on-rails-3 - rails 在第一次登录路径后设计

> ID：12230611
> 
> 赞同：0
> 
> 时间：2012-09-01T19:14:08.543
> 
> 标签：ruby-on-rails-3, devise

有没有办法让我们在注册后配置设计以转到特定页面？喜欢的东西`after_sign_up_path`。我希望用户在注册后首次登录时更新他们的个人资料，所以想将他们重定向到`edit_user_path(current_user)`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:33:07.487

不确定您是否已经知道
但是有一种`after_sign_up_path_for`方法可以现在覆盖
[https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L98](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L98)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:22:31.740

知道了。下面是我如何实现它。

```
scope = Devise::Mapping.find_scope!(user)
sign_in(scope, user, {})
redirect_to edit_user_path(current_user) 
```

# javascript - 有什么方法可以在循环中在 javascript 中休眠吗？

> ID：12230612
> 
> 赞同：4
> 
> 时间：2012-09-01T19:14:08.967
> 
> 标签：javascript, jquery

例如，有一个我想睡几秒钟的 for 循环。

```
$.each(para.res, function (index, item) {
    Sleep(100);
}); 
```

我知道我可以使用 setTimeout 或 setInterval 但它们都是异步的，循环将继续，如果我这样做，setTimeout 中的函数将在几秒钟内运行。

```
$.each(para.res, function (index, item) {
    setTimeOut(function(){do something},1000); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:25:20.263

您可以定义一个函数。

```
var i = 0;    
function recursive() {
  setTimeout(function(){
     var item = para.res[i];
     // do something
     i++;        
     if (i < para.res.length) recursive()
  }, 100)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:18:25.293

不，没有内置的方法。您可以使用繁忙的循环，但这会同时冻结浏览器，并且您不能这样做太久，因为浏览器将停止脚本。

如果您希望随着时间的推移分散不同的代码，只需为 设置不同的时间`setTimeout`：

```
$.each(para.res, function (index, item) {
  setTimeOut(function(){do something},1000 * index); 
}); 
```

这将在一秒钟后启动第一项的代码，两秒钟后启动第二项的代码，依此类推。

或使用`setInterval`：

```
var index = 0, timer = setInterval(function(){
  if (index < para.res.length) {
    var item = para.res[index];
    // do something
    index++;
  } else {
    clearInterval(timer);
  }
}, 1000); 
```

# iphone - 滚动 UITableView 时 EXE 错误访问 - iPhone

> ID：12230616
> 
> 赞同：1
> 
> 时间：2012-09-01T19:14:25.153
> 
> 标签：iphone, objective-c, xcode, uitableview

我有一个带有 9 个单元格的简单 UITableView。当我通过滚动上下移动表格时，我得到 EXE 错误访问。NSZombieMode 指向 cellForRowAtIndexMethod。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell =
[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                   reuseIdentifier:CellIdentifier];
}

cell.textLabel.text = [lineArray objectAtIndex:indexPath.row];
cell.accessoryType =  UITableViewCellAccessoryDisclosureIndicator;

return cell;
} 
```

谁能提出什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:41:27.707

如果 ARC 被禁用，则`autorelease`在创建时添加`cell`

```
cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                   reuseIdentifier:CellIdentifier] autorelease]; 
```

这可能是泄漏的原因。还要检查一下`lineArray`，因为它像 ivar 一样使用，并且可能这个数组在某个时候发布了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:46:41.837

我的猜测是您正在尝试访问`lineArray`超出范围的元素。

IE：`indexPath.row`当您的`lineArray`.

当您向下滚动时会发生这种情况，因为它会触发`cellForRowAtIndexPath`在更高数量的行上被调用（例如 indexPath.row > 3 的行）

我会再走一步，猜测您可能正在静态返回`numberOfRowsForSection`。

将其设置为`lineArray.count`应该修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T05:10:14.857

根据我的理解：-

1）在lineArray中你有大约9个项目，但在numberOfRowsInSection中你返回的rowCount比数组中的项目多，因此它崩溃并指向ceelForRowAtIndex。

2）这是供您理解的示例代码：-

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    lineArray = [[NSMutableArray alloc]initWithObjects:@"1",@"2",@"3",@"4",@"5", nil];
    tableView1 = [[UITableView alloc]init];
    tableView1.delegate = self;
    tableView1.dataSource = self;
    tableView1 .frame =self.view.frame;
    [self.view addSubview:tableView1];

}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
  return  [lineArray count];

    //return ;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell =
    [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                      reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = [lineArray objectAtIndex:indexPath.row];
    cell.accessoryType =  UITableViewCellAccessoryDisclosureIndicator;

    return cell;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

} 
```

# sqlite - 如何将多个列从一个表移动到一个新的一对多表？

> ID：12230619
> 
> 赞同：0
> 
> 时间：2012-09-01T19:14:36.090
> 
> 标签：sqlite, refactoring

我想通过将一个表分成两个来重构我的数据库。我想将一些现有的列移动到一个新表中。例如，假设我想将下表中的`home_address`和`work_address`字段移动`Employee`到新`Address`表中。

如何**使用 sqlite**完成此操作？

**前：**

```
Employee Table
   employee_id (Primary)
   name
   home_address
   home_city
   work_address
   work_city 
```

**后：**

```
Employee Table
   employee_id (Primary)
   name
   home_address_id
   work_address_id

Address Table
   address_id (Primary)
   address
   city 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:43:19.153

我更喜欢迁移简单明了，没有额外的逻辑等。至少当你只运行一次左右时。

因此，首先检查什么是 max(employee_id)，下面假设它小于 10000（并且它是整数）。

```
create table employee_new(employee_id,name,home_address_id,work_address_id);
insert into employee_new select employee_id,name,employee_id,employee_id+10000 from employee;
create table address(address_id,address,city);
insert into address select employee_id,home_address,home_city from employee; 
insert into address select employee_id+10000,work_address,work_city from employee; 
alter table employee rename to employee_old;
alter table employee_new rename to employee; 
```

# android - ACRA：报告崩溃时如何执行代码

> ID：12230623
> 
> 赞同：4
> 
> 时间：2012-09-01T19:14:56.140
> 
> 标签：android, acra

> **可能重复：**
> [带有 android 的 ACRA：如何在报告崩溃之前执行代码](https://stackoverflow.com/questions/10854031/acra-with-android-how-to-execute-code-before-crash-is-reported)

我正在使用 ACRA 进行崩溃报告。当发生崩溃时，ACRA 会报告。如何在报告崩溃之前执行代码？我想在崩溃发生时添加一些自定义变量，以便它与报告一起发送。有没有我可以覆盖的功能或类似的东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:21:42.383

ACRA 开箱即用地支持此功能，详见[此处](http://code.google.com/p/acra/wiki/AdvancedUsage#Adding_your_own_variables_content_or_traces_in_crash_reports)。基本上，您所要做的就是在您想要的地方为您想要的任何自定义数据添加以下行：

```
ErrorReporter.getInstance().putCustomData("myVariable", myVariable); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T07:30:24.900

如果要报告额外的变量，最简单的方法是在每次变量值更改时[使用 ErrorReporter 的 putCustomData 方法设置它们。](https://github.com/ACRA/acra/wiki/AdvancedUsage#adding-your-own-variables-content-or-traces-in-crash-reports)这样，如果发生崩溃，您将获得正确的值。

或者，您可以通过[实现自己的 sender](https://github.com/ACRA/acra/wiki/AdvancedUsage#implementing-your-own-sender)来执行代码。

# html - 没有水平滚动条不显示

> ID：12230626
> 
> 赞同：1
> 
> 时间：2012-09-01T19:15:23.383
> 
> 标签：html, css, scrollbar

刚刚建立了这个网站：[http ://www.aspenwebsites.co/](http://www.aspenwebsites.co/)

我仍在不同的浏览器中对其进行测试并修复细节。

站点的内容以 % 为单位设置，同时还设置了最大和最小宽度值。但是，当我将浏览器的窗口缩小到 CSS 中设置的最小宽度以下时 - 我希望看到水平滚动条，但即使我将“overflow-x:scroll”添加到 HTML 或 BODY 也不会显示。

提前感谢您花时间回答我的问题。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:54:29.980

这应该有效：

```
#contentWrap {
display: none;
margin-bottom: 20px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T06:21:41.313

删除样式，溢出：隐藏，它将起作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:47:06.853

`#contentWrap`在 style.css 的第 202 行有溢出：隐藏；财产

# java - Java：当被另一个线程中断时，如何在一个线程上捕获 InterruptedException？

> ID：12230629
> 
> 赞同：6
> 
> 时间：2012-09-01T19:15:49.557
> 
> 标签：java, multithreading, runnable

我正在开发一个多线程应用程序来建立与外部服务器的连接——每个服务器都在不同的线程上——并且在有输入之前将被阻塞。这些中的每一个都扩展了 Thread 类。为了便于解释，我们将这些称为“连接线程”。

所有这些连接线程都存储在并发哈希图中。

然后，我允许 RESTful Web 服务方法调用来取消任何线程。（我使用的是 Grizzly/Jersey，所以每个调用都是一个独立的线程。）

我检索特定的连接线程（从哈希图中）并在其上调用 interrupt() 方法。

那么，问题来了，在连接线程中，我如何捕获 InterruptedException？（当连接线程被外部 RESTful 命令停止时，我想做一些事情。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T19:28:46.760

> 那么，问题来了，在连接线程中，我如何捕获 InterruptedException？

你不能。因为如果您的线程在读取 I/O 操作时被阻塞，它就不可能`interrupted`。这是因为`interrupt`只是设置了一个标志来指示线程已被中断。但是，如果您的线程已被 I/O 阻塞，它将看不到该标志。
正确的方法是关闭底层套接字（线程被阻塞），然后捕获异常并将其传播。
因此，由于您的连接线程`extend Thread`执行以下操作：

```
@Override  
public void interrupt(){  
   try{  
      socket.close();  
   }  
   finally{  
     super.interrupt();  
   }  
} 
```

这样就可以中断在 I/O 上阻塞的线程。

然后在你的`run`方法中做：

```
@Override  
public void run(){  

    while(!Thread.currentThread().isInterrupted()){    
       //Do your work

    }  
} 
```

所以在你的情况下，不要`catch`尝试`InterruptedException`. 您不能中断在 I/O 上阻塞的线程。只需检查您的线程是否已被中断，并通过关闭流来促进中断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:24:29.307

阻塞的问题。

悬停者，试试这个代码，也许它会帮助你：

```
try{
 yourObject.read();
}catch(InterruptedException ie){
// interrupted by other thread
}
catch(Exception ex){
// io or some other exception happent
} 
```

你的读取方法，应该检查套接字是否有可用的buytes，例如，如果没有读取它，否则进入speel模式。当睡眠比可用时唤醒（InterruptedException）在pur套接字读取（无论您读取什么）它将被阻止。某些 API 具有最大等待值，例如 5 秒 60 秒，如果没有读取任何内容，它将在下一个代码执行。

```
class MyReadingObject
{
   public read() throws InterruptedException{
      while(shouldIread){
        if(socket.available() > 0){
           byte[] buff = new byte[socket.avaialble()]
           socket.read(buff);
           return;
        }
        else{
           Thread.currentThread.sleep(whateverMilliseconds);
        } 
     }
  }
} 
```

类似的东西，但有错误处理和一些设计模式

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T19:28:37.477

当您调用`Thread.interrupt()`某个线程时，会为该线程设置“中断”标志。有些方法会检查这个标志（通过`Thread.interrupted()`or `Thread.isInterrupted()`）和 throw `InterruptedException`，但通常只有可以阻止的方法才能做到这一点。所以不能保证`InterruptedException`会在被中断的线程中抛出。如果您不调用任何 throws 方法`InterruptedException`，则捕获该异常是没有意义的，因为它根本不会被抛出。但是，您始终可以通过调用来检查您的线程是否被中断`Thread.isInterrupted()`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T19:29:53.890

调用`interrupt()`线程不会*停止*它，它只是打开中断标志。代码负责处理所考虑的线程中断状态的变化并采取相应的行动。如果您在该线程中执行阻塞操作，那么您几乎就是 SOL，因为您的线程在读取时“阻塞”了。看看我在[这里](https://stackoverflow.com/questions/11816389/stopping-execution-of-java-thread-and-the-role-of-join/11816549#11816549)发布的答案。所以基本上，除非你*循环*一些东西或定期检查该线程中的一些标志，否则你无法在不关闭套接字或类似的东西的情况下突破。

这里的一种解决方案是“显式”公开底层连接对象并调用`close()`它，强制它抛出某种异常，然后可以在线程代码中进行处理。就像是：

```
class MyAction extends Thread implements Disposable {

  public void doStuff() {
    try {
      byte[] data = this.connection.readFully();
  } catch (InterruptedException e) {
    // possibly interrupted by forceful connection close    
  }

  @Override
  public void dispose() {
    this.connection.close();
  }
}

// Elsewhere in code
MyAction action = conMap.get("something");
action.dispose(); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-01T19:24:42.040

像这样使用 try-catch：

```
try {
    //code
} catch ( InterruptedException e) {
    //interrupted
} 
```

我认为这应该可以解决问题，您还可以保留一个布尔变量是否退出，这样他们就会检查该变量，如果是真的，停止

# ruby - 附加具有唯一值的收集数组

> ID：12230633
> 
> 赞同：7
> 
> 时间：2012-09-01T19:16:20.383
> 
> 标签：ruby, arrays, collect

所以我有一个由collect构建的数组。

```
@a = Relation.where(part: "v04")

@relations = @a.collect {|x| x.car} 
```

构建..

> => [“f0​​3”，“f04”]

```
@a = Relation.where(part: "v03")

@relations = @a.collect {|x| x.car} 
```

构建..

> => [“f0​​1”，“f03”]

我想要的是附加收集，以便我可以从 v03 和 v04 构建一个数组，使其看起来像这样。

> => [“f0​​3”，“f04”，“f01”，“f03”]

然后只保留唯一值，使其看起来像这样。

> => [“f0​​3”，“f04”，“f01”]

取出 f03，因为它被列出了两次。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-01T19:27:01.853

```
["f03", "f04"] | ["f01", "f03"] #=> ["f03", "f04", "f01"]

car1 = ["f03", "f04"]
car2 = ["f01", "f03"]

car1 | car2 #=> ["f03", "f04", "f01"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T19:38:01.363

```
@a = Relation.where(part: "v04")
@relations1 = @a.collect {|x| x.car}

@a = Relation.where(part: "v03")
@relations2 = @a.collect {|x| x.car}

@all_relations = @relations2 | @relations2 
```

如果您使用的是 Rails 3.2

```
parts = ['v03','v04']
@relations = Relation.where(part: parts).pluck(:name).uniq 
```

在rails 3中，我认为这应该可行

```
@relations  = Relation.where(part: parts).collect(&:name).uniq 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T19:58:51.073

这是执行此操作的最佳方法：`Relation.where(part: ['v03', 'v04']).uniq.pluck(:car)`

这是一个完整的例子：

```
require 'active_record'

ActiveRecord::Base.establish_connection adapter: 'sqlite3', database: ':memory:'

ActiveRecord::Schema.define do
  self.verbose = false
  create_table :relations do |t|
    t.string :part
    t.string :car
  end  
end

Relation = Class.new ActiveRecord::Base

# build the relations (btw, this name makes no sense)
Relation.create! car: 'f01', part: 'v03'
Relation.create! car: 'f03', part: 'v03'
Relation.create! car: 'f03', part: 'v04'
Relation.create! car: 'f04', part: 'v04'

# querying
Relation.where(part: "v04").pluck(:car) # => ["f03", "f04"]
Relation.where(part: "v03").pluck(:car) # => ["f01", "f03"]
Relation.where(part: ['v03', 'v04']).uniq.pluck(:car) # => ["f01", "f03", "f04"] 
```

一些想法：

除非您希望它们成为实例变量，否则不要将连字符放在变量前面（例如`@a`，显然应该是`a`- 即便如此，更好的名称也会很好。我可能会完全摆脱它，如上所示）。

使用 pluck 比使用 map 更好，因为 pluck 只选择相关数据：`SELECT car FROM "relations" WHERE "relations"."part" = 'v04'`vs `SELECT "relations".* FROM "relations" WHERE "relations"."part" = 'v04'`

最好`.uniq`在 ActiveRecord::Relation 上使用，因为它将唯一性移动到数据库中，而不是尝试使用 Ruby 在内存中进行：`SELECT DISTINCT car FROM "relations" WHERE "relations"."part" IN ('v03', 'v04')`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-01T19:34:48.837

为什么不将`where`调用合二为一呢？

```
cars = Relation.where(part: ['v03', 'v04']).map(&:car).uniq 
```

或者可能

```
car_ids = Relation.where(part: ['v03', 'v04']).select('DISTINCT car_id').map(&:car_id)
cars = Car.where(id: car_ids) 
```

第一个在 Ruby 中做更多的工作，第二个在 SQL 中做更多的工作。

# php - 将相同的 PHP 源分配给不同的选择元素

> ID：12230637
> 
> 赞同：0
> 
> 时间：2012-09-01T19:16:51.917
> 
> 标签：php, mysql

我正在尝试使用 mysql 选择查询的结果填充两个选择框。我运行一次查询并使用输出变量循环并相应地设置选择标签的选项。问题是，第一个选择框按预期填充，但第二个没有。它仍然是空的。这是我的代码

```
 <?php

    $con = mysql_connect('localhost','root','') or die('Could Not Connect'.mysql_error());
    mysql_select_db('irctc', $con)or die('Could Not Select'.mysql_error());;
    $result = mysql_query("select * from stationcodes", $con)or die('Could not select'.mysql_error());
    ?>
    <html>
    <head>
    </head>
    <body>
        <table>
            <tr>
                <td>Source</td>
                <td>:-</td>
                <td><select id='src'>
                    <option value=''>Select Source Station</option>
                    <?php  while($row = mysql_fetch_array($result))
                    { ?>
                        <option value='<?php echo $row['StationCode']; ?>'><?php echo $row['StationName']; ?></option>
                    <?php } ?>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Destination</td>
                <td>:-</td>
                <td><select id='dst'>
                    <option value=''>Select Destination Station</option>
                    <?php  while($row = mysql_fetch_array($result))
                    { ?>
                        <option value='<?php echo $row['StationCode']; ?>'><?php echo $row['StationName']; ?></option>
                    <?php } ?>
                    </select>
                </td>
            </tr>
        </table>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:20:10.183

您需要在呈现第二个选择框之前重新运行查询，或者首先将其结果缓存在数组中。使用 mysql_fetch_* 后，它已被读取，您需要倒回光标或重新开始/

此外，远离 mysql_* 并改用 PDO 或 mysqli。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:20:58.890

在再次开始迭代结果之前，您需要将数据指针“倒回”回到开头。在构建您的“目的地”之前使用`mysql_data_seek(0);`这样做：

```
 <td><select id='dst'>
                <option value=''>Select Destination Station</option>
                <?php  mysql_data_seek(0);         // reset data pointer to 1st row
                       while($row = mysql_fetch_array($result))
                { ?>
                    <option value='<?php echo $row['StationCode']; ?>'><?php echo $row['StationName']; ?></option>
                <?php } ?>
                </select>
            </td> 
```

也不要使用`mysql_`。切换到`mysqli_`或`PDO`。它将帮助**您**将代码与视图分离并使用任何类型的模板引擎（如`Smarty`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:39:42.700

将您的数据库结果存储在一个数组中，以便您可以多次使用它：

```
$records = array();
while ($row = mysql_fetch_array($result)) $records[] = $row; 
```

为了避免多次编写相同的算法，请定义一个您调用的函数，例如：

```
function select($attrs, $options, $selected=null) {
    $ret = '<select';
    if (is_array($attrs)) {
        foreach ($attrs as $name => $val) {
            $ret .= ' '.htmlspecialchars($name).'="'.htmlspecialchars($value);
        }
    }
    $ret .= '>';
    foreach ($options as $option) {
        $ret .= '<option';
        if (isset($option['value'])) {
            $ret .= ' value="'.htmlspecialchars($option['value']).'"';
            if ($selected === $option['value']) {
                $ret .= ' selected="selected"';
            }
        }
        $ret .= '>';
        if (isset($option['label'])) {
            $ret .= htmlspecialchars($option['label']);
        }
        $ret .= '</option>';
    }
    $ret .= '</select>';
    return $ret;
} 
```

然后你需要做的就是用不同的参数调用这个函数：

```
$options = array();
while ($row = mysql_fetch_array($result)) {
    $options[] = array(
        'value' => $row['StationCode'],
        'label' => $row['StationName']
    }
}

$srcOptions = array_merge(array(array('label'=>'Select Source Station')), $options);
echo select(array('id'=>'src'), $srcOptions);

$dstOptions = array_merge(array(array('label'=>'Select Destination Station')), $options);
echo select(array('id'=>'dst'), $dstOptions); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T19:22:17.563

当您到达第二个选择框时，所有记录都已获取，因此那里不会发生任何事情。

您应该做的是在开始 html 代码之前将所有记录提取到数组中。

然后在 html 代码中使用 foreach 语句循环遍历数组。

# go - “net/http”在 golang 中使用全局变量是否被认为是一种好习惯？

> ID：12230643
> 
> 赞同：17
> 
> 时间：2012-09-01T19:17:48.917
> 
> 标签：go

golang 包“net/http”使用全局变量 DefaultServeMux 来注册处理程序。这是否被认为是一种好的做法，甚至是一个 golang 成语？毕竟它是一个全局变量吗？

不使用全局变量的两个主要原因是 AFAIK 1）它们增加了复杂性和 2）在并发程序中存在问题。

也许 1) 在这种情况下被认为不重要，因为开发人员可以选择不使用 DefaultServerMux？2）呢？全局变量在 Go 中总是线程/goroutine 安全吗？不过，我很惊讶 Go 的标准库中使用了它。我从未在其他语言/标准库中看到过这种做法。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-09T00:46:29.000

> 毕竟它是一个全局变量吗？

是的。该变量是在根级别[定义](http://golang.org/src/pkg/net/http/server.go?s=27804:27891#L852)的，这使得它在整个包中都是全局的。

但是，这不是一个全局变量，它存储了`net/http`包的所有敏感信息。它只是一种方便的设置，它使用`net/http`包的内容为用户提供快速入门的机会。这也意味着，这不会增加太多复杂性。

> 这是否被认为是一种好的做法，甚至是一个 golang 成语？

IMO，帮助用户使用包是一种很好的做法。如果您发现通过提供良好的默认配置可以为用户节省一些时间，请这样做。

但是，当您要导出变量时应该小心。它们应该准备好进行并发访问。例如， `DefaultServeMux`（或者更好的是，底层`ServeMux`）[使用互斥锁](http://golang.org/src/pkg/net/http/server.go?s=27804:27891#L931)来保证线程安全。

> 全局变量在 Go 中总是线程/goroutine 安全吗？

不。如果没有适当的同步（互斥锁、通道等），并发访问的所有内容都会出现问题，并且肯定会将所有内容都炸成碎片。

> 我从未在其他语言/标准库中看到过这种做法。

例如， Python 的`logging`模块提供了一个函数来检索根日志记录对象，可以调用该对象的方法来自定义日志记录行为。这可以看作是一个全局对象，因为它是可变的并且在模块中定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:46:17.017

在这种情况下，globvar 与例如包“log”中看到的类似物一样安全和不错的选择。

IOW，权利要求 1 尽可能模糊，权利要求 2 受到限制：有时/在某处为真，否则即使这样使用，错误 == 通常也不成立。

# android - 使用服务与 MediaPlayer 和 SoundPool

> ID：12230644
> 
> 赞同：1
> 
> 时间：2012-09-01T19:18:02.717
> 
> 标签：android, android-service, android-mediaplayer

所以我和我的朋友们正在尝试制作一款带有音效和背景音乐的游戏。我们中的一个人使用服务实现了背景音乐，但它真的很不稳定，有时会导致应用程序崩溃。

我想知道使用服务有什么好处？

另外，我想知道我们是否可以只使用 MediaPlayer 播放背景音乐和 SoundPool 播放音效？..还是那种糟糕的风格或效率低下？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T20:00:15.773

> 我想知道使用服务有什么好处？

当您希望应用程序继续运行声音（即使它不在前台）时，使用[服务来控制声音很有用。](http://developer.android.com/reference/android/app/Service.html)一个很好的例子是音乐应用程序。例如，当用户点击 Home 按钮时，让音乐继续播放是合理的。

现在，关于您的第二个问题，是的，您应该使用[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)作为游戏音乐，使用[SoundPool](http://developer.android.com/reference/android/media/SoundPool.html)作为效果。*但是，如果*您发现性能问题，您还应该考虑将它们放在单独的线程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:23:54.080

最适合我的（我认为通常被接受）是使用 MediaPlayer 播放音乐，使用 SoundPool 播放音效。

我相信你应该尽量避免使用服务来播放音乐或声音（因为服务背后的想法是它应该在后台运行）。然而，如果您不想在 UI 线程中播放任何声音，您可以创建一个额外的线程。我个人从主线程调用我所有的声音，它似乎工作得很好。

我希望这有帮助。

# android - ListView 和 Checkbox - 没有像教程中那样勾选复选框

> ID：12230645
> 
> 赞同：0
> 
> 时间：2012-09-01T19:18:22.070
> 
> 标签：android, cursor, simplecursoradapter

在过去的几个小时里，我一直在阅读教程和论坛帖子，以尝试实现一个简单的复选框列表视图。

我了解（我相信）我需要如何维护列表中复选框的状态（在我的情况下为地图）。

我确信这是一件非常简单的事情，但我的复选框没有在我的 bindView 方法中设置为 true 或 false。这是代码

```
public void bindView(View view, Context context, Cursor cursor) {
        final int rowId = cursor.getInt(cursor.getColumnIndexOrThrow("_id"));

        familyText = (TextView)view.findViewById(R.id.contacts_row_family_name);
        markedBox = (CheckBox)view.findViewById(R.id.contacts_row_check);
        familyText.setText(cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME)));

        view.setOnClickListener(new OnClickListener(){

            public void onClick(View arg0) {
                Log.d("OnClick","Row clicked");
                boolean currentlyChecked;

                if(checkedState.size() >= rowId){
                    currentlyChecked = checkedState.get(rowId);
                    checkedState.put(rowId, !currentlyChecked);
                }else{
                    currentlyChecked = false;
                    checkedState.put(rowId, !currentlyChecked);
                }

                markedBox.setChecked(checkedState.get(rowId));

            }

        });

        setProgressBarIndeterminateVisibility(false);

    } 
```

这是checkedState的声明。这是我的活动的班级成员。

```
private Map<Integer, Boolean> checkedState = new HashMap<Integer,Boolean>(); 
```

据我所知，我应该在行上有一个侦听器（这是因为我的日志消息打印正确），但复选框没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:05:37.387

更新：

我的复选框没有被选中是不正确的。只是检查错了。我将关闭这个问题。

# recursion - 递归反转一个链表（斯坦福 CSed 库中的代码）解释

> ID：12230648
> 
> 赞同：2
> 
> 时间：2012-09-01T19:18:39.603
> 
> 标签：recursion, linked-list, reverse

我的递归技巧很生疏。我一直在思考这个问题，在论坛上搜索了很长时间，但仍然无法理解。现在我正在查看来自斯坦福 CS ed 库的递归反转链表代码。

```
#include <stdio.h> 

struct Node {
  int x;
  struct Node *next;
};

void Reverse(struct Node ** headRef){
    struct Node* first;
    struct Node* rest;

    if(*headRef==NULL)
       return;

    first= *headRef;
    rest= first->next;  

    if(rest==NULL)
        return; 

    Reverse(&rest);
    printf("Rest%d\n", (rest)->x); // I added this line to print rest
    first->next->next=first;
    first->next=NULL;
    *headRef=rest;
}

void printList(struct Node* head){

    if(!head)
       return;
    else{
       printf("%d ", head->x);
       printList(head->next);   
    }
}

void main(){
    struct Node *head;
    struct Node * node1= (struct Node*) malloc(sizeof(struct Node));
    struct Node * node2= (struct Node*) malloc(sizeof(struct Node));
    struct Node * node3= (struct Node*) malloc(sizeof(struct Node));
    struct Node * node4= (struct Node*) malloc(sizeof(struct Node));
    head= node1;
    node1->next=node2;
    node1->x=1;
    node2->x=2;
    node3->x=3;
    node4->x=4;
    node2->next=node3;
    node3->next=node4;
    node4->next=NULL;
    Reverse(&head);
} 
```

现在假设我有一个链表 1->2->3->4。我无法理解的是最后一行，它最终会将 headRef 设置为 4，我认为它应该将 headRef 设置为 2。我尝试执行该函数并打印出：

> 4
> 4
> 4

为变量休息。

但是，如果我将 Reverse 函数中的最后一行注释掉，它仍然会反转列表但会打印

> 4
> 3
> 2。

第二个结果我可以理解，但第一个结果似乎很混乱。语句“*headRef=rest”对变量 rest 有什么作用吗？它一直指向4是什么？

另外，如果我通过 *headRef 而不是 **headRef （最后一行没有注释掉），它会打印结果

> 4
> 3
> 2

也。

谁能给我解释一下记忆中发生了什么？太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:05:17.243

在递归调用之前，`Reverse`我们有：

```
first---|  
        |  
        v  
        1->2->3->4->NULL
           ^
           |
           |
  rest------ 
```

在递归调用之后，`Reverse`我们有：

```
first---|
        |
        v
        1->2<-3<-4
           |     ^
           v     |
         NULL    |
  rest------------ 
```

现在我们需要修复`2->NULL`到`2->1`by `first->next->next=first`。

```
first---|
        |
        v
        1<-2<-3<-4
        |  ^     ^
        |--|     |
                 |
  rest------------ 
```

现在我们需要修复`1->2`到`1->NULL`by `first->next=NULL`。

```
first---|
        |
        v
  NULL<-1<-2<-3<-4
                 ^
                 |
                 |
  rest------------ 
```

最后 `*headRef=rest`，这`*headRef`将指向`4`而不是指向`1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-22T20:51:17.610

这里发生的情况是因为递归调用将***rest 的地址传递给局部变量 headRef***，当每个递归调用返回时，语句 *headRef=rest 已经更改了执行流程中下一个语句的 rest 指针的地址。

对于链表 1->2->3->4 ：

假设 1 存储在地址 100 中，2 存储在地址 200 中，3 存储在地址 300 中，4 存储在地址 400 中。

***第 1 部分：*** 调用 Reverse(&rest) [rest 指向地址 400]

第一个 = 400 休息 = NULL

由于 rest 为 NULL，因此执行返回到 Reverse(400) 调用后的点

***第 2 部分：*** 执行 first->next->next=first 和 first->next=NULL 后，这里 first = 300 和 rest = 400

我们有 *headRef=rest [rest 指向 400]

但是这个headRef被传递了一个rest = 300的地址。所以现在已经为下一步执行，休息点为 400。

***第 3 部分：*** 现在执行返回到 Reverse(300) 调用后的点

但是在前向呼叫期间 [first 是 200，其余是 300] 和返回期间 [rest = 400]。**这是诀窍！**

在执行 first->next->next=first 和 first->next=NULL 之后

我们有 *headRef=rest [rest 指向 400]

但是这个headRef被传递了一个rest = 200的地址。所以现在已经为下一步执行，休息点为 400。

***第 4 部分：*** 现在执行返回到 Reverse(200) 调用后的点

但是在前向呼叫期间 [first 是 100，其余是 200] 和返回期间 [rest = 400]。

在执行 first->next->next=first 和 first->next=NULL 之后

我们有 *headRef=rest [rest 指向 400]

因为这是初始调用，所以函数返回 *headRef 具有 400 值。

**任务完成！**

# oracle - 以 table.column 格式返回 Oracle 列名？

> ID：12230650
> 
> 赞同：6
> 
> 时间：2012-09-01T19:18:54.490
> 
> 标签：oracle

有什么设置或方法可以让 Oracle 以`<table>.<column>`格式返回结果吗？例如：

询问：

```
SELECT     *
FROM       foo f
INNER JOIN bar b
ON         b.foo_id = f.id 
```

期望的结果：

```
F.ID  F.BLAH  B.ID  B.FOO_ID  B.BLAH
--------------------------------------------------------
1     blah    7     1         blah
2     blah    8     2         blah
3     blah    9     2         blah 
```

显而易见的解决方案是为每一列单独设置别名`SELECT f.id AS F_ID, ...`；但是，我需要导出一些非常大的遗留表（300 多列），因此使用这种方法会导致查询变得庞大且不切实际。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T09:43:33.483

Oracle 中没有这样做的“选项”；您*也许*可以找到允许您这样做的客户，因为这是通常在客户中完成的工作；我不知道一个。

要扩展[tbone 的答案](https://stackoverflow.com/a/12230772/458741)，您将不得不动态地执行此操作。这*并不*意味着您必须列出每一列。您将使用[数据字典](http://docs.oracle.com/cd/E11882_01/server.112/e25789/datadict.htm#CNCPT2140)，特别是[all_tab_columns](http://docs.oracle.com/cd/E11882_01/server.112/e25513/statviews_2103.htm#REFRN20277)或`user_tab_columns`创建您的查询。使用您想要的确切定义创建视图会更容易，以便您可以根据需要重新使用它。

目的是利用存在的列作为字符串存储在表中这一事实，以便创建查询以使用该列。由于列名和表名存储为字符串，您可以使用字符串聚合技术轻松创建查询或 DDL 语句，然后您可以手动或动态执行这些语句。

如果您使用的是 Oracle 11g 第 2 版，该[`listagg`](http://docs.oracle.com/cd/E11882_01/server.112/e25554/analysis.htm#DWHSG8702)功能可以帮助您：

```
select 'create or replace view my_view as 
        select '
      || listagg( table_name || '.' || column_name 
               || ' as ' 
               || substr(table_name,1,1) || '_' 
               || column_name, ', ')
        within group 
         ( order by case when table_name = 'FOO' then 0 else 1 end
                  , column_id
          )
       || ' from foo f
            join bar b
              on f.id = b.foo_id'
  from user_tab_columns
 where table_name in ('FOO','BAR')
        ; 
```

假设这个表结构：

```
create table foo ( id number, a number, b number, c number);
create table bar ( foo_id number, a number, b number, c number); 
```

此单个查询产生以下结果：

```
create or replace view my_view as 
 select FOO.ID as F_ID, FOO.A as F_A, FOO.B as F_B, FOO.C as F_C
      , BAR.FOO_ID as B_FOO_ID, BAR.A as B_A, BAR.B as B_B, BAR.C as B_C 
   from foo f 
   join bar b on f.id = b.foo_id 
```

这是一个[SQL Fiddle](http://www.sqlfiddle.com/#!4/362b3/3)来证明它。

在您不使用 11.2 时，您可以使用由 Tom Kyte 创建的未记录函数[`wm_concat`](http://psoug.org/definition/WM_CONCAT.htm)或用户定义函数获得完全相同的结果。[`stragg`](http://www.oracle.com/splash/collabsuite/maintenance/index.html)Oracle Base 有一篇关于[字符串聚合技术](http://www.oracle-base.com/articles/misc/string-aggregation-techniques.php)的文章，并且有很多关于 Stack Overflow 的帖子。

作为一个小附录，您实际上可以通过对上述查询进行小的更改来创建您正在寻找的内容。您可以使用带[引号的标识符](http://docs.oracle.com/cd/E11882_01/server.112/e10592/sql_elements008.htm)来创建`TABLE_NAME.COLUMN_NAME`格式中的列。您*必须*引用它，因为`.`它不是 Oracle 中对象名称的有效字符。这样做的好处是你得到你想要的。缺点是如果你不使用`select * from ...`;查询创建的视图是一个巨大的痛苦。选择命名列将*要求*它们被引用。

```
select 'create or replace view my_view as
        select '
      || listagg( table_name || '.' || column_name 
               || ' as ' 
               || '"' || table_name || '.'
               || column_name || '"', ', ')
        within group 
         ( order by case when table_name = 'FOO' then 0 else 1 end
                  , column_id
          )
       || ' from foo f
            join bar b
              on f.id = b.foo_id'
  from user_tab_columns
 where table_name in ('FOO','BAR')
        ; 
```

[此查询返回](http://www.sqlfiddle.com/#!4/362b3/5)：

```
create or replace view my_view as 
 select FOO.ID as "FOO.ID", FOO.A as "FOO.A", FOO.B as "FOO.B", FOO.C as "FOO.C"
      , BAR.FOO_ID as "BAR.FOO_ID", BAR.A as "BAR.A"
      , BAR.B as "BAR.B", BAR.C as "BAR.C"
   from foo f 
   join bar b on f.id = b.foo_id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T19:34:58.267

使用别名不会使查询变得不切实际，它只是不如键入 * 方便。使用动态 SQL 为您生成列：

```
select 'f.' || column_name || ' as F_' || column_name || ','
from all_tab_columns
where table_name = 'FOO'
order by column_id; 
```

对您需要的任何其他宽表执行相同操作，然后复制/粘贴到您的查询中。还要注意 30 个字符的限制，希望您的列的大小都不超过 28。

# unix - 为什么在 grep 列表时需要使用“-P”？

> ID：12230652
> 
> 赞同：0
> 
> 时间：2012-09-01T19:19:06.203
> 
> 标签：unix, grep

我正在使用 -P 选项来 grep 电话号码列表。使用此选项我的结果非常好，但没有它就不会返回列表。[grep 手册页](http://ss64.com/bash/grep.html)说使用 -P将“将 PATTERN 解释为 Perl 正则表达式”。由于我不了解 Perl，并且正在学习 grep 和 regex，所以这对我来说意义不大。

有简单的解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:18:12.373

可以使用 3 组正则表达式`grep`：

*   [BRE](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html#tag_09_03) — 基本正则表达式
*   [ERE](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html#tab_09_04) — 扩展正则表达式
*   [PCRE](http://www.pcre.org/) — [Perl](http://perldoc.perl.org/perlre.html)兼容的正则表达式

所有这些之间的一些概念是相同的。例如，诸如`[a-z]`或`[^0-9]`之类的字符类在所有这些中都是相同的。另一方面，`(`vs的含义，或者`\(`是否具有特殊意义，取决于正则表达式的类别。`|``+``|`

这是一个很大的话题；太大而无法在 SO 答案中轻松涵盖。要了解更多信息，请查看 Jeff Freidl 的[Mastering Regular Expressions](http://regex.info/)一书，以及有关正则表达式差异集的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:25:17.220

如果没有该`-P`选项`grep`，则将模式解释为基本的正则表达式，并且它们之间存在很大差异，例如元字符，如`.`,`?`或`|`. 您将不得不调整您的正则表达式。

# html - HTML 5：从网站访问本地文件系统 mp3

> ID：12230655
> 
> 赞同：0
> 
> 时间：2012-09-01T19:19:35.670
> 
> 标签：html, google-chrome-extension, npapi

通常，Web 浏览器不允许网站访问用户的本地文件。我遇到了[locallinks](https://chrome.google.com/webstore/detail/jllpkdkcdjndhggodimiphkghogcpida/related)插件，它允许从网页访问 file:/// ，但是这样的文件在不同的选项卡中打开。

我想创建一个播放器，它已经具有有关客户端计算机上文件位置的信息，并会在单击时播放媒体文件。我编写了类似这样的代码

```
<audio controls="" id="player">
<source src="file:///home/vihaan/Music/001) Led Zeppelin - Stairway to Heaven.mp3" type="audio/mp3"/>
Your browser does not support html 5 audio
</audio> 
```

我曾假设安装该插件会使这项工作！我也听说过 NPAPI 插件。是否有可能创建一个插件，在网页加载后允许将文件读入网页，即从用户计算机播放音乐，而用户实际上每次都必须选择文件夹。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T02:43:06.120

使用 NPAPI 插件绝对可以做到这一点；这很可能是一个非常非常糟糕的主意。

浏览器有这些安全限制是有原因的；如果您允许您的网页读取用户计算机上的任意数据，那么突然之间任何其他网站都可以使用您的相同插件来做同样的事情；他们可能不仅仅是在阅读音乐。最低限度，您需要对其进行一些非常谨慎的限制，即使那样，您也可能会打开一个您无意中不知道的安全漏洞。您不想被称为允许下一个僵尸网络接管的插件的创建者。

# node.js - 我如何控制 node.js 和 express 3.0 服务器上的文件上传

> ID：12230656
> 
> 赞同：2
> 
> 时间：2012-09-01T19:19:45.020
> 
> 标签：node.js, file-upload, express

正如您在此处看到的： [https](https://github.com/visionmedia/express/blob/master/examples/multipart/index.js) ://github.com/visionmedia/express/blob/master/examples/multipart/index.js Express 默认支持文件上传，并将每个上传的文件存储在临时文件夹中以备后用。

我的问题是：**它安全吗？**

正如我所看到的，攻击者可以用垃圾文件填充所有临时文件夹，而对其没有任何控制。我应该检查每个 POST 请求并删除任何未使用的文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T21:26:16.170

让我为您的问题提出两种解决方案。

1.  使用虚拟驱动器作为上传位置。如果您的服务器在 linux 上运行，则很容易挂载仅在内存中的虚拟文件系统。这些文件将比在真正的硬盘驱动器上更快地放置在此处，并且如果您遇到与您描述的问题类似的问题，只需清理虚拟驱动器或重新启动服务器即可。[查看这篇文章以了解 ram 磁盘的说明](http://www.cyberciti.biz/tips/what-is-devshm-and-its-practical-usage.html)。
2.  确保您在 24 小时内仅接受来自同一 IP 地址的最多 x 次上传。将此解决方案与解决方案 1 结合使用以获得最大效果。实现这一点的一种方法是为每个 IP 地址创建一个包含上传计数的全局对象，然后每 24 小时将其清除一次。

    ```
    var uploads = {}
    setInterval(function(){
     uploads = {}
    }, 24*60*60*1000); //Run every 24 hours

    var onUpload = function(request, file){
      if(uploads[req.ip] > maxUploadsAllowedPrUser)
        fs.unlink(file) //Delete the file
      else
        uploads[req.ip]++ //Keep the file, and increase count
    } 
    ```

# xml - 客户端机器中的文件索引

> ID：12230659
> 
> 赞同：0
> 
> 时间：2012-09-01T19:19:57.790
> 
> 标签：xml, database, indexing

有许多网络文件，分布在许多服务器上。

在客户端/本地计算机、XML 或常规数据库上索引这些文件的更好方法是什么？哪个管理起来更容易、更有效？

仅考虑要索引的文件名、文件长度、父服务器等属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T01:06:39.727

这取决于您将如何查询它们、如何更新它们、它们多久更改一次……以及项目之间的关系。

乍一看，最有可能的答案实际上是动态散列数据库，例如 ndbm 或 BSD db。但这也取决于您将如何连接到索引 - 从 C 程序。从 GUI，从 Linux 命令行，什么？

# python - 在数据结构中分组值

> ID：12230660
> 
> 赞同：-1
> 
> 时间：2012-09-01T19:20:08.757
> 
> 标签：python, django

我对 Django / Python 的世界很陌生。

我在经理中有以下查询：

```
listOfHeroes = self.all().values('user__user__username','skill','level') 
```

它返回一个像这样的表：

```
[{'user__user__username': u'Aragorn', 'skill': 'Fireball', 'level': 5}, {'user__user__username': u'Leonidas', 'skill': 'sword', 'level': 1},{'user__user__username': u'Aragorn', 'skill': 'sword', 'level': 4},....] 
```

我想按英雄对我的数据进行分组。我的意思是阿拉贡有两个技能火球和剑：

```
User: Aragorn / Skills: { sword level 4 / fireball level 5} 
```

我拥有的按用户分组技能的最终数据必须易于迭代。

如果您有任何想法...我尝试创建字典，但失败了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:27:57.400

如果您不想更改数据库查询，请使用以下命令：

```
result = {}
for item in listOfHeroes:
    if item['user__user__username'] not in result:
        result[item['user__user__username']] = []
    result[item['user__user__username']].append({'skill': item['skill'], 'level': item['level']})

for key, value in result.items():
    print 'User: {0} / Skills: {{ {1} }}'.format(key, ' / '.join(['{0} level {1}'.format(skill['skill'], skill['level']) for skill in value])) 
```

# html - 从链接直接下载图片

> ID：12230663
> 
> 赞同：0
> 
> 时间：2012-09-01T19:20:31.023
> 
> 标签：html, css, asp.net-mvc-3, href

我想知道是否有办法为图像制作直接下载链接？当我做这样的事情时：

它在浏览器或新选项卡中打开图像。我希望当用户单击该链接时立即下载图像。有没有办法用 HTML/CSS 或 ASP.NET MVC 3 做到这一点？

我的页面类似于 tumblr 博客，主页上有几张图片，每个旁边都有“下载总部”按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:21:57.463

您将需要服务器端脚本以使链接可下载，您需要将标头设置为

```
Content-Disposition:attachment;filename=some.jpg 
```

然后读取图像的内容并将其刷新到响应对象。

这是 asp.net 的示例

***[例子](http://forums.asp.net/post/2109808.aspx)***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:24:14.020

添加 HTTP 标头：

```
Content-Disposition: attachment; filename=<file name.ext> 
```

您希望在“另存为”对话框中显示的文件名在哪里（如财务.xls 或抵押.pdf） - 不带 < 和 > 符号。

这是 MVC 框架中的一个示例：

```
public ActionResult Download()
{
    var document = ...
    var cd = new System.Net.Mime.ContentDisposition
    {
        // for example foo.bak
        FileName = document.FileName, 

        // always prompt the user for downloading, set to true if you want 
        // the browser to try to show the file inline
        Inline = false, 
    };
    Response.AppendHeader("Content-Disposition", cd.ToString());
    return File(document.Data, document.ContentType);
} 
```

# c# - 后退按钮禁用内容占位符中的链接？

> ID：12230665
> 
> 赞同：1
> 
> 时间：2012-09-01T19:20:57.387
> 
> 标签：c#, asp.net, updatepanel, back-button, linkbutton

我*在内容面板*中有链接，当页面是新的/刷新时会触发。但是，如果您在整个页面中导航，然后**点击后退按钮**返回主页，*则内容面板中的任何链接按钮事件都不会触发。*

我只是有点失落——是什么导致了这个功能。如果需要，我可以发布代码，但我真的只是在寻找关于从哪里开始寻找的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:27:19.833

您应该从[asp 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx)开始- 了解为什么您期望触发的事件没有触发。

# iphone - 如何在修改可变数组时安全地循环它？

> ID：12230668
> 
> 赞同：2
> 
> 时间：2012-09-01T19:21:10.340
> 
> 标签：iphone, objective-c, ios, arrays

我有`controller`一个数组，其中包含`actors`. Actor 是一个对象，它将被`controller`.

问题：`controller`遍历`actors`数组并向每个参与者发送一个`-actionMessage`. Actor 可以使用 来创建和注册另一个 Actor `controller`，或者从控制器的 Actor 数组中删除一个 Actor 甚至它自己。它通过两种方法路由：

```
-registerActor:(Actor*)actor;
-unregisterActor:(Actor*)actor; 
```

**因此，当控制器迭代演员数组时，演员列表可以改变。编辑：任何新添加的演员也必须通过循环。**

处理这个问题的最佳实践是什么？我应该在迭代之前创建演员数组的副本吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T19:40:38.890

创建一个可变数组的副本并对其进行迭代。

```
NSArray *loopArray = [NSArray arrayWithArray: yourActorArray]; 
```

或者

```
NSArray *loopArray = [yourActorArray copy];
//in this case remember to release in nonARC environment 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:47:21.883

这是我平时做的...

```
NSMutableArray *discardedItems = [NSMutableArray array];
SomeObjectClass *item;

for (item in originalArrayOfItems) {
    if ([item shouldBeDiscarded])
        [discardedItems addObject:item];
}

[originalArrayOfItems removeObjectsInArray:discardedItems]; 
```

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T19:51:15.657

枚举一个可变数组的标准过程需要在您逐步完成时进行更改，即制作一个副本并对其进行迭代，从而更改原始数组。我猜演员的 NSMutableArray 是属于您的控制器的属性，并且 registerActor: 和 unregisterActor: 都改变了这个数组。如果您单步执行副本，则可以通过方法从原始属性中删除演员，而无需更改副本。

```
NSMutableArray *actorArrayCopy = [self.actorArray copy];
for (id object in actorArrayCopy){
    //do stuff
} 
```

在某些情况下，您可以放弃快速枚举并使用标准 for 循环，但是，这在这里是有风险的。如果从数组中插入或删除对象，则索引将移动（AFAIK），这意味着您最终可能会跳过元素或多次遍历一个元素。

有些人将要更改（例如删除）的元素存储在快速枚举中的单独数组中，并在枚举完成后立即执行所有更改，但是您使用单独的方法来添加和删除元素；元素本身决定应该发生什么并通知您。这会使事情变得更加复杂，因此副本可能效果最好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T19:57:35.480

您可以通过执行以下操作来避免制作数组的副本：

```
for(int i=0; i<[array count]; i++)
{
    if(condition)
    {
        [array removeObjectAtIndex:i];

        i --;
        continue;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T20:03:06.403

您应该使用集合而不是数组。然后你可以复制set，操作完成后，拿一个diff看看有什么变化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-28T06:01:59.497

我制作了一个名为的宏`smartFor`，它允许您进行与 for 循环快速枚举相同的设置，但可以处理数组的修改。它利用了一些 C 和 CLANG 漏洞利用，非常简单和干净。

* * *

# 宏：

```
///Allows for modifying an array during virtual fast enumeration
#define smartFor(__objectDeclaration, __array, __block) {\
int __i = 0;\
while (__i < __array.count) {\
__objectDeclaration = __array[__i];\
NSObject *__object = __array[__i];\
[__block invoke];\
if ([__array indexOfObjectIdenticalTo:__object] != NSNotFound && ((int)[__array indexOfObjectIdenticalTo:__object]) <= __i) {\
__i = ((int)[__array indexOfObjectIdenticalTo:__object])+1;\
}\
}\
} 
```

它会自动处理您可能会做的所有 [基本] 不稳定的事情，例如添加对象（在数组中的任何位置，在“快速枚举” ^([1])期间的任何时间点）、删除对象、调整对象的索引、修改对象等.

* * *

# 示例用法：

```
smartFor(NSNumber *aNumber, myArray, ^{
    if ([aNumber isEqualToNumber:@(3)]) {
        [myArray removeObjectIdenticalTo:aNumber];
    }
}); 
```

*^([1])注意：显然，在严格的定义/性能基础上，它在技术上并不是快速枚举，但在所有意图和目的上都表现得像它一样*

# magento - 在 Magento 中覆盖产品价格模板

> ID：12230672
> 
> 赞同：0
> 
> 时间：2012-09-01T19:21:38.233
> 
> 标签：magento

我试图在 Magento 中为 Product 和 Grid 页面隐藏所有产品的价格。我创建了一个自定义模块来更新布局，config.xml 如下：

```
<config>
    <modules>
        <ABC_XYZ>
            <version>1.0</version>
        </ABC_XYZ>
    </modules>

    <frontend>
        <layout>
            <updates>
                <killprice>
                    <file>killprice.xml</file>
                </killprice>
            </updates>
        </layout>
    </frontend>

</config> 
```

我添加了 killprice.xml 如下：

```
<layout>

    <default>
        <block type="catalog/product_price_template" name="catalog_product_price_template"  template="killprice/price.phtml"  />
    </default>

    <killprice_index_index>
        <block type="catalog/product_price_template" name="catalog_product_price_template"  template="killprice/price.phtml"  />
    </killprice_index_index>

</layout> 
```

但是 killprice/price.phtml 没有被渲染，我得到了正常的价格模板。我对 killprice.xml 布局文件中的标签有点怀疑，我是否以正确的方式覆盖价格模板？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T20:42:28.047

这应该是您正在寻找的……

```
<layout>
    <default>
         <reference name="catalog_product_price_template">
            <action method="addPriceBlockType"><type>simple</type><block>catalog/product_price</block><template>killerprice/price.phtml</template></action>
            <!-- duplicate for each product type you need to handle i.e. change the value of the <type> node" -->
        </reference>
    </default>
</layout> 
```

看看`Mage_Catalog_Block_Product_Abstract`为什么会这样

# python - 如何在 Python 中获取 line-> next

> ID：12230677
> 
> 赞同：-5
> 
> 时间：2012-09-01T19:22:02.707
> 
> 标签：python, iteration

我正在逐行遍历员工记录文件，并尝试在员工记录末尾的文件中插入一个新行（轮班记录），该文件用“？”标记。

所以基本上我的文件看起来像这样：

> 职员 ＃＃＃＃＃ ！
> Joe Smith
> 员工
> 第一班
> 第二班
> ？
> ！
> Jane Smith
> 临时志愿者
> 
> 第一班
> 第二班
> 第三班
> ?
> @

......我想，比如说，在简·史密斯的记录中添加一个“第四班”。我想通过迭代文件的工作副本，找到简的记录（使用标志）然后当当前行的后继（行->下一个？？）是“？” 我知道我当前的线路是 Jane 最后记录的班次。然后，我可以在继续将旧文件的其余部分复制到新文件中之前写入“第四班”行。

当我遍历所有这些行时，如何阅读*以下*行（以检查“？”）而不实际跳过它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:04:17.290

无论如何，您基本上不能只在文件中间插入一行。相反，您应该使用包含新行的新文件覆盖旧文件。所以解决方案是这样的：

1.  打开文件进行阅读。
2.  保存文件的内容，最好是逐行保存，以便更容易插入到特定行。
3.  将新行插入保存的内容中。
4.  重新打开文件，这次是在写入模式下，并用保存的修改内容覆盖其内容。

因此，对于您的示例，并使用您的标志想法来查找插入点，您将执行以下操作：

```
#Step 1
with open('testFile', 'r') as f:
    #Step 2
    contentList = f.readlines()

#Step 3
isJane = False # <-- flag
i = 0
insertIndex = None # used to avoid changing the list while looping over it
for line in contentList:
    if 'jane' in line.lower():
        isJane = True
    if isJane and line.strip() == '?':
        insertIndex = i
    i += 1
contentList.insert(insertIndex, 'fourth shift\n')

#Step 4
with open('testFile', 'w') as f:
    f.writelines(contentList) 
```

有更短的方法可以做到这一点，但这可能是最直接的。

# java - 如果使用 Java Smack API 断开连接，如何在使用 nextResult() 时知道或捕获异常？

> ID：12230679
> 
> 赞同：1
> 
> 时间：2012-09-01T19:22:07.900
> 
> 标签：java, xmpp, smack

我正在使用 Java Smack API 开发应用程序。我使用 PacketCollector.java 类的 nextResult() 方法来接收下一条传入消息。（根据文档，此方法会阻塞，直到有输入。）

[http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/PacketCollector.html](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/PacketCollector.html)

我有一个问题，如果连接突然中断（例如，由于网络断开等），我怎么知道或如何捕获异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:11:47.950

调用将`nextResult()`一直等到与过滤器匹配的数据包到达。查看源代码，我认为只要您使用相同的连接实例，它甚至会在断开连接并重新连接后等待。

你不应该真正使用`nextResult()`，`nextResult(long)`而是使用。`nextResult()`如果连接由于某种原因断开连接并且没有充分的理由使用`nextResult()`而不是`nextResult(long)`使用合理的超时值，则不会引发异常。

# android - AudioFlinger 无法创建音轨，状态：-12，使用原生 CocosDenshion 循环音效时，cocos2d-x

> ID：12230683
> 
> 赞同：3
> 
> 时间：2012-09-01T19:22:34.973
> 
> 标签：android, c++, cocos2d-x, audioflinger

每当我尝试使用 CocosDenshion 和 cocos2d-x 循环声音时，我都会收到以下错误： ![我的错误](../Images/39b43672fd8b8f088a6e53e7ba2fecd3.png)

我使用的是稳定的 cocos2d-2.0-x-2.0.2，我的代码是：

```
CocosDenshion::SimpleAudioEngine::sharedEngine()->playEffect("sound/sound_ocean_ambmusic.ogg", true); 
```

这发生在我的手机（Samsung Galaxy S III，verizon）和安卓模拟器上，都是 4.0 版，ICS。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T09:11:13.573

我有同样的错误。什么帮助了我？

当你每次播放声音日志时，你想播放什么声音，然后检查这个文件是否很大，我是 30 KB（所以我把它削减到 17 KB）。我使用 .ogg

接下来尝试修改 Android Cocos2dxSound 并在那里添加另一个 SoundPool 或将您的活动流减少到 6 meybe。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-15T09:12:06.820

Soundpool 无法处理大于 1 MB 的文件大小

# android - 在 ViewPager 中管理时，如何从父 Activity 更新片段？

> ID：12230684
> 
> 赞同：0
> 
> 时间：2012-09-01T19:22:44.503
> 
> 标签：android, android-fragments, simplecursoradapter

我有一个将 NFC 读取存储到我的应用程序数据库中的活动。我有一个片段，它有一个 ListView，其数据由游标适配器绑定到同一个数据库。

该活动在前台处理意图，但是当我滑动到片段时，列表视图尚未使用数据库最新数据进行更新。

当我的活动将 NFC 读取添加到数据库时，告诉片段更新列表视图的最佳方法是什么？

该片段由视图分页器在活动中进行管理，因此我无法使用 getFragmentById() 访问该片段，因为我没有 ID。我读过一些奇怪的 android:switcher hack 来访问片段的 ID 或标签，但这似乎不是一个好主意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:51:46.560

3种可能的方式：

1.  从封闭活动发送广播并让您的片段收听并对该广播采取行动
2.  实现回调机制，例如[http://www.javaworld.com/javatips/jw-javatip10.html](http://www.javaworld.com/javatips/jw-javatip10.html)
3.  在您的 Fragment 中提供一个可由封闭活动调用的公共方法

# android - 透明的活动，带有淡淡的灰色

> ID：12230686
> 
> 赞同：1
> 
> 时间：2012-09-01T19:23:28.213
> 
> 标签：android, xml, android-activity, transparent

我试图在另一个活动上拥有一个透明的活动，带有淡淡的灰色色调。我能够调用透明活动，但我无法获得灰色色调。请帮我。以下是我的代码。

```
 <style name="Theme.Transparent">
    <item name="android:windowBackground">@drawable/transparent_background</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowIsFloating">true</item>
    <item name="android:backgroundDimEnabled">false</item>
</style>
<drawable name="transparent_background">#FFFECA11</drawable> 
```

无论我为可绘制对象提供什么颜色值，它都不会被反映为背景。清单中的定义

```
 <activity
        android:name=".DisplayHelpActivity"
        android:label="@string/title_activity_display_help" 
        android:theme="@style/Theme.Transparent">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.INFO" />
        </intent-filter>
    </activity> 
```

你能告诉我 wat 不见了吗？PS请忘记颜色值。它只是随机的，我曾经测试它是否有效。

我也使用了以下内容

```
 <item name="android:windowBackground">@color/transparent</item> 
```

而不是drawable，在我的color.xml中

```
 <?xml version="1.0" encoding="utf-8"?>
    <resources>
       <color name="transparent">#80ffeeca</color>
    </resources> 
```

它仍然没有效果。请帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T19:42:26.897

我认为将活动放在一起并不是一个好主意。如果您想在正常活动之上显示某些内容，那么使用 a[`FrameLayout`](http://developer.android.com/reference/android/widget/FrameLayout.html)是一个可行的解决方案：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/main_layout" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#ffffffff"
        android:id="@+id/underlying_layout" >

        <!--Put the parts of your normal activity here -->

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#88666666"
        android:id="@+id/top_layout">

        <!--Put the parts of the layout here, 
        what should be on top of your activity-->

    </LinearLayout>
</FrameLayout> 
```

现在如果你想让顶层的东西出现或消失，那么你可以[`setVisibility()`](http://developer.android.com/reference/android/view/View.html#setVisibility%28int%29)像这样使用 Views 函数：

```
View topLevelLayout = findViewById(R.id.top_layout);

//make it disappear with all its sub-Views
topLevelLayout.setVisibility(View.INVISIBLE);

//make it appear with all its sub-Views
topLevelLayout.setVisibility(View.VISIBLE); 
```

## 更新

![在此处输入图像描述](../Images/03b30421967fcd41ec0b80f81bc70aad.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T19:27:20.480

我相信问题在于颜色本身的价值。

```
#FFFECA11 
```

原因是颜色被分解为四个值，#AARRGGBB。前两个是透明值，通过在前两个值中使用**FF**，您可以确保它不透明。尝试使用以下值来获得大约 50% 的透明度：

```
#7FFECA11 
```

有关详细信息，请参阅以下链接：http: [//developer.android.com/guide/topics/resources/more-resources.html#Color](http://developer.android.com/guide/topics/resources/more-resources.html#Color)

# bash - bash 中的字符串比较。[[： 未找到

> ID：12230690
> 
> 赞同：205
> 
> 时间：2012-09-01T19:23:56.510
> 
> 标签：bash, shell, ubuntu-11.04, string-comparison

我正在尝试比较 bash 中的字符串。[我已经在stackoverflow](https://stackoverflow.com/questions/229551/string-contains-in-bash)上找到了如何做的答案。在我正在尝试的脚本中，我正在使用 Adam 在上述问题中提交的代码：

```
#!/bin/bash
string='My string';

if [[ "$string" == *My* ]]
then
  echo "It's there!";
fi

needle='y s'
if [[ "$string" == *"$needle"* ]]; then
  echo "haystack '$string' contains needle '$needle'"
fi 
```

我还尝试了来自[ubuntuforums](http://ubuntuforums.org/showthread.php?t=562398)的方法，您可以在 2nd post 中找到

```
if [[ $var =~ regexp ]]; then
  #do something
fi 
```

在这两种情况下，我都会收到错误：

```
[[: not found 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2012-09-01T19:27:45.577

`[[`是 bash 内置的。您`/bin/bash`似乎不是真正的 bash。

*来自评论：*

`#!/bin/bash`在文件顶部添加

* * *

## 回答 #2

> 赞同：204
> 
> 时间：2012-09-01T19:32:08.447

你是如何运行你的脚本的？如果你做了

```
$ sh myscript 
```

你应该试试：

```
$ bash myscript 
```

或者，如果脚本是可执行的：

```
$ ./myscript 
```

*sh*和*bash*是两个[不同的 shell](http://www.faqs.org/faqs/unix-faq/shell/shell-differences/)。在第一种情况下，您将脚本作为参数传递给 sh 解释器，而在第二种情况下，您在第一行决定将使用哪个解释器。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2013-05-06T16:58:25.533

是脚本中的第一行：

```
#!/bin/bash 
```

或者

```
#!/bin/sh 
```

sh shell 产生此错误消息，而不是 bash

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-05-30T14:55:26.843

正如@Ansgar 所提到的，`[[`它是一种bashism，即内置于Bash 中，不适用于其他shell。如果您希望脚本可移植，请使用`[`. 比较也需要不同的语法：更改`==`为`=`.

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-07-19T18:28:40.587

我在安装[Heroku Toolbelt时遇到了这个问题](https://toolbelt.heroku.com/standalone)

这就是我解决问题的方法

```
$ ls -l /bin/sh
lrwxrwxrwx 1 root root 4 ago 15  2012 /bin/sh -> dash 
```

如您所见，/bin/sh 是指向“dash”（不是 bash）的链接，并且`[[`是 bash 语法糖度。所以我只是替换了 /bin/bash 的链接。**在你的系统中小心使用这样的 rm ！**

```
$ sudo rm /bin/sh
$ sudo ln -s /bin/bash /bin/sh 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2020-09-26T15:31:23.903

如果您知道自己在使用 bash，但仍然出现此错误，请确保在 if 中使用空格。

```
[[1==1]] # This outputs error

[[ 1==1 ]] # OK 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-12-13T11:46:21.840

运行脚本时指定 bash 而不是 sh。我个人注意到它们在 ubuntu 12.10 下是不同的：

`bash script.sh arg0 ... argn`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-05-31T16:02:13.487

在您的终端中执行：

```
sudo update-alternatives --install /bin/sh sh /bin/bash 100 
```

# scala - 如何以最佳方式传递元组参数？

> ID：12230698
> 
> 赞同：36
> 
> 时间：2012-09-01T19:25:01.007
> 
> 标签：scala, arguments, tuples

如何以最佳方式传递元组参数？

例子：

```
def foo(...): (Int, Int) = ...

def bar(a: Int, b: Int) = ... 
```

现在我想传递 to 的`foo`输出`bar`。这可以通过以下方式实现：

```
val fooResult = foo(...)
bar(fooResult._1, fooResult._2) 
```

这种方法看起来有点难看，尤其是当我们处理带有 的`n`-tuple 时`n > 2`。此外，我们必须将 foo 的结果存储在一个额外的值中，因为否则`foo`必须使用`bar(foo._1, foo._2)`.

**有没有更好的方法将元组作为参数传递？**

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-09-01T19:29:57.093

每个函数都有一个特殊的`tupled`方法可用：

```
val bar2 = (bar _).tupled  // or Function.tupled(bar _) 
```

`bar2`接受一个元组`(Int, Int)`（与参数相同`bar`）。现在你可以说：

```
bar2(foo()) 
```

如果您的方法实际上是函数（注意`val`关键字），那么语法会更令人愉悦：

```
val bar = (a: Int, b: Int) => //...
bar.tupled(foo()) 
```

# 也可以看看

*   [如何将函数应用于元组？](https://stackoverflow.com/questions/1987820)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T20:57:33.220

也值得了解

```
foo(...) match { case (a,b) => bar(a,b) } 
```

作为不需要您显式创建临时`fooResult`. 当速度和不混乱都很重要时，这是一个很好的折衷方案。您可以使用 创建一个函数，`bar _`然后将其转换为使用单个元组参数`.tupled`，但是每次调用该对时都会创建两个新的函数对象；您可以存储结果，但这可能会使您的代码不必要地混乱。

对于日常使用（即这不是代码的性能限制部分），您可以

```
(bar _).tupled(foo(...)) 
```

排队。当然，您创建了两个额外的函数对象，但您很可能也刚刚创建了元组，所以您并不关心*那么*多，对吧？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-01T19:35:04.413

`tupled`正如@Tomasz 所提到的，使用 是一种好方法。

您还可以提取`foo`分配期间返回的元组：

```
val (x, y) = foo(5)
bar(x, y) 
```

这样做的好处是代码更简洁（没有`_1`and ），并允许您为and`_2`分配描述性名称，从而使您的代码更易于阅读。`x``y`

# python - 龙卷风的姜戈

> ID：12230701
> 
> 赞同：1
> 
> 时间：2012-09-01T19:25:36.747
> 
> 标签：python, django, tornado

我看到很多人使用 django 和使用 WSGIContainer 的龙卷风。这有道理吗？Tornado 应该是异步的，但 Django 是同步的。你这样做不就是在自取其辱吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T03:48:09.857

在 django 前面我还没有看到使用 tornado 的大项目。但从技术上讲，您可以`monkey.patch_all()`使用`gevent`. 然后龙卷风就有意义了。这确实是一个糟糕的解决方案，但如果你需要的只是异步不稳定的 django 等着你在角落里用电锯砍掉你的腿而不是射击它们 - 那就是你的了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T22:42:30.100

Django 自带调试服务器，所以我猜，使用 Tornado 和 Django，这里的 Tornado 是 Apache + mod_WSGI 的混合

# parsing - 如何用 peg 语法解析这个？

> ID：12230703
> 
> 赞同：8
> 
> 时间：2012-09-01T19:26:10.287
> 
> 标签：parsing, peg, pegjs

我正在尝试使用[pegjs](http://pegjs.majda.cz/)制作解析器。我需要解析类似的东西：

```
blah blah START Lorem ipsum 
dolor sit amet, consectetur 
adipiscing elit END foo bar 
etc. 
```

我无法编写从 to 捕获文本的`"START"`规则`"END"`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T08:47:46.697

使用否定的前瞻谓词：

```
phrase
  =(!"START" .)* "START" result:(!"END" .)* "END" .* {
    for (var i=0;i<result.length;++i)
      // remove empty element added by predicate matching
      {result[i]=result[i][1];
      }
    return result.join("");
   } 
```

您需要对 END 和 START 使用否定谓词，因为 pegjs 中的重复是贪婪的。

~~或者，动作可以写成~~

 ~~```
{return result.join("").split(',').join("");} 
```~~ 

~~尽管这依赖于`join`在处理嵌套数组时没有必要记录的行为（即它用逗号连接子数组，然后将它们连接起来）。~~

[更新] 处理空元素的更短的方法是

```
phrase
  =(!"START" .)* "START" result:(t:(!"END" .){return t[1];})* "END" .* {
      return result.join("");
    } 
```

# sql - 如何使用 R 抓取重定向的 URL

> ID：12230707
> 
> 赞同：1
> 
> 时间：2012-09-01T19:26:25.280
> 
> 标签：sql, r, function

我有一个功能

```
testFun <- function(myTeam){
  print(myTeam)
  teamResults <- sqlQuery(channel,paste(
    "
  SELECT  soccer.tblResultsallMore.TEAMNAME,
    sum(case when soccer.tblResultsallMore.RES='W' then 1 else 0 end) as W,
    sum(case when soccer.tblResultsallMore.RES='L' then 1 else 0 end) as L,
    sum(case when soccer.tblResultsallMore.RES='D' then 1 else 0 end) as D
    FROM soccer.tblResultsallMore
    WHERE soccer.tblResultsallMore.TEAMNAME=myTeam
    GROUP BY soccer.tblResultsallMore.TEAMNAME

    "))
  return(teamResults) # no error if this is not returned
}
testFun("Everton") 
```

如果我在代码中硬编码“埃弗顿”，我会得到所需的输出

```
[1] "Everton"
  TEAMNAME    W    L    D
1  Everton 1734 1463 1057 
```

但是参数有错误

```
[1] "Everton"
[1] "42S22 207 [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'myTeam'."                                                                                                                                                                                                                                                                                                                                                                                                
[2] "[RODBC] ERROR: Could not SQLExecDirect 
```

非常感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:36:30.427

在您提供的代码中，名称`myTeam`没有被替换，它被视为字符串，并且 sql 语句查找名为`myTeam`.

```
variabel = "spam"
paste("from table select variabel") 
```

不放在`"spam"`sql语句里面`paste`。正确的语法是：

```
paste("from table select ", variabel) 
```

在您的情况下，我会使用`sprintf`. 一个例子：

```
variabel = "spam"
sprintf("from table select %s", variable) 
```

有关更多详细信息，请参阅`sprintf`.

关于您的评论，如果没有明确的 return 语句，则返回最后一个评估的表达式。讨论见：

[是否在函数中显式调用 return](https://stackoverflow.com/questions/11738823/explicitly-calling-return-in-a-function-or-not)

# wordpress - 从插件更新帖子没有完全工作......

> ID：12230711
> 
> 赞同：0
> 
> 时间：2012-09-01T19:26:44.950
> 
> 标签：wordpress

我正在编写一个插件，其中我正在更新帖子内容并使用创建自定义字段

```
add_post_meta($post->ID, 'thesis_post_image', 'http://www.nurseryrhymesonline.net/images/' . $meta);

$my_post = array(
    'ID' => $post->ID,
    'post_content' => $cont
    );

wp_update_post( $my_post ); 
```

它工作正常，内容和自定义字段完全符合我的要求，但尽管我可以在帖子编辑页面上看到内容和自定义字段，除非我手动点击更新按钮，否则它似乎没有更新数据库。我尝试了一个新的循环但没有成功不模拟手动单击更新按钮。

任何想法如何模拟从插件单击更新按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T05:52:47.023

我过去发现 using`$post->ID`在插件中效果不佳。也许`get_the_id()`会有所帮助。法典[在这里](http://codex.wordpress.org/Function_Reference/get_the_ID)。

# firefox - 有没有办法使用 Firebreath 使用 NPAPI 插件在 Web 浏览器中禁用 Alt+F4、Ctrl+F4、Ctrl+W？

> ID：12230714
> 
> 赞同：0
> 
> 时间：2012-09-01T19:26:54.943
> 
> 标签：firefox, google-chrome, npapi, firebreath, browser-plugin

是否可以防止某些按键（如标题中所述）到达浏览器？基本上我想剥夺用户关闭浏览器窗口的能力。是否可以通过 NPAPI 插件，特别是在`google-chrome`网络浏览器中。该插件将使用 firebreath 开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T02:33:28.383

如果您的实际问题是浏览器是否为插件提供了执行此操作的方法，那么答案绝对不是。

也就是说，可能有系统 API 可用于执行此操作，但如果您询问有关如何使用系统 API 执行此操作的问题，您肯定更有可能获得帮助。挑战将是找到一种方法，仅当您在浏览器中或特定选项卡等时才这样做；没有办法通过浏览器来做到这一点。如果有办法，它将是hackish并且涉及系统调用，而不是插件调用。

还要记住插件不会自动实例化；它只适用于带有您的对象标签的页面。[http://npapi.com/extensions](http://npapi.com/extensions)了解更多信息

# php - PHP：Bootstrap、CodeIgniter - 从 MySQL 中提取的 Typeahead 数据

> ID：12230716
> 
> 赞同：1
> 
> 时间：2012-09-01T19:27:12.383
> 
> 标签：php, mysql, arrays, codeigniter, typeahead

我正在尝试查询 SQL 以获取用于预先输入的值数组，但我显然错过了数组的基础知识，因为它甚至没有给我接近我期望的结果

我只想从 SQL 中收集不同数据的“名称”列

这是我的 MySQL 查询

```
$data['typeahead'] = $this->db->query('SELECT DISTINCT Name from table')->result_array(); 
```

这是它在 var_dump 上给出的输出

```
array(287) { 
 [0]=> array(1) { ["Name"]=> string(16) "'67 Shelby GT500" } 
 [1]=> array(1) { ["Name"]=> string(8) "Tooligan" } 
 [2]=> array(1) { ["Name"]=> string(24) "'67 Pontiac Firebird 400" } 
 [3]=> array(1) { ["Name"]=> string(17) "Volkswagen Beetle" } 
} 
```

我唯一想做的就是用列中的数据构建一个数组。我正在为 FrameWork 使用 CodeIgniter，并将使用 Bootstrap 的 JS 来处理 typeahead，但我被困在数据数组部分。

任何帮助将不胜感激，我找到了许多关于如何使用非 MySQL 数组作为预输入的教程，但没有一个与 MySQL 一起使用。

^^ 已解决

现在发行：

Typeahead 没有从数组中提取数据

控制器代码：

```
 $name_array = $this->db->query('SELECT DISTINCT Name from table')->result_array();

 $typeahead_string = '';
 foreach ($name_array as $name)
 {
  $formatted_name    =  '"' . $name['Name'] . '", ';
  $typeahead_string .= $formatted_name;
 }

 $option_list = "[" . rtrim($typeahead_string, ", ") . "]";
 $data['typeahead'] = $option_list; 
```

查看代码：

```
<input type="text" class="span3 search-query" placeholder="Search" id="typeahead" data-provide="typeahead" data-source="<?php echo $typeahead; ?>"><button type="submit" class="btn"><i class="icon-search"></i></button> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:28:19.473

您可以遍历查询当前生成的结果并将`Name`元素添加到新数组中，如下所示：

```
$name_array = $this->db->query('SELECT DISTINCT Name from HWC')->result_array();

$typeahead_array = array();
foreach ($name_array as $name)
{
    $typeahead_array[] = $name['Name'];
}

$data['typeahead'] = $typeahead_array; 
```

* * *

编辑：

要在 Bootstrap 中使用 typeahead 功能，数据源可以是字符串列表，例如：`"Orange", "Apple", "Banana"`

您可以为变量分配`$data['typeahead']`一个作为选项列表的字符串，将其传递给视图并将其回显到相关属性。

**控制器**

下面的循环将创建一个字符串变量，该变量将包含预先输入的所有选项。它在每个元素周围添加引号并在末尾添加逗号 - 所以`Apple`会变成`"Apple",`. 然后它将每个元素附加到字符串。

```
$name_array = $this->db->query('SELECT DISTINCT Name from HWC')->result_array();

$typeahead_string = '';
foreach ($name_array as $name)
{
    $formatted_name    =  '"' . $name['Name'] . '", ';
    $typeahead_string .= $formatted_name; 
}

$option_list = rtrim($typeahead_string, ",");  //Strips the last comma and any whitespace from the end string

$data['typeahead'] = $option_list; 
```

**看法**

您在视图中的输入应该与此类似，重要的部分是选项列表的回显位置：`data-source="[<?php echo $typeahead; ?>]"`

```
<input type="text" data-provide="typeahead" data-items="4" data-source="[<?php echo $typeahead; ?>]"> 
```

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:37:20.790

仍然不适合我。当我检查元素时，像这样的数据 " uncategories","php" 。什么是第一个总是痉挛。

找到了方法，而不是使用这个`$formatted_name = '"' . $name['Name'] . '", ';`只是更改为`$formatted_name = '&quot;' . $name['Name'] . '&quot;, ';`

# codeigniter - 带有用于生成电子表格、登录/用户系统、twitter 引导程序集成的插件的 php 框架？

> ID：12230718
> 
> 赞同：0
> 
> 时间：2012-09-01T19:27:14.280
> 
> 标签：codeigniter, cakephp, php

我正在考虑将 php 框架 Codeigniter 和 Cakephp 用于我将要开发的小型网站，但我愿意使用几乎任何满足以下要求的框架。要求是：

*   一个简单的预构建用户身份验证系统或作为插件的登录系统，类似于[php-login-script](http://php-login-script.com/)。

*   允许与第三方 excel/电子表格生成库轻松集成或具有一些插件。

*   应该支持`PHP 5.2`，因此不能考虑 symfony2

*   如果框架与[twitter bootstrap集成，则加分](http://twitter.github.com/bootstrap/)

寻找可以满足以上所有要点的框架，这样我可以节省一些时间。否则，我更喜欢能够满足*大部分*要求的框架，并且我会自己编写休息。

所以，基于以上要求；你会建议哪个 php 框架/脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:00:39.943

我不太了解codeIgniter，但是对于Cakephp，我可以告诉你：

*   身份验证很容易实现。
*   生成 xml（Excel 可以打开）很容易，对于 .xls，您必须自己完成所有工作。
*   支持5.2
*   twitter bootstrap有一个[助手](http://bakery.cakephp.org/articles/mxkocak/2011/11/16/twitter_bootstrap_style_for_cakephp_instantly)，但我从未使用过它。

对我来说，关于 CodeIgniter 的交易破坏者是缺乏内置的 ORM。您应该考虑是否需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:04:33.970

CakePHP2

*   用户插件[https://github.com/cakedc/users](https://github.com/cakedc/users)
*   Twitter 引导[https://github.com/slywalker/TwitterBootstrap](https://github.com/slywalker/TwitterBootstrap)

有很多不同的 xls 导出助手。只需谷歌搜索并查看它们，我不能推荐其中任何一个，因为我没有使用过它们。我们有自己的，但我们没有开源它。

总的来说，我建议在任何情况下都使用 CakePHP2 而不是 Codeigniter。我最近不得不将一个项目从 CI 转换为 Cake，现在我知道为什么了...... ;)

# php - 在 PHP 中使用 create_function() 自定义中断命令/函数

> ID：12230721
> 
> 赞同：3
> 
> 时间：2012-09-01T19:27:41.907
> 
> 标签：php, loops, syntax, command

我想知道是否可以在 PHP 中创建自定义中断命令/函数。

例如，

```
<?php
$custombreak = create_function('$a', 'if ($a == 3) break 1;');

$i = 0;
do {

    echo $i . '<br />';
    $i++;
    $custombreak($i);    //<-- I'd like to break the loop with a custom function.
    // if ($i==3)        //<-- this is not what I'm looking for
    //    break;      

} while ($i < 10);
?> 
```

这不是有效的 PHP 代码，但我希望你能明白我的意思。我想用函数转义循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:31:41.803

即使您创建正常功能

```
function foo() {
  break 2; // this is not valid
}

while(true) {
  foo();
} 
```

那是行不通的。这就是程序员所做的：

```
function foo() {
  return true;
}

while(true) {
  if(foo()) break;
} 
```

所以你的代码将是..

*   [http://codepad.org/lztnGflZ](http://codepad.org/lztnGflZ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:41:30.503

```
<?php

function control($a){
    if($a==3)
        return false;
    return true;
}

$i = 0;
do {

    echo $i . '<br />';
    $i++;    

} while ( ($i < 10) && (control($i)) );

?> 
```

这是这个问题的答案吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:17:39.297

我找到了例外的方法。

```
$i = 0;
try {
    do {
        $i++;
        echo $i . '<br />';
        custombreak($i);
    } while ($i <= 10);
} catch (Exception $e) {}

function custombreak($i) {
    if ($i > 3) throw new Exception("");
} 
```

谢谢大家。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-01T19:32:16.090

您可以在 while 循环中使用此控件。我认为不需要编写函数。

```
<?php

$i = 0;
do {

    echo $i . '<br />';
    $i++;    

} while ( ($i < 10) && ($i!=3) );
?> 
```

你知道多个控件不是吗？

# ruby-on-rails - HAProxy maxconn 1

> ID：12230730
> 
> 赞同：0
> 
> 时间：2012-09-01T19:28:47.883
> 
> 标签：ruby-on-rails, nginx, load-balancing, haproxy

我刚刚通过HAProxy。文章表明，将 maxconn 设置为 1 可以节省大量生命，并且明显优于 nginx。将 maxconn config 设置为 1 有什么好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:14:10.383

It only serves with some servers which are incapable of processing multiple requests at once and which can only serialize them. Under such conditions, you definitely don't want to send new requests to busy servers, because these requests would have to wait until the server is free again. Maxconn 1 ensures that the request can be distributed to another server in case there is some room somewhere else when a server is already being used. Otherwise the request sits in the queue and is assigned to the first server to release a connection.

Also, with such servers, it helps to have large buffers in haproxy in order to quickly drain and buffer the response and release the server while sending data to the client.

# c# - 循环序列中两个数字之间的距离

> ID：12230732
> 
> 赞同：2
> 
> 时间：2012-09-01T19:29:08.290
> 
> 标签：c#, .net, algorithm, math

假设您有一个这样的序列：0、1、2、3、4、5、6、7、0、1、2 等。基本上是一个由 N 个数字组成的序列，一遍又一遍地重复。

查找此序列中两个数字之间的距离/差异的最简单算法是什么？例如距离`from 5 to 7 is +2`和距离`from 0 to 6 is -2`。对于更高级的视图，我有一个循环/重复序列号，我需要找出最近路径上另一个数字的“之前”或“之后”有多少（它们之间的数字最少）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T19:46:21.017

假设 X>Y：

```
dist(X, Y) = min { X-Y, N-(X-Y-1) } 
```

N = 7 的示例：

dist(7, 5) = min {7-5, 7-(7-5-1)} = min {2, 6} = 2

dist(6, 0) = min {6-0, 7-(6-0-1)} = min {6, 2} = 2

dist(5, 1) = min {5-1, 7-(5-1-1)} = min {4, 4} = 4

最后一个例子指出了距离定义中的一个小缺陷：是 dist(5, 1) = 4 还是 dist(5, 1) = -4 ？我已经稍微改变了你的定义以避免负距离（所以我的算法计算距离的绝对值）。如果你想保持你的定义，那么当且仅当第一个参数`min`大于第二个时，距离为负。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T20:04:03.783

这很简单，可以使用连续和非连续数字，也许可以使其成为扩展方法：

```
[TestFixture]
public class NumbersFixture
{
    [Test]
    public void FindDistance()
    {
        var numbers = new List<int> { 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2 };

        var num1 = 6;
        var num2 = 0;

        var from = numbers.IndexOf(num1);
        var indexFound = numbers.FindIndex(from, f => f == num2);
        var distance = from - indexFound;

        var result = string.Format("{0}", distance);
        Console.WriteLine(result);
    }
} 
```

# java - 为什么当我尝试下载 Android 支持包修订版 10 时，它一直说找不到文件？

> ID：12230735
> 
> 赞同：2
> 
> 时间：2012-09-01T19:29:32.140
> 
> 标签：java, android, eclipse

让 eclipse 编写 android 应用程序的唯一方法是从 android SDK 安装 Android Support Package（修订版 8、9 或 10）。我单击链接下载它，然后它告诉我：SDK Manager] File not found: C:\Program Files (x86)\Android\android-sdk\temp\support_r10.zip（访问被拒绝）。我不知道为什么会发生这种情况，在我解决这个问题之前我什至无法创建项目。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T19:50:10.867

这就是我解决问题的方法

脚步：

1.) 运行您的 Android SDK 管理器

2) 查找 Extras > support Library 并删除该特定库

![在此处输入图像描述](../Images/9092d939c1498b0393b3c9a729019800.png)

3) 现在重新启动 Android SDK 管理器

4) 下载 Extras > support Library present

现在尝试创建一个新项目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T00:39:02.733

请以管理员身份运行 SDK Manager。右键单击它并选择“以管理员身份运行”它应该然后安装它。

# php - 如何在php中比较两个没有年份的日期？

> ID：12230738
> 
> 赞同：3
> 
> 时间：2012-09-01T19:29:54.217
> 
> 标签：php

我想比较这两个日期，一个日期是 1921 年 8 月 2 日，第二个日期是现在日期。如何比较旧日期和现在日期的日期和月份。如果过去的日期是 9 月 2 日和现在的日期是 9 月 2 日等于它应该回显。我有将过去和现在日期与年份进行比较的脚本。如何在没有年份的情况下进行比较。？

```
$r1=$row['dateofcon']; 
```

//dateofcon 是 1921 年 8 月 2 日。

```
echo $r1; ?>
$cmg1 = strtotime("$r1");
$day1=date('l',$cmg1);
$now1 = time();
$timeleft1 = $cmg1-$now1;
$daysleft1 = round((($timeleft1/24)/60)/60); //probably...
if($daysleft1 == 0) { 
echo "Happy Conday";} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T19:39:15.383

可能最直接的方法是 strtotime 和 date。

```
$date1 = '1 Aug 2012';
$date2 = '1 Aug 1912';
if (date('m-d', strtotime($date1)) === date('m-d', strtotime($date2)) {

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:38:00.660

你为什么不把日期分成年、月和日？进而：

```
if (($month1 == $month2) && ($day1 == $day2)) {
  echo 'hi';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:43:47.007

如果您使用的是 PHP 5.3，则可以使用新的 DateTime 类：

```
$oDate1 = new DateTime( $datetime1 );
$oDate2 = new DateTime( $datetime2 );

if( $oDate1->format('m-d') == $oDate2->format('m-d')
  echo 'yes'; 
```

# linux - linux：如何在没有root权限的情况下获得无线ssid？

> ID：12230740
> 
> 赞同：5
> 
> 时间：2012-09-01T19:29:57.723
> 
> 标签：linux, ssid, iwconfig

有没有办法在没有 root 权限的情况下获取当前的无线 SSID？

iwconfig 告诉我 ESSID，但前提是我以 root 身份运行它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T03:16:48.167

如果您查看`iwconfig`( [wireless_tools](http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html) ) 的源代码，您会看到这一行：

```
iwconfig.c:639: if(iw_get_ext(skfd, ifname, SIOCGIWESSID, &wrq) < 0) 
```

该行负责获取 ESSID ( [wireless.h](http://lxr.free-electrons.com/source/include/linux/wireless.h?v=2.6.35#L271) )。而且我认为只有root才有权限（开箱即用）来执行此操作，因此调用的函数`iw_get_ext`（`iwlib.h`从`wireless_tools`包中定义）`ioctl`将返回`EPERM`（`Operation not permitted`）。

```
/*------------------------------------------------------------------*/
/*
 * Wrapper to extract some Wireless Parameter out of the driver
 */
static inline int
iw_get_ext(int                  skfd,           /* Socket to the kernel */
           const char *         ifname,         /* Device name */
           int                  request,        /* WE ID */
           struct iwreq *       pwrq)           /* Fixed part of the request */
{
  /* Set device name */
  strncpy(pwrq->ifr_name, ifname, IFNAMSIZ);
  /* Do the request */
  return(ioctl(skfd, request, pwrq));
} 
```

您有 2 个解决方案：

1.  使用`setuid`允许用户使用`iwconfig`命令：

    `sudo chmod u+s /sbin/iwconfig`

2.  您还可以尝试使用`CAP_NET_ADMIN`允许特定用户使用某些特定功能的功能进行一些黑客攻击。这里有一些关于`CAP_NET_ADMIN`：

[http://packetlife.net/blog/2010/mar/19/sniffing-wireshark-non-root-user/](http://packetlife.net/blog/2010/mar/19/sniffing-wireshark-non-root-user/)

[http://peternixon.net/news/2012/01/28/configure-tcpdump-work-non-root-user-opensuse-using-file-system-capabilities/](http://peternixon.net/news/2012/01/28/configure-tcpdump-work-non-root-user-opensuse-using-file-system-capabilities/)

[http://www.lids.org/lids-howto/node48.html](http://www.lids.org/lids-howto/node48.html)

[http://lwn.net/Articles/430462/](http://lwn.net/Articles/430462/)

最后，您可以使用`strace`跟踪所有系统调用并确认`ioctl`调用对此负责：

这样`root`做：

```
#strace /sbin/iwconfig your_interface_name > strace_iwconfig_root.log 
```

和**普通用户**一样：

```
$strace /sbin/iwconfig your_interface_name > strace_iwconfig_normal.log 
```

并比较结果。

# mysql - MySQL Alter 表添加与另一列唯一的列

> ID：12230741
> 
> 赞同：1
> 
> 时间：2012-09-01T19:30:03.197
> 
> 标签：mysql, sql

我有这样一张桌子：

```
+---------+--------------+------+-----+-------------------+-----------------------------+
| Field   | Type         | Null | Key | Default           | Extra                       |
+---------+--------------+------+-----+-------------------+-----------------------------+
| id      | int(11)      | NO   | PRI | NULL              | auto_increment              |
| url     | varchar(255) | YES  | UNI | NULL              |                             |
| ts      | timestamp    | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |
| content | longblob     | YES  |     | NULL              |                             |
| source  | varchar(255) | YES  |     | NULL              |                             |
| state   | int(11)      | NO   |     | 0                 |                             |
+---------+--------------+------+-----+-------------------+-----------------------------+ 
```

我希望 id 保留唯一的 PRIMARY KEY，并且我想添加字段“VERSION”，这将是唯一的。

我想要的是创建唯一的对（url，版本），但不是单独的。我怎样才能做到这一点？我应该像这样添加字段版本，更改 url 使其不是唯一的，然后添加约束吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:52:17.227

如果您要查找的是将同一 URL 的多个版本一起存储在表中，那么是的，您需要做的是：

1.  删除 URL 上的唯一约束
2.  添加非唯一列版本（此处假设整数）
3.  在（url，版本）上创建唯一约束或索引。我会建议一个索引，因为我认为这应该使唯一检查更快。

# c++ - 从粗到细的碰撞检测——同一物体上的多次碰撞

> ID：12230748
> 
> 赞同：0
> 
> 时间：2012-09-01T19:30:56.203
> 
> 标签：c++, data-structures, collision-detection, physics, simulation

我目前正在研究一种**碰撞检测算法**，该算法具有广泛的阶段来检测可能的碰撞，而精细的阶段则可以确定性地解决碰撞。**广泛阶段**基于分层哈希网格并且表现良好。

**精细阶段**基于自定义算法并使用**n-body 碰撞**。但是，为了准确解决多于 2 体的碰撞，我需要以某种方式注册所有碰撞和碰撞集中的相应元素。

**在广泛阶段以某种方式保存碰撞**以**迭代**精细阶段中的碰撞集的最佳方法是什么？我一直在思考某些数据结构的思路，但我还没有想出一个理想的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:58:05.900

看起来该论文的技术不适用于性能关键的情况。

似乎该技术试图解决一个对象可以“传送”到不同对象的另一侧而不会发生碰撞的情况，因为模拟中的移动对象通常只是在每次迭代中重新定位。

我建议改为将每个对象挤压到自上次更新以来它经过的任何空间。例如，一个向上移动的盒子会变成一个更高的盒子。

然后，您可以快速检测潜在的碰撞，而无需考虑运动甚至更新速率。然后可以根据需要仔细检查潜在的碰撞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:54:42.430

**我目前的做法**

在考虑了这个问题之后，我决定尝试以下方法。

*   碰撞集是元素的向量
*   碰撞集本身存储在一个列表中
*   每个元素都指向其在 hashmap 中的冲突集

如果现在在广泛阶段检测到碰撞：

1.  如果两个元素都不是哈希图中的键：
    *   为碰撞集创建一个新向量
    *   两个元素都添加到碰撞集中
    *   碰撞集被添加到碰撞列表中
    *   两个元素都作为冲突集的键插入到哈希图中
2.  如果一个元素是哈希图中的键：
    *   通过该元素检索碰撞集
    *   另一个元素被添加到碰撞集中
    *   另一个元素作为冲突集的键插入到 hashmap 中
3.  如果两个元素都是哈希图中的键：
    *   如果它们都指向同一个碰撞集，没关系
    *   如果它们指向不同的碰撞集
        *   创建新的碰撞集向量
        *   将两个碰撞集复制到新的碰撞集
        *   从碰撞列表中删除两个碰撞集
        *   将新的碰撞集添加到碰撞列表
        *   遍历新的冲突集并更新哈希图中每个元素的引用

在精细阶段，我现在可以简单地遍历碰撞列表中的所有碰撞集并进行精确的碰撞解决。

该解决方案相当快，但我有点担心内存占用。我将不得不做几个基准测试才能了解更多信息。

# google-play - 为什么我发布的应用程序不会在 google play/butik 中显示 upp

> ID：12230751
> 
> 赞同：0
> 
> 时间：2012-09-01T19:31:34.340
> 
> 标签：google-play

我已经将一个应用程序上传到谷歌播放，但两天后仍然找不到它可以下载。我不知道我的 AndroidManifest.xml 是否有任何问题，但我的 AndroidManifest.xml 来了：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.PforD.remmember.me"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Home"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="webbadd"></activity>
    <activity android:name="db_web_show"></activity>
    <activity android:name="who_is_this"></activity>
    <activity android:name="help_show"></activity>
    <activity android:name="request_answer"></activity>
    <activity android:name="delete"></activity>
</application> 
```

感谢任何帮助注册。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:03:59.837

它应该在那里，我想大约 6-8 小时后我就能找到我的应用程序

您可以手动搜索

[https://play.google.com/store/apps/details?id=org.lockerz.compare](https://play.google.com/store/apps/details?id=org.lockerz.compare)

用你的包名替换 org.lockerz.compare 并尝试打开链接

# ruby - ":foo" 在红宝石中是什么意思

> ID：12230752
> 
> 赞同：-3
> 
> 时间：2012-09-01T19:31:40.767
> 
> 标签：ruby

> **可能重复：**
> [Ruby 中的冒号运算符是什么？](https://stackoverflow.com/questions/6337897/what-is-the-colon-operator-in-ruby)

在学习 Ruby 时，我偶尔会遇到“：”运算符。通常我以以下形式看到它

```
:symbol => value 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-01T19:35:52.480

它只是表明它是一个符号而不是一个字符串。在 ruby​​ 中，通常使用符号而不是字符串。

```
{:foo => value}
{'foo' => value} 
```

它基本上是一种表达字符串的简写方式。它不能像您想象的那样包含空格，因此符号通常使用下划线。

自己试试这个：

```
foo = :bar
foo.to_s # means to string
baz = 'goo'
baz.to_sym # means to symbol 
```

# html - 链接到 ID 不起作用

> ID：12230758
> 
> 赞同：1
> 
> 时间：2012-09-01T19:32:18.647
> 
> 标签：html, anchor

我有一张图片，点击后我想将用户带到页面顶部（这是一个“返回顶部”链接。）

我已经使用下面的代码将使用 ID 的图像链接到我的“导航”div，因为有人告诉我这样做是正确的方法，但它什么也没做。

[现场直播](http://www.jamesperrett.co.uk/testsite)

**HTML**

```
<div id="navigation">
     stuff in here
</div> 
```

和

```
<!-- Back to top link -->
  <div class="bottom">
    <a href="#navigation">
      <img src="images/back_top.png" />
    </a>
  </div> 
```

这似乎没有做任何事情，我认为 name 属性已被弃用，因此应该使用 id 来代替，但这没有做任何事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:35:40.750

由于您的`#navigation`元素已定位，`position: fixed`因此它始终在屏幕上。您需要链接到将保留在文档顶部的元素。

您可以添加另一个元素，或`id`在正文中添加一个。或者，更改`position`导航以使其保持流畅。或者，您可以使用 JavaScript 动画滚动到顶部（例如使用 jQuery`.animate`和`scrollTop`属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:38:28.743

把这个：

```
<a name="top"> </a> 
```

`navigation`就在您的div之后/之前。

然后，改变

```
<a href="#navigation"> 
```

到

```
<a href="#top"> 
```

**PS：**查看页面源代码后，我建议您将其放在`<body>`标签之后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T19:43:37.410

您已将其链接到屏幕上已存在的内容（*固定***位置**）。链接它不是固定位置的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-13T16:40:20.163

只是为了让阅读本文的人把它扔在那里......链接到 A NAME 已被弃用，而不是最佳实践......从长远来看，链接到 ID 是最好的方法。

[http://www.w3.org/TR/html4/struct/links.html](http://www.w3.org/TR/html4/struct/links.html)

# linux - 在bash中将字符插入字符串？

> ID：12230762
> 
> 赞同：37
> 
> 时间：2012-09-01T19:32:59.343
> 
> 标签：linux, bash

我需要把字符串`"125959"`变成`"12:59:59"`.

显然，字符串是时间，所以正则表达式在这里不太好。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-09-01T19:42:32.237

```
time=125959
echo ${time:0:2}:${time:2:2}:${time:4:2} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-09-01T19:50:43.870

我喜欢`sed`：

```
time=125959
sed -e "s/\(..\)\(..\)\(..\)/\1:\2:\3/" <<< "$time" 
```

*   您可以通过替换`.`为`[[:digit:]]`
*   阅读`<<<`（*此处为字符串*）`man bash(1)`

# c++ - Prev_permutation vs Next_permutation 难度

> ID：12230763
> 
> 赞同：4
> 
> 时间：2012-09-01T19:33:03.620
> 
> 标签：c++, algorithm, sorting, permutation, probability

我正在尝试一个示例程序来掌握 prev 和 next 排列之间的区别。但是，我的程序似乎无法正常工作。我通过询问数组中元素的数量来启动程序，然后用一个简单的 for 循环构建数组

```
for(i = 0; i < x; i++)
        ptr[i] = i;

cout << "Possible permuations using prev_permutation: " << endl;
    do{
        for(i = 0; i < x; i++)
            cout << ptr[i] << " ";
        cout << endl;
    } while(prev_permutation(ptr, ptr+x));

cout << "Possible permuations using next_permutation: " << endl;
do{
    for(i = 0; i < x; i++)
        cout << ptr[i] << " ";
    cout << endl;
} while(next_permutation(ptr, ptr+x)); 
```

当我使用包含 3 个元素（0、1、2）的样本运行代码时。prev_permutation 给了我（0、1、2 等等）。然后 next_permutation 给我 (2, 1, 0)。但是，当我注释 prev_permutation 部分的代码时，当只有 next_permutation 运行时，我得到了集合（0、1、2）的正确 6 种不同排列。我似乎无法理解发生了什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T19:39:25.713

`prev_permutation`并按`next_permutation`字典（“字母”）顺序生成所有排列，`false`一旦循环完成，它们就会返回（即，如果在调用`prev_permutation`第一个排列之后或在调用`next_permutation`最后一个排列之后）。

发生的情况是，您按照字典顺序准备具有第一个排列的数组，然后调用`prev_permutation`. 然而，这是第一个，因此`prev_permutation`将数组设置为最后一个排列并返回`false`，因此您退出循环。

现在进入`next_permutation`循环，但数组的当前内容是按字典顺序排列的最后一个排列，因此`next_permutation`将设置第一个并返回 false。

如果您删除该`prev_permutation`部分，但循环 for`next_permutation`将从第一个开始，因此它将在返回之前正确生成所有 6 个排列`false`。

您可以考虑按顺序列出的所有排列并将当前配置作为此列表中的指针来可视化效果：

```
0-1-2 << you start here
0-2-1
1-0-2
1-2-0
2-0-1
2-1-0 
```

打电话的时候`next_permutation`你往下走，打电话的时候`prev_permutation`你往上走。当超出列表时，两个函数都会将指针移动到另一端并返回`false`以通知您这一事实。

如果您从`prev`move to `2-1-0`and function returns开始`false`，那么您调用`next`并且函数 move to`0-1-2`并`false`再次返回。

使用例如代替`0`,`1`以及`2`两个零和三个 1 的排列，字典顺序是：

```
0-0-1-1-1
0-1-0-1-1
0-1-1-0-1
0-1-1-1-0
1-0-0-1-1
1-0-1-0-1
1-0-1-1-0
1-1-0-0-1
1-1-0-1-0
1-1-1-0-0 
```

因此，要枚举所有这些，您需要从开始`0-0-1-1-1`并使用`next_permutation`，或者您需要从开始`1-1-1-0-0`并使用`prev_permutation`.

在这种情况下，调用`next_permutation`最后一个`1-1-1-0-0`将更改为第一个`0-0-1-1-1`并返回`false`；以类似的方式调用`prev_permutation`将更`0-0-1-1-1`改为`1-1-1-0-0`并会`false`因为翻转而返回。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T19:40:07.943

`prev_permutation`两者都考虑的所有排列都`next_permutation`具有明确定义的**字典顺序**。您提供给他们的数组在该顺序中有一些位置。

这就是为什么这两个函数都不能保证提供所有排列。

如果您提供了第一个可能的排列`prev_permutation`，那么在它之前将没有排列。同样，如果您的数组被定义为 (2, 1, 0)，则`next_permutation`不会提供任何新的排列。

**如果您需要某个集合的所有排列，则需要先`sort`收集该集合，然后再使用`next_permutation`.**

# android - 如何使用 Spring for Android 将原始 JSON 响应数据转换为模型对象的 ArrayList？

> ID：12230766
> 
> 赞同：0
> 
> 时间：2012-09-01T19:33:44.603
> 
> 标签：android, json, spring, rest, restlet

我正在使用 androidannotations 为 android 学习 spring，并且在将通过 HTTP Get 接收到的 JSON 数据转换为我的模型对象时遇到问题。

我有以下代码：

```
myRestClient.getRestTemplate().getMessageConverters().add(new GsonHttpMessageConverter());
ArrayList liveMatches = myRestClient.getLiveMatchesForUser((long) user_id); 
```

这个响应实际上只是`Match`对象列表的 JSON 表示。

如何将此原始 JSON 响应转换为`ArrayList<Match>`对象？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T00:47:32.053

这对我有用。

我创建了一个简单的类，它只是 ArrayList 数据结构的包装器。

就像是：

```
public class MatchesListWrapper {

public ArrayList<Match> matches;

public MatchesListWrapper(ArrayList<Match> matches) {
    this.matches = matches;
}

public ArrayList<Match> getMatches() {
    return matches;
}

public void setMatches(ArrayList<Match> matches) {
    this.matches = matches;
} 
```

}

# ajax - Selenium - 定位元素 - onunload=ajaxUnload

> ID：12230768
> 
> 赞同：1
> 
> 时间：2012-09-01T19:33:58.753
> 
> 标签：ajax, selenium, webdriver

我正在尝试从网站中查找元素。然而，WebDriver 似乎无法在`onunload=ajaxUnload()`标签之后加载元素。

任何帮助或提示我们如何在内部程序动态更改网站元素后“刷新”WebDriver？

我尝试过显式和隐式等待，但它不起作用（我已经等了 5 分钟）。它既不是新框架也不是窗口。

如果它有帮助，则代码类似于：

```
<*html>

<*head>

<*body onunload="ajaxUnload();" class="test">

<*script>

<*div id="selection"> 
```

# ruby - 将模块中的功能注入到类方法中

> ID：12230769
> 
> 赞同：0
> 
> 时间：2012-09-01T19:34:29.130
> 
> 标签：ruby, inheritance, module

我正在用 ruby​​ 做一个小项目，我想创建一个模块，我们称之为 Initializer，它修改所有混合它的类的初始化方法。这可能吗？默认情况下，类自己的 .initialize 函数会覆盖模块中的任何内容，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:28:01.897

有几种方法可以将您的代码插入初始化过程：[http ://www.ruby-doc.org/core-1.9.3/Class.html](http://www.ruby-doc.org/core-1.9.3/Class.html)

我的建议是：不要这样做！

将元编程用于花哨的东西。

# python - 将 JSON 参数强制为整数

> ID：12230770
> 
> 赞同：1
> 
> 时间：2012-09-01T19:34:31.020
> 
> 标签：python, json, pyramid

当我通过 AJAX 将数据作为 JSON 发布到服务器时，来自表单元素的值以字符串（unicode）的形式出现。这是一个简单的例子：

```
<select id="test">
  <option value=1>One</option>
  <option value=2>Two</option>
  <option value=3>Three</option>
</select> 
```

像这样向服务器发送数据：

```
$('test').change(function(){
  var id = $(this).val();
  $.ajax(
  {
    type: 'POST',
    contentType: 'application/json; charset=utf-8',
    url: someUrl,
    data: JSON.stringify(id:id),
    dataType: 'json',
    success: doSomething
  }); 
```

然后在服务器上（Pyramid 1.3.3）：

`log.debug(type(request.json_body['id']))`给`<type 'unicode'>`

这使得代码类似于`if request.json_body['id'] == 2`False，因为该值实际上是 u'2'。

我一直在`id = int(request.json_body['id'])`为所有应该是整数的参数做，但是有更好的方法吗？我觉得我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:45:15.747

不，这是正确的。无论您希望最终用户输入什么内容，网页中的表单元素值始终是字符串。

不过，您可以使用[collander](http://docs.pylonsproject.org/projects/colander/en/latest/)在服务器端自动进行转换。你指定一个模式，传入解码后的 JSON 数据结构，然后得到一个很好的 Python 结构，完全验证。

反序列化整数的最简单示例：

```
>>> import colander
>>> id = colander.SchemaNode(colander.Integer())
>>> id.deserialize('1')
1 
```

但是 colander 可以处理映射、序列、布尔值、日期时间对象等等。

# java - 类文件中不兼容的魔法值 1768713317

> ID：12230774
> 
> 赞同：5
> 
> 时间：2012-09-01T19:35:03.927
> 
> 标签：java

我有一个类文件，当我在网站上时，会出现以下消息：

> 类文件“spectrum”中不兼容的魔法值 1768713317。

这个神奇的值是什么意思？请帮忙 ：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T19:39:10.643

文件的前四个字节`.class`（编译的 Java 二进制文件）应该是`0xCAFEBABE`- 所谓的*魔法值*。

在您的情况下，这些是ASCII 中的`1768713317`or `0x696C6C65`or `"ille"`( *ille...gal* ?) 。很可能一些 JVM 试图打开一个认为这是字节码的文件，而它实际上是一个文本文件。也许应该下载类但服务器返回一些错误？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-01T19:39:38.897

幻数是每个已编译 Java 类的前 4 个字节。这是已编译 Java 类的结构：

```
ClassFile {
    u4             magic;
    u2             minor_version;
    u2             major_version;
    u2             constant_pool_count;
    cp_info        constant_pool[constant_pool_count-1];
    u2             access_flags;
    u2             this_class;
    u2             super_class;
    u2             interfaces_count;
    u2             interfaces[interfaces_count];
    u2             fields_count;
    field_info     fields[fields_count];
    u2             methods_count;
    method_info    methods[methods_count];
    u2             attributes_count;
    attribute_info attributes[attributes_count];
} 
```

'magic' 应始终等于：`0xCAFEBABE`。它告诉 JVM：“嘿！我是一个 Java 类，你可以执行我的代码！”。当 JVM 读取文件并且幻数无效时，它不会执行它。

# javascript - jQuery没有替换一些文本

> ID：12230776
> 
> 赞同：0
> 
> 时间：2012-09-01T19:35:10.777
> 
> 标签：javascript, jquery

我一直在做一个涉及 ajax 的项目；它是学校作业的计划者。当按下按钮时，它应该根据从服务器获取的数据更改 31 `<textarea>`（和 one ）内的文本。`<span>`问题是，上次刷新窗口后更改的文本区域不会更改。我查看了服务器和网页之间发送的 JSON，反之亦然，得出的结论是错误在 ajax 调用的成功函数中。这是代码：

```
 success: function(data) {                
    $("span#date").text(data['date']);
    $("#assignments").find("textarea").each(function() {
      $(this).text("");
      $(this).html(data[$(this).attr("id")]);
    });
    console.log(data); // I was using this to see if the data received from the server was correct
  } 
```

非常感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:39:32.200

你应该使用`.val()`textarea 因为它基本上是一个输入。

您不能在其中真正包含 html 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T19:45:30.313

尝试`$(textarea).val()`代替`.html()`. 我注意到 html 仅在第一次呈现 textarea 时才有效。

# php - Ajax 提交到数据库的问题

> ID：12230784
> 
> 赞同：0
> 
> 时间：2012-09-01T19:36:20.763
> 
> 标签：php, ajax, database

我有这个表格：

```
<form method = \"get\" action = \"\" onsubmit = \"return addBeer('$user','$id','$name','$abv','$ibu','$icon','$style','$brewery','$breweryID','$icon')\" >

<p> <input type = \"submit\" value = \"Go Fishing\" /> </p>

</form> 
```

它调用这个 JavaScript 函数：

```
function addBeer(user,id,bname,abv,ibu,icon,bstyle,brewery,breweryID,icon)
        {
            //get elements

            alert('userID' + user);

            alert('beerid'+id); 

            alert('beername'+bname);        

            alert('style'+bstyle);

            alert('brewery'+brewery);

            alert('abv'+abv);

            alert('ibu'+ibu);

            alert('brewery id'+ breweryID);

            alert('icon'+icon);

            //run ajax
            var ajaxSettings2 = 
            {
                type: "POST",
                url: "addBeer.php",
                data: "uID="+user+"&bID="+id+"&bName="+bname+"&bStyle="+bstyle+"&bBrewery="+brewery+"&abv="+abv+"&ibu="+ibu+"&breweryID="+breweryID,
                success: function() 
                {
                    $('#sbutton').remove();
                    alert('Load was performed.');
                },

                error: function(xhr, status, error) { alert("error: " + error); }   };
            $.ajax(ajaxSettings2);

        } 
```

所有的警报都有效，所以我知道信息是从表单传递给函数的，但是它在对 addBeer.php 的 ajax 调用中失败，因为它运行错误函数并弹出错误警报。不幸的是，弹出窗口中没有任何报告。

这是为添加到数据库而调用的 addBeer.php 文件：

```
<?php

                require_once('myConnectDB.inc.php');
                require_once('page.inc.php');

                session_start();

                        //add beer to database code
                        $userID = $_POST['uID'];
                        $beerName = $_POST['bName'];
                        $beerID = $_POST['bid'];
                        $brewery = $_POST['bBrewery'];
                        $style = $_POST['bStyle'];

                        $abv = $_POST['abv'];
                        $ibu = $_POST['ibu'];
                        $breweryID = $_POST['breweryID'];
                        //$icon = $_POST['icon'];

                        //get brewery icon
                        $uri3 = "http://api.brewerydb.com/v2/brewery/$breweryID?key=myKey&format=json";
                        $response3 = file_get_contents($uri3);
                        //parse xml
                        $myBrew = json_decode($response3);
                        $iconBrew = $myBrew->data->images->medium;

                        //add above data to database
                        $db = new myConnectDB();

                        $beerName = $db->real_escape_string($beerName);
                        $beerID = $db->real_escape_string($beerID);
                        $brewery = $db->real_escape_string($brewery);
                        $style = $db->real_escape_string($style);
                        $userID = $db->real_escape_string($userID);
                        $abv = $db->real_escape_string($abv);
                        $ibu = $db->real_escape_string($ibu);
                        $breweryID = $db->real_escape_string($breweryID);           
                        $icon = $db->real_escape_string($icon); 

                        $query3 = "INSERT INTO tableName (userID,beerID,beerName,beerStyle,beerBrewery,abv,ibu,breweryID,icon, brewIcon) VALUES ($userID, '$beerID', '$beerName', '$style' , '$brewery', '$abv','$ibu','$breweryID', '$icon', '$iconBrew')";
                        $db->query($query3);

                ?> 
```

为了安全起见，我取出了我的 api 密钥和表名。

我在检查元素下检查了 chrome 中的网络选项卡，当我单击 addBeer.php 调用并在标题下查看时，它在表单数据中显示正在传递信息。

**更新：**

我正在转义我的引号，因为它是从 php 打印的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:13:03.627

经过无数次的挫折，我发现了我的问题。我发送的信息，我从另一个数据库查询，所有这些信息并不总是完整的。

如果我单击提交并且函数调用中的一个变量是一个空字符串，它不喜欢它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T19:41:56.317

您的方法`GET`与表单一样，但`POST`在您的 Ajax 中。

# c - c 程序中的双重释放或损坏 (!prev) 错误

> ID：12230788
> 
> 赞同：32
> 
> 时间：2012-09-01T19:37:12.343
> 
> 标签：c, free

运行 ac 程序时出现以下错误：

```
*** glibc detected *** ./a.out: double free or corruption (!prev): 0x080b8008 *** 
```

我相信这是由于在程序结束时调用了 free() ，但我无法弄清楚在此之前 malloc 的内存在哪里被释放。这是代码：

```
#include <stdio.h>
#include <stdlib.h> //malloc
#include <math.h>  //sine

#define TIME 255
#define HARM 32

int main (void) {
    double sineRads;
    double sine;
    int tcount = 0;
    int hcount = 0;
    /* allocate some heap memory for the large array of waveform data */
    double *ptr = malloc(sizeof(double *) * TIME);
    if (NULL == ptr) {
        printf("ERROR: couldn't allocate waveform memory!\n");
    } else {
        /*evaluate and add harmonic amplitudes for each time step */
        for(tcount = 0; tcount <= TIME; tcount++){
            for(hcount = 0; hcount <= HARM; hcount++){
                sineRads = ((double)tcount / (double)TIME) * (2*M_PI); //angular frequency
                sineRads *= (hcount + 1); //scale frequency by harmonic number
                sine = sin(sineRads); 
                *(ptr+tcount) += sine; //add to other results for this time step
            }
        }
        free(ptr);
        ptr = NULL;     
    }
    return 0;
} 
```

这是编译的：

```
gcc -Wall -g -lm test.c 
```

瓦尔格林：

```
valgrind --leak-check=yes ./a.out 
```

给出：

```
 ==3028== Memcheck, a memory error detector
==3028== Copyright (C) 2002-2009, and GNU GPL'd, by Julian Seward et al.
==3028== Using Valgrind-3.6.0.SVN-Debian and LibVEX; rerun with -h for copyright info
==3028== Command: ./a.out
==3028== 
==3028== Invalid read of size 8
==3028==    at 0x8048580: main (test.c:25)
==3028==  Address 0x41ca420 is 1,016 bytes inside a block of size 1,020 alloc'd
==3028==    at 0x4024F20: malloc (vg_replace_malloc.c:236)
==3028==    by 0x80484F8: main (test.c:15)
==3028== 
==3028== Invalid write of size 8
==3028==    at 0x8048586: main (test.c:25)
==3028==  Address 0x41ca420 is 1,016 bytes inside a block of size 1,020 alloc'd
==3028==    at 0x4024F20: malloc (vg_replace_malloc.c:236)
==3028==    by 0x80484F8: main (test.c:15)
==3028== 
==3028== 
==3028== HEAP SUMMARY:
==3028==     in use at exit: 0 bytes in 0 blocks
==3028==   total heap usage: 1 allocs, 1 frees, 1,020 bytes allocated
==3028== 
==3028== All heap blocks were freed -- no leaks are possible
==3028== 
==3028== For counts of detected and suppressed errors, rerun with: -v
==3028== ERROR SUMMARY: 8514 errors from 2 contexts (suppressed: 14 from 7) 
```

我对不能自动管理自己的内存的语言没有太多经验（因此在 c 中做这个练习来学习一点）但是我被卡住了。任何帮助，将不胜感激。

该代码应该是加法音频合成器的一部分。在这方面它确实有效并给出了存储在 ptr 中的正确输出。

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-01T19:39:08.117

> ```
> double *ptr = malloc(sizeof(double *) * TIME);
> /* ... */
> for(tcount = 0; tcount <= TIME; tcount++)
>                          ^^ 
> ```

*   你越界了。更改或 `<=`分配元素`<``SIZE + 1`
*   你`malloc`错了，你会想要`sizeof(double)`而不是 `sizeof(double *)`
*   作为`ouah`评论，虽然与您的腐败问题没有直接联系，但您在使用`*(ptr+tcount)`时没有初始化它

* * *

*   就像样式注释一样，您可能想要使用`ptr[tcount]`而不是`*(ptr + tcount)`
*   你真的不需要`malloc`+`free`因为你已经知道了`SIZE`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-01T19:39:39.893

更改此行

```
double *ptr = malloc(sizeof(double *) * TIME); 
```

至

```
double *ptr = malloc(sizeof(double) * TIME); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-01T19:46:26.183

1 - 你的 malloc() 是错误的。
2 - 您超出了分配内存的范围
3 - 您应该初始化分配的内存

这是包含所有所需更改的程序。我编译并运行...没有错误或警告。

```
#include <stdio.h>
#include <stdlib.h> //malloc
#include <math.h>  //sine
#include <string.h>

#define TIME 255
#define HARM 32

int main (void) {
    double sineRads;
    double sine;
    int tcount = 0;
    int hcount = 0;
    /* allocate some heap memory for the large array of waveform data */
    double *ptr = malloc(sizeof(double) * TIME);
     //memset( ptr, 0x00, sizeof(double) * TIME);  may not always set double to 0
    for( tcount = 0; tcount < TIME; tcount++ )
    {
         ptr[tcount] = 0; 
    }

    tcount = 0;
    if (NULL == ptr) {
        printf("ERROR: couldn't allocate waveform memory!\n");
    } else {
        /*evaluate and add harmonic amplitudes for each time step */
        for(tcount = 0; tcount < TIME; tcount++){
            for(hcount = 0; hcount <= HARM; hcount++){
                sineRads = ((double)tcount / (double)TIME) * (2*M_PI); //angular frequency
                sineRads *= (hcount + 1); //scale frequency by harmonic number
                sine = sin(sineRads); 
                ptr[tcount] += sine; //add to other results for this time step
            }
        }
        free(ptr);
        ptr = NULL;     
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-01T19:43:35.740

我没有检查所有代码，但我的猜测是错误在 malloc 调用中。你必须更换

```
 double *ptr = malloc(sizeof(double*) * TIME); 
```

为了

```
 double *ptr = malloc(sizeof(double) * TIME); 
```

因为您想为双精度分配大小（而不是指向双精度的指针的大小）。

# javascript - JavaScript：在嵌套循环中分配给数组

> ID：12230790
> 
> 赞同：0
> 
> 时间：2012-09-01T19:37:27.267
> 
> 标签：javascript

我正在学习关于数组的 codecademy.com 课程。我应该编写嵌套循环来将每张花色的每张卡片放在一个数组中的一副卡片中。

我真的把这搞砸了。这是我尝试过的一种不起作用的组合。唯一表明我有点接近的迹象是它返回“52”，因此至少有 52 个对象进入数组。谁能指出我做错了什么？

```
 //array 1: the suits
var suits = ["clubs","hearts","diamonds","spades"];

//array 2: the ranks
var ranks = [2,3,4,5,6,7,8,9,10,"J","Q","K","A"];

//using for loops, modify the "deck" array so that it becomes a 
//two-dimensional array that stores every card in the deck; 
//e.g. [1, "clubs"], [2, "clubs"],etc...["A", "spades"]
var deck = [];

for(i = 0; i < suits.length; i++){
    for (j = 0; j < ranks.length; j++){
        var cardArray = [];
        cardArray[0] = suits[i];
        cardArray[0][0] = ranks[j];
        deck.push(cardArray);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:46:06.820

每次迭代，都会将一个新数组添加到甲板上，如下所示：

卡片数组：[ [ 等级 [j] ] ]

当 cardArray[0][0] 被设置时，它会将 cardArray[0] 覆盖为一个索引为 0 且包含 rank[j] 的数组。相反，将 cardArray[0] 设置为花色，并将 cardArray[1] 设置为等级。

```
cardArray[0] = suits[i];
cardArray[1] = ranks[j];
deck.push(cardArray); 
```

这导致：

```
for (var i = 0; i < suits.length; i++){
    for (var j = 0; j < ranks.length; j++){
        var cardArray = [];
        cardArray[0] = suits[i];
        cardArray[1] = ranks[j];
        deck.push(cardArray);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:47:33.333

您应该为循环计数器使用`var`声明。您有问题的代码是

```
cardArray[0] = suits[i];
cardArray[0][0] = ranks[j]; 
```

做类似的事情

```
var foo = "clubs";
foo[0] = "J"; 
```

这显然是行不通的。我想你想要的是

```
var deck = [];

for(var i = 0; i < suits.length; i++){
    var cardArray = [];
    for (j = 0; j < ranks.length; j++){
        var twoCards = [];
        twoCards[0] = suits[i];
        twoCards[1] = ranks[j];
        cardArray.push(twoCards);
 //     // or the same thing as this loop body, shorter:
 //     cardArray.push([suits[i], ranks[j]]);
    }
    deck.push(cardArray);
} 
```

# mvvm - 没有代码的纯 MVVM

> ID：12230791
> 
> 赞同：1
> 
> 时间：2012-09-01T19:37:37.690
> 
> 标签：mvvm

我对避免背后代码中的代码的方法很感兴趣。在我看来，有些情况下代码必须放在代码后面。例如：我有一个未定义列数的网格。无法绑定列。所以最简单的方法是在后面的代码中生成列。

对于这种情况，我可以创建一个继承自网格的新类。这个新类具有用于列绑定的新绑定属性和代码。代码在可在 XAML 中使用的自定义类中分离。然后，我可以轻松地将列绑定到我新创建的属性。并且视图后面没有代码。

这是个好主意吗？您将如何解决此类（或类似）问题？还有其他方法可以从后面的代码中提取代码吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:46:18.733

拥有免费 xaml.cs 背后的代码并将代码转移到新类并不意味着它的纯 MVVM。这个想法是您将拥有 ViewModel 中的所有逻辑，因此免费 View 背后的代码有助于单元测试。查看特定逻辑（如颜色和动画）无法进行单元测试，因此它位于自定义控件或继承控件中或直接在 xaml.cs 中都无关紧要。只要您通过 UnitTesting 测试大部分用户交互和视图逻辑，您就应该为自己做得很好而感到高兴。

# php - Zend_Form 错误信息

> ID：12230797
> 
> 赞同：1
> 
> 时间：2012-09-01T19:38:03.217
> 
> 标签：php, zend-framework, zend-form-element

我的 zend_form 有一个自定义标记，我尝试为我的输入字段设置一个 css 类（ **class="hasErrors" ）。**我渲染的表单元素如下所示：

```
<div id="teamname-element" class="formRow">
    <input type="text" name="teamname" id="teamname" value="" placeholder="Teamname">
</div> 
```

有错误它看起来像这样：

```
<div id="teamname-element" class="formRow">
    <input type="text" name="teamname" id="teamname" value="" placeholder="Teamname">
    <ul class="errors">
        <li>Your teamname is to short!</li>
    </ul>
</div> 
```

是否可以在不使用 javascript 的情况下为输入字段设置 css 类？

```
<input class="hasErrors" type="text" name="teamname" id="teamname" value="" placeholder="Teamname"> 
```

一个表单元素是这样创建的：

```
$this->addElement(new Nut_Form_Element_Text('teamname', array(
    'Label'      => 'Teamname',
    'validators' => array( array('StringLength', FALSE, array(1, 25)), $TeamRegex),
    'filters'    => array('StringTrim', 'StripTags'),
))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:43:43.637

这里我们创建一个扩展 Zend_Form 的表单类。我们重写 isValid() 方法。如果 hasErrors() 方法返回 true，我们遍历 form->elements 并添加一个“错误”类。我们还使用 getAttrib() 方法检查类属性是否已经存在，如果存在，我们使用空格分隔“错误”类。

```
class MyForm extends Zend_Form
{
    public function isValid($data)
    {
        $valid = parent::isValid($data);

        foreach ($this->getElements() as $element) {
            if ($element->hasErrors()) {
                $oldClass = $element->getAttrib('class');
                if (!empty($oldClass)) {
                    $element->setAttrib('class', $oldClass . ' hasError');
                } else {
                    $element->setAttrib('class', 'hasError');
                }
            }
        }

        return $valid;
    }
} 
```

现在，当您调用 isValid 方法时，它会自动为任何未通过验证的字段添加一个错误类。

# haskell - Haskell：a -> a 类型函数的示例，除了标识

> ID：12230820
> 
> 赞同：23
> 
> 时间：2012-09-01T19:39:50.217
> 
> 标签：haskell, types, type-inference, type-variables

我刚刚开始玩一点Haskell......我想写一个相同类型的身份函数。显然，不等同于它。那会是这样的，

`myfunction :: a -> a`

我想不出一个参数和返回类型相同并且几乎可以是任何东西的例子（这排除了使用 Haskell 的 Typeclasses 的可能性）。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-01T19:53:05.553

`undefined`如果不使用另一位提到的评论者，这是不可能的。让我们通过反例来证明它。假设有这样一个函数：

```
f :: a -> a 
```

当您说这与 不同时`id`，这意味着您无法定义：

```
f x = x 
```

但是，考虑`a`type的情况`()`：

```
f () = ... 
```

唯一可能`f`返回的结果是`()`，但这将是与 相同的实现`id`，因此是矛盾的。

更复杂和严格的答案是表明类型`a -> a`必须同构于`()`. 当我们说两种类型`a`并且`b`是同构的时，这意味着我们可以定义两个函数：

```
fw :: a -> b
bw :: b -> a 
```

...这样：

```
fw . bw = id
bw . fw = id 
```

当第一种类型是`a -> a`，第二种类型是时，我们可以很容易地做到这一点`()`：

```
fw :: (forall a . a -> a) -> ()
fw f = f ()

bw :: () -> (forall a . a -> a)
bw () x = x 
```

那么我们可以证明：

```
fw . bw
= \() -> fw (bw ())
= \() -> fw (\x -> x)
= \() -> (\x -> x) ()
= \() -> ()
= id

bw . fw
= \f -> bw (fw f)
-- For this to type-check, the type of (fw f) must be ()
-- Therefore, f must be `id`
= \f -> id
= \f -> f
= id 
```

当您证明两种类型是同构的时，您知道的一件事是，如果一种类型包含有限数量的元素，那么另一种也必须如此。由于该类型`()`只包含一个值：

```
data () = () 
```

这意味着该类型`(forall a . a -> a)`也必须只包含一个值，而这恰好是`id`.

编辑：有些人评论说同构的证明不够严格，所以我将调用米田引理，当翻译成 Haskell 时，它对任何函子说`f`：

```
(forall b . (a -> b) -> f b) ~ f a 
```

Where`~`意味着它`(forall b . (a -> b) -> f b)`与`f a`. 如果您选择`Identity`函子，这将简化为：

```
(forall b . (a -> b) -> b) ~ a 
```

...如果您选择`a = ()`，这将进一步简化为：

```
(forall b . (() -> b) -> b) ~ () 
```

你可以很容易地证明它`() -> b`同构于`b`：

```
fw :: (() -> b) -> b
fw f = f ()

bw :: b -> (() -> b)
bw b = \() -> b

fw . bw
= \b -> fw (bw b)
= \b -> fw (\() -> b)
= \b -> (\() -> b) ()
= \b -> b
= id

bw . fw
= \f -> bw (fw f)
= \f -> bw (f ())
= \f -> \() -> f ()
= \f -> f
= id 
```

所以我们可以使用它来最终将米田同构特化为：

```
(forall b . b -> b) ~ () 
```

这表示任何类型`forall b . b -> b`的函数都与`()`. 米田引理提供了我的证明缺失的严谨性。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-01T21:05:44.207

让我制定一个详细说明 dbaupp 评论的答案。任何类型的函数`a -> a`也会产生一个类型的函数`() -> ()`，所以我先看看这个子问题。

Haskell 类型和函数的通常语义将类型表示为指向链完整的偏序，并将函数表示为连续函数。类型`()`由两个元素集*{⊥,()} 表示*，顺序为*⊥⊏()*。在普通集合论中，从这个集合到自身有 2^2=4 个函数，但其​​中只有三个是连续的：

*   f1: ⊥ ↦ ⊥, () ↦ ⊥,
*   f2: ⊥ ↦ ⊥, () ↦ (), 和
*   f3: ⊥ ↦ (), () ↦ ()。

所以在我们的语义模型中， type 有三种不同的功能`() -> ()`。但是其中哪些可以在 Haskell 中实现呢？他们都是！

*   `f1 _ = undefined`（或`f1 x = f1 x`）
*   `f2 x = x`（或`f2 = id`）
*   `f3 _ = ()`（或`f3 = const ()`）

查看这些定义，您可以看到`f1`并且`f2`也可以用于定义 type 的函数`a -> a`。由于他们已经在做不同的事情`()`，所以他们是不同的。所以我们至少有两个不同的 type 函数`a -> a`。

在上面的语义模型中，还有很多 type 的函数`a -> a`，但是这些函数在 Haskell 中是无法表达的（这与参数化和 Wadler 的[Free 定理有关](http://homepages.inf.ed.ac.uk/wadler/papers/free/free.ps)）。正确证明`f1`并且`f2`是唯一这样的函数似乎并不容易，因为它取决于 Haskell 语言不允许的内容（例如，参数类型没有模式匹配）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-01T19:52:52.503

除非您愿意使用 undefined 或 bottom（非终止表达式），否则实际上没有其他函数可以满足该类型。

这是 Haskell 类型系统的一大优势。可以强烈限制可以通过编译器传递给显然正确的函数。举一个极端的例子，见[djinn——](http://hackage.haskell.org/packages/archive/djinn-th/0.0.1/doc/html/Language-Haskell-Djinn.html)它接受一个类型，并生成与该类型匹配的可能函数。即使是真实的、复杂的例子，这个列表通常也很短。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-02T13:08:09.610

这里的关键是要了解我们对 . 什么*都不*知道`a`，尤其是我们无法生成一个新的或将其转换为不同的东西。因此，我们别无选择返回它（或底部值）。一旦我们有了*更多*关于`a`（例如上下文绑定）的信息，我们就可以用它做更多有趣的事情：

```
f :: Monoid a => a -> a
f _ = mempty 
```

或者

```
f :: Monoid a => a -> a
f x = x `mappend` x `mappend` x 
```

或者，如果您有类似 in 的选择`f :: (a, a) -> a`，您有两种可能的实现（再次忽略底部值），但`f :: (a, b) -> a`您又回到了一个实现，这与 for 相同`fst`：虽然`f`使用一对相同的类型调用是有效的，例如`f ("x", "y")`，您可以确定它的`f`行为类似于`fst`，因为在实现中`f`您无法测试两种参数类型是否相同。同样，只有一个非底层版本的`f :: (a -> b) -> a -> b`.

多态性限制了自由度，因为你对你的论点一无所知，在某些情况下，它归结为一个非底层版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-02T16:54:09.523

正如其他人所提到的，不存在这样的其他*总*功能。（如果我们不将自己限制在总功能上，那么我们可以通过 . 来居住任何类型`undefined`。）

我将尝试基于 λ 演算给出一个理论解释：

为简单起见，让我们将自己限制在 λ 项（我们可以将任何 Haskell 表达式翻译成它）。对于 λ 项，如果不是应用程序（也可以为零），`M`我们称它为*头。*请注意，如果是[正常形式](https://en.wikipedia.org/wiki/Lambda_calculus#Normal_forms_and_confluence)，则不能是 λ-抽象，除非.`A`*`M ≡ A N1 ... Nk``A``k``M``A``k = 0`*

 *所以让`M :: a -> a`成为范式的 λ-项。由于我们在上下文中没有变量，`M`因此不能是变量，也不能是应用程序。如果是，它的头部就必须是一个变量。所以`M`一定是λ-抽象，一定是`M ≡ λ(x:a).N`。

现在`N`必须是类型的`a`，正式的`{x:a}⊢N:a`。如果`N`是 λ-抽象，则其类型为`σ -> τ`，这是不可能的。如果`N`是一个函数应用程序，那么它的 head 必须是一个变量，而我们在上下文中唯一的一个是`x`. 但是因为`x:a`，我们不能应用于`x`任何东西，`x P`所以不能对任何 P 进行录音。所以唯一的可能性是`N ≡ x`。所以，`M`一定是`λ(x:a).x`。

[（如果可能，请更正我的英语。特别是，我不确定如何使用[虚拟语气](https://en.wikipedia.org/wiki/English_subjunctive)权利）。]*

# c# - 如何在 C# 中反序列化 json 对象

> ID：12230822
> 
> 赞同：0
> 
> 时间：2012-09-01T19:40:03.123
> 
> 标签：c#, javascript, jquery, json

我正在尝试将 json 字符串反序列化为 ac# 对象。

```
string str ="[{ \"foo\" : \"A\" , \"bar\" : \"B\"}, { \"foo\" : \"C\" , \"bar\" : \"D\"}]";

public Class Example
{
  public string foo { get; set; }
  public string bar { get; set; }
}

JavaScriptSerializer Js = new JavaScriptSerializer();
Example[] ex = (Example[]) Js.DeserializeObject(str); 
```

但我得到一个`InvalidCast Exception`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T19:43:56.923

```
var list = new JavaScriptSerializer().Deserialize<List<FooBar>>(str);

public class FooBar
{
    public string foo;
    public string bar;
} 
```

# html - 表格字体间距

> ID：12230827
> 
> 赞同：-1
> 
> 时间：2012-09-01T19:40:46.757
> 
> 标签：html, css, html-table

如何让我的表格间距稍微好一些，这样单词就不会像这个屏幕截图中那样相互重叠：

我只是使用通用表格 HTML 编码。`tr`尝试使用标签进行间距和填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:50:26.857

表格间距没有问题，您需要增加`line-height`文本。

# c - c字符串数组比较

> ID：12230832
> 
> 赞同：0
> 
> 时间：2012-09-01T19:41:08.630
> 
> 标签：c, arrays, string, compare

在 C 中工作，我正在用函数的 char* 返回值填充数组

```
 char* files[4][12];
 int i = 0;
 for (;;)
    {
      char* file = get_value();
      strcpy(files[i],file);
      i++;
      if (i > 4 || external_condition)
      break;

     }

      // When I break out of
      // my for loop the following
      // code executes

      for (i = 0; i < 5; i++)
       {
        if (files[i] != NULL)
        manipulate(files[i]);
       } 
```

我的问题是，如果我在没有为文件的所有元素分配值的情况下跳出第一个 for 循环，那么我在第二个 for 循环中的比较将失败。如果只有文件[0] 和文件[1] 有内容，则循环无论如何都会处理文件[2]、文件[3] 和文件[4]。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:48:12.967

`files`被声明为“指向 char 的指针数组的数组”。或者，如果您愿意，可以将其作为指向 char 的指针的二维数组。

“指向char的指针数组”类型也是如此`files[i]`，但您将其仅用作“指向char的指针”。那是错的。

也就是说，目前尚不清楚你想做什么......也许只是：

```
char files[5][13]; 
```

会更有意义。13，因为您可能需要 13 个字符字符串（8.3 是 8+3+1=12 加上 1 作为结尾的 NUL），并且您似乎使用了其中的 5 个。然后将它们初始化为零：

```
memset(files, 0, sizeof(files)); 
```

并使用检查：

```
if (files[i][0]) 
```

检查文本是否已初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:05:58.837

`char* files[4][12]`是 的二维数组`char *`，不是`char`。也许你的意思是你的代码如下......我建议你听听别人怎么说。我只是发布一个仍然有效的缩短版本。

```
char files[5][12] = { { 0 } };
int i = 0;

do {
  strcpy(files[i], get_value());
} while (++i <= 4 && !external_condition);

while (i) {
  manipulate(files[--i]);
} 
```

# c# - 如何将信息文本写入带有颜色的日志文件？

> ID：12230837
> 
> 赞同：0
> 
> 时间：2012-09-01T19:42:19.237
> 
> 标签：c#

今天我将日志写入文本文件日志：

```
/*----------------------------------------------------------------
 * Module Name  : Logger
 * Description  : A logger
 * Author       : Danny
 * Date         : 10/02/2010
 * Revision     : 1.00
 * --------------------------------------------------------------*/

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Windows.Forms;
using System.Drawing;
using System.Threading;
/*
 *  Introduction :
 * 
 *  This module is a logger. any module can use this 
 *  module to log its actions.
 * 
 * 
 * */

        /*----------------------------------------
         *   P R I V A T E    D E F I N I T I O N S 
         * ---------------------------------------*/

namespace DannyGeneral
{
    class Logger
    {
        /*----------------------------------------
         *   P R I V A T E     C O N S T A N T S 
         * ---------------------------------------*/
        static string log_file_name = @"\logger.txt";
        static string full_path_log_file_name;
        static string path_log;
        static Mutex mut;
        /*----------------------------------------
         *   P R I V A T E     V A R I A B L E S 
         * ---------------------------------------*/

        /*---------------------------------
         *   P U B L I C   M E T H O D S 
         * -------------------------------*/

        /*----------------------------------------------------------
         * Function     : Logger
         * Description  : static Constructor
         * Parameters   : none
         * Return       : none
         * --------------------------------------------------------*/
        static Logger()
        {
            mut = new Mutex();
            path_log = Path.GetDirectoryName(Application.LocalUserAppDataPath)+ @"\log";
            if (!Directory.Exists(path_log))
            {
                Directory.CreateDirectory(path_log);
            }
            full_path_log_file_name = path_log + log_file_name;
        }

        /*----------------------------------------------------------
         * Function     : Write
         * Description  : writes a string to the log file
         *                This functions will add time and date and
         *                end of line chars to the string written to
         *                the file.
         * Parameters   : string to write to the file.
         * Return       : none
         * --------------------------------------------------------*/
        public static void Write(string str)
        {
            if (mut.WaitOne() == false)
            {
                return;
            }
            else
            {

                using (StreamWriter sw = new StreamWriter(full_path_log_file_name, true))
                {
                    sw.Write(DateTime.Now.ToShortDateString() + "--" + DateTime.Now.ToShortTimeString() + " ==> " + str);
                    sw.WriteLine();
                    sw.Close();
                }
            }
            mut.ReleaseMutex();
        }
        public static void exist()
        {
            if (!File.Exists(path_log + log_file_name))
            {
                StreamWriter sw = new StreamWriter(path_log + log_file_name);
                sw.Write(DateTime.Now.ToShortDateString()+"--"+DateTime.Now.ToShortTimeString()+" ==> "+"First Time The Log File Was Created"+Environment.NewLine);
                sw.WriteLine();
                sw.Close();
            }
        }
        public static void newEmptyLine()
        {
            StreamWriter sw = new StreamWriter(path_log + log_file_name,true);
            sw.WriteLine();
            sw.Close();
        }

        public static string LoggerPath()
        {
            string path = path_log + log_file_name;
            return path;
        }

        /*---------------------------------
         *   P R I V A T E    M E T H O D S 
         * -------------------------------*/

    }

} 
```

而是将它写入一个简单的文本文件并在程序运行时使用 Process 和 notepad.exe 查看文件，我想也许还有另一种查看日志文件的方法，但里面有颜色？像richTextBox 这样的东西，所以我可以在文件中用另一种颜色绘制每一行。

并且它将像现在使用记事本一样快速打开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T19:45:30.840

您不能拥有“带颜色”的文本文件。纯文本没有格式。

您将需要编写为具有格式的格式 - 例如 RTF 或 HTML 将起作用。

您*可以*自定义您的日志和编程编辑器（例如 notepad++）来为您做一些语法高亮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T19:44:08.990

记事本和纯文本不理解颜色。

如果它们对您很重要，您需要将日志写入某种格式化文件；例如：HTML、RTF 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-15T19:25:22.420

如果您有自己的应用程序内对话框/表单来查看日志文件，您还可以编写特定的分隔文本信息，用于解析并用于日志条目行着色。

我写了一个应用程序就是这样做的。

日志文件是带有 .log 文件扩展名的纯 ASCII 文本。对于 .log 文件，我更喜欢纯 ASCII 文本，因为这是该文件类型的行业标准，因为它通常与 Windows 记事本相关联。

日志条目的格式为制表符分隔：日期/时间、条目类型（信息、警告、错误等）和条目文本消息。

当用户在应用程序中打开查看日志表单时，我读取并解析制表符分隔的日志文件数据，并使用所有条目填充多列 ListView 控件，使用条目类型字段来确定 ListView 项的图标图像及其文本颜色，例如。黑色表示信息，黄色表示警告，红色表示错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T20:09:29.223

具有可配置颜色突出显示的出色日志文件查看器... [http://www.baremetalsoft.com/baretail/](http://www.baremetalsoft.com/baretail/)

# http-post - 从 HTTP_RAW_POST_DATA 保存图像在 MAMP 中不起作用

> ID：12230838
> 
> 赞同：0
> 
> 时间：2012-09-01T19:42:23.997
> 
> 标签：http-post, mamp, fwrite

我正在使用以下内容从帖子数据上传图像。它可以在我的服务器上使用 php 版本：5.2.16

当我尝试使用 MAMP 和 PHP 版本 5.2.17 在本地服务器上运行完全相同的脚本时，不会创建文件。

```
if (isset($HTTP_RAW_POST_DATA))
{

// Get the data
$imageData=$HTTP_RAW_POST_DATA;
// Remove the headers (data:,) part.  
// A real application should use them according to needs such as to check image type
$filteredData=substr($imageData, strpos($imageData, ",")+1);
// Need to decode before saving since the data we received is already base64 encoded
$unencodedData=base64_decode($filteredData);

echo "unencodedData: ".$unencodedData;
$key = microtime();
$key = md5($key);
// Save file. 
$fp = fopen( '../../../uploadedImages/original/' . $key . '.jpg', 'wb' );
fwrite( $fp, $unencodedData);
fclose( $fp );
} 
```

如果我在萤火虫中查看它，看起来帖子数据确实存在。任何想法为什么这在 mamp 中不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:00:16.900

一些事情要尝试：

1.  检查以确保在 MAMP 上运行脚本时获取原始数据

2.  检查它尝试写入的目录的权限，并确保您对其具有写访问权并且 apache 对其具有写访问权。

我在 MAMP 上运行一些 php 模块时遇到问题，所以我改用使用 MacPorts 安装的版本。它让我可以更好地控制想要安装的额外扩展，并且我获得了最新版本的 apache、php 和 php 扩展。

# javascript - 检查是否加载了原型

> ID：12230842
> 
> 赞同：1
> 
> 时间：2012-09-01T19:42:48.007
> 
> 标签：javascript, prototype

如何检查原型是否已加载/包含在页面中？如果我检查“原型”对象并且未加载原型，则会在 firebug 中收到“未定义原型”错误。

[http://jsfiddle.net/pampurio97/evRTx/](http://jsfiddle.net/pampurio97/evRTx/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T19:44:08.600

Using`typeof`将传递一个未声明/未定义的对象。

```
if ( typeof Prototype !== "undefined" ) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T09:50:01.840

我相信这稍微干净一些：

```
var Prototype = window.Prototype;
if(Prototype) { //Prototype is loaded } 
```

# linux - 手工与shell脚本持续集成

> ID：12230853
> 
> 赞同：0
> 
> 时间：2012-09-01T19:43:48.413
> 
> 标签：linux, bash, continuous-integration

我为与 shell 脚本的小型持续集成做了一个临时解决方案。它从 svn 更新，然后将文件复制到站点的根目录。所以看起来像这样

```
cd ...

update svn

cp -R ... ... 
```

然后放到crontab中。嗯，它适用于温度。解决方案，但它希望做出一些改进并以某种方式定义 svn 已更改（出现新修订版），并且仅在这种情况下复制文件（好吧，它与每分钟复制文件的连接会使服务器工作更慢）。

但我是 linux 的普通用户 :(

所以问题是：如何使用 bash 脚本定义 svn 获得新的提交，并且仅在这种情况下进行更新和其他内容，例如复制文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:48:28.780

您可以在目录中执行“svn info”（并使用 awk|grep|您最喜欢的工具）来提取您已签出的版本号。对复制到的位置执行相同操作。如果检出目录中的修订号高于目标目录中的修订号，则进行复制。

假设您复制了包括 .svn 目录在内的所有内容。

如果您排除它们，那么您应该在更新之前和之后再次“svn info”，并比较两个修订版。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T14:08:03.563

停止。

你到底为什么要这样做？

有 80 个完全免费、超级容易安装的 CI 工具，你为什么要开始使用 shell 脚本和 cron 来破解你自己的工具？

除非您正在寻找编写脚本/ cron 技能并希望将构建自己的 CI 作为一个有趣的小场景来玩，否则您只是在浪费时间。

# jquery - Rails 中的 Ajax 使用 post() 而不使用 serialize()

> ID：12230859
> 
> 赞同：0
> 
> 时间：2012-09-01T19:44:16.400
> 
> 标签：jquery, ruby-on-rails, ajax

我正在使用此代码在我的 rails 应用程序中发出 ajax 请求，我从 railscast 第 136 集得到它。

```
$(this).submit(function() {
$.post(this.attr("action") + ".js", $(this).serialize(), null, "script");
return false;
}) 
```

但我想在不使用序列化的情况下传递数据。喜欢：

```
$(this).submit(function() {
$.post(this.attr("action") + ".js", { name: "John", time: "2pm" }, null, "script");
return false;
}) 
```

查看 jquery .post 文档中的示例，它应该可以工作，但是当我在操作中提出 params.inspect 时，我没有得到这些参数。我究竟做错了什么？

**编辑：** 我添加了我的表单代码。但是，如果我在没有序列化的情况下传递数据，表单中的输入字段应该无关紧要。editTransaction() 函数包含上面的代码。

```
<%= form_tag("edit", :method => "post", :onsubmit => "editTransaction()", :remote => true) do %>
<%= hidden_field_tag(:id, transaction.id) %>
<%= submit_tag("edit") %>
<% end %> 
```

作为临时修复，我在表单中添加了隐藏的输入字段，并在提交时使用 javascript 更新了这些字段，然后使用 serialize()。

# c# - 数据网格列 XAML

> ID：12230866
> 
> 赞同：6
> 
> 时间：2012-09-01T19:45:43.233
> 
> 标签：c#, wpf, xaml, .net-4.0, datagrid

我正在使用 DataGrid 来显示数据库表中的项目，并且我正在使用 EF CodeFirst，因此数据库查询会自动生成一个对象。

这是我的 XAML：

```
<DataGrid Name="details" Margin="0,20,0,0" ItemsSource="{Binding}">
</DataGrid> 
```

这是它背后的代码：

```
data = new DbLayer();
        int cardNumId = (from dataCardNum in data.creditCards
                         where dataCardNum.creditCardNumber == cardNum
                         select dataCardNum.Id).First();
        debits =new ObservableCollection<Debit>(( from billings in data.charges
                   where billings.creditCardNumber.Id == cardNumId
                   select billings).ToList());
        DataContext = debits; 
```

这解决了用我的数据库中的所有信息填充我的 DataGrid。唯一的问题是我有两列不想显示。我试图创建一个 dataTemplate 来生成包含我想要的列的网格，但是当我将它绑定到 datacontext 时，它没有显示任何信息。

这是我的数据模板：

```
<DataTemplate x:Key="debitShow" DataType="DataTemplate:MonthBill.Debit">
        <DataGrid>
            <DataGrid.Columns>
                <DataGridTextColumn Header="amount" Binding="{Binding amount}"/>
                <DataGridTextColumn Header="charge date" Binding="{Binding chargeDate}"/>
                <DataGridCheckBoxColumn Header="charged" Binding="{Binding charged}"/>
                <DataGridTextColumn Header="store name" Binding="{Binding storeName}"/>
                <DataGridTextColumn Header="purchase date" Binding="{Binding debitDate}"/>
                <DataGridTextColumn Header="description" Binding="{Binding description}"/>
            </DataGrid.Columns>
        </DataGrid>
    </DataTemplate> 
```

窗口xml：

借记类（关键属性用于创建 codefirst 数据库）：

```
class Debit
{        
    [Key]
    public int Id { get; set; }
    public int amount { get; set; }
    public string storeName { get; set; }
    public DateTime debitDate { get; set; }
    public DateTime chargeDate { get; set; }
    public string description { get; set; }
    public creditCard creditCardNumber { get; set; }
    public bool charged { get; set; }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T03:39:11.860

如果您的目标是在没有不需要的两列的情况下显示数据，我建议采用更简单的方法，即明确指定网格的列：

```
<DataGrid  ItemsSource="{Binding}" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTextColumn Header="amount" Binding="{Binding amount}"/>
            <DataGridTextColumn Header="charge date" Binding="{Binding chargeDate}"/>
            <DataGridCheckBoxColumn Header="charged" Binding="{Binding charged}"/>
            <DataGridTextColumn Header="store name" Binding="{Binding storeName}"/>
            <DataGridTextColumn Header="purchase date" Binding="{Binding debitDate}"/>
            <DataGridTextColumn Header="description" Binding="{Binding description}"/>
        </DataGrid.Columns>
    </DataGrid> 
```

注意`AutoGenerateColumns="False"` [属性。](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autogeneratecolumns.aspx)

如果我想控制单元格的呈现方式，我只会使用数据模板。如果您对默认演示文稿感到满意，我认为您不需要模板。

# javascript - jQuery - 如何检测页面何时完成加载？

> ID：12230867
> 
> 赞同：2
> 
> 时间：2012-09-01T19:45:44.917
> 
> 标签：javascript, jquery, html

如何检测页面是否完全加载完成？我说完全是因为我尝试在代码中添加一条警告语句`$(document).ready(function()`，但是警告语句发生在 IE 中的轮子停止旋转之前（大约 1.5 秒后，轮子停止，那是页面完全加载的时候）。（它是您在 IE9 顶部看到的选项卡所在的加载轮）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T19:47:44.217

您可以使用`load`方法：

> load 事件在文档加载过程结束时触发。至此，文档中的所有对象都在 DOM 中，所有图片和子帧都加载完毕。

```
$(window).load(function(){
    // ...
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T19:47:53.170

```
$(window).load(function() {
// do stuff 
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T19:47:36.767

尝试使用[`window.onload`](https://developer.mozilla.org/en-US/docs/DOM/window.onload)事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-01T19:48:09.043

尝试

```
$(window).load(function(){
    //....
}); 
```

当 HTML 文档被加载并且 DOM 准备就绪时，该`document ready`事件已经执行，即使所有图形尚未加载，并且`window load`当整个页面（包括所有框架、对象和图像）完全加载时该事件稍后执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T19:51:43.047

```
 $(document).ready(function(){}); 
```

上面的函数保证了 DOM 已经准备好被 javascript 修改。它不保证 xhr 请求本质上是异步加载的。所以可能存在一些 xhr 请求正在发生并且微调器显示加载直到没有正在进行的 http 请求的情况。

# php - 使用 SSH2 获取启动进程的进程 ID - phpseclib

> ID：12230876
> 
> 赞同：0
> 
> 时间：2012-09-01T19:46:56.213
> 
> 标签：php, ssh, libssh2, phpseclib

我正在使用 phpseclib，Net_SSH2。

我需要获取由此命令启动的服务器/进程的进程 ID。

```
echo $ssh->exec('java -Xmx256M -Xms32M -jar minecraft_server.jar nogui'); 
```

这样我就可以存储它并随时通过 PHP 脚本杀死它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T19:58:03.510

你可以试试：

```
echo $ssh->exec('java -Xmx256M -Xms32M -jar minecraft_server.jar nogui > /dev/null 2>&1 & echo $!;'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:05:11.213

如果您想在执行特定命令后跟踪特定命令的 PID，即使这样也可以。

```
$cmd = 'java -Xmx256M -Xms32M -jar minecraft_server.jar nogui';
$pid = $ssh->exec('echo `ps aux | grep -F "' . $cmd . '" | grep -v -F "grep" | awk \'{ print $2 }\'`');
echo $pid; 
```

杀死相同：

```
$ssh->exec("kill -9 $pid"); 
```

# jquery - 无法让 jQuery 专注于克隆的输入字段

> ID：12230877
> 
> 赞同：0
> 
> 时间：2012-09-01T19:47:05.790
> 
> 标签：jquery, ajax, clone

我有一个页面需要根据用户的需要经常创建动态表单字段，我正在尝试使用 Ajax 将其绑定到我的数据库中，以便更快地输入表单并防止用户输入错误。

所以，我把我的 Ajax 返回的数据放入弹出 div 中，用户选择，然后填写表单字段。问题出在克隆字段上。他们似乎不想在集中注意力时弹出弹出 div。我认为这与它们被创建/添加到 DOM 时有关。

这是我创建克隆的 JS：

```
$(document).ready(function() {
    var regex = /^(.*)(\d)+$/i;
    var cloneIndex = $(".clonedInput").length;

    $("button.clone").live("click", function(){
        $(this).parents(".clonedInput").clone()
            .appendTo("#course_container")
            .attr("id", "clonedInput" +  cloneIndex)
            .find("*").each(function() {
                var id = this.id || "";
                var match = id.match(regex) || [];
                if (match.length == 3) {
                    this.id = match[1] + (cloneIndex);
                }
        });
        cloneIndex++;
        numClones=cloneIndex-1;
        //alert("numClones "+numClones);
    }); 
```

这是我希望能够专注于正确的克隆字段并调用弹出窗口的地方。baker_equiv0 id 是原始代码，而 baker_equiv1 是第一个克隆。

```
$('#baker_equiv0').focus(function() { \\ THIS CODE WORKS
$('.popup').fadeIn(500);
$('#results').empty();
// document.enter_data.baker_equiv1.value="test"; THIS LINE WORKS
//alert("numClones "+numClones);
                }); 

$('#baker_equiv1').focus(function() { // THIS DOESN'T EVER FIRE
alert("numClones "+numClones);
$('.popup').fadeIn(500);
$('#results').empty();
}); 
```

这是带有表单的 HTML：

```
<label for="baker_equiv" class="">Baker Equivalent: <span class="requiredField">*</span></label>
<input type="text" class="cinputsa" name="baker_equiv[]" id="baker_equiv0" size="8" ONKEYUP="get_equiv(this.value);"> 
```

如果我把它放在上面的 HTML 代码中，它工作正常：`onfocus="alert(this.id)"`

我也对如何调整 JS 代码以根据创建的 id 数组工作感兴趣，而不必为每个潜在的字段克隆集复制代码，即 baker_equiv[] 而不是 baker_equiv0、​​baker_equiv1 等。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T03:37:14.170

在对 HTML 做了一些假设之后，我想出了这个：

HTML：

```
<div id="course_container">
    <div class="cloneMe"><!-- wrapper could be any block or inline element eg. <span> or <form> -->
        <label for="input0">Baker Equivalent: <span class="requiredField">*</span></label>
        <input id="input0" type="text" class="cinputsa needsPopup" name="baker_equiv[]" size="8" />
        <button class="clone">Clone</button>
    </div>
</div> 
```

Javascript：

```
$(function() {
    //*** fixed data ***
    var $$ = { //cache of jQuery objects
            course_container: $("#course_container"),
            popup : $("#popup"), //presumably only one popup, so it gets an id
            results: $("#results")
        },
        cloneIndex = 0, // adjust as required to reflect highest index used in the initial HTML
        input_id_prefix = 'input';

    //*** event handlers ***
    $$.course_container.on('click', 'button.clone', function() {
        var $clone = $(this).closest('.cloneMe').clone(true, true),
            id = input_id_prefix + ++cloneIndex;
        $clone.find('input').attr('id', id).end().find('label').attr('for', id).end().appendTo($$.course_container);
    });
    $$.course_container.on('focus', 'input.needsPopup', function() {
        $$.popup.fadeIn(500);
        $$.results.empty();
    }).on('keyup', get_equiv);
}); 
```

**[演示](http://jsfiddle.net/mNPUH/4/)**

**笔记**

*   `clone(true,true)`用数据和事件进行深度克隆。
*   id 生成被简化。
*   输入字段需要一个 id`<label for="...">`才能咬住。如果您可以不使用标签的`for`功能，那么您应该完全避免对 id 的需求。
*   克隆按钮单击和输入字段 keyup 和输入字段焦点处理委托给`#course_container`.
*   `get_equiv()`按名称附加，并且在演示中有一个简单的虚拟语句来证明它被调用。

# backbone.js - Simperium 和主干的关系

> ID：12230884
> 
> 赞同：1
> 
> 时间：2012-09-01T19:47:42.967
> 
> 标签：backbone.js, simperium

Simperium 和 Core Data 关系工作正常，但我需要创建哪些 Backbone 模型，以便将模型与关系同步。

Simperium Backbone todo 示例仅使用一个模型，我在哪里可以找到使用关系和 Simperium 的 Backbone 应用程序示例。

谢谢

编辑：我只想知道，[Backbone-relational](https://github.com/PaulUithol/Backbone-relational)或类似的库是否与 Simperium 兼容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T08:53:26.907

可以将关系映射到您的 Backbone 模型。每个关系都会产生一个唯一标识符列表，可用于引用其他模型。不过，您需要自己连接这些。像 Backbone-relational 这样的东西也可以工作。

请注意，现在可以使用[完整的 Simperium.js 源代码。](https://github.com/Simperium/simperium-js)我还创建[了一个 GitHub 问题](https://github.com/Simperium/simperium-js/issues/1)来阐明关系如何与 Simperium.js 和 Backbone 一起工作。

# iphone - 代码中的 UIPageViewController 部分卷曲

> ID：12230900
> 
> 赞同：5
> 
> 时间：2012-09-01T19:50:24.550
> 
> 标签：iphone, ios, xcode, uipageviewcontroller

是否有可能使用 UIPageViewController 从代码中部分卷曲页面。我想向用户展示他能够更改页面，为此我想部分卷曲页面并将其放回原处（向左然后向右轻轻滑动，这将是用户输入以获得此效果但我想从代码中获得它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:08:24.557

你需要使用`UIViewAnimationTransitionCurlUp`. 查看下面的示例。

```
- (void)handleSwipe:(UISwipeGestureRecognizer *)sender {

if(sender.state == UIGestureRecognizerStateEnded) {
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];
    [UIView setAnimationTransition:UIViewAnimationTransitionCurlUp forView:window cache:YES];

    [self.view addSubview:[newView view]];
    [oldView removeFromSuperview];

    [UIView commitAnimations];
   }                  
}
- (void)createGestureRecognizers:(UIView *) target {
UISwipeGestureRecognizer *rightSwipeRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];

[rightSwipeRecognizer setDirection:(UISwipeGestureRecognizerDirectionRight)];
[target addGestureRecognizer:rightSwipeRecognizer];
[rightSwipeRecognizer release];
} 
```

# javascript - 如何用javascript替换Jquery字符串上的新参数

> ID：12230903
> 
> 赞同：0
> 
> 时间：2012-09-01T19:50:48.637
> 
> 标签：javascript, jquery, ajax, html

> **可能重复：**
> [如何在 Jquery String 上只替换一个参数或用 Jquery 快速替换](http://stackoverflow.com/questions/12142637/how-to-replace-only-one-parameter-or-fast-with-jquery-on-jquery-string)

该网站的查询字符串是：

```
http://www.nonloso.html/?nome1=pollo&cognome1=chicken&nome2=a&cognome2=b&nome3=c&cognome3=d 
```

这是我发送了三个表单的站点，但现在我想更改我发送的第二个表单的名称。**(nome=a&cognome=b)** 除非数据与我读取站点的程序有关并受变量影响。我编辑了字段（变量），但因为我要在网站上重写。从 name=a 和 surname=b 表示该站点将成为新参数。

```
http://www.nonloso.html/?nome1=pollo&cognome1=chicken&nome2=565655&cognome2=8765634&nome3=c&cognome3=d. 
```

如何？？？如何通过仅更改感兴趣的值来编辑站点？

我再说一遍：在我的网站之前

```
http://www.nonloso.html/?nome1=pollo&cognome1=chicken&nome2=a&cognome2=b&nome3=c&cognome3=d 
```

使用脚本 Javascrits 或 Jquery 或 ajax 后（可能吗？？）

```
http://www.nonloso.html/?nome1=pollo&cognome1=chicken&nome2=565655&cognome2=8765634&nome3=c&cognome3=d 
```

**有一个解决方案或示例**吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:48:05.193

你可以使用

```
var change={
    nome2:565655,
    cognome2:8765634
}
if(window.location.search){
    var que = window.location.search.substring(1).split("&"),
        newArr=[];
    for(var i=0;i<que.length;i++){
        var qvar = que[i].split("=");
        if(change[qvar[0]]){
            qvar[1]=change[qvar[0]];
        }
        newArr.push(qvar.join('='));
    }
    window.location.search="?"+newArr.join('&');
} 
```

**编辑：**

抱歉，上面的代码有效，但它是一个永恒的循环。然后，使用

```
var change={
    nome2:565655,
    cognome2:8765634
}
if(window.location.search){
    var que = window.location.search.substring(1).split("&"),
        newArr=[],
        changeURL=false;
    for(var i=0;i<que.length;i++){
        var qvar = que[i].split("=");
        if(change[qvar[0]]&&change[qvar[0]]!=qvar[1]){
            console.log('URL changed because of '+change[qvar[0]]+' != '+qvar[1]);
            qvar[1]=change[qvar[0]];
            changeURL=true;
        }
        newArr.push(qvar.join('='));
    }
    if(changeURL){
        window.location.search="?"+newArr.join('&');
    }
} 
```

# spring - 春季安全和使用 CustumUserDetails

> ID：12230904
> 
> 赞同：1
> 
> 时间：2012-09-01T19:51:05.547
> 
> 标签：spring, security

有人可以帮我解决春季安全问题吗？我在视图下有两个文件夹 1：所有用户 2：超级用户 所有用户都有 hasRole("ROLE_USER") 并且超级用户有：haseRole("ROLE_ADMIN","ROLE_USER") 我希望当用户登录后如何将 ROLE_ADMIN 重定向到正确的文件夹，即超级用户的文件夹和只有 ROLE_USER 的文件夹到所有用户的文件夹。不知道我该怎么做。

弹簧安全.xml

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org  /2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

<http auto-config="true" use-expressions="true">

    <!-- interceptor pages -->
    <intercept-url pattern="/**" access="permitAll" />
    <intercept-url pattern="/index" access="permitAll" />
    <intercept-url pattern="/allusers/**" access="hasRole('ROLE_USER')" />
    <intercept-url pattern="/superusers/**" access="hasAnyRole('ROLE_ADMIN','ROLE_USER')" />
    <intercept-url pattern="/logout" access="permitAll" />
    <intercept-url pattern="/denied" access="permitAll" />
    <intercept-url pattern="/getAllUsers"  access="hasRole('ROLE_ADMIN')" />
    <access-denied-handler error-page="/403" />

    <form-login login-page="/index" default-target-url="/welcome"
        authentication-failure-url="/loginfailed" />

    <logout logout-success-url="/logout" />

</http>
<authentication-manager>
    <authentication-provider>
        <jdbc-user-service data-source-ref="dataSource"
            users-by-username-query="
                            select username,password,'true' AS isEnabled from USER where USERNAME=?"  
            authorities-by-username-query="
            select u.username ,r.`ROLE_NAME`,u.`PASSWORD` from USER u, USER_ROLE ur,ROLE r where (u.user_id = ur.user_id) 
            and (r.role_id=ur.role_id)  and u.username =? " />
    </authentication-provider>
</authentication-manager> 
```

这是我的 mvc-dispatcher.xml

```
 <beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans     
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:component-scan base-package="com.secure.weblayer" />
<mvc:annotation-driven />
<context:annotation-config />
<mvc:resources mapping="/resources/**" location="/resources/" />
<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/" />
     <!--   <property name="prefix" value="/WEB-INF/views/allusers/" />-->
     <!--   <property name="prefix" value="/WEB-INF/views/superusers" />-->
    <property name="suffix" value=".jsp" />
</bean>
<bean id="messageSource"
    class="org.springframework.context.support.ResourceBundleMessageSource">
    <property name="basenames" value="mymessages"></property>
</bean>
<bean
   class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" />
<bean
class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
   </beans> 
```

如您所见，我在 spring-security.xml 中使用 sql-query 进行登录。我可以登录但无法重定向到任何所需的页面。但是当我在 xml 文件中将属性更改为：property name="prefix" value="/WEB-INF/views/allusers"
或：property name="prefix" value="/WEB-INF/views/superusers" 我可以访问这些文件夹中的所有页面，但不能同时访问。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T02:43:57.743

您不想触摸 InternalResourceViewResolver，因为这会影响所有视图。

您没有正确的访问权限，应该是这样的。

所有用户都是普通用户和管理员用户：

```
<intercept-url pattern="/allusers/**" access="hasAnyRole('ROLE_ADMIN','ROLE_USER')" /> 
```

超级用户只是管理员用户

```
<intercept-url pattern="/superusers/**" access="hasRole('ROLE_ADMIN')" /> 
```

另外，删除：

```
<intercept-url pattern="/**" access="permitAll" /> 
```

然后你只想在登录后重定向到正确的页面。因此，将其用于您的登录控制器：

```
@Controller
public class LoginController {
    @RequestMapping(value="/welcome", method = RequestMethod.GET)
    public String printWelcome(ModelMap model, SecurityContextHolderAwareRequestWrapper request) {
        if(request.isUserInRole("ROLE_ADMIN")) {
            return "redirect:/superusers";
        } else {
            return "redirect:/allusers";
        }
    } 
} 
```

# php - 链接中带有php变量的Javascript打开窗口？

> ID：12230910
> 
> 赞同：2
> 
> 时间：2012-09-01T19:51:47.673
> 
> 标签：php, javascript, redirect

我需要做的是打开一个新窗口，指向其中包含 php 变量的链接。据我所知，我不能在 javascript 函数中使用 php 变量，所以我尝试了这个似乎不起作用

```
$link="<script type='text/javascript'>window.open('http://www.fonefinder.net/findome.php?npa=$num1&nxx=$num2&thoublock=$num3&usaquerytype=Search+by+Number&cityname=
')</script>";
echo $link; 
```

$num1、$num2 和 $num3 都是 php 变量。有一个更好的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T19:55:22.113

删除换行符：

```
$link="<script type='text/javascript'>window.open('http://www.fonefinder.net/findome.php?npa=$num1&nxx=$num2&thoublock=$num3&usaquerytype=Search+by+Number&cityname=')</script>";
echo $link; 
```

此外，您应该将变量包装在大括号中：`${num1}`，否则它们可能会被错误地插值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T19:59:32.983

```
$link="<script type='text/javascript'>window.open('http://www.fonefinder.net/findome.php?npa=".$num1."&nxx=".$num2."&thoublock=".$num3."&usaquerytype=Search+by+Number&cityname=')</script>";
echo $link; 
```

# objective-c - 触摸电子邮件文本 MFMailComposeViewController 后应用程序崩溃

> ID：12230914
> 
> 赞同：0
> 
> 时间：2012-09-01T19:52:34.607
> 
> 标签：objective-c, ios

我`MFMailComposeViewController`在我的 demp 应用程序中实现。但是，由于某些原因，在我触摸以在电子邮件文本字段中添加文本后，我的应用程序崩溃了。但是在不添加任何文本的情况下发送效果很好。

我的 Xcode 没有显示太多。这是我得到的：

![在此处输入图像描述](../Images/382b16a7ccd3f8304b3fbbf2ccb14ac1.png)

我已经在电子邮件文本字段中设置了初始文本。也许问题就在这里？请求任何代码，我很乐意将其包含在内。

**更新：** 这里有两种方法，其中第一种方法`openMail`在触摸时触发`UIButton`

```
- (IBAction)openMail:(id)sender
{
    if ([MFMailComposeViewController canSendMail])
    {

    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Failure"
                                                        message:@"Your device doesn't support the composer sheet"
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles:nil];
        [alert show];
        [alert release];
    }

    if ([MFMailComposeViewController canSendMail])
    {
        MFMailComposeViewController *mailer = [[MFMailComposeViewController alloc] init];

        mailer.mailComposeDelegate = self;

        [mailer setSubject:@"Feedback from Demo App user"];

        NSArray *toRecipients = [NSArray arrayWithObjects:@"myEMAIL@hotmail.com", @"myEMAIL2@gmail.com", nil];
        [mailer setToRecipients:toRecipients];

        NSString *emailBody = @"Happy to hear your feedback!";
        [mailer setMessageBody:emailBody isHTML:NO];

        [self presentModalViewController:mailer animated:YES];

        [mailer release];
    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Failure"
                                                        message:@"Your device doesn't support the composer sheet"
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles: nil];
        [alert show];
        [alert release];
    }

}

- (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error
{
    switch (result)
    {
        case MFMailComposeResultCancelled:
            NSLog(@"Mail cancelled: you cancelled the operation and no email message was queued.");
            break;
        case MFMailComposeResultSaved:
            NSLog(@"Mail saved: you saved the email message in the drafts folder.");
            break;
        case MFMailComposeResultSent:
            NSLog(@"Mail send: the email message is queued in the outbox. It is ready to send.");
            break;
        case MFMailComposeResultFailed:
            NSLog(@"Mail failed: the email message was not saved or queued, possibly due to an error.");
            break;
        default:
            NSLog(@"Mail not sent.");
            break;
    }

    // Remove the mail view
    [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:56:53.377

可能您正在使用 ARC，并且您没有指向您的强大指针，`MFMailComposeViewController`并且在显示之后，ARC 正在释放它。

利用

```
@property (nonatomic,stron) MFMailComposeViewController *mail; 
```

当你初始化 MFMailComposeViewController 时：

```
MFMailComposeViewController *mailer = [[MFMailComposeViewController alloc] init];
self.mail = mailer; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:06:02.693

您的代码中是否还有这一行：

```
[mailer release]; 
```

如果是这样，那就是问题所在。如果没有，请更新我们的代码示例，使其与您现在使用的完全一致。

# android - 方向改变的问题（Linux）

> ID：12230916
> 
> 赞同：1
> 
> 时间：2012-09-01T19:52:50.753
> 
> 标签：android, android-orientation

我正在尝试更改我的 android 模拟器的方向。我尝试使用不同的组合：Ctrl+ F11、Ctrl + F12、Ctrl + fn + F11 等，但方向保持不变。在 Windows 中一切正常，但在 Ubuntu 中没有任何作用。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:51:46.617

Ctrl-F11 和 Ctrl-F12 在 PC 环境中的 Ubuntu 中工作。是否涉及 Fn 键取决于您的键盘（例如，笔记本电脑可能需要 Fn，台式机/外接键盘通常没有 Fn）。

# javascript - 在不向上滚动的情况下将项目添加到 ListBox

> ID：12230924
> 
> 赞同：0
> 
> 时间：2012-09-01T19:54:35.393
> 
> 标签：javascript, jquery, asp.net, ajax

我有一个包含所有在线用户的 ListBox。用户每秒从 MySQL 数据库加载并加载到 ListBox 中。当我将一个项目添加到 ListBox 时，ListBox 会向上滚动，我不希望这种情况发生。

```
 <asp:UpdatePanel ID="usersPanel" UpdateMode="Conditional" runat="server">
        <ContentTemplate>
          <asp:ListBox ID="lstUsers" runat="server" ViewStateMode="Enabled" AutoPostBack="True"></asp:ListBox>
          <asp:Timer ID="mainTimer" runat="server" ontick="Timer1_Tick" Interval="1000"></asp:Timer>
        </ContentTemplate>
       </asp:UpdatePanel> 
```

定时器代码：

```
 protected void Timer1_Tick(object sender, EventArgs e)
    {
            ...
            MySqlDataReader datareader = command.ExecuteReader();
            if (datareader.HasRows) {
            lstUsers.Items.Clear();
            while (datareader.Read()) {
                    lstUsers.Items.Add(new ListItem(datareader.GetString(1), datareader.GetInt32(0).ToString()));}
            }
    } 
```

我试过用 javascript 来做，但我无法获取/设置列表框上的滚动条位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:10:53.283

这里所做的是将当前选择的列表保存在客户端，并在面板使用新值更新后将其设置回来。

```
<script type="text/javascript" language="javascript" >
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_beginRequest(beighnloadinf);        
    prm.add_endRequest(EndRequest);

    var selected = "";
    //get selected index and store in variable
    function beighnloadinf() {
     var sel = document.getElementbyId('<%=lstUsers.ClientID%>');
     var listLength = sel.options.length;
         for(var i=0;i<listLength;i++){
                 if(sel.options[i].selected){
                     selected =sel.options[i].value;
                     break;
                 }
         }
    }

    // set selected index back afrer update finished
    function EndRequest(sender, args) {
     var sel = document.getElementbyId('<%=lstUsers.ClientID%>');
            sel.value = selected;
    }

</script> 
```

你可以做同样的事情，在后面的代码上，你得到选择的，然后把它放在你的列表的新更新之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:40:15.477

您不应该每秒都清除控件。这是你的问题：

```
lstUsers.Items.Clear(); 
```

最简单的解决方案是使用 except 方法将您`ListBox items`与您的数据源进行比较`IEnumerable`。

您必须`IEnumerable`手动将数据源转换为。请参阅这篇[文章](https://stackoverflow.com/questions/1041405/is-there-an-implementation-of-iqueryable-over-dbdatareader)以了解如何做到这一点。

注意：您必须更改扩展方法的类型。

之后，您可以遍历您的差异集（返回的对象 for `.Except()`）并将它们添加到您的列表框中，如下所示：

```
lstUsers.Items.Add("a new list item"); 
```

# gcc - 在 ARM 上构建 GCC：未定义对 `ggc_alloc_zone_vec_rtvec_def' 的引用

> ID：12230925
> 
> 赞同：1
> 
> 时间：2012-09-01T19:55:10.270
> 
> 标签：gcc, arm, gcc4

我正在尝试在由 Marvell Kirkwood mv6281 ARM 处理器驱动的 Synology DS109 NAS 磁盘上编译 GCC。

它目前运行的是相当过时的 GCC 4.2.3，这是我在二进制文件中找到的最新版本。

我在阶段尝试了 GCC 4.7.1 和 4.6.3，结果相同`make`：

```
 build/genflags.o build/rtl.o build/read-rtl.o build/ggc-none.o build/vec.o 
build/min-insn-modes.o build/gensupport.o build/print-rtl.o build/read-md.o 
build/errors.o ../build-armv5tel-unknown-linux-gnueabi/libiberty/libiberty.a
build/rtl.o: In function `rtvec_alloc':
/volume1/public/gcc-4.6.3/build/gcc/../../gcc-4.6.3/gcc/rtl.c:153: undefined reference 
to `ggc_alloc_zone_vec_rtvec_def'
collect2: ld returned 1 exit status
make[3]: *** [build/genflags] Error 1
make[3]: Leaving directory `/volume1/public/gcc-4.6.3/build/gcc'
make[2]: *** [all-stage1-gcc] Error 2
make[2]: Leaving directory `/volume1/public/gcc-4.6.3/build'
make[1]: *** [stage1-bubble] Error 2
make[1]: Leaving directory `/volume1/public/gcc-4.6.3/build'
make: *** [all] Error 2 
```

configure 运行正常，只抱怨丢失`tr`但没有给出任何错误。

我也在使用由 GCC 自带的 download_prerequisities 脚本下载的 vesions 使用 gcc 构建依赖项（gmp & comp.）。

我也尝试了 v4.5.4，但没有运气，但错误消息不同：

```
gcc -c  -g -fkeep-inline-functions -DIN_GCC   -W -Wall -Wwrite-strings -Wcast-qual -Wstrict-prototypes -Wmissing-prototypes -Wmissing-format-attribute -pedantic -Wno-long-long -Wno-variadic-macros -Wno-overlength-strings -Wold-style-definition -Wc++-compat -fno-common  -DHAVE_CONFIG_H -I. -I. -I../../gcc-4.5.4/gcc -I../../gcc-4.5.4/gcc/. -I../../gcc-4.5.4/gcc/../include -I../../gcc-4.5.4/gcc/../libcpp/include -I/volume1/public/gcc-4.5.4/build/./gmp -I/volume1/public/gcc-4.5.4/gcc-4.5.4/gmp -I/volume1/public/gcc-4.5.4/build/./mpfr -I/volume1/public/gcc-4.5.4/gcc-4.5.4/mpfr -I/volume1/public/gcc-4.5.4/gcc-4.5.4/mpc/src  -I../../gcc-4.5.4/gcc/../libdecnumber -I../../gcc-4.5.4/gcc/../libdecnumber/dpd -I../libdecnumber     ../../gcc-4.5.4/gcc/c-lang.c -o c-lang.o
../../gcc-4.5.4/gcc/c-lang.c:58:21: error: gtype-c.h: No such file or directory
make[3]: *** [c-lang.o] Error 1
make[3]: Leaving directory `/volume1/public/gcc-4.5.4/build/gcc'
make[2]: *** [all-stage1-gcc] Error 2
make[2]: Leaving directory `/volume1/public/gcc-4.5.4/build'
make[1]: *** [stage1-bubble] Error 2
make[1]: Leaving directory `/volume1/public/gcc-4.5.4/build'
make: *** [all] Error 2 
```

谁能给我任何线索我应该尝试什么？

# mysql - MYSQL中的CURTIME加减法

> ID：12230927
> 
> 赞同：0
> 
> 时间：2012-09-01T19:55:29.887
> 
> 标签：mysql

我正在尝试从我的数据库中选择用户信息，但我只想检索过去 3 小时内登录的用户

我尝试了以下方法：

```
SELECT * FROM user  WHERE last > CURTIME(), INTERVAL 3 HOUR ORDER BY last DESC 
```

但它不起作用。我想我把 INTERVAL 函数放在了错误的地方。但我尝试了很多方法，但仍然无法正常工作。

你怎么能解决它？有没有比使用 CURTIME() 函数更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:24:39.717

您应该使用`NOW()`，而不是`CURTIME()`，因为 CURTIME 只是作为字符串的时间，没有日期。因此，如果是凌晨 1 点，则不会包括昨天晚上 11 点登录的人。

```
SELECT * FROM USER
WHERE last > DATE_SUB(NOW(), INTERVAL 3 HOUR)
ORDER BY last DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-07T14:30:43.123

```
SUBTIME( curtime( ) , '03:00:00' ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T19:59:26.353

尝试

```
SELECT * FROM user  WHERE ADDDATE(last, INTERVAL 3 HOUR)>CURTIME() ORDER BY last DESC 
```

# php - Wordpress：获取当前帖子的图像

> ID：12230928
> 
> 赞同：1
> 
> 时间：2012-09-01T19:55:34.670
> 
> 标签：php, wordpress, attachment

我正在尝试使用此方法获取帖子的所有图像：

```
$args = array(
    'post_type' => 'attachment',
    'numberposts' => -1,
    'post_status' => null,
    'post_parent' => $post->ID
);  

$attachments = get_posts( $args );
    if ( $attachments ) {
        foreach ( $attachments as $attachment ) {
            $images[] = wp_get_attachment_image_src( $attachment->ID, ATTACHMENT_IMAGE_SIZE );
        }
        return $images;
    } 
```

不幸的是，这将获取所有上传的图像，而不仅仅是与当前帖子相关的图像。我使用 *get_children* 找到了这篇[文章](http://wordpress.org/support/topic/getting-thumbnails-of-images-attached-to-a-post?)，但它也不起作用。有任何想法吗？

ps：我在创建/更新帖子时运行代码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T20:08:29.970

你可以试试

```
<?php 
        $attachments = get_posts( array(
            'post_type' => 'attachment',
            'posts_per_page' => -1,
            'post_parent' => $post->ID,             
        ) );

        if ( $attachments ) {
            foreach ( $attachments as $attachment ) {
                $class = "post-attachment mime-" . sanitize_title( $attachment->post_mime_type );
                $thumbimg = wp_get_attachment_link( $attachment->ID, 'thumbnail-size', true );
                echo '<li class="' . $class . ' data-design-thumbnail">' . $thumbimg . '</li>';
            }

        }

?> 
```

[在这里](http://www.wpbeginner.com/wp-themes/how-to-get-all-post-attachments-in-wordpress-except-for-featured-image/)阅读更多。

确保 $post->ID 不为空。如果这仍然不起作用，您可以尝试从页面/帖子内容中提取图像。更多细节[在这里](http://www.snilesh.com/resources/wordpress/extract-images-from-wordpress-post/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:31:33.000

通过在创建/更新帖子/页面后在您的触发中添加一个钩子来尝试它，并将`functions.php`您的代码包装在该函数中，如下所示

```
add_action( 'save_post', 'after_post_save' );
function after_post_save( $post_id ) {
    if ( 'post' == get_post_type($post_id) ) // check if this is a post
    {
        $args = array(
            'post_type' => 'attachment',
            'numberposts' => -1,
            'post_status' => null,
            'post_parent' => $post_id
        );

        $attachments = get_posts( $args );
        if ( $attachments ) {
            foreach ( $attachments as $attachment ) {
                $images[] = wp_get_attachment_image_src( $attachment->ID, ATTACHMENT_IMAGE_SIZE );
            }
            return $images; // End of function and nothing happens
        }
    }
} 
```

**请记住**，基本上它不会通过`$images`在函数末尾返回数组来执行任何操作，除非您对图像执行某些操作。

**注意：**该`wp_get_attachment_image_src`函数返回一个数组，其中包含

```
[0] => url // the src of image
[1] => width // the width
[2] => height // the height 
```

所以在你的`$images`数组中它将包含这样的东西

```
array(
    [0] => array([0] => url, [1] => width, [2] => height), // first image
    [1] => array([0] => url, [1] => width, 2] => height) // second image
); 
```

# wpf - 向一个按钮添加两个动画？

> ID：12230930
> 
> 赞同：0
> 
> 时间：2012-09-01T19:56:19.727
> 
> 标签：wpf, xaml, animation

在 WPF 中，我希望能够添加两个动画，例如 XAML 中的一个按钮，我让它在单击按钮时动画一次，是否可以在再次单击它时运行另一个动画？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:00:20.117

是的，有可能。第一个动画必须在此之前结束。只需在 firstAnimation.Completed 事件触发后调用 button.BeginAnimation(anotherAnimation) 即可。

# c - 在c中实现子shell

> ID：12230931
> 
> 赞同：1
> 
> 时间：2012-09-01T19:56:34.217
> 
> 标签：c, shell, unix, posix

我已经用 c 语言实现了一个类似于 shell 的 bash。我支持`<` `>` `>>` `;` `|`和`&`。我的下一个任务是添加对基本上是子shell 的`(`支持`)`。我们如何实现子shell。我可以分叉并让父等待，传递环境变量，但我需要添加对命令的支持`(ls | sort) ; ls`（我承认该命令没有多大意义，但它解释了动机）

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:59:35.393

为了实现这一点，我们解析命令行并制作一个树状结构。这可以在 and 的帮助下完成，`lex`并且`yacc`正如 barmer 建议的那样，我们可以将每个节点命名为`subshell` `pipeline` `semicolon`. 解析整个命令行后，将指向整个节点的指针传递给主程序。运行子shell `fork`，然后使用`execve`传递当前环境重新加载相同的程序。

# gwt - 使用最新的 GWT 2.5.0-RC1 生成 Restlet 代理失败

> ID：12230932
> 
> 赞同：0
> 
> 时间：2012-09-01T19:56:35.357
> 
> 标签：gwt, restlet

升级到 GWT 2.5.0-RC1 和 Restlet 中断的代理生成 - 我的项目中有最新版本 2.1-RC6。这是堆栈跟踪：

```
java.lang.NoSuchMethodException: com.google.gwt.user.rebind.rpc.SerializableTypeOracleBuilder.<init>(com.google.gwt.core.ext.TreeLogger, com.google.gwt.core.ext.PropertyOracle, com.google.gwt.core.ext.typeinfo.TypeOracle)
    at java.lang.Class.getConstructor0(Class.java:2706)
    at java.lang.Class.getDeclaredConstructor(Class.java:1985)
    at org.restlet.rebind.ClientProxyGenerator.getSerializableTypeOracleBuilder2_2(ClientProxyGenerator.java:767)
    at org.restlet.rebind.ClientProxyGenerator.generateSerializers(ClientProxyGenerator.java:569)
    at org.restlet.rebind.ClientProxyGenerator.generateProxy(ClientProxyGenerator.java:500)
    at org.restlet.rebind.ClientProxyGenerator.generate(ClientProxyGenerator.java:242) 
```

实际的异常在这里抛出：

```
private SerializableTypeOracleBuilder getSerializableTypeOracleBuilder2_2()
        throws Exception {
    SerializableTypeOracleBuilder result = null;

    Constructor<SerializableTypeOracleBuilder> c = null;
    c = SerializableTypeOracleBuilder.class.getDeclaredConstructor(
            TreeLogger.class, PropertyOracle.class, TypeOracle.class);
    result = c.newInstance(getLogger(), getContext().getPropertyOracle(),
            getTypeOracle());

    return result;
} 
```

以下调用似乎有问题，尽管我不明白为什么：

**c = SerializableTypeOracleBuilder.class.getDeclaredConstructor(TreeLogger.class, PropertyOracle.class, TypeOracle.class);**

有人让 Restlet GWT 与最新的 GWT 2.5.0-rc1 一起工作？？

**更新：问题打开[#647](https://github.com/restlet/restlet-framework-java/issues/647)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T02:06:29.510

我刚刚检查了以下 GWT 版本的 Restlet 的 POM：

*   [http://maven.restlet.org/org/restlet/gwt/org.restlet/2.2-SNAPSHOT/](http://maven.restlet.org/org/restlet/gwt/org.restlet/2.2-SNAPSHOT/)
*   [http://maven.restlet.org/org/restlet/gwt/org.restlet/2.1.1/](http://maven.restlet.org/org/restlet/gwt/org.restlet/2.1.1/)

它们都依赖于 GWT 2.2 版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:00:31.480

这就是使用*内部*类时的问题：`SerializableTypeOracleBuilder`的构造函数不再接受`TypeOracle`参数，而是`GeneratorContext`. [http://code.google.com/p/google-web-toolkit/source/browse/releases/2.5/user/src/com/google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#782](http://code.google.com/p/google-web-toolkit/source/browse/releases/2.5/user/src/com/google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#782)

这在 GWT 2.4 中已经是这样了（用实验`GeneratorContextExt`代替）：[http ://code.google.com/p/google-web-toolkit/source/browse/releases/2.4/user/src/com/google/ gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#747](http://code.google.com/p/google-web-toolkit/source/browse/releases/2.4/user/src/com/google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#747)
甚至 GWT 2.3：[http ://code.google.com/p/google-web-toolkit/source/browse/releases/2.3/user/src/com/ google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#763](http://code.google.com/p/google-web-toolkit/source/browse/releases/2.3/user/src/com/google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#763)

也就是说，Restlet 仍然依赖一个 18 个月大的版本，即 GWT 2.2：[http ://code.google.com/p/google-web-toolkit/source/browse/releases/2.2/user/src/com/ google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#757](http://code.google.com/p/google-web-toolkit/source/browse/releases/2.2/user/src/com/google/gwt/user/rebind/rpc/SerializableTypeOracleBuilder.java#757)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T08:10:17.850

感谢您报告此问题。2.1 和 master 分支已更新。

# objective-c - 如何修复 NSTimers 的主要滞后？

> ID：12230933
> 
> 赞同：0
> 
> 时间：2012-09-01T19:56:35.603
> 
> 标签：objective-c, xcode, nstimer

在我正在制作的一个相当简单的应用程序中，我使用了许多 NSTimer，它们以 0.01 秒的速度运行，用于更改多个图像的位置。这会导致严重滞后。我怎样才能解决这个问题？请详细解释，因为我对应用程序开发相当陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:42:25.763

来自 NSTimer Docs（重点：我的）：

> 定时器不是实时机制；它仅在已添加计时器的运行循环模式之一正在运行并且能够检查计时器的触发时间是否已过时触发。由于典型的运行循环管理的各种输入源，计时器的时间间隔的有效分辨率被限制在**50-100 毫秒**的数量级。如果在长时间调用期间或运行循环处于不监视计时器的模式下发生计时器的触发时间，则计时器不会触发，直到下一次运行循环检查计时器。因此，定时器触发的实际时间可能是计划触发时间之后的一个重要时间段。

如果您想在显示频率下工作，请参阅`CADisplayLink`。

但是，您应该首先了解您的程序现在将时间花在哪里，以了解是什么使它变慢（分析器）。

# android - GMailSender 没有缓存任何异常，虽然没有连接

> ID：12230935
> 
> 赞同：2
> 
> 时间：2012-09-01T19:56:49.240
> 
> 标签：android, android-wifi

我正在尝试使用 GMailSender 直接从我的应用程序发送电子邮件

我的片段：

公共类 updateFragment 扩展 SherlockFragment {

```
public View onCreateView(LayoutInflater inflater, ViewGroup group, Bundle saved)
{
    View v = inflater.inflate(R.layout.update_layout, group, false);

    Button buttonsubmit = (Button) v.findViewById(R.id.buttonsubmit);
    buttonsubmit.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

            try {   
                GMailSender sender = new GMailSender("test@gmail.com", "test");
                sender.sendMail("Update info",   
                        "",   
                        "test@gmail.com", "test@gmail.com");
                Toast.makeText(updateFragment.this.getActivity().getBaseContext(), "Info Submitted Successfully", Toast.LENGTH_SHORT).show();  

            } catch (Exception e) {   
                Log.e("SendMail", e.getMessage(), e);   
                Toast.makeText(updateFragment.this.getActivity().getBaseContext(), "Please make sure that you have an internet connection", Toast.LENGTH_SHORT).show();
            }

        }

    });

    return v;

}
} 
```

邮件发件人：

```
import javax.activation.DataHandler;   
import javax.activation.DataSource;   
import javax.mail.Message;   
import javax.mail.PasswordAuthentication;   
import javax.mail.Session;   
import javax.mail.Transport;   
import javax.mail.internet.InternetAddress;   
import javax.mail.internet.MimeMessage;   
import java.io.ByteArrayInputStream;   
import java.io.IOException;   
import java.io.InputStream;   
import java.io.OutputStream;   
import java.security.Security;   
import java.util.Properties;   

public class GMailSender extends javax.mail.Authenticator {   
private String mailhost = "smtp.gmail.com";   
private String user;   
private String password;   
private Session session;   

static {   
    Security.addProvider(new com.provider.JSSEProvider());   
}  

public GMailSender(String user, String password) {   
    this.user = user;   
    this.password = password;   

    Properties props = new Properties();   
    props.setProperty("mail.transport.protocol", "smtp");   
    props.setProperty("mail.host", mailhost);   
    props.put("mail.smtp.auth", "true");   
    props.put("mail.smtp.port", "465");   
    props.put("mail.smtp.socketFactory.port", "465");   
    props.put("mail.smtp.socketFactory.class",   
            "javax.net.ssl.SSLSocketFactory");   
    props.put("mail.smtp.socketFactory.fallback", "false");   
    props.setProperty("mail.smtp.quitwait", "false");   

    session = Session.getDefaultInstance(props, this);   
}   

protected PasswordAuthentication getPasswordAuthentication() {   
    return new PasswordAuthentication(user, password);   
}   

public synchronized void sendMail(String subject, String body, String sender, String recipients) throws Exception {   
    try{
    MimeMessage message = new MimeMessage(session);   
    DataHandler handler = new DataHandler(new ByteArrayDataSource(body.getBytes(), "text/plain"));   
    message.setSender(new InternetAddress(sender));   
    message.setSubject(subject);   
    message.setDataHandler(handler);   
    if (recipients.indexOf(',') > 0)   
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(recipients));   
    else  
        message.setRecipient(Message.RecipientType.TO, new InternetAddress(recipients));   
    Transport.send(message);   
    }catch(Exception e){

    }
}   

public class ByteArrayDataSource implements DataSource {   
    private byte[] data;   
    private String type;   

    public ByteArrayDataSource(byte[] data, String type) {   
        super();   
        this.data = data;   
        this.type = type;   
    }   

    public ByteArrayDataSource(byte[] data) {   
        super();   
        this.data = data;   
    }   

    public void setType(String type) {   
        this.type = type;   
    }   

    public String getContentType() {   
        if (type == null)   
            return "application/octet-stream";   
        else  
            return type;   
    }   

    public InputStream getInputStream() throws IOException {   
        return new ByteArrayInputStream(data);   
    }   

    public String getName() {   
        return "ByteArrayDataSource";   
    }   

    public OutputStream getOutputStream() throws IOException {   
        throw new IOException("Not Supported");   
    }   
}   
} 
```

它工作正常，但如果没有连接，它看起来工作正常，我的意思是 toast 会说“信息提交成功”，为什么它不会导致或捕获异常？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T00:19:56.680

发生这种情况是因为 `GMailSender.sendMail`已经捕获了异常。删除里面的try catch块`GMailSender.sendMail`你会得到异常。

# javascript - 如何在 Cappuccino 中使用 Node.js？

> ID：12230936
> 
> 赞同：3
> 
> 时间：2012-09-01T19:56:50.903
> 
> 标签：javascript, node.js, same-origin-policy, cappuccino

我想在[Cappuccino](http://cappuccino.org/)中实现一个使用 Node.js 作为服务器的客户端应用程序。

我目前已经让 Node 与[Express](http://expressjs.com/)一起运行：

```
var express = require( 'express' );

var app = express();

app.get( '/an_endpoint', function(req, res){

    res.send('Hello From Node Express!\n');

});

app.listen(1337); 
```

可以通过以下方式验证：

```
$ node hello_echo.js
$ curl http://127.0.0.1:1337/an_endpoint
> Hello From Node Express! 
```

就客户端代码而言，它是一个简单的小应用程序，带有一个在单击时执行此操作的按钮：

```
// in did finish launching
[button setTitle:"Ping Node"];
[button setTarget:self];
[button setAction:@selector(doPing:)];

- (void)doPing:(id)sender
{
    var connection = [CPURLConnection connectionWithRequest:[CPURLRequest requestWithURL:'http://127.0.0.1:1337/an_endpoint/'] delegate:self];
}

- (void)connection:(CPURLConnection) connection didReceiveData:(CPString)data
{
    alert('Node Says: ' + data);
}

- (void)connection:(CPURLConnection)connection didFailWithError:(CPString)error
{
    alert('Error: ' + error);
} 
```

当我加载应用程序（ from `http://127.0.0.1:8080/NewApplication/index.html`）并单击 OS X 上的 Google Chrome 中的按钮时，我在控制台中收到以下错误，第一个是由于后者：

```
OPTIONS http://127.0.0.1:1337/an_endpoint/ 404 (Not Found) Objective-J.js:716
        XMLHttpRequest cannot load http://127.0.0.1:1337/an_endpoint/. 
Origin http://127.0.0.1:8080 is not allowed by Access-Control-Allow-Origin. 
```

这显然是由于我的节点服务器位于：1337，而我的 Cappuccino 应用程序位于：8080，由于端口部分，它们在技术上是不同的域。

一些研究使我看到了[这篇](http://cappuccino.org/discuss/2008/10/08/xmlhttprequest-jsonp-cappuccino/)文章，其中建议考虑使用 JSONP 将远程脚本注入应用程序。听起来很乱，所以如果没有必要，我不想走那条路。

所以，我的问题是，我怎样才能让 Cappuccino 和 Node.js 和谐地一起工作？似乎如果我可以告诉 Cappuccino 应用程序使用此 ( `header("Access-Control-Allow-Origin", "*");`) 标头，一切都应该很好，但我不知道该怎么做。我尝试让 Node 发送该标头，但它似乎没有做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T03:25:11.763

您应该使用 node 来提供 Cappuccino 应用程序，因此它们都在同一个端口上。

# python - 在 Python 中扩展（本机）类

> ID：12230939
> 
> 赞同：0
> 
> 时间：2012-09-01T19:57:35.670
> 
> 标签：python, class, python-imaging-library, extend

我正在尝试从 Python Imaging Library 向 Image 类添加一个新方法。我想要一个名为 DilateImage 的新类，它与原始 Image 类完全一样，除了它还包含一个 dilate() 函数，该函数在类实例上执行时会修改它。这是我的示例代码（不起作用）：

```
import Image

def DilateImage(Image):
   def dilate(self):
      imnew = self.copy()
      sourcepix = imnew.load()
      destpix = self.load()

      for y in range(self.size[1]):
         for x in range(self.size[0]):
            brightest = 255
            for dy in range(-1,2):
               for dx in range(-1,2):
                  try:
                     brightest = min(sourcepix[x+dx,y+dy], brightest)
                  except IndexError:
                     pass
            destpix[x, y] = brightest 
```

当我尝试使用这个新的类类型来创建一个使用基类的“open”函数的实例时，它失败了：

```
>>> test = DilateImage.open("test.jpg")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'function' object has no attribute 'open' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T19:59:36.437

利用

```
class DilateImage(Image) 
```

不是

```
def DilateImage(Image) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T17:25:58.980

您的代码有两个问题。其中之一已经指出，当定义一个类时，你需要使用`class`关键字，因为`def`关键字定义了一个函数或一个方法。

第二个问题是调用

```
import Image 
```

将名为 Image的**模块**`Image`导入命名空间，以便`Image`在您的代码中引用该模块。它不是一个对象或类，所以

```
class MyImage(Image) 
```

将尝试从**模块**派生一个新类，这将失败。

该`Image`模块包含一个名为`Image`. 将模块导入`Image`命名空间后，您可以将此类称为`Image.Image`. 要扩展此类，您可以执行以下操作：

```
import Image

class MyImage(Image.Image) 
```

为了减少混淆，您还可以将 Image 模块导入不同的命名空间：

```
import Image as Img

class MyImage(Img.Image) 
```

问题在于，PIL 似乎并未设计为允许对 Image 类进行这种扩展。它的模块提供了一堆**函数**，这些函数将 Image 的实例作为参数并返回 Image 的新实例。实际 Image 类中只有几个方法。因此，您可能想要做的是编写一个函数，该函数将采用 Image 的实例并创建 Image 的新实例，而不是通过新方法扩展 Image 类。例如，像这样：

```
import Image

def DilateImage(source):
      dest = source.copy()
      sourcepix = source.load()
      destpix = dest.load()

      for y in range(source.size[1]):
         for x in range(source.size[0]):
            darkest = 255
            for dy in range(-1,2):
               for dx in range(-1,2):
                  try:
                     darkest = min(sourcepix[x+dx,y+dy], darkest)
                  except IndexError:
                     pass
            destpix[x, y] = darkest

      return dest

im1 = Image.open("test.jpg")

img2 = DilateImage(im1)

img2.show() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T20:00:47.193

当您应该使用关键字时，您将定义`DilateImage`为一个函数（通过使用）。因此, since 函数没有属性。`def``class``AttributeError``open`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-11T23:38:14.563

我不知道这是否是最近的更改，但与之前的评论风格相同，您实际上可以修改/添加到现有类。例如：

```
class list(list):
    #Create an Empty List
    def empty(N:int):
        """Create an N-Long Empty List"""
        return [None]*int(N) 
```

这不会改变 'list' 类的现有功能，但会添加一个执行此操作的方法：

```
>>> list.empty(5)
[None, None, None, None, None] 
```

您也可以对其他类执行此操作，因此提供示例代码以更直接地回答您的问题：

```
#Import Libraries
import Image

#Add Methods to Image
class Image(Image):
    def dilate(*args, **kwargs):
        ... 
```

我不确定是否建议这样做，但是您可以做到这一点很酷！

# mysql - 如何删除列中的第一个字符

> ID：12230941
> 
> 赞同：5
> 
> 时间：2012-09-01T19:57:44.243
> 
> 标签：mysql

我有一列包含字符串。它是一个数字，但保存为字符串。该字符串可能以 00 或两个以上的零开头。我需要删除零并将新值（删除后）插入另一列。问题是开头的零数量不固定。它可以是 2 个或更多。这个任务可以用 MySQL 完成吗？如何？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T20:06:31.930

[这里](https://stackoverflow.com/questions/96952/how-to-trim-leading-zeros-from-alphanumeric-text-in-mysql-function)提供了一个很好的提示：

```
UPDATE your_table
SET column2 = TRIM(LEADING '0' FROM column1) 
```

假设原始值存储在其中，`column1`并且您想将经过 0 修剪的值写入`column2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:00:29.580

您可以使用`CONVERT(col,UNSIGNED INTEGER)`将其转换为数字，该数字应删除前导零。

查询可以

```
insert into <table> values(select CONVERT(col,UNSIGNED INTEGER),..... from <table2>); 
```

# android - 为什么 Images.Media.insertImage 返回 null

> ID：12230942
> 
> 赞同：20
> 
> 时间：2012-09-01T19:57:58.020
> 
> 标签：android, mediastore, insert-image

我有一些代码在其中运行 MediaStore.Images.Media.insertImage 方法（从源而不是文件名插入），此代码将图像保存到 MediaStore 并返回图像的 uri。我知道当它因任何原因失败时，它将返回 null 而不是 uri。该图像已被许多人多次下载，并且每隔一段时间它会从此方法返回 null。我从来没有遇到过这种情况，所以我不知道发生了什么。发生这种情况的原因是什么？还有另一篇有相同问题的[帖子](https://stackoverflow.com/questions/6576217/most-likely-cause-for-android-provider-mediastore-images-media-insertimage-to-re)，但答案是指向 MediaStore 源代码的链接，但该链接指向一个页面，表明该链接不可用。任何帮助，将不胜感激。谢谢。

取出我的 SD 卡后，我得到了这个错误，所以我知道这可能是一个原因，我不确定，但我觉得如果卡已满，也会发生这种情况。仍然只是想知道是否还有其他原因。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-01-29T20:37:09.050

当您在某些版本的 Android 上没有 /sdcard/DCIM/Camera 目录时，似乎会发生这种情况。创建这个目录（并拥有权限）为我解决了这个问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-24T19:13:46.573

MediaStore.Images.Media.insertImage 实际上是访问外部存储来保存图像。

一些可能导致您的应用程序失败的重要提醒：

1.  如果处于大容量存储模式，USB 连接将阻止 SD 卡的使用。

2.  可能还有其他因素可能导致 SD 卡无法访问，因此请确保您可以先使用文件浏览器访问 SD 卡。

3.  确保使用 android.permission.WRITE_EXTERNAL_STORAGE 正确配置您的权限

为了完整起见，在此处发布此内容，因为我从 insertImage 获得了 null，原因是*1。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-29T18:56:41.067

当我在具有新 sdcard 映像的模拟器上运行测试时遇到了这个问题。我能够通过创建来解决`/sdcard/Pictures`问题

`new File("/sdcard/Pictures").mkdirs();`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-06-13T11:20:14.113

确保您在清单文件中添加了权限。

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

然后在调用之前添加此代码

> MediaStore.Images.Media.insertImage

```
File sdcard = Environment.getExternalStorageDirectory();
    if (sdcard != null) {
        File mediaDir = new File(sdcard, "DCIM/Camera");
        if (!mediaDir.exists()) {
            mediaDir.mkdirs();
        }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-10-06T14:21:08.087

我遇到了同样的问题，但没有任何效果。但最终在3小时后它起作用了。

> **解决方案：**我发现它可以正常工作，直到我们从图片库中删除该图片。之后它开始返回**null。**但突然间我尝试更改标题和描述名称，它就像一个魅力。

> 所以我添加了一个**带有位图标题和描述**的日期。万一，用户从文件管理器中手动删除位图。仍然有效。

```
 private fun insertImage(cr: ContentResolver,
        source: Bitmap?,
        title: String,
        description: String
    ): String? {

        val sdf = SimpleDateFormat("MM-dd-yyyy-hh.mm.ss.SSS.a", Locale.US)
        val date=sdf.format(Date())

        val values = ContentValues()
        values.put(Images.Media.TITLE, title)
        values.put(Images.Media.DISPLAY_NAME, title+date)
        values.put(Images.Media.DESCRIPTION, description+date)
        values.put(Images.Media.MIME_TYPE, "image/jpeg")
        // Add the date meta data to ensure the image is added at the front of the gallery
        values.put(Images.Media.DATE_ADDED, System.currentTimeMillis() / 1000)
        values.put(Images.Media.DATE_TAKEN, System.currentTimeMillis())

        var url: Uri? = null
        var stringUrl: String? = null    /* value to be returned */

        try {
            url = cr.insert(Images.Media.EXTERNAL_CONTENT_URI, values)

            if (source != null) {
                val imageOut = cr.openOutputStream(url!!)
                try {
                    source.compress(Bitmap.CompressFormat.JPEG, 50, imageOut)
                } finally {
                    imageOut!!.close()
                }

            } else {
                cr.delete(url!!, null, null)
                url = null
            }
        } catch (e: Exception) {
            if (url != null) {
                cr.delete(url, null, null)
                url = null
            }
        }

        if (url != null) {
            stringUrl = url.toString()
        }

        return stringUrl
    } 
```

> 我实现了在[这个应用程序](https://play.google.com/store/apps/details?id=com.mayadi.androidbreakdown)中共享新闻位图，它工作正常。享受！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-28T15:43:47.010

当我遇到这样的问题时，我通过添加权限来修复它：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-27T12:23:58.673

我在获得**WRITE_EXTERNAL_STORAGE**和**READ_EXTERNAL_STORAGE**`MediaStore.Images.Media.insertImage`的用户权限之前正在执行，这导致了空路径

 ****因此，请确保用户已获得许可，然后存储图像

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-12T05:28:43.073

尝试这个：

```
MediaStore.Images.Media.insertImage(context.getContentResolver(), bitmap, "filename", null); 
```

Android 10 需要方法的第三个参数上的实际文件名`insertImage()`。****

# c# - 加载 word 的 .docm 文档

> ID：12230949
> 
> 赞同：0
> 
> 时间：2012-09-01T19:58:24.280
> 
> 标签：c#, winforms, office-interop

我尝试加载带有 .docm 扩展名的文档，如下所示：

```
Microsoft.Office.Interop.Word.Application  
             ap = new Microsoft.Office.Interop.Word.Application();

Document doc = ap.Documents.Open(docName); 
```

文件打不开，我在任务管理器里看到一个winword的进程

# yui - YUI3 自动完成在顶部有图像 - 如何让自动完成到顶部

> ID：12230952
> 
> 赞同：0
> 
> 时间：2012-09-01T19:58:48.280
> 
> 标签：yui

我的自动 YUI 自动完成 zindex 已关闭。如何强制自动完成 DIV 到顶部。

![在此处输入图像描述](../Images/8e57e21df1ae08e97c49125c7a09d615.png)

下面我使用 YUI 的标准模板：

YAHOO.util.Event.onDOMReady(function(){ YUI().use("autocomplete", "autocomplete-filters", "autocomplete-highlighters", function (Y) { var inputNode = Y.one('#name' ），标签= ['css'，'css3'，'douglas crockford'，'ecmascript'，'html'，'html5'，'java'，'javascript'，'json'，'node.js'，'pie ', 'yui' ], lastValue = '';

```
 inputNode.plug(Y.Plugin.AutoComplete, {
                activateFirstItem: true,
                minQueryLength: 0,
                queryDelay: 0,
                source: tags,
                resultHighlighter: 'startsWith',
                resultFilters: ['startsWith']
        });

        // When the input node receives focus, send an empty query to display the full
        // list of tag suggestions.
        inputNode.on('focus', function () {
                inputNode.ac.sendRequest('');
        });

        // When there are new AutoComplete results, check the length of the result
        // list. A length of zero means the value isn't in the list, so reset it to
        // the last known good value.
        inputNode.ac.on('results', function (e) {
                if (e.results.length) {
                        lastValue = inputNode.ac.get('value');
                } else {
                        inputNode.set('value', lastValue);
                }
        });

        // Update the last known good value after a selection is made.
        inputNode.ac.after('select', function (e) {
                lastValue = e.result.text;
        });
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:18:50.317

只需将 z-index 放在 css 中。过去允许通过 JS 进行设置，但从 YUI 3.4.0 开始，它是一个仅限 css 的标志（https://github.com/yui/yui3/blob/master/src/autocomplete/HISTORY.md）。

相关的 CSS 是（根据需要调整您的 z-index）：

```
.yui3-aclist { z-index: 100; } 
```

PS.，你的雅虎。行来自 YUI2，所以这很奇特，绝对不是标准模板。

当你在 YUI().use(...) 部分中的回调被调用时，dom 应该已经准备好了。不需要ondomready。

# xml - xquery newbie-如何在嵌套的 if-else 中显示一些文本

> ID：12230955
> 
> 赞同：1
> 
> 时间：2012-09-01T19:59:15.650
> 
> 标签：xml, xquery

我正在尝试运行以下 XQuery 代码-

```
declare variable $doc="E:\Arvind\Workspace\XML\test.xml"
let $page_title:= $doc//title[contains(.,'Error 404')]
let $assignee_block := $doc//div[@class="patent_bibdata" and contains(.,'Original        Assignee')]
for $assignee_link in $assignee_block/a 
for $assignee_link_url in $assignee_link/@href
where  contains($assignee_link_url,'inassignee') 
 return
if($page_title) then
     '404'
 else if ($assignee_block) then 
        return data($assignee_link)
  else return 'Missing' 
```

但是我收到了这个错误-

```
 XQuery syntax error in #...) else return 'Missing'#:
 Unexpected token "<eof>" in path expression 
```

我在这里做错了什么？如何在最后的 else 中显示静态文本“Missing”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:28:41.730

> 我在这里做错了什么？

**很明显**：

`$doc`被声明为*字符串*=`"E:\Arvind\Workspace\XML\test.xml"`

**在下一行：**

```
let $page_title:= $doc//title[contains(.,'Error 404')] 
```

XPath 伪运算符`//`不能应用于字符串。

**要更正此问题，请更改**：

```
declare variable $doc="E:\Arvind\Workspace\XML\test.xml" 
```

**至**：

```
declare variable $doc=doc("E:\Arvind\Workspace\XML\test.xml") 
```

此外，因为`doc()`接受*URI*，所以文件路径必须如下所示：

```
declare variable $doc=doc("file:///E:/Arvind/Workspace/XML/test.xml") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:24:03.580

在`if`表达式中，不需要指定`return`关键字。接下来，变量声明需要`:=`而不是`=`：

```
declare variable $doc := "E:\Arvind\Workspace\XML\test.xml";
let $page_title := $doc//title[contains(.,'Error 404')]
let $assignee_block := $doc//div[@class="patent_bibdata" and contains(.,'Original        Assignee')]
for $assignee_link in $assignee_block/a 
for $assignee_link_url in $assignee_link/@href
where contains($assignee_link_url,'inassignee') 
return
  if($page_title) then '404'
  else if ($assignee_block) then data($assignee_link)
  else 'Missing' 
```

在开发过程中，使用直接为您提供语法错误反馈的编辑器（例如 BaseX GUI 或 oXygen）可能会有所帮助。

# java - CXF选择性服务曝光

> ID：12230969
> 
> 赞同：1
> 
> 时间：2012-09-01T20:00:48.597
> 
> 标签：java, web-services, apache, wsdl, cxf

CXF 服务可以选择性地暴露给不同的消费者/客户吗？

例如，如果我的 WSDL 中有方法 A、B、C、D，我可以只为一个消费者提供 A、C，而为不同的消费者提供所有四种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:18:53.243

Web 服务只是一个 URL，调用 WS 方法就是发送封装在信封中的格式正确的请求。从该描述中，您可能会猜到您无法隐藏或阻止某些客户端的某些方法。您的客户可以自由发送他们想要的任何请求。WSDL 中不存在该方法的事实（如果您设法将不同的 WSDL 发送到不同的客户端）并不意味着该方法将从服务中消失。

由您决定哪个客户端尝试连接并允许或拒绝访问某些方法。*允许*或*拒绝*是这里的关键字。您必须在您的服务之上实现一些授权和身份验证的概念，并在某些客户端无权访问某些方法时阻止它们。

# iphone - 从我的 iPhone 应用程序中删除项目时冒烟（或）爆炸动画

> ID：12230970
> 
> 赞同：3
> 
> 时间：2012-09-01T20:00:51.313
> 
> 标签：iphone, objective-c, xcode, cocoa-touch, animation

我想从我的 iPhone 应用程序中删除一个项目（比如说 UIButton）。当我点击按钮将其删除时，我想添加一些动画。

*这是我想要的动画*：

```
In your OSX dock, if you right-click on an item and tap on *remove from dock*, 
it kinda like **explodes** with a funny noise, and removes itself from that dock. 
```

任何人都知道如何在 iPhone 上制作*烟雾*（或）微小的爆炸动画？它有预定义的名称吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T23:44:57.653

信不信由你，在 Mac OS X 上有一个 API：

```
NSPoint centrePoint = ...;
NSSize size = ...;
NSShowAnimationEffect(NSAnimationEffectPoof, centrePoint, size, nil, NULL, NULL); 
```

在 iOS 上，没有，因为动画是 Mac 特定的动画。在 iOS 上，通常会看到已删除的对象折叠成一个点。该动画可以通过对视图的变换进行动画处理（使用`CAAnimation`或`UIView`类方法）来完成，使其缩放到虚无。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T23:20:16.720

你可以使用 CAEmitterLayer 自己动手——在 SO 和其他地方有很多例子。你可以做一些非常好的事情（或者也许找到一些非常好的开源代码）。

# android - 从自定义 SeekBarPreference 中获取价值

> ID：12230975
> 
> 赞同：2
> 
> 时间：2012-09-01T20:01:29.487
> 
> 标签：android, seekbar, preference

我在互联网上找到了这段代码，并认为我会试一试。我把它放在我的偏好中，这正是我想要的方式，但我唯一的问题是我无法获得 SeekBar 的价值。

这是我在偏好中使用的代码链接：

[http://android.hlidskialf.com/blog/code/android-seekbar-preference](http://android.hlidskialf.com/blog/code/android-seekbar-preference)

这是偏好xml的一部分：

```
<com.mypack.SeekBarPreference android:key="zoom"
        android:title="Zoom"
        android:summary=""
        android:dialogMessage="Zoom level"
        android:defaultValue="50"
        android:text=" %"
        android:max="100"
        /> 
```

谁能告诉我在用户在首选项窗口中更改搜索栏后如何获得搜索栏的价值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:18:18.580

您可以使用 [setOnPreferenceChangeListener()](http://developer.android.com/reference/android/preference/Preference.html#setOnPreferenceChangeListener%28android.preference.Preference.OnPreferenceChangeListener%29)：

```
SeekBarPreference mSeekBarPreference = new SeekBarPreference(this, null);
mSeekBarPreference.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener() {

    @Override
    public boolean onPreferenceChange(Preference preference, Object newValue) {
        // TODO Auto-generated method stub
        int value = mSeekBarPreference.getProgress();
        // Or you just cast the newValue Object
        return true;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:12:25.553

应该就像任何其他偏好一样。

在您的活动中实施`SharedPreferences.OnSharedPreferenceChangeListener`，然后：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences( YourActivity.this );
prefs.registerOnSharedPreferenceChangeListener( this ); 
```

-

```
public void onSharedPreferenceChanged( SharedPreferences prefs, String key ) {
    mZoomValue = prefs.getInt( "zoom", 50 );
} 
```

# javascript - 为什么我的 .blur() 代码只适用于第二次模糊？

> ID：12230977
> 
> 赞同：0
> 
> 时间：2012-09-01T20:02:55.360
> 
> 标签：javascript, jquery

我有一个输入，当用户输入某些内容时，我的脚本将信息发送到一个 php 脚本，该脚本返回是否可以使用输入的文本。

如果无法使用文本，它会禁用提交按钮并向结果文本添加一个类。

问题很奇怪，ajax 工作，返回结果，但是除非您再次聚焦并模糊输入，否则不会发生按钮禁用和添加类。

这是我的代码：

```
$('#alias').blur(function() {
if ($('#alias').val()) {
    var aliascheck = $('#alias').val();
    $(".aliascheck").load('checkalias.php?alias='+aliascheck);

    var result = $('.aliascheck').text();
    if (result.indexOf("Taken") != -1) {
        $('#shorten').attr("disabled","disabled");
        $('.aliascheck').addClass('error');
    } else {
        $('#shorten').removeAttr("disabled");
        $('.aliascheck').removeClass('error');
    }
}
}); 
```

代码位于此处： http: [//markhenderson.ws/dev/tmtmu/](http://markhenderson.ws/dev/tmtmu/) 要复制“taken”事件，请输入“taken”作为别名。其他任何东西都将返回可用。

有谁知道为什么会这样？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:18:51.243

您需要将调用后的代码`.load`放入异步调用的回调函数中。

就像是：

```
$('#alias').blur(function() {
if ($('#alias').val()) {
    var aliascheck = $('#alias').val();
    $(".aliascheck").load('checkalias.php?alias='+aliascheck, function() {
        var result = $('.aliascheck').text();
        if (result.indexOf("Taken") != -1) {
            $('#shorten').attr("disabled","disabled");
            $('.aliascheck').addClass('error');
        } else {
            $('#shorten').removeAttr("disabled");
            $('.aliascheck').removeClass('error');
        }

    });

}
}); 
```

# javascript - 使用代码包含 jQuery

> ID：12230980
> 
> 赞同：1
> 
> 时间：2012-09-01T20:03:06.107
> 
> 标签：javascript, jquery

我必须使用代码在页面中包含 jQuery：

```
if (typeof window.jQuery === "undefined") {
    document.write('<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"><\/script>');
    if (typeof Prototype !== "undefined") {
        document.write('<script>jQuery.noConflict();<\/script>');
    }
} 
```

但是，如果我尝试使用 jQuery，Firebug 会记录“jQuery undefined”。

```
jQuery(document).ready(function() {
    //
}); 
```

但 jquery 已正确加载

![jQuery](../Images/c7b8585d4358967a46412ce44ba9504e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:11:59.357

我建议不要使用 document.write，使用 dom 操作。

```
if (typeof window.jQuery === "undefined") {
    var script = document.createElement('script');
    script.onload = function(){
        if (typeof Prototype !== "undefined") {
            jQuery.noConflict();
        }
    }
    script.src = 'http://code.jquery.com/jquery-latest.min.js';
    document.getElementsByTagName('head')[0].appendChild(script);   
} 
```

[http://jsfiddle.net/ALCDr/](http://jsfiddle.net/ALCDr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:17:35.117

```
window.onload = function() {
  jQuery(document).ready(function() {
    alert('!');
  });
} 
```

做的伎俩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T23:59:21.297

HTML5 样板的方式是最有效的方式。

```
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script> 
```

这将检查是否已定义 jQuery（即已加载），或者（如果没有）它将加载将脚本写入页面:)。

# javascript - 如何使用 Twitter Bootstrap 在按钮单击时导航到另一个页面？

> ID：12230981
> 
> 赞同：14
> 
> 时间：2012-09-01T20:03:11.747
> 
> 标签：javascript, jquery, twitter-bootstrap

我必须渲染一个驻留在`templates/home.html`

我有一个按钮`index.html`：

```
<div id="browse_app">
    <button class="btn btn-large btn-info" type="button">Browse</button>
</div> 
```

我想做的就是当我点击时`Browse`，它**会带**我去`home.html`

我试着写成`jQuery`：

```
// onClick on 'Browse' load the internal page
$(function(){
    $('#browse_app').click(function(){
        $.load('templates/home.html');
    });
}); 
```

但这不起作用，因为加载需要将数​​据放在当前页面的某个位置

如何到达`home.html`on 按钮单击？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-01T20:08:47.850

据我所知，您正在使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/index.html)。[Buttons](http://twitter.github.com/bootstrap/base-css.html#buttons)的文档解决了您的问题：

> **默认按钮**
> 
> 按钮样式可以应用于任何应用了`.btn`类的东西。但是，通常您只想将这些应用于`<a>`和`<button>`元素以获得最佳渲染效果。

这就是你想要的：

```
<div id="browse_app">
  <a class="btn btn-large btn-info" href="templates/home.html">Browse</a>
</div> 
```

在最坏的情况下，这样按钮的渲染效果不会很好，但链接会起作用。使用 JS，最坏的情况会使链接变得无用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-10-03T02:33:14.110

使用：在您的按钮标签中`onclick="window.location='`插入 HTML 文件`'"`

我之前准备的一个： `<button class="btn" style="text-align:inherit" onclick="window.location='./Learn/'">&laquo; About HerdMASTER 4</button>`

我想去目录从同一文件夹中的另一个目录学习

这是使用包含的引导类的更优雅的解决方案，这意味着您不必将代码破解到您的页面中。我希望有更多关于引导程序的各种类的功能文档，因为我从上面的代码中发现了这一点，而不是通过谷歌搜索找到它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-01T20:04:28.630

用这个：

```
$(function(){
    $('#browse_app').click(function(){
        window.location='templates/home.html'
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-30T11:52:55.907

使用 onclick="window.open('YourPage.aspx','_self');"

例如：

```
<button type="submit" onclick="window.open('YourPage.aspx','_self');" class="btn btn-default">Your Page</button> 
```

# ruby - 如何在运行时在 ruby 中设置命名空间？

> ID：12230982
> 
> 赞同：1
> 
> 时间：2012-09-01T20:03:22.820
> 
> 标签：ruby, activerecord, module, namespaces, metaprogramming

我有一个通过命令行实用程序使用的基于 ActiveRecord 的应用程序。在这样的应用程序中命名模型有利于保持对象命名空间的清洁。

我开始围绕这些 ActiveRecord 模型构建一个 rails 应用程序，尽管我已经克服了在命名空间中使用模型的一些最初的麻烦，但我发现事情比我想要的更冗长。

我想要的是在命令行实用程序中使用时以编程方式为我的 ActiveRecord 类设置命名空间，并在 Rails 应用程序中使用时不以编程方式为这些模型设置命名空间。

我知道文件本身可以在需要之前在运行时进行更改，但我正在寻找 Ruby 语言本身的一些东西来干净地完成这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T02:07:31.023

很难在没有看到一些代码的情况下提供一个很好的建议，但这里有两种可能性。

1.  听起来您有两个用于此代码的客户端。也许让它成为一个引擎（只是一个花哨的 gem），你可以将你的路径添加到自动加载路径，然后从 gem 中使用它，而不会妨碍所有的轨道废话。

2.  也许创建一个常量，然后在模型中重新打开它：

在一些初始化程序中

```
ActualNamespace = Class.new
DynamicNamespace = ActualNamespace 
```

在您的模型文件中

```
class DynamicNamespace
  class MyModel
  end
end

DynamicNamespace::MyModel # => ActualNamespace::MyModel 
```

然后为您的命令行应用程序

```
DynamicNamespace = Object 
```

这与没有命名空间相同：

```
DynamicNamespace::MyModel # => MyModel 
```

现在，您可能会在很大程度上基于反射的 Rails 魔法中遇到困难。我不完全知道您将面临什么，但我希望表单在提交数据时开始生成错误的键。您可以通过`DynamicNamespace.name`按照这些思路定义某些东西或某些东西来解决这个问题。

自动加载，也可能成为一个问题，但我认为你可以以某种方式声明自动加载路径（我不确定，但谷歌搜索“rails autoloading”给出了一些有希望的结果，看起来它只是挂钩到 Ruby 的自动加载 - 虽然我认为这在 Ruby 2.0 中会消失）最坏的情况下，您可能可以定义一个 railtie 来为您急切地加载目录。这有点不符合我的要求，但我假设您需要在应用程序初始化之前定义的 railtie，所以您可能需要在 config/application.rb 中使用 railtie

不幸的是，在一天结束时，当你开始偏离 Rails 约定时，生活开始变得艰难，所有你从未想过的魔法都崩溃了，所以你突然不得不深入到 Rails 代码库中找出它是什么正在做。

# android - ActionbarSherlock 没有出现

> ID：12230983
> 
> 赞同：1
> 
> 时间：2012-09-01T20:03:23.347
> 
> 标签：android, actionbarsherlock

我在使用 ActionBar Sherlock（最新版本）时遇到问题，成功编译后，我在应用程序中看不到 ActionBar。只是黑屏和默认的TextView ...在安装库出现问题之前，但在将支持库添加到ActionBarSherlock 之后，我可以构建它。

```
import com.actionbarsherlock.app.SherlockActivity; 
```

公共类 MainActivity 扩展 SherlockActivity {

```
 @Override
    public void onCreate(Bundle savedInstanceState) { 
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
} 
```

}

显现：

```
android:theme="@style/Theme.Sherlock" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:44:25.860

确保您`android:targetSdkVersion`在清单中设置为 11 或更高。

# matlab - 在 GUIDE 中加载文件以在 MATLAB 中读取 2 列

> ID：12230994
> 
> 赞同：1
> 
> 时间：2012-09-01T20:04:56.517
> 
> 标签：matlab, user-interface

我已经在这里待了 3 个小时——所以我需要帮助。

我在 MATLAB 的 GUIDE 上有一个按钮，用于加载文本文件以将 2 列数据存储为`x`和`y`.

所以`x = [12, 12, 23];`

文本文件 A 是：

```
 12 23
  12 32
  23 32 
```

GUI GUIDE 中的代码位于`pushbutton`load_file 下，如下所示：

```
filename = uigetfile('*.txt')
loaddata = fullfile(pathname,filename)
load(loaddata)
A = filename(:,1)
B = filename(:,2)
handles.input1 = A;
handles.input2 = B;
axes(handles.axes1)
plot(handles.input1,handles,imput2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T01:39:56.847

首先，您可能想发布错误消息以确保我报告了正确的问题，但我可以立即看到一个问题：

行：

```
A = filename(:,1)
B = filename(:,2) 
```

仅检索命名文件的字符串，而不是实际数据。因此，首先，您必须知道正在加载的数据的名称，然后将加载行更改为：

```
data = load(loaddata,'-ascii') 
```

现在：

```
A = data(:,1)
B = data(:,2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T01:52:00.167

`load`将加载一个文本文件，但除非您明确指定输出，否则它不会将内容分配给任何内容。

```
%# load xy data from file
xy = load(loaddata,'-ascii')
%# assign columns to A and B, respectively
%# (why not x,y)?
A = xy(:,1)
B = xy(:,2) 
```

`-ascii`加载选项不是必需的，但可以保证文件以文本形式加载，并帮助您稍后记住数据应该是文本文件。

# iphone - 在大数组中搜索字符串需要很长时间

> ID：12230997
> 
> 赞同：1
> 
> 时间：2012-09-01T20:05:45.753
> 
> 标签：iphone, objective-c, ios, nsstring, searchbar

我正在实现一个根据用户输入的文本过滤 UITableView 的搜索字段。
TableView 是由一个包含 NSStrings（要显示和搜索的数据）的数组构建的，并且可能包含**6000 多个项目**。
当用户开始搜索时，我正在实现该`-(void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText`方法。

我的代码可以工作，但是，当数据数组很大时，它会非常慢并且会造成非常糟糕的用户体验（我的 iPhone 4s 卡住了好几秒钟）。

我实现搜索的方式（在上面提到的方法中）是这样的：

```
NSMutableArray *discardedItems = [[NSMutableArray alloc] init]; // Items to be removed
searchResultsArray = [[NSMutableArray alloc] initWithArray:containerArray]; // The array that holds all the data

// Search for matching results
for (int i=0; i<[searchResultsArray count]; i++) {   
    NSString *data = [[containerArray objectAtIndex:i] lowercaseString];
    NSRange r = [data rangeOfString:searchText];
    if (r.location == NSNotFound) {
        // Mark the items to be removed
        [discardedItems addObject:[searchResultsArray objectAtIndex:i]];
    }
}
// update the display array
[searchResultsArray removeObjectsInArray:discardedItems];
[myTableView reloadData]; 
```

我不认为循环一个包含几千个项目的数组会导致任何问题......
**任何建议都将不胜感激！**

**更新** 我刚刚意识到大部分时间是这样的：

```
[searchResultsArray removeObjectsInArray:discardedItems]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:16:22.073

尝试快速枚举方式，我的片段：

```
- (void)searchBar:(UISearchBar*)searchBar textDidChange:(NSString*)text
{
    if(text.length == 0)
    {
        self.isFiltered = NO;
    }
    else
    {
        self.isFiltered = YES;
        self.searchArray = [NSMutableArray arrayWithCapacity:self.places.count];

        for (PTGPlace* place in self.places)
        {
            NSRange nameRange = [place.name rangeOfString:text options:NSCaseInsensitiveSearch];

            if(nameRange.location != NSNotFound)
            {
                [self.searchArray addObject:place];
            }
        }
    }

    [self.tableView reloadData];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if(self.isFiltered)
        return self.searchArray.count;
    else
        return self.places.count;
} 
```

在 cellForRowAtIndexPath 中：

```
 PTGPlace *place = nil;

    if(self.isFiltered)
        place = [self.searchArray objectAtIndex:indexPath.row];
    else
        place = [self.places objectAtIndex:indexPath.row];

    // Configure the cell...
    cell.textLabel.text = place.name;
    cell.detailTextLabel.text = [place subtitle]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:03:05.250

尝试这个：

对于前三个位置，创建 26 个索引集，每个表示具有该字母的项目的数组索引（只是小写）。也就是说，假设 idx=100 处的条目以“公式”开头。在第一个位置表示“f”的索引集将包含索引“100”。为第二个字符“o”设置的索引将包含索引 100，为第三个字符“r”设置的索引将包含 100。

当用户键入字符“f”时，您会立即获得所有以“f”开头的数组项的索引集（并且可以快速创建主要数组的子集）。当接下来键入“o”时，您可以找到第一个匹配项与第二个匹配项中的索引的交集。第三个同上。现在制作一个前三个索引匹配的主数组的子数组 - 您可以为此使用索引集。

使用这个大大减少的数组，您现在可以像原来一样进行蛮力匹配。

# iphone - 在 Objective-C 中用单例声明全局变量

> ID：12230998
> 
> 赞同：2
> 
> 时间：2012-09-01T20:05:53.920
> 
> 标签：iphone, variables, save, global-variables, global

我正在寻找在我的所有类中全局存储和读取变量的最佳方式。我知道我可以使用“单例”，但是我不确定这是否是存储变量的最佳方法或如何准确地执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T20:27:55.140

我使用单例，这是我的做法：

创建一个新类，为了演示，我们将其命名为`MyDataModel`。在**MyDataModel.h**中执行以下操作：

```
#import <Foundation/Foundation.h>

@interface MyDataModel : NSObject
{
    NSString *myStringVariable;
    NSUInteger myIntVariable;
    //add any variables you need
}

@property (nonatomic, retain) NSString *myStringVariable;
@property (nonatomic) NSUInteger myIntVariable;

+ (MyDataModel *) sharedInstance;

@end 
```

现在在**MyDataModel.m**中执行：

```
#import "MyDataModel.h"

@implementation MyDataModel

@synthesize myStringVariable, myIntVariable;

static MyDataModel *_sharedInstance;

+ (MyDataModel *) sharedInstance
{
    if(!_sharedInstance)
    {
        _sharedInstance = [[MyDataModel alloc] init];
    }
    return _sharedInstance;
}

@end 
```

现在在任何你想使用这个单例的类中，你都必须使用`#import`这个类，这里​​是如何使用变量：

```
[MyDataModel sharedInstance].myStringVariable = @"anyThing";
[MyDataModel sharedInstance].myIntVariable = 123; 
```

我希望这可以为您澄清事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:41:12.087

您可以使用 NSUserDefaults、AppDelegate 中的变量（不建议）或单例。我总是在我的应用程序中创建一个单例来存储各种变量和方法。