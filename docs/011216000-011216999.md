# StackOverflow 问答 11216000-11216999

# mysql - 如何以 Pythonic 方式在 MySQL 中存储 Python 字典列表？

> ID：11216001
> 
> 赞同：1
> 
> 时间：2012-06-26T21:13:32.003
> 
> 标签：mysql, database, dictionary, python

我有一本词典列表。为什么我会选择这种奇怪的方法？这是网络抓取工作的一部分，其中我将大量网页的不同部分存储在不同的字典中。我有列名来跟踪数据。我没有订购 dicts 因为我在 Python 2.6.6 上。

存储此数据的更有效方法是什么（字典到 mysql）？每次我抓取网站时，我都会创建一个临时表来存储数据以供进一步处理。我首先为 id 创建一条记录，然后更新该 id 的列。有没有更快更有效的方法呢？谢谢！

**Python**

```
import MySQLdb

db=MySQLdb.connect(db="mydb")
c=db.cursor()

mydict = {'1': [{'First': 'John', 'Last': 'Doe'}, {'Company': 'Trulia Inc.', 'Title': 'CEO', 'YearsattheCompany': 4}, {'Cell': '216-453-4322', 'Home': None}]}

for key, value in mydict.items():
    id = key
    c.execute("insert into deldictmysql (id) values (%s)" % id)
    for eachdict in value:
        print eachdict
        for finalkey, finalvalue in eachdict.items():
            print finalkey, finalvalue
            if finalvalue:
                query = "update deldictmysql set %s = '%s'"
                c.execute(query % (finalkey, finalvalue))

c.close() 
```

**MySQL**

```
create table deldictmysql (id integer, first varchar(40), last varchar(40), company varchar(200), title varchar(200), yearsatthecompany integer, cell varchar(20), home varchar(20)); 
```

**输出**

```
select * from deldictmysql;

"id"    "first" "last"  "company"   "title" "yearsatthecompany" "cell"  "home"
"1" "John"  "Doe"   "Trulia Inc."   "CEO"   "4" "216-453-4322"  "" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:00:22.290

只需将字典展平并插入它们：

```
def encoding(val):
    if isinstance(val, unicode):
        return val.encode('utf-8')
    else:
        return str(val)

for id, val in mydict.items():
    data = dict(reduce(lambda x, y: x+y, [v.items() for v in val]) + [('id', id)])
    sorted_keys = sorted(map(str, data.keys()))
    sorted_vals = map(encoding, [v[k] for k in sorted_keys])  # sorted by keys
    format = ', '.join(["'%s'"] * len(sorted_vals))
    c.execute("insert into deldictmysql
               (%s) values (%s)" % (', '.join(sorted_keys), format), sorted_vals) 
```

UPD：适用于任意数量和值的键

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:04:23.167

您可以做的一项改进是发出一个更新查询：

```
for key, value in mydict.iteritems():
    id = key
    c.execute("insert into deldictmysql (id) values (%s)" % id)
    for eachdict in value:
        print eachdict
        items = [item for item in eachdict.iteritems() if item[1]]
        query_values = tuple(itertools.chain(*items))
        query = "update deldictmysql set "+", ".join("%s = '%s'" for i in items)
        c.execute(query % query_values) 
```

或者更好的是，一个单一的插入查询：

```
for key, value in mydict.iteritems():
    id = key
    keys = []
    values = []
    for eachdict in value:
        print eachdict
        for finalkey, finalvalue in eachdict.iteritems():
            if not finalvalue: continue
            keys.append(finalkey)
            values.append(finalvalue)
    keys_part = ", ".join("%s" for k in keys)
    values_part = ", ".join("'%s'" for v in values)
    query_values = keys+[id]+values
    c.execute("insert into deldictmysql (id, "+keys_part+") values (%s"+values_part+")" % query_values) 
```

如果您可以保证 dict 中的所有值都具有相同的键，则可以遵循相同的逻辑在一个查询中发出所有插入。类似的东西`"insert into deldictmysql (id, "+keys_part+") values "+(", ".join("(%s"+values_part+")" for i in range(len(mydict)))) % query_values`（对不起`)`最后的系列:)）并`query_values`相应地构建。

另外，正如我注意到您在 print 语句中使用 Python 2.7 时，我相信您最好使用`iteritems`instead of `items`，它返回一个迭代器而不是一个列表，如果您的字典中有很多项目，这很方便。

在这一切中最重要的是你没有清理你的查询，这很糟糕。这里的问题是您不能使用经典的`c.execute(sql, params)`, 来绑定参数，因为即使列名也是动态的，这没有涵盖。所以你必须手动清理这些，并且还要***信任***密钥，因为你可能无法清理这些。

这将大致为您提供：

```
values.append(MySQLdb.escape_string(finalvalue)) 
```

附加值时。

请注意，这只是让您了解可以做什么，并且在许多情况下会失败。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:25:53.577

1.  考虑使用 redis 之类的东西来存储这类数据。
2.  您可以使用该`json`模块将其序列化为文本。

# ruby-on-rails - 为什么我的 mongoDB 托管 mongoid.yml 的 uri 设置无法正常工作？

> ID：11216002
> 
> 赞同：12
> 
> 时间：2012-06-26T21:13:38.457
> 
> 标签：ruby-on-rails, mongodb, heroku, mongoid

我目前在我的 mongoid.yml 中使用以下设置（**不起作用**），并且我已将`MONGOLAB_URI`环境变量正确添加到我的 heroku 环境中：

```
production:
  sessions:
    default:
      another:
        uri: <%= ENV['MONGOLAB_URI'] %> 
```

我还尝试了以下**不起作用**的方法：

```
production:
  uri: <%= ENV['MONGOLAB_URI'] %> 
```

这也**不起作用**：

```
production:
  sessions:
    default:
      uri: <%= ENV['MONGOLAB_URI'] %> 
```

我在 heroku 推送中收到以下错误：

```
Running: rake assets:precompile
       There is a configuration error with the current mongoid.yml.
       Problem:
       No database provided for session configuration: :default.
       Summary:
       Each session configuration must provide a database so Mongoid knows where the default database to persist to. What was provided was: {"another"=>{"uri"=>nil}}.
       Resolution:
       If configuring via a mongoid.yml, ensure that within your :default section a :database value for the session's default database is defined.
       Example:
       \_\_development:
       \_\_\_\_sessions:
       \_\_\_\_\_\_default:
       \_\_\_\_\_\_\_\_database: my_app_db
       \_\_\_\_\_\_\_\_hosts:
       \_\_\_\_\_\_\_\_\_\_- localhost:27017
       There is a configuration error with the current mongoid.yml.
       Problem:
       No database provided for session configuration: :default.
       Summary:
       Each session configuration must provide a database so Mongoid knows where the default database to persist to. What was provided was: {"another"=>{"uri"=>nil}}.
       Resolution:
       If configuring via a mongoid.yml, ensure that within your :default section a :database value for the session's default database is defined.
       Example:
       \_\_development:
       \_\_\_\_sessions:
       \_\_\_\_\_\_default:
       \_\_\_\_\_\_\_\_database: my_app_db
       \_\_\_\_\_\_\_\_hosts:
       \_\_\_\_\_\_\_\_\_\_- localhost:27017
       Asset precompilation completed (15.47s) 
```

我在这里做错了什么？我已按照 mongoid.org 的说明进行操作：

```
http://mongoid.org/en/mongoid/docs/installation.html 
```

我正在使用**mongoid 3.0.0.rc**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T13:53:00.840

abhas 的例子对我不起作用。这就是最终奏效的方法：

```
production:   
  sessions:
    default:
      uri: <%= ENV['MONGOHQ_URI'] %>
      options:
        skip_version_check: true
        safe: true 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-27T04:31:46.090

试试这个

```
ENV['MONGOLAB_URI'] = ds053681.mongolab.com:97321

production:
  sessions:
    default:
      hosts: 
        - <%= ENV['MONGOLAB_URI'] %>
      database: testapp_production
      username: testappuser
      password: testpassword 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-10T14:59:43.780

来自[https://devcenter.heroku.com/articles/mongolab#mongoid-5](https://devcenter.heroku.com/articles/mongolab#mongoid-5)

```
production:
  clients:
    default:
      uri: <%= ENV['MONGOLAB_URI'] %> 
```

# javascript - JS游戏开发库？

> ID：11216005
> 
> 赞同：4
> 
> 时间：2012-06-26T21:13:39.960
> 
> 标签：javascript, node.js, backbone.js, ember.js, meteor

我有一个实时瓷砖集/地图策略风格的游戏，我正在客户端使用 JavaScript 构建，但是我想利用现有的一个或多个库，这些库可能比我能够更有条理地思考一些问题出发。

例如，我正在查看 Ember.js（使用 Backbone 甚至 Meteor），但是就利用可能已经存在的实用程序而言，我似乎缺少一些选项。您使用或见过哪些游戏 js 开发库在这种情况下可能有用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T21:22:04.617

我找到了一份我认为您可能会喜欢[的优秀 javascript游戏引擎列表。](https://gist.github.com/768272/):)

# wpf - 如何使用 AvalonEdit 编辑 XML 文件

> ID：11216008
> 
> 赞同：3
> 
> 时间：2012-06-26T21:13:50.330
> 
> 标签：wpf, xml, avalonedit

我想在我的应用程序中包含一个 XML 编辑器 - 类似于 VS 的具有自动着色功能的 XML 编辑器等。

AvalonEdit 听起来是一个很好的解决方案。

但是，AvalonEdit 附带了一个 C# 语法示例，而不是 XML 语法。某处是否有 XML 语法的示例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T13:46:27.643

只需`SyntaxHighlighting="XML"`在您的 XAML 中使用：

```
xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
...
<StackPanel>
    <avalonedit:TextEditor SyntaxHighlighting="XML"/>
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T03:11:27.303

您所要做的就是更改 Avalon 中的 xshd 文件以将其更改为您需要的语言要求。SharpDevelop Git 上已经提供了许多通用语言语法突出显示：[链接](https://github.com/icsharpcode/AvalonEdit/tree/697ff0d38c95c9e5a536fbc05ae2307ec9ef2a63/ICSharpCode.AvalonEdit/Highlighting/Resources)

对于 XML，xshd 文件如下所示：

```
<SyntaxDefinition name="XML"     extensions=".xml;.xsl;.xslt;.xsd;.manifest;.config;.addin;.xshd;.wxs;.wxi;.wxl;.proj;.csproj;.vbproj;.ilproj;.booproj;.build;.xfrm;.targets;.xaml;.xpt;.xft;.map;.wsdl;.disco;.ps1xml;.nuspec" xmlns="http://icsharpcode.net/sharpdevelop/syntaxdefinition/2008">
<Color foreground="Green" name="Comment" exampleText="&lt;!-- comment --&gt;" />
<Color foreground="Blue" name="CData" exampleText="&lt;![CDATA[data]]&gt;" />
<Color foreground="Blue" name="DocType" exampleText="&lt;!DOCTYPE rootElement&gt;" />
<Color foreground="Blue" name="XmlDeclaration" exampleText='&lt;?xml version="1.0"?&gt;' />
<Color foreground="DarkMagenta" name="XmlTag" exampleText='&lt;tag attribute="value" /&gt;' />
<Color foreground="Red" name="AttributeName" exampleText='&lt;tag attribute="value" /&gt;' />
<Color foreground="Blue" name="AttributeValue" exampleText='&lt;tag attribute="value" /&gt;' />
<Color foreground="Teal" name="Entity" exampleText="index.aspx?a=1&amp;amp;b=2" />
<Color foreground="Olive" name="BrokenEntity" exampleText="index.aspx?a=1&amp;b=2" />

<RuleSet>
    <Span color="Comment" multiline="true">
        <Begin>&lt;!--</Begin>
        <End>--&gt;</End>
    </Span>
    <Span color="CData" multiline="true">
        <Begin>&lt;!\[CDATA\[</Begin>
        <End>]]&gt;</End>
    </Span>
    <Span color="DocType" multiline="true">
        <Begin>&lt;!DOCTYPE</Begin>
        <End>&gt;</End>
    </Span>
    <Span color="XmlDeclaration" multiline="true">
        <Begin>&lt;\?</Begin>
        <End>\?&gt;</End>
    </Span>
    <Span color="XmlTag" multiline="true">
        <Begin>&lt;</Begin>
        <End>&gt;</End>
        <RuleSet>
            <!-- Treat the position before '<' as end, as that's not a valid character
                 in attribute names and indicates the user forgot a closing quote. -->
            <Span color="AttributeValue" multiline="true" ruleSet="EntitySet">
                <Begin>"</Begin>
                <End>"|(?=&lt;)</End>
            </Span>
            <Span color="AttributeValue" multiline="true" ruleSet="EntitySet">
                <Begin>'</Begin>
                <End>'|(?=&lt;)</End>
            </Span>
            <Rule color="AttributeName">[\d\w_\-\.]+(?=(\s*=))</Rule>
            <Rule color="AttributeValue">=</Rule>
        </RuleSet>
    </Span>
    <Import ruleSet="EntitySet"/>
</RuleSet>

<RuleSet name="EntitySet">
    <Rule color="Entity">
        &amp;
        [\w\d\#]+
        ;
    </Rule>

    <Rule color="BrokenEntity">
        &amp;
        [\w\d\#]*
        #missing ;
    </Rule>
</RuleSet>
</SyntaxDefinition> 
```

# jquery - 选中一个复选框并更改另一个选项的字体颜色

> ID：11216013
> 
> 赞同：0
> 
> 时间：2012-06-26T21:14:11.890
> 
> 标签：jquery

这是我的演示代码[http://jsfiddle.net/Wwdmm/3/](http://jsfiddle.net/Wwdmm/3/)

但是当我点击时什么都没有发生`require`。我想单击`require`然后更改字体颜色，`option2`并在取消选中时`option2`删除它的类。

有什么错误？选择就在那里。谢谢

```
jQuery(document).ready(function(){
  $('#id_run_options_0').change(function(){
       if (this.checked){
          alert('checked');
          $('#id_run_options_1').addClass('highlight-option2');
       }else{
          alert('unchecked');
          $('#id_run_options_1').removeClass('highlight-option2');
}});
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T21:23:57.207

您正在尝试更改复选框的类（因此是颜色），但您应该更改标签的类（其父元素）。

这是您的代码的简短版本：

```
$("#id_run_options_0").change(function() {
  $("#id_run_options_1").parent().toggleClass("highlight-option2", this.checked);
});​ 
```

**演示：http:** [//jsfiddle.net/Wwdmm/6/](http://jsfiddle.net/Wwdmm/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:15:48.207

您可以使用[`toggleClass`](http://api.jquery.com/toggleClass/)方法简化类切换

```
jQuery(document).ready(function(){
  $('#id_run_options_0').change(function(){
      $('#id_run_options_1').parent().toggleClass('highlight-option2');
  });

  $('#id_run_options_1').change(function(){
      $('#id_run_options_1').parent().toggleClass('highlight-option2');
  });    
}); 
```

[jsFiddler 演示](http://jsfiddle.net/cMd9U/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:26:45.113

即使这段代码也能解决

```
$('#id_run_options_0').click(function(){
            $('label[for="id_run_options_1"]').toggleClass('highlight-option2');
        }); 
```

[jsFiddle 演示链接](http://jsfiddle.net/Vaishak/XdaF6/)

# jquery - 页面加载时如何不显示 JQuery 选项卡式内容

> ID：11216018
> 
> 赞同：0
> 
> 时间：2012-06-26T21:14:19.393
> 
> 标签：jquery, jquery-tabs

我想让 JQuery 选项卡像导航栏一样在用户单击选项卡之前不显示选项卡内容。

我有这段代码隐藏了选项卡式的内容，但也打破了选项卡，因此它们在单击时不显示内容。我无法弄清楚语法，并希望得到一些帮助。我只访问静态 HTML 内容。

```
<pre><script>
$(function() {
    $( "div.panes" ).panes({ selected: -1 });
$("ul.tabs").tabs("div.panes > div");
});
</script></pre> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:29:37.133

使用 jQueryUI 选项卡。这比重新发明轮子更有效。

# php - Ajax 方法显示错误的输入

> ID：11216026
> 
> 赞同：1
> 
> 时间：2012-06-26T21:14:50.553
> 
> 标签：php, javascript, ajax

我再次发布一个我没有满意答案的问题：

我是 AJAX 方法的新手。我想发布一些由 php 页面处理的信息，称之为 page.php

在我的 html 页面中，我输入了以下代码：

```
<script type="text/javascript" charset="utf-8">
//I have put the function getXMLHttpRequest() on a separate js file
function getXMLHttpRequest() {
    var xhr = null;

    if (window.XMLHttpRequest || window.ActiveXObject) {
        if (window.ActiveXObject) {
            try {
                xhr = new ActiveXObject("Msxml2.XMLHTTP");
            } catch(e) {
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            }
        } else {
            xhr = new XMLHttpRequest(); 
        }
    } else {
        alert("Votre navigateur ne supporte pas l'objet XMLHTTPRequest...");
        return null;
    }

    return xhr;
}

function request(callback) {
    var xhr = getXMLHttpRequest();

    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 0)) {
            callback(xhr.responseText);
        }
    };

    xhr.open("POST", "page.php", true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.send("name=proposition");
}

function postData(Data) {

    alert(Data);

}
</script>

<button onclick="request(postData);">...</button> 
```

在page.php中，我有一个方法

```
function comment(){
  //some code processing the posted infos (that works fine)...
  //to debug, I have put a
  echo('Hello world');
} 
```

更准确地说：page.php 的结构是`page.php?page='mypage'&post='post'`。所以首先有一个指向 mypage.php 的方向，然后在 mypage.php 中有一个类的实例化。该`__construct`方法采用 post 变量来调用类中的方法，即`comment()`.

事实是我没有收到任何“Hello world”，而是一条巨大的警报消息，其中显示了我的所有网页代码。有人有想法吗？

最好的，纽本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:37:41.577

我同意 mkk 的观点，并且强烈建议将[jQuery](http://jquery.com/)用于 Ajax-stuff - 它可以让您免去*很多*麻烦，并为您安全地处理容易出错的进程。在你的 head-section 中只需要一行就可以导入它：

```
<head>
  ...
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  ...
<head>
<body>

<script>
  $('#my-btn').click(function() {

    var data = {'key1':'value1','key2':'value2','key3':'value3'};

    $.post('page.php', data, function(callback_data){
      alert(callback_data);
    });

  });
</script>

<button id="my-btn">Make an Ajax request!</button>

<body> 
```

在 page.php 中：

```
<?php
  echo 'The following data was sent: <br />';
  print_r($_POST); 
```

通常您想从数据库中获取一些数据，然后将其写入您的前端。在这种情况下，通常使用 JSON。实际上你应该看看一些有用的 jQuery 函数，比如[post()](http://docs.jquery.com/Post)和[serialize()](http://api.jquery.com/serialize/)，它们有很多很好的例子，可以让你对这些功能有所了解。如果你不喜欢 jQuery，没关系，在使用“普通”JavaScript 时，你甚至不会注意到它的存在。但是当涉及到 Ajax-Requests 时，你真的应该使用 jQuery。谈到 JSON，您可能还需要在服务器端使用[json_encode()](http://php.net/manual/en/function.json-encode.php)。

实际上一般来说指导你是相当困难的，请多熟悉一些技术，如果你遇到一些在 google 上很难问的问题，请回来。

# c# - 使用 ServiceThrottlingBehavior 时如何获取排队的消息

> ID：11216028
> 
> 赞同：0
> 
> 时间：2012-06-26T21:14:53.293
> 
> 标签：c#, wcf

我有受帮助 ServiceThrottlingBehavior 监管的 WCF 服务。我使用属性 MaxConcurrentCalls 来限制呼叫，但我需要知道有多少呼叫停止/等待。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:16:08.497

WCF 中没有用于排队请求的内置性能计数器，因此如果您的服务托管在 IIS 下，则必须使用 ASP.NET 中的性能计数器。

# ios - 获取恰到好处的 UIKeyboard 相关动画

> ID：11216031
> 
> 赞同：0
> 
> 时间：2012-06-26T21:14:57.060
> 
> 标签：ios, cocoa-touch, ios5, core-animation, uikeyboard

我目前正在使用通知来为用户界面元素设置动画`keyboardWillShow`，`keyboardWillHide`以响应`UIKeyboard`屏幕上的出现。

我正在调用一个方法

```
- (void) animateElement: (UIToolbar*) toolbar up: (BOOL) up 
```

在使用通知调用的选择器内部进行广播。该方法创建动画并将它们添加到适当的层。

一切正常，但视觉上的体验令人失望，因为键盘出现在元素翻译之前，因此过渡感觉很突然，因为元素暂时从视图中消失，然后重新出现在正确的位置。动画基本上被键盘动画遮住了。

Path 等其他应用程序具有更好的过渡效果，启动速度更快，不会被键盘遮挡。有谁是如何实现的？我想不出早点调用它的方法，因为在收到通知之前，应用程序无法知道键盘出现了，对吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:18:37.910

查看输入附件视图

```
self.myTextField.inputAccessoryView = self.uiViewforKeyboardAttachment;//Can be any uiview 
```

这将自动附加到此文本字段的 kb。

这可能会减轻您尝试自动为工具栏设置动画的需要。

或者你可以在 notification.userInfo 中使用动画持续时间，它有一个 UIKeyboardAnimationDurationUserInfoKey 的键，它是一个 NSNumber。doubleValue 将是动画的持续时间。

该字典还将具有 UIKeyboardAnimationCurveUserInfoKey、UIKeyboardFrameBeginUserInfoKey 和 UIKeyboardFrameEndUserInfoKey

所有这些都将有助于连接到动画曲线以及起点和终点。

我相信这些是相对于窗口或窗口内的第一个视图。所以一定要转换成你需要知道的视图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-10T15:19:05.720

对于仍然想知道真实值的任何人，我的代码如下所示：

```
[UIView animateWithDuration:0.25f
                      delay:0.0f
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^
 {
     CGRect sendFrame = sendMessageToolbar.frame;
     sendFrame.origin.y = self.tableView.frame.size.height - KEYBOARD_HEIGHT;
     sendMessageToolbar.frame = sendFrame;
 }
                 completion:^(BOOL finished)
 {

 }]; 
```

在模拟器中启用慢速动画，你会看到它完美匹配。

# json - 编写 JSON 序列化器

> ID：11216032
> 
> 赞同：1
> 
> 时间：2012-06-26T21:15:05.500
> 
> 标签：json, web-services, rest, xml-serialization, abap

如果我想为一种尚不存在的语言（例如 ABAP）开发序列化程序，那么其中涉及的工作是什么？它是否仅涉及编写 ABAP 序列化程序的“文本等价物” - 我将如何处理复杂的对象。最好的起点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T18:48:17.827

**更新：**从版本 7.02 和 7.03/7.31（内核补丁 116）开始，ABAP 原生支持 JSON - 查看Horst Keller 的[此博客](http://scn.sap.com/people/horst.keller/blog/2013/01/07/abap-and-json)。

您应该首先使用 site:sap.com 搜索 ABAP 和 JSON，然后选择一个现有项目来学习和贡献。但是，如果您仍然无法获得 NIH 奖励积分，请确保您知道如何使用泛型类型、字段符号、RTTI 和由内而外的递归，然后练习使用 RTTI 递归地遍历复杂数据结构。完成此操作后，组装任何类型的输出字符串都很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T18:46:17.880

有一个类可以做到这一点：CL_TREX_JSON_SERIALIZER。唯一没有的（SAP 通过客户消息告诉我他们不会修复它，他们不支持此代码）是将属性放在双引号中。

这很容易通过在 CL_TREX_JSON_SERIALIZER-RECURSE 中添加第 52 行来解决：

```
CONCATENATE '"' <abapcomp>-name '"' c_colon INTO l_value . 
```

一个示例程序是：

```
"We are going to serialize an error
DATA: wa_error TYPE bapireturn.
"Reference to the serializer
DATA: cl_serializer TYPE REF TO zcl_trex_json_serializer.
"Final output
DATA: l_json_string TYPE string.

wa_error-type = 'E'.
wa_error-code = 'BC'  .
wa_error-message = 'This will serialize correctly.'.

CREATE OBJECT cl_serializer
  EXPORTING
    DATA = wa_error.

cl_serializer->serialize( ) .
l_json_string = cl_serializer->get_data( ) .
WRITE l_json_string. 
```

我使用 zcl_trex_json_serializer ，它是 cl_trex_json_serializer 的克隆，具有前面提到的修复。此代码将返回：

```
{"type": "E", "code": "BC", "message": "This will serialize correctly.", 
"log_no": "", "log_msg_no": "000000", "message_v1": "", "message_v2": "", 
"message_v3": "", "message_v4": ""} 
```

我在包含表等的结构上使用了这段代码；代码似乎能够处理这一切。

# ruby-on-rails-3 - 在许多用户之间共享资源的 Rails 约定？

> ID：11216036
> 
> 赞同：1
> 
> 时间：2012-06-26T21:15:29.523
> 
> 标签：ruby-on-rails-3, concurrency, locking, multi-user

在我的应用程序中，我有用户将对患者记录资源执行 CRUD 操作。通常，在创建患者记录后，它只会被用户读取。但是，在极少数情况下，两个（或更多）用户决定出于某种原因想要编辑该共享资源，解决此问题的最佳方法是什么？

我一直在阅读有关乐观和悲观锁定的信息，但我仍然不清楚这是否仅适用于更新操作，还是每次有人尝试读取资源时都会发生锁定？

我在想的是，是否有一种方法可以在 Rails 中查看两个或多个用户何时在同一页面上，从而通知第二个用户进入编辑页面另一个用户已经在使用该资源，因此只需等待让第一个用户在继续之前完成。

你会如何处理这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-06T14:46:15.310

您可以使用[acts_as_lockable_by](https://github.com/tareksamni/acts_as_lockable_by) gem 来做到这一点。

按照您问题中的示例：

```
class Patient < ApplicationRecord
  acts_as_lockable_by :id, ttl: 30.seconds
end 
```

然后您可以在控制器中执行此操作：

```
class PatientsController < ApplicationController
  def edit
    if patient.lock(current_user.id) 
      # It will be locked for 30 seconds for the current user
      # You will need to renew the lock by calling /patients/:id/renew_lock
    else
      # Could not lock the patient record which means it is already locked by another user
    end
  end

  def renew_lock
    if patient.renew_lock(current_user.id)
      # lock renewed return 200
    else
      # could not renew the lock, it might be already released
    end
  end

  private

  def patient
    @patient ||= Patient.find(params[:id])
  end
end 
```

# php - 静态/非静态方法问题

> ID：11216043
> 
> 赞同：5
> 
> 时间：2012-06-26T21:16:19.253
> 
> 标签：php, oop

我正在研究一个简单的 ORM 解决方案并且遇到了一个棘手的情况。理想情况下，我希望能够在静态上下文和对象上下文中使用方法，具体取决于它的调用方式。我不确定这是否可能，但这就是我的意思：

假设一个用户模型想要静态调用 where()，这目前工作正常，例如：

```
$user = User::where('id = ?', 3); 
```

现在，我也支持关系，例如用户可以有消息。建立这种关系后，我只需将消息模型的空白副本存储在用户模型中并设置外键。例如：

```
$user -> messages = new Message();
$user -> messages -> foreign_key = 'user_id'; 
```

现在，理想情况下，我希望能够调用：

```
$user -> messages -> where('unread = ?', 1); 
```

在非静态上下文中并在此上下文中使用 $this -> foreign_key 以便仅提取外键与用户 ID 匹配的消息。这种类型的上下文切换在 PHP 中是可能的吗？从静态上下文中对 $this 的任何引用都会引发错误，因为它是一个静态方法，并且不应依赖于 $this（出于显而易见的原因，当从静态上下文中调用时，$this 将不存在）

有什么聪明的方法可以解决这个问题吗？我尝试重载该方法以拥有两个不同的原型，有和没有 static 关键字，但这引发了重新声明错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T21:54:46.977

在玩了很多之后，我找到了一种方法来使这个可行，而不会`Strict Standards`出现@drew010 提到的错误。我不喜欢它，感觉很糟糕，但它确实有效，所以我还是会发布这个。

基本上，这个想法是使您想要的方法易于访问`private`，并且`static`. 然后定义`__call()`和`__callStatic()`魔术方法，以便它们调用私有静态方法。现在您可能会认为“这并不能解决问题，我仍然被困在静态上下文中”-您就是这样，但要进行少量添加，您可以附加`$this`到传递给实际方法的参数中，`__call()`并将其作为方法的最后一个参数。因此，您不是`$this`在对象上下文中引用，而是引用第三个参数来获取对您自己的实例的引用。

我可能没有很好地解释这一点，请看一下[这段代码](http://codepad.viper-7.com/dMSs6d)：

```
<?php

class test_class {

    private $instanceProperty = 'value';

    private static function where ($arg1, $arg2, $obj = NULL) {
        if (isset($obj)) {
            echo "I'm in an object context ($arg1, $arg2): I can access the instance variable: $obj->instanceProperty<br>\n";
        } else {
            echo "I'm in a static context ($arg1, $arg2)<br>\n";
        }
    }

    public function __call ($method, $args) {
        $method = "self::$method";
        if (is_callable($method)) {
            $args[] = $this;
            return call_user_func_array($method, $args);
        }
    }

    public static function __callStatic ($method, $args) {
        $method = "self::$method";
        if (is_callable($method)) {
            return call_user_func_array($method, $args);
        }
    }

}

test_class::where('unread = ?', 1);

$obj = new test_class();
$obj->where('unread = ?', 2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T21:27:45.487

如果不违反 PHP 标准并以不应该使用的方式使用该语言，我想不出任何方法来做到这一点。

函数要么是静态的，要么不是。是的，PHP 允许您以任何一种方式调用它，但这确实违反了严格的标准，并且您可以逃脱这样做的唯一原因是为了向后兼容旧的 PHP 4 代码，其中 static 不作为关键字存在。

考虑这段代码：

```
<?php

class Test {
    protected $_userId;

    public function find()
    {
        if (isset($this)) {
            echo "Not static.<br />\n";
        } else {
            echo "Static.<br />\n";
        }
    }
}

$t = new Test();
$t->find();

Test::find(); 
```

输出是：

> 不是静态的。
> 静止的。

但是打开错误报告后，这是实际输出：

> 不是静态的。
> 
> 严格标准：非静态方法 Test::find() 不应在第 19 行静态的 test.php 中静态调用
> 。

如果您将方法声明为静态，那么无论以何种方式调用它，它都是静态的。

所以我想答案是肯定的，你可以使用这个解决方法来做到这一点，但我不推荐它。如果你想同时拥有它，我建议添加两种方法，`public function find()`并且`public static function findStatic()`.

由于您的代码将被编写为`$obj->find()`or `Class::find()`，因此在我看来，您可以轻松地使用静态与非静态方法，而不是让一种方法静态运行。为了坚持 DRY，我想一种方法会利用另一种方法来进行实际发现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-26T21:36:40.637

很抱歉没有回答您的问题，但我有一些评论不适合...评论。你在做什么有点不合逻辑。

```
$user->messages = new Message(); 
```

您正在一个名为*messages*的变量中创建*一条*消息。 你的意思是？ 另外，保护你的类变量。 *`$user->messages[] = new Message();`* 

 *```
$user->messages->where('unread = ?', 1); 
```

在这里，您试图从您的用户消息中进行选择，这是无稽之谈。
你应该做的和你在`User`课堂上做的一样：静态地获取消息，然后将它们分配给你的用户：

```
$user->messages = Message::where('unread = ?', 1); 
```

如果您需要查找具有特定主键的消息，请将其作为参数传递给`where`方法，可以增强该方法以采用许多子句：

```
$messages = Message::where(array(
    array('unread = ?', 1),
    array('id = ?',     $message->getID()),
)); 
```

我还想补充一点个人说明：创建 ORM 是一种很好的学习方式，但如果你正在寻找更*严肃*的东西，我建议你看看 Doctrine 或 Propel。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-23T08:14:03.993

从理论和实践的角度来看，拥有一个可以从静态和非静态上下文调用的类方法并不是一个好主意。

如果您想在整个应用程序中实现类/方法的可访问性，那么阅读有关依赖注入、服务容器和面向依赖注入的编程可能是一个很好的开始。

通过在您的应用程序中实现 DI，您很可能会放弃对您所提到的内容的任何需求。

我建议调查 trough web，您会发现您正在使用的上下文中的静态调用被避免并被标记为不好的做法。面向对象编程中的静态/共享状态是应该避免的（以及单例模式）。

不要误会我的意思-> 静态方法有它们的目的和好处，但是，您使用它的方式有点过时了（尽管某些框架，如 Laravel，提倡这种不好的做法 - 例如“Facades”和 Eloquent）。*

# excel - Excel 文档和登录

> ID：11216054
> 
> 赞同：0
> 
> 时间：2012-06-26T21:17:12.830
> 
> 标签：excel, asp-classic, vbscript

我有一个包含 2 列用户名和密码的 excel 文件。我想有一个登录网站。代码应该验证 excel 文件中可用的用户名和密码以进入网站，如果它不可用，则不会登录。

如果有例子请发给我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T05:29:29.813

这听起来真的不是一个好主意，但你要求它：

使用 Microsoft.Jet.OLEDB 驱动程序访问 excel 表，如下所示：

```
dim conn : set conn = server.createObject("ADODB.Connection")
dim rs : set rs = server.createObject("adodb.recordset")
dim sql

conn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" &_
          "myExcelFile.xls;" &_
          "Extended Properties=""Excel 8.0;HDR=YES;"""

sql = "SELECT * FROM myUsers where username = 'foo' and password = 'bar'"
rs.open sql, conn, adOpenStatic, adLockOptimistic, adCmdText 
```

[此处](http://www.connectionstrings.com/excel)列出了 excel 可能的连接字符串

# php - 上传无法正常工作，在新服务器 php 上

> ID：11216062
> 
> 赞同：0
> 
> 时间：2012-06-26T21:18:02.873
> 
> 标签：php, file-upload, upload

我真的不明白这里发生了什么，它适用于大多数服务器，但现在我不能让它工作，我不知道会发生什么。

```
<?php

 require_once dirname(dirname(dirname(__FILE__)))."/inc/config.php";
 require_once dirname(dirname(dirname(__FILE__)))."/inc/class.upload.php";
 $upload_folder = dirname(__FILE__);

  if(isset($_POST['filename'])) {

$context = stream_context_create(array('http' => array('header'=>'Connection: close')));
$content = file_get_contents($_POST['file'], false, $context);
$fileName = $_POST['filename'];
$ext = substr($fileName, strrpos($fileName, '.') + 1);
$saved_file = str_replace( '.' . $ext, '', $fileName );
$saved_file .= '_' . crypt($saved_file) . '.' . $ext;
$saved_file = str_replace('/', '', $saved_file);
while( @ file_exists($upload_folder.'/'.$saved_file) ) {
    $saved_file = str_replace( '.' . $ext, '', $saved_file );
    $saved_file .= crypt($saved_file) . '.' . $ext;
}

 if(file_put_contents($upload_folder.'/'.$saved_file, $content, 0, $context)) {

    $file_name_save = $upload_folder.'/'.$saved_file;
    $handle = new Upload($file_name_save);

    if ($handle->uploaded){
        $imageName = $handle->file_src_name;
        $handle->file_new_name_body     = date("Ymdhis").md5($imageName);
        $handle->mime_check             = true;
        $handle->allowed                = array('image/*');
        $handle->image_convert          = 'jpg';

        if(($handle->image_src_x > 900) || ($handle->image_src_y > 900)){
            $handle->image_resize   = true;
            $handle->image_ratio    = true;
            $handle->image_x        = 900;
            $handle->image_y        = 600;
        }

        $handle->Process(dirname(dirname(dirname(__FILE__))).'/img/Noticias/');

        if ($handle->processed){
            $NoticiaFoto_Imagem = $handle->file_dst_name;

            $Sql = "INSERT INTO tabnoticiasfotos (Noticia_Id, NoticiaFoto_Nome, NoticiaFoto_Ordem, NoticiaFoto_Imagem)  VALUES ('".$_POST['ID']."', '', 'NULL', '$NoticiaFoto_Imagem') ";
            fputs($fp,$Sql);
            $Query = mysql_query($Sql,$Conn) or die(mysql_error($Conn));
            @unlink($file_name_save);
        }

    }
}
echo $saved_file;
$_SESSION["varMensagem"]["css"] = "success";
$_SESSION["varMensagem"]["mensagem"] = "Fotos Enviadas com sucesso.";
exit();
 }
?> 
```

这会得到一组图像（jquery 上传）并完成所有工作。

但在新服务器上，没有任何效果

图片被上传到文件所在的同一文件夹中，新名称看起来很疯狂，并且不会在我的数据库中保存任何信息。

我在所有测试之前发布

问题就在这里

```
 if(file_put_contents($upload_folder.'/'.$saved_file, $content, 0, $context)) { 
```

返回false，所以不要完成上传。

所以对我来说问题就在这里，我认为是关于服务器配置。$context = stream_context_create(array('http' => array('header'=>'Connection: close')));

对不起，我不是专家

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-26T22:09:57.183

```
allow_url_fopen = On 
```

解决了这个问题。

# objective-c - 如何在不同时间在drawRect中绘制图形对象？

> ID：11216065
> 
> 赞同：0
> 
> 时间：2012-06-26T21:18:17.347
> 
> 标签：objective-c

对于一个特定的控制器类，我需要绘制一个网格（网格指的是每天的时间表，它每天都在变化，有时每小时都在变化。）。一段时间后，根据用户的操作，我需要用更新的计划数据填充该网格，而我在执行原始网格时没有这些数据。

我的问题是：由于我不知道 viewDidLoad 时选择的日期，这是否意味着我必须再次重新绘制整个网格以及新的每日计划数据？（这是我能想到的在drawRect中绘制所有内容的唯一方法）或者我可以调用drawRect*之外*的方法来绘制每日时间表吗？还是有另一种更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:02:51.327

您没有指定这是 iOS 还是 Mac，这可能会非常轻微地影响您对此做出的假设。但总的来说，视图的`drawRect`方法至少应该重绘提供的矩形内的所有内容（线索在方法名称中）。而且，从广义上讲，这是管理此类绘图的地方，当然您可以将代码分解为其他方法以保持清晰和组织。

除非您的网格非常密集，否则此重绘不太可能对性能产生明显影响。未能在实际脏区重绘所需内容将是更糟糕的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:02:24.760

在我看来，您需要将网格的绘图代码与计划数据的绘图代码分开。

最简单的方法是为您的日程安排数据创建一个 NSView 的子类——然后您可以为每条数据创建该对象的一个​​实例。您的网格视图可以通过设置它们的框架来定位这些调度数据对象，并且调度数据对象可以在它们自己的 drawRect: 方法中绘制它们自己。

# sql-server - SQL Server 2008 MERGE 语法中的 USING 是什么？

> ID：11216067
> 
> 赞同：21
> 
> 时间：2012-06-26T21:18:20.490
> 
> 标签：sql-server, merge, sql-server-2008-r2, upsert

雅各布问了一个完美的问题：[*给我`MERGE`语法*](https://stackoverflow.com/questions/2479488/syntax-for-single-row-merge-upsert-in-sql-server)。

那里的每个答案都会立即跳到他们能想到的最复杂的案例；用无关的混淆来掩盖语法。

马克给出[了答案](https://stackoverflow.com/a/2479522/12597)：

```
MERGE 
   member_topic AS target
USING 
   someOtherTable AS source
ON 
   target.mt_member = source.mt_member 
   AND source.mt_member = 0 
   AND source.mt_topic = 110
WHEN MATCHED THEN 
   UPDATE SET mt_notes = 'test'
WHEN NOT MATCHED THEN 
   INSERT (mt_member, mt_topic, mt_notes) VALUES (0, 110, 'test')
; 
```

看着这个答案，我和雅各布一样困惑：

> 我没有 someOtherTable

Marc 建议这`someOtherTable`是一个虚拟的占位符值 - 你没有那个表并不重要。

> 我试了一下，SQL Server*确实*抱怨
> 
> 无效的对象名称“someOtherTable”。

*这让*我很难理解如果它不重要（除了实际上重要）`USING`是`USING foo`什么。

 *当我使用 SQL Server 2008 MERGE 语法时`USING`使用*foo*时使用的是什么？

* * *

## 奖金问题

使用 MERGE 的 UPSERT 语法是什么：

```
IF (rowExists)
   UPDATE Users SET Firstname='Ian', LastName='Boyd' WHERE Username='iboyd'
ELSE
   INSERT INTO Users (UserGUID, Username, FirstName, LastName, AuthenticationMethod)
   VALUES ('{77410DC5-7A3E-4F1A-82C6-8EFB3068DE66}', 'iboyd', 'Ian', 'Boyd', 'Windows') 
```

变成（我试过的确切代码）：

```
begin transaction

    MERGE 
       Users
    USING 
       foo
    ON  
       Users.UserName = foo.UserName
    WHEN MATCHED THEN
        UPDATE SET Firstname = foo.FirstName, Lastname = foo.LastName
    WHEN NOT MATCHED THEN
        INSERT (UserGUID, Username, FirstName, LastName, AuthenticationMethod)
        VALUES ('{77410DC5-7A3E-4F1A-82C6-8EFB3068DE66}', 'iboyd', 'Ian', 'Boyd', 'Windows')
    ; --A MERGE statement must be terminated by a semi-colon (;).

rollback

Msg 208, Level 16, State 1, Line 3
Invalid object name 'foo'. 
```

?

> 使用`Users`包含列的表：
> 
> ```
> UserGUID uniqueidentifier
> Username varchar(50)
> FirstName varchar(50)
> LastName varchar(50)
> AuthenticationMethod varchar(50) 
> ```

* * *

**更新：**

```
USING <table_source> 
```

在哪里`table_source`：

```
table_or_view_name [ [ AS ] table_alias ] [ <tablesample_clause> ] 
    [ WITH ( table_hint [ [ , ]...n ] ) ] 
| rowset_function [ [ AS ] table_alias ] 
    [ ( bulk_column_alias [ ,...n ] ) ] 
| user_defined_function [ [ AS ] table_alias ]
| OPENXML <openxml_clause> 
| derived_table [ AS ] table_alias [ ( column_alias [ ,...n ] ) ] 
| <joined_table> 
| <pivoted_table> 
| <unpivoted_table> 
```

在哪里`joined_table`：

> *不明确的*

在哪里`pivoted_table`：

> *不明确的*

在哪里`unpivoted_table`：

> *不明确的*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-26T21:35:56.183

合并具有表源和目标表。这引入了源表（不必是实际的物理表，只是一个结果集）。

您的问题中指出了语法。要从另一个表或视图合并，请使用

```
MERGE 
   Users
USING SomeOtherTableName AS foo /*Alias is optional*/
ON /* ... */ 
```

或者您可以使用[`<unpivoted_table>`](http://msdn.microsoft.com/en-us/library/ms177634.aspx)例如

```
MERGE 
   Users
USING master..spt_values
UNPIVOT (X FOR Y IN ([high],[low])) AS foo 
ON  
   Users.Username = foo.Y 
WHEN MATCHED THEN
    UPDATE SET FirstName = foo.Y
WHEN NOT MATCHED THEN
    INSERT (UserGUID, Username, FirstName, LastName, AuthenticationMethod)
    VALUES (foo.Y, foo.Y, foo.Y, foo.Y, foo.Y); 
```

对于您的附加问题，您可以使用`VALUES`此处的子句作为`derived_table`选项的一部分。

```
MERGE Users
USING (VALUES ('{77410DC5-7A3E-4F1A-82C6-8EFB3068DE66}',
      'iboyd',
      'Ian',
      'Boyd',
      'Windows')) AS foo(UserGUID, Username, FirstName, LastName, AuthenticationMethod)
ON Users.UserName = foo.UserName
WHEN MATCHED THEN
  UPDATE SET Firstname = foo.FirstName,
             Lastname = foo.LastName
WHEN NOT MATCHED THEN
  INSERT (UserGUID,
          Username,
          FirstName,
          LastName,
          AuthenticationMethod)
  VALUES (UserGUID,
          Username,
          FirstName,
          LastName,
          AuthenticationMethod); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T21:24:37.813

源表可以是任何东西，例如：

```
MERGE 
   member_topic AS target
USING 
   (SELECT @Variable1, @Variable2, @Variable3) AS source(Col1, Col2, Col3)
ON 
   target.mt_member = source.Col1 
   AND source.Col1 = 0 
   AND source.Col2 = 110
WHEN MATCHED THEN 
   UPDATE SET mt_notes = 'test'
WHEN NOT MATCHED THEN 
   INSERT (mt_member, mt_topic, mt_notes) VALUES (0, 110, 'test'); 
```

显然，在嵌套的源代码选择中，您可以做更多的事情。从视图、函数、表变量、甚至 CTE 中进行选择。

至于奖金问题，您回答了自己的问题。

有时，对于非常大的表，我也会`ROWLOCK`在目标表上使用提示，至少在更新时尽量不要锁定整个表：

```
MERGE 
   member_topic WITH (ROWLOCK) AS target 
```

与奖金问题不起作用有关，这是一个工作示例。当然，我重命名了一些对象。

```
DECLARE @Variable1 AS INT;
SET @Variable1 = 1234;

MERGE dbo.Table1 WITH(ROWLOCK) target
USING(SELECT @Variable1) source(Key)
ON target.[Key] = source.[Key]
WHEN MATCHED THEN
    UPDATE SET
    Col1 = @SomeVar1,
    Col2 = @SomeVar2
WHEN NOT MATCHED THEN
INSERT 
        ([Key]
        ,[Col1]
        ,[Col2])
    VALUES
        (@Variable1
        ,@SomeVar1
        ,@SomeVar2); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-16T09:12:53.460

继 Martin Smith 的回答之后，您只需重复括号并用逗号分隔即可一次插入多个显式值行，例如，

```
MERGE Users WITH (HOLDLOCK)
USING (VALUES ('{77410DC5-7A3E-4F1A-82C6-8EFB3068DE66}',
      'iboyd',
      'Ian',
      'Boyd',
      'Windows'),
      ('{00000DC5-7A3E-4F1A-82C6-8EF452D2DE66}',
      'jsmith',
      'John',
      'Smith',
      'ActiveDirectory')) AS foo(UserGUID, Username, FirstName, LastName, AuthenticationMethod)
ON Users.UserName = foo.UserName
WHEN MATCHED THEN
  UPDATE SET Firstname = foo.FirstName,
             Lastname = foo.LastName
WHEN NOT MATCHED THEN
  INSERT (UserGUID,
          Username,
          FirstName,
          LastName,
          AuthenticationMethod)
  VALUES (UserGUID,
          Username,
          FirstName,
          LastName,
          AuthenticationMethod); 
```

在 SQL Server 2012 上对此进行了测试。（会将此添加为注释，但字符太多。）

我添加了一个 HOLDLOCK 已经看到[了](http://weblogs.sqlteam.com/dang/archive/2009/01/31/UPSERT-Race-Condition-With-MERGE.aspx)，因为如果您使用 MERGE 进行 UPSERT 肯定是锁定，语法肯定不会更清晰。另请参阅 Marcel 对大型表的 ROWLOCK 的评论。

我发现[另一篇帖子](http://pratchev.blogspot.ie/2008/03/upsert-and-more-with-merge.html)也比平均水平更清晰。*

# android - 从 html.class 读取错误

> ID：11216078
> 
> 赞同：0
> 
> 时间：2012-06-26T21:19:14.187
> 
> 标签：android, http

访问 php 脚本时出现此错误：

```
W/System.err: Error reading from ./org/apache/harmony/awt/www/content/text/html.class 
```

有问题的代码片段如下：

```
URL url = "http://server.com/path/to/script"
is = (InputStream) url.getContent();
BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
StringBuilder sb = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null) {
    sb.append(line + "\n");
}
is.close(); 
```

错误在第二行抛出。对错误的谷歌搜索出现了 0 个结果。此警告不会影响我的应用程序的流程，它更多的是烦恼而不是问题。它也只发生在 API 11 设备上（在 API 8 和 9 设备上工作正常）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:34:37.300

如果您正在查询 PHP 脚本，我很确定声明一个 URL，然后尝试关闭 InputStream，这不是正确的方法......

尝试类似：

```
HttpClient httpclient = new DefaultHttpClient();
HttpGet httpGet = new HttpGet("http://someurl.com");

try {
// Execute HTTP Get Request
HttpResponse response = httpclient.execute(httpGet);

HttpEntity entity = response.getEntity();

if (entity != null) {

    InputStream instream = entity.getContent();
    String result = convertStreamToString(instream);

            // Do whatever with the data here

            // Close the stream when you're done
    instream.close();

    }
}
catch(Exception e) { } 
```

为了轻松将流转换为字符串，只需调用此方法：

```
private static String convertStreamToString(InputStream is) {

    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    return sb.toString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:43:51.793

为什么不使用`HttpClient`？恕我直言，这是进行 http 调用的更好方法。[在此处](http://www.vogella.com/articles/AndroidNetworking/article.html#http_apachehttp)查看如何使用它。还要确保不要通过从 InputStream 读取响应来重新发明轮子，而是为此使用[EntityUtils](https://stackoverflow.com/a/4631237/247013)。

# php - 使用 MySQL 进行土耳其语字符编码

> ID：11216079
> 
> 赞同：2
> 
> 时间：2012-06-26T21:19:25.200
> 
> 标签：php, mysql, character-encoding, collation, turkish

正如我在标题中提到的，我遇到了土耳其字符的问题。我在 MySQL 上创建了一个函数：

```
DELIMITER $$

CREATE DEFINER=`root`@`localhost` FUNCTION `ilgiAlaniFunc`(
            idKullanici INT, 
            ilgi_alani_ismi varchar(255) CHARSET utf8 COLLATE utf8_turkish_ci
        ) RETURNS varchar(255) CHARSET utf8 COLLATE utf8_turkish_ci
    READS SQL DATA
    DETERMINISTIC
BEGIN
    -- Function logic here
    DECLARE ret int DEFAULT -1;
    select id Into ret from ilgi_alanlari
        where ilgi_alani_adi=ilgi_alani_ismi  limit 1;
    IF(ret = -1) then
        INSERT INTO ilgi_alanlari(ilgi_alani_adi) values (ilgi_alani_ismi);
        SELECT last_insert_id() into ret;
    END IF;
    insert into kullanici_ilgi_alani(kullanici_id, ilgi_alani_id)
        values (idKullanici, ret);
    RETURN ret;
END 
```

这是我运行的查询转储：

```
111 Connect root@localhost on anketsis_main
111 Query   select ilgiAlaniFunc(43,'kıvılcım')
111 Query   select id Into ret from ilgi_alanlari where ilgi_alani_adi= NAME_CONST('ilgi_alani_ismi',_utf8'k' COLLATE 'utf8_turkish_ci')  limit 1
111 Query   insert into kullanici_ilgi_alani(kullanici_id, ilgi_alani_id) values ( NAME_CONST('idKullanici',43),  NAME_CONST('ret',54)) 
```

在这里你可以看到'kıvılcım'变成了'k'。在第一个土耳其字符之后，MySQL 将全部删除。

这是一个正确的转储：

```
120 Query   select ilgiAlaniFunc(44,'Hello')
120 Query   select id Into ret from ilgi_alanlari where ilgi_alani_adi= NAME_CONST('ilgi_alani_ismi',_utf8'Hello' COLLATE 'utf8_turkish_ci')  limit 1
120 Query   INSERT INTO ilgi_alanlari(ilgi_alani_adi) values ( NAME_CONST('ilgi_alani_ismi',_utf8'Hello' COLLATE 'utf8_turkish_ci'))
120 Query   SELECT last_insert_id() into ret
120 Query   insert into kullanici_ilgi_alani(kullanici_id, ilgi_alani_id) values ( NAME_CONST('idKullanici',44),  NAME_CONST('ret',56)) 
```

如您所见，'Hello' 到处都是'Hello'。

在我的方案中，每个排序规则都是 utf8_turkish_ci 。编辑：我注意到我的问题不包括问题。就是这样：我怎样才能让 MySQL 相信我发送的字符串比它想象的要大

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:17:32.123

我假设您从 PHP 发送这些查询。我可以这么说，因为你是我。

显然 'utf8_turkish_ci' 排序规则可以解码乱码 utf8 代码，但不能解码纯土耳其字符。更改 php 文件的编码`header('Content-Type: text/html; charset=utf8');`可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-10T21:52:58.477

我一直在使用 notepad++ 文本编辑器并且遇到了同样的问题。（尽管上面的解决方案）在编码选项卡上，有一个选择为 UTF-8 的代码，我选择了它并保存了文件。在我将代码发送到服务器后，它可以工作了:)

# mysql - mysql中多个用户随时间存储身高和体重（等）的数据结构

> ID：11216080
> 
> 赞同：0
> 
> 时间：2012-06-26T21:19:27.050
> 
> 标签：mysql, structure, normalization

我正在尝试为我的本地主机开发一个应用程序，我可以在该应用程序上跟踪一段时间内的身体属性（ht、体重、体水、体脂等），以便与卡路里摄入量进行比较，以进行膳食计划等。这就是我所拥有的现在：

```
DB surname
 TBL home
  memberID (tiny int, 1, auto increment, primary key)
  name (varchar, 30)
  gender (char, 1) ->value should be m or f, but this isn't defined anywhere
  birthdate (datetime) 
```

为了随着时间的推移存储物理数据，我考虑过使用一个包含三列主键（日期、人员、测量类型）的表，每列上都有常规的单列索引，这样我就可以查找日期的所有条目或一个人或测量类型。像这样：

```
DB surname
 TBL stats (or something to that effect)
  date (datetime, PK1, index)
  memberFK (tiny int, 1, PK2, index)
  type (varchar, 3, PK3, index) -> possible values should be ht | wt | fat | wat maybe others will also become necessary
  value (decimal, 4/1) -> store all values in nnn.n format in a particular system (ie metric) and do any conversions, add units, etc when the data is called 
```

这似乎仍然会产生很多多余的冗余，所以我想可能将每个用户的测量值存储在他们自己数据库中的表中，如下所示：

```
DB user1
 TBL stats
  date (datetime, PK1, index)
  type (varchar, 3, PK2, index)
  value (decimal, 4/1) 
```

这似乎通过从外键（以及整个表）中删除一列来稍微清理它，但也阻止我在此表和其他非用户特定的营养相关表之间使用外键。另一方面，我计划为其他家庭主题开发应用程序，其中有一般数据和用户特定数据，所以如果有像这样的数据库之间使用数据的好方法，这也许是最好的方法。

所以这些对我来说似乎都不对，但我不知道如何让它们变得更好。我倾向于第二个示例，前提是我可以找到保持数据完整性的方法。请对您认为有帮助的建议提出任何意见。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:39:54.337

这就是我将如何做到的

```
DB healthstats
    TABLE user
        memberID (int*, auto increment, unsigned zerofill, primary key)
        name (varchar, 50)
        gender (char, 1) ->value should be m or f, but this isn't defined anywhere
        birthdate (datetime)

    TABLE reading
        readingID (int*, auto increment, unsigned zerofill, primary key)
        memberID (int*, FK: TABLE user)
        date (datetime)

    TABLE stat
        statID (int*, auto increment, unsigned zerofill, primary key)
        readingID (int*, FK: TABLE reading)
        type (varchar, 3)*
        value (decimal 4.1)* 
```

`*`这些数据类型由你决定，只要确保主键和外键匹配即可。

A`stat`是测量值（例如身高、体重、体脂等）。A`reading`定义为同时进行`stat`的一个或多个测量值。

请注意，这一切都在同一个数据库中，它包含三个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:47:15.940

拥有多个具有相同结构的表几乎总是一个坏主意，因为它会阻止您以规范形式访问多个此类表中的数据。假设您想要夏季和冬季之间的平均体重差异，那么如果您按用户拆分它们，则必须遍历所有表。

我不确定你在哪里看到了“过度冗余”。但也许您会更喜欢将各种参数作为列而不是枚举列的值的表。即引入列 ht、wt、fat、wat 以及您可能需要的任何其他列。这样，所有这些值就不会被限制为单一的数字类型，并且不会将完全不相关的单位的值存储在同一列中。您仍然可以使用`NULL`缺失值，因此如果这不是您要强制执行的策略，您将不会被迫始终提供所有值。由于整个集合的日期和人物只出现一次，因此只有在您通常对一个人进行多次阅读时才有意义。

# c - C在文件中查找字符串

> ID：11216085
> 
> 赞同：1
> 
> 时间：2012-06-26T21:20:09.123
> 
> 标签：c, string

这是文件*auth.txt* (用户名密码)
paolo 1234
luca 0000
marci 1000

这是我的代码：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void onexit(char *u, char *p, char *l, FILE *f, int flag);

int main(int argc, char *argv[]){

    FILE *fp;
    char *tmp, *tmp2, *user, *pass, *line;

    printf("Inserire utente: ");
    if(scanf("%ms", &user) == EOF){
        perror("scanf");
        return EXIT_FAILURE;
    }

    printf("Inserire password: ");
    if(scanf("%ms", &pass) == EOF){
        perror("scanf");
        onexit(user, NULL, NULL, NULL, 1);
        return EXIT_FAILURE;
    }

    size_t max_length = strlen(user) + strlen(pass) + 3;
    line = malloc(max_length);
    if(line == NULL){
        perror("malloc");
        onexit(user, pass, NULL, NULL, 2);
        return EXIT_FAILURE;
    }

    fp = fopen("/home/pol/auth.txt", "r");
    if(fp == NULL){
        printf("Errore apertura file\n");
        onexit(user, pass, line, NULL, 3);
        return EXIT_FAILURE;
    }

    while(!feof(fp)){
        if(fgets(line, max_length , fp) == NULL){
            perror("fgets");
            onexit(user, pass, line, fp, 4);
            return EXIT_FAILURE;
        }
        tmp = strtok(line, " ");
        if(tmp == NULL){
            perror("strtok");
            onexit(user, pass, line, fp, 4);
            return EXIT_FAILURE;
        }

        tmp2 = strtok(NULL, "\n");
        if(tmp2 == NULL){
            perror("strtok");
            onexit(user, pass, line, fp, 4);
            return EXIT_FAILURE;
        }
        if((strcmp(tmp,user) == 0) && (strcmp(tmp2,pass) == 0)){
            printf("USER: %s - PASS: %s\n", tmp, tmp2);
            onexit(user, pass, line, fp, 4);
            return EXIT_SUCCESS;
        }
        else{
                 continue;
        }
    }
    printf("no such user or pwd into DB\n");
    onexit(user, pass, line, fp, 4);
    return EXIT_FAILURE;
}

void onexit(char *u, char *p, char *l, FILE *f, int flag){
    if(flag == 1){
        free(u);
    }
    if(flag == 2){
        free(u);
        free(p);
    }
    if(flag == 3){
        free(u);
        free(p);
        free(l);
    }
    if(flag == 4){
        free(u);
        free(p);
        free(l);
        fclose(f);
    }
} 
```

编辑：另一个问题！
如果我想测试我得到：`luca`Inserire utente：luca Inserire 密码：0000 strtok：成功 并且程序停止。它仅适用于第一个和第三个输入，但不适用于第二个！为什么？？`0000`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:29:59.777

看起来你的`while`循环只会经历一次迭代：

```
while(!feof(fp)){
  // ...
  if((strcmp(tmp,user) == 0) && (strcmp(tmp2,pass) == 0)){  // if match, exit
    printf("USER: %s - PASS: %s\n", tmp, tmp2);
    onexit(user, pass, line, fp, 4);
    return EXIT_SUCCESS;
  }
  else{                                                     // else exit
    printf("no such user or pwd into DB\n");
    onexit(user, pass, line, fp, 4);
    return EXIT_FAILURE;
  }
} 
```

……这似乎有点好笑。如果您阅读的第一行不匹配，您真的要退出吗？

* * *

**编辑：**

~~另一个问题：您需要在将它们发送`user`到`pass`之前分配空间`scanf`：~~

 ~~```
char *user;
scanf("%ms", &user);  // error 
```~~ 

取而代之的是，您可以尝试以下操作：

```
char user[100];
scanf("%ms", &user);  // now user actually has some space to store data 
```

~~（在您的版本中，`scanf`将尝试将数据写入指向的位置`user`，但`user`只是指向内存中的随机位置，所以谁知道会发生什么。）~~

哎呀，正如@MvG 指出的那样，这很好。我不熟悉“%ms”POSIX 扩展。

* * *

**编辑 2**：

假设您输入用户名`uu`和密码`pp`。因为这：

```
size_t max_length = strlen(user) + strlen(pass) + 3; 
```

...您将设置`max_length`为`2 + 2 + 3`, 或`7`. [fgets](http://en.cppreference.com/w/cpp/io/c/fgets)将读取数据，直到它遇到最多`max_length-1`字符或换行符。这意味着当您进入`while`循环时，您只会尝试每次迭代最多读取`7-1`或读取`6`字符，这似乎不正确。

例如，如果您的密码文件包含：

```
paolo 1234
luca 0000
marci 1000 
```

...然后`line`将获得以下值：

1.  `"paolo "`（带有尾随空格）
2.  `"1234"`
3.  `"luca 0"`
4.  `"000"`
5.  `"marci "`（再次，尾随空格）
6.  `"1000"`

不要基于`max_length`您读入的当前用户名和密码，而是创建`max_length`一个较大的固定值（如`100`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:35:25.857

您的错误处理程序位于 while 循环内。如果用户不是文件中的第一个用户，则立即中止。最好这样写：

```
…
        if((strcmp(tmp,user) == 0) && (strcmp(tmp2,pass) == 0)){
            printf("USER: %s - PASS: %s\n", tmp, tmp2);
            onexit(user, pass, line, fp, 4);
            return EXIT_SUCCESS;
        }
    }
    printf("no such user or pwd into DB\n");
    onexit(user, pass, line, fp, 4);
    return EXIT_FAILURE;
} 
```

# 编辑：

`strtok: Success`当数据库中有一个条目之间没有空格时，我可以重现该问题。这甚至可能是文件末尾的空行，以防循环进行到此为止。在这种情况下，第一个 strtok 将返回整个字符串，第二个 strtok 将返回 NULL，从而表明没有更多的标记。由于这不是错误消息，因此 errno 状态为零，对应于“错误消息” `Success`。

我想在你的情况下，问题在于记录的长度不同。您通过输入的长度来测量行读取缓冲区的长度，但有些记录更长。在这种情况下，您读取了一行的一部分并将其正确拆分，然后在下一次运行时，您读取了该行的其余部分，并最终得到一个看起来像没有空格的行，包括我上面描述的行为。

# file - Unix命令（'stat'和'ls'除外）无需解析即可获取文件修改日期

> ID：11216094
> 
> 赞同：12
> 
> 时间：2012-06-26T21:20:47.660
> 
> 标签：file, unix, last-modified

我正在编写一个 shell 脚本，我必须在其中找到文件的最后修改日期。

`Stat`命令在我的环境中不可用。

所以我使用`'ls'`如下来获得想要的结果。

```
ls -l filename | awk '{print $6 $7 $8}' 
```

但我在许多论坛上读到[解析`ls`通常被认为是不好的做法](http://mywiki.wooledge.org/ParsingLs)。虽然它（可能）大部分时间都可以正常工作，但不能保证每次都能正常工作。

有没有其他方法可以在 shell 脚本中获取文件修改日期。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-26T21:34:24.743

使用`find`命令怎么样？

例如，

```
 $ find filenname -maxdepth 0 -printf "%TY-%Tm-%Td %TH:%TM\n" 
```

这个特殊的格式字符串给出如下输出：`2012-06-13 00:05`.

[find 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)显示了您可以使用的格式化指令，以`printf`根据您的需要/想要的方式定制输出。部分`-printf format`包含所有详细信息。

比较`ls`输出`find`：

```
$ ls -l uname.txt | awk '{print  $6 , "", $7}'
2012-06-13  00:05

$ find uname.txt -maxdepth 0 -printf "%TY-%Tm-%Td %TH:%TM\n"
2012-06-13 00:05 
```

当然，您可以使用 Python 或 Perl 等多种语言编写脚本来获取相同的信息，但是要求“ *unix 命令*”听起来好像您正在寻找“内置”shell 命令。

**编辑**：

你也可以像这样从命令行中 inovke Python：

```
$ python -c "import os,time; print time.ctime(os.path.getmtime('uname.txt'))" 
```

或者如果与其他 shell 命令结合使用：

```
$ echo 'uname.txt' | xargs python -c "import os,time,sys; print time.ctime(os.path.getmtime(sys.argv[1]))" 
```

两者都返回：`Wed Jun 13 00:05:29 2012`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-05T19:30:43.747

根据您的操作系统，您可以使用

```
date -r FILENAME 
```

唯一似乎不起作用的 unix 版本是 Mac OS，根据 man 文件， -r 选项是：

```
 -r seconds
         Print the date and time represented by seconds, where seconds is
         the number of seconds since the Epoch (00:00:00 UTC, January 1,
         1970; see time(3)), and can be specified in decimal, octal, or
         hex. 
```

代替

```
 -r, --reference=FILE
          display the last modification time of FILE 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T22:00:24.743

你有perl吗？

如果是这样，您可以使用其内置`stat`函数来获取有关命名文件的 mtime（和其他信息）。

这是一个小脚本，它获取文件列表并打印每个文件的修改时间：

```
#!/usr/bin/perl

use strict;
use warnings;

foreach my $file (@ARGV) {
    my @stat = stat $file;
    if (@stat) {
        print scalar localtime $stat[9], " $file\n";
    }
    else {
        warn "$file: $!\n";
    }
} 
```

样本输出：

```
$ ./mtime.pl ./mtime.pl nosuchfile
Tue Jun 26 14:58:17 2012 ./mtime.pl
nosuchfile: No such file or directory 
```

该模块使用更用户友好的版本`File::stat`覆盖调用：`stat`

```
#!/usr/bin/perl

use strict;
use warnings;

use File::stat;

foreach my $file (@ARGV) {
    my $stat = stat $file;
    if ($stat) {
        print scalar localtime $stat->mtime, " $file\n";
    }
    else {
        warn "$file: $!\n";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-01T09:01:33.270

```
#!/bin/bash 
FILE=./somefile.txt

modified_at=`perl -e '$x = (stat("'$FILE'"))[9]; print "$x\n";'`

not_changed_since=`perl -e '$x = time - (stat("'$FILE'"))[9]; print "$x\n";'`

echo "Modified at $modified_at"
echo "Not changed since $not_changed_since seconds" 
```

# c# - 浮点数 / 浮点数 = 奇怪的结果

> ID：11216095
> 
> 赞同：3
> 
> 时间：2012-06-26T21:20:49.470
> 
> 标签：c#, asp.net-mvc, floating-point

我有两个值，一个来自用户输入，另一个来自 DB。

```
var userinput = form["someInput"];
var valuefromDB = GetValue(someNumber);

public float? GetValue(int id){
return (float?) db.table.where(p=> p.id == id).select(p=> p.Value).SingleOrDefault();
} 
```

userinput 的值为“1”作为字符串，而 valuefromDB 的值为 0.001 作为浮点数。

所以 1 / 0.001 = 1000

但是我的 c# 代码给了我 999.999939 作为结果；

```
var final = float.Parse(userinput) / valuefromDB 
```

当我有“2”作为用户输入值时，结果是正确的，2000 ...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T21:22:36.120

那是因为并非所有十进制数都可以用二进制准确表示（这是[使用](http://en.wikipedia.org/wiki/IEEE_floating_point)[的表示`float`](http://en.wikipedia.org/wiki/IEEE_floating_point)）。解决方案是将结果格式化为所需的小数位数，这将导致结果四舍五入并“正确”显示。

**更新：**要格式化`float`显示，请查看[此 MSDN 参考页面](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)和[此页面示例](http://www.csharp-examples.net/string-format-double/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:24:16.973

对于浮点不提供的纯精度，请改用小数。

请参阅[C# 中的 Decimal、Float 和 Double 有什么区别？](https://stackoverflow.com/questions/618535/what-is-the-difference-between-decimal-float-and-double-in-c)

# html - 将选择列表中的所有选项发送到另一个 JSP

> ID：11216098
> 
> 赞同：2
> 
> 时间：2012-06-26T21:21:10.637
> 
> 标签：html, forms, list, jsp

我目前有一个带有如下选择的 JSP：

```
<select name="withoutAccess" size="5">

<c:foreach var="item" items="${obj.withoutAccess}">
    <option>${item}</option>
    </c:foreach>
</select> 
```

为了清楚起见，我只会发布选择列表，因为其余的都很好。

现在，在我的表单中，当我单击提交按钮时，我想在另一个页面的选择列表中捕获所有值。

当我按下按钮时，我只能设法获得在该列表中选择的选项。

我怎样才能获得其余的？

我已经尝试过 request.getParameterValues("withoutAccess")，但它只有 1 个选项，即被选中的那个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:34:53.793

只有选定的选项会在表单帖子中发送。如果您想获得完整的选项列表，您需要再次查找它们（即，从数据库中），或者将它们存储在持久存储位置，例如会话或应用程序状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T15:58:57.450

好吧，我找到了一个解决方案。

创建一个javascript脚本，将所有选项都设置为selected = true，这样我就可以在请求中捕获它们:)

# c++ - 静态函数重载？

> ID：11216099
> 
> 赞同：7
> 
> 时间：2012-06-26T21:21:16.177
> 
> 标签：c++, embedded

我首先要说我知道只有非静态成员函数可以是虚拟的，但这就是我想要的：

1.  定义接口的基类：因此我可以使用基类指针来访问函数。

2.  出于内存管理目的（这是一个内存有限的嵌入式系统），我希望静态分配覆盖函数。我接受这样的结果，即使用静态函数，我如何操作函数中的数据会受到限制。

    我目前的想法是，我可以通过使其成为实际上是静态的函数的包装器来保持轻重载函数。

请不要告诉我我需要重新考虑我的设计。这就是我问这个问题的原因。如果您想告诉我最好使用 c 和回调，请指导我阅读一些阅读材料来解释使用面向对象方法的缺陷。是否存在满足我列举的要求的面向对象的设计模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T21:49:52.753

> 是否存在满足我列举的要求的面向对象的设计模式？

是的，普通的旧虚拟功能。您的愿望是“静态分配的压倒一切的功能”。虚拟功能*是*静态分配的。也就是说，实现这些功能的代码只存在一次，并且只存在一次，并且在编译/链接时是固定的。根据您的链接器命令，它们很可能像任何其他函数一样存储在闪存中。

```
class I {
  public:
  virtual void doit() = 0;
  virtual void undoit() = 0;
};

class A : public I {
  public:
  virtual void doit () {
    // The code for this function is created statically and stored in the code segment
    std::cout << "hello, ";
  }
  virtual void undoit () {
    // ditto for this one
    std::cout << "HELLO, ";
  }
};

class B : public I {
  public:
  int i;
  virtual void doit() {
    // ditto for this one
    std::cout << "world\n";
  }
  virtual void undoit() {
    // yes, you got it.
    std::cout << "WORLD\n";
  }
};

int main () {
   B b; // So, what is stored inside b?
        // There are sizeof(int) bytes for "i",
        // There are probably sizeof(void*) bytes for the vtable pointer.
        // Note that the vtable pointer doesn't change size, regardless of how
        // many virtual methods there are.
        // sizeof(b) is probably 8 bytes or so.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T22:04:14.043

> For memory management purposes (this is an embedded system with limited ram) I want the overriding functions to be statically allocated.

All functions in C++ are always statically allocated. The only exception is if you manually download and utilize a JIT.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T21:53:44.870

静态成员函数只是普通函数（如非成员函数），位于类的命名空间内。这意味着您可以将它们视为普通函数，以下解决方案应该这样做：

```
class Interface
{
  public:
    void (*function) ();
};

class Implementation: public Interface
{
  public:
    Implementation()
    {
      function = impl_function;
    }

  private:
    static void impl_function() 
    {
      // do something
    }
}; 
```

然后

```
Implementation a;
Interface* b = &a;
b->function(); // will do something... 
```

The problem with this approach is that you would be doing almost what the compiler does for you when you use virtual member functions, just better (needs less code, is less error-prone, and the pointer to the implementation functions are shared). The main difference is that using `virtual` your function would receive the (invisible) `this` parameter when called, and you would be able to access the member variables.

Thus, I would recommend to you to simply not do this, and use ordinary virtual methods.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T22:06:09.213

The overhead with virtual functions is two-fold: besides the code for the actual implementations (which resides in the code segment, just like any other function you write), there is the virtual function table, and there are pointers to that table. The virtual function table is present once for each derived *class*, and its size depends on the number of virtual functions. Every object must carry a pointer to its virtual function table.

My point is, the per-object overhead of virtual functions is the same no matter how many virtual functions you have, or how much code they contain. So the way you arrange your virtual functions should have little impact on your memory consumtion, once you have decided that you want some degree of polymorphism.

# java - 如何在启动时加载应用程序范围的设置（对于 Spring3 webapp）？

> ID：11216103
> 
> 赞同：0
> 
> 时间：2012-06-26T21:21:24.307
> 
> 标签：java, web-applications, spring-mvc, spring-3

我正处于使用 Hibernate 编写 Spring3 MVC webapp 的基本阶段。我希望所有数据模型类都能够访问基本配置值，例如，数据库表前缀名称等。我想要这个选项，所以我（或其他开发人员）可以通过在 .properties 中修改它们来即时更改它们文件。

我最好的选择是在 util 包中创建一个带有静态块的 Config 类，该块从 .properties 文件加载一堆属性？我想这个类本身可能是静态的，有各种获取器来访问其中的值。

如果我选择上述方法，如果由于某种原因我指定的 .properties 文件无法加载，我怎么能确保应用程序没有加载（轻微失败）？有例外吗？

如果我的方式很糟糕，还有什么更好的方案？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T10:06:06.893

恕我直言，这是一个很好的方法。如果您要为此类显式声明一个 bean，例如

> `<bean id="myConfig" class="com.yourcompany.yourproject.Config"/>`

如果 spring 无法实例化 bean，它将在启动时失败。因此，如果属性文件不可读/不可用，只需从 Configs 构造函数中抛出未经检查的异常。

*如果-出于某种原因-您全局启用了延迟加载，则必须为此 bean 显式禁用它，否则您将无法获得故障快速解决方案*

> `<bean id="myConfig" class="com.yourcompany.yourproject.Config" lazy-init="false"/>`

编辑：此方案的另一个不错的功能是您可以告诉 maven 来“过滤”资源（.properties 文件），并且您可以获得所有 maven 变量。这是我的道具文件的外观（我将此信息用于“关于”对话框。有人打开过关于对话框吗？）

```
project.version=${project.version}
project.name=${project.name}
project.organization.name=${project.organization.name}
project.url=${project.url}
project.description=${project.description} 
```

# javascript - 表格数据中每个单元格的下拉列表

> ID：11216108
> 
> 赞同：0
> 
> 时间：2012-06-26T21:21:55.063
> 
> 标签：javascript, html, css

我有一个非常大的 html 表，类似于以下内容：

```
<table>
    <tr>
        <td>value1</td>
        <td>value2</td>
    </tr>
    <tr>
        <td>value3</td>
        <td>value4</td>
    </tr>   
</table> 
```

对于每个值，我需要有一个下拉列表，用户可以单击以更改值。这将触发一个 ajax 函数。最好的方法是什么？每个下拉菜单？一个改变位置的下拉菜单？我应该如何添加这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:53:31.253

[此解决方案](http://jsfiddle.net/m6AJn/5/)在单击时将单元格更改为下拉列表，并在选择值时返回到单元格，以防万一这是所需的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:30:51.757

类似的东西，我想。:) 我使用 jQuery。:)

```
$("tr").each(function(){
    $("td").each(function(){
        var before = $(this).text();
        $(this).html("<select><option>"+before+"</option></select>");
    });
});​ 
```

[jsFiddle 示例](http://jsfiddle.net/transparent/m6AJn/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T21:39:16.593

其中一些取决于您希望为用户提供的体验，但我倾向于在每个表格单元格中放置一个选择元素。然后，您可以隐藏选择，直到用户选择要更改的值之一，或者您可以让选择元素始终可见。这更容易，因为您可以在浏览器呈现页面之前将值放入选择框中。如果这不可用，例如，如果浏览器由于标记的大小而无法呈现页面，那么您可以转而使用单个选择元素。

如果您使用单个选择框，则需要您将其移动到正确的单元格，并确定如何将可能的值放入选择框中。您可以在 td 标签上使用 data 属性来存储数据，或者您可以进行 ajax 调用。但是，如果您每次需要编辑单元格时都返回服务器，那可能会很麻烦。基本上这将是更难的选择。

从简单的方式开始（在每个 td 中选择）。如果这被证明是有问题的，那就转向更难的那个。这就是我会做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T21:51:45.373

好吧，我得到它的工作。这是我其他答案的替代方案。这使每个 tr 成为一个下拉列表，并且 tds 是选项。我使用了 jQuery。

```
$("tr").each(function(i){   
    $("td").each(function(){
        $(this).replaceWith("<option>"+$(this).text()+"</option>");
    });
    $(this).replaceWith("<select>"+$(this).html()+"</select>");    
}); 
```

​更新 [了 jsFiddle 示例](http://jsfiddle.net/transparent/m6AJn/)

# hadoop - hadoop eclipse插件安装目录

> ID：11216109
> 
> 赞同：2
> 
> 时间：2012-06-26T21:21:56.770
> 
> 标签：hadoop, hadoop-plugins

我是hadoop和eclipse的新手。尝试添加新的hadoop服务器时，谁能告诉我hadoop eclipse插件的安装目录格式。我用谷歌搜索并尝试了几个小时，但没有绝望......任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-08-21T05:19:42.143

1.  你的系统应该安装了hadoop，确保它正在运行。

2.  你需要复制“hadoop-eclipse-plugin-.jar”你可以从谷歌下载它。进入“/eclipse/plugins”目录。在此之后，您需要重新启动 Eclipse。

3.  在 Eclipse 中，您需要通过提供相应的端口号和主机名来配置 hadoop 配置

[有关更多信息，请参阅此链接....](https://youtu.be/Zn2t-F3grh0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T09:30:38.123

您需要将“hadoop-eclipse-plugin- *.jar”从“/hadoop-* /contrib/eclipse-plugin 目录”复制到“/eclipse/plugins”目录中。在此之后，您需要重新启动 Eclipse。但这几次都行不通。一个可能的原因可能是 hadoop-eclipse-plugin- *.jar 中缺少一些 jar 文件。试试这个，让我知道它对你有用 - 提取 hadoop-eclipse-plugin-* .jar，并将以下 5 个文件添加到“hadoop-eclipse-plugin-0.20.203.0\lib -`commons-configuration-1.6.jar, commons-httpclient-3.0.1.jar, commons-lang-2.4.jar, jackson-core-asl-1.0.1.jar, jackson-mapper-asl-1.0.1.jar.` 之后添加这些文件的名称jars 到“haoop-eclipse-plugin-*\META-INF\MANIFEST.MF”文件中。你的 MANIFEST.MF 文件应该看起来像这样 -

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.8.1
Created-By: 1.6.0_21-b06 (Sun Microsystems Inc.)
Bundle-ManifestVersion: 2
Bundle-Name: MapReduce Tools for Eclipse
Bundle-SymbolicName: org.apache.hadoop.eclipse;singleton:=true
Bundle-Version: 0.18
Bundle-Activator: org.apache.hadoop.eclipse.Activator
Bundle-Localization: plugin
Require-Bundle: org.eclipse.ui,org.eclipse.core.runtime,org.eclipse.jd
 t.launching,org.eclipse.debug.core,org.eclipse.jdt,org.eclipse.jdt.co
 re,org.eclipse.core.resources,org.eclipse.ui.ide,org.eclipse.jdt.ui,o
 rg.eclipse.debug.ui,org.eclipse.jdt.debug.ui,org.eclipse.core.express
 ions,org.eclipse.ui.cheatsheets,org.eclipse.ui.console,org.eclipse.ui
 .navigator,org.eclipse.core.filesystem,org.apache.commons.logging
Eclipse-LazyStart: true
Bundle-ClassPath: classes/,lib/hadoop-core.jar,lib/commons-cli-1.2.jar,lib/commons-httpclient-3.0.1.jar,lib/jackson-core-asl-1.0.1.jar,lib/jackson-mapper-asl-1.0.1.jar,lib/commons-configuration-1.6.jar,lib/commons-lang-2.4.jar
Bundle-Vendor: Apache Hadoop 
```

完成此操作后重新“jar”包并替换 /eclipse/plugins 目录中的旧“hadoop-eclipse-plugin-*.jar”并重新启动 eclipse。

# wcf - 如何发布我的 WCF 服务？

> ID：11216117
> 
> 赞同：0
> 
> 时间：2012-06-26T21:22:27.397
> 
> 标签：wcf, localhost, nat

我想在互联网上使用我的网络服务。我打开了端口 4501，并在调制解调器和 Windows 上禁用了防火墙。我可以写我的全局IP，我可以打开调制解调器控制接口。但我想连接到地址为 xx.xx.xx.xx:4501/Products.svc 的 iis

它适用于本地主机（http://localhost:4501/Product.svc）但我无法连接到互联网上的 svc ..

我不知道问题出在哪里。

当我添加我的 svc 链接地址作为添加参考服务时，我收到了这个错误

```
 There was an error downloading 'http://xx.xx.xx.xx:4501/Products.svc'.
  Unable to connect to the remote server
  Hedef makine etkin olarak reddettiğinden bağlantı kurulamadı xx.xx.xx.xx:4501
  Metadata contains a reference that cannot be resolved:                         'http://xx.xx.xx.xx:4501/Products.svc'.
  There was no endpoint listening at http://xx.xx.xx.xx:4501/Products.svc that could           accept the message. This is often caused by an incorrect address or SOAP action. See    InnerException, if present, for more details.
  Unable to connect to the remote server
  Hedef makine etkin olarak reddettiğinden bağlantı kurulamadı xx.xx.xx.xx:4501
  If the service is defined in the current solution, try building the solution and      adding the service reference again. 
```

还有一点，

如果我启动 IIS，wcf 服务即使在 localhost 中也不起作用。如果我在 Visual Studio 中启动它（我的意思是 asp.net 开发服务工作）它工作..

IIS 版本是 7.5.7600，我将应用程序池添加为 Asp.net 4.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:20:42.257

您在 IIS 中将端口 4501 用于 HTTP 是否有任何特定原因？

Visual Studio 2010 WebDev WebServer (Cassini) 使用随机端口号（在您的情况下为 4501）来简化配置。它假设端口 80 可以被它的大哥 IIS 或任何其他软件占用。

这对于在本地机器上进行开发来说很好，但在生产中不需要使用相同的端口。

默认的 HTTP 端口是 80，它通常是网络中最开放的端口。

在 IIS 中使用端口 80 进行 HTTP 流量，您的生活会轻松很多。

PS 你试过[http://xx.xx.xx.xx/Products.svc](http://xx.xx.xx.xx/Products.svc)吗？端口号是 Web 服务配置的一部分，当您将应用程序移动到 IIS 时不会复制它。IIS 可能已使用默认 HTTP 端口。

# c# - 来自 DynamoDB 的最初是字节数组的字符串具有时髦的值

> ID：11216120
> 
> 赞同：0
> 
> 时间：2012-06-26T21:22:37.687
> 
> 标签：c#, encryption, amazon, amazon-dynamodb, ripemd

现在我不确定这是我做错了什么，还是在 DynamoDB 中发生了什么。

基本上，我为我的项目构建了一个简单的注册/登录系统，将用户数据/密码保存在 DynamoDB 实例中，密码使用 RIPEMD160 散列，并使用 C# 的`RNGCryptoServiceProvider()`.

注册似乎工作得很好。问题出在登录时，无论如何，密码都不匹配，我认为这是因为从 DynamoDB 中提取哈希/盐时，我得到了一些时髦的字符。首先，hash 和 salt 都是长度为 20 的字节数组，并在保存到数据库之前转换为字符串。

这些示例是从 dynamo Web 界面复制/粘贴的

```
Example Hash: ">�Bb.ŧ�E���d��Ʀ"  
Example Salt: "`���!�!�Hb�m�}e�" 
```

当他们回来并且我调试从发电机拉回数据的函数时，两个字符串都有不同的字符（VS2010调试器）：

```
Returned Hash: "u001B>�Bb.ŧ�E��u0003�d�u001C�Ʀ"  
Returned Salt: "`���!u000B�!�Hb�u001Dmu0012�u0001}e�" 
```

似乎这些 u001B、u000B、u001D、u0012、u0003、u001C 和 u0001 正在潜入返回的数据中，我不完全确定发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:29:00.613

首先，您不应该尝试以这种方式将不透明的二进制数据转换为字符串。它们*不是文本*，所以不要那样对待它们。你只是乞求以这种方式丢失信息。

在将数据放入数据库之前使用`Convert.ToBase64String(data)`而不是。`Encoding.GetString`再次取出时，用于`Convert.FromBase64String`检索原始二进制数据。

或者，不要将数据存储在文本字段中 - 使用*旨在*存储二进制数据的数据库字段类型......

# qt - 为 Symbian OS 开发商业应用程序是否必须支付 Qt 许可证？

> ID：11216121
> 
> 赞同：2
> 
> 时间：2012-06-26T21:23:04.993
> 
> 标签：qt, mobile, licensing, symbian

我打算为手机开发一个商业的、闭源的应用程序。

我选择从 Symbian OS 开始，因为我也有一部 Symbian 手机，我真的很喜欢它。我想采用 Qt，因为它实际上是诺基亚建议的方式，而且因为我知道我可以通过使用 Qt 库很容易地将我的应用程序移植到 ios 和其他平台。

因此，必须在 Qt 和 C/C++/Carbide 之间做出选择，我有一个令人信服的问题：我是否必须付费才能获得使用 Qt 开发商业闭源程序的许可证？

真的，我不会为使用开发工具付费，因为我不确定我能否获得投资回报。此外，我还必须付费开设一个帐户，以便在商店中托管我的应用程序。

如果听起来不好，请随时纠正我的英语。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:02:46.410

**不，您不必**为构建商业或专有应用程序的 Qt 框架付费。[GNU LGPL 2.1 版](http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html)允许这样做，并且 Qt 在此许可证下获得许可。

[在此处](http://qt.nokia.com/products/licensing)阅读有关 Qt 许可的信息。

提炼：

> 此版本的 Qt 适用于 Qt 应用程序（专有或开源）的开发，前提是您可以遵守[GNU LGPL 版本 2.1](http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html)中包含的条款和条件。

*请注意，LGPL 仍有一些要求。例如，如果您改进 Qt 源代码来为您的应用程序提供更好的性能或修复错误，您必须使您的修改的源代码可供您提供（出售；分发）应用程序的任何人使用。由于这本身并不是一个坏主意，因此人们可能希望将此类更改保密并将其用作竞争优势。*

另请参阅[Qt 许可常见问题解答](http://qt.nokia.com/about/licensing/frequently-asked-questions/)（感谢 Claudio 的评论）。

# java - antlr：如何在操作中使用 String.format

> ID：11216122
> 
> 赞同：0
> 
> 时间：2012-06-26T21:23:10.037
> 
> 标签：java, antlr, stringtemplate

我有一个规则，其动作定义如下：

```
metric_expr
  : metric=NAME ('AS' label=NAME)? {System.out.println(String.format("%s: %s", metric, label));}
  ; 
```

我得到错误说：

```
error(146): com\foo\bar\PRL.g:65:54: invalid StringTemplate % shorthand syntax: '%s' 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:30:11.847

`%`用一个反斜杠转义符号。

如果要显示标记的文本，请使用标记的`.text`属性：

```
metric_expr
  : metric=NAME ('AS' label=NAME)? 
    {System.out.printf("\%s: \%s", $metric.text, $label.text);}
  ; 
```

# c++ - C++ read()-ing 从一个套接字到一个 ofstream

> ID：11216125
> 
> 赞同：5
> 
> 时间：2012-06-26T21:23:14.880
> 
> 标签：c++, c, sockets

是否有 C/C++ 方法使用 read() 从套接字读取数据，并且接收缓冲区是文件（ofstream）或类似的自扩展对象（例如向量）？

**编辑：** 当我考虑如何读取可能接收 10000+ 字节文件内容的流套接字时，问题出现了。我只是从来没有喜欢将 20000 或 50000 字节（现在足够大）作为缓冲区放在堆栈上，文件可以在其中临时存储，直到我可以插入文件。为什么不直接将其流式传输到文件中以进行加注。

就像您可以在std：string中获取char *一样，我想到了类似的东西

```
read( int fd, outFile.front(), std::npos );  // npos = INT_MAX 
```

或类似的东西。

**结束编辑**

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:02:40.327

这很简单，而且我的手指头，但我认为这些方面的事情会奏效：

```
template <unsigned BUF_SIZE>
struct Buffer {
    char buf_[BUF_SIZE];
    int len_;
    Buffer () : buf_(), len_(0) {}
    int read (int fd) {
        int r = read(fd, buf_ + len_, BUF_SIZE - len_);
        if (r > 0) len_ += r;
        return r;
    }
    int capacity () const { return BUF_SIZE - len_; }
}

template <unsigned BUF_SIZE>
struct BufferStream {
    typedef std::unique_ptr< Buffer<BUF_SIZE> > BufferPtr;
    std::vector<BufferPtr> stream_;
    BufferStream () : stream_(1, BufferPtr(new Buffer<BUF_SIZE>)) {}
    int read (int fd) {
        if ((*stream_.rbegin())->capacity() == 0)
            stream_.push_back(BufferPtr(new Buffer<BUF_SIZE>));
        return (*stream_.rbegin())->read(fd);
    }
}; 
```

在评论中，您提到您希望避免创建大的字符缓冲区。使用`read`系统调用时，执行少量大读取通常比执行许多小读取更有效。因此，大多数实现将选择大输入缓冲区来获得这种效率。你可以实现类似的东西：

```
std::vector<char> input;
char in;
int r;
while ((r = read(fd, &in, 1)) == 1) input.push_back(in); 
```

但这将涉及系统调用和为每个输入字节复制至少一个字节。相比之下，我提出的代码避免了额外的数据副本。

我真的不希望我发布的代码是您会采用的解决方案。我只是想为您提供一个说明，说明如何创建一个相当节省空间和时间的自扩展对象。根据您的目的，您可能想要扩展它，或编写自己的。在我的脑海中，一些改进可能是：

*   改为使用`std::list`，以避免矢量调整大小
*   允许 API 一个参数来指定读取多少字节
*   用于始终允许一次读取`readv`至少`BUF_SIZE`字节（或多于字节）`BUF_SIZE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:29:10.973

看看[**`boost::asio`**](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/streambuf.html).

# c# - 这个 LINQ-to-Entities 连接似乎过于复杂，我做错了吗？

> ID：11216128
> 
> 赞同：1
> 
> 时间：2012-06-26T21:23:30.997
> 
> 标签：c#, linq, entity-framework, sybase

我有两个查询需要在 LINQ 中合并，它们实际上都来自同一个表。这样做的原因是，其中一个查询需要获取每天字段的最大值，然后将这些天数相加，而第二个查询可以立即汇总所有内容。这是第一个查询：

```
var queryDownload = from p in
                        (from p in almdbContext.cl_contact_event
                         where p.time_of_contact >= startDate && p.time_of_contact < endDate && p.input_file_name.Contains(inputFileName) && listName.Contains(listName)
                         group p by new
                         {
                             date = EntityFunctions.CreateDateTime(p.time_of_contact.Value.Year, p.time_of_contact.Value.Month, p.time_of_contact.Value.Day, 0, 0, 0),
                             listName = p.contact_list_name
                         } into g
                         select new
                         {
                             date     = g.Key.date,
                             listName = g.Key.listName,
                             download = g.Max(a => a.total_number_of_records)
                         })
                    group p by p.listName into g
                    select new
                    {
                        listName      = g.Key,
                        totalDownload = g.Sum(a => a.download),
                    }; 
```

这是第二个：

```
var queryPenData = from p in almdbContext.cl_contact_event
                   where p.time_of_contact >= startDate && p.time_of_contact < endDate && p.input_file_name.Contains(inputFileName) && listName.Contains(listName)
                   group p by p.contact_list_name into g
                   select new
                   {
                       listName           = g.Key,
                       dials              = g.Sum(a => a.ov_dial_start_time != null ? 1 : 0),
                       agentConnects      = g.Sum(a => a.agent_login_name != null ? 1 : 0),
                       abandons           = g.Sum(a => a.response_status == "DAC" || a.response_status == "DAD" ? 1 : 0),
                       rightPartyContacts = g.Sum(a => a.response_status == "PTP" || a.response_status == "RPC" ? 1 : 0),
                       promiseToPays      = g.Sum(a => a.response_status == "PTP" ? 1 : 0),
                       talkTime           = g.Sum(a => EntityFunctions.DiffSeconds(a.ov_call_connected_time, a.ov_trunk_released_time)) ?? 0,
                       wrapTime           = g.Sum(a => EntityFunctions.DiffSeconds(a.ov_trunk_released_time, a.record_released_time)) ?? 0
                   }; 
```

这是将它们连接在一起的查询。

```
var queryJoin = from qd in queryDownload
                join qp in queryPenData
                on qd.listName equals qp.listName
                select new
                {
                    listName           = qp.listName,
                    download           = qd.totalDownload,
                    dials              = qp.dials,
                    agentConnects      = qp.agentConnects,
                    abandons           = qp.abandons,
                    rightPartyContacts = qp.rightPartyContacts,
                    promiseToPays      = qp.promiseToPays,
                    talkTime           = qp.talkTime,
                    wrapTime           = qp.wrapTime
                }; 
```

这对我来说似乎非常冗长/迂回。有没有更好的方法可以编写/处理它来缩小/简化代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:23:32.183

对于您的最后一个查询，您不能只做这样的事情吗？

`var queryJoin = from qd in queryDownload join qpd in queryPenData on qd.listname equals qpd....`

应该能够做到这一点：

```
var queryJoin = from qd in queryDownload
            join qp in queryPenData
            on qd.listName equals qp.listName
            select new
            {
                qp, qd
            }; 
```

据我所知，您已经在其中形成了数据，`queryPenData`因此没有理由将其重新分配给最终连接中的新变量。只需选择允许您遍历匿名类型的对象`queryPenData`。我认为...

# android - 标题栏不断出现，即使使用 requestWindowFeature 或 android:theme

> ID：11216129
> 
> 赞同：6
> 
> 时间：2012-06-26T21:23:38.360
> 
> 标签：android, splash-screen, titlebar, custom-titlebar

我的问题正是[自定义标题栏的 sabe - 系统标题栏会短暂显示？](https://stackoverflow.com/questions/4950901/custom-titlebar-system-titlebar-being-shown-for-a-brief-moment)

但我无法达到与@Jerry 在最佳答案中所写相同的结果。“当我切换到使用主题来告诉框架我不想要标题时，问题就消失了，我现在在第一次加载时直接看到自己的标题”

我的代码：

显现：

```
<?xml version="1.0" encoding="UTF-8"?>
<manifest android:versionCode="3" android:versionName="1.0.2"
package="androidhive.dashboard"     xmlns:android="http://schemas.android.com/apk/res/android">
<uses-sdk android:minSdkVersion="8"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<application android:icon="@drawable/icone" android:label="@string/app_name">
    <activity 
        android:name="com.androidhive.dashboard.SplashScreen"
        android:theme="@android:style/Theme.NoTitleBar"
        android:label="@string/app_name"
        android:windowSoftInputMode="stateHidden|adjustResize">
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity> 
```

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
style="@style/SplashTheme"
 >

<ImageView
android:id="@+id/splashscreen_layout"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_gravity="fill_vertical"
android:contentDescription="Splash"
android:scaleType="centerCrop"
android:src="@drawable/splash"
style="@style/SplashTheme" />

</LinearLayout> 
```

风格：

```
<style name="SplashTheme" parent="@android:Theme.Black">
<item name="android:windowNoTitle">true</item>
<item name="android:background">@drawable/splash</item>
</style> 
```

闪屏.java

```
public class SplashScreen extends Activity implements Runnable{

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setTheme(R.style.SplashTheme);
    setContentView(R.layout.splashscreen_layout);

    Handler h = new Handler();
    h.postDelayed(this, 15000);
}

@Override
public void run() {
    startActivity(new Intent(this, AndroidDashboardDesignActivity.class));
    finish();
}
} 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T21:58:56.440

在 AndroidManifest 上的活动中使用您的主题，而不是在您的布局中！

这将起作用：SplashScreen.java

```
public class SplashScreen extends Activity{

    private Handler handler;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_launcher);

        final Runnable runnable = new Runnable() {

            @Override
            public void run() {
                   Intent intent=new Intent(SplashScreen.this, AndroidDashboardDesignActivity.class);
                   startActivity(intent);
                   finish();

            }
        };
        handler = new Handler();
        handler.postDelayed(runnable, 5000);

    } 
```

主题.xml

```
<style name="SplashTheme" parent="android:Theme">
    <item name="android:windowBackground">@null</item>
    <item name="android:windowNoTitle">true</item>
</style>

<style name="SplashTheme.FullScreen" parent="android:Theme">
    <item name="android:windowBackground">@null</item>
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowFullscreen">true</item>
</style> 
```

如果你想隐藏这个主题，第一个主题将为你显示状态栏，也使用第二个主题。我也使用属性 windowBackround 为空，因为之后你将使用你的图像作为你的 RootLayout 的背景，所以它更好不覆盖默认 android 主题用于性能问题的背景颜色。

在你的 splashscreen_layout 你可以使用这个

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/splash"
    android:orientation="vertical" >

</RelativeLayout> 
```

在你的清单中使用这个

```
<uses-sdk android:minSdkVersion="8" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<application
    android:icon="@drawable/icone"
    android:label="@string/app_name" >
    <activity
        android:name="com.androidhive.dashboard.SplashScreen"
        android:label="@string/app_name"
        android:theme="@style/SplashTheme"
        android:windowSoftInputMode="stateHidden|adjustResize" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

如果您想在清单中使用第二个主题更改

`android:theme="@style/SplashTheme"`和`android:theme="@style/SplashTheme.FullScreen"`

一种简单的方法是在布局中删除或设置样式标签，然后`android:theme="@android:style/Theme.NoTitleBar"`在活动标签下添加清单

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T21:27:02.210

放：

```
android:theme="@android:style/Theme.NoTitleBar" 
```

在您的应用程序选项卡下，而不是您的活动之一

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-07T14:04:30.273

基于 Krunal 解决方案，您可以简单地将这一行放在`<activity>`activity.xml 文件中的标记内：

```
android:theme="@style/Theme.AppCompat.NoActionBar" 
```

IE替换： `android:theme="@style/SplashTheme"`

和：

`android:theme="@style/Theme.AppCompat.NoActionBar"`

里面

```
<activity
        android:name=".ActivityName"
        android:theme="@style/SplashTheme"> // replace this line

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity> 
```

给予：

```
<activity
            android:name=".ActivityName"
            android:theme="@style/Theme.AppCompat.NoActionBar"> // line replaced

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
    </activity> 
```

这使您无需向 styles.xml 添加任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-22T15:00:14.550

`AppCompat`这似乎工作方式不同。

以下解决方案对我有用：

`styles.xml`在您的和设置中添加没有操作栏的新主题样式`parent="Theme.AppCompat.NoActionBar"`。

```
<style name="SplashTheme" parent="Theme.AppCompat.NoActionBar">

    <item name="colorPrimary">@color/colorPrimary</item>
    <item name="colorPrimaryDark">@color/colorPrimary</item>
    <item name="colorAccent">@color/colorAccent</item>
    <item name="android:windowBackground">@color/colorPrimary</item>

</style> 
```

现在为您的初始屏幕活动实现相同的主题样式`androidManifest.xml`

```
<activity
        android:name=".ActivityName"
        android:theme="@style/SplashTheme"> // apply splash them here 

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity> 
```

这是结果：

[![在此处输入图像描述](../Images/13a7ac586f9b7ff4c0c36a9d97d6929d.png)](https://i.stack.imgur.com/VjUFB.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-30T11:29:04.823

**在你的 MainActivity 中使用这个**

```
 getSupportActionBar().hide();
   getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

# android - 返回位图，需要 Uri

> ID：11216130
> 
> 赞同：1
> 
> 时间：2012-06-26T21:23:38.703
> 
> 标签：android, android-intent

这是我的第一篇文章。

我有一个作物意图重新调整并将位图分配给 ImageView。但我想要的是新位图的 URI。

我怎样才能从“照片”变量中获取 Uri，或者返回带有意图结果的 URI。

```
protected void onActivityResult(int requestCode, int resultCode, Intent data)       

    case CROP_FROM_CAMERA:
        Log.d(TAG, "Returned from Crop");
        Bundle extras = data.getExtras();

        Uri uriCropped = data.getData();

        if (extras != null) {               
            Bitmap photo = extras.getParcelable("data");
            Log.d(TAG, "Setting Crop preview with URI: " + uriCropped);
            ImageView mImageView2 = (ImageView) findViewById(R.id.mImageView);
            mImageView2.setImageURI(uriCropped);

        }

        File f = new File(mImageCaptureUri.getPath());            
        if (f.exists()) f.delete();

        startX(<URI of 'photo' needed>);
        break; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:38:47.190

您的`photo`var 仅存在于内存中，因此它没有 Uri。如果您需要 Uri 将其保存到设备存储并使用[Uri.fromFile(File file)](http://developer.android.com/reference/android/net/Uri.html#fromFile%28java.io.File%29)检索它。

# jquery - 这个带有方括号和插入符号的 jQuery 代码是什么意思？

> ID：11216134
> 
> 赞同：11
> 
> 时间：2012-06-26T21:24:03.643
> 
> 标签：jquery

这个 jQuery 代码是什么意思？

```
$('tr[id^="message"]') 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-26T21:25:16.043

这意味着 - 选择属性以字符串开头的所有`tr`元素`id``message`

[http://api.jquery.com/attribute-starts-with-selector/](http://api.jquery.com/attribute-starts-with-selector/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T21:26:12.987

`[]`指一个元素的属性（id 是一个）并且`id^`是一个通配符，这意味着 id 必须以“消息”开头。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-26T21:25:39.650

这意味着一个表行，其 id 以“消息”开头：

```
$('tr // a table row
[id //having an id 
^="message"]') // starting with 'message' 
```

[http://api.jquery.com/category/selectors/attribute-selectors/](http://api.jquery.com/category/selectors/attribute-selectors/)

# javascript - javascript 中的 RemoveChild() 错误

> ID：11216136
> 
> 赞同：0
> 
> 时间：2012-06-26T21:24:12.510
> 
> 标签：javascript, removechild, dom

我在 php 文件中使用一个函数来创建一些“li”和一些“span”元素，如下所示：

```
while($row_quotes=mysql_fetch_array($result_quotes) and $x<10){
$x++;
echo "<li class='citazione'>".$row_quotes['citazione']."</li><span class='citazione_info'>".$row_quotes['personaggio']." - ".$row_quotes['libro']."</span>";
} 
```

这些包含在“ul id='quotes_holder'”中。然后我有一个javascript函数，在某个调用中应该删除所有创建的“li”和“span”元素，所以我认为使用包含“ul”的removeChild（）方法可以删除它们。

这是javascript函数：

```
function ritorna_filtri(obj, autore){
var index=obj.selectedIndex;
var selected=obj.childNodes[index];
var value= selected.value;
var div=document.getElementById('quotes_holder');
for(l=0;l<div.childNodes.length;l++){
    div.removeChild(div.childNodes[l]);
}

var xmlhttp;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        response=xmlhttp.responseText;
        jsonObj=eval("("+response+")");
        for(i=0;i<jsonObj.libri.length;i++){
            var li=document.createElement('li');
            var text=document.createTextNode(jsonObj.libri[i].titolo);
            li.appendChild(text);
            li.setAttribute('class', 'filtro');
            div.appendChild(li);
        }
    }
}
xmlhttp.open("GET","ritorna_filtri.php?filtro="+value+"&autore="+autore,true);
xmlhttp.send();
} 
```

问题是当函数执行时，只有“li”元素被删除，“span”仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:27:33.273

注意： a 的唯一有效子元素`ul`是零个或多个`li`元素：[https ://developer.mozilla.org/en/HTML/Element/ul](https://developer.mozilla.org/en/HTML/Element/ul)

看看这个 jsFiddle：http: [//jsfiddle.net/MrpeF/](http://jsfiddle.net/MrpeF/)

在其中，我创建了两个`ul`s - 一个具有有效元素（`li`仅），另一个如您所描述的那样，`span`s 也是子级。如果您在控制台运行时观察它，您会发现只有`li`元素包含在`childNodes`（奇怪的是，我的代码间距中的 TextNodes ！？）。不同之处在于，有效的 HTML 具有`span`内部`li`，因此删除`li`将实现您的目标。

值得一提的另一件事是您的`for...`循环效率低下。通过计算`childNodes`每次迭代的长度，您使循环成本超过了它需要的成本。在实际进入循环之前计算循环的长度更有效：

```
var looplen = div.childNodes.length;
for(l=0;l<looplen;l++){
    div.removeChild(div.childNodes[l]);
} 
```

**文档**

*   MDN 上的 Node.removeChild - [https://developer.mozilla.org/En/DOM/Node.removeChild](https://developer.mozilla.org/En/DOM/Node.removeChild)
*   MDN 上的 Node.childNodes - [https://developer.mozilla.org/en/childNodes](https://developer.mozilla.org/en/childNodes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:40:43.817

您的原始代码不起作用，因为您从`0`to循环，`childNodes.length - 1`但您忘记了一旦删除项目 #0 并增加计数器，项目 #1 将在下一次迭代中删除；#0 处仍然会有一个项目。

以下代码可用于删除元素的内容：

```
var div = document.getElementById('quotes_holder');
while (div.firstChild) {
    div.removeChild(div.firstChild);
}​ 
```

# [演示](http://jsfiddle.net/salman/ztQnT/)

PS：您的 HTML 标记无效。

# python - 在没有类实例的情况下访问类级别成员

> ID：11216138
> 
> 赞同：1
> 
> 时间：2012-06-26T21:24:21.943
> 
> 标签：python

是否可以在没有类实例的情况下访问类成员？例如：

```
class MyClass(object):
    MyMember = 1

class MyOtherClass(object):
    def __init__(self):
        print MyClass.MyMember  #MyClass().MyMember works out but not MyClass.MyMember 
```

我正在寻找与 C++ 中的静态类成员同义的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:26:19.133

是的，这是可能的。 [您的代码有效。](http://ideone.com/17F9w)

# user-interface - wxpython 使用 time.sleep() 而不阻塞完整的 GUI

> ID：11216139
> 
> 赞同：3
> 
> 时间：2012-06-26T21:24:32.177
> 
> 标签：user-interface, time, wxpython, blocking

我想以特定的时间间隔更改我的 GUI 中显示的文本。经过很多方法，我发现，特别是我的要求，我必须使用，`time.sleep()`而不是`wx.Timer`，但`time.sleep()`冻结完整的 GUI。这是我的代码示例：

```
import wx
import time

DWELL_TIMES = [1, 2, 1, 3]
SCREEN_STRINGS = ['nudge nudge', 'wink wink', 'I bet she does', 'say no more!']

class DM1(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)
        panel = wx.Panel(self)
        text_display = wx.StaticText(panel, pos = (400, 150))

        for dwell_time in DWELL_TIMES:
            text_display.SetLabel(SCREEN_STRINGS[dwell_time])
            time.sleep(float(DWELL_TIMES[dwell_time]))

app = wx.App()
DM1Frame = DM1(None, size = (800, 600))
DM1Frame.Center()
DM1Frame.Show()
app.MainLoop() 
```

有人知道为什么会发生这种情况，以及如何使 GUI 不阻塞？我想这`Threading`对我有帮助，不是吗？如果是这样，将线程放入此代码中的正确方法是什么？有替代方案`Threading`吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T13:46:21.100

正如其他人所提到的，`wx.CallAfter`是`wx.CallLater`你的朋友。研究它们并学习它们。这是一个完整的工作示例，使用`wx.CallLater`. 我包括了其他我认为合适的重构。

```
import wx

DATA = [
    (1, 'nudge nudge'),
    (2, 'wink wink'),
    (1, 'I bet she does'),
    (3, 'say no more!'),
]

class Frame(wx.Frame):
    def __init__(self):
        super(Frame, self).__init__(None)
        panel = wx.Panel(self)
        self.text = wx.StaticText(panel)
        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.AddStretchSpacer(1)
        sizer.Add(self.text, 0, wx.ALIGN_CENTER)
        sizer.AddStretchSpacer(1)
        panel.SetSizer(sizer)
        self.index = 0
        self.update()
    def update(self):
        duration, label = DATA[self.index]
        self.text.SetLabel(label)
        self.index = (self.index + 1) % len(DATA)
        wx.CallLater(int(duration * 1000), self.update)

if __name__ == '__main__':
    app = wx.App(None)
    frame = Frame()
    frame.SetTitle('Example')
    frame.SetSize((400, 300))
    frame.Center()
    frame.Show()
    app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:19:33.370

如果您查看[time.sleep()](http://docs.python.org/library/time.html#time.sleep)的文档，您会发现它基本上会在指定的时间间隔内阻止该线程的执行。问题是当前您的 GUI 只有一个线程，因此如果您阻塞线程，那么您会阻塞该线程中的所有执行。这意味着，正如您所经历的，GUI 在睡眠期间无法使用。

即使使用线程，`time.sleep()`调用也不能与 GUI 在同一个线程中，因此试图在睡眠结束后让你的 GUI 刷新将非常复杂。除此之外，它基本上是重新实现`wx.Timer`！重做已经为你完成的事情是没有用的。

在我看来，您的问题不应该是“我如何让睡眠发挥作用？” 以及更多“为什么不能`wx.Timer`正常工作？” 请详细说明您遇到的问题`wx.Timer`。为什么它不起作用？也许发布一些代码。我的猜测是你可能没有`wx.EVT_TIMER`正确绑定。看看[这个教程](http://www.blog.pythonlibrary.org/2009/08/25/wxpython-using-wx-timers/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T02:59:44.167

> 将线程放入此代码中的正确方法是什么？

尽管 using`wx.Timer`是这个简化示例的正确解决方案，但如果您的真正目标是知道如何使用工作线程来执行长任务并在不冻结整个应用程序的情况下对主 GUI 进行更新，那么方法如下：

```
import wx
import threading
import time

class WorkerThread(threading.Thread):
    DWELL_TIMES = [1, 2, 1, 3]
    SCREEN_STRINGS = ['nudge nudge', 'wink wink', 'I bet she does', 'say no more!']

    def __init__(self, window):
        threading.Thread.__init__(self)
        self.window = window

    def run(self):
        for i in range(len(WorkerThread.DWELL_TIMES)):
            wx.CallAfter(self.window.set_text, WorkerThread.SCREEN_STRINGS[i])
            time.sleep(float(WorkerThread.DWELL_TIMES[i]))
        wx.CallAfter(self.window.close)

class DM1(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)
        panel = wx.Panel(self)
        self.text_display = wx.StaticText(panel, pos = (400, 150))
        self.kickoff_work()

    def kickoff_work(self):        
        t = WorkerThread(self)
        t.start()

    def set_text(self, text):
        self.text_display.SetLabel(text)

    def close(self):
        self.Close()

app = wx.App()
DM1Frame = DM1(None, size = (800, 600))
DM1Frame.Center()
DM1Frame.Show()
app.MainLoop() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T03:36:31.137

我可能会建议你去使用`wx.CallLater`. 参考官方文档：[http ://wxpython.org/docs/api/wx.CallLater-class.html](http://wxpython.org/docs/api/wx.CallLater-class.html)

> wx.Timer 的一个便利类，它在给定的毫秒数后调用给定的可调用对象一次，并传递任何位置或关键字参数。可调用对象的返回值在使用 GetResult 方法运行后可用。
> 
> 如果您不需要获取返回值或重新启动计时器，则无需持有对该对象的引用。它会在定时器运行时持有对自身的引用（定时器有对 self.Notify 的引用）但是当定时器完成时循环将被打破，自动清理 wx.CallLater 对象。

可以在这个问题中找到可能的进一步参考：[Using wx.CallLater in wxPython](https://stackoverflow.com/questions/5851824/using-wx-calllater-in-wxpython)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T21:41:56.653

您可以尝试创建一个全局变量来获取它首次启动的时间，然后让第二个变量获取当前时间，并查看这两个时间是否相距足够远以工作。像这样的东西：

当文本变成新的东西时，

```
global timestart

timestart = gettime() 
```

然后，在您检查是否要更改代码的地方，

```
timestop = gettime()

if timestop - timestart >= timebetweenchanges:
    change code 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T19:59:03.863

我不明白为什么你不能为此使用计时器。它们似乎是为您需要它们的确切目的而制造的。正如 acattle 已经提到的，我写了一个关于这个主题的[教程。](http://www.blog.pythonlibrary.org/2009/08/25/wxpython-using-wx-timers/)

不过他是完全正确的。使用 time.sleep() 将冻结 GUI，因为它阻塞了 wx 的主事件循环。如果您绝对必须使用 time.sleep() （我对此表示怀疑），那么您可以使用线程。我也写了一个关于这个主题的[教程。](http://www.blog.pythonlibrary.org/2010/05/22/wxpython-and-threads/)事实上，我在那个例子中实际上使用了 time.sleep() 。

# objective-c - xCode sqlite 查询

> ID：11216143
> 
> 赞同：1
> 
> 时间：2012-06-26T21:24:50.943
> 
> 标签：objective-c, ios, xcode, sqlite

这一定是一个愚蠢的问题，但我无法让我的查询工作。好像我的数据库是空的（我仔细检查过，不是）。它是一个简单的`SELECT * FROM table`查询。这就是我尝试的方式：

```
+(MyDatabase *)database{
    if (database == nil) {
        database = [[MyDatabase alloc] init];
    }
    return database;
}
- (id)init
{
    self = [super init];
    if (self) {
        NSString *sqliteDb = [[NSBundle mainBundle] pathForResource:@"personsDB" ofType:@"sqlite3"];
        if (sqlite3_open([sqliteDb UTF8String], &database) != SQLITE_OK) {
            NSLog(@"Fail to open Database.");
        }
    }
    return self;
} 
```

和

```
-(NSArray *)getAllRows{
    NSMutableArray *retArray =  [[NSMutableArray alloc] init];
    NSString *query = @"SELECT * FROM persons";

    sqlite3_stmt *statement;
    NSLog(@"checking SQLITE_OK?");
    if (sqlite3_prepare_v2(database, [query UTF8String], -1, &statement, nil) == SQLITE_OK) {
        NSLog(@"SQLITE_OK");
        while (sqlite3_step(statement) == SQLITE_ROW) {
            int personID = sqlite3_column_int(statement, 0);
            char *personChars = (char *) sqlite3_column_text(statement, 1);
            int gender = sqlite3_column_int(statement, 2);
            int related = sqlite3_column_int(statement, 3);

            NSString *person = [[NSString alloc] initWithUTF8String:personChars];
            MyDBInfo *info = [[MyDBInfo alloc] initWithpersonID:personID person:person gender:gender related:related ];

            [retArray addObject:info];
        }
        sqlite3_finalize(statement);
    }
    return retArray;
} 
```

我认为这就是所有有趣的东西。

在我的日志中，我得到了`checking SQLITE_OK?`，但没有`SQLITE_OK`。我没有得到`Fail to open Database.`，所以我假设那里一切都很好。

我的数据库已满，并且有一个名为`persons`. 我对`sqlite`in很陌生`iOS apps`。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T23:39:09.000

1.  您确定 db 包含在您的捆绑包中吗？的默认行为[`sqlite3_open`](http://sqlite.org/c3ref/open.html)是`SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE`，因此如果它不存在，它将在您的设备/模拟器上创建，因此您不会看到`Fail to open Database`. `sqlite3_open_v2`如果您不想要，请使用`SQLITE_OPEN_CREATE`. 无论如何，我有时会在我的 xcode 项目中添加文件，但它们不会自动包含在我的包中。在项目导航器顶部选择目标，点击目标，在主面板中选择目标，选择“Build Phases”，看看你的db是否包含在“Copy Bundle Resources”中。

2.  可能不相关，但我总是将数据库从捆绑包复制到文档文件夹（如果它不存在的话）。

3.  如果我没有收到预期的 SQLITE_OK，我总是查看我的返回代码或记录我的错误消息和错误代码（这可能会报告未找到有问题的表，这可以让您识别问题）。

因此，

```
NSLog(@"%s db err '%s' (%1d)", __FUNCTION__, sqlite3_errmsg(contactDB), sqlite3_errcode(contactDB)); 
```

# ruby-on-rails - 如何在不登录的情况下限制用户通过电子邮件链接进行操作？

> ID：11216145
> 
> 赞同：2
> 
> 时间：2012-06-26T21:24:58.310
> 
> 标签：ruby-on-rails, ruby-on-rails-3

作为我的应用程序的一部分，用户可以通过电子邮件批准某些“请求”。请求有自己的模型，因此每个请求都有唯一的 id。

用户在链接中收到一封带有命名路由的电子邮件：'approve/:id' 其中 :id 是请求的 id。然后，approve 方法处理批准逻辑等。

如何防止用户在没有事先登录的情况下批准向其他用户提出的请求？由于 id 可以在 URL 中自由显示，我猜需要 GUID 还是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:06:53.227

如果您真的想这样做，那么是的，您需要某种 GUID。也许是 user_id 或电子邮件地址的加密哈希（？）。所以你最终使用`/approve/:id/:GUID`.

我很惊讶您不希望用户登录，请记住，如果他们登录，您可以自动将他们重定向到批准。此外，如果 cookie 仍然有效，则用户可能已经登录。

# youtube - 如何从 url 的列表 PHP 中获取 Youtube IDS

> ID：11216146
> 
> 赞同：0
> 
> 时间：2012-06-26T21:25:00.823
> 
> 标签：youtube

抱歉可能是非常初学者的问题。我有一个带有 post 方法的文本区域，我将在其中列出 youtube URL，如下所示：

```
http://www.youtube.com/watch?v=bT7kCbgEAqw
http://www.youtube.com/watch?v=AwyucYgVKb0
http://www.youtube.com/watch?v=QP8PyUhx1AU
http://www.youtube.com/watch?v=AvTg20fYZcE 
```

我只想要视频ID，什么是获得这样的视频ID的好方法：

```
bT7kCbgEAqw
QP8PyUhx1AU
AwyucYgVKb0
AvTg20fYZcE 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T23:46:40.997

```
$vid_id = explode("?v=", $link);
$vid_id = $video_id[1]; 
```

将 $link 设为您的 URL，然后这将返回 URL 中 ?v= 之后的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T09:25:52.103

因为 youtube 网址也可以是[http://www.youtube.com/v/id](http://www.youtube.com/v/id) de explode 并不总是有效。以下代码将获取两个 url 的 v id。

```
<?php $youtube_url =  'http://www.youtube.com/watch?v=XXXXXXXX';
parse_str(parse_url($youtube_url, PHP_URL_QUERY), $youtube); ?>

<object width="400" height="224">
<param name="movie" value="https://www.youtube-nocookie.com/v/<?= $youtube['v'] ?>"></param>
<param name="allowFullScreen" value="true"></param>
<param name="allowscriptaccess" value="always"></param>
<embed src="https://www.youtube-nocookie.com/v/<?= $youtube['v'] ?>" type="application/x-shockwave-flash" width="400" height="224" allowscriptaccess="always" allowfullscreen="true"></embed>
</object> 
```

# html - 电子邮件打开跟踪：绕过删除图像标签中属性的电子邮件转发器？

> ID：11216148
> 
> 赞同：0
> 
> 时间：2012-06-26T21:25:03.930
> 
> 标签：html, email, tags, image, tracking

这可能是不可能的，但我想我会试一试。如果我使用的服务去除了图像标签 => 的属性，有什么办法可以绕过它吗？

我尝试插入随机 unicode 字符来破坏解析器，但失败得很惨......

我的最终目标是能够跟踪电子邮件的打开情况，而我知道如何做到这一点的唯一方法是通过电子邮件 html 中的图像...

谢谢！乔纳森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:53:24.560

有很多方法可以跟踪打开。例如从服务器请求 CSS 文件、单击任何链接、加载 bgsound 或渲染一个特定（或任何）图像。透明像素是最常见的方式。

（因为除了回答：什么服务？以及什么属性被剥夺之外，我没有看到任何询问更多细节的选项？）

# javascript - 十分钟了解 Javascript：在这个说明惰性作用域的示例代码中发生了什么？

> ID：11216150
> 
> 赞同：5
> 
> 时间：2012-06-26T21:25:05.777
> 
> 标签：javascript, functional-programming, naming-conventions

我在十分钟内重新阅读了 Spencer Tipping 的优秀[Javascript](http://github.com/spencertipping/js-in-ten-minutes)，我一生都无法弄清楚这个使用惰性作用域创建语法宏的示例中发生了什么：

```
var f = function () {return $0 + $1};  
var g = eval (f.toString ().replace (/\$(\d+)/g,  
           function (_, digits) {return 'arguments[' + digits + ']'}));  
g(5,6); // => 11 (except on IE) 
```

尤其是，

1.  $0 和 $1 正在被函数定义所取代——如何评估*该*函数？（大概是通过 eval()，但我没有看到这个）。
2.  函数中单个下划线参数的目的是什么——如果我把它拿出来，代码就不再起作用了。大概它只是一个占位符，但为什么需要它呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T21:35:08.843

我在这里同意**pst**，这段代码非常可怕。这对于可读性来说是可怕的。不过，它很整洁：

1.  `f`被定义为一种占位符函数。它似乎是实际的 *宏*本身；数值变量在评估为`g`. 它们充当位置的可变参数，我们将在下面看到。
2.  `g`奇迹发生的地方：函数定义`f`被转换为字符串，宏定义中的数字变量`f`被替换为对索引参数的引用，因为定义中存在尽可能多的数字变量`f`（因此正则表达式和调用到`replace`）。之所以使用下划线，是因为我们不关心回调的第一个参数`replace`。
3.  然后整个事情被`eval`编辑，一次`f`基本上扩展到以下内容：

    ```
    function () { return arguments[0] + arguments[1] } 
    ```

因此，它很简洁，因为您可以根据需要使用任意数量`f`的位置数字参数进行定义：

```
var f = function() { return $0 + $1 + $2 } 
```

它会被评估为

```
function() { return arguments[0] + arguments[1] + arguments[2] } 
```

整洁，但无用，可以说是危险的，不切实际的，难以阅读。我可能永远不会使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T21:30:39.363

那个代码吓到我了。完全不应该使用它。（除非有一些*真正令人信服的理由这样做*；我不知道有任何¹ ²。）此外，上面的代码中*没有*演示“函数式编程”，*可能*不包括回调的使用。但见鬼，即使 C 也可以轻松做到这一点，因为没有涉及到闭包。

`_`只是一个有效的标识符（如`foo`or`_foo`或`$0`）。这里的 is 用于“不关心”（该值是整个匹配文本的值，因为该函数是 RegExp 匹配的“回调”）。

`$0`和`$1`分别替换为`arguments[0]`和`arguments[1]`（记住这是函数“到字符串”值的*文本替换！）。*它可以在没有“宏”的情况下手动输入：

```
function () { return arguments[0] + arguments[1] } 
```

或者我会做什么：

```
function (a,b) { return a + b } 
```

其余的 ( `Function.toString`and `eval(functionStr)`) 支持依赖于的“宏”东西是无稽之谈：`Function -> codeString -> alteredCodeString -> Function`.

此代码需要一个可以发出“原样”的*工作。* `Function.toString`我不确定 IE 什么时候开始支持这个，但它似乎在 IE9 中工作。

* * *

¹这是一个善意的谎言，但我使用这种方法的*唯一*地方涉及侧边栏小工具中的 IE，当弹出按钮被收回时，DOM 可能会“过早卸载”，以及尝试调用另一个函数时的一些其他混乱`window`语境。一个关于混乱的情况..

²[函数式 JavaScript 库](http://osteele.com/sources/javascript/functional/)展示了*没有* `eval`.

# php - PHP - 从 CSS 文件中提取图像的所有路径的正则表达式

> ID：11216152
> 
> 赞同：3
> 
> 时间：2012-06-26T21:25:07.330
> 
> 标签：php, css, regex, background-image

我试图找到正则表达式，它将从 css 文件中提取所有路径。我已经搜索过，我能找到的只有这两个帖子，实际上似乎不起作用：

[PHP - 从 css 中提取图像路径](https://stackoverflow.com/questions/5688508/php-extract-image-paths-from-css)

[为什么这个 PHP 正则表达式不从 css 值中提取 url？](https://stackoverflow.com/questions/7677354/why-doesnt-this-php-regular-expression-extract-the-url-from-the-css-value)

我想要得到的是这样的数组：

```
array(0 => 'image/header.gif', 1 => 'image/footer.png') etc. 
```

知道提取它的正则表达式是什么 - 请记住，字符之间可能没有空格，或者 url() 的左括号和右括号之间也可能有额外的空格。

我正在使用以下内容来处理 css 并提取路径（但显然我没有正确的表达式来按照我想要的方式进行操作）：

```
$images = array();                  
if (preg_match_all($regex, $cssContent, $matches)) {
    $images = $matches[1];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T21:31:18.760

把它整理好了。对于那些有兴趣了解的人 - 这是从 css 文件中提取所有图像路径的表达式：

```
'/url\(\s*[\'"]?(\S*\.(?:jpe?g|gif|png))[\'"]?\s*\)[^;}]*?/i' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:28:57.233

像这样的东西，我想：

```
/url\s*\(\s*['"]([^'"]+)['"]\s*\)/ 
```

# overlay - php gd 库显示背景图像

> ID：11216153
> 
> 赞同：1
> 
> 时间：2012-06-26T21:25:11.433
> 
> 标签：overlay, gd

我有两个相同大小的图像，我想使用它们。一张是彩色的，另一张是黑白的。我需要帮助将彩色图像直接叠加在黑白图像上。之后，我希望能够删除顶部照片的部分以显示下面的图像。

有人可以为我指出如何实现这一目标的正确方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:44:04.230

这可能会有所帮助：

[http://forums.devshed.com/php-development-5/how-do-i-merge-various-images-into-one-using-gd-502604.html](http://forums.devshed.com/php-development-5/how-do-i-merge-various-images-into-one-using-gd-502604.html)

尤其是关于添加水印的部分。

在组合它们之前，您必须将透明区域添加到顶部图像。

李

# google-maps-api-3 - 如何使用 xml 数据源 Google API v3 打开 infowindow onload

> ID：11216154
> 
> 赞同：0
> 
> 时间：2012-06-26T21:25:11.463
> 
> 标签：google-maps-api-3

我看过一些涉及类似主题的帖子，但还不够接近，无法申请到我的网站。在此页面上加载地图时，我希望打开某个信息窗口：[http](http://www.wrh.noaa.gov/mfr/rec) ://www.wrh.noaa.gov/mfr/rec 。

我想传递一个 url 参数（我已经这样做了用于缩放、中心等），它将打开一个特定的 infowindow onload 而不会更改页面的整体功能（如果没有为 infowindow 传递 url 参数）。

谢谢你的帮助。我想我必须做一些编辑 b/c 我在 infowindow 上显示了多个变量（与 xml 元素相关联......我从我的 xml 文档中获取了标记的大部分内容）和在带有预报的地图下方。

* * *

**我认为我的问题并不完全**清楚。我会改写：肖恩，非常感谢。我不想只打开一个信息窗口来创建另一个网页，我认为这就是您的建议。我有客户希望我的地图放大，只显示一个娱乐站点（标记），信息窗口打开，并在页面下方显示预测。这是我想要的示例（设置缩放和中心值的 url 参数），但我无法打开地图中显示的唯一标记的信息窗口。例如，如果我可以编写这样的 URL：[http ://www.wrh.noaa.gov/mfr/rec/index.php?t=roadmap&lat=42.10053453772226&lng=-123.40782557983397&z=12&window=oregoncaves](http://www.wrh.noaa.gov/mfr/rec/index.php?t=roadmap&lat=42.10053453772226&lng=-123.40782557983397&z=12&window=oregoncaves) 将显示放大的地图并打开信息窗口。我只是不知道该怎么做。似乎我会有一个 if 语句来检查 URL 参数“window”是否等于“oregoncaves”，然后为该标记打开该信息窗口。再次感谢您的帮助。

小号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:36:15.690

您的问题提到了缩放和中心的 url 参数，但我已经检查了您链接中的页面，它使用标准的 JavaScript v3 API 来处理这些，而不是 url 参数。

这似乎有点令人困惑，所以我可能遗漏了一些东西，但如果你想创建一个立即打开的`InfoWindow`[^(开发指南)](https://developers.google.com/maps/documentation/javascript/overlays#InfoWindows)，只需创建`InfoWindow`[^(api-doc)](https://developers.google.com/maps/documentation/javascript/reference#InfoWindow)将与之关联的对象（通常是`google.maps.Marker`[^(api-doc)](https://developers.google.com/maps/documentation/javascript/reference#Marker)），然后创建 `InfoWindow`在地图创建之后（代码主要取自开发者指南，带有一些小模组）：

```
var myLatlng = new google.maps.LatLng(-25.363882,131.044922);
var myOptions = {
  zoom: 4,
  center: myLatlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
}

var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

var contentString = '<div id="content">'+
    '<div id="siteNotice">'+
    '</div>'+
    '<h2 id="firstHeading" class="firstHeading">Uluru</h2>'+
    '<div id="bodyContent">'+
    '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
    'sandstone rock formation in the southern part of the '+
    'Northern Territory, central Australia. It lies 335 km (208 mi) '+
    'south west of the nearest large town, Alice Springs; 450 km '+
    '(280 mi) by road. Kata Tjuta and Uluru are the two major '+
    'features of the Uluru - Kata Tjuta National Park. Uluru is '+
    'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
    'Aboriginal people of the area. It has many springs, waterholes, '+
    'rock caves and ancient paintings. Uluru is listed as a World '+
    'Heritage Site.</p>'+
    '<p>Attribution: Uluru, <a href="http://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
    'http://en.wikipedia.org/w/index.php?title=Uluru</a> (last visited June 22, 2009).</p>'+
    '</div>'+
    '</div>';

var marker = new google.maps.Marker({
    position: myLatlng,
    map: map,
    title:"Uluru (Ayers Rock)"
});

var infowindow = new google.maps.InfoWindow({
    content: contentString
});
infowindow.open(map,marker); 
```

# c++ - int main(int, char const* const*) 格式正确吗？

> ID：11216155
> 
> 赞同：7
> 
> 时间：2012-06-26T21:25:15.297
> 
> 标签：c++, c++11

根据 C++11 标准，以下程序是否格式良好且可移植的 C++？

```
int main(int argc, char const* const* argv) {} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-26T21:32:49.167

不。在纯可移植 C++ 程序中，`argv`参数（如果存在）没有`const`修饰符。

**编辑：**请参阅 C++11 草案标准的第 3.6.1.2 节，其中（在我之前的版本中）指出：

> 实现不应预定义主要功能。该功能不得重载。它应该有一个 int 类型的返回类型，否则它的类型是实现定义的。所有实现都应允许以下两种 main 定义：
> 
> `int main(){ /*...*/ }`
> 
> 和
> 
> `int main(int argc, char* argv[]) { /* ... */ }`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T22:23:49.360

取决于您所说的便携式。一个邪恶的 C++ 实现可能会拒绝它，理由是它的签名 ,`int(int,char const*const*)`与所需的允许签名之一不同，`int()`并且`int(int,char**)`. （一个邪恶的实现可能看似拒绝`auto main(int argc,char* argv[]) -> int`，或者实际上拒绝任何`main`关于身体不在哪里的定义`{ /* ... */ }`）

然而这并不典型。我不知道添加 const 会导致调用问题的任何实现，并且由于 C++11 添加了有关“相似”类型的位，因此在通过变量访问对象`main`时不会违反严格的别名规则。`char**``char const * const *`

因此，虽然符合标准的实现在技术上可能会拒绝它，但我认为它可以移植到您可能希望使用的任何实现中。

# java - 从 Java 中的套接字读取字节

> ID：11216156
> 
> 赞同：1
> 
> 时间：2012-06-26T21:25:15.827
> 
> 标签：java, sockets

我有一个 Java 套接字（`java.net.ServerSocket`）。我使用`InputStream`.

当它们可用时，我想从套接字读取几个字节。所以我用`InputStream.read(bytes, 0, num)`.

当我在本地测试它时它工作正常（超过 127.0.0.1）。但是当我把它放在互联网上并连接到它时，它只能读取 2916 个字节。我怎样才能准确地读取“num”个字节而不继续，我收到它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:28:56.660

听起来与您的网络设置方式有关。其他东西可能正在向它发送数据。您是否尝试过使用不同的端口？

如果这不起作用，请尝试禁用您的网络连接/断开与您的网络的连接，看看它是否来自外部的东西实际上是导致问题的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T10:01:24.437

这就是套接字读数通常的工作方式。当使用比环回慢的“网络”时，所有数据都不会立即传输。

`read(bytes, 0, num)`当有可用数据时将返回。可能有一个或多个字节，甚至超过`num`可用字节。`num`仅限制移动到`bytes`数组的数据量。

因此，如果您想接收 excatly`num`字节，则必须`read`再次调用。当然参数`len`越来越小`off`。

例子：

```
 int offset = 0;
    int wanted = buffer.length;

    while( wanted > 0 )
    {
        final int len = istream.read( buffer, offset, wanted );     
        if( len == -1 )
        {
            throw new java.io.EOFException( "Connection closed gracefully by peer" );
        }
        wanted -= len;
        offset += len;
    } 
```

# ios - 通过 iOS5/6 上传媒体

> ID：11216158
> 
> 赞同：-1
> 
> 时间：2012-06-26T21:25:19.287
> 
> 标签：ios, media, libraries, uploading

是否可以（如果可以，如何）允许 iOS5/6 应用程序中的用户从标准 iOS 应用程序库（例如音乐、照片、视频等）中上传基于音频、视频、文本和图像的文件？ ) 和/或第三方应用程序库（例如 Dropbox、Google Drive、iCloud 等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:38:52.617

可以，但前提是第三方拥有允许从 iOS 应用程序访问的 API 或 SDK。Apple 提供用于访问音乐、照片和文档的 API。如果您查阅软件提供商提供的文档，他们都应该有如何获得文件访问权限的示例。将文件上传到任何地方将是您的应用程序的责任。

# css - Ruby on Rails CSS

> ID：11216166
> 
> 赞同：0
> 
> 时间：2012-06-26T21:25:51.073
> 
> 标签：css, ruby-on-rails

我正在尝试使用 css 为我的视图着色。控制器是 workflows_controller。因此，我在 workflows.css.scss 中添加了以下代码：

```
.folder_section {
  text-align:center;
  color: #244;
} 
```

我的看法是

```
<div class="folder_section" id="folder_section">
                <%= form_for :folder_name, :remote => true, :method => "get", :url => {:action => "show"} do |f| %>
                <%= f.select :foldernames, options_for_select(@folders, @folders.first)%>
                <%= f.submit "Submit folder"%>
                <% end%>
</div> 
```

选择框与中心对齐，但我看不到任何颜色。我将相同的代码复制粘贴到视图本身中。但我仍然看不到任何颜色。请让我知道为什么选择框与中心对齐但没有着色。我查看了网络和一些 pdf 文档。每个人都说，当您将 css 代码添加到其中时，controller.css.scss 将负责样式设置。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:42:45.593

css color 属性用于设置字体颜色，您选择的颜色非常接近黑色，因此您可能看不到变化。

您是否尝试将背景颜色属性设置为`#244`？

或者尝试通过在代码中定义来改变选择字段颜色属性

```
.folder_section { 
  select {
    color: #244; 
  }
} 
```

# objective-c - Objective-C：将图像与之前保存的另一张图像进行比较

> ID：11216167
> 
> 赞同：9
> 
> 时间：2012-06-26T21:25:53.367
> 
> 标签：objective-c, ios, memory, uiimage, compare

当一个图像已经使用 NSSearchPathForDirectoriesInDomains 方法通过保存和加载过程时，我有一个关于在 Objective-C 中比较 UIImages 的问题。

我想要的目的是根据图像显示的内容在单击时将用户引导到新屏幕。

为简单起见，假设有两种可能性 - 黑色图像和绿色图像。单击黑色图像会将您带到 xib1，单击绿色图像会将您带到 xib2。

这很简单，并且一直有效，直到我实现了保存和加载系统。

为了保存，我执行以下操作：

```
paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
documentsDirectory = [paths objectAtIndex:0];
pngFilePath = [NSString stringWithFormat:@"%@/test.png",documentsDirectory];
data1 = [NSData dataWithData:UIImagePNGRepresentation([level1part1 objectAtIndex:0])];
[data1 writeToFile:pngFilePath atomically:YES]; 
```

并加载我执行以下操作：

```
paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
documentsDirectory = [paths objectAtIndex:0];
pngFilePath = [NSString stringWithFormat:@"%@/test.png",documentsDirectory];
UIImage *image = [UIImage imageWithContentsOfFile:pngFilePath];
[button1 setImage:image forState:UIControlStateNormal]; 
```

这很好，当我退出程序并重新启动它时，图像会按我希望的方式保留在屏幕上。假设现在出现在 button1 上的图像是绿色图像。

当我单击带有发件人 id 的按钮（这是 button1）后调用以下代码时：

```
if(sender.currentImage == [UIImage imageNamed:self.greenImage])
{
    VisitAlreadyCorrectScreen *screen = [[VisitAlreadyCorrectScreen alloc] initWithNibName:nil bundle:nil];
    screen.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self presentModalViewController:screen animated:YES];
} 
```

即使 currentImage 是绿色图像并且与我正在比较的绿色图像相同，我认为因为我在保存过程中将绿色图像保存到内存中，所以比较不起作用，因为它们保存在不同的地方在内存中 - 由以下 NSLog 验证：

```
Current Image: <UIImage: 0x95614c0>, and Yes Image: <UIImage: 0xde748f0> 
```

我无法弄清楚如何比较这两个图像，以便在这种情况下它们匹配（它们都与我在资源文件夹中的同一个图像相关）。有没有人有任何建议？

如果我没有很好地解释问题是什么，请告诉我！

提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-26T21:50:16.760

如果是从网上下载的，可以比较图片名称或图片网址，也比比较图片要快。

此外，问题在于通过使用 == 运算符，您正在比较图像 0x95614c0 和 0xde748f0 的内存地址。这就是为什么不相等。您正在比较它们是否是同一个对象，而不是图像是否相等。

比较图像使用：如 Fls'Zen 回答中所述。

```
if ([UIImagePNGRepresentation(blackImage) isEqualToData:UIImagePNGRepresentation(greenImage)]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T21:57:48.920

您的图像肯定有不同的地址，因为一个是从您的应用程序包中加载的，一个是从文档目录中加载的。[UIImage imageNamed:] 函数仅返回应用程序包中的图像。

如果您真的想按内容比较图像，请查看[这个](https://stackoverflow.com/questions/1684799/generate-hash-from-uiimage)SO question。在第一个答案中，为图像计算哈希值。在您的代码中，您可以比较您拥有的两个图像的哈希值。第二个答案直接比较图像，以防散列让你紧张。

我建议走不同的路线，让您的应用程序跟踪在图像本身之外加载的图像。

# sql-server-2008-r2 - 连接 SQL Server 2008 r2 时出现握手错误

> ID：11216168
> 
> 赞同：0
> 
> 时间：2012-06-26T21:25:54.700
> 
> 标签：sql-server-2008-r2

连接到本地数据库时出现此错误

> 与服务器成功建立连接，但在登录前握手期间发生错误。（提供者：SSL 提供者，错误：0 - 证书链由不受信任的机构颁发。）（.Net SqlClient 数据提供者）

帮助

# ruby-on-rails-3 - 嵌套资源创建找不到没有 ID 的主题

> ID：11216170
> 
> 赞同：0
> 
> 时间：2012-06-26T21:26:04.550
> 
> 标签：ruby-on-rails-3, routes

我想做一个应用程序，用户可以创建一个主题，然后其他人可以发帖。我将资源嵌套在我的 routes.rb 中：

```
MyPedia2::Application.routes.draw do
    resources :users

    resources :sessions, only: [:new, :create, :destroy]
    resources :topics, only: [:show, :create, :destroy] 
    resources :posts
    resources :topics do

    resources :posts, only: [:create, :show, :new]

    end 
```

在我的主题显示页面中，我想显示 topic.title 并发送 Posts 和 post.form.html.erb。当我创建帖子时，一切正常，我出错了

```
ActiveRecord::RecordNotFound in PostsController#create

Couldn't find Topic without an ID.. 
```

这是我的posts_controller.rb：

```
class PostsController < ApplicationController
    before_filter :signed_in_user, only: [:create, :destroy]
  before_filter :correct_user, only: :destroy

    def new
        @topic= Topic.find_by_id(params[:id])
        @post = @topic.posts.build(params[:post])
    end

    def show
    @topic = Topic.find(params[:id])
    @posts = @topic.posts.paginate(page: params[:page])
  end 

    def create
        @topic = Topic.find(params[:id])
        @post = @topic.posts.build(params[:post])
        @post.topic  = @topic

        if @post.save
            flash[:success] = "Konu oluşturuldu!"
            redirect_to :back
        else
            render 'static_pages/home'
        end
    end

  def destroy
    @post.destroy
    redirect_to root_path
  end
  private

    def correct_user
      @post = current_user.posts.find_by_id(params[:id])
      redirect_to root_path if @post.nil?
    end
end 
```

和_post_form.html.erb：

```
<%= form_for @new_post do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="field">
        <%= f.text_area :content, placeholder: "yorumunuzu girin..." %>
  </div>
  <%= f.submit "Gönder", class: "btn btn-large btn-primary" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:37:31.327

有一些事情应该为您解决问题。

首先，您在帖子控制器中的创建操作有点错误 - 它应该看起来像这样：

```
 def create
    @topic = Topic.find(params[:topic_id])
    @post = @topic.posts.build(params[:post])

    # This is unnecessary as you're already adding
    # the post to the topic with the build statement.
    # @post.topic  = @topic

    if @post.save
        flash[:success] = "Konu oluşturuldu!"
        redirect_to :back
    else
        render 'static_pages/home'
    end
  end 
```

此控制器操作假定您要对嵌套在主题中的发布资源使用 put 请求，因此您必须清理您的路由。

您有`posts#create`嵌套和未嵌套的路由。如果帖子总是应该嵌套在您的控制器逻辑所说明的主题中，那么您应该将其添加到未嵌套的帖子资源中：

```
resources :posts, except: [:new, :create] 
```

然后将该`form_for`标签更改为：

```
<%= form_for [@topic, @post] do |f| %> 
```

这告诉表单生成器您正在使用嵌套资源，并将使用正确的 url 进行 http 请求。

另外 - 看起来你正在使用加载所有主题`Topic.find(params[:id])`。这是行不通的——你在帖子控制器中，这是一个帖子ID。您应该像这样加载带有 id 参数的帖子：`Post.find(params[:id])`然后是这样的主题：`topic = post.topic`

# arrays - jQuery的每个函数和其中的数组

> ID：11216186
> 
> 赞同：0
> 
> 时间：2012-06-26T21:27:08.170
> 
> 标签：arrays, jquery

每个功能都有问题...将尝试通过示例进行解释...

在我的代码中，有一个 ID 为“media-type-container-1”的 DIV，其内容在运行时会“实时”更改：

```
<div id="media-type-container-1">
    <div><input type="checkbox">Media 11<span id="media-stations-id-11" class="media-stations-id">11</span></div>
    <div><input type="checkbox">Media 12<span id="media-stations-id-12" class="media-stations-id">12</span></div>
</div> 
```

如果它发生变化，可以将其更改为 ie：

```
<div id="media-type-container-1">
    <div><input type="checkbox">Media 13<span id="media-stations-id-13" class="media-stations-id">13</span></div>
    <div><input type="checkbox">Media 14<span id="media-stations-id-14" class="media-stations-id">14</span></div>
</div> 
```

要获取所有“媒体站 ID”的列表，我使用以下代码：

```
$("#add-to-filter-stations").live("click", function() {

    var selectedMediaStations = new Array();
    selectedMediaStations.length = 0;

    $('#media-type-container-1').each(function(){
        $('.media-stations-id').each(function(){
            selectedMediaStations.push($(this).attr('id').replace("media-stations-id-", ""));
        })
    });
} 
```

在上述示例中，数组 selectedMediaStations 获取元素 11、12、13 和 14，而不仅仅是 13 和 14。

我做错了什么，所以我不能每次使用实时函数都从空数组“开始”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:39:17.240

你为什么不尝试类似的东西

```
var selectedMediaStations = $('.media-stations-id').map(function(){
    return $(this).attr('id').replace('media-stations-id-','');
});

// [13, 14] 
```

# django - Django 中是否有适用于 Amazon DynamoDB 的良好数据库后端？

> ID：11216187
> 
> 赞同：23
> 
> 时间：2012-06-26T21:27:14.203
> 
> 标签：django, amazon-web-services, amazon-dynamodb

我想在我的下一个 Django 项目中使用 DynamoDB。我找到了将会话数据存储到 DynamoDB 中的方法，但是 Django 是否有后端实现来存储所有数据库数据？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-02-28T17:58:03.887

我认为没有任何 Django DynamoDB 项目可以让您在使用 DynamoDB 的同时使用 Django ORM。

但根据您的情况，您可能仍然可以简单地忽略 Django 的 ORM 部分并直接使用 DynamoDB（通过 boto 或 PynamoDB 或类似方法）。

就我而言，我使用混合。我保留了我的所有用户和其他大多数在 Postgres (RDS) 和 Django ORM 上只读的模型，但将 DynamoDB 用于需要大量写入的模型（使用 pynamodb）。

我仍然可以使用视图、模板甚至通过 Django-rest-framework 添加 API。我失去的是管理页面（我不需要这些模型）和 ORM 为您提供的其他功能，但无论如何我对结果感到满意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-05T16:02:37.490

我没有亲自使用过这个，但开发它的人经常为 boto 做出贡献，他的工作一直都是高质量的。

[https://bitbucket.org/maxnoel/dynamodb-mapper](https://bitbucket.org/maxnoel/dynamodb-mapper)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-15T13:59:05.993

这是 github 上的一个名为[django dyanmodb 会话](https://github.com/gtaylor/django-dynamodb-sessions)的项目，它看起来不完整（没有关闭会话），但很有希望。这是其中一位作者[发布的公告的链接](http://gc-taylor.com/blog/2012/02/15/django-dynamodb-sessions-ready/)。

# sql-server - GETDATE() BETWEEN BETWEEN 的等价物，其中两者都可以为 NULL

> ID：11216188
> 
> 赞同：4
> 
> 时间：2012-06-26T21:27:16.870
> 
> 标签：sql-server, sql-server-2008, tsql, sql-server-2008-r2

是

```
SELECT [Id]
      ,[DateOnline] --Nullable
      ,[DateOffline] --Nullable
      ,[PageId]
      ,[DownloadId]
      ,[Weight]
  FROM [DownloadPage]
  WHERE GETDATE() BETWEEN [DateOnline] AND [DateOffline] 
```

相当于：

```
SELECT [Id]
      ,[DateOnline] --Nullable
      ,[DateOffline] --Nullable
      ,[PageId]
      ,[DownloadId]
      ,[Weight]
  FROM [DownloadPage]
  WHERE ([DateOnline] IS NULL OR [DateOnline] <= GETDATE())
  AND ([DateOffline] IS NULL OR [DateOffline] > GETDATE()) 
```

但同时也满足 NULL 的需求？

还是有更优雅的方法？

这里哪里需要括号？

谢谢。

编辑：

**[DateOnline] 和 [DateOffline] 都是 DateTime 类型**

**如果 [DateOnline] 为 NULL，则逻辑为“现在在线”**

**如果 [DateOffline] 为 NULL，则逻辑是“永不脱机（一旦联机）”**

抱歉，我一开始就应该在我的问题中包含这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:08:15.273

即使这些列上没有索引，作者的第二个查询也会获得更好的性能。如果有索引，那就不用考虑了……使用 coalesce 将禁用索引并执行表扫描而不是索引查找（对性能非常不利）。

即使这些列上没有任何索引，“is null”也会返回一个常量......而在合并函数的情况下，仍然需要每次都评估 NULL 值。如果您有一个充满 NULL DateOnline 和 DateOffline 的表，则不能忽略此性能泄漏。

无论如何，我想不出你在这种情况下使用合并的原因。

另外，我猜测（因为您正在检查日期范围）这两个日期是全部或全部。您可能只需要检查其中一个日期。

```
 WHERE ([DateOnline] IS NULL)
 OR GETDATE() BETWEEN [DateOnline] AND [DateOffline] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T21:28:25.893

您可以使用`COALESCE`将空值转换为有意义的值。在此示例中，我选择了始终在有效范围内的默认值。

```
WHERE GETDATE() BETWEEN COALESCE([DateOnline] , '1900-01-01')
                    AND COALESCE([DateOffline], '2099-12-31') 
```

演示：[http ://www.sqlfiddle.com/#!3/def09/1](http://www.sqlfiddle.com/#!3/def09/1)

# struts2 - Struts2——来自单选按钮的 NullPointerException

> ID：11216193
> 
> 赞同：0
> 
> 时间：2012-06-26T21:27:23.210
> 
> 标签：struts2, radio-button, nullpointerexception

我在包含一些单选按钮的 Struts2 JSP 中有以下表单。页面上还有 2 个其他表单可以正常工作，但这个没有。我已经确定所选的值以某种方式没有被传递，这就是我得到 NullPointerException 的原因，但我无法弄清楚它为什么会发生。谁能帮我？这是我的 JSP 表单。

```
 <s:form action="ProcessPoll3">
                <table>
                    <tr>
                        <td><b><i>Poll #3</i></b></td>
                        <td>How many kids do you have?</td>
                        <td><s:radio name="poll3"
                            list="#{'1':'0.', '2':'1.', '3':'2.', 
                                    '4':'3.', '5':'More than 3.'}" />
                        <s:submit value="Vote Poll #3" align="left" /></td>
                    </tr>
                </table>
            </s:form> 
```

我的 DAO 类被这一行调用（肯定会被调用）： String poll3; 私有 HttpServletResponse 响应；

```
public String getPoll3() {
    return poll3;
}

public void setPoll2(String poll3) {
    this.poll3 = poll3;
}

public String execute() {
        Poll3DAO poll3DAO = new Poll3DAO();

        if (poll3DAO.tallyVote(poll3).equals("success")) {
           // Processing goes on here, not relevant to this problem
        } 
```

这是 DAO 类中的方法，标记了故障点，因为应该传递的参数为空。

```
public String tallyVote(String vote) {
    String successfulWrite;
    request = ServletActionContext.getRequest();
    SessionFactory sessionFactory = (SessionFactory) request.getSession()
            .getServletContext().getAttribute("sessionFactory");
    Session session = sessionFactory.openSession();
    try {
        // Get previous results
        Transaction tx1 = session.beginTransaction();
        Query myQuery = session.createQuery("from Poll3");
        tx1.commit();

        // Update results
        Iterator<Poll3> iterate = myQuery.iterate();
        Poll3 poll3 = iterate.next();
        // NullPointerException occurs on next line
        if (vote.equals("1")) {
            poll3.setZero(poll3.getZero() + 1);
        } else if (vote.equals("2")) {
            poll3.setOne(poll3.getOne() + 1);
        } else if (vote.equals("3")) {
            poll3.setTwo(poll3.getTwo() + 1);
        } else if (vote.equals("4")) {
            poll3.setThree(poll3.getThree() + 1);
        } else if (vote.equals("5")) {
            poll3.setMoreThanThree(poll3.getMoreThanThree() + 1);
        }

        // Write new results back to database;
        Transaction tx2 = session.beginTransaction();
        session.update(poll3);
        tx2.commit();
        successfulWrite = "success";
    } catch (Exception e) {
        System.out.println(e.toString());
        successfulWrite = "failure";
    }

    return successfulWrite;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:31:44.263

我打赌是这样的：

```
public void setPoll2(String poll3) { ... } 
```

这就是为什么我们有 map/collection 支持来避免编写像这样的剪切和粘贴 blob。

*每当您*发现自己在片段中剪切和粘贴代码时，通常是因为抽象被忽略/忽略了。

# php - 用 PHP 分解 UTF-8 文本中的长单词

> ID：11216196
> 
> 赞同：1
> 
> 时间：2012-06-26T21:27:35.760
> 
> 标签：php

可怕的标题，我知道。

我想要某种自动换行，但显然不能使用 wordwrap() 因为它弄乱了 UTF-8 .. 更不用说标记了。

我的问题是我想摆脱像“eeeeeeeeeeeeeeeeeeeeeeeeeeee”这样的东西......但当然会更长。一些开玩笑的人觉得把这些东西放在我的网站上很有趣。

所以当我有一个这样的字符串时，“你好，你好吗？我想用零宽度空格 (​) 字符分解“areeee”。

字符串并不总是相同的字母，而且字符串总是在较大的字符串中。所以 str_len、substr、wordwrap 都不完全符合描述。

谁能帮帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:29:26.127

分 3 步执行此操作

1.  对字符串和空格进行拆分
2.  对字符串中的每个单词执行 str_len/trim
3.  将字符串重新连接在一起

这样做的缺点是超过 10 个字符的单词也会被破坏。所以我建议在这里添加一些东西，看看它是否一遍又一遍地连续出现同一个字母。

**例子**

```
$string = "Hello how areeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee you doing?";
$strArr = explode(" ",$string);
foreach($strArr as $word) {
if(strlen($word) > 10) {
    $word = substr($word,0,10);
}

$wordArr[] = $word;
}

$newString = implode(" ",$wordArr);
print $newString;  // Prints "Hello how areeeeeeee you doing?" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:33:25.617

说这**不是**PHP 解决方案，如果您的问题是脚本的视图，为什么不使用简单的 CSS3 规则，称为[word-wrap](http://www.w3.org/TR/2011/WD-css3-text-20110215/#word-wrap)？

让你的容器是一个`div`with `id="example"`，你可以这样写：

```
#example
{
  word-wrap: break-word;
} 
```

# mysql - 不一致数据的数据库结构

> ID：11216203
> 
> 赞同：2
> 
> 时间：2012-06-26T21:27:59.373
> 
> 标签：mysql

我正在为我的公司创建一个数据库，该数据库将存储许多不同类型的信息。类别是亮度，对比度，色度等。每个类别都有一些我的公司想要开始存储的数据点。

通常，我会为每个类别创建一个表来存储相应的数据。（这就是我学会这样做的方式）。但是，有时这些类别有“子数据”，这会改变每个表中所需字段的数量。

那么我的问题是，人们在构建数据库时如何处理数据的不一致？他们只是继续为额外的数据添加更多表格，还是完全不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:55:34.270

关于关系数据库模型有一些（谢天谢地**只有**少数）不可更改的规则。其中之一是，如果您不知道要存储**什么**，则很难存储它。很有可能，您将更难检索它。

也就是说，业务规则的现实往往不如数据库设计的象牙塔那么清晰。最重要的是，您可能想要甚至需要一种在不更改架构的情况下引入新属性的方法。

这里有两种可行的方法：

1.  使用专门用于松散或不存在模式（NoSQL 和朋友）的数据存储。详细解释这一点是 CS 论文的主题，而不是 stackoverflow 的答案。
2.  我的建议：使用单独的属性表 - 这是怎么回事：

假设为了论证，您的产品**总是**有 (unique string) `name`, (integer) `id`, `brightness`, `contrast`,**有时**`chromaticity`加上(integer)和 (string) ，考虑这些表**`foo``bar`**

 **```
CREATE TABLE products (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  brightness INT,
  contrast INT,
  chromaticity INT,
  UNIQUE INDEX(name)
);

CREATE TABLE properties (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  proptype ENUM('null','int','string') NOT NULL default 'null',
  UNIQUE INDEX(name)
);

INSERT INTO properties VALUES
  (0,'foo','int'),
  (0,'bar','string');

CREATE TABLE product_properties (
  id INT PRIMARY KEY AUTO_INCREMENT,
  products_id INT NOT NULL,
  properties_id INT NOT NULL,
  intvalue INT NOT NULL,
  stringvalue VARCHAR(250) NOT NULL,
  UNIQUE INDEX(products_id,properties_id)
); 
```

现在您的“标准”属性将`products`像往常一样在表中，而“可选”属性将存储在`product_properties`引用产品 id 和属性 id 的行中，值在`intvalue`or中`stringvalue`。

选择产品，包括他们的产品`foo`（如果有的话）

```
SELECT 
  products.*,
  product_properties.intvalue AS foo
FROM products
  LEFT JOIN product_properties 
    ON products.id=product_properties.product_id 
    AND product_properties.property_id=1 
```

甚至

```
SELECT 
  products.*,
  product_properties.intvalue AS foo
FROM products
  LEFT JOIN product_properties 
    ON products.id=product_properties.product_id 
  LEFT JOIN properties 
    ON product_properties.property_id=properties.id
WHERE properties.name='foo' OR properties.name IS NULL 
```

请理解，这会导致性能损失 - 事实上，您会在性能与灵活性之间进行交易：添加另一个属性只不过是在`INSERT`ing 中插入一行`properties`，架构保持不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:01:46.047

如果您不是 mysql 绑定，那么其他数据库具有[表继承](http://www.postgresql.org/docs/9.1/static/ddl-inherit.html)或[数组](http://www.postgresql.org/docs/9.1/static/arrays.html)来解决某些特定情况。[Postgresql](http://www.postgresql.org/)是一个非常好的数据库，您可以像使用 mysql 一样轻松自由地使用它。

使用 mysql，您可以：

1.  更改您的表，添加额外的列并在您不需要的子类别数据中允许 NULL。这种方式可以检查完整性，因为您仍然可以对列施加约束。除非您确实以这种方式拥有*很多*子类别列，否则我建议您这样做，否则选择 3。

2.  将子类别数据动态存储在单独的表中，该表具有 category_id、category_row_id、subcategory 标识符（=子类别的类型）和值列：这样您就可以通过 category_id（确定表）和 category_row_id（链接到原始类别表行的PK）。坏事：你不能正确使用外键或约束来强制完整性，你需要编写毛茸茸的插入/更新触发器来仍然有一些控制，这将把完整性检查和引用检查的负担单独推到客户端上. （在这种情况下，您最好选择 NoSQL 路线）简而言之，我不推荐这样做。

3.  您可以为每个类别表创建一个单独的子类别表，列可以通过值列 + 可选子类别标识符固定或可变，仍然可以使用外键，最好保持完整性是固定的，因为您将拥有完整的范围您可以使用的限制条件。如果您有*很多*子类别列，否则可能会弄乱您的常规子类别表，那么我建议将其与固定列一起使用。像之前的选项一样，我绝不建议对一次性数据以外的任何内容进行动态处理。

或者，如果您的子类别非常多变且易变：将[NoSQL](http://en.wikipedia.org/wiki/NoSQL)与文档数据库（如[mongodb](http://www.mongodb.org/) ）一起使用，请注意，您可以将所有常规数据保存在适当的 RDBMS 中，并且只在文档数据库中存储侧数据，尽管这可能不推荐。

如果您的子类别数据处于已知的固定状态并且不易更改，我只需将额外的列添加到特定的类别表中。请记住，适当的 DBMS 的主要功能是通过检查和约束来保护数据的完整性，取消它从来都不是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T21:56:48.443

如果您不限于 MySQL，您可以考虑使用 Microsoft SQL 服务器并使用[稀疏列](http://msdn.microsoft.com/en-us/library/cc280604.aspx) 这将允许您扩展架构以包含所需的任意数量的列，而不会对与给定行不相关的列产生存储损失。**

# php - Symfony + PHP 不工作

> ID：11216208
> 
> 赞同：0
> 
> 时间：2012-06-26T21:28:22.063
> 
> 标签：php, symfony

我正在尝试使用 Symfony 2.0 创建一个网站，但我遇到了`extend("...") ?>`从`<?php $this->extend("...") ?>`.

该网站可在[http://symfony.toxic-productions.com/install/web/poshpaws/hello](http://symfony.toxic-productions.com/install/web/poshpaws/hello)查看。

控制器的代码：

```
<?php
    namespace Acme\HelloBundle\Controller;

    use Symfony\Bundle\FrameworkBundle\Controller\Controller;

    class HelloController extends Controller
    {
        public function indexAction($name)
        {
            //return $this->render('AcmeHelloBundle:Hello:index.html.twig', array('name' => $name));
            // render a PHP template instead
            return $this->render('AcmeHelloBundle:Hello:index.html.php', array('name' => $name));
        }
    }
?> 
```

前端页面的代码 (index.html.php)

```
<html>
    <head>
        <title>Poshpaws</title>
        <?php
            $view->extend('::base.html.php');
            echo($head);
        ?>
    </head>
    <body>
        <?php echo($body); ?>
        <h1>This is just a page to say: Hello <?php echo $view->escape($name) ?>!</h1>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-07T17:02:47.250

我只是有同样的问题。原来我的配置文件中没有启用 php 模板引擎。确保从该站点检查第一步： http: [//symfony.com/doc/current/cookbook/templating/PHP.html](http://symfony.com/doc/current/cookbook/templating/PHP.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T00:39:01.297

您的 .htaccess 文件要么不工作，要么不在正确的位置。确保它位于 web 文件夹中。如果是，请确保您的虚拟主机允许您覆盖 Apache 设置。如果是这样，则通过 SSH 运行 php app/console router:debug 并确保您的路由已正确定义。此外，您确实应该将“web”设置为目录的根目录，否则您会不必要地暴露某些安全风险。

附带说明...为什么是 PHP 模板？对我来说，它并没有强制分离关注点，而且它们通常更难阅读（无论如何对我来说）。

# c# - 为什么我的列表不会在 DataGridView 中显示

> ID：11216212
> 
> 赞同：0
> 
> 时间：2012-06-26T21:28:29.780
> 
> 标签：c#, winforms, datagridview

我不明白为什么我的列表不会出现在 DataGridView 中。如果我删除 dataGridView1.DataSource =actors.ToList(); 的评论 它运行......但是当我按下button_click时我需要它运行。有什么问题？

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        LoadData();
    }

    public void LoadData()
    {
        List<Actor> actors = new List<Actor>
    {
        new Actor(){ PersonId = 1, ForNavn = "xxxx", EtterNavn = "bbbbb", Adresse = "Hhhhhh", PostNr = 37325, PostSted = "aaaa" },
        new Actor(){ PersonId = 2, ForNavn = "ggggg", EtterNavn = "ddddd", Adresse = "Dssssss", PostNr = 37464, PostSted = "ssfff"  },
    };
        //dataGridView1.DataSource = actors.ToList();
    }

    private void btnSok_Click(object sender, EventArgs e)
    {
        List<Actor> actors = new List<Actor>();

        var query = from actor in actors
                    select actor;

        dataGridView1.DataSource = query.ToList();

    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:38:58.397

```
public partial class Form1 : Form
{
    private List<Actor> _actors;
    public Form1()
    {
        InitializeComponent();
        LoadData();
    }

    public void LoadData()
    {
        _actors = new List<Actor>
    {
        new Actor(){ PersonId = 1, ForNavn = "xxxx", EtterNavn = "bbbbb", Adresse = "Hhhhhh", PostNr = 37325, PostSted = "aaaa" },
        new Actor(){ PersonId = 2, ForNavn = "ggggg", EtterNavn = "ddddd", Adresse = "Dssssss", PostNr = 37464, PostSted = "ssfff"  },
    };
    }

    private void btnSok_Click(object sender, EventArgs e)
    {

        var query = from actor in _actors
                    select actor;

        dataGridView1.DataSource = query.ToList();

    }
} 
```

btnsOK 中的演员再次声明，未加载，因此有点空白。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:34:00.510

因为您的演员列表在按钮单击事件中为空

改用这个：

```
 List<Actor> actors = new List<Actor>
    {
        new Actor(){ PersonId = 1, ForNavn = "xxxx", EtterNavn = "bbbbb", Adresse = "Hhhhhh", PostNr = 37325, PostSted = "aaaa" },
        new Actor(){ PersonId = 2, ForNavn = "ggggg", EtterNavn = "ddddd", Adresse = "Dssssss", PostNr = 37464, PostSted = "ssfff"  },
    }; 
```

# ios - 如何检查 UIView 是否仍然存在？

> ID：11216215
> 
> 赞同：0
> 
> 时间：2012-06-26T21:28:54.907
> 
> 标签：ios, uiview, reference, subview, superview

我必须根据设备方向为 UIView 设置一些自定义大小参数。我加载**没有自己的视图控制器**的 UIView，如下所示：

在 main.h

```
@property (nonatomic, retain) IBOutlet UIView *socialActionView; 
```

在 main.m

```
@synthesize socialActionView; 
```

. . .

```
socialActionView = [[[NSBundle mainBundle] loadNibNamed:@"SocialActionViewController" owner:self options:nil] objectAtIndex:0];
[self.view addSubview:socialActionView]; 
```

如果不再需要，我将其从超级视图中删除

```
[self.socialActionView removeFromSuperview];
NSLog(@"%@",self.socialActionView.superview); 
```

删除后日志显示 (null)

我喜欢这样的尺寸调整

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation 
{
    if ((self.interfaceOrientation == UIDeviceOrientationPortrait) || (self.interfaceOrientation == UIDeviceOrientationPortraitUpsideDown)){
        if (self.socialActionView != NULL) {
            [self.socialActionView setBounds:CGRectMake(0, 0, 320, 480)];
            [self.socialActionView setCenter:CGPointMake(160, 240)];
            [self.scroll1 setContentSize:CGSizeMake(320, 600)];
            [self.scroll1 setBounds:CGRectMake(0, 0, 320, 428)];
            [self.scroll1 setCenter:CGPointMake(160, 266)];
        }
    } else if((self.interfaceOrientation == UIDeviceOrientationLandscapeLeft) || (self.interfaceOrientation == UIDeviceOrientationLandscapeRight)){
        if (self.socialActionView != NULL) {
            [self.socialActionView setBounds:CGRectMake(0, 0, 480, 320)];
            [self.socialActionView setCenter:CGPointMake(240, 160)];
            [self.scroll1 setContentSize:CGSizeMake(480, 600)];
            [self.scroll1 setBounds:CGRectMake(0, 0, 480, 268)];
            [self.scroll1 setCenter:CGPointMake(240, 186)];
        }
    }
} 
```

到目前为止工作正常，直到我不从我的主视图中删除子视图（socialAcitonView）。导致之后 self.socialActionView 不再可访问。我在stackoverflow上看到了很多例子，比如

```
-(IBAction)showPopup:(id)sender {
    if(![[self myView] isDescendantOfView:[self view]]) { 
        [self.view addSubview:[self myView]];
    } else {
        [[self myView] removeFromSuperview];
} 
```

或者

```
-(IBAction)showPopup:(id)sender
{
    if (!myView.superview)
        [self.view addSubview:myView];
    else
        [myView removeFromSuperview];
} 
```

或者

```
if (!([rootView subviews] containsObject:[self popoverView])) { 
    [rootView addSubview:[self popoverView]];
} else {
    [[self popoverView] removeFromSuperview];

} 
```

或者

```
-(IBAction)showPopup:(id)sender {
    if([[self myView] superview] == self.view) { 
        [[self myView] removeFromSuperview];           
    } else {
        [self.view addSubview:[self myView]];         
    }
} 
```

但它们都不起作用。调试器总是抛出异常导致错误访问。什么（从我的角度来看）意味着该对象不再存在。但是在我从超级视图中删除它并说（null）之后，记录器如何访问它？

我知道最好给视图一个专用的视图控制器并将 didRotateFromInterfaceOrientation 放在那里，这样我就不必检查 socialActionView 是否在那里。无论如何，我想问一下是否有办法检查 UIView 是否为（null）。在我将所有代码更改为视图/视图控制器对之前。

任何提示表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:24:02.557

您正在使其成为保留属性，然后在执行此操作时绕过保留属性：

```
socialActionView = [[[NSBundle mainBundle] loadNibNamed:@"SocialActionViewController" owner:self options:nil] objectAtIndex:0]; 
```

如果您使`self.socialActionView = ...`您的属性即使在从子视图数组中删除视图之后也应该保持其引用。

（事实上​​，我建议将您的 synthesize 语句更改为`@synthesize socialActionView = _socialActionView;`并将 a 放在`self.socialActionView`编译器抱怨该符号的任何位置。）

# .net - .NET WebClient 400 错误

> ID：11216216
> 
> 赞同：1
> 
> 时间：2012-06-26T21:28:56.297
> 
> 标签：.net, http, protocols, webclient, http-status-code-400

我正在使用 WebClient 类对 Elastic Search 的 JSON 字符串执行 HTTP“PUT”。此代码在 95% 的情况下有效，但在其余情况下失败。我得到的错误是我的代码中的 400 bad protocol。当我使用 jQuery AJAX 或名为 Postman 的 Chrome 扩展程序发布相同的 JSON 时，它可以完美运行。我不确定如何解决此错误。我的代码如下 -

```
string json = "{some json}";
WebClient client = new WebClient();
client.Headers["Content-Type"] = "application/json;charset=UTF-8";    

try
{
     json = client.UploadString(URL, "PUT", json);
}
catch (WebException ex)
{
     //catch exception
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T14:10:55.217

Elastic Search expects some headers which WebClient does not pass. I used HttpWebRequest class and it worked fine without any errors since.

# iphone - scheduleLocalNotification 不适用于越狱应用程序？

> ID：11216225
> 
> 赞同：3
> 
> 时间：2012-06-26T21:29:27.747
> 
> 标签：iphone, objective-c, xcode, jailbreak, uilocalnotification

我有一个调用的应用程序，但是当我将它安装到**/Applications**而不是**/var/mobile/Applications**`scheduleLocalNotification`时它不起作用：

 ****```
- (void) doNotify
{
    // this doesn't work when app is in /Applications but does in /var/mobile/Applications
    UILocalNotification * theNotification = [[UILocalNotification alloc] init];
    theNotification.alertBody = @"Finished processing.";
    theNotification.alertAction = @"Ok";
    theNotification.fireDate = [NSDate dateWithTimeIntervalSinceNow:1];
    [[UIApplication sharedApplication] scheduleLocalNotification:theNotification];
    NSLog(@"notification scheduled: %@", theNotification);
} 
```

我尝试`presentLocalNotification`了以防万一这是时间问题。

我`didReceiveLocalNotification`在应用程序委托中实现以查看是否被调用，但不是，它仅在应用程序处于前台时才被调用，就像它应该那样。

如果我将应用程序放回**/var/mobile/Applications**，它应该可以正常工作。我在 iPhone 4S 和 iPod Touch 4g 上使用 Xcode 4.2.1 并运行 iOS 5.1.1

**编辑**：应用程序可以在后台运行，因为它是一个音乐应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-07T04:35:12.000

# 注册通知

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    if ([UIApplication instancesRespondToSelector:@selector(registerUserNotificationSettings:)]){

    [application registerUserNotificationSettings:[UIUserNotificationSettings
                                                   settingsForTypes:UIUserNotificationTypeAlert|  UIUserNotificationTypeSound | UIUserNotificationTypeBadge categories:nil]];
    }
    [launchOptions valueForKey:UIApplicationLaunchOptionsLocalNotificationKey];
} 
```

## 日程通知

```
- (void)applicationDidEnterBackground:(UIApplication *)application
 {
  // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
// If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.

    NSLog(@"startLocalNotification");
    UILocalNotification *notification = [[UILocalNotification alloc] init];
    notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:2];
    notification.alertBody = @"notification Message ";

    notification.timeZone = [NSTimeZone defaultTimeZone];
    notification.soundName = UILocalNotificationDefaultSoundName;
    //notification.applicationIconBadgeNumber = 10;

    [[UIApplication sharedApplication] scheduleLocalNotification:notification];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T03:05:43.743

我刚才遇到了同样的问题。而且我已经通过官方文档解决了这个问题。

实际上，您应该注册通知以访问使用通知：

```
UIUserNotificationSettings *settings = [UIUserNotificationSettings settingsForTypes: UIUserNotificationTypeAlert | UIUserNotificationTypeBadge categories:nil];
[[UIApplication shareApplication] registerUserNotificationSettings: settings]; 
```****

# php - 将csv文件导入mysql

> ID：11216229
> 
> 赞同：4
> 
> 时间：2012-06-26T21:29:37.990
> 
> 标签：php, mysql, csv

我将 MySQL 与 php 一起使用。通过 php 脚本，我尝试使用以下查询导入 csv 文件

```
 LOAD DATA LOCAL INFILE '$file'
    INTO TABLE userstable
    FIELDS TERMINATED BY ','
    LINES TERMINATED BY '\n' IGNORE 1 LINES (name, univ, mobile); 
```

我成功地将文件导入到数据库表中，但我能够在最后一列（即移动设备）下的所有单元格中看到隐藏的格式符号（如 word、powerpoint 等）。

如何避免那些插入表中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:42:15.980

可能是 DOS 行结尾。试试看

```
 LINES TERMINATED BY '\r\n' 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:35:57.990

我认为您将不得不在保存数据之前使用正则表达式来过滤数据。如果我没记错的话，大多数格式都是标准化的，因此在将其添加到您的 dB 之前应该很容易找到并消除它。- 李

# c# - 如何使用 HttpWebRequest 访问帧

> ID：11216230
> 
> 赞同：1
> 
> 时间：2012-06-26T21:29:50.860
> 
> 标签：c#, .net, httpwebrequest

我正在尝试访问使用框架的网站上的信息。当我尝试访问该站点时，我得到了网站源代码，但我也得到了`This page uses frames, but your browser doesn't support them.`我认为我需要打开这个页面才能访问框架。所以我所做的是创建一个新对象来向带有框架的页面发出请求。但是，这会返回一个重定向到错误的页面。

我的问题是是否可以使用 HttpWebRequest 获取框架信息，并且是否有在线教程或示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:36:21.957

是的，有可能。您需要匹配浏览器发出的请求以检索这些帧（可能是伪造的引荐来源网址和其他标头）。

使用诸如[Fiddler](http://www.fiddler2.com/fiddler2/)之类的 HTTP 调试器来查看您的代码生成的请求，并将您的请求与浏览器的请求进行比较。

# jakarta-ee - 应用服务器和http服务器有什么区别？

> ID：11216238
> 
> 赞同：-1
> 
> 时间：2012-06-26T21:30:02.417
> 
> 标签：jakarta-ee, tomcat, geronimo

我们可以将“容器”添加到“http 服务器”。那么，应用服务器和 http server & servlet 容器有什么区别呢？

Geronimo、GlassFish、JBoss 是一个 AS。什么是雄猫？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:34:25.277

Tomcat 是一个 servlet 容器 - 一个理解 servlet 和 JSP 并通过 HTTP 协议为它们提供服务的服务器。由于 servlet 是 Java EE 的一部分，因此应用服务器需要包含 servlet 容器。但他们也了解 EJB，提供 JMS 等。

HTTP 服务器（如 Apache Web 服务器）是不同的。它基本上提供静态内容，可以理解 PHP、CGI，可以连接到提供负载平衡的 Tomcat 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T06:42:25.967

## 营销BS：

### 网络服务器：

> Apache HTTP 服务器项目致力于为包括 UNIX 和 Windows NT 在内的现代操作系统开发和维护开源 HTTP 服务器。该项目的目标是提供一个安全、高效和可扩展的服务器，提供与当前 HTTP 标准同步的 HTTP 服务。[http://httpd.apache.org/](http://httpd.apache.org/)

### servlet 容器：

> Apache Tomcat 是 Java Servlet 和 JavaServer Pages 技术的开源软件实现。[http://tomcat.apache.org/](http://tomcat.apache.org/)

### 应用服务器：

> GlassFish 是一个 Java EE 开源应用服务器。GlassFish 3 提供了 Java EE 6 的占用空间小、功能齐全的实现。[http://glassfish.java.net/public/users.html](http://glassfish.java.net/public/users.html)

## 把它们加起来：

### 网络服务器

通过某些扩展（php、perl、cgi 等）提供静态网页或动态网页

### servlet 容器

通过 java 标准机制提供静态网页或动态网页

### 应用服务器：

把它想象成一个 servlet 容器 :) 它把所有事情都当作 servlet 容器，并添加了许多基于标准和专有的特性。（比如 JMS、EEB、JMX、JMQ 甚至还有厨房水槽）

## 你需要哪一个？

如果您想做一些 java 编码，请忘记网络服务器。如果您想开发企业级应用程序，请忘记 servlet-container。（这一点值得商榷，尤其是企业级的含义。）看看当前的应用服务器，比较它们的特性。如果您在项目中发现一个不错的功能，请尝试一下。否则坚持使用 servlet 容器，无论如何，它们的占用空间往往更小。

# objective-c - AFNetworking POST 请求向服务器发送空白参数

> ID：11216243
> 
> 赞同：1
> 
> 时间：2012-06-26T21:30:36.397
> 
> 标签：objective-c, ios, post, afnetworking

我正在尝试使用 AFNetworking 向服务器发送 POST 请求，并且一切似乎都在工作，即应用程序正在成功地 ping 服务器。但是，它发送的参数值在到达服务器时是空白的，即使在使用调试器单步执行下面的代码后，这些值似乎已成功传递。对此的任何帮助将不胜感激。

**APIClient.m**

```
#import "APIClient.h"
#import "AFJSONRequestOperation.h"

// Removed URL for privacy purposes.
static NSString * const kAPIBaseURLString = @"string goes here";

@implementation APIClient

+ (APIClient *)sharedClient {
    static APIClient *_sharedClient;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedClient = [[APIClient alloc] initWithBaseURL:[NSURL URLWithString:kAPIBaseURLString]];
    });

    return _sharedClient;
}

- (id)initWithBaseURL:(NSURL *)url {
    self = [super initWithBaseURL:url];
    if (self) {
        [self registerHTTPOperationClass:[AFJSONRequestOperation class]];

        // Accept HTTP Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1
        [self setDefaultHeader:@"Accept" value:@"application/json"];
    }

    return self;
}

@end 
```

**LoginBrain.m 中的登录方法**

```
- (void)loginUsingEmail:(NSString *)email andPassword:(NSString *)password withBlock:(void (^)(NSDictionary *loginResults))block {
    self.email = email;
    self.password = password;

    // Removed path for privacy purposes
    [[APIClient sharedClient] postPath:@"insert path here" parameters:[NSDictionary dictionaryWithObjectsAndKeys:email, @"uname", password, @"pw", nil] success:^(AFHTTPRequestOperation *operation, id responseJSON) {
        if (block) {
            block(responseJSON);
        }
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"Error: %@", error);

        if (block) {
            block(nil);
        }
    }];

    // Store user data in app?
} 
```

**LoginViewController.m 中的登录调用方法**

```
- (IBAction)loginPressed {
    [self.loginProgressIndicator startAnimating];
    NSString *email = self.emailTextField.text;
    NSString *password = self.passwordTextField.text;

    [self.brain loginUsingEmail:email andPassword:password withBlock:^(NSDictionary *loginResults) {
        [self.loginProgressIndicator stopAnimating];
        [self.delegate uloopLoginViewController:self didLoginUserWithEmail:email andPassword:password];
    }];
} 
```

**更新**

[我尝试按照此处](https://github.com/AFNetworking/AFNetworking/issues/94)`parameterEncoding`的建议更改，但没有解决问题。

**第二次更新**

这是访问 POST 数据的服务器端的 PHP 代码。这是由我的一位同事编写的，因为我在服务器端不做任何事情，并且非常不熟悉它的工作原理。

```
header('Content-type: application/json');
$username = $_POST['uname'];
$pw = $_POST['pw']; 
```

服务器代码非常简单。他有某种日志脚本来检查变量值是什么，他说客户端正在访问服务器，但变量值是空白的。

**第三次更新**

这是通过生成变量`print_r`的HTTP 请求的转储：`$_REQUEST`

```
Array ( [sid] => FwAqvZrfckw ) 
```

这是`$_POST`变量的转储。如您所见，它完全是空白的：

```
Array ( ) 
```

**第四次更新**

在将数据包发送到服务器之前，我使用[Wireshark](http://www.wireshark.org/)捕获了数据包，一切似乎都井然有序：

```
Accept: application/json
Content-Type: application/x-www-form-urlencoded; charset=utf-8 
```

`POST`参数也都在那里。我们还在服务器端创建了一个测试文件，并且只是做了一个测试`POST`以确保那里的代码可以正常工作，而且确实如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T13:51:47.713

谢谢你。

遇到同样的问题，我需要使用 AFFormURLParameterEncoding。

因此，为了简化所有线程，您必须使用： `[[APIClient sharedClient] setParameterEncoding:AFFormURLParameterEncoding];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T00:39:27.433

我没有看到任何特别会在这里引起问题的东西，但我将首先为您提供我用来解决类似问题的步骤。

首先，检查工具 Charles，它是一个调试 Web 代理，它将拦截来自服务器的响应，并且应该让您更清楚地了解发生了什么问题。有 30 天的免费试用期，它确实帮助我找出了小错误。要使用它，请按顺序按钮并通过您的服务器 url 过滤结果。从那里您可以看到从服务器发送和接收的请求和响应。如果以下内容不能解决您的问题，请发布 Charles 吐出的请求和响应。

明智地修复，尝试`[[APIClient sharedClient] setParameterEncoding:AFJSONParameterEncoding]`在发送 POST 请求之前添加。看起来你们都在使用 JSON 作为服务器端格式。

所以在 loginUsingEmail 中：

```
self.email = email;
self.password = password;

[[APIClient sharedClient] setParameterEncoding:AFJSONParameterEncoding];

[[APIClient sharedClient] postPath:@"insert path here" parameters:[NSDictionary dictionaryWithObjectsAndKeys:email, @"uname", password, @"pw", nil] success:^(AFHTTPRequestOperation *operation, id responseJSON) {
    if (block) {
        block(responseJSON);
    }
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Error: %@", error);

    if (block) {
        block(nil);
    }
}];

// Store user data in app?
} 
```

# objective-c - 如何调用多个用户变量 - iPhone 应用程序

> ID：11216246
> 
> 赞同：0
> 
> 时间：2012-06-26T21:30:51.577
> 
> 标签：objective-c, ios, cocoa-touch

首先，我是 iPhone 应用程序开发的菜鸟，如果我没有马上得到它，请原谅我。

我有一个简单的问题，关于如何在句式文本中调用多个变量，变量之间有其他单词。

我正在自学 iPhone 应用程序开发，因此我将这段代码基于 Apple 题为“你的第一个 iOS 应用程序”的说明，并调整代码以更好地学习它。

该应用程序的基本布局是两个标记为“姓名”和“职业”的文本字段。下面是一个文本区域（标签）和一个用于提交文本字段信息的按钮。一旦用户输入并提交了他们的姓名和职业，应用程序应该将这些变量放入句子中：“你好，我的名字是 [Name]，我是 [Occupation]。” 并在文本区域（标签）中显示句子。

这是我到目前为止所拥有的：

```
- (IBAction)changeGreeting:(id)sender {

self.userName = self.textField.text;

NSString *nameString = self.userName;
if ([nameString length] == 0) {
    nameString = @"Name";
}
    NSString *greeting = [[NSString alloc] initWithFormat:@"Hello, my name is %@,", nameString];
self.label.text = greeting;

self.userOccupation = self.textField.text;

NSString *occupationString = self.userOccupation;
if ([occupationString length] == 0) {
    occupationString = @"Occupation";
}
NSString *description = [[NSString alloc] initWithFormat:@" and I'm a %@.", occupationString];
self.label.text = description;
}

- (BOOL)textFieldShouldReturn:(UITextField *)theTextField {
if (theTextField == self.textField) {
    [theTextField resignFirstResponder];
}
return YES;
}
@end 
```

运行应用程序并提交姓名“John”和职业“开发者”时，输出句子不包含“你好，我叫 John”输出，只有“and I'm a developer”。

如何获取和调用变量，以使每个变量都显示在句子中所需的位置，使其显示为“您好，我的名字是 John，我是开发人员”。在一个中断的句子中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:38:42.497

您使用相同的文本字段来获取姓名和职业？这很奇怪。

无论如何，由于您也使用相同的标签来显示句子，因此您将“你好，我的名字是约翰”替换为“我是一名开发人员”。用这行：

```
NSString *description = [[NSString alloc] initWithFormat:@" and I'm a %@.", occupationString];
self.label.text = description; 
```

替换最后一行“self.label.text = description;” 使用 atbebtg 建议的行，您应该得到所需的结果。

```
self.label.text = [NSString stringWithFormat:@"%@ %@",greeting, description]; 
```

顺便说一句，如果您不使用 ARC，请记住释放使用 alloc 创建的所有变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:37:18.583

您用描述覆盖了 self.label.text 的值，这就是为什么您只看到正在显示的描述值。

替换这一行

```
self.label.text = description; 
```

和

```
self.label.text = [NSString stringWithFormat:@"%@ %@",greeting, description]; 
```

我的语法可能有点不对劲。

# ios - 扫描特定服务 CBUUID 时找不到外围设备

> ID：11216248
> 
> 赞同：3
> 
> 时间：2012-06-26T21:30:56.450
> 
> 标签：ios, core-bluetooth

当我使用：

```
CBUUID * uuid = [CBUUID UUIDWithString:@"1800"]; // GAP
DEBUG_LOG(@"CBUUID: %@",uuid); // CBUUID: Generic Access Profile
_centralMan = [[CBCentralManager alloc] initWithDelegate:self queue:nil];
[_centralMan scanForPeripheralsWithServices:[NSArray arrayWithObject:uuid]
                                    options:nil]; 
```

我找不到我的外围设备，但是当我使用时：

```
_centralMan = [[CBCentralManager alloc] initWithDelegate:self queue:nil];
[_centralMan scanForPeripheralsWithServices:nil
                                    options:nil]; 
```

......它立即出现。

当我连接时，我能够发现/读取/写入我期望的所有服务。我的理解是 GAP 使这成为可能。我也尝试过`CBUUID`我知道正在运行的其他服务（特别是“1804”，TX 电源服务），但无济于事；扫描永远不会发现任何东西。

即使服务正在运行（我可以在连接时与它们通信），当我扫描传递服务 UUID 数组时`nil`，这个委托方法被调用......

```
-(void) centralManager:(CBCentralManager *)central 
 didDiscoverPeripheral:(CBPeripheral *)peripheral 
     advertisementData:(NSDictionary *)advertisementData 
                  RSSI:(NSNumber *)RSSI {
    DEBUG_LOG(@"Found peripheral w/ UUID: %@ RSSI: %@ \n AdvData: %@",peripheral.UUID,RSSI,advertisementData);
    DEBUG_LOG(@"Services found: %d",peripheral.services.count);
    for (CBService * service in peripheral.services) {
        DEBUG_LOG(@"Found service: %@ w/ UUID %@",service, service.UUID);
    }
} 
```

…它总是报告“找到的服务：0”。我是否应该期望`services`在扫描期间找到的服务填充阵列？（我认为这至少是部分可能的，基于`scanForPeripheralsWithServices:[NSArray arrayWithObject:uuid] options:nil`。）

这可能是我的外围设备服务广告的问题吗？我是否错误地使用了 API？非常感谢任何指导！:-)

PS：我很绿色 w/蓝牙。

PPS：我控制外围设备的源（它是 CC2540DK）。所以我很可能相信问题就在这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:42:01.017

[事实证明，我们的外围代码并没有像这个蓝牙规范](http://www.bluetooth.org/Technical/AssignedNumbers/generic_access_profile.htm)那样宣传 UUID 。

一旦我们将它们放入广告包中，iOS 就毫不费力地捡起它们。

# regex - htaccess：如果不匹配则重定向

> ID：11216251
> 
> 赞同：3
> 
> 时间：2012-06-26T21:31:08.663
> 
> 标签：regex, .htaccess

我想将站点 X (http://example.com) 上的所有内容转发到站点 Y (http://destinationwebsite.com)，但“PAGEX.aspx”除外

```
(http://example.com/PAGEX.aspx?callback=7259%2F7062434327_9fbc6da0cd) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:39:35.957

这应该有效：

```
 RewriteCond %{REQUEST_URI} !^/?PAGEX.aspx$
 RewriteRule .* http://destinationwebsite.com [R=301,L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T21:33:29.210

如果您`!`在 RewriteRule 中添加到您的正则表达式，它将作为否定。

# excel - 逻辑解析 excel 中的字符串以修剪附近的重复项

> ID：11216254
> 
> 赞同：3
> 
> 时间：2012-06-26T21:31:23.150
> 
> 标签：excel, vba, csv, duplicates, formula

假设字符串：

```
item1, item1N, item1Z, item1fhg, item1_any_letters, item2, item3, item3N, item3H 
```

我的目标输出很简单

```
item1, item2, item3 
```

这是目前大约 100,000 行的 Excel 文件，但如果需要临时可以迁移到另一个程序等。

本质上，我需要确定重复项（任何以数字结尾的初始短语），而不考虑数字后面的字母。一些短语可能也有例如“Brand item2, Brand item34”，重复的唯一决定因素是数字之后的任何和所有术语。

关于从哪里开始的任何想法？每个字符串通常包含 2 到 500 个值，以逗号和空格分隔。最终值后面没有逗号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T00:01:03.600

```
Sub Tester()

    Dim re As Object, match As Object
    Dim dict As Object
    Dim arr, arrItems, x As Long, y As Long
    Dim val, matches, valMatch

    Set dict = CreateObject("scripting.dictionary")
    Set re = CreateObject("VBScript.RegExp")
    re.Pattern = "([\w ]+\d+)"
    re.ignorecase = True
    re.Global = True

    arr = ActiveSheet.Range("A1:A100").Value

    For x = LBound(arr, 1) To UBound(arr, 1)
        arrItems = Split(arr(x, 1), ",")
        dict.RemoveAll
        For y = LBound(arrItems) To UBound(arrItems)

            val = Trim(arrItems(y))

            If re.Test(val) Then
               Set matches = re.Execute(val)
               valMatch = matches(0).Value
               If Not dict.exists(valMatch) Then dict.Add valMatch, 1
            End If
        Next y

        Debug.Print arr(x, 1)
        Debug.Print Join(dict.keys, ",") 'where do you want this?

    Next x

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T00:20:19.670

一种 VBA 方法，类似于 Tim 的第一个途径

1.  使用 a`RegExp`删除无效字符（数字后和逗号前的字符）
2.  消除重复
    a) 使用 a `Dictionary`
    b) Excel 的内置删除重复功能（写入工作表）

    ```
    Const strDelim = ", "

    Sub TestMe()
    Dim strTest As String
    Dim x
    strTest = "item1, item1N, item1Z, item1fhg, item1_any_letters, item2, item3, item3N, item3H"
    x = Split(DeDupe(strTest), strDelim)
    'fix last element
    x(UBound(x)) = Left$(x(UBound(x)), Len(x(UBound(x))) - 1)
    Call Method2(x)
    End Sub

    Sub Method2(ByVal x)
    Dim objDic As Object
    Dim y As Variant
    Set objDic = CreateObject("Scripting.Dictionary")
    Dim lngRow As Long
    For lngRow = LBound(x) To UBound(x)
    objDic(x(lngRow)) = 1
    Next lngRow
    MsgBox Join(objDic.keys, strDelim)
    End Sub      

    Function DeDupe(strIn As String) As String
    Dim objRegex As Object
    Set objRegex = CreateObject("vbscript.regexp")
    With objRegex
    .Global = True
    .Pattern = "(.+?\d+)[^\d]+(,|$)"
    DeDupe = .Replace(strIn, "$1,")
    End With
    End Function 
    ```

**`Option B`**

```
 'another potential option. Not applied in this code
    Sub Method1(ByVal x)
    Dim y As Variant
    Dim rng1 As Range
    With ActiveSheet
    .[a1].Resize(UBound(x) + 1, 1) = Application.Transpose(x)
    .Columns("A").RemoveDuplicates Columns:=1, Header:=xlNo
    y = Application.Transpose(Range([a1], Cells(Rows.Count, "A").End(xlUp)))
    End With
    MsgBox Join(y, strDelim)
    End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:14:56.790

这可能是不完美的，因为它是一种快速破解，只删除最右边的非数字字符串。您将需要一些正则表达式知识来调整它以满足您的需求。

不管怎样，按照[这里](https://lispy.wordpress.com/2008/10/17/using-regex-functions-in-excel/)给出的“安装”步骤，保存模块，你就可以在你的工作表中写一个公式，比如

```
=S(A1;"[^0-9]*$";"") 
```

例如，在 B1 细胞中。如果 A1 单元格包含“Item 1234 blah blah”，那么 B1 现在将包含“Item 1234”。将公式拖到 B 列的所有单元格中，并将值保存到另一个 Excel 文件进行排序（或者您可以尝试就地排序和小计）。

不幸的是，我不认为在 100,000+ 个单元格中这样做是可行的（我什至建议不要就地小计）。

通过为 Windows 安装文本工具（sed、grep、uniq...）并通过过滤器运行文件，您会得到更好的服务。假设每一行代表一个项目如上，一个过滤器如

```
sed -e 's/^\([^0-9][^0-9]*[0-9][0-9]*\).*/\1/g' | sort | uniq -c | sort -rn 
```

会得到你的 100,000 行文件并返回类似

```
79283 Item 1
 1234 Item 2
  993 Item 3
  .......... 
```

（在某些平台上，您可以编写 (\D+\d+) 而不是 ([^0-9]...，但我不确定 Windows 的行为）。

更好的工具选择是 (Strawberry)Perl，它也支持 CSV，或者 Python 语言。

# .net - 将 WPFDataGrid 列标题设置为 TextBlock

> ID：11216260
> 
> 赞同：2
> 
> 时间：2012-06-26T21:32:00.017
> 
> 标签：.net, wpf, wpfdatagrid

我有一个`DataGrid`.`AutoGenerateColumns=True`

我想将其设置`ColumnHeaders`为 a`TextBlock`以便标题文本可以换行。

我有：

```
Private Sub OnAutoGeneratingColumn(sender As System.Object, e As System.Windows.Controls.DataGridAutoGeneratingColumnEventArgs)
....
    Dim tb As New TextBlock
    tb.TextWrapping = TextWrapping.Wrap
    tb.Text = SomeText
    e.Column.Header = tb
End Sub 
```

在其他代码中，我可以看到实际上`ColumnHeader`是 a `TextBlock`，并且正在做

```
Dim sHeader as String = DirectCast(dgtc.Header, TextBlock).Text 
```

返回 SomeText 回来。

但是，网格在标题中不显示任何文本！另一方面，如果我设置

```
e.Column.Header = SomeText 
```

标题显示正常。

我错过了什么？

我知道网站上有一些答案，但我找不到 AutoGenerateColumns = True 的答案。

# javascript - d3.js 堆栈图

> ID：11216261
> 
> 赞同：1
> 
> 时间：2012-06-26T21:32:13.213
> 
> 标签：javascript, d3.js

参考[d3.js 上的这个堆栈图](http://mbostock.github.com/d3/ex/stack.html)

有人可以解释这段 javascript 吗？我可能根本不了解 javascript 背后的基本原理，我对它比较陌生。我知道正在设置条形之间的边距，整个视图的宽度，高度，但是我完全迷失在下面的部分中。整个来源都在 mbostock 链接上...在此先感谢。

```
var margin = 20,
width = 960,
height = 500 - .5 - margin,
mx = m,
my = d3.max(data, function(d) {
  return d3.max(d, function(d) {
    return d.y0 + d.y;
  });
}),
mz = d3.max(data, function(d) {
  return d3.max(d, function(d) {
    return d.y;
  });
}),

x = function(d) { return d.x * width / mx; },
y0 = function(d) { return height - d.y0 * height / my; },
y1 = function(d) { return height - (d.y + d.y0) * height / my; },
y2 = function(d) { return d.y * height / mz; }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T00:17:20.427

虽然我对 javascript 也很陌生，但我会尝试提供我对代码的理解：

`my`计算堆叠时条形的最大高度（`d.y0`与底部的位置一样，并且`d.y`是条形的高度，因此`d.y0 + d.y`表示任何特定堆叠条形的高度）

同样，`mz`计算分组时条形的最大高度

`d.x`是条形的索引位置，`width / mx`是分配给任何条形组/堆栈的像素空间，因此该函数`x`将索引转换为像素空间

同样，`y0`和 `y1`是将堆叠条的高度转换为像素空间`y2`的函数， 是将分组条的高度转换为像素空间的函数

# javascript - 情节顶部的jqplot网格

> ID：11216263
> 
> 赞同：1
> 
> 时间：2012-06-26T21:32:30.577
> 
> 标签：javascript, jqplot

我一直在修改 jqplot 图表，其中网格线位于图表的顶部（或在前面，取决于您如何看待它），而不是默认背景区域。我已经多次尝试让它使用 z-index 覆盖网格。但是，每次尝试都会使整个图形无法正常工作，并且由于某些未知原因，我没有收到任何错误。

我正在使用实际上填充整个网格的堆叠条形图，所以我看不到任何网格线，它们都隐藏在图形下方（或后面）。

这是代码：

```
<script type="text/javascript" language="javascript">
   $.jqplot.config.enablePlugins = true;

   var plot;
   var data1 = [];
   var data2 = [];
   var index = 0;
   var num = 0;
   var delta = 0;

   $(document).ready(function(){
      for (i=0; i<100; i++) {
         num = getRandomNumber();
         delta = 100 - num;
         index++;
         data1.push([ index, num]);
         data2.push([ index, delta]);
      }

      plot = $.jqplot('graph', [data1, data2],{
                title: 'my title',
                animate: true,
                stackSeries: true,
                seriesDefaults:{
                        renderer:$.jqplot.BarRenderer,
                        rendererOptions: { highlightMouseDown: true },
                        pointLabels: {show: true}
                },
                series: [ {label: 'one'}, {label: 'two'} ],
                seriesColors:['#ff0000', '#0000ff'],
                legend: {
                        show: true,
                        location: 'e',
                        placement: 'outsideGrid'
                },
                grid: {
                        gridLineColor: '#333333',
                        borderWidth: 0
                },
                axesDefaults: {
                        pad: 0,
                        padMin: 0
                },
                axes: {
                        xaxis: {
                                showTicks: false,
                                pad: 0,
                                padMin: 0,
                                rendererOptions: { forceTickAt0: true, forceTickAt100: true }
                        },
                        yaxis: {
                                pad: 0,
                                padMin: 0,
                                rendererOptions: { forceTickAt0: true, forceTickAt100: true }
                        }
                }
      });
   });

   getRandomNumber = function(){
                return Math.floor(Math.random()* 100);
   };
  </script> 
```

任何人都遇到了这个要求并且知道如何让网格线显示在图表的顶部？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:38:50.583

通过一些 DOM 操作，您可以做到这一点，但您需要确保将网格背景颜色设置为透明以使其正常工作。在你的情节调用之后：

```
gridCanvas = $($('.jqplot-grid-canvas')[0])
seriesCanvas = $($('.jqplot-series-canvas')[0])
gridCanvas.detach();
seriesCanvas.after(gridCanvas);​ 
```

这是一个示例[小提琴](http://jsfiddle.net/NZQE8/1/)。

# objective-c - DynamoDB 上的条件 updateItem

> ID：11216269
> 
> 赞同：2
> 
> 时间：2012-06-26T21:33:12.283
> 
> 标签：objective-c, amazon-web-services, amazon-dynamodb

我正在努力更新 DynamoDB 表中的项目。在文档中，我注意到下一句：

> UpdateItem – 编辑现有项目的属性。您还可以使用条件运算符仅在项目的属性值匹配某些条件时执行更新。

我正在写 Objective-C，我找不到开发人员为 updateItem 操作设置任何条件的任何可能性。我需要将条件应用于范围键。有没有人在 DynamoDB 中成功进行条件更新？

PS。我无法实例化正确的 writeBatchItem 参数结构。互联网上没有关于在 Objective-C 上使用 DynamoDB 的信息 :(

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T07:54:00.610

文档说明您可以更新属性。键（哈希/范围）不是属性，因此无法更新。
关于条件更新，请在此处阅读 API 参考：[DynamoDBUpdateItemRequest](http://docs.amazonwebservices.com/AWSiOSSDK/latest/Classes/DynamoDBUpdateItemRequest.html)类参考并[设置预期值](http://docs.amazonwebservices.com/AWSiOSSDK/latest/Classes/DynamoDBUpdateItemRequest.html#//api/name/setExpectedValue%3aforKey%3a)。

如果您觉得文档不够清晰，您还应该查看[Java SDK 参考](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodb/model/UpdateItemRequest.html#setExpected%28java.util.Map%29)

# ajax - 将 JSON 对象传递给 Controller 但松散的模型绑定

> ID：11216271
> 
> 赞同：1
> 
> 时间：2012-06-26T21:33:15.873
> 
> 标签：ajax, json, asp.net-mvc-3

我正在尝试使用 MVC3 和 JSON 将简单的 JSON 对象传递给控制器​​。对象通过了，但我失去了所有属性。我在请求中看到了 firebug 中的所有属性，但不确定为什么我会在服务器上丢失它们。是否需要设置对象的所有属性才能使映射起作用？我正在使用 MVC3，所以应该内置绑定。我错过了什么？

班级：

```
[Serializable]
public class StoryNote
{
    public int Id { get; set; }
    public string Note { get; set; }
    public Nullable<int> StoryCardId { get; set; }
    public string CreatedBy { get; set; }
    public Nullable<System.DateTime> CreateDate { get; set; }
    public virtual StoryCard StoryCard { get; set; }
} 
```

JSON：

```
$(document).ready(function () {

    $('#newNote').click(function (e) {
        e.preventDefault();
        var storynote = {
            StoryNote: {                  
                Note: $('#Note').val(),
                StoryCardId: $('#StoryCard_Id').val(),
                CreatedBy: 'Xyz',                }
        };

        $.ajax({
            url: '@Url.Action("PostNote")',
            type: 'POST',
            data: JSON.stringify(storynote),
            dataType: 'json',                
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $('#previousNotes').append(data.Note + '<br/>' + data.CreatedBy + '<br/><hr/>');
            },
        });
    });
}); 
```

控制器：

```
 [HttpPost]
    public JsonResult PostNote(StoryNote newStoryNote)
    {

        StoryNote newNote = new StoryNote { Note = newStoryNote.Note, CreatedBy = newStoryNote.CreatedBy, StoryCardId = newStoryNote.StoryCardId, CreateDate = DateTime.Now };
        db.StoryNotes.Add(newStoryNote);

        return Json(newStoryNote, JsonRequestBehavior.AllowGet);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:40:47.270

您的代码中存在名称不匹配 - 参数在 Javascript 代码中命名为“StoryNote”，在控制器中命名为“newStoryNote”。这些名字应该是相同的。我相信如果你改变

```
var storynote = {
        StoryNote: {                  
            Note: $('#Note').val(),
            StoryCardId: $('#StoryCard_Id').val(),
            CreatedBy: 'Xyz',                }
    }; 
```

至

```
var storynote = {
        newStoryNote: {                  
            Note: $('#Note').val(),
            StoryCardId: $('#StoryCard_Id').val(),
            CreatedBy: 'Xyz',                }
    }; 
```

那么你的代码应该可以工作。

# php - 如何解析 xml 文件并获取文本值

> ID：11216289
> 
> 赞同：0
> 
> 时间：2012-06-26T21:34:27.777
> 
> 标签：php, javascript, xml, xml-parsing, fxg

以下只是来自大型 fxg 文件的代码片段，它基本上只是一个 xml 文件：

```
<RichText x="14.1655" y="46.5674" columnGap="18" columnCount="1" textAlign="left" fontFamily="Bootstrap" color="#53836A" whiteSpaceCollapse="preserve" width="202.712" height="13.334" s7:caps="none" s7:colorName="" s7:colorValue="#B24FA41C" s7:colorspace="cmyk" s7:elementID="line1" s7:fill="true" s7:fillOverprint="false" s7:firstBaselineOffset="ascent" s7:joints="miter" s7:maxFontSize="12" s7:miterLimit="10" s7:referencePoint="inherit" s7:rowCount="1" s7:rowGap="18" s7:rowMajorOrder="true" s7:stroke="false" s7:strokeOverprint="false" s7:warpBend="0.5" s7:warpDirection="horizontal" s7:warpHorizontalDistortion="0" s7:warpStyle="none" s7:warpVerticalDistortion="0" s7:weight="1" ai:aa="2" ATE:C_charRotation="0" ATE:C_horizontalScale="1" ATE:C_kerning="metric" ATE:C_verticalScale="1" ATE:P_autoHyphenate="true" ATE:P_consecutiveHyphenLimit="0" ATE:P_hyphenateCapitalized="true" ATE:P_hyphenatedWordSize="6" ATE:P_hyphenationPreference="0.5" ATE:P_hyphenationZone="36" ATE:P_postHyphenSize="2" ATE:P_preHyphenSize="2" d:userLabel="id:line1">
   <content><p><span>Address Line 1</span></p></content>
</RichText> 
```

XML 文件中有许多具有相似结构的节点。但在这种情况下，每个`RichText`节点都有一个唯一的元素 ID 。`s7:elementID="line1"`

使用 PHP 或 JavaScript，我该如何获取：

1.  文本“地址线 1”
2.  包括内容、p、span 标签的整行

如果我指定`elementID`我想要的内容来自？

我对 XML 不是很熟悉，所以我不确定这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:41:50.717

将 xml 加载到一个对象中：`simplexml_load_string()`

然后`->xpath('RichText')`在该对象上使用来获取 RichText 元素。

如果你`->asXML()`在那些元素上使用，

你得到`"<content><p><span>Address Line 1</span></p></content>"`

总是这样`"<content><p><span>"`吗？

那么你可以使用`(string) $RichText->content[0]->p[0]->span[0]`

# javascript - 如何将 div 的大小限制为窗口尺寸？

> ID：11216290
> 
> 赞同：0
> 
> 时间：2012-06-26T21:34:31.763
> 
> 标签：javascript, jquery, html, css

我有一个包含书签的菜单栏（div），当插入太多书签时，这个菜单栏（div）对于首选的页面大小（1280、720）变得太宽，并且变成滚动，留下一半的书签看不见。

![在此处输入图像描述](../Images/d8ce03d7686492eb72ceed0e93db3dd6.png)

我想确保所有书签都在视图中，最好的选择似乎是我必须让额外的书签出现在下一行。有人可以引导我朝着正确的方向前进，或者更好地提供一个工作样本。我刚刚学习使用 jquery，发现这非常困难。

[jsfiddle 中的示例代码](http://jsfiddle.net/ftaran/y9a64/8/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:40:08.037

`ul`你在元素上有这个。

```
white-space: nowrap; 
```

这意味着该元素的内容永远不会换行，因此它会延伸到窗口边缘之外。删除该规则，您将获得更接近您想要的东西。也就是说，当您的内容溢出一行时，您希望它*换*行到下一行。

[http://jsfiddle.net/y9a64/9/](http://jsfiddle.net/y9a64/9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:37:28.243

[http://jsfiddle.net/bH8yA/](http://jsfiddle.net/bH8yA/) 您是否正在寻找这样的解决方案？如果是这样，那就是直接的 CSS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:48:47.333

你可以通过使用 css overflow-x: auto; 来实现。请参阅示例[http://jsfiddle.net/Xa8yB/6/](http://jsfiddle.net/Xa8yB/6/)

# java - 使用 Java 将分段函数转换为 CSV 文件

> ID：11216294
> 
> 赞同：0
> 
> 时间：2012-06-26T21:34:43.243
> 
> 标签：java, csv, mathml, piecewise

我正在尝试创建一个 Java 函数，它将包含分段函数的字符串转换为可用于绘图的 CSV 文件。例如这个表达式：

```
if (time < 60) then (0.1) else ( if (time > 66.0115) then (0.1) else 1) 
```

将转换为：

```
File pwl.csv
time , output
0 , 0.1 
59.9, 0.1
60, 1
66.0115, 1
66.11149999999999, 0.1
132.023, 0.1
End File 
```

转换器需要能够处理各种分段函数，包括：

```
if (t > 0.5) then (2) else 3
if (t >= 0.5) then (2) else 3
if (t < 0.5) then (2) else 3
if (t <= 0.5) then (2) else 3
if ((t >= 3600) & (t <= 3660)) then (25) else 0 
```

我已经能够编写转换第一个示例的代码，但它实际上只适用于该特定功能，我正在寻找更通用的解决方案。对这个问题有什么想法吗？

这些分段函数最初来自 MathML 文件，因此也欢迎任何有关从 MathML 直接转换为 CSV 的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T00:34:28.767

这似乎工作 - 排序。无论如何，这可能是一个好的开始。

```
public class CSVFun {
  // Where to start the scan of the function.
  static final double Start = 0.0;
  // End of scan.
  static final double End = 10000.0;
  // Fine enough to detect a change in the function.
  static final double BigStep = 0.1;
  // Finest resolution.
  static final double SmallStep = 0.000000001;

  // Work out some csv for a function.
  private static void csv(F f) {
    System.out.println("Function: " + f);
    // Start at 0.
    double t = Start;
    double ft = f.f(t);
    System.out.println(t + "," + ft);
    while (t < End) {
      // Walk to the end.
      double step = BigStep;
      // Find a break point.
      while (t < End && f.f(t) == ft) {
        t += step;
      }
      if (t < End) {
        // Back one.
        t -= step;
        // Zoom in on the transition point.
        while (step > SmallStep) {
          // Go smaller.
          step /= 10;
          // Walk forward.
          while (t < End && f.f(t) == ft) {
            t += step;
          }
          // Back one.
          t -= step;
        }
        // Before
        System.out.println(t + "," + ft);
        // One more forward.
        t += step;
      }
      // Print.
      if (f.f(t) != ft) {
        ft = f.f(t);
        System.out.println(t + "," + ft);
      }
    }
  }

  // Tests the process with the sample functions below.
  public static void main(String[] args) {
    try {
      for (F f : F.values()) {
        csv(f);
      }
    } catch (Exception ex) {
      ex.printStackTrace();
    }
  }

  // The sample functions - Encoded in Java
  enum F {
    A {
      @Override
      double f(double t) {
        if (t < 60) {
          return (0.1);
        }
        if (t > 66.0115) {
          return (0.1);
        }
        return 1;
      }
    },
    B {
      @Override
      double f(double t) {
        if (t > 0.5) {
          return 2;
        }
        return 3;
      }
    },
    C {
      @Override
      double f(double t) {
        if (t >= 0.5) {
          return 2;
        }
        return 3;
      }
    },
    D {
      @Override
      double f(double t) {
        if (t < 0.5) {
          return 2;
        }
        return 3;
      }
    },
    E {
      @Override
      double f(double t) {
        if (t <= 0.5) {
          return 2;
        }
        return 3;
      }
    },
    F {
      @Override
      double f(double t) {
        if ((t >= 3600) & (t <= 3660)) {
          return 25;
        }
        return 0;
      }
    },;

    abstract double f(double t);
  }
} 
```

输出：

```
Function: A
0.0,0.1
59.999999999000565,0.1
60.00000000000056,1.0
66.01149999900045,1.0
66.01150000000045,0.1
Function: B
0.0,3.0
0.49999999999999994,3.0
0.500000001,2.0
Function: C
0.0,3.0
0.49999999999999983,3.0
0.5000000009999999,2.0
Function: D
0.0,2.0
0.49999999999999983,2.0
0.5000000009999999,3.0
Function: E
0.0,2.0
0.49999999999999994,2.0
0.500000001,3.0
Function: F
0.0,0.0
3599.9999999998213,0.0
3600.0000000008213,25.0
3659.999999999771,25.0
3660.000000000771,0.0 
```

我认为这是接近的。

# sql - 选择不同的语句

> ID：11216297
> 
> 赞同：-2
> 
> 时间：2012-06-26T21:34:53.593
> 
> 标签：sql, database, select, duplicates, distinct

出于某种原因，我的查询返回重复行。我正在尝试创建一个`SELECT DISTINCT`查询。有人可以告诉我我的查询有什么问题吗？

```
SELECT DISTINCT
    PT_AGCY_DTL.MLM_AGCY_NBR AS AgencyID
    , AGENCY.ORG_NM AS Agency
    , AGCY_ADDR.CTY_NM as AgencyCity
    , AGCY_ADDR.ST_PRVN_CDE_CID as AgencyST
    , AG_AGCY_CNTCT.AGCY_CNTCT_ID as ContactID
    , AG_AGCY_CNTCT.CNTCT_DT AS ContactDt
    , AG_AGCY_CNTCT.AGCY_RESULTS_TXT AS AgencyResults
    , AG_AGCY_CNTCT.GEN_OVERVIEW_TXT AS GeneralOverview
    , AG_AGCY_CNTCT.NB_RNWL_BUS_DISCUSSION_TXT AS NewAndRenewalBusinessDiscussions
    , AG_AGCY_CNTCT.NB_RNWL_BUS_DISCUSSION_TXT AS NewAndRenewalBusinessDiscussions
    , AG_AGCY_CNTCT.MKT_INTELLIGENCE_TXT AS MarketIntelligence
    , AG_AGCY_CNTCT.AGCY_PERSONNEL_CHG_TXT AS AgencyPersonnelChanges
    , AG_AGCY_CNTCT.MM_ISSUE_TXT AS MyMonitorIssues
    , AG_AGCY_CNTCT.UW_CLM_ISSUE_TXT AS UnderwritingClaimIssues
    , AG_AGCY_CNTCT.FOLLOW_UP_ITEM_TXT AS FollowUpActionItems
    , AG_AGCY_CNTCT.NXT_CNTCT_DT AS NextScheduledVisitDate
    , CONTACT_TYPE.CODE_NM AS ContactType
    , CONVERT(VARCHAR, AG_AGCY_CNTCT.CNTCT_DT,101) + ' - ' + CONTACT_TYPE.CODE_NM AS ContactDtType
    , AG_AGCY_CNTCT.CNTCT_DESC AS ContactDetails
, CASE
     WHEN PRODUCER.LST_NM IS NULL THEN ' '
     ELSE LTRIM(RTRIM(PRODUCER.FRST_NM)) + ' ' + LTRIM(RTRIM(PRODUCER.LST_NM)) END AS Producers
, CASE
     WHEN MLM_EMPL.LST_NM IS NULL THEN ' '
     ELSE LTRIM(RTRIM(MLM_EMPL.FRST_NM)) + ' ' + LTRIM(RTRIM(MLM_EMPL.LST_NM)) END AS Employees
, CASE 
     WHEN PROD_CAT.CODE_NM IS NULL THEN ' '
     ELSE LTRIM(RTRIM(PROD_CAT.CODE_NM)) END AS ProductCategory

FROM
    AG_AGCY_CNTCT
    INNER JOIN PT_AGCY_DTL
        ON AG_AGCY_CNTCT.AGCY_PID = PT_AGCY_DTL.PARTY_ID
    INNER JOIN PT_PARTY AS AGENCY
        ON AGENCY.PARTY_ID = AG_AGCY_CNTCT.AGCY_PID
    LEFT OUTER JOIN PT_PARTY_ADDR AS AGCY_ADDR
        ON AGCY_ADDR.PARTY_ID = AG_AGCY_CNTCT.AGCY_PID
    INNER JOIN CD_CODE AS CONTACT_TYPE
        ON CONTACT_TYPE.CODE_ID = AG_AGCY_CNTCT.CNTCT_TYP_CID
    LEFT OUTER JOIN AG_AGCY_CNTCT_PRDCR_RLTNSHP
        ON AG_AGCY_CNTCT_PRDCR_RLTNSHP.AGCY_CNTCT_ID = AG_AGCY_CNTCT.AGCY_CNTCT_ID
            LEFT OUTER JOIN PT_PARTY AS PRODUCER
        ON PRODUCER.PARTY_ID = AG_AGCY_CNTCT_PRDCR_RLTNSHP.PRDCR_PID
     LEFT OUTER JOIN AG_AGCY_CNTCT_MLM_EMPL_RLTNSHP
        ON AG_AGCY_CNTCT_MLM_EMPL_RLTNSHP.AGCY_CNTCT_ID = AG_AGCY_CNTCT.AGCY_CNTCT_ID
    LEFT OUTER JOIN PT_PARTY AS MLM_EMPL
        ON MLM_EMPL.PARTY_ID = AG_AGCY_CNTCT_MLM_EMPL_RLTNSHP.MLM_EMPL_PID
    LEFT OUTER JOIN AG_AGCY_CNTCT_PROD_CAT_TYP_RLTNSHP
        ON AG_AGCY_CNTCT_PROD_CAT_TYP_RLTNSHP.AGCY_CNTCT_ID = AG_AGCY_CNTCT.AGCY_CNTCT_ID
    LEFT OUTER JOIN CD_CODE AS PROD_CAT
        ON PROD_CAT.CODE_ID = AG_AGCY_CNTCT_PROD_CAT_TYP_RLTNSHP.PROD_CAT_TYP_CID
        AND AGCY_ADDR.ADDR_TYP_CID = '30'  -- business address
        AND AGCY_ADDR.REC_STS_TYP_CID = 'A'  -- active
WHERE
    PT_AGCY_DTL.MLM_AGCY_NBR ='4759' --@AgencyID (this is the FILTER)

ORDER BY ContactDt DESC, ContactID DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:46:48.927

您没有指定，但我怀疑您的印象是以下行是重复的：

```
t1.col1   | t1.col2   | t2.col1
--------------------------------
1         | 1         | 1
1         | 1         | 2 
```

不是这种情况。正如评论中提到的，`DISTINCT`适用于您选择的所有列。您可以看到有两种不同的值组合，因此将返回两行。有些人会使用聚合函数和 group by 来解决这个问题。例子：

```
SELECT t1.col1, t1.col2, MAX(t2.col1)
FROM table1 t1
INNER JOIN table2 t2
on t1.whatever = t2.whatever
GROUP BY t1.col1, t1.col2 
```

这只会返回第二行。如果您这样做，请确保您了解您排除信息是为了强制**出现**一组不同的记录。

# java - Android，如何在自制应用程序中显示活动的GPS坐标

> ID：11216300
> 
> 赞同：-1
> 
> 时间：2012-06-26T21:35:08.470
> 
> 标签：java, android, xml, gps

是否有任何代码可以让您在自制应用程序中显示您的活动坐标？我的谷歌地图有问题，想看看我的活动坐标是什么。我更喜欢在我的应用程序中查看谷歌地图时显示它，例如第二层信息。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:41:05.647

您可以设置一个 LocationListener。

在 onLocationChanged 回调中，您将收到一个位置。然后，您可以从该位置 .getLatitude() 和 .getLongitude() 并将其应用于您的布局。

```
public class MyActivity extends MapActivity implements LocationListener {

    private LocationManager locationManager;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        requestFineAccuracyLocationUpdates();
    }

    private void requestFineAccuracyLocationUpdates() {
        Criteria criteria = new Criteria();
        criteria.setAccuracy(Criteria.ACCURACY_FINE);

        List<String> providers = locationManager.getProviders(true);

        for (String provider : providers) {
            locationManager.requestLocationUpdates(provider, 5000, 1000, this);
        }
    }

    @Override
    public void onLocationChanged(Location location) {
        /* You can get your latitude and longitude here, and do whatever. */
    }
} 
```

# javascript - 使用 jquery 修改多选验证

> ID：11216304
> 
> 赞同：0
> 
> 时间：2012-06-26T21:35:14.747
> 
> 标签：javascript, jquery

到目前为止我得到了什么：[JSFIDDLE](http://jsfiddle.net/heera/m4tyC/1/)

我想要的是：

1.  `<select>`如果未在其行中选择它，则添加类“无效”
2.  如果选择了该行中的 3 个选择，则删除此类
3.  如果`<select>`选择了一行中的所有 s 然后提交表单
4.  如果只`<select>`选择了一个，则将“无效”类添加到同一行中的其他 2 个选择中

这是 HTML，js 包含在上面的小提琴链接中：

```
 <form id="productOptions" name="product-options">
  <div class="selects s1">
    <select name="selectss1" id="size1" class="product-select-options-size">
      <option>-Size</option>
      <option>Small</option>
      <option>Medium</option>
      <option>Large</option>
      <option>X-large</option>
    </select>
    <select name="selectsc1" id="color1" class="product-select-options-color">
      <option>-Color</option>
      <option>Green</option>
      <option>Pink</option>
      <option>White</option>
      <option>Yellow</option>
    </select>
    <select name="selectsq1" id="qty1" class="product-select-options-qty">
      <option>-QTY</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
  <div class="selects s2">
    <select name="selectss2" id="size2" class="product-select-options-size">
      <option>-Size</option>
      <option>Small</option>
      <option>Medium</option>
      <option>Large</option>
      <option>X-large</option>
    </select>
    <select name="selectsc2" id="color2" class="product-select-options-color">
      <option>-Color</option>
      <option>Green</option>
      <option>Pink</option>
      <option>White</option>
      <option>Yellow</option>
    </select>
    <select name="selectsq2" id="qty2" class="product-select-options-qty">
      <option>-QTY</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
  <div class="selects s3">
    <select name="selectss3" id="size3" class="product-select-options-size">
      <option>-Size</option>
      <option>Small</option>
      <option>Medium</option>
      <option>Large</option>
      <option>X-large</option>
    </select>
    <select name="selectsc3" id="color3" class="product-select-options-color">
      <option>-Color</option>
      <option>Green</option>
      <option>Pink</option>
      <option>White</option>
      <option>Yellow</option>
    </select>
    <select name="selectsq3" id="qty3" class="product-select-options-qty">
      <option>-QTY</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
  <p><a href="#" class="add-more">+ Add more at one time</a></p>
  <!-- End select options -->
  <input type="image" name="product-options" src="/media/blackheart/images/blackheart/add-to-cart.png"  />
  </form> 
```

好心提醒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T18:22:52.540

这是我想要的解决方案，感谢所有帮助：

```
<script type="text/javascript">
    $(function(){
        $('#formid').on('submit', function(e){
            e.preventDefault();
            var f=$(this);    
            var invalid=false, selected=0;
            $('.selects').each(function(){
                var row=$(this);
                var items=0;
                $('select', row).each(function(){
                    var t=$(this);
                    var selectedIndex=t.prop("selectedIndex");
                    if(selectedIndex)
                    {
                        items++;
                        t.removeClass('invalid'); //this line was added
                    }
                    else t.addClass('invalid');
                    $("#formid").find(".invalid").removeClass("invalid").filter(':lt(1)').addClass("invalid");
                        //this line was added
                });
                if(items==3) selected++;
                if(items>0 && items<3) invalid=true;
                items=0;
            });

        if(selected>0 && !invalid) f[0].submit();
        else {
        /*alert('Please fill up the form correctly');*/
        $(".selects-msg").slideDown();
        }

      });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T09:28:09.283

您发布了一个非常晦涩的问题。例如，您没有说明必须添加/删除什么事件“无效”类。我想这是“提交”。

您还提供了 4 个条件，而 #1、2、4 是多余的，因为它们在某种程度上是互斥的。即，如果您**为未在其行中选择的类添加“无效”类，****那么如果选择了该行中的 3 个选择，则删除该类有**什么意义？*如果它被选中，*你必须简单地删除它。同样，#4 条件本质上与#1 相同。

您的 js 代码运行良好，您只需要添加几行来操作 css-classes 注意：我没有使用 jsfiddle，我在真实浏览器（包括 IE7）中检查了此代码并且它有效，而在 jsfiddle 没有。

```
$(function(){
    $('#frm_productOrder').on('submit', function(e){
        e.preventDefault();
        var f=$(this);    
        var invalid=false, selected=0;
        $('.selects').each(function(){
            var row=$(this);
            var items=0;
            $('select', row).each(function(){
                var t=$(this);
                var selectedIndex=t.prop("selectedIndex");
                if(selectedIndex)
                {
                    items++;
                    t.removeClass('invalid'); //this line was added
                }
                else t.addClass('invalid');    //this line was added
            });
            if(items==3) selected++;
            if(items>0 && items<3) invalid=true;
            items=0;
        });
        if(selected>0 && !invalid) f[0].submit();
        else alert('Please fill up the form correctly');       
    });
}); 
```

# java - 如何在控制台应用程序中运行 jFileChooser？是否可以？

> ID：11216308
> 
> 赞同：2
> 
> 时间：2012-06-26T21:35:33.483
> 
> 标签：java, console-application, jfilechooser, directory-browsing

我试图用这段代码来做到这一点：

```
JFileChooser chooser = new JFileChooser();
int retval = JFileChooser.CANCEL_OPTION;
chooser.setFileSelectionMode( JFileChooser.DIRECTORIES_ONLY);
retval = chooser.showDialog(null, "Select"); 
```

但它没有用。控制台只是等待输入...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:14:07.820

你需要运行它`java -jar exported.jar`

# html - CSS如何使图像流畅地延伸到浏览器的一侧，与居中的内容对齐？

> ID：11216309
> 
> 赞同：3
> 
> 时间：2012-06-26T21:35:49.180
> 
> 标签：html, css

我目前没有代码可以作为示例显示，因为我一直在尝试完成这项工作，但甚至没有接近使其按预期工作。由于 NDA，我无法显示图像。所以将描述我能做到的最好的。

基本上：

1.  我在 div 中有一个徽标图像。div 有 margin:0 auto; 所以它在浏览器中居中。

2.  我有一个透明背景的“箭头”png图像，需要在浏览器的右侧刷新。

3.  问题是，无论您将浏览器窗口设为多宽，我都需要将箭头尖端留在徽标的右侧，而箭头的尾部仍然与浏览器的右侧齐平。

4.  页面的内容也将居中。以防万一需要此信息。

基本上我需要将箭头调整为浏览器宽度，但要确保箭头始终指向徽标。

我所有的尝试都使 div 太大，导致徽标一直向左冲洗而不是居中。

我知道这可能包括将箭头切成两个图像，但即便如此，我仍然对如何使它真正起作用感到困惑。开始认为这是不可能的事情。

这是一张图片来解释，我相信一旦我弄清楚如何做顶部箭头，我就能得到底部箭头。底部箭头略有不同，因为箭头尖端可能在不同的位置，具体取决于页面。

![样品设计](../Images/2471e5e40c430528da7781d65daddcdf.png)

**最终更新：使用 Max 的建议**

注意：我只在 chrome、firefox 和 safari 上测试过，所有最新版本都是这篇文章。不确定其他版本或 IE 会遇到什么问题。

HTML

```
 <div class="header-wrapper">

  <div class="header">
   <img src="images/logo.png" />
  </div>
  <div class="arrow-wrapper">
   <div class="arrow-tail"></div>
  </div>
 </div> 
```

CSS 代码

```
.header-wrapper{
    position:relative;
    width:100%;
    overflow:hidden;
}

.header {

   position: relative;
    z-index: 10;
    height: 69px;
    margin: 0 auto;
}

.arrow-wrapper {
    z-index: 5;
    background:url(../images/arrow_tip.png) no-repeat top left;
    width: 50%;
    position: absolute;
    left: 50%;
    top: 18px;
    padding: 0 0 0 120px; 
    height:23px;
    margin-left:140px;
}

.arrow-tail{
    background:url(../images/arrow_tail.png) repeat-x top left;
    height:23px;
    width:100%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:48:07.773

如果我猜对了，这可能是一个解决方案：http: [//jsfiddle.net/WazcT/3/](http://jsfiddle.net/WazcT/3/)

HTML：

```
<div class="main">
  <div class="header"></div>
  <div class="arrow_container">
    <div class="arrow">&larr;&dash;&dash;</div>
  </div>
</div> 
```

CSS：

```
.main{
    position: relative;
    width: 100%;
    overflow: hidden;
}

.header{
    position: relative;
    opacity: 0.5;
    z-index: 10;
    width : 400px;
    height: 100px;
    margin: 0 auto;
    background: #ccc;
}

.arrow_container {
    z-index: 5;
    background: #88b7d5;
    width: 50%;
    position: absolute;
    left: 50%;
    top: 10px;
    padding: 10px 0 10px 200px;     
}

.arrow{
    padding: 10px;
    background: #eee;
    font-size: 32px;
}
​ 
```

# java - 使用 JSP 标签库在选择中嵌套选择

> ID：11216315
> 
> 赞同：4
> 
> 时间：2012-06-26T21:36:11.923
> 
> 标签：java, html, jsp

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<td colspan="1" width="100">
<c:choose>
  <c:when>
  </c:when>

  <c:when>
  </c:when>

  <c:when>
    <c:choose>
       <c:when></c:when><c:otherwise><c:when></c:when></c:otherwise>
    </c:choose>
  </c:when>

  <c:otherwise>
  </c:otherwise>
</c:choose>
</td> 
```

在选择中嵌套选择是否有限制，例如这样？

编辑：JSP 编译器一直抱怨我没有结束标记，如果我在 else 中放置另一个 <c:when></c:when>。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-28T11:46:06.330

据我所知有一个错误：

```
<c:when>
    <c:choose>
        <c:when></c:when><c:otherwise><c:when></c:when></c:otherwise>
    </c:choose>
</c:when> 
```

应该：

```
<c:when>
    <c:choose>
        <c:when></c:when>
        <c:otherwise></c:otherwise>
    </c:choose>
</c:when> 
```

您不能直接在内部嵌套 when 标记，为此您需要另一个选择标记：

```
<c:when>
    <c:choose>
        <c:when></c:when>
        <c:otherwise>
            <c:choose>
                <c:when></c:when>
            </c:choose>
        </c:otherwise>
    </c:choose>
</c:when> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T06:05:37.800

JSP 将被翻译为 Java，其中将为每个自定义标签创建函数，如下所示

```
private boolean _jspx_meth_c_005fwhen_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_c_005fchoose_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
      throws java.lang.Throwable {
javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
//  c:when
org.apache.taglibs.standard.tag.rt.core.WhenTag _jspx_th_c_005fwhen_005f0 = (org.apache.taglibs.standard.tag.rt.core.WhenTag) _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.WhenTag.class);
_jspx_th_c_005fwhen_005f0.setPageContext(_jspx_page_context);
_jspx_th_c_005fwhen_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_c_005fchoose_005f0);
// /index1.jsp(4,2) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
_jspx_th_c_005fwhen_005f0.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${true}", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
int _jspx_eval_c_005fwhen_005f0 = _jspx_th_c_005fwhen_005f0.doStartTag();
if (_jspx_eval_c_005fwhen_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
  do {
    out.write("\r\n");
    out.write("  ");
    int evalDoAfterBody = _jspx_th_c_005fwhen_005f0.doAfterBody();
    if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
      break;
  } while (true);
}
if (_jspx_th_c_005fwhen_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
  _005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
  return true;
}
_005fjspx_005ftagPool_005fc_005fwhen_0026_005ftest.reuse(_jspx_th_c_005fwhen_005f0);
return false;
} 
```

拥有嵌套函数将增加函数堆栈级别。默认情况下，JVM 具有不错的堆栈大小，并且应该会给您带来任何问题/

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T21:38:03.810

最终你可能会用完堆栈空间。否则没有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T21:38:44.777

*常识*和可读性是您可能遇到的最接近的限制。你有这个代码的一些问题吗？

# solr - 在 solr 搜索中排除单词或短语

> ID：11216316
> 
> 赞同：2
> 
> 时间：2012-06-26T21:36:15.293
> 
> 标签：solr

我已经配置了以下 solr 字段，并想看看如何从搜索中消除一些单词。例如薯条、油炸等。我尝试将其放入 stopwords.txt，但不起作用 solr 仍然返回结果。我的另一个问题是。

如何限制搜索，以便如果文本包含两个接近或分开的单词，它应该返回匹配结果，例如

如果我搜索虾 poboy，它应该返回 1 和 3 而不是 2。

1.  我喜欢虾仔
2.  虾菜
3.  poboy三明治类别下的虾三明治

    ```
     <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <!--tokenizer class="solr.KeywordTokenizerFactory"/-->
    <filter class="solr.LowerCaseFilterFactory"/>       
    <filter class="solr.PatternReplaceFilterFactory" pattern="(;|,|-)\s*" replacement=" " replace="all"/>   
    <filter class="solr.PatternReplaceFilterFactory" pattern="^(\p{Punct}*)(.*?)(\p{Punct}*)$" replacement="$2"/>       
    <filter class="solr.WordDelimiterFilterFactory"
            generateWordParts="1"
            generateNumberParts="1"
            catenateWords="1"
            catenateNumbers="1"
            catenateAll="0"
            preserveOriginal="1"
            />
    <filter class="solr.TrimFilterFactory"/>
            <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
       <filter class="solr.SynonymFilterFactory" synonyms="synonyms.keyword.txt" ignoreCase="true" expand="true" tokenizerFactory="solr.KeywordTokenizerFactory"/>
           <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
           <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
           <filter class="solr.PorterStemFilterFactory"/>
           <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        </analyzer>
    <analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <!--tokenizer class="solr.KeywordTokenizerFactory"/-->
    <filter class="solr.LowerCaseFilterFactory"/>       
    <filter class="solr.PatternReplaceFilterFactory" pattern="(;|,|-)\s*" replacement=" " replace="all"/>                       
    <filter class="solr.PatternReplaceFilterFactory" pattern="^(\p{Punct}*)(.*?)(\p{Punct}*)$" replacement="$2"/>                   
    <filter class="solr.WordDelimiterFilterFactory"
            generateWordParts="1"
            generateNumberParts="1"
            catenateWords="1"
            catenateNumbers="1"
            catenateAll="0"
            preserveOriginal="1"
            />      
    <filter class="solr.TrimFilterFactory"/>
            <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
    <filter class="solr.SynonymFilterFactory" synonyms="synonyms.keyword.txt" ignoreCase="true" expand="true" tokenizerFactory="solr.KeywordTokenizerFactory"/>     
            <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
            <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
            <filter class="solr.PorterStemFilterFactory"/>
            <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
          </analyzer>
    </fieldType> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:49:19.063

对于要从​​搜索中排除的单词，您需要在其中添加另一个过滤器：

```
<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" /> 
```

如果它仍然不起作用，请转到 Solr 管理面板，转到 Analysis 并尝试使用停用词进行查询。看看它是如何处理的。

对于第二个，Solr 提供邻近搜索 - 只需`~2`在查询后使用 a 来指定单词彼此之间最多需要 2 个单词。

# python - 使用 matplotlib 自动设置条形图的 y 轴范围

> ID：11216319
> 
> 赞同：20
> 
> 时间：2012-06-26T21:36:32.000
> 
> 标签：python, matplotlib

这是绘制大值的示例。

```
import matplotlib.pyplot as plt
x = [1,2,3,4,5]
y = [1000, 1002, 1001, 1003, 1005]
plt.bar(x,y) 
plt.show() 
```

y 轴从 0 开始，因此条形看起来都相等。我知道您可以使用 plt.ylim 手动设置限制，但是 matplotlib 有没有办法自动（并且巧妙地）将限制设置为合理的值（例如 998-1008），并且还可能显示轴中断？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-27T00:29:51.327

一点简单的代数将有助于解决这些限制：

```
import matplotlib.pyplot as plt
import math
x = [1,2,3,4,5]
y = [1000, 1002, 1001, 1003, 1005]
low = min(y)
high = max(y)
plt.ylim([math.ceil(low-0.5*(high-low)), math.ceil(high+0.5*(high-low))])
plt.bar(x,y) 
plt.show() 
```

通过这种方式，您可以找到 y 值之间的差异，并使用它们来设置沿 y 轴的比例。我使用 math.ceil（而不是 math.floor）来获取您指定的值并确保整数。

就轴断裂而言，我建议看一下[这个例子](https://stackoverflow.com/questions/5656798/python-matplotlib-is-there-a-way-to-make-a-discontinuous-axis)。

# dependency-injection - Guice + Jersey：实体的自定义序列化

> ID：11216321
> 
> 赞同：4
> 
> 时间：2012-06-26T21:36:35.010
> 
> 标签：dependency-injection, jersey, jax-rs, guice

我浏览了 stackoverflow 和 Web 的其余部分以获取示例，但我找不到任何超出 JSON 和 XML 序列化的内容。

例如，在我的 webapp 中，我希望我的实体被序列化为 CSV。

我知道在 Jersey 我可以实现实现 MessageBodyWriter 和 MessageBodyReader 接口的提供程序（或者这些类要扩展吗？无论如何），然后让 Jersey 扫描一个包并查找和使用这些自定义实现。我如何使用 JerseyServletModule 使用 Guice 来做到这一点？

另一个 jax-rs 框架是否很好地与 guice 集成？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T18:52:30.900

您应该能够将绑定添加到 MessageBodyWriter 的实现，而不是扫描包。例如：

```
public class Config extends GuiceServletContextListener {

  @Override
  protected Injector getInjector() {
    return Guice.createInjector(            
        new JerseyServletModule() {
          @Override
          protected void configureServlets() {
            bind(Service.class);
            bind(CsvWriter.class);
            serve("/services/*").with(GuiceContainer.class);
          }
        });
  }

} 
```

CsvWriter.java 看起来像：

```
@Singleton
@Produces("text/csv")
@Provider
public class CsvWriter implements MessageBodyWriter<Foo> {

    @Override
    public boolean isWriteable(Class<?> type, Type genericType, Annotation[] annotations, MediaType mediaType) {
        return Foo.class.isAssignableFrom(type);
    }

    @Override
    public long getSize(Foo data, Class<?> type, Type genericType, Annotation annotations[], MediaType mediaType) {
        return -1;
    }

    @Override
    public void writeTo(Foo data, 
            Class<?> type, Type genericType, Annotation[] annotations,
            MediaType mediaType, MultivaluedMap<String, Object> headers, 
            OutputStream out) throws IOException {
      // Serialize CSV to out here
    }

} 
```

然后在服务中有一些@Produces（“text/csv”）的方法。

# c# - 根据返回类型重载方法

> ID：11216325
> 
> 赞同：2
> 
> 时间：2012-06-26T21:36:57.337
> 
> 标签：c#, return-value, overloading

全部——我的一个类中有这两种方法：

```
public static void DeSerializeFromXml(out cDBData db, string pathToXML)
{
    using (XmlTextReader reader = new XmlTextReader(pathToXML))
    {
        XmlSerializer ser = new XmlSerializer(typeof(cDBData));
        db = (cDBData)ser.Deserialize(reader);
    }
}

public static void DeSerializeFromXml(out cDatabases db, string pathToXML)
{
    using (XmlTextReader reader = new XmlTextReader(pathToXML))
    {
        XmlSerializer ser = new XmlSerializer(typeof(cDatabases));
        db = (cDatabases)ser.Deserialize(reader);
    }
} 
```

他们工作正常，但我想知道为什么我不能根据方法的返回类型创建方法重载。我以为我读到这在某处是可能的，但我显然错了，因为它不起作用：

```
public static cDBData DeSerializeFromXml(string pathToXML)
{
    cDBData db;

    using (XmlTextReader reader = new XmlTextReader(pathToXML))
    {
        XmlSerializer ser = new XmlSerializer(typeof(cDBData));
        db = (cDBData)ser.Deserialize(reader);
    }
    return db;
}

public static cDatabases DeSerializeFromXml(string pathToXML)
{
    cDatabases db;

    using (XmlTextReader reader = new XmlTextReader(pathToXML))
    {
        XmlSerializer ser = new XmlSerializer(typeof(cDatabases));
        db = (cDatabases)ser.Deserialize(reader);
    }
    return db;
} 
```

感谢您的周到回复

感谢 dlev，这是最终的解决方案

```
 public static T DeSerializeFromXml<T>(string pathToXML)
    {
        T db;

        using (XmlTextReader reader = new XmlTextReader(pathToXML))
        {
            XmlSerializer ser = new XmlSerializer(typeof(T));
            db = (T)ser.Deserialize(reader);
        }
        return db;
    }

    public static void SerializeToXml<T>(T db, string pathToXML)
    {
        using (var fileStream = new FileStream(pathToXML, FileMode.Create))
        {
            var ser = new XmlSerializer(typeof(T));
            ser.Serialize(fileStream, db);
        }
    } 
```

我想在搜查警察关闭这个问题之前把这些贴出来。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T21:41:46.403

你不能这样做，因为 C# 根本不支持这种重载。您可以通过使方法泛型并返回泛型参数类型来实现类似的效果：

```
public static T DeSerializeFromXml<T>(string pathToXML)
{
    T db;

    using (XmlTextReader reader = new XmlTextReader(pathToXML))
    {
        XmlSerializer ser = new XmlSerializer(typeof(T));
        db = (T)ser.Deserialize(reader);
    }
    return db;
} 
```

然后，您可以像这样调用函数：

```
DeSerializeFromXml<cDatabases>(pathToXml); 
```

虽然这不是您想要的，但它确实具有只需要一个方法的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T21:41:30.837

> 我想知道为什么我不能根据方法的返回类型创建方法重载。

这根本不可能。在重载决议期间不考虑返回类型，并且该语言只是禁止尝试像这样重载。从 C# 4 规范的第 3.6 节：

> 方法的签名由方法的名称、类型参数的数量以及每个形式参数的类型和种类（值、引用或输出）组成，按从左到右的顺序考虑。出于这些目的，出现在形参类型中的方法的任何类型参数都不是通过其名称来标识的，而是通过它在方法的类型参数列表中的序号位置来标识的。方法的签名特别不包括返回类型、可以为最右边的参数指定的 params 修饰符，也不包括可选的类型参数约束。

请注意，此处*不*包括返回类型。然后我们有：

> 签名是类、结构和接口中成员重载的启用机制：
> 
> *   方法的重载允许类、结构或接口声明多个具有相同名称的方法，前提是它们的签名在该类、结构或接口中是唯一的。

就这样做的*动机*而言，如果表达式的类型取决于表达式的使用方式，那会使生活变得非常复杂。对于某些表达式（例如和 lambda 表达式）*是*这种情况，`null`但对于方法调用等则不然。你最终可能会遇到一些非常奇怪的情况：

```
public void Foo(int x) {}
public void Foo(long y) {}

public int Bar() {}
public long Bar() {}

Foo(Bar()); // What would this call? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:43:02.703

你为什么不只返回一个通用对象？在这种情况下，您可能不需要超载。

# jquery - Jquery幻灯片需要内容在悬停时保持打开

> ID：11216327
> 
> 赞同：2
> 
> 时间：2012-06-26T21:37:15.580
> 
> 标签：jquery

我的 jquery 幻灯片有问题。

```
$(document).ready(function() 
{
  $(".events").hover(function() 
  {
      $(this).next().slideToggle(400);
  }, function() {
      $(this).next().slideToggle(400);
  });
}); 
```

当我将鼠标悬停在我的图像上时，隐藏的内容会滑出，当我没有悬停时它会滑入，这很好，但我需要对其进行微调，以便当我将鼠标悬停在内容上时隐藏的内容将保持打开状态而不仅仅是图像。任何人都可以帮助我，我是网络设计的新手，并且已经坚持了一段时间。提前致谢。

我说得太快了，我尝试了上面的解决方案，但它不起作用。我的幻灯片甚至无法打开，当我只更改其中一个不确定问题是什么时，它阻止了我页面上的所有其他幻灯片打开。这是我的html：

信息文本在这里

–

嗨 thebiffboff 我将我的 html 和 css 复制到了你发送的小提琴链接并使用了你向我展示的解决方案，它运行良好，但它不会在我自己的页面中，我该如何寻找问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:55:19.287

您可以将图像和隐藏内容包装在包装器中，然后将悬停事件绑定到此包装器。我为您创建了一个示例[小提琴](http://jsfiddle.net/jMz6f/1/)。我还添加了清除当前动画队列的 .stop() 方法，否则如果您快速进出多次，幻灯片将在您完成后继续上下滑动。

# c# - 如何从 ImageSource 对象获取 Stream 以保存在图片库中？（Windows 电话 7，C#）

> ID：11216329
> 
> 赞同：1
> 
> 时间：2012-06-26T21:37:24.020
> 
> 标签：c#, silverlight, windows-phone-7, xna, stream

我有一个`ImageSource`对象（或者可能是一个`BitmapImage`对象）。我想使用类的`SavePicture`方法`MediaLibrary`（XNA 框架）将它保存到图片库中。我怎样才能做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T21:51:01.283

使用[WritableBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.aspx)并使用该方法对位图进行编码`SaveJpeg`，然后使用您保存图像的流作为 MediaLibrary 的参数。如果您使用`MemoryStream`.

msdn 上提供了完整的示例， http: [//msdn.microsoft.com/en-us/library/ff769549 (VS.92).aspx](http://msdn.microsoft.com/en-us/library/ff769549(VS.92).aspx)

# ruby-on-rails - 在文件中记录 ActionMailer 邮件

> ID：11216338
> 
> 赞同：1
> 
> 时间：2012-06-26T21:38:16.400
> 
> 标签：ruby-on-rails, actionmailer

有没有办法将 ActionMailer 邮件保存到文件中，作为在发送时记录已发送邮件的一种方式？

我有很多丢失的电子邮件，并希望将发送的邮件记录在文件中（即，我希望我的网站管理员查看电子邮件，因此除了将它们存储在我的常规日志中之外，将它们存储在文件中文件将有助于实现用户友好的解决方案）。

如果我可以访问已发送邮件的内容和收件人，那么我可以将它们保存到文件中，但是我找不到从 ActionMailer 中访问电子邮件内容的清晰方法。

有一个[类似的问题](https://stackoverflow.com/questions/5696627/best-way-to-log-actionmailer-sent-emails-in-a-database)，但唯一的答案并不能帮助我解决这个问题，一些实现这个问题的指针或实际代码会非常有帮助。

谢谢你。

# client - 客户端分拣机 - 可能吗？

> ID：11216340
> 
> 赞同：-2
> 
> 时间：2012-06-26T21:38:24.183
> 
> 标签：client

所以我想知道是否有可能制作一个客户端分类器，使客户端相互重叠。例如，如果我打开了 5 个浏览器并且我想让它们相互重叠，是否可以制作这样的程序？

我想将它用于一个游戏，我通常可能会打开多达 10 个客户端，因此有一个程序可以快速对它们进行排序会很好。

如果这是可能的。程序可以用Java编写还是应该用什么语言编写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:47:21.273

虽然你的问题很模糊（例如什么是客户？？？）我假设你的意思是你想以某种方式平铺你的窗户。此外，我假设您会很乐意使用现有程序（如果有的话）。有。看一眼

[http://en.wikipedia.org/wiki/Tiling_window_manager](http://en.wikipedia.org/wiki/Tiling_window_manager)

这正是我认为你正在寻找的。该页面也有指向现有程序的链接（有些是免费的）。

# django - django-crm 安装

> ID：11216347
> 
> 赞同：2
> 
> 时间：2012-06-26T21:38:50.973
> 
> 标签：django, crm, pip

我正在尝试安装 django-crm。我正在使用 pip 安装它：

```
pip install django-crm 
```

我正进入（状态：

```
Downloading/unpacking django-crm
  Could not find any downloads that satisfy the requirements django-crm
No distributions at all found for django-crm
Storing complete log in C:\users\User\AppData\Roaming\pip\pip.log 
```

编辑：

日志文件包括以下内容：

```
------------------------------------------------------------
C:\Python27\Scripts\pip-script.py run on 06/27/12 00:33:50
Downloading/unpacking django-crm
  Getting page http://pypi.python.org/simple/django_crm
  Could not fetch URL http://pypi.python.org/simple/django_crm: HTTP Error 404: Not Found
  Will skip URL http://pypi.python.org/simple/django_crm when looking for download links for django-crm
  Getting page http://pypi.python.org/simple/
  URLs to search for versions for django-crm:
  * http://pypi.python.org/simple/django_crm/
  Getting page http://pypi.python.org/simple/django_crm/
  Could not fetch URL http://pypi.python.org/simple/django_crm/: HTTP Error 404: Not Found
  Will skip URL http://pypi.python.org/simple/django_crm/ when looking for download links for django-crm
  Could not find any downloads that satisfy the requirement django-crm
No distributions at all found for django-crm
Exception information:
Traceback (most recent call last):
  File "C:\Python27\lib\site-packages\pip\basecommand.py", line 126, in main
    self.run(options, args)
  File "C:\Python27\lib\site-packages\pip\commands\install.py", line 223, in run
    requirement_set.prepare_files(finder, force_root_egg_info=self.bundle, bundle=self.bundle)
  File "C:\Python27\lib\site-packages\pip\req.py", line 954, in prepare_files
    url = finder.find_requirement(req_to_install, upgrade=self.upgrade)
  File "C:\Python27\lib\site-packages\pip\index.py", line 152, in find_requirement
    raise DistributionNotFound('No distributions at all found for %s' % req)
DistributionNotFound: No distributions at all found for django-crm 
```

谁能帮我吗？如何安装 django-crm？有没有我可以看到它的演示而不是自己安装它的地方？

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T23:12:55.463

由于 Django CRM 没有 PyPI 条目，请给 pip 可以找到包的位置：

```
$ pip install svn+http://django-crm.googlecode.com/svn/trunk/#egg=django-crm 
```

这个对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-20T08:05:12.503

在 github 中尝试所有新的 django crm

[https://github.com/MicroPyramid/Django-CRM](https://github.com/MicroPyramid/Django-CRM)

# java - 执行“gradle test”时如何仅包含某些Java类

> ID：11216353
> 
> 赞同：1
> 
> 时间：2012-06-26T21:39:21.190
> 
> 标签：java, unit-testing, junit, gradle

我在默认 Java 包和我的特定包中都有 JUnit 测试类。我的 Gradle 构建文件包含

```
test {
    include 'edu/ucar/unidata/sruth/'
} 
```

为了排除默认 Java 包中的 JUnit 测试类。它不起作用：a`gradle test`始终执行默认的 Java 包测试以及特定于包的测试（根据 的内容`build/reports/test`）。

如何仅执行特定于包的测试？

我正在使用 Gradle 1.0。

附录：执行`gradle cleanTest`解决了问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-05T02:15:52.040

我从 Gradle 官方文档中提取了以下部分，希望对[http://www.gradle.org/docs/current/userguide/java_plugin.html有所帮助](http://www.gradle.org/docs/current/userguide/java_plugin.html)

使用命令行选项的一些示例：

*   gradle test --tests org.gradle.SomeTest.someSpecificFeature
*   gradle test --tests *SomeTest.someSpecificFeature
*   gradle test --tests *SomeSpecificTest
*   gradle test --tests all.in.specific.package*
*   gradle 测试 --tests *IntegTest
*   gradle 测试 --tests *IntegTest*ui*
*   gradle someTestTask --tests *UiTest someOtherTestTask --tests *WebTest*ui

* * *

## 回答 #2

> 赞同：-13
> 
> 时间：2012-06-26T22:40:29.057

不确定 JUNIt 是什么，但如果你有两个同名的类，你必须指定你正在谈论的类......`import java.util.Scanner;`并使用它，你可以将它声明为`java.util.Scanner foo=new java.util.Scanner();`

# coldfusion - 通过 ColdFusion 和 VBScript Windows Server 2008 发送传真

> ID：11216354
> 
> 赞同：2
> 
> 时间：2012-06-26T21:39:31.123
> 
> 标签：coldfusion, vbscript, 64-bit, windows-server-2008, fax

这与[我启动的上一个线程](https://stackoverflow.com/questions/10590534/faxserver-alternative-for-windows-server-2008)有关，但它处理的是一种实际有效的方法。

我创建了一个由 ColdFusion 执行的 VBScript，并将传真发送到特定号码。以下是我编写的 VBScript，取自 Microsoft TechNet 站点：

```
Set objFaxDocument = WScript.CreateObject("FAXCOMEX.FaxDocument")
Set objFaxServer = WScript.CreateObject("FAXCOMEX.FaxServer")
Dim JobID

objFaxServer.Connect("")
objFaxDocument.Body = "C:\*PATHNAME*\testfax.pdf"
objFaxDocument.DocumentName = "My First Fax"
objFaxDocument.Priority = "2"

objFaxDocument.Recipients.Add("8885551212")

objFaxDocument.AttachFaxToReceipt = True

objFaxDocument.CoverPageType = "1"
objFaxDocument.CoverPage = "generic"
objFaxDocument.Note = "Here is the info you requested"
objFaxDocument.ReceiptAddress = "test@test.com"

objFaxDocument.Subject = "Today's fax"
objFaxDocument.Sender.Title = "Mr."
objFaxDocument.Sender.Name = "Test Man"
objFaxDocument.Sender.City = "Test City"
objFaxDocument.Sender.State = "FL"
objFaxDocument.Sender.Company = "Test Company"
objFaxDocument.Sender.Country = "USA"
objFaxDocument.Sender.Email = "test@test.com"
JobID = objFaxDocument.ConnectedSubmit(objFaxServer)
MsgBox("The Job ID is :" & JobID(0))

objFaxServer.Disconnect() 
```

以下是我用来执行这个 vbscript 的 ColdFusion 代码：

```
<cfexecute name="C:\Windows\System32\cscript.exe"
    arguments="C:\*SCRIPTPATH*\test.vbs">
</cfexecute> 
```

在装有 Windows Server 2003 的机器上，这成功地将文档发送到 Windows 传真服务应用程序，并将传真正确存储在发件箱中。但是，当我在 Windows Server 2008 上尝试此操作时，它不起作用。需要注意的是，虽然使用的是相同版本的 ColdFusion (8)，但 2008 机器是 64 位的，而 2003 是 32 位的。

这可能已经在其他地方得到了回答（如果是这样，请指导我），但我在这方面度过了最艰难的时期，并且没有多少成功的解决方案可供我找到。我知道我错过了一些东西，但我不知道是什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:08:32.603

This is difficult to answer that precisely because you don't quantify "does not work". In what way does it not work? Is there an error on the screen? Is there an error in the log files anywhere? Does the VBS get called, but does it then fail (it could be a vagary of how it's being called)?

That said, I suspect it's a case that the service account that CF is running under doesn't have permissions to access or execute the VBS, or some other resource the VBS uses.

If you login as the user CF uses, can you execute that statement from a command line?

# jquery - 使用 jQuery 动画让 div 从中心向下滑动？

> ID：11216356
> 
> 赞同：0
> 
> 时间：2012-06-26T21:39:45.023
> 
> 标签：jquery, css, css-transitions

`.hide()`由于常规的 jQuery 动画在 iOS ( , )上不流畅`slideDown()`，我试图将我的速记`.fade()`和`.slideDown()`函数转换为速记`.animate()`函数，因此我可以使用[jQuery.Animate](http://playground.benbarnett.net/jquery-animate-enhanced/)插件将这些动画转换为 CSS3，同时维护一个 jQuery 后备。

我认为使用这种方法淡化一个 div 应该很容易，但是试图让一个 div 从中心滑下来让我很头疼。

div 的正常 CSS 是...

```
.zip{
    width:130px;
    height:70px;
    left:50%;
    top:50%;
    margin-top:-46px;
    margin-left:-76px;
    position: absolute;
    text-align: center;
    z-index: 2;
    background:rgba(0,155,23,.8) url(overlay.png);
    border-radius: 10px;
    padding:10px;
    border:1px solid #fff;
    box-shadow:0 0 40px #000;
} 
```

然后我使用以下延迟，然后让 div 向下滑动......

```
$(".zip").delay(1000).slideDown(200); 
```

显然，这很好用，但插件不会接收到它。

**那么，我怎么能把它变成一个函数`.animate()`呢？**

我的尝试：

CSS...

```
.zip{
    display:none;
    height:0;
    padding:0;
    /* Plus everything else */
} 
```

jQuery...

```
$('.zip').delay(1000).animate({
    display: "block",
    height: "70px",
    padding: "10px",
}); 
```

除了这是从左手角向下滑动，而不是从中间向下滑动。

**另外**，也许我做错了，有更好的方法在 iOS 设备上使用 CSS3 加速转换，同时仍然提供 jQuery 后备，在这种情况下，请分享！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:46:08.660

也为宽度和左边距设置动画。或者，您可以仅设置宽度动画并将边距设置为自动（这意味着水平居中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:52:44.047

您可以使用 slideDown()` 方法：

```
$('.zip').slideDown() 
```

[演示](http://jsfiddle.net/mHR98/1)

# wordpress - 尝试在 WordPress 中使用 swfobject.js youtube 对象

> ID：11216357
> 
> 赞同：0
> 
> 时间：2012-06-26T21:39:47.623
> 
> 标签：wordpress, video, youtube, swfobject, mute

我需要使用 swfobject api 的额外功能。此对象是一种将 Youtube 视频嵌入网站的新方法。

将我从 Google 教程中找到的代码直接粘贴到 WordPress 编辑器中是无效的。WordPress 不会将此视为活动代码。

所以，我创建了一个新的模板文件并将我的代码插入到该文件中。这工作相对较好。代码上线了，我得到了我正在寻找的额外功能，那就是我能够拥有视频自动播放的视觉效果，并默认静音。

但是，这弄乱了我在视频上方的菜单的布局和流程。

谁能告诉我把这段代码放在哪里合适的地方，或者这个问题太具体了。如果它对您有帮助，您可以在以下位置查看混乱的页面：

[http://bestoftimesusa.com/home-mute-test/](http://bestoftimesusa.com/home-mute-test/)

以及它应该如何看待：

[http://bestoftimesusa.com](http://bestoftimesusa.com)

嵌入的功能齐全的代码是这样的：

```
 <script type="text/javascript" src="/wp-includes/js/swfobject/swfobject.js"></script>    

                 <div id="ytapiplayer">
                       You need Flash player 8+ and JavaScript enabled to view this video.
                 </div>

                 <script type="text/javascript">
                   var ytplayer = false;
                   var params = { allowScriptAccess: "always" };
                   var atts = { id: "myytplayer" };
                   swfobject.embedSWF("http://www.youtube.com/v/IBjstQceGBk?enablejsapi=1&playerapiid=ytplayer&version=3&autoplay=1",
                       "ytapiplayer", "370", "238", "8", null, null, params, atts);

                   function onYouTubePlayerReady(playerId) {
                      ytplayer = document.getElementById("myytplayer");
                      ytplayer.mute();

                      }

                    </script>
                    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:50:04.663

除非您希望相同的 youtube 视频出现在（某种类型的）所有页面上，否则我认为将整个块放在模板文件中是没有意义的。对模板文件真正有意义的唯一部分是第一行。之后的行是特定于视频的。

[默认情况下，WordPress 从帖子中过滤掉 javascript](http://codex.wordpress.org/Using_Javascript)。您可以使用允许您在帖子中包含 javascript [的插件](http://plugins.trac.wordpress.org/wiki/TextControl)禁用该过滤。

使用该插件，您可以在全局或每个帖子的基础上设置 javascript 过滤器。似乎每个帖子的基础对您有用，所以我会继续这样做，只需在我想要的页面上启用它即可。

最后两件事：

*   您可以将第一行放在一个模板文件中，以消除必须将其放在每个帖子中
*   你有一个开始`<div>`标签，但有两个结束`</div>`标签，这是可以预料的，但我会仔细检查。

# jquery - 是否有一种合法的方法可以为全日历插件创建自定义视图？

> ID：11216362
> 
> 赞同：4
> 
> 时间：2012-06-26T21:40:09.907
> 
> 标签：jquery, jquery-plugins, fullcalendar

使用 fullcalendar 插件，这很好，非常适合我的需要，我必须创建一个这样的日历视图：
![在此处输入图像描述](../Images/910531369ddab7af220aca7f5634ba44.png)
如您所见，这里的每一列都是默认的 dayView 列，从功能来看。我查看了来自 github 的 fullcalendar 资源，但如果可能的话，仍然看不到如何做到这一点。

# r - 直接将doMC（foreach）的结果分配给数据框

> ID：11216364
> 
> 赞同：-2
> 
> 时间：2012-06-26T21:40:20.393
> 
> 标签：r, foreach, parallel-processing, domc

假设我有示例代码

```
kkk<-data.frame(m.mean=1:1000, m.sd=1:1000/20)
kkk[,3:502]<-NA

for (i in 1:nrow(kkk)){
  kkk[i,3:502]<-rnorm(n=500, mean=kkk[i,1], sd=kkk[i,2])
} 
```

我想将此函数转换为与`doMC`. 我的问题是`foreach`结果是一个列表，而我需要每次迭代的结果是一个向量，然后可以将其传输到数据框（稍后将作为 CVS 导出以进行进一步处理）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:46:26.447

您不需要循环，并且将大量数字矩阵放入数据框中只是为了将其视为矩阵是低效的（尽管您可能需要在按顺序完成所有数学运算*后*在最后创建一个数据框写入 CSV 文件）。

```
m.mean <- 1:1000
m.sd <- 1:1000/20
num.columns <- 500
x <- matrix(nrow=length(m.mean), ncol=num.columns, 
            data=rnorm(n=length(m.mean) * num.columns))
x <- x * cbind(m.sd)[,rep(1,num.columns)] + cbind(m.mean)[,rep(1,num.columns)]
kkk <- data.frame(m.mean=m.mean, m.sd=m.sd, unname(x))
write.csv(kkk, "kkk.txt") 
```

要回答有关从 foreach 循环直接将结果分配给现有数据结构的原始问题，这是不可能的。foreach 包的并行后端设计为在单独的 R 进程中执行每个计算，因此每个都必须向父进程返回一个单独的对象，父进程使用`.combine`提供给 foreach 的函数收集它们。您可以编写一个并行的 foreach 循环，将其直接分配给`kkk`变量，但这不会产生任何影响，因为每个分配都将发生在单独的进程中，并且不会与主进程共享。

# wpf - XamDataGrid XamTabControl WPF MVVM 特殊行为

> ID：11216370
> 
> 赞同：0
> 
> 时间：2012-06-26T21:40:44.607
> 
> 标签：wpf, mvvm, mvvm-light, xamdatagrid

我在实现以下场景时遇到了问题：

当用户在 XamDataGrid 中选择记录时，控件会流入另一个选项卡，显示所选记录的详细信息。

我这样做的方式是：

在 XamDataGrid 的选择更改中，我正在发送要使用 MVVM Light Messenger 激活的选项卡的索引。

将绑定到选项卡控件的选择索引的属性设置为该数字。

一切顺利，直到这里。Afetr 如果我回到包含网格的选项卡，控件会以某种方式返回到已激活的选项卡。

好像，网格中发生了一些内在的单元格选择。悬停是否也会影响 xamdatagrid 的选择？

我是 Infragistics 的新手，有点困惑。如果有人可以提供帮助。

所有代码都在 View Model 文件中，xaml 文件后面的代码中没有代码。

干杯，

安舒曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T13:49:37.320

我玩了很多。但获得此工作的唯一方法是禁用所有悬停动画和效果。现在它按预期工作！

# mysql - 如何在 JPA 2 / Hibernate 中生成可移植和原生 ID？

> ID：11216375
> 
> 赞同：5
> 
> 时间：2012-06-26T21:41:00.187
> 
> 标签：mysql, hibernate, jpa-2.0, java-ee-6

我想在我的 JPA 2 实体上生成本机和可移植的 id，目前正在运行 Hibernate 和 MySQL

使用@GeneratedValue(strategy=AUTO) 时，休眠默认为 MySQL 上的“hibernate_sequence”表，我想要 IDENTITY

如果我使用@GeneratedValue(strategy=IDENTITY) 解决它，我会失去 Oracle/Postgres 的可移植性

当@GeneratedValue strategy=AUTO 时，如何设置 Hibernate 以使用 IDENTITY 作为 mysql 的默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T06:14:15.833

如果不更改 Hibernate 中的代码，您将无法影响它。一种解决方法是为每个具有不同 id 要求的数据库使用不同的映射集（xml 而不是注释）。这当然是相当多的事情。

唯一真正独立于数据库供应商工作的可移植方式是使用 TABLE 策略生成 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T03:42:31.020

您可以编写自己的自定义生成器，也可以在数据库上调用函数/存储过程来创建所需的身份。
看看[这里](http://blog.anorakgirl.co.uk/2009/01/custom-hibernate-sequence-generator-for-id-field/)，这是一个博客，里面有关于如何做我刚刚写的东西的很好的例子。

# jsoup - http客户端与jsoup的连接

> ID：11216385
> 
> 赞同：1
> 
> 时间：2012-06-26T21:42:11.610
> 
> 标签：jsoup, apache-commons-httpclient

我正在研究如何抓取信息。我对http客户端与jsoup的关系有点困惑。使用jsoup需要http客户端，还是jsoup可以代替http客户端？如果你还需要 http 客户端，它执行的哪些功能是 jsoup 自己无法完成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T04:21:55.523

> *使用jsoup需要http客户端吗*

不，Jsoup 可以完全独立使用。它没有*任何*依赖项（当然，Java SE 除外）。

* * *

> *或者jsoup可以代替http客户端吗？*

不，它是具有完全不同目的的工具。

* * *

> *如果你还需要 http 客户端，它执行的哪些功能是 jsoup 自己无法完成的？*

发送 HTTP 请求的更高级和更方便的方式。例如，自动 cookie（会话）管理、发送`multipart/form-data`请求（上传文件）等。

如果您只需要发送一个 GET 请求并且会话管理不相关，那么 Jsoup 可以毫不费力地为您完成这项工作。但是如果登录和会话管理是强制性的，那么您需要在每个 Jsoup 请求期间手动复制 cookie。这可能会导致一些样板代码。使用 HttpClient 处理 HTTP 请求，然后通过 Jsoup 传递其响应就更容易了。

### 也可以看看：

*   [如何使用 JSoup 发布文件？](https://stackoverflow.com/questions/7370771/how-to-post-files-using-jsoup)
*   [如何以编程方式将文件上传到网站？](https://stackoverflow.com/questions/8623870/how-can-i-programmatically-upload-a-file-to-a-website)

# php - 无法使用 CURL 和 PHP 加载动态内容

> ID：11216389
> 
> 赞同：0
> 
> 时间：2012-06-26T21:42:18.880
> 
> 标签：php, security, curl

美好的一天和问候！我正在创建一个简单的网页来获取用户并从 Form 传递，并使用 CURL 将这些变量发布到另一个页面以登录，然后显示结果返回（我将从这里开始，然后继续访问不同的页面）。问题是网站的某些内容是动态加载的（小部件）。因此，当我得到结果时，网站的框架会加载，但小部件没有呈现。从第二个站点加载小部件时出错： **“ptBaseURI = String(location).match(//ps(c ...”** 这可能是会话问题吗？我的 php 代码：

```
$post_data['pwd']=$_REQUEST['password'];
foreach ($post_data as $key => $value){
$post_items[]=$key . '=' . $value;
}
$post_string = implode ('&',$post_items);
$tmp_file_name=tempnam("/tmp/","COOKIE");
$curl_handle=curl_init('www.targetsite.com/...');
curl_setopt($curl_handle, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
//curl_setopt($curl_handle, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl_handle, CURLOPT_COOKIEJAR,$tmp_file_name);
curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER,true);
//curl_setopt($curl_handle, CURLOPT_POSTFIELDS, $post_string);
$result = curl_exec($curl_handle);
$curl_handle=curl_init('www.targetsite.com/...');
curl_setopt($curl_handle, CURLOPT_COOKIEFILE,$tmp_file_name);
curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER,true);
curl_setopt($curl_handle, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($curl_handle, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl_handle, CURLOPT_POSTFIELDS, $post_string);
$result = curl_exec($curl_handle);
$cArray = curl_getinfo($curl_handle);
$newURL = $cArray[url];
echo str_replace('</head>','<base href="'.$newURL.'" /></head>',$result); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:47:20.217

在结果上，您可以使用： $result = str_replace('', '', $result);

那么broser应该加载正确的页面，但没有登录cookie。

另一种方法是设置重写规则以获取这些请求，并使用 curl 转发请求以获取登录 cookie 的所需页面。

# javascript - 如何通过'POST'方法将数据从Javascript传递到Python

> ID：11216390
> 
> 赞同：1
> 
> 时间：2012-06-26T21:42:30.710
> 
> 标签：javascript, python, ajax, post, webapp2

我的 GAE 应用程序中有这部分脚本，它使用 webapp2，它接受来自使用 post 的表单的数据，

```
class RenderMarksheet(webapp2.RequestHandler):
   def post(self):
     regno = self.request.get('content')  # Here's where I extract the data from the form
     ...
     ...
     ...
     self.response.out.write(template.render(templates/render.html, template_values)) 
```

以及发布到此脚本的网络表单，

```
<form action="/sign" method="post" name="inputform" onsubmit="return validate()">
    Register No : <input type="number" name="regno" placeholder="Your Register No."/> 
                  <input type="submit" value="Get-My-GPA!" >
</form> 
```

现在，我想手动传递一个特定的数据（一个注册号），而不使用表单中的提交按钮，到 python 脚本（或者 url，也许），使用 Javascript，比如说一个触发 javascript 方法的按钮。

我必须使用 javascript 发布数据（以实现 AJAX）。在python中我这样做，将数据发布到一个url，

```
import http.client, urllib.parse
params = urllib.parse.urlencode({'regno':10109104021})
headers = {"Content-type": "application/x-www-form-urlencoded",
       "Accept": "text/plain"}
conn = http.client.HTTPConnection("mydomain:8888")
conn.request("POST", "/sign", params, headers)
response = conn.getresponse()
print(response.status, response.reason)
data = response.read() 
```

如何通过 Jquery 或 Javascript 将数据发布到 url？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:45:30.917

最快的是使用jQuery并使用`$.post()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:53:14.513

我不是 100% 确定你想要做什么，但经过几次重读，这就是我认为你想要做的事情。

你需要导入 urllib2

```
#import google classes
import urllib2

class RenderMarksheet(webapp2.RequestHandler):
   def parseResponse(self, response):
        #run some code in here to parse the results since it's an HTML document ... beautifulsoup, perhaps?

   def post(self):
     regno = self.request.get('content')  
     rawlink = "http://result.annauniv.edu/cgi-bin/result/result11gr.pl?regno="  
     link = rawlink+regno 
     try:
       result = urllib2.urlopen(link)
       gpa = parseResponse(result)
     except urllib2.URLError, e:
       self.response.out.write(e)

     template_values =  {'gpa': gpa}

     self.response.out.write(template.render(templates/render.html, template_values)) 
```

这种方法将

1.  从表单中获取输入
2.  建立链接
3.  从 annauniv 网络服务器请求信息
4.  解析来自该服务器的响应（您自己解析，但无论如何您都必须这样做）
5.  将 GPA 存储为模板字典以在模板中使用

# javascript - 如何处理 Backbone.js 应用程序中 hashchange 的滚动位置？

> ID：11216392
> 
> 赞同：27
> 
> 时间：2012-06-26T21:42:36.947
> 
> 标签：javascript, jquery, backbone.js

我已经阅读了许多相关线程，但似乎没有一个提供解决方案。

我要做的是在我的 Backbone.js 应用程序中智能地处理滚动条。像许多其他人一样，我有多个#mypage 哈希路由。其中一些路线是分层的。例如，我有一个列出一些项目的#list 页面，我单击列表中的一个项目。然后它会打开一个#view/ITEMID 页面。

我的页面都在 HTML 布局中共享相同的 Content div。在导航更改时，我将代表该路由视图的新 div 注入到 Content div 中，替换之前的任何内容。

所以现在我的问题：

如果该项目在列表中的位置很靠后，我可能需要滚动才能到达那里。当我单击它时，“默认”主干行为是 #view/ITEMID 页面显示在与 #list 视图相同的滚动位置。修复它很容易；只需在注入新视图时添加 $(document).scrollTop(0) 即可。

问题是如果我点击后退按钮，我想回到之前滚动位置的#list 视图。

我试图对此采取明显的解决方案。在内存中存储滚动位置的路线图。我在 hashchange 事件的处理程序开始时写入此映射，但在新视图实际放入 DOM 之前。在新视图位于 DOM 之后，我从 hashchange 处理程序末尾的地图中读取。

我注意到的是，至少在 Firefox 中的某个地方，正在滚动页面作为 hashchange 事件的一部分，因此当我的写入地图代码被调用时，文档的滚动位置不稳定绝对不是用户明确制作的。

任何人都知道如何解决这个问题，或者我应该使用的最佳实践？

我仔细检查了一下，我的 DOM 中没有与我正在使用的哈希匹配的锚标记。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-01T18:02:36.847

我对此的解决方案最终没有我想要的那么自动化，但至少它是一致的。

这是我保存和恢复的代码。这段代码几乎是从我的尝试转移到我的实际解决方案中的，只是在不同的事件中调用它。“软”是一个标志，它来自浏览器操作（后退、前进或哈希单击），而不是对 Router.navigate() 的“硬”调用。在 navigate() 调用期间，我只想滚动到顶部。

```
restoreScrollPosition: function(route, soft) {
    var pos = 0;
    if (soft) {
        if (this.routesToScrollPositions[route]) {
            pos = this.routesToScrollPositions[route];
        }
    }
    else {
        delete this.routesToScrollPositions[route];
    }
    $(window).scrollTop(pos);
},

saveScrollPosition: function(route) {
    var pos = $(window).scrollTop();
    this.routesToScrollPositions[route] = pos;
} 
```

我还修改了 Backbone.History，以便我们可以区分对“软”历史更改（称为 checkUrl）做出反应与以编程方式触发“硬”历史更改之间的区别。它将这个标志传递给路由器回调。

```
_.extend(Backbone.History.prototype, {

    // react to a back/forward button, or an href click.  a "soft" route
   checkUrl: function(e) {
        var current = this.getFragment();
        if (current == this.fragment && this.iframe)
            current = this.getFragment(this.getHash(this.iframe));
        if (current == this.fragment) return false;
        if (this.iframe) this.navigate(current);
        // CHANGE: tell loadUrl this is a soft route
        this.loadUrl(undefined, true) || this.loadUrl(this.getHash(), true);
    },

    // this is called in the whether a soft route or a hard Router.navigate call
    loadUrl: function(fragmentOverride, soft) {
        var fragment = this.fragment = this.getFragment(fragmentOverride);
        var matched = _.any(this.handlers, function(handler) {
            if (handler.route.test(fragment)) {
                // CHANGE: tell Router if this was a soft route
                handler.callback(fragment, soft);
                return true;
            }
        });
        return matched;
    },
}); 
```

最初我试图在 hashchange 处理程序期间完全进行滚动保存和恢复。更具体地说，在路由器的回调包装器中，调用您的实际路由处理程序的匿名函数。

```
route: function(route, name, callback) {
    Backbone.history || (Backbone.history = new Backbone.History);
    if (!_.isRegExp(route)) route = this._routeToRegExp(route);
    if (!callback) callback = this[name];
    Backbone.history.route(route, _.bind(function(fragment, soft) {

        // CHANGE: save scroll position of old route prior to invoking callback
        // & changing DOM
        displayManager.saveScrollPosition(foo.lastRoute);

        var args = this._extractParameters(route, fragment);
        callback && callback.apply(this, args);
        this.trigger.apply(this, ['route:' + name].concat(args));

        // CHANGE: restore scroll position of current route after DOM was changed
        // in callback
        displayManager.restoreScrollPosition(fragment, soft);
        foo.lastRoute = fragment;

        Backbone.history.trigger('route', this, name, args);
    }, this));
    return this;
}, 
```

我想以这种方式处理事情，因为它允许在所有情况下保存，无论是 href 单击、后退按钮、前进按钮还是 navigate() 调用。

浏览器有一个“功能”，它试图记住你在 hashchange 上的滚动，并在返回到 hashchange 时移动到它。通常这会很棒，并且可以省去我自己实现它的所有麻烦。问题是我的应用程序和许多应用程序一样，会在页面之间更改 DOM 的高度。

例如，我在一个高大的#list 视图上并滚动到底部，然后单击一个项目并转到一个根本没有滚动条的短#detail 视图。当我按下返回按钮时，浏览器会尝试将我滚动到#list 视图的最后一个位置。但是文件还没有那么高，所以它不能这样做。当我的#list 路线被调用并重新显示列表时，滚动位置已丢失。

所以，不能使用浏览器内置的滚动内存。除非我将文档设置为固定高度或做了一些 DOM 诡计，这是我不想做的。

此外，内置的滚动行为会破坏上述尝试，因为调用 saveScrollPosition 为时已晚——浏览器到那时已经更改了滚动位置。

对此应该很明显的解决方案是从 Router.navigate() 调用 saveScrollPosition 而不是路由回调包装器。这保证了我在浏览器对 hashchange 执行任何操作之前保存滚动位置。

```
route: function(route, name, callback) {
    Backbone.history || (Backbone.history = new Backbone.History);
    if (!_.isRegExp(route)) route = this._routeToRegExp(route);
    if (!callback) callback = this[name];
    Backbone.history.route(route, _.bind(function(fragment, soft) {

        // CHANGE: don't saveScrollPosition at this point, it's too late.

        var args = this._extractParameters(route, fragment);
        callback && callback.apply(this, args);
        this.trigger.apply(this, ['route:' + name].concat(args));

        // CHANGE: restore scroll position of current route after DOM was changed
        // in callback
        displayManager.restoreScrollPosition(fragment, soft);
        foo.lastRoute = fragment;

        Backbone.history.trigger('route', this, name, args);
    }, this));
    return this;
},

navigate: function(route, options) {
    // CHANGE: save scroll position prior to triggering hash change
    nationalcity.displayManager.saveScrollPosition(foo.lastRoute);
    Backbone.Router.prototype.navigate.call(this, route, options);
}, 
```

不幸的是，这也意味着如果我对保存滚动位置感兴趣，我总是必须显式调用 navigate()，而不是仅在模板中使用 href="#myhash"。

那好吧。有用。:-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-04T19:08:53.857

一个简单的解决方案：将列表视图在每个滚动事件上的位置存储在一个变量中：

```
var pos;
$(window).scroll(function() {
    pos = window.pageYOffset;
}); 
```

从项目视图返回时，将列表视图滚动到存储的位置：

```
window.scrollTo(0, pos); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T21:06:03.393

我对此有一个稍微穷人的解决方案。在我的应用程序中，我遇到了类似的问题。我通过将列表视图和项目视图放入容器中解决了这个问题：

```
height: 100% 
```

然后我将列表视图和项目视图都设置为：

```
overflow-y: auto
height: 100% 
```

然后，当我单击一个项目时，我会隐藏列表并显示项目视图。这样，当我关闭项目并返回列表时，我就可以保留我在列表中的位置。它与后退按钮一起工作一次，但显然它不会保留您的历史记录，因此多次单击后退按钮不会让您到达您需要的位置。尽管如此，没有JS的解决方案，所以如果它足够好......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-28T17:13:45.187

@ Mirage114 感谢您发布您的解决方案。它就像一个魅力。只是一件小事，它假设路由功能是同步的。如果存在异步操作，例如在渲染视图之前获取远程数据，则在将视图内容添加到 DOM 之前滚动窗口。就我而言，我在第一次访问路线时缓存数据。这样当用户点击浏览器的后退/前进按钮时，就可以避免获取数据的异步操作。但是，可能并不总是可以缓存路线所需的所有数据。

# android - 在调试模式下在运行时检查 Android 视图层次结构？

> ID：11216396
> 
> 赞同：4
> 
> 时间：2012-06-26T21:42:56.900
> 
> 标签：android, android-layout

我正在进行一项活动，但找不到特定视图。即 findViewById(R.layout.someId) 返回 null。因此，我只想查看当前活动的实际视图层次结构在运行时是什么。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-10T23:25:50.833

由于我无法理解的原因，这个措辞完美的问题被否决了。

以及非常直接的答案：

***是的，您可以使用 SDK HierarchyViewer 工具在运行时查看整个布局树***

隐藏在一个 youtube 链接后面，该链接不断被插入到对原始问题说其他内容或评论的答案中。

这是 HV 当前文档的链接： [https ://developer.android.com/tools/debugging/debugging-ui.html](https://developer.android.com/tools/debugging/debugging-ui.html)

请注意，YouTube 视频说这只能与在模拟器中运行的应用程序一起使用，但文档说它也可以在“运行 Android 系统开发人员版本的设备”上运行。我当然不会使用开发版操作系统运行我自己的 Android 手机，我在大部分开发测试中都使用它，所以我认为 YouTube 视频即使在技术上不正确也是有效的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T21:54:13.837

我相信`findViewById`需要一个参数，`R.id.someid`它不能采用布局。对于布局，您必须使用`setContentView(R.layout.someId);`

[http://www.youtube.com/watch?v=PAgE7saQUUY](http://www.youtube.com/watch?v=PAgE7saQUUY)

# javascript - 来自 Javascript 的 Objective-C 调用

> ID：11216400
> 
> 赞同：0
> 
> 时间：2012-06-26T21:43:34.827
> 
> 标签：javascript, objective-c, uiwebview

我正在尝试在从 UIWebView 调用的 Javascript 和 Objective-C 调用之间编写一些桥梁。我发现很多这样的问题，他们都说我应该捕获 Javascript 调用

```
-(BOOL) webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

好的，这很容易（也是唯一的？）方法，所以我正在寻找那个方向。

这些问题的所有答案都说“从 webView 解析 url，然后在 if-else 的帮助下向 Objective-C 类发送消息”。我在 Javascript 中有超过 10 个函数，所以我不想手动解析它们（这些函数会有 js 对象的数组作为参数等等）。

所以问题是：是否有任何轻量级库或开源项目可以将 obj-C 选择器和参数转换/取消转换为字符串？（我对 Javascript 不太熟悉，但我认为做同样的事情比在 obj-C 中容易得多，所以主要问题是关于 obj-C）

PS 我找到了 QuickConnectOC 库，但我不确定我是否可以使用它 PPS 我认为编写自己的解析器并不难......但我不想重新发明轮子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T21:27:51.663

最好的解决方案似乎是：

在 js 中：从需要调用的方法名称中生成字符串，然后将 js 参数作为一个对象添加到字符串中，然后将此字符串发送到 WebView

在 objC 中：通过我自己的方法名称获取，然后使用[jsonkit](https://github.com/johnezang/JSONKit)获取带有参数的完整字典（可以是字典数组等）

# c# - 什么会导致 GPIB 无响应

> ID：11216401
> 
> 赞同：2
> 
> 时间：2012-06-26T21:43:43.250
> 
> 标签：c#, python, visa, gpib

我有一个 GPIB 设备，我正在使用 National Instruments USB 转 GPIB 进行通信。USB转GPIB很好用。

我想知道什么会导致 GPIB 设备无响应？如果我关闭设备并重新打开它会响应，但是当我运行我的程序时它会首先响应。然后它切断了我什至无法与它只是超时的 GPIB 设备通信。

我填满缓冲区了吗？

**来自另一位提问者的一些细节**

我正在使用 PyVisa 控制 National Instruments GPIB 卡（不是 USB）。GPIB 总线上的仪器是 Newport ESP300 运动控制器。在几个小时的会话期间（一直向 ESP300 发送命令和从 ESP300 读取），ESP300 有时会停止收听并变得无响应。所有读取都超时，甚至没有`*idn?`产生响应。

我能做些什么来清除这种状态吗？例如，驾驶 IFC 生产线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T02:59:26.353

应该有一个明确的命令（类似`"*CLS?"`，但不要引用我的话）。当我第一次连接到设备时，我总是运行它。然后确保你有一个好的超时时间。我发现我的设备大约需要 1 秒。不到 1 秒就完成了，所以我错过了写入后的读取。大多数情况下，超时是因为您刚刚错过了它，或者您正在阅读一个没有返回的命令。确保您还在写入之间检查错误队列中的错误，以确保写入时正确正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-02T09:49:27.720

由于您使用的是 National Instruments 硬件，您可以在后台运行 NI Trace 以检查从程序发出的所有命令。在 Trace 中，请检查最后一个命令及其参数，这些命令是从导致硬件挂起的程序发出的。

[您可以在此处下载 NI IO Trace](http://www.ni.com/download/ni-io-trace-14.0.1/4914/en/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-06T15:01:10.190

如果设备不再监听（这里可能就是这种情况），即使命令 *CLS 也将不起作用。强制重置设备接口的唯一方法是发送低级 gpib 总线消息“Selected Device Clear”（它由标准 gpib 库的函数“ibclr”实现，例如[https ://www.l-com.com/multimedia/manuals/M_USB-488.PDF](https://www.l-com.com/multimedia/manuals/M_USB-488.PDF)第 3-7 页，但我不知道 Python 中的等价物是什么）。此命令旨在在发生 GPIB 错误时使用，我一直在这样做并且从未遇到过问题。为了使它正常工作，您还应该监视所有 gpib 调用的返回值 - 通常人们不会这样做，因此在程序挂起之前他们不会意识到错误。

# sql - 当且仅当一个 id 链接到 SQL Server CE 中第二个表中的多行时，如何将两个表连接在一起？

> ID：11216405
> 
> 赞同：2
> 
> 时间：2012-06-26T21:44:31.527
> 
> 标签：sql, sql-server-ce

我不知道我的标题是否正确传达了我想要实现的查询，所以请编辑或建议一个更正确的更好的查询。我正在尝试将这两个表连接在一起：

表 1：**人**

```
id |field1|field2|
------------------
1  
2
3
4
.
.
. (etc) 
```

表 2：**食物**

```
person.id | name
1         | chicken
1         | pork
1         | beef
2         | pork
2         | chicken
3         | chicken
4         | beef
.
. (etc) 
```

我需要根据搜索 ID 与猪肉或鸡肉*都匹配的任何人来加入这些表。*例如，如果我搜索`pork`，应该返回 1 和 2，如果我搜索`pork`and `chicken`，仍然应该返回 1 和 2，但是 3 不会是因为它不`chicken`匹配`pork`。如果我搜索`pork`、`chicken`和`beef`，则应该只返回 1。

我一直在看[这个问题](https://stackoverflow.com/questions/10012695/sql-statement-using-where-clause-with-multiple-values)，但我不知道我要搜索多少项目（我可能会搜索`pork`and`chicken`一次，and `pork`、`chicken`或`beef`另一次）。

我开始尝试基本`WHERE`条款，我相当肯定它是错误的（我确认了这一点，因为查询不起作用）：

```
SELECT p.id 
FROM people p, foods f 
WHERE p.id = f.person_id AND (f.name = 'pork' AND f.name = 'chicken') 
```

但这不会返回任何结果。我似乎记得几年前的 SQL 教程中我应该将[`EXISTS`](http://msdn.microsoft.com/en-us/library/ms174632)关键字与子查询一起使用，但我不确定如何根据它来塑造我的查询/查询。

编辑：SQL Server CE 不支持该`INTERSECT`关键字，所以很遗憾我无法使用该选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:11:03.663

如果您可以构建您的列表`('chicken', 'pork', 'beef')`并计算应用程序中的项目：

```
SELECT p.*
FROM   people AS p
  JOIN (
   SELECT person_id
   FROM   foods
   WHERE  name IN ('chicken', 'pork', 'beef')   --- list
   GROUP  BY person_id
   HAVING COUNT(*) = 3                          --- list size
   ) AS pf ON pf.person_id = p.id ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T21:50:08.150

改为使用 group by：

```
select id
from foods
where name in (<list of foods>)
group by id
having count(*) = <size of list> 
```

您可以 - 恐怖的恐怖 - 实际上将列表存储在字符串中并获得正确的结果。假设你有：

```
declare @foodlist varchar(8000) = 'pork,chicken' 
```

然后以下查询有效：

```
select id
from foods
where charindex(','+name+',', ','+@foodlist+',') > 0
group by id
having count(*) = 1 + len(@foodlist) - len(replace(@foodlist, ',', '')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:06:48.730

```
SELECT p.id 
FROM people p INNER JOIN foods f 
ON p.id = f.person_id 
WHERE f.name in (`list of f.name`) 
```

> 如果我搜索猪肉、鸡肉和牛肉，则不应返回任何内容

根据您的表**1**应该返回。

# c++ - CMake - 同一项目中的应用程序/库之间的依赖项（标头）

> ID：11216408
> 
> 赞同：21
> 
> 时间：2012-06-26T21:44:36.523
> 
> 标签：c++, visual-studio-2010, dependencies, cmake, header-files

我有以下项目结构：

*   CMakeLists.txt
    *   lib1/CMakeLists.txt 和 lib 的所有 cpp 和头文件
    *   lib2/CMakeLists.txt 和 lib 的所有 cpp 和头文件
    *   app/CMakeLists.txt 以及应用的所有cpp和头文件

主要的 CMakeLists.txt 看起来像：

```
PROJECT( ${PROJECT_NAME} )
add_subdirectory(lib1)
add_subdirectory(lib2)
add_subdirectory(app) 
```

lib1/CMakeLists.txt 看起来像（剥离）：

```
SET(SOURCE
file.cpp
)
SET(HEADERS
    some_lib_header.h
)
add_library( lib1 ${SOURCE} ${HEADERS} ) 
```

除了 ADD_EXECUTABLE 之外，该应用程序的外观相同：

```
SET(SOURCE
main.cpp
)
SET(HEADERS
    some_header.h
)
add_library( lib1 ${SOURCE} ${HEADERS} )
ADD_EXECUTABLE( app ${SOURCE} ${HEADERS} ) 
```

我发现这种设置运行良好，因为这样，我可以生成一个包含所有这三个项目的 Visual Studio 解决方案文件。但我的问题是我的应用程序包含 lib1 的头文件（以及依赖于 lib1 的 lib2 的头文件）。当我做

```
$mkdir build
$cd build
$cmake -C ..\myproject 
```

它会根据我的需要生成源外的 VS .sln 文件，但该应用程序无法编译，因为它找不到 lib1 的头文件（显然）。

现在我阅读并尝试了很多东西，比如`TARGET_LINK_LIBRARIES( app lib1 )`（让应用程序与 lib1 链接，但没有解决头文件包含问题），以及`add_subdirectory( ../lib1 )`应用程序的 CMakeLists.txt 中的各种变体（所有这些都引发了我不能't fix），还有 find_package （我猜这是错误的方法）。

那么我该如何解决这个（我猜很简单......）问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-26T22:47:18.507

这是一种可能的解决方案：

根 CMakeLists.txt：

```
cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
project(${PROJECT_NAME})
add_subdirectory(lib1)
add_subdirectory(lib2)
add_subdirectory(app) 
```

lib1/CMakeLists.txt：

```
project(Lib1)
add_library(lib1 lib1.cpp lib1.h) 
```

lib2/CMakeLists.txt：

```
project(Lib2)
add_library(lib2 lib2.cpp lib2.h)

# Add /lib1 to #include search path
include_directories(${Lib1_SOURCE_DIR})
# Specify lib2's dependency on lib1
target_link_libraries(lib2 lib1) 
```

应用程序/CMakeLists.txt：

```
project(App)
add_executable(app main.cpp some_header.h)

# Add /lib1 and /lib2 to #include search path
include_directories(${Lib1_SOURCE_DIR} ${Lib2_SOURCE_DIR})
# Specify app's dependency on lib2.
# lib2's dependency on lib1 is automatically added.
target_link_libraries(app lib2) 
```

这里有很多不同的方法可以达到相同的最终结果。对于一个相对较小的项目，我可能只使用一个 CMakeLists.txt：

```
cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
project(Test)

add_library(lib1 lib1/lib1.cpp lib1/lib1.h)
add_library(lib2 lib2/lib2.cpp lib2/lib2.h)
add_executable(app app/main.cpp app/some_header.h)

include_directories(${CMAKE_SOURCE_DIR}/lib1 ${CMAKE_SOURCE_DIR}/lib2)

target_link_libraries(lib2 lib1)
target_link_libraries(app lib2) 
```

有关相关命令及其原理的更多信息，请运行：

```
cmake --help-command add_subdirectory
cmake --help-command include_directories
cmake --help-command target_link_libraries 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-10T14:30:17.360

```
Project
 CMakeLists.txt
 \-lib1
   CMakeLists.txt
   \- include \ lib1
   \- src
 \-lib2
   CMakeLists.txt
   \- include \ lib2
   \- src
 \-app
   CMakeLists.txt
   \- src 
```

假设依赖关系如下：

```
lib1 ---> lib2 ---> app 
   \--------------> app 
```

像这样的东西：

CMakeLists.txt：

```
add_subdirectory(lib1)
add_subdirectory(lib2)
add_subdirectory(app) 
```

lib1/CMakeLists.txt：

```
 file(GLOB_RECURSE _HDRS "include/*.hpp")
  file(GLOB_RECURSE _SRCS "src/*.[hc]pp")
  add_library(lib1 ${_HDRS} ${_SRCS})
  #target_link_libraries(lib1)
  target_include_directories(lib1 PUBLIC include)

  install(TARGETS lib1 DESTINATION lib)
  install(FILES ${_HDRS} DESTINATION include/lib1) 
```

lib2/CMakeLists.txt：

```
 file(GLOB_RECURSE _HDRS "include/*.hpp")
  file(GLOB_RECURSE _SRCS "src/*.[hc]pp")
  add_library(lib2 ${_HDRS} ${_SRCS})
  target_link_libraries(lib2 lib1)
  target_include_directories(lib2 PUBLIC include)

  install(TARGETS lib2 DESTINATION lib)
  install(FILES ${_HDRS} DESTINATION include/lib2) 
```

所以在 lib2/src/file.cpp 你可以做`#include <lib1/header.hpp>`

应用程序/CMakeLists.txt：

```
 file(GLOB_RECURSE _SRCS "src/*.[hc]pp")
  add_executable(app ${_SRCS})
  target_link_libraries(app lib1 lib2)

  install(TARGETS app DESTINATION bin) 
```

所以在 app/src/file.cpp 你可以`#include <lib1/header.hpp>`做`#include <lib2/header.hpp>`

神奇的是[target_include_directories](https://cmake.org/cmake/help/latest/command/target_include_directories.html?highlight=target_include_directory)将“包含”目录附加到目标，因此在与它链接时，您也可以拉出包含目录；）

# database - 深度、可遍历的以自我为中心的图的缓存策略

> ID：11216410
> 
> 赞同：4
> 
> 时间：2012-06-26T21:44:42.340
> 
> 标签：database, performance, caching, d3.js, force-layout

**首先，让我解释一下我正在构建的内容：**

*   我有一个 D3.js 强制布局图，它植根于中心，周围散布着一堆节点。中心节点是某种实体，它周围的节点是与根有某种关联的其他实体。边缘是实际的关系（即两者是如何相关的）。

*   可以单击外部节点以使目标实体居中并加载其关系

*   该图是“以自我为中心”的，因为每次单击节点时，它都会成为中心，并且只显示与自身*直接相关的关系。*

**我的设置，以防万一：**

*   我通过 Node.js 提供 API，它将请求转换为对具有大量数据集的 CouchDB 服务器的查询。

*   D3.js 用于布局，除了 jQuery 和 Bootstrap，我没有使用任何其他客户端库。如果有任何对这个缓存任务有帮助的，我愿意接受建议:)

**我的想法：**

*   我每次都可以轻松地抓取图表的几个级别（通过多次列出和扩展子项的过程递归），但是由于单击任何给定节点会加载完全不相关的数据，因此不能保证产生高比例的类似数据为根加载的数据。这似乎完全是浪费，实际上是朝*相反*方向迈出的一步——我最终会以这种方式进行*更多*处理！

*   我可以轻松地维护已检索到的实体的哈希表，并在从服务器请求该实体的数据之前检查该列表。无论我实施何种缓存策略，我都可能最终会这样做，因为它是一种非常简单的减少查询的方法。

**现在，你建议我如何缓存这些数据？**

有没有什么超级有效的策略来做这种缓存？非常欢迎服务器和客户端选项。这个过程涉及*大量*数据，任何查询/处理的减少都让我领先于游戏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:14:00.653

在客户端，我将拥有节点，并且让它们的子节点要么是一组子节点，要么是作为这些子节点承诺的函数。当您单击给定节点时，如果您有数据，请立即显示它。否则发送将填充它的 AJAX 请求。

每当您显示一个节点（未居中）时，为显示的节点的子节点创建 AJAX 请求的异步列表并开始请求它们。这样当用户点击时，你就有可能已经缓存了它。如果没有，那么，您尝试过并且没有花费任何费用。

一旦你让它工作，决定多少层深度是有意义的。我的猜测是幻数很可能是 1。除此之外，响应速度的回报迅速下降，而服务器负载迅速上升。但是让点击尽快返回是一个相当大的 UI 胜利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T15:53:19.123

我认为你需要做两件事：

1.  减少您提出的请求数量
2.  降低请求成本

正如 btilly 指出的那样，您可能最好为每个可见节点请求相关节点，以便如果单击它们，则可视化会立即响应——您不希望查询加上传输时间作为响应滞后。

但是，如果您非常需要减少请求数量，则表明您的请求本身成本太高，因为总负载为`requestCost * numRequests`. 考虑寻找方法来预先计算与每个节点相关的节点集，以便请求是读取请求而不是完整的 DB 查询。如果您觉得这听起来很难，那么这正是您每次搜索新事物时 Google 所做的；他们无法在您每次开始输入时搜索互联网，因此他们会提前进行搜索并缓存。

这可能意味着一定程度的非规范化；如果您有缓存*和*查询，则不能保证它们是同步的，但问题是您的数据集是否更改；是一次写入，多次读取吗？

为了最小化所有这些节点及其关系所需的空间，更多地将其视为粒子相互作用问题；通过对空间进行分区，您可以对节点进行分组，以便您只需要查询一组节点的聚合邻居，并将其存储。这样，您可以对每个请求进行更小的过滤，而不是完整的数据库查询。如果它是 O(n log n) 并且你将 na 缩小一百倍，那么它的速度会快 100 倍以上。

# wpf - 如何防止 WPF 对话框中的键盘事件传递到调用它的 MFC 应用程序？

> ID：11216413
> 
> 赞同：4
> 
> 时间：2012-06-26T21:45:05.217
> 
> 标签：wpf, mfc, key-bindings, keyevent

我们有一个遗留的 MFC 应用程序，我们正在使用新的 WPF 视图和对话框对其进行扩展。我正在尝试在从 MFC 主窗口调用的 WPF 对话框中实现 F1 帮助。

最初，我`KeyBinding`在 F1 的 WPF 对话框中添加了一个，并让它触发一个运行的命令`HtmlHelp`；像这样的东西：

```
<Window.Resources>
    <command:CommandReference x:Key="ShowF1Help" Command="{Binding ShowHelpCommand}"/>
</Window.Resources>

<Window.InputBindings>
    <KeyBinding x:Name="ShowHelp" Gesture="F1" Command="{StaticResource ShowF1Help}"/>
</Window.InputBindings> 
```

这带来了帮助，但不幸的是，键盘事件*也*被 MFC 窗口拾取；即使 WPF 对话框模态显示在其顶部，MFC 窗口仍然收到 F1，因此它`HtmlHelp`第二次启动，显示自己的主题。

我寻找一种方法将事件标记为在`XAML/KeyBinding`元素内处理但没有运气。所以我尝试暴力破解它并用`KeyDown`代码隐藏中的处理程序替换它，将事件标记为已处理，如下所示：

```
private void WindowKeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.F1)
    {
        MyDialogVM.ShowContextSensitiveHelp();
        e.Handled = true;
    }
} 
```

这没有用；该事件最终仍由 MFC 窗口处理。我也试过`PreviewKeyDown`--same 结果。

我有一种感觉，我忽略了一些明显的事情，但它确实看起来像将 WPF 事件标记为已处理只会影响 WPF 代码，并且 MFC 消息泵不知道托管代码已经看到或处理了给定的键盘事件。

有没有办法防止在 WPF 对话框中处理的键盘事件也被调用该对话框的 MFC 应用程序看到？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T16:34:08.407

几个问题：1）WPF对话框的所有者是MFC窗口吗？如果您没有明确执行任何操作，则默认情况下它不是。2) wpf 对话框启动时是否禁用主窗口？如果不是，可能是因为问题 1。

你需要类似的东西：

```
var hlpr = new System.Windows.Interop.WindowInteropHelper( xaml_window );
hlpr.Owner = mfc_window_handle; 
```

# spotify - libspotify API：本地缓存和注销

> ID：11216414
> 
> 赞同：0
> 
> 时间：2012-06-26T21:45:08.803
> 
> 标签：spotify

如果未定义本地主机缓存（“cache_location”和“settings_location”都配置为空字符串），**sp_session_logout**会做什么？由于没有可用于刷新的缓存，它会被挂起吗？或者也许在终止应用程序之前根本不需要调用**sp_session_logout**，因为使用注销调用的主要目的是刷新缓存？

无论如何，我试图禁用缓存的原因是：

我想将 PCM 原始数据发送到标准输出而不是 alsa 驱动程序，然后将数据重定向到音频播放器。如果启用缓存，则音频播放器在缓存为空时（首次播放）输出噪音，但在缓存不为空时（非首次播放）输出音乐。如果缓存被禁用，音频播放器会正确输出音乐。

启用缓存是个好主意，但我不明白这些缓存内容会如何影响音频输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T10:00:50.900

我认为您的音频代码遇到了问题，或者您正在通过标准输出推送音频数据。我与许多具有正确工作缓存的 libSpotify 项目合作过，但我从未见过这样的问题。

此外，`sp_session_logout`断开用户与 Spotify AP 的连接，因此在适当的时候调用它很重要。

# .net - 用于 xmlserialization 的 Msmq 和 sgen 彻底失败

> ID：11216415
> 
> 赞同：2
> 
> 时间：2012-06-26T21:45:15.407
> 
> 标签：.net, vb.net, xml-serialization, msmq, xmlserializer

我一直在用这个来敲打我的头。任何想法都非常受欢迎！

我在 vb.net 中有一个使用 MSMQ 的客户端/侦听器应用程序，当我不使用 sgen.exe 在编译时生成序列化时，它可以 100% 正常工作。

使用 sgen 时，它在侦听器部分失败。

```
 qOrders.Formatter = New XmlMessageFormatter(New Type() {GetType(InfoMessage)})

        m = qOrders.EndReceive(e.AsyncResult) 
```

它在 mmBody 上的炸弹有错误`"Cannot deserialize the message passed as an argument. Cannot recognize the serialization format."`，其余属性也有没有接收到值的错误。

该程序集具有强名称，并且 App.XmlSerializers.dll 也已正确签名。我知道使用了 dll，因为在程序运行时我无法删除它。

InfoMessage 类是一个简单的公共类，具有 3 个公共字符串成员。使用 Reflector 检查 dll，我确实看到 sgen 生成了一个 InfoMessageSerializer 类。

问题不在客户端，因为我删除了 dll 并运行了侦听器，它照常工作。

那么，这里有什么问题呢？:o

谢谢，

约翰

编辑：链接到监听器源： http: [//pastebin.com/TqWfLVJ0](http://pastebin.com/TqWfLVJ0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:41:37.160

输出存在[设计限制](http://connect.microsoft.com/VisualStudio/feedback/details/94449/sgen-on-the-server)。`sgen`这个限制[从未被删除](http://msdn.microsoft.com/en-us/library/bk3w6240%28v=vs.110%29.aspx)：

> 这些生成的程序集不能用于 Web 服务的服务器端。此工具仅适用于 Web 服务客户端和手动序列化场景。

基本上，您不希望运行`sgen`以使 Web 服务的服务器端更快，因为`XmlSerializer`启动时间不是其性能的关键因素（与某些类型的客户端相比）。

当然，在非web服务的场景下`sgen` *也*可以在服务端使用，只要不`XmlAttributeOverrides`给`XmlSerializer`.

使用 MSMQ，可以选择二进制和 XML 序列化，您的代码在此处选择后者：

```
qOrders.Formatter = New XmlMessageFormatter(New Type() {GetType(InfoMessage)}) 
```

那么让我们看看如何`MessageQueue`创建一个`XmlSerializer`. 以下是`XmlMessageFormatter`取自`System.Messaging.dll`.NET 4.0 的方法。它的 .NET 2.0 对应物是类似的。

```
private void CreateTargetSerializerTable()
{
  if (!this.typeNamesAdded)
  {
    for (int index = 0; index < this.targetTypeNames.Length; ++index)
    {
      Type type = Type.GetType(this.targetTypeNames[index], true);
      if (type != (Type) null)
        this.targetSerializerTable[(object) type]
          = (object)new XmlSerializer(type);
    }
    this.typeNamesAdded = true;
  }
  if (!this.typesAdded)
  {
    for (int index = 0; index < this.targetTypes.Length; ++index)
      this.targetSerializerTable[(object) this.targetTypes[index]] 
        = (object)new XmlSerializer(this.targetTypes[index]);
    this.typesAdded = true;
  }
  if (this.targetSerializerTable.Count == 0)
    throw new InvalidOperationException(Res.GetString("TypeListMissing"));
} 
```

如您所见，MSMQ 不提供`XmlAttributeOverrides`，与框架中的 Web 服务服务器端代码不同。尽管如此，还有其他人在将[XmlMessageFormatter](http://www.pcreview.co.uk/forums/xmlmessageserializer-sgen-serialization-assembly-t3727491.html)和`sgen`.

我的猜测是，`sgen`它仍然可以与 MSMQ 一起使用，因为 MSMQ 不使用`XmlAttributeOverrides`，但是您必须确保您没有使用`proxytypes`命令行选项，并且您仍然在 Microsoft 测试过的范围之外。

我建议看看这些可能性：

*   避免`sgen`与 MSMQ 一起使用。
*   避免将`/proxytypes`选项与`sgen`.
*   如果您从项目文件`SGenUseProxyTypes`中调用，请禁用（[查看此处](http://msdn.microsoft.com/en-us/library/bb629394.aspx)了解如何）。`sgen`
*   看看使用 MSMQ 的二进制序列化。
*   密切注意您通过客户端队列发送的类型。

# .net - 了解vs2010的基本windows编程

> ID：11216417
> 
> 赞同：2
> 
> 时间：2012-06-26T21:45:18.100
> 
> 标签：.net, windows, winapi, mfc

我来自 unix 背景，但我被要求进行一些 Windows 编程，但我无法理解框架。win32、mfc、.NET等之间的一般层次结构是什么？

是否有一个体面的在线教程，涵盖了 Windows 编程的一般结构。我不确定我应该寻找什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T21:52:30.380

win32 是实际的 Windows API，它提供创建 Windows 应用程序所需的对象和功能。

MFC 是一个基于 C++ 的框架，用于创建 Windows 应用程序。它建立在 win32 API 之上。如果您想用 C++ 编写应用程序，那么这可能是您最好的选择。

.NET 是用于编写应用程序的托管框架，包含用于编写基于 win32 API 的应用程序的 WinForms 和 WPF。如果您想使用 VB 或 C#，那么这就是要走的路。

# google-apps-script - 无法打开项目属性谷歌应用程序脚本

> ID：11216419
> 
> 赞同：0
> 
> 时间：2012-06-26T21:45:38.763
> 
> 标签：google-apps-script, properties, storage, project

我已经在文件->项目属性->项目属性中删除了属性键和值，从那时起我无法打开项目属性并且脚本不起作用。如何重置/删除脚本属性？

我试过复制项目，但我使用的是项目版本，只有最新版本被复制到新项目中。我需要我的项目的最旧版本。

请帮我！

这是电子表格的链接 [https://docs.google.com/a/kierowca.pl/spreadsheet/ccc?key=0AnTGczwoMaewdEp3WUdmWU5UdFpmYk1JOVkyR1g0dmc](https://docs.google.com/a/kierowca.pl/spreadsheet/ccc?key=0AnTGczwoMaewdEp3WUdmWU5UdFpmYk1JOVkyR1g0dmc)

项目名称 zleceniaZewnSystemZlecen1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:16:48.603

存在一个[未解决的问题](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1519)，脚本属性中的错误键会阻止读取/写入和加载对话框。

# c++ - 监控进程（一切）

> ID：11216422
> 
> 赞同：2
> 
> 时间：2012-06-26T21:46:17.057
> 
> 标签：c++, linux, process, monitor

我想监视一个进程及其所做的一切（它给 SIGINT 的每个信号）。

有没有办法做到这一点？

我正在使用 Linux（确切地说是 Ubuntu 11）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:49:59.220

如果您正在寻找命令行监控，strace unix 命令将完成所有这些以及更多工作[。](http://en.wikipedia.org/wiki/Strace)

它使用[ptrace](http://en.wikipedia.org/wiki/Ptrace)系统调用基础设施进行监控，这本身就更强大：另外还允许控制进程并与之交互。引用维基百科：

> ptrace 由调试器（如 gdb 和 dbx）、跟踪工具（如 strace 和 ltrace）以及代码覆盖工具使用。专门的程序也使用 ptrace 来修补正在运行的程序，以避免未修复的错误或克服安全功能。它可以进一步用作沙箱和运行时环境模拟器（例如模拟非 root 软件的 root 访问）。

如果您想以编程方式而不是从命令行执行此监控，那么 ptrace 是您的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:49:58.813

[strace](http://en.wikipedia.org/wiki/Strace)应该可以工作，或者该页面上“其他工具”部分中列出的内容。

# javascript - jQuery/Javascript - 从无序列表中查找字符串在数组中

> ID：11216424
> 
> 赞同：0
> 
> 时间：2012-06-26T21:46:27.990
> 
> 标签：javascript, jquery, arrays

我试图将无序列表中的文本与我通过抓取字符串中的内容然后解析它创建的数组进行比较。我似乎无法让我的 jQuery 代码的比较部分在我检查字符串是否位于数组中的地方工作。有什么建议么？

HTML

```
<span id="Subjects">Commercial Law & Contracts, Immigration Law, International Law & Trade, Products Liability</span>
<ul id="SubjectList">
  <li>Administrative Law</li>
  <li>Agriculture Updates</li>
  <li>Alternative Dispute Resolution</li>
  <li>Antitrust & Trade Regulation</li>
  <li>Commercial Law & Contracts</li>
  <li>Immigration Law</li>
  <li>International Law & Trade</li>
  <li>Products Liability</li>
</ul> 
```

jQuery 代码

```
var subject_passed = $('#Subjects').text();
var subjectArray = new Array();
subjectArray = subject_passed.split(',');   

$('#SubjectList li').each(function(){  
    if ($.inArray($(this).text(), subjectArray) != -1) {
        alert('hello');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:51:01.293

你可以试试：

```
var subject_passed = $('#Subjects').text();
//var subjectArray = new Array(); //not really needed as split returns new a array
var subjectArray = subject_passed.split(', '); //add a space to split

$('#SubjectList li').each(function(){  
   if ($.inArray($(this).text(), subjectArray) !== -1) { //better to use !== for comparison
     alert('hello');
   }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:53:41.537

您应该使用`$.trim()`在拆分后和比较期间从文本值中删除外部空格：

```
var subject_passed = $('#Subjects').text();
var subjectArray = subject_passed.split(','); 
$.each(subjectArray, function(i, el){
    subjectArray[i] = $.trim(el);
});

$('#SubjectList li').each(function(){  
    if ($.inArray($.trim($(this).text()), subjectArray) != -1) {
        $(this).addClass('highlight');
    }
});​ 
```

## [看演示](http://jsfiddle.net/b8qr7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:51:27.180

在以下行中的逗号后添加一个空格...

```
subjectArray = subject_passed.split(', '); 
```

# iphone - 将 NSMutableDictionary 键作为字符串获取？

> ID：11216425
> 
> 赞同：0
> 
> 时间：2012-06-26T21:46:36.850
> 
> 标签：iphone, objective-c, ipad, nsmutabledictionary

我有一个 NSMutableDictionary ，其中有 10 个对象，每个对象都有一个键，当然，键都是单词，这在 plist 中。

所以我按特定顺序将这些词输入到 plist 中：

例如

```
hello
goodbye
please
thankyou 
```

如何将这些键作为字符串数组获取？我已经尝试过`allKeys`，但由于某种原因，它使它们全部乱序，并且带有空格的单词被加上引号（我从记录数组中看到了这一点）。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:52:09.927

`NSMutableDictionary`不按任何特定顺序保存数据。相反，您应该使用`NSArray`. 这样，您将拥有所需顺序的单词并使用它们访问字典以检索字典的数据。

# ubuntu - 具有外部 VCC 的 OTG 端口的更多功率

> ID：11216428
> 
> 赞同：1
> 
> 时间：2012-06-26T21:47:08.473
> 
> 标签：ubuntu, usb, omap, usb-otg

我正在使用带有 Ubuntu 10.10 服务器和 ubuntu-omap4-extras 内核（3.0.0-1205-omap4）的 Pandaboard ES，我想使用板上的第二个 USB 总线。OTG 端口将提供第二条总线，但遗憾的是没有足够的电力来运行网络摄像头等。因此，我想将 OTG 端口用作主机并从 J6 扩展（接地 5VDC 和接地）提供电源。使用 $lsusb 设备会被识别但无法工作，这可能是内部电源检查的原因。

我在 Gumstick 论坛上发现了一个帖子绕过这个检查：“插入设备后，运行以下命令：echo -n 1 > /sys/devices/platform/musb_hdrc/usb1/1-1/bConfigurationValue 这将禁用电源限制强制执行。您可能仍会在系统日志中收到警告，但设备应该可以工作。每次重新启动 Overo 或插入设备时都必须重复此操作“

但是我的熊猫板上不存在建议的路径。如果有人能给我提示在哪里打开电源检查，那就太好了。任何帮助，将不胜感激

# knockout.js - 如何在我的点击事件中访问 observableArray？

> ID：11216435
> 
> 赞同：2
> 
> 时间：2012-06-26T21:48:10.937
> 
> 标签：knockout.js, knockout-2.0

我有一个项目，我无法弄清楚如何从容器模板调用的单击事件中访问 observableArray。我在这里的小提琴中有一个精简的例子：

[http://jsfiddle.net/zBarW/26/](http://jsfiddle.net/zBarW/26/)

点击事件在模板中指定，然后从项目本身的属性动态加载每个项目的模板。

所以一个示例项目是：

```
{ID: 1, TemplateName: 'template1', Label: 'Name', Description: 'Your name'} 
```

“父”模板如下所示：

```
<script type="text/html" id="tpl-placeholder">
<div class="entry" data-bind="click: $parent.RemoveEntry, attr: { id: ID}, template: {name: TemplateName }"></div>
</script> 
```

动态加载的模板如下所示：

```
<script type="text/html" id="template1">
    <h1 data-bind="text: Label"></h1>
    <div data-bind="text: Description"></div>
</script> 
```

在处理单击事件的方法中 - 在本例中为 RemoveEntry - 在尝试访问 observableArray (Entries) 时我得到 null。

这是视图模型：

```
var viewModel = {

    Name: ko.observable("Entries"),

    Entries: ko.observableArray( entries ),

    RemoveEntry: function (entry) {
        // how do I access the "Entries" list here - this.Entries returns null
        $("#debug").text(this.Entries == null);
        this.Entries.remove(entry);
    }
}; 
```

我是一个淘汰赛新手..有人可以告诉我我在这里做错了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:19:01.370

你拥有它的方式，你直接访问 viewmodel.Entries...

但是，更典型的是，您会这样做：-

[http://jsfiddle.net/keith_nicholas/RAMcc/](http://jsfiddle.net/keith_nicholas/RAMcc/)

用好的 ol javascript hack

```
var self = this; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:19:19.233

在我最初的测试中，我发现我可以使用**viewModel.Entries**。我觉得基思的反应比较好，肯定是比较典型的方法。为了完整起见，我将把它留在这里。

对于我的示例，这有效：

```
RemoveEntry: function (entry) {
    // how do I access the "Entries" list here - this.Entries returns null
    $("#debug").text(viewModel.Entries == null);
    viewModel.Entries.remove(entry);
} 
```

# c++ - 在编译时确定指针类型

> ID：11216436
> 
> 赞同：0
> 
> 时间：2012-06-26T21:48:11.623
> 
> 标签：c++, templates, visual-c++, visual-studio-2005

我试图从传递给宏的指针中提取类类型。这是我到目前为止所拥有的

```
template <class CLASS> class getter
{
public:
    typedef CLASS type;
};
template <class CLASS> getter<CLASS> func(const CLASS* const)
{
    return getter<CLASS>();
}
...
#define GETTYPE(PTR) func(p)::type
...
MyClass *p = new MyClass;
...
GETTYPE(p) myClass; 
```

这甚至可能吗？我在吠叫错误的树吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:01:50.313

您可以`decltype`在 C++11 中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:54:12.207

是和不是。您可以从*知道*它是模板的泛型类型中提取指向的类型。但是你不能用函数来做到这一点。一个简单的实现是`std::remove_pointer`在 C++11 中，它是在以下行中实现的：

```
template <typename T>
struct remove_ptr {       // Non pointer generic implementation
   typedef T type;
};
template <typename T>
struct remove_ptr<T*> {   // Ptr specialization:
   typedef T type;
}; 
```

采用：

```
template <typename T> void foo( T x ) {
   typedef typename remove_ptr<T>::type underlying_type;
}
int main() {
   foo( (int*)0 ); // underlying_type inside foo is int
   foo( 0 );       // underlying_type inside foo is also int
} 
```

# unix - unix SCP 是否返回网络问题的错误代码

> ID：11216439
> 
> 赞同：-2
> 
> 时间：2012-06-26T21:48:25.387
> 
> 标签：unix, scp

在脚本中，我使用 SCP 将大文件复制到另一台主机。

scp -qrp hugefile.txt /opt/perf05/tmp

但是，我们注意到该文件没有被复制。我怀疑这是因为我们在通过网络复制这个巨大的文件时失去了连接。在这种网络断开连接的情况下，scp 命令是否返回任何错误代码，或者是否有任何其他调试方法以找出导致此失败复制的确切原因。提前致谢。

-史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:54:15.100

```
scp -v 
```

提供调试信息。

当连接失败或发生任何其他网络错误时，scp 确实返回非零 (>1)。

# delphi - ADO DataSet 使用 EOF 还是 IsEmpty？

> ID：11216441
> 
> 赞同：3
> 
> 时间：2012-06-26T21:48:26.337
> 
> 标签：delphi, ado

我用于访问存储过程数据集（MS SQL Server，只进，只读）的大部分代码是多年前我的 Clipper 编码的回退

在今天的代码审查中，我注意到在类似的代码块中引用了 IsEmpty。这只是一种偏好，还是在示例场景中有任何真正的区别？

```
MyStoredProc.Open;
if not MyStoredProc.IsEmpty then
begin
  DoSomething;
end; 
```

我通常使用的地方

```
MyStoredProc.Open;
if not MyStoredProc.Eof then
begin
  DoSomething;
end; 
```

主要是因为它反映了我在多条记录时在 while 循环中使用的做法：

```
MyStoredProc.Open;
while not MyStoredProc.Eof then
begin
  DoSomething;
  MyStoredProc.Next;
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T21:54:58.610

[IsEmpty](http://docwiki.embarcadero.com/Libraries/en/Data.DB.TDataSet.IsEmpty)属性用于检查数据集是否有记录，[Eof](http://docwiki.embarcadero.com/Libraries/en/Data.DB.TDataSet.Eof)用于检查当前记录是否为最后一条。在您的情况下，如果您需要遍历数据集，请使用 eof 来确定您是否到达最后一条记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T05:29:25.417

`IsEmpty`等于`Bof and Eof`，不等于`Eof`。

In this particular case, directly after opening a new dataset it is equivalent to `Eof` (because you know `Bof` also holds), but in general it is not.

# c# - 编程“左倾和右倾” - Kinect 中的手势

> ID：11216447
> 
> 赞同：3
> 
> 时间：2012-06-26T21:49:18.713
> 
> 标签：c#, unity3d, kinect, gestures

我正在统一 3d 中编写游戏，我将 kinect 骨架映射到 3d 模型上。

现在我必须检查玩家是向左还是向右倾斜……这是我的问题。

我关注了这个网站：http: [//blogs.msdn.com/b/mcsuksoldev/archive/2011/08/08/writing-a-gesture-service-with-the-kinect-for-windows-sdk.aspx](http://blogs.msdn.com/b/mcsuksoldev/archive/2011/08/08/writing-a-gesture-service-with-the-kinect-for-windows-sdk.aspx)

现在，我正在寻找精益姿态的正确实施。

你们中有人有想法，我该如何解决这个问题？我必须在某些地方做出这个手势，这样我才能识别出倾斜。我尝试过类似的方法：`if left shoulder.x < hips_left.x or left.shoulder.x > hips_left.x`但这不太好......

我真的需要你的帮助 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T22:01:58.077

我会使用类似的东西，也许与你的想法相结合

```
if(left.shoulder.y == right.shoulder.y){
    //No Direction
}else if(left.shoulder.y < right.shoulder.y){
    //leaning left
}else{
    //leaning right
} 
```

也许你也可以使用 head.x pos

编辑：

我不确定这是否完美，但在我的测试中它确实有效

```
if((left.shoulder.y + tollerance) >= right.shoulder.y && (left.shoulder.y - tollerance) <= right.shoulder.y){
    //No Direction
}else if(left.shoulder.y < right.shoulder.y){
    //leaning left
}else{
    //leaning right
} 
```

# c++ - c ++将子类添加到基类数组中？

> ID：11216451
> 
> 赞同：1
> 
> 时间：2012-06-26T21:49:39.903
> 
> 标签：c++, arrays, subclass, base-class

我有一本课本和 2 个子类 lerningbook,readingbook，我正在尝试创建一个书籍列表 book* listofbooks 并将子类添加到它

```
Book* listOfBooks;

void Mang::addBookToList(Book b3)
{
    Book* temp;
    temp=listOfBooks;
    lobsize++;
    listOfBooks=new Book[lobsize];
    int i;
    for(;i<lobsize;i++)
    {
        listOfBooks[i]=temp[i];
    }
    listOfBooks[i]=b3;
} 
```

问题是当我试图向它发送子类时，我尝试使用模板，因此该函数将能够接受任何类，但它没有帮助
我得到的错误是：
**不存在从 lerningbook 到 book 的合适的用户定义转换**
猜测我需要实现相同类型的函数来允许我执行此操作，但我不知道你们中的哪一个可以帮助我解决 adv 中的 thx :)
（我知道我缺少临时数组排序上的 delete[]的被困在这个问题上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:55:49.480

`b3`是`Book`, 但`listoOfBooks`是 的数组`Book*`。您需要传递一个`Book*`to `addBookToList`，不仅是为了分配，而且是为了避免[对象切片](http://en.wikipedia.org/wiki/Object_slicing)。

如果这不是学习练习，请改用 a`std::vector<Book*>`或 a `std::vector<std::shared_ptr<Book>>`。将根据需要动态增长，并且智能指针的使用将在销毁时`std::vector`自动`delete`元素。`vector`

如果您选择使用`Book*`确保您遵守[什么是三法则？](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three). 这可能只是`Mang`通过声明复制构造函数和赋值运算符来使不可复制`private`。

请注意，`i`在循环中未初始化，`for`并且以下分配超出了数组的范围访问权限，如下`i == lobsize`所示`for`：

```
listOfBooks[i]=b3; 
```

数组索引从 0 开始，`lobsize - 1`最后一个元素的索引也是如此。

# .net - 针对 Metro 的 .NET 的可移植类库是否也在 WinRT 上运行？

> ID：11216462
> 
> 赞同：1
> 
> 时间：2012-06-26T21:50:49.550
> 
> 标签：.net, c#-4.0, windows-runtime, microsoft-metro

我找到了一些关于这个主题的文章，但我似乎无法收集针对 Windows 8（Metro）和 .NET 4.5 的 PCL 是否会在 WinRT 中运行。我的猜测是否定的，但其他人有想法吗？

资料来源：

[http://www.hanselman.com/blog/HiddenGemsInVisualStudio11BetaNETPortableClassLibraries.aspx](http://www.hanselman.com/blog/HiddenGemsInVisualStudio11BetaNETPortableClassLibraries.aspx)

[http://msdn.microsoft.com/en-us/library/gg597391(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/gg597391(v=vs.110).aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:04:05.923

从[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/gg597391%28v=vs.110%29.aspx)：

> 使用可移植类库项目，您可以构建无需修改即可在 .NET Framework、**Metro style**、Silverlight、Windows Phone 和 Xbox 360 应用程序中工作的可移植程序集。

如果不清楚，“Metro Style”是指 WinRT。

# php - MySQL Query AND IN (select .... - 需要帮助澄清，它是子例程吗？

> ID：11216463
> 
> 赞同：0
> 
> 时间：2012-06-26T21:50:57.927
> 
> 标签：php, mysql, subroutine

你能告诉我我的解释是否正确（最后和部分）吗？

```
$q = "SELECT title,name,company,address1,address2 
      FROM registrations 
      WHERE title != 0 AND id IN (
          SELECT registrar_id 
          FROM registrations_industry 
          WHERE industry_id = '$industryid'
      )"; 
```

下面真的是我不确定的地方：

```
... AND id IN (select registrar_id from registrations_industry where industry_id='$industryid') 
```

**解释：** 从连接表registrations_industry中获取id(registrations id field)等于registrar_id(field)的任何匹配，其中industry_id等于集合$industryid

**此 select 语句是否被视为子例程，因为它是主查询中的查询？**

所以一个例子是注册表 id 搜索到 23 看起来像：

**注册**（表）

```
id=23,title=owner,name=mike,company=nono,address1=1234 s walker lane,address2 
```

**registrations_industry**（表）

```
id=256, registrar_id=23, industry_id=400<br>
id=159, registrar_id=23, industry_id=284<br>
id=227, registrar_id=23, industry_id=357 
```

我假设这将返回 3 条具有相同注册表数据的记录，当然还有不同的 registrations_industry 返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:04:10.123

对于给定的测试数据集，您的查询将返回一条记录。这一个： `id=23,title=owner,name=mike,company=nono,address1=1234 s walker lane,address2`
要获得三个具有相同注册表数据和不同registrations_industry 的记录，您需要使用`JOIN`.

像这样的东西：

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations AS r
LEFT OUTER JOIN registrations_industry AS ri
ON ri.registrar_id=r.id
WHERE r.title!=0 AND ri.industry_id={$industry_id} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T22:41:07.733

很抱歉这篇文章，直到现在我才意识到它已经这么长了。尽管您已经检查了答案，但我希望您阅读这篇文章能够深入了解为什么首选此解决方案以及它是如何从您的原始查询演变而来的。

## 第一件事

您的查询

```
$q = "SELECT title,name,company,address1,address2 
      FROM registrations 
      WHERE title != 0 AND id IN (
          SELECT registrar_id 
          FROM registrations_industry 
          WHERE industry_id = '$industryid'
      )"; 
```

看起来不错。`IN`语法等效于多个匹配`OR`项。例如

```
WHERE field_id IN (101,102,103,105) 
```

在功能上等同于

```
WHERE (field_id = 101 
    OR field_id = 102
    OR field_id = 103
    OR field_id = 105) 
```

您通过引入子查询使其复杂化一点，没问题。只要您的子查询返回一列（而您的也如此），将其传递给`IN`就可以了。

在您的情况下，您正在`registrations.id`比较`registrations_industry.registrar_id`. （注意：这只是`<table>.<field>`语法，没什么特别的，但有助于消除您的字段所在的表的歧义。）

这似乎很好。

# 发生什么了

SQL 将首先运行子查询，生成`registrar_id`s 的结果集，其中 s`industry_id`按指定设置。

然后 SQL 将运行外部查询，将子查询替换为其结果，您将从与子查询返回的 s之一匹配的`registrations`位置获取行。`registrations.id``registrar_id`

子查询有助于调试您的代码，因为您可以拉出子查询并单独运行它，确保其输出符合您的预期。

# 优化

虽然子查询有利于调试，但它们很慢，至少比使用优化`JOIN`语句慢。

在这种情况下，您可以使用`JOIN`.

首先，您将从基本完全相同的外部查询开始：

```
SELECT title,name,company,address1,address2 
FROM registrations 
WHERE title != 0 AND ... 
```

但是您也对`registrations_industry`表格中的数据感兴趣，因此您需要将其包括在内。给我们

```
SELECT title,name,company,address1,address2 
FROM registrations, registrations_industry 
WHERE title != 0 AND ... 
```

我们需要修复......现在我们有了`registrations_industry`表格，我们可以：

```
SELECT title,name,company,address1,address2 
FROM registrations, registrations_industry 
WHERE title != 0 
AND id = registrar_id
AND industry_id = '$industryid' 
```

现在，如果两个表都有一个`id`列，则可能会出现问题——因为只是说`id`是模棱两可的。我们可以通过使用`<table>.<field>`语法来消除歧义。如在

```
SELECT registrations.title, registrations.name,
    registrations.company, registrations.address1, registrations.address2 
FROM registrations, registrations_industry 
WHERE registrations.title != 0 
AND registrations_industry.industry_id = '$industryid' 
```

我们不必对所有字段引用都使用这种语法，但为了清楚起见，我们选择了这种语法。由于所有表名，查询现在变得不必要地复杂。我们可以缩短它们，同时仍然提供消歧和清晰度。我们通过创建表别名来做到这一点。

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations r, registrations_industry ri
WHERE r.title != 0 
AND ri.industry_id = '$industryid' 
```

通过将`r`和放在子句`ri`中的两个表之后`FROM`，我们可以使用这些快捷方式来引用它们。这清理了查询，但仍然使我们能够清楚地指定字段来自哪些表。

***旁注：***我们可以通过包含可选的`AS`eg而不仅仅是，但我通常保留字段别名。`FROM registrations`**`AS`**`r``FROM registrations r``AS`

如果您现在运行查询，您将获得所谓的“笛卡尔积”或 SQL 术语中的`CROSS JOIN`. 这是因为我们没有定义这两个表之间的任何关系，而事实上，有一个。为了解决这个问题，我们需要重新引入丢失的原始查询的一部分：两个表之间的关系

```
r.id = ri.registrar_id 
```

这样我们的查询现在看起来像

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations r, registrations_industry ri
WHERE r.title != 0 
AND r.id = ri.registrar_id
AND ri.industry_id = '$industryid' 
```

这应该可以完美地工作。

# 吹毛求疵——隐式与显式连接

但是我的挑剔者需要指出这被称为“隐式连接”。基本上你正在加入表格但不使用`JOIN`语法。

一个更简单的隐式连接示例是

```
SELECT *
FROM foo f, bar b
WHERE f.id = b.foo_id 
```

相应的*显式*语法是

```
SELECT *
FROM foo f
JOIN bar b ON f.id = b.foo_id 
```

结果将是相同的，但它使用正确（和更清晰）的语法。`foo`（它更清楚，因为它明确地统计了和表之间存在关系，`bar`并且它由 定义`f.id = b.foo_id`。）

我们可以类似地表达您的***隐式***查询

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations r, registrations_industry ri
WHERE r.title != 0 
AND r.id = ri.registrar_id
AND ri.industry_id = '$industryid' 
```

***明确***如下

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations r
JOIN registrations_industry ri ON r.id = ri.registrar_id
WHERE r.title != 0 
AND ri.industry_id = '$industryid' 
```

如您所见，表之间的关系现在在`JOIN`子句中，因此`WHERE`和后续的`AND`and`OR`子句可以自由表达任何限制。另一种看待这个问题的方法是，如果您取出`WHERE + AND/OR`子句，表之间的关系仍然存在，结果仍然“有意义”，而如果您使用隐式方法并删除`WHERE + AND/OR`子句，您的结果集将包含以下行误导。

最后，`JOIN`语法本身将导致 in 中的行`registrations`，但没有任何相应的行 in`registrations_industry`不被返回。

根据您的用例，您可能希望行 from`registrations`出现在结果中，即使`registrations_industry`. 为此，您将使用所谓的`OUTER JOIN`. 在这种情况下，我们想要所谓的 a `LEFT OUTER JOIN`，因为我们想要左侧表的所有行 ( `registrations`)。我们可以选择用于`RIGHT OUTER JOIN`正确的表或仅用于*两个*表`OUTER JOIN`的外部连接。

 *因此我们的查询变成

```
SELECT r.title, r.name, r.company, r.address1, r.address2 
FROM registrations r
LEFT OUTER JOIN registrations_industry ri ON r.id = ri.registrar_id
WHERE r.title != 0 
AND ri.industry_id = '$industryid' 
```

我们完成了。

最终结果是我们有一个查询是

*   运行时间更快
*   更紧凑/简洁
*   更明确地说明字段来自哪些表
*   更明确的表之间的关系

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:00:37.170

此查询的更简单版本是：

```
SELECT title,  name, company, address1, address2
  FROM registrations, registrations_industry
 WHERE title != 0
   AND id = registrar_id
   AND industry_id = '$industryid' 
```

你的版本是一个子查询，这个版本是一个简单的连接。您对查询的假设通常是正确的，但 SQL 更难优化，并且对于任何试图阅读代码的人来说更难解开。此外，您将无法从该父 SELECT 语句中的 registrations_industry 表中提取数据，因为从技术上讲，它不是连接的，并且子表不是父查询的一部分。*

# google-app-engine - 列表属性是否有 blob 数据类型？

> ID：11216469
> 
> 赞同：1
> 
> 时间：2012-06-26T21:51:18.407
> 
> 标签：google-app-engine, google-cloud-datastore, blob, listproperty

有谁知道我是否可以将 Blob 数据类型用于 GAE 的数据存储列表属性？
我想创建以下条目，其中包含数据存储区中的 blob 列表，但出现错误。

```
class DataRecord(db.Model)
     data = db.ListProperty(blob) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:06:05.163

您可以创建一个列表属性`db.Key`或`db.Blob`代替

```
data = db.ListProperty(db.Blob) 
```

# plone - 如何查找缺少值或无作为键的对象？

> ID：11216472
> 
> 赞同：4
> 
> 时间：2012-06-26T21:51:32.050
> 
> 标签：plone, zope, catalog

我想对缺少索引键值的对象的 zope 目录执​​行搜索。是否可以？

例如考虑以下代码行：

```
from Products.CMFCore.utils import getToolByName
catalog = getToolByName(context, 'portal_catalog')
results = catalog.searchResults({'portal_type': 'Event', 'review_state': 'pending'}) 
```

如果我对未插入某个项目而不是 portal_type 或 review_state 的对象感兴趣，该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T10:24:16.813

您可以搜索这两种类型，但搜索`MissingValue`条目需要自定义处理内部目录数据结构。

索引从对象中获取值，并为其编制索引。如果有`AttributeError`或类似的，索引不存储该对象的任何内容，并且如果相同的字段是返回列的一部分，在这种情况下，`MissingValue`将给出 a 以指示该字段的索引为空。

在以下示例中，我假设您有一个`catalog`指向站点的 portal_catalog 工具的变量；例如`getToolByName(context, 'portal_catalog')`或类似的结果。

## 搜索无

您可以在许多索引中*搜索*None 就好了：

```
catalog(myKeywordIndex=None) 
```

问题是大多数索引类型都忽略`None`了一个值。因此，搜索`None`将在日期和路径索引上失败；他们忽略索引上的 None 和布尔索引；他们在索引时将 None 变为 False。

关键字索引`None`也会忽略，除非它是序列的一部分。如果索引方法返回`[None]`，它会很高兴被索引，但`None`它自己不会。

字段索引确实存储`None`在索引中。

请注意，每个索引都可以显示唯一值，因此您可以`None`通过调用来检查给定索引是否存储了值：

```
catalog.uniqueValuesFor(indexname) 
```

## 搜索缺失值

这有点棘手。例如，每个索引都会跟踪它已索引的对象，以便能够在删除对象时从索引中删除数据。同时，目录会跟踪它作为一个整体索引的对象。

因此，我们可以计算这两组信息之间的差异。当您调用已发布的 API 时，目录一直都是这样做的，但是对于这个技巧，没有这样的公共 API。我们需要进入目录内部并为自己获取这些集合。

幸运的是，这些都是 BTree 集合，因此操作相对高效。这是我的做法：

```
from BTrees.IIBTree import IISet, difference

def missing_entries_for_index(catalog, index_name):
    # Return the difference between catalog and index ids
    index = catalog._catalog.getIndex(index_name)
    referenced = IISet(index.referencedObjects()) # Works with any UnIndex-based index
    return (
        difference(IISet(catalog._catalog.paths), referenced),
        len(catalog) - len(referenced)
    ) 
```

该`missing_entries_for_index`方法返回目录 ID 的 IISet 及其长度；each 是指向指定索引没有条目的目录记录的指针。然后，您可以使用`catalog.getpath`将其转换为对象的完整路径，或用于`catalog.getMetadataForRID`获取元数据值的字典，或用于`catalog.getobject`获取原始对象本身，或用于`catalog._catalog[]`获取目录大脑。

以下方法将为您提供目录结果集，就像您从常规目录搜索中获得的一样：

```
from ZCatalog.Lazy import LazyMap

def not_indexed_results(catalog, index_name):
    rs, length = missing_entries_for_index(catalog, index_name)
    return LazyMap(catalog._catalog.__getitem__, rs.keys(), length) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T07:34:06.577

谢谢前。实际上阅读您建议的链接，我发现没有技巧是不可能的。我从 pypi 报告：

> 请注意，对索引的负过滤仍将项目限制为在索引中具有值的项目。因此，对于 10 个文档，其中 5 个在 foo 索引中，值为 1，对 not 1 的查询将不返回任何项目，而不是返回 5 个没有值的项目。如果要考虑特定索引的所有项目，则需要索引一个虚拟/默认值。

所以有必要给你的项目一个默认值并寻找它。

# jquery - jQuery JSON 响应

> ID：11216476
> 
> 赞同：0
> 
> 时间：2012-06-26T21:51:47.290
> 
> 标签：jquery, ajax, get

我在使用 jQuery JSON Response 时遇到问题。我正在传递信息并取回标题，但我没有得到 HTML。我也一直在尝试用 JSONP 解决这个问题，但仍然没有结果。

```
<script type='text/javascript'>
    $(document).ready(function(){
        $("input.senddata").click(function() {
            var ipForm = $('input[name="ip_submit"]').val();
            var gameForm = $( 'select[name="game_submit"]' ).val()
            $.getJSON("http://gamepwn.net/serversdotee/add-server.php",
              {
                ip: ipForm,
                game: gameForm
              },
              function(data) {
                $('#result').html(data);
              });
        });
    });
</script> 
```

php文件：

```
$data = array('items'=>array('serverip'=>'localhost', 'game'=>'cs','protocol'=>'48'));
echo json_encode($data); 
```

我收到的标题：

```
 Response Headers
Cache-Control   no-cache, must-revalidate
Connection  Keep-Alive
Content-Type    application/json
Date    Tue, 26 Jun 2012 21:49:01 GMT
Expires Mon, 26 Jul 1997 05:00:00 GMT
Keep-Alive  timeout=5, max=100
Server  Apache/2.2.19 (Unix) mod_ssl/2.2.19 OpenSSL/0.9.8e-fips-rhel5 DAV/2 mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635 mod_perl/2.0.4 Perl/v5.8.8
Transfer-Encoding   chunked
X-Powered-By    PHP/5.3.6

   Request Headers
Accept  application/json, text/javascript, */*; q=0.01
Accept-Encoding gzip, deflate
Accept-Language et,et-ee;q=0.8,en-us;q=0.5,en;q=0.3
Connection  keep-alive
Host    gamepwn.net
Origin  http://servers.kdfx.eu
User-Agent  Mozilla/5.0 (Windows NT 6.1; rv:14.0) Gecko/20100101 Firefox/14.0 FirePHP/0.7.1
x-insight   activate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:03:37.483

如果我有一个包含您的内容的文件 test.php

```
 <?php
$data = array('items'=>array('serverip'=>'localhost', 'game'=>'cs','protocol'=>'48'));
echo $data;
?> 
```

然后

```
$ php -f test.php 
```

产生输出：

```
Array 
```

我认为您希望提供 JSON 编码的数据。

```
<?php
$data = array('items'=>array('serverip'=>'localhost', 'game'=>'cs','protocol'=>'48'));
echo json_encode($data);
?> 
```

使用 json_encode 提供输出：

```
{"items":{"serverip":"localhost","game":"cs","protocol":"48"}} 
```

* * *

您的 javascript 尝试将一个对象传递给 jQueries .html 函数，当您需要先从中创建一个字符串时。实现这一目标的一种简单方法是使用类似的代码

```
<script type='text/javascript'>
    $(document).ready(function(){
    var pprint = function (data){
        var print = "{";
        $.each(data, function(key, element){
            if($.isPlainObject(element))
                element = pprint(element);
            print = print + '<br/>' + key + ': ' + element;
        });
        return print + "}";
    };
    console.log("test");
    $.getJSON("test.php",{}, function(data){
        console.log(data);
        $("#foo").html(pprint(data));
        console.log("done.");
    });
    });
</script> 
```

其中 pprint 函数将普通对象转换为字符串。[我从这个 Answer](https://stackoverflow.com/questions/4079274/how-to-get-an-objects-properties-in-javascript-jquery)中得到了使用 $.each 的想法，但也有更高级的方法，例如[https://j11y.io/javascript/prettyprint-for-javascript/](https://j11y.io/javascript/prettyprint-for-javascript/)。

* * *

要检查 $.getJSON 的问题，您可以使用 $.ajax：

```
$.ajax({
  url: "test.php",
  dataType: 'json',
  data: {},
  success: function(data){
        console.log(data);
        $("#foo").html(pprint(data));
        console.log("done.");
    }),
  error: function(jqXHR, textStatus, errorThrown){
    console.log(textStatus);
    console.log(errorThrown);
  }
}); 
```

[您可以在https://api.jquery.com/jQuery.ajax/](https://api.jquery.com/jQuery.ajax/)找到文档。希望这可以更多地说明您遇到的问题。

# properties - 选择列表框项时如何设置 Viewmodel 属性

> ID：11216478
> 
> 赞同：1
> 
> 时间：2012-06-26T21:52:06.243
> 
> 标签：properties, listbox, set, viewmodel, selecteditem

我正在创建一个需要多个样条零件的样条设计器。它包含 2 个视图（2 个用户控件）。

左边是一个 ItemsControl，模板化为 Canvas，显示要编辑的样条线。样条线部分也是用户控件。

右边是一个简单的 ListBox，用于选择 Spline 零件。

这两个项目容器绑定到 ViewModel 中的同一个 ObservableCollection。

目前，我在SplinePartVM 中有一个名为IsSelected 的dependencyProperty 我真正想要实现的是在ListBox 中设置SelectedItem 时修改SplinePartVM 的DependencyProperty。例如，我想做这样的事情：

```
<Trigger Property="IsSelected" Value="True">
    <Setter Property="{Binding IsSelected}"/>
</Trigger> 
```

因为一个简单的

```
<ListBox IsSelected="{Binding SelectedItem, Path=IsSelected, Mode=TwoWay}"/> 
```

不起作用。

我有点迷失在这里...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:15:27.833

我找到了。

我必须以 ListBoxItem 的样式设置 IsSelected 才能使其工作。

# javascript - jquery 工具提示抛出错误：函数未定义

> ID：11216481
> 
> 赞同：0
> 
> 时间：2012-06-26T21:52:28.377
> 
> 标签：javascript, jquery, css

我正在尝试在图像上获取自定义工具提示。但在运行时它说“方法或属性工具提示未定义”这是我的代码

```
<script src="/full/jquery.tools.min.js" type="text/javascript"></script>

<script type="text/javascript">

    $(document).ready(function () {

        $("#content img[title]").tooltip();

    });

</script>

<style type="text/css" >

.tooltip 
    {    
        display:none;
        background:transparent url(Images/blackarrow.png);    
        font-size:12px;    
        height:70px;    
        width:160px;    
        padding:25px;    
        color:#eee;  
    }</style>
</asp:Content>

    <div id="content"> <img alt="" src="Images/help1.png" title="Your help comes here" /></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:32:26.977

尝试直接从开发人员那里包含插件，仅用于测试。如果有效，则说明您的代码存在问题。

我已经删除了`[title]`from `<img>`，如果你真的需要它，请重新放置它。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="http://jquery.bassistance.de/tooltip/jquery.tooltip.js" type="text/javascript"></script>

<script type="text/javascript">

    $(document).ready(function () {

        $("#content img").tooltip();

    });

</script>

<style type="text/css" >

    #tooltip {
    width:160px;
    height:70px;
    background:transparent url(Images/blackarrow.png) #eee;
    z-index: 3000;
    border: 1px solid #111;
    opacity: 0.85;
    font-size:12px;    
    padding:25px;    
    color:#eee;  
    position: absolute;
    }
    #tooltip h3, #tooltip div { margin: 0; }

</style>

<div id="content">
    <img alt="" src="Images/help1.png" title="Your help comes here" />
</div> 
```

# performance - 媒体数据上传和性能

> ID：11216484
> 
> 赞同：1
> 
> 时间：2012-06-26T21:52:37.463
> 
> 标签：performance, api, rest, programming-languages

我需要创建 RESTful API 来上传媒体数据。我需要能够处理数百（数千）个同时请求。数据上传到我的服务器后，我们会将其存储在 Amazon S3 上并将一些元数据填充到数据库中。您能否就几个问题提出建议：

1）哪种语言更适合这类任务？（我熟悉 PHP 和 Perl）

2）服务器呢？（nginx？）

3）如果有很多请求，我们需要能够轻松扩展

4）您还有什么可以指出和建议的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T19:12:51.713

```
use feature ":5.16";
use warnings FATAL => qw(all);
use strict;
use Data::Dump qw(dump);
use Amazon::S3;

my $s3 = Amazon::S3->new
 ({aws_access_key_id     => "...",
   aws_secret_access_key => "...",
   retry                 => 1
  }
 );

my $b = $s3->bucket("Your bucket name");
my $f = "test.data"; 

$b->add_key_filename($f, "test.data", 
 {"x-amz-storage-class"=>"REDUCED_REDUNDANCY", 'x-amz-meta-version'=>'12.11.22', acl_short=>'public-read'
 });

say dump($b->errstr) if $b->errstr; 
```

# iphone - 关闭设备音量 - iOS

> ID：11216487
> 
> 赞同：5
> 
> 时间：2012-06-26T21:52:44.873
> 
> 标签：iphone, ios, ios5, audio, ios4

> **可能重复：**
> [以编程方式使 iOS 设备静音/静音？](https://stackoverflow.com/questions/10371312/mute-silence-an-ios-device-programmatically)

我需要以编程方式关闭设备音量。有人知道方法吗？

到目前为止，我发现，也许我可以使用 AudioSessionSetProperty() 函数，并使用属性“kAudioSessionProperty_CurrentHardwareOutputVolume”，但这个属性是只读的。所以我不确定这是否可行：

```
float value = 0.0f;
AudioSessionSetProperty(kAudioSessionProperty_CurrentHardwareOutputVolume, sizeof(float), &value); 
```

App-Store 中已经有执行此操作的应用程序，例如 AutoSilent：

[http://itunes.apple.com/nl/app/autosilent/id474777148?mt=8](http://itunes.apple.com/nl/app/autosilent/id474777148?mt=8)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:14:37.670

你不能在 iOS 上做到这一点。使 iOS 设备静音的唯一方法是使用硬件开关。您可以[检测到它](https://stackoverflow.com/questions/287543/how-to-programmatically-sense-the-iphone-mute-switch)并相应地使您的应用静音，但不能将整个设备从您的应用静音。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:15:12.073

看到这个问题：[如何禁用 iOS 系统声音](https://stackoverflow.com/questions/6284402/how-to-disable-ios-system-sounds)

还有这个问题：[Mute/Silence an iOS device programmatically?](https://stackoverflow.com/questions/10371312/mute-silence-an-ios-device-programmatically)

他们在那里说，尽管您必须使用称为 Celestial 框架的私有框架，但这是可能的。您可以`AVSystemController`像这样使电话静音：

```
[[AVSystemController sharedAVSystemController] setVolumeTo:0 forCategory:@"Ringtone"]; 
```

在你的应用中使用私有框架会导致它被苹果拒绝，所以我不推荐使用它。有些人认为，Apple 最初可能会允许在您的应用程序中使用私有框架（如果他们错过了它），但当他们意识到您正在使用私有框架时，它很快就会从 App Store 中删除。

希望这可以帮助！

# html - 垂直对齐跨越 2 行并飞出以与下拉菜单项对齐的顶部列表元素

> ID：11216488
> 
> 赞同：0
> 
> 时间：2012-06-26T21:53:11.050
> 
> 标签：html, css

我试图在中间垂直对齐我的顶部菜单项，我尝试了 line-height 但因为它们跨越 2 行，所以这不起作用。此外，当我向列表添加第 3 级时，弹出菜单未与相应的父列表项对齐。[http://jsfiddle.net/pk8Lm/](http://jsfiddle.net/pk8Lm/)

HTML：

```
<ul id="nav">
            <li class="rhombusStart">&nbsp;</li>
            <li class="rhombus"><a class="rhlink" href="#"><span>Home</span></a></li>
            <li class="rhombus"><a class="rhlink" href="#"><span>Market <br> Update</span></a></li>
            <li class="rhombus"><a class="rhlink" href="#"><span>Team Membership</span></a></li>
            <li class="rhombus"><a class="rhlink" href="#"><span>FISC Info</span></a>
                <ul>
                    <li><a class="linkchild" href="#">About the FISC</a></li>
                    <li><a class="linkchild" href="#">International</a></li>
                    <li><a class="linkchild" href="#"><img class = "arrow" src="Images/arrow.png" alt="&#9658;">Advantages of listing</a> 
                        <ul>
                            <li><a class="linkchild" href="#">Advantages of Listing</a></li>
                            <li><a class="linkchild" href="#">Products</a></li>
                        </ul>
                    </li>
                    <li><a class="linkchild" href ="#">Links</a></li>
                </ul>
            </li>
            <li class="rhombus"><a class="rhlink" href="#"><span>Contact Us</span></a>
                 <ul>
                    <li><a class="linkchild" href="#">About US</a></li>
                     <li><a class="linkchild" href="#">Details</a></li>
                    <li><a class="linkchild" href="#">Location</a></li>
                  </ul>
            </li>
            <li class="rhombusEnd">&nbsp;</li>
        </ul> 
```

CSS：

```
/*******************************************
 Menu Styling
*******************************************/
#menu {
    margin: 0 auto;
    padding-left: 2%;
    width: 640px;
    height: 3.5em;
    position: relative;
    top: 0;
    background-color: rgb(255,194,14);
    border: 1px solid rgb(140,51,61);
}
#nav {
     margin:0;
     padding:0;
     list-style-type:none;
     list-style-position:outside;
     position:relative;
     height:3.5em;
     background-color: rgb(255,194,14);
     display: table;
}

#nav ul {
     margin:0;
     padding:0;
     list-style-type:none;
     list-style-position:outside;
     position:relative;
     background-color: rgb(255,194,14);
}

#nav a.linkchild:link,
#nav a.linkchild:active,
#nav a.linkchild:visited {
    display:block;
    padding:0px 5px;
    text-decoration:none;
    background: #b95d73; /* Old browsers */
    background: -moz-linear-gradient(top, #b95d73 0%, #970e2e 0%, #9c1a38 0%, #910022 52%, #b95d73 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#b95d73), color-stop(0%,#970e2e), color-stop(0%,#9c1a38), color-stop(52%,#910022), color-stop(100%,#b95d73)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #b95d73 0%,#970e2e 0%,#9c1a38 0%,#910022 52%,#b95d73 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #b95d73 0%,#970e2e 0%,#9c1a38 0%,#910022 52%,#b95d73 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #b95d73 0%,#970e2e 0%,#9c1a38 0%,#910022 52%,#b95d73 100%); /* IE10+ */
    background: linear-gradient(top, #b95d73 0%,#970e2e 0%,#9c1a38 0%,#910022 52%,#b95d73 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b95d73', endColorstr='#b95d73',GradientType=0 ); /* IE6-9 */
    color: white;
}

#nav a.rhlink:link, #nav a.rhlink:active, #nav a.rhlink:visited {
    display: block;
    padding: 0px 5px;
    text-decoration: none;
    color: inherit;
}

#nav li.rhombus:hover {
    background: -webkit-gradient(linear, center top, center bottom, from(#B95D73), color-stop(25%, #9C1A38), color-stop(50%, #970E2E), color-stop(75%, #910022), to(#B95D73)); 
    background: #b95d73; /* Old browsers */
    background: -moz-linear-gradient(top, #b95d73 0%, #9c1a38 25%, #970e2e 50%, #910022 75%, #b95d73 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#b95d73), color-stop(25%,#9c1a38), color-stop(50%,#970e2e), color-stop(75%,#910022), color-stop(100%,#b95d73)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #b95d73 0%,#9c1a38 25%,#970e2e 50%,#910022 75%,#b95d73 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #b95d73 0%,#9c1a38 25%,#970e2e 50%,#910022 75%,#b95d73 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #b95d73 0%,#9c1a38 25%,#970e2e 50%,#910022 75%,#b95d73 100%); /* IE10+ */
    background: linear-gradient(top, #b95d73 0%,#9c1a38 25%,#970e2e 50%,#910022 75%,#b95d73 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b95d73', endColorstr='#b95d73',GradientType=0 ); /* IE6-9 */
    color: white;
    text-decoration: none;
}

#nav a.linkchild:hover {
   background: rgb(118,0,18);
   color: white;
}

#nav > li {
    float:left;
    position:relative;
}

#nav > li.rhombus {
    float:left;
    position: relative;
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    -o-transform-origin:0 0;
    transform-origin:0 0;
    -webkit-transform:skew(35deg);
    -moz-transform:skew(35deg);
    -ms-transform:skew(35deg);
    -o-transform:skew(35deg);
    transform:skew(35deg);
    border-right: 1px solid rgb(239,89,24);
    border-left: 1px solid rgb(255,244,80);
    background-color: rgb(255,194,14);
    font-family: Georgia;
    color: rgb(131,0,26);
    width: 8em;
    text-align: center;
    height: 3.5em;
}
#nav > li.rhombusStart {
    float:left;
    position: relative;
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    -o-transform-origin:0 0;
    transform-origin:0 0;
    -webkit-transform:skew(35deg);
    -moz-transform:skew(35deg);
    -ms-transform:skew(35deg);
    -o-transform:skew(35deg);
    transform:skew(35deg);
    border-right: 1px solid rgb(239,89,24);
    background-color: rgb(255,194,14);
    width: 1em;
    height: 3.5em;

}
#nav > li.rhombusEnd {
    float: left;
    position: relative;
    -webkit-transform-origin: 0 0;
    -moz-transform-origin: 0 0;
    -ms-transform-origin: 0 0;
    -o-transform-origin: 0 0;
    transform-origin: 0 0;
    -webkit-transform: skew(35deg);
    -moz-transform: skew(35deg);
    -ms-transform: skew(35deg);
    -o-transform: skew(35deg);
    transform: skew(35deg);
    border-left: 1px solid rgb(255,244,80);
    background-color: rgb(255,194,14);
    width: 1em;
    height: 3.5em;
}   

li.rhombus > a span {
    -webkit-transform:skew(-35deg);
    -moz-transform:skew(-35deg);
    -ms-transform:skew(-35deg);
    -o-transform:skew(-35deg);
    transform:skew(-35deg);
    text-decoration: none;
    vertical-align: middle;
    display: table-cell;     
 }

li.rhombus > ul {
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    -o-transform-origin:0 0;
    transform-origin:0 0;
    -webkit-transform:skew(-35deg);
    -moz-transform:translate(0,1px) skew(-35deg);
    -ms-transform:skew(-35deg);
    -o-transform:skew(-35deg);
    transform:skew(-35deg);
}

#nav ul {
    position:absolute;
    top:3.5em;
    left:0;
    width:15em;
    display:none;
}

#nav li ul a {
    width:15em;
    float:left;
    border-bottom: 1px, solid, rgb(145,0,34);
    border-top: 1px, solid, rgb(178,77,101);
    display: block;
    line-height: 2em;
    text-align: left;
    display: table-cell; 
}

#nav ul ul {
    top:auto;
}

#nav li ul ul {
    left:15em;
    margin:0px 0 0 10px;
}

#nav li:hover ul ul,
#nav li:hover ul ul ul,
#nav li:hover ul ul ul ul {
    display:none;
}

#nav li:hover ul,
#nav li li:hover ul,
#nav li li li:hover ul,
#nav li li li li:hover ul {
    display:block;
}

img.arrow 
{
    float: right;
    vertical-align: middle;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:04:28.387

除非您需要支持 IE6，否则请执行以下操作：

*   从#nav 中删除显示：表格
*   将 display: table 添加到主要的 li 元素中，其中包含链接（您想要居中的链接）。
*   将 display: table-cell 和 vertical-align: middle 添加到 li 元素内的主要链接。

然后摆弄外观。

# android - 如何减少列表视图项的高度

> ID：11216489
> 
> 赞同：0
> 
> 时间：2012-06-26T21:53:11.967
> 
> 标签：android

我有一个可扩展的列表视图。这些行由一个文本视图和一个自定义复选框组成。复选框的大小取决于 textview 的文本大小。只有两种可用尺寸。当显示大复选框时，行之间的差异很小。当显示小复选框时，它看起来很大。如何减少行之间的行高？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:id="@+id/childlayout"
 android:orientation="vertical">

    <RelativeLayout
        android:id="@+id/relativeLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_centerVertical="true"
            android:layout_height="wrap_content"
            android:layout_marginLeft="50dp" >

            <TextView
                android:id="@+id/child_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:gravity="center_vertical"
                android:textColor="#000000"/>

        </LinearLayout>

        <CheckBox
            android:id="@+id/multiple_checkbox"
            android:layout_width="wrap_content"
            android:layout_centerVertical="true"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:checked="true"
            android:layout_marginRight="10dp"
            android:button="@drawable/productlists_custom_cb"
            android:clickable="false"
            android:focusable="false"
            android:focusableInTouchMode="false" />
    </RelativeLayout>
</LinearLayout> 
```

如果我将相对布局的layout_height设置为30dp，行高会变小。但这不应该是这样的。

这是用于打开和关闭较小复选框的 .xml：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_checked="true" android:drawable="@drawable/cbon348" />
<item android:state_checked="false" android:drawable="@drawable/cboff348" />
</selector> 
```

人们可能会认为图像的画布比图像本身大得多，但我向你保证，事实并非如此。

![在此处输入图像描述](../Images/28a48a3d168bb7fba3f51ac303e4e03b.png)

编辑：

我将代码简化为如下，仍然没有：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:id="@+id/childlayout"
 android:orientation="horizontal">

            <TextView
                android:id="@+id/child_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                    android:layout_marginLeft="50dp" 
                android:gravity="center_vertical"
                android:textColor="#000000"/>

        <CheckBox
            android:id="@+id/multiple_checkbox"
            android:layout_width="wrap_content"
                 android:layout_gravity="center_vertical"
                  android:gravity="center_vertical"
            android:layout_height="wrap_content"
            android:checked="true"
            android:layout_marginRight="10dp"
            android:button="@drawable/productlists_custom_cb"
            android:clickable="false"
            android:focusable="false"
            android:focusableInTouchMode="false" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T17:04:59.830

我的解决方案是创建不同大小的复选框图像，然后根据屏幕大小设置适当的图像：

```
 if ((getResources().getConfiguration().screenLayout &  Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE)
     {
        holder.checkBox.setButtonDrawable(R.drawable.productlists_custom_cb48);
     }
     else if ((getResources().getConfiguration().screenLayout &  Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_NORMAL)
     {
         holder.checkBox.setButtonDrawable(R.drawable.productlists_custom_cb48);
     }
     else if ((getResources().getConfiguration().screenLayout &  Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_SMALL)
     {
         holder.checkBox.setButtonDrawable(R.drawable.productlists_custom_cb36);
     }
     holder.checkBox.setLayoutParams(new android.widget.RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT, GetDipsFromPixel(20))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:22:05.740

尝试在 textview 上使用负填充来减少该空间。

```
android:paddingTop="-5dp"
android:paddingBottom="-5dp" 
```

# parsing - ANTLR 规则重写为嵌套树

> ID：11216490
> 
> 赞同：3
> 
> 时间：2012-06-26T21:53:13.733
> 
> 标签：parsing, rewrite, antlr, grammar, abstract-syntax-tree

我正在尝试制定一个将重写为嵌套树（类似于二叉树）的规则。

例如：

```
a + b + c + d; 
```

会解析为像`( ( (a + b) + c) + d)`. 基本上每个根节点都会有三个子节点（LHS '+' RHS），其中 LHS 可能是更多嵌套节点。

我尝试了一些类似的事情：

```
rule: lhs '+' ID;
lhs: ID | rule; 
```

和

```
rule
    : rule '+' ID
    | ID '+' ID; 
```

（有一些树重写）但他们都给了我一个关于它是左递归的错误。我不确定如何在没有某种递归的情况下解决这个问题。

编辑：我最近的尝试在右侧递归，这与我想要的相反：

`rule:
ID (op='+' rule)?
-> {op == null}? ID
-> ^(BinaryExpression<node=MyBinaryExpression> ID $op rule)`

给`(a + (b + (c + d) ) )`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:21:25.647

以下语法：

```
grammar T;

options {
  output=AST;
}

tokens {
  BinaryExpression;
}

parse
 : expr ';' EOF -> expr
 ;

expr
 : (atom -> atom) (ADD a=atom -> ^(BinaryExpression $expr ADD $a))*
 ;

atom
 : ID
 | NUM
 | '(' expr ')'
 ;

ADD   : '+';
NUM   : '0'..'9'+;
ID    : 'a'..'z'+;
SPACE : (' ' | '\t' | '\r' | '\n')+ {skip();}; 
```

解析您的输入`"a + b + c + d;"`如下：

![在此处输入图像描述](../Images/c214e7c979f4e6e284487e2fd744898c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:46:36.750

你试过了吗

```
rule: ID '+' rule | ID; 
```

?

# processing - 如何在处理中动画数据可视化？

> ID：11216492
> 
> 赞同：0
> 
> 时间：2012-06-26T21:53:19.680
> 
> 标签：processing, data-visualization

我正在尝试创建一个动画数据可视化，目前只知道如何执行以下“静态”代码，它将一串点放在一条直线上。如何让它们上下跳跃？此外，如果爱尔兰都柏林有人不介意为在 Processing 中从事数据可视化项目的几个大学生提供一些辅导课程，我们将有少量预算来补偿您的时间。非常感谢！

现在，这是我正在谈论的代码......

```
SimpleSpreadsheetManager sm;
String sUrl = "t6mq_WLV5c5uj6mUNSryBIA";
String googleUser = "USERNAME";
String googlePass = "PASSWORD";

void setup() {
  //This code happens once, right when our sketch is launched
 size(800,800);
 background(0);
 smooth();

 //Ask for the list of numbers
 int[] numbers = getNumbers();
fill(255,40);
noStroke();
for (int i = 0; i < numbers.length; i++) {
  ellipse(numbers[i] * 8, width/2, 8,8);
};

};
void draw() {
  //This code happens once every frame.
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:07:43.043

本质上，您用于绘制椭圆的 x 位置是您从外部数据中获得的数值。您需要一个改变值的变量。以更新的值重绘椭圆应该使事物变得生动。

以这个基本示例为例：

```
float x,y;//position variables for the ellipse

void setup(){
  size(800,800);
  smooth();
  fill(255,40);
  noStroke();
  y = 400;
}
void draw(){
  //update values
  x = mouseX + (sin(frameCount * .05) * 30);//update x to an arbitrary value
  //draw
  background(0);//clear the screen for the new frame
  ellipse(x,y,8,8);//draw the ellipse at the new position
} 
```

x 变量有点像 numbers[i] - 只是一个机会值。除了清除屏幕（通过调用`background()`）和绘图之外，draw() 中没有什么特别的事情发生。上面的例子使用了一个任意值，但是你的设置可能是别的东西，可能是数据集中的某个值，它会随时间变化（比如一个国家的人口等）

要记住的另一件方便的事情是数据和视觉代码之间的分离。如果数据集中的值高于可以在屏幕上显示为原始值的值，您可以[map()](http://processing.org/reference/map_.html)值，以便它们可以查看，添加某种导航控件等。分析的值不会受到当前值的影响显示。在编程术语中，数据/模型、视觉/视图（如何呈现数据）和控件/控制器之间的这种分离称为[模型-视图-控制器](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)模式。对于刚开始使用代码的人来说，这可能有点多，但是仅仅意识到分离而不用担心具体的实现可能会有所帮助。

这是一个非常基本的示例，草图的宽度映射到数据的大小（数字）

```
SimpleSpreadsheetManager sm;
String sUrl = "t6mq_WLV5c5uj6mUNSryBIA";
String googleUser = "USERNAME";
String googlePass = "PASSWORD";

int[] numbers;//data used for visualisation

void setup() {
  //sketch setup
 size(800,800);
 smooth();
 fill(255,40);
 noStroke();
 //retrieve data
 numbers = getNumbers();
}
void draw() {
  background(0);
  int numId = int(map(mouseX,0,width,0,numbers.length));//map mouse x position based on sketch width and data size 
  ellipse(numbers[numId] * 8, height/2, 8,8);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:09:56.260

对于动画，您需要一个或多个参数值及时更改，目前有一个用于处理的库可以执行此类操作：[Ani](http://www.looksgood.de/libraries/Ani/) 有关更多信息，请参见该站点并提供示例。

# ios - 苹果不会拒绝应用程序吗？

> ID：11216493
> 
> 赞同：0
> 
> 时间：2012-06-26T21:53:23.890
> 
> 标签：ios, app-store

我有 webproject，有两种“模式”——第一种是某种绘图，第二种是在 WebGL 中显示从你绘制的图片中获得的 3D 模型。

由于某些原因，我想将其移植到 iOS。我决定不重写第一页（它是带有一些 js 脚本的 html 页面），而是将 WebGL（我知道 Apple 不允许它）移植到一些本机 OpenGL ES 代码中。

苹果不会拒绝这个应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:57:08.160

他们为什么会拒绝它？除非您只是使用 UIWebView 和 HTML（您专门说 OpenGL ES，所以我认为不是），这听起来像是一个完全合法的应用程序。

# c# - 检查 ADO.NET / OLEDB 连接是否存在

> ID：11216494
> 
> 赞同：1
> 
> 时间：2012-06-26T21:53:30.890
> 
> 标签：c#, ado.net, ssis, oledb, custom-component

我正在开发一个自定义 SSIS 组件以供整个公司使用。现在代码（来自[这里](http://www.thejoyofcode.com/SSIS_Custom_Logging_Task_for_Event_Handlers.aspx)）只接受 ADO.NET 连接类型。

我也想支持 OLEDB 类型，并想相应地更改我的代码。检查有效 ADO.NET 连接的代码是：

```
SqlConnection connection = connections[_connectionName].AcquireConnection(null) as SqlConnection;

     if (connection == null)
          {
          componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
          return DTSExecResult.Failure;
          } 
```

这只会检查有效的 ADO.NET 连接。我将如何更改它以检查 OLEDB 连接。例如，如果连接类型是 OLEDB，它应该被接受，如果它们都不是，它应该失败。

我不是一个 C# 的人，因此我正在寻找我能得到的任何帮助。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:58:36.897

您可以使用`is`关键字来确定对象是否是指定类型的实例（或派生自指定类型的类型）。[见 MSDN](http://msdn.microsoft.com/en-us/library/scekt9xw.aspx)

```
var connection = connections[_connectionName].AcquireConnection(null);

if (!(connection is SqlConnection || connection is OleDbConnection))
{
     componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
          return DTSExecResult.Failure;
} 
```

如果您想确定连接是否是任何`DbConnection`类型（两者都`SqlConnection`来自`OleDbConnection`），您可以执行以下操作：

```
DbConnection connection = connections[_connectionName].AcquireConnection(null) as DbConnection;

if (connection == null)
{
    componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
    return DTSExecResult.Failure;
} 
```

# javascript - 删除除使用 jQuery 单击的所有其他列表项

> ID：11216497
> 
> 赞同：1
> 
> 时间：2012-06-26T21:53:36.613
> 
> 标签：javascript, jquery

我有这种清单

```
<ul>
<li><div class="pname">Name1</div><div class="pid">ID1</div>...</li>
<li><div class="pname">Name2</div><div class="pid">ID2</div>...</li>
<li><div class="pname">Name3</div><div class="pid">ID3</div>...</li>
...
</ul> 
```

如果我单击任何列表项，则应删除所有其他列表项。谁能建议我如何做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T21:55:43.887

假设`this`是被点击的`li`元素：

```
$(this).siblings('li').not(this).remove(); 
```

如果单击处理程序绑定到列表项内的某些内容：

```
$(this).closest('li').siblings('li').not($(this).parents()).remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:56:39.917

您可以简单地将`ul`内容替换为单击的项目：

```
$('ul li').click(function(ev){
    $(this).closest('ul').html($(this));
});​ 
```

## [看演示](http://jsfiddle.net/PpVjc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:59:28.763

jQuery解决方案...

```
$('li').click(function() {
    $(this).siblings().remove();
}); 
```

# user-interface - 为什么 TortoiseSVN 强迫我用 OK 按钮关闭每个提交对话框？

> ID：11216509
> 
> 赞同：0
> 
> 时间：2012-06-26T21:54:28.973
> 
> 标签：user-interface, button, tortoisesvn

这似乎是一个微不足道的问题，但这个问题真的，真的让我发疯。

我正在使用“red x”按钮关闭 Windows 中的每个窗口。我是相当快速的计算机用户，每分钟输入大约 300 个字符并进行类似数量的点击。必须记住我必须为 TortoiseSVN 做一个特殊的例外，这让我的每一天都变得非常糟糕。

为什么 TortoiseSVN 作者强迫我使用“确定”按钮？编写特殊代码以阻止用户使用“x”按钮关闭每个提交结果窗口背后的该死逻辑是什么？有人知道答案吗？

最重要的是：我怎样才能改变它？我怎样才能让我最喜欢的 SVN 客户端恢复正常，并能够像在所有 Windows 应用程序中那样使用“x”按钮关闭它的每个窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T10:00:07.697

就像 Stefan 告诉你的那样，[这是一个错误](http://code.google.com/p/tortoisesvn/issues/detail?id=317)。它被标记为“已修复”，所以要解决您的问题，我认为您只需将 TortoiseSVN 更新到最新版本！:}

# c# - 在 WPF 树视图中的节点下添加节点

> ID：11216510
> 
> 赞同：6
> 
> 时间：2012-06-26T21:54:41.907
> 
> 标签：c#, wpf

在 Visual C++/MFC 中，我们曾经向树中添加一个节点，然后通过引用该节点，我们可以在父节点下添加子节点。但是，在 WPF 中，我没有看到这样的东西。我很困惑如何将子/子添加到节点？

任何帮助将不胜感激。

似乎 2 人已经知道 MVVM 了！

**下面的 Tim 给出了解决方案。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T18:30:52.480

由于 OP 说我的评论确实是他认为的答案，我想我会继续把它变成答案。

问题中描述的正是你如何在 WPF 中做到这一点。例如：

```
var item = new TreeViewItem(); 
myTreeView.Items.Add(item); 
var subItem1 = new TreeViewItem(); 
var subItem2 = new TreeViewItem(); 
item.Items.Add(subItem1); 
item.Items.Add(subItem2); 
```

这将添加一堆空白项目。

您可以使用每个 TreeViewItem 的 Header 属性来控制显示的内容，并使用 Tag 属性来保存数据，如果您想走这条路线。

然而，最好走绑定路线并使用 HierarchicalDataTemplates 来控制外观。这样您就不会为您的数据手动创建这些假容器（TreeViewItems）。

我建议阅读[HierarchicalDataTemplates](http://msdn.microsoft.com/en-us/library/system.windows.hierarchicaldatatemplate.aspx)，因为这将使您对流程应如何使用绑定有一个不错的概述。一般也只是阅读MVVM。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T22:27:39.813

快速谷歌搜索“wpf treeview”发现了几篇关于如何在 WPF 中正确使用树视图的好文章。

示例 1： http: [//www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode](http://www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode)

示例 2： [http ://www.c-sharpcorner.com/uploadfile/mahesh/treeview-in-wpf/](http://www.c-sharpcorner.com/uploadfile/mahesh/treeview-in-wpf/)

这应该让您开始 - 当您尝试 MVVM 方法并有更具体的问题时更新您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-05T07:38:02.890

像这样创建你的模型

```
public class WrappedNode
{
    public string Name { get; set; }
    public ObservableCollection<WrappedNode> Nodes { get; set; }

    public WrappedNode()
    {
        Nodes = new ObservableCollection<WrappedNode>();
    }        
} 
```

要绑定到树视图的节点列表

```
private ObservableCollection<WrappedNode> _nodeList;
public ObservableCollection<WrappedNode> NodeList
{
    get { return _nodeList; }
    set
    {
        _nodeList = value;
        RaisePropertyChanged(() => NodeList);
    }
} 
```

在 xaml 中：

```
 <TreeView Grid.Row="1"
              ItemsSource="{Binding NodeList}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type scnvm:WrappedNode}" ItemsSource="{Binding Nodes}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Name}" />
                </StackPanel>
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView> 
```

如果您希望节点有子节点，只需将子节点添加到该节点的 Nodes 属性

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-10T14:31:20.283

要将项目添加为父项：

```
var item = new TreeViewItem();
item.Header = "First Element";
tree.Items.Add(item); //tree is your treeview 
```

要将元素添加为特定元素的子元素：

```
var subItem = new TreeViewItem();
subItem.Header = "Subitem";
var parent = tree.SelectedItem as TreeViewItem;  // Checking for selected element
parent.Items.Add(subItem); 
```

# c# - InvalidCastException：无法将“System.Decimal”类型的对象转换为“System.String”类型

> ID：11216518
> 
> 赞同：2
> 
> 时间：2012-06-26T21:55:25.807
> 
> 标签：c#, asp.net, data-binding

我正在尝试从表格中获取销售价格并将其放入文本框中。在我的桌子上，销售价格是一个十进制变量，当然文本框是字符串。当我运行它时，有一个异常在我的数据访问层中停止它。

这是一些代码：

```
textSellPrice.Text = DAL.Util.getSellPrice(listItemsPricing.SelectedValue.ToString());

public static String getSellPrice(string item)
{
    string sql = "SELECT Price FROM Item it INNER JOIN Customers cu 
        ON it.SalesRep = Cu.SalesRep WHERE CustomerID='" 
        + HttpContext.Current.Session["SelectedCustomer"] +
        "' AND ProductID='" + item + "'";
    string dt = AdoUtil.GetDataColumn(sql);
    return dt;
}

    public static string GetDataColumn(string sqlQuery)
    {
        string result = String.Empty;
        try
        {
            SqlCommand cmd = new SqlCommand(sqlQuery, GetACESConn());

            if (cmd.Connection.State != ConnectionState.Open)
                cmd.Connection.Open();

            SqlDataReader reader = cmd.ExecuteReader();

            if (reader.HasRows)
                while (reader.Read())
                {
                    result = reader.GetString(0);
                }

            if (cmd.Connection.State != ConnectionState.Closed)
                cmd.Connection.Close();

            return result;
        }
        catch (Exception ex)
        {

            return result;
        }
    } 
```

那么有什么完全明显的东西我失踪了吗？
感谢您对此提供任何有用的见解，如果可以使用任何其他代码，我可以提供。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T21:57:07.263

您正在选择一个价格，大概是小数。所以不要调用`reader.GetString(0)`- 调用`reader.GetDecimal(0)`并将结果存储在`decimal`变量中。如果您*真的*想将所有内容转换为字符串，只需调用`GetValue(0).ToString()`.

当你在那里时，*请*解决这个问题：

```
string sql = "SELECT Price FROM Item it INNER JOIN Customers cu ON it.SalesRep = Cu.SalesRep WHERE CustomerID='" + HttpContext.Current.Session["SelectedCustomer"] +
    "' AND ProductID='" + item + "'"; 
```

这只是乞求[SQL 注入攻击](http://bobby-tables.com)。*不要*像这样将值直接放入 SQL 中。相反，使用*参数化*SQL 并指定这些参数的值。参见[`SqlCommand.Parameters`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.parameters.aspx)示例。

接下来，*不要*catch `Exception`，并且当抛出异常时不要返回值，就好像什么都没发生一样......你将无缘无故地掩盖错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T21:58:52.460

`CustomerId`在数据库中被声明为数字类型，但您正试图将其读取为字符串。如果您必须将结果作为字符串，您可以：

*   将其读取为数字类型（例如 a `decimal`）并在 C# 中转换为字符串，或者
*   更改您的 SQL 以将其转换`varchar`为 RDBMS 端

附带说明一下，您不应该将参数值烘焙到查询中以避免[Bobby Tables](http://xkcd.com/327/)；您需要改用[*参数化查询*](http://www.csharp-station.com/Tutorial/AdoDotNet/lesson06)。

# windows-phone-7 - Windows Phone 芒果与 Windows Phone 7

> ID：11216522
> 
> 赞同：1
> 
> 时间：2012-06-26T21:55:44.853
> 
> 标签：windows-phone-7

我是 Windows Phone 开发的新手。当我在网上搜索 Windows Phone 的代码示例时，有时我会看到有 Windows Phone Mango 的项目。有人能告诉我 Windows Phone 7 和 Windows Phone Mango 之间的区别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:23:54.367

Mango 确实是 Windows Phone 7.5 更新的代号。Windows Phone 7.5 中有很多新的 API 和功能，它带来了一个新的 SDK（版本 7.1）。针对 Windows Phone 7.0 SDK 的应用程序在 7.1 下运行良好，但针对 Windows Phone 7.1 SDK 的应用程序需要 Mango 更新才能运行。

[Windows Phone 站点](http://www.microsoft.com/windowsphone/en-us/howto/wp7/start/whats-new-in-windows-phone.aspx)列出了 Windows Phone 7.5（Mango 更新）中的新功能，[MSDN](http://msdn.microsoft.com/en-us/library/ff637516%28v=vs.92%29)列出了 7.0 SDK 和 7.1 SDK 之间的 API 更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T07:23:41.227

您无需担心。任何适用于 pre-mango 的东西都适用于芒果。因此大多数代码都可以工作。

你只会为 7.5 aka mango 开发，因为所有现有的手机都可以升级到 mango，而运行 7.0 的手机将无法进入市场，因为微软强迫每个人升级到 7.5

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:59:03.043

Mango 是 Windows Phone 7.5 的代号。您将看到的唯一区别可能是 Mango 教程中的一些更新的代码示例。

# c++ - 内置 C++ 函数，可对两个字符串进行不区分大小写的比较

> ID：11216526
> 
> 赞同：1
> 
> 时间：2012-06-26T21:56:01.837
> 
> 标签：c++, string

C++ 库中是否有任何内置函数能够对两个字符串进行不区分大小写的比较？我知道简单的方法，例如使用 toupper/tolower，自己编写函数。我想知道 string.h 库或其他库中是否有任何东西能够满足上述目标。这里，C 的 strcasecmp 不支持字符串，所以在 C++ 中没有太多帮助。它只适用于 char *。任何帮助将不胜感激。

PS Boost 库不会有太大帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T00:07:00.573

如果你愿意调用`strcasecmp`，那么你也可以在 C++ 中调用它：

```
int cmp_result = strcasecmp(s1.c_str(), s2.c_str()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T21:59:55.523

空无一人。除了简单地存储它之外，C++ 不提供任何有意义的文本支持。你将不得不看重症监护病房。

# networking - 在本地网络内转发到同一网络

> ID：11216527
> 
> 赞同：2
> 
> 时间：2012-06-26T21:56:08.617
> 
> 标签：networking, routing, iptables, openwrt

我的路由器上有基于 OpenWrt 8.09 的 X-Wrt

我有几台计算机的家庭局域网，上面有一些网络服务器（SVN、Web 等）。对于我在路由器 (Linksys wrt54gl) 上进行转发以从 Internet 访问它的每项服务 ( `<my_external_ip>:<external_port> -> <some_internal_ip>:<internal_port>`)

但是在我的本地网络中，上述请求的这些资源是无法访问的（所以我需要重新配置`<some_internal_ip>:<internal_port>`才能访问）。

我在 /etc/hosts 中添加了一些行
`<my_external_ip> localhost`

所以现在所有来自本地网络的请求都`<my_external_ip>`转发到我的路由器，但进一步重定向到适当的端口不起作用。

请建议正确的重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T11:36:38.047

如果我没记错的话，OpenWrt 允许您定义自定义 DNS 条目。因此，也许只需为您的源（即 svnserver.local）提供适当的本地名称并将它们映射到特定的本地 IP。这样你甚至不需要通过路由器从本地网络访问本地资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T12:03:19.283

您需要为从内部网络传出并定向到公共 IP 的呼叫安装 IP 重定向。通常这些数据包会被丢弃。您想将它们重新路由，DNATting 到目标服务器，但也伪装成服务器，看到您，它的客户端，在同一个网络中，不会使用其内部 IP（您，客户端）直接响应您，没有在那里发送数据包，将丢弃）。

我在 OpenWRT 组上找到了这个：

```
iptables -t nat -A prerouting_rule -d YOURPUBLICIP -p tcp --dport PORT -j DNAT --to YOURSERVER
iptables -A forwarding_rule -p tcp --dport PORT -d YOURSERVER -j ACCEPT
iptables -t nat -A postrouting_rule -s YOURNETWORK -p tcp --dport PORT -d YOURSERVER -j MASQUERADE 
```

[https://forum.openwrt.org/viewtopic.php?id=4030](https://forum.openwrt.org/viewtopic.php?id=4030)

# php - magento 中的会话超时事件

> ID：11216529
> 
> 赞同：2
> 
> 时间：2012-06-26T21:56:48.193
> 
> 标签：php, magento

我想在用户注销时做一些自定义功能，所以我连接到客户注销事件，并添加了一个观察者。

这是config.xml中的配置

```
<customer_logout>
  <observers>
    <cwmyaccount>
      <type>singleton</type>
      <class>KrtMalta_Myaccount_Model_Observer</class>
      <method>setRegularCustomer</method>
    </cwmyaccount>
  </observers>
</customer_logout> 
```

但是，即使在会话超时时，我也希望执行我的自定义功能。我查了谷歌和 Magento 文件，但几乎没有成功。是否有可能以某种方式连接到会话超时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:09:42.873

[当会话启动时，PHP 会自动清理会话，除非您编写自己的自定义会话处理程序](http://www.php.net/manual/en/session.customhandler.php)，否则目前无法挂接到此过程。

如果您编写自己的处理程序，那么 PHP 将调用您的`gc`方法，让您控制被销毁的旧会话数据。请记住，这发生在请求开始时（当 session_start() 被调用时），因此您希望您所做的任何处理都很快发生，以免延迟正在处理的请求。

# javascript - Datejs获取日期之间的差异

> ID：11216536
> 
> 赞同：1
> 
> 时间：2012-06-26T21:57:24.400
> 
> 标签：javascript

所以这是我的目标，我想知道某个日期多久以前是一个可读性很强的字符串。类似于：'4 天 3 小时前'。我正在使用 datejs，并且我的两个日期目前都是纪元。

我知道我可以从另一个时期减去一个时期，取差值，然后手动计算要输出的字符串。但这感觉就像 datejs 可以处理的事情。但是，我没有看到任何文档（与此相关的任何 js lib）表达了将日期对象或纪元转换为时间量的方法。

关于如何最好地处理这个问题的任何想法？

**更新**

让我更清楚。当我说人类可读时，这意味着

*   1 天前是“昨天”
*   2 天前是“2 天前”
*   30 秒前是“刚刚”
*   1 年 3 天 12 秒前是“1 年前”

**我最终做了什么**

```
 prettyAgo = (ago) ->
        ago = ago.getTime() if typeof ago is 'object'
        diff = ((new Date()).getTime() - ago) / 1000
        dayDiff = Math.floor(diff / 86400)
        return false if isNaN(dayDiff) or dayDiff < 0

        writer = ''

        if dayDiff is 0
            if diff < 1 then writer             = 'just now'
            else if diff < 60 then writer       = Math.floor(diff)+' seconds ago'
            else if diff < 120 then writer      = '1 minute ago'
            else if diff < 3600 then writer     = Math.floor(diff / 60)+' minutes ago'
            else if diff < 7200 then writer     = '1 hour ago'
            else if diff < 86400 then writer    = Math.floor(diff / 3600)+' hours ago'
        else if dayDiff is 1 then writer        = 'yesterday'
        else if dayDiff < 7 then writer         = dayDiff+' days ago'
        else if dayDiff is 7 then writer        = '1 week ago'
        else if dayDiff < 31 then writer        = Math.ceil( dayDiff / 7 )+' weeks ago'
        else writer                             = new Date(ago).toString 'MMM yyyy'

        return writer 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:12:56.117

DateJS 确实通过包含一个名为 TimeSpan 的类（在 time.js 中定义，而不是在基本 JS 文件中定义）来处理这个问题，该类为您进行计算。它不进行格式化，所以你需要这样的东西：

```
function showDiff(date1, date2) {
    var diff, rv, yrs;

    diff = new TimeSpan(date2 - date1);
    if (diff.days > 0) {
        // A day or more difference
        if (diff.days === 1) {
            rv = "yesterday";
        }
        else if (diff.days >= 365) {
            yrs = diff.days / 365;
            if (yrs === 1) {
                rv = "1 year ago";
            }
            else {
                rv = yrs + " years ago";
            }
        }
        else {
            rv = diff.days + " ago";
        }
    }
    else {
        // Less than 1 day difference
        if (diff.hours > 0) {
            if (diff.hours === 1) {
                rv = "1 hour ago";
            }
            else {
                rv = diff.hours + " hours ago";
            }
        }
        else if (diff.minutes > 0) {
            if (diff.minutes === 1) {
                rv = "1 minute ago";
            }
            else {
                rv = diff.minutes + " minutes ago";
            }
        }
        else {
            rv = "just now";
        }

        return rv;
    } 
```

显然这并不完美，也不能处理闰年等等，但它应该给你这个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:13:54.590

实际上，您可以在纯 JavaScript 中做到这一点。

```
function format(num) {
    var date = new Date(num),
        time = [];
    with(time) {
        push(date.getUTCDate() - 1);
        push(date.getUTCHours());
        push(date.getUTCMinutes());
        push(date.getUTCSeconds());
    }
    if (time[0] > 29) {
        time[0] = Math.floor(date / 86400000);
    }
    return time[0] + " day " + time[1] + " hours " + time[2] + " mintues " + time[3] + " seconds ago";
} 
```

[http://jsfiddle.net/DerekL/NqTnF/](http://jsfiddle.net/DerekL/NqTnF/)

# git - 推动而不提交

> ID：11216537
> 
> 赞同：7
> 
> 时间：2012-06-26T21:57:28.707
> 
> 标签：git

我有一个 git repo，我只是将它推送到服务器。然后我在服务器上设置了一个接收后挂钩。我想检查它是否有效。我必须再次提交以查看它是否有效？我真的很想在尝试设置此设置时强制推动，而不是继续进行没有实际价值的提交。它不起作用，我就是不明白。

```
$ git push --force origin master
Everything up-to-date 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T21:59:45.077

您需要推送一个较旧的提交来实现这一点。例如，您可以使用以下注释在当前 HEAD 之前推送提交：

```
git push --force origin HEAD^:master 
```

在此之后，您可以再次推送 HEAD 提交：

```
git push origin master 
```

但是，与其一直推送，不如考虑手动调用钩子。这通常更容易——但当你认为一切正常时，不要忘记用实际的推动来测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-06T11:46:37.137

您可以使用一些肮脏的技巧：

```
git stash save && git push --force origin "stash@{0}:master" && git stash pop 
```

这做了 3 件事：

1.  存储当前未提交的更改。存储创建一个新的提交，但在一个单独的参考上。它不会弄脏你的历史。此外，它会从更改中清除工作目录。请参见步骤 3。
2.  推送隐藏的代码
3.  弹出存储 - 清除存储并将所有文件放回您的工作目录。

这将有效地将所有文件推送到远程，而无需创建本地提交。

# api - IMDB API 检索字符信息

> ID：11216538
> 
> 赞同：2
> 
> 时间：2012-06-26T21:57:32.247
> 
> 标签：api, imdb

是否有用于检索字符信息的 IMDB API？假设我知道角色的确切名称？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T22:13:53.413

有两个公开的、未记录的 api 可能随时更改，因为它们未记录且不受支持

其中之一为您提供了一些带有演员相关信息的 json：[http](http://www.imdb.com/xml/find?json=1&nr=1&nm=on&q=) ://www.imdb.com/xml/find?json=1&nr=1&nm=on& q= {NAME+OF+ACTOR}

例如：[http ://www.imdb.com/xml/find?json=1&nr=1&nm=on&q=jessica+simpson](http://www.imdb.com/xml/find?json=1&nr=1&nm=on&q=jessica+simpson)

可以通过这个问题找到更多详细信息，特别是这个答案[IMDB 是否提供 API？](https://stackoverflow.com/questions/1966503/does-imdb-provide-an-api/7744369#7744369)

# jquery - jQuery：滚动时，DIV 始终位于可见内容的右下角

> ID：11216539
> 
> 赞同：0
> 
> 时间：2012-06-26T21:57:32.950
> 
> 标签：jquery, scroll, position, css-position

我正在尝试确定确保特定 DIV 始终距底部 20px 和距右侧 20px 的最佳方法，即使用户滚动也是如此。

```
<body>
<div id="wrap">
<p>Some content</p>
</div>
<div class="social-badges"><!-- this is the box that will always be at the bottom right --></div>
</body>

$(window).scroll(function() {
        console.log('scrolling');
        $(".tba-social-slider").css({"position" : "absolute", "bottom" : "20px", "right" : "20px"});
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:00:06.087

固定的 CSS 位置应该可以解决问题：

```
.tba-social-slider{
  position: fixed;
  bottom: 20px;
  right: 20px;
} 
```

IMO 不需要 Javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:03:40.437

这段代码。

```
$(document).ready(function() {

    var div = $('.social-badges');
    var start = $(div).offset().top;

    $.event.add(window, "scroll", function() {
        var p = $(window).scrollTop() + $(window).height();
        $(div).css('position',((p)>start) ? 'fixed' : 'static');
        $(div).css('top',((p)>start) ? '5px' : '');
    });
}); 
```

这应该有效，但不确定。:)

# javascript - tty.js 不起作用

> ID：11216540
> 
> 赞同：1
> 
> 时间：2012-06-26T21:57:46.460
> 
> 标签：javascript, node.js, socket.io, tty

我安装了 tty.js：`$ npm install -g tty.js` 然后我启动它：`$ tty.js`

当我调用[http://example.com:8080/](http://example.com:8080/)时，我无法打开终端并且[http://example.com:8080/socket.io/socket.io.js](http://example.com:8080/socket.io/socket.io.js)返回 http 错误 404。

我尝试使用节点 0.6.19。

[我在github 上](https://github.com/chjj/tty.js/issues/32)发帖，但也许来自 stackoverflow 的人可以提供帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T07:41:06.343

您不应该使用“example.com”，它是一个外部域，而是您自己的机器。尝试用 localhost 甚至 127.0.0.1 替换它，如下所示：

```
http://localhost:8080 
```

# php - MySQL 服务器已消失 - MySQL 错误 2006：

> ID：11216548
> 
> 赞同：0
> 
> 时间：2012-06-26T21:58:31.090
> 
> 标签：php, mysql, database, windows-server-2003

尝试编辑其中一个数据库中的表数据时，由于错误，我无法应用更改

> “MySQL 错误 2006：mysql 服务器已消失”`

这个问题是间歇性的。所以我对此进行了一些研究，并遇到了这篇[文章](http://Stackoverflow.com/questions/7942154/mysql-error-2006-mysql-server-has-gone-away)。（注意：我对数据库和 php 一无所知）。现在我看到 mysql_ping Ping 一个服务器连接，或者如果没有连接则重新连接它。

听起来很棒。我的问题是如何应用这个 mysql_ping？我该去哪里做呢？可以应用它还是会影响某些事情？

我的服务器在 Windows 2003、IIS 上运行，我有 PHP 5.3.8。我看过[这里，](http://ie2.php.net/mysql-ping)但我正在努力理解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:04:05.257

制作一个包含 的子例程/函数`mysql_ping`，并将其用于`mysql_query`.

例如

```
<?php
function my_query($sql)
{
   if(!mysql_ping())
   {
      if(!mysql_connect( /* add connection parameters here */ ))
      {
         trigger_error("Database not avaible: " . mysql_error());
         return FALSE;
      }
   }

   return mysql_query($sql);
}
?> 
```

# java - 我应该如何在spring mvc中跨控制器发送resourcebundle消息？

> ID：11216550
> 
> 赞同：0
> 
> 时间：2012-06-26T21:58:41.947
> 
> 标签：java, spring, spring-mvc, resourcebundle

大多数 Spring 教程和示例向您展示了如何从资源文件中获取消息以及如何在您的视图 (jsp) 中显示它，而不是您应该如何在控制器中和视图之间处理这些消息。

这是我现在如何做的一个例子，我有一个处理忘记密码的视图/控制器。发送密码后，我会重定向回登录屏幕，并显示“您的密码已发送...”的消息

```
@RequestMapping(value="/forgottenpassword")
public String forgottenpassword(@RequestParam String email) {
     ....something something
     if(email != null){
         return "redirect:/login?forgottenpassword=ok";
     }
}

@RequestMapping(value="/login")
public String login(HttpServletRequest request) {
    if(request.getParameter("forgottenpassword") != null && request.getParameter("forgottenpassword").equals("ok")) {
        data.put("ok_forgottenpassword", "forgottenpassword.ok");
    }

    return "login";
} 
```

最后我在我的视图中显示消息，在这种情况下是一个 freemarker 模板

```
<#if (ok_forgottenpassword?exists)>
     <div class="alert alert-success"><@spring.message "${ok_forgottenpassword}" /></div>
</#if> 
```

这是在 Spring 框架中执行此操作的最佳方式吗？只有 1 种类型的消息很简单，但如果我需要 5 种呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:21:26.447

只需创建一个简单的 bean 并将其推送到数据中。在该 bean 中，您可以拥有所有想要从资源包中加载的消息。（顺便说一句：你*真的*需要资源包吗？它做了一些花哨的技巧，除非你需要 i18n，否则完全没有必要。一个简单的属性文件在几乎所有其他情况下就足够了。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:39:23.713

将错误添加到控制器中的列表中，例如

```
List<String> errorsList = new ArrayList<String>();
errorsList.add("error.invalid.username");
errorsList.add("error.invalid.password");
errorsList.add("error.invalid.passwordResetLinkSent");
..... 
```

然后在jsp页面中迭代所有错误以显示

```
 <c:if test="${!empty errorsList}">
    <ul>
    <c:forEach var="error" items="${errorsList}">
        <li><spring:message message="${error}"></spring:message></li>
    </c:forEach>
    </ul>
  </c:if> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T10:37:21.520

这种技术被称为 flash 消息，并在 Spring 3.1 中实现，如以下答案所示：[https ://stackoverflow.com/a/7808960/142824](https://stackoverflow.com/a/7808960/142824)

# f# - extern 访问修饰符不起作用

> ID：11216552
> 
> 赞同：4
> 
> 时间：2012-06-26T21:58:47.613
> 
> 标签：f#, pinvoke, access-modifiers

我试图隐藏我的 P/Invoke 函数，比如这个：

```
[<DllImport("kernel32.dll", SetLastError=true)>]
extern bool private CreateTimerQueueTimer(IntPtr& phNewTimer, nativeint TimerQueue, WaitOrTimerDelegate Callback, nativeint Parameter, uint32 DueTime, uint32 Period, ExecuteFlags Flags) 
```

但奇怪的是，它们`private`被忽略了——这真的很烦人，因为我想隐藏与这些函数相关的所有笨拙的结构和枚举。

我想我可以把所有东西都放在一个私有模块中，所以这没什么大不了的，但我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:00:01.910

这将完成这项工作。

```
module a =
    [<AbstractClass>]
    type private NativeMethods() =
        [<DllImport("kernel32.dll", EntryPoint="CreateTimerQueueTimer",
                    SetLastError=true)>]
        static extern bool sCreateTimerQueueTimer( (* whatever *) )
        static member CreateTimerQueueTimer = sCreateTimerQueueTimer

    let usedInside = NativeMethods.CreateTimerQueueTimer

module b =
    open a
    // the next line fails to compile
    let usedOutside = NativeMethods.CreateTimerQueueTimer( (* whatever *) ) 
```

笔记：

*   *私有*类只能从封闭模块访问，这是您需要的，因此只需将方法包装在一个`NativeMethods`类中；
*   您不能将*extern*方法设置为*私有*，因为它不能从模块的其余部分访问`a`；
*   *类的extern*成员始终是*private*，因此还有另一个具有相同签名的方法；
*   最后，用于`EntryPoint`解析命名。

# iphone - 使用 AccessToken 从 TabBarViewController 注销到 UIViewController

> ID：11216554
> 
> 赞同：5
> 
> 时间：2012-06-26T21:58:54.150
> 
> 标签：iphone, objective-c, web-services, soap, uitabbarcontroller

我在如何从“TabBarViewController”注销到“UIViewController”时遇到问题。首先，我从 UIViewController 页面登录（使用 SOAP Web 服务 + XML 解析），如果用户 ID 和密码正确，则在数据库中生成“访问令牌”并且（使用我们页面中的 XML 解析在变量中收集）并加载 TabBarViewController （用户个人资料页面）。现在登录后我想“注销”。在个人资料页面上，我放置了一个名为“注销”的按钮。

现在在这里，我需要您的帮助，如何使用“访问令牌”（在成功登录期间生成）注销，以便我再次返回登录页面 ?????

下面是当我在 UITextField 中输入“用户 ID”和“密码”后按“登录”按钮时运行的代码：

```
-(IBAction)Login{

   txtuser.text = @"test";
   txtpwd.text = @"test";

    if([txtuser.text isEqualToString:@"" ]|| [txtpwd.text isEqualToString:@""]) 
    {
        UIAlertView *myAlert = [[UIAlertView alloc]
                                initWithTitle:nil message:@"Please fill all fields" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [myAlert show];
        [myAlert release];
    }
    else
    {

    md5 =[txtpwd text];

   //Calling MD5 Method to Convert password into "hashcode"(Hexadecimal) formate
    md5 = [md5 MD5];

    NSLog(@"%@",md5);
    itmselected =FALSE; 
```

// 调用 Web 服务方法

```
 NSString *soapmessage = [NSString stringWithFormat:@"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"
                             "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n"
                             "<soap:Body>\n"
                             "<Login xmlns=\"http://boleapp.com/\">\n"
                             "<UserName>%@</UserName>\n"
                             "<PassHash>%@</PassHash>\n"
                             "</Login>\n"
                             " </soap:Body>\n"
                             " </soap:Envelope>\n",[txtuser text],md5];
    NSLog(@"%@",soapmessage);
    NSURL *url = [NSURL URLWithString:@"http://weibotest.dotnetgeekz.com/servicemain.asmx"];
    NSMutableURLRequest *req = [[NSMutableURLRequest alloc]initWithURL:url];

    NSString *msglength = [NSString stringWithFormat:@"%d",[soapmessage length]];
    [req addValue:@" text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [req addValue:@"http://boleapp.com/Login" forHTTPHeaderField:@"SOAPAction"];
    [req addValue:msglength forHTTPHeaderField:@"Content-Length"];
    [req setHTTPMethod:@"POST"];
    [req setHTTPBody:[soapmessage dataUsingEncoding:NSUTF8StringEncoding]];
    [NSURLConnection connectionWithRequest:req delegate:self];
    webadata = [[NSMutableData alloc]init];
    [txtuser resignFirstResponder];
    [txtpwd resignFirstResponder];   
    }
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{
    [webadata appendData:data];    
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error{
    NSLog(@"error");
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection{
    xmlparser = [[NSXMLParser alloc]initWithData:webadata];
    [xmlparser setDelegate:self];
    [xmlparser parse];
}

-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{

    if([elementName isEqualToString:@"Login"])

        soapresult = [[NSMutableString alloc]init];
    itmselected = YES;

}

-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    if(itmselected){
        NSLog(@"Bool value and Access Token Number and UserID= %@",string);

        if([string isEqualToString:@"false"]){
            [invaliduser setImage:[UIImage imageNamed:@"invalid_username.png"]];

        }
        else{
        NSArray* splits = [string componentsSeparatedByString: @","];
        NSString *strbool = [splits objectAtIndex:0];
        NSString *strAtoken = [splits objectAtIndex:1];
        id UserIdLogin = [splits objectAtIndex:2];
         if ([strbool isEqualToString:@"true"]){

             main.strAccessTokenMain = strAtoken; 
             main.UserIdMain = UserIdLogin;
             NSLog(@"strAccessTokenMain = %@",[main strAccessTokenMain]);

             // Calling "showtabbar" method for Loading TabBarViewController page
             [main showtabbar];      
        }
        }
        [soapresult appendString:string]; 
    }
}

-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

    if([elementName isEqualToString:@"LoginResult"]){
        itmselected = NO;
    }
} 
```

// 用于启动 TabBarViewController 的 "showtabbar" 方法

-（无效）显示标签栏{

```
//Removing UIViewController's 'Login' page
[self.view removeFromSuperview];
[BoleApp release];

NSLog(@"userID = %@",UserIdMain);
tabbarcontroller = [[UITabBarController alloc]init ];

//Creating Object of "Profile" Class for Launching as First tab of TabBarViewController
profile *view1 = [[profile alloc]initWithNibName:@"profile" bundle:nil ];
view1.strAccessToken = strAccessTokenMain;
view1.UserIdProfile = UserIdMain;
NSLog(@"view1str = %@",view1.strAccessToken);
view1.title = @"Profile";
view1.tabBarItem.image = [UIImage imageNamed:@"profile.png"];   

//Second Tab of TabBarViewController
Brandslist *view2 = [[Brandslist alloc]init];
view2.BrandAccToken = strAccessTokenMain;
view2.UserIdBrndList = UserIdMain;
Instruction *view3 = [[Instruction alloc]init];
settings *view4 = [[settings alloc]init];
view2.title = @"Brands";
view2.tabBarItem.image = [UIImage imageNamed:@"brands.png"];

// Third Tab of TabBarViewController
view3.title = @"Info";
view3.tabBarItem.image = [UIImage imageNamed:@"info.png"];

// Fourth Tab of TabBarViewController
view4.title = @"Settings";
view4.tabBarItem.image = [UIImage imageNamed:@"settings.png"];
view4.AccessToken = strAccessTokenMain;
view4.user_ID = UserIdMain;

[tabbarcontroller setViewControllers:[NSArray arrayWithObjects:view1,view2,view3,view4, nil]];

[mainWindow addSubview:tabbarcontroller.view]; 
```

}

这是我的个人资料页面的“注销”方法，我想在其中编写从个人资料页面注销到登录页面的代码（UIViewController）

```
-(IBAction)Logout{
    NSLog(@"Logout Button Clicked !!!");
  // What to code here for resuming back to Login page ????? Please Help me out 
    ?
    ?
    ?
} 
```

朋友，请恢复。您的帮助将不胜感激。谢谢， Tauseef Khan

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:11:25.813

而不是使用, `[mainWindow addSubview]`, 使用`mainWindow.rootViewController = tabbarcontroller;`

这样，当按下注销按钮时，您只需要添加如下内容：

```
mainWindow.rootViewController = loginViewController; 
```

使用它，您只需更改主窗口上显示的视图控制器，您可以在新登录后以相同的方式再次切换到选项卡栏控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:43:23.607

`loginViewController`显示为模态视图控制器会很方便。这样，`loginViewController`如果服务器返回授权错误，您始终可以呈现模式。

# javascript - Sencha Touch 2 它与我的 html5/javascript Web 开发知识有何关系

> ID：11216558
> 
> 赞同：0
> 
> 时间：2012-06-26T21:59:16.803
> 
> 标签：javascript, html, sencha-touch-2

所以我一直在学习 HTML5 和 javascript（包括与这两者相关的所有其他东西），现在我实习的经理要求我使用 Sencha Touch 2。我发现我所学的一切几乎无关紧要。我觉得 Sencha Touch 2 中的工作方式与使用 html5/javascript 的 Web 开发几乎完全不同……唯一常见的就是一点点 html 和 css。我是对的还是错的？知道过去几周我在 javascript/html5 上变得更好，才知道它对 sencha touch 2 没有用，我感到不满意。我还没有深入了解 Sencha Touch，但这就是我目前的感受

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:06:35.883

看起来大多数 Sencha 控件/小部件都是使用 javascript 代码配置的，并且整个框架都是基于 javascript 构建的。我不会说javascript没有用，恰恰相反。但是你可能会觉得你使用框架本身比纯粹的 javascript 更多。

JQuery 也是如此。它基本上只是一个为 javascript 构建的框架，但使用它可能感觉完全不同。

需要记住的一件事是，您对语言了解得越多，学习和使用使用它的框架就越容易。而且您总是必须将框架编织到网页或应用程序中，因此您也必须使用 javascript 和 HTML5。

# iphone - 用 AVAudioPlayer 播放声音

> ID：11216559
> 
> 赞同：0
> 
> 时间：2012-06-26T21:59:20.567
> 
> 标签：iphone, objective-c

我正在尝试使用 Xcode for iPhone 在 Objective c 中播放 mp3 文件。

在 viewDidLoad 中：

```
 NSURL *mySoundURL = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/mySound.mp3", [[NSBundle mainBundle] resourcePath]]];

NSError *myError;
mySound = [[AVAudioPlayer alloc] fileURLWithPath:heartBeatURL error:&myError];
[mySound play]; 
```

我在这里找到了一个建议：[使用 AVAudioPlayer 播放声音时出现问题？](https://stackoverflow.com/questions/7304803/problem-while-playing-sound-using-avaudioplayer)

但它对我不起作用，它只会产生更多问题。

当程序启动时，我在输出中得到这个并且程序崩溃：

体系结构 i386 的未定义符号：“_OBJC_CLASS_$_AVAudioPlayer”，引用自：SecondViewController.o 中的 objc-class-ref ld：未找到体系结构 i386 的符号 collect2：ld 返回 1 个退出状态

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:07:50.880

在我看来，您还没有将 AVFoundation 框架链接到您的应用程序中。

假设最近的 xcode 足够：

1.  在左侧的 Project Navigator 中选择您的项目
2.  选择你的目标
3.  选择构建阶段
4.  将 AVFoundation.framework 添加到 Link Binary With Libraries 阶段

这是一些工作的 AVAudioPlayer 代码进行比较：

```
NSURL *mySoundURL = [NSURL URLWithString:[[NSBundle mainBundle] pathForResource:@"BadTouch" ofType:@"mp3"]];
NSError *myError;
self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:mySoundURL error:&myError];
[self.player play]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T06:12:13.400

将 AVFoundation.framework 添加到您的项目目标`Link Binary With Libraries`

然后在你的.h中导入：

```
#import <AVFoundation/AVFoundation.h>

@interface ViewController : UIViewController <AVAudioPlayerDelegate> {

    AVAudioPlayer *player;
    }
@property (strong,nonatomic) AVAudioPlayer *player;

@end 
```

在你的 .m 中：

```
 @synthesize player;

    NSString* resourcePath = [[NSBundle mainBundle] resourcePath];
    resourcePath = [resourcePath stringByAppendingString:@"/mySound.mp3"];
    NSLog(@"Path to play: %@", resourcePath);
    NSError* err;

    //Initialize our player pointing to the path to our resource
    player = [[AVAudioPlayer alloc] initWithContentsOfURL:
              [NSURL fileURLWithPath:resourcePath] error:&err];

    if( err ){
        //bail!
        NSLog(@"Failed with reason: %@", [err localizedDescription]);
    }
    else{
        //set our delegate and begin playback
        player.delegate = self;
        [player play];

    } 
```

# php - 将 index 和 index.php 视为同一个文件

> ID：11216563
> 
> 赞同：0
> 
> 时间：2012-06-26T21:59:28.910
> 
> 标签：php, apache, .htaccess, mod-rewrite, indexing

我正在使用 Apache 2.2.22 和 PHP 5.3.10 开发一个 PHP 项目，并且遇到了 index 和 index.php 被视为同一个文件的问题。

我有一个 admin/index.php 重定向到 admin/index 以允许我在 .htaccess 中的 mod_rewrite 规则接管并将请求重新路由到自定义框架中。问题是，当浏览器转到 admin/index 时，它会进入无限重定向循环，因为请求被发送到 admin/index.php 重定向到 admin/index

我尝试删除 htaccess 文件以查看导致它的 mod_rewrite 规则是否存在问题并且它没有改变任何东西。它只是无休止地重定向到 admin/index。

我以前从未听说过这种行为，浏览一些谷歌结果并浏览 apache 配置文件并没有显示任何明显的东西。有没有人见过这个并且知道如何解决它？

编辑：下面是 index.php 用来重定向到索引的代码。

```
<?php
    header("Location: index");
    die(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:42:25.453

这可能是由于启用了 MultiViews：

> MultiViews 的效果如下：如果服务器收到对 /some/dir/foo 的请求，如果 /some/dir 启用了 MultiViews，并且 /some/dir/foo 不存在，则服务器读取目录寻找名为 foo.* 的文件，并有效地伪造了一个类型映射，该类型映射为所有这些文件命名，为它们分配相同的媒体类型和内容编码，如果客户端按名称要求其中一个。然后它选择最符合客户要求的匹配项。
> 
> — [https://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews](https://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews)

尝试添加`Options -MultiViews`到您的`.htaccess`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:11:29.653

在 Apache 中启用重写日志并提高日志级别。这样，apache 会一步一步准确地告诉你，什么请求被重写，如何重写，以什么顺序以及为什么重写。

# three.js - three.js 中的粒子与粒子系统

> ID：11216564
> 
> 赞同：5
> 
> 时间：2012-06-26T21:59:36.460
> 
> 标签：three.js

我正在努力实现我正在处理的涉及一系列重复图像的可视化。我让它与带有 ParticleSystem 的单个精灵一起工作，但我只能将单个材质应用于系统。由于我想在纹理之间进行选择，我尝试创建一个粒子对象池，以便我可以单独选择材质，但我无法让单个粒子显示在 WebGL 渲染器中。

这是我第一次涉足 WebGL/Three.js，所以我可能正在做一些愚蠢的事情，但我认为值得问一下正确的方法是什么。我看到了三种可能性：

*   我使用了错误的粒子（使用贴图材质初始化、添加到场景、设置位置），我需要修复我正在做的事情。
*   对于要显示的每个精灵，我都需要一个 ParticleSystem。
*   我所做的根本不适合粒子，我真的应该使用另一种对象类型。

我看到的所有使用画布渲染器的示例都直接使用 Particle，但我找不到使用不使用 ParticleSystem 的 WebGL 渲染器的示例。有什么提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T00:59:19.400

好的，我将从我在这个[**github 问题页面**](https://github.com/mrdoob/three.js/issues/1430)的其他地方阅读的内容开始。你应该从阅读它开始。Particle 似乎只是用于 Canvas Renderer，在 Three.JS 的进一步版本中它将成为 Sprite。然而，ParticleSystem 似乎也无法满足您的需求。我认为这些类不会帮助您在 3D 中使用 WebGL 完成此任务。无论如何，根据您所做的事情，使用 CanvasRenderer 可能会更好。ParticleSystem 将只允许您应用一种材料，该材料将作为您建议的系统中每个粒子的材料。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:12:17.847

简短的回答：您只能`THREE.Particle`使用渲染`THREE.CanvasRenderer`。

# django - django-cms：apphooks 使用的 url 不适用于 reverse() 或 {% url %}

> ID：11216565
> 
> 赞同：12
> 
> 时间：2012-06-26T21:59:44.010
> 
> 标签：django, url, content-management-system, reverse, django-cms

我正在使用带有 apphooks 的 django-cms 来显示图书详细信息。我需要带有应用程序挂钩的页面来接受指定要显示哪本书的 slug。

我创建了一个名为“books”的页面并添加了 apphook 'BookDetailApp'。

这是我的 books.cms_app 文件的样子：

```
class BooksApp (CMSApp):
    name = _('Book Detail Page Application')
    urls = ['books.urls']

apphook_pool.register(BooksApp) 
```

这是我的 books.urls 的样子：

```
urlpatterns = patterns('',
    url(r'^(?P<slug>[\w\-]+)?', BookDetailView.as_view(), name='book_detail'),
) 
```

这是我的 books.views 文件的样子：

```
class BookDetailView (DetailView):
    model = Book
    template_name = 'layouts/book-detail.html'
    context_object_name = 'book' 
```

当我直接进入预订详情页面时，这一切都很好。所以要`http://localhost:8000/books/the-book-slug/`按照我想要的方式工作。

问题是我需要能够从主页上的促销链接到特定的书籍详细信息页面，并且没有任何预期的方法对我有用。

使用 django-cms 中的 page_url 模板标签不起作用，因为它只接受一个参数，所以我无法提供确定要显示哪本书所需的 slug：

```
<a href="{% page_url 'book_detail' %}">go</a> 
```

正如预期的那样，这只会重定向到`http://localhost:8000/books/`哪个引发错误，因为没有包含所需的 slug。

所以我的下一个选择是使用 url 模板标签或`get_absolute_url()`在模型上定义一个函数。这些选项都不起作用：

```
<a href="{% url book_detail book.slug %}">go</a>

def get_absolute_url(self):
    return reverse('book_detail', args=[self.slug]) 
```

这两者都会导致`NoReverseMatch: Reverse for 'book_detail' not found`错误。

如果我在我的主 url conf 中包含 books.urls conf，那么它就可以工作。因此，如果 url 仅由 cms apphook 使用，则 django 无法将其反转。

在我的主要 url 中包含 books.urls 似乎是一个肮脏的解决方案，我绝对不想在模板或`get_absolute_url`函数中对 url 进行硬编码。这些解决方案都不是很“pythonesque”。

有什么建议么？

**编辑：**

仅当我使用语言命名空间时，反向才有效。根据文档指定语言命名空间不应该是必需的。

```
>>> reverse('en:book_detail', args=[book.slug]) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-24T21:51:43.157

这显然是由于我们的应用程序`cms.middleware.multilingual.MultilingualURLMiddleware`强制所有`{% url %}`模板标签和`reverse()`函数需要语言命名空间。

由于我们的网站未本地化，因此删除中间件效果很好。我对此的文档似乎并不那么清楚，最后从另一个来源找到了答案。

# c# - 如何在不上传完整的 SQLCLR 程序集的情况下从 T-SQL 调用 BCL 类型的实例方法？

> ID：11216567
> 
> 赞同：1
> 
> 时间：2012-06-26T21:59:52.280
> 
> 标签：c#, tsql, datetime, sqlclr, datetimeoffset

我在表中有一个 datetimeoffset 列，行中有不同的 TZ 偏移量。我想通过 BCL 类型 System.DateTimeOffset 上的[ToLocalTime](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.tolocaltime.aspx)方法全部运行它们（由于夏令时，我不能只使用[SWITCHOFFSET](http://msdn.microsoft.com/en-us/library/bb677244.aspx)函数）。'clr enabled' 已重新配置。

“蛮力”方法似乎是使用静态方法创建一个静态类，例如：

```
public static class DateTimeUtils
{
    [SqlFunction]
    public static DateTimeOffset ToLocalTimeZone(DateTimeOffset input)
    {
        return input.ToLocalTime();
    }
} 
```

有没有更简单的方法可以调用 BCL 类型/方法，而不必为此在数据库中创建程序集？

我希望我能够只调用 SQL 类型的方法，但没有这样的运气。尝试这样的事情：

```
DECLARE @foo datetimeoffset = getdate()

select [datetimeoffset]::ToLocalTime(@foo) 
```

...给

```
Msg 258, Level 15, State 1, Line 3
Cannot call methods on datetimeoffset. 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:15:06.130

不，没有。在研究了很多之后，我得出了这个结论。这是我对同一问题的解决方案：[https ://stackoverflow.com/a/11063348/122718](https://stackoverflow.com/a/11063348/122718)

# c++ - 类声明中缺少分号

> ID：11216569
> 
> 赞同：2
> 
> 时间：2012-06-26T21:59:56.923
> 
> 标签：c++, syntax-error

我怀疑这是一个非常小的问题，但我花了几个小时试图修复它，但没有找到任何东西。

在 Game.h （头文件）中，我有以下内容：

```
#pragma once

#include "PlayEngine.h"

class Game {

public:
    int Init();
    int Run();
    int Shutdown();

private:
    enum State { ST_MENU, ST_PLAYING } state;
    PlayEngine* playengine_;
}; 
```

编译器在 上抛出语法错误`PlayEngine* playengine_`，抱怨`;`在`*`. PlayEngine 是我在其他地方定义的一个类。

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T22:05:16.640

代替

```
#include "PlayEngine.h" 
```

和

```
class PlayEngine; 
```

对于这种情况，声明就足够了。（我打赌来源是循环包含）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T22:05:50.153

删除枚举声明末尾的状态。并单独声明变量。

```
#pragma once
#include "PlayEngine.h"  
class Game {  
    public:     
        int Init();     
        int Run();     
        int Shutdown();  
    private:     
        enum State { ST_MENU, ST_PLAYING };  
        State state;   
        PlayEngine* playengine_; 
}; 
```

# asp.net-mvc-4 - 以复杂对象为参数的 Web Api 调用

> ID：11216576
> 
> 赞同：1
> 
> 时间：2012-06-26T22:00:31.310
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我的 webApi 控制器

```
[HttpPost]
public ISearchProviderCommandResult ExecuteCommand(ISearchProviderCommand command)
{
  MySearchProvider searchProvider = new MySearchProvider();
  return searchProvider.ExecuteCommand(command);
} 
```

我的 searchCommand 对象

```
[Serializable]
class SearchProviderCommand : ISearchProviderCommand
{
  public string OperationContext {get; set;}
  public string OperationId{get; set;}
} 
```

我的 webapi 控制器中有一个断点，并且 HttpWebResponse response = (HttpWebResponse)request.GetResponse(); 行上有一个断点。

当我尝试进入 webapi 控制器时，我收到 500 错误，它甚至没有命中 webapi 控制器内的断点。以下是我的问题：

1.  我究竟做错了什么？
2.  我可以将复杂对象发送到 Web api 请求吗？

编辑：根据 asp.net 论坛和 leons 的指示，我将 WebApi 控制器更改为使用对象而不是接口，它可以工作：

```
[HttpPost]
public SearchProviderCommandResult ExecuteCommand(SearchProviderCommand command)
{
  MySearchProvider searchProvider = new MySearchProvider();
  return searchProvider.ExecuteCommand(command);
} 
```

你能告诉我如何从结果中重建我的对象吗？

编辑：基于 leon 的建议 - 对于那些对此感兴趣的人，我的最终调用者代码

```
public result ExecuteCommand(ISearchProviderCommand searchCommand)
{
  //serialize the object before sending it in
  JavaScriptSerializer serializer = new JavaScriptSerializer();
  string jsonInput = serializer.Serialize(searchCommand);

  HttpClient httpClient = new HttpClient() { BaseAddress = new Uri(ServiceUrl) };
  StringContent content = new StringContent(jsonInput, Encoding.UTF8, "application/json");
  var output = httpClient.PostAsync(ServiceUrl, content).Result;

  //deserialize the output of the webapi call
  result c = serializer.Deserialize<result>(output.Content.ReadAsStringAsync().Result);

  return c;
 }
}

public class result : ISearchProviderCommandResult
{
  public object Result { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T09:22:43.880

您正在使用 BinaryFormatter？您不应该将您的请求编码为 JSON，因为这就是您要发送的内容吗？

# jquery - 自定义 jQuery 表单滑块

> ID：11216578
> 
> 赞同：0
> 
> 时间：2012-06-26T22:01:06.703
> 
> 标签：jquery, jquery-ui, jquery-ui-slider

我有一个带有一些输入滑块的网页，就像这样：http: [//jqueryui.com/demos/slider/#steps](http://jqueryui.com/demos/slider/#steps)。

我需要的是强制用户在按下提交按钮之前移动滑块。

所以我正在考虑将手柄的默认颜色设置为红色，如果他在红色时按下提交，则会出现一个警告窗口，警告他需要单击或移动手柄。当然，当他这样做时，颜色会改变，他将能够继续。

我到目前为止是：

```
<html>
    <head>
        <meta charset="utf-8">
        <link type="text/css" href="jQuery/css/start/jquery-ui-1.8.21.custom.css" rel="stylesheet" />   
        <script type="text/javascript" src="jQuery/js/jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="jQuery/js/jquery-ui-1.8.21.custom.min.js"></script>
            <style>
                #demo-frame > div.demo { padding: 10px !important; };
            </style>
        <script>
            $(document).ready(function() {
                $(".slider").slider({
                    step: 0.01,
                    min: 0,
                    max: 1,
                    value: 0.5,
                    slide: function(event, ui) {
                        $("input[name=" + $(this).attr("id") + "_question]").val(ui.value); 
                        }
                });
            });

        </script>

        <form action="next.php" method="POST">
                <input type="hidden" value=0.5 name="first_question"/>
            <div class="demo">
                <p>
                    <label>question 1:</label>
                </p>
                <div class="slider" id="first"></div>   
                <br />
                <br />
                <input type="hidden" value=0.5 name="second_question"/>
                <p>
                    <label>question 2:</label>
                </p>
                <div class="slider" id="second"></div>
            </div><!-- End demo -->
                <br />
                <input type="submit" value="submit" id="bt"/>
        </form>
    </body>
</html> 
```

这实现起来太复杂了吗？欢迎任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T10:45:53.413

这绝对可以做到。我建议将滑块是否已与 HTML 数据属性进行交互。您可以在`slide`已有的事件中进行设置。然后在提交表单时，您可以确保为所有滑块设置了数据属性。

我整理了一个示例，它做了一些基本的视觉内容来向用户展示 - [http://jsfiddle.net/s6XTu/2/](http://jsfiddle.net/s6XTu/2/)。

# java - 为什么 EJB 线程安全而 servlet 不安全？

> ID：11216579
> 
> 赞同：9
> 
> 时间：2012-06-26T22:01:09.510
> 
> 标签：java, multithreading, servlets, thread-safety, ejb

根据我的理解，servlet 容器创建有限的 servlet 实例和每个 servlet 实例的多个线程，并重用这些线程和实例。

因为一个线程有多个实例，所以它们不是“线程安全的”（尽管我知道用线程安全对它们进行编码并不困难）。

另一方面，EJB 容器不创建 EJB 线程，而是仅重用 EJB 对象（使用池）。由于 EJB 实例没有多个线程，因此不存在线程安全问题。

我的问题：为什么会有不同的行为？让 EJB 作为 Servlet 工作（线程不安全）不是一个好主意吗？

我确定我遗漏了一些东西，并想了解那个遗漏的部分。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T01:30:23.767

您的问题的最短答案当然是让 EJB 能够像 Servlet 一样工作是一个好主意，在 EJB 3.1 中，我们添加了一个可以完全做到这一点的组件：`@Singleton`

一个`@Singleton`bean 可以像 servlet 一样是多线程的，通过以下任一方式：

*   使用`@ConcurrencyManagement(BEAN)`
*   与需要并发的方法和非线程安全的方法`@ConcurrencyManagement(CONTAINER)`一起使用。`@Lock(READ)``@Lock(WRITE)`

Servlet 多年来一直拥有而 EJB 从未拥有的另一件事是，`<load-on-startup>`它允许 Servlet 急切地加载并在应用程序启动时工作。

为了匹配 Servlet `<load-on-start>`，我们添加了`@Startup`可以添加到任何`@Singleton`EJB 的注解，并将导致它在应用程序启动时启动。这些 bean 将`@PostConstruct`在应用程序启动时调用它们的方法，并`@PreDestroy`在应用程序关闭时调用它们。

与其使用数字 ( ) 来指示使用start 注释的 bean`<load-on-startup>1</load-on-startup>`的顺序，不如使用并指定需要在带注释的 bean 之前启动的 bean 的列表。`@Startup``@DependsOn`

我们在 EJB 3.1 中为对齐 Servlet 和 EJB 所做的一个鲜为人知和理解的方面当然是允许将 EJB 打包到`.war`文件中——这不是鲜为人知的部分——当我们这样做时，我们悄悄地改变了定义of`java:comp/env`以匹配 Servlet 方法。

在 EJB 3.1 之前，不可能有两个 EJB 共享一个`java:comp/env`名称空间（`java:comp/env`在 EJB 规范中是 bean 范围的）。相比之下，Servlet 从来没有任何方式让单个 Servlet 拥有自己的私有`java:comp/env`命名空间（`java:comp/env`在 Servlet 规范中是模块范围的）。因此，在 EJB 3.1 中，打包在 war 中的 EJB 将具有与 webapp 中的所有其他 Servlet 和 EJB 相同的模块范围命名空间，这与打包在 EAR 中时 EJB 获得`java:comp/env`的 bean 范围命名空间形成了很大的对比`java:comp/env`一场战争之外。我们就那个争论了好几个星期。

不错的一点啤酒时间琐事，可以用来测验你的朋友。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-26T22:13:44.217

可能是因为它们在设计时没有考虑到相同的目标。

servlet API 是一个简单的 API，非常接近 HTTP 协议，您可以在其之上构建应用程序或框架。HTTP 协议是完全无状态的，我想构建一个无状态的 API 也是有意义的。几个建立在 servlet API 之上的框架（例如 Stripes），每个请求使用一个 Action 实例，它不是同时使用的。

EJB 是一个复杂得多的高级框架，旨在尽可能简单地实现事务性业务逻辑。它更重量级，并且具有有状态的组件。这些显然需要是线程安全的。我想因此使无状态 bean 成为线程安全的也是很自然的。

应该注意的是，例如 Spring bean，默认情况下是单例的，因此必须遵循与 servlet 相同的规则。因此，多种设计可以提供或多或少相同的功能。

线程与性能优化无关。如果需要同时处理 3 个请求，则需要 3 个线程，无论请求是发送到 servlet 还是发送到 EJB。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T22:39:25.740

您的最佳答案直接来自[javax.servlet.SingleThreadedModel](http://docs.oracle.com/javaee/1.4/api/javax/servlet/SingleThreadModel.html)接口的 Javadoc：

> **已弃用。**从 Java Servlet API 2.4 开始，没有直接替换。
> 
> `public interface SingleThreadModel`
> 
> 确保 servlet 一次只处理一个请求。这个接口没有方法。
> 
> 如果一个 servlet 实现了这个接口，就可以*保证*在 servlet 的 service 方法中不会有两个线程同时执行。servlet 容器可以通过同步对 servlet 的单个实例的访问，或者通过维护一个 servlet 实例池并将每个新请求分派给一个空闲的 servlet 来保证这一点。
> 
> 请注意，SingleThreadModel*并不能解决所有线程安全问题*。例如，会话属性和静态变量仍然可以被多个线程上的多个请求同时访问，即使使用 SingleThreadModel servlet 也是如此。建议开发人员采取其他方式来解决这些问题，而不是实现此接口，例如避免使用实例变量或同步访问这些资源的代码块。此接口在 Servlet API 版本 2.4 中已弃用。

# java - 来自leetcode的Java中的4sum实现

> ID：11216582
> 
> 赞同：1
> 
> 时间：2012-06-26T22:01:44.397
> 
> 标签：java, algorithm

leetcode 的问题陈述说：

> 给定一个包含 n 个整数的数组 S，S 中是否存在元素 a、b、c 和 d 使得 a + b + c + d = target？在给出目标总和的数组中找到所有唯一的四元组。

笔记：

```
Elements in a quadruplet (a,b,c,d) must be in non-descending order. (ie, a ≤ b ≤ c ≤ d)
The solution set must not contain duplicate quadruplets. 
```

关于这个四和问题，我有两个问题：

1.  我哪里出错了？编译后的代码无法通过所有测试，但我认为代码应该是正确的，因为它只是使用蛮力解决问题。
2.  有没有有效的方法来解决四和问题而不是这个 O(n^4) 运行时算法？

* * *

```
import java.util.List;
import java.util.ArrayList;
import java.util.Collections;

public class FourSumSolution{
    public ArrayList<ArrayList<Integer>> fourSum(int[] num, int target){
        ArrayList<ArrayList<Integer>> aList = new ArrayList<ArrayList<Integer>>();
        int N = num.length;

        for(int i=0; i<N; i++)
            for(int j=i+1; j<N; j++)
                for(int k=j+1; k<N; k++)
                    for(int l=k+1; l<N; l++){
                        int sum = num[i] + num[j] + num[k] + num[l];                        
                        if(sum == target){
                            ArrayList<Integer> tempArray = new ArrayList<Integer>();
                            Collections.addAll(tempArray, num[i], num[j], num[k], num[l]);
                            aList.add(tempArray);
                        }
                    }
        return aList;   
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T12:54:32.393

这是一个 O(n^3) 解决方案

```
import java.util.Arrays;
import java.util.ArrayList;
import java.util.HashSet;
public class Solution {
public ArrayList<ArrayList<Integer>> fourSum(int[] num, int target) {
    // Start typing your Java solution below
    // DO NOT write main() function

    Arrays.sort(num);
    HashSet<ArrayList<Integer>> hSet = new HashSet<ArrayList<Integer>>();
    ArrayList<ArrayList<Integer>> result = new ArrayList<ArrayList<Integer>>();
    for (int i = 0; i < num.length; i++) {
        for (int j = i + 1; j < num.length; j++) {
            for (int k = j + 1, l = num.length - 1; k < l;) {
                int sum = num[i] + num[j] + num[k] + num[l];
                if (sum > target) {
                    l--;
                }
                else if (sum < target) {
                    k++;
                }
                else if (sum == target) {
                    ArrayList<Integer> found = new ArrayList<Integer>();
                    found.add(num[i]);
                    found.add(num[j]);
                    found.add(num[k]);
                    found.add(num[l]);
                    if (!hSet.contains(found)) {
                        hSet.add(found);
                        result.add(found);
                    }

                    k++;
                    l--;

                }
            }
        }
    }
    return result;
} 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T03:10:40.670

这是一个不使用哈希的解决方案。应该会更快，但还是超过了时间限制。

```
import java.util.ArrayList;

public class Solution {
    public static void main(String[] args) {

      int[] S = {1, 0, -1, 0, -2, 2};
      int target = 0;
      test(S, target);
    }

    public static void test(int[] num, int target) {
      System.out.print("a:");
      for (int i : num) {
        System.out.print(" " + i);
      }
      System.out.println(": " + target);
      ArrayList<ArrayList<Integer>> res = fourSum(num, target);
      for (ArrayList<Integer> list : res) {
        System.out.println(list);
      }
      System.out.println();
    }

    // a+b+c+d = target
    public static ArrayList<ArrayList<Integer>> fourSum(int[] num, int target) {
        // Start typing your Java solution below
        // DO NOT write main() function

       // Sort
       {
        for (int i = 0; i < num.length; i++) {
            for (int j = i + 1; j < num.length; j++) {
                if (num[j] < num[i]) {
                    int tmp = num[i];
                    num[i] = num[j];
                    num[j] = tmp;
                }
            }
        }
       }
      ArrayList<ArrayList<Integer>> res = new ArrayList<ArrayList<Integer>>();
      int i = 0;
      while (i < num.length - 3) {
        int j = i + 1;
        while (j < num.length - 2) {
            int k = j + 1, l = num.length - 1;
            while (k < l) {
                int sum = num[i] + num[j] + num[k] + num[l];
                if (sum > target) {
                    l--;
                    while (k < l && num[l] == num[l+1]) l--;
                } else if (sum < target) {
                    k++;
                    while (k < l && num[k] == num[k-1]) k++;
                } else {
                    ArrayList<Integer> list =
                        new ArrayList<Integer>(4);
                    list.add(num[i]); list.add(num[j]);
                    list.add(num[k]); list.add(num[l]);
                    res.add(list);
                    k++;
                    while (k < l && num[k] == num[k-1]) k++;
                    l--;
                    while (k < l && num[l] == num[l+1]) l--;
                }
            }
            j++;
            while (j < num.length && num[j] == num[j-1]) j++;
        }
        i++;
        while (i < num.length && num[i] == num[i-1]) {
            i++;
        }
      }

      return res;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:53:55.927

您的解决方案显然计算正确。但是，如果一个值在输入数组中出现多次，则会给出“相同”的结果。也许那是经过测试的。

num = { 1, 3, 1, 3, 4 } 与 target = 4 的“twoSum”将是：

*   { 1, 3 }
*   { 1, 3 }
*   { 3, 1 }
*   { 1, 3 }

这是测试失败的原因，解决方案可能是**一组有序列表**。

如果还必须给出子集，则缺少 { 4 }。

*所以问题是，为什么测试失败了，有什么要求。*

优化可能涉及特殊的数据结构：至少一个（反向）排序的 num。许多链接已经给出。递归可以帮助找到一个**可证明**和可理解的最优解，包括前置条件和后置条件。（当您拆分问题时。）

一种解决方案是创建对，保持对总和到导致该总和的所有索引对的映射。然后找到两对具有分离索引的对。

* * *

***由于没有人给出满意的答案：***

一个简单的递归解决方案（不是很好或最优）。然而，它表明数据结构是相关的。

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.SortedSet;
import java.util.TreeSet;

public class FourSumSolution {

    private static class SortedTuple implements Comparable<SortedTuple> {
        int[] values;

        public SortedTuple(int... values) {
            this.values = Arrays.copyOf(values, values.length);
            Arrays.sort(this.values);
        }

        public int size() {
            return values.length;
        }

        public int get(int index) {
            return values[index];
        }

        public ArrayList<Integer> asList() {
            // Result type is ArrayList and not the better List,
            // because of the external API of the outer class.
            ArrayList<Integer> list = new ArrayList<Integer>(values.length);
            for (int value: values)
                list.add(value);
            return list;
        }

        @Override
        public int hashCode() {
            final int prime = 31;
            int result = 1;
            result = prime * result + Arrays.hashCode(values);
            return result;
        }

        @Override
        public boolean equals(Object obj) {
            if (this == obj)
                return true;
            if (obj == null)
                return false;
            if (getClass() != obj.getClass())
                return false;
            SortedTuple other = (SortedTuple) obj;
            if (!Arrays.equals(values, other.values))
                return false;
            return true;
        }

        @Override
        public int compareTo(SortedTuple other) {
            int c = cmp(values.length, other.values.length);
            if (c == 0) {
                for (int i = 0; i < values.length; ++i) {
                    c = cmp(values[i], other.values[i]);
                    if (c != 0)
                        break;
                }
            }
            return c;
        }

        @Override
        public String toString() {
            return Arrays.toString(values);
        }

        private static int cmp(int lhs, int rhs) {
            return lhs < rhs ? -1 : lhs > rhs ? 1 : 0; // Cannot overflow like lhs - rhs.
        }
    }

    public ArrayList<ArrayList<Integer>> fourSum(int[] num, int target) {
        final int nTerms = 4;
        SortedTuple values = new SortedTuple(num);
        SortedSet<SortedTuple> results = new TreeSet<SortedTuple>();
        int[] candidateTerms = new int[nTerms];
        int valuesCount = values.size();
        solveNSum(target, nTerms, values, results, candidateTerms, valuesCount);

        ArrayList<ArrayList<Integer>> aList = new ArrayList<ArrayList<Integer>>();
        for (SortedTuple solution: results) {
            aList.add(solution.asList());
        }
        return aList;   
    }

    public static void main(String[] args) {
        final int[] num = { 1, 3, 1, 3, 4 };
        final int requiredSum = 4;
        final int nTerms = 2;

        SortedTuple values = new SortedTuple(num);
        SortedSet<SortedTuple> results = new TreeSet<SortedTuple>();
        int[] candidateTerms = new int[nTerms];
        int valuesCount = values.size();
        solveNSum(requiredSum, nTerms, values, results, candidateTerms, valuesCount);

        System.out.println("Solutions:");
        for (SortedTuple solution: results) {
            System.out.println("Solution: " + solution);
        }
        System.out.println("End of solutions.");
    }

    private static void solveNSum(int requiredSum, int nTerms, SortedTuple values, SortedSet<SortedTuple> results, int[] candidateTerms, int valuesCount) {
        if (nTerms <= 0) {
            if (requiredSum == 0)
                results.add(new SortedTuple(candidateTerms));
            return;
        }
        if (valuesCount <= 0) {
            return;
        }

        --valuesCount;
        int candidateTerm = values.get(valuesCount);

        // Try with candidate term:
        candidateTerms[nTerms - 1] = candidateTerm;
        solveNSum(requiredSum - candidateTerm, nTerms - 1, values, results, candidateTerms, valuesCount);

        // Try without candidate term:
        solveNSum(requiredSum, nTerms, values, results, candidateTerms, valuesCount);
    }
} 
```

可以进一步修剪：

*   如果 (nTerms - 1) 最低加上候选词给出的总和太大，则跳过候选词；
*   如果候选词加上下一个 (nTerms -1) 词太小，则终止。
*   如果 valuesCount < nTerms 则终止

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-08T22:37:21.403

```
public ArrayList<ArrayList<Integer>> fourSum(int[] num, int target) {
    Arrays.sort(num);
    ArrayList<ArrayList<Integer>> res=new ArrayList<ArrayList<Integer>>();
    int i=0;
    while(i<num.length-3){
        int j=i+1;
        while(j<num.length-2){
            int left=j+1, right=num.length-1;
            while(left<right){
                if(num[left]+num[right]==target-num[i]-num[j]){
                    ArrayList<Integer> t=new ArrayList<Integer>();
                    t.add(num[i]);
                    t.add(num[j]);
                    t.add(num[left]);
                    t.add(num[right]);
                    res.add(t);
                    left++;
                    right--;
                    while(left<right && num[left]==num[left-1])
                        left++;
                    while(left<right && num[right]==num[right+1])
                        right--;
                }else if(num[left]+num[right]>target-num[i]-num[j])
                    right--;
                else
                    left++;
            }
            j++;
            while(j<num.length-2 && num[j]==num[j-1])
                j++;
        }
        i++;
        while(i<num.length-3 && num[i]==num[i-1])
            i++;
    }
    return res;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-04T12:34:25.220

公共类 FourSum {

```
private static int countFourSum(int[] numbers) {
    int count = 0;
    for (int j = 0; j < numbers.length; j++) {
        for (int i = j + 1; i < numbers.length; i++) {
            int front = i + 1, rear = numbers.length - 1;

            while (front < rear) {
                if (numbers[front] + numbers[rear] + numbers[i] + numbers[j] == 0) {
                    System.out.printf(String.format("{%d} : {%d} : {%d} : {%d}  \n", numbers[front], numbers[rear],
                            numbers[j], numbers[i]));
                    front++;
                    rear--;
                    count++;
                } else {
                    if (Math.abs(numbers[front]) > Math.abs(numbers[rear])) {
                        front++;
                    } else {
                        rear--;
                    }
                }
            }
        }

    }
    return count;
}

public static void main(String[] args) {
    int[] numbers = { 1, 2, 3, 4, -4, -5, -6, 2, 4, -1 };
    Arrays.sort(numbers);
    System.out.println(countFourSum(numbers));
} 
```

}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-05T17:51:59.777

您的解决方案可能已超过时间限制，因此可能无法通过测试用例。下面是具有运行时的代码`O(n^3)`。最初，我们对数组进行排序，这将帮助我们根据要查找的数字向前或向后移动来找到元素。然后我们从数组中取出第一个元素并对剩余部分执行三和，从而找到二和。仅`ArrayList`使用 。`HashMap`不需要。

```
public static List<List<Integer>> fourSum(int[] nums, int target) {
    List<List<Integer>> result = new ArrayList<List<Integer>>();

    if(nums==null|| nums.length<4)
        return result;

    Arrays.sort(nums);

    for(int i=0; i<nums.length-3; i++)
    {
        if(i!=0 && nums[i]==nums[i-1]) continue; //Avoid duplicate elements

        for(int j=i+1; j<nums.length-2; j++)
        {
            if(j!=i+1 && nums[j]==nums[j-1]) continue; //Avoid duplicate elements

            int k=j+1;
            int l=nums.length-1;

            while(k<l)
            {
               if(nums[i]+nums[j]+nums[k]+nums[l]<target)
               {
                  k++;
               }
               else if(nums[i]+nums[j]+nums[k]+nums[l]>target)
               {
                  l--;
               }
               else
               {
                  List<Integer> t = new ArrayList<Integer>();
                  t.add(nums[i]);
                  t.add(nums[j]);
                  t.add(nums[k]);
                  t.add(nums[l]);
                  result.add(t);

                  k++;
                  l--;

                  while( k<l &&nums[l]==nums[l-1] ) l--;
                  while( k<l &&nums[k]==nums[k+1] ) k++;
                }
              }
           }
       }
    return result;
} 
```

# drupal-6 - Drupal 6 不加载 page-user.tpl.php 文件

> ID：11216583
> 
> 赞同：0
> 
> 时间：2012-06-26T22:01:44.723
> 
> 标签：drupal-6, drupal-theming

我正在运行 Drupal 6 安装并使用 domainname.com/user 来使用 Drupal 的特殊功能（即，如果用户未登录，则显示登录屏幕，如果登录，则显示用户的配置文件）。问题是我创建了一个 page-user.tpl.php 文件并将它放在我正在使用的主题目录下的模板目录中。里面还有 page.tpl.php 文件，所以 Drupal 应该找到这些模板文件。我遇到的问题是 Drupal 没有加载 page-user.tpl.php 文件，而是加载了 page.tpl.php 文件。我已经清除了很多次缓存，但它仍然没有加载。

我不知道出了什么问题。有人可以帮助我，因为我正在拔头发。我已经用谷歌搜索了答案，但找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T12:01:06.717

1.  你说你清除了缓存，但你是怎么做到的？你确定你清除了主题注册表缓存吗？如果您使用[admin_menu](http://drupal.org/project/admin_menu)模块或转到某个视图 -> ，则可以一键完成`theme: information`。
2.  要查看调用了哪些模板文件和函数，请安装[devel](http://drupal.org/project/devel)模块。您将在那里看到确切的模板（以及用于更深入主题的模板建议）。

# ios - 如何重新命名（和重新分发）iOS iPad 应用程序？

> ID：11216587
> 
> 赞同：15
> 
> 时间：2012-06-26T22:02:08.280
> 
> 标签：ios, app-store

我在 App Store 中有应用程序。一位客户来找我，问他是否可以在他的 iPad 上安装相同的应用程序，但名称不同、图形不同，其他改动也很少——其中有 150 台。如果那将是 10 个 iPad - 我会进行自定义构建，将所有 iPad 添加到配置证书中，就是这样。但这不适用于 150 台 iPad。那么我的选择是什么？到目前为止，我可以考虑以下几点：

1.  再开 2 个开发者帐户并在其中添加 UUID - 但我感觉 Apple 不会喜欢这样。
2.  进行所需的更改 - 并以不同的名称将应用程序提交到 App Store
3.  通过企业分发解决一些问题 - 但我认为从法律角度来看它不会起作用 - 我的客户希望在他客户的 iPad 上安装应用程序 - 所以它显然不是“内部”分发。

到目前为止，**选项 #2 对我来说看起来最有希望**- 作为不同的应用程序提交到 App Store。但恐怕Apple不会让几乎相同的应用程序进入App Store。特别是如果我从与主应用程序相同的帐户提交它。苹果可以为此阻止我吗？还有其他想法吗？

* * *

**更新和解决方案**

我将在这里将我的学习与@vikingosegundo 的答案结合起来。

**更新到选项 2 - 以不同的名称提交到应用商店**：

一些链接说这是可能的：http: [//developer.appcelerator.com/question/123906/white-label-apps---is-approval-possible-apple-](http://developer.appcelerator.com/question/123906/white-label-apps---is-approval-possible-apple-) - 可以这样做。[我在应用商店审查指南](https://developer.apple.com/app-store/review/guidelines/)中没有发现对此的明确限制 ：

> 2.20 开发者在 App Store 中“发送垃圾邮件”包含许多类似应用程序的版本将被从 iOS 开发者计划中移除

我不相信两个或三个会算多，如果你清楚地重新命名它会被视为垃圾邮件。但这当然取决于苹果。

**选项 #3 的更新 - 与企业发行版一起使用：**

这就是我最后决定做的。我打电话给苹果支持@1-800-633-2152 - 真人回答 :) 我最担心的是我想要分发应用程序的 iPad 不属于我客户的业务 - 所以从技术上讲它不是“内部分发” . 然而他们说

> 企业是可以的，因为该应用程序将由企业持有者（我的客户）使用，而谁拥有 iPad 并不重要

**新选项 #4 - 批量购买计划**

Apple 的[批量购买计划](https://www.apple.com/business/vpp/)看起来正是我们实际需要的：

> 批量购买计划还提供了一种获取由第三方开发人员构建的自定义 B2B 应用程序以满足您业务的独特需求的方法。

目前，您必须是美国企业才能加入此计划 - 但他们希望尽快将其扩展到更多国家/地区。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T22:33:28.690

我想，如果一个客户拥有 150 台 iPad，他可以被视为一个组织——iPod 就像“内部”（这个词的意思是什么）。您没有写任何关于您的客户的信息，但他应该检查一下，如果他可以获得[DUNS 号码](https://en.wikipedia.org/wiki/Data_Universal_Numbering_System)，并为自己获取一个您可以管理以分发应用程序的企业帐户。

如果有可用的 DUNS 号码，我会选择**3。**

**2.**：我不认为苹果会喜欢更名的应用程序
我查看了[应用程序商店评论指南](https://developer.apple.com/app-store/review/guidelines/)。**2.20**和**2.22**可能适用。

**1** .：请记住，每个设备上的证书需要定期更新。对您或用户来说可能很麻烦。

PS：我还没有读过，但苹果有这本免费书籍：

*   [iOS 部署方案](http://itunes.apple.com/us/book/ios-deployment-scenarios/id499335673?mt=11), [[PDF](http://images.apple.com/iphone/business/docs/iOS_Business_Mar12.pdf)]
*   内部应用程序[开发加速器](http://itunes.apple.com/us/book/in-house-app-accelerator-guide/id499341792?mt=11)[[指南](http://images.apple.com/iphone/business/docs/In-house_App_Accelerator_Guide.pdf)]

PS2：也许[*批量购买商业计划*](https://developer.apple.com/programs/volume/b2b/)是一种方法，但目前仅在美国可用:(

> **快来了。**App Store 批量购买计划正在扩展到以下国家：澳大利亚、加拿大、法国、德国、意大利、日本、新西兰、西班牙和英国。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T23:25:10.427

I suggest doing #2 also...and when you write in Review Notes when you submit it that it's basically the same app only with some custom modifications ...after all you own the source code of the original app so you can release as many copies as you like.

You could write in the description too..that it's a modified version of the original app. I don't see any problems there.

A plus to this solution is that you might sell some of these apps too (i mean the modified version) and if you don't want it to remain on the app store just remove app from sale after your client bought the apps he wanted.

# android - 意图活动和警报对话框有问题

> ID：11216592
> 
> 赞同：0
> 
> 时间：2012-06-26T22:02:26.847
> 
> 标签：android, android-intent, android-alertdialog

我想知道是否有人可以帮助我。有一双新的眼睛来告诉我我做错了什么可能会很好，因为我就是找不到它。这可能是微不足道的，但我看不到。我基本上有一个按钮，单击该按钮会弹出一个自定义对话框，并要求用户在 SD 卡或设备内存之间做出选择。我觉得我在大多数情况下一切都正确，只是给了我一个类似于：onClick error on line71 的错误。

其他人能看到问题吗..

```
 public class MediaActivity extends Activity 
{
    /** Called when the activity is first created. */

      AlertDialog.Builder builder;
      AlertDialog alertDialog;
      ImageButton sdImage;
      ImageButton deviceImage;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Button startApp = (Button) findViewById(R.id.startButton);

        startApp.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) 
            {
                Context mContext = MediaActivity.this;
                LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(LAYOUT_INFLATER_SERVICE);
                View layout = inflater.inflate(R.layout.custlayout, (ViewGroup) findViewById(R.id.layout_root));

                TextView text = (TextView) layout.findViewById(R.id.text);
                //text.setText("Upload an Image or Video");

                builder = new AlertDialog.Builder(mContext);
                builder.setView(layout);
                alertDialog = builder.create();

                sdImage= (ImageButton) findViewById(R.id.sdImageButton);
                deviceImage = (ImageButton) findViewById(R.id.deviceImageButton);

                sdImage.setOnClickListener(new OnClickListener() {

                    @Override
                    public void onClick(View arg0) 
                    {
                         // Write your code here to invoke YES event
                        Intent goToSD = new Intent(arg0.getContext(),
                            Sdcard.class);
                        startActivity(goToSD);

                    }
                });

                deviceImage.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(View v) 
                    {
                        // TODO Auto-generated method stub

                    }
                });

                // Showing Alert Message

                alertDialog.show();

            }
        });

    }  

} 
```

谢谢一堆我真的很感激这一点，因为我已经有一段时间遇到麻烦了。这可能是我忽略的某种愚蠢的错误。

再次感谢你！

更新日志：

06-26 17:54:35.119: D/AndroidRuntime(24486): 关闭 VM 06-26 17:54:35.119: W/dalvikvm(24486): threadid=1: 线程退出未捕获异常 (group=0x40015560) 06 -26 17：54：35.119：E/AndroidRuntime（24486）：致命异常：主要 06-26 17：54：35.119：E/AndroidRuntime（24486）：java.lang.NullPointerException 06-26 17：54：35.119：E /AndroidRuntime(24486): 在 my.edu.org.MediaActivity$1.onClick(MediaActivity.java:71) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.view.View.performClick(查看.java:2485) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.view.View$PerformClick.run(View.java:9080) 06-26 17:54:35.119: E/AndroidRuntime (24486): 在 android.os.Handler.handleCallback(Handler.java:587) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.os.Handler.dispatchMessage(Handler.java:92) 06-26 17:54:35.119:E/AndroidRuntime(24486): 在 android.os.Looper.loop(Looper.java:130) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.app.ActivityThread.main(ActivityThread.java :3683) 06-26 17:54:35.119: E/AndroidRuntime(24486): at java.lang.reflect.Method.invokeNative(Native Method) 06-26 17:54:35.119: E/AndroidRuntime(24486): at java.lang.reflect.Method.invoke(Method.java:507) 06-26 17:54:35.119: E/AndroidRuntime(24486): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java :850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime （24486）：在dalvik.system.NativeStart.main（Native Method）////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////130) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在java.lang.reflect.Method.invokeNative(Native Method) 06-26 17:54:35.119: E/AndroidRuntime(24486): at java.lang.reflect.Method.invoke(Method.java:507) 06-26 17 :54:35.119: E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在com.android.internal.os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime(24486): at dalvik.system.NativeStart.main(Native Method) //// //////////////// 来自droider的建议的onClick实现。130) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在java.lang.reflect.Method.invokeNative(Native Method) 06-26 17:54:35.119: E/AndroidRuntime(24486): at java.lang.reflect.Method.invoke(Method.java:507) 06-26 17 :54:35.119: E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在com.android.internal.os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime(24486): at dalvik.system.NativeStart.main(Native Method) //// //////////////// 来自droider的建议的onClick实现。3683) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 java.lang.reflect.Method.invokeNative(Native Method) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 java .lang.reflect.Method.invoke(Method.java:507) 06-26 17:54:35.119: E/AndroidRuntime(24486): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java: 850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime( 24486）：在dalvik.system.NativeStart.main（Native Method）/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////3683) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 java.lang.reflect.Method.invokeNative(Native Method) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 java .lang.reflect.Method.invoke(Method.java:507) 06-26 17:54:35.119: E/AndroidRuntime(24486): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java: 850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime( 24486）：在dalvik.system.NativeStart.main（Native Method）/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 com.android.internal .os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime(24486): at dalvik.system.NativeStart.main(Native Method) ///////// //////////// 来自droider的建议的onClick实现。E/AndroidRuntime(24486): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:850) 06-26 17:54:35.119: E/AndroidRuntime(24486): 在 com.android.internal .os.ZygoteInit.main(ZygoteInit.java:608) 06-26 17:54:35.119: E/AndroidRuntime(24486): at dalvik.system.NativeStart.main(Native Method) ///////// //////////// 来自droider的建议的onClick实现。

```
@Override
    public void onClick(View v) 
    {
        switch(v.getId())
        {
        case R.id.sdImageButton: 
            Intent goToSD = new Intent(v.getContext(),
                    Sdcard.class);
            startActivity(goToSD);
            Toast.makeText(getApplicationContext(), "sdclicked", Toast.LENGTH_SHORT).show();
            break;

        case R.id.deviceImageButton:
            break;

        default:
            break;
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T00:01:38.003

编辑我的答案：

您需要在 OnCreate 方法中初始化 sdImage 和 deviceImage ImageButtons。

当前，您正在将 OnClickListener 分配给两个处于 null 状态的 ImageButton。

改变这个：

```
 @Override 
            public void onCreate(Bundle savedInstanceState) 
            { 
                super.onCreate(savedInstanceState); 
                setContentView(R.layout.main); 
                Button startApp = (Button) findViewById(R.id.startButton

    ); 

to this:

@Override     
    public void onCreate(Bundle savedInstanceState)     
    {     
        super.onCreate(savedInstanceState);     
        setContentView(R.layout.main);     
        Button startApp = (Button) findViewById(R.id.startButton);
        sdImage= (ImageButton) findViewById(R.id.sdImageButton);      
        deviceImage = (ImageButton) findViewById(R.id.deviceImageButton); 
```

# python - 在某些 lisp 语言上，此 Python 哈希写入/访问代码的等价物是什么？

> ID：11216594
> 
> 赞同：0
> 
> 时间：2012-06-26T22:02:34.117
> 
> 标签：python, data-structures, clojure, lisp, scheme

这个 Python 代码的等价物是什么：

```
class Player:
    def __init__(self): 
        self.hp = 10
        self.pos = [0,0,0]
        self.items = []
    def damage(self,dmg):
        self.hp -= dmg

player = Player()
player.damage(3)
player.pos[0] += 5
player.items.append("banana")

print player.hp, player.pos, player.items
>> 3 [5,0,0] ["banana"] 
```

在 Clojure（或其他 Lisps）中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:25:00.203

在 Clojure 中：

```
(def player {
    :hp 10
    :pos [0 0 0]
    :items [] })

(defn damage [player amount]
    (update-in player [:hp] - amount))

(defn move [player direction]
    (update-in player [:pos] #(map + % direction)))

(defn give [player item]
    (update-in player [:items] conj item))

(-> player
    (damage 3)
    (move [5 0 0])
    (give "banana"))

; Output: {:hp 7, :pos (5 0 0), :items ["banana"]} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T22:37:23.740

在 Clojure 中，您通常不会使用可变数据结构，而是创建一个描述玩家当前状态的不可变数据。对播放器的更新将创建一条描述更新状态的新数据。马特的回答给出了一个很好的例子。

如果你想随着时间的推移保持一个“玩家”身份并随着时间的推移而发生多次状态变化，你可以用一个原子来做到这一点，如下所示：

```
(def initial-player-state 
 {:hp 10
  :pos [0 0 0]
  :items []})

(def player (atom initial-player-state))

;; Define some update functions

(defn damage [player dmg]
  (update-in player [:hp] + dmg))

(defn move [player dir]
  (update-in player [:pos] #(vec (map + % dir))))

(defn add-item [player item]
  (update-in player [:items] conj item))

;;  Make some changes

(swap! player move [5 0 0])
(swap! player damage -3)
(swap! player add-item "Apple")

;; view the current player state by dereferencing the atom

@player
=> {:hp 10, :pos [0 0 0], :items ["Apple"]} 
```

请注意，在真正的游戏中，您可能在单个原子中拥有整个不可变的游戏状态，而不仅仅是玩家。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T23:10:59.560

在 Common Lisp 中：

```
(defclass player ()
  ((hp :accessor hp :initform 10)
   (pos :accessor pos :initform (list 0 0 0))
   (items :accessor items :initform nil)))

(defmethod damage ((a-player player) damage)
  (decf (hp a-player) damage)) 
```

在 REPL

```
; compiling (DEFCLASS PLAYER ...)
; compiling (DEFMETHOD DAMAGE ...)
CL-USER> (defparameter *player* (make-instance 'player))

*PLAYER*
CL-USER> (damage *player* 3)
7
CL-USER> (incf (car (pos *player*)) 5)
5
CL-USER> (push :banana (items *player*))
(:BANANA)
CL-USER> (list (hp *player*) (pos *player*) (items *player*))
(7 (5 0 0) (:BANANA))
CL-USER> 
```

就个人而言，我会分解`pos`成单独`x`的 ,`y`和`z`, 并且可能定义一些方法来将东西放入和取出库存，以防我以后决定更改表示。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-26T22:52:06.253

在[球拍](http://www.racket-lang.org)中：

```
#lang racket

(define player%
  (class object%
    (init-field [hp 10] [pos '(0 0 0)] [items '()])

    (define/public (damage dmg)
      (set! hp (- hp dmg)))

    (define/public (move dx dy dz)
      (set! pos (list (+ (first pos) dx)
                      (+ (second pos) dy)
                      (+ (third pos) dz))))

    (define/public (add-item item)
      (set! items (cons item items)))

    (super-new)))

(send* (new player%)
       (damage 3)
       (move 5 0 0)
       (add-item "banana")) 
```

如果您使用 Racket，您可能希望以更具功能性的风格进行编程，在这种情况下，您可以编写这样的方法来避免突变：

```
(define/public (damage dmg)
  (new this% [hp (- hp dmg)] [pos pos] [items items])) 
```

# r - 当参数数量未知时简洁地传递参数

> ID：11216595
> 
> 赞同：0
> 
> 时间：2012-06-26T22:02:35.737
> 
> 标签：r

许多 R 函数采用可变数量的参数。 `sum()`是一个例子：`sum(1, 2)`、`sum(1, 2, 3)`和`sum(1, 2, 3, 4)`都是有效的命令。

我需要编写以批处理模式运行的脚本。在这些脚本中，我需要将多个参数传递给一个函数。参数不会从命令行传入。它们必须是变量（不是对应于变量名的字符串）。它们都属于同一类，它们的名称将以相同的字符开头，但我不知道名称或参数的数量。有没有一种简洁的方法将变量传递给函数？

这是一个示例：我希望代码生成名称具有 pattern 的所有变量的总和`^int\\d$`。我知道至少有一个这样的变量，但我不知道有多少。此代码有效：

```
# Set up toy data
int1 <- 3
int2 <- 5

# Get the sum
argNames <- ls(pat='^int\\d$')
argNames.list <- as.list(argNames)
argNames.list <- lapply(argNames.list, function (x) get(x))
do.call(sum, argNames.list) 
```

我的反对意见是这段代码有点麻烦。将操作分散到四行会降低清晰度。有没有一种 R 惯用的方法可以用更少的代码行获得相同的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T04:35:35.263

将其全部封装在一个函数中并消除`lapply`and稍微简单一些`get`。 `ix`保存匹配名称的索引。

```
# sum those arguments whose names match ^int\\d$
sumint <- function(...) {
    arg.names <- as.character(match.call()[-1])
    ix <- grep("^int\\d$", arg.names)
    do.call("sum", list(...)[ix])
}

# test    
a <- b <- 10
int3 <- 30
sumint(a, int3, b, int3, b, pi) # 60 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T22:10:18.903

**（编辑以更好地解决问题）**

我不认为你可以做得比这更好，这对我来说似乎很少。

```
int1 <- 3
int2 <- 5

do.call(sum, lapply(ls(pat="^int\\d$"), get))
# [1] 8

## Or use a safer version that will only look for objects located in the 
## environment from which it was called.  
do.call(sum, lapply(ls(pat="^int\\d$"), get, envir=parent.frame(), inherits=FALSE)) 
```

# regex - 在每个正则表达式匹配之间插入新行？

> ID：11216599
> 
> 赞同：0
> 
> 时间：2012-06-26T22:02:58.267
> 
> 标签：regex, perl

我有这样的文字：

```
characters      value ∆delta     

ABCDEABCDE      -3.663  [analyze]
EFGHEFGHEF      -1.937  [analyze]
IJKLIJKLIJ      2.137   [analyze] 
```

我想提取数值

我用谷歌搜索了 regexp 并想出了这个 perl 单线

```
perl -p -i -e 's/[^0-9-.]//g' file.txt 
```

这对你来说一定看起来非常糟糕，但在这种情况下它似乎对我有用。唯一的问题是，文本文件现在看起来像

```
-3.663-1.9372.137 
```

但我希望它看起来像

```
-3.663
-1.937
2.137 
```

如何在此正则表达式的每个匹配项之间插入新行？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:09:16.413

您需要将换行符添加到您的角色类

```
perl -p -i -e 's/[^0-9-.\n]//g' file.txt 
```

这不会“添加”换行符，而是保留现有的换行符。还有其他方法可以基于列而不是正则表达式来完成此操作。

awk：

```
awk '{print $2}' file.txt > tmpfile.txt && mv tmpfile.txt file.txt 
```

重击/嘘：

```
while read -r _ data _; do
   echo "$data"
done < file.txt > tmpfile.txt
mv tmpfile.txt file.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:10:34.743

你应该没问题：

```
perl -p -i -e 's/[^-\d.\n\r]+//g' file.txt 
```

你也可以试试：

```
perl -p -i -e 's/[^-\d.]*(\-?[\d\.]+)[^-\d.]*/$1\n/g' file.txt 
```

或者，如果您的文本可能包含`.`或`-`不包含数字（例如`ABC-DEF.GHI -3.663 [analyze]`），则：

```
perl -p -i -e 's/(?:[^-\d.]+|\-(?!\d)|\.(?!\d))*(\-?(?:\d?\.?\d+|\d+\.?\d*))(?:[^-\d.]+|\-(?!\d)|\.(?!\d))*/$1\n/g' file.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:35:36.340

您有制表符分隔的数据，所以让我们利用它来获得最佳结果。

```
perl -i -F\\t -lanE'BEGIN { <>; <>; } say $F[2]' file.txt 
```

如果您的数据只是空格分隔，我建议

```
perl -i -lanE'BEGIN { <>; <>; } say $F[2]' file.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T22:59:58.923

解决您的问题的“简单”解决方案是使用该`-l`选项，它将为您处理行尾。在您的情况下，它将使用该`-p`选项为您的打印添加换行符。

```
perl -pi -le 's/[^0-9-.]//g' file.txt 
```

但是，此解决方案是破坏性的，因为输入文件被破坏，并且假定文件中不存在其他数字、破折号和句点。后者很容易损坏您的数据。

在我看来，ikegami 在制表符或空格上拆分的解决方案是最好的。但是，您也可以使用正则表达式提取完整的数字：

```
perl -nlwe 'print /(-?[\d.]+)/' file.txt 
```

这将提取由数字和句点组成的第一个字符串，并带有可选的前导破折号。如果要将输出保存到文件中，只需将其重定向

```
perl -nlwe 'print /(-?[\d.]+)/' file.txt > output.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T22:53:09.157

您的解决方案将如何运作？- 我只`-pe`改为`-lpe`：

```
 perl -i -lpe 's/[^0-9.-]//g' file.txt 
```

这可以缩短为：

```
 perl -i -lpe's/[^--9]//g' file.txt 
```

问候

rbo

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T19:17:37.673

感谢所有的答复。脚本在数字之间插入了一个新行，但没有删除文档中的空行（例如，我的第一个示例文本文件中的一个空行）。至少这就是我的测试文本文件的结果。我用谷歌搜索了如何删除空行，虽然我无法合并它，但我现在使用两个单行得到我想要的

```
perl -i -lpe's/[^--9]//g' file .txt
perl -pi -e "s/^\n//" file .txt 
```

# c++ - 是否有 Qt Dialog 或 Widget 以交互方式对字符串列表进行排序？

> ID：11216600
> 
> 赞同：1
> 
> 时间：2012-06-26T22:03:03.930
> 
> 标签：c++, qt, dialog

我需要提供一个重新排序对话框，让用户以交互方式对字符串列表进行排序。Qt 是否已经提供了适合此目的的东西？

我搜索了通常的论坛和示例，但没有找到合适的。

为了澄清我需要什么：

## 原始清单：

1.  FileBaz
2.  FileFoo
3.  文件栏

## 用户排序列表

1.  文件栏
2.  FileFoo
3.  FileBaz

因此，例如合并以前选择的 pdf 文件所需的任意顺序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:19:23.383

从来没听说过。然而，一个简单的`Move up`按钮和一个`Move down`与 a 协调的按钮`QListWidget`可能是有用的。`Up`并且`Down`会自然地在各个方向上移动列表项。

在我看来，更简单的是使用 a `QTreeWidget`，因为，如果我没记错的话，有一些简单的功能可以交换物品。类似的组合

```
void insertTopLevelItem ( int index, QTreeWidgetItem * item )
QTreeWidgetItem *itemAbove ( const QTreeWidgetItem * item )
QTreeWidgetItem *itemBelow ( const QTreeWidgetItem * item ) 
QTreeWidgetItem *currentItem ()
int indexOfTopLevelItem ( QTreeWidgetItem * item ) 
```

可能有用。（摘自[http://qt-project.org/doc/qt-4.8/QTreeWidget.html](http://qt-project.org/doc/qt-4.8/QTreeWidget.html)）

**编辑**：我用`QListWidget`的不多，但在交换物品的便利性方面似乎非常相似`QTreeWidget`。任何一个都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T04:04:43.787

Qt 已经支持它，您无需做任何事情：*标准视图自动支持内部拖放，在其中移动项目以更改它们的显示顺序。*

进一步引用文档：

*   要启用项目拖动，请将视图的`dragEnabled`属性设置为 true。
*   要允许用户在视图中放置内部或外部项目，请将视图的 viewport()`acceptDrops`属性设置为 true。
*   如果要向用户显示当前被拖动的项目将被放置在哪里，请设置视图的`showDropIndicator`属性。这为用户提供了关于视图内项目放置的持续更新信息。
*   为了使用户能够在视图中移动项目，我们必须将列表小部件的 dragDropMode 设置为`QAbstractItemView::InternalMove`。

下面是一个[sscce](http://sscce.org)，您可以运行它来查看它的运行情况。

```
#include <QApplication>
#include <QListWidget>
#include <QListWidgetItem>

int main(int argc, char ** argv)
{
    QApplication a(argc, argv);
    QListWidget w;
    w.addItem("Rosalind");
    w.addItem("Celia");
    w.addItem("Adam");
    w.addItem("Jaques");
    w.setDragEnabled(true);
    w.setDropIndicatorShown(true);
    w.setDragDropMode(QAbstractItemView::InternalMove);
    w.show();
    return a.exec();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T08:35:56.310

只是为了完整起见：这是我最终使用的解决方案：

```
#include <QtGui>

class SortDialog:public QDialog{
    Q_OBJECT
  public:
    SortDialog(QStringList* pList, QString const& title,  QString const& middleButton);
    int getSelectedItem() const;

  private slots:
    void slotAccept();
    void slotItemUp();
    void slotItemDown();
    void slotSelectItem();

  private:
    QStringList* mpList;
    QListWidget* mpListWidget;
    int mSelectedItem;

};

SortDialog::SortDialog(QStringList* pList, QString const& title,  QString const& middleButton):
  QDialog(),
  mpList(pList),
  mpListWidget(new QListWidget()),
  mSelectedItem(-1){
  this->setWindowTitle(title);

  QHBoxLayout* pMainLayout = new QHBoxLayout();
  this->setLayout(pMainLayout);

  QVBoxLayout* pListLayout = new QVBoxLayout();
  pMainLayout->addLayout(pListLayout);

  pListLayout->addWidget(mpListWidget);
  mpListWidget->setDragEnabled(true);
  mpListWidget->setDropIndicatorShown(true);
  mpListWidget->setDragDropMode(QAbstractItemView::InternalMove);

  boostForeach(QString const& string, *mpList) {
    mpListWidget->addItem(string);
  }
  mpListWidget->setMinimumWidth(mpListWidget->sizeHintForColumn(0)+10);
  mpListWidget->adjustSize();

  mpList->clear();

  QPushButton* confirm = new QPushButton(tr("Confirm"));
  connect(confirm, SIGNAL(clicked()), this, SLOT(slotAccept()));
  pListLayout->addWidget(confirm);
  confirm->setDefault(true);

  QVBoxLayout* pUpDownLayout = new QVBoxLayout();
  pMainLayout->addLayout(pUpDownLayout);

  QPushButton* up = new QPushButton(tr("Up"));
  connect(up, SIGNAL(clicked()), this, SLOT(slotItemUp()));
  pUpDownLayout->addWidget(up);

  QPushButton* down = new QPushButton(tr("Down"));
  connect(down, SIGNAL(clicked()), this, SLOT(slotItemDown()));
  pUpDownLayout->addWidget(down);

  QPushButton* ground = new QPushButton(middleButton);
  connect(ground, SIGNAL(clicked()), this, SLOT(slotSelectItem()));
  pUpDownLayout->addWidget(ground);

  this->adjustSize();
}

int SortDialog::getSelectedItem() const{
  return mSelectedItem;
}

void SortDialog::slotAccept(){
  int count = mpListWidget->count();
  for(int index = 0; index < count; index++){
    QListWidgetItem * item = mpListWidget->item(index);
    mpList->push_back(item->text());
  }

  this->close();
}

void SortDialog::slotItemUp(){
  int row = mpListWidget->currentRow();
  if(row>0){
    QListWidgetItem* pTemp = mpListWidget->takeItem(row);
    mpListWidget->insertItem(row-1,pTemp);
    mpListWidget->setCurrentRow(row-1);
  }
}

void SortDialog::slotItemDown(){
  int row = mpListWidget->currentRow();
  if(row<mpListWidget->count()-1){
    QListWidgetItem* pTemp = mpListWidget->takeItem(row);
    mpListWidget->insertItem(row+1,pTemp);
    mpListWidget->setCurrentRow(row+1);
  }
}

void SortDialog::slotSelectItem(){
  int count = mpListWidget->count();
  for(int index = 0; index < count; index++){
    QListWidgetItem * item = mpListWidget->item(index);
    QFont font = item->font();
    font.setBold(false);
    item->setFont(font);
  }

  mSelectedItem =mpListWidget->currentRow();
  qDebug() << mSelectedItem;
  QListWidgetItem* pTemp = mpListWidget->currentItem();
  QFont font = pTemp->font();
  font.setBold(true);
  pTemp->setFont(font);
} 
```

# c# - 查找域用户所属的本地组？

> ID：11216603
> 
> 赞同：5
> 
> 时间：2012-06-26T22:03:36.257
> 
> 标签：c#, asp.net, active-directory, directoryservices

我正在使用 System.DirectoryServices.AccountManagement 命名空间来查找域用户及其相应的 AD 安全组。这很好用。

我还使用该命名空间来查询远程服务器上的本地安全组。我能够找到一个安全组，然后列出该组的用户没问题。

我遇到的问题是显示 DOMAIN 用户所属的 LOCAL 组：

```
PrincipalContext localmachine = new PrincipalContext(ContextType.Machine, "ServerName");
PrincipalContext domain = new PrincipalContext(ContextType.Domain);

// find the user using the domain context (Works fine)
UserPrincipal user = UserPrincipal.FindByIdentity(domain, userName);

// if found - grab its groups
if (user != null)
{
    // The get groups method is the only method that would accept a new context
    PrincipalSearchResult<Principal> groups = user.GetGroups(localMachine);

    // no groups are returned .... removed rest of code
} 
```

我正在尝试使用传入 localMachine PrincipalContext 的 GetGroups 方法，但没有返回任何组。

用户仅存在于域 AD 中。localMachine 的本地用户中没有此用户的条目。域用户被添加到本地安全组。

有任何想法吗？我希望能够提取此域用户所属的所有本地组的列表，然后查看该列表中是否存在某个组。现在唯一可行的选择是搜索系统上的某些组，并查看域用户是否属于该组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:32:59.873

以下代码将返回域用户所属的本地组：

```
 PrincipalContext domain = new PrincipalContext(ContextType.Domain);
        UserPrincipal user = UserPrincipal.FindByIdentity(domain, userName);
        foreach (GroupPrincipal group in user.GetAuthorizationGroups())
        {
            if (group.Context.ConnectedServer == serverName)
                Console.Out.WriteLine("{0}\\{1}", group.Context.Name, group.SamAccountName);
        } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-12T02:21:58.190

我知道我的回答迟了，但这对我有用（在我尝试了各种排列之后）：

```
private static IList<string> GetUserLocalGroups(string userAccountName, string computerName, string domainName)
{
  List<string> groups = new List<string>();

  // We have to deal with a local computer
  DirectoryEntry root = new DirectoryEntry(String.Format("WinNT://{0},Computer", computerName), null, null, AuthenticationTypes.Secure);

  foreach (DirectoryEntry groupDirectoryEntry in root.Children)
  {
    if (groupDirectoryEntry.SchemaClassName != "Group")
      continue;

    string groupName = groupDirectoryEntry.Name;
    Console.WriteLine("Checking: {0}", groupName);
    if (IsUserMemberOfGroup(groupDirectoryEntry, String.Format("WinNT://{0}/{1}", domainName, userAccountName)))
    {
      groups.Add(groupName);
    }
  }

  return groups;
}

private static bool IsUserMemberOfGroup(DirectoryEntry group, string userPath)
{
  return (bool)group.Invoke(
      "IsMember",
      new object[] { userPath }
      );
} 
```

调用是这样的：

```
GetUserLocalGroups("samaccountname", "computerName.yourdomain", "yourdomain"); 
```

# java - putParcelableArrayListExtra 和黑屏

> ID：11216608
> 
> 赞同：2
> 
> 时间：2012-06-26T22:03:58.073
> 
> 标签：java, android, parcelable

我有实现的自定义类，`Parcelable`并将其用作自定义数组列表。

当我使用`putParcelableArrayListExtra`400 行时它工作正常，但 1000 行却不行。我有黑屏和应用程序锁定。怎么了？

编辑：我把它寄到这里，我没有在另一个活动中使用它。

```
Intent intent = new Intent().setClass(getApplicationContext(), ArtActivity.class);
intent.putParcelableArrayListExtra ("mylist", list);
startActivityForResult(intent, SECONDARY_ACTIVITY_REQUEST_CODE); 
```

我的数组：

```
ArrayList<Piece> list = new ArrayList<Piece>(); 
```

这是我的课：

```
public class Piece implements Parcelable { 
    private String id;
    private String name;
    private int type;
    private String text;
    private String mp3;

   public Piece (String id,String name,int type)
   {
     this.id=id;
     this.name=name;
     this.type=type;
   }

   public Piece(Piece ele)
   {
      this.id=ele.id;
      this.name=ele.name;
      this.type=ele.type;
      this.text=ele.text;
   }

   public Piece (Parcel in) 
   { 
        id = in.readString (); 
        name = in.readString (); 
        type = in.readInt();
        text= in.readString();
        mp3=in.readString();
   } 

   public static final Parcelable.Creator<Piece> CREATOR 
   = new Parcelable.Creator<Piece>()  
  { 
        public Piece createFromParcel(Parcel in)  
        { 
            return new Piece(in); 
        } 

        public Piece[] newArray (int size)  
        { 
            return new Piece[size]; 
        } 
   }; 

   public void makeText(String text)
   {
       this.text=text;
   }

   public void makeMp3(String mp3)
   {
     this.mp3= mp3;
   }

   public String getMp3()
   {
   return this.mp3;
   }

   public String getId()
   {
       return id;
   }
   public String getName()
   {
       return name;
   }
   public int getType()
   {
       return type;
   }
   public String getText()
   {
       return text;
   }

  public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
  }

  public void writeToParcel(Parcel dest, int flags) {
    // TODO Auto-generated method stub
    dest.writeString (id); 
    dest.writeString (name);
    dest.writeInt(type);
    dest.writeString (text); 
    dest.writeString (mp3);
  } 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:51:15.563

我不相信你应该在这种情况下使用 parcelable。我要么静态访问数据（如果您只打算拥有一个持久的数据实例），要么使用缓存系统来保存数据。

这是一个公开可用的静态变量的示例：

```
public static List<Piece> list; 
```

它可以从您的应用程序中具有课程可见性的任何地方访问。

但是，这样做非常麻烦，被认为是一种不好的做法。或者，您可以创建一个对象来将数据作为静态类或单例来管理：

```
public class MyListManager {
    private static List<Piece> mList;

    public static List<Piece> getMyList() {
        return mList;
    }

    public static void setList(List<Piece> list) {
        mList = list;
    }
} 
```

或者，您可以实现某种缓存系统来管理您的数据。

# html - 在纵向移动中被压扁的响应背景

> ID：11216621
> 
> 赞同：1
> 
> 时间：2012-06-26T22:04:29.110
> 
> 标签：html, css, background-image, responsive-design

我在使用响应式背景时遇到问题。[http://poppykeith.co.uk/index.html](http://poppykeith.co.uk/index.html)在计算机浏览器和移动浏览器的横向上看起来是正确的，但是当在手机上（我使用 iOS）纵向查看时，图像会被挤压以适应屏幕。

我将如何使图像仅在纵向模式下放大而不是拉伸？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:23:06.823

您编写的代码几乎可以工作，但是`min-width:1024px`和`width:100%`规则相互冲突并导致您看到的挤压效果。基本上，`width`胜过`min-width`。

您要使用的真正技术是将该图像设置为 body 元素上的背景，然后用于`background-size:cover`使浏览器适当地加载它

```
body { 
    background: url(images/bg.jpg) no-repeat center center fixed; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

详情：[http ://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:20:35.253

查看这篇文章：[http ://www.teknocat.org/blog/web-development/show/6/mobile-safari-background-image-scaling-quirk](http://www.teknocat.org/blog/web-development/show/6/mobile-safari-background-image-scaling-quirk)

它谈到了 Mobile Safari 如何喜欢缩小大图像。

# java - 两个微调器显示相同的条目

> ID：11216622
> 
> 赞同：1
> 
> 时间：2012-06-26T22:04:31.433
> 
> 标签：java, android, android-widget, spinner, android-spinner

我正在开发这个应用程序，其中一个活动有两个微调器，并且都加载相同的条目，即使我为每个微调器定义了不同的条目。这是一件比较奇怪的事情。

这是代码，

main.xml 布局（部分 0f 布局）

```
<TableRow
        android:id="@+id/settings_color_row"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingTop="10dp" >

        <TextView
            android:id="@+id/settings_color_text"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_span="0"
            android:gravity="left"
            android:paddingLeft="7dp"
            android:paddingTop="13dp"
            android:text="Color"
            android:textSize="18dp"
            android:textStyle="bold"
            android:typeface="serif" >
        </TextView>

        <Spinner
            android:id="@+id/settings_color_spinner"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"

             />
    </TableRow>

    <TableRow
        android:id="@+id/settings_background_row"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingTop="10dp" >

        <TextView
            android:id="@+id/settings_background_text"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_span="0"
            android:gravity="left"
            android:paddingLeft="7dp"
            android:paddingTop="13dp"
            android:text="Skin"
            android:textSize="18dp"
            android:textStyle="bold"
            android:typeface="serif" >
        </TextView>

        <Spinner
            android:id="@+id/settings_background_spinner"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"

             />
    </TableRow> 
```

Settings.java（活动）

```
 colors_spinner = (Spinner)findViewById(R.id.settings_color_spinner);
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.colors_array, android.R.layout.simple_spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    colors_spinner.setAdapter(adapter);

    skin_spinner = (Spinner)findViewById(R.id.settings_background_spinner);
    ArrayAdapter<CharSequence> skin_adapter = ArrayAdapter.createFromResource(this,
            R.array.background_array, android.R.layout.simple_spinner_item);
    // Specify the layout to use when the list of choices appears
    skin_adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    colors_spinner.setAdapter(skin_adapter); 
```

字符串.xml

```
 <?xml version="1.0" encoding="utf-8"?>
 <resources>

<string name="hello">Hello World, Settings!</string>
<string name="app_name">Shared Preferences Test</string>

<string-array name="colors_array">
    <item>White</item>
    <item>Red</item>
    <item>Blue</item>
    <item>Pink</item>
</string-array>

<string-array name="background_array">
    <item>Red-Nosed Reindeer</item>
    <item>Snowman</item>
</string-array>

</resources> 
```

我没有看到任何错误，即使我使用了不同的适配器，它也只是显示相同的值。

![在此处输入图像描述](../Images/5653aac7385e83dddd70d2743c435750.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:12:55.900

尝试更改此行的最后一行：

```
skin_spinner = (Spinner)findViewById(R.id.settings_background_spinner);
ArrayAdapter<CharSequence> skin_adapter = ArrayAdapter.createFromResource(this,
        R.array.background_array, android.R.layout.simple_spinner_item);
// Specify the layout to use when the list of choices appears
skin_adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
// Apply the adapter to the spinner
colors_spinner.setAdapter(skin_adapter); 
```

对此：

```
skin_spinner.setAdapter(skin_adapter); // not colors_spinner 
```

我相信您只是没有注意到您`skin_adapter`在剪切和粘贴后设置到了错误的 Spinner。

# php - 如何离线使用谷歌地图从mysql数据库映射位置？

> ID：11216623
> 
> 赞同：0
> 
> 时间：2012-06-26T22:04:46.677
> 
> 标签：php, javascript, mysql, google-maps-api-3

我想问大家一件事。因此，我使用 Google Maps v3 制作了一个应用程序，并从 mysql 数据库中映射了位置。我使用的地图是世界地图。不在某个位置，因为我的数据库是来自世界各地的 IP 地址位置。但是我仍然可以离线使用和绘制从 mysql 数据库到 Google Maps v3 的位置吗？我需要做什么？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T04:43:58.197

评论越来越长，但我认为已经达成共识：

1.  使用 Google 地图开发离线应用程序是不切实际的。

2.  即使您可以下载所有图块和相关文件，也将违反[Google Maps API 服务条款](https://developers.google.com/maps/terms)。

你的问题的直接答案是“你不能”，我和评论中的许多其他人建议保持应用程序在线。

# c# - 如何在 Metro/WinRT 中将主机名解析为 IP 地址？

> ID：11216625
> 
> 赞同：2
> 
> 时间：2012-06-26T22:05:02.090
> 
> 标签：c#, windows-8, windows-runtime, microsoft-metro, .net-4.5

我正在将 WP7 应用程序移植到 Windows 8 Metro，我遇到的（许多）转换障碍之一是根据主机名或 DNS 名称发现 IP 地址。以下是我之前在 WP7 中使用的示例：

```
DnsEndPoint dnsEnd = new DnsEndPoint("www.google.com", 80, AddressFamily.InterNetwork);
DeviceNetworkInformation.ResolveHostNameAsync(dnsEnd, IPLookupCallbackMethod, this); 
```

我在网上搜索了解决方案并浏览了 Metro API，但我还没有找到任何东西。有没有其他人在 Metro/WinRT 中遇到过这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T01:26:43.793

```
using Windows.Networking;
using Windows.Networking.Sockets;

HostName serverHost = new HostName("www.google.com");
StreamSocket clientSocket = new Windows.Networking.Sockets.StreamSocket();

// Try to connect to the remote host
await clientSocket.ConnectAsync(serverHost, "http");

// Now try the clientSocket.Information property
// e.g. clientSocket.Information.RemoteAddress
// to get the ip address 
```

一旦 clientSocket 尝试连接，clientSocket.Information 属性将包含大量网络信息，包括远程主机信息，包括 IP 地址。我刚刚输入了这个内联，所以我希望没有错误。希望这可以帮助！也试试[这个链接到 msdn](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.hostname.aspx#Y1226)。

# eclipse - 将 Jar 文件导入 Eclipse 失败 - 无法解析为类型

> ID：11216626
> 
> 赞同：0
> 
> 时间：2012-06-26T22:05:09.673
> 
> 标签：eclipse, import, jar

我成功地将一些 JAR 导入到我的 eclipse java 项目中。当我尝试在我的代码中使用这些 JAR 文件中的类时，出现“无法解析为类型”错误。

现在我必须使用 eclipse 的自动帮助功能或手动键入导入语句来消除错误并使用这些类。

我如何停止收到错误并消除一直手动导入的需要。Eclipse 从不要求我导入 Java.Lang.String。那么，我如何确保它为任何其他类做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:15:28.457

您可以使用 Eclipse 快捷键 CTRL+SHIFT+O 来“组织导入”，因此 Eclipse 将添加必要的导入，自动查找所需的类到类路径中。它可以节省您的时间，它比在无法识别的类上使用 Ctrl-Space 快捷方式逐个进行要快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:11:53.883

你没有。您必须将它们全部导入，但您可以按包而不是按类进行。

java.lang 中的所有类都会自动导入到每个 Java 程序中。同样，与包含 main() 函数的类在同一包中的所有类。除此之外，您必须导入每个类。

Eclipse 可能会为您提供导入无法识别的类 - 尝试在无法识别的类上使用 Ctrl-Space 快捷方式。

最后，阅读以下内容不会有什么坏处： [http](http://en.wikipedia.org/wiki/Java_package) ://en.wikipedia.org/wiki/Java_package - 您可能已经了解了这一切，但以防万一。

# ruby-on-rails - 评论上方的评论表格

> ID：11216629
> 
> 赞同：0
> 
> 时间：2012-06-26T22:05:39.047
> 
> 标签：ruby-on-rails

我怎样才能在评论本身上方有一个评论表格。

作品

```
@post = Post.find(params[:id])
@post.comments.each do |comment|
  comment.id
end
@post.comments.build
  # form here
end 
```

想要但失败

```
@post = Post.find(params[:id])
@post.comments.build
  # form here
end
@post.comments.each do |comment|
  comment.id
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:13:03.020

控制器

```
@post = Post.find(params[:id])
@comment = @post.comment.new 
```

看法

```
form_for @comment do |f|
  ...
end

@post.comments.each do |comment|
  comment.id
end 
```

# email - Coldfusion 7 - 发送错误“helo”的邮件

> ID：11216635
> 
> 赞同：0
> 
> 时间：2012-06-26T22:06:35.820
> 
> 标签：email, coldfusion, cfmail, coldfusion-7

我有我自己的盒子放在架子上。它是运行 CF 7 并使用机架公司的 smtp 服务器的 Win2000。我无法发送电子邮件。当我尝试时，他们只是转到无法投递的电子邮件文件夹。支持人员说我的服务器正在发送不可验证的`helo`消息。所以他们的 smtp 服务器不会发送它。

它是 CF 7，管理员无处为身份验证指定 U/P。但是我应该能够在标签内做到这一点。当我这样做时，我没有收到任何错误，但邮件会进入无法投递的文件夹。

**代码：**

```
<cftry>
    <cfmail to="jxxx@yahoo.com" 
            from="jxxx@xxx.com" 
            subject="xxx.com Sign-up" 
            server="smtp.xxx.net" 
            port="25" 
            username="valid-account@xxx.net" 
            password="password" >

            This is a test - with server specified
    </cfmail>
    Success w/ server user defined

    <cfcatch type="any">
            <strong>ERROR: #cfcatch.Message#</strong><BR />
            #cfcatch.Detail#
    </cfcatch>
</cftry>        

<cftry>
    <cfmail to="jxxx@yahoo.com" 
            from="xxx@xxx.net" 
            subject="xxx.com Sign-up" >

            This is a test - without server specified
    </cfmail>
    Success w/o server user defined

    <cfcatch type="any">
            <strong>ERROR: #cfcatch.Message#</strong><BR />
            #cfcatch.Detail#
    </cfcatch>
</cftry> 
```

我对邮件服务器不太了解...

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T19:47:39.283

这可能是 DNS 的问题，并且接收系统无法进行反向 DNS 查找，或者它可能根本不在 DNS 中。

另一种可能性是不可验证的 Helo 意味着您没有与系统关联的 FQDN（也许您的系统名称没有与之关联的域？）（即 helo me）可能会被退回而不是“helo me” .somewhere.com”。

所以 - 从编码的角度来看，不要认为这是一个 CF 问题 - 这与您的系统设置（可能是 FQDN）或您所在位置的 DNS 有关。大多数反垃圾邮件/反开放中继设置都会查看 DNS 以进行某种程度的验证。

# database - 需要 NOT NULL 的反向 FK

> ID：11216636
> 
> 赞同：0
> 
> 时间：2012-06-26T22:06:40.843
> 
> 标签：database, foreign-key-relationship, notnull

我正在尝试建模一个数据库，其中我有 2 个反向外键，这两个表字段都需要 NOT NULL。我该如何建模？

这里有一个小样本：

我有两个表，第一个是泛型​​，称为“SystemObjects”，第二个称为“Users”。每个“SystemObject”都是由一个“User”对象创建的，因此需要一个不能为空的“CreatedBy”外键。同时，所有用户也具有通用关联的 SystemObject 条目，并且“用户”表包含有关具有特定类型“用户”的那些对象的更多信息。

在 OOP 类比中，“User”继承自“SystemObject”并具有补充成员。所以我需要跟踪这种联系。

我的问题总结：

*   “A”有一个外键字段到“B”
*   “B”对“A”有一个外键字段
*   两者都是必需的（非空）

如何摆脱这个陷阱？任何替代模型可以解决我的问题并允许我进行这种 vis-verca 跟踪？

谢谢！

# haskell - Control.Monad.Writer 在 haskell 中不起作用

> ID：11216637
> 
> 赞同：4
> 
> 时间：2012-06-26T22:06:45.363
> 
> 标签：haskell, monads

我整天都在尝试编译 Haskell 代码 - 再次 - 涉及 Control.Monad.Writer。这是一个不会从[*Learn You a Haskell*](http://learnyouahaskell.com/for-a-few-monads-more)编译的代码示例：

```
import Control.Monad.Writer  

gcd' :: Int -> Int -> Writer [String] Int  
gcd' a b  
    | b == 0 = do  
        tell ["Finished with " ++ show a]  
        return a  
    | otherwise = do  
        tell [show a ++ " mod " ++ show b ++ " = " ++ show (a `mod` b)]  
        gcd' b (a `mod` b) 
```

我收到此错误：

```
No instance for (Show (Writer [String] Int))
      arising from a use of `print'
    Possible fix:
      add an instance declaration for (Show (Writer [String] Int))
    In a stmt of an interactive GHCi command: print it 
```

我已经尝试编译我的老师今天编写的代码，也涉及 Control.Monad.Writer，但没有任何效果。

我正在使用 Ubuntu 12.04、gedit 和 GHC 7.4.1。

*Learn You a Haskell*中的所有 Writer monad 程序都无法编译，我被困住了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T22:21:11.887

你显然输入了类似的东西

```
ghci> gcd' 12345 6789 
```

在 ghci 提示符下。因此，您要求 ghci 打印 type 的值`Writer [String] Int`，但没有类型的`Show`实例`Writer`，因此 ghci 无法打印它。你需要申请`runWriter`或类似的功能，

```
ghci> runWriter $ gcd' 12345 6789 
```

应该管用。

# java - 如何全局禁用 Android 应用程序中的声音？

> ID：11216641
> 
> 赞同：0
> 
> 时间：2012-06-26T22:07:02.293
> 
> 标签：java, android, mobile, audio

我目前有一个复选框可以正确确定是否按下了声音开/关切换，并且我保存了首选项，以便以后可以在所有活动中全局访问 mPrefs。

我一直在寻找如何在我的应用程序中禁用全局声音，但无法得出结论。

有没有经历这个过程的例子或教程？

谢谢。

# c# - IE 使 Jquery.html 失败，权限被拒绝

> ID：11216642
> 
> 赞同：0
> 
> 时间：2012-06-26T22:07:04.413
> 
> 标签：c#, jquery, innerhtml

我有一个在 Firefox 中运行良好的 ajax 调用，但在 jquery.min.js 文件中出现权限被拒绝错误。我不知道出了什么问题，或者如何解决它。这是我的帖子：

（发布前声明的所有内容）

```
$.ajax(
    {
        type: "POST",
        url: "../ajaxURLs/SearchRequests.aspx?requestID=" + requestID + "&state=" + state + "&status=" + status + "&queue=" + queue + "&oem=" + oem +
        "&rayMatNumber=" + rayMatNumber + "&mfgPartNumber=" + mfgPartNumber + "&program=" + program + "&po=" + po + "&pr=" + pr +
        "&businessUnit=" + businessUnit + "&site=" + site + "&buyer=" + buyer + "&requisitioner=" + requisitioner + "&ce=" + ce + "&rea=" + rea + "&pqe=" + pqe +
        "&startDate=" + startDate + "&endDate=" + endDate,
        cache: false,
        success: function (data) {
            $("#searchResults").html(data);
            sorttable.makeSortable(document.getElementById("SearchResults"));
            $("#MainContent_excelDiv").show();
        }
    }); 
```

有任何想法吗？如果我将 map 直接带到我的 SearchRequests.aspx 并传递参数，那么它在 Firefox 和 IE 中都可以正常工作，只有通过 ajax 完成。

是的，我使用了 f12。错误是“Permission Denied”jquery.min.js，第 9 行字符 2805。我使用的是 jquery 版本 1.7.2。

如果我删除将 searchResults div 设置为等于数据，并添加一个警报以显示数据，它会完成该操作并在警报中包含正确的信息。Fiddler 显示正在生成的正确 html，Firefox 工作正常，它只是 IE。其他 ajax 帖子在 IE 中也可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:21:39.293

尝试将您的`type`from切换`POST`到`GET`. 您正在进行搜索，因此无论如何都是合适的。这可以解释为什么它在所描述的场景中有效，而不是在您的 AJAX 请求中有效。

`POST`仅应在您在服务器端修改数据时使用，而`GET`用于只读数据检索。

**编辑**

替换为在那个 JQuery 语句中发生`$("#searchResults").html(data);`了`document.getElementById("searchResults").innerHTML = data;`一些奇怪的事情，看看在那个实例中不使用 JQuery 是否会起作用。如果它出现在警报中，它也应该在该上下文中工作。

# php - 交易情况的基本模式

> ID：11216644
> 
> 赞同：0
> 
> 时间：2012-06-26T22:07:21.373
> 
> 标签：php, mysql, database, database-design, schema

交易物品的基本数据库模式是什么？以下是交易规则：

1.  用户提议交易其他用户的物品。
2.  两个用户都可以多次反对对方的提议。

它非常简短和笼统，但我只是在寻找一个基本模式来帮助我在设计数据库时朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:13:06.163

基本上你在谈论投标（拍卖）......这是我过去在此类项目中松散使用的一个体面的模式。

[http://www.databaseanswers.org/data_models/auction/index.htm](http://www.databaseanswers.org/data_models/auction/index.htm)

# html - 如何在同一个 div 中的两个按钮之间留出空间？

> ID：11216645
> 
> 赞同：172
> 
> 时间：2012-06-26T22:07:25.257
> 
> 标签：html, css, twitter-bootstrap

水平间隔 Bootstrap 按钮的最佳方法是什么？

目前按钮正在触摸：

```
<div class="btn-group">
    <button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown">
        <i class="icon-in-button"></i>  
        Add to list
        <span class="caret"/>
    </button>
    <ul class="dropdown-menu">
        <li>
            <a href="#">here</a>
        </li>
        <li>
            <a href="#">new</a>
        </li>
    </ul>
    <button class="btn btn-info">
        <i class="icon-in-button"></i>  
        more
    </button>
</div> 
```

[![两个引导按钮](../Images/06779146d57fafe2d65b78dd6e76defe.png)](https://i.stack.imgur.com/1B3mT.png)

jsfiddle显示问题：http: [//jsfiddle.net/hhimanshu/sYLRq/4/](http://jsfiddle.net/hhimanshu/sYLRq/4/)

* * *

## 回答 #1

> 赞同：347
> 
> 时间：2012-06-26T22:10:34.500

把它们放在里面`btn-toolbar`或其他容器里，不要`btn-group`。`btn-group`将它们连接在一起。[有关 Bootstrap文档](http://getbootstrap.com/2.3.2/components.html#buttonGroups)的更多信息。

编辑：最初的问题是针对 Bootstrap 2.x 的，但对于[Bootstrap 3](https://getbootstrap.com/docs/3.3/components/#btn-groups)和[Bootstrap 4](https://getbootstrap.com/docs/4.0/components/button-group/)仍然有效。

在[Bootstrap 4](https://getbootstrap.com/docs/4.0/components/button-group/)中，您需要使用实用程序类（例如 mx-2）为您的组添加适当的边距。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2015-10-24T07:12:12.253

只需按照兄弟 Miroslav Popovic 的说法将按钮放在一个类（ class="btn-toolbar" ）中。它的效果很棒。

```
<div class="btn-toolbar">
  <button type="button" id="btnSubmit" class="btn btn-primary btn-sm">Submit</button>
  <button type="button" id="btnCancel" class="btn btn-primary btn-sm">Cancel</button>
</div>
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-09-28T13:21:22.003

您可以[为 Bootstrap 使用间距，](https://v4-alpha.getbootstrap.com/utilities/spacing/)而无需任何额外的 CSS。只需将类添加到您的按钮。这是针对第 4 版的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-11-13T20:20:18.147

Dragan B 的建议是使用 Bootstrap 4 的正确方法。我在下面举了一个例子。例如，mr-3 是 margin-right:1rem!important

```
<div class="btn-toolbar pull-right">
   <button type="button" class="btn mr-3">btn1</button>
   <button type="button" class="btn mr-3">btn2</button>
   <button type="button" class="btn">btn3</button>
</div> 
```

ps：就我而言，我希望我的按钮显示在屏幕的右侧，因此向右拉。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-02-11T16:04:26.857

你应该使用引导 v.4

```
<div class="form-group row">
    <div class="col-md-6">
        <input type="button" class="btn form-control" id="btn1">
    </div>
    <div class="col-md-6">
        <input type="button" class="btn form-control" id="btn2">
    </div>
</div> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-10-05T19:03:47.770

在大多数情况下，最简单的方法是保证金。

你可以在哪里做：

```
button{
  margin: 13px 12px 12px 10px;
} 
```

或者

```
button{
  margin: 13px;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-07-20T14:30:43.057

Dragan B. 解决方案是正确的。在我的情况下，我需要在堆叠时垂直间隔按钮，所以我向它们添加了 mb-2 属性。

```
<div class="btn-toolbar">
   <button type="button" class="btn btn-primary mr-2 mb-2">First</button>
   <button type="button" class="btn btn-primary mr-2 mb-2">Second</button>
   <button type="button" class="btn btn-primary mr-2 mb-2">Third</button>
</div> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-05-09T07:54:08.383

我使用了 Bootstrap 4 按钮插件（[https://getbootstrap.com/docs/4.0/components/buttons/#button-plugin](https://getbootstrap.com/docs/4.0/components/buttons/#button-plugin)）并将*四舍五入*的类添加到标签和类*mx-1*到中间按钮以实现单独的单选按钮所需的外观和感觉。使用类*btn-toolbar*使单选按钮圆圈出现在我面前，这不是我想要的。希望这可以帮助某人。

```
 <div class="btn-group btn-group-toggle" data-toggle="buttons">
            <label class="btn btn-secondary active rounded">
                <input type="radio" name="options" id="option1" autocomplete="off" checked> Active
            </label>
            <label class="btn btn-secondary rounded mx-1">
                <input type="radio" name="options" id="option2" autocomplete="off"> Radio
            </label>
            <label class="btn btn-secondary rounded">
                <input type="radio" name="options" id="option3" autocomplete="off"> Radio
            </label>
        </div> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-05-23T02:26:32.570

实现此目的的另一种方法是在按钮中添加一个类 .btn-space

```
 <button type="button" class="btn btn-outline-danger btn-space"
  </button>
  <button type="button" class="btn btn-outline-primary btn-space"
  </button> 
```

并定义这个类如下

```
.btn-space {
    margin-right: 15px;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-05-03T20:05:10.787

这是基于[文档](https://getbootstrap.com/docs/5.0/components/buttons/#block-buttons)的另一种方法。

```
 <div class="d-grid gap-2 d-md-flex" >
    <button type="button" class="btn btn-outline-primary btn-sm">button1</button>
    <button type="button" class="btn btn-outline-primary btn-sm">button2</button>
 </div> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-29T02:57:19.523

我实际上遇到了同样的要求。我只是像这样使用CSS覆盖

```
.navbar .btn-toolbar { margin-top: 0; margin-bottom: 0 } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-11T15:56:20.473

如果使用 Bootstrap，您可以更改样式，例如：如果您只想在一页中，则在 head 标签之间添加 **.btn-group btn{margin-right:1rem;}**

如果是为所有网站添加到 css 文件

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-07-12T19:18:55.087

我最终做了类似于[mark dibe](https://stackoverflow.com/a/48733473/5395858)所做的事情，但我需要以稍微不同的方式计算间距。

bootstrap 中的`col-x`类可以成为绝对的救星。我最终做了类似的事情：

```
<div class="row col-12">
    <div class="col-3">Title</div>
</div>
<div class="row col-12">
    <div class="col-3">Bootstrap Switch</div>
<div> 
```

这使我能够以良好间隔的方式对齐标题和输入开关。相同的想法可以应用于按钮，并允许您停止触摸按钮。

（旁注：我希望这是对上述链接的评论，但我的声誉不够高）

# python - 为什么在这个简单的基准测试中 SQLite 比 Redis 快？

> ID：11216647
> 
> 赞同：35
> 
> 时间：2012-06-26T22:07:41.647
> 
> 标签：python, sql, sqlite, redis

我在本地机器上做了简单的性能测试，这是 python 脚本：

```
import redis
import sqlite3
import time

data = {}
N = 100000

for i in xrange(N):
    key = "key-"+str(i)
    value = "value-"+str(i)
    data[key] = value

r = redis.Redis("localhost", db=1)
s = sqlite3.connect("testDB")
cs = s.cursor()

try:
    cs.execute("CREATE TABLE testTable(key VARCHAR(256), value TEXT)")
except Exception as excp:
    print str(excp)
    cs.execute("DROP TABLE testTable")
    cs.execute("CREATE TABLE testTable(key VARCHAR(256), value TEXT)")

print "[---Testing SQLITE---]"
sts = time.time()
for key in data:
    cs.execute("INSERT INTO testTable VALUES(?,?)", (key, data[key]))
    #s.commit()
s.commit()
ste = time.time()
print "[Total time of sql: %s]"%str(ste-sts)

print "[---Testing REDIS---]"
rts = time.time()
r.flushdb()# for empty db
for key in data:
    r.set(key, data[key])
rte = time.time()
print "[Total time of redis: %s]"%str(rte-rts) 
```

我希望 redis 执行得更快，但结果表明它要慢得多：

```
[---Testing SQLITE---]
[Total time of sql: 0.615846157074]
[---Testing REDIS---]
[Total time of redis: 10.9668009281] 
```

那么，redis 是基于内存的，那么 sqlite 呢？为什么redis这么慢？什么时候需要使用redis，什么时候需要使用sqlite？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-26T22:14:10.873

来自[redis 文档](http://redis.io/topics/benchmarks)

> Redis 是一个服务器：所有命令都涉及网络或 IPC 往返。将其与 SQLite、Berkeley DB、Tokyo/Kyoto Cabinet 等嵌入式数据存储进行比较是没有意义的……因为大多数操作的成本恰恰是由网络/协议管理主导的。

尽管在某些情况下承认速度问题，但这确实是有道理的。例如，在多个并行访问下，Redis 的性能可能比 sqlite 好得多。

*适合工作的正确工具*，有时是 redis，有时是 sqlite，有时是完全不同的东西。如果此速度测试正确显示了您的应用程序将实际执行的操作，那么 sqlite 将为您提供更好的服务，并且您执行此基准测试很好。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-08-29T09:16:31.597

当前的答案提供了关于为什么 Redis 会失去这个特定基准的洞察力，即对服务器执行的每个命令产生的网络开销，但是没有尝试重构基准代码来加速 Redis 性能。

您的代码的问题在于：

```
for key in data:
    r.set(key, data[key]) 
```

您需要与 Redis 服务器进行 100,000 次往返，从而导致巨大的 I/O 开销。

这是完全没有必要的，因为 Redis 为某些命令提供了类似“批处理”的功能，因此对于 SET 有 MSET，因此您可以将上述内容重构为：

```
r.mset(data) 
```

从 100,000 次服务器跳闸次数减少到 1 次。您只需将 Python 字典作为单个参数传递，Redis 将自动在服务器上应用更新。

这将使您的特定基准测试完全不同，您应该会看到 Redis 的性能至少与 SQLite 相当。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-26T22:26:58.173

SQLite 非常快，您只需要一个 IO 操作（在 上`commit`）。Redis 在网络上执行的 IO 显着增加。更多的苹果对苹果的比较将涉及通过网络访问的关系数据库（如 MySQL 或 PostgreSQL）。

*您还应该记住，SQLite 已经存在了很*长时间并且已经高度优化。它受到[ACID](http://en.wikipedia.org/wiki/ACID)合规性的限制，但您实际上可以[将其关闭](http://web.utk.edu/~jplyon/sqlite/SQLite_optimization_FAQ.html#pragmas)（就像一些 NoSQL 解决方案所做的那样），并且更快地获得它。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-06-27T18:27:34.480

刚刚注意到您没有为 redis 提交提交。使用管道可以减少时间：

[---测试 SQLITE---]

【sql总时间：0.669369935989】

[---测试 REDIS---]

【redis总耗时：2.39369487762】

# git - 使用 .gitignore 忽略 git status 中的文件

> ID：11216648
> 
> 赞同：1
> 
> 时间：2012-06-26T22:07:50.667
> 
> 标签：git, version-control

当我运行时`git status`，我有不想观看的不相关文件。

例如：

> M .gitignore
> M as3-remote/.project
> M perspective/swc/.project
> M perspective/swf/.project
> M schedule-translator-framework/src/main/java/Importer.java
> D schedule-translator-framework/src/main /java/TranslatorTest.java
> M ui-mecogis/swf/.project

我已经尝试编辑我的 .gitignore 以便包含 .projects 我的 .gitignore 看起来像：

> .classpath
> .project
> .settings
> *.log
> nbactions.xml
> 目标
> .DS_Store

我只想跟踪和观察 schedule-translator-framework 中的变化，我只想关注特定文件夹中的 .java 文件。我不希望在跟踪或未跟踪无关的情况下显示其他任何内容。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:32:33.207

我认为这就是你需要的：

```
# in .gitignore
*
!scheduled-translator-framework/
!scheduled-translator-framework/* 
```

和：

```
# in scheduled-translator-framework/.gitignore 
/*
!*/
!*.java 
```

`.gitignore`在项目的根目录中使用我们：

1.  无视一切。
2.  取消忽略`scheduled-translator-framework/`目录。
3.  取消忽略里面的**所有**文件`scheduled-translator-framework/`（我们稍后会处理这个目录中的文件）。

`.gitignore`在目录中使用`scheduled-translator-framework/`我们：

1.  忽略此子目录中的所有内容。
2.  取消忽略里面的所有子目录`scheduled-translator-framework/`（下一步工作所必需的）。
3.  `*java`取消忽略当前目录（即`scheduled-translator-framework/`）和所有子目录中的所有文件。

如果您不小心添加到索引或提交了一些您不想跟踪的文件，您可以取消暂存并将它们从存储库中删除：

```
git rm --cached -r file/or/directory/path 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:16:40.420

`git status`显示*.project*文件夹，因为它们已被跟踪。
您需要从存储库中删除它们：`git rm --cached a/b/.project`

要忽略除特定文件夹中的所有 *.java 文件，您的*.gitignore*应如下所示：

```
*.java  
!a/specific/folder/*.java 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:14:03.950

从 gitignore(5) 手册页：

> gitignore 文件的目的是确保某些未被 git 跟踪的文件保持未被跟踪。
> 
> 要忽略已跟踪文件中未提交的更改，请使用`git update-index --assume-unchanged`.
> 
> 要停止跟踪当前跟踪的文件，请使用`git rm --cached`.

# angularjs - AngularJS 中的“计算属性”

> ID：11216651
> 
> 赞同：21
> 
> 时间：2012-06-26T22:08:11.240
> 
> 标签：angularjs

我最近为我正在从事的一个项目选择了 AngularJS 而不是 ember.js，到目前为止，我对它感到非常满意。ember 的一个优点是它内置了对具有自动数据绑定的“计算属性”的支持。我已经能够使用下面的代码在 Angular 中完成类似的事情，但不确定这是否是最好的方法。

```
// Controller
angular.module('mathSkills.controller', [])
  .controller('nav', ['navigation', '$scope', function (navigation, $scope) {
    // "Computed Property"
    $scope.$watch(navigation.getCurrentPageNumber, function(newVal, oldVal, scope) {
      scope.currentPageNumber = newVal;
    });
    $scope.totalPages = navigation.getTotalPages();
  }]);

// 'navigation' service
angular.module('mathSkills.services', [])
  .factory('navigation', function() {
    var currentPage = 0,
        pages = [];

    return {
      getCurrentPageNumber: function() {
        return currentPage + 1;
      },
      getTotalPages: function() {
        return pages.length;
      }
    };
  });

// HTML template
<div id=problemPager ng-controller=nav>
  Problem {{currentPageNumber}} of {{totalPages}}
</div> 
```

我希望用户界面`currentPage`在`navigation`服务更改时更新，上面的代码完成了。

这是在 AngularJS 中解决这个问题的最佳方法吗？`$watch()`像这样使用有（显着的）性能影响吗？`$emit()`使用自定义事件和or会更好地完成这样的事情`$broadcast()`吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-10-07T00:40:02.657

虽然您的自我回答有效，但它实际上并没有实现计算属性。您只需在绑定中调用一个函数以强制绑定为贪婪即可解决问题。我不是 100% 确定它在所有情况下都有效，并且在某些情况下，贪婪可能具有不需要的性能特征。

我为具有类似于 EmberJS 的依赖项的计算属性制定了一个解决方案：

```
function ngCreateComputedProperty($scope, computedPropertyName, dependentProperties, f) {
  function assignF($scope) {
    var computedVal = f($scope);
    $scope[computedPropertyName] = computedVal;
  };

  $scope.$watchCollection(dependentProperties, function(newVal, oldVal, $scope) {
    assignF($scope);
  });
  assignF($scope);
};

// in some controller...
ngCreateComputedProperty($scope, 'aSquared', 'a',     function($scope) { return $scope.a * $scope.a } );
ngCreateComputedProperty($scope, 'aPlusB',   '[a,b]', function($scope) { return $scope.a + $scope.b } ); 
```

现场观看：http: [//jsfiddle.net/apinstein/2kR2c/3/](http://jsfiddle.net/apinstein/2kR2c/3/)

值得注意的是，$scope.$watchCollection 是有效的——我验证了即使同时更改了多个依赖项（相同的 $apply 周期），“assignF()”也只被调用一次。"

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-26T22:30:07.507

我想我找到了答案。这个例子可以大大简化为：

```
// Controller
angular.module('mathSkills.controller', [])
  .controller('nav', ['navigation', '$scope', function (navigation, $scope) {
    // Property is now just a reference to the service's function.
    $scope.currentPageNumber = navigation.getCurrentPageNumber;
    $scope.totalPages = navigation.getTotalPages();
  }]);

// HTML template
// Notice the first binding is to the result of a function call.
<div id=problemPager ng-controller=nav>
  Problem {{currentPageNumber()}} of {{totalPages}}
</div> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-03T01:58:43.930

请注意，使用 ECMAScript 5，您现在还可以执行以下操作：

```
// Controller
angular.module('mathSkills.controller', [])
  .controller('nav', function(navigation, $scope) {
    $scope.totalPages = navigation.getTotalPages();
    Object.defineProperty($scope, 'currentPageNumber', {
      get: function() {
        return navigation.getCurrentPageNumber();
      }
    });
  ]);

//HTML
<div ng-controller="nav">Problem {{currentPageNumber}} of {{totalPages}}</div> 
```

# python - 在 Sage 上安装 wxPython 的 spkg 包时出现语法错误

> ID：11216653
> 
> 赞同：0
> 
> 时间：2012-06-26T22:08:19.140
> 
> 标签：python, wxpython, sage

当我想从[这里安装包 wxPython-2.8.7.1.spkg](http://www.sagemath.org/packages/experimental/)

在 Sage 的终端中，它给了我一个语法错误。我在 Sage 终端中写的内容如下：

```
sage: sage -i wxPython-2.8.7.1.spkg
------------------------------------------------------------
   File "<ipython console>", line 1
     sage -i wxPython-RealNumber('2.8').gen(7).1.spkg
                    ^
SyntaxError: invalid syntax 
```

我也使用包的直接地址，但结果是一样的：

```
 sage: sage -i http://www.sagemath.org/packages/experimental/wxPython-2.8.7.1.s>
------------------------------------------------------------
   File "<ipython console>", line 1
     sage -i http://www.sagemath.org/packages/experimental/wxPython-RealNumber('2.8').gen(7).1.spkg
                ^
SyntaxError: invalid syntax 
```

我也下载了包并使用了本地地址，但结果是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:24:24.637

*在启动*Sage之前，您需要从命令行执行此操作。否则你可以使用

```
sage: install_package("wxPython") 
```

目前正在为我下载...然后失败了：

```
checking for GTK+ - version >= 2.0.0... no
*** Could not run GTK+ test program, checking why...
*** The test program failed to compile or link. See the file config.log for the
*** exact error that occured. This usually means GTK+ is incorrectly installed.
configure: error:
The development files for GTK+ were not found. For GTK+ 2, please
ensure that pkg-config is in the path and that gtk+-2.0.pc is
installed. For GTK+ 1.2 please check that gtk-config is in the path,
and that the version is 1.2.3 or above. Also check that the
libraries returned by 'pkg-config gtk+-2.0 --libs' or 'gtk-config
--libs' are in the LD_LIBRARY_PATH or equivalent.
Error configure wx widgets.

real    0m13.972s
user    0m2.791s
sys 0m5.232s
************************************************************************
Error installing package wxPython-2.8.7.1
************************************************************************ 
```

沿着这些思路，这是它在[实验 spkgs 列表中所说](http://sagemath.org/packages/experimental/)的，这是其中之一：

> 这些是实验性的！他们可能根本不适合你！使用风险自负！其中许多*从未*在任何平台上成功构建过！

所以买家要小心！

# django - 使用Django的fastcgi服务器有什么缺点

> ID：11216658
> 
> 赞同：24
> 
> 时间：2012-06-26T22:09:22.250
> 
> 标签：django, deployment, fastcgi, gunicorn

我在我`nginx + fastcgi`的一些 Django 项目的生产中使用（manage.py runfcgi ...）。很多人建议使用`nginx + gunicorn`. 使用**gunicorn**而不是使用 Django 的`fastcgi`服务器有什么好处？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-13T09:48:43.750

我只是告诉您为什么需要使用类似 WSGI 的服务器 :) 但是如果您对使用 fcgi 感到满意 - 只需使用它

简短回答：WSGI（作为协议）很酷，因为[它是原生的](http://www.python.org/dev/peps/pep-0333/)

或者如果“你需要更深入”（c）

下一个问题“FastCGI 与类似 WSGI 的服务器？”

这里有一些答案：

*   [WSGI、CGI、FastCGI 和 mod_python 在 Python 方面的区别和用途？](https://stackoverflow.com/questions/3937224/differences-and-uses-between-wsgi-cgi-fastcgi-and-mod-python-in-regards-to-py)
*   [scgi和wsgi有什么区别？](https://stackoverflow.com/questions/257481/whats-the-difference-between-scgi-and-wsgi)
*   [WSGI 和 FCGI 之间有速度差异吗？](https://stackoverflow.com/questions/1747266/is-there-a-speed-difference-between-wsgi-and-fcgi)
*   [Python Web 框架、WSGI 和 CGI​​ 如何组合在一起](https://stackoverflow.com/questions/219110/how-python-web-frameworks-wsgi-and-cgi-fit-together)

关于 gunicorn、uWSGI 和 cherokee、nginx。不要混合它们！

nginx 是可以处理 http 请求并将其发送到 WSGI 后端的网络服务器。（但首先它对于静态内容处理非常快。）WSGI 后端处理你的 django 应用程序。

关于 cherokee，我认为它处理与 nginx 相同的任务，但我不使用它。

gunicorn、uWSGI 是 WSGI 后端，它使用 django 应用程序运行线程并执行[许多其他任务](http://projects.unbit.it/uwsgi/#CurrentCoreFeatures)

嗯，[gunicorn 这么](http://unicorn.bogomips.org/PHILOSOPHY.html)说

> 作为仅在类 Unix 平台上运行的服务器，unicorn 与 Unix 哲学紧密相连，即做一件事并（希望）做好它。尽管使用 HTTP，unicorn 严格来说是一个后端应用服务器，用于运行基于 Rack 的**Ruby 应用程序**。

我为我的 django 应用练习 nginx（来自 nginx.org repos 的最新稳定版）+uWSGI（来自 Debian 稳定版） - 完美运行 :)

* * *

2012 年 5 月 18 日编辑

通过比较[fcgi gunicorn uWSGI链接到 2010 主题](http://www.peterbe.com/plog/fcgi-vs-gunicorn-vs-uwsgi/)

> fcgi（线程）6​​40 r/s
> 
> fcgi（prefork 4 处理器）240 r/s (*)
> 
> gunicorn (2名工人) 1100 r/s
> 
> gunicorn (5名工人) 1300 r/s
> 
> gunicorn (10 名工人) 1200 r/s (?!?)
> 
> uwsgi（2 名工人）1800 转/秒
> 
> uwsgi（5 名工人）2100 转/秒
> 
> uwsgi（10 名工人）2300 转/秒
> 
> （* 这使我的计算机在通过屋顶时作为 CPU 异常缓慢）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T20:21:37.363

正如 b1- 所说，WSGI 是原生的（看看[这篇文章](https://stackoverflow.com/questions/1747266/is-there-a-speed-difference-between-wsgi-and-fcgi)）。

另外，[这篇文章](https://stackoverflow.com/questions/2591715/deploying-django-fastcgi-apache-mod-wsgi-uwsgi-gunicorn)也有类似的问题。

从我个人的角度来看，前段时间我一直[在 vhost 模式下使用 Nginx + uwsg 在](https://stackoverflow.com/questions/7081462/problem-with-nginx-uwsgi-in-vhost-mode-running-django-app)我的服务器上运行各种项目。

# html - 如何在支持动态宽度的同时使用 CSS 将 div 定位在页面中间？

> ID：11216659
> 
> 赞同：0
> 
> 时间：2012-06-26T22:09:27.537
> 
> 标签：html, css

请在此处查看 jsFiddle：http: [//jsfiddle.net/xv9Wq/9/](http://jsfiddle.net/xv9Wq/9/)

我要做的是创建一个居中并支持动态宽度的标题横幅。

以前，我有一个宽度为 100% 的标题横幅包装器，然后将标题横幅居中。问题是横幅会阻止标题横幅下方的页面。

如何将标题横幅放置在页面中心，同时支持标题横幅内的动态内容长度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:15:57.153

您不能以未知宽度居中绝对定位的元素，所以这里有一个解决方法。

**见：http:** [//jsfiddle.net/thirtydot/xv9Wq/25/](http://jsfiddle.net/thirtydot/xv9Wq/25/)

**CSS：**

```
#headerBanner {
    text-align: center;
    width: 100%;
    position: absolute;
    top: 40px;
    z-index: 2;
    height: 0;
}
#headerBanner > div {
    background: red;
    display: inline-block;
    /* if ie7 support is desired: */
    *display: inline;
    zoom: 1;
} 
```

**HTML：**

```
<div id="headerBanner">
    <div>Centered on page. Supporting dynamic width.</div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:21:55.450

为防止横幅覆盖内容，请尝试以下操作：http: [//jsfiddle.net/xv9Wq/21](http://jsfiddle.net/xv9Wq/21)

# c# - 库引用导入正常，intellisense 看到一切，对象 instatiated... 然后我构建它找不到任何东西？

> ID：11216661
> 
> 赞同：0
> 
> 时间：2012-06-26T22:09:47.253
> 
> 标签：c#, .net, visual-studio-2010

我每隔一段时间就会遇到这个问题，但我从来没有真正想出如何解决它。我有一个与测试控制台项目在同一解决方案中的类库。当我在控制台项目中添加对库的引用并添加 using 语句时，intellisense 可以很好地看到所有类。所以我写了一些代码并使用这些类。所有的班级成员都表现得很好。然后我点击构建。我收到一个错误，指出无法找到库中的类（您是否缺少 using 指令或程序集引用？）。现在突然之间，我所有的对象都用红色下划线，不再用颜色编码为类，而 using 语句也用红色下划线。对库的引用仍在引用文件夹中。重量级

如果我删除参考并阅读它，它是同样的事情。在我构建之前，它会看到一切都很好。

![在此处输入图像描述](../Images/3bcda561a937f816756ca07661bacdfe.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:14:30.183

检查屏幕中的警告，说“*引用的程序集 UTILibrary 无法解析，因为它依赖于 System.Web....* ”。UTILibrary 可能在内部使用 System.Web，所以这个依赖也必须添加到 TestConsole 项目中。

添加它，一切都应该没问题。

# python - 为什么 elementtree.ElementTree.iterparse 使用这么多内存？

> ID：11216662
> 
> 赞同：1
> 
> 时间：2012-06-26T22:09:49.003
> 
> 标签：python, xml, memory, elementtree, iterparse

我正在使用 elementtree.ElementTree.iterparse 来解析一个大 (371 MB) xml 文件。

我的代码基本上是这样的：

```
outf = open('out.txt', 'w') 
context = iterparse('copyright.xml')
context = iter(context)
dummy, root = context.next()

for event, elem in context:
    if elem.tag == 'foo':
        author = elem.text

    elif elem.tag == 'bar':
        if elem.text is not None and 'bat' in elem.text.lower():
            outf.write(elem.text + '\n')
    elem.clear()   #line A
    root.clear()   #line B 
```

我的问题有两个：

首先 - 我需要 A 和 B（参见代码片段注释）吗？有人告诉我 root.clear() 会清除不必要的子项，因此不会占用内存，但这是我的观察结果：在内存消耗方面，使用 B 而不是 A 与既不使用相同（使用任务管理器绘制）。仅使用 A 似乎与同时使用两者相同。

第二 - 为什么这仍然消耗这么多内存？当程序运行时，它在接近尾声时使用了大约 100 MB 的 RAM。

我认为它与outf有关，但为什么呢？它不只是写入磁盘吗？如果它在 outf 关闭之前存储该数据，我该如何避免这种情况？

其他信息：我在 Windows 上使用 Python 2.7.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:37:22.757

（发布的代码，第二行缩进，不应该运行。） [http://bugs.python.org/issue14762](http://bugs.python.org/issue14762)是一个类似的问题，答案是你应该清除每个元素（A行）。如果不了解 outf 是什么（或创建它的代码），就很难回答第二个问题。如果它是一个 StringIO 对象，答案将是显而易见的。您可以查看跟踪器问题的第二条消息中链接的教程：

[http://eli.thegreenplace.net/2012/03/15/processing-xml-in-python-with-elementtree/](http://eli.thegreenplace.net/2012/03/15/processing-xml-in-python-with-elementtree/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T16:43:16.807

改为使用`xml.etree.cElementTree.iterparse()`[在 Python 2.x 中]。

生命太短暂，无法调试其他人的错误。

# jquery - jQuery BBQ 将 URL 状态拆分为可用的块

> ID：11216664
> 
> 赞同：0
> 
> 时间：2012-06-26T22:09:57.247
> 
> 标签：jquery, url, state, hashchange, jquery-bbq

非常努力地理解 jQuery BBQ 并且做得不好。有几件事情我需要弄清楚，但我会试着把重点放在我认为最重要的事情上，希望剔除那部分会引导我解决其他问题。

我有一个页面，其中包含三个部分，每个部分都是隐藏的。当用户单击导航链接时，相应的部分会展开，而其他部分（如果处于活动状态）则被隐藏。URL 使用代表页面的哈希值进行更新。就这样`localhost`变成了`localhost/#work`。在我的代码中，这可以正常工作。

在该`#work`部分中，有多个缩略图对应于不同的视频，我正在尝试将值添加到 URL 中以允许添加书签和其他爱，因此使用 jQuery BBQ。这种作品，有一个小问题的网址变得丑陋。`localhost`变成`localhost/#work=&misery=`. 丑陋，但它已正确更新（并且该部分按预期保持打开状态）。

这是货物：

当`hashchange`事件发生时，我的超级骗子 hash-bash 函数会运行并检查 URL 中的哈希值，然后打开相应的部分。**如何使用 jQuery BBQ 的`.getState()`方法从 URL 中提取视频值，然后单击该缩略图？**

非常感谢，我知道那是冗长的，但我希望尽可能清晰和描述性。请在下面找到一个 jsFiddle（尽管在那个环境中我根本无法显示哈希值......呃！）以及原始代码。

[http://jsfiddle.net/danielredwood/n2KWv/2/](http://jsfiddle.net/danielredwood/n2KWv/2/)

JavaScript：

```
function navi(){
var hash = window.location.hash,
    hspl = hash.split('=')[0],
    acti = $('.out')
    test = $.bbq.getState();

    console.log(test);

    if (!$('body').hasClass('work')){
        acti.removeClass('out').slideUp(400);

        $(hash).addClass('out').slideDown(400);        
    } else {
        if (hspl != '#work') {
            $('body').removeClass('work');

            acti.removeClass('out').slideUp(400);

            $(hash).addClass('out').slideDown(400);
        }
    }
}

/* Nav */

$(window).bind('hashchange', function(){
    navi();
});

/* Thumbnail Clicks */

$('.thumbnail a').click(function(){
    $('body').addClass('work');

    var name = $(this).attr('id');

    $.bbq.pushState(name);                

    return false;
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:23:35.380

除了将“show_video”事件作为每个链接的 onClicks 之外，您还可以有一个单独的 show_video 函数来显示要显示的 id。然后，您可以使用 jsbbq 添加多个哈希状态属性，然后测试它们是否存在并采取相应措施。

因此，您可以执行以下操作：

```
function show_video(vid_id) {
    ...
}

$('.thumbnail a').click(function(){
    ...
    var name = $(this).attr('id');

    $.bbq.pushState({'view':'work', 'video':name});                
    ...

    return false;
});

$(window).bind('hashchange', function(){
    var state = $.bbq.getState();
    if (state['view'] === 'work'){
        var vid_id = state['video'];
        show_video(vid_id);
    } else {
       ...
    }
} 
```

您可能还想阅读 $.bbq.push_state(..) 函数的 *merge_mode* 属性。它允许您仅覆盖特定的哈希状态值或重写整个哈希状态。

[http://benalman.com/code/projects/jquery-bbq/docs/files/jquery-ba-bbq-js.html#jQuery.bbq.pushState](http://benalman.com/code/projects/jquery-bbq/docs/files/jquery-ba-bbq-js.html#jQuery.bbq.pushState)

# asp.net - 动态控件的语法？在 asp.net 和 vb.net 中

> ID：11216669
> 
> 赞同：-1
> 
> 时间：2012-06-26T22:10:38.787
> 
> 标签：asp.net, vb.net

Welp，我现在很沮丧.. 部分原因是我是 asp 新手，这看起来很简单，我无法让它工作，但在 vb 中有几次。

我自愿为客户进行了一次简单的网络表单调查，并且一直坚持为问题创建动态控件/标签。问题的数量会有所不同，因此我不想每次都更改此网络表单。

我在第 6、8 和 10 行绊倒： QuestionLabel1.Text = SQLRead.GetString(0) 我宁愿做这样的事情： QuestionLabel(cntr).Text = SQLRead.GetString(0) 或 ("QuestionLabel" & cntr).Text = SQLRead.GetString(0) 甚至 Me.Controls.Add("QuestionLabel" & cntr)

```
For cntr = 1 To 5
    Dim QuestionLabel As New Label()
    Dim Panel1 As New Panel()
    Me.Controls.Add(QuestionLabel)
    QuestionLabel.ID = "QuestionBox" & cntr
    QuestionLabel1.Text = SQLRead.GetString(0)
    SQLRead.Read()
    QuestionLabel2.Text = SQLRead.GetString(0)
    SQLRead.Read()
    QuestionLabel3.Text = SQLRead.GetString(0) 
```

我知道语法是错误的，但我希望你们能看一下，了解我想要完成的工作，并告诉我 asp.net 是否允许这样做，如果允许，我缺少什么。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:40:52.960

假设您将 .ascx 用于客户端脚本，将 vb.net 用于代码隐藏。您应该考虑使用[Repeater](http://www.w3schools.com/aspnet/aspnet_repeater.asp)控件。它是专门为这样的事情设计的（动态添加控件）。这种架构将允许您使用已有的知识来创建 SQL 语句，并将其与相对简单的 ASP 方法相结合。

# php - php - 调整大小并保存图像？

> ID：11216672
> 
> 赞同：3
> 
> 时间：2012-06-26T22:10:59.203
> 
> 标签：php

> **可能重复：**
> [将图片大小调整为固定大小](https://stackoverflow.com/questions/747101/resize-a-picture-to-a-fixed-size)

我正在使用以下 php 代码调整大小（宽度）并保存图像，代码运行没有错误，但图像没有调整大小。

```
<?php
$old_path = "users_images/".$name.".".$type;
    $new_path = "main_images/".$name.".".$type;
    $image_size = getimagesize($new_path);
    if($image_size['0'] > 700){
        $image_size['0'] = 700;
        }
        rename($old_path, $new_path);// save image

?> 
```

基本上如果图像宽度大于 700 我想将其设置为 700 ？我做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T22:15:02.803

该变量`$image_size['0']`不是对实际图像大小的引用。

您需要计算尺寸的比率，然后使用调整图像大小的适当函数调整它的大小，可能在[GD 库](https://www.php.net/manual/en/book.image.php)中。

首先，您必须加载图像。我会让你选择类型是什么：

```
$image = imagecreatefromjpeg($new_path);
$image = imagecreatefromgif($new_path);
$image = imagecreatefrompng($new_path); 
```

现在计算比率：

```
$ratio = 700 / imagesx($image); // 700 for the width you want...
                                // imagesx() to determine the current width 
```

获取缩放高度：

```
$height = imagesy($image) * $ratio; // imagesy() to determine the current height 
```

进行实际调整大小：

```
$new_image = imagecreatetruecolor($width, $height);
imagecopyresampled($new_image, $image, 0, 0, 0, 0, $width, $height, imagesx($image), imagesy($image));
$image = $new_image; // $image has now been replaced with the resized one. 
```

* * *

我找到了一个[用于调整图像大小的简单类](https://web.archive.org/web/20120625051536/http://white-hat-web-design.co.uk/blog/resizing-images-with-php/)。为了防止链接腐烂，我在这里重新创建了它：

```
<?php

/*
* File: SimpleImage.php
* Author: Simon Jarvis
* Copyright: 2006 Simon Jarvis
* Date: 08/11/06
* Link: http://www.white-hat-web-design.co.uk/articles/php-image-resizing.php
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public License
* as published by the Free Software Foundation; either version 2
* of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU General Public License for more details:
* http://www.gnu.org/licenses/gpl.html
*
*/

class SimpleImage {

   var $image;
   var $image_type;

   function load($filename) {

      $image_info = getimagesize($filename);
      $this->image_type = $image_info[2];
      if( $this->image_type == IMAGETYPE_JPEG ) {

         $this->image = imagecreatefromjpeg($filename);
      } elseif( $this->image_type == IMAGETYPE_GIF ) {

         $this->image = imagecreatefromgif($filename);
      } elseif( $this->image_type == IMAGETYPE_PNG ) {

         $this->image = imagecreatefrompng($filename);
      }
   }
   function save($filename, $image_type=IMAGETYPE_JPEG, $compression=75, $permissions=null) {

      if( $image_type == IMAGETYPE_JPEG ) {
         imagejpeg($this->image,$filename,$compression);
      } elseif( $image_type == IMAGETYPE_GIF ) {

         imagegif($this->image,$filename);
      } elseif( $image_type == IMAGETYPE_PNG ) {

         imagepng($this->image,$filename);
      }
      if( $permissions != null) {

         chmod($filename,$permissions);
      }
   }
   function output($image_type=IMAGETYPE_JPEG) {

      if( $image_type == IMAGETYPE_JPEG ) {
         imagejpeg($this->image);
      } elseif( $image_type == IMAGETYPE_GIF ) {

         imagegif($this->image);
      } elseif( $image_type == IMAGETYPE_PNG ) {

         imagepng($this->image);
      }
   }
   function getWidth() {

      return imagesx($this->image);
   }
   function getHeight() {

      return imagesy($this->image);
   }
   function resizeToHeight($height) {

      $ratio = $height / $this->getHeight();
      $width = $this->getWidth() * $ratio;
      $this->resize($width,$height);
   }

   function resizeToWidth($width) {
      $ratio = $width / $this->getWidth();
      $height = $this->getheight() * $ratio;
      $this->resize($width,$height);
   }

   function scale($scale) {
      $width = $this->getWidth() * $scale/100;
      $height = $this->getheight() * $scale/100;
      $this->resize($width,$height);
   }

   function resize($width,$height) {
      $new_image = imagecreatetruecolor($width, $height);
      imagecopyresampled($new_image, $this->image, 0, 0, 0, 0, $width, $height, $this->getWidth(), $this->getHeight());
      $this->image = $new_image;
   }      

}
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T22:16:47.783

您正在设置一个变量，而不是调整图像大小。我挖了一些旧功能，您需要传递图像对象，保存路径，图像名称，最大高度，最大宽度和质量。这不是最好的功能，但它可以完成工作。

```
function resizeImage($imgObject, $savePath, $imgName, $imgMaxWidth, $imgMaxHeight, $imgQuality)
{
    $source = imagecreatefromjpeg($imgObject['tmp_name']);
    list($imgWidth, $imgHeight) = getimagesize($imgObject['tmp_name']);
    $imgAspectRatio = $imgWidth / $imgHeight;
    if ($imgMaxWidth / $imgMaxHeight > $imgAspectRatio)
    {
        $imgMaxWidth = $imgMaxHeight * $imgAspectRatio;
    }
    else
    {
        $imgMaxHeight = $imgMaxWidth / $imgAspectRatio;
    }
    $image_p = imagecreatetruecolor($imgMaxWidth, $imgMaxHeight);
    $image = imagecreatefromjpeg($imgObject['tmp_name']);
    imagecopyresampled($image_p, $source, 0, 0, 0, 0, $imgMaxWidth, $imgMaxHeight, $imgWidth, $imgHeight);
    imagejpeg($image_p, $savePath . $imgName, $imgQuality);
    unset($imgObject);
    unset($source);
    unset($image_p);
    unset($image);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:14:44.820

您应该使用作为 GD 扩展的一部分的[imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php)函数来复制/移动图像。

# asp.net-mvc-3 - MVC3 / 部分视图 / 多个分页列表

> ID：11216674
> 
> 赞同：0
> 
> 时间：2012-06-26T22:11:24.263
> 
> 标签：asp.net-mvc-3, mvvm, viewmodel, partial-views

**如何在我的主页上呈现两个分页列表？**

我愿意做任何事情——如果这意味着定制我的代码以适合解决方案或定制现有解决方案以适合我的代码。

我已经使用部分视图成功地将一个分页列表呈现到主页。

看看我的代码： Views ..Home > Index.cshtml

```
@foreach (var m in Model.First)
{
    Html.RenderPartial("FirstSummary", m);
}
<div class="pager">
    @Html.PageLinks(Model.PagingInfo, x => Url.Action("Index", new { page = x }))
</div> 
```

视图 ..Shared > FirstSummary.cshtml

```
@model MovinMyStuff.Domain.Entities.First
@{
    if (@Model.IsActive)
    {
    <div class="first-list-item">
        <ul>
            <li>
                <span class="first-name">
                    @Model.Property.ToString() 
                    @Model.Property.ToString()
                    @Model.Property.ToString() -
                    @Model.Property.ToString() 
                    @Model.Property.ToString()
                    @Model.Property.ToString()
                </span>
            </li>
            <li>
                @Html.ActionLink("Details", "Details", "First", new { area = "", id = @Model.FirstId }, new { @class = "button" })
        </li>
    </ul>
</div>
} 
```

}

控制器 > HomeController.cs

```
 public ViewResult Index(int page = 1)
    {
        FirstListViewModel viewModel = new FirstListViewModel
        {
            First = repository.First
            .OrderByDescending(m => m.FirstId)
            .Skip((page - 1) * PageSize)
            .Take(PageSize),
            PagingInfo = new PagingInfo
            {
                CurrentPage = page,
                ItemsPerPage = PageSize,
                TotalItems = repository.First.Count()
            }
        };

        return View(viewModel);
    } 
```

模型 > FirstListViewModel.cs

```
using System.Collections.Generic;
using MovinMyStuff.Domain.Entities;

namespace MovinMyStuff.WebUI.Models
{
    public class FirstListViewModel
    {
        public IEnumerable<First> Firsts { get; set; }
        public PagingInfo PagingInfo { get; set; }
    }
} 
```

ViewModels > FirstAndSecond.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using MovinMyStuff.WebUI.Models;
namespace MovinMyStuff.WebUI.ViewModels

namespace MovinMyStuff.WebUI.ViewModels
{
    public class MovesAndMovers
    {
        public MovesListViewModel movesList { get; set; }
        public MoversListViewModel moversList { get; set; }
        public MovesAndMovers()
        {
            movesList = new MovesListViewModel();
            moversList = new MoversListViewModel();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:23:06.820

我想到了！这是一项艰巨的任务……我花了将近 10 个小时试图解决这个问题，所以请继续关注，因为我会给任何想要这个答案的人。现在我要做的就是阻止刷新将我送回页面顶部。哎呀！希望不会那么糟糕......（：

# php - SFTP 不支持 PHP 和 cURL 错误

> ID：11216680
> 
> 赞同：4
> 
> 时间：2012-06-26T22:12:43.433
> 
> 标签：php, curl

我遵循了[这个 Stack Overflow question thread](https://stackoverflow.com/questions/717854/sftp-from-within-php)的建议，但我一直遇到障碍。

我收到以下错误消息：不支持的协议：sftp

这是我的代码：

```
$ch = curl_init();
if(!$ch)
{
    $error = curl_error($ch);
    die("cURL session could not be initiated.  ERROR: $error."");
}

$fp = fopen($docname, 'r');
if(!$fp)
{
    $error = curl_error($ch);
    die("$docname could not be read.");
}

curl_setopt($ch, CURLOPT_URL, "sftp://$user_name:$user_pass@$server:22/$docname");
curl_setopt($ch, CURLOPT_UPLOAD, 1);
curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_SFTP);
curl_setopt($ch, CURLOPT_INFILE, $fp);
curl_setopt($ch, CURLOPT_INFILESIZE, filesize($docname));

//this is where I get the failure
$exec = curl_exec ($ch);
if(!$exec)
{
    $error = curl_error($ch);
    die("File $docname could not be uploaded.  ERROR: $error.");
}

curl_close ($ch); 
```

我使用 curl_version() 函数查看了我的 curl 信息，发现 sftp 似乎不在支持的协议数组中：

```
[version_number] => 462597
    [age] => 2
    [features] => 1597
    [ssl_version_number] => 0
    [version] => 7.15.5
    [host] => x86_64-redhat-linux-gnu
    [ssl_version] =>  OpenSSL/0.9.8b
    [libz_version] => 1.2.3
    [protocols] => Array
        (
            [0] => tftp
            [1] => ftp
            [2] => telnet
            [3] => dict
            [4] => ldap
            [5] => http
            [6] => file
            [7] => https
            [8] => ftps
        ) 
```

这是我的 cURL 版本过时的问题，还是根本不支持 SFTP 协议？

任何意见是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T03:11:31.013

也许尝试使用[phpseclib，一个纯 PHP SFTP 实现](http://phpseclib.sourceforge.net/)。例如。

```
<?php
include('Net/SFTP.php');

$sftp = new Net_SFTP('www.domain.tld');
if (!$sftp->login('username', 'password')) {
    exit('Login Failed');
}

// puts a three-byte file named filename.remote on the SFTP server
$sftp->put('filename.remote', 'xxx');
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T13:47:28.913

在撰写本文时，如果您可以访问 php，则不再需要依赖和使用 curl 的 sftp 实现。转到 php.net 并查看 ssh2 支持。在那里，您将找到如何以编程方式部署 sftp。

仍然在 php 中的另一种方法是使用在 phpseclib.sourceforge.net 中找到的 Net_SFTP 类/包。

该文档位于 [http://phpseclib.sourceforge.net/documentation/net.html#net_sftp](http://phpseclib.sourceforge.net/documentation/net.html#net_sftp)。

预计？

万一你无法访问 php 或者你不想使用 php，我建议你仍然可以通过使用 expect 来停止担心 curl 的 sftp 实现。如果您的系统上还没有 expect，请转到 www.nist.gov/el/msid/expect.cfm 以获取它。一旦你得到它并安装它，那么脚本 sftp 将看起来类似于

```
#!/usr/bin/expect
spawn /usr/bin/sftp <user@hostname>
expect "password:"
send "<mypassword>\r"
expect "sftp> "
send "get <remotefile> \r"
expect "sftp> "
send "bye \r"
exit 0 
```

where you will replace with your own values.

The idea is to stop wasting time on trying to use sftp with curl. You can use php's implementation or you can script sftp using expect. Hope this helps and saves someone from wasting time.

# java - 使用 Schema 验证无效 XML 时，为什么我不会出现异常？

> ID：11216681
> 
> 赞同：0
> 
> 时间：2012-06-26T22:12:53.483
> 
> 标签：java, xml, xsd, saxparser

这是 XML 模式：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="products">
    <xs:complexType>
      <xs:sequence minOccurs="0" maxOccurs="unbounded">
        <xs:element name="product" type="ProductType"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="ProductType">
    <xs:sequence>
      <xs:element name="id" type="xs:long" />
      <xs:element name="name" type="xs:string" />
      <xs:element name="price" type="xs:decimal" />
    </xs:sequence>
  </xs:complexType>

</xs:schema> 
```

经过一致性验证的 XML 文件：

```
<?xml version="1.0" ?>
<products>
  <product>
    <invalid_tag>32342</invalid_tag>
    <name>Some name</name>
    <price>3.89</price>
  </product>
</products> 
```

使用 XML 并应测试一致性的 Java 代码：

```
SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setValidating(false);
SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
factory.setSchema(schemaFactory.newSchema(new File(xmlSchema)));
parser = factory.newSAXParser();
ProductsSaxHandler handler = new ProductsSaxHandler();
parser.parse(new File(xmlFile), handler); 
```

但我没有任何例外。怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:16:47.723

我看到您正在使用 custom `ProductsSaxHandler`。

您没有为它提供代码，但很可能在`ErrorHandler`调用接口的通知方法之一时它不会引发异常。

确保覆盖`error`,`fatalError`和`warning`方法`ProductSaxHandler`来抛出异常。

# freebsd - fstat - freebsd 系统上的文件描述符总数？

> ID：11216689
> 
> 赞同：2
> 
> 时间：2012-06-26T22:13:15.737
> 
> 标签：freebsd, file-descriptor, fstat

如何获取系统中文件描述符的当前计数？

我知道如何获得最大值。

```
% sysctl kern.maxfiles
kern.maxfiles: 8232 
```

参考：

[http://www.freebsd.org/cgi/man.cgi?query=fstat&apropos=0&sektion=0&manpath=FreeBSD+9.0-RELEASE&arch=default&format=html](http://www.freebsd.org/cgi/man.cgi?query=fstat&apropos=0&sektion=0&manpath=FreeBSD+9.0-RELEASE&arch=default&format=html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T12:06:21.050

你在找`kern.openfiles`吗？

```
[ghoti@pc ~]$ sysctl -ad | grep 'kern.*files:'
kern.maxfiles: Maximum number of files
kern.openfiles: System-wide number of open files
[ghoti@pc ~]$ 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-26T22:19:30.287

cat /proc/sys/fs/file-nr

三列是`total file descriptors allocated since boot`, `free allocated file descriptors`, `maximum open file descriptors`。

附加信息[在这里](http://www.netadmintools.com/art295.html)。

# vb.net - SSIS 自定义脚本：遍历列以连接值

> ID：11216694
> 
> 赞同：3
> 
> 时间：2012-06-26T22:13:56.990
> 
> 标签：vb.net, loops, sha1, ssis

我正在尝试在 SSIS 2008 中创建一个自定义脚本，它将遍历选定的输入列并将它们连接起来，以便它们可用于创建 SHA1 哈希。我知道可用的自定义组件，但我无法在工作时将它们安装在我们的系统上。

虽然这里提出的示例似乎可以正常工作[http://www.sqlservercentral.com/articles/Integration+Services+(SSIS)/69766/](http://www.sqlservercentral.com/articles/Integration+Services+(SSIS)/69766/)当我测试这个时，我只选择了少数而不是所有列，但我得到了奇怪的结果。如果选择的列是按顺序排列的，该脚本似乎才起作用。即使它们是有序的，在如此多的记录或下一个缓冲区之后生成不同的 MD5 哈希，尽管在我的测试数据中行完全相同。

我已经尝试修改上一个链接中的代码以及这些文章，但到目前为止还没有任何乐趣。 [http://msdn.microsoft.com/en-us/library/ms136020.aspx](http://msdn.microsoft.com/en-us/library/ms136020.aspx)
[http://agilebi.com/jwelch/2007/06/03/xml-transformations-part-2/](http://agilebi.com/jwelch/2007/06/03/xml-transformations-part-2/)

作为起点，这可以很好地显示我选择用作输入的列名

```
Public Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)
    For Each inputColumn As IDTSInputColumn100 In Me.ComponentMetaData.InputCollection(0).InputColumnCollection
        MsgBox(inputColumn.Name)
    Next
End Sub 
```

在此基础上，我尝试使用以下代码获取值：

```
Public Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)
    Dim column As IDTSInputColumn100
    Dim rowType As Type = Row.GetType()
    Dim columnValue As PropertyInfo
    Dim testString As String = ""

    For Each column In Me.ComponentMetaData.InputCollection(0).InputColumnCollection
        columnValue = rowType.GetProperty(column.Name)
        testString += columnValue.GetValue(Row, Nothing).ToString()
    Next

    MsgBox(testString)

End Sub 
```

不幸的是，这不起作用，我收到以下错误：

![SSIS 错误消息](../Images/6be4598be886583e6dd6f78b5d8ddcba.png)

尽管我对 VB.net 尤其是 SSIS 中的 VB.net 的了解有限，但我确信我正在尝试做的事情很容易实现，我正在努力。我可以单独定义列名，如下所示[http://timlaqua.com/2012/02/slowly-changeing-dimensions-with-md5-hashes-in-ssis/](http://timlaqua.com/2012/02/slowly-changing-dimensions-with-md5-hashes-in-ssis/)虽然我想尝试一种动态方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T17:11:09.100

您的问题是尝试对数据库中的 NULL 值运行 ToString()。

尝试 Convert.ToString(columnValue) 代替，它只返回一个空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T11:34:00.187

不保证输入列每次都以相同的顺序排列。因此，只要数据流中的元数据发生更改，您最终都会得到不同的哈希值。在编写完全相同的脚本时，我经历了同样的痛苦。

我发现网上的每个答案都表明要构建一个自定义组件才能做到这一点。没必要。我依靠 SSIS 在每次打开脚本组件时构建基类时生成列名的索引。需要注意的是，只要数据流的元数据发生变化，索引就可能发生变化，需要通过重新打开和关闭 SSIS 脚本组件来更新。

您将需要重写 ProcessInput() 以获取对 PipelineBuffer 的引用，该引用未在 ProcessInputRow 中公开，您实际上需要使用它通过索引而不是名称来访问列。

名称和关联索引的列表存储在 ComponentMetaData.InputCollection[0].InputColumnCollection 中，需要对其进行迭代和排序以保证每次都相同的 HASH。

PS。我去年发布了答案，但它消失了，可能是因为它是在 C# 而不是 VB 中（在 SSIS 中有点不相关）。你可以在这里找到包含所有丑陋细节的代码[https://gist.github.com/danieljarolim/e89ff5b41b12383c60c7#file-ssis_sha1-cs](https://gist.github.com/danieljarolim/e89ff5b41b12383c60c7#file-ssis_sha1-cs)

# windows-phone-7 - 在 mvvm light ViewModel (WP7) 中拦截 OnBackKeyPress 事件

> ID：11216699
> 
> 赞同：1
> 
> 时间：2012-06-26T22:14:08.230
> 
> 标签：windows-phone-7, windows-phone-7.1, mvvm-light

在我的 Windows Phone 应用程序中，我有以下场景：

1.  我有两个 ListBox'es fe lbx1 和 lbx2
2.  ViewModel 将数据加载到 lbx1
3.  用户点击 ListBox，命令被触发，ViewModel 将 lbx1 的可见性设置为折叠，将 lbx2 设置为 visilbe。

现在我想做以下事情：当 lbx2 可见时，我想拦截 My ViewModel 中的 OnBackKeyPress 事件，以便我可以将 lbx1 的可见性更改为可见，并将 lbx2 的可见性更改为折叠。

甚至可以使用 mvvm.light 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:40:29.863

好的，找到了我的答案：在 page.xaml 中插入：

```
<i:Interaction.Triggers>
    <i:EventTrigger
        EventName="BackKeyPress">
        <GalaSoft_MvvmLight_Command:EventToCommand
            Command="{Binding BackKeyPressCommand}"
            PassEventArgsToCommand="True"
            />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

Command 是我的 ViewModel 命令，并且 PassEventArgsToCommand="True" 使我能够在触发事件时取消事件

# python - 在 Python 中，如何使用多处理从特定进程中取回数据？

> ID：11216702
> 
> 赞同：1
> 
> 时间：2012-06-26T22:14:32.583
> 
> 标签：python, multiprocessing

```
import multiprocessing as mp
import time

def build(q):
    print 'I build things'
    time.sleep(10)
    #return 42
    q.put(42)

def run(q):
    num = q.get()
    print num

    if num == 42:
        print 'I run after build is done'
        return
    else:
        raise Exception("I don't know build..I guess")

def get_number(q):
    q.put(3)

if __name__ == '__main__':
    queue = mp.Queue()

    run_p = mp.Process(name='run process', target=run, args=(queue,))
    build_p = mp.Process(name='build process', target=build, args=(queue,))
    s3 = mp.Process(name='s3', target=get_number, args=(queue,))

    build_p.start()
    run_p.start()
    s3.start()

    print 'waiting on build'
    build_p.join(1) # timeout set to 1 second
    s3.join()

    print 'waiting on run'
    run_p.join()

    queue.close()
    print 'waiting on queue'
    queue.join_thread()
    print 'done' 
```

我的目标是发送`build`并`run`进入不同的工作人员，并且`run`必须从中获取结果`build`才能继续。

上面根据你的帮助修改过的代码实际上会返回异常，因为`s3`之前`build`有返回的机会。

队列前面的值现在是 3。我们如何确保从`build`进程中得到答案？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:25:25.357

你的问题有点模糊......你描述的问题听起来是同步的，所以 3 个进程有点矫枉过正。

假设您只是尝试传递值以运行，您可以使用队列对象。

```
import multiprocessing as mp
import time

def build(q):
    print 'I build things'
    time.sleep(5)
    q.put(42)
    return 

def run(q):
    while True:
        num = q.get()
        if num == 42:
            print 'I run after build is done'
            return
        else:
            print 'not the right number...'

    def get_number():
        return 41

if __name__ == '__main__':
    queue = mp.Queue()

    run_p = mp.Process(name='run process', target=run, args=(queue,))
    build_p = mp.Process(name='build process', target=build, args=(queue,))

    run_p.start()
    build_p.start()

    print 'waiting on build'
    build_p.join()
    print 'waiting on run'
    run_p.join()
    queue.close()
    print 'waiting on queue'
    queue.join_thread()
    print 'done' 
```

# php - 代理阻止上传

> ID：11216703
> 
> 赞同：1
> 
> 时间：2012-06-26T22:14:35.757
> 
> 标签：php, file-upload, proxy, uploadify

我正在使用 uploadify 在网站上上传文件。每隔一段时间，我就会在服务器日志中收到这些错误：

```
[Tue Jun 26 09:24:45 2012] [error] [client ipaddress] Handler for x-httpd-php5 returned  invalid result code 70007
[Tue Jun 26 09:25:17 2012] [error] [client ipaddress] Handler for x-httpd-php5 returned invalid result code 70014 
```

经过一番谷歌搜索后，我发现这可能是由于有人在我们的网站上使用代理造成的。

我在网上某处读到这可能会有所帮助：

```
pass your apache log in debug mode using the directive LogLevel 
```

我不知道这意味着什么，但我可以将它传递给我的虚拟主机。

有什么方法可以尝试检测代理，以便我可以警告用户上传可能会失败？

关于如何处理这个问题的任何其他想法？

有没有其他人在通过代理上传文件时遇到过这个问题？

# css - 制作类似的css彩色框

> ID：11216709
> 
> 赞同：0
> 
> 时间：2012-06-26T22:15:05.477
> 
> 标签：css

我正在尝试获取图片中框的颜色程度

[http://i46.tinypic.com/iefcpl.png](http://i46.tinypic.com/iefcpl.png)

我喜欢图片中的盒子，我想做一个类似的

这是我的代码，我无法做出相似之处

```
<style>
.b{
background:-moz-linear-gradient(top, #fff, #ebebeb);
height:25px;
border:1px #efefef solid;
}
</style>

<div class="b">

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:25:33.957

```
.b{
    background: #ffffff; /* Old browsers */
    background: -moz-linear-gradient(top, #ffffff 0%, #ebebeb 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#ebebeb)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #ffffff 0%,#ebebeb 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #ffffff 0%,#ebebeb 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #ffffff 0%,#ebebeb 100%); /* IE10+ */
    background: linear-gradient(top, #ffffff 0%,#ebebeb 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#ebebeb',GradientType=0 ); /* IE6-9 */
    height:25px;
    border:1px #DDDDDD solid;
}​ 
```

我使用 Ultimate [CSS Gradient Generator](http://www.colorzilla.com/gradient-editor/)为所有浏览器生成渐变。

[演示](http://jsfiddle.net/any6W/)

# html - 页面上的 CSS3 DropShadow

> ID：11216711
> 
> 赞同：0
> 
> 时间：2012-06-26T22:15:05.930
> 
> 标签：html, css

我正在尝试在网站的每个部分/页面下方创建一个阴影，但这样做时遇到问题。

网站演示：[http ://www.sfu.ca/~jca41/stuph/test/parallax01/parallax01.html](http://www.sfu.ca/~jca41/stuph/test/parallax01/parallax01.html)

HTML：

```
<section id="first" class="page shadow">        
  <article>first page</article> </section>
<section id="second" class="page shadow">
  <article>second page</article> </section>
<section id="third" class="page shadow">        
  <article>third page</article> </section>  
<section id="fourth" class="page shadow">
  <article>fourth page</article> </section> 
```

CSS：

```
.page { height: 1000px; }
.shadow {
    -moz-box-shadow: 0 10px 10px #000;
    -webkit-box-shadow: 0 10px 10px #000;
    box-shadow: 0 10px 10px #000;
}
#first { background: url(img/01.png) no-repeat fixed; }
#second { background: url(img/02.jpg) no-repeat fixed; }
#third { background: url(img/03.jpg) no-repeat fixed; }
#fourth { background: url(img/04.jpg) no-repeat fixed; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:29:09.363

添加位置：相对于您的页面类，然后将 z-index 添加到每个部分，以便顶部的 z-index 比下面的大。

# ios - 转贴：iOS修改iPhone连接外部配件时App自动启动

> ID：11216713
> 
> 赞同：1
> 
> 时间：2012-06-26T22:15:55.540
> 
> 标签：ios, external-accessory

我早些时候曾问过这个问题，但由于细节不清楚或不充分而被关闭。希望我已经解释得更好。就这样吧。

我正在构建一个使用专有协议（通过 iAP）与外部附件通信的 iOS 应用程序。我知道通过在 info.plist 文件中添加唯一的协议名称，可以使应用程序在 iOS 设备连接到外部附件时自动启动（我知道外部附件设备也需要支持）。

*能够与外部附件通信的应用程序应在其 Info.plist 文件中声明它们支持的 ?protocols。声明对特定协议的支持让系统知道您的应用程序可以在连接该附件时启动。如果没有应用程序支持连接的附件，系统可能会选择启动 App Store 并指出支持的应用程序。*

在我的应用程序中，我希望给用户一个图形界面来启用或禁用自动启动应用程序。在幕后，这需要将协议名称设置为预定义的值以启用它或清除它以禁用它。

如果有人能给我有关如何以编程方式修改协议 ID 的信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T11:26:34.140

要在连接支持的外部附件时自动加载应用程序，我们需要在 Info.plist 中放入两件事：

1.  支持的外部附件协议

    ```
    Item 0          yourCompanyProtocol 
    ```

2.  应用程序不在后台运行

    ```
    YES 
    ```

# php - php按ip地址对url进行排序

> ID：11216715
> 
> 赞同：0
> 
> 时间：2012-06-26T22:16:05.617
> 
> 标签：php

好的，我之前发布了一个不太清楚的问题，所以让我再试一次。我正在尝试将我的网站组织成每批 5 个站点的批次，这些站点都具有不同的 IP 地址。

为此，我必须为每个 url 即时获取 IP，然后将它们（这些站点）组织成每批 5 个站点的批次，每个站点都有自己的唯一 IP 地址。

如果我有多个 IP 地址，它们必须在下一批中显示。

谁能帮我解决这个问题？

我有一个带有站点和 IP 的数组。

这是我的代码：

```
if(isset($Organize_List)){
 $List =   explode("\n", $Organize_List);
$IP_Array = array();
      foreach($List as $SIte){
    $Ip = gethostbyname(trim($SIte));
      if(preg_match('/^\d+$/', $Ip[1])){
         $IP_Array[$Ip][] = $SIte.'<br />';
                }
 } 
```

现在这是棘手的地方。

我的问题是如何将**它们组织成每批 5 个站点的批次，每个站点都有自己唯一的 IP 地址。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:26:58.637

```
/* your base data */
$domains = array(/* your data */);

/* a list of domains per ip number, like $domain_by_ip['64.34.119.12'] = 'stackoverflow.com' */
$domain_by_ip = array();

/* a list counting number of domains by ip number */
$ip_count = array();

/* a list of domains we faild to fetch ip number for */
$failed = array();

/* loop through all doains */
foreach($domains as $current_domain)
{
   /* fetch the A record for all domains */
   $current_dns_record = dns_get_record($current_domain, DNS_A);

   /* if there is a dns record */
   if($current_dns_record)
   {
      /* fetch ip from result */
      $current_ip = $current_dns_record[0]['ip'];

      /* thos row is not needed, but php may triggering a warning oterhwise */
      if(!isset($domain_by_ip[$current_ip])) $domain_by_ip[$current_ip] = array();
      if(!isset$ip_count[$current_ip])) $ip_count[$current_ip] = array();

      /* add domain to the list by ip */
      $domain_by_ip[$current_ip][] = $current_dns_record;

      /* count up the count of domains on this ip */
      $ip_count[$current_ip]++;
   }
   else
   {
      /* if there was no dns record, put this domain on the fail list */
      $failed[] = $current_domain;
   }
}

/* create a list for storing batches */
$batches = array();

/* as long as we have ip-numbers left to use */
while($ip_count)
{
   /* create a list for storing current batch */
   $current_batch = array();

   /* sort ip-numbers so we take the ip-numbers whit most domains first */
   arsort($ip_count);

   /* take the top 5 ip-numbers from the list */
   $current_batch_ip_list = array_slice(array_keys($ip_count), 0, 5);

   /* foreach of thous 5 ip-numbers .. */
   foreach($current_batch_ip_list as $current_ip)
   {
      /* move one domain from the domain by ip list to the current batch */
      $current_batch[] = array_pop($domain_by_ip[$current_ip]);

      /* count down the numbers of domains left for that ip */
      $ip_count[$current_ip]--;

      /* if there is no more domains on this ip, remove it from the list */
      if($ip_count[$current_ip] == 0)
      {
         unset($ip_count[$current_ip]);
      }
   }

   /* add current batch to the list of batches */
   $batches[] = $current_batch;
} 
```

# javascript - 使用 SignalR 查明是否有人按下了另一个网站上的按钮

> ID：11216716
> 
> 赞同：1
> 
> 时间：2012-06-26T22:16:14.710
> 
> 标签：javascript, asp.net, jquery, signalr

我试图找出是否有办法使用 SignalR 并在访问者按下另一个站点（不同域）上的按钮时收到通知（实时）。首先，SignalR 是最好的方法吗？其次，我有所有的 Javascript 逻辑来确定访问者是否真的点击了感兴趣的按钮，但不知道如何将该消息中继到我的服务器（实时跟踪器所在的位置）。

其次，没有办法知道在生成信号的另一端会运行什么样的技术（php、asp.net、普通html），这会是个问题吗？

最后，我想使用 SignalR（除了开始使用它并学习它 :) 的最大原因是我可以在仪表板上获得近乎实时的活动报告。如果有更好的解决方案（除了常规的 javascript 轮询和更新），请告诉我。

我想通过这些问题，您可以轻松地发现我是 SignalR 世界的新手，并且需要尽可能多的帮助，因为这将是我在该领域的第一个项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:41:24.223

您可以为此使用 SignalR 自托管服务器。[自主机示例](https://github.com/SignalR/SignalR/wiki/Self-host) 我使用它来让多个客户端访问相同的集线器，从而接收来自其他客户端/站点的通知。

这是我的自托管主要外观的示例：

```
using System;
using System.Configuration;
using System.Diagnostics;
using SignalR.Hosting.Self;

namespace SelfHostedSignalr
{
    class Program
    {
        static void Main(string[] args)
        {
            Debug.Listeners.Add(new ConsoleTraceListener());
            Debug.AutoFlush = true;

            string url = "http://localhost:8081/";
            var server = new Server(url);

            server.MapHubs();
            server.Start();

            Console.WriteLine("Server running on {0}", url);

            while (true)
            {
                ConsoleKeyInfo ki = Console.ReadKey(true);
                if (ki.Key == ConsoleKey.X)
                {
                    break;
                }
            }
        }
    }
} 
```

# opengl-es - 在 OpenGL ES 中渲染 Obj 组

> ID：11216721
> 
> 赞同：3
> 
> 时间：2012-06-26T22:17:07.060
> 
> 标签：opengl-es, vbo

我是 OpenGL ES 的新手，我正在编写一个 iPad 应用程序，需要我加载 Wavefront Obj 文件，在 OpenGL 中绘制它们。我的问题是关于呈现 Obj 文件组的最有效方法。

关于我所拥有的一些背景。Obj 模型的所有解析/加载都正常工作（我使用 GLM 加载文件），因此繁琐的东西已经不碍事了。对于基础项目，我在 XCode 中扩展了 OpenGL ES 游戏模板，并删除了对着色器的所有调用。我正在为我的着色器使用 GLKit 的 BaseEffect，并使用 VAO 和 VBO 加载我的所有顶点数据。对于具有 16 个组的模型，在初始化时我将每个组分成一个 VAO，每个 VAO 都有一个用于顶点数据和法线（交错）的 VBO，以及一个用于纹理坐标的第二个 VBO。每个组都有一种材料（有时是一种纹理，但为了这个问题，只假设材料）。

在我的渲染例程（下面的伪代码）中，我循环遍历为每个组创建的所有 VAO，将组的材料应用于 BaseEffect，然后使用 DrawArrays 绘制它（不使用 DrawElements，因为我已经设置了 VBO up 所以数据已经按索引顺序排列，尽管它可能不如在图形内存上的效率高）。这很有效，我可以用不同的材料绘制每个模型，但是随着组数的增加，我的帧率会下降，因为我必须花更多的时间在我的渲染函数中循环遍历每个组。对于低模型数，这很好，但随着我向应用程序添加更多模型，帧速率远低于 30fps，这是我的基线。

```
for (groups in model)
{
    Bind VAO for this group

    Apply Material or Texture (if one exists) for this group using GLKBaseEffect

    Call PrepareToDraw for GLKBaseEffect

    DrawArrays passing it the vertex count for this group

    glBindVertexArray(0)   
} 
```

显而易见的答案是简化模型以减少组，但我很好奇渲染例程是否有任何改进可以让我做同样的事情但更少的 Draw 调用。我还想有一个详细的 obj 文件，但也有我能做到的最有效的渲染。

这是绘制 obj 文件的最佳方法，我必须为文件中的每个组使用多种材料/纹理，或者有没有一种方法可以在不遍历每个组并单独绘制它们的情况下完成？我希望能够让每个 obj 模型只有 1 次调用 DrawArrays/DrawElements，但我不知道如何做到这一点，并且仍然将多种材质/纹理应用于对象。我一直在查看这段代码并认为“必须有更好的方法”，但我不确定那是什么。如果我错过了一个明显的难题，或者如果您有任何建议可以提供优化它，我将永远感激不尽。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:43:57.247

我认为您的想法非常正确。您一次只能真正拥有一组纹理，或者一个着色器处于活动状态，因此您必须绘制使用该状态的模型部分，切换状态，然后绘制下一组。

如果在添加更多模型时性能下降，您可以尝试对组进行排序，以便连续绘制具有相同状态的所有组而无需切换。

因此，如果您要绘制 100 个模型副本，并且模型具有三组 A、B 和 C：那么不要这样做：

```
foreach(model)
   set state A;
   glDrawArrays(A);
   set state B;
   glDrawArrays(B);
   set state C;
   glDrawArrays(C); 
```

你应该这样做：

```
sort models into groups;
foreach(group)
    set state
    foreach(instance of group)
         glDrawArrays 
```

这为您节省了大约 99% 的状态转换（着色器切换、纹理绑定等）。这将是一个很大的性能改进。

# java - 如何让 Eclipse 识别“内联声明”？

> ID：11216722
> 
> 赞同：0
> 
> 时间：2012-06-26T22:17:24.177
> 
> 标签：java, eclipse

我将“内联声明”放在标题中的引号中，因为我的部分问题是我不知道该怎么称呼它。我对 Java 和一般编程非常陌生，所以“内联声明”这个短语是我能描述的最接近谷歌或其他搜索引擎的内容，我还没有找到任何答案。据我所知，它根本不是“声明”（尽管我认为是，因为我查找了声明、实例化和初始化之间的区别）。希望我能更好地解释我在这里的意思。

我的意思是：如果我在 Java 中声明一个对象，然后分别对其进行初始化，如下所示：

```
 BufferedImage buffImg;
    buffImg = ImageIO.read("MyImage.jpg"); 
```

然后 Eclipse 会将对象名称（本例中为 buffImg）转为特殊颜色，将其添加到 Outline 中，一般将其视为对象。它可以对关键字、字符串、评论做同样的事情......你明白了。

但是如果我做一个“内联声明”，我在一行上声明、实例化和初始化对象，如下所示：

```
 BufferedImage buffImg = ImageIO.read("MyImage.jpg"); 
```

然后 Eclipse 不会把它变成那种特殊的颜色，不会将它添加到大纲中，并且通常将它视为任何随机的、非特殊的单词，但有一个例外：代码突出显示仍会在整个代码中挑选出该单词的所有实例.

那么，我的问题是：

1.  你把这种“all-on-one-line”的声明叫做什么，这样我就知道以后在谷歌里放什么词了？
2.  如何让 Eclipse 识别它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:59:19.073

1.- 单语句声明和初始化没有特殊的词，是java中常用的变量初始化方式。

2.-我认为您的困惑可能来自字段和局部变量。尽管您使用了初始化类型，但 Eclipse 会突出显示字段，而局部变量则不会。此外，字段始终显示在大纲中，而局部变量则不显示。

关于在 Eclipse 中识别局部变量，您可能希望在 SO：[Show All Local Variables in Eclipse](https://stackoverflow.com/questions/7579314/show-all-local-variables-in-eclipse)中查看此答案，还可以查看有关局部变量和字段的更多信息：[Java 教程：变量](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/variables.html)。

![字段在大纲上 局部变量不是。](../Images/1260b864f97574b85e979af05cf3a7fd.png)

问候！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:31:33.010

如果您在方法中执行第一个示例，它可能会将 buffImg 作为*警告*添加到大纲中。您将离开它，尽管很短暂，但未初始化。最佳实践是您的多合一声明加上单行初始化。如果您不能立即设置局部变量，请将其初始化为 null，然后稍后重新分配。

# c++ - 为什么打印字符串时会得到十六进制值？

> ID：11216725
> 
> 赞同：0
> 
> 时间：2012-06-26T22:17:50.670
> 
> 标签：c++, winapi, process

怎么了？为什么我在输出时得到 0x0000etc？

```
int _tmain(int argc, _TCHAR* argv[])
{
    HANDLE hSnapshot = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS, 0 );

    if( !hSnapshot )
        return -1;

    PROCESSENTRY32W pe32w;
    memset( &pe32w, 0, sizeof( pe32w ) );
    pe32w.dwSize = sizeof( PROCESSENTRY32W );
    Process32First( hSnapshot, &pe32w );
    do
    {
        std::cout << pe32w.szExeFile << std::endl;
    } while( Process32Next( hSnapshot, &pe32w ) );

    CloseHandle( hSnapshot );

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:20:01.527

这可能是因为您的`PROCESSENTRY32W`结构正在使用`wchar_t`类型`szExeFile`，并且`std::cout`不了解如何处理宽字符。在这种情况下，它只是简单地打印指针值。

您可以使用`std::wcout`打印宽字符值。

# php - 没有 DTD、head 和 body 标签的 PHP DOMDocument？

> ID：11216726
> 
> 赞同：1
> 
> 时间：2012-06-26T22:18:00.030
> 
> 标签：php, domdocument, doctype

是否可以使用 DOMDocument 类并且不允许它添加文档类型声明、头部和正文标记？我正在为服务器端包含编写我当前的一些代码，并且它正在呈现在已经形成良好的页面上。我不需要额外的标签。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:29:56.070

@Wrikken 所说的，或者对于 PHP < 5.3.6，只需使用正则表达式：

```
$html = preg_replace('~<(?:!DOCTYPE|/?(?:html|body))[^>]*>\s*~i', '', $dom->saveHTML()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T22:25:41.497

从 PHP 5.3.6 开始，您可以在 中使用节点[`echo $DOMDocument->saveHTML($the_node_you_want_to_show)`](http://nl3.php.net/manual/en/domdocument.savehtml.php)，在此之前，我已经滥用`->saveXML()`了一些小修复。但是，您必须有 1 个周围包含的节点（例如`<div>...somecontent and nodex....</div>`，输出为

```
$html = '';
foreach($rootnode->childNodes as $node){
    $html .= $rootnode->ownerdocument->saveHTML($node);
} 
```

# codeigniter - 如何获取使用 $_FILES 上传的文件的完整本地路径

> ID：11216727
> 
> 赞同：0
> 
> 时间：2012-06-26T22:18:05.130
> 
> 标签：codeigniter, file-upload

我通过文件输入上传了一个文件。如果我 print_r($_FILES)，我可以获得几条信息，但它没有给我文件的完整本地路径（我的计算机上的路径，而不是服务器上的路径）。我怎么得到这个？

我需要这个来使用 CodeIgniter 中的 FTP 库。文档是关于如何使用它来上传文件的[。](http://codeigniter.com/user_guide/libraries/ftp.html)

如您所见，它需要完整的本地路径，尽管我不确定为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:36:12.167

由于文件上传路径是一个从服务器到服务器的变量，我建议你使用`move_uploaded_file()`函数：

```
$target = "uploads/myfile.something";
if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target)) {
    // do something
} 
```

这样，无论路径是什么，即使它发生变化，它也将始终有效。可以是您想要的`target`任何东西，它与正在执行脚本的当前文件夹相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:11:21.933

我解决了这个问题。

```
public function upload($file, $folder) {
  $this->CI->ftp->upload($_FILES['file']['tmp_name'], '/public_html/rest/of/path/' . $_FILES['file']['name'], 'ascii', 0775);
 } 
```

该文件正在上传，因此您可以使用`$FILES['file']['tmp_name']`. 这是来自一个班级，所以这就是我使用`$this->CI`. 否则，我只会使用`$this`.

# java - 数学 arctan 在 android 项目中不起作用

> ID：11216729
> 
> 赞同：0
> 
> 时间：2012-06-26T22:18:07.970
> 
> 标签：java, math

在下面的代码中，

```
float i = Float.parseFloat(a);
float j = Float.parseFloat(b);
double div = (double)j/i;  
float theta = (float) Math.atan(Math.toRadians(div)); 
```

`theta`得到错误的值。据我所知，它总是在计算`Math.tan`（我也试过这个，它给了我相同的结果）。因此，即使我写`Math.tan`or `Math.atan`，我也会得到相同的结果。

谁能帮我？

具体例子：

```
i,j----> theta I get:

3,4-----> 0.023 while the correct one is arctan(4/3)=53.13 not tan(4/3)=0.023
3,6-----> 0.052 while the correct one is arctan(9/3)=71.56 not tan(9/3)=0.052 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-26T22:30:23.590

看起来你到处都在奇怪地转换。这就是我*认为*你想要的：

```
public class Test {
    public static void main(String[] args) throws Exception {
        double div = (double)4/3;  
        float theta = (float) Math.toDegrees(Math.atan(div));
        System.out.println(theta); // 53.130104
    }
} 
```

假设你想要 4/3 作为渐变，那根本不是一个*角度*——所以调用`Math.toRadians`它是不合适的。您想调用`Math.atan`渐变以获取弧度值，然后调用`Math.toDegrees`弧度值以获取度数。

# javascript - 如何为 bootstrap-typeahead 引用数据？

> ID：11216730
> 
> 赞同：1
> 
> 时间：2012-06-26T22:18:26.457
> 
> 标签：javascript, twitter-bootstrap, typeahead

这是我的数据：

```
var markers = {
        "example": {"lat": -83.68088192646843, "lng": -125.270751953125, "type": "town"},
        "anotherexample": {"lat": -58.1548020417031, "lng": -21.318115234375, "type": "town"}
} 
```

如何引用此数据源？

编辑：

方法是这样的：

`$('.thing').typeahead({source: markers});`

但这不起作用，我认为这是因为`markers`选择我的标记对象的语法不正确。我应该改用什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T00:09:42.627

您可以尝试以某种方式序列化对象。在我的[示例（jsfiddle）](http://jsfiddle.net/Sherbrow/PDShf/)中，我连接了每个条目以获得某个字符串：

```
var markers_as_str = Array();
for(var index in markers) {
    var marker = markers[index];
    var str = index+" : "+marker.lat+" "+marker.lng+" "+marker.type;
    markers_as_str.push(str);
}

$('#strs').typeahead({
    source: markers_as_str
}); 
```

您可以自定义`matcher`和`sorter`选项来检查特定属性。但是您在显示选项时会遇到困难，因此您必须覆盖该`updater`选项。所有这一切都太过分了，因为你可能不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T00:26:32.950

我用过这个：

```
names = []; 
for (var k in markers) {
    if (markers.hasOwnProperty(k)) {
        names.push(k);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T14:52:13.150

我就此事写了一篇博文，[How to use rich objects and typed objects with Bootstrap Typeahead](http://victorblog.com/2013/06/21/how-to-use-rich-objects-and-typed-objects-with-bootstrap-typeahead/)。关键是将您的对象键入到具有`toString()`序列化`fromString()`方法和反序列化方法的某个类（用于在 Bootstrap Typeahead`updater`函数中引用原始类型的对象）。在我的博客中，我使用`UsState`了一个例子：

```
UsState.prototype.toString = function() {
    return JSON.stringify(this);
};

UsState.fromString = function(serializedState) {
    return $.extend(new UsState(), JSON.parse(serializedState));
}; 
```

然后在 Typeahead 定义中`updater`：

```
updater: function(state) {
    state = UsState.fromString(state);
    $stateMessage.html('<strong>' + state.name + '</strong> has ' + state.numElectoralVotes + ' electoral votes.');
    return state.name;
}, 
```

请注意其他 Typeahead 方法的定义以正确处理您的对象：

```
highlighter: function(state) {
    return $.fn.typeahead.Constructor.prototype.highlighter.call(this, state.name);
}, 
```

# php - 变量中的变量（？） - php循环

> ID：11216734
> 
> 赞同：1
> 
> 时间：2012-06-26T22:18:57.970
> 
> 标签：php, variables, loops

我对 PHP 循环比较陌生，一直在学习它们，它们确实让我的生活更轻松。但是，在尝试为 PHP 循环创建新变量时，我遇到了一些困难。

背景：

我声明了 21 个变量，例如：

```
$q1W = 5;
$q2W = 10;
$q3W = 2; 
```

然后我抓住`$_GET`( `q1`, `q2`, `q3`) 变量并将它们放入带有它们的值的变量中：

```
foreach($_GET as $qinput => $value) {
    $$qinput  = $value ;
} 
```

现在，基本上，我想打开这段代码：

```
$q1final = $q1 * $q1W;
$q2final = $q2 * $q2W;
$q3final = $q3 * $q3W; 
```

进入一个循环，所以我不需要一直输入到 21。这就是我到目前为止所拥有的：

```
<?php for ($i=1; $i<=21; $i++) { 
$q.$i.final = $q.$i * $q.$i.W
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:22:43.433

我建议使用数组而不是大量变量。它使关联您的数据更加直接。例如：

```
$mults = array(
    'q1W' => 5, 
    'q2W' => 10,
    'q3W' => 2
);
$final = array();
foreach ($_GET as $qinput => $value) {
    $final[$qinput] = $mults[$qinput] * $value;
}
print_r($final); 
```

# jquery-ui - jquery选项卡不能在对话框中作为部分视图工作

> ID：11216739
> 
> 赞同：0
> 
> 时间：2012-06-26T22:19:29.093
> 
> 标签：jquery-ui, asp.net-mvc-partialview

我正在打开一个包含以下内容的对话框：这是我的 Appliation Details.cshmtl

```
<script type="text/javascript">
$.ajaxSetup({ cache: false });

$(document).ready(function () {
    $(".display tr:odd").addClass("odd");
    $(".display tr:even").addClass("even");

    //modal popup
    $("#dialog-confirm").dialog({
        autoOpen: false,
        resizable: false,
        height: 200,
        width: 400,
        modal: true,
        buttons: {
            "Delete": function () {
                $(this).dialog("close");
                $('#deleteApplication').submit();
            },
            Cancel: function () {
                $(this).dialog("close");
            }
        }
    });

    $(".deleteLink").click(function (e) {
        e.preventDefault();
        $("#dialog-confirm").dialog("open");
    });

    $(".openDialog").live("click", function (e) {
        e.preventDefault();

        $("<div></div>")
            .addClass("dialog")
            .attr("id", $(this).attr("data-dialog-id"))
            .appendTo("body")
            .dialog({
                title: $(this).attr("data-dialog-title"),
                close: function () { $(this).remove() },
                modal: true,
                width: "90%",
                height: "500",
                buttons: {
                    "Close": function () {
                        $(this).dialog("close");
                    }
                }
            })
            .load(this.href);
    });

    $(".close").live("click", function (e) {
        e.preventDefault();
        $(this).closest(".dialog").dialog("close");
    });

});
</script>

<div class="tabset">
    <ul class="tab_labels">
        <li><span>Details</span></li>
        <li><span>Versions</span></li>
        <li><span>History</span></li>
        <li><span>Log</span></li>
    </ul>
    <div class="tab_content">
        <table id="detailsView" class="display">
            <tbody>
                <tr>
                    <td>@Html.LabelFor(model => model.ApplicationName)</td>
                    <td>@Html.DisplayFor(model => model.ApplicationName)</td>
                </tr>
                <tr>
                    <td>@Html.LabelFor(model => model.Description)</td>
                    <td>@Html.DisplayFor(model => model.Description)</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="tab_content">
        @Html.Partial("_Versions", versions, new ViewDataDictionary {{ "applicationId", Model.ApplicationId}})
    </div>
    <div class="tab_content">
        @Html.Partial("_RecordHistory", history)
    </div>
    <div class="tab_content">
        @Html.Partial("_RecordLog", log)
    </div>
</div>
<br />
<div class="button_wrapper_center">
    <a href="@Url.Action("Index", "Application")" class="button_black_medium"><span style="white-space:nowrap;">Return to List</span></a>
</div>
<div id="dialog-confirm" title="Delete the item?" style="display:none" >  
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>This item will be deleted. Are you sure?</p>  
</div> 
```

部分视图 _Versions 包含打开对话框的链接 这是 _Versions.cshtml

```
 @model IEnumerable<WebDevelopment.SqlData.Version>

@{
    var applicationId = ViewData["applicationId"];
    }

<script type="text/javascript">
    $(document).ready(function () {
        var recordId;

        $(".deleteVersionLink").click(function (e) {
            e.preventDefault();
            var frm = $(this);
            recordId = frm.attr("id");
            $("#dialog-confirmVersion").dialog("open");
        });

        $("#dialog-confirmVersion").dialog({
            autoOpen: false,
            resizable: false,
            height: 200,
            width: 400,
            modal: true,
            buttons: {
                "Delete": function () {
                    $("#deleteVersion" + recordId).submit();
                    $(this).dialog("close");
                },
                Cancel: function () {
                    $(this).dialog("close");
                }
            }
        });

        $('#versions').dataTable({
            "bFilter": false,
            "bPaginate": false,
            "bInfo": false,
            "bSort": false
        });
    });
</script>
<table>
    <tr>
        <td>
            <a href="@Url.Action("Create", "Version", new { applicationId = applicationId })" class="button_black_medium"><span style="white-space:nowrap;">Create New</span></a>
        </td>
    </tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" class="display" id="versions">
    <thead>
        <tr>
            <th>
                @Html.LabelFor(p => Model.FirstOrDefault().VersionNumber)
            </th>
            <th>
                @Html.LabelFor(p => Model.FirstOrDefault().ReleaseDate)
            </th>
            <th>
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.ActionLink(item.VersionNumber, "Details", "Version", new { id = item.VersionId }, new { @class = "openDialog", data_dialog_id = "detailsDialog", data_dialog_title = "Version Details" })
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ReleaseDate)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", "Version", new { id = item.VersionId }, null) |
                    @Html.ActionLink("Delete", "DeleteConfirmed", "Version", new { id = item.VersionId }, new { @class = "deleteVersionLink", @id = item.VersionId })
                    @using (Html.BeginForm("DeleteConfirmed", "Version", new { id = item.VersionId }, FormMethod.Post, new { @id = "deleteVersion" + item.VersionId })){}
                </td>
            </tr>
        }
    </tbody>
</table>
<div id="dialog-confirmVersion" title="Delete the item?" style="display:none" >  
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>This item will be deleted. Are you sure?</p>  
</div> 
```

这是版本控制器

```
 public ActionResult Details(int id)
    {
        ViewBag.History = recordHistoryRepository.GetRecordHistory("ConnectionString", "Version", id);
        ViewBag.Log = recordLogRepository.GetRecordLog("ConnectionString", "Version", id);
        var version = versionRepository.GetVersionById(id);
        if (Request.IsAjaxRequest())
        {
            return PartialView("_DetailsDialog", version);
        }

        return View(version);
    } 
```

这是版本详细信息.cshtml

```
@model WebDevelopment.SqlData.Version

@Html.Partial("_DetailsDialog") 
```

这是_DetailsDialog

```
 @model WebDevelopment.SqlData.Version

@{
    var history = ViewBag.History as IEnumerable<WebDevelopment.SqlData.RecordHistory>;
    var log = ViewBag.Log as IEnumerable<WebDevelopment.SqlData.RecordLog>;
}
<table width="100%">
    <tr>
        <td><h1 class="first">@Html.DisplayTextFor(_ => Model.Application.ApplicationName)</h1></td>
    </tr>
</table>
<div class="tabset">
    <ul class="tab_labels">
        <li><span>Details</span></li>
        <li><span>History</span></li>
        <li><span>Log</span></li>
    </ul>
    <div class="tab_content">
        <table id="detailsDialogView" class="display">
            <tbody>
                <tr>
                    <td>@Html.LabelFor(model => model.VersionNumber)</td>
                    <td>@Html.DisplayFor(model => model.VersionNumber)</td>
                </tr>
                <tr>
                    <td>@Html.LabelFor(model => model.ReleaseDate)</td>
                    <td>@Html.DisplayFor(model => model.ReleaseDate)</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="tab_content">
        @Html.Partial("_RecordHistory", history)
    </div>
    <div class="tab_content">
        @Html.Partial("_RecordLog", log)
    </div>
</div> 
```

对话框打开，我在 firebug 中看到 _DetailsDialog 页面的 html，但选项卡不起作用。_DetailsDialog.cshtml 中的部分视图 _RecordHistory 和 _RecordLog 中的数据表也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:48:32.843

我有一个类似的问题 - 并没有找到解决方案。我改为使用easytabs插件（http://os.alfajango.com/easytabs/）。它就像一种魅力，我发现它易于使用和适应。

# ruby-on-rails - Rails Mailer 实际上并没有发送电子邮件

> ID：11216742
> 
> 赞同：0
> 
> 时间：2012-06-26T22:19:54.740
> 
> 标签：ruby-on-rails, email, smtp, gmail, actionmailer

我刚刚开始在 Rails 上学习 ruby​​，这是我遵循的教程之一：

[http://railscasts.com/episodes/206-action-mailer-in-rails-3](http://railscasts.com/episodes/206-action-mailer-in-rails-3)

我跟着它到了一个 T，我还没有在我的 gmail 帐户中收到任何东西。假设 ruby​​ 的一些更新改变了你做事的方式是否公平？

我从网上阅读所有内容的最佳猜测是，该教程实际上缺少将邮件程序设置为使用 smtp 设置。

这是我的 smtp 设置：

ActionMailer::Base.smtp_settings = { :address => "smtp.gmail.com",

：端口=> 587，

:domain => "alexei.herokuapp.com",

:user_name => "mygmailaccount",

:password => "mygmailpassword",

:authentication => "普通"

:enable_starttls_auto => true }

可能是我在测试时仍在本地环境中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T23:55:50.840

在那个 Railscast 中，Ryan 有一行在开发中不发送任何电子邮件：

```
Mail.register_interceptor(DevelopmentMailInterceptor) if Rails.env.development? 
```

你把那个放进去了吗？如果是这样，那么当您在本地开发应用程序时不会发出任何电子邮件。

尝试删除它。

还可以打开 myapp/logs/development.log 以查看当您尝试发送电子邮件时是否会出现什么。

# javascript - IndexedDB deleteDatabase 不重置版本

> ID：11216744
> 
> 赞同：1
> 
> 时间：2012-06-26T22:20:03.167
> 
> 标签：javascript, indexeddb

在火狐中。初始化（一次）

```
var r, dbname = 'a1', db = mozIndexedDB; 
```

第一的，

```
try { r = db.open(dbname, 5); } catch (ex) { console.log(ex); }
r.onupgradeneeded = r.onsuccess = r.onblocked = r.onerror = function (e) { console.log(e); }; 
```

您会按预期触发两个事件。然后关闭数据库，

```
r.result.close() 
```

最后，删除数据库，

```
try { r = db.deleteDatabase(dbname); } catch (ex) { console.log(ex); }
r.onsuccess = r.onerror = r.onblocked = function (e) { console.log(e); }; 
```

删除成功。但是，当我开始运行第一步脚本（打开数据库）时，'onupgradeneeded' 不会被触发并使用它在删除之前的版本打开数据库。是错误，还是我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T23:32:08.970

你似乎没有做错什么。对于它的价值，我相信`deleteDatabase`FF 中的实现相对较新，所以也许你发现了一个错误。

我会尝试的一件事是首先[检查](https://addons.mozilla.org/en-US/firefox/addon/sqlite-manager/)，然后在重新启动浏览器之前物理删除支持 IndexeDB 的 .sqlite 数据库文件。它可能是一个缓存的东西。下面这些文件的路径。

在 PC 上：

> C:\Users\用户名\AppData\Roaming\Mozilla\Firefox\Profiles\<*>.default\indexedDB

在 Mac 上：

> /Users/username/Library/Application\ Support/Firefox/Profiles/<*>.default/indexedDB/

.sqlite 文件中具有数据库版本的表称为`database`，有两列，名称和版本。您的数据库应该在该表中，并且应该列出版本号。

删除数据库应删除该行。如果没有，我相信你发现了一个错误。

最糟糕的是，删除`indexedDB`配置文件文件夹中的整个目录并重新安装以验证全新安装是否有效。

# html - 两列布局 - div 留出额外空间

> ID：11216747
> 
> 赞同：0
> 
> 时间：2012-06-26T22:20:11.027
> 
> 标签：html, css

首先，我想说我不想用 Javascript 来做这件事。

[http://jsfiddle.net/WqrBY/2/](http://jsfiddle.net/WqrBY/2/)

在这个 jsFiddle 中，我有两列，但右下角的 div 显然与左下角对齐。我希望能够（不调整标记）将右下角 div 移动到右上角（就像左下角在左上角下一样）。

我不想更改标记，因为 div 的顺序在切换到较小屏幕尺寸的单列布局时很重要。

有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:42:14.610

我将在开头说我不确定为什么会这样......我将继续摆弄以测试它。欢迎评论。

这是我的[小提琴](http://jsfiddle.net/tracyfu/WqrBY/3/)

编辑：

我知道您特别提到您不想因为`div`排序而“更改”标记。您愿意添加到标记中吗？这不应该改变信息的顺序，但它可能是你想要做的一个简单的修复：http: [//jsfiddle.net/tracyfu/WqrBY/7/](http://jsfiddle.net/tracyfu/WqrBY/7/)

# php - Dropbox XAMPP 和 MySQL

> ID：11216751
> 
> 赞同：0
> 
> 时间：2012-06-26T22:20:40.980
> 
> 标签：php, mysql, xampp, dropbox

我已将我的 htdocs 文件夹重新定位到我的保管箱文件夹中，并希望对我的 MySQL 数据库做类似的事情。我不知道这是否可能或可取，所以很想听听任何人的建议和想法。

我应该这样做吗？如果是的话怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:24:55.783

我会深深地劝阻它:)

但是......你可以改变你想要的任何东西......

[http://dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_datadir](http://dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_datadir)

您可以在每次启动 mysqld 时简单地添加标志，或者您可以将其添加到用户范围/机器范围的 mysql 配置文件的 [mysqld] 部分。

您需要先初始化表，使用 mysql_install_db 脚本 ( [http://dev.mysql.com/doc/refman/5.5/en/mysql-install-db.html](http://dev.mysql.com/doc/refman/5.5/en/mysql-install-db.html) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:40:13.107

我在我的保管箱上安装了本地服务器，运行良好我只将它用于测试目的，因此没有生产站点从它运行，但它是运行本地站点/测试同步到所有计算机的好方法。

# c# - 检查是否存在 ADO.NET / OLEDB 连接，然后插入到 DB

> ID：11216753
> 
> 赞同：0
> 
> 时间：2012-06-26T22:20:58.203
> 
> 标签：c#, ado.net, ssis, oledb, custom-component

我最初发布[问题](https://stackoverflow.com/questions/11216494/check-for-either-ado-net-oledb-connection-presence)是为了检查是否存在 ADO.NET/OLEDB 连接类型。我想知道，在插入数据库时​​如何更改代码。

例如，当连接类型为 ADO.NET 时，我们在连接类型中使用“Transaction”。

```
 SqlConnection connection = (SqlConnection)connections[_connectionName].AcquireConnection(transaction); 
```

现在，如果我有 OLEDB 连接（而不是 ADO.NET），我想在这段代码中处理这种情况。我需要做什么。对不起，如果我听起来不够技术，但我不是 C# 人。再次感谢您的帮助。

**编辑** 我在这里粘贴整个代码，因为我似乎无法使用 OLEDB 类型的连接。我只能使用 ADO.NET...我知道它很简单，但我不知道它是什么。

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using Microsoft.SqlServer.Dts.Runtime;
using System.Data.OleDb;
using System.Data.Common;

namespace AOC.SqlServer.Dts.Tasks

{

[DtsTask(
    DisplayName = "Custom Logging Task",
    Description = "Writes logging info into a table")]
public class CustomLoggingTask : Task
{

    private string _packageName;
    private string _taskName;
    private string _errorCode;
    private string _errorDescription;
    private string _machineName;
    private double _packageDuration;

    private string _connectionName;
    private string _eventType;
    private string _executionid;
    private DateTime _handlerdatetime;
    public string ConnectionName
    {
        set
        {
            _connectionName = value;
        }
        get
        {
            return _connectionName;
        }
    }

    public string Event
    {
        set
        {
            _eventType = value;
        }
        get
        {
            return _eventType;
        }
    }

    public override DTSExecResult Validate(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log)
    {
        const string METHOD_NAME = "CustomLoggingTask-Validate";

        try
        {

            if (string.IsNullOrEmpty(_eventType))
            {
                componentEvents.FireError(0, METHOD_NAME, "The event property must be specified", "", -1);
                return DTSExecResult.Failure;
            }

            if (string.IsNullOrEmpty(_connectionName))
            {
                componentEvents.FireError(0, METHOD_NAME, "No connection has been specified", "", -1);
                return DTSExecResult.Failure;
            }

            DbConnection connection = connections[_connectionName].AcquireConnection(null) as DbConnection;
            if (connection == null)
            {
                componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
                return DTSExecResult.Failure;
            }

            if (!variableDispenser.Contains("System::SourceID"))
            {
                componentEvents.FireError(0, METHOD_NAME, "No System::SourceID variable available. This task can only be used in an Event Handler", "", -1);
                return DTSExecResult.Failure;
            }

            return DTSExecResult.Success;
        }
        catch (Exception exc)
        {
            componentEvents.FireError(0, METHOD_NAME, "Validation Failed: " + exc.ToString(), "", -1);
            return DTSExecResult.Failure;
        }
    }

    public override DTSExecResult Execute(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log, object transaction)
    {
        try
        {
            string commandText =
@"INSERT INTO SSISLog (EventType, PackageName, TaskName, EventCode, EventDescription, PackageDuration, Host, ExecutionID, EventHandlerDateTime)
VALUES (@EventType, @PackageName, @TaskName, @EventCode, @EventDescription, @PackageDuration, @Host, @Executionid, @handlerdatetime)";

            ReadVariables(variableDispenser);
            DbConnection connection = connections[_connectionName].AcquireConnection(transaction) as DbConnection;
            //SqlConnection connection = (SqlConnection)connections[_connectionName].AcquireConnection(transaction);
            DbCommand command = null;
            //using (SqlCommand command = new SqlCommand())
            if (connection is SqlConnection)
                command = new SqlCommand();
            else if (connection is OleDbConnection)
                command = new OleDbCommand();

            {
                command.CommandText = commandText;
                command.CommandType = CommandType.Text;
                command.Connection = connection;

                command.Parameters.Add(new SqlParameter("@EventType", _eventType));
                command.Parameters.Add(new SqlParameter("@PackageName", _packageName));
                command.Parameters.Add(new SqlParameter("@TaskName", _taskName));
                command.Parameters.Add(new SqlParameter("@EventCode", _errorCode ?? string.Empty));
                command.Parameters.Add(new SqlParameter("@EventDescription", _errorDescription ?? string.Empty));
                command.Parameters.Add(new SqlParameter("@PackageDuration", _packageDuration));
                command.Parameters.Add(new SqlParameter("@Host", _machineName));
                command.Parameters.Add(new SqlParameter("@ExecutionID", _executionid));
                command.Parameters.Add(new SqlParameter("@handlerdatetime", _handlerdatetime));
                command.ExecuteNonQuery();
            }

            return DTSExecResult.Success;
        }
        catch (Exception exc)
        {
            componentEvents.FireError(0, "CustomLoggingTask-Execute", "Task Errored: " + exc.ToString(), "", -1);
            return DTSExecResult.Failure;
        }
    }

    private void ReadVariables(VariableDispenser variableDispenser)
    {
        variableDispenser.LockForRead("System::StartTime");
        variableDispenser.LockForRead("System::PackageName");
        variableDispenser.LockForRead("System::SourceName");
        variableDispenser.LockForRead("System::MachineName");
        variableDispenser.LockForRead("System::ExecutionInstanceGUID");
        variableDispenser.LockForRead("System::EventHandlerStartTime");
        bool includesError = variableDispenser.Contains("System::ErrorCode");
        if (includesError)
        {
            variableDispenser.LockForRead("System::ErrorCode");
            variableDispenser.LockForRead("System::ErrorDescription");
        }

        Variables vars = null;
        variableDispenser.GetVariables(ref vars);

        DateTime startTime = (DateTime)vars["System::StartTime"].Value;
        _packageDuration = DateTime.Now.Subtract(startTime).TotalSeconds;
        _packageName = vars["System::PackageName"].Value.ToString();
        _taskName = vars["System::SourceName"].Value.ToString();
        _machineName = vars["System::MachineName"].Value.ToString();
        _executionid = vars["System::ExecutionInstanceGUID"].Value.ToString();
        _handlerdatetime = (DateTime)vars["System::EventHandlerStartTime"].Value;
        if (includesError)
        {
            _errorCode = vars["System::ErrorCode"].Value.ToString();
            _errorDescription = vars["System::ErrorDescription"].Value.ToString();
        }

        // release the variable locks.
        vars.Unlock();

        // reset the dispenser
        variableDispenser.Reset();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:42:12.713

由于`connections[_connectionName].AcquireConnection(transaction);`你的代码部分与 a 无关`SqlConnection`（你只是在`SqlConnection`之后转换），你应该能够声明`connection`，`var`然后做任何`connection`你需要的事情。

```
var connection = connections[_connectionName].AcquireConnection(transaction); 
```

一旦你有了你的`connection`对象，你可以将它转换成你需要的任何连接类型，并执行与你已经将`connection`变量声明为该类型一样的操作。例如

```
if(connection is DbConnection)
{
    // ((DbConnection)connection).SomethingToDoWithDbConnection
}

if(connection is SqlConnection)
{
    // ((SqlConnection)connection).SomethingToDoWithSqlConnection
}

if(connection is OleDbConnection)
{
    // ((OleDbConnection)connection).SomethingToDoWithOleDbConnection
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:47:59.910

在[`System.Data.Common`](http://msdn.microsoft.com/en-us/library/9tahwysy)您将找到具体数据库类型（SqlConnection、OleDbConnection、SqlDataAdapter 等）都派生自的基类。

如果你使用这些，即。`DbConnection`，无论您使用哪种具体实现，代码都是相同的。

```
DbConnection connection = connections[_connectionName]
    .AcquireConnection(transaction) as DbConnection; 
```

然后，您可以调用`DbConnection.BeginTransaction()`而不是，`SqlConnection.BeginTransaction()`连接是 OleDbConnection 还是 SqlConnection 都没有关系。

只要您需要调用的所有方法都是从 DbConnection 继承的，这将起作用。

您的其余代码也可以使用基本类型，所以`DbTransaction`，`DbDataAdapter`等等`DbDataReader`。

因为您的`AquireConnection()`方法不返回具体的连接类型，所以您可以利用依赖注入并编写非特定于实现的代码。

* * *

具体来说，对于插入，您将拥有如下内容：

```
DbCommand command = null;
if (connection is SqlConnection)
   command = new SqlCommand();
else if (connection is OleDbConnection)
   command = new OleDbCommand();
command.CommandText = "INSERT STATEMENT HERE";
command.Connection = connection;
command.ExecuteNonQuery(); 
```

不要忘记你需要`connection.Close()`某个地方。（如果您使用的是 ConnectionManager，则为 ReleaseConnection）

# iphone - 将 JSON 属性响应转换为 BOOL

> ID：11216754
> 
> 赞同：0
> 
> 时间：2012-06-26T22:21:08.780
> 
> 标签：iphone, objective-c, ios, ipad

如果我有如下 JSON 响应：

```
 "is_following": false, 
```

如何将其转换为 Objective-C 中的 BOOL？

这似乎不对：

```
 [[NSNumber numberWithInt:(int)[profileData valueForKey:@"is_following"]] boolValue]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:36:38.803

这取决于您使用的 JSON 解析器。例如，在使用 TouchJSON 的情况下，您只需调用`boolValue`已解析的对象：`[[profileData objectForKey:@"is_following"] boolValue]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:27:07.440

因为`-valueForKey`返回一个对象 ( `id`)，并且`BOOL`是 的别名`signed char`，所以您可以简单地调用`-intValue`结果：

```
BOOL asBool = [[profileData valueForKey:@"is_following"] intValue]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:28:58.523

为什么不直接打电话`-boolValue`呢？

```
[profileData objectForKey:@"is_following"] boolValue] 
```

任何 JSON 框架都会将该 JSON`false`值转换为`NSNumber*`. 事实上，它`NSString*`也会响应`-boolValue`，因此在发出脑死亡 JSON 源的情况下，`"false"`您仍然可以得到保障。但是，如果 JSON 包含`null`或任何容器类型，那么您就会遇到问题，因此您可能需要仔细检查该值实际上是什么类。

*注意，我用的是`-objectForKey:`代替`-valueForKey:`，因为如果这是 JSON 则`profileData`必须是`NSDictionary*`. `-objectForKey:`是用于从中提取数据的正确方法`NSDictionaries`。

# android - 布局问题

> ID：11216761
> 
> 赞同：-1
> 
> 时间：2012-06-26T22:22:13.097
> 
> 标签：android, android-layout, unicode

我正在尝试在 Eclipse Android 中从头开始创建自己的电话拨号器，我在 XML 中使用数字 0-9 和一些按钮/图像按钮进行了简单的电话布局。

*   基本上我放了一些`Button`s 和`ImageButton`s 并且我知道我需要`setOnClickListener()`在 Java 代码中调用它们。就像是：

    ```
    Button no1 = (Button) findViewById(R.id.button1);
    no1.setOnClickListener(new View.OnClickListener() 
    ```

*   我`<EditText`在数字（按钮和图像按钮）之上做了一个显示数字。但是当我点击时什么都没有出现。我不确定我错过了什么导致这个问题。

*   我还在同一个 XML 文件中做了一个“设置”按钮，单击该按钮后，会弹出一个带有几个可点击图标的 toast。我不太确定该怎么做。我确实阅读了一些教程，但我的似乎不太正确。
*   希望如果上述几点可以得到纠正，我希望我可以尝试将 SMS 字符设置为 Unicode，这可以限制为 50 个字符等。但这对我来说仍然是遥不可及的。我将在后面的部分中这样做。

我做了一个谷歌研究，但我并没有得到正确的信息，因为它只是零零碎碎的......

实际上，我想创建这个定制的电话拨号器，因为我打算将它安装在我妈妈的 2.1 Froyo 电话中。

谁能给我建议？是否有示例代码可以检查我出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:29:27.050

在这段时间内，应用程序可能仍然存在一些缺陷。但你在正确的轨道上。我会让你的类 xxx.java 扩展`View.OnClickListener`，然后你可以将你的类添加为每个按钮的侦听器，例如`no1.setOnClickListener(this);`。使用 switch 语句找出电话号码并拨打电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T00:49:46.723

让您的班级实现 OnClickListener 并为每个按下的数字创建一个 switch(arg0.getId()) 和一个案例。

每次您按下一个号码时，EditText 都会收到该号码，然后当您按下呼叫按钮时，它会呼叫该 EditText 中的号码。

# c# - 有效地使用 XmlDocument.Save()

> ID：11216762
> 
> 赞同：2
> 
> 时间：2012-06-26T22:22:16.097
> 
> 标签：c#, .net, xml, save

我正在使用 C# 中的 .XML 文档，在我的代码范围内，我从中选择节点、添加节点和删除节点很多次。

此文档的所有 XML 编辑都包含在一个类中，其他类调用该类。

由于数据访问类无法判断使用它的类是否完成了对文档的编辑，因此它没有关于是否/何时保存的逻辑。

我*可以*在每次修改文档后保存，但我担心性能问题。

或者，我可以假设/希望它会被使用它的其他类保存（我创建了一个单行公共方法来保存文档，因此另一个类可以请求保存）。

第二个选项与我有关，因为我觉得我应该以某种方式在全球范围内强制执行它，以避免调用它并且不提交修改。到目前为止，永远不会出现需要回滚的情况。任何更改都是应该提交的更改。

.Net（或编码设计）是否有办法在这种情况下平衡性能和安全性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:29:42.017

基本上你的问题告诉我：你需要保存，但你不知道什么时候，因为关于保存点的知识不在你的课堂上。

我的建议是包装你的电话——假设你有类似的东西`public void MyClass.SomeEditing(int foo)`，创建一个像`public void MyClass.SomeEditing(int foo, bool ShouldSave)`shouldsave defaultingto这样的包装器`true`。

这样，您班级的消费者可以决定是否要立即保存，`false`如果他知道，则选择立即进行其他编辑将导致保存。调用“旧”API 的现有代码受默认“立即保存”保护

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T22:36:21.213

如果您总是想保存更改（只是不知道何时），那么您可以将 save 命令添加到类[destructor](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)。这样您就知道更改将始终被保存。

如果您需要其他帮助或想要示例，请发表评论，否则请选择正确答案。

**更新**：我注意到类析构函数可能会在其他对象（如 FileStream）已经被释放后触发。
我建议您在析构函数中测试这种情况，并实现和使用[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)接口。然后，您可以订阅[Application.Exit](http://msdn.microsoft.com/en-us/library/system.windows.application.exit.aspx)事件或[Application.ApplicationExit](http://msdn.microsoft.com/en-us/library/system.windows.application.exit.aspx)事件并在那里调用 dispose。
确保将代码保留在析构函数中（但确保将其放在 try 块中），以防程序崩溃或出现其他意外退出。

# ruby-on-rails-3 - 重定向时设计 + Facebook Omniauth 错误

> ID：11216766
> 
> 赞同：1
> 
> 时间：2012-06-26T22:22:37.640
> 
> 标签：ruby-on-rails-3, devise, omniauth, facebook-authentication

我正在为我的 Rails 3.1 应用程序使用设计、omniauth 和 facebook-omniauth。身份验证后，我想将用户重定向到正在查看的页面。我已经使用了以下代码：

```
def facebook
@user = Spree::User.find_for_facebook_oauth(request.env["omniauth.auth"], current_user)
if @user.persisted?
flash[:notice] = "Yipee! You were successfully authorized from your Facebook account!!"
sign_in @user, :event => :authentication
redirect_to request.referrer
end 
```

这仅在创建用户时给我以下错误：

```
ActionController::ActionControllerError in Spree::OmniauthCallbacksController#facebook
Cannot redirect to nil! 
```

以下时间已经创建了用户，在登录期间和之后没有显示错误。

你建议我如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:34:22.003

您可以在应用程序控制器中覆盖登录/注册路径的功能：

```
def after_sign_up_path_for(resource)
  credit_path 
  return request.env['omniauth.origin'] || session[:return_to] 
end 

def after_sign_in_path_for(resource)
  return request.env['omniauth.origin'] || session[:return_to]
end 
```

使用会话将当前路径存储在您希望它们去的路径中：`session[:return_to] = request.url`#store current location

或者您创建一个方法，一旦他们进入路径并存储该位置，该方法将始终被调用。但是，当你这样做时要注意一个巨大的循环重定向。

# jquery - 如何使用 jQuery 旋转图像？

> ID：11216769
> 
> 赞同：7
> 
> 时间：2012-06-26T22:22:47.360
> 
> 标签：jquery, image, rotation

我试图让图像在每次点击时旋转到位（图像是一个老式的电视旋钮）。尽管我尽了最大努力，但我无法让它工作。

代码如下：

```
 var value = 0
$("#img").rotate({ 
bind: 
{ 
    click: function(){
        value +=90;
        $(this).rotate({ animateTo:value})
    }
 } 
```

});

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-26T23:12:06.587

我提供了一个 jsFiddle，它会***在每次鼠标点击后导致 div 旋转。***

本质上，这是来自[**jqueryrotate.js**](http://code.google.com/p/jqueryrotate/wiki/Examples#Example_5)插件的**示例 5 。**[](http://code.google.com/p/jqueryrotate/wiki/Examples#Example_5)

 **参考：[**jsFiddle**](http://jsfiddle.net/uCy76/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T22:30:17.237

有一个 jQuery 补丁，可以让您执行以下操作： [http ://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html](http://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html)

```
$('#img').click(function(){
  $(this).animate({rotate: '+=10deg'}, 0);
}); 
```

或者这个插件： [http](http://code.google.com/p/jqueryrotate/) ://code.google.com/p/jqueryrotate/它允许这样的东西：

```
$("#img").rotate({
    bind: {
        click: function() {
            $(this).rotate({
                animateTo: (parseInt($(this).getRotateAngle()) + 10),
                easing: $.easing.easeInOutExpo
            })
        }
    }
});​ 
```

( [http://jsfiddle.net/mFY22/3/](http://jsfiddle.net/mFY22/3/) )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:38:46.160

这是一个使用名为[jqueryrotate的 jquery 插件的快速示例](http://code.google.com/p/jqueryrotate/)

[请参阅此处的 jsfiddle。](http://jsfiddle.net/mFY22/5/)**

# android - 安卓上的日语 TTS

> ID：11216771
> 
> 赞同：0
> 
> 时间：2012-06-26T22:22:47.953
> 
> 标签：android

我必须为日本开发一个必须使用文本到语音引擎（日语 TTS）的 android 应用程序。当安卓手机在日本市场销售时，是否为用户提供了他们语言的默认文本到语音引擎？

我知道他们可以从市场上购买 TTS 引擎，并且以编程方式我必须检查 TTS 引擎是否存在，但我需要知道我是否可以预期大多数手机上默认安装的引擎我必须基于此做出可行性决定

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T23:37:45.890

我使用了 NTT Docomo 的三款不同的 Android 手机，它们都默认安装了英语和日语 TTS。我看到的几个 AU 上的 Android 也随之而来。我不确定软银，但我敢打赌它们是一样的。

作为记录，我住在那里的时候有一台 HT-03A（HTC Magic）、Galaxy S 和 Galaxy S2。

# mysql - mysql 查询中讨厌的 IF/THEN 语句

> ID：11216776
> 
> 赞同：0
> 
> 时间：2012-06-26T22:23:44.273
> 
> 标签：mysql, database

```
> select * from site, count(*) as count  
> from myTable 
> where year(created_at) = 2012
> group by site order by count DESC limit 10000 
```

我正在选择大量的数据，这些数据本质上具有非常长且无用的尾巴。

我试图切断这个查询，所以它不会显示少于 500 个结果的任何内容。

我为解决这个问题所做的所有谷歌搜索都证明不是很有帮助。

知道如何构造查询以限制此数据仅显示计数为 500 或更多的站点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T00:53:07.350

```
select * from site, count(*) as count  
from myTable 
where year(created_at) = 2012
group by site having count>500 order by count DESC limit 10000 
```

如果您只想选择超过 500 个结果的行，则希望在其中出现“计数 > 500”。

WHERE 不适用于聚合函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T23:07:11.300

```
select 
  site , 
  count(*) as val 
from 
  myTable 
where 
  year(created_at) = 2012 
and 
  val > 500 
group by 
  site
HAVING COUNT(*) > 500 
```

*编辑*

点到肖恩 - 我意识到我使用的是 MSSQL 语法，而不是 MySQL

另外 - 请参阅[按 COUNT(*) 过滤？- MYSQL](https://stackoverflow.com/questions/5664103/filter-by-count-mysql)

# c++ - socket.io 与 C++？

> ID：11216779
> 
> 赞同：4
> 
> 时间：2012-06-26T22:23:57.223
> 
> 标签：c++, node.js, socket.io

请告诉我我可以编写一些 C++ 控制台应用程序并连接到一些使用 socket.io 的 node.js 服务器（在 nodester 示例上）吗？一些 (C/C++) -> (node.js/socket.io) 库？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:39:57.947

[boost::asio 基于 c++ socket.io 客户端](https://github.com/uning/socket.io-client-cpp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:42:30.003

对的，这是可能的。FWIW，一个[开源项目在 Objective-C 中执行此操作](https://github.com/pkyeck/socket.IO-objc)，它至少应该为您提供一些关于如何在 C/C++ 中执行此操作的想法。

# python - 列表和追加的 Python 奇怪行为

> ID：11216783
> 
> 赞同：3
> 
> 时间：2012-06-26T22:24:18.163
> 
> 标签：python, list, append

以下代码是我遇到的一个问题，正在寻找解释。代码的行为与我的预期不同。代码下方将是我的预期输出和实际输出。最后要注意的一件事是，我知道这段代码可能很“奇怪”，而且使用 range(1) 至少可以说有点奇怪。这样做的原因是程序中的这种确切发生（范围是变量，但在这些值处）导致了问题。所以我做了这个简单的代码来复制它。

```
userList = []

class User():
    listA = []
    listB = []

    def setup(self):
        for i in range(1):
            self.listA.append('a')
            self.listB.append('b')

for i in range(5):
    user = User()
    userList.append(user)

for i in range(len(userList)):
    userList[i].setup()

for i in range(len(userList)):
    print str(userList[i].listA)
    print str(userList[i].listB) 
```

**预期产出**

```
['a']
['b']
['a']
['b']
['a']
['b']
['a']
['b']
['a']
['b'] 
```

**实际输出**

```
['a','a','a','a','a']
['b','b','b','b','b']
['a','a','a','a','a']
['b','b','b','b','b']
['a','a','a','a','a']
['b','b','b','b','b']
['a','a','a','a','a']
['b','b','b','b','b']
['a','a','a','a','a']
['b','b','b','b','b'] 
```

**讨论**

我感谢任何解释为什么会发生这种情况。我不确定内置的 append() 函数是否会以某种方式影响所有用户，或者每个用户是否以某种方式共享他们的字段。在 Python 2.7.3 上运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T22:32:20.597

将此与您的代码进行比较

```
class User():
    def setup(self):
        self.listA = []                          # instance variable
        self.listB = []                          # instance variable
        for i in range(1):
            self.listA.append('a')
            self.listB.append('b') 
```

请注意，没有必要在类级别“声明”任何变量

# javascript - jQuery 强制/技巧 .scroll() 冒泡

> ID：11216784
> 
> 赞同：1
> 
> 时间：2012-06-26T22:24:22.013
> 
> 标签：javascript, jquery, ajax, scroll

是否可以强制或欺骗`.scroll()`事件冒泡，以便我可以捕获用户在 ajax 加载的内容中`<div>`滚动？`overflow: auto;`我正在通过加载一些 HTML，`$.ajax`并且需要一些方法来检测它们正在滚动。根据 W3C 滚动不应该冒泡，这就是我认为 jQuery 不这样做的原因。但是我能够赶上`$(window).on('scroll', function() { console.log('scrolling'); });`

```
$(window).load(function() {
    $.ajax({
        url: "/data.html",
        dataType: "html",
        success: function(data) {
            $("#container").html(data);
        }        
    });
});

$(document).ready(function() {
    $('#container').on('scroll', '#content', function () {
        console.log('scrolling');
    });
}); 
```

是设置加载数据的`$('#container')`容器，是来自请求中加载的 HTML`$.ajax``$('#content')``$.ajax`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T05:02:10.397

答案是通过 jQuery 添加一个包装器元素，然后您可以附加一个滚动事件。

```
$("#container").wrap('<div id="wrapper"></div>');

$("#wrapper").on('scroll', function() {
    // do stuff
}); 
```

# iphone - 正确旋转的程序化 UIView

> ID：11216786
> 
> 赞同：0
> 
> 时间：2012-06-26T22:24:32.750
> 
> 标签：iphone, ios, uiview, orientation, device-orientation

我一直在以编程方式完成几乎所有的用户界面，并在界面生成器中执行了一些细微的更改。但是所有 UI 的 99% 都是在代码中完成的，因为我觉得这样做可以获得一定的灵活性方式。

但是我现在在处理设备的旋转时遇到了问题，因为我有几个 UIViews 被添加为子视图我面临一个旋转问题，因为这是我通常声明视图的方式

```
htmlTest.webViewTest.frame = CGRectMake(4.0, 4.0, 312.0, 363.0); 
```

并且由于设备旋转时这个固定的 CGRectMake 视图保持相同的大小并且正确地适合视图的方向。

所以我研究了一个在我看来很糟糕的解决方案。我在其中制作了几个视图，用户可以从中选择选项，然后我将它们动画出来。但是他们需要能够处理任何一个中的加载纵向或横向，然后如果在加载它们时，它们需要能够处理从任一方向到另一个方向的旋转。

这就是我所做的观点之一。

```
#pragma createAwesomeJumpBar
- (void)jumpBarButtonPosition:(int)changeView
{
    // ChangeView is used to check if the this method is being called from a device rotation or from a button press (0, being rotation and 1, being tabbarButton touch

    // if tabbar selected
    if (changeView == 1) {
        if  ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationPortrait)
        {
            if (![jumpBarContainerPortrait superview]) {
                // load portrait view
                jumpBarContainerPortrait = [[UIView alloc] initWithFrame:CGRectMake(0.0, 480.0, 320, (jumpBarHeightPortrait + 49.0))];
                jumpBarContainerPortrait.backgroundColor = [UIColor scrollViewTexturedBackgroundColor];

                // add jumpbar container to view
                [self.view insertSubview:jumpBarContainerPortrait belowSubview:actionTabBar];

                [UIView animateWithDuration:0.6
                                      delay:0.0f
                                    options:UIViewAnimationCurveEaseIn 
                                 animations:^{

                                     jumpBarContainerPortrait.frame = CGRectMake(0.0, (367 - jumpBarHeightPortrait), 320.0, (jumpBarHeightPortrait + 49.0)); // display jumpBar

                                 } completion:^(BOOL finished) {
                                     if (finished) {
                                         NSLog(@"YAY!");
                                     }
                                 }];
            }
            else if ([jumpBarContainerPortrait superview]) {
                //unload portrait view
                [UIView animateWithDuration:0.6
                                      delay:0.0f
                                    options:UIViewAnimationCurveEaseIn 
                                 animations:^{

                                     jumpBarContainerPortrait.frame = CGRectMake(0.0, 480.0, 320.0, (jumpBarHeightPortrait + 49.0)); // display jumpBar

                                     // remove selected tabButton highlight
                                     [actionTabBar setSelectedItem:nil];

                                 } completion:^(BOOL finished) {
                                     if (finished) {

                                         // remove subView for superView
                                         [jumpBarContainerPortrait removeFromSuperview];

                                     }
                                 }];

            }

        }
        else if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeLeft || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeRight)
        {
            if (![jumpBarContainerLandscape superview]) {
                // load landscape view
                jumpBarContainerLandscape = [[UIView alloc] initWithFrame:CGRectMake(0.0, 320, 480.0, (jumpBarHeightLandscape + 49.0))];
                jumpBarContainerLandscape.backgroundColor = [UIColor scrollViewTexturedBackgroundColor];

                // add jumpbar container to view
                [self.view insertSubview:jumpBarContainerLandscape belowSubview:actionTabBar];

                [UIView animateWithDuration:0.6
                                      delay:0.0f
                                    options:UIViewAnimationCurveEaseIn 
                                 animations:^{

                                     jumpBarContainerLandscape.frame = CGRectMake(0.0, (207 - jumpBarHeightLandscape), 480.0,  (jumpBarHeightLandscape + 49.0)); // display jumpBar

                                 } completion:^(BOOL finished) {
                                     if (finished) {
                                         NSLog(@"YAY!");
                                     }
                                 }];
            }
            else if ([jumpBarContainerLandscape superview]) {
                // remove landscape view
                [UIView animateWithDuration:0.6
                                      delay:0.0f
                                    options:UIViewAnimationCurveEaseIn 
                                 animations:^{

                                     jumpBarContainerLandscape.frame = CGRectMake(0.0, 320, 480.0, (jumpBarHeightLandscape + 49.0)); // display jumpBar

                                     [actionTabBar setSelectedItem:nil];

                                 } completion:^(BOOL finished) {
                                     if (finished) {

                                         // remove subView for superView
                                         [jumpBarContainerLandscape removeFromSuperview];
                                     }
                                 }];
            }

        }
    }
    // if device rotated selected
    else if (changeView == 0) {
        if  ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationPortrait)
        {
            if([jumpBarContainerLandscape superview])
            {
            // Device is changing from landscape to protrait change views to fit
            // load landscape view
            jumpBarContainerPortrait = [[UIView alloc] initWithFrame:CGRectMake(0.0, (367 - jumpBarHeightPortrait), 320.0, (jumpBarHeightPortrait + 49.0))];
            jumpBarContainerPortrait.backgroundColor = [UIColor scrollViewTexturedBackgroundColor];
            jumpBarContainerPortrait.alpha = 1.0;

            // add jumpbar container to view

                [UIView transitionFromView:jumpBarContainerLandscape
                                    toView:jumpBarContainerPortrait
                                  duration:animationSpeed
                                   options:UIViewAnimationOptionTransitionCrossDissolve 
                                completion:NULL];

                [self.view insertSubview:jumpBarContainerPortrait belowSubview:actionTabBar];

            }
        }
        else if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeLeft || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeRight)
        {
            if ([jumpBarContainerPortrait superview])
            {
            // Device is changing from portrait to landscape change views to fit
            // load landscape view
            jumpBarContainerLandscape = [[UIView alloc] initWithFrame:CGRectMake(0.0, (207 - jumpBarHeightLandscape), 480.0,  (jumpBarHeightLandscape + 49.0))];
            jumpBarContainerLandscape.backgroundColor = [UIColor scrollViewTexturedBackgroundColor];
            jumpBarContainerLandscape.alpha = 1.0;

            // add jumpbar container to view

                [UIView transitionFromView:jumpBarContainerPortrait
                                    toView:jumpBarContainerLandscape
                                  duration:animationSpeed
                                   options:UIViewAnimationOptionTransitionCrossDissolve
                                completion:NULL];

                [self.view insertSubview:jumpBarContainerLandscape belowSubview:actionTabBar];

            }

        }
    }
} 
```

在这个例子中，我有两个视图横向和纵向，显然每个名称都是针对它们各自的方向.. 上面的逻辑遵循这个

```
if tabbarselected 

if !view visible
if device orientation portrait 
animate in portrait view.
if device orientation landscape
animate in landscape view

if view visible
if device orientation portrait
animate out portrait view
clear tabbar
if device orientation landscape
animate out landscape view
clear tabbar

if !tabbarselected //meaning listener has identified orientation of device has changed 

if device orientation portrait
unload portrait 
load landscape

if device orientation landscape
unload landscape
load portrait 
```

我想知道是否有比经历所有这些麻烦更简单的方法！我仍然相当缺乏经验，所以这是我最好的尝试.. 我希望那里的人知道一种更简单的方法，而不是必须做所有这些腿部工作才能将视图添加到其他视图中，因为子视图可​​以正确调整方向

任何帮助将不胜感激！我很绝望哈哈:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:52:12.197

请参阅[`autoresizingMask`文档](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/occ/instp/UIView/autoresizingMask)。为您提供与 Interface Builder 中相同的弹簧和支柱控制。例如：

```
CGRect frame = CGRectMake(margin, margin, self.view.frame.size.width - margin * 2, self.view.frame.size.height - margin * 2);
UIView *mySubview = [[UIView alloc] initWithFrame:frame];
[self.view mySubview];
mySubview.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

此外，如果您认为 autoresizingMask 还不够（例如，当您相对于彼此移动对象以真正微调纵向与横向方向时），我建议您在[`viewWillLayoutSubviews`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/viewWillLayoutSubviews)iOS5 中执行此布局过程，（或[`willAnimateRotationToInterfaceOrientation`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willAnimateRotationToInterfaceOrientation%3aduration%3a)在 iOS4 或更早版本中）。这样您就不需要自己为更改设置动画，并且动画将与屏幕旋转动画的其余部分一起完成。

# custom-fields - 显示自定义帖子类型及其字段的 Wordpress

> ID：11216787
> 
> 赞同：3
> 
> 时间：2012-06-26T22:24:33.377
> 
> 标签：custom-fields, custom-post-type, wordpress

我设置了一个名为“RELEASES”的自定义帖子类型 - 想想音乐 cd 版本。

此帖子类型具有名为“release_artist”、“release_title”、“release_date”、“release_artwork”和“release_tracklisting”的字段，用于输入所有相关的音乐 cd 信息。

我在我的 Wordpress 模板中实际显示这些信息时遇到了真正的麻烦。我真的很幸运地输出了标题列表，没有其他数据。

知道我在 LOOP 中放了什么来显示所有信息吗？最好每个都在自己的 LIST 项目中，这样我就可以单独设置每个项目的样式？

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T23:45:25.907

您可以根据需要使用[get_post_meta](http://codex.wordpress.org/Function_Reference/get_post_meta)拉入您的字段。在您的循环中，您可以从以下内容开始：

```
<?php 
    $release_artist = get_post_meta($post->ID, 'release_artist', true); 
    $release_title = get_post_meta($post->ID, 'release_title', true); 
?>

<ul>
    <li class="release_artist">
        <?php echo $release_artist; ?>
    </li>
    <li class="release_title">
        <?php echo $release_title; ?>
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T22:32:13.400

这些是自定义字段吗？如果是，请尝试[codex.wordpress.org](http://codex.wordpress.org/Custom_Fields)所说的内容。更好的是，试试[ACF 插件](http://wordpress.org/extend/plugins/advanced-custom-fields/)。

- 编辑

如果您想在其他页面上显示您的部分页面（例如在您的家中），您需要使用[query_posts](http://codex.wordpress.org/Function_Reference/query_posts)。这是一个相当简单的功能。对于您的循环，请尝试以下操作：

> ```
>  <?php
>         global $wp_query;
>         query_posts(array(
>             'post_type' => 'releases'
>         )); 
> ```

```
 while(have_posts()) : the_post(); ?>
            <?php $key = get_post_meta($post->ID, 'Opis nazwy'); ?>
            <li <?php post_class(); ?>><a href="<?php the_permalink(); ?>"><?php if($key) { echo $key[0]; } else { the_title(); }; ?></a></li>
            <?php
        endwhile;
        wp_reset_query();
        ?> 
```

`$key`是单个值，此处设置为`release_artists`. 这纯粹是为了测试。如果它有效 - 请随意定义您自己的变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-19T22:13:14.673

你应该使用：

```
<?php the_field('field_name') ?> 
```

在你的循环里面。希望能帮助到你！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-28T20:06:00.003

从我在网上看到的大多数文档来看，query_posts 不应该是创建自定义查询和循环的首选函数。以下代码片段可能是一个很好的起点。您应该能够在主题模板文件的主循环内部或外部使用它。

```
$args = array(
    'post_type' => 'release', //remember this is-case sensitive
    'posts_per_page' => -1,
);

$releaseQuery = new WP_Query( $args );

if ( $releaseQuery->have_posts() ) :
while ( $releaseQuery->have_posts() ) :
$releaseQuery->the_post();

// Fetching the post ID for demonstration and for use later
$c_id = get_the_ID();

// After running the_post(), alot of the Wordpress functions (not all) can now be used without supplying the post ID.    
echo get_the_title();
// You could also have used get_the_title($c_id);

// Then:
echo get_post_meta($c_id, 'release_title', true); 
echo get_post_meta($c_id, 'release_artist', true); 

endwhile;
endif;

// Return to the current page's main query
wp_reset_query();

// This should now display the page's title
the_title(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-28T18:54:59.690

关于你的身份证问题：

每个项目，如 WordPress 中的帖子和页面都有一个“ID”，但它们通常不会显示在它们的列表中。有许多插件会在您的管理员中添加“ID”列。在 Wordpress.org 中搜索“显示 ID”并选择一个您喜欢的。安装它。激活它。你会看到ID。

[https://wordpress.org/plugins/search.php?q=show+id](https://wordpress.org/plugins/search.php?q=show+id)

# solr - 换行符 & 和 word 和在搜索中

> ID：11216790
> 
> 赞同：1
> 
> 时间：2012-06-26T22:25:03.177
> 
> 标签：solr

可以“&” 在进行完全匹配“mac & cheese”时，“and”和“and”可以像同义词一样互换使用

所以例如

如果我要搜索 mac & cheese，它匹配

通心粉和奶酪 mac-n-cheese 通心粉和奶酪

如果在我进行完全匹配 q="mac & cheese" 时会这样做，那就太好了。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T07:45:52.337

我猜一个[solr.SynonymFilterFactory](https://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.SynonymFilterFactory)会为你工作：

& => 和

当然，您必须确保您使用的标记器等在到达同义词过滤器之前保留 &

# android - View.OnKeyListener 为我的活动工作过一次，不再工作

> ID：11216793
> 
> 赞同：1
> 
> 时间：2012-06-26T22:25:30.787
> 
> 标签：android

我有一个实现的活动，`View.OnKeyListener`以便它可以捕捉用户点击后退按钮并弹出一个对话框。以前，它工作得很好。然而，最近它已经停止工作，并且该应用程序只会假装没有`onKey`方法可以捕捉“后退”按钮。我似乎无法弄清楚为什么，因为`onKey`自从我做出改变以来我几乎没有接触过这个方法。我尝试只使用`OnBackPressed()`，但这并没有解决任何问题，实际上产生了奇怪和不可预测的行为。谁能帮我弄清楚为什么我的应用程序似乎让系统在后退按钮上占据主导地位？

这是我实现的重要部分：

```
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuItem;
import com.actionbarsherlock.view.MenuInflater;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.view.KeyEvent;
import android.view.View;

public class NagTasksAddTasksActivity extends SherlockFragmentActivity implements View.OnKeyListener {
    //various parameters
    public void onCreate(Bundle savedInstanceBundle)
    {
        super.onCreate(savedInstanceBundle);
        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
        String setTheme = prefs.getString("themeselect", "Dark Overflow");
        if (setTheme.toLowerCase().contentEquals("dark overflow")){
            setTheme(R.style.Theme_Sherlock_ForceOverflow);
        } else if (setTheme.toLowerCase().contentEquals("light overflow")){
            setTheme(R.style.Theme_Sherlock_Light_ForceOverflow);
            isDarkThemeUsed = false;
        } else if (setTheme.toLowerCase().contentEquals("dark menu")){
            setTheme(R.style.Theme_Sherlock);
        } else if (setTheme.toLowerCase().contentEquals("light menu")){
            setTheme(R.style.Theme_Sherlock_Light);
            isDarkThemeUsed = false;
        }
        setContentView(R.layout.createtasklayout);
        ActionBar actionBar = getSupportActionBar();
        setTitle(R.string.newTask);

    }
    ...
    @Override
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK)
        {
            AlertDialog.Builder builder = new AlertDialog.Builder(this);
            builder.setCancelable(true);
            builder.setTitle(R.string.wait);
            builder.setMessage(R.string.confirmbackkey);
            builder.setPositiveButton(R.string.save, new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    //stuff
                    dialog.dismiss();
                }
            });
            builder.setNegativeButton(R.string.discard, new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    AlertDialog.Builder subBuilder = new AlertDialog.Builder(getParent());
                    subBuilder.setCancelable(true);
                    subBuilder.setTitle(R.string.wait);
                    subBuilder.setMessage(R.string.confirmdiscard);
                    subBuilder.setPositiveButton(R.string.yes, new DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            //more stuff
                            dialog.dismiss();
                        }
                    });
                    subBuilder.setNegativeButton(R.string.no, new DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            dialog.cancel();
                        }
                    });
                    dialog.dismiss();
                    subBuilder.create().show();
                }
            });
            builder.setNeutralButton(R.string.cancel, new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    dialog.cancel();
                }
            });
            builder.create().show();
            return true;
        }
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T01:08:54.523

另一种捕捉返回按钮的方法是在Activity中使用dispatchKeyEvent方法（不需要实现View.OnKeyListener）。这似乎每次都对我有用。

```
public class HomeActivity extends Activity
{
...

    @Override
    public boolean dispatchKeyEvent(KeyEvent event) 
    {
        int action = event.getAction();
        int keyCode = event.getKeyCode();
        switch (keyCode) 
        {
            case KeyEvent.KEYCODE_BACK:
                if (action == KeyEvent.ACTION_DOWN)
                {
                    Log.v("myApp", "Back button pressed.");
                    return true;
                }
            default:
                return false;
        }
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:40:53.067

尝试移除`return true`下面`builder.create().show();`并更改`return false`为`return true`，看看它是否有效。这应该让它们在初始化 KeyEvent 时都返回结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T23:56:39.073

最简单的方法是覆盖 OnBackPressed 并填写您希望在有人按下后退按钮时发生的代码。

只需确保删除 super.OnBackPressed 行。

# java - Java 肥皂服务的 WCF 代理类

> ID：11216800
> 
> 赞同：0
> 
> 时间：2012-06-26T22:26:22.413
> 
> 标签：java, wcf, soap, svcutil.exe

我想创建基于 WSDL 的 .net WCF 代理类，它描述了 java soap 服务。当我尝试生成类时，出现以下错误

```
Error: Cannot import wsdl:port
Detail: There was an error importing a wsdl:binding that the wsdl:port is depend
ent on.
XPath to wsdl:binding: //wsdl:definitions[@targetNamespace='mywsdl.wsdl']/wsdl:binding[@name='SomethingSoap12
']
XPath to Error Source: //wsdl:definitions[@targetNamespace='mywsdl.wsdl']/wsdl:service[@name='test']/wsdl:port[@name='SomethingSoap12'] 
```

svcutil 生成 .CS 文件，但是当我调用服务并查看 SOAP 消息时，它与服务期望的不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:56:57.087

我们通过使用 WSDL 的在线版本而不是转储版本的 WSDL 和 xsds 运行 svcutil.exe 解决了这个问题

# python - 我制作了一个 Pygame 程序，但是当精灵重叠时，其中一些有白色轮廓

> ID：11216803
> 
> 赞同：1
> 
> 时间：2012-06-26T22:26:42.283
> 
> 标签：python, sprite, pygame

我正在为我正在开发的游戏制作关卡编辑器。我进行了设置，以便您可以将图片放入文件夹中，它会将其从 90x90 像素块拆分为可在编辑器中使用的 9 个 30x30 像素块。制作 30x30 块的代码如下所示：

```
 one = Image.new('RGBA',(30,30),(255,255,255,0))
    two = Image.new('RGBA',(30,30),(255,255,255,0))
    three = Image.new('RGBA',(30,30),(255,255,2550,0))
    four = Image.new('RGBA',(30,30),(255,255,255,0))
    five = Image.new('RGBA',(30,30),(255,255,255,0))
    six = Image.new('RGBA',(30,30),(255,255,2550,0))
    seven = Image.new('RGBA',(30,30),(255,255,2550,0))
    eight = Image.new('RGBA',(30,30),(255,255,255,0))
    nine = Image.new('RGBA',(30,30),(255,255,255,0))

    for y in range(1,iy):
        print ((y/9)*10),"%"
        for x in range(1,ix):
            pixel = im.getpixel((x,y))
            if y<30:
                if x<30:
                    one.putpixel((x,y),pixel)
                elif x<60:
                    four.putpixel((x-30,y),pixel)
                else:
                    seven.putpixel((x-60,y),pixel)
            elif y <60:
                if x <30:
                    two.putpixel((x,y-30),pixel)
                elif x <60:
                    five.putpixel((x-30,y-30),pixel)
                else:
                    eight.putpixel((x-60,y-30),pixel)
            else:
                if x < 30:
                    three.putpixel((x,y-60),pixel)
                elif x < 60:
                    six.putpixel((x-30,y-60),pixel)
                else:
                    nine.putpixel((x-60,y-60),pixel)
    add = [im,one,two,three,four,five,six,seven,eight,nine]
    bdict[s]= add
    cd = os.getcwd()+'\\'+s +'\\'
    one.save(cd + s +'one.png')
    two.save(cd+s+'two.png')
    three.save(cd+s+'three.png')
    four.save(cd+s+'four.png')
    five.save(cd+s+'five.png')
    six.save(cd+s+'six.png')
    seven.save(cd+s+'seven.png')
    eight.save(cd+s+'eight.png')
    nine.save(cd+s+'nine.png')
    im.save(cd + fol)
    im = os.getcwd()+'\\'+fol
    one = os.getcwd()+'\\'+s+'one.png'
    two =os.getcwd()+'\\'+s+'two.png'
    three =os.getcwd()+'\\'+s+'three.png'
    four = os.getcwd()+'\\'+s+'four.png'
    five =os.getcwd()+'\\'+s+'five.png'
    six =os.getcwd()+'\\'+s+'six.png'
    seven =os.getcwd()+'\\'+s+'seven.png'
    eight =os.getcwd()+'\\'+s+'eight.png'
    nine =os.getcwd()+'\\'+s+'nine.png'
    add = [im,one,two,three,four,five,six,seven,eight,nine]           
    bdict[s]= add
    maxes[0]+=1 
```

当两个块重叠时，它们会出现这个奇怪的白条，它只出现在左上方和右上方的方块和左下方和右下方的方块周围。看起来像这样： ![重叠误差](../Images/77b05034f15cc828d8f9a50b1eee9b6b.png)

唯一可能有错误的地方是代码加载精灵的地方，这里：grounds 是一个包含不同矩形的数组，而 gsprites 是一个数组，包含不同 sprite 的格式，它们由 Pygame 加载。

```
for number in range(0,len(grounds)):
    cr = grounds[number]
    cr.left += xscroll
    cr.top += yscroll
    pygame.draw.rect(windowsurface,clear,cr)
    change = pygame.transform.scale(gsprites[number],(30,30))
    windowsurface.blit(gsprites[number],cr)
    cr.left -= xscroll
    cr.top -= yscroll 
```

我正在运行 windows vista 32 位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T23:37:07.750

没关系，我想通了。在对精灵进行 blitting 之前，我正在绘制一个矩形，它最终出现在精灵下方。

# wcf - PhoneGap 与 WCF 休息服务

> ID：11216804
> 
> 赞同：0
> 
> 时间：2012-06-26T22:26:48.743
> 
> 标签：wcf, jquery, cordova, wcf-rest

所以我开始使用 PhoneGap/Cordova（Windows 手机）和 WCF 休息服务，但是，我在让模拟器与 WCF 服务交互时遇到问题。

起初我在想可能是模拟器无法连接到本地 WCF 服务，所以我在外部主机上发布了 WCF 服务，但是问题仍然存在……即仍然无法调用 WCF 服务。

我的代码如下所示：

PhoneGap 应用程序的 javascript 文件如下：

```
function getAjax() {
var jqxhr = $.ajax({
    url: 'http://link.to.service.com/service1/',
    //headers:
    beforeSend: function (xhr) {
        //xhr.overrideMimeType('text/plain; charset=x-user-defined');
    },
    dataType: 'json'
})
.done(function (data) {
    var element = document.getElementById('ajaxCall');
    element.innerHTML = JSON.stringify(data, null, "\t");
})
 .fail(function (xhr, status, error) {
     showError(error);
 })
 .always(function () { showAlert("complete"); }); 
```

}

然后 WCF 服务包含以下方法：

```
 [WebGet(UriTemplate = "")]
    public List<SampleItem> GetCollection()
    {
        return new List<SampleItem>()
                   {
                       new SampleItem()
                       {
                           Id = 1,
                           StringValue = "Hello" }
                   };
    } 
```

因此，当对 javascript 方法“getAjax”的调用完成时，应该调用 WCF 服务方法，但是它会继续进入失败函数，而不是显示错误消息“未定义”。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:34:19.587

经过进一步调查，已使用以下行解决了此问题：

jQuery.support.cors = true;

对于那些有同样问题的人来说，这只是来自 jQuery 库的一小段引用，这就是上面的行所做的：

> 如果浏览器可以创建 XMLHttpRequest 对象并且该 XMLHttpRequest 对象具有 withCredentials 属性，则 cors 等于 true。要在尚不支持 cors 但允许跨域 XHR 请求（windows gadget 等）的环境中启用跨域请求，请设置 $.support.cors = true;。CORS WD

# windows-phone-7 - 故事板更改目标控制

> ID：11216812
> 
> 赞同：0
> 
> 时间：2012-06-26T22:27:21.447
> 
> 标签：windows-phone-7, storyboard

我通过 Expression Blend 创建了一个故事板。Storyboard 现在将 Ellipse 动画化为一种占位符。现在我回到了 Visual Studio，我怎样才能让 Storyboard 做完全相同的事情，但使用不同的控件？我有一个图像列表：

```
private List<Image> items = new List<Image>(); 
```

使用 Name 属性为 items 中的每个对象分配了一个名称：

```
 items[i].Name = i.ToString(); 
```

在这种情况下，“i”是计数器。

因此，我目前如何使 Storyboard 以列表中的“一个”特定对象为目标。稍后，我将尝试让 Storyboard 对它们都做同样的事情。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T15:14:55.277

我通过设置 Storyboard Completed 事件并使用以下方法更改目标来解决问题：

```
Storyboard.SetTargetName(); 
```

# database - 产品和不同类型的产品

> ID：11216814
> 
> 赞同：0
> 
> 时间：2012-06-26T22:27:40.720
> 
> 标签：database, database-design

我将如何在数据库中绘制此设计？

*   产品可以是实体的、数字的或服务。

*   数字产品是一种产品。

*   实物产品就是产品。

*   服务是一种产品。

是否建议使用不同的唯一标识符而不仅仅是自动递增的 id？`id`也许是和其他标识符的哈希？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:33:32.090

自动递增的 id 可以正常工作。我会推荐一个单独的类型表，以防您将来想添加更多。

```
Product
id  type_id  name
1   2        candy
2   2        car
3   3        yard work

Type
id  name
1   digital
2   physical
3   service 
```

# jquery - 获取网格的过滤器参数

> ID：11216815
> 
> 赞同：0
> 
> 时间：2012-06-26T22:27:43.550
> 
> 标签：jquery, jqgrid

我正在使用 jQGrid，我想知道是否有办法获取已应用于我正在查看的网格的当前过滤器。例如，如果网格已按特定列（asc 或 desc）排序，则可能已应用的搜索参数等。

这是我的问题：我想将一些参数传递回我正在查看的上一个网格（或最后一页），以便我可以看到前一个网格，就像我向前导航时一样。基本上，我有一个链接，用户将单击该链接导航回他们正在查看的上一个网格的页面。我想将过滤器参数与该链接一起传递。

**整体示例：**

1.  `client_name`我按字段`asc`顺序过滤了客户端网格。
2.  然后我单击了一个链接，该链接将我带到一个带有新网格的单独页面。
3.  我想导航回我之前所在的客户端网格，看到我的网格`client_name`按顺序过滤，`asc`就像我第一次导航离开时一样。

目前，我可以导航回客户端网格，但我想获取已应用的过滤器参数，以便我可以将它们与我的链接一起传递回去。

让我知道我是否足够具体！

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T05:55:18.587

我建议阅读[答案](https://stackoverflow.com/a/8436273/315935)和[这个](https://stackoverflow.com/a/8547852/315935)。答案显示了如何通过使用来解决非常接近的问题`window.localStorage`。定义状态的 jqGrid 最重要的选项是：`sortname`，`sortorder`用于排序，`search`和`postData`（主要`postData.filters`）用于过滤，`page`用于分页。此外，如果您使用[columnChooser](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:jquery_ui_methods#column_chooser) ，则需要使用 jqGrid`remapColumns`选项。您可以另外考虑有关当前选定行/行的信息（`selrow`或`selarrrow`）。因此，您需要保存或恢复的参数的确切列表取决于您的要求。

# codeigniter - CodeIgniter - 无法删除特定缓存

> ID：11216816
> 
> 赞同：1
> 
> 时间：2012-06-26T22:27:43.353
> 
> 标签：codeigniter

我有这个模型：

```
public function Vote($data) {
    $gameid = $this->input->post('gameid');
    $userid = $this->input->post('userid');
    $rate = $this->input->post('rate');

    $ins = array(
        'user_id' => $userid,
        'game_id' => $gameid,
        'rate' => $rate
    );

    $q = $this->db->insert('rates', $ins);

    $this->db->cache_delete('games',$gameid);
} 
```

它插入数据，然后它**应该**清除缓存。但它不是——它什么也没做。当我使用`cache_delete_all`它时。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:58:45.090

问题解决了，但并非没有在黑暗中拍摄；）我的问题是数据库的配置。在`config/database.php`我有`$db['default']['cachedir'] = 'dbcache';`. 最后添加斜线有帮助！

不过，您必须记住将缓存目录放在根目录中。将它放在例如`application`文件夹中也会提供像我这样的错误。

# mysql - 使用数组过滤

> ID：11216817
> 
> 赞同：0
> 
> 时间：2012-06-26T22:27:53.567
> 
> 标签：mysql

我知道您可以使用 id IN ($array) 从数组中搜索 id，例如

```
$ids = join(',',$galleries);  
$sql = "SELECT * FROM galleries WHERE id IN ($ids)"; 
```

这可以反向完成，因此表中存储了一列 id，并且您将单个 id 作为 where 子句中的条件传递给它？

# php - PDO UPDATE 创建一条新记录而不是更新一条

> ID：11216818
> 
> 赞同：3
> 
> 时间：2012-06-26T22:27:56.930
> 
> 标签：php, database, pdo

我正在使用以下代码来更新记录。不好的是它不是在更新记录，而是在添加新记录。

我究竟做错了什么？我希望它更新记录而不是现在创建一个。

我的修改网址如下所示：[http ://randomsite.com/modify.php?id=1](http://randomsite.com/modify.php?id=1)

**修改.php代码：**

```
<?php
    require_once("connect.php");

    $query = "SELECT * FROM cars WHERE id = :id";

    $result = $odb->prepare($query);
    $result->execute(array(':id' => $_REQUEST['id']) );

    while  ($row = $result->fetch(PDO::FETCH_ASSOC)) { ?>

    <h1>Modify a car</h1>
    <form  action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
    Brand:      <input type="text" name="brand" value="<?php echo $row['brand']; ?>"  /><br />
    Model:      <input type="text" name="model" value="<?php echo $row['model']; ?>"  /><br />
    Year:       <input type="text" name="year"  value="<?php echo $row['year'];  ?>"   /><br />
    ID:     <input type="text" name="id"  value="<?php echo $row['id'];  }?>"   /><br />
    <input type="submit" value="Modify" />
    </form>

    <?php

    if(isset($_POST['submit'])) {
    $id    = $_POST['id'];
    $brand = $_POST['brand'];
    $model = $_POST['model'];
    $year  = $_POST['year'];
    $q     = "UPDATE cars WHERE id = $_GET[id] (id, brand, model, year) VALUES(:id, :brand, :model, :year)";
    $query = $odb->prepare($q);
    $results = $query->execute(array(
            ":id"    => $id,
            ":brand" => $brand,
            ":model" => $model,
            ":year"  => $year,
    )); 
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T23:10:31.473

您的 SQL 应该看起来更像这样：

```
 $q = "UPDATE cars SET 
          id = :id, 
          brand = :brand, 
          model = :model, 
          year = :year 
          WHERE id = :oldid";

    $query = $odb->prepare($q);
    $results = $query->execute(array(
            ":id"    => $id,
            ":brand" => $brand,
            ":model" => $model,
            ":year"  => $year,
            ":oldid" => $_GET['id'],
    )); 
```

附带说明一下，尽量不要在 SQL 中放入变量（例如 $_GET['id']），使用 PDO 的部分想法是避免这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:39:27.540

让它工作！

工作代码：

```
<?php
    require_once("connect.php");

    $query = "SELECT * FROM cars WHERE id = :id";

    $result = $dbh->prepare($query);
    $result->execute(array(':id' => $_REQUEST['id']) );

    while  ($row = $result->fetch(PDO::FETCH_ASSOC)) { ?>

    <h1>Modify a car</h1>
    <form  action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
    Brand:      <input type="text" name="brand" value="<?php echo $row['brand']; ?>"  /><br />
    Model:      <input type="text" name="model" value="<?php echo $row['model']; ?>"  /><br />
    Year:       <input type="text" name="year"  value="<?php echo $row['year'];  ?>"   /><br />
    ID:         <input type="text" name="id"    value="<?php echo $row['id'];  }?>"   /><br />
    <input type="submit" value="Modify" name="submit"/>
    </form>

    <?php

    if(isset($_POST['submit'])) {
    $brand = $_POST['brand'];
    $model = $_POST['model'];
    $year  = $_POST['year'];
    $id    = $_POST['id'];

    $queryupdate = "UPDATE cars SET 
          brand= :brand, model= :model, year= :year WHERE id= :id";
    $q = $dbh->prepare($queryupdate);
    $q->execute(array(
            ":id"    => $id,
            ":brand" => $brand,
            ":model" => $model,
            ":year"  => $year));

            //Send them back to the page they were at/
header("location:admin.php");
    }

?> 
```

# c# - 如何在 azure 中设置无限共享访问签名策略？

> ID：11216819
> 
> 赞同：3
> 
> 时间：2012-06-26T22:27:57.773
> 
> 标签：c#, windows, azure, azure-storage

我正在尝试设置共享访问策略，以便用户拥有无限的 SharedAccessExpiryTime。我将跟踪他们的访问策略，以便在需要时可以撤销它们。

从[这个线程](https://stackoverflow.com/questions/10135133/how-do-you-setup-shared-access-signature-with-more-than-1-year-expiration-at-azu)，答案表明有一种设置无限到期时间的机制。我做了一些搜索，但找不到这个，怎么办？

目前，我通过为过期时间提供一些较大的值来模拟无限：

```
 SharedAccessTablePolicy policy = new SharedAccessTablePolicy()
        {
            SharedAccessExpiryTime = DateTime.UtcNow.AddYears(500),

            Permissions = SharedAccessTablePermissions.Add
            | SharedAccessTablePermissions.Delete
            | SharedAccessTablePermissions.Update
            | SharedAccessTablePermissions.Query
        }; 
```

# asp.net - 将 ASP.MVC3 网站部署到 IIS6 后出现 404 错误

> ID：11216821
> 
> 赞同：-1
> 
> 时间：2012-06-26T22:28:10.943
> 
> 标签：asp.net, asp.net-mvc-3, iis-6

> **可能重复：**
> [在 IIS 6 中设置 MVC 并使用 .NET 4 beta 2 时获取 404](https://stackoverflow.com/questions/2222999/getting-a-404-when-setting-up-mvc-in-iis-6-and-using-net-4-beta-2)

我已将 ASP.NET MVC3 站点部署到 IIS6。我重新安装了 .net 4 并在该服务器上安装了 asp.net mvc3。还添加了通配符映射 c:\windows\microsoft.net\framework64\v4.0.30319\aspnet_isapi.dll

我的网站使用活动目录使用 Windows 身份验证。

我不确定是什么导致了这个问题。我几乎尝试了网上建议的所有内容。但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:01:13.493

尝试遵循本指南，MVC 在 IIS6 上可能有点棘手。
[http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)

此外，这篇文章可能有你想要的。 [在 IIS 6 上使用 .NET 4 时获得 404，无论是否使用 MVC](https://stackoverflow.com/questions/2222999/getting-a-404-when-setting-up-mvc-in-iis-6-and-using-net-4-beta-2)

# php - 为什么准备好的语句可以防止注入？

> ID：11216823
> 
> 赞同：0
> 
> 时间：2012-06-26T22:28:11.830
> 
> 标签：php, mysql, sql-injection

我已经对准备好的语句有了基本的了解，并且我知道它们可以防止 SQL 注入攻击。但我还没有理解为什么他们可以防止上述攻击。我知道有人问过类似的问题，但我没有找到完全令人满意的答案。

示例 - 非常不安全的代码
所以这里我们有与我们的数据库通信的最基本方式：

```
$query = "SELECT * FROM users where id=$username"; 
```

在没有任何保护的情况下，用户可以输入恶意代码，从而“欺骗”数据库引擎执行破坏性查询：

```
$username = "1; DROP TABLE users;"
SELECT * FROM users where id=1; DROP TABLE users; 
```

我不明白的是准备好的语句如何设法“过滤掉”这些数据。它背后的机制是什么不会诱使数据库生成如上所示的 SQL 查询？就像转义某些字符一样简单，例如上面示例中的分号，还是更复杂？

如果我要像示例中那样进行精确的注入攻击，但通过准备好的语句运行它，什么样的命令字符串会到达数据库引擎？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:31:54.247

准备好的语句不只是添加文本，它们将其作为数据发送，并让数据库单独处理。因为实际上数据库实际上并不使用 SQL 语句，而是使用它们的“编译”版本。

不太确定我是否清楚，但这在于查询是如何发送到数据库的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:30:19.017

准备好的语句通常被构建为使用参数绑定。真正隔离此类攻击的是参数绑定。您可以使用参数绑定而不使用准备好的语句。

准备好的语句提供的第二级保护是每个语句都是一个语句（因此使用`;`来创建两个语句是行不通的）。

作为一般规则，为了免受注入攻击，准备好的语句必须从非来自任何外部输入的数据中准备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T22:32:19.970

基本上，如果你使用标准的无类型参数绑定，你会得到

```
SELECT * FROM users where id='1; DROP TABLE users;' 
```

这将在数​​据库上出错，但不会造成伤害。

请理解，这与跑步不同

```
SELECT * FROM users where id='$username' 
```

使用适当的转义`$username`- 它发生在数据库访问堆栈的较低层。

# wpf - 如何获取资源中元素的引用，WPF？

> ID：11216826
> 
> 赞同：0
> 
> 时间：2012-06-26T22:28:27.737
> 
> 标签：wpf, reference, resources, element

我对 WPF 有疑问 - 我对这项智能技术很陌生。所以问题是：

我有一个窗户。在这个窗口的资源中，我存储了一个元素 - 例如。具有唯一键的网格（假设 x:Key="myGrid"）。在这个网格中，我有一个由名称 (x:Name="myTextBox") 标识的文本框。我的窗口只包含一个空网格（例如名为 winGrid）。我以编程方式将 myGrid 设置为 winGrid 的子项。现在，在运行时，我想获得对 myTextBox 对象的引用。我花了很多时间在谷歌上搜索，但对我没有任何帮助（FindName 和类似方法）。

你有什么想法吗，我必须做些什么才能让球滚动？

这是（伪）代码片段：

```
<Window x:Class="LoginForm.RidicWindow"
    ...>
<Window.Resources>
    <Grid x:Key="myGrid">
        <Border...
        <Grid...
            ...
            <TextBlock x:Name="myTextBlock" Grid.Column="0".../>
         </Grid>
    </Grid>
 </Window.Resources>
 <Grid x:Name="winGrid">
     ...
 </Grid> 
```

现在我将 myGrid 设置为 winGrid 的子项：（类似于）

```
winGrid.Childrens.Clear();
winGrid.Childrens.Add((Grid)FindResource(myGrid)); 
```

现在我想获得对 myTextBlock 的引用，它是 myGrid 的后代。

我尝试了类似的东西

```
((Grid)FindResource(myGrid)).FindByName("myTextBlock"); 
```

这当然行不通。

希望你能理解我，我想要得到什么。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:57:13.727

你不能这样做（顺便说一句，你可以，但它真的很糟糕，丑陋，不推荐）一个窗口的资源用于另一个目的。

如前所述，您必须创建一个组件（用户控件或其他）。尽管您所寻求的还有一些其他选项。您可以尝试我在下面写的一些内容：

* * *

**1)**创建自定义组件可能是 UserControl、Grid 或其他任何东西...

```
 <Grid x:Class="Project.MyGridControl"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                 mc:Ignorable="d" 
                 d:DesignHeight="300" d:DesignWidth="300">
<!-- Content -->
    </Grid> 
```

和

```
 MyGridControl control = new MyGridControl();
        winGrid.Childrens.Add(control); 
```

* * *

**2）**稍微复杂一点：

```
<Grid  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!-- Content -->
</Grid> 
```

和

```
Grid myCustomGrid = XamlReader.Load(uriResource) as Grid;
winGrid.Childrens.Add(myCustomGrid); 
```

在此选项中，您将无需实例化网格控件。（我看到它经常在报告中使用）。您应该创建一个 .xaml 并将其定义为资源。

* * *

要查找组件，您应该查看可视化树（如已响应）...

（[如何按名称或类型查找 WPF 控件？](https://stackoverflow.com/questions/636383/wpf-ways-to-find-controls)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T23:55:30.303

小绵羊的评论提供了一个良好的开端，尽管我建议创建一个 UserControl，然后通过控件上的属性公开 TextBox 以简化操作。

但是，如果您的设计要求您使用上面概述的方法，您将需要使用 VisualTreeHelper，特别是 GetChild() 方法来导航 VisualTree 以在网格中查找 TextBox。我已经使用下面的方法在可视化树中查找项目，它可能会为您解决问题。

```
 /// <summary>
    /// Will navigate down the VisualTree to find an element that is of the provided type.
    /// </summary>
    /// <typeparam name="T">The type of object to search for</typeparam>
    /// <param name="element">The element to start searching at</param>
    /// <returns>The found child or null if not found</returns>
    public static T GetVisualChild<T>(DependencyObject element) where T : DependencyObject
    {
        T child = default(T);
        int childrenCount = VisualTreeHelper.GetChildrenCount(element);

        for (int i = 0; i < childrenCount; i++) 
        {
            DependencyObject obj = VisualTreeHelper.GetChild(element, i);
            if (obj is T)
            {
                child = (T)obj;
                break;
            }
            else
            {
                child = GetVisualChild<T>(obj);
                if (child != null)
                    break;
            }
        }

        return child;
    } 
```

只需调用 GetVisualChild(myGrid)，它就会返回它在 myGrid 中出现的第一个 TextBox。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T08:06:49.357

如果您只想在整个应用程序的任何层次结构中查找资源，那么试试这个...

```
 var myResource = Application.Current.FindResource("MyResource"); 
```

# php - 没有结果的具体5错误

> ID：11216828
> 
> 赞同：0
> 
> 时间：2012-06-26T22:28:44.753
> 
> 标签：php, concrete5

我正在使用混凝土来渲染我的网站，它使用以下错误系统；

```
if (isset($error) && $error != '') {
    if ($error instanceof Exception) {
        $_error[] = $error->getMessage();
    } else if ($error instanceof ValidationErrorHelper) { 
        $_error = $error->getList();
    } else if (is_array($error)) {
        $_error = $error;
    } else if (is_string($error)) {
        $_error[] = $error;
    }
    ?>
    <?php  if ($format == 'block') { ?>
    <div class="alert-message error">
    <?php  foreach($_error as $e): ?>
        <?php  echo $e?><br/>
    <?php  endforeach; ?>
    </div>

    <?php  } else { ?>

    <ul class="ccm-error">
    <?php  foreach($_error as $e): ?>
        <li><?php  echo $e?></li>
    <?php  endforeach; ?>
    </ul>
    <?php  } ?>

<?php  } ?> 
```

这用于检测系统中的错误或验证错误。

我的问题是正在显示错误 div 但没有错误，例如：

![错误 DIV](../Images/57728298ef4977ce626d45dc84e87532.png)

我已经尝试转储变量，这是结果（在这种情况下）：

```
Array    object(ValidationErrorHelper)#89 (1) { ["error:protected"]=> array(0) { } } 
```

这是 ValidationErrorHelper 系统：

```
<?php
    defined('C5_EXECUTE') or die("Access Denied.");
    class ValidationErrorHelper {

        protected $error = array();

        public function reset() {
            $this->error = array();
        }

        public function add($e) {
            if ($e instanceof ValidationErrorHelper) {
                $this->error = array_merge($e->getList(), $this->error);            
            } else if (is_object($e) && ($e instanceof Exception)) {
                $this->error[] = $e->getMessage();
            } else {
                $this->error[] = $e;
            }
        }

        public function getList() {
            return $this->error;
        }

        public function has() {
            return (count($this->error) > 0);
        }

        public function output() {
            if ($this->has()) {
                print '<ul class="ccm-error">';
                foreach($this->getList() as $error) {
                    print '<li>' . $error . '</li>';
                }
                print '</ul>';
            }
        }
    }

?> 
```

有什么办法可以去掉这个吗？或诊断它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:18:05.150

有时错误对象已设置，但其中没有任何错误。如果您查看最上面的“if”语句，您会看到：

```
if (isset($error) && $error != '') { 
```

所以发生的事情是 $error 变量是一个对象或数组，并且已由系统设置，但它没有任何错误。但是，只要设置了 $error 变量（或者不是空字符串），您的代码就会始终输出容器 <div> 。您需要做的是对 $_error 变量（在前十几行代码中创建的变量）添加额外的检查，以查看它是否为空。

尝试这个：

```
if (isset($error) && $error != '') {
    if ($error instanceof Exception) {
        $_error[] = $error->getMessage();
    } else if ($error instanceof ValidationErrorHelper) { 
        $_error = $error->getList();
    } else if (is_array($error)) {
        $_error = $error;
    } else if (is_string($error)) {
        $_error[] = $error;
    }

    if (!empty($_error)) {
        if ($format == 'block') { ?>
            <div class="alert-message error">
            <?php  foreach($_error as $e): ?>
                <?php  echo $e?><br/>
            <?php  endforeach; ?>
            </div>
        <?php  } else { ?>
            <ul class="ccm-error">
            <?php  foreach($_error as $e): ?>
                <li><?php  echo $e?></li>
            <?php  endforeach; ?>
            </ul>
        <?php }
    }
} 
```

# django - Django目录结构？

> ID：11216829
> 
> 赞同：23
> 
> 时间：2012-06-26T22:28:54.077
> 
> 标签：django

我想实现一个特定于项目的简单排队服务。代码应该放在 Django 目录结构中的什么位置？

目前的结构是：

```
sound/
    __init__.py
    models.py
    tests.py
    views.py
    static 
```

[编辑] 我在问将我在上面的目录结构中创建的队列服务代码放在哪里。我应该创建一个新目录吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-06-27T08:55:11.793

常见结构

在 Django 1.4+

```
project_root/
   project_name/
       media/
       static/
           some_app/css/app.css  # overriding an app css file from project level
           css/
               project.css
       static_root/  # in production using the collectstatic command
       templates/some_app/foo.html  # overriding some_app at project level
                /admin/some_app/some_model/change_list.html
                # overriding admin changelist for some_app.models.some_model
       settings/
           __init__.py
           base.py    # settings common to all instances of the project
           dev.py
           staging.py
           test.py
           prod.py
       urls.py
   some_app/
       static/
           css/
               app.css
       templates/some_app/foo.html
       urls.py
       views.py
       models.py
   manage.py 
```

在 Django 1.3 及之前版本中

```
project_root/
   some_app/
       templates/some_app/foo.html
       static/
           css/
               app.css
       urls.py
       views.py
       models.py
   media/
   static/
       some_app/
           css/
               app.css  # overriding an app css file from project level
       css/
           project.css
   static_root/ (in production)
   templates/some_app/foo.html # overriding some_app at project level
            /admin/some_app/some_model/change_list.html
            # overriding admin changelist for some_app.models.some_model
   settings/
       __init__.py
       base.py    # settings common to all instances of the project
       dev.py
       staging.py
       test.py
       prod.py
   urls.py
   manage.py 
```

替代方法

```
project_root/
    .gitignore
    README.md
    docs/
    venv/
    src/
       main/
           media/
           static/
               some_app/css/app.css  # overriding an app css file from project level
               css/
                   project.css
           static_root/  # in production using the collectstatic command
           templates/some_app/foo.html  # overriding some_app at project level
                    /admin/some_app/some_model/change_list.html
                    # overriding admin changelist for some_app.models.some_model
           settings/
               __init__.py
               base.py
               dev.py
               staging.py
               test.py
               prod.py
           urls.py
       some_app/
           static/
               css/
                   app.css
           templates/some_app/foo.html
           urls.py
           views.py
           models.py
       manage.py
       wsgi.py 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T23:49:56.710

如果你需要使用数据库，你应该将数据模型添加到models.py。对于您的程序，我建议将其写入新的 python 文件（例如queuing.py）中，您可以在想要使用它的时间和地点导入这些文件。您也可以为此创建另一个 django 应用程序。

# imagemagick - ImageMagick 调整为抽象矩形

> ID：11216832
> 
> 赞同：0
> 
> 时间：2012-06-26T22:29:09.443
> 
> 标签：imagemagick

我得到了一个未知大小的图像。我想缩小它，使其适合640x480*或*480x640，同时保持纵横比。我希望图像缩小最小量（例如，结果应该是适合 640x480 或 480x640 的最大尺寸）。

例如，如果我有一个 800x800 的图像，它应该缩小到 480x480。如果我有一个 500x1000 的图像，它应该缩小到 320x640。同样，1000x500 应该变成 640x320。

我可以在一个命令中在 ImageMagick 中执行此操作吗？不应发生裁剪，并且应保留原始图像的纵横比。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:20:10.843

在不裁剪和保留纵横比的情况下调整图像大小很容易，但我认为您无法在单个命令中实现您的非此即彼。

从[几何规范文档](http://www.imagemagick.org/script/command-line-processing.php#geometry)中，将超大图像调整为 640x480 很容易：

```
convert input.png -resize 640x480> output.png 
```

这只会在必要时调整大小，不会裁剪，并且会保留纵横比。

根据您的输入图像，您可能可以使用区域运算符：

```
convert input.png -resize $((640*480))@ output.png 
```

但这只有在所有输入图像已经具有 4/3 或 3/4 的纵横比时才有效。

我认为你最好的选择是一个简短的 shell 脚本：

```
wider_than_tall=`identify -format %w/%h input.png`
if (( $wider_than_tall )); then
  convert input.png -resize 640x480> output.png
else
  convert input.png -resize 480x640> output.png
fi 
```

# jquery - jQuery 通过 ID 选择变量

> ID：11216834
> 
> 赞同：2
> 
> 时间：2012-06-26T22:29:14.027
> 
> 标签：jquery

我有一些创建一些跨度标签的代码，每个跨度都有自己的 ID

```
counter1
counter2
counter4 
```

通过它在数据库中的名称。现在我正试图达到其中之一的价值。所以，我尝试了这样的事情：

```
var id = // Any number that have a span.
var Counter = $("#counter" + id).val();
alert(Counter); 
```

但是，它只是显示“NaN”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:39:25.817

更改`.val()`为`.html()`访问 html 元素的 innerHtml。[选择API](http://api.jquery.com/val/)`.val()`中详述的 html 输入元素的值。

```
var id = // Any number that have a span.
var Counter = $("#counter" + id).html();
alert(Counter); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T22:39:28.857

您无法获得 a 的`val()`ue `<span>`。您必须使用`html()`或`text()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:42:03.340

嗯，试试：

```
var Counter = $("#counter" + id).html(); 
```

或者

```
var Counter = $("#counter" + id).text(); 
```

我不确定，但也许 span 没有“价值”属性。

# sql - SQL 模糊搜索和类似 Google 的改进

> ID：11216836
> 
> 赞同：5
> 
> 时间：2012-06-26T22:29:19.327
> 
> 标签：sql, tsql, freetext

有趣的挑战；我的客户在 SQL 数据库中输入了一些产品信息。*产品是俄罗斯著名作曲家拉赫玛尼诺夫*的一幅画。所以该名称在描述字段中。现在，只有少数搜索产品的客户确切知道如何拼写这个名称，但大多数时候拼写错误。除了拼写错误之外，还有很多国际客户只是把这个名字写得完全不同，比如*Rachmaninow*、*Rahmaninov*、*Рахманінаў*。

如果我将这些拼写错误或翻译中的任何一个放在谷歌中，它（几乎）总是知道如何更正它并将我直接重定向到正确的页面。

有谁知道我在产品搜索中获得这种魔力的可能性是什么？我可以使用一些 API 吗？一些我不知道的超级自由文本选项？或者 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:49:37.630

我们以相当成功的方式解决了一个类似的问题：通过电话提供的姓名搜索人（德语姓名）。

例如：非常常见的德国姓氏“Schmidt”、“Schmitt”、“Schmied”、“Schmid”、“Schmit”和“Schmiedt”在通过声音给出时几乎不可能分开。将其与“Sylvia”或“Silvia”或“Sylvya”的名字结合起来，并且呼叫者说“嗨，我是 Sylvia Schmidt，我忘记了我的客户号码”是不可能被快速找到的。

我们的解决方案是列出一个 synophones 列表，例如（在伪代码中，用于德语）：

```
{consonant}+ := {consonant}
ie := i
ii := i
dt* := t
y|j := i
{vocal}v := {vocal}f 
```

等等，你得到了漂移。现在我们将 Synophone 翻译的字符串与原始字符串一起存储，以使搜索成为可能。这真的很好用。

我知道 MySQL 有`Soundex()`英文字符串的功能。我希望 MSSQL 有类似的东西。

# java - 下载后写入和读取文件进行解析

> ID：11216838
> 
> 赞同：0
> 
> 时间：2012-06-26T22:29:33.613
> 
> 标签：java, android, xml, file

好的，我认为这会更简单，但我可能错了..我的解析器工作正常（直接与连接工作）所以我在 Android（又名 Java）上或使用输入/输出上写入和读取文件时遇到了一些基本问题流..问题是我不知道什么不起作用..我错过了任何许可？我在写入或读取文件时遗漏了什么？

这是代码：

```
 URL url = new URL(urlXml);

            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser sp = spf.newSAXParser();
            XMLReader reader = sp.getXMLReader();

            CustomXmlHandler handler = new CustomXmlHandler();
            reader.setContentHandler((ContentHandler) handler);

            String fileName = getFileName();
            File f = getFileStreamPath(fileName);

            if(!f.exists()) {
                FileOutputStream fos = openFileOutput(fileName, Context.MODE_PRIVATE);                  
                URLConnection conn = url.openConnection();
                conn.setConnectTimeout(5000);
                conn.setReadTimeout(10000);
                InputStream in = conn.getInputStream();             
                byte[] buffer = new byte[1024];
                int len = 0;
                while((len = in.read(buffer)) != -1) {
                    fos.write(buffer, 0, len);
                }
                fos.close();
                in.close();
            }
            FileInputStream fis = openFileInput(fileName);
            reader.parse(new InputSource(new InputStreamReader(fis)));
            fis.close();
            myObject = handler.getMyObject(); 
```

提前谢谢..我快疯了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T23:16:58.607

其实这段代码没问题。错误在其他地方。

我会将代码留给正在寻找类似内容的其他人！

如果我不应该告诉我，我会删除它。:)

# php - PhantomJS 不能通过浏览器在 PHP 中工作（但可以通过命令行，甚至通过命令行运行 PHP）

> ID：11216839
> 
> 赞同：6
> 
> 时间：2012-06-26T22:29:35.097
> 
> 标签：php, linux, phantomjs

我试图让 PhantomJS 通过 PHP 运行。

当我直接通过命令行运行 JavaScript 文件时，它工作正常。当我`php render_html.php`在命令行中运行时，它只运行一个 exec()，它工作正常。但是，当我尝试在浏览器中打开这个 php 文件时，它什么也没做。我什至没有得到任何回声。

我已经在 OS X 和我的 EC2 服务器上本地完成了所有这些测试，并且得到了相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:37:06.517

这可能是权限问题，请检查运行 Web 服务器的用户是否有权运行 phantomjs 可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-12T21:46:33.757

*（代表 OP 发布）。*

这似乎确实是一个权限问题。似乎 Apache 的处理方式可能与其他用户有所不同？即使标准权限允许任何用户访问 PhantomJS 应用程序，apache 仍然无法访问。

任何有类似问题的人都应该通读[这个问题和答案](https://stackoverflow.com/questions/6913403/running-command-line-application-from-php-as-specific-user)。

这是针对我的特定情况（在 Linux 服务器上）的稍微调整的解决方案。编辑您的 sudoers 文件 (/etc/sudoers) 以包含以下行：

```
apache ALL=NOPASSWD: /usr/bin/phantomjs 
```

我用 emacs 做到了这一点，（Cx Cq 启用只读文件的编辑）。我似乎对此没有任何问题，但我想建议使用名为 visudo 的东西来编辑 sudoers。Emacs 为我工作，但你应该查一下。

这给了 apache 用户对 PhantomJS 应用程序的显式访问权限，方法是给它 sudo 访问权限，仅限于 PhantomJS 应用程序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-09-30T15:18:45.757

我最近在 centos 7 环境中使用 phantomjs 并面临与 op 相同的问题。我尝试了在stackoverflow中找到的解决方案和方法，所以我不太确定哪种方法有效或哪些方法可以共同解决问题。我试过

1.  授予 phantomjs 二进制和目标 js 和包含目录的 777 权限（不起作用）
2.  visudo 并允许 apache 在没有密码的情况下使用 phantomjs（不起作用）
3.  将 apache 添加到 sys 组（不起作用）
4.  禁用 selinux 并重新启动 cent os 后禁用 selinux，phantomjs 开始在浏览器中工作。:D :D

# wcf - WCF 客户端应用程序与非 WCF (DataSnap) 服务器的持久连接

> ID：11216840
> 
> 赞同：3
> 
> 时间：2012-06-26T22:29:35.977
> 
> 标签：wcf, delphi, delphi-xe2, datasnap, persistent-connection

## 什么有效

我在 Delphi-XE2 中构建了一个 DataSnap *Web 服务*`TDSServer`，它使用和`TDSHTTPService`组件。客户端连接到服务器（*Web 服务*）并运行 DataSnap 服务器方法来检索数据。服务器`TDSLifeCycle.Session`用于所有连接。如果可能，我想继续使用`Session`，因为我将会话信息存储在线程变量中......

我**可以**使用 Internet Explorer 对 DataSnap 服务器进行身份验证和检索数据。如果我不让 IE 闲置 30 秒（或者它与服务器断开连接），它将为每个方法请求重用相同的连接。

我**可以**使用一个简单的 Delphi 应用程序，它使用 TIdHTTP 连接到 DataSnap 服务器。添加`keep-alive`到它的`Request.Connection`属性使它*永远*保持连接，并为所有方法调用重用*一个连接。*

.

## 问题

第 3 方公司正在构建一个 WCF 应用程序来访问 DataSnap 服务。他们无法让 WCF 应用程序**仅使用一个**与服务的连接。初始身份验证请求和第一个方法调用使用相同的连接，但后续请求会创建新连接，这可以通过`netstat`在他们的计算机上运行并使用多个源端口看到从他们的应用程序到我的服务的新 ESTABLISHED 连接来证明。新连接会在 DataSnap 服务器中创建新线程，这些线程无法访问经过身份验证的线程的会话变量。

.

## 可能的解决方法

我知道我可以将 DataSnap 服务器更改为`Invocation`模型，从而无需为每个客户端维护*一个*持久连接，并且如果需要，我会这样做。在这样做之前，我认为谨慎的做法是看看是否有其他人知道如何解决问题。

.

## 我的问题

*WCF 客户端应用程序是否有可能创建到非 WCF 服务器（DataSnap 服务器）的单个持久连接，它用于所有方法调用而不创建新连接？这是怎么做到的？是否像在 Visual Studio 中为 C# WCF 项目添加正确的【装饰】一样简单？*

任何建议都非常感谢！

.

仅供参考 - 我无权访问第 3 方的代码，因此我无法提供 WCF 代码示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T10:57:51.010

您的 Delphi 应用程序提供有状态的 Web 服务（使用会话变量），而[WCF Web 服务默认是无状态的](https://stackoverflow.com/questions/6050574/are-wcf-services-stateless-by-default)，包括 WCF 客户端。

也许[这个答案](https://stackoverflow.com/a/6050657/80901)指向正确的配置（ ServiceContract 的[wsHttpBinding](http://msdn.microsoft.com/en-us/library/ms730294.aspx)和[SessionMode](http://msdn.microsoft.com/de-de/library/system.servicemodel.servicecontractattribute.sessionmode.aspx)）。

来自 MSDN 文件：

> 例如，如果 SessionMode 属性设置为 SessionMode.Required 并且 InstanceContextMode 属性设置为 PerSession，则客户端可以使用**同一连接**对同一服务对象进行重复调用。

（由我突出显示）

* * *

然而，由于 DataSnap 主要不是为与 WCF 的互操作性而设计的，因此重新设计 Delphi 端以使用无状态 Web 服务模型而不是有状态可能更容易。这需要对每个服务请求进行身份验证，但在内部，Delphi Web 服务可以缓存一些数据以减少查找时间，类似于当前会话状态。

# .net - 如何理解 Process.Threads.Count 结果？这个变量显示什么？

> ID：11216841
> 
> 赞同：4
> 
> 时间：2012-06-26T22:29:38.990
> 
> 标签：.net, multithreading

让我们编写简单的控制台应用程序（调试模式）：

```
 static void Main(string[] args)
    {
        Process p = Process.GetCurrentProcess();

        IList<Thread> threads = new List<Thread>();
        Console.WriteLine(p.Threads.Count);
        for(int i=0;i<30;i++)
        {
            Thread t = new Thread(Test);
            Console.WriteLine("Before start: {0}", p.Threads.Count);
            t.Start();
            Console.WriteLine("After start: {0}", p.Threads.Count);
        }
        Console.WriteLine(Process.GetCurrentProcess().Threads.Count);
        Console.ReadKey();
    }

    static void Test()
    {
        for(int i=0;i<100;i++)Thread.Sleep(1);
    } 
```

你认为你会在结果中看到什么？

**[Q1] 为什么 p.Threads.Count 与 Process.GetCurrentProcess().Threads.Count 不同？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:34:53.557

您需要在每次[`Process.Refresh()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.refresh.aspx)获取属性之前调用，以避免看到缓存的结果。`Threads`

这样做，你会看到你期望的结果。

# function - 如何将 MS Excel 2010 中的名称与文件名进行比较？

> ID：11216843
> 
> 赞同：0
> 
> 时间：2012-06-26T22:29:42.610
> 
> 标签：function, vba, excel

我的目标：将目录中的文件名与电子表格中的名称进行比较。如果匹配，那么我希望将该名称的相应帐号附加到文件名。

我使用 dir 命令检索目录中的所有文件名，然后将列表粘贴到 Excel 电子表格的列中。

我现在有 4 列：帐号、姓氏、名字和文件名。这里的主要问题是文件名不一致。它们采用“姓氏，名字日期”的形式，但它们的形式不同，例如“Smith, John 010112”、“Smith, J. 010112”、“Smith J. 010112”。这意味着当涉及到名字时，我只会比较字符串的第一个字母。

所以本质上，对于每个文件名，我需要根据 lastname 列检查姓氏。如果找到匹配项，那么我需要检查文件名的名字的第一个字母与匹配的姓氏在同一行中的名字的第一个字母。如果这也是匹配项，那么我需要获取该行中的帐号并将其附加到文件名中。

我怎么能这样做？我对 Excel 函数还很陌生，但我确实有一些大学课程的 Java 和 C 编码经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:24:00.540

处理不一致的字符串可能很棘手。这是一个可以确定匹配的姓氏和名字的首字母的函数，前提是字符串模式在您的示例之外没有变化。将其添加到模块中，然后您可以通过在单元格中输入公式 =AppendFileName 来访问它。

```
Public Function AppendFileName(ByVal LName As String, ByVal FName As String, ByVal FileName As String, ByVal AccN As String) As String

If LName = Left(FileName, Len(LName)) Then
   If Mid(FileName, Len(LName) + 1, 1) = "," Then   'Check if the string contains a comma
       If Mid(FileName, Len(LName) + 3, 1) = Left(FName, 1) Then
           AppendFileName = FileName & " " & AccN
       End If
   Else 'If no comma then assume just one space
       If Mid(FileName, Len(LName) + 2, 1) = Left(FName, 1) Then
           AppendFileName = FileName & " " & AccN
       End If
   End If
End If

If AppendFileName = "" Then AppendFileName = False

End Function 
```

您可以围绕此代码创建一个循环以遍历所有文件和名称并使用 dir 函数自动执行，例如。

```
Dim x as integer, DirFile as string

DirFile = Dir(Path)

Do While DirFile <> ""
x = x + 1  'To track how many files, and to assign variables as in below line of code
'Set each string variable like FName = Range("A1").offset(x,0).value
'Then assess the the names and file names with the If statements above

'Do something with appended FileName

DirFile = Dir
Loop 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:41:53.153

由于您已经在列中拥有文件名，因此您可以使用 Excel 公式解决其余问题

`=IF(SEARCH(B2&", "&LEFT(C2,1),D2,1)>0,A2&"-"&D2,IF(SEARCH(B2&" "&LEFT(C2,1),D2,1)>0,A2&"-"&D2,""))`

这个公式对`Jake Smith`和都成立`John Smith`。

**快照**

![在此处输入图像描述](../Images/16cb39d7a3049ee19b1097a8f161ea4b.png)

**注意**：

`A2&"-"&D2`公式中的部分添加`Ac. No`到`Old Filename`. 如果你想`Ac. No`最后添加，那么将上面的内容更改为`D2&"-"&A2`

# command - 有没有办法在 P4 中逐行还原文件

> ID：11216845
> 
> 赞同：4
> 
> 时间：2012-06-26T22:29:46.697
> 
> 标签：command, perforce, revert

我想恢复文件中的部分更改。我知道在 p4v 中，您可以轻松地逐行还原文件。我想知道如何使用 p4 命令来做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T23:06:42.440

是的，假设您使用默认的 p4merge 实用程序，您可以按照以下步骤操作：

1.  右键单击更改列表中的文件。
2.  选择“与工作区文件进行比较”。（工作区文件在右侧面板，原始文件在左侧）
3.  从主顶部菜单中选择“编辑”。
4.  选择“编辑右窗格”。（将出现底部的第三个窗格，您可以对其进行编辑）
5.  现在浏览您的更改...
6.  ...要删除更改，请单击右侧的三角形。（形状图标变为蓝色）
7.  ...要重新添加更改，请单击右侧的圆形。（形状图标变为绿色）
8.  退出编辑器并保存您的更改并完成！

这有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-01T20:43:40.140

另一种选择是强制解析，然后以交互方式解析。一种方法是

1.  搁置要部分还原的文件，选中“搁置后还原”
2.  在同一个变更列表中检查搁置的文件
3.  取消搁置“恢复签出文件”和“覆盖工作区文件”**都未选中**的文件。文件将在未解决状态下被搁置
4.  以交互方式解析文件，允许您选择保留哪些块以及恢复哪些块

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T07:46:16.083

无法使用 p4 逐行还原。请参阅[p4 文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/revert.html)

考虑使用以下任何一种方法来区分：

1) 使用 vim，尝试`vi -d file1 file2`显示两个文件之间的图形差异

2) 除了 Kdiff3，Meld 也很流行，非常漂亮的 diff 图形界面... [Meld](http://meldmerge.org)

3) Emacs 有[Ediff](http://emacswiki.org/emacs/EdiffMode)

4）如果您正在寻找重量轻的东西...考虑[xdiff](http://furius.ca/xxdiff)

# python - 在没有内存开销的迭代器上正确锁定 multiprocessing.Pool

> ID：11216848
> 
> 赞同：3
> 
> 时间：2012-06-26T22:30:05.660
> 
> 标签：python, parallel-processing, multiprocessing

我在 python 中有一个可迭代的对象`Z`，它太大而无法放入内存。我想对该对象执行并行计算并将结果写入文件中`Z`，以便它们出现在文件中。考虑这个愚蠢的例子：

```
import numpy as np
import multiprocessing as mp
import itertools as itr

FOUT = open("test",'w')

def f(x):
    val = hash(np.random.random())
    FOUT.write("%s\n"%val)

N = 10**9
Z = itr.repeat(0,N)

P = mp.Pool()
P.map(f,Z,chunksize=50)
P.close()
P.join()

FOUT.close() 
```

这样做有两个主要问题：

1.  多个结果可以写入同一行
2.  返回一个带有`N`对象的结果 - 这将是很大的内存（我们不需要它！）。

**我试过的**：

*   使用全局锁`mp.Lock()`来共享`FOUT`资源：没有帮助，因为我认为每个工作人员都会创建自己的命名空间。
*   使用`apply_async`代替`map`：虽然有回调修复 1]、2]，但它不接受可迭代对象。
*   使用`imap`代替`map`并迭代结果：

就像是：

```
def f(x):
    val = hash(np.random.random())
    return val

P = mp.Pool()
C = P.imap(f,Z,chunksize=50)
for x in C: 
    FOUT.write("%s\n"%x) 
```

这仍然使用过多的内存，尽管我不知道为什么。

# html - 需要在不使用代码的情况下更新多个网页中的日期代码 mm/dd/yyyy

> ID：11216855
> 
> 赞同：0
> 
> 时间：2012-06-26T22:30:47.943
> 
> 标签：html, css, asp-classic

我需要在 mm/dd/yyyy 中从服务器获取日期，而不需要任何 javascript 或 asp 代码。我更愿意将其作为在当前文档框架中流动的链接，并将 mm/dd/yyyy 作为 css 或其他非基于代码的解决方案注入当前的 html 网页。我也不想使用任何无关的查询语言，例如 xslt、xquery 或 plinq。

例子：

```
<h3>Date:<date format="mm/dd/yyyy" src="currentdate.asp" /></h3> 
```

输出：

### 日期：06/26/2012

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:36:32.683

不，这是一项不可能完成的任务。

HTML 是一种静态语言。不可能使用没有任何动态元素（javascript、php、ssi 等）的静态语言并让它改变页面。

您将需要找到一种方法来放松项目的约束，因为目前这不仅不可能而且不合逻辑。

编辑：

我想到了一种可能的方式，但它不会很漂亮。

你可以使用一个`<iframe src="date.asp">`并且如果`date.asp`唯一返回日期那么它会起作用。这是唯一可行的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T23:41:12.303

您始终可以将其`img`设为 ，然后使用即时 img 生成器，该生成器从服务器生成文本作为图像。您可以使用诸如 csImageFile 之类的东西在图像中动态生成文本。

[http://www.chestysoft.com/imagefile/default.asp](http://www.chestysoft.com/imagefile/default.asp)

您的图像将如下所示：

```
 <img src="date.asp" /> 
```

然后您的`date.asp`文件将生成一个新图像（`response.contenttype="image/jpeg"`在每次通话中使用当前日期。

但是您的日期将显示为图像，而不是文本。

或者，您可以使用像 secretformula 的答案这样的 iFrame，或者为此使用 Ajax/jQuery。但是，如果您不从服务器收集数据，那么您的日期将来自客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T06:49:45.440

正如其他人所说，如果没有至少一点 javascript，您将无法实现这一目标。您可以做的是使用 jquery 选择所有日期标签，然后发布 ajax 以您喜欢的格式获取当前日期。

像这样：

```
 <script type="text/javascript">
        $(document).ready(function(){
            $("date").each(function(index, element) {
                var d = $(this);
                $.post("ullu.asp", {
                    ajax: true,
                    act: "currentdate",
                    format: d.attr("format")
                }, function(data) {
                    d.after("<span>" + data + "</span>");
                });
            });
        });
    </script>

<h3>Date:<date format="%m/%d/%Y" /></h3> 
```

然后在 ullu.asp 上：

```
<%
if request("ajax") = "true" then
    dim d : d = DateTime.FormatDate(request("format"), now)

    response.write d
end if
%> 
```

DateTime 是我的一类，用于格式化日期，您可以使用自己的实现......此外，您可以在标签中添加另一个属性，例如“src”，以便将您的 ajax 发送到那里。

我知道您想在不“使用代码”的情况下执行此操作，但这是不可能的。使用此解决方案，您只需添加一些处理所有标签的 javascript...

# android - 网络 + 用户界面更新，异步任务与处理程序

> ID：11216856
> 
> 赞同：-1
> 
> 时间：2012-06-26T22:30:50.300
> 
> 标签：android

我有一张要从单独的线程更新的地图。当我尝试从扩展 asynctask 的类中更新 UI 时，我遇到了一些问题。当我将代码移动到主线程中的处理程序时，我得到了`NetworkOnMainThreadException`. 下面是我的异步任务。有没有办法修改它以使其工作？

```
@Override
    protected Integer doInBackground(Void... params) {

        try {

            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://83.xx.xx:8080/android/service.php");

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("action", "getusers"));
            nameValuePairs.add(new BasicNameValuePair("interval", Integer.toString(interval)));

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            HttpResponse response = httpclient.execute(httppost);

            String jsonString = EntityUtils.toString(response.getEntity());

            Gson gson = new GsonBuilder().create();

            Type listType = new TypeToken<ArrayList<User>>() {}.getType();
            ArrayList<User> userList = gson.fromJson(jsonString, listType);

            ((GoogleMapsActivity) activity).removeOverlayItems();

            for(User user : userList ){

                ((GoogleMapsActivity) activity).addOverlayItem(Double.parseDouble(user.last_lat), Double.parseDouble(user.last_lng), user.bluetooth_name, "test desc");
            }

            return 1;

        } catch (Exception e) {
            e.printStackTrace();
        }
        return null; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:36:25.547

与其在 doInBackground 中触摸地图，不如将数据返回到 onPostExecute。然后从 onPostExecute 更新地图。

请注意，您永远不应该在 AsyncTask 中保留对 Activity 的引用，否则可能会导致内存泄漏。

理想情况下，您应该创建一个可以将数据返回到您的活动的观察者。

```
interface Observer {
    public void onMyDataAvailable(MyDataClass data);
} 
```

然后，您使用对该观察者的引用来实例化您的 AsyncTask。

```
class MyAsyncTask extends AsyncTask ...
    private Observer observer;

    public MyAsyncTask(Observer observer) {
        mObserver = observer;
    }

    public synchronized void onActivityDestroyed() {
        mObserver = null;
    }

    public synchronized void onPostExecute(MyDataClass result) {
        if (mObserver != null) {
            mObserver.onMyDataAvailable(result);
        }
    } 
```

只需确保从活动的 onDestroy 方法调用 onActivityDestroyed() 即可。否则你的 Activity 会泄漏。

# c++ - matlab找不到locale数据库是什么意思？

> ID：11216869
> 
> 赞同：0
> 
> 时间：2012-06-26T22:32:26.287
> 
> 标签：c++, linux, matlab, locale, matlab-engine

我有一个在 linux 上使用 matlab 接口的 C++ 程序。当我运行 C++ 程序时，我收到与语言环境数据库相关的错误：

```
MATLAB:I18n:LocaleDatabaseNotFound - Cannot find the MATLAB locale database. 
The MATLAB process default locale is set to "en_US.US-ASCII". 
```

这是什么意思？这个错误会导致严重的数值问题，还是只是一个小警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T12:06:54.437

用简单的英语，这个错误信息意味着 Matlab 通常会尝试说用户的语言，所以用户界面对于英语用户是英语，对于法语用户是法语等等。

这是通过为每个需要翻译的文本字符串分配一个数字并将已翻译的字符串从数据库（“语言环境数据库”）中提取出来来完成的。在您的情况下，Matlab 找不到您的语言设置的翻译并回退到英语消息。

这对您的数值计算没有影响，并且只是装饰性的。

ASCII 数据的导入/导出格式可能存在问题（小数点与小数点逗号、千位分隔符为 '、逗号或空格、日期为 y/m/d 或 d/m/y 或 dmy 是语言环境的另一个方面信息）。

# android - Android - url 方案不起作用并且应用程序无法打开

> ID：11216873
> 
> 赞同：4
> 
> 时间：2012-06-26T22:33:10.767
> 
> 标签：android, android-manifest, url-scheme

我想从自定义 url 运行我的应用程序。我在 AndroidManifest 中添加了以下内容：

```
<activity android:name=".app.RunFromUrlActivity"
            android:launchMode="singleInstance">
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />
                <data android:scheme="myapp"/>
            </intent-filter>
</activity> 
```

但是，当我尝试转到 myapp://data 时，浏览器只是搜索该字符串而不是运行我的 Activity。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:38:43.867

为“数据”尝试这样的事情：

```
<data
    android:host="com.yourpackage.yourotherstuff.TheActivity"
    android:scheme="yourscheme" /> 
```

这是适用于我的应用程序的一个：

```
<activity android:name=".BrowserActivity" >
    <intent-filter>
        <action android:name="android.intent.action.VIEW" />

        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />

        <data
            android:host="com.mypackage.otherstuff.BrowserActivity"
            android:scheme="myapp" />
    </intent-filter>
</activity> 
```

这使我的活动可以通过 myapp://com.mypackage.otherstuff.BrowserActivity 访问。

# ftp - 哪种文件访问最好：Webdav 还是 FTP？

> ID：11216884
> 
> 赞同：79
> 
> 时间：2012-06-26T22:34:26.943
> 
> 标签：ftp, webdav

我必须开发一个 Java 应用程序，它必须读取网络上的一些文件，编辑它们并将它们放回去。

问题是我总是（通过网络）通过 FTP 协议进行文件操作。但是，我最近听说了基于 HTTP 的 Webdav。

有没有人注意到它们之间的差异（在速度方面）？哪一个是最好的 ？如果 FTP 有好处，他们为什么要“发明”Webdav？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-06-27T05:53:39.960

与 FTP 相比，WebDAV 具有以下优点：

1.  通过一个 TCP 连接工作，可以更轻松地将其配置为绕过防火墙、NAT 和代理。在 FTP 中，数据通道可能会导致正确的 NAT 设置出现问题。

2.  同样由于一个 TCP 连接可以持久，WebDAV 在传输许多小文件时会比 FTP 快一点 - 无需为每个文件建立数据连接。

3.  GZIP 压缩是 HTTP 的标准，但不是 FTP 的标准（是的，FTP 中提供了 MODE Z，但没有在任何标准中定义）。

4.  HTTP 有多种身份验证方法可供选择，这些方法未在 FTP 中定义。例如。NTLM 和 Kerberos 身份验证在 HTTP 和 FTP 中很常见，除非您同时编写 FTP 的客户端和服务器端，否则很难获得对它们的适当支持。

5.  WebDAV 支持部分传输，并且在 FTP 中部分上传是不可能的（即，您不能覆盖文件中间的块）。

还有一件事需要考虑（取决于您是否控制服务器） - SFTP（SSH 文件传输协议，与 FTP 没有任何关系）。SFTP 比 WebDAV 功能更丰富，SFTP 是一种访问远程文件系统的协议，而 WebDAV 在设计时考虑到了抽象（WebDAV 用于“文档”，而 SFTP 用于文件和目录）。SFTP 具有上述 WebDAV 的所有优点，并且在管理员和开发人员中更受欢迎。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-27T06:16:01.793

回答问题 -`Why did they "invent" Webdav`

**WebDAV 代表`Web Distributed Authoring and Versioning`.**

互联网并不意味着通过 url 消耗资源（[统一资源定位器](http://en.wikipedia.org/wiki/Uniform_resource_locator)）

但这就是它变成的样子。

因为 HTTP 具有用于获取资源 (GET) 和 (HEAD) 的强大语义。(POST) 覆盖了语义操作的数量，而 (DELETE) 则被不信任所笼罩。HTTP 缺乏其他一些特性，例如多资源操作。

简而言之，它是读取协议而不是写入协议。

您可以通过 FTP 和许多机制上传您的资源 (URL) 以供获取。

WebDAV 应该提供互联网缺失的故事：支持通过相同的机制 HTTP 创作资源。它扩展了它的语义，引入了新的 HTTP VERBS。

它还引入了机制，不仅可以读取、写入、修改和删除资源（uris），还可以查询和修改资源的元属性。不是你以前做不到，而是通过后门机制完成的。

所以你看，它为互联网资源带来了一些你期望在桌面上进行文件操作的相同机制。

以下是一些类比：

```
MKCOL     ----- make collection ----- similar to make folder
PROPGET   ---- get properties (meta?) --- same as get info or extended attributes on mac
PROPPATCH --- modify properties
COPY      ---- cp
MOVE      ---- mv 
```

我希望，我已经确立了 WebDAV 的一些崇高目标，作为 HTTP 的扩展，以支持互联网创作。不知道我们是否已经实现了它。

**对于你的问题**

您的应用程序是一个客户端，必须使用可用的机制 - 另一端的 FTP 或 WebDAV。如果 WebDAV 可用，您可以使用它。但是需要一些时间来适应语义。FTP 具有有限的语义并且擅长于简单性。如果您已经在使用它，请不要更改它。

**哪个更快**

这类似于回答，哪个更快 HTTP 或 FTP？

狡猾地指出，如果这是一个这样的问题，我们就不会通过 HTTP 下载/上传文件；）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-14T19:58:02.533

由于**DAV**通过**HTTP**工作，因此您可以获得 FTP 无法提供的 HTTP 的所有好处。

例如：

> *强身份验证*、*加密*、*代理支持*和 *缓存*。

的确，您可以通过*SSH*获得其中的一些，但*HTTP 基础设施*的部署比 SSH 广泛得多。此外，SSH 没有 HTTP 所具备的广泛的工具、开发库和应用程序。

> DAV 传输（嗯，HTTP 传输）也比 FTP 更有效。您可以通过单个 TCP 连接进行多次传输，而 FTP 需要为每个传输的文件建立一个新连接（加上控制连接）。

[参考](http://www.webdav.org/other/faq.html#Q19)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-14T17:43:45.797

取决于你想做什么。例如，FTP 上获取文件列表的开销是 7 个字节（LIST -a），而使用 Webdav（PROPFIND + 207 多状态）是 370 个字节。

对于发送一些文件，FTP 的开销比 Webdav 低，依此类推。

如果您需要发送/获取大量小文件，FTP 会更快（使用多个连接进行正确的流水线操作，以及每个文件的 TCP 连接）。如果您要发送/接收大文件，两种技术都是一样的，开销可以忽略不计。

请参阅： [http ://www.philippheckel.com/files/syncany-heckel-thesis.pdf](http://www.philippheckel.com/files/syncany-heckel-thesis.pdf)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-30T13:48:59.717

文件修改时间：

ftp 和 webdav 处理文件修改时间的方式似乎有所不同。

似乎 ftp 中有一个“命令”来保留该时间（几个 ftp 客户端和服务器声称这样做），而 webdav，如果我没记错的话，可以获取文件修改日期，但不能在上传时设置它。

owncloud 客户端和一些专有的 webdav 客户端似乎有一种解决方法，但这仅适用于他们的软件

根据使用情况，这是支持 ftp 的有力论据。我不希望我的文件有修改日期 == 上传日期。稍后下载后​​，我无法按日期判断我拥有哪个版本的文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-26T22:39:49.420

Webdav 在轻松通过防火墙（没有单独的控制/数据套接字）方面优于 FTP。速度应该与两种协议通过原始 tcp 套接字传输文件的速度大致相同。

# c++ - 从 /dev/urandom 获取浮点数

> ID：11216885
> 
> 赞同：4
> 
> 时间：2012-06-26T22:34:30.330
> 
> 标签：c++, c, linux, floating-point

如何从中获取随机浮点值`/dev/urandom`？

如果我只是使用演员表，请说：

```
int fd = ::open("/dev/urandom", O_RDONLY);
uint32_t n;
read(fd, &n, sizeof(n));
float f = n; 
```

...我不确定我是否有可移植性的保证，因为我不知道大的值`n`是否一定可以表示为`f`？MAXUINT 是否保证可以表示为`float`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:47:08.017

您从 /dev/urandom 获得随机字节，但这些字节不一定会形成 a) 均匀分布的浮点值或 b) 甚至是您对待它们的任何对象的合法表示。例如，在具有浮点数或整数的捕获表示的平台上，您创建的值可能会捕获表示，并且您将无法实际使用您创建的随机值。

您应该简单地验证您的库的实现是否`std::random_device()`允许访问 /dev/urandom （默认情况下或通过使用类似的字符串`std::random_device("/dev/urandom")`参数`std::uniform_real_distribution<float>()`：你想要的随机数分布。

✓ libstdc++ 默认使用 /dev/urandom：

*   [http://gcc.gnu.org/onlinedocs/gcc-4.6.3/libstdc++/api/a00997_source.html#l01502](http://gcc.gnu.org/onlinedocs/gcc-4.6.3/libstdc++/api/a00997_source.html#l01502)

✓ libc++ 也可以：

*   [http://llvm.org/svn/llvm-project/libcxx/trunk/include/random](http://llvm.org/svn/llvm-project/libcxx/trunk/include/random)

~~✗ Visual Studio 的实现甚至没有使用非确定性 RNG：~~

✓ 从 VS2012 开始，MSDN 声明“默认生成的值是非确定性的且在密码学上是安全的”，可能是通过 Windows 的 Cryptographic Services。

*   [http://msdn.microsoft.com/en-us/library/bb982250.aspx](http://msdn.microsoft.com/en-us/library/bb982250.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T23:14:08.967

可以将`read`随机字节直接放入一个`float`（例如`float f; read(fd, &f, sizeof(f));`）；假设 IEEE-754，所有位模式都是有效的（尽管有两个无穷大和许多安静和信令 NaN）。您可以使用[`ieee754.h`](http://www.gnu.org/software/gnulib/manual/html_node/ieee754_002eh.html)or[`fpclassify.h`](http://www.kernel.org/doc/man-pages/online/pages/man3/fpclassify.3.html)来确定您是否击中了其中之一。

当然，这是否合理取决于你想要什么样的分布。假设 IEEE-754 ，您将在 [0, 2 ^(-126) ) 非正规和 [2 ^(-126) , 2 ^(-125) ), [2 ^(-125) , 2 ^(-124) ), ...`float32`的每个范围内得到均匀分布。 , [2 ^(127) , 2 ^(128) ) 法线（及其否定）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-21T22:11:50.110

您可以通过将随机整数除以最大整数值来获得随机数浮点数。

```
unsigned int RAND_MAX = 0xffffffff; // for 32 bit values
unsigned int random_value = rand_function();
double rand = (double) random_value / (double) RAND_MAX; 
```

该随机数将介于 0.0 和 1.0 之间。如果您希望它在某个范围内，只需这样做：

```
double x = 1.0; // range start
double y = 3.5; // range end
double range = rand * (y - x) + x; // creates values between 1.0 and 3.5 
```

# java - 不是 UTF-8 文件 + java + UTF-8 数据库

> ID：11216886
> 
> 赞同：0
> 
> 时间：2012-06-26T22:34:35.833
> 
> 标签：java, encoding, utf-8

我的网站具有纯文本上传功能。用户可以上传不同的编码文件。我需要进行一些预处理，但最后我想将这些文件中的内容保存到我数据库上的 UTF-8 编码文本列中。

我知道 Java 在这种情况下确实对用户不友好，但是实现它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:46:36.793

如果您的网站托管在 *nix 机器上，最好的办法是在`file`用户上传的任何内容上运行该实用程序。它会给你一个最好的编码猜测。然后，您可以使用它将`recode`您找到的任何格式转换为 UTF-8。这很容易出错，因为猜测类型可能会失败，尤其是在文本很短的情况下，但这是您能做的最好的事情。

# python - distutils 不在 Windows 上安装 package_data

> ID：11216894
> 
> 赞同：1
> 
> 时间：2012-06-26T22:35:44.523
> 
> 标签：python, windows, distutils

我`setup.py`的一个项目中有以下行（问题底部的完整脚本）：

```
import os
from distutils.core import setup

# ...

setup(
    # ...
    package_data={
        'mesh.binding': ['templates/*'],
        'mesh.documentation': ['templates/*'],
    },
    # ...
) 
```

这会将 的内容安装`mesh/binding/templates`到 Linux 和 OS X 上的 `site-packages/mesh/binding/templates`目录，但在 Windows 上不会成功。 **我如何让它在 Windows 上工作？**

我是新手`distutils`，如果我忘记了一些重要的事情，请原谅我。我正在使用`setuptools 0.6`和`python 2.7`。

## 相关文件

### `setup.py`：

```
import os
from distutils.core import setup

version = '1.0.0'
try:
    revision = os.environ['REVISION']
except Exception:
    pass
else:
    version = revision

packages = []
for root, dirs, files in os.walk('mesh'):
    if '__init__.py' in files:
        packages.append(root.replace('/', '.'))

setup(
    name='mesh',
    version=version,
    description='A declarative RESTful API framework.',
    author='Jordan McCoy',
    author_email='mccoy.jordan@gmail.com',
    license='BSD',
    url='http://github.com/siq/mesh',
    packages=packages,
    package_data={
        'mesh.binding': ['templates/*'],
        'mesh.documentation': ['templates/*'],
    },
    classifiers=[
        'Development Status :: 3 - Alpha',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: BSD License',
        'Operating System :: OS Independent',
        'Programming Language :: Python',
        'Topic :: Software Development :: Code Generators',
        'Topic :: Software Development :: Libraries :: Application Frameworks',
        'Topic :: Software Development :: Libraries :: Python Modules',
    ]
) 
```

### `MANIFEST.in`：

```
recursive-include mesh/binding/templates *.tmpl
recursive-include mesh/documentation/templates *.tmpl
include LICENSE
include requirements.txt
include *.rst
recursive-include tests *.py
recursive-include examples *.rst *.py
include docs/conf.py docs/Makefile
recursive-include docs *.rst
recursive-include docs/_static *.css
recursive-include docs/_templates *.html 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:09:41.887

我发现的最好的解决方案就是在我的构建中添加一个额外的步骤......这是一个无赖，但我不知道另一种解决方法。

# javascript - 谷歌柱形图裁剪条形

> ID：11216897
> 
> 赞同：3
> 
> 时间：2012-06-26T22:35:59.697
> 
> 标签：javascript, google-visualization

我正在尝试使用 Google 的柱形图显示数据。我尝试显示未堆叠的条形，但它不会从两端显示一个条形。然后我将属性更改`isStacked`为`true`，它显示所有条形但它在两端裁剪条形。

[![谷歌柱形图](../Images/109814f758958c2b134d6d71ee32f723.png)](https://i.stack.imgur.com/4leMw.png)

我该如何解决这个问题？

我在玩这些选项，但似乎没有任何效果。

```
 <script type='text/javascript'>
    google.load('visualization', '1', { 'packages': ['corechart'] });
    google.setOnLoadCallback(drawSizeChart);
    var d = 0;
    function drawSizeChart() {

        $.post('/metrics/SiteResourceChart', { fnsId: "@Model.FnsId", regionId: selectedValue },
            function (data) {
                if (Object.keys(data).length !== 0) {
                    var tdata = new google.visualization.DataTable();
                    tdata.addColumn('date', 'Date');
                    for (var p = 0; p < data.length; ++p) {
                        tdata.addColumn('number', data[p][0].PathName);
                    }

                    d = data[0].length;
                    for (var i = 0; i < data.length; ++i) {
                        for (var j = 0; j < data[i].length; ++j) {
                            var date = new Date(parseInt(data[i][j].CreatedAt.substr(6)));
                            var rCount = data[i][j].ResourceCount;
                            if (i === 0)
                                tdata.addRow([date, rCount, null]);
                            else
                                tdata.addRow([date, null, rCount]);
                        }
                    }

                    var options = {
                        title: 'Resource Count',
                        titleTextStyle: { fontSize: 20 },
                        isStacked: true,
                        bar: { groupWidth: '20%' },
                        chartArea: { left: '50' },
                        hAxis: { viewWindowMode: 'maximized' }

                        //legend: { position: 'none' }
                    };

                    var chart = new google.visualization.ColumnChart(document.getElementById('site_size_chart'));
                    chart.draw(tdata, options);
                }
            }
        );
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:05:57.187

我想一个快速的解决方案是将您的第一列定义为“字符串”而不是日期，并将 hAxis.viewWindowMode 保留为默认值。否则，您应该配置[hAxis.viewWindow](https://developers.google.com/chart/interactive/docs/gallery/columnchart)对象（即最小/最大值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T05:43:21.790

这里同样的问题。我所做的是，我在第一个日期前一天和最后一个日期后一天添加了 0 值的虚拟数据，以达到预期的结果。

使用 columnchart 包对我来说不是一个解决方案，因为我有几天没有数据，但想保持时间轴成比例。

# mysql - Mysql，选择最大值并匹配值

> ID：11216898
> 
> 赞同：0
> 
> 时间：2012-06-26T22:36:00.880
> 
> 标签：mysql

我有一张包含日期和值的表格。我要做的是获取值的 MAX() 值和对应于该值的日期。IE

```
+------------+-------+
| pdate      | score |
+------------+-------+
| 2012-05-01 |    80 |
| 2012-05-02 |    50 |
| 2012-05-03 |    52 |
| 2012-04-02 |   100 |
| 2012-05-02 |    10 | 
+------------+-------+ 
```

我想要的输出是 2012-04-02 - 100

这是我的查询：

```
SELECT pdate,MAX(Score) as maxscore FROM tblpulse 
 WHERE DID = '171488' && pdate BETWEEN '2012-05-02' 
   AND '2012-06-26' and pdate ORDER BY pdate ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:41:18.513

创建一个子查询并按您的 MAX 排序...

```
SELECT * FROM (
SELECT pdate,MAX(Score) as maxscore FROM tblpulse 
WHERE DID = '171488' && pdate BETWEEN '2012-05-02' 
AND '2012-06-26' and pdate ORDER BY pdate ASC)
ORDER BY maxscore DESC LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:43:11.527

```
select pdate, score
  from tblpulse
 where ... and pdate between '2012-05-02' and '2012-06-26'
   and score = ( select max( score ) from tblpulse where pdate between '2012-05-02' and '2012-06-26') 
```

（我省略了 DID 的事情，因为问题中没有描述该列。）

# python - scipy：基本说明

> ID：11216906
> 
> 赞同：11
> 
> 时间：2012-06-26T22:36:31.120
> 
> 标签：python, scipy

我并不理解`coo_matrix`,`csr_matrix`和之间的区别`csc_matrix`。

文档确实提到 coo_matrix 对于算术运算效率不高，我们需要将其转换为`csr`or `csc`。我正在研究矩阵乘法。`coo_matrix`如果我只有 a并将其转换为`csr`or`csv`矩阵，我不明白幕后发生了什么。

另外，如果我有类似的东西

```
A = array([[1,2,3,0,0,5],
        [5,0,0,1,2,0]])
print coo_matrix(A) 
```

它打印

```
 (0, 0)    1
  (0, 1)    2
  (0, 2)    3
  (0, 5)    5 
```

这很酷。但是有没有办法，我可以直接输入我的矩阵作为打印的矩阵。像定义一个空 COO 矩阵，然后开始定义`coo_matrix`我们在 matlab 中所做的类似的值。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-10-02T05:07:33.587

该术语不是由 python scipy 发明的，但已经存在于稀疏矩阵表示科学中

存在可以表示稀疏矩阵的各种格式。
格式可以分为两组：

1.  支持高效修改的那些，例如 DOK（键字典）、LIL（列表列表）或 COO（坐标列表）。这些通常用于构建矩阵。
2.  支持高效访问和矩阵运算的那些，例如 CSR（压缩稀疏行）或 CSC（压缩稀疏列）。

**坐标列表（COO）**

> **COO**存储（行、列、值）元组的列表。理想情况下，对条目进行排序（按行索引，然后按列索引）以缩短随机访问时间。这是另一种有利于增量矩阵构造的格式

**压缩稀疏行 (CSR)**

压缩稀疏行 (CSR) 或压缩行存储 (CRS) 格式表示由三个（一维）数组组成的矩阵 M，它们分别包含非零值、行的范围和列索引。这种格式允许快速行访问和矩阵向量乘法。

CSR 格式使用三个（一维）数组（A、IA、JA）以行形式存储稀疏 m × n 矩阵 M。令 NNZ 表示 M 中非零条目的数量。（注意，此处应使用从零开始的索引。）

数组 A 的长度为 NNZ 并以从左到右从上到下（“行优先”）的顺序保存 M 的所有非零条目。

1.  数组 IA 的长度为 m + 1。它由以下递归定义定义：
    IA[0] = 0
    IA[i] = IA[i - 1] + (第 (i - 1) 个非零元素的数量原始矩阵中的行）

因此，IA 的前 m 个元素存储 M 的每一行中第一个非零元素到 A 的索引，最后一个元素 IA[m] 存储 A 中的元素个数 NNZ，也可以认为是虚行的第一个元素在 A 中的索引，刚好超出矩阵 M 的末尾。
原始矩阵的第 i 行的值从元素 A[IA[i]] 到 A[IA[i + 1] - 1]（包括两端），即从一行的开始到下一行开始之前的最后一个索引。

第三个数组 JA 包含 A 的每个元素在 M 中的列索引，因此长度也是 NNZ。

> 例如，矩阵 0 0 0 0
> 5 8 0 0
> 0 0 3 0
> 0 6 0 0

是具有 4 个非零元素的 4 × 4 矩阵，因此

> A = [ 5 8 3 6 ]
> IA = [ 0 0 2 3 4 ]
> JA = [ 0 1 2 1 ]

来源：[https ://en.wikipedia.org/wiki/Sparse_matrix](https://en.wikipedia.org/wiki/Sparse_matrix)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:52:09.367

稀疏矩阵主要包含零。`coo_matrix`，`csr_matrix`并且`csc_matrix`都是稀疏矩阵类。`coo_matrix`是行、列、值的列表。这种类型的稀疏矩阵对算术来说效率很低，因为如果你有一个包含很多零的大矩阵，你实际上并不想对所有这些零进行数学运算。您只想对稀疏矩阵中的非零值进行数学运算。`csr_matrix`和`csc_matrix`是这个问题的解决方案。而不是列出稀疏矩阵中的所有值，`csr`实际上`csc`是三个 1-D 矩阵，它们具有非零值、列索引和行指针 (for `csr`)，它告诉非零值在稀疏矩阵中的位置矩阵。我不想重写教科书，所以这里有[更多信息和示例](http://en.wikipedia.org/wiki/Sparse_matrix#Yale_format)。

回答你的第二个问题。你想用`scipy.sparse.dok_matrix`. 这是一个基于键的稀疏矩阵字典。您可以编辑它 MATLAB 样式，然后将其转换为`csr`或`csc`用于算术。这是一个动态编辑的简单示例：

```
>>> A = scipy.sparse.dok_matrix((5,5))
>>> A[2,3] = 7
>>> print A
  (2, 3)      7.0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-21T09:25:54.453

`csr_matrix`先考虑行，先`csc_matrix`考虑列。

这是一个简单的例子来说明：让我们看一个矩阵，

```
mat = [[1, 0, 0],
       [5, 0, 2],
       [0, -1, 0],
       [0, 0, 3]] 
```

csr_matrix 首先给出行中非零元素的位置，然后到第二行，然后到第三行，依此类推。例如， csr_matrix(mat) 返回：

```
(0, 0)  1.0 -- first row
(1, 0)  5.0 -- second row
(1, 2)  2.0 -- second row
(2, 1)  -1.0 --third row
(3, 2)  3.0 -- fourth row 
```

类似地，csc_matrix 给出非零元素在第一列中的位置，然后是第二列，依此类推。

```
(0, 0)  1.0 -- first column
(1, 0)  5.0 -- first column
(2, 1)  -1.0 -- second column
(1, 2)  2.0 -- third column
(3, 2)  3.0 -- third column 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-13T19:26:08.527

我想你正在寻找这样的东西：

```
row  = np.array([0,0,0,0])
col  = np.array([0,1,2,5])
data = np.array([1,2,3,5])
coo_matrix((data,(row,col))).todense() 
```

这使：

```
matrix([[1, 2, 3, 0, 0, 5]]) 
```

[这](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.coo_matrix.html "这里")是 scipy 文档的链接

# ruby-on-rails - 关系模型上的 before_destroy

> ID：11216909
> 
> 赞同：0
> 
> 时间：2012-06-26T22:36:47.727
> 
> 标签：ruby-on-rails, callback, associations

我通过关联使用 has_many 并且无法让 before_destroy 回调触发。我正在使用 Relating 类来关联模型。

```
class Relating < ActiveRecord::Base
  belongs_to :relater, :polymorphic => true
  belongs_to :related, :polymorphic => true

  before_destroy :unset_reminders
end 
```

例如，用户可以将 TvShows 添加到收藏夹列表 User.rb：

```
has_many :tv_shows, :through => :relateds, :source => :related, :source_type => 'TvShow' 
```

我遇到的问题与删除此关联记录有关。

我可以通过以下方式关联用户和电视节目：

```
user = User.find(1)
show = TvShow.find(1)
user.tv_shows << show 
```

但是当我想删除这个关联时， before_destroy 不是由以下触发的：

```
user.tv_shows.delete(show) 
```

但是，如果我手动销毁相关记录，它会触发回调：

```
r = Relating.find(8012)
r.destroy 
```

我怎样才能为此触发之前的销毁？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:58:24.647

该`delete`方法不会触发[此处文档中提到的](http://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-delete)回调。试试`destroy`吧。

Update: I didn't realize you were trying to destroy the join record and not the show itself. I'm surprised `delete` works at all but perhaps that is a feature of `has_many :through`. How about:

```
user.relateds.where(tv_show_id: show.id).destroy 
```

# php - 使用 JavaScript 回发抓取 HTML

> ID：11216910
> 
> 赞同：2
> 
> 时间：2012-06-26T22:36:50.827
> 
> 标签：php, html, web-scraping

我正在尝试抓取一些 HTML（经作者许可）。[我使用的是此处建议](https://stackoverflow.com/a/34145/65387)的 PHP 库，它运行良好，直到我遇到如下所示的链接：

```
<a href="javascript:__doPostBack('dgItem$_ctl2$_ctl0','')"> 
```

我相信这是一些 asp.net 的东西。当我单击它时，它不会更改 URL，它只是将一些新内容加载到页面中，我也想抓取这些内容。

我怎样才能解决这个问题？

我想我需要模拟点击，但是在处理原始 HTML 时我不能这样做，我需要某种浏览器/JS 解释器，不是吗？

是否有更适合此任务的库？我不限于 PHP，但它是首选。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T23:52:50.163

`__doPostBack()`确实是 ASP.NET 的东西。以下是该函数的作用：

```
var theForm = document.forms['FORMNAME'];
if (!theForm) {
    theForm = document.FORMNAME;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
} 
```

基本上，它将两个隐藏字段 (`__EVENTTARGET`和`__EVENTARGUMENT`) 的值设置为参数的相应值。然后它提交表单。

如果您愿意，您可以继续使用 PHP HTML 解析器来完成这项工作，但是当您遇到其中一个`__doPostBack()`链接时，您必须手动制作一个 POST 请求。在高层次上，你会看到这样的东西：

1.  获取当前表单值。您可能必须遍历每个`input`元素等并将值添加到数组中。如果页面上没有文本框、复选框等，则默认情况下，您应该只保留 .NET 嵌入的隐藏字段（例如`__VIEWSTATE`、`__EVENTVALIDATION`等）。
2.  解析传递给 和 的值并`doPostBack()`覆盖现有值。`__EVENTTARGET``__EVENTARGUMENT`
3.  制作您的 POST 请求。我不确定您正在查看的库是什么（如果有的话）以这种方式提供，但是从 PHP 执行此操作的一种流行方法是通过 cURL 扩展。例如，请参阅[http://davidwalsh.name/execute-http-post-php-curl](http://davidwalsh.name/execute-http-post-php-curl)。
4.  获取 HTML 结果并像往常一样使用库进行解析。

或者，如果您总是对同一页面发出几乎相同的请求，您可能会跳过解析表单的一些步骤，直接跳到制作 POST 请求。

这不会很有趣，但它适用于这种情况。如果您需要处理涉及 JS 的更复杂的案例，或者您只是想以不同的方式处理这个问题，那么（正如您所提到的）库基本上可以驱动浏览器并为您处理这些事情。首先想到的两个是：

*   [Selenium 网络驱动程序](http://code.google.com/p/selenium/)
*   [幻影JS](http://phantomjs.org/)

还有其他选项，但我不知道有什么可以快速轻松地集成到现有的 PHP 脚本中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T08:04:11.423

我最终将 Python 与 Selenium Firefox Web 驱动程序一起使用。由于我使用的是真正的浏览器，所以我可以做任何 FF 可以做的事情。

# javascript - webGL 着色器错误

> ID：11216912
> 
> 赞同：2
> 
> 时间：2012-06-26T22:36:57.343
> 
> 标签：javascript, opengl-es, glsl, webgl

这些着色器在我的游戏引擎中运行良好，但是当我尝试将它们与 webGL 一起使用时，它们向我吐出了一大堆错误，

```
ERROR: 0:21: 'for' : Invalid init declaration
ERROR: 0:2: '' : Version number not supported by ESSL 
ERROR: 0:7: 'ftransform' : no matching overloaded function found 
ERROR: 0:7: 'assign' :  cannot convert from 'const mediump float' to 'Position highp 4-component vector of float'
ERROR: 0:9: 'gl_MultiTexCoord0' : undeclared identifier 
ERROR: 0:9: 'assign' :  cannot convert from 'float' to 'varying highp 4-component vector of float' 
```

那么，有人可以帮忙吗？

```
<script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;

    const float BLOOM_AMOUNT = 10.0;
// Increasing range can lower your FPS.
const int BLOOM_RANGE = 3;

uniform sampler2D composite;
varying vec4 texcoord;
varying vec4 texel;

        vec4 addBloom(vec4 c, vec2 t) {
                int j;
                int i;
                vec4 bloom = vec4(0.0);
                vec2 loc = vec2(0.0);
                float count = 0.0;

                for( i= -BLOOM_RANGE ; i < BLOOM_RANGE; i++ ) {
                        for ( j = -BLOOM_RANGE; j < BLOOM_RANGE; j++ ) {
                                loc = t + vec2(j, i)*0.004;

                                // Only add to bloom texture if loc is on-screen.
                                if(loc.x > 0.0 && loc.x < 1.0 && loc.y > 0.0 && loc.y < 1.0) {
                                        bloom += texture2D(composite, loc) * BLOOM_AMOUNT;
                                        count += 1.0;
                                }
                        }
                }
                bloom /= vec4(count);

                if (c.r < 0.3)
                {
                        return bloom*bloom*0.012;
                }
                else
                {
                        if (c.r < 0.5)
                        {
                                return bloom*bloom*0.009;
                        }
                        else
                        {
                                return bloom*bloom*0.0075;
                        }
                }
        }

void main() {

        vec4 color = texture2D(composite, texcoord.st);

        color += addBloom(color, texcoord.st);

        gl_FragColor = color;
}
</script>

<script id="shader-vs" type="x-shader/x-vertex">
    #version 120

    varying vec4 texcoord;

    void main() {
        gl_Position = ftransform();

        texcoord = gl_MultiTexCoord0;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T00:14:32.850

WebGL 基于 OpenGL ES，与 OpenGL 不同（几乎是一个子集）。OpenGL ES 的 GLSL 版本中存在许多缺失或不同的特性。

以下是我可以从您的错误消息中识别的问题：

*   在 for 循环中，变量必须在循环头本身中声明，而不是在外部：

    ```
    for( int i = -BLOOM_RANGE ; i < BLOOM_RANGE; i++ ) { 
    ```

*   OpenGL ES 中完全没有固定功能模式；您必须编写自己的所有转换和照明（或者，当然，使用提供它的框架）。这就是没有`ftransform()`和的原因`gl_MultiTexCoord0`。（我相信转换错误是由此而来的。）

*   GLSL ES 使用不同的版本号，这就是它反对您的版本声明的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T16:46:13.997

WebGL 基于 OpenGL ES 2，它*不*使用任何内置的东西（例如`ftransform`，，`gl_MultiTexCoord0`）。否则，代码在语法上是好的——它可以很好地编译用于 OpenGL ES 1 目的（但不能用于 WebGL）。

# javascript - EXtJS 图表条/列不适合窗口容器，超出/超出它

> ID：11216914
> 
> 赞同：0
> 
> 时间：2012-06-26T22:37:22.290
> 
> 标签：javascript, charts, extjs4, extjs

我正在使用 EXtJS 图表来绘制数据，由于某种原因，它正在扩展到包含它的窗口的右侧，并且在使用列时，在窗口上方。这似乎是一个缩放问题，因为只有一个列/条它可以缩放并完美地适合所有内容。 ![问题](../Images/b3175cd90f242813de7e02cf15beb4a0.png)

```
{
        title: title,
        closable:true,
        collapsible: true,

        //width: 600,
        height: 400,
        layout: 'fit',
           store: Ext.create('Ext.data.Store', {
        fields : [ 'metrics', 'dimensions' ],
        data : [ {'metrics':metrics, 'dimensions':dimensions}
        ]
           }),
        tbar: [{
            text: 'Save Chart',
            handler: function() {
                Ext.MessageBox.confirm('Confirm Download', 'Would you like to download the chart as an image?', function(choice){
                    if(choice == 'yes'){
                        var chart = Ext.getCmp('barchart');
                        chart.save({
                            type: 'image/png'
                        });
                    }
                });
            }
        }, {
            text : 'Add a Date Range',
            handler : function() {
                DateMenu.showBy(this,"bl");
                dateMenuContext=this;
            }
        }],
        items: [    
                    {
                xtype: 'chart',
                animate: true,
                shadow: true,
                  style: 'background:#fff',
                  store: store,
                legend: {
                    position: 'right'
                },
                axes: [{
                    type: 'Numeric',
                    position: axesposition,
                    fields: x,
                    title: title+String(" [Metrics: "+String(metrics)).concat(((dimensions!=null)&&(dimensions!=""))? String(", Dimensions: "+dimensions+"]")  : "]"),
                    grid: true,

                     minimum: 0,
                    label: {
                    renderer: function(v) {
                    return String(v);
                    }
                    },

                    roundToDecimal: false
                }, {
                    type: 'Category',
                    position: categoryposition,
                    fields: y,
                    title: false
                }],
                series: [{
                    type: tp,
                    label : {
                        display : "outside",
                        color : '#333',
                        'text-anchor' : 'middle',
                        field : x

                    },
                    axis: seriesaxisposition,
                    gutter: 80,
                    xField: y, 
                    yField: x,

                     highlight: true,

                      tips: {
                        trackMouse: true,
                        width: 140,
                        height: 28,
                        renderer: function(storeItem, item) {
                            this.setTitle(String(item['yField'])+": "+String(item.value[1]));
                        }
                    }
                }]

    },
    ]
        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T18:32:51.757

哈！我必须在我的商店/模型的字段中明确地将类型定义为 int。它以前工作得很好，但由于某种原因，这修复了它。

[http://www.sencha.com/forum/showthread.php?199952-4.1.0-Stacked-Column-Chart-with-Missing-Y-Value-has-Incorrect-Maximum&p=844595#post844595](http://www.sencha.com/forum/showthread.php?199952-4.1.0-Stacked-Column-Chart-with-Missing-Y-Value-has-Incorrect-Maximum&p=844595#post844595)

# ruby-on-rails - 使用布尔属性作为 Rails 3 中模型更新操作的条件

> ID：11216918
> 
> 赞同：0
> 
> 时间：2012-06-26T22:37:35.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, ruby-on-rails-3.1, before-filter

想象一下，我的模型上有一个布尔值和一个字符串属性，其数据如下：

```
Model.locked => true
Model.status => "Available" 
```

调用更新操作时，我想使用布尔属性来控制字符串属性是否被更新修改，无论如何都应该保存更新中的所有其他属性。

因此，如果

```
Model.locked => true 
```

我们尝试

```
Model.status = "Sold" 
```

然后

```
Model.status => "Available" 
```

目前我有这样的模型......

```
before_update :dont_update_locked_item, :if => :item_locked?

def item_locked?
  self.locked
end

def dont_update_locked_item
  #Some rails magic goes here
end 
```

如何防止单个属性被更新？

我知道答案会很痛苦，但有人帮帮我。已经很晚了，我累了，而且我的天赋刚刚好。;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:17:58.413

希望它不会那么痛:)

```
class Item < ActiveRecord::Base
  validate :cannot_update_if_locked, :on => :update

  def item_locked?
    self.locked
  end

  def cannot_update_if_locked
    errors.add(:item_id, "is locked") if item_locked?
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:41:48.520

试试这个：

```
class Item < ActiveReocrd::Base

  def mass_assignment_authorizer
    super + (locked? ? [] : [:status])
  end
end 
```

参考：

[动态 attr_accessible](http://railscasts.com/episodes/237-dynamic-attr-accessible)

# c# - 当我尝试获取 URL 的内容时应用程序冻结

> ID：11216921
> 
> 赞同：1
> 
> 时间：2012-06-26T22:38:03.523
> 
> 标签：c#, http

首先看我的源代码：

```
WebClient client = new WebClient();
String url = "http://localhost";
client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");
try
{
    Stream data = client.OpenRead(url);
    if (data == null)
        throw new WebException("Cannot browse the url...");
    StreamReader reader = new StreamReader(data);
    string s = reader.ReadToEnd();
    textBox1.Text = s;
    data.Close();
    reader.Close();

}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
} 
```

当我运行我的应用程序时，它将在此操作期间冻结。
我的代码的哪一部分是错误的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T22:41:07.327

> 我的代码的哪一部分是错误的？

在 UI 线程中执行阻塞网络操作的部分。当您的 UI 线程被阻塞等待响应时，控件无法重新绘制并且您的 UI 无法响应事件。

您应该在后台线程中执行此操作，然后使用[`Control.Invoke`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx)(WinForms) 或[`Dispatcher.Invoke`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)(WPF) 编组对 UI 线程的回调。有关详细信息，请参阅[Joe Albahari 的线程指南](http://www.albahari.com/threading/part2.aspx#_Rich_Client_Applications)。

或者，在`WebClient`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T22:41:26.143

它会回来吗？我敢肯定，如果传递了无效的 URI，它可能`OpenRead`会抛出异常。从文档：

> OpenRead 方法创建一个 Stream 实例，用于读取 address 参数指定的资源的内容。**此方法在打开流时阻塞**。要在等待流时继续执行，请使用 OpenReadAsync 方法之一。

`OpenRead`是同步的，即它阻塞当前线程，直到它返回所有数据。如果您希望异步执行读取，请使用[`OpenReadAsync`](http://msdn.microsoft.com/en-us/library/system.net.webclient.openreadcompleted.aspx).

当您调用此方法时，操作将*开始*，但您的代码将继续。当操作完成时，将调用一个回调方法（其[`OpenReadCompleted`](http://msdn.microsoft.com/en-us/library/system.net.webclient.openreadcompleted.aspx)事件的处理程序），该方法将处理响应。

# python - 为什么我缺少 git2.h 以及如何取回它？

> ID：11216922
> 
> 赞同：9
> 
> 时间：2012-06-26T22:38:12.087
> 
> 标签：python, c, git, linker, libgit2

每次尝试设置 pygit2 时，我都会遇到一个奇怪的问题。以下是我运行的内容和生成的错误。

```
$ python3 setup.py install
running install
running build
running build_py
running build_ext
building '_pygit2' extension
/usr/bin/clang -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -Os -w -pipe -march=native -Qunused-arguments -mmacosx-version-min=10.7 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk -isystem /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/usr/include -L/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/usr/lib -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/usr/include -I/usr/local/include -Iinclude -I/usr/local/Cellar/python3/3.2.3/include/python3.2m -c src/pygit2.c -o build/temp.macosx-10.7-x86_64-3.2/src/pygit2.o
In file included from src/pygit2.c:32:
include/pygit2/error.h:6:10: fatal error: 'git2.h' file not found
#include <git2.h>
         ^
1 error generated.
error: command '/usr/bin/clang' failed with exit status 1 
```

我想我已经成功安装了 libgit2（构建和制作完成得很好）。也许这是一个路径问题？我已将 LIBGIT2 环境变量设置为 libgit2 文件夹中的 src 目录。那是正确的地方吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T23:33:21.170

我从未安装过`libgit2`，但以下可能会有所帮助：

如果您的发行版存储库包含 libgit2，我建议您删除之前编译的内容并从存储库中安装 libgit2（二进制文件）和 libgit2-dev（头文件等）包。这会将二进制文件和源代码放置到正确的目录中。

否则，尝试符号链接`git2.h`到`/usr/local/include`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T21:27:30.310

看起来`LIBGIT2`变量不像额外的 include 指令使用的那样（你能展示你是如何设置变量的吗？）`/usr/local/include`（这是默认值）。

`LIBGIT2`env var 需要设置为安装库的前缀，通常是`/usr`或`/usr/local`。`/usr/local`由于编译器找不到该库，因此该库看起来不像已安装，因此您可能需要`export LIBGIT2=/usr`在运行`setup.py`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-04T23:03:22.827

嗨，您必须在 macOS 上，这是我解决问题的方法：

```
brew install gitlib2 
```

如果这不起作用，`Permission denied @ dir_s_mkdir` 只需运行以下命令

```
 sudo chown -R $(whoiam) $(brew --prefix)/* 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-16T10:22:47.223

以下步骤对我有用：

```
brew install libgit2 
```

# php - 如何按特定月份键自定义排序数组

> ID：11216923
> 
> 赞同：-1
> 
> 时间：2012-06-26T22:38:14.927
> 
> 标签：php, arrays, date, sorting, multidimensional-array

我确信这已经在某个地方得到了回答，但我找不到这个确切情况的答案......我知道我可以使用 usort 函数，但无法弄清楚做我想做的事情的逻辑，尽管它相对简单

我有一个正在生成的动态区域：

```
$details[$pageYear][$pageMonth][] = array(
    "id" => $page['id'],
    "title" => $page['title']
); 
```

我希望数组`$details`最终按年降序排序，然后按月排序

月份值是字符串（一月、二月、三月等......而不是数字），这似乎是我的主要问题（如何按实际顺序而不是字母顺序对月份的“字符串”进行排序）

如果结果是重复的，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:44:59.920

你可以使用 uasort 这个回调吗？

```
<?php
function cmp_month_strings($a_string, $b_string)
{
   $a_value = strtotime("{$a_string} 2000");
   $b_value = strtotime("{$b_string} 2000");

    if($a_value == $b_value)
       return 0;
    else if($a_value < $b_value)
       return -1;
    else
       return 1;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T23:09:12.093

要按键排序，需要 uksort 一些类似的方式：

```
uksort($details, function($a, $b) {
    return ($a < $b) ? -1 : 1;
});

foreach ($details as &$year) {
    uksort($year, function($a, $b) {
        $montha = (int) date('m', strtotime("{$a} 1 2000"));
        $monthb = (int) date('m', strtotime("{$b} 1 2000"));
        return ($montha < $monthb) ? -1 : 1;
    });
} 
```

# php - WCF/PHP - XML Parser 无法处理 HTML 实体？

> ID：11216938
> 
> 赞同：0
> 
> 时间：2012-06-26T22:39:31.340
> 
> 标签：php, xml, wcf

我的 RESTful WCF 服务接受来自客户端的 XML 请求主体，大多数客户端是 PHP 应用程序。

PHP 应用程序使用放置在元素标签中的 htmlentities() 对其请求进行编码。例如，添加新用户帐户的请求可能如下所示：

```
$body = "<user>
    <userName>" . htmlentities( $userName ) . "</userName>
</user>" 
```

该系统运行良好，直到今天为止，它的错误为零。

我查看了日志，发现这个请求失败了：

```
<user>
    <userName>&egrave;eesu</userName>
</user> 
```

除了以下例外：

InvalidOperationException：“XML 文档 (4, 12) 中存在错误。” XmlException：“字符引用无效。第 4 行，位置 12。”

（其中第 4 行，位置 12，指的是`<userName>`元素的 InnerText （即 string `&egrave;eesu;`）。

`&egrave;`是一个有效的 HTML 实体，但我知道 XML 只定义了一组最小的字符引用（`&amp;`、`&lt;`等），并且 XML 期望所有其他字符都在其文档编码表示中，因此会拒绝`&egrave;`.

有人可以确认是这种情况吗？如果是这样，我怎样才能让 PHP 只编码特定于 XML 的实体而不是 HTML 实体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:55:17.340

XML 只有 5 个[实体](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)。解析为 html 实体会在某些字符上中断，因为它会在实体本身中创建一个未编码的 &。

使用此函数而不是 htmlentities() 来转义实体：

```
function xmlentities($string) {
return str_replace(array("&", "<", ">", "\"", "'"),
    array("&amp;", "&lt;", "&gt;", "&quot;", "&apos;"), $string);
} 
```

借用 Tomas Jancik 的回答类似的问题： [Generating XML document in PHP (escape characters)](https://stackoverflow.com/questions/3957360/generating-xml-document-in-php-escape-characters)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-25T13:12:14.357

我改用`htmlspecialchars( $userName, ENT_XML1 )`它，它只将最少的字符转换为实体，而无需对它们进行编码。

@Jordan 的 str_replace 函数做同样的事情，但是当你对它进行基准测试时它会变慢，因为 htmlspecialchars 是一个本机函数。

# javascript - 使用 jQuery 获取 LI 的高度，以便新闻行情向上滚动所需的确切数量

> ID：11216940
> 
> 赞同：1
> 
> 时间：2012-06-26T22:39:38.750
> 
> 标签：javascript, jquery, scroll, news-ticker

我正在使用来自 [http://www.yourinspirationweb.com/en/jquery-how-to-create-a-news-ticker-with-just-a-few-javascript-lines/的脚本](http://www.yourinspirationweb.com/en/jquery-how-to-create-a-news-ticker-with-just-a-few-javascript-lines/)

这是一个很棒的新贴纸，旨在一次只向上滚动一篇文章，然后在最后以连续循环再次附加它。但是这个脚本的限制是每个

*   必须与彼此的高度相同，这并不总是可能的。

    我一直在尝试修改脚本，以便它自动获得“#ticker li:first”的外部高度。并滚动它，使 marginTop 等于该外部高度的负数。而不是默认的“-120px”。但是我意识到它是用 CSS 样式编写的，我不知道如何重写它。帮助！

    这是原始脚本：

    ```
    $(function()
    {
        var ticker = function()
        {
            setTimeout(function(){
                $('#ticker li:first').animate( {marginTop: '-120px'}, 800, function()
                {
                    $(this).detach().appendTo('ul#ticker').removeAttr('style'); 
                });
                ticker();
            }, 4000);
        };
        ticker();
    }); 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:54:25.440

这应该可以解决问题。只需将高度放入一个变量中，乘以 -1（得到所需的负数），然后将其放入`marginTop`属性中：

```
$(function() {
    var ticker = function() {
        setTimeout(function() {
            // get the height of the li element, multiply by -1 to be negative
            var h = parseInt($("#ticker li:first").outerHeight()) * -1; 
            $('#ticker li:first').animate( {marginTop: h + 'px'}, 800, function() {
                $(this).detach().appendTo('ul#ticker').removeAttr('style'); 
            });
            ticker();
        }, 4000);
    };
    ticker();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:56:33.010

要使用 jQuery 检索 html 元素的 outerHeight（包括边框、填充和可选的边距），请执行以下操作[`$(element).outerHeight()`](http://api.jquery.com/outerHeight/)

要使用 jQuery 检索 html 元素的 innerHeight，请执行以下操作[`$(element).innerHeight()`](http://api.jquery.com/innerHeight/)

```
$(function()
{
    var ticker = function()
    {
        setTimeout(function(){
            var oHeight = $('#ticker li:first').outerHeight();
            $('#ticker li:first').animate( {marginTop: -oHeight}, 800, function()
            {
                $(this).detach().appendTo('ul#ticker').removeAttr('style'); 
            });
            ticker();
        }, 4000);
    };
    ticker();
}); 
```

默认单位是像素，因此您不必担心将 px 附加到值。

# asp.net-mvc - Unity 自定义成员资格依赖不起作用

> ID：11216944
> 
> 赞同：0
> 
> 时间：2012-06-26T22:39:49.500
> 
> 标签：asp.net-mvc, unity-container, membership-provider

我似乎无法弄清楚如何让依赖注入在自定义成员资格提供程序中工作。我知道成员资格提供程序基类在 ASP.NET 中进行了深层管理，但应该有一些方法可以让依赖注入对私有数据成员起作用。

我正在使用 Unity，仅在我的成员资格和角色提供者中看到此问题

我的问题有两个：

1.  应用程序抱怨它没有“MyMembershipProvider”的无参数构造函数
2.  即使我尝试这个：[https](https://stackoverflow.com/a/9815425/595335) : //stackoverflow.com/a/9815425/595335，ValidateUser 方法中的安全服务为空

    ```
     public class MyMembershipProvider : MembershipProvider
     {  
        public ISecurityService securityService;

        public MyMembershipProvider(ISecurityService securityService)
        {
        this.securityService = new SecurityService(); 
        }

        public override bool ValidateUser(string username, string password)
        {
             User user = securityService.GetUserByUsername(username);

             ...ommited...

        } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:44:15.670

它可能并不理想，但您可能需要使用属性注入而不是构造函数注入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:52:23.667

问题是您的提供者是由静态类创建的。由于静态类没有“实例化”并且在应用程序的整个生命周期内都存在，因此无法让您的 DI 框架实例化静态类。

有潜在的解决方法，但您不能使用构造函数注入。这些变通办法也很脆弱且过于复杂。简而言之，这是一个 PITA，不值得努力。通过忘记会员提供程序中的 DI，或者忘记使用 Membership 并推出自定义 IIdentity 和 IPrincipal 解决方案，您可能会为自己省去很多麻烦。

# iphone - 目前我需要在本地为 cocos2d 保存我的游戏的分数字符串

> ID：11216952
> 
> 赞同：1
> 
> 时间：2012-06-26T22:40:39.310
> 
> 标签：iphone, xcode4, cocos2d-iphone

我将如何处理这件事？我可以给你看我的一些代码。但基本上我猜我必须保存字符串或其他东西。任何提示将不胜感激。我希望它出现在另一个场景中。

.h 文件

```
 int _score;
          int _oldScore;
        CCLabelTTF *_scoreLabel;
         @property (nonatomic, assign) CCLabelTTF *scoreLabel; 
```

.m 文件

```
 _score = 0;
       _oldScore = -1;
     self.scoreLabel = [CCLabelTTF labelWithString:@"" dimensions:CGSizeMake(100, 50)               alignment:UITextAlignmentRight fontName:@"Marker Felt" fontSize:32];
     _scoreLabel.position = ccp(winSize.width - _scoreLabel.contentSize.width,      _scoreLabel.contentSize.height);
     _scoreLabel.color = ccc3(255,0,0);
     [self addChild:_scoreLabel z:1];

if (_score != _oldScore) {
    _oldScore = _score;
    [_scoreLabel setString:[NSString stringWithFormat:@"score%d", _score]];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:44:27.843

我认为最简单的事情是将其放入用户默认值中。例如

```
// to write
[[NSUserDefaults standardUserDefaults] setInteger:yourScore forKey:@"score"];
[[NSUserDefaults standardUserDefaults] synchronize];

// to read
int score = [[NSUserDefaults standardUserDefaults] integerForKey:@"score"]; 
```

由于这个`synchronize`步骤，这样做会产生一点成本，所以不要只这样做，而不是使用普通的内部存储，也要这样做。

[用户默认值](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)旨在存储用户在应用程序中选择的设置。它们的名称有点奇怪，因为在桌面上的假设是它们将用于存储与新文档关联的默认属性。您可以将各种类型的数据存储到用户默认值，`NSString`如果您愿意，包括 s。

这些`standardUserDefaults`是操作系统固有地提供的那些。它们是每个应用程序的，因此您不必担心命名冲突。

# javascript - 在 Nintendo 3DS 浏览器中禁用滚动

> ID：11216953
> 
> 赞同：0
> 
> 时间：2012-06-26T22:40:52.320
> 
> 标签：javascript, jquery, html

我正在为 Nintendo 3DS 建立一个网站，并一直试图找出一种方法来禁用浏览器中的滚动。我将元标记设置为：`<meta name="viewport" content="width=device-width" />`它正在工作，并且还可以正确定位页面：

```
$(window).load(function() {
    window.scrollTo(40, 240);
}) 
```

这是必要的，以便顶部屏幕充满内容，因为浏览器在底部屏幕中加载。下一部分将禁用滚动，以便用户不会将浏览器重新定位到内容区域之外，因为可以滚动页面。我试过这些没有运气：

*   http://stackoverflow.com/a/3656618/1363726
*   http://stackoverflow.com/a/4770059/1363726
*   http://ajax911.com/disable-window-scroll-jquery/

我觉得应该可以禁用滚动，因为`window.scrollTo()`工作正常。任何关于我可能尝试的其他想法或建议将不胜感激。

谢谢

# php - 使用Jquery/Ajax在页面内加载页面，无需刷新

> ID：11216957
> 
> 赞同：-2
> 
> 时间：2012-06-26T22:40:54.840
> 
> 标签：php, javascript, jquery, ajax

我想使用 DIV 在页面中加载页面。看起来很简单 - 但是，我想在不刷新整个页面的情况下执行此操作。

这是我的例子：

`browse.php`--> 列出我目前在我的网站上出售的所有商品。这个页面可能非常长，并且重新加载很费力（尤其是在较慢的连接上）。

`editcart.php`--> 这是我想在browse.php 中加载的页面。它允许用户从他们的购物车中添加/删除特定项目。

有什么方法可以`editcart.php`在`browse.php`不刷新的情况下加载`browse.php`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:49:38.037

如果它只是加载页面，您可以使用该`.load()`方法执行以下操作

这是谷歌搜索中出现的第一个项目

```
 $('.editableItem').click(function(){
    $('#editDiv').load('editcart.php');
 }); 
```

您可以[在此处阅读有关此方法和其他方法的更多信息](http://api.jquery.com/load/)

# sql - 连接两个包含两个外键的表

> ID：11216960
> 
> 赞同：0
> 
> 时间：2012-06-26T22:41:10.840
> 
> 标签：sql, join, foreign-keys

在编写 SQL 方面，我非常业余，所以也许这对某人来说很容易？我有两个表如下：

**表 1 - 设备名称、设备 ID、备用 ID**

*   我的手机，333，AAA
*   HerPhone, 444, CCC

**表 2 - PhoneID、ProgramName**

*   333，愤怒的小鸟
*   CCC、印象笔记

如您所见，Table2 使用 Table1 中的两种不同的 PhoneID 类型（DeviceID 和 AlternateID）。我正在寻找一个 sql 语句，它将导致如下输出：

*   我的手机，愤怒的小鸟
*   HerPhone、印象笔记

感谢任何帮助。

干杯，马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:50:49.247

```
SELECT deviceName, programName
FROM table2 t2
JOIN table1 t1
 ON(t1.DeviceID=t2.PhoneID OR t1.AlternateID=t2.PhoneID) 
```

或（可读性较差但较短）

```
SELECT deviceName, programName
FROM table2 t2
JOIN table1 t1
 ON(t2.PhoneID IN (t1.DeviceID, t1.AlternateID)) 
```

不过，如果 DeviceID 和 AlternateID 来自同一个集合，您应该考虑重构数据库：如果一个设备可以有多个有效 ID，而不仅仅是两个呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:08:10.297

如果表 2 中同时定义了 333 和 AAA 怎么办？我将假设您只希望每个 DeviceName 返回一行，这意味着您需要使用外连接两次加入表 2：

```
select DeviceName, 
       t2a.ProgramName, 
       t2b.ProgramName as AltProgramName
  from table1 t1
  left outer join table2 t2a
    on t1.DeviceID = t2a.PhoneID
  left outer join table2 t2b
    on t1.AlternateID = t2b.PhoneID 
```

如果您只想列出一个 ProgramName，并且可以确定在两者都存在的情况下使用的优先级，您可以执行以下操作：（假设 DeviceID 胜过 AlternateID）

```
select DeviceName, 
       coalesce(t2a.ProgramName, t2b.ProgramName) as AltProgramName
  from table1 t1
  left outer join table2 t2a
    on t1.DeviceID = t2a.PhoneID
  left outer join table2 t2b
    on t1.AlternateID = t2b.PhoneID 
```

如果您希望第一个程序列始终包含一个值，并且如果两者都存在，则仅在第二列中列出一个值，然后

```
select DeviceName, 
       coalesce(t2a.ProgramName, t2b.ProgramName) as ProgramName1,
       case when t2a.ProgramName is not null then t2b.ProgramName end as ProgramName2
  from table1 t1
  left outer join table2 t2a
    on t1.DeviceID = t2a.PhoneID
  left outer join table2 t2b
    on t1.AlternateID = t2b.PhoneID 
```

***编辑***

我假设查询被用于报告目的，在这种情况下，您很可能只需要每个设备一行。

我刚刚意识到为什么 OP 可能希望每个设备返回多行。如果查询用于定义按任一名称查找设备的视图，则需要多行。

[Jan 的答案](https://stackoverflow.com/a/11217037/1012053)非常适合查找视图。但是，根据数据库引擎的查询优化器和表的大小，它的性能可能好也可能不好。如果表非常大，那么您将需要索引查找。带有 OR 条件的连接可能会阻止某些系统上的索引查找。使用 UNION ALL 的等效查询可能支持更多系统上的索引查找。

```
select DeviceName,
       ProgramName
  from table1 t1
  join table2 t2
    on t1.DeviceID = t2.PhoneID
union all
select DeviceName,
       ProgramName
  from table1 t1
  join table2 t2
    on t1.AlternateID = t2.PhoneID 
```

# python - CGContextRestoreGState：无效的上下文 0x0

> ID：11216969
> 
> 赞同：0
> 
> 时间：2012-06-26T22:42:08.470
> 
> 标签：python, macos, pygame

我正在尝试绘制一个简单的线条系统，但是当我尝试在终端（运行 OS X Lion）或 DrPython 中运行代码时，我收到一个错误（CGContextRestoreGState：无效上下文 0x0）。我正在运行 python 2.7。

```
import pygame as pg
pg.init()
screen = pg.display.set_mode((640,480))
l1 = 1.0 * L
l2 = 0.5377 * L
l3 = 0.2867 * L
hip = (100,100)
knee = (hip[0] + math.sqrt(2) * l1, hip[1] + math.sqrt(2) * l1)
ankle = (knee[0] + math.sqrt(2) * l2, knee[1] + math.sqrt(2) * l2)
toe = (ankle[0] + l3, ankle[1])
pg.draw.lines(screen, (0, 0, 0), False, [hip, knee, ankle, toe], 1)
while True:
for event in pg.event.get():
if event.type == pg.QUIT:
raise SystemExit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T09:20:07.303

额外问题的数量：

*   什么是“L”？你可能把它编辑掉了。
*   你需要在你的主循环中调用 pygame.display.flip() ，否则你什么也看不到。
*   建议您传递给 pygame.draw.lines 的元组列表是 *整数*元组。你的包括浮动元组。
*   缩进。我会假设它在您的原始来源中是正确的。

您的主要问题是正在创建的上下文无效。我假设这是在调用 pygame.display.set_mode 时发生的。快速的 Google 搜索显示，如果发生错误，CGContextRestoreGState 会将上下文设置为 NULL。您在那里找到的答案将帮助您解决问题。

特别是，关键问题是，您的错误发生*在哪里*（哪一行）？PyGame 示例是否有效？

# iphone - Google OAuth2 - 如何节省用户再次输入用户名和密码的努力？

> ID：11216973
> 
> 赞同：0
> 
> 时间：2012-06-26T22:42:18.257
> 
> 标签：iphone, oauth, oauth-2.0

我已阅读 Google OAuth2 流程的流程，但我不知道如何永久存储或永久存储什么，以便下次或将来，用户无需再次在我的应用程序中输入用户名或密码。

* * *

以下是我的理解：

1.  假设用户第一次启动了我的应用程序。

2.  我在我的应用程序中生成一个 UIWebView 并使用 Google OAuth2 请求 url 加载它（带有所有必要的参数）。

3.  然后谷歌将返回给我登录页面，我将其显示在 UIWebView 中。

4.  用户输入用户名和密码，然后点击“登录”

5.  Google 会在 UIWebView 中返回同意页面，并征求用户的同意。

6.  用户点击“允许”

7.  然后谷歌将返回“代码”作为返回页面的标题。

8.  我得到“代码”，然后要求“令牌”执行以下步骤（Google Reader API 调用等）

* * *

好的，我了解以上步骤。但它们是第一次使用，对吧？

*   如果用户第二次及以后启动我的应用程序怎么办？
*   我是否应该将“代码”值存储在我的应用程序中，如果用户再次进入我的应用程序，我是否应该从第 7 步开始？
*   我应该怎么做才能避免用户再次输入他们的用户名和密码？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T05:36:22.857

您将收到访问令牌和刷新令牌。这些是您唯一需要存储的东西。访问令牌将用于调用 Google API。刷新令牌将用于在旧令牌过期后获取新的访问令牌。

# php - php 闭包实例 5.3

> ID：11216977
> 
> 赞同：1
> 
> 时间：2012-06-26T22:42:45.907
> 
> 标签：php, oop, closures, php-5.3

这对我来说有点难以解释，但我会尽力而为。我正在尝试找到创建闭包实例的最佳方法。下面是我如何创建和访问闭包的示例：

```
$myvar->parse('var1, var2', function () {
  //my code
}); 
```

然后我通过分解逗号来循环遍历字符串并将其放入这样的数组中。

```
$array = array();
$array['var1'] = closure();
$array['var2'] = closure(); 
```

稍后在我的代码中，我`call_user_func`用来执行该功能。

现在，我遇到的问题是，当我访问`$array['var1']`它时，它会毫无问题地调用闭包。

但是当我访问`$array['var2']`它时，它什么也不做。一段时间以来，我一直在寻找各种网站，但运气不佳。我是否需要使用指针（尝试但没有成功）或以某种方式创建它的新实例？

我目前只能在我的服务器上访问 php 5.3，所以我不能使用 5.4 中的任何很棒的东西 :(

我非常感谢您提供的任何反馈和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:50:16.987

```
 $yourcall = function () {
    //code
  };

  $array['var1'] = $yourcall;
  $array['var2'] = $yourcall; 
```

将闭包分配给这些值。然而：

```
 $array['var1'] = $yourcall();
  $array['var2'] = $yourcall(); 
```

正如您似乎已经将*调用该闭包的结果*分配给数组项。

在你的 parse 函数中（为什么它需要一个字符串而不是一个数组），我假设你想要这个：

```
 function parse($string,$closure){
      $array = array();
      foreach(explode(',',$string) as $key) $array[$key] = $closure;
      return $array;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:46:07.260

是的，你的问题不清楚。你知道，所以我想知道你为什么没有更好地解释。

无论如何，如果您需要运行存储在其中的闭包`$array['var2']`，则必须专门在代码中放入如下内容：

```
$array['var2'] = function(){
//> Code
}; 
```

这是唯一的方法

通过猜测您的代码，您的函数解析应该如下所示：

```
function parse($keys,$func) {
 $array = array();
 foreach(explode(',',$keys) as $v) {
   $array[trim($v)] = $func;  //> trim important here!
 }
} 
```

你很可能忘记了`trim($v)`

# ios - 苹果推送通知分发证书签名请求是否需要与分发证书用于签署应用程序的请求相同？

> ID：11216979
> 
> 赞同：9
> 
> 时间：2012-06-26T22:43:20.347
> 
> 标签：ios, certificate, push-notification

我有一个我创建的现有应用程序，并且我最近配置了推送通知。

配置时，我被要求上传证书签名请求 (CSR)。我不再拥有用于发布我的应用程序的原始 CSR。这是我需要上传到推送通知配置以接收我的推送通知证书的 CSR 吗？

我有我的分发证书和可用的私钥。

我试图创建一个新的 CSR 以上传到开发人员门户以检索我的推送通知证书。

当我将此文件与我的私钥（p12 文件）结合并尝试连接到推送通知服务器时，我收到以下错误：

错误设置私钥 42600:error:0B080074:x509 证书例程:X509_check_private_key:key values mismatch:/SourceCache/OpenSSL098/OpenSSL098-44/src/crypto/x509/x509_cmp.c:406:

这是因为我用来创建推送通知证书的新 CSR 吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-27T09:47:20.733

生成新的 CSR 完全没问题。您的 .p12 文件中的私钥不正确。

生成推送证书，然后从 Apple 下载并双击它以将其添加到您的钥匙串。

打开钥匙串访问，在“我的证书”中找到推送证书，展开。您应该在下面看到一个私钥，这是此证书的正确密钥。选择证书及其私钥，右键单击并选择“导出 2 项...”。

使用生成的 .p12 文件，一切正常。

# android - Avoid that the gallery saves the picture taken with the camera in Android

> ID：11216982
> 
> 赞同：2
> 
> 时间：2012-06-26T22:43:35.220
> 
> 标签：android, android-intent, android-camera, android-gallery

I have an application that allows the user to take a picture with the native camera of the phone, I don't want to implement all the functionality of a camera (I don't want to loose the autofocus, flash or some other properties that the native camera might have) so I make this call:

```
File folder = new File(Environment.getExternalStorageDirectory(),"folder");
    folder.mkdirs();
    File nomedia = new File(folder,".nomedia");
    try{
        nomedia.createNewFile();
    }catch (IOException e){
        e.printStackTrace();
        Log.e("error", e.getMessage());
    }

    File file = new File(folder,"image.jpeg");
    try {
        file.createNewFile();
    } catch (IOException e) {
        e.printStackTrace();
    }
    imageUri = Uri.fromFile(file);
    if(imageUri != null){   
        Log.i(TAG, "imageUri: " + imageUri.getPath());
        imageIntent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);
     } 
```

Then in a button I have the execution of the intent:

```
startActivityForResult(imageIntent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE); 
```

This works perfectly, it opens the camera, I receive the callback when I take the picture and if I look to the folder with the file explorer of the phone I can see the picture and also the ".nomedia" file that I created.

The thing is that I don't want the camera to store this image in the gallery of the phone, because, somehow this is "magically" ;) added to the Gallery of Android and I thought with adding the ".nomedia" file and creating the picture in a separate folder the Gallery won't scan it. The idea is that the pictures are only for internal use of the app.

Is there anyway of avoiding this? I really searched and try many different ways, but I cannot solve it.

I hope I was clear with the explanation.

Thanks in advance!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T16:21:44.080

I found this solution: [Stop saving photos using Android native camera](https://stackoverflow.com/questions/8078892/stop-saving-photos-using-android-native-camera?rq=1)

The idea is to check which files are in the gallery just before taking the picture and just after it, delete that one that is new.

It's not the cleanest solution but it works.

# symfony - Symfony2 Composer 不下载包

> ID：11216983
> 
> 赞同：1
> 
> 时间：2012-06-26T22:43:47.083
> 
> 标签：symfony, composer-php

我最近试图重新安装 fos:userbundle 并注意到文档已更改。他们不再使用 deps 文件，现在正在引用新的包管理器作曲家。

我在这里找到了一些关于将作曲家与 sf2.0.* 集成的信息：http: [//knplabs.com/blog/symfony2-with-composer](http://knplabs.com/blog/symfony2-with-composer)

下载src后：[https ://github.com/KnpLabs/symfony-with-composer](https://github.com/KnpLabs/symfony-with-composer)

我尝试将以下内容添加到我的 composer.json：`"friendsofsymfony/user-bundle": "*"` 按照说明：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md)

当我运行时，`bin/vendors update`我得到以下信息：

```
Updating dependencies
Nothing to install or update
Writing lock file
Generating autoload files 
```

它似乎没有安装 fos 包。我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:47:41.127

*Composer 是一个 PHAR 存档，负责安装依赖项、更新它们、创建项目等。它与旧的bin/vendors*无关。

您需要做的是[下载 Composer](http://getcomposer.org/download/)：

```
curl -s http://getcomposer.org/installer | php 
```

并安装您的依赖项：

```
php composer.phar install 
```

顺便说一句，您下载的*symfony-with-composer是**Symfony2 标准发行*版的旧版本，不再维护，如存储库本身所述。

# iphone - 首次加载应用时如何显示视频？

> ID：11216985
> 
> 赞同：1
> 
> 时间：2012-06-26T22:44:10.200
> 
> 标签：iphone, ios, xcode, ipad

如何让应用程序在第一次加载时（仅）播放视频演练，然后在用户下次使用该应用程序时自行关闭而不播放？
我找到了一些关于显示弹出消息的说明，但这并没有真正帮助：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:54:46.677

启动时从 读取设置`NSUserDefaults`。如果不存在播放视频。当视频完成时，将相同的设置写入`NSUserDefaults`. 在下一次启动中，将找到该设置，您可以跳过视频部分。

```
if ([[NSUserDefaults standardUserDefaults] boolForKey:@"firstLaunch"];) {
    // play the video
    // when done:
    [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"firstLaunch"]
} 
```

不确定您是否也在询问如何播放视频。如果是这种情况，您可能希望将问题分成两部分并更具体。

# jquery - Jquery 帖子不适用于 flask-restless，其中 curl -H 帖子是

> ID：11216988
> 
> 赞同：3
> 
> 时间：2012-06-26T22:44:48.737
> 
> 标签：jquery, flask

我安装了一个烧瓶应用程序，运行烧瓶-restless API，以下命令成功执行：

```
curl -H "Content-type: application/json" -X POST http://127.0.0.15000/api/menu -d '{"name":"Hello Data"}' 
```

但是当试图用 javascript 做同样的事情时，它失败了。我将其追溯到flask-restless api中的问题代码行，并添加了一个打印出request.data的调试语句，因为它依赖于它。

最接近工作的 jquery 查询是：

```
$.ajax({
url:'api/menu', 
type:"POST",

contentType:"binary/octet-stream",

data:{name:'foo'}}); 
```

对于哪个 request.data 被分配“name=foo”，它应该是 {'name':'foo'}

我已经尝试了 (contentType: "application/json", dataType: "json") 对于内容类型 application/json、binary/octet-stream 的所有排列，在所有其他情况下，数据只是空白，并且 request.form 有一个不可变的字典。

我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T23:03:29.577

糟糕 - 数据 - 没有作为你必须做的 json 发送

```
$.ajax({
    url:'http://localhost:5000/api/menu', 
    type:"POST",

    contentType:"binary/octet-stream",
    host:"localhost",
    data:JSON.stringify({"name":"foo"})}); 
```

注意 JSON.stringify ！！！

# python - 添加分隔符并删除逗号

> ID：11216991
> 
> 赞同：1
> 
> 时间：2012-06-26T22:45:03.977
> 
> 标签：python, python-2.7, delimiter, comma, csv

我有一个文件，我已经输出了几列信息，确切地说是 4 列。此时它们用逗号分隔，但为了让我的伙伴将它们输入另一个脚本，他希望格式带有“|” 作为分隔符，逗号被删除，逗号跟随每组数据，所以在我的脚本之后它输出：

```
[0], [1], [2], [3] 
```

我需要的是：

```
[0] | [1] | [2] | [3] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T22:53:17.703

```
s = "[0], [1], [2], [3]"

print s.replace(',', ' |')

# Output:
# [0] | [1] | [2] | [3] 
```

将适用于您的测试用例。

或者，你可能会因为类似的东西而疯狂

```
s = "[0], [1], [2], [3]"

s = s.split(',')
s = map(str.strip, s)
s = " | ".join(s)

print s
# Output:
# [0] | [1] | [2] | [3] 
```

根据您的需要，这可能更灵活。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T23:02:48.873

```
>>> print ' | '.join('[0], [1], [2], [3]'.split(', '))
[0] | [1] | [2] | [3] 
```

**更新：**

实际上@jedwards 的解决方案使用`replace`更好：

```
>>> timeit.timeit("'[0], [1], [2], [3]'.replace(', ', ' | ')")
0.36054086685180664

>>> timeit.timeit("' | '.join('[0], [1], [2], [3]'.split(', '))")
0.48539113998413086 
```

# ruby-on-rails - 通过纯 HTTPS 连接为 Juggernaut 2 提供服务

> ID：11216992
> 
> 赞同：0
> 
> 时间：2012-06-26T22:45:06.900
> 
> 标签：ruby-on-rails, https, socket.io, juggernaut

我有一个 Ruby on Rails 网站，我在该网站上强制所有连接都是 SSL。我还需要来自该站点的所有连接才能使用 HTTPS。此外，即使我连接到另一个端口，谷歌浏览器也会自动切换到 HTTPS。

这意味着我无法连接到 [http://www.mysite.com:8080](http://www.mysite.com:8080) 我必须通过 https 提供 juggernaut js 文件。但这不起作用，因为 Juggernaut 不想在其内部网络服务器上使用 https 而不是 http。因此，我将 juggernaut 文件夹 /usr/local/lib/node_modules/juggernaut/public/application.js 中的 application.js 文件复制到我的 rails 文件夹 public/juggernaut 中，并在我的 HTML 代码中更改了以下行：

至

现在我似乎至少能够启动一个剑圣对象。当我开始实际聆听时，问题就出现了。我收到此错误：

未找到：[https ://www.mysite.com:8080/socket.io/1/?t=1340749304426&jsonp=0](https://www.mysite.com:8080/socket.io/1/?t=1340749304426&jsonp=0)

所以要么我需要

a) 能够更改它，因此我实际上可以让 Juggernauts 网络服务器使用 https 而不是 http。这是优选的。

或者

b1) 修复 Juggernaut 使其不会尝试通过端口 8080 访问 socket.io 和

b2) 将 socket.io 添加到我的服务器，最好在 www.mysite.com/juggernaut 文件夹下而不是根目录下。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T16:28:59.690

可能有点晚了，但我能够使用它来让它工作。（我的主宰托管在 heroku 上）

```
 var jug = new Juggernaut({
        secure: true,
        host: 'yourHostHere',
        port: 443,
        transports: ['xhr-polling','jsonp-polling']
    }); 
```

# java - 为什么 Java 不允许在迭代器上使用 foreach（仅在可迭代对象上）？

> ID：11216994
> 
> 赞同：83
> 
> 时间：2012-06-26T22:45:29.300
> 
> 标签：java, syntax, iterator, language-design, iterable

> **可能重复：**
> [为什么 Java 的 Iterator 不是 Iterable？](https://stackoverflow.com/questions/839178/why-is-javas-iterator-not-an-iterable)
> 
> [在给定迭代器的情况下使用 for-each 循环的惯用方式？](https://stackoverflow.com/questions/3883131/idiomatic-way-to-use-for-each-loop-given-an-iterator)
> 
> [我们可以使用 for-each 循环来迭代 Iterator 类型的对象吗？](https://stackoverflow.com/questions/2162917/can-we-use-for-each-loop-for-iterating-the-objects-of-iterator-type)

据我所知，foreach 循环是 Java 5 中添加的语法糖。所以

```
Iterable<O> iterable;
for(O o : iterable) {
    // Do something
} 
```

基本上会产生与

```
Iterable<O> iterable;
for(Iterator<O> iter = iterable.iterator(); iter.hasNext(); /* NOOP */) {
    O o = iter.next();
    // Do something
} 
```

但是，如果我一开始没有可迭代对象，而只有一个迭代器（比如说，因为一个类提供了两个不同的迭代器），我就不能使用语法糖 foreach 循环。显然我仍然可以进行简单的旧样式迭代。但是，我实际上想做：

```
Iterator<O> iter;
for(O o : iter /* Iterator<O>, not Iterable<O>! */) {
     // Do something
} 
```

当然我可以做一个假的`Iterable`：

```
class Adapter<O> implements Iterable<O> {
    Iterator<O> iter;

    public Adapter(Iterator<O> iter) {
        this.iter = iter;
    }

    @Override
    public Iterator<O> iterator() {
        return iter;
    }
} 
```

（这实际上是对 Iterable API 的丑陋滥用，因为它只能迭代一次！）

如果它是围绕`Iterator`而不是可迭代设计的，可以做一些有趣的事情：

```
for(O o : iterable.iterator()) {} // Iterate over Iterable and Collections

for(O o : list.backwardsIterator()) {} // Or backwards

Iterator<O> iter;
for(O o : iter) {
    if (o.something()) { iter.remove(); }
    if (o.something()) { break; }
}
for(O : iter) { } // Do something with the remaining elements only. 
```

有谁知道*为什么*语言是这样设计的？为了避免歧义，如果一个类同时实现`Iterator`和`Iterable`？为了避免假定“for(O o : iter)”将处理所有元素两次（并且忘记获取新的迭代器）的程序员错误？或者还有其他原因吗？

还是有一些我不知道的语言技巧？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-26T23:23:27.507

所以我现在有了一个比较合理的解释：

短版：**因为该语法也适用于没有迭代器的*数组。***

如果按照我的建议设计语法`Iterator`，它将与数组不一致。让我给出三个变体：

**A)**由 Java 开发人员选择：

```
Object[] array;
for(Object o : array) { }
Iterable<Object> list;
for(Object o : list) { }
Iterator<Object> iter;
while(iter.hasNext()) { Object o = iter.next(); } 
```

它的行为方式相同，并且在数组和集合之间*高度一致。*然而，迭代器必须使用经典的迭代风格（至少不太可能导致错误）。

**B）**允许数组和`Iterators`：

```
Object[] array;
for(Object o : array) { }
Iterable<Object> list;
for(Object o : list.iterator()) { }
Iterator<Object> iter;
for(Object o : iter) { } 
```

现在数组和集合不一致；但是数组和 ArrayList 密切相关，应该表现相同。现在，如果在任何时候，语言被*扩展*以使例如数组实现`Iterable`，它就会变得不一致。

**C）**允许所有三个：

```
Object[] array;
for(Object o : array) { }
Iterable<Object> list;
for(Object o : list) { }
Iterator<Object> iter;
for(Object o : iter) { } 
```

现在，如果我们最终处于不清楚的情况下，当有人*同时* `Iterable`实现and时`Iterator`（for 循环是否应该获得一个新的迭代器或迭代当前 - 在树状结构中很容易发生！？！）。一个简单的 tie-braker ala “Iterable beats Iterator” 不幸的是不会这样做：它突然引入了运行时与编译时间差异和泛型问题。

现在突然间，我们需要注意是否要迭代集合/可迭代对象或数组，此时我们以大混乱为代价获得了很少的好处。

Java (A) 中的“for each”方式非常一致，它几乎不会导致编程错误，并且它允许将来可能将数组转换为常规对象。

有一个变体**D)**可能也可以正常工作：for-each 仅适用于迭代器。`.iterator()`最好通过向原始数组添加方法：

```
Object[] array;
for(Object o : array.iterator()) { }
Iterable<Object> list;
for(Object o : list.iterator()) { }
Iterator<Object> iter;
for(Object o : iter) { } 
```

但这需要更改运行时环境，而不仅仅是编译器，并且破坏了向后兼容性。另外，上面提到的混乱仍然存在

```
Iterator<Object> iter;
for(Object o : iter) { }
for(Object o : iter) { } 
```

只对数据进行一次迭代。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-26T22:52:20.407

Iterable 接口正是为此目的而创建的（增强了 for 循环），如[原始 JSR](http://jcp.org/aboutJava/communityprocess/jsr/tiger/enhanced-for.html)中所述，尽管 Iterator 接口已经在使用中。

关于 JSR 中讨论的新接口（注意包名）：

*   `java.lang.Iterable`
*   `java.lang.ReadOnlyIterator`（在 JSR 中建议进行改装，`java.util.Iterator`但实际上并未完成）

…JSR 说：

> 这些新接口用于防止语言对`java.util`否则会产生的依赖性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-26T23:26:33.933

因为“for”循环会对迭代器造成破坏。除非实现 ListIterator 子接口，否则无法重置迭代器（即移回开头）。

一旦您将迭代器放入“for”循环，它将不再可用。我的猜测是语言设计者决定在编译器中结合额外的特殊情况（其中已经有两个用于 Iterable 和数组）将其转换为字节码（你不能重用与 iterable 相同的转换）就足够了批评者不实施它。

当您通过迭代器接口在代码中自己执行此操作时，至少会很明显发生了什么。

随着 lambdas 的到来，他们可以使这变得又好又容易：

```
Iterator<String> iterator = ...;
Collections.each ( iterator, (String s) => { System.out.println(s); } );

List<String> list = ...;
Collections.each ( list, (String s) => { System.out.println(s); } ); 
```

在不破坏向后兼容性的情况下，仍然具有相对简单的语法。我怀疑他们会在不同的接口中构建像“each”、“collect”和“map”这样的方法，因为这会破坏向后兼容性，而且你还有数组需要处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T23:43:55.697

我认为答案的一部分可能隐藏在 for-each 循环是语法糖这一事实中。关键是你想做一些人们经常做的事情，更容易。而且（至少以我的经验）成语

```
Iterator iterator = iterable.iterator();
while( iterator.hasNext() ) {
  Element e = (Element)iterator.next() ;
} 
```

一直在旧式代码中发生。而用多个迭代器做一些花哨的事情却没有。

# python - 返回列表时函数中的奇怪行为

> ID：11216995
> 
> 赞同：1
> 
> 时间：2012-06-26T22:46:06.090
> 
> 标签：python

我在网上找到了一个函数，它生成一组的所有子多组，然后返回它们。但是当我浏览代码以了解它的实际作用时，我真的被卡住了。

这是代码：

```
def build_substrings(string):
    """ Returns all subsets that can be formed with letters in string. """
    result = []
    if len(string) == 1:
        result.append(string)
    else:
        for substring in build_substrings(string[:-1]):
            result.append(substring)
            substring = substring + string[-1]
            result.append(substring)
        result.append(string[-1])
    return result 
```

现在，假设我用争论“ab”来称呼它。基本情况被忽略，所以我进入 else 块并再次调用该函数，现在参数是“a”。我到达了基本情况，它在结果中附加了“a”。现在我返回结果。for 循环现在已“激活”。子字符串被分配“a”，并附加到结果列表中。现在，我在名为 'result' 的列表中添加了两次“a”。不知何故，在输出中它只显示一次。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:06:50.090

> 现在，我在名为“结果”的列表中添加了两次“a”。

不，`result`是一个局部变量，第一次附加“a”时，它是局部变量，而第二次`result`是局部`build_substrings("a")`变量`result`。`build_substrings("ab")`它们是对您的方法的两个不同调用，因此它们不会共享它们的`result`.